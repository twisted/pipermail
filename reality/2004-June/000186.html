<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Reality] Is collect() broken?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:reality%40twistedmatrix.com?Subject=%5BReality%5D%20Is%20collect%28%29%20broken%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000187.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Reality] Is collect() broken?</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:reality%40twistedmatrix.com?Subject=%5BReality%5D%20Is%20collect%28%29%20broken%3F&In-Reply-To="
       TITLE="[Reality] Is collect() broken?">exarkun at divmod.com
       </A><BR>
    <I>Fri Jun  4 13:27:19 MDT 2004</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000187.html">[Reality] Is collect() broken?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#186">[ date ]</a>
              <a href="thread.html#186">[ thread ]</a>
              <a href="subject.html#186">[ subject ]</a>
              <a href="author.html#186">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
   This is based on radix's example.

   Consider a battery shed.  It has an open window and a closed window. 
  Inside are heaps and heaps of batteries.  An actor outside the shed 
attempts to take one of the batteries.

   collect() will reach the actor's location from the actor, and then do 
both of the following two things in some order:

     reach the open window from the actor's location, reach the interior 
of the shed from the open window, reach a battery from the shed, yield a 
battery to the caller (because things can be taken through open windows).

     reach the closed window from the actor's location, reach the 
interior of the shed from the closed window, reach a battery from the 
shed, yield a refusal around the battery (because things can't be taken 
through open windows).

   Or will it!  In fact, it will not.  Whichever runs first will cause 
the shed to be added to the seen dictionary, which will in turn cause 
the subsequent portion of the traversal, upon reaching the shed, to skip 
it.  If the open window is traversed first, the battery will be 
takeable.  If the closed window is traversed first, the battery will not 
be takeable.

   How can we solve this?  Off the top of my head, and with no filters 
for putrification factor:

   * yield an &quot;unsee&quot; callable with each implementor.  Calling this 
would allow an implementor to be yielded again.

   * Don't put implementors in the seen dict, or put use a path segment 
leading up to the implementor in the seen dict with it, so that an 
object reached via multiple paths can be yielded multiple times.  Fix 
code using collect() to be aware of this possibility.

   * ... ?

   Jp


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000187.html">[Reality] Is collect() broken?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#186">[ date ]</a>
              <a href="thread.html#186">[ thread ]</a>
              <a href="subject.html#186">[ subject ]</a>
              <a href="author.html#186">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/reality">More information about the Reality
mailing list</a><br>
</body></html>
