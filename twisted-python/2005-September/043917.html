<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] threadedselectreactor and twistd
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20threadedselectreactor%20and%20twistd&In-Reply-To=%3C43274224050913083916a95fbb%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043914.html">
   <LINK REL="Next"  HREF="043918.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] threadedselectreactor and twistd</H1>
    <B>Stefano Masini</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20threadedselectreactor%20and%20twistd&In-Reply-To=%3C43274224050913083916a95fbb%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] threadedselectreactor and twistd">stefano at pragma2000.com
       </A><BR>
    <I>Tue Sep 13 09:39:11 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043914.html">[Twisted-Python] threadedselectreactor and twistd
</A></li>
        <LI>Next message (by thread): <A HREF="043918.html">[Twisted-Python] threadedselectreactor and twistd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43917">[ date ]</a>
              <a href="thread.html#43917">[ thread ]</a>
              <a href="subject.html#43917">[ subject ]</a>
              <a href="author.html#43917">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/12/05, Antony Kummel &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">antonykummel at yahoo.com</A>&gt; wrote:
&gt;<i> Not sure what you mean.
</I>&gt;<i> 
</I>&gt;<i> If threadedselectreactor can't integrate with twistd,
</I>&gt;<i> then the problem that threadedselectreactor solves is
</I>&gt;<i> inherent to twistd, in which case twistd is simply
</I>&gt;<i> unsuitable for some uses (i.e. GUI)?
</I>&gt;<i> 
</I>
Antony,

using twisted with GUIs is not trivial, and I found it quite tricky.
But in the end it's possible and in fact I do it all the time. Here's
the best solution I could find so far, using wxPython:

1) Run wxPython in the main thread
2) Run twisted reactor in a secondary thread
3) Have special proxy objects that bridge calls from gui code (running
in one thread) and network code (running inside another)

It doesn't sound nice, but it's not as bad as it seems.

The problem is that there's not much you can do about it, really:
first of all, wxPython is made in such a way that if you don't use its
own event loop, you won't be able to use modal dialogs (which simply
sucks). So you can't really use wxreactor, and similar solutions if
you want to build anything more complex that hello world.

Conversely, you can't use wxPython's event loop to process twisted
events because it's not responsive enough. So you're left with the
multiple threads solution only.

Once you have this, you need to deal with the communication problem:
say your network code is dealing with a protocol that fails, and you
want to warn the used with an error dialog. You can't really call
wx.ErrorDialog(...).ShowModal() because your code is running in the
wrong thread, so you have to wx.CallAfter(myShowDialogMethod, ...).

Similarly, if the user clicks on the &quot;Connect&quot; button, you can't call
twisted code from within the OnClick() event handler because you're
again in the wrong thread. Therefore you have to
reactor.callFromThread(myBeginConnectionMethod, ...).

So, dealing with these wx.CallAfter and reactor.callFromThread quickly
urges you to write proxies whose methods are decorated in such a way
that just by calling them from one thread triggers their execution in
the other thread.

When I discovered all these issues, I searched for code online and
found something that I can't find again, but looks a lot like this
(and could very well be the same):
<A HREF="http://solipsis.netofpeers.net/wiki2/index.php/WxPython_And_Twisted_Example">http://solipsis.netofpeers.net/wiki2/index.php/WxPython_And_Twisted_Example</A>

I wrote this in a bit of a rush, I hope I was clear enough.
If this is relevant to you, let me know in case you need more info.

stefano


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043914.html">[Twisted-Python] threadedselectreactor and twistd
</A></li>
	<LI>Next message (by thread): <A HREF="043918.html">[Twisted-Python] threadedselectreactor and twistd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43917">[ date ]</a>
              <a href="thread.html#43917">[ thread ]</a>
              <a href="subject.html#43917">[ subject ]</a>
              <a href="author.html#43917">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
