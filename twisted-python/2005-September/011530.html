<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.vfs issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.vfs%20issues&In-Reply-To=20050929000424.3914.1562619604.divmod.quotient.22201%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011540.html">
   <LINK REL="Next"  HREF="011532.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.vfs issues</H1>
    <B>James Y Knight</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.vfs%20issues&In-Reply-To=20050929000424.3914.1562619604.divmod.quotient.22201%40ohm"
       TITLE="[Twisted-Python] twisted.vfs issues">foom at fuhm.net
       </A><BR>
    <I>Wed Sep 28 21:01:26 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011540.html">[Twisted-Python] twisted.vfs issues
</A></li>
        <LI>Next message: <A HREF="011532.html">[Twisted-Python] twisted.vfs issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11530">[ date ]</a>
              <a href="thread.html#11530">[ thread ]</a>
              <a href="subject.html#11530">[ subject ]</a>
              <a href="author.html#11530">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Sep 28, 2005, at 8:04 PM, Jp Calderone wrote:

&gt;<i> rename() in VFS should work across filesystems,
</I>&gt;<i>
</I>
Hm, that is going to be an interesting one to implement. I'm thinking  
in particular about what happens when you have a structure like:
/ -&gt; adhoc.AdhocDirectory:
   tmp -&gt; osfs.OSDirectory(&quot;/home/jknight/tmp&quot;, ...)
   home -&gt; inmem.FakeDirectory(...)

and I ask to move a file from /tmp/foo to /home/bar.

IMO it is reasonable to say that the VFS 'rename' operation is  
allowed to cleanly fail, and not do the rename, forcing a higher  
level to do a copy/delete if it wants. This pushes the complication  
out of each VFS implementation to one implementation that will work  
across all, and furthermore can share its code with the copy  
implementation. This maps nicely to rename(2), as well, as a bonus.

&gt;<i> guarantee atomicity (if this is feasible - I think it is.  If not,  
</I>&gt;<i> it should explicitly deny atomicity),
</I>
It isn't feasible, when renaming across filesystems. There will  
certainly have to be a time at which both 'from' and 'to' exist.  
Additionally, it may be impossible to create a file 'to+&quot;.tmp&quot;' (or  
similar) in the target directory to atomically rename to 'to' when  
you've finished copying, because of permissions. Another reason to  
restrict &quot;rename&quot; to be the simple rename, rather than the  
copy&amp;delete-rename.

James



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011540.html">[Twisted-Python] twisted.vfs issues
</A></li>
	<LI>Next message: <A HREF="011532.html">[Twisted-Python] twisted.vfs issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11530">[ date ]</a>
              <a href="thread.html#11530">[ thread ]</a>
              <a href="subject.html#11530">[ subject ]</a>
              <a href="author.html#11530">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
