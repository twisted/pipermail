<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] process timing / idle handler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20process%20timing%20/%20idle%20handler&In-Reply-To=%3C20050914195250.3914.2047845410.divmod.quotient.17026%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043938.html">
   <LINK REL="Next"  HREF="043945.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] process timing / idle handler</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20process%20timing%20/%20idle%20handler&In-Reply-To=%3C20050914195250.3914.2047845410.divmod.quotient.17026%40ohm%3E"
       TITLE="[Twisted-Python] process timing / idle handler">exarkun at divmod.com
       </A><BR>
    <I>Wed Sep 14 13:52:50 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043938.html">[Twisted-Python] process timing / idle handler
</A></li>
        <LI>Next message (by thread): <A HREF="043945.html">[Twisted-Python] process timing / idle handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43939">[ date ]</a>
              <a href="thread.html#43939">[ thread ]</a>
              <a href="subject.html#43939">[ subject ]</a>
              <a href="author.html#43939">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 14 Sep 2005 21:31:37 +0200, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">henning.ramm at mediapro-gmbh.de</A> wrote:
&gt;<i>Ahoi!
</I>&gt;<i>
</I>&gt;<i>I often use reactor.callLater(0, something) to let twisted handle and intercept my call queue.
</I>&gt;<i>Is this really preferable to calling 'something' directly? Or do I just fool myself?
</I>&gt;<i>
</I>&gt;<i>Is there something like reactor.OnIdle()?
</I>&gt;<i>Or, more generally, how could I delay some actions (intermediate cleanup etc.) until the computer has free resources?
</I>&gt;<i>(Some of my processes run on a very high loaded server.)
</I>&gt;<i>
</I>
This does what you expect, but what you expect may not be the right thing.  What happens if there are 50 on-idle tasks?  That won't be nearly as nice as if there's only 1.  If you want to schedule CPU-intensive tasks, they need to cooperate with each other.

Take a look at &lt;<A HREF="http://divmod.org/svn/Divmod/trunk/Epsilon/epsilon/cooperator.py">http://divmod.org/svn/Divmod/trunk/Epsilon/epsilon/cooperator.py</A>&gt;.  It's intended to be used with time-consumed tasks implemented as iterators.  By using a single Cooperator, the amount of work you arrange to have performed per unit of network activity is limited, regardless of the number of different tasks outstanding.

This also lets you tune the rate at which time-consumed tasks are processed using a single knob.  This means that if you notice you can handle greater latency, there is a single thing to change (possibly even at runtime) to let you do this (the benefit being that doing more work at once is more efficient).

You can also nest Cooperators and assign them non-time-based schedulers (such as a system load-based scheduler).  This lets you give a task or group of tasks a priority relative to other things you have scheduled.

However, if you have expensive computations that do not interact with the rest of your application except by receiving an immutable or non-shared chunk of input and producing an immutable or non-shared chunk of output, a threaded solution may well be appropriate.  Threadless solutions are superior because they let the code in question interact with the rest of your application in an unsurprising way.  If there is no interaction, the benefits of avoiding threads are less pronounced.

Jp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043938.html">[Twisted-Python] process timing / idle handler
</A></li>
	<LI>Next message (by thread): <A HREF="043945.html">[Twisted-Python] process timing / idle handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43939">[ date ]</a>
              <a href="thread.html#43939">[ thread ]</a>
              <a href="subject.html#43939">[ subject ]</a>
              <a href="author.html#43939">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
