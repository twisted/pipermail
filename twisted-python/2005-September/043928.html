<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] GUI responsiveness
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20GUI%20responsiveness&In-Reply-To=%3C20050914120529.3914.647455527.divmod.quotient.16815%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043927.html">
   <LINK REL="Next"  HREF="043929.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] GUI responsiveness</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20GUI%20responsiveness&In-Reply-To=%3C20050914120529.3914.647455527.divmod.quotient.16815%40ohm%3E"
       TITLE="[Twisted-Python] GUI responsiveness">glyph at divmod.com
       </A><BR>
    <I>Wed Sep 14 06:05:29 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043927.html">[Twisted-Python] GUI responsiveness
</A></li>
        <LI>Next message (by thread): <A HREF="043929.html">[Twisted-Python] GUI responsiveness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43928">[ date ]</a>
              <a href="thread.html#43928">[ thread ]</a>
              <a href="subject.html#43928">[ subject ]</a>
              <a href="author.html#43928">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On Wed, 14 Sep 2005 13:35:35 +0200, Antoine Pitrou &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">solipsis at pitrou.net</A>&gt; wrote:

&gt;<i>Never tried GTK with Twisted, but I don't understand how you can say
</I>&gt;<i>that generally.
</I>
I was saying it was easier to program, not that it performed better (and by the way, it *does* perform better than WX), but since you asked -

&gt;<i>Suppose a network event is taking some time to process (e.g. the
</I>&gt;<i>protocol is complex and there are some calculations involved), then your
</I>&gt;<i>GUI will become unresponsive (a 100ms delay is not critical for most
</I>&gt;<i>Internet protocols, but it is for GUIs).
</I>
Not at all.  A user clicks on a button; if they don't see an update for 100ms, that is barely enough time for them to flick their mouse over to another button.  In fact, network latency is such that it is nearly impossible to provide faster than 100ms actual real response time even for highly performance-critical applications.

If the UI isn't redrawing for 100ms, it is hard for the user to even notice, unless it is a continuous 100ms between redraws, in which case this GUI application is really doing quite a lot of work!

&gt;<i>Suppose there are lots of network events coming in, which flood the
</I>&gt;<i>event loop for a short time. When will GUI events be processed ? Again,
</I>&gt;<i>a 100ms delay will feel very annoying for the user (and more than 1
</I>&gt;<i>second delay is awful).
</I>
A news aggregator I use, straw, does blocking DNS lookups and can hang completely for upwards of a minute while it's doing an update.  While this is not exactly ideal behavior, it's tolerable.  Even Firefox locks up for a few seconds when rendering a complex page.  You are somewhat overstating the case - I sure wish that everything were faster, but 100ms latency on certain operations is not going to make anyone stop using an application :).

&gt;<i>On the other hand, if you have one thread for networking and one thread
</I>&gt;<i>for the GUI, the OS can take care of the scheduling priorities
</I>&gt;<i>naturally, using its sophisticated builtin mechanisms (e.g. noticing
</I>&gt;<i>that one thread is &quot;interactive&quot; while the other is not), so you don't
</I>&gt;<i>have to rewrite/emulate/composate for the lack of/ them.
</I>
&gt;<i>Am I missing something here ?
</I>
A few things:

1 - this is really not as major a problem as you say, for the reasons given above.
2 - this argument is tangential; if the thread scheduler is so sophisticated, it will notice that the IO-plus-UI thread is also &quot;interactive&quot; and schedule it appropriately.  (In fact, both threads in your example are &quot;interactive&quot; according to Linux 2.6's scheduler heuristic, I think)
3 - you don't have to emulate anything about threads when writing Twisted GUI applications unless you have extremely computation-intensive actions to perform; and in that case you can use threads for those (few) actions rather than everything in the app
4 - you're assuming that you have to build extra to &quot;compensate&quot; for the lack of threads, but you're ignoring the cost of building support tools to use them.  building thread safety into even a single API is difficult, costly, and extremely hard to test for correctness even superficially.  
5 - if you have a networked interactive application under high load, you are not going to improve performance or interactivity by performing a ton of additional context switches as well as a bunch of extra work locking and unlocking shared mutexes.  smart as the scheduler is, your computer *does* only have one or two processors, and more threads = more work.  (this is especially true if you are using threads for EVERYTHING in your application, rather than just the truly parallelizeable tasks)
6 - in Python, your threaded work has to release the GIL to give any substantive improvement in performance, which it probably doesn't.

... and that's just off the top of my head.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043927.html">[Twisted-Python] GUI responsiveness
</A></li>
	<LI>Next message (by thread): <A HREF="043929.html">[Twisted-Python] GUI responsiveness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43928">[ date ]</a>
              <a href="thread.html#43928">[ thread ]</a>
              <a href="subject.html#43928">[ subject ]</a>
              <a href="author.html#43928">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
