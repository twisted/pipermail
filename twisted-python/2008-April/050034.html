<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Stackless Python Examples Re: InlineCallback	Friendly ? 
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Stackless%20Python%20Examples%20Re%3A%20InlineCallback%0A%09Friendly%20%3F%20&In-Reply-To=%3C882470.36243.qm%40web34201.mail.mud.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="050036.html">
   <LINK REL="Next"  HREF="050037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Stackless Python Examples Re: InlineCallback	Friendly ? </H1>
    <B>Andrew Francis</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Stackless%20Python%20Examples%20Re%3A%20InlineCallback%0A%09Friendly%20%3F%20&In-Reply-To=%3C882470.36243.qm%40web34201.mail.mud.yahoo.com%3E"
       TITLE="[Twisted-Python] Stackless Python Examples Re: InlineCallback	Friendly ? ">andrewfr_ice at yahoo.com
       </A><BR>
    <I>Sat Apr 19 12:47:38 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="050036.html">[Twisted-Python] feeding-worker-loop problem
</A></li>
        <LI>Next message (by thread): <A HREF="050037.html">[Twisted-Python] Twisted 8.1.0 prerelease 1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50034">[ date ]</a>
              <a href="thread.html#50034">[ thread ]</a>
              <a href="subject.html#50034">[ subject ]</a>
              <a href="author.html#50034">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Folks:

--- Andrew Francis &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">andrewfr_ice at yahoo.com</A>&gt; wrote:

[J-P Calderone]
&gt;<i>The only kind of dispatcher which is really hostile
</I>&gt;<i>towards inlineCallbacks is the kind which is
</I>&gt;<i>hostile towards Deferreds in general - ie, one which
</I>&gt;<i>requires a return value and does not support 
</I>&gt;<i>Deferreds.
</I>
[A Francis] 
&gt;<i>Once again Jean-Paul, I find your explanation super
</I>&gt;<i>helpful and save me time going down the wrong path. 
</I>
Based on Jean-Paul's explanation, here are some code
snippets showing how to handle other protocols with
Stackless Python and Twisted. This is a continuation
of the technique I used in &quot;Adventures&quot; to prevent the
reactor from deadlocking.

Currently I am rethinking the techniques - I believe
there is a way to reduce spawning tasklets - not that
tasklets are all that expensive....

Here is an example with resources adapted from the Abe
Fettig example on page 48 of &quot;Twisted Network
Programming Essentials.&quot; I am still getting my feet
wet with resources. I intend to use this to help
prototype REST support in WS-BPEL.

class HomePage(resource.Resource):
    
    def doWork(self):
        message = &quot;&quot;&quot;
        &lt;html&gt;
        &lt;head&gt;
        &lt;/head&gt;
        &lt;body&gt;
        Hello World    
        &lt;/body&gt;
        &lt;/html&gt;
        &quot;&quot;&quot;
        self.request.write(message)
        self.request.finish()
        
        
    def render(self, request):
        self.request = request
        stackless.tasklet(self.doWork)()
        return server.NOT_DONE_YET


and here is one with PyAMF .2

(I remember sketching this one out on a napkin at
PyCon 2008)

class EchoServer(TwistedGateway):
    def __init__(self):
        super(EchoServer, self).__init__()
        self.request = None
        return
        
    def __echo__(self, request, deferred, y):
        print &quot;=&gt;&quot;, request, deferred, y
        deferred.callback(y)
        
    
    def echo(self, request, y):
        print &quot;=&gt;&quot;, request, y
        deferred = defer.Deferred()
        stackless.tasklet(self.__echo__)(request,
deferred, y)
        return deferred

Cheers,
Andrew



      ____________________________________________________________________________________
Be a better friend, newshound, and 
know-it-all with Yahoo! Mobile.  Try it now.  <A HREF="http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ">http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="050036.html">[Twisted-Python] feeding-worker-loop problem
</A></li>
	<LI>Next message (by thread): <A HREF="050037.html">[Twisted-Python] Twisted 8.1.0 prerelease 1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50034">[ date ]</a>
              <a href="thread.html#50034">[ thread ]</a>
              <a href="subject.html#50034">[ subject ]</a>
              <a href="author.html#50034">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
