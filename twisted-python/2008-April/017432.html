<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Performance issues of twisted.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Performance%20issues%20of%20twisted.&In-Reply-To=befee6d80804130933t6b700308oadbd63d3ceec6b8c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017431.html">
   <LINK REL="Next"  HREF="017434.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Performance issues of twisted.</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Performance%20issues%20of%20twisted.&In-Reply-To=befee6d80804130933t6b700308oadbd63d3ceec6b8c%40mail.gmail.com"
       TITLE="[Twisted-Python] Performance issues of twisted.">glyph at divmod.com
       </A><BR>
    <I>Sun Apr 13 20:48:18 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="017431.html">[Twisted-Python] Performance issues of twisted.
</A></li>
        <LI>Next message: <A HREF="017434.html">[Twisted-Python] shared list in factory, mutexes?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17432">[ date ]</a>
              <a href="thread.html#17432">[ thread ]</a>
              <a href="subject.html#17432">[ subject ]</a>
              <a href="author.html#17432">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13 Apr, 04:33 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">newptcai at gmail.com</A> wrote:
&gt;<i>Hi all!
</I>&gt;<i>
</I>&gt;<i>I am preparing to write a server application (you may think of it as an
</I>&gt;<i>online game server) with twisted, but I am worrying about it's 
</I>&gt;<i>performance
</I>&gt;<i>and how to do it correctly.
</I>
If this is the first time you have done such a thing, let me give you a 
friendly piece of advice: think about how to do it correctly first, then 
think about how to speed it up once it works.  This is common wisdom in 
programming, but it is especially important when you think you have 
found an exception to the rule, and stuff needs to go *really fast*, 
*right away*.  If you try to make it perform well before understanding 
what's going on, it will be both slow *and* full of mistakes and 
complexity from misguided implementations.

Ideally, you could work on an existing project, such as MV3d ( 
<A HREF="http://www.mv3d.com/trac">http://www.mv3d.com/trac</A> ) rather than starting from scratch.
&gt;<i>For example..
</I>&gt;<i>
</I>&gt;<i>1. UDP or TCP&#255;0Cwhich should I choose to gain higher performance?
</I>
If you do not already know the answer to this question, choosing UDP is 
very dangerous.  For what TCP does, TCP is higher performance, and a lot 
less buggy, than anything you would likely implement to replace it.

In a few *very specialized* applications, in specific network 
conditions, UDP can provide better performance.  However, performance 
does not usually mean &quot;speed&quot; in those circumstances; it means the 
ability, for example, to drop a bunch of packets and then pick up again 
without catching up to the packets that were lost in the middle.  But 
picking up packets that were lost in the middle is a very useful 
feature, one that most applications rely on without even knowing it.
&gt;<i>2. Should I catch data in memory instead of write it to db immediately?
</I>
This question could mean almost anything.  However, writing to the 
database is simpler and less error-prone, so start there, and *only if 
the code is not fast enough*, add a caching optimization.  Caching is 
generally more useful on reads than writes, though, so I don't really 
understand your question.
&gt;<i>3. Could I make it run on cluster if cache data in memory  15 15 I think it
</I>&gt;<i>might be quit hard to exchange data between instances of the server if 
</I>&gt;<i>I
</I>&gt;<i>cache data in memory.
</I>
This is why you should
&gt;<i>4. How to make hot backup?
</I>
<A HREF="http://www.oracle.com/technology/documentation/berkeley-">http://www.oracle.com/technology/documentation/berkeley-</A> 
db/db/ref/transapp/archival.html

(This is not a helpful answer, but hints at the complexity of a real 
answer to this question, depending on the specifics of what database 
you're using.  It's not something for a one-liner in an email.)
&gt;<i>5. Garbage collection might make the server halt for a moment
</I>
Yep.  Of course, manual memory allocation might make the server halt 
forever, because it segfaulted.  Take your pick.
&gt;<i>6. What is happening in a computer when an IP package received?
</I>
Start here, and click on every link:

<A HREF="http://en.wikipedia.org/wiki/Internet_protocol_suite">http://en.wikipedia.org/wiki/Internet_protocol_suite</A>
&gt;<i>7. Could I get some inspiration from how people write web server?
</I>
Start here, and click on every link:

<A HREF="http://twistedmatrix.com/trac/browser/trunk/twisted/web/">http://twistedmatrix.com/trac/browser/trunk/twisted/web/</A>
&gt;<i>8. If i use an separate physical server to deploy the database, could I 
</I>&gt;<i>gain
</I>&gt;<i>some performance improvement?  Or the cost of communication between the 
</I>&gt;<i>db
</I>&gt;<i>and the server could hurt the total performance?
</I>
Maybe.  The way that you tell is not by asking a question on a mailing 
list, but by implementing a specific strategy and then measuring it to 
see what its bottlenecks are and where you can improve performance.  If 
your experience is anything like mine, you will discover something 
surprising.  For example, that everything except the server-side 
collision detection is so fast that you don't need to bother to optimize 
it, but the collision detection is so slow that you need to change it 
radically to even have the simulation keep up with wall clock time.
&gt;<i>Also, is there any classical books talking about these kind of issues?
</I>
I wrote an article in one once:

<A HREF="http://tinyurl.com/4yy8zx">http://tinyurl.com/4yy8zx</A>

but this book, nor any other, won't answer all your questions.  The 
field, and the industry, is way too new.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017431.html">[Twisted-Python] Performance issues of twisted.
</A></li>
	<LI>Next message: <A HREF="017434.html">[Twisted-Python] shared list in factory, mutexes?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17432">[ date ]</a>
              <a href="thread.html#17432">[ thread ]</a>
              <a href="subject.html#17432">[ subject ]</a>
              <a href="author.html#17432">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
