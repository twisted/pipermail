<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Simpler Twisted deferred code via decorated callbacks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Simpler%20Twisted%20deferred%20code%20via%20decorated%0A%20callbacks&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026126.html">
   <LINK REL="Next"  HREF="026128.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Simpler Twisted deferred code via decorated callbacks</H1>
    <B>Terry Jones</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Simpler%20Twisted%20deferred%20code%20via%20decorated%0A%20callbacks&In-Reply-To="
       TITLE="[Twisted-Python] Simpler Twisted deferred code via decorated callbacks">terry at jon.es
       </A><BR>
    <I>Mon Oct 15 14:54:04 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="026126.html">[Twisted-Python] Simpler Twisted deferred code via decorated	callbacks
</A></li>
        <LI>Next message: <A HREF="026128.html">[Twisted-Python] Simpler Twisted deferred code via decorated	callbacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26127">[ date ]</a>
              <a href="thread.html#26127">[ thread ]</a>
              <a href="subject.html#26127">[ subject ]</a>
              <a href="author.html#26127">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Naveen

&gt;<i> This is a really nice approach.
</I>
I'm glad you like it. I've learned over the years to avoid decorators, but
I nevertheless think these ones are promising.

&gt;<i> Are there any downsides or functionality that can't be accomplished using
</I>&gt;<i> this approach?
</I>
The main thing that's a little different is that it doesn't (yet) help with
situations where you might want finer-grained control over callbacks and
errbacks, or to use addBoth. I didn't want to tackle everything at once.
Because the approach is all just normal deferreds, there was no need to.

I wasn't sure what to do about addBoth - add a new decorator for it, let
people use both decorators, etc.  You can still just do this:

    def both(result):
        # do something

    @callback
    def first(result):
        # do something

    @callback
    def second(result):
        # do something

    second(first(getPage('<A HREF="http://www.something.com'">http://www.something.com'</A>)).addBoth(both)

The regular non-decorated Twisted code would be:

    def both(result):
        # do something

    def first(result):
        # do something

    def second(result):
        # do something

    getPage('<A HREF="http://www.something.com'">http://www.something.com'</A>).addCallback(first)
        .addBoth(both).addCallback(second)


As another example, in regular Twisted code you might want to do this:

    d = getDeferred()
    d.addCallback(f1)
    d.addCallbacks(f2, e1)

Many people don't understand that that's not the same as

    d = getDeferred()
    d.addCallback(f1)
    d.addCallback(f2)
    d.addErrback(e1)

The decorator approach doesn't provide directly for the former. You get the
latter of course by writing e1(f2(f1(getDeferred))).  You could have the
former via f1(getDeferred).addCallbacks(f2, e1) in which case the
decorators aren't buying you much.

So I think there's some way to go on that front, but I've not yet thought
about what would be most elegant/simple etc.  Given a nice way to do
addCallbacks, it can be used to implement addBoth (as in defer.py), so
these two examples are really just the same thing.

Glyph suggested I post with a simple example explaining exactly what the
decorators are doing. I plan do that.

Terry

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026126.html">[Twisted-Python] Simpler Twisted deferred code via decorated	callbacks
</A></li>
	<LI>Next message: <A HREF="026128.html">[Twisted-Python] Simpler Twisted deferred code via decorated	callbacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26127">[ date ]</a>
              <a href="thread.html#26127">[ thread ]</a>
              <a href="subject.html#26127">[ subject ]</a>
              <a href="author.html#26127">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
