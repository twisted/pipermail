<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Pyjamas%20%2B%20web2py%20%2B%20twisted%20vs%20Django%20%2B%20Pinax&In-Reply-To=%3Cced5f0f60909241353s7a970cdbk4404673451a4c742%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="053016.html">
   <LINK REL="Next"  HREF="053020.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax</H1>
    <B>Luke Kenneth Casson Leighton</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Pyjamas%20%2B%20web2py%20%2B%20twisted%20vs%20Django%20%2B%20Pinax&In-Reply-To=%3Cced5f0f60909241353s7a970cdbk4404673451a4c742%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax">luke.leighton at googlemail.com
       </A><BR>
    <I>Thu Sep 24 14:53:12 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="053016.html">[Twisted-Python] Unit tests, inline callbacks,	and exception handling
</A></li>
        <LI>Next message (by thread): <A HREF="053020.html">[Twisted-Python] Trial: Blocking until all deferreds have fired in	test
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53017">[ date ]</a>
              <a href="thread.html#53017">[ thread ]</a>
              <a href="subject.html#53017">[ subject ]</a>
              <a href="author.html#53017">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In-Reply-To=65BAE9EEDADD409CA83C32F2E54A0CB9%40Podcaster

sorry, folks: i didn't see this message, and it's taken me ten months
of obscure searches to find it.

&gt;<i> &gt; I'm about to start programming a game in Python. The game will
</I>&gt;<i> &gt; be a web-based board game with a social aspect, something like
</I>&gt;<i> &gt; <A HREF="http://www.chesspark.com.">http://www.chesspark.com.</A> I want the game to run in both browsers
</I>&gt;<i> &gt; and as a desktop client.
</I>
 and presumably you don't want to duplicate effort.  ergo, pyjamas
 is a good choice.  actually... it's your _only_ python choice
 if you don't want to burden the users.

 your other choices are: adobe AIR, silverlight, and, more recently,
 appcelerator.  appcelerator is interesting: you get to run IronPython
 because appcelerator's &quot;titanium&quot; is actually a silverlight / browser
 plugin that gives IronPython apps access to the DOM model of the
 browser.


&gt;<i> &gt; Therefore I'm wondering what python-based
</I>&gt;<i> &gt; technologies I need. I know that Javascript/AJAX is necessary for
</I>&gt;<i> &gt; the browser part so I have decided on the following:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1. Pyjamas -  (for the AJAX browser stuff)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 2. Pyjamas-desktop - (for the desktop client)
</I>
 pyjamas-desktop now has XULrunner and MSHTML as back-end engines.
 the MSHTML one is particularly strategically significant, as the
 only real requirements are, instead of a whopping 30mb bundle
 including gtk, cairo, xulrunner, pygtk, pycairo, pygobject _and_
 not to mention python itself, you can just install... python-comtypes
 (which is a 200k download).  for the POSIX-compliant systems, such
 as debian, there's &quot;apt-get install hulahop&quot;, and you get python-xpcom,
 xulrunner and all other dependencies pulled in &quot;for free&quot;.

 &gt; &gt; 3. Web2py (or djanjo, or django+pinax)  - for the website on
which the game will run and for database access and social part -
login, chat, members, profiles, game history, etc.)
&gt;<i> &gt;
</I>&gt;<i> &gt; 4. Twisted - for the networking and chat functionality.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I don't know if Pygame is necessary for a board-type game.)
</I>
 no, it's not.  i wrote a board-type game &quot;meta-engine&quot; which involved
 moving of pyjamas.ui.Image &quot;tokens&quot; around a pyjamas.ui.AbsolutePanel
 and it was incredibly simple and it actually worked.  i went to a lot
 of trouble to use the django server and AJAX (actually JSONRPC) to
 communicate &quot;moving&quot; of tokens.  as one user moved a token, the fact
 that it had &quot;moved&quot; would be noted in a database table
 (id, game_session_id, user_id, token_id)
 of course obviously excluding the user who had moved it.

 a continuous poll by a user of the database would empty the table
 of &quot;moved&quot; notifications for that user, and return a list of new
 position info for the tokens that needed to be moved.

 update speed turned out to be about 1-2 frames per second: perfectly
 adequate for a board game.

 oh: for &quot;Go&quot;, due to the number of tokens, however, i found
 that over 700 tokens resulted in _considerably_ slow Firefox 2
 initialisation times, which turns out to be a known bug in Firefox 2.
 adding over 256 absolute-positioned items to a div element using
 DOM manipulation is *SEVERELY* cpu-intensive: beyond some sort of
 fixed limit, adding elements turns from O(N) to O(N^2).  for full information
 on the issue, courtesy of john gunther, and a solution, see:
 <A HREF="http://pyjamas.svn.sourceforge.net/viewvc/pyjamas/trunk/library/pyjamas/chart/GChartWidgets.py?view=log">http://pyjamas.svn.sourceforge.net/viewvc/pyjamas/trunk/library/pyjamas/chart/GChartWidgets.py?view=log</A>

 i also added &quot;spectators&quot; which were simply &quot;users with no rights
 to move tokens&quot;.  they got their own &quot;chat&quot; channel so as not to
 interfere with the players.

 twisted users are probably screaming loudly at the &quot;polling&quot; technique
 especially one that hammers a database so heavily, but hey, you can't
 have everything :)  if anyone knows of any better event-driven methods
 including example code that can be queried with JSONRPC i'm _really_
 interested to hear about it.  think in terms of &quot;don't respond to the
 JSONRPC request unless either 15 seconds has passed, or there are some
 events which have been triggered by other users&quot;.

 yes i fully understand the complexities involved and that one possible
 implementation is a single-process asynchronous JSONRPC HTTP service,
 which is _nasty_ as hell: i'm interested to hear if there's anything
 better.

&gt;<i> &gt; My understanding of the above technologies is still limited and I'm not sure if I need all of these because some functionality may be overlapped. e.g. I don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Can someone please give me some advice?
</I>&gt;<i>
</I>&gt;<i> That's a fine laundry list of frameworks, but i believe getting all of
</I>&gt;<i> them to cooperate would be practically impossible.  (Note: a framework
</I>&gt;<i> is a library that's grown to the point where it thinks it owns your
</I>&gt;<i> whole program.  Getting multiple frameworks to play nicely together is
</I>&gt;<i> usually hard.  There are rare exceptions, like the beautiful integration
</I>&gt;<i> between Twisted and PyGTK, but they're rare.)
</I>
 the integration point of choice between pyjamas and frameworks is JSONRPC,
 simply because it was the first one that was implemented, and it's turned
 out to be incredibly practical.

 examination of the wiki <A HREF="http://code.google.com/p/pyjamas/wiki">http://code.google.com/p/pyjamas/wiki</A> shows
 over 90% of the wiki pages are &quot;how to use pyjamas with &lt;insert framework&gt;&quot;.
 including two or three methods for twisted, and two or more with django.


&gt;<i> I know that Django and pygame and Twisted are useful, mature, documented
</I>&gt;<i> frameworks that actually get used in production by people other than
</I>&gt;<i> their authors.  I don't know about Pyjamas.
</I>
 <A HREF="http://pyjs.org/FAQ.html">http://pyjs.org/FAQ.html</A> &quot;i'm a bit underwhelmed by the apparent lack
 of documentation&quot;: says &quot;go back to main site, <A HREF="http://pyjs.org,">http://pyjs.org,</A> see
 Documentation section&quot; which has these:

 <A HREF="http://pyjs.org/api">http://pyjs.org/api</A>
 <A HREF="http://pyjs.org/book/output/Bookreader.html">http://pyjs.org/book/output/Bookreader.html</A>
 still relevant, because the U.I API hasn't really changed:
 <A HREF="http://code.google.com/webtoolkit/documentation">http://code.google.com/webtoolkit/documentation</A>
 for best results, read:
 <A HREF="http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/index.html">http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/index.html</A>
 specifically the U.I &quot;package&quot;:
 <A HREF="http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/package-summary.html">http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/package-summary.html</A>



&gt;<i> If putting 100% Python in one end and getting Ajax out the other is
</I>&gt;<i> really important to you, then you need Pyjamas to work.  (Or wait for
</I>&gt;<i> PyPy and its JavaScript backend to mature from experimental research
</I>&gt;<i> code to production-quality stuff.)
</I>
 that's not going to happen.  the pypy javascript back-end has been
 abandoned.  it's still available in a branch, but you are not going
 to get anywhere with it.  plus, due to the fact that the sole and
 exclusive focus of the pypy javascript back-end is to be totally
 100% python interoperable, to the absolute exclusion of all else
 (e.g. speed), even if you got it going, you'd find that apps ran
 like treacle.  then, if you tried to debug the app, you'd find that
 it was near-impossible, because the code is near-pure-assembler-like,
 having gone through rpython, first.  being utterly divorced from its
 original python, you are entirely at the mercy of the pypy developers
 for bug-fixes aaand... they've abandoned it.

 bottom line: forget pypy.

&gt;<i> So my advice is to write a simple
</I>&gt;<i> tic-tac-toe game in Pyjamas, and find out.
</I>
 or a lightout game.  <A HREF="http://pyjs.org/examples/lightout/output/lightout.html">http://pyjs.org/examples/lightout/output/lightout.html</A>
 or a sudoku game. <A HREF="http://lkcl.net/sudoku/output/Sudoku.html">http://lkcl.net/sudoku/output/Sudoku.html</A>
 (in each case, full source code is 1 level below)

 of course, these are single-user games.  what you should be slightly
 surprised by is the fact that the source code of each app is so damn
 small.  the sudoku one, it hardly looks like there's any actual
 &quot;pyjamas&quot; code in it at all.  you have to _really_ peer very hard
 at the code, looking for clues such as &quot;ListBox&quot;, &quot;Grid&quot;, &quot;HTML&quot;
 and &quot;HorizontalPanel&quot; in order to discern the bits that just get
 on with serving up a sudoku game and the bits which &quot;glorify pyjamas&quot;
 so to speak.  &quot;oh look, there's a button.  i wonder if it calls
 this funny method named 'onClick' if the button gets clicked.  why
 yes, what a surprise, it does!&quot;

 anyway this is a bit long, i'll stop now :)

 l.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="053016.html">[Twisted-Python] Unit tests, inline callbacks,	and exception handling
</A></li>
	<LI>Next message (by thread): <A HREF="053020.html">[Twisted-Python] Trial: Blocking until all deferreds have fired in	test
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53017">[ date ]</a>
              <a href="thread.html#53017">[ thread ]</a>
              <a href="subject.html#53017">[ subject ]</a>
              <a href="author.html#53017">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
