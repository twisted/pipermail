<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Using reactor with multiple processes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Using%20reactor%20with%20multiple%20processes&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020440.html">
   <LINK REL="Next"  HREF="020444.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Using reactor with multiple processes</H1>
    <B>David Yoakley</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Using%20reactor%20with%20multiple%20processes&In-Reply-To="
       TITLE="[Twisted-Python] Using reactor with multiple processes">david.yoakley at gmail.com
       </A><BR>
    <I>Wed Sep 16 12:33:51 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020440.html">[Twisted-Python] Twisted Trial (unittest) and Ant
</A></li>
        <LI>Next message: <A HREF="020444.html">[Twisted-Python] Using reactor with multiple processes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20442">[ date ]</a>
              <a href="thread.html#20442">[ thread ]</a>
              <a href="subject.html#20442">[ subject ]</a>
              <a href="author.html#20442">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dimitri Vorona wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> i'd like to be able to start additional instances of my server using
</I>&gt;<i> multiprocess module. To do it i just start a new Process with
</I>&gt;<i> mutiprocessing and then create a new instance of my Application there.
</I>&gt;<i> Everything works fine, but i can't figure out a way to
</I>&gt;<i> stop such a process. If I run reactor.stop() in the child process I
</I>&gt;<i> get an infinite loop of errors looking like this:
</I>&gt;<i>
</I>
This is a very timely discussion for us.  We are trying to launch multiple
independent twistedized children with python multiprocess and yes (as Phil
noted) we are getting very strange results.  We were aware the multiprocess
module does a fork to spawn children but we hoping that this would not be an
issue for us because our parent process does NOT start a reactor before
spawning the children.  In fact even if our parent process never starts its
reactor, as soon as we spawn the 2nd twistedized child, bad things start
happening in the children.   The parent does import the child modules in
order to start them and since each child module also imports twisted, we are
thinking that some twisted state gets established just on the import of the
twisted reactor into the parent and then the fork clones that state into the
children.

Thanks Phil for the reference to ampoule.   We will look at that next.  We
are still hoping to get the parent set up in such a way that whatever the
forking :-) shared state is, it does not get established until after the
children are spawed. I'll post back later with what we find.  Phil your
thoughts on this would also be appreciated.

Cheers,
David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20090916/819d13b5/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20090916/819d13b5/attachment.htm</A> 
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020440.html">[Twisted-Python] Twisted Trial (unittest) and Ant
</A></li>
	<LI>Next message: <A HREF="020444.html">[Twisted-Python] Using reactor with multiple processes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20442">[ date ]</a>
              <a href="thread.html#20442">[ thread ]</a>
              <a href="subject.html#20442">[ subject ]</a>
              <a href="author.html#20442">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
