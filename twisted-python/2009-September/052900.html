<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted, wxPython &amp; PyPubSub
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2C%20wxPython%20%26%20PyPubSub&In-Reply-To=%3C4AA90363.50503%40arimaz.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052896.html">
   <LINK REL="Next"  HREF="052902.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted, wxPython &amp; PyPubSub</H1>
    <B>Gabriel Rossetti</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2C%20wxPython%20%26%20PyPubSub&In-Reply-To=%3C4AA90363.50503%40arimaz.com%3E"
       TITLE="[Twisted-Python] Twisted, wxPython &amp; PyPubSub">gabriel.rossetti at arimaz.com
       </A><BR>
    <I>Thu Sep 10 07:47:15 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052896.html">[Twisted-Python] Twisted, wxPython &amp; PyPubSub
</A></li>
        <LI>Next message (by thread): <A HREF="052902.html">[Twisted-Python] Twisted, wxPython &amp; PyPubSub
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52900">[ date ]</a>
              <a href="thread.html#52900">[ thread ]</a>
              <a href="subject.html#52900">[ subject ]</a>
              <a href="author.html#52900">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A> wrote:
&gt;<i> On 9 Sep, 07:12 am, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">gabriel.rossetti at arimaz.com</A> wrote:
</I>&gt;<i>   
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A> wrote:
</I>&gt;&gt;<i>     
</I>&gt;&gt;&gt;<i> On 02:21 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">gabriel.rossetti at arimaz.com</A> wrote:
</I>&gt;&gt;&gt;<i>       
</I>&gt;&gt;&gt;&gt;<i> Hello everyone,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I am using wx with twisted and pubsub (not the on in wx but the
</I>&gt;&gt;&gt;&gt;<i> independent one) to notify each one of what is going on. I was
</I>&gt;&gt;&gt;&gt;<i> wondering
</I>&gt;&gt;&gt;&gt;<i> if I should use reactor.callFromThread to call publisher.sendMessage 
</I>&gt;&gt;&gt;&gt;<i> or
</I>&gt;&gt;&gt;&gt;<i> not? I haven't been doing that until now but I wondered if it was
</I>&gt;&gt;&gt;&gt;<i> better to.
</I>&gt;&gt;&gt;&gt;<i>         
</I>&gt;&gt;&gt;<i> Use reactor.callFromThread if you have code running in a non-reactor
</I>&gt;&gt;&gt;<i> thread and you want it to initiate some action in the reactor thread.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So, if publisher.sendMessage is using Twisted APIs or otherwise 
</I>&gt;&gt;&gt;<i> requires
</I>&gt;&gt;&gt;<i> that it be run only in the reactor thread, and you need to use it from 
</I>&gt;&gt;&gt;<i> a
</I>&gt;&gt;&gt;<i> non-reactor thread, then use reactor.callFromThread.  Otherwise, 
</I>&gt;&gt;&gt;<i> don't.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Jean-Paul
</I>&gt;&gt;&gt;<i>       
</I>&gt;&gt;<i> Would you consider the wxreactor like a non-reactor thread?
</I>&gt;&gt;<i>     
</I>&gt;<i>
</I>&gt;<i> I'm not sure what you mean.  The &quot;reactor thread&quot; is the thread that 
</I>&gt;<i> &quot;reactor.run()&quot; is called in.  Even if you're using wxreactor.
</I>&gt;<i>   
</I>&gt;&gt;<i> I haven't
</I>&gt;&gt;<i> checked out the code behind PyPubSub, but it's basically the
</I>&gt;&gt;<i> Observer-Pattern so when I call publisher.sendMessage(...) it iterates
</I>&gt;&gt;<i> the &quot;subscribers&quot; (observers) and calls the functions they associated 
</I>&gt;&gt;<i> w/
</I>&gt;&gt;<i> the subscription. Those functions are both in the twisted code and the
</I>&gt;&gt;<i> wx code. The Twisted code sends messages nd the wx code brings-up/hides
</I>&gt;&gt;<i> dialogs or frames. In the wxdemo it does :
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # look, we can use twisted calls!
</I>&gt;&gt;<i> reactor.callLater(2, self.twoSecondsPassed)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> but doesn't use reactor.callFromThread, but unless I'm wrong
</I>&gt;&gt;<i> reactor.callLater does the same thing but deferred in time. I often see
</I>&gt;&gt;<i> reactor.callLater(0, myFunc) being used.
</I>&gt;&gt;<i>     
</I>&gt;<i>
</I>&gt;<i> The wx demo doesn't do anything with threads, so it doesn't need to use 
</I>&gt;<i> callFromThread.  So, if you're only doing things like what the wx demo 
</I>&gt;<i> does, you probably don't need callFromThread either.
</I>&gt;<i>
</I>&gt;<i> callLater doesn't do the same thing as callFromThread.  There might be 
</I>&gt;<i> some vague similarities (really the only one is that neither one calls 
</I>&gt;<i> the function you pass it right away), but they're for very different 
</I>&gt;<i> things.
</I>&gt;<i>
</I>&gt;<i> Jean-Paul
</I>&gt;<i>   
</I>
Ok, well, from looking into the twisted source, it looks like the wx 
main loop is run in a seperate thread 
(<A HREF="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/internet/wxreactor.py#L60">http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/internet/wxreactor.py#L60</A>). 
If this is correct, I don't think I can just call a function from the 
twisted code that will in turn call a function in the wx code anytime, 
because the wx event loop will be busy doing something else. It is the 
same the other way around, here is an example :

the user clicks on a button, this calls 
publisher.sendMessage(&quot;notify.server&quot;, button.name). The twisted code 
registered to receive this event and so did the wx code. The twisted 
code registered a callback that formats a message and sends it to the 
server, the wx code updates the status to &quot;pending&quot; on the gui. When the 
answer arrives from the server, this time the twisted code calls 
publisher.sendMessage(&quot;server.response&quot;, res) and wx had registered to 
receive this event to update the status to something else.

Now, since publisher.sendMessage() was called from wx, and from what I 
understand from the WxReactor class code it runs in a thread, then the 
callback on the twisted side should use reactor.callFromThread() 
shouldn't it (since it was called from a different thread), but not the 
callback in the wx code since it was called from the wx code? And when 
publisher.sendMessage() is called from twisted code, shouldn't I do the 
same, that is the callback in the twisted is just called and the 
callback in the wx code is called with wx.CallLater() (to schedule it's 
call in the main loop)?

Thank you,
Gabriel


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052896.html">[Twisted-Python] Twisted, wxPython &amp; PyPubSub
</A></li>
	<LI>Next message (by thread): <A HREF="052902.html">[Twisted-Python] Twisted, wxPython &amp; PyPubSub
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52900">[ date ]</a>
              <a href="thread.html#52900">[ thread ]</a>
              <a href="subject.html#52900">[ subject ]</a>
              <a href="author.html#52900">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
