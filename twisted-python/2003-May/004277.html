<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Safe Pickling using banana and jelly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Safe%20Pickling%20using%20banana%20and%20jelly&In-Reply-To=20030528044538.GC10429%40frobozz">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004266.html">
   <LINK REL="Next"  HREF="004242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Safe Pickling using banana and jelly</H1>
    <B>Heiko Wundram</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Safe%20Pickling%20using%20banana%20and%20jelly&In-Reply-To=20030528044538.GC10429%40frobozz"
       TITLE="[Twisted-Python] Safe Pickling using banana and jelly">heikowu at ceosg.de
       </A><BR>
    <I>Wed May 28 09:09:46 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004266.html">[Twisted-Python] Safe Pickling using banana and jelly
</A></li>
        <LI>Next message: <A HREF="004242.html">[Twisted-Python] sshclient and sshserver examples
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4277">[ date ]</a>
              <a href="thread.html#4277">[ thread ]</a>
              <a href="subject.html#4277">[ subject ]</a>
              <a href="author.html#4277">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 2003-05-28 at 06:45, Andrew Bennetts wrote:
&gt;<i> Twisted Spread is intended to be safe and secure, because data from the net
</I>&gt;<i> could be from anywhere, so it has to be robust in the face of dangerous
</I>&gt;<i> data.
</I>
I know, I was just being a little smartass... ;)

&gt;<i> That's what __getstate__ and __setstate__ are for with pickle; IIRC Jelly
</I>&gt;<i> supports that and also it's own 'getStateToCopyFor' or something along those
</I>&gt;<i> lines.
</I>
Sure it is, but both of them are called only for the topmost object from
the inheritance tree, which, when I use private variables, has little
chance to see the variables that are defined below in a way that's
suitable. And returning __dict__ is a little strange, as reassigning to
__dict__ in the __setstate__ mehod won't fix what I need...

&gt;<i> I'm sure PB can handle this.  Have you read &quot;PB Copyable: Passing Complex
</I>&gt;<i> Types&quot;, <A HREF="http://twistedmatrix.com/documents/howto/pb-copyable?">http://twistedmatrix.com/documents/howto/pb-copyable?</A> 
</I>
This is not about SenderPonds and ReceiverPonds, but about the simple
thing that LocalHost implements a few other data members, which should
not get sent over the wire, ever! (as e.g. private key, etc.) Of course,
I could use a getStateToCopyFor() to return only the data members that I
want to be returned, and be available in the remote object, but I think
that's kind of a hack... (remember, all my data elemens in all classes
are private) I think a solution which calls only the base classes
__serialize methods (in this example starting with Host) is cleaner.
(That's what aliases are all about.)

&gt;<i> &gt; 3. Support for different serialization protocols. I guess I've not made
</I>&gt;<i> I'm not quite sure what you're saying here.
</I>
The serializer supports different protocols right from the start. The
datastream is fixed format, but objects can choose to give unpickled
data storage different meaning according to the serialization protocol
that's chosen. What this works for: I have serialization to network and
serialization to database. To database shouldn't change timeouts, to
network should (what I stated last time). To database should store
private keys, to network shouldn't. Easy solution: Protocol 1 is the
network protocol, which has a alias from LocalHost to Host as specified
under 2, Protocol 2 is the Database protocol, which doesn't have this
alias.

&gt;<i> Again, read <A HREF="http://twistedmatrix.com/documents/howto/pb-copyable.">http://twistedmatrix.com/documents/howto/pb-copyable.</A>  With PB
</I>&gt;<i> you can control exactly what data is sent over the wire.  You also get
</I>&gt;<i> Referenceables, Copyables and Cacheables, which is considerably richer than
</I>&gt;<i> a simple object protocol that just passes the occasional object-graph.
</I>
I'm not using PB, and I don't want to in this project. PB is fine, when
you have to deal with complex objects (just as Pyro is in that case),
but normally, you only have to send simple objects over the wire, and I
guess you're much more worried about the fact that objects might be
instantiated wrongly/have to do some parameter checking/get corrupted on
transport/willfully. And control over this &quot;dark side of networking&quot; is
exactly what this pickler tries to achieve by giving you full control
over the pickling and unpickling process.

&gt;<i> TCP guarantees the data isn't corrupted on the way through.  Use SSL to 
</I>&gt;<i> guarantee that the traffic isn't being sniffed or tampered with in transit.
</I>&gt;<i> PB has an authentication step so that you can know who the clients are.
</I>&gt;<i> Between all this, I'm not sure what problem your signatures are solving that
</I>&gt;<i> isn't already solved?
</I>
The transport I use isn't TCP, but UDP. And rewriting PB to use UDP
would be a little strange... :) Anyway, what I actually meant by
signatures: You can use public key encryption/signing to encrypt members
of your data stream. Classes can request to have certain members
encrypted/signed in the serialization stream, just as you can for the
whole pickle, and when unserializing, you can specify what to do when
non-decryptable packets or invalid signature packets are found, without
discarding the whole pickle (which is useful, if you need to pass around
some structures which have private &quot;text&quot; content, but should
nevertheless be readable as to timeout and the like, the class being
called &quot;Data&quot;).

&gt;<i> As far as I can see (although I'm no PB expert), PB satisfies 1 and 4.  What
</I>&gt;<i> makes you think it doesn't?
</I>
PB could certainly be crafted to satisfy 1+4, but it certainly doesn't
do UDP transport, which I need... And I don't think any PB code which
handles most of the points above is as clean as it is with my own
serializer.

Which isn't bad, of course! PB was just designed with completely
different ideas in mind...

Again just my 5 cents... :)

Heiko.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004266.html">[Twisted-Python] Safe Pickling using banana and jelly
</A></li>
	<LI>Next message: <A HREF="004242.html">[Twisted-Python] sshclient and sshserver examples
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4277">[ date ]</a>
              <a href="thread.html#4277">[ thread ]</a>
              <a href="subject.html#4277">[ subject ]</a>
              <a href="author.html#4277">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
