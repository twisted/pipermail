<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] a tranceiver interface
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20a%20tranceiver%20interface&In-Reply-To=%3C20030529055030.GA64244%40doublegemini.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="036794.html">
   <LINK REL="Next"  HREF="036797.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] a tranceiver interface</H1>
    <B>Clark C. Evans</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20a%20tranceiver%20interface&In-Reply-To=%3C20030529055030.GA64244%40doublegemini.com%3E"
       TITLE="[Twisted-Python] a tranceiver interface">cce at clarkevans.com
       </A><BR>
    <I>Wed May 28 23:50:30 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="036794.html">[Twisted-Python] Woven example for article
</A></li>
        <LI>Next message (by thread): <A HREF="036797.html">[Twisted-Python] Sending and receiving mail in a Twisted app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36796">[ date ]</a>
              <a href="thread.html#36796">[ thread ]</a>
              <a href="subject.html#36796">[ subject ]</a>
              <a href="author.html#36796">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There are two forms of data flow constructs available, push and pull.  
The &quot;push&quot; based consumer/producer flow looks something like...

    class receiver:
        &quot;&quot;&quot; what is a consumer &quot;&quot;&quot;
        def start(self):
            'what is called to start the stream'
        def result(self, value):
            'what is called for each data item in the stream'
        def finish(self):
            'what is called at the end of the stream'

    class transmitter:
        &quot;&quot;&quot; what is a producer &quot;&quot;&quot;
        def __init__(self, receiver):
            self.receiver = consumer
            # push data to receiver when ready

    class tranceiver(receiver, transmitter):
        &quot;&quot;&quot; what is both a producer and a consumer
            by default, just be a simple 'passthrough'
        &quot;&quot;&quot;
        def start(self):
            self.receiver.start()
        def result(self, value):
            # process result
            self.receiver.result(value)
        def finish(self):
            self.receiver.finish()
    
The equivalent version of a 'passthrough' tranceiver in &quot;pull&quot; land 
can be written nicely as a generator:
 
    def consumer(producer):
        # start: what is called to start the stream
        for result in producer:
            # what is called for each data item in the stream
            yield result
        # finish: what is called at the end of the stream

What is intersting is that the producer is passed the consumer (not the 
other way around) as the 'push' example, and that the 3 states are 
encapsulated not by a particular callback function, but more by the 
position within the generator.  Unfortunately, direct use of generator 
like this doesn't give other operations a chance to process, but this 
shortcoming can be addressed by using the flow module:

    def consumer(producer):
        # start: what is called to start the stream
        producer = flow.wrap(producer)
        yield producer
        for result in producer:
            # what is called for each data item in the stream
            yield result
            yield producer
        # finish: what is called at the end of the stream

In this way, the consumer works exactly as it did before, only
that now other operations can proceed (if the producer is not
immediately ready) when &quot;yield producer&quot; is encountered.

Best,

Clark


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="036794.html">[Twisted-Python] Woven example for article
</A></li>
	<LI>Next message (by thread): <A HREF="036797.html">[Twisted-Python] Sending and receiving mail in a Twisted app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36796">[ date ]</a>
              <a href="thread.html#36796">[ thread ]</a>
              <a href="subject.html#36796">[ subject ]</a>
              <a href="author.html#36796">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
