<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Patch: Passive getSession for twisted.web.server.Request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Patch%3A%20Passive%20getSession%20for%20twisted.web.server.Request&In-Reply-To=%3C20030516143850.GA61048%40hecate.korpios.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="036617.html">
   <LINK REL="Next"  HREF="036618.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Patch: Passive getSession for twisted.web.server.Request</H1>
    <B>Tom 'Korpios' Tobin</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Patch%3A%20Passive%20getSession%20for%20twisted.web.server.Request&In-Reply-To=%3C20030516143850.GA61048%40hecate.korpios.net%3E"
       TITLE="[Twisted-Python] Patch: Passive getSession for twisted.web.server.Request">korpios at korpios.com
       </A><BR>
    <I>Fri May 16 08:38:50 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="036617.html">[Twisted-Python] Patch: Make twisted.web.distrib work with twisted.web.vhost
</A></li>
        <LI>Next message (by thread): <A HREF="036618.html">[Twisted-Python] Patch: Passive getSession for twisted.web.server.Request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36612">[ date ]</a>
              <a href="thread.html#36612">[ thread ]</a>
              <a href="subject.html#36612">[ subject ]</a>
              <a href="author.html#36612">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This patch adds an option to pass a named argument, passive, to twisted.web.server.Request's getSession method.  If passive is true, then getSession will check for the existence of a session or session cookie; it will not, however, drop a session cookie on the client if one does not already exist.  If there is no session, one would expect None from getSession in this case.

This is useful in conditions where one would like to check for (and use) a session if one already exists, but not necessarily drop a session cookie on every client which comes along.


--- server.py   Fri May 16 09:41:15 2003
+++ server-patched.py   Fri May 16 10:32:02 2003
@@ -305,7 +305,7 @@

     session = None

-    def getSession(self, sessionInterface = None):
+    def getSession(self, sessionInterface = None, passive = 0):
         # Session management
         if not self.session:
             cookiename = string.join(['TWISTED_SESSION'] + self.sitepath, &quot;_&quot;)
@@ -316,12 +316,13 @@
                 except KeyError:
                     pass
             # if it still hasn't been set, fix it up.
-            if not self.session:
+            if not self.session and not passive:
                 self.session = self.site.makeSession()
                 self.addCookie(cookiename, self.session.uid, path='/')
-        self.session.touch()
-        if sessionInterface:
-            return self.session.getComponent(sessionInterface)
+        if self.session:
+            self.session.touch()
+            if sessionInterface:
+                return self.session.getComponent(sessionInterface)
         return self.session

     def prePathURL(self):


Tom &quot;Korpios&quot; Tobin
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">korpios at korpios.com</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="036617.html">[Twisted-Python] Patch: Make twisted.web.distrib work with twisted.web.vhost
</A></li>
	<LI>Next message (by thread): <A HREF="036618.html">[Twisted-Python] Patch: Passive getSession for twisted.web.server.Request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36612">[ date ]</a>
              <a href="thread.html#36612">[ thread ]</a>
              <a href="subject.html#36612">[ subject ]</a>
              <a href="author.html#36612">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
