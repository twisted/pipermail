<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Request for help with Twisted bindings in	M2Crypto
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Request%20for%20help%20with%20Twisted%20bindings%20in%0A%09M2Crypto&In-Reply-To=%3CAFC57424-CA61-4587-986F-261BE3A8786B%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030636.html">
   <LINK REL="Next"  HREF="030640.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Request for help with Twisted bindings in	M2Crypto</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Request%20for%20help%20with%20Twisted%20bindings%20in%0A%09M2Crypto&In-Reply-To=%3CAFC57424-CA61-4587-986F-261BE3A8786B%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Request for help with Twisted bindings in	M2Crypto">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Jul 26 00:05:17 MDT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="030636.html">[Twisted-Python] Request for help with Twisted bindings in	M2Crypto
</A></li>
        <LI>Next message: <A HREF="030640.html">[Twisted-Python] Request for help with Twisted bindings in	M2Crypto
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30638">[ date ]</a>
              <a href="thread.html#30638">[ thread ]</a>
              <a href="subject.html#30638">[ subject ]</a>
              <a href="author.html#30638">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Jul 25, 2016, at 3:10 AM, Daniel Sank &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sank.daniel at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> I realize this is not the main point of this thread, but I'd like to make a comment regarding Twisted being opaque.
</I>&gt;<i> 
</I>&gt;<i> &gt; Twisted is open source, so none of the data types are opaque.
</I>&gt;<i> 
</I>&gt;<i> That's a non sequitur. A bunch of open source text in a language you don't understand is opaque, or perhaps better called &quot;obscure&quot;. Among other things, Twisted's use of interfaces makes the code very hard to understand.
</I>
This is not the first time that someone has made this comment, and I find it very discouraging.

An interface is a very simple concept - an abstract description of what an object is expected to provide if you're going to do something useful with it.  As a specific programmatic instantiation of this concept, zope.interface provides us with two chief advantages, one purely informational and one useful at run-time.  The informational one is that rather than saying &quot;this parameter must provide four methods, the first of which is makeConnection, the second of which is (optionally) connectionMade, the third of which is dataReceived, the fourth of which is connectionLost, which take parameters, respectively,...&quot; we can say &quot;@type: L{IProtocol} provider&quot;.  The programmatic advantage is that we can ask the question directly; not 'do you have attributes with these names' or 'does this function signature match', but IProtocol.providedBy(something), which asks if 'something' even _intends_ to implement all the relevant functionality described by IProtocol.

In my view, interface definition is the primary activity of software development; deciding how the pieces of the system fit together and precisely describing what they do.  The fact that so many people seem to find either the basic idea of an abstract type, or the concrete instantiation of that idea in the Zope Interface library, so horribly confusing, makes me despair of ever communicating the actually hard stuff that Twisted gets up to in its internals.

The main thing that I have heard in the past about what makes interfaces confusing is that people want to trace through the implementation to see what twisted is 'really doing', and the fact that there is -more than one- implementation of a method like 'listenTCP' is the source of the real confusion, underlying the problem with &quot;interfaces&quot;.  But, that's the whole point: 'listenTCP' is an abstract concept.  The better parts of twisted are _more_ abstract, like 'IStreamServerEndpoint.listen', which has dozens of implementations rather than just 3 or 4, or Deferred.callback, which might do anything at all - if the callback chain did one specific thing there would hardly be any point.

So, this is more just an emotional appeal from me, than anything the project needs, but I would very much like to understand *what* is so confusing about &quot;interfaces&quot;.  Is it, as Cory posited, just that the documentation is not properly linked?  Or is it that the average Python developer needs a gentle introduction to the entire idea of abstract rather than concrete types?  If they do - is it really Twisted's responsibility to provide it to them?  Should Zope Interface just have a snazzier website?

&gt;<i> &gt; Twisted is probably the best open source project I have worked with
</I>&gt;<i> &gt; in terms of having documentation which is generated from the code
</I>&gt;<i> 
</I>&gt;<i> I agree that the documentation is generally excellent and that the tests coverage is similarly excellent. However, I still find large fractions of the code very hard to comprehend. A while ago I made a serious effort to understand PB and fix some bugs, but the interface stuff combined with some very odd contortions of python class innards eventually lead me to give up. This is despite the friendly helpful attitude of the main developers both here and in IRC (seriously, thanks everyone for your help back then!).
</I>
Given that Twisted is often translating network protocol data into Python method calls, one needs both a working domain knowledge of the protocol involved and a robust understanding of Python metaprogramming constructs.  It sounds here like where you fell down was mostly in the &quot;Python metaprogramming&quot; area, where PB is especially intense.  Unfortunately, framework code just looks like that (the inner guts of Django are similarly, if not more, obscure, for example); it's not especially specific to Twisted.

Don't get me wrong, Python metaprogramming _is_ hard.  It's something that I know pretty well, but I can recognize that each additional layer of indirection is additional complexity for someone to learn, and metaprogramming is by definition at least 3 layers indirected from your actual problem.  But it's also not really specific to Twisted either.  This is another case where I'm not sure what to do except to refer people to the language reference and tell them to work through it slowly.

&gt;<i> I just randomly clicked through the docs to this: <A HREF="https://twistedmatrix.com/documents/current/api/twisted._threads.IWorker.html">https://twistedmatrix.com/documents/current/api/twisted._threads.IWorker.html</A> &lt;<A HREF="https://twistedmatrix.com/documents/current/api/twisted._threads.IWorker.html">https://twistedmatrix.com/documents/current/api/twisted._threads.IWorker.html</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> Note that:
</I>&gt;<i> 
</I>&gt;<i> 1. It is an interface, and I still don't _really_ understand what that means in Twisted.
</I>
The interface stuff in Twisted is a wholly separate library, 'zope.interface'.  You can read its documentation - both narrative tutorials and API documentation - here:

<A HREF="https://docs.zope.org/zope.interface/README.html">https://docs.zope.org/zope.interface/README.html</A>

This is referenced by the Twisted documentation which Cory referred to earlier, but I think it would be helpful to call that out specifically - you can read about interfaces completely separate from Twisted.  They don't mean anything special within Twisted itself (beyond our addition of registerAdapter, which is used less and less often in modern Twisted apps).

&gt;<i> 2. I have no idea what a &quot;task&quot; is. I realize this is python and yay duck-typing but not specifying the expected behavior of an argument seems like a big omission.
</I>
Did you miss the part where it said &quot;type: 0-argument callable&quot; in the documentation?  The expected behavior of the argument is that it is a thing that can be called, and it takes 0 arguments.  Its return value is unspecified because IWorker providers aren't allowed to use its return value.

&gt;<i> So, while the Twisted docs are great, consider not faulting people for being confused/daunted.
</I>
I don't want to fault people, and there are many issues we can address within Twisted's documentation.  For example, culling things from the API documentation and presenting it as it is really intended to be consumed, eliding private methods that have underscores or live in test_* packages to present a smaller surface, improving tutorial documentation, and so on.  It's not entirely the user's fault.

But certain things - the fact that we might have an abstract interface with multiple concrete implementations, for example - are inherent parts of the problem domain that Twisted is trying to address, and this is what Interfaces let us express.  When people have said things like &quot;Twisted's use of interfaces makes 

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20160725/933fed60/attachment-0001.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20160725/933fed60/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030636.html">[Twisted-Python] Request for help with Twisted bindings in	M2Crypto
</A></li>
	<LI>Next message: <A HREF="030640.html">[Twisted-Python] Request for help with Twisted bindings in	M2Crypto
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30638">[ date ]</a>
              <a href="thread.html#30638">[ thread ]</a>
              <a href="subject.html#30638">[ subject ]</a>
              <a href="author.html#30638">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
