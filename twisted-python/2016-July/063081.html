<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2016.3.0%20Prerelease%202%20Announcement&In-Reply-To=%3C7577C71C-E875-462C-9795-13AEC82D52F9%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="063030.html">
   <LINK REL="Next"  HREF="063019.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2016.3.0%20Prerelease%202%20Announcement&In-Reply-To=%3C7577C71C-E875-462C-9795-13AEC82D52F9%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Jul 20 22:36:10 MDT 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="063030.html">[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
</A></li>
        <LI>Next message (by thread): <A HREF="063019.html">[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63081">[ date ]</a>
              <a href="thread.html#63081">[ thread ]</a>
              <a href="subject.html#63081">[ subject ]</a>
              <a href="author.html#63081">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>My earlier replies to this thread were pretty terse, so just to expand on it:

&gt;<i> On Jul 13, 2016, at 3:39 AM, Cory Benfield &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">cory at lukasa.co.uk</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> On 13 Jul 2016, at 10:00, Paweł Miech &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">pawelmhm at gmail.com</A> &lt;mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">pawelmhm at gmail.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> &gt; Anyway, I’ll be spending my Twisted time on this for a while I suspect. This will delay HTTP/2 client support, unfortunately. =(
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Isn't it better to get HTTP2 client support and just document things better for HTTP2? Or maybe even backport some features from CertificateOptions to factory? DefaultSSLContextFactory seems to work ok for cases outside HTTP2.
</I>
It really doesn't.

&gt;&gt;<i> It is not evidently broken.
</I>
For clients, it's horribly broken and provides no security whatsoever.  For servers, it's badly configured enough that you will have problems with SSLLabs and other automated testing things.

&gt;&gt;<i> It is probably less secure than twisted.internet.ssl.CertificateOptions but is really broken beyond repair?
</I>
Yes, it really is.  The only reason we didn't just delete it immediately in a compatibility-breaking exception is that if you knew what you were doing, it was the only way to reasonably be secure in the past, and we did not want to punish those users who had done the best they could with what Twisted was giving them.  It was possible to make something secure with it, if you absolutely knew what you were doing and you layered a bunch of things on top of it.

&gt;<i> Generally speaking I’d say it isn’t better, for a couple of reasons.
</I>&gt;<i> 
</I>&gt;<i> Firstly, it rarely works well to document one’s way out of a usability problem. This is doubly-true when the *rest* of the documentation is contrary to what your new documentation would say. For example, the Twisted Web howto client documentation uses ClientContextFactory, which will be utterly unsuitable for HTTP/2.
</I>
Not to mention the fact that it provides no security.  Client-side, anything other than optionsForClientTLS is probably completely unacceptable.  Again… it was possible to add your own security to ClientContextFactory but that is the only reason we didn't delet it.

&gt;<i> More generally, having two different ways to do TLS, one of which is substantially less secure and powerful than the other, is a real problem. For example, DefaultSSLContextFactory literally only works for HTTP/2 servers by chance: it was never actually *designed* to work with ALPN and only managed to do so because we refactored the implementation to have the TLSMemoryBIOFactory apply the ALPN/NPN logic. In essence, by sheer bad luck we managed to change the HTTP/2 implementation to accidentally work with the old method, when it was never planned to do so.
</I>
In fairness, the fact that random accidents like this happen is as much a fault of OpenSSL's ... idiosyncratic, shall we say, API, where promiscuous mutable data sharing is completely the norm, as it is a fault of Twisted's bad early misinterpretation of said API.

&gt;<i> Worse, though, is that while the ContextFactory isn’t that bad for servers, it’s *terrible* for clients. In particular, the ClientContextFactory does not use SNI, does not validate hostnames, and generally speaking does not produce secure TLS. That means I’d want to prevent the HTTP/2 client from using the ClientContextFactory *anyway*: it’s really genuinely terrible and needs to be burned with fire.
</I>
TERRIBLE TERRIBLE TERRIBLE FOR CLIENTS DON'T USE IT

&gt;<i> If you’re interested in speeding up the arrival of HTTP/2 client support, then, the best way to do that is to help out with the deprecation effort. I’ve got patches open for the majority of the docs problems, and will be starting to work on the code problems over the next few days. All of these patches will require review, and other people writing patches will also speed things up.
</I>
+1000 thank you for saying this.

&gt;<i> Basically, I’m disinclined to want to prolong the lifetime of something that was supposed to go away two years ago. Twisted has a lot of things in it that were *supposed* to be deprecated but were never *actually* deprecated, and that kind of soft deprecation ends up causing the kind of problem we’ve bumped into here, whereby a lot of people have code that “works” with current features, but new features are designed only with an eye to the best practice. On a personal level, I want to push for Twisted to *actually* deprecate things that are soft deprecated. That has the best long-term effect on the project, by reducing the amount of code that needs to be maintained and encouraging users to move towards features that function better.
</I>
Basically I just wanted to chime in to make it clear that I _absolutely_ agree with _every_ part of this and we should _immediately_ move to implement all of these plans.  Cory, I also really appreciate you going through and taking the time to clear up the messaging around these APIs in our documentation and our implementations to help users understand what's going on so you don't need to be a member of the Twisted cabal to get good security and modern protocol features.

Thanks,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20160720/d6b41953/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="063030.html">[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
</A></li>
	<LI>Next message (by thread): <A HREF="063019.html">[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63081">[ date ]</a>
              <a href="thread.html#63081">[ thread ]</a>
              <a href="subject.html#63081">[ subject ]</a>
              <a href="author.html#63081">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
