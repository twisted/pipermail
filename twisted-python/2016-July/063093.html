<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Request for help with Twisted bindings in	M2Crypto
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Request%20for%20help%20with%20Twisted%20bindings%20in%0A%09M2Crypto&In-Reply-To=%3CCAG%3DrPVfJhSZgoVuSoQ93YvkcDA%3D3kTgaB9wJRwOf9_neiiPPMA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="063092.html">
   <LINK REL="Next"  HREF="063094.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Request for help with Twisted bindings in	M2Crypto</H1>
    <B>Craig Rodrigues</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Request%20for%20help%20with%20Twisted%20bindings%20in%0A%09M2Crypto&In-Reply-To=%3CCAG%3DrPVfJhSZgoVuSoQ93YvkcDA%3D3kTgaB9wJRwOf9_neiiPPMA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Request for help with Twisted bindings in	M2Crypto">rodrigc at crodrigues.org
       </A><BR>
    <I>Mon Jul 25 03:55:11 MDT 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="063092.html">[Twisted-Python] Request for help with Twisted bindings in	M2Crypto
</A></li>
        <LI>Next message (by thread): <A HREF="063094.html">[Twisted-Python] Request for help with Twisted bindings in	M2Crypto
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63093">[ date ]</a>
              <a href="thread.html#63093">[ thread ]</a>
              <a href="subject.html#63093">[ subject ]</a>
              <a href="author.html#63093">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Jul 25, 2016 at 2:03 AM, MatÄ›j Cepl &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mcepl at cepl.eu</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> 2) Even more pressing is that the Twisted module breaks my tests when
</I>&gt;<i> porting to py3k (<A HREF="https://travis-ci.org/mcepl/M2Crypto/jobs/146633964">https://travis-ci.org/mcepl/M2Crypto/jobs/146633964</A>).
</I>&gt;<i> Given the opaque and complicated data types in Twisted, I see horribly
</I>&gt;<i> complicated task of diving into it in front of me and I am not eager.
</I>&gt;<i>
</I>
I call shenanigans on you.

Twisted is open source, so none of the data types are opaque.
Twisted is probably the best open source project I have worked with
in terms of having documentation which is generated from the code (
<A HREF="https://twistedmatrix.com/documents/current/api/">https://twistedmatrix.com/documents/current/api/</A> ).

Twisted is also absolutely *the* best project I have worked with in terms
of having unit tests with very high coverage
of the code.

If you are unfamiliar with Twisted's code and data types, and don't have
the energy to dig in,
then be honest about that, but don't accuse Twisted of being &quot;opaque&quot;,
because it isn't.

Regarding your code example which is failing,
your code is failing because you are intermixing bytes and strings which is
a big no-no for Python 3.

If I look at this line for example:
<A HREF="https://gitlab.com/m2crypto/m2crypto/blob/master/M2Crypto/SSL/TwistedProtocolWrapper.py#L357">https://gitlab.com/m2crypto/m2crypto/blob/master/M2Crypto/SSL/TwistedProtocolWrapper.py#L357</A>

I see the code is doing stuff like:
   data = ''
   encryptedData = ''

Those are of type str, and need to be of type bytes:

   data = b''
   encryptedData = b''

You need to clean stuff like that up in your code so that you are only
using bytes.

I've really learned this lesson very hard after contributing hundreds of
py3k fixes for Twisted:

      Python 2:
              type(str) == type(bytes)
              type(str)  != type(unicode)
              b&quot;foo&quot; == &quot;foo&quot;
              &quot;foo&quot; != u&quot;foo&quot;

      Python 3:
              type(str) != type(bytes)
              type(unicode) is Gone
              b&quot;foo&quot; != &quot;foo&quot;
              &quot;foo&quot; == u&quot;foo&quot;

There is lots of code out there which uses Python strings and bytes
interchangeably
which &quot;works&quot; under Python2, but breaks big time on Python 3.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20160725/e6733f8b/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="063092.html">[Twisted-Python] Request for help with Twisted bindings in	M2Crypto
</A></li>
	<LI>Next message (by thread): <A HREF="063094.html">[Twisted-Python] Request for help with Twisted bindings in	M2Crypto
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63093">[ date ]</a>
              <a href="thread.html#63093">[ thread ]</a>
              <a href="subject.html#63093">[ subject ]</a>
              <a href="author.html#63093">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
