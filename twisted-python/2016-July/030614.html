<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Windows buildbots and Appveyor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Windows%20buildbots%20and%20Appveyor&In-Reply-To=%3CCAEgpGv7ieBCRqY4K3R7GQ%2BNuin5xV%3DgU_QC275BQWx4vVwbhRA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030610.html">
   <LINK REL="Next"  HREF="030615.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Windows buildbots and Appveyor</H1>
    <B>Oliver Palmer</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Windows%20buildbots%20and%20Appveyor&In-Reply-To=%3CCAEgpGv7ieBCRqY4K3R7GQ%2BNuin5xV%3DgU_QC275BQWx4vVwbhRA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Windows buildbots and Appveyor">oliverpalmer at opalmer.com
       </A><BR>
    <I>Wed Jul 20 19:25:10 MDT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="030610.html">[Twisted-Python] Windows buildbots and Appveyor
</A></li>
        <LI>Next message: <A HREF="030615.html">[Twisted-Python] Windows buildbots and Appveyor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30614">[ date ]</a>
              <a href="thread.html#30614">[ thread ]</a>
              <a href="subject.html#30614">[ subject ]</a>
              <a href="author.html#30614">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If you or someone else ends up working on this I can attest that his setup
works well and will build C-extensions.  I've been using his script
extensively on pywincffi for Python 2.6+ and Python 3.3+ so far without
issues.  For reference, here's my yaml file:

    <A HREF="https://github.com/opalmer/pywincffi/blob/master/appveyor.yml">https://github.com/opalmer/pywincffi/blob/master/appveyor.yml</A>

Since Twisted is using tox I assume that either tox should setup the
environment or %PYTHON_VERSION% and %PYTHON_ARCH% need to be set by the
build matrix and tox would be called with the wrapper:

    cmd /E:ON /V:ON /C run_with_cmd.cmd tox &lt;arguments&gt;

For pywincffi I thought about writing a tox plugin to do the work of
setting up the environment but ended up deciding against it and using the
build matrix approach instead.  It kept it simple, made it easy for people
to see how the build was setup and adding new versions to the build became
a one or two line change.

I'm not sure about how others would feel about it but it seems like
expanding the build matrix and adding run_with_cmd would be a good way to
start testing against more versions and fixing the C-extension issue.
Improving the build on AppyVeyor might also help shed some light on the
existing test failures too maybe.

On Wed, Jul 20, 2016 at 6:32 PM, Craig Rodrigues &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rodrigc at crodrigues.org</A>&gt;
wrote:

&gt;<i> The Appveyor setup with Python 2.7 currently does not build any C
</I>&gt;<i> extensions.
</I>&gt;<i> This means that IOCP reactor is not currently built and none of the IOCP
</I>&gt;<i> tests are run in Appveyor.  I'm not sure offhand what the fix is,
</I>&gt;<i> but I notice that quite a few Python projects import this script from
</I>&gt;<i> Olivier Grisel:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://github.com/ogrisel/python-appveyor-demo/blob/master/appveyor/run_with_env.cmd">https://github.com/ogrisel/python-appveyor-demo/blob/master/appveyor/run_with_env.cmd</A>
</I>&gt;<i>
</I>&gt;<i> which sets the environment correctly for the Windows compilers, and
</I>&gt;<i> then uses the script from inside appveyor.yml with something like:
</I>&gt;<i> <A HREF="https://github.com/ogrisel/python-appveyor-demo/blob/master/appveyor.yml">https://github.com/ogrisel/python-appveyor-demo/blob/master/appveyor.yml</A>
</I>&gt;<i>
</I>&gt;<i> It would be nice if we could get the C extensions buildin in Appveyor.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The Appveyor setup does not have a Python 3 setup, so no Python 3 builds
</I>&gt;<i> are done.
</I>&gt;<i>
</I>&gt;<i> There used to be a Python 3 buildbot, and although many of the tests were
</I>&gt;<i> broken,
</I>&gt;<i> it was producing some interesting logs.  For example, I saw a lot of
</I>&gt;<i> warnings
</I>&gt;<i> in the SSL code where strings where being passed as arguments to API's
</I>&gt;<i> which
</I>&gt;<i> took bytes as arguments.
</I>&gt;<i>
</I>&gt;<i> Can we bring back at least one Windows Python 3 buildbot, and leave
</I>&gt;<i> it as an unsupported, on-demand environment?
</I>&gt;<i>
</I>&gt;<i> I am working on getting more Windows Python 3 tests to pass, so this
</I>&gt;<i> would be useful.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Craig
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20160720/6d3e16bf/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20160720/6d3e16bf/attachment.html</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030610.html">[Twisted-Python] Windows buildbots and Appveyor
</A></li>
	<LI>Next message: <A HREF="030615.html">[Twisted-Python] Windows buildbots and Appveyor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30614">[ date ]</a>
              <a href="thread.html#30614">[ thread ]</a>
              <a href="subject.html#30614">[ subject ]</a>
              <a href="author.html#30614">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
