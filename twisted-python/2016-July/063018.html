<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2016.3.0%20Prerelease%202%20Announcement&In-Reply-To=%3C7C50EE3F-7717-462E-B9DC-2782331DAED0%40lukasa.co.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="063017.html">
   <LINK REL="Next"  HREF="063020.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement</H1>
    <B>Cory Benfield</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2016.3.0%20Prerelease%202%20Announcement&In-Reply-To=%3C7C50EE3F-7717-462E-B9DC-2782331DAED0%40lukasa.co.uk%3E"
       TITLE="[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement">cory at lukasa.co.uk
       </A><BR>
    <I>Tue Jul 12 01:43:01 MDT 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="063017.html">[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
</A></li>
        <LI>Next message (by thread): <A HREF="063020.html">[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63018">[ date ]</a>
              <a href="thread.html#63018">[ thread ]</a>
              <a href="subject.html#63018">[ subject ]</a>
              <a href="author.html#63018">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On 11 Jul 2016, at 22:04, Paweł Miech &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">pawelmhm at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> This seems to suggest that Ubuntu 16.04 (the system I'm testing) does not support ciphers required by HTTP2. But nginx article about HTTP2 lists ubuntu as only linux like system that is able to support HTTP2 over ALPN which is required by Chrome: <A HREF="https://www.nginx.com/blog/supporting-http2-google-chrome-users/">https://www.nginx.com/blog/supporting-http2-google-chrome-users/</A> &lt;<A HREF="https://www.nginx.com/blog/supporting-http2-google-chrome-users/">https://www.nginx.com/blog/supporting-http2-google-chrome-users/</A>&gt;
</I>Sorry. To be clear, I was not responding to your specific needs but discussing Glyph’s wider point about alerting when bad configuration is present.

&gt;<i> I decided to verify tnginx statements and I tried to set up nginx with HTTP2 on ubuntu 16.04. It turns out this is possible and it works ok. I just followed this article here: <A HREF="https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-16-04">https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-16-04</A> &lt;<A HREF="https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-16-04">https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-16-04</A>&gt; This means that in principle Ubuntu 16.04 should be able to support HTTP2 and it has required TLS ciphers.
</I>&gt;<i> 
</I>&gt;<i> So the problem here is not about lack of OS support.
</I>&gt;<i> 
</I>&gt;<i> Looking into this nginx article they recommend two things that are part of manual setup which (maybe?) are required?
</I>&gt;<i> 
</I>&gt;<i> 1) They say ciphers should be set to ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;
</I>&gt;<i> 
</I>&gt;<i> This long string does not mean much to me, but reading email from Amber again I see it differs slightly from what she says Twisted uses. But one thing I'm wondering about is how do you guys know which ciphers are set in Twisted? Looking into source code of DefaultOpenSSLContextFactory I see context is created here: <A HREF="https://github.com/twisted/twisted/blob/3455a902fb15e732ee43b59f4d82a66b105351ba/twisted/internet/ssl.py#L107">https://github.com/twisted/twisted/blob/3455a902fb15e732ee43b59f4d82a66b105351ba/twisted/internet/ssl.py#L107</A> &lt;<A HREF="https://github.com/twisted/twisted/blob/3455a902fb15e732ee43b59f4d82a66b105351ba/twisted/internet/ssl.py#L107">https://github.com/twisted/twisted/blob/3455a902fb15e732ee43b59f4d82a66b105351ba/twisted/internet/ssl.py#L107</A>&gt; I dont see any point where there is a call that sets ciphers. Maybe this is done somewhere else? I tried grepping source for string mentioned by Amber but cant find it.
</I>
Ok, this is your problem.

DefaultOpenSSLContextFactory should have been deprecated a long time ago. It’s insecure, and in particular does not set a cipher string, so it uses DEFAULT. That will have all kinds of messed up priorities. For that reason, you should adjust your code to use OpenSSLCertificateOptions or, even better, use the TLS endpoint directly.

The TL;DR is: yes, it seems that DefaultOpenSSLContextFactory produces a context that is genuinely unacceptable for HTTP/2.

Cory

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20160712/bd554fb9/attachment-0002.html&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: &lt;/pipermail/twisted-python/attachments/20160712/bd554fb9/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="063017.html">[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
</A></li>
	<LI>Next message (by thread): <A HREF="063020.html">[Twisted-Python] Twisted 16.3.0 Prerelease 2 Announcement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63018">[ date ]</a>
              <a href="thread.html#63018">[ thread ]</a>
              <a href="subject.html#63018">[ subject ]</a>
              <a href="author.html#63018">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
