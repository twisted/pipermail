<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] IProtocolWithReactor,	or passing the reactor though to protocols
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20IProtocolWithReactor%2C%0A%09or%20passing%20the%20reactor%20though%20to%20protocols&In-Reply-To=%3C2BC1B82A-0D88-4110-A301-B5B51DCC6A89%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="063053.html">
   <LINK REL="Next"  HREF="063036.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] IProtocolWithReactor,	or passing the reactor though to protocols</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20IProtocolWithReactor%2C%0A%09or%20passing%20the%20reactor%20though%20to%20protocols&In-Reply-To=%3C2BC1B82A-0D88-4110-A301-B5B51DCC6A89%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] IProtocolWithReactor,	or passing the reactor though to protocols">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Jul 18 12:17:51 MDT 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="063053.html">[Twisted-Python] IProtocolWithReactor,	or passing the reactor though to protocols
</A></li>
        <LI>Next message (by thread): <A HREF="063036.html">[Twisted-Python] IProtocolWithReactor,	or passing the reactor though to protocols
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63055">[ date ]</a>
              <a href="thread.html#63055">[ thread ]</a>
              <a href="subject.html#63055">[ subject ]</a>
              <a href="author.html#63055">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Jul 18, 2016, at 12:53 AM, Amber Hawkie Brown &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">hawkowl at atleastfornow.net</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> On 18 Jul 2016, at 09:15, Glyph Lefkowitz &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On Jul 16, 2016, at 06:01, Amber Hawkie Brown &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">hawkowl at atleastfornow.net</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Yes, that ticket is almost what I want! That is a much better solution for Protocols.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> However, Factories still need the reactor given, and it seems really silly and very hard to explain why you both would need to create a Factory with a reference to a reactor, and then call reactor.listenTCP/endpoint.connect/listen, also with a reactor. I feel like one of these should really be able to tell the other.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Which factories need this reference given?  Some need a clock, for e.g. timeouts, but then... that's OK, give them a clock.  The fact that a parameter must sometimes be passed to two different places doesn't mean we shouldn't make it a parameter...
</I>&gt;<i> 
</I>&gt;<i> Yes, but it's a very big footgun. If we are using a custom reactor, we must pass it at every level of the stack, when the information can easily be got from other sources.
</I>
How is passing a reactor parameter a 'footgun'?  What is the misuse you anticipate that will cause people to habitually use incorrectly?

&gt;&gt;<i> Possibly the problem here is that 'doStart' and 'doStop' ought to receive the reactor passed to them as well.  And maybe something else, too, for that matter, like an address, or an endpoint - that interface has always been a bit annoyingly narrow.  But a concrete use-case would help here.
</I>&gt;<i> 
</I>&gt;<i> My use case is making it easier to write things that require the reactor not having to be given absolutely everywhere -- it's very very inpenetrable to look at every interface and see if it has a reactor parameter.
</I>
You have to look at every interface to see what other parameters it has though.  So I don't see how it is impenetrable.  In fact it's required :).

&gt;&gt;&gt;<i> This also doesn't fit the problem idnar raised on IRC -- that the reactor serving the connections may not be the one that the protocol wants to use, for whatever reason (gui reactor and a not gui reactor?)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This use-case doesn't make any sense, because if you want to have a GUI you need to use a GUI reactor for everything; the reference passed is the running reactor.
</I>&gt;<i> 
</I>&gt;<i> Different reactors in threads (e.g. gilectomy, STM).
</I>
In that case we'd need an API for getting the reactor for the current thread (ideally when the thread was started).  In that case it still wouldn't make much sense to pass a different one to a Protocol and a Factory.

&gt;&gt;&gt;<i> -- I can't say if #3205 has the same problems, but I believe it does. I guess then that's up to the protocol, but I kind of would like if all protocols had one consistent place for &quot;this is the reactor I should schedule things on&quot; -- and transport.reactor does not seem to be it, because that's still got the problem that idnar has raised.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Where did idnar raise this problem?  I am still not clear on exactly what we're talking about.
</I>&gt;<i> 
</I>&gt;<i> IRC, like I mentioned :)
</I>
It would be good to get a write-up of the whole problem first, then.  Making new functions that accept parameters is not a &quot;problem&quot; :).

-glyph



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="063053.html">[Twisted-Python] IProtocolWithReactor,	or passing the reactor though to protocols
</A></li>
	<LI>Next message (by thread): <A HREF="063036.html">[Twisted-Python] IProtocolWithReactor,	or passing the reactor though to protocols
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63055">[ date ]</a>
              <a href="thread.html#63055">[ thread ]</a>
              <a href="subject.html#63055">[ subject ]</a>
              <a href="author.html#63055">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
