<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Best way to trigger a future connection with	data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Best%20way%20to%20trigger%20a%20future%20connection%20with%0A%09data&In-Reply-To=%3CCAE_Hg6b%2BNXWEaE1cQoh_9ag4R9_EjJEfFRaogYzK%3DRpHR%3D%2BGUA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059674.html">
   <LINK REL="Next"  HREF="059677.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Best way to trigger a future connection with	data</H1>
    <B>Laurens Van Houtven</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Best%20way%20to%20trigger%20a%20future%20connection%20with%0A%09data&In-Reply-To=%3CCAE_Hg6b%2BNXWEaE1cQoh_9ag4R9_EjJEfFRaogYzK%3DRpHR%3D%2BGUA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Best way to trigger a future connection with	data">_ at lvh.io
       </A><BR>
    <I>Fri Jul 19 02:25:15 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059674.html">[Twisted-Python] Best way to trigger a future connection with data
</A></li>
        <LI>Next message (by thread): <A HREF="059677.html">[Twisted-Python] Best way to trigger a future connection with data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59676">[ date ]</a>
              <a href="thread.html#59676">[ thread ]</a>
              <a href="subject.html#59676">[ subject ]</a>
              <a href="author.html#59676">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Jul 19, 2013 at 10:19 AM, Nick Johnson &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Nick.Johnson at ed.ac.uk</A>&gt;wrote:

&gt;<i> Thanks lvh,
</I>&gt;<i>
</I>&gt;<i> I did have to override the buildProtocol method in the Factory but I
</I>&gt;<i> then set Protocol.factory to be equal to the Factory (ie,
</I>&gt;<i> myprotocol.factory=self).
</I>&gt;<i>
</I>
You could (perhaps should) do this by calling
ClientFactory.buildProtocol(self, addr).


&gt;<i> I'm still stuck however with what to do when I get more complex than
</I>&gt;<i> this simple case. For example, I use a callingLoop to call multiple
</I>&gt;<i> connections with a 0.1 second interval to launch jobs and each of those
</I>&gt;<i> connections does as mentioned by setting up a future connection to
</I>&gt;<i> retrieve the output, say 10 seconds later. There is going to be some
</I>&gt;<i> overlap, ie I might have launched 100 new jobs before the first one
</I>&gt;<i> fires it's task.callLater.
</I>&gt;<i>
</I>&gt;<i> Storing state in the factory class doesn't work in this case because
</I>&gt;<i> each new connection wont know whether to initiate a job or retrieve
</I>&gt;<i> output as I cannot pass it this extra information.
</I>&gt;<i>
</I>
I don't understand why not. Could you elaborate?

Either way, it seems to me that the API should be:

d = scheduleJob()
d.addCallback(getJob)

That is: only get the job once it has been scheduled. getJob would probably
have to be split up into something that delays (consider delayLater), and
something that actually gets the job.

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20130719/2d1407a6/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059674.html">[Twisted-Python] Best way to trigger a future connection with data
</A></li>
	<LI>Next message (by thread): <A HREF="059677.html">[Twisted-Python] Best way to trigger a future connection with data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59676">[ date ]</a>
              <a href="thread.html#59676">[ thread ]</a>
              <a href="subject.html#59676">[ subject ]</a>
              <a href="author.html#59676">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
