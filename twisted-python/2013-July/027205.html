<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Setting socket options before connect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Setting%20socket%20options%20before%20connect&In-Reply-To=%3C20130718121030.28793.406822642.divmod.xquotient.681%40top%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027204.html">
   <LINK REL="Next"  HREF="027206.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Setting socket options before connect</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Setting%20socket%20options%20before%20connect&In-Reply-To=%3C20130718121030.28793.406822642.divmod.xquotient.681%40top%3E"
       TITLE="[Twisted-Python] Setting socket options before connect">exarkun at twistedmatrix.com
       </A><BR>
    <I>Thu Jul 18 06:10:30 MDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027204.html">[Twisted-Python] Setting socket options before connect
</A></li>
        <LI>Next message: <A HREF="027206.html">[Twisted-Python] Setting socket options before connect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27205">[ date ]</a>
              <a href="thread.html#27205">[ thread ]</a>
              <a href="subject.html#27205">[ subject ]</a>
              <a href="author.html#27205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10:27 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">p.mayers at imperial.ac.uk</A> wrote:
&gt;<i>On 17/07/13 18:44, Glyph wrote:
</I>&gt;&gt;&gt;<i>Anyhow, I think this certainly means a ticket should be filed for
</I>&gt;&gt;&gt;<i>introducing some API - but it seems that a little more discussion
</I>&gt;&gt;&gt;<i>about what the API should be will still be necessary.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Agreed.  But then, it's been a couple days and nobody else has
</I>&gt;&gt;<i>contributed to this thread :-).
</I>&gt;<i>
</I>&gt;<i>Well, since I started it...
</I>&gt;<i>
</I>&gt;<i>Some kind of endpoint argument might be problematic for some use-cases. 
</I>&gt;<i>In particular, Twisted would have to know how to convert the argument 
</I>&gt;<i>into the value to pass into setsockopt() and possibly in a platform- 
</I>&gt;<i>specific way.
</I>&gt;<i>
</I>&gt;<i>The API as presented also omits the SOL.
</I>
It wasn't so much an API as a &quot;Hey, I have an idea... endpoints... here 
is an example I can think of in 10 seconds.&quot; :)
&gt;<i>I guess it might be ok if there was a way to reliably inject unknown 
</I>&gt;<i>options with arbitrary payloads, but I'm struggling to see a clean way 
</I>&gt;<i>to do this with a &quot;parse a string&quot;-style API.
</I>
I think you're talking about the fact that &quot;sockopts&quot; are random 
integers associated with other big piles of random integers.  Some of 
them are flags you turn on, but some come with random payloads of 
basically no possible known shape.

It sounds like you're trying to think of an API that will support any 
and all socket options without understanding them.  This API exists 
already.  It is `setsockopt`.  There's no reason to re-invent it.

I prefer the approach taken elsewhere in Twisted, where a particular 
option is given some consideration and an API that understands the 
option is introduced.  This approach certainly has its shortcomings - 
for example, it doesn't support arbitrary options. :)  Do people really 
like using `setsockopt` though?
&gt;<i>
</I>&gt;<i>So, vote me +0.5 for a &quot;pre-connect&quot; function.
</I>&gt;<i>
</I>&gt;<i>But but but...
</I>&gt;<i>
</I>&gt;<i>It might be possible to sidestep this entire issue by providing a clean 
</I>&gt;<i>way for an app to inject itself &quot;above&quot; the socket. I can think of a 
</I>&gt;<i>few use- cases for this, most notably things like cmsg/IP_HDRINCL which 
</I>&gt;<i>Twisted doesn't know about, and thus can't handle.
</I>&gt;<i>
</I>&gt;<i>So maybe the correct way to handle this is &quot;implement your own FD 
</I>&gt;<i>object&quot;?
</I>
Nothing stops anyone from doing this already, today.  Except that it's a 
lot of work and no one seems to want any of these features badly enough 
to do it.

Jean-Paul

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027204.html">[Twisted-Python] Setting socket options before connect
</A></li>
	<LI>Next message: <A HREF="027206.html">[Twisted-Python] Setting socket options before connect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27205">[ date ]</a>
              <a href="thread.html#27205">[ thread ]</a>
              <a href="subject.html#27205">[ subject ]</a>
              <a href="author.html#27205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
