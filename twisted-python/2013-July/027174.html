<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted web,	giant-file POST forwarding and early bail-out.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20web%2C%0A%09giant-file%20POST%20forwarding%20and%20early%20bail-out.&In-Reply-To=%3Cdf3d67b21ad5440e2731e2057a61ae19.squirrel%40webmail.xs4all.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059642.html">
   <LINK REL="Next"  HREF="059636.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted web,	giant-file POST forwarding and early bail-out.</H1>
    <B>Rob Meijer</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20web%2C%0A%09giant-file%20POST%20forwarding%20and%20early%20bail-out.&In-Reply-To=%3Cdf3d67b21ad5440e2731e2057a61ae19.squirrel%40webmail.xs4all.nl%3E"
       TITLE="[Twisted-Python] Twisted web,	giant-file POST forwarding and early bail-out.">rmeijer at xs4all.nl
       </A><BR>
    <I>Tue Jul  9 02:04:01 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059642.html">[Twisted-Python] AMQP listening and user-facing daemon
</A></li>
        <LI>Next message (by thread): <A HREF="059636.html">[Twisted-Python] Twisted web, giant-file POST forwarding and early bail-out.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27174">[ date ]</a>
              <a href="thread.html#27174">[ thread ]</a>
              <a href="subject.html#27174">[ subject ]</a>
              <a href="author.html#27174">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everyone,

I'm working on what is just my second project using Twisted-Web, so I'm
still a relative newbee on the subject.

I'm working on a project that uses Twisted Web as a simple authorization
proxy. All requests to my proxy contain an authorization-token and are
either handled by the proxy, or are relayed to an other server. For all
GET stuff and small POST stuff this is not a problem. When I want to
process large POST requests however, I run into my limits of understanding
how Twisted Web actually works.

1) I figured out that next to the 'process' in my request handler, I need
to also overload handleContentChunk, parse the form body-parts in the
first chunk myself and open a proxy connection (self.agent.request) if the
authorization token checks out.

2) When it comes to appending the data received in handleContentChunk, and
if needed throttling the client if the server couldn't keep up,  I can't
figure out how to connect handleContentChunk and my self.agent.request
instance.

3) When the token does not check out, or the connection to the server
fails, it remains a mystery to me how I should throw an error in such a
way that it allows me to send a proper error message to the client, while
not having to first accept the whole large file. That is, it seems rather
silly that I would know things failed after the first POST body chunk, but
would have to wait for and accept hundreds of megabytes or maybe even a
few gigabytes of post data before I can notify the client that something
went wrong.


It seems I am either missing something blindingly obvious or Twisted Web
simply isn't meant to be used this way. I hope someone can give me some
directions how to make this giant-file-post forwarding and early-bail-out
scenario working with Twisted Web.

T.I.A.

Rob Meijer


</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059642.html">[Twisted-Python] AMQP listening and user-facing daemon
</A></li>
	<LI>Next message (by thread): <A HREF="059636.html">[Twisted-Python] Twisted web, giant-file POST forwarding and early bail-out.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27174">[ date ]</a>
              <a href="thread.html#27174">[ thread ]</a>
              <a href="subject.html#27174">[ subject ]</a>
              <a href="author.html#27174">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
