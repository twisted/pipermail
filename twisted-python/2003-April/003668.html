<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] UDP servers and socket queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20UDP%20servers%20and%20socket%20queues&In-Reply-To=20030421182956.GB10336%40wildfire0.net.ic.ac.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003652.html">
   <LINK REL="Next"  HREF="003669.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] UDP servers and socket queues</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20UDP%20servers%20and%20socket%20queues&In-Reply-To=20030421182956.GB10336%40wildfire0.net.ic.ac.uk"
       TITLE="[Twisted-Python] UDP servers and socket queues">tv at twistedmatrix.com
       </A><BR>
    <I>Tue Apr 22 02:30:56 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="003652.html">[Twisted-Python] UDP servers and socket queues
</A></li>
        <LI>Next message: <A HREF="003669.html">[Twisted-Python] UDP servers and socket queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3668">[ date ]</a>
              <a href="thread.html#3668">[ thread ]</a>
              <a href="subject.html#3668">[ subject ]</a>
              <a href="author.html#3668">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Apr 21, 2003 at 07:29:56PM +0100, Phil Mayers wrote:
&gt;<i> I figured something like that. Does anyone know if the various socket
</I>&gt;<i> readiness abstractions (select(), poll(), kqueue, RT signals, etc.)
</I>&gt;<i> given you sufficient information to know when you can do multiple reads?
</I>
	Yes. All of them. If you want to empty the channel, read until
	it would block. Same for writing..

&gt;<i> The other option I guess would be to for connection-less sockets to do:
</I>&gt;<i> 
</I>&gt;<i> while 1:
</I>&gt;<i>     try:
</I>&gt;<i>         data, addr = self.socket.recvfrom(65535)
</I>&gt;<i>         self.protocol.datagramReceived(data, addr)
</I>&gt;<i>     except socket.error, se:
</I>&gt;<i>         if se.args[0]==errno.EWOULDBLOCK:
</I>&gt;<i>             break
</I>&gt;<i>     except:
</I>&gt;<i>         log.deferr()
</I>&gt;<i> 
</I>&gt;<i> ...in doRead (line 91, twisted/internet/udp.py)?
</I>
	It should do this already, in any case. It's a bug it doesn't.
	select/poll/etc only give a hint that the fd might be
	readable; the code must _always_ be prepared for the fact that
	it might not be readable after all.



	But your basic problem is trying to use UDP where it doesn't
	work.  Even if you find some sufficient delays that make the
	system not lose packets in your specific case, changing any of
	the variables (upgrading CPU, NICs, switches, OS, ...) can
	make it fail again. You should use a protocol that doesn't
	rely on luck, except maybe for optimization.

-- 
:<i>(){ :|:&amp;};:
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003652.html">[Twisted-Python] UDP servers and socket queues
</A></li>
	<LI>Next message: <A HREF="003669.html">[Twisted-Python] UDP servers and socket queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3668">[ date ]</a>
              <a href="thread.html#3668">[ thread ]</a>
              <a href="subject.html#3668">[ subject ]</a>
              <a href="author.html#3668">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
