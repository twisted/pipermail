<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] enterprise.row
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20enterprise.row&In-Reply-To=%3C1049656171.6953.312.camel%40qutang.gnubian.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="035963.html">
   <LINK REL="Next"  HREF="035969.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] enterprise.row</H1>
    <B>Justin Ryan</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20enterprise.row&In-Reply-To=%3C1049656171.6953.312.camel%40qutang.gnubian.org%3E"
       TITLE="[Twisted-Python] enterprise.row">justin at gnubia.net
       </A><BR>
    <I>Sun Apr  6 15:21:12 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="035963.html">[Twisted-Python] enterprise.row
</A></li>
        <LI>Next message (by thread): <A HREF="035969.html">[Twisted-Python] enterprise.row
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35968">[ date ]</a>
              <a href="thread.html#35968">[ thread ]</a>
              <a href="subject.html#35968">[ subject ]</a>
              <a href="author.html#35968">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dave,

Thanks for your response / comments..

&gt;<i> I think your diagnosis is correct. The current t.e code does not handle
</I>&gt;<i> default values in the database schema, afaik. Given that, and the fact
</I>&gt;<i> that the reflector wants to cache rows by primary keys, it can't support
</I>&gt;<i> leaving primary keys unset before you create a new row.
</I>
I'm working on a patch that may allow this for key columns..

&gt;<i> What I have done with postgres is to generate the primay key using
</I>&gt;<i> the nextval function on the sequence used for the serial column, setting
</I>&gt;<i> the row object's primary key, and then inserting it. This makes the t.e
</I>&gt;<i> code happy and you often need to know the new key anyway.
</I>
This will work but imho is a bit silly and not generally the way that I
expect a database application to work.  If I set the default value on a
column, I shouldn't have to handle that in my code.  Additionally, if
you have a large development team with a DBA who manages the DB schema,
changing the default value for a column shouldn't require a db change
_and_ a code change.. that's inefficient and bug prone..

&gt;<i> It would be nice to make t.e allow for default values and db-generated
</I>&gt;<i> primary keys, but that code would almost certainly need to be 
</I>&gt;<i> per-database since different databases handle serial/autoincrement
</I>&gt;<i> columns differently.
</I>
I don't really see how allowing key columns to be ignored on an insert
would be database specific..  Ideally, whether or not a default value is
supplied by the database could be kept in rowColumns.  You could then
set a value to allow or disallow setting of key columns with a default
value provided by the database.  This would prevent twisted from
encountering errors, so long as you define your schema correctly. 
Additionally, it would be better for referential integrity's sake..

Anyway, I'd appreciate any comments on my ideas.  I'm evaluating
twisted, including t.e.row, as part of a proposal to migrate our entire
python toolkit to soap or xml-rpc using twisted.  Getting t.e.row to
work in such a way that our large database (515 relations, including
sequences) will not be at risk will be an important part of this task.

Cheers,

-Justin



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="035963.html">[Twisted-Python] enterprise.row
</A></li>
	<LI>Next message (by thread): <A HREF="035969.html">[Twisted-Python] enterprise.row
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35968">[ date ]</a>
              <a href="thread.html#35968">[ thread ]</a>
              <a href="subject.html#35968">[ subject ]</a>
              <a href="author.html#35968">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
