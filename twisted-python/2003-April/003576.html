<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Multiple simultaneous SelectReactors?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Multiple%20simultaneous%20SelectReactors%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003573.html">
   <LINK REL="Next"  HREF="003578.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Multiple simultaneous SelectReactors?</H1>
    <B>Peter Hansen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Multiple%20simultaneous%20SelectReactors%3F&In-Reply-To="
       TITLE="[Twisted-Python] Multiple simultaneous SelectReactors?">peter at engcorp.com
       </A><BR>
    <I>Mon Apr 14 21:36:06 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="003573.html">[Twisted-Python] Re: twisted.enterprise problem
</A></li>
        <LI>Next message: <A HREF="003578.html">[Twisted-Python] Multiple simultaneous SelectReactors?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3576">[ date ]</a>
              <a href="thread.html#3576">[ thread ]</a>
              <a href="subject.html#3576">[ subject ]</a>
              <a href="author.html#3576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There appear to be serious problems in several areas of twisted.internet
if one tries to create multiple SelectReactors to use at the same time.

Why would one want to?  For acceptance testing, when it can be desirable 
that the code under test run in the same process as the test code, but
it's not appropriate to share the Reactor.

I'm working on a few fixes, some of which appear to be latent bugs of
various kinds, but I'm still extremely new at Twisted and won't 
immediately be able to provide nice patches and such.

For now, I mainly have these questions:

1. Is Twisted expected to support this in principle, if not currently
in practice?

2. Are the globals &quot;reads&quot; and &quot;writes&quot; that are used in 
twisted.internet.default there solely for optimization purposes, or is
there some more nefarious purpose?  Is it considered absolutely critical
that this optimization is in place?  (If so, it probably makes it 
impossible to fix this limitation of Twisted.)

3. Is it well-known that the abstract.FileDescriptor class does a quiet
little fallback to the global reactor if you don't pass it a reactor reference, 
and that Port fails to pass in its own reactor reference when it creates
a Server object in doRead()?

We've strung together a variety of little changes in the process of 
figuring this out.  Once we're more confident of what we're doing,
I'd be happy to supply the fixes, but I'm not going to waste my time
if everyone thinks SelectReactor.doSelect() absolutely must do those
optimizations.

Also note: I'm working on the most recent released version, not CVS.
The slightest hint that this stuff is significantly changed in CVS 
will send me there, but until now we weren't confident enough with
Twisted to work from unreleased code.  (Actually, attempting to 
resolve this has slightly lowered my confidence in Twisted, but 
only just a bit.)

-Peter


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003573.html">[Twisted-Python] Re: twisted.enterprise problem
</A></li>
	<LI>Next message: <A HREF="003578.html">[Twisted-Python] Multiple simultaneous SelectReactors?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3576">[ date ]</a>
              <a href="thread.html#3576">[ thread ]</a>
              <a href="subject.html#3576">[ subject ]</a>
              <a href="author.html#3576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
