<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] enterprise.row
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20enterprise.row&In-Reply-To=1049574011.1503.45.camel%40qutang.gnubian.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003452.html">
   <LINK REL="Next"  HREF="003460.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] enterprise.row</H1>
    <B>Dave Peticolas</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20enterprise.row&In-Reply-To=1049574011.1503.45.camel%40qutang.gnubian.org"
       TITLE="[Twisted-Python] enterprise.row">dave at krondo.com
       </A><BR>
    <I>Sun Apr  6 04:49:06 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="003452.html">[Twisted-Python] enterprise.row
</A></li>
        <LI>Next message: <A HREF="003460.html">[Twisted-Python] enterprise.row
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3455">[ date ]</a>
              <a href="thread.html#3455">[ thread ]</a>
              <a href="subject.html#3455">[ subject ]</a>
              <a href="author.html#3455">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 2003-04-05 at 12:20, Justin Ryan wrote:
&gt;<i> &quot;ZONE_SOAID&quot; is the primary key for the &quot;ZONE_SOA&quot; table.  I did not set
</I>&gt;<i> the primary key because it is a postgres serial column - that is, it
</I>&gt;<i> should automatically increment the pkey each time a new row is
</I>&gt;<i> inserted.  If I use setKeyAttr(&quot;ZONE_SOAID&quot;, 1), the AttributeError
</I>&gt;<i> comes up for the next attribute that is not being given a value.
</I>&gt;<i> 
</I>&gt;<i> I read the row documentation a little more, and it doesn't appear to
</I>&gt;<i> like what I'm trying to do all too much.  I can use python to fill the
</I>&gt;<i> object with default values, but the database will do that for me, and
</I>&gt;<i> with less work on the part of my application (plus, the KeyFactory class
</I>&gt;<i> says it is not thread-safe, I know that my postgres series is).
</I>
I think your diagnosis is correct. The current t.e code does not handle
default values in the database schema, afaik. Given that, and the fact
that the reflector wants to cache rows by primary keys, it can't support
leaving primary keys unset before you create a new row.


&gt;<i> Is there any way for row to allow me to insert a new row with some empty
</I>&gt;<i> values, and simply ignore them (allowing the database to use its'
</I>&gt;<i> default)?  If not, any idears on where/how this might need to be done? 
</I>&gt;<i> Perhaps this is a good time for me to foray into twisted hacking..
</I>
What I have done with postgres is to generate the primay key using
the nextval function on the sequence used for the serial column, setting
the row object's primary key, and then inserting it. This makes the t.e
code happy and you often need to know the new key anyway.

It would be nice to make t.e allow for default values and db-generated
primary keys, but that code would almost certainly need to be 
per-database since different databases handle serial/autoincrement
columns differently.

dave

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20030406/f78f2a53/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-python/attachments/20030406/f78f2a53/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003452.html">[Twisted-Python] enterprise.row
</A></li>
	<LI>Next message: <A HREF="003460.html">[Twisted-Python] enterprise.row
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3455">[ date ]</a>
              <a href="thread.html#3455">[ thread ]</a>
              <a href="subject.html#3455">[ subject ]</a>
              <a href="author.html#3455">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
