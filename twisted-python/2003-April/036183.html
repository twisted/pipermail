<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] t.i.process uid/gid suckiness
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20t.i.process%20uid/gid%20suckiness&In-Reply-To=%3C20030422185921.GA19301%40lapdog%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="036182.html">
   <LINK REL="Next"  HREF="036214.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] t.i.process uid/gid suckiness</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20t.i.process%20uid/gid%20suckiness&In-Reply-To=%3C20030422185921.GA19301%40lapdog%3E"
       TITLE="[Twisted-Python] t.i.process uid/gid suckiness">tv at twistedmatrix.com
       </A><BR>
    <I>Tue Apr 22 12:59:21 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="036182.html">[Twisted-Python] t.i.process uid/gid suckiness
</A></li>
        <LI>Next message (by thread): <A HREF="036214.html">[Twisted-Python] t.i.process uid/gid suckiness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36183">[ date ]</a>
              <a href="thread.html#36183">[ thread ]</a>
              <a href="subject.html#36183">[ subject ]</a>
              <a href="author.html#36183">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Apr 22, 2003 at 06:28:26PM +0100, Phil Mayers wrote:
&gt;<i> No no no no. getgrall could theoretically return a *huge* number of
</I>&gt;<i> groups, and/or individual groups could have *huge* numbers of members.
</I>&gt;<i> For a system with /etc/passwd and /etc/group only, this doesn't matter,
</I>&gt;<i> but think about a system with an LDAP (RFC2307) nameservice backend - I
</I>&gt;<i> just tested it on my machine, and getgrall results in over 48Mb of
</I>&gt;<i> LDAP queries based on our ActiveDirectory groups. Many tens of seconds.
</I>&gt;<i> 
</I>&gt;<i> However, calling initgroups results in a single query:
</I>&gt;<i> 
</I>&gt;<i> memberUid=foo
</I>&gt;<i> 
</I>&gt;<i> ...and only returns the groupname and gid, so is efficient every time.
</I>
	Certainly you are correct. The point you are missing is
	that we are programming in Python, not in C. And Python does
	not have initgroups.

	We could add initgroups into eunuchs
	(<A HREF="http://twistedmatrix.com/users/tv/eunuchs/">http://twistedmatrix.com/users/tv/eunuchs/</A>), or use the
	initgroups module by one of the Twisted developers; the code
	could be rewritten to try importing the C part, and falling
	back to the dumb version. Then using the smart API would be a
	true optimization.

	However, before I touched it, the code did _NOTHING_ unless
	the C initgroups module was available. And that resulted in
	bad things.

&gt;<i> The &quot;right&quot; way to do this is the getgrouplist() call (see
</I>&gt;<i> <A HREF="http://www.openbsd.org/cgi-bin/man.cgi?query=getgrouplist">http://www.openbsd.org/cgi-bin/man.cgi?query=getgrouplist</A>) and if you
</I>&gt;<i> look at the NSS code in e.g. glibc the NSS modules can provide
</I>&gt;<i> &quot;efficient&quot; hooks which initgroups() and getgrouplist() can implement.
</I>&gt;<i> initgroups() in glibc basically calls getgrouplist() on the NSS plugin
</I>&gt;<i> and so whilst the *result* is the same, you're taking the slow path.
</I>
	getgrouplist() is as much missing from python stdlib as
	initgroups(), so you aren't really helping there.

-- 
:<i>(){ :|:&amp;};:
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="036182.html">[Twisted-Python] t.i.process uid/gid suckiness
</A></li>
	<LI>Next message (by thread): <A HREF="036214.html">[Twisted-Python] t.i.process uid/gid suckiness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36183">[ date ]</a>
              <a href="thread.html#36183">[ thread ]</a>
              <a href="subject.html#36183">[ subject ]</a>
              <a href="author.html#36183">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
