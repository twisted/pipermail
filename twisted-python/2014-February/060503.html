<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Deadlocks when launching processes - how to	investigate?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Deadlocks%20when%20launching%20processes%20-%20how%20to%0A%09investigate%3F&In-Reply-To=%3C85ED231F-BBCD-49B8-AB15-8A63AF14A0B9%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="060502.html">
   <LINK REL="Next"  HREF="060504.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Deadlocks when launching processes - how to	investigate?</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Deadlocks%20when%20launching%20processes%20-%20how%20to%0A%09investigate%3F&In-Reply-To=%3C85ED231F-BBCD-49B8-AB15-8A63AF14A0B9%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Deadlocks when launching processes - how to	investigate?">glyph at twistedmatrix.com
       </A><BR>
    <I>Sat Feb 15 12:58:34 MST 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="060502.html">[Twisted-Python] Deadlocks when launching processes - how to investigate?
</A></li>
        <LI>Next message (by thread): <A HREF="060504.html">[Twisted-Python] Deadlocks when launching processes - how to investigate?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60503">[ date ]</a>
              <a href="thread.html#60503">[ thread ]</a>
              <a href="subject.html#60503">[ subject ]</a>
              <a href="author.html#60503">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Feb 15, 2014, at 6:38 AM, Itamar Turner-Trauring &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">itamar at itamarst.org</A>&gt; wrote:

&gt;<i> In this particular case, the traceback plus some googling (<A HREF="http://bugs.python.org/issue11768">http://bugs.python.org/issue11768</A> is what I found, presumably a different bug though) suggests the bug may be something like signal handler not being re-entrant for some reason and you're getting SIGCHLD just in the C code handling SIGCHLD. Try disabling SIGCHLD and just calling &quot;twisted.internet.process.reapAllProcesses()&quot; a few times a second and see if that's a good workaround - if so, add a note to the bug. If that is the case you may be able to reproduce the bug by setting a SIGCHLD handler and then sending SIGCHLD to the process a lot, no Twisted involved.
</I>
This was also my reading of the stack trace.  Thanks for finding the reference in the Python bug tracker.

The one thing that confused me was that the sample program appeared to be running the program only once a second, and waiting for it to complete before running it again.  So how would the signal handler be re-entrant?  Perhaps 'pmset' runs a subprocess of its own so that the parent process receives two SIGCHLDs?

It looks like this fix might have been included in 2.7.6, since it was fixed on the 2.7 branch.  Has it been?

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20140215/75f8466b/attachment-0002.html&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4124 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20140215/75f8466b/attachment-0002.bin&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="060502.html">[Twisted-Python] Deadlocks when launching processes - how to investigate?
</A></li>
	<LI>Next message (by thread): <A HREF="060504.html">[Twisted-Python] Deadlocks when launching processes - how to investigate?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60503">[ date ]</a>
              <a href="thread.html#60503">[ thread ]</a>
              <a href="subject.html#60503">[ subject ]</a>
              <a href="author.html#60503">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
