<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Implement HTTP request acception / rejection as	defined in RFC 2616 - 8.2.3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Implement%20HTTP%20request%20acception%20/%20rejection%20as%0A%09defined%20in%20RFC%202616%20-%208.2.3&In-Reply-To=%3CCAFycZ9cHYv9xZAdPjSCYhwudQaLMrrV5CzBn_2SzZ8EXxLqH4g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Implement HTTP request acception / rejection as	defined in RFC 2616 - 8.2.3</H1>
    <B>Adi Roiban</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Implement%20HTTP%20request%20acception%20/%20rejection%20as%0A%09defined%20in%20RFC%202616%20-%208.2.3&In-Reply-To=%3CCAFycZ9cHYv9xZAdPjSCYhwudQaLMrrV5CzBn_2SzZ8EXxLqH4g%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Implement HTTP request acception / rejection as	defined in RFC 2616 - 8.2.3">adi at roiban.ro
       </A><BR>
    <I>Fri Feb 21 08:59:19 MST 2014</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60530">[ date ]</a>
              <a href="thread.html#60530">[ thread ]</a>
              <a href="subject.html#60530">[ subject ]</a>
              <a href="author.html#60530">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

As requested during review I am moving this to mailing list for discussions.

The initial ticket is here : <A HREF="https://twistedmatrix.com/trac/ticket/6928">https://twistedmatrix.com/trac/ticket/6928</A>

-------

The current Twisted implementation of RFC 2616 - 8.2.3 is very simple and
Twisted will always reply with continue to Accept: 100-continue requests.

I am working at web application based on Twisted web so I did a quick
security check for current twisted web code.

The major problem is that when reading POST data, requests under 1M are
kept in memory, the other being stored in temporary file... but for
form-mulipart request the whole data is loaded again in memory for parsing.
Now, if the client initially reports that content is less than 1M, but then
continue to send more than 1M, twisted.web will continue to keep all data
in memory.

To address the problem of unwanted big post requests I first start with
implementing support for well behaved HTTP/1.1 clients.

In current code, Resource objects are called only after whole request data
was received and processed so a resource can not decide whether or not it
accepts the request, just by looking at headers.

Also the Request object is called after headers are received but with calls
like parseCookie or gotLength. So there is no API for Request to accept or
reject a request based on headers.

--------

To solve this problem, I add a new `headersReceived` API call on Request
and Resource so that Requests and Resources can decided if they want to
accept the request.

The biggest change required to implement this API is that URL traversal can
now begin before a resource has received all its content.
If a resource needs full request content before making a traversal
decistion, then this API does not work.

This is why this is an optional API not enforced on all resources.

For now the ticket only has demo code as I wanted to highlight the API
changes.

I have already implemented this code in my project and wrote full test for
these changes.

If this kind of API is accepted in Twisted I can port the code and tests,
otherwise I can try to work on a different implementation.

Thanks!

-- 
Adi Roiban
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20140221/99fc1b81/attachment-0002.html&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60530">[ date ]</a>
              <a href="thread.html#60530">[ thread ]</a>
              <a href="subject.html#60530">[ subject ]</a>
              <a href="author.html#60530">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
