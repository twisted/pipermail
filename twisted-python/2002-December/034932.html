<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Creating a new selectable (for Pg async interface)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Creating%20a%20new%20selectable%20%28for%20Pg%20async%20interface%29&In-Reply-To=%3C20021216010549.GA1081%40frobozz.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="034931.html">
   <LINK REL="Next"  HREF="034933.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Creating a new selectable (for Pg async interface)</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Creating%20a%20new%20selectable%20%28for%20Pg%20async%20interface%29&In-Reply-To=%3C20021216010549.GA1081%40frobozz.local%3E"
       TITLE="[Twisted-Python] Creating a new selectable (for Pg async interface)">andrew-twisted at puzzling.org
       </A><BR>
    <I>Sun Dec 15 18:05:49 MST 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="034931.html">[Twisted-Python] Creating a new selectable (for Pg async interface)
</A></li>
        <LI>Next message (by thread): <A HREF="034933.html">[Twisted-Python] Creating a new selectable (for Pg async interface)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34932">[ date ]</a>
              <a href="thread.html#34932">[ thread ]</a>
              <a href="subject.html#34932">[ subject ]</a>
              <a href="author.html#34932">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Dec 16, 2002 at 12:47:22AM +0100, Gerhard H?ring wrote:
&gt;<i> &gt; &gt; Next question: I'd like to try my code out. Is there a good way to
</I>&gt;<i> &gt; &gt; test this under Twisted, apart from writing a little server like the
</I>&gt;<i> &gt; &gt; Echo example of the docs, and trying to call PgAsyncConn from it?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Well, look at how we do tests in twisted.test - you can write a unit
</I>&gt;<i> &gt; test suite for your code, with the limitation of course that you'd
</I>&gt;<i> &gt; need a live postgresql server to test it.
</I>&gt;<i> 
</I>&gt;<i> Uh, this seems hard. I believe I'd need to start a reactor in my test
</I>&gt;<i> case, as this is a client-side API only and there's no way I'll just
</I>&gt;<i> quickly implement PostgreSQL in Python. Any hints on how to do this?
</I>
Starting a reactor is easy:
    from twisted.internet import reactor
    # Make connections, schedule events, etc, here.
    reactor.run()

Of course, there's the problem of stopping the reactor.  Most of our test
cases do something more like:
    from twisted.internet import reactor
    self.done = 0
    # Do stuff
    while not self.done:
        reactor.iterate()

Then it's just a matter of making sure you set self.done when the test
passes or fails.  You could also set timeouts with something like
&quot;reactor.callLater(3, self.blowUp)&quot;, or by calling &quot;d.setTimeout(3,
self.blowUp)&quot; on an appropriate Deferred.  You should make sure you cancel
unfired timeouts, though, or they will interfere with later tests -- this is
a deficiency in the testing framework that we're hoping to fix at some
point.

As to starting PostgreSQL, I'd just make the test assume that PostgreSQL is
running.  Perhaps use the standard synchronous interface to test that it's
running, otherwise skip the tests?

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="034931.html">[Twisted-Python] Creating a new selectable (for Pg async interface)
</A></li>
	<LI>Next message (by thread): <A HREF="034933.html">[Twisted-Python] Creating a new selectable (for Pg async interface)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34932">[ date ]</a>
              <a href="thread.html#34932">[ thread ]</a>
              <a href="subject.html#34932">[ subject ]</a>
              <a href="author.html#34932">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
