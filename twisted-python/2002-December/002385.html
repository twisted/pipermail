<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: Long patch: Win32 Shortcuts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Long%20patch%3A%20Win32%20Shortcuts&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002383.html">
   <LINK REL="Next"  HREF="002380.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: Long patch: Win32 Shortcuts</H1>
    <B>Thomas Heller</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Long%20patch%3A%20Win32%20Shortcuts&In-Reply-To="
       TITLE="[Twisted-Python] Re: Long patch: Win32 Shortcuts">theller at python.net
       </A><BR>
    <I>Mon Dec  9 03:11:56 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="002383.html">[Twisted-Python] Long patch: Win32 Shortcuts
</A></li>
        <LI>Next message: <A HREF="002380.html">[Twisted-Python] twisted.words question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2385">[ date ]</a>
              <a href="thread.html#2385">[ thread ]</a>
              <a href="subject.html#2385">[ subject ]</a>
              <a href="author.html#2385">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&quot;Cory Dodt&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">cdodt at fcoe.k12.ca.us</A>&gt; writes:

&gt;<i> Description
</I>&gt;<i> -----------
</I>&gt;<i> This patch establishes the beginning stages of creating shortcut Icons
</I>&gt;<i> on Win32.  It uses a new feature in distutils 1.03(CVS) which allows
</I>&gt;<i> post-installation code to run by specifying --install-script on the
</I>&gt;<i> command line.
</I>[...]
&gt;<i> Known Bugs
</I>&gt;<i> ----------
</I>&gt;<i> The shortcuts are not removed when Twisted is uninstalled from
</I>&gt;<i> Add/Remove Programs.  The post-install script also gets run
</I>&gt;<i> post-uninstallation so, in theory, twisted-post-install could detect
</I>&gt;<i> whether installation or uninstallation was taking place and decide
</I>&gt;<i> whether to add or remove icons on that basis.  In practice, the only way
</I>&gt;<i> to detect this is to see if the icons are already there, and this method
</I>&gt;<i> will create havoc if you're installing over an existing installation.
</I>
Cory,

I really should write up some docs for the postinstall command on windows.
Here is some info which should probably solve some of your problems:

The postinstall script is run witt sys.argv[1] set to '-install' or
'-remove' depending on what is done, so there is no guesswork needed.

The easiest way to make sure files or directories are removed at
uninstallation is to register them with the installation log file,
then they will automatically be removed.  This can be done by calling
the file_created(path) or directory_created(path) functions. These
functions are available when bdist_wininst runs the postinstall script.

Thomas




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002383.html">[Twisted-Python] Long patch: Win32 Shortcuts
</A></li>
	<LI>Next message: <A HREF="002380.html">[Twisted-Python] twisted.words question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2385">[ date ]</a>
              <a href="thread.html#2385">[ thread ]</a>
              <a href="subject.html#2385">[ subject ]</a>
              <a href="author.html#2385">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
