<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Python and Win32 command execution
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Python%20and%20Win32%20command%20execution&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002499.html">
   <LINK REL="Next"  HREF="002509.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Python and Win32 command execution</H1>
    <B>Bram Moolenaar</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Python%20and%20Win32%20command%20execution&In-Reply-To="
       TITLE="[Twisted-Python] Python and Win32 command execution">Bram at moolenaar.net
       </A><BR>
    <I>Tue Dec 31 11:47:18 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="002499.html">[Twisted-Python] POP3 improvements
</A></li>
        <LI>Next message: <A HREF="002509.html">[Twisted-Python] Python and Win32 command execution
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2508">[ date ]</a>
              <a href="thread.html#2508">[ thread ]</a>
              <a href="subject.html#2508">[ subject ]</a>
              <a href="author.html#2508">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hello,

I noticed your message with an example of using CreateProcess():

	<A HREF="http://twistedmatrix.com/pipermail/twisted-python/2002-March/000882.html">http://twistedmatrix.com/pipermail/twisted-python/2002-March/000882.html</A>

I actually only need a version of the os.system() command that does
return the exit value.  The problem is that under Windows 95 and 98 the
return value if always zero, thus I don't know if the command actually
worked.  For my work on A-A-P (<A HREF="http://www.a-a-p.org">http://www.a-a-p.org</A>) I do need to get
the exit value.

The key to solving the problem apparently is to avoid using command.com.

It seems your example can be changed to redirect the stdout and stderr
of the command, invoke CreateProcess() and obtain the exit value.  But
it's not that simple.

Do you perhaps know a better solution?

- Bram

-- 
hundred-and-one symptoms of being an internet addict:
244. You use more than 20 passwords.

 ///  Bram Moolenaar -- <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Bram at moolenaar.net</A> -- <A HREF="http://www.moolenaar.net">http://www.moolenaar.net</A>  \\\
///          Creator of Vim - Vi IMproved -- <A HREF="http://www.vim.org">http://www.vim.org</A>          \\\
\\\           Project leader for A-A-P -- <A HREF="http://www.a-a-p.org">http://www.a-a-p.org</A>           ///
 \\\ Lord Of The Rings helps Uganda - <A HREF="http://iccf-holland.org/lotr.html">http://iccf-holland.org/lotr.html</A> ///


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002499.html">[Twisted-Python] POP3 improvements
</A></li>
	<LI>Next message: <A HREF="002509.html">[Twisted-Python] Python and Win32 command execution
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2508">[ date ]</a>
              <a href="thread.html#2508">[ thread ]</a>
              <a href="subject.html#2508">[ subject ]</a>
              <a href="author.html#2508">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
