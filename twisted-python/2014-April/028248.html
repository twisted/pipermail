<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Synchronous @inlineCallback interpreter
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Synchronous%20%40inlineCallback%20interpreter&In-Reply-To=%3CCACKEAnW2B3gyg4CAB-1Y4%2BtA%2BqEWVuoLhhYkgSbGQzfv6P-wCQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="060708.html">
   <LINK REL="Next"  HREF="060710.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Synchronous @inlineCallback interpreter</H1>
    <B>Clayton Daley</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Synchronous%20%40inlineCallback%20interpreter&In-Reply-To=%3CCACKEAnW2B3gyg4CAB-1Y4%2BtA%2BqEWVuoLhhYkgSbGQzfv6P-wCQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Synchronous @inlineCallback interpreter">clayton.daley at gmail.com
       </A><BR>
    <I>Thu Apr 24 17:45:03 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="060708.html">[Twisted-Python] txtorcon v0.9.2
</A></li>
        <LI>Next message (by thread): <A HREF="060710.html">[Twisted-Python] Synchronous @inlineCallback interpreter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28248">[ date ]</a>
              <a href="thread.html#28248">[ thread ]</a>
              <a href="subject.html#28248">[ subject ]</a>
              <a href="author.html#28248">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a modular application that communicates over RPC connections (with
both sync and async server/clients available).  I want to migrate some of
the modules over to Twisted. Currently, all modules inherit important
utility functions from a parent class.  On paper, I now need two versions
of this parent class (synchronous &amp; asynchronous) to be inherited by
modules of the respective types.

I'm looking for ways to maximize the common code between the two versions
of the parent object. One that comes to mind (motivating the subject of
this post) would be to write a synchronous interpreter for @inlineCallback
calls.  For example, here's a synchronous factory function from the parent
class (already partly reconfigured to be friendly to my idea):

    @classmethod
    def from_id(cls, id):
        doc = db.get_document(id) # blocking db call
        self = cls._new_document(doc) # synchronous initialization stuff
        self.__init__() # module init code is custom and may block
        return self

I imagine rewriting this to the following:

    @classmethod
    @inlineCallbacks
    def from_id(cls, id):
        doc = yield db.get_document(id) # blocking/async db call
        self = cls._new_document(doc) # always synchronous
        yield self.__init__() # blocking/async call
        returnValue(self)

Assuming the db connector and init function are appropriate to the
environment, my gut reaction is that this could (when combined with a
synchronous implementation of the decorator) run correctly in both places.
I've read that the @inlineCallback code is complicated so I figured I'd run
the idea by the experts before diving down that rabbit hole. Does anyone
see any obvious pitfall? I'm happy to do the legwork to try and build it,
but I'd also welcome any pointers from your (no doubt extensive) experience
writing the twisted version.

Thanks in advance!

Clayton Daley
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20140424/f5ec2261/attachment-0001.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20140424/f5ec2261/attachment-0001.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="060708.html">[Twisted-Python] txtorcon v0.9.2
</A></li>
	<LI>Next message (by thread): <A HREF="060710.html">[Twisted-Python] Synchronous @inlineCallback interpreter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28248">[ date ]</a>
              <a href="thread.html#28248">[ thread ]</a>
              <a href="subject.html#28248">[ subject ]</a>
              <a href="author.html#28248">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
