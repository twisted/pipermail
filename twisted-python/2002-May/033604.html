<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] failure.Failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20failure.Failure&In-Reply-To=%3C1020496815.6031.31.camel%40radii%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] failure.Failure</H1>
    <B>Christopher Armstrong</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20failure.Failure&In-Reply-To=%3C1020496815.6031.31.camel%40radii%3E"
       TITLE="[Twisted-Python] failure.Failure">carmstro at twistedmatrix.com
       </A><BR>
    <I>Sat May  4 01:20:13 MDT 2002</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33604">[ date ]</a>
              <a href="thread.html#33604">[ thread ]</a>
              <a href="subject.html#33604">[ subject ]</a>
              <a href="author.html#33604">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>  So, I'm finally on my way to implementing robust PB errors, and I'm
getting close to completing phase 1, which is fixing up failure.Failure
in preparation for using it for PB errors. Some background:

  It was decided that we need to be able to trap an error based on a
hierarchy; that is, if I try to trap a &quot;WordsError&quot;, it should also trap
&quot;WordsParticipantError&quot; and &quot;WordsGroupError&quot; (for example). 

  The way to do this is to get a list of all parents of an Exception
when a Failure is created with it; I use reflect.allYourBase for this.
However, these parents need to be serializable, so the solution is to
convert them to strings. The strings obviously need to be globally
unique, so I fully qualify them with reflect.qual().

  trap(), which is the method one uses for checking wether or not they
care about a particular failure, now just checks if any of its arguments
are in self.parents.

  The issue now is what the trap() API should be like. It used to be
that fail.trap(types, that, I, want, to, trap) would re-raise the
Failure if any of the types matched. This was kinda weird, as it
requires code like:

try:
   fail.trap(foo, bar)
except:
   print &quot;Ok, so 'fail' matches 'foo' or 'bar'&quot;

Yuck. My proposal is to do this:

if fail.trap(foo,bar): #trap() returns self when foo or bar matches
    print &quot;This is similar to an 'except:' clause&quot;

  So, if this is acceptable, should I worry about the two cases in
Twisted where fail() seems to be called? They don't even seem to make
sense in either case (one of them is obviously using trap() incorrectly,
the other just seems to use it in an odd way). So can I just change the
hardly-used API and fix the current places it's used, or should I remain
backwards-compatible?

  I've attached my diff -u of failure.py, if anyone wants to take a
look. It's very small. It makes test_failure fail, because it tests the
old behavior of trap().


-- 
                                Chris Armstrong
                         &lt;&lt; <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">radix at twistedmatrix.com</A> &gt;&gt;
                <A HREF="http://twistedmatrix.com/users/carmstro.twistd/">http://twistedmatrix.com/users/carmstro.twistd/</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: failure.diff
Type: text/x-patch
Size: 1581 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20020504/f97faccf/attachment-0002.bin&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33604">[ date ]</a>
              <a href="thread.html#33604">[ thread ]</a>
              <a href="subject.html#33604">[ subject ]</a>
              <a href="author.html#33604">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
