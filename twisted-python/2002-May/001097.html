<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] CNAMES and twisted.names in 0.17.3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20CNAMES%20and%20twisted.names%20in%200.17.3&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001116.html">
   <LINK REL="Next"  HREF="001106.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] CNAMES and twisted.names in 0.17.3</H1>
    <B>Doobee R. Tzeck</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20CNAMES%20and%20twisted.names%20in%200.17.3&In-Reply-To="
       TITLE="[Twisted-Python] CNAMES and twisted.names in 0.17.3">drt at un.bewaff.net
       </A><BR>
    <I>Sat May  4 14:22:16 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001116.html">[Twisted-Python] failure.Failure
</A></li>
        <LI>Next message: <A HREF="001106.html">[Twisted-Python] CNAMES and twisted.names in 0.17.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1097">[ date ]</a>
              <a href="thread.html#1097">[ thread ]</a>
              <a href="subject.html#1097">[ subject ]</a>
              <a href="author.html#1097">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I had some problems with the resolver generating tracebacks for
CNAMEs. The decoding has an off by two error which completely
messes up the decoding process.  The attached patch seems to cure
the problem, but I'm not sure why the author of twisted.names did
this fiddeling with the offset. Perhaps I'm breaking something else.

BTW: The Bugtracker eats my (MacOS) lineendings.

drt

<A HREF="http://twistedmatrix.com/users/itamarst.twistd/bugs/view_bug?bug_id=12">http://twistedmatrix.com/users/itamarst.twistd/bugs/view_bug?bug_id=12</A>
<A HREF="http://c0re.jp/c0de/misc/Twisted-0.17.3-dns-CNAME.patch">http://c0re.jp/c0de/misc/Twisted-0.17.3-dns-CNAME.patch</A>

diff -ur Twisted-0.17.3-orig/twisted/names/dns.py
Twisted-0.17.3/twisted/names/dns.py
--- Twisted-0.17.3-orig/twisted/names/dns.py    Tue Apr  9    22:37:00 2002
+++ Twisted-0.17.3/twisted/names/dns.py Sat May  4 20:06:51 2002
@@ -156,7 +156,7 @@
             if answer.type == 1:
                 answers.append(answer)
             elif answer.type == dns.CNAME:
-                answer.strio.seek(answer.strioOff+2)
+                answer.strio.seek(answer.strioOff)
                 n = dns.Name()
                 n.decode(answer.strio)
                 cnames.append(n.name)
@@ -168,7 +168,7 @@
                 if answer.type == 1:
                     answers.append(cnameMap[name])
                 else:
-                    answer.strio.seek(answer.strioOff+2)
+                    answer.strio.seek(answer.strioOff)
                     n = dns.Name()
                     n.decode(answer.strio)
                     name = n.name



-- 
teenage mutant ninja hero coders from da c0re - <A HREF="http://c0re.jp/">http://c0re.jp/</A>
me                                  - <A HREF="http://koeln.ccc.de/~drt/">http://koeln.ccc.de/~drt/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001116.html">[Twisted-Python] failure.Failure
</A></li>
	<LI>Next message: <A HREF="001106.html">[Twisted-Python] CNAMES and twisted.names in 0.17.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1097">[ date ]</a>
              <a href="thread.html#1097">[ thread ]</a>
              <a href="subject.html#1097">[ subject ]</a>
              <a href="author.html#1097">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
