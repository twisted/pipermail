<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Serializing cftp and ssh sessions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Serializing%20cftp%20and%20ssh%20sessions&In-Reply-To=%3C0979672B-CB29-40DA-95B7-37C46C3AD1FB%40Chaos1.DE%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028899.html">
   <LINK REL="Next"  HREF="028904.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Serializing cftp and ssh sessions</H1>
    <B>Axel Rau</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Serializing%20cftp%20and%20ssh%20sessions&In-Reply-To=%3C0979672B-CB29-40DA-95B7-37C46C3AD1FB%40Chaos1.DE%3E"
       TITLE="[Twisted-Python] Serializing cftp and ssh sessions">Axel.Rau at Chaos1.DE
       </A><BR>
    <I>Mon Oct 20 08:05:20 MDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="028899.html">[Twisted-Python] Serializing cftp and ssh sessions
</A></li>
        <LI>Next message: <A HREF="028904.html">[Twisted-Python] Serializing cftp and ssh sessions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28903">[ date ]</a>
              <a href="thread.html#28903">[ thread ]</a>
              <a href="subject.html#28903">[ subject ]</a>
              <a href="author.html#28903">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Am 19.10.2014 um 22:44 schrieb <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>:

&gt;<i> On 17 Oct, 08:50 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">axel.rau at chaos1.de</A> wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Am 14.10.2014 um 17:07 schrieb Axel Rau &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Axel.Rau at chaos1.de</A>&gt;:
</I>&gt;&gt;&gt;&gt;<i> We might need more to go on.  Do you have a complete, minimal example? (See <A HREF="http://sscce.org/">http://sscce.org/</A>)
</I>&gt;&gt;&gt;<i> The attached zip archive
</I>&gt;&gt;<i> Did someone could spend the time to look at it?
</I>&gt;&gt;<i> Is my goal utopian?
</I>&gt;<i> 
</I>&gt;<i> I can't tell if this represents a bug in Twisted or not.  After a quick look through the code, I&#8217;m not really clear on why the program would ever exit (I didn&#8217;t find the calls to `reactor.stop`, I guess they&#8217;re hidden somewhere in conch &#8222;library&#8220; code),
</I>I must prevent this stopping of the reactor, because I&#8217;m unable to start it again.
I&#8217;m always getting twisted.internet.error.ReactorNotRestartable after trying it while reactor.running is False.

&gt;<i>  nor quite which code paths you expect to work and which you expect to fail.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> What is the expected behavior if I run test.py after editing it to point at a host I have access to?
</I>If you put a reactor.stop() at the end of ssh._ebExit, test.py should run to completion after doing the remote file operations and executing the remote commands.
&gt;<i> 
</I>&gt;<i> Is that the desired behavior?
</I>No.
I need a solution where the call to executeRemoteCommands() is delayed until all remote file operations are complete. Similar the next call to distributeFiles (with a different host) must wait until the previous call to executeRemoteCommands has no outstanding operations.

&gt;<i> 
</I>&gt;<i> If there is a second case, what one edit can I make to observe that behavior?
</I>No.
&gt;<i>  How does the behavior differ from what you&#8217;re trying to achieve?
</I>See above. I must synchronize operations at 2 points in a loop.
I tried to do this with callbacks, called at connection shutdown.
What do you think about this?
&gt;<i> 
</I>&gt;<i> Separately:
</I>&gt;<i> 
</I>&gt;<i> * You should rewrite this code to not use twisted.conch.client.connect. That's some random library code no one ever expected application code to use.  It's public, so you can use it if you want, but that's no promise it's any good.
</I>&gt;<i> 
</I>&gt;<i> * Use twisted.conch.endpoints.SSHCommandClientEndpoint to perform `exec` requests
</I>&gt;<i> 
</I>&gt;<i> * Consider pitching in to complete <A HREF="https://twistedmatrix.com/trac/ticket/6617">https://twistedmatrix.com/trac/ticket/6617</A> so you can use the new `SSHSubsystemClientEndpoint` API that ticket introduces to set up your SFTP connections.
</I>I looked at endpoints before, but failed to implement public key authentication and a callback when complete.

Thanks for looking into this,
Axel
&#8212;&#8212;-
PGP-Key:29E99DD6  &#9728; +49 151 2300 9283  &#9728; computing @ chaos claudius


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028899.html">[Twisted-Python] Serializing cftp and ssh sessions
</A></li>
	<LI>Next message: <A HREF="028904.html">[Twisted-Python] Serializing cftp and ssh sessions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28903">[ date ]</a>
              <a href="thread.html#28903">[ thread ]</a>
              <a href="subject.html#28903">[ subject ]</a>
              <a href="author.html#28903">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
