<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted hangs when using pyapns
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20hangs%20when%20using%20pyapns&In-Reply-To=%3CF6EF3231-ED8B-4A2C-94D4-9C2FB49B56A3%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="061349.html">
   <LINK REL="Next"  HREF="061351.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted hangs when using pyapns</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20hangs%20when%20using%20pyapns&In-Reply-To=%3CF6EF3231-ED8B-4A2C-94D4-9C2FB49B56A3%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Twisted hangs when using pyapns">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Oct 15 23:39:40 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="061349.html">[Twisted-Python] Twisted hangs when using pyapns
</A></li>
        <LI>Next message (by thread): <A HREF="061351.html">[Twisted-Python] Twisted hangs when using pyapns
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61350">[ date ]</a>
              <a href="thread.html#61350">[ thread ]</a>
              <a href="subject.html#61350">[ subject ]</a>
              <a href="author.html#61350">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Oct 14, 2014, at 6:27 PM, Ni Wesley &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">nispray at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i>    The code is from our partner, so currently I won't change their code until I address this issue.
</I>&gt;<i> The used pyapns code is here:  <A HREF="https://github.com/samuraisam/pyapns">https://github.com/samuraisam/pyapns</A> &lt;&gt;
</I>&gt;<i> And start twisted service by command : Â twistd -r epoll web --class=pyapns.server.APNSServer --port=7077 &lt;&gt;
</I>&gt;<i> Could you please help have a look?
</I>
OK, you made me curious ;).

I looked through the code, and as it stands, I doubt my original hypothesis (a threading problem) is correct.  Threads are used only in the client talking to the pyapns server, not the pyapns server's client talking to APNS, so they're probably not interfering with it.

As far as I can tell, the ReconnectingClientFactory is set up properly.  Have you looked at the logs?  The one possibility I can think of just from examining the code is that the log messages before calling up to ReconnectingClientFactory.clientConnectionLost are raising an exception, causing the reconnection not to proceed.  That would most likely show a traceback in the logs, though.

&lt;<A HREF="https://github.com/samuraisam/pyapns/blob/master/pyapns/server.py#L157-L164">https://github.com/samuraisam/pyapns/blob/master/pyapns/server.py#L157-L164</A> &lt;<A HREF="https://github.com/samuraisam/pyapns/blob/master/pyapns/server.py#L157-L164">https://github.com/samuraisam/pyapns/blob/master/pyapns/server.py#L157-L164</A>&gt;&gt;

Any clue?

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20141015/7c07ca90/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="061349.html">[Twisted-Python] Twisted hangs when using pyapns
</A></li>
	<LI>Next message (by thread): <A HREF="061351.html">[Twisted-Python] Twisted hangs when using pyapns
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61350">[ date ]</a>
              <a href="thread.html#61350">[ thread ]</a>
              <a href="subject.html#61350">[ subject ]</a>
              <a href="author.html#61350">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
