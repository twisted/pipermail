<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python]  Running CPU bound function concurrently in twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%0A%20%3D%3Futf-8%3Fq%3FRunning_CPU_bound_function_concurrent%3F%3D%0A%20%3D%3Futf-8%3Fq%3Fly_in_twisted%3F%3D&In-Reply-To=%3C6c1f2b9f-2ca5-4fe9-9125-611146cba60c%40www.fastmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="032379.html">
   <LINK REL="Next"  HREF="032380.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python]  Running CPU bound function concurrently in twisted</H1>
    <B>Moshe Zadka</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%0A%20%3D%3Futf-8%3Fq%3FRunning_CPU_bound_function_concurrent%3F%3D%0A%20%3D%3Futf-8%3Fq%3Fly_in_twisted%3F%3D&In-Reply-To=%3C6c1f2b9f-2ca5-4fe9-9125-611146cba60c%40www.fastmail.com%3E"
       TITLE="[Twisted-Python]  Running CPU bound function concurrently in twisted">moshez at zadka.club
       </A><BR>
    <I>Mon Jun 24 23:16:17 MDT 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="032379.html">[Twisted-Python] Running CPU bound function concurrently in twisted
</A></li>
        <LI>Next message (by thread): <A HREF="032380.html">[Twisted-Python] Running CPU bound function concurrently in twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32381">[ date ]</a>
              <a href="thread.html#32381">[ thread ]</a>
              <a href="subject.html#32381">[ subject ]</a>
              <a href="author.html#32381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Jun 24, 2019, at 17:24, Chengi Liu wrote:
&gt;<i> How do I use more multiple CPU cores? I guess atleast the fact that twisted app wont be blocking is good, but what would be a good way to use multiple cores.
</I>
It *really* depends on what is the function that is CPU heavy, and why it is CPU heavy.
You have a lot of options here, and they're all subtly different.

But I'll start with noting that this is *no longer* a Twisted question: using multiple cores from Python is genuinely a problem for which there is no single good solution, just a number of different ones with trade-offs. As I mentioned, you can use `dask`. I think that might be the simplest solution for you -- dask has a lot of good tutorials, and if your only goal is using multiple CPUs, it has an &quot;auto-setup&quot;. Another option is to see if you can use a library that natively releases the Global Interpreter Lock. If, for example, your function is numeric computation heavy, than numpy does release the GIL. You can also use ampoule, though the set-up becomes non-trivial -- you will need to either change your process initialization or maintain a process pool from the main process. Either option can become non-trivial fast. Finally, the option of writing the CPU heavy code in Cython, and then releasing the GIL explicitly around the area it is not needed, exists.

To sum up:

* Dask
* Something that releases the GIL, like numpy
* Setting up an ampoule process pool
* Move CPU heavy logic to Cython, and release GIL explicitly

As I said, none of these options are really Twisted-related (the only one vaguely connected is the ampoule one, but even then, the fact that you'll use Twisted to manage the pool is incidental). There are even more exotic options, of course, but I think this e-mail might already be confusing enough.

Moshe Z.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20190624/67bc2496/attachment.html&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="032379.html">[Twisted-Python] Running CPU bound function concurrently in twisted
</A></li>
	<LI>Next message (by thread): <A HREF="032380.html">[Twisted-Python] Running CPU bound function concurrently in twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32381">[ date ]</a>
              <a href="thread.html#32381">[ thread ]</a>
              <a href="subject.html#32381">[ subject ]</a>
              <a href="author.html#32381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
