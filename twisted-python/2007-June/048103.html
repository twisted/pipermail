<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] protocol-factory question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20protocol-factory%20question&In-Reply-To=%3C20070622114422.ezr3narsgowoc84c%40wasabox.wasabout.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="048102.html">
   <LINK REL="Next"  HREF="048105.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] protocol-factory question</H1>
    <B>Thomas Herv√©</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20protocol-factory%20question&In-Reply-To=%3C20070622114422.ezr3narsgowoc84c%40wasabox.wasabout.net%3E"
       TITLE="[Twisted-Python] protocol-factory question">therve at free.fr
       </A><BR>
    <I>Fri Jun 22 03:44:22 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="048102.html">[Twisted-Python] protocol-factory question
</A></li>
        <LI>Next message (by thread): <A HREF="048105.html">[Twisted-Python] Utility program to hex-dump network traffic
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48103">[ date ]</a>
              <a href="thread.html#48103">[ thread ]</a>
              <a href="subject.html#48103">[ subject ]</a>
              <a href="author.html#48103">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> So I wrote my Protocol class, and my Factory class. If I understood the
</I>&gt;<i> behavior of
</I>&gt;<i> this system, every time a client connects to my server, factory build a
</I>&gt;<i> protocol instance and
</I>&gt;<i> &quot;attach&quot; it to the client. So the client comunicates with that protocol
</I>&gt;<i> instance, right?
</I>&gt;<i> Now, when from protocol I call self.transport.loseConnection(in way to
</I>&gt;<i> disconnnect itself),
</I>&gt;<i> the client will be disconnected,but its protocol instance still lives
</I>&gt;<i> on. What can I do
</I>&gt;<i> to destroy protocol instance after its client disconnection? Because if
</I>&gt;<i> I have a thousand of
</I>&gt;<i> connection attempts, I'll have a thousand of protocol instances, with a
</I>&gt;<i> lot of allocated resources
</I>
Protocol instance will remain alive in your program if you keep a  
reference to it. By default it's not done within Twisted, so when the  
connection is closed, the protocol instance must be destroyed at the  
next garbage collect turn, without doing anything in your application.

If you keep a reference to it (to have a list of connected clients for  
example), just remove your instance from this list in connectionLost.

-- 
Thomas



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="048102.html">[Twisted-Python] protocol-factory question
</A></li>
	<LI>Next message (by thread): <A HREF="048105.html">[Twisted-Python] Utility program to hex-dump network traffic
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48103">[ date ]</a>
              <a href="thread.html#48103">[ thread ]</a>
              <a href="subject.html#48103">[ subject ]</a>
              <a href="author.html#48103">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
