<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Beginner question: integrating with CORBA
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Beginner%20question%3A%20integrating%20with%20CORBA&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015602.html">
   <LINK REL="Next"  HREF="015606.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Beginner question: integrating with CORBA</H1>
    <B>Chris Laws</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Beginner%20question%3A%20integrating%20with%20CORBA&In-Reply-To="
       TITLE="[Twisted-Python] Beginner question: integrating with CORBA">clawsicus at gmail.com
       </A><BR>
    <I>Mon Jun 25 09:04:31 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="015602.html">[Twisted-Python] Beginner question: integrating with CORBA 
</A></li>
        <LI>Next message: <A HREF="015606.html">[Twisted-Python] Testing with trial, adbapi questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15605">[ date ]</a>
              <a href="thread.html#15605">[ thread ]</a>
              <a href="subject.html#15605">[ subject ]</a>
              <a href="author.html#15605">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i> ---------- Forwarded message ----------
</I>&gt;<i> From: &quot;Dave Kirby&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">D.Kirby at tideway.com</A>&gt;
</I>&gt;<i> To: &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&gt;
</I>&gt;<i> Date: Mon, 25 Jun 2007 12:03:46 +0100
</I>&gt;<i> Subject: [Twisted-Python] Beginner question: integrating with CORBA
</I>&gt;<i>
</I>&gt;<i> I have just started looking at Twisted, and it looks really cool and
</I>&gt;<i> useful.  I have read through much of the docs and the O'Reilly book, but I
</I>&gt;<i> still have a head full of questions.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> First some background.  I am considering using Twisted to replace a
</I>&gt;<i> component in a network management suite.  All the components communicate
</I>&gt;<i> through CORBA (omniORB).  The component I want to replace gets CORBA calls
</I>&gt;<i> that requests data from servers on the network, and the component retrieves
</I>&gt;<i> the data using ssh.  Currently it spawns /usr/bin/ssh and uses pexpect to
</I>&gt;<i> control the interaction.  Typically we will have 20-40 simultaneous calls in
</I>&gt;<i> progress to different IP addresses, each on a separate thread and each
</I>&gt;<i> spawning a separate ssh client.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I want to replace this with a component that uses Twisted instead.  From
</I>&gt;<i> what I have read Twisted should be ideal for this &#8211; I can use the conch
</I>&gt;<i> library to do the ssh calls and eliminate the need for spawning dozens of
</I>&gt;<i> separate processes (something that has been a major cause of bugs).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The first problem I have is how to integrate the omniORB event loop with
</I>&gt;<i> the reactor event loop.  My initial thoughts are to have the omniORB event
</I>&gt;<i> loop in one thread and run the reactor loop in another thread.  When a CORBA
</I>&gt;<i> call comes in it will use callFromThread()  to post a request to the Twisted
</I>&gt;<i> thread that will create the connection and handle the ssh session.  Is this
</I>&gt;<i> feasible?  Any gotchas to watch out for?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> However I have also seen reference to using threadedselectreactor for
</I>&gt;<i> mixing Twisted and foreign even loops (
</I>&gt;<i> <A HREF="http://bob.pythonmac.org/archives/2005/04/17/twisted-and-foreign-event-loops/">http://bob.pythonmac.org/archives/2005/04/17/twisted-and-foreign-event-loops/</A>),
</I>&gt;<i> but I have no idea how to use this with omniORB.  Is this worth
</I>&gt;<i> investigating further, or should I stick with my original idea?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Replacing CORBA with the Twisted PerspectiveBroker is not an option, since
</I>&gt;<i> it would require extensively rewriting a dozen or so components.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I have plenty of other questions, but will save them for another time.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Dave Kirby
</I>&gt;<i>
</I>&gt;<i>
</I>I just got back into a similar thing today after about a month of inactivity
on the issue. I posted about it here a while back but got no responses.
I'm trying to convert a simple Python/Omniorb CORBA Event Channel client
script so that it can robustly handle a separate federated Name Service
disappearing. I'm planning on running it using twisted for various reasons
(common code, available functionality, etc). So I need to work out if I can
use Twisted and CORBA (Omniorb to be specific) together, ideally within the
same thread.

Currently the simple script has a Tkinter UI which also registers a callback
method with the Event Channel client wrapper to handle Event Messages. A
self-rescheduling callback is also configured to drive the Orb, at some
variable rate, and then the script is handled by the Tkiner mainloop. At
regular intervals the Orb is run then rescheduled and then control is
returned back to the Tk mainloop. I'm at home and can't remember the exact
code but something along the lines of:

def runOrb(self):
    if self.orb.work_pending():
        self.orb.perform_work()

This all seems to work well. However the script is fairly simple in that
it's only monitoring and reacting to Event Channel messages, so slightly
different from your use. However, I think that it demonstrates that the orb
can be run from within another event processing loop within the same single
thread - in this case the Tk mainloop.
Now the Tk event processing can be handled by the tksupport package so I
thought why not use that model for a CORBA support package?
I've totally copied the tksupport file (it's very small) and converted it to
perform the running and re-scheduling of the CORBA orb.

Sorry I can't provide you more info but as mentioned above I only got back
into this today (no testing yet) plus I finish work at that company in a few
days. If I get anywhere I'll post back some info. Hopefully it gives you
something to look into.

Regards,
Chris Laws
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20070625/1fca5411/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20070625/1fca5411/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015602.html">[Twisted-Python] Beginner question: integrating with CORBA 
</A></li>
	<LI>Next message: <A HREF="015606.html">[Twisted-Python] Testing with trial, adbapi questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15605">[ date ]</a>
              <a href="thread.html#15605">[ thread ]</a>
              <a href="subject.html#15605">[ subject ]</a>
              <a href="author.html#15605">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
