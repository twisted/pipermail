<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] profiling twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20profiling%20twisted&In-Reply-To=46825C37.7060100%40bluegap.ch">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015637.html">
   <LINK REL="Next"  HREF="015635.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] profiling twisted</H1>
    <B>Maarten ter Huurne</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20profiling%20twisted&In-Reply-To=46825C37.7060100%40bluegap.ch"
       TITLE="[Twisted-Python] profiling twisted">maarten at treewalker.org
       </A><BR>
    <I>Wed Jun 27 13:04:18 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="015637.html">[Twisted-Python] profiling twisted
</A></li>
        <LI>Next message: <A HREF="015635.html">[Twisted-Python] How work ldaptor and twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15638">[ date ]</a>
              <a href="thread.html#15638">[ thread ]</a>
              <a href="subject.html#15638">[ subject ]</a>
              <a href="author.html#15638">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wednesday 27 June 2007, Markus Schiltknecht wrote:

&gt;<i> Now, I'm wondering if there's a profiling tool, which can quickly tell
</I>&gt;<i> me what events are blocking my server. I have even deferred the file I/O
</I>&gt;<i> to separate threads, as I've suspected them to make the server behave
</I>&gt;<i> poorly when under load. But there still seems to be something
</I>&gt;<i> blocking...  What do you use to find the callbacks which block (for too
</I>&gt;<i> long)?
</I>
Does your server process use a lot of memory?

I had problems with a random simple request taking a long time every now and 
then and it turned out to be the Python garbage collector. The collection 
itself can take some time if you have a lot of objects. If some of the Python 
process ends up in the swap instead of main memory, garbage collection will 
block until it is swapped back in, which can slow it down dramatically.

Using multiple threads does not give you any performance advantage in this 
case: during garbage collection the entire Python VM is frozen.

One thing you could try is:
  import gc
  gc.disable()
in the startup code of your server.

Note that this does not turn off all memory recycling; it only turns off the 
mark-and-sweep part of the garbage collector. Objects which have a zero 
reference count are still collected.

Bye,
		Maarten


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015637.html">[Twisted-Python] profiling twisted
</A></li>
	<LI>Next message: <A HREF="015635.html">[Twisted-Python] How work ldaptor and twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15638">[ date ]</a>
              <a href="thread.html#15638">[ thread ]</a>
              <a href="subject.html#15638">[ subject ]</a>
              <a href="author.html#15638">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
