<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Patch for tcp.py
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Patch%20for%20tcp.py&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001471.html">
   <LINK REL="Next"  HREF="001473.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Patch for tcp.py</H1>
    <B>Martin Sj&#246;gren</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Patch%20for%20tcp.py&In-Reply-To="
       TITLE="[Twisted-Python] Patch for tcp.py">martin at strakt.com
       </A><BR>
    <I>Tue Aug 13 04:35:59 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001471.html">[Twisted-Python] Resource perplexity
</A></li>
        <LI>Next message: <A HREF="001473.html">[Twisted-Python] Concurrent data access with select() safe?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1472">[ date ]</a>
              <a href="thread.html#1472">[ thread ]</a>
              <a href="subject.html#1472">[ subject ]</a>
              <a href="author.html#1472">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Non-blocking connects seems to be handled wrong. In particular, EALREADY
is handled like EISCONN, when it should be handled like e.g.
EINPROGRESS. This is consistent for both unix and windows.

Here's a patch:


diff -u -r1.86 tcp.py
--- tcp.py      6 Aug 2002 17:12:40 -0000       1.86
+++ tcp.py      13 Aug 2002 08:17:31 -0000
@@ -230,9 +230,9 @@
         try:
             self.socket.connect(self.realAddress)
         except socket.error, se:
-            if se.args[0] in (EISCONN, EALREADY):
+            if se.args[0] == EISCONN:
                 pass
-            elif se.args[0] in (EWOULDBLOCK, EINVAL, EINPROGRESS):
+            elif se.args[0] in (EWOULDBLOCK, EINVAL, EINPROGRESS,
EALREADY):
                 self.startReading()
                 self.startWriting()
                 return



Regards,
Martin

-- 
Martin Sj&#246;gren
  <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">martin at strakt.com</A>              ICQ : 41245059
  Phone: +46 (0)31 7710870       Cell: +46 (0)739 169191
  GPG key: <A HREF="http://www.strakt.com/~martin/gpg.html">http://www.strakt.com/~martin/gpg.html</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001471.html">[Twisted-Python] Resource perplexity
</A></li>
	<LI>Next message: <A HREF="001473.html">[Twisted-Python] Concurrent data access with select() safe?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1472">[ date ]</a>
              <a href="thread.html#1472">[ thread ]</a>
              <a href="subject.html#1472">[ subject ]</a>
              <a href="author.html#1472">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
