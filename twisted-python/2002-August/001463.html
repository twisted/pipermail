<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted.web/DOMTemplate
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted.web/DOMTemplate&In-Reply-To=%3C200208102254.32727.sjthorne%40ozemail.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="033974.html">
   <LINK REL="Next"  HREF="033973.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted.web/DOMTemplate</H1>
    <B>Stephen Thorne</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted.web/DOMTemplate&In-Reply-To=%3C200208102254.32727.sjthorne%40ozemail.com.au%3E"
       TITLE="[Twisted-Python] Twisted.web/DOMTemplate">sjthorne at ozemail.com.au
       </A><BR>
    <I>Sat Aug 10 06:54:26 MDT 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="033974.html">[Twisted-Python] PB over unix socket ... how?
</A></li>
        <LI>Next message (by thread): <A HREF="033973.html">[Twisted-Python] Twisted.web/DOMTemplate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1463">[ date ]</a>
              <a href="thread.html#1463">[ thread ]</a>
              <a href="subject.html#1463">[ subject ]</a>
              <a href="author.html#1463">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Okay, I've been doing some hacking trying to make a small application using 
twisted.web and the .rpy stuff, using DOMTemplate.

Ordinarily I'd chat about something like this on the irc channel, but it was 
dead quiet. Apart from me talking to myself of course.

in the template:
&lt;P view='getBody'&gt;

in the response object
    def factory_getBody(self, request, node):
        print 1
        return node

This (when twistd --nodaemon is used) prints 1 twice (instead of the once 
expected).

This is because of the following section of code:
    def getNodeView(self, request, node):
&lt;snip&gt;
                    maybeWidget = viewMethod(request, node)
                    if isinstance(maybeWidget, domwidgets.Widget):
                        view = maybeWidget
                        viewMethod = view.generateDOM

This is *bad*. viewMethod in this instance is response.factory_getBody, and in 
order to figure out if factory_getBody returns a widget as opposed to an 
instance of xml.dom.minidom.Element it actually calls the function to have a 
look. If it doesn't return a widget it *throws the result away*. viewMethod 
is then returned and used elsewhere, where its actually intended to be used.

Considering that rendering a template node could have program logic in it that 
only should be evaluated once per pageview. It could also carry some 
expensive database transactions.

Anyhow. I can't figure out how to refactor without breaking Widget 
functionality, and the way 'controller' works.

Anyhow. I think I'd call the above a bug report. Maybe with elements of rant 
thrown in.

Stephen Thorne.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.7 (GNU/Linux)

iD8DBQE9VQ0HRqaMcfqEy/YRAoOPAJ0WJiLcPvftgjna6tgiD1ifAbQkGACdEDWN
7psWJh0/77eiCaEai/xVnaU=
=BNcB
-----END PGP SIGNATURE-----



</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="033974.html">[Twisted-Python] PB over unix socket ... how?
</A></li>
	<LI>Next message (by thread): <A HREF="033973.html">[Twisted-Python] Twisted.web/DOMTemplate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1463">[ date ]</a>
              <a href="thread.html#1463">[ thread ]</a>
              <a href="subject.html#1463">[ subject ]</a>
              <a href="author.html#1463">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
