<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Insults, Can't write from connectionMade?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Insults%2C%20Can%27t%20write%20from%20connectionMade%3F&In-Reply-To=200607081155.56186.mike%40mkp.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013616.html">
   <LINK REL="Next"  HREF="013618.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Insults, Can't write from connectionMade?</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Insults%2C%20Can%27t%20write%20from%20connectionMade%3F&In-Reply-To=200607081155.56186.mike%40mkp.ca"
       TITLE="[Twisted-Python] Insults, Can't write from connectionMade?">exarkun at divmod.com
       </A><BR>
    <I>Sat Jul  8 12:31:55 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="013616.html">[Twisted-Python] Insults, Can't write from connectionMade?
</A></li>
        <LI>Next message: <A HREF="013618.html">[Twisted-Python] UDP question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13617">[ date ]</a>
              <a href="thread.html#13617">[ thread ]</a>
              <a href="subject.html#13617">[ subject ]</a>
              <a href="author.html#13617">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 8 Jul 2006 11:55:55 -0400, Mike Pelletier &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mike at mkp.ca</A>&gt; wrote:
&gt;<i>Hello, twisted Twisted coders.  I am trying to get familiarised with
</I>&gt;<i>twisted.conch.insults.  I've run into some behaviour I cannot explain.
</I>&gt;<i>Attached is a .tac including the following excerpt:
</I>&gt;<i>
</I>&gt;<i>class MyTerminalProtocol(insults.TerminalProtocol):
</I>&gt;<i>    width = 80
</I>&gt;<i>    height = 24
</I>&gt;<i>
</I>&gt;<i>    def connectionMade(self):
</I>&gt;<i>        self.terminalSize(self.width, self.height)
</I>&gt;<i>        self.terminal.write(&quot; world\n&quot;)
</I>&gt;<i>
</I>&gt;<i>    def terminalSize(self, width, height):
</I>&gt;<i>        self.width, self.height = width, height
</I>&gt;<i>        self.terminal.eraseDisplay()
</I>&gt;<i>        self.terminal.write(&quot;Hello,&quot;)
</I>&gt;<i>
</I>&gt;<i>When a connection is made, the screen is cleared and &quot;Hello,&quot; is written,
</I>&gt;<i>but &quot; world\n&quot; is not (or at least it never appears on the terminal).  Why
</I>&gt;<i>is &quot;world\n&quot; not written?
</I>
It actually is written:

&gt;&gt;&gt;<i> import socket
</I>&gt;&gt;&gt;<i> s = socket.socket()
</I>&gt;&gt;&gt;<i> s.connect(('localhost', 1977))
</I>&gt;&gt;&gt;<i> s.recv(1024)
</I>'\xff\xfd&quot;\xff\xfd\x1f\xff\xfd\x03\xff\xfb\x01\x1b[2JHello, world\r\r\r\n'

I'm not sure why &quot;Hello,&quot; shows up in an xterm but &quot; world&quot; doesn't: it
may be a terminal emulation bug or some legitimate interaction between
all the control sequences included there.  But clearly there is a problem
here somewhere - your \n is being translated into \r\r\r\n.

Could you file a ticket in the tracker and attach this tac file?

&gt;<i>
</I>&gt;<i>Oddly (or perhaps revealingly for someone with more clues than me), when in a
</I>&gt;<i>previous version I did not use TelnetTransport and TelnetBootstrapProtocol, I
</I>&gt;<i>was able to write just fine from connectionMade.
</I>&gt;<i>
</I>&gt;<i>TIA for a liberal and violent application of the clue stick.
</I>&gt;<i>
</I>
Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013616.html">[Twisted-Python] Insults, Can't write from connectionMade?
</A></li>
	<LI>Next message: <A HREF="013618.html">[Twisted-Python] UDP question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13617">[ date ]</a>
              <a href="thread.html#13617">[ thread ]</a>
              <a href="subject.html#13617">[ subject ]</a>
              <a href="author.html#13617">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
