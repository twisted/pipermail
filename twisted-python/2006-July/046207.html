<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: Improving spawnProcess and friends
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20Improving%20spawnProcess%20and%20friends&In-Reply-To=%3C878xmknklm.fsf%40aka.i.naked.iki.fi%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="046206.html">
   <LINK REL="Next"  HREF="046208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: Improving spawnProcess and friends</H1>
    <B>Nuutti Kotivuori</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20Improving%20spawnProcess%20and%20friends&In-Reply-To=%3C878xmknklm.fsf%40aka.i.naked.iki.fi%3E"
       TITLE="[Twisted-Python] Re: Improving spawnProcess and friends">naked at iki.fi
       </A><BR>
    <I>Sun Jul 23 14:15:49 MDT 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="046206.html">[Twisted-Python] Re: Improving spawnProcess and friends
</A></li>
        <LI>Next message (by thread): <A HREF="046208.html">[Twisted-Python] Re: Improving spawnProcess and friends
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46207">[ date ]</a>
              <a href="thread.html#46207">[ thread ]</a>
              <a href="subject.html#46207">[ subject ]</a>
              <a href="author.html#46207">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Itamar Shtull-Trauring wrote:
&gt;<i> On Sat, 2006-07-22 at 18:44 +0300, Nuutti Kotivuori wrote:
</I>&gt;<i>
</I>&gt;<i> ... adding factory object to process spawning ...
</I>&gt;<i>
</I>&gt;&gt;<i> How does this sound? If nobody yells murder, I'll be starting to build
</I>&gt;&gt;<i> a rudimentary implementation of this to see how the API would
</I>&gt;&gt;<i> naturally turn out to be and then submit it here for review.
</I>&gt;<i>
</I>&gt;<i> Seems... over-engineered. I'm not sure adding a whole new object is the
</I>&gt;<i> way to go on this.
</I>
A valid concern, it did cross my mind as well. However, I have yet to
think of a better way to achieve all the features that are wished
for. Any suggestions?

Anyway, I have implemented some of the changes already. The patch is
again attached to the issue. Everything is still subject to change,
however. But, this is how setting up a process would look like at the
moment:

  class MyProcessProtocolFactory(process.ProcessProtocolFactory):
      def processSetup(self, proc):
           proc.addHelper(SetuidHelper(1000, 1000))
           proc.addHelper(ChdirHelper('/tmp'))
           proc.addHelper(PTY('pty', [0, 1]))
           proc.addHelper(PassthroughFD(sys.stderr.fileno(), [2]))
           proc.addHelper(WritePipe('passphrase', [3]))

This would configure the process to have uid 1000 and gid 1000, the
executable to be started in path /tmp, file descriptors 0 and 1 would
map to a PTY on the child, which would come in as
childDataReceived('pty', data) on the process protocol, file
descriptor 2 would be the parent's stderr and file descriptor 3 would
be a write pipe by the name of passphrase, that would be written as
transport.writeToChild('passphrase', 'foobar').

This is still lacking the ability to give different protocols to
different communication channels and the chdir/chroot/whatever helper
logic is hackish.

So, feedback is very much appreciated, as always. Regardless, I'll
holler on the list again when I think of where to go next with this
thing.

-- Naked




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="046206.html">[Twisted-Python] Re: Improving spawnProcess and friends
</A></li>
	<LI>Next message (by thread): <A HREF="046208.html">[Twisted-Python] Re: Improving spawnProcess and friends
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46207">[ date ]</a>
              <a href="thread.html#46207">[ thread ]</a>
              <a href="subject.html#46207">[ subject ]</a>
              <a href="author.html#46207">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
