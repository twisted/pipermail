<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: CLOSE_WAIT (debian)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20CLOSE_WAIT%20%28debian%29&In-Reply-To=%3C20080605100408.25821.1710250854.divmod.xquotient.9227%40joule.divmod.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="050362.html">
   <LINK REL="Next"  HREF="050364.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: CLOSE_WAIT (debian)</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20CLOSE_WAIT%20%28debian%29&In-Reply-To=%3C20080605100408.25821.1710250854.divmod.xquotient.9227%40joule.divmod.com%3E"
       TITLE="[Twisted-Python] Re: CLOSE_WAIT (debian)">glyph at divmod.com
       </A><BR>
    <I>Thu Jun  5 04:04:08 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="050362.html">[Twisted-Python] Re: CLOSE_WAIT (debian)
</A></li>
        <LI>Next message (by thread): <A HREF="050364.html">[Twisted-Python] Re: CLOSE_WAIT (debian)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50363">[ date ]</a>
              <a href="thread.html#50363">[ thread ]</a>
              <a href="subject.html#50363">[ subject ]</a>
              <a href="author.html#50363">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08:25 am, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">josef.robert.novak at gmail.com</A> wrote:
&gt;<i>Hi, I've been digging around a bit more and it seems like it might be
</I>&gt;<i>advisable for me to use the d.setTimeout(TIMEOUT) function for my
</I>&gt;<i>deferToThread objects.  I see from the docstrings that this is
</I>&gt;<i>deprecated, and that I should rely on the timeout mechanism supplied
</I>&gt;<i>by the API I'm using, however that doesn't seem to suggest an
</I>&gt;<i>immediate solution.  I dug up the following reference, but is it
</I>&gt;<i>really such a bad idea to use d.setTimout(TIMEOUT)?
</I>&gt;<i><A HREF="http://twistedmatrix.com/pipermail/twisted-">http://twistedmatrix.com/pipermail/twisted-</A> 
</I>&gt;<i>python/2004-April/007536.html
</I>
Yes.  Double-yes for Deferreds returned from deferToThread.

So, first: if you have deferred a function to a thread, there is nothing 
generic you can do to stop it.  If that blocking function specifically 
provides an API to stop it from other threads, then you can stop it.

Second, setTimeout was *never* a good idea.  It's been deprecated for 
long enough that it may be removed at any time; and probably will be, 
soon.  As it is implemented, you will pretty much always see a traceback 
if the timeout actually fires.  Unless the API is specifically written 
to accommodate this style of timeouts (and none in Twisted are) the API 
which is expecting to callback or errback a Deferred will instead 
encounter an `AlreadyCalledError`, since the timeout has invoked it 
already.

Your issue with CLOSE_WAIT sockets could be due to registering producers 
which have no further data to produce.  Does that sound like something 
you, or starpy, might be doing?


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="050362.html">[Twisted-Python] Re: CLOSE_WAIT (debian)
</A></li>
	<LI>Next message (by thread): <A HREF="050364.html">[Twisted-Python] Re: CLOSE_WAIT (debian)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50363">[ date ]</a>
              <a href="thread.html#50363">[ thread ]</a>
              <a href="subject.html#50363">[ subject ]</a>
              <a href="author.html#50363">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
