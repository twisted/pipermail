<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted, twistd and logging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2C%20twistd%20and%20logging&In-Reply-To=%3C20080620121346.59659d06%40ws35.commsecure.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="050444.html">
   <LINK REL="Next"  HREF="050449.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted, twistd and logging</H1>
    <B>Tim Allen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2C%20twistd%20and%20logging&In-Reply-To=%3C20080620121346.59659d06%40ws35.commsecure.com.au%3E"
       TITLE="[Twisted-Python] Twisted, twistd and logging">tim at commsecure.com.au
       </A><BR>
    <I>Thu Jun 19 20:13:46 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="050444.html">[Twisted-Python] Twisted, twistd and logging
</A></li>
        <LI>Next message (by thread): <A HREF="050449.html">[Twisted-Python] Twisted, twistd and logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50448">[ date ]</a>
              <a href="thread.html#50448">[ thread ]</a>
              <a href="subject.html#50448">[ subject ]</a>
              <a href="author.html#50448">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Phil Christensen &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">phil at bubblehouse.org</A>&gt; wrote:
&gt;<i> On Jun 19, 2008, at 2:21 AM, Tim Allen wrote:
</I>&gt;<i> &gt; My second thought was to use twisted.python.log, but that brings its
</I>&gt;<i> &gt; own set of problems:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1. twisted.python.syslog isn't very... complete. For starters, it
</I>&gt;<i> &gt;    doesn't let you specify the syslog facility, and even if it did,
</I>&gt;<i> &gt;    twistd would need to be extended to support it.
</I>&gt;<i> 
</I>&gt;<i> It's true that the syslog support is very experimental at this point,  
</I>&gt;<i> but what would need to be changed about twistd to support the  
</I>&gt;<i> necessary development?
</I>
As I understood it, twistd's philosophy was that logging-configuration
was a deployment issue and hence ought to be configured by tweaking
twistd command-line parameters rather than pre-configuring the
application to be deployed. twistd already has very simple logging
configuration options in the form of &quot;--logfile&quot; and &quot;--syslog&quot;; I
intended to add a &quot;--syslog-facility=&quot; command-line option [0].

Having skim-read ticket 638 that JP pointed to in another reply,
now I'm not so sure. It's kind of difficult to for me to understand the
current state of play, especially since that ticket predates the merge
of seemingly-related ticket 3052, but it *seems* to be a battle between
the camps of &quot;twistd's logging is limited, it should be infinitely
extensible&quot; and &quot;twistd's logging is limited, applications
should be allowed to override it&quot;. Personally, I think I lean
more toward &quot;it should be infinitely extensible&quot; side - but right now I
don't really care about the general case of extensibility, I just want
more flexible syslog support.

At any rate, ticket 638 and other related tickets seem to be high-level
conceptual arguments, and I don't feel I have the domain-knowledge
required to comment intelligibly on them.

&gt;<i> I think the most likely scenario is that the standard logging code  
</I>&gt;<i> assumes logging will return immediately, but I feel like this could be  
</I>&gt;<i> worked around by having some kind of log queue that gets sent to  
</I>&gt;<i> syslog by some background thread (or better yet, a callLater pattern).
</I>
I'm not sure what you're getting at here. Python's syslog module calls
syslog(3), which talks to syslogd(8). I don't know whether either or
any of those block waiting for the log message to be delivered; I would
hazard a guess that they don't.

&gt;<i> &gt; I think the best way of solving my problems would be to:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; a) update t.p.syslog so that it supports a 'facility' parameter.
</I>&gt;<i> &gt; b) update t.p.syslog so that log-messages with 'isError' true are
</I>&gt;<i> &gt;    logged with the LOG_ALERT priority rather than the default.
</I>&gt;<i> &gt; c) update the Unix version of twistd to support a 'syslogFacility'
</I>&gt;<i> &gt;    command-line parameter.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Would such a patch be accepted? If necessary, I could replace (b) with
</I>&gt;<i> &gt; a syslog-based LogObserver in my own code, but I'm keen to have (a)  
</I>&gt;<i> &gt; and
</I>&gt;<i> &gt; (c) in the Twisted code-base.
</I>&gt;<i> 
</I>&gt;<i> I can't speak to whether such a patch would be accepted, but I know I  
</I>&gt;<i> have a couple of projects I've wanted to use syslogging for, and it  
</I>&gt;<i> would be great to have a stable solution in Twisted. However, the core  
</I>&gt;<i> dev team is fairly well inundated, so while you're working on a patch/ 
</I>&gt;<i> review, you might consider investigating another option in parallel.
</I>&gt;<i> 
</I>&gt;<i> If you package your code separately and join the Twisted Community  
</I>&gt;<i> Code project on Launchpad, you can get your code out there and in  
</I>&gt;<i> front of eyeballs while you work on getting a patch accepted into  
</I>&gt;<i> Twisted. If you can draw a reasonable amount of user attention, this  
</I>&gt;<i> may help with both testing and review, and make it easier to get your  
</I>&gt;<i> patch into Twisted proper.
</I>
Thanks for the advice - I'm not sure that patches to twistd could be
packaged separately, but I'll keep the possibility in mind in case I
think of anything.

Tim Allen

[0] I'm not familiar with t.p.usage; if it were possible to support
syntax like &quot;--syslog=LOG_LOCAL0&quot; while still supporting the &quot;--syslog&quot;
syntax in existing releases, that'd be ideal.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20080620/8b293bdb/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="050444.html">[Twisted-Python] Twisted, twistd and logging
</A></li>
	<LI>Next message (by thread): <A HREF="050449.html">[Twisted-Python] Twisted, twistd and logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50448">[ date ]</a>
              <a href="thread.html#50448">[ thread ]</a>
              <a href="subject.html#50448">[ subject ]</a>
              <a href="author.html#50448">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
