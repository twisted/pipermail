<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted, twistd and logging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2C%20twistd%20and%20logging&In-Reply-To=%3C20080620183205.258aa0ae%40ws35.commsecure.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="050449.html">
   <LINK REL="Next"  HREF="050451.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted, twistd and logging</H1>
    <B>Tim Allen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2C%20twistd%20and%20logging&In-Reply-To=%3C20080620183205.258aa0ae%40ws35.commsecure.com.au%3E"
       TITLE="[Twisted-Python] Twisted, twistd and logging">tim at commsecure.com.au
       </A><BR>
    <I>Fri Jun 20 02:32:05 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="050449.html">[Twisted-Python] Twisted, twistd and logging
</A></li>
        <LI>Next message (by thread): <A HREF="050451.html">[Twisted-Python] Twisted, twistd and logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50450">[ date ]</a>
              <a href="thread.html#50450">[ thread ]</a>
              <a href="subject.html#50450">[ subject ]</a>
              <a href="author.html#50450">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at divmod.com</A> wrote:
&gt;<i> On 02:13 am, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">tim at commsecure.com.au</A> wrote:
</I>&gt;<i> &gt;Having skim-read ticket 638 that JP pointed to in another reply,
</I>&gt;<i> &gt;now I'm not so sure. It's kind of difficult to for me to understand the
</I>&gt;<i> &gt;current state of play, especially since that ticket predates the merge
</I>&gt;<i> &gt;of seemingly-related ticket 3052, but it *seems* to be a battle between
</I>&gt;<i> &gt;the camps of &quot;twistd's logging is limited, it should be infinitely
</I>&gt;<i> &gt;extensible&quot; and &quot;twistd's logging is limited, applications
</I>&gt;<i> &gt;should be allowed to override it&quot;. Personally, I think I lean
</I>&gt;<i> &gt;more toward &quot;it should be infinitely extensible&quot; side - but right now I
</I>&gt;<i> &gt;don't really care about the general case of extensibility, I just want
</I>&gt;<i> &gt;more flexible syslog support.
</I>&gt;<i> 
</I>&gt;<i> Well, let me first say that your understanding of the issues here is 
</I>&gt;<i> remarkably deep and nuanced, despite your modesty :). 
</I>
Thank you. :)

&gt;<i> I don't believe there are actually different &quot;camps&quot; here, and there 
</I>&gt;<i> isn't a lot of disagreement.  At least, I believe all of the core 
</I>&gt;<i> developers have essentially the same perspective, with differences in 
</I>&gt;<i> emphasis, not content.
</I>&gt;<i> 
</I>&gt;<i> There are two systems here.  Twisted's logging (i.e. 
</I>&gt;<i> twisted.python.log), and twistd's logging 
</I>&gt;<i> (twisted.internet._twistd_unix, twisted.internet._twistw, 
</I>&gt;<i> twisted.python.syslog, among other things).  Twisted's logging, while it 
</I>&gt;<i> could certainly be improved, is in reasonable shape.  It's extremely 
</I>&gt;<i> simple, and there is a clear and (mostly) well-specified &quot;do anything 
</I>&gt;<i> you want&quot; integration point: addObserver.  While there are some tweaks 
</I>&gt;<i> I'd like to see here, I don't think it's what we're talking about.
</I>
True; if I had to make a complaint about t.p.log, it would be that this
system for arbitrary event-sources to communicate with arbitrary
event-observers needs a well-defined interface to facilitate
communication. Currently, the only things an event-observer can rely on
are the 'isError' and 'system' fields being present, and probably
'message' and 'time'. Any observer winds up either depending on extra
fields set by a specific event-source (and hoping that no other
event-source happens to use the same field-names for different
purposes), or having to treat every event as a raw text event -
defeating the point of logging complicated events in the first place.

However! That's probably an entirely separate can of worms from the
actual problem I'm currently supposed to be working on, so I shall
leave it there for now. :)

&gt;<i> The ticket which I believe most clearly explains how to fix this issue 
</I>&gt;<i> is #2751.  The question of &quot;how do we tell where twistd thinks the logs 
</I>&gt;<i> go&quot; is really just a tiny microcosm of &quot;how do we tell what twistd 
</I>&gt;<i> thinks is going on around here&quot;.  There is no clear, uniform surface 
</I>&gt;<i> presented to affect twistd's configuration from anywhere, not even 
</I>&gt;<i> internally; let alone in user code.
</I>
A kind of document-object-model of application deployment
configuration, then?

&gt;<i> The first application that needs to do this is twistd itself.  The 
</I>&gt;<i> internal APIs of twistd need to be organized such that it is easy to 
</I>&gt;<i> maintain and extend - for example, so that you could do the extension 
</I>&gt;<i> that you are proposing with syslog.  Once these APIs are tested, 
</I>&gt;<i> documented, and clearly factored, adding a plugin system to allow users 
</I>&gt;<i> to replace components of the logging system should be relatively 
</I>&gt;<i> straightforward.
</I>&gt;<i> 
</I>&gt;<i> Work is underway to do all of this; many of the tickets that we're 
</I>&gt;<i> talking about here have already have work underway.
</I>
Your most recent comment on #2571 is a lot more optimistic, it sounds
like twistd has most of the stuff it needs already.

If I have some free time, I might poke through the twistd code to see
if I can understand the architectural issues better.

&gt;<i> &gt;At any rate, ticket 638 and other related tickets seem to be high-level
</I>&gt;<i> &gt;conceptual arguments, and I don't feel I have the domain-knowledge
</I>&gt;<i> &gt;required to comment intelligibly on them.
</I>&gt;<i> 
</I>&gt;<i> I hope that this summary has improved your understanding somewhat. 
</I>&gt;<i> Don't let the depth of the issues here scare you; the best way to 
</I>&gt;<i> resolve major architectural headaches like this is one step at a time, 
</I>&gt;<i> responding to one specific use-case at a time.  So, I would recommend 
</I>&gt;<i> that you file a ticket if you haven't already, and simply add syslog 
</I>&gt;<i> facility support to twistd by adding a --syslog-facility command-line 
</I>&gt;<i> option (no, usage.Options won't let you have --foo and --foo=bar options 
</I>&gt;<i> at the same time, sorry...) and a _syslogFacility attribute to the 
</I>&gt;<i> UnixAppLogger object added by the fix to #3052.  You would of course 
</I>&gt;<i> need to add this to twisted.python.syslog as well, but I think the way 
</I>&gt;<i> to do that should be pretty straightforward.
</I>
Filed as #3300, with patches and explanations.

&gt;<i> Also, congratulations on volunteering to maintain Twisted's log 
</I>&gt;<i> subsystem!  If you would like to decline, please see David Reid about 
</I>&gt;<i> fighting a bear on your way out.  ;-).
</I>
Well, we'll see how I go. ;)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20080620/b7bc95e1/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="050449.html">[Twisted-Python] Twisted, twistd and logging
</A></li>
	<LI>Next message (by thread): <A HREF="050451.html">[Twisted-Python] Twisted, twistd and logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50450">[ date ]</a>
              <a href="thread.html#50450">[ thread ]</a>
              <a href="subject.html#50450">[ subject ]</a>
              <a href="author.html#50450">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
