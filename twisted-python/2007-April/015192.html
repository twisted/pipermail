<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Cannot pickle &lt;type 'DB'&gt; objects
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Cannot%20pickle%20%3Ctype%20%27DB%27%3E%20objects&In-Reply-To=20070409133405.18920.2039463152.divmod.quotient.9716%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015189.html">
   <LINK REL="Next"  HREF="015196.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Cannot pickle &lt;type 'DB'&gt; objects</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Cannot%20pickle%20%3Ctype%20%27DB%27%3E%20objects&In-Reply-To=20070409133405.18920.2039463152.divmod.quotient.9716%40ohm"
       TITLE="[Twisted-Python] Cannot pickle &lt;type 'DB'&gt; objects">glyph at divmod.com
       </A><BR>
    <I>Mon Apr  9 11:53:24 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="015189.html">[Twisted-Python] Cannot pickle &lt;type 'DB'&gt; objects
</A></li>
        <LI>Next message: <A HREF="015196.html">[Twisted-Python] Trial docs?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15192">[ date ]</a>
              <a href="thread.html#15192">[ thread ]</a>
              <a href="subject.html#15192">[ subject ]</a>
              <a href="author.html#15192">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01:34 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at divmod.com</A> wrote:
&gt;<i>On Mon, 09 Apr 2007 15:21:50 +0200, Roland Hedberg 
</I>&gt;<i>&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">roland.hedberg at adm.umu.se</A>&gt; wrote:
</I>
&gt;&gt;<i>Is there anyway by which I can tell mktap to &quot;forget&quot; about the
</I>&gt;&gt;<i>sleepycat database or ... ?
</I>
&gt;<i>Two possibilities jump out at me:
</I>&gt;<i>
</I>&gt;<i>  - Don't invoke the initialization code of that package in makeService,
</I>&gt;<i>    wait until the startService method of the service you create is 
</I>&gt;<i>called,
</I>&gt;<i>    and invoke it then.  This will prevent the DB from being opened 
</I>&gt;<i>until
</I>&gt;<i>    the application is actually started (ie, when twistd is run).
</I>
This has the added advantage of working with the --uid and --gid options 
of twistd as well.  If your objects are created as the service is 
created, they will be created (and the database opened) as root.  You 
almost always want to wait until the service actually starts up, i.e. 
until Twisted has already daemonized, already shed privileges, to 
actually open files and databases.
&gt;<i>  - Don't use mktap, just use twistd
</I>
There is also probably no reason to use mktap for a case like this any 
more though, and there are no tests to ensure that pickles remain 
compatible across Twisted or Python versions.  Not only are there no 
automated tests, but as far as I know nobody is still using taps as a 
method persisting configuration any more, so it is unlikely there is any 
mechanism for us to notice if pickle compatibility is broken.

In other words, you're probably better off taking both of JP's 
suggestions rather than just one.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20070409/8042406b/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20070409/8042406b/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015189.html">[Twisted-Python] Cannot pickle &lt;type 'DB'&gt; objects
</A></li>
	<LI>Next message: <A HREF="015196.html">[Twisted-Python] Trial docs?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15192">[ date ]</a>
              <a href="thread.html#15192">[ thread ]</a>
              <a href="subject.html#15192">[ subject ]</a>
              <a href="author.html#15192">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
