<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] The Trial of the DirtyReactorError
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20The%20Trial%20of%20the%20DirtyReactorError&In-Reply-To=%3C20070412185606.7769.1982208738.divmod.xquotient.2797%40joule.divmod.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047748.html">
   <LINK REL="Next"  HREF="047756.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] The Trial of the DirtyReactorError</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20The%20Trial%20of%20the%20DirtyReactorError&In-Reply-To=%3C20070412185606.7769.1982208738.divmod.xquotient.2797%40joule.divmod.com%3E"
       TITLE="[Twisted-Python] The Trial of the DirtyReactorError">glyph at divmod.com
       </A><BR>
    <I>Thu Apr 12 12:56:06 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047748.html">[Twisted-Python] The Trial of the DirtyReactorError
</A></li>
        <LI>Next message (by thread): <A HREF="047756.html">[Twisted-Python] The Trial of the DirtyReactorError
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47751">[ date ]</a>
              <a href="thread.html#47751">[ thread ]</a>
              <a href="subject.html#47751">[ subject ]</a>
              <a href="author.html#47751">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04:53 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">matt at zgroupplc.com</A> wrote:
&gt;<i>I understand why this is occurring, its a simple matter of calling 
</I>&gt;<i>tcp.Port.stopListening() to suppress the error. However, I am more 
</I>&gt;<i>concerned with learning about where the most appropriate place to run 
</I>&gt;<i>this routine would be. I am not happy about running it in the unit 
</I>&gt;<i>test as it doesn't solve the problem, it just suppresses it.
</I>
Putting the stopListening call into the middle of the actual test method 
would definitely be wrong.

However, putting the listenTCP in the setUp and the stopListening in the 
tearDown would be entirely appropriate.  If the code under test 
dynamically calls stopListening and might fail before then, then a 
tearDown by itself might be appropriate.
&gt;<i>I can't  seem to find an easy way to stop a port from listening from 
</I>&gt;<i>within a  ServerFactory. Should I be writing a class that wraps the 
</I>&gt;<i>ServerFactory to run tcp.Port.stopListening() at the appropriate time?
</I>
This is, in part, a weakness of the IProtocolFactory interface.  Calls 
to doStart and doStop should really receive an IListeningPort argument.

However, this is a minor wart.  listenTCP returns the Port, and hooking 
this up to your server factory in application code should be easy 
enough.
&gt;<i>Please bear in mind that I am creating multiple 'one-shot' servers 
</I>&gt;<i>that are always shut down as soon as they have done their business. I 
</I>&gt;<i>am guessing that the stopService methods would be more appropriate  for 
</I>&gt;<i>a conventional server that serves multiple clients / requests.
</I>
If they are &quot;always shut down&quot;, what event currently shuts them down? 
Have your test trigger that event.  If they're one-shot, then perhaps 
the method that calls listenTCP should be on the factory itself, making 
it even easier to keep track of the Port instance it is associated with.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20070412/1906a032/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047748.html">[Twisted-Python] The Trial of the DirtyReactorError
</A></li>
	<LI>Next message (by thread): <A HREF="047756.html">[Twisted-Python] The Trial of the DirtyReactorError
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47751">[ date ]</a>
              <a href="thread.html#47751">[ thread ]</a>
              <a href="subject.html#47751">[ subject ]</a>
              <a href="author.html#47751">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
