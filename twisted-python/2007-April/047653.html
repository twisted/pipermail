<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Question about plugins tutorial
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Question%20about%20plugins%20tutorial&In-Reply-To=%3C89d8b1b00704040737u5c1f30bao34b10478865870ec%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047652.html">
   <LINK REL="Next"  HREF="047654.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Question about plugins tutorial</H1>
    <B>Brian Costlow</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Question%20about%20plugins%20tutorial&In-Reply-To=%3C89d8b1b00704040737u5c1f30bao34b10478865870ec%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Question about plugins tutorial">brian.costlow at gmail.com
       </A><BR>
    <I>Wed Apr  4 08:37:20 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047652.html">[Twisted-Python] Re: 3 questions about async,	threading and dynamic protocol selection
</A></li>
        <LI>Next message (by thread): <A HREF="047654.html">[Twisted-Python] Question about plugins tutorial
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47653">[ date ]</a>
              <a href="thread.html#47653">[ thread ]</a>
              <a href="subject.html#47653">[ subject ]</a>
              <a href="author.html#47653">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been reading through the tutorial section on Twisted Plugins at:

<A HREF="http://twistedmatrix.com/projects/core/documentation/howto/plugin.html">http://twistedmatrix.com/projects/core/documentation/howto/plugin.html</A>

I have a question about this code (the actual plugin from the tutorial)

from twisted.plugin import IPlugin
from matsim import imatsim

class SimpleMaterial(object):
    implements(IPlugin, imatsim.IMaterial)

    def __init__(self, yieldStressFactor, dielectricConstant):
        self._yieldStressFactor = yieldStressFactor
        self.dielectricConstant = dielectricConstant

    def yieldStress(self, temperature):
        return self._yieldStressFactor * temperature

steelPlate = SimpleMaterial(2.06842719e11, 2.7 + 0.2j)
brassPlate = SimpleMaterial(1.03421359e11, 1.4 + 0.5j)

The tutorial implies, but does not say directly, that plug-ins should
not just define a class that implements IPlugin and your interface,
but instantiate an object. This code (also from the example) iterates
over returned plugins (actually according to the example, the objects
steelPlate and brassPlate).

def displayAllKnownMaterials():
    for material in getPlugins(imatsim.IMaterial):
        displayMaterial(material)

If my understanding is correct, then

# plugin
class Foo(object):
    implements(IPlugin, imyplugins.IMyPlugIn)

    def fooStuff(self):
        # do foo stuff
# end plugin

#call plugin from app
for n in getPlugins(imyplugins.IMyPlugIn):
    n.fooStuff()

Won't work. I'd need to do this

# plugin
 class Foo(object):
     implements(IPlugin, imyplugins.IMyPlugIn)

     def fooStuff(self):
         # do foo stuff

f = Foo()
 # end plugin

 #call plugin from app
for n in getPlugins(imyplugins.IMyPlugIn):
     n.fooStuff()

But I'm looking at the Plugins as a way to abstract multiple back-end
actions taken in response to data recieved by a number of asynchronous
events (off of LineReciever and XML-RPC). The plug-in is going to need
to keep some intermediate state data in some cases, which won't work
if they all get the same object. So I was thinking of something along
these lines:

# plugin
  class Foo(object):
      implements(IPlugin, imyplugins.IMyPlugIn)

      def fooStuff(self):
          # do foo stuff

    def fooFactory(self):
        return Foo()

 f = Foo()
  # end plugin

  #call plugin from app
 for n in getPlugins(imyplugins.IMyPlugIn):
    o = n.fooFactory()
      o.fooStuff()


Does this make sense? Is there a better way in the twisted framework
to handle this?


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047652.html">[Twisted-Python] Re: 3 questions about async,	threading and dynamic protocol selection
</A></li>
	<LI>Next message (by thread): <A HREF="047654.html">[Twisted-Python] Question about plugins tutorial
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47653">[ date ]</a>
              <a href="thread.html#47653">[ thread ]</a>
              <a href="subject.html#47653">[ subject ]</a>
              <a href="author.html#47653">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
