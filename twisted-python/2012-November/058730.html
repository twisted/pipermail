<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted thumbnail server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted%20thumbnail%20server&In-Reply-To=%3CCAE_Hg6ZPU1cFYT0CXvXuktN64Y05hegzs-ShZFgCSsV5n%2BdSsA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="058729.html">
   <LINK REL="Next"  HREF="058733.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted thumbnail server</H1>
    <B>Laurens Van Houtven</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted%20thumbnail%20server&In-Reply-To=%3CCAE_Hg6ZPU1cFYT0CXvXuktN64Y05hegzs-ShZFgCSsV5n%2BdSsA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] twisted thumbnail server">_ at lvh.cc
       </A><BR>
    <I>Fri Nov  2 09:57:42 MDT 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="058729.html">[Twisted-Python] twisted thumbnail server
</A></li>
        <LI>Next message (by thread): <A HREF="058733.html">[Twisted-Python] twisted thumbnail server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58730">[ date ]</a>
              <a href="thread.html#58730">[ thread ]</a>
              <a href="subject.html#58730">[ subject ]</a>
              <a href="author.html#58730">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yeah, very big +1 to showing the deferToThread version. I feel bad even
trying to spot potential threading issues here... It could be because the
default thread pool isn't very large, but you're making many requests.

What functionality does boto have that txaws doesn't that you really need
here? Perhaps you can avoid blocking (and hence threads) at all.


On Fri, Nov 2, 2012 at 4:42 PM, Paul Wiseman &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">poalman at gmail.com</A>&gt; wrote:

&gt;<i> I hope this will be an easy question for some of you guys :)
</I>&gt;<i>
</I>&gt;<i> I'm trying to set up a simple server which will accept requests over GET
</I>&gt;<i> to create a thumbnail for an image, and server it back as the response.
</I>&gt;<i>
</I>&gt;<i> The images are stored in two S3 buckets, the originals are in one bucket
</I>&gt;<i> (store), and the generated thumbnails are stored in another (thumb) as a
</I>&gt;<i> cache so that the work doesn't need to be repeated.
</I>&gt;<i>
</I>&gt;<i> Currently I'm checking if the thumbnail already exists in the thumb
</I>&gt;<i> bucket. I'm redirecting the request if it is or if not I'm downloading the
</I>&gt;<i> image from store, generating the thumb using PIL, uploading the thumbnail
</I>&gt;<i> to the thumb bucket and then redirecting the request.
</I>&gt;<i>
</I>&gt;<i> I'm very new to twisted and was wondering if anyone who is more
</I>&gt;<i> experienced would be able to take a look at what I have so far and let me
</I>&gt;<i> know if anything is wrong/not ideal/will cause problems etc. or just
</I>&gt;<i> general style pointers? The more critical the better, as I said I'm very
</I>&gt;<i> new to this.
</I>&gt;<i>
</I>&gt;<i> I've just chucked it up on github:
</I>&gt;<i> <A HREF="https://github.com/GP89/thumbs/blob/master/thumb.py">https://github.com/GP89/thumbs/blob/master/thumb.py</A>
</I>&gt;<i>
</I>&gt;<i> There's a definite memory leak right now which I believe is PIL, or
</I>&gt;<i> possibly StringIO objects not being disposed, hence all the random del
</I>&gt;<i> statements trying to cure it (unsuccessfully). Maybe there's something I'm
</I>&gt;<i> doing wrong in twisted that is causing things not to be cleaned up that I'm
</I>&gt;<i> not aware of as well.
</I>&gt;<i>
</I>&gt;<i> I did try to use deferToThread, rather than my thread pool but the server
</I>&gt;<i> seemed to block up- I probably should have left it incase it was because I
</I>&gt;<i> was doing something obviously wrong. I think I'll make a branch quickly
</I>&gt;<i> with my deferToThread version.
</I>&gt;<i>
</I>&gt;<i> Thanks very much for any time you can lend!
</I>&gt;<i>
</I>&gt;<i> Paul
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20121102/d9cb74f8/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="058729.html">[Twisted-Python] twisted thumbnail server
</A></li>
	<LI>Next message (by thread): <A HREF="058733.html">[Twisted-Python] twisted thumbnail server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58730">[ date ]</a>
              <a href="thread.html#58730">[ thread ]</a>
              <a href="subject.html#58730">[ subject ]</a>
              <a href="author.html#58730">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
