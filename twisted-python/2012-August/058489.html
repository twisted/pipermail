<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Switching Protocols and TLS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Switching%20Protocols%20and%20TLS&In-Reply-To=%3C20120829135301.23316.467672191.divmod.xquotient.14%40localhost6.localdomain6%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="058488.html">
   <LINK REL="Next"  HREF="058490.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Switching Protocols and TLS</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Switching%20Protocols%20and%20TLS&In-Reply-To=%3C20120829135301.23316.467672191.divmod.xquotient.14%40localhost6.localdomain6%3E"
       TITLE="[Twisted-Python] Switching Protocols and TLS">exarkun at twistedmatrix.com
       </A><BR>
    <I>Wed Aug 29 07:53:01 MDT 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="058488.html">[Twisted-Python] Switching Protocols and TLS
</A></li>
        <LI>Next message (by thread): <A HREF="058490.html">[Twisted-Python] Switching Protocols and TLS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58489">[ date ]</a>
              <a href="thread.html#58489">[ thread ]</a>
              <a href="subject.html#58489">[ subject ]</a>
              <a href="author.html#58489">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01:19 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">tobias.oberstein at tavendo.de</A> wrote:
&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>I am running a Twisted Web Site object that switches the protocol for 
</I>&gt;<i>specific paths.
</I>&gt;<i>The goal is to run Twisted Web, and have certain paths mapped to 
</I>&gt;<i>WebSocket.
</I>&gt;<i>
</I>&gt;<i>I am aware of
</I>&gt;<i>
</I>&gt;<i><A HREF="http://twistedmatrix.com/trac/ticket/3204">http://twistedmatrix.com/trac/ticket/3204</A>
</I>&gt;<i>
</I>&gt;<i>but in the meantime have working code
</I>&gt;<i>
</I>&gt;<i><A HREF="https://github.com/tavendo/AutobahnPython/blob/master/autobahn/autobahn/resource.py#L84">https://github.com/tavendo/AutobahnPython/blob/master/autobahn/autobahn/resource.py#L84</A>
</I>&gt;<i>
</I>&gt;<i>This works for non-TLS, but not for TLS.
</I>&gt;<i>
</I>&gt;<i>This works perfectly:
</I>&gt;<i>
</I>&gt;<i><A HREF="https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_site">https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_site</A>
</I>&gt;<i>
</I>&gt;<i>and this does NOT work:
</I>&gt;<i>
</I>&gt;<i><A HREF="https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_site_tls">https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_site_tls</A>
</I>&gt;<i>
</I>&gt;<i>The latter is able to send stuff down to client, but won't receive 
</I>&gt;<i>anything.
</I>&gt;<i>
</I>&gt;<i>Any hint how to track that down would be great!
</I>
The `protocolÂ´ attribute isn't part of the transport interface.  Some 
transports are implemented in a way such that changing that attribute to 
refer to a different protocol will produce the behavior you're after, 
but not all.  In particular, the transport implemented in 
twisted.protocols.tls (used to provide the transport whenever you use 
listenSSL, connectSSL, or startTLS) does not work this way.

You should be able to work out which attribute needs to be mangled by 
looking at twisted/protocols/tls.py.  My initial guess would be 
`wrappedProtocol`, but that's *only* a guess.  And of course, whatever 
you find is not going to be part of any formal transport interface 
either, so it's not guaranteed to keep working in the future, or to work 
with any other transport you might end up using - hence the desire to 
resolve #3204.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="058488.html">[Twisted-Python] Switching Protocols and TLS
</A></li>
	<LI>Next message (by thread): <A HREF="058490.html">[Twisted-Python] Switching Protocols and TLS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58489">[ date ]</a>
              <a href="thread.html#58489">[ thread ]</a>
              <a href="subject.html#58489">[ subject ]</a>
              <a href="author.html#58489">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
