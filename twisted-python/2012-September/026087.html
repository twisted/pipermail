<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] MemoryError in twisted causes the program to	exit, or not
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20MemoryError%20in%20twisted%20causes%20the%20program%20to%0A%09exit%2C%20or%20not&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026086.html">
   <LINK REL="Next"  HREF="026091.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] MemoryError in twisted causes the program to	exit, or not</H1>
    <B>Antoine Pitrou</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20MemoryError%20in%20twisted%20causes%20the%20program%20to%0A%09exit%2C%20or%20not&In-Reply-To="
       TITLE="[Twisted-Python] MemoryError in twisted causes the program to	exit, or not">solipsis at pitrou.net
       </A><BR>
    <I>Fri Sep 28 04:10:23 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="026086.html">[Twisted-Python] MemoryError in twisted causes the program to	exit, or not
</A></li>
        <LI>Next message: <A HREF="026091.html">[Twisted-Python] MemoryError in twisted causes the program to	exit, or not
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26087">[ date ]</a>
              <a href="thread.html#26087">[ thread ]</a>
              <a href="subject.html#26087">[ subject ]</a>
              <a href="author.html#26087">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 28 Sep 2012 00:09:23 -0700
Glyph &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:
&gt;<i> 
</I>&gt;<i> Le Sep 27, 2012 &#224; 7:41 PM, Benjamin Rutt &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rutt.4 at osu.edu</A>&gt; a &#233;crit :
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi, I am trying to understand what will happen in my long-running twisted server program when the available memory is low. 
</I>&gt;<i> 
</I>&gt;<i> Probably nothing good.
</I>&gt;<i> 
</I>&gt;<i> &gt; If I run the following program with increasing numeric seeds as arguments, 0, 1, 2, 3, 4, &#8230; , some of the time the out of memory condition will crash and exit the program right away (when the MemoryError is raised inside twisted core code), and other times it will just carry on with an UnhandledError (if the MemoryError is raised inside my hi() function below).
</I>&gt;<i> 
</I>&gt;<i> Yes.
</I>&gt;<i> 
</I>&gt;<i> Ostensibly, Twisted could deal with this &quot;better&quot; by special-casing MemoryError in top-level error handlers and falling through to exit, rather than attempting to log; but, in cases where only a localized area is experiencing memory pressure and the exception causes cleanup to happen correctly, this would overzealously exit your service even in cases where it could recover.
</I>
I agree this would be unwelcome behaviour.

&gt;<i> If you have a better idea for how Twisted might handle this generally though, I'm happy to hear it :).
</I>
Calling gc.collect() might improve things, temporarily or not, in some
contexts. Perhaps enough to be able to log the error, so that the
developer isn't left without a clue.

(whether Python itself should try to GC-collect when MemoryError is
raised is an open question)

Regards

Antoine.


-- 
Software development and contracting: <A HREF="http://pro.pitrou.net">http://pro.pitrou.net</A>



</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026086.html">[Twisted-Python] MemoryError in twisted causes the program to	exit, or not
</A></li>
	<LI>Next message: <A HREF="026091.html">[Twisted-Python] MemoryError in twisted causes the program to	exit, or not
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26087">[ date ]</a>
              <a href="thread.html#26087">[ thread ]</a>
              <a href="subject.html#26087">[ subject ]</a>
              <a href="author.html#26087">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
