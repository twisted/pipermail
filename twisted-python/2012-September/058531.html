<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] implementing NAMES in IRC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20implementing%20NAMES%20in%20IRC&In-Reply-To=%3C4D95F75B-C038-410E-A839-77B8372B21A9%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="058530.html">
   <LINK REL="Next"  HREF="058532.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] implementing NAMES in IRC</H1>
    <B>Adrian Overbury</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20implementing%20NAMES%20in%20IRC&In-Reply-To=%3C4D95F75B-C038-410E-A839-77B8372B21A9%40gmail.com%3E"
       TITLE="[Twisted-Python] implementing NAMES in IRC">skaarjj at gmail.com
       </A><BR>
    <I>Tue Sep 11 18:12:13 MDT 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="058530.html">[Twisted-Python] implementing NAMES in IRC
</A></li>
        <LI>Next message (by thread): <A HREF="058532.html">[Twisted-Python] implementing NAMES in IRC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58531">[ date ]</a>
              <a href="thread.html#58531">[ thread ]</a>
              <a href="subject.html#58531">[ subject ]</a>
              <a href="author.html#58531">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12/09/2012, at 8:01 AM, &quot;Jasper St. Pierre&quot; &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jstpierre at mecheye.net</A>&gt; wrote:

&gt;<i> On Tue, Sep 11, 2012 at 9:43 AM,  &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>&gt; wrote:
</I>&gt;&gt;<i> On 10:49 am, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mithrandi at mithrandi.net</A> wrote:
</I>&gt;&gt;&gt;<i> On Tue, Sep 11, 2012 at 6:05 AM, Glyph &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> Such a bug may already exist - if you wouldn't mind, would you search
</I>&gt;&gt;&gt;&gt;<i> for
</I>&gt;&gt;&gt;&gt;<i> it, and if you can't find it, file a new one?
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> I don't know if there's an existing bug or not, but implementing a
</I>&gt;&gt;&gt;<i> names() method is problematic. The natural API would be something like
</I>&gt;&gt;&gt;<i> names('#foo') -&gt; Deferred firing with a list of names in the channel.
</I>&gt;&gt;&gt;<i> The difficulty in implementing this comes from the fact that there are
</I>&gt;&gt;&gt;<i> two possible results from issuing a NAMES command on IRC: a serious of
</I>&gt;&gt;&gt;<i> zero or more RPL_NAMREPLY messages followed by an RPL_ENDOFNAMES
</I>&gt;&gt;&gt;<i> message, *or* any error message the IRC server feels like. There are a
</I>&gt;&gt;&gt;<i> number of partial workarounds for this, involving various combinations
</I>&gt;&gt;&gt;<i> of queues, timeouts, and unreliable detection of responses, but none
</I>&gt;&gt;&gt;<i> of them seem particularly satisfactory to me.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This is the excuse that is always given for not implementing a new
</I>&gt;&gt;<i> feature on `IRCClient`.  However, here's another equivalent way of
</I>&gt;&gt;<i> stating the objection:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  IRC is a terrible protocol and it is very difficult to implement a
</I>&gt;&gt;<i>  method like `names` reliably, due to the various vague and obscure
</I>&gt;&gt;<i>  corner cases presented.  Therefore, instead of Twisted tackling this
</I>&gt;&gt;<i>  problem and providing a single (perhaps imperfect) implementation,
</I>&gt;&gt;<i>  every single IRC application developer should instead rediscover this
</I>&gt;&gt;<i>  sad reality for themselves and then implement their own uniquely buggy
</I>&gt;&gt;<i>  version of this functionality.
</I>&gt;<i> 
</I>&gt;<i> I know you know what this means, exarkun, but for those who don't know
</I>&gt;<i> exactly what this means, it means that you can send two requests out,
</I>&gt;<i> and not be guaranteed to get replies in any particular order (or at
</I>&gt;<i> all), and that means that you can get ambiguous replies to requests.
</I>&gt;<i> 
</I>&gt;<i> Additionally, IRC daemons may play tricks and send out &quot;replies&quot; that
</I>&gt;<i> doesn't associate with any request you've sent, as a means to have a
</I>&gt;<i> client perform a specific action; for instance, bouncers usually send
</I>&gt;<i> join replies without any associated requests method of forcing a
</I>&gt;<i> client to open a buffer for a particular channel, and certain networks
</I>&gt;<i> also use this same technique to force users on specific channels all
</I>&gt;<i> the time (and they will also make a PART request on this particular
</I>&gt;<i> channel fail).
</I>&gt;<i> 
</I>&gt;<i> These two things mean that you cannot have a Deferred-based API for
</I>&gt;<i> IRC, where each request correlates to one response, and instead need
</I>&gt;<i> to have a reactionary system where you cast a NAMES out to the wind,
</I>&gt;<i> and just implement some sane behavior on every RPL_NAMREPLY you get,
</I>&gt;<i> independent of what triggered it.
</I>&gt;<i> 
</I>
However it is entirely possible to sanely parse and store replies in a reactionary system because the first component of an RPL_NAMREPLY message is the name of the channel it applies to.  

You can log or quietly drop replies that aren't for channels you're currently following, and use the others to build out some kind of structure that maintains an active list of users in that channel and their status (maintained through subsequent joins and parts).  Is this not so?  It doesn't sound that complicated to me.

&gt;&gt;<i> Hopefully, cast in that light, it's a bit more clear why this might not
</I>&gt;&gt;<i> be a reasonable argument.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I can think of other arguments against adding a `names` (or similar)
</I>&gt;&gt;<i> method to `IRCClient`, but since it's not likely anyone is actually
</I>&gt;&gt;<i> going to step up and do any work on `irc.py` anyway, I don't feel the
</I>&gt;&gt;<i> need to make them (and I'd much rather someone actually maintain
</I>&gt;&gt;<i> `irc.py`).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Jean-Paul
</I>&gt;&gt;&gt;<i> (On the other hand, a method that just sends NAMES #foo without any
</I>&gt;&gt;&gt;<i> response handling would be pretty straightforward to implement, maybe
</I>&gt;&gt;&gt;<i> that's what you meant?)
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> mithrandi, i Ainil en-Balandor, a faer Ambar
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i>  Jasper
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="058530.html">[Twisted-Python] implementing NAMES in IRC
</A></li>
	<LI>Next message (by thread): <A HREF="058532.html">[Twisted-Python] implementing NAMES in IRC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58531">[ date ]</a>
              <a href="thread.html#58531">[ thread ]</a>
              <a href="subject.html#58531">[ subject ]</a>
              <a href="author.html#58531">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
