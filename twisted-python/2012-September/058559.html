<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] MemoryError in twisted causes the program to	exit, or not
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20MemoryError%20in%20twisted%20causes%20the%20program%20to%0A%09exit%2C%20or%20not&In-Reply-To=%3C30CAF791-9DAA-4D7A-8A62-8E32CA8711EF%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="058558.html">
   <LINK REL="Next"  HREF="058560.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] MemoryError in twisted causes the program to	exit, or not</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20MemoryError%20in%20twisted%20causes%20the%20program%20to%0A%09exit%2C%20or%20not&In-Reply-To=%3C30CAF791-9DAA-4D7A-8A62-8E32CA8711EF%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] MemoryError in twisted causes the program to	exit, or not">glyph at twistedmatrix.com
       </A><BR>
    <I>Fri Sep 28 01:09:23 MDT 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="058558.html">[Twisted-Python] MemoryError in twisted causes the program to exit,	or not
</A></li>
        <LI>Next message (by thread): <A HREF="058560.html">[Twisted-Python] MemoryError in twisted causes the program to	exit, or not
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58559">[ date ]</a>
              <a href="thread.html#58559">[ thread ]</a>
              <a href="subject.html#58559">[ subject ]</a>
              <a href="author.html#58559">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Le Sep 27, 2012 à 7:41 PM, Benjamin Rutt &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rutt.4 at osu.edu</A>&gt; a écrit :

&gt;<i> Hi, I am trying to understand what will happen in my long-running twisted server program when the available memory is low. 
</I>
Probably nothing good.

&gt;<i> If I run the following program with increasing numeric seeds as arguments, 0, 1, 2, 3, 4, … , some of the time the out of memory condition will crash and exit the program right away (when the MemoryError is raised inside twisted core code), and other times it will just carry on with an UnhandledError (if the MemoryError is raised inside my hi() function below).
</I>
Yes.

Resource exhaustion testing is tough, especially in Python, where literally every function call may (non-deterministically) allocate memory.  MemoryError is an exception that you may see at any time, in any context, without warning.  Most notably you may encounter a MemoryError when attempting to handle a MemoryError and there's not much you can do about it at that point.

Ostensibly, Twisted could deal with this &quot;better&quot; by special-casing MemoryError in top-level error handlers and falling through to exit, rather than attempting to log; but, in cases where only a localized area is experiencing memory pressure and the exception causes cleanup to happen correctly, this would overzealously exit your service even in cases where it could recover.

So: don't exhaust your available memory.  It will cause a lot of unpredictable problems.

If you have a better idea for how Twisted might handle this generally though, I'm happy to hear it :).

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20120928/2155abce/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="058558.html">[Twisted-Python] MemoryError in twisted causes the program to exit,	or not
</A></li>
	<LI>Next message (by thread): <A HREF="058560.html">[Twisted-Python] MemoryError in twisted causes the program to	exit, or not
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58559">[ date ]</a>
              <a href="thread.html#58559">[ thread ]</a>
              <a href="subject.html#58559">[ subject ]</a>
              <a href="author.html#58559">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
