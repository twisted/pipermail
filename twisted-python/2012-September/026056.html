<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] implementing NAMES in IRC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20implementing%20NAMES%20in%20IRC&In-Reply-To=20120911134317.27659.2034342639.divmod.xquotient.7%40localhost6.localdomain6">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026054.html">
   <LINK REL="Next"  HREF="026057.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] implementing NAMES in IRC</H1>
    <B>Jasper St. Pierre</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20implementing%20NAMES%20in%20IRC&In-Reply-To=20120911134317.27659.2034342639.divmod.xquotient.7%40localhost6.localdomain6"
       TITLE="[Twisted-Python] implementing NAMES in IRC">jstpierre at mecheye.net
       </A><BR>
    <I>Tue Sep 11 18:01:31 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="026054.html">[Twisted-Python] implementing NAMES in IRC
</A></li>
        <LI>Next message: <A HREF="026057.html">[Twisted-Python] implementing NAMES in IRC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26056">[ date ]</a>
              <a href="thread.html#26056">[ thread ]</a>
              <a href="subject.html#26056">[ subject ]</a>
              <a href="author.html#26056">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Sep 11, 2012 at 9:43 AM,  &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>&gt; wrote:
&gt;<i> On 10:49 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mithrandi at mithrandi.net</A> wrote:
</I>&gt;&gt;<i>On Tue, Sep 11, 2012 at 6:05 AM, Glyph &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i>Such a bug may already exist - if you wouldn't mind, would you search
</I>&gt;&gt;&gt;<i>for
</I>&gt;&gt;&gt;<i>it, and if you can't find it, file a new one?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I don't know if there's an existing bug or not, but implementing a
</I>&gt;&gt;<i>names() method is problematic. The natural API would be something like
</I>&gt;&gt;<i>names('#foo') -&gt; Deferred firing with a list of names in the channel.
</I>&gt;&gt;<i>The difficulty in implementing this comes from the fact that there are
</I>&gt;&gt;<i>two possible results from issuing a NAMES command on IRC: a serious of
</I>&gt;&gt;<i>zero or more RPL_NAMREPLY messages followed by an RPL_ENDOFNAMES
</I>&gt;&gt;<i>message, *or* any error message the IRC server feels like. There are a
</I>&gt;&gt;<i>number of partial workarounds for this, involving various combinations
</I>&gt;&gt;<i>of queues, timeouts, and unreliable detection of responses, but none
</I>&gt;&gt;<i>of them seem particularly satisfactory to me.
</I>&gt;<i>
</I>&gt;<i> This is the excuse that is always given for not implementing a new
</I>&gt;<i> feature on `IRCClient`.  However, here's another equivalent way of
</I>&gt;<i> stating the objection:
</I>&gt;<i>
</I>&gt;<i>   IRC is a terrible protocol and it is very difficult to implement a
</I>&gt;<i>   method like `names` reliably, due to the various vague and obscure
</I>&gt;<i>   corner cases presented.  Therefore, instead of Twisted tackling this
</I>&gt;<i>   problem and providing a single (perhaps imperfect) implementation,
</I>&gt;<i>   every single IRC application developer should instead rediscover this
</I>&gt;<i>   sad reality for themselves and then implement their own uniquely buggy
</I>&gt;<i>   version of this functionality.
</I>
I know you know what this means, exarkun, but for those who don't know
exactly what this means, it means that you can send two requests out,
and not be guaranteed to get replies in any particular order (or at
all), and that means that you can get ambiguous replies to requests.

Additionally, IRC daemons may play tricks and send out &quot;replies&quot; that
doesn't associate with any request you've sent, as a means to have a
client perform a specific action; for instance, bouncers usually send
join replies without any associated requests method of forcing a
client to open a buffer for a particular channel, and certain networks
also use this same technique to force users on specific channels all
the time (and they will also make a PART request on this particular
channel fail).

These two things mean that you cannot have a Deferred-based API for
IRC, where each request correlates to one response, and instead need
to have a reactionary system where you cast a NAMES out to the wind,
and just implement some sane behavior on every RPL_NAMREPLY you get,
independent of what triggered it.

&gt;<i> Hopefully, cast in that light, it's a bit more clear why this might not
</I>&gt;<i> be a reasonable argument.
</I>&gt;<i>
</I>&gt;<i> I can think of other arguments against adding a `names` (or similar)
</I>&gt;<i> method to `IRCClient`, but since it's not likely anyone is actually
</I>&gt;<i> going to step up and do any work on `irc.py` anyway, I don't feel the
</I>&gt;<i> need to make them (and I'd much rather someone actually maintain
</I>&gt;<i> `irc.py`).
</I>&gt;<i>
</I>&gt;<i> Jean-Paul
</I>&gt;&gt;<i>(On the other hand, a method that just sends NAMES #foo without any
</I>&gt;&gt;<i>response handling would be pretty straightforward to implement, maybe
</I>&gt;&gt;<i>that's what you meant?)
</I>&gt;&gt;<i>--
</I>&gt;&gt;<i>mithrandi, i Ainil en-Balandor, a faer Ambar
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Twisted-Python mailing list
</I>&gt;&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>


-- 
  Jasper

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026054.html">[Twisted-Python] implementing NAMES in IRC
</A></li>
	<LI>Next message: <A HREF="026057.html">[Twisted-Python] implementing NAMES in IRC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26056">[ date ]</a>
              <a href="thread.html#26056">[ thread ]</a>
              <a href="subject.html#26056">[ subject ]</a>
              <a href="author.html#26056">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
