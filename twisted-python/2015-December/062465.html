<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Notification when SSHConnectForwardingChannel	is ready for traffic?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Notification%20when%20SSHConnectForwardingChannel%0A%09is%20ready%20for%20traffic%3F&In-Reply-To=%3C54F32FE5-75D2-45B3-AFC2-9530F44CFB38%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Notification when SSHConnectForwardingChannel	is ready for traffic?</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Notification%20when%20SSHConnectForwardingChannel%0A%09is%20ready%20for%20traffic%3F&In-Reply-To=%3C54F32FE5-75D2-45B3-AFC2-9530F44CFB38%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Notification when SSHConnectForwardingChannel	is ready for traffic?">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Dec  1 01:30:00 MST 2015</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62465">[ date ]</a>
              <a href="thread.html#62465">[ thread ]</a>
              <a href="subject.html#62465">[ subject ]</a>
              <a href="author.html#62465">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Nov 30, 2015, at 4:17 PM, Naveen Michaud-Agrawal &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">naveen.michaudagrawal at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I've managed to implement ssh tunneling using this answer on SO - <A HREF="http://stackoverflow.com/a/23549091/5605324">http://stackoverflow.com/a/23549091/5605324</A> &lt;<A HREF="http://stackoverflow.com/a/23549091/5605324">http://stackoverflow.com/a/23549091/5605324</A>&gt;, and the tunnel can be used from another app. However I would like to use it from within the twisted application, but I'm not sure what to wire up so that I can get a callback when the SSHConnectForwardingChannel is ready for traffic. It looks like I can attach a callback to channel's _channelOpenDeferred, but that seems a bit hacky. Any suggestions?
</I>
Don't use listenTCP. Use endpoints: <A HREF="https://twistedmatrix.com/documents/15.5.0/core/howto/endpoints.html">https://twistedmatrix.com/documents/15.5.0/core/howto/endpoints.html</A> 

Once you have adopted endpoints, it (hopefully) becomes clear that one way to do what you want is to create your own in-process IStreamServerEndpoint implementation, and pass 'factory' in that answer to its 'listen' method, you can deliver data for it to relay to the remote port by calling its '.dataReceived' method, and implement your own '.write' method on your transport in order to deliver data to your application.  There's nothing magical about these methods, after all, they're just Python functions - and forwarding.SSHListenForwardingFactory just expects to talk to a transport, it shouldn't matter what kind it is.  (It might need to implement other interfaces, like ITCPTransport; not everything in Twisted is scrupulously careful about declaring what exact interface it needs, and there are often bugs in edge-cases like this.  But those are also just a few more methods you can implement, if necessary.)

Does this make sense?

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20151201/6a578f67/attachment-0002.html&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62465">[ date ]</a>
              <a href="thread.html#62465">[ thread ]</a>
              <a href="subject.html#62465">[ subject ]</a>
              <a href="author.html#62465">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
