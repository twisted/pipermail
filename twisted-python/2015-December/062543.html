<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] The role of	twisted.internet._sslverify.IOpenSSLTrustRoot
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20The%20role%20of%0A%09twisted.internet._sslverify.IOpenSSLTrustRoot&In-Reply-To=%3C755589F9-90E5-4FA9-AEC6-FB38D6F4D42D%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="030077.html">
   <LINK REL="Next"  HREF="062544.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] The role of	twisted.internet._sslverify.IOpenSSLTrustRoot</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20The%20role%20of%0A%09twisted.internet._sslverify.IOpenSSLTrustRoot&In-Reply-To=%3C755589F9-90E5-4FA9-AEC6-FB38D6F4D42D%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] The role of	twisted.internet._sslverify.IOpenSSLTrustRoot">glyph at twistedmatrix.com
       </A><BR>
    <I>Fri Dec 25 02:20:04 MST 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="030077.html">[Twisted-Python] The role of	twisted.internet._sslverify.IOpenSSLTrustRoot
</A></li>
        <LI>Next message (by thread): <A HREF="062544.html">[Twisted-Python] The role of	twisted.internet._sslverify.IOpenSSLTrustRoot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62543">[ date ]</a>
              <a href="thread.html#62543">[ thread ]</a>
              <a href="subject.html#62543">[ subject ]</a>
              <a href="author.html#62543">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Dec 20, 2015, at 9:05 AM, Adi Roiban &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">adi at roiban.ro</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> What is the purpose of IOpenSSLTrustRoot ?
</I>
The idea is that we have public functions, mainly `optionsForClientTLS´, which need to take a thing that represents a &quot;trust root&quot;.  We want this to be something that can abstractly be described at a high level, but then in reality we need to do with gross implementation details of OpenSSL.  So this interface describes what you pass.

&gt;<i> It it documented as a private interface, it has only private methods, but then it is exposed in  twisted.internet.ssl.optionsForClientTLS
</I>&gt;<i> 
</I>&gt;<i> Why?
</I>
Yes, this is intentional.  It is a private interface, so you can't check if something provides it, you aren't allowed to know what attributes it has, and you can't implement it.  However, you can call a function that is documented to return a value that provides it (such as `twisted.internet.ssl.platformTrust´) and pass that value to a function documented to accept it (such as `twisted.internet.ssl.optionsForClientTLS`).

It's private because we weren't sure if we'd want to change it.  At the time it was implemented, the only two cases were OpenSSLDefaultPaths and Certificate.  In the case of Certificate, you know what certificate you're adding, but in the case of OpenSSLDefaultPaths, you just call a method on the context object to mutate it, and you can't extract information about which certificates are trusted past that.  The method we came up with, _addCACertsToContext, was a gross compromise which allowed for implementing this but could not be made abstract, because it reflects a bizarre flaw in the OpenSSL API, and it by necessity exposes pyOpenSSL objects, which we are trying to do less of.  For one thing, we'd eventually like to support TLS via OpenSSL using an API provided by Cryptography; for another, we'd like to one day provide TLS from an API that might not be backed by OpenSSL at all.  So reducing the surface area of our public API that touches pyOpenSSL is important.

Hopefully this thoroughly explains the decision?

&gt;<i> I am confused while trying to review <A HREF="https://twistedmatrix.com/trac/ticket/7671">https://twistedmatrix.com/trac/ticket/7671</A> &lt;<A HREF="https://twistedmatrix.com/trac/ticket/7671">https://twistedmatrix.com/trac/ticket/7671</A>&gt; 
</I>&gt;<i> 
</I>&gt;<i> Please take a look at my review and add your wisdom :)
</I>
This is quite a detailed review :-).

Merry christmas,

-glyph


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20151225/991030ad/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="030077.html">[Twisted-Python] The role of	twisted.internet._sslverify.IOpenSSLTrustRoot
</A></li>
	<LI>Next message (by thread): <A HREF="062544.html">[Twisted-Python] The role of	twisted.internet._sslverify.IOpenSSLTrustRoot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62543">[ date ]</a>
              <a href="thread.html#62543">[ thread ]</a>
              <a href="subject.html#62543">[ subject ]</a>
              <a href="author.html#62543">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
