<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Deferred documentation.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Deferred%20documentation.&In-Reply-To=%3CBANLkTinf2CTo-xaowDeAh_9T79BG_dQzMA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="056230.html">
   <LINK REL="Next"  HREF="056250.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Deferred documentation.</H1>
    <B>Jasper St. Pierre</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Deferred%20documentation.&In-Reply-To=%3CBANLkTinf2CTo-xaowDeAh_9T79BG_dQzMA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Deferred documentation.">jstpierre at mecheye.net
       </A><BR>
    <I>Mon Mar 28 03:52:58 MDT 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="056230.html">[Twisted-Python] Deferred documentation.
</A></li>
        <LI>Next message (by thread): <A HREF="056250.html">[Twisted-Python] Deferred documentation.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56236">[ date ]</a>
              <a href="thread.html#56236">[ thread ]</a>
              <a href="subject.html#56236">[ subject ]</a>
              <a href="author.html#56236">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK, I'm already making a lot of these changes, I should have a new version
Up Soon (TM).

&gt;<i> Placeholders.
</I>&gt;<i>
</I>&gt;<i> Placeholders for what, though?
</I>&gt;<i>
</I>
Placeholders for that magic lib, that I think I'm going to stop looking for
and say, &quot;demonstration purposes only&quot;

How do they use it?  Why is it relevant?

I guess I'm stupid or slow, but it took a while for me to realize that
Deferreds were basically a standardized callback mechanism. It's not
really written anywhere on the tin: Deferred was to me a bit of an
unobvious name for what it does, and before recently I've always
associated it tightly to scheduling and the reactor.

No, this is a common problem.  I think it would be great to address the
definition a bit more comprehensively.

Through example?

It does seem to be a bit disconnected from the flow of the regular text.
&gt;<i>  Perhaps it would be better if it were laid out as a paragraph, and then
</I>&gt;<i> each sentence, or clause, were examined more closely, perhaps with an
</I>&gt;<i> accompanying code snippet to clarify it.
</I>&gt;<i>
</I>
As I said, I don't want to explain that snippet. I just want to put it
there, ignore it, and hopefully the user will understand more of it as the
tutorial goes on.

&gt;<i> Right now, it's a placeholder for that magic library that I haven't found
</I>&gt;<i> yet.
</I>&gt;<i>
</I>&gt;<i> I can see why you might want to do that.  In the narrative flow between
</I>&gt;<i> urllib and Deferreds, there is a missing step; you may need to fake that
</I>&gt;<i> out.  I'm just saying that you should be very clear and say &quot;this is a fake
</I>&gt;<i> example, merely for the purpose of illustration&quot;.  I think that Tornado has
</I>&gt;<i> some ugly callback-based stuff, but it would be better to leave this example
</I>&gt;<i> fake than to try to teach users how to use that.
</I>&gt;<i>
</I>
Will do.


&gt;<i> Are there specific changes you find that could make it harder to read
</I>&gt;<i> for newcomers?
</I>&gt;<i>
</I>&gt;<i> I thought my previous message was a list of those :-(
</I>&gt;<i>
</I>
Well, it was a draft, and I felt that most of my changes were already
improvements over what was there. I didn't expect it to be &quot;harder to read
for newcomers&quot;.

&gt;<i> The concept of Deferreds isn't hard at all, once you understand what
</I>&gt;<i> they are. The subtle nuances and bits of glue code that Twisted are
</I>&gt;<i> the things that can trip someone up, and what I'm still learning. A
</I>&gt;<i> small amount of very specific use cases for Deferreds happen in
</I>&gt;<i> real-world code and I'd like to show the support that Twisted has for
</I>&gt;<i> them built-in.
</I>&gt;<i>
</I>&gt;<i> My goals for this document are:
</I>&gt;<i>
</I>&gt;<i>  1) A list of guaranteed rules about Deferreds for reference at any time.
</I>&gt;<i>  2) An introduction to those rules in a format that doesn't require
</I>&gt;<i> knowledge of others.
</I>&gt;<i>  3) Showing techniques or tricks that you can play by &quot;exploiting&quot;
</I>&gt;<i> parts of those rules in the context of a contrived problem.
</I>&gt;<i>  4) Showing the built-in support for it.
</I>&gt;<i>
</I>&gt;<i> My first goal for this document would be a clear, concise explanation of
</I>&gt;<i> what a Deferred is and why you need it.
</I>&gt;<i>
</I>
As I said, when you understand what a Deferred is, it's not hard. The hard
part is *how* to use it. The urllib, fake library, Deferred example is all I
really want to go over about what a deferred is, because it's not hard. I
want to: untie a lot of the code samples from the reactor, explain in terms
of the two other examples that it's fundamentally the same thing, then and
go on to the techniques like errbacks, chaining callbacks, and how
separating the callback from the request allows things like
DeferredList/gatherResults.

&gt;<i> This should help clear up my writing style a bit. I think in terms of
</I>&gt;<i> separating abstraction layers; I always try separate a fact or rule
</I>&gt;<i> from logic or a technique that can follow when you can exploit that
</I>&gt;<i> fact (feel free to ask the people about 'evolution' in
</I>&gt;<i> #python-offtopic). I also try to think of the code being very linear
</I>&gt;<i> when it evolves: a new rule is added, you have a problem, you can
</I>&gt;<i> exploit that rule with a specific technique, the technique is
</I>&gt;<i> standardized.
</I>&gt;<i>
</I>&gt;<i> Example A:
</I>&gt;<i>  PROBLEM: You need to create a Deferred with a known result
</I>&gt;<i>  RULE: Callbacks will continue running after you've called &quot;callback&quot;
</I>&gt;<i> or &quot;errback&quot;
</I>&gt;<i>  TECHNIQUE: You can create a Deferred, call 'callback' on it and
</I>&gt;<i> return it, without any tricky business
</I>&gt;<i>  STANDARDIZED: twisted.internet.defer.success
</I>&gt;<i>
</I>&gt;<i> Example B:
</I>&gt;<i>  PROBLEM: You need to get the results from multiple Deferreds without
</I>&gt;<i> blocking or too much linearity
</I>&gt;<i>  RULE: More than one Deferred can be created and 'run' at the same time
</I>&gt;<i>  TECHNIQUE: You can add a callback to a Deferred, take the result you
</I>&gt;<i> get and save it in a list or dictionary
</I>&gt;<i>  STANDARDIZED: DeferredList, gatherResults
</I>&gt;<i>
</I>&gt;<i> These seem more like recipes to me than introductory documentation.  Maybe
</I>&gt;<i> they should be really close together, to try to drive the concept home, but
</I>&gt;<i> it would be good to really get it clear in the reader's mind why they *
</I>&gt;<i> fundamentally* need Deferreds, then to cover all the subtle *different* ways
</I>&gt;<i> you might need them and how you could use them.
</I>&gt;<i>
</I>
But you don't *fundamenally* *need *Deferreds at all. The new document isn't
going to convince them that they're the right thing or wrong thing, just to
show how to get along in their new home in Deferred-ville, USA. For the
recipes, they're going to be reading real-world Twisted code, they better
know what these recipes do.

And if you can think of some subtly different ways to use them other than
the generic &quot;something is happening in the future, I better be prepared for
it&quot;, I'll put it in the document and attempt to eat my hat.

&gt;<i> *snip*
</I>&gt;<i>
</I>&gt;<i> ( Also, this is a real recipe, ableit simplified and it makes really
</I>&gt;<i> easy, delicious chocolate mousse:
</I>&gt;<i> <A HREF="http://articles.latimes.com/2008/feb/13/food/la-fo-watch13recafeb13">http://articles.latimes.com/2008/feb/13/food/la-fo-watch13recafeb13</A> )
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This looks like a fantastic example.  It's comprehensible, concrete, not
</I>&gt;<i> too long, and involves a strict metaphor for a real world situation, without
</I>&gt;<i> mixing in any obscure technology.  I would be happy if the entire Deferred
</I>&gt;<i> tutorial were to be structured around it.
</I>&gt;<i>
</I>
Except it really breaks that &quot;runnable examples&quot; thing. As I said before,
recipes are a very convenient match for asynchronous code, but it's not
realistic to try to map 1:1 to the other.


&gt;<i> You could also tweak it to introduce additional concepts.  For example,
</I>&gt;<i> errbacks: &quot;If the butter burns...&quot;.
</I>&gt;<i>
</I>
If the butter burns.... what do I do? Turn off the heat, clean the pan, and
restart some more butter? What if I run out of butter? Do I need a
&quot;goToStoreToFetchButter&quot; function? Is that another tutorial I should write?

&gt;<i> Once I *knew* what a Deferred was, the other pieces started snapping into
</I>&gt;<i> place.
</I>&gt;<i>
</I>&gt;<i> So it sounds like we're in agreement here: the existing document isn't
</I>&gt;<i> clear enough about exactly what a Deferred is, it's described too formally
</I>&gt;<i> and its uses aren't clear enough before we start diving into the technical
</I>&gt;<i> specifics.  Any modification should strive to make it super clear what it is
</I>&gt;<i> and why you use it.
</I>&gt;<i>
</I>
When I started with Twisted, I used Deferreds because &quot;everything else in
Twisted uses it&quot;. I didn't really *try* to understand it too much, either.
Most of the time I used Twisted, I tried to hack it all up with
inlineCallbacks and pretend it was urllib, and then complain in #twisted
with a code snippet when it wasn't working.

Use 'localhost' URLs and have the user run a 'twistd web' command line for
&gt;<i> their server; that should be simple enough :).
</I>&gt;<i>
</I>
For static pages, is there anything fundamentally wrong with &quot;
<A HREF="http://twistedmatrix.com/documents/11.1.0/static/pi.txt">http://twistedmatrix.com/documents/11.1.0/static/pi.txt</A>&quot;, if I can do it?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20110328/07b2b17a/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="056230.html">[Twisted-Python] Deferred documentation.
</A></li>
	<LI>Next message (by thread): <A HREF="056250.html">[Twisted-Python] Deferred documentation.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56236">[ date ]</a>
              <a href="thread.html#56236">[ thread ]</a>
              <a href="subject.html#56236">[ subject ]</a>
              <a href="author.html#56236">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
