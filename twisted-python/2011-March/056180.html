<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Benchmark of Python WSGI servers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Benchmark%20of%20Python%20WSGI%20servers&In-Reply-To=%3C9A1FEA5C-609D-4071-B794-2666BF6E217E%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="056179.html">
   <LINK REL="Next"  HREF="056181.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Benchmark of Python WSGI servers</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Benchmark%20of%20Python%20WSGI%20servers&In-Reply-To=%3C9A1FEA5C-609D-4071-B794-2666BF6E217E%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Benchmark of Python WSGI servers">glyph at twistedmatrix.com
       </A><BR>
    <I>Fri Mar 18 18:54:26 MDT 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="056179.html">[Twisted-Python] Benchmark of Python WSGI servers
</A></li>
        <LI>Next message (by thread): <A HREF="056181.html">[Twisted-Python] Benchmark of Python WSGI servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56180">[ date ]</a>
              <a href="thread.html#56180">[ thread ]</a>
              <a href="subject.html#56180">[ subject ]</a>
              <a href="author.html#56180">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mar 18, 2011, at 7:44 PM, Michael Thompson wrote:

&gt;<i> From the guys who brought you async socket benchmark,
</I>&gt;<i> <A HREF="http://nichol.as/asynchronous-servers-in-python,">http://nichol.as/asynchronous-servers-in-python,</A> comes Python WSGI
</I>&gt;<i> benchmark
</I>&gt;<i> <A HREF="http://nichol.as/benchmark-of-python-web-servers.">http://nichol.as/benchmark-of-python-web-servers.</A>
</I>
Yep, I've seen that before.  It's one of the better benchmarks of its kind in the Python world, but unfortunately stops short of being good :).

The benchmark isn't really saying much that's interesting about WSGI servers anyway.  It mostly says &quot;all of these servers are more than 20x faster than your WSGI app could ever possibly be, if it does anything interesting, so at most the server will account for 5% of your performance&quot;.  The logical conclusion: regardless of what server you're using, go optimize your app first.

While I'd love for Twisted to come out on top of that chart (it's always best to win at things, right?), such an improvement would be of little practical benefit to our users.  First because almost nobody has a WSGI app that is so trivial that it would be significantly helped by speeding up that part of the server, and also the fact that anyone with serious performance requirements in Twisted will be optimizing by calling Resource and Request APIs directly, asynchronously in the main loop (perhaps with multiple processes), not threading WSGI handlers for the critical fast path in their application.  Which, I hasten to remind you, is rarely all of your application.  A performance improvement to static.File, like making it truly non-blocking, would probably be a more significant benefit to most websites that want to be fast than making the thing that calls a WSGI function fast.

&gt;<i> Is twisted coming out of this so badly because they are using the
</I>&gt;<i> default reactor, as opposed to epoll?
</I>
There isn't really enough analysis to determine why exactly Twisted fares poorly on this particular benchmark.

My pet theory is that it has something to do with transferring data from threads to the I/O loop via queue synchronization, and not being as smart as it could be about buffering, and that particular technique getting slammed really hard for very small request/response pairs.  I hypothesize that more buffering would occur with larger responses with more chunks, and that would bring Twisted's performance up to those of these other servers.

But it's hard to say, and, as I said above the benchmark isn't measuring anything too interesting, so it's hard to work up the motivation to find out.

&gt;<i> Perhaps the default reactor should be the best available rather than
</I>&gt;<i> the lowest common denominator.
</I>
See &lt;<A HREF="http://twistedmatrix.com/trac/ticket/2234">http://twistedmatrix.com/trac/ticket/2234</A>&gt;.  There should be a ticket for the broader goal too, and maybe it's already filed; I couldn't find it quickly.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="056179.html">[Twisted-Python] Benchmark of Python WSGI servers
</A></li>
	<LI>Next message (by thread): <A HREF="056181.html">[Twisted-Python] Benchmark of Python WSGI servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56180">[ date ]</a>
              <a href="thread.html#56180">[ thread ]</a>
              <a href="subject.html#56180">[ subject ]</a>
              <a href="author.html#56180">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
