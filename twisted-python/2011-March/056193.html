<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Best strategies for pb Referenceables	running	long methods from callRemote
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Best%20strategies%20for%20pb%20Referenceables%0A%09running%09long%20methods%20from%20callRemote&In-Reply-To=%3C20110319202941.2231.1173341416.divmod.xquotient.285%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="056192.html">
   <LINK REL="Next"  HREF="056154.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Best strategies for pb Referenceables	running	long methods from callRemote</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Best%20strategies%20for%20pb%20Referenceables%0A%09running%09long%20methods%20from%20callRemote&In-Reply-To=%3C20110319202941.2231.1173341416.divmod.xquotient.285%40localhost.localdomain%3E"
       TITLE="[Twisted-Python] Best strategies for pb Referenceables	running	long methods from callRemote">exarkun at twistedmatrix.com
       </A><BR>
    <I>Sat Mar 19 14:29:41 MDT 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="056192.html">[Twisted-Python] Best strategies for pb Referenceables running long methods from callRemote
</A></li>
        <LI>Next message (by thread): <A HREF="056154.html">[Twisted-Python] UDP Logging Server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56193">[ date ]</a>
              <a href="thread.html#56193">[ thread ]</a>
              <a href="subject.html#56193">[ subject ]</a>
              <a href="author.html#56193">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06:48 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">charlessolar at gmail.com</A> wrote:
&gt;<i>Ah no, I use conch to connect to the remote machines.  My conch code 
</I>&gt;<i>starts
</I>&gt;<i>a remote python instance and runs some bootstrapping python code which
</I>&gt;<i>connects to the PB Root.  Once connected I send the test code to the 
</I>&gt;<i>remote
</I>&gt;<i>process and start testing with PB.  When the PB remote method
</I>&gt;<i>(remote_execute) is called from the users machine, that starts a new 
</I>&gt;<i>thread
</I>&gt;<i>with deferToThread to run the test code.  Since tests have multiple 
</I>&gt;<i>parts
</I>&gt;<i>that need to run simultaneously, some parts are delivered to the same
</I>&gt;<i>machine, causing one machine to have to execute 5 or more parts 
</I>&gt;<i>creating
</I>&gt;<i>many twisted threads.
</I>&gt;<i>The test code does its thing which stresses a network library.  It 
</I>&gt;<i>creates
</I>&gt;<i>servers and clients and makes sure everyone gets connected and gets all
</I>&gt;<i>messages involved with the test.  It waits for all these events to 
</I>&gt;<i>happen
</I>&gt;<i>simultaneously so the twisted threads can be alive for very long 
</I>&gt;<i>periods of
</I>&gt;<i>time, and the test depends on the fact that all such threads are 
</I>&gt;<i>running and
</I>&gt;<i>not waiting in the thread pool overflow queue.
</I>&gt;<i>I am planning on switching the multiple thread, one python design to
</I>&gt;<i>multiple python, one thread, which I hope will allow all elements of 
</I>&gt;<i>the
</I>&gt;<i>test to run simultaneously easier than just simply increasing the 
</I>&gt;<i>thread
</I>&gt;<i>pool size.
</I>
Does creating servers and clients involve running child processes?  If 
so, you should be able to use reactor.spawnProcess instead of 
deferToThread and a blocking child process API.

But if it involves running arbitrary blocking Python code, then I don't 
see how you can avoid threads.  Switching to processes may help or it 
may hurt - it depends on the details of your workload (sometimes Python 
threads scale much worse than linearly making them worse than having an 
equal number of separate processes, but sometimes they're fine making 
them cheaper than processes; it all depends on what your code does).

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="056192.html">[Twisted-Python] Best strategies for pb Referenceables running long methods from callRemote
</A></li>
	<LI>Next message (by thread): <A HREF="056154.html">[Twisted-Python] UDP Logging Server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56193">[ date ]</a>
              <a href="thread.html#56193">[ thread ]</a>
              <a href="subject.html#56193">[ subject ]</a>
              <a href="author.html#56193">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
