<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Question regarding the working of twisted python	with celery
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Question%20regarding%20the%20working%20of%20twisted%20python%0A%09with%20celery&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="023612.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Question regarding the working of twisted python	with celery</H1>
    <B>Dinesh Kapoor</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Question%20regarding%20the%20working%20of%20twisted%20python%0A%09with%20celery&In-Reply-To="
       TITLE="[Twisted-Python] Question regarding the working of twisted python	with celery">dineshkapoor27 at gmail.com
       </A><BR>
    <I>Wed Mar  2 04:42:20 EST 2011</I>
    <P><UL>
        
        <LI>Next message: <A HREF="023612.html">[Twisted-Python] Question regarding the working of twisted python with celery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23611">[ date ]</a>
              <a href="thread.html#23611">[ thread ]</a>
              <a href="subject.html#23611">[ subject ]</a>
              <a href="author.html#23611">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

  I have run into a weird performance issue while working with twisted and
using celery to schedule tasks on it. Here is my setup:

1. Celery schedules a task which makes a TCP connection to a server running
FreeSwitch
2. Celery is running with concurrency = 2.
3. I have changed my code so that I call reactor.callfromthread for all
reactor based work.
4. A lot of times once I schedule the celery task, I get delays ranging from
3 - 30 seconds when I am running with Celery concurrency =2.
5. If I reduce the celery concurrency to 1, then everything works great!
6. Upon debugging it a little bit more, it seems that the selectReactor's
doSelect is where the code is getting stuck on the select().

I dont know how to get around the delay, and I dont know who is causing that
delay exactly. If there is more info that is needed then please let me know.
Everything works fine when the Celery worker process is 1, but delay starts
happening invariably when celery's worker processes &gt;=2.

Any help would be great!

Regards,
Dinesh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20110302/d9965671/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20110302/d9965671/attachment.htm</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="023612.html">[Twisted-Python] Question regarding the working of twisted python with celery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23611">[ date ]</a>
              <a href="thread.html#23611">[ thread ]</a>
              <a href="subject.html#23611">[ subject ]</a>
              <a href="author.html#23611">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
