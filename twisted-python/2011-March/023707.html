<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Best strategies for pb Referenceables running long methods from callRemote
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Best%20strategies%20for%20pb%20Referenceables%20running%0A%20long%20methods%20from%20callRemote&In-Reply-To=20110319154203.2231.178964871.divmod.xquotient.272%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023706.html">
   <LINK REL="Next"  HREF="023708.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Best strategies for pb Referenceables running long methods from callRemote</H1>
    <B>Charles Solar</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Best%20strategies%20for%20pb%20Referenceables%20running%0A%20long%20methods%20from%20callRemote&In-Reply-To=20110319154203.2231.178964871.divmod.xquotient.272%40localhost.localdomain"
       TITLE="[Twisted-Python] Best strategies for pb Referenceables running long methods from callRemote">charlessolar at gmail.com
       </A><BR>
    <I>Sat Mar 19 14:48:37 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="023706.html">[Twisted-Python] Best strategies for pb Referenceables	running	long methods from callRemote
</A></li>
        <LI>Next message: <A HREF="023708.html">[Twisted-Python] Best strategies for pb Referenceables	running	long methods from callRemote
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23707">[ date ]</a>
              <a href="thread.html#23707">[ thread ]</a>
              <a href="subject.html#23707">[ subject ]</a>
              <a href="author.html#23707">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ah no, I use conch to connect to the remote machines.  My conch code starts
a remote python instance and runs some bootstrapping python code which
connects to the PB Root.  Once connected I send the test code to the remote
process and start testing with PB.  When the PB remote method
(remote_execute) is called from the users machine, that starts a new thread
with deferToThread to run the test code.  Since tests have multiple parts
that need to run simultaneously, some parts are delivered to the same
machine, causing one machine to have to execute 5 or more parts creating
many twisted threads.
The test code does its thing which stresses a network library.  It creates
servers and clients and makes sure everyone gets connected and gets all
messages involved with the test.  It waits for all these events to happen
simultaneously so the twisted threads can be alive for very long periods of
time, and the test depends on the fact that all such threads are running and
not waiting in the thread pool overflow queue.
I am planning on switching the multiple thread, one python design to
multiple python, one thread, which I hope will allow all elements of the
test to run simultaneously easier than just simply increasing the thread
pool size.

Charles

On Sat, Mar 19, 2011 at 10:42 AM, &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>&gt; wrote:

&gt;<i> On 02:06 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">charlessolar at gmail.com</A> wrote:
</I>&gt;<i> &gt;Thanks for the reply.  I am using twisted conch to connect to the
</I>&gt;<i> &gt;remote
</I>&gt;<i> &gt;machines and start these tests, I am thinking that instead of using one
</I>&gt;<i> &gt;connection for all testing I will open a new connection (and thus a new
</I>&gt;<i> &gt;python) for each test.
</I>&gt;<i>
</I>&gt;<i> I'm not sure I follow.  In your earlier message you were talking about
</I>&gt;<i> PB and deferToThread.  How does this fit with your Conch usage?  You're
</I>&gt;<i> not using Conch in the function passed to deferToThread, are you?
</I>&gt;<i>
</I>&gt;<i> Jean-Paul
</I>&gt;<i> &gt;Like I said increasing the thread pool size worked
</I>&gt;<i> &gt;well for fast machines but no so well on older ones.  I am hoping that
</I>&gt;<i> &gt;this
</I>&gt;<i> &gt;behavior has more to do with the GIL and that 5 processes on a slow
</I>&gt;<i> &gt;machine
</I>&gt;<i> &gt;will operate better than 5 python threads.
</I>&gt;<i> &gt;If not, then I will just have to write some sort of system to make sure
</I>&gt;<i> &gt;I
</I>&gt;<i> &gt;dont open too many threads on certain remote machines.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Thanks again
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20110319/818940d8/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20110319/818940d8/attachment.htm</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023706.html">[Twisted-Python] Best strategies for pb Referenceables	running	long methods from callRemote
</A></li>
	<LI>Next message: <A HREF="023708.html">[Twisted-Python] Best strategies for pb Referenceables	running	long methods from callRemote
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23707">[ date ]</a>
              <a href="thread.html#23707">[ thread ]</a>
              <a href="subject.html#23707">[ subject ]</a>
              <a href="author.html#23707">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
