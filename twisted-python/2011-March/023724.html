<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Deferred documentation.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Deferred%20documentation.&In-Reply-To=AANLkTinemJ-Rdf1EC%2B0VDgxnvixpe5dvxCdGP5_kZA4m%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023715.html">
   <LINK REL="Next"  HREF="023727.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Deferred documentation.</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Deferred%20documentation.&In-Reply-To=AANLkTinemJ-Rdf1EC%2B0VDgxnvixpe5dvxCdGP5_kZA4m%40mail.gmail.com"
       TITLE="[Twisted-Python] Deferred documentation.">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Mar 22 22:03:06 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="023715.html">[Twisted-Python] Deferred documentation.
</A></li>
        <LI>Next message: <A HREF="023727.html">[Twisted-Python] Deferred documentation.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23724">[ date ]</a>
              <a href="thread.html#23724">[ thread ]</a>
              <a href="subject.html#23724">[ subject ]</a>
              <a href="author.html#23724">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mar 21, 2011, at 9:30 PM, Jasper St. Pierre wrote:

&gt;<i> On IRC, exarkun, glyph, spiv and idnar encouraged me to do a bit of
</I>&gt;<i> work on the Defer documentation.
</I>
Yay!  This documentation could definitely use some work.

&gt;<i> I kept get confused between the things like returning a Deferred from a callback and chainDeferred, which I found out wasn't that useful:
</I>
Yeah, chainDeferred is not a great method.  Now that Deferreds are non-recursive, I think it's purely worse than inserting an additional Deferred as a result from a callback.

&gt;<i> My eventual goal is to reduce the number of documentation about defer
</I>&gt;<i> down to a near-impossible two documents. I'm hoping to merge some of
</I>&gt;<i> the good stuff of the other thousands of documents.
</I>
That would be absolutely great.

&gt;<i> Thoughts so far?
</I>
While I applaud your intent, these drafts look quite rough.  The random interjections and asides in &lt;<A HREF="http://magcius.mecheye.net/twisted/DeferHowTo-Fixup.html">http://magcius.mecheye.net/twisted/DeferHowTo-Fixup.html</A>&gt; seem distracting and confusing to me.  Trying to put myself in the mind of a newcomer, I find myself asking many questions which are irrelevant to what I'm trying to learn:

What's &quot;async&quot;?  Why is it hard?  (The original document mentions asynchronous stuff, but in the context of full english sentences.)
Where are we going shopping?  What does shopping have to do with this?
What's gevent?  Does this have something to do with Twisted?
What's node.js?  This looks like Javascript, what does it have to do with Twisted, which I thought was in Python?

(Now I've gotten distracted and I'm reading about gevent and node.js rather than making my Twisted application work and completing the Deferred tutorial.  Epic fail.  But, if I were to continue...)

What's &quot;this pattern&quot;?  Functions?  Don't lots of programs use functions?
How do they use it?  Why is it relevant?
Why is Twisted's right hand blue?  (Forget about being a beginner: I honestly don't even get this reference.  Googling seems to suggest it has something to do with symptoms of heart disease and doesn't seem funny or relevant at all.)
Why is the first explanation of what a Deferred is referred to as &quot;technical mumbo-jumbo&quot;? Is this really complicated?  If I am not super good at programming already, should I not be reading this?
What's an &quot;operation&quot;?  Does that mean 'function' or 'method' or some other special thing?  It says &quot;most operations in Twisted return a Deferred&quot;; but I've called lots of functions in Twisted which returned other objects before reading this tutorial, or returned None.  Were those actually Deferreds?
Why do I &quot;not know where this Deferred has been&quot;?  Do Deferreds get dirty or broken somehow when I add multiple callbacks?  Should I avoid that?

The Python examples in the current Deferred Reference are mostly runnable.  The ones that aren't, should be.  The documentation should stress that you can run these examples simply, and encourage the reader to download and experiment with them, and modify them to see what happens when they do things in a different order.

Instead, the &quot;fixup&quot; changes the first example to rely on a fake library, which will raise exceptions if I try to run it, but doesn't actually explain that 'magiclib' isn't real.  This isn't a huge problem in and of itself (it is trying to demonstrate the &quot;wrong&quot; way to do things, after all) but it sets up the expectation that the rest of the examples are fake, too, and I shouldn't bother to run them.

I think the original document has plenty of issues, but these changes look like they've been written for people who already mostly understand Deferreds, but are having trouble catching some of the nuances, and need humor to diffuse their frustration and more examples to illustrate different usage patterns, rather than a fundamentally clearer or better explanation than what was offered before.  That makes sense, since based on what you've said on #twisted, that's basically the position you find yourself in :).  This document is supposed to be a tutorial though, explaining how to use Deferreds to users who really have no idea what they are (despite its unfortunate name, &quot;Deferred Reference&quot; - that should probably be changed).

One thing I think is very good about this attempted rework, though, is the explanation of the motivation for having Deferreds at all, before explaining how they work.  In the current documentation, it's very unclear why we have such an object in the first place, or what the alternatives to it are.  However, the example presented makes it seem as though you really don't need Deferreds, because the only problem with the single-callback approach is handling errors.  Another major motivation is the ability to return a Deferred through a system with several layers, changing the return value at each layer by post-processing it a bit.  (One possible example: a REST API that wants to deal with objects, and goes via a translation of [bytes from HTTP]-&gt;[JSON dicts/lists from parsing those bytes]-&gt;[domain-specific objects by converting JSON objects according to the particular API's spec].)

However, I think the need would be better illustrated with examples that can actually be run than with fake examples where we assume that the user knows how something like gevent works.  (Also: gevent doesn't actually work this way, for fetching web pages at least, so your example is wrong.  See &lt;<A HREF="http://www.gevent.org/intro.html#monkey-patching">http://www.gevent.org/intro.html#monkey-patching</A>&gt;.)

It's pretty easy to write a fake implementation of 'fetchWebPageAsync' which squirrels away the callback somewhere that the example can call it later, and explain that with some handwaving where we say &quot;and pretend that was actually some networking code fetching it&quot;.  For that matter, the reactor is introduced too early in the existing docs; we should demonstrate calling the callback synchronously, and then only later introduce a callLater.

Anyway I hope this wall of text did not discourage you - I just think you need some clearer goals for improving specific aspects of the documentation, and you should write those down first before trying to actually address them with more docs.

Thanks for your time,

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20110322/e67158fb/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20110322/e67158fb/attachment-0001.htm</A> 
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023715.html">[Twisted-Python] Deferred documentation.
</A></li>
	<LI>Next message: <A HREF="023727.html">[Twisted-Python] Deferred documentation.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23724">[ date ]</a>
              <a href="thread.html#23724">[ thread ]</a>
              <a href="subject.html#23724">[ subject ]</a>
              <a href="author.html#23724">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
