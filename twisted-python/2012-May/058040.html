<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Multiple transmissions via SMTPClient
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Multiple%20transmissions%20via%20SMTPClient&In-Reply-To=%3CCAHZAEpf8WuMa5Ur%3DB88W6EceZsKkT9pkrrE-T9NGRt5jxyEi1w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="058035.html">
   <LINK REL="Next"  HREF="058056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Multiple transmissions via SMTPClient</H1>
    <B>Jason J. W. Williams</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Multiple%20transmissions%20via%20SMTPClient&In-Reply-To=%3CCAHZAEpf8WuMa5Ur%3DB88W6EceZsKkT9pkrrE-T9NGRt5jxyEi1w%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Multiple transmissions via SMTPClient">jasonjwwilliams at gmail.com
       </A><BR>
    <I>Wed May 23 13:10:44 MDT 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="058035.html">[Twisted-Python] Synchronous calls using Twisted?
</A></li>
        <LI>Next message (by thread): <A HREF="058056.html">[Twisted-Python] Multiple transmissions via SMTPClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58040">[ date ]</a>
              <a href="thread.html#58040">[ thread ]</a>
              <a href="subject.html#58040">[ subject ]</a>
              <a href="author.html#58040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Guys,

I've been banging my head on this for a few days so I thought I'd ping
folks here. Been trying to modify twisted.mail.smtp.ESMTPClient to
allow the sending of more than one message over a single TCP
connection. I've changed the  behavior of smtpState_data() so that it
sets the next state to smtpState_from if there is another message to
send, and this seems to work unless there's an error returned by the
server. In this case the connection is still closed on the client side
after smtpState_msgSent, and I need to suppress this. The subsequent
message should still be sent on the open TCP connection error or not,
according to my needs, however I'm having a heck of time tracking down
where the disconnection is occurring.

My current code (with debugging statements) is here:
<A HREF="https://gist.github.com/2777154">https://gist.github.com/2777154</A>

Any help is greatly appreciated. This client is being used to run
functional tests.

-J


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="058035.html">[Twisted-Python] Synchronous calls using Twisted?
</A></li>
	<LI>Next message (by thread): <A HREF="058056.html">[Twisted-Python] Multiple transmissions via SMTPClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58040">[ date ]</a>
              <a href="thread.html#58040">[ thread ]</a>
              <a href="subject.html#58040">[ subject ]</a>
              <a href="author.html#58040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
