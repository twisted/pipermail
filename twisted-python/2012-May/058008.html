<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python]  (no subject)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%20%28no%20subject%29&In-Reply-To=%3C4FA2F857.6020608%40fogcreek.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="058003.html">
   <LINK REL="Next"  HREF="058009.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python]  (no subject)</H1>
    <B>Dmitriy</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%20%28no%20subject%29&In-Reply-To=%3C4FA2F857.6020608%40fogcreek.com%3E"
       TITLE="[Twisted-Python]  (no subject)">dmitriy at fogcreek.com
       </A><BR>
    <I>Thu May  3 15:27:51 MDT 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="058003.html">[Twisted-Python] (no subject)
</A></li>
        <LI>Next message (by thread): <A HREF="058009.html">[Twisted-Python] (no subject)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58008">[ date ]</a>
              <a href="thread.html#58008">[ thread ]</a>
              <a href="subject.html#58008">[ subject ]</a>
              <a href="author.html#58008">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> &gt; &gt; If anyone had a similar issue before, I'd appreciate any pointers on
 &gt; &gt; resolving or avoiding it.
 &gt; &gt;
 &gt; Actually, one thing does occur to me - are you using the IOCP reactor?
 &gt; If so, try the select() reactor, the IOCP reactor unfortunately has a
 &gt; bunch of serious bugs. I'm vaguely considering working on those as my
 &gt; next Twisted work, since they're embarrassing and IOCP is so much better
 &gt; than select() on Windows.

Hi Itamar,

The subject was supposed to be &quot;SSH with Twisted: PuTTY Fatal Error
&quot;Incoming packet was garbled on decryption&quot;.
(Shame on me, I've missed it while fighting multiple gmail accounts.)

To add more details, unfortunately, I'm already running SelectReactor with
pretty recent packages:
Twisted==12.0.0
pyasn1==0.1.2
pycrypto==2.5

After some heavy experimenting, I really think that plink is the weakest 
link:
the error happens at a random point when my server is accessed from the same
windows 7 box. There are no issues when running the client on an Ubuntu
virtual box* though; Twisted doesn't seem to be the one to blame by itself.

So, I was hoping that someone with plink+twisted experience had stumbled
on this before.

I've tried hg command line and hg's client TortoiseHG, in both cases with
either tortoiseplink.exe (based on putty 0.61) or original PuTTY's
plink 0.62; with and without compression. All combinations failing 
reliably,
though some have a slim random chance to succeed once in a while.
Success rate seems to be dependent on server load - more chances for success
when server is more busy - feels completely crazy. I'm investigating 
this route now.

&quot;Garbled packet&quot; error is pretty random and likely to occur on larg-ish
repositories starting with 5-10 Mb. Brief check of plink's source 
suggests that
this can happen if it receives an incomplete packet, but that's pretty 
much it
for isolating the issue so far.

----
That (*) above was Ubuntu client still getting the same error if 
SSHChannel.write()
would split data in multiple sendData calls when running out of space in
remoteWindowLeft. But if it is patched it to ignore remote window, it 
shows no
issues, so I'm not that much concerned with it for now.

- Dmitriy.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="058003.html">[Twisted-Python] (no subject)
</A></li>
	<LI>Next message (by thread): <A HREF="058009.html">[Twisted-Python] (no subject)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58008">[ date ]</a>
              <a href="thread.html#58008">[ thread ]</a>
              <a href="subject.html#58008">[ subject ]</a>
              <a href="author.html#58008">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
