<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Dealing with an intermittent PB server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Dealing%20with%20an%20intermittent%20PB%20server&In-Reply-To=%3C20050217014903.12282.786520818.divmod.quotient.591%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="042098.html">
   <LINK REL="Next"  HREF="042108.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Dealing with an intermittent PB server</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Dealing%20with%20an%20intermittent%20PB%20server&In-Reply-To=%3C20050217014903.12282.786520818.divmod.quotient.591%40ohm%3E"
       TITLE="[Twisted-Python] Dealing with an intermittent PB server">exarkun at divmod.com
       </A><BR>
    <I>Wed Feb 16 18:49:03 MST 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="042098.html">[Twisted-Python] Dealing with an intermittent PB server
</A></li>
        <LI>Next message (by thread): <A HREF="042108.html">[Twisted-Python] Dealing with an intermittent PB server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42100">[ date ]</a>
              <a href="thread.html#42100">[ thread ]</a>
              <a href="subject.html#42100">[ subject ]</a>
              <a href="author.html#42100">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 17 Feb 2005 01:05:22 +0000, Phil Mayers &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">p.mayers at imperial.ac.uk</A>&gt; wrote:
&gt;<i>On Wed, Feb 16, 2005 at 04:28:32AM +0000, Jp Calderone wrote:
</I>&gt;<i> &gt;On Tue, 15 Feb 2005 19:56:15 -0800, Dave Cook &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">daverz at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt;I'm rendering the results of a remote method call:
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt;     def data_tableList(self, ctx, data):
</I>&gt;<i> &gt;&gt;         ...
</I>&gt;<i> &gt;&gt;         d =   self.pbClientFactory.login(creds)
</I>&gt;<i> &gt;&gt;         d.addCallback(lambda object: object.callRemote(&quot;foo&quot;))
</I>&gt;<i> &gt;&gt;         return d
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  Always always always use errbacks.  *Especially* for Deferreds that can 
</I>&gt;<i> &gt;fail due to transient network conditions.
</I>&gt;<i> 
</I>&gt;<i> See, that depends. I ran into this just today in fact, and found that if 
</I>&gt;<i> the server has gone away, then you'll get an exception *right then*, not 
</I>&gt;<i> via the errback:
</I>&gt;<i> 
</I>&gt;<i> def do_stop(self):
</I>&gt;<i>   try:
</I>&gt;<i>     self.root.callRemote('stop', self).addCallbacks(self.stop, self.err)
</I>&gt;<i>   except pb.DeadReferenceError, re:
</I>&gt;<i>     self.stale()
</I>&gt;<i> 
</I>&gt;<i> Why, why, why why why doesn't the DeadReferenceError go down the 
</I>&gt;<i> errback? As it is, the code has to be littered with both synchronous and 
</I>&gt;<i> asynchronous error handling, which is needlessly irritating, surely?
</I>
  Yes, this is unfortunate.  Changing it will break programs that handle 
the error as it currently occurs, though.  Brian Warner has been working
on an improved version of PB for some time.  It is mostly API compatible,
and does a lot fewer irritating things of this sort.

&gt;<i> 
</I>&gt;<i> The original poster may find his problem was a DeadReferenceError that's 
</I>&gt;<i> getting silently eaten (or just not GCed right away) by the framework, 
</I>&gt;<i> as I did.
</I>
  Not quite.  Twisted doesn't silently eat failures.  But if you forget to
add an errback, it might seem that way :)  So this should just be taken as 
emphasis on my original point.

  If there _are_ framework pieces that are supposed to become responsible 
for a Deferred's error handling but aren't setting up errbacks, that's a 
bug.  If you know of any, please report them on the bug tracker.  (The Nevow
example James Knight pointed out is probably one such case.)

  Jp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="042098.html">[Twisted-Python] Dealing with an intermittent PB server
</A></li>
	<LI>Next message (by thread): <A HREF="042108.html">[Twisted-Python] Dealing with an intermittent PB server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42100">[ date ]</a>
              <a href="thread.html#42100">[ thread ]</a>
              <a href="subject.html#42100">[ subject ]</a>
              <a href="author.html#42100">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
