<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Dealing with an intermittent PB server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Dealing%20with%20an%20intermittent%20PB%20server&In-Reply-To=7a59f025050215195672e3698c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009579.html">
   <LINK REL="Next"  HREF="009581.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Dealing with an intermittent PB server</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Dealing%20with%20an%20intermittent%20PB%20server&In-Reply-To=7a59f025050215195672e3698c%40mail.gmail.com"
       TITLE="[Twisted-Python] Dealing with an intermittent PB server">exarkun at divmod.com
       </A><BR>
    <I>Tue Feb 15 23:28:32 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="009579.html">[Twisted-Python] Dealing with an intermittent PB server
</A></li>
        <LI>Next message: <A HREF="009581.html">[Twisted-Python] Dealing with an intermittent PB server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9580">[ date ]</a>
              <a href="thread.html#9580">[ thread ]</a>
              <a href="subject.html#9580">[ subject ]</a>
              <a href="author.html#9580">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 15 Feb 2005 19:56:15 -0800, Dave Cook &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">daverz at gmail.com</A>&gt; wrote:
&gt;<i>I'm rendering the results of a remote method call:
</I>&gt;<i> 
</I>&gt;<i>     def data_tableList(self, ctx, data):
</I>&gt;<i>         ...
</I>&gt;<i>         d =   self.pbClientFactory.login(creds)
</I>&gt;<i>         d.addCallback(lambda object: object.callRemote(&quot;foo&quot;))
</I>&gt;<i>         return d
</I>
  Always always always use errbacks.  *Especially* for Deferreds that can 
fail due to transient network conditions.

    def _cbLogin(self, object):
        return object.callRemote(&quot;foo&quot;)

    def _ebLogin(self, failure):
        return &quot;Sorry, couldn't log in!  (Try hitting ^R maybe)&quot;

    def _ebCallFoo(self, failure):
        return &quot;Sorry, calling foo failed! (Try hitting ^R maybe)&quot;

    def data_tableList(self, ctx, data):
        ...
        d = self.pbClientFactory.login(creds)
        d.addCallbacks(self._cbLogin, self._ebLogin)
        d.addErrback(self._ebCallFoo)
        return d

  These errbacks are lame, but they cause the page to be renderable 
(and more generally, they let the asynchronous operation come to some 
kind of logical conclusion, instead of hanging forever, waiting for 
an error handler which will never arrive).

  Better ones could automatically retry the call, or inform an 
administrator of a possible misconfiguration, or some combination, or
something even smarter.

&gt;<i> [snip]
</I>&gt;<i> but seems like a hack.  Also, ideally, I'd like to attempt a
</I>&gt;<i> reconnection to the PB server at this point if it's not running. 
</I>&gt;<i> What's the best way to do that?
</I>
    clientConnectionFailed will be called on the ClientFactory, you
should notice this and attempt to reconnect.  Whether you fail any
outstanding Deferreds which were waiting on the existing connection or
let them survive to possibly succeed over the new one is up to you.

  Jp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009579.html">[Twisted-Python] Dealing with an intermittent PB server
</A></li>
	<LI>Next message: <A HREF="009581.html">[Twisted-Python] Dealing with an intermittent PB server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9580">[ date ]</a>
              <a href="thread.html#9580">[ thread ]</a>
              <a href="subject.html#9580">[ subject ]</a>
              <a href="author.html#9580">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
