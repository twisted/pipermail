<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.enterprise.adbapi and connection pool	problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.enterprise.adbapi%20and%20connection%20pool%0A%09problem&In-Reply-To=1108459364.3270.4.camel%40lana.initd.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009571.html">
   <LINK REL="Next"  HREF="009574.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.enterprise.adbapi and connection pool	problem</H1>
    <B>James Y Knight</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.enterprise.adbapi%20and%20connection%20pool%0A%09problem&In-Reply-To=1108459364.3270.4.camel%40lana.initd.org"
       TITLE="[Twisted-Python] twisted.enterprise.adbapi and connection pool	problem">foom at fuhm.net
       </A><BR>
    <I>Tue Feb 15 10:35:31 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="009571.html">[Twisted-Python] twisted.enterprise.adbapi and connection pool	problem
</A></li>
        <LI>Next message: <A HREF="009574.html">[Twisted-Python] twisted.enterprise.adbapi and connection pool	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9572">[ date ]</a>
              <a href="thread.html#9572">[ thread ]</a>
              <a href="subject.html#9572">[ subject ]</a>
              <a href="author.html#9572">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Feb 15, 2005, at 4:22 AM, Federico Di Gregorio wrote:
&gt;<i> If the database support transactions and an exception is raised the
</I>&gt;<i> DatabasePool does a .rollback() (if I remember correctly). In this case
</I>&gt;<i> you're sure the query has not been executed (it was rolled back
</I>&gt;<i> explicitly.)
</I>
If the database server returned an exception and you can actually 
execute a rollback, the connection didn't die. :) That is not the 
situation we're talking about. It's when you send a command over the 
network, and the remote host maybe gets it, or maybe not, and then you 
unplug your net connection before you get a response. You don't know if 
the server got the command or not. However, your point stands: If 
you're in a transaction and failed anything but the commit, then you 
know the transaction was unexecuted. If you fail the commit command, 
it's harder. With certain errors you know came from the database server 
rather than the network, you can probably also know it's unexecuted, 
but in some cases it's unclear.

In contrast to my previous message, I do believe cp_reconnect will 
notice a failed connection before attempting a query on it, since it 
checks the result of db.cursor() when starting the transaction, and if 
that fails, reconnects. This is likely sufficient for most website-like 
application, where a failed query just results in the user pressing 
reload anyways.

For a more serious application, it should handle any errors sensibly, 
including those that happen at commit time, so it needs to be able to 
handle errors itself, in any case.

James



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009571.html">[Twisted-Python] twisted.enterprise.adbapi and connection pool	problem
</A></li>
	<LI>Next message: <A HREF="009574.html">[Twisted-Python] twisted.enterprise.adbapi and connection pool	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9572">[ date ]</a>
              <a href="thread.html#9572">[ thread ]</a>
              <a href="subject.html#9572">[ subject ]</a>
              <a href="author.html#9572">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
