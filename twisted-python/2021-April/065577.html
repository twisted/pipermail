<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] GitHub Actions parallelism limit increase
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20GitHub%20Actions%20parallelism%20limit%20increase&In-Reply-To=%3C21516729d8911672e8cfaa8a354596b3%40fstab.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065576.html">
   <LINK REL="Next"  HREF="065578.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] GitHub Actions parallelism limit increase</H1>
    <B>Kyle Altendorf</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20GitHub%20Actions%20parallelism%20limit%20increase&In-Reply-To=%3C21516729d8911672e8cfaa8a354596b3%40fstab.net%3E"
       TITLE="[Twisted-Python] GitHub Actions parallelism limit increase">sda at fstab.net
       </A><BR>
    <I>Thu Apr  1 06:46:54 MDT 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065576.html">[Twisted-Python] GitHub Actions parallelism limit increase
</A></li>
        <LI>Next message (by thread): <A HREF="065578.html">[Twisted-Python] GitHub Actions parallelism limit increase
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65577">[ date ]</a>
              <a href="thread.html#65577">[ thread ]</a>
              <a href="subject.html#65577">[ subject ]</a>
              <a href="author.html#65577">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2021-03-31 05:45, Adi Roiban wrote:

&gt;<i> On Tue, 30 Mar 2021, 22:23 Kyle Altendorf, &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sda at fstab.net</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> On 2021-03-30 15:24, Glyph wrote:
</I>&gt;&gt;&gt;&gt;<i> On Mar 30, 2021, at 7:57 AM, Kyle Altendorf &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sda at fstab.net</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Hi All,
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Has anyone contacted GitHub to see if they would be willing to
</I>&gt;&gt;&gt;&gt;<i> increase the parallelism limit in Actions?  My understanding is that
</I>&gt;&gt;&gt;&gt;<i> we maintain two CI systems (GitHub Actions and Azure Pipelines) for
</I>&gt;&gt;&gt;&gt;<i> the sake of more parallelism.  While perhaps worthwhile, this 
</I>&gt;&gt;&gt;&gt;<i> doesn't
</I>&gt;&gt;&gt;&gt;<i> seem fun.  Maybe GitHub would be willing to help out.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Not as far as I know. Do you want to give it a shot?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> That was the plan.  Submitted.  I'll let you all know.
</I>&gt;<i> 
</I>&gt;<i> Thanks.
</I>&gt;<i> 
</I>&gt;<i> On a related note I am working to reduce the general duration of 
</I>&gt;<i> Twisted CI jobs.
</I>&gt;<i> 
</I>&gt;<i> This should result in keeping the jobs slot busy for less time and 
</I>&gt;<i> allowing more total jobs per day.
</I>&gt;<i> 
</I>&gt;<i> The first step was to enable parallel trial tests. Use both CPUs 
</I>&gt;<i> available to the CI VMs.
</I>&gt;<i> This was already done for Linux and MacOS.
</I>&gt;<i> 
</I>&gt;<i> Distributed trial is not yet supported on Windows, but I am working on 
</I>&gt;<i> it.
</I>&gt;<i> I already have a working distributed trial for Windows on my system.
</I>&gt;<i> It needs various fixed and I have submitted smaller PR for review.
</I>&gt;<i> 
</I>&gt;<i> Just getting distrial to work on Windows is not all...as we need to 
</I>&gt;<i> update and clean the  Twsited test to reduce the side effects.
</I>&gt;<i> Linux and macOS are more relaxed in terms of file access and for 
</I>&gt;<i> example you can delete a file, even if its opened by another process or 
</I>&gt;<i> by the same process.
</I>&gt;<i> Windows is not happy about that.
</I>&gt;<i> 
</I>&gt;<i> And then there are the 2 pypy jobs taking 30 minutes each - working to 
</I>&gt;<i> fix it here <A HREF="https://github.com/twisted/twisted/pull/1543/">https://github.com/twisted/twisted/pull/1543/</A>
</I>&gt;<i> 
</I>&gt;<i> And then there are also general CI jobs improvements.
</I>&gt;<i> 
</I>&gt;<i> For example we can save about 40 seconds  if we decide to stop sending 
</I>&gt;<i> coverage to coveralls and only use codecov.io
</I>&gt;<i> Another example is save another 1 minute by stop using `tox --notests` 
</I>&gt;<i> and replace it with something like 
</I>&gt;<i> <A HREF="https://github.com/twisted/python-info-action">https://github.com/twisted/python-info-action</A> to show the dependencies.
</I>&gt;<i> With `tox --notest` we now create the wheels and install the 
</I>&gt;<i> dependencies twice for each job.
</I>
Would `tox --skip-pkg-install` cut it for the second invocation?

<A HREF="https://github.com/ericaltendorf/plotman/pull/66/files#diff-b803fcb7f17ed9235f1e5cb1fcd2f5d3b2838429d4368ae4c57ce4436577f03fR145">https://github.com/ericaltendorf/plotman/pull/66/files#diff-b803fcb7f17ed9235f1e5cb1fcd2f5d3b2838429d4368ae4c57ce4436577f03fR145</A>

&gt;<i> There is an extra 1 minute required for each job to generate the 
</I>&gt;<i> coverage XML file. We can download all the coverage artifacts and 
</I>&gt;<i> generate the XML only once.
</I>
I did coverage collection from all jobs for pymodbus.  Looks like I 
still had the XML report generating in each job, but that could 
presumably be shifted.  Anyways, I'm sure several of us could do this 
off the top of our heads but in case it is of any interest here's what I 
did.  Or maybe you just point out something silly I did there and should 
learn from.  :]

<A HREF="https://github.com/riptideio/pymodbus/pull/592/files">https://github.com/riptideio/pymodbus/pull/592/files</A>

Cheers,
-kyle

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065576.html">[Twisted-Python] GitHub Actions parallelism limit increase
</A></li>
	<LI>Next message (by thread): <A HREF="065578.html">[Twisted-Python] GitHub Actions parallelism limit increase
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65577">[ date ]</a>
              <a href="thread.html#65577">[ thread ]</a>
              <a href="subject.html#65577">[ subject ]</a>
              <a href="author.html#65577">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
