<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Bug in Finger Tutorial?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Bug%20in%20Finger%20Tutorial%3F&In-Reply-To=CAG4NAK5sHvGcUzdiE%2BWytBnhYC3pPBBuJ4hFLc%3DLAd-F1LOULA%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024587.html">
   <LINK REL="Next"  HREF="024591.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Bug in Finger Tutorial?</H1>
    <B>Dorian Raymer</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Bug%20in%20Finger%20Tutorial%3F&In-Reply-To=CAG4NAK5sHvGcUzdiE%2BWytBnhYC3pPBBuJ4hFLc%3DLAd-F1LOULA%40mail.gmail.com"
       TITLE="[Twisted-Python] Bug in Finger Tutorial?">deldotdr at gmail.com
       </A><BR>
    <I>Thu Sep 29 18:10:03 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="024587.html">[Twisted-Python] Bug in Finger Tutorial?
</A></li>
        <LI>Next message: <A HREF="024591.html">[Twisted-Python] Bug in Finger Tutorial?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24589">[ date ]</a>
              <a href="thread.html#24589">[ thread ]</a>
              <a href="subject.html#24589">[ subject ]</a>
              <a href="author.html#24589">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Sep 29, 2011 at 2:44 PM, David Kao &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">a.libran at gmail.com</A>&gt; wrote:

&gt;<i> I'll take care of the first question.
</I>&gt;<i>
</I>&gt;<i> From The Evolution of Finger: making a finger library,
</I>&gt;<i>
</I>&gt;<i> h = internet.TCPServer(79, IFingerFactory(f))
</I>&gt;<i>
</I>&gt;<i> notice IFingerFactory? If you read the earlier parts of the tutorial,
</I>&gt;<i> you'll see stuff like components.registerAdapter. It's just magic to
</I>&gt;<i> create a FingerFactoryFromService, giving its constructor f, the
</I>&gt;<i> &quot;Finger Service&quot;. What happens here is that &quot;f&quot;, the Finger Service,
</I>&gt;<i> is different from the service.Service within the Twisted Framework.
</I>&gt;<i>
</I>
The FingerService inherits service.Service and implements the
startServiceevent, so it *is* a service that can be run by the service
framework; it
just isn't one of the twisted.application.internet services, like
internet.TCPServer.
Moreover, it needs to have startService called, somehow... and what I'm
saying is that in the full example (provided in
 twisted/doc/core/howto/tutorial/listings/finger/finger/finger.py) it is not
called, and if you actually try using it, it doesn't work.


You might as well call &quot;f&quot;, the Finger Service, &quot;Finger Shared Data&quot;.
&gt;<i>
</I>&gt;<i> What really happens here is
</I>&gt;<i>
</I>&gt;<i> h is the service that has parent s, MultiService. s is then returned
</I>&gt;<i> and started by the application.
</I>&gt;<i>
</I>&gt;<i> h contains a factory that gets run.
</I>&gt;<i>
</I>&gt;<i> The factory knows &quot;f&quot;, the Finger Service, which has nothing to do
</I>&gt;<i> with twisted's mechanism. It's more of a demo for the component based
</I>&gt;<i> framework. f is a way to share data and methods and states across
</I>&gt;<i> multiple factories.
</I>&gt;<i>
</I>&gt;<i> I am also very new to twisted, so I **hope** this understanding of
</I>&gt;<i> mine is correct ...
</I>&gt;<i>
</I>&gt;<i> I strongly recommend you read through the entire tutorial. They build
</I>&gt;<i> very incrementally, so most of the time the code is repeated so you
</I>&gt;<i> can just skim through it if you had started from the beginning.
</I>&gt;<i>
</I>
I've read it many times over the years ;) It's surprisingly complete as an
example...you just don't know that in the beginning.

The topic area of this question is something I'm trying to squeeze out of
this tutorial series; I'm encountering conceptual questions beyond the
mechanics of how the framework works (which the tutorial does a great job of
explaining) like:
should I ever make a tree of dependent services?
What if I do something in a startService method that I want to make sure
works before other services get their startService called?
If I create a bunch of business services (that just provide pure
functionality) that I then adapt for deployment in different t.a.internet
services, should I put the business services in their own MultiService and
the internet services in their own MutiService container?

Like I said, more showcasing of use cases would help suggest answers to
these kind of questions. I see a lot of possibilities, but haven't put in
the time in the trenches to try them all out ;)

Thanks,
-Dorian



&gt;<i> David Kao
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, Sep 30, 2011 at 5:28 AM, Dorian Raymer &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">deldotdr at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hello,
</I>&gt;<i> &gt; I am confused about how the FingerService gets started in the
</I>&gt;<i> &gt; finger/finger.py makeService function. It is never assigned a service
</I>&gt;<i> parent
</I>&gt;<i> &gt; and it can't service getUser requests if its startService method isn't
</I>&gt;<i> &gt; called; you get an AttributeError: &quot;no attribute 'users'&quot; the way it
</I>&gt;<i> works
</I>&gt;<i> &gt; now. Is this a bug?
</I>&gt;<i> &gt; The most sensible thing, in this case, seems to be setting the
</I>&gt;<i> FingerService
</I>&gt;<i> &gt; parent to be the MultiService container that all of the interent services
</I>&gt;<i> &gt; are added to in the makeService function. Is that correct?
</I>&gt;<i> &gt; I'm wondering if their are any other strategies people use for starting
</I>&gt;<i> &gt; non-internet services.
</I>&gt;<i> &gt; For instance, if instead of reading a file to get to my user db, I might
</I>&gt;<i> &gt; want to start a redis client and read from redis to service a getUser
</I>&gt;<i> call.
</I>&gt;<i> &gt; But that means I'd want to make sure the startService call succeeded (the
</I>&gt;<i> &gt; redis connection was made) before one of the internet services tries to
</I>&gt;<i> use
</I>&gt;<i> &gt; the FingerService (a timing problem that doesn't exist when just reading
</I>&gt;<i> a
</I>&gt;<i> &gt; file)...or something. Maybe I'm really just wondering how the twisted
</I>&gt;<i> &gt; application framework handles exceptions that occur for startService
</I>&gt;<i> calls.
</I>&gt;<i> &gt; Maybe I need something else to handle that kind of thing?
</I>&gt;<i> &gt; I'm also wondering if it's ever a good idea to make a extension
</I>&gt;<i> &gt; of ServerFactory (that adapts a Service) that calls Service.startService
</I>&gt;<i> &gt; when Factory.startServer is called (and Service.stopService when
</I>&gt;<i> &gt; Factory.stopFactory is called)?
</I>&gt;<i> &gt; And I'm looking for more use cases/projects (beyond the finger tutorial)
</I>&gt;<i> &gt; that really showcase the twisted application framework. Any references
</I>&gt;<i> would
</I>&gt;<i> &gt; be appreciated!
</I>&gt;<i> &gt; Thanks!
</I>&gt;<i> &gt; -Dorian
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Twisted-Python mailing list
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20110929/3313469e/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20110929/3313469e/attachment-0001.htm</A> 
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024587.html">[Twisted-Python] Bug in Finger Tutorial?
</A></li>
	<LI>Next message: <A HREF="024591.html">[Twisted-Python] Bug in Finger Tutorial?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24589">[ date ]</a>
              <a href="thread.html#24589">[ thread ]</a>
              <a href="subject.html#24589">[ subject ]</a>
              <a href="author.html#24589">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
