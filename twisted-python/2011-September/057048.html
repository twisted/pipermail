<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Running the same trial test suite against a live server and a mock server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Running%20the%20same%20trial%20test%20suite%20against%20a%0A%20live%20server%20and%20a%20mock%20server&In-Reply-To=%3C20110926232930.GD26665%40boombah.thristian.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="057047.html">
   <LINK REL="Next"  HREF="057045.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Running the same trial test suite against a live server and a mock server</H1>
    <B>Tim Allen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Running%20the%20same%20trial%20test%20suite%20against%20a%0A%20live%20server%20and%20a%20mock%20server&In-Reply-To=%3C20110926232930.GD26665%40boombah.thristian.org%3E"
       TITLE="[Twisted-Python] Running the same trial test suite against a live server and a mock server">screwtape at froup.com
       </A><BR>
    <I>Mon Sep 26 17:29:30 MDT 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="057047.html">[Twisted-Python] Running the same trial test suite against a	live server and a mock server
</A></li>
        <LI>Next message (by thread): <A HREF="057045.html">[Twisted-Python] [Twisted] #5272: In the core doc, do not call reactor.stop directly in processEnded
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57048">[ date ]</a>
              <a href="thread.html#57048">[ thread ]</a>
              <a href="subject.html#57048">[ subject ]</a>
              <a href="author.html#57048">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Sep 26, 2011 at 01:37:16PM +0200, Laurens Van Houtven wrote:
&gt;<i> The obvious solution is to have a makeClient function defined in module
</I>&gt;<i> scope for the given test module. I could then have a bin/liveTest.py that
</I>&gt;<i> takes a username, password and cert, and monkeypatches that module. I'm
</I>&gt;<i> assuming it can't be hard to tell trial to just take a test module and run
</I>&gt;<i> it...
</I>&gt;<i> 
</I>&gt;<i> Are there any better ways to pass test data to trial?
</I>
If you have a particular set of tests you want to run against a mock
server and a real server, I'd be highly tempted to use inheritance:


    class ServerTestMixin:

	def _get_server_details(self):
	    raise NotImplementedError

	def test_foo(self):
	    server = self._get_server_details()
	    ...
	

    class MockServerTest(ServerTestMixin, unittest.TestCase):

	def setUp(self):
	    # start mock server
	
	def tearDown(self):
	    # shutdown mock server.

	def _get_server_details(self):
	    return MOCK_SERVER_DETAILS

    
    class LiveServerTest(ServerTestMixin, unittest.TestCase):

	def _get_server_details(self):
	    return LIVE_SERVER_DETAILS


The other trick I've used in a similar situation is to define
ServerTestMixin and MockServerTest in a module matching &quot;test_*.py&quot; so
that Trial will find it by default, and define LiveServerTest in
a module like &quot;integration_tests.py&quot; that won't be automatically run.

That way, you can test your code with trial and random fluctuations in
the live server won't cause spurious test failures, but you can pretty
easily run your tests against the live server whenever you want. If
you're using continuous integration, you could have a script that fails
if the unit tests break, but just warns if the integration tests break,
etc.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="057047.html">[Twisted-Python] Running the same trial test suite against a	live server and a mock server
</A></li>
	<LI>Next message (by thread): <A HREF="057045.html">[Twisted-Python] [Twisted] #5272: In the core doc, do not call reactor.stop directly in processEnded
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57048">[ date ]</a>
              <a href="thread.html#57048">[ thread ]</a>
              <a href="subject.html#57048">[ subject ]</a>
              <a href="author.html#57048">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
