<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] &quot;twistd&quot; in Twisted 16.4.0 can't import modules/packages from current working directory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%22twistd%22%20in%20Twisted%2016.4.0%20can%27t%20import%0A%20modules/packages%20from%20current%20working%20directory&In-Reply-To=%3CD47EB0F0-B4A5-4D3B-93BC-F2A9CE434C27%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031021.html">
   <LINK REL="Next"  HREF="031026.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] &quot;twistd&quot; in Twisted 16.4.0 can't import modules/packages from current working directory</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%22twistd%22%20in%20Twisted%2016.4.0%20can%27t%20import%0A%20modules/packages%20from%20current%20working%20directory&In-Reply-To=%3CD47EB0F0-B4A5-4D3B-93BC-F2A9CE434C27%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] &quot;twistd&quot; in Twisted 16.4.0 can't import modules/packages from current working directory">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Jan  3 13:20:04 MST 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="031021.html">[Twisted-Python] &quot;twistd&quot; in Twisted 16.4.0 can't import modules/packages from current working directory
</A></li>
        <LI>Next message: <A HREF="031026.html">[Twisted-Python] &quot;twistd&quot; in Twisted 16.4.0 can't import modules/packages from current working directory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31025">[ date ]</a>
              <a href="thread.html#31025">[ thread ]</a>
              <a href="subject.html#31025">[ subject ]</a>
              <a href="author.html#31025">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Jan 2, 2017, at 6:10 AM, Jean-Paul Calderone &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> On Thu, Sep 1, 2016 at 11:36 AM, Amber &quot;Hawkie&quot; Brown &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">hawkowl at atleastfornow.net</A> &lt;mailto:<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">hawkowl at atleastfornow.net</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; On 1 Sep 2016, at 21:42, Yuri &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">yuri_abzyanov at fastmail.fm</A> &lt;mailto:<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">yuri_abzyanov at fastmail.fm</A>&gt;&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hi all
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I couldn't find Twisted-specific group, so posting here.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Recently Twisted 16.4.0 got released. Yesterday I've tried to upgrade it for my apps and got an error.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The errors comes down to this: twistd script does not add current working directory to python path (or removes it, I don't know what exactly happens), so it fails to import any packages/modules from it. The issue does not appear in previous version (Twisted 16.3.2).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any ideas what caused it?
</I>&gt;<i> 
</I>&gt;<i> Yes -- we moved to using setuptools console scripts, and these console scripts don't add &quot;.&quot; to the PYTHONPATH. We realised this in prerelease but decided against fixing it, as it adding the current working dir to the PATH has lead to a lot of  subtle bugs in the past and this is a good chance to make a break from them.
</I>&gt;<i> 
</I>&gt;<i> So, in short, this is expected behaviour -- we generally want people to be running twistd, trial, etc on *installed* Python packages -- testing or running from checkouts often hides many bugs about what is or isn't included in the installed package by accident. If you rely on this behaviour, though, set the PYTHONPATH environment variable to &quot;.&quot; -- e.g. `env PYTHONPATH=. twistd -n myplugin`.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> FWIW, as a user, it would have been nice to have a NEWS entry for this.  It would have been easier to discover there than searching through the mail archives.
</I>
Yes, there definitely should have been.  We only realized the implications of the change after the fact, and only after some discussion decided that it was in fact desirable and should not be rolled back in a patch release.

We don't have a process for fixing NEWS files right now, and given that releases are immutable, I wonder if there's any way we could.  So, in the rare case that we mess up this way in the future, what (aside from the mailing list) would be a good communication mechanism to users?

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20170103/e24dad14/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20170103/e24dad14/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031021.html">[Twisted-Python] &quot;twistd&quot; in Twisted 16.4.0 can't import modules/packages from current working directory
</A></li>
	<LI>Next message: <A HREF="031026.html">[Twisted-Python] &quot;twistd&quot; in Twisted 16.4.0 can't import modules/packages from current working directory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31025">[ date ]</a>
              <a href="thread.html#31025">[ thread ]</a>
              <a href="subject.html#31025">[ subject ]</a>
              <a href="author.html#31025">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
