<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] web client FileBodyProducer - transfer encoding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20web%20client%20FileBodyProducer%20-%20transfer%20encoding&In-Reply-To=%3CCAEeXt4NrJGxZE6m%3DxAUaG29pvxZNZjaUCdQvbOHt7DDo__NYrw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031134.html">
   <LINK REL="Next"  HREF="031136.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] web client FileBodyProducer - transfer encoding</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20web%20client%20FileBodyProducer%20-%20transfer%20encoding&In-Reply-To=%3CCAEeXt4NrJGxZE6m%3DxAUaG29pvxZNZjaUCdQvbOHt7DDo__NYrw%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] web client FileBodyProducer - transfer encoding">exarkun at twistedmatrix.com
       </A><BR>
    <I>Mon Jan 30 17:59:33 MST 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="031134.html">[Twisted-Python] web client FileBodyProducer - transfer encoding
</A></li>
        <LI>Next message: <A HREF="031136.html">[Twisted-Python] web client FileBodyProducer - transfer encoding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31135">[ date ]</a>
              <a href="thread.html#31135">[ thread ]</a>
              <a href="subject.html#31135">[ subject ]</a>
              <a href="author.html#31135">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Jan 30, 2017 at 7:44 PM, Glyph Lefkowitz &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt;
wrote:

&gt;<i> Gotcha.  I guess what I meant was that you shouldn't care about this at
</I>&gt;<i> the application level, but you're talking about an operational concern, not
</I>&gt;<i> an application-level concern.
</I>&gt;<i>
</I>&gt;<i> Perhaps this should be a tunable on Agent somehow.  Can you file a ticket?
</I>&gt;<i>
</I>

Well... It *is* sort of tuneable, as you implied earlier.

If you pass an IBodyProducer with a non-None length, Agent will send a
Content-Length header - not use chunked Transfer-Encoding.
FileBodyProducer doesn't know how to determine the length of a StringIO, so
you get chunked with this example.  If you write the JSON to a regular file
and FileBodyProducer(open(the file)) you'll get a Content-Length request.
You could also write a new (trivial) IBodyProducer that does know how to
compute the length of a StringIO.

The documentation doesn't exactly spell this out - but the only reason
`length` is part of the interface is to be able to generate the
Content-Length header.

What would the ticket be?  Expanded documentation to make this behavior
into an explicit guarantee of the interface?  A new toggle somewhere to
force Agent.request into one mode or the other (regardless of the
performance consequences)?

And that stuff you said about proxies before was true ... So even if you
can control this in Agent, you're still not *guaranteed* the server will
see what you send.

Jean-Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20170130/e1cd4566/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20170130/e1cd4566/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031134.html">[Twisted-Python] web client FileBodyProducer - transfer encoding
</A></li>
	<LI>Next message: <A HREF="031136.html">[Twisted-Python] web client FileBodyProducer - transfer encoding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31135">[ date ]</a>
              <a href="thread.html#31135">[ thread ]</a>
              <a href="subject.html#31135">[ subject ]</a>
              <a href="author.html#31135">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
