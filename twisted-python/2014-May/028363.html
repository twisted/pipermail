<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] IOpenSSLClientConnectionCreator was ContextFactory, now it's IOpenSSLClientConnectionCreator not ContextFactory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20IOpenSSLClientConnectionCreator%20was%20ContextFactory%2C%0A%20now%20it%27s%20IOpenSSLClientConnectionCreator%20not%20ContextFactory&In-Reply-To=%3C20140519182414.5287.1008274228.divmod.xquotient.40%40top%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="060825.html">
   <LINK REL="Next"  HREF="060827.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] IOpenSSLClientConnectionCreator was ContextFactory, now it's IOpenSSLClientConnectionCreator not ContextFactory</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20IOpenSSLClientConnectionCreator%20was%20ContextFactory%2C%0A%20now%20it%27s%20IOpenSSLClientConnectionCreator%20not%20ContextFactory&In-Reply-To=%3C20140519182414.5287.1008274228.divmod.xquotient.40%40top%3E"
       TITLE="[Twisted-Python] IOpenSSLClientConnectionCreator was ContextFactory, now it's IOpenSSLClientConnectionCreator not ContextFactory">exarkun at twistedmatrix.com
       </A><BR>
    <I>Mon May 19 12:24:14 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="060825.html">[Twisted-Python] Why would someone need SSHTransportAddress?
</A></li>
        <LI>Next message (by thread): <A HREF="060827.html">[Twisted-Python] IOpenSSLClientConnectionCreator was	ContextFactory,	now it's IOpenSSLClientConnectionCreator not ContextFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28363">[ date ]</a>
              <a href="thread.html#28363">[ thread ]</a>
              <a href="subject.html#28363">[ subject ]</a>
              <a href="author.html#28363">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I just noticed that #7098 expanded the meaning of the objects Twisted 
typically refers to as &quot;context factories&quot;.

Prior to #7098, these were things that implemented a `getContext` method 
that returned an `OpenSSL.SSL.Context` instance.

Subsequent to #7098, these are now *either* that or an object that 
provides `IOpenSSLClientConnectionCreator`.

It seems that parts of Twisted itself were updated to reflect this 
change.  For example, the very bottom of the TLS implementation stack in 
Twisted, `twisted.protocols.tls`, acknowledges this change (I imagine 
this was unavoidable).  Also, way on the other side of Twisted, 
`twisted.web.client.Agent` takes advantage of this change to implement 
the great new certificate and hostname validation features introduced in 
14.0.0.

However, other parts of Twisted itself were not updated.  For example, 
the layers that sit in between `twisted.protocols.tls` and 
`twisted.web.client.Agent` weren't touched much.  `SSL4ClientEndpoint`, 
for example, still documents its `sslContextFactory` as &quot;SSL 
Configuration information as an instance of 
L{twisted.internet.ssl.ContextFactory}.&quot;.  And, somewhat insanely I 
think, `IReactorSSL.connectSSL` still says &quot;@param contextFactory: a 
L{twisted.internet.ssl.ClientContextFactory} object.&quot;.

Merely from a documentation standpoint, this seems suboptimal.  From a 
compatibility standpoint...  Well, it seems incompatible to me.  Perhaps 
this is an instance where the compatibility policy can be broken (though 
really that's academic since 14.0.0 has already been released, the 
policy has been broken already) but I don't recall any explicit 
discussion about a decision to do this.

I *hope* and suspect there won't be much fall-out from this change 
considering it's hard to implement TLS and as far as I know there are no 
third-party implementations of `IReactorSSL` (GNUTLS came to mind but 
they have their own incompatible interface afaict).  In other words, 
maybe we'll get lucky this time.

I wrote this email instead of filing tickets about the documentation 
problems because doing the latter was implicit acknowledgement that this 
incompatible change is okay.  Having written the email now, I see 
there's probably no going back, regardless.  Maybe we can learn 
something from this incident and avoid repeating it with a more popular 
interface, though.

We could probably add a description of this particular kind of 
incompatible change to the `CompatibilityPolicy` wiki page.  If 
reviewers read that page, then they'll know to watch out for it.

And of course (assuming we're committed to this direction, which we seem 
to be) we need to fix the rest of the &quot;contextFactory&quot; documentation 
throughout Twisted.  I'll go file one ticket related to that now...

Jean-Paul

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="060825.html">[Twisted-Python] Why would someone need SSHTransportAddress?
</A></li>
	<LI>Next message (by thread): <A HREF="060827.html">[Twisted-Python] IOpenSSLClientConnectionCreator was	ContextFactory,	now it's IOpenSSLClientConnectionCreator not ContextFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28363">[ date ]</a>
              <a href="thread.html#28363">[ thread ]</a>
              <a href="subject.html#28363">[ subject ]</a>
              <a href="author.html#28363">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
