<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Importing reactor changes PATHs?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Importing%20reactor%20changes%20PATHs%3F&In-Reply-To=%3C53834F02.6030209%40contact.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028379.html">
   <LINK REL="Next"  HREF="028386.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Importing reactor changes PATHs?</H1>
    <B>Michael Schlenker</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Importing%20reactor%20changes%20PATHs%3F&In-Reply-To=%3C53834F02.6030209%40contact.de%3E"
       TITLE="[Twisted-Python] Importing reactor changes PATHs?">msc at contact.de
       </A><BR>
    <I>Mon May 26 08:26:10 MDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="028379.html">[Twisted-Python] Importing reactor changes PATHs?
</A></li>
        <LI>Next message: <A HREF="028386.html">[Twisted-Python] Twisted.email.smtp Module ERROR
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28380">[ date ]</a>
              <a href="thread.html#28380">[ thread ]</a>
              <a href="subject.html#28380">[ subject ]</a>
              <a href="author.html#28380">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am 26.05.2014 16:12, schrieb Merovingian:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> Python 2.7.5 32 bit on Windows.
</I>&gt;<i> Twisted 13.2.0
</I>&gt;<i> 
</I>&gt;<i>     import ctypes
</I>&gt;<i>     dll = ctypes.CDLL(&quot;ssleay32.dll&quot;)
</I>&gt;<i> 
</I>&gt;<i> Loads dll from the current folder
</I>&gt;<i> 
</I>&gt;<i>     import ctypes
</I>&gt;<i>     from twisted.internet import reactor
</I>&gt;<i>     dll = ctypes.CDLL(&quot;ssleay32.dll&quot;)
</I>&gt;<i> 
</I>&gt;<i> Loads dll from Python27\lib\site-packages\OpenSSL
</I>&gt;<i> How so? How can I prevent reactor from changing the PATH (or whatever
</I>&gt;<i> it's changing)?
</I>
It might not be PATH.

There are a ton of options, e.g. the Manifest in use, Application
configuration files, registry settings or code used in Python to change
the ActivationContext when loading things.

In addition, you might already have loaded the 'ssleay32.dll' in the
reactor call, so the second call doesn't really load it anymore.

In fact, 'twisted.internet import reactor' does just that, it loads its
own copy of 'ssleay32.dll', and as your ctypes call does not specifiy an
absolute path or sets up any activation context, you get the already
loaded DLL.

Michael

-- 
Michael Schlenker
Software Architect

CONTACT Software GmbH           Tel.:   +49 (421) 20153-80
Wiener Stra&#223;e 1-3               Fax:    +49 (421) 20153-41
28359 Bremen
<A HREF="http://www.contact.de/">http://www.contact.de/</A>          E-Mail: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">msc at contact.de</A>

Sitz der Gesellschaft: Bremen
Gesch&#228;ftsf&#252;hrer: Karl Heinz Zachries, Ralf Holtgrefe
Eingetragen im Handelsregister des Amtsgerichts Bremen unter HRB 13215

</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028379.html">[Twisted-Python] Importing reactor changes PATHs?
</A></li>
	<LI>Next message: <A HREF="028386.html">[Twisted-Python] Twisted.email.smtp Module ERROR
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28380">[ date ]</a>
              <a href="thread.html#28380">[ thread ]</a>
              <a href="subject.html#28380">[ subject ]</a>
              <a href="author.html#28380">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
