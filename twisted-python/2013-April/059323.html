<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Multiple clients and ports
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Multiple%20clients%20and%20ports&In-Reply-To=%3CCAEhw%3DE8Z%3DhWOmjtfwoW7gP8uzjmhz0WipZooxo34-%2Bf%2B-ZdFBg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059322.html">
   <LINK REL="Next"  HREF="059324.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Multiple clients and ports</H1>
    <B>Carlos Eduardo Sotelo Pinto</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Multiple%20clients%20and%20ports&In-Reply-To=%3CCAEhw%3DE8Z%3DhWOmjtfwoW7gP8uzjmhz0WipZooxo34-%2Bf%2B-ZdFBg%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Multiple clients and ports">carlos.sotelo.pinto at gmail.com
       </A><BR>
    <I>Fri Apr 19 05:35:44 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059322.html">[Twisted-Python] Multiple clients and ports
</A></li>
        <LI>Next message (by thread): <A HREF="059324.html">[Twisted-Python] Multiple clients and ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59323">[ date ]</a>
              <a href="thread.html#59323">[ thread ]</a>
              <a href="subject.html#59323">[ subject ]</a>
              <a href="author.html#59323">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Phil

I am glad on your fast answer

2013/4/19 Phil Mayers &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">p.mayers at imperial.ac.uk</A>&gt;:
&gt;<i> On 04/19/2013 01:33 AM, Carlos Eduardo Sotelo Pinto wrote:
</I>&gt;&gt;<i> I am doing a gps tracker wich use multiple protocols and multiple
</I>&gt;&gt;<i> clients, my problen is when I have more than one client on more than
</I>&gt;&gt;<i> one protocol at the same time, data and validation start to crashing
</I>&gt;&gt;<i> one to other
</I>
I am receiving data from gps that must be validated and keep each
connectoin independent, for exmaple

I am working with different datagram protocolos form gps, a protocol
is a kind of parsing, for exmaple one gps send a login datagram, that
on hex  could be something like

datagram 70700112345678 as first for start a comunication where 7070
and 01 is the comman that says the datagram is trying to start a
comunicacion, 12345678 is the imei or device id
datagram 707002123456780f0f0f0f0f..... is the location datagram just
the comand changee that sais that it is a location datagram and then
the location info start, it is working on 5050 port

I have other device
datagram 20200187654321 as first for start a comunication where 2020
and 01 is the comman that says the datagram is trying to start a
comunicacion, 87654321 is the imei or device id
datagram 3030020f0f0f0f0f..... is the location datagram, the header
changed and no imei is provided, it is working on port 4040

I must do that the devies start comunication after login and the parse
info, also validate headers, command and others

as both are working at the same time, when arrive the first one with
header 7070, the class wich decode this device, keep on memory and
when the second one arrive, the validation will be wrong, cause will
try to validate the header 7070 with the values 2020, and on the
seconds one devie, could start checking datagram , s no imei, with the
first one ime

I have seen it on my program, however they are different parser clases
on diferent protocols, i need to keep each device complete independent

when I have more decvice the problem is bigger on the crashes, how
could I avoid that on keeping infor independent asyncronus is ok or
cred, I dont know

Best regards




&gt;<i>
</I>&gt;<i> I don't understand what you mean. Can you be more specific?
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      def __init__(self, decoder):
</I>&gt;&gt;<i>          &quot;&quot;&quot;Class Constructor.&quot;&quot;&quot;
</I>&gt;&gt;<i>          decoderModule = __import__('listener.protocols.%sDecoder' %
</I>&gt;&gt;<i> (decoder, ), fromlist=['%sDecoder' % (decoder, )])
</I>&gt;&gt;<i>          decoderClass = getattr(decoderModule, '%sDecoder' % (decoder, ))
</I>&gt;<i>
</I>&gt;<i> You might want to look at &quot;twisted.python.reflect&quot; which contains utils
</I>&gt;<i> to do that kind of &quot;give me the python object at this import&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>      def dataReceived(self, data):
</I>&gt;&gt;<i>          Protocol.dataReceived(self, data)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>          &quot;&quot;&quot;DataReceived Twisted event.&quot;&quot;&quot;
</I>&gt;&gt;<i>          try:
</I>&gt;&gt;<i>              self.sendResponse(self.decoder.processDatagram(data))
</I>&gt;<i>
</I>&gt;<i> Not sure if this is your problem - but stream protocols (TCP) don't
</I>&gt;<i> guarantee that &quot;message&quot; boundaries will be preserved - that is, if the
</I>&gt;<i> sender does:
</I>&gt;<i>
</I>&gt;<i> write(100 bytes)
</I>&gt;<i> write(100 bytes)
</I>&gt;<i>
</I>&gt;<i> ...you might get
</I>&gt;<i>
</I>&gt;<i> dataReceived(10 bytes)
</I>&gt;<i> dataReceived(39 bytes)
</I>&gt;<i> dataReceived(27 bytes)
</I>&gt;<i>
</I>&gt;<i> ...or any other variation - the data can arrive in arbitrary chunks.
</I>&gt;<i> Unless your processDatagram is doing the reassembly, you need to
</I>&gt;<i> implement message framing in your dataReceived method.
</I>&gt;<i>
</I>&gt;<i> Note that the commented out versions of your base classes were all for
</I>&gt;<i> protocols which do framing (e.g. line-based, etc.)
</I>&gt;<i>
</I>&gt;<i> Normally this looks something like:
</I>&gt;<i>
</I>&gt;<i>   def dataReceived(self, data):
</I>&gt;<i>      self.buffer += data
</I>&gt;<i>      if hasFullMessage(self.buffer):
</I>&gt;<i>        msg, self.buffer = extractMessage(self.buffer)
</I>&gt;<i>        processMsg(msg)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>


--
Carlos Eduardo Sotelo Pinto | <A HREF="http://carlossotelo.com">http://carlossotelo.com</A> | <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">csotelo at twitter</A>
    GNU Linux Admin | PHP Senior Web Developer
    Mobil: RPC (Claro)+51, 958194614 | Mov: +51, 959980794
    GTalk: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">carlos.sotelo.pinto at gmail.com</A> | Skype: csotelop
    MSN: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">carlos.sotelo.pinto at gmail.com</A> | Yahoo: csotelop
    GNULinux RU #379182 | GNULinux RM #277661
GPG FP:697E FAB8 8E83 1D60 BBFB 2264 9E3D 5761 F855 4F6B


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059322.html">[Twisted-Python] Multiple clients and ports
</A></li>
	<LI>Next message (by thread): <A HREF="059324.html">[Twisted-Python] Multiple clients and ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59323">[ date ]</a>
              <a href="thread.html#59323">[ thread ]</a>
              <a href="subject.html#59323">[ subject ]</a>
              <a href="author.html#59323">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
