<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Speed of twisted on Amazon EC2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Speed%20of%20twisted%20on%20Amazon%20EC2&In-Reply-To=634914A010D0B943A035D226786325D44229D49B0E%40EXVMBX020-12.exch020.serverdata.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026885.html">
   <LINK REL="Next"  HREF="026884.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Speed of twisted on Amazon EC2</H1>
    <B>Tom van Neerijnen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Speed%20of%20twisted%20on%20Amazon%20EC2&In-Reply-To=634914A010D0B943A035D226786325D44229D49B0E%40EXVMBX020-12.exch020.serverdata.net"
       TITLE="[Twisted-Python] Speed of twisted on Amazon EC2">twisted at tomvn.com
       </A><BR>
    <I>Wed Apr 24 05:59:39 EDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026885.html">[Twisted-Python] Speed of twisted on Amazon EC2
</A></li>
        <LI>Next message: <A HREF="026884.html">[Twisted-Python] Outreach For Women
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26892">[ date ]</a>
              <a href="thread.html#26892">[ thread ]</a>
              <a href="subject.html#26892">[ subject ]</a>
              <a href="author.html#26892">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Tobias

Some comments inline but first an update on the next load test slightly
closer to my ultimate use case, which showed PyPy smoking the competition.

My test is now a request to a URL scheme like this:
/version/{app}/platform/{platform}. This gets translated into a get on
Redis for {app}-{platform} and the value is returned to the client.
All tests were on Ubuntu 12.10 on an m1.small instance on AWS with the load
test machine being an m1.large. The load test ran for about 10 minutes for
each framework.
Using Cyclone 1.1 on Twisted 13 on PyPy 2.0beta2 I was averaging about 1.8k
r/s.
Using node-restify 2.4.1 and node-redis 0.8.3 node 0.10.4 I was doing about
1.2 r/s.
Go and Scala on Play were comparable to node.

This very simple load test has me very impressed with PyPys performance and
I look forward to load testing our full app when it's ready.

Thanks for the comments, they've been very helpful.

On Mon, Apr 22, 2013 at 8:12 AM, Tobias Oberstein &lt;
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">tobias.oberstein at tavendo.de</A>&gt; wrote:

&gt;<i> Tom,
</I>&gt;<i>
</I>&gt;<i> &gt;&gt;which OS are you running on your EC2 instance? Amazon Linux?
</I>&gt;<i> &gt;I am running two m1.small Ubuntu 12.10 64bit in us-east-1, one for the
</I>&gt;<i> web server and the other for the ab.
</I>&gt;<i> &gt;&gt;Which reactor are you running your Twisted test with? Epoll?
</I>&gt;<i> &gt;Default Linux reactor, so it's Epoll.
</I>&gt;<i>
</I>&gt;<i> ok, thats good. just wanted to make sure you are aware of this and make
</I>&gt;<i> sure epoll is actually used.
</I>&gt;<i>
</I>&gt;<i> &gt;&gt;Are you running on CPython or PyPy?
</I>&gt;<i> &gt;I am running on CPython with twisted 13.0.0 installed into a virtualenv,
</I>&gt;<i> but please see my results for PyPy below, they're far more impressive.
</I>&gt;<i>
</I>&gt;<i> thats also good (and I was somehow expecting this .. at least thats also
</I>&gt;<i> my experience).
</I>&gt;<i>
</I>&gt;<i> there is 1 thing to note when benchmarking networking stuff on PyPy vs
</I>&gt;<i> CPython that I noticed in my testing:
</I>&gt;<i>
</I>&gt;<i> both the throughput (bits/s or reqs/s) as well as the average (arithmetic
</I>&gt;<i> mean) response times are far better with PyPy vs CPy
</I>&gt;<i>
</I>&gt;<i> BUT (my testings - Twisted/Autobahn/WebSocket): e.g. the 95% quantile (and
</I>&gt;<i> the worst case) response latency of PyPy is worse than CPy.
</I>&gt;<i>
</I>&gt;<i> this was PyPy 1.6 on both Linux (epoll) and FreeBSD (kqueue).
</I>&gt;<i>
</I>&gt;<i> the reason might be GC .. PyPy's GCs might be not as sophisticated as
</I>&gt;<i> CPy's (likely) or V8's (definitely).
</I>&gt;<i>
</I>&gt;<i> note: this might have changed with PyPy 2 (did not test that). Armin at
</I>&gt;<i> least was planning for a generational/incremental GC in PyPy. dunno.
</I>&gt;<i>
</I>&gt;<i> so: you might wanna test for latency also .. I'd be interested in results.
</I>&gt;<i>
</I>PyPy 2.0beta2 had comparable 95 percentile latency to all the other
frameworks in my limited test so maybe that's the improvements you
mentioned? Or maybe my naive load tests, but I like to think it's the
improvements.


&gt;<i> regarding GC, V8 and Erlang (and possibly that other VMs with the J at the
</I>&gt;<i> beginning) have an edge ..
</I>&gt;<i>
</I>&gt;<i> both LuaJIT and PyPy plan to improve on this though ..
</I>&gt;<i>
</I>&gt;<i> I don't know much about the workings of the various GCs but my feeling is
</I>I wasn't really stressing the GC with my limited test as there weren't very
many data structures in play.
That said over 10 minute load tests I didn't notice any blips in r/s or
response times so for my limited test it was all good.


&gt;<i> Tobias
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20130424/1f455730/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20130424/1f455730/attachment.htm</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026885.html">[Twisted-Python] Speed of twisted on Amazon EC2
</A></li>
	<LI>Next message: <A HREF="026884.html">[Twisted-Python] Outreach For Women
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26892">[ date ]</a>
              <a href="thread.html#26892">[ thread ]</a>
              <a href="subject.html#26892">[ subject ]</a>
              <a href="author.html#26892">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
