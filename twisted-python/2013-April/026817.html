<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Custom Scheduler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Custom%20Scheduler&In-Reply-To=25CB87184063F24C9BDD8C5E3566EA2522DC68E6%40kit-ex01.coldstorage.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026816.html">
   <LINK REL="Next"  HREF="026819.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Custom Scheduler</H1>
    <B>Itamar Turner-Trauring</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Custom%20Scheduler&In-Reply-To=25CB87184063F24C9BDD8C5E3566EA2522DC68E6%40kit-ex01.coldstorage.com"
       TITLE="[Twisted-Python] Custom Scheduler">itamar at itamarst.org
       </A><BR>
    <I>Mon Apr  8 19:38:47 EDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026816.html">[Twisted-Python] Custom Scheduler
</A></li>
        <LI>Next message: <A HREF="026819.html">[Twisted-Python] Connection was closed cleanly.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26817">[ date ]</a>
              <a href="thread.html#26817">[ thread ]</a>
              <a href="subject.html#26817">[ subject ]</a>
              <a href="author.html#26817">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/08/2013 05:10 PM, Gerrat Rickert wrote:
&gt;<i>
</I>&gt;<i> Some background:
</I>&gt;<i>
</I>&gt;<i> I have implemented a &#8220;relative frequency scheduler&#8221;.
</I>&gt;<i>
</I>&gt;<i> Tasks added to it are run with frequencies relative to one another &#8211; 
</I>&gt;<i> basically, if tasks 1-3 have relative frequencies of 1,2, and 3 
</I>&gt;<i> respectively, then task 2 is run 1/2 as often as task 1, and task 3 is 
</I>&gt;<i> run 1/3 as often.
</I>&gt;<i>
</I>&gt;<i> The tasks are all generators, so each iteration of the scheduler 
</I>&gt;<i> yields one item from one of its scheduled generators.
</I>&gt;<i>
</I>&gt;<i> The scheduler will also run tasks on both a periodic basis (ie.run 
</I>&gt;<i> this task every X other tasks), as well as running tasks on a timed 
</I>&gt;<i> basis (ie. every X seconds).
</I>&gt;<i>
</I>&gt;<i> I&#8217;d like to use twisted in the same program to do some network I/O as 
</I>&gt;<i> well as database interaction.
</I>&gt;<i>
</I>&gt;<i> I did a small test with adding a task that calls both: 
</I>&gt;<i> reactor.doIteration(0) and reactor.runUntilCurrent() to my scheduler, 
</I>&gt;<i> and that seems to run both the network I/O, and the database interactions.
</I>&gt;<i>
</I>&gt;<i> I was wondering if there were other issues with this type of setup?
</I>&gt;<i>
</I>&gt;<i> I can&#8217;t find any examples online of using other schedulers with twisted.
</I>&gt;<i>
</I>By its nature, you cannot use a different schedule with an event loop. 
The event loop must drive things. So you need to use reactor.callLater 
to drive this if you want to work with Twisted in the same process. (Or, 
use <A HREF="http://github.com/itamarst/crochet,">http://github.com/itamarst/crochet,</A> soon to be released, but that's 
more of a last resort).

That being said, the interface can be implemented by things other than a 
reactor, e.g. twisted.internet.task.Clock which is mostly used for unit 
tests. So you can have code that works both with and without Twisted if 
you write your code against the callLater API 
(twisted.internet.interfaces.IReactorTime is the interface I think).

&gt;<i> I glanced briefly at t.i.task.Cooperator, but I don&#8217;t really need 
</I>&gt;<i> deferreds for any of the CPU stuff, and I&#8217;m not really sure how I 
</I>&gt;<i> could replace its scheduler with a non-reactor based one.
</I>&gt;<i>
</I>&gt;<i>
</I>Cooperator is basically a class for driving things based off iterators, 
including generators, so it's actually fairly close to what you're doing.

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026816.html">[Twisted-Python] Custom Scheduler
</A></li>
	<LI>Next message: <A HREF="026819.html">[Twisted-Python] Connection was closed cleanly.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26817">[ date ]</a>
              <a href="thread.html#26817">[ thread ]</a>
              <a href="subject.html#26817">[ subject ]</a>
              <a href="author.html#26817">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
