<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Multiple clients and ports
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Multiple%20clients%20and%20ports&In-Reply-To=%3C5170FE48.8050408%40imperial.ac.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059320.html">
   <LINK REL="Next"  HREF="059323.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Multiple clients and ports</H1>
    <B>Phil Mayers</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Multiple%20clients%20and%20ports&In-Reply-To=%3C5170FE48.8050408%40imperial.ac.uk%3E"
       TITLE="[Twisted-Python] Multiple clients and ports">p.mayers at imperial.ac.uk
       </A><BR>
    <I>Fri Apr 19 02:20:24 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059320.html">[Twisted-Python] Multiple clients and ports
</A></li>
        <LI>Next message (by thread): <A HREF="059323.html">[Twisted-Python] Multiple clients and ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59322">[ date ]</a>
              <a href="thread.html#59322">[ thread ]</a>
              <a href="subject.html#59322">[ subject ]</a>
              <a href="author.html#59322">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/19/2013 01:33 AM, Carlos Eduardo Sotelo Pinto wrote:
&gt;<i> I am doing a gps tracker wich use multiple protocols and multiple
</I>&gt;<i> clients, my problen is when I have more than one client on more than
</I>&gt;<i> one protocol at the same time, data and validation start to crashing
</I>&gt;<i> one to other
</I>
I don't understand what you mean. Can you be more specific?

&gt;<i>
</I>&gt;<i>      def __init__(self, decoder):
</I>&gt;<i>          &quot;&quot;&quot;Class Constructor.&quot;&quot;&quot;
</I>&gt;<i>          decoderModule = __import__('listener.protocols.%sDecoder' %
</I>&gt;<i> (decoder, ), fromlist=['%sDecoder' % (decoder, )])
</I>&gt;<i>          decoderClass = getattr(decoderModule, '%sDecoder' % (decoder, ))
</I>
You might want to look at &quot;twisted.python.reflect&quot; which contains utils 
to do that kind of &quot;give me the python object at this import&quot;


&gt;<i>      def dataReceived(self, data):
</I>&gt;<i>          Protocol.dataReceived(self, data)
</I>&gt;<i>
</I>&gt;<i>          &quot;&quot;&quot;DataReceived Twisted event.&quot;&quot;&quot;
</I>&gt;<i>          try:
</I>&gt;<i>              self.sendResponse(self.decoder.processDatagram(data))
</I>
Not sure if this is your problem - but stream protocols (TCP) don't 
guarantee that &quot;message&quot; boundaries will be preserved - that is, if the 
sender does:

write(100 bytes)
write(100 bytes)

...you might get

dataReceived(10 bytes)
dataReceived(39 bytes)
dataReceived(27 bytes)

...or any other variation - the data can arrive in arbitrary chunks. 
Unless your processDatagram is doing the reassembly, you need to 
implement message framing in your dataReceived method.

Note that the commented out versions of your base classes were all for 
protocols which do framing (e.g. line-based, etc.)

Normally this looks something like:

  def dataReceived(self, data):
     self.buffer += data
     if hasFullMessage(self.buffer):
       msg, self.buffer = extractMessage(self.buffer)
       processMsg(msg)




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059320.html">[Twisted-Python] Multiple clients and ports
</A></li>
	<LI>Next message (by thread): <A HREF="059323.html">[Twisted-Python] Multiple clients and ports
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59322">[ date ]</a>
              <a href="thread.html#59322">[ thread ]</a>
              <a href="subject.html#59322">[ subject ]</a>
              <a href="author.html#59322">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
