<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Passing arguments while running a twistd	application
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Passing%20arguments%20while%20running%20a%20twistd%0A%09application&In-Reply-To=%3C18698.61244.704425.437134%40jon.es%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="051099.html">
   <LINK REL="Next"  HREF="051101.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Passing arguments while running a twistd	application</H1>
    <B>Terry Jones</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Passing%20arguments%20while%20running%20a%20twistd%0A%09application&In-Reply-To=%3C18698.61244.704425.437134%40jon.es%3E"
       TITLE="[Twisted-Python] Passing arguments while running a twistd	application">terry at jon.es
       </A><BR>
    <I>Fri Oct 31 05:42:52 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="051099.html">[Twisted-Python] Passing arguments while running a twistd	application
</A></li>
        <LI>Next message (by thread): <A HREF="051101.html">[Twisted-Python] Passing arguments while running a twistd	application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51100">[ date ]</a>
              <a href="thread.html#51100">[ thread ]</a>
              <a href="subject.html#51100">[ subject ]</a>
              <a href="author.html#51100">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;&gt;&gt;&gt;&gt;<i> &quot;Adriano&quot; == Adriano Marques &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">py.adriano at gmail.com</A>&gt; writes:
</I>Adriano&gt; I have a twisted application, which formely was run with command
Adriano&gt; line arguments which were used during runtime, eg: I was passing
Adriano&gt; the path to the log file as argument. Then, I decided to make my
Adriano&gt; app run through twistd as a tac file but then I'm not able to pass
Adriano&gt; command line arguments anymore. Is there any way to overcome this
Adriano&gt; issue?

I also ran into this, and asked for some way to pass args but got told
(paraphrasing, from memory) that that's not the way to do it...

The way to do it seems to be to convert your application to be a Twisted
plugin. It's not too hard.  Then you make sure there's a twisted/plugins
dir accessible from your path (with no __init__.py files in/under it). Then
twistd will find your plugin (just run twistd with no options and you
should see your plugin name listed at the bottom among the commands). Then
you can add options processing by subclassing the Options class in
twisted.python.usage.

Sorry to be so terse - no time. The above does work though, and seems to be
the Twisted way. Rough (untested) guideline code below.

Terry

---

from zope.interface import implements
from twisted.python import usage
from twisted.plugin import IPlugin
from twisted.application.service import IServiceMaker
from ???? import myservice

class Options(usage.Options):
    optFlags = [
        ['verbose', None, 'If True, be verbose.'],
    ]
    optParameters = [
        ['port', 'p', '0', 'The port number to listen on.'],
    ]

class MyServiceMaker(object):
    implements(IServiceMaker, IPlugin)
    # The tapname will appear in the output of twistd when run with no args.
    # Use twistd -n my-plugin-name
    # to invoke it.
    tapname = 'my-plugin-name'
    description = 'My snazzy service.'
    options = Options

    def makeService(self, options):
        return myservice(
            options['port'], options['verbose'])

serviceMaker = MyServiceMaker()


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="051099.html">[Twisted-Python] Passing arguments while running a twistd	application
</A></li>
	<LI>Next message (by thread): <A HREF="051101.html">[Twisted-Python] Passing arguments while running a twistd	application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51100">[ date ]</a>
              <a href="thread.html#51100">[ thread ]</a>
              <a href="subject.html#51100">[ subject ]</a>
              <a href="author.html#51100">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
