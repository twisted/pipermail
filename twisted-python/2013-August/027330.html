<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Advice Request: Under what circumstances	should I use AMP's Command Response field?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Advice%20Request%3A%20Under%20what%20circumstances%0A%09should%20I%20use%20AMP%27s%20Command%20Response%20field%3F&In-Reply-To=%3C9C24B2B1-DE21-44C4-BC0F-9BEEB3204EDF%40nehbit.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027327.html">
   <LINK REL="Next"  HREF="027331.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Advice Request: Under what circumstances	should I use AMP's Command Response field?</H1>
    <B>Burak Nehbit</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Advice%20Request%3A%20Under%20what%20circumstances%0A%09should%20I%20use%20AMP%27s%20Command%20Response%20field%3F&In-Reply-To=%3C9C24B2B1-DE21-44C4-BC0F-9BEEB3204EDF%40nehbit.net%3E"
       TITLE="[Twisted-Python] Advice Request: Under what circumstances	should I use AMP's Command Response field?">burak at nehbit.net
       </A><BR>
    <I>Tue Aug 20 16:11:47 MDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027327.html">[Twisted-Python] Advice Request: Under what circumstances should I use AMP's Command Response field?
</A></li>
        <LI>Next message: <A HREF="027331.html">[Twisted-Python] Advice Request: Under what circumstances should I use AMP's Command Response field?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27330">[ date ]</a>
              <a href="thread.html#27330">[ thread ]</a>
              <a href="subject.html#27330">[ subject ]</a>
              <a href="author.html#27330">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Laurens,

&gt;<i> I don't understand this part. It sounds like an authentication problem, no?
</I>
It's an authentication problem, yes, but the authentication is a very simple one&#8212;that the remote should initiate the start of the process with a handshake. That way, the local user's program knows under who to file the incoming data. It's less of an authentication and more of preventing the remote from dumping to the local user unrequested text.

&gt;<i> Some more information about your system would be useful. Are posts append-only? Would it make sense to have a given serialization of them? If so, a hash chain would allow you to sync with just one hash value. A consensus protocol might help you figure out what that serialization is.
</I>
I seem to have been implicitly assuming more knowledge in my system than I have given, I apologise. To give a general overview, I am building a peer&#8211;to&#8211;peer network that is vaguely similar to reddit.com, but one that runs based on peer&#8211;to&#8211;peer exchanges rather than relying on a central server. My system sends posts across the wire from one computer to another, and all the sorting and other logic happens on the ends. The wire is rather dumb&#8212;I'm trying to follow the end to end principle as much as I can. 

The users handshake each other (by sending their node ids), exchange post fingerprints (of posts they have in their machines), request posts of fingerprints new to them, download posts from the remote, and then close the connection. This is the archetypal connection in my system. Posts are immutable, they cannot be deleted or edited, only pruned after six months, which is also enforced at endpoints. It should be rather simple to implement this with Twisted, barring some NAT Traversal pains, but that can be solved. 

The posts are JSON text. I do want to have a public&#8211;key implementation on top of this with a reliable ECC algorithm, but that's for future versions. For now, I am concerned with just getting it to work. 

Does this give you enough information? I am curious about the best or the most natural way to implement in it Twisted. I have been trying to work with Twisted on and off since March as ,y project progressed, but even after finishing the second edition Twisted book, I am still unable to fully wrap my head around it, hence these questions. 

Should I be using AMP? Am I doing something dumb?

Also, when I finally &quot;get&quot; Twisted, I'll be making a series of blog posts called &quot;Twisted for Dumb People [Like Me]&quot;. Such a wonderful piece of code, it doesn't deserve the brick wall of a learning curve it currently has.

Thanks!

Best,
Burak






On Aug 20, 2013, at 3:06 PM, Laurens Van Houtven &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">_ at lvh.io</A>&gt; wrote:

&gt;<i> Hi Burak,
</I>&gt;<i> 
</I>&gt;<i> On Tue, Aug 20, 2013 at 12:21 PM, Burak Nehbit &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">burak at nehbit.net</A>&gt; wrote:
</I>&gt;<i> Hi there,
</I>&gt;<i> 
</I>&gt;<i> I was meaning to ask you all about the 'proper' way to use AMP in regards to two&#8211;way communication. The problem I am facing is quite simple, I am building a simple peer&#8211;to&#8211;peer network in which the user:
</I>&gt;<i> 
</I>&gt;<i> a) When sent a handshake, returns a handshake,
</I>&gt;<i> b) When asked for fingerprints of posts in the local, returns it, and then asks for the same thing,
</I>&gt;<i> and finally, c) If any of the fingerprints do not match posts, request those posts with the fingerprint.
</I>&gt;<i> 
</I>&gt;<i> The only non&#8211;symmetric step I have in my protocol is the last one.
</I>&gt;<i> 
</I>&gt;<i> My question is, should I send my responses over the same AMP command as a response to the command requested, or should I just return an ACK (a boolean value of true, to confirm receipt) and then initiate a separate AMP request from local to the same remote?
</I>&gt;<i> 
</I>&gt;<i> Keep in mind that AMP commands are always ack'ed without you needing to specify any kind of value, unless you set requiresResponse = False on the Command class.
</I>&gt;<i> 
</I>&gt;<i> That would mean I would need to handle my open&#8211;connections pool by myself, to prevent posts from a non&#8211;initiated machine being accepted into the local machine, but I do need to implement that anyway due to the complexity of my business rules.
</I>&gt;<i> 
</I>&gt;<i> I don't understand this part. It sounds like an authentication problem, no?
</I>&gt;<i>  
</I>&gt;<i> At that point, it seems that I am (Am I?) just using AMP as a remote method header I don't strictly need, and I could just use LineReceiver&#8212;all my data is text&#8212;to do my bidding.
</I>&gt;<i> 
</I>&gt;<i> It's usually correct that you can do things with LineReceiver, but it's also usually true that AMP is doing stuff for you ;)
</I>&gt;<i> 
</I>&gt;<i> Some more information about your system would be useful. Are posts append-only? Would it make sense to have a given serialization of them? If so, a hash chain would allow you to sync with just one hash value. A consensus protocol might help you figure out what that serialization is.
</I>&gt;<i> 
</I>&gt;<i> cheers
</I>&gt;<i> lvh
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20130821/2cbc04b1/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20130821/2cbc04b1/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4343 bytes
Desc: not available
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20130821/2cbc04b1/attachment.bin">http://twistedmatrix.com/pipermail/twisted-python/attachments/20130821/2cbc04b1/attachment.bin</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027327.html">[Twisted-Python] Advice Request: Under what circumstances should I use AMP's Command Response field?
</A></li>
	<LI>Next message: <A HREF="027331.html">[Twisted-Python] Advice Request: Under what circumstances should I use AMP's Command Response field?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27330">[ date ]</a>
              <a href="thread.html#27330">[ thread ]</a>
              <a href="subject.html#27330">[ subject ]</a>
              <a href="author.html#27330">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
