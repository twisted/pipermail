<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Mail attachments
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Mail%20attachments&In-Reply-To=%3C200604251500.27082.Marcin.Kasperski%40softax.com.pl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="045468.html">
   <LINK REL="Next"  HREF="045470.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Mail attachments</H1>
    <B>Marcin Kasperski</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Mail%20attachments&In-Reply-To=%3C200604251500.27082.Marcin.Kasperski%40softax.com.pl%3E"
       TITLE="[Twisted-Python] Mail attachments">Marcin.Kasperski at softax.com.pl
       </A><BR>
    <I>Tue Apr 25 07:00:26 MDT 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="045468.html">[Twisted-Python] Mail attachments
</A></li>
        <LI>Next message (by thread): <A HREF="045470.html">[Twisted-Python] Sending large amounts of data over Pb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45469">[ date ]</a>
              <a href="thread.html#45469">[ thread ]</a>
              <a href="subject.html#45469">[ subject ]</a>
              <a href="author.html#45469">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> I would like to send an attachment with my email. I presume I
</I>&gt;<i> do this through the sendEmail function but how to achieve is
</I>&gt;<i> beyond me at the moment. :-(
</I>
Here is the code I use (to send PGN files, which are just text 
files). If you want to send images or binary files, you need to 
change the way pgn_part is constructed.

from email import Encoders
from email.Message import Message
from email.MIMEBase import MIMEBase
from email.MIMEMultipart import MIMEMultipart
#from email.MIMEImage import MIMEImage
from email.MIMEText import MIMEText

class EmailSender:
    def __init__(self, from_addr, smtp_host, 
                 smtp_user = None, smtp_password = None):
        self.from_addr = from_addr
        self.smtp_host = smtp_host
        self.smtp_user = smtp_user
        self.smtp_password = smtp_password
    def sendPGN(self, to_addr_list, subject, pgn,
                intro_text = None, 
                preamble = 'Some preamble', 
                epilogue = 'Some epilogue',
                attachment_name = 'attachmentname'):
        msg = MIMEMultipart()
        msg['Subject'] = subject
        msg['From'] = self.from_addr
        msg['To'] = &quot;, &quot;.join(to_addr_list)
        msg.preamble = preamble
        msg.epilogue = epilogue
        if intro_text:
            msg.attach( MIMEText(intro_text, 'plain') )
        pgn_part = MIMEBase('text', 'plain')
        pgn_part.set_payload(pgn)
        #Encoders.encode_base64(pgn)
        pgn_part.add_header('Content-Disposition', 'attachment', 
filename=attachment_name+'.pgn')
        msg.attach(pgn_part)
        deferred = smtp.sendmail(self.smtp_host, self.from_addr, 
to_addr_list, msg.as_string())
        return deferred


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="045468.html">[Twisted-Python] Mail attachments
</A></li>
	<LI>Next message (by thread): <A HREF="045470.html">[Twisted-Python] Sending large amounts of data over Pb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45469">[ date ]</a>
              <a href="thread.html#45469">[ thread ]</a>
              <a href="subject.html#45469">[ subject ]</a>
              <a href="author.html#45469">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
