<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] HTTP/2 and Twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20HTTP/2%20and%20Twisted&In-Reply-To=%3C1CFA3296-EFC1-443C-B7EF-E322CE88C744%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029880.html">
   <LINK REL="Next"  HREF="029895.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] HTTP/2 and Twisted</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20HTTP/2%20and%20Twisted&In-Reply-To=%3C1CFA3296-EFC1-443C-B7EF-E322CE88C744%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] HTTP/2 and Twisted">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Nov 11 23:04:53 MST 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="029880.html">[Twisted-Python] HTTP/2 and Twisted
</A></li>
        <LI>Next message: <A HREF="029895.html">[Twisted-Python] HTTP/2 and Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29894">[ date ]</a>
              <a href="thread.html#29894">[ thread ]</a>
              <a href="subject.html#29894">[ subject ]</a>
              <a href="author.html#29894">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Nov 9, 2015, at 1:02 AM, Cory Benfield &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">cory at lukasa.co.uk</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> All,
</I>&gt;<i> 
</I>&gt;<i> With the work on #7860 nearly done,
</I>
_Actually_ done, now.

&gt;<i> Twisted should be in a good place to have a HTTP/2 implementation. There&#8217;s currently a Trac ticket (#7460) for adding HTTP/2 support to twisted.web, which is obviously a good idea. I&#8217;m happy to take on that work.
</I>
&lt;3 &lt;3 &lt;3

&gt;<i> What I want to get a picture for is how much of the Twisted support should live in Twisted itself. Currently I&#8217;m planning to base the implementation on Hyper-h2[0]. This is because it seems totally needless to write a new HTTP/2 state machine when a perfectly good one already exists (full disclosure: I&#8217;m the maintainer of Hyper-h2).
</I>
Did somebody say STATE MACHINE??? <A HREF="https://github.com/glyph/automat">https://github.com/glyph/automat</A> &lt;<A HREF="https://github.com/glyph/automat">https://github.com/glyph/automat</A>&gt; (Seriously though maybe look at it, it might make some of the innards of h2 nicer, or, maybe you will have some ideas about how broken it is and could tell me them.)

Yes, we should definitely depend on h2 as a library and not do our own thing.  Frankly, Hyper-h2 is almost SURREAL in how well-factored and decoupled the implementation is from I/O.  If libraries in the Python ecosystem looked like this generally, Twisted would be a much better platform than it is.  (Frankly, most of Twisted's _own_ protocol implementations should aspire to such cleanliness.)

&gt;<i> However, we&#8217;ll still need a HTTP/2 Protocol, and the twisted.web integration. The twisted.web integration will definitely need to be done in Twisted, but Adi has pointed out to me that it may be better for the HTTP/2 Protocol itself to live outside of core Twisted (probably as a sub-project of Hyper, with a working title of txh2). This would give us a lot more flexibility and speed to iterate.
</I>
Creating this dependency loop (twisted-&gt;txh2-&gt;(twisted-&gt;txh2-&gt;..., h2)) seems potentially problematic, and maybe more trouble than it's worth in terms of factoring things out.  An IProtocol implementation is literally three methods - makeConnection, dataReceived, connectionLost - so if we put this together nicely there should not be too much code on the Twisted side of things.  Or at least, so I imagine; just the glue to hook it up to (sigh) IResource, et. al.

One potential way to keep the dependency graph from being cyclical is to build the interface in terms of Tubes (see &lt;<A HREF="https://github.com/twisted/tubes">https://github.com/twisted/tubes</A> &lt;<A HREF="https://github.com/twisted/tubes">https://github.com/twisted/tubes</A>&gt;&gt; and &lt;<A HREF="https://twistedmatrix.com/trac/ticket/288">https://twistedmatrix.com/trac/ticket/288</A> &lt;<A HREF="https://twistedmatrix.com/trac/ticket/288">https://twistedmatrix.com/trac/ticket/288</A>&gt;&gt;) and move the Twisted-y parts of Tubes (like undefer.py) into Twisted proper.

Another would be to actually extract Deferred for real, and it seems the time is ripe for such an adventure.

&gt;<i> I want to get a sense of what the team believes is the best approach. Can I have your opinions? How much of this should be in Twisted itself?
</I>
Can you maybe expand a little bit on what pieces you think need to exist, in terms of what the Protocol would actually do?  Are you thinking about things like integration with Cred?

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20151111/e8b8ff08/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20151111/e8b8ff08/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029880.html">[Twisted-Python] HTTP/2 and Twisted
</A></li>
	<LI>Next message: <A HREF="029895.html">[Twisted-Python] HTTP/2 and Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29894">[ date ]</a>
              <a href="thread.html#29894">[ thread ]</a>
              <a href="subject.html#29894">[ subject ]</a>
              <a href="author.html#29894">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
