<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Streaming HTTP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Streaming%20HTTP&In-Reply-To=%3C5649FE55.3030909%40contact.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029940.html">
   <LINK REL="Next"  HREF="029920.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Streaming HTTP</H1>
    <B>Michael Schlenker</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Streaming%20HTTP&In-Reply-To=%3C5649FE55.3030909%40contact.de%3E"
       TITLE="[Twisted-Python] Streaming HTTP">msc at contact.de
       </A><BR>
    <I>Mon Nov 16 09:03:33 MST 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="029940.html">[Twisted-Python] Streaming HTTP
</A></li>
        <LI>Next message: <A HREF="029920.html">[Twisted-Python] Streaming HTTP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29916">[ date ]</a>
              <a href="thread.html#29916">[ thread ]</a>
              <a href="subject.html#29916">[ subject ]</a>
              <a href="author.html#29916">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

sounds like a good idea.

One topic: What should happen if the sender sends malformed data (e.g.
content-length: 100 and sending 200 bytes body). I would usually want to
know if the sender is broken instead of getting a responseComplete()
that claims everything is fine.

We simply subclassed twisted.web.server.Request and injected the needed
parts so we could get the data we wanted in an incremental way and set
some socket options (SO_RCVBUF) for multi-gigabyte file uploads.

So we took 'gotLength()' as a signal that headers are fully received and
also took 'write()', 'processingFailed()' to handle cleanup.

Basically we replace the self.content stream object with our own version
that does not buffer everything in memory.

We tried to do the 100-Continue stuff too, but it simply didn't work
with the Python stdlib httplib code (it just ignores those more or
less). So we either just terminate the connection forcefully (reset) or
read the full request and send it to /dev/null.

Michael

-- 
Michael Schlenker
Senior Software Engineer

CONTACT Software GmbH           Tel.:   +49 (421) 20153-80
Wiener Stra&#223;e 1-3               Fax:    +49 (421) 20153-41
28359 Bremen
E-Mail: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">michael.schlenker at contact-software.com</A>
<A HREF="http://www.contact-software.com/">http://www.contact-software.com/</A>

Registered office: Bremen, Germany
Managing directors: Karl Heinz Zachries, Ralf Holtgrefe
Court of register: Amtsgericht Bremen HRB 1321

</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029940.html">[Twisted-Python] Streaming HTTP
</A></li>
	<LI>Next message: <A HREF="029920.html">[Twisted-Python] Streaming HTTP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29916">[ date ]</a>
              <a href="thread.html#29916">[ thread ]</a>
              <a href="subject.html#29916">[ subject ]</a>
              <a href="author.html#29916">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
