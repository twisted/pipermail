<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] help! - listenTCP failing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20help%21%20-%20listenTCP%20failing&In-Reply-To=%3C1048653131.1631.38.camel%40rebirth%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="035870.html">
   <LINK REL="Next"  HREF="035875.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] help! - listenTCP failing</H1>
    <B>David McNab</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20help%21%20-%20listenTCP%20failing&In-Reply-To=%3C1048653131.1631.38.camel%40rebirth%3E"
       TITLE="[Twisted-Python] help! - listenTCP failing">david at rebirthing.co.nz
       </A><BR>
    <I>Tue Mar 25 21:32:11 MST 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="035870.html">[Twisted-Python] contribution - telnetd example
</A></li>
        <LI>Next message (by thread): <A HREF="035875.html">[Twisted-Python] help! - listenTCP failing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35873">[ date ]</a>
              <a href="thread.html#35873">[ thread ]</a>
              <a href="subject.html#35873">[ subject ]</a>
              <a href="author.html#35873">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm building an app that will need the ability to start and stop
protocol servers dynamically.

As part of figuring this out, I've added an ApplicationService to the
app, and within ApplicationService.startService(), I'm calling
self.get_application.listenTCP(portnum, myprotocol).

This is having no visible effect, since the port is not getting opened.

I tried, within startService(), calling reactor.listenTCP() instead.
This starts up the protocol and opens the port just fine, but when I
later call app.unlistenTCP(port) to shut down the protocol, I get the
exception (see below).

What am I doing wrong?
What's the best and simplest way to dynamically start and stop server
protocols at runtime()?

Thanks in advance
David

Traceback (most recent call last):
  File &quot;/usr/lib/python2.2/site-packages/twisted/internet/app.py&quot;, line
744, in run
    main.run(installSignalHandlers=installSignalHandlers)
  File &quot;/usr/lib/python2.2/site-packages/twisted/internet/main.py&quot;, line
106, in run
    _getReactor().run()
  File &quot;/usr/lib/python2.2/site-packages/twisted/internet/default.py&quot;,
line 113, in run
    self.mainLoop()
  File &quot;/usr/lib/python2.2/site-packages/twisted/internet/default.py&quot;,
line 124, in mainLoop
    self.doIteration(t)
--- &lt;exception caught here&gt; ---
  File &quot;/usr/lib/python2.2/site-packages/twisted/internet/default.py&quot;,
line 450, in doSelect
    why = getattr(selectable, method)()
  File &quot;/usr/lib/python2.2/site-packages/twisted/internet/tcp.py&quot;, line
105, in doRead
    return self.protocol.dataReceived(data)
  File &quot;/usr/lib/python2.2/site-packages/twisted/protocols/telnet.py&quot;,
line 314, in dataReceived
    why = self.processChunk(c)
  File &quot;/usr/lib/python2.2/site-packages/twisted/protocols/telnet.py&quot;,
line 261, in processChunk
    self.processLine(buf)
  File &quot;/usr/lib/python2.2/site-packages/twisted/protocols/telnet.py&quot;,
line 221, in processLine
    self.mode = getattr(self, &quot;telnet_&quot;+self.mode)(line)
  File &quot;/usr/lib/python2.2/site-packages/twisted/protocols/telnet.py&quot;,
line 237, in telnet_Password
    if not self.checkUserAndPass(self.username, paswd):
  File &quot;mytelnetd.py&quot;, line 34, in checkUserAndPass
    self.factory.appl.killTelnet()
  File &quot;mytelnetd.py&quot;, line 61, in killTelnet
    self.unlistenTCP(2000)
  File &quot;/usr/lib/python2.2/site-packages/twisted/internet/app.py&quot;, line
444, in unlistenTCP
    if self._listenerDict.has_key((port_, interface_)):
exceptions.UnboundLocalError: local variable 'port_' referenced before
assignment
 




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="035870.html">[Twisted-Python] contribution - telnetd example
</A></li>
	<LI>Next message (by thread): <A HREF="035875.html">[Twisted-Python] help! - listenTCP failing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35873">[ date ]</a>
              <a href="thread.html#35873">[ thread ]</a>
              <a href="subject.html#35873">[ subject ]</a>
              <a href="author.html#35873">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
