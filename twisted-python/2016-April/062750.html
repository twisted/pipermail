<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] waiting on any deferred in a list?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20waiting%20on%20any%20deferred%20in%20a%20list%3F&In-Reply-To=%3CCAMWA1_p7SVZtXS3ZdVt87QaHTwo9KVO%2BS%2BFpGSkX4-eeiUFmyQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] waiting on any deferred in a list?</H1>
    <B>Benjamin Rutt</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20waiting%20on%20any%20deferred%20in%20a%20list%3F&In-Reply-To=%3CCAMWA1_p7SVZtXS3ZdVt87QaHTwo9KVO%2BS%2BFpGSkX4-eeiUFmyQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] waiting on any deferred in a list?">rutt.4 at osu.edu
       </A><BR>
    <I>Sun Apr 24 11:37:08 MDT 2016</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62750">[ date ]</a>
              <a href="thread.html#62750">[ thread ]</a>
              <a href="subject.html#62750">[ subject ]</a>
              <a href="author.html#62750">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I've been using a pattern for quite some time to collect a bunch o'
deferreds in a list and then yield on them one at a time.  Here is some
untested pseudocode:

---
@defer.inlineCallbacks
def foo( ls ):
    defs = []

    # get all the deferreds going
    for item in ls:
        d = some_deferred_returning_function( item )
        defs.append( ( item, d ) ) # associate item with deferred

    # process results not as they come in but in the original order
    for ( item, d ) in defs:
        result = yield d
        print 'The result on item', item, 'is', result
---

In this way, I can get good concurrency (by spinning up all deferreds at
once) but also I can iterate on the results using a straightforward
traversal of the list data structure and yield.  This is working great for
me.  But on occasion I'd prefer that I can access the results not in the
order that I originally got, but rather in the order of completion of the
deferreds, so the faster ones come in first, and the slower ones don't hold
up faster ones.  The usual case when I'd want this is when I have &quot;slower&quot;
deferreds near the front, and &quot;faster&quot; deferreds near the back.  I can't
help but think that there's some async data structure out there for me that
can solve this.  I've used DeferredList before, and I can't see that it
does what I want:  it gives you a choice between getting all results only
when they are all done (default behavior), or getting the first one that's
ready (fireOnOneCallback=True).  I want all results, but I want the
processing of the results to unfold as the results come in.

Thanks for any ideas.
-- 
Benjamin Rutt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20160424/f718fb58/attachment-0002.html&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62750">[ date ]</a>
              <a href="thread.html#62750">[ thread ]</a>
              <a href="subject.html#62750">[ subject ]</a>
              <a href="author.html#62750">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
