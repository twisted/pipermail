<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] what is a non-class class?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20what%20is%20a%20non-class%20class%3F&In-Reply-To=%3C1522503.xpp1Bo2WKl%40i5%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="061147.html">
   <LINK REL="Next"  HREF="061156.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] what is a non-class class?</H1>
    <B>Wolfgang Rohdewald</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20what%20is%20a%20non-class%20class%3F&In-Reply-To=%3C1522503.xpp1Bo2WKl%40i5%3E"
       TITLE="[Twisted-Python] what is a non-class class?">wolfgang.kde at rohdewald.de
       </A><BR>
    <I>Mon Sep  1 16:24:33 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="061147.html">[Twisted-Python] Using spawnProcess
</A></li>
        <LI>Next message (by thread): <A HREF="061156.html">[Twisted-Python] what is a non-class class?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28687">[ date ]</a>
              <a href="thread.html#28687">[ thread ]</a>
              <a href="subject.html#28687">[ subject ]</a>
              <a href="author.html#28687">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>From spread/jelly.py in _unjelly_method:
</I>
-        if type(im_class) is not types.ClassType:
             raise InsecureJelly(&quot;Method found with non-class class.&quot;)

Same problem in _unjelly_instance

What is a non-class class or rather what sort of types is meant to
be insecure?

Suggestions for a better error message instead of &quot;non-class class&quot;?

This should work with both old style and new style classes, right
now it works only for old style and fails for new style. Working
with Python3 gives bonus points.

Current source code does not have test cases for both _unjelly_instance
and _unjelly_method using new style classes. My patch for ticket 4935
has a such a test case for _unjelly_method which fails as expected.

If only user defined classes are accepted as secure, see also
<A HREF="https://stackoverflow.com/questions/14612865/how-to-check-if-object-is-instance-of-new-style-user-defined-class">https://stackoverflow.com/questions/14612865/how-to-check-if-object-is-instance-of-new-style-user-defined-class</A>

Would it be acceptable to instead exclude an explicit list of 
basic types as that stackoverflow answer suggests?

if im_class in (int, long, float, bool, list, set, frozenset, dict, type(None), str,
		unicode, tuple, what else?):
  raise InsecureJelly

<A HREF="https://twistedmatrix.com/documents/current/api/twisted.spread.jelly.InsecureJelly.html">https://twistedmatrix.com/documents/current/api/twisted.spread.jelly.InsecureJelly.html</A>
does not cover this.

Python 2.7.6:


&gt;&gt;&gt;<i> class A(object):                                                                                        
</I>...   pass                                                                                                  
...                                                                                                         
&gt;&gt;&gt;<i> type(A)
</I>&lt;type 'type'&gt;                                                                                               
&gt;&gt;&gt;<i> type(int)
</I>&lt;type 'type'&gt;

&gt;&gt;&gt;<i> import types                                                                                            
</I>&gt;&gt;&gt;<i> types.ClassType
</I>&lt;type 'classobj'&gt;                                                                                           
&gt;&gt;&gt;<i> class B:
</I>...   pass                                                                                                  
...                                                                                                         
&gt;&gt;&gt;<i> type(B)
</I>&lt;type 'classobj'&gt;


Python 3.3:
&gt;&gt;&gt;<i> class A:
</I>...   pass
... 
&gt;&gt;&gt;<i> type(A)
</I>&lt;class 'type'&gt;
&gt;&gt;&gt;<i> type(int)
</I>&lt;class 'type'&gt;


-- 
Wolfgang

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="061147.html">[Twisted-Python] Using spawnProcess
</A></li>
	<LI>Next message (by thread): <A HREF="061156.html">[Twisted-Python] what is a non-class class?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28687">[ date ]</a>
              <a href="thread.html#28687">[ thread ]</a>
              <a href="subject.html#28687">[ subject ]</a>
              <a href="author.html#28687">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
