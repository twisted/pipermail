<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] High throughput database logger
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20High%20throughput%20database%20logger&In-Reply-To=%3C5408606E.2030401%40proatria.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] High throughput database logger</H1>
    <B>Adi Libotean</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20High%20throughput%20database%20logger&In-Reply-To=%3C5408606E.2030401%40proatria.com%3E"
       TITLE="[Twisted-Python] High throughput database logger">adi.libotean at proatria.com
       </A><BR>
    <I>Thu Sep  4 06:51:58 MDT 2014</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61182">[ date ]</a>
              <a href="thread.html#61182">[ thread ]</a>
              <a href="subject.html#61182">[ subject ]</a>
              <a href="author.html#61182">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm looking at various options for implementing a high throughput 
database logger that will work with Twisted.

My requirements, listed by importance:

1) small memory footprint
2) high speed
3) low garbage generation

The application I'm working on runs continuously (24/7). I've 
experimented a bit with pysqlite and Twisted to see which approach is 
better suited (see attached example).

----

Question 1: I noticed that all of the Twisted based versions are very 
slow compared to the plain sqlite3 test. This seems to be caused by 
atomic transaction management, namely a commit after each insert.

Would be interested to know if there is a simple way to avoid this and 
do my own transaction management (aka batch commit).

One other thing is the greatly varying amounts of garbage generated 
(peak memory) and memory usage between the Twisted variants.

----

Question 2: I would have expected B (Twisted ADBAPI) to behave very 
similar to C/E since I'm using a connection pool of size 1 and all 
requests are queued and handled sequentially.

Could any of you please give me some pointers as to why this is happening?

----

Question 3: Even though objgraph lists the exact same reference count 
once the code is ran, the amount of used memory greatly differs. Any 
ideas what might be causing this?

Any suggestions and/or pointers on how to improve/do this are more than 
welcome.

Thank you for your time,
Adrian
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: db-insert-test.py
URL: &lt;/pipermail/twisted-python/attachments/20140904/1d611721/attachment-0002.ksh&gt;
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: results.txt
URL: &lt;/pipermail/twisted-python/attachments/20140904/1d611721/attachment-0002.txt&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61182">[ date ]</a>
              <a href="thread.html#61182">[ thread ]</a>
              <a href="subject.html#61182">[ subject ]</a>
              <a href="author.html#61182">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
