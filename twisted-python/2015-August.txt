From trac at twistedmatrix.com  Sun Aug  2 00:05:21 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 02 Aug 2015 06:05:21 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1438495521.65.5356257244379318254@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150802/346dd450/attachment.html>

From hawkowl at atleastfornow.net  Sun Aug  2 19:49:38 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Mon, 3 Aug 2015 11:49:38 +1000
Subject: [Twisted-Python] Twisted 15.3.0pre2 Prerelease Announcement
Message-ID: <0745BCE2-E449-4A40-89B7-20C6C75D3383@atleastfornow.net>

Hi everyone,

I've just uploaded 15.3.0pre2 to http://twistedmatrix.com/Releases/pre/15.3.0pre2/ , which provides a small fix for Twisted-using libraries that subclass Protocol overwriting the `_log` attribute.

Please test your software with it, but as this is a very minor change, I will release it very soon.

Twisted Regards,

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150803/a7e1d064/attachment.pgp>

From jcraig at gsacrd.ab.ca  Sun Aug  2 19:50:16 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Sun, 02 Aug 2015 19:50:16 -0600
Subject: [Twisted-Python] Twisted 15.3.0pre2 Prerelease Announcement
Message-ID: <fc.000f81d802d88edb3b9aca000d690663.2d88edc@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150802/de645ff4/attachment.html>

From hawkowl at atleastfornow.net  Tue Aug  4 01:05:06 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Tue, 4 Aug 2015 17:05:06 +1000
Subject: [Twisted-Python] Twisted 15.3 Release Announcement
Message-ID: <2B4C122E-4DA0-4743-8D30-B0F419084098@atleastfornow.net>

On behalf of Twisted Matrix Labs, I am honoured to announce the release of Twisted 15.3.

We're marching confidently into the future, and this release demonstrates this:

	* 10+ modules ported to Python 3 (see NEWS for specifics)
 	* Twisted Lore has been removed.
	* Twisted no longer releases as 'subprojects' -- there is only one Twisted, long may it reign.
	* twistd now uses cProfile (instead of Hotshot) as the default profiler.
	* 40+ more tickets closed overall.

You can find the downloads at https://pypi.python.org/pypi/Twisted (or alternatively http://twistedmatrix.com/trac/wiki/Downloads). The NEWS file can be found at https://github.com/twisted/twisted/blob/trunk/NEWS .

Many thanks to everyone who had a part in this release - the supporters of the Twisted Software Foundation, the developers who contributed code as well as documentation, and all the people building great things with Twisted!

Twisted Regards,

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150804/63def2f3/attachment.pgp>

From jcraig at gsacrd.ab.ca  Tue Aug  4 01:05:32 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Tue, 04 Aug 2015 01:05:32 -0600
Subject: [Twisted-Python] Twisted 15.3 Release Announcement
Message-ID: <fc.000f81d802d89dd23b9aca0002d5d66f.2d89dd3@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150804/b42b008a/attachment.html>

From glyph at twistedmatrix.com  Thu Aug  6 12:32:02 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 6 Aug 2015 11:32:02 -0700
Subject: [Twisted-Python] failing coverage builders
Message-ID: <0F605D53-2798-4447-8CD2-19857D1A4ED1@twistedmatrix.com>

The python 3.4 coverage builders are failing, apparently because one of the builders is down:

<https://buildbot.twistedmatrix.com/builders/debian7-py3.4-coverage/builds/399/steps/shell_5/logs/stdio <https://buildbot.twistedmatrix.com/builders/debian7-py3.4-coverage/builds/399/steps/shell_5/logs/stdio>>

I'll probably make those builders unsupported later today if there is no obvious fix; at this point, depending on codecov is mostly just a net negative.  We can't have it reasonably fail our builds or report status for us, and "coverage html" produces perfectly usable coverage reports, and so the main consequence is that our builds will fail if they're down (or if they introduce a version of coverage on PyPI that doesn't support python 3, apparently?)

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150806/0edf8db7/attachment.html>

From jcraig at gsacrd.ab.ca  Thu Aug  6 12:32:35 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Thu, 06 Aug 2015 12:32:35 -0600
Subject: [Twisted-Python] failing coverage builders
Message-ID: <fc.000f81d802d8d3343b9aca0066f9854c.2d8d335@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150806/efbaf705/attachment.html>

From hawkowl at atleastfornow.net  Thu Aug  6 17:32:55 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Fri, 7 Aug 2015 09:32:55 +1000
Subject: [Twisted-Python] failing coverage builders
In-Reply-To: <0F605D53-2798-4447-8CD2-19857D1A4ED1@twistedmatrix.com>
References: <0F605D53-2798-4447-8CD2-19857D1A4ED1@twistedmatrix.com>
Message-ID: <48C82447-E39B-4A32-B2BF-FCD4D954270D@atleastfornow.net>

Hi Glyph,

I'll take a look.

I find the combined codecov rather valuable for figuring out what isn't covered on either, but I'll remove it for now.

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

> On 7 Aug 2015, at 04:32, Glyph <glyph at twistedmatrix.com> wrote:
> 
> The python 3.4 coverage builders are failing, apparently because one of the builders is down:
> 
> <https://buildbot.twistedmatrix.com/builders/debian7-py3.4-coverage/builds/399/steps/shell_5/logs/stdio>
> 
> I'll probably make those builders unsupported later today if there is no obvious fix; at this point, depending on codecov is mostly just a net negative.  We can't have it reasonably fail our builds or report status for us, and "coverage html" produces perfectly usable coverage reports, and so the main consequence is that our builds will fail if they're down (or if they introduce a version of coverage on PyPI that doesn't support python 3, apparently?)
> 
> -glyph
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150807/057e8afa/attachment.pgp>

From glyph at twistedmatrix.com  Thu Aug  6 22:11:33 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 6 Aug 2015 21:11:33 -0700
Subject: [Twisted-Python] failing coverage builders
In-Reply-To: <48C82447-E39B-4A32-B2BF-FCD4D954270D@atleastfornow.net>
References: <0F605D53-2798-4447-8CD2-19857D1A4ED1@twistedmatrix.com>
 <48C82447-E39B-4A32-B2BF-FCD4D954270D@atleastfornow.net>
Message-ID: <C6850B10-200E-40C8-94E6-96BC09F687A2@twistedmatrix.com>

> On Aug 6, 2015, at 4:32 PM, Amber Hawkie Brown <hawkowl at atleastfornow.net> wrote:
> 
> Hi Glyph,
> 
> I'll take a look.
> 
> I find the combined codecov rather valuable for figuring out what isn't covered on either, but I'll remove it for now.

I already removed it earlier, so that should be easy :-).

Raw coverage can do combining, if we can just ship the files somewhere:

http://nedbatchelder.com/code/coverage/cmd.html#cmd-combining <http://nedbatchelder.com/code/coverage/cmd.html#cmd-combining>

But, perhaps we should just not fail the build if codecov submission fails.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150806/e7c555bf/attachment.html>

From chris.norman2 at googlemail.com  Sat Aug  8 06:07:58 2015
From: chris.norman2 at googlemail.com (Chris Norman)
Date: Sat, 8 Aug 2015 13:07:58 +0100
Subject: [Twisted-Python] Blacklisting hosts
Message-ID: <55C5F11E.5060401@googlemail.com>

Hi all,
I am using Twisted to make a game server. I want to be able to ban IP 
addresses. Currently I check if the host is in a blacklist, and if it 
is, call abortConnection on the transport. It works fine, but I'm 
thinking there should be a better way, to actively refuse the connection 
in the first place?

Cheers,


From jcraig at gsacrd.ab.ca  Sat Aug  8 06:08:42 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Sat, 08 Aug 2015 06:08:42 -0600
Subject: [Twisted-Python] Blacklisting hosts
Message-ID: <fc.000f81d802d8ec903b9aca00796b829d.2d8ec91@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150808/ba7160d7/attachment.html>

From trac at twistedmatrix.com  Sun Aug  9 00:05:19 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 09 Aug 2015 06:05:19 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1439100319.94.2725727957563287613@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150809/95758a70/attachment.html>

From jcraig at gsacrd.ab.ca  Sun Aug  9 00:05:45 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Sun, 09 Aug 2015 00:05:45 -0600
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: <fc.000f81d802d8f52b3b9aca00d6a0e623.2d8f52c@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150809/c8d57df2/attachment.html>

From hawkowl at atleastfornow.net  Sun Aug  9 03:41:13 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Sun, 9 Aug 2015 17:41:13 +0800
Subject: [Twisted-Python] Updates on the Twisted Buildbots
Message-ID: <EF5EDAF8-1785-42B0-AA03-AA61520DD402@atleastfornow.net>

Hi everyone,

If you haven't looked at the buildbots for a while, there's been some changes! (for brevity's sake, unsupported builders will be prefixed with a U, eg "U2.7")

- Fedora 17 (2.7), 18 (2.7), 19 (2.7, 3.3), and RHEL6 (2.6) are removed, and replaced by RHEL7 (2.7), Fedora 21 (2.7, 3.4), Fedora 22 (U2.7, U3.4, to be fixed very soon, UPyPy2.4). RHEL6 will return with the 2.7 EPEL soon.
- FreeBSD 10.1 is supported on both Py2.7 and Py3.4.
- OS X 10.6 has been removed and OSX 10.10 has been added (2.7-select supported, kqueue and cfreactor both unsupported)
- Ubuntu 15.04 is now a supported platform (2.7, 3.4) and has unsupported PyPy (2.5) and Jython (2.7) builders.
- All of the builders (excepting Windows) are built and ran in a virtualenv. This means that they have up-to-date dependencies, and if Twisted gains dependencies, the infra team can add them to the build process easily.

Twisted Regards,

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150809/a81e17ea/attachment.pgp>

From cory at lukasa.co.uk  Sun Aug  9 10:07:09 2015
From: cory at lukasa.co.uk (Cory Benfield)
Date: Sun, 9 Aug 2015 12:07:09 -0400
Subject: [Twisted-Python] Blacklisting hosts
In-Reply-To: <55C5F11E.5060401@googlemail.com>
References: <55C5F11E.5060401@googlemail.com>
Message-ID: <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>


> On 8 Aug 2015, at 08:07, Chris Norman <chris.norman2 at googlemail.com> wrote:
> 
> Hi all,
> I am using Twisted to make a game server. I want to be able to ban IP addresses. Currently I check if the host is in a blacklist, and if it is, call abortConnection on the transport. It works fine, but I'm thinking there should be a better way, to actively refuse the connection in the first place?

I am not aware of any hook in the BSD socket API that lets you refuse a connection entirely. Generally, you put a socket into ?listen? mode (indicating to the OS that you?ll accept new connections), and then you call accept() to get the new connection. In fact, the OS will accept the connection even before you call accept(): it?ll do it asynchronously, and you will just get the FD for the connection. IIRC Windows has a winsock specific thing that might do what you want, but that?s pretty platform specific and probably doesn?t actually prevent the connection getting established anyway.

If you really want to never allow the connection at all, you?ll probably want to program iptables (or some other firewall if you aren?t on Linux) to do the packet filtering for you. A combination of iptables and ipsets will get you a high-performance IP address blacklist that will drop all packets before they ever reach your application.

Cory


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150809/6d3dfe45/attachment.pgp>

From glyph at twistedmatrix.com  Sun Aug  9 20:32:12 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 9 Aug 2015 19:32:12 -0700
Subject: [Twisted-Python] Blacklisting hosts
In-Reply-To: <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
References: <55C5F11E.5060401@googlemail.com>
 <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
Message-ID: <48F21158-0E0F-49B3-A57E-792AEDF8F252@twistedmatrix.com>


> On Aug 9, 2015, at 9:07 AM, Cory Benfield <cory at lukasa.co.uk> wrote:
> 
> 
>> On 8 Aug 2015, at 08:07, Chris Norman <chris.norman2 at googlemail.com> wrote:
>> 
>> Hi all,
>> I am using Twisted to make a game server. I want to be able to ban IP addresses. Currently I check if the host is in a blacklist, and if it is, call abortConnection on the transport. It works fine, but I'm thinking there should be a better way, to actively refuse the connection in the first place?
> 
> I am not aware of any hook in the BSD socket API that lets you refuse a connection entirely. Generally, you put a socket into ?listen? mode (indicating to the OS that you?ll accept new connections), and then you call accept() to get the new connection. In fact, the OS will accept the connection even before you call accept(): it?ll do it asynchronously, and you will just get the FD for the connection. IIRC Windows has a winsock specific thing that might do what you want, but that?s pretty platform specific and probably doesn?t actually prevent the connection getting established anyway.
> 
> If you really want to never allow the connection at all, you?ll probably want to program iptables (or some other firewall if you aren?t on Linux) to do the packet filtering for you. A combination of iptables and ipsets will get you a high-performance IP address blacklist that will drop all packets before they ever reach your application.


There is a shortcut in Twisted, at least, although it does not actually refuse the initial connection for the reasons listed above; you can examine the "addr" passed to IProtocolFactory.buildProtocol and return None.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150809/01dcad9e/attachment.html>

From itamar at itamarst.org  Mon Aug 10 12:59:17 2015
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 10 Aug 2015 14:59:17 -0400
Subject: [Twisted-Python] ANN: Eliot 0.8, the logging system with causality
Message-ID: <e689c90d540cdae211b664254731d168@itamarst.org>

 
Most logging systems can tell you what happened; Eliot tells you _why_
it happened:

$ python linkcheck.py | eliot-tree
4c42a789-76f5-4f0b-b154-3dd0e3041445
+-- check_links at 1/started
 `-- urls: [u'http://google.com', u'http://nosuchurl']
 +-- download at 2,1/started
 `-- url: http://google.com
 +-- download at 2,2/succeeded
 +-- download at 3,1/started
 `-- url: http://nosuchurl
 +-- download at 3,2/failed
 |-- exception: requests.exceptions.ConnectionError
 |-- reason: ('Conn aborted', gaierror(-2, 'Name unknown'))
 +-- check_links at 4/failed
 |-- exception: exceptions.ValueError
 |-- reason: ('Conn aborted.', gaierror(-2, 'Name unknown'))
 And here's the code that generated these logs (eliot-tree [1] was used
to render the output):

import sys
from eliot import start_action, to_file
import requests
to_file(sys.stdout)

def check_links(urls):
 with start_action(action_type="check_links", urls=urls):
 for url in urls:
 try:
 with start_action(action_type="download", url=url):
 response = requests.get(url)
 response.raise_for_status()
 except Exception as e:
 raise ValueError(str(e))

check_links(["http://google.com"], ["http://nosuchurl"])

Interested? Read more at https://eliot.readthedocs.org/ [2].

Eliot is released under the Apache License 2 by ClusterHQ [3], the
Container Data People. We're hiring! [4]
 

Links:
------
[1] https://warehouse.python.org/project/eliot-tree/
[2] https://eliot.readthedocs.org/
[3] https://clusterhq.com
[4] https://clusterhq.com/careers/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150810/3a04cb5a/attachment.html>

From jcraig at gsacrd.ab.ca  Mon Aug 10 12:59:48 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Mon, 10 Aug 2015 12:59:48 -0600
Subject: [Twisted-Python] ANN: Eliot 0.8,
	the logging system with causality
Message-ID: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150810/fa48ebcb/attachment.html>

From chris.norman2 at googlemail.com  Mon Aug 10 15:40:21 2015
From: chris.norman2 at googlemail.com (Chris Norman)
Date: Mon, 10 Aug 2015 22:40:21 +0100
Subject: [Twisted-Python] Blacklisting hosts
In-Reply-To: <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
References: <55C5F11E.5060401@googlemail.com>
 <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
Message-ID: <090FAA74-322A-4CDB-9FBF-280B12F4814E@googlemail.com>

Hello,
> On 9 Aug 2015, at 17:07, Cory Benfield <cory at lukasa.co.uk> wrote:
> 
> 
>> On 8 Aug 2015, at 08:07, Chris Norman <chris.norman2 at googlemail.com> wrote:
>> 
>> Hi all,
>> I am using Twisted to make a game server. I want to be able to ban IP addresses. Currently I check if the host is in a blacklist, and if it is, call abortConnection on the transport. It works fine, but I'm thinking there should be a better way, to actively refuse the connection in the first place?
> 
> I am not aware of any hook in the BSD socket API that lets you refuse a connection entirely. Generally, you put a socket into ?listen? mode (indicating to the OS that you?ll accept new connections), and then you call accept() to get the new connection. In fact, the OS will accept the connection even before you call accept(): it?ll do it asynchronously, and you will just get the FD for the connection. IIRC Windows has a winsock specific thing that might do what you want, but that?s pretty platform specific and probably doesn?t actually prevent the connection getting established anyway.
> 
> If you really want to never allow the connection at all, you?ll probably want to program iptables (or some other firewall if you aren?t on Linux) to do the packet filtering for you. A combination of iptables and ipsets will get you a high-performance IP address blacklist that will drop all packets before they ever reach your application.

Thanks for that. I was sort of hoping for a Pythonic solution that doesn't rely on SubProcess ETC, particularly as I want this server to run on any OS you throw at it. Thanks for the idea though, I'll certainly use that if I get something that little Python can't handle.
> 
> Cory
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From chris.norman2 at googlemail.com  Mon Aug 10 15:43:31 2015
From: chris.norman2 at googlemail.com (Chris Norman)
Date: Mon, 10 Aug 2015 22:43:31 +0100
Subject: [Twisted-Python] Blacklisting hosts
In-Reply-To: <48F21158-0E0F-49B3-A57E-792AEDF8F252@twistedmatrix.com>
References: <55C5F11E.5060401@googlemail.com>
 <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
 <48F21158-0E0F-49B3-A57E-792AEDF8F252@twistedmatrix.com>
Message-ID: <976F95AC-9578-4E6B-A710-87EDD1181E98@googlemail.com>

Hello,

> On 10 Aug 2015, at 03:32, Glyph <glyph at twistedmatrix.com> wrote:
> 
>> 
>> On Aug 9, 2015, at 9:07 AM, Cory Benfield <cory at lukasa.co.uk <mailto:cory at lukasa.co.uk>> wrote:
>> 
>> 
>>> On 8 Aug 2015, at 08:07, Chris Norman <chris.norman2 at googlemail.com <mailto:chris.norman2 at googlemail.com>> wrote:
>>> 
>>> Hi all,
>>> I am using Twisted to make a game server. I want to be able to ban IP addresses. Currently I check if the host is in a blacklist, and if it is, call abortConnection on the transport. It works fine, but I'm thinking there should be a better way, to actively refuse the connection in the first place?
>> 
>> I am not aware of any hook in the BSD socket API that lets you refuse a connection entirely. Generally, you put a socket into ?listen? mode (indicating to the OS that you?ll accept new connections), and then you call accept() to get the new connection. In fact, the OS will accept the connection even before you call accept(): it?ll do it asynchronously, and you will just get the FD for the connection. IIRC Windows has a winsock specific thing that might do what you want, but that?s pretty platform specific and probably doesn?t actually prevent the connection getting established anyway.
>> 
>> If you really want to never allow the connection at all, you?ll probably want to program iptables (or some other firewall if you aren?t on Linux) to do the packet filtering for you. A combination of iptables and ipsets will get you a high-performance IP address blacklist that will drop all packets before they ever reach your application.
> 
> 
> There is a shortcut in Twisted, at least, although it does not actually refuse the initial connection for the reasons listed above; you can examine the "addr" passed to IProtocolFactory.buildProtocol and return None.

This is perfect, thanks. It would have been better to refuse the connection entirely, but as Corey said, I can use iptables if I get desperate.

> 
> -glyph
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com <mailto:Twisted-Python at twistedmatrix.com>
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python <http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150810/ed169a1c/attachment.html>

From dstainton415 at gmail.com  Tue Aug 11 04:46:09 2015
From: dstainton415 at gmail.com (David Stainton)
Date: Tue, 11 Aug 2015 03:46:09 -0700
Subject: [Twisted-Python] please can haz code review -> Tor-ified Twisted
 Python HTTP proxy server - txtorhttpproxy
Message-ID: <CAFN1edrfiV-BFBt6YNV1QvmfFca19LsnmdrUpGGppX4A_5e+fQ@mail.gmail.com>

Dear Twisted/Tor developers,

I am motivated by language security concerns. I think Twisted Python
can often implement excellent replacements for our old crufty C
implementations. In this case I'd like to stop using C programs
running as root (or not root) to torify http connections... like
privoxy, polipo, apt tor transport etc.

Last year I wrote this little tor http proxy; yes it also handles RFC
2817 proxy CONNECT method as well:
https://github.com/david415/txtorhttpproxy

I wrote an AgentProxy that can proxy any sort of twisted http agent:
https://github.com/david415/txtorhttpproxy/blob/master/txtorhttpproxy/proxy.py

It used to use more terrible underscore imports but Leif fixed the
bit-rot and made it work with Twisted 15:
https://github.com/david415/txtorhttpproxy/commit/38f1a0cfab586f7a8965a47e9c8f951b351426a2

Is this project worthy of your precious 10 minutes to review it... so
I can improve the code quality?

If I get rid of this last terrible import:
from twisted.web._newclient import ResponseDone

then I'm not sure how to detect when to call the finish() method here:
https://github.com/david415/txtorhttpproxy/blob/master/txtorhttpproxy/proxy.py#L38-L52


Sincerely,
David Stainton


From jcraig at gsacrd.ab.ca  Tue Aug 11 04:46:33 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Tue, 11 Aug 2015 04:46:33 -0600
Subject: [Twisted-Python] please can haz code review -> Tor-ified
	Twisted Python HTT
Message-ID: <fc.000f81d802d913223b9aca0060ef6c0a.2d91323@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150811/059ae629/attachment.html>

From p.mayers at imperial.ac.uk  Tue Aug 11 09:33:23 2015
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 11 Aug 2015 16:33:23 +0100
Subject: [Twisted-Python] List admin attention
In-Reply-To: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
References: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
Message-ID: <55CA15C3.1060409@imperial.ac.uk>

Someone please un-sub this person?


-------- Forwarded Message --------
Subject: 	Re: [Twisted-Python] ANN: Eliot 0.8, the logging system with
causality
Date: 	Mon, 10 Aug 2015 12:59:48 -0600
From: 	Judy Craig <jcraig at gsacrd.ab.ca>
Reply-To: 	Twisted general discussion <twisted-python at twistedmatrix.com>
To: 	twisted-python at twistedmatrix.com



This is an automatic reply. I am away from the office for the summer,
returning on Tuesday, August 25, 2015.  I will be happy to get back to
you then.

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are
intended solely for the use of the individual or entity to whom they are
addressed. If you have received this email in error please notify the
system manager. If you are not the named addressee you should not
disseminate, distribute or copy this email.


-------------- next part --------------
_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From glyph at twistedmatrix.com  Tue Aug 11 14:48:41 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Tue, 11 Aug 2015 13:48:41 -0700
Subject: [Twisted-Python] List admin attention
In-Reply-To: <55CA15C3.1060409@imperial.ac.uk>
References: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
 <55CA15C3.1060409@imperial.ac.uk>
Message-ID: <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>

> On Aug 11, 2015, at 8:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:
> 
> Someone please un-sub this person?

If I've done my job right this message will not receive an autoreply...

-glyph



From todd.ulrich at cogeco.ca  Tue Aug 11 14:55:33 2015
From: todd.ulrich at cogeco.ca (J Todd Ulrich)
Date: Tue, 11 Aug 2015 16:55:33 -0400
Subject: [Twisted-Python] List admin attention
In-Reply-To: <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>
References: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
 <55CA15C3.1060409@imperial.ac.uk>
 <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>
Message-ID: <20150811205533.6660179.49832.2313@cogeco.ca>

Yes please remove.

Walk?Tall.?

J?Todd?Ulrich
m.?416.625.3209?

Please?excuse?brevity?as?this message?sent?from?my?BlackBerry 10?smartphone?on?the?Rogers network.
? Original Message ?
From: Glyph
Sent: Tuesday, August 11, 2015 4:49 PM
To: Twisted general discussion
Reply To: Twisted general discussion
Subject: Re: [Twisted-Python] List admin attention

> On Aug 11, 2015, at 8:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:
> 
> Someone please un-sub this person?

If I've done my job right this message will not receive an autoreply...

-glyph


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From glyph at twistedmatrix.com  Tue Aug 11 16:24:10 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Tue, 11 Aug 2015 15:24:10 -0700
Subject: [Twisted-Python] incompatible change in 15.3 - something reviewers
	should look for
Message-ID: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>

In https://twistedmatrix.com/trac/changeset/45163 twisted.internet.application.service.Service to be a new-style class.  Just to remind everyone, converting an old-style class to a new-style class is an incompatible change, and reviewers should look for this.

We discovered this because this change breaks https://github.com/twisted/axiom, and probably it breaks other packages as well, since lots of things inherit from Service.  So please remain diligent about looking for this in future changes.  Now that it's been changed, reverting it in 15.4 would be another incompatible change, so we probably won't do that, but please keep an eye out in the future.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150811/2c85439a/attachment.html>

From _ at habnab.it  Tue Aug 11 23:06:02 2015
From: _ at habnab.it (Aaron Gallagher)
Date: Tue, 11 Aug 2015 22:06:02 -0700
Subject: [Twisted-Python] please can haz code review -> Tor-ified
	Twisted Python HTTP proxy server - txtorhttpproxy
In-Reply-To: <CAFN1edrfiV-BFBt6YNV1QvmfFca19LsnmdrUpGGppX4A_5e+fQ@mail.gmail.com>
References: <CAFN1edrfiV-BFBt6YNV1QvmfFca19LsnmdrUpGGppX4A_5e+fQ@mail.gmail.com>
Message-ID: <m21tf985ad.fsf@ender.habnabit.org>

David Stainton <dstainton415 at gmail.com> writes:

> If I get rid of this last terrible import:
> from twisted.web._newclient import ResponseDone
>
> then I'm not sure how to detect when to call the finish() method here:
> https://github.com/david415/txtorhttpproxy/blob/master/txtorhttpproxy/proxy.py#L38-L52

Fortunately, ResponseDone is re-exported by twisted.web.client:
             
    >>> import twisted.web.client
    >>> twisted.web.client.ResponseDone is twisted.web._newclient.ResponseDone
    True
    >>> twisted.__version__
    '11.0.0'

I couldn't get 9.0 to compile in the five seconds I tried, but 11.0 is
still pretty old. I think it always was re-exported like this.


From adi at roiban.ro  Wed Aug 12 00:24:46 2015
From: adi at roiban.ro (Adi Roiban)
Date: Wed, 12 Aug 2015 09:24:46 +0300
Subject: [Twisted-Python] incompatible change in 15.3 - something
 reviewers should look for
In-Reply-To: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>
References: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>
Message-ID: <CAFycZ9d0wmdfX76qB5WwNDruLcBoUXjw_vSwWLyew9P_+cPyOw@mail.gmail.com>

Hi,

Thanks for the notice!

On 12 August 2015 at 01:24, Glyph <glyph at twistedmatrix.com> wrote:
> In https://twistedmatrix.com/trac/changeset/45163
> twisted.internet.application.service.Service to be a new-style class.  Just
> to remind everyone, converting an old-style class to a new-style class is an
> incompatible change, and reviewers should look for this.

I have updated the wiki page to include this note and the reason why
we need this.

https://twistedmatrix.com/trac/wiki/Plan/Python3#Reviewerchecklist

Please check that wiki page is ok.

In my defense :)
Amber warned me about such changes, but when I asked (over IRC) why
they are bad I did received any convincing reason :)

> We discovered this because this change breaks
> https://github.com/twisted/axiom, and probably it breaks other packages as
> well, since lots of things inherit from Service.  So please remain diligent
> about looking for this in future changes.  Now that it's been changed,
> reverting it in 15.4 would be another incompatible change, so we probably
> won't do that, but please keep an eye out in the future.

I assume that this is the error in axiom:
https://github.com/twisted/axiom/issues/44

In axiom a class was defined as

class _SiteScheduler(object, Service, SchedulerMixin)

Is this a common practice?
Why do you want to have multiple inheritance and put object as the
first inherited class and not the last one?

Regards,
-- 
Adi Roiban


From jcraig at gsacrd.ab.ca  Wed Aug 12 00:25:25 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Wed, 12 Aug 2015 00:25:25 -0600
Subject: [Twisted-Python] incompatible change in 15.3 - something
	reviewers shoul
Message-ID: <fc.000f81d802d92fa93b9aca003ae328bd.2d92faa@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150812/419ba9aa/attachment.html>

From jml at mumak.net  Wed Aug 12 04:46:11 2015
From: jml at mumak.net (Jonathan Lange)
Date: Wed, 12 Aug 2015 10:46:11 +0000
Subject: [Twisted-Python] incompatible change in 15.3 - something
 reviewers should look for
In-Reply-To: <CAFycZ9d0wmdfX76qB5WwNDruLcBoUXjw_vSwWLyew9P_+cPyOw@mail.gmail.com>
References: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>
 <CAFycZ9d0wmdfX76qB5WwNDruLcBoUXjw_vSwWLyew9P_+cPyOw@mail.gmail.com>
Message-ID: <CAHZ8tnbER9NH67eebRpDQN2MpvRHXRTMRKnRz302vQxXi_Rjbw@mail.gmail.com>

On Wed, 12 Aug 2015 at 07:25 Adi Roiban <adi at roiban.ro> wrote:

> On 12 August 2015 at 01:24, Glyph <glyph at twistedmatrix.com> wrote:
>
> > We discovered this because this change breaks
> > https://github.com/twisted/axiom, and probably it breaks other packages
> as
> > well, since lots of things inherit from Service.  So please remain
> diligent
> > about looking for this in future changes.  Now that it's been changed,
> > reverting it in 15.4 would be another incompatible change, so we probably
> > won't do that, but please keep an eye out in the future.
>
> I assume that this is the error in axiom:
> https://github.com/twisted/axiom/issues/44
>
> In axiom a class was defined as
>
> class _SiteScheduler(object, Service, SchedulerMixin)
>
> Is this a common practice?
> Why do you want to have multiple inheritance and put object as the
> first inherited class and not the last one?
>
>
>From the perspective of Twisted development, why does it matter?

Changing a class from old style to new style changes the method resolution
order, which is going to break lots of code in ways that we can't
anticipate. We can't find every subclass and judge whether their usage
makes sense. We can only stick to our compatibility policy
<https://twistedmatrix.com/trac/wiki/CompatibilityPolicy>, which empowers
users to decide when & how they change their weird code.

jml
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150812/ac50b773/attachment.html>

From dreid at dreid.org  Wed Aug 12 13:08:17 2015
From: dreid at dreid.org (David Reid)
Date: Wed, 12 Aug 2015 12:08:17 -0700
Subject: [Twisted-Python] Proposal -- Code of Conduct
In-Reply-To: <1437370109.2951691.327871321.7C3B3246@webmail.messagingengine.com>
References: <CAOA_4jBv3vv=pYcte7gQ6E8YjKzfBe+1HsPazYak4G=wJtxSgw@mail.gmail.com>
 <35B97E96-E041-4D40-BE37-F6F5C18C4503@twistedmatrix.com>
 <16FF9D27-2329-45EB-B270-96479A5B6395@ox.cx>
 <CA6CAF88-3CF6-4A9F-B38E-746694E9C89E@atleastfornow.net>
 <CAPkN8x+jnEuM-NU8C0fPqO0bQ+tp=s8H4MNvH8LRrrzVhCfrtw@mail.gmail.com>
 <CAOA_4jCf-bmtfNK1CLyo_-AgWYrmUt48hKc-Kg+CXDBw0oR5WQ@mail.gmail.com>
 <1435177502.2290262.306874953.7CCB7A44@webmail.messagingengine.com>
 <CAOA_4jB-Ut-B4DsWuTs-HHexk_J-_B-Jiu4fN46i8SaCaRv0qQ@mail.gmail.com>
 <1437370109.2951691.327871321.7C3B3246@webmail.messagingengine.com>
Message-ID: <CA+t4payXWnhFfjocsweTHO-RQ6xCeC6GqnfefULbYWEXumbsOA@mail.gmail.com>

What needs to happen to move this proposal forward?

-David

On Sun, Jul 19, 2015 at 10:28 PM, Kevin Turner <keturn at keturn.net> wrote:

> I was chatting with some people at the Community Leadership Summit today
> about the Recurse Center's social rules
> <https://www.recurse.com/manual#sec-environment>, which reminded me of
> this thread. What's the status of this proposal?
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150812/e99dd555/attachment.html>

From glyph at twistedmatrix.com  Wed Aug 12 13:17:28 2015
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Aug 2015 12:17:28 -0700
Subject: [Twisted-Python] incompatible change in 15.3 - something
	reviewers should look for
In-Reply-To: <CAHZ8tnbER9NH67eebRpDQN2MpvRHXRTMRKnRz302vQxXi_Rjbw@mail.gmail.com>
References: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>
 <CAFycZ9d0wmdfX76qB5WwNDruLcBoUXjw_vSwWLyew9P_+cPyOw@mail.gmail.com>
 <CAHZ8tnbER9NH67eebRpDQN2MpvRHXRTMRKnRz302vQxXi_Rjbw@mail.gmail.com>
Message-ID: <F41C3AE8-CE1F-410F-8BA8-4A702229BEE6@twistedmatrix.com>


> On Aug 12, 2015, at 3:46 AM, Jonathan Lange <jml at mumak.net> wrote:
> 
> From the perspective of Twisted development, why does it matter? 

The one reason that it matters is that we need to consistently tell users how to prepare for the fact that eventually, everything will be new-style.  Perhaps it will only be new-style because we eventually drop python 2, perhaps it will only be new-style because python 2.8 will deprecate classic classes, perhaps we will eventually have a flag day just to reduce the maintenance burden, perhaps each old-style class will be individually deprecated and replaced with a new-style one.  In any case, the migration will be much easier for users if they learn now that putting 'object' at the end of their bases list is a way to avoid caring about this issue entirely :).

Otherwise I agree completely with your sentiment.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150812/ee86cd24/attachment.html>

From glyph at twistedmatrix.com  Wed Aug 12 13:39:14 2015
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Aug 2015 12:39:14 -0700
Subject: [Twisted-Python] List admin attention
In-Reply-To: <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>
References: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
 <55CA15C3.1060409@imperial.ac.uk>
 <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>
Message-ID: <9B47E7B5-4C3E-4A3F-8859-70C3D6D8595A@twistedmatrix.com>


> On Aug 11, 2015, at 1:48 PM, Glyph <glyph at twistedmatrix.com> wrote:
> 
>> On Aug 11, 2015, at 8:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:
>> 
>> Someone please un-sub this person?
> 
> If I've done my job right this message will not receive an autoreply...

OK, I apparently didn't do it correctly, but hopefully this time it stuck ...

-glyph



From dstainton415 at gmail.com  Thu Aug 13 05:58:01 2015
From: dstainton415 at gmail.com (David Stainton)
Date: Thu, 13 Aug 2015 13:58:01 +0200
Subject: [Twisted-Python] please can haz code review -> Tor-ified
 Twisted Python HTTP proxy server - txtorhttpproxy
In-Reply-To: <m21tf985ad.fsf@ender.habnabit.org>
References: <CAFN1edrfiV-BFBt6YNV1QvmfFca19LsnmdrUpGGppX4A_5e+fQ@mail.gmail.com>
 <m21tf985ad.fsf@ender.habnabit.org>
Message-ID: <CAFN1edruPvC-OHH1aRpr=gegJsdvP74pOyppCCmrJ1=Q_bNw6w@mail.gmail.com>

Dear Aaon Gallagher,

Thanks for the helpful observation. i'm going to make the correction
soon and then we'll be underscore free.

On Wed, Aug 12, 2015 at 7:06 AM, Aaron Gallagher <_ at habnab.it> wrote:
> David Stainton <dstainton415 at gmail.com> writes:
>
>> If I get rid of this last terrible import:
>> from twisted.web._newclient import ResponseDone
>>
>> then I'm not sure how to detect when to call the finish() method here:
>> https://github.com/david415/txtorhttpproxy/blob/master/txtorhttpproxy/proxy.py#L38-L52
>
> Fortunately, ResponseDone is re-exported by twisted.web.client:
>
>     >>> import twisted.web.client
>     >>> twisted.web.client.ResponseDone is twisted.web._newclient.ResponseDone
>     True
>     >>> twisted.__version__
>     '11.0.0'
>
> I couldn't get 9.0 to compile in the five seconds I tried, but 11.0 is
> still pretty old. I think it always was re-exported like this.


From glyph at twistedmatrix.com  Fri Aug 14 17:32:44 2015
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 14 Aug 2015 16:32:44 -0700
Subject: [Twisted-Python] twisted on jython
Message-ID: <B58DAA66-2ED9-421D-AE7A-D38EB9CCB375@twistedmatrix.com>

We currently have an unsupported builder for Jython 2.7: <https://buildbot.twistedmatrix.com/builders/ubuntu15.04-jython2.7 <https://buildbot.twistedmatrix.com/builders/ubuntu15.04-jython2.7>>

This is great, so that we can fix issues that make Twisted not support Jython, but some of the bugs that are causing it not to work may be on the Jython side as well.

Hawkowl, would it be possible to set up a Jython trunk builder?  This will remain unsupported, of course, but it would give the Jython developers the ability to see how changes they make are affecting Twisted's progress to a supported version - and possibly cut a release on their end if it turns green ;).

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150814/5f221fbe/attachment.html>

From trac at twistedmatrix.com  Sun Aug 16 00:05:24 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 16 Aug 2015 06:05:24 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1439705124.74.1348520945978281250@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150816/d190a686/attachment.html>

From trac at twistedmatrix.com  Sun Aug 23 00:05:17 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 23 Aug 2015 06:05:17 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1440309917.29.3103257785345805269@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150823/b5a84bb5/attachment.html>

From peter.westlake at pobox.com  Tue Aug 25 10:27:34 2015
From: peter.westlake at pobox.com (Peter Westlake)
Date: Tue, 25 Aug 2015 17:27:34 +0100
Subject: [Twisted-Python] Screen clearing in the Manhole
Message-ID: <1440520054.2262163.365674993.6595850F@webmail.messagingengine.com>

I'm making a manhole service in the usual way:

class PF(ServerProtocol):??????? def protocolFactory(*a, **kw):
return manhole.Manhole(namespace)

realm = manhole_ssh.TerminalRealm()??? realm.chainedProtocolFactory = PF
mh_portal = portal.Portal(realm)??? mh_portal.registerChecker(checker)

manhole_service = TCPServer(0, manhole_ssh.ConchFactory(mh_portal))
manhole_service.startService()

and I'd like to print a message when the terminal is opened. This
change does it:

class PF(ServerProtocol):??????? def protocolFactory(*a, **kw):
class Manhole(manhole.Manhole):??????????????? def connectionMade(self):
super(Manhole, self).connectionMade()
self.terminal.write('Hello')??????????? return
manhole.Manhole(namespace)

and so does this version, which is better because
t.c.i.i.ServerProtocol.connectionMade says it is the place to
write messages:

class PF(ServerProtocol):??????? def protocolFactory(*a, **kw):
return manhole.Manhole(namespace)

def connectionMade(self):??????????? ServerProtocol.connectionMade(self)
self.write('Hello')

But in both cases, after the message the screen is cleared by what looks
like a form feed, and another prompt is printed. So far I can't find
where in the code this happens. Is there a way to print a message and
not have it scrolled off the screen?

Thanks,

Peter.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150825/72e24d69/attachment.html>

From brian.costlow at gmail.com  Tue Aug 25 15:26:27 2015
From: brian.costlow at gmail.com (Brian Costlow)
Date: Tue, 25 Aug 2015 17:26:27 -0400
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <1440520054.2262163.365674993.6595850F@webmail.messagingengine.com>
References: <1440520054.2262163.365674993.6595850F@webmail.messagingengine.com>
Message-ID: <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>

As to where it happens, look at
twisted.conch.recvline.RecvLine.connectionMade() and
twisted.conch.insults.insults.TerminalProtocol.makeConnection()

You could step on the RecvLine. initializeScreen(), but I have no idea what
the side effects are. (And of course if you bypass all or part of it, even
if it works now, it's alway subject to future breakage.

On Tue, Aug 25, 2015 at 12:27 PM, Peter Westlake <peter.westlake at pobox.com>
wrote:

> I'm making a manhole service in the usual way:
>
>     class PF(ServerProtocol):
>         def protocolFactory(*a, **kw):
>             return manhole.Manhole(namespace)
>
>     realm = manhole_ssh.TerminalRealm()
>     realm.chainedProtocolFactory = PF
>     mh_portal = portal.Portal(realm)
>     mh_portal.registerChecker(checker)
>
>     manhole_service = TCPServer(0, manhole_ssh.ConchFactory(mh_portal))
>     manhole_service.startService()
>
> and I'd like to print a message when the terminal is opened. This change
> does it:
>
>     class PF(ServerProtocol):
>         def protocolFactory(*a, **kw):
>             class Manhole(manhole.Manhole):
>                 def connectionMade(self):
>                     super(Manhole, self).connectionMade()
>                     self.terminal.write('Hello')
>             return manhole.Manhole(namespace)
>
> and so does this version, which is better because
> t.c.i.i.ServerProtocol.connectionMade says it is the place to write
> messages:
>
>     class PF(ServerProtocol):
>         def protocolFactory(*a, **kw):
>             return manhole.Manhole(namespace)
>
>         def connectionMade(self):
>             ServerProtocol.connectionMade(self)
>             self.write('Hello')
>
> But in both cases, after the message the screen is cleared by what looks
> like a form feed, and another prompt is printed. So far I can't find where
> in the code this happens. Is there a way to print a message and not have it
> scrolled off the screen?
>
> Thanks,
>
> Peter.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150825/cf915b69/attachment.html>

From JOHN at egh.com  Tue Aug 25 16:58:31 2015
From: JOHN at egh.com (John Santos)
Date: Tue, 25 Aug 2015 18:58:31 -0400
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>
Message-ID: <1150825182032.31305G-100000@joonya.egh.com>



Someone wrote:  (Sorry, reply in my mail client doesn't give me an
editable text version of the mail.  Instead, it is including it as an
attachment.  I don't know why this happens.  I do know from bitter
experience that if I don't delete the attachments from my reply, users
of brain-dead mail clients (I'm looking at you, Outlook) can't see
me reply but just see the attached copy of the original message.  So
I cut and pasted some context so people know what I'm talking about.)

> As to where it happens, look at
> twisted.conch.recvline.RecvLine.connectionMade() and
> twisted.conch.insults.insults.TerminalProtocol.makeConnection()
> 
> You could step on the RecvLine. initializeScreen(), but I have no idea what
> the side effects are. (And of course if you bypass all or part of it, even
> if it works now, it's alway subject to future breakage.
>
> On Tue, Aug 25, 2015 at 12:27 PM, Peter Westlake 
> <peter.westlake at pobox.com> wrote:
> >
> > I'm making a manhole service in the usual way:
[...]

t.c.r.R.connectionMade() calls self.initializeScreen(), which in turn 
calls self.terminal.reset()

I'm pretty sure s.t.reset() is actually twisted.conch.insults.reset(),
which has a bug (or an undesirable feature), it sends a "hard reset"
escape sequence to the terminal (<ESC>c).  This freaks out many terminal
emulators, and real, VT100-compatible terminals, in many different ways.

I've tested in Kermit-95, PuTTy, xterm, DECterm (a VT emulator written for
DECwindows, DEC's X implementation) and on real DEC VT420 and VT520
terminals.  They act differently, but none are pleasant.  For example, a
VT520 does a power-cycle on the CRT (which takes about 10 seconds),
reloads the saved configuration, and (if you have multiple sessions
enabled) switches to Session 1. 

The VT420 and VT520 manuals say about "hard reset", basically, "Don't
do that!!"

I have a patch to change it to send a soft reset (<ESC>[!p) and to set the
terminal into "replace mode" (<ESC>[4l) (sometimes the software thought it
was in overstrike mode, but the terminal thought it was in insert mode,
with bad results. Ideally, it would set both the software and hardware to
what ever mode the user desired.  The hard reset would set the terminal to
whichever mode was stored in its permanent settings.  For a software
terminal emulator, it was a dice roll.)

Depending on the terminal emulator or physical terminal you are using,
this probably explains your symptoms.

See ticket # 7514: https://twistedmatrix.com/trac/ticket/7514

-- 
John Santos
Evans Griffiths & Hart, Inc.
781-861-0670 ext 539

From todd.ulrich at cogeco.ca  Tue Aug 25 17:01:48 2015
From: todd.ulrich at cogeco.ca (J Todd Ulrich)
Date: Tue, 25 Aug 2015 18:01:48 -0500
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <1150825182032.31305G-100000@joonya.egh.com>
References: <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>
 <1150825182032.31305G-100000@joonya.egh.com>
Message-ID: <20150825230148.250654802.96021.559@cogeco.ca>

Can you remove me please. I am in NO WAY affiliated with your organization. Virus?

Walk?Tall.?

J?Todd?Ulrich
m.?416.625.3209

Please?excuse?brevity?as?this?message sent?from?my?BlackBerry?10?smartphone on?the?Rogers?network.
? Original Message ?
From: John Santos
Sent: Tuesday, August 25, 2015 5:58 PM
To: Twisted general discussion
Reply To: Twisted general discussion
Subject: Re: [Twisted-Python] Screen clearing in the Manhole



Someone wrote: (Sorry, reply in my mail client doesn't give me an
editable text version of the mail. Instead, it is including it as an
attachment. I don't know why this happens. I do know from bitter
experience that if I don't delete the attachments from my reply, users
of brain-dead mail clients (I'm looking at you, Outlook) can't see
me reply but just see the attached copy of the original message. So
I cut and pasted some context so people know what I'm talking about.)

> As to where it happens, look at
> twisted.conch.recvline.RecvLine.connectionMade() and
> twisted.conch.insults.insults.TerminalProtocol.makeConnection()
> 
> You could step on the RecvLine. initializeScreen(), but I have no idea what
> the side effects are. (And of course if you bypass all or part of it, even
> if it works now, it's alway subject to future breakage.
>
> On Tue, Aug 25, 2015 at 12:27 PM, Peter Westlake 
> <peter.westlake at pobox.com> wrote:
> >
> > I'm making a manhole service in the usual way:
[...]

t.c.r.R.connectionMade() calls self.initializeScreen(), which in turn 
calls self.terminal.reset()

I'm pretty sure s.t.reset() is actually twisted.conch.insults.reset(),
which has a bug (or an undesirable feature), it sends a "hard reset"
escape sequence to the terminal (<ESC>c). This freaks out many terminal
emulators, and real, VT100-compatible terminals, in many different ways.

I've tested in Kermit-95, PuTTy, xterm, DECterm (a VT emulator written for
DECwindows, DEC's X implementation) and on real DEC VT420 and VT520
terminals. They act differently, but none are pleasant. For example, a
VT520 does a power-cycle on the CRT (which takes about 10 seconds),
reloads the saved configuration, and (if you have multiple sessions
enabled) switches to Session 1. 

The VT420 and VT520 manuals say about "hard reset", basically, "Don't
do that!!"

I have a patch to change it to send a soft reset (<ESC>[!p) and to set the
terminal into "replace mode" (<ESC>[4l) (sometimes the software thought it
was in overstrike mode, but the terminal thought it was in insert mode,
with bad results. Ideally, it would set both the software and hardware to
what ever mode the user desired. The hard reset would set the terminal to
whichever mode was stored in its permanent settings. For a software
terminal emulator, it was a dice roll.)

Depending on the terminal emulator or physical terminal you are using,
this probably explains your symptoms.

See ticket # 7514: https://twistedmatrix.com/trac/ticket/7514

-- 
John Santos
Evans Griffiths & Hart, Inc.
781-861-0670 ext 539


From peter.westlake at pobox.com  Wed Aug 26 05:00:50 2015
From: peter.westlake at pobox.com (Peter Westlake)
Date: Wed, 26 Aug 2015 12:00:50 +0100
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>
References: <1440520054.2262163.365674993.6595850F@webmail.messagingengine.com>
 <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>
Message-ID: <1440586850.3188641.366433553.31489CBD@webmail.messagingengine.com>

On Tue, 25 Aug 2015, at 22:26, Brian Costlow wrote:

> As to where it happens, look at
> twisted.conch.recvline.RecvLine.connectionMade() and
> twisted.conch.insults.insults.TerminalProtocol.makeConnection()

My subclass of Manhole first calls Manhole.connectionMade, which calls
HistoricRecvLine.connectionMade, which calls RecvLine.connectionMade,
which resets the screen exactly as you say. Then, after the screen has
been reset, I print the message. But then the screen is cleared a
second time!

Peter.


From peter.westlake at pobox.com  Wed Aug 26 05:04:20 2015
From: peter.westlake at pobox.com (Peter Westlake)
Date: Wed, 26 Aug 2015 12:04:20 +0100
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <1150825182032.31305G-100000@joonya.egh.com>
References: <1150825182032.31305G-100000@joonya.egh.com>
Message-ID: <1440587060.3189439.366444017.5DDA86F9@webmail.messagingengine.com>

On Tue, 25 Aug 2015, at 23:58, John Santos wrote:
...
> t.c.r.R.connectionMade() calls self.initializeScreen(), which in turn 
> calls self.terminal.reset()
> 
> I'm pretty sure s.t.reset() is actually twisted.conch.insults.reset(),
> which has a bug (or an undesirable feature), it sends a "hard reset"
> escape sequence to the terminal (<ESC>c).  This freaks out many terminal
> emulators, and real, VT100-compatible terminals, in many different ways.
...
> Depending on the terminal emulator or physical terminal you are using,
> this probably explains your symptoms.
> 
> See ticket # 7514: https://twistedmatrix.com/trac/ticket/7514

This does sound like a scary bug, especially on a real terminal, but I
tried your patch and it didn't affect my symptom of the screen being
cleared again. That's more about "when" rather than "how".

Peter.


From peter.westlake at pobox.com  Wed Aug 26 06:46:38 2015
From: peter.westlake at pobox.com (Peter Westlake)
Date: Wed, 26 Aug 2015 13:46:38 +0100
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <1440587060.3189439.366444017.5DDA86F9@webmail.messagingengine.com>
References: <1150825182032.31305G-100000@joonya.egh.com>
 <1440587060.3189439.366444017.5DDA86F9@webmail.messagingengine.com>
Message-ID: <1440593198.3213954.366517025.05E3E190@webmail.messagingengine.com>

I found it!

Manhole.terminalSize, inherited from RecvLine, does
self.terminal.eraseDisplay(). 
t.c.manhole_ssh.TerminalSessionTransport.__init__ calls terminalSize
*after* makeConnection.

Since setting the terminal size is a sensible thing to do, and it can't
be done before the connection is made, I'm not sure that much can be
done about this. I was able to make my message stay visible by
overriding terminalSize with a version that didn't erase, but that isn't
very clean or general.

Peter.


From hawkowl at atleastfornow.net  Thu Aug 27 06:28:46 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Thu, 27 Aug 2015 20:28:46 +0800
Subject: [Twisted-Python] Twisted 15.4.0pre1 Prerelease Announcement
Message-ID: <8D500168-E7FE-4EDF-874E-B82E0AB60B89@atleastfornow.net>

Hello everyone!

Another few months, another Twisted release. This one has a few more Py3 goodies in it!

- twisted.positioning, the rest of twisted.internet.endpoints, KQueueReactor (for real this time), twisted.web.proxy/guard, and Trial (!!!) have all been ported to Python 3.
- Twisted officially supports several more platforms: Py3.4 on FreeBSD, Py2.7/Py3.4 on Fedora 21/22, and Py2.7 on RHEL7.
- Python 2.6 is no longer supported, and support for Debian 6, and RHEL6 has been removed because of this.
- Support for the EOL'd platforms of Fedora 17/18/19 has been removed.
- Twisted has moved to requiring setuptools for installation.
- twisted.python.failure.Failure's __repr__ now includes the  exception message.
- 19 tickets in total closed!

As usual, you can find the tarball and newsfile at http://twistedmatrix.com/Releases/pre/15.4.0pre1/ ! Please download them, test them, share them, appreciate them, make them a little nest so that they are comfortable. If there aren't any reported issues, this will be getting a full release soon.

Twisted Regards,

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150827/427331cd/attachment.pgp>

From wangliyu at dhcc.com.cn  Thu Aug 27 06:32:29 2015
From: wangliyu at dhcc.com.cn (wangliyu at dhcc.com.cn)
Date: Thu, 27 Aug 2015 20:32:29 +0800
Subject: [Twisted-Python] Auto-Re: Twisted 15.4.0pre1 Prerelease Announcement
Message-ID: <1508272032292777479ebbc5a807a24d47509611bbe8@dhcc.com.cn>

??????????????????

----
--------------------------
Best Regards,

???

--------------------------

DHC Software Co.,Ltd.

????????

Add?11th floor,DHC Office Building,ZiJin Digital Park ,Zhongguancun,Haidian District, BeiJing ,China

??????????????3????????11?

?? 100190   ???18612695237

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150827/25a6f350/attachment.html>

From jason.w.kane at gmail.com  Fri Aug 28 11:23:47 2015
From: jason.w.kane at gmail.com (Jason Kane)
Date: Fri, 28 Aug 2015 10:23:47 -0700
Subject: [Twisted-Python] doWrite called on a twisted.internet.tcp.Port
Message-ID: <CAJYM=XJzx3ijz5PigrtLshwPjy8m+OWmabvWB+eDhPALgb6xMg@mail.gmail.com>

https://twistedmatrix.com/trac/ticket/4759 -- I tried to post as a
comment in the Trac ticket but "SpamBayes determined spam probability
of 93.78%".

Same issue but w/Linux; I've been hacking around at it for a bit and
found a few things that might be helpful.  I am on old twisted
(12.1.0) using a backported protocols.memcache so this could be
self-inflicted.

Inside epollreactor doPoll() I added sanity checks to log when
_poller.poll() gives us an event flagged for READ on a fd that is
_not_ in self._reads (and similarly with writes).  Low and behold,
gobs of hits.  Unexpected.

So I took a closer look.  It appears to me that _epoll.epoll() is
emitting events that are outside of the flags that epollreactor
carefully registers.  Filtering them out in doPoll seems to avoid this
particular traceback but it also breaks the world.  At least in my
system this appears to be the expected behavior.

So (to restate and summarize) asserting on addWriter() doesn't do
anything because the Port was added by addReader().  Despite only
being in _reads() and being registered with _epoll.EPOLLIN, doPoll()
is getting write events which it happily passes through to
_doReadOrWrite which checks the event flag, sees it as a _POLL_OUT and
tries to write it.

I'll try the obvious (upgrade twisted to current) and see what happens.

[[https://gist.github.com/jason-kane/18f1516d7c1ef381b35e|Gist of my
diagnostic]]


From wangliyu at dhcc.com.cn  Fri Aug 28 11:27:48 2015
From: wangliyu at dhcc.com.cn (wangliyu at dhcc.com.cn)
Date: Sat, 29 Aug 2015 01:27:48 +0800
Subject: [Twisted-Python] Auto-Re: doWrite called on a
	twisted.internet.tcp.Port
Message-ID: <150829012748039f3fd47313bcbd38037b863fdfda38@dhcc.com.cn>

??????????????????

----
--------------------------
Best Regards,

???

--------------------------

DHC Software Co.,Ltd.

????????

Add?11th floor,DHC Office Building,ZiJin Digital Park ,Zhongguancun,Haidian District, BeiJing ,China

??????????????3????????11?

?? 100190   ???18612695237

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150829/dd999a09/attachment.html>

From glyph at twistedmatrix.com  Fri Aug 28 23:28:49 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Sat, 29 Aug 2015 00:28:49 -0500
Subject: [Twisted-Python] doWrite called on a twisted.internet.tcp.Port
In-Reply-To: <CAJYM=XJzx3ijz5PigrtLshwPjy8m+OWmabvWB+eDhPALgb6xMg@mail.gmail.com>
References: <CAJYM=XJzx3ijz5PigrtLshwPjy8m+OWmabvWB+eDhPALgb6xMg@mail.gmail.com>
Message-ID: <3F6B8E52-A199-46DA-B0F9-698DDEF2E889@twistedmatrix.com>


> On Aug 28, 2015, at 12:23, Jason Kane <jason.w.kane at gmail.com> wrote:
> 
> https://twistedmatrix.com/trac/ticket/4759 -- I tried to post as a
> comment in the Trac ticket but "SpamBayes determined spam probability
> of 93.78%".

I've retrained the spam filter so hopefully you won't have this issue in the future.  I do make the point of training spambayes every day and we have few false positives like this - sorry about that!  If it makes you feel any better it properly rejected about 30 spams per one message of yours it rejected ;-).

> Same issue but w/Linux; I've been hacking around at it for a bit and
> found a few things that might be helpful.  I am on old twisted
> (12.1.0) using a backported protocols.memcache so this could be
> self-inflicted.
> 
> Inside epollreactor doPoll() I added sanity checks to log when
> _poller.poll() gives us an event flagged for READ on a fd that is
> _not_ in self._reads (and similarly with writes).  Low and behold,
> gobs of hits.  Unexpected.
> 
> So I took a closer look.  It appears to me that _epoll.epoll() is
> emitting events that are outside of the flags that epollreactor
> carefully registers.  Filtering them out in doPoll seems to avoid this
> particular traceback but it also breaks the world.  At least in my
> system this appears to be the expected behavior.
> 
> So (to restate and summarize) asserting on addWriter() doesn't do
> anything because the Port was added by addReader().  Despite only
> being in _reads() and being registered with _epoll.EPOLLIN, doPoll()
> is getting write events which it happily passes through to
> _doReadOrWrite which checks the event flag, sees it as a _POLL_OUT and
> tries to write it.
> 
> I'll try the obvious (upgrade twisted to current) and see what happens.
> 
> [[https://gist.github.com/jason-kane/18f1516d7c1ef381b35e|Gist of my
> diagnostic]]

Would you mind re-posting this to a comment, as it should work now?  If you have more problems with the spam filter I'll post it myself and credit you.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150829/10ed8b37/attachment.html>

From trac at twistedmatrix.com  Sun Aug 30 00:05:31 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 30 Aug 2015 06:05:31 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1440914731.55.3926023771478296822@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150830/60234a79/attachment.html>

From wangliyu at dhcc.com.cn  Sun Aug 30 00:10:28 2015
From: wangliyu at dhcc.com.cn (wangliyu at dhcc.com.cn)
Date: Sun, 30 Aug 2015 14:10:28 +0800
Subject: [Twisted-Python] Auto-Re:  Weekly Bug Summary
Message-ID: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>

??????????????????

----
--------------------------
Best Regards,

???

--------------------------

DHC Software Co.,Ltd.

????????

Add?11th floor,DHC Office Building,ZiJin Digital Park ,Zhongguancun,Haidian District, BeiJing ,China

??????????????3????????11?

?? 100190   ???18612695237

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150830/54c28a57/attachment.html>

From hs at ox.cx  Sun Aug 30 00:38:36 2015
From: hs at ox.cx (Hynek Schlawack)
Date: Sun, 30 Aug 2015 08:38:36 +0200
Subject: [Twisted-Python] Auto-Re:  Weekly Bug Summary
In-Reply-To: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>
References: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>
Message-ID: <685B3C22-79C9-49D4-8A07-C37F91710B75@ox.cx>

I wonder, is something weird with our Mailman configuration?  Because I haven't seen any other list (some with many more subscribers) that has this regular auto-responder problem.

Sent from my phone.

> Am 30.08.2015 um 08:10 schrieb wangliyu at dhcc.com.cn:
> 
> ??????????????????
> 
> ----
> --------------------------
> Best Regards,
> ???
> --------------------------
> DHC Software Co.,Ltd.
> ????????
> Add?11th floor,DHC Office Building,ZiJin Digital Park ,Zhongguancun,Haidian District, BeiJing ,China
> ??????????????3????????11?
> ?? 100190   ???18612695237
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150830/75db9c10/attachment.html>

From glyph at twistedmatrix.com  Sun Aug 30 01:01:57 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 30 Aug 2015 00:01:57 -0700
Subject: [Twisted-Python] Auto-Re:  Weekly Bug Summary
In-Reply-To: <685B3C22-79C9-49D4-8A07-C37F91710B75@ox.cx>
References: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>
 <685B3C22-79C9-49D4-8A07-C37F91710B75@ox.cx>
Message-ID: <7FABB97E-3930-4444-A32D-71CA40E0566C@twistedmatrix.com>



> On Aug 29, 2015, at 11:38 PM, Hynek Schlawack <hs at ox.cx> wrote:
> 
> I wonder, is something weird with our Mailman configuration?  Because I haven't seen any other list (some with many more subscribers) that has this regular auto-responder problem.

Nothing's changed about our configuration, so I'm not sure what has happened.  Did some other mail server change how it did auto-responses recently?

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150830/65a015ad/attachment.html>

From hs at ox.cx  Sun Aug 30 02:25:31 2015
From: hs at ox.cx (Hynek Schlawack)
Date: Sun, 30 Aug 2015 10:25:31 +0200
Subject: [Twisted-Python] Auto-Re:  Weekly Bug Summary
In-Reply-To: <7FABB97E-3930-4444-A32D-71CA40E0566C@twistedmatrix.com>
References: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>
 <685B3C22-79C9-49D4-8A07-C37F91710B75@ox.cx>
 <7FABB97E-3930-4444-A32D-71CA40E0566C@twistedmatrix.com>
Message-ID: <56222950-E4C0-4C7F-A63B-31663159AA9F@ox.cx>

This isn't a new problem either; it's just more prevalent this year.  Typically emerges around some kind of holidays. 

Sent from my phone.

> Am 30.08.2015 um 09:01 schrieb Glyph <glyph at twistedmatrix.com>:
> 
> 
> 
>> On Aug 29, 2015, at 11:38 PM, Hynek Schlawack <hs at ox.cx> wrote:
>> 
>> I wonder, is something weird with our Mailman configuration?  Because I haven't seen any other list (some with many more subscribers) that has this regular auto-responder problem.
> 
> Nothing's changed about our configuration, so I'm not sure what has happened.  Did some other mail server change how it did auto-responses recently?
> 
> -glyph
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20150830/15ef7f6c/attachment-0001.html>

From trac at twistedmatrix.com  Sun Aug  2 00:05:21 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 02 Aug 2015 06:05:21 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1438495521.65.5356257244379318254@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150802/346dd450/attachment-0002.html>

From hawkowl at atleastfornow.net  Sun Aug  2 19:49:38 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Mon, 3 Aug 2015 11:49:38 +1000
Subject: [Twisted-Python] Twisted 15.3.0pre2 Prerelease Announcement
Message-ID: <0745BCE2-E449-4A40-89B7-20C6C75D3383@atleastfornow.net>

Hi everyone,

I've just uploaded 15.3.0pre2 to http://twistedmatrix.com/Releases/pre/15.3.0pre2/ , which provides a small fix for Twisted-using libraries that subclass Protocol overwriting the `_log` attribute.

Please test your software with it, but as this is a very minor change, I will release it very soon.

Twisted Regards,

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: </pipermail/twisted-python/attachments/20150803/a7e1d064/attachment.sig>

From jcraig at gsacrd.ab.ca  Sun Aug  2 19:50:16 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Sun, 02 Aug 2015 19:50:16 -0600
Subject: [Twisted-Python] Twisted 15.3.0pre2 Prerelease Announcement
Message-ID: <fc.000f81d802d88edb3b9aca000d690663.2d88edc@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150802/de645ff4/attachment-0002.html>

From hawkowl at atleastfornow.net  Tue Aug  4 01:05:06 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Tue, 4 Aug 2015 17:05:06 +1000
Subject: [Twisted-Python] Twisted 15.3 Release Announcement
Message-ID: <2B4C122E-4DA0-4743-8D30-B0F419084098@atleastfornow.net>

On behalf of Twisted Matrix Labs, I am honoured to announce the release of Twisted 15.3.

We're marching confidently into the future, and this release demonstrates this:

	* 10+ modules ported to Python 3 (see NEWS for specifics)
 	* Twisted Lore has been removed.
	* Twisted no longer releases as 'subprojects' -- there is only one Twisted, long may it reign.
	* twistd now uses cProfile (instead of Hotshot) as the default profiler.
	* 40+ more tickets closed overall.

You can find the downloads at https://pypi.python.org/pypi/Twisted (or alternatively http://twistedmatrix.com/trac/wiki/Downloads). The NEWS file can be found at https://github.com/twisted/twisted/blob/trunk/NEWS .

Many thanks to everyone who had a part in this release - the supporters of the Twisted Software Foundation, the developers who contributed code as well as documentation, and all the people building great things with Twisted!

Twisted Regards,

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: </pipermail/twisted-python/attachments/20150804/63def2f3/attachment.sig>

From jcraig at gsacrd.ab.ca  Tue Aug  4 01:05:32 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Tue, 04 Aug 2015 01:05:32 -0600
Subject: [Twisted-Python] Twisted 15.3 Release Announcement
Message-ID: <fc.000f81d802d89dd23b9aca0002d5d66f.2d89dd3@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150804/b42b008a/attachment-0002.html>

From glyph at twistedmatrix.com  Thu Aug  6 12:32:02 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 6 Aug 2015 11:32:02 -0700
Subject: [Twisted-Python] failing coverage builders
Message-ID: <0F605D53-2798-4447-8CD2-19857D1A4ED1@twistedmatrix.com>

The python 3.4 coverage builders are failing, apparently because one of the builders is down:

<https://buildbot.twistedmatrix.com/builders/debian7-py3.4-coverage/builds/399/steps/shell_5/logs/stdio <https://buildbot.twistedmatrix.com/builders/debian7-py3.4-coverage/builds/399/steps/shell_5/logs/stdio>>

I'll probably make those builders unsupported later today if there is no obvious fix; at this point, depending on codecov is mostly just a net negative.  We can't have it reasonably fail our builds or report status for us, and "coverage html" produces perfectly usable coverage reports, and so the main consequence is that our builds will fail if they're down (or if they introduce a version of coverage on PyPI that doesn't support python 3, apparently?)

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150806/0edf8db7/attachment-0002.html>

From jcraig at gsacrd.ab.ca  Thu Aug  6 12:32:35 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Thu, 06 Aug 2015 12:32:35 -0600
Subject: [Twisted-Python] failing coverage builders
Message-ID: <fc.000f81d802d8d3343b9aca0066f9854c.2d8d335@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150806/efbaf705/attachment-0002.html>

From hawkowl at atleastfornow.net  Thu Aug  6 17:32:55 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Fri, 7 Aug 2015 09:32:55 +1000
Subject: [Twisted-Python] failing coverage builders
In-Reply-To: <0F605D53-2798-4447-8CD2-19857D1A4ED1@twistedmatrix.com>
References: <0F605D53-2798-4447-8CD2-19857D1A4ED1@twistedmatrix.com>
Message-ID: <48C82447-E39B-4A32-B2BF-FCD4D954270D@atleastfornow.net>

Hi Glyph,

I'll take a look.

I find the combined codecov rather valuable for figuring out what isn't covered on either, but I'll remove it for now.

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

> On 7 Aug 2015, at 04:32, Glyph <glyph at twistedmatrix.com> wrote:
> 
> The python 3.4 coverage builders are failing, apparently because one of the builders is down:
> 
> <https://buildbot.twistedmatrix.com/builders/debian7-py3.4-coverage/builds/399/steps/shell_5/logs/stdio>
> 
> I'll probably make those builders unsupported later today if there is no obvious fix; at this point, depending on codecov is mostly just a net negative.  We can't have it reasonably fail our builds or report status for us, and "coverage html" produces perfectly usable coverage reports, and so the main consequence is that our builds will fail if they're down (or if they introduce a version of coverage on PyPI that doesn't support python 3, apparently?)
> 
> -glyph
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: </pipermail/twisted-python/attachments/20150807/057e8afa/attachment.sig>

From glyph at twistedmatrix.com  Thu Aug  6 22:11:33 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 6 Aug 2015 21:11:33 -0700
Subject: [Twisted-Python] failing coverage builders
In-Reply-To: <48C82447-E39B-4A32-B2BF-FCD4D954270D@atleastfornow.net>
References: <0F605D53-2798-4447-8CD2-19857D1A4ED1@twistedmatrix.com>
 <48C82447-E39B-4A32-B2BF-FCD4D954270D@atleastfornow.net>
Message-ID: <C6850B10-200E-40C8-94E6-96BC09F687A2@twistedmatrix.com>

> On Aug 6, 2015, at 4:32 PM, Amber Hawkie Brown <hawkowl at atleastfornow.net> wrote:
> 
> Hi Glyph,
> 
> I'll take a look.
> 
> I find the combined codecov rather valuable for figuring out what isn't covered on either, but I'll remove it for now.

I already removed it earlier, so that should be easy :-).

Raw coverage can do combining, if we can just ship the files somewhere:

http://nedbatchelder.com/code/coverage/cmd.html#cmd-combining <http://nedbatchelder.com/code/coverage/cmd.html#cmd-combining>

But, perhaps we should just not fail the build if codecov submission fails.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150806/e7c555bf/attachment-0002.html>

From chris.norman2 at googlemail.com  Sat Aug  8 06:07:58 2015
From: chris.norman2 at googlemail.com (Chris Norman)
Date: Sat, 8 Aug 2015 13:07:58 +0100
Subject: [Twisted-Python] Blacklisting hosts
Message-ID: <55C5F11E.5060401@googlemail.com>

Hi all,
I am using Twisted to make a game server. I want to be able to ban IP 
addresses. Currently I check if the host is in a blacklist, and if it 
is, call abortConnection on the transport. It works fine, but I'm 
thinking there should be a better way, to actively refuse the connection 
in the first place?

Cheers,



From jcraig at gsacrd.ab.ca  Sat Aug  8 06:08:42 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Sat, 08 Aug 2015 06:08:42 -0600
Subject: [Twisted-Python] Blacklisting hosts
Message-ID: <fc.000f81d802d8ec903b9aca00796b829d.2d8ec91@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150808/ba7160d7/attachment-0002.html>

From trac at twistedmatrix.com  Sun Aug  9 00:05:19 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 09 Aug 2015 06:05:19 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1439100319.94.2725727957563287613@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150809/95758a70/attachment-0002.html>

From jcraig at gsacrd.ab.ca  Sun Aug  9 00:05:45 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Sun, 09 Aug 2015 00:05:45 -0600
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: <fc.000f81d802d8f52b3b9aca00d6a0e623.2d8f52c@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150809/c8d57df2/attachment-0002.html>

From hawkowl at atleastfornow.net  Sun Aug  9 03:41:13 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Sun, 9 Aug 2015 17:41:13 +0800
Subject: [Twisted-Python] Updates on the Twisted Buildbots
Message-ID: <EF5EDAF8-1785-42B0-AA03-AA61520DD402@atleastfornow.net>

Hi everyone,

If you haven't looked at the buildbots for a while, there's been some changes! (for brevity's sake, unsupported builders will be prefixed with a U, eg "U2.7")

- Fedora 17 (2.7), 18 (2.7), 19 (2.7, 3.3), and RHEL6 (2.6) are removed, and replaced by RHEL7 (2.7), Fedora 21 (2.7, 3.4), Fedora 22 (U2.7, U3.4, to be fixed very soon, UPyPy2.4). RHEL6 will return with the 2.7 EPEL soon.
- FreeBSD 10.1 is supported on both Py2.7 and Py3.4.
- OS X 10.6 has been removed and OSX 10.10 has been added (2.7-select supported, kqueue and cfreactor both unsupported)
- Ubuntu 15.04 is now a supported platform (2.7, 3.4) and has unsupported PyPy (2.5) and Jython (2.7) builders.
- All of the builders (excepting Windows) are built and ran in a virtualenv. This means that they have up-to-date dependencies, and if Twisted gains dependencies, the infra team can add them to the build process easily.

Twisted Regards,

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: </pipermail/twisted-python/attachments/20150809/a81e17ea/attachment.sig>

From cory at lukasa.co.uk  Sun Aug  9 10:07:09 2015
From: cory at lukasa.co.uk (Cory Benfield)
Date: Sun, 9 Aug 2015 12:07:09 -0400
Subject: [Twisted-Python] Blacklisting hosts
In-Reply-To: <55C5F11E.5060401@googlemail.com>
References: <55C5F11E.5060401@googlemail.com>
Message-ID: <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>


> On 8 Aug 2015, at 08:07, Chris Norman <chris.norman2 at googlemail.com> wrote:
> 
> Hi all,
> I am using Twisted to make a game server. I want to be able to ban IP addresses. Currently I check if the host is in a blacklist, and if it is, call abortConnection on the transport. It works fine, but I'm thinking there should be a better way, to actively refuse the connection in the first place?

I am not aware of any hook in the BSD socket API that lets you refuse a connection entirely. Generally, you put a socket into listen mode (indicating to the OS that youll accept new connections), and then you call accept() to get the new connection. In fact, the OS will accept the connection even before you call accept(): itll do it asynchronously, and you will just get the FD for the connection. IIRC Windows has a winsock specific thing that might do what you want, but thats pretty platform specific and probably doesnt actually prevent the connection getting established anyway.

If you really want to never allow the connection at all, youll probably want to program iptables (or some other firewall if you arent on Linux) to do the packet filtering for you. A combination of iptables and ipsets will get you a high-performance IP address blacklist that will drop all packets before they ever reach your application.

Cory


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: </pipermail/twisted-python/attachments/20150809/6d3dfe45/attachment.sig>

From glyph at twistedmatrix.com  Sun Aug  9 20:32:12 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 9 Aug 2015 19:32:12 -0700
Subject: [Twisted-Python] Blacklisting hosts
In-Reply-To: <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
References: <55C5F11E.5060401@googlemail.com>
 <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
Message-ID: <48F21158-0E0F-49B3-A57E-792AEDF8F252@twistedmatrix.com>


> On Aug 9, 2015, at 9:07 AM, Cory Benfield <cory at lukasa.co.uk> wrote:
> 
> 
>> On 8 Aug 2015, at 08:07, Chris Norman <chris.norman2 at googlemail.com> wrote:
>> 
>> Hi all,
>> I am using Twisted to make a game server. I want to be able to ban IP addresses. Currently I check if the host is in a blacklist, and if it is, call abortConnection on the transport. It works fine, but I'm thinking there should be a better way, to actively refuse the connection in the first place?
> 
> I am not aware of any hook in the BSD socket API that lets you refuse a connection entirely. Generally, you put a socket into listen mode (indicating to the OS that youll accept new connections), and then you call accept() to get the new connection. In fact, the OS will accept the connection even before you call accept(): itll do it asynchronously, and you will just get the FD for the connection. IIRC Windows has a winsock specific thing that might do what you want, but thats pretty platform specific and probably doesnt actually prevent the connection getting established anyway.
> 
> If you really want to never allow the connection at all, youll probably want to program iptables (or some other firewall if you arent on Linux) to do the packet filtering for you. A combination of iptables and ipsets will get you a high-performance IP address blacklist that will drop all packets before they ever reach your application.


There is a shortcut in Twisted, at least, although it does not actually refuse the initial connection for the reasons listed above; you can examine the "addr" passed to IProtocolFactory.buildProtocol and return None.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150809/01dcad9e/attachment-0002.html>

From itamar at itamarst.org  Mon Aug 10 12:59:17 2015
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 10 Aug 2015 14:59:17 -0400
Subject: [Twisted-Python] ANN: Eliot 0.8, the logging system with causality
Message-ID: <e689c90d540cdae211b664254731d168@itamarst.org>

 
Most logging systems can tell you what happened; Eliot tells you _why_
it happened:

$ python linkcheck.py | eliot-tree
4c42a789-76f5-4f0b-b154-3dd0e3041445
+-- check_links at 1/started
 `-- urls: [u'http://google.com', u'http://nosuchurl']
 +-- download at 2,1/started
 `-- url: http://google.com
 +-- download at 2,2/succeeded
 +-- download at 3,1/started
 `-- url: http://nosuchurl
 +-- download at 3,2/failed
 |-- exception: requests.exceptions.ConnectionError
 |-- reason: ('Conn aborted', gaierror(-2, 'Name unknown'))
 +-- check_links at 4/failed
 |-- exception: exceptions.ValueError
 |-- reason: ('Conn aborted.', gaierror(-2, 'Name unknown'))
 And here's the code that generated these logs (eliot-tree [1] was used
to render the output):

import sys
from eliot import start_action, to_file
import requests
to_file(sys.stdout)

def check_links(urls):
 with start_action(action_type="check_links", urls=urls):
 for url in urls:
 try:
 with start_action(action_type="download", url=url):
 response = requests.get(url)
 response.raise_for_status()
 except Exception as e:
 raise ValueError(str(e))

check_links(["http://google.com"], ["http://nosuchurl"])

Interested? Read more at https://eliot.readthedocs.org/ [2].

Eliot is released under the Apache License 2 by ClusterHQ [3], the
Container Data People. We're hiring! [4]
 

Links:
------
[1] https://warehouse.python.org/project/eliot-tree/
[2] https://eliot.readthedocs.org/
[3] https://clusterhq.com
[4] https://clusterhq.com/careers/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150810/3a04cb5a/attachment-0002.html>

From jcraig at gsacrd.ab.ca  Mon Aug 10 12:59:48 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Mon, 10 Aug 2015 12:59:48 -0600
Subject: [Twisted-Python] ANN: Eliot 0.8,
	the logging system with causality
Message-ID: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150810/fa48ebcb/attachment-0002.html>

From chris.norman2 at googlemail.com  Mon Aug 10 15:40:21 2015
From: chris.norman2 at googlemail.com (Chris Norman)
Date: Mon, 10 Aug 2015 22:40:21 +0100
Subject: [Twisted-Python] Blacklisting hosts
In-Reply-To: <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
References: <55C5F11E.5060401@googlemail.com>
 <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
Message-ID: <090FAA74-322A-4CDB-9FBF-280B12F4814E@googlemail.com>

Hello,
> On 9 Aug 2015, at 17:07, Cory Benfield <cory at lukasa.co.uk> wrote:
> 
> 
>> On 8 Aug 2015, at 08:07, Chris Norman <chris.norman2 at googlemail.com> wrote:
>> 
>> Hi all,
>> I am using Twisted to make a game server. I want to be able to ban IP addresses. Currently I check if the host is in a blacklist, and if it is, call abortConnection on the transport. It works fine, but I'm thinking there should be a better way, to actively refuse the connection in the first place?
> 
> I am not aware of any hook in the BSD socket API that lets you refuse a connection entirely. Generally, you put a socket into listen mode (indicating to the OS that youll accept new connections), and then you call accept() to get the new connection. In fact, the OS will accept the connection even before you call accept(): itll do it asynchronously, and you will just get the FD for the connection. IIRC Windows has a winsock specific thing that might do what you want, but thats pretty platform specific and probably doesnt actually prevent the connection getting established anyway.
> 
> If you really want to never allow the connection at all, youll probably want to program iptables (or some other firewall if you arent on Linux) to do the packet filtering for you. A combination of iptables and ipsets will get you a high-performance IP address blacklist that will drop all packets before they ever reach your application.

Thanks for that. I was sort of hoping for a Pythonic solution that doesn't rely on SubProcess ETC, particularly as I want this server to run on any OS you throw at it. Thanks for the idea though, I'll certainly use that if I get something that little Python can't handle.
> 
> Cory
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From chris.norman2 at googlemail.com  Mon Aug 10 15:43:31 2015
From: chris.norman2 at googlemail.com (Chris Norman)
Date: Mon, 10 Aug 2015 22:43:31 +0100
Subject: [Twisted-Python] Blacklisting hosts
In-Reply-To: <48F21158-0E0F-49B3-A57E-792AEDF8F252@twistedmatrix.com>
References: <55C5F11E.5060401@googlemail.com>
 <71490823-139A-4B40-853A-AAB1087C39F8@lukasa.co.uk>
 <48F21158-0E0F-49B3-A57E-792AEDF8F252@twistedmatrix.com>
Message-ID: <976F95AC-9578-4E6B-A710-87EDD1181E98@googlemail.com>

Hello,

> On 10 Aug 2015, at 03:32, Glyph <glyph at twistedmatrix.com> wrote:
> 
>> 
>> On Aug 9, 2015, at 9:07 AM, Cory Benfield <cory at lukasa.co.uk <mailto:cory at lukasa.co.uk>> wrote:
>> 
>> 
>>> On 8 Aug 2015, at 08:07, Chris Norman <chris.norman2 at googlemail.com <mailto:chris.norman2 at googlemail.com>> wrote:
>>> 
>>> Hi all,
>>> I am using Twisted to make a game server. I want to be able to ban IP addresses. Currently I check if the host is in a blacklist, and if it is, call abortConnection on the transport. It works fine, but I'm thinking there should be a better way, to actively refuse the connection in the first place?
>> 
>> I am not aware of any hook in the BSD socket API that lets you refuse a connection entirely. Generally, you put a socket into listen mode (indicating to the OS that youll accept new connections), and then you call accept() to get the new connection. In fact, the OS will accept the connection even before you call accept(): itll do it asynchronously, and you will just get the FD for the connection. IIRC Windows has a winsock specific thing that might do what you want, but thats pretty platform specific and probably doesnt actually prevent the connection getting established anyway.
>> 
>> If you really want to never allow the connection at all, youll probably want to program iptables (or some other firewall if you arent on Linux) to do the packet filtering for you. A combination of iptables and ipsets will get you a high-performance IP address blacklist that will drop all packets before they ever reach your application.
> 
> 
> There is a shortcut in Twisted, at least, although it does not actually refuse the initial connection for the reasons listed above; you can examine the "addr" passed to IProtocolFactory.buildProtocol and return None.

This is perfect, thanks. It would have been better to refuse the connection entirely, but as Corey said, I can use iptables if I get desperate.

> 
> -glyph
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com <mailto:Twisted-Python at twistedmatrix.com>
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python <http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150810/ed169a1c/attachment-0002.html>

From dstainton415 at gmail.com  Tue Aug 11 04:46:09 2015
From: dstainton415 at gmail.com (David Stainton)
Date: Tue, 11 Aug 2015 03:46:09 -0700
Subject: [Twisted-Python] please can haz code review -> Tor-ified Twisted
 Python HTTP proxy server - txtorhttpproxy
Message-ID: <CAFN1edrfiV-BFBt6YNV1QvmfFca19LsnmdrUpGGppX4A_5e+fQ@mail.gmail.com>

Dear Twisted/Tor developers,

I am motivated by language security concerns. I think Twisted Python
can often implement excellent replacements for our old crufty C
implementations. In this case I'd like to stop using C programs
running as root (or not root) to torify http connections... like
privoxy, polipo, apt tor transport etc.

Last year I wrote this little tor http proxy; yes it also handles RFC
2817 proxy CONNECT method as well:
https://github.com/david415/txtorhttpproxy

I wrote an AgentProxy that can proxy any sort of twisted http agent:
https://github.com/david415/txtorhttpproxy/blob/master/txtorhttpproxy/proxy.py

It used to use more terrible underscore imports but Leif fixed the
bit-rot and made it work with Twisted 15:
https://github.com/david415/txtorhttpproxy/commit/38f1a0cfab586f7a8965a47e9c8f951b351426a2

Is this project worthy of your precious 10 minutes to review it... so
I can improve the code quality?

If I get rid of this last terrible import:
from twisted.web._newclient import ResponseDone

then I'm not sure how to detect when to call the finish() method here:
https://github.com/david415/txtorhttpproxy/blob/master/txtorhttpproxy/proxy.py#L38-L52


Sincerely,
David Stainton



From jcraig at gsacrd.ab.ca  Tue Aug 11 04:46:33 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Tue, 11 Aug 2015 04:46:33 -0600
Subject: [Twisted-Python] please can haz code review -> Tor-ified
	Twisted Python HTT
Message-ID: <fc.000f81d802d913223b9aca0060ef6c0a.2d91323@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150811/059ae629/attachment-0002.html>

From p.mayers at imperial.ac.uk  Tue Aug 11 09:33:23 2015
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 11 Aug 2015 16:33:23 +0100
Subject: [Twisted-Python] List admin attention
In-Reply-To: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
References: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
Message-ID: <55CA15C3.1060409@imperial.ac.uk>

Someone please un-sub this person?


-------- Forwarded Message --------
Subject: 	Re: [Twisted-Python] ANN: Eliot 0.8, the logging system with
causality
Date: 	Mon, 10 Aug 2015 12:59:48 -0600
From: 	Judy Craig <jcraig at gsacrd.ab.ca>
Reply-To: 	Twisted general discussion <twisted-python at twistedmatrix.com>
To: 	twisted-python at twistedmatrix.com



This is an automatic reply. I am away from the office for the summer,
returning on Tuesday, August 25, 2015.  I will be happy to get back to
you then.

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are
intended solely for the use of the individual or entity to whom they are
addressed. If you have received this email in error please notify the
system manager. If you are not the named addressee you should not
disseminate, distribute or copy this email.


-------------- next part --------------
_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From glyph at twistedmatrix.com  Tue Aug 11 14:48:41 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Tue, 11 Aug 2015 13:48:41 -0700
Subject: [Twisted-Python] List admin attention
In-Reply-To: <55CA15C3.1060409@imperial.ac.uk>
References: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
 <55CA15C3.1060409@imperial.ac.uk>
Message-ID: <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>

> On Aug 11, 2015, at 8:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:
> 
> Someone please un-sub this person?

If I've done my job right this message will not receive an autoreply...

-glyph




From todd.ulrich at cogeco.ca  Tue Aug 11 14:55:33 2015
From: todd.ulrich at cogeco.ca (J Todd Ulrich)
Date: Tue, 11 Aug 2015 16:55:33 -0400
Subject: [Twisted-Python] List admin attention
In-Reply-To: <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>
References: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
 <55CA15C3.1060409@imperial.ac.uk>
 <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>
Message-ID: <20150811205533.6660179.49832.2313@cogeco.ca>

Yes please remove.

WalkTall.

JToddUlrich
m.416.625.3209

Pleaseexcusebrevityasthis messagesentfrommyBlackBerry 10smartphoneontheRogers network.
 Original Message 
From: Glyph
Sent: Tuesday, August 11, 2015 4:49 PM
To: Twisted general discussion
Reply To: Twisted general discussion
Subject: Re: [Twisted-Python] List admin attention

> On Aug 11, 2015, at 8:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:
> 
> Someone please un-sub this person?

If I've done my job right this message will not receive an autoreply...

-glyph


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From glyph at twistedmatrix.com  Tue Aug 11 16:24:10 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Tue, 11 Aug 2015 15:24:10 -0700
Subject: [Twisted-Python] incompatible change in 15.3 - something reviewers
	should look for
Message-ID: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>

In https://twistedmatrix.com/trac/changeset/45163 twisted.internet.application.service.Service to be a new-style class.  Just to remind everyone, converting an old-style class to a new-style class is an incompatible change, and reviewers should look for this.

We discovered this because this change breaks https://github.com/twisted/axiom, and probably it breaks other packages as well, since lots of things inherit from Service.  So please remain diligent about looking for this in future changes.  Now that it's been changed, reverting it in 15.4 would be another incompatible change, so we probably won't do that, but please keep an eye out in the future.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150811/2c85439a/attachment-0002.html>

From _ at habnab.it  Tue Aug 11 23:06:02 2015
From: _ at habnab.it (Aaron Gallagher)
Date: Tue, 11 Aug 2015 22:06:02 -0700
Subject: [Twisted-Python] please can haz code review -> Tor-ified
	Twisted Python HTTP proxy server - txtorhttpproxy
In-Reply-To: <CAFN1edrfiV-BFBt6YNV1QvmfFca19LsnmdrUpGGppX4A_5e+fQ@mail.gmail.com>
References: <CAFN1edrfiV-BFBt6YNV1QvmfFca19LsnmdrUpGGppX4A_5e+fQ@mail.gmail.com>
Message-ID: <m21tf985ad.fsf@ender.habnabit.org>

David Stainton <dstainton415 at gmail.com> writes:

> If I get rid of this last terrible import:
> from twisted.web._newclient import ResponseDone
>
> then I'm not sure how to detect when to call the finish() method here:
> https://github.com/david415/txtorhttpproxy/blob/master/txtorhttpproxy/proxy.py#L38-L52

Fortunately, ResponseDone is re-exported by twisted.web.client:
             
    >>> import twisted.web.client
    >>> twisted.web.client.ResponseDone is twisted.web._newclient.ResponseDone
    True
    >>> twisted.__version__
    '11.0.0'

I couldn't get 9.0 to compile in the five seconds I tried, but 11.0 is
still pretty old. I think it always was re-exported like this.



From adi at roiban.ro  Wed Aug 12 00:24:46 2015
From: adi at roiban.ro (Adi Roiban)
Date: Wed, 12 Aug 2015 09:24:46 +0300
Subject: [Twisted-Python] incompatible change in 15.3 - something
 reviewers should look for
In-Reply-To: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>
References: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>
Message-ID: <CAFycZ9d0wmdfX76qB5WwNDruLcBoUXjw_vSwWLyew9P_+cPyOw@mail.gmail.com>

Hi,

Thanks for the notice!

On 12 August 2015 at 01:24, Glyph <glyph at twistedmatrix.com> wrote:
> In https://twistedmatrix.com/trac/changeset/45163
> twisted.internet.application.service.Service to be a new-style class.  Just
> to remind everyone, converting an old-style class to a new-style class is an
> incompatible change, and reviewers should look for this.

I have updated the wiki page to include this note and the reason why
we need this.

https://twistedmatrix.com/trac/wiki/Plan/Python3#Reviewerchecklist

Please check that wiki page is ok.

In my defense :)
Amber warned me about such changes, but when I asked (over IRC) why
they are bad I did received any convincing reason :)

> We discovered this because this change breaks
> https://github.com/twisted/axiom, and probably it breaks other packages as
> well, since lots of things inherit from Service.  So please remain diligent
> about looking for this in future changes.  Now that it's been changed,
> reverting it in 15.4 would be another incompatible change, so we probably
> won't do that, but please keep an eye out in the future.

I assume that this is the error in axiom:
https://github.com/twisted/axiom/issues/44

In axiom a class was defined as

class _SiteScheduler(object, Service, SchedulerMixin)

Is this a common practice?
Why do you want to have multiple inheritance and put object as the
first inherited class and not the last one?

Regards,
-- 
Adi Roiban



From jcraig at gsacrd.ab.ca  Wed Aug 12 00:25:25 2015
From: jcraig at gsacrd.ab.ca (Judy Craig)
Date: Wed, 12 Aug 2015 00:25:25 -0600
Subject: [Twisted-Python] incompatible change in 15.3 - something
	reviewers shoul
Message-ID: <fc.000f81d802d92fa93b9aca003ae328bd.2d92faa@gsacrd.ab.ca>

This is an automatic reply. I am away from the office for the summer, returning on Tuesday, August 25, 2015.  I will be happy to get back to you then.  

Enjoy your summer!

Judy Craig
Student Services

This email and any files transmitted with it may be confidential and are intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. If you are not
the named addressee you should not disseminate, distribute or copy this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150812/419ba9aa/attachment-0002.html>

From jml at mumak.net  Wed Aug 12 04:46:11 2015
From: jml at mumak.net (Jonathan Lange)
Date: Wed, 12 Aug 2015 10:46:11 +0000
Subject: [Twisted-Python] incompatible change in 15.3 - something
 reviewers should look for
In-Reply-To: <CAFycZ9d0wmdfX76qB5WwNDruLcBoUXjw_vSwWLyew9P_+cPyOw@mail.gmail.com>
References: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>
 <CAFycZ9d0wmdfX76qB5WwNDruLcBoUXjw_vSwWLyew9P_+cPyOw@mail.gmail.com>
Message-ID: <CAHZ8tnbER9NH67eebRpDQN2MpvRHXRTMRKnRz302vQxXi_Rjbw@mail.gmail.com>

On Wed, 12 Aug 2015 at 07:25 Adi Roiban <adi at roiban.ro> wrote:

> On 12 August 2015 at 01:24, Glyph <glyph at twistedmatrix.com> wrote:
>
> > We discovered this because this change breaks
> > https://github.com/twisted/axiom, and probably it breaks other packages
> as
> > well, since lots of things inherit from Service.  So please remain
> diligent
> > about looking for this in future changes.  Now that it's been changed,
> > reverting it in 15.4 would be another incompatible change, so we probably
> > won't do that, but please keep an eye out in the future.
>
> I assume that this is the error in axiom:
> https://github.com/twisted/axiom/issues/44
>
> In axiom a class was defined as
>
> class _SiteScheduler(object, Service, SchedulerMixin)
>
> Is this a common practice?
> Why do you want to have multiple inheritance and put object as the
> first inherited class and not the last one?
>
>
>From the perspective of Twisted development, why does it matter?

Changing a class from old style to new style changes the method resolution
order, which is going to break lots of code in ways that we can't
anticipate. We can't find every subclass and judge whether their usage
makes sense. We can only stick to our compatibility policy
<https://twistedmatrix.com/trac/wiki/CompatibilityPolicy>, which empowers
users to decide when & how they change their weird code.

jml
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150812/ac50b773/attachment-0002.html>

From dreid at dreid.org  Wed Aug 12 13:08:17 2015
From: dreid at dreid.org (David Reid)
Date: Wed, 12 Aug 2015 12:08:17 -0700
Subject: [Twisted-Python] Proposal -- Code of Conduct
In-Reply-To: <1437370109.2951691.327871321.7C3B3246@webmail.messagingengine.com>
References: <CAOA_4jBv3vv=pYcte7gQ6E8YjKzfBe+1HsPazYak4G=wJtxSgw@mail.gmail.com>
 <35B97E96-E041-4D40-BE37-F6F5C18C4503@twistedmatrix.com>
 <16FF9D27-2329-45EB-B270-96479A5B6395@ox.cx>
 <CA6CAF88-3CF6-4A9F-B38E-746694E9C89E@atleastfornow.net>
 <CAPkN8x+jnEuM-NU8C0fPqO0bQ+tp=s8H4MNvH8LRrrzVhCfrtw@mail.gmail.com>
 <CAOA_4jCf-bmtfNK1CLyo_-AgWYrmUt48hKc-Kg+CXDBw0oR5WQ@mail.gmail.com>
 <1435177502.2290262.306874953.7CCB7A44@webmail.messagingengine.com>
 <CAOA_4jB-Ut-B4DsWuTs-HHexk_J-_B-Jiu4fN46i8SaCaRv0qQ@mail.gmail.com>
 <1437370109.2951691.327871321.7C3B3246@webmail.messagingengine.com>
Message-ID: <CA+t4payXWnhFfjocsweTHO-RQ6xCeC6GqnfefULbYWEXumbsOA@mail.gmail.com>

What needs to happen to move this proposal forward?

-David

On Sun, Jul 19, 2015 at 10:28 PM, Kevin Turner <keturn at keturn.net> wrote:

> I was chatting with some people at the Community Leadership Summit today
> about the Recurse Center's social rules
> <https://www.recurse.com/manual#sec-environment>, which reminded me of
> this thread. What's the status of this proposal?
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150812/e99dd555/attachment-0002.html>

From glyph at twistedmatrix.com  Wed Aug 12 13:17:28 2015
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Aug 2015 12:17:28 -0700
Subject: [Twisted-Python] incompatible change in 15.3 - something
	reviewers should look for
In-Reply-To: <CAHZ8tnbER9NH67eebRpDQN2MpvRHXRTMRKnRz302vQxXi_Rjbw@mail.gmail.com>
References: <3C57766C-D165-4201-AFF7-3530CFE5CE18@twistedmatrix.com>
 <CAFycZ9d0wmdfX76qB5WwNDruLcBoUXjw_vSwWLyew9P_+cPyOw@mail.gmail.com>
 <CAHZ8tnbER9NH67eebRpDQN2MpvRHXRTMRKnRz302vQxXi_Rjbw@mail.gmail.com>
Message-ID: <F41C3AE8-CE1F-410F-8BA8-4A702229BEE6@twistedmatrix.com>


> On Aug 12, 2015, at 3:46 AM, Jonathan Lange <jml at mumak.net> wrote:
> 
> From the perspective of Twisted development, why does it matter? 

The one reason that it matters is that we need to consistently tell users how to prepare for the fact that eventually, everything will be new-style.  Perhaps it will only be new-style because we eventually drop python 2, perhaps it will only be new-style because python 2.8 will deprecate classic classes, perhaps we will eventually have a flag day just to reduce the maintenance burden, perhaps each old-style class will be individually deprecated and replaced with a new-style one.  In any case, the migration will be much easier for users if they learn now that putting 'object' at the end of their bases list is a way to avoid caring about this issue entirely :).

Otherwise I agree completely with your sentiment.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150812/ee86cd24/attachment-0002.html>

From glyph at twistedmatrix.com  Wed Aug 12 13:39:14 2015
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Aug 2015 12:39:14 -0700
Subject: [Twisted-Python] List admin attention
In-Reply-To: <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>
References: <fc.000f81d802d909633b9aca00b99426a7.2d90964@gsacrd.ab.ca>
 <55CA15C3.1060409@imperial.ac.uk>
 <8EB40D15-9274-4A82-B1F5-837A19D2DD51@twistedmatrix.com>
Message-ID: <9B47E7B5-4C3E-4A3F-8859-70C3D6D8595A@twistedmatrix.com>


> On Aug 11, 2015, at 1:48 PM, Glyph <glyph at twistedmatrix.com> wrote:
> 
>> On Aug 11, 2015, at 8:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:
>> 
>> Someone please un-sub this person?
> 
> If I've done my job right this message will not receive an autoreply...

OK, I apparently didn't do it correctly, but hopefully this time it stuck ...

-glyph




From dstainton415 at gmail.com  Thu Aug 13 05:58:01 2015
From: dstainton415 at gmail.com (David Stainton)
Date: Thu, 13 Aug 2015 13:58:01 +0200
Subject: [Twisted-Python] please can haz code review -> Tor-ified
 Twisted Python HTTP proxy server - txtorhttpproxy
In-Reply-To: <m21tf985ad.fsf@ender.habnabit.org>
References: <CAFN1edrfiV-BFBt6YNV1QvmfFca19LsnmdrUpGGppX4A_5e+fQ@mail.gmail.com>
 <m21tf985ad.fsf@ender.habnabit.org>
Message-ID: <CAFN1edruPvC-OHH1aRpr=gegJsdvP74pOyppCCmrJ1=Q_bNw6w@mail.gmail.com>

Dear Aaon Gallagher,

Thanks for the helpful observation. i'm going to make the correction
soon and then we'll be underscore free.

On Wed, Aug 12, 2015 at 7:06 AM, Aaron Gallagher <_ at habnab.it> wrote:
> David Stainton <dstainton415 at gmail.com> writes:
>
>> If I get rid of this last terrible import:
>> from twisted.web._newclient import ResponseDone
>>
>> then I'm not sure how to detect when to call the finish() method here:
>> https://github.com/david415/txtorhttpproxy/blob/master/txtorhttpproxy/proxy.py#L38-L52
>
> Fortunately, ResponseDone is re-exported by twisted.web.client:
>
>     >>> import twisted.web.client
>     >>> twisted.web.client.ResponseDone is twisted.web._newclient.ResponseDone
>     True
>     >>> twisted.__version__
>     '11.0.0'
>
> I couldn't get 9.0 to compile in the five seconds I tried, but 11.0 is
> still pretty old. I think it always was re-exported like this.



From glyph at twistedmatrix.com  Fri Aug 14 17:32:44 2015
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 14 Aug 2015 16:32:44 -0700
Subject: [Twisted-Python] twisted on jython
Message-ID: <B58DAA66-2ED9-421D-AE7A-D38EB9CCB375@twistedmatrix.com>

We currently have an unsupported builder for Jython 2.7: <https://buildbot.twistedmatrix.com/builders/ubuntu15.04-jython2.7 <https://buildbot.twistedmatrix.com/builders/ubuntu15.04-jython2.7>>

This is great, so that we can fix issues that make Twisted not support Jython, but some of the bugs that are causing it not to work may be on the Jython side as well.

Hawkowl, would it be possible to set up a Jython trunk builder?  This will remain unsupported, of course, but it would give the Jython developers the ability to see how changes they make are affecting Twisted's progress to a supported version - and possibly cut a release on their end if it turns green ;).

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150814/5f221fbe/attachment-0002.html>

From trac at twistedmatrix.com  Sun Aug 16 00:05:24 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 16 Aug 2015 06:05:24 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1439705124.74.1348520945978281250@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150816/d190a686/attachment-0002.html>

From trac at twistedmatrix.com  Sun Aug 23 00:05:17 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 23 Aug 2015 06:05:17 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1440309917.29.3103257785345805269@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150823/b5a84bb5/attachment-0002.html>

From peter.westlake at pobox.com  Tue Aug 25 10:27:34 2015
From: peter.westlake at pobox.com (Peter Westlake)
Date: Tue, 25 Aug 2015 17:27:34 +0100
Subject: [Twisted-Python] Screen clearing in the Manhole
Message-ID: <1440520054.2262163.365674993.6595850F@webmail.messagingengine.com>

I'm making a manhole service in the usual way:

class PF(ServerProtocol): def protocolFactory(*a, **kw):
return manhole.Manhole(namespace)

realm = manhole_ssh.TerminalRealm() realm.chainedProtocolFactory = PF
mh_portal = portal.Portal(realm) mh_portal.registerChecker(checker)

manhole_service = TCPServer(0, manhole_ssh.ConchFactory(mh_portal))
manhole_service.startService()

and I'd like to print a message when the terminal is opened. This
change does it:

class PF(ServerProtocol): def protocolFactory(*a, **kw):
class Manhole(manhole.Manhole): def connectionMade(self):
super(Manhole, self).connectionMade()
self.terminal.write('Hello') return
manhole.Manhole(namespace)

and so does this version, which is better because
t.c.i.i.ServerProtocol.connectionMade says it is the place to
write messages:

class PF(ServerProtocol): def protocolFactory(*a, **kw):
return manhole.Manhole(namespace)

def connectionMade(self): ServerProtocol.connectionMade(self)
self.write('Hello')

But in both cases, after the message the screen is cleared by what looks
like a form feed, and another prompt is printed. So far I can't find
where in the code this happens. Is there a way to print a message and
not have it scrolled off the screen?

Thanks,

Peter.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150825/72e24d69/attachment-0002.html>

From brian.costlow at gmail.com  Tue Aug 25 15:26:27 2015
From: brian.costlow at gmail.com (Brian Costlow)
Date: Tue, 25 Aug 2015 17:26:27 -0400
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <1440520054.2262163.365674993.6595850F@webmail.messagingengine.com>
References: <1440520054.2262163.365674993.6595850F@webmail.messagingengine.com>
Message-ID: <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>

As to where it happens, look at
twisted.conch.recvline.RecvLine.connectionMade() and
twisted.conch.insults.insults.TerminalProtocol.makeConnection()

You could step on the RecvLine. initializeScreen(), but I have no idea what
the side effects are. (And of course if you bypass all or part of it, even
if it works now, it's alway subject to future breakage.

On Tue, Aug 25, 2015 at 12:27 PM, Peter Westlake <peter.westlake at pobox.com>
wrote:

> I'm making a manhole service in the usual way:
>
>     class PF(ServerProtocol):
>         def protocolFactory(*a, **kw):
>             return manhole.Manhole(namespace)
>
>     realm = manhole_ssh.TerminalRealm()
>     realm.chainedProtocolFactory = PF
>     mh_portal = portal.Portal(realm)
>     mh_portal.registerChecker(checker)
>
>     manhole_service = TCPServer(0, manhole_ssh.ConchFactory(mh_portal))
>     manhole_service.startService()
>
> and I'd like to print a message when the terminal is opened. This change
> does it:
>
>     class PF(ServerProtocol):
>         def protocolFactory(*a, **kw):
>             class Manhole(manhole.Manhole):
>                 def connectionMade(self):
>                     super(Manhole, self).connectionMade()
>                     self.terminal.write('Hello')
>             return manhole.Manhole(namespace)
>
> and so does this version, which is better because
> t.c.i.i.ServerProtocol.connectionMade says it is the place to write
> messages:
>
>     class PF(ServerProtocol):
>         def protocolFactory(*a, **kw):
>             return manhole.Manhole(namespace)
>
>         def connectionMade(self):
>             ServerProtocol.connectionMade(self)
>             self.write('Hello')
>
> But in both cases, after the message the screen is cleared by what looks
> like a form feed, and another prompt is printed. So far I can't find where
> in the code this happens. Is there a way to print a message and not have it
> scrolled off the screen?
>
> Thanks,
>
> Peter.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150825/cf915b69/attachment-0002.html>

From JOHN at egh.com  Tue Aug 25 16:58:31 2015
From: JOHN at egh.com (John Santos)
Date: Tue, 25 Aug 2015 18:58:31 -0400
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>
Message-ID: <1150825182032.31305G-100000@joonya.egh.com>



Someone wrote:  (Sorry, reply in my mail client doesn't give me an
editable text version of the mail.  Instead, it is including it as an
attachment.  I don't know why this happens.  I do know from bitter
experience that if I don't delete the attachments from my reply, users
of brain-dead mail clients (I'm looking at you, Outlook) can't see
me reply but just see the attached copy of the original message.  So
I cut and pasted some context so people know what I'm talking about.)

> As to where it happens, look at
> twisted.conch.recvline.RecvLine.connectionMade() and
> twisted.conch.insults.insults.TerminalProtocol.makeConnection()
> 
> You could step on the RecvLine. initializeScreen(), but I have no idea what
> the side effects are. (And of course if you bypass all or part of it, even
> if it works now, it's alway subject to future breakage.
>
> On Tue, Aug 25, 2015 at 12:27 PM, Peter Westlake 
> <peter.westlake at pobox.com> wrote:
> >
> > I'm making a manhole service in the usual way:
[...]

t.c.r.R.connectionMade() calls self.initializeScreen(), which in turn 
calls self.terminal.reset()

I'm pretty sure s.t.reset() is actually twisted.conch.insults.reset(),
which has a bug (or an undesirable feature), it sends a "hard reset"
escape sequence to the terminal (<ESC>c).  This freaks out many terminal
emulators, and real, VT100-compatible terminals, in many different ways.

I've tested in Kermit-95, PuTTy, xterm, DECterm (a VT emulator written for
DECwindows, DEC's X implementation) and on real DEC VT420 and VT520
terminals.  They act differently, but none are pleasant.  For example, a
VT520 does a power-cycle on the CRT (which takes about 10 seconds),
reloads the saved configuration, and (if you have multiple sessions
enabled) switches to Session 1. 

The VT420 and VT520 manuals say about "hard reset", basically, "Don't
do that!!"

I have a patch to change it to send a soft reset (<ESC>[!p) and to set the
terminal into "replace mode" (<ESC>[4l) (sometimes the software thought it
was in overstrike mode, but the terminal thought it was in insert mode,
with bad results. Ideally, it would set both the software and hardware to
what ever mode the user desired.  The hard reset would set the terminal to
whichever mode was stored in its permanent settings.  For a software
terminal emulator, it was a dice roll.)

Depending on the terminal emulator or physical terminal you are using,
this probably explains your symptoms.

See ticket # 7514: https://twistedmatrix.com/trac/ticket/7514

-- 
John Santos
Evans Griffiths & Hart, Inc.
781-861-0670 ext 539

From todd.ulrich at cogeco.ca  Tue Aug 25 17:01:48 2015
From: todd.ulrich at cogeco.ca (J Todd Ulrich)
Date: Tue, 25 Aug 2015 18:01:48 -0500
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <1150825182032.31305G-100000@joonya.egh.com>
References: <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>
 <1150825182032.31305G-100000@joonya.egh.com>
Message-ID: <20150825230148.250654802.96021.559@cogeco.ca>

Can you remove me please. I am in NO WAY affiliated with your organization. Virus?

WalkTall.

JToddUlrich
m.416.625.3209

Pleaseexcusebrevityasthismessage sentfrommyBlackBerry10smartphone ontheRogersnetwork.
 Original Message 
From: John Santos
Sent: Tuesday, August 25, 2015 5:58 PM
To: Twisted general discussion
Reply To: Twisted general discussion
Subject: Re: [Twisted-Python] Screen clearing in the Manhole



Someone wrote: (Sorry, reply in my mail client doesn't give me an
editable text version of the mail. Instead, it is including it as an
attachment. I don't know why this happens. I do know from bitter
experience that if I don't delete the attachments from my reply, users
of brain-dead mail clients (I'm looking at you, Outlook) can't see
me reply but just see the attached copy of the original message. So
I cut and pasted some context so people know what I'm talking about.)

> As to where it happens, look at
> twisted.conch.recvline.RecvLine.connectionMade() and
> twisted.conch.insults.insults.TerminalProtocol.makeConnection()
> 
> You could step on the RecvLine. initializeScreen(), but I have no idea what
> the side effects are. (And of course if you bypass all or part of it, even
> if it works now, it's alway subject to future breakage.
>
> On Tue, Aug 25, 2015 at 12:27 PM, Peter Westlake 
> <peter.westlake at pobox.com> wrote:
> >
> > I'm making a manhole service in the usual way:
[...]

t.c.r.R.connectionMade() calls self.initializeScreen(), which in turn 
calls self.terminal.reset()

I'm pretty sure s.t.reset() is actually twisted.conch.insults.reset(),
which has a bug (or an undesirable feature), it sends a "hard reset"
escape sequence to the terminal (<ESC>c). This freaks out many terminal
emulators, and real, VT100-compatible terminals, in many different ways.

I've tested in Kermit-95, PuTTy, xterm, DECterm (a VT emulator written for
DECwindows, DEC's X implementation) and on real DEC VT420 and VT520
terminals. They act differently, but none are pleasant. For example, a
VT520 does a power-cycle on the CRT (which takes about 10 seconds),
reloads the saved configuration, and (if you have multiple sessions
enabled) switches to Session 1. 

The VT420 and VT520 manuals say about "hard reset", basically, "Don't
do that!!"

I have a patch to change it to send a soft reset (<ESC>[!p) and to set the
terminal into "replace mode" (<ESC>[4l) (sometimes the software thought it
was in overstrike mode, but the terminal thought it was in insert mode,
with bad results. Ideally, it would set both the software and hardware to
what ever mode the user desired. The hard reset would set the terminal to
whichever mode was stored in its permanent settings. For a software
terminal emulator, it was a dice roll.)

Depending on the terminal emulator or physical terminal you are using,
this probably explains your symptoms.

See ticket # 7514: https://twistedmatrix.com/trac/ticket/7514

-- 
John Santos
Evans Griffiths & Hart, Inc.
781-861-0670 ext 539



From peter.westlake at pobox.com  Wed Aug 26 05:00:50 2015
From: peter.westlake at pobox.com (Peter Westlake)
Date: Wed, 26 Aug 2015 12:00:50 +0100
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>
References: <1440520054.2262163.365674993.6595850F@webmail.messagingengine.com>
 <CACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi=P6GvMA@mail.gmail.com>
Message-ID: <1440586850.3188641.366433553.31489CBD@webmail.messagingengine.com>

On Tue, 25 Aug 2015, at 22:26, Brian Costlow wrote:

> As to where it happens, look at
> twisted.conch.recvline.RecvLine.connectionMade() and
> twisted.conch.insults.insults.TerminalProtocol.makeConnection()

My subclass of Manhole first calls Manhole.connectionMade, which calls
HistoricRecvLine.connectionMade, which calls RecvLine.connectionMade,
which resets the screen exactly as you say. Then, after the screen has
been reset, I print the message. But then the screen is cleared a
second time!

Peter.



From peter.westlake at pobox.com  Wed Aug 26 05:04:20 2015
From: peter.westlake at pobox.com (Peter Westlake)
Date: Wed, 26 Aug 2015 12:04:20 +0100
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <1150825182032.31305G-100000@joonya.egh.com>
References: <1150825182032.31305G-100000@joonya.egh.com>
Message-ID: <1440587060.3189439.366444017.5DDA86F9@webmail.messagingengine.com>

On Tue, 25 Aug 2015, at 23:58, John Santos wrote:
...
> t.c.r.R.connectionMade() calls self.initializeScreen(), which in turn 
> calls self.terminal.reset()
> 
> I'm pretty sure s.t.reset() is actually twisted.conch.insults.reset(),
> which has a bug (or an undesirable feature), it sends a "hard reset"
> escape sequence to the terminal (<ESC>c).  This freaks out many terminal
> emulators, and real, VT100-compatible terminals, in many different ways.
...
> Depending on the terminal emulator or physical terminal you are using,
> this probably explains your symptoms.
> 
> See ticket # 7514: https://twistedmatrix.com/trac/ticket/7514

This does sound like a scary bug, especially on a real terminal, but I
tried your patch and it didn't affect my symptom of the screen being
cleared again. That's more about "when" rather than "how".

Peter.



From peter.westlake at pobox.com  Wed Aug 26 06:46:38 2015
From: peter.westlake at pobox.com (Peter Westlake)
Date: Wed, 26 Aug 2015 13:46:38 +0100
Subject: [Twisted-Python] Screen clearing in the Manhole
In-Reply-To: <1440587060.3189439.366444017.5DDA86F9@webmail.messagingengine.com>
References: <1150825182032.31305G-100000@joonya.egh.com>
 <1440587060.3189439.366444017.5DDA86F9@webmail.messagingengine.com>
Message-ID: <1440593198.3213954.366517025.05E3E190@webmail.messagingengine.com>

I found it!

Manhole.terminalSize, inherited from RecvLine, does
self.terminal.eraseDisplay(). 
t.c.manhole_ssh.TerminalSessionTransport.__init__ calls terminalSize
*after* makeConnection.

Since setting the terminal size is a sensible thing to do, and it can't
be done before the connection is made, I'm not sure that much can be
done about this. I was able to make my message stay visible by
overriding terminalSize with a version that didn't erase, but that isn't
very clean or general.

Peter.



From hawkowl at atleastfornow.net  Thu Aug 27 06:28:46 2015
From: hawkowl at atleastfornow.net (Amber "Hawkie" Brown)
Date: Thu, 27 Aug 2015 20:28:46 +0800
Subject: [Twisted-Python] Twisted 15.4.0pre1 Prerelease Announcement
Message-ID: <8D500168-E7FE-4EDF-874E-B82E0AB60B89@atleastfornow.net>

Hello everyone!

Another few months, another Twisted release. This one has a few more Py3 goodies in it!

- twisted.positioning, the rest of twisted.internet.endpoints, KQueueReactor (for real this time), twisted.web.proxy/guard, and Trial (!!!) have all been ported to Python 3.
- Twisted officially supports several more platforms: Py3.4 on FreeBSD, Py2.7/Py3.4 on Fedora 21/22, and Py2.7 on RHEL7.
- Python 2.6 is no longer supported, and support for Debian 6, and RHEL6 has been removed because of this.
- Support for the EOL'd platforms of Fedora 17/18/19 has been removed.
- Twisted has moved to requiring setuptools for installation.
- twisted.python.failure.Failure's __repr__ now includes the  exception message.
- 19 tickets in total closed!

As usual, you can find the tarball and newsfile at http://twistedmatrix.com/Releases/pre/15.4.0pre1/ ! Please download them, test them, share them, appreciate them, make them a little nest so that they are comfortable. If there aren't any reported issues, this will be getting a full release soon.

Twisted Regards,

Amber "Hawkie" Brown
GPG: https://keybase.io/hawkowl

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 455 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: </pipermail/twisted-python/attachments/20150827/427331cd/attachment.sig>

From wangliyu at dhcc.com.cn  Thu Aug 27 06:32:29 2015
From: wangliyu at dhcc.com.cn (wangliyu at dhcc.com.cn)
Date: Thu, 27 Aug 2015 20:32:29 +0800
Subject: [Twisted-Python] Auto-Re: Twisted 15.4.0pre1 Prerelease Announcement
Message-ID: <1508272032292777479ebbc5a807a24d47509611bbe8@dhcc.com.cn>



----
--------------------------
Best Regards,



--------------------------

DHC Software Co.,Ltd.



Add11th floor,DHC Office Building,ZiJin Digital Park ,Zhongguancun,Haidian District, BeiJing ,China

311

 100190   18612695237

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150827/25a6f350/attachment-0002.html>

From jason.w.kane at gmail.com  Fri Aug 28 11:23:47 2015
From: jason.w.kane at gmail.com (Jason Kane)
Date: Fri, 28 Aug 2015 10:23:47 -0700
Subject: [Twisted-Python] doWrite called on a twisted.internet.tcp.Port
Message-ID: <CAJYM=XJzx3ijz5PigrtLshwPjy8m+OWmabvWB+eDhPALgb6xMg@mail.gmail.com>

https://twistedmatrix.com/trac/ticket/4759 -- I tried to post as a
comment in the Trac ticket but "SpamBayes determined spam probability
of 93.78%".

Same issue but w/Linux; I've been hacking around at it for a bit and
found a few things that might be helpful.  I am on old twisted
(12.1.0) using a backported protocols.memcache so this could be
self-inflicted.

Inside epollreactor doPoll() I added sanity checks to log when
_poller.poll() gives us an event flagged for READ on a fd that is
_not_ in self._reads (and similarly with writes).  Low and behold,
gobs of hits.  Unexpected.

So I took a closer look.  It appears to me that _epoll.epoll() is
emitting events that are outside of the flags that epollreactor
carefully registers.  Filtering them out in doPoll seems to avoid this
particular traceback but it also breaks the world.  At least in my
system this appears to be the expected behavior.

So (to restate and summarize) asserting on addWriter() doesn't do
anything because the Port was added by addReader().  Despite only
being in _reads() and being registered with _epoll.EPOLLIN, doPoll()
is getting write events which it happily passes through to
_doReadOrWrite which checks the event flag, sees it as a _POLL_OUT and
tries to write it.

I'll try the obvious (upgrade twisted to current) and see what happens.

[[https://gist.github.com/jason-kane/18f1516d7c1ef381b35e|Gist of my
diagnostic]]



From wangliyu at dhcc.com.cn  Fri Aug 28 11:27:48 2015
From: wangliyu at dhcc.com.cn (wangliyu at dhcc.com.cn)
Date: Sat, 29 Aug 2015 01:27:48 +0800
Subject: [Twisted-Python] Auto-Re: doWrite called on a
	twisted.internet.tcp.Port
Message-ID: <150829012748039f3fd47313bcbd38037b863fdfda38@dhcc.com.cn>



----
--------------------------
Best Regards,



--------------------------

DHC Software Co.,Ltd.



Add11th floor,DHC Office Building,ZiJin Digital Park ,Zhongguancun,Haidian District, BeiJing ,China

311

 100190   18612695237

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150829/dd999a09/attachment-0002.html>

From glyph at twistedmatrix.com  Fri Aug 28 23:28:49 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Sat, 29 Aug 2015 00:28:49 -0500
Subject: [Twisted-Python] doWrite called on a twisted.internet.tcp.Port
In-Reply-To: <CAJYM=XJzx3ijz5PigrtLshwPjy8m+OWmabvWB+eDhPALgb6xMg@mail.gmail.com>
References: <CAJYM=XJzx3ijz5PigrtLshwPjy8m+OWmabvWB+eDhPALgb6xMg@mail.gmail.com>
Message-ID: <3F6B8E52-A199-46DA-B0F9-698DDEF2E889@twistedmatrix.com>


> On Aug 28, 2015, at 12:23, Jason Kane <jason.w.kane at gmail.com> wrote:
> 
> https://twistedmatrix.com/trac/ticket/4759 -- I tried to post as a
> comment in the Trac ticket but "SpamBayes determined spam probability
> of 93.78%".

I've retrained the spam filter so hopefully you won't have this issue in the future.  I do make the point of training spambayes every day and we have few false positives like this - sorry about that!  If it makes you feel any better it properly rejected about 30 spams per one message of yours it rejected ;-).

> Same issue but w/Linux; I've been hacking around at it for a bit and
> found a few things that might be helpful.  I am on old twisted
> (12.1.0) using a backported protocols.memcache so this could be
> self-inflicted.
> 
> Inside epollreactor doPoll() I added sanity checks to log when
> _poller.poll() gives us an event flagged for READ on a fd that is
> _not_ in self._reads (and similarly with writes).  Low and behold,
> gobs of hits.  Unexpected.
> 
> So I took a closer look.  It appears to me that _epoll.epoll() is
> emitting events that are outside of the flags that epollreactor
> carefully registers.  Filtering them out in doPoll seems to avoid this
> particular traceback but it also breaks the world.  At least in my
> system this appears to be the expected behavior.
> 
> So (to restate and summarize) asserting on addWriter() doesn't do
> anything because the Port was added by addReader().  Despite only
> being in _reads() and being registered with _epoll.EPOLLIN, doPoll()
> is getting write events which it happily passes through to
> _doReadOrWrite which checks the event flag, sees it as a _POLL_OUT and
> tries to write it.
> 
> I'll try the obvious (upgrade twisted to current) and see what happens.
> 
> [[https://gist.github.com/jason-kane/18f1516d7c1ef381b35e|Gist of my
> diagnostic]]

Would you mind re-posting this to a comment, as it should work now?  If you have more problems with the spam filter I'll post it myself and credit you.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150829/10ed8b37/attachment-0002.html>

From trac at twistedmatrix.com  Sun Aug 30 00:05:31 2015
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 30 Aug 2015 06:05:31 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1440914731.55.3926023771478296822@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150830/60234a79/attachment-0002.html>

From wangliyu at dhcc.com.cn  Sun Aug 30 00:10:28 2015
From: wangliyu at dhcc.com.cn (wangliyu at dhcc.com.cn)
Date: Sun, 30 Aug 2015 14:10:28 +0800
Subject: [Twisted-Python] Auto-Re:  Weekly Bug Summary
Message-ID: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>



----
--------------------------
Best Regards,



--------------------------

DHC Software Co.,Ltd.



Add11th floor,DHC Office Building,ZiJin Digital Park ,Zhongguancun,Haidian District, BeiJing ,China

311

 100190   18612695237

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150830/54c28a57/attachment-0002.html>

From hs at ox.cx  Sun Aug 30 00:38:36 2015
From: hs at ox.cx (Hynek Schlawack)
Date: Sun, 30 Aug 2015 08:38:36 +0200
Subject: [Twisted-Python] Auto-Re:  Weekly Bug Summary
In-Reply-To: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>
References: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>
Message-ID: <685B3C22-79C9-49D4-8A07-C37F91710B75@ox.cx>

I wonder, is something weird with our Mailman configuration?  Because I haven't seen any other list (some with many more subscribers) that has this regular auto-responder problem.

Sent from my phone.

> Am 30.08.2015 um 08:10 schrieb wangliyu at dhcc.com.cn:
> 
> 
> 
> ----
> --------------------------
> Best Regards,
> 
> --------------------------
> DHC Software Co.,Ltd.
> 
> Add11th floor,DHC Office Building,ZiJin Digital Park ,Zhongguancun,Haidian District, BeiJing ,China
> 311
>  100190   18612695237
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150830/75db9c10/attachment-0002.html>

From glyph at twistedmatrix.com  Sun Aug 30 01:01:57 2015
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 30 Aug 2015 00:01:57 -0700
Subject: [Twisted-Python] Auto-Re:  Weekly Bug Summary
In-Reply-To: <685B3C22-79C9-49D4-8A07-C37F91710B75@ox.cx>
References: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>
 <685B3C22-79C9-49D4-8A07-C37F91710B75@ox.cx>
Message-ID: <7FABB97E-3930-4444-A32D-71CA40E0566C@twistedmatrix.com>



> On Aug 29, 2015, at 11:38 PM, Hynek Schlawack <hs at ox.cx> wrote:
> 
> I wonder, is something weird with our Mailman configuration?  Because I haven't seen any other list (some with many more subscribers) that has this regular auto-responder problem.

Nothing's changed about our configuration, so I'm not sure what has happened.  Did some other mail server change how it did auto-responses recently?

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150830/65a015ad/attachment-0002.html>

From hs at ox.cx  Sun Aug 30 02:25:31 2015
From: hs at ox.cx (Hynek Schlawack)
Date: Sun, 30 Aug 2015 10:25:31 +0200
Subject: [Twisted-Python] Auto-Re:  Weekly Bug Summary
In-Reply-To: <7FABB97E-3930-4444-A32D-71CA40E0566C@twistedmatrix.com>
References: <1508301410287c07ff0242203530129a5c93f1c53c02@dhcc.com.cn>
 <685B3C22-79C9-49D4-8A07-C37F91710B75@ox.cx>
 <7FABB97E-3930-4444-A32D-71CA40E0566C@twistedmatrix.com>
Message-ID: <56222950-E4C0-4C7F-A63B-31663159AA9F@ox.cx>

This isn't a new problem either; it's just more prevalent this year.  Typically emerges around some kind of holidays. 

Sent from my phone.

> Am 30.08.2015 um 09:01 schrieb Glyph <glyph at twistedmatrix.com>:
> 
> 
> 
>> On Aug 29, 2015, at 11:38 PM, Hynek Schlawack <hs at ox.cx> wrote:
>> 
>> I wonder, is something weird with our Mailman configuration?  Because I haven't seen any other list (some with many more subscribers) that has this regular auto-responder problem.
> 
> Nothing's changed about our configuration, so I'm not sure what has happened.  Did some other mail server change how it did auto-responses recently?
> 
> -glyph
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20150830/15ef7f6c/attachment-0002.html>

