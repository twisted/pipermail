<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] how to get extReceived call from SSHCommandClientEndpoint
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20how%20to%20get%20extReceived%20call%20from%0A%20SSHCommandClientEndpoint&In-Reply-To=%3CCAJB%3DZ84Bj-DdEqMWjpwX9DBFQMSj0_-UBSEMQbxvPhkEgxReGQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="064733.html">
   <LINK REL="Next"  HREF="064735.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] how to get extReceived call from SSHCommandClientEndpoint</H1>
    <B>Sereysethy TOUCH</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20how%20to%20get%20extReceived%20call%20from%0A%20SSHCommandClientEndpoint&In-Reply-To=%3CCAJB%3DZ84Bj-DdEqMWjpwX9DBFQMSj0_-UBSEMQbxvPhkEgxReGQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] how to get extReceived call from SSHCommandClientEndpoint">touch.sereysethy at gmail.com
       </A><BR>
    <I>Fri Apr  5 07:26:40 MDT 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="064733.html">[Twisted-Python] Twisted 19.2.0rc2 Release Candidate Announcement
</A></li>
        <LI>Next message (by thread): <A HREF="064735.html">[Twisted-Python] how to get extReceived call from SSHCommandClientEndpoint
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32273">[ date ]</a>
              <a href="thread.html#32273">[ thread ]</a>
              <a href="subject.html#32273">[ subject ]</a>
              <a href="author.html#32273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I am implementing a program using SSHCommandClientEndpoint, the program
works fine (dataReceived got calls) but when the server send an error
message (stderr..), the function extReceived in my protocol never gets
called, instead it only calls the one in the SSHChannel as I can see in the
log (got extended data 1 b': No such file or directory\n'). How to override
that? Or how to connect it to my protocol?

I adapted the program found on Twisted website.

Thanks,
Sethy

from twisted.conch.endpoints import SSHCommandClientEndpoint
from twisted.internet.protocol import Factory, Protocol
from twisted.python import log
import sys
from twisted.internet.defer import Deferred

class NoiseProtocol(Protocol):
    def connectionMade(self):
        print(&quot;connectionMade&quot;)
        self.finished = Deferred()
        self.strings = [&quot;bif&quot;, &quot;pow&quot;, &quot;zot&quot;]
        self.sendNoise()

    def sendNoise(self):
        if self.strings:
            self.transport.write(self.strings.pop(0) + &quot;\n&quot;)
        else:
            self.transport.loseConnection()


    def dataReceived(self, data):
        print(&quot;Server says:&quot;, data)
        self.sendNoise()

    def extReceived(self, dataType, data):
        print(&quot;extReceived&quot;)

    def connectionLost(self, reason):
        self.finished.callback(None)

command = b&quot;cat unknownfile&quot;

username = b&quot;XXXX&quot;
password = b&quot;XXXX&quot;
host = b&quot;server&quot;
port = 22

endpoint = SSHCommandClientEndpoint.newConnection(
    reactor, command, username, host, port,
    password=password, agentEndpoint=None)

factory = Factory()
factory.protocol = NoiseProtocol

d = endpoint.connect(factory)
d.addCallback(lambda proto: proto.finished)
log.startLogging(sys.stdout, setStdout=0)
reactor.run()
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20190405/4904a527/attachment.html&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="064733.html">[Twisted-Python] Twisted 19.2.0rc2 Release Candidate Announcement
</A></li>
	<LI>Next message (by thread): <A HREF="064735.html">[Twisted-Python] how to get extReceived call from SSHCommandClientEndpoint
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32273">[ date ]</a>
              <a href="thread.html#32273">[ thread ]</a>
              <a href="subject.html#32273">[ subject ]</a>
              <a href="author.html#32273">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
