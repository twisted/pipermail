<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Backward incompatible fixes to backward incompatible changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Backward%20incompatible%20fixes%20to%20backward%0A%20incompatible%20changes&In-Reply-To=%3C39040855-61B4-477A-862B-3608131CAE80%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="064758.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Backward incompatible fixes to backward incompatible changes</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Backward%20incompatible%20fixes%20to%20backward%0A%20incompatible%20changes&In-Reply-To=%3C39040855-61B4-477A-862B-3608131CAE80%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Backward incompatible fixes to backward incompatible changes">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Apr 30 23:24:29 MDT 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="064758.html">[Twisted-Python] Backward incompatible fixes to backward incompatible changes
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64759">[ date ]</a>
              <a href="thread.html#64759">[ thread ]</a>
              <a href="subject.html#64759">[ subject ]</a>
              <a href="author.html#64759">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Apr 25, 2019, at 9:52 AM, Jean-Paul Calderone wrote:
&gt;<i> Hello all,
</I>&gt;<i> 
</I>&gt;<i> I'd like to discuss the project policy/process for dealing with incorrect backward incompatibilities that end up released.
</I>&gt;<i> 
</I>&gt;<i> As a case study, we could look at <A HREF="https://twistedmatrix.com/trac/ticket/9410">https://twistedmatrix.com/trac/ticket/9410</A> &lt;<A HREF="https://twistedmatrix.com/trac/ticket/9410#comment:17">https://twistedmatrix.com/trac/ticket/9410#comment:17</A>&gt; / <A HREF="https://github.com/twisted/twisted/pull/1106">https://github.com/twisted/twisted/pull/1106</A> &lt;<A HREF="https://github.com/twisted/twisted/pull/1106">https://github.com/twisted/twisted/pull/1106</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> In Twisted 16.3.0 the behavior of Request.write was changed so that it raises an AttributeError if called after the connection has closed.  Prior to that release, it silently did nothing in that case.
</I>&gt;<i> 
</I>&gt;<i> Now, three years later, we have a PR which proposed restoring the behavior of silently ignoring the write to a closed connection.
</I>&gt;<i> 
</I>&gt;<i> The original change was incompatible.  The new change is incompatible.  What should win out?
</I>
There are two things to address here, I think:

In the general case, can we reverse changes to behavior which were desirable, but by-policy incompatible, and did not go through the incompatibility exception process, without going through the incompatibility exception process?

I'm choosing my words carefully here; changes might be &quot;desirable&quot; even if they're not intentional; they might be something that the caller expects even if they're not explicitly documented.  In general I'd say that we have to be careful with this kind of reversal and we should probably go through the compat exception process.  But I think the change in question doesn't actually fall into this category, because it's an exception that nobody wanted, wasn't documented, and wasn't intentional.  So it's in this other category:

Should we consider the raising of an undocumented exception to be a compatibility surface we must maintain compatibility with?

In this case, I think it depends on the type of the exception - specifically, whether the exception is defined in Twisted itself, or defined in a library that is clearly being invoked and whose behavior should be propagated.  So, for example, if you call connection.foo().bar() and you get FooCannotBeBarredError, this might something to be considered a compatibility concern.  However, if you call connection.foo().bar() and get an undocumented stdlib exception (KeyError, AttributeError, ValueError), I think it's okay to implicitly treat these as &quot;gross violations of specifications&quot;.

In the specific case you dealt with I agree with your evaluation and I'm glad we've landed the bugfix :-).

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20190430/9ea1c31e/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="064758.html">[Twisted-Python] Backward incompatible fixes to backward incompatible changes
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64759">[ date ]</a>
              <a href="thread.html#64759">[ thread ]</a>
              <a href="subject.html#64759">[ subject ]</a>
              <a href="author.html#64759">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
