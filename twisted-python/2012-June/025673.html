<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Python 3 support in Twisted: Request for	relaxation of coverage requirements
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Python%203%20support%20in%20Twisted%3A%20Request%20for%0A%09relaxation%20of%20coverage%20requirements&In-Reply-To=CAFu6gYZ%3DrTL1HSfBzg-hHzUXGQbJPGUPphi3dptMXeJ_vpgaaA%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025672.html">
   <LINK REL="Next"  HREF="025674.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Python 3 support in Twisted: Request for	relaxation of coverage requirements</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Python%203%20support%20in%20Twisted%3A%20Request%20for%0A%09relaxation%20of%20coverage%20requirements&In-Reply-To=CAFu6gYZ%3DrTL1HSfBzg-hHzUXGQbJPGUPphi3dptMXeJ_vpgaaA%40mail.gmail.com"
       TITLE="[Twisted-Python] Python 3 support in Twisted: Request for	relaxation of coverage requirements">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Jun 19 11:55:51 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="025672.html">[Twisted-Python] Python 3 support in Twisted: Request for relaxation of coverage requirements
</A></li>
        <LI>Next message: <A HREF="025674.html">[Twisted-Python] Python 3 support in Twisted: Request for relaxation of coverage requirements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25673">[ date ]</a>
              <a href="thread.html#25673">[ thread ]</a>
              <a href="subject.html#25673">[ subject ]</a>
              <a href="author.html#25673">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jun 19, 2012, at 7:43 AM, Vladimir Peri&#263; wrote:

&gt;<i> there are basically two strategies:
</I>&gt;<i> maintaining py2 code and using 2to3 when installing under py3, or
</I>&gt;<i> maintaining a codebase which is compatible with both 2 and 3
</I>
Based on the experiences of other porters I have talked to, and heard speaking on mailing lists, 2to3 still has yet to live up to its promise, and a unified codebase is much more manageable.  That said, there are syntax changes ('except...as...' being the big one) that make supporting 2.5-&gt;3 difficult, and only becomes reasonable at 2.6-&gt;3.  So it may be necessary to get 2to3 involved for some fixers.

&gt;<i> As such, I would like to request permission for the coverage
</I>&gt;<i> requirements to be relaxed for specific Python 3 changes. As mentioned
</I>&gt;<i> above, this would allow me to progress much faster and concentrate on
</I>&gt;<i> the bigger incompatibilities. Of course, I would still write tests for
</I>&gt;<i> more complex code, if and where required. 
</I>
History teaches us that &quot;simple&quot; or &quot;trivial&quot; changes which allegedly don't require tests because they are &quot;so obvious&quot; are pretty much always going to introduce critical bugs.  I like the idea of finding ways to avoid testing defunct code like what Itamar proposes, but a blanket exception to the testing policy is not acceptable to me.

That said, you don't have to write particularly awesome or thorough tests.  Any line of code can be reached by satisfying its dependencies and calling the function it's in.  So, if you need to, write trivial fakes or build on Twisted's existing library of test doubles (e.g. proto_helpers).

For example, let's say you're changing a method on a class whose initializer takes 30 arguments and all of them involve library objects from some heinously complex 3rd-party library with thousands of functions in it.  You don't need to actually make a &quot;real&quot; instance of the class, if it's just that one method which needs modification.  Write a test subclass which only works for that method, or even just suck out the im_func attribute and pass it a different 'self'.  (Oops!  Python 3 changes everything so you have to write a utility which converts a method-or-function into a function in a version-dependent way first.  But you get the idea.)

I guess this does represent some relaxation of the testing policy, since for a real functional change I probably wouldn't accept a test quite as gross as what I just described... but in this case, we're just trying to make sure the code still runs in both cases.

If this seems like more work than you signed up for... well, congratulations, this internship is providing you with a realistic view of professional software development ;-).

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20120619/5f5cebc7/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20120619/5f5cebc7/attachment-0001.htm</A> 
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025672.html">[Twisted-Python] Python 3 support in Twisted: Request for relaxation of coverage requirements
</A></li>
	<LI>Next message: <A HREF="025674.html">[Twisted-Python] Python 3 support in Twisted: Request for relaxation of coverage requirements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25673">[ date ]</a>
              <a href="thread.html#25673">[ thread ]</a>
              <a href="subject.html#25673">[ subject ]</a>
              <a href="author.html#25673">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
