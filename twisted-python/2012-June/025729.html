<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] txWS !!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20txWS%20%21%21&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025727.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] txWS !!</H1>
    <B>vinod kumar</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20txWS%20%21%21&In-Reply-To="
       TITLE="[Twisted-Python] txWS !!">vk.86.811 at gmail.com
       </A><BR>
    <I>Sat Jun 30 15:36:08 EDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="025727.html">[Twisted-Python] Twisted tutorial and Twisted sprint in San	Francisco
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25729">[ date ]</a>
              <a href="thread.html#25729">[ thread ]</a>
              <a href="subject.html#25729">[ subject ]</a>
              <a href="author.html#25729">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

 Thanks a lot for your reply. The trouble is that the events I have are
triggered by a homematic CCU. The CCU does it by multicall which has not
yet been implemented in twisted servers. So, I'm running a non-twisted
xmlrpc server in a thread so that my CCU triggers the events and it's
happening too. I can see the events printed on the console too. Now, I just
want a way to write the same to sockets. Can't we connect these to txWS
factory ? Doesn't the txWS has some socket object so that we can just say
socket.write..hmm

Thanks,
Vinodh
-------------------------------------------------------------------

Hi Vinodh,

txWS merely lets you connect to a Twisted Factory through WebSockets.
You will still need to structure your code such that the events that you
are responding to are connected to that Factory.

It might be helpful to rewrite your XML-RPC server to use Twisted's
XML-RPC (see
<A HREF="http://twistedmatrix.com/documents/current/web/howto/xmlrpc.html">http://twistedmatrix.com/documents/current/web/howto/xmlrpc.html</A> for a
tutorial on that) and then it will be easier to hook up your events
without having to worry about threading or other blocking things.

If you're having specific problems with txWS, let me know; it's
important to us that txWS work smoothly for people using it.

~ C.
-------------------------------
On Fri, Jun 29, 2012 at 04:52:06PM +0200, vinod kumar wrote:
&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i>    I have run and edited the example provided for txWS. The writing part
</I>&gt;<i> from server to client browser is shown only as self.transport.write()
</I>&gt;<i> inside dataReceived function in websockets.py. how do I write on to the
</I>&gt;<i> socket i.e. on to the browser, from a different function inside server
</I>&gt;<i> code(server.tac). I'm just starting another xmlrpc server on a thread
</I>where
&gt;<i> I receive some notifications. I need to forward the same to socket. The
</I>&gt;<i> bold point below  is where I want to write on to socket. How can we do
</I>&gt;<i> that? Please help me out.
</I>&gt;<i> -------------------------------------------------------
</I>&gt;<i> import time
</I>&gt;<i>
</I>&gt;<i> from twisted.internet import reactor
</I>&gt;<i> from twisted.application import internet
</I>&gt;<i> from twisted.application.service import Application, Service
</I>&gt;<i> import xmlrpclib
</I>&gt;<i> from txws import WebSocketFactory
</I>&gt;<i>
</I>&gt;<i> from src.protocols.websockets import WebSocketServerFactory
</I>&gt;<i> from constants import *
</I>&gt;<i>
</I>&gt;<i> class WebSocketService(Service):
</I>&gt;<i>     &quot;&quot;&quot;
</I>&gt;<i>     A simple service that listens on port 8077 for WebSockets traffic.
</I>&gt;<i>     &quot;&quot;&quot;
</I>&gt;<i>     def __init__(self):
</I>&gt;<i>         self.start_time = time.time()
</I>&gt;<i>
</I>&gt;<i>     def start_service(self, application):
</I>&gt;<i>         &quot;&quot;&quot;
</I>&gt;<i>         Gets the show on the road. Fires up a factory, binds the port.
</I>&gt;<i>         &quot;&quot;&quot;
</I>&gt;<i>         echofactory = WebSocketServerFactory(self)
</I>&gt;<i>         factory = WebSocketFactory(echofactory)
</I>&gt;<i>         ws_server = internet.TCPServer(8077, factory)
</I>&gt;<i>         ws_server.setName('ws-tcp')
</I>&gt;<i>         ws_server.setServiceParent(application)
</I>&gt;<i>
</I>&gt;<i>     def shutdown(self):
</I>&gt;<i>         &quot;&quot;&quot;
</I>&gt;<i>         Gracefully shuts down the service.
</I>&gt;<i>         &quot;&quot;&quot;
</I>&gt;<i>         reactor.callLater(0, reactor.stop)
</I>&gt;<i>
</I>&gt;<i> def listDevices(id):
</I>&gt;<i> print &quot;listDevice: %(id)s&quot; % {&quot;id&quot;: str(id)}
</I>&gt;<i>  return None
</I>&gt;<i>
</I>&gt;<i> def event(id, address, key, value):
</I>&gt;<i>         #websocket.send(&quot;ufffffffffuuuuuu&quot;)
</I>&gt;<i> *        #I need to write the below print statement on to browser *
</I>&gt;<i>         print &quot;event: %(id)s: %(address)s: %(key)s = %(value)s&quot; % {&quot;id&quot;:
</I>&gt;<i> str(id),
</I>&gt;<i> &quot;address&quot;: str(address), &quot;key&quot;: str(key), &quot;value&quot;: str(value)}
</I>&gt;<i>
</I>&gt;<i> def aSillyBlockingMethod(x):
</I>&gt;<i>     import time
</I>&gt;<i>     import xmlrpclib
</I>&gt;<i>     time.sleep(2)
</I>&gt;<i>     from SimpleXMLRPCServer import SimpleXMLRPCServer
</I>&gt;<i>     from SimpleXMLRPCServer import SimpleXMLRPCRequestHandler
</I>&gt;<i>     from constants import *
</I>&gt;<i>     server = SimpleXMLRPCServer((SERVER_IP, SERVER_PORT),
</I>logRequests=True,
&gt;<i> allow_none=True)
</I>&gt;<i>     server.register_introspection_functions()
</I>&gt;<i>     server.register_multicall_functions()
</I>&gt;<i>     print &quot;server started at %s&quot; % str(SERVER_URL)
</I>&gt;<i>     server.register_function(listDevices)
</I>&gt;<i>     server.register_function(event)
</I>&gt;<i>     print 'function also got registered'
</I>&gt;<i>     server.serve_forever()
</I>&gt;<i>     .............................continues
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Vinodh
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20120630/f5420b3a/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20120630/f5420b3a/attachment-0001.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025727.html">[Twisted-Python] Twisted tutorial and Twisted sprint in San	Francisco
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25729">[ date ]</a>
              <a href="thread.html#25729">[ thread ]</a>
              <a href="subject.html#25729">[ subject ]</a>
              <a href="author.html#25729">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
