<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Request for new Twisted release?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Request%20for%20new%20Twisted%20release%3F&In-Reply-To=%3C38e2f8bea7f7e8bfaa827f7986c41288%40fstab.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065261.html">
   <LINK REL="Next"  HREF="065252.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Request for new Twisted release?</H1>
    <B>Kyle Altendorf</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Request%20for%20new%20Twisted%20release%3F&In-Reply-To=%3C38e2f8bea7f7e8bfaa827f7986c41288%40fstab.net%3E"
       TITLE="[Twisted-Python] Request for new Twisted release?">sda at fstab.net
       </A><BR>
    <I>Mon Sep 28 12:35:11 MDT 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065261.html">[Twisted-Python] Request for new Twisted release?
</A></li>
        <LI>Next message (by thread): <A HREF="065252.html">[Twisted-Python] Retry: Conch Issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65262">[ date ]</a>
              <a href="thread.html#65262">[ thread ]</a>
              <a href="subject.html#65262">[ subject ]</a>
              <a href="author.html#65262">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I guess this one is top-posting...  Anyways, I would personally default
away from CI-provider-specific solutions.  It seems like a command line
tool ought to suffice?  But maybe there's some security something or
other I'm missing.  I just see that we presently use four CI systems so
picking one and expecting to stick with it seems a bit naive. 

Presumably someone will (helpfully) find an issue with this but I've
copied this between a few projects. 

<A HREF="https://github.com/altendky/pyqt5-tools/blob/b0ecb9bf53ded53c28763d76f1e87d0b8180d2b8/twineontag.py">https://github.com/altendky/pyqt5-tools/blob/b0ecb9bf53ded53c28763d76f1e87d0b8180d2b8/twineontag.py</A>


I know there are many other solutions. 

Since this topic is a bit more general than just PyPI uploads I've also
got a few comments about towncrier.  Per the link below I added
towncrier to my RTD builds so that PRs will render the newsfragments. 
Also, I started to vaguely think through some option for using towncrier
that would allow for creating a release by pushing a tag rather than
pulling a PR and doing various manual steps and modifying a generated
news file etc.  No answers yet, just a thing I'd like to get going at
some point.  Certainly `release by pushing a tag` is harder in bigger
projects but I don't have in mind yet a reason it can't happen. 

<A HREF="https://github.com/altendky/qtrio/blob/7a268c3fc14afe4cde7cbedd423d1f74f616a299/docs/source/conf.py#L133-L148">https://github.com/altendky/qtrio/blob/7a268c3fc14afe4cde7cbedd423d1f74f616a299/docs/source/conf.py#L133-L148</A>


Cheers, 

-kyle 

On 2020-09-28 13:48, Glyph wrote:

&gt;<i> Yes, please, let's do this!  I have been trying to fix or enable automated releases for smaller Twisted-org projects as I have time, but Twisted itself is a bit too tricky for my level of capacity during the end times. 
</I>&gt;<i> 
</I>&gt;<i> Kyle Altendorf has done quite a bit of work on this, so let's be sure to leverage that work and not to start over: <A HREF="https://twistedmatrix.com/trac/ticket/9531.">https://twistedmatrix.com/trac/ticket/9531.</A> 
</I>&gt;<i> 
</I>&gt;<i> -g
</I>&gt;<i> 
</I>&gt;<i> On Sep 28, 2020, at 9:25 AM, Craig Rodrigues &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rodrigc at crodrigues.org</A>&gt; wrote: 
</I>&gt;<i> 
</I>&gt;<i> Adi, 
</I>&gt;<i> 
</I>&gt;<i> In this Twisted subprostlject, you implemented something which releases to Pypi upon creation of a tag: 
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://github.com/twisted/twistedchecker/blob/master/.travis.yml#L23">https://github.com/twisted/twistedchecker/blob/master/.travis.yml#L23</A> 
</I>&gt;<i> 
</I>&gt;<i> Maybe we can do something similar for the main Twisted project. 
</I>&gt;<i> 
</I>&gt;<i> GitHub Actions allows you to run a specific workflow in response to a GitHub Release event:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://github.com/actions/create-release">https://github.com/actions/create-release</A> 
</I>&gt;<i> <A HREF="https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows#release">https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows#release</A> 
</I>&gt;<i> 
</I>&gt;<i> So maybe we can implement your suggested steps in a new GitHub Actions workflow specific to doing a release. 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Craig 
</I>&gt;<i> 
</I>&gt;<i> On Thu, Sep 24, 2020 at 4:32 PM Adi Roiban &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">adi at roiban.ro</A>&gt; wrote: 
</I>&gt;<i> 
</I>&gt;<i> Maybe the release can be simplified and automated: 
</I>&gt;<i> 
</I>&gt;<i> * Build the source and binary wheel in GitHub actions as this can be done for Linux (Ubuntu), Windows and macOS. 
</I>&gt;<i> * Host the download source and wheel files only on PyPi and publish them automatically from GitHub action on a new tag is created. 
</I>&gt;<i> * Host the documentation only on the Read The Docs. 
</I>&gt;<i> * Hos the API documentation on Read The Docs - might need some hacking, but at release we can create an API docs package as an artifact which is then pulled when Read The Docs documentation is created and copied as extra HTML files. 
</I>&gt;<i> * Move Twisted blog to GitHub pages... or even read the docs with a separate theme like Crate [1] ... if the blog is still required. 
</I>&gt;<i> 
</I>&gt;<i> ------ 
</I>&gt;<i> 
</I>&gt;<i> With the above implemented the release should look like: 
</I>&gt;<i> 
</I>&gt;<i> * Each time the tests for a PR are executed, pydoctor will run and automatically create the API files as an artifact available for download. 
</I>&gt;<i> * Manually create a new branch in which the version is updated and the changelog/news/release note is created and all the news fragment files are removed/ . Have the branch reviewed and approved with all the tests passed. When the pydoctor tests are executed, the API docs are created. 
</I>&gt;<i> * The release branches can have a naming convention line 'release-20.0.0`. At first the release branch can have a release candidate version and a GitHub can automatically push the release to PyPi. 
</I>&gt;<i> * Manually send an email to Twisted mailing list to announce the pre-release. 
</I>&gt;<i> * Once the branch is merged, manually push a new tag 
</I>&gt;<i> * The new tag should trigger the GitHub action for publishing the release on PyPi 
</I>&gt;<i> * The new merge in master should trigger the Read The Docs build... which now will also include the static API docs pages. 
</I>&gt;<i> * Once the release is done, manually send a new email to the mailing list. 
</I>&gt;<i> 
</I>&gt;<i> There are still many manual steps, but the only permissions required is commit to the repo. 
</I>&gt;<i> This will no longer use any of the Twisted own infrastructure. 
</I>&gt;<i> 
</I>&gt;<i> [1] <A HREF="https://sphinx-themes.org/html/crate-docs-theme/crate/basic.html">https://sphinx-themes.org/html/crate-docs-theme/crate/basic.html</A> 
</I>&gt;<i> -- 
</I>&gt;<i> Adi Roiban _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>
_______________________________________________
Twisted-Python mailing list
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20200928/517f4045/attachment.htm&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065261.html">[Twisted-Python] Request for new Twisted release?
</A></li>
	<LI>Next message (by thread): <A HREF="065252.html">[Twisted-Python] Retry: Conch Issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65262">[ date ]</a>
              <a href="thread.html#65262">[ thread ]</a>
              <a href="subject.html#65262">[ subject ]</a>
              <a href="author.html#65262">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
