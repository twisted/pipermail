<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Black enabled in trunk
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Black%20enabled%20in%20trunk&In-Reply-To=%3C01b03380-d8fe-4c0c-842b-8719b4ce4791%40www.fastmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065217.html">
   <LINK REL="Next"  HREF="065222.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Black enabled in trunk</H1>
    <B>Tom Most</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Black%20enabled%20in%20trunk&In-Reply-To=%3C01b03380-d8fe-4c0c-842b-8719b4ce4791%40www.fastmail.com%3E"
       TITLE="[Twisted-Python] Black enabled in trunk">twm at freecog.net
       </A><BR>
    <I>Mon Sep 14 00:45:43 MDT 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065217.html">[Twisted-Python]  Pycodestyle disabled in trunk, time to enable black?
</A></li>
        <LI>Next message (by thread): <A HREF="065222.html">[Twisted-Python] Black enabled in trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65220">[ date ]</a>
              <a href="thread.html#65220">[ thread ]</a>
              <a href="subject.html#65220">[ subject ]</a>
              <a href="author.html#65220">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

Craig and I have been working to land a switch to The *Black* Coding Style &lt;<A HREF="https://black.readthedocs.io/en/stable/the_black_code_style.html">https://black.readthedocs.io/en/stable/the_black_code_style.html</A>&gt;. It's in! The tree has been reformatted &lt;<A HREF="https://github.com/twisted/twisted/commit/bc96c774be6e307e8e3e4d39780d37b045d0973a">https://github.com/twisted/twisted/commit/bc96c774be6e307e8e3e4d39780d37b045d0973a</A>&gt;. Some notable changes:

* 3-2-1 blank lines are replaced by PEP 8 style 2-1-1.
* String syntax uses &quot;double quotes&quot;.

Run this command to exclude the formatting from git blame &lt;<A HREF="https://github.com/twisted/twisted/blob/trunk/.git-blame-ignore-revs">https://github.com/twisted/twisted/blob/trunk/.git-blame-ignore-revs</A>&gt;:

    git config blame.ignoreRevsFile .git-blame-ignore-revs

There are two new Tox testenvs. To check style:

    tox -e black

To adjust the formatting:

    tox -e black-reformat

The formatting is checked by a new GitHub Actions lint built.

There is some follow-up work planned:

* Many PRs have conflicts (more on this below).
* Various wiki pages need updates. I've done a few, but there are probably more.
* The coding standard should be updated &lt;<A HREF="https://twistedmatrix.com/trac/ticket/9957#ticket">https://twistedmatrix.com/trac/ticket/9957#ticket</A>&gt;.
* The PR template needs an update &lt;<A HREF="https://twistedmatrix.com/trac/ticket/9956#ticket">https://twistedmatrix.com/trac/ticket/9956#ticket</A>&gt;.
* A few examples need reformatting &lt;<A HREF="https://tm.tl/#9952">https://tm.tl/#9952</A>&gt; (they weren't formatted because they fail to lint).

Inevitably, changes like this cause conflicts. For small PRs it's easiest to merge forward and then run tox -e black-reformat. For larger ones it can help to apply formatting before merge. To do this:

* Run black on the files your branch changes (be sure to use Black 20.8b1, not an older version)
* Commit the result, like `git commit -am &quot;Fade to black&quot;`
* Add that commit to .git-blame-ignore-revs to avoid polluting git blame.
* Merge forward. You can ignore formatting while performing the merge.
* Then run `tox -e black-reformat` to ensure you are in sync. Commit any changes it generates.

A big thanks to Hawkowl for kicking this all off and Craig for quick review turnaround. May we all be mildly displeased with the formatting, yet never have to review it again!

---Tom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20200913/39f550a0/attachment.htm&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065217.html">[Twisted-Python]  Pycodestyle disabled in trunk, time to enable black?
</A></li>
	<LI>Next message (by thread): <A HREF="065222.html">[Twisted-Python] Black enabled in trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65220">[ date ]</a>
              <a href="thread.html#65220">[ thread ]</a>
              <a href="subject.html#65220">[ subject ]</a>
              <a href="author.html#65220">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
