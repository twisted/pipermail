<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Test coverage requirements
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Test%20coverage%20requirements&In-Reply-To=%3CCAFycZ9csLME4uZUcvt06dPx5KGRbJRXfq2qUZGZBuixZJ-7QMQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="063720.html">
   <LINK REL="Next"  HREF="063726.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Test coverage requirements</H1>
    <B>Adi Roiban</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Test%20coverage%20requirements&In-Reply-To=%3CCAFycZ9csLME4uZUcvt06dPx5KGRbJRXfq2qUZGZBuixZJ-7QMQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Test coverage requirements">adi at roiban.ro
       </A><BR>
    <I>Mon Feb 27 02:06:33 MST 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="063720.html">[Twisted-Python] Test coverage requirements
</A></li>
        <LI>Next message (by thread): <A HREF="063726.html">[Twisted-Python] Test coverage requirements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63721">[ date ]</a>
              <a href="thread.html#63721">[ thread ]</a>
              <a href="subject.html#63721">[ subject ]</a>
              <a href="author.html#63721">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 26 February 2017 at 23:51, Jean-Paul Calderone
&lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm looking at some recent trunk commits (also, others) that seem to have
</I>&gt;<i> non-trivial untested code at at ReviewProcess.  I can't tell if the codecov
</I>&gt;<i> reports are wrong or if the development process documentation is wrong or if
</I>&gt;<i> the commits just violate policy or (I guess) some mix of the three.
</I>&gt;<i>
</I>&gt;<i> Can anyone shed any light on this?
</I>
Besise <A HREF="https://codecov.io/gh/twisted/twisted/pulls/509/diff,">https://codecov.io/gh/twisted/twisted/pulls/509/diff,</A> the other
PRs looks OK and with good coverage.

In terms of codecov.io coverage I am using the &quot;diff&quot; view as I find
it less confusing.

The strong red lines are the ones which codecov considered that were
part of the patch and were not covered.
The yellow lines are for missing branch coverage in this patch... and
they will decrease the coverage percentage.

In summary:

For PR 509 - The diff coverage is 74.39%. ... this looks bad
For PR 652 -  The diff coverage is 98.7% ... not perfect, but pretty
good as the missing lines are in the test code area :)

--------

At some point we had a commit status check for 100% diff coverage, but
I remember that it was not popular.

If we are not aiming for the ultimate quality dev process we can still
consider having a lower barer of something like 75% or 95% diff
coverage... For PR less of this value, you will see a big warning...
but people from the Twisted admin team can still commit them. Simple
(non-admin) collaborators can only merge them of the diff coverage is
above that limit.

I am for a check for 100% coverage as many times it helped me get out
of comfort zone and &quot;forced&quot; to write better tests  and better code
... I know that libertarians might not like being forced to do things
so I understand why the hard check was not popular.

----------

For the good PRs which were mentioned here

For <A HREF="https://codecov.io/gh/twisted/twisted/pulls/695/diff">https://codecov.io/gh/twisted/twisted/pulls/695/diff</A> the only line
without a coverage is the one in which the exception is raised if the
reactor is installed twice.

For <A HREF="https://codecov.io/gh/twisted/twisted/pulls/652/diff">https://codecov.io/gh/twisted/twisted/pulls/652/diff</A> the uncovered
lines are the case in which a tests is is not skipped on OSX (this is
strange ... but maybe osx coverage are no longer published) ... and
the other one is the self.fail which is expected not be be called.

I think there was a discussion about covering self.fail() calls by
extracting them into assertion helper and making sure we have tests
for those assertion helpers.... so that we can ask all changes to also
have 100% test code coverage :)

For <A HREF="https://codecov.io/gh/twisted/twisted/pulls/432/diff">https://codecov.io/gh/twisted/twisted/pulls/432/diff</A> there were
some changes in formatting (some parenthesis) which were indented and
that code was not previously covered ... so now it is considered code
on which someone made a change without having the tests to cover the
changes.

-- 
Adi Roiban


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="063720.html">[Twisted-Python] Test coverage requirements
</A></li>
	<LI>Next message (by thread): <A HREF="063726.html">[Twisted-Python] Test coverage requirements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63721">[ date ]</a>
              <a href="thread.html#63721">[ thread ]</a>
              <a href="subject.html#63721">[ subject ]</a>
              <a href="author.html#63721">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
