<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] If the errbacks of a canceled Deferred are called with error other than CancelledError, is this acceptable?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20If%20the%20errbacks%20of%20a%20canceled%20Deferred%20are%0A%20called%20with%20error%20other%20than%20CancelledError%2C%20is%20this%20acceptable%3F&In-Reply-To=%3CCACqnu4ViCVY8_nagurVvf2SkF3HkyM4X6femLac9QVSZ0PQ4bg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027126.html">
   <LINK REL="Next"  HREF="027141.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] If the errbacks of a canceled Deferred are called with error other than CancelledError, is this acceptable?</H1>
    <B>Terry Jones</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20If%20the%20errbacks%20of%20a%20canceled%20Deferred%20are%0A%20called%20with%20error%20other%20than%20CancelledError%2C%20is%20this%20acceptable%3F&In-Reply-To=%3CCACqnu4ViCVY8_nagurVvf2SkF3HkyM4X6femLac9QVSZ0PQ4bg%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] If the errbacks of a canceled Deferred are called with error other than CancelledError, is this acceptable?">terry at jon.es
       </A><BR>
    <I>Fri Jun 21 04:41:19 MDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027126.html">[Twisted-Python] If the errbacks of a canceled Deferred are	called with error other than CancelledError, is this acceptable?
</A></li>
        <LI>Next message: <A HREF="027141.html">[Twisted-Python] If the errbacks of a canceled Deferred are	called with error other than CancelledError, is this acceptable?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27128">[ date ]</a>
              <a href="thread.html#27128">[ thread ]</a>
              <a href="subject.html#27128">[ subject ]</a>
              <a href="author.html#27128">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi again Tom

&gt;<i> So, it seems to me that you want to represent your jobs as
</I>&gt;<i> more than simply a deferred. At the very least, you need to record what
</I>&gt;<i> the jobs is, so that it can be restarted later, if necessary.
</I>
Yes. The job class contained things like the function to call, its args,
timing information etc., as well a deferred that would fire with the result.

&gt;<i> Deferreds are a way of abstracting data and/or control flow in
</I>&gt;<i> asynchronous way. I'm not sure that trying to think of a deferred as a
</I>&gt;<i> job is a useful thing to do
</I>
I wasn't doing that.

The problem that I was originally trying to address by getting 'cancel'
into deferreds is that the control flow you mention gets totally stuck if a
deferred never fires for some reason (this was happening to me in talking
to the Twitter API). E.g., in this case, kicking off a new job relies on an
earlier job finishing (which includes a deferred firing). An app writer
might want to timeout a deferred for some reason. Or the app may need to
shut down. If there's even one deferred that doesn't fire, the whole system
essentially hangs. The idea was simply to increase the amount of control an
app had over the flow of control.

This goes against the thinking that only the code that creates a deferred
can fire it. I don't see anything wrong with that - it just increases the
options that the code which obtains the deferred has. As API writers, we're
used to being in control: we don't think it's a good idea if we create and
return a deferred in a method and the code we return the deferred to then
fires it itself. But as app writers consuming deferreds from these APIs, we
want more control (I do, anyway).  It's possible to have both, which was
what I was trying to provide for. The ControllableDeferred2013 class I
posted last night shows one way. Adding a value arg to cancel() would build
some of that flexibility into Twisted itself.

Hopefully that helps makes things clearer.

Terry


On Fri, Jun 21, 2013 at 7:18 AM, Tom Prince &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">tom.prince at ualberta.net</A>&gt; wrote:

&gt;<i> Terry Jones &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">terry at jon.es</A>&gt; writes:
</I>&gt;<i> &gt; But, I also built some queuing things where I would have liked extra
</I>&gt;<i> &gt; information. For example, an app is processing jobs on behalf of a user,
</I>&gt;<i> &gt; [...]
</I>&gt;<i>
</I>&gt;<i> Thinking about this for a little bit, it seems like there is quite a bit
</I>&gt;<i> more state to your jobs, that simply an eventual result (i.e. a
</I>&gt;<i> deferred). So, it seems to me that you want to represent your jobs as
</I>&gt;<i> more than simply a deferred. At the very least, you need to record what
</I>&gt;<i> the jobs is, so that it can be restarted later, if necessary.
</I>&gt;<i>
</I>&gt;<i> Deferreds are a way of abstracting data and/or control flow in
</I>&gt;<i> asynchronous way. I'm not sure that trying to think of a deferred as a
</I>&gt;<i> job is a useful thing to do; most any example of a job that I can think
</I>&gt;<i> of likely involves multiple deferred objects (often chained by returning
</I>&gt;<i> them from callbcks).
</I>&gt;<i>
</I>&gt;<i>   Tom
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20130621/fed2cdca/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20130621/fed2cdca/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027126.html">[Twisted-Python] If the errbacks of a canceled Deferred are	called with error other than CancelledError, is this acceptable?
</A></li>
	<LI>Next message: <A HREF="027141.html">[Twisted-Python] If the errbacks of a canceled Deferred are	called with error other than CancelledError, is this acceptable?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27128">[ date ]</a>
              <a href="thread.html#27128">[ thread ]</a>
              <a href="subject.html#27128">[ subject ]</a>
              <a href="author.html#27128">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
