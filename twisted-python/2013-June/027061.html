<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Simple bidirectional Socket Client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Simple%20bidirectional%20Socket%20Client&In-Reply-To=%3C20130614123146.GA3983%40murdoc%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027060.html">
   <LINK REL="Next"  HREF="027067.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Simple bidirectional Socket Client</H1>
    <B>Marco Giusti</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Simple%20bidirectional%20Socket%20Client&In-Reply-To=%3C20130614123146.GA3983%40murdoc%3E"
       TITLE="[Twisted-Python] Simple bidirectional Socket Client">marco.giusti at gmail.com
       </A><BR>
    <I>Fri Jun 14 06:31:46 MDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027060.html">[Twisted-Python] Simple bidirectional Socket Client
</A></li>
        <LI>Next message: <A HREF="027067.html">[Twisted-Python] Announcing twisted-dev-tools
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27061">[ date ]</a>
              <a href="thread.html#27061">[ thread ]</a>
              <a href="subject.html#27061">[ subject ]</a>
              <a href="author.html#27061">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Jun 14, 2013 at 02:11:20PM +0200, Raketenschnitzel wrote:
...
&gt;<i> class Communicator(ClientFactory):
</I>&gt;<i>     protocol = ControllerProtocol
</I>&gt;<i> 
</I>&gt;<i>     def __init__(self, Host, Port):
</I>&gt;<i>         if isinstance(Host, str) and isinstance(Port, int) :
</I>&gt;<i>             self.myHost = Host
</I>&gt;<i>             self.myPort = Port
</I>&gt;<i>             self.isConnected = False
</I>&gt;<i>             print 'Going To connect'
</I>&gt;<i>             self.connectToMother()
</I>&gt;<i> 
</I>&gt;<i>     def connectToMotherShip(self):
</I>&gt;<i>         reactor.connectTCP(self.myHost, self.myPort, self)
</I>&gt;<i>         reactor.run()
</I>&gt;<i> 
</I>...
&gt;<i> class Operator:
</I>&gt;<i>     def __init__(self):
</I>&gt;<i>     self.myCommunicator = Communicator(&quot;192.168.1.12&quot;, 815)
</I>&gt;<i>     do other stuff ...
</I>&gt;<i> 
</I>&gt;<i> I want an Operator Object that builds the Communicator. The
</I>&gt;<i> communicator updates values of the Operator asynchronously if it
</I>&gt;<i> receives messages. Each 10 secs the Operator will initiate a
</I>&gt;<i> Communicator.sendMessage to send a status information to the server.
</I>&gt;<i> 
</I>&gt;<i> Two questions:
</I>&gt;<i> 1) Is it possible to solve my task like this with twisted and if so,
</I>&gt;<i> how do I get my Communicator to not block my Operator?
</I>
The operator is blocked because reactor.run() is a loop, do not call it
inside the factory constructor.

	class Communicator(ClientFactory):

		isConnected = False

		def __init__(self):
			pass

	class Operator:
		def __init__(self):
			# do other stuff but do not use self.myCommunicator yet


factory = Communicator()
operator = Operator()
operator.myCommunicator = factory
reactor.connectTCP(host, port, factory)
reactor.run()


&gt;<i> 2) If twisted is not the easiest way for this approach, do i have
</I>&gt;<i> alternatives? I want at least something event driven. I also read
</I>&gt;<i> about the asyncore packages, but people often recommend twisted over
</I>&gt;<i> asyncore.
</I>&gt;<i> 
</I>&gt;<i> I simply want to send and receive message with a &quot;threaded&quot;
</I>&gt;<i> communicator class, while doing other stuff in my Operator.
</I>
The great advantage of twisted is that you do not need to use threads to
communicate to the external world, use it only if you have to run code
that could &quot;block&quot; the main loop. But in my modest opinion, twisted is
the easiest way to do network programming.

Ciao
m.

</PRE>






































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027060.html">[Twisted-Python] Simple bidirectional Socket Client
</A></li>
	<LI>Next message: <A HREF="027067.html">[Twisted-Python] Announcing twisted-dev-tools
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27061">[ date ]</a>
              <a href="thread.html#27061">[ thread ]</a>
              <a href="subject.html#27061">[ subject ]</a>
              <a href="author.html#27061">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
