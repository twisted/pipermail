<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] logging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20logging&In-Reply-To=%3C7FDD43C4-4456-4ED3-9F7F-EF14FC34EB44%40ox.cx%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059535.html">
   <LINK REL="Next"  HREF="059545.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] logging</H1>
    <B>Hynek Schlawack</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20logging&In-Reply-To=%3C7FDD43C4-4456-4ED3-9F7F-EF14FC34EB44%40ox.cx%3E"
       TITLE="[Twisted-Python] logging">hs at ox.cx
       </A><BR>
    <I>Sat Jun 15 01:18:03 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059535.html">[Twisted-Python] logging
</A></li>
        <LI>Next message (by thread): <A HREF="059545.html">[Twisted-Python] logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59536">[ date ]</a>
              <a href="thread.html#59536">[ thread ]</a>
              <a href="subject.html#59536">[ subject ]</a>
              <a href="author.html#59536">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Am 15.06.2013 um 08:18 schrieb Christopher Armstrong &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">radix at twistedmatrix.com</A>&gt;:

&gt;&gt;<i> As far as actual *proposals* go, I have these ones, that are all independent:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 1. include all keyword arguments in log output without requiring
</I>&gt;&gt;<i> specifying the formatting in the string
</I>&gt;&gt;<i> 2. make it really easy to specify the &quot;system&quot;
</I>&gt;&gt;<i> 3. stop affecting the &quot;system&quot; of application code based on the
</I>&gt;&gt;<i> framework code that's running the application code (i.e., don't use
</I>&gt;&gt;<i> callWithContext to specify the system any more)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Of these, I think #2 and #3 have the most benefit; I can do #1 with my
</I>&gt;&gt;<i> own logging statements just fine, and while IMO it'd be nice if the
</I>&gt;&gt;<i> whole world adopted a nice identifier-based system, the lion's share
</I>&gt;&gt;<i> of the benefit comes from my use of it consistently in the
</I>&gt;&gt;<i> application's codebase.
</I>&gt;<i> 
</I>&gt;<i> This conversation has gotten pretty sprawling; time to reel it in with
</I>&gt;<i> some code.
</I>&gt;<i> 
</I>&gt;<i> What do you think of this for an API that meets in the middle?
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://gist.github.com/radeex/5787124">https://gist.github.com/radeex/5787124</A>
</I>&gt;<i> 
</I>&gt;<i> This example implementation only concerns itself with the points under
</I>&gt;<i> debate right now; obviously it's completely unusable in general. But
</I>&gt;<i> anyway:
</I>&gt;<i> 
</I>&gt;<i> 1. it supports English logs
</I>&gt;<i> 2. it doesn't require you to specify a formatting if you want to just
</I>&gt;<i> log a bunch of data
</I>&gt;<i> 3. it makes it easy to specify a system (both manually and based on
</I>&gt;<i> the module your code is in)
</I>
I’ve held back from this discussion so far because it seemed to me that I always missed some part of the discussion to fully understand what you’re all talking about. I would like to comment on this concrete proposal though before I hold my peace forever. (NB I’m not replying just to Christopher but try to address everything I saw on the thread so far – I like most of his proposal.)

I find that there’s some kind of false dichotomy brought up in this discussion and API and output are somewhat muddled together a bit (maybe I’m just misunderstanding though – that’s why I didn’t comment until now).

I personally like my logs 100% structured (except for Exceptions) and still be able to “comment” on events in plain English if I need to.

And I don’t see why comments/events should be special case on output (square brackets in this example). If you have an event called user_error, you can always add a key called error for another “symbol” or just an error_msg if you insist on English. When looking for a certain type of user_error, you simply write an AND clause in your logging software (Kibana or whatever). It’s pretty easy to keep *that* consistent across applications.

For example, *my* log would look like this:

event=user_error peer=127.0.0.1 error=pebkac

If the programmer in question hadn’t enough logging pain in their life to see that’s reasonable, they can always do:

event=user_error peer=127.0.0.1 error_msg='Problem exists between keyboard and chair.'

Still perfectly parseable, perfectly readable. And with {!r} easy to achieve. A nice API I would like to have be:

log('user_error', peer=self.transport.getPeer().host, error_msg='Problem exists between keyboard and chair.') – and log figures out itself if it needs to quote. I could also live with them all quoted, i.e.:

event='user_error' peer='127.0.0.1' error='pebkac'

to have less special cases.


I hope that makes some sense, the point I’m trying to make that events don’t need to be distinct by themselves. If you enforce that, you’re forcing structure on them which you could spread over multiple fields that are *much* more pleasant to parse.

Regards,
Hynek

P.S. For convenience, I usually write a log method in Twisted protocols that prepends the messages with state data, peer IP etc, but that JFTR.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059535.html">[Twisted-Python] logging
</A></li>
	<LI>Next message (by thread): <A HREF="059545.html">[Twisted-Python] logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59536">[ date ]</a>
              <a href="thread.html#59536">[ thread ]</a>
              <a href="subject.html#59536">[ subject ]</a>
              <a href="author.html#59536">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
