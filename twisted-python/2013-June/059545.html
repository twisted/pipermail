<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] logging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20logging&In-Reply-To=%3CCAPkRfUSzhxZ4BHwUWE96-Y2n9JKmd%2BQfMjQa4yfdruXtu_EtDA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059536.html">
   <LINK REL="Next"  HREF="059550.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] logging</H1>
    <B>Christopher Armstrong</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20logging&In-Reply-To=%3CCAPkRfUSzhxZ4BHwUWE96-Y2n9JKmd%2BQfMjQa4yfdruXtu_EtDA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] logging">radix at twistedmatrix.com
       </A><BR>
    <I>Sat Jun 15 09:33:25 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059536.html">[Twisted-Python] logging
</A></li>
        <LI>Next message (by thread): <A HREF="059550.html">[Twisted-Python] logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59545">[ date ]</a>
              <a href="thread.html#59545">[ thread ]</a>
              <a href="subject.html#59545">[ subject ]</a>
              <a href="author.html#59545">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Jun 15, 2013 at 2:18 AM, Hynek Schlawack &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">hs at ox.cx</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Am 15.06.2013 um 08:18 schrieb Christopher Armstrong &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">radix at twistedmatrix.com</A>&gt;:
</I>&gt;&gt;<i> What do you think of this for an API that meets in the middle?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="https://gist.github.com/radeex/5787124">https://gist.github.com/radeex/5787124</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This example implementation only concerns itself with the points under
</I>&gt;&gt;<i> debate right now; obviously it's completely unusable in general. But
</I>&gt;&gt;<i> anyway:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. it supports English logs
</I>&gt;&gt;<i> 2. it doesn't require you to specify a formatting if you want to just
</I>&gt;&gt;<i> log a bunch of data
</I>&gt;&gt;<i> 3. it makes it easy to specify a system (both manually and based on
</I>&gt;&gt;<i> the module your code is in)
</I>&gt;<i>
</I>&gt;<i> I’ve held back from this discussion so far because it seemed to me that I always missed some part of the discussion to fully understand what you’re all talking about. I would like to comment on this concrete proposal though before I hold my peace forever. (NB I’m not replying just to Christopher but try to address everything I saw on the thread so far – I like most of his proposal.)
</I>&gt;<i>
</I>&gt;<i> I find that there’s some kind of false dichotomy brought up in this discussion and API and output are somewhat muddled together a bit (maybe I’m just misunderstanding though – that’s why I didn’t comment until now).
</I>
You're right. I didn't make a strong enough point about the fact that
the output formatting isn't important, but I assumed everyone already
knew that. I should have been more clear.


&gt;<i> I personally like my logs 100% structured (except for Exceptions) and still be able to “comment” on events in plain English if I need to.
</I>&gt;<i>
</I>&gt;<i> And I don’t see why comments/events should be special case on output (square brackets in this example). If you have an event called user_error, you can always add a key called error for another “symbol” or just an error_msg if you insist on English. When looking for a certain type of user_error, you simply write an AND clause in your logging software (Kibana or whatever). It’s pretty easy to keep *that* consistent across applications.
</I>&gt;<i>
</I>&gt;<i> For example, *my* log would look like this:
</I>&gt;<i>
</I>&gt;<i> event=user_error peer=127.0.0.1 error=pebkac
</I>
The special formatting in the example I gave was only intended for the
dumb file-based format. I thought it was just a nice touch on the spur
of the moment. In practice, I would use this for local logging, but
then set up a log observer that passed raw key/value data to my real
log aggregation/storage/filtering system. I'm making a distinction
between what we show our users (in a twistd.log file) and what we give
to our automated systems (sent over network protocols to logging
systems).

&gt;<i> If the programmer in question hadn’t enough logging pain in their life to see that’s reasonable, they can always do:
</I>&gt;<i>
</I>&gt;<i> event=user_error peer=127.0.0.1 error_msg='Problem exists between keyboard and chair.'
</I>&gt;<i>
</I>&gt;<i> Still perfectly parseable, perfectly readable. And with {!r} easy to achieve. A nice API I would like to have be:
</I>&gt;<i>
</I>&gt;<i> log('user_error', peer=self.transport.getPeer().host, error_msg='Problem exists between keyboard and chair.') – and log figures out itself if it needs to quote. I could also live with them all quoted, i.e.:
</I>&gt;<i>
</I>&gt;<i> event='user_error' peer='127.0.0.1' error='pebkac'
</I>&gt;<i>
</I>&gt;<i> to have less special cases.
</I>
It sounds like you're arguing that the human-readable *.log format
should be closer to the simple key/value representation that we use
underneath.

Would you also argue that instead of having a log line that looks like:

2013-06-15 10:24:21-0500 [-] Server Shut Down.

We should actually format them (in twistd.log) like this?

time=1371331461.0 system='-' msg='Server Shut Down.'

&gt;<i> I hope that makes some sense, the point I’m trying to make that events don’t need to be distinct by themselves. If you enforce that, you’re forcing structure on them which you could spread over multiple fields that are *much* more pleasant to parse.
</I>
So, if I had my own way, &quot;event&quot; would be a required argument to the
log() function in my example, so that the only thing I'm forcing on
the structure of a log message is that you *have* an event argument.

But I'm pretty sure that's not going to fly. :-) So the only reason I
wanted to support &quot;event&quot; in a special way in my example is to
emphasize and encourage its use.

&gt;<i> Hynek
</I>

--
Christopher Armstrong
<A HREF="http://radix.twistedmatrix.com/">http://radix.twistedmatrix.com/</A>
<A HREF="http://planet-if.com/">http://planet-if.com/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059536.html">[Twisted-Python] logging
</A></li>
	<LI>Next message (by thread): <A HREF="059550.html">[Twisted-Python] logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59545">[ date ]</a>
              <a href="thread.html#59545">[ thread ]</a>
              <a href="subject.html#59545">[ subject ]</a>
              <a href="author.html#59545">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
