<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] thread in reactor problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20thread%20in%20reactor%20problem&In-Reply-To=%3C8ae5ea120708072058t71bbceb0pdb64aa6df92897ff%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="048343.html">
   <LINK REL="Next"  HREF="048345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] thread in reactor problem</H1>
    <B>Yan Zhu</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20thread%20in%20reactor%20problem&In-Reply-To=%3C8ae5ea120708072058t71bbceb0pdb64aa6df92897ff%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] thread in reactor problem">nayuhz at gmail.com
       </A><BR>
    <I>Tue Aug  7 21:58:25 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="048343.html">[Twisted-Python] Foolscap-0.1.5 released
</A></li>
        <LI>Next message (by thread): <A HREF="048345.html">[Twisted-Python] thread in reactor problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48344">[ date ]</a>
              <a href="thread.html#48344">[ thread ]</a>
              <a href="subject.html#48344">[ subject ]</a>
              <a href="author.html#48344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all, I run a reactor in my thread, so I will get many connection by
twisted, and I run another thread for write back data to any connection.
But I've found the data is in buffer, not sent back immediately.  I traced
the twisted, found it blocked in class SelectReactor.doSelect():

while 1:
    try:
        r, w, ignored = _select(reads.keys(),
        writes.keys(),
        [], timeout)
        break
    ... ...
    #do sth

when the reactor is bloce by _select(), then my another thread modified the
*writes* dictionary, but _select could not know if writes.keys() is changed,
so when the thread want to write something, reactor won't do response. so,
the problem is above.

Is there any idea for this?
thanks~

-- 
eSX
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20070808/8c296909/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="048343.html">[Twisted-Python] Foolscap-0.1.5 released
</A></li>
	<LI>Next message (by thread): <A HREF="048345.html">[Twisted-Python] thread in reactor problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48344">[ date ]</a>
              <a href="thread.html#48344">[ thread ]</a>
              <a href="subject.html#48344">[ subject ]</a>
              <a href="author.html#48344">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
