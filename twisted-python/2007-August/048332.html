<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Design pattern for multi-stage web searches
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Design%20pattern%20for%20multi-stage%20web%20searches&In-Reply-To=%3C4331ad810708060516r6381dbd6pc262dad5ba35989%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="048329.html">
   <LINK REL="Next"  HREF="048326.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Design pattern for multi-stage web searches</H1>
    <B>Luciano Ramalho</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Design%20pattern%20for%20multi-stage%20web%20searches&In-Reply-To=%3C4331ad810708060516r6381dbd6pc262dad5ba35989%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Design pattern for multi-stage web searches">luciano at ramalho.org
       </A><BR>
    <I>Mon Aug  6 06:16:59 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="048329.html">[Twisted-Python] Design pattern for multi-stage web searches
</A></li>
        <LI>Next message (by thread): <A HREF="048326.html">[Twisted-Python] Where to start: log reader/analysis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48332">[ date ]</a>
              <a href="thread.html#48332">[ thread ]</a>
              <a href="subject.html#48332">[ subject ]</a>
              <a href="author.html#48332">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you very much for the reply, Jean-Paul. I'll study it and
probably make changes to my code. It seems the chaining mechanism you
explain can improve the generality of my code and at the same time
simplify the implementation.

If anyone starting with Twisted wants to see an example of using
several deferreds, the code I wrote is here:

<A HREF="http://svn.zope.org/Sandbox/luciano/kirbi/kirbifetch/src/kirbifetch/">http://svn.zope.org/Sandbox/luciano/kirbi/kirbifetch/src/kirbifetch/</A>

The file which uses the deferreds is fetch.py.

Not that the code above is a work-in-progress, tests are not automated
yet, and the style of chaining Jean-Paul suggested is not yet
implemented: currenlty each callback explicitly initiates another
deferred, without chaining.

Anyway, I hope my code is useful as an example.

Regards,

Luciano



On 8/6/07, Jean-Paul Calderone &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at divmod.com</A>&gt; wrote:
&gt;<i> On Sun, 5 Aug 2007 16:39:00 -0300, Luciano Ramalho &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">luciano at ramalho.org</A>&gt; wrote:
</I>&gt;<i> &gt;Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;I am a Google Summer of Code student working with the Zope 3/Grok
</I>&gt;<i> &gt;community this year.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;I wonder if there is an established design pattern or examples that
</I>&gt;<i> &gt;use Twisted to fetch data via HTTP when the process can take a
</I>&gt;<i> &gt;variable number of requests to be completed.
</I>&gt;<i>
</I>&gt;<i> This is usually done by &quot;chaining&quot; Deferreds together.  When a callback
</I>&gt;<i> or errback function on Deferred A returns Deferred B, B is chained to a:
</I>&gt;<i>
</I>&gt;<i>     B.chainDeferred(A)
</I>&gt;<i>
</I>&gt;<i> or
</I>&gt;<i>
</I>&gt;<i>     B.addCallbacks(A.callback, A.errback)
</I>&gt;<i>
</I>&gt;<i> So if you fetch a page and it turns out not to be the one you ultimately
</I>&gt;<i> want, a callback on that Deferred can initiate another fetch and return
</I>&gt;<i> the Deferred for that operation.  This is transparent to the caller of
</I>&gt;<i> the original function: their callbacks are only called once all of the
</I>&gt;<i> earlier callbacks have returned a None-Deferred value and all returned
</I>&gt;<i> Deferreds have fired.
</I>&gt;<i>
</I>&gt;<i> I doubt I've explained this particularly well, so you might want to take
</I>&gt;<i> a look at <A HREF="http://twistedmatrix.com/projects/core/documentation/howto/defer.html">http://twistedmatrix.com/projects/core/documentation/howto/defer.html</A> to
</I>&gt;<i> really get an understanding.
</I>&gt;<i>
</I>&gt;<i> Jean-Paul
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="048329.html">[Twisted-Python] Design pattern for multi-stage web searches
</A></li>
	<LI>Next message (by thread): <A HREF="048326.html">[Twisted-Python] Where to start: log reader/analysis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48332">[ date ]</a>
              <a href="thread.html#48332">[ thread ]</a>
              <a href="subject.html#48332">[ subject ]</a>
              <a href="author.html#48332">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
