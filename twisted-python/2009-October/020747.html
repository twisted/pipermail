<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to chain deferred calls
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20chain%20deferred%20calls&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020746.html">
   <LINK REL="Next"  HREF="020749.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to chain deferred calls</H1>
    <B>Terry Jones</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20chain%20deferred%20calls&In-Reply-To="
       TITLE="[Twisted-Python] How to chain deferred calls">terry at jon.es
       </A><BR>
    <I>Thu Oct 22 21:13:00 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020746.html">[Twisted-Python] How to chain deferred calls
</A></li>
        <LI>Next message: <A HREF="020749.html">[Twisted-Python] How to chain deferred calls
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20747">[ date ]</a>
              <a href="thread.html#20747">[ thread ]</a>
              <a href="subject.html#20747">[ subject ]</a>
              <a href="author.html#20747">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;&gt;&gt;&gt;&gt;<i> &quot;vitaly&quot; == vitaly  &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">vitaly at synapticvision.com</A>&gt; writes:
</I>
vitaly&gt; Thank you a lot for pointing me to the Twisted doc-s, but we're
vitaly&gt; discussing the following snippet:
[snip]
vitaly&gt; and basically, I've expected in case of exception
vitaly&gt; self.handleFailure1() to be called, but I don't see it happen.

The reason you're not seeing handleFailure1 being called is that the
exception is not occurring in the context of deferred processing. You've
got a regular Python function call, a regular exception is raised, etc.
Twisted and its deferred do not / cannot alter that behavior.

What they *can* do is handle exceptions and turn them into failures and
route the failure to an errback chain *in the context of calling functions
that have been added to a deferred*.  Because your abc1 has not been added
to any deferred's call/errback chain, none of that happens when your
exception is raised.

If your code looked like this (pseudocode), you would see the exception

    return (
         self.abc1().
         addErrback(self.handleFailure1).
         addCallback(self.abc2,args).
         addCallback(self.abc3).
         addErrback(self.handleFailure2)
    )

    def abc1(self):
        d = defer.Deferred()
        d.addCallback(raiser)
        d.callback(1)
        return d

    def raiser(self, _):
        raise Exception(&quot;Error11&quot;)

Because the thing that raises is being called by Twisted's deferred class,
and its exception is caught and routed to d's errback chain and winds up in
the handleFailure1 method.

Does that make sense?

Terry

</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020746.html">[Twisted-Python] How to chain deferred calls
</A></li>
	<LI>Next message: <A HREF="020749.html">[Twisted-Python] How to chain deferred calls
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20747">[ date ]</a>
              <a href="thread.html#20747">[ thread ]</a>
              <a href="subject.html#20747">[ subject ]</a>
              <a href="author.html#20747">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
