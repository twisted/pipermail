<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to find out if exceptions are being raised	in your errBack?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20find%20out%20if%20exceptions%20are%20being%20raised%0A%09in%20your%20errBack%3F&In-Reply-To=E096D98B-3BD0-464A-94DF-C28ED3337066%40integrateddevcorp.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020685.html">
   <LINK REL="Next"  HREF="020689.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to find out if exceptions are being raised	in your errBack?</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20find%20out%20if%20exceptions%20are%20being%20raised%0A%09in%20your%20errBack%3F&In-Reply-To=E096D98B-3BD0-464A-94DF-C28ED3337066%40integrateddevcorp.com"
       TITLE="[Twisted-Python] How to find out if exceptions are being raised	in your errBack?">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Oct 14 02:07:49 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020685.html">[Twisted-Python] How to find out if exceptions are being raised in	your errBack?
</A></li>
        <LI>Next message: <A HREF="020689.html">[Twisted-Python] How to find out if exceptions are being	raised	in your errBack?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20688">[ date ]</a>
              <a href="thread.html#20688">[ thread ]</a>
              <a href="subject.html#20688">[ subject ]</a>
              <a href="author.html#20688">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Oct 13, 2009 at 8:02 PM, Steve Steiner (listsin) &lt;
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">listsin at integrateddevcorp.com</A>&gt; wrote:

&gt;<i> I've been hunting down a problem that I've finally found the cause of
</I>&gt;<i> and I'd like to know what's the Twisted way to catch this &quot;error
</I>&gt;<i> within the code handling the error&quot;  type of error.
</I>&gt;<i>
</I>
The right way to catch this is to write tests for your code and run them
before deploying it to production :).  Trial will helpfully fail tests which
cause exceptions to be logged, so you don't need to write any special extra
test to make sure that nothing is blowing up; just test your error-handling
case, and if it blows up you will see it.


&gt;<i> Basically, in one branch of the errBack, there was a typo.  A simple
</I>&gt;<i> typo that caused an unhandled NameError exception, but only once in  a
</I>&gt;<i> few thousand runs.
</I>&gt;<i>
</I>
If it's a NameError, you also could have used Pyflakes to catch it :).


&gt;<i> The exception got caught and &quot;displayed&quot; by Twisted, but it wasn't
</I>&gt;<i> going anyplace anyone was looking (buried under zillions of lines of
</I>&gt;<i> logging) and the app continues on as if nothing went wrong.
</I>&gt;<i>
</I>
The real lesson here is that you should be paying attention to logged
tracebacks.

There are many ways to do this.  Many operations teams running Twisted
servers will trawl the logs with regular expressions.  Not my preferred way
of doing it, but I'm not really an ops person :).

If you want to handle logged exceptions specially, for example to put them
in a separate file, or to e-mail them to somebody, consider writing a log
observer that checks for the isError key and does something special there.
You can find out more about writing log observers here: &lt;
<A HREF="http://twistedmatrix.com/projects/core/documentation/howto/logging.html">http://twistedmatrix.com/projects/core/documentation/howto/logging.html</A>&gt;.


&gt;<i> What is the best way to handle programming errors like this in
</I>&gt;<i> deferreds so they don't slip by, unnoticed?
</I>&gt;<i>
</I>
I'm answering a question you didn't ask, about logged errors, because I
think it's the one you meant to ask.  The answer to the question you are
actually asking here, i.e. &quot;how do I handle errors in an errback&quot;, is quite
simple: add another errback.  This is sort of like asking how to handle
exceptions in an 'except:' block in Python.  For example, if you want to
catch errors from this code:

try:
  foo()
except:
  oops()

you could modify it to look like this:

try:
  foo()
except:
  try:
    oops()
  except:
    handleOopsOops()

which is what adding another errback is like.  But, as I said: I don't think
this is what you want, since it will only let you handle un-handled errors
in Deferreds (not unhandled errors in, for example, protocols) and you will
have to attach your error-handling callbacks everywhere (not to mention
trying to guess a sane return value for the error-handler-error-handler.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20091014/7c4cd6a6/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20091014/7c4cd6a6/attachment.htm</A> 
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020685.html">[Twisted-Python] How to find out if exceptions are being raised in	your errBack?
</A></li>
	<LI>Next message: <A HREF="020689.html">[Twisted-Python] How to find out if exceptions are being	raised	in your errBack?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20688">[ date ]</a>
              <a href="thread.html#20688">[ thread ]</a>
              <a href="subject.html#20688">[ subject ]</a>
              <a href="author.html#20688">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
