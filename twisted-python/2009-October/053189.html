<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to find out if exceptions are being raised in	your errBack?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20find%20out%20if%20exceptions%20are%20being%20raised%20in%0A%09your%20errBack%3F&In-Reply-To=%3CE096D98B-3BD0-464A-94DF-C28ED3337066%40integrateddevcorp.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="053187.html">
   <LINK REL="Next"  HREF="053192.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to find out if exceptions are being raised in	your errBack?</H1>
    <B>Steve Steiner (listsin)</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20find%20out%20if%20exceptions%20are%20being%20raised%20in%0A%09your%20errBack%3F&In-Reply-To=%3CE096D98B-3BD0-464A-94DF-C28ED3337066%40integrateddevcorp.com%3E"
       TITLE="[Twisted-Python] How to find out if exceptions are being raised in	your errBack?">listsin at integrateddevcorp.com
       </A><BR>
    <I>Tue Oct 13 18:02:47 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="053187.html">[Twisted-Python] python-twisted-akonadi and akonadi-gtk
</A></li>
        <LI>Next message (by thread): <A HREF="053192.html">[Twisted-Python] How to find out if exceptions are being raised	in your errBack?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53189">[ date ]</a>
              <a href="thread.html#53189">[ thread ]</a>
              <a href="subject.html#53189">[ subject ]</a>
              <a href="author.html#53189">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been hunting down a problem that I've finally found the cause of  
and I'd like to know what's the Twisted way to catch this &quot;error  
within the code handling the error&quot;  type of error.

Basically, in one branch of the errBack, there was a typo.  A simple  
typo that caused an unhandled NameError exception, but only once in  a  
few thousand runs.

The exception got caught and &quot;displayed&quot; by Twisted, but it wasn't  
going anyplace anyone was looking (buried under zillions of lines of  
logging) and the app continues on as if nothing went wrong.

I've put up a simple app that demonstrates the issue: <A HREF="http://pastebin.com/m59217f60">http://pastebin.com/m59217f60</A>

If you put in a 404 error URL, let it run through, you'll see the 404  
error printed out, the exception will occur in the background, and the  
program just keeps on going.

If you then hit Ctrl-C, you can see the traceback showing that Twisted  
caught the NameError .

What is the best way to handle programming errors like this in  
deferreds so they don't slip by, unnoticed?

Thanks,

S

(~/twisted_err)# ./errs_away.py
URL: <A HREF="http://www.yahoo.com">http://www.yahoo.com</A>
line = <A HREF="http://www.yahoo.com">http://www.yahoo.com</A>
Got data, len ==  9490
URL: <A HREF="http://thereisnodomainnamedthis.com">http://thereisnodomainnamedthis.com</A>
line = <A HREF="http://thereisnodomainnamedthis.com">http://thereisnodomainnamedthis.com</A>
Error: DNS lookup failed: address 'thereisnodomainnamedthis.com' not  
found: [Errno 8] nodename nor servname provided, or not known.
URL: <A HREF="http://www.yahoo.com/non-existent-page">http://www.yahoo.com/non-existent-page</A>
line = <A HREF="http://www.yahoo.com/non-existent-page">http://www.yahoo.com/non-existent-page</A>
Error: 400 Bad Request	&lt;====== This triggers the code with the bad  
variable
URL: ^C		&lt;============= manually stop the program

============= Then, you get to see the traceback ==================
Unhandled error in Deferred:
Traceback (most recent call last):
   File &quot;/System/Library/Frameworks/Python.framework/Versions/2.6/ 
Extras/lib/python/twisted/web/client.py&quot;, line 143, in handleResponse
     self.status, self.message, response)))
   File &quot;/System/Library/Frameworks/Python.framework/Versions/2.6/ 
Extras/lib/python/twisted/web/client.py&quot;, line 309, in noPage
     self.deferred.errback(reason)
   File &quot;/System/Library/Frameworks/Python.framework/Versions/2.6/ 
Extras/lib/python/twisted/internet/defer.py&quot;, line 269, in errback
     self._startRunCallbacks(fail)
   File &quot;/System/Library/Frameworks/Python.framework/Versions/2.6/ 
Extras/lib/python/twisted/internet/defer.py&quot;, line 312, in  
_startRunCallbacks
     self._runCallbacks()
--- &lt;exception caught here&gt; ---
   File &quot;/System/Library/Frameworks/Python.framework/Versions/2.6/ 
Extras/lib/python/twisted/internet/defer.py&quot;, line 328, in _runCallbacks
     self.result = callback(self.result, *args, **kw)
   File &quot;./errs_away.py&quot;, line 15, in printError
     print oops      # variable's not defined...
exceptions.NameError: global name 'oops' is not defined

Thanks,

S




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="053187.html">[Twisted-Python] python-twisted-akonadi and akonadi-gtk
</A></li>
	<LI>Next message (by thread): <A HREF="053192.html">[Twisted-Python] How to find out if exceptions are being raised	in your errBack?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53189">[ date ]</a>
              <a href="thread.html#53189">[ thread ]</a>
              <a href="subject.html#53189">[ subject ]</a>
              <a href="author.html#53189">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
