<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Example of a long-polling asynchronous web	servic?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Example%20of%20a%20long-polling%20asynchronous%20web%0A%09servic%3F&In-Reply-To=d9047f780910062046v4d1abf6dxd4e5f38ee7fd0765%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020619.html">
   <LINK REL="Next"  HREF="020624.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Example of a long-polling asynchronous web	servic?</H1>
    <B>Stephen Mattison</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Example%20of%20a%20long-polling%20asynchronous%20web%0A%09servic%3F&In-Reply-To=d9047f780910062046v4d1abf6dxd4e5f38ee7fd0765%40mail.gmail.com"
       TITLE="[Twisted-Python] Example of a long-polling asynchronous web	servic?">stephenmattison at gmail.com
       </A><BR>
    <I>Wed Oct  7 00:06:20 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020619.html">[Twisted-Python] Example of a long-polling asynchronous web	servic?
</A></li>
        <LI>Next message: <A HREF="020624.html">[Twisted-Python] sleeping in inlineCallbacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20621">[ date ]</a>
              <a href="thread.html#20621">[ thread ]</a>
              <a href="subject.html#20621">[ subject ]</a>
              <a href="author.html#20621">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Glyph thanks for responding so promptly! First if I understand correctly
on the server-side we have some code like:

def get_data_updates():
   if (!has_updates):
      return NO_DATA
   return json.encode(the_updates)

and on the client side

def poll_for_updates():
   while True:
      response = service.get_data_updates()
      if response != NO_DATA: break
      sleep(1)
   do_something_with_response(response)
   poll_for_updates()

As far as I can tell doing this has NO guarantee that all messages are
delivered unless every server-&gt;client connection maintains a stack of &quot;new&quot;
messages, whereas in a message-brokered setting the server just keeps
sending &quot;global&quot; updates as they occur, and the broker guarantees that
clients will receive every one. Where as in this situation, since the client
is asking the server for updates, unless the server strictly maintains all
of the updates for a specific client, some of them might be thrown on the
ground.

Am I correct here?



On Tue, Oct 6, 2009 at 8:46 PM, Glyph Lefkowitz &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt;wrote:

&gt;<i> On Tue, Oct 6, 2009 at 11:30 PM, Stephen Mattison &lt;
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">stephenmattison at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> How can I implement this in Twisted?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> You can use DeferredResource:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/documents/8.2.0/api/twisted.web.util.DeferredResource.html">http://twistedmatrix.com/documents/8.2.0/api/twisted.web.util.DeferredResource.html</A>
</I>&gt;<i>
</I>&gt;<i> or you can return NOT_DONE_YET from Resource.render(), and hold on to the
</I>&gt;<i> request:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/documents/8.2.0/api/twisted.web.resource.Resource.html#render">http://twistedmatrix.com/documents/8.2.0/api/twisted.web.resource.Resource.html#render</A>
</I>&gt;<i>
</I>&gt;<i> to leave the connection open until something happens.
</I>&gt;<i>
</I>&gt;<i> For a more elaborate example of a long-polling server component, you could
</I>&gt;<i> see Nevow's Athena:
</I>&gt;<i>
</I>&gt;<i>     <A HREF="http://www.divmod.org/trac/wiki/DivmodNevow/Athena">http://www.divmod.org/trac/wiki/DivmodNevow/Athena</A>
</I>&gt;<i>
</I>&gt;<i> This does not implement JSON-RPC or XML-RPC, but it has lots of code for
</I>&gt;<i> managing the outstanding connection, which may give you some ideas.
</I>&gt;<i>
</I>&gt;<i> -Glyph
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Stephen Mattison
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20091006/de70ddf6/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20091006/de70ddf6/attachment.htm</A> 
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020619.html">[Twisted-Python] Example of a long-polling asynchronous web	servic?
</A></li>
	<LI>Next message: <A HREF="020624.html">[Twisted-Python] sleeping in inlineCallbacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20621">[ date ]</a>
              <a href="thread.html#20621">[ thread ]</a>
              <a href="subject.html#20621">[ subject ]</a>
              <a href="author.html#20621">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
