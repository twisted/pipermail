<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Lots and lots and lots and lots... of	deferreds
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Lots%20and%20lots%20and%20lots%20and%20lots...%20of%09deferreds&In-Reply-To=%3C20091007032553.GO1931%40steerpike.home.puzzling.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="053119.html">
   <LINK REL="Next"  HREF="053126.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Lots and lots and lots and lots... of	deferreds</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Lots%20and%20lots%20and%20lots%20and%20lots...%20of%09deferreds&In-Reply-To=%3C20091007032553.GO1931%40steerpike.home.puzzling.org%3E"
       TITLE="[Twisted-Python] Lots and lots and lots and lots... of	deferreds">andrew at bemusement.org
       </A><BR>
    <I>Tue Oct  6 21:25:53 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="053119.html">[Twisted-Python] Lots and lots and lots and lots... of deferreds
</A></li>
        <LI>Next message (by thread): <A HREF="053126.html">[Twisted-Python] Lots and lots and lots and lots... of	deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53120">[ date ]</a>
              <a href="thread.html#53120">[ thread ]</a>
              <a href="subject.html#53120">[ subject ]</a>
              <a href="author.html#53120">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Steve Steiner (listsin) wrote:
[...]
&gt;<i> 	I expect the usual flurry of  &quot;you must post your exact code or we  
</I>&gt;<i> can't help you at all, moron&quot; posts, but...
</I>
I'll try to restrain myself ;)

&gt;<i> 	In spite of my not having posted specific code, could someone with  
</I>&gt;<i> some actual experience in this please give me a clue, within an order  
</I>&gt;<i> of magnitude, how many deferreds might start to cause real trouble?
</I>
None.  Deferreds aren't the problem; they are just Python objects.  You can
probably have *millions* of them without great difficulty.  They are a symptom,
not a cause.

The problem is more likely the underlying operations that are linked to the
Deferreds.  My two top guesses are:

 1) the web server failing to cope with thousands of concurrent requests
    gracefully, or
 2) the number of sockets is hitting a system limit (number of FDs you can pass
    to select(), or hitting the max number of file descriptors, something like
    that)

in that order.

For the second one, assuming you're on Linux, you may benefit from a trivial
change to use the epoll reactor rather than the default one.  For the first one,
you're at the mercy of the webserver.  IIRC the RFCs say that clients SHOULD use
no more than two concurrent connections to a server...

Regardless, I imagine you're unlikely to get much performance benefit from
hammering a server with 1000 concurrent requests over something much smaller,
like 5 or 10.  So I'd use a DeferredSemaphore, or perhaps look into using
Cooperator, and not worry about solving the mystery how to make 1000s of
concurrent requests work.

Of course, if you give more specific info about how your code fails and what it
does I might be able to give more specific advice... ;)

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="053119.html">[Twisted-Python] Lots and lots and lots and lots... of deferreds
</A></li>
	<LI>Next message (by thread): <A HREF="053126.html">[Twisted-Python] Lots and lots and lots and lots... of	deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53120">[ date ]</a>
              <a href="thread.html#53120">[ thread ]</a>
              <a href="subject.html#53120">[ subject ]</a>
              <a href="author.html#53120">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
