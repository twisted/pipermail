<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Understanding Deferreds/callback further
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Understanding%20Deferreds/callback%20further&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014292.html">
   <LINK REL="Next"  HREF="014296.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Understanding Deferreds/callback further</H1>
    <B>Yi Qiang</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Understanding%20Deferreds/callback%20further&In-Reply-To="
       TITLE="[Twisted-Python] Understanding Deferreds/callback further">yqiang at gmail.com
       </A><BR>
    <I>Thu Nov  2 18:33:47 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="014292.html">[Twisted-Python] Problem with ftp upload
</A></li>
        <LI>Next message: <A HREF="014296.html">[Twisted-Python] Understanding Deferreds/callback further
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14290">[ date ]</a>
              <a href="thread.html#14290">[ thread ]</a>
              <a href="subject.html#14290">[ subject ]</a>
              <a href="author.html#14290">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi guys,
I am still having trouble writing programs that will make the most use of
deferreds.  I will describe the problem I am trying to solve and the
solution I've tried.

The problem:
I am trying to write a client that gets a job from a PB server, processes
it, submits the result and gets another job.  I need to be able to do this
for multiple jobs (i.e. I need to be able to get 5 jobs, and start 5 similar
chains: get job --&gt; work on job --&gt; submit result --&gt; get another job).
This looks like a perfectly solvable problem using deferreds since working
on the job might take a while and using callbacks seems to be the most
appropriate.

So I have something like this in my main method:

monitor = Monitor(server, port)
monitor.connect()


    def connect(self):
        factory = pb.PBClientFactory()
        reactor.connectTCP(self.hostname, self.port, factory)
        return factory.login(self.credentials).addCallback(
                            self._connected).addErrback(
                            self._catch_failure)

Then in self._connected I would like to start the chain of getting
jobs/processing them/submitting jobs:

    def _connected(self, remoteobj):
        self.remoteobj = remoteobj

        for worker in self.workers:
            self.get_jobs(worker).addCallback(
                                    self._got_job, worker).addCallback(
                                    self.get_jobs, worker).addErrback(
                                    self._catch_failure)

_got_job takes both a job and a worker and starts to process the job.  Which
for now returns a defer.succeed().
This is the part where I stumble on though, the exact implementation of how
to make it so that one calls back the other.
Any help would be appreciated.  Please let me know also if you need more
specific information.

Thanks,
Yi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20061102/6855a763/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20061102/6855a763/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014292.html">[Twisted-Python] Problem with ftp upload
</A></li>
	<LI>Next message: <A HREF="014296.html">[Twisted-Python] Understanding Deferreds/callback further
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14290">[ date ]</a>
              <a href="thread.html#14290">[ thread ]</a>
              <a href="subject.html#14290">[ subject ]</a>
              <a href="author.html#14290">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
