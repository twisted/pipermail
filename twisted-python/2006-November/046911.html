<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Need Exception that will stop ther reactor	within twistd
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Need%20Exception%20that%20will%20stop%20ther%20reactor%0A%09within%20twistd&In-Reply-To=%3C20061125053921.22613.1049902426.divmod.xquotient.356%40joule.divmod.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="046909.html">
   <LINK REL="Next"  HREF="046932.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Need Exception that will stop ther reactor	within twistd</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Need%20Exception%20that%20will%20stop%20ther%20reactor%0A%09within%20twistd&In-Reply-To=%3C20061125053921.22613.1049902426.divmod.xquotient.356%40joule.divmod.com%3E"
       TITLE="[Twisted-Python] Need Exception that will stop ther reactor	within twistd">glyph at divmod.com
       </A><BR>
    <I>Fri Nov 24 22:39:21 MST 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="046909.html">[Twisted-Python] Need Exception that will stop ther reactor	within twistd
</A></li>
        <LI>Next message (by thread): <A HREF="046932.html">[Twisted-Python] Need Exception that will stop ther reactor	within twistd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46911">[ date ]</a>
              <a href="thread.html#46911">[ thread ]</a>
              <a href="subject.html#46911">[ subject ]</a>
              <a href="author.html#46911">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12:55 am, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">ncesar at lunix.com.ar</A> wrote:

&gt;&gt;<i> This is bad form, however.  Particular types of exception should not stop
</I>&gt;&gt;<i> the reactor.  Code that wants the reactor to stop, should call
</I>&gt;&gt;<i> reactor.stop.  Maybe you could make a method that both calls reactor.stop()
</I>&gt;&gt;<i> *and* raises an exception.
</I>&gt;<i>
</I>&gt;<i>This is the way i'm doing it right now, but i'm starting to detect new
</I>&gt;<i>exceptions raised within standard library (among others) code... and instead
</I>&gt;<i>of catching all posibilities I wanted the application to quit (with the
</I>&gt;<i>corresponding logging done).
</I>&gt;<i>
</I>&gt;<i>I was wondering if twistd/the application class could have a &quot;exit on
</I>&gt;<i>Exception&quot; for this type of operations.
</I>
In general this is a bad idea.  There are basically 3 kinds of code you can write with Twisted:

  1. Infrastructure code, which implements a protocol and provides APIs for parsing and dealing with events.  This kind of code should never contain a reactor.stop at all.
  2. Application code which exits in response to a particular user event.  This kind of code should contain exactly 1 call to reactor.stop, in the handler for the user event that is the explicit stop.
  3. Programs which do one operation, then stop themselves.  This kind of code should contain exactly 1 call to reactor.stop, in the final callback/errback of the Deferred representing the operation that it is run to perform.

It sounds like you are writing code of type 3.  I'm guessing you're writing a program which does one thing, then shuts itself down.  If that is the case, the &quot;program&quot; should be encapsulated by a Deferred, and there should be a final addBoth which waits for the program to finish when it exits.

If you *don't* structure your program this way, then you'll discover later that sometimes, you want to run your particular operation TWICE in the lifetime of the process instead of once, and you will have to deal with dozens of calls to reactor.stop littered around your application in lots of places.  Don't try to always stop the *process* when your program is complete: stop the *program* by keeping a Deferred around which represents its complete run.  That way the *driver* for the program is responsible for stopping it, and when you want to aggregate multiple runs of it, you can easily use a tool like DeferredList, or do something different in the callbacks at the end.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20061125/03300822/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="046909.html">[Twisted-Python] Need Exception that will stop ther reactor	within twistd
</A></li>
	<LI>Next message (by thread): <A HREF="046932.html">[Twisted-Python] Need Exception that will stop ther reactor	within twistd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46911">[ date ]</a>
              <a href="thread.html#46911">[ thread ]</a>
              <a href="subject.html#46911">[ subject ]</a>
              <a href="author.html#46911">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
