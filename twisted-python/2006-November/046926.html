<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Perspective Broker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Perspective%20Broker&In-Reply-To=%3Ccd8fa6f90611270337v78183db3kab4baa58eb079422%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="046924.html">
   <LINK REL="Next"  HREF="046944.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Perspective Broker</H1>
    <B>christian simms</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Perspective%20Broker&In-Reply-To=%3Ccd8fa6f90611270337v78183db3kab4baa58eb079422%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Perspective Broker">christian.simms at gmail.com
       </A><BR>
    <I>Mon Nov 27 04:37:13 MST 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="046924.html">[Twisted-Python] Perspective Broker
</A></li>
        <LI>Next message (by thread): <A HREF="046944.html">[Twisted-Python] Perspective Broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46926">[ date ]</a>
              <a href="thread.html#46926">[ thread ]</a>
              <a href="subject.html#46926">[ subject ]</a>
              <a href="author.html#46926">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/27/06, le dahut &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">le.dahut at laposte.net</A>&gt; wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> Using PB, I've setup a system where clients can control other clients in
</I>&gt;<i> this way :
</I>&gt;<i>
</I>&gt;<i> client1 executes &quot;remote_do_something&quot; on server1 with &quot;ip_client2&quot; as
</I>&gt;<i> argument.
</I>&gt;<i> Then server1 connects to client2 and executes &quot;remote_smthng&quot; on it.
</I>
I haven't used PB before, but I have used other protocols with
Deferreds.  Assuming your PB code is OK, you're only missing a couple
lines related to callbacks, which I'll insert below.

&gt;<i> code is like this :
</I>&gt;<i> - client1:
</I>&gt;<i> &quot;&quot;&quot;
</I>&gt;<i> factory = pb.PBClientFactory()
</I>&gt;<i> reactor.connectTCP(ip_server1, port, factory)
</I>&gt;<i> d = factory.getRootObject()
</I>&gt;<i> d.addCallback(lambda object: object.callRemote(&quot;do_something&quot;, ip_client2))
</I>&gt;<i> d.addCallback(client1_call_b)
</I>&gt;<i> d.addErrback(client1_err_b)
</I>
Please note that above, your client1_call_b function will be called
with its argument being the result of the remote method call
&quot;do_something&quot;.

&gt;<i> &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i> - server1:
</I>&gt;<i> &quot;&quot;&quot;
</I>&gt;<i> def remote_do_something(ip):
</I>&gt;<i>      factory = pb.PBClientFactory()
</I>&gt;<i>      reactor.connectTCP(ip_client2, port, factory)
</I>&gt;<i>      d = factory.getRootObject()
</I>&gt;<i>      d.addCallback(lambda object: object.callRemote(&quot;smthng&quot;))
</I>&gt;<i>      d.addCallback(server1_call_b)
</I>&gt;<i>      d.addErrback(server1_err_b)
</I>
Above, you need to add a &quot;return d&quot; statement at the very end of your
function &quot;remote_do_something&quot;, or else Twisted won't know that the
output of the function &quot;remote_do_something&quot; should be the end result
of your Deferred &quot;d&quot;.  Also, your function &quot;server1_call_b&quot; MUST
return its argument, or else the result will not get passed along.  It
could look something like this:

def server1_call_b(out):
    return out

The argument to server1_call_b is the result from the
&quot;object.callRemote('smthng')&quot; statement, and we are simply returning
it.  In fact, if that's all the function did, you should not even
define it (or use it in the callback chain) since it's not necessary.
But if you forgot the return statement then you would get Python's
default return value from a function, None, instead of the value.

&gt;<i>
</I>&gt;<i> &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i> - client2:
</I>&gt;<i> &quot;&quot;&quot;
</I>&gt;<i> def remote_smthng():
</I>&gt;<i>      &lt;code&gt;
</I>&gt;<i>      return &quot;Ok, everything's done&quot;
</I>&gt;<i> &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i> How can client1 get client2's answer ?
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>
Hopefully that does it.

Cheers,
Christian


&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="046924.html">[Twisted-Python] Perspective Broker
</A></li>
	<LI>Next message (by thread): <A HREF="046944.html">[Twisted-Python] Perspective Broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46926">[ date ]</a>
              <a href="thread.html#46926">[ thread ]</a>
              <a href="subject.html#46926">[ subject ]</a>
              <a href="author.html#46926">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
