<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] SMTP server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20SMTP%20server&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014322.html">
   <LINK REL="Next"  HREF="014324.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] SMTP server</H1>
    <B>Jan Bakuwel</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20SMTP%20server&In-Reply-To="
       TITLE="[Twisted-Python] SMTP server">jan.bakuwel at int.greenpeace.org
       </A><BR>
    <I>Thu Nov  9 07:44:55 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="014322.html">[Twisted-Python] Twisted article
</A></li>
        <LI>Next message: <A HREF="014324.html">[Twisted-Python] SMTP server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14321">[ date ]</a>
              <a href="thread.html#14321">[ thread ]</a>
              <a href="subject.html#14321">[ subject ]</a>
              <a href="author.html#14321">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hoi all,

This is my first message to the list so I think its appropriate to
express my appreciation for all the excellent work done by the people
who created &amp; contributed to the twisted libraries.

I have a small but interesting problem that I'd like to ask your advise
on, please see the description below. If you notice that I haven't
understood something properly, I hope you'll correct me :-)

I've implemented a SMTP server (I've called it &quot;xsmtp&quot;) using the
twisted &amp; python libraries. A MTA (Postfix) delivers email messages to
the xsmtp server: the MTA opens a single SMTP session to the xsmpt
server, then multiple &quot;RCPT TO&quot;s follow, one for each recipient.

As a result The &quot;validateFrom&quot; procedure is called by the twisted
library once, followed by multiple calls to the &quot;validateTo&quot; procedure.

This is creating a small problem for me. Since I must process the email
in the validateTo procedure, I will now receive multiple copies of the
same email (albeit for different recipients). One of the tasks of the
xsmtp server is to transmit these emails to another xsmtp server (SMTP
cannot be used due to the inherently high latency connection between the
two). Ideally I do not transfer the same email twice but would like to
leave the delivery to multiple recipients up to the MTA on the other
end. In a schema:

-&gt; MTA -&gt; xsmtp -- high latency link --&gt; xsmtp -&gt; MTA -&gt; local delivery

To implement smtp.IMessageDelivery I have to provide for the following
procedures:

validateFrom:    called once shortly after SMTP session is initiated
receivedHeader:  called multiple times for each recipient
validateTo:      called multiple tiems for each recipient

One could say that &quot;validateFrom&quot; is the start of the process (of
receiving an email) &quot;receivedHeader/validateTo&quot; is the core of the
process. What I am missing is something that indicates the end of the
process.


It would help me tremendously if smtp.IMessageDelivery would also
provide an abstract method that is called once the message delivery is
completed.

Any suggestions, thoughts are very welcome; perhaps this is already
possible with the twisted libraries in a different way as I'm suggesting
here?

best regards,
Jan

-- 

&quot;It is an illusion to think that we are free to apply our increasing
knowledge in any way we choose. In reality we are struggling to deal
with the consequences of it.&quot;                           -- John Gray

----

Electronic Technology Coordinator
Information/Communication/Technology
Greenpeace International
Ottho Heldringstraat 5
1066 AZ  AMSTERDAM
Netherlands (MET)

direct    +31 (0)20 7182084
fax       +31 (0)20 5148151
reception +31 (0)20 5148150
email     jan.bakuwel&amp;int.greenpeace.org
private   jan.bakuwel&amp;hccnet.nl
(replace &amp; by @ in the emailaddress)



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014322.html">[Twisted-Python] Twisted article
</A></li>
	<LI>Next message: <A HREF="014324.html">[Twisted-Python] SMTP server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14321">[ date ]</a>
              <a href="thread.html#14321">[ thread ]</a>
              <a href="subject.html#14321">[ subject ]</a>
              <a href="author.html#14321">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
