<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] RemoteReference decref
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20RemoteReference%20decref&In-Reply-To=%3C20080828125121.29191.814020133.divmod.quotient.18993%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="050795.html">
   <LINK REL="Next"  HREF="050820.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] RemoteReference decref</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20RemoteReference%20decref&In-Reply-To=%3C20080828125121.29191.814020133.divmod.quotient.18993%40ohm%3E"
       TITLE="[Twisted-Python] RemoteReference decref">exarkun at divmod.com
       </A><BR>
    <I>Thu Aug 28 06:51:21 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="050795.html">[Twisted-Python] RemoteReference decref
</A></li>
        <LI>Next message (by thread): <A HREF="050820.html">[Twisted-Python] RemoteReference decref
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50796">[ date ]</a>
              <a href="thread.html#50796">[ thread ]</a>
              <a href="subject.html#50796">[ subject ]</a>
              <a href="author.html#50796">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 28 Aug 2008 13:19:50 +0100, A &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">aldoogy at gmail.com</A>&gt; wrote:
&gt;<i>Hi,
</I>&gt;<i>I'm still working on an Actionscript pb client,
</I>&gt;<i>
</I>&gt;<i>and have run into a bit of a conundrum with RemoteReference which is using 
</I>&gt;<i>python's built-in __del__  to trigger a decref.
</I>&gt;<i>Actionscript doesn't have destructors so I will need to trigger the decref 
</I>&gt;<i>manually.
</I>&gt;<i>
</I>&gt;<i>based on my capture of a clent/server converation I am thinking that the 
</I>&gt;<i>client could do this in proto_answer
</I>
This doesn't sound like it makes sense.  You should only decref when the
object is no longer in use.  If you can't do it from a destructor, then
you have to require application code to do it.  The protocol implementation
can't know when the application has finished using the object.

&gt;<i>
</I>&gt;<i>s -:  ('version', 6)
</I>&gt;<i>r -:  ['version', 6]
</I>&gt;<i>r -:  ['message', 1, 'root', 'login', 1, ['tuple', 'alice'], ['dictionary']]
</I>&gt;<i>s -:  ('answer', 1, ['tuple', 
</I>&gt;<i>'x\x9b\x95\x1c\tJp\xe0\x96]\xf4\xdb\xeb\x13\t9', ('remote', 1)])
</I>&gt;<i>r -:  ['message', 2, 1, 'respond', 1, ['tuple', 
</I>&gt;<i>'\x06\x04\xf1vI\xfeP\xa0\xdfzl(\xd9\x7f!t', ['remote', 1]], ['dictionary']]
</I>&gt;<i>s -:  ('answer', 2, ('remote', 2))
</I>&gt;<i>r -:  ['decref', 1]
</I>&gt;<i>r -:  ['message', 3, 2, 'joinGroup', 1, ['tuple', '#lookingForFourth'], 
</I>&gt;<i>['dictionary']]
</I>&gt;<i>s -:  ('answer', 3, ('remote', 3))
</I>&gt;<i>r -:  ['decref', 2]
</I>&gt;<i>r -:  ['message', 4, 3, 'send', 1, ['tuple', 'You can call me Al.'], 
</I>&gt;<i>['dictionary']]
</I>&gt;<i>s -:  ('message', 1, 1, 'print', 1, ['tuple', '&lt;alice&gt; says: You can call me 
</I>&gt;<i>Al.'], ['dictionary'])
</I>&gt;<i>s -:  ('answer', 4, ['None'])
</I>&gt;<i>r -:  ['decref', 3]
</I>&gt;<i>
</I>
The protocol capture shows decrefs after answers purely by coincidence.  If
the application code being run to generate this kept references to the
objects longer, then you wouldn't see this pattern.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="050795.html">[Twisted-Python] RemoteReference decref
</A></li>
	<LI>Next message (by thread): <A HREF="050820.html">[Twisted-Python] RemoteReference decref
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50796">[ date ]</a>
              <a href="thread.html#50796">[ thread ]</a>
              <a href="subject.html#50796">[ subject ]</a>
              <a href="author.html#50796">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
