<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] What is the &quot;Twisted&quot; way to kill stuck child process
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20What%20is%20the%20%22Twisted%22%20way%20to%20kill%20stuck%20child%20process&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007049.html">
   <LINK REL="Next"  HREF="007051.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] What is the &quot;Twisted&quot; way to kill stuck child process</H1>
    <B>Schneider, Michael</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20What%20is%20the%20%22Twisted%22%20way%20to%20kill%20stuck%20child%20process&In-Reply-To="
       TITLE="[Twisted-Python] What is the &quot;Twisted&quot; way to kill stuck child process">michael.l.schneider at ugsplm.com
       </A><BR>
    <I>Thu Feb 12 11:03:52 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007049.html">[Twisted-Python] What is the &quot;Twisted&quot; way to kill stuck child process
</A></li>
        <LI>Next message: <A HREF="007051.html">[Twisted-Python] What is the &quot;Twisted&quot; way to kill stuck child process
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7050">[ date ]</a>
              <a href="thread.html#7050">[ thread ]</a>
              <a href="subject.html#7050">[ subject ]</a>
              <a href="author.html#7050">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Again, I could be taking the wrong approach:


Here is the scenerao:

1) Why the pooling
Each compute node can run 2 processes at the same time (big processes)
The compute node must accept more jobs then it can run, and hold the
waiting tasks in a queue.  (logically similar problem to database
connections, except, compute connections are used instead).

2) why not spawnProcess
The code said that spawnprocess is broken on windows. (I could be
looking
in the wrong place, twisted is a big codebase :-)

I fell back to using popen2 in a thead managed by the &quot;thread pool&quot;



I am always open to refactoring a design.  Windows is my prime platform,
but I also must support the UNIX platforms.

Hope this helps clairify what I am doing (not saying that I am taking
the correct approach with twisted, but I am trying and willing to change
to do it the twisted way :-)

Thank you very much,
Mike
 
----------------------------------------------------------------
Michael Schneider
Senior Software Engineering Consultant
UGS PLM Solutions - an EDS Company
 
&quot;The Greatest Performance Improvement Is the transitioning from a
non-working state to the working state&quot;


&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>
</I>&gt;<i> [mailto:<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>]On Behalf Of 
</I>&gt;<i> Jp Calderone
</I>&gt;<i> Sent: Thursday, February 12, 2004 10:27 AM
</I>&gt;<i> To: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>
</I>&gt;<i> Subject: Re: [Twisted-Python] What is the &quot;Twisted&quot; way to kill stuck
</I>&gt;<i> child process
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Thu, Feb 12, 2004 at 08:57:07AM -0500, Schneider, Michael wrote:
</I>&gt;<i> &gt; Hello All,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I am making real progress with twisted.  Thank you very much
</I>&gt;<i> &gt; for the great project.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I am creating a process launcher that runs on SGI, SUN, IBM AIX,
</I>&gt;<i> &gt; HPUX, and windows 2000 and XP.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I modified the adbapi.py file to pool jobs.  It works great.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Problem:
</I>&gt;<i> &gt; Sometimes the launched c program will hang. (standard exe file).
</I>&gt;<i> &gt; I want to launch a process with timeout value.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Ex.  I know that task X usually take 1200 seconds to run, but it
</I>&gt;<i> &gt; will sometimes hang.  If the exe has not finished running after
</I>&gt;<i> &gt; 1500 seconds, I want to kill the job and notify the caller that
</I>&gt;<i> &gt; their job timed out.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; What are some options for implementing this with twisted.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; NOTE: each process is launched in its own thread, so killing the
</I>&gt;<i> &gt; thread is an option is that is required.
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i>   I don't understand this.  Are you using 
</I>&gt;<i> reactor.spawnProcess() to start
</I>&gt;<i> these processes?  If not, you should be.  If so, it should be 
</I>&gt;<i> called from
</I>&gt;<i> the main thread, and the process can be killed with the usual means,
</I>&gt;<i> os.kill(pid).  The PID is available, though I forget exactly 
</I>&gt;<i> where, probably
</I>&gt;<i> as processProtocol.transport.pid.  You can use 
</I>&gt;<i> reactor.callLater to set up a
</I>&gt;<i> simple timeout so that processes are killed if they run for too long.
</I>&gt;<i> 
</I>&gt;<i>   Jp
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007049.html">[Twisted-Python] What is the &quot;Twisted&quot; way to kill stuck child process
</A></li>
	<LI>Next message: <A HREF="007051.html">[Twisted-Python] What is the &quot;Twisted&quot; way to kill stuck child process
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7050">[ date ]</a>
              <a href="thread.html#7050">[ thread ]</a>
              <a href="subject.html#7050">[ subject ]</a>
              <a href="author.html#7050">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
