<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Second try at reporting gtk reactor problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Second%20try%20at%20reporting%20gtk%20reactor%20problem&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007209.html">
   <LINK REL="Next"  HREF="007196.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Second try at reporting gtk reactor problem</H1>
    <B>David E. Konerding</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Second%20try%20at%20reporting%20gtk%20reactor%20problem&In-Reply-To="
       TITLE="[Twisted-Python] Second try at reporting gtk reactor problem">dekonerding at lbl.gov
       </A><BR>
    <I>Fri Feb 27 11:17:31 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007209.html">[Twisted-Python] PB over SSH
</A></li>
        <LI>Next message: <A HREF="007196.html">[Twisted-Python] Second try at reporting gtk reactor problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7193">[ date ]</a>
              <a href="thread.html#7193">[ thread ]</a>
              <a href="subject.html#7193">[ subject ]</a>
              <a href="author.html#7193">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, since nobody actually responding with a useful message regarding 
my report, I'm
reposting an extremely simple (1 page) example which exhibits the behavior.
My example creates a gtkreactor and runs it.  A small reporter class is 
run from a second thread.
Under the gtk reactor, the log messages from the second thread are not 
reported in a timely
fashion (only once per second or so).  From my understanding the 
messages should be printed more frequently (about once every 1/10th 
second).  This does work under the wx and plain reactors, so I suspect 
there is a defect in the gtk reactor.
I would simply like to get a confirmation that my example is a valid 
one, that the results I expect are valid, and that other
people can reproduce my experience.  If that is the case then I will 
submit a formal bug report.  All of this should be reproducible using 
Twisted 1.2.0.  Things get even weirder if you remove the logging 
support and replace it with all print statements.

import time, sys

from twisted.internet import gtk2reactor
gtk2reactor.install()
from twisted.python import threadable
threadable.init()
from twisted.internet import reactor
from twisted.python import log
log.startLogging(sys.stdout)

class TestThingy:
    def __init__(self):
        print &quot;TestThingy created&quot;

    def run(self):
        print &quot;TestThingy run&quot;
        for i in range(10):
            print &quot;TestThingy message&quot;
            time.sleep(0.1)
        print &quot;TestThingy done&quot;
       
class ThingyManager:
    def __init__(self):
        pass
       
    def submitThingy(self):
        log.err(&quot;ThingyManager submitting&quot;)
        f = TestThingy()
        log.err(&quot;ThingyManager created&quot;)
        reactor.callInThread(f.run)
        log.err(&quot;ThingyManager calledInThread&quot;)

def ticker(*args):
    log.err(&quot;ticker: %d&quot; % time.time())
    reactor.callLater(1, ticker)

t = ThingyManager()
reactor.callLater(0, ticker)
reactor.callLater(3, t.submitThingy)
reactor.run()
log.err(&quot;Reactor done&quot;)



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007209.html">[Twisted-Python] PB over SSH
</A></li>
	<LI>Next message: <A HREF="007196.html">[Twisted-Python] Second try at reporting gtk reactor problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7193">[ date ]</a>
              <a href="thread.html#7193">[ thread ]</a>
              <a href="subject.html#7193">[ subject ]</a>
              <a href="author.html#7193">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
