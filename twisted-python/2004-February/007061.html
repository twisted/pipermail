<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] pb server how to get client IP address
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20pb%20server%20how%20to%20get%20client%20IP%20address&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007060.html">
   <LINK REL="Next"  HREF="007067.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] pb server how to get client IP address</H1>
    <B>Brian Warner</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20pb%20server%20how%20to%20get%20client%20IP%20address&In-Reply-To="
       TITLE="[Twisted-Python] pb server how to get client IP address">warner at lothar.com
       </A><BR>
    <I>Fri Feb 13 19:36:28 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007060.html">[Twisted-Python] pb server how to get client IP address
</A></li>
        <LI>Next message: <A HREF="007067.html">[Twisted-Python] pb server how to get client IP address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7061">[ date ]</a>
              <a href="thread.html#7061">[ thread ]</a>
              <a href="subject.html#7061">[ subject ]</a>
              <a href="author.html#7061">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Martin Stenh&#229;rd &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">stenis at stenhard.net</A>&gt; writes:
&gt;<i>
</I>&gt;<i> Yes this works find in my server for my admin interface (simple telenet
</I>&gt;<i> bases) that use protocol.ServerFactory() and then use LineReceiver. 
</I>&gt;<i>
</I>&gt;<i> But how do I use getPeer() in a Perspective Broker server for example
</I>&gt;<i> <A HREF="http://www.twistedmatrix.com/documents/examples/pbbenchserver.py">http://www.twistedmatrix.com/documents/examples/pbbenchserver.py</A>
</I>
Ah, yes, that is trickier. You need to get access to the Broker object (which
is a Protocol subclass), and called methods are not generally given access to
that. The Perspective/ViewPoint -style stuff gives invoked methods access to
some initial Perspective object, but even that doesn't know who the Broker
is. The method which invokes your perspective_* method knows, but it isn't
telling.

I poked around a bit and haven't found any way to get at it. If the client
has given you access to one if its own objects (perhaps as the 'mind'
reference in the realm.requestAvatar() call), then you can use it to get the
Broker:

 mind.broker.transport.getPeer()

Other than that, I don't see how to do it. The details of the connection are
a little *too* abstracted out. Maybe someone else has an idea?

sorry,
 -Brian

PS: and no, inspect.stack()[1][0].f_locals['broker'] doesn't count..


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007060.html">[Twisted-Python] pb server how to get client IP address
</A></li>
	<LI>Next message: <A HREF="007067.html">[Twisted-Python] pb server how to get client IP address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7061">[ date ]</a>
              <a href="thread.html#7061">[ thread ]</a>
              <a href="subject.html#7061">[ subject ]</a>
              <a href="author.html#7061">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
