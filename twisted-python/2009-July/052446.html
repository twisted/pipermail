<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] imap and noop
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20imap%20and%20noop&In-Reply-To=%3C4A54BC15.8070502%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052445.html">
   <LINK REL="Next"  HREF="052447.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] imap and noop</H1>
    <B>Darren Syzling</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20imap%20and%20noop&In-Reply-To=%3C4A54BC15.8070502%40gmail.com%3E"
       TITLE="[Twisted-Python] imap and noop">dsyzling at gmail.com
       </A><BR>
    <I>Wed Jul  8 09:32:37 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052445.html">[Twisted-Python] imap and noop
</A></li>
        <LI>Next message (by thread): <A HREF="052447.html">[Twisted-Python] imap and noop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52446">[ date ]</a>
              <a href="thread.html#52446">[ thread ]</a>
              <a href="subject.html#52446">[ subject ]</a>
              <a href="author.html#52446">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jean-Paul Calderone wrote:
&gt;<i>
</I>&gt;<i> You may want to use the IMailboxListener implementation on IMAP4Server to
</I>&gt;<i> handle this case (IMAP4's complicated, I'm not sure this is the right
</I>&gt;<i> direction to pursue, but it's *a* direction :).
</I>&gt;<i>   
</I>I'm glad you said that I thought I was going mad, I'm mired in stateful 
conversations between client and server. This started out as a simple 
internal test tool. I spiked it and thought ok that's simple I can 
read/view messages, the code looked straight forward. Store some state 
for each mailbox pickle to a file for simplicity. But then I got deeper 
into the whole delete to trash (which is in fact copy) and that's when 
it all went horribly wrong. Thunderbird can start multiple sessions 
which creates multiple mailbox instances server side and that throws the 
whole state management issue up in the air. So I went stateless and 
re-read the pickle file on each mailbox entry point - ugly but it 
improved consistency and made the whole thing easier to reason.  But the 
noop has thrown me because this may expect me to respond to the 
individual session (mailbox instance) - something you're alluding to 
below about tracking the IMAP4Server protocol.
&gt;<i> The modeChanged, flagsChanged, and newMessages methods on IMAP4Server are
</I>&gt;<i> intended for use by your mailbox implementation.  In this case, it sounds
</I>&gt;<i> like you want to have your trash mailbox call newMessages when the messages
</I>&gt;<i> are copied into it.  This requires a bit of legwork on your part, keeping
</I>&gt;<i> track of the IMAP4Server protocol (or possibly more than one!) from the
</I>&gt;<i> mailbox code, but the result should be that when Thunderbird sends those
</I>&gt;<i> NOOPs, the server responds with one or both of EXISTS or RECENT (untagged).
</I>&gt;<i>   
</I>Thanks I'll have a poke around and see how this looks. I really ought to 
cap my time on this, it was only an internal test helper. I may end up 
telling my test users - 'ah yeah well, just close Thunderbird, restart 
and sign in and those messages will magically appear.' Although knowing 
me it will niggle at me until I've solved it.


Darren


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052445.html">[Twisted-Python] imap and noop
</A></li>
	<LI>Next message (by thread): <A HREF="052447.html">[Twisted-Python] imap and noop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52446">[ date ]</a>
              <a href="thread.html#52446">[ thread ]</a>
              <a href="subject.html#52446">[ subject ]</a>
              <a href="author.html#52446">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
