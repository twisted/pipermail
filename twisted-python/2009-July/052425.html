<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] untwisting twistd
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20untwisting%20twistd&In-Reply-To=%3C0C40B34038FD824FACDB387E7788728702D19693%40seaxch08.desktop.isilon.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052407.html">
   <LINK REL="Next"  HREF="052438.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] untwisting twistd</H1>
    <B>Jared Gisin</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20untwisting%20twistd&In-Reply-To=%3C0C40B34038FD824FACDB387E7788728702D19693%40seaxch08.desktop.isilon.com%3E"
       TITLE="[Twisted-Python] untwisting twistd">jared.gisin at isilon.com
       </A><BR>
    <I>Mon Jul  6 11:58:29 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052407.html">[Twisted-Python] untwisting twistd
</A></li>
        <LI>Next message (by thread): <A HREF="052438.html">[Twisted-Python] untwisting twistd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52425">[ date ]</a>
              <a href="thread.html#52425">[ thread ]</a>
              <a href="subject.html#52425">[ subject ]</a>
              <a href="author.html#52425">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mikhail is correct in what needs to be done here. Twistd should provide
helpers to writing an application without being the application. Not
every wants to make it look like they're using twisted, even if they
are. Having a twistd process appear in my process list is unacceptable,
and my applications takes a well know and singular config. Twistd should
be nothing more than a general helper.

 

Ultimately what Mikhail shows is very similar to what I have done by
import directly the ApplicationRunner I want to use (my app is also
Unix-only), and then subclassing ServerOptions. I also modified
createorGetApplication to return an application object instead  of
loading it from some damned .tac file that is passed in on the CLI,
which was exactly the thing that was trying to be avoided. My
application is defined already in code, so I should be able to create my
application object, and pass it right into a runner with proper
application options and have it fire up avoiding the generalities of
twistd that don't apply to me. Again, twistd is great at supporting one
use case. It needs to support others, and it needs to be refactored just
a bit more to do that. It wouldn't be as difficult to do this as you
probably imagine, and proper documentation on more ways it could be used
would save developers a ton of time. Now, if I only had the time to get
this done.... I'll see if I can refactor and provide some sample code to
at serves the use case we are discussing here. As I was told early on in
this inquiry, this problem isn't an uncommon complaint, so solving it
seems useful.

 

-Jared

 

From: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-bounces at twistedmatrix.com</A>
[mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-bounces at twistedmatrix.com</A>] On Behalf Of Paul
Thomas
Sent: Friday, July 03, 2009 2:31 AM
To: Twisted general discussion
Subject: Re: [Twisted-Python] untwisting twistd

 

 

On 2 Jul 2009, at 23:50, Mikhail wrote:






In my example I should have written 

   run(application)

instead of 

   run(...)

Then the difference would be more apparent. Namely, in my 'wrapper'
it is explicit what application will be run and where all the services
came from, your 'wrapper' is just a customized version of twistd and 
what will be run depends on the command line and what will be found 
in the file system. In some cases I'd like to _explicitly_ code into 
main script what functionality my application provides and I do not
want twistd search file system for plugins at all.

 

I'm not using plugins, but I had the same requirement as you to
explicitly create the app and then run it - because I need the freeze
scripts to make a single application.

 

My solution looked something like:

 

# myapp.py

 

from twisted.scripts._twistd_unix import UnixApplicationRunner

# Of course, that's just because the app is unix only

 

 

class MyRunner(UnixApplicationRunner):

            def createOrGetApplication(self):

                        # The stuff that's usually in a tac file

                        application = # ...

                        return application

 

def main():

            setup_logging()

            config = { # stuff pinched by dumping 'config' during a
twistd run

                        }

            # Also do the ServerOptions thing here if necessary

            MyRunner(config).run()

 

if __name__ == '__main__'

            main()

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20090706/8d5dfcd9/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052407.html">[Twisted-Python] untwisting twistd
</A></li>
	<LI>Next message (by thread): <A HREF="052438.html">[Twisted-Python] untwisting twistd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52425">[ date ]</a>
              <a href="thread.html#52425">[ thread ]</a>
              <a href="subject.html#52425">[ subject ]</a>
              <a href="author.html#52425">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
