<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Need working examples of imap4 client.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Need%20working%20examples%20of%20imap4%20client.&In-Reply-To=d272f0690906120140o22d3ada9r7dd22673214174c2%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019894.html">
   <LINK REL="Next"  HREF="019897.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Need working examples of imap4 client.</H1>
    <B>Pywinder Singh</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Need%20working%20examples%20of%20imap4%20client.&In-Reply-To=d272f0690906120140o22d3ada9r7dd22673214174c2%40mail.gmail.com"
       TITLE="[Twisted-Python] Need working examples of imap4 client.">pywinder at monkeydriveengine.com
       </A><BR>
    <I>Thu Jul  2 11:11:02 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019894.html">[Twisted-Python] problem on running apache2 + scgi
</A></li>
        <LI>Next message: <A HREF="019897.html">[Twisted-Python] Perspective broker remote calls to multiple	servers seem to run sequentially
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19895">[ date ]</a>
              <a href="thread.html#19895">[ thread ]</a>
              <a href="subject.html#19895">[ subject ]</a>
              <a href="author.html#19895">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>A very belated reply...

Thanks again for the code. From there, I was able to make a tool to clone
imap mailboxes from server to server. Right now, it's a beast held together
with rubber bands, and completely ignores use of a lot of other twisted
practices and conveniences (application, connection persistance, etc...).
At some point I'll clean it up and share, but in the mean time, if anybody
has any specific questions, let me know and I'll be happy to share what I
learned.



On Fri, Jun 12, 2009 at 4:40 AM, Alex Clemesha &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">clemesha at gmail.com</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I've wondered myself how to do this, so thanks Phil.
</I>&gt;<i>
</I>&gt;<i> I extended Phil's solution to work with Gmail, which boils
</I>&gt;<i> down to using SSL and setting the correct servername and port, see here:
</I>&gt;<i> <A HREF="http://gist.github.com/128521">http://gist.github.com/128521</A>
</I>&gt;<i>
</I>&gt;<i> Pywinder, you should be able to just change the username/password
</I>&gt;<i> and it will work for you (you might have to have the python ssl module
</I>&gt;<i> installed - post again if that is the case and it's not working for you)
</I>&gt;<i>
</I>&gt;<i> How to do useful stuff with the 'mailboxes' function in the script is
</I>&gt;<i> another question (which I dont know the answer to).  Maybe post
</I>&gt;<i> your usage if you have a chance.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Alex
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Jun 11, 2009 at 5:45 PM, Pywinder
</I>&gt;<i> Singh&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">pywinder at monkeydriveengine.com</A>&gt; wrote:
</I>&gt;<i> &gt; Phil,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Much obliged.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Was able to isolate and confirm that the real issue is that login is
</I>&gt;<i> hanging
</I>&gt;<i> &gt; for some reason, and causing the timeout message. I suspect SSL/TLS
</I>&gt;<i> issues,
</I>&gt;<i> &gt; which at least gives me a decided place to start investigating.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks again for the code, it was sanity inducing to say the least. ;)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Phil Mayers wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Pywinder Singh wrote:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Ideally, I'd love to see a snipped which is able to log into an imap
</I>&gt;<i> &gt;&gt; &gt; server and gets a list of mailboxes.  If the example on the site works
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Here you go:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; #!/usr/bin/python
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; from twisted.internet import reactor, protocol, defer
</I>&gt;<i> &gt;&gt; from twisted.mail import imap4
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; # change these...
</I>&gt;<i> &gt;&gt; username = '?'
</I>&gt;<i> &gt;&gt; password = '?'
</I>&gt;<i> &gt;&gt; servername = '?'
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; def mailboxes(list):
</I>&gt;<i> &gt;&gt;      for flags,sep,mbox in list:
</I>&gt;<i> &gt;&gt;          print mbox
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; def loggedin(res, proto):
</I>&gt;<i> &gt;&gt;      d = proto.list('','*')
</I>&gt;<i> &gt;&gt;      d.addCallback(mailboxes)
</I>&gt;<i> &gt;&gt;      return d
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; def connected(proto):
</I>&gt;<i> &gt;&gt;      print &quot;connected&quot;, proto
</I>&gt;<i> &gt;&gt;      d = proto.login(username, password)
</I>&gt;<i> &gt;&gt;      d.addCallback(loggedin, proto)
</I>&gt;<i> &gt;&gt;      return d
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; def failed(f):
</I>&gt;<i> &gt;&gt;      print &quot;failed&quot;, f
</I>&gt;<i> &gt;&gt;      return f
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; def done(_):
</I>&gt;<i> &gt;&gt;      reactor.callLater(0, reactor.stop)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; def main():
</I>&gt;<i> &gt;&gt;      c = protocol.ClientCreator(reactor, imap4.IMAP4Client)
</I>&gt;<i> &gt;&gt;      d = c.connectTCP(servername, 143)
</I>&gt;<i> &gt;&gt;      d.addCallbacks(connected, failed)
</I>&gt;<i> &gt;&gt;      d.addBoth(done)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; reactor.callLater(0, main)
</I>&gt;<i> &gt;&gt; reactor.run()
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; This example makes use of deferred chaining i.e. returning a deferred
</I>&gt;<i> &gt;&gt; from a callback handler, so you'll want to understand that.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Twisted-Python mailing list
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Alex Clemesha
</I>&gt;<i> clemesha.org
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20090702/54a4510b/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20090702/54a4510b/attachment.htm</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019894.html">[Twisted-Python] problem on running apache2 + scgi
</A></li>
	<LI>Next message: <A HREF="019897.html">[Twisted-Python] Perspective broker remote calls to multiple	servers seem to run sequentially
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19895">[ date ]</a>
              <a href="thread.html#19895">[ thread ]</a>
              <a href="subject.html#19895">[ subject ]</a>
              <a href="author.html#19895">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
