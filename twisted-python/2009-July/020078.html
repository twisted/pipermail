<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.positioning: status report and request	for comments/feedback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.positioning%3A%20status%20report%20and%20request%0A%09for%20comments/feedback&In-Reply-To=4A71C7E0.4070404%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020068.html">
   <LINK REL="Next"  HREF="020113.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.positioning: status report and request	for comments/feedback</H1>
    <B>Laurens Van Houtven</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.positioning%3A%20status%20report%20and%20request%0A%09for%20comments/feedback&In-Reply-To=4A71C7E0.4070404%40gmail.com"
       TITLE="[Twisted-Python] twisted.positioning: status report and request	for comments/feedback">lvh at laurensvh.be
       </A><BR>
    <I>Thu Jul 30 20:38:45 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020068.html">[Twisted-Python] twisted.positioning: status report and request for comments/feedback
</A></li>
        <LI>Next message: <A HREF="020113.html">[Twisted-Python] twisted.positioning: status report and request	for comments/feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20078">[ date ]</a>
              <a href="thread.html#20078">[ thread ]</a>
              <a href="subject.html#20078">[ subject ]</a>
              <a href="author.html#20078">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, and welcome to the discussion :-)

On Thu, Jul 30, 2009 at 6:18 PM, Santiago
Aguiar&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">santiago.aguiar at gmail.com</A>&gt; wrote:
&gt;<i> NMEAAdapter should delegate to a IPositionReceiver (which should be a
</I>&gt;<i> Receiver, right? It's called Provider, maybe I'm missing something?),
</I>
Yes, it's been called IPositioningReceiver and IPositioningProvider at
different point in the past, I'm not sure which name is better.

&gt;<i> and avoid having to make the receiver inherit from the NMEAAdapter
</I>&gt;<i> (which seems to be the case now, by looking at
</I>&gt;<i> NMEAAdapter._sentence_received getattr(self, callbackName)). There will
</I>&gt;<i> probably be tons of different GPS protocols (I sometimes work on
</I>&gt;<i> tracking systems, and truth is many trackers don't send NMEA data but a
</I>&gt;<i> proprietary protocol), and you don't want to have to subclass each to
</I>&gt;<i> handle data from multiple sources.
</I>
Yes, I've been working with a number of GPS protocols as well from a
different project, I'm just porting it to Twisted (and making it much
better). However, in most commercial applications the only dominant
(and by dominant I mean &quot;used by more than 1 manufacturer&quot;) protocol
seems to be SIRF. That's being implemented at some point in time too.

The suggested timeline right now is:

finalize NMEA implementation -&gt; review -&gt; work on GPSD (I've talked to
esr -- working on this sooner is mostly useless, the new gpsd protocol
is much preferred)

The downside of the new protocol in gpsd is that it introduces a new
dependency (gpsd). The upside is that it's json, so parsing it will be
easy, and we'll get something similar to NMEA, except immediately in a
good format.


&gt;<i> I also would refrain from using getattr tricks on the NMEA sentence
</I>&gt;<i> classes. For me, the first line of python doc (specially on twisted!) is
</I>&gt;<i> doing dir(obj) (and some IDEs/docgen tools actually do something like
</I>&gt;<i> this for completion). getattr tricks and similar constructions makes it
</I>&gt;<i> impossible to do this. It could be OK if you use getattr to handle an
</I>&gt;<i> unknown case (for example, if you want to delegate based on whether the
</I>&gt;<i> class has a method or not, even if in twisted interfaces world this
</I>&gt;<i> wouldn't be the way to do, it I think), but in this case you know
</I>&gt;<i> exactly what fields will the NMEA sentences have (and they won't change
</I>&gt;<i> much!), so you could code them, even if this require much more code.
</I>&gt;<i> It's the old motto of &quot;write once maintain always&quot; ;).
</I>
Yes, the point of dir working is a strong one -- I'm convinced that
this is a good idea too.

How about a bunch of properties, and have docstrings instead of @ivar
clauses in the class docstring? That way it'd be API compatible with
what I have now. It looks okay (from an API point). I'm more worried
about it being lots of duplicate and similar looking code. Well -- not
worried -- that's what put me off from doing it :-)

&gt;<i> You could also do other tricks, like update the class __dict__, so it
</I>&gt;<i> would show as a regular field when the object is created, or dinamically
</I>&gt;<i> create the class (like is done for TCPServer and friends, ugh), but
</I>&gt;<i> really, it could be better to just write it.
</I>
Yeah,  abusing __dict__ sounds like a cure worse than the disease.

&gt;<i> Thanks for the code!! :)
</I>
Thanks for your comments :-)

So anyway, short summary on what I'm still going to do:

   - change the fixer methods so they produce abstract objects instead
of just nicer representations of NMEA string values in primitives
(from &quot;1234.567&quot;, &quot;N&quot; -&gt; 12 + 34.567/60 is already being done -- now,
it will produce a Coordinate object, too)
   - document all of NMEA's silly sentences in the NMEASentence object
   - change the fixer method to not rely on NMEASentence's internal dictionary

It might be a good idea to do the mapping from &quot;good primitives&quot; data
(eg, a float in decimal degrees with meaningful sign for a latitude)
to the abstract objects (Coordinate objects for example) separately.
This would mean an extra pass, but perhaps code could be shared
between the nmea and gpsd implementations then :-)

Laurens

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020068.html">[Twisted-Python] twisted.positioning: status report and request for comments/feedback
</A></li>
	<LI>Next message: <A HREF="020113.html">[Twisted-Python] twisted.positioning: status report and request	for comments/feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20078">[ date ]</a>
              <a href="thread.html#20078">[ thread ]</a>
              <a href="subject.html#20078">[ subject ]</a>
              <a href="author.html#20078">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
