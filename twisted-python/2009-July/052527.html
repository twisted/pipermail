<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Incorrect &quot;Another twistd server is running...&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Incorrect%20%22Another%20twistd%20server%20is%20running...%22&In-Reply-To=%3Ch45fl0%24fdt%241%40ger.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052524.html">
   <LINK REL="Next"  HREF="052528.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Incorrect &quot;Another twistd server is running...&quot;</H1>
    <B>Simone Deponti</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Incorrect%20%22Another%20twistd%20server%20is%20running...%22&In-Reply-To=%3Ch45fl0%24fdt%241%40ger.gmane.org%3E"
       TITLE="[Twisted-Python] Incorrect &quot;Another twistd server is running...&quot;">shywolf9982 at gmail.com
       </A><BR>
    <I>Tue Jul 21 16:41:20 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052524.html">[Twisted-Python] Incorrect &quot;Another twistd server is running...&quot;
</A></li>
        <LI>Next message (by thread): <A HREF="052528.html">[Twisted-Python] Incorrect &quot;Another twistd server is running...&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52527">[ date ]</a>
              <a href="thread.html#52527">[ thread ]</a>
              <a href="subject.html#52527">[ subject ]</a>
              <a href="author.html#52527">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/21/2009 07:10 PM, Christopher Armstrong wrote:
&gt;<i> It's not necessarily a twistd process. It could be any process with
</I>&gt;<i> the same pid. checkPID only checks to see if the pid exists, not that
</I>&gt;<i> it's the PID of a twistd process.
</I>
Disclaimer is, I might be extremely naive here. I have to admit I wasn't 
able to figure out when checkPID is called (before or after a possible 
daemonization? Since with how you have to write daemons in UNIX, doing a 
os.getpid() _before_ daemonizing is not going to work the way I intend 
it to).

Anyway, what is currently done is: os.kill is invoked with signal 0, if 
we get no OSError then sys.exit is invoked.

What I propose is if no OSError is raised, we first check that 
os.getpid() is different from the pid we read from the file, and if they 
are equal we remove the stale file.

Patch against r27172 attached.

Don't shout at me if I haven't got it (it honestly seems way too easy: 
there must be the trick ;))
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: twisted_samepid_r27172.patch
URL: &lt;/pipermail/twisted-python/attachments/20090722/afb33559/attachment.ksh&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052524.html">[Twisted-Python] Incorrect &quot;Another twistd server is running...&quot;
</A></li>
	<LI>Next message (by thread): <A HREF="052528.html">[Twisted-Python] Incorrect &quot;Another twistd server is running...&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52527">[ date ]</a>
              <a href="thread.html#52527">[ thread ]</a>
              <a href="subject.html#52527">[ subject ]</a>
              <a href="author.html#52527">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
