<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Error &quot;reactor already installed&quot; - exact	module import order?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Error%20%22reactor%20already%20installed%22%20-%20exact%0A%09module%20import%20order%3F&In-Reply-To=4543F7C2.6060403%40mail11.ml1.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014268.html">
   <LINK REL="Next"  HREF="014271.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Error &quot;reactor already installed&quot; - exact	module import order?</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Error%20%22reactor%20already%20installed%22%20-%20exact%0A%09module%20import%20order%3F&In-Reply-To=4543F7C2.6060403%40mail11.ml1.net"
       TITLE="[Twisted-Python] Error &quot;reactor already installed&quot; - exact	module import order?">exarkun at divmod.com
       </A><BR>
    <I>Sat Oct 28 21:40:00 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="014268.html">[Twisted-Python] Error &quot;reactor already installed&quot; - exact module	import order?
</A></li>
        <LI>Next message: <A HREF="014271.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14269">[ date ]</a>
              <a href="thread.html#14269">[ thread ]</a>
              <a href="subject.html#14269">[ subject ]</a>
              <a href="author.html#14269">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 29 Oct 2006 02:37:22 +0200, &quot;Zoltan \(Twisted Python Mailing List\)&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-matrix at mail11.ml1.net</A>&gt; wrote:
&gt;<i>Hi everyone,
</I>&gt;<i>
</I>
Hello.

&gt;<i>
</I>&gt;<i>I would be grateful if someone could help me with the error &quot;reactor already 
</I>&gt;<i>installed&quot;. I have seen this issue has been discussed previously, but I am 
</I>&gt;<i>not sure how to fix appropriate file so that error does not occur anymore.
</I>
This happens when an attempt is made to install more than one reactor in a
single process.  Twisted supports only a single reactor.

When twisted.internet.reactor is imported for the very first time, if no
other reactor has been installed, the default reactor is installed.  If
any other reactor has been installed, that reactor is given back as the
result of the import.

&gt;<i>
</I>&gt;<i>I am using Twisted Python 2.4.0, as it is packaged by Mandriva.
</I>&gt;<i>
</I>&gt;<i>Here is the Python stack trace:
</I>&gt;<i>----------------- cut 8&lt; -------------------
</I>&gt;<i>Traceback (most recent call last):
</I>&gt;<i>   File &quot;/usr/bin/pyscrabble.py&quot;, line 4, in ?
</I>&gt;<i>     gtk2reactor.install()
</I>&gt;<i>   File &quot;/usr/lib/python2.4/site-packages/twisted/internet/gtk2reactor.py&quot;, 
</I>&gt;<i>line 270, in install
</I>&gt;<i>     installReactor(reactor)
</I>&gt;<i>   File &quot;/usr/lib/python2.4/site-packages/twisted/internet/main.py&quot;, line 23, 
</I>&gt;<i>in installReactor
</I>&gt;<i>     assert not sys.modules.has_key('twisted.internet.reactor'), \
</I>&gt;<i>AssertionError: reactor already installed
</I>&gt;<i>----------------- cut 8&lt; -------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Here is the piece of code that causes error:
</I>&gt;<i>
</I>&gt;<i>----------------- /usr/bin/pyscrabble.py -------------------
</I>&gt;<i>#!/usr/bin/env python
</I>&gt;<i>
</I>&gt;<i>from twisted.internet import gtk2reactor
</I>&gt;<i>gtk2reactor.install()
</I>&gt;<i>...
</I>&gt;<i>----------------- /usr/bin/pyscrabble.py -------------------
</I>
This seems strange.  Since only one reactor is being installed here, the
traceback above should not be happening.  I cannot replicate this failure;
when I try the above script, it works as expected (producing no output).

Do you have something in your environment which might be causing some other
reactor to be installed, or for twisted.internet.reactor to be imported,
causing the default reactor to be installed?  For example, do you have a
sitecustomize.py which is doing something with Twisted?


&gt;<i>
</I>&gt;<i>As for the &quot;pyscrabble.py&quot; causing, I'll contact its author, but is it 
</I>&gt;<i>possible to change &quot;.../twisted/internet/main.py&quot; so that it does not throw 
</I>&gt;<i>assertion error on already installed reactor?
</I>&gt;<i>
</I>
It's possible to make that change (by editing the source of Twisted), but
it seems unlikely that just suppressing the exception will solve the problem.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014268.html">[Twisted-Python] Error &quot;reactor already installed&quot; - exact module	import order?
</A></li>
	<LI>Next message: <A HREF="014271.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14269">[ date ]</a>
              <a href="thread.html#14269">[ thread ]</a>
              <a href="subject.html#14269">[ subject ]</a>
              <a href="author.html#14269">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
