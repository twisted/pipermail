<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Problem with runInteraction and passing a dict	variable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Problem%20with%20runInteraction%20and%20passing%20a%20dict%0A%09variable&In-Reply-To=454507A1.2060401%40netland.nl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014272.html">
   <LINK REL="Next"  HREF="014274.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Problem with runInteraction and passing a dict	variable</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Problem%20with%20runInteraction%20and%20passing%20a%20dict%0A%09variable&In-Reply-To=454507A1.2060401%40netland.nl"
       TITLE="[Twisted-Python] Problem with runInteraction and passing a dict	variable">exarkun at divmod.com
       </A><BR>
    <I>Sun Oct 29 16:48:31 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="014272.html">[Twisted-Python] Problem with runInteraction and passing a dict	variable
</A></li>
        <LI>Next message: <A HREF="014274.html">[Twisted-Python] Problem with runInteraction and passing a dict	variable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14273">[ date ]</a>
              <a href="thread.html#14273">[ thread ]</a>
              <a href="subject.html#14273">[ subject ]</a>
              <a href="author.html#14273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 29 Oct 2006 20:57:21 +0100, Ron Arts &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">ron.arts at netland.nl</A>&gt; wrote:
&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>I am both a python and twisted beginner, but I think I have found
</I>&gt;<i>a problem in twisted. See the code below.
</I>&gt;<i>The handle_PeerStatus function receives a dict wich contains
</I>&gt;<i>some info. Then it calls runInteraction with that variable.
</I>&gt;<i>When the UpdatePeerStatus function is run, block is empty.
</I>&gt;<i>
</I>&gt;<i>I did some investigating, it seems that UpdatePeerStatus is
</I>&gt;<i>run using a workerthread which takes it values from a Queue.
</I>&gt;<i>
</I>&gt;<i>When the dict is pushed onto the Queue, it is valid, when
</I>&gt;<i>when it is popped by the worker thread, the var is empty.
</I>&gt;<i>
</I>&gt;<i>Can anybody give me tips to solve this? Am I absolutely
</I>&gt;<i>missing something and on the wring track or should I enter a bug?
</I>
Simply going through the queue won't mutate the dictionary.  Are
you certain no other part of your code is manipulating it?  One
way you could check this is by passing a _copy_ of block to
runInteraction so that modifications to the original won't affect
it.  If this results in things working as you expect, then you've
found the problem.

In general, you should _not_ be touching the same objects from more
than one thread.  Passing an object to another thread is fine, but
when you do so, you give up all rights to further inspect or modify
that object, until such time as the other thread chooses to give it
back to you (whereafter it should likewise give up those privileges).

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014272.html">[Twisted-Python] Problem with runInteraction and passing a dict	variable
</A></li>
	<LI>Next message: <A HREF="014274.html">[Twisted-Python] Problem with runInteraction and passing a dict	variable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14273">[ date ]</a>
              <a href="thread.html#14273">[ thread ]</a>
              <a href="subject.html#14273">[ subject ]</a>
              <a href="author.html#14273">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
