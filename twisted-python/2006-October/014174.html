<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Trial __del__ behavior change - intentional?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Trial%20__del__%20behavior%20change%20-%20intentional%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014173.html">
   <LINK REL="Next"  HREF="014175.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Trial __del__ behavior change - intentional?</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Trial%20__del__%20behavior%20change%20-%20intentional%3F&In-Reply-To="
       TITLE="[Twisted-Python] Trial __del__ behavior change - intentional?">glyph at divmod.com
       </A><BR>
    <I>Tue Oct 10 01:11:43 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="014173.html">[Twisted-Python] Twisted &amp; Qt
</A></li>
        <LI>Next message: <A HREF="014175.html">[Twisted-Python] Trial __del__ behavior change - intentional?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14174">[ date ]</a>
              <a href="thread.html#14174">[ thread ]</a>
              <a href="subject.html#14174">[ subject ]</a>
              <a href="author.html#14174">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12:58 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">slamb at slamb.org</A> wrote:
&gt;<i>It appears I can't use reference handling to  clean up 
</I>&gt;<i>resources within a trial - the output code apparently keeps  a reference to 
</I>&gt;<i>the stack trace or something until after it's done.  That's too late for me 
</I>&gt;<i>- this resource is essentially a mutex, so if  I have more than one TestCase 
</I>&gt;<i>in a single trial run, my tests don't  work.
</I>
I can't speak to the intentionality of that particular change, but there are many cases where code (not necessarily trial) will do something like this temporarily.  You should always treat __del__ as slightly non-deterministic unless you have a very tightly controlled test _specifically_ for your __del__ and it includes a gc.collect().

Do startup / cleanup with the 'setUp' and 'tearDown' TestCase methods.  Don't depend on garbage collection: this goes for both your application and your test code.  Implicitly depending on the garbage collector's behavior will very likely make your program break under the debugger, but not under normal operation (or vice versa).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20061010/79028333/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20061010/79028333/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014173.html">[Twisted-Python] Twisted &amp; Qt
</A></li>
	<LI>Next message: <A HREF="014175.html">[Twisted-Python] Trial __del__ behavior change - intentional?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14174">[ date ]</a>
              <a href="thread.html#14174">[ thread ]</a>
              <a href="subject.html#14174">[ subject ]</a>
              <a href="author.html#14174">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
