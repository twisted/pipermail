<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] finger tutorial: server slow to shutdown
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20finger%20tutorial%3A%20server%20slow%20to%20shutdown&In-Reply-To=%3C2cc028020610190132u56af92b7uc6a8cbff3e30a9b5%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="046727.html">
   <LINK REL="Next"  HREF="046719.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] finger tutorial: server slow to shutdown</H1>
    <B>Brian King</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20finger%20tutorial%3A%20server%20slow%20to%20shutdown&In-Reply-To=%3C2cc028020610190132u56af92b7uc6a8cbff3e30a9b5%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] finger tutorial: server slow to shutdown">free.as.in.speech at gmail.com
       </A><BR>
    <I>Thu Oct 19 02:32:37 MDT 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="046727.html">[Twisted-Python] Unreliable UDP
</A></li>
        <LI>Next message (by thread): <A HREF="046719.html">[Twisted-Python] Chesspark - A twisted based online chess community.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46717">[ date ]</a>
              <a href="thread.html#46717">[ thread ]</a>
              <a href="subject.html#46717">[ subject ]</a>
              <a href="author.html#46717">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I was working my way through the tutorial, running each version of the
server and testing it out with &quot;telnet localhost 1079&quot;.  When I got to
this ( <A HREF="http://twistedmatrix.com/projects/core/documentation/howto/tutorial/intro.html#auto11">http://twistedmatrix.com/projects/core/documentation/howto/tutorial/intro.html#auto11</A>)
version of the server, I noticed that the server was not shutting down
immediately when I pressed ctrl-c.  The script I'm running is a
verbatim copy of the tutorial code.

I see the following behavior:
1. If immediately after receiving a response from a &quot;finger&quot; query I
press ctrl-c to stop the server, the server shuts down:
    a) after about 20 seconds, if there is no activity on port 1079, or
    b) as soon as a connection is attempted on port 1079 (e.g. &quot;telnet
localhost 1079&quot;).
2.  If after having waited some time (e.g. 30 seconds) after the last
query I press ctrl-c to stop the server, it shuts down only after the
next connection attempt on port 1079.
3.  If no connections have been made to the server, ctrl-c shuts it
down immediately.

For the case 1) above:
Running &quot;netstat -tn&quot; after having pressed ctrl-c and before the
server shuts down gives the following output:
Active Internet connections
Proto Recv-Q Send-Q  Local Address          Foreign Address        (state)
tcp4       0      0  127.0.0.1.1079         127.0.0.1.57791        TIME_WAIT
...
(nothing indicating an open connection to the queried web server)

For the case 2) above, there is no mention of port 1079 in the output
from &quot;netstat -tn&quot;.

I've spent some time trying to understand why it doesn't shut down
immediately in cases 1 and 2, but haven't figured it out.  Can anybody
shed some light on what is going on?  What would I have to do to get
it to shutdown quickly?

Environment info:
freebsd 6.1 release
python 2.4.3
twisted 2.4.0

Thanks,
Brian


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="046727.html">[Twisted-Python] Unreliable UDP
</A></li>
	<LI>Next message (by thread): <A HREF="046719.html">[Twisted-Python] Chesspark - A twisted based online chess community.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46717">[ date ]</a>
              <a href="thread.html#46717">[ thread ]</a>
              <a href="subject.html#46717">[ subject ]</a>
              <a href="author.html#46717">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
