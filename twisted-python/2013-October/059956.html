<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] AMP Argument.toBox's proto argument is a locator, not the proto?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20AMP%20Argument.toBox%27s%20proto%20argument%20is%20a%0A%20locator%2C%20not%20the%20proto%3F&In-Reply-To=%3CCAE_Hg6bsf8%3D2ZAg8As%3DJu_Mf5hLXVPCqb%2BksDRnq3pHTjnpAxg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] AMP Argument.toBox's proto argument is a locator, not the proto?</H1>
    <B>Laurens Van Houtven</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20AMP%20Argument.toBox%27s%20proto%20argument%20is%20a%0A%20locator%2C%20not%20the%20proto%3F&In-Reply-To=%3CCAE_Hg6bsf8%3D2ZAg8As%3DJu_Mf5hLXVPCqb%2BksDRnq3pHTjnpAxg%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] AMP Argument.toBox's proto argument is a locator, not the proto?">_ at lvh.io
       </A><BR>
    <I>Tue Oct  1 02:13:28 MDT 2013</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59956">[ date ]</a>
              <a href="thread.html#59956">[ thread ]</a>
              <a href="subject.html#59956">[ subject ]</a>
              <a href="author.html#59956">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Oct 1, 2013 at 12:59 AM, Glyph &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:


&gt;<i> Most of the code I can think of that wants to use that really wants the *
</I>&gt;<i> transport* rather than the &quot;protocol&quot;,
</I>&gt;<i>
</I>
Yes, but having the protocol would also immediately give you access to the
transport, and, from what I understand in most cases of AMP, also
everything else :)


&gt;<i> but nothing within AMP itself actually uses those arguments; in fact,
</I>&gt;<i> searching the usual suspects (epsilon, vertex) I can't even find any
</I>&gt;<i> Arguments that use the 'proto' argument for anything useful.
</I>&gt;<i>
</I>
I suppose it's too late to get &quot;proto&quot; to actually mean &quot;proto&quot; and not
&quot;boxSender&quot;? It would definitely be a backwards-incompatible change, and I
do actually have some code that somehow relied on it being the boxSender
(actually, I think I saved that code in txampext, mostly, except I renamed
that thing &quot;proto&quot;).


&gt;<i> If I recall, I believe the idea behind it was to allow an AMP responder
</I>&gt;<i> within Vertex to return the peer's IP address back to the peer, from within
</I>&gt;<i> an authenticated AMP route that (because it was a route) wasn't necessarily
</I>&gt;<i> connected directly to the transport (and therefore couldn't just do
</I>&gt;<i> self.transport.getPeer()).  Ironically I don't think it'll actually work
</I>&gt;<i> for that now :-).
</I>&gt;<i>
</I>&gt;<i> When we pull the authentication logic in from &lt;
</I>&gt;<i> <A HREF="http://bazaar.launchpad.net/~divmod-dev/divmod.org/trunk/view/head:/Epsilon/epsilon/ampauth.py">http://bazaar.launchpad.net/~divmod-dev/divmod.org/trunk/view/head:/Epsilon/epsilon/ampauth.py</A>&gt;,
</I>&gt;<i> you might write a responder that's interested in authentication information
</I>&gt;<i> that lives in some other relation to the protocol.
</I>&gt;<i>
</I>
I wrote very similar deep-in-AMP auth logic once, and did look at that code
(but ended up not using it because I use TLS, so I don't need hand-rolled
challenge response or OTP systems).

When you say &quot;other relation to the protocol&quot;, does that mean &quot;it can be
the protocol because the protocol will have some kind of reference to it&quot;?


&gt;<i> So in order to fix fromBox/toBox, we need to do a fix that firms up that
</I>&gt;<i> contract and perhaps exposes more than a Protocol object.  The
</I>&gt;<i> *recommended* API should be more or less like what ExposingArgument is
</I>&gt;<i> doing - specify an Argument that asks for a particular attribute of the
</I>&gt;<i> transport or the protocol or the authentication context or whatever, the
</I>&gt;<i> implementation details may involve other lower-level public APIs.
</I>&gt;<i>
</I>
That still sounds like it can be done by making &quot;proto&quot; actually the proto
;-) So, basically, the question is if &quot;proto&quot; being the locator is a bug
that I can fix, or an interface that I can't.


&gt;<i> My contributions to AMP have been more of the defect-findy kind, but I
</I>&gt;<i> could certainly turn them more into the code-contributy kind. I imagine I'm
</I>&gt;<i> not the first person to want tests for command classes (
</I>&gt;<i> <A HREF="https://github.com/lvh/txampext/blob/master/txampext/commandtests.py">https://github.com/lvh/txampext/blob/master/txampext/commandtests.py</A>) or
</I>&gt;<i> a nested AMP box (
</I>&gt;<i> <A HREF="https://github.com/lvh/txampext/blob/master/txampext/nested.py">https://github.com/lvh/txampext/blob/master/txampext/nested.py</A>).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That would be cool.  And, you know, that auth thing I said :-).
</I>&gt;<i>
</I>
If I can change &quot;proto&quot; to mean &quot;actually the protocol not something else&quot;
then that seems plenty easy to add, and it would definitely be cool if
people don't have to mess with this nonsense themselves for something as
ostensibly simple as having access to the protocol :-)

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20131001/f1ae8a62/attachment-0002.html&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59956">[ date ]</a>
              <a href="thread.html#59956">[ thread ]</a>
              <a href="subject.html#59956">[ subject ]</a>
              <a href="author.html#59956">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
