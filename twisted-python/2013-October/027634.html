<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] epoll keep sharing state between process even	after fork.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20epoll%20keep%20sharing%20state%20between%20process%20even%0A%09after%20fork.&In-Reply-To=%3CCALpq1paRNatz0gstQLf4w4hkZgoXp1xtrSr7EdpCX0_5tKNcew%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027616.html">
   <LINK REL="Next"  HREF="027636.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] epoll keep sharing state between process even	after fork.</H1>
    <B>Flint</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20epoll%20keep%20sharing%20state%20between%20process%20even%0A%09after%20fork.&In-Reply-To=%3CCALpq1paRNatz0gstQLf4w4hkZgoXp1xtrSr7EdpCX0_5tKNcew%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] epoll keep sharing state between process even	after fork.">grindizer at gmail.com
       </A><BR>
    <I>Thu Oct 24 03:13:36 MDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027616.html">[Twisted-Python] epoll keep sharing state between process even after fork.
</A></li>
        <LI>Next message: <A HREF="027636.html">[Twisted-Python] epoll keep sharing state between process even	after fork.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27634">[ date ]</a>
              <a href="thread.html#27634">[ thread ]</a>
              <a href="subject.html#27634">[ subject ]</a>
              <a href="author.html#27634">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i> On 03:46 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">grindizer at gmail.com</A> wrote:
</I>&gt;<i> &gt;Hi everybody
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;I a came across a surprising problem when using the epoll based
</I>&gt;<i> &gt;reactor.
</I>&gt;<i> &gt;(ticket here <A HREF="https://twistedmatrix.com/trac/ticket/6796">https://twistedmatrix.com/trac/ticket/6796</A>)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;As you can see on the ticket, the epoll object seems to share some
</I>&gt;<i> &gt;state
</I>&gt;<i> &gt;even after fork.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;[snip]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;- Using spawnProcess as mentioned in the ticket comment, is not an
</I>&gt;<i> &gt;option
</I>&gt;<i> &gt;too, in my case, I need to share some state between the main process
</I>&gt;<i> &gt;and
</I>&gt;<i> &gt;subprocess. (I have on object in main process space that I want to
</I>&gt;<i> &gt;inherit
</I>&gt;<i> &gt;in all subprocess)
</I>&gt;<i>
</I>&gt;<i> This doesn't really explain why you can't use `spawnProcess`.  There are
</I>&gt;<i> other ways to share state between processes.  Perhaps if you describe
</I>&gt;<i> the object you have someone can suggest a way to share it that will
</I>&gt;<i> still satisfy your requirements without requiring that you use the
</I>&gt;<i> `multiprocessing` module.
</I>&gt;<i>
</I>&gt;<i> Jean-Paul
</I>&gt;<i>
</I>
Hi.

For the moment I share a factory object, but it's the underlying &quot;protocol
class&quot; that is really needed.
The code takes a factory object, and then launch a set of worker/process.
when a connection is made on the parent process, the socket handler will be
sent to one of the process (using sendmsg), the process will then run
reactor.adoptStreamConnection and this is when we need the protocol class.
There is an example of what I would like to achieve here
<A HREF="https://github.com/Grindizer/scaletix">https://github.com/Grindizer/scaletix</A> the example works with select or poll
reactor.

with spawnProcess I guess the child process will need to somehow import the
factory class and should be given the way to instanciate it ? isn't it ? I
don't know other way to do it actually ?

thankx again.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20131024/c81ae05f/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20131024/c81ae05f/attachment.html</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027616.html">[Twisted-Python] epoll keep sharing state between process even after fork.
</A></li>
	<LI>Next message: <A HREF="027636.html">[Twisted-Python] epoll keep sharing state between process even	after fork.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27634">[ date ]</a>
              <a href="thread.html#27634">[ thread ]</a>
              <a href="subject.html#27634">[ subject ]</a>
              <a href="author.html#27634">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
