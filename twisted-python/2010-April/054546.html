<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Utilizing Twisted for transport w/ SUDS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Utilizing%20Twisted%20for%20transport%20w/%20SUDS&In-Reply-To=%3Cq2r4e0e47491004191626p18bc0b4bmc539fb0e90917279%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="054538.html">
   <LINK REL="Next"  HREF="054547.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Utilizing Twisted for transport w/ SUDS</H1>
    <B>jathan.</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Utilizing%20Twisted%20for%20transport%20w/%20SUDS&In-Reply-To=%3Cq2r4e0e47491004191626p18bc0b4bmc539fb0e90917279%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Utilizing Twisted for transport w/ SUDS">jathan at gmail.com
       </A><BR>
    <I>Mon Apr 19 17:26:56 MDT 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="054538.html">[Twisted-Python] gtk2reactor: scheduling work in the immediate future without throttling gtk
</A></li>
        <LI>Next message (by thread): <A HREF="054547.html">[Twisted-Python] Utilizing Twisted for transport w/ SUDS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54546">[ date ]</a>
              <a href="thread.html#54546">[ thread ]</a>
              <a href="subject.html#54546">[ subject ]</a>
              <a href="author.html#54546">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello-

I have a project that is based on Twisted used to
communicate with network devices and I am adding support for a new
vendor (Citrix NetScaler) whose API is SOAP.  Unfortunately the
support for SOAP in Twisted still relies on SOAPpy, which is badly out
of date. In fact as of this email (I just checked), twisted.web.soap
itself hasn't even been updated in 21 months!

I would like to ask if anyone has any experience they would be willing
to share with utilizing Twisted's superb asynchronous transport
functionality with SUDS.  It seems like plugging in a custom Twisted
transport would be a natural fit in SUDS' Client.options.transport, I'm just
having
a hard time wrapping my head around it.

I did come up with a way to call the SOAP method with SUDS
asynchronously by utilizing twisted.internet.threads.deferToThread(),
but this feels like a hack to me.

Here is an example of what I've done, just to give you an idea:

   # netscaler is a module I wrote using suds to interface with NetScaler
SOAP
   # Source: <A HREF="http://bitbucket.org/jathanism/netscaler-api/src">http://bitbucket.org/jathanism/netscaler-api/src</A>
   import netscaler
   import os, sys
   from twisted.internet import reactor, defer, threads

   # netscaler.API is the class that sets up the suds.client.Client object
   host = 'netscaler.local'
   username = password = 'nsroot'
   wsdl_url = '<A HREF="file://">file://</A>' + os.path.join(os.getcwd(), 'NSUserAdmin.wsdl')
   api = netscaler.API(host, username=username, password=password,
wsdl_url=wsdl_url)

   results = []
   errors = []

   def handleResult(result):
       print '\tgot result: %s' % (result,)
       results.append(result)

   def handleError(err):
       sys.stderr.write('\tgot failure: %s' % (err,))
       errors.append(err)

   # this converts the api.login() call to a Twisted thread.
   # api.login() is equivalent to:
   # api.service.login(username=self.username, password=self.password)
   deferred = threads.deferToThread(api.login)
   deferred.addCallbacks(handleResult, handleError)

   reactor.run()

This works as expected and defers return of the api.login() call until
it is complete, instead of blocking.  But as I said, it doesn't feel
right.

Thanks in advance for any help, guidance, feedback, criticism,
insults, or total solutions.

jathan.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20100419/81ce6ffd/attachment-0001.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="054538.html">[Twisted-Python] gtk2reactor: scheduling work in the immediate future without throttling gtk
</A></li>
	<LI>Next message (by thread): <A HREF="054547.html">[Twisted-Python] Utilizing Twisted for transport w/ SUDS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54546">[ date ]</a>
              <a href="thread.html#54546">[ thread ]</a>
              <a href="subject.html#54546">[ subject ]</a>
              <a href="author.html#54546">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
