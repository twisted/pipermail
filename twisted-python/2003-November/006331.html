<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] pb help needed.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20pb%20help%20needed.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006336.html">
   <LINK REL="Next"  HREF="006332.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] pb help needed.</H1>
    <B>Syver Enstad</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20pb%20help%20needed.&In-Reply-To="
       TITLE="[Twisted-Python] pb help needed.">syver at inout.no
       </A><BR>
    <I>Fri Nov  7 07:30:26 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006336.html">[Twisted-Python] sessions example
</A></li>
        <LI>Next message: <A HREF="006332.html">[Twisted-Python] pb help needed.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6331">[ date ]</a>
              <a href="thread.html#6331">[ thread ]</a>
              <a href="subject.html#6331">[ subject ]</a>
              <a href="author.html#6331">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a bug in my woven application which manifests itself as
win32select failing after doing many http requests. The error is the
constant WSAENOBUFS and I it seems pretty likely that this is caused
by some socket related resource leaking for each request I make. This
hypothesis is further supported by observing that a host of
pb.ClientFactory instances are stopped when shutting down the
application after it crashes. This seems strange to me as I am
thorough in shutting down the connector after every request is
finished.

Turning to that trusty friend printf style debugging, shows that the
PBClientFactory is stopped correctly when performing requests to pages
that use the referenceable and wait for it's deferred's to
complete. There are two cases when it doesn't stop. 

The first is when I press reload quickly a number of times. Then I
just see start messages because my request finish method is not called
(it is a callback to the deferred returned by request.notifyFinish()).

The second case is when I call disconnect on the connector before it's
deferred has been realised. I see in the log the following pattern:
Starting pb.PBClientFactory, disconnect and then the attached event,
stopping factory is not called at all. After stepping I see that
disconnect doesn't do anything when it is called before the connection
has been realized.

So I have a bug, and it's in my code. My question is how does one
manage pb resources correctly and easily (I don't worry about
performance just yet) when each user needs to have it's own
connection?









</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006336.html">[Twisted-Python] sessions example
</A></li>
	<LI>Next message: <A HREF="006332.html">[Twisted-Python] pb help needed.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6331">[ date ]</a>
              <a href="thread.html#6331">[ thread ]</a>
              <a href="subject.html#6331">[ subject ]</a>
              <a href="author.html#6331">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
