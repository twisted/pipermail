<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Woven View factories: defered rendering?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Woven%20View%20factories%3A%20defered%20rendering%3F&In-Reply-To=%3C44F1BA9E-1B71-11D8-8EF4-000A95864FC4%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="039019.html">
   <LINK REL="Next"  HREF="039026.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Woven View factories: defered rendering?</H1>
    <B>Donovan Preston</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Woven%20View%20factories%3A%20defered%20rendering%3F&In-Reply-To=%3C44F1BA9E-1B71-11D8-8EF4-000A95864FC4%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Woven View factories: defered rendering?">dp at twistedmatrix.com
       </A><BR>
    <I>Thu Nov 20 08:50:30 MST 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="039019.html">[Twisted-Python] Woven View factories: defered rendering?
</A></li>
        <LI>Next message (by thread): <A HREF="039026.html">[Twisted-Python] Woven View factories: defered rendering?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39021">[ date ]</a>
              <a href="thread.html#39021">[ thread ]</a>
              <a href="subject.html#39021">[ subject ]</a>
              <a href="author.html#39021">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Nov 19, 2003, at 10:20 PM, Michal Pasternak wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I have a webpage, that is rendered via twisted.web.woven.page.Page 
</I>&gt;<i> class.
</I>&gt;<i>
</I>&gt;<i> In one of it's wvfactory_ methods, I need to send an e-mail. I would 
</I>&gt;<i> also
</I>&gt;<i> like to check if sending of the e-mail was successful (eg. mailserver 
</I>&gt;<i> is
</I>&gt;<i> up, running, and reachable via network).
</I>&gt;<i>
</I>&gt;<i> I thought about something like this:
</I>
&lt;snip&gt;

Woven has some, ahem, object identity issues. It really, really wants 
you to return an actual View instance from a wvfactory_. However, it 
does support deferreds being returned from the Widget.generate method. 
A deferred callback should mutate the incoming template node in place 
in order to cause some changes to the final page:

class MyDeferredWidget(widgets.Widget):
	def generate(self, request, node):
		theDeferred = doSomeAction()
		def theCallback(result):
			node.appendChild(
				request.d.createTextNode(&quot;the result was: %s&quot; % result)
			)
		theDeferred.addCallback(theCallback)
		return theDeferred


class MyPage(page.Page):
	template = &quot;&quot;&quot;&lt;html&gt;&lt;span view=&quot;theDeferredThing&quot; /&gt;&lt;/html&gt;&quot;&quot;&quot;

	def wvfactory_theDeferredThing(self, request, node, model):
		return MyDeferredWidget(model)


This is completely untested, but it gives you an idea of what to do. 
One of the main reasons for embarking upon nevow was that I knew a lot 
more about Deferreds than when I wrote woven, and woven's architecture 
made it very difficult to support deferreds properly. In nevow, the 
code might look like:


class MyPage(renderer.Renderer):
	def render_doSomeAction(self, context, data):
		return doSomeAction().addCallback(
			lambda result: &quot;The result was: %s&quot; % result)

	document = html[
	span[
		render_doSomeAction
	]
]

The point is nevow was designed from the beginning to handle Deferreds 
more gracefully than woven was. Also, because the paradigm in nevow 
sticks far better to &quot;the return value of a callable replaces whatever 
came in&quot; than woven ended up doing, it's impossible to get into funny 
identity situations where you're mutating an object but you don't see 
the result of it in the final page, because you were mutating a copy 
and it was the wrong object.

dp



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="039019.html">[Twisted-Python] Woven View factories: defered rendering?
</A></li>
	<LI>Next message (by thread): <A HREF="039026.html">[Twisted-Python] Woven View factories: defered rendering?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39021">[ date ]</a>
              <a href="thread.html#39021">[ thread ]</a>
              <a href="subject.html#39021">[ subject ]</a>
              <a href="author.html#39021">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
