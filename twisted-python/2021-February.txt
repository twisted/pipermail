From adi at roiban.ro  Mon Feb  1 12:26:10 2021
From: adi at roiban.ro (Adi Roiban)
Date: Mon, 1 Feb 2021 19:26:10 +0000
Subject: [Twisted-Python] Upcoming Twisted Release
In-Reply-To: <CAG=rPVd_J0OK2e0H3VP_hRvqEDOXzfYW+9ne42ekNavExLCxhg@mail.gmail.com>
References: <CAFycZ9dQ04S6O1w4VhAv2z4=YX6VVT-Z5DEHNq6XzQ9nagKpMg@mail.gmail.com>
 <CAG=rPVfHNdcnFwuVN9zD6-oTizTQ2t8h3n++UoftnoQA+Ag_Hw@mail.gmail.com>
 <CAFycZ9cCn6+GJhbom5EwrYc-uizBpAkSFcQ6yidRL7vrn5tipQ@mail.gmail.com>
 <CAG=rPVc23Pyy9JOyRXjN9csJS8jDsZh59Ven0kc0LDWxPvz38g@mail.gmail.com>
 <099D757E-591B-49F0-BF85-92467667FB77@twistedmatrix.com>
 <9C0B8503-AA21-46BC-AB73-7625050BBC8C@twistedmatrix.com>
 <CAG=rPVd_J0OK2e0H3VP_hRvqEDOXzfYW+9ne42ekNavExLCxhg@mail.gmail.com>
Message-ID: <CAFycZ9e4_VCxcTx8_Fnj09F8GDpdDZ+Q2NK2=1+5P8Aa247=eQ@mail.gmail.com>

Hi,

So, speaking for myself here and not representing the Twisted community or
anyone else.

I think that the consensus inside the Twisted contributors is that we
should have a new  release ASAP.

The current release is blocked by the following issues:

* A release blocker bug - https://twistedmatrix.com/trac/ticket/10069
* A release process protocol / procedure / communication

-------

For the blocker bug, there were 2 PR there were closed

* https://github.com/twisted/twisted/pull/1499
* https://github.com/twisted/twisted/pull/1501

There is one PR still in work https://github.com/twisted/twisted/pull/1502

We can wait one more week to see if this issue can be fixed and unblock the
release in this way.

Otherwise, we can revert the change that introduced the regression and have
the release unblocked.

Note that reverting a merge that introduced a regression as soon as the
regression is detected, is the current best practice.
The revert was not done as there was hope that this can be fixed.

With the release unblock Craig or I or someone else can create the release
branch and push the release candidate to PYPI.

-------

For the release procedure / communication

The release documentation and the process to publish the wheels to PyPI was
updated with the goal of making it easier for the current release
to happen.
You just create a tag and you have the documentation and PyPI wheels
already published.

You can still manually create the wheels and publish them with twine

If anyone thinks that the current changes that were made for automatic Docs
(narrative and API) and wheel publishing are a regression,
they can be reverted at any time, and we can merge them after the release.

The ad-hoc / informal Twisted dev communication happens over IRC Freenode
#twisted-dev

It would be nice if we can have all active developers there for quick
feedback and brainstorming.

------------

Have I forgotten anything?

I hope that in 2 weeks we can have a release candidate and by the end of
February a final release.

Cheers


On Sat, 16 Jan 2021 at 02:56, Craig Rodrigues <rodrigc at crodrigues.org>
wrote:

>
>
> On Fri, Jan 15, 2021 at 10:42 AM Glyph <glyph at twistedmatrix.com> wrote:
>
>>
>>
>>
>> Following up on this, since we are now officially past the "beginning" of
>> January: Craig, is a release imminent or can someone else pick up some
>> tasks yet?
>>
>>
> I'm close to getting this done, and want to complete this.
>
> --
> Craig
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


-- 
Adi Roiban
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210201/ca421352/attachment.htm>

From glyph at twistedmatrix.com  Mon Feb  1 13:59:47 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 1 Feb 2021 12:59:47 -0800
Subject: [Twisted-Python] resolving release management conflict
Message-ID: <4F912819-96EB-431F-8BA1-3DD7AF55F1A9@twistedmatrix.com>

Hello Twisted community!

Recently we've had some emotional language around the release process.  On https://github.com/twisted/twisted/pull/1464 <https://github.com/twisted/twisted/pull/1464>, Craig said several times that he found Adi's work and process changes "very aggressive".  Obviously, to have suggested this, Craig would have found some things Adi said to be emotionally loaded as well.

I think we need to resolve this conflict in order to move forward productively and avoid wasting more volunteer energy on negative feelings.  In order to do that, I think we need to centralize the discussion here.

At this point I think we need to all begin with a presumption of good faith.  Adi, Thomas Grainger, Tom Most, Maarten, Povilas and Craig are all trying to address big problems in Twisted.  Nobody's trying to be aggressive, even if it's coming across that way.

(Personally, I should acknowledge that I don't see Adi's actions as aggressive, but I think we have to address Craig's perception that they are.  Part of the presumption of good faith is presuming that everyone has valid reasons for their reactions.)

Here's the status as I understand it:

Adi, Thomas, and Maarten are trying to address release automation issues to make future releases go faster.  They've merged several changes, including https://github.com/twisted/twisted/pull/1464 <https://github.com/twisted/twisted/pull/1464>, to that end.
Craig is trying to get out a release according to the current process, which means addressing https://twistedmatrix.com/trac/ticket/10069 <https://twistedmatrix.com/trac/ticket/10069> as it is a release blocker.  He has a fix for this, but that fix is blocked.

While we've been waiting on #2, the changes in #1 proceed apace.  Craig's also noted several times that I've given permission for him to do the release and so he feels that breaking things mid-way is reneging on a promise from the project.

I believe the proximate cause of the conflict here is that we're dealing with this regression incorrectly.  When a regression is introduced, there's a process for dealing with it, originally documented here: https://twistedmatrix.com/trac/wiki/ReviewProcess#Revertingachange <https://twistedmatrix.com/trac/wiki/ReviewProcess#Revertingachange>. [1]  The principle we need to outline clearly is this: if we have a regression, the change that introduced it should be reverted as soon as possible.  If we can't revert it directly because of changes to trunk in the meanwhile that introduce conflicts, ideally the change that we would make would be the closest possible thing to reverting it, even if that reintroduces a known bug that we have to reopen.

In the case where a lot of work has happened in the interim, and it's less work to just "fix forward" on top of trunk, it's fine to do a small fix as an end run around this process.  The goal of this process is to minimize the work required to restore trunk to a releasable state.

Right now we have three competing fixes which have all been flagged as incorrect in various ways:

from Tom: https://github.com/twisted/twisted/pull/1499 <https://github.com/twisted/twisted/pull/1499>
Craig rejected this one by saying it will break "certain versions" of Python, but I don't understand why it was closed rather than reviewed / reassigned as normal.  (Or for that matter which versions are the problems, or how it breaks them.)
from Adi: https://github.com/twisted/twisted/pull/1501 <https://github.com/twisted/twisted/pull/1501>
Craig rejected this one by saying "please stop working on this" but it also doesn't have any technical reason that this solution is incorrect.
from Craig: https://github.com/twisted/twisted/pull/1502 <https://github.com/twisted/twisted/pull/1502>
This was originally given a passing review by Povilas from the Buildbot project, but twm added an additional blocking review shortly thereafter explaining that it introduced an additional regression.  It seems as though this one is now actively being worked on?

Craig: you closed two of these issues on the basis that you were "already working on a fix", but that's not a valid reason to close a PR.  Or, for that matter, to give it a failing review.  In the future, please comment on PRs that you don't want merged by pointing out their technical insufficiency, so that we can take the opportunity to learn for the benefit of future maintenance.  In this case, the underlying issue is clearly quite nuanced and requires expertise that touches platform differences in Python's core APIs, so having multiple people working on different fixes is totally fine; this effort is not wasted if everybody learns a little bit about the code in question, and it's definitely not wasted if we have to synthesize our approaches in the end anyway because they address different cases.

If you are pressed for time and don't have the ability to enumerate a large number of subtle problems, it's fine to post a changes-required review saying something high-level, such as "this does not address a number of issues that I've taken into account in my fix in #NNNN; please see the code on that PR for more detail, I can answer specific questions later".

All of these fixes have each been outstanding for weeks, which strongly suggests that this is way too hard to fix forward and we should have stopped trying a while ago.  We should fall back to the previous one if in any way possible, then reintroduce the changes which caused it.  If we're really just about to land 1502, then feel free to complete the work there, but in the future we should regard this kind of delay in reverting as a process failure.

If there are too many conflicts to address in a revert, and reverting means we need to revert 3 or 4 tickets which have built on top of that work, then let's just do that and get those re-merged later as well.  It's unfortunate to ship without features but it's better than multi-month release hold-ups.

(Note: a straight revert doesn't require a full code review.  If you can revert a merge and CI is happy with it, feel free to get an administrator to smash the red button to merge immediately.)

I think a secondary problem is that we have not traditionally been very clear about the role of "release manager".  My intent for the role was originally that it last 1-2 weeks at most, and the responsibility is supposed to begin just a bit before the first prerelease is uploaded, and end when the final release is completed and the release announcement is written.

Given that it's the release manager's responsibility to ensure no regressions are present in the release, this can come along with a little bit of soft power where we should all promptly honor the current RM's request to revert things or to prioritize review of fixes for release blockers which might not be straightforward code regressions and therefore can't be fixed by a revert (for example, 3rd party services like readthedocs or github actions breaking our integrations or CI due to no change of our own).  However the RM has no special authority to circumvent processes, land code, prevent or code from landing, and should ideally never be making changes to the process in-line with the manual process of making the release.

The release manager really isn't supposed to do a bunch of development on trunk.  This has been confounded in the past by the fact that in the past Amber has been both a prolific contributor and the release manager, often at the same time; and, as a way to make the manual process easier, she often would do a bunch of automation work right before a relase.  But the role, inasmuch as it exists, ought to be about executing whatever manual steps remain after we've automated as much as we can.  Similarly, Amber's faithful execution of this role for years was a great benefit to everyone working on the project, but it also obscured that the RM is supposed to be a hat that one person wears for one to two weeks.  My personal feeling (it certainly would overstate this to call it a "process") is that if someone takes on the release manager role and can't get a prerelease out within a week, then they should step down and we should have a bigger community discussion about why we're stuck. 

My follow-up questions are:

Can we revert the change that introduced 10069 so that we can follow the process to re-introduce it after a release has been made, and have the conversation about which PR to accept and why post-release?
Do we need to revert the release process changes from https://github.com/twisted/twisted/pull/1464 <https://github.com/twisted/twisted/pull/1464> for this release?  If so, what is the specific technical need this addresses?
Is there some problem with the release process changes that ought to make this revert more permanent? They look really good to me, but I don't want to discount that possibility either.  A reviewer can always request that code be pulled back out of trunk if there's a problem that was not forseen during the review process?

-g

[1]: I'm not sure if this has been propagated forward to our newer process docs in git; it would be good to delete most of this doc and replace it with a bunch of links so we don't have duplicate and outdated docs.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210201/06a7e396/attachment-0001.htm>

From rodrigc at crodrigues.org  Tue Feb  2 09:34:55 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Tue, 2 Feb 2021 08:34:55 -0800
Subject: [Twisted-Python] Upcoming Twisted Release
In-Reply-To: <CAFycZ9e4_VCxcTx8_Fnj09F8GDpdDZ+Q2NK2=1+5P8Aa247=eQ@mail.gmail.com>
References: <CAFycZ9dQ04S6O1w4VhAv2z4=YX6VVT-Z5DEHNq6XzQ9nagKpMg@mail.gmail.com>
 <CAG=rPVfHNdcnFwuVN9zD6-oTizTQ2t8h3n++UoftnoQA+Ag_Hw@mail.gmail.com>
 <CAFycZ9cCn6+GJhbom5EwrYc-uizBpAkSFcQ6yidRL7vrn5tipQ@mail.gmail.com>
 <CAG=rPVc23Pyy9JOyRXjN9csJS8jDsZh59Ven0kc0LDWxPvz38g@mail.gmail.com>
 <099D757E-591B-49F0-BF85-92467667FB77@twistedmatrix.com>
 <9C0B8503-AA21-46BC-AB73-7625050BBC8C@twistedmatrix.com>
 <CAG=rPVd_J0OK2e0H3VP_hRvqEDOXzfYW+9ne42ekNavExLCxhg@mail.gmail.com>
 <CAFycZ9e4_VCxcTx8_Fnj09F8GDpdDZ+Q2NK2=1+5P8Aa247=eQ@mail.gmail.com>
Message-ID: <CAG=rPVcGyqmoz6Pd3y0vr+RKX1YDB+pZ4pVA4u+tVs0h7tdcFg@mail.gmail.com>

On Mon, Feb 1, 2021 at 11:27 AM Adi Roiban <adi at roiban.ro> wrote:

> Hi,
>
> So, speaking for myself here and not representing the Twisted community or
> anyone else.
>


Thanks for making this clear that you are speaking for yourself and no one
else.


> * A release blocker bug - https://twistedmatrix.com/trac/ticket/10069
>
>

For this particular bug, I have been working on getting feedback from Tom
Most,
under https://github.com/twisted/twisted/pull/1502 and am working on a fix
to incorporate his feedback.
This some central code is in base.py, and I am proceeding cautiously to
make sure that I fully understand Tom's
concern  and am working on a  fix.

I apologize if I have not been working fast enough on this release to your
satisfaction.

I will attempt to communicate better on this list my progress.

I didn't want to bring this up on the mailing list.
I will take your behavior as enthusiasm for the project, but despite the
e-mail that Glyph sent,
I still find your behavior very aggressive (and unappreciated).  In your
e-mail you are
throwing out timelines, which may be "friendly suggestions" on your part,
but can come across as deadlines/ultimatums.

For now, I am focusing on the final issue, and will proceed with the
release as best as I am able,
and communicate to the Twisted community my progress.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210202/1e61dc26/attachment.htm>

From rodrigc at crodrigues.org  Wed Feb  3 05:32:53 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Wed, 3 Feb 2021 04:32:53 -0800
Subject: [Twisted-Python] resolving release management conflict
In-Reply-To: <4F912819-96EB-431F-8BA1-3DD7AF55F1A9@twistedmatrix.com>
References: <4F912819-96EB-431F-8BA1-3DD7AF55F1A9@twistedmatrix.com>
Message-ID: <CAG=rPVcyL8OEvtKJybrgn9zvZAEuj5S9mrCgUPrcFRs4Cf-zCg@mail.gmail.com>

On Mon, Feb 1, 2021 at 1:00 PM Glyph <glyph at twistedmatrix.com> wrote:

>
> I believe the proximate cause of the conflict here is that we're dealing
> with this regression incorrectly.  When a regression is introduced, there's
> a process for dealing with it, originally documented here:
> https://twistedmatrix.com/trac/wiki/ReviewProcess#Revertingachange. [1]
>  The principle we need to outline clearly is this: if we have a regression,
> the change that introduced it should be reverted as soon as possible.  If
> we *can't* revert it directly because of changes to trunk in the
> meanwhile that introduce conflicts, ideally the change that we would make
> would be the closest possible thing to reverting it, even if that
> reintroduces a known bug that we have to reopen.
>
> In the case where a lot of work has happened in the interim, and it's *less
> work* to just "fix forward" on top of trunk, it's fine to do a small fix
> as an end run around this process.  The goal of this process is to minimize
> the work required to restore trunk to a releasable state.
>
> Right now we have three competing fixes which have all been flagged as
> incorrect in various ways:
>
>
>    - from Tom: https://github.com/twisted/twisted/pull/1499
>       - Craig rejected this one by saying it will break "certain
>       versions" of Python, but I don't understand why it was closed rather than
>       reviewed / reassigned as normal.  (Or for that matter which versions are
>       the problems, or how it breaks them.)
>
>
Yes, that is correct.  Over the summer, while investigating failures on
Azure CI caused by to non-ASCII characters in
a submitter's GitHub user ID.  I spent a lot of time testing in a Windows
environment on Python 3.5, 3.6, 3.7, and 3.8.
I found that there were subtle differences in the default encoding on the
console between each Python version,
and that affected the logic in _checkProcessArgs().
The fix that I did over the summer addressed the problems and fixed all the
CI issues.

There were two corner cases that were uncovered.  One by me, and one by Tom
Most.

CORNER CASE 1:    In Buildbot, they patch sys.stdout with io.StringIO in
their tests which affects their tests which call the Twisted Reactor.
                                   io.StringIO is not a 100% proper
replacement for sys.stdout which is of type _io.TextIOWrapper on Python 3+.
                                   However, Buildbot's tests have been
around for a long time, so I decided

CORNER CASE 2:    In a Windows GUI Application, sys.stdout is None.  So you
cannot get the encoding from sys.stdout.encoding


In https://github.com/twisted/twisted/pull/1502, I have a very small patch
which addresses those two corner cases.
I need to write a good test for it, but I think it is good enough to go
into the release.

Post-release:
(1) I would like to drop Python 3.5
(2)  Look at removing the _checkProcessArgs() function.  The complexity of
bytes/unicode logic in there was more useful
       in the Python 2 days when dealing with the differences between how
Python on Windows handled args/env vs.
       how Python on POSIX handled args/env.  I think this function can
completely go in a Python 3.6+ world, and will greatly simplify the code.
       However, this needs to be carefully tested and reviewed.



>
>    - from Adi: https://github.com/twisted/twisted/pull/1501
>       - Craig rejected this one by saying "please stop working on this"
>       but it also doesn't have any technical reason that this solution is
>       incorrect.
>
> Yes, that is correct.  Sorry if that was an aggressive action on my part,
but I did a fix for this, as described above.






>
>    - from Craig: https://github.com/twisted/twisted/pull/1502
>       - This was originally given a passing review by Povilas from the
>       Buildbot project, but twm added an additional blocking review shortly
>       thereafter explaining that it introduced an additional regression.  It
>       seems as though this one is now actively being worked on?
>
>
> Craig: you closed two of these issues on the basis that you were "already
> working on a fix", but that's not a valid reason to *close* a PR.  Or,
> for that matter, to give it a failing review.  In the future, please
> comment on PRs that you don't want merged by pointing out their technical
> insufficiency, so that we can take the opportunity to learn for the benefit
> of future maintenance.  In this case, the underlying issue is clearly quite
> nuanced and requires expertise that touches platform differences in
> Python's core APIs, so having multiple people working on different fixes is
> totally fine; this effort is not wasted if everybody learns a little bit
> about the code in question, and it's *definitely* not wasted if we have
> to synthesize our approaches in the end anyway because they address
> different cases.
>

OK, thanks for the feedback, and sorry for any process violations or hurt
feelings from my actions.



>
> All of these fixes have each been outstanding for weeks, which strongly
> suggests that this is *way* too hard to fix forward and we should have
> stopped trying a while ago.  We should fall back to the previous one if in
> *any* way possible, then reintroduce the changes which caused it.  If
> we're really just about to land 1502, then feel free to complete the work
> there, but in the future we should regard this kind of delay in reverting
> as a process failure.
>

No, the fixes have been outstanding for weeks mainly due to the fact
that certain personal circumstances came up in my life, such that I had to
refocus my time away from Twisted for a few months,
compared to the time I had over the summer of 2020.  I now have more time,
and am committed to getting this release out.



>
> If there are too many conflicts to address in a revert, and reverting
> means we need to revert 3 or 4 tickets which have built on top of that
> work, then let's just do that and get those re-merged later as well.  It's
> unfortunate to ship without features but it's better than multi-month
> release hold-ups.
>
> (Note: a straight revert doesn't require a full code review.  If you can
> revert a merge and CI is happy with it, feel free to get an administrator
> to smash the red button to merge immediately.)
>
>
>    1. Can we revert the change that introduced 10069 so that we can
>    follow the process to re-introduce it after a release has been made, and
>    have the conversation about which PR to accept and why post-release?
>
>
I would rather not do this.  I would rather proceed with
https://github.com/twisted/twisted/pull/1502 , which is minimal,
and addresses the corner cases.

Going through the whole revert, resubmit, retest is going to add more delay
to the release.



>
>    1. Do we need to revert the release process changes from
>    https://github.com/twisted/twisted/pull/1464 for this release?  If so,
>    what is the specific technical need this addresses?
>
>
I do not agree with the changes in PR 1464.  I think a better solution
would have been to have a separate release.yml workflow,
which could be triggered.  By clicking the "Create a New Release" link on
GitHub.
I had a working prototype here: https://github.com/twisted/twisted/pull/1423
, and I successfully pushed some releases to
https://test.pypi.org

However, even though I disagree with the approach in PR 1464, since
multiple people have decided that this is what they want,
I'll just go with this.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210203/5d8890f1/attachment.htm>

From rodrigc at crodrigues.org  Wed Feb  3 05:51:08 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Wed, 3 Feb 2021 04:51:08 -0800
Subject: [Twisted-Python] Developer docs should be updated on wiki when
 steps changed in code?
Message-ID: <CAG=rPVdperfmna51N7_bdtPOtKdKRrZyu3crDFCpCoUrkgSimg@mail.gmail.com>

In this PR: https://github.com/twisted/twisted/pull/1461
some changes were made to the Twisted development process
for running the various linters before committing code.

I noticed that the changes in PR 1461 were not reflected
in docs on the wiki, specifically here:
https://twistedmatrix.com/trac/wiki/TwistedDevelopment

which mentions tox environments that have been deleted in PR 1461.

I noticed this, when I recently tried to work on a branch from recent trunk,
and when I tried to run some of the commands on that wiki page
they didn't work, because they were deleted.

In this post-review comment:
https://github.com/twisted/twisted/pull/1461#issuecomment-753695414

I asked Thomas if he could modify the wiki to reflect the changes he made
in trunk,
but this hasn't been done yet.

My impression in the comments in PR 1461 is that Thomas and Adi want
to move all this documentation into the source tree, and delete the stuff
on the wiki?

Is this the long term plan?

Until this is fully completed, what is the correct thing to do when there
is a mismatch between
docs on the wiki, and docs in the tree?

I still refer to a lot of docs on the wiki, especially for process related
things,
so I think it would be nice if the wiki docs were kept up to date, until
the day that
they are fully deleted.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210203/b2704e38/attachment.htm>

From glyph at twistedmatrix.com  Wed Feb  3 11:08:44 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 3 Feb 2021 10:08:44 -0800
Subject: [Twisted-Python] Developer docs should be updated on wiki when
 steps changed in code?
In-Reply-To: <CAG=rPVdperfmna51N7_bdtPOtKdKRrZyu3crDFCpCoUrkgSimg@mail.gmail.com>
References: <CAG=rPVdperfmna51N7_bdtPOtKdKRrZyu3crDFCpCoUrkgSimg@mail.gmail.com>
Message-ID: <782E2EA5-E44D-4AC7-ADE5-794C3D9AD9D9@twistedmatrix.com>



> On Feb 3, 2021, at 4:51 AM, Craig Rodrigues <rodrigc at crodrigues.org> wrote:
> 
> In this PR: https://github.com/twisted/twisted/pull/1461 <https://github.com/twisted/twisted/pull/1461>
> some changes were made to the Twisted development process
> for running the various linters before committing code.
> 
> I noticed that the changes in PR 1461 were not reflected
> in docs on the wiki, specifically here: https://twistedmatrix.com/trac/wiki/TwistedDevelopment <https://twistedmatrix.com/trac/wiki/TwistedDevelopment>
> 
> which mentions tox environments that have been deleted in PR 1461.
> 
> I noticed this, when I recently tried to work on a branch from recent trunk,
> and when I tried to run some of the commands on that wiki page
> they didn't work, because they were deleted.
> 
> In this post-review comment:
> https://github.com/twisted/twisted/pull/1461#issuecomment-753695414 <https://github.com/twisted/twisted/pull/1461#issuecomment-753695414>
> 
> I asked Thomas if he could modify the wiki to reflect the changes he made in trunk,
> but this hasn't been done yet.
> 
> My impression in the comments in PR 1461 is that Thomas and Adi want
> to move all this documentation into the source tree, and delete the stuff on the wiki?
> 
> Is this the long term plan?

I can't quickly find the place where we agreed to this, but I think several years ago at this point we had a discussion about moving all these docs into the source tree.  (If they're on the wiki, there's no review process or even a place where updates can be staged for commentary before going live and becoming "official".)

> Until this is fully completed, what is the correct thing to do when there is a mismatch between docs on the wiki, and docs in the tree?

Docs in the tree always win.

> I still refer to a lot of docs on the wiki, especially for process related things,
> so I think it would be nice if the wiki docs were kept up to date, until the day that
> they are fully deleted.

Let's start deleting them now, and replacing them with links to the in-tree docs, rather than updating them.  They've been skewing out of date for a long time.  When I was looking for information about how to do a revert, I found wiki docs about linking to revisions in Subversion which didn't mention Github, which gives a flavor for how outdated some of this stuff is.

Thomas, would you mind doing the honors for this document?  Links for process docs should probably be to https://docs.twistedmatrix.com/en/latest/ <https://docs.twistedmatrix.com/en/latest/> since, for process information (unlike API information), trunk should be authoritative, not the latest release.

-g

> --
> Craig
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210203/e1e4ef1e/attachment-0001.htm>

From rodrigc at crodrigues.org  Thu Feb  4 19:39:44 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Thu, 4 Feb 2021 18:39:44 -0800
Subject: [Twisted-Python] Developer docs should be updated on wiki when
 steps changed in code?
In-Reply-To: <782E2EA5-E44D-4AC7-ADE5-794C3D9AD9D9@twistedmatrix.com>
References: <CAG=rPVdperfmna51N7_bdtPOtKdKRrZyu3crDFCpCoUrkgSimg@mail.gmail.com>
 <782E2EA5-E44D-4AC7-ADE5-794C3D9AD9D9@twistedmatrix.com>
Message-ID: <CAG=rPVfeGc2ndrK7Jf1zanB1Xo7M8Tm0sbuZqKMFh3CSPs7iHA@mail.gmail.com>

On Wednesday, February 3, 2021, Glyph <glyph at twistedmatrix.com> wrote:
>
>
>
> Docs in the tree always win.
>
> Let's start deleting them now, and replacing them with links to the
> in-tree docs, rather than updating them.  They've been skewing out of date
> for a long time.  When I was looking for information about how to do a
> revert, I found wiki docs about linking to revisions in Subversion which
> didn't mention Github, which gives a flavor for how outdated some of this
> stuff is.
>
> Thomas, would you mind doing the honors for this document?  Links for
> process docs should probably be to https://docs.twistedmatrix.
> com/en/latest/ since, for process information (unlike API information),
> trunk should be authoritative, not the latest release.
>



Glyph,

Thanks for the clarification.

This seems like a reasonable direction to follow moving forward.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210204/6b5b379f/attachment.htm>

From trac at twistedmatrix.com  Sun Feb  7 00:05:15 2021
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 07 Feb 2021 07:05:15 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1612681515.43.4223465312857243703@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210207/9ca007b6/attachment.htm>

From rodrigc at crodrigues.org  Wed Feb 10 01:40:35 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Wed, 10 Feb 2021 00:40:35 -0800
Subject: [Twisted-Python] Moving iocpsupport to an external package?
 Implications on Windows?
Message-ID: <CAG=rPVcFcL2obm1UK40vJmdbsGXHDX_yPKCtUeyDBW7hHOxoCg@mail.gmail.com>

Looking at this PR:

https://github.com/twisted/twisted/pull/1446

I see that iocpsupport was moved to a separate package, in order
to make building wheels on Windows easier.

Before this patch, I was prototyping building binary wheels on Windows
of Twisted core, and I had it working.

It looks like this code has now moved to:
https://github.com/twisted/twisted-iocpsupport

How will this patch change for people installing Twisted on Windows?

Twisted is still used by a lot of users on Windows, and the IOCP Reactor is
still used on this platform.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210210/015b92c7/attachment.htm>

From glyph at twistedmatrix.com  Wed Feb 10 01:47:27 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 10 Feb 2021 00:47:27 -0800
Subject: [Twisted-Python] Moving iocpsupport to an external package?
 Implications on Windows?
In-Reply-To: <CAG=rPVcFcL2obm1UK40vJmdbsGXHDX_yPKCtUeyDBW7hHOxoCg@mail.gmail.com>
References: <CAG=rPVcFcL2obm1UK40vJmdbsGXHDX_yPKCtUeyDBW7hHOxoCg@mail.gmail.com>
Message-ID: <E0D72AC1-7BDD-428B-AB5C-59556B75DBD1@twistedmatrix.com>



> On Feb 10, 2021, at 12:40 AM, Craig Rodrigues <rodrigc at crodrigues.org> wrote:
> 
> How will this patch change for people installing Twisted on Windows?
> 
> Twisted is still used by a lot of users on Windows, and the IOCP Reactor is
> still used on this platform.

This line is what does the trick:

https://github.com/twisted/twisted/pull/1446/files#diff-fa602a8a75dc9dcc92261bac5f533c2a85e34fcceaff63b3a3a81d9acde2fc52R34 <https://github.com/twisted/twisted/pull/1446/files#diff-fa602a8a75dc9dcc92261bac5f533c2a85e34fcceaff63b3a3a81d9acde2fc52R34>

Basically, on Windows, you'll automatically get the `twisted-iocpsupport` module as a hard dependency.  On other platforms, you won't.  Unless you're using a truly ancient `pip` (which is less likely on Windows, where people tend to install things themselves rather than getting them from a calcified platfom) this will just work ✨ magically ✨.

(Personally I think that in a future change, we should seriously consider moving this to an extra, since for some Windows users the simplicity of a pure-python install outweighs the performance improvements of a binary dependency.  And it should be possible to install Twisted without this accelerator.  But that is a very minor point compared to the benefits of not having to drag platform-variant wheels around for all other platforms!)

-g

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210210/9f9864ff/attachment.htm>

From rodrigc at crodrigues.org  Wed Feb 10 01:49:45 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Wed, 10 Feb 2021 00:49:45 -0800
Subject: [Twisted-Python] Getting ready to do a release of Twisted
Message-ID: <CAG=rPVcdd5XXV1F7uP9xGFfaRD5ccavsbeLdJ+q_NW=ppLqLJQ@mail.gmail.com>

Thanks to review work by Tom Most,
I have modified and merged https://github.com/twisted/twisted/pull/1502
which addresses test failures encountered against Buildbot's regression
suite.

I would like to proceed with doing a Twisted release.

Does anyone have any PR's that they are working on that they would like
to get into the tree now?

Otherwise, I would request Twisted committers to hold off merging to trunk
for the next few weeks until the release is complete.
--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210210/97b3b375/attachment.htm>

From glyph at twistedmatrix.com  Wed Feb 10 01:58:28 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 10 Feb 2021 00:58:28 -0800
Subject: [Twisted-Python] Getting ready to do a release of Twisted
In-Reply-To: <CAG=rPVcdd5XXV1F7uP9xGFfaRD5ccavsbeLdJ+q_NW=ppLqLJQ@mail.gmail.com>
References: <CAG=rPVcdd5XXV1F7uP9xGFfaRD5ccavsbeLdJ+q_NW=ppLqLJQ@mail.gmail.com>
Message-ID: <C317C986-FA7B-48CA-9CD6-A00C03CE4D1A@twistedmatrix.com>



> On Feb 10, 2021, at 12:49 AM, Craig Rodrigues <rodrigc at crodrigues.org> wrote:
> 
> Thanks to review work by Tom Most,
> I have modified and merged https://github.com/twisted/twisted/pull/1502 <https://github.com/twisted/twisted/pull/1502>
> which addresses test failures encountered against Buildbot's regression suite.
> 
> I would like to proceed with doing a Twisted release.

Yay!  Let's go!

> Does anyone have any PR's that they are working on that they would like
> to get into the tree now?

Unless it's a regression, let's not delay any further.  The next release will be faster!

> Otherwise, I would request Twisted committers to hold off merging to trunk for the next few weeks until the release is complete.

That's not how the release process is supposed to work.  Make the release branch, and development should proceed as usual.  (Not having any code freezes on trunk is the whole reason the process specifically uses a branch that is merged after the fact.)

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210210/4abe9c70/attachment.htm>

From rodrigc at crodrigues.org  Wed Feb 10 07:45:36 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Wed, 10 Feb 2021 06:45:36 -0800
Subject: [Twisted-Python] Moving iocpsupport to an external package?
 Implications on Windows?
In-Reply-To: <E0D72AC1-7BDD-428B-AB5C-59556B75DBD1@twistedmatrix.com>
References: <CAG=rPVcFcL2obm1UK40vJmdbsGXHDX_yPKCtUeyDBW7hHOxoCg@mail.gmail.com>
 <E0D72AC1-7BDD-428B-AB5C-59556B75DBD1@twistedmatrix.com>
Message-ID: <CAG=rPVehTx-VYkqQt3Ne0NeP4Lm5cprzxh2me3ek5eNu4H=r_g@mail.gmail.com>

On Wednesday, February 10, 2021, Glyph <glyph at twistedmatrix.com> wrote:

>
>
> On Feb 10, 2021, at 12:40 AM, Craig Rodrigues <rodrigc at crodrigues.org>
> wrote:
>
> How will this patch change for people installing Twisted on Windows?
>
> Twisted is still used by a lot of users on Windows, and the IOCP Reactor is
> still used on this platform.
>
>
> This line is what does the trick:
>
> https://github.com/twisted/twisted/pull/1446/files#diff-
> fa602a8a75dc9dcc92261bac5f533c2a85e34fcceaff63b3a3a81d9acde2fc52R34
>
> Basically, on Windows, you'll automatically get the `twisted-iocpsupport`
> module as a hard dependency.  On other platforms, you won't.  Unless you're
> using a *truly* ancient `pip` (which is less likely on Windows, where
> people tend to install things themselves rather than getting them from a
> calcified platfom) this will just work ✨ magically
>
>
 Ok, thanks for the clarification.  That is worth calling out in the
release announcement, since that is a major change for Windows users.

Is the https://github.com/twisted/twisted-iocpsupport repository subject to
the same rules as the Twisted core repository such as:
- must have a Trac ticket
- PR can only be merged after review approval from a reviewer with write
access to the https://github.com/twisted/twisted-iocpsupport repository.
etc.?

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210210/07bc1940/attachment-0001.htm>

From glyph at twistedmatrix.com  Wed Feb 10 15:56:55 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 10 Feb 2021 14:56:55 -0800
Subject: [Twisted-Python] Moving iocpsupport to an external package?
 Implications on Windows?
In-Reply-To: <CAG=rPVehTx-VYkqQt3Ne0NeP4Lm5cprzxh2me3ek5eNu4H=r_g@mail.gmail.com>
References: <CAG=rPVcFcL2obm1UK40vJmdbsGXHDX_yPKCtUeyDBW7hHOxoCg@mail.gmail.com>
 <E0D72AC1-7BDD-428B-AB5C-59556B75DBD1@twistedmatrix.com>
 <CAG=rPVehTx-VYkqQt3Ne0NeP4Lm5cprzxh2me3ek5eNu4H=r_g@mail.gmail.com>
Message-ID: <02AC5E09-6720-4208-AC59-3B128553113B@twistedmatrix.com>



> On Feb 10, 2021, at 6:45 AM, Craig Rodrigues <rodrigc at crodrigues.org> wrote:
> 
> 
> 
> On Wednesday, February 10, 2021, Glyph <glyph at twistedmatrix.com <mailto:glyph at twistedmatrix.com>> wrote:
> 
> 
>> On Feb 10, 2021, at 12:40 AM, Craig Rodrigues <rodrigc at crodrigues.org <mailto:rodrigc at crodrigues.org>> wrote:
>> 
>> How will this patch change for people installing Twisted on Windows?
>> 
>> Twisted is still used by a lot of users on Windows, and the IOCP Reactor is
>> still used on this platform.
> 
> This line is what does the trick:
> 
> https://github.com/twisted/twisted/pull/1446/files#diff-fa602a8a75dc9dcc92261bac5f533c2a85e34fcceaff63b3a3a81d9acde2fc52R34 <https://github.com/twisted/twisted/pull/1446/files#diff-fa602a8a75dc9dcc92261bac5f533c2a85e34fcceaff63b3a3a81d9acde2fc52R34>
> 
> Basically, on Windows, you'll automatically get the `twisted-iocpsupport` module as a hard dependency.  On other platforms, you won't.  Unless you're using a truly ancient `pip` (which is less likely on Windows, where people tend to install things themselves rather than getting them from a calcified platfom) this will just work ✨ magically 
> 
> 
>  Ok, thanks for the clarification.  That is worth calling out in the release announcement, since that is a major change for Windows users.

I don't disagree that it's worth calling out, but I might quibble on "major" change - it's a small build-configuration change that mostly affects Twisted contributors (in a positive way), and those with heavily locked-down build environments.  From the perspective of a Twisted user on Windows who wants to make use of the IOCP reactor and is installing with a regular `pip install`, nothing changes except a new line in `pip freeze`.

> Is the https://github.com/twisted/twisted-iocpsupport <https://github.com/twisted/twisted-iocpsupport> repository subject to the same rules as the Twisted core repository such as:
> - must have a Trac ticket

Yep! You can see in the README.rst on the repo, and also on its PyPI page: https://pypi.org/project/twisted-iocpsupport/ <https://pypi.org/project/twisted-iocpsupport/>

> - PR can only be merged after review approval from a reviewer with write access to the https://github.com/twisted/twisted-iocpsupport <https://github.com/twisted/twisted-iocpsupport> repository.
> etc.?

The full @twisted/twisted-contributors team has write access to this repo so it's all set for any Twisted reviewer who has the time and inclination.

I just noticed that PyPI just had me and graingert, though.  Sadly, PyPI doesn't have teams, so I synced up the management permissions on the PyPI project to match Twisted.  (The current list of uploaders isn't particularly principled or up to date, but better to have one list than two.  And I don't want a bus-factor of 1...)

-g

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210210/5a8a154b/attachment.htm>

From rodrigc at crodrigues.org  Wed Feb 10 16:18:48 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Wed, 10 Feb 2021 15:18:48 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
Message-ID: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>

Hi,

I quickly asked Wilfredo if Twisted trunk worked with Klein, and he mentioned
that he saw this dependency issue on the Twisted klein side when used
with Twisted trunk:

The conflict is caused by:
    The user requested idna==3.1
    hyperlink 21.0.0 depends on idna>=2.5
    requests 2.25.1 depends on idna<3 and >=2.5


Is that problem purely for klein to deal with, or is there
any issue that should be fixed in Twisted trunk?

--
Craig


From glyph at twistedmatrix.com  Wed Feb 10 16:44:42 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 10 Feb 2021 15:44:42 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
Message-ID: <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>



> On Feb 10, 2021, at 3:18 PM, Craig Rodrigues <rodrigc at crodrigues.org> wrote:
> 
> Hi,
> 
> I quickly asked Wilfredo if Twisted trunk worked with Klein, and he mentioned
> that he saw this dependency issue on the Twisted klein side when used
> with Twisted trunk:
> 
> The conflict is caused by:
>    The user requested idna==3.1
>    hyperlink 21.0.0 depends on idna>=2.5
>    requests 2.25.1 depends on idna<3 and >=2.5
> 
> 
> Is that problem purely for klein to deal with, or is there
> any issue that should be fixed in Twisted trunk?

This isn't even a bug in Klein, it's an issue with a version pin in its tox.ini:  https://github.com/twisted/klein/blob/6e7b37158dea2fe73180809803a872ed98143c6d/tox.ini#L36 <https://github.com/twisted/klein/blob/6e7b37158dea2fe73180809803a872ed98143c6d/tox.ini#L36> 

The constraints from requests (<3,>=2.5) and hyperlink (>=2.5) are perfectly compatible; one's just a subset of the other.

So it might be nice to submit a Klein PR at some point soon, but it's not a release blocker.

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210210/0713cf04/attachment.htm>

From rodrigc at crodrigues.org  Wed Feb 10 17:46:14 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Wed, 10 Feb 2021 16:46:14 -0800
Subject: [Twisted-Python] Moving iocpsupport to an external package?
 Implications on Windows?
In-Reply-To: <02AC5E09-6720-4208-AC59-3B128553113B@twistedmatrix.com>
References: <CAG=rPVcFcL2obm1UK40vJmdbsGXHDX_yPKCtUeyDBW7hHOxoCg@mail.gmail.com>
 <E0D72AC1-7BDD-428B-AB5C-59556B75DBD1@twistedmatrix.com>
 <CAG=rPVehTx-VYkqQt3Ne0NeP4Lm5cprzxh2me3ek5eNu4H=r_g@mail.gmail.com>
 <02AC5E09-6720-4208-AC59-3B128553113B@twistedmatrix.com>
Message-ID: <CAG=rPVeOrQbfGk3Ywj664_QfSPN1i77_-w=BJsjPUcoHdXNvQQ@mail.gmail.com>

On Wed, Feb 10, 2021 at 2:57 PM Glyph <glyph at twistedmatrix.com> wrote:
>
>
>
> On Feb 10, 2021, at 6:45 AM, Craig Rodrigues <rodrigc at crodrigues.org> wrote:
>
>
>
> On Wednesday, February 10, 2021, Glyph <glyph at twistedmatrix.com> wrote:
>>
>>
>>
>> On Feb 10, 2021, at 12:40 AM, Craig Rodrigues <rodrigc at crodrigues.org> wrote:
>>
>> How will this patch change for people installing Twisted on Windows?
>>
>> Twisted is still used by a lot of users on Windows, and the IOCP Reactor is
>> still used on this platform.
>>
>>
>> This line is what does the trick:
>>
>> https://github.com/twisted/twisted/pull/1446/files#diff-fa602a8a75dc9dcc92261bac5f533c2a85e34fcceaff63b3a3a81d9acde2fc52R34
>>
>> Basically, on Windows, you'll automatically get the `twisted-iocpsupport` module as a hard dependency.  On other platforms, you won't.  Unless you're using a truly ancient `pip` (which is less likely on Windows, where people tend to install things themselves rather than getting them from a calcified platfom) this will just work magically
>>
>
>  Ok, thanks for the clarification.  That is worth calling out in the release announcement, since that is a major change for Windows users.
>
>
> I don't disagree that it's worth calling out, but I might quibble on "major" change - it's a small build-configuration change that mostly affects Twisted contributors (in a positive way), and those with heavily locked-down build environments.  From the perspective of a Twisted user on Windows who wants to make use of the IOCP reactor and is installing with a regular `pip install`, nothing changes except a new line in `pip freeze`.


I think that you are right, and everything will probably just work for
Windows users.

I'm just thinking from the perspective of a user of Twisted on
Windows, who may not be familiar with all the latest
innovations in pip, and may encounter a problem.  But I think that
these issues will be minor/few, and we can handle them post-release if
necessary.


>
> Yep! You can see in the README.rst on the repo, and also on its PyPI page: https://pypi.org/project/twisted-iocpsupport/

Thanks for the clarification.  One unfortunate thing with this move to
another repository is that
version history has been lost, going all the way back to 2008.  It's
not the end of the world, since anyone who really
wants that history can check out an earlier branch of twisted and look
at it, but it is still an extra hop for someone to do.

--
Craig


From wsanchez at wsanchez.net  Thu Feb 11 12:25:35 2021
From: wsanchez at wsanchez.net (=?utf-8?Q?Wilfredo_S=C3=A1nchez_Vega?=)
Date: Thu, 11 Feb 2021 11:25:35 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
 <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
Message-ID: <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>

On Feb 10, 2021, at 3:44 PM, Glyph <glyph at twistedmatrix.com> wrote:
> 
> This isn't even a bug in Klein, it's an issue with a version pin in its tox.ini:  https://github.com/twisted/klein/blob/6e7b37158dea2fe73180809803a872ed98143c6d/tox.ini#L36 <https://github.com/twisted/klein/blob/6e7b37158dea2fe73180809803a872ed98143c6d/tox.ini#L36> 
> 
> The constraints from requests (<3,>=2.5) and hyperlink (>=2.5) are perfectly compatible; one's just a subset of the other.

  Sure, they are compatible, but Klein doesn’t use requests directly, and this only looks to be failing in trunk.

  My concern here is that Twisted may have added a dependency on requests, and that dependency means that if you want IDNA==3.1, as Klein’s tox.ini does, that you aren’t allowed to.  That seems weak; I’d say a bug.  No?

	-wsv

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210211/fec8b168/attachment.htm>

From wsanchez at wsanchez.net  Thu Feb 11 12:41:44 2021
From: wsanchez at wsanchez.net (=?utf-8?Q?Wilfredo_S=C3=A1nchez_Vega?=)
Date: Thu, 11 Feb 2021 11:41:44 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
 <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
 <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
Message-ID: <9E548BB3-2C58-4C47-AF3A-8613B39C21F8@wsanchez.net>

>   My concern here is that Twisted may have added a dependency on requests, and that dependency means that if you want IDNA==3.1, as Klein’s tox.ini does, that you aren’t allowed to.  That seems weak; I’d say a bug.  No?

  Note this is only cause when installing treq, so the issue seems to be there, though for some reason, it’s only a problem with Twisted trunk, which kind of confuses me, but I haven’t dug into it beyond trying to figure out a bit about what fails to install.

  So I agree probably it’s not a blocker for Twisted, and it’s only annoying to Klein for its own testing, not it’s clients, but if I were a client of treq (and Klein is), I’d think this is a bug.

	-wsv


From glyph at twistedmatrix.com  Thu Feb 11 14:04:15 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 11 Feb 2021 13:04:15 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <9E548BB3-2C58-4C47-AF3A-8613B39C21F8@wsanchez.net>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
 <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
 <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
 <9E548BB3-2C58-4C47-AF3A-8613B39C21F8@wsanchez.net>
Message-ID: <529D0EA4-73CE-4DBC-8A8A-1FCF44357259@twistedmatrix.com>


> On Feb 11, 2021, at 11:41 AM, Wilfredo Sánchez Vega <wsanchez at wsanchez.net> wrote:
> 
>>  My concern here is that Twisted may have added a dependency on requests, and that dependency means that if you want IDNA==3.1, as Klein’s tox.ini does, that you aren’t allowed to.  That seems weak; I’d say a bug.  No?
> 
>  Note this is only cause when installing treq, so the issue seems to be there, though for some reason, it’s only a problem with Twisted trunk, which kind of confuses me, but I haven’t dug into it beyond trying to figure out a bit about what fails to install.
> 
>  So I agree probably it’s not a blocker for Twisted, and it’s only annoying to Klein for its own testing, not it’s clients, but if I were a client of treq (and Klein is), I’d think this is a bug.

Attempting to reproduce this locally was a real adventure for me.  I had a bunch of failure-to-terminate cases from the new pip resolver, until I gave up, download the newest security update of each release of python, upgraded pip, tox, setuptools, and virtualenv for every python version, fully cleaned my git checkout, and re-ran.

Now everything passes except for coverage-py39-twtrunk, which still fails to terminate.

Under -vvvv, it spends a very long time printing messages like these over and over again:

INFO: pip is looking at multiple versions of setuptools to determine which version is compatible with other requirements. This could take a while.
INFO: This is taking longer than usual. You might need to provide the dependency resolver with stricter constraints to reduce runtime. If you want to abort this run, you can press Ctrl + C to do so. To improve how pip performs, tell us what happened here: https://pip.pypa.io/surveys/backtracking <https://pip.pypa.io/surveys/backtracking>

as it installs every version of setuptools and six that has ever existed.

It seems like Klein has backed itself into a very weird and complex corner with the new dependency resolver, but it doesn't appear unique to Twisted trunk, just perhaps tickled ever so slightly worse.

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210211/abd43aba/attachment.htm>

From adi at roiban.ro  Thu Feb 11 14:15:47 2021
From: adi at roiban.ro (Adi Roiban)
Date: Thu, 11 Feb 2021 21:15:47 +0000
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
 <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
 <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
Message-ID: <CAFycZ9cnVgxXbs2LoX_AtyomC12KbSYMJAGMYLfxP_f=YJxbgQ@mail.gmail.com>

On Thu, 11 Feb 2021 at 19:26, Wilfredo Sánchez Vega <wsanchez at wsanchez.net>
wrote:

> On Feb 10, 2021, at 3:44 PM, Glyph <glyph at twistedmatrix.com> wrote:
>
>
> This isn't even a bug in Klein, it's an issue with a version pin in its
> tox.ini:
> https://github.com/twisted/klein/blob/6e7b37158dea2fe73180809803a872ed98143c6d/tox.ini#L36
>
>
> The constraints from requests (<3,>=2.5) and hyperlink (>=2.5) are
> perfectly compatible; one's just a subset of the other.
>
>
>   Sure, they are compatible, but Klein doesn’t use requests directly, and
> this only looks to be failing in trunk.
>
>   My concern here is that Twisted may have added a dependency on requests,
> and that dependency means that if you want IDNA==3.1, as Klein’s tox.ini
> does, that you aren’t allowed to.  That seems weak; I’d say a bug.  No?
>
>
I have created a new virtual env and executed `pip install .` on trunk.

It installed the following packages:

constantly, zope.interface, attrs, incremental, six, Automat, idna,
hyperlink, Twisted

------------

`requests` was not installed.

I wasn't expecting to see `idna` as it is listed as TLS only deps.... but
it looks like hyperlink depends on idna.

Here is the dep tree

$ pipdeptree -fl
Twisted @ file:///home/adi/dev/twisted
  attrs==20.3.0
  Automat==20.2.0
    attrs==20.3.0
    six==1.15.0
  constantly==15.1.0
  hyperlink==21.0.0
    idna==3.1
  incremental==17.5.0
  zope.interface==5.2.0
    setuptools==44.0.0
wheel==0.36.2

------------

I guess that we can remove idna from setup.cfg TLS section in Twisted


tls =
    pyopenssl >= 16.0.0
    # service_identity 18.1.0 added support for validating IP addresses in
    # certificate subjectAltNames
    service_identity >= 18.1.0
    idna >= 2.4

Cheers

-- 
Adi Roiban
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210211/4c3ede72/attachment-0001.htm>

From glyph at twistedmatrix.com  Thu Feb 11 15:06:01 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 11 Feb 2021 14:06:01 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <CAFycZ9cnVgxXbs2LoX_AtyomC12KbSYMJAGMYLfxP_f=YJxbgQ@mail.gmail.com>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
 <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
 <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
 <CAFycZ9cnVgxXbs2LoX_AtyomC12KbSYMJAGMYLfxP_f=YJxbgQ@mail.gmail.com>
Message-ID: <89D7893B-06B3-4026-B63E-B96459A08AF3@twistedmatrix.com>



> On Feb 11, 2021, at 1:15 PM, Adi Roiban <adi at roiban.ro> wrote:
> 
> I guess that we can remove idna from setup.cfg TLS section in Twisted
> 

Nope; we use it directly, in https://github.com/twisted/twisted/blob/7cf6c8bc320ac5fd96b4784f6feb932ea819856d/src/twisted/internet/_idna.py <https://github.com/twisted/twisted/blob/7cf6c8bc320ac5fd96b4784f6feb932ea819856d/src/twisted/internet/_idna.py>.

In fact, if anything, we should bump it up, since we use it even in non-tls configurations: https://github.com/twisted/twisted/blob/cd97222df2ca7032bbff2fe9a8793d7b42dee8b7/src/twisted/internet/_resolver.py#L208 <https://github.com/twisted/twisted/blob/cd97222df2ca7032bbff2fe9a8793d7b42dee8b7/src/twisted/internet/_resolver.py#L208> .

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210211/d4541cae/attachment.htm>

From glyph at twistedmatrix.com  Thu Feb 11 15:09:53 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 11 Feb 2021 14:09:53 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <529D0EA4-73CE-4DBC-8A8A-1FCF44357259@twistedmatrix.com>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
 <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
 <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
 <9E548BB3-2C58-4C47-AF3A-8613B39C21F8@wsanchez.net>
 <529D0EA4-73CE-4DBC-8A8A-1FCF44357259@twistedmatrix.com>
Message-ID: <8EC73780-E3C3-49D3-99E7-812748C6F742@twistedmatrix.com>



> On Feb 11, 2021, at 1:04 PM, Glyph <glyph at twistedmatrix.com> wrote:
> 
> 
>> On Feb 11, 2021, at 11:41 AM, Wilfredo Sánchez Vega <wsanchez at wsanchez.net <mailto:wsanchez at wsanchez.net>> wrote:
>> 
>>>  My concern here is that Twisted may have added a dependency on requests, and that dependency means that if you want IDNA==3.1, as Klein’s tox.ini does, that you aren’t allowed to.  That seems weak; I’d say a bug.  No?
>> 
>>  Note this is only cause when installing treq, so the issue seems to be there, though for some reason, it’s only a problem with Twisted trunk, which kind of confuses me, but I haven’t dug into it beyond trying to figure out a bit about what fails to install.
>> 
>>  So I agree probably it’s not a blocker for Twisted, and it’s only annoying to Klein for its own testing, not it’s clients, but if I were a client of treq (and Klein is), I’d think this is a bug.
> 
> Attempting to reproduce this locally was a real adventure for me.  I had a bunch of failure-to-terminate cases from the new pip resolver, until I gave up, download the newest security update of each release of python, upgraded pip, tox, setuptools, and virtualenv for every python version, fully cleaned my git checkout, and re-ran.
> 
> Now everything passes except for coverage-py39-twtrunk, which still fails to terminate.
> 
> Under -vvvv, it spends a very long time printing messages like these over and over again:
> 
> INFO: pip is looking at multiple versions of setuptools to determine which version is compatible with other requirements. This could take a while.
> INFO: This is taking longer than usual. You might need to provide the dependency resolver with stricter constraints to reduce runtime. If you want to abort this run, you can press Ctrl + C to do so. To improve how pip performs, tell us what happened here: https://pip.pypa.io/surveys/backtracking <https://pip.pypa.io/surveys/backtracking>
> 
> as it installs every version of setuptools and six that has ever existed.
> 
> It seems like Klein has backed itself into a very weird and complex corner with the new dependency resolver, but it doesn't appear unique to Twisted trunk, just perhaps tickled ever so slightly worse.

I've now been running `tox -vvvv -r -e coverage-py39-twtrunk` for well over an hour, so I think we may have some pip resolver bugs to report.

-g

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210211/61663483/attachment.htm>

From glyph at twistedmatrix.com  Thu Feb 11 15:29:36 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 11 Feb 2021 14:29:36 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <8EC73780-E3C3-49D3-99E7-812748C6F742@twistedmatrix.com>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
 <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
 <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
 <9E548BB3-2C58-4C47-AF3A-8613B39C21F8@wsanchez.net>
 <529D0EA4-73CE-4DBC-8A8A-1FCF44357259@twistedmatrix.com>
 <8EC73780-E3C3-49D3-99E7-812748C6F742@twistedmatrix.com>
Message-ID: <77C0628F-A7CD-4F92-8C40-6C200527E6F7@twistedmatrix.com>



> On Feb 11, 2021, at 2:09 PM, Glyph <glyph at twistedmatrix.com> wrote:
> 
> 
> 
>> On Feb 11, 2021, at 1:04 PM, Glyph <glyph at twistedmatrix.com <mailto:glyph at twistedmatrix.com>> wrote:
>> 
>> 
>>> On Feb 11, 2021, at 11:41 AM, Wilfredo Sánchez Vega <wsanchez at wsanchez.net <mailto:wsanchez at wsanchez.net>> wrote:
>>> 
>>>>  My concern here is that Twisted may have added a dependency on requests, and that dependency means that if you want IDNA==3.1, as Klein’s tox.ini does, that you aren’t allowed to.  That seems weak; I’d say a bug.  No?
>>> 
>>>  Note this is only cause when installing treq, so the issue seems to be there, though for some reason, it’s only a problem with Twisted trunk, which kind of confuses me, but I haven’t dug into it beyond trying to figure out a bit about what fails to install.
>>> 
>>>  So I agree probably it’s not a blocker for Twisted, and it’s only annoying to Klein for its own testing, not it’s clients, but if I were a client of treq (and Klein is), I’d think this is a bug.
>> 
>> Attempting to reproduce this locally was a real adventure for me.  I had a bunch of failure-to-terminate cases from the new pip resolver, until I gave up, download the newest security update of each release of python, upgraded pip, tox, setuptools, and virtualenv for every python version, fully cleaned my git checkout, and re-ran.
>> 
>> Now everything passes except for coverage-py39-twtrunk, which still fails to terminate.
>> 
>> Under -vvvv, it spends a very long time printing messages like these over and over again:
>> 
>> INFO: pip is looking at multiple versions of setuptools to determine which version is compatible with other requirements. This could take a while.
>> INFO: This is taking longer than usual. You might need to provide the dependency resolver with stricter constraints to reduce runtime. If you want to abort this run, you can press Ctrl + C to do so. To improve how pip performs, tell us what happened here: https://pip.pypa.io/surveys/backtracking <https://pip.pypa.io/surveys/backtracking>
>> 
>> as it installs every version of setuptools and six that has ever existed.
>> 
>> It seems like Klein has backed itself into a very weird and complex corner with the new dependency resolver, but it doesn't appear unique to Twisted trunk, just perhaps tickled ever so slightly worse.
> 
> I've now been running `tox -vvvv -r -e coverage-py39-twtrunk` for well over an hour, so I think we may have some pip resolver bugs to report.

I filed https://github.com/pypa/pip/issues/9601 <https://github.com/pypa/pip/issues/9601> for this since it seems like it's well outside of our control.  If anyone else can add more information that would be great.

-g

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210211/c1d1b040/attachment-0001.htm>

From rodrigc at crodrigues.org  Fri Feb 12 18:57:13 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Fri, 12 Feb 2021 17:57:13 -0800
Subject: [Twisted-Python] Twisted trunk and klein?
In-Reply-To: <77C0628F-A7CD-4F92-8C40-6C200527E6F7@twistedmatrix.com>
References: <CAG=rPVeHRq+k_M8dTOZObtNBj5i1DwKrXZLqUxf=5__MN+GHqA@mail.gmail.com>
 <A3282449-39B3-4022-8AE4-8EBA97432B86@twistedmatrix.com>
 <D810BD4F-D06B-4EA2-8E02-C6CADBC06C83@wsanchez.net>
 <9E548BB3-2C58-4C47-AF3A-8613B39C21F8@wsanchez.net>
 <529D0EA4-73CE-4DBC-8A8A-1FCF44357259@twistedmatrix.com>
 <8EC73780-E3C3-49D3-99E7-812748C6F742@twistedmatrix.com>
 <77C0628F-A7CD-4F92-8C40-6C200527E6F7@twistedmatrix.com>
Message-ID: <CAG=rPVftQn2-745wG60dmGT26nE0bW4LCB6Xvu482xr3mD8RBQ@mail.gmail.com>

On Thu, Feb 11, 2021 at 2:29 PM Glyph <glyph at twistedmatrix.com> wrote:
>
>
> I filed https://github.com/pypa/pip/issues/9601 for this since it seems like it's well outside of our control.  If anyone else can add more information that would be great.
>


Thanks for doing the analysis and filing that bug.  I didn't want to
jump on anything, and wanted to give some breathing room for
folks to look at that and chime in.

Wilfredo has this PR to klein where he is also looking at these
issues: https://github.com/twisted/klein/pull/450

So I think that I will not hold up the Twisted core release based on
this issue.  Hopefully this issue can be resolved outside of Twisted
core.

--
Craig


From trac at twistedmatrix.com  Sun Feb 14 00:05:23 2021
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 14 Feb 2021 07:05:23 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1613286323.14.8141469923045929433@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210214/8aa265f3/attachment.htm>

From rodrigc at crodrigues.org  Sun Feb 14 17:15:15 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sun, 14 Feb 2021 16:15:15 -0800
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
Message-ID: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>

Hi,

This ticket: Use latest pydoctor release,
https://twistedmatrix.com/trac/ticket/10068

is marked as a release blocker.

Has that been resolved or is there more work that needs to be done to fix that?

--
Craig


From rodrigc at crodrigues.org  Sun Feb 14 18:19:16 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sun, 14 Feb 2021 17:19:16 -0800
Subject: [Twisted-Python] Release instructions: `tox -e towncrier` does not
 work?
Message-ID: <CAG=rPVcPD6YuuhgYG92PeRzufSwp0KrjqtMi-BBGK3gdTH-8SQ@mail.gmail.com>

In
https://github.com/twisted/twisted/commit/0ad24679b168370bf0d695825170a7532bf0698f#diff-4fd162cb9fc2878b140dcc9d9d364f9f60d404a76ebda2c10518810ffe63852dL115

Adi Roiban changed one of the steps the release documentation to run a
command:

*tox -e towncrier*

but that tox target does not exist.

Does Adi or someone else have that tox target in a patch lying
around somewhere?

For now I can manually run *towncrier *manually outside of tox.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210214/c5a1ad08/attachment.htm>

From rodrigc at crodrigues.org  Sun Feb 14 19:53:01 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sun, 14 Feb 2021 18:53:01 -0800
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate Announcement
Message-ID: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>

It's time for another Twisted release!

There are two major announcements for this release:

- *Python 2.7 support has been dropped*.  Twisted 21.2.0 supports Python
3.5 and higher only
- *This will be the last Twisted release to support Python 3.5*.

Twisted 21.2.0rc1 brings the following:
- twist dns --pyzone now works on Python 3
- twisted.web.twcgi now works on Python 3
- all tests pass on all platforms on Python 3.8, including asyncio tests on
Windows
- tests pass on Python 3.9 (thanks to Michał Górny)
- type hints, as specified in PEP 484, are now used in functions throughout
the codebase
- mypy (static type checker) is now run over the codebase during CI to help
detect problems, and help improve the use of types
- code in is now formatted with Black (thanks to Tom Most)
- many CI and automation improvements (thanks to Adi Roiban and Thomas
Grainger)
- many more fixes (225 tickets closed!)


You can install by running this command:

      python -m pip install Twisted==21.2.0rc1

The full tarball is available at:
    https://pypi.org/project/Twisted/21.2.0rc1/#files

The full NEWS file with all changes is at:
    https://github.com/twisted/twisted/blob/twisted-21.2.0rc1/NEWS.rst

Please test it, and let me know how your applications fare, good or bad!
If nothing comes up, 21.2 will release very soon.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210214/cd971993/attachment.htm>

From sda at fstab.net  Mon Feb 15 10:26:29 2021
From: sda at fstab.net (Kyle Altendorf)
Date: Mon, 15 Feb 2021 12:26:29 -0500
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
Message-ID: <fb8dd46e86d4b73aff097acc43ee1c4b@fstab.net>

On 2021-02-14 21:53, Craig Rodrigues wrote:

> Please test it, and let me know how your applications fare, good or bad!

Hi Craig,

Thanks for all the work to get us into the next Twisted release.

All,

I went ahead and set pip_pre=true in pytest-twisted's tox.ini to try it
out and got warnings/errors with PyPy 3.7 about use of t.i.d.returnValue
claiming it should only be used in @inlineCallbacks decorated functions
even though the location complained about is such. Only PyPy 3.7, not
PyPy 3.6 nor CPython 3.7. Linux, macOS, and Windows all failed.

https://github.com/pytest-dev/pytest-twisted/pull/134/checks?check_run_id=1904583062

I also pulled a branch and PR off of the release branch and added PyPy
3.7 to the matrix. CI failed on PyPy 3.7.

https://github.com/twisted/twisted/pull/1515/checks?check_run_id=1904809978

NonLocalExitTests
test_returnValueNonLocalDeferred ... [FAIL]
test_returnValueNonLocalWarning ... [FAIL]

Ticketed as https://twistedmatrix.com/trac/ticket/10093.

Seems like it might be an easy special-case fix so I'll take a look. I
don't know if this qualifies as a releaser blocker or not, or if it can
get cherry picked into the release anyways. Others will have to weigh in
on that.  I guess it's basically just lack of support for a 'new' PyPy
version.  PyPy 3.7 beta was released in November and alpha in September.
 I understand choosing not to bother fitting this in, but after blowing
past CPython 3.8 and 3.9 released it would be nice to actually be all
around caught up.

Cheers,
-kyle
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210215/dc1cbb36/attachment.htm>

From rodrigc at crodrigues.org  Mon Feb 15 11:54:05 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Mon, 15 Feb 2021 10:54:05 -0800
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <fb8dd46e86d4b73aff097acc43ee1c4b@fstab.net>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
 <fb8dd46e86d4b73aff097acc43ee1c4b@fstab.net>
Message-ID: <CAG=rPVeuqeqhkqNLinE6wGb7ZPcX_7L4WikkCAJQL9aWwGv=vQ@mail.gmail.com>

On Monday, February 15, 2021, Kyle Altendorf <sda at fstab.net> wrote:

>
> NonLocalExitTests
> test_returnValueNonLocalDeferred ... [FAIL]
> test_returnValueNonLocalWarning ... [FAIL]
>
> Ticketed as https://twistedmatrix.com/trac/ticket/10093.
>
>
>
>
Thanks for the testing, detailed analysis, and ticket.  If you can come up
with a relatively simple fix in the next week,  I'm ok the cherry-picking
that into the release.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210215/15f97651/attachment.htm>

From glyph at twistedmatrix.com  Mon Feb 15 18:50:12 2021
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 15 Feb 2021 17:50:12 -0800
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
Message-ID: <ACDF9965-F638-4B7F-B5B1-C1EF271CCA4F@twistedmatrix.com>

Thank you Craig for getting this out!  On Valentines day, no less :-) ❤️.

Very excited that the release train is back on the tracks! 🚂

It's been a very rough year.  Thank you to everyone who contributed to the 225 tickets that have been closed during this release, and thanks also to everyone else who is trying to accelerate the progress of the next release so the next one won't be such a massive effort to get out!

-g

> On Feb 14, 2021, at 6:53 PM, Craig Rodrigues <rodrigc at crodrigues.org> wrote:
> 
> It's time for another Twisted release!
> 
> There are two major announcements for this release:
> 
> - Python 2.7 support has been dropped.  Twisted 21.2.0 supports Python 3.5 and higher only
> - This will be the last Twisted release to support Python 3.5.
> 
> Twisted 21.2.0rc1 brings the following:
> - twist dns --pyzone now works on Python 3
> - twisted.web.twcgi now works on Python 3
> - all tests pass on all platforms on Python 3.8, including asyncio tests on Windows
> - tests pass on Python 3.9 (thanks to Michał Górny)
> - type hints, as specified in PEP 484, are now used in functions throughout the codebase
> - mypy (static type checker) is now run over the codebase during CI to help detect problems, and help improve the use of types
> - code in is now formatted with Black (thanks to Tom Most)
> - many CI and automation improvements (thanks to Adi Roiban and Thomas Grainger)
> - many more fixes (225 tickets closed!)
> 
> 
> You can install by running this command:
> 
>       python -m pip install Twisted==21.2.0rc1
> 
> The full tarball is available at:
>     https://pypi.org/project/Twisted/21.2.0rc1/#files <https://pypi.org/project/Twisted/21.2.0rc1/#files>
> 
> The full NEWS file with all changes is at:
>     https://github.com/twisted/twisted/blob/twisted-21.2.0rc1/NEWS.rst <https://github.com/twisted/twisted/blob/twisted-21.2.0rc1/NEWS.rst>
> 
> Please test it, and let me know how your applications fare, good or bad!
> If nothing comes up, 21.2 will release very soon.
> 
> --
> Craig
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210215/4cd8780e/attachment.htm>

From rodrigc at crodrigues.org  Fri Feb 19 19:08:01 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Fri, 19 Feb 2021 18:08:01 -0800
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
In-Reply-To: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
References: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
Message-ID: <CAG=rPVeta5Qq7XTWEb7PBxxZ=MpTwofjVGb4LzMSfHw8phgxWw@mail.gmail.com>

Adi,

Is there anything to be done here, or is this still a release blocker?

--
Craig


On Sun, Feb 14, 2021 at 4:15 PM Craig Rodrigues <rodrigc at crodrigues.org>
wrote:

> Hi,
>
> This ticket: Use latest pydoctor release,
> https://twistedmatrix.com/trac/ticket/10068
>
> is marked as a release blocker.
>
> Has that been resolved or is there more work that needs to be done to fix
> that?
>
> --
> Craig
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210219/5aa891ba/attachment.htm>

From rodrigc at crodrigues.org  Sat Feb 20 10:47:05 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sat, 20 Feb 2021 09:47:05 -0800
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
In-Reply-To: <CAFycZ9cd6h4R4DT3ZD7GUs3Qy8nRGwE2uwr5eqYygSwvVoLUhQ@mail.gmail.com>
References: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
 <CAG=rPVeta5Qq7XTWEb7PBxxZ=MpTwofjVGb4LzMSfHw8phgxWw@mail.gmail.com>
 <CAFycZ9cd6h4R4DT3ZD7GUs3Qy8nRGwE2uwr5eqYygSwvVoLUhQ@mail.gmail.com>
Message-ID: <CAG=rPVcZ0oF=QpU+jdn45LuLEoLRHy8NfdTGAkpUdAsLrFx=oA@mail.gmail.com>

Hi,

I am confused.  I thought that you and Thomas Graingert had completed all
the automation and had changed the Twisted release scripts to host the
documentation on readthedocs and that was all in place right now.

Is that not the case?

How much more work is necessary to completely host the next Twisted
release's docs on readthedocs?

-- 
Craig

On Saturday, February 20, 2021, Adi Roiban <adiroiban at gmail.com> wrote:

> Hi,
>
> Sorry for the delay.
>
> This was added as a  blocker due to the changes from
> https://github.com/twisted/twisted/pull/1496 and the plan to use Read The
> Docs to
> host the official docs.
>
> This is not a blocker if the official documentation for this release will
> continue to be hosted on the Twisted own server at
> https://twistedmatrix.com/documents/current/
>
> It's a blocker only if the official documentation is to be hosted on Read
> The Docs at docs.twistedmatrix.com
>
> I have updated the ticket to no longer block the release.
>
> Cheers
>
>
> On Sat, 20 Feb 2021 at 02:08, Craig Rodrigues <rodrigc at crodrigues.org>
> wrote:
>
>> Adi,
>>
>> Is there anything to be done here, or is this still a release blocker?
>>
>> --
>> Craig
>>
>>
>> On Sun, Feb 14, 2021 at 4:15 PM Craig Rodrigues <rodrigc at crodrigues.org>
>> wrote:
>>
>>> Hi,
>>>
>>> This ticket: Use latest pydoctor release,
>>> https://twistedmatrix.com/trac/ticket/10068
>>>
>>> is marked as a release blocker.
>>>
>>> Has that been resolved or is there more work that needs to be done to
>>> fix that?
>>>
>>> --
>>> Craig
>>>
>>
>
> --
> Adi Roiban
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210220/c81761dd/attachment.htm>

From richard at matrix.org  Sat Feb 20 17:31:21 2021
From: richard at matrix.org (Richard van der Hoff)
Date: Sun, 21 Feb 2021 00:31:21 +0000
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
Message-ID: <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>

On 15/02/2021 02:53, Craig Rodrigues wrote:
> It's time for another Twisted release!
>
> There are two major announcements for this release:
>
> - *Python 2.7 support has been dropped*.  Twisted 21.2.0 supports 
> Python 3.5 and higher only
> - *This will be the last Twisted release to support Python 3.5*.
>
Thanks Craig for getting this release ready.

It looks like it is incompatible with Python 3.5.2: exception as below. 
There's no real reason you should care about this, except that it is 
(still!) what Ubuntu 16.04LTS ships with, and Ubuntu claim to still be 
supporting 16.04 until April this year, so this might catch a few people 
by surprise, as it did me[1]. Anyway, I suggest bumping 
`python_requires` in `setup.cfg` 
(https://github.com/twisted/twisted/blob/trunk/setup.cfg#L27), to stop 
the new version being installed on systems where it won't work.

(env3)rav at faith:~$ python3
Python 3.5.2 (default, Oct  7 2020, 17:19:02)
[GCC 5.4.0 20160609] on linux
Type "help", "copyright", "credits" or "license" for more information.
 >>> from twisted.python import log
Traceback (most recent call last):
   File "<stdin>", line 1, in <module>
   File 
"/home/synapse/env3/lib/python3.5/site-packages/twisted/python/log.py", 
line 20, in <module>
     from twisted.python import reflect
   File 
"/home/synapse/env3/lib/python3.5/site-packages/twisted/python/reflect.py", 
line 377, in <module>
     def _safeFormat(formatter: Union[types.FunctionType, Type[str]], o: 
object) -> str:
   File "/usr/lib/python3.5/typing.py", line 552, in __getitem__
     dict(self.__dict__), parameters, _root=True)
   File "/usr/lib/python3.5/typing.py", line 512, in __new__
     for t2 in all_params - {t1} if not isinstance(t2, TypeVar)):
   File "/usr/lib/python3.5/typing.py", line 512, in <genexpr>
     for t2 in all_params - {t1} if not isinstance(t2, TypeVar)):
   File "/usr/lib/python3.5/typing.py", line 1077, in __subclasscheck__
     if super().__subclasscheck__(cls):
   File "/usr/lib/python3.5/abc.py", line 225, in __subclasscheck__
     for scls in cls.__subclasses__():
TypeError: descriptor '__subclasses__' of 'type' object needs an argument


[1] Yes, yes, I know. I'm going to fix it real soon, I promise.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210221/4cf74b42/attachment.htm>

From richard at matrix.org  Sat Feb 20 17:50:46 2021
From: richard at matrix.org (Richard van der Hoff)
Date: Sun, 21 Feb 2021 00:50:46 +0000
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
 <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
Message-ID: <69b06bb2-33fd-82ec-7753-524616cbed73@matrix.org>

On 21/02/2021 00:31, Richard van der Hoff wrote:

> On 15/02/2021 02:53, Craig Rodrigues wrote:
>> It's time for another Twisted release!
>>
>> There are two major announcements for this release:
>>
>> - *Python 2.7 support has been dropped*.  Twisted 21.2.0 supports 
>> Python 3.5 and higher only
>> - *This will be the last Twisted release to support Python 3.5*.
>>
> Thanks Craig for getting this release ready.
>
> It looks like it is incompatible with Python 3.5.2: exception as 
> below. There's no real reason you should care about this, except that 
> it is (still!) what Ubuntu 16.04LTS ships with, and Ubuntu claim to 
> still be supporting 16.04 until April this year, so this might catch a 
> few people by surprise, as it did me[1]. Anyway, I suggest bumping 
> `python_requires` in `setup.cfg` 
> (https://github.com/twisted/twisted/blob/trunk/setup.cfg#L27), to stop 
> the new version being installed on systems where it won't work.
>
It also breaks compat with treq 20.4 and earlier. This may or may not be 
a thing you care about:

   File "/home/rav/work/synapse/synapse/http/client.py", line 33, in 
<module>
     import treq
   File 
"/home/rav/work/synapse/env3/lib/python3.8/site-packages/treq/__init__.py", 
line 5, in <module>
     from treq.api import head, get, post, put, patch, delete, request
   File 
"/home/rav/work/synapse/env3/lib/python3.8/site-packages/treq/api.py", 
line 5, in <module>
     from treq.client import HTTPClient
   File 
"/home/rav/work/synapse/env3/lib/python3.8/site-packages/treq/client.py", 
line 11, in <module>
     from twisted.python.compat import _PY3, unicode
ImportError: cannot import name '_PY3' from 'twisted.python.compat' 
(unknown location)


-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210221/e945f625/attachment.htm>

From rodrigc at crodrigues.org  Sat Feb 20 18:36:27 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sat, 20 Feb 2021 17:36:27 -0800
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
 <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
Message-ID: <CAG=rPVerO14Q+fwbck+nWZmMstonputdBsBbR9zWrUrstK9KpQ@mail.gmail.com>

On Sat, Feb 20, 2021 at 4:32 PM Richard van der Hoff <richard at matrix.org>
wrote:

> (env3)rav at faith:~$ python3
> Python 3.5.2 (default, Oct  7 2020, 17:19:02)
> [GCC 5.4.0 20160609] on linux
> Type "help", "copyright", "credits" or "license" for more information.
> >>> from twisted.python import log
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
>   File
> "/home/synapse/env3/lib/python3.5/site-packages/twisted/python/log.py",
> line 20, in <module>
>     from twisted.python import reflect
>   File
> "/home/synapse/env3/lib/python3.5/site-packages/twisted/python/reflect.py",
> line 377, in <module>
>     def _safeFormat(formatter: Union[types.FunctionType, Type[str]], o:
> object) -> str:
>   File "/usr/lib/python3.5/typing.py", line 552, in __getitem__
>     dict(self.__dict__), parameters, _root=True)
>   File "/usr/lib/python3.5/typing.py", line 512, in __new__
>     for t2 in all_params - {t1} if not isinstance(t2, TypeVar)):
>   File "/usr/lib/python3.5/typing.py", line 512, in <genexpr>
>     for t2 in all_params - {t1} if not isinstance(t2, TypeVar)):
>   File "/usr/lib/python3.5/typing.py", line 1077, in __subclasscheck__
>     if super().__subclasscheck__(cls):
>   File "/usr/lib/python3.5/abc.py", line 225, in __subclasscheck__
>     for scls in cls.__subclasses__():
> TypeError: descriptor '__subclasses__' of 'type' object needs an argument
>
>
>
Awww, this is unfortunate.
It looks like our CI on GitHub Actions is testing *Python 3.5.10*.

Over the past year, we have added a lot of type annotations to the
codebase, and it has
been a struggle to still keep things working with Python 3.5, but looks
like between Python 3.5.2 and 3.5.10
there were changes to Python in this area.


On Sat, Feb 20, 2021 at 4:50 PM Richard van der Hoff <richard at matrix.org>
wrote:

> It also breaks compat with treq 20.4 and earlier. This may or may not be a
> thing you care about:
>
>   File "/home/rav/work/synapse/synapse/http/client.py", line 33, in
> <module>
>     import treq
>   File
> "/home/rav/work/synapse/env3/lib/python3.8/site-packages/treq/__init__.py",
> line 5, in <module>
>     from treq.api import head, get, post, put, patch, delete, request
>   File
> "/home/rav/work/synapse/env3/lib/python3.8/site-packages/treq/api.py", line
> 5, in <module>
>     from treq.client import HTTPClient
>   File
> "/home/rav/work/synapse/env3/lib/python3.8/site-packages/treq/client.py",
> line 11, in <module>
>     from twisted.python.compat import _PY3, unicode
> ImportError: cannot import name '_PY3' from 'twisted.python.compat'
> (unknown location)
>

This has been fixed in newer versions of treq.   Since _PY3 is prefixed by
an underscore,
theoretically it should not be used outside of Twisted......that means
other subprojects of twisted which
are not twisted/twisted!

Well it looks like we are not 100% hiccup free when people upgrade, but
unfortunately, the show
must go on, and I guess people will have to pin to earlier versions of
Python, or upgrade their
code if they run into things like this.

Thank you very much for testing, and providing feedback!!
--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210220/312c23a8/attachment-0001.htm>

From trac at twistedmatrix.com  Sun Feb 21 00:05:18 2021
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 21 Feb 2021 07:05:18 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1613891118.04.2836433775342415265@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210221/6365a3e1/attachment.htm>

From richard at matrix.org  Mon Feb 22 06:24:24 2021
From: richard at matrix.org (Richard van der Hoff)
Date: Mon, 22 Feb 2021 13:24:24 +0000
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <CAG=rPVerO14Q+fwbck+nWZmMstonputdBsBbR9zWrUrstK9KpQ@mail.gmail.com>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
 <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
 <CAG=rPVerO14Q+fwbck+nWZmMstonputdBsBbR9zWrUrstK9KpQ@mail.gmail.com>
Message-ID: <1bb1a150-31e1-c848-16bb-dcd7ea05d809@matrix.org>

On 21/02/2021 01:36, Craig Rodrigues wrote:
>
> Awww, this is unfortunate.
> It looks like our CI on GitHub Actions is testing *Python 3.5.10*.
>
> Over the past year, we have added a lot of type annotations to the 
> codebase, and it has
> been a struggle to still keep things working with Python 3.5, but 
> looks like between Python 3.5.2 and 3.5.10
> there were changes to Python in this area.

As it happens, it also fails (for an import of typing.Deque) on Python 
3.5.3, as used by Debian oldstable.

Craig, what is your intention here? I think it's ok to drop support for 
these ancient versions of Python 3.5, but please could you make sure 
that python_requires gets set to 3.5.10 if that's what's been tested 
against?


-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210222/5f4fd4bd/attachment.htm>

From rodrigc at crodrigues.org  Thu Feb 25 20:03:18 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Thu, 25 Feb 2021 19:03:18 -0800
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <1bb1a150-31e1-c848-16bb-dcd7ea05d809@matrix.org>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
 <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
 <CAG=rPVerO14Q+fwbck+nWZmMstonputdBsBbR9zWrUrstK9KpQ@mail.gmail.com>
 <1bb1a150-31e1-c848-16bb-dcd7ea05d809@matrix.org>
Message-ID: <CAG=rPVdJceuh6or7fMm=c9efwPXnPG85RcvN1Yg=9pkVALFEKA@mail.gmail.com>

On Mon, Feb 22, 2021 at 5:30 AM Richard van der Hoff <richard at matrix.org>
wrote:

> As it happens, it also fails (for an import of typing.Deque) on Python
> 3.5.3, as used by Debian oldstable.
>
> Craig, what is your intention here? I think it's ok to drop support for
> these ancient versions of Python 3.5, but please could you make sure that
> python_requires gets set to 3.5.10 if that's what's been tested against?
>

Sigh.  I can confirm that typing.Deque does not import on Python 3.5.2.

I took an inventory of our CI, and realized that the minimum version we are
testing is *3.5.4* on Azure.

Can you review this which bumps the minimum version to Python 3.5.4:
https://github.com/twisted/twisted/pull/1525

Once I get that in, I will cherry pick it to the release branch and push
out the 21.2.0 release.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210225/ec467d21/attachment.htm>

From inhahe at gmail.com  Fri Feb 26 00:45:05 2021
From: inhahe at gmail.com (inhahe)
Date: Fri, 26 Feb 2021 02:45:05 -0500
Subject: [Twisted-Python] How to cycle through servers on Connection Fail in
 an IRC client?
Message-ID: <CAPeSgWrHJ+fno65aq2HDGtN8j176eiDd14sOXOOsAV8Hnm+ZYA@mail.gmail.com>

I'm making an IRC client  using Twisted, and I want to connect to a
different server when connection fails, but I haven't been able to figure
out how to do that..

Here's a more or less minimal code sample reflecting what I have now:

------------------------------------------------------------------------------------------------

from twisted.words.protocols import irc
from twisted.internet import protocol
from twisted.internet import reactor

class ServerConnection(irc.IRCClient):

  def __init__(self):
    self.signedon = False
    self.nickindex = 0

  def signedOn(self):
    print("signed on")

  def nickChanged(self, newnick):
    self.nickname = newnick

class Network(object):
  def __init__(self, servers, mynick=None):
    self.servers = servers
    self.mynick = mynick
    self.serverindex = 0

class ServerFactory(protocol.ReconnectingClientFactory):
  def __init__(self, nickname="qttwirc", password=None, username="qttwirc",
realname=None, network=None):
    self.network = network
    self.network.mynick = nickname
    self.nickname = nickname
    self.username = username
    self.password = password
    self.realname = realname
    protocol.ReconnectingClientFactory.initialDelay = 10 #should i leave
this at 1?
    protocol.ReconnectingClientFactory.maxDelay = 10 #no idea what value
this should be. 3.5 wasn't slow enough, i was being throttled.

  def buildProtocol(self, addr):
    p = ServerConnection()
    self.serverconnection = p
    p.server = self
    p.nickname = self.nickname
    p.username = self.username
    self.resetDelay()
    return p

  def clientConnectionLost(self, connector, reason):
    self.serverconnection = None
    protocol.ReconnectingClientFactory.clientConnectionLost(self,
connector, reason)

  def clientConnectionFailed(self, connector, reason):
    self.serverconnection = None
    addr, port = self.network.servers[self.network.serverindex]
    self.network.serverindex = (self.network.serverindex+1) %
len(self.network.servers) #todo: make it actually use these values

    #reactor.callLater(config.reconnectdelay, reactor.connectTCP,
addr.encode("ascii"), port, self)
    #reactor.connectTCP(addr, port, self) #is this feasible? i don't know a
better way to do this. connector.connect() apparently doesn't take
server/port as arguments.

    protocol.ReconnectingClientFactory.clientConnectionFailed(self,
connector, reason)

network = Network([("hitchcock.freenode.net", 6667), ("verne.freenode.net",
6667)])
server = ServerFactory(nickname="test123", username="test123",
network=network)
reactor.connectTCP(*network.servers[network.serverindex], server)
reactor.run()

------------------------------------------------------------------------------------------------

If I have to completely change the structure of how I connect, that's
fine.. I don't understand Twisted very well, so I'm not aware of what some
other options are for how to make an IRC client.

(It probably doesn't matter, but in my actual program I'm using both
Twisted and PyQt5 in the same run loop using qt5reactor..)

Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210226/44ab753d/attachment.htm>

From adi at roiban.ro  Sat Feb 27 18:11:25 2021
From: adi at roiban.ro (Adi Roiban)
Date: Sun, 28 Feb 2021 01:11:25 +0000
Subject: [Twisted-Python] Release instructions: `tox -e towncrier` does
 not work?
In-Reply-To: <CAG=rPVcPD6YuuhgYG92PeRzufSwp0KrjqtMi-BBGK3gdTH-8SQ@mail.gmail.com>
References: <CAG=rPVcPD6YuuhgYG92PeRzufSwp0KrjqtMi-BBGK3gdTH-8SQ@mail.gmail.com>
Message-ID: <CAFycZ9eCQyymFF5RTDy8uo2V4NavKrmibxFp13OvWLdO1gCKSA@mail.gmail.com>

Hi,

Sorry for the late reply.

Here is a patch  waiting for review
https://github.com/twisted/twisted/pull/1527

Cheers

On Mon, 15 Feb 2021 at 01:19, Craig Rodrigues <rodrigc at crodrigues.org>
wrote:

> In
> https://github.com/twisted/twisted/commit/0ad24679b168370bf0d695825170a7532bf0698f#diff-4fd162cb9fc2878b140dcc9d9d364f9f60d404a76ebda2c10518810ffe63852dL115
>
> Adi Roiban changed one of the steps the release documentation to run a
> command:
>
> *tox -e towncrier*
>
> but that tox target does not exist.
>
> Does Adi or someone else have that tox target in a patch lying
> around somewhere?
>
> For now I can manually run *towncrier *manually outside of tox.
>
> --
> Craig
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


-- 
Adi Roiban
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/3872c269/attachment.htm>

From rodrigc at crodrigues.org  Sat Feb 27 19:57:23 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sat, 27 Feb 2021 18:57:23 -0800
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate Announcement
In-Reply-To: <CAG=rPVdJceuh6or7fMm=c9efwPXnPG85RcvN1Yg=9pkVALFEKA@mail.gmail.com>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
 <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
 <CAG=rPVerO14Q+fwbck+nWZmMstonputdBsBbR9zWrUrstK9KpQ@mail.gmail.com>
 <1bb1a150-31e1-c848-16bb-dcd7ea05d809@matrix.org>
 <CAG=rPVdJceuh6or7fMm=c9efwPXnPG85RcvN1Yg=9pkVALFEKA@mail.gmail.com>
Message-ID: <CAG=rPVcbWPJ5HRFUTxJfox1PxuzF_o9sLA3wtFr6KubhGj6zxg@mail.gmail.com>

On Monday, February 15, 2021, Kyle Altendorf <sda at fstab.net> wrote:
>
>
> I went ahead and set pip_pre=true in pytest-twisted's tox.ini to try it
> out and got warnings/errors with PyPy 3.7 about use of t.i.d.returnValue
> claiming it should only be used in @inlineCallbacks decorated functions
> even though the location complained about is such. Only PyPy 3.7, not PyPy
> 3.6 nor CPython 3.7. Linux, macOS, and Windows all failed.
>
>
> Ticketed as https://twistedmatrix.com/trac/ticket/10093.
>
>
>
Thanks for providing the fix for this:

https://github.com/twisted/twisted/pull/1516

This fix will make it into the 21.2.0 release.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210227/e670fd1f/attachment.htm>

From rodrigc at crodrigues.org  Sat Feb 27 19:59:59 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sat, 27 Feb 2021 18:59:59 -0800
Subject: [Twisted-Python] Release instructions: `tox -e towncrier` does
 not work?
In-Reply-To: <CAFycZ9eCQyymFF5RTDy8uo2V4NavKrmibxFp13OvWLdO1gCKSA@mail.gmail.com>
References: <CAG=rPVcPD6YuuhgYG92PeRzufSwp0KrjqtMi-BBGK3gdTH-8SQ@mail.gmail.com>
 <CAFycZ9eCQyymFF5RTDy8uo2V4NavKrmibxFp13OvWLdO1gCKSA@mail.gmail.com>
Message-ID: <CAG=rPVeTHVZAQkWe7eH6o+oXzCGTt80ChormFMzDSDvBW0Ua2A@mail.gmail.com>

On Saturday, February 27, 2021, Adi Roiban <adi at roiban.ro> wrote:

> Hi,
>
> Sorry for the late reply.
>
> Here is a patch  waiting for review https://github.com/twisted/
> twisted/pull/1527
>
>

Thanks.  I have approved that.
That patch won't make it into the 21.2.0 release, but it is not a release
blocker since for now I can run towncrier manually.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210227/d04b01b3/attachment.htm>

From trac at twistedmatrix.com  Sun Feb 28 00:05:17 2021
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 28 Feb 2021 07:05:17 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1614495917.56.62439191452091058@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/b90d5ac9/attachment-0001.htm>

From rodrigc at crodrigues.org  Sun Feb 28 00:20:22 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sat, 27 Feb 2021 23:20:22 -0800
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
In-Reply-To: <CAFycZ9dBxjwMs1RzEsmCcfNGgv=kOx51OMfppm8dS45b_qHGuQ@mail.gmail.com>
References: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
 <CAG=rPVeta5Qq7XTWEb7PBxxZ=MpTwofjVGb4LzMSfHw8phgxWw@mail.gmail.com>
 <CAFycZ9cd6h4R4DT3ZD7GUs3Qy8nRGwE2uwr5eqYygSwvVoLUhQ@mail.gmail.com>
 <CAG=rPVcZ0oF=QpU+jdn45LuLEoLRHy8NfdTGAkpUdAsLrFx=oA@mail.gmail.com>
 <CAFycZ9dBxjwMs1RzEsmCcfNGgv=kOx51OMfppm8dS45b_qHGuQ@mail.gmail.com>
Message-ID: <CAG=rPVfxyZs642B0vOh70jR7uF5nV-n0zBThCkrCzQg+pjx_Ag@mail.gmail.com>

Thanks for the clarification.

You have provided a lot of useful details.  There are a lot of
interconnected pieces, with
multiple people working on different things.

For now, I am going to proceed to finish the release as-is.

The documentation may not be automatically deployed as part of the release,
but I think that can be done as a follow-on task.
--
Craig

On Sat, Feb 27, 2021 at 4:53 PM Adi Roiban <adiroiban at gmail.com> wrote:

> Hi,
>
> Sorry for the delay.
>
> We did the automation and Read The Docs hosting.
>
> In parallel there was also the work required to host the pydoctor API docs
> on Read The Docs.
>
> ----------
>
> Note that https://docs.twistedmatrix.com/en/twisted-20.3.0/api  404
>
> That should host the files from
> https://twistedmatrix.com/documents/current/api/
>
> ---------
>
> For `trunk` we have https://docs.twistedmatrix.com/en/latest/api/
>
> That was the hard work done by Maarten to improve pydoctor and Twisted API
> docs.
>
> -------------
>
> There was a plan to do a new pydoctor release over the end of the year
> break... but that never happened.
>
> The current PR that is "breaking" API links from narrative docs to API
> docs on Read The Docs version of Twisted docs is
> https://github.com/twisted/twisted/pull/1496
>
> But even before that PR the API docs on Read the Docs were broken, as we
> had too many HTML pages and the build process on RTD
> was interrupted.
>
> This is why I have approved the PR in the first place.
>
> So https://github.com/twisted/twisted/pull/1466 should also be reverted
>
> ------------
>
> So, if for this release the "official" Twisted documentation is to be
> hosted at https://twistedmatrix.com/documents/current/api/
> then https://twistedmatrix.com/trac/ticket/10068 is not a blocker.
>
> If the plan is to host the full and "official" Twisted documentation on
> Read The Docs, the https://twistedmatrix.com/trac/ticket/10068 is a
> blocker.
>
> And the easiest solution is to do a new pydoctor release.
>
> ----------
>
> I will try to follow up with Maarten over IRC to see if we can get a new
> pydoctor release.
>
> In theory, the pydoctor release process is automated and any other Twisted
> developer from https://github.com/orgs/twisted/teams/twisted-contributors
> could do a release.
>
> Maarten did the release work in the recent past but if he is busy, in
> theory anyone could step in and help with a new pydoctor release.
>
> Regards
>
> On Sat, 20 Feb 2021 at 17:47, Craig Rodrigues <rodrigc at crodrigues.org>
> wrote:
>
>> Hi,
>>
>> I am confused.  I thought that you and Thomas Graingert had completed all
>> the automation and had changed the Twisted release scripts to host the
>> documentation on readthedocs and that was all in place right now.
>>
>> Is that not the case?
>>
>> How much more work is necessary to completely host the next Twisted
>> release's docs on readthedocs?
>>
>> --
>> Craig
>>
>> On Saturday, February 20, 2021, Adi Roiban <adiroiban at gmail.com> wrote:
>>
>>> Hi,
>>>
>>> Sorry for the delay.
>>>
>>> This was added as a  blocker due to the changes from
>>> https://github.com/twisted/twisted/pull/1496 and the plan to use Read
>>> The Docs to
>>> host the official docs.
>>>
>>> This is not a blocker if the official documentation for this release
>>> will continue to be hosted on the Twisted own server at
>>> https://twistedmatrix.com/documents/current/
>>>
>>> It's a blocker only if the official documentation is to be hosted on
>>> Read The Docs at docs.twistedmatrix.com
>>>
>>> I have updated the ticket to no longer block the release.
>>>
>>> Cheers
>>>
>>>
>>> On Sat, 20 Feb 2021 at 02:08, Craig Rodrigues <rodrigc at crodrigues.org>
>>> wrote:
>>>
>>>> Adi,
>>>>
>>>> Is there anything to be done here, or is this still a release blocker?
>>>>
>>>> --
>>>> Craig
>>>>
>>>>
>>>> On Sun, Feb 14, 2021 at 4:15 PM Craig Rodrigues <rodrigc at crodrigues.org>
>>>> wrote:
>>>>
>>>>> Hi,
>>>>>
>>>>> This ticket: Use latest pydoctor release,
>>>>> https://twistedmatrix.com/trac/ticket/10068
>>>>>
>>>>> is marked as a release blocker.
>>>>>
>>>>> Has that been resolved or is there more work that needs to be done to
>>>>> fix that?
>>>>>
>>>>> --
>>>>> Craig
>>>>>
>>>>
>>>
>>> --
>>> Adi Roiban
>>>
>>
>
> --
> Adi Roiban
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210227/ed2b50bd/attachment.htm>

From rodrigc at crodrigues.org  Sun Feb 28 00:38:48 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sat, 27 Feb 2021 23:38:48 -0800
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <CAG=rPVdJceuh6or7fMm=c9efwPXnPG85RcvN1Yg=9pkVALFEKA@mail.gmail.com>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
 <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
 <CAG=rPVerO14Q+fwbck+nWZmMstonputdBsBbR9zWrUrstK9KpQ@mail.gmail.com>
 <1bb1a150-31e1-c848-16bb-dcd7ea05d809@matrix.org>
 <CAG=rPVdJceuh6or7fMm=c9efwPXnPG85RcvN1Yg=9pkVALFEKA@mail.gmail.com>
Message-ID: <CAG=rPVcR3PBGnvM1xSp53YL8_dUUnSc2Rg11vbRE9atusTTSeg@mail.gmail.com>

On Thu, Feb 25, 2021 at 7:03 PM Craig Rodrigues <rodrigc at crodrigues.org>
wrote:

>
>
> On Mon, Feb 22, 2021 at 5:30 AM Richard van der Hoff <richard at matrix.org>
> wrote:
>
>> As it happens, it also fails (for an import of typing.Deque) on Python
>> 3.5.3, as used by Debian oldstable.
>>
>> Craig, what is your intention here? I think it's ok to drop support for
>> these ancient versions of Python 3.5, but please could you make sure that
>> python_requires gets set to 3.5.10 if that's what's been tested against?
>>
>
> Sigh.  I can confirm that typing.Deque does not import on Python 3.5.2.
>
> I took an inventory of our CI, and realized that the minimum version we
> are testing is *3.5.4* on Azure.
>
> Can you review this which bumps the minimum version to Python 3.5.4:
> https://github.com/twisted/twisted/pull/1525
>
> Once I get that in, I will cherry pick it to the release branch and push
> out the 21.2.0 release.
>


Richard,

As you can see by this review comment:
https://github.com/twisted/twisted/pull/1525#issuecomment-786965737

Thomas Grainger and Adi Roiban have worked together to bump up the minimum
Python version to 3.5.3 for this
release ( https://github.com/twisted/twisted/pull/1524 ), and are not
approving the PR that I have submitted
in PR 1525.  Even though you approved PR 1525, I cannot merge it because
only PR reviews by people with
write access to the Twisted repo can be merged to the Twisted repo.

I am going to proceed with the release as-is with Python 3.5.3 as the
minimum version.  I hope that is OK for your needs.

--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210227/d5159a71/attachment.htm>

From rodrigc at crodrigues.org  Sun Feb 28 03:27:30 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sun, 28 Feb 2021 02:27:30 -0800
Subject: [Twisted-Python] Twisted 21.2.0 Release Announcement
Message-ID: <CAG=rPVd9XCmAziMZS7NOKffL1NJQ3tsqGf3hy1=pQ2S-FF7oYg@mail.gmail.com>

On behalf of Twisted Matrix Laboratories, I am honored to announce the
release of Twisted 21.2.0!

There are two major announcements for this release:

- *Python 2.7 support has been dropped*.  Twisted 21.2.0 supports Python
3.5.3 and higher only
- *This will be the last Twisted release to support Python 3.5*.

Twisted 21.2.0 brings the following:
- twist dns --pyzone now works on Python 3
- twisted.web.twcgi now works on Python 3
- all tests pass on all platforms on Python 3.8, including asyncio tests on
Windows
- tests pass on Python 3.9 (thanks to Michał Górny)
- type hints, as specified in PEP 484, are now used in functions throughout
the codebase
- mypy (static type checker) is now run over the codebase during CI to help
detect problems, and help improve the use of types
- code in is now formatted with Black (thanks to Tom Most)
- many CI and automation improvements (thanks to Adi Roiban and Thomas
Grainger)
- many more fixes (225 tickets closed!)


You can install by running this command:

      python -m pip install Twisted==21.2.0

The full tarball is available at:
    https://pypi.org/project/Twisted/21.2.0/#files

The full NEWS file with all changes is at:
    https://github.com/twisted/twisted/blob/twisted-21.2.0/NEWS.rst
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/4ea5b9a0/attachment-0001.htm>

From maarten at treewalker.org  Sun Feb 28 11:26:16 2021
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Sun, 28 Feb 2021 19:26:16 +0100
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
In-Reply-To: <CAG=rPVfxyZs642B0vOh70jR7uF5nV-n0zBThCkrCzQg+pjx_Ag@mail.gmail.com>
References: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
 <CAFycZ9dBxjwMs1RzEsmCcfNGgv=kOx51OMfppm8dS45b_qHGuQ@mail.gmail.com>
 <CAG=rPVfxyZs642B0vOh70jR7uF5nV-n0zBThCkrCzQg+pjx_Ag@mail.gmail.com>
Message-ID: <1656334.uIq7dFVtGe@hyperion>

On Sunday, 28 February 2021 08:20:22 CET Craig Rodrigues wrote:
> Thanks for the clarification.
> 
> You have provided a lot of useful details.  There are a lot of
> interconnected pieces, with
> multiple people working on different things.
> 
> For now, I am going to proceed to finish the release as-is.
> 
> The documentation may not be automatically deployed as part of the
> release, but I think that can be done as a follow-on task.

I'll try to get a pydoctor release out today from the current master 
branch. While the release publishing is automated, writing the release 
notes is not, but that shouldn't take too long.

There are some improvements in the works that aren't ready to merge yet 
but would improve Twisted's documentation, both in presentation (better 
navigation and presentation of types) and in accuracy (better handling 
of cyclic imports, which are becoming more common with the adoption of 
type annotations).

However, I think that it would be preferable to get new docs out as soon 
as possible, rather than waiting for even better docs. Once those 
improvements are integrated, we could do another pydoctor release and 
update Twisted's API docs without there being a new Twisted release.

Does this sound like a plan?

Bye,
		Maarten




From adi at roiban.ro  Sun Feb 28 13:42:16 2021
From: adi at roiban.ro (Adi Roiban)
Date: Sun, 28 Feb 2021 20:42:16 +0000
Subject: [Twisted-Python] Post Release updates
Message-ID: <CAFycZ9fkRXTdf-6yQQLD_Lnsspy0Zmts5xRLJNPZRqO8ksONaQ@mail.gmail.com>

Hi,

Happy to see a new version of Twisted released.
Thanks to anyone for making it happen.

---------

I think that https://github.com/twisted/twisted/pull/1514 should be merged
to finalize the release process.

------

And we have not yet decided if the trunk should be using `.dev` or .post` :(

https://twistedmatrix.com/trac/ticket/9542

I am +1 for .post1  ... as it has the semantic of a post release version.
while .dev0 is a pre-release.

----------

The https://twistedmatrix.com/documents/current/ documentation was not
updated.
But that can be solved after the release.
I will see if I can update it tonight... and I will check over IRC to see
if someone else has fixed it.
First, I am looking at the Read the docs release issues... it looks like
things are not as automated as we though :D

-------------

I have no idea why the latest tag is not visible on Read the docs
https://readthedocs.org/projects/twisted/versions/

I have manually activated it based on the f1daeeee tag.
I went to
https://readthedocs.org/projects/twisted/versions/?version_filter=twisted-21.2.0
and then clicked "Activate"

Then I went to https://readthedocs.org/dashboard/twisted/advanced/ and
select it as "Default" version
and then click "Save"

Then I went to https://readthedocs.org/projects/twisted/builds/ to check
the status of the new build.

I see that we now have - https://docs.twistedmatrix.com/en/twisted-21.2.0/

But https://docs.twistedmatrix.com/en/stable/ is still an older build :(

I have no idea why... looks like stable is not active and what is
origin/8690

[image: image.png]

Maybe Read The Docs is confused by `twisted-21.2.0` as it doesn't look like
a semantic version .

----------

Stable was building for
https://github.com/twisted/twisted/commit/99137f53a8a6bd1d8bffa5202373236162daf94e

See RTD stable build
https://readthedocs.org/projects/twisted/builds/13125823/

So I have wiped the stable version and now it gets 404.

I (or someone else from the team) will have check with Read The Docs team
to see why we have this issue with the stable version.

----------

And there are a lot of versions as we have many branches on Twisted.

I guess that at least the branches that were merged, could be removed from
the main repo.
I don't see the value for keeping them alive,

That is all for now.
-- 
Adi Roiban
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/1894fc5c/attachment.htm>

From maarten at treewalker.org  Sun Feb 28 13:53:53 2021
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Sun, 28 Feb 2021 21:53:53 +0100
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
In-Reply-To: <1656334.uIq7dFVtGe@hyperion>
References: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
 <CAG=rPVfxyZs642B0vOh70jR7uF5nV-n0zBThCkrCzQg+pjx_Ag@mail.gmail.com>
 <1656334.uIq7dFVtGe@hyperion>
Message-ID: <4520431.8lmzTv552D@hyperion>

On Sunday, 28 February 2021 19:26:16 CET I wrote:

> I'll try to get a pydoctor release out today from the current master
> branch. While the release publishing is automated, writing the release
> notes is not, but that shouldn't take too long.

pydoctor 21.2.0 is now available on PyPI:
https://pypi.org/project/pydoctor

Bye,
		Maarten




From rodrigc at crodrigues.org  Sun Feb 28 14:02:48 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sun, 28 Feb 2021 13:02:48 -0800
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
In-Reply-To: <1656334.uIq7dFVtGe@hyperion>
References: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
 <CAFycZ9dBxjwMs1RzEsmCcfNGgv=kOx51OMfppm8dS45b_qHGuQ@mail.gmail.com>
 <CAG=rPVfxyZs642B0vOh70jR7uF5nV-n0zBThCkrCzQg+pjx_Ag@mail.gmail.com>
 <1656334.uIq7dFVtGe@hyperion>
Message-ID: <CAG=rPVe8=zo7ama0wjP+StcVmxxt+mpECbU9FoCYiEWjcZ-owQ@mail.gmail.com>

That sounds like a good plan.  Thanks for working on this.

Keep in mind the points regarding docs raised by Glyph here:


https://twistedmatrix.com/pipermail/twisted-python/2021-February/065432.html

--
Craig


On Sunday, February 28, 2021, Maarten ter Huurne <maarten at treewalker.org>
wrote:
>
>
> However, I think that it would be preferable to get new docs out as soon
> as possible, rather than waiting for even better docs. Once those
> improvements are integrated, we could do another pydoctor release and
> update Twisted's API docs without there being a new Twisted release.
>
> Does this sound like a plan?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/60bd5ebc/attachment.htm>

From adi at roiban.ro  Sun Feb 28 14:16:39 2021
From: adi at roiban.ro (Adi Roiban)
Date: Sun, 28 Feb 2021 21:16:39 +0000
Subject: [Twisted-Python] Post Release updates
In-Reply-To: <CAFycZ9fkRXTdf-6yQQLD_Lnsspy0Zmts5xRLJNPZRqO8ksONaQ@mail.gmail.com>
References: <CAFycZ9fkRXTdf-6yQQLD_Lnsspy0Zmts5xRLJNPZRqO8ksONaQ@mail.gmail.com>
Message-ID: <CAFycZ9dUT1rPyXjFBot3-rAG0VpL+k8qbGBkuV1oYDdq8VpoEw@mail.gmail.com>

Another thing that is missing from Read The Docs to get feature parity with
current documentation.

If I go to https://docs.twistedmatrix.com/en/twisted-18.4.0/ I don't get
any warning that I am not on the latest stable version.

RTD has something similar... but not quite what we need
[image: image.png]
But I hope that  we can find a way to fix it... but first we need to fix
the "stable" version in RTD


Cheers

On Sun, 28 Feb 2021 at 20:42, Adi Roiban <adi at roiban.ro> wrote:

> Hi,
>
> Happy to see a new version of Twisted released.
> Thanks to anyone for making it happen.
>
> ---------
>
> I think that https://github.com/twisted/twisted/pull/1514 should be
> merged to finalize the release process.
>
> ------
>
> And we have not yet decided if the trunk should be using `.dev` or .post`
> :(
>
> https://twistedmatrix.com/trac/ticket/9542
>
> I am +1 for .post1  ... as it has the semantic of a post release version.
> while .dev0 is a pre-release.
>
> ----------
>
> The https://twistedmatrix.com/documents/current/ documentation was not
> updated.
> But that can be solved after the release.
> I will see if I can update it tonight... and I will check over IRC to see
> if someone else has fixed it.
> First, I am looking at the Read the docs release issues... it looks like
> things are not as automated as we though :D
>
> -------------
>
> I have no idea why the latest tag is not visible on Read the docs
> https://readthedocs.org/projects/twisted/versions/
>
> I have manually activated it based on the f1daeeee tag.
> I went to
> https://readthedocs.org/projects/twisted/versions/?version_filter=twisted-21.2.0
> and then clicked "Activate"
>
> Then I went to https://readthedocs.org/dashboard/twisted/advanced/ and
> select it as "Default" version
> and then click "Save"
>
> Then I went to https://readthedocs.org/projects/twisted/builds/ to check
> the status of the new build.
>
> I see that we now have - https://docs.twistedmatrix.com/en/twisted-21.2.0/
>
> But https://docs.twistedmatrix.com/en/stable/ is still an older build :(
>
> I have no idea why... looks like stable is not active and what is
> origin/8690
>
> [image: image.png]
>
> Maybe Read The Docs is confused by `twisted-21.2.0` as it doesn't look
> like a semantic version .
>
> ----------
>
> Stable was building for
>
> https://github.com/twisted/twisted/commit/99137f53a8a6bd1d8bffa5202373236162daf94e
>
> See RTD stable build
> https://readthedocs.org/projects/twisted/builds/13125823/
>
> So I have wiped the stable version and now it gets 404.
>
> I (or someone else from the team) will have check with Read The Docs team
> to see why we have this issue with the stable version.
>
> ----------
>
> And there are a lot of versions as we have many branches on Twisted.
>
> I guess that at least the branches that were merged, could be removed from
> the main repo.
> I don't see the value for keeping them alive,
>
> That is all for now.
> --
> Adi Roiban
>


-- 
Adi Roiban
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/a58cb315/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 49779 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20210228/a58cb315/attachment-0001.png>

From richard at matrix.org  Sun Feb 28 14:28:04 2021
From: richard at matrix.org (Richard van der Hoff)
Date: Sun, 28 Feb 2021 21:28:04 +0000
Subject: [Twisted-Python] Twisted 21.2.0rc1 Release Candidate
 Announcement
In-Reply-To: <CAG=rPVcR3PBGnvM1xSp53YL8_dUUnSc2Rg11vbRE9atusTTSeg@mail.gmail.com>
References: <CAG=rPVerk2h9PXJFn2A=waKB-KzHaaDkkBNcA-F9KW3AJ_ueew@mail.gmail.com>
 <afc37b18-979d-0806-04d8-f4132ad9613c@matrix.org>
 <CAG=rPVerO14Q+fwbck+nWZmMstonputdBsBbR9zWrUrstK9KpQ@mail.gmail.com>
 <1bb1a150-31e1-c848-16bb-dcd7ea05d809@matrix.org>
 <CAG=rPVdJceuh6or7fMm=c9efwPXnPG85RcvN1Yg=9pkVALFEKA@mail.gmail.com>
 <CAG=rPVcR3PBGnvM1xSp53YL8_dUUnSc2Rg11vbRE9atusTTSeg@mail.gmail.com>
Message-ID: <6c7c3565-18c4-0b90-c118-2ce961585de0@matrix.org>

On 28/02/2021 07:38, Craig Rodrigues wrote:
>
> Thomas Grainger and Adi Roiban have worked together to bump up the 
> minimum Python version to 3.5.3 for this
> release ( https://github.com/twisted/twisted/pull/1524 ), and are not 
> approving the PR that I have submitted
> in PR 1525.  Even though you approved PR 1525, I cannot merge it 
> because only PR reviews by people with
> write access to the Twisted repo can be merged to the Twisted repo.
>
> I am going to proceed with the release as-is with Python 3.5.3 as the 
> minimum version.  I hope that is OK for your needs.
>
It looks to me like https://github.com/twisted/twisted/pull/1524 sets 
the minimum python version to 3.5.4, so I think we're good and #1525 
should just be closed as a duplicate.

Thanks for getting the release out!


-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/3dcf9651/attachment.htm>

From adi at roiban.ro  Sun Feb 28 14:39:12 2021
From: adi at roiban.ro (Adi Roiban)
Date: Sun, 28 Feb 2021 21:39:12 +0000
Subject: [Twisted-Python] Post Release updates
In-Reply-To: <CAFycZ9dUT1rPyXjFBot3-rAG0VpL+k8qbGBkuV1oYDdq8VpoEw@mail.gmail.com>
References: <CAFycZ9fkRXTdf-6yQQLD_Lnsspy0Zmts5xRLJNPZRqO8ksONaQ@mail.gmail.com>
 <CAFycZ9dUT1rPyXjFBot3-rAG0VpL+k8qbGBkuV1oYDdq8VpoEw@mail.gmail.com>
Message-ID: <CAFycZ9dRGd0E5bsNbp9QGfABg-qONybZDhzd2OtRUFbk--6n0g@mail.gmail.com>

Hi,

https://twistedmatrix.com/documents/current/ is now updated.

It will continue to be the "official" documentation link for this release.

We can add a redirection after getting RTD version up to the same
features... maybe for the next release.

Regards


On Sun, 28 Feb 2021 at 21:16, Adi Roiban <adi at roiban.ro> wrote:

> Another thing that is missing from Read The Docs to get feature parity
> with current documentation.
>
> If I go to https://docs.twistedmatrix.com/en/twisted-18.4.0/ I don't get
> any warning that I am not on the latest stable version.
>
> RTD has something similar... but not quite what we need
> [image: image.png]
> But I hope that  we can find a way to fix it... but first we need to fix
> the "stable" version in RTD
>
>
> Cheers
>
> On Sun, 28 Feb 2021 at 20:42, Adi Roiban <adi at roiban.ro> wrote:
>
>> Hi,
>>
>> Happy to see a new version of Twisted released.
>> Thanks to anyone for making it happen.
>>
>> ---------
>>
>> I think that https://github.com/twisted/twisted/pull/1514 should be
>> merged to finalize the release process.
>>
>> ------
>>
>> And we have not yet decided if the trunk should be using `.dev` or .post`
>> :(
>>
>> https://twistedmatrix.com/trac/ticket/9542
>>
>> I am +1 for .post1  ... as it has the semantic of a post release version.
>> while .dev0 is a pre-release.
>>
>> ----------
>>
>> The https://twistedmatrix.com/documents/current/ documentation was not
>> updated.
>> But that can be solved after the release.
>> I will see if I can update it tonight... and I will check over IRC to see
>> if someone else has fixed it.
>> First, I am looking at the Read the docs release issues... it looks like
>> things are not as automated as we though :D
>>
>> -------------
>>
>> I have no idea why the latest tag is not visible on Read the docs
>> https://readthedocs.org/projects/twisted/versions/
>>
>> I have manually activated it based on the f1daeeee tag.
>> I went to
>> https://readthedocs.org/projects/twisted/versions/?version_filter=twisted-21.2.0
>> and then clicked "Activate"
>>
>> Then I went to https://readthedocs.org/dashboard/twisted/advanced/ and
>> select it as "Default" version
>> and then click "Save"
>>
>> Then I went to https://readthedocs.org/projects/twisted/builds/ to check
>> the status of the new build.
>>
>> I see that we now have -
>> https://docs.twistedmatrix.com/en/twisted-21.2.0/
>>
>> But https://docs.twistedmatrix.com/en/stable/ is still an older build :(
>>
>> I have no idea why... looks like stable is not active and what is
>> origin/8690
>>
>> [image: image.png]
>>
>> Maybe Read The Docs is confused by `twisted-21.2.0` as it doesn't look
>> like a semantic version .
>>
>> ----------
>>
>> Stable was building for
>>
>> https://github.com/twisted/twisted/commit/99137f53a8a6bd1d8bffa5202373236162daf94e
>>
>> See RTD stable build
>> https://readthedocs.org/projects/twisted/builds/13125823/
>>
>> So I have wiped the stable version and now it gets 404.
>>
>> I (or someone else from the team) will have check with Read The Docs team
>> to see why we have this issue with the stable version.
>>
>> ----------
>>
>> And there are a lot of versions as we have many branches on Twisted.
>>
>> I guess that at least the branches that were merged, could be removed
>> from the main repo.
>> I don't see the value for keeping them alive,
>>
>> That is all for now.
>> --
>> Adi Roiban
>>
>
>
> --
> Adi Roiban
>


-- 
Adi Roiban
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/cb80df18/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 49779 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20210228/cb80df18/attachment-0001.png>

From maarten at treewalker.org  Sun Feb 28 14:50:27 2021
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Sun, 28 Feb 2021 22:50:27 +0100
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
In-Reply-To: <CAG=rPVe8=zo7ama0wjP+StcVmxxt+mpECbU9FoCYiEWjcZ-owQ@mail.gmail.com>
References: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
 <1656334.uIq7dFVtGe@hyperion>
 <CAG=rPVe8=zo7ama0wjP+StcVmxxt+mpECbU9FoCYiEWjcZ-owQ@mail.gmail.com>
Message-ID: <3800548.6F0kUd2T4m@hyperion>

On Sunday, 28 February 2021 22:02:48 CET Craig Rodrigues wrote:
> That sounds like a good plan.  Thanks for working on this.
> 
> Keep in mind the points regarding docs raised by Glyph here:
> 
> 
> https://twistedmatrix.com/pipermail/twisted-python/2021-February/06543
> 2.html

Those are good points, but I meant API docs specifically and I don't 
think there should be any overlap between the wiki and the API docs. If 
I'm mistaken, please let me know.

Bye,
		Maarten

> --
> Craig
> 
> 
> On Sunday, February 28, 2021, Maarten ter Huurne
> <maarten at treewalker.org>
> wrote:
> > However, I think that it would be preferable to get new docs out as
> > soon as possible, rather than waiting for even better docs. Once
> > those improvements are integrated, we could do another pydoctor
> > release and update Twisted's API docs without there being a new
> > Twisted release.
> > 
> > Does this sound like a plan?




From adi at roiban.ro  Sun Feb 28 14:54:24 2021
From: adi at roiban.ro (Adi Roiban)
Date: Sun, 28 Feb 2021 21:54:24 +0000
Subject: [Twisted-Python] Twisted 21.2.0 Release Announcement
In-Reply-To: <CAG=rPVd9XCmAziMZS7NOKffL1NJQ3tsqGf3hy1=pQ2S-FF7oYg@mail.gmail.com>
References: <CAG=rPVd9XCmAziMZS7NOKffL1NJQ3tsqGf3hy1=pQ2S-FF7oYg@mail.gmail.com>
Message-ID: <CAFycZ9ew0D4_neB07X0riwiqT0CBm6TUi-wAiXOaKJfFxYt+Zg@mail.gmail.com>

On Sun, 28 Feb 2021 at 10:28, Craig Rodrigues <rodrigc at crodrigues.org>
wrote:

> On behalf of Twisted Matrix Laboratories, I am honored to announce the
> release of Twisted 21.2.0!
>
> There are two major announcements for this release:
>
> - *Python 2.7 support has been dropped*.  Twisted 21.2.0 supports Python
> 3.5.3 and higher only
> - *This will be the last Twisted release to support Python 3.5*.
>
> Twisted 21.2.0 brings the following:
> - twist dns --pyzone now works on Python 3
> - twisted.web.twcgi now works on Python 3
> - all tests pass on all platforms on Python 3.8, including asyncio tests
> on Windows
> - tests pass on Python 3.9 (thanks to Michał Górny)
> - type hints, as specified in PEP 484, are now used in functions
> throughout the codebase
> - mypy (static type checker) is now run over the codebase during CI to
> help detect problems, and help improve the use of types
> - code in is now formatted with Black (thanks to Tom Most)
> - many CI and automation improvements (thanks to Adi Roiban and Thomas
> Grainger)
> - many more fixes (225 tickets closed!)
>
>
> You can install by running this command:
>
>       python -m pip install Twisted==21.2.0
>
> The full tarball is available at:
>     https://pypi.org/project/Twisted/21.2.0/#files
>
> The full NEWS file with all changes is at:
>     https://github.com/twisted/twisted/blob/twisted-21.2.0/NEWS.rst
>
>
Hi,

Thanks Craig for managing this release.

Happy to finally see a brand new release.

Sad to see Py2.7 go... but this is life... all good things have an end :p

Looking forward to also removing Py3.5 :)

Cheers

-- 
Adi Roiban
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/d1706bf6/attachment.htm>

From rodrigc at crodrigues.org  Sun Feb 28 15:04:49 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sun, 28 Feb 2021 14:04:49 -0800
Subject: [Twisted-Python] Release blocker: Use latest pydoctor release ?
In-Reply-To: <3800548.6F0kUd2T4m@hyperion>
References: <CAG=rPVfvN-ffDeB8F8FeKk+oQ5wOpwMFiZaXHb=FvVcPcnvcMg@mail.gmail.com>
 <1656334.uIq7dFVtGe@hyperion>
 <CAG=rPVe8=zo7ama0wjP+StcVmxxt+mpECbU9FoCYiEWjcZ-owQ@mail.gmail.com>
 <3800548.6F0kUd2T4m@hyperion>
Message-ID: <CAG=rPVfVz-qR5JRh5KY2h_iFdMht_wLbCgzf4xWxAjSf+gnkFQ@mail.gmail.com>

On Sun, Feb 28, 2021 at 1:50 PM Maarten ter Huurne <maarten at treewalker.org>
wrote:

> On Sunday, 28 February 2021 22:02:48 CET Craig Rodrigues wrote:
> > That sounds like a good plan.  Thanks for working on this.
> >
> > Keep in mind the points regarding docs raised by Glyph here:
> >
> >
> > https://twistedmatrix.com/pipermail/twisted-python/2021-February/06543
> > 2.html
>
> Those are good points, but I meant API docs specifically and I don't
> think there should be any overlap between the wiki and the API docs. If
> I'm mistaken, please let me know.
>
>
I think the direction that Glyph was mentioning is that if there are
docs in the source tree, and duplicated docs on the wiki, we want to favor
the docs
in the source tree.  Any duplicated docs on the wiki should either be
deleted, or changed to put
pointers to the docs in the source tree.

With respect to API docs, I am not as familiar with the whole process, with
how they are generated
and what are doing with readthedocs vs. docs on twistedmatrix.com.
API docs are generated and don't live in the source tree.

For example: https://twistedmatrix.com/documents/current/api/twisted.html

Is the long term direction to get rid of that, and point everything at
readthedocs?

Since you have done a lot of work in this area, can you shed some light on
what you think the future direction of all this stuff should
be with respect to the API docs?

Thanks.
--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/b9d1adc8/attachment.htm>

From rodrigc at crodrigues.org  Sun Feb 28 22:04:34 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sun, 28 Feb 2021 21:04:34 -0800
Subject: [Twisted-Python] Twisted 21.2.0 Release Announcement
In-Reply-To: <CAFycZ9ew0D4_neB07X0riwiqT0CBm6TUi-wAiXOaKJfFxYt+Zg@mail.gmail.com>
References: <CAG=rPVd9XCmAziMZS7NOKffL1NJQ3tsqGf3hy1=pQ2S-FF7oYg@mail.gmail.com>
 <CAFycZ9ew0D4_neB07X0riwiqT0CBm6TUi-wAiXOaKJfFxYt+Zg@mail.gmail.com>
Message-ID: <CAG=rPVddqZAPX+RbO6BdRgYy8G+qC4LA3pmY23xiMj-NdzTUkA@mail.gmail.com>

On Sun, Feb 28, 2021 at 1:55 PM Adi Roiban <adi at roiban.ro> wrote:

>
>
>
> Hi,
>
> Thanks Craig for managing this release.
>


You are welcome Adi!

I am happy to contribute my efforts to the Twisted community and to push
the project along.

In 2015-2016, unfortunately I lost my job.  While in between jobs, I
contributed a lot to the effort
to port Twisted to Python 3.  It was a very enjoyable experience, and I
learned a lot of Python at the time. :)

I joined the Python 2 porting party late, and there were others who
invested a lot of time and effort into it.
Amber did a heck of a lot of work before me on Python 3 porting, and did a
lot of work after I contributed.
I don't remember who else contributed, but there were a lot of folks
including you, Jean-   , Glyph, and others.

The earliest Python 3 ticket I can find in the Trac is this one from 14
years ago filed by Itamar!!

https://twistedmatrix.com/trac/ticket/2484

Honestly, at the time, when I was working on Python 3 porting in 2016, I
wasn't even sure that Twisted
would survive as a project beyond Python 2.

So it is nice to see that Python 2.7 is history, and the Twisted codebase
is incorporating new language
features, types, etc. and is keeping up with newer Python versions.

Hurray!
--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/e20580f5/attachment.htm>

From rodrigc at crodrigues.org  Sun Feb 28 22:17:59 2021
From: rodrigc at crodrigues.org (Craig Rodrigues)
Date: Sun, 28 Feb 2021 21:17:59 -0800
Subject: [Twisted-Python] Post Release updates
In-Reply-To: <CAFycZ9fkRXTdf-6yQQLD_Lnsspy0Zmts5xRLJNPZRqO8ksONaQ@mail.gmail.com>
References: <CAFycZ9fkRXTdf-6yQQLD_Lnsspy0Zmts5xRLJNPZRqO8ksONaQ@mail.gmail.com>
Message-ID: <CAG=rPVdY_eGN5MxsmJwBtt0oShDX6UCNb=nBX_gr+GatPhto=g@mail.gmail.com>

On Sun, Feb 28, 2021 at 12:43 PM Adi Roiban <adi at roiban.ro> wrote:

>
> And we have not yet decided if the trunk should be using `.dev` or .post`
> :(
>
>
According to the Twisted release process, one of the last things I need to
do is bump the Twisted version:
https://github.com/twisted/twisted/blob/trunk/docs/core/development/policy/release-process.rst#post-release

I did not do that yet, for the very reason which you brought up.
I think the instructions for bumping to `dev` are not correct, as per my
interpretation of PEP440.

I asked Glyph for clarification here:
https://github.com/twisted/twisted/pull/1514#issuecomment-787533582

If you or anyone else has good knowledge on PEP440, and what the correct
thing to do here is,
feel free to add feedback in that PR!
--
Craig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20210228/534a8eac/attachment-0001.htm>

