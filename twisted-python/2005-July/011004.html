<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] threadedselectreactor - shutting down the	foreign event loop
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20threadedselectreactor%20-%20shutting%20down%20the%0A%09foreign%20event%20loop&In-Reply-To=1B4260BA-FD53-44C7-926B-9E0ED67A694C%40redivi.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011003.html">
   <LINK REL="Next"  HREF="011005.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] threadedselectreactor - shutting down the	foreign event loop</H1>
    <B>Toby Dickenson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20threadedselectreactor%20-%20shutting%20down%20the%0A%09foreign%20event%20loop&In-Reply-To=1B4260BA-FD53-44C7-926B-9E0ED67A694C%40redivi.com"
       TITLE="[Twisted-Python] threadedselectreactor - shutting down the	foreign event loop">tdickenson at devmail.geminidataloggers.co.uk
       </A><BR>
    <I>Mon Jul 18 08:41:15 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011003.html">[Twisted-Python] threadedselectreactor - shutting down the	foreign event loop
</A></li>
        <LI>Next message: <A HREF="011005.html">[Twisted-Python] High Level Twisted Question [Multiple Protocol	Usage]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11004">[ date ]</a>
              <a href="thread.html#11004">[ thread ]</a>
              <a href="subject.html#11004">[ subject ]</a>
              <a href="author.html#11004">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>(resend)

On Monday 18 July 2005 11:43, Bob Ippolito wrote:
&gt;<i> On Jul 17, 2005, at 11:54 PM, Toby Dickenson wrote:
</I>
&gt;<i> &gt; a. Calling reactor.stop() when there is a GUI shutdown request,
</I>&gt;<i> &gt; b. Using reactor.addSystemEventTrigger to shut down the foreign  
</I>&gt;<i> &gt; event loop
</I>&gt;<i> &gt; after reactor shutdown.
</I>&gt;<i> 
</I>&gt;<i> This is currently the only supported and recommended way.
</I>
Thanks for that clear statement.

&gt;<i> It's possible, I guess, use a proxy for the waker function that uses  
</I>&gt;<i> a thread lock so that you can reliably swap out the real waker at the  
</I>&gt;<i> right time.  However, you must somehow acquire that lock before your  
</I>&gt;<i> foreign event loop has shut down (which is of the same level of  
</I>&gt;<i> invasiveness as the recommended solution!) so that it will block the  
</I>&gt;<i> proxy call until a new waker is installed.  In the finally clause,  
</I>&gt;<i> you'd install a new trivial waker (the apply function would work) and  
</I>&gt;<i> release that lock so that any pending calls would complete.
</I>
Yes, that is much neater.

My 'trigger' waker function is already queueing requests (it is used for more 
than just twisted integration) so I dont need to replace the waker - rather 
my finally clause needs to contain a new mini event loop that continues to 
processing my queue until the reactor is fully closed. As far as 
threadedselectreactor is concerned this looks no different to my normal event 
loop.

Thanks again,

-- 
Toby Dickenson


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011003.html">[Twisted-Python] threadedselectreactor - shutting down the	foreign event loop
</A></li>
	<LI>Next message: <A HREF="011005.html">[Twisted-Python] High Level Twisted Question [Multiple Protocol	Usage]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11004">[ date ]</a>
              <a href="thread.html#11004">[ thread ]</a>
              <a href="subject.html#11004">[ subject ]</a>
              <a href="author.html#11004">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
