<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted communication with embedded C thread
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20communication%20with%20embedded%20C%20thread&In-Reply-To=1120759332.8139.44.camel%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010926.html">
   <LINK REL="Next"  HREF="010927.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted communication with embedded C thread</H1>
    <B>Tom Cocagne</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20communication%20with%20embedded%20C%20thread&In-Reply-To=1120759332.8139.44.camel%40localhost.localdomain"
       TITLE="[Twisted-Python] Twisted communication with embedded C thread">tom.cocagne at gmail.com
       </A><BR>
    <I>Thu Jul  7 16:18:35 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010926.html">[Twisted-Python] Twisted communication with embedded C thread
</A></li>
        <LI>Next message: <A HREF="010927.html">[Twisted-Python] Twisted communication with embedded C thread
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10931">[ date ]</a>
              <a href="thread.html#10931">[ thread ]</a>
              <a href="subject.html#10931">[ subject ]</a>
              <a href="author.html#10931">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>    Thanks for the quick response guys. 

    A bit more of a description of what I'm working on may help.
Basically, I'm working on building a coordination library for use in
programs taking part in a distributed simulation. The simulations
themselves are written primarily in C++, run on a bunch of different
platforms, and are often optomized to use the specific hardware
they're running on top of (C-threads locked to specific CPUs, arcane
compiler flags, the whole shebang). The Python/Twisted side handles
all the high-level coordination stuff while the C++ code focuses on
numerics.

    As the library is supposed to be as generic as possible, I can't
make too many assumptions about how threading will be handled in any
particular application. So to keep things simple I'm creating a single
thread that is dedicated to running the Python interpreter and
allowing only that thread to touch the interpreter.

    I looked into the code for reactor.callFromThread that y'all
mentioned and it looks like the implementation for it exactly answers
the question I've been trying to ask. On posix systems the reactor's
'waker' is implemented as a pair of pipes and on Win32 systems it's
implemented as a pair of sockets. So it appears that my original
approach will work except that on Win32 systems I'll just have to use
a socket rather than a pipe.

    Thanks for the help,

    Tom

    BTW Itamar, I took a look at the SmartFrog/Coil documentation you
sent out yesterday and it looks very promising. Do you have any sort
of roadmap/timeline for Coil?

On 7/7/05, Itamar Shtull-Trauring &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">itamar at itamarst.org</A>&gt; wrote:
&gt;<i> On Thu, 2005-07-07 at 13:48 -0400, Tom Cocagne wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;     I was wondering if anyone has suggestions for a good way to go
</I>&gt;<i> &gt; about setting up a message-passing communication channel between one
</I>&gt;<i> &gt; or more C threads and a single thread dedicated to running
</I>&gt;<i> &gt; Python/Twisted. I already have functional Python bindings accessing
</I>&gt;<i> &gt; the contents of the messages (basically C structures) but need some
</I>&gt;<i> &gt; way to exchange the messages between the C threads and the Python
</I>&gt;<i> &gt; thread.
</I>&gt;<i> 
</I>&gt;<i> Any reason you're using threads? You can run Twisted directly on the
</I>&gt;<i> glib event loop, so your whole program could run on the same loop.
</I>&gt;<i> 
</I>&gt;<i> In any case, Switching data from Twisted to C is just like passing data
</I>&gt;<i> from any Python program to C code: call a C extension function from
</I>&gt;<i> Python that calls into C code, and for reverse call a Python function
</I>&gt;<i> from C code. Thread safety is mostly orthogonal, so you can probably use
</I>&gt;<i> the standard Twisted reactor.callFromThread to have code run in the
</I>&gt;<i> Twisted thread.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010926.html">[Twisted-Python] Twisted communication with embedded C thread
</A></li>
	<LI>Next message: <A HREF="010927.html">[Twisted-Python] Twisted communication with embedded C thread
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10931">[ date ]</a>
              <a href="thread.html#10931">[ thread ]</a>
              <a href="subject.html#10931">[ subject ]</a>
              <a href="author.html#10931">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
