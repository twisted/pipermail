<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Errors after upgrading to 2.0.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Errors%20after%20upgrading%20to%202.0.1&In-Reply-To=%3C1f060c4c0507302252592797d5%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043568.html">
   <LINK REL="Next"  HREF="043570.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Errors after upgrading to 2.0.1</H1>
    <B>snacktime</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Errors%20after%20upgrading%20to%202.0.1&In-Reply-To=%3C1f060c4c0507302252592797d5%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Errors after upgrading to 2.0.1">snacktime at gmail.com
       </A><BR>
    <I>Sat Jul 30 23:52:27 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043568.html">[Twisted-Python] why insecureJelly
</A></li>
        <LI>Next message (by thread): <A HREF="043570.html">[Twisted-Python] Errors after upgrading to 2.0.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43569">[ date ]</a>
              <a href="thread.html#43569">[ thread ]</a>
              <a href="subject.html#43569">[ subject ]</a>
              <a href="author.html#43569">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm testing out an application I wrote in 1.3.  In 2.0.1 I get a
warning and an exception.

The UserWarning about SSL I looked up on the list and I understand why
it's there, although I think it's a bad idea.  The warning is about a
bug in pyopenssl that hasn't been fixed in pyopenssl.  In addition
there is no reason to think it will ever be fixed after being ignored
for this long.  Maybe someone could find a better solution for this
warning other then leaving it to end user to find the patch on the
mailing list, which for all I know might not even work at this point. 
 Maybe put up a patched copy of pyopenssl on twistedmatrix.com?  Seems
better than having an unmaintained dependancy in twisted.

The exception I really have no clue about, maybe someone could point
out where the problem is?

Code:
----------------------------------------
#!/usr/local/bin/python
from OpenSSL import SSL
import sys
import time

from twisted.internet.protocol import ClientFactory
from twisted.protocols.basic import LineReceiver
from twisted.internet import ssl, reactor
from curses.ascii import STX,ETX,FS

STX =  chr(STX)
ETX =  chr(ETX)
FS =  chr(FS)


class EchoClient(LineReceiver):
    end=&quot;GoodBye&quot;
    def connectionMade(self):
        transaction = self.factory.trans
        self.sendLine(&quot;%s&quot; % transaction)

    def connectionLost(self, reason):
        #print 'connection lost (protocol)'
        reactor.stop()

    def lineReceived(self, line):
        print &quot;receive:&quot;, line
        self.transport.loseConnection()

class EchoClientFactory(ClientFactory):
    protocol = EchoClient

    def clientConnectionFailed(self, connector, reason):
        print 'connection failed:', reason.getErrorMessage()
        reactor.stop()

    def clientConnectionLost(self, connector, reason):
        #print 'connection lost:', reason.getErrorMessage()
        reactor.stop()

    def SetTransaction(self,id,a,b,c,d,e,f,g,h,i,j,k,l):
      self.trans = STX + id + FS + a + FS + b + FS + c + FS + d + FS +
e + FS + f + FS + g + FS + h + FS + i + FS + j + FS + k + FS + l + ETX

    def GetTransaction(self):
      return self.trans

def main():
    factory = EchoClientFactory()
    factory.SetTransaction('id1','vital','VERIFY','poi2','4111111111111111','05','12','100','123
abc street','98034','','','id1')
    reactor.connectSSL('localhost', 8000, factory, ssl.ClientContextFactory())
    reactor.run()


if __name__ == '__main__':
    main()
-----------------------------------------------------------


Output:
-------------------------------------------------
receive: id1:APPROVED::TRANSACTION PRESENT:::0000123456789
/usr/local/lib/python2.4/site-packages/twisted/internet/tcp.py:216:
UserWarning: SSL connection shutdown possibly unreliable, please
upgrade to ver 0.XX
  &quot;please upgrade to ver 0.XX&quot;, category=UserWarning)
Traceback (most recent call last):
  File &quot;./error&quot;, line 55, in ?
    main()
  File &quot;./error&quot;, line 51, in main
    reactor.run()
  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/posixbase.py&quot;,
line 199, in run
    self.mainLoop()
  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/posixbase.py&quot;,
line 207, in mainLoop
    self.runUntilCurrent()
--- &lt;exception caught here&gt; ---
  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/base.py&quot;,
line 533, in runUntilCurrent
    call.func(*call.args, **call.kw)
  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/base.py&quot;,
line 389, in _continueSystemEvent
    for callList in sysEvtTriggers[1], sysEvtTriggers[2]:
exceptions.TypeError: unsubscriptable object


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043568.html">[Twisted-Python] why insecureJelly
</A></li>
	<LI>Next message (by thread): <A HREF="043570.html">[Twisted-Python] Errors after upgrading to 2.0.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43569">[ date ]</a>
              <a href="thread.html#43569">[ thread ]</a>
              <a href="subject.html#43569">[ subject ]</a>
              <a href="author.html#43569">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
