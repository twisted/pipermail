<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Trouble with example imap client on	unread	messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Trouble%20with%20example%20imap%20client%20on%0A%09unread%09messages&In-Reply-To=20050708103632.fketq9hm9u88o44o%40itchy.wasabout.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010935.html">
   <LINK REL="Next"  HREF="010937.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Trouble with example imap client on	unread	messages</H1>
    <B>Andy Gayton</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Trouble%20with%20example%20imap%20client%20on%0A%09unread%09messages&In-Reply-To=20050708103632.fketq9hm9u88o44o%40itchy.wasabout.net"
       TITLE="[Twisted-Python] Trouble with example imap client on	unread	messages">andy at thecablelounge.com
       </A><BR>
    <I>Fri Jul  8 07:51:19 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010935.html">[Twisted-Python] Trouble with example imap client on unread	messages 
</A></li>
        <LI>Next message: <A HREF="010937.html">[Twisted-Python] Could not create and run a Windows Service with	Twisted 2.0.1 &amp; Python 2.4.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10936">[ date ]</a>
              <a href="thread.html#10936">[ thread ]</a>
              <a href="subject.html#10936">[ subject ]</a>
              <a href="author.html#10936">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Quoting Andy Gayton &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">andy at thecablelounge.com</A>&gt;:
</I>&gt;&gt;<i> proto.fetchSpecific('1:*',
</I>&gt;&gt;<i>     headerType='HEADER.FIELDS',
</I>&gt;&gt;<i>     headerArgs=['SUBJECT']
</I>
Thomas HERVE wrote:
&gt;<i> The problem I see is here : why does the server had this line ? It 
</I>&gt;<i> doesn't seem
</I>&gt;<i> to be an answer, but more the consequence of the fetch (which mark 
</I>&gt;<i> messages as
</I>&gt;<i> seen). This message should appeared *after* fetch called... Maybe 
</I>&gt;<i> Bincimap is
</I>&gt;<i> too fast :).
</I>&gt;<i> 
</I>&gt;<i> You could try this instead (which don't mark message seen) :
</I>&gt;<i> 
</I>&gt;<i> proto.fetchSpecific('1:*',
</I>&gt;<i>     headerType='HEADER.FIELDS',
</I>&gt;<i>     headerArgs=['SUBJECT'],
</I>&gt;<i>        peek=True
</I>&gt;<i> )
</I>
Thanks Thomas, this workaround does work.  I'm sure there's going to be 
trouble down the track when I need my actions to change the state of the 
messages, but it at least confirms what you and Anders observed.

Anders wrote:
&gt;<i> This is bad, RFC-3501 says:
</I>&gt;<i>    A client MUST be prepared to accept any server response at all times.
</I>&gt;<i>    This includes server data that was not requested.  Server data SHOULD
</I>&gt;<i>    be recorded, so that the client can reference its recorded copy
</I>&gt;<i>    rather than sending a command to the server to request the data.  In
</I>&gt;<i>    the case of certain server data, the data MUST be recorded.
</I>&gt;<i> 
</I>&gt;<i> so I'd say twisted's IMAP-client is broken.
</I>
I agree with Anders.  But man, what a bitch to handle :)

Actually this reminds me of a reply to an excellent intro to twisted 
clients thread which featured an imap client:

<A HREF="http://twistedmatrix.com/pipermail/twisted-python/2004-May/007781.html">http://twistedmatrix.com/pipermail/twisted-python/2004-May/007781.html</A>

Ideally I guess the message's subject should be passed to the callback, 
as expected, and a method call should be triggered for the change in the 
messages status.

I've raised a bug for it: <A HREF="http://twistedmatrix.com/bugs/issue1105">http://twistedmatrix.com/bugs/issue1105</A>

Hope this is ok ..

cheers,
Andy.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010935.html">[Twisted-Python] Trouble with example imap client on unread	messages 
</A></li>
	<LI>Next message: <A HREF="010937.html">[Twisted-Python] Could not create and run a Windows Service with	Twisted 2.0.1 &amp; Python 2.4.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10936">[ date ]</a>
              <a href="thread.html#10936">[ thread ]</a>
              <a href="subject.html#10936">[ subject ]</a>
              <a href="author.html#10936">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
