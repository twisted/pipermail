<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] IOCP and CANCELLED asynchronous I/O operation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20IOCP%20and%20CANCELLED%20asynchronous%20I/O%20operation&In-Reply-To=%3C94a776e705071810525c32e1c0%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043518.html">
   <LINK REL="Next"  HREF="043516.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] IOCP and CANCELLED asynchronous I/O operation</H1>
    <B>Justin Johnson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20IOCP%20and%20CANCELLED%20asynchronous%20I/O%20operation&In-Reply-To=%3C94a776e705071810525c32e1c0%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] IOCP and CANCELLED asynchronous I/O operation">justinjohnson at gmail.com
       </A><BR>
    <I>Mon Jul 18 11:52:13 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043518.html">[Twisted-Python] High Level Twisted Question [Multiple Protocol	Usage]
</A></li>
        <LI>Next message (by thread): <A HREF="043516.html">[Twisted-Python] XMPP/Jabber server using Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43515">[ date ]</a>
              <a href="thread.html#43515">[ thread ]</a>
              <a href="subject.html#43515">[ subject ]</a>
              <a href="author.html#43515">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am wondering if someone would be willing to assist me in debugging a 
problem I'm experiencing with my current attempt at an implementation of 
spawnProcess for the IOCP proactor.
 A patch with my implementation can be found at 
<A HREF="http://twistedmatrix.com/bugs/issue1008">http://twistedmatrix.com/bugs/issue1008</A> along with comments and a log file 
describing my problem.
 The problem occurs sporadically when running 
twisted.test.test_process.ProcessTestCase.testProcesstwisted.test.test_process. 
First I create 3 pipes that will be used to write to the child process's 
stdin and read its stdout and stderr. Then I initiate a read on all 3 pipes. 
The reads makes sense for stdout and stderr. The stdin pipe is created in 
duplex mode and the read attempt on it from the parent is only there so we 
can detect when the child closes its end of the pipe so the parent can close 
its end as well.
 The problem is that occasionally (often, but not consistently) the read 
operations on stdin (and sometimes stderr) seem to not run at all and 
FileMon reports their status as CANCELLED when I get to the end of the 
program. If I run trial run through pdb and step through it, the result of 
CANCELLED for these 1 or 2 (if stderr fails as well) reads doesn't appear 
until the very end of the program. The callbacks (ReadInOp.ovDone and 
ReadErrOp.ovDone don't get called for either of these when the failure 
occurs, so FileMon's results seem to accurately reflect what is happening. 
However, from my print statements it is clear that the reads are initiated (
ReadInOp.initiateOp and ReadErrOp.initiateOp).
 The closest thing I can find to a description of what CANCELLED might mean 
is at <A HREF="http://www.cs.princeton.edu/~appel/smlnj/basis/posix-error.html">http://www.cs.princeton.edu/~appel/smlnj/basis/posix-error.html</A> which 
says it indicates that the associated asynchronous operation was cancelled 
before completion. This sounds correct, but doesn't help illuminate *why* 
this is happening.
 Does anyone have any suggestions as to why this is happening?
 Thanks in advance.
Justin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20050718/ca6d9e4d/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043518.html">[Twisted-Python] High Level Twisted Question [Multiple Protocol	Usage]
</A></li>
	<LI>Next message (by thread): <A HREF="043516.html">[Twisted-Python] XMPP/Jabber server using Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43515">[ date ]</a>
              <a href="thread.html#43515">[ thread ]</a>
              <a href="subject.html#43515">[ subject ]</a>
              <a href="author.html#43515">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
