<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Understanding the IOCP reactor and adding	spawnProcess
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Understanding%20the%20IOCP%20reactor%20and%20adding%0A%09spawnProcess&In-Reply-To=%3C20050711163455.26278.1912863786.divmod.quotient.9475%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043470.html">
   <LINK REL="Next"  HREF="043472.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Understanding the IOCP reactor and adding	spawnProcess</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Understanding%20the%20IOCP%20reactor%20and%20adding%0A%09spawnProcess&In-Reply-To=%3C20050711163455.26278.1912863786.divmod.quotient.9475%40ohm%3E"
       TITLE="[Twisted-Python] Understanding the IOCP reactor and adding	spawnProcess">exarkun at divmod.com
       </A><BR>
    <I>Mon Jul 11 10:34:55 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043470.html">[Twisted-Python] Understanding the IOCP reactor and adding	spawnProcess
</A></li>
        <LI>Next message (by thread): <A HREF="043472.html">[Twisted-Python] Understanding the IOCP reactor and adding	spawnProcess
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43471">[ date ]</a>
              <a href="thread.html#43471">[ thread ]</a>
              <a href="subject.html#43471">[ subject ]</a>
              <a href="author.html#43471">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 11 Jul 2005 10:52:14 -0500, Justin Johnson &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">justinjohnson at gmail.com</A>&gt; wrote:
&gt;<i>I am attempting to add spawnProcess to iocpreactor. In order to begin this
</I>&gt;<i>task I've had to do a lot of reading on Windows network programming,
</I>&gt;<i>specifically the various Windows I/O methods, to attempt to understand what
</I>&gt;<i>win32eventreactor and iocpreactor are doing, and also just increase my
</I>&gt;<i>understanding of how reactors work in general. To understand the various
</I>&gt;<i>Winsock 2 methods that both of these reactors rely upon, I read chapters 1-5
</I>&gt;<i>of Network Programming for Microsoft Windows[1].
</I>&gt;<i> Before actually attempting to add spawnProcess, I would like to present how
</I>&gt;<i>I think iocpreactor works and how I think I should add spawnProcess, and
</I>&gt;<i>hopefully be corrected or confirmed in my understanding. If I'm too vague
</I>&gt;<i>there's a good chance it's because I don't understand it very well. Please
</I>&gt;<i>feel free to point out things that you might think are obvious but aren't
</I>&gt;<i>sure I understand.
</I>&gt;<i> How iocpreactor works
</I>&gt;<i>---------------------------------
</I>&gt;<i>
</I>&gt;<i> [snip]
</I>&gt;<i>
</I>&gt;<i>  How to add spawnProcess
</I>&gt;<i>---------------------------------------
</I>&gt;<i>
</I>&gt;<i>   1. Create the processes via Windows APIs and associate their
</I>&gt;<i>   stdout/err with with the IOCP via CreateIoCompletionPort calls.
</I>&gt;<i>   2. Close stdin.
</I>
Why close stdin?  How will you write to the spawned process?

&gt;<i>   3. Notify the ProcessProtocol via protocol.makeConnection (not sure
</I>&gt;<i>   why, looking at win32eventreactor)
</I>
makeConnection is the method that's actually part of IProtocol (even though ProcessProtocol doesn't implement IProtocol, it still adheres to its API in this regard).  Generally, all it does is set the .transport attribute on the protocol instance and then call connectionMade.  This might seem pointless in the case of processes, but since it maintains consistency with other kinds of transports, it is useful.

&gt;<i>   4. Receive data from stdout/err via the completion port by calling
</I>&gt;<i>   GetQueuedCompletionStatus from within doIteration. Is this really possible?
</I>&gt;<i>   ProcessProtocol's methods won't get called appropriately by letting the
</I>&gt;<i>   existing callbacks in ops.py make calls to the transport (e.g.
</I>&gt;<i>   connectionDone, readDone)?
</I>&gt;<i>
</I>&gt;<i>  Thanks for your help.
</I>&gt;<i>Justin
</I>&gt;<i> [1] <A HREF="http://www.amazon.com/exec/obidos/ASIN/0735615799">http://www.amazon.com/exec/obidos/ASIN/0735615799</A>
</I>&gt;<i>
</I>
Jp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043470.html">[Twisted-Python] Understanding the IOCP reactor and adding	spawnProcess
</A></li>
	<LI>Next message (by thread): <A HREF="043472.html">[Twisted-Python] Understanding the IOCP reactor and adding	spawnProcess
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43471">[ date ]</a>
              <a href="thread.html#43471">[ thread ]</a>
              <a href="subject.html#43471">[ subject ]</a>
              <a href="author.html#43471">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
