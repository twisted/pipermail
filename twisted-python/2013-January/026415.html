<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Must avatarId always be a string?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Must%20avatarId%20always%20be%20a%20string%3F&In-Reply-To=6395EDED-528D-40E1-BCBC-73912E0EC62C%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026408.html">
   <LINK REL="Next"  HREF="026416.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Must avatarId always be a string?</H1>
    <B>Adi Roiban</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Must%20avatarId%20always%20be%20a%20string%3F&In-Reply-To=6395EDED-528D-40E1-BCBC-73912E0EC62C%40twistedmatrix.com"
       TITLE="[Twisted-Python] Must avatarId always be a string?">adi at roiban.ro
       </A><BR>
    <I>Wed Jan  9 17:27:04 EST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026408.html">[Twisted-Python] Must avatarId always be a string?
</A></li>
        <LI>Next message: <A HREF="026416.html">[Twisted-Python] Must avatarId always be a string?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26415">[ date ]</a>
              <a href="thread.html#26415">[ thread ]</a>
              <a href="subject.html#26415">[ subject ]</a>
              <a href="author.html#26415">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9 January 2013 20:02, Glyph &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:
&gt;<i> On Jan 9, 2013, at 9:26 AM, Peter Westlake &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">peter.westlake at pobox.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> I am not an expert in Twisted, but from my understanding, the &quot;string&quot;
</I>&gt;<i> requirement is there to provide a plugable interface. So that you can
</I>&gt;<i> have generic credentials checkers, working with generic realms.
</I>&gt;<i> Having simple &quot;strings&quot; could also help with AvatarId serialization,
</I>&gt;<i> in case you have the CredentialsChecker on one computer and the you
</I>&gt;<i> will pass them over network/socket to a remote Realm.
</I>
[snip]

&gt;<i> I hope it's clear that just hard-coding your avatars and realms to work only
</I>&gt;<i> with each other is a sub-optimal solution :).
</I>
It is very clear :)

&gt;<i> The architecture of cred is supposed to be that you can plug realms and
</I>&gt;<i> checkers together so that a change to your authentication backend doesn't
</I>&gt;<i> completely change your application.  Of course, that architecture is flawed
</I>&gt;<i> in the sense that a string is a bit too narrow of a communication channel to
</I>&gt;<i> get information about the authenticated user from one to the other,
</I>&gt;<i> especially in cases where the application needs information from a directory
</I>&gt;<i> service to function.
</I>&gt;<i>
</I>&gt;<i> If you're interested in an improved, official way to deal with this
</I>&gt;<i> use-case, the best way to do that would be to get involved and actively try
</I>&gt;<i> to specify what you need.  I've got similar use-cases at work, as you can
</I>&gt;<i> see here:
</I>&gt;<i> &lt;<A HREF="http://trac.calendarserver.org/browser/CalendarServer/trunk/twistedcaldav/directory/idirectory.py">http://trac.calendarserver.org/browser/CalendarServer/trunk/twistedcaldav/directory/idirectory.py</A>&gt;
</I>&gt;<i> so I'd be happy to talk to you about some ideas.
</I>&gt;<i>
</I>&gt;<i> The best way to predict the future is to invent it. :)
</I>
My AvatarID Object is just for data.

Let me describe one of my usage/requirement:

I have a portal with credentialsChecker for both OS accounts and
application specific accounts.
One can have user &quot;john&quot; both as a local account and/or an application account.
If my credentialsChecker returns only 'john', the Realm will not know
from where to get user's home folder, so the returned AvatarID needs
to signal the &quot;source&quot; of avatarID login so that it can use the same
source for getting account configuration.

I know that a solution is to have unique ID across all system, but in
my case, this is not possible, and I have a priority list.

I can encode the source in the avatar id like: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">john at os</A> or
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">john at application</A>, but I don't see why this is better than ('john',
'os') / ('john', 'application')

----

A formal description would be:

There are N authentication services and for each authentication
service, there is an associated account configuration service.
When an account is allowed by authentication service X, the server
will retrieve account configuration from the configuration service X.

-----

Another use case:

I have user X with password Y. If user X is authenticated from local
LAN it gets avatar Z, otherwise it gets avatar W.

Here a simple AvatarID is not enough, since I also need to pass the
remote peer from the transport.


I keep a reference to remote peer in the Avatar. Doing this I don't
need to always pass the transport, and just use the avatar. I do this
to keep track of &quot;sessions&quot; in logs.

-----

Since I don't know much about Twisted, this might be just bad
design/architecture and there is some way of doing this while still
using a simple avatarid.

----

I am not sure I fully understood the idirectory.py example, but rather
than verifying credentials for each resource, I prefer to validate the
credentials once (do one authentication) and then have a different
authorization process.

In some cases the credentialsChecker can do authentication and
authorization in the same step.
In my usage, the credentialsChecker only does autentication, and then
an initial authorization is done in the realm.

-----

I can discuss this in private, write a wiki page or add more details,
if required.

Thanks!
-- 
Adi Roiban

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026408.html">[Twisted-Python] Must avatarId always be a string?
</A></li>
	<LI>Next message: <A HREF="026416.html">[Twisted-Python] Must avatarId always be a string?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26415">[ date ]</a>
              <a href="thread.html#26415">[ thread ]</a>
              <a href="subject.html#26415">[ subject ]</a>
              <a href="author.html#26415">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
