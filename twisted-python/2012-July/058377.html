<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Password hash for Perspective Brokers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Password%20hash%20for%20Perspective%20Brokers&In-Reply-To=%3C50115411.2070906%40gresille.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="058376.html">
   <LINK REL="Next"  HREF="058384.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Password hash for Perspective Brokers</H1>
    <B>Louis</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Password%20hash%20for%20Perspective%20Brokers&In-Reply-To=%3C50115411.2070906%40gresille.org%3E"
       TITLE="[Twisted-Python] Password hash for Perspective Brokers">spalax at gresille.org
       </A><BR>
    <I>Thu Jul 26 08:28:33 MDT 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="058376.html">[Twisted-Python] stopping a twistd daemon: SIGTERM or SIGKILL
</A></li>
        <LI>Next message (by thread): <A HREF="058384.html">[Twisted-Python] Password hash for Perspective Brokers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58377">[ date ]</a>
              <a href="thread.html#58377">[ thread ]</a>
              <a href="subject.html#58377">[ subject ]</a>
              <a href="author.html#58377">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>	Hello
	I have a problem with checkers in Twisted, which could be solved by
adding a new feature. I think I can write the necessary code, but before
doing so, I would like to hear you about it.

# The problem

	If I am right, the only way passwords can be hashed when using
authentication with perspective brokers is using MD5 [1]. However, there
are two flaws with it.

* First, MD5 is no longer considered sure. It may be possible, from the
hashed password, to find the original one.
* Second, in the current implementation of Twisted, no salt is used to
hash the password. A salt is considered good practise : it is harder to
find the password from the hashed form, and two identical passwords have
different hashed form, which prevent someone looking at the hashed
passwords to see if two users have the same password.

# A solution

	I tried to implement the solution proposed in [1], and I think I can
manage to do it. However, this seems to be a not-so-smart hack, which is
not guaranteed to work in future releases of Twisted. That is why I am
proposing a patch.

	The patch would introduce some arguments to class PBServerFactory [2]
to use (or not) a salt, and a different hash function. I am not settled
down yet about the new signature of this class, but what is sure is that
the default must be the actual behaviour, not to break programs already
using Twisted. Then, I hesitate between

* two arguments (salt, hash) : salt is a boolean, telling whether to use
a salt or not ; hash is the function used to hash the password;

* one argument, with possible values being &quot;legacy&quot;, &quot;crypt&quot; or &quot;glib2&quot;,
where:

** &quot;legacy&quot;: current behaviour : hashed passwords are md5 hashed
passwords without salt;
** &quot;crypt&quot; : crypt [3] behaviour (I would like it to be compatible with
[4]): hashed passwords are strings where the first two characters are
the salt, and the following ones are the hashed password (using this salt);
** &quot;glib2&quot; : glib2 [5] behaviour: hashed password is of the form
$ID$SALT$HASH, where ID identifies the encryption method, SALT being the
salt, and HASH being the password, hashed using given encryption method
and salt.

# My implementation

	I have not implemented it yet, but I you think my idea is good, I offer
to write it. I think I have understood well enough the relevant pieces
of code to do so. Of course, I would also write the corresponding tests.


	Some ideas or comments ?
	Cheers,
	Louis


[1] <A HREF="http://markmail.org/message/wlzmeesplsriym2a">http://markmail.org/message/wlzmeesplsriym2a</A>
[2]
<A HREF="http://twistedmatrix.com/documents/current/api/twisted.spread.pb.PBServerFactory.html">http://twistedmatrix.com/documents/current/api/twisted.spread.pb.PBServerFactory.html</A>
[3] <A HREF="http://man7.org/linux/man-pages/man3/crypt.3.html">http://man7.org/linux/man-pages/man3/crypt.3.html</A>
[4] <A HREF="http://www.giuseppetanzilli.it/mod_auth_pgsql2/#encrypted">http://www.giuseppetanzilli.it/mod_auth_pgsql2/#encrypted</A>
[5] <A HREF="http://www.gnu.org/software/libc/manual/html_node/crypt.html#crypt">http://www.gnu.org/software/libc/manual/html_node/crypt.html#crypt</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="058376.html">[Twisted-Python] stopping a twistd daemon: SIGTERM or SIGKILL
</A></li>
	<LI>Next message (by thread): <A HREF="058384.html">[Twisted-Python] Password hash for Perspective Brokers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58377">[ date ]</a>
              <a href="thread.html#58377">[ thread ]</a>
              <a href="subject.html#58377">[ subject ]</a>
              <a href="author.html#58377">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
