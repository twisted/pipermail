<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] finding out what's blocking the reactor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20finding%20out%20what%27s%20blocking%20the%20reactor&In-Reply-To=%3Cc63ad7cc-e792-98aa-d404-aa8f9b5c9c29%40withers.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="064775.html">
   <LINK REL="Next"  HREF="064772.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] finding out what's blocking the reactor</H1>
    <B>Chris Withers</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20finding%20out%20what%27s%20blocking%20the%20reactor&In-Reply-To=%3Cc63ad7cc-e792-98aa-d404-aa8f9b5c9c29%40withers.org%3E"
       TITLE="[Twisted-Python] finding out what's blocking the reactor">chris at withers.org
       </A><BR>
    <I>Tue May 14 23:27:30 MDT 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="064775.html">[Twisted-Python] finding out what's blocking the reactor
</A></li>
        <LI>Next message (by thread): <A HREF="064772.html">[Twisted-Python] finding out what's blocking the reactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64770">[ date ]</a>
              <a href="thread.html#64770">[ thread ]</a>
              <a href="subject.html#64770">[ subject ]</a>
              <a href="author.html#64770">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14/05/2019 16:39, Scott, Barry wrote:
&gt;<i> On Monday, 13 May 2019 15:26:01 BST Chris Withers wrote:
</I>&gt;&gt;<i> Hi All,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On some busy instances of the app I'm working with/on, we see websocket
</I>&gt;&gt;<i> connections being dropped due to not ping/ponging in time, I'm fairly
</I>&gt;&gt;<i> sure this is as a result of some user-written callbacks blocking the
</I>&gt;&gt;<i> reactor for long periods of time (seconds...).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What's the best way to debug a twisted application to find out what's
</I>&gt;&gt;<i> blocking the reactor?
</I>&gt;<i> 
</I>&gt;<i> Is the process CPU bound or IO bound?
</I>
Yes ;-)

&gt;<i> If CPU bound then cprofile or the tool Glyph mentioned would help.
</I>&gt;<i> 
</I>&gt;<i> This advice is from a Linux perspective.
</I>&gt;<i> 
</I>&gt;<i> If its IO bound the you may be waiting on a blocking operation.
</I>&gt;<i> You could use strace on the process to see what its doing.
</I>
Good call on strace, will do so next time one of these happens.

&gt;<i> As its hung for seconds you could connect gdb to the process and see a python
</I>&gt;<i> backtrace using the py-bt command. You are likely to catch the offending code.
</I>
I'm failing miserably to get gdb to find debug symbols for python. I've 
installed the system python's debug symbols rpm, I've installed gdb .py 
that ships in the python source tree (so at least I *have* a py-bt 
command now!) - what am I likely to be missing?

&gt;<i> You could adding logging to your code to show the time of callback entry and
</I>&gt;<i> exit.
</I>
Right, but if the callback yields, that will be falsely shown as 
blocking, no?

cheers,

Chris


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="064775.html">[Twisted-Python] finding out what's blocking the reactor
</A></li>
	<LI>Next message (by thread): <A HREF="064772.html">[Twisted-Python] finding out what's blocking the reactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64770">[ date ]</a>
              <a href="thread.html#64770">[ thread ]</a>
              <a href="subject.html#64770">[ subject ]</a>
              <a href="author.html#64770">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
