<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] finding out what's blocking the reactor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20finding%20out%20what%27s%20blocking%20the%20reactor&In-Reply-To=%3C5127710.BgWIjmJy6L%40barry-scott-desktop%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="064765.html">
   <LINK REL="Next"  HREF="064767.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] finding out what's blocking the reactor</H1>
    <B>Scott, Barry</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20finding%20out%20what%27s%20blocking%20the%20reactor&In-Reply-To=%3C5127710.BgWIjmJy6L%40barry-scott-desktop%3E"
       TITLE="[Twisted-Python] finding out what's blocking the reactor">barry.scott at forcepoint.com
       </A><BR>
    <I>Tue May 14 09:39:24 MDT 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="064765.html">[Twisted-Python] finding out what's blocking the reactor
</A></li>
        <LI>Next message (by thread): <A HREF="064767.html">[Twisted-Python] finding out what's blocking the reactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64766">[ date ]</a>
              <a href="thread.html#64766">[ thread ]</a>
              <a href="subject.html#64766">[ subject ]</a>
              <a href="author.html#64766">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Monday, 13 May 2019 15:26:01 BST Chris Withers wrote:
&gt;<i> Hi All,
</I>&gt;<i> 
</I>&gt;<i> On some busy instances of the app I'm working with/on, we see websocket
</I>&gt;<i> connections being dropped due to not ping/ponging in time, I'm fairly
</I>&gt;<i> sure this is as a result of some user-written callbacks blocking the
</I>&gt;<i> reactor for long periods of time (seconds...).
</I>&gt;<i> 
</I>&gt;<i> What's the best way to debug a twisted application to find out what's
</I>&gt;<i> blocking the reactor?
</I>
Is the process CPU bound or IO bound?

If CPU bound then cprofile or the tool Glyph mentioned would help.

This advice is from a Linux perspective.

If its IO bound the you may be waiting on a blocking operation.
You could use strace on the process to see what its doing.

As its hung for seconds you could connect gdb to the process and see a python 
backtrace using the py-bt command. You are likely to catch the offending code.

The normal bt command will show you what the last python command it calling.

You could adding logging to your code to show the time of callback entry and 
exit.

If all else fails patch the twisted code to time callbacks and report the slow 
ones.

Barry

&gt;<i> 
</I>&gt;<i> cheers,
</I>&gt;<i> 
</I>&gt;<i> Chris
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="064765.html">[Twisted-Python] finding out what's blocking the reactor
</A></li>
	<LI>Next message (by thread): <A HREF="064767.html">[Twisted-Python] finding out what's blocking the reactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64766">[ date ]</a>
              <a href="thread.html#64766">[ thread ]</a>
              <a href="subject.html#64766">[ subject ]</a>
              <a href="author.html#64766">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
