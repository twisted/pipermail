<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Sending large files over network with	perspective broker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Sending%20large%20files%20over%20network%20with%0A%09perspective%20broker&In-Reply-To=AANLkTikURkhafcdK0oKdsyeVoYn1lwp1u5MTAbwHFONi%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022245.html">
   <LINK REL="Next"  HREF="022249.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Sending large files over network with	perspective broker</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Sending%20large%20files%20over%20network%20with%0A%09perspective%20broker&In-Reply-To=AANLkTikURkhafcdK0oKdsyeVoYn1lwp1u5MTAbwHFONi%40mail.gmail.com"
       TITLE="[Twisted-Python] Sending large files over network with	perspective broker">glyph at twistedmatrix.com
       </A><BR>
    <I>Sun May 23 21:16:34 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="022245.html">[Twisted-Python] Sending large files over network with	perspective broker
</A></li>
        <LI>Next message: <A HREF="022249.html">[Twisted-Python] Sending large files over network with	perspective broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22246">[ date ]</a>
              <a href="thread.html#22246">[ thread ]</a>
              <a href="subject.html#22246">[ subject ]</a>
              <a href="author.html#22246">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On May 23, 2010, at 6:36 PM, Gabriele Lanaro wrote:

&gt;<i> In which sense it's invalid? I don't know how the gtk reactor works, I just guessed that the event loop never reaches the gui events. My idea was to force the processing of these events before spawning another deferred, it's just a workaround, the real problem is  the fact that the server and the client resides in  the same loop (for testing).
</I>
It's invalid to run reactor.iterate() inside the reactor mainloop.  You can't force event-processing order in Twisted; if you want an event to not get processed, you need to delay its event source from getting invoked (producer.pauseProducing(), transport.stopReading(), transport.stopWriting(), Deferred.pause() are all ways to do this).

It's invalid to use reactor.iterate() in this way because the reactor may invoke you reentrantly and there's no sane way to handle that.

For example, your code is running because select() said your file descriptor was ready for reading, which then invoked dataReceived, which then invoked your method with buffered data, which then called iterate(), which then called dataReceived, which then called your method with buffered data, which then called iterate(), which then ...
(and so on, forever, unless your application code conflicts with itself and running and starts blowing up and throwing incomprehensible tracebacks everywhere because of &quot;impossible&quot; recursion.

&gt;<i> Which can be the reason of the mainloop &quot;block&quot;?
</I>
Lots of reasons.  The example you gave wasn't syntactically valid Python, so it's hard to say.  Consider sending along an &lt;<A HREF="http://sscce.org/">http://sscce.org/</A>&gt; and maybe we can tell you more :).


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022245.html">[Twisted-Python] Sending large files over network with	perspective broker
</A></li>
	<LI>Next message: <A HREF="022249.html">[Twisted-Python] Sending large files over network with	perspective broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22246">[ date ]</a>
              <a href="thread.html#22246">[ thread ]</a>
              <a href="subject.html#22246">[ subject ]</a>
              <a href="author.html#22246">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
