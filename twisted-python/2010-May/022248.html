<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] major changes, release engineering,	and learning cost
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20major%20changes%2C%20release%20engineering%2C%0A%09and%20learning%20cost&In-Reply-To=FCCC3CD5-0A5D-48A0-B679-24D43968175F%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022238.html">
   <LINK REL="Next"  HREF="022250.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] major changes, release engineering,	and learning cost</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20major%20changes%2C%20release%20engineering%2C%0A%09and%20learning%20cost&In-Reply-To=FCCC3CD5-0A5D-48A0-B679-24D43968175F%40twistedmatrix.com"
       TITLE="[Twisted-Python] major changes, release engineering,	and learning cost">exarkun at twistedmatrix.com
       </A><BR>
    <I>Sun May 23 22:35:32 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="022238.html">[Twisted-Python] PB referenceable and cacheable
</A></li>
        <LI>Next message: <A HREF="022250.html">[Twisted-Python] major changes, release engineering,	and learning 	cost
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22248">[ date ]</a>
              <a href="thread.html#22248">[ thread ]</a>
              <a href="subject.html#22248">[ subject ]</a>
              <a href="author.html#22248">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 23 May, 12:26 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A> wrote:
&gt;<i>The nice thing about Twisted's compatibility policy is that developers, 
</I>&gt;<i>and even users, very rarely have problems when installing a new version 
</I>&gt;<i>of Twisted.  While this is a nice benefit, the current strategy of 
</I>&gt;<i>developing features in a compatible way does have a couple of costs, 
</I>&gt;<i>and I'd like to see if we can address them without giving up the 
</I>&gt;<i>benefit.  I have a suggestion for a process tweak which would hopefully 
</I>&gt;<i>mitigate some of the difficulties which arise due to the compatibility 
</I>&gt;<i>policy.
</I>&gt;<i>
</I>&gt;<i>When we add a new feature that supersedes an older one, or fix a bug in 
</I>&gt;<i>Twisted that involves changing behavior, the developer fixing it has to 
</I>&gt;<i>come up with a new name.  If we have several behavior-changing bugfixes 
</I>&gt;<i>in the same subsystem, that means that developers using Twisted may 
</I>&gt;<i>have to learn about 3 different symbol names.  Since we tend to avoid 
</I>&gt;<i>just suffixing names with numbers (for good reason, I think), they 
</I>&gt;<i>won't have to learn Bicycle, Bicycle2, Bicycle3, they'll have to learn 
</I>&gt;<i>Bicycle, then Footcycle, and finally Velocipede, and somehow infer that 
</I>&gt;<i>Velocipede is the newest/best name that they should be using, by 
</I>&gt;<i>reading the (hopefully clear, concise) warnings that come out of their 
</I>&gt;<i>unit tests.
</I>&gt;<i>
</I>&gt;<i>This came up again recently on a ticket about URLPath, 
</I>&gt;<i>&lt;<A HREF="http://twistedmatrix.com/trac/ticket/2625#comment:16">http://twistedmatrix.com/trac/ticket/2625#comment:16</A>&gt;, where a 
</I>&gt;<i>contributor suggested that it would be better to make a whole new 
</I>&gt;<i>module because it's easier for external developers to learn about that 
</I>&gt;<i>then learn about an individual method change.  This of course raises 
</I>&gt;<i>the question: if we're going to have a whole new URL class, shouldn't 
</I>&gt;<i>it fix the (numerous) *other* bugs that we know about in URLPath?
</I>&gt;<i>
</I>&gt;<i>Up until now the objection to doing things this way is that it results 
</I>&gt;<i>in gigantic branches which are intractable to review.  That's a good 
</I>&gt;<i>objection, but it leaves us with a false dichotomy; reliable software 
</I>&gt;<i>and painless upgrades with a random scattershot of new features that 
</I>&gt;<i>are hard to understand, or coherent iterations of technology which 
</I>&gt;<i>can't be effectively reviewed, and therefore can't be effectively 
</I>&gt;<i>quality controlled.
</I>&gt;<i>
</I>&gt;<i>I propose that we get the best of both worlds by changing the way we do 
</I>&gt;<i>reviews slightly.  Right now every code review needs to be done on an 
</I>&gt;<i>entire feature going to trunk, and _all_ of the code going to trunk 
</I>&gt;<i>needs to be reviewed at once.  I suggest that instead, we create 
</I>&gt;<i>&quot;integration branches&quot; for sensible constellations of features, and 
</I>&gt;<i>have a two-stage review process.
</I>&gt;<i>
</I>&gt;<i>For example, let's say I want to work on making URLPath good.  There 
</I>&gt;<i>are several tickets addressing it:
</I>&gt;<i>
</I>&gt;<i>&lt;<A HREF="http://twistedmatrix.com/trac/ticket/2093">http://twistedmatrix.com/trac/ticket/2093</A>&gt;
</I>&gt;<i>&lt;<A HREF="http://twistedmatrix.com/trac/ticket/2094">http://twistedmatrix.com/trac/ticket/2094</A>&gt;
</I>&gt;<i>&lt;<A HREF="http://twistedmatrix.com/trac/ticket/2625">http://twistedmatrix.com/trac/ticket/2625</A>&gt;
</I>&gt;<i>
</I>&gt;<i>For the sake of argument, let's all pretend these are all deeply 
</I>&gt;<i>interrelated and involve changes to behavior of existing methods.  I 
</I>&gt;<i>think that is sort of true of most of these, but it would be far too 
</I>&gt;<i>verbose to talk about *how*, and get bogged down in that discussion.
</I>&gt;<i>
</I>&gt;<i>First, I'd make an integration ticket, let's call it #ABCD, describing 
</I>&gt;<i>how these features are related and a brief outline of the new API I 
</I>&gt;<i>propose which resolves them.
</I>&gt;<i>
</I>&gt;<i>Then I'd create an integration branch from trunk, for that ticket. 
</I>&gt;<i> From the #ABCD branch, I'd create a branch for #2093, and put it up for 
</I>&gt;<i>review.  The reviewer would review #2093 as usual, citing any test 
</I>&gt;<i>coverage issues, documentation issues, etc.  After the usual review 
</I>&gt;<i>process, when I get an &quot;OK to merge&quot;, I would merge #2093 *to the #ABCD 
</I>&gt;<i>branch*, not trunk.
</I>&gt;<i>
</I>&gt;<i>I would repeat this process for #2094 and #2625, merging each to the 
</I>&gt;<i>#ABCD branch as they passed review.
</I>&gt;<i>
</I>&gt;<i>Finally, I'd put #ABCD itself up for review.  At this point the process 
</I>&gt;<i>would differ a bit.  Reviewers would be able to assume, at this point, 
</I>&gt;<i>that the potentially large body of code in #ABCD had already been 
</I>&gt;<i>reviewed, that the test cases were good, the documentation was 
</I>&gt;<i>reasonably clear, and the logic made sense.  This final review would be 
</I>&gt;<i>a quick sanity check, to make sure the tests still pass and that there 
</I>&gt;<i>are no conflicts.
</I>&gt;<i>
</I>&gt;<i>I would like to strongly emphasize that this point in the process would 
</I>&gt;<i>be an inappropriate time for reviewers to start arguing with each other 
</I>&gt;<i>over what is required for the branch to land, disputing the original 
</I>&gt;<i>specification, etc; this is just an opportunity to spot potential 
</I>&gt;<i>regressions before it lands.  Each ticket review for a component of the 
</I>&gt;<i>larger feature should be an opportunity to draw attention to the 
</I>&gt;<i>direction of the larger feature development and prompt discussion. 
</I>&gt;<i>This *might* be an appropriate point to note that some other behavior- 
</I>&gt;<i>changing feature had been left out, though.
</I>&gt;<i>
</I>&gt;<i>In the case that there *were* conflicts, this would be an opportunity 
</I>&gt;<i>to review the conflict resolution itself.
</I>&gt;<i>
</I>&gt;<i>(We saw a nascent version of this approach on some stuff related to 
</I>&gt;<i>&lt;<A HREF="http://twistedmatrix.com/trac/ticket/886">http://twistedmatrix.com/trac/ticket/886</A>&gt; and it was hugely painful 
</I>&gt;<i>because nobody was really sure what the process was supposed to be.  So 
</I>&gt;<i>let's not do it like that again.)
</I>&gt;<i>
</I>&gt;<i>So: thoughts?  Does this make sense as a policy change for facilitating 
</I>&gt;<i>the development of major new features or consolidating behavior- 
</I>&gt;<i>changing fixes into easier-to-understand units?
</I>
So, to summarize, we could stage our code using more than just two 
branches (trunk + feature branch) in order to make larger changes easier 
to understand for reviewers while still making each change to trunk a 
coherent unit.

This sounds fine to me.  We need to work out some details (like, for 
example, I'm not sure trying to do this using subversion is such a good 
idea, and we want the process to be documented somewhere so we don't 
have a repeat of #886), but I think we should try it and see what 
happens.

Of course, someone needs to work on something big before we'll have a 
chance to try it.  I'm not yet convinced that `URLPath` is a good case 
for this, though.  It's very little code, and a complete 
reimplementation (if even such a thing is needed) will likewise be very 
little code.  Also, I don't think a complete reimplementation is needed 
here.

Going back to the proposed workflow change, we should also be sure 
there's a clear condition under which the integration branch should be 
merged to trunk.  And ideally we should still try to keep the lifespan 
of these things as short as possible.

Jean-Paul

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022238.html">[Twisted-Python] PB referenceable and cacheable
</A></li>
	<LI>Next message: <A HREF="022250.html">[Twisted-Python] major changes, release engineering,	and learning 	cost
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22248">[ date ]</a>
              <a href="thread.html#22248">[ thread ]</a>
              <a href="subject.html#22248">[ subject ]</a>
              <a href="author.html#22248">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
