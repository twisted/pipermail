<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Trouble with pb.CopyableFailure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Trouble%20with%20pb.CopyableFailure&In-Reply-To=%3C94a776e704111013364681c4e8%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="041565.html">
   <LINK REL="Next"  HREF="041551.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Trouble with pb.CopyableFailure</H1>
    <B>Justin Johnson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Trouble%20with%20pb.CopyableFailure&In-Reply-To=%3C94a776e704111013364681c4e8%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Trouble with pb.CopyableFailure">justinjohnson at gmail.com
       </A><BR>
    <I>Wed Nov 10 14:36:57 MST 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="041565.html">[Twisted-Python] Jabber client/server
</A></li>
        <LI>Next message (by thread): <A HREF="041551.html">[Twisted-Python] Re: Trouble with pb.CopyableFailure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41542">[ date ]</a>
              <a href="thread.html#41542">[ thread ]</a>
              <a href="subject.html#41542">[ subject ]</a>
              <a href="author.html#41542">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am trying to get pb.CopyableFailure to work, but am getting
unexpected results.

The following module is imported by both client and server.

---------------------
#!/usr/local/bin/python
&quot;&quot;&quot;
errors.py
&quot;&quot;&quot;
from twisted.spread import pb, jelly

class Error(pb.Error):
    &quot;&quot;&quot;Base class for exceptions in this module.&quot;&quot;&quot;
    pass

class WebViewOnDifferentServer(Error, pb.CopyableFailure, pb.RemoteCopy):
    def __init__(self, viewTag, server):
        Error.__init__(self)
        pb.CopyableFailure.__init__(self)
        self.viewTag = viewTag
        self.server = server
    def __str__(self):
        return &quot;WebViewOnDifferentServer: viewTag=%s, server=%s&quot; %
(self.viewTag, self.server)
---------------------


The client and server both contain the following 2 lines of code.

from ratcontrol import errors
pb.setUnjellyableForClass(errors.WebViewOnDifferentServer,
errors.WebViewOnDifferentServer)


The server raises an exception as follows.
----------------
if view.serverHost != config.thisServer:
                    ## We can't remove web views unless we're local,
since they don't
                    ## have a global path.
                    log.msg(&quot;Web view '%s' cannot be removed because
it isn't on this server.&quot; % tag)
                    raise errors.WebViewOnDifferentServer(view.tag,
view.serverHost)
-----------------

The server displays the following to the log.

2004/11/10 15:54 Eastern Standard Time [Broker,0,10.113.53.10] User
justin logged in

2004/11/10 15:54 Eastern Standard Time [Broker,0,10.113.53.10]
rmview(testview1, False)
2004/11/10 15:54 Eastern Standard Time [-] Web view 'testview1' cann
ot be removed because it isn't on this server.
2004/11/10 15:54 Eastern Standard Time [-] Peer will receive following
PB traceback:
2004/11/10 15:54 Eastern Standard Time [-] Failure: None: None


The failure that the client gets is None.

Does anyone know what I'm doing wrong here?  I've searched through the
docs but don't see specific examples of how to use CopyableFailure, so
I made the assumption that I could raise a CopyableFailure instead of
specifically writing code to send the failure back to the client.  Any
help is appreciated.

Thanks.
-Justin


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="041565.html">[Twisted-Python] Jabber client/server
</A></li>
	<LI>Next message (by thread): <A HREF="041551.html">[Twisted-Python] Re: Trouble with pb.CopyableFailure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41542">[ date ]</a>
              <a href="thread.html#41542">[ thread ]</a>
              <a href="subject.html#41542">[ subject ]</a>
              <a href="author.html#41542">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
