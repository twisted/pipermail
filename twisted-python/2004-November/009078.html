<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Reactors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Reactors&In-Reply-To=1AE4FF4E-38E6-11D9-AA57-000A95A50FB2%40fuhm.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009079.html">
   <LINK REL="Next"  HREF="009084.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Reactors</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Reactors&In-Reply-To=1AE4FF4E-38E6-11D9-AA57-000A95A50FB2%40fuhm.net"
       TITLE="[Twisted-Python] Reactors">bob at redivi.com
       </A><BR>
    <I>Thu Nov 18 03:58:39 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009079.html">[Twisted-Python] Reactors
</A></li>
        <LI>Next message: <A HREF="009084.html">[Twisted-Python] Reactors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9078">[ date ]</a>
              <a href="thread.html#9078">[ thread ]</a>
              <a href="subject.html#9078">[ subject ]</a>
              <a href="author.html#9078">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Nov 18, 2004, at 12:14 AM, James Y Knight wrote:

&gt;<i> Currently, cfreactor and IOCP reactor both seem to be in a state of 
</I>&gt;<i> very-brokenness. Itamar tells me wxreactor is also broken, but I have 
</I>&gt;<i> no knowledge of that. GTK and GTK2 reactors have some failures on BB, 
</I>&gt;<i> but I don't think they're in very bad shape really. Windows default 
</I>&gt;<i> reactor also currently has some failures, but I seem to recall it 
</I>&gt;<i> working right in the recent past (besides not being able to spawn 
</I>&gt;<i> processes).
</I>
Very test-failness.  I haven't seen a situation where cfreactor doesn't 
actually work in practice since it was changed to handle the GIL 
correctly.

The way the reactor code is written (not very modularly) leaves only 
two options to make cfreactor cleaner:
- have some naughty hacks in cfreactor [current situation]
- subclass, refactor, or reimplement everything that deals with unix 
file descriptors and make some subtle changes so that they don't 
require said hacks [not interested in doing this]

The problem is that the classes that use file descriptors make certain 
assumptions that are only true for the default (and probably poll) 
reactors.  Particularly, from memory, they don't have to tell the 
reactor when they want to lose connection, and they do something very 
crazy in order to determine when a TCP connection is established.  In 
the case of cfreactor, a wrapper object needs to live on top of the 
sockets so that the reactor will wake up on activity, and without 
proper notifications these objects can't be disposed of.

I'm not so sure those hacks are why it fails tests, though.  I believe 
the reason that cfreactor fails so many tests is because (a) 
reactor.run() doesn't necessarily block (a CFRunLoop may already be 
active) and (b) iteration is a big nasty hack, and nearly all the tests 
depend on (or at least they used to) reactor iteration having very 
specific and deterministic behavior.

Anyway, I simply don't have time or need to maintain cfreactor, 
especially when it works for everything I've thrown at it.  If you want 
to remove it, fine, I don't care that much, but I know a few people are 
using it.

-bob



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009079.html">[Twisted-Python] Reactors
</A></li>
	<LI>Next message: <A HREF="009084.html">[Twisted-Python] Reactors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9078">[ date ]</a>
              <a href="thread.html#9078">[ thread ]</a>
              <a href="subject.html#9078">[ subject ]</a>
              <a href="author.html#9078">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
