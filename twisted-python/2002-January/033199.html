<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Bug in t.w.w.WidgetPage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Bug%20in%20t.w.w.WidgetPage&In-Reply-To=%3C20020102233351.A32086%40mel.interspace.dk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="033197.html">
   <LINK REL="Next"  HREF="033200.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Bug in t.w.w.WidgetPage</H1>
    <B>Sune Kirkeby</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Bug%20in%20t.w.w.WidgetPage&In-Reply-To=%3C20020102233351.A32086%40mel.interspace.dk%3E"
       TITLE="[Twisted-Python] Bug in t.w.w.WidgetPage">sune-twisted at mel.interspace.dk
       </A><BR>
    <I>Wed Jan  2 15:33:51 MST 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="033197.html">[Twisted-Python] Bug in t.w.w.WidgetPage
</A></li>
        <LI>Next message (by thread): <A HREF="033200.html">[Twisted-Python] Bug in t.w.w.WidgetPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33199">[ date ]</a>
              <a href="thread.html#33199">[ thread ]</a>
              <a href="subject.html#33199">[ subject ]</a>
              <a href="author.html#33199">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[ Sune Kirkeby ]
&gt;<i> I think there might be a bug lurking in t.w.w.WidgetPage's
</I>&gt;<i> handling of Deferreds.
</I>
And here is a patch to fix it.  The patch does away with Deferred
holding their positions in lst, instead a Deferred now hold a
sentinel, that is put into lst with the Deferred.

When we need the position in callback we go looking for the sentinel
the Deferred gave us.  This also allows us to stop keeping data we
have written to the request (i.e. lst now only holds the Deferreds
and strings that have not been sent).

Also, the patch adds NOT_DONE_YET support to WidgetPage.  This works
by Deferreds callback'ing with a tuple (NOT_DONE_YET,
partial_result) which is insert into lst before the Deferred.

So, now Deferreds can callback to WidgetPage multiple times with
partial results. (Not sure if this is abusing the Deferred protocol,
but it solves an itch I had :-).

Comments?

-- 
Sune Kirkeby | Teori er når vi har forstået alting, men intet virker. Praksis
             | er når alting virker, men ingen forstår hvorfor. Hos os
             | er de to ting forenet: Intet virker og ingen forstår hvorfor!


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="033197.html">[Twisted-Python] Bug in t.w.w.WidgetPage
</A></li>
	<LI>Next message (by thread): <A HREF="033200.html">[Twisted-Python] Bug in t.w.w.WidgetPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33199">[ date ]</a>
              <a href="thread.html#33199">[ thread ]</a>
              <a href="subject.html#33199">[ subject ]</a>
              <a href="author.html#33199">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
