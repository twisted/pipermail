<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Experiences with twisted.spread: representing	an ACL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Experiences%20with%20twisted.spread%3A%20representing%0A%09an%20ACL&In-Reply-To=20020115051319.37386.qmail%40web10002.mail.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000712.html">
   <LINK REL="Next"  HREF="000713.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Experiences with twisted.spread: representing	an ACL</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Experiences%20with%20twisted.spread%3A%20representing%0A%09an%20ACL&In-Reply-To=20020115051319.37386.qmail%40web10002.mail.yahoo.com"
       TITLE="[Twisted-Python] Experiences with twisted.spread: representing	an ACL">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Jan 15 00:53:05 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="000712.html">[Twisted-Python] Experiences with twisted.spread: representing an ACL
</A></li>
        <LI>Next message: <A HREF="000713.html">[Twisted-Python] representing groups
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#714">[ date ]</a>
              <a href="thread.html#714">[ thread ]</a>
              <a href="subject.html#714">[ subject ]</a>
              <a href="author.html#714">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>First of all, let me apologize for not having documented this stuff more
thoroughly.  I'm glad you're making an effort to use this
infrastructure, and please have the patience to help me complete it -- I
need use-cases like yours to make the system more general.

Passport is in the process of a major overhaul, to make it possible to
store perspectives in a database.  This is changing some of the basic
APIs, so some of the answers to this (and your other thread) will be a
bit vague.

On Mon, 2002-01-14 at 23:13, Cory Dodt wrote:
&gt;<i> I am working on a networked backup server which is so new it doesn't even
</I>&gt;<i> have a project page up on SF yet, although it might by the end of the
</I>&gt;<i> week.  To build this I am using spread and passport instead of building my
</I>&gt;<i> own protocol.    I'm having trouble with some of the concepts in spread,
</I>&gt;<i> and at this point I'm still too naive to know whether I'm missing the
</I>&gt;<i> point of something or whether passport is actually missing something I
</I>&gt;<i> need.
</I>
Passport has what you need, but it's different than you think, I think.

&gt;<i> I want to implement access control lists.  For each Identity, I want to
</I>&gt;<i> assign a simple list of strings which more or less represent the ability
</I>&gt;<i> to access a Perspective.  For example:
</I>&gt;<i> 
</I>&gt;<i> useracl=[ &quot;store_files&quot;,
</I>&gt;<i>         &quot;read_files&quot;,
</I>&gt;<i>         &quot;encrypt&quot;,
</I>&gt;<i>         &quot;create_lbu&quot; ]
</I>&gt;<i> 
</I>&gt;<i> There is a StoreFilesService, a ReadFilesService, and a CreateLBUService,
</I>&gt;<i> and a Perspective for each.  The &quot;encrypt&quot; permission is a modifier to
</I>&gt;<i> Store and Read files, so I'm not sure how to implement that yet but I'll
</I>&gt;<i> cross that bridge when I come to it.
</I>
If you have an ACL, implement it as an ACL.

A perspective is a conglomeration of state for a particular service.  If
storing files, reading files, and creating LBUs all access the same
repository of data, and all exist within an encapsulation boundary of
some kind, they should probably all be one service that glues them
together.

&gt;<i> I have subclassed the Authorizer thus:
</I>&gt;<i> 
</I>&gt;<i> class Authorizer(passport.Authorizer):
</I>&gt;<i>     def addIdentity(self, identity):
</I>&gt;<i>         if self.identities.has_key(identity.name):
</I>&gt;<i>             raise passport.KeyError(&quot;Already have an identity by that
</I>&gt;<i> name.&quot;)
</I>&gt;<i>         self.identities[identity.name] = identity
</I>&gt;<i>         if identity.permissions == None:
</I>&gt;<i>             raise MissingPermissionsException(identity)
</I>&gt;<i>         # create all perspectives the user should have
</I>&gt;<i>         for permission in identity.acl:
</I>&gt;<i>             svc=servicelist.services[permission](permission, tap.the_app)
</I>&gt;<i>             svc.createPerspective(identity.name).setIdentity(identity)
</I>&gt;<i>            
</I>&gt;<i> identity.addKeyForPerspective(svc.getPerspectiveNamed(identity.name))
</I>&gt;<i> 
</I>&gt;<i> Does passport already has something like the ACL mechanism which allows
</I>&gt;<i> you to easily bind an ACL to a user?  Is my solution the most parsimonious
</I>&gt;<i> or do I really have to subclass the Authorizer to achieve this?  It seems
</I>&gt;<i> like I should be able to throw in a callback somewhere that creates the
</I>&gt;<i> eligible service/perspective pairs when a user is added to the system.
</I>
It looks here like you want to add state (and potentially behavior) to
Identity, which is not its purpose.  The goal of the Identity/Passport
distinction is to provide a very sharp boundary between different sorts
of functionality (for example, a chat system and your backup software)
but allow your users to have access to each.

The reason you would add stuff to Identity is to add a new kind of
authentication mechanism, for example, or to store them in an LDAP data
repository.

A perspective is a capability, not an ACL.  An identity should be
nothing more than an index of all perspectives available to a particular
authentication token.  Any information about or behavior for that
identity is &quot;application specific&quot; can be reflected in a Perspective
attached to it.

Rather than trying to cram each operation into a Perspective of its own,
you could just implement your ACLs internal to the Perspective, and test
them with perspective.hasAbilityTo(&quot;some acl&quot;)... an implementation of a
generalized, database-backed ACL system would be pretty handy, if you
felt like contributing such a thing to Twisted :).

&gt;<i> Second, if I modify a user's ACL, for example to grant a permission,
</I>&gt;<i> where's the callback to create a new s/p pair for that permission?  I have
</I>&gt;<i> a suspicion that this is already taken care of somewhere in passport and
</I>&gt;<i> I'm just missing the point.
</I>
Service.createPerspective is the current way to do that.

-- 
______      you are in a maze of twisted little applications, all
|<i>   |_\     remarkably consistent.
</I>|<i>     |          -- glyph lefkowitz, glyph @ twisted matrix . com
</I>|<i>_____|             <A HREF="http://www.twistedmatrix.com/">http://www.twistedmatrix.com/</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000712.html">[Twisted-Python] Experiences with twisted.spread: representing an ACL
</A></li>
	<LI>Next message: <A HREF="000713.html">[Twisted-Python] representing groups
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#714">[ date ]</a>
              <a href="thread.html#714">[ thread ]</a>
              <a href="subject.html#714">[ subject ]</a>
              <a href="author.html#714">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
