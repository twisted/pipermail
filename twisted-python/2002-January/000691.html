<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Bug in t.w.w.WidgetPage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Bug%20in%20t.w.w.WidgetPage&In-Reply-To=20020102213234.A30425%40mel.interspace.dk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000689.html">
   <LINK REL="Next"  HREF="000692.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Bug in t.w.w.WidgetPage</H1>
    <B>Sune Kirkeby</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Bug%20in%20t.w.w.WidgetPage&In-Reply-To=20020102213234.A30425%40mel.interspace.dk"
       TITLE="[Twisted-Python] Bug in t.w.w.WidgetPage">sune-twisted at mel.interspace.dk
       </A><BR>
    <I>Wed Jan  2 17:33:51 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="000689.html">[Twisted-Python] Bug in t.w.w.WidgetPage
</A></li>
        <LI>Next message: <A HREF="000692.html">[Twisted-Python] Bug in t.w.w.WidgetPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#691">[ date ]</a>
              <a href="thread.html#691">[ thread ]</a>
              <a href="subject.html#691">[ subject ]</a>
              <a href="author.html#691">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[ Sune Kirkeby ]
&gt;<i> I think there might be a bug lurking in t.w.w.WidgetPage's
</I>&gt;<i> handling of Deferreds.
</I>
And here is a patch to fix it.  The patch does away with Deferred
holding their positions in lst, instead a Deferred now hold a
sentinel, that is put into lst with the Deferred.

When we need the position in callback we go looking for the sentinel
the Deferred gave us.  This also allows us to stop keeping data we
have written to the request (i.e. lst now only holds the Deferreds
and strings that have not been sent).

Also, the patch adds NOT_DONE_YET support to WidgetPage.  This works
by Deferreds callback'ing with a tuple (NOT_DONE_YET,
partial_result) which is insert into lst before the Deferred.

So, now Deferreds can callback to WidgetPage multiple times with
partial results. (Not sure if this is abusing the Deferred protocol,
but it solves an itch I had :-).

Comments?

-- 
Sune Kirkeby | Teori er n&#229;r vi har forst&#229;et alting, men intet virker. Praksis
             | er n&#229;r alting virker, men ingen forst&#229;r hvorfor. Hos os
             | er de to ting forenet: Intet virker og ingen forst&#229;r hvorfor!


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000689.html">[Twisted-Python] Bug in t.w.w.WidgetPage
</A></li>
	<LI>Next message: <A HREF="000692.html">[Twisted-Python] Bug in t.w.w.WidgetPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#691">[ date ]</a>
              <a href="thread.html#691">[ thread ]</a>
              <a href="subject.html#691">[ subject ]</a>
              <a href="author.html#691">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
