<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] SSHv2 client script for Cisco routers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20SSHv2%20client%20script%20for%20Cisco%20routers&In-Reply-To=18e3f33d0707121300l49850ddft83b7d78676527091%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015742.html">
   <LINK REL="Next"  HREF="015752.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] SSHv2 client script for Cisco routers</H1>
    <B>Chris Hallman</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20SSHv2%20client%20script%20for%20Cisco%20routers&In-Reply-To=18e3f33d0707121300l49850ddft83b7d78676527091%40mail.gmail.com"
       TITLE="[Twisted-Python] SSHv2 client script for Cisco routers">challman at gmail.com
       </A><BR>
    <I>Thu Jul 12 16:39:09 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="015742.html">[Twisted-Python] SSHv2 client script for Cisco routers
</A></li>
        <LI>Next message: <A HREF="015752.html">[Twisted-Python] SSHv2 client script for Cisco routers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15744">[ date ]</a>
              <a href="thread.html#15744">[ thread ]</a>
              <a href="subject.html#15744">[ subject ]</a>
              <a href="author.html#15744">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Here's one of my favorite programs to date (see attachment). It's a
multi-threaded ISDN testing program. Here's the workflow:

1. Connect to each head-end router and extract all the usernames for
testing.
2. Spawn up to N threads and telnet to each device.
3. Check for a layer-1 connection.
4. Check for an existing DBU connection.
5. Extract all interfaces for testing.
6. Execute a DBU test for each interface verifying a connection takes place
and an EIGRP peer establishes.

(It does some other things specific for our network.) It writes output to a
local log file and SNMP traps on failure and program completion. I really
need to get it working using SSH. I'm looking into Paramiko and Twisted,
however I'm not the best of programmers. I've been able to learn enough to
complete tasks such as this. Here's a simple program using Paramiko:

import paramiko
import time

client = paramiko.SSHClient()

# ignore host keys for the test
client.set_missing_host_key_policy(paramiko.MissingHostKeyPolicy())

client.connect('rtr3926', 22, 'user', 'passw')
(stdin, stdout, stderr) = client.exec_command('sh ver | i IOS')
print stdout.read()
#(stdin, stdout, stderr) = client.exec_command('sh ver | i IOS')
#print stdout.read()

The only problem is it drops the channel after the first &quot;sh ver&quot;.


On 7/12/07, Eli Criffield &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">elicriffield at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Thats exactly what I've been working on, a script to automate
</I>&gt;<i> connections to cisco switches, where you have to execute multiple
</I>&gt;<i> commands per connection (config t, then some commands ect...)
</I>&gt;<i>
</I>&gt;<i> I emailed this list yesterday asking if anyone has some examples of
</I>&gt;<i> how to do that and no reply yet.
</I>&gt;<i>
</I>&gt;<i> I'd like to get ssh worked into <A HREF="http://code.google.com/p/exscript/">http://code.google.com/p/exscript/</A> .
</I>&gt;<i> Exscript does what your doing with telnetlib and uses  templates and
</I>&gt;<i> concurrent connections.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Eli Criffield
</I>&gt;<i>
</I>&gt;<i> On 7/12/07, Chris Hallman &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">challman at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Does anyone have an example of a SSHv2 client script? I need to write a
</I>&gt;<i> &gt; script that uses SSHv2 to execute multiple commands on hundreds of
</I>&gt;<i> routers.
</I>&gt;<i> &gt; I already have a script that does this with the Telnetlib. I need to
</I>&gt;<i> &gt; transition to SSHv2.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Twisted-Python mailing list
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20070712/f7f086a2/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20070712/f7f086a2/attachment.htm</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ISDNtest.py
Type: text/x-python
Size: 12872 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20070712/f7f086a2/attachment.py">http://twistedmatrix.com/pipermail/twisted-python/attachments/20070712/f7f086a2/attachment.py</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015742.html">[Twisted-Python] SSHv2 client script for Cisco routers
</A></li>
	<LI>Next message: <A HREF="015752.html">[Twisted-Python] SSHv2 client script for Cisco routers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15744">[ date ]</a>
              <a href="thread.html#15744">[ thread ]</a>
              <a href="subject.html#15744">[ subject ]</a>
              <a href="author.html#15744">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
