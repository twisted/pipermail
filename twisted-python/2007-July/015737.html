<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Perspective Broker with blocking,	non-thread-safe C api?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Perspective%20Broker%20with%20blocking%2C%0A%09non-thread-safe%20C%20api%3F&In-Reply-To=6ce0ac130707110825tfd4885fs3c20a2cc0485d192%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015736.html">
   <LINK REL="Next"  HREF="015731.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Perspective Broker with blocking,	non-thread-safe C api?</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Perspective%20Broker%20with%20blocking%2C%0A%09non-thread-safe%20C%20api%3F&In-Reply-To=6ce0ac130707110825tfd4885fs3c20a2cc0485d192%40mail.gmail.com"
       TITLE="[Twisted-Python] Perspective Broker with blocking,	non-thread-safe C api?">glyph at divmod.com
       </A><BR>
    <I>Wed Jul 11 11:38:14 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="015736.html">[Twisted-Python] Perspective Broker with blocking,	non-thread-safe C api?
</A></li>
        <LI>Next message: <A HREF="015731.html">[Twisted-Python] A collection of protocol objects
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15737">[ date ]</a>
              <a href="thread.html#15737">[ thread ]</a>
              <a href="subject.html#15737">[ subject ]</a>
              <a href="author.html#15737">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 03:25 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">ellisonbg.net at gmail.com</A> wrote:
&gt;<i>The reason is that is you call a blocking C api in the thread, the
</I>&gt;<i>Python interpreter will not be able to switch threads until the
</I>&gt;<i>blocking C calls....unless the C code releases the Global Interpreter
</I>&gt;<i>Lock.  Thus you have two choices:
</I>(1 and 2 snipped)
&gt;<i>The way we usually handle this is to make a separate process that
</I>&gt;<i>manages a queue of commands to be executed on the server.  Clients
</I>&gt;<i>then connect to this manager, which in turns submits them to the
</I>&gt;<i>actual PB server at the appropriate time.  This is a pain, but it
</I>&gt;<i>works extremely well.
</I>
That sounds like a viable &quot;third choice&quot;, and I have a fourth ;).

Have the PB server itself spawn a subprocess (or multiple subprocesses!) 
dedicated to this particular API.  Then simply block in that (those) 
subprocess(es), and return Deferreds from your PB methods that wait for 
those requests to complete.

That way the PB server remains self-contained and you don't add the 
administrative overhead of setting up a separate server.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015736.html">[Twisted-Python] Perspective Broker with blocking,	non-thread-safe C api?
</A></li>
	<LI>Next message: <A HREF="015731.html">[Twisted-Python] A collection of protocol objects
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15737">[ date ]</a>
              <a href="thread.html#15737">[ thread ]</a>
              <a href="subject.html#15737">[ subject ]</a>
              <a href="author.html#15737">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
