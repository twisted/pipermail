<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] XMLRPC Class in HTTP Server.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20XMLRPC%20Class%20in%20HTTP%20Server.&In-Reply-To=%3C20070709141407.4947.1888526620.divmod.quotient.9437%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="048229.html">
   <LINK REL="Next"  HREF="048240.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] XMLRPC Class in HTTP Server.</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20XMLRPC%20Class%20in%20HTTP%20Server.&In-Reply-To=%3C20070709141407.4947.1888526620.divmod.quotient.9437%40ohm%3E"
       TITLE="[Twisted-Python] XMLRPC Class in HTTP Server.">exarkun at divmod.com
       </A><BR>
    <I>Mon Jul  9 08:14:07 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="048229.html">[Twisted-Python] XMLRPC Class in HTTP Server.
</A></li>
        <LI>Next message (by thread): <A HREF="048240.html">[Twisted-Python] XMLRPC Class in HTTP Server.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48230">[ date ]</a>
              <a href="thread.html#48230">[ thread ]</a>
              <a href="subject.html#48230">[ subject ]</a>
              <a href="author.html#48230">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Wasn't going to reply to this, for reasons which will be obvious momentarily,
but I haven't seen a correct reply yet, so...

On Fri, 06 Jul 2007 09:46:38 +0200, Daniel de la Cuesta &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">daniel.cuesta at iavante.es</A>&gt; wrote:
&gt;<i>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
</I>&gt;<i>&lt;html&gt;
</I>&gt;<i>&lt;head&gt;
</I>&gt;<i>  &lt;meta content=&quot;text/html;charset=ISO-8859-1&quot; http-equiv=&quot;Content-Type&quot;&gt;
</I>&gt;<i>&lt;/head&gt;
</I>&gt;<i>&lt;body bgcolor=&quot;#ffffff&quot; text=&quot;#000000&quot;&gt;
</I>&gt;<i>Hi,&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>&gt;<i>I have a twisted web server running using &quot;twisted.web.http&quot;.&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>
You probably want to direct future questions on this topic to the
twisted-web mailing list, where you'll get more attention from
people more actively doing web things.

&gt;<i>The objective of the server is to convert files to another format.
</I>&gt;<i>Currently I upload the files and the conversion params using an HTTP
</I>&gt;<i>POST from a form.&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>&gt;<i>Now I want to add XML-RPC support to the conversion process. It means
</I>&gt;<i>the user could process the conversion using the http form or calling
</I>&gt;<i>directly the XML-RPC class.&lt;br&gt;
</I>
HTTP POST is probably a better way to upload files, in general.  MIME-ish
encoding is a bit easier and has less overhead than base64 encoding.

&gt;<i>&lt;br&gt;
</I>&gt;<i>This is my pages dispatch:&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>&gt;<i>class MyRequestHandler(http.Request):&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp; &lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp;&nbsp; pages = { '/' : loginPage, &lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '/uploadHandler' : handleUpload,&lt;br&gt;
</I>&gt;<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '/uploadform' : uploadForm,&lt;br&gt;
</I>&gt;<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '/xmlrpc_converter': MyConverterXMLRPCClass() }&lt;br&gt;
</I>
Rarely is it correct to subclass Request.  You can probably just discard
all of the above code.  Aside from that, I don't know what the `pages'
attribute is.  I don't think anything pays any attention to it.

&gt;<i>&lt;br&gt;
</I>&gt;<i>What I want to do is offer the user two possibilities to upload the
</I>&gt;<i>file, one of them using HTTP POST (calling to &quot;uploadform&quot;) and the
</I>&gt;<i>other using XML-RPC (caling to xmlrpc_converter).&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>&gt;<i>I have tried to implement MyConverterXMLRPCClass() as follows:&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>&gt;<i>MyConverterXMLRPCClass(xmlrpc.XMLRPC):&lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp; &lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp;&nbsp; def __init(self):&lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;&quot;&quot;&quot;&quot;&quot;&lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pass&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp;&nbsp; def xmlrpc_mymethod1(self, param)&lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;&quot;&quot;My process&quot;&quot;&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>
This part looks okay.

&gt;<i>But It down't work, when I try &lt;a class=&quot;moz-txt-link-freetext&quot; href=&quot;<A HREF="http://localhost:8000/xmlrpc_converter">http://localhost:8000/xmlrpc_converter</A>&quot;&gt;<A HREF="http://localhost:8000/xmlrpc_converter&lt;/a">http://localhost:8000/xmlrpc_converter&lt;/a</A>&gt; I
</I>&gt;<i>get the following error:&lt;br&gt;
</I>&gt;<i>&lt;br&gt;
</I>&gt;<i>&quot;MyConverterXMLRPCClass instance has no __call__ method&quot;&lt;br&gt;
</I>&gt;<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;
</I>&gt;<i>How can I call MyConverterXMLRPCClass from an url in my http server?&lt;br&gt;
</I>
I don't know how a MyConverterXMLRPCClass got called.  I suppose you have
some more code that you didn't include in this message which looks at the
pages dictionary on the request object and does something with them.
Whatever it is, I guess it isn't correct. ;)

Instead, what you should do is define a root resource which has
MyConverterXMLRPCClass as a child at the &quot;xmlrpc_converter&quot; segment.  You
can do this pretty easily using the basic Resource class in twisted.web:

    from twisted.web.resource import Resource
    from twisted.web.server import Site
    from twisted.internet import reactor

    root = Resource()
    root.putChild('xmlrpc_converter', MyConverterXMLRPCClass())
    site = Site(root)
    reactor.listenTCP(8080, site)

The Resource class is implemented to keep track of child resources added
to it with putChild so that when a request comes in for one of them, it
gives back the appropriate one and URL traversal or page rendering can
continue.

Hope this helps,

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="048229.html">[Twisted-Python] XMLRPC Class in HTTP Server.
</A></li>
	<LI>Next message (by thread): <A HREF="048240.html">[Twisted-Python] XMLRPC Class in HTTP Server.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48230">[ date ]</a>
              <a href="thread.html#48230">[ thread ]</a>
              <a href="subject.html#48230">[ subject ]</a>
              <a href="author.html#48230">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
