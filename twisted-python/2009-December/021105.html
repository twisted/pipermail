<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] AbstractDatagramProtocol implementation	question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20AbstractDatagramProtocol%20implementation%0A%09question&In-Reply-To=4B184AE4.4000801%40free.fr">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021101.html">
   <LINK REL="Next"  HREF="021102.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] AbstractDatagramProtocol implementation	question</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20AbstractDatagramProtocol%20implementation%0A%09question&In-Reply-To=4B184AE4.4000801%40free.fr"
       TITLE="[Twisted-Python] AbstractDatagramProtocol implementation	question">exarkun at twistedmatrix.com
       </A><BR>
    <I>Sun Dec  6 14:38:46 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="021101.html">[Twisted-Python] AbstractDatagramProtocol implementation question
</A></li>
        <LI>Next message: <A HREF="021102.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21105">[ date ]</a>
              <a href="thread.html#21105">[ thread ]</a>
              <a href="subject.html#21105">[ subject ]</a>
              <a href="author.html#21105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3 Dec, 11:33 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">olivier.parisy at free.fr</A> wrote:
&gt;<i>I am studying the implementation of twisted UDP-related classes, and I
</I>&gt;<i>do not understand the point of the &quot;numPorts&quot; attribute of
</I>&gt;<i>AbstractDatagramProtocol.
</I>&gt;<i>
</I>&gt;<i>It is clearly designed to avoid multiple calls to startProtocol() from
</I>&gt;<i>doStart(), but I fail in imagining a scenario where this may happen
</I>&gt;<i>since, as the comment states, doStart() should only be called by
</I>&gt;<i>makeConnection(), which has an explicit &quot;assert self.transport == None&quot;
</I>&gt;<i>guard which, indeed, prevents multiple calls.
</I>&gt;<i>
</I>&gt;<i>So why bother to count calls?
</I>&gt;<i>
</I>&gt;<i>Moreover, makeConnection() could be called multiple times on the same
</I>&gt;<i>DatagramProtocol instance if it was &quot;bound&quot; to multiple ports (multiple
</I>&gt;<i>calls to listenUDP), which can be an interesting scenario but is
</I>&gt;<i>prevented by :
</I>&gt;<i>- the above assertion,
</I>&gt;<i>- the fact that AbstractDatagramProtocol.transport is not a collection,
</I>&gt;<i>so only the last Port would be available anyway.
</I>&gt;<i>
</I>&gt;<i>Is my reasoning wrong or incomplete? If not, couldn't we simplify
</I>&gt;<i>AbstractDatagramProtocol implementation by removing numPorts?
</I>
This was probably a mindless copy/paste from the TCP implementation.  I 
don't see any reason not to deprecate and then remove the attribute.
&gt;<i>
</I>&gt;<i>Two other small remarks regarding documentation / understandability :
</I>&gt;<i>- The note &quot;This does not actually implement IListeningPort&quot; on 
</I>&gt;<i>udp.Port
</I>&gt;<i>lead me to think that IReactorUDP.listenUDP should not be declared as
</I>&gt;<i>returning an object implementing IListeningPort in the first place
</I>&gt;<i>(confused me!).
</I>
This docstring seems to have been inherited from the base class, which 
indeed does not implement IListeningPort.  It would probably be nice if 
udp.Port had its own docstring which was more reflective of udp.Port.
&gt;<i>- I had to read the code to understand that a &quot;transport&quot; and a &quot;port&quot;
</I>&gt;<i>are exactly the same thing in the UDP implementation. The tutorial and
</I>&gt;<i>the documentation were not clear about this point, so I did not make 
</I>&gt;<i>the
</I>&gt;<i>link between the &quot;self.transport&quot; available in DatagramProtocol and the
</I>&gt;<i>value returned by listenUDP (confused me!).
</I>
Would you like to file a ticket for the numPorts issue and another one 
for these documentation issues?  If you also attach a patch clarifying 
things, it will probably be applied quite quickly.

Thank you very much for the feedback!

Jean-Paul

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021101.html">[Twisted-Python] AbstractDatagramProtocol implementation question
</A></li>
	<LI>Next message: <A HREF="021102.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21105">[ date ]</a>
              <a href="thread.html#21105">[ thread ]</a>
              <a href="subject.html#21105">[ subject ]</a>
              <a href="author.html#21105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
