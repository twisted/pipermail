From jml at mumak.net  Mon Mar  1 08:56:52 2010
From: jml at mumak.net (Jonathan Lange)
Date: Mon, 1 Mar 2010 13:56:52 +0000
Subject: [Twisted-Python] python3 story?
In-Reply-To: <4B86C66B.8010609@noir.com>
References: <4B86C66B.8010609@noir.com>
Message-ID: <d06a5cd31003010556x781d3c9dj7cd4e35643ad352@mail.gmail.com>

On Thu, Feb 25, 2010 at 6:50 PM, K. Richard Pixley <rich at noir.com> wrote:
> Does twisted have a python3 story?
>
> Whatever it is, it should probably be in the release 10 doc and perhaps
> also on the web site.

The docs for 10.0.0 release are already frozen.

jml


From bra at fsn.hu  Mon Mar  1 09:15:24 2010
From: bra at fsn.hu (Attila Nagy)
Date: Mon, 01 Mar 2010 15:15:24 +0100
Subject: [Twisted-Python] Is AMP secure enough for the internet?
In-Reply-To: <1267416570.32241.76.camel@Snowflake>
References: <4B8995D2.8040909@fsn.hu>	<f5eea9171002281633s6ee01b2dp5c6ce27e3acdf4f6@mail.gmail.com>
	<1267416570.32241.76.camel@Snowflake>
Message-ID: <4B8BCBFC.5040404@fsn.hu>

Eric P. Mangold wrote:
> AMP "keys" are limited to 256 bytes and "values" are limited to 64k. So
> that will prevent your program from handling a malformed AMP packet that
> tries to exceed those limits....
>   
Yes, I know that from the docs, but I haven't read the code, and it's
not trivial where this is limited. If only on the client side, it
doesn't protect...
> One of the things you will need to implement yourself is preventing an
> otherwise legit client from flooding your server with legitimate
> requests... this is application-specific, and Twisted can't implement a
> generalized protection mechanize here.
>   
That's right and clear, this needs to be implemented in the application.

Thanks,


From jml at mumak.net  Mon Mar  1 09:19:05 2010
From: jml at mumak.net (Jonathan Lange)
Date: Mon, 1 Mar 2010 14:19:05 +0000
Subject: [Twisted-Python] Is AMP secure enough for the internet?
In-Reply-To: <4B8BCBFC.5040404@fsn.hu>
References: <4B8995D2.8040909@fsn.hu>
	<f5eea9171002281633s6ee01b2dp5c6ce27e3acdf4f6@mail.gmail.com>
	<1267416570.32241.76.camel@Snowflake> <4B8BCBFC.5040404@fsn.hu>
Message-ID: <d06a5cd31003010619t1e498eb9w3ccd7b0c9fd5a040@mail.gmail.com>

On Mon, Mar 1, 2010 at 2:15 PM, Attila Nagy <bra at fsn.hu> wrote:
> Eric P. Mangold wrote:
>> AMP "keys" are limited to 256 bytes and "values" are limited to 64k. So
>> that will prevent your program from handling a malformed AMP packet that
>> tries to exceed those limits....
>>
> Yes, I know that from the docs, but I haven't read the code, and it's
> not trivial where this is limited. If only on the client side, it
> doesn't protect...

The first two bytes of the key are the length of the key. The server
will stop reading after this length, and will bork if the length is
bigger than 256.

Actually, the client will do the same, since at this level, the
protocol is symmetric.

jml


From markscottwright at gmail.com  Mon Mar  1 11:47:49 2010
From: markscottwright at gmail.com (markscottwright at gmail.com)
Date: Mon, 01 Mar 2010 16:47:49 +0000
Subject: [Twisted-Python] What is the right way to pass variables from Site
	to Resource?
Message-ID: <0016e6475fdc655cd30480c002b5@google.com>

I've got some global state and configuration information. It seems to me  
that they ought to be members of my Site, but I don't see any obvious way  
in a Resource.render_* to get the current Site. Neither Request nor  
Resource have a instance or method that returns its Site that I can find.  
Am I missing something, or am I confused about the Twisted way of doing  
things?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100301/049460e4/attachment.htm 

From exarkun at twistedmatrix.com  Mon Mar  1 12:20:05 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Mon, 01 Mar 2010 17:20:05 -0000
Subject: [Twisted-Python] What is the right way to pass variables
	from	Site to Resource?
In-Reply-To: <0016e6475fdc655cd30480c002b5@google.com>
References: <0016e6475fdc655cd30480c002b5@google.com>
Message-ID: <20100301172005.2792.1622720080.divmod.xquotient.311@localhost.localdomain>

On 04:47 pm, markscottwright at gmail.com wrote:
>I've got some global state and configuration information. It seems to 
>me that they ought to be members of my Site, but I don't see any 
>obvious way in a Resource.render_* to get the current Site. Neither 
>Request nor Resource have a instance or method that returns its Site 
>that I can find. Am I missing something, or am I confused about the 
>Twisted way of doing things?

The Request object does have a "site" attribute.  It's not documented on 
the interface, so perhaps you should be careful in your use of it.  Or, 
you could file a ticket explaining why it would be a good idea to have 
the attribute added to the interface.

Jean-Paul


From marco.giusti at gmail.com  Mon Mar  1 12:23:10 2010
From: marco.giusti at gmail.com (Marco Giusti)
Date: Mon, 1 Mar 2010 18:23:10 +0100
Subject: [Twisted-Python] What is the right way to pass variables from
 Site to Resource?
In-Reply-To: <0016e6475fdc655cd30480c002b5@google.com>
References: <0016e6475fdc655cd30480c002b5@google.com>
Message-ID: <20100301172310.GB2688@murdoc>

On Mon, Mar 01, 2010 at 04:47:49PM +0000, markscottwright at gmail.com wrote:
> I've got some global state and configuration information. It seems
> to me that they ought to be members of my Site, but I don't see any
> obvious way in a Resource.render_* to get the current Site. Neither
> Request nor Resource have a instance or method that returns its Site
> that I can find. Am I missing something, or am I confused about the
> Twisted way of doing things?

as general rule i prefer pass variables through constructors but i don't
know how do you instance your Resource(s).




From drew.smathers at gmail.com  Mon Mar  1 12:23:51 2010
From: drew.smathers at gmail.com (Drew Smathers)
Date: Mon, 1 Mar 2010 12:23:51 -0500
Subject: [Twisted-Python] What is the right way to pass variables from
	Site to Resource?
In-Reply-To: <0016e6475fdc655cd30480c002b5@google.com>
References: <0016e6475fdc655cd30480c002b5@google.com>
Message-ID: <368574aa1003010923o712c1b3cg5b84930196848a4d@mail.gmail.com>

On Mon, Mar 1, 2010 at 11:47 AM, <markscottwright at gmail.com> wrote:

> I've got some global state and configuration information. It seems to me
> that they ought to be members of my Site, but I don't see any obvious way in
> a Resource.render_* to get the current Site. Neither Request nor Resource
> have a instance or method that returns its Site that I can find. Am I
> missing something, or am I confused about the Twisted way of doing things?
>
>
I think you are missing something - request has attribute `site' set on it
which will give you the Site object.

-Drew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100301/64f677be/attachment.htm 

From renan at renanfernandes.org  Mon Mar  1 14:16:38 2010
From: renan at renanfernandes.org (Renan Mathias Fernandes)
Date: Mon, 1 Mar 2010 16:16:38 -0300
Subject: [Twisted-Python] Modifying Echo example
Message-ID: <991CD5EE-35FA-47F7-B2F5-1333B0F3CB87@renanfernandes.org>

Hello,

I am trying to learn about Twisted Matrix, and for that I am modifying the Echo Client & Server example to archive few goals:
From now, I have modified this example to: Make the client send some requests and have the server reply for each request.
So, for example: if the client sends "Hello!", the server will reply : "Hello, [ip address of client]".
But my point is: I can handle the communication between 1 server and 1 client only, but how Can I do if I have multiple clients connected?
My objective is: I have 4 clients connected, and I want the server to send a data to only one specific client (I will provide the ip address and port for this specific client)
I imagine that The correct way to do this is: having one thread for each client connection, and calling that specific thread to write down a message, am I correct?

Does someone has an example on how can I do that?

Thanks in advance,

Renan Mathias Fernandes






From mebly5343 at gmail.com  Mon Mar  1 14:41:44 2010
From: mebly5343 at gmail.com (Mark Bailey)
Date: Mon, 1 Mar 2010 14:41:44 -0500
Subject: [Twisted-Python] Modifying Echo example
In-Reply-To: <991CD5EE-35FA-47F7-B2F5-1333B0F3CB87@renanfernandes.org>
References: <991CD5EE-35FA-47F7-B2F5-1333B0F3CB87@renanfernandes.org>
Message-ID: <dc408fe51003011141q67f6e530l2b5b18e1452bd3bc@mail.gmail.com>

Hi Renan:

I asked almost the same question a few weeks ago.  Look at
http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother

The factory can access a list of the connections.

Mark

On Mar 1, 2010 2:24 PM, "Renan Mathias Fernandes" <renan at renanfernandes.org>
wrote:

Hello,

I am trying to learn about Twisted Matrix, and for that I am modifying the
Echo Client & Server example to archive few goals:

From renan at renanfernandes.org  Mon Mar  1 23:04:25 2010
From: renan at renanfernandes.org (Renan Mathias Fernandes)
Date: Tue, 2 Mar 2010 01:04:25 -0300
Subject: [Twisted-Python] Modifying Echo example
In-Reply-To: <dc408fe51003011141q67f6e530l2b5b18e1452bd3bc@mail.gmail.com>
References: <991CD5EE-35FA-47F7-B2F5-1333B0F3CB87@renanfernandes.org>
	<dc408fe51003011141q67f6e530l2b5b18e1452bd3bc@mail.gmail.com>
Message-ID: <89E40153-F7E5-4EEF-BCDA-29A06C11B005@renanfernandes.org>

Thank you Mark, that worked perfectly!


Renan Mathias Fernandes




On Mar 1, 2010, at 4:41 PM, Mark Bailey wrote:

> Hi Renan:
> 
> I asked almost the same question a few weeks ago.  Look at
> http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother
> 
> The factory can access a list of the connections.
> 
> Mark
> 
> 
>> On Mar 1, 2010 2:24 PM, "Renan Mathias Fernandes" <renan at renanfernandes.org> wrote:
>> 
>> Hello,
>> 
>> I am trying to learn about Twisted Matrix, and for that I am modifying the Echo Client & Server example to archive few goals:
>> From now, I have modified this example to: Make the client send some requests and have the server reply for each request.
>> So, for example: if the client sends "Hello!", the server will reply : "Hello, [ip address of client]".
>> But my point is: I can handle the communication between 1 server and 1 client only, but how Can I do if I have multiple clients connected?
>> My objective is: I have 4 clients connected, and I want the server to send a data to only one specific client (I will provide the ip address and port for this specific client)
>> I imagine that The correct way to do this is: having one thread for each client connection, and calling that specific thread to write down a message, am I correct?
>> 
>> Does someone has an example on how can I do that?
>> 
>> Thanks in advance,
>> 
>> Renan Mathias Fernandes
>> 
>> 
>> 
>> 
>> 
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From kamil at lucem.pl  Tue Mar  2 05:20:02 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Tue, 2 Mar 2010 11:20:02 +0100
Subject: [Twisted-Python] WSDL Proxy Send variable names
Message-ID: <eeca458e1003020220u7272cfffn6ba39f0b9644539e@mail.gmail.com>

Hi,
 I need to be able to send variable names when sending requests to a SOAP
server. Currently SOAPpy sends my variables automatically named as v1, v2,
v3. The server requires they have a name varNameA, varNameB etc.
Here is my outgoing SOAP and code.

wsdlFile = "http://webapi.allegro.pl/uploader.php?wsdl"
server = WSDL.Proxy(wsdlFile)
server.doGetCountries(1, h23dk99sd)


*** Outgoing SOAP ******************************************************
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope SOAP-ENV:encodingStyle="
http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENC="
http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="
http://www.w3.org/1999/XMLSchema-instance" xmlns:SOAP-ENV="
http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="
http://www.w3.org/1999/XMLSchema">
<SOAP-ENV:Body>
<ns1:doGetCountries xmlns:ns1="urn:AllegroWebApi" SOAP-ENC:root="1">
<v1 xsi:type="xsd:int">1</v1>
<v2 xsi:type="xsd:string">h23dk99sd</v2>
</ns1:doGetCountries>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
************************************************************************

This is what the variable area should look like:
<country-code xsi:type="xsd:int">1</country-code>
<webapi-key xsi:type="xsd:string">h23dk99sd</webapi-key>

How do i accomplish this? (Wrapping it in a dictionary only sends the
dictionary as v1)

Thank you!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100302/6c69f259/attachment.htm 

From landreville at deadtreepages.com  Tue Mar  2 09:48:36 2010
From: landreville at deadtreepages.com (Landreville)
Date: Tue, 2 Mar 2010 09:48:36 -0500
Subject: [Twisted-Python] WSDL Proxy Send variable names
In-Reply-To: <eeca458e1003020220u7272cfffn6ba39f0b9644539e@mail.gmail.com>
References: <eeca458e1003020220u7272cfffn6ba39f0b9644539e@mail.gmail.com>
Message-ID: <9d748c781003020648s6f5de7acu996a36918d20b71@mail.gmail.com>

On Tue, Mar 2, 2010 at 5:20 AM, Kamil Wasilewski <kamil at lucem.pl> wrote:
> Hi,
> ?I need to be able to send variable names when sending requests to a SOAP
> server. Currently SOAPpy sends my variables automatically named as v1, v2,
> v3. The server requires they have a name varNameA, varNameB etc.
> Here is my outgoing SOAP and code.
>

I played around with SOAPpy a couple months ago; I'm fairly sure that
it does order-based parameters by default and I don't remember finding
a way to use named parameters.

There is another SOAP library called ZSI that might have that (it's
not integrated with Twisted though).


From kamil at lucem.pl  Tue Mar  2 10:09:39 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Tue, 2 Mar 2010 16:09:39 +0100
Subject: [Twisted-Python] WSDL Proxy Send variable names
In-Reply-To: <9d748c781003020648s6f5de7acu996a36918d20b71@mail.gmail.com>
References: <eeca458e1003020220u7272cfffn6ba39f0b9644539e@mail.gmail.com>
	<9d748c781003020648s6f5de7acu996a36918d20b71@mail.gmail.com>
Message-ID: <eeca458e1003020709t3b1514c6y2de9f5241e38cb8a@mail.gmail.com>

On Tue, Mar 2, 2010 at 3:48 PM, Landreville
<landreville at deadtreepages.com>wrote:

> On Tue, Mar 2, 2010 at 5:20 AM, Kamil Wasilewski <kamil at lucem.pl> wrote:
> > Hi,
> >  I need to be able to send variable names when sending requests to a SOAP
> > server. Currently SOAPpy sends my variables automatically named as v1,
> v2,
> > v3. The server requires they have a name varNameA, varNameB etc.
> > Here is my outgoing SOAP and code.
> >
>
> I played around with SOAPpy a couple months ago; I'm fairly sure that
> it does order-based parameters by default and I don't remember finding
> a way to use named parameters.
>
> There is another SOAP library called ZSI that might have that (it's
> not integrated with Twisted though).
>
>
Yes it does order them correctly if you just call
server.doFunction(param1, param2), but assignes them names v1, v2..
But i found a way to name (and order) them
 http://ungil.com/remedy/webservices.html

# Define the order of args: needed for this service
server.config.argsOrdering = {'doFunction': ('id', 'code') }
response = server.doFunction(code=sc, id=gi )

Notice however that i need to name my parameters with a '-' in the middle:
country-code, webapi-key and the above naming method gives me errors. if the
variables were country_code it would be a different story.

Any idea how to get around this?
Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100302/77462b95/attachment-0001.htm 

From jml at mumak.net  Tue Mar  2 10:17:40 2010
From: jml at mumak.net (Jonathan Lange)
Date: Tue, 2 Mar 2010 15:17:40 +0000
Subject: [Twisted-Python] PyCon 2010 sprint report
Message-ID: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>

Residents of the once-great city of Atlanta are only now beginning to piece
their lives back together after the event that Glyph Lefkowitz described as
"the best Twisted sprint ever".

Quite apart from the unprecedented levels of wanton destruction, Twisted's
PyCon 2010 sprint was also better attended than any previous sprints, which
have laid waste to the outskirts of Boston, inner-city Dallas and regions of
Australia.

At its peak, there were eighteen people seated around the two tables where the
sprint took place. People even joined in remotely, working with the Atlanta
team through #twisted on freenode.

Although buried deep within a secret bunker in Atlanta, the sprint still
managed to attract a fair number of new contributors and Twisted users who
wanted to help out.

Attendees who made themselves known to your correspondent include:
 * Jonathan Lange
 * Jean-Paul Calderone
 * David Reid
 * Thomas Herv?
 * Tim Couper
 * Pavel Pergamenshchik
 * Maciej Fijalkowski
 * Glyph Lefkowitz
 * Itamar Turner-Trauring
 * Terry Jones

jesstess, ralphm and spiv also participated remotely.

Attendees all had immense fun and expressed a desire to have another sprint
soon. One observed that it had been far too long since giant mecha robot
warriors descended on Paris.

Twisted prevails,
jml


More simply, we had a great time at the sprint and got a ridiculous amount of
stuff done.

We fixed many, many bugs, including all of the known regressions since the 9.0
release. Once we fixed the regressions, we started work on getting the first
10.0 pre-release out the door.

The pre-release probably would not have been possible without the sprint since
it allowed the new release manager ready access to Jean-Paul, who has quite a
lot of knowledge stuck in his head. One result of this is a new release
process document, which is being developed at
http://twistedmatrix.com/trac/wiki/ReleaseProcess alongside the actual 10.0
release.

We also reached an in-principle agreement to aim for a release every three
months. This means that although hardly any of the good work from the sprint
is in the 10.0 release, you won't have to wait long for it to appear in 10.1.
Hopefully. I plan write up how this will work as soon as the 10.0 release is
done.

The sprint proved to be a perfect opportunity to talk about some of the more
gutly bits of Twisted, including Deferred cancellation (see #990) and
endpoints (see #1442). The former is done, and the latter has made good
progress. Stay tuned.

Thomas Herv? did a lot of work on upgrading our Trac instance, which was
getting kind of old and currently crashes all of the time.

We talked a bit about how we could make it easier for people to contribute to
Twisted without compromising our high standards of quality. We put as many of
the ideas that we could remember on to
http://twistedmatrix.com/trac/wiki/ContributionIdeas.

Maciej Fijalkowski was at the sprint working on getting PyPy benchmarks for
Twisted and on making PyPy work faster with Twisted. Personally, it's really
exciting to see PyPy live up to its promise of a faster Python, particularly
with a big codebase like Twisted.

As I said, we fixed lots of bugs. Here's the complete list:

 * #4179 - HTTP proxy hanging in Twisted 9.0
 * #3056 - twisted.spread.pb.IUsernameMD5Password's docstring should
           say it accepts an MD5 digest of a password, not plaintext
 * #3289 - startLoggingWithObserver raises IndexError
 * #4178 - Function singleSearchStep was renamed to _singleSearchStep
           not everywhere
 * #4192 - Move the content from exarkun's Twisted Web in 60 Seconds
           series into the Twisted Web howto
 * #4284 - t.e.adbapi leaks threads
 * #4282 - _release.filePathDelta is broken
 * #3718 - twisted.internet.posixbase._Waker not defined on Jython
 * #4143 - twisted.web.wsgi incorrectly unquotes QUERY_STRING
 * #4255 - BaseLogFile should provide a method to reopen logs
 * #972  - Add linux inotify support to twisted core
 * #2367 - twisted.test.test_failure.FailureTestCase.testBrokenStr breaks
           #trial in debug mode
 * #1083 - gtk2reactor thread initialization confuses python-2.3
 * #3462 - FTP server: upload should support async close
 * #990  - Deferred cancellation
 * #733  - twisted's SIGCHLD handler breaks popen.
 * #2376 - release-twisted should generate guides with links to API docs
 * #4272 - flavors.py still talks about getObjectAt
 * #4172 - UDP crashes python.exe when using IOCPReactor
 * #3925 - test_addresses fails with Glib2 and Gtk2 reactors
 * #4255 - BaseLogFile should provide a method to reopen logs
 * #4293 - Update links in testing documentation
 * #4311 - XMPP Stanza Error 'remote-server-timeout' yield no type and code
 * #3811 - Allow aborting HTTP client connections in the _newclient API

We also worked on:
 * Getting rid of 3k warnings and generally doing 2to3
 * Event support for iocpreactor
 * Making Deferreds more iterative (see #411)
 * Twisted Web features and bug fixes
 * Fixing obscure Windows/gtk2 compatibility issues

Thank you very much to PyCon US, the Python Software Foundation and the many
sponsors of the Twisted Software Foundation for their hard-work and support in
making this all possible.

Thanks also to the attendees for making it such a blast.

If you want to encourage more of this sort of behaviour, then please donate to
the Twisted Software Foundation:

  http://twistedmatrix.com/trac/wiki/TwistedSoftwareFoundation#HowtoDonate

jml


From jml at mumak.net  Tue Mar  2 11:04:41 2010
From: jml at mumak.net (Jonathan Lange)
Date: Tue, 2 Mar 2010 16:04:41 +0000
Subject: [Twisted-Python] PyCon 2010 sprint report
In-Reply-To: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
References: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
Message-ID: <d06a5cd31003020804xefaba65ge453c1adc411cd29@mail.gmail.com>

On Tue, Mar 2, 2010 at 3:17 PM, Jonathan Lange <jml at mumak.net> wrote:
...
>
> jesstess, ralphm and spiv also participated remotely.

Jessica McKellar, Ralph Meijer and Andrew Bennetts respectively.

jml


From nathan.stocks at gmail.com  Tue Mar  2 11:31:32 2010
From: nathan.stocks at gmail.com (Nathan)
Date: Tue, 2 Mar 2010 09:31:32 -0700
Subject: [Twisted-Python] PyCon 2010 sprint report
In-Reply-To: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
References: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
Message-ID: <96c9d6a81003020831y7b1cc2e5ydb150be39efbeb29@mail.gmail.com>

On Tue, Mar 2, 2010 at 8:17 AM, Jonathan Lange <jml at mumak.net> wrote:
> More simply, we had a great time at the sprint and got a ridiculous amount of
> stuff done.
>
> We fixed many, many bugs, including all of the known regressions since the 9.0
> release. Once we fixed the regressions, we started work on getting the first
> 10.0 pre-release out the door.

Awesome!

~ Nathan


From markscottwright at gmail.com  Tue Mar  2 13:27:11 2010
From: markscottwright at gmail.com (markscottwright at gmail.com)
Date: Tue, 02 Mar 2010 18:27:11 +0000
Subject: [Twisted-Python] Does the default session expiry work?
Message-ID: <0016e6480da6a3a04c0480d58337@google.com>

I'm using twisted 8.2 and (after reading glyph's latest "Twisted in 60  
seconds" entry), I've realized that my sessions never expire. I never added  
any session expiration code, but I thought that the default code expires  
after 15 minutes.

In the below example, I modified twisted\web\server to make  
Session.sessionTimeout be 30 seconds (I also put a print statement in  
Session's ctor, as the log shows), then did two GETs separated by more than  
30 seconds. As the log shows, it looks like the exact same session uid is  
being returned. I would expect it to be deleted by Session.expire, since  
time - lastModifiedTime > 30. Am I missing something?

import sys
from twisted.web import server, static
from twisted.web.resource import Resource
from twisted.web.server import Session, NOT_DONE_YET
from twisted.internet import reactor, ssl
from twisted.python import log

class TestSessionResource(Resource):
isLeaf = True
def render_GET(self, request):
session = request.getSession()
print session.sessionTimeout
print session.uid
print session
return "<html><body><p>Session Test</p></body></html>"

root = TestSessionResource()
reactor.listenTCP(9000, server.Site(root))
log.startLogging(sys.stdout)
reactor.run()

2010-03-02 12:16:49-0600 [-] Log opened.
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] making a new session!!!
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
<twisted.web.server.Session instance at 0x01042AD0>
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:16:51 +0000] "GET / HTTP/1.1" 200 45 "-" "Mozilla/5.0  
(Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5 (KHTML, like Gecko)  
Chrome/4.0.249.89 Safari/532.5"

2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
<twisted.web.server.Session instance at 0x01042AD0>
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:16:51 +0000] "GET /favicon.ico HTTP/1.1" 200  
45 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5  
(KHTML, like Gecko) Chrome/4.0.249.89 Safari/532.5"
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
<twisted.web.server.Session instance at 0x01042AD0>
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:17:44 +0000] "GET / HTTP/1.1" 200 45 "-" "Mozilla/5.0  
(Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5 (KHTML, like Gecko)  
Chrome/4.0.249.89 Safari/532.5"

2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
<twisted.web.server.Session instance at 0x01042AD0>
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:17:44 +0000] "GET /favicon.ico HTTP/1.1" 200  
45 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5  
(KHTML, like Gecko) Chrome/4.0.249.89 Safari/532.5"
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100302/66497098/attachment.htm 

From maarten at treewalker.org  Tue Mar  2 13:55:49 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Tue, 2 Mar 2010 19:55:49 +0100
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <0016e6480da6a3a04c0480d58337@google.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
Message-ID: <201003021955.49868.maarten@treewalker.org>

On Tuesday 02 March 2010, markscottwright at gmail.com wrote:

> I'm using twisted 8.2 and (after reading glyph's latest "Twisted in 60
> seconds" entry), I've realized that my sessions never expire. I never
> added any session expiration code, but I thought that the default code
> expires after 15 minutes.
> 
> In the below example, I modified twisted\web\server to make
> Session.sessionTimeout be 30 seconds (I also put a print statement in
> Session's ctor, as the log shows), then did two GETs separated by more
> than 30 seconds. As the log shows, it looks like the exact same session
> uid is being returned. I would expect it to be deleted by
> Session.expire, since time - lastModifiedTime > 30. Am I missing
> something?

Maybe you are encountering bug 3458?

http://twistedmatrix.com/trac/ticket/3458

If so, upgrading Twisted would help.

Bye,
		Maarten


From renan at renanfernandes.org  Tue Mar  2 14:09:38 2010
From: renan at renanfernandes.org (Renan Mathias Fernandes)
Date: Tue, 2 Mar 2010 16:09:38 -0300
Subject: [Twisted-Python] qtreactor and Linux problems
Message-ID: <F705D498-9C52-4C18-A788-EF807857DAEE@renanfernandes.org>

Hello Guys,

	I am trying to learn how to use the qtreactor (I am using pyQT and TwistedMatrix) but i am facing few issues.
	I created a simple Ui, just a MainWindow and a QTreeWidget.
	The point is: I can execute and See my MainWindow using the code below under Mac OS X, but if I execute the same code on Linux, it will show me only the window, without the QTreeWidget.
	I noticied that the issue is under the install() method, since I can see the Window correctly if I remove the install() method.
	Does anyone know if I am missing something?

# -*- coding: utf-8 -*-
 
"""The user interface for our app"""
 
import os,sys

from qt4reactor import install; 
from PyQt4 import QtCore,QtGui
from windowUi import Ui_MainWindow
 
class Main(QtGui.QMainWindow):
    def __init__(self):
        QtGui.QMainWindow.__init__(self)
        self.ui=Ui_MainWindow()
        self.ui.setupUi(self)
 
def main():
    app = QtGui.QApplication(sys.argv)
    qt4reactor.install()
    window=Main()
    window.show()
    from twisted.internet import reactor
    reactor.run()
    sys.exit(app.exec_())
    
 
if __name__ == "__main__":
    main()
    


Thanks
Renan Mathias Fernandes






From fred at bsdhost.net  Tue Mar  2 14:19:32 2010
From: fred at bsdhost.net (Fred C)
Date: Tue, 2 Mar 2010 11:19:32 -0800
Subject: [Twisted-Python] Reverse HTTP proxy code review
Message-ID: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>


Hello,

I am totally new with Twisted and this the first code I have ever written using that package. One of my main problem was to figure out how to fit things together and I am not even sure I understand everything I am doing here.

Anyway, for a project I have to write a proxy that figure out where is located a resource by requesting a database. then figure out if the resource is accessible and them open a proxy connection to download that resource.

I was wandering if there is someone in that mailing list who can review that code and tell me how I can improve things. I know I am not accessing the database the right way but I can't figure out how to work with the Callbacks. 

Any help or advice will be very much appreciated. The code is available here: http://pastebin.com/BGcqzh4Y

-fred-

-- 
http://kiq.me/oi

From glyph at twistedmatrix.com  Tue Mar  2 14:30:37 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 2 Mar 2010 14:30:37 -0500
Subject: [Twisted-Python] PyCon 2010 sprint report
In-Reply-To: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
References: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
Message-ID: <1F2EF899-85FC-4FE6-AB9A-D25B041B1ADE@twistedmatrix.com>

On Mar 2, 2010, at 10:17 AM, Jonathan Lange wrote:

> Residents of the once-great city of Atlanta are only now beginning to piece
> their lives back together after the event that Glyph Lefkowitz described as
> "the best Twisted sprint ever".


This really was a great sprint.

Thanks very much to everyone who attended, and who participated remotely.  Everyone really pitched in to make this what it was.

Thanks especially to you Jonathan, for *both* managing the 10.0 release and writing up this great sprint report.

> Attendees all had immense fun and expressed a desire to have another sprint
> soon. One observed that it had been far too long since giant mecha robot
> warriors descended on Paris.

My Guymelef is in storage on the outskirts of Lyon, but I think I could have it shipped to Paris with a bit of advance notice.

> Twisted prevails,
> jml

Strength through unity.  Unity through IProtocol.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100302/e74127ca/attachment.htm 

From glyph at twistedmatrix.com  Tue Mar  2 14:33:11 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 2 Mar 2010 14:33:11 -0500
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <0016e6480da6a3a04c0480d58337@google.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
Message-ID: <F84B6FCB-38EE-4F74-8E9D-3700F5F91D1B@twistedmatrix.com>


On Mar 2, 2010, at 1:27 PM, markscottwright at gmail.com wrote:

> after reading glyph's latest "Twisted in 60 seconds" entry

While I'd love to take credit, as this is an excellent series, these articles are written by Jean-Paul Calderone ("exarkun"), not me! :)

From markscottwright at gmail.com  Tue Mar  2 15:03:08 2010
From: markscottwright at gmail.com (Mark Wright)
Date: Tue, 2 Mar 2010 14:03:08 -0600
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <F84B6FCB-38EE-4F74-8E9D-3700F5F91D1B@twistedmatrix.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<F84B6FCB-38EE-4F74-8E9D-3700F5F91D1B@twistedmatrix.com>
Message-ID: <db986be81003021203s7f9ef869ha470490e5533553b@mail.gmail.com>

Oops!  Sorry.

And, yes - that series is just wonderful.  So clear and well written,
and exactly what I've needed.  Thank you exarkun!

On Tue, Mar 2, 2010 at 1:33 PM, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
>
> On Mar 2, 2010, at 1:27 PM, markscottwright at gmail.com wrote:
>
>> after reading glyph's latest "Twisted in 60 seconds" entry
>
> While I'd love to take credit, as this is an excellent series, these articles are written by Jean-Paul Calderone ("exarkun"), not me! :)
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Mark Wright
markscottwright at gmail.com


From markscottwright at gmail.com  Tue Mar  2 15:07:04 2010
From: markscottwright at gmail.com (Mark Wright)
Date: Tue, 2 Mar 2010 14:07:04 -0600
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <201003021955.49868.maarten@treewalker.org>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
Message-ID: <db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>

On Tue, Mar 2, 2010 at 12:55 PM, Maarten ter Huurne
<maarten at treewalker.org> wrote:
> On Tuesday 02 March 2010, markscottwright at gmail.com wrote:
>
>> I'm using twisted 8.2 and (after reading glyph's latest "Twisted in 60
>> seconds" entry), I've realized that my sessions never expire. I never
>> added any session expiration code, but I thought that the default code
>> expires after 15 minutes.
>>
>> In the below example, I modified twisted\web\server to make
>> Session.sessionTimeout be 30 seconds (I also put a print statement in
>> Session's ctor, as the log shows), then did two GETs separated by more
>> than 30 seconds. As the log shows, it looks like the exact same session
>> uid is being returned. I would expect it to be deleted by
>> Session.expire, since time - lastModifiedTime > 30. Am I missing
>> something?
>
> Maybe you are encountering bug 3458?
>
> http://twistedmatrix.com/trac/ticket/3458
>
> If so, upgrading Twisted would help.
>
> Bye,
> ? ? ? ? ? ? ? ?Maarten

Thanks, that looks like a likely culprit.  Please forgive me if this
is more of a Trac than Twisted question, but how do I go from a trac
ticket to a twisted version number?  It's not clear to me from reading
that ticket if 9.0 is good enough for me, or if I need to pull the svn
tip.

-- 
Mark Wright
markscottwright at gmail.com


From kevin.horn at gmail.com  Tue Mar  2 15:45:23 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Tue, 2 Mar 2010 14:45:23 -0600
Subject: [Twisted-Python] Reverse HTTP proxy code review
In-Reply-To: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>
References: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>
Message-ID: <562bcc11003021245m7bf8eddfl588e3154a1c0150a@mail.gmail.com>

On Tue, Mar 2, 2010 at 1:19 PM, Fred C <fred at bsdhost.net> wrote:

>
> Hello,
>
> I am totally new with Twisted and this the first code I have ever written
> using that package. One of my main problem was to figure out how to fit
> things together and I am not even sure I understand everything I am doing
> here.
>
> Anyway, for a project I have to write a proxy that figure out where is
> located a resource by requesting a database. then figure out if the resource
> is accessible and them open a proxy connection to download that resource.
>
> I was wandering if there is someone in that mailing list who can review
> that code and tell me how I can improve things. I know I am not accessing
> the database the right way but I can't figure out how to work with the
> Callbacks.
>
> Any help or advice will be very much appreciated. The code is available
> here: http://pastebin.com/BGcqzh4Y
>
> -fred-
>
>
I don't really use Twisted for web work, so I don't have much of a comment
on that, but for database access you probably want to use
`twisted.enterprise.adbapi`.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100302/ede6642c/attachment.htm 

From fred at bsdhost.net  Tue Mar  2 16:00:07 2010
From: fred at bsdhost.net (Fred C)
Date: Tue, 2 Mar 2010 13:00:07 -0800
Subject: [Twisted-Python] Reverse HTTP proxy code review
In-Reply-To: <562bcc11003021245m7bf8eddfl588e3154a1c0150a@mail.gmail.com>
References: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>
	<562bcc11003021245m7bf8eddfl588e3154a1c0150a@mail.gmail.com>
Message-ID: <6F36A29F-6B8F-4E30-A07A-CCF0C6333F2E@bsdhost.net>


On Mar 2, 2010, at 12:45 PM, Kevin Horn wrote:

> On Tue, Mar 2, 2010 at 1:19 PM, Fred C <fred at bsdhost.net> wrote:
> 
> Hello,
> 
> I am totally new with Twisted and this the first code I have ever written using that package. One of my main problem was to figure out how to fit things together and I am not even sure I understand everything I am doing here.
> 
> Anyway, for a project I have to write a proxy that figure out where is located a resource by requesting a database. then figure out if the resource is accessible and them open a proxy connection to download that resource.
> 
> I was wandering if there is someone in that mailing list who can review that code and tell me how I can improve things. I know I am not accessing the database the right way but I can't figure out how to work with the Callbacks.
> 
> Any help or advice will be very much appreciated. The code is available here: http://pastebin.com/BGcqzh4Y
> 
> -fred-
> 
> 
> I don't really use Twisted for web work, so I don't have much of a comment on that, but for database access you probably want to use `twisted.enterprise.adbapi`.


That was of the thing I know it's wrong with my code. I have to use adbapi and have a call back to get the result from the database. My main problem in that case is I don't know how to have the caller wait for the response from the database.

Thanks for taking time to look at that code and for your reply.

-fred-
http://kiq.me/oi

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100302/377e00a3/attachment.htm 

From kevin.horn at gmail.com  Tue Mar  2 16:17:41 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Tue, 2 Mar 2010 15:17:41 -0600
Subject: [Twisted-Python] Reverse HTTP proxy code review
In-Reply-To: <6F36A29F-6B8F-4E30-A07A-CCF0C6333F2E@bsdhost.net>
References: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>
	<562bcc11003021245m7bf8eddfl588e3154a1c0150a@mail.gmail.com>
	<6F36A29F-6B8F-4E30-A07A-CCF0C6333F2E@bsdhost.net>
Message-ID: <562bcc11003021317h605aaea2i73b980cbab567bdc@mail.gmail.com>

On Tue, Mar 2, 2010 at 3:00 PM, Fred C <fred at bsdhost.net> wrote:

>
> On Mar 2, 2010, at 12:45 PM, Kevin Horn wrote:
>
> On Tue, Mar 2, 2010 at 1:19 PM, Fred C <fred at bsdhost.net> wrote:
>
>>
>> Hello,
>>
>> I am totally new with Twisted and this the first code I have ever written
>> using that package. One of my main problem was to figure out how to fit
>> things together and I am not even sure I understand everything I am doing
>> here.
>>
>> Anyway, for a project I have to write a proxy that figure out where is
>> located a resource by requesting a database. then figure out if the resource
>> is accessible and them open a proxy connection to download that resource.
>>
>> I was wandering if there is someone in that mailing list who can review
>> that code and tell me how I can improve things. I know I am not accessing
>> the database the right way but I can't figure out how to work with the
>> Callbacks.
>>
>> Any help or advice will be very much appreciated. The code is available
>> here: http://pastebin.com/BGcqzh4Y
>>
>> -fred-
>>
>>
> I don't really use Twisted for web work, so I don't have much of a comment
> on that, but for database access you probably want to use
> `twisted.enterprise.adbapi`.
>
>
>
> That was of the thing I know it's wrong with my code. I have to use adbapi
> and have a call back to get the result from the database. My main problem in
> that case is I don't know how to have the caller wait for the response from
> the database.
>
> Thanks for taking time to look at that code and for your reply.
>
> -fred-
> http://kiq.me/oi
>
>
>
Have a look at:
http://twistedsphinx.funsize.net/projects/core/howto/rdbms.html#how-do-i-use-adbapi

Basically, when you call runQuery, you get back a deferred object.  You'll
want to add a callback to that using something like:

def get_stuff_from_db():
    d = dbpool.runQuery('Your SQL Here')
    d.addCallback(your_callback_function)

def your_callback_function(results):
    # do some stuff with your results

so when the DB query completes, your_callback_function will get called
automatically by the deferred object.

Obviously this is very rough, probably incorrect code, but hopefully it's
enough to get you started.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100302/59b34011/attachment.htm 

From maarten at treewalker.org  Tue Mar  2 18:40:59 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Wed, 3 Mar 2010 00:40:59 +0100
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
Message-ID: <201003030040.59900.maarten@treewalker.org>

On Tuesday 02 March 2010, Mark Wright wrote:
> On Tue, Mar 2, 2010 at 12:55 PM, Maarten ter Huurne
> <maarten at treewalker.org> wrote:
> > Maybe you are encountering bug 3458?
> > 
> > http://twistedmatrix.com/trac/ticket/3458
> > 
> > If so, upgrading Twisted would help.
> 
> Thanks, that looks like a likely culprit.  Please forgive me if this
> is more of a Trac than Twisted question, but how do I go from a trac
> ticket to a twisted version number?  It's not clear to me from reading
> that ticket if 9.0 is good enough for me, or if I need to pull the svn
> tip.

I don't know of a guaranteed algorithm to find out in which release a fix is 
included. If someone knows, please enlighten me. I think SVN does not make 
this easy, since it copies changes around instead of linking to the original 
patch.

Some searching turns up the following though:

tags / releases / twisted-8.2.0 was created 2008-12-28
tags / releases / twisted-9.0.0 was created 2009-11-25

Jean-Paul merged the fix for ticket #3458 to trunk in revision r26133, which 
was committed 2009-01-28. So I would expect 9.0.0 to be the first release 
with the fix.

Bye,
		Maarten


From wthie at thiengineering.ch  Wed Mar  3 13:56:38 2010
From: wthie at thiengineering.ch (Werner Thie)
Date: Wed, 03 Mar 2010 19:56:38 +0100
Subject: [Twisted-Python] twisted xmpp-router component interface problem
In-Reply-To: <201003030040.59900.maarten@treewalker.org>
References: <0016e6480da6a3a04c0480d58337@google.com>	<201003021955.49868.maarten@treewalker.org>	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
	<201003030040.59900.maarten@treewalker.org>
Message-ID: <4B8EB0E6.10400@thiengineering.ch>

Hi

Starting twistd xmpp-router and trying to connect to it with a component 
from the wokkel examples

"""
An XMPP Ping server as an external server-side component.

This ping server assumes the domain C{'ping'}.
"""
import sys

from twisted.python import log
from twisted.application import app, service, internet
from twisted.internet import reactor

from wokkel import component
from wokkel.ping import PingHandler

# Configuration parameters
EXT_HOST = 'localhost'
EXT_PORT = 5347
SECRET = 'secret'
DOMAIN = 'ping'
LOG_TRAFFIC = True

# Set up the Twisted application
application = service.Application("Ping Component")

router = component.Router()
pingComponent = component.Component(EXT_HOST, EXT_PORT, DOMAIN, SECRET)
pingComponent.logTraffic = LOG_TRAFFIC
pingComponent.setServiceParent(application)

pingHandler = PingHandler()
pingHandler.setHandlerParent(pingComponent)

produces the following traceback:

2010-03-03 19:24:28+0100 [XmlStream,0,127.0.0.1] Unhandled Error
         Traceback (most recent call last):
           File 
"\proj\Python-2.5.2\stackless-2.5.2-r63812\Modules\pyexpat.c", line 656, 
in EndElement
             ("(N)", string_intern(self, name)))
           File "C:\proj\twisted\twisted\words\xish\domish.py", line 
797, in _onEndElement
             self.ElementEvent(self.currElem)
           File "C:\proj\twisted\twisted\words\xish\xmlstream.py", line 
107, in onElement
             self.dispatch(element)
           File "C:\proj\twisted\twisted\words\xish\utility.py", line 
317, in dispatch
             callbacklist.callback(obj)
         --- <exception caught here> ---
           File "C:\proj\twisted\twisted\words\xish\utility.py", line 
107, in callback
             methodwrapper(*args, **kwargs)
           File "C:\proj\twisted\twisted\words\xish\utility.py", line 
27, in __call__
             self.method(*nargs, **nkwargs)
           File 
"C:\proj\twisted\twisted\words\protocols\jabber\component.py", line 171, 
in onElement
             self.onHandshake(unicode(element))
           File 
"C:\proj\twisted\twisted\words\protocols\jabber\component.py", line 187, 
in onHandshake
             unicode(self.secret))
           File 
"C:\proj\twisted\twisted\words\protocols\jabber\xmlstream.py", line 52, 
in hashPassword
             raise TypeError("The session identifier must be a unicode 
object")
         exceptions.TypeError: The session identifier must be a unicode 
object

After some fiddling around it seems that the code at line 282 in 
twisted\words\protocols\jabber\xmlstream.py presets the sid of the 
stream to a str instead of a unicode(str). After changing line 282
from

self.xmlstream.sid = randbytes.secureRandom(8).encode('hex')

to

self.xmlstream.sid = unicode(randbytes.secureRandom(8).encode('hex'))

everything works as advertised.

Is there somebody around who could tell me what to do with this fix, I'm 
certainly a beginner diddling with XMPP.

Thanks a bunch, Werner




From drew.smathers at gmail.com  Wed Mar  3 14:32:39 2010
From: drew.smathers at gmail.com (Drew Smathers)
Date: Wed, 3 Mar 2010 14:32:39 -0500
Subject: [Twisted-Python] twisted xmpp-router component interface problem
In-Reply-To: <4B8EB0E6.10400@thiengineering.ch>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
	<201003030040.59900.maarten@treewalker.org>
	<4B8EB0E6.10400@thiengineering.ch>
Message-ID: <368574aa1003031132w5b11e626l74becd71f3b89588@mail.gmail.com>

On Wed, Mar 3, 2010 at 1:56 PM, Werner Thie <wthie at thiengineering.ch> wrote:

> Hi
>
> Starting twistd xmpp-router and trying to connect to it with a component
> from the wokkel examples
>
> """
> An XMPP Ping server as an external server-side component.
>
> This ping server assumes the domain C{'ping'}.
> """
> import sys
>
> from twisted.python import log
> from twisted.application import app, service, internet
> from twisted.internet import reactor
>
> from wokkel import component
> from wokkel.ping import PingHandler
>
> # Configuration parameters
> EXT_HOST = 'localhost'
> EXT_PORT = 5347
> SECRET = 'secret'
> DOMAIN = 'ping'
> LOG_TRAFFIC = True
>
> # Set up the Twisted application
> application = service.Application("Ping Component")
>
> router = component.Router()
> pingComponent = component.Component(EXT_HOST, EXT_PORT, DOMAIN, SECRET)
> pingComponent.logTraffic = LOG_TRAFFIC
> pingComponent.setServiceParent(application)
>
> pingHandler = PingHandler()
> pingHandler.setHandlerParent(pingComponent)
>
> produces the following traceback:
>
> 2010-03-03 19:24:28+0100 [XmlStream,0,127.0.0.1] Unhandled Error
>         Traceback (most recent call last):
>           File
> "\proj\Python-2.5.2\stackless-2.5.2-r63812\Modules\pyexpat.c", line 656,
> in EndElement
>             ("(N)", string_intern(self, name)))
>           File "C:\proj\twisted\twisted\words\xish\domish.py", line
> 797, in _onEndElement
>             self.ElementEvent(self.currElem)
>           File "C:\proj\twisted\twisted\words\xish\xmlstream.py", line
> 107, in onElement
>             self.dispatch(element)
>           File "C:\proj\twisted\twisted\words\xish\utility.py", line
> 317, in dispatch
>             callbacklist.callback(obj)
>         --- <exception caught here> ---
>           File "C:\proj\twisted\twisted\words\xish\utility.py", line
> 107, in callback
>             methodwrapper(*args, **kwargs)
>           File "C:\proj\twisted\twisted\words\xish\utility.py", line
> 27, in __call__
>             self.method(*nargs, **nkwargs)
>           File
> "C:\proj\twisted\twisted\words\protocols\jabber\component.py", line 171,
> in onElement
>             self.onHandshake(unicode(element))
>           File
> "C:\proj\twisted\twisted\words\protocols\jabber\component.py", line 187,
> in onHandshake
>             unicode(self.secret))
>           File
> "C:\proj\twisted\twisted\words\protocols\jabber\xmlstream.py", line 52,
> in hashPassword
>             raise TypeError("The session identifier must be a unicode
> object")
>         exceptions.TypeError: The session identifier must be a unicode
> object
>
> After some fiddling around it seems that the code at line 282 in
> twisted\words\protocols\jabber\xmlstream.py presets the sid of the
> stream to a str instead of a unicode(str). After changing line 282
> from
>
> self.xmlstream.sid = randbytes.secureRandom(8).encode('hex')
>
> to
>
> self.xmlstream.sid = unicode(randbytes.secureRandom(8).encode('hex'))
>
> everything works as advertised.
>
> Is there somebody around who could tell me what to do with this fix, I'm
> certainly a beginner diddling with XMPP.
>
> Thanks a bunch, Werner
>
>
>

Hello Werner,

I do not know anything about twisted.words, but you should file a bug report
in trac:

http://twistedmatrix.com/trac/report

Just out of curiosity, I did look at xmlstream and the whole unicode type
checking seems unnecessary considering how the values are used:

input = u"%s%s" % (sid, password)

Why sid and password have to be unicode objects and not just basestring
beats me.

-Drew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100303/f0405a22/attachment.htm 

From twisted at ralphm.ik.nu  Wed Mar  3 16:25:56 2010
From: twisted at ralphm.ik.nu (Ralph Meijer)
Date: Wed, 03 Mar 2010 22:25:56 +0100
Subject: [Twisted-Python] twisted xmpp-router component interface problem
In-Reply-To: <368574aa1003031132w5b11e626l74becd71f3b89588@mail.gmail.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
	<201003030040.59900.maarten@treewalker.org>
	<4B8EB0E6.10400@thiengineering.ch>
	<368574aa1003031132w5b11e626l74becd71f3b89588@mail.gmail.com>
Message-ID: <1267651556.5856.20.camel@dwaal>

On Wed, 2010-03-03 at 14:32 -0500, Drew Smathers wrote:
> On Wed, Mar 3, 2010 at 1:56 PM, Werner Thie <wthie at thiengineering.ch>
> wrote:
> [..]
>
>         After some fiddling around it seems that the code at line 282
>         in
>         twisted\words\protocols\jabber\xmlstream.py presets the sid of
>         the
>         stream to a str instead of a unicode(str).

Yes, this is a problem I noticed the other day as well. A ticket,
assigned to me, is in order.

> Just out of curiosity, I did look at xmlstream and the whole unicode
> type checking seems unnecessary considering how the values are used:
>
> input = u"%s%s" % (sid, password)
>
> Why sid and password have to be unicode objects and not just
> basestring beats me.

For the gory details, see http://twistedmatrix.com/trac/ticket/3847. The
short version is that digest authentication requires UTF-8 encoded input
and GTK sets Python's default encoding to UTF-8. Before these checks,
using non-ASCII characters in passwords would fail in some cases. As
both the session id and password can use the full range of unicode, it
makes sense to require that explicitly.

ralphm




From twisted at ralphm.ik.nu  Wed Mar  3 16:44:29 2010
From: twisted at ralphm.ik.nu (Ralph Meijer)
Date: Wed, 03 Mar 2010 22:44:29 +0100
Subject: [Twisted-Python] twisted xmpp-router component interface problem
In-Reply-To: <1267651556.5856.20.camel@dwaal>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
	<201003030040.59900.maarten@treewalker.org>
	<4B8EB0E6.10400@thiengineering.ch>
	<368574aa1003031132w5b11e626l74becd71f3b89588@mail.gmail.com>
	<1267651556.5856.20.camel@dwaal>
Message-ID: <1267652669.5856.22.camel@dwaal>

On Wed, 2010-03-03 at 22:25 +0100, Ralph Meijer wrote:
> On Wed, 2010-03-03 at 14:32 -0500, Drew Smathers wrote:
> > On Wed, Mar 3, 2010 at 1:56 PM, Werner Thie <wthie at thiengineering.ch>
> > wrote:
> > [..]
> >
> >         After some fiddling around it seems that the code at line 282
> >         in
> >         twisted\words\protocols\jabber\xmlstream.py presets the sid of
> >         the
> >         stream to a str instead of a unicode(str).
> 
> Yes, this is a problem I noticed the other day as well. A ticket,
> assigned to me, is in order.

I created http://twistedmatrix.com/trac/ticket/4345 for this.

ralphm



From jml at mumak.net  Wed Mar  3 18:25:36 2010
From: jml at mumak.net (Jonathan Lange)
Date: Wed, 3 Mar 2010 23:25:36 +0000
Subject: [Twisted-Python] Twisted 10.0.0 released
Message-ID: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>

On behalf of Twisted Matrix Laboratories, I am honored to announce the
release of Twisted 10.0.

Highlights include:

 * Improved documentation, including "Twisted Web in 60 seconds"

 * Faster Perspective Broker applications

 * A new Windows installer that ships without zope.interface

 * Twisted no longer supports Python 2.3

 * Over one hundred closed tickets

For more information, see the NEWS file.

It's stable, backwards compatible, well tested and in every way an
improvement. Download it now from:

 http://tmrc.mit.edu/mirror/twisted/Twisted/10.0/Twisted-10.0.0.tar.bz2 or
 http://tmrc.mit.edu/mirror/twisted/Twisted/10.0/Twisted-10.0.0.win32-py2.5.msi

Many thanks to Jean-Paul Calderone and Chris Armstrong, whose work on
release automation tools and answers to numerous questions made this
possible. Thanks also to the supporters of the Twisted Software
Foundation and to the many contributors for this release.

jml


From matusis at yahoo.com  Wed Mar  3 20:08:03 2010
From: matusis at yahoo.com (Alec Matusis)
Date: Wed, 3 Mar 2010 17:08:03 -0800
Subject: [Twisted-Python] debugging a memory leak
In-Reply-To: <20100226005059.2792.1034517271.divmod.xquotient.93@localhost.localdomain>
References: <01a701cab1b6$3a039d00$ae0ad700$@com>	<4B7F284B.70801@thiengineering.ch>	<007601cab42a$d4c755e0$7e5601a0$@com>	<201002230324.24883.maarten@treewalker.org>	<007401cab44a$42294160$c67bc420$@com>	<4B838615.8060205@thiengineering.ch>	<005701cab59c$548fdb40$fdaf91c0$@com>	<4B8722BD.2060900@densedata.com>
	<20100226005059.2792.1034517271.divmod.xquotient.93@localhost.localdomain>
Message-ID: <00a001cabb37$24787570$6d696050$@com>

It turns out that the situation described in my last email, where the server
buffers strings due to the socket Send-Q saturation never arises in our
production system, it was an artifact of high load testing in the lab
environment.

I "fixed" the memory leak, and I still do not understand what caused it. The
code looked like this:

File protocols.py:

class MyProtocol(twisted.protocols.basic.LineOnlyReceiver):

    def lineReceived(self, line):
        def login_cb(session):
            self.session = session

        #this deferred chain creates an instance of Session in the end
        d = self.factory.service.login_deferred(Callback(self), line)
        d.addErrback(twisted.python.log.err)
        #adds some properties to the session instance
        d.addCallback(self.factory.service.authenticate)
        d.addErrback(twisted.python.log.err)
        d.addCallback(login_cb)
        d.addErrback(twisted.python.log.err)

class Callback:
    def __init__(self, protocol):
        self.protocol = protocol

File service.py (protocol.factory.service):

class Session:
    def __init__(self, service, callback):
        self.callback = callback
        self.service = service

    def do_something_asynchronous(self):
        #this function creates MEMORY LEAK
        def cb(result):
            self.some_property = result
            return self

        d = some_asynch_operation()
        d.addCallback(cb)
        d.addErrback(twisted.python.log.err)

class Service:

    def login_deferred(self, callback, line):

        def cb(result):
            s = Session(self, callback)
            return s

        d = asynch_operation(line)
        d.addCallback(cb)
        d.addErrback(twisted.python.log.err)
        return d

    def authenticate(self, session):
        #the deferred below caused the MEMORY LEAK
        #when its code was moved into here from
Session.do_something_asynchronous
        #the leak disappered
        d = session.do_something_asynchronous()
        return d

The problem was in the function Session.do_something_asynchronous , that
returned the instance of its class.
Interestingly, even though this was causing an unbounded memory leak visible
from the OS, the number of objects tracked by garbage collector
len(gc.get_objects()) remained stable, and also none of the objects that had
len() were getting too long. Nothing could be seen by Heapy either,
When I removed this function, and moved its code into Service.authenticate,
the memory stabilized. I still do not quite understand why, I was just
acting on the intuition that when a function returns its class instance, it
could create a reference cycle.

After the removal of this function, the server exhibits the following
behavior: when it starts and after all clients connect and it reaches its
average load, the memory stays at 350MB for about 1.5hrs. Then it suddenly
jumps to 650MB, and stays there. Since at 350MB the server already serves
the maximum number of connection (and is operating at its normal load), I
think that the jump to 650MB is caused by some additional memory leak.
Could there be anything wrong with this code pattern, where I launch
deferreds from other deferreds (e.g. my function Service.login_deferred ,
which itself is a part of a deferred chain, launches another deferred
function cb() within itself)?

Also this code has the following reference cycle: protocol.session ->
session.callback.protocol. This cycle existed in the code for a long time
and never caused unbounded memory, even though the server creates 100 of
Session()s per sec, and they seem to be always garbage-collected (by
inspecting gc.get_objects()), even with python 2.4 before the improvements
of the cyclical garbage collector.

> -----Original Message-----
> From: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-
> bounces at twistedmatrix.com] On Behalf Of exarkun at twistedmatrix.com
> Sent: Thursday, February 25, 2010 4:51 PM
> To: Twisted general discussion
> Subject: Re: [Twisted-Python] debugging a memory leak
> 
> On 01:24 am, johann.borck at densedata.com wrote:
> >Alec Matusis wrote:
> >>In desperation of not finding the real memory leak on the production
> >>server,
> >>
> >>I wrote a test server that I can push to arbitrary high RSS memory. I
> >>am far
> >>from sure if this the same leak that I observe in production, but I
> >>would
> >>like to understand what this one is.
> >>This is the server code:
> >>
> >>Server.py:
> >>
> >>import twisted.protocols.basic
> >>from twisted.internet.protocol import Factory
> >>from twisted.internet import reactor
> >>
> >>class HiRate(twisted.protocols.basic.LineOnlyReceiver):
> >>         MAX_LENGTH = 20000
> >>
> >>         def lineReceived(self, line):
> >>                 if line == 'get':
> >>                         out = 'a'*4000+'\r\r'
> >>                         self.transport.write(out)
> >>
> >>
> >>
> >>factory = Factory()
> >>factory.protocol = HiRate
> >>
> >>reactor.listenTCP(8007, factory, backlog=50, interface='10.18.0.2')
> >>reactor.run()
> >>[...]
> >>To reproduce the memory leak, I either need two machines with fast LAN
> >>between them (since the client program takes 100% CPU), or possibly
> >>one
> >>machine with a dual core CPU (I have not tried that). It is important
> >>that
> >>client.py is given a separate CPU to run.
> >>When the length of the response from the server is sufficient,  (out =
> >>'a'*4000+'\r\r' ,  4000 is enough in my case), the RSS of the server
> >>process
> >>starts to leak without a bound.
> >>If you introduce a small delay in the client (#time.sleep(.001)), the
> >>leak
> >>does not occur.
> >Hi Alec,
> >I wouldn't call that a memory leak. In your example  ( SC/s = (n* CS) /
> >s ;  n > 1, SC: bytes sent to the client, CS: bytes sent to the server
> >)
> >there is some CS that satifies the condition SC/s > [available
> >bandwidth]. For all CS that exceed that limit, the data will be first
> >queued in the Send-Q of the socket and then inside twisted, because the
> >Send-Q is full. That's the reason why you see increasing memory usage,
> >but it's not a leak, it is a server that can not cope with this kind of
> >DOS attack. Twisted can not handle this situation for you because that
> >would mean it had to decide which packets, connections, etc. to drop.
> >Such decisions have to be made by your application.
> 
> You can get notifications about when your send buffers are full by
> registering a producer with the transport.
> http://twistedmatrix.com/documents/current/core/howto/producers.html
> describes the APIs involved.  This will help you make these decisions in
> your application.
> 
> Jean-Paul
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From bs1984 at gmail.com  Wed Mar  3 23:46:33 2010
From: bs1984 at gmail.com (Bo Shi)
Date: Wed, 3 Mar 2010 23:46:33 -0500
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
Message-ID: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>

Hi All,

I've been struggling with this issue off and on for the better part of
a month now.  Having implemented a simple git SSH server using some of
the Conch examples in the official documentation, I encountered an
issue that would cause a git client to throw an error only part of the
time.

The little program to reproduce the issue is found at

    http://gist.github.com/321403

    (raw version for download)
    http://gist.github.com/raw/321403/82ab2111a2709c8fe50a77aabb08565749087408/gitconnbug.py

and can be executed to start the sample server.  Run a command like

    # The /abspath/to/git/repo should be readable by the server user
    $ git clone ssh://user at localhost:2222/abspath/to/git/repo
    (password "user")

To test the server.  On my workstation, I am able to reproduce the
error at least once every 5 tries.  It's definitely not consistent.
The behavior I see is attached at the end of this email.  The client
fails due to a premature inConnectionLost() call in the
SSHSessionProcessProtocol that sends an EOF.


As a workaround, when TraceProcessProtocol.inConnectionLost() is
overriden to do nothing, the client error goes away.  This is somewhat
foreign territory for me so I'm not sure whether it's a bug in git or
whether it's a bug in the twisted ProcessProtocol implementation.  RFC
4254 isn't terribly helpful here:

    5.3.  Closing a Channel

       When a party will no longer send more data to a channel, it SHOULD
       send SSH_MSG_CHANNEL_EOF.

So on the surface the current behavior of sending an EOF appears fine,
however, I can't really find any definitive cases of this type of
problem popping up via, say, default OpenSSH/git combinations.


Any advice?  Is the gitconnbug.py implementation flawed?  Should I
open a ticket?  Any git experts know of a case where git-upload-pack
might close it's stdout pipe?


Thanks,
Bo


Successful case (server side logging, timestamp cut out):

    [SSHChannel session (0) on SSHService ssh-connection
    on SSHServerTransport,1,127.0.0.1] executing command
    "git-upload-pack '/Users/bshi/sandbox/poop'"
    [-] TPP.outReceived(...) 199 bytes
    [-] TPP.outReceived(...) 146 bytes
    [-] TPP.outReceived(...) 8 bytes
    [-] TPP.outReceived(...) 33 bytes
    [-] TPP.outReceived(...) 41 bytes
    [-] TPP.outReceived(...) 77 bytes
    [-] TPP.outReceived(...) 1228 bytes
    [-] TPP.outReceived(...) 8192 bytes
    [-] TPP.outReceived(...) 4567 bytes
    [-] TPP.inConnectionLost()
    [-] sending eof
    [-] exitCode: 0

Successful case (client-side shell session):

    $ GIT_TRACE=1 git clone ssh://user at localhost:2222/Users/bshi/sandbox/poop

    trace: built-in: git 'clone'
'ssh://user at localhost:2222/Users/bshi/sandbox/poop'
    Initialized empty Git repository in /tmp/poop/.git/
    trace: run_command: 'ssh' '-p' '2222' 'user at localhost' 'git-upload-pack
           '\''/Users/bshi/sandbox/poop'\'''
    user at localhost's password:
    trace: run_command: 'index-pack' '--stdin' '-v' '--fix-thin'
                        '--keep=fetch-pack 763 on Bo-Shis-MacBook-Pro.local'
    trace: exec: 'git' 'index-pack' '--stdin' '-v' '--fix-thin'
                 '--keep=fetch-pack 763 on Bo-Shis-MacBook-Pro.local'
    trace: exec: 'git-index-pack' '--stdin' '-v' '--fix-thin'
                 '--keep=fetch-pack 763 on Bo-Shis-MacBook-Pro.local'
    trace: run_command: 'git-index-pack' '--stdin' '-v' '--fix-thin'
                        '--keep=fetch-pack 763 on Bo-Shis-MacBook-Pro.local'
    remote: Counting objects: 50, done.
    remote: Compressing objects: 100% (35/35), done.
    remote: Total 50 (delta 16), reused 43 (delta 14)
    Receiving objects: 100% (50/50), 12.36 KiB, done.
    Resolving deltas: 100% (16/16), done.

Failure case (server side):

    [SSHChannel session (0) on SSHService ssh-connection
    on SSHServerTransport,2,127.0.0.1] executing command
    "git-upload-pack '/Users/bshi/sandbox/poop'"
    [-] TPP.outReceived(...) 345 bytes
    [-] TPP.outReceived(...) 8 bytes
    [-] TPP.outReceived(...) 33 bytes
    [-] TPP.outReceived(...) 8192 bytes
    [-] TPP.inConnectionLost()
    [-] sending eof
    [-] TPP.outReceived(...) 5903 bytes
    [-] exitCode: 0
    [-] sending request exit-status
    [-] sending close 0


Failure case ("trace:" messages similar, cut out for readability):

    $ GIT_TRACE=1 git clone ssh://user at localhost:2222/Users/bshi/sandbox/poop
    user at localhost's password:
    ...
    ...
    remote: Counting objects: 50, done.
    fatal: The remote end hung up unexpectedly
    fatal: early EOF
    fatal: index-pack failed


From chris at simplistix.co.uk  Thu Mar  4 03:37:49 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 04 Mar 2010 08:37:49 +0000
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>
Message-ID: <4B8F715D.6020107@simplistix.co.uk>

Jonathan Lange wrote:
>  * A new Windows installer that ships without zope.interface

Interesting, why?
Is zope.interface not used/required anymore?
If so, why is it shipping in the non-windows version?

FWIW, zope.interface:
- has binaries available for windows
- has pure python fall-backs for when no binaries are available, 
regardless of platform (ie: GAE)

cheers,

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
            - http://www.simplistix.co.uk


From m.van.lent at zestsoftware.nl  Thu Mar  4 05:45:41 2010
From: m.van.lent at zestsoftware.nl (Mark van Lent)
Date: Thu, 4 Mar 2010 11:45:41 +0100
Subject: [Twisted-Python] Twisted 9.0.0?
Message-ID: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>

Hi everyone!

I am a bit puzzled about the way new version of Twisted is released. Or better: the way the old version seems to be taken out of service.

Last weeks I've been developing agains version Twisted 9.0.0. Yesterday I wanted to deploy my code to my production server, but to my surprise I could not easy_install that version anymore:

$ easy_install Twisted==9.0.0
Searching for Twisted==9.0.0
Reading http://pypi.python.org/simple/Twisted/
Reading http://www.twistedmatrix.com
Reading http://twistedmatrix.com/products/download
Reading http://twistedmatrix.com/projects/core/
Reading http://twistedmatrix.com/
No local packages or download links found for Twisted==9.0.0
Best match: None

(Okay, actually I'm using buildout to setup my environment, but the above demonstrates my problem more clearly.)

I'm sure the new version of Twisted is better and improved but I still wonder why version 9.0.0 has effectively been decommissioned. Or am I missing something and is it still possible to easy_install version 9.0.0?

Thanks,
Mark

-- 
Mark van Lent
m.van.lent at zestsoftware.nl

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100304/df77f5df/attachment.htm 

From jml at mumak.net  Thu Mar  4 07:59:17 2010
From: jml at mumak.net (Jonathan Lange)
Date: Thu, 4 Mar 2010 12:59:17 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
Message-ID: <d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>

On Thu, Mar 4, 2010 at 10:45 AM, Mark van Lent
<m.van.lent at zestsoftware.nl> wrote:
> Hi everyone!
> I am a bit puzzled about the way new version of Twisted is released. Or
> better: the way the old version seems to be taken out of service.
> Last weeks I've been developing agains version Twisted 9.0.0. Yesterday I
> wanted to deploy my code to my production server, but to my surprise I could
> not easy_install that version anymore:
> $ easy_install Twisted==9.0.0
> Searching for Twisted==9.0.0
> Reading?http://pypi.python.org/simple/Twisted/
> Reading?http://www.twistedmatrix.com
> Reading?http://twistedmatrix.com/products/download
> Reading?http://twistedmatrix.com/projects/core/
> Reading?http://twistedmatrix.com/
> No local packages or download links found for Twisted==9.0.0
> Best match: None
> (Okay, actually I'm using buildout to setup my environment, but the above
> demonstrates my problem more clearly.)
> I'm sure the new version of Twisted is better and improved but I still
> wonder why version 9.0.0 has effectively been decommissioned. Or am I
> missing something and is it still possible to easy_install version 9.0.0?

It's an oversight.

I don't know how the PyPI announcement was done (although I'd love
to!), but I think you can announce new versions without
decommissioning old ones.

As for the twistedmatrix.com website, I can fix that so that 9.0.0 is
easy-installable, but I don't know how. Let me know & I'll get it
done.

jml


From exarkun at twistedmatrix.com  Thu Mar  4 08:52:24 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 13:52:24 -0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
Message-ID: <20100304135224.2792.183209342.divmod.xquotient.502@localhost.localdomain>

On 10:45 am, m.van.lent at zestsoftware.nl wrote:
>Hi everyone!
>
>I am a bit puzzled about the way new version of Twisted is released. Or 
>better: the way the old version seems to be taken out of service.
>
>Last weeks I've been developing agains version Twisted 9.0.0. Yesterday 
>I wanted to deploy my code to my production server, but to my surprise 
>I could not easy_install that version anymore:
>
>$ easy_install Twisted==9.0.0
>Searching for Twisted==9.0.0
>Reading http://pypi.python.org/simple/Twisted/
>Reading http://www.twistedmatrix.com
>Reading http://twistedmatrix.com/products/download
>Reading http://twistedmatrix.com/projects/core/
>Reading http://twistedmatrix.com/
>No local packages or download links found for Twisted==9.0.0
>Best match: None
>
>(Okay, actually I'm using buildout to setup my environment, but the 
>above demonstrates my problem more clearly.)
>
>I'm sure the new version of Twisted is better and improved but I still 
>wonder why version 9.0.0 has effectively been decommissioned. Or am I 
>missing something and is it still possible to easy_install version 
>9.0.0?

Decommissioned?  Not really.  There is a link to older releases at the 
top of <http://twistedmatrix.com/trac/wiki/Downloads>.  You can find 
releases going all the way back to 2.0 there.

Perhaps easy_install isn't the best way to manage deployments to your 
production server?

Jean-Paul


From exarkun at twistedmatrix.com  Thu Mar  4 09:05:37 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 14:05:37 -0000
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <4B8F715D.6020107@simplistix.co.uk>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>
	<4B8F715D.6020107@simplistix.co.uk>
Message-ID: <20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>

On 08:37 am, chris at simplistix.co.uk wrote:
>Jonathan Lange wrote:
>>  * A new Windows installer that ships without zope.interface
>
>Interesting, why?

The installer is now built using bdist_msi.  If there's a way to bundle 
zope.interface in the MSI, then this might be interesting to pursue.

Also, I'm pretty sure that the 9.0 Windows installer _also_ didn't 
include zope.interface.  So this isn't a new situation with 10.0.
>Is zope.interface not used/required anymore?
>If so, why is it shipping in the non-windows version?

It doesn't ship in any of the packages for other platforms, either (nor 
do any of our other external dependencies).

Jean-Paul


From glyph at twistedmatrix.com  Thu Mar  4 11:31:33 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 4 Mar 2010 11:31:33 -0500
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
Message-ID: <422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>


On Mar 4, 2010, at 7:59 AM, Jonathan Lange wrote:
> On Thu, Mar 4, 2010 at 10:45 AM, Mark van Lent
> <m.van.lent at zestsoftware.nl> wrote:
>> Hi everyone!
>> I am a bit puzzled about the way new version of Twisted is released. Or
>> better: the way the old version seems to be taken out of service.
>> Last weeks I've been developing agains version Twisted 9.0.0. Yesterday I
>> wanted to deploy my code to my production server, but to my surprise I could
>> not easy_install that version anymore:
>> $ easy_install Twisted==9.0.0
>> Searching for Twisted==9.0.0
>> Reading http://pypi.python.org/simple/Twisted/
>> Reading http://www.twistedmatrix.com
>> Reading http://twistedmatrix.com/products/download
>> Reading http://twistedmatrix.com/projects/core/
>> Reading http://twistedmatrix.com/
>> No local packages or download links found for Twisted==9.0.0
>> Best match: None
>> (Okay, actually I'm using buildout to setup my environment, but the above
>> demonstrates my problem more clearly.)
>> I'm sure the new version of Twisted is better and improved but I still
>> wonder why version 9.0.0 has effectively been decommissioned. Or am I
>> missing something and is it still possible to easy_install version 9.0.0?
> 
> It's an oversight.

I think it's actually a bug in easy_install, or at least a mis-design.

To make something easy_installable, you don't provide structured information in PyPI; there may be a way to do that, but most packages I've seen (Twisted included) just provide a link to a page which then provides a link to a file with a filename of vaguely the appropriate shape.  easy_install works by screen-scraping that link.

In our case, the "home page", http://twistedmatrix.com, links directly to a Twisted-<version>.tar.bz2, which is then used.

If someone (perhaps Mark van Lent!) could point us at how to provide the correctly structured information to easy_install via PyPI so it will _stop_ screen-scraping our website, and just point at the correct files, this problem could be addressed.

However, as exarkun says: screen-scraping a plain-text wiki and then executing code out of whatever comes out of it is not the most reliable or secure way to deploy code.  You may want to specify the URL directly - you can still use easy_install for that if you want, like this:

    $ easy_install http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/Twisted-9.0.0.tar.bz2

> I don't know how the PyPI announcement was done (although I'd love to!), but I think you can announce new versions without decommissioning old ones.


I assume you'll write it down on a web page, when you figure it out :).

The old version, from PyPI's perspective, wasn't decommissioned.  It's here: <http://pypi.python.org/pypi/Twisted/9.0.0>.  The problem is that it also just points at twistedmatrix.com, not a version-specific download page, and there is no Twisted-<version>.tar.bz2 which matches "9.0.0" any more.

(I believe that another way to fix this, although I would be significantly less happy about it, would be to add some hidden links to twistedmatrix.com that had the right filenames.  If this is a real problem for many users though, perhaps we should just live with an ugly fix.)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100304/aa5a971a/attachment-0001.htm 

From kevin.horn at gmail.com  Thu Mar  4 11:53:17 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 4 Mar 2010 10:53:17 -0600
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
Message-ID: <562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>

On Thu, Mar 4, 2010 at 10:31 AM, Glyph Lefkowitz <glyph at twistedmatrix.com>wrote:

>
> On Mar 4, 2010, at 7:59 AM, Jonathan Lange wrote:
>
> On Thu, Mar 4, 2010 at 10:45 AM, Mark van Lent
> <m.van.lent at zestsoftware.nl> wrote:
>
> Hi everyone!
>
> I am a bit puzzled about the way new version of Twisted is released. Or
>
> better: the way the old version seems to be taken out of service.
>
> Last weeks I've been developing agains version Twisted 9.0.0. Yesterday I
>
> wanted to deploy my code to my production server, but to my surprise I
> could
>
> not easy_install that version anymore:
>
> $ easy_install Twisted==9.0.0
>
> Searching for Twisted==9.0.0
>
> Reading http://pypi.python.org/simple/Twisted/
>
> Reading http://www.twistedmatrix.com
>
> Reading http://twistedmatrix.com/products/download
>
> Reading http://twistedmatrix.com/projects/core/
>
> Reading http://twistedmatrix.com/
>
> No local packages or download links found for Twisted==9.0.0
>
> Best match: None
>
> (Okay, actually I'm using buildout to setup my environment, but the above
>
> demonstrates my problem more clearly.)
>
> I'm sure the new version of Twisted is better and improved but I still
>
> wonder why version 9.0.0 has effectively been decommissioned. Or am I
>
> missing something and is it still possible to easy_install version 9.0.0?
>
>
> It's an oversight.
>
>
> I think it's actually a bug in easy_install, or at least a mis-design.
>
> To make something easy_installable, you don't provide structured
> information in PyPI; there may be a way to do that, but most packages I've
> seen (Twisted included) just provide a link to a page which then provides a
> link to a file with a filename of vaguely the appropriate shape.
>  easy_install works by screen-scraping that link.
>
> In our case, the "home page", http://twistedmatrix.com, links directly to
> a Twisted-<version>.tar.bz2, which is then used.
>
> If someone (perhaps Mark van Lent!) could point us at how to provide the
> correctly structured information to easy_install via PyPI so it will _stop_
> screen-scraping our website, and just point at the correct files, this
> problem could be addressed.
>
> However, as exarkun says: screen-scraping a plain-text wiki and then
> executing code out of whatever comes out of it is not the most reliable or
> secure way to deploy code.  You may want to specify the URL directly - you
> can still use easy_install for that if you want, like this:
>
>     $ easy_install
> http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/Twisted-9.0.0.tar.bz2
>
> I don't know how the PyPI announcement was done (although I'd love to!),
> but I think you can announce new versions without decommissioning old ones.
>
>
> I assume you'll write it down on a web page, when you figure it out :).
>
> The old version, from PyPI's perspective, wasn't decommissioned.  It's
> here: <http://pypi.python.org/pypi/Twisted/9.0.0>.  The problem is that it
> also just points at twistedmatrix.com, not a version-specific download
> page, and there is no Twisted-<version>.tar.bz2 which matches "9.0.0" any
> more.
>
> (I believe that another way to fix this, although I would be significantly
> less happy about it, would be to add some hidden links to
> twistedmatrix.com that had the right filenames.  If this is a real problem
> for many users though, perhaps we should just live with an ugly fix.)
>
>
Is there any particular reason Twisted doesn't upload packages to PyPI
itself?

Kevin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100304/9ccf3ed1/attachment.htm 

From exarkun at twistedmatrix.com  Thu Mar  4 12:27:37 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 17:27:37 -0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
Message-ID: <20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>

On 04:53 pm, kevin.horn at gmail.com wrote:
>
>Is there any particular reason Twisted doesn't upload packages to PyPI
>itself?

Messing about with web forms is no fun and "setup.py register" has 
issues.

Jean-Paul


From chris at simplistix.co.uk  Thu Mar  4 13:44:07 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 04 Mar 2010 18:44:07 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
Message-ID: <4B8FFF77.4030400@simplistix.co.uk>

exarkun at twistedmatrix.com wrote:
> On 04:53 pm, kevin.horn at gmail.com wrote:
>> Is there any particular reason Twisted doesn't upload packages to PyPI
>> itself?
> 
> Messing about with web forms is no fun and "setup.py register" has 
> issues.

What issues? I've never had problems with either the register or upload 
commands...

Having the distributions on PyPI makes the OP's problem go away, and 
reduces the maintenance burned for you guys who release twisted...

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk


From chris at simplistix.co.uk  Thu Mar  4 13:45:58 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 04 Mar 2010 18:45:58 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304135224.2792.183209342.divmod.xquotient.502@localhost.localdomain>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<20100304135224.2792.183209342.divmod.xquotient.502@localhost.localdomain>
Message-ID: <4B8FFFE6.4080209@simplistix.co.uk>

exarkun at twistedmatrix.com wrote:
> Perhaps easy_install isn't the best way to manage deployments to your 
> production server?

No, but buildout is...

However, this process of discovering packages (hit pypi, scrape web pags 
if the distro isn't on pypi) is the only solution the python community 
(be it pip, easy_install, virtualenv or buildout) is using to download 
packages...

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk


From chris at simplistix.co.uk  Thu Mar  4 13:47:39 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 04 Mar 2010 18:47:39 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
Message-ID: <4B90004B.9080605@simplistix.co.uk>

Jonathan Lange wrote:
> I don't know how the PyPI announcement was done (although I'd love
> to!), but I think you can announce new versions without
> decommissioning old ones.

PyPI already does the right thing w.r.t. "hide previous versions" 
(either way works, it doesn't affect tools like easy_install) but ONLY 
if you put your distros on PyPI...

...obviously PyPI has not knowledge of your website and so can't do 
anything about it.

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk


From glyph at twistedmatrix.com  Thu Mar  4 13:55:50 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 4 Mar 2010 13:55:50 -0500
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <4B8FFF77.4030400@simplistix.co.uk>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
	<4B8FFF77.4030400@simplistix.co.uk>
Message-ID: <F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>


On Mar 4, 2010, at 1:44 PM, Chris Withers wrote:

> exarkun at twistedmatrix.com wrote:
>> On 04:53 pm, kevin.horn at gmail.com wrote:
>>> Is there any particular reason Twisted doesn't upload packages to PyPI
>>> itself?
>> 
>> Messing about with web forms is no fun and "setup.py register" has 
>> issues.
> 
> What issues? I've never had problems with either the register or upload 
> commands...
> 
> Having the distributions on PyPI makes the OP's problem go away, and 
> reduces the maintenance burned for you guys who release twisted...

This has been discussed before, on distutils-sig - there's a _giant_ thread, but I think the most relevant message is <http://mail.python.org/pipermail/distutils-sig/2009-December/015064.html>.

Now that our release process is better documented (THANK YOU JML), you might be able to have a look at <http://twistedmatrix.com/trac/wiki/ReleaseProcess> and figure out where 'setup.py upload' could fit in without uploading a tarball that is _not_ actually our official release.



From ziga.seilnacht at gmail.com  Thu Mar  4 14:54:11 2010
From: ziga.seilnacht at gmail.com (=?windows-1252?Q?=8Eiga_Seilnacht?=)
Date: Thu, 04 Mar 2010 20:54:11 +0100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
Message-ID: <4B900FE3.207@gmail.com>

Glyph Lefkowitz wrote:
> On Mar 4, 2010, at 7:59 AM, Jonathan Lange wrote:
>> On Thu, Mar 4, 2010 at 10:45 AM, Mark van Lent 
>> <m.van.lent at zestsoftware.nl> wrote:
>>> Hi everyone! I am a bit puzzled about the way new version of
>>> Twisted is released. Or better: the way the old version seems to
>>> be taken out of service. Last weeks I've been developing agains
>>> version Twisted 9.0.0. Yesterday I wanted to deploy my code to my
>>> production server, but to my surprise I could not easy_install
>>> that version anymore: $ easy_install Twisted==9.0.0 Searching for
>>> Twisted==9.0.0 Reading http://pypi.python.org/simple/Twisted/ 
>>> Reading http://www.twistedmatrix.com Reading
>>> http://twistedmatrix.com/products/download Reading
>>> http://twistedmatrix.com/projects/core/ Reading
>>> http://twistedmatrix.com/ No local packages or download links
>>> found for Twisted==9.0.0 Best match: None (Okay, actually I'm
>>> using buildout to setup my environment, but the above 
>>> demonstrates my problem more clearly.) I'm sure the new version
>>> of Twisted is better and improved but I still wonder why version
>>> 9.0.0 has effectively been decommissioned. Or am I missing
>>> something and is it still possible to easy_install version 9.0.0?
>>> 
>> 
>> It's an oversight.
> 
> I think it's actually a bug in easy_install, or at least a
> mis-design.
> 
> To make something easy_installable, you don't provide structured
> information in PyPI; there may be a way to do that, but most packages
> I've seen (Twisted included) just provide a link to a page which then
> provides a link to a file with a filename of vaguely the appropriate
> shape.  easy_install works by screen-scraping that link.
> 
> In our case, the "home page", http://twistedmatrix.com, links
> directly to a Twisted-<version>.tar.bz2, which is then used.
> 
> If someone (perhaps Mark van Lent!) could point us at how to provide
> the correctly structured information to easy_install via PyPI so it
> will _stop_ screen-scraping our website, and just point at the
> correct files, this problem could be addressed.
> 

I think that easy_install and related tools can be directed to the
proper download location by providing a Download-URL on the PyPI page.

E.g. the page for Twisted 9.0.0:
http://pypi.python.org/pypi/Twisted/9.0.0

should have a Download-URL link to:
http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/

Regards,
Ziga



From exarkun at twistedmatrix.com  Thu Mar  4 15:21:52 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 20:21:52 -0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <4B900FE3.207@gmail.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<4B900FE3.207@gmail.com>
Message-ID: <20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>

On 07:54 pm, ziga.seilnacht at gmail.com wrote:
>Glyph Lefkowitz wrote:
>>
>>If someone (perhaps Mark van Lent!) could point us at how to provide
>>the correctly structured information to easy_install via PyPI so it
>>will _stop_ screen-scraping our website, and just point at the
>>correct files, this problem could be addressed.
>
>I think that easy_install and related tools can be directed to the
>proper download location by providing a Download-URL on the PyPI page.
>
>E.g. the page for Twisted 9.0.0:
>http://pypi.python.org/pypi/Twisted/9.0.0
>
>should have a Download-URL link to:
>http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/

That's easy enough to adjust.  There.  Someone want to try it and see if 
it works?

Jean-Paul


From ziga.seilnacht at gmail.com  Thu Mar  4 15:41:42 2010
From: ziga.seilnacht at gmail.com (=?windows-1252?Q?=8Eiga_Seilnacht?=)
Date: Thu, 04 Mar 2010 21:41:42 +0100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<4B900FE3.207@gmail.com>
	<20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>
Message-ID: <4B901B06.4010300@gmail.com>

exarkun at twistedmatrix.com wrote:
> On 07:54 pm, ziga.seilnacht at gmail.com wrote:
>>
>>I think that easy_install and related tools can be directed to the
>>proper download location by providing a Download-URL on the PyPI page.
>>
>>E.g. the page for Twisted 9.0.0:
>>http://pypi.python.org/pypi/Twisted/9.0.0
>>
>>should have a Download-URL link to:
>>http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/
> 
> That's easy enough to adjust.  There.  Someone want to try it and see if 
> it works?
> 
> Jean-Paul
> 

It looks like it works now:

I:\> easy_install Twisted==9.0.0
Searching for Twisted==9.0.0
Reading http://pypi.python.org/simple/Twisted/
Reading http://www.twistedmatrix.com
Reading http://twistedmatrix.com/products/download
Reading http://twistedmatrix.com/projects/core/
Reading http://twistedmatrix.com/
Reading http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/
Best match: Twisted 9.0.0
Downloading http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/Twisted-9.0.0.win32-py2.5.exe

Now, how to get rid of the egg yolk...

Regards,
Ziga


From celord at gmail.com  Thu Mar  4 16:52:24 2010
From: celord at gmail.com (=?ISO-8859-1?B?Q+lzYXIgR2FyY+1h?=)
Date: Thu, 4 Mar 2010 15:52:24 -0600
Subject: [Twisted-Python] IMAP4 Client extrange behavior
In-Reply-To: <b302bf881002220825g2be89yf0aa7ec7503ab1de@mail.gmail.com>
References: <b302bf881002220825g2be89yf0aa7ec7503ab1de@mail.gmail.com>
Message-ID: <b302bf881003041352i6e7e3075i3f0daba66d7ca065@mail.gmail.com>

Hello all I have solved this, here are my final functions, I thing to
notice is that with twisted 8.2 the one from the debian/ubuntu repos
this functions do not work properly, in the other hand, they work just
fine with twisted 9 and 10

   def selectMailbox(self, mailbox):
        """
        Select the mailbox to examin
        """
        if debug: print "On selectMailbox"

        mailbox = self.factory.mailbox
        return self.select(mailbox).addCallback(self.cbSelectSuccess)



    def cbSelectSuccess(self, selected):
        """
        Examine the INBOX mailbox for new mails

        """
        if debug: print "On cbSelectSuccess"


        self.messageCount = selected['EXISTS']
        print "Messages: ", self.messageCount

        unseen = imap4.Query(unseen=True)

        return self.search(unseen
            ).addCallback(self.cbSearch)

    def cbSearch(self,messages):
        if debug: print "on cbSearch"

        messageSet = imap4.MessageSet()

        for message in messages:
            messageSet += message

        if messageSet:

            self.fetchMessage(messageSet, False
                ).addCallback(self.cbProcMessage)
        else:
            return


    def cbProcMessage(self, messages):
        if debug: print "on cbProcEnvelop"

        for message in messages.iteritems():

            body = message[1]['RFC822']
            print body

2010/2/22 C?sar Garc?a <celord at gmail.com>:
> Hello all, I have this imap4 client http://www.pastebin.com/m4e387f1a
> most of the code is barrowed from a IRC friend, bob_f , it works fine
> but as soon as more that 1 email arrrives to the inbox, it only prints
> the first new messages but not the others, ?I wonder what am I doing
> wrong
>
> Thanks a lot
>
>
>
>
>
>
>
> Here is the code:
>
> #!/usr/bin/env python
> #coding=utf-8
>
>
> """
> Client de IMAP4 que descarga contenido del INBOX de una cuenta en especifico
> para luego extraer el numero de telefono que debe venir en los correos enviados
> """
>
> import StringIO
> import sys
> from Config import retCredentials
>
> from twisted.internet.task import LoopingCall
> from twisted.internet import protocol
> from twisted.internet import defer
> from twisted.mail import imap4
> from twisted.python import util
> from twisted.python import log
> from twisted.internet import reactor
> debug = 1
>
> class IMAP4Client(imap4.IMAP4Client):
>
> ? ?def serverGreeting(self,caps):
> ? ? ? ?"""
> ? ? ? ?Metodo llamado cuando el servidor contesta
> ? ? ? ?"""
> ? ? ? ?if debug: print "On serverGreeting"
>
> ? ? ? ?self.serverCapabilities = caps
> ? ? ? ?if self.greetDeferred is not None:
> ? ? ? ? ? ?d, self.greetDeferred = self.greetDeferred, None
> ? ? ? ? ? ?d.addCallback(self.cbLogin)
> ? ? ? ? ? ?d.callback(self)
>
>
> ? ?def cbLogin(self, proto):
> ? ? ? ?"""
> ? ? ? ?Callback to IMAP login
> ? ? ? ?"""
> ? ? ? ?if debug: print "On Login"
>
> ? ? ? ?login = ?self.login(self.factory.username, self.factory.password)
> ? ? ? ?login.addCallback(self.startPolling)
>
>
> ? ?def startPolling(self, proto):
> ? ? ? ?"""
> ? ? ? ?Callback to poll every x seconds
> ? ? ? ?"""
> ? ? ? ?call = LoopingCall(self.selectMailbox,mailbox="INBOX")
> ? ? ? ?call.start(20, now=True)
>
>
> ? ?def selectMailbox(self, mailbox):
> ? ? ? ?"""
> ? ? ? ?Select the mailbox to examin
> ? ? ? ?"""
> ? ? ? ?if debug: print "On selectMailbox"
>
> ? ? ? ?mailbox = self.factory.mailbox
> ? ? ? ?return self.select(mailbox).addCallback(self.cbSelectSuccess)
>
>
> ? ?def cbSelectSuccess(self, selected):
> ? ? ? ?"""
> ? ? ? ?Examine the INBOX mailbox for new mails
>
> ? ? ? ?"""
> ? ? ? ?if debug: print "On cbSelectSuccess"
>
>
> ? ? ? ?self.messageCount = selected['EXISTS']
> ? ? ? ?print "Messages: ", self.messageCount
>
> ? ? ? ?unseen = selected['EXISTS'] - selected['RECENT']
>
> ? ? ? ?if selected['RECENT'] == 0:
> ? ? ? ? ? ?print "No new messages"
> ? ? ? ? ? ?return
>
> ? ? ? ?return self.fetchMessage("%s:*" % (unseen)
> ? ? ? ? ? ? ? ?).addCallback(self.cbProcMessages)
>
> ? ?def cbProcMessages(self,messages):
>
> ? ? ? ?print messages
>
>
> class IMAP4ClientFactory(protocol.ClientFactory):
>
> ? ?protocol = IMAP4Client
>
> ? ?def __init__(self, username, password, ?onConn):
>
> ? ? ? ?self.username = username
> ? ? ? ?self.password = password
> ? ? ? ?self.mailbox = 'INBOX'
> ? ? ? ?self.onConn = onConn
>
> ? ?def buildProtocol(self,addr):
> ? ? ? ?if debug: print "On buildProtocol"
> ? ? ? ?p = self.protocol()
> ? ? ? ?p.factory = self
> ? ? ? ?p.greetDeferred = self.onConn
> ? ? ? ?auth = imap4.CramMD5ClientAuthenticator(self.username)
> ? ? ? ?p.registerAuthenticator(auth)
>
> ? ? ? ?return p
>
> ? ?def clientConectionFailed(self, connector, reason):
> ? ? ? ?d, self.onConn = self.onConn, None
> ? ? ? ?d.errback(reason)
>
>
>
> def ebConnection(reason):
> ? ?log.startLogging(sys.stdout)
> ? ?log.err(reason)
> ? ?reactor.stop()
>
>
>
> PORT = 143
> RESULT = "INBOX"
>
>
> def main():
> ? ?credentials = retCredentials()
> ? ?hostname = credentials['server']
> ? ?username = credentials['mailbox']
> ? ?password = util.getPassword('IMAP4 Password: ')
>
> ? ?onConn = defer.Deferred(
> ? ? ? ? ? ?).addErrback(ebConnection
> ? ? ? ? ? ?)
>
> ? ?factory = IMAP4ClientFactory(username, password, onConn)
>
>
> ? ?reactor.connectTCP(hostname, PORT, factory)
> ? ?reactor.run()
>
> if ?__name__ == "__main__":
> ? ?main()
>
> --
> http://celord.blogspot.com/
>



-- 
http://celord.blogspot.com/


From wmarketing3 at gmail.com  Thu Mar  4 16:57:43 2010
From: wmarketing3 at gmail.com (Prince Riley)
Date: Thu, 4 Mar 2010 15:57:43 -0600
Subject: [Twisted-Python] Twisted Python on Nokia E71x (Running the phone
	Python Interpreter)
Message-ID: <fa04eb751003041357o7ca889a9uc3985667c34731b0@mail.gmail.com>

Has anyone experimented with twisted-python on the Nokia E71x or E72
smartphones?

Prince Riley
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100304/114df4b0/attachment.htm 

From kevin.horn at gmail.com  Thu Mar  4 17:49:57 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 4 Mar 2010 16:49:57 -0600
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
Message-ID: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>

It's been a while, I know you were all waiting with baited breath...

First a few fixes:

- Thanks to Tim Allen and Steve Steiner, several theme issues were fixed.
This
  fixes a few minor display bugs and should make pages validate properly.

- inline markup will now include child contents.  This causes rst not to
display
  properly in cases of "nested inline markup", but should make it easier to
  manually fix these places later

- :download: links are now generated for non-rst files ending in .py (most
of the
  examples), as welll as .tac and .sql files

- toc entries which end in a "/" character now have "index appended to them
  in the ReST output, which fixes a few issues where the built-Sphinx docs
  would end up with broken navigation links.

A couple of issues were also fixed at the PyCon sprints:

- <cite> tags are now handled...sort of.  According to Glyph, these aren't
really
  very important, so we just return the contents of the tag without any
special
  markup.  If we feel the need to put citation markup back into the docs we
can
  do that post-transition.

- Glyph also found an easy way to improve the CSS of the theme somewhat.
The
  issue where the sidebar drops below the main content should now be less of
a
  problem, though it's not gone entirely.

- Glyph and I also discussed a few different ways to handle links to the API
docs
  and agreed on a way forward.  Basically, well change the <code
class='API'>
  tags into something like: :api:`path.to.documented object <label>`, and
then
  create a docutils extension to convert that into a link.  The beginnings
of this
  are in the hg repos, but it looks like it won't be quite as simple as we
thought.

  First, the way pydoctor generates links is deceptively simple.

  If you look up a module, like "twisted.internet.defer", the link looks
like
  this:

    http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.html

  If you look up a class, like "twisted.internet.defer.Deferred" for
example,
  the link looks like this:


http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html

  Pretty simple right?  But if you look up a function or method like
  "twisted.internet.defer.Deferred.callback", the link has an anchor, like
so:


http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback

  So we'll need to do some checking on either the api docs or on twisted
itself
  to determine what sort of object is being linked to.  Shouldn't be
  super-difficult, just haven't had time yet.

  Second, I haven't yet figured out how to access the Sphinx config object
from
  a docutils role function.  I'm sure this is just a matter of finding an
example
  or getting an answer from the mailing list, but I just haven't gotten to
it yet.

I think the API links are the only major issue still remaining until we
start doing
the conversion, so once this issue is handled, I'll probably file a ticket
and create
a branch in SVN for the conversion.

If anyone has any docs tickets open, now is the time to get them fixed!

And if anyone has some great ideas about how to organize the new docs in the

repository, I'd love to hear them.


As always, converted docs are here:
http://twistedsphinx.funsize.net/

The lore2Sphinx Hg repos is here:
http://bitbucket.org/khorn/lore2sphinx/

Comments, ideas, patches and pull requests gratefully accepted (or at least
discussed).

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100304/03703c78/attachment.htm 

From screwtape at froup.com  Thu Mar  4 18:03:32 2010
From: screwtape at froup.com (Tim Allen)
Date: Fri, 5 Mar 2010 10:03:32 +1100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
	<4B8FFF77.4030400@simplistix.co.uk>
	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
Message-ID: <20100304230332.GC1840@boombah.thristian.org>

On Thu, Mar 04, 2010 at 01:55:50PM -0500, Glyph Lefkowitz wrote:
> Now that our release process is better documented (THANK YOU JML), you
> might be able to have a look at
> <http://twistedmatrix.com/trac/wiki/ReleaseProcess> and figure out
> where 'setup.py upload' could fit in without uploading a tarball that
> is _not_ actually our official release.

If "setup.py upload" involves "setup.py sdist" then I guess this is
ticket #4138 again.

I still plan to tackle it sometime soon, but totally would not object if
anybody else wanted to dive in. :D


From exarkun at twistedmatrix.com  Thu Mar  4 18:05:28 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 23:05:28 -0000
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
Message-ID: <20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>

On 10:49 pm, kevin.horn at gmail.com wrote:
>
>  If you look up a class, like "twisted.internet.defer.Deferred" for
>example,
>  the link looks like this:
>
>
>http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
>
>  Pretty simple right?  But if you look up a function or method like
>  "twisted.internet.defer.Deferred.callback", the link has an anchor, 
>like
>so:
>
>
>http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
>
>  So we'll need to do some checking on either the api docs or on twisted
>itself
>  to determine what sort of object is being linked to.  Shouldn't be
>  super-difficult, just haven't had time yet.

Did you notice that 
http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.addCallback.html 
also exists?

Jean-Paul


From kevin.horn at gmail.com  Thu Mar  4 18:31:56 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 4 Mar 2010 17:31:56 -0600
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
	<20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>
Message-ID: <562bcc11003041531g3e3bc987ucecae2c3f4dfd9df@mail.gmail.com>

On Thu, Mar 4, 2010 at 5:05 PM, <exarkun at twistedmatrix.com> wrote:

> On 10:49 pm, kevin.horn at gmail.com wrote:
> >
> >  If you look up a class, like "twisted.internet.defer.Deferred" for
> >example,
> >  the link looks like this:
> >
> >
> >
> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
> >
> >  Pretty simple right?  But if you look up a function or method like
> >  "twisted.internet.defer.Deferred.callback", the link has an anchor,
> >like
> >so:
> >
> >
> >
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
> >
> >  So we'll need to do some checking on either the api docs or on twisted
> >itself
> >  to determine what sort of object is being linked to.  Shouldn't be
> >  super-difficult, just haven't had time yet.
>
> Did you notice that
>
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.addCallback.html
> also exists?
>
> Jean-Paul
>
>
I hadn't actually.  If all functions and methods have a similar page in the
PyDoctor output, then I think what I have now will pretty much work as-is
(almost).  Do we think that just generating links to the individual
function/method pages is acceptable?

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100304/39942095/attachment.htm 

From micahel at gmail.com  Thu Mar  4 19:10:19 2010
From: micahel at gmail.com (Michael Hudson-Doyle)
Date: Fri, 5 Mar 2010 13:10:19 +1300
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <562bcc11003041531g3e3bc987ucecae2c3f4dfd9df@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
	<20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>
	<562bcc11003041531g3e3bc987ucecae2c3f4dfd9df@mail.gmail.com>
Message-ID: <aa0dfd861003041610y87ee8a3uff9648b86dc2e091@mail.gmail.com>

On 5 March 2010 12:31, Kevin Horn <kevin.horn at gmail.com> wrote:
> On Thu, Mar 4, 2010 at 5:05 PM, <exarkun at twistedmatrix.com> wrote:
>>
>> On 10:49 pm, kevin.horn at gmail.com wrote:
>> >
>> > ?If you look up a class, like "twisted.internet.defer.Deferred" for
>> >example,
>> > ?the link looks like this:
>> >
>> >
>>
>> > >http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
>> >
>> > ?Pretty simple right? ?But if you look up a function or method like
>> > ?"twisted.internet.defer.Deferred.callback", the link has an anchor,
>> >like
>> >so:
>> >
>> >
>>
>> > >http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
>> >
>> > ?So we'll need to do some checking on either the api docs or on twisted
>> >itself
>> > ?to determine what sort of object is being linked to. ?Shouldn't be
>> > ?super-difficult, just haven't had time yet.
>>
>> Did you notice that
>>
>> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.addCallback.html
>> also exists?
>>
>> Jean-Paul
>>
>
> I hadn't actually.? If all functions and methods have a similar page in the
> PyDoctor output, then I think what I have now will pretty much work as-is
> (almost).? Do we think that just generating links to the individual
> function/method pages is acceptable?

It's what the lore-processed documentation currently links to.  It
would be nice to fix this (and I sort of vaguely know how), but that
should in no way hold up the move away from lore!

Cheers,
mwh


From kevin.horn at gmail.com  Thu Mar  4 19:16:08 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 4 Mar 2010 18:16:08 -0600
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <aa0dfd861003041610y87ee8a3uff9648b86dc2e091@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
	<20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>
	<562bcc11003041531g3e3bc987ucecae2c3f4dfd9df@mail.gmail.com>
	<aa0dfd861003041610y87ee8a3uff9648b86dc2e091@mail.gmail.com>
Message-ID: <562bcc11003041616t5a619b64i2846b59f89135ac4@mail.gmail.com>

On Thu, Mar 4, 2010 at 6:10 PM, Michael Hudson-Doyle <micahel at gmail.com>wrote:

> On 5 March 2010 12:31, Kevin Horn <kevin.horn at gmail.com> wrote:
> > On Thu, Mar 4, 2010 at 5:05 PM, <exarkun at twistedmatrix.com> wrote:
> >>
> >> On 10:49 pm, kevin.horn at gmail.com wrote:
> >> >
> >> >  If you look up a class, like "twisted.internet.defer.Deferred" for
> >> >example,
> >> >  the link looks like this:
> >> >
> >> >
> >>
> >> > >
> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
> >> >
> >> >  Pretty simple right?  But if you look up a function or method like
> >> >  "twisted.internet.defer.Deferred.callback", the link has an anchor,
> >> >like
> >> >so:
> >> >
> >> >
> >>
> >> > >
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
> >> >
> >> >  So we'll need to do some checking on either the api docs or on
> twisted
> >> >itself
> >> >  to determine what sort of object is being linked to.  Shouldn't be
> >> >  super-difficult, just haven't had time yet.
> >>
> >> Did you notice that
> >>
> >>
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.addCallback.html
> >> also exists?
> >>
> >> Jean-Paul
> >>
> >
> > I hadn't actually.  If all functions and methods have a similar page in
> the
> > PyDoctor output, then I think what I have now will pretty much work as-is
> > (almost).  Do we think that just generating links to the individual
> > function/method pages is acceptable?
>
> It's what the lore-processed documentation currently links to.  It
> would be nice to fix this (and I sort of vaguely know how), but that
> should in no way hold up the move away from lore!
>
> Cheers,
> mwh
>
>
OK, if that's the way Lore does it, then I'm happy to call that "good enough
for now".  It seems to work here in my local version of the docs, I'll
update the online stuff at http://twistedsphinx.funsize.net soonish.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100304/78515b33/attachment-0001.htm 

From micahel at gmail.com  Thu Mar  4 23:51:09 2010
From: micahel at gmail.com (Michael Hudson-Doyle)
Date: Fri, 5 Mar 2010 17:51:09 +1300
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
In-Reply-To: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
References: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
Message-ID: <aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>

On 4 March 2010 17:46, Bo Shi <bs1984 at gmail.com> wrote:
> Hi All,
>
> I've been struggling with this issue off and on for the better part of
> a month now. ?Having implemented a simple git SSH server using some of
> the Conch examples in the official documentation, I encountered an
> issue that would cause a git client to throw an error only part of the
> time.

I think it's a bug in conch.

> The little program to reproduce the issue is found at
>
> ? ?http://gist.github.com/321403
>
> ? ?(raw version for download)
> ? ?http://gist.github.com/raw/321403/82ab2111a2709c8fe50a77aabb08565749087408/gitconnbug.py
>
> and can be executed to start the sample server. ?Run a command like
>
> ? ?# The /abspath/to/git/repo should be readable by the server user
> ? ?$ git clone ssh://user at localhost:2222/abspath/to/git/repo
> ? ?(password "user")
>
> To test the server. ?On my workstation, I am able to reproduce the
> error at least once every 5 tries. ?It's definitely not consistent.
> The behavior I see is attached at the end of this email. ?The client
> fails due to a premature inConnectionLost() call in the
> SSHSessionProcessProtocol that sends an EOF.
>
> As a workaround, when TraceProcessProtocol.inConnectionLost() is
> overriden to do nothing, the client error goes away. ?This is somewhat
> foreign territory for me so I'm not sure whether it's a bug in git or
> whether it's a bug in the twisted ProcessProtocol implementation. ?RFC
> 4254 isn't terribly helpful here:
>
> ? ?5.3. ?Closing a Channel
>
> ? ? ? When a party will no longer send more data to a channel, it SHOULD
> ? ? ? send SSH_MSG_CHANNEL_EOF.
>
> So on the surface the current behavior of sending an EOF appears fine,
> however, I can't really find any definitive cases of this type of
> problem popping up via, say, default OpenSSH/git combinations.
>
>
> Any advice? ?Is the gitconnbug.py implementation flawed? ?Should I
> open a ticket? ?Any git experts know of a case where git-upload-pack
> might close it's stdout pipe?

I think what's actually happening here is that git-upload-pack is
closing its *stdin*.  Why conch reacts to that by shutting down the
channel, I don't really know -- it doesn't seem right to me.  Maybe
it's a simple logic error and it method should be
'outConnectionClosed' instead?

At any rate, I think this is a bug -- please file a ticket.  And
thanks for the complete example!

Cheers,
mwh


From wthie at thiengineering.ch  Fri Mar  5 01:47:58 2010
From: wthie at thiengineering.ch (Werner Thie)
Date: Fri, 05 Mar 2010 07:47:58 +0100
Subject: [Twisted-Python] Twisted Python on Nokia E71x (Running the
 phone Python Interpreter)
In-Reply-To: <fa04eb751003041357o7ca889a9uc3985667c34731b0@mail.gmail.com>
References: <fa04eb751003041357o7ca889a9uc3985667c34731b0@mail.gmail.com>
Message-ID: <4B90A91E.8050702@thiengineering.ch>

Hi

see my post dated 30.05.2009 18:59

did some experimenting with E61i and twisted pre 8.0 pretty much worked. 
Now with the problems starting on E61i with the Python releases from 
1.97 up to the latest 2.0 (certificate woes) and an extremely shabby 
implementation of the cam module I lost interest.

HTH, Werner

Prince Riley wrote:
> 
> 
> Has anyone experimented with twisted-python on the Nokia E71x or E72 
> smartphones?
> 
> Prince Riley
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From lormayna at libero.it  Fri Mar  5 04:20:49 2010
From: lormayna at libero.it (lormayna at libero.it)
Date: Fri, 5 Mar 2010 10:20:49 +0100 (CET)
Subject: [Twisted-Python] R: Twisted Python on Nokia E71x (Running the phone
 Python Interpreter)
Message-ID: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>

>Date: Thu, 4 Mar 2010 15:57:43 -0600
>From: Prince Riley <wmarketing3 at gmail.com>
>Subject: [Twisted-Python] Twisted Python on Nokia E71x (Running the
>	phone	Python Interpreter)
>To: twisted-python at twistedmatrix.com
>Message-ID:
>	<fa04eb751003041357o7ca889a9uc3985667c34731b0 at mail.gmail.com>
>Content-Type: text/plain; charset="iso-8859-1"
>
>Has anyone experimented with twisted-python on the Nokia E71x or E72
>smartphones?
>
>Prince Riley

Hi,
I had tried to use Python for S60 (not Twisted, but standard socket module) 
writing a NNTP client, but I found many problem specially about networking. 
There is no high-layer abstraction layer for networking, so you have to 
implement all the logic from low level.
I tried to use select (that may be useful for doing asynchronous networking 
apps), but is not working correctly on s60 phones. There is no porting for 
Twisted.
My experience is that PyS60 is not mature for a production environment.



From wthie at thiengineering.ch  Fri Mar  5 04:46:40 2010
From: wthie at thiengineering.ch (Werner Thie)
Date: Fri, 05 Mar 2010 10:46:40 +0100
Subject: [Twisted-Python] R: Twisted Python on Nokia E71x (Running the
 phone Python Interpreter)
In-Reply-To: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>
References: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>
Message-ID: <4B90D300.8060804@thiengineering.ch>

Hi

I mostly diddled with the cam and automated uploading of pictures with 
simple JSON encoding over WLAN, and as I said, twisted is running with a 
few patches on the E61i..

Using putools

http://people.csail.mit.edu/kapu/symbian/python.html

helped a lot.

Please find attached a tiny example with a very primitive server and a 
client counterpart using the standard socket API in python on the E61i. 
Although the pictures are lousy (the cam looses the white balance when 
the picture is taken) this code ran for days with no problem. So 'not 
ready for production' seems to me a bit too harsh as a judgment.

Werner

lormayna at libero.it wrote:
>> Date: Thu, 4 Mar 2010 15:57:43 -0600
>> From: Prince Riley <wmarketing3 at gmail.com>
>> Subject: [Twisted-Python] Twisted Python on Nokia E71x (Running the
>> 	phone	Python Interpreter)
>> To: twisted-python at twistedmatrix.com
>> Message-ID:
>> 	<fa04eb751003041357o7ca889a9uc3985667c34731b0 at mail.gmail.com>
>> Content-Type: text/plain; charset="iso-8859-1"
>>
>> Has anyone experimented with twisted-python on the Nokia E71x or E72
>> smartphones?
>>
>> Prince Riley
> 
> Hi,
> I had tried to use Python for S60 (not Twisted, but standard socket module) 
> writing a NNTP client, but I found many problem specially about networking. 
> There is no high-layer abstraction layer for networking, so you have to 
> implement all the logic from low level.
> I tried to use select (that may be useful for doing asynchronous networking 
> apps), but is not working correctly on s60 phones. There is no porting for 
> Twisted.
> My experience is that PyS60 is not mature for a production environment.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: jsonphotoclient.py
Type: application/x-python
Size: 1830 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20100305/495ecfc4/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: photoserver.py
Type: application/x-python
Size: 1053 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20100305/495ecfc4/attachment-0001.bin 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: photoserver.tac
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100305/495ecfc4/attachment.txt 

From m.van.lent at zestsoftware.nl  Fri Mar  5 04:33:14 2010
From: m.van.lent at zestsoftware.nl (Mark van Lent)
Date: Fri, 05 Mar 2010 10:33:14 +0100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<4B900FE3.207@gmail.com>
	<20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>
Message-ID: <hmqj4q$mth$1@dough.gmane.org>

On 3/4/10 21:21 , exarkun at twistedmatrix.com wrote:
>> I think that easy_install and related tools can be directed to the
>> proper download location by providing a Download-URL on the PyPI page.
>>
>> E.g. the page for Twisted 9.0.0:
>> http://pypi.python.org/pypi/Twisted/9.0.0
>>
>> should have a Download-URL link to:
>> http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/
>
> That's easy enough to adjust.  There.  Someone want to try it and see if
> it works?

Thanks Jean-Paul and Ziga! It indeed works like a charm!

I have to admit that, for someone who uses PyPi daily, I know too little 
about it. I probably would have started tinkering with my zc.buildout 
configuration to get it working, but this is a much better solution.

Thanks again,
Mark



From chris at simplistix.co.uk  Fri Mar  5 06:11:35 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 05 Mar 2010 11:11:35 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304230332.GC1840@boombah.thristian.org>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>	<4B8FFF77.4030400@simplistix.co.uk>	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
	<20100304230332.GC1840@boombah.thristian.org>
Message-ID: <4B90E6E7.9050908@simplistix.co.uk>

Tim Allen wrote:
> On Thu, Mar 04, 2010 at 01:55:50PM -0500, Glyph Lefkowitz wrote:
>> Now that our release process is better documented (THANK YOU JML), you
>> might be able to have a look at
>> <http://twistedmatrix.com/trac/wiki/ReleaseProcess> and figure out
>> where 'setup.py upload' could fit in without uploading a tarball that
>> is _not_ actually our official release.
> 
> If "setup.py upload" involves "setup.py sdist" then I guess this is
> ticket #4138 again.

No, it doesn't... see the release process I use for my own packages here:

http://packages.python.org/errorhandler/development.html#making-a-release

cheers,

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk


From screwtape at froup.com  Fri Mar  5 06:51:57 2010
From: screwtape at froup.com (Tim Allen)
Date: Fri, 5 Mar 2010 22:51:57 +1100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <4B90E6E7.9050908@simplistix.co.uk>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
	<4B8FFF77.4030400@simplistix.co.uk>
	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
	<20100304230332.GC1840@boombah.thristian.org>
	<4B90E6E7.9050908@simplistix.co.uk>
Message-ID: <20100305115157.GD1840@boombah.thristian.org>

On Fri, Mar 05, 2010 at 11:11:35AM +0000, Chris Withers wrote:
> Tim Allen wrote:
> > If "setup.py upload" involves "setup.py sdist" then I guess this is
> > ticket #4138 again.
> 
> No, it doesn't... see the release process I use for my own packages here:
> 
> http://packages.python.org/errorhandler/development.html#making-a-release

Hmm... at the bottom of that page, I see you run (among other things):

    setup.py sdist upload

...so presumably sdist *is* a prerequisite for upload. Or are you saying
that you can store any old file as dist/$PACKAGE-$VERSION.tar.gz and
"setup.py upload" will ship it to PyPI?


From chris at simplistix.co.uk  Fri Mar  5 09:42:33 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 05 Mar 2010 14:42:33 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100305115157.GD1840@boombah.thristian.org>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>	<4B8FFF77.4030400@simplistix.co.uk>	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>	<20100304230332.GC1840@boombah.thristian.org>	<4B90E6E7.9050908@simplistix.co.uk>
	<20100305115157.GD1840@boombah.thristian.org>
Message-ID: <4B911859.80702@simplistix.co.uk>

Tim Allen wrote:
> ...so presumably sdist *is* a prerequisite for upload. Or are you saying
> that you can store any old file as dist/$PACKAGE-$VERSION.tar.gz and
> "setup.py upload" will ship it to PyPI?

I think that's true, but I admit, I haven't checked myself ;-)

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk


From exarkun at twistedmatrix.com  Fri Mar  5 10:02:43 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 05 Mar 2010 15:02:43 -0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <4B911859.80702@simplistix.co.uk>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
	<4B8FFF77.4030400@simplistix.co.uk>
	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
	<20100304230332.GC1840@boombah.thristian.org>
	<4B90E6E7.9050908@simplistix.co.uk>
	<20100305115157.GD1840@boombah.thristian.org>
	<4B911859.80702@simplistix.co.uk>
Message-ID: <20100305150243.2792.1449357947.divmod.xquotient.897@localhost.localdomain>

On 02:42 pm, chris at simplistix.co.uk wrote:
>Tim Allen wrote:
>>...so presumably sdist *is* a prerequisite for upload. Or are you 
>>saying
>>that you can store any old file as dist/$PACKAGE-$VERSION.tar.gz and
>>"setup.py upload" will ship it to PyPI?
>
>I think that's true, but I admit, I haven't checked myself ;-)

It is.  Or at least something like sdist.  The thread Glyph linked to 
covers this.

Jean-Paul


From drew.smathers at gmail.com  Fri Mar  5 10:30:44 2010
From: drew.smathers at gmail.com (Drew Smathers)
Date: Fri, 5 Mar 2010 10:30:44 -0500
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
Message-ID: <368574aa1003050730p476bee78x5ed0e262783258d3@mail.gmail.com>

On Thu, Mar 4, 2010 at 5:49 PM, Kevin Horn <kevin.horn at gmail.com> wrote:

>
> It's been a while, I know you were all waiting with baited breath...
>
> First a few fixes:
>
> - Thanks to Tim Allen and Steve Steiner, several theme issues were fixed.
> This
>   fixes a few minor display bugs and should make pages validate properly.
>
> - inline markup will now include child contents.  This causes rst not to
> display
>   properly in cases of "nested inline markup", but should make it easier to
>
>   manually fix these places later
>
> - :download: links are now generated for non-rst files ending in .py (most
> of the
>   examples), as welll as .tac and .sql files
>
> - toc entries which end in a "/" character now have "index appended to them
>   in the ReST output, which fixes a few issues where the built-Sphinx docs
>   would end up with broken navigation links.
>
> A couple of issues were also fixed at the PyCon sprints:
>
> - <cite> tags are now handled...sort of.  According to Glyph, these aren't
> really
>   very important, so we just return the contents of the tag without any
> special
>   markup.  If we feel the need to put citation markup back into the docs we
> can
>   do that post-transition.
>
> - Glyph also found an easy way to improve the CSS of the theme somewhat.
> The
>   issue where the sidebar drops below the main content should now be less
> of a
>   problem, though it's not gone entirely.
>
> - Glyph and I also discussed a few different ways to handle links to the
> API docs
>   and agreed on a way forward.  Basically, well change the <code
> class='API'>
>   tags into something like: :api:`path.to.documented object <label>`, and
> then
>   create a docutils extension to convert that into a link.  The beginnings
> of this
>   are in the hg repos, but it looks like it won't be quite as simple as we
> thought.
>
>   First, the way pydoctor generates links is deceptively simple.
>
>   If you look up a module, like "twisted.internet.defer", the link looks
> like
>   this:
>
>
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.html
>
>   If you look up a class, like "twisted.internet.defer.Deferred" for
> example,
>   the link looks like this:
>
>
> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
>
>   Pretty simple right?  But if you look up a function or method like
>   "twisted.internet.defer.Deferred.callback", the link has an anchor, like
> so:
>
>
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
>
>   So we'll need to do some checking on either the api docs or on twisted
> itself
>   to determine what sort of object is being linked to.  Shouldn't be
>   super-difficult, just haven't had time yet.
>
>   Second, I haven't yet figured out how to access the Sphinx config object
> from
>   a docutils role function.  I'm sure this is just a matter of finding an
> example
>   or getting an answer from the mailing list, but I just haven't gotten to
> it yet.
>
> I think the API links are the only major issue still remaining until we
> start doing
> the conversion, so once this issue is handled, I'll probably file a ticket
> and create
> a branch in SVN for the conversion.
>
> If anyone has any docs tickets open, now is the time to get them fixed!
>
>
>
How can I filter for tickets related to lore2sphinx transition in trac?
 I've noticed a few documents that don't seem properly converted. Here's an
example:

http://twistedsphinx.funsize.net/projects/web/howto/web-in-60/asynchronous.html

... which is missing syntax highlighting on code examples and the code
examples are also truncated.

-Drew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100305/e8ca6370/attachment.htm 

From bs1984 at gmail.com  Fri Mar  5 11:27:07 2010
From: bs1984 at gmail.com (Bo Shi)
Date: Fri, 5 Mar 2010 11:27:07 -0500
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
In-Reply-To: <aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
References: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
	<aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
Message-ID: <b48edea61003050827g34e0e6f8xb6bf3efa18c594f7@mail.gmail.com>

Thanks Michael; I have filed #4350.

On Thu, Mar 4, 2010 at 11:51 PM, Michael Hudson-Doyle <micahel at gmail.com> wrote:
> On 4 March 2010 17:46, Bo Shi <bs1984 at gmail.com> wrote:
>> Hi All,
>>
>> I've been struggling with this issue off and on for the better part of
>> a month now. ?Having implemented a simple git SSH server using some of
>> the Conch examples in the official documentation, I encountered an
>> issue that would cause a git client to throw an error only part of the
>> time.
>
> I think it's a bug in conch.
>
>> The little program to reproduce the issue is found at
>>
>> ? ?http://gist.github.com/321403
>>
>> ? ?(raw version for download)
>> ? ?http://gist.github.com/raw/321403/82ab2111a2709c8fe50a77aabb08565749087408/gitconnbug.py
>>
>> and can be executed to start the sample server. ?Run a command like
>>
>> ? ?# The /abspath/to/git/repo should be readable by the server user
>> ? ?$ git clone ssh://user at localhost:2222/abspath/to/git/repo
>> ? ?(password "user")
>>
>> To test the server. ?On my workstation, I am able to reproduce the
>> error at least once every 5 tries. ?It's definitely not consistent.
>> The behavior I see is attached at the end of this email. ?The client
>> fails due to a premature inConnectionLost() call in the
>> SSHSessionProcessProtocol that sends an EOF.
>>
>> As a workaround, when TraceProcessProtocol.inConnectionLost() is
>> overriden to do nothing, the client error goes away. ?This is somewhat
>> foreign territory for me so I'm not sure whether it's a bug in git or
>> whether it's a bug in the twisted ProcessProtocol implementation. ?RFC
>> 4254 isn't terribly helpful here:
>>
>> ? ?5.3. ?Closing a Channel
>>
>> ? ? ? When a party will no longer send more data to a channel, it SHOULD
>> ? ? ? send SSH_MSG_CHANNEL_EOF.
>>
>> So on the surface the current behavior of sending an EOF appears fine,
>> however, I can't really find any definitive cases of this type of
>> problem popping up via, say, default OpenSSH/git combinations.
>>
>>
>> Any advice? ?Is the gitconnbug.py implementation flawed? ?Should I
>> open a ticket? ?Any git experts know of a case where git-upload-pack
>> might close it's stdout pipe?
>
> I think what's actually happening here is that git-upload-pack is
> closing its *stdin*. ?Why conch reacts to that by shutting down the
> channel, I don't really know -- it doesn't seem right to me. ?Maybe
> it's a simple logic error and it method should be
> 'outConnectionClosed' instead?
>
> At any rate, I think this is a bug -- please file a ticket. ?And
> thanks for the complete example!
>
> Cheers,
> mwh
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Bo Shi
617-942-1744


From foom at fuhm.net  Fri Mar  5 12:07:18 2010
From: foom at fuhm.net (James Y Knight)
Date: Fri, 5 Mar 2010 12:07:18 -0500
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
In-Reply-To: <aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
References: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
	<aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
Message-ID: <808237A7-0671-4A4E-863A-8082CB44356E@fuhm.net>


On Mar 4, 2010, at 11:51 PM, Michael Hudson-Doyle wrote:

> Maybe
> it's a simple logic error and it method should be
> 'outConnectionClosed' instead?

I'd agree with that. Clearly it should not be sending EOF there for  
the server process closing its stdin. One more detail though: you  
actually need to wait for both stdout and stderr to close, not just  
stdout.

[[[Sidenote:
There *is* no standard SSH protocol message for closing your stdin.
But if openssh 5.1 or later connects to an openssh 5.1 or later  
server, it will use the nonstandard eow at openssh.org command to  
indicate a closed stdin.

Thus, on standard ssh servers/clients, the command:
   ssh hostname yes | true
will hang forever. True closed its stdin by virtue of exiting, but  
that can't get propagated across the ssh link. So, yes never gets a  
SIGPIPE, and thus never closes its stdout and the command keeps  
running forever.

But on openssh 5.1 or greater on both ends, it will "work properly".

BTW, you can't reasonably implement this extension in conch even if  
you wanted to, because openssh client will only send it to servers  
which identify themselves as openssh servers.

http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/PROTOCOL
]]]

James


From kamil at lucem.pl  Fri Mar  5 12:15:44 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Fri, 5 Mar 2010 18:15:44 +0100
Subject: [Twisted-Python] Escaping variable names
Message-ID: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>

Hi,

Ive got an issue where a variable name needs to have a minus sign (-) in it.

from SOAPpy import WSDL
wsdlFile = "http://webapi.allegro.pl/uploader.php?wsdl"
server = WSDL.Proxy(wsdlFile)
server.soapproxy.config.argsOrdering = {'doGetCountries': ['country-code',
'webapi-key'] }
server.doGetCountries(country-code=COUNTRYID}, webapi-key=WEBAPIKEY)

The above method allows me to specify the order and name of variables being
sent, but i have a problem since the variables have a "-" sign in the
middle, is there a way to escape it in the variable name or get around the
problem?

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100305/2d98cb60/attachment.htm 

From glyph at twistedmatrix.com  Fri Mar  5 12:25:35 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 5 Mar 2010 12:25:35 -0500
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
In-Reply-To: <808237A7-0671-4A4E-863A-8082CB44356E@fuhm.net>
References: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
	<aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
	<808237A7-0671-4A4E-863A-8082CB44356E@fuhm.net>
Message-ID: <49919B29-FDA1-4C5D-949C-87146E889BFC@twistedmatrix.com>


On Mar 5, 2010, at 12:07 PM, James Y Knight wrote:

> BTW, you can't reasonably implement this extension in conch even if  
> you wanted to, because openssh client will only send it to servers  
> which identify themselves as openssh servers.

Does it just test the banner for being identical, or could we have Conch identify itself as OpenSSH, version (5.1.something+Conch-Not-OpenSSH)?




From maarten at treewalker.org  Fri Mar  5 12:26:36 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Fri, 5 Mar 2010 18:26:36 +0100
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
Message-ID: <201003051826.36391.maarten@treewalker.org>

On Friday 05 March 2010, Kamil Wasilewski wrote:

> from SOAPpy import WSDL
> wsdlFile = "http://webapi.allegro.pl/uploader.php?wsdl"
> server = WSDL.Proxy(wsdlFile)
> server.soapproxy.config.argsOrdering = {'doGetCountries':
> ['country-code', 'webapi-key'] }
> server.doGetCountries(country-code=COUNTRYID}, webapi-key=WEBAPIKEY)
> 
> The above method allows me to specify the order and name of variables
> being sent, but i have a problem since the variables have a "-" sign in
> the middle, is there a way to escape it in the variable name or get
> around the problem?

Yes, you can pass them from a dictionary using the ** syntax:

server.doGetCountries(**{
	'country-code': COUNTRYID, 'webapi-key': WEBAPIKEY
	})

However, if you have the ability to change the API, it would be better to 
use underscores as separators in the argument names instead of dashes.

Bye,
		Maarten


From phil at bubblehouse.org  Fri Mar  5 12:26:46 2010
From: phil at bubblehouse.org (Phil Christensen)
Date: Fri, 5 Mar 2010 12:26:46 -0500
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
Message-ID: <9CD4515D-3B8F-42CC-A160-996B0EC7B1C5@bubblehouse.org>

On Mar 5, 2010, at 12:15 PM, Kamil Wasilewski wrote:
> server.soapproxy.config.argsOrdering = {'doGetCountries': ['country-code', 'webapi-key'] }
> server.doGetCountries(country-code=COUNTRYID}, webapi-key=WEBAPIKEY)
> 
> The above method allows me to specify the order and name of variables being sent, but i have a problem since the variables have a "-" sign in the middle, is there a way to escape it in the variable name or get around the problem?
> 
> Thanks!

try:

server.doGetCountries(**{'country-code':COUNTRYID, 'webapi-key':WEBAPIKEY})

-phil

From kevin.horn at gmail.com  Fri Mar  5 12:33:47 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Fri, 5 Mar 2010 11:33:47 -0600
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <368574aa1003050730p476bee78x5ed0e262783258d3@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
	<368574aa1003050730p476bee78x5ed0e262783258d3@mail.gmail.com>
Message-ID: <562bcc11003050933t3d810980n94aadef31cc6c62c@mail.gmail.com>

On Fri, Mar 5, 2010 at 9:30 AM, Drew Smathers <drew.smathers at gmail.com>wrote:

> On Thu, Mar 4, 2010 at 5:49 PM, Kevin Horn <kevin.horn at gmail.com> wrote:
>
>>
>> It's been a while, I know you were all waiting with baited breath...
>>
>> First a few fixes:
>>
>> - Thanks to Tim Allen and Steve Steiner, several theme issues were fixed.
>> This
>>   fixes a few minor display bugs and should make pages validate properly.
>>
>> - inline markup will now include child contents.  This causes rst not to
>> display
>>   properly in cases of "nested inline markup", but should make it easier
>> to
>>   manually fix these places later
>>
>> - :download: links are now generated for non-rst files ending in .py (most
>> of the
>>   examples), as welll as .tac and .sql files
>>
>> - toc entries which end in a "/" character now have "index appended to
>> them
>>   in the ReST output, which fixes a few issues where the built-Sphinx docs
>>   would end up with broken navigation links.
>>
>> A couple of issues were also fixed at the PyCon sprints:
>>
>> - <cite> tags are now handled...sort of.  According to Glyph, these aren't
>> really
>>   very important, so we just return the contents of the tag without any
>> special
>>   markup.  If we feel the need to put citation markup back into the docs
>> we can
>>   do that post-transition.
>>
>> - Glyph also found an easy way to improve the CSS of the theme somewhat.
>> The
>>   issue where the sidebar drops below the main content should now be less
>> of a
>>   problem, though it's not gone entirely.
>>
>> - Glyph and I also discussed a few different ways to handle links to the
>> API docs
>>   and agreed on a way forward.  Basically, well change the <code
>> class='API'>
>>   tags into something like: :api:`path.to.documented object <label>`, and
>> then
>>   create a docutils extension to convert that into a link.  The beginnings
>> of this
>>   are in the hg repos, but it looks like it won't be quite as simple as we
>> thought.
>>
>>   First, the way pydoctor generates links is deceptively simple.
>>
>>   If you look up a module, like "twisted.internet.defer", the link looks
>> like
>>   this:
>>
>>
>> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.html
>>
>>   If you look up a class, like "twisted.internet.defer.Deferred" for
>> example,
>>   the link looks like this:
>>
>>
>> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
>>
>>   Pretty simple right?  But if you look up a function or method like
>>   "twisted.internet.defer.Deferred.callback", the link has an anchor, like
>> so:
>>
>>
>> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
>>
>>   So we'll need to do some checking on either the api docs or on twisted
>> itself
>>   to determine what sort of object is being linked to.  Shouldn't be
>>   super-difficult, just haven't had time yet.
>>
>>   Second, I haven't yet figured out how to access the Sphinx config object
>> from
>>   a docutils role function.  I'm sure this is just a matter of finding an
>> example
>>   or getting an answer from the mailing list, but I just haven't gotten to
>> it yet.
>>
>> I think the API links are the only major issue still remaining until we
>> start doing
>> the conversion, so once this issue is handled, I'll probably file a ticket
>> and create
>> a branch in SVN for the conversion.
>>
>> If anyone has any docs tickets open, now is the time to get them fixed!
>>
>>
>>
> How can I filter for tickets related to lore2sphinx transition in trac?
>  I've noticed a few documents that don't seem properly converted. Here's an
> example:
>
>
> http://twistedsphinx.funsize.net/projects/web/howto/web-in-60/asynchronous.html
>
> ... which is missing syntax highlighting on code examples and the code
> examples are also truncated.
>
> -Drew
>
>
As far as I know, there aren't any tickets in Trac yet.  I was planning on
making some (or asking others to do so) once a "master ticket" and a branch
are created.

As for the specific issue you linked to, the ReST markup is similar to that
on other pages, but it looks like Sphinx isn't recognizing the code samples
as Python for some reason.  I'll look into this later on.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100305/40aa08ed/attachment.htm 

From kamil at lucem.pl  Fri Mar  5 12:35:33 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Fri, 5 Mar 2010 18:35:33 +0100
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <201003051826.36391.maarten@treewalker.org>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
	<201003051826.36391.maarten@treewalker.org>
Message-ID: <208117684.20100305183533@lucem.pl>

Hello Maarten,

Friday, March 5, 2010, 6:26:36 PM, you wrote:

> On Friday 05 March 2010, Kamil Wasilewski wrote:

>> from SOAPpy import WSDL
>> wsdlFile = "http://webapi.allegro.pl/uploader.php?wsdl"
>> server = WSDL.Proxy(wsdlFile)
>> server.soapproxy.config.argsOrdering = {'doGetCountries':
>> ['country-code', 'webapi-key'] }
>> server.doGetCountries(country-code=COUNTRYID}, webapi-key=WEBAPIKEY)
>> 
>> The above method allows me to specify the order and name of variables
>> being sent, but i have a problem since the variables have a "-" sign in
>> the middle, is there a way to escape it in the variable name or get
>> around the problem?

> Yes, you can pass them from a dictionary using the ** syntax:

> server.doGetCountries(**{
>         'country-code': COUNTRYID, 'webapi-key': WEBAPIKEY
>         })

          The above gives a syntax error...

> However, if you have the ability to change the API, it would be better to
> use underscores as separators in the argument names instead of dashes.

  Unfortunately the designer of the API is a large British company that
  forgot to take into account other languages than PHP.



From maarten at treewalker.org  Fri Mar  5 12:55:10 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Fri, 5 Mar 2010 18:55:10 +0100
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <208117684.20100305183533@lucem.pl>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
	<201003051826.36391.maarten@treewalker.org>
	<208117684.20100305183533@lucem.pl>
Message-ID: <201003051855.10706.maarten@treewalker.org>

On Friday 05 March 2010, Kamil Wasilewski wrote:
> > server.doGetCountries(**{
> >         'country-code': COUNTRYID, 'webapi-key': WEBAPIKEY
> >         })
> 
>           The above gives a syntax error...

What kind of syntax error? I tested this approached on the interactive 
Python shell and it worked fine there:

>>> def f(**kvargs):
...   print kvargs
... 
>>> f(a = 1, **{'b-c': 12})
{'a': 1, 'b-c': 12}

Bye,
		Maarten


From kamil at lucem.pl  Fri Mar  5 13:11:10 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Fri, 5 Mar 2010 19:11:10 +0100
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <201003051855.10706.maarten@treewalker.org>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
	<201003051826.36391.maarten@treewalker.org>
	<208117684.20100305183533@lucem.pl>
	<201003051855.10706.maarten@treewalker.org>
Message-ID: <969405264.20100305191110@lucem.pl>


> On Friday 05 March 2010, Kamil Wasilewski wrote:
>> > server.doGetCountries(**{
>> >         'country-code': COUNTRYID, 'webapi-key': WEBAPIKEY
>> >         })
>> 
>>           The above gives a syntax error...

> What kind of syntax error? I tested this approached on the interactive
> Python shell and it worked fine there:

>>>> def f(**kvargs):
> ...   print kvargs
> ... 
>>>> f(a = 1, **{'b-c': 12})
> {'a': 1, 'b-c': 12}


    hu, it did work.. must of been a mistake on my part.
    But i tried that method a few times.
    Well that solved a problem ive been sitting on for a while. Thank you!



From lvh at laurensvh.be  Fri Mar  5 15:22:47 2010
From: lvh at laurensvh.be (Laurens Van Houtven)
Date: Fri, 5 Mar 2010 21:22:47 +0100
Subject: [Twisted-Python] R: Twisted Python on Nokia E71x (Running the
	phone Python Interpreter)
In-Reply-To: <4B90D300.8060804@thiengineering.ch>
References: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>
	<4B90D300.8060804@thiengineering.ch>
Message-ID: <cedc0c091003051222r1cf1fce9qbaaafb8f477309f@mail.gmail.com>

I don't use PUTools when developing for PyS60. The bluetooth console
was nice, but recent versions of PyS60 ship with it already. My phone
(6220 Classic) lets me do obex + bluetooth serial console at the same
time so file sync is not a problem either.


hth
lvh


From lvh at laurensvh.be  Sat Mar  6 04:32:01 2010
From: lvh at laurensvh.be (Laurens Van Houtven)
Date: Sat, 6 Mar 2010 10:32:01 +0100
Subject: [Twisted-Python] R: Twisted Python on Nokia E71x (Running the
	phone Python Interpreter)
In-Reply-To: <cedc0c091003051222r1cf1fce9qbaaafb8f477309f@mail.gmail.com>
References: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>
	<4B90D300.8060804@thiengineering.ch>
	<cedc0c091003051222r1cf1fce9qbaaafb8f477309f@mail.gmail.com>
Message-ID: <cedc0c091003060132i5c3a5a05w7c8e9a2a7b34e7d@mail.gmail.com>

On a different note: has anyone figured out how to make the PyS60 GUI
abstraction layer (appuifw) work with Twisted?

Almost all of the API (the stuff that isn't stdlib) is non-blocking,
but I have no idea how to make it work nicely with the Twisted
reactor. So far I'm writing the app on it using just the stdlib but
that's proving to be amazingly annoying (no way of doing ssl cert
verification? really?) :-|


Thanks in advance,
Laurens


From jml at mumak.net  Sat Mar  6 13:33:37 2010
From: jml at mumak.net (Jonathan Lange)
Date: Sat, 6 Mar 2010 18:33:37 +0000
Subject: [Twisted-Python] 10.0.0 post-release actions
Message-ID: <d06a5cd31003061033t5491eb3al2bebe9b0b5bed69d@mail.gmail.com>

Hello all,

10.0.0 is well-and-truly released. Jean-Paul has just updated the
website documentation and I've made notes on what he did and stored it
at http://twistedmatrix.com/trac/wiki/ReleaseProcess.

My plan now is this:
  * Roll out a 10.0.1 release
  * Give ReleaseProcess a lot of love, turning it into a readable,
useful document rather than a bunch of raw data
  * Make sure tickets are filed on all of the hard bits of the process
  * Schedule a 10.1 release
  * Fix the tickets that made the process hard
  * Do the 10.1 release
  * Find someone willing to be release manager for 10.2 and 10.3

Regarding the 10.0.1 release. The milestone[1] has two open tickets,
one of which has a patch sans tests, and the other is mostly minor
defects. I will try to roll out a 10.0.1 release soon that fixes both
of these issues.

There is also an open ticket which *might* be a regression:
http://twistedmatrix.com/trac/ticket/4351.

What you can do to help:
  * Investigate #4351 and decide whether or not it's a regression
  * Land a patch for http://twistedmatrix.com/trac/ticket/4210
  * Fix tickets on the regular-releases milestone[2]

cheers,
jml

[1] http://twistedmatrix.com/trac/query?status=new&status=assigned&status=reopened&milestone=Twisted-10.0&order=priority
[2] http://twistedmatrix.com/trac/query?status=new&status=assigned&status=reopened&milestone=regular-releases&order=priority


From jml at mumak.net  Sat Mar  6 13:38:36 2010
From: jml at mumak.net (Jonathan Lange)
Date: Sat, 6 Mar 2010 18:38:36 +0000
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
Message-ID: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>

Hello all,

Ubuntu's "Lucid Lynx" is now in feature freeze, meaning that it won't
automatically take new versions of packages (see
https://wiki.ubuntu.com/FeatureFreeze).

Since we've just released Twisted 10.0.0 and since the release is
awesome, stable, low-risk and a great thing to have in the next
long-term support version of Ubuntu, I think we should strive to get a
"Feature Freeze expection" (aka an "FFe").

I've followed the https://wiki.ubuntu.com/FreezeExceptionProcess and
have filed a bug at
https://bugs.edge.launchpad.net/ubuntu/+source/twisted/+bug/531977.
But I need help.

The FFe process requires a packaged version of the new release, along
with build files and what not. I lack the expertise to do this, so I'd
very much appreciate it if someone here who knows Debian/Ubuntu
packaging could please package the new 10.0.0 release and attach the
relevant files to the bug.

Thanks,
jml


From exarkun at twistedmatrix.com  Sun Mar  7 00:05:15 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 07 Mar 2010 05:05:15 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1267938315.66.1779965534@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100307/fd281f50/attachment.htm 

From free at 64studio.com  Sun Mar  7 08:02:06 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Sun, 07 Mar 2010 14:02:06 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	(Jonathan Lange's message of "Sat, 6 Mar 2010 18:38:36 +0000")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
Message-ID: <87hbosgu9d.fsf@canonical.com>

Hi Jonathan,

|--==> On Sat, 6 Mar 2010 18:38:36 +0000, Jonathan Lange <jml at mumak.net> said:

  JL> Since we've just released Twisted 10.0.0 and since the release is
  JL> awesome, stable, low-risk and a great thing to have in the next
  JL> long-term support version of Ubuntu, I think we should strive to get a
  JL> "Feature Freeze expection" (aka an "FFe").

Definitely. I guess this involves updating all the various twisted-X
packages.

  JL> I've followed the https://wiki.ubuntu.com/FreezeExceptionProcess and
  JL> have filed a bug at
  JL> https://bugs.edge.launchpad.net/ubuntu/+source/twisted/+bug/531977.
  JL> But I need help.

If we want to update all twisted Ubuntu packages and not only the -core
one, I *think* we need a separate bug filed against each of them. A
quick answer on #ubuntu-devel should clear this out.

It looks like the only API removal that could raise compatibility issues
is:

 - The deprecated connectUDP method of IReactorUDP has now been
   removed. (#4075)

I'm wondering if there's any code in Ubuntu packages relying on it.

  JL> The FFe process requires a packaged version of the new release, along
  JL> with build files and what not. I lack the expertise to do this, so I'd
  JL> very much appreciate it if someone here who knows Debian/Ubuntu
  JL> packaging could please package the new 10.0.0 release and attach the
  JL> relevant files to the bug.

Have you already asked Matthias Klose (the maintainer) if he is
interested in updating the packages himself? If not, I'll be glad to
help out.

Ciao!

Free


From jml at mumak.net  Sun Mar  7 08:10:46 2010
From: jml at mumak.net (Jonathan Lange)
Date: Sun, 7 Mar 2010 13:10:46 +0000
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87hbosgu9d.fsf@canonical.com>
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
Message-ID: <d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>

On Sun, Mar 7, 2010 at 1:02 PM, Free Ekanayaka <free at 64studio.com> wrote:
> Hi Jonathan,
>
> |--==> On Sat, 6 Mar 2010 18:38:36 +0000, Jonathan Lange <jml at mumak.net> said:
>
> ?JL> Since we've just released Twisted 10.0.0 and since the release is
> ?JL> awesome, stable, low-risk and a great thing to have in the next
> ?JL> long-term support version of Ubuntu, I think we should strive to get a
> ?JL> "Feature Freeze expection" (aka an "FFe").
>
> Definitely. I guess this involves updating all the various twisted-X
> packages.
>
> ?JL> I've followed the https://wiki.ubuntu.com/FreezeExceptionProcess and
> ?JL> have filed a bug at
> ?JL> https://bugs.edge.launchpad.net/ubuntu/+source/twisted/+bug/531977.
> ?JL> But I need help.
>
> If we want to update all twisted Ubuntu packages and not only the -core
> one, I *think* we need a separate bug filed against each of them. A
> quick answer on #ubuntu-devel should clear this out.
>

They have separate source packages? If so, yes we would need separate FFes.

Do you want to do this?

> It looks like the only API removal that could raise compatibility issues
> is:
>
> ?- The deprecated connectUDP method of IReactorUDP has now been
> ? removed. (#4075)
>
> I'm wondering if there's any code in Ubuntu packages relying on it.
>

How would we find out?

> ?JL> The FFe process requires a packaged version of the new release, along
> ?JL> with build files and what not. I lack the expertise to do this, so I'd
> ?JL> very much appreciate it if someone here who knows Debian/Ubuntu
> ?JL> packaging could please package the new 10.0.0 release and attach the
> ?JL> relevant files to the bug.
>
> Have you already asked Matthias Klose (the maintainer) if he is
> interested in updating the packages himself? If not, I'll be glad to
> help out.
>

No, I haven't. It'd be great if you could sort this out.

Thanks,
jml


From free at 64studio.com  Sun Mar  7 09:20:23 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Sun, 07 Mar 2010 15:20:23 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	(Jonathan Lange's message of "Sun, 7 Mar 2010 13:10:46 +0000")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
Message-ID: <87d3zggqmw.fsf@canonical.com>

|--==> On Sun, 7 Mar 2010 13:10:46 +0000, Jonathan Lange <jml at mumak.net> said:

  >>If we want to update all twisted Ubuntu packages and not only the -core
  >>one, I *think* we need a separate bug filed against each of them. A
  >>quick answer on #ubuntu-devel should clear this out.
  >>

  > They have separate source packages? If so, yes we would need
  > separate FFes.

Yes, the have separate source packages.

  > Do you want to do this?

Sure.

  >>It looks like the only API removal that could raise compatibility issues
  >>is:
  >>
  >>?- The deprecated connectUDP method of IReactorUDP has now been
  >>? removed. (#4075)
  >>
  >>I'm wondering if there's any code in Ubuntu packages relying on it.
  >>

  > How would we find out?

Good question. Something like pulling the source packages of all
packages directly or indirectly depending on python-twisted-core and
grepping for connectUDP.

  >>Have you already asked Matthias Klose (the maintainer) if he is
  >>interested in updating the packages himself? If not, I'll be glad to
  >>help out.
  >>

  > No, I haven't. It'd be great if you could sort this out.

Okay, I'll check that.

Ciao!

Free


From exarkun at twistedmatrix.com  Sun Mar  7 09:54:23 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 07 Mar 2010 14:54:23 -0000
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87d3zggqmw.fsf@canonical.com>
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
Message-ID: <20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>

On 02:20 pm, free at 64studio.com wrote:
>|--==> On Sun, 7 Mar 2010 13:10:46 +0000, Jonathan Lange 
><jml at mumak.net> said:
>
>  >>If we want to update all twisted Ubuntu packages and not only the 
>-core
>  >>one, I *think* we need a separate bug filed against each of them. A
>  >>quick answer on #ubuntu-devel should clear this out.
>  >>
>
>  > They have separate source packages? If so, yes we would need
>  > separate FFes.
>
>Yes, the have separate source packages.
>
>  > Do you want to do this?
>
>Sure.
>
>  >>It looks like the only API removal that could raise compatibility 
>issues
>  >>is:
>  >>
>  >>?- The deprecated connectUDP method of IReactorUDP has now been
>  >>? removed. (#4075)
>  >>
>  >>I'm wondering if there's any code in Ubuntu packages relying on it.
>  >>
>
>  > How would we find out?
>
>Good question. Something like pulling the source packages of all
>packages directly or indirectly depending on python-twisted-core and
>grepping for connectUDP.

I looked at the direct (apt-cache rdepends python-twisted | tail -n +3) 
and once removed (apt-cache rdepends python-twisted | tail -n +3 | xargs 
-iF bash -c 'apt-cache rdepends F | tail -n +3' | sort | uniq) 
dependencies of python-twisted.

One package refers to connectUDP, flumotion.  It doesn't appear to 
actually use it, though; instead it seems to be monkey-patching it to 
correct a documentation issue.  I don't think the removal will break 
this package, but it may result in flumotion-generated Twisted docs 
which include connectUDP, even though it no longer exists.
>
>  >>Have you already asked Matthias Klose (the maintainer) if he is
>  >>interested in updating the packages himself? If not, I'll be glad to
>  >>help out.
>  >>
>
>  > No, I haven't. It'd be great if you could sort this out.
>
>Okay, I'll check that.
>
>Ciao!

Thanks!

Jean-Paul


From darren at ontrenet.com  Sun Mar  7 10:10:51 2010
From: darren at ontrenet.com (Darren Govoni)
Date: Sun, 07 Mar 2010 10:10:51 -0500
Subject: [Twisted-Python] Synchronous byte streaming
Message-ID: <1267974651.10456.43.camel@kratos>

Hi,
  I received some great advice in the past about using
Int32StringReceiver to be able to send a reliable message of bytes
from the client to the server without hassling with unordered or partial
messages. Seems to work.

But I have one problem. My client iterates over a file sending 7MB byte
messages to transport.sendString() to a server.
What i see is that the client seems to buffer or wait to send those.
After a few hundred sendStrings() still the server has not received one
message. The result is my client gets throttled bad in terms of disk and
memory. After all my sendString writes, then eventually the server
receives the first message. But my computer is 100% max'd out.  highly
undesirable.

What I want is for each on-the-wire send to complete, before sendString
returns so resources can be managed properly.

Is there _any_ way in Twisted to do this?

thanks for any tips!!

Darren
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100307/9d06698d/attachment.htm 

From exarkun at twistedmatrix.com  Sun Mar  7 10:19:55 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 07 Mar 2010 15:19:55 -0000
Subject: [Twisted-Python] Synchronous byte streaming
In-Reply-To: <1267974651.10456.43.camel@kratos>
References: <1267974651.10456.43.camel@kratos>
Message-ID: <20100307151955.2792.950916271.divmod.xquotient.1375@localhost.localdomain>

On 03:10 pm, darren at ontrenet.com wrote:
>Hi,
>  I received some great advice in the past about using
>Int32StringReceiver to be able to send a reliable message of bytes
>from the client to the server without hassling with unordered or 
>partial
>messages. Seems to work.
>
>But I have one problem. My client iterates over a file sending 7MB byte
>messages to transport.sendString() to a server.
>What i see is that the client seems to buffer or wait to send those.
>After a few hundred sendStrings() still the server has not received one
>message. The result is my client gets throttled bad in terms of disk 
>and
>memory. After all my sendString writes, then eventually the server
>receives the first message. But my computer is 100% max'd out.  highly
>undesirable.
>
>What I want is for each on-the-wire send to complete, before sendString
>returns so resources can be managed properly.
>
>Is there _any_ way in Twisted to do this?

You want to make your client use the producer/consumer APIs.  You can 
find some docs here:

  http://twistedmatrix.com/documents/current/core/howto/producers.html

Here's a simple example of what you might do:

    class SendSomeStuff(Int32StringReceiver):
        def connectionMade(self):
            self.transport.registerProducer(self, False)

        def resumeProducing(self):
            self.sendString(self.someFileObj.read(2 ** 16))


This is missing error handling some of the other required parts of the 
producer interface, but it should get you started.

Jean-Paul


From darren at ontrenet.com  Sun Mar  7 10:33:02 2010
From: darren at ontrenet.com (Darren Govoni)
Date: Sun, 07 Mar 2010 10:33:02 -0500
Subject: [Twisted-Python] Synchronous byte streaming
In-Reply-To: <20100307151955.2792.950916271.divmod.xquotient.1375@localhost.localdomain>
References: <1267974651.10456.43.camel@kratos>
	<20100307151955.2792.950916271.divmod.xquotient.1375@localhost.localdomain>
Message-ID: <1267975982.10456.44.camel@kratos>

Many thanks! I will try it.

On Sun, 2010-03-07 at 15:19 +0000, exarkun at twistedmatrix.com wrote:

> 
> You want to make your client use the producer/consumer APIs.  You can 
> find some docs here:
> 
> 
> http://twistedmatrix.com/documents/current/core/howto/producers.html 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100307/86535357/attachment.htm 

From sleeepd at gmail.com  Mon Mar  8 00:36:28 2010
From: sleeepd at gmail.com (sleepd)
Date: Mon, 8 Mar 2010 13:36:28 +0800
Subject: [Twisted-Python] How to use time-base event in reactor?
Message-ID: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>

I am developing a online RTS game server, some event a base by time,
example: a buff grant Max HP for 30 seconds, spawn army ever 30 seconds...

I plan to use a timer to manage it, but Twisted are event-driven, how to put
this timer in reactor's loop?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100308/65ac1c85/attachment.htm 

From radix at twistedmatrix.com  Mon Mar  8 01:46:10 2010
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 8 Mar 2010 00:46:10 -0600
Subject: [Twisted-Python] How to use time-base event in reactor?
In-Reply-To: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
Message-ID: <60ed19d41003072246i31da37e1ndfff9967936a23fb@mail.gmail.com>

On Sun, Mar 7, 2010 at 11:36 PM, sleepd <sleeepd at gmail.com> wrote:
> I am developing a online RTS game server, some event a base by time,
> example: a buff grant Max HP for 30 seconds, spawn army ever 30 seconds...
> I plan to use a timer to manage it, but Twisted are?event-driven, how to put
> this timer in reactor's loop?

See:

reactor.callLater

twisted.internet.task.LoopingCall



-- 
Christopher Armstrong
http://radix.twistedmatrix.com/
http://planet-if.com/


From free at 64studio.com  Mon Mar  8 05:30:18 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Mon, 08 Mar 2010 11:30:18 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	(exarkun@twistedmatrix.com's message of "Sun, 07 Mar 2010 14:54:23
	-0000")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
Message-ID: <87hbor2jid.fsf@canonical.com>

Hi,

|--==> On Sun, 07 Mar 2010 14:54:23 -0000, exarkun at twistedmatrix.com said:

  >>Good question. Something like pulling the source packages of all
  >>packages directly or indirectly depending on python-twisted-core and
  >>grepping for connectUDP.

  > I looked at the direct (apt-cache rdepends python-twisted | tail -n
  > +3) and once removed (apt-cache rdepends python-twisted | tail -n +3 |
  > xargs -iF bash -c 'apt-cache rdepends F | tail -n +3' | sort | uniq)
  > dependencies of python-twisted.

  > One package refers to connectUDP, flumotion.  It doesn't appear to
  > actually use it, though; instead it seems to be monkey-patching it to
  > correct a documentation issue.  I don't think the removal will break
  > this package, but it may result in flumotion-generated Twisted docs
  > which include connectUDP, even though it no longer exists.

Thanks for checking, it looks we're good then.

  >>>>Have you already asked Matthias Klose (the maintainer) if he is
  >>>>interested in updating the packages himself? If not, I'll be glad to
  >>>>help out.
  >>>>
  >>
  >>> No, I haven't. It'd be great if you could sort this out.
  >>
  >>Okay, I'll check that.

Matthias said he thinks that a Feature Freeze Exception is fine for
Twisted 10.0.0, and I can go on packaging it. There are quite a few
source packages to update, I'll try to do it in the coming days.

Ciao!

Free


From Sven-Erik.Tiberg at ltu.se  Mon Mar  8 06:55:10 2010
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Mon, 8 Mar 2010 12:55:10 +0100
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
Message-ID: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>

Hi

Setting up ejabberd server and python.twisted clients for interactive3D.
In for example the lib...twisted.words.protocols.jabber\component.py there are a call to zope.interface.

Doesnt seems to be a call to the zope db-server that powers Plone servers, is that correct?
PS. having plone/zope servers running at the same server that can be running xmpp___.py clients.

BG
Sven-Erik Tiberg
Lulea Univ of technology / Sweden

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100308/d6424283/attachment.htm 

From itamar at itamarst.org  Mon Mar  8 07:47:04 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 08 Mar 2010 07:47:04 -0500
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
Message-ID: <1268052425.5589.150.camel@pintsize>

On Mon, 2010-03-08 at 12:55 +0100, Sven-Erik Tiberg wrote:
> Hi
>  
> Setting up ejabberd server and python.twisted clients for
> interactive3D.
> In for example the lib...twisted.words.protocols.jabber\component.py
> there are a call to zope.interface.
>  
> Doesnt seems to be a call to the zope db-server that powers Plone
> servers, is that correct?
> PS. having plone/zope servers running at the same server that can be
> running xmpp___.py clients.

zope.interface is a very small library; the fact it has "zope" in the
name doesn't mean it uses the full capabilities of a Zope server. You
are correct, it does not use the Zope database.

You can download it separately here:
http://pypi.python.org/pypi/zope.interface#download




From Sven-Erik.Tiberg at ltu.se  Mon Mar  8 09:36:22 2010
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Mon, 8 Mar 2010 15:36:22 +0100
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <1268052425.5589.150.camel@pintsize>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
	<1268052425.5589.150.camel@pintsize>
Message-ID: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB92@VERA.personal.adp.ltu.se>

Thanks

Only to clearify:
Has zope.interface any depedencies/connection with the Zope web application server primarily written in the Python programming language  ( http://www.zope.org/WhatIsZope ). 

Note: zope "web application server" uses ZODB ( http://docs.zope.org/zodb/ ) as data base. 
And plone (http://plone.org ) a CMS system are based on zope.

More notes on http://wbsp.arb.ltu.se/3DNetwork/

BG
Sven-Erik Tiberg



-----Original Message-----
From: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-bounces at twistedmatrix.com] On Behalf Of Itamar Turner-Trauring
Sent: den 8 mars 2010 13:47
To: Twisted general discussion
Subject: Re: [Twisted-Python] zope.interface?

On Mon, 2010-03-08 at 12:55 +0100, Sven-Erik Tiberg wrote:
> Hi
>  
> Setting up ejabberd server and python.twisted clients for 
> interactive3D.
> In for example the lib...twisted.words.protocols.jabber\component.py
> there are a call to zope.interface.
>  
> Doesnt seems to be a call to the zope db-server that powers Plone 
> servers, is that correct?
> PS. having plone/zope servers running at the same server that can be 
> running xmpp___.py clients.

zope.interface is a very small library; the fact it has "zope" in the name doesn't mean it uses the full capabilities of a Zope server. You are correct, it does not use the Zope database.

You can download it separately here:
http://pypi.python.org/pypi/zope.interface#download



_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From itamar at itamarst.org  Mon Mar  8 09:47:39 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 08 Mar 2010 09:47:39 -0500
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB92@VERA.personal.adp.ltu.se>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
	<1268052425.5589.150.camel@pintsize>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB92@VERA.personal.adp.ltu.se>
Message-ID: <1268059659.3486.4.camel@pintsize>

On Mon, 2010-03-08 at 15:36 +0100, Sven-Erik Tiberg wrote:
> Thanks
> 
> Only to clearify:
> Has zope.interface any depedencies/connection with the Zope web
> application server primarily written in the Python programming
> language  ( http://www.zope.org/WhatIsZope ). 
> 
> Note: zope "web application server" uses ZODB
> ( http://docs.zope.org/zodb/ ) as data base. 
> And plone (http://plone.org ) a CMS system are based on zope.

They are connected, yes. zope.interface is maintained by Zope people,
but it's only a small subset of their code:

1. Twisted depends on zope.interface
2. Zope depends on zope.interface

But

3. Twisted does *not* depend on Zope, ZODB, Plone, etc..

You can pretend it's just called "interface" if that helps :)



From Sven-Erik.Tiberg at ltu.se  Mon Mar  8 10:43:12 2010
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Mon, 8 Mar 2010 16:43:12 +0100
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <1268059659.3486.4.camel@pintsize>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
	<1268052425.5589.150.camel@pintsize>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB92@VERA.personal.adp.ltu.se>
	<1268059659.3486.4.camel@pintsize>
Message-ID: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB95@VERA.personal.adp.ltu.se>

It's even more "challanging" ZOPE vers. uses a modified zope.interface lib.
Not a great idea to run both plone and python.twisted... On the same windows mashine, thoung it could eb a challange but better save time to the main project goal.

BG
Sven-Erik 

-----Original Message-----
From: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-bounces at twistedmatrix.com] On Behalf Of Itamar Turner-Trauring
Sent: den 8 mars 2010 15:48
To: Twisted general discussion
Subject: Re: [Twisted-Python] zope.interface?

On Mon, 2010-03-08 at 15:36 +0100, Sven-Erik Tiberg wrote:
> Thanks
> 
> Only to clearify:
> Has zope.interface any depedencies/connection with the Zope web 
> application server primarily written in the Python programming 
> language  ( http://www.zope.org/WhatIsZope ).
> 
> Note: zope "web application server" uses ZODB ( 
> http://docs.zope.org/zodb/ ) as data base.
> And plone (http://plone.org ) a CMS system are based on zope.

They are connected, yes. zope.interface is maintained by Zope people, but it's only a small subset of their code:

1. Twisted depends on zope.interface
2. Zope depends on zope.interface

But

3. Twisted does *not* depend on Zope, ZODB, Plone, etc..

You can pretend it's just called "interface" if that helps :)


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From esteve at sindominio.net  Mon Mar  8 16:37:12 2010
From: esteve at sindominio.net (Esteve Fernandez)
Date: Mon, 8 Mar 2010 22:37:12 +0100 (CET)
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87hbor2jid.fsf@canonical.com>
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
Message-ID: <12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>

Hi

> Matthias said he thinks that a Feature Freeze Exception is fine for
> Twisted 10.0.0, and I can go on packaging it. There are quite a few
> source packages to update, I'll try to do it in the coming days.

I uploaded updated version of all the packages to our PPA [1] and requested a
sponsored upload. I've also rebuilt the packages for Karmic, and made a
backport for Hardy for those of us who are not on the bleeding edge :-)

Cheers.

1 - https://launchpad.net/~twisted-dev/+archive/ppa



From free at 64studio.com  Mon Mar  8 19:40:39 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Tue, 09 Mar 2010 01:40:39 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
	(Esteve Fernandez's message of "Mon, 8 Mar 2010 22:37:12 +0100 (CET)")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
	<12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
Message-ID: <87r5nu1g54.fsf@canonical.com>

Hi Esteve,

|--==> On Mon, 8 Mar 2010 22:37:12 +0100 (CET), "Esteve Fernandez" <esteve at sindominio.net> said:

  EF> Hi
  >>Matthias said he thinks that a Feature Freeze Exception is fine for
  >>Twisted 10.0.0, and I can go on packaging it. There are quite a few
  >>source packages to update, I'll try to do it in the coming days.

  EF> I uploaded updated version of all the packages to our PPA [1] and requested a
  EF> sponsored upload. I've also rebuilt the packages for Karmic, and made a
  EF> backport for Hardy for those of us who are not on the bleeding edge :-)

  EF> 1 - https://launchpad.net/~twisted-dev/+archive/ppa

Nice job. I can sponsor the upload to Debian, if that helps (I guess
once all packages are in Debian we can request a sync, and it probably
makes sense as anyway we want to eventually have them in Debian as
well).

I didn't review all the packages yet, but there is one problem with the
python-twisted-core binary package:

~% dpkg -c python-twisted-core_10.0.0-0\~ppa1\~lucid1_all.deb|grep _initgroups.so
-rw-r--r-- root/root     15876 2010-03-08 15:27 ./usr/lib/python2.6/dist-packages/twisted/python/_initgroups.so

The package should be architecture-independent (Architecture: all) and
not ship compiled binaries for C extensions like initgroups, which
should go in the python-twisted-bin package. Otherwise the package will
be built on a random builder and the resulting arch-dependent binary
module will be shipped to all architectures.

Fwiw I uploaded the core twisted source package to Debian today.

http://packages.qa.debian.org/t/twisted.html

Ciao!

Free


From esteve at sindominio.net  Tue Mar  9 07:03:31 2010
From: esteve at sindominio.net (Esteve Fernandez)
Date: Tue, 9 Mar 2010 13:03:31 +0100 (CET)
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87r5nu1g54.fsf@canonical.com>
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
	<12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
	<87r5nu1g54.fsf@canonical.com>
Message-ID: <69176f9efd48b6c2d86afa212264d12b.squirrel@webmail.sindominio.net>

Hi Free

> Nice job. I can sponsor the upload to Debian, if that helps (I guess
> once all packages are in Debian we can request a sync, and it probably
> makes sense as anyway we want to eventually have them in Debian as
> well).

Thanks! However, there are some glitches in the packages you uploaded to Debian:

- they skipped 9.0.0-2, and thus #566395 and #566913 are open again
- python-twisted doesn't depend on >= 10.0.0, but >= 9.0

Those bugs were fixed in the packages in our PPA, though.

> ~% dpkg -c python-twisted-core_10.0.0-0\~ppa1\~lucid1_all.deb|grep
> _initgroups.so
> -rw-r--r-- root/root     15876 2010-03-08 15:27
> ./usr/lib/python2.6/dist-packages/twisted/python/_initgroups.so

Thanks, I didn't notice that, I should have read the NEWS file :-P

What should we do next? Can the currently packages in Debian be revoked or do
we have to prepare new ones?

Cheers.



From free at 64studio.com  Tue Mar  9 07:39:01 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Tue, 09 Mar 2010 13:39:01 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <69176f9efd48b6c2d86afa212264d12b.squirrel@webmail.sindominio.net>
	(Esteve Fernandez's message of "Tue, 9 Mar 2010 13:03:31 +0100 (CET)")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
	<12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
	<87r5nu1g54.fsf@canonical.com>
	<69176f9efd48b6c2d86afa212264d12b.squirrel@webmail.sindominio.net>
Message-ID: <87wrxlvfdm.fsf@canonical.com>

Hi Esteve,

|--==> On Tue, 9 Mar 2010 13:03:31 +0100 (CET), "Esteve Fernandez" <esteve at sindominio.net> said:

  EF> Thanks! However, there are some glitches in the packages you uploaded to Debian:

  EF> - they skipped 9.0.0-2, and thus #566395 and #566913 are open again
  EF> - python-twisted doesn't depend on >= 10.0.0, but >= 9.0

Oh, you're right! Thanks for reporting.

  EF> Those bugs were fixed in the packages in our PPA, though.

Apart from these tweaks to the core twisted source package, are there
other particular changes you had to do in the rest of twisted-X source
packages in the PPA?

  EF> What should we do next? Can the currently packages in Debian be revoked or do
  EF> we have to prepare new ones?

I've just prepared a new revision (10.0.0-2) with the two fixes you
reported and gonna upload it soon.

Ciao!

Free


From free at 64studio.com  Tue Mar  9 11:17:54 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Tue, 09 Mar 2010 17:17:54 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87wrxlvfdm.fsf@canonical.com> (Free Ekanayaka's message of "Tue, 
	09 Mar 2010 13:39:01 +0100")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
	<12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
	<87r5nu1g54.fsf@canonical.com>
	<69176f9efd48b6c2d86afa212264d12b.squirrel@webmail.sindominio.net>
	<87wrxlvfdm.fsf@canonical.com>
Message-ID: <87fx49v58t.fsf@canonical.com>

Hi,

|--==> On Tue, 09 Mar 2010 13:39:01 +0100, Free Ekanayaka <free at 64studio.com> said:

  EF> What should we do next? Can the currently packages in Debian be revoked or do
  EF> we have to prepare new ones?

  FE> I've just prepared a new revision (10.0.0-2) with the two fixes you
  FE> reported and gonna upload it soon.

That's uploaded to Debian/unstable along with the other twisted-X source
packages.

I'm going to request a sync for the Lucid packages.

Ciao!

Free


From dvkeeney at gmail.com  Tue Mar  9 12:21:49 2010
From: dvkeeney at gmail.com (David)
Date: Tue, 9 Mar 2010 10:21:49 -0700
Subject: [Twisted-Python] web2 -> web ToDo List
In-Reply-To: <562bcc11002061033i61a22c3yf37f9b8c4614a20f@mail.gmail.com>
References: <2F213830-E178-46BB-A225-721F656680EC@gmail.com>
	<20100206153444.26099.538054602.divmod.xquotient.508@localhost.localdomain>
	<BF7D3202-9A60-46C0-97DE-2D0CBF894CB9@gmail.com>
	<20100206172345.26099.1877063066.divmod.xquotient.534@localhost.localdomain>
	<562bcc11002061033i61a22c3yf37f9b8c4614a20f@mail.gmail.com>
Message-ID: <6e04113a1003090921x6fb4ac4cxc5771ce02c599135@mail.gmail.com>

>> Awesome, thanks for adding to the list. :) ?Now that there are two items
>> on it, I've added a section to the end of
>> <http://twistedmatrix.com/trac/wiki/TwistedWebPlan>. ?I encourage anyone
>> with interest in this area to suggest more items for this list.


Does nobody care about web2's rational separation of Request and
Response objects, or the use of header dictionaries and ByteStreams in
the response?

The approach used in web (render() returning a string or a
'NOT_DONE_YET' and then writing through the request and calling
finish() IIRC) is clunky and confusing.

Is there a way to backport the web2 system and retain backward
compatibility with existing user code?


Unaware of web2 until recently, I previously subclassed web.http and
web.server to implement upload streaming, and found myself rewriting
'private' methods.  'private' in this case refers to methods that are
commented as 'not intended for users'.  It would be nice to expose
many of the request parsing methods to users, and restructure the
request parsing so that method overriding can be done cleanly.

This is similar to, but maybe more ambitious than, one of the items
previously mentioned in the web2 features-to-backport list.



-- 
dkeeney at travelbyroad.net
Rdbhost -> SQL databases as a webservice [www.rdbhost.com]


From exarkun at twistedmatrix.com  Tue Mar  9 12:59:39 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 09 Mar 2010 17:59:39 -0000
Subject: [Twisted-Python] web2 -> web ToDo List
In-Reply-To: <6e04113a1003090921x6fb4ac4cxc5771ce02c599135@mail.gmail.com>
References: <2F213830-E178-46BB-A225-721F656680EC@gmail.com>
	<20100206153444.26099.538054602.divmod.xquotient.508@localhost.localdomain>
	<BF7D3202-9A60-46C0-97DE-2D0CBF894CB9@gmail.com>
	<20100206172345.26099.1877063066.divmod.xquotient.534@localhost.localdomain>
	<562bcc11002061033i61a22c3yf37f9b8c4614a20f@mail.gmail.com>
	<6e04113a1003090921x6fb4ac4cxc5771ce02c599135@mail.gmail.com>
Message-ID: <20100309175939.2792.1510691846.divmod.xquotient.1454@localhost.localdomain>

On 05:21 pm, dvkeeney at gmail.com wrote:
>>>Awesome, thanks for adding to the list. :) ?Now that there are two 
>>>items
>>>on it, I've added a section to the end of
>>><http://twistedmatrix.com/trac/wiki/TwistedWebPlan>. ?I encourage 
>>>anyone
>>>with interest in this area to suggest more items for this list.
>
>Does nobody care about web2's rational separation of Request and
>Response objects, or the use of header dictionaries and ByteStreams in
>the response?
>
>The approach used in web (render() returning a string or a
>'NOT_DONE_YET' and then writing through the request and calling
>finish() IIRC) is clunky and confusing.

Separation of Request and Response is a good idea, I think.  Chris 
Armstrong started working on this some time ago (a year?  two?) but I 
think the amount of work involved was more than he bargained for and as 
far as I know he doesn't have any specific plans to complete the work.

The ticket for that is http://twistedmatrix.com/trac/ticket/2983

There's also a ticket for allowing render to return a Deferred, #3711. 
And similarly, one to allow getChild to return a Deferred, #3621.

I've added links to these tickets to the TwistedWebPlan page.

The plan is to not backport the streams APIs, but instead support the 
existing producer/consumer APIs in more places, or to come up with 
streaming APIs which can be used throughout Twisted, get them into core, 
and then use them in Twisted Web (or perhaps do both of these).

I'm not sure what you mean when you say "use of header dictionaries".
>
>Is there a way to backport the web2 system and retain backward
>compatibility with existing user code?

There should be, yes.  The details depend on the specifics of the APIs, 
of course.
>
>Unaware of web2 until recently, I previously subclassed web.http and
>web.server to implement upload streaming, and found myself rewriting
>'private' methods.  'private' in this case refers to methods that are
>commented as 'not intended for users'.  It would be nice to expose
>many of the request parsing methods to users, and restructure the
>request parsing so that method overriding can be done cleanly.
>
>This is similar to, but maybe more ambitious than, one of the items
>previously mentioned in the web2 features-to-backport list.

These comments are from a time before our current compatibility policy. 
Very likely they should all be deleted.  If you can use or override a 
method without touching something that starts with an underscore, then 
it's public.

Another, perhaps better, argument against touching these bits is that 
they're probably not very well tested.  However, this is easily fixed, 
just contribute tests (and in some cases, documentation) for them. :)

Jean-Paul


From ben at bbarker.co.uk  Wed Mar 10 05:35:01 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 10:35:01 +0000
Subject: [Twisted-Python] sniffing multicast traffic
Message-ID: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>

Hello - I wonder if someone can help:

We have some status info being sent by various machines using
multicast addressed udp packets. I have been attempting to use twisted
to write a python script that will passively monitor on the relevant
port for any udp packets with the specified multicast address, which I
can then parse the payloads of as required.

I have been looking at the examples here:

http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/

But I seem to have trouble getting them to receive anything at all.

I have managed to use tshark to display the packets :

tshark -i eth0  -x -l -f udp

so I know the data is there (coming isn on address 224.0.0.4, port 901)

Any suggestions?

B


From larsivi at gmail.com  Wed Mar 10 05:48:25 2010
From: larsivi at gmail.com (Lars Ivar Igesund)
Date: Wed, 10 Mar 2010 11:48:25 +0100
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
Message-ID: <24e981171003100248n26489574k9fbf169c5eb03485@mail.gmail.com>

Hi Ben,

my experience (not with Twisted, but with multicast), is that
multicast often fail to be properly routed (this may be a restriction
on OS, switch, etc). That you see the multicasts on using tshark is no
indication on the routing working properly, as it will catch all
information in promiscous mode, whether routed there or not.

Two possible solutions (that may or may not be easy to in conjunction
with Twisted) are:
 * Route the multicasts explicitly
 * Make the listening socket bind explicitly to the network interface
where you expect/see the multicast. This is the solution I have used
myself, but may require using low level socket functionality. Binding
to localhost (all interfaces at once) or similar did not work for me.

Best regards,
Lars Ivar

On Wed, Mar 10, 2010 at 11:35 AM, Ben Barker <ben at bbarker.co.uk> wrote:
> Hello - I wonder if someone can help:
>
> We have some status info being sent by various machines using
> multicast addressed udp packets. I have been attempting to use twisted
> to write a python script that will passively monitor on the relevant
> port for any udp packets with the specified multicast address, which I
> can then parse the payloads of as required.
>
> I have been looking at the examples here:
>
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>
> But I seem to have trouble getting them to receive anything at all.
>
> I have managed to use tshark to display the packets :
>
> tshark -i eth0 ?-x -l -f udp
>
> so I know the data is there (coming isn on address 224.0.0.4, port 901)
>
> Any suggestions?
>
> B
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


From ben at bbarker.co.uk  Wed Mar 10 06:50:55 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 11:50:55 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <24e981171003100248n26489574k9fbf169c5eb03485@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<24e981171003100248n26489574k9fbf169c5eb03485@mail.gmail.com>
Message-ID: <3df02bfc1003100350l71d79286obcaebd8f3c848bdd@mail.gmail.com>

Thanks Lars - yes, I am not adamant about using twisted, although it
seemed initially to be the best place to stary. I have also been
looking at the pcapy module, which I think may do what I want, but
also seems very low level.

On Wed, Mar 10, 2010 at 10:48 AM, Lars Ivar Igesund <larsivi at gmail.com> wrote:
> Hi Ben,
>
> my experience (not with Twisted, but with multicast), is that
> multicast often fail to be properly routed (this may be a restriction
> on OS, switch, etc). That you see the multicasts on using tshark is no
> indication on the routing working properly, as it will catch all
> information in promiscous mode, whether routed there or not.
>
> Two possible solutions (that may or may not be easy to in conjunction
> with Twisted) are:
> ?* Route the multicasts explicitly
> ?* Make the listening socket bind explicitly to the network interface
> where you expect/see the multicast. This is the solution I have used
> myself, but may require using low level socket functionality. Binding
> to localhost (all interfaces at once) or similar did not work for me.
>
> Best regards,
> Lars Ivar
>
> On Wed, Mar 10, 2010 at 11:35 AM, Ben Barker <ben at bbarker.co.uk> wrote:
>> Hello - I wonder if someone can help:
>>
>> We have some status info being sent by various machines using
>> multicast addressed udp packets. I have been attempting to use twisted
>> to write a python script that will passively monitor on the relevant
>> port for any udp packets with the specified multicast address, which I
>> can then parse the payloads of as required.
>>
>> I have been looking at the examples here:
>>
>> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>>
>> But I seem to have trouble getting them to receive anything at all.
>>
>> I have managed to use tshark to display the packets :
>>
>> tshark -i eth0 ?-x -l -f udp
>>
>> so I know the data is there (coming isn on address 224.0.0.4, port 901)
>>
>> Any suggestions?
>>
>> B
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


From p.mayers at imperial.ac.uk  Wed Mar 10 07:03:18 2010
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Wed, 10 Mar 2010 12:03:18 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
Message-ID: <4B978A86.7050905@imperial.ac.uk>

On 10/03/10 10:35, Ben Barker wrote:
> Hello - I wonder if someone can help:
>
> We have some status info being sent by various machines using
> multicast addressed udp packets. I have been attempting to use twisted
> to write a python script that will passively monitor on the relevant
> port for any udp packets with the specified multicast address, which I
> can then parse the payloads of as required.
>
> I have been looking at the examples here:
>
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>
> But I seem to have trouble getting them to receive anything at all.

That's a little vague. Does "trouble" mean "it sometimes works" or 
"never works"?

>
> I have managed to use tshark to display the packets :
>
> tshark -i eth0  -x -l -f udp
>
> so I know the data is there (coming isn on address 224.0.0.4, port 901)

FYI, the 224.0.0.0/24 group is usually not IGMP snooped, and is 
effectively therefore broadcast.

Conversely, groups outside this range require working IGMP querying / 
snooping and some help from (usually) a router, so this may be why you 
chose this range.

Broadly speaking, as long as the UDP socket is listening on the right 
port and you've called joingroup, you should be ok.

Can you post a complete example that isn't working for you?

When your code is running, have a look "/sbin/ip maddr" to ensure the 
group has been added to the socket listen filter.


From ben at bbarker.co.uk  Wed Mar 10 08:03:46 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 13:03:46 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <4B978A86.7050905@imperial.ac.uk>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<4B978A86.7050905@imperial.ac.uk>
Message-ID: <3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>

>> But I seem to have trouble getting them to receive anything at all.
>
> That's a little vague. Does "trouble" mean "it sometimes works" or
> "never works"?
>

Sorry - yes, it was very vague! Never works. If I run wiresahrk I can
see udp packets addressed to 224.0.0.4, port 901, flying past, however
when I run my python script it does not appear to ever receive
anything.

The scritp I am running is almost identical to an exampel I found here:

http://code.activestate.com/recipes/425975-simple-udp-multicast-client-
server-using-twisted/

>>
>> I have managed to use tshark to display the packets :
>>
>> tshark -i eth0 ?-x -l -f udp
>>
> Can you post a complete example that isn't working for you?
>
> When your code is running, have a look "/sbin/ip maddr" to ensure the
> group has been added to the socket listen filter
eth1
	link  01:00:5e:00:00:04
	link  33:33:ff:7a:7e:4e
	link  01:00:5e:00:00:fb
	link  01:00:5e:00:00:01
	link  33:33:00:00:00:01
	inet  224.0.0.4
	inet  224.0.0.251
	inet  224.0.0.1
	inet6 ff02::1:ff7a:7e4e
	inet6 ff02::1

That's interesting.... eth1 is the wrong interface! In fact, it isn't
connected to anything at all. eth0 is the interface that should be
being used. I will try to swap them around, but presumably this is
something I can specify somwhere...


As I said, the code I am using is taken from the above link, but the
exact listing is given below:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
from twisted.application.internet import MulticastServer

class MulticastServerUDP(DatagramProtocol):
    def startProtocol(self):
        print 'Started Listening'
        # Join a specific multicast group, which is the IP we will respond to
        self.transport.joinGroup('224.0.0.4')

    def datagramReceived(self, datagram, address):
            print "Server Received:" + repr(datagram)


reactor.listenMulticast(901, MulticastServerUDP())
reactor.run()



> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


From p.mayers at imperial.ac.uk  Wed Mar 10 08:18:04 2010
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Wed, 10 Mar 2010 13:18:04 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
	<4B978A86.7050905@imperial.ac.uk>
	<3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
Message-ID: <4B979C0C.7000400@imperial.ac.uk>

On 10/03/10 13:03, Ben Barker wrote:
>>> But I seem to have trouble getting them to receive anything at all.
>>
>> That's a little vague. Does "trouble" mean "it sometimes works" or
>> "never works"?
>>
>
> Sorry - yes, it was very vague! Never works. If I run wiresahrk I can
> see udp packets addressed to 224.0.0.4, port 901, flying past, however
> when I run my python script it does not appear to ever receive
> anything.
>
> The scritp I am running is almost identical to an exampel I found here:
>
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-
> server-using-twisted/
>
>>>
>>> I have managed to use tshark to display the packets :
>>>
>>> tshark -i eth0  -x -l -f udp
>>>
>> Can you post a complete example that isn't working for you?
>>
>> When your code is running, have a look "/sbin/ip maddr" to ensure the
>> group has been added to the socket listen filter
> eth1
> 	link  01:00:5e:00:00:04
> 	link  33:33:ff:7a:7e:4e
> 	link  01:00:5e:00:00:fb
> 	link  01:00:5e:00:00:01
> 	link  33:33:00:00:00:01
> 	inet  224.0.0.4
> 	inet  224.0.0.251
> 	inet  224.0.0.1
> 	inet6 ff02::1:ff7a:7e4e
> 	inet6 ff02::1
>
> That's interesting.... eth1 is the wrong interface! In fact, it isn't
> connected to anything at all. eth0 is the interface that should be
> being used. I will try to swap them around, but presumably this is
> something I can specify somwhere...

Hmm. What does "ip route" say? Do you have 224.0.0.0/4 routed out of 
eth1 somehow?


From ben at bbarker.co.uk  Wed Mar 10 08:18:28 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 13:18:28 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<4B978A86.7050905@imperial.ac.uk>
	<3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
Message-ID: <3df02bfc1003100518o3f26832cl522ba0ab9eef4cee@mail.gmail.com>

Well that's odd...

I changed the interfaces over - used eth1 for the connection to the
network I need to sniff...

and now /sbin/ip maddr tells me I have joined 224.0.0.4 on eth0 !

Whichever interface is live, the join seems to happen on the other :-p

What could there be about my network config that is making this happen :-p

On Wed, Mar 10, 2010 at 1:03 PM, Ben Barker <ben at bbarker.co.uk> wrote:
>>> But I seem to have trouble getting them to receive anything at all.
>>
>> That's a little vague. Does "trouble" mean "it sometimes works" or
>> "never works"?
>>
>
> Sorry - yes, it was very vague! Never works. If I run wiresahrk I can
> see udp packets addressed to 224.0.0.4, port 901, flying past, however
> when I run my python script it does not appear to ever receive
> anything.
>
> The scritp I am running is almost identical to an exampel I found here:
>
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-
> server-using-twisted/
>
>>>
>>> I have managed to use tshark to display the packets :
>>>
>>> tshark -i eth0 ?-x -l -f udp
>>>
>> Can you post a complete example that isn't working for you?
>>
>> When your code is running, have a look "/sbin/ip maddr" to ensure the
>> group has been added to the socket listen filter
> eth1
> ? ? ? ?link ?01:00:5e:00:00:04
> ? ? ? ?link ?33:33:ff:7a:7e:4e
> ? ? ? ?link ?01:00:5e:00:00:fb
> ? ? ? ?link ?01:00:5e:00:00:01
> ? ? ? ?link ?33:33:00:00:00:01
> ? ? ? ?inet ?224.0.0.4
> ? ? ? ?inet ?224.0.0.251
> ? ? ? ?inet ?224.0.0.1
> ? ? ? ?inet6 ff02::1:ff7a:7e4e
> ? ? ? ?inet6 ff02::1
>
> That's interesting.... eth1 is the wrong interface! In fact, it isn't
> connected to anything at all. eth0 is the interface that should be
> being used. I will try to swap them around, but presumably this is
> something I can specify somwhere...
>
>
> As I said, the code I am using is taken from the above link, but the
> exact listing is given below:
>
> from twisted.internet.protocol import DatagramProtocol
> from twisted.internet import reactor
> from twisted.application.internet import MulticastServer
>
> class MulticastServerUDP(DatagramProtocol):
> ? ?def startProtocol(self):
> ? ? ? ?print 'Started Listening'
> ? ? ? ?# Join a specific multicast group, which is the IP we will respond to
> ? ? ? ?self.transport.joinGroup('224.0.0.4')
>
> ? ?def datagramReceived(self, datagram, address):
> ? ? ? ? ? ?print "Server Received:" + repr(datagram)
>
>
> reactor.listenMulticast(901, MulticastServerUDP())
> reactor.run()
>
>
>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>


From itamar at itamarst.org  Wed Mar 10 08:28:51 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 10 Mar 2010 08:28:51 -0500
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
Message-ID: <1268227731.3486.72.camel@pintsize>

On Wed, 2010-03-10 at 10:35 +0000, Ben Barker wrote:

> I have been looking at the examples here:
> 
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
> 
> But I seem to have trouble getting them to receive anything at all.

Did you do the joinGroup()? One of the examples omits it, which means it
won't receive multicast.



From p.mayers at imperial.ac.uk  Wed Mar 10 09:00:23 2010
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Wed, 10 Mar 2010 14:00:23 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100518o3f26832cl522ba0ab9eef4cee@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
	<4B978A86.7050905@imperial.ac.uk>	<3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
	<3df02bfc1003100518o3f26832cl522ba0ab9eef4cee@mail.gmail.com>
Message-ID: <4B97A5F7.2030706@imperial.ac.uk>

On 10/03/10 13:18, Ben Barker wrote:
> Well that's odd...
>
> I changed the interfaces over - used eth1 for the connection to the
> network I need to sniff...
>
> and now /sbin/ip maddr tells me I have joined 224.0.0.4 on eth0 !
>
> Whichever interface is live, the join seems to happen on the other :-p
>
> What could there be about my network config that is making this happen :-p

It depends on your OS & network setup. This isn't something Twisted can 
fix for you.

Can you send/receive multicast using a test tool e.g. "iperf" in UDP mode?

This is probably not the mailing list to continue discussion on.


From ben at bbarker.co.uk  Wed Mar 10 09:43:57 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 14:43:57 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <1268227731.3486.72.camel@pintsize>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<1268227731.3486.72.camel@pintsize>
Message-ID: <3df02bfc1003100643j563171f7nd9256193aebbfad7@mail.gmail.com>

Ah - I have now sorted the interface problem.

I run the code I listed earlier, but it sites at the command line
saying "listening" without every dumping anything to screen.

/sbin/ip maddr now shows:

eth1
	link  01:00:5e:00:00:04
	link  33:33:ff:7a:7e:4e
	link  01:00:5e:00:00:fb
	link  01:00:5e:00:00:01
	link  33:33:00:00:00:01
	inet  224.0.0.4
	inet  224.0.0.251
	inet  224.0.0.1
	inet6 ff02::1:ff7a:7e4e
	inet6 ff02::1


And this is the same intterface on which I would expect to see the
multicast udp packets.




On Wed, Mar 10, 2010 at 1:28 PM, Itamar Turner-Trauring
<itamar at itamarst.org> wrote:
> On Wed, 2010-03-10 at 10:35 +0000, Ben Barker wrote:
>
>> I have been looking at the examples here:
>>
>> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>>
>> But I seem to have trouble getting them to receive anything at all.
>
> Did you do the joinGroup()? One of the examples omits it, which means it
> won't receive multicast.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


From ben at bbarker.co.uk  Wed Mar 10 10:07:48 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 15:07:48 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100643j563171f7nd9256193aebbfad7@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<1268227731.3486.72.camel@pintsize>
	<3df02bfc1003100643j563171f7nd9256193aebbfad7@mail.gmail.com>
Message-ID: <3df02bfc1003100707t7266cb37qe324cda17f2b5c75@mail.gmail.com>

To all those whose email I have (and still am) filling:

Yers - it was a network problem on my part. The two NIC's were causing
the problems. The example code is now working fine. Thanks all:-)

On Wed, Mar 10, 2010 at 2:43 PM, Ben Barker <ben at bbarker.co.uk> wrote:
> Ah - I have now sorted the interface problem.
>
> I run the code I listed earlier, but it sites at the command line
> saying "listening" without every dumping anything to screen.
>
> /sbin/ip maddr now shows:
>
> eth1
> ? ? ? ?link ?01:00:5e:00:00:04
> ? ? ? ?link ?33:33:ff:7a:7e:4e
> ? ? ? ?link ?01:00:5e:00:00:fb
> ? ? ? ?link ?01:00:5e:00:00:01
> ? ? ? ?link ?33:33:00:00:00:01
> ? ? ? ?inet ?224.0.0.4
> ? ? ? ?inet ?224.0.0.251
> ? ? ? ?inet ?224.0.0.1
> ? ? ? ?inet6 ff02::1:ff7a:7e4e
> ? ? ? ?inet6 ff02::1
>
>
> And this is the same intterface on which I would expect to see the
> multicast udp packets.
>
>
>
>
> On Wed, Mar 10, 2010 at 1:28 PM, Itamar Turner-Trauring
> <itamar at itamarst.org> wrote:
>> On Wed, 2010-03-10 at 10:35 +0000, Ben Barker wrote:
>>
>>> I have been looking at the examples here:
>>>
>>> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>>>
>>> But I seem to have trouble getting them to receive anything at all.
>>
>> Did you do the joinGroup()? One of the examples omits it, which means it
>> won't receive multicast.
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>


From codeprophecy1 at gmail.com  Wed Mar 10 20:23:32 2010
From: codeprophecy1 at gmail.com (code prophecy)
Date: Wed, 10 Mar 2010 19:23:32 -0600
Subject: [Twisted-Python] how to send message in msn bot
Message-ID: <3700bbff1003101723v295a588cod9a297f807f2e1ab@mail.gmail.com>

Hi,

I've been playing with twisted msn implementation but failed to figure out
how to send/recv message to another msn user ? I understand that i need to
use msn.SwitchboardClient but am confused as to how and where to connect it
? what factory to use etc.

any hint/example shall be appreciated.

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100310/87182a92/attachment.htm 

From chris at simplistix.co.uk  Thu Mar 11 05:08:40 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 11 Mar 2010 10:08:40 +0000
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>	<4B8F715D.6020107@simplistix.co.uk>
	<20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>
Message-ID: <4B98C128.7030402@simplistix.co.uk>

exarkun at twistedmatrix.com wrote:
> Also, I'm pretty sure that the 9.0 Windows installer _also_ didn't 
> include zope.interface.  So this isn't a new situation with 10.0.
>> Is zope.interface not used/required anymore?
>> If so, why is it shipping in the non-windows version?
> 
> It doesn't ship in any of the packages for other platforms, either (nor 
> do any of our other external dependencies).

Ah, okay, I guess my question becomes: why was it ever bundles in the 
windows distribution then?

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From therve at free.fr  Thu Mar 11 06:21:41 2010
From: therve at free.fr (Thomas =?ISO-8859-1?Q?Herv=E9?=)
Date: Thu, 11 Mar 2010 12:21:41 +0100
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <4B98C128.7030402@simplistix.co.uk>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>
	<4B8F715D.6020107@simplistix.co.uk>
	<20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>
	<4B98C128.7030402@simplistix.co.uk>
Message-ID: <1268306501.3069.0.camel@brainwave>

Le jeudi 11 mars 2010 ? 10:08 +0000, Chris Withers a ?crit :
> exarkun at twistedmatrix.com wrote:
> > Also, I'm pretty sure that the 9.0 Windows installer _also_ didn't 
> > include zope.interface.  So this isn't a new situation with 10.0.
> >> Is zope.interface not used/required anymore?
> >> If so, why is it shipping in the non-windows version?
> > 
> > It doesn't ship in any of the packages for other platforms, either (nor 
> > do any of our other external dependencies).
> 
> Ah, okay, I guess my question becomes: why was it ever bundles in the 
> windows distribution then?

Because Zope didn't provide a binary version of zope.interface for
Windows at that time, and zope.interface has a C extension.

-- 
Thomas



From chris at simplistix.co.uk  Thu Mar 11 08:54:07 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 11 Mar 2010 13:54:07 +0000
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <1268306501.3069.0.camel@brainwave>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>	<4B8F715D.6020107@simplistix.co.uk>	<20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>	<4B98C128.7030402@simplistix.co.uk>
	<1268306501.3069.0.camel@brainwave>
Message-ID: <4B98F5FF.5090004@simplistix.co.uk>

Thomas Herv? wrote:
> Le jeudi 11 mars 2010 ? 10:08 +0000, Chris Withers a ?crit :
>> exarkun at twistedmatrix.com wrote:
>>> Also, I'm pretty sure that the 9.0 Windows installer _also_ didn't 
>>> include zope.interface.  So this isn't a new situation with 10.0.
>>>> Is zope.interface not used/required anymore?
>>>> If so, why is it shipping in the non-windows version?
>>> It doesn't ship in any of the packages for other platforms, either (nor 
>>> do any of our other external dependencies).
>> Ah, okay, I guess my question becomes: why was it ever bundles in the 
>> windows distribution then?
> 
> Because Zope didn't provide a binary version of zope.interface for
> Windows at that time,

Really? To my knowledge, Zope has provided windows binaries for 
zope.interface prettymuch since it came into existence...

(I know, I'm sure I used to compile them for a time ;-) )

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk


From exarkun at twistedmatrix.com  Thu Mar 11 15:05:09 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 11 Mar 2010 20:05:09 -0000
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation updated
Message-ID: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>

Hi all,

Thomas and I have finished upgrading the trac installation on 
http://twistedmatrix.com/ to 0.11.6.  We expect that this will resolve a 
number of the issues the site has had.

If you notice anything broken about the website now, please point it 
out.

Jean-Paul


From jml at mumak.net  Thu Mar 11 15:14:48 2010
From: jml at mumak.net (Jonathan Lange)
Date: Thu, 11 Mar 2010 20:14:48 +0000
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
Message-ID: <d06a5cd31003111214u6541859ek55cb2753d567c8d6@mail.gmail.com>

On Thu, Mar 11, 2010 at 8:05 PM,  <exarkun at twistedmatrix.com> wrote:
> Hi all,
>
> Thomas and I have finished upgrading the trac installation on
> http://twistedmatrix.com/ to 0.11.6. ?We expect that this will resolve a
> number of the issues the site has had.
>
> If you notice anything broken about the website now, please point it
> out.
>

Thank you very much Jean-Paul & Thomas!

jml


From kevin.horn at gmail.com  Thu Mar 11 15:47:00 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 11 Mar 2010 14:47:00 -0600
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
Message-ID: <562bcc11003111247r1213a7dby175d1d649ece44e5@mail.gmail.com>

On Thu, Mar 11, 2010 at 2:05 PM, <exarkun at twistedmatrix.com> wrote:

> Hi all,
>
> Thomas and I have finished upgrading the trac installation on
> http://twistedmatrix.com/ to 0.11.6.  We expect that this will resolve a
> number of the issues the site has had.
>
> If you notice anything broken about the website now, please point it
> out.
>
> Jean-Paul
>
>
Here's a minor thing...

When viewing a diff, the legend is incomplete.  I just see text
("Unmodified", "Added", etc.) without any images/colors.

It's a tiny thing, but you did ask... :)

browser: Firefox 3.5 on Win32

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100311/480939fe/attachment.htm 

From twisted at asheesh.org  Thu Mar 11 18:02:25 2010
From: twisted at asheesh.org (Asheesh Laroia)
Date: Thu, 11 Mar 2010 18:02:25 -0500 (EST)
Subject: [Twisted-Python] Twisted easy bugs,
 and other thoughts about getting people involved in Twisted
Message-ID: <alpine.DEB.2.00.1003101739050.2352@localhost>

I ran into David Reid at PyCon a few weeks ago, and I showed him an index 
of "easy" and "bitesize" bugs I'm putting on the web at 
https://openhatch.org/search/. He told me that the Twisted team tags bugs 
as "easy" in Trac.

So all you might like to see 
https://openhatch.org/search/?q=Twisted&toughness=bitesize -- it's the 
result of search for bugs whose full text or project matches "Twisted", 
constrained to only include the bugs that are "easy". This is the same 
query as 
http://twistedmatrix.com/trac/query?status=new&status=assigned&status=reopened&keywords=~easy&order=priority 
-- the same 18 tickets -- but cached in our index.

The OpenHatch website aims to show helpful, friendly things to potential 
new contributors. A list of bugs isn't always adequate, so I'm really 
happy jesstess wrote some tips on the OpenHatch project page regarding 
getting involved in Twisted: https://openhatch.org/+projects/Twisted

The "Relatedly" sidebox on that project page has other helpful links: 
potential mentors, namely people who have signed into OpenHatch and said 
they can mentor in Python or Twisted.

So that's a quick tour of some of relevant things to you guys. I have a 
few questions for you guys, if you're game:

* Of these things, what are the most interesting or useful? the least?

* Are there other tickets from the Twisted Trac that would be good to pull 
in?

* Would you like me to ping the list if we come up with anything else I 
think you might find interesting?

* Do any of you want to re-use some of this data -- can we make that 
easier?

We're pretty interested in helping projects convert users to contributors 
(in code, testing, documentation, whatever!) across free software. I 
wonder if there is a website widget that we could make for you to put on 
twistedmatrix.com -- a big box talking about how "You TOO can contribute 
to Twisted -- there are mentors, easy bugs, and everything!"

This email has gotten fairly long, so I'll stop here for now.

I don't mean to barge in; let me know if I'm unwelcome, and I'll wander 
off. I find myself in a maze of Twisted developers, none of whom are 
alike. Thanks! I'll be hanging out on #twisted as myself, paulproteus.

-- Asheesh.

P.S. If you think this is interesting, stay in touch with us:

IRC (freenode): #openhatch
Twitter/Identi.ca: @openhatchery
blog: https://openhatch.org/blog/
email and more: https://openhatch.org/contact/

P.S. The OpenHatch website has its source in git and shared under a free 
license -- https://openhatch.org/source-code-etc/

-- 
"World conquerors sometimes become fools, but fools never become world
conquerors."
 		-- "The Outer Limits: The Invisibles"




From glyph at twistedmatrix.com  Thu Mar 11 18:45:11 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 11 Mar 2010 18:45:11 -0500
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <d06a5cd31003111214u6541859ek55cb2753d567c8d6@mail.gmail.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<d06a5cd31003111214u6541859ek55cb2753d567c8d6@mail.gmail.com>
Message-ID: <32C317AD-3DAE-4A1F-8134-526049C7B285@twistedmatrix.com>


On Mar 11, 2010, at 3:14 PM, Jonathan Lange wrote:

> Thank you very much Jean-Paul & Thomas!

I second this sentiment!  I am *thrilled* that we're now on a released version of trac, and I applaud the hard work that it took to get us there.

Hopefully now it will be easier for other people to help pitch in with administrative tasks :).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100311/3ae0fa23/attachment.htm 

From glyph at twistedmatrix.com  Sat Mar 13 17:07:22 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 13 Mar 2010 17:07:22 -0500
Subject: [Twisted-Python] Twisted easy bugs,
	and other thoughts about 	getting people involved in Twisted
In-Reply-To: <alpine.DEB.2.00.1003101739050.2352@localhost>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
Message-ID: <d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>

On Thu, Mar 11, 2010 at 6:02 PM, Asheesh Laroia <twisted at asheesh.org> wrote:


> So that's a quick tour of some of relevant things to you guys. I have a
> few questions for you guys, if you're game:
>
> * Of these things, what are the most interesting or useful? the least?


If OpenHatch has users, the most interesting thing is simply that they will
be looking at these lists :).


>  * Are there other tickets from the Twisted Trac that would be good to pull

in?
>

For new contributors?  Not that I can think of.


> * Would you like me to ping the list if we come up with anything else I
> think you might find interesting?
>

Sure.


> * Do any of you want to re-use some of this data -- can we make that
> easier?
>

Isn't this all data that we're providing to *you*?  I don't understand why
we'd want to be pulling things back out of OpenHatch.  Perhaps I've
misunderstood.


> We're pretty interested in helping projects convert users to contributors
> (in code, testing, documentation, whatever!) across free software. I
> wonder if there is a website widget that we could make for you to put on
> twistedmatrix.com -- a big box talking about how "You TOO can contribute
> to Twisted -- there are mentors, easy bugs, and everything!"
>

Anything that would help us organize that information to appeal to potential
contributors would be helpful.


> I don't mean to barge in; let me know if I'm unwelcome, and I'll wander
> off. I find myself in a maze of Twisted developers, none of whom are
> alike. Thanks! I'll be hanging out on #twisted as myself, paulproteus.
>

Please feel free to stay in touch.  Getting more people involved in Twisted
development is always of interest.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100313/a040452f/attachment.htm 

From jon at gina.alaska.edu  Sun Mar 14 01:24:35 2010
From: jon at gina.alaska.edu (Jonathan Sawyer)
Date: Sat, 13 Mar 2010 21:24:35 -0900
Subject: [Twisted-Python] Application mode: Killing a peer connection from
	the server in a thread. Is this correct?
Message-ID: <5cab99fd1003132224k65f66ce9o1a0663e4b6bea9a2@mail.gmail.com>

Hi everyone,

I am running a server in application context via:

# code: server.tac
factory = Factory()
factory.protocol = MyProtocol
application = service.Application("MyServer")
service = internet.TCPServer(5555, factory)
service.setServiceParent(application)
# end code

ran with

$ twistd -ny server.tac

Here is some of my Protocol code:

# code: myprotocol.py
def checkIdle(transport):
    while 1:
        now = time.time()
        if now - transport.activityFlag > 30.0:
            transport.loseConnection()
            time.sleep(1)
            break
            return
        time.sleep(8)
    return

class MyProtocol(Protocol):
    def connectionMade(self):
        self.transport.activityFlag = time.time()
        thread.start_new_thread(checkIdle, (self.transport,))

    # ... the rest of the methods... not important for this question
# end code

Now here's my problem: I want to kill connections from the server that have
been idle for, say, 30 seconds. An idle connection is one in which is a
_valid_ connection (i.e., it hasn't disconnected from the server) but hasn't
sent any data for 30 seconds. The way I have initially set it up was in a
thread. I simply check the last time it had activity from that particular
transport. The really real problem I am having is when the connection is
closed, the client doesn't know about it. It is simply closed on the server
and the client is left hanging. If I test this in telnet with:

$ telnet localhost 5555

telnet never quits with a message: Connection closed by foreign host. (which
is indeed exactly what I want)
The only way I get this response is if I try to send data to the server
while the connection has been "lost".

Can anyone direct me on the proper way to kill a connection from the server
end in a clean manner?

(By the way, I'm very new to twisted, not so new to Python).

Thanks for any help!

-- 
Jonathan Sawyer
Geographic Information Network of Alaska (GINA)
University of Alaska Fairbanks
(907) 474-5689
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100313/a9250efd/attachment.htm 

From glyph at twistedmatrix.com  Sun Mar 14 01:44:19 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 14 Mar 2010 01:44:19 -0500
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
Message-ID: <9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>


On Mar 11, 2010, at 3:05 PM, exarkun at twistedmatrix.com wrote:

> If you notice anything broken about the website now, please point it 
> out.

I'm somewhat regularly (although I'm not sure exactly how often) getting this:

Error 503 Service Unavailable
Service Unavailable
Guru Meditation:
XID: 1905866058
Varnish

It appears to be an artifact of the upgrade.

Also, the spacing on the revision log and repository browser seems wrong; many table rows are double height for some reason.

Still, I'm not complaining - just the fact that things paginate now has made the experience of doing triage much more pleasant!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100314/4c009a50/attachment.htm 

From exarkun at twistedmatrix.com  Sun Mar 14 11:04:09 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 14 Mar 2010 15:04:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1268579049.11.1235783148@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100314/ee798ea3/attachment-0001.htm 

From glyph at twistedmatrix.com  Sun Mar 14 16:15:13 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 14 Mar 2010 16:15:13 -0400
Subject: [Twisted-Python] [Twisted] #4331: SIGCHLD causes "Interrupted
	system call" errors on Python 2.4,
	in a fresh SVN checkout (was: SIGCHILD causes "Interrupted system
	call" errors on Python 2.4, in a fresh SVN checkout)
In-Reply-To: <059.e68ebd56ab98e4b57075b68d793804ea@twistedmatrix.com>
References: <050.e9fa395bf2a0b610b1572e0106bc4c9d@twistedmatrix.com>
	<059.e68ebd56ab98e4b57075b68d793804ea@twistedmatrix.com>
Message-ID: <2B6E2D17-B2C6-4F58-BFE6-9799B981B024@twistedmatrix.com>

Also regarding Trac issues; I'm not sure if this one is new, but I received this message from the ticket notifier and I noticed that since the only thing that changed is the ticket subject, there appears to be no indication of who changed it or what changed, unless you look at the 'subject' line of the email.

On Mar 14, 2010, at 3:29 AM, Twisted wrote:

> #4331: SIGCHLD causes "Interrupted system call" errors on Python 2.4, in a fresh
> SVN checkout
> --------------------------+-------------------------------------------------
>     Reporter:  TimAllen  |           Owner:  glyph
>         Type:  defect    |          Status:  new  
>     Priority:  normal    |       Milestone:       
>    Component:  core      |        Keywords:       
>       Branch:            |   Branch_author:       
> Launchpad_bug:            |  
> --------------------------+-------------------------------------------------
> 
> -- 
> Ticket URL: <http://twistedmatrix.com/trac/ticket/4331#comment:4>
> Twisted <http://twistedmatrix.com/trac/>
> Engine of your Internet



From glyph at twistedmatrix.com  Sun Mar 14 16:27:39 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 14 Mar 2010 16:27:39 -0400
Subject: [Twisted-Python] Application mode: Killing a peer connection
	from the server in a thread. Is this correct?
In-Reply-To: <5cab99fd1003132224k65f66ce9o1a0663e4b6bea9a2@mail.gmail.com>
References: <5cab99fd1003132224k65f66ce9o1a0663e4b6bea9a2@mail.gmail.com>
Message-ID: <A121BF7F-57C8-4C2F-8152-9E7EAF2FC563@twistedmatrix.com>

No. (In answer to the subject.)

On Mar 14, 2010, at 1:24 AM, Jonathan Sawyer wrote:

> Now here's my problem: I want to kill connections from the server that have been idle for, say, 30 seconds. An idle connection is one in which is a _valid_ connection (i.e., it hasn't disconnected from the server) but hasn't sent any data for 30 seconds. The way I have initially set it up was in a thread.

That's your problem.  You may not call Twisted APIs of any kind from a thread.  That goes *double* for threads started with start_new_thread; if you start threads that way you will have problems with clean shutdown as well.  If you have work you want to do in a thread in Twisted, use reactor.callInThread.

http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.interfaces.IReactorThreads.html#callInThread

If, for some reason, you needed to tell a transport to disconnect from a thread, the right way to do it would be to call reactor.callFromThread(transport.loseConnection).

http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.interfaces.IReactorThreads.html#callFromThread

However, this is still wrong, as there's no need to spin up or manage threads in order to run timed events in Twisted.

Bottom line: don't use threads.  If you think you need to in order to perform some basic task, there is probably a Twisted API you haven't learned about yet.

> Can anyone direct me on the proper way to kill a connection from the server end in a clean manner?

If you want to check the connection every 30 seconds, use a LoopingCall that calls your 'check' function every 30 seconds, to check the activity flag and call loseConnection if necessary.

http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.task.LoopingCall.html

You should also know that until <http://twistedmatrix.com/trac/ticket/78> is closed, your connection won't be "killed" so much as it is "shut down"; the socket will wait until all of its remaining data has been sent (or the TCP-level timeout has passed) before closing.



From twisted at asheesh.org  Sun Mar 14 12:53:59 2010
From: twisted at asheesh.org (Asheesh Laroia)
Date: Sun, 14 Mar 2010 12:53:59 -0400 (EDT)
Subject: [Twisted-Python] Twisted easy bugs,
 and other thoughts about getting people involved in Twisted
In-Reply-To: <d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
	<d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1003141221001.18193@vellum>

On Sat, 13 Mar 2010, Glyph Lefkowitz wrote:

> On Thu, Mar 11, 2010 at 6:02 PM, Asheesh Laroia <twisted at asheesh.org> wrote:
> ?
>       So that's a quick tour of some of relevant things to you guys. I have a
>       few questions for you guys, if you're game:
>
>       * Of these things, what are the most interesting or useful? the least?
> 
> 
> If OpenHatch has users, the most interesting thing is simply that they 
> will be looking at these lists :). ?

All right! (-:

>       ?* Are there other tickets from the Twisted Trac that would be good to pull
>       in?
> 
> 
> For new contributors? ?Not that I can think of.

I did just notice there's a documentation tag. Is that something that 
you'd want us to pull in, too?

I imagine you'll say yes -- I'm mostly asking to get your creative juices 
flowing and see if there's anything else....

>       * Would you like me to ping the list if we come up with anything else I
>       think you might find interesting?
> 
> Sure. ?

Yay.

>       * Do any of you want to re-use some of this data -- can we make that
>       easier?
> 
> Isn't this all data that we're providing to you? ?I don't understand why 
> we'd want to be pulling things back out of OpenHatch. ?Perhaps I've 
> misunderstood.

I'm mostly referring to things like jesstess's "How to get involved" 
answers.

One more thing -- pulling data out of Trac isn't actually super easy (-:. 
So if you want us to re-export that in some really simple format like a 
big JSON list, that's something else we can do.

>       We're pretty interested in helping projects convert users to contributors
>       (in code, testing, documentation, whatever!) across free software. I
>       wonder if there is a website widget that we could make for you to put on
>       twistedmatrix.com -- a big box talking about how "You TOO can contribute
>       to Twisted -- there are mentors, easy bugs, and everything!"
> 
> Anything that would help us organize that information to appeal to 
> potential contributors would be helpful. ?

Here's a dream:

A big and colorful box sits on the Twisted homepage. It says "Want to help 
Twisted out, but feel shy about getting your feet wet? There are five 
mentors standing by to help you dive in, 18 easy bugs, and 25 requests for 
documentation." (Only maybe somehow it could use less words?)

That might take the person to the OpenHatch project page for Twisted, 
where all that information is listed or available a click away. The widget 
on the Twisted home page could pull data from OpenHatch's project page.

I don't know that *we* would get around to it soon, but certainly we can 
provide the data pretty quickly. We might also get around to it sometime.

In fact, I just filed a bug with the above text -- 
https://openhatch.org/bugs/issue35

>       I don't mean to barge in; let me know if I'm unwelcome, and I'll wander
>       off. I find myself in a maze of Twisted developers, none of whom are
>       alike. Thanks! I'll be hanging out on #twisted as myself, paulproteus.
> 
> 
> Please feel free to stay in touch. ?Getting more people involved in 
> Twisted development is always of interest.?

Great! (-:

-- Asheesh.

-- 
Ours is a world of nuclear giants and ethical infants.
 		-- General Omar N. Bradley

From exarkun at twistedmatrix.com  Sun Mar 14 20:16:37 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Mon, 15 Mar 2010 00:16:37 -0000
Subject: [Twisted-Python] Twisted easy bugs,
	and other thoughts about getting people involved in Twisted
In-Reply-To: <alpine.DEB.2.00.1003141221001.18193@vellum>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
	<d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>
	<alpine.DEB.2.00.1003141221001.18193@vellum>
Message-ID: <20100315001637.2792.1150179124.divmod.xquotient.1609@localhost.localdomain>

On 14 Mar, 04:53 pm, twisted at asheesh.org wrote:
>
>One more thing -- pulling data out of Trac isn't actually super easy 
>(-:. So if you want us to re-export that in some really simple format 
>like a big JSON list, that's something else we can do.

How do you mean?  It's actually pretty straightforward to get data out; 
you can have it as rss, csv, or tsv in most cases.

This leads me to wonder how you grabbed the "easy" tickets from the 
tracker.  Surely this is an automated process which is reading the csv 
format of a trac "tickets with `easy` keyword" query page?  If not, how 
does the OpenHatch listing stay up to date?

Jean-Paul


From newptcai at gmail.com  Mon Mar 15 06:32:23 2010
From: newptcai at gmail.com (Peter Cai)
Date: Mon, 15 Mar 2010 18:32:23 +0800
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
Message-ID: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>

Someone turn off the server by cutting power of the server.
When the machine is power on, I found my twisted application could not start
and emit the following error.

Another twistd server is running, PID 3398

This could either be a previously started instance of your application or a
different application entirely. To start a new one, either run it in some
other
directory, or use the --pidfile and --logfile parameters to avoid clashes.

After I deleted twistd.pid, it could start normally.

I checked if there is process with PID 3398, but there wasn't.

What might cause this problem?  How to avoid it?

--
look to the things around you,the immediate world around you, if you are
alive,it will mean something to you ??Paul Strand
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100315/64b14de9/attachment.htm 

From marco.giusti at gmail.com  Mon Mar 15 07:07:19 2010
From: marco.giusti at gmail.com (Marco Giusti)
Date: Mon, 15 Mar 2010 12:07:19 +0100
Subject: [Twisted-Python] My twisted application could not start after
 reboot be cause of "twistd.pid"
In-Reply-To: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
Message-ID: <20100315110719.GA22570@murdoc>

On Mon, Mar 15, 2010 at 06:32:23PM +0800, Peter Cai wrote:
> Someone turn off the server by cutting power of the server.
> When the machine is power on, I found my twisted application could not start
> and emit the following error.
> 
> Another twistd server is running, PID 3398
> 
> This could either be a previously started instance of your application or a
> different application entirely. To start a new one, either run it in some
> other
> directory, or use the --pidfile and --logfile parameters to avoid clashes.
> 
> After I deleted twistd.pid, it could start normally.
> 
> I checked if there is process with PID 3398, but there wasn't.
> 
> What might cause this problem?  How to avoid it?

the problem is caused by turning off power without shutdown twisted
server before. One solution could be create an init.d script that checks
for the existence of a pid file and delete it.


ciao
m.


-- 
Hofstadter's Law:
It always takes longer than you expect, even when you take into account
Hofstadter's Law.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20100315/fa3500d3/attachment.pgp 

From termim at gmail.com  Mon Mar 15 10:30:05 2010
From: termim at gmail.com (Mikhail Terekhov)
Date: Mon, 15 Mar 2010 09:30:05 -0500
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
Message-ID: <12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>

On Sun, Mar 14, 2010 at 1:44 AM, Glyph Lefkowitz
<glyph at twistedmatrix.com> wrote:
>
> On Mar 11, 2010, at 3:05 PM, exarkun at twistedmatrix.com wrote:
>
> If you notice anything broken about the website now, please point it
> out.
>
> Also, the spacing on the revision log and repository browser seems wrong;
> many table rows are double height for some reason.
> Still, I'm not complaining - just the fact that things paginate now has made
> the experience of doing triage much more pleasant!

In case of FF-3.6 the rows are triple height and filled in a funny ragged way.
In addition to that the menu is overlapped in FF but this was the same
way before
update. BTW in IE6 menu is OK.

-- 
Mikhail Terekhov
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cnnect1.png
Type: image/png
Size: 216058 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20100315/8e493825/attachment-0001.png 

From burslem2001 at yahoo.com  Mon Mar 15 11:16:08 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 08:16:08 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
Message-ID: <830754.2596.qm@web112514.mail.gq1.yahoo.com>

Hello,

I want to create a twisted daemon from my application:

if __name__ == '__main__':
    import nfdprocess, sys
    log.startLogging(sys.stdout)
    serverContext = ServerContextFactory()
    serverContext.protocol = nfdprocess.HandlePacket
    port =int(sys.argv[1])
    checkT = checkTables()
    checkT.resetTablesToOffline()
    outgoingTable = LoopingCall(checkT.checkOutgoingMessageQueue,serverContext)
    incomingTable = LoopingCall(checkT.checkIncomingMessageQueue,serverContext)
    checkStates=  LoopingCall(checkT.checkConnectionStates,serverContext)
    outgoingTable.start(0.5)
    incomingTable.start(1)
    checkStates.start(1)
    reactor.listenSSL(port, serverContext, serverContext)
    reactor.run()

Currently I have a class called nfdmessenger.

I am running the object.

> python nfdmessenger.py 2000

However I would run it as a deamon. Not sure how to do this? Can somebody be so kind and offer some pointers on this?

Much appreciated,
Garyc





From rlotun at gmail.com  Mon Mar 15 11:35:15 2010
From: rlotun at gmail.com (Reza Lotun)
Date: Mon, 15 Mar 2010 15:35:15 +0000
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <830754.2596.qm@web112514.mail.gq1.yahoo.com>
References: <12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
	<830754.2596.qm@web112514.mail.gq1.yahoo.com>
Message-ID: <95bb10691003150835h1e0e0c0by2922d9e977fc666c@mail.gmail.com>

Hi,

> I want to create a twisted daemon from my application: ...

You want to use twistd. See
http://twistedmatrix.com/documents/current/core/howto/basics.html#auto1

The process is roughly:

1) create a myapp.tac file which essentially loads in your server and
wraps it in an application
2) run something like:
       $ twistd -r epoll -y myapp.tac
which will daemonize your server (using the epoll reactor) and write
its pid to twistd.pid

A .tac file could look something like:

from twisted.application import service, internet
from myapp import MyAppServer

def get_service():
    """ Return a service suitable for creating an application object. """
    site = MyAppServer()
    port = 2000
    return internet.TCPServer(2000, site)

application = service.Application('MyApplicationName')
# attach the service to its parent application
service = get_service()
service.setServiceParent(application)

Also, keep in mind you might want to use twistd in conjunction with a
process runner (http://dustin.github.com/2010/02/28/running-processes.html).
That is, if you're using something like Ubuntu, you probably want to
run twistd using upstart.

Hope this helps.

Reza

-- 
Reza Lotun
mobile: +44 (0)7521 310 763
email:  rlotun at gmail.com
work:   reza at tweetdeck.com
twitter: @rlotun


From burslem2001 at yahoo.com  Mon Mar 15 12:14:21 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 09:14:21 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <95bb10691003150835h1e0e0c0by2922d9e977fc666c@mail.gmail.com>
Message-ID: <762434.85498.qm@web112507.mail.gq1.yahoo.com>

Thanks Reza I wil give it a crack.

Much appreciated,
Garyc


--- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com> wrote:

> From: Reza Lotun <rlotun at gmail.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 10:35 AM
> Hi,
> 
> > I want to create a twisted daemon from my application:
> ...
> 
> You want to use twistd. See
> http://twistedmatrix.com/documents/current/core/howto/basics.html#auto1
> 
> The process is roughly:
> 
> 1) create a myapp.tac file which essentially loads in your
> server and
> wraps it in an application
> 2) run something like:
> ? ? ???$ twistd -r epoll -y
> myapp.tac
> which will daemonize your server (using the epoll reactor)
> and write
> its pid to twistd.pid
> 
> A .tac file could look something like:
> 
> from twisted.application import service, internet
> from myapp import MyAppServer
> 
> def get_service():
> ? ? """ Return a service suitable for creating an
> application object. """
> ? ? site = MyAppServer()
> ? ? port = 2000
> ? ? return internet.TCPServer(2000, site)
> 
> application = service.Application('MyApplicationName')
> # attach the service to its parent application
> service = get_service()
> service.setServiceParent(application)
> 
> Also, keep in mind you might want to use twistd in
> conjunction with a
> process runner (http://dustin.github.com/2010/02/28/running-processes.html).
> That is, if you're using something like Ubuntu, you
> probably want to
> run twistd using upstart.
> 
> Hope this helps.
> 
> Reza
> 
> -- 
> Reza Lotun
> mobile: +44 (0)7521 310 763
> email:? rlotun at gmail.com
> work:???reza at tweetdeck.com
> twitter: @rlotun
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 



From burslem2001 at yahoo.com  Mon Mar 15 13:19:16 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 10:19:16 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <762434.85498.qm@web112507.mail.gq1.yahoo.com>
Message-ID: <137455.19004.qm@web112513.mail.gq1.yahoo.com>

Hello,

I compacted the server code initialization into the ServerContextFactory:


from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


if __name__ == '__main__':
    serverContext =  ServerContextFactory()
    reactor.listenSSL(2000, serverContext, serverContext)
    reactor.run()


Running the below:

python nfddaemon.py

Looks goods and runs as expected:


I then moved the code into a tac file:

from twisted.application import service,internet
from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


def get_service():
    serverContext =  ServerContextFactory()
    return reactor.listenSSL(2000, serverContext, serverContext)

application=service.Application('nfdm')
service=get_service()
service.setServiceParent(application)


When I attempt to run:

>twistd -r epoll -y nfddaemon.tac

File "nfddaemon.tac", line 2, in <module>
    from nfdmessenger import ServerContextFactory
exceptions.ImportError: No module named nfdmessenger

It looks like it cannot find the module? Do I have to set the path?
Also not too sure about my getService routine...well suspect.

Thanks,
Garyc

--- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com> wrote:

> From: gary clark <burslem2001 at yahoo.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 11:14 AM
> Thanks Reza I wil give it a crack.
> 
> Much appreciated,
> Garyc
> 
> 
> --- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com>
> wrote:
> 
> > From: Reza Lotun <rlotun at gmail.com>
> > Subject: Re: [Twisted-Python] Creating a daemon from
> my application
> > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > Date: Monday, March 15, 2010, 10:35 AM
> > Hi,
> > 
> > > I want to create a twisted daemon from my
> application:
> > ...
> > 
> > You want to use twistd. See
> > http://twistedmatrix.com/documents/current/core/howto/basics.html#auto1
> > 
> > The process is roughly:
> > 
> > 1) create a myapp.tac file which essentially loads in
> your
> > server and
> > wraps it in an application
> > 2) run something like:
> > ? ? ???$ twistd -r epoll -y
> > myapp.tac
> > which will daemonize your server (using the epoll
> reactor)
> > and write
> > its pid to twistd.pid
> > 
> > A .tac file could look something like:
> > 
> > from twisted.application import service, internet
> > from myapp import MyAppServer
> > 
> > def get_service():
> > ? ? """ Return a service suitable for creating an
> > application object. """
> > ? ? site = MyAppServer()
> > ? ? port = 2000
> > ? ? return internet.TCPServer(2000, site)
> > 
> > application =
> service.Application('MyApplicationName')
> > # attach the service to its parent application
> > service = get_service()
> > service.setServiceParent(application)
> > 
> > Also, keep in mind you might want to use twistd in
> > conjunction with a
> > process runner (http://dustin.github.com/2010/02/28/running-processes.html).
> > That is, if you're using something like Ubuntu, you
> > probably want to
> > run twistd using upstart.
> > 
> > Hope this helps.
> > 
> > Reza
> > 
> > -- 
> > Reza Lotun
> > mobile: +44 (0)7521 310 763
> > email:? rlotun at gmail.com
> > work:???reza at tweetdeck.com
> > twitter: @rlotun
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 



From burslem2001 at yahoo.com  Mon Mar 15 14:03:09 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 11:03:09 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <137455.19004.qm@web112513.mail.gq1.yahoo.com>
Message-ID: <469864.43610.qm@web112513.mail.gq1.yahoo.com>

Yeh I have to install them and create a setup.py to find the path.

--- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com> wrote:

> From: gary clark <burslem2001 at yahoo.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 12:19 PM
> Hello,
> 
> I compacted the server code initialization into the
> ServerContextFactory:
> 
> 
> from nfdmessenger import ServerContextFactory
> from twisted.internet import ssl, reactor
> 
> 
> if __name__ == '__main__':
> ? ? serverContext =? ServerContextFactory()
> ? ? reactor.listenSSL(2000, serverContext,
> serverContext)
> ? ? reactor.run()
> 
> 
> Running the below:
> 
> python nfddaemon.py
> 
> Looks goods and runs as expected:
> 
> 
> I then moved the code into a tac file:
> 
> from twisted.application import service,internet
> from nfdmessenger import ServerContextFactory
> from twisted.internet import ssl, reactor
> 
> 
> def get_service():
> ? ? serverContext =? ServerContextFactory()
> ? ? return reactor.listenSSL(2000, serverContext,
> serverContext)
> 
> application=service.Application('nfdm')
> service=get_service()
> service.setServiceParent(application)
> 
> 
> When I attempt to run:
> 
> >twistd -r epoll -y nfddaemon.tac
> 
> File "nfddaemon.tac", line 2, in <module>
> ? ? from nfdmessenger import
> ServerContextFactory
> exceptions.ImportError: No module named nfdmessenger
> 
> It looks like it cannot find the module? Do I have to set
> the path?
> Also not too sure about my getService routine...well
> suspect.
> 
> Thanks,
> Garyc
> 
> --- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com>
> wrote:
> 
> > From: gary clark <burslem2001 at yahoo.com>
> > Subject: Re: [Twisted-Python] Creating a daemon from
> my application
> > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > Date: Monday, March 15, 2010, 11:14 AM
> > Thanks Reza I wil give it a crack.
> > 
> > Much appreciated,
> > Garyc
> > 
> > 
> > --- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com>
> > wrote:
> > 
> > > From: Reza Lotun <rlotun at gmail.com>
> > > Subject: Re: [Twisted-Python] Creating a daemon
> from
> > my application
> > > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > > Date: Monday, March 15, 2010, 10:35 AM
> > > Hi,
> > > 
> > > > I want to create a twisted daemon from my
> > application:
> > > ...
> > > 
> > > You want to use twistd. See
> > > http://twistedmatrix.com/documents/current/core/howto/basics.html#auto1
> > > 
> > > The process is roughly:
> > > 
> > > 1) create a myapp.tac file which essentially
> loads in
> > your
> > > server and
> > > wraps it in an application
> > > 2) run something like:
> > > ? ? ???$ twistd -r epoll -y
> > > myapp.tac
> > > which will daemonize your server (using the
> epoll
> > reactor)
> > > and write
> > > its pid to twistd.pid
> > > 
> > > A .tac file could look something like:
> > > 
> > > from twisted.application import service,
> internet
> > > from myapp import MyAppServer
> > > 
> > > def get_service():
> > > ? ? """ Return a service suitable for creating
> an
> > > application object. """
> > > ? ? site = MyAppServer()
> > > ? ? port = 2000
> > > ? ? return internet.TCPServer(2000, site)
> > > 
> > > application =
> > service.Application('MyApplicationName')
> > > # attach the service to its parent application
> > > service = get_service()
> > > service.setServiceParent(application)
> > > 
> > > Also, keep in mind you might want to use twistd
> in
> > > conjunction with a
> > > process runner (http://dustin.github.com/2010/02/28/running-processes.html).
> > > That is, if you're using something like Ubuntu,
> you
> > > probably want to
> > > run twistd using upstart.
> > > 
> > > Hope this helps.
> > > 
> > > Reza
> > > 
> > > -- 
> > > Reza Lotun
> > > mobile: +44 (0)7521 310 763
> > > email:? rlotun at gmail.com
> > > work:???reza at tweetdeck.com
> > > twitter: @rlotun
> > > 
> > > _______________________________________________
> > > Twisted-Python mailing list
> > > Twisted-Python at twistedmatrix.com
> > > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > > 
> > 
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 



From rlotun at gmail.com  Mon Mar 15 14:15:23 2010
From: rlotun at gmail.com (Reza Lotun)
Date: Mon, 15 Mar 2010 18:15:23 +0000
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <469864.43610.qm@web112513.mail.gq1.yahoo.com>
References: <137455.19004.qm@web112513.mail.gq1.yahoo.com>
	<469864.43610.qm@web112513.mail.gq1.yahoo.com>
Message-ID: <95bb10691003151115we64158aj876196d27598829d@mail.gmail.com>

On Mon, Mar 15, 2010 at 6:03 PM, gary clark <burslem2001 at yahoo.com> wrote:
> Yeh I have to install them and create a setup.py to find the path.

You only need to set your PYTHONPATH environment variable.

e.g.

$ export PYTHONPATH=/path/to/dir/containing/code

-- 
Reza Lotun
mobile: +44 (0)7521 310 763
email:  rlotun at gmail.com
work:   reza at tweetdeck.com
twitter: @rlotun


From burslem2001 at yahoo.com  Mon Mar 15 16:42:10 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 13:42:10 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <95bb10691003151115we64158aj876196d27598829d@mail.gmail.com>
Message-ID: <771500.41332.qm@web112503.mail.gq1.yahoo.com>

Hello,


twistd -r epoll -y ./nfddaemon.tac

The below is the .tac file:

from twisted.application import service,internet
from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


def get_service():
    serverContext =  ServerContextFactory()
    return reactor.listenSSL(2000, serverContext, serverContext)

application=service.Application('nfdm')
service=get_service()
service.setServiceParent(application)

Not sure what to do at this point. It runs and then dies, doing something wrong in getService() dont know ehat the correct syntax is:

File "./nfddaemon.tac", line 12, in <module>
	    service.setServiceParent(application)
	exceptions.AttributeError: 'Port' object has no attribute 'setServiceParent'

Thanks,
Garyc



--- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com> wrote:

> From: Reza Lotun <rlotun at gmail.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 1:15 PM
> On Mon, Mar 15, 2010 at 6:03 PM, gary
> clark <burslem2001 at yahoo.com>
> wrote:
> > Yeh I have to install them and create a setup.py to
> find the path.
> 
> You only need to set your PYTHONPATH environment variable.
> 
> e.g.
> 
> $ export PYTHONPATH=/path/to/dir/containing/code
> 
> -- 
> Reza Lotun
> mobile: +44 (0)7521 310 763
> email:? rlotun at gmail.com
> work:???reza at tweetdeck.com
> twitter: @rlotun
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 



From burslem2001 at yahoo.com  Mon Mar 15 17:00:14 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 14:00:14 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <771500.41332.qm@web112503.mail.gq1.yahoo.com>
Message-ID: <767190.37643.qm@web112519.mail.gq1.yahoo.com>

Ok the below works:

from twisted.application import service,internet
from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


def get_service():
    serverContext =  ServerContextFactory()
    return internet.SSLServer(2000, serverContext)

application=service.Application('nfdm')
service=get_service()
service.setServiceParent(application)


--- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com> wrote:

> From: gary clark <burslem2001 at yahoo.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 3:42 PM
> Hello,
> 
> 
> twistd -r epoll -y ./nfddaemon.tac
> 
> The below is the .tac file:
> 
> from twisted.application import service,internet
> from nfdmessenger import ServerContextFactory
> from twisted.internet import ssl, reactor
> 
> 
> def get_service():
> ? ? serverContext =? ServerContextFactory()
> ? ? return reactor.listenSSL(2000, serverContext,
> serverContext)
> 
> application=service.Application('nfdm')
> service=get_service()
> service.setServiceParent(application)
> 
> Not sure what to do at this point. It runs and then dies,
> doing something wrong in getService() dont know ehat the
> correct syntax is:
> 
> File "./nfddaemon.tac", line 12, in <module>
> ??? ? ?
> service.setServiceParent(application)
> ??? exceptions.AttributeError: 'Port' object
> has no attribute 'setServiceParent'
> 
> Thanks,
> Garyc
> 
> 
> 
> --- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com>
> wrote:
> 
> > From: Reza Lotun <rlotun at gmail.com>
> > Subject: Re: [Twisted-Python] Creating a daemon from
> my application
> > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > Date: Monday, March 15, 2010, 1:15 PM
> > On Mon, Mar 15, 2010 at 6:03 PM, gary
> > clark <burslem2001 at yahoo.com>
> > wrote:
> > > Yeh I have to install them and create a setup.py
> to
> > find the path.
> > 
> > You only need to set your PYTHONPATH environment
> variable.
> > 
> > e.g.
> > 
> > $ export PYTHONPATH=/path/to/dir/containing/code
> > 
> > -- 
> > Reza Lotun
> > mobile: +44 (0)7521 310 763
> > email:? rlotun at gmail.com
> > work:???reza at tweetdeck.com
> > twitter: @rlotun
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 



From burslem2001 at yahoo.com  Mon Mar 15 17:11:54 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 14:11:54 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <767190.37643.qm@web112519.mail.gq1.yahoo.com>
Message-ID: <788265.35276.qm@web112508.mail.gq1.yahoo.com>

from twisted.application import service,internet
from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


def get_service():
    serverContext =  ServerContextFactory()
    return internet.SSLServer(2000, serverContext,serverContext)

application=service.Application('nfdm')
service=get_service()
service.setServiceParent(application)

Thats better.



--- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com> wrote:

> From: gary clark <burslem2001 at yahoo.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 4:00 PM
> Ok the below works:
> 
> from twisted.application import service,internet
> from nfdmessenger import ServerContextFactory
> from twisted.internet import ssl, reactor
> 
> 
> def get_service():
> ? ? serverContext =? ServerContextFactory()
> ? ? return internet.SSLServer(2000,
> serverContext)
> 
> application=service.Application('nfdm')
> service=get_service()
> service.setServiceParent(application)
> 
> 
> --- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com>
> wrote:
> 
> > From: gary clark <burslem2001 at yahoo.com>
> > Subject: Re: [Twisted-Python] Creating a daemon from
> my application
> > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > Date: Monday, March 15, 2010, 3:42 PM
> > Hello,
> > 
> > 
> > twistd -r epoll -y ./nfddaemon.tac
> > 
> > The below is the .tac file:
> > 
> > from twisted.application import service,internet
> > from nfdmessenger import ServerContextFactory
> > from twisted.internet import ssl, reactor
> > 
> > 
> > def get_service():
> > ? ? serverContext =? ServerContextFactory()
> > ? ? return reactor.listenSSL(2000, serverContext,
> > serverContext)
> > 
> > application=service.Application('nfdm')
> > service=get_service()
> > service.setServiceParent(application)
> > 
> > Not sure what to do at this point. It runs and then
> dies,
> > doing something wrong in getService() dont know ehat
> the
> > correct syntax is:
> > 
> > File "./nfddaemon.tac", line 12, in <module>
> > ??? ? ?
> > service.setServiceParent(application)
> > ??? exceptions.AttributeError: 'Port' object
> > has no attribute 'setServiceParent'
> > 
> > Thanks,
> > Garyc
> > 
> > 
> > 
> > --- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com>
> > wrote:
> > 
> > > From: Reza Lotun <rlotun at gmail.com>
> > > Subject: Re: [Twisted-Python] Creating a daemon
> from
> > my application
> > > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > > Date: Monday, March 15, 2010, 1:15 PM
> > > On Mon, Mar 15, 2010 at 6:03 PM, gary
> > > clark <burslem2001 at yahoo.com>
> > > wrote:
> > > > Yeh I have to install them and create a
> setup.py
> > to
> > > find the path.
> > > 
> > > You only need to set your PYTHONPATH environment
> > variable.
> > > 
> > > e.g.
> > > 
> > > $ export PYTHONPATH=/path/to/dir/containing/code
> > > 
> > > -- 
> > > Reza Lotun
> > > mobile: +44 (0)7521 310 763
> > > email:? rlotun at gmail.com
> > > work:???reza at tweetdeck.com
> > > twitter: @rlotun
> > > 
> > > _______________________________________________
> > > Twisted-Python mailing list
> > > Twisted-Python at twistedmatrix.com
> > > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > > 
> > 
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 



From screwtape at froup.com  Mon Mar 15 18:36:26 2010
From: screwtape at froup.com (Tim Allen)
Date: Tue, 16 Mar 2010 09:36:26 +1100
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
 updated
In-Reply-To: <12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
	<12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
Message-ID: <20100315223626.GC13982@boombah.thristian.org>

On Mon, Mar 15, 2010 at 09:30:05AM -0500, Mikhail Terekhov wrote:
> On Sun, Mar 14, 2010 at 1:44 AM, Glyph Lefkowitz
> <glyph at twistedmatrix.com> wrote:
> >
> > On Mar 11, 2010, at 3:05 PM, exarkun at twistedmatrix.com wrote:
> >
> > If you notice anything broken about the website now, please point it
> > out.
> >
> > Also, the spacing on the revision log and repository browser seems wrong;
> > many table rows are double height for some reason.
> > Still, I'm not complaining - just the fact that things paginate now has made
> > the experience of doing triage much more pleasant!
> 
> In case of FF-3.6 the rows are triple height and filled in a funny ragged way.

There's a <span class="expand">&nbsp;</span> in the markup at the
beginning of the first cell in each row, followed by an <a> tag that
actually links to the directory in question. For some reason, <a> tags
in that table have "display: block" (/trac/chrome/common/css/browser.css,
line 50) which among other things forces them to start on a new line,
after the <span>. If the <span> was removed (putting the <a> at the
beginning of the cell), or the "display:block" was removed (making the
<a> follow the <span> on the same line), or the &nbsp; was removed
(collapsing the <span> to zero height so it wouldn't leave a gap),
things should be prettier.

> In addition to that the menu is overlapped in FF but this was the same
> way before
> update. BTW in IE6 menu is OK.

Which menu is that?


From newptcai at gmail.com  Tue Mar 16 03:07:09 2010
From: newptcai at gmail.com (Peter Cai)
Date: Tue, 16 Mar 2010 15:07:09 +0800
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
In-Reply-To: <20100315110719.GA22570@murdoc>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
Message-ID: <befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>

I think an init.d script could resolve this problem.
But I am curious about why "turning off power without shutdown twisted
server before" could cause such a problem.

Is it a bug or it has some more fundamental reason?

On Mon, Mar 15, 2010 at 7:07 PM, Marco Giusti <marco.giusti at gmail.com>wrote:

> On Mon, Mar 15, 2010 at 06:32:23PM +0800, Peter Cai wrote:
> > Someone turn off the server by cutting power of the server.
> > When the machine is power on, I found my twisted application could not
> start
> > and emit the following error.
> >
> > Another twistd server is running, PID 3398
> >
> > This could either be a previously started instance of your application or
> a
> > different application entirely. To start a new one, either run it in some
> > other
> > directory, or use the --pidfile and --logfile parameters to avoid
> clashes.
> >
> > After I deleted twistd.pid, it could start normally.
> >
> > I checked if there is process with PID 3398, but there wasn't.
> >
> > What might cause this problem?  How to avoid it?
>
> the problem is caused by turning off power without shutdown twisted
> server before. One solution could be create an init.d script that checks
> for the existence of a pid file and delete it.
>
>
> ciao
> m.
>
>
> --
> Hofstadter's Law:
> It always takes longer than you expect, even when you take into account
> Hofstadter's Law.
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.10 (GNU/Linux)
>
> iEYEARECAAYFAkueFOcACgkQ7ZmvfLU1M3V53wCdG/AtaA4tHOxxTN/dNZjdxRqR
> vgcAni2stbXYn4kJPnhJdzg3btH7hCwi
> =bNrT
> -----END PGP SIGNATURE-----
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


-- 
look to the things around you,the immediate world around you, if you are
alive,it will mean something to you ??Paul Strand
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100316/9f214cd0/attachment.htm 

From tim at commsecure.com.au  Tue Mar 16 03:27:40 2010
From: tim at commsecure.com.au (Tim Allen)
Date: Tue, 16 Mar 2010 18:27:40 +1100
Subject: [Twisted-Python] My twisted application could not start after
 reboot be cause of "twistd.pid"
In-Reply-To: <befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
Message-ID: <4B9F32EC.1030606@commsecure.com.au>

On 03/16/2010 06:07 PM, Peter Cai wrote:
> I think an init.d script could resolve this problem.
> But I am curious about why "turning off power without shutdown twisted
> server before" could cause such a problem.
>
> Is it a bug or it has some more fundamental reason?

When twistd starts up, it creates a .pid file as a signal that it's 
running. If you try and start it a second time, it notices that the .pid 
file exists, and refuses to run a second time. When twistd is shut down 
cleanly, it removes the .pid file so that it can be run again.

Unfortunately, this means that if twistd is shutdown *uncleanly* (by a 
power failure, or SIGKILL, or some other means), the .pid file must be 
removed before twistd will start again.

This isn't really a bug in twistd as such; almost all Unix daemons use 
the same fundamental system. Try running "ls /var/run/*.pid" on a Linux 
system, for example.

It's possible to add refinements to the basic .pid system, to make it 
more resistant to this kind of problem (off the top of my head, checking 
that the named PID exists, that it's a process of the right kind, 
checking for stale .pid files with exclusive file locks), but all of 
them require more code to implement, reduce portability, and still have 
corner-cases that would require an admin to manually delete the .pid 
file anyway.


From exarkun at twistedmatrix.com  Tue Mar 16 07:31:05 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 16 Mar 2010 11:31:05 -0000
Subject: [Twisted-Python] My twisted application could not start
	after	reboot be cause of "twistd.pid"
In-Reply-To: <4B9F32EC.1030606@commsecure.com.au>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
	<4B9F32EC.1030606@commsecure.com.au>
Message-ID: <20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>

On 07:27 am, tim at commsecure.com.au wrote:
>On 03/16/2010 06:07 PM, Peter Cai wrote:
>>I think an init.d script could resolve this problem.
>>But I am curious about why "turning off power without shutdown twisted
>>server before" could cause such a problem.
>>
>>Is it a bug or it has some more fundamental reason?
>
>When twistd starts up, it creates a .pid file as a signal that it's
>running. If you try and start it a second time, it notices that the 
>.pid
>file exists, and refuses to run a second time. When twistd is shut down
>cleanly, it removes the .pid file so that it can be run again.
>
>Unfortunately, this means that if twistd is shutdown *uncleanly* (by a
>power failure, or SIGKILL, or some other means), the .pid file must be
>removed before twistd will start again.
>
>This isn't really a bug in twistd as such; almost all Unix daemons use
>the same fundamental system. Try running "ls /var/run/*.pid" on a Linux
>system, for example.
>
>It's possible to add refinements to the basic .pid system, to make it
>more resistant to this kind of problem (off the top of my head, 
>checking
>that the named PID exists,

Actually it does this already.  But this is a particularly ineffective 
check, especially for processes launched at boot time, because of the 
very high possibility of collisions.
>
>that it's a process of the right kind,
>checking for stale .pid files with exclusive file locks), but all of
>them require more code to implement, reduce portability, and still have
>corner-cases that would require an admin to manually delete the .pid
>file anyway.

Jean-Paul


From alexandre at quessy.net  Tue Mar 16 08:44:44 2010
From: alexandre at quessy.net (Alexandre Quessy)
Date: Tue, 16 Mar 2010 08:44:44 -0400
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
In-Reply-To: <20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
	<4B9F32EC.1030606@commsecure.com.au>
	<20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>
Message-ID: <72236ba91003160544g1dff08c2va4575783ab610617@mail.gmail.com>

Hello everyone,


2010/3/16  <exarkun at twistedmatrix.com>:
> On 07:27 am, tim at commsecure.com.au wrote:
>>On 03/16/2010 06:07 PM, Peter Cai wrote:
>>>I think an init.d script could resolve this problem.
>>>But I am curious about why "turning off power without shutdown twisted
>>>server before" could cause such a problem.
>>>
>>>Is it a bug or it has some more fundamental reason?
>>
>>When twistd starts up, it creates a .pid file as a signal that it's
>>running. If you try and start it a second time, it notices that the
>>.pid
>>file exists, and refuses to run a second time. When twistd is shut down
>>cleanly, it removes the .pid file so that it can be run again.
>>
>>Unfortunately, this means that if twistd is shutdown *uncleanly* (by a
>>power failure, or SIGKILL, or some other means), the .pid file must be
>>removed before twistd will start again.
>>
>>This isn't really a bug in twistd as such; almost all Unix daemons use
>>the same fundamental system. Try running "ls /var/run/*.pid" on a Linux
>>system, for example.
>>
>>It's possible to add refinements to the basic .pid system, to make it
>>more resistant to this kind of problem (off the top of my head,
>>checking
>>that the named PID exists,
>
> Actually it does this already. ?But this is a particularly ineffective
> check, especially for processes launched at boot time, because of the
> very high possibility of collisions.

It is possible to retrieve the command line that was used to start a
process. This would be a simple way to check for matches. The command
line used to start the twistd process could even be stored as well for
comparison.

>>
>>that it's a process of the right kind,
>>checking for stale .pid files with exclusive file locks), but all of
>>them require more code to implement, reduce portability, and still have
>>corner-cases that would require an admin to manually delete the .pid
>>file anyway.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>

Best,
-- 
Alexandre Quessy
http://alexandre.quessy.net/


From termim at gmail.com  Tue Mar 16 09:48:17 2010
From: termim at gmail.com (Mikhail Terekhov)
Date: Tue, 16 Mar 2010 09:48:17 -0400
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <20100315223626.GC13982@boombah.thristian.org>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
	<12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
	<20100315223626.GC13982@boombah.thristian.org>
Message-ID: <12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>

On Mon, Mar 15, 2010 at 6:36 PM, Tim Allen <screwtape at froup.com> wrote:
> On Mon, Mar 15, 2010 at 09:30:05AM -0500, Mikhail Terekhov wrote:
>> On Sun, Mar 14, 2010 at 1:44 AM, Glyph Lefkowitz
>> <glyph at twistedmatrix.com> wrote:
>> >
>> > On Mar 11, 2010, at 3:05 PM, exarkun at twistedmatrix.com wrote:
>> >
>> > If you notice anything broken about the website now, please point it
>> > out.
>> >
>> > Also, the spacing on the revision log and repository browser seems wrong;
>> > many table rows are double height for some reason.
>> > Still, I'm not complaining - just the fact that things paginate now has made
>> > the experience of doing triage much more pleasant!
>>
>> In case of FF-3.6 the rows are triple height and filled in a funny ragged way.
>
> There's a <span class="expand">&nbsp;</span> in the markup at the
> beginning of the first cell in each row, followed by an <a> tag that
> actually links to the directory in question. For some reason, <a> tags
> in that table have "display: block" (/trac/chrome/common/css/browser.css,
> line 50) which among other things forces them to start on a new line,
> after the <span>. If the <span> was removed (putting the <a> at the
> beginning of the cell), or the "display:block" was removed (making the
> <a> follow the <span> on the same line), or the &nbsp; was removed
> (collapsing the <span> to zero height so it wouldn't leave a gap),
> things should be prettier.
>
I'm not an expert on css so I can't comment on that. The thing is that I've
never seen that behavior in any other Trac site on the net, so it is something
twistedmatrix specific IMHO.

>> In addition to that the menu is overlapped in FF but this was the same
>> way before
>> update. BTW in IE6 menu is OK.
>
> Which menu is that?
>
The Wiki/Timeline/... and Login/Preferences/..., see attached screen shot.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cnnect2.png
Type: image/png
Size: 9808 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20100316/09331786/attachment-0001.png 

From glyph at twistedmatrix.com  Tue Mar 16 11:46:23 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 16 Mar 2010 11:46:23 -0400
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
In-Reply-To: <72236ba91003160544g1dff08c2va4575783ab610617@mail.gmail.com>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
	<4B9F32EC.1030606@commsecure.com.au>
	<20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>
	<72236ba91003160544g1dff08c2va4575783ab610617@mail.gmail.com>
Message-ID: <E014522F-6094-430A-8C6B-E54B5C47FAE2@twistedmatrix.com>

On Mar 16, 2010, at 8:44 AM, Alexandre Quessy wrote:

> Hello everyone,
> 
> 
> 2010/3/16  <exarkun at twistedmatrix.com>:
>> On 07:27 am, tim at commsecure.com.au wrote:
>>> 
>>> It's possible to add refinements to the basic .pid system, to make it
>>> more resistant to this kind of problem (off the top of my head,
>>> checking
>>> that the named PID exists,
>> 
>> Actually it does this already.  But this is a particularly ineffective
>> check, especially for processes launched at boot time, because of the
>> very high possibility of collisions.
> 
> It is possible to retrieve the command line that was used to start a
> process. This would be a simple way to check for matches. The command
> line used to start the twistd process could even be stored as well for
> comparison.

There are many ways to make this more robust; in fact, we already have a ticket open for doing something about this problem: <http://twistedmatrix.com/trac/ticket/3851>.  If you're interested in fixing it, some work there would be helpful.  Even just some comments about different ways this problem can occur and different approaches to solving it would be good, so we can have them all in one place.

Thanks,

-glyph



From alexandre at quessy.net  Tue Mar 16 12:00:36 2010
From: alexandre at quessy.net (Alexandre Quessy)
Date: Tue, 16 Mar 2010 12:00:36 -0400
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
In-Reply-To: <E014522F-6094-430A-8C6B-E54B5C47FAE2@twistedmatrix.com>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
	<4B9F32EC.1030606@commsecure.com.au>
	<20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>
	<72236ba91003160544g1dff08c2va4575783ab610617@mail.gmail.com>
	<E014522F-6094-430A-8C6B-E54B5C47FAE2@twistedmatrix.com>
Message-ID: <72236ba91003160900k5069c93fn61a2a198685a521f@mail.gmail.com>

Hello,

2010/3/16 Glyph Lefkowitz <glyph at twistedmatrix.com>:
> On Mar 16, 2010, at 8:44 AM, Alexandre Quessy wrote:
>
>> Hello everyone,
>>
>>
>> 2010/3/16 ?<exarkun at twistedmatrix.com>:
>>> On 07:27 am, tim at commsecure.com.au wrote:
>>>>
>>>> It's possible to add refinements to the basic .pid system, to make it
>>>> more resistant to this kind of problem (off the top of my head,
>>>> checking
>>>> that the named PID exists,
>>>
>>> Actually it does this already. ?But this is a particularly ineffective
>>> check, especially for processes launched at boot time, because of the
>>> very high possibility of collisions.
>>
>> It is possible to retrieve the command line that was used to start a
>> process. This would be a simple way to check for matches. The command
>> line used to start the twistd process could even be stored as well for
>> comparison.
>
> There are many ways to make this more robust; in fact, we already have a ticket open for doing something about this problem: <http://twistedmatrix.com/trac/ticket/3851>. ?If you're interested in fixing it, some work there would be helpful. ?Even just some comments about different ways this problem can occur and different approaches to solving it would be good, so we can have them all in one place.

Excellent,
I've added a comment there.
Cheers,

>
> Thanks,
>
> -glyph
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Alexandre Quessy
http://alexandre.quessy.net/


From lists at collab.nl  Tue Mar 16 14:50:50 2010
From: lists at collab.nl (Thijs Triemstra | Collab)
Date: Tue, 16 Mar 2010 18:50:50 +0000
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
	<12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
	<20100315223626.GC13982@boombah.thristian.org>
	<12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>
Message-ID: <DD0ED0FD-BA86-48C0-9E68-F51FFE8DB7AD@collab.nl>


On 16 Mar 2010, at 13:48, Mikhail Terekhov wrote

> I'm not an expert on css so I can't comment on that. The thing is that I've
> never seen that behavior in any other Trac site on the net, so it is something
> twistedmatrix specific IMHO.
> 
>>> In addition to that the menu is overlapped in FF but this was the same
>>> way before
>>> update. BTW in IE6 menu is OK.
>> 
>> Which menu is that?
>> 
> The Wiki/Timeline/... and Login/Preferences/..., see attached screen shot.

I think the Trac installation was updated (the software) but not the template with all the css, so it's trying to make an early (alpha?) version of Trac 0.11 look like Trac 0.11.6.

Is it possible to take a clean css export from a new Trac environment and merge the existing css styles in there? Let me know if you need help with that of course.

Cheers,

Thijs




From jasonjwwilliams at gmail.com  Tue Mar 16 17:34:33 2010
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Tue, 16 Mar 2010 15:34:33 -0600
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log Files
Message-ID: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>

Hello,

Twistd blocks for a long period of time when the number of log files
built up is large, thereby causing connections to freeze and
(depending on the length of the rotation) time out.

Given I've only used Twisted in the past and not contributed to it, I
was curious if someone could take a look at my changes to
twisted.python.logfile.LogFile's rotate() method and see if there's
any reason the changes would be a bad idea.

What I've attempted to do is defer the rotation of the old log files
to a thread, and only rotate the current log file in the foreground.

Original twisted.python.logfile.LogFile.rotate(): http://gist.github.com/334538

My version with deferral of old log rotation: http://gist.github.com/334545

(Changes are against Twisted 10.0).

Thank you in advance.

-J


From maarten at treewalker.org  Tue Mar 16 19:01:00 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Wed, 17 Mar 2010 00:01:00 +0100
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log
	Files
In-Reply-To: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
References: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
Message-ID: <201003170001.00909.maarten@treewalker.org>

On Tuesday 16 March 2010, Jason J. W. Williams wrote:

> Twistd blocks for a long period of time when the number of log files
> built up is large, thereby causing connections to freeze and
> (depending on the length of the rotation) time out.
> 
> Given I've only used Twisted in the past and not contributed to it, I
> was curious if someone could take a look at my changes to
> twisted.python.logfile.LogFile's rotate() method and see if there's
> any reason the changes would be a bad idea.
> 
> What I've attempted to do is defer the rotation of the old log files
> to a thread, and only rotate the current log file in the foreground.

An alternative approach could be to name the log files differently.
For example, use the timestamp of the rotation as a filename suffix:
  twistd.log.2010-03-16.23-56

This is not the traditional way logging is done, but it would get good 
performance with simple code. (It would still need resolution of duplicate 
file names, in case the log rotates very quickly or the clock is moved 
backwards.)

Bye,
		Maarten


From screwtape at froup.com  Tue Mar 16 18:43:34 2010
From: screwtape at froup.com (Timothy Allen)
Date: Wed, 17 Mar 2010 09:43:34 +1100
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
 updated
In-Reply-To: <12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
	<12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
	<20100315223626.GC13982@boombah.thristian.org>
	<12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>
Message-ID: <20100317094334.528183ab@hepzibah>

On Tue, 16 Mar 2010 09:48:17 -0400
Mikhail Terekhov <termim at gmail.com> wrote:

> On Mon, Mar 15, 2010 at 6:36 PM, Tim Allen <screwtape at froup.com>
> wrote:
> > On Mon, Mar 15, 2010 at 09:30:05AM -0500, Mikhail Terekhov wrote:
> >> In addition to that the menu is overlapped in FF but this was the
> >> same way before
> >> update. BTW in IE6 menu is OK.
> >
> > Which menu is that?
> >
> The Wiki/Timeline/... and Login/Preferences/..., see attached screen
> shot.

Ah, I see. That menu looks fine on my machine (using Firefox 3.7a3 on
Linux), but I can get something sort of similar if I boost the
Firefox's 'minimum font size' option to 12 or 13 instead of my usual 10.

It turns out that the "banner" section (from the green gradient to the
top, down to "Login/Preferences/...") is sized at exactly 135px high,
which makes some grave assumptions about the sizes of the fonts
involved. If I delete that fixed height, then the two rows of menus no
longer overlap.

The lower menu (Wiki/Timeline/...) still looks a bit odd, because its
gradient background is an image exactly 22px tall, so if the text is
higher than that you get a dark margin appearing below. Not much to be
done about, that, really - except perhaps changing the background
colour so it matches the final colour in the gradient, which makes the
problem less obvious rather than actually fixing it.


From jasonjwwilliams at gmail.com  Tue Mar 16 19:57:08 2010
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Tue, 16 Mar 2010 17:57:08 -0600
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log
	Files
In-Reply-To: <201003170001.00909.maarten@treewalker.org>
References: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
	<201003170001.00909.maarten@treewalker.org>
Message-ID: <3b949f091003161657y7fb0d0dboc806706676e827fb@mail.gmail.com>

True. Technically, you could also just kick it out to syslog and let
logrotate.d do the rotation for you.

The code I put up had a major "concurrency" error in that multiple
rotation threads could be launched and conflict with each other (try
to remove the same file).

Updated the Gist to deal with this: http://gist.github.com/334545

-J

On Tue, Mar 16, 2010 at 5:01 PM, Maarten ter Huurne
<maarten at treewalker.org> wrote:
> On Tuesday 16 March 2010, Jason J. W. Williams wrote:
>
>> Twistd blocks for a long period of time when the number of log files
>> built up is large, thereby causing connections to freeze and
>> (depending on the length of the rotation) time out.
>>
>> Given I've only used Twisted in the past and not contributed to it, I
>> was curious if someone could take a look at my changes to
>> twisted.python.logfile.LogFile's rotate() method and see if there's
>> any reason the changes would be a bad idea.
>>
>> What I've attempted to do is defer the rotation of the old log files
>> to a thread, and only rotate the current log file in the foreground.
>
> An alternative approach could be to name the log files differently.
> For example, use the timestamp of the rotation as a filename suffix:
> ?twistd.log.2010-03-16.23-56
>
> This is not the traditional way logging is done, but it would get good
> performance with simple code. (It would still need resolution of duplicate
> file names, in case the log rotates very quickly or the clock is moved
> backwards.)
>
> Bye,
> ? ? ? ? ? ? ? ?Maarten
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


From twisted at asheesh.org  Tue Mar 16 21:29:42 2010
From: twisted at asheesh.org (Asheesh Laroia)
Date: Tue, 16 Mar 2010 21:29:42 -0400 (EDT)
Subject: [Twisted-Python] Twisted easy bugs,
 and other thoughts about getting people involved in Twisted
In-Reply-To: <20100315001637.2792.1150179124.divmod.xquotient.1609@localhost.localdomain>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
	<d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>
	<alpine.DEB.2.00.1003141221001.18193@vellum>
	<20100315001637.2792.1150179124.divmod.xquotient.1609@localhost.localdomain>
Message-ID: <alpine.DEB.2.00.1003162105580.4600@vellum>

On Mon, 15 Mar 2010, exarkun at twistedmatrix.com wrote:

> On 14 Mar, 04:53 pm, twisted at asheesh.org wrote:
>>
>> One more thing -- pulling data out of Trac isn't actually super easy 
>> (-:. So if you want us to re-export that in some really simple format 
>> like a big JSON list, that's something else we can do.
>
> How do you mean?  It's actually pretty straightforward to get data out; 
> you can have it as rss, csv, or tsv in most cases.

Yeah -- but (see below)

> This leads me to wonder how you grabbed the "easy" tickets from the 
> tracker.  Surely this is an automated process which is reading the csv 
> format of a trac "tickets with `easy` keyword" query page?  If not, how 
> does the OpenHatch listing stay up to date?

It is doing just that to find the IDs to look at.

Then it actually scrapes the Trac-rendered HTML because the CSV export (as 
far as I know) can't tell us answers to questions like, "How many people 
were active on this bug?" I find that's a useful thing to show off.

So it's a combination of both, and we end up with a little more data than 
the Trac API exports. I'll probably start serving out JSON dumps soon.

-- Asheesh.

-- 
"No one gets too old to learn a new way of being stupid."


From maarten at treewalker.org  Wed Mar 17 04:19:54 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Wed, 17 Mar 2010 09:19:54 +0100
Subject: [Twisted-Python] Twisted easy bugs,
	and other thoughts about getting people involved in Twisted
In-Reply-To: <alpine.DEB.2.00.1003162105580.4600@vellum>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
	<20100315001637.2792.1150179124.divmod.xquotient.1609@localhost.localdomain>
	<alpine.DEB.2.00.1003162105580.4600@vellum>
Message-ID: <201003170919.54407.maarten@treewalker.org>

On Wednesday 17 March 2010, Asheesh Laroia wrote:

> Then it actually scrapes the Trac-rendered HTML because the CSV export
> (as far as I know) can't tell us answers to questions like, "How many
> people were active on this bug?" I find that's a useful thing to show
> off.

Not sure if it helps in your case, but I once made a script that produced a 
table of tickets associated with a milestone, to include with release notes. 
It needed the 1-line summary, which was not included in the CSV export. I 
thought I would have to resort to scraping the HTML, but then found that the 
RSS feed contained all the info I needed.

Bye,
		Maarten


From glyph at twistedmatrix.com  Wed Mar 17 12:12:12 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 17 Mar 2010 12:12:12 -0400
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log
	Files
In-Reply-To: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
References: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
Message-ID: <A8F98F95-ED5A-4AC1-A751-05243E602614@twistedmatrix.com>


On Mar 16, 2010, at 5:34 PM, Jason J. W. Williams wrote:

> Given I've only used Twisted in the past and not contributed to it, I
> was curious if someone could take a look at my changes to
> twisted.python.logfile.LogFile's rotate() method and see if there's
> any reason the changes would be a bad idea.


The right way to ask this question is to open a ticket on twistedmatrix.com and put it into review (attach the 'review' keyword).  More information is available here: <http://twistedmatrix.com/trac/wiki/ContributingToTwistedLabs>.  Otherwise, unless someone has a chance to look at it right away (which is always unlikely) it will languish in the mailing list archive forever.

Be sure to check back on the ticket when you receive feedback, as approximately 0% of suggested patches are actually accepted as-is without some cleanup :).

Thanks!

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100317/eca69639/attachment.htm 

From jasonjwwilliams at gmail.com  Wed Mar 17 12:51:48 2010
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Wed, 17 Mar 2010 10:51:48 -0600
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log
	Files
In-Reply-To: <A8F98F95-ED5A-4AC1-A751-05243E602614@twistedmatrix.com>
References: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
	<A8F98F95-ED5A-4AC1-A751-05243E602614@twistedmatrix.com>
Message-ID: <3b949f091003170951n5c29e7d9g403487a40edb30fc@mail.gmail.com>

As requested: http://twistedmatrix.com/trac/ticket/4372 Thank you for
taking a look at it.

-J

On Wed, Mar 17, 2010 at 10:12 AM, Glyph Lefkowitz
<glyph at twistedmatrix.com> wrote:
>
> On Mar 16, 2010, at 5:34 PM, Jason J. W. Williams wrote:
>
> Given I've only used Twisted in the past and not contributed to it, I
> was curious if someone could take a look at my changes to
> twisted.python.logfile.LogFile's rotate() method and see if there's
> any reason the changes would be a bad idea.
>
> The right way to ask this question is to open a ticket on twistedmatrix.com
> and put it into review (attach the 'review' keyword). ?More information is
> available here:
> <http://twistedmatrix.com/trac/wiki/ContributingToTwistedLabs>. ?Otherwise,
> unless someone has a chance to look at it right away (which is always
> unlikely) it will languish in the mailing list archive forever.
> Be sure to check back on the ticket when you receive feedback, as
> approximately 0% of suggested patches are actually accepted as-is without
> some cleanup :).
> Thanks!
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


From freelancer.c at gmail.com  Thu Mar 18 04:01:23 2010
From: freelancer.c at gmail.com (=?ISO-8859-1?B?KCopt7Rgty64LrvQ68RkTeTxt7Rgty64LrsoKik=?=)
Date: Thu, 18 Mar 2010 10:01:23 +0200
Subject: [Twisted-Python] Twisted and python threading
Message-ID: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>

Hi,

I'm trying to spawn a threading.Thread from a Twisted application, but
the thread won't start unless I schedule the the code with
reactor.callLater(), any Ideas ?


From andrew at bemusement.org  Thu Mar 18 06:08:25 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Thu, 18 Mar 2010 21:08:25 +1100
Subject: [Twisted-Python] Twisted and python threading
In-Reply-To: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>
References: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>
Message-ID: <20100318100825.GM14474@steerpike.home.puzzling.org>

(*)??`?.?.????dM????`?.?.?(*) wrote:
> Hi,
> 
> I'm trying to spawn a threading.Thread from a Twisted application, but
> the thread won't start unless I schedule the the code with
> reactor.callLater(), any Ideas ?

Twisted doesn't affect threading.Thread at all.

You haven't given much detail, so my best guess is that you are calling
Twisted APIs from a non-reactor thread.  Twisted's APIs are generally
*not* thread-safe, so that will give undefined behaviour (like nothing
happening when it should).  Basically the only API you should use is
reactor.callFromThread.  See
<http://twistedmatrix.com/documents/current/core/howto/threading.html>.

If that's not your problem, you'll have to elaborate more on what your
problem (like what precisely you mean by ?thread won't start?) and how
to reproduce it.

-Andrew.



From freelancer.c at gmail.com  Thu Mar 18 06:21:47 2010
From: freelancer.c at gmail.com (=?ISO-8859-1?B?KCopt7Rgty64LrvQ68RkTeTxt7Rgty64LrsoKik=?=)
Date: Thu, 18 Mar 2010 12:21:47 +0200
Subject: [Twisted-Python] Twisted and python threading
In-Reply-To: <20100318100825.GM14474@steerpike.home.puzzling.org>
References: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>
	<20100318100825.GM14474@steerpike.home.puzzling.org>
Message-ID: <e954baa91003180321gf10a0f4nb61c705867522f3e@mail.gmail.com>

Hi thanks for the reply,

I have a separate module that doesn't/shouldn't depend on Twisted, and
this module is begin called from a Twisted application, and it needs
to spawn a thread the thread doesn't call anything within Twisted, the
problem is when I call start() the thread doesn't run, but If I import
Twisted into this module and spawn the thread from reactor.callLater()
it works just fine, that is, this code works :

#from twisted.internet import reactor
#reactor.callLater(1, threading.Thread(target=_listen,
args=(self._client,)).start)

But this doesn't:
#threading.Thread(target=_listen, args=(self._client,)).start()

I asked on #twisted and someone said that something about my
application running as daemon and that destroys all threads spawned
before that, and that I should spawn the thread *after* it's fully
daemonized.

I haven't tested that yet but I will now.

On Thu, Mar 18, 2010 at 12:08 PM, Andrew Bennetts <andrew at bemusement.org> wrote:
> (*)??`?.?.????dM????`?.?.?(*) wrote:
>> Hi,
>>
>> I'm trying to spawn a threading.Thread from a Twisted application, but
>> the thread won't start unless I schedule the the code with
>> reactor.callLater(), any Ideas ?
>
> Twisted doesn't affect threading.Thread at all.
>
> You haven't given much detail, so my best guess is that you are calling
> Twisted APIs from a non-reactor thread. ?Twisted's APIs are generally
> *not* thread-safe, so that will give undefined behaviour (like nothing
> happening when it should). ?Basically the only API you should use is
> reactor.callFromThread. ?See
> <http://twistedmatrix.com/documents/current/core/howto/threading.html>.
>
> If that's not your problem, you'll have to elaborate more on what your
> problem (like what precisely you mean by ?thread won't start?) and how
> to reproduce it.
>
> -Andrew.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


From markscottwright at gmail.com  Thu Mar 18 10:29:27 2010
From: markscottwright at gmail.com (markscottwright at gmail.com)
Date: Thu, 18 Mar 2010 14:29:27 +0000
Subject: [Twisted-Python] Is it possible to turn off transactions for adbapi?
Message-ID: <005045029c1fe6bed60482140ed8@google.com>

I'm trying to get SQL Server 2005 to CREATE DATABASE using twisted.  
However, SQL Server won't allow you to run CREATE DATABASE within a  
transaction (apparently, it's not something sql server can roll back, which  
seems sensible). Which means that the following code results in an error.  
Is there a way to turn transactions off for a query?

@defer.inlineCallbacks
def test_simple_create():
try:
password = "xxx"
connection_string = "Driver={SQL Native Client}; Server=(local); UID=sa;  
PWD=%s;" % password
db = adbapi.ConnectionPool("pyodbc", connection_string, cp_noisy=True)
cmd = """CREATE DATABASE atest
ON (NAME=atest, FILENAME='c:\temp\atest', SIZE=64MB)
LOG ON (NAME=atestlog, FILENAME='c:\temp\atestlog', SIZE=64MB)"""
yield db.runOperation(cmd)
except Exception, e:
print e
finally:
db.close()
reactor.stop()


if __name__ == "__main__":
from twisted.python import log
import sys
test_simple_create()
log.startLogging(sys.stdout)
reactor.run()


===
2010-03-18 09:28:45-0500 [-] Log opened.
2010-03-18 09:28:45-0500 [-] adbapi connecting: pyodbc ('Driver={SQL Native  
Client}; Server=(local); UID=sa; PWD=xxx;',)
2010-03-18 09:28:45-0500 [-] ('42000', '[42000] [Microsoft][SQL Native  
Client][SQL Server]CREATE DATABASE statement not allowed within  
multi-statement transaction. (226) (SQLExecDirectW)')
2010-03-18 09:28:45-0500 [-] adbapi closing: pyodbc
2010-03-18 09:28:45-0500 [-] Main loop terminated.
2010-03-18 09:28:45-0500 [-]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100318/6a086bbb/attachment.htm 

From george at ringdevelopment.com  Thu Mar 18 11:53:24 2010
From: george at ringdevelopment.com (George Pauly)
Date: Thu, 18 Mar 2010 11:53:24 -0400
Subject: [Twisted-Python] Is it possible to turn off transactions
	for	adbapi?
In-Reply-To: <005045029c1fe6bed60482140ed8@google.com>
References: <005045029c1fe6bed60482140ed8@google.com>
Message-ID: <1268927604.31876.37.camel@localhost.localdomain>

Hi Mark,

On Thu, 2010-03-18 at 14:29 +0000, markscottwright at gmail.com wrote:
> I'm trying to get SQL Server 2005 to CREATE DATABASE using twisted.
> However, SQL Server won't allow you to run CREATE DATABASE within a
> transaction (apparently, it's not something sql server can roll back,
> which seems sensible). Which means that the following code results in
> an error. Is there a way to turn transactions off for a query?

First, you may be better off finding a SQL Server list.  

FWIW, and not a twisted solution per se, if the SQL server and your
twisted server are in a secured network you can send an http msg with
your create database statement.  This solution requires a webserver
(IIS) running on the sql server box and some configuration (a virtual
directory IIRC).

This solution will work from a non-windows OS.  For more complicated
queries, taking the ODBC black box out of the equation makes
optimization simpler (or even possible).  

LMA (Luvin my acronyms).

George

-- 
George Pauly
Ring Development
www.ringdevelopment.com



From renan at renanfernandes.org  Thu Mar 18 12:01:20 2010
From: renan at renanfernandes.org (Renan Mathias Fernandes)
Date: Thu, 18 Mar 2010 13:01:20 -0300
Subject: [Twisted-Python] FTP Client - questions
Message-ID: <252D1536-2315-4847-B169-AF07D01F7D8D@renanfernandes.org>

Hello,

	I am trying to learn/implement a FTP Client, but I am facing a problem: How can I check if the retrieveFile method has finished downloading a file? As far as I can see, there is no easy way to do this, am I incorrect?
Below is an example of what I am doing to retrieve a file:

class FileReceiver(Protocol):
    """
        Protocol subclass that writes received data to a local file.
    """
    def __init__(self, filename):
        self.file = open(filename, 'wb')

    def dataReceived(self, data):
        self.file.write(data)
                
def connectionMade(ftpClient):
    test = FileReceiver('./testRetrieve.txt')
    
    try:
        ftpClient.retrieveFile('testFile.txt',test)
    except:
        print "Exception -", sys.exc_value
        reactor.stop()


Can anyone shed a light?

Thanks in advance,

Renan Mathias Fernandes






From markscottwright at gmail.com  Thu Mar 18 12:44:21 2010
From: markscottwright at gmail.com (Mark Wright)
Date: Thu, 18 Mar 2010 11:44:21 -0500
Subject: [Twisted-Python] Is it possible to turn off transactions for
	adbapi?
In-Reply-To: <1268927604.31876.37.camel@localhost.localdomain>
References: <005045029c1fe6bed60482140ed8@google.com>
	<1268927604.31876.37.camel@localhost.localdomain>
Message-ID: <db986be81003180944h7fab894ckb1a5fc2e91782d79@mail.gmail.com>

Hey - ! was wrong.  It's actually easy, just specify "autocommit=True"
in your call to adbapi.ConnectionPool(...) and runOperation can
execute "create database".

On Thu, Mar 18, 2010 at 10:53 AM, George Pauly
<george at ringdevelopment.com> wrote:
> Hi Mark,
>
> On Thu, 2010-03-18 at 14:29 +0000, markscottwright at gmail.com wrote:
>> I'm trying to get SQL Server 2005 to CREATE DATABASE using twisted.
>> However, SQL Server won't allow you to run CREATE DATABASE within a
>> transaction (apparently, it's not something sql server can roll back,
>> which seems sensible). Which means that the following code results in
>> an error. Is there a way to turn transactions off for a query?
>
> First, you may be better off finding a SQL Server list.
>
> FWIW, and not a twisted solution per se, if the SQL server and your
> twisted server are in a secured network you can send an http msg with
> your create database statement. ?This solution requires a webserver
> (IIS) running on the sql server box and some configuration (a virtual
> directory IIRC).
>
> This solution will work from a non-windows OS. ?For more complicated
> queries, taking the ODBC black box out of the equation makes
> optimization simpler (or even possible).
>
> LMA (Luvin my acronyms).
>
> George
>
> --
> George Pauly
> Ring Development
> www.ringdevelopment.com
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Mark Wright
markscottwright at gmail.com


From andrew at bemusement.org  Thu Mar 18 18:52:30 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Fri, 19 Mar 2010 09:52:30 +1100
Subject: [Twisted-Python] FTP Client - questions
In-Reply-To: <252D1536-2315-4847-B169-AF07D01F7D8D@renanfernandes.org>
References: <252D1536-2315-4847-B169-AF07D01F7D8D@renanfernandes.org>
Message-ID: <20100318225230.GN14474@steerpike.home.puzzling.org>

Renan Mathias Fernandes wrote:
> Hello,
> 
> 	I am trying to learn/implement a FTP Client, but I am facing a problem:
> 	How can I check if the retrieveFile method has finished downloading a
> 	file? As far as I can see, there is no easy way to do this, am I
> 	incorrect?

You are incorrect.  FTPClient.retrieveFile returns a Deferred that fires
when the download is complete (or reports a failure).

The API doc hints at this, but could be clearer.
<http://twistedmatrix.com/documents/current/api/twisted.protocols.ftp.FTPClient.html#retrieveFile>

>     try:
>         ftpClient.retrieveFile('testFile.txt',test)
>     except:
>         print "Exception -", sys.exc_value
>         reactor.stop()
> 
> 
> Can anyone shed a light?

A direct correction to this snippet is:

    d = ftpClient.retrieveFile('testFile.txt', test)
    def eb(failure):
    	print "Exception -", failure.getErrorMessage()
	reactor.stop()
    d.addErrback(eb)

(Although like your code will only stop the reactor when an error
occurs, and doesn't do anything when the download completes
successfully.)

-Andrew.



From 4kir4.1i at gmail.com  Thu Mar 18 11:42:45 2010
From: 4kir4.1i at gmail.com (Akira)
Date: Thu, 18 Mar 2010 18:42:45 +0300
Subject: [Twisted-Python] Twisted and python threading
References: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>
	<20100318100825.GM14474@steerpike.home.puzzling.org>
	<e954baa91003180321gf10a0f4nb61c705867522f3e@mail.gmail.com>
Message-ID: <m3aau5prey.fsf@tb10.ngrid.ru>

"(*)??`?.?.????dM????`?.?.?(*)" <freelancer.c at gmail.com> writes:

> I asked on #twisted and someone said that something about my
> application running as daemon and that destroys all threads spawned
> before that, and that I should spawn the thread *after* it's fully
> daemonized.
reactor.callWhenRunning() could be used to spawn the thread. Then
reactor.callFromThread() (from within the thread) could be used to run
code that should run in the reactor's mainloop i.e., twisted related
code.


--
Akira.



From don at delphexonline.com  Fri Mar 19 08:35:07 2010
From: don at delphexonline.com (Don Schoeman)
Date: Fri, 19 Mar 2010 14:35:07 +0200
Subject: [Twisted-Python] Error: filedescriptor out of range in select
Message-ID: <4BA36F7B.2080600@delphexonline.com>

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100319/1559ef31/attachment.htm 

From andrew at bemusement.org  Fri Mar 19 08:58:30 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Fri, 19 Mar 2010 23:58:30 +1100
Subject: [Twisted-Python] Error: filedescriptor out of range in select
In-Reply-To: <4BA36F7B.2080600@delphexonline.com>
References: <4BA36F7B.2080600@delphexonline.com>
Message-ID: <20100319125830.GA17997@steerpike.home.puzzling.org>

Don Schoeman wrote:
>    Hi guys, I have started having this problem a few weeks ago and it
>    happens about once a week after which I have to restart my Twisted
>    based server to function again. It seems to be happening when I
>    make RPC calls using twisted.web.xmlrpc.Proxy. I have reason to
>    believe that I am either running out of file handles or connection
>    limits. I have up-sized my connection limits and ulimit -n? gives
>    me 9000.

Note though that select() has a builtin limit, which varies by platform
but is probably 1024 for you.  So perhaps try the poll or epoll reactor
instead.

>    I receive less than 30 connections though so there must be some
>    kind of leak. The error I'm getting is the following:

30 is much less than 1024, though, so a leak does sound probable.

[...]
>    Now I know this is a very generic error and it could mean a lot of
>    things, but how would I even start tracking the leak down? Is there
>    a way I can try and track the number of file descriptors?

There's always strace, or looking in /proc/PID/fd.

>    I am using Twisted version 8.2.0 on Ubuntu Server Edition 9.10

Maybe try upgrading Twisted, preferably to 10.0.0?  I'm not sure if a
bug related to your problems was fixed since 8.2.0, but a lot of bugs
have been fixed in that ~2 years.  Hopefully there's a PPA somewhere
with a newer Twisted for your version of Ubuntu.

-Andrew.



From don at delphexonline.com  Fri Mar 19 10:53:35 2010
From: don at delphexonline.com (Don Schoeman)
Date: Fri, 19 Mar 2010 16:53:35 +0200
Subject: [Twisted-Python] Error: filedescriptor out of range in select
In-Reply-To: <20100319125830.GA17997@steerpike.home.puzzling.org>
References: <4BA36F7B.2080600@delphexonline.com>
	<20100319125830.GA17997@steerpike.home.puzzling.org>
Message-ID: <4BA38FEF.20302@delphexonline.com>

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100319/2d4c0e8c/attachment.htm 

From johnaherne at rocs.co.uk  Fri Mar 19 12:35:52 2010
From: johnaherne at rocs.co.uk (John Aherne)
Date: Fri, 19 Mar 2010 16:35:52 +0000
Subject: [Twisted-Python] Error: filedescriptor out of range in select
In-Reply-To: <4BA38FEF.20302@delphexonline.com>
References: <4BA36F7B.2080600@delphexonline.com>
	<20100319125830.GA17997@steerpike.home.puzzling.org>
	<4BA38FEF.20302@delphexonline.com>
Message-ID: <faf2d7811003190935q6a4a5638k1347fd45e04863f2@mail.gmail.com>

I think you will find that gprs devices will drop off the network but the
router will still keep the coonection open. The gprs device will then
reconnect on a different connection and port. So you will need to clean up
old connections used by that device.

Hope that helps

John Aherne


On Fri, Mar 19, 2010 at 2:53 PM, Don Schoeman <don at delphexonline.com> wrote:

>  Hi Andrew, thanks for taking the time to comment on my email.
>
> I'm going to have to study your proposal to switch to poll/epoll anyway
> since I am expecting more and more connections to be made over time. This
> particular application is used to communicate with a bunch of GPRS devices
> and I'm starting to think that these devices might not be closing a
> connection properly which could perhaps lead to this particular problem. I
> am going to discuss it with the manufacturers of these devices as well.
>
> Thanks again for your help.
>
> Kind Regards,
> Don
>
>
> Andrew Bennetts wrote:
>
> Don Schoeman wrote:
>
>
>     Hi guys, I have started having this problem a few weeks ago and it
>    happens about once a week after which I have to restart my Twisted
>    based server to function again. It seems to be happening when I
>    make RPC calls using twisted.web.xmlrpc.Proxy. I have reason to
>    believe that I am either running out of file handles or connection
>    limits. I have up-sized my connection limits and ulimit -n  gives
>    me 9000.
>
>
>  Note though that select() has a builtin limit, which varies by platform
> but is probably 1024 for you.  So perhaps try the poll or epoll reactor
> instead.
>
>
>
>     I receive less than 30 connections though so there must be some
>    kind of leak. The error I'm getting is the following:
>
>
>  30 is much less than 1024, though, so a leak does sound probable.
>
> [...]
>
>
>     Now I know this is a very generic error and it could mean a lot of
>    things, but how would I even start tracking the leak down? Is there
>    a way I can try and track the number of file descriptors?
>
>
>  There's always strace, or looking in /proc/PID/fd.
>
>
>
>     I am using Twisted version 8.2.0 on Ubuntu Server Edition 9.10
>
>
>  Maybe try upgrading Twisted, preferably to 10.0.0?  I'm not sure if a
> bug related to your problems was fixed since 8.2.0, but a lot of bugs
> have been fixed in that ~2 years.  Hopefully there's a PPA somewhere
> with a newer Twisted for your version of Ubuntu.
>
> -Andrew.
>
>
> _______________________________________________
> Twisted-Python mailing listTwisted-Python at twistedmatrix.comhttp://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100319/af4777d3/attachment.htm 

From nullnull26 at gmail.com  Fri Mar 19 15:16:26 2010
From: nullnull26 at gmail.com (null null)
Date: Fri, 19 Mar 2010 20:16:26 +0100
Subject: [Twisted-Python] python-daemon PID file
Message-ID: <eeca458e1003191216t63933b8fm25179e2b0f4e7091@mail.gmail.com>

Hi all,

Im trying to get a daemon up and running but i cant get python-daemon to
create a PID file.
versions:
Python 2.5.2
python-daemon-1.5.5
Debian Linux 2.6.26-2-686

<code>
import daemon
import lockfile

daemon.DaemonContext(pidfile=lockfile.FileLock('/var/run/mydaemon.pid'),)

daemon.__enter__()
main()
daemon.__exit__()

</code>

The above doesnt create a pid file, ive tried different permissions for the
daemon and manualy making the pid file in the main() but no luck.

In summary: I cant get a PID file created or populated with a PID by
python-daemon.
Anyone see something that im doing wrong? ive been sitting on this way too
long. I looked at the python-daemon source and i cant see where the pid is
inserted into the pid file, only where it __enter__'s the lockfile so is
this functionality missing?

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100319/c6cb5e68/attachment.htm 

From exarkun at twistedmatrix.com  Fri Mar 19 19:26:35 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 19 Mar 2010 23:26:35 -0000
Subject: [Twisted-Python] Twisted Sprint this Sunday
Message-ID: <20100319232635.2792.265340463.divmod.xquotient.1772@localhost.localdomain>

Hi all,

Flumotion is going to be hosting a sprint this Sunday (Mid-morning to 
evening, Spanish time).  I'll be introducing a lot of developers to the 
Twisted development process and trying to find them good first-time- 
contributor tickets to work on.  Even if you're not on the Iberian 
peninsula this weekend, you can still participate virtually. :)  If 
anyone wants to help out with reviews or suggest tickets that might be 
productive to work on, meet up with us in #twisted on Freenode.

Jean-Paul


From lasizoillo at gmail.com  Fri Mar 19 19:58:07 2010
From: lasizoillo at gmail.com (lasizoillo)
Date: Sat, 20 Mar 2010 00:58:07 +0100
Subject: [Twisted-Python] Twisted Sprint this Sunday
In-Reply-To: <20100319232635.2792.265340463.divmod.xquotient.1772@localhost.localdomain>
References: <20100319232635.2792.265340463.divmod.xquotient.1772@localhost.localdomain>
Message-ID: <49414f571003191658jf5e1f49ic0e49158ee46a558@mail.gmail.com>

2010/3/20  <exarkun at twistedmatrix.com>:
> Hi all,
>
> Flumotion is going to be hosting a sprint this Sunday (Mid-morning to
> evening, Spanish time). ?I'll be introducing a lot of developers to the
> Twisted development process and trying to find them good first-time-
> contributor tickets to work on. ?Even if you're not on the Iberian
> peninsula this weekend, you can still participate virtually. :) ?If
> anyone wants to help out with reviews or suggest tickets that might be
> productive to work on, meet up with us in #twisted on Freenode.
>
Nobody expects the Spanish sprints. Good news :-)


From exarkun at twistedmatrix.com  Sun Mar 21 00:05:26 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 21 Mar 2010 04:05:26 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1269144326.53.591501367@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100321/5ecb5254/attachment.htm 

From sara.byh at gmail.com  Sun Mar 21 04:24:14 2010
From: sara.byh at gmail.com (sara bai)
Date: Sun, 21 Mar 2010 01:24:14 -0700
Subject: [Twisted-Python] sara bai wants to chat
Message-ID: <1a16f0711003210124v76ed3ebcr@mail.gmail.com>

I've been using Google Talk and thought you might like to try it out.
We can use it to call each other for free over the internet. Here's an
invitation to download Google Talk. Give it a try!

-----------------------------------------------------------------------

sara bai wants to stay in better touch using some of Google's coolest new
products.

If you already have Gmail or Google Talk, visit:
http://mail.google.com/mail/b-9f11c59641-70c58d7828-5e0dfd9bfa94a78a
You'll need to click this link to be able to chat with sara bai.

To get Gmail - a free email account from Google with over 2,800 megabytes of
storage - and chat with sara bai, visit:
http://mail.google.com/mail/a-9f11c59641-70c58d7828-5e0dfd9bfa94a78a

Gmail offers:
- Instant messaging right inside Gmail
- Powerful spam protection
- Built-in search for finding your messages and a helpful way of organizing
  emails into "conversations"
- No pop-up ads or untargeted banners - just text ads and related information
  that are relevant to the content of your messages

All this, and its yours for free. But wait, there's more! By opening a Gmail
account, you also get access to Google Talk, Google's instant messaging
service:

http://www.google.com/talk/

Google Talk offers:
- Web-based chat that you can use anywhere, without a download
- A contact list that's synchronized with your Gmail account
- Free, high quality PC-to-PC voice calls when you download the Google Talk
  client

We're working hard to add new features and make improvements, so we might also
ask for your comments and suggestions periodically. We appreciate your help in
making our products even better!

Thanks,
The Google Team

To learn more about Gmail and Google Talk, visit:
http://mail.google.com/mail/help/about.html
http://www.google.com/talk/about.html

(If clicking the URLs in this message does not work, copy and paste them into
the address bar of your browser).


From glyph at twistedmatrix.com  Mon Mar 22 21:32:11 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 22 Mar 2010 21:32:11 -0400
Subject: [Twisted-Python] python-daemon PID file
In-Reply-To: <eeca458e1003191216t63933b8fm25179e2b0f4e7091@mail.gmail.com>
References: <eeca458e1003191216t63933b8fm25179e2b0f4e7091@mail.gmail.com>
Message-ID: <6B84FDE8-BCC7-4F02-A903-F2373C2C02BC@twistedmatrix.com>


On Mar 19, 2010, at 3:16 PM, null null wrote:

> Im trying to get a daemon up and running but i cant get python-daemon to create a PID file.
> versions:
> Python 2.5.2
> python-daemon-1.5.5
> Debian Linux 2.6.26-2-686

This is the mailing list for Twisted, which you do not appear to be using.  Twisted also does not use python-daemon, and has pretty much nothing to do with it.

For information on python-daemon, including an email address for its author, please see <http://pypi.python.org/pypi/python-daemon/>.

However, if you use the 'twistd' tool which is bundled with Twisted, it will create PID files for you, and you won't have this problem :).





From glyph at twistedmatrix.com  Mon Mar 22 22:39:08 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 22 Mar 2010 22:39:08 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
Message-ID: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>

Hello successful Twisted users,

Several times over the last month I've been contacted by Twisted supporters who are looking to make the case to others within their organizations that Twisted is a worthwhile thing to sponsor.  The most common question has been: "what are other people using this for?".  Inevitably they'll end up at <http://twistedmatrix.com/trac/wiki/SuccessStories> - if we're lucky, they'll also see <http://twistedmatrix.com/trac/wiki/ProjectsUsingTwisted>, but that's only a slight improvement.  These pages are pretty anemic and frankly don't present a good impression of what is really possible with Twisted.  I note that several prominent users aren't represented at all.  You know who you are!

If you're a happy Twisted user who has used Twisted to do something cool, *please* send in a blurb for the success stories page!  This could translate into more money and more development for Twisted, thus making it even more awesome.  This goes double if you're a sponsor: please let us know why you sponsored and how happy you were that you did :).

If you're looking to volunteer some time for Twisted, but don't have much time to volunteer, becoming to be the official curator of these pages would be a small commitment but it would be quite helpful.  As I said, presenting a good public face for Twisted's maturity and broad applicability can translate directly into increased resources, so in the long term it would have a big impact.

Finally, if you're _not_ happy, it's always great to get some constructive criticism.  Best would be in the form of well-specified bugs filed at <http://twistedmatrix.com/trac/newticket>, of course ;).

Thanks,

-glyph



From don at delphexonline.com  Tue Mar 23 03:03:58 2010
From: don at delphexonline.com (Don Schoeman)
Date: Tue, 23 Mar 2010 09:03:58 +0200
Subject: [Twisted-Python] Error: filedescriptor out of range in select
In-Reply-To: <faf2d7811003190935q6a4a5638k1347fd45e04863f2@mail.gmail.com>
References: <4BA36F7B.2080600@delphexonline.com>	<20100319125830.GA17997@steerpike.home.puzzling.org>	<4BA38FEF.20302@delphexonline.com>
	<faf2d7811003190935q6a4a5638k1347fd45e04863f2@mail.gmail.com>
Message-ID: <4BA867DE.40307@delphexonline.com>

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100323/eef583ab/attachment.htm 

From itamar at itamarst.org  Tue Mar 23 08:58:16 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 23 Mar 2010 08:58:16 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
Message-ID: <1269349096.27623.23.camel@pintsize>

On Mon, 2010-03-22 at 22:39 -0400, Glyph Lefkowitz wrote:

> If you're a happy Twisted user who has used Twisted to do something
> cool, *please* send in a blurb for the success stories page!  This
> could translate into more money and more development for Twisted, thus
> making it even more awesome.  This goes double if you're a sponsor:
> please let us know why you sponsored and how happy you were that you
> did :).

I'll see if I can write something up for ITA. 

We should also add all the projects from the launchpad tx (those that
have actual releases, anyway) to the ProjectsUsingTwisted page.

My "itamar" account appears to no longer be able to edit wiki pages -
could someone fix that? Thanks!



From alexandre at quessy.net  Tue Mar 23 09:15:36 2010
From: alexandre at quessy.net (Alexandre Quessy)
Date: Tue, 23 Mar 2010 09:15:36 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <1269349096.27623.23.camel@pintsize>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
	<1269349096.27623.23.camel@pintsize>
Message-ID: <72236ba91003230615k62683450s52b54fca70eae752@mail.gmail.com>

Hello,
I am in a hurry, but here are a few projects I am working on. They all
use Twisted. They are all intended to be used in audio-video artworks
and tools.

 * Toonloop : (toonloop.com) Software suite for performing with live
frame by frame animation creation
 * Lunch : (http://svn.sat.qc.ca/trac/lunch) Simple process launcher
for complex distributed setup
 * Scenic : (http://svn.sat.qc.ca/trac/scenic) Telepresence software
for wide bandwidth networks and oriented toward live performances
 * Purity : (http://wiki.dataflow.ws/Purity) Python library for Pure
Data dynamic patching to create audio patches.

Cheers,

a

2010/3/23 Itamar Turner-Trauring <itamar at itamarst.org>:
> On Mon, 2010-03-22 at 22:39 -0400, Glyph Lefkowitz wrote:
>
>> If you're a happy Twisted user who has used Twisted to do something
>> cool, *please* send in a blurb for the success stories page! ?This
>> could translate into more money and more development for Twisted, thus
>> making it even more awesome. ?This goes double if you're a sponsor:
>> please let us know why you sponsored and how happy you were that you
>> did :).
>
> I'll see if I can write something up for ITA.
>
> We should also add all the projects from the launchpad tx (those that
> have actual releases, anyway) to the ProjectsUsingTwisted page.
>
> My "itamar" account appears to no longer be able to edit wiki pages -
> could someone fix that? Thanks!
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Alexandre Quessy
http://alexandre.quessy.net/


From laiw at student.ethz.ch  Tue Mar 23 10:00:50 2010
From: laiw at student.ethz.ch (Willy Lai)
Date: Tue, 23 Mar 2010 15:00:50 +0100
Subject: [Twisted-Python] stdio.StandardIO blocks?
Message-ID: <4BA8C992.1070002@student.ethz.ch>

Hi all

I'm new to twisted and also have not a lot of Python experience.
My problem boils down to following situation:

I have a server and a client over TCP, once the client is connected to 
the server,
the server periodically pings the client in order to check if it is 
still alive.
The client sends a response/pong back to each ping.

These messages are printed to stdout. The two consoles would then look like:

[connected]
ping
pong
...2 seconds ...
ping
pong
...2 seconds ...
ping
pong
...

Now the user should be able to write commands in the command line, which 
get's
sent to the server, without interrupting the pings. But in my case, 
while writing on the console the output stops.
The server will send a ping, but the client does not seem to receive the 
ping, since I don't get a pong on the server.
What happens at the moment I type something in the command line?

What I want, is writing stuff in the console, without interrupting the 
ping mechanism.
(The pings and pongs in my case should continue to be sent while typing 
stuff in the console)

That's how I use StandardIO:

class CommandLine(protocol.Protocol):

     def __init__(self, protocol):
         self.protocol = protocol

     def dataReceived(self, data):
         print('INPUT: %s' % (data)

class Client(protocol.DatagramProtocol):

     def __init__(self):
         # initialize command line connector
         commandLine = CommandLine(self)
         # connect member to command line output
         self.output = stdio.StandardIO(commandLine)

Cheers


From dvkeeney at gmail.com  Tue Mar 23 12:48:41 2010
From: dvkeeney at gmail.com (David)
Date: Tue, 23 Mar 2010 10:48:41 -0600
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
Message-ID: <6e04113a1003230948j41fd0e5bn53ceda6970b36e43@mail.gmail.com>

On Mon, Mar 22, 2010 at 8:39 PM, Glyph Lefkowitz
<glyph at twistedmatrix.com> wrote:

> If you're a happy Twisted user who has used Twisted to do something cool, *please* send in a blurb for the success stories page! ?This could translate into more money and more development for Twisted, thus making it even more awesome. ?This goes double if you're a sponsor: please let us know why you sponsored and how happy you were that you did :).


Rdbhost

Rdbhost uses Twisted for a streaming web-server.  The streaming server
allows users to stream large SQL 'dump' files to and from the database
host using a web browser.

http://www.rdbhost.com

-- 
dkeeney at rdbhost.com
Rdbhost -> SQL databases as a webservice [www.rdbhost.com]


From raq at cttc.upc.edu  Tue Mar 23 14:30:36 2010
From: raq at cttc.upc.edu (Ramiro Alba Queipo)
Date: Tue, 23 Mar 2010 19:30:36 +0100
Subject: [Twisted-Python] Logout from a perspective broker server
Message-ID: <1269369036.6222.11.camel@mundo>

Hi all,

I wonder, if I client using pygtk, can logout from the server without
calling reactor.stop(), as you would kill the GUI. I tried to delete the
perspective got from the server but it does not work...

Thanks in advance
Regards

-- 
Ramiro Alba

Centre Tecnol?gic de Tranfer?ncia de Calor
http://www.cttc.upc.edu


Escola T?cnica Superior d'Enginyeries
Industrial i Aeron?utica de Terrassa
Colom 11, E-08222, Terrassa, Barcelona, Spain
Tel: (+34) 93 739 86 46


-- 
Aquest missatge ha estat analitzat per MailScanner
a la cerca de virus i d'altres continguts perillosos,
i es considera que est? net.



From glyph at twistedmatrix.com  Wed Mar 24 05:22:39 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Mar 2010 05:22:39 -0400
Subject: [Twisted-Python] stdio.StandardIO blocks?
In-Reply-To: <4BA8C992.1070002@student.ethz.ch>
References: <4BA8C992.1070002@student.ethz.ch>
Message-ID: <6EB44FA1-3F26-433F-A2B3-3FE4AC3A5BD0@twistedmatrix.com>


On Mar 23, 2010, at 10:00 AM, Willy Lai wrote:

> What I want, is writing stuff in the console, without interrupting the 
> ping mechanism.
> (The pings and pongs in my case should continue to be sent while typing 
> stuff in the console)

Without a *complete* program example, we can't really tell you what might be blocking. It may be a lot of things, from some very simple problems to some very complex ones.  Please see <http://sscce.org/> for details on what types of examples would be useful.

Based on your simple description, this really should work.  If it didn't, 'twistd' wouldn't be able to log to stdout and run a server at the same time (and it definitely can, I do that every day, at least ten times).

Thanks,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100324/65c72bbb/attachment.htm 

From glyph at twistedmatrix.com  Wed Mar 24 05:27:13 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Mar 2010 05:27:13 -0400
Subject: [Twisted-Python] Logout from a perspective broker server
In-Reply-To: <1269369036.6222.11.camel@mundo>
References: <1269369036.6222.11.camel@mundo>
Message-ID: <44DAEAB5-A177-4367-BBE0-98475F236004@twistedmatrix.com>


On Mar 23, 2010, at 2:30 PM, Ramiro Alba Queipo wrote:

> I wonder, if I client using pygtk, can logout from the server without
> calling reactor.stop(), as you would kill the GUI. I tried to delete the
> perspective got from the server but it does not work...

The simplest thing you can do to achieve this is 'broker.transport.loseConnection()'.

Of course, that just unceremoniously drops the connection.  You may want to have a 'remote_disconnect' method on the server too, if you have any state you would like to cleanly finish up with first.

Your GUI is already handling disconnection due to network problems though, right?  :-)  So the modification to make it handle this slightly-cleaner disconnect should be minor.  If it doesn't, see the notifyOnDisconnect API in PB: <http://twistedmatrix.com/documents/10.0.0/api/twisted.spread.pb.Broker.html#notifyOnDisconnect>.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100324/dac4c598/attachment.htm 

From raq at cttc.upc.edu  Wed Mar 24 08:28:45 2010
From: raq at cttc.upc.edu (Ramiro Alba Queipo)
Date: Wed, 24 Mar 2010 13:28:45 +0100
Subject: [Twisted-Python] Logout from a perspective broker server
In-Reply-To: <44DAEAB5-A177-4367-BBE0-98475F236004@twistedmatrix.com>
References: <1269369036.6222.11.camel@mundo>
	<44DAEAB5-A177-4367-BBE0-98475F236004@twistedmatrix.com>
Message-ID: <1269433725.6222.20.camel@mundo>

Glyph,

> > I wonder, if I client using pygtk, can logout from the server
> > without
> > calling reactor.stop(), as you would kill the GUI. I tried to delete
> > the
> > perspective got from the server but it does not work...
> 
> The simplest thing you can do to achieve this is
> 'broker.transport.loseConnection()'.
> 
> 
> Of course, that just unceremoniously drops the connection.  You may
> want to have a 'remote_disconnect' method on the server too, if you
> have any state you would like to cleanly finish up with first.
> 
After having a look at pb.py code I used

factory = pb.PBClientFactory()
....

factory.disconnect()

Then this makes the server call a 'logout' method for the current
perspective, and makes a clean logout. Any comment?


> 
> Your GUI is already handling disconnection due to network problems
> though, right?  :-)  So the modification to make it handle this
> slightly-cleaner disconnect should be minor.  If it doesn't, see the
> notifyOnDisconnect API in PB:
> <http://twistedmatrix.com/documents/10.0.0/api/twisted.spread.pb.Broker.html#notifyOnDisconnect>.

Yeah. I was already using it. Very nice. I also wanted to enable a way
to conecct and disconnect from the client, apart from the client be
aware of a server restart on simply loosing connection. It works
cleanly.

Really grateful for your info and comments

Regards

> 
-- 
Ramiro Alba

Centre Tecnol?gic de Tranfer?ncia de Calor
http://www.cttc.upc.edu


Escola T?cnica Superior d'Enginyeries
Industrial i Aeron?utica de Terrassa
Colom 11, E-08222, Terrassa, Barcelona, Spain
Tel: (+34) 93 739 86 46


-- 
Aquest missatge ha estat analitzat per MailScanner
a la cerca de virus i d'altres continguts perillosos,
i es considera que est? net.



From albert.brandl at weiermayer.com  Wed Mar 24 08:39:17 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Wed, 24 Mar 2010 13:39:17 +0100
Subject: [Twisted-Python] NetstringReceiver
Message-ID: <20100324123917.GA24344@weiermayer.com>

Hi!

The NetstringReceiver class does not exactly do what I'd expect - see 
issue http://twistedmatrix.com/trac/ticket/4378. Since we plan to use 
netstrings, I am trying to fix it.

I am not quite sure how to handle certain problems, though, and that's 
where I'd appreciate help. If this is the wrong place to ask this kind of 
questions, please redirect me ;-).

1.) In the current implementation, a NetstringParseError results in a 
call to self.transport.loseConnection(). Furthermore the variable 
brokenPeer is set to 1. But this variable is ignored. Would it be better 
to check it before receiving data? If yes: what is the correct way for a 
protocol to handle a broken transport? There is a ConnectionLost 
exception, but I'm not sure if / when a Protocol is allowed to raise it.

2.) The current implementation uses the method dataReceived to assemble 
the content of the netstring. When it is complete, the method 
stringReceived (which raises a NotImplementedError by default) is called. 
But netstrings can be long - would it be better to create a Deferred 
instance and call its callback instead? What would be the right place to 
create this Deferred?

3.) I started testing the NetstringReceiver by creating a class comment 
with doctests. When I later grepped the sources, I found some doctests, 
but there no mention of the doctest module in the test policy document. 
Would it be better to use the unittest framework for testing the code?

Thanks and best regards,

--
Albert Brandl
Weiermayer Solutions GmbH
4813 Altm?nster | Abteistra?e 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081


From andrew at bemusement.org  Wed Mar 24 18:22:03 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Thu, 25 Mar 2010 09:22:03 +1100
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100324123917.GA24344@weiermayer.com>
References: <20100324123917.GA24344@weiermayer.com>
Message-ID: <20100324222203.GF17997@steerpike.home.puzzling.org>

Albert Brandl wrote:
> Hi!
> 
> The NetstringReceiver class does not exactly do what I'd expect - see 
> issue http://twistedmatrix.com/trac/ticket/4378. Since we plan to use 
> netstrings, I am trying to fix it.
> 
> I am not quite sure how to handle certain problems, though, and that's 
> where I'd appreciate help. If this is the wrong place to ask this kind of 
> questions, please redirect me ;-).
> 
> 1.) In the current implementation, a NetstringParseError results in a 
> call to self.transport.loseConnection(). Furthermore the variable 
> brokenPeer is set to 1. But this variable is ignored. Would it be better 
> to check it before receiving data? If yes: what is the correct way for a 
> protocol to handle a broken transport? There is a ConnectionLost 
> exception, but I'm not sure if / when a Protocol is allowed to raise it.

No; I think once loseConnection has been called dataReceived won't be
called again, so there's no point checking for brokenPeer in
dataReceived.

It might be worth checking in sendString, but I would expect that it
would already raise an appropriate exception because it will try to
write to a closed transport.

> 2.) The current implementation uses the method dataReceived to assemble 
> the content of the netstring. When it is complete, the method 
> stringReceived (which raises a NotImplementedError by default) is called. 
> But netstrings can be long - would it be better to create a Deferred 
> instance and call its callback instead? What would be the right place to 
> create this Deferred?

No.

I'm rather confused about why you're even asking this question.  Exactly
what API are you proposing as an alternative to the existing API (which
is subclass NetstringReceiver and override stringReceived, and
stringReceived will be called for every netstring that is received, as
soon as it is received)?

> 3.) I started testing the NetstringReceiver by creating a class comment 
> with doctests. When I later grepped the sources, I found some doctests, 
> but there no mention of the doctest module in the test policy document. 
> Would it be better to use the unittest framework for testing the code?

Yes please.

There are some existing tests for NetstringReceiver in
twisted/test/test_protocols.py.

-Andrew.



From glyph at twistedmatrix.com  Wed Mar 24 18:53:58 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Mar 2010 18:53:58 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <6e04113a1003230948j41fd0e5bn53ceda6970b36e43@mail.gmail.com>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
	<6e04113a1003230948j41fd0e5bn53ceda6970b36e43@mail.gmail.com>
Message-ID: <CB817FCF-4F65-46C2-9D40-16F6DE0385ED@twistedmatrix.com>


On Mar 23, 2010, at 12:48 PM, David wrote:

> Rdbhost
> 
> Rdbhost uses Twisted for a streaming web-server.  The streaming server
> allows users to stream large SQL 'dump' files to and from the database
> host using a web browser.
> 
> http://www.rdbhost.com

Thanks, David.  I've added that to ProjectsUsingTwisted.

For SuccessStories though, we like it to be a bit punchier, and have at least a small blurb about why Twisted was especially well-suited to the job or how it helped things get done quicker, or something impressive about the performance/scale of the application.  Plus, it's nice to have a name and an official title to put along with the recommendation.  Do you mind if we credit you as "David Keeney, Founder, RdbHost"?  If it's not too much trouble, would you mind having a look at the other stuff at <http://twistedmatrix.com/trac/wiki/SuccessStories> and use one of them as an example?

Thanks again,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100324/986fb0e1/attachment.htm 

From glyph at twistedmatrix.com  Wed Mar 24 18:59:39 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Mar 2010 18:59:39 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <72236ba91003230615k62683450s52b54fca70eae752@mail.gmail.com>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
	<1269349096.27623.23.camel@pintsize>
	<72236ba91003230615k62683450s52b54fca70eae752@mail.gmail.com>
Message-ID: <D6D52ED8-766B-40B3-9B6A-4809BA5B0790@twistedmatrix.com>


On Mar 23, 2010, at 9:15 AM, Alexandre Quessy wrote:

> Hello,
> I am in a hurry, but here are a few projects I am working on. They all
> use Twisted. They are all intended to be used in audio-video artworks
> and tools.
> 
> * Toonloop : (toonloop.com) Software suite for performing with live
> frame by frame animation creation
> * Lunch : (http://svn.sat.qc.ca/trac/lunch) Simple process launcher
> for complex distributed setup
> * Scenic : (http://svn.sat.qc.ca/trac/scenic) Telepresence software
> for wide bandwidth networks and oriented toward live performances
> * Purity : (http://wiki.dataflow.ws/Purity) Python library for Pure
> Data dynamic patching to create audio patches.

Thanks!  I've added these to ProjectsUsingTwisted.

If you are in less of a hurry later on and would like to talk about how great Twisted is in the context of one of your projects, it would be great to put a longer blurb on SuccessStories too :).

-glyph



From sara.byh at gmail.com  Wed Mar 24 21:53:17 2010
From: sara.byh at gmail.com (sara bai)
Date: Thu, 25 Mar 2010 09:53:17 +0800
Subject: [Twisted-Python] Twisted-Python Digest, Vol 72, Issue 35
In-Reply-To: <mailman.3.1269446401.3832.twisted-python@twistedmatrix.com>
References: <mailman.3.1269446401.3832.twisted-python@twistedmatrix.com>
Message-ID: <1a16f0711003241853i65d61033h4d6a4a00bfa38612@mail.gmail.com>

hi all, i run into this problem   ?


?The debugged program raised the exception unhandled Error
"[('PEM routines', 'PEM_read_bio', 'no start line'), ('SSL routines',
'SSL_CTX_use_PrivateKey_file', 'PEM lib')]"
File:
/usr/lib/python2.5/site-packages/Twisted-10.0.0-py2.5-linux-i686.egg/twisted/internet/ssl.py,
Line: 99"


 (
usr/lib/python25/site-packages/Twisted-10.0.0-py2.5-linux-i686.egg/twisted/internet/ssl.py
line 99 )

    def cacheContext(self):
        if self._context is None:
            ctx = self._contextFactory(self.sslmethod)
            # Disallow SSLv2!  It's insecure!  SSLv3 has been around since
            # 1996.  It's time to move on.
            ctx.set_options(SSL.OP_NO_SSLv2)
            ctx.use_certificate_file(self.certificateFileName)
            ctx.use_privatekey_file(self.privateKeyFileName)    # Line: 99
            self._context = ctx

here is the way i create privkey file :
   $ openssl genrsa > privkey.pem

then
   $ openssl req -new -x509 -key privkey.pem -out cacert.pem -days 1000

i have checked the cacert.pem file it do has 'strt line ' ??BEGIN
CERTIFICATE????


 part of my code  :


class syslogOptions(usage.Options):
    optParameters = [['cert', 'c', '/home/ssltest/cacert.pem','SSL Server
certificate'],
                            ['ip',   'i', None, 'IP Address to listen on']]
    def postOptions(self):
        if (not self.opts['cert']) or (not
os.path.isfile(self.opts['cert'])):
            raise usage.UsageError, "%s: is not a file" % self.opts['cert']
. . .
syslogSSL = syslogFactory()
    syslogSSL.protocol = outputTCP
    ctx = ssl.DefaultOpenSSLContextFactory(config.opts['cert'],
config.opts['cert'])
 .. .. .
 reactor.listenSSL(708, syslogSSL , ctx, interface=config.opts['ip'])
    reactor.run()

any ideas ? ...







2010/3/25 <twisted-python-request at twistedmatrix.com>

> Send Twisted-Python mailing list submissions to
>        twisted-python at twistedmatrix.com
>
> To subscribe or unsubscribe via the World Wide Web, visit
>        http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> or, via email, send a message with subject or body 'help' to
>        twisted-python-request at twistedmatrix.com
>
> You can reach the person managing the list at
>        twisted-python-owner at twistedmatrix.com
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Twisted-Python digest..."
>
>
> Today's Topics:
>
>   1. Re: Nothing Succeeds Like Success (Stories) (David)
>   2. Logout from a perspective broker server (Ramiro Alba Queipo)
>   3. Re: stdio.StandardIO blocks? (Glyph Lefkowitz)
>   4. Re: Logout from a perspective broker server (Glyph Lefkowitz)
>   5. Re: Logout from a perspective broker server (Ramiro Alba Queipo)
>   6. NetstringReceiver (Albert Brandl)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Tue, 23 Mar 2010 10:48:41 -0600
> From: David <dvkeeney at gmail.com>
> Subject: Re: [Twisted-Python] Nothing Succeeds Like Success (Stories)
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID:
>        <6e04113a1003230948j41fd0e5bn53ceda6970b36e43 at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> On Mon, Mar 22, 2010 at 8:39 PM, Glyph Lefkowitz
> <glyph at twistedmatrix.com> wrote:
>
> > If you're a happy Twisted user who has used Twisted to do something cool,
> *please* send in a blurb for the success stories page! ?This could translate
> into more money and more development for Twisted, thus making it even more
> awesome. ?This goes double if you're a sponsor: please let us know why you
> sponsored and how happy you were that you did :).
>
>
> Rdbhost
>
> Rdbhost uses Twisted for a streaming web-server.  The streaming server
> allows users to stream large SQL 'dump' files to and from the database
> host using a web browser.
>
> http://www.rdbhost.com
>
> --
> dkeeney at rdbhost.com
> Rdbhost -> SQL databases as a webservice [www.rdbhost.com]
>
>
>
> ------------------------------
>
> Message: 2
> Date: Tue, 23 Mar 2010 19:30:36 +0100
> From: Ramiro Alba Queipo <raq at cttc.upc.edu>
> Subject: [Twisted-Python] Logout from a perspective broker server
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID: <1269369036.6222.11.camel at mundo>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Hi all,
>
> I wonder, if I client using pygtk, can logout from the server without
> calling reactor.stop(), as you would kill the GUI. I tried to delete the
> perspective got from the server but it does not work...
>
> Thanks in advance
> Regards
>
> --
> Ramiro Alba
>
> Centre Tecnol?gic de Tranfer?ncia de Calor
> http://www.cttc.upc.edu
>
>
> Escola T?cnica Superior d'Enginyeries
> Industrial i Aeron?utica de Terrassa
> Colom 11, E-08222, Terrassa, Barcelona, Spain
> Tel: (+34) 93 739 86 46
>
>
> --
> Aquest missatge ha estat analitzat per MailScanner
> a la cerca de virus i d'altres continguts perillosos,
> i es considera que est? net.
>
>
>
>
> ------------------------------
>
> Message: 3
> Date: Wed, 24 Mar 2010 05:22:39 -0400
> From: Glyph Lefkowitz <glyph at twistedmatrix.com>
> Subject: Re: [Twisted-Python] stdio.StandardIO blocks?
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID: <6EB44FA1-3F26-433F-A2B3-3FE4AC3A5BD0 at twistedmatrix.com>
> Content-Type: text/plain; charset="us-ascii"
>
>
> On Mar 23, 2010, at 10:00 AM, Willy Lai wrote:
>
> > What I want, is writing stuff in the console, without interrupting the
> > ping mechanism.
> > (The pings and pongs in my case should continue to be sent while typing
> > stuff in the console)
>
> Without a *complete* program example, we can't really tell you what might
> be blocking. It may be a lot of things, from some very simple problems to
> some very complex ones.  Please see <http://sscce.org/> for details on
> what types of examples would be useful.
>
> Based on your simple description, this really should work.  If it didn't,
> 'twistd' wouldn't be able to log to stdout and run a server at the same time
> (and it definitely can, I do that every day, at least ten times).
>
> Thanks,
>
> -glyph
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://twistedmatrix.com/pipermail/twisted-python/attachments/20100324/65c72bbb/attachment.html
>
> ------------------------------
>
> Message: 4
> Date: Wed, 24 Mar 2010 05:27:13 -0400
> From: Glyph Lefkowitz <glyph at twistedmatrix.com>
> Subject: Re: [Twisted-Python] Logout from a perspective broker server
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID: <44DAEAB5-A177-4367-BBE0-98475F236004 at twistedmatrix.com>
> Content-Type: text/plain; charset="us-ascii"
>
>
> On Mar 23, 2010, at 2:30 PM, Ramiro Alba Queipo wrote:
>
> > I wonder, if I client using pygtk, can logout from the server without
> > calling reactor.stop(), as you would kill the GUI. I tried to delete the
> > perspective got from the server but it does not work...
>
> The simplest thing you can do to achieve this is
> 'broker.transport.loseConnection()'.
>
> Of course, that just unceremoniously drops the connection.  You may want to
> have a 'remote_disconnect' method on the server too, if you have any state
> you would like to cleanly finish up with first.
>
> Your GUI is already handling disconnection due to network problems though,
> right?  :-)  So the modification to make it handle this slightly-cleaner
> disconnect should be minor.  If it doesn't, see the notifyOnDisconnect API
> in PB: <
> http://twistedmatrix.com/documents/10.0.0/api/twisted.spread.pb.Broker.html#notifyOnDisconnect
> >.
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://twistedmatrix.com/pipermail/twisted-python/attachments/20100324/dac4c598/attachment-0001.htm
>
> ------------------------------
>
> Message: 5
> Date: Wed, 24 Mar 2010 13:28:45 +0100
> From: Ramiro Alba Queipo <raq at cttc.upc.edu>
> Subject: Re: [Twisted-Python] Logout from a perspective broker server
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID: <1269433725.6222.20.camel at mundo>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Glyph,
>
> > > I wonder, if I client using pygtk, can logout from the server
> > > without
> > > calling reactor.stop(), as you would kill the GUI. I tried to delete
> > > the
> > > perspective got from the server but it does not work...
> >
> > The simplest thing you can do to achieve this is
> > 'broker.transport.loseConnection()'.
> >
> >
> > Of course, that just unceremoniously drops the connection.  You may
> > want to have a 'remote_disconnect' method on the server too, if you
> > have any state you would like to cleanly finish up with first.
> >
> After having a look at pb.py code I used
>
> factory = pb.PBClientFactory()
> ....
>
> factory.disconnect()
>
> Then this makes the server call a 'logout' method for the current
> perspective, and makes a clean logout. Any comment?
>
>
> >
> > Your GUI is already handling disconnection due to network problems
> > though, right?  :-)  So the modification to make it handle this
> > slightly-cleaner disconnect should be minor.  If it doesn't, see the
> > notifyOnDisconnect API in PB:
> > <
> http://twistedmatrix.com/documents/10.0.0/api/twisted.spread.pb.Broker.html#notifyOnDisconnect
> >.
>
> Yeah. I was already using it. Very nice. I also wanted to enable a way
> to conecct and disconnect from the client, apart from the client be
> aware of a server restart on simply loosing connection. It works
> cleanly.
>
> Really grateful for your info and comments
>
> Regards
>
> >
> --
> Ramiro Alba
>
> Centre Tecnol?gic de Tranfer?ncia de Calor
> http://www.cttc.upc.edu
>
>
> Escola T?cnica Superior d'Enginyeries
> Industrial i Aeron?utica de Terrassa
> Colom 11, E-08222, Terrassa, Barcelona, Spain
> Tel: (+34) 93 739 86 46
>
>
> --
> Aquest missatge ha estat analitzat per MailScanner
> a la cerca de virus i d'altres continguts perillosos,
> i es considera que est? net.
>
>
>
>
> ------------------------------
>
> Message: 6
> Date: Wed, 24 Mar 2010 13:39:17 +0100
> From: Albert Brandl <albert.brandl at weiermayer.com>
> Subject: [Twisted-Python] NetstringReceiver
> To: twisted-python at twistedmatrix.com
> Message-ID: <20100324123917.GA24344 at weiermayer.com>
> Content-Type: text/plain; charset=iso-8859-1
>
> Hi!
>
> The NetstringReceiver class does not exactly do what I'd expect - see
> issue http://twistedmatrix.com/trac/ticket/4378. Since we plan to use
> netstrings, I am trying to fix it.
>
> I am not quite sure how to handle certain problems, though, and that's
> where I'd appreciate help. If this is the wrong place to ask this kind of
> questions, please redirect me ;-).
>
> 1.) In the current implementation, a NetstringParseError results in a
> call to self.transport.loseConnection(). Furthermore the variable
> brokenPeer is set to 1. But this variable is ignored. Would it be better
> to check it before receiving data? If yes: what is the correct way for a
> protocol to handle a broken transport? There is a ConnectionLost
> exception, but I'm not sure if / when a Protocol is allowed to raise it.
>
> 2.) The current implementation uses the method dataReceived to assemble
> the content of the netstring. When it is complete, the method
> stringReceived (which raises a NotImplementedError by default) is called.
> But netstrings can be long - would it be better to create a Deferred
> instance and call its callback instead? What would be the right place to
> create this Deferred?
>
> 3.) I started testing the NetstringReceiver by creating a class comment
> with doctests. When I later grepped the sources, I found some doctests,
> but there no mention of the doctest module in the test policy document.
> Would it be better to use the unittest framework for testing the code?
>
> Thanks and best regards,
>
> --
> Albert Brandl
> Weiermayer Solutions GmbH
> 4813 Altm?nster | Abteistra?e 12 | Austria
> Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081
>
>
>
> ------------------------------
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> End of Twisted-Python Digest, Vol 72, Issue 35
> **********************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100325/e22fbf1e/attachment-0001.htm 

From albert.brandl at weiermayer.com  Thu Mar 25 04:36:45 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Thu, 25 Mar 2010 09:36:45 +0100
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100324222203.GF17997@steerpike.home.puzzling.org>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
Message-ID: <20100325083644.GA4165@weiermayer.com>

On Thu, Mar 25, 2010 at 09:22:03AM +1100, Andrew Bennetts wrote:
> I'm rather confused about why you're even asking this question.  Exactly
> what API are you proposing as an alternative to the existing API (which
> is subclass NetstringReceiver and override stringReceived, and
> stringReceived will be called for every netstring that is received, as
> soon as it is received)?

Never mind - I didn't understand the concept of deferreds ;-). When
I read the code for FileSender, I thought it might be cool to have
something similar for the NetstringReceiver. But in the case of 
FileSender, the delivery of a file is explicitly triggered by the 
client. 

My vague idea was to create a method beginNetstringReception that 
returns a Deferred. But since Deferred instances are not reusable,
I'd have to call this method each time I wanted to receive a netstring, 
and this is obviously nonsense.

Regards,

--
DI Albert Brandl

Weiermayer Solutions GmbH

4813 Altm?nster | Abteistra?e 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081


From exarkun at twistedmatrix.com  Thu Mar 25 04:47:19 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 25 Mar 2010 08:47:19 -0000
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100325083644.GA4165@weiermayer.com>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100325083644.GA4165@weiermayer.com>
Message-ID: <20100325084719.2792.1067689479.divmod.xquotient.1807@localhost.localdomain>

On 08:36 am, albert.brandl at weiermayer.com wrote:
>On Thu, Mar 25, 2010 at 09:22:03AM +1100, Andrew Bennetts wrote:
>>I'm rather confused about why you're even asking this question. 
>>Exactly
>>what API are you proposing as an alternative to the existing API 
>>(which
>>is subclass NetstringReceiver and override stringReceived, and
>>stringReceived will be called for every netstring that is received, as
>>soon as it is received)?
>
>Never mind - I didn't understand the concept of deferreds ;-). When
>I read the code for FileSender, I thought it might be cool to have
>something similar for the NetstringReceiver. But in the case of
>FileSender, the delivery of a file is explicitly triggered by the
>client.
>
>My vague idea was to create a method beginNetstringReception that
>returns a Deferred. But since Deferred instances are not reusable,
>I'd have to call this method each time I wanted to receive a netstring,
>and this is obviously nonsense.

You might want a producer/consumer-based API.
Jean-Paul


From mgwilliams at gmail.com  Fri Mar 26 01:16:50 2010
From: mgwilliams at gmail.com (Matthew Williams)
Date: Fri, 26 Mar 2010 00:16:50 -0500
Subject: [Twisted-Python] SQLAlchemy, Twisted, and sAsync
Message-ID: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>

I have recently started a project using Twisted with a MySQL backend.  
 From previous posts to this and other lists, it seems that ORMs and  
threads don't get along too well... and, as far as I can tell, there's  
no way to get away from threads if you don't want longish queries to  
block your entire application.

At this point, I am using SQLAlchemy's SQL builder functionality (but  
not ORM layer) and using sAsync to manage the threading. Does anyone  
have experience with this technique and, if so, with what results?

It took me quite some time to piece together everything I could find  
related to sAsync (which seems to be a dead but functional project),  
so I threw up a quick Trac page for it at http://sasync.org.

Thanks in advance for any feedback!

Matthew


From chris at simplistix.co.uk  Fri Mar 26 04:20:36 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 26 Mar 2010 08:20:36 +0000
Subject: [Twisted-Python] SQLAlchemy, Twisted, and sAsync
In-Reply-To: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
Message-ID: <4BAC6E54.9010909@simplistix.co.uk>

Matthew Williams wrote:
>  From previous posts to this and other lists, it seems that ORMs and  
> threads don't get along too well...

What makes you think that?

> and, as far as I can tell, there's  
> no way to get away from threads if you don't want longish queries to  
> block your entire application.

Right, SQLAlchemy doesn't play nicely with *non-threaded* environments, 
from my understanding, which may well be wrong ;-)

> It took me quite some time to piece together everything I could find  
> related to sAsync (which seems to be a dead but functional project),  
> so I threw up a quick Trac page for it at http://sasync.org.

Cool. What is it you're doing that needs to mix Twisted and SQLAlchemy?

cheers,

Chris

PS: I've CC'ed the SQLAlchemy list in as well as I think people there 
may want to add to this discussion...

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
            - http://www.simplistix.co.uk


From albert.brandl at weiermayer.com  Fri Mar 26 06:25:48 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Fri, 26 Mar 2010 11:25:48 +0100
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100324222203.GF17997@steerpike.home.puzzling.org>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
Message-ID: <20100326102548.GA8660@weiermayer.com>

On Thu, Mar 25, 2010 at 09:22:03AM +1100, Andrew Bennetts wrote:
> 
> No; I think once loseConnection has been called dataReceived won't be
> called again, so there's no point checking for brokenPeer in
> dataReceived.

There is a unittest that assumes that dataReceives still works after
sending in garbage:

   def test_illegal(self):
        """
        Assert that illegal strings cause the transport to be closed.
        """
        for s in self.illegalStrings:
            r = self.getProtocol()
            for c in s:
                r.dataReceived(c)
            self.assertTrue(r.transport.disconnecting)

self.illegalStrings is defined as

    illegalStrings = [
        '9999999999999999999999', 'abc', '4:abcde',
        '51:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaab,',]

In this implementation, the dataReceived method has to be functional
even after the NetstringReceiver has detected that the received
data are garbage. And there is no direct information that the
received string was no valid netstring - you have to check for
r.transport.disconnecting.

That's why I thought it might be a good idea to raise an appropriate 
exception if the receiver is no longer functional. I use a generator- 
based approach to parsing the netstring (for details see 
http://twistedmatrix.com/trac/attachment/ticket/4378/ticket_4378.patch), 
and the generator raises a StopIteration exception.

But I'd prefer to raise an exception that explains what happened at a 
higher level - that's why I asked if there was some predefined exception 
that would match this kind of problem.

> There are some existing tests for NetstringReceiver in
> twisted/test/test_protocols.py.

Thanks, this was very helpful.

Regards,
-- 
DI Albert Brandl

Weiermayer Solutions GmbH

4813 Altm?nster | Abteistra?e 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081


From exarkun at twistedmatrix.com  Fri Mar 26 08:08:02 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 26 Mar 2010 12:08:02 -0000
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100326102548.GA8660@weiermayer.com>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100326102548.GA8660@weiermayer.com>
Message-ID: <20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>

On 10:25 am, albert.brandl at weiermayer.com wrote:
>On Thu, Mar 25, 2010 at 09:22:03AM +1100, Andrew Bennetts wrote:
>>
>>No; I think once loseConnection has been called dataReceived won't be
>>called again, so there's no point checking for brokenPeer in
>>dataReceived.
>
>There is a unittest that assumes that dataReceives still works after
>sending in garbage:
>
>   def test_illegal(self):
>        """
>        Assert that illegal strings cause the transport to be closed.
>        """
>        for s in self.illegalStrings:
>            r = self.getProtocol()
>            for c in s:
>                r.dataReceived(c)
>            self.assertTrue(r.transport.disconnecting)
>
>self.illegalStrings is defined as
>
>    illegalStrings = [
>        '9999999999999999999999', 'abc', '4:abcde',
>        '51:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaab,',]
>
>In this implementation, the dataReceived method has to be functional
>even after the NetstringReceiver has detected that the received
>data are garbage.

I'm not sure about this.  Each iteration around this loop creates a new 
instance of NetstringReceiver; after the illegal string is delivered, 
the instance isn't used again.

So, are you sure this is testing what you think it's testing?

Jean-Paul


From mgwilliams at gmail.com  Fri Mar 26 08:09:49 2010
From: mgwilliams at gmail.com (Matthew Williams)
Date: Fri, 26 Mar 2010 07:09:49 -0500
Subject: [Twisted-Python] SQLAlchemy, Twisted, and sAsync
In-Reply-To: <4BAC6E54.9010909@simplistix.co.uk>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
	<4BAC6E54.9010909@simplistix.co.uk>
Message-ID: <52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>


On Mar 26, 2010, at 3:20 AM, Chris Withers wrote:

> Matthew Williams wrote:
>> From previous posts to this and other lists, it seems that ORMs  
>> and  threads don't get along too well...
>
> What makes you think that?

First of all, most of my impressions about ORMs come from SQLAlchemy.   
This quote from this list (http://twistedmatrix.com/pipermail/twisted-python/2009-March/019359.html 
) sums up what I have found as well:

"It's much trickier if you want to use the ORM, unless you are very
careful to fully eager load every thing in any possible database
operation if you have need of the information subsequently in your
twisted code. Otherwise you may block unexpectedly simply when
accessing your objects, and end up with database operations from the
main twisted thread."

So perhaps I should have said "SQL Alchemy's ORM and threads don't get  
along too well"... that's not to say it's impossible, you just have to  
be exceedingly careful how you use it.

>> and, as far as I can tell, there's  no way to get away from threads  
>> if you don't want longish queries to  block your entire application.
>
> Right, SQLAlchemy doesn't play nicely with *non-threaded*  
> environments, from my understanding, which may well be wrong ;-)
>
>> It took me quite some time to piece together everything I could  
>> find  related to sAsync (which seems to be a dead but functional  
>> project),  so I threw up a quick Trac page for it at http://sasync.org 
>> .
>
> Cool. What is it you're doing that needs to mix Twisted and  
> SQLAlchemy?

The project (an internal project) doesn't really *need* to mix them...  
I could just use mysqldb.

Matthew


From chris at simplistix.co.uk  Fri Mar 26 08:16:29 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 26 Mar 2010 12:16:29 +0000
Subject: [Twisted-Python] [sqlalchemy] Re: SQLAlchemy, Twisted,
	and sAsync
In-Reply-To: <52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
	<4BAC6E54.9010909@simplistix.co.uk>
	<52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>
Message-ID: <4BACA59D.7050501@simplistix.co.uk>

Matthew Williams wrote:
> 
> "It's much trickier if you want to use the ORM, unless you are very
> careful to fully eager load every thing in any possible database
> operation if you have need of the information subsequently in your
> twisted code. Otherwise you may block unexpectedly simply when
> accessing your objects, and end up with database operations from the
> main twisted thread."
> 
> So perhaps I should have said "SQL Alchemy's ORM and threads don't get 
> along too well"... that's not to say it's impossible, you just have to 
> be exceedingly careful how you use it.

I think you have the wrong end of the stick.
SQLAlchemy and threads play fine, SQLAlchemy and Twisted's asynchronous 
model, which refuses to use threads on principle, do not, for the 
reasons you describe.

>>> It took me quite some time to piece together everything I could find  
>>> related to sAsync (which seems to be a dead but functional project),  
>>> so I threw up a quick Trac page for it at http://sasync.org.
>>
>> Cool. What is it you're doing that needs to mix Twisted and SQLAlchemy?
> 
> The project (an internal project) doesn't really *need* to mix them... I 
> could just use mysqldb.

Heh, wrong end of the stick again; my question was why you needed to use 
Twisted ;-)

cheers,

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk


From mgwilliams at gmail.com  Fri Mar 26 09:12:01 2010
From: mgwilliams at gmail.com (Matthew Williams)
Date: Fri, 26 Mar 2010 08:12:01 -0500
Subject: [Twisted-Python] [sqlalchemy] Re: SQLAlchemy, Twisted,
	and sAsync
In-Reply-To: <8D20BBB55F590E42AADF592A815E861704D36D02@zuk35exm65.ds.mot.com>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
	<4BAC6E54.9010909@simplistix.co.uk>
	<52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>
	<8D20BBB55F590E42AADF592A815E861704D36D02@zuk35exm65.ds.mot.com>
Message-ID: <33306522-88A7-4E04-BB87-9F8839369665@gmail.com>

Thank you, Simon, for clarifying this and pointing out that part of  
the SQLAlchemy docs... somehow I missed that part :-).

On Mar 26, 2010, at 7:30 AM, King Simon-NFHD78 wrote:

> I think that point should be clarified, so that people don't later  
> come
> across this post and just accept it without understanding.
>
> I imagine that SQLALchemy is used in a lot of threaded applications.  
> For
> example, it is the recommended ORM in web frameworks such as Pylons  
> and
> TurboGears, which work fine in threaded environments. However,  
> typically
> in these libraries a web request is handled by a single thread, and  
> all
> the SQLAlchemy operations occur within the scope of that request. As
> long as you don't share a Session instance between the threads, you
> won't have any problems. SQLAlchemy provides a ScopedSession class  
> which
> helps in these situations, as you can call the constructor many  
> times on
> a single thread and always get the session instance back for that
> thread. Sessions themselves aren't thread-safe.
>
> When an instance is loaded from the database, it is linked to the
> session that loaded it. This means that when you have lazy-loading
> properties on that instance (such as related classes, or deferred  
> column
> properties), they will be automatically loaded when they are accessed,
> in the same session.
>
> This will cause a problem if you load an instance in thread A, hand  
> the
> object off to thread B, and then thread B accesses one of these
> lazy-loading properties. The load will occur in thread A's session,
> which might be in the middle of doing something else.
>
> The solution to this is either to eager-load all the attributes you
> think you are going to need before handing the instance off to another
> thread (difficult), or (probably better) to detach (expunge) the
> instance from thread A's session. Thread B should then merge the  
> object
> into its own session (using the load=False flag so that it doesn't
> needlessly requery the database).
>
> The Session docs at http://www.sqlalchemy.org/docs/session.html  
> explain
> the lifecycle of loaded instances.
>
> I haven't actually done any of this - I've only ever used SA from TG  
> and
> command-line scripts, but I think the principles are about right. I  
> hope
> that helps,
>
> Simon


From chris at simplistix.co.uk  Fri Mar 26 10:32:04 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 26 Mar 2010 14:32:04 +0000
Subject: [Twisted-Python] [sqlalchemy] Re: SQLAlchemy, Twisted,
	and sAsync
In-Reply-To: <8D20BBB55F590E42AADF592A815E861704D36D02@zuk35exm65.ds.mot.com>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
	<4BAC6E54.9010909@simplistix.co.uk>
	<52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>
	<8D20BBB55F590E42AADF592A815E861704D36D02@zuk35exm65.ds.mot.com>
Message-ID: <4BACC564.2030109@simplistix.co.uk>

King Simon-NFHD78 wrote:
> The solution to this is either to eager-load all the attributes you
> think you are going to need before handing the instance off to another
> thread (difficult), or (probably better) to detach (expunge) the
> instance from thread A's session.

Are there any recommended code examples around for doing this?

Once detatched, are these objects (I'm guessing for most people they'll 
be instances of declaratively mapped models) pickleable?

> Thread B should then merge the object
> into its own session (using the load=False flag so that it doesn't
> needlessly requery the database).

Good code examples of this around too?

cheers

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk


From vlad.shevchenko at gmail.com  Sat Mar 27 17:45:42 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Sat, 27 Mar 2010 23:45:42 +0200
Subject: [Twisted-Python] How to use AmpList?
Message-ID: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>

Hi,
can't find any reference of how to use AmpList. What should be passed to
callRemote? In command: arguments = Amp.List(...) or arguments = [('param',
AmpList(...))]? Responder params?

Please, advice some refs or examples.

-- 
WBR, Vlad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100327/1a841a00/attachment.htm 

From exarkun at twistedmatrix.com  Sun Mar 28 00:05:24 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 28 Mar 2010 04:05:24 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1269749124.12.445728512@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100328/bf7043cf/attachment.htm 

From andrew at bemusement.org  Sun Mar 28 05:24:20 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Sun, 28 Mar 2010 20:24:20 +1100
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100326102548.GA8660@weiermayer.com>
	<20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
Message-ID: <20100328092420.GD7715@steerpike.home.puzzling.org>

exarkun at twistedmatrix.com wrote:
> On 10:25 am, albert.brandl at weiermayer.com wrote:
[...]
> >There is a unittest that assumes that dataReceives still works after
> >sending in garbage:
> >
> >   def test_illegal(self):
> >        """
> >        Assert that illegal strings cause the transport to be closed.
> >        """
> >        for s in self.illegalStrings:
> >            r = self.getProtocol()
> >            for c in s:
> >                r.dataReceived(c)
> >            self.assertTrue(r.transport.disconnecting)
> >
> >self.illegalStrings is defined as
> >
> >    illegalStrings = [
> >        '9999999999999999999999', 'abc', '4:abcde',
> >        '51:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaab,',]
> >
> >In this implementation, the dataReceived method has to be functional
> >even after the NetstringReceiver has detected that the received
> >data are garbage.
> 
> I'm not sure about this.  Each iteration around this loop creates a new 
> instance of NetstringReceiver; after the illegal string is delivered, 
> the instance isn't used again.

That's true ? but each illegal string is delivered one byte at a time.  So the
'abc' string will trigger a NetstringParseError on the first dataReceived('a'),
but then the test expects the subsequent dataReceived('b') and dataReceived('c')
to execute without raising.

-Andrew.



From vlad.shevchenko at gmail.com  Mon Mar 29 07:54:08 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Mon, 29 Mar 2010 14:54:08 +0300
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
Message-ID: <572f045e1003290454x73077a92i1b76351cca297362@mail.gmail.com>

No one use AmpList?

On Sat, Mar 27, 2010 at 11:45 PM, Vlad Shevchenko <vlad.shevchenko at gmail.com
> wrote:

> Hi,
> can't find any reference of how to use AmpList. What should be passed to
> callRemote? In command: arguments = Amp.List(...) or arguments = [('param',
> AmpList(...))]? Responder params?
>
> Please, advice some refs or examples.
>
> --
> WBR, Vlad
>
>


-- 
WBR, Vlad Shevchenko
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100329/5e10672c/attachment.htm 

From albert.brandl at weiermayer.com  Mon Mar 29 07:11:00 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Mon, 29 Mar 2010 13:11:00 +0200
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100326102548.GA8660@weiermayer.com>
	<20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
Message-ID: <20100329111100.GA4063@weiermayer.com>

On Fri, Mar 26, 2010 at 12:08:02PM -0000, exarkun at twistedmatrix.com wrote:
> 
> So, are you sure this is testing what you think it's testing?

Yes. This test was already there, and it failed in unexpected ways, so I 
had to look at it quite closely. I'm not too happy about it, since it 
tests several things at once (illegal strings, bytewise delivery), but I 
decided to leave it there for now, just to make sure that I don't miss
some test case with the new unit tests.

As Andrew pointed out, this unittest assumes that dataReceived is still
(somewhat) functional after the detection of an invalid netstring. This
does not make much sense IMO, and it complicates the code. I'd prefer
to raise an exception and adapt the unittest accordingly. 

But I still don't know which exception would be best. There is a 
ConnectionLost exception, which is raised in 
twisted.protocols.amp.BinaryBoxProtocol when the transport is None. 
Other options are ConnectionClosed and ConnectionDone (both are not
raised directly anywhere), or a new one. Maybe ConnectionLost is the
most appropriate one.

Best regards,

Albert

-- 
DI Albert Brandl
Weiermayer Solutions GmbH | http://www.weiermayer.com
4813 Altm?nster | Abteistra?e 12 | Austria 
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081


From peter.westlake at pobox.com  Mon Mar 29 09:51:33 2010
From: peter.westlake at pobox.com (Peter Westlake)
Date: Mon, 29 Mar 2010 14:51:33 +0100
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <572f045e1003290454x73077a92i1b76351cca297362@mail.gmail.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
	<572f045e1003290454x73077a92i1b76351cca297362@mail.gmail.com>
Message-ID: <1269870693.17631.1367260645@webmail.messagingengine.com>



On Mon, 29 Mar 2010 14:54 +0300, "Vlad Shevchenko"
<vlad.shevchenko at gmail.com> wrote:
> No one use AmpList?
> 
> On Sat, Mar 27, 2010 at 11:45 PM, Vlad Shevchenko
> <vlad.shevchenko at gmail.com
> > wrote:
> 
> > Hi,
> > can't find any reference of how to use AmpList. What should be passed to
> > callRemote? In command: arguments = Amp.List(...) or arguments = [('param',
> > AmpList(...))]? Responder params?
> >
> > Please, advice some refs or examples.

Here's an example. I've missed out the other arguments for clarity. The
data being passed is a Unix-style environment string. It needs to be
reformatted to make it suitable for passing in an AmpList, but that's
just an implementation detail. It's because the AmpList requires the
dictionary keys to be declared in advance, but I want to be able to pass
environment variables whose names are only known at run-time. Your code
might not need to do any of that.

First, the command:

  class RunCmd(amp.Command):
      arguments = [...,
                   ('env',  amp.AmpList([('var', amp.String()), ('val',
                   amp.String())])),
                   ...]


Then the call:

          # env is something like {'PATH': '/bin:/usr/bin', 'HOME':
          '/home/peter'}
          # It needs to be converted into a form suitable for AmpList,
          like this:
          # [{'var': 'PATH', 'val': '/bin:/usr/bin'}, {'var': 'HOME',
          'val': '/home/peter'}]
          #
          amp_env  = [{'var': var, 'val': val} for (var, val) in
          env.items()]
          d = self.protocol.callRemote(commands.RunCmd, ...,
          env=amp_env, ...)


Then the responder:

    def runcmd(..., env, ..):
        """Implementation of the AMP command RunCmd.
        ...
        """

        # The "env" argument represents the environment of a process.
        # Convert it from the AmpList format back to a Python
        dictionary.
        #
        envd = {}
        for var in env:
            envd[var['var']] = var['val']
        ...
        return {...}
    
    commands.RunCmd.responder(runcmd)


Peter.


From dripton at ripton.net  Mon Mar 29 09:52:54 2010
From: dripton at ripton.net (David Ripton)
Date: Mon, 29 Mar 2010 06:52:54 -0700
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
Message-ID: <20100329135254.GA21870@vidar.dreamhost.com>

On 2010.03.27 23:45:42 +0200, Vlad Shevchenko wrote:
> Hi,
> can't find any reference of how to use AmpList. What should be passed to
> callRemote? In command: arguments = Amp.List(...) or arguments = [('param',
> AmpList(...))]? Responder params?
> 
> Please, advice some refs or examples.

There are a few small examples in twisted/test/test_amp.py

test_ampListCommand might be a good starting point.

-- 
David Ripton    dripton at ripton.net


From joson.prog at gmail.com  Mon Mar 29 11:04:25 2010
From: joson.prog at gmail.com (Joson Mandaro)
Date: Mon, 29 Mar 2010 23:04:25 +0800
Subject: [Twisted-Python] [twisted-python] a problem about reactor
Message-ID: <6dcfd2ac1003290804w6eaeb1b1te5e1904b1b831cdd@mail.gmail.com>

Hi all,

I'm puzzled by this code:

# -*- coding: utf-8 -*-
from twisted.web.client import reactor

f = open("test1.txt","w")
f.write("html")
reactor.run()

Then it won't write anything into test1.txt. When I deleted "reactor.run()",
it will write contents. It is interesting but I don't know why the reactor
blocks file writing.

Best regards,

Joson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100329/eff238e1/attachment.htm 

From exarkun at twistedmatrix.com  Mon Mar 29 11:04:33 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Mon, 29 Mar 2010 15:04:33 -0000
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100329111100.GA4063@weiermayer.com>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100326102548.GA8660@weiermayer.com>
	<20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
	<20100329111100.GA4063@weiermayer.com>
Message-ID: <20100329150433.2792.1487122440.divmod.xquotient.1864@localhost.localdomain>

On 11:11 am, albert.brandl at weiermayer.com wrote:
>On Fri, Mar 26, 2010 at 12:08:02PM -0000, exarkun at twistedmatrix.com 
>wrote:
>>
>>So, are you sure this is testing what you think it's testing?
>
>Yes. This test was already there, and it failed in unexpected ways, so 
>I
>had to look at it quite closely. I'm not too happy about it, since it
>tests several things at once (illegal strings, bytewise delivery), but 
>I
>decided to leave it there for now, just to make sure that I don't miss
>some test case with the new unit tests.
>
>As Andrew pointed out, this unittest assumes that dataReceived is still
>(somewhat) functional after the detection of an invalid netstring. This
>does not make much sense IMO, and it complicates the code. I'd prefer
>to raise an exception and adapt the unittest accordingly.

I see.  A good first step (separate from fixing any of the 
implementation of NetstringReceiver) might be to clean up the tests, 
then, so that each only exercises one case, and so that only the desired 
behavior is tested (for example, tests for the behavior you're talking 
about, of receiving invalid bytes after the connection has been closed, 
could be removed).
>But I still don't know which exception would be best. There is a
>ConnectionLost exception, which is raised in
>twisted.protocols.amp.BinaryBoxProtocol when the transport is None.
>Other options are ConnectionClosed and ConnectionDone (both are not
>raised directly anywhere), or a new one. Maybe ConnectionLost is the
>most appropriate one.

Feel free to introduce new exception types.  Unfortunately I don't 
remember what change you're actually proposing to make to 
NetstringReceiver anymore, so I won't try to suggest any names.

Jean-Paul


From albert.brandl at weiermayer.com  Mon Mar 29 10:22:02 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Mon, 29 Mar 2010 16:22:02 +0200
Subject: [Twisted-Python] [twisted-python] a problem about reactor
In-Reply-To: <6dcfd2ac1003290804w6eaeb1b1te5e1904b1b831cdd@mail.gmail.com>
References: <6dcfd2ac1003290804w6eaeb1b1te5e1904b1b831cdd@mail.gmail.com>
Message-ID: <20100329142202.GB4063@weiermayer.com>

Hi!

On Mon, Mar 29, 2010 at 11:04:25PM +0800, Joson Mandaro wrote:
>    Then it won't write anything into test1.txt. When I deleted
>    "reactor.run()", it will write contents. It is interesting but I don't
>    know why the reactor blocks file writing.

Try the same code in the interpreter and check the content of the
file:

>>> f=open("test.txt", "w") # creates an empty file
>>> f.write("html")         # file is still empty
>>> f.close()               # content is written to the file

Python is nice enough to close the file when it reaches the end of the
script. But this never happens when the last statement is 
reactor.run().

Regards, 

Albert

--
DI Albert Brandl
Weiermayer Solutions GmbH | http://www.weiermayer.com
4813 Altm?nster | Abteistra?e 12 | Austria 
| Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081


From bs1984 at gmail.com  Mon Mar 29 11:32:49 2010
From: bs1984 at gmail.com (Bo Shi)
Date: Mon, 29 Mar 2010 11:32:49 -0400
Subject: [Twisted-Python] [twisted-python] a problem about reactor
Message-ID: <-7380736282751865086@unknownmsgid>

Joson, this doesn't have anything to do with the reactor (aside from
perhaps it forcing you to ctrl-c to stop the program).  You never 1.
close() the file or 2. flush() the contents of the file to disk.

Sent from my mobile phone.
Please excuse any typos.

On Mar 29, 2010, at 11:04, Joson Mandaro <joson.prog at gmail.com> wrote:

> Hi all,
>
> I'm puzzled by this code:
>
> # -*- coding: utf-8 -*-
> from twisted.web.client import reactor
>
> f = open("test1.txt","w")
> f.write("html")
> reactor.run()
>
> Then it won't write anything into test1.txt. When I deleted
> "reactor.run()", it will write contents. It is interesting but I
> don't know why the reactor blocks file writing.
>
> Best regards,
>
> Joson
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From albert.brandl at weiermayer.com  Mon Mar 29 10:52:40 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Mon, 29 Mar 2010 16:52:40 +0200
Subject: [Twisted-Python] Supported Python versions for Twisted 10.0
Message-ID: <20100329145240.GA10947@weiermayer.com>

Hi!

By chance, I recently found the following comment by Glyph on Stack Overflow (dated Oct 
18 '08):

> Right now, Twisted supports python 2.3 to 2.5. Currently, we're working on 2.6 support 
> (which we'll obviously have to finish before 3.0!).

What are the supported Python versions for the Twisted 10 development? I think it might 
be a good idea to document these prerequisites in the developer section of the Wiki (or 
make them more prominent, if they are already there)?

I know, I should have made sure _before_ submitting a patch that _sends_ data to a 
generator... ;-).

Regards,

Albert
-- 
DI Albert Brandl
Weiermayer Solutions GmbH | http://www.weiermayer.com
4813 Altm?nster | Abteistra?e 12 | Austria |
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081


From jml at mumak.net  Mon Mar 29 12:05:37 2010
From: jml at mumak.net (Jonathan Lange)
Date: Mon, 29 Mar 2010 17:05:37 +0100
Subject: [Twisted-Python] Supported Python versions for Twisted 10.0
In-Reply-To: <20100329145240.GA10947@weiermayer.com>
References: <20100329145240.GA10947@weiermayer.com>
Message-ID: <d06a5cd31003290905i1e16cbd3rd0cbf4ebe16a7039@mail.gmail.com>

On Mon, Mar 29, 2010 at 3:52 PM, Albert Brandl
<albert.brandl at weiermayer.com> wrote:
> Hi!
>
> By chance, I recently found the following comment by Glyph on Stack Overflow (dated Oct
> 18 '08):
>
>> Right now, Twisted supports python 2.3 to 2.5. Currently, we're working on 2.6 support
>> (which we'll obviously have to finish before 3.0!).
>
> What are the supported Python versions for the Twisted 10 development? I think it might
> be a good idea to document these prerequisites in the developer section of the Wiki (or
> make them more prominent, if they are already there)?
>
> I know, I should have made sure _before_ submitting a patch that _sends_ data to a
> generator... ;-).
>

Twisted 10.0.0 supports Python 2.4 to 2.6. It's in the README and the
INSTALL file.

jml


From vlad.shevchenko at gmail.com  Mon Mar 29 13:42:04 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Mon, 29 Mar 2010 20:42:04 +0300
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <1269870693.17631.1367260645@webmail.messagingengine.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
	<572f045e1003290454x73077a92i1b76351cca297362@mail.gmail.com>
	<1269870693.17631.1367260645@webmail.messagingengine.com>
Message-ID: <572f045e1003291042p7bc6d650k653d8c82795fb68b@mail.gmail.com>

Thank you, it helps a lot. I've made a mistake in calling callRemote.

On Mon, Mar 29, 2010 at 4:51 PM, Peter Westlake <peter.westlake at pobox.com>wrote:

>
>
> On Mon, 29 Mar 2010 14:54 +0300, "Vlad Shevchenko"
> <vlad.shevchenko at gmail.com> wrote:
> > No one use AmpList?
> >
> > On Sat, Mar 27, 2010 at 11:45 PM, Vlad Shevchenko
> > <vlad.shevchenko at gmail.com
> > > wrote:
> >
> > > Hi,
> > > can't find any reference of how to use AmpList. What should be passed
> to
> > > callRemote? In command: arguments = Amp.List(...) or arguments =
> [('param',
> > > AmpList(...))]? Responder params?
> > >
> > > Please, advice some refs or examples.
>
> Here's an example. I've missed out the other arguments for clarity. The
> data being passed is a Unix-style environment string. It needs to be
> reformatted to make it suitable for passing in an AmpList, but that's
> just an implementation detail. It's because the AmpList requires the
> dictionary keys to be declared in advance, but I want to be able to pass
> environment variables whose names are only known at run-time. Your code
> might not need to do any of that.
>
> First, the command:
>
>  class RunCmd(amp.Command):
>      arguments = [...,
>                   ('env',  amp.AmpList([('var', amp.String()), ('val',
>                   amp.String())])),
>                   ...]
>
>
> Then the call:
>
>          # env is something like {'PATH': '/bin:/usr/bin', 'HOME':
>          '/home/peter'}
>          # It needs to be converted into a form suitable for AmpList,
>          like this:
>          # [{'var': 'PATH', 'val': '/bin:/usr/bin'}, {'var': 'HOME',
>          'val': '/home/peter'}]
>          #
>          amp_env  = [{'var': var, 'val': val} for (var, val) in
>          env.items()]
>          d = self.protocol.callRemote(commands.RunCmd, ...,
>          env=amp_env, ...)
>
>
> Then the responder:
>
>    def runcmd(..., env, ..):
>        """Implementation of the AMP command RunCmd.
>        ...
>        """
>
>        # The "env" argument represents the environment of a process.
>        # Convert it from the AmpList format back to a Python
>        dictionary.
>        #
>        envd = {}
>        for var in env:
>            envd[var['var']] = var['val']
>        ...
>        return {...}
>
>    commands.RunCmd.responder(runcmd)
>
>
> Peter.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
WBR, Vlad Shevchenko
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100329/24ebb9ea/attachment.htm 

From vlad.shevchenko at gmail.com  Mon Mar 29 13:46:10 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Mon, 29 Mar 2010 20:46:10 +0300
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <20100329135254.GA21870@vidar.dreamhost.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
	<20100329135254.GA21870@vidar.dreamhost.com>
Message-ID: <572f045e1003291046r61cee69cwdbd32ea0af3b8efe@mail.gmail.com>

Thanks, nice point to dive in.

On Mon, Mar 29, 2010 at 4:52 PM, David Ripton <dripton at ripton.net> wrote:

> On 2010.03.27 23:45:42 +0200, Vlad Shevchenko wrote:
> > Hi,
> > can't find any reference of how to use AmpList. What should be passed to
> > callRemote? In command: arguments = Amp.List(...) or arguments =
> [('param',
> > AmpList(...))]? Responder params?
> >
> > Please, advice some refs or examples.
>
> There are a few small examples in twisted/test/test_amp.py
>
> test_ampListCommand might be a good starting point.
>
> --
> David Ripton    dripton at ripton.net
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
WBR, Vlad Shevchenko
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100329/6eb609b2/attachment.htm 

From joson.prog at gmail.com  Mon Mar 29 21:35:28 2010
From: joson.prog at gmail.com (Joson Mandaro)
Date: Tue, 30 Mar 2010 09:35:28 +0800
Subject: [Twisted-Python] [twisted-python] a problem about reactor
In-Reply-To: <-7380736282751865086@unknownmsgid>
References: <-7380736282751865086@unknownmsgid>
Message-ID: <6dcfd2ac1003291835s3ae76566nbc9ee8abd5c1105@mail.gmail.com>

Thank you. So it is the point that I've disregarded before.

2010/3/29 Bo Shi <bs1984 at gmail.com>

> Joson, this doesn't have anything to do with the reactor (aside from
> perhaps it forcing you to ctrl-c to stop the program).  You never 1.
> close() the file or 2. flush() the contents of the file to disk.
>
> Sent from my mobile phone.
> Please excuse any typos.
>
> On Mar 29, 2010, at 11:04, Joson Mandaro <joson.prog at gmail.com> wrote:
>
> > Hi all,
> >
> > I'm puzzled by this code:
> >
> > # -*- coding: utf-8 -*-
> > from twisted.web.client import reactor
> >
> > f = open("test1.txt","w")
> > f.write("html")
> > reactor.run()
> >
> > Then it won't write anything into test1.txt. When I deleted
> > "reactor.run()", it will write contents. It is interesting but I
> > don't know why the reactor blocks file writing.
> >
> > Best regards,
> >
> > Joson
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100330/c6d6568b/attachment.htm 

From chris at simplistix.co.uk  Tue Mar 30 03:46:29 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Tue, 30 Mar 2010 08:46:29 +0100
Subject: [Twisted-Python] twisted vs wsgi
Message-ID: <4BB1AC55.6090106@simplistix.co.uk>

Hi All,

I've managed to cobble this together as a way of starting a BFG app 
under Twisted's wsgi server:

"""
from twisted.web.wsgi import WSGIResource
from twisted.web.server import Site
from twisted.internet import reactor

from webob import Response
from repoze.bfg.configuration import Configurator

def hello_world(request):
     return Response('Hello world!')

if __name__ == '__main__':
     config = Configurator()
     config.begin()
     config.add_view(hello_world)
     config.end()

     resource = WSGIResource(reactor, reactor.getThreadPool(),
                             config.make_wsgi_app())
     factory = Site(resource, 'server.log')
     reactor.listenTCP(8080, factory)
     reactor.run()
"""

I struggled to find good narrative docs on using Twisted as a WSGI 
server. Where should I have been looking and have I dropped any clangers 
in the above?

cheers,

Chris



From itamar at itamarst.org  Tue Mar 30 08:11:15 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 30 Mar 2010 08:11:15 -0400
Subject: [Twisted-Python] twisted vs wsgi
In-Reply-To: <4BB1AC55.6090106@simplistix.co.uk>
References: <4BB1AC55.6090106@simplistix.co.uk>
Message-ID: <1269951075.987.100.camel@pintsize>

On Tue, 2010-03-30 at 08:46 +0100, Chris Withers wrote:
> I struggled to find good narrative docs on using Twisted as a WSGI 
> server. Where should I have been looking and have I dropped any clangers 
> in the above?

The "Web in 60 seconds" howto has this:
http://twistedmatrix.com/documents/current/web/howto/web-in-60/wsgi.html

Which, while incomplete in itself, makes sense if you read the whole
howto in order and so know what to do about Resources.


The "Using Twisted.Web" howto has this:
http://twistedmatrix.com/documents/current/web/howto/using-twistedweb.html#auto19




From albert.brandl at weiermayer.com  Tue Mar 30 12:14:18 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Tue, 30 Mar 2010 18:14:18 +0200
Subject: [Twisted-Python] [Twisted] #4378: Error handling in
	NetstringReceiver broken
In-Reply-To: <057.e6e75afbc77c07499193b1e6757489f1@twistedmatrix.com>
References: <048.8ba8c943d125356d1cae7b68d90508c4@twistedmatrix.com>
	<057.e6e75afbc77c07499193b1e6757489f1@twistedmatrix.com>
Message-ID: <20100330161418.GA9201@weiermayer.com>

On Tue, Mar 30, 2010 at 12:27:54PM -0000, Twisted wrote:
>  1. I'm pretty sure this patch, in its current form, will break in the
>  (still supported) Python 2.4, since it uses the 2.5 generator feature
>  where you pass in data.

Yep - I'll fix this.

>  2. Why not initialize the parser in the Protocol's __init__? Less code in
>  a frequently called path.

Good idea, since there's no need anymore to check in every call of dataReceived.

>  3. ``stringReceived`` in docstring violates coding standard, should be a
>  L{} or C{} or something, I forget which. So does received_string variable
>  name.

Oops - this looks like ReST markup :-(.

>  4. In dataReceived, when would we expect to get StopIteration to be
>  raised? Quick read of the generator doesn't show anywhere it actually
>  returns, it seems to be in infinite loop.

When the generator is left by raising an exception, it will raise a StopIteration
the next time someone sends data. But this is irrelevant now, since Python 2.4
does not support sending data to a generator.

>  5. Using long() is unnecessary, you can just use int().

Ok.

>  6. Hooray for more and better tests! I am uncomfortable about use of
>  transport.disconnecting, but we've already gone down the path of using it
>  elsewhere, and not sure what else you could do, so it's probably fine.

I might introduce a new exception (see discussion on the mailing list) - this
would allow to get rid of the check for transport.disconnecting.

>  7. In test_receiveTwoNetstrings(self), perhaps the second string should be
>  different than the first, e.g. "a" and "woo", to catch theoretical bugs
>  where parser repeatedly spits out first thing it parsed.

Good idea.

Thanks & best regards,

Albert
-- 
DI Albert Brandl
Weiermayer Solutions GmbH | http://www.weiermayer.com
4813 Altm?nster | Abteistra?e 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081


From rgacote at appropriatesolutions.com  Tue Mar 30 15:22:47 2010
From: rgacote at appropriatesolutions.com (Ray Cote)
Date: Tue, 30 Mar 2010 15:22:47 -0400 (EDT)
Subject: [Twisted-Python] Anyone working on a Twisted txRiak?
Message-ID: <10496611.511269977368521.JavaMail.rgacote@ip-210.Corp.AppropriateSolutions.com>

Curious to know if anyone is working on an interface between Twisted and Riak.
  <http://basho.com/Riak.html>

Before we started one, thought I'd reach out first to ensure we're not duplicating efforts.
--Ray




From elihusmails at gmail.com  Tue Mar 30 16:47:02 2010
From: elihusmails at gmail.com (Mark)
Date: Tue, 30 Mar 2010 16:47:02 -0400
Subject: [Twisted-Python] session management
Message-ID: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>

Greetings,

I am new to this list and twisted.  I have worked with some systems
similar to twisted, notably Apache MINA.  I am trying to find out how
to set up my server to support sessions for multiple clients.  Right
now I am simply developing a telnet-like application to learn twisted
but cannot figure out how to manage sessions for the remote clients.

Thanks,
Mark


From itamar at itamarst.org  Tue Mar 30 18:42:09 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 30 Mar 2010 18:42:09 -0400 (EDT)
Subject: [Twisted-Python] session management
In-Reply-To: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
References: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
Message-ID: <31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>

> Greetings,
>
> I am new to this list and twisted.  I have worked with some systems
> similar to twisted, notably Apache MINA.  I am trying to find out how
> to set up my server to support sessions for multiple clients.  Right
> now I am simply developing a telnet-like application to learn twisted
> but cannot figure out how to manage sessions for the remote clients.

Each Protocol instance stays alive for the lifetime of the connection it
is matched to (via the transport). So just store attributes on the
Protocol instance.



From glyph at twistedmatrix.com  Wed Mar 31 00:01:24 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 31 Mar 2010 00:01:24 -0400
Subject: [Twisted-Python] Anyone working on a Twisted txRiak?
In-Reply-To: <10496611.511269977368521.JavaMail.rgacote@ip-210.Corp.AppropriateSolutions.com>
References: <10496611.511269977368521.JavaMail.rgacote@ip-210.Corp.AppropriateSolutions.com>
Message-ID: <35B630BD-56A4-4F3B-8966-76720EBF46E9@twistedmatrix.com>


On Mar 30, 2010, at 3:22 PM, Ray Cote wrote:

> Curious to know if anyone is working on an interface between Twisted and Riak.
>  <http://basho.com/Riak.html>
> 
> Before we started one, thought I'd reach out first to ensure we're not duplicating efforts.
> --Ray

I can't say for sure, but given that archives of this mailing list post are already showing up as the top hit for "txriak" and "twisted riak" for me, I think you're pretty safe on getting started with it :).

Be sure to mention when you have a release so we can add it to <http://twistedmatrix.com/trac/wiki/ProjectsUsingTwisted>.



From elihusmails at gmail.com  Wed Mar 31 00:10:42 2010
From: elihusmails at gmail.com (Mark)
Date: Wed, 31 Mar 2010 00:10:42 -0400
Subject: [Twisted-Python] session management
In-Reply-To: <31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>
References: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
	<31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>
Message-ID: <9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>

I figured as much that twisted supported the notion of sessions.  Are
there any examples that show me how to access them and
add/remove/update attributes in the session?



On Tue, Mar 30, 2010 at 6:42 PM, Itamar Turner-Trauring
<itamar at itamarst.org> wrote:
>> Greetings,
>>
>> I am new to this list and twisted. ?I have worked with some systems
>> similar to twisted, notably Apache MINA. ?I am trying to find out how
>> to set up my server to support sessions for multiple clients. ?Right
>> now I am simply developing a telnet-like application to learn twisted
>> but cannot figure out how to manage sessions for the remote clients.
>
> Each Protocol instance stays alive for the lifetime of the connection it
> is matched to (via the transport). So just store attributes on the
> Protocol instance.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


From rgacote at appropriatesolutions.com  Wed Mar 31 08:32:59 2010
From: rgacote at appropriatesolutions.com (Ray Cote)
Date: Wed, 31 Mar 2010 08:32:59 -0400 (EDT)
Subject: [Twisted-Python] Anyone working on a Twisted txRiak?
In-Reply-To: <35B630BD-56A4-4F3B-8966-76720EBF46E9@twistedmatrix.com>
Message-ID: <6794132.781270039193421.JavaMail.rgacote@ip-210.Corp.AppropriateSolutions.com>

I guess coding starts this morning! 
Yes, we'll make sure it ends up on the wiki. 
--Ray


----- Original Message -----
From: "Glyph Lefkowitz" <glyph at twistedmatrix.com>
To: "Ray Cote" <rgacote at AppropriateSolutions.com>, "Twisted general discussion" <twisted-python at twistedmatrix.com>
Sent: Wednesday, March 31, 2010 12:01:24 AM GMT -05:00 US/Canada Eastern
Subject: Re: [Twisted-Python] Anyone working on a Twisted txRiak?


On Mar 30, 2010, at 3:22 PM, Ray Cote wrote:

> Curious to know if anyone is working on an interface between Twisted and Riak.
>  <http://basho.com/Riak.html>
> 
> Before we started one, thought I'd reach out first to ensure we're not duplicating efforts.
> --Ray

I can't say for sure, but given that archives of this mailing list post are already showing up as the top hit for "txriak" and "twisted riak" for me, I think you're pretty safe on getting started with it :).

Be sure to mention when you have a release so we can add it to <http://twistedmatrix.com/trac/wiki/ProjectsUsingTwisted>.


-- 
Ray Cote, President
Appropriate Solutions, Inc.
We Build Software
603.924.6079


From vlad.shevchenko at gmail.com  Wed Mar 31 11:54:49 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Wed, 31 Mar 2010 18:54:49 +0300
Subject: [Twisted-Python] AmpList: length limitations
Message-ID: <p2i572f045e1003310854g489877f3h837d4a934dc938b4@mail.gmail.com>

Hi all!

    Stuck with AmpList again :( Im trying to send/retrieve data much larger
then 64K and choose AmpList cause it "Convert a list of dictionaries into a
list of AMP boxes".

My original data looks like a long list of dicts [ {1}, {2}, ..., {x} ].
I convert it to [
    {'data': 'json encoded 1,2 dicts'},
    {'data': 'json encoded 3,4 dicts}',
    ...
] hoping EACH element in converted list will be converted to AmpBox and
retriever on wire.

However, still got TooLong exception on AmpBox.serialize(). AmpBox trying to
serialize all my converted list but not each dict in it separately.

Does this behavior ok, or this is a bug?

-- 
WBR, Vlad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100331/19c8fb4a/attachment.htm 

From cedric.dugas at gmail.com  Wed Mar 31 12:52:11 2010
From: cedric.dugas at gmail.com (Cedric Dugas)
Date: Wed, 31 Mar 2010 12:52:11 -0400
Subject: [Twisted-Python] Noob alert - Looking for a framework for creating
	a long polling service
Message-ID: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>

Hi guys,

I am a front-end developer, starting with django with some php in the belt.

I am looking for a framework for doing a long polling service where :

clients would connect to a soecific 'channel' and wait for a response

Where a client admin would push a response only to clients connected to the
same channel

It's a bit like a chat where everyone listening and only one is talking with
multiple channels


I am a bit lost in the twisted doc, I know that twisted do a LOT of thing,
and was wondering, if twisted is appropriate for this task,
and do you have a book to recommend for people like me (by that I mean that
I will not be using low level api's)

Thank you!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100331/1dd8daf0/attachment.htm 

From rlotun at gmail.com  Wed Mar 31 16:26:47 2010
From: rlotun at gmail.com (Reza Lotun)
Date: Wed, 31 Mar 2010 21:26:47 +0100
Subject: [Twisted-Python] Noob alert - Looking for a framework for
	creating a long polling service
In-Reply-To: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>
References: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>
Message-ID: <v2x95bb10691003311326id1255c01ucba54d3c9ef38c51@mail.gmail.com>

Hi,

> I am looking for a framework for doing a long polling service where :
>
> clients would connect to a soecific 'channel' and wait for a response
>
> Where a client admin would push a response only to clients connected to the
> same channel

There is a project built on top of Twisted that does exactly this,
called Orbited (http://orbited.org/). It works, and I use it for
internal real-time stats web pages. The one caveat I have with it is
that it recently appears to be somewhat inactive - though I use it so
much I might fork it and continue development ;-)

A good article showing you how to use Orbited is:
http://cometdaily.com/2008/10/10/scalable-real-time-web-architecture-part-2-a-live-graph-with-orbited-morbidq-and-jsio/

Other articles are featured on the orbited site.

If you're looking for a scalable, long-polling queue broadcaster *in
general*, I highly suggest nginx_http_push - an addon module for the
popular C-based asynchronous web server nginx
(http://pushmodule.slact.net/).

Start with Orbited though, and see where it takes you ;-)

Cheers,
Reza

-- 
Reza Lotun
mobile: +44 (0)7521 310 763
email:  rlotun at gmail.com
work:   reza at tweetdeck.com
twitter: @rlotun


From ssteinerx at gmail.com  Wed Mar 31 16:58:43 2010
From: ssteinerx at gmail.com (ssteinerX@gmail.com)
Date: Wed, 31 Mar 2010 16:58:43 -0400
Subject: [Twisted-Python] Noob alert - Looking for a framework for
	creating a long polling service
In-Reply-To: <v2x95bb10691003311326id1255c01ucba54d3c9ef38c51@mail.gmail.com>
References: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>
	<v2x95bb10691003311326id1255c01ucba54d3c9ef38c51@mail.gmail.com>
Message-ID: <B995CBB9-AED4-49F7-8589-88DBDAE391AD@gmail.com>


On Mar 31, 2010, at 4:26 PM, Reza Lotun wrote:

> Hi,
> 
>> I am looking for a framework for doing a long polling service where :
>> 
>> clients would connect to a soecific 'channel' and wait for a response
>> 
>> Where a client admin would push a response only to clients connected to the
>> same channel
> 
> There is a project built on top of Twisted that does exactly this,
> called Orbited (http://orbited.org/). It works, and I use it for
> internal real-time stats web pages. The one caveat I have with it is
> that it recently appears to be somewhat inactive - though I use it so
> much I might fork it and continue development ;-)

It seems to have completely stalled just before the big 0.8 refactoring effort.

Have you continued, or do you plan to continue development where it was left off?

They all seem to have gone off to play with node.js instead.

> If you're looking for a scalable, long-polling queue broadcaster *in
> general*, I highly suggest nginx_http_push - an addon module for the
> popular C-based asynchronous web server nginx
> (http://pushmodule.slact.net/).

Very cool, I hadn't seen that before.

S



From exarkun at twistedmatrix.com  Wed Mar 31 17:39:52 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Wed, 31 Mar 2010 21:39:52 -0000
Subject: [Twisted-Python] session management
In-Reply-To: <9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>
References: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
	<31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>
	<9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>
Message-ID: <20100331213952.2792.778856419.divmod.xquotient.1975@localhost.localdomain>

On 04:10 am, elihusmails at gmail.com wrote:
>On Tue, Mar 30, 2010 at 6:42 PM, Itamar Turner-Trauring
><itamar at itamarst.org> wrote:
>>>Greetings,
>>>
>>>I am new to this list and twisted.  I have worked with some systems
>>>similar to twisted, notably Apache MINA.  I am trying to find out how
>>>to set up my server to support sessions for multiple clients.  Right
>>>now I am simply developing a telnet-like application to learn twisted
>>>but cannot figure out how to manage sessions for the remote clients.
>>
>>Each Protocol instance stays alive for the lifetime of the connection 
>>it
>>is matched to (via the transport). So just store attributes on the
>>Protocol instance.
>
>I figured as much that twisted supported the notion of sessions.  Are
>there any examples that show me how to access them and
>add/remove/update attributes in the session?

Protocol instances are normal Python objects.  You can use normal Python 
attributes on them in the normal way.  For example:

    from twisted.internet.protocol import Protocol

    class Counter(Protocol):
        """
        Keep track of how many times data is delivered over a connection.
        """
        def connectionMade(self):
            self.count = 0

        def dataReceived(self, bytes):
            self.count += 1

Jean-Paul


From mebly5343 at gmail.com  Wed Mar 31 17:44:23 2010
From: mebly5343 at gmail.com (Mark Bailey)
Date: Wed, 31 Mar 2010 17:44:23 -0400
Subject: [Twisted-Python] session management
In-Reply-To: <9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>
References: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
	<31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>
	<9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>
Message-ID: <v2qdc408fe51003311444ha3d8bfyb446bb562aec9473@mail.gmail.com>

I found the following example answered my question:

http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother

Good luck.

Mark

On Mar 31, 2010 12:11 AM, "Mark" <elihusmails at gmail.com> wrote:

I figured as much that twisted supported the notion of sessions.  Are
there any examples that show me how to access them and
add/remove/update attributes in the session?




On Tue, Mar 30, 2010 at 6:42 PM, Itamar Turner-Trauring
<itamar at itamarst.org> wrote:
>> Greetings...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100331/4deaa04b/attachment.htm 

From exarkun at twistedmatrix.com  Wed Mar 31 17:45:31 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Wed, 31 Mar 2010 21:45:31 -0000
Subject: [Twisted-Python] AmpList: length limitations
In-Reply-To: <p2i572f045e1003310854g489877f3h837d4a934dc938b4@mail.gmail.com>
References: <p2i572f045e1003310854g489877f3h837d4a934dc938b4@mail.gmail.com>
Message-ID: <20100331214531.2792.1585769101.divmod.xquotient.1985@localhost.localdomain>

On 03:54 pm, vlad.shevchenko at gmail.com wrote:
>Hi all!
>
>    Stuck with AmpList again :( Im trying to send/retrieve data much 
>larger
>then 64K and choose AmpList cause it "Convert a list of dictionaries 
>into a
>list of AMP boxes".
>
>My original data looks like a long list of dicts [ {1}, {2}, ..., {x} 
>].
>I convert it to [
>    {'data': 'json encoded 1,2 dicts'},
>    {'data': 'json encoded 3,4 dicts}',
>    ...
>] hoping EACH element in converted list will be converted to AmpBox and
>retriever on wire.
>
>However, still got TooLong exception on AmpBox.serialize(). AmpBox 
>trying to
>serialize all my converted list but not each dict in it separately.
>
>Does this behavior ok, or this is a bug?

When you use an AmpList, the value is still serialized as a single key's 
value string, so the 64k limit still applies, even if it has sub- 
structures of its own, none of which exceed the limit.

At the Twisted sprint hosted by Flumotion last weekend, some people were 
working on adding real streaming support to AMP.  I think most of the 
progress made was in understanding how the implementation should work, 
though.

The associated ticket is #2529.
>
>--
>WBR, Vlad


From donal.mcmullan at gmail.com  Wed Mar 31 17:48:22 2010
From: donal.mcmullan at gmail.com (Donal McMullan)
Date: Thu, 1 Apr 2010 10:48:22 +1300
Subject: [Twisted-Python] Noob alert - Looking for a framework for
	creating a long polling service
In-Reply-To: <B995CBB9-AED4-49F7-8589-88DBDAE391AD@gmail.com>
References: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>
	<v2x95bb10691003311326id1255c01ucba54d3c9ef38c51@mail.gmail.com>
	<B995CBB9-AED4-49F7-8589-88DBDAE391AD@gmail.com>
Message-ID: <m2g634095dc1003311448h613a534dye1d6ec1425132ad7@mail.gmail.com>

There's some simple sample code here:
http://zenmachine.wordpress.com/2009/09/19/twisted-and-comet-comet-in-60-seconds/

The formatting's off, but otherwise it's a succinct demo of the kind of
functionality you may be looking for.

Cheers

D

On 1 April 2010 09:58, ssteinerX at gmail.com <ssteinerx at gmail.com> wrote:

>
> On Mar 31, 2010, at 4:26 PM, Reza Lotun wrote:
>
> > Hi,
> >
> >> I am looking for a framework for doing a long polling service where :
> >>
> >> clients would connect to a soecific 'channel' and wait for a response
> >>
> >> Where a client admin would push a response only to clients connected to
> the
> >> same channel
> >
> > There is a project built on top of Twisted that does exactly this,
> > called Orbited (http://orbited.org/). It works, and I use it for
> > internal real-time stats web pages. The one caveat I have with it is
> > that it recently appears to be somewhat inactive - though I use it so
> > much I might fork it and continue development ;-)
>
> It seems to have completely stalled just before the big 0.8 refactoring
> effort.
>
> Have you continued, or do you plan to continue development where it was
> left off?
>
> They all seem to have gone off to play with node.js instead.
>
> > If you're looking for a scalable, long-polling queue broadcaster *in
> > general*, I highly suggest nginx_http_push - an addon module for the
> > popular C-based asynchronous web server nginx
> > (http://pushmodule.slact.net/).
>
> Very cool, I hadn't seen that before.
>
> S
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100401/08ac20fd/attachment.htm 

From vlad.shevchenko at gmail.com  Wed Mar 31 18:04:08 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Thu, 1 Apr 2010 01:04:08 +0300
Subject: [Twisted-Python] AmpList: length limitations
In-Reply-To: <20100331214531.2792.1585769101.divmod.xquotient.1985@localhost.localdomain>
References: <p2i572f045e1003310854g489877f3h837d4a934dc938b4@mail.gmail.com>
	<20100331214531.2792.1585769101.divmod.xquotient.1985@localhost.localdomain>
Message-ID: <t2p572f045e1003311504z20dbfc59h5da5c4c35da2d431@mail.gmail.com>

Why does not serialize each AmpBox separately?

On Thu, Apr 1, 2010 at 12:45 AM, <exarkun at twistedmatrix.com> wrote:

> On 03:54 pm, vlad.shevchenko at gmail.com wrote:
> >Hi all!
> >
> >    Stuck with AmpList again :( Im trying to send/retrieve data much
> >larger
> >then 64K and choose AmpList cause it "Convert a list of dictionaries
> >into a
> >list of AMP boxes".
> >
> >My original data looks like a long list of dicts [ {1}, {2}, ..., {x}
> >].
> >I convert it to [
> >    {'data': 'json encoded 1,2 dicts'},
> >    {'data': 'json encoded 3,4 dicts}',
> >    ...
> >] hoping EACH element in converted list will be converted to AmpBox and
> >retriever on wire.
> >
> >However, still got TooLong exception on AmpBox.serialize(). AmpBox
> >trying to
> >serialize all my converted list but not each dict in it separately.
> >
> >Does this behavior ok, or this is a bug?
>
> When you use an AmpList, the value is still serialized as a single key's
> value string, so the 64k limit still applies, even if it has sub-
> structures of its own, none of which exceed the limit.
>
> At the Twisted sprint hosted by Flumotion last weekend, some people were
> working on adding real streaming support to AMP.  I think most of the
> progress made was in understanding how the implementation should work,
> though.
>
> The associated ticket is #2529.
> >
> >--
> >WBR, Vlad
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
WBR, Vlad Shevchenko
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20100401/a0cbdb03/attachment-0001.htm 

From jml at mumak.net  Mon Mar  1 06:56:52 2010
From: jml at mumak.net (Jonathan Lange)
Date: Mon, 1 Mar 2010 13:56:52 +0000
Subject: [Twisted-Python] python3 story?
In-Reply-To: <4B86C66B.8010609@noir.com>
References: <4B86C66B.8010609@noir.com>
Message-ID: <d06a5cd31003010556x781d3c9dj7cd4e35643ad352@mail.gmail.com>

On Thu, Feb 25, 2010 at 6:50 PM, K. Richard Pixley <rich at noir.com> wrote:
> Does twisted have a python3 story?
>
> Whatever it is, it should probably be in the release 10 doc and perhaps
> also on the web site.

The docs for 10.0.0 release are already frozen.

jml



From bra at fsn.hu  Mon Mar  1 07:15:24 2010
From: bra at fsn.hu (Attila Nagy)
Date: Mon, 01 Mar 2010 15:15:24 +0100
Subject: [Twisted-Python] Is AMP secure enough for the internet?
In-Reply-To: <1267416570.32241.76.camel@Snowflake>
References: <4B8995D2.8040909@fsn.hu>	<f5eea9171002281633s6ee01b2dp5c6ce27e3acdf4f6@mail.gmail.com>
	<1267416570.32241.76.camel@Snowflake>
Message-ID: <4B8BCBFC.5040404@fsn.hu>

Eric P. Mangold wrote:
> AMP "keys" are limited to 256 bytes and "values" are limited to 64k. So
> that will prevent your program from handling a malformed AMP packet that
> tries to exceed those limits....
>   
Yes, I know that from the docs, but I haven't read the code, and it's
not trivial where this is limited. If only on the client side, it
doesn't protect...
> One of the things you will need to implement yourself is preventing an
> otherwise legit client from flooding your server with legitimate
> requests... this is application-specific, and Twisted can't implement a
> generalized protection mechanize here.
>   
That's right and clear, this needs to be implemented in the application.

Thanks,



From jml at mumak.net  Mon Mar  1 07:19:05 2010
From: jml at mumak.net (Jonathan Lange)
Date: Mon, 1 Mar 2010 14:19:05 +0000
Subject: [Twisted-Python] Is AMP secure enough for the internet?
In-Reply-To: <4B8BCBFC.5040404@fsn.hu>
References: <4B8995D2.8040909@fsn.hu>
	<f5eea9171002281633s6ee01b2dp5c6ce27e3acdf4f6@mail.gmail.com>
	<1267416570.32241.76.camel@Snowflake> <4B8BCBFC.5040404@fsn.hu>
Message-ID: <d06a5cd31003010619t1e498eb9w3ccd7b0c9fd5a040@mail.gmail.com>

On Mon, Mar 1, 2010 at 2:15 PM, Attila Nagy <bra at fsn.hu> wrote:
> Eric P. Mangold wrote:
>> AMP "keys" are limited to 256 bytes and "values" are limited to 64k. So
>> that will prevent your program from handling a malformed AMP packet that
>> tries to exceed those limits....
>>
> Yes, I know that from the docs, but I haven't read the code, and it's
> not trivial where this is limited. If only on the client side, it
> doesn't protect...

The first two bytes of the key are the length of the key. The server
will stop reading after this length, and will bork if the length is
bigger than 256.

Actually, the client will do the same, since at this level, the
protocol is symmetric.

jml



From markscottwright at gmail.com  Mon Mar  1 09:47:49 2010
From: markscottwright at gmail.com (markscottwright at gmail.com)
Date: Mon, 01 Mar 2010 16:47:49 +0000
Subject: [Twisted-Python] What is the right way to pass variables from Site
	to Resource?
Message-ID: <0016e6475fdc655cd30480c002b5@google.com>

I've got some global state and configuration information. It seems to me  
that they ought to be members of my Site, but I don't see any obvious way  
in a Resource.render_* to get the current Site. Neither Request nor  
Resource have a instance or method that returns its Site that I can find.  
Am I missing something, or am I confused about the Twisted way of doing  
things?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100301/049460e4/attachment.html>

From exarkun at twistedmatrix.com  Mon Mar  1 10:20:05 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Mon, 01 Mar 2010 17:20:05 -0000
Subject: [Twisted-Python] What is the right way to pass variables
	from	Site to Resource?
In-Reply-To: <0016e6475fdc655cd30480c002b5@google.com>
References: <0016e6475fdc655cd30480c002b5@google.com>
Message-ID: <20100301172005.2792.1622720080.divmod.xquotient.311@localhost.localdomain>

On 04:47 pm, markscottwright at gmail.com wrote:
>I've got some global state and configuration information. It seems to 
>me that they ought to be members of my Site, but I don't see any 
>obvious way in a Resource.render_* to get the current Site. Neither 
>Request nor Resource have a instance or method that returns its Site 
>that I can find. Am I missing something, or am I confused about the 
>Twisted way of doing things?

The Request object does have a "site" attribute.  It's not documented on 
the interface, so perhaps you should be careful in your use of it.  Or, 
you could file a ticket explaining why it would be a good idea to have 
the attribute added to the interface.

Jean-Paul



From marco.giusti at gmail.com  Mon Mar  1 10:23:10 2010
From: marco.giusti at gmail.com (Marco Giusti)
Date: Mon, 1 Mar 2010 18:23:10 +0100
Subject: [Twisted-Python] What is the right way to pass variables from
 Site to Resource?
In-Reply-To: <0016e6475fdc655cd30480c002b5@google.com>
References: <0016e6475fdc655cd30480c002b5@google.com>
Message-ID: <20100301172310.GB2688@murdoc>

On Mon, Mar 01, 2010 at 04:47:49PM +0000, markscottwright at gmail.com wrote:
> I've got some global state and configuration information. It seems
> to me that they ought to be members of my Site, but I don't see any
> obvious way in a Resource.render_* to get the current Site. Neither
> Request nor Resource have a instance or method that returns its Site
> that I can find. Am I missing something, or am I confused about the
> Twisted way of doing things?

as general rule i prefer pass variables through constructors but i don't
know how do you instance your Resource(s).





From drew.smathers at gmail.com  Mon Mar  1 10:23:51 2010
From: drew.smathers at gmail.com (Drew Smathers)
Date: Mon, 1 Mar 2010 12:23:51 -0500
Subject: [Twisted-Python] What is the right way to pass variables from
	Site to Resource?
In-Reply-To: <0016e6475fdc655cd30480c002b5@google.com>
References: <0016e6475fdc655cd30480c002b5@google.com>
Message-ID: <368574aa1003010923o712c1b3cg5b84930196848a4d@mail.gmail.com>

On Mon, Mar 1, 2010 at 11:47 AM, <markscottwright at gmail.com> wrote:

> I've got some global state and configuration information. It seems to me
> that they ought to be members of my Site, but I don't see any obvious way in
> a Resource.render_* to get the current Site. Neither Request nor Resource
> have a instance or method that returns its Site that I can find. Am I
> missing something, or am I confused about the Twisted way of doing things?
>
>
I think you are missing something - request has attribute `site' set on it
which will give you the Site object.

-Drew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100301/64f677be/attachment.html>

From renan at renanfernandes.org  Mon Mar  1 12:16:38 2010
From: renan at renanfernandes.org (Renan Mathias Fernandes)
Date: Mon, 1 Mar 2010 16:16:38 -0300
Subject: [Twisted-Python] Modifying Echo example
Message-ID: <991CD5EE-35FA-47F7-B2F5-1333B0F3CB87@renanfernandes.org>

Hello,

I am trying to learn about Twisted Matrix, and for that I am modifying the Echo Client & Server example to archive few goals:
From now, I have modified this example to: Make the client send some requests and have the server reply for each request.
So, for example: if the client sends "Hello!", the server will reply : "Hello, [ip address of client]".
But my point is: I can handle the communication between 1 server and 1 client only, but how Can I do if I have multiple clients connected?
My objective is: I have 4 clients connected, and I want the server to send a data to only one specific client (I will provide the ip address and port for this specific client)
I imagine that The correct way to do this is: having one thread for each client connection, and calling that specific thread to write down a message, am I correct?

Does someone has an example on how can I do that?

Thanks in advance,

Renan Mathias Fernandes







From mebly5343 at gmail.com  Mon Mar  1 12:41:44 2010
From: mebly5343 at gmail.com (Mark Bailey)
Date: Mon, 1 Mar 2010 14:41:44 -0500
Subject: [Twisted-Python] Modifying Echo example
In-Reply-To: <991CD5EE-35FA-47F7-B2F5-1333B0F3CB87@renanfernandes.org>
References: <991CD5EE-35FA-47F7-B2F5-1333B0F3CB87@renanfernandes.org>
Message-ID: <dc408fe51003011141q67f6e530l2b5b18e1452bd3bc@mail.gmail.com>

Hi Renan:

I asked almost the same question a few weeks ago.  Look at
http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother

The factory can access a list of the connections.

Mark

On Mar 1, 2010 2:24 PM, "Renan Mathias Fernandes" <renan at renanfernandes.org>
wrote:

Hello,

I am trying to learn about Twisted Matrix, and for that I am modifying the
Echo Client & Server example to archive few goals:
>From now, I have modified this example to: Make the client send some
requests and have the server reply for each request.
So, for example: if the client sends "Hello!", the server will reply :
"Hello, [ip address of client]".
But my point is: I can handle the communication between 1 server and 1
client only, but how Can I do if I have multiple clients connected?
My objective is: I have 4 clients connected, and I want the server to send a
data to only one specific client (I will provide the ip address and port for
this specific client)
I imagine that The correct way to do this is: having one thread for each
client connection, and calling that specific thread to write down a message,
am I correct?

Does someone has an example on how can I do that?

Thanks in advance,

Renan Mathias Fernandes





_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100301/6e564833/attachment.html>

From renan at renanfernandes.org  Mon Mar  1 21:04:25 2010
From: renan at renanfernandes.org (Renan Mathias Fernandes)
Date: Tue, 2 Mar 2010 01:04:25 -0300
Subject: [Twisted-Python] Modifying Echo example
In-Reply-To: <dc408fe51003011141q67f6e530l2b5b18e1452bd3bc@mail.gmail.com>
References: <991CD5EE-35FA-47F7-B2F5-1333B0F3CB87@renanfernandes.org>
	<dc408fe51003011141q67f6e530l2b5b18e1452bd3bc@mail.gmail.com>
Message-ID: <89E40153-F7E5-4EEF-BCDA-29A06C11B005@renanfernandes.org>

Thank you Mark, that worked perfectly!


Renan Mathias Fernandes




On Mar 1, 2010, at 4:41 PM, Mark Bailey wrote:

> Hi Renan:
> 
> I asked almost the same question a few weeks ago.  Look at
> http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother
> 
> The factory can access a list of the connections.
> 
> Mark
> 
> 
>> On Mar 1, 2010 2:24 PM, "Renan Mathias Fernandes" <renan at renanfernandes.org> wrote:
>> 
>> Hello,
>> 
>> I am trying to learn about Twisted Matrix, and for that I am modifying the Echo Client & Server example to archive few goals:
>> From now, I have modified this example to: Make the client send some requests and have the server reply for each request.
>> So, for example: if the client sends "Hello!", the server will reply : "Hello, [ip address of client]".
>> But my point is: I can handle the communication between 1 server and 1 client only, but how Can I do if I have multiple clients connected?
>> My objective is: I have 4 clients connected, and I want the server to send a data to only one specific client (I will provide the ip address and port for this specific client)
>> I imagine that The correct way to do this is: having one thread for each client connection, and calling that specific thread to write down a message, am I correct?
>> 
>> Does someone has an example on how can I do that?
>> 
>> Thanks in advance,
>> 
>> Renan Mathias Fernandes
>> 
>> 
>> 
>> 
>> 
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From kamil at lucem.pl  Tue Mar  2 03:20:02 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Tue, 2 Mar 2010 11:20:02 +0100
Subject: [Twisted-Python] WSDL Proxy Send variable names
Message-ID: <eeca458e1003020220u7272cfffn6ba39f0b9644539e@mail.gmail.com>

Hi,
 I need to be able to send variable names when sending requests to a SOAP
server. Currently SOAPpy sends my variables automatically named as v1, v2,
v3. The server requires they have a name varNameA, varNameB etc.
Here is my outgoing SOAP and code.

wsdlFile = "http://webapi.allegro.pl/uploader.php?wsdl"
server = WSDL.Proxy(wsdlFile)
server.doGetCountries(1, h23dk99sd)


*** Outgoing SOAP ******************************************************
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope SOAP-ENV:encodingStyle="
http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENC="
http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="
http://www.w3.org/1999/XMLSchema-instance" xmlns:SOAP-ENV="
http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="
http://www.w3.org/1999/XMLSchema">
<SOAP-ENV:Body>
<ns1:doGetCountries xmlns:ns1="urn:AllegroWebApi" SOAP-ENC:root="1">
<v1 xsi:type="xsd:int">1</v1>
<v2 xsi:type="xsd:string">h23dk99sd</v2>
</ns1:doGetCountries>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
************************************************************************

This is what the variable area should look like:
<country-code xsi:type="xsd:int">1</country-code>
<webapi-key xsi:type="xsd:string">h23dk99sd</webapi-key>

How do i accomplish this? (Wrapping it in a dictionary only sends the
dictionary as v1)

Thank you!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100302/6c69f259/attachment.html>

From landreville at deadtreepages.com  Tue Mar  2 07:48:36 2010
From: landreville at deadtreepages.com (Landreville)
Date: Tue, 2 Mar 2010 09:48:36 -0500
Subject: [Twisted-Python] WSDL Proxy Send variable names
In-Reply-To: <eeca458e1003020220u7272cfffn6ba39f0b9644539e@mail.gmail.com>
References: <eeca458e1003020220u7272cfffn6ba39f0b9644539e@mail.gmail.com>
Message-ID: <9d748c781003020648s6f5de7acu996a36918d20b71@mail.gmail.com>

On Tue, Mar 2, 2010 at 5:20 AM, Kamil Wasilewski <kamil at lucem.pl> wrote:
> Hi,
> I need to be able to send variable names when sending requests to a SOAP
> server. Currently SOAPpy sends my variables automatically named as v1, v2,
> v3. The server requires they have a name varNameA, varNameB etc.
> Here is my outgoing SOAP and code.
>

I played around with SOAPpy a couple months ago; I'm fairly sure that
it does order-based parameters by default and I don't remember finding
a way to use named parameters.

There is another SOAP library called ZSI that might have that (it's
not integrated with Twisted though).



From kamil at lucem.pl  Tue Mar  2 08:09:39 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Tue, 2 Mar 2010 16:09:39 +0100
Subject: [Twisted-Python] WSDL Proxy Send variable names
In-Reply-To: <9d748c781003020648s6f5de7acu996a36918d20b71@mail.gmail.com>
References: <eeca458e1003020220u7272cfffn6ba39f0b9644539e@mail.gmail.com>
	<9d748c781003020648s6f5de7acu996a36918d20b71@mail.gmail.com>
Message-ID: <eeca458e1003020709t3b1514c6y2de9f5241e38cb8a@mail.gmail.com>

On Tue, Mar 2, 2010 at 3:48 PM, Landreville
<landreville at deadtreepages.com>wrote:

> On Tue, Mar 2, 2010 at 5:20 AM, Kamil Wasilewski <kamil at lucem.pl> wrote:
> > Hi,
> >  I need to be able to send variable names when sending requests to a SOAP
> > server. Currently SOAPpy sends my variables automatically named as v1,
> v2,
> > v3. The server requires they have a name varNameA, varNameB etc.
> > Here is my outgoing SOAP and code.
> >
>
> I played around with SOAPpy a couple months ago; I'm fairly sure that
> it does order-based parameters by default and I don't remember finding
> a way to use named parameters.
>
> There is another SOAP library called ZSI that might have that (it's
> not integrated with Twisted though).
>
>
Yes it does order them correctly if you just call
server.doFunction(param1, param2), but assignes them names v1, v2..
But i found a way to name (and order) them
 http://ungil.com/remedy/webservices.html

# Define the order of args: needed for this service
server.config.argsOrdering = {'doFunction': ('id', 'code') }
response = server.doFunction(code=sc, id=gi )

Notice however that i need to name my parameters with a '-' in the middle:
country-code, webapi-key and the above naming method gives me errors. if the
variables were country_code it would be a different story.

Any idea how to get around this?
Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100302/77462b95/attachment.html>

From jml at mumak.net  Tue Mar  2 08:17:40 2010
From: jml at mumak.net (Jonathan Lange)
Date: Tue, 2 Mar 2010 15:17:40 +0000
Subject: [Twisted-Python] PyCon 2010 sprint report
Message-ID: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>

Residents of the once-great city of Atlanta are only now beginning to piece
their lives back together after the event that Glyph Lefkowitz described as
"the best Twisted sprint ever".

Quite apart from the unprecedented levels of wanton destruction, Twisted's
PyCon 2010 sprint was also better attended than any previous sprints, which
have laid waste to the outskirts of Boston, inner-city Dallas and regions of
Australia.

At its peak, there were eighteen people seated around the two tables where the
sprint took place. People even joined in remotely, working with the Atlanta
team through #twisted on freenode.

Although buried deep within a secret bunker in Atlanta, the sprint still
managed to attract a fair number of new contributors and Twisted users who
wanted to help out.

Attendees who made themselves known to your correspondent include:
 * Jonathan Lange
 * Jean-Paul Calderone
 * David Reid
 * Thomas Herv
 * Tim Couper
 * Pavel Pergamenshchik
 * Maciej Fijalkowski
 * Glyph Lefkowitz
 * Itamar Turner-Trauring
 * Terry Jones

jesstess, ralphm and spiv also participated remotely.

Attendees all had immense fun and expressed a desire to have another sprint
soon. One observed that it had been far too long since giant mecha robot
warriors descended on Paris.

Twisted prevails,
jml


More simply, we had a great time at the sprint and got a ridiculous amount of
stuff done.

We fixed many, many bugs, including all of the known regressions since the 9.0
release. Once we fixed the regressions, we started work on getting the first
10.0 pre-release out the door.

The pre-release probably would not have been possible without the sprint since
it allowed the new release manager ready access to Jean-Paul, who has quite a
lot of knowledge stuck in his head. One result of this is a new release
process document, which is being developed at
http://twistedmatrix.com/trac/wiki/ReleaseProcess alongside the actual 10.0
release.

We also reached an in-principle agreement to aim for a release every three
months. This means that although hardly any of the good work from the sprint
is in the 10.0 release, you won't have to wait long for it to appear in 10.1.
Hopefully. I plan write up how this will work as soon as the 10.0 release is
done.

The sprint proved to be a perfect opportunity to talk about some of the more
gutly bits of Twisted, including Deferred cancellation (see #990) and
endpoints (see #1442). The former is done, and the latter has made good
progress. Stay tuned.

Thomas Herv did a lot of work on upgrading our Trac instance, which was
getting kind of old and currently crashes all of the time.

We talked a bit about how we could make it easier for people to contribute to
Twisted without compromising our high standards of quality. We put as many of
the ideas that we could remember on to
http://twistedmatrix.com/trac/wiki/ContributionIdeas.

Maciej Fijalkowski was at the sprint working on getting PyPy benchmarks for
Twisted and on making PyPy work faster with Twisted. Personally, it's really
exciting to see PyPy live up to its promise of a faster Python, particularly
with a big codebase like Twisted.

As I said, we fixed lots of bugs. Here's the complete list:

 * #4179 - HTTP proxy hanging in Twisted 9.0
 * #3056 - twisted.spread.pb.IUsernameMD5Password's docstring should
           say it accepts an MD5 digest of a password, not plaintext
 * #3289 - startLoggingWithObserver raises IndexError
 * #4178 - Function singleSearchStep was renamed to _singleSearchStep
           not everywhere
 * #4192 - Move the content from exarkun's Twisted Web in 60 Seconds
           series into the Twisted Web howto
 * #4284 - t.e.adbapi leaks threads
 * #4282 - _release.filePathDelta is broken
 * #3718 - twisted.internet.posixbase._Waker not defined on Jython
 * #4143 - twisted.web.wsgi incorrectly unquotes QUERY_STRING
 * #4255 - BaseLogFile should provide a method to reopen logs
 * #972  - Add linux inotify support to twisted core
 * #2367 - twisted.test.test_failure.FailureTestCase.testBrokenStr breaks
           #trial in debug mode
 * #1083 - gtk2reactor thread initialization confuses python-2.3
 * #3462 - FTP server: upload should support async close
 * #990  - Deferred cancellation
 * #733  - twisted's SIGCHLD handler breaks popen.
 * #2376 - release-twisted should generate guides with links to API docs
 * #4272 - flavors.py still talks about getObjectAt
 * #4172 - UDP crashes python.exe when using IOCPReactor
 * #3925 - test_addresses fails with Glib2 and Gtk2 reactors
 * #4255 - BaseLogFile should provide a method to reopen logs
 * #4293 - Update links in testing documentation
 * #4311 - XMPP Stanza Error 'remote-server-timeout' yield no type and code
 * #3811 - Allow aborting HTTP client connections in the _newclient API

We also worked on:
 * Getting rid of 3k warnings and generally doing 2to3
 * Event support for iocpreactor
 * Making Deferreds more iterative (see #411)
 * Twisted Web features and bug fixes
 * Fixing obscure Windows/gtk2 compatibility issues

Thank you very much to PyCon US, the Python Software Foundation and the many
sponsors of the Twisted Software Foundation for their hard-work and support in
making this all possible.

Thanks also to the attendees for making it such a blast.

If you want to encourage more of this sort of behaviour, then please donate to
the Twisted Software Foundation:

  http://twistedmatrix.com/trac/wiki/TwistedSoftwareFoundation#HowtoDonate

jml



From jml at mumak.net  Tue Mar  2 09:04:41 2010
From: jml at mumak.net (Jonathan Lange)
Date: Tue, 2 Mar 2010 16:04:41 +0000
Subject: [Twisted-Python] PyCon 2010 sprint report
In-Reply-To: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
References: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
Message-ID: <d06a5cd31003020804xefaba65ge453c1adc411cd29@mail.gmail.com>

On Tue, Mar 2, 2010 at 3:17 PM, Jonathan Lange <jml at mumak.net> wrote:
...
>
> jesstess, ralphm and spiv also participated remotely.

Jessica McKellar, Ralph Meijer and Andrew Bennetts respectively.

jml



From nathan.stocks at gmail.com  Tue Mar  2 09:31:32 2010
From: nathan.stocks at gmail.com (Nathan)
Date: Tue, 2 Mar 2010 09:31:32 -0700
Subject: [Twisted-Python] PyCon 2010 sprint report
In-Reply-To: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
References: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
Message-ID: <96c9d6a81003020831y7b1cc2e5ydb150be39efbeb29@mail.gmail.com>

On Tue, Mar 2, 2010 at 8:17 AM, Jonathan Lange <jml at mumak.net> wrote:
> More simply, we had a great time at the sprint and got a ridiculous amount of
> stuff done.
>
> We fixed many, many bugs, including all of the known regressions since the 9.0
> release. Once we fixed the regressions, we started work on getting the first
> 10.0 pre-release out the door.

Awesome!

~ Nathan



From markscottwright at gmail.com  Tue Mar  2 11:27:11 2010
From: markscottwright at gmail.com (markscottwright at gmail.com)
Date: Tue, 02 Mar 2010 18:27:11 +0000
Subject: [Twisted-Python] Does the default session expiry work?
Message-ID: <0016e6480da6a3a04c0480d58337@google.com>

I'm using twisted 8.2 and (after reading glyph's latest "Twisted in 60  
seconds" entry), I've realized that my sessions never expire. I never added  
any session expiration code, but I thought that the default code expires  
after 15 minutes.

In the below example, I modified twisted\web\server to make  
Session.sessionTimeout be 30 seconds (I also put a print statement in  
Session's ctor, as the log shows), then did two GETs separated by more than  
30 seconds. As the log shows, it looks like the exact same session uid is  
being returned. I would expect it to be deleted by Session.expire, since  
time - lastModifiedTime > 30. Am I missing something?

import sys
from twisted.web import server, static
from twisted.web.resource import Resource
from twisted.web.server import Session, NOT_DONE_YET
from twisted.internet import reactor, ssl
from twisted.python import log

class TestSessionResource(Resource):
isLeaf = True
def render_GET(self, request):
session = request.getSession()
print session.sessionTimeout
print session.uid
print session
return "<html><body><p>Session Test</p></body></html>"

root = TestSessionResource()
reactor.listenTCP(9000, server.Site(root))
log.startLogging(sys.stdout)
reactor.run()

2010-03-02 12:16:49-0600 [-] Log opened.
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] making a new session!!!
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
<twisted.web.server.Session instance at 0x01042AD0>
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:16:51 +0000] "GET / HTTP/1.1" 200 45 "-" "Mozilla/5.0  
(Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5 (KHTML, like Gecko)  
Chrome/4.0.249.89 Safari/532.5"

2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
<twisted.web.server.Session instance at 0x01042AD0>
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:16:51 +0000] "GET /favicon.ico HTTP/1.1" 200  
45 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5  
(KHTML, like Gecko) Chrome/4.0.249.89 Safari/532.5"
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
<twisted.web.server.Session instance at 0x01042AD0>
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:17:44 +0000] "GET / HTTP/1.1" 200 45 "-" "Mozilla/5.0  
(Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5 (KHTML, like Gecko)  
Chrome/4.0.249.89 Safari/532.5"

2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
<twisted.web.server.Session instance at 0x01042AD0>
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:17:44 +0000] "GET /favicon.ico HTTP/1.1" 200  
45 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5  
(KHTML, like Gecko) Chrome/4.0.249.89 Safari/532.5"
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100302/66497098/attachment.html>

From maarten at treewalker.org  Tue Mar  2 11:55:49 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Tue, 2 Mar 2010 19:55:49 +0100
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <0016e6480da6a3a04c0480d58337@google.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
Message-ID: <201003021955.49868.maarten@treewalker.org>

On Tuesday 02 March 2010, markscottwright at gmail.com wrote:

> I'm using twisted 8.2 and (after reading glyph's latest "Twisted in 60
> seconds" entry), I've realized that my sessions never expire. I never
> added any session expiration code, but I thought that the default code
> expires after 15 minutes.
> 
> In the below example, I modified twisted\web\server to make
> Session.sessionTimeout be 30 seconds (I also put a print statement in
> Session's ctor, as the log shows), then did two GETs separated by more
> than 30 seconds. As the log shows, it looks like the exact same session
> uid is being returned. I would expect it to be deleted by
> Session.expire, since time - lastModifiedTime > 30. Am I missing
> something?

Maybe you are encountering bug 3458?

http://twistedmatrix.com/trac/ticket/3458

If so, upgrading Twisted would help.

Bye,
		Maarten



From renan at renanfernandes.org  Tue Mar  2 12:09:38 2010
From: renan at renanfernandes.org (Renan Mathias Fernandes)
Date: Tue, 2 Mar 2010 16:09:38 -0300
Subject: [Twisted-Python] qtreactor and Linux problems
Message-ID: <F705D498-9C52-4C18-A788-EF807857DAEE@renanfernandes.org>

Hello Guys,

	I am trying to learn how to use the qtreactor (I am using pyQT and TwistedMatrix) but i am facing few issues.
	I created a simple Ui, just a MainWindow and a QTreeWidget.
	The point is: I can execute and See my MainWindow using the code below under Mac OS X, but if I execute the same code on Linux, it will show me only the window, without the QTreeWidget.
	I noticied that the issue is under the install() method, since I can see the Window correctly if I remove the install() method.
	Does anyone know if I am missing something?

# -*- coding: utf-8 -*-
 
"""The user interface for our app"""
 
import os,sys

from qt4reactor import install; 
from PyQt4 import QtCore,QtGui
from windowUi import Ui_MainWindow
 
class Main(QtGui.QMainWindow):
    def __init__(self):
        QtGui.QMainWindow.__init__(self)
        self.ui=Ui_MainWindow()
        self.ui.setupUi(self)
 
def main():
    app = QtGui.QApplication(sys.argv)
    qt4reactor.install()
    window=Main()
    window.show()
    from twisted.internet import reactor
    reactor.run()
    sys.exit(app.exec_())
    
 
if __name__ == "__main__":
    main()
    


Thanks
Renan Mathias Fernandes







From fred at bsdhost.net  Tue Mar  2 12:19:32 2010
From: fred at bsdhost.net (Fred C)
Date: Tue, 2 Mar 2010 11:19:32 -0800
Subject: [Twisted-Python] Reverse HTTP proxy code review
Message-ID: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>


Hello,

I am totally new with Twisted and this the first code I have ever written using that package. One of my main problem was to figure out how to fit things together and I am not even sure I understand everything I am doing here.

Anyway, for a project I have to write a proxy that figure out where is located a resource by requesting a database. then figure out if the resource is accessible and them open a proxy connection to download that resource.

I was wandering if there is someone in that mailing list who can review that code and tell me how I can improve things. I know I am not accessing the database the right way but I can't figure out how to work with the Callbacks. 

Any help or advice will be very much appreciated. The code is available here: http://pastebin.com/BGcqzh4Y

-fred-

-- 
http://kiq.me/oi


From glyph at twistedmatrix.com  Tue Mar  2 12:30:37 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 2 Mar 2010 14:30:37 -0500
Subject: [Twisted-Python] PyCon 2010 sprint report
In-Reply-To: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
References: <d06a5cd31003020717i22403b64i464cd3d6d67f6a5e@mail.gmail.com>
Message-ID: <1F2EF899-85FC-4FE6-AB9A-D25B041B1ADE@twistedmatrix.com>

On Mar 2, 2010, at 10:17 AM, Jonathan Lange wrote:

> Residents of the once-great city of Atlanta are only now beginning to piece
> their lives back together after the event that Glyph Lefkowitz described as
> "the best Twisted sprint ever".


This really was a great sprint.

Thanks very much to everyone who attended, and who participated remotely.  Everyone really pitched in to make this what it was.

Thanks especially to you Jonathan, for *both* managing the 10.0 release and writing up this great sprint report.

> Attendees all had immense fun and expressed a desire to have another sprint
> soon. One observed that it had been far too long since giant mecha robot
> warriors descended on Paris.

My Guymelef is in storage on the outskirts of Lyon, but I think I could have it shipped to Paris with a bit of advance notice.

> Twisted prevails,
> jml

Strength through unity.  Unity through IProtocol.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100302/e74127ca/attachment.html>

From glyph at twistedmatrix.com  Tue Mar  2 12:33:11 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 2 Mar 2010 14:33:11 -0500
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <0016e6480da6a3a04c0480d58337@google.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
Message-ID: <F84B6FCB-38EE-4F74-8E9D-3700F5F91D1B@twistedmatrix.com>


On Mar 2, 2010, at 1:27 PM, markscottwright at gmail.com wrote:

> after reading glyph's latest "Twisted in 60 seconds" entry

While I'd love to take credit, as this is an excellent series, these articles are written by Jean-Paul Calderone ("exarkun"), not me! :)


From markscottwright at gmail.com  Tue Mar  2 13:03:08 2010
From: markscottwright at gmail.com (Mark Wright)
Date: Tue, 2 Mar 2010 14:03:08 -0600
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <F84B6FCB-38EE-4F74-8E9D-3700F5F91D1B@twistedmatrix.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<F84B6FCB-38EE-4F74-8E9D-3700F5F91D1B@twistedmatrix.com>
Message-ID: <db986be81003021203s7f9ef869ha470490e5533553b@mail.gmail.com>

Oops!  Sorry.

And, yes - that series is just wonderful.  So clear and well written,
and exactly what I've needed.  Thank you exarkun!

On Tue, Mar 2, 2010 at 1:33 PM, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
>
> On Mar 2, 2010, at 1:27 PM, markscottwright at gmail.com wrote:
>
>> after reading glyph's latest "Twisted in 60 seconds" entry
>
> While I'd love to take credit, as this is an excellent series, these articles are written by Jean-Paul Calderone ("exarkun"), not me! :)
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Mark Wright
markscottwright at gmail.com



From markscottwright at gmail.com  Tue Mar  2 13:07:04 2010
From: markscottwright at gmail.com (Mark Wright)
Date: Tue, 2 Mar 2010 14:07:04 -0600
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <201003021955.49868.maarten@treewalker.org>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
Message-ID: <db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>

On Tue, Mar 2, 2010 at 12:55 PM, Maarten ter Huurne
<maarten at treewalker.org> wrote:
> On Tuesday 02 March 2010, markscottwright at gmail.com wrote:
>
>> I'm using twisted 8.2 and (after reading glyph's latest "Twisted in 60
>> seconds" entry), I've realized that my sessions never expire. I never
>> added any session expiration code, but I thought that the default code
>> expires after 15 minutes.
>>
>> In the below example, I modified twisted\web\server to make
>> Session.sessionTimeout be 30 seconds (I also put a print statement in
>> Session's ctor, as the log shows), then did two GETs separated by more
>> than 30 seconds. As the log shows, it looks like the exact same session
>> uid is being returned. I would expect it to be deleted by
>> Session.expire, since time - lastModifiedTime > 30. Am I missing
>> something?
>
> Maybe you are encountering bug 3458?
>
> http://twistedmatrix.com/trac/ticket/3458
>
> If so, upgrading Twisted would help.
>
> Bye,
>        Maarten

Thanks, that looks like a likely culprit.  Please forgive me if this
is more of a Trac than Twisted question, but how do I go from a trac
ticket to a twisted version number?  It's not clear to me from reading
that ticket if 9.0 is good enough for me, or if I need to pull the svn
tip.

-- 
Mark Wright
markscottwright at gmail.com



From kevin.horn at gmail.com  Tue Mar  2 13:45:23 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Tue, 2 Mar 2010 14:45:23 -0600
Subject: [Twisted-Python] Reverse HTTP proxy code review
In-Reply-To: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>
References: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>
Message-ID: <562bcc11003021245m7bf8eddfl588e3154a1c0150a@mail.gmail.com>

On Tue, Mar 2, 2010 at 1:19 PM, Fred C <fred at bsdhost.net> wrote:

>
> Hello,
>
> I am totally new with Twisted and this the first code I have ever written
> using that package. One of my main problem was to figure out how to fit
> things together and I am not even sure I understand everything I am doing
> here.
>
> Anyway, for a project I have to write a proxy that figure out where is
> located a resource by requesting a database. then figure out if the resource
> is accessible and them open a proxy connection to download that resource.
>
> I was wandering if there is someone in that mailing list who can review
> that code and tell me how I can improve things. I know I am not accessing
> the database the right way but I can't figure out how to work with the
> Callbacks.
>
> Any help or advice will be very much appreciated. The code is available
> here: http://pastebin.com/BGcqzh4Y
>
> -fred-
>
>
I don't really use Twisted for web work, so I don't have much of a comment
on that, but for database access you probably want to use
`twisted.enterprise.adbapi`.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100302/ede6642c/attachment.html>

From fred at bsdhost.net  Tue Mar  2 14:00:07 2010
From: fred at bsdhost.net (Fred C)
Date: Tue, 2 Mar 2010 13:00:07 -0800
Subject: [Twisted-Python] Reverse HTTP proxy code review
In-Reply-To: <562bcc11003021245m7bf8eddfl588e3154a1c0150a@mail.gmail.com>
References: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>
	<562bcc11003021245m7bf8eddfl588e3154a1c0150a@mail.gmail.com>
Message-ID: <6F36A29F-6B8F-4E30-A07A-CCF0C6333F2E@bsdhost.net>


On Mar 2, 2010, at 12:45 PM, Kevin Horn wrote:

> On Tue, Mar 2, 2010 at 1:19 PM, Fred C <fred at bsdhost.net> wrote:
> 
> Hello,
> 
> I am totally new with Twisted and this the first code I have ever written using that package. One of my main problem was to figure out how to fit things together and I am not even sure I understand everything I am doing here.
> 
> Anyway, for a project I have to write a proxy that figure out where is located a resource by requesting a database. then figure out if the resource is accessible and them open a proxy connection to download that resource.
> 
> I was wandering if there is someone in that mailing list who can review that code and tell me how I can improve things. I know I am not accessing the database the right way but I can't figure out how to work with the Callbacks.
> 
> Any help or advice will be very much appreciated. The code is available here: http://pastebin.com/BGcqzh4Y
> 
> -fred-
> 
> 
> I don't really use Twisted for web work, so I don't have much of a comment on that, but for database access you probably want to use `twisted.enterprise.adbapi`.


That was of the thing I know it's wrong with my code. I have to use adbapi and have a call back to get the result from the database. My main problem in that case is I don't know how to have the caller wait for the response from the database.

Thanks for taking time to look at that code and for your reply.

-fred-
http://kiq.me/oi

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100302/377e00a3/attachment.html>

From kevin.horn at gmail.com  Tue Mar  2 14:17:41 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Tue, 2 Mar 2010 15:17:41 -0600
Subject: [Twisted-Python] Reverse HTTP proxy code review
In-Reply-To: <6F36A29F-6B8F-4E30-A07A-CCF0C6333F2E@bsdhost.net>
References: <60B7455B-DDBC-4DEA-9D8B-DF52394DC058@bsdhost.net>
	<562bcc11003021245m7bf8eddfl588e3154a1c0150a@mail.gmail.com>
	<6F36A29F-6B8F-4E30-A07A-CCF0C6333F2E@bsdhost.net>
Message-ID: <562bcc11003021317h605aaea2i73b980cbab567bdc@mail.gmail.com>

On Tue, Mar 2, 2010 at 3:00 PM, Fred C <fred at bsdhost.net> wrote:

>
> On Mar 2, 2010, at 12:45 PM, Kevin Horn wrote:
>
> On Tue, Mar 2, 2010 at 1:19 PM, Fred C <fred at bsdhost.net> wrote:
>
>>
>> Hello,
>>
>> I am totally new with Twisted and this the first code I have ever written
>> using that package. One of my main problem was to figure out how to fit
>> things together and I am not even sure I understand everything I am doing
>> here.
>>
>> Anyway, for a project I have to write a proxy that figure out where is
>> located a resource by requesting a database. then figure out if the resource
>> is accessible and them open a proxy connection to download that resource.
>>
>> I was wandering if there is someone in that mailing list who can review
>> that code and tell me how I can improve things. I know I am not accessing
>> the database the right way but I can't figure out how to work with the
>> Callbacks.
>>
>> Any help or advice will be very much appreciated. The code is available
>> here: http://pastebin.com/BGcqzh4Y
>>
>> -fred-
>>
>>
> I don't really use Twisted for web work, so I don't have much of a comment
> on that, but for database access you probably want to use
> `twisted.enterprise.adbapi`.
>
>
>
> That was of the thing I know it's wrong with my code. I have to use adbapi
> and have a call back to get the result from the database. My main problem in
> that case is I don't know how to have the caller wait for the response from
> the database.
>
> Thanks for taking time to look at that code and for your reply.
>
> -fred-
> http://kiq.me/oi
>
>
>
Have a look at:
http://twistedsphinx.funsize.net/projects/core/howto/rdbms.html#how-do-i-use-adbapi

Basically, when you call runQuery, you get back a deferred object.  You'll
want to add a callback to that using something like:

def get_stuff_from_db():
    d = dbpool.runQuery('Your SQL Here')
    d.addCallback(your_callback_function)

def your_callback_function(results):
    # do some stuff with your results

so when the DB query completes, your_callback_function will get called
automatically by the deferred object.

Obviously this is very rough, probably incorrect code, but hopefully it's
enough to get you started.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100302/59b34011/attachment.html>

From maarten at treewalker.org  Tue Mar  2 16:40:59 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Wed, 3 Mar 2010 00:40:59 +0100
Subject: [Twisted-Python] Does the default session expiry work?
In-Reply-To: <db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
Message-ID: <201003030040.59900.maarten@treewalker.org>

On Tuesday 02 March 2010, Mark Wright wrote:
> On Tue, Mar 2, 2010 at 12:55 PM, Maarten ter Huurne
> <maarten at treewalker.org> wrote:
> > Maybe you are encountering bug 3458?
> > 
> > http://twistedmatrix.com/trac/ticket/3458
> > 
> > If so, upgrading Twisted would help.
> 
> Thanks, that looks like a likely culprit.  Please forgive me if this
> is more of a Trac than Twisted question, but how do I go from a trac
> ticket to a twisted version number?  It's not clear to me from reading
> that ticket if 9.0 is good enough for me, or if I need to pull the svn
> tip.

I don't know of a guaranteed algorithm to find out in which release a fix is 
included. If someone knows, please enlighten me. I think SVN does not make 
this easy, since it copies changes around instead of linking to the original 
patch.

Some searching turns up the following though:

tags / releases / twisted-8.2.0 was created 2008-12-28
tags / releases / twisted-9.0.0 was created 2009-11-25

Jean-Paul merged the fix for ticket #3458 to trunk in revision r26133, which 
was committed 2009-01-28. So I would expect 9.0.0 to be the first release 
with the fix.

Bye,
		Maarten



From wthie at thiengineering.ch  Wed Mar  3 11:56:38 2010
From: wthie at thiengineering.ch (Werner Thie)
Date: Wed, 03 Mar 2010 19:56:38 +0100
Subject: [Twisted-Python] twisted xmpp-router component interface problem
In-Reply-To: <201003030040.59900.maarten@treewalker.org>
References: <0016e6480da6a3a04c0480d58337@google.com>	<201003021955.49868.maarten@treewalker.org>	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
	<201003030040.59900.maarten@treewalker.org>
Message-ID: <4B8EB0E6.10400@thiengineering.ch>

Hi

Starting twistd xmpp-router and trying to connect to it with a component 
from the wokkel examples

"""
An XMPP Ping server as an external server-side component.

This ping server assumes the domain C{'ping'}.
"""
import sys

from twisted.python import log
from twisted.application import app, service, internet
from twisted.internet import reactor

from wokkel import component
from wokkel.ping import PingHandler

# Configuration parameters
EXT_HOST = 'localhost'
EXT_PORT = 5347
SECRET = 'secret'
DOMAIN = 'ping'
LOG_TRAFFIC = True

# Set up the Twisted application
application = service.Application("Ping Component")

router = component.Router()
pingComponent = component.Component(EXT_HOST, EXT_PORT, DOMAIN, SECRET)
pingComponent.logTraffic = LOG_TRAFFIC
pingComponent.setServiceParent(application)

pingHandler = PingHandler()
pingHandler.setHandlerParent(pingComponent)

produces the following traceback:

2010-03-03 19:24:28+0100 [XmlStream,0,127.0.0.1] Unhandled Error
         Traceback (most recent call last):
           File 
"\proj\Python-2.5.2\stackless-2.5.2-r63812\Modules\pyexpat.c", line 656, 
in EndElement
             ("(N)", string_intern(self, name)))
           File "C:\proj\twisted\twisted\words\xish\domish.py", line 
797, in _onEndElement
             self.ElementEvent(self.currElem)
           File "C:\proj\twisted\twisted\words\xish\xmlstream.py", line 
107, in onElement
             self.dispatch(element)
           File "C:\proj\twisted\twisted\words\xish\utility.py", line 
317, in dispatch
             callbacklist.callback(obj)
         --- <exception caught here> ---
           File "C:\proj\twisted\twisted\words\xish\utility.py", line 
107, in callback
             methodwrapper(*args, **kwargs)
           File "C:\proj\twisted\twisted\words\xish\utility.py", line 
27, in __call__
             self.method(*nargs, **nkwargs)
           File 
"C:\proj\twisted\twisted\words\protocols\jabber\component.py", line 171, 
in onElement
             self.onHandshake(unicode(element))
           File 
"C:\proj\twisted\twisted\words\protocols\jabber\component.py", line 187, 
in onHandshake
             unicode(self.secret))
           File 
"C:\proj\twisted\twisted\words\protocols\jabber\xmlstream.py", line 52, 
in hashPassword
             raise TypeError("The session identifier must be a unicode 
object")
         exceptions.TypeError: The session identifier must be a unicode 
object

After some fiddling around it seems that the code at line 282 in 
twisted\words\protocols\jabber\xmlstream.py presets the sid of the 
stream to a str instead of a unicode(str). After changing line 282
from

self.xmlstream.sid = randbytes.secureRandom(8).encode('hex')

to

self.xmlstream.sid = unicode(randbytes.secureRandom(8).encode('hex'))

everything works as advertised.

Is there somebody around who could tell me what to do with this fix, I'm 
certainly a beginner diddling with XMPP.

Thanks a bunch, Werner





From drew.smathers at gmail.com  Wed Mar  3 12:32:39 2010
From: drew.smathers at gmail.com (Drew Smathers)
Date: Wed, 3 Mar 2010 14:32:39 -0500
Subject: [Twisted-Python] twisted xmpp-router component interface problem
In-Reply-To: <4B8EB0E6.10400@thiengineering.ch>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
	<201003030040.59900.maarten@treewalker.org>
	<4B8EB0E6.10400@thiengineering.ch>
Message-ID: <368574aa1003031132w5b11e626l74becd71f3b89588@mail.gmail.com>

On Wed, Mar 3, 2010 at 1:56 PM, Werner Thie <wthie at thiengineering.ch> wrote:

> Hi
>
> Starting twistd xmpp-router and trying to connect to it with a component
> from the wokkel examples
>
> """
> An XMPP Ping server as an external server-side component.
>
> This ping server assumes the domain C{'ping'}.
> """
> import sys
>
> from twisted.python import log
> from twisted.application import app, service, internet
> from twisted.internet import reactor
>
> from wokkel import component
> from wokkel.ping import PingHandler
>
> # Configuration parameters
> EXT_HOST = 'localhost'
> EXT_PORT = 5347
> SECRET = 'secret'
> DOMAIN = 'ping'
> LOG_TRAFFIC = True
>
> # Set up the Twisted application
> application = service.Application("Ping Component")
>
> router = component.Router()
> pingComponent = component.Component(EXT_HOST, EXT_PORT, DOMAIN, SECRET)
> pingComponent.logTraffic = LOG_TRAFFIC
> pingComponent.setServiceParent(application)
>
> pingHandler = PingHandler()
> pingHandler.setHandlerParent(pingComponent)
>
> produces the following traceback:
>
> 2010-03-03 19:24:28+0100 [XmlStream,0,127.0.0.1] Unhandled Error
>         Traceback (most recent call last):
>           File
> "\proj\Python-2.5.2\stackless-2.5.2-r63812\Modules\pyexpat.c", line 656,
> in EndElement
>             ("(N)", string_intern(self, name)))
>           File "C:\proj\twisted\twisted\words\xish\domish.py", line
> 797, in _onEndElement
>             self.ElementEvent(self.currElem)
>           File "C:\proj\twisted\twisted\words\xish\xmlstream.py", line
> 107, in onElement
>             self.dispatch(element)
>           File "C:\proj\twisted\twisted\words\xish\utility.py", line
> 317, in dispatch
>             callbacklist.callback(obj)
>         --- <exception caught here> ---
>           File "C:\proj\twisted\twisted\words\xish\utility.py", line
> 107, in callback
>             methodwrapper(*args, **kwargs)
>           File "C:\proj\twisted\twisted\words\xish\utility.py", line
> 27, in __call__
>             self.method(*nargs, **nkwargs)
>           File
> "C:\proj\twisted\twisted\words\protocols\jabber\component.py", line 171,
> in onElement
>             self.onHandshake(unicode(element))
>           File
> "C:\proj\twisted\twisted\words\protocols\jabber\component.py", line 187,
> in onHandshake
>             unicode(self.secret))
>           File
> "C:\proj\twisted\twisted\words\protocols\jabber\xmlstream.py", line 52,
> in hashPassword
>             raise TypeError("The session identifier must be a unicode
> object")
>         exceptions.TypeError: The session identifier must be a unicode
> object
>
> After some fiddling around it seems that the code at line 282 in
> twisted\words\protocols\jabber\xmlstream.py presets the sid of the
> stream to a str instead of a unicode(str). After changing line 282
> from
>
> self.xmlstream.sid = randbytes.secureRandom(8).encode('hex')
>
> to
>
> self.xmlstream.sid = unicode(randbytes.secureRandom(8).encode('hex'))
>
> everything works as advertised.
>
> Is there somebody around who could tell me what to do with this fix, I'm
> certainly a beginner diddling with XMPP.
>
> Thanks a bunch, Werner
>
>
>

Hello Werner,

I do not know anything about twisted.words, but you should file a bug report
in trac:

http://twistedmatrix.com/trac/report

Just out of curiosity, I did look at xmlstream and the whole unicode type
checking seems unnecessary considering how the values are used:

input = u"%s%s" % (sid, password)

Why sid and password have to be unicode objects and not just basestring
beats me.

-Drew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100303/f0405a22/attachment.html>

From twisted at ralphm.ik.nu  Wed Mar  3 14:25:56 2010
From: twisted at ralphm.ik.nu (Ralph Meijer)
Date: Wed, 03 Mar 2010 22:25:56 +0100
Subject: [Twisted-Python] twisted xmpp-router component interface problem
In-Reply-To: <368574aa1003031132w5b11e626l74becd71f3b89588@mail.gmail.com>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
	<201003030040.59900.maarten@treewalker.org>
	<4B8EB0E6.10400@thiengineering.ch>
	<368574aa1003031132w5b11e626l74becd71f3b89588@mail.gmail.com>
Message-ID: <1267651556.5856.20.camel@dwaal>

On Wed, 2010-03-03 at 14:32 -0500, Drew Smathers wrote:
> On Wed, Mar 3, 2010 at 1:56 PM, Werner Thie <wthie at thiengineering.ch>
> wrote:
> [..]
>
>         After some fiddling around it seems that the code at line 282
>         in
>         twisted\words\protocols\jabber\xmlstream.py presets the sid of
>         the
>         stream to a str instead of a unicode(str).

Yes, this is a problem I noticed the other day as well. A ticket,
assigned to me, is in order.

> Just out of curiosity, I did look at xmlstream and the whole unicode
> type checking seems unnecessary considering how the values are used:
>
> input = u"%s%s" % (sid, password)
>
> Why sid and password have to be unicode objects and not just
> basestring beats me.

For the gory details, see http://twistedmatrix.com/trac/ticket/3847. The
short version is that digest authentication requires UTF-8 encoded input
and GTK sets Python's default encoding to UTF-8. Before these checks,
using non-ASCII characters in passwords would fail in some cases. As
both the session id and password can use the full range of unicode, it
makes sense to require that explicitly.

ralphm





From twisted at ralphm.ik.nu  Wed Mar  3 14:44:29 2010
From: twisted at ralphm.ik.nu (Ralph Meijer)
Date: Wed, 03 Mar 2010 22:44:29 +0100
Subject: [Twisted-Python] twisted xmpp-router component interface problem
In-Reply-To: <1267651556.5856.20.camel@dwaal>
References: <0016e6480da6a3a04c0480d58337@google.com>
	<201003021955.49868.maarten@treewalker.org>
	<db986be81003021207m77a32ff2m3f26cb58c1588411@mail.gmail.com>
	<201003030040.59900.maarten@treewalker.org>
	<4B8EB0E6.10400@thiengineering.ch>
	<368574aa1003031132w5b11e626l74becd71f3b89588@mail.gmail.com>
	<1267651556.5856.20.camel@dwaal>
Message-ID: <1267652669.5856.22.camel@dwaal>

On Wed, 2010-03-03 at 22:25 +0100, Ralph Meijer wrote:
> On Wed, 2010-03-03 at 14:32 -0500, Drew Smathers wrote:
> > On Wed, Mar 3, 2010 at 1:56 PM, Werner Thie <wthie at thiengineering.ch>
> > wrote:
> > [..]
> >
> >         After some fiddling around it seems that the code at line 282
> >         in
> >         twisted\words\protocols\jabber\xmlstream.py presets the sid of
> >         the
> >         stream to a str instead of a unicode(str).
> 
> Yes, this is a problem I noticed the other day as well. A ticket,
> assigned to me, is in order.

I created http://twistedmatrix.com/trac/ticket/4345 for this.

ralphm




From jml at mumak.net  Wed Mar  3 16:25:36 2010
From: jml at mumak.net (Jonathan Lange)
Date: Wed, 3 Mar 2010 23:25:36 +0000
Subject: [Twisted-Python] Twisted 10.0.0 released
Message-ID: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>

On behalf of Twisted Matrix Laboratories, I am honored to announce the
release of Twisted 10.0.

Highlights include:

 * Improved documentation, including "Twisted Web in 60 seconds"

 * Faster Perspective Broker applications

 * A new Windows installer that ships without zope.interface

 * Twisted no longer supports Python 2.3

 * Over one hundred closed tickets

For more information, see the NEWS file.

It's stable, backwards compatible, well tested and in every way an
improvement. Download it now from:

 http://tmrc.mit.edu/mirror/twisted/Twisted/10.0/Twisted-10.0.0.tar.bz2 or
 http://tmrc.mit.edu/mirror/twisted/Twisted/10.0/Twisted-10.0.0.win32-py2.5.msi

Many thanks to Jean-Paul Calderone and Chris Armstrong, whose work on
release automation tools and answers to numerous questions made this
possible. Thanks also to the supporters of the Twisted Software
Foundation and to the many contributors for this release.

jml



From matusis at yahoo.com  Wed Mar  3 18:08:03 2010
From: matusis at yahoo.com (Alec Matusis)
Date: Wed, 3 Mar 2010 17:08:03 -0800
Subject: [Twisted-Python] debugging a memory leak
In-Reply-To: <20100226005059.2792.1034517271.divmod.xquotient.93@localhost.localdomain>
References: <01a701cab1b6$3a039d00$ae0ad700$@com>	<4B7F284B.70801@thiengineering.ch>	<007601cab42a$d4c755e0$7e5601a0$@com>	<201002230324.24883.maarten@treewalker.org>	<007401cab44a$42294160$c67bc420$@com>	<4B838615.8060205@thiengineering.ch>	<005701cab59c$548fdb40$fdaf91c0$@com>	<4B8722BD.2060900@densedata.com>
	<20100226005059.2792.1034517271.divmod.xquotient.93@localhost.localdomain>
Message-ID: <00a001cabb37$24787570$6d696050$@com>

It turns out that the situation described in my last email, where the server
buffers strings due to the socket Send-Q saturation never arises in our
production system, it was an artifact of high load testing in the lab
environment.

I "fixed" the memory leak, and I still do not understand what caused it. The
code looked like this:

File protocols.py:

class MyProtocol(twisted.protocols.basic.LineOnlyReceiver):

    def lineReceived(self, line):
        def login_cb(session):
            self.session = session

        #this deferred chain creates an instance of Session in the end
        d = self.factory.service.login_deferred(Callback(self), line)
        d.addErrback(twisted.python.log.err)
        #adds some properties to the session instance
        d.addCallback(self.factory.service.authenticate)
        d.addErrback(twisted.python.log.err)
        d.addCallback(login_cb)
        d.addErrback(twisted.python.log.err)

class Callback:
    def __init__(self, protocol):
        self.protocol = protocol

File service.py (protocol.factory.service):

class Session:
    def __init__(self, service, callback):
        self.callback = callback
        self.service = service

    def do_something_asynchronous(self):
        #this function creates MEMORY LEAK
        def cb(result):
            self.some_property = result
            return self

        d = some_asynch_operation()
        d.addCallback(cb)
        d.addErrback(twisted.python.log.err)

class Service:

    def login_deferred(self, callback, line):

        def cb(result):
            s = Session(self, callback)
            return s

        d = asynch_operation(line)
        d.addCallback(cb)
        d.addErrback(twisted.python.log.err)
        return d

    def authenticate(self, session):
        #the deferred below caused the MEMORY LEAK
        #when its code was moved into here from
Session.do_something_asynchronous
        #the leak disappered
        d = session.do_something_asynchronous()
        return d

The problem was in the function Session.do_something_asynchronous , that
returned the instance of its class.
Interestingly, even though this was causing an unbounded memory leak visible
from the OS, the number of objects tracked by garbage collector
len(gc.get_objects()) remained stable, and also none of the objects that had
len() were getting too long. Nothing could be seen by Heapy either,
When I removed this function, and moved its code into Service.authenticate,
the memory stabilized. I still do not quite understand why, I was just
acting on the intuition that when a function returns its class instance, it
could create a reference cycle.

After the removal of this function, the server exhibits the following
behavior: when it starts and after all clients connect and it reaches its
average load, the memory stays at 350MB for about 1.5hrs. Then it suddenly
jumps to 650MB, and stays there. Since at 350MB the server already serves
the maximum number of connection (and is operating at its normal load), I
think that the jump to 650MB is caused by some additional memory leak.
Could there be anything wrong with this code pattern, where I launch
deferreds from other deferreds (e.g. my function Service.login_deferred ,
which itself is a part of a deferred chain, launches another deferred
function cb() within itself)?

Also this code has the following reference cycle: protocol.session ->
session.callback.protocol. This cycle existed in the code for a long time
and never caused unbounded memory, even though the server creates 100 of
Session()s per sec, and they seem to be always garbage-collected (by
inspecting gc.get_objects()), even with python 2.4 before the improvements
of the cyclical garbage collector.

> -----Original Message-----
> From: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-
> bounces at twistedmatrix.com] On Behalf Of exarkun at twistedmatrix.com
> Sent: Thursday, February 25, 2010 4:51 PM
> To: Twisted general discussion
> Subject: Re: [Twisted-Python] debugging a memory leak
> 
> On 01:24 am, johann.borck at densedata.com wrote:
> >Alec Matusis wrote:
> >>In desperation of not finding the real memory leak on the production
> >>server,
> >>
> >>I wrote a test server that I can push to arbitrary high RSS memory. I
> >>am far
> >>from sure if this the same leak that I observe in production, but I
> >>would
> >>like to understand what this one is.
> >>This is the server code:
> >>
> >>Server.py:
> >>
> >>import twisted.protocols.basic
> >>from twisted.internet.protocol import Factory
> >>from twisted.internet import reactor
> >>
> >>class HiRate(twisted.protocols.basic.LineOnlyReceiver):
> >>         MAX_LENGTH = 20000
> >>
> >>         def lineReceived(self, line):
> >>                 if line == 'get':
> >>                         out = 'a'*4000+'\r\r'
> >>                         self.transport.write(out)
> >>
> >>
> >>
> >>factory = Factory()
> >>factory.protocol = HiRate
> >>
> >>reactor.listenTCP(8007, factory, backlog=50, interface='10.18.0.2')
> >>reactor.run()
> >>[...]
> >>To reproduce the memory leak, I either need two machines with fast LAN
> >>between them (since the client program takes 100% CPU), or possibly
> >>one
> >>machine with a dual core CPU (I have not tried that). It is important
> >>that
> >>client.py is given a separate CPU to run.
> >>When the length of the response from the server is sufficient,  (out =
> >>'a'*4000+'\r\r' ,  4000 is enough in my case), the RSS of the server
> >>process
> >>starts to leak without a bound.
> >>If you introduce a small delay in the client (#time.sleep(.001)), the
> >>leak
> >>does not occur.
> >Hi Alec,
> >I wouldn't call that a memory leak. In your example  ( SC/s = (n* CS) /
> >s ;  n > 1, SC: bytes sent to the client, CS: bytes sent to the server
> >)
> >there is some CS that satifies the condition SC/s > [available
> >bandwidth]. For all CS that exceed that limit, the data will be first
> >queued in the Send-Q of the socket and then inside twisted, because the
> >Send-Q is full. That's the reason why you see increasing memory usage,
> >but it's not a leak, it is a server that can not cope with this kind of
> >DOS attack. Twisted can not handle this situation for you because that
> >would mean it had to decide which packets, connections, etc. to drop.
> >Such decisions have to be made by your application.
> 
> You can get notifications about when your send buffers are full by
> registering a producer with the transport.
> http://twistedmatrix.com/documents/current/core/howto/producers.html
> describes the APIs involved.  This will help you make these decisions in
> your application.
> 
> Jean-Paul
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From bs1984 at gmail.com  Wed Mar  3 21:46:33 2010
From: bs1984 at gmail.com (Bo Shi)
Date: Wed, 3 Mar 2010 23:46:33 -0500
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
Message-ID: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>

Hi All,

I've been struggling with this issue off and on for the better part of
a month now.  Having implemented a simple git SSH server using some of
the Conch examples in the official documentation, I encountered an
issue that would cause a git client to throw an error only part of the
time.

The little program to reproduce the issue is found at

    http://gist.github.com/321403

    (raw version for download)
    http://gist.github.com/raw/321403/82ab2111a2709c8fe50a77aabb08565749087408/gitconnbug.py

and can be executed to start the sample server.  Run a command like

    # The /abspath/to/git/repo should be readable by the server user
    $ git clone ssh://user at localhost:2222/abspath/to/git/repo
    (password "user")

To test the server.  On my workstation, I am able to reproduce the
error at least once every 5 tries.  It's definitely not consistent.
The behavior I see is attached at the end of this email.  The client
fails due to a premature inConnectionLost() call in the
SSHSessionProcessProtocol that sends an EOF.


As a workaround, when TraceProcessProtocol.inConnectionLost() is
overriden to do nothing, the client error goes away.  This is somewhat
foreign territory for me so I'm not sure whether it's a bug in git or
whether it's a bug in the twisted ProcessProtocol implementation.  RFC
4254 isn't terribly helpful here:

    5.3.  Closing a Channel

       When a party will no longer send more data to a channel, it SHOULD
       send SSH_MSG_CHANNEL_EOF.

So on the surface the current behavior of sending an EOF appears fine,
however, I can't really find any definitive cases of this type of
problem popping up via, say, default OpenSSH/git combinations.


Any advice?  Is the gitconnbug.py implementation flawed?  Should I
open a ticket?  Any git experts know of a case where git-upload-pack
might close it's stdout pipe?


Thanks,
Bo


Successful case (server side logging, timestamp cut out):

    [SSHChannel session (0) on SSHService ssh-connection
    on SSHServerTransport,1,127.0.0.1] executing command
    "git-upload-pack '/Users/bshi/sandbox/poop'"
    [-] TPP.outReceived(...) 199 bytes
    [-] TPP.outReceived(...) 146 bytes
    [-] TPP.outReceived(...) 8 bytes
    [-] TPP.outReceived(...) 33 bytes
    [-] TPP.outReceived(...) 41 bytes
    [-] TPP.outReceived(...) 77 bytes
    [-] TPP.outReceived(...) 1228 bytes
    [-] TPP.outReceived(...) 8192 bytes
    [-] TPP.outReceived(...) 4567 bytes
    [-] TPP.inConnectionLost()
    [-] sending eof
    [-] exitCode: 0

Successful case (client-side shell session):

    $ GIT_TRACE=1 git clone ssh://user at localhost:2222/Users/bshi/sandbox/poop

    trace: built-in: git 'clone'
'ssh://user at localhost:2222/Users/bshi/sandbox/poop'
    Initialized empty Git repository in /tmp/poop/.git/
    trace: run_command: 'ssh' '-p' '2222' 'user at localhost' 'git-upload-pack
           '\''/Users/bshi/sandbox/poop'\'''
    user at localhost's password:
    trace: run_command: 'index-pack' '--stdin' '-v' '--fix-thin'
                        '--keep=fetch-pack 763 on Bo-Shis-MacBook-Pro.local'
    trace: exec: 'git' 'index-pack' '--stdin' '-v' '--fix-thin'
                 '--keep=fetch-pack 763 on Bo-Shis-MacBook-Pro.local'
    trace: exec: 'git-index-pack' '--stdin' '-v' '--fix-thin'
                 '--keep=fetch-pack 763 on Bo-Shis-MacBook-Pro.local'
    trace: run_command: 'git-index-pack' '--stdin' '-v' '--fix-thin'
                        '--keep=fetch-pack 763 on Bo-Shis-MacBook-Pro.local'
    remote: Counting objects: 50, done.
    remote: Compressing objects: 100% (35/35), done.
    remote: Total 50 (delta 16), reused 43 (delta 14)
    Receiving objects: 100% (50/50), 12.36 KiB, done.
    Resolving deltas: 100% (16/16), done.

Failure case (server side):

    [SSHChannel session (0) on SSHService ssh-connection
    on SSHServerTransport,2,127.0.0.1] executing command
    "git-upload-pack '/Users/bshi/sandbox/poop'"
    [-] TPP.outReceived(...) 345 bytes
    [-] TPP.outReceived(...) 8 bytes
    [-] TPP.outReceived(...) 33 bytes
    [-] TPP.outReceived(...) 8192 bytes
    [-] TPP.inConnectionLost()
    [-] sending eof
    [-] TPP.outReceived(...) 5903 bytes
    [-] exitCode: 0
    [-] sending request exit-status
    [-] sending close 0


Failure case ("trace:" messages similar, cut out for readability):

    $ GIT_TRACE=1 git clone ssh://user at localhost:2222/Users/bshi/sandbox/poop
    user at localhost's password:
    ...
    ...
    remote: Counting objects: 50, done.
    fatal: The remote end hung up unexpectedly
    fatal: early EOF
    fatal: index-pack failed



From chris at simplistix.co.uk  Thu Mar  4 01:37:49 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 04 Mar 2010 08:37:49 +0000
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>
Message-ID: <4B8F715D.6020107@simplistix.co.uk>

Jonathan Lange wrote:
>  * A new Windows installer that ships without zope.interface

Interesting, why?
Is zope.interface not used/required anymore?
If so, why is it shipping in the non-windows version?

FWIW, zope.interface:
- has binaries available for windows
- has pure python fall-backs for when no binaries are available, 
regardless of platform (ie: GAE)

cheers,

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
            - http://www.simplistix.co.uk



From m.van.lent at zestsoftware.nl  Thu Mar  4 03:45:41 2010
From: m.van.lent at zestsoftware.nl (Mark van Lent)
Date: Thu, 4 Mar 2010 11:45:41 +0100
Subject: [Twisted-Python] Twisted 9.0.0?
Message-ID: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>

Hi everyone!

I am a bit puzzled about the way new version of Twisted is released. Or better: the way the old version seems to be taken out of service.

Last weeks I've been developing agains version Twisted 9.0.0. Yesterday I wanted to deploy my code to my production server, but to my surprise I could not easy_install that version anymore:

$ easy_install Twisted==9.0.0
Searching for Twisted==9.0.0
Reading http://pypi.python.org/simple/Twisted/
Reading http://www.twistedmatrix.com
Reading http://twistedmatrix.com/products/download
Reading http://twistedmatrix.com/projects/core/
Reading http://twistedmatrix.com/
No local packages or download links found for Twisted==9.0.0
Best match: None

(Okay, actually I'm using buildout to setup my environment, but the above demonstrates my problem more clearly.)

I'm sure the new version of Twisted is better and improved but I still wonder why version 9.0.0 has effectively been decommissioned. Or am I missing something and is it still possible to easy_install version 9.0.0?

Thanks,
Mark

-- 
Mark van Lent
m.van.lent at zestsoftware.nl

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100304/df77f5df/attachment.html>

From jml at mumak.net  Thu Mar  4 05:59:17 2010
From: jml at mumak.net (Jonathan Lange)
Date: Thu, 4 Mar 2010 12:59:17 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
Message-ID: <d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>

On Thu, Mar 4, 2010 at 10:45 AM, Mark van Lent
<m.van.lent at zestsoftware.nl> wrote:
> Hi everyone!
> I am a bit puzzled about the way new version of Twisted is released. Or
> better: the way the old version seems to be taken out of service.
> Last weeks I've been developing agains version Twisted 9.0.0. Yesterday I
> wanted to deploy my code to my production server, but to my surprise I could
> not easy_install that version anymore:
> $ easy_install Twisted==9.0.0
> Searching for Twisted==9.0.0
> Readinghttp://pypi.python.org/simple/Twisted/
> Readinghttp://www.twistedmatrix.com
> Readinghttp://twistedmatrix.com/products/download
> Readinghttp://twistedmatrix.com/projects/core/
> Readinghttp://twistedmatrix.com/
> No local packages or download links found for Twisted==9.0.0
> Best match: None
> (Okay, actually I'm using buildout to setup my environment, but the above
> demonstrates my problem more clearly.)
> I'm sure the new version of Twisted is better and improved but I still
> wonder why version 9.0.0 has effectively been decommissioned. Or am I
> missing something and is it still possible to easy_install version 9.0.0?

It's an oversight.

I don't know how the PyPI announcement was done (although I'd love
to!), but I think you can announce new versions without
decommissioning old ones.

As for the twistedmatrix.com website, I can fix that so that 9.0.0 is
easy-installable, but I don't know how. Let me know & I'll get it
done.

jml



From exarkun at twistedmatrix.com  Thu Mar  4 06:52:24 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 13:52:24 -0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
Message-ID: <20100304135224.2792.183209342.divmod.xquotient.502@localhost.localdomain>

On 10:45 am, m.van.lent at zestsoftware.nl wrote:
>Hi everyone!
>
>I am a bit puzzled about the way new version of Twisted is released. Or 
>better: the way the old version seems to be taken out of service.
>
>Last weeks I've been developing agains version Twisted 9.0.0. Yesterday 
>I wanted to deploy my code to my production server, but to my surprise 
>I could not easy_install that version anymore:
>
>$ easy_install Twisted==9.0.0
>Searching for Twisted==9.0.0
>Reading http://pypi.python.org/simple/Twisted/
>Reading http://www.twistedmatrix.com
>Reading http://twistedmatrix.com/products/download
>Reading http://twistedmatrix.com/projects/core/
>Reading http://twistedmatrix.com/
>No local packages or download links found for Twisted==9.0.0
>Best match: None
>
>(Okay, actually I'm using buildout to setup my environment, but the 
>above demonstrates my problem more clearly.)
>
>I'm sure the new version of Twisted is better and improved but I still 
>wonder why version 9.0.0 has effectively been decommissioned. Or am I 
>missing something and is it still possible to easy_install version 
>9.0.0?

Decommissioned?  Not really.  There is a link to older releases at the 
top of <http://twistedmatrix.com/trac/wiki/Downloads>.  You can find 
releases going all the way back to 2.0 there.

Perhaps easy_install isn't the best way to manage deployments to your 
production server?

Jean-Paul



From exarkun at twistedmatrix.com  Thu Mar  4 07:05:37 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 14:05:37 -0000
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <4B8F715D.6020107@simplistix.co.uk>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>
	<4B8F715D.6020107@simplistix.co.uk>
Message-ID: <20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>

On 08:37 am, chris at simplistix.co.uk wrote:
>Jonathan Lange wrote:
>>  * A new Windows installer that ships without zope.interface
>
>Interesting, why?

The installer is now built using bdist_msi.  If there's a way to bundle 
zope.interface in the MSI, then this might be interesting to pursue.

Also, I'm pretty sure that the 9.0 Windows installer _also_ didn't 
include zope.interface.  So this isn't a new situation with 10.0.
>Is zope.interface not used/required anymore?
>If so, why is it shipping in the non-windows version?

It doesn't ship in any of the packages for other platforms, either (nor 
do any of our other external dependencies).

Jean-Paul



From glyph at twistedmatrix.com  Thu Mar  4 09:31:33 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 4 Mar 2010 11:31:33 -0500
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
Message-ID: <422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>


On Mar 4, 2010, at 7:59 AM, Jonathan Lange wrote:
> On Thu, Mar 4, 2010 at 10:45 AM, Mark van Lent
> <m.van.lent at zestsoftware.nl> wrote:
>> Hi everyone!
>> I am a bit puzzled about the way new version of Twisted is released. Or
>> better: the way the old version seems to be taken out of service.
>> Last weeks I've been developing agains version Twisted 9.0.0. Yesterday I
>> wanted to deploy my code to my production server, but to my surprise I could
>> not easy_install that version anymore:
>> $ easy_install Twisted==9.0.0
>> Searching for Twisted==9.0.0
>> Reading http://pypi.python.org/simple/Twisted/
>> Reading http://www.twistedmatrix.com
>> Reading http://twistedmatrix.com/products/download
>> Reading http://twistedmatrix.com/projects/core/
>> Reading http://twistedmatrix.com/
>> No local packages or download links found for Twisted==9.0.0
>> Best match: None
>> (Okay, actually I'm using buildout to setup my environment, but the above
>> demonstrates my problem more clearly.)
>> I'm sure the new version of Twisted is better and improved but I still
>> wonder why version 9.0.0 has effectively been decommissioned. Or am I
>> missing something and is it still possible to easy_install version 9.0.0?
> 
> It's an oversight.

I think it's actually a bug in easy_install, or at least a mis-design.

To make something easy_installable, you don't provide structured information in PyPI; there may be a way to do that, but most packages I've seen (Twisted included) just provide a link to a page which then provides a link to a file with a filename of vaguely the appropriate shape.  easy_install works by screen-scraping that link.

In our case, the "home page", http://twistedmatrix.com, links directly to a Twisted-<version>.tar.bz2, which is then used.

If someone (perhaps Mark van Lent!) could point us at how to provide the correctly structured information to easy_install via PyPI so it will _stop_ screen-scraping our website, and just point at the correct files, this problem could be addressed.

However, as exarkun says: screen-scraping a plain-text wiki and then executing code out of whatever comes out of it is not the most reliable or secure way to deploy code.  You may want to specify the URL directly - you can still use easy_install for that if you want, like this:

    $ easy_install http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/Twisted-9.0.0.tar.bz2

> I don't know how the PyPI announcement was done (although I'd love to!), but I think you can announce new versions without decommissioning old ones.


I assume you'll write it down on a web page, when you figure it out :).

The old version, from PyPI's perspective, wasn't decommissioned.  It's here: <http://pypi.python.org/pypi/Twisted/9.0.0>.  The problem is that it also just points at twistedmatrix.com, not a version-specific download page, and there is no Twisted-<version>.tar.bz2 which matches "9.0.0" any more.

(I believe that another way to fix this, although I would be significantly less happy about it, would be to add some hidden links to twistedmatrix.com that had the right filenames.  If this is a real problem for many users though, perhaps we should just live with an ugly fix.)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100304/aa5a971a/attachment.html>

From kevin.horn at gmail.com  Thu Mar  4 09:53:17 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 4 Mar 2010 10:53:17 -0600
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
Message-ID: <562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>

On Thu, Mar 4, 2010 at 10:31 AM, Glyph Lefkowitz <glyph at twistedmatrix.com>wrote:

>
> On Mar 4, 2010, at 7:59 AM, Jonathan Lange wrote:
>
> On Thu, Mar 4, 2010 at 10:45 AM, Mark van Lent
> <m.van.lent at zestsoftware.nl> wrote:
>
> Hi everyone!
>
> I am a bit puzzled about the way new version of Twisted is released. Or
>
> better: the way the old version seems to be taken out of service.
>
> Last weeks I've been developing agains version Twisted 9.0.0. Yesterday I
>
> wanted to deploy my code to my production server, but to my surprise I
> could
>
> not easy_install that version anymore:
>
> $ easy_install Twisted==9.0.0
>
> Searching for Twisted==9.0.0
>
> Reading http://pypi.python.org/simple/Twisted/
>
> Reading http://www.twistedmatrix.com
>
> Reading http://twistedmatrix.com/products/download
>
> Reading http://twistedmatrix.com/projects/core/
>
> Reading http://twistedmatrix.com/
>
> No local packages or download links found for Twisted==9.0.0
>
> Best match: None
>
> (Okay, actually I'm using buildout to setup my environment, but the above
>
> demonstrates my problem more clearly.)
>
> I'm sure the new version of Twisted is better and improved but I still
>
> wonder why version 9.0.0 has effectively been decommissioned. Or am I
>
> missing something and is it still possible to easy_install version 9.0.0?
>
>
> It's an oversight.
>
>
> I think it's actually a bug in easy_install, or at least a mis-design.
>
> To make something easy_installable, you don't provide structured
> information in PyPI; there may be a way to do that, but most packages I've
> seen (Twisted included) just provide a link to a page which then provides a
> link to a file with a filename of vaguely the appropriate shape.
>  easy_install works by screen-scraping that link.
>
> In our case, the "home page", http://twistedmatrix.com, links directly to
> a Twisted-<version>.tar.bz2, which is then used.
>
> If someone (perhaps Mark van Lent!) could point us at how to provide the
> correctly structured information to easy_install via PyPI so it will _stop_
> screen-scraping our website, and just point at the correct files, this
> problem could be addressed.
>
> However, as exarkun says: screen-scraping a plain-text wiki and then
> executing code out of whatever comes out of it is not the most reliable or
> secure way to deploy code.  You may want to specify the URL directly - you
> can still use easy_install for that if you want, like this:
>
>     $ easy_install
> http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/Twisted-9.0.0.tar.bz2
>
> I don't know how the PyPI announcement was done (although I'd love to!),
> but I think you can announce new versions without decommissioning old ones.
>
>
> I assume you'll write it down on a web page, when you figure it out :).
>
> The old version, from PyPI's perspective, wasn't decommissioned.  It's
> here: <http://pypi.python.org/pypi/Twisted/9.0.0>.  The problem is that it
> also just points at twistedmatrix.com, not a version-specific download
> page, and there is no Twisted-<version>.tar.bz2 which matches "9.0.0" any
> more.
>
> (I believe that another way to fix this, although I would be significantly
> less happy about it, would be to add some hidden links to
> twistedmatrix.com that had the right filenames.  If this is a real problem
> for many users though, perhaps we should just live with an ugly fix.)
>
>
Is there any particular reason Twisted doesn't upload packages to PyPI
itself?

Kevin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100304/9ccf3ed1/attachment-0001.html>

From exarkun at twistedmatrix.com  Thu Mar  4 10:27:37 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 17:27:37 -0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
Message-ID: <20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>

On 04:53 pm, kevin.horn at gmail.com wrote:
>
>Is there any particular reason Twisted doesn't upload packages to PyPI
>itself?

Messing about with web forms is no fun and "setup.py register" has 
issues.

Jean-Paul



From chris at simplistix.co.uk  Thu Mar  4 11:44:07 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 04 Mar 2010 18:44:07 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
Message-ID: <4B8FFF77.4030400@simplistix.co.uk>

exarkun at twistedmatrix.com wrote:
> On 04:53 pm, kevin.horn at gmail.com wrote:
>> Is there any particular reason Twisted doesn't upload packages to PyPI
>> itself?
> 
> Messing about with web forms is no fun and "setup.py register" has 
> issues.

What issues? I've never had problems with either the register or upload 
commands...

Having the distributions on PyPI makes the OP's problem go away, and 
reduces the maintenance burned for you guys who release twisted...

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From chris at simplistix.co.uk  Thu Mar  4 11:45:58 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 04 Mar 2010 18:45:58 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304135224.2792.183209342.divmod.xquotient.502@localhost.localdomain>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<20100304135224.2792.183209342.divmod.xquotient.502@localhost.localdomain>
Message-ID: <4B8FFFE6.4080209@simplistix.co.uk>

exarkun at twistedmatrix.com wrote:
> Perhaps easy_install isn't the best way to manage deployments to your 
> production server?

No, but buildout is...

However, this process of discovering packages (hit pypi, scrape web pags 
if the distro isn't on pypi) is the only solution the python community 
(be it pip, easy_install, virtualenv or buildout) is using to download 
packages...

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From chris at simplistix.co.uk  Thu Mar  4 11:47:39 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 04 Mar 2010 18:47:39 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
Message-ID: <4B90004B.9080605@simplistix.co.uk>

Jonathan Lange wrote:
> I don't know how the PyPI announcement was done (although I'd love
> to!), but I think you can announce new versions without
> decommissioning old ones.

PyPI already does the right thing w.r.t. "hide previous versions" 
(either way works, it doesn't affect tools like easy_install) but ONLY 
if you put your distros on PyPI...

...obviously PyPI has not knowledge of your website and so can't do 
anything about it.

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From glyph at twistedmatrix.com  Thu Mar  4 11:55:50 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 4 Mar 2010 13:55:50 -0500
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <4B8FFF77.4030400@simplistix.co.uk>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
	<4B8FFF77.4030400@simplistix.co.uk>
Message-ID: <F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>


On Mar 4, 2010, at 1:44 PM, Chris Withers wrote:

> exarkun at twistedmatrix.com wrote:
>> On 04:53 pm, kevin.horn at gmail.com wrote:
>>> Is there any particular reason Twisted doesn't upload packages to PyPI
>>> itself?
>> 
>> Messing about with web forms is no fun and "setup.py register" has 
>> issues.
> 
> What issues? I've never had problems with either the register or upload 
> commands...
> 
> Having the distributions on PyPI makes the OP's problem go away, and 
> reduces the maintenance burned for you guys who release twisted...

This has been discussed before, on distutils-sig - there's a _giant_ thread, but I think the most relevant message is <http://mail.python.org/pipermail/distutils-sig/2009-December/015064.html>.

Now that our release process is better documented (THANK YOU JML), you might be able to have a look at <http://twistedmatrix.com/trac/wiki/ReleaseProcess> and figure out where 'setup.py upload' could fit in without uploading a tarball that is _not_ actually our official release.




From ziga.seilnacht at gmail.com  Thu Mar  4 12:54:11 2010
From: ziga.seilnacht at gmail.com (=?windows-1252?Q?=8Eiga_Seilnacht?=)
Date: Thu, 04 Mar 2010 20:54:11 +0100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
Message-ID: <4B900FE3.207@gmail.com>

Glyph Lefkowitz wrote:
> On Mar 4, 2010, at 7:59 AM, Jonathan Lange wrote:
>> On Thu, Mar 4, 2010 at 10:45 AM, Mark van Lent 
>> <m.van.lent at zestsoftware.nl> wrote:
>>> Hi everyone! I am a bit puzzled about the way new version of
>>> Twisted is released. Or better: the way the old version seems to
>>> be taken out of service. Last weeks I've been developing agains
>>> version Twisted 9.0.0. Yesterday I wanted to deploy my code to my
>>> production server, but to my surprise I could not easy_install
>>> that version anymore: $ easy_install Twisted==9.0.0 Searching for
>>> Twisted==9.0.0 Reading http://pypi.python.org/simple/Twisted/ 
>>> Reading http://www.twistedmatrix.com Reading
>>> http://twistedmatrix.com/products/download Reading
>>> http://twistedmatrix.com/projects/core/ Reading
>>> http://twistedmatrix.com/ No local packages or download links
>>> found for Twisted==9.0.0 Best match: None (Okay, actually I'm
>>> using buildout to setup my environment, but the above 
>>> demonstrates my problem more clearly.) I'm sure the new version
>>> of Twisted is better and improved but I still wonder why version
>>> 9.0.0 has effectively been decommissioned. Or am I missing
>>> something and is it still possible to easy_install version 9.0.0?
>>> 
>> 
>> It's an oversight.
> 
> I think it's actually a bug in easy_install, or at least a
> mis-design.
> 
> To make something easy_installable, you don't provide structured
> information in PyPI; there may be a way to do that, but most packages
> I've seen (Twisted included) just provide a link to a page which then
> provides a link to a file with a filename of vaguely the appropriate
> shape.  easy_install works by screen-scraping that link.
> 
> In our case, the "home page", http://twistedmatrix.com, links
> directly to a Twisted-<version>.tar.bz2, which is then used.
> 
> If someone (perhaps Mark van Lent!) could point us at how to provide
> the correctly structured information to easy_install via PyPI so it
> will _stop_ screen-scraping our website, and just point at the
> correct files, this problem could be addressed.
> 

I think that easy_install and related tools can be directed to the
proper download location by providing a Download-URL on the PyPI page.

E.g. the page for Twisted 9.0.0:
http://pypi.python.org/pypi/Twisted/9.0.0

should have a Download-URL link to:
http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/

Regards,
Ziga




From exarkun at twistedmatrix.com  Thu Mar  4 13:21:52 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 20:21:52 -0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <4B900FE3.207@gmail.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<4B900FE3.207@gmail.com>
Message-ID: <20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>

On 07:54 pm, ziga.seilnacht at gmail.com wrote:
>Glyph Lefkowitz wrote:
>>
>>If someone (perhaps Mark van Lent!) could point us at how to provide
>>the correctly structured information to easy_install via PyPI so it
>>will _stop_ screen-scraping our website, and just point at the
>>correct files, this problem could be addressed.
>
>I think that easy_install and related tools can be directed to the
>proper download location by providing a Download-URL on the PyPI page.
>
>E.g. the page for Twisted 9.0.0:
>http://pypi.python.org/pypi/Twisted/9.0.0
>
>should have a Download-URL link to:
>http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/

That's easy enough to adjust.  There.  Someone want to try it and see if 
it works?

Jean-Paul



From ziga.seilnacht at gmail.com  Thu Mar  4 13:41:42 2010
From: ziga.seilnacht at gmail.com (=?windows-1252?Q?=8Eiga_Seilnacht?=)
Date: Thu, 04 Mar 2010 21:41:42 +0100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<4B900FE3.207@gmail.com>
	<20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>
Message-ID: <4B901B06.4010300@gmail.com>

exarkun at twistedmatrix.com wrote:
> On 07:54 pm, ziga.seilnacht at gmail.com wrote:
>>
>>I think that easy_install and related tools can be directed to the
>>proper download location by providing a Download-URL on the PyPI page.
>>
>>E.g. the page for Twisted 9.0.0:
>>http://pypi.python.org/pypi/Twisted/9.0.0
>>
>>should have a Download-URL link to:
>>http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/
> 
> That's easy enough to adjust.  There.  Someone want to try it and see if 
> it works?
> 
> Jean-Paul
> 

It looks like it works now:

I:\> easy_install Twisted==9.0.0
Searching for Twisted==9.0.0
Reading http://pypi.python.org/simple/Twisted/
Reading http://www.twistedmatrix.com
Reading http://twistedmatrix.com/products/download
Reading http://twistedmatrix.com/projects/core/
Reading http://twistedmatrix.com/
Reading http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/
Best match: Twisted 9.0.0
Downloading http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/Twisted-9.0.0.win32-py2.5.exe

Now, how to get rid of the egg yolk...

Regards,
Ziga



From celord at gmail.com  Thu Mar  4 14:52:24 2010
From: celord at gmail.com (=?ISO-8859-1?B?Q+lzYXIgR2FyY+1h?=)
Date: Thu, 4 Mar 2010 15:52:24 -0600
Subject: [Twisted-Python] IMAP4 Client extrange behavior
In-Reply-To: <b302bf881002220825g2be89yf0aa7ec7503ab1de@mail.gmail.com>
References: <b302bf881002220825g2be89yf0aa7ec7503ab1de@mail.gmail.com>
Message-ID: <b302bf881003041352i6e7e3075i3f0daba66d7ca065@mail.gmail.com>

Hello all I have solved this, here are my final functions, I thing to
notice is that with twisted 8.2 the one from the debian/ubuntu repos
this functions do not work properly, in the other hand, they work just
fine with twisted 9 and 10

   def selectMailbox(self, mailbox):
        """
        Select the mailbox to examin
        """
        if debug: print "On selectMailbox"

        mailbox = self.factory.mailbox
        return self.select(mailbox).addCallback(self.cbSelectSuccess)



    def cbSelectSuccess(self, selected):
        """
        Examine the INBOX mailbox for new mails

        """
        if debug: print "On cbSelectSuccess"


        self.messageCount = selected['EXISTS']
        print "Messages: ", self.messageCount

        unseen = imap4.Query(unseen=True)

        return self.search(unseen
            ).addCallback(self.cbSearch)

    def cbSearch(self,messages):
        if debug: print "on cbSearch"

        messageSet = imap4.MessageSet()

        for message in messages:
            messageSet += message

        if messageSet:

            self.fetchMessage(messageSet, False
                ).addCallback(self.cbProcMessage)
        else:
            return


    def cbProcMessage(self, messages):
        if debug: print "on cbProcEnvelop"

        for message in messages.iteritems():

            body = message[1]['RFC822']
            print body

2010/2/22 Csar Garca <celord at gmail.com>:
> Hello all, I have this imap4 client http://www.pastebin.com/m4e387f1a
> most of the code is barrowed from a IRC friend, bob_f , it works fine
> but as soon as more that 1 email arrrives to the inbox, it only prints
> the first new messages but not the others, I wonder what am I doing
> wrong
>
> Thanks a lot
>
>
>
>
>
>
>
> Here is the code:
>
> #!/usr/bin/env python
> #coding=utf-8
>
>
> """
> Client de IMAP4 que descarga contenido del INBOX de una cuenta en especifico
> para luego extraer el numero de telefono que debe venir en los correos enviados
> """
>
> import StringIO
> import sys
> from Config import retCredentials
>
> from twisted.internet.task import LoopingCall
> from twisted.internet import protocol
> from twisted.internet import defer
> from twisted.mail import imap4
> from twisted.python import util
> from twisted.python import log
> from twisted.internet import reactor
> debug = 1
>
> class IMAP4Client(imap4.IMAP4Client):
>
>  def serverGreeting(self,caps):
>    """
>    Metodo llamado cuando el servidor contesta
>    """
>    if debug: print "On serverGreeting"
>
>    self.serverCapabilities = caps
>    if self.greetDeferred is not None:
>      d, self.greetDeferred = self.greetDeferred, None
>      d.addCallback(self.cbLogin)
>      d.callback(self)
>
>
>  def cbLogin(self, proto):
>    """
>    Callback to IMAP login
>    """
>    if debug: print "On Login"
>
>    login = self.login(self.factory.username, self.factory.password)
>    login.addCallback(self.startPolling)
>
>
>  def startPolling(self, proto):
>    """
>    Callback to poll every x seconds
>    """
>    call = LoopingCall(self.selectMailbox,mailbox="INBOX")
>    call.start(20, now=True)
>
>
>  def selectMailbox(self, mailbox):
>    """
>    Select the mailbox to examin
>    """
>    if debug: print "On selectMailbox"
>
>    mailbox = self.factory.mailbox
>    return self.select(mailbox).addCallback(self.cbSelectSuccess)
>
>
>  def cbSelectSuccess(self, selected):
>    """
>    Examine the INBOX mailbox for new mails
>
>    """
>    if debug: print "On cbSelectSuccess"
>
>
>    self.messageCount = selected['EXISTS']
>    print "Messages: ", self.messageCount
>
>    unseen = selected['EXISTS'] - selected['RECENT']
>
>    if selected['RECENT'] == 0:
>      print "No new messages"
>      return
>
>    return self.fetchMessage("%s:*" % (unseen)
>        ).addCallback(self.cbProcMessages)
>
>  def cbProcMessages(self,messages):
>
>    print messages
>
>
> class IMAP4ClientFactory(protocol.ClientFactory):
>
>  protocol = IMAP4Client
>
>  def __init__(self, username, password, onConn):
>
>    self.username = username
>    self.password = password
>    self.mailbox = 'INBOX'
>    self.onConn = onConn
>
>  def buildProtocol(self,addr):
>    if debug: print "On buildProtocol"
>    p = self.protocol()
>    p.factory = self
>    p.greetDeferred = self.onConn
>    auth = imap4.CramMD5ClientAuthenticator(self.username)
>    p.registerAuthenticator(auth)
>
>    return p
>
>  def clientConectionFailed(self, connector, reason):
>    d, self.onConn = self.onConn, None
>    d.errback(reason)
>
>
>
> def ebConnection(reason):
>  log.startLogging(sys.stdout)
>  log.err(reason)
>  reactor.stop()
>
>
>
> PORT = 143
> RESULT = "INBOX"
>
>
> def main():
>  credentials = retCredentials()
>  hostname = credentials['server']
>  username = credentials['mailbox']
>  password = util.getPassword('IMAP4 Password: ')
>
>  onConn = defer.Deferred(
>      ).addErrback(ebConnection
>      )
>
>  factory = IMAP4ClientFactory(username, password, onConn)
>
>
>  reactor.connectTCP(hostname, PORT, factory)
>  reactor.run()
>
> if __name__ == "__main__":
>  main()
>
> --
> http://celord.blogspot.com/
>



-- 
http://celord.blogspot.com/



From wmarketing3 at gmail.com  Thu Mar  4 14:57:43 2010
From: wmarketing3 at gmail.com (Prince Riley)
Date: Thu, 4 Mar 2010 15:57:43 -0600
Subject: [Twisted-Python] Twisted Python on Nokia E71x (Running the phone
	Python Interpreter)
Message-ID: <fa04eb751003041357o7ca889a9uc3985667c34731b0@mail.gmail.com>

Has anyone experimented with twisted-python on the Nokia E71x or E72
smartphones?

Prince Riley
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100304/114df4b0/attachment.html>

From kevin.horn at gmail.com  Thu Mar  4 15:49:57 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 4 Mar 2010 16:49:57 -0600
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
Message-ID: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>

It's been a while, I know you were all waiting with baited breath...

First a few fixes:

- Thanks to Tim Allen and Steve Steiner, several theme issues were fixed.
This
  fixes a few minor display bugs and should make pages validate properly.

- inline markup will now include child contents.  This causes rst not to
display
  properly in cases of "nested inline markup", but should make it easier to
  manually fix these places later

- :download: links are now generated for non-rst files ending in .py (most
of the
  examples), as welll as .tac and .sql files

- toc entries which end in a "/" character now have "index appended to them
  in the ReST output, which fixes a few issues where the built-Sphinx docs
  would end up with broken navigation links.

A couple of issues were also fixed at the PyCon sprints:

- <cite> tags are now handled...sort of.  According to Glyph, these aren't
really
  very important, so we just return the contents of the tag without any
special
  markup.  If we feel the need to put citation markup back into the docs we
can
  do that post-transition.

- Glyph also found an easy way to improve the CSS of the theme somewhat.
The
  issue where the sidebar drops below the main content should now be less of
a
  problem, though it's not gone entirely.

- Glyph and I also discussed a few different ways to handle links to the API
docs
  and agreed on a way forward.  Basically, well change the <code
class='API'>
  tags into something like: :api:`path.to.documented object <label>`, and
then
  create a docutils extension to convert that into a link.  The beginnings
of this
  are in the hg repos, but it looks like it won't be quite as simple as we
thought.

  First, the way pydoctor generates links is deceptively simple.

  If you look up a module, like "twisted.internet.defer", the link looks
like
  this:

    http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.html

  If you look up a class, like "twisted.internet.defer.Deferred" for
example,
  the link looks like this:


http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html

  Pretty simple right?  But if you look up a function or method like
  "twisted.internet.defer.Deferred.callback", the link has an anchor, like
so:


http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback

  So we'll need to do some checking on either the api docs or on twisted
itself
  to determine what sort of object is being linked to.  Shouldn't be
  super-difficult, just haven't had time yet.

  Second, I haven't yet figured out how to access the Sphinx config object
from
  a docutils role function.  I'm sure this is just a matter of finding an
example
  or getting an answer from the mailing list, but I just haven't gotten to
it yet.

I think the API links are the only major issue still remaining until we
start doing
the conversion, so once this issue is handled, I'll probably file a ticket
and create
a branch in SVN for the conversion.

If anyone has any docs tickets open, now is the time to get them fixed!

And if anyone has some great ideas about how to organize the new docs in the

repository, I'd love to hear them.


As always, converted docs are here:
http://twistedsphinx.funsize.net/

The lore2Sphinx Hg repos is here:
http://bitbucket.org/khorn/lore2sphinx/

Comments, ideas, patches and pull requests gratefully accepted (or at least
discussed).

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100304/03703c78/attachment.html>

From screwtape at froup.com  Thu Mar  4 16:03:32 2010
From: screwtape at froup.com (Tim Allen)
Date: Fri, 5 Mar 2010 10:03:32 +1100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
	<4B8FFF77.4030400@simplistix.co.uk>
	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
Message-ID: <20100304230332.GC1840@boombah.thristian.org>

On Thu, Mar 04, 2010 at 01:55:50PM -0500, Glyph Lefkowitz wrote:
> Now that our release process is better documented (THANK YOU JML), you
> might be able to have a look at
> <http://twistedmatrix.com/trac/wiki/ReleaseProcess> and figure out
> where 'setup.py upload' could fit in without uploading a tarball that
> is _not_ actually our official release.

If "setup.py upload" involves "setup.py sdist" then I guess this is
ticket #4138 again.

I still plan to tackle it sometime soon, but totally would not object if
anybody else wanted to dive in. :D



From exarkun at twistedmatrix.com  Thu Mar  4 16:05:28 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 04 Mar 2010 23:05:28 -0000
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
Message-ID: <20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>

On 10:49 pm, kevin.horn at gmail.com wrote:
>
>  If you look up a class, like "twisted.internet.defer.Deferred" for
>example,
>  the link looks like this:
>
>
>http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
>
>  Pretty simple right?  But if you look up a function or method like
>  "twisted.internet.defer.Deferred.callback", the link has an anchor, 
>like
>so:
>
>
>http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
>
>  So we'll need to do some checking on either the api docs or on twisted
>itself
>  to determine what sort of object is being linked to.  Shouldn't be
>  super-difficult, just haven't had time yet.

Did you notice that 
http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.addCallback.html 
also exists?

Jean-Paul



From kevin.horn at gmail.com  Thu Mar  4 16:31:56 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 4 Mar 2010 17:31:56 -0600
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
	<20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>
Message-ID: <562bcc11003041531g3e3bc987ucecae2c3f4dfd9df@mail.gmail.com>

On Thu, Mar 4, 2010 at 5:05 PM, <exarkun at twistedmatrix.com> wrote:

> On 10:49 pm, kevin.horn at gmail.com wrote:
> >
> >  If you look up a class, like "twisted.internet.defer.Deferred" for
> >example,
> >  the link looks like this:
> >
> >
> >
> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
> >
> >  Pretty simple right?  But if you look up a function or method like
> >  "twisted.internet.defer.Deferred.callback", the link has an anchor,
> >like
> >so:
> >
> >
> >
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
> >
> >  So we'll need to do some checking on either the api docs or on twisted
> >itself
> >  to determine what sort of object is being linked to.  Shouldn't be
> >  super-difficult, just haven't had time yet.
>
> Did you notice that
>
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.addCallback.html
> also exists?
>
> Jean-Paul
>
>
I hadn't actually.  If all functions and methods have a similar page in the
PyDoctor output, then I think what I have now will pretty much work as-is
(almost).  Do we think that just generating links to the individual
function/method pages is acceptable?

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100304/39942095/attachment.html>

From micahel at gmail.com  Thu Mar  4 17:10:19 2010
From: micahel at gmail.com (Michael Hudson-Doyle)
Date: Fri, 5 Mar 2010 13:10:19 +1300
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <562bcc11003041531g3e3bc987ucecae2c3f4dfd9df@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
	<20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>
	<562bcc11003041531g3e3bc987ucecae2c3f4dfd9df@mail.gmail.com>
Message-ID: <aa0dfd861003041610y87ee8a3uff9648b86dc2e091@mail.gmail.com>

On 5 March 2010 12:31, Kevin Horn <kevin.horn at gmail.com> wrote:
> On Thu, Mar 4, 2010 at 5:05 PM, <exarkun at twistedmatrix.com> wrote:
>>
>> On 10:49 pm, kevin.horn at gmail.com wrote:
>> >
>> > If you look up a class, like "twisted.internet.defer.Deferred" for
>> >example,
>> > the link looks like this:
>> >
>> >
>>
>> > >http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
>> >
>> > Pretty simple right? But if you look up a function or method like
>> > "twisted.internet.defer.Deferred.callback", the link has an anchor,
>> >like
>> >so:
>> >
>> >
>>
>> > >http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
>> >
>> > So we'll need to do some checking on either the api docs or on twisted
>> >itself
>> > to determine what sort of object is being linked to. Shouldn't be
>> > super-difficult, just haven't had time yet.
>>
>> Did you notice that
>>
>> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.addCallback.html
>> also exists?
>>
>> Jean-Paul
>>
>
> I hadn't actually. If all functions and methods have a similar page in the
> PyDoctor output, then I think what I have now will pretty much work as-is
> (almost). Do we think that just generating links to the individual
> function/method pages is acceptable?

It's what the lore-processed documentation currently links to.  It
would be nice to fix this (and I sort of vaguely know how), but that
should in no way hold up the move away from lore!

Cheers,
mwh



From kevin.horn at gmail.com  Thu Mar  4 17:16:08 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 4 Mar 2010 18:16:08 -0600
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <aa0dfd861003041610y87ee8a3uff9648b86dc2e091@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
	<20100304230528.2792.885639546.divmod.xquotient.809@localhost.localdomain>
	<562bcc11003041531g3e3bc987ucecae2c3f4dfd9df@mail.gmail.com>
	<aa0dfd861003041610y87ee8a3uff9648b86dc2e091@mail.gmail.com>
Message-ID: <562bcc11003041616t5a619b64i2846b59f89135ac4@mail.gmail.com>

On Thu, Mar 4, 2010 at 6:10 PM, Michael Hudson-Doyle <micahel at gmail.com>wrote:

> On 5 March 2010 12:31, Kevin Horn <kevin.horn at gmail.com> wrote:
> > On Thu, Mar 4, 2010 at 5:05 PM, <exarkun at twistedmatrix.com> wrote:
> >>
> >> On 10:49 pm, kevin.horn at gmail.com wrote:
> >> >
> >> >  If you look up a class, like "twisted.internet.defer.Deferred" for
> >> >example,
> >> >  the link looks like this:
> >> >
> >> >
> >>
> >> > >
> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
> >> >
> >> >  Pretty simple right?  But if you look up a function or method like
> >> >  "twisted.internet.defer.Deferred.callback", the link has an anchor,
> >> >like
> >> >so:
> >> >
> >> >
> >>
> >> > >
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
> >> >
> >> >  So we'll need to do some checking on either the api docs or on
> twisted
> >> >itself
> >> >  to determine what sort of object is being linked to.  Shouldn't be
> >> >  super-difficult, just haven't had time yet.
> >>
> >> Did you notice that
> >>
> >>
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.addCallback.html
> >> also exists?
> >>
> >> Jean-Paul
> >>
> >
> > I hadn't actually.  If all functions and methods have a similar page in
> the
> > PyDoctor output, then I think what I have now will pretty much work as-is
> > (almost).  Do we think that just generating links to the individual
> > function/method pages is acceptable?
>
> It's what the lore-processed documentation currently links to.  It
> would be nice to fix this (and I sort of vaguely know how), but that
> should in no way hold up the move away from lore!
>
> Cheers,
> mwh
>
>
OK, if that's the way Lore does it, then I'm happy to call that "good enough
for now".  It seems to work here in my local version of the docs, I'll
update the online stuff at http://twistedsphinx.funsize.net soonish.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100304/78515b33/attachment.html>

From micahel at gmail.com  Thu Mar  4 21:51:09 2010
From: micahel at gmail.com (Michael Hudson-Doyle)
Date: Fri, 5 Mar 2010 17:51:09 +1300
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
In-Reply-To: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
References: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
Message-ID: <aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>

On 4 March 2010 17:46, Bo Shi <bs1984 at gmail.com> wrote:
> Hi All,
>
> I've been struggling with this issue off and on for the better part of
> a month now. Having implemented a simple git SSH server using some of
> the Conch examples in the official documentation, I encountered an
> issue that would cause a git client to throw an error only part of the
> time.

I think it's a bug in conch.

> The little program to reproduce the issue is found at
>
>  http://gist.github.com/321403
>
>  (raw version for download)
>  http://gist.github.com/raw/321403/82ab2111a2709c8fe50a77aabb08565749087408/gitconnbug.py
>
> and can be executed to start the sample server. Run a command like
>
>  # The /abspath/to/git/repo should be readable by the server user
>  $ git clone ssh://user at localhost:2222/abspath/to/git/repo
>  (password "user")
>
> To test the server. On my workstation, I am able to reproduce the
> error at least once every 5 tries. It's definitely not consistent.
> The behavior I see is attached at the end of this email. The client
> fails due to a premature inConnectionLost() call in the
> SSHSessionProcessProtocol that sends an EOF.
>
> As a workaround, when TraceProcessProtocol.inConnectionLost() is
> overriden to do nothing, the client error goes away. This is somewhat
> foreign territory for me so I'm not sure whether it's a bug in git or
> whether it's a bug in the twisted ProcessProtocol implementation. RFC
> 4254 isn't terribly helpful here:
>
>  5.3. Closing a Channel
>
>    When a party will no longer send more data to a channel, it SHOULD
>    send SSH_MSG_CHANNEL_EOF.
>
> So on the surface the current behavior of sending an EOF appears fine,
> however, I can't really find any definitive cases of this type of
> problem popping up via, say, default OpenSSH/git combinations.
>
>
> Any advice? Is the gitconnbug.py implementation flawed? Should I
> open a ticket? Any git experts know of a case where git-upload-pack
> might close it's stdout pipe?

I think what's actually happening here is that git-upload-pack is
closing its *stdin*.  Why conch reacts to that by shutting down the
channel, I don't really know -- it doesn't seem right to me.  Maybe
it's a simple logic error and it method should be
'outConnectionClosed' instead?

At any rate, I think this is a bug -- please file a ticket.  And
thanks for the complete example!

Cheers,
mwh



From wthie at thiengineering.ch  Thu Mar  4 23:47:58 2010
From: wthie at thiengineering.ch (Werner Thie)
Date: Fri, 05 Mar 2010 07:47:58 +0100
Subject: [Twisted-Python] Twisted Python on Nokia E71x (Running the
 phone Python Interpreter)
In-Reply-To: <fa04eb751003041357o7ca889a9uc3985667c34731b0@mail.gmail.com>
References: <fa04eb751003041357o7ca889a9uc3985667c34731b0@mail.gmail.com>
Message-ID: <4B90A91E.8050702@thiengineering.ch>

Hi

see my post dated 30.05.2009 18:59

did some experimenting with E61i and twisted pre 8.0 pretty much worked. 
Now with the problems starting on E61i with the Python releases from 
1.97 up to the latest 2.0 (certificate woes) and an extremely shabby 
implementation of the cam module I lost interest.

HTH, Werner

Prince Riley wrote:
> 
> 
> Has anyone experimented with twisted-python on the Nokia E71x or E72 
> smartphones?
> 
> Prince Riley
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From lormayna at libero.it  Fri Mar  5 02:20:49 2010
From: lormayna at libero.it (lormayna at libero.it)
Date: Fri, 5 Mar 2010 10:20:49 +0100 (CET)
Subject: [Twisted-Python] R: Twisted Python on Nokia E71x (Running the phone
 Python Interpreter)
Message-ID: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>

>Date: Thu, 4 Mar 2010 15:57:43 -0600
>From: Prince Riley <wmarketing3 at gmail.com>
>Subject: [Twisted-Python] Twisted Python on Nokia E71x (Running the
>	phone	Python Interpreter)
>To: twisted-python at twistedmatrix.com
>Message-ID:
>	<fa04eb751003041357o7ca889a9uc3985667c34731b0 at mail.gmail.com>
>Content-Type: text/plain; charset="iso-8859-1"
>
>Has anyone experimented with twisted-python on the Nokia E71x or E72
>smartphones?
>
>Prince Riley

Hi,
I had tried to use Python for S60 (not Twisted, but standard socket module) 
writing a NNTP client, but I found many problem specially about networking. 
There is no high-layer abstraction layer for networking, so you have to 
implement all the logic from low level.
I tried to use select (that may be useful for doing asynchronous networking 
apps), but is not working correctly on s60 phones. There is no porting for 
Twisted.
My experience is that PyS60 is not mature for a production environment.




From wthie at thiengineering.ch  Fri Mar  5 02:46:40 2010
From: wthie at thiengineering.ch (Werner Thie)
Date: Fri, 05 Mar 2010 10:46:40 +0100
Subject: [Twisted-Python] R: Twisted Python on Nokia E71x (Running the
 phone Python Interpreter)
In-Reply-To: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>
References: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>
Message-ID: <4B90D300.8060804@thiengineering.ch>

Hi

I mostly diddled with the cam and automated uploading of pictures with 
simple JSON encoding over WLAN, and as I said, twisted is running with a 
few patches on the E61i..

Using putools

http://people.csail.mit.edu/kapu/symbian/python.html

helped a lot.

Please find attached a tiny example with a very primitive server and a 
client counterpart using the standard socket API in python on the E61i. 
Although the pictures are lousy (the cam looses the white balance when 
the picture is taken) this code ran for days with no problem. So 'not 
ready for production' seems to me a bit too harsh as a judgment.

Werner

lormayna at libero.it wrote:
>> Date: Thu, 4 Mar 2010 15:57:43 -0600
>> From: Prince Riley <wmarketing3 at gmail.com>
>> Subject: [Twisted-Python] Twisted Python on Nokia E71x (Running the
>> 	phone	Python Interpreter)
>> To: twisted-python at twistedmatrix.com
>> Message-ID:
>> 	<fa04eb751003041357o7ca889a9uc3985667c34731b0 at mail.gmail.com>
>> Content-Type: text/plain; charset="iso-8859-1"
>>
>> Has anyone experimented with twisted-python on the Nokia E71x or E72
>> smartphones?
>>
>> Prince Riley
> 
> Hi,
> I had tried to use Python for S60 (not Twisted, but standard socket module) 
> writing a NNTP client, but I found many problem specially about networking. 
> There is no high-layer abstraction layer for networking, so you have to 
> implement all the logic from low level.
> I tried to use select (that may be useful for doing asynchronous networking 
> apps), but is not working correctly on s60 phones. There is no porting for 
> Twisted.
> My experience is that PyS60 is not mature for a production environment.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: jsonphotoclient.py
Type: application/x-python
Size: 1831 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20100305/495ecfc4/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: photoserver.py
Type: application/x-python
Size: 1054 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20100305/495ecfc4/attachment-0005.bin>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: photoserver.tac
URL: </pipermail/twisted-python/attachments/20100305/495ecfc4/attachment.ksh>

From m.van.lent at zestsoftware.nl  Fri Mar  5 02:33:14 2010
From: m.van.lent at zestsoftware.nl (Mark van Lent)
Date: Fri, 05 Mar 2010 10:33:14 +0100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<4B900FE3.207@gmail.com>
	<20100304202152.2792.1095558952.divmod.xquotient.808@localhost.localdomain>
Message-ID: <hmqj4q$mth$1@dough.gmane.org>

On 3/4/10 21:21 , exarkun at twistedmatrix.com wrote:
>> I think that easy_install and related tools can be directed to the
>> proper download location by providing a Download-URL on the PyPI page.
>>
>> E.g. the page for Twisted 9.0.0:
>> http://pypi.python.org/pypi/Twisted/9.0.0
>>
>> should have a Download-URL link to:
>> http://tmrc.mit.edu/mirror/twisted/Twisted/9.0/
>
> That's easy enough to adjust.  There.  Someone want to try it and see if
> it works?

Thanks Jean-Paul and Ziga! It indeed works like a charm!

I have to admit that, for someone who uses PyPi daily, I know too little 
about it. I probably would have started tinkering with my zc.buildout 
configuration to get it working, but this is a much better solution.

Thanks again,
Mark




From chris at simplistix.co.uk  Fri Mar  5 04:11:35 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 05 Mar 2010 11:11:35 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100304230332.GC1840@boombah.thristian.org>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>	<4B8FFF77.4030400@simplistix.co.uk>	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
	<20100304230332.GC1840@boombah.thristian.org>
Message-ID: <4B90E6E7.9050908@simplistix.co.uk>

Tim Allen wrote:
> On Thu, Mar 04, 2010 at 01:55:50PM -0500, Glyph Lefkowitz wrote:
>> Now that our release process is better documented (THANK YOU JML), you
>> might be able to have a look at
>> <http://twistedmatrix.com/trac/wiki/ReleaseProcess> and figure out
>> where 'setup.py upload' could fit in without uploading a tarball that
>> is _not_ actually our official release.
> 
> If "setup.py upload" involves "setup.py sdist" then I guess this is
> ticket #4138 again.

No, it doesn't... see the release process I use for my own packages here:

http://packages.python.org/errorhandler/development.html#making-a-release

cheers,

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From screwtape at froup.com  Fri Mar  5 04:51:57 2010
From: screwtape at froup.com (Tim Allen)
Date: Fri, 5 Mar 2010 22:51:57 +1100
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <4B90E6E7.9050908@simplistix.co.uk>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
	<4B8FFF77.4030400@simplistix.co.uk>
	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
	<20100304230332.GC1840@boombah.thristian.org>
	<4B90E6E7.9050908@simplistix.co.uk>
Message-ID: <20100305115157.GD1840@boombah.thristian.org>

On Fri, Mar 05, 2010 at 11:11:35AM +0000, Chris Withers wrote:
> Tim Allen wrote:
> > If "setup.py upload" involves "setup.py sdist" then I guess this is
> > ticket #4138 again.
> 
> No, it doesn't... see the release process I use for my own packages here:
> 
> http://packages.python.org/errorhandler/development.html#making-a-release

Hmm... at the bottom of that page, I see you run (among other things):

    setup.py sdist upload

...so presumably sdist *is* a prerequisite for upload. Or are you saying
that you can store any old file as dist/$PACKAGE-$VERSION.tar.gz and
"setup.py upload" will ship it to PyPI?



From chris at simplistix.co.uk  Fri Mar  5 07:42:33 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 05 Mar 2010 14:42:33 +0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <20100305115157.GD1840@boombah.thristian.org>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>	<4B8FFF77.4030400@simplistix.co.uk>	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>	<20100304230332.GC1840@boombah.thristian.org>	<4B90E6E7.9050908@simplistix.co.uk>
	<20100305115157.GD1840@boombah.thristian.org>
Message-ID: <4B911859.80702@simplistix.co.uk>

Tim Allen wrote:
> ...so presumably sdist *is* a prerequisite for upload. Or are you saying
> that you can store any old file as dist/$PACKAGE-$VERSION.tar.gz and
> "setup.py upload" will ship it to PyPI?

I think that's true, but I admit, I haven't checked myself ;-)

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From exarkun at twistedmatrix.com  Fri Mar  5 08:02:43 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 05 Mar 2010 15:02:43 -0000
Subject: [Twisted-Python] Twisted 9.0.0?
In-Reply-To: <4B911859.80702@simplistix.co.uk>
References: <8F2AEB1D-B371-40DC-90B0-8AE3ADC58676@zestsoftware.nl>
	<d06a5cd31003040459n6e3bdf7aw2123fb67c8d9cacc@mail.gmail.com>
	<422C8133-E7BE-4622-A6F0-41187C79318B@twistedmatrix.com>
	<562bcc11003040853k16483d49gd7a3bf9126365b8a@mail.gmail.com>
	<20100304172737.2792.2050762785.divmod.xquotient.659@localhost.localdomain>
	<4B8FFF77.4030400@simplistix.co.uk>
	<F235230F-88D7-4529-8B15-201C1E32E9BC@twistedmatrix.com>
	<20100304230332.GC1840@boombah.thristian.org>
	<4B90E6E7.9050908@simplistix.co.uk>
	<20100305115157.GD1840@boombah.thristian.org>
	<4B911859.80702@simplistix.co.uk>
Message-ID: <20100305150243.2792.1449357947.divmod.xquotient.897@localhost.localdomain>

On 02:42 pm, chris at simplistix.co.uk wrote:
>Tim Allen wrote:
>>...so presumably sdist *is* a prerequisite for upload. Or are you 
>>saying
>>that you can store any old file as dist/$PACKAGE-$VERSION.tar.gz and
>>"setup.py upload" will ship it to PyPI?
>
>I think that's true, but I admit, I haven't checked myself ;-)

It is.  Or at least something like sdist.  The thread Glyph linked to 
covers this.

Jean-Paul



From drew.smathers at gmail.com  Fri Mar  5 08:30:44 2010
From: drew.smathers at gmail.com (Drew Smathers)
Date: Fri, 5 Mar 2010 10:30:44 -0500
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
Message-ID: <368574aa1003050730p476bee78x5ed0e262783258d3@mail.gmail.com>

On Thu, Mar 4, 2010 at 5:49 PM, Kevin Horn <kevin.horn at gmail.com> wrote:

>
> It's been a while, I know you were all waiting with baited breath...
>
> First a few fixes:
>
> - Thanks to Tim Allen and Steve Steiner, several theme issues were fixed.
> This
>   fixes a few minor display bugs and should make pages validate properly.
>
> - inline markup will now include child contents.  This causes rst not to
> display
>   properly in cases of "nested inline markup", but should make it easier to
>
>   manually fix these places later
>
> - :download: links are now generated for non-rst files ending in .py (most
> of the
>   examples), as welll as .tac and .sql files
>
> - toc entries which end in a "/" character now have "index appended to them
>   in the ReST output, which fixes a few issues where the built-Sphinx docs
>   would end up with broken navigation links.
>
> A couple of issues were also fixed at the PyCon sprints:
>
> - <cite> tags are now handled...sort of.  According to Glyph, these aren't
> really
>   very important, so we just return the contents of the tag without any
> special
>   markup.  If we feel the need to put citation markup back into the docs we
> can
>   do that post-transition.
>
> - Glyph also found an easy way to improve the CSS of the theme somewhat.
> The
>   issue where the sidebar drops below the main content should now be less
> of a
>   problem, though it's not gone entirely.
>
> - Glyph and I also discussed a few different ways to handle links to the
> API docs
>   and agreed on a way forward.  Basically, well change the <code
> class='API'>
>   tags into something like: :api:`path.to.documented object <label>`, and
> then
>   create a docutils extension to convert that into a link.  The beginnings
> of this
>   are in the hg repos, but it looks like it won't be quite as simple as we
> thought.
>
>   First, the way pydoctor generates links is deceptively simple.
>
>   If you look up a module, like "twisted.internet.defer", the link looks
> like
>   this:
>
>
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.html
>
>   If you look up a class, like "twisted.internet.defer.Deferred" for
> example,
>   the link looks like this:
>
>
> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
>
>   Pretty simple right?  But if you look up a function or method like
>   "twisted.internet.defer.Deferred.callback", the link has an anchor, like
> so:
>
>
> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
>
>   So we'll need to do some checking on either the api docs or on twisted
> itself
>   to determine what sort of object is being linked to.  Shouldn't be
>   super-difficult, just haven't had time yet.
>
>   Second, I haven't yet figured out how to access the Sphinx config object
> from
>   a docutils role function.  I'm sure this is just a matter of finding an
> example
>   or getting an answer from the mailing list, but I just haven't gotten to
> it yet.
>
> I think the API links are the only major issue still remaining until we
> start doing
> the conversion, so once this issue is handled, I'll probably file a ticket
> and create
> a branch in SVN for the conversion.
>
> If anyone has any docs tickets open, now is the time to get them fixed!
>
>
>
How can I filter for tickets related to lore2sphinx transition in trac?
 I've noticed a few documents that don't seem properly converted. Here's an
example:

http://twistedsphinx.funsize.net/projects/web/howto/web-in-60/asynchronous.html

... which is missing syntax highlighting on code examples and the code
examples are also truncated.

-Drew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100305/e8ca6370/attachment-0001.html>

From bs1984 at gmail.com  Fri Mar  5 09:27:07 2010
From: bs1984 at gmail.com (Bo Shi)
Date: Fri, 5 Mar 2010 11:27:07 -0500
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
In-Reply-To: <aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
References: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
	<aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
Message-ID: <b48edea61003050827g34e0e6f8xb6bf3efa18c594f7@mail.gmail.com>

Thanks Michael; I have filed #4350.

On Thu, Mar 4, 2010 at 11:51 PM, Michael Hudson-Doyle <micahel at gmail.com> wrote:
> On 4 March 2010 17:46, Bo Shi <bs1984 at gmail.com> wrote:
>> Hi All,
>>
>> I've been struggling with this issue off and on for the better part of
>> a month now. Having implemented a simple git SSH server using some of
>> the Conch examples in the official documentation, I encountered an
>> issue that would cause a git client to throw an error only part of the
>> time.
>
> I think it's a bug in conch.
>
>> The little program to reproduce the issue is found at
>>
>>  http://gist.github.com/321403
>>
>>  (raw version for download)
>>  http://gist.github.com/raw/321403/82ab2111a2709c8fe50a77aabb08565749087408/gitconnbug.py
>>
>> and can be executed to start the sample server. Run a command like
>>
>>  # The /abspath/to/git/repo should be readable by the server user
>>  $ git clone ssh://user at localhost:2222/abspath/to/git/repo
>>  (password "user")
>>
>> To test the server. On my workstation, I am able to reproduce the
>> error at least once every 5 tries. It's definitely not consistent.
>> The behavior I see is attached at the end of this email. The client
>> fails due to a premature inConnectionLost() call in the
>> SSHSessionProcessProtocol that sends an EOF.
>>
>> As a workaround, when TraceProcessProtocol.inConnectionLost() is
>> overriden to do nothing, the client error goes away. This is somewhat
>> foreign territory for me so I'm not sure whether it's a bug in git or
>> whether it's a bug in the twisted ProcessProtocol implementation. RFC
>> 4254 isn't terribly helpful here:
>>
>>  5.3. Closing a Channel
>>
>>    When a party will no longer send more data to a channel, it SHOULD
>>    send SSH_MSG_CHANNEL_EOF.
>>
>> So on the surface the current behavior of sending an EOF appears fine,
>> however, I can't really find any definitive cases of this type of
>> problem popping up via, say, default OpenSSH/git combinations.
>>
>>
>> Any advice? Is the gitconnbug.py implementation flawed? Should I
>> open a ticket? Any git experts know of a case where git-upload-pack
>> might close it's stdout pipe?
>
> I think what's actually happening here is that git-upload-pack is
> closing its *stdin*. Why conch reacts to that by shutting down the
> channel, I don't really know -- it doesn't seem right to me. Maybe
> it's a simple logic error and it method should be
> 'outConnectionClosed' instead?
>
> At any rate, I think this is a bug -- please file a ticket. And
> thanks for the complete example!
>
> Cheers,
> mwh
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Bo Shi
617-942-1744



From foom at fuhm.net  Fri Mar  5 10:07:18 2010
From: foom at fuhm.net (James Y Knight)
Date: Fri, 5 Mar 2010 12:07:18 -0500
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
In-Reply-To: <aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
References: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
	<aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
Message-ID: <808237A7-0671-4A4E-863A-8082CB44356E@fuhm.net>


On Mar 4, 2010, at 11:51 PM, Michael Hudson-Doyle wrote:

> Maybe
> it's a simple logic error and it method should be
> 'outConnectionClosed' instead?

I'd agree with that. Clearly it should not be sending EOF there for  
the server process closing its stdin. One more detail though: you  
actually need to wait for both stdout and stderr to close, not just  
stdout.

[[[Sidenote:
There *is* no standard SSH protocol message for closing your stdin.
But if openssh 5.1 or later connects to an openssh 5.1 or later  
server, it will use the nonstandard eow at openssh.org command to  
indicate a closed stdin.

Thus, on standard ssh servers/clients, the command:
   ssh hostname yes | true
will hang forever. True closed its stdin by virtue of exiting, but  
that can't get propagated across the ssh link. So, yes never gets a  
SIGPIPE, and thus never closes its stdout and the command keeps  
running forever.

But on openssh 5.1 or greater on both ends, it will "work properly".

BTW, you can't reasonably implement this extension in conch even if  
you wanted to, because openssh client will only send it to servers  
which identify themselves as openssh servers.

http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/PROTOCOL
]]]

James



From kamil at lucem.pl  Fri Mar  5 10:15:44 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Fri, 5 Mar 2010 18:15:44 +0100
Subject: [Twisted-Python] Escaping variable names
Message-ID: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>

Hi,

Ive got an issue where a variable name needs to have a minus sign (-) in it.

from SOAPpy import WSDL
wsdlFile = "http://webapi.allegro.pl/uploader.php?wsdl"
server = WSDL.Proxy(wsdlFile)
server.soapproxy.config.argsOrdering = {'doGetCountries': ['country-code',
'webapi-key'] }
server.doGetCountries(country-code=COUNTRYID}, webapi-key=WEBAPIKEY)

The above method allows me to specify the order and name of variables being
sent, but i have a problem since the variables have a "-" sign in the
middle, is there a way to escape it in the variable name or get around the
problem?

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100305/2d98cb60/attachment.html>

From glyph at twistedmatrix.com  Fri Mar  5 10:25:35 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 5 Mar 2010 12:25:35 -0500
Subject: [Twisted-Python] SSHSessionProcessProtocol.inConnectionLost()
	behavior and Git over Conch
In-Reply-To: <808237A7-0671-4A4E-863A-8082CB44356E@fuhm.net>
References: <b48edea61003032046o76446c73o2318dea9542b490d@mail.gmail.com>
	<aa0dfd861003042051lb260fe0g9c78ede1f9afc17d@mail.gmail.com>
	<808237A7-0671-4A4E-863A-8082CB44356E@fuhm.net>
Message-ID: <49919B29-FDA1-4C5D-949C-87146E889BFC@twistedmatrix.com>


On Mar 5, 2010, at 12:07 PM, James Y Knight wrote:

> BTW, you can't reasonably implement this extension in conch even if  
> you wanted to, because openssh client will only send it to servers  
> which identify themselves as openssh servers.

Does it just test the banner for being identical, or could we have Conch identify itself as OpenSSH, version (5.1.something+Conch-Not-OpenSSH)?





From maarten at treewalker.org  Fri Mar  5 10:26:36 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Fri, 5 Mar 2010 18:26:36 +0100
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
Message-ID: <201003051826.36391.maarten@treewalker.org>

On Friday 05 March 2010, Kamil Wasilewski wrote:

> from SOAPpy import WSDL
> wsdlFile = "http://webapi.allegro.pl/uploader.php?wsdl"
> server = WSDL.Proxy(wsdlFile)
> server.soapproxy.config.argsOrdering = {'doGetCountries':
> ['country-code', 'webapi-key'] }
> server.doGetCountries(country-code=COUNTRYID}, webapi-key=WEBAPIKEY)
> 
> The above method allows me to specify the order and name of variables
> being sent, but i have a problem since the variables have a "-" sign in
> the middle, is there a way to escape it in the variable name or get
> around the problem?

Yes, you can pass them from a dictionary using the ** syntax:

server.doGetCountries(**{
	'country-code': COUNTRYID, 'webapi-key': WEBAPIKEY
	})

However, if you have the ability to change the API, it would be better to 
use underscores as separators in the argument names instead of dashes.

Bye,
		Maarten



From phil at bubblehouse.org  Fri Mar  5 10:26:46 2010
From: phil at bubblehouse.org (Phil Christensen)
Date: Fri, 5 Mar 2010 12:26:46 -0500
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
Message-ID: <9CD4515D-3B8F-42CC-A160-996B0EC7B1C5@bubblehouse.org>

On Mar 5, 2010, at 12:15 PM, Kamil Wasilewski wrote:
> server.soapproxy.config.argsOrdering = {'doGetCountries': ['country-code', 'webapi-key'] }
> server.doGetCountries(country-code=COUNTRYID}, webapi-key=WEBAPIKEY)
> 
> The above method allows me to specify the order and name of variables being sent, but i have a problem since the variables have a "-" sign in the middle, is there a way to escape it in the variable name or get around the problem?
> 
> Thanks!

try:

server.doGetCountries(**{'country-code':COUNTRYID, 'webapi-key':WEBAPIKEY})

-phil


From kevin.horn at gmail.com  Fri Mar  5 10:33:47 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Fri, 5 Mar 2010 11:33:47 -0600
Subject: [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
In-Reply-To: <368574aa1003050730p476bee78x5ed0e262783258d3@mail.gmail.com>
References: <562bcc11003041449x1d1ba2fdx5f9ba6262bd49643@mail.gmail.com>
	<368574aa1003050730p476bee78x5ed0e262783258d3@mail.gmail.com>
Message-ID: <562bcc11003050933t3d810980n94aadef31cc6c62c@mail.gmail.com>

On Fri, Mar 5, 2010 at 9:30 AM, Drew Smathers <drew.smathers at gmail.com>wrote:

> On Thu, Mar 4, 2010 at 5:49 PM, Kevin Horn <kevin.horn at gmail.com> wrote:
>
>>
>> It's been a while, I know you were all waiting with baited breath...
>>
>> First a few fixes:
>>
>> - Thanks to Tim Allen and Steve Steiner, several theme issues were fixed.
>> This
>>   fixes a few minor display bugs and should make pages validate properly.
>>
>> - inline markup will now include child contents.  This causes rst not to
>> display
>>   properly in cases of "nested inline markup", but should make it easier
>> to
>>   manually fix these places later
>>
>> - :download: links are now generated for non-rst files ending in .py (most
>> of the
>>   examples), as welll as .tac and .sql files
>>
>> - toc entries which end in a "/" character now have "index appended to
>> them
>>   in the ReST output, which fixes a few issues where the built-Sphinx docs
>>   would end up with broken navigation links.
>>
>> A couple of issues were also fixed at the PyCon sprints:
>>
>> - <cite> tags are now handled...sort of.  According to Glyph, these aren't
>> really
>>   very important, so we just return the contents of the tag without any
>> special
>>   markup.  If we feel the need to put citation markup back into the docs
>> we can
>>   do that post-transition.
>>
>> - Glyph also found an easy way to improve the CSS of the theme somewhat.
>> The
>>   issue where the sidebar drops below the main content should now be less
>> of a
>>   problem, though it's not gone entirely.
>>
>> - Glyph and I also discussed a few different ways to handle links to the
>> API docs
>>   and agreed on a way forward.  Basically, well change the <code
>> class='API'>
>>   tags into something like: :api:`path.to.documented object <label>`, and
>> then
>>   create a docutils extension to convert that into a link.  The beginnings
>> of this
>>   are in the hg repos, but it looks like it won't be quite as simple as we
>> thought.
>>
>>   First, the way pydoctor generates links is deceptively simple.
>>
>>   If you look up a module, like "twisted.internet.defer", the link looks
>> like
>>   this:
>>
>>
>> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.html
>>
>>   If you look up a class, like "twisted.internet.defer.Deferred" for
>> example,
>>   the link looks like this:
>>
>>
>> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html
>>
>>   Pretty simple right?  But if you look up a function or method like
>>   "twisted.internet.defer.Deferred.callback", the link has an anchor, like
>> so:
>>
>>
>> http://twistedmatrix.com/documents/9.0.0/api/twisted.internet.defer.Deferred.html#addCallback
>>
>>   So we'll need to do some checking on either the api docs or on twisted
>> itself
>>   to determine what sort of object is being linked to.  Shouldn't be
>>   super-difficult, just haven't had time yet.
>>
>>   Second, I haven't yet figured out how to access the Sphinx config object
>> from
>>   a docutils role function.  I'm sure this is just a matter of finding an
>> example
>>   or getting an answer from the mailing list, but I just haven't gotten to
>> it yet.
>>
>> I think the API links are the only major issue still remaining until we
>> start doing
>> the conversion, so once this issue is handled, I'll probably file a ticket
>> and create
>> a branch in SVN for the conversion.
>>
>> If anyone has any docs tickets open, now is the time to get them fixed!
>>
>>
>>
> How can I filter for tickets related to lore2sphinx transition in trac?
>  I've noticed a few documents that don't seem properly converted. Here's an
> example:
>
>
> http://twistedsphinx.funsize.net/projects/web/howto/web-in-60/asynchronous.html
>
> ... which is missing syntax highlighting on code examples and the code
> examples are also truncated.
>
> -Drew
>
>
As far as I know, there aren't any tickets in Trac yet.  I was planning on
making some (or asking others to do so) once a "master ticket" and a branch
are created.

As for the specific issue you linked to, the ReST markup is similar to that
on other pages, but it looks like Sphinx isn't recognizing the code samples
as Python for some reason.  I'll look into this later on.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100305/40aa08ed/attachment.html>

From kamil at lucem.pl  Fri Mar  5 10:35:33 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Fri, 5 Mar 2010 18:35:33 +0100
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <201003051826.36391.maarten@treewalker.org>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
	<201003051826.36391.maarten@treewalker.org>
Message-ID: <208117684.20100305183533@lucem.pl>

Hello Maarten,

Friday, March 5, 2010, 6:26:36 PM, you wrote:

> On Friday 05 March 2010, Kamil Wasilewski wrote:

>> from SOAPpy import WSDL
>> wsdlFile = "http://webapi.allegro.pl/uploader.php?wsdl"
>> server = WSDL.Proxy(wsdlFile)
>> server.soapproxy.config.argsOrdering = {'doGetCountries':
>> ['country-code', 'webapi-key'] }
>> server.doGetCountries(country-code=COUNTRYID}, webapi-key=WEBAPIKEY)
>> 
>> The above method allows me to specify the order and name of variables
>> being sent, but i have a problem since the variables have a "-" sign in
>> the middle, is there a way to escape it in the variable name or get
>> around the problem?

> Yes, you can pass them from a dictionary using the ** syntax:

> server.doGetCountries(**{
>         'country-code': COUNTRYID, 'webapi-key': WEBAPIKEY
>         })

          The above gives a syntax error...

> However, if you have the ability to change the API, it would be better to
> use underscores as separators in the argument names instead of dashes.

  Unfortunately the designer of the API is a large British company that
  forgot to take into account other languages than PHP.




From maarten at treewalker.org  Fri Mar  5 10:55:10 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Fri, 5 Mar 2010 18:55:10 +0100
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <208117684.20100305183533@lucem.pl>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
	<201003051826.36391.maarten@treewalker.org>
	<208117684.20100305183533@lucem.pl>
Message-ID: <201003051855.10706.maarten@treewalker.org>

On Friday 05 March 2010, Kamil Wasilewski wrote:
> > server.doGetCountries(**{
> >         'country-code': COUNTRYID, 'webapi-key': WEBAPIKEY
> >         })
> 
>           The above gives a syntax error...

What kind of syntax error? I tested this approached on the interactive 
Python shell and it worked fine there:

>>> def f(**kvargs):
...   print kvargs
... 
>>> f(a = 1, **{'b-c': 12})
{'a': 1, 'b-c': 12}

Bye,
		Maarten



From kamil at lucem.pl  Fri Mar  5 11:11:10 2010
From: kamil at lucem.pl (Kamil Wasilewski)
Date: Fri, 5 Mar 2010 19:11:10 +0100
Subject: [Twisted-Python] Escaping variable names
In-Reply-To: <201003051855.10706.maarten@treewalker.org>
References: <eeca458e1003050915g3a34815bs39dfc28321d4733e@mail.gmail.com>
	<201003051826.36391.maarten@treewalker.org>
	<208117684.20100305183533@lucem.pl>
	<201003051855.10706.maarten@treewalker.org>
Message-ID: <969405264.20100305191110@lucem.pl>


> On Friday 05 March 2010, Kamil Wasilewski wrote:
>> > server.doGetCountries(**{
>> >         'country-code': COUNTRYID, 'webapi-key': WEBAPIKEY
>> >         })
>> 
>>           The above gives a syntax error...

> What kind of syntax error? I tested this approached on the interactive
> Python shell and it worked fine there:

>>>> def f(**kvargs):
> ...   print kvargs
> ... 
>>>> f(a = 1, **{'b-c': 12})
> {'a': 1, 'b-c': 12}


    hu, it did work.. must of been a mistake on my part.
    But i tried that method a few times.
    Well that solved a problem ive been sitting on for a while. Thank you!




From lvh at laurensvh.be  Fri Mar  5 13:22:47 2010
From: lvh at laurensvh.be (Laurens Van Houtven)
Date: Fri, 5 Mar 2010 21:22:47 +0100
Subject: [Twisted-Python] R: Twisted Python on Nokia E71x (Running the
	phone Python Interpreter)
In-Reply-To: <4B90D300.8060804@thiengineering.ch>
References: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>
	<4B90D300.8060804@thiengineering.ch>
Message-ID: <cedc0c091003051222r1cf1fce9qbaaafb8f477309f@mail.gmail.com>

I don't use PUTools when developing for PyS60. The bluetooth console
was nice, but recent versions of PyS60 ship with it already. My phone
(6220 Classic) lets me do obex + bluetooth serial console at the same
time so file sync is not a problem either.


hth
lvh



From lvh at laurensvh.be  Sat Mar  6 02:32:01 2010
From: lvh at laurensvh.be (Laurens Van Houtven)
Date: Sat, 6 Mar 2010 10:32:01 +0100
Subject: [Twisted-Python] R: Twisted Python on Nokia E71x (Running the
	phone Python Interpreter)
In-Reply-To: <cedc0c091003051222r1cf1fce9qbaaafb8f477309f@mail.gmail.com>
References: <25872107.3208241267780849194.JavaMail.defaultUser@defaultHost>
	<4B90D300.8060804@thiengineering.ch>
	<cedc0c091003051222r1cf1fce9qbaaafb8f477309f@mail.gmail.com>
Message-ID: <cedc0c091003060132i5c3a5a05w7c8e9a2a7b34e7d@mail.gmail.com>

On a different note: has anyone figured out how to make the PyS60 GUI
abstraction layer (appuifw) work with Twisted?

Almost all of the API (the stuff that isn't stdlib) is non-blocking,
but I have no idea how to make it work nicely with the Twisted
reactor. So far I'm writing the app on it using just the stdlib but
that's proving to be amazingly annoying (no way of doing ssl cert
verification? really?) :-|


Thanks in advance,
Laurens



From jml at mumak.net  Sat Mar  6 11:33:37 2010
From: jml at mumak.net (Jonathan Lange)
Date: Sat, 6 Mar 2010 18:33:37 +0000
Subject: [Twisted-Python] 10.0.0 post-release actions
Message-ID: <d06a5cd31003061033t5491eb3al2bebe9b0b5bed69d@mail.gmail.com>

Hello all,

10.0.0 is well-and-truly released. Jean-Paul has just updated the
website documentation and I've made notes on what he did and stored it
at http://twistedmatrix.com/trac/wiki/ReleaseProcess.

My plan now is this:
  * Roll out a 10.0.1 release
  * Give ReleaseProcess a lot of love, turning it into a readable,
useful document rather than a bunch of raw data
  * Make sure tickets are filed on all of the hard bits of the process
  * Schedule a 10.1 release
  * Fix the tickets that made the process hard
  * Do the 10.1 release
  * Find someone willing to be release manager for 10.2 and 10.3

Regarding the 10.0.1 release. The milestone[1] has two open tickets,
one of which has a patch sans tests, and the other is mostly minor
defects. I will try to roll out a 10.0.1 release soon that fixes both
of these issues.

There is also an open ticket which *might* be a regression:
http://twistedmatrix.com/trac/ticket/4351.

What you can do to help:
  * Investigate #4351 and decide whether or not it's a regression
  * Land a patch for http://twistedmatrix.com/trac/ticket/4210
  * Fix tickets on the regular-releases milestone[2]

cheers,
jml

[1] http://twistedmatrix.com/trac/query?status=new&status=assigned&status=reopened&milestone=Twisted-10.0&order=priority
[2] http://twistedmatrix.com/trac/query?status=new&status=assigned&status=reopened&milestone=regular-releases&order=priority



From jml at mumak.net  Sat Mar  6 11:38:36 2010
From: jml at mumak.net (Jonathan Lange)
Date: Sat, 6 Mar 2010 18:38:36 +0000
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
Message-ID: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>

Hello all,

Ubuntu's "Lucid Lynx" is now in feature freeze, meaning that it won't
automatically take new versions of packages (see
https://wiki.ubuntu.com/FeatureFreeze).

Since we've just released Twisted 10.0.0 and since the release is
awesome, stable, low-risk and a great thing to have in the next
long-term support version of Ubuntu, I think we should strive to get a
"Feature Freeze expection" (aka an "FFe").

I've followed the https://wiki.ubuntu.com/FreezeExceptionProcess and
have filed a bug at
https://bugs.edge.launchpad.net/ubuntu/+source/twisted/+bug/531977.
But I need help.

The FFe process requires a packaged version of the new release, along
with build files and what not. I lack the expertise to do this, so I'd
very much appreciate it if someone here who knows Debian/Ubuntu
packaging could please package the new 10.0.0 release and attach the
relevant files to the bug.

Thanks,
jml



From exarkun at twistedmatrix.com  Sat Mar  6 22:05:15 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 07 Mar 2010 05:05:15 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1267938315.66.1779965534@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100307/fd281f50/attachment.html>

From free at 64studio.com  Sun Mar  7 06:02:06 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Sun, 07 Mar 2010 14:02:06 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	(Jonathan Lange's message of "Sat, 6 Mar 2010 18:38:36 +0000")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
Message-ID: <87hbosgu9d.fsf@canonical.com>

Hi Jonathan,

|--==> On Sat, 6 Mar 2010 18:38:36 +0000, Jonathan Lange <jml at mumak.net> said:

  JL> Since we've just released Twisted 10.0.0 and since the release is
  JL> awesome, stable, low-risk and a great thing to have in the next
  JL> long-term support version of Ubuntu, I think we should strive to get a
  JL> "Feature Freeze expection" (aka an "FFe").

Definitely. I guess this involves updating all the various twisted-X
packages.

  JL> I've followed the https://wiki.ubuntu.com/FreezeExceptionProcess and
  JL> have filed a bug at
  JL> https://bugs.edge.launchpad.net/ubuntu/+source/twisted/+bug/531977.
  JL> But I need help.

If we want to update all twisted Ubuntu packages and not only the -core
one, I *think* we need a separate bug filed against each of them. A
quick answer on #ubuntu-devel should clear this out.

It looks like the only API removal that could raise compatibility issues
is:

 - The deprecated connectUDP method of IReactorUDP has now been
   removed. (#4075)

I'm wondering if there's any code in Ubuntu packages relying on it.

  JL> The FFe process requires a packaged version of the new release, along
  JL> with build files and what not. I lack the expertise to do this, so I'd
  JL> very much appreciate it if someone here who knows Debian/Ubuntu
  JL> packaging could please package the new 10.0.0 release and attach the
  JL> relevant files to the bug.

Have you already asked Matthias Klose (the maintainer) if he is
interested in updating the packages himself? If not, I'll be glad to
help out.

Ciao!

Free



From jml at mumak.net  Sun Mar  7 06:10:46 2010
From: jml at mumak.net (Jonathan Lange)
Date: Sun, 7 Mar 2010 13:10:46 +0000
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87hbosgu9d.fsf@canonical.com>
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
Message-ID: <d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>

On Sun, Mar 7, 2010 at 1:02 PM, Free Ekanayaka <free at 64studio.com> wrote:
> Hi Jonathan,
>
> |--==> On Sat, 6 Mar 2010 18:38:36 +0000, Jonathan Lange <jml at mumak.net> said:
>
> JL> Since we've just released Twisted 10.0.0 and since the release is
> JL> awesome, stable, low-risk and a great thing to have in the next
> JL> long-term support version of Ubuntu, I think we should strive to get a
> JL> "Feature Freeze expection" (aka an "FFe").
>
> Definitely. I guess this involves updating all the various twisted-X
> packages.
>
> JL> I've followed the https://wiki.ubuntu.com/FreezeExceptionProcess and
> JL> have filed a bug at
> JL> https://bugs.edge.launchpad.net/ubuntu/+source/twisted/+bug/531977.
> JL> But I need help.
>
> If we want to update all twisted Ubuntu packages and not only the -core
> one, I *think* we need a separate bug filed against each of them. A
> quick answer on #ubuntu-devel should clear this out.
>

They have separate source packages? If so, yes we would need separate FFes.

Do you want to do this?

> It looks like the only API removal that could raise compatibility issues
> is:
>
> - The deprecated connectUDP method of IReactorUDP has now been
>  removed. (#4075)
>
> I'm wondering if there's any code in Ubuntu packages relying on it.
>

How would we find out?

> JL> The FFe process requires a packaged version of the new release, along
> JL> with build files and what not. I lack the expertise to do this, so I'd
> JL> very much appreciate it if someone here who knows Debian/Ubuntu
> JL> packaging could please package the new 10.0.0 release and attach the
> JL> relevant files to the bug.
>
> Have you already asked Matthias Klose (the maintainer) if he is
> interested in updating the packages himself? If not, I'll be glad to
> help out.
>

No, I haven't. It'd be great if you could sort this out.

Thanks,
jml



From free at 64studio.com  Sun Mar  7 07:20:23 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Sun, 07 Mar 2010 15:20:23 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	(Jonathan Lange's message of "Sun, 7 Mar 2010 13:10:46 +0000")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
Message-ID: <87d3zggqmw.fsf@canonical.com>

|--==> On Sun, 7 Mar 2010 13:10:46 +0000, Jonathan Lange <jml at mumak.net> said:

  >>If we want to update all twisted Ubuntu packages and not only the -core
  >>one, I *think* we need a separate bug filed against each of them. A
  >>quick answer on #ubuntu-devel should clear this out.
  >>

  > They have separate source packages? If so, yes we would need
  > separate FFes.

Yes, the have separate source packages.

  > Do you want to do this?

Sure.

  >>It looks like the only API removal that could raise compatibility issues
  >>is:
  >>
  >>- The deprecated connectUDP method of IReactorUDP has now been
  >> removed. (#4075)
  >>
  >>I'm wondering if there's any code in Ubuntu packages relying on it.
  >>

  > How would we find out?

Good question. Something like pulling the source packages of all
packages directly or indirectly depending on python-twisted-core and
grepping for connectUDP.

  >>Have you already asked Matthias Klose (the maintainer) if he is
  >>interested in updating the packages himself? If not, I'll be glad to
  >>help out.
  >>

  > No, I haven't. It'd be great if you could sort this out.

Okay, I'll check that.

Ciao!

Free



From exarkun at twistedmatrix.com  Sun Mar  7 07:54:23 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 07 Mar 2010 14:54:23 -0000
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87d3zggqmw.fsf@canonical.com>
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
Message-ID: <20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>

On 02:20 pm, free at 64studio.com wrote:
>|--==> On Sun, 7 Mar 2010 13:10:46 +0000, Jonathan Lange 
><jml at mumak.net> said:
>
>  >>If we want to update all twisted Ubuntu packages and not only the 
>-core
>  >>one, I *think* we need a separate bug filed against each of them. A
>  >>quick answer on #ubuntu-devel should clear this out.
>  >>
>
>  > They have separate source packages? If so, yes we would need
>  > separate FFes.
>
>Yes, the have separate source packages.
>
>  > Do you want to do this?
>
>Sure.
>
>  >>It looks like the only API removal that could raise compatibility 
>issues
>  >>is:
>  >>
>  >>- The deprecated connectUDP method of IReactorUDP has now been
>  >> removed. (#4075)
>  >>
>  >>I'm wondering if there's any code in Ubuntu packages relying on it.
>  >>
>
>  > How would we find out?
>
>Good question. Something like pulling the source packages of all
>packages directly or indirectly depending on python-twisted-core and
>grepping for connectUDP.

I looked at the direct (apt-cache rdepends python-twisted | tail -n +3) 
and once removed (apt-cache rdepends python-twisted | tail -n +3 | xargs 
-iF bash -c 'apt-cache rdepends F | tail -n +3' | sort | uniq) 
dependencies of python-twisted.

One package refers to connectUDP, flumotion.  It doesn't appear to 
actually use it, though; instead it seems to be monkey-patching it to 
correct a documentation issue.  I don't think the removal will break 
this package, but it may result in flumotion-generated Twisted docs 
which include connectUDP, even though it no longer exists.
>
>  >>Have you already asked Matthias Klose (the maintainer) if he is
>  >>interested in updating the packages himself? If not, I'll be glad to
>  >>help out.
>  >>
>
>  > No, I haven't. It'd be great if you could sort this out.
>
>Okay, I'll check that.
>
>Ciao!

Thanks!

Jean-Paul



From darren at ontrenet.com  Sun Mar  7 08:10:51 2010
From: darren at ontrenet.com (Darren Govoni)
Date: Sun, 07 Mar 2010 10:10:51 -0500
Subject: [Twisted-Python] Synchronous byte streaming
Message-ID: <1267974651.10456.43.camel@kratos>

Hi,
  I received some great advice in the past about using
Int32StringReceiver to be able to send a reliable message of bytes
from the client to the server without hassling with unordered or partial
messages. Seems to work.

But I have one problem. My client iterates over a file sending 7MB byte
messages to transport.sendString() to a server.
What i see is that the client seems to buffer or wait to send those.
After a few hundred sendStrings() still the server has not received one
message. The result is my client gets throttled bad in terms of disk and
memory. After all my sendString writes, then eventually the server
receives the first message. But my computer is 100% max'd out.  highly
undesirable.

What I want is for each on-the-wire send to complete, before sendString
returns so resources can be managed properly.

Is there _any_ way in Twisted to do this?

thanks for any tips!!

Darren
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100307/9d06698d/attachment-0001.html>

From exarkun at twistedmatrix.com  Sun Mar  7 08:19:55 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 07 Mar 2010 15:19:55 -0000
Subject: [Twisted-Python] Synchronous byte streaming
In-Reply-To: <1267974651.10456.43.camel@kratos>
References: <1267974651.10456.43.camel@kratos>
Message-ID: <20100307151955.2792.950916271.divmod.xquotient.1375@localhost.localdomain>

On 03:10 pm, darren at ontrenet.com wrote:
>Hi,
>  I received some great advice in the past about using
>Int32StringReceiver to be able to send a reliable message of bytes
>from the client to the server without hassling with unordered or 
>partial
>messages. Seems to work.
>
>But I have one problem. My client iterates over a file sending 7MB byte
>messages to transport.sendString() to a server.
>What i see is that the client seems to buffer or wait to send those.
>After a few hundred sendStrings() still the server has not received one
>message. The result is my client gets throttled bad in terms of disk 
>and
>memory. After all my sendString writes, then eventually the server
>receives the first message. But my computer is 100% max'd out.  highly
>undesirable.
>
>What I want is for each on-the-wire send to complete, before sendString
>returns so resources can be managed properly.
>
>Is there _any_ way in Twisted to do this?

You want to make your client use the producer/consumer APIs.  You can 
find some docs here:

  http://twistedmatrix.com/documents/current/core/howto/producers.html

Here's a simple example of what you might do:

    class SendSomeStuff(Int32StringReceiver):
        def connectionMade(self):
            self.transport.registerProducer(self, False)

        def resumeProducing(self):
            self.sendString(self.someFileObj.read(2 ** 16))


This is missing error handling some of the other required parts of the 
producer interface, but it should get you started.

Jean-Paul



From darren at ontrenet.com  Sun Mar  7 08:33:02 2010
From: darren at ontrenet.com (Darren Govoni)
Date: Sun, 07 Mar 2010 10:33:02 -0500
Subject: [Twisted-Python] Synchronous byte streaming
In-Reply-To: <20100307151955.2792.950916271.divmod.xquotient.1375@localhost.localdomain>
References: <1267974651.10456.43.camel@kratos>
	<20100307151955.2792.950916271.divmod.xquotient.1375@localhost.localdomain>
Message-ID: <1267975982.10456.44.camel@kratos>

Many thanks! I will try it.

On Sun, 2010-03-07 at 15:19 +0000, exarkun at twistedmatrix.com wrote:

> 
> You want to make your client use the producer/consumer APIs.  You can 
> find some docs here:
> 
> 
> http://twistedmatrix.com/documents/current/core/howto/producers.html 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100307/86535357/attachment.html>

From sleeepd at gmail.com  Sun Mar  7 22:36:28 2010
From: sleeepd at gmail.com (sleepd)
Date: Mon, 8 Mar 2010 13:36:28 +0800
Subject: [Twisted-Python] How to use time-base event in reactor?
Message-ID: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>

I am developing a online RTS game server, some event a base by time,
example: a buff grant Max HP for 30 seconds, spawn army ever 30 seconds...

I plan to use a timer to manage it, but Twisted are event-driven, how to put
this timer in reactor's loop?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100308/65ac1c85/attachment-0001.html>

From radix at twistedmatrix.com  Sun Mar  7 23:46:10 2010
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 8 Mar 2010 00:46:10 -0600
Subject: [Twisted-Python] How to use time-base event in reactor?
In-Reply-To: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
Message-ID: <60ed19d41003072246i31da37e1ndfff9967936a23fb@mail.gmail.com>

On Sun, Mar 7, 2010 at 11:36 PM, sleepd <sleeepd at gmail.com> wrote:
> I am developing a online RTS game server, some event a base by time,
> example: a buff grant Max HP for 30 seconds, spawn army ever 30 seconds...
> I plan to use a timer to manage it, but Twisted areevent-driven, how to put
> this timer in reactor's loop?

See:

reactor.callLater

twisted.internet.task.LoopingCall



-- 
Christopher Armstrong
http://radix.twistedmatrix.com/
http://planet-if.com/



From free at 64studio.com  Mon Mar  8 03:30:18 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Mon, 08 Mar 2010 11:30:18 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	(exarkun@twistedmatrix.com's message of "Sun, 07 Mar 2010 14:54:23
	-0000")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
Message-ID: <87hbor2jid.fsf@canonical.com>

Hi,

|--==> On Sun, 07 Mar 2010 14:54:23 -0000, exarkun at twistedmatrix.com said:

  >>Good question. Something like pulling the source packages of all
  >>packages directly or indirectly depending on python-twisted-core and
  >>grepping for connectUDP.

  > I looked at the direct (apt-cache rdepends python-twisted | tail -n
  > +3) and once removed (apt-cache rdepends python-twisted | tail -n +3 |
  > xargs -iF bash -c 'apt-cache rdepends F | tail -n +3' | sort | uniq)
  > dependencies of python-twisted.

  > One package refers to connectUDP, flumotion.  It doesn't appear to
  > actually use it, though; instead it seems to be monkey-patching it to
  > correct a documentation issue.  I don't think the removal will break
  > this package, but it may result in flumotion-generated Twisted docs
  > which include connectUDP, even though it no longer exists.

Thanks for checking, it looks we're good then.

  >>>>Have you already asked Matthias Klose (the maintainer) if he is
  >>>>interested in updating the packages himself? If not, I'll be glad to
  >>>>help out.
  >>>>
  >>
  >>> No, I haven't. It'd be great if you could sort this out.
  >>
  >>Okay, I'll check that.

Matthias said he thinks that a Feature Freeze Exception is fine for
Twisted 10.0.0, and I can go on packaging it. There are quite a few
source packages to update, I'll try to do it in the coming days.

Ciao!

Free



From Sven-Erik.Tiberg at ltu.se  Mon Mar  8 04:55:10 2010
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Mon, 8 Mar 2010 12:55:10 +0100
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
Message-ID: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>

Hi

Setting up ejabberd server and python.twisted clients for interactive3D.
In for example the lib...twisted.words.protocols.jabber\component.py there are a call to zope.interface.

Doesnt seems to be a call to the zope db-server that powers Plone servers, is that correct?
PS. having plone/zope servers running at the same server that can be running xmpp___.py clients.

BG
Sven-Erik Tiberg
Lulea Univ of technology / Sweden

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100308/d6424283/attachment.html>

From itamar at itamarst.org  Mon Mar  8 05:47:04 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 08 Mar 2010 07:47:04 -0500
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
Message-ID: <1268052425.5589.150.camel@pintsize>

On Mon, 2010-03-08 at 12:55 +0100, Sven-Erik Tiberg wrote:
> Hi
>  
> Setting up ejabberd server and python.twisted clients for
> interactive3D.
> In for example the lib...twisted.words.protocols.jabber\component.py
> there are a call to zope.interface.
>  
> Doesnt seems to be a call to the zope db-server that powers Plone
> servers, is that correct?
> PS. having plone/zope servers running at the same server that can be
> running xmpp___.py clients.

zope.interface is a very small library; the fact it has "zope" in the
name doesn't mean it uses the full capabilities of a Zope server. You
are correct, it does not use the Zope database.

You can download it separately here:
http://pypi.python.org/pypi/zope.interface#download





From Sven-Erik.Tiberg at ltu.se  Mon Mar  8 07:36:22 2010
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Mon, 8 Mar 2010 15:36:22 +0100
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <1268052425.5589.150.camel@pintsize>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
	<1268052425.5589.150.camel@pintsize>
Message-ID: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB92@VERA.personal.adp.ltu.se>

Thanks

Only to clearify:
Has zope.interface any depedencies/connection with the Zope web application server primarily written in the Python programming language  ( http://www.zope.org/WhatIsZope ). 

Note: zope "web application server" uses ZODB ( http://docs.zope.org/zodb/ ) as data base. 
And plone (http://plone.org ) a CMS system are based on zope.

More notes on http://wbsp.arb.ltu.se/3DNetwork/

BG
Sven-Erik Tiberg



-----Original Message-----
From: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-bounces at twistedmatrix.com] On Behalf Of Itamar Turner-Trauring
Sent: den 8 mars 2010 13:47
To: Twisted general discussion
Subject: Re: [Twisted-Python] zope.interface?

On Mon, 2010-03-08 at 12:55 +0100, Sven-Erik Tiberg wrote:
> Hi
>  
> Setting up ejabberd server and python.twisted clients for 
> interactive3D.
> In for example the lib...twisted.words.protocols.jabber\component.py
> there are a call to zope.interface.
>  
> Doesnt seems to be a call to the zope db-server that powers Plone 
> servers, is that correct?
> PS. having plone/zope servers running at the same server that can be 
> running xmpp___.py clients.

zope.interface is a very small library; the fact it has "zope" in the name doesn't mean it uses the full capabilities of a Zope server. You are correct, it does not use the Zope database.

You can download it separately here:
http://pypi.python.org/pypi/zope.interface#download



_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From itamar at itamarst.org  Mon Mar  8 07:47:39 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 08 Mar 2010 09:47:39 -0500
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB92@VERA.personal.adp.ltu.se>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
	<1268052425.5589.150.camel@pintsize>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB92@VERA.personal.adp.ltu.se>
Message-ID: <1268059659.3486.4.camel@pintsize>

On Mon, 2010-03-08 at 15:36 +0100, Sven-Erik Tiberg wrote:
> Thanks
> 
> Only to clearify:
> Has zope.interface any depedencies/connection with the Zope web
> application server primarily written in the Python programming
> language  ( http://www.zope.org/WhatIsZope ). 
> 
> Note: zope "web application server" uses ZODB
> ( http://docs.zope.org/zodb/ ) as data base. 
> And plone (http://plone.org ) a CMS system are based on zope.

They are connected, yes. zope.interface is maintained by Zope people,
but it's only a small subset of their code:

1. Twisted depends on zope.interface
2. Zope depends on zope.interface

But

3. Twisted does *not* depend on Zope, ZODB, Plone, etc..

You can pretend it's just called "interface" if that helps :)




From Sven-Erik.Tiberg at ltu.se  Mon Mar  8 08:43:12 2010
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Mon, 8 Mar 2010 16:43:12 +0100
Subject: [Twisted-Python] zope.interface?
In-Reply-To: <1268059659.3486.4.camel@pintsize>
References: <4fe037b11003072136i393b40abm2ab590c882734e30@mail.gmail.com>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB8F@VERA.personal.adp.ltu.se>
	<1268052425.5589.150.camel@pintsize>
	<610858C4350B6C4693B7D1AE08074D2ACCE0D1CB92@VERA.personal.adp.ltu.se>
	<1268059659.3486.4.camel@pintsize>
Message-ID: <610858C4350B6C4693B7D1AE08074D2ACCE0D1CB95@VERA.personal.adp.ltu.se>

It's even more "challanging" ZOPE vers. uses a modified zope.interface lib.
Not a great idea to run both plone and python.twisted... On the same windows mashine, thoung it could eb a challange but better save time to the main project goal.

BG
Sven-Erik 

-----Original Message-----
From: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-bounces at twistedmatrix.com] On Behalf Of Itamar Turner-Trauring
Sent: den 8 mars 2010 15:48
To: Twisted general discussion
Subject: Re: [Twisted-Python] zope.interface?

On Mon, 2010-03-08 at 15:36 +0100, Sven-Erik Tiberg wrote:
> Thanks
> 
> Only to clearify:
> Has zope.interface any depedencies/connection with the Zope web 
> application server primarily written in the Python programming 
> language  ( http://www.zope.org/WhatIsZope ).
> 
> Note: zope "web application server" uses ZODB ( 
> http://docs.zope.org/zodb/ ) as data base.
> And plone (http://plone.org ) a CMS system are based on zope.

They are connected, yes. zope.interface is maintained by Zope people, but it's only a small subset of their code:

1. Twisted depends on zope.interface
2. Zope depends on zope.interface

But

3. Twisted does *not* depend on Zope, ZODB, Plone, etc..

You can pretend it's just called "interface" if that helps :)


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From esteve at sindominio.net  Mon Mar  8 14:37:12 2010
From: esteve at sindominio.net (Esteve Fernandez)
Date: Mon, 8 Mar 2010 22:37:12 +0100 (CET)
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87hbor2jid.fsf@canonical.com>
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
Message-ID: <12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>

Hi

> Matthias said he thinks that a Feature Freeze Exception is fine for
> Twisted 10.0.0, and I can go on packaging it. There are quite a few
> source packages to update, I'll try to do it in the coming days.

I uploaded updated version of all the packages to our PPA [1] and requested a
sponsored upload. I've also rebuilt the packages for Karmic, and made a
backport for Hardy for those of us who are not on the bleeding edge :-)

Cheers.

1 - https://launchpad.net/~twisted-dev/+archive/ppa




From free at 64studio.com  Mon Mar  8 17:40:39 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Tue, 09 Mar 2010 01:40:39 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
	(Esteve Fernandez's message of "Mon, 8 Mar 2010 22:37:12 +0100 (CET)")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
	<12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
Message-ID: <87r5nu1g54.fsf@canonical.com>

Hi Esteve,

|--==> On Mon, 8 Mar 2010 22:37:12 +0100 (CET), "Esteve Fernandez" <esteve at sindominio.net> said:

  EF> Hi
  >>Matthias said he thinks that a Feature Freeze Exception is fine for
  >>Twisted 10.0.0, and I can go on packaging it. There are quite a few
  >>source packages to update, I'll try to do it in the coming days.

  EF> I uploaded updated version of all the packages to our PPA [1] and requested a
  EF> sponsored upload. I've also rebuilt the packages for Karmic, and made a
  EF> backport for Hardy for those of us who are not on the bleeding edge :-)

  EF> 1 - https://launchpad.net/~twisted-dev/+archive/ppa

Nice job. I can sponsor the upload to Debian, if that helps (I guess
once all packages are in Debian we can request a sync, and it probably
makes sense as anyway we want to eventually have them in Debian as
well).

I didn't review all the packages yet, but there is one problem with the
python-twisted-core binary package:

~% dpkg -c python-twisted-core_10.0.0-0\~ppa1\~lucid1_all.deb|grep _initgroups.so
-rw-r--r-- root/root     15876 2010-03-08 15:27 ./usr/lib/python2.6/dist-packages/twisted/python/_initgroups.so

The package should be architecture-independent (Architecture: all) and
not ship compiled binaries for C extensions like initgroups, which
should go in the python-twisted-bin package. Otherwise the package will
be built on a random builder and the resulting arch-dependent binary
module will be shipped to all architectures.

Fwiw I uploaded the core twisted source package to Debian today.

http://packages.qa.debian.org/t/twisted.html

Ciao!

Free



From esteve at sindominio.net  Tue Mar  9 05:03:31 2010
From: esteve at sindominio.net (Esteve Fernandez)
Date: Tue, 9 Mar 2010 13:03:31 +0100 (CET)
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87r5nu1g54.fsf@canonical.com>
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
	<12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
	<87r5nu1g54.fsf@canonical.com>
Message-ID: <69176f9efd48b6c2d86afa212264d12b.squirrel@webmail.sindominio.net>

Hi Free

> Nice job. I can sponsor the upload to Debian, if that helps (I guess
> once all packages are in Debian we can request a sync, and it probably
> makes sense as anyway we want to eventually have them in Debian as
> well).

Thanks! However, there are some glitches in the packages you uploaded to Debian:

- they skipped 9.0.0-2, and thus #566395 and #566913 are open again
- python-twisted doesn't depend on >= 10.0.0, but >= 9.0

Those bugs were fixed in the packages in our PPA, though.

> ~% dpkg -c python-twisted-core_10.0.0-0\~ppa1\~lucid1_all.deb|grep
> _initgroups.so
> -rw-r--r-- root/root     15876 2010-03-08 15:27
> ./usr/lib/python2.6/dist-packages/twisted/python/_initgroups.so

Thanks, I didn't notice that, I should have read the NEWS file :-P

What should we do next? Can the currently packages in Debian be revoked or do
we have to prepare new ones?

Cheers.




From free at 64studio.com  Tue Mar  9 05:39:01 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Tue, 09 Mar 2010 13:39:01 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <69176f9efd48b6c2d86afa212264d12b.squirrel@webmail.sindominio.net>
	(Esteve Fernandez's message of "Tue, 9 Mar 2010 13:03:31 +0100 (CET)")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
	<12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
	<87r5nu1g54.fsf@canonical.com>
	<69176f9efd48b6c2d86afa212264d12b.squirrel@webmail.sindominio.net>
Message-ID: <87wrxlvfdm.fsf@canonical.com>

Hi Esteve,

|--==> On Tue, 9 Mar 2010 13:03:31 +0100 (CET), "Esteve Fernandez" <esteve at sindominio.net> said:

  EF> Thanks! However, there are some glitches in the packages you uploaded to Debian:

  EF> - they skipped 9.0.0-2, and thus #566395 and #566913 are open again
  EF> - python-twisted doesn't depend on >= 10.0.0, but >= 9.0

Oh, you're right! Thanks for reporting.

  EF> Those bugs were fixed in the packages in our PPA, though.

Apart from these tweaks to the core twisted source package, are there
other particular changes you had to do in the rest of twisted-X source
packages in the PPA?

  EF> What should we do next? Can the currently packages in Debian be revoked or do
  EF> we have to prepare new ones?

I've just prepared a new revision (10.0.0-2) with the two fixes you
reported and gonna upload it soon.

Ciao!

Free



From free at 64studio.com  Tue Mar  9 09:17:54 2010
From: free at 64studio.com (Free Ekanayaka)
Date: Tue, 09 Mar 2010 17:17:54 +0100
Subject: [Twisted-Python] Get Twisted 10.0 in to Ubuntu 10.04 LTS
In-Reply-To: <87wrxlvfdm.fsf@canonical.com> (Free Ekanayaka's message of "Tue, 
	09 Mar 2010 13:39:01 +0100")
References: <d06a5cd31003061038l7e00ba22hfe70114229339edd@mail.gmail.com>
	<87hbosgu9d.fsf@canonical.com>
	<d06a5cd31003070510k7f01c2a9g9cb8565482f565f2@mail.gmail.com>
	<87d3zggqmw.fsf@canonical.com>
	<20100307145423.2792.2134202537.divmod.xquotient.1365@localhost.localdomain>
	<87hbor2jid.fsf@canonical.com>
	<12da744ce9de377a09043a36a7d81971.squirrel@webmail.sindominio.net>
	<87r5nu1g54.fsf@canonical.com>
	<69176f9efd48b6c2d86afa212264d12b.squirrel@webmail.sindominio.net>
	<87wrxlvfdm.fsf@canonical.com>
Message-ID: <87fx49v58t.fsf@canonical.com>

Hi,

|--==> On Tue, 09 Mar 2010 13:39:01 +0100, Free Ekanayaka <free at 64studio.com> said:

  EF> What should we do next? Can the currently packages in Debian be revoked or do
  EF> we have to prepare new ones?

  FE> I've just prepared a new revision (10.0.0-2) with the two fixes you
  FE> reported and gonna upload it soon.

That's uploaded to Debian/unstable along with the other twisted-X source
packages.

I'm going to request a sync for the Lucid packages.

Ciao!

Free



From dvkeeney at gmail.com  Tue Mar  9 10:21:49 2010
From: dvkeeney at gmail.com (David)
Date: Tue, 9 Mar 2010 10:21:49 -0700
Subject: [Twisted-Python] web2 -> web ToDo List
In-Reply-To: <562bcc11002061033i61a22c3yf37f9b8c4614a20f@mail.gmail.com>
References: <2F213830-E178-46BB-A225-721F656680EC@gmail.com>
	<20100206153444.26099.538054602.divmod.xquotient.508@localhost.localdomain>
	<BF7D3202-9A60-46C0-97DE-2D0CBF894CB9@gmail.com>
	<20100206172345.26099.1877063066.divmod.xquotient.534@localhost.localdomain>
	<562bcc11002061033i61a22c3yf37f9b8c4614a20f@mail.gmail.com>
Message-ID: <6e04113a1003090921x6fb4ac4cxc5771ce02c599135@mail.gmail.com>

>> Awesome, thanks for adding to the list. :) Now that there are two items
>> on it, I've added a section to the end of
>> <http://twistedmatrix.com/trac/wiki/TwistedWebPlan>. I encourage anyone
>> with interest in this area to suggest more items for this list.


Does nobody care about web2's rational separation of Request and
Response objects, or the use of header dictionaries and ByteStreams in
the response?

The approach used in web (render() returning a string or a
'NOT_DONE_YET' and then writing through the request and calling
finish() IIRC) is clunky and confusing.

Is there a way to backport the web2 system and retain backward
compatibility with existing user code?


Unaware of web2 until recently, I previously subclassed web.http and
web.server to implement upload streaming, and found myself rewriting
'private' methods.  'private' in this case refers to methods that are
commented as 'not intended for users'.  It would be nice to expose
many of the request parsing methods to users, and restructure the
request parsing so that method overriding can be done cleanly.

This is similar to, but maybe more ambitious than, one of the items
previously mentioned in the web2 features-to-backport list.



-- 
dkeeney at travelbyroad.net
Rdbhost -> SQL databases as a webservice [www.rdbhost.com]



From exarkun at twistedmatrix.com  Tue Mar  9 10:59:39 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 09 Mar 2010 17:59:39 -0000
Subject: [Twisted-Python] web2 -> web ToDo List
In-Reply-To: <6e04113a1003090921x6fb4ac4cxc5771ce02c599135@mail.gmail.com>
References: <2F213830-E178-46BB-A225-721F656680EC@gmail.com>
	<20100206153444.26099.538054602.divmod.xquotient.508@localhost.localdomain>
	<BF7D3202-9A60-46C0-97DE-2D0CBF894CB9@gmail.com>
	<20100206172345.26099.1877063066.divmod.xquotient.534@localhost.localdomain>
	<562bcc11002061033i61a22c3yf37f9b8c4614a20f@mail.gmail.com>
	<6e04113a1003090921x6fb4ac4cxc5771ce02c599135@mail.gmail.com>
Message-ID: <20100309175939.2792.1510691846.divmod.xquotient.1454@localhost.localdomain>

On 05:21 pm, dvkeeney at gmail.com wrote:
>>>Awesome, thanks for adding to the list. :) Now that there are two 
>>>items
>>>on it, I've added a section to the end of
>>><http://twistedmatrix.com/trac/wiki/TwistedWebPlan>. I encourage 
>>>anyone
>>>with interest in this area to suggest more items for this list.
>
>Does nobody care about web2's rational separation of Request and
>Response objects, or the use of header dictionaries and ByteStreams in
>the response?
>
>The approach used in web (render() returning a string or a
>'NOT_DONE_YET' and then writing through the request and calling
>finish() IIRC) is clunky and confusing.

Separation of Request and Response is a good idea, I think.  Chris 
Armstrong started working on this some time ago (a year?  two?) but I 
think the amount of work involved was more than he bargained for and as 
far as I know he doesn't have any specific plans to complete the work.

The ticket for that is http://twistedmatrix.com/trac/ticket/2983

There's also a ticket for allowing render to return a Deferred, #3711. 
And similarly, one to allow getChild to return a Deferred, #3621.

I've added links to these tickets to the TwistedWebPlan page.

The plan is to not backport the streams APIs, but instead support the 
existing producer/consumer APIs in more places, or to come up with 
streaming APIs which can be used throughout Twisted, get them into core, 
and then use them in Twisted Web (or perhaps do both of these).

I'm not sure what you mean when you say "use of header dictionaries".
>
>Is there a way to backport the web2 system and retain backward
>compatibility with existing user code?

There should be, yes.  The details depend on the specifics of the APIs, 
of course.
>
>Unaware of web2 until recently, I previously subclassed web.http and
>web.server to implement upload streaming, and found myself rewriting
>'private' methods.  'private' in this case refers to methods that are
>commented as 'not intended for users'.  It would be nice to expose
>many of the request parsing methods to users, and restructure the
>request parsing so that method overriding can be done cleanly.
>
>This is similar to, but maybe more ambitious than, one of the items
>previously mentioned in the web2 features-to-backport list.

These comments are from a time before our current compatibility policy. 
Very likely they should all be deleted.  If you can use or override a 
method without touching something that starts with an underscore, then 
it's public.

Another, perhaps better, argument against touching these bits is that 
they're probably not very well tested.  However, this is easily fixed, 
just contribute tests (and in some cases, documentation) for them. :)

Jean-Paul



From ben at bbarker.co.uk  Wed Mar 10 03:35:01 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 10:35:01 +0000
Subject: [Twisted-Python] sniffing multicast traffic
Message-ID: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>

Hello - I wonder if someone can help:

We have some status info being sent by various machines using
multicast addressed udp packets. I have been attempting to use twisted
to write a python script that will passively monitor on the relevant
port for any udp packets with the specified multicast address, which I
can then parse the payloads of as required.

I have been looking at the examples here:

http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/

But I seem to have trouble getting them to receive anything at all.

I have managed to use tshark to display the packets :

tshark -i eth0  -x -l -f udp

so I know the data is there (coming isn on address 224.0.0.4, port 901)

Any suggestions?

B



From larsivi at gmail.com  Wed Mar 10 03:48:25 2010
From: larsivi at gmail.com (Lars Ivar Igesund)
Date: Wed, 10 Mar 2010 11:48:25 +0100
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
Message-ID: <24e981171003100248n26489574k9fbf169c5eb03485@mail.gmail.com>

Hi Ben,

my experience (not with Twisted, but with multicast), is that
multicast often fail to be properly routed (this may be a restriction
on OS, switch, etc). That you see the multicasts on using tshark is no
indication on the routing working properly, as it will catch all
information in promiscous mode, whether routed there or not.

Two possible solutions (that may or may not be easy to in conjunction
with Twisted) are:
 * Route the multicasts explicitly
 * Make the listening socket bind explicitly to the network interface
where you expect/see the multicast. This is the solution I have used
myself, but may require using low level socket functionality. Binding
to localhost (all interfaces at once) or similar did not work for me.

Best regards,
Lars Ivar

On Wed, Mar 10, 2010 at 11:35 AM, Ben Barker <ben at bbarker.co.uk> wrote:
> Hello - I wonder if someone can help:
>
> We have some status info being sent by various machines using
> multicast addressed udp packets. I have been attempting to use twisted
> to write a python script that will passively monitor on the relevant
> port for any udp packets with the specified multicast address, which I
> can then parse the payloads of as required.
>
> I have been looking at the examples here:
>
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>
> But I seem to have trouble getting them to receive anything at all.
>
> I have managed to use tshark to display the packets :
>
> tshark -i eth0 -x -l -f udp
>
> so I know the data is there (coming isn on address 224.0.0.4, port 901)
>
> Any suggestions?
>
> B
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From ben at bbarker.co.uk  Wed Mar 10 04:50:55 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 11:50:55 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <24e981171003100248n26489574k9fbf169c5eb03485@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<24e981171003100248n26489574k9fbf169c5eb03485@mail.gmail.com>
Message-ID: <3df02bfc1003100350l71d79286obcaebd8f3c848bdd@mail.gmail.com>

Thanks Lars - yes, I am not adamant about using twisted, although it
seemed initially to be the best place to stary. I have also been
looking at the pcapy module, which I think may do what I want, but
also seems very low level.

On Wed, Mar 10, 2010 at 10:48 AM, Lars Ivar Igesund <larsivi at gmail.com> wrote:
> Hi Ben,
>
> my experience (not with Twisted, but with multicast), is that
> multicast often fail to be properly routed (this may be a restriction
> on OS, switch, etc). That you see the multicasts on using tshark is no
> indication on the routing working properly, as it will catch all
> information in promiscous mode, whether routed there or not.
>
> Two possible solutions (that may or may not be easy to in conjunction
> with Twisted) are:
> * Route the multicasts explicitly
> * Make the listening socket bind explicitly to the network interface
> where you expect/see the multicast. This is the solution I have used
> myself, but may require using low level socket functionality. Binding
> to localhost (all interfaces at once) or similar did not work for me.
>
> Best regards,
> Lars Ivar
>
> On Wed, Mar 10, 2010 at 11:35 AM, Ben Barker <ben at bbarker.co.uk> wrote:
>> Hello - I wonder if someone can help:
>>
>> We have some status info being sent by various machines using
>> multicast addressed udp packets. I have been attempting to use twisted
>> to write a python script that will passively monitor on the relevant
>> port for any udp packets with the specified multicast address, which I
>> can then parse the payloads of as required.
>>
>> I have been looking at the examples here:
>>
>> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>>
>> But I seem to have trouble getting them to receive anything at all.
>>
>> I have managed to use tshark to display the packets :
>>
>> tshark -i eth0 -x -l -f udp
>>
>> so I know the data is there (coming isn on address 224.0.0.4, port 901)
>>
>> Any suggestions?
>>
>> B
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From p.mayers at imperial.ac.uk  Wed Mar 10 05:03:18 2010
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Wed, 10 Mar 2010 12:03:18 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
Message-ID: <4B978A86.7050905@imperial.ac.uk>

On 10/03/10 10:35, Ben Barker wrote:
> Hello - I wonder if someone can help:
>
> We have some status info being sent by various machines using
> multicast addressed udp packets. I have been attempting to use twisted
> to write a python script that will passively monitor on the relevant
> port for any udp packets with the specified multicast address, which I
> can then parse the payloads of as required.
>
> I have been looking at the examples here:
>
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>
> But I seem to have trouble getting them to receive anything at all.

That's a little vague. Does "trouble" mean "it sometimes works" or 
"never works"?

>
> I have managed to use tshark to display the packets :
>
> tshark -i eth0  -x -l -f udp
>
> so I know the data is there (coming isn on address 224.0.0.4, port 901)

FYI, the 224.0.0.0/24 group is usually not IGMP snooped, and is 
effectively therefore broadcast.

Conversely, groups outside this range require working IGMP querying / 
snooping and some help from (usually) a router, so this may be why you 
chose this range.

Broadly speaking, as long as the UDP socket is listening on the right 
port and you've called joingroup, you should be ok.

Can you post a complete example that isn't working for you?

When your code is running, have a look "/sbin/ip maddr" to ensure the 
group has been added to the socket listen filter.



From ben at bbarker.co.uk  Wed Mar 10 06:03:46 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 13:03:46 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <4B978A86.7050905@imperial.ac.uk>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<4B978A86.7050905@imperial.ac.uk>
Message-ID: <3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>

>> But I seem to have trouble getting them to receive anything at all.
>
> That's a little vague. Does "trouble" mean "it sometimes works" or
> "never works"?
>

Sorry - yes, it was very vague! Never works. If I run wiresahrk I can
see udp packets addressed to 224.0.0.4, port 901, flying past, however
when I run my python script it does not appear to ever receive
anything.

The scritp I am running is almost identical to an exampel I found here:

http://code.activestate.com/recipes/425975-simple-udp-multicast-client-
server-using-twisted/

>>
>> I have managed to use tshark to display the packets :
>>
>> tshark -i eth0 -x -l -f udp
>>
> Can you post a complete example that isn't working for you?
>
> When your code is running, have a look "/sbin/ip maddr" to ensure the
> group has been added to the socket listen filter
eth1
	link  01:00:5e:00:00:04
	link  33:33:ff:7a:7e:4e
	link  01:00:5e:00:00:fb
	link  01:00:5e:00:00:01
	link  33:33:00:00:00:01
	inet  224.0.0.4
	inet  224.0.0.251
	inet  224.0.0.1
	inet6 ff02::1:ff7a:7e4e
	inet6 ff02::1

That's interesting.... eth1 is the wrong interface! In fact, it isn't
connected to anything at all. eth0 is the interface that should be
being used. I will try to swap them around, but presumably this is
something I can specify somwhere...


As I said, the code I am using is taken from the above link, but the
exact listing is given below:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
from twisted.application.internet import MulticastServer

class MulticastServerUDP(DatagramProtocol):
    def startProtocol(self):
        print 'Started Listening'
        # Join a specific multicast group, which is the IP we will respond to
        self.transport.joinGroup('224.0.0.4')

    def datagramReceived(self, datagram, address):
            print "Server Received:" + repr(datagram)


reactor.listenMulticast(901, MulticastServerUDP())
reactor.run()



> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From p.mayers at imperial.ac.uk  Wed Mar 10 06:18:04 2010
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Wed, 10 Mar 2010 13:18:04 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
	<4B978A86.7050905@imperial.ac.uk>
	<3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
Message-ID: <4B979C0C.7000400@imperial.ac.uk>

On 10/03/10 13:03, Ben Barker wrote:
>>> But I seem to have trouble getting them to receive anything at all.
>>
>> That's a little vague. Does "trouble" mean "it sometimes works" or
>> "never works"?
>>
>
> Sorry - yes, it was very vague! Never works. If I run wiresahrk I can
> see udp packets addressed to 224.0.0.4, port 901, flying past, however
> when I run my python script it does not appear to ever receive
> anything.
>
> The scritp I am running is almost identical to an exampel I found here:
>
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-
> server-using-twisted/
>
>>>
>>> I have managed to use tshark to display the packets :
>>>
>>> tshark -i eth0  -x -l -f udp
>>>
>> Can you post a complete example that isn't working for you?
>>
>> When your code is running, have a look "/sbin/ip maddr" to ensure the
>> group has been added to the socket listen filter
> eth1
> 	link  01:00:5e:00:00:04
> 	link  33:33:ff:7a:7e:4e
> 	link  01:00:5e:00:00:fb
> 	link  01:00:5e:00:00:01
> 	link  33:33:00:00:00:01
> 	inet  224.0.0.4
> 	inet  224.0.0.251
> 	inet  224.0.0.1
> 	inet6 ff02::1:ff7a:7e4e
> 	inet6 ff02::1
>
> That's interesting.... eth1 is the wrong interface! In fact, it isn't
> connected to anything at all. eth0 is the interface that should be
> being used. I will try to swap them around, but presumably this is
> something I can specify somwhere...

Hmm. What does "ip route" say? Do you have 224.0.0.0/4 routed out of 
eth1 somehow?



From ben at bbarker.co.uk  Wed Mar 10 06:18:28 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 13:18:28 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<4B978A86.7050905@imperial.ac.uk>
	<3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
Message-ID: <3df02bfc1003100518o3f26832cl522ba0ab9eef4cee@mail.gmail.com>

Well that's odd...

I changed the interfaces over - used eth1 for the connection to the
network I need to sniff...

and now /sbin/ip maddr tells me I have joined 224.0.0.4 on eth0 !

Whichever interface is live, the join seems to happen on the other :-p

What could there be about my network config that is making this happen :-p

On Wed, Mar 10, 2010 at 1:03 PM, Ben Barker <ben at bbarker.co.uk> wrote:
>>> But I seem to have trouble getting them to receive anything at all.
>>
>> That's a little vague. Does "trouble" mean "it sometimes works" or
>> "never works"?
>>
>
> Sorry - yes, it was very vague! Never works. If I run wiresahrk I can
> see udp packets addressed to 224.0.0.4, port 901, flying past, however
> when I run my python script it does not appear to ever receive
> anything.
>
> The scritp I am running is almost identical to an exampel I found here:
>
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-
> server-using-twisted/
>
>>>
>>> I have managed to use tshark to display the packets :
>>>
>>> tshark -i eth0 -x -l -f udp
>>>
>> Can you post a complete example that isn't working for you?
>>
>> When your code is running, have a look "/sbin/ip maddr" to ensure the
>> group has been added to the socket listen filter
> eth1
>    link 01:00:5e:00:00:04
>    link 33:33:ff:7a:7e:4e
>    link 01:00:5e:00:00:fb
>    link 01:00:5e:00:00:01
>    link 33:33:00:00:00:01
>    inet 224.0.0.4
>    inet 224.0.0.251
>    inet 224.0.0.1
>    inet6 ff02::1:ff7a:7e4e
>    inet6 ff02::1
>
> That's interesting.... eth1 is the wrong interface! In fact, it isn't
> connected to anything at all. eth0 is the interface that should be
> being used. I will try to swap them around, but presumably this is
> something I can specify somwhere...
>
>
> As I said, the code I am using is taken from the above link, but the
> exact listing is given below:
>
> from twisted.internet.protocol import DatagramProtocol
> from twisted.internet import reactor
> from twisted.application.internet import MulticastServer
>
> class MulticastServerUDP(DatagramProtocol):
>  def startProtocol(self):
>    print 'Started Listening'
>    # Join a specific multicast group, which is the IP we will respond to
>    self.transport.joinGroup('224.0.0.4')
>
>  def datagramReceived(self, datagram, address):
>      print "Server Received:" + repr(datagram)
>
>
> reactor.listenMulticast(901, MulticastServerUDP())
> reactor.run()
>
>
>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>



From itamar at itamarst.org  Wed Mar 10 06:28:51 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 10 Mar 2010 08:28:51 -0500
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
Message-ID: <1268227731.3486.72.camel@pintsize>

On Wed, 2010-03-10 at 10:35 +0000, Ben Barker wrote:

> I have been looking at the examples here:
> 
> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
> 
> But I seem to have trouble getting them to receive anything at all.

Did you do the joinGroup()? One of the examples omits it, which means it
won't receive multicast.




From p.mayers at imperial.ac.uk  Wed Mar 10 07:00:23 2010
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Wed, 10 Mar 2010 14:00:23 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100518o3f26832cl522ba0ab9eef4cee@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com>
	<4B978A86.7050905@imperial.ac.uk>	<3df02bfc1003100503j3ccebf7ay1c27dbb425a94e64@mail.gmail.com>
	<3df02bfc1003100518o3f26832cl522ba0ab9eef4cee@mail.gmail.com>
Message-ID: <4B97A5F7.2030706@imperial.ac.uk>

On 10/03/10 13:18, Ben Barker wrote:
> Well that's odd...
>
> I changed the interfaces over - used eth1 for the connection to the
> network I need to sniff...
>
> and now /sbin/ip maddr tells me I have joined 224.0.0.4 on eth0 !
>
> Whichever interface is live, the join seems to happen on the other :-p
>
> What could there be about my network config that is making this happen :-p

It depends on your OS & network setup. This isn't something Twisted can 
fix for you.

Can you send/receive multicast using a test tool e.g. "iperf" in UDP mode?

This is probably not the mailing list to continue discussion on.



From ben at bbarker.co.uk  Wed Mar 10 07:43:57 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 14:43:57 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <1268227731.3486.72.camel@pintsize>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<1268227731.3486.72.camel@pintsize>
Message-ID: <3df02bfc1003100643j563171f7nd9256193aebbfad7@mail.gmail.com>

Ah - I have now sorted the interface problem.

I run the code I listed earlier, but it sites at the command line
saying "listening" without every dumping anything to screen.

/sbin/ip maddr now shows:

eth1
	link  01:00:5e:00:00:04
	link  33:33:ff:7a:7e:4e
	link  01:00:5e:00:00:fb
	link  01:00:5e:00:00:01
	link  33:33:00:00:00:01
	inet  224.0.0.4
	inet  224.0.0.251
	inet  224.0.0.1
	inet6 ff02::1:ff7a:7e4e
	inet6 ff02::1


And this is the same intterface on which I would expect to see the
multicast udp packets.




On Wed, Mar 10, 2010 at 1:28 PM, Itamar Turner-Trauring
<itamar at itamarst.org> wrote:
> On Wed, 2010-03-10 at 10:35 +0000, Ben Barker wrote:
>
>> I have been looking at the examples here:
>>
>> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>>
>> But I seem to have trouble getting them to receive anything at all.
>
> Did you do the joinGroup()? One of the examples omits it, which means it
> won't receive multicast.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From ben at bbarker.co.uk  Wed Mar 10 08:07:48 2010
From: ben at bbarker.co.uk (Ben Barker)
Date: Wed, 10 Mar 2010 15:07:48 +0000
Subject: [Twisted-Python] sniffing multicast traffic
In-Reply-To: <3df02bfc1003100643j563171f7nd9256193aebbfad7@mail.gmail.com>
References: <3df02bfc1003100235s13ab188l5554610bcbf411d0@mail.gmail.com> 
	<1268227731.3486.72.camel@pintsize>
	<3df02bfc1003100643j563171f7nd9256193aebbfad7@mail.gmail.com>
Message-ID: <3df02bfc1003100707t7266cb37qe324cda17f2b5c75@mail.gmail.com>

To all those whose email I have (and still am) filling:

Yers - it was a network problem on my part. The two NIC's were causing
the problems. The example code is now working fine. Thanks all:-)

On Wed, Mar 10, 2010 at 2:43 PM, Ben Barker <ben at bbarker.co.uk> wrote:
> Ah - I have now sorted the interface problem.
>
> I run the code I listed earlier, but it sites at the command line
> saying "listening" without every dumping anything to screen.
>
> /sbin/ip maddr now shows:
>
> eth1
>    link 01:00:5e:00:00:04
>    link 33:33:ff:7a:7e:4e
>    link 01:00:5e:00:00:fb
>    link 01:00:5e:00:00:01
>    link 33:33:00:00:00:01
>    inet 224.0.0.4
>    inet 224.0.0.251
>    inet 224.0.0.1
>    inet6 ff02::1:ff7a:7e4e
>    inet6 ff02::1
>
>
> And this is the same intterface on which I would expect to see the
> multicast udp packets.
>
>
>
>
> On Wed, Mar 10, 2010 at 1:28 PM, Itamar Turner-Trauring
> <itamar at itamarst.org> wrote:
>> On Wed, 2010-03-10 at 10:35 +0000, Ben Barker wrote:
>>
>>> I have been looking at the examples here:
>>>
>>> http://code.activestate.com/recipes/425975-simple-udp-multicast-client-server-using-twisted/
>>>
>>> But I seem to have trouble getting them to receive anything at all.
>>
>> Did you do the joinGroup()? One of the examples omits it, which means it
>> won't receive multicast.
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>



From codeprophecy1 at gmail.com  Wed Mar 10 18:23:32 2010
From: codeprophecy1 at gmail.com (code prophecy)
Date: Wed, 10 Mar 2010 19:23:32 -0600
Subject: [Twisted-Python] how to send message in msn bot
Message-ID: <3700bbff1003101723v295a588cod9a297f807f2e1ab@mail.gmail.com>

Hi,

I've been playing with twisted msn implementation but failed to figure out
how to send/recv message to another msn user ? I understand that i need to
use msn.SwitchboardClient but am confused as to how and where to connect it
? what factory to use etc.

any hint/example shall be appreciated.

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100310/87182a92/attachment.html>

From chris at simplistix.co.uk  Thu Mar 11 03:08:40 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 11 Mar 2010 10:08:40 +0000
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>	<4B8F715D.6020107@simplistix.co.uk>
	<20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>
Message-ID: <4B98C128.7030402@simplistix.co.uk>

exarkun at twistedmatrix.com wrote:
> Also, I'm pretty sure that the 9.0 Windows installer _also_ didn't 
> include zope.interface.  So this isn't a new situation with 10.0.
>> Is zope.interface not used/required anymore?
>> If so, why is it shipping in the non-windows version?
> 
> It doesn't ship in any of the packages for other platforms, either (nor 
> do any of our other external dependencies).

Ah, okay, I guess my question becomes: why was it ever bundles in the 
windows distribution then?

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk




From therve at free.fr  Thu Mar 11 04:21:41 2010
From: therve at free.fr (Thomas =?ISO-8859-1?Q?Herv=E9?=)
Date: Thu, 11 Mar 2010 12:21:41 +0100
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <4B98C128.7030402@simplistix.co.uk>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>
	<4B8F715D.6020107@simplistix.co.uk>
	<20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>
	<4B98C128.7030402@simplistix.co.uk>
Message-ID: <1268306501.3069.0.camel@brainwave>

Le jeudi 11 mars 2010  10:08 +0000, Chris Withers a crit :
> exarkun at twistedmatrix.com wrote:
> > Also, I'm pretty sure that the 9.0 Windows installer _also_ didn't 
> > include zope.interface.  So this isn't a new situation with 10.0.
> >> Is zope.interface not used/required anymore?
> >> If so, why is it shipping in the non-windows version?
> > 
> > It doesn't ship in any of the packages for other platforms, either (nor 
> > do any of our other external dependencies).
> 
> Ah, okay, I guess my question becomes: why was it ever bundles in the 
> windows distribution then?

Because Zope didn't provide a binary version of zope.interface for
Windows at that time, and zope.interface has a C extension.

-- 
Thomas




From chris at simplistix.co.uk  Thu Mar 11 06:54:07 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Thu, 11 Mar 2010 13:54:07 +0000
Subject: [Twisted-Python] Twisted 10.0.0 released
In-Reply-To: <1268306501.3069.0.camel@brainwave>
References: <d06a5cd31003031525h33ea08b4k4c4a2aff0e7c7fe8@mail.gmail.com>	<4B8F715D.6020107@simplistix.co.uk>	<20100304140537.2792.505730555.divmod.xquotient.509@localhost.localdomain>	<4B98C128.7030402@simplistix.co.uk>
	<1268306501.3069.0.camel@brainwave>
Message-ID: <4B98F5FF.5090004@simplistix.co.uk>

Thomas Herv wrote:
> Le jeudi 11 mars 2010  10:08 +0000, Chris Withers a crit :
>> exarkun at twistedmatrix.com wrote:
>>> Also, I'm pretty sure that the 9.0 Windows installer _also_ didn't 
>>> include zope.interface.  So this isn't a new situation with 10.0.
>>>> Is zope.interface not used/required anymore?
>>>> If so, why is it shipping in the non-windows version?
>>> It doesn't ship in any of the packages for other platforms, either (nor 
>>> do any of our other external dependencies).
>> Ah, okay, I guess my question becomes: why was it ever bundles in the 
>> windows distribution then?
> 
> Because Zope didn't provide a binary version of zope.interface for
> Windows at that time,

Really? To my knowledge, Zope has provided windows binaries for 
zope.interface prettymuch since it came into existence...

(I know, I'm sure I used to compile them for a time ;-) )

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From exarkun at twistedmatrix.com  Thu Mar 11 13:05:09 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 11 Mar 2010 20:05:09 -0000
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation updated
Message-ID: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>

Hi all,

Thomas and I have finished upgrading the trac installation on 
http://twistedmatrix.com/ to 0.11.6.  We expect that this will resolve a 
number of the issues the site has had.

If you notice anything broken about the website now, please point it 
out.

Jean-Paul



From jml at mumak.net  Thu Mar 11 13:14:48 2010
From: jml at mumak.net (Jonathan Lange)
Date: Thu, 11 Mar 2010 20:14:48 +0000
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
Message-ID: <d06a5cd31003111214u6541859ek55cb2753d567c8d6@mail.gmail.com>

On Thu, Mar 11, 2010 at 8:05 PM,  <exarkun at twistedmatrix.com> wrote:
> Hi all,
>
> Thomas and I have finished upgrading the trac installation on
> http://twistedmatrix.com/ to 0.11.6. We expect that this will resolve a
> number of the issues the site has had.
>
> If you notice anything broken about the website now, please point it
> out.
>

Thank you very much Jean-Paul & Thomas!

jml



From kevin.horn at gmail.com  Thu Mar 11 13:47:00 2010
From: kevin.horn at gmail.com (Kevin Horn)
Date: Thu, 11 Mar 2010 14:47:00 -0600
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
Message-ID: <562bcc11003111247r1213a7dby175d1d649ece44e5@mail.gmail.com>

On Thu, Mar 11, 2010 at 2:05 PM, <exarkun at twistedmatrix.com> wrote:

> Hi all,
>
> Thomas and I have finished upgrading the trac installation on
> http://twistedmatrix.com/ to 0.11.6.  We expect that this will resolve a
> number of the issues the site has had.
>
> If you notice anything broken about the website now, please point it
> out.
>
> Jean-Paul
>
>
Here's a minor thing...

When viewing a diff, the legend is incomplete.  I just see text
("Unmodified", "Added", etc.) without any images/colors.

It's a tiny thing, but you did ask... :)

browser: Firefox 3.5 on Win32

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100311/480939fe/attachment-0001.html>

From twisted at asheesh.org  Thu Mar 11 16:02:25 2010
From: twisted at asheesh.org (Asheesh Laroia)
Date: Thu, 11 Mar 2010 18:02:25 -0500 (EST)
Subject: [Twisted-Python] Twisted easy bugs,
 and other thoughts about getting people involved in Twisted
Message-ID: <alpine.DEB.2.00.1003101739050.2352@localhost>

I ran into David Reid at PyCon a few weeks ago, and I showed him an index 
of "easy" and "bitesize" bugs I'm putting on the web at 
https://openhatch.org/search/. He told me that the Twisted team tags bugs 
as "easy" in Trac.

So all you might like to see 
https://openhatch.org/search/?q=Twisted&toughness=bitesize -- it's the 
result of search for bugs whose full text or project matches "Twisted", 
constrained to only include the bugs that are "easy". This is the same 
query as 
http://twistedmatrix.com/trac/query?status=new&status=assigned&status=reopened&keywords=~easy&order=priority 
-- the same 18 tickets -- but cached in our index.

The OpenHatch website aims to show helpful, friendly things to potential 
new contributors. A list of bugs isn't always adequate, so I'm really 
happy jesstess wrote some tips on the OpenHatch project page regarding 
getting involved in Twisted: https://openhatch.org/+projects/Twisted

The "Relatedly" sidebox on that project page has other helpful links: 
potential mentors, namely people who have signed into OpenHatch and said 
they can mentor in Python or Twisted.

So that's a quick tour of some of relevant things to you guys. I have a 
few questions for you guys, if you're game:

* Of these things, what are the most interesting or useful? the least?

* Are there other tickets from the Twisted Trac that would be good to pull 
in?

* Would you like me to ping the list if we come up with anything else I 
think you might find interesting?

* Do any of you want to re-use some of this data -- can we make that 
easier?

We're pretty interested in helping projects convert users to contributors 
(in code, testing, documentation, whatever!) across free software. I 
wonder if there is a website widget that we could make for you to put on 
twistedmatrix.com -- a big box talking about how "You TOO can contribute 
to Twisted -- there are mentors, easy bugs, and everything!"

This email has gotten fairly long, so I'll stop here for now.

I don't mean to barge in; let me know if I'm unwelcome, and I'll wander 
off. I find myself in a maze of Twisted developers, none of whom are 
alike. Thanks! I'll be hanging out on #twisted as myself, paulproteus.

-- Asheesh.

P.S. If you think this is interesting, stay in touch with us:

IRC (freenode): #openhatch
Twitter/Identi.ca: @openhatchery
blog: https://openhatch.org/blog/
email and more: https://openhatch.org/contact/

P.S. The OpenHatch website has its source in git and shared under a free 
license -- https://openhatch.org/source-code-etc/

-- 
"World conquerors sometimes become fools, but fools never become world
conquerors."
 		-- "The Outer Limits: The Invisibles"





From glyph at twistedmatrix.com  Thu Mar 11 16:45:11 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 11 Mar 2010 18:45:11 -0500
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <d06a5cd31003111214u6541859ek55cb2753d567c8d6@mail.gmail.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<d06a5cd31003111214u6541859ek55cb2753d567c8d6@mail.gmail.com>
Message-ID: <32C317AD-3DAE-4A1F-8134-526049C7B285@twistedmatrix.com>


On Mar 11, 2010, at 3:14 PM, Jonathan Lange wrote:

> Thank you very much Jean-Paul & Thomas!

I second this sentiment!  I am *thrilled* that we're now on a released version of trac, and I applaud the hard work that it took to get us there.

Hopefully now it will be easier for other people to help pitch in with administrative tasks :).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100311/3ae0fa23/attachment.html>

From glyph at twistedmatrix.com  Sat Mar 13 15:07:22 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 13 Mar 2010 17:07:22 -0500
Subject: [Twisted-Python] Twisted easy bugs,
	and other thoughts about 	getting people involved in Twisted
In-Reply-To: <alpine.DEB.2.00.1003101739050.2352@localhost>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
Message-ID: <d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>

On Thu, Mar 11, 2010 at 6:02 PM, Asheesh Laroia <twisted at asheesh.org> wrote:


> So that's a quick tour of some of relevant things to you guys. I have a
> few questions for you guys, if you're game:
>
> * Of these things, what are the most interesting or useful? the least?


If OpenHatch has users, the most interesting thing is simply that they will
be looking at these lists :).


>  * Are there other tickets from the Twisted Trac that would be good to pull

in?
>

For new contributors?  Not that I can think of.


> * Would you like me to ping the list if we come up with anything else I
> think you might find interesting?
>

Sure.


> * Do any of you want to re-use some of this data -- can we make that
> easier?
>

Isn't this all data that we're providing to *you*?  I don't understand why
we'd want to be pulling things back out of OpenHatch.  Perhaps I've
misunderstood.


> We're pretty interested in helping projects convert users to contributors
> (in code, testing, documentation, whatever!) across free software. I
> wonder if there is a website widget that we could make for you to put on
> twistedmatrix.com -- a big box talking about how "You TOO can contribute
> to Twisted -- there are mentors, easy bugs, and everything!"
>

Anything that would help us organize that information to appeal to potential
contributors would be helpful.


> I don't mean to barge in; let me know if I'm unwelcome, and I'll wander
> off. I find myself in a maze of Twisted developers, none of whom are
> alike. Thanks! I'll be hanging out on #twisted as myself, paulproteus.
>

Please feel free to stay in touch.  Getting more people involved in Twisted
development is always of interest.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100313/a040452f/attachment.html>

From jon at gina.alaska.edu  Sat Mar 13 23:24:35 2010
From: jon at gina.alaska.edu (Jonathan Sawyer)
Date: Sat, 13 Mar 2010 21:24:35 -0900
Subject: [Twisted-Python] Application mode: Killing a peer connection from
	the server in a thread. Is this correct?
Message-ID: <5cab99fd1003132224k65f66ce9o1a0663e4b6bea9a2@mail.gmail.com>

Hi everyone,

I am running a server in application context via:

# code: server.tac
factory = Factory()
factory.protocol = MyProtocol
application = service.Application("MyServer")
service = internet.TCPServer(5555, factory)
service.setServiceParent(application)
# end code

ran with

$ twistd -ny server.tac

Here is some of my Protocol code:

# code: myprotocol.py
def checkIdle(transport):
    while 1:
        now = time.time()
        if now - transport.activityFlag > 30.0:
            transport.loseConnection()
            time.sleep(1)
            break
            return
        time.sleep(8)
    return

class MyProtocol(Protocol):
    def connectionMade(self):
        self.transport.activityFlag = time.time()
        thread.start_new_thread(checkIdle, (self.transport,))

    # ... the rest of the methods... not important for this question
# end code

Now here's my problem: I want to kill connections from the server that have
been idle for, say, 30 seconds. An idle connection is one in which is a
_valid_ connection (i.e., it hasn't disconnected from the server) but hasn't
sent any data for 30 seconds. The way I have initially set it up was in a
thread. I simply check the last time it had activity from that particular
transport. The really real problem I am having is when the connection is
closed, the client doesn't know about it. It is simply closed on the server
and the client is left hanging. If I test this in telnet with:

$ telnet localhost 5555

telnet never quits with a message: Connection closed by foreign host. (which
is indeed exactly what I want)
The only way I get this response is if I try to send data to the server
while the connection has been "lost".

Can anyone direct me on the proper way to kill a connection from the server
end in a clean manner?

(By the way, I'm very new to twisted, not so new to Python).

Thanks for any help!

-- 
Jonathan Sawyer
Geographic Information Network of Alaska (GINA)
University of Alaska Fairbanks
(907) 474-5689
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100313/a9250efd/attachment.html>

From glyph at twistedmatrix.com  Sat Mar 13 23:44:19 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 14 Mar 2010 01:44:19 -0500
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
Message-ID: <9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>


On Mar 11, 2010, at 3:05 PM, exarkun at twistedmatrix.com wrote:

> If you notice anything broken about the website now, please point it 
> out.

I'm somewhat regularly (although I'm not sure exactly how often) getting this:

Error 503 Service Unavailable
Service Unavailable
Guru Meditation:
XID: 1905866058
Varnish

It appears to be an artifact of the upgrade.

Also, the spacing on the revision log and repository browser seems wrong; many table rows are double height for some reason.

Still, I'm not complaining - just the fact that things paginate now has made the experience of doing triage much more pleasant!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100314/4c009a50/attachment.html>

From exarkun at twistedmatrix.com  Sun Mar 14 09:04:09 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 14 Mar 2010 15:04:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1268579049.11.1235783148@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100314/ee798ea3/attachment.html>

From glyph at twistedmatrix.com  Sun Mar 14 14:15:13 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 14 Mar 2010 16:15:13 -0400
Subject: [Twisted-Python] [Twisted] #4331: SIGCHLD causes "Interrupted
	system call" errors on Python 2.4,
	in a fresh SVN checkout (was: SIGCHILD causes "Interrupted system
	call" errors on Python 2.4, in a fresh SVN checkout)
In-Reply-To: <059.e68ebd56ab98e4b57075b68d793804ea@twistedmatrix.com>
References: <050.e9fa395bf2a0b610b1572e0106bc4c9d@twistedmatrix.com>
	<059.e68ebd56ab98e4b57075b68d793804ea@twistedmatrix.com>
Message-ID: <2B6E2D17-B2C6-4F58-BFE6-9799B981B024@twistedmatrix.com>

Also regarding Trac issues; I'm not sure if this one is new, but I received this message from the ticket notifier and I noticed that since the only thing that changed is the ticket subject, there appears to be no indication of who changed it or what changed, unless you look at the 'subject' line of the email.

On Mar 14, 2010, at 3:29 AM, Twisted wrote:

> #4331: SIGCHLD causes "Interrupted system call" errors on Python 2.4, in a fresh
> SVN checkout
> --------------------------+-------------------------------------------------
>     Reporter:  TimAllen  |           Owner:  glyph
>         Type:  defect    |          Status:  new  
>     Priority:  normal    |       Milestone:       
>    Component:  core      |        Keywords:       
>       Branch:            |   Branch_author:       
> Launchpad_bug:            |  
> --------------------------+-------------------------------------------------
> 
> -- 
> Ticket URL: <http://twistedmatrix.com/trac/ticket/4331#comment:4>
> Twisted <http://twistedmatrix.com/trac/>
> Engine of your Internet




From glyph at twistedmatrix.com  Sun Mar 14 14:27:39 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 14 Mar 2010 16:27:39 -0400
Subject: [Twisted-Python] Application mode: Killing a peer connection
	from the server in a thread. Is this correct?
In-Reply-To: <5cab99fd1003132224k65f66ce9o1a0663e4b6bea9a2@mail.gmail.com>
References: <5cab99fd1003132224k65f66ce9o1a0663e4b6bea9a2@mail.gmail.com>
Message-ID: <A121BF7F-57C8-4C2F-8152-9E7EAF2FC563@twistedmatrix.com>

No. (In answer to the subject.)

On Mar 14, 2010, at 1:24 AM, Jonathan Sawyer wrote:

> Now here's my problem: I want to kill connections from the server that have been idle for, say, 30 seconds. An idle connection is one in which is a _valid_ connection (i.e., it hasn't disconnected from the server) but hasn't sent any data for 30 seconds. The way I have initially set it up was in a thread.

That's your problem.  You may not call Twisted APIs of any kind from a thread.  That goes *double* for threads started with start_new_thread; if you start threads that way you will have problems with clean shutdown as well.  If you have work you want to do in a thread in Twisted, use reactor.callInThread.

http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.interfaces.IReactorThreads.html#callInThread

If, for some reason, you needed to tell a transport to disconnect from a thread, the right way to do it would be to call reactor.callFromThread(transport.loseConnection).

http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.interfaces.IReactorThreads.html#callFromThread

However, this is still wrong, as there's no need to spin up or manage threads in order to run timed events in Twisted.

Bottom line: don't use threads.  If you think you need to in order to perform some basic task, there is probably a Twisted API you haven't learned about yet.

> Can anyone direct me on the proper way to kill a connection from the server end in a clean manner?

If you want to check the connection every 30 seconds, use a LoopingCall that calls your 'check' function every 30 seconds, to check the activity flag and call loseConnection if necessary.

http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.task.LoopingCall.html

You should also know that until <http://twistedmatrix.com/trac/ticket/78> is closed, your connection won't be "killed" so much as it is "shut down"; the socket will wait until all of its remaining data has been sent (or the TCP-level timeout has passed) before closing.




From twisted at asheesh.org  Sun Mar 14 10:53:59 2010
From: twisted at asheesh.org (Asheesh Laroia)
Date: Sun, 14 Mar 2010 12:53:59 -0400 (EDT)
Subject: [Twisted-Python] Twisted easy bugs,
 and other thoughts about getting people involved in Twisted
In-Reply-To: <d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
	<d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1003141221001.18193@vellum>

On Sat, 13 Mar 2010, Glyph Lefkowitz wrote:

> On Thu, Mar 11, 2010 at 6:02 PM, Asheesh Laroia <twisted at asheesh.org> wrote:
> 
>       So that's a quick tour of some of relevant things to you guys. I have a
>       few questions for you guys, if you're game:
>
>       * Of these things, what are the most interesting or useful? the least?
> 
> 
> If OpenHatch has users, the most interesting thing is simply that they 
> will be looking at these lists :). 

All right! (-:

>       * Are there other tickets from the Twisted Trac that would be good to pull
>       in?
> 
> 
> For new contributors? Not that I can think of.

I did just notice there's a documentation tag. Is that something that 
you'd want us to pull in, too?

I imagine you'll say yes -- I'm mostly asking to get your creative juices 
flowing and see if there's anything else....

>       * Would you like me to ping the list if we come up with anything else I
>       think you might find interesting?
> 
> Sure. 

Yay.

>       * Do any of you want to re-use some of this data -- can we make that
>       easier?
> 
> Isn't this all data that we're providing to you? I don't understand why 
> we'd want to be pulling things back out of OpenHatch. Perhaps I've 
> misunderstood.

I'm mostly referring to things like jesstess's "How to get involved" 
answers.

One more thing -- pulling data out of Trac isn't actually super easy (-:. 
So if you want us to re-export that in some really simple format like a 
big JSON list, that's something else we can do.

>       We're pretty interested in helping projects convert users to contributors
>       (in code, testing, documentation, whatever!) across free software. I
>       wonder if there is a website widget that we could make for you to put on
>       twistedmatrix.com -- a big box talking about how "You TOO can contribute
>       to Twisted -- there are mentors, easy bugs, and everything!"
> 
> Anything that would help us organize that information to appeal to 
> potential contributors would be helpful. 

Here's a dream:

A big and colorful box sits on the Twisted homepage. It says "Want to help 
Twisted out, but feel shy about getting your feet wet? There are five 
mentors standing by to help you dive in, 18 easy bugs, and 25 requests for 
documentation." (Only maybe somehow it could use less words?)

That might take the person to the OpenHatch project page for Twisted, 
where all that information is listed or available a click away. The widget 
on the Twisted home page could pull data from OpenHatch's project page.

I don't know that *we* would get around to it soon, but certainly we can 
provide the data pretty quickly. We might also get around to it sometime.

In fact, I just filed a bug with the above text -- 
https://openhatch.org/bugs/issue35

>       I don't mean to barge in; let me know if I'm unwelcome, and I'll wander
>       off. I find myself in a maze of Twisted developers, none of whom are
>       alike. Thanks! I'll be hanging out on #twisted as myself, paulproteus.
> 
> 
> Please feel free to stay in touch. Getting more people involved in 
> Twisted development is always of interest.

Great! (-:

-- Asheesh.

-- 
Ours is a world of nuclear giants and ethical infants.
 		-- General Omar N. Bradley

From exarkun at twistedmatrix.com  Sun Mar 14 18:16:37 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Mon, 15 Mar 2010 00:16:37 -0000
Subject: [Twisted-Python] Twisted easy bugs,
	and other thoughts about getting people involved in Twisted
In-Reply-To: <alpine.DEB.2.00.1003141221001.18193@vellum>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
	<d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>
	<alpine.DEB.2.00.1003141221001.18193@vellum>
Message-ID: <20100315001637.2792.1150179124.divmod.xquotient.1609@localhost.localdomain>

On 14 Mar, 04:53 pm, twisted at asheesh.org wrote:
>
>One more thing -- pulling data out of Trac isn't actually super easy 
>(-:. So if you want us to re-export that in some really simple format 
>like a big JSON list, that's something else we can do.

How do you mean?  It's actually pretty straightforward to get data out; 
you can have it as rss, csv, or tsv in most cases.

This leads me to wonder how you grabbed the "easy" tickets from the 
tracker.  Surely this is an automated process which is reading the csv 
format of a trac "tickets with `easy` keyword" query page?  If not, how 
does the OpenHatch listing stay up to date?

Jean-Paul



From newptcai at gmail.com  Mon Mar 15 04:32:23 2010
From: newptcai at gmail.com (Peter Cai)
Date: Mon, 15 Mar 2010 18:32:23 +0800
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
Message-ID: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>

Someone turn off the server by cutting power of the server.
When the machine is power on, I found my twisted application could not start
and emit the following error.

Another twistd server is running, PID 3398

This could either be a previously started instance of your application or a
different application entirely. To start a new one, either run it in some
other
directory, or use the --pidfile and --logfile parameters to avoid clashes.

After I deleted twistd.pid, it could start normally.

I checked if there is process with PID 3398, but there wasn't.

What might cause this problem?  How to avoid it?

--
look to the things around you,the immediate world around you, if you are
alive,it will mean something to you Paul Strand
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100315/64b14de9/attachment.html>

From marco.giusti at gmail.com  Mon Mar 15 05:07:19 2010
From: marco.giusti at gmail.com (Marco Giusti)
Date: Mon, 15 Mar 2010 12:07:19 +0100
Subject: [Twisted-Python] My twisted application could not start after
 reboot be cause of "twistd.pid"
In-Reply-To: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
Message-ID: <20100315110719.GA22570@murdoc>

On Mon, Mar 15, 2010 at 06:32:23PM +0800, Peter Cai wrote:
> Someone turn off the server by cutting power of the server.
> When the machine is power on, I found my twisted application could not start
> and emit the following error.
> 
> Another twistd server is running, PID 3398
> 
> This could either be a previously started instance of your application or a
> different application entirely. To start a new one, either run it in some
> other
> directory, or use the --pidfile and --logfile parameters to avoid clashes.
> 
> After I deleted twistd.pid, it could start normally.
> 
> I checked if there is process with PID 3398, but there wasn't.
> 
> What might cause this problem?  How to avoid it?

the problem is caused by turning off power without shutdown twisted
server before. One solution could be create an init.d script that checks
for the existence of a pid file and delete it.


ciao
m.


-- 
Hofstadter's Law:
It always takes longer than you expect, even when you take into account
Hofstadter's Law.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20100315/fa3500d3/attachment.sig>

From termim at gmail.com  Mon Mar 15 08:30:05 2010
From: termim at gmail.com (Mikhail Terekhov)
Date: Mon, 15 Mar 2010 09:30:05 -0500
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
Message-ID: <12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>

On Sun, Mar 14, 2010 at 1:44 AM, Glyph Lefkowitz
<glyph at twistedmatrix.com> wrote:
>
> On Mar 11, 2010, at 3:05 PM, exarkun at twistedmatrix.com wrote:
>
> If you notice anything broken about the website now, please point it
> out.
>
> Also, the spacing on the revision log and repository browser seems wrong;
> many table rows are double height for some reason.
> Still, I'm not complaining - just the fact that things paginate now has made
> the experience of doing triage much more pleasant!

In case of FF-3.6 the rows are triple height and filled in a funny ragged way.
In addition to that the menu is overlapped in FF but this was the same
way before
update. BTW in IE6 menu is OK.

-- 
Mikhail Terekhov
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cnnect1.png
Type: image/png
Size: 216058 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20100315/8e493825/attachment-0002.png>

From burslem2001 at yahoo.com  Mon Mar 15 09:16:08 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 08:16:08 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
Message-ID: <830754.2596.qm@web112514.mail.gq1.yahoo.com>

Hello,

I want to create a twisted daemon from my application:

if __name__ == '__main__':
    import nfdprocess, sys
    log.startLogging(sys.stdout)
    serverContext = ServerContextFactory()
    serverContext.protocol = nfdprocess.HandlePacket
    port =int(sys.argv[1])
    checkT = checkTables()
    checkT.resetTablesToOffline()
    outgoingTable = LoopingCall(checkT.checkOutgoingMessageQueue,serverContext)
    incomingTable = LoopingCall(checkT.checkIncomingMessageQueue,serverContext)
    checkStates=  LoopingCall(checkT.checkConnectionStates,serverContext)
    outgoingTable.start(0.5)
    incomingTable.start(1)
    checkStates.start(1)
    reactor.listenSSL(port, serverContext, serverContext)
    reactor.run()

Currently I have a class called nfdmessenger.

I am running the object.

> python nfdmessenger.py 2000

However I would run it as a deamon. Not sure how to do this? Can somebody be so kind and offer some pointers on this?

Much appreciated,
Garyc






From rlotun at gmail.com  Mon Mar 15 09:35:15 2010
From: rlotun at gmail.com (Reza Lotun)
Date: Mon, 15 Mar 2010 15:35:15 +0000
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <830754.2596.qm@web112514.mail.gq1.yahoo.com>
References: <12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
	<830754.2596.qm@web112514.mail.gq1.yahoo.com>
Message-ID: <95bb10691003150835h1e0e0c0by2922d9e977fc666c@mail.gmail.com>

Hi,

> I want to create a twisted daemon from my application: ...

You want to use twistd. See
http://twistedmatrix.com/documents/current/core/howto/basics.html#auto1

The process is roughly:

1) create a myapp.tac file which essentially loads in your server and
wraps it in an application
2) run something like:
       $ twistd -r epoll -y myapp.tac
which will daemonize your server (using the epoll reactor) and write
its pid to twistd.pid

A .tac file could look something like:

from twisted.application import service, internet
from myapp import MyAppServer

def get_service():
    """ Return a service suitable for creating an application object. """
    site = MyAppServer()
    port = 2000
    return internet.TCPServer(2000, site)

application = service.Application('MyApplicationName')
# attach the service to its parent application
service = get_service()
service.setServiceParent(application)

Also, keep in mind you might want to use twistd in conjunction with a
process runner (http://dustin.github.com/2010/02/28/running-processes.html).
That is, if you're using something like Ubuntu, you probably want to
run twistd using upstart.

Hope this helps.

Reza

-- 
Reza Lotun
mobile: +44 (0)7521 310 763
email:  rlotun at gmail.com
work:   reza at tweetdeck.com
twitter: @rlotun



From burslem2001 at yahoo.com  Mon Mar 15 10:14:21 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 09:14:21 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <95bb10691003150835h1e0e0c0by2922d9e977fc666c@mail.gmail.com>
Message-ID: <762434.85498.qm@web112507.mail.gq1.yahoo.com>

Thanks Reza I wil give it a crack.

Much appreciated,
Garyc


--- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com> wrote:

> From: Reza Lotun <rlotun at gmail.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 10:35 AM
> Hi,
> 
> > I want to create a twisted daemon from my application:
> ...
> 
> You want to use twistd. See
> http://twistedmatrix.com/documents/current/core/howto/basics.html#auto1
> 
> The process is roughly:
> 
> 1) create a myapp.tac file which essentially loads in your
> server and
> wraps it in an application
> 2) run something like:
>   $ twistd -r epoll -y
> myapp.tac
> which will daemonize your server (using the epoll reactor)
> and write
> its pid to twistd.pid
> 
> A .tac file could look something like:
> 
> from twisted.application import service, internet
> from myapp import MyAppServer
> 
> def get_service():
>   """ Return a service suitable for creating an
> application object. """
>   site = MyAppServer()
>   port = 2000
>   return internet.TCPServer(2000, site)
> 
> application = service.Application('MyApplicationName')
> # attach the service to its parent application
> service = get_service()
> service.setServiceParent(application)
> 
> Also, keep in mind you might want to use twistd in
> conjunction with a
> process runner (http://dustin.github.com/2010/02/28/running-processes.html).
> That is, if you're using something like Ubuntu, you
> probably want to
> run twistd using upstart.
> 
> Hope this helps.
> 
> Reza
> 
> -- 
> Reza Lotun
> mobile: +44 (0)7521 310 763
> email: rlotun at gmail.com
> work:reza at tweetdeck.com
> twitter: @rlotun
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From burslem2001 at yahoo.com  Mon Mar 15 11:19:16 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 10:19:16 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <762434.85498.qm@web112507.mail.gq1.yahoo.com>
Message-ID: <137455.19004.qm@web112513.mail.gq1.yahoo.com>

Hello,

I compacted the server code initialization into the ServerContextFactory:


from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


if __name__ == '__main__':
    serverContext =  ServerContextFactory()
    reactor.listenSSL(2000, serverContext, serverContext)
    reactor.run()


Running the below:

python nfddaemon.py

Looks goods and runs as expected:


I then moved the code into a tac file:

from twisted.application import service,internet
from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


def get_service():
    serverContext =  ServerContextFactory()
    return reactor.listenSSL(2000, serverContext, serverContext)

application=service.Application('nfdm')
service=get_service()
service.setServiceParent(application)


When I attempt to run:

>twistd -r epoll -y nfddaemon.tac

File "nfddaemon.tac", line 2, in <module>
    from nfdmessenger import ServerContextFactory
exceptions.ImportError: No module named nfdmessenger

It looks like it cannot find the module? Do I have to set the path?
Also not too sure about my getService routine...well suspect.

Thanks,
Garyc

--- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com> wrote:

> From: gary clark <burslem2001 at yahoo.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 11:14 AM
> Thanks Reza I wil give it a crack.
> 
> Much appreciated,
> Garyc
> 
> 
> --- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com>
> wrote:
> 
> > From: Reza Lotun <rlotun at gmail.com>
> > Subject: Re: [Twisted-Python] Creating a daemon from
> my application
> > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > Date: Monday, March 15, 2010, 10:35 AM
> > Hi,
> > 
> > > I want to create a twisted daemon from my
> application:
> > ...
> > 
> > You want to use twistd. See
> > http://twistedmatrix.com/documents/current/core/howto/basics.html#auto1
> > 
> > The process is roughly:
> > 
> > 1) create a myapp.tac file which essentially loads in
> your
> > server and
> > wraps it in an application
> > 2) run something like:
> >   $ twistd -r epoll -y
> > myapp.tac
> > which will daemonize your server (using the epoll
> reactor)
> > and write
> > its pid to twistd.pid
> > 
> > A .tac file could look something like:
> > 
> > from twisted.application import service, internet
> > from myapp import MyAppServer
> > 
> > def get_service():
> >   """ Return a service suitable for creating an
> > application object. """
> >   site = MyAppServer()
> >   port = 2000
> >   return internet.TCPServer(2000, site)
> > 
> > application =
> service.Application('MyApplicationName')
> > # attach the service to its parent application
> > service = get_service()
> > service.setServiceParent(application)
> > 
> > Also, keep in mind you might want to use twistd in
> > conjunction with a
> > process runner (http://dustin.github.com/2010/02/28/running-processes.html).
> > That is, if you're using something like Ubuntu, you
> > probably want to
> > run twistd using upstart.
> > 
> > Hope this helps.
> > 
> > Reza
> > 
> > -- 
> > Reza Lotun
> > mobile: +44 (0)7521 310 763
> > email: rlotun at gmail.com
> > work:reza at tweetdeck.com
> > twitter: @rlotun
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From burslem2001 at yahoo.com  Mon Mar 15 12:03:09 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 11:03:09 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <137455.19004.qm@web112513.mail.gq1.yahoo.com>
Message-ID: <469864.43610.qm@web112513.mail.gq1.yahoo.com>

Yeh I have to install them and create a setup.py to find the path.

--- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com> wrote:

> From: gary clark <burslem2001 at yahoo.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 12:19 PM
> Hello,
> 
> I compacted the server code initialization into the
> ServerContextFactory:
> 
> 
> from nfdmessenger import ServerContextFactory
> from twisted.internet import ssl, reactor
> 
> 
> if __name__ == '__main__':
>   serverContext = ServerContextFactory()
>   reactor.listenSSL(2000, serverContext,
> serverContext)
>   reactor.run()
> 
> 
> Running the below:
> 
> python nfddaemon.py
> 
> Looks goods and runs as expected:
> 
> 
> I then moved the code into a tac file:
> 
> from twisted.application import service,internet
> from nfdmessenger import ServerContextFactory
> from twisted.internet import ssl, reactor
> 
> 
> def get_service():
>   serverContext = ServerContextFactory()
>   return reactor.listenSSL(2000, serverContext,
> serverContext)
> 
> application=service.Application('nfdm')
> service=get_service()
> service.setServiceParent(application)
> 
> 
> When I attempt to run:
> 
> >twistd -r epoll -y nfddaemon.tac
> 
> File "nfddaemon.tac", line 2, in <module>
>   from nfdmessenger import
> ServerContextFactory
> exceptions.ImportError: No module named nfdmessenger
> 
> It looks like it cannot find the module? Do I have to set
> the path?
> Also not too sure about my getService routine...well
> suspect.
> 
> Thanks,
> Garyc
> 
> --- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com>
> wrote:
> 
> > From: gary clark <burslem2001 at yahoo.com>
> > Subject: Re: [Twisted-Python] Creating a daemon from
> my application
> > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > Date: Monday, March 15, 2010, 11:14 AM
> > Thanks Reza I wil give it a crack.
> > 
> > Much appreciated,
> > Garyc
> > 
> > 
> > --- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com>
> > wrote:
> > 
> > > From: Reza Lotun <rlotun at gmail.com>
> > > Subject: Re: [Twisted-Python] Creating a daemon
> from
> > my application
> > > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > > Date: Monday, March 15, 2010, 10:35 AM
> > > Hi,
> > > 
> > > > I want to create a twisted daemon from my
> > application:
> > > ...
> > > 
> > > You want to use twistd. See
> > > http://twistedmatrix.com/documents/current/core/howto/basics.html#auto1
> > > 
> > > The process is roughly:
> > > 
> > > 1) create a myapp.tac file which essentially
> loads in
> > your
> > > server and
> > > wraps it in an application
> > > 2) run something like:
> > >   $ twistd -r epoll -y
> > > myapp.tac
> > > which will daemonize your server (using the
> epoll
> > reactor)
> > > and write
> > > its pid to twistd.pid
> > > 
> > > A .tac file could look something like:
> > > 
> > > from twisted.application import service,
> internet
> > > from myapp import MyAppServer
> > > 
> > > def get_service():
> > >   """ Return a service suitable for creating
> an
> > > application object. """
> > >   site = MyAppServer()
> > >   port = 2000
> > >   return internet.TCPServer(2000, site)
> > > 
> > > application =
> > service.Application('MyApplicationName')
> > > # attach the service to its parent application
> > > service = get_service()
> > > service.setServiceParent(application)
> > > 
> > > Also, keep in mind you might want to use twistd
> in
> > > conjunction with a
> > > process runner (http://dustin.github.com/2010/02/28/running-processes.html).
> > > That is, if you're using something like Ubuntu,
> you
> > > probably want to
> > > run twistd using upstart.
> > > 
> > > Hope this helps.
> > > 
> > > Reza
> > > 
> > > -- 
> > > Reza Lotun
> > > mobile: +44 (0)7521 310 763
> > > email: rlotun at gmail.com
> > > work:reza at tweetdeck.com
> > > twitter: @rlotun
> > > 
> > > _______________________________________________
> > > Twisted-Python mailing list
> > > Twisted-Python at twistedmatrix.com
> > > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > > 
> > 
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From rlotun at gmail.com  Mon Mar 15 12:15:23 2010
From: rlotun at gmail.com (Reza Lotun)
Date: Mon, 15 Mar 2010 18:15:23 +0000
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <469864.43610.qm@web112513.mail.gq1.yahoo.com>
References: <137455.19004.qm@web112513.mail.gq1.yahoo.com>
	<469864.43610.qm@web112513.mail.gq1.yahoo.com>
Message-ID: <95bb10691003151115we64158aj876196d27598829d@mail.gmail.com>

On Mon, Mar 15, 2010 at 6:03 PM, gary clark <burslem2001 at yahoo.com> wrote:
> Yeh I have to install them and create a setup.py to find the path.

You only need to set your PYTHONPATH environment variable.

e.g.

$ export PYTHONPATH=/path/to/dir/containing/code

-- 
Reza Lotun
mobile: +44 (0)7521 310 763
email:  rlotun at gmail.com
work:   reza at tweetdeck.com
twitter: @rlotun



From burslem2001 at yahoo.com  Mon Mar 15 14:42:10 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 13:42:10 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <95bb10691003151115we64158aj876196d27598829d@mail.gmail.com>
Message-ID: <771500.41332.qm@web112503.mail.gq1.yahoo.com>

Hello,


twistd -r epoll -y ./nfddaemon.tac

The below is the .tac file:

from twisted.application import service,internet
from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


def get_service():
    serverContext =  ServerContextFactory()
    return reactor.listenSSL(2000, serverContext, serverContext)

application=service.Application('nfdm')
service=get_service()
service.setServiceParent(application)

Not sure what to do at this point. It runs and then dies, doing something wrong in getService() dont know ehat the correct syntax is:

File "./nfddaemon.tac", line 12, in <module>
	    service.setServiceParent(application)
	exceptions.AttributeError: 'Port' object has no attribute 'setServiceParent'

Thanks,
Garyc



--- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com> wrote:

> From: Reza Lotun <rlotun at gmail.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 1:15 PM
> On Mon, Mar 15, 2010 at 6:03 PM, gary
> clark <burslem2001 at yahoo.com>
> wrote:
> > Yeh I have to install them and create a setup.py to
> find the path.
> 
> You only need to set your PYTHONPATH environment variable.
> 
> e.g.
> 
> $ export PYTHONPATH=/path/to/dir/containing/code
> 
> -- 
> Reza Lotun
> mobile: +44 (0)7521 310 763
> email: rlotun at gmail.com
> work:reza at tweetdeck.com
> twitter: @rlotun
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From burslem2001 at yahoo.com  Mon Mar 15 15:00:14 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 14:00:14 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <771500.41332.qm@web112503.mail.gq1.yahoo.com>
Message-ID: <767190.37643.qm@web112519.mail.gq1.yahoo.com>

Ok the below works:

from twisted.application import service,internet
from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


def get_service():
    serverContext =  ServerContextFactory()
    return internet.SSLServer(2000, serverContext)

application=service.Application('nfdm')
service=get_service()
service.setServiceParent(application)


--- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com> wrote:

> From: gary clark <burslem2001 at yahoo.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 3:42 PM
> Hello,
> 
> 
> twistd -r epoll -y ./nfddaemon.tac
> 
> The below is the .tac file:
> 
> from twisted.application import service,internet
> from nfdmessenger import ServerContextFactory
> from twisted.internet import ssl, reactor
> 
> 
> def get_service():
>   serverContext = ServerContextFactory()
>   return reactor.listenSSL(2000, serverContext,
> serverContext)
> 
> application=service.Application('nfdm')
> service=get_service()
> service.setServiceParent(application)
> 
> Not sure what to do at this point. It runs and then dies,
> doing something wrong in getService() dont know ehat the
> correct syntax is:
> 
> File "./nfddaemon.tac", line 12, in <module>
>   
> service.setServiceParent(application)
>  exceptions.AttributeError: 'Port' object
> has no attribute 'setServiceParent'
> 
> Thanks,
> Garyc
> 
> 
> 
> --- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com>
> wrote:
> 
> > From: Reza Lotun <rlotun at gmail.com>
> > Subject: Re: [Twisted-Python] Creating a daemon from
> my application
> > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > Date: Monday, March 15, 2010, 1:15 PM
> > On Mon, Mar 15, 2010 at 6:03 PM, gary
> > clark <burslem2001 at yahoo.com>
> > wrote:
> > > Yeh I have to install them and create a setup.py
> to
> > find the path.
> > 
> > You only need to set your PYTHONPATH environment
> variable.
> > 
> > e.g.
> > 
> > $ export PYTHONPATH=/path/to/dir/containing/code
> > 
> > -- 
> > Reza Lotun
> > mobile: +44 (0)7521 310 763
> > email: rlotun at gmail.com
> > work:reza at tweetdeck.com
> > twitter: @rlotun
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From burslem2001 at yahoo.com  Mon Mar 15 15:11:54 2010
From: burslem2001 at yahoo.com (gary clark)
Date: Mon, 15 Mar 2010 14:11:54 -0700 (PDT)
Subject: [Twisted-Python] Creating a daemon from my application
In-Reply-To: <767190.37643.qm@web112519.mail.gq1.yahoo.com>
Message-ID: <788265.35276.qm@web112508.mail.gq1.yahoo.com>

from twisted.application import service,internet
from nfdmessenger import ServerContextFactory
from twisted.internet import ssl, reactor


def get_service():
    serverContext =  ServerContextFactory()
    return internet.SSLServer(2000, serverContext,serverContext)

application=service.Application('nfdm')
service=get_service()
service.setServiceParent(application)

Thats better.



--- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com> wrote:

> From: gary clark <burslem2001 at yahoo.com>
> Subject: Re: [Twisted-Python] Creating a daemon from my application
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Date: Monday, March 15, 2010, 4:00 PM
> Ok the below works:
> 
> from twisted.application import service,internet
> from nfdmessenger import ServerContextFactory
> from twisted.internet import ssl, reactor
> 
> 
> def get_service():
>   serverContext = ServerContextFactory()
>   return internet.SSLServer(2000,
> serverContext)
> 
> application=service.Application('nfdm')
> service=get_service()
> service.setServiceParent(application)
> 
> 
> --- On Mon, 3/15/10, gary clark <burslem2001 at yahoo.com>
> wrote:
> 
> > From: gary clark <burslem2001 at yahoo.com>
> > Subject: Re: [Twisted-Python] Creating a daemon from
> my application
> > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > Date: Monday, March 15, 2010, 3:42 PM
> > Hello,
> > 
> > 
> > twistd -r epoll -y ./nfddaemon.tac
> > 
> > The below is the .tac file:
> > 
> > from twisted.application import service,internet
> > from nfdmessenger import ServerContextFactory
> > from twisted.internet import ssl, reactor
> > 
> > 
> > def get_service():
> >   serverContext = ServerContextFactory()
> >   return reactor.listenSSL(2000, serverContext,
> > serverContext)
> > 
> > application=service.Application('nfdm')
> > service=get_service()
> > service.setServiceParent(application)
> > 
> > Not sure what to do at this point. It runs and then
> dies,
> > doing something wrong in getService() dont know ehat
> the
> > correct syntax is:
> > 
> > File "./nfddaemon.tac", line 12, in <module>
> >   
> > service.setServiceParent(application)
> >  exceptions.AttributeError: 'Port' object
> > has no attribute 'setServiceParent'
> > 
> > Thanks,
> > Garyc
> > 
> > 
> > 
> > --- On Mon, 3/15/10, Reza Lotun <rlotun at gmail.com>
> > wrote:
> > 
> > > From: Reza Lotun <rlotun at gmail.com>
> > > Subject: Re: [Twisted-Python] Creating a daemon
> from
> > my application
> > > To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> > > Date: Monday, March 15, 2010, 1:15 PM
> > > On Mon, Mar 15, 2010 at 6:03 PM, gary
> > > clark <burslem2001 at yahoo.com>
> > > wrote:
> > > > Yeh I have to install them and create a
> setup.py
> > to
> > > find the path.
> > > 
> > > You only need to set your PYTHONPATH environment
> > variable.
> > > 
> > > e.g.
> > > 
> > > $ export PYTHONPATH=/path/to/dir/containing/code
> > > 
> > > -- 
> > > Reza Lotun
> > > mobile: +44 (0)7521 310 763
> > > email: rlotun at gmail.com
> > > work:reza at tweetdeck.com
> > > twitter: @rlotun
> > > 
> > > _______________________________________________
> > > Twisted-Python mailing list
> > > Twisted-Python at twistedmatrix.com
> > > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > > 
> > 
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From screwtape at froup.com  Mon Mar 15 16:36:26 2010
From: screwtape at froup.com (Tim Allen)
Date: Tue, 16 Mar 2010 09:36:26 +1100
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
 updated
In-Reply-To: <12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
	<12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
Message-ID: <20100315223626.GC13982@boombah.thristian.org>

On Mon, Mar 15, 2010 at 09:30:05AM -0500, Mikhail Terekhov wrote:
> On Sun, Mar 14, 2010 at 1:44 AM, Glyph Lefkowitz
> <glyph at twistedmatrix.com> wrote:
> >
> > On Mar 11, 2010, at 3:05 PM, exarkun at twistedmatrix.com wrote:
> >
> > If you notice anything broken about the website now, please point it
> > out.
> >
> > Also, the spacing on the revision log and repository browser seems wrong;
> > many table rows are double height for some reason.
> > Still, I'm not complaining - just the fact that things paginate now has made
> > the experience of doing triage much more pleasant!
> 
> In case of FF-3.6 the rows are triple height and filled in a funny ragged way.

There's a <span class="expand">&nbsp;</span> in the markup at the
beginning of the first cell in each row, followed by an <a> tag that
actually links to the directory in question. For some reason, <a> tags
in that table have "display: block" (/trac/chrome/common/css/browser.css,
line 50) which among other things forces them to start on a new line,
after the <span>. If the <span> was removed (putting the <a> at the
beginning of the cell), or the "display:block" was removed (making the
<a> follow the <span> on the same line), or the &nbsp; was removed
(collapsing the <span> to zero height so it wouldn't leave a gap),
things should be prettier.

> In addition to that the menu is overlapped in FF but this was the same
> way before
> update. BTW in IE6 menu is OK.

Which menu is that?



From newptcai at gmail.com  Tue Mar 16 01:07:09 2010
From: newptcai at gmail.com (Peter Cai)
Date: Tue, 16 Mar 2010 15:07:09 +0800
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
In-Reply-To: <20100315110719.GA22570@murdoc>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
Message-ID: <befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>

I think an init.d script could resolve this problem.
But I am curious about why "turning off power without shutdown twisted
server before" could cause such a problem.

Is it a bug or it has some more fundamental reason?

On Mon, Mar 15, 2010 at 7:07 PM, Marco Giusti <marco.giusti at gmail.com>wrote:

> On Mon, Mar 15, 2010 at 06:32:23PM +0800, Peter Cai wrote:
> > Someone turn off the server by cutting power of the server.
> > When the machine is power on, I found my twisted application could not
> start
> > and emit the following error.
> >
> > Another twistd server is running, PID 3398
> >
> > This could either be a previously started instance of your application or
> a
> > different application entirely. To start a new one, either run it in some
> > other
> > directory, or use the --pidfile and --logfile parameters to avoid
> clashes.
> >
> > After I deleted twistd.pid, it could start normally.
> >
> > I checked if there is process with PID 3398, but there wasn't.
> >
> > What might cause this problem?  How to avoid it?
>
> the problem is caused by turning off power without shutdown twisted
> server before. One solution could be create an init.d script that checks
> for the existence of a pid file and delete it.
>
>
> ciao
> m.
>
>
> --
> Hofstadter's Law:
> It always takes longer than you expect, even when you take into account
> Hofstadter's Law.
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.10 (GNU/Linux)
>
> iEYEARECAAYFAkueFOcACgkQ7ZmvfLU1M3V53wCdG/AtaA4tHOxxTN/dNZjdxRqR
> vgcAni2stbXYn4kJPnhJdzg3btH7hCwi
> =bNrT
> -----END PGP SIGNATURE-----
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


-- 
look to the things around you,the immediate world around you, if you are
alive,it will mean something to you Paul Strand
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100316/9f214cd0/attachment.html>

From tim at commsecure.com.au  Tue Mar 16 01:27:40 2010
From: tim at commsecure.com.au (Tim Allen)
Date: Tue, 16 Mar 2010 18:27:40 +1100
Subject: [Twisted-Python] My twisted application could not start after
 reboot be cause of "twistd.pid"
In-Reply-To: <befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
Message-ID: <4B9F32EC.1030606@commsecure.com.au>

On 03/16/2010 06:07 PM, Peter Cai wrote:
> I think an init.d script could resolve this problem.
> But I am curious about why "turning off power without shutdown twisted
> server before" could cause such a problem.
>
> Is it a bug or it has some more fundamental reason?

When twistd starts up, it creates a .pid file as a signal that it's 
running. If you try and start it a second time, it notices that the .pid 
file exists, and refuses to run a second time. When twistd is shut down 
cleanly, it removes the .pid file so that it can be run again.

Unfortunately, this means that if twistd is shutdown *uncleanly* (by a 
power failure, or SIGKILL, or some other means), the .pid file must be 
removed before twistd will start again.

This isn't really a bug in twistd as such; almost all Unix daemons use 
the same fundamental system. Try running "ls /var/run/*.pid" on a Linux 
system, for example.

It's possible to add refinements to the basic .pid system, to make it 
more resistant to this kind of problem (off the top of my head, checking 
that the named PID exists, that it's a process of the right kind, 
checking for stale .pid files with exclusive file locks), but all of 
them require more code to implement, reduce portability, and still have 
corner-cases that would require an admin to manually delete the .pid 
file anyway.



From exarkun at twistedmatrix.com  Tue Mar 16 05:31:05 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 16 Mar 2010 11:31:05 -0000
Subject: [Twisted-Python] My twisted application could not start
	after	reboot be cause of "twistd.pid"
In-Reply-To: <4B9F32EC.1030606@commsecure.com.au>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
	<4B9F32EC.1030606@commsecure.com.au>
Message-ID: <20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>

On 07:27 am, tim at commsecure.com.au wrote:
>On 03/16/2010 06:07 PM, Peter Cai wrote:
>>I think an init.d script could resolve this problem.
>>But I am curious about why "turning off power without shutdown twisted
>>server before" could cause such a problem.
>>
>>Is it a bug or it has some more fundamental reason?
>
>When twistd starts up, it creates a .pid file as a signal that it's
>running. If you try and start it a second time, it notices that the 
>.pid
>file exists, and refuses to run a second time. When twistd is shut down
>cleanly, it removes the .pid file so that it can be run again.
>
>Unfortunately, this means that if twistd is shutdown *uncleanly* (by a
>power failure, or SIGKILL, or some other means), the .pid file must be
>removed before twistd will start again.
>
>This isn't really a bug in twistd as such; almost all Unix daemons use
>the same fundamental system. Try running "ls /var/run/*.pid" on a Linux
>system, for example.
>
>It's possible to add refinements to the basic .pid system, to make it
>more resistant to this kind of problem (off the top of my head, 
>checking
>that the named PID exists,

Actually it does this already.  But this is a particularly ineffective 
check, especially for processes launched at boot time, because of the 
very high possibility of collisions.
>
>that it's a process of the right kind,
>checking for stale .pid files with exclusive file locks), but all of
>them require more code to implement, reduce portability, and still have
>corner-cases that would require an admin to manually delete the .pid
>file anyway.

Jean-Paul



From alexandre at quessy.net  Tue Mar 16 06:44:44 2010
From: alexandre at quessy.net (Alexandre Quessy)
Date: Tue, 16 Mar 2010 08:44:44 -0400
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
In-Reply-To: <20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
	<4B9F32EC.1030606@commsecure.com.au>
	<20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>
Message-ID: <72236ba91003160544g1dff08c2va4575783ab610617@mail.gmail.com>

Hello everyone,


2010/3/16  <exarkun at twistedmatrix.com>:
> On 07:27 am, tim at commsecure.com.au wrote:
>>On 03/16/2010 06:07 PM, Peter Cai wrote:
>>>I think an init.d script could resolve this problem.
>>>But I am curious about why "turning off power without shutdown twisted
>>>server before" could cause such a problem.
>>>
>>>Is it a bug or it has some more fundamental reason?
>>
>>When twistd starts up, it creates a .pid file as a signal that it's
>>running. If you try and start it a second time, it notices that the
>>.pid
>>file exists, and refuses to run a second time. When twistd is shut down
>>cleanly, it removes the .pid file so that it can be run again.
>>
>>Unfortunately, this means that if twistd is shutdown *uncleanly* (by a
>>power failure, or SIGKILL, or some other means), the .pid file must be
>>removed before twistd will start again.
>>
>>This isn't really a bug in twistd as such; almost all Unix daemons use
>>the same fundamental system. Try running "ls /var/run/*.pid" on a Linux
>>system, for example.
>>
>>It's possible to add refinements to the basic .pid system, to make it
>>more resistant to this kind of problem (off the top of my head,
>>checking
>>that the named PID exists,
>
> Actually it does this already. But this is a particularly ineffective
> check, especially for processes launched at boot time, because of the
> very high possibility of collisions.

It is possible to retrieve the command line that was used to start a
process. This would be a simple way to check for matches. The command
line used to start the twistd process could even be stored as well for
comparison.

>>
>>that it's a process of the right kind,
>>checking for stale .pid files with exclusive file locks), but all of
>>them require more code to implement, reduce portability, and still have
>>corner-cases that would require an admin to manually delete the .pid
>>file anyway.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>

Best,
-- 
Alexandre Quessy
http://alexandre.quessy.net/



From termim at gmail.com  Tue Mar 16 07:48:17 2010
From: termim at gmail.com (Mikhail Terekhov)
Date: Tue, 16 Mar 2010 09:48:17 -0400
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <20100315223626.GC13982@boombah.thristian.org>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
	<12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
	<20100315223626.GC13982@boombah.thristian.org>
Message-ID: <12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>

On Mon, Mar 15, 2010 at 6:36 PM, Tim Allen <screwtape at froup.com> wrote:
> On Mon, Mar 15, 2010 at 09:30:05AM -0500, Mikhail Terekhov wrote:
>> On Sun, Mar 14, 2010 at 1:44 AM, Glyph Lefkowitz
>> <glyph at twistedmatrix.com> wrote:
>> >
>> > On Mar 11, 2010, at 3:05 PM, exarkun at twistedmatrix.com wrote:
>> >
>> > If you notice anything broken about the website now, please point it
>> > out.
>> >
>> > Also, the spacing on the revision log and repository browser seems wrong;
>> > many table rows are double height for some reason.
>> > Still, I'm not complaining - just the fact that things paginate now has made
>> > the experience of doing triage much more pleasant!
>>
>> In case of FF-3.6 the rows are triple height and filled in a funny ragged way.
>
> There's a <span class="expand">&nbsp;</span> in the markup at the
> beginning of the first cell in each row, followed by an <a> tag that
> actually links to the directory in question. For some reason, <a> tags
> in that table have "display: block" (/trac/chrome/common/css/browser.css,
> line 50) which among other things forces them to start on a new line,
> after the <span>. If the <span> was removed (putting the <a> at the
> beginning of the cell), or the "display:block" was removed (making the
> <a> follow the <span> on the same line), or the &nbsp; was removed
> (collapsing the <span> to zero height so it wouldn't leave a gap),
> things should be prettier.
>
I'm not an expert on css so I can't comment on that. The thing is that I've
never seen that behavior in any other Trac site on the net, so it is something
twistedmatrix specific IMHO.

>> In addition to that the menu is overlapped in FF but this was the same
>> way before
>> update. BTW in IE6 menu is OK.
>
> Which menu is that?
>
The Wiki/Timeline/... and Login/Preferences/..., see attached screen shot.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cnnect2.png
Type: image/png
Size: 9808 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20100316/09331786/attachment-0002.png>

From glyph at twistedmatrix.com  Tue Mar 16 09:46:23 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 16 Mar 2010 11:46:23 -0400
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
In-Reply-To: <72236ba91003160544g1dff08c2va4575783ab610617@mail.gmail.com>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
	<4B9F32EC.1030606@commsecure.com.au>
	<20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>
	<72236ba91003160544g1dff08c2va4575783ab610617@mail.gmail.com>
Message-ID: <E014522F-6094-430A-8C6B-E54B5C47FAE2@twistedmatrix.com>

On Mar 16, 2010, at 8:44 AM, Alexandre Quessy wrote:

> Hello everyone,
> 
> 
> 2010/3/16  <exarkun at twistedmatrix.com>:
>> On 07:27 am, tim at commsecure.com.au wrote:
>>> 
>>> It's possible to add refinements to the basic .pid system, to make it
>>> more resistant to this kind of problem (off the top of my head,
>>> checking
>>> that the named PID exists,
>> 
>> Actually it does this already.  But this is a particularly ineffective
>> check, especially for processes launched at boot time, because of the
>> very high possibility of collisions.
> 
> It is possible to retrieve the command line that was used to start a
> process. This would be a simple way to check for matches. The command
> line used to start the twistd process could even be stored as well for
> comparison.

There are many ways to make this more robust; in fact, we already have a ticket open for doing something about this problem: <http://twistedmatrix.com/trac/ticket/3851>.  If you're interested in fixing it, some work there would be helpful.  Even just some comments about different ways this problem can occur and different approaches to solving it would be good, so we can have them all in one place.

Thanks,

-glyph




From alexandre at quessy.net  Tue Mar 16 10:00:36 2010
From: alexandre at quessy.net (Alexandre Quessy)
Date: Tue, 16 Mar 2010 12:00:36 -0400
Subject: [Twisted-Python] My twisted application could not start after
	reboot be cause of "twistd.pid"
In-Reply-To: <E014522F-6094-430A-8C6B-E54B5C47FAE2@twistedmatrix.com>
References: <befee6d81003150332w52b74c63sb179b49d453fb537@mail.gmail.com>
	<20100315110719.GA22570@murdoc>
	<befee6d81003160007m14902010ra2bfc3eb436bd59c@mail.gmail.com>
	<4B9F32EC.1030606@commsecure.com.au>
	<20100316113105.2792.500274859.divmod.xquotient.1662@localhost.localdomain>
	<72236ba91003160544g1dff08c2va4575783ab610617@mail.gmail.com>
	<E014522F-6094-430A-8C6B-E54B5C47FAE2@twistedmatrix.com>
Message-ID: <72236ba91003160900k5069c93fn61a2a198685a521f@mail.gmail.com>

Hello,

2010/3/16 Glyph Lefkowitz <glyph at twistedmatrix.com>:
> On Mar 16, 2010, at 8:44 AM, Alexandre Quessy wrote:
>
>> Hello everyone,
>>
>>
>> 2010/3/16 <exarkun at twistedmatrix.com>:
>>> On 07:27 am, tim at commsecure.com.au wrote:
>>>>
>>>> It's possible to add refinements to the basic .pid system, to make it
>>>> more resistant to this kind of problem (off the top of my head,
>>>> checking
>>>> that the named PID exists,
>>>
>>> Actually it does this already. But this is a particularly ineffective
>>> check, especially for processes launched at boot time, because of the
>>> very high possibility of collisions.
>>
>> It is possible to retrieve the command line that was used to start a
>> process. This would be a simple way to check for matches. The command
>> line used to start the twistd process could even be stored as well for
>> comparison.
>
> There are many ways to make this more robust; in fact, we already have a ticket open for doing something about this problem: <http://twistedmatrix.com/trac/ticket/3851>. If you're interested in fixing it, some work there would be helpful. Even just some comments about different ways this problem can occur and different approaches to solving it would be good, so we can have them all in one place.

Excellent,
I've added a comment there.
Cheers,

>
> Thanks,
>
> -glyph
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Alexandre Quessy
http://alexandre.quessy.net/



From lists at collab.nl  Tue Mar 16 12:50:50 2010
From: lists at collab.nl (Thijs Triemstra | Collab)
Date: Tue, 16 Mar 2010 18:50:50 +0000
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
	updated
In-Reply-To: <12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
	<12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
	<20100315223626.GC13982@boombah.thristian.org>
	<12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>
Message-ID: <DD0ED0FD-BA86-48C0-9E68-F51FFE8DB7AD@collab.nl>


On 16 Mar 2010, at 13:48, Mikhail Terekhov wrote

> I'm not an expert on css so I can't comment on that. The thing is that I've
> never seen that behavior in any other Trac site on the net, so it is something
> twistedmatrix specific IMHO.
> 
>>> In addition to that the menu is overlapped in FF but this was the same
>>> way before
>>> update. BTW in IE6 menu is OK.
>> 
>> Which menu is that?
>> 
> The Wiki/Timeline/... and Login/Preferences/..., see attached screen shot.

I think the Trac installation was updated (the software) but not the template with all the css, so it's trying to make an early (alpha?) version of Trac 0.11 look like Trac 0.11.6.

Is it possible to take a clean css export from a new Trac environment and merge the existing css styles in there? Let me know if you need help with that of course.

Cheers,

Thijs





From jasonjwwilliams at gmail.com  Tue Mar 16 15:34:33 2010
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Tue, 16 Mar 2010 15:34:33 -0600
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log Files
Message-ID: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>

Hello,

Twistd blocks for a long period of time when the number of log files
built up is large, thereby causing connections to freeze and
(depending on the length of the rotation) time out.

Given I've only used Twisted in the past and not contributed to it, I
was curious if someone could take a look at my changes to
twisted.python.logfile.LogFile's rotate() method and see if there's
any reason the changes would be a bad idea.

What I've attempted to do is defer the rotation of the old log files
to a thread, and only rotate the current log file in the foreground.

Original twisted.python.logfile.LogFile.rotate(): http://gist.github.com/334538

My version with deferral of old log rotation: http://gist.github.com/334545

(Changes are against Twisted 10.0).

Thank you in advance.

-J



From maarten at treewalker.org  Tue Mar 16 17:01:00 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Wed, 17 Mar 2010 00:01:00 +0100
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log
	Files
In-Reply-To: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
References: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
Message-ID: <201003170001.00909.maarten@treewalker.org>

On Tuesday 16 March 2010, Jason J. W. Williams wrote:

> Twistd blocks for a long period of time when the number of log files
> built up is large, thereby causing connections to freeze and
> (depending on the length of the rotation) time out.
> 
> Given I've only used Twisted in the past and not contributed to it, I
> was curious if someone could take a look at my changes to
> twisted.python.logfile.LogFile's rotate() method and see if there's
> any reason the changes would be a bad idea.
> 
> What I've attempted to do is defer the rotation of the old log files
> to a thread, and only rotate the current log file in the foreground.

An alternative approach could be to name the log files differently.
For example, use the timestamp of the rotation as a filename suffix:
  twistd.log.2010-03-16.23-56

This is not the traditional way logging is done, but it would get good 
performance with simple code. (It would still need resolution of duplicate 
file names, in case the log rotates very quickly or the clock is moved 
backwards.)

Bye,
		Maarten



From screwtape at froup.com  Tue Mar 16 16:43:34 2010
From: screwtape at froup.com (Timothy Allen)
Date: Wed, 17 Mar 2010 09:43:34 +1100
Subject: [Twisted-Python] http://twistedmatrix.com/ trac installation
 updated
In-Reply-To: <12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>
References: <20100311200509.2792.1735871946.divmod.xquotient.1581@localhost.localdomain>
	<9411C3E5-C232-424A-B4EB-C9C829DC40D2@twistedmatrix.com>
	<12aaa0811003150730o4142506ew6a974c1162607865@mail.gmail.com>
	<20100315223626.GC13982@boombah.thristian.org>
	<12aaa0811003160648m793c3c81ue6b5677c45068f1b@mail.gmail.com>
Message-ID: <20100317094334.528183ab@hepzibah>

On Tue, 16 Mar 2010 09:48:17 -0400
Mikhail Terekhov <termim at gmail.com> wrote:

> On Mon, Mar 15, 2010 at 6:36 PM, Tim Allen <screwtape at froup.com>
> wrote:
> > On Mon, Mar 15, 2010 at 09:30:05AM -0500, Mikhail Terekhov wrote:
> >> In addition to that the menu is overlapped in FF but this was the
> >> same way before
> >> update. BTW in IE6 menu is OK.
> >
> > Which menu is that?
> >
> The Wiki/Timeline/... and Login/Preferences/..., see attached screen
> shot.

Ah, I see. That menu looks fine on my machine (using Firefox 3.7a3 on
Linux), but I can get something sort of similar if I boost the
Firefox's 'minimum font size' option to 12 or 13 instead of my usual 10.

It turns out that the "banner" section (from the green gradient to the
top, down to "Login/Preferences/...") is sized at exactly 135px high,
which makes some grave assumptions about the sizes of the fonts
involved. If I delete that fixed height, then the two rows of menus no
longer overlap.

The lower menu (Wiki/Timeline/...) still looks a bit odd, because its
gradient background is an image exactly 22px tall, so if the text is
higher than that you get a dark margin appearing below. Not much to be
done about, that, really - except perhaps changing the background
colour so it matches the final colour in the gradient, which makes the
problem less obvious rather than actually fixing it.



From jasonjwwilliams at gmail.com  Tue Mar 16 17:57:08 2010
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Tue, 16 Mar 2010 17:57:08 -0600
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log
	Files
In-Reply-To: <201003170001.00909.maarten@treewalker.org>
References: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
	<201003170001.00909.maarten@treewalker.org>
Message-ID: <3b949f091003161657y7fb0d0dboc806706676e827fb@mail.gmail.com>

True. Technically, you could also just kick it out to syslog and let
logrotate.d do the rotation for you.

The code I put up had a major "concurrency" error in that multiple
rotation threads could be launched and conflict with each other (try
to remove the same file).

Updated the Gist to deal with this: http://gist.github.com/334545

-J

On Tue, Mar 16, 2010 at 5:01 PM, Maarten ter Huurne
<maarten at treewalker.org> wrote:
> On Tuesday 16 March 2010, Jason J. W. Williams wrote:
>
>> Twistd blocks for a long period of time when the number of log files
>> built up is large, thereby causing connections to freeze and
>> (depending on the length of the rotation) time out.
>>
>> Given I've only used Twisted in the past and not contributed to it, I
>> was curious if someone could take a look at my changes to
>> twisted.python.logfile.LogFile's rotate() method and see if there's
>> any reason the changes would be a bad idea.
>>
>> What I've attempted to do is defer the rotation of the old log files
>> to a thread, and only rotate the current log file in the foreground.
>
> An alternative approach could be to name the log files differently.
> For example, use the timestamp of the rotation as a filename suffix:
> twistd.log.2010-03-16.23-56
>
> This is not the traditional way logging is done, but it would get good
> performance with simple code. (It would still need resolution of duplicate
> file names, in case the log rotates very quickly or the clock is moved
> backwards.)
>
> Bye,
>        Maarten
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From twisted at asheesh.org  Tue Mar 16 19:29:42 2010
From: twisted at asheesh.org (Asheesh Laroia)
Date: Tue, 16 Mar 2010 21:29:42 -0400 (EDT)
Subject: [Twisted-Python] Twisted easy bugs,
 and other thoughts about getting people involved in Twisted
In-Reply-To: <20100315001637.2792.1150179124.divmod.xquotient.1609@localhost.localdomain>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
	<d9047f781003131407o39c8562fu5c2994e108ec01a2@mail.gmail.com>
	<alpine.DEB.2.00.1003141221001.18193@vellum>
	<20100315001637.2792.1150179124.divmod.xquotient.1609@localhost.localdomain>
Message-ID: <alpine.DEB.2.00.1003162105580.4600@vellum>

On Mon, 15 Mar 2010, exarkun at twistedmatrix.com wrote:

> On 14 Mar, 04:53 pm, twisted at asheesh.org wrote:
>>
>> One more thing -- pulling data out of Trac isn't actually super easy 
>> (-:. So if you want us to re-export that in some really simple format 
>> like a big JSON list, that's something else we can do.
>
> How do you mean?  It's actually pretty straightforward to get data out; 
> you can have it as rss, csv, or tsv in most cases.

Yeah -- but (see below)

> This leads me to wonder how you grabbed the "easy" tickets from the 
> tracker.  Surely this is an automated process which is reading the csv 
> format of a trac "tickets with `easy` keyword" query page?  If not, how 
> does the OpenHatch listing stay up to date?

It is doing just that to find the IDs to look at.

Then it actually scrapes the Trac-rendered HTML because the CSV export (as 
far as I know) can't tell us answers to questions like, "How many people 
were active on this bug?" I find that's a useful thing to show off.

So it's a combination of both, and we end up with a little more data than 
the Trac API exports. I'll probably start serving out JSON dumps soon.

-- Asheesh.

-- 
"No one gets too old to learn a new way of being stupid."



From maarten at treewalker.org  Wed Mar 17 02:19:54 2010
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Wed, 17 Mar 2010 09:19:54 +0100
Subject: [Twisted-Python] Twisted easy bugs,
	and other thoughts about getting people involved in Twisted
In-Reply-To: <alpine.DEB.2.00.1003162105580.4600@vellum>
References: <alpine.DEB.2.00.1003101739050.2352@localhost>
	<20100315001637.2792.1150179124.divmod.xquotient.1609@localhost.localdomain>
	<alpine.DEB.2.00.1003162105580.4600@vellum>
Message-ID: <201003170919.54407.maarten@treewalker.org>

On Wednesday 17 March 2010, Asheesh Laroia wrote:

> Then it actually scrapes the Trac-rendered HTML because the CSV export
> (as far as I know) can't tell us answers to questions like, "How many
> people were active on this bug?" I find that's a useful thing to show
> off.

Not sure if it helps in your case, but I once made a script that produced a 
table of tickets associated with a milestone, to include with release notes. 
It needed the 1-line summary, which was not included in the CSV export. I 
thought I would have to resort to scraping the HTML, but then found that the 
RSS feed contained all the info I needed.

Bye,
		Maarten



From glyph at twistedmatrix.com  Wed Mar 17 10:12:12 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 17 Mar 2010 12:12:12 -0400
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log
	Files
In-Reply-To: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
References: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
Message-ID: <A8F98F95-ED5A-4AC1-A751-05243E602614@twistedmatrix.com>


On Mar 16, 2010, at 5:34 PM, Jason J. W. Williams wrote:

> Given I've only used Twisted in the past and not contributed to it, I
> was curious if someone could take a look at my changes to
> twisted.python.logfile.LogFile's rotate() method and see if there's
> any reason the changes would be a bad idea.


The right way to ask this question is to open a ticket on twistedmatrix.com and put it into review (attach the 'review' keyword).  More information is available here: <http://twistedmatrix.com/trac/wiki/ContributingToTwistedLabs>.  Otherwise, unless someone has a chance to look at it right away (which is always unlikely) it will languish in the mailing list archive forever.

Be sure to check back on the ticket when you receive feedback, as approximately 0% of suggested patches are actually accepted as-is without some cleanup :).

Thanks!

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100317/eca69639/attachment-0001.html>

From jasonjwwilliams at gmail.com  Wed Mar 17 10:51:48 2010
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Wed, 17 Mar 2010 10:51:48 -0600
Subject: [Twisted-Python] Log Rotation Blocks w/ Large Number of Log
	Files
In-Reply-To: <A8F98F95-ED5A-4AC1-A751-05243E602614@twistedmatrix.com>
References: <3b949f091003161434l16c2410bnf7986cd0c68877ea@mail.gmail.com>
	<A8F98F95-ED5A-4AC1-A751-05243E602614@twistedmatrix.com>
Message-ID: <3b949f091003170951n5c29e7d9g403487a40edb30fc@mail.gmail.com>

As requested: http://twistedmatrix.com/trac/ticket/4372 Thank you for
taking a look at it.

-J

On Wed, Mar 17, 2010 at 10:12 AM, Glyph Lefkowitz
<glyph at twistedmatrix.com> wrote:
>
> On Mar 16, 2010, at 5:34 PM, Jason J. W. Williams wrote:
>
> Given I've only used Twisted in the past and not contributed to it, I
> was curious if someone could take a look at my changes to
> twisted.python.logfile.LogFile's rotate() method and see if there's
> any reason the changes would be a bad idea.
>
> The right way to ask this question is to open a ticket on twistedmatrix.com
> and put it into review (attach the 'review' keyword). More information is
> available here:
> <http://twistedmatrix.com/trac/wiki/ContributingToTwistedLabs>. Otherwise,
> unless someone has a chance to look at it right away (which is always
> unlikely) it will languish in the mailing list archive forever.
> Be sure to check back on the ticket when you receive feedback, as
> approximately 0% of suggested patches are actually accepted as-is without
> some cleanup :).
> Thanks!
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



From freelancer.c at gmail.com  Thu Mar 18 02:01:23 2010
From: freelancer.c at gmail.com (=?ISO-8859-1?B?KCopt7Rgty64LrvQ68RkTeTxt7Rgty64LrsoKik=?=)
Date: Thu, 18 Mar 2010 10:01:23 +0200
Subject: [Twisted-Python] Twisted and python threading
Message-ID: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>

Hi,

I'm trying to spawn a threading.Thread from a Twisted application, but
the thread won't start unless I schedule the the code with
reactor.callLater(), any Ideas ?



From andrew at bemusement.org  Thu Mar 18 04:08:25 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Thu, 18 Mar 2010 21:08:25 +1100
Subject: [Twisted-Python] Twisted and python threading
In-Reply-To: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>
References: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>
Message-ID: <20100318100825.GM14474@steerpike.home.puzzling.org>

(*)`..dM`..(*) wrote:
> Hi,
> 
> I'm trying to spawn a threading.Thread from a Twisted application, but
> the thread won't start unless I schedule the the code with
> reactor.callLater(), any Ideas ?

Twisted doesn't affect threading.Thread at all.

You haven't given much detail, so my best guess is that you are calling
Twisted APIs from a non-reactor thread.  Twisted's APIs are generally
*not* thread-safe, so that will give undefined behaviour (like nothing
happening when it should).  Basically the only API you should use is
reactor.callFromThread.  See
<http://twistedmatrix.com/documents/current/core/howto/threading.html>.

If that's not your problem, you'll have to elaborate more on what your
problem (like what precisely you mean by thread won't start) and how
to reproduce it.

-Andrew.




From freelancer.c at gmail.com  Thu Mar 18 04:21:47 2010
From: freelancer.c at gmail.com (=?ISO-8859-1?B?KCopt7Rgty64LrvQ68RkTeTxt7Rgty64LrsoKik=?=)
Date: Thu, 18 Mar 2010 12:21:47 +0200
Subject: [Twisted-Python] Twisted and python threading
In-Reply-To: <20100318100825.GM14474@steerpike.home.puzzling.org>
References: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>
	<20100318100825.GM14474@steerpike.home.puzzling.org>
Message-ID: <e954baa91003180321gf10a0f4nb61c705867522f3e@mail.gmail.com>

Hi thanks for the reply,

I have a separate module that doesn't/shouldn't depend on Twisted, and
this module is begin called from a Twisted application, and it needs
to spawn a thread the thread doesn't call anything within Twisted, the
problem is when I call start() the thread doesn't run, but If I import
Twisted into this module and spawn the thread from reactor.callLater()
it works just fine, that is, this code works :

#from twisted.internet import reactor
#reactor.callLater(1, threading.Thread(target=_listen,
args=(self._client,)).start)

But this doesn't:
#threading.Thread(target=_listen, args=(self._client,)).start()

I asked on #twisted and someone said that something about my
application running as daemon and that destroys all threads spawned
before that, and that I should spawn the thread *after* it's fully
daemonized.

I haven't tested that yet but I will now.

On Thu, Mar 18, 2010 at 12:08 PM, Andrew Bennetts <andrew at bemusement.org> wrote:
> (*)`..dM`..(*) wrote:
>> Hi,
>>
>> I'm trying to spawn a threading.Thread from a Twisted application, but
>> the thread won't start unless I schedule the the code with
>> reactor.callLater(), any Ideas ?
>
> Twisted doesn't affect threading.Thread at all.
>
> You haven't given much detail, so my best guess is that you are calling
> Twisted APIs from a non-reactor thread. Twisted's APIs are generally
> *not* thread-safe, so that will give undefined behaviour (like nothing
> happening when it should). Basically the only API you should use is
> reactor.callFromThread. See
> <http://twistedmatrix.com/documents/current/core/howto/threading.html>.
>
> If that's not your problem, you'll have to elaborate more on what your
> problem (like what precisely you mean by thread won't start) and how
> to reproduce it.
>
> -Andrew.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From markscottwright at gmail.com  Thu Mar 18 08:29:27 2010
From: markscottwright at gmail.com (markscottwright at gmail.com)
Date: Thu, 18 Mar 2010 14:29:27 +0000
Subject: [Twisted-Python] Is it possible to turn off transactions for adbapi?
Message-ID: <005045029c1fe6bed60482140ed8@google.com>

I'm trying to get SQL Server 2005 to CREATE DATABASE using twisted.  
However, SQL Server won't allow you to run CREATE DATABASE within a  
transaction (apparently, it's not something sql server can roll back, which  
seems sensible). Which means that the following code results in an error.  
Is there a way to turn transactions off for a query?

@defer.inlineCallbacks
def test_simple_create():
try:
password = "xxx"
connection_string = "Driver={SQL Native Client}; Server=(local); UID=sa;  
PWD=%s;" % password
db = adbapi.ConnectionPool("pyodbc", connection_string, cp_noisy=True)
cmd = """CREATE DATABASE atest
ON (NAME=atest, FILENAME='c:\temp\atest', SIZE=64MB)
LOG ON (NAME=atestlog, FILENAME='c:\temp\atestlog', SIZE=64MB)"""
yield db.runOperation(cmd)
except Exception, e:
print e
finally:
db.close()
reactor.stop()


if __name__ == "__main__":
from twisted.python import log
import sys
test_simple_create()
log.startLogging(sys.stdout)
reactor.run()


===
2010-03-18 09:28:45-0500 [-] Log opened.
2010-03-18 09:28:45-0500 [-] adbapi connecting: pyodbc ('Driver={SQL Native  
Client}; Server=(local); UID=sa; PWD=xxx;',)
2010-03-18 09:28:45-0500 [-] ('42000', '[42000] [Microsoft][SQL Native  
Client][SQL Server]CREATE DATABASE statement not allowed within  
multi-statement transaction. (226) (SQLExecDirectW)')
2010-03-18 09:28:45-0500 [-] adbapi closing: pyodbc
2010-03-18 09:28:45-0500 [-] Main loop terminated.
2010-03-18 09:28:45-0500 [-]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100318/6a086bbb/attachment.html>

From george at ringdevelopment.com  Thu Mar 18 09:53:24 2010
From: george at ringdevelopment.com (George Pauly)
Date: Thu, 18 Mar 2010 11:53:24 -0400
Subject: [Twisted-Python] Is it possible to turn off transactions
	for	adbapi?
In-Reply-To: <005045029c1fe6bed60482140ed8@google.com>
References: <005045029c1fe6bed60482140ed8@google.com>
Message-ID: <1268927604.31876.37.camel@localhost.localdomain>

Hi Mark,

On Thu, 2010-03-18 at 14:29 +0000, markscottwright at gmail.com wrote:
> I'm trying to get SQL Server 2005 to CREATE DATABASE using twisted.
> However, SQL Server won't allow you to run CREATE DATABASE within a
> transaction (apparently, it's not something sql server can roll back,
> which seems sensible). Which means that the following code results in
> an error. Is there a way to turn transactions off for a query?

First, you may be better off finding a SQL Server list.  

FWIW, and not a twisted solution per se, if the SQL server and your
twisted server are in a secured network you can send an http msg with
your create database statement.  This solution requires a webserver
(IIS) running on the sql server box and some configuration (a virtual
directory IIRC).

This solution will work from a non-windows OS.  For more complicated
queries, taking the ODBC black box out of the equation makes
optimization simpler (or even possible).  

LMA (Luvin my acronyms).

George

-- 
George Pauly
Ring Development
www.ringdevelopment.com




From renan at renanfernandes.org  Thu Mar 18 10:01:20 2010
From: renan at renanfernandes.org (Renan Mathias Fernandes)
Date: Thu, 18 Mar 2010 13:01:20 -0300
Subject: [Twisted-Python] FTP Client - questions
Message-ID: <252D1536-2315-4847-B169-AF07D01F7D8D@renanfernandes.org>

Hello,

	I am trying to learn/implement a FTP Client, but I am facing a problem: How can I check if the retrieveFile method has finished downloading a file? As far as I can see, there is no easy way to do this, am I incorrect?
Below is an example of what I am doing to retrieve a file:

class FileReceiver(Protocol):
    """
        Protocol subclass that writes received data to a local file.
    """
    def __init__(self, filename):
        self.file = open(filename, 'wb')

    def dataReceived(self, data):
        self.file.write(data)
                
def connectionMade(ftpClient):
    test = FileReceiver('./testRetrieve.txt')
    
    try:
        ftpClient.retrieveFile('testFile.txt',test)
    except:
        print "Exception -", sys.exc_value
        reactor.stop()


Can anyone shed a light?

Thanks in advance,

Renan Mathias Fernandes







From markscottwright at gmail.com  Thu Mar 18 10:44:21 2010
From: markscottwright at gmail.com (Mark Wright)
Date: Thu, 18 Mar 2010 11:44:21 -0500
Subject: [Twisted-Python] Is it possible to turn off transactions for
	adbapi?
In-Reply-To: <1268927604.31876.37.camel@localhost.localdomain>
References: <005045029c1fe6bed60482140ed8@google.com>
	<1268927604.31876.37.camel@localhost.localdomain>
Message-ID: <db986be81003180944h7fab894ckb1a5fc2e91782d79@mail.gmail.com>

Hey - ! was wrong.  It's actually easy, just specify "autocommit=True"
in your call to adbapi.ConnectionPool(...) and runOperation can
execute "create database".

On Thu, Mar 18, 2010 at 10:53 AM, George Pauly
<george at ringdevelopment.com> wrote:
> Hi Mark,
>
> On Thu, 2010-03-18 at 14:29 +0000, markscottwright at gmail.com wrote:
>> I'm trying to get SQL Server 2005 to CREATE DATABASE using twisted.
>> However, SQL Server won't allow you to run CREATE DATABASE within a
>> transaction (apparently, it's not something sql server can roll back,
>> which seems sensible). Which means that the following code results in
>> an error. Is there a way to turn transactions off for a query?
>
> First, you may be better off finding a SQL Server list.
>
> FWIW, and not a twisted solution per se, if the SQL server and your
> twisted server are in a secured network you can send an http msg with
> your create database statement. This solution requires a webserver
> (IIS) running on the sql server box and some configuration (a virtual
> directory IIRC).
>
> This solution will work from a non-windows OS. For more complicated
> queries, taking the ODBC black box out of the equation makes
> optimization simpler (or even possible).
>
> LMA (Luvin my acronyms).
>
> George
>
> --
> George Pauly
> Ring Development
> www.ringdevelopment.com
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Mark Wright
markscottwright at gmail.com



From andrew at bemusement.org  Thu Mar 18 16:52:30 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Fri, 19 Mar 2010 09:52:30 +1100
Subject: [Twisted-Python] FTP Client - questions
In-Reply-To: <252D1536-2315-4847-B169-AF07D01F7D8D@renanfernandes.org>
References: <252D1536-2315-4847-B169-AF07D01F7D8D@renanfernandes.org>
Message-ID: <20100318225230.GN14474@steerpike.home.puzzling.org>

Renan Mathias Fernandes wrote:
> Hello,
> 
> 	I am trying to learn/implement a FTP Client, but I am facing a problem:
> 	How can I check if the retrieveFile method has finished downloading a
> 	file? As far as I can see, there is no easy way to do this, am I
> 	incorrect?

You are incorrect.  FTPClient.retrieveFile returns a Deferred that fires
when the download is complete (or reports a failure).

The API doc hints at this, but could be clearer.
<http://twistedmatrix.com/documents/current/api/twisted.protocols.ftp.FTPClient.html#retrieveFile>

>     try:
>         ftpClient.retrieveFile('testFile.txt',test)
>     except:
>         print "Exception -", sys.exc_value
>         reactor.stop()
> 
> 
> Can anyone shed a light?

A direct correction to this snippet is:

    d = ftpClient.retrieveFile('testFile.txt', test)
    def eb(failure):
    	print "Exception -", failure.getErrorMessage()
	reactor.stop()
    d.addErrback(eb)

(Although like your code will only stop the reactor when an error
occurs, and doesn't do anything when the download completes
successfully.)

-Andrew.




From 4kir4.1i at gmail.com  Thu Mar 18 09:42:45 2010
From: 4kir4.1i at gmail.com (Akira)
Date: Thu, 18 Mar 2010 18:42:45 +0300
Subject: [Twisted-Python] Twisted and python threading
References: <e954baa91003180101p7f09fb85td7965be13fd268dd@mail.gmail.com>
	<20100318100825.GM14474@steerpike.home.puzzling.org>
	<e954baa91003180321gf10a0f4nb61c705867522f3e@mail.gmail.com>
Message-ID: <m3aau5prey.fsf@tb10.ngrid.ru>

"(*)`..dM`..(*)" <freelancer.c at gmail.com> writes:

> I asked on #twisted and someone said that something about my
> application running as daemon and that destroys all threads spawned
> before that, and that I should spawn the thread *after* it's fully
> daemonized.
reactor.callWhenRunning() could be used to spawn the thread. Then
reactor.callFromThread() (from within the thread) could be used to run
code that should run in the reactor's mainloop i.e., twisted related
code.


--
Akira.




From don at delphexonline.com  Fri Mar 19 06:35:07 2010
From: don at delphexonline.com (Don Schoeman)
Date: Fri, 19 Mar 2010 14:35:07 +0200
Subject: [Twisted-Python] Error: filedescriptor out of range in select
Message-ID: <4BA36F7B.2080600@delphexonline.com>

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100319/1559ef31/attachment-0001.html>

From andrew at bemusement.org  Fri Mar 19 06:58:30 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Fri, 19 Mar 2010 23:58:30 +1100
Subject: [Twisted-Python] Error: filedescriptor out of range in select
In-Reply-To: <4BA36F7B.2080600@delphexonline.com>
References: <4BA36F7B.2080600@delphexonline.com>
Message-ID: <20100319125830.GA17997@steerpike.home.puzzling.org>

Don Schoeman wrote:
>    Hi guys, I have started having this problem a few weeks ago and it
>    happens about once a week after which I have to restart my Twisted
>    based server to function again. It seems to be happening when I
>    make RPC calls using twisted.web.xmlrpc.Proxy. I have reason to
>    believe that I am either running out of file handles or connection
>    limits. I have up-sized my connection limits and ulimit -n gives
>    me 9000.

Note though that select() has a builtin limit, which varies by platform
but is probably 1024 for you.  So perhaps try the poll or epoll reactor
instead.

>    I receive less than 30 connections though so there must be some
>    kind of leak. The error I'm getting is the following:

30 is much less than 1024, though, so a leak does sound probable.

[...]
>    Now I know this is a very generic error and it could mean a lot of
>    things, but how would I even start tracking the leak down? Is there
>    a way I can try and track the number of file descriptors?

There's always strace, or looking in /proc/PID/fd.

>    I am using Twisted version 8.2.0 on Ubuntu Server Edition 9.10

Maybe try upgrading Twisted, preferably to 10.0.0?  I'm not sure if a
bug related to your problems was fixed since 8.2.0, but a lot of bugs
have been fixed in that ~2 years.  Hopefully there's a PPA somewhere
with a newer Twisted for your version of Ubuntu.

-Andrew.




From don at delphexonline.com  Fri Mar 19 08:53:35 2010
From: don at delphexonline.com (Don Schoeman)
Date: Fri, 19 Mar 2010 16:53:35 +0200
Subject: [Twisted-Python] Error: filedescriptor out of range in select
In-Reply-To: <20100319125830.GA17997@steerpike.home.puzzling.org>
References: <4BA36F7B.2080600@delphexonline.com>
	<20100319125830.GA17997@steerpike.home.puzzling.org>
Message-ID: <4BA38FEF.20302@delphexonline.com>

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100319/2d4c0e8c/attachment.html>

From johnaherne at rocs.co.uk  Fri Mar 19 10:35:52 2010
From: johnaherne at rocs.co.uk (John Aherne)
Date: Fri, 19 Mar 2010 16:35:52 +0000
Subject: [Twisted-Python] Error: filedescriptor out of range in select
In-Reply-To: <4BA38FEF.20302@delphexonline.com>
References: <4BA36F7B.2080600@delphexonline.com>
	<20100319125830.GA17997@steerpike.home.puzzling.org>
	<4BA38FEF.20302@delphexonline.com>
Message-ID: <faf2d7811003190935q6a4a5638k1347fd45e04863f2@mail.gmail.com>

I think you will find that gprs devices will drop off the network but the
router will still keep the coonection open. The gprs device will then
reconnect on a different connection and port. So you will need to clean up
old connections used by that device.

Hope that helps

John Aherne


On Fri, Mar 19, 2010 at 2:53 PM, Don Schoeman <don at delphexonline.com> wrote:

>  Hi Andrew, thanks for taking the time to comment on my email.
>
> I'm going to have to study your proposal to switch to poll/epoll anyway
> since I am expecting more and more connections to be made over time. This
> particular application is used to communicate with a bunch of GPRS devices
> and I'm starting to think that these devices might not be closing a
> connection properly which could perhaps lead to this particular problem. I
> am going to discuss it with the manufacturers of these devices as well.
>
> Thanks again for your help.
>
> Kind Regards,
> Don
>
>
> Andrew Bennetts wrote:
>
> Don Schoeman wrote:
>
>
>     Hi guys, I have started having this problem a few weeks ago and it
>    happens about once a week after which I have to restart my Twisted
>    based server to function again. It seems to be happening when I
>    make RPC calls using twisted.web.xmlrpc.Proxy. I have reason to
>    believe that I am either running out of file handles or connection
>    limits. I have up-sized my connection limits and ulimit -n  gives
>    me 9000.
>
>
>  Note though that select() has a builtin limit, which varies by platform
> but is probably 1024 for you.  So perhaps try the poll or epoll reactor
> instead.
>
>
>
>     I receive less than 30 connections though so there must be some
>    kind of leak. The error I'm getting is the following:
>
>
>  30 is much less than 1024, though, so a leak does sound probable.
>
> [...]
>
>
>     Now I know this is a very generic error and it could mean a lot of
>    things, but how would I even start tracking the leak down? Is there
>    a way I can try and track the number of file descriptors?
>
>
>  There's always strace, or looking in /proc/PID/fd.
>
>
>
>     I am using Twisted version 8.2.0 on Ubuntu Server Edition 9.10
>
>
>  Maybe try upgrading Twisted, preferably to 10.0.0?  I'm not sure if a
> bug related to your problems was fixed since 8.2.0, but a lot of bugs
> have been fixed in that ~2 years.  Hopefully there's a PPA somewhere
> with a newer Twisted for your version of Ubuntu.
>
> -Andrew.
>
>
> _______________________________________________
> Twisted-Python mailing listTwisted-Python at twistedmatrix.comhttp://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100319/af4777d3/attachment-0001.html>

From nullnull26 at gmail.com  Fri Mar 19 13:16:26 2010
From: nullnull26 at gmail.com (null null)
Date: Fri, 19 Mar 2010 20:16:26 +0100
Subject: [Twisted-Python] python-daemon PID file
Message-ID: <eeca458e1003191216t63933b8fm25179e2b0f4e7091@mail.gmail.com>

Hi all,

Im trying to get a daemon up and running but i cant get python-daemon to
create a PID file.
versions:
Python 2.5.2
python-daemon-1.5.5
Debian Linux 2.6.26-2-686

<code>
import daemon
import lockfile

daemon.DaemonContext(pidfile=lockfile.FileLock('/var/run/mydaemon.pid'),)

daemon.__enter__()
main()
daemon.__exit__()

</code>

The above doesnt create a pid file, ive tried different permissions for the
daemon and manualy making the pid file in the main() but no luck.

In summary: I cant get a PID file created or populated with a PID by
python-daemon.
Anyone see something that im doing wrong? ive been sitting on this way too
long. I looked at the python-daemon source and i cant see where the pid is
inserted into the pid file, only where it __enter__'s the lockfile so is
this functionality missing?

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100319/c6cb5e68/attachment.html>

From exarkun at twistedmatrix.com  Fri Mar 19 17:26:35 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 19 Mar 2010 23:26:35 -0000
Subject: [Twisted-Python] Twisted Sprint this Sunday
Message-ID: <20100319232635.2792.265340463.divmod.xquotient.1772@localhost.localdomain>

Hi all,

Flumotion is going to be hosting a sprint this Sunday (Mid-morning to 
evening, Spanish time).  I'll be introducing a lot of developers to the 
Twisted development process and trying to find them good first-time- 
contributor tickets to work on.  Even if you're not on the Iberian 
peninsula this weekend, you can still participate virtually. :)  If 
anyone wants to help out with reviews or suggest tickets that might be 
productive to work on, meet up with us in #twisted on Freenode.

Jean-Paul



From lasizoillo at gmail.com  Fri Mar 19 17:58:07 2010
From: lasizoillo at gmail.com (lasizoillo)
Date: Sat, 20 Mar 2010 00:58:07 +0100
Subject: [Twisted-Python] Twisted Sprint this Sunday
In-Reply-To: <20100319232635.2792.265340463.divmod.xquotient.1772@localhost.localdomain>
References: <20100319232635.2792.265340463.divmod.xquotient.1772@localhost.localdomain>
Message-ID: <49414f571003191658jf5e1f49ic0e49158ee46a558@mail.gmail.com>

2010/3/20  <exarkun at twistedmatrix.com>:
> Hi all,
>
> Flumotion is going to be hosting a sprint this Sunday (Mid-morning to
> evening, Spanish time). I'll be introducing a lot of developers to the
> Twisted development process and trying to find them good first-time-
> contributor tickets to work on. Even if you're not on the Iberian
> peninsula this weekend, you can still participate virtually. :) If
> anyone wants to help out with reviews or suggest tickets that might be
> productive to work on, meet up with us in #twisted on Freenode.
>
Nobody expects the Spanish sprints. Good news :-)



From exarkun at twistedmatrix.com  Sat Mar 20 22:05:26 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 21 Mar 2010 04:05:26 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1269144326.53.591501367@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100321/5ecb5254/attachment-0001.html>

From sara.byh at gmail.com  Sun Mar 21 02:24:14 2010
From: sara.byh at gmail.com (sara bai)
Date: Sun, 21 Mar 2010 01:24:14 -0700
Subject: [Twisted-Python] sara bai wants to chat
Message-ID: <1a16f0711003210124v76ed3ebcr@mail.gmail.com>

I've been using Google Talk and thought you might like to try it out.
We can use it to call each other for free over the internet. Here's an
invitation to download Google Talk. Give it a try!

-----------------------------------------------------------------------

sara bai wants to stay in better touch using some of Google's coolest new
products.

If you already have Gmail or Google Talk, visit:
http://mail.google.com/mail/b-9f11c59641-70c58d7828-5e0dfd9bfa94a78a
You'll need to click this link to be able to chat with sara bai.

To get Gmail - a free email account from Google with over 2,800 megabytes of
storage - and chat with sara bai, visit:
http://mail.google.com/mail/a-9f11c59641-70c58d7828-5e0dfd9bfa94a78a

Gmail offers:
- Instant messaging right inside Gmail
- Powerful spam protection
- Built-in search for finding your messages and a helpful way of organizing
  emails into "conversations"
- No pop-up ads or untargeted banners - just text ads and related information
  that are relevant to the content of your messages

All this, and its yours for free. But wait, there's more! By opening a Gmail
account, you also get access to Google Talk, Google's instant messaging
service:

http://www.google.com/talk/

Google Talk offers:
- Web-based chat that you can use anywhere, without a download
- A contact list that's synchronized with your Gmail account
- Free, high quality PC-to-PC voice calls when you download the Google Talk
  client

We're working hard to add new features and make improvements, so we might also
ask for your comments and suggestions periodically. We appreciate your help in
making our products even better!

Thanks,
The Google Team

To learn more about Gmail and Google Talk, visit:
http://mail.google.com/mail/help/about.html
http://www.google.com/talk/about.html

(If clicking the URLs in this message does not work, copy and paste them into
the address bar of your browser).



From glyph at twistedmatrix.com  Mon Mar 22 19:32:11 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 22 Mar 2010 21:32:11 -0400
Subject: [Twisted-Python] python-daemon PID file
In-Reply-To: <eeca458e1003191216t63933b8fm25179e2b0f4e7091@mail.gmail.com>
References: <eeca458e1003191216t63933b8fm25179e2b0f4e7091@mail.gmail.com>
Message-ID: <6B84FDE8-BCC7-4F02-A903-F2373C2C02BC@twistedmatrix.com>


On Mar 19, 2010, at 3:16 PM, null null wrote:

> Im trying to get a daemon up and running but i cant get python-daemon to create a PID file.
> versions:
> Python 2.5.2
> python-daemon-1.5.5
> Debian Linux 2.6.26-2-686

This is the mailing list for Twisted, which you do not appear to be using.  Twisted also does not use python-daemon, and has pretty much nothing to do with it.

For information on python-daemon, including an email address for its author, please see <http://pypi.python.org/pypi/python-daemon/>.

However, if you use the 'twistd' tool which is bundled with Twisted, it will create PID files for you, and you won't have this problem :).






From glyph at twistedmatrix.com  Mon Mar 22 20:39:08 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 22 Mar 2010 22:39:08 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
Message-ID: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>

Hello successful Twisted users,

Several times over the last month I've been contacted by Twisted supporters who are looking to make the case to others within their organizations that Twisted is a worthwhile thing to sponsor.  The most common question has been: "what are other people using this for?".  Inevitably they'll end up at <http://twistedmatrix.com/trac/wiki/SuccessStories> - if we're lucky, they'll also see <http://twistedmatrix.com/trac/wiki/ProjectsUsingTwisted>, but that's only a slight improvement.  These pages are pretty anemic and frankly don't present a good impression of what is really possible with Twisted.  I note that several prominent users aren't represented at all.  You know who you are!

If you're a happy Twisted user who has used Twisted to do something cool, *please* send in a blurb for the success stories page!  This could translate into more money and more development for Twisted, thus making it even more awesome.  This goes double if you're a sponsor: please let us know why you sponsored and how happy you were that you did :).

If you're looking to volunteer some time for Twisted, but don't have much time to volunteer, becoming to be the official curator of these pages would be a small commitment but it would be quite helpful.  As I said, presenting a good public face for Twisted's maturity and broad applicability can translate directly into increased resources, so in the long term it would have a big impact.

Finally, if you're _not_ happy, it's always great to get some constructive criticism.  Best would be in the form of well-specified bugs filed at <http://twistedmatrix.com/trac/newticket>, of course ;).

Thanks,

-glyph




From don at delphexonline.com  Tue Mar 23 01:03:58 2010
From: don at delphexonline.com (Don Schoeman)
Date: Tue, 23 Mar 2010 09:03:58 +0200
Subject: [Twisted-Python] Error: filedescriptor out of range in select
In-Reply-To: <faf2d7811003190935q6a4a5638k1347fd45e04863f2@mail.gmail.com>
References: <4BA36F7B.2080600@delphexonline.com>	<20100319125830.GA17997@steerpike.home.puzzling.org>	<4BA38FEF.20302@delphexonline.com>
	<faf2d7811003190935q6a4a5638k1347fd45e04863f2@mail.gmail.com>
Message-ID: <4BA867DE.40307@delphexonline.com>

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100323/eef583ab/attachment-0001.html>

From itamar at itamarst.org  Tue Mar 23 06:58:16 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 23 Mar 2010 08:58:16 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
Message-ID: <1269349096.27623.23.camel@pintsize>

On Mon, 2010-03-22 at 22:39 -0400, Glyph Lefkowitz wrote:

> If you're a happy Twisted user who has used Twisted to do something
> cool, *please* send in a blurb for the success stories page!  This
> could translate into more money and more development for Twisted, thus
> making it even more awesome.  This goes double if you're a sponsor:
> please let us know why you sponsored and how happy you were that you
> did :).

I'll see if I can write something up for ITA. 

We should also add all the projects from the launchpad tx (those that
have actual releases, anyway) to the ProjectsUsingTwisted page.

My "itamar" account appears to no longer be able to edit wiki pages -
could someone fix that? Thanks!




From alexandre at quessy.net  Tue Mar 23 07:15:36 2010
From: alexandre at quessy.net (Alexandre Quessy)
Date: Tue, 23 Mar 2010 09:15:36 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <1269349096.27623.23.camel@pintsize>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
	<1269349096.27623.23.camel@pintsize>
Message-ID: <72236ba91003230615k62683450s52b54fca70eae752@mail.gmail.com>

Hello,
I am in a hurry, but here are a few projects I am working on. They all
use Twisted. They are all intended to be used in audio-video artworks
and tools.

 * Toonloop : (toonloop.com) Software suite for performing with live
frame by frame animation creation
 * Lunch : (http://svn.sat.qc.ca/trac/lunch) Simple process launcher
for complex distributed setup
 * Scenic : (http://svn.sat.qc.ca/trac/scenic) Telepresence software
for wide bandwidth networks and oriented toward live performances
 * Purity : (http://wiki.dataflow.ws/Purity) Python library for Pure
Data dynamic patching to create audio patches.

Cheers,

a

2010/3/23 Itamar Turner-Trauring <itamar at itamarst.org>:
> On Mon, 2010-03-22 at 22:39 -0400, Glyph Lefkowitz wrote:
>
>> If you're a happy Twisted user who has used Twisted to do something
>> cool, *please* send in a blurb for the success stories page! This
>> could translate into more money and more development for Twisted, thus
>> making it even more awesome. This goes double if you're a sponsor:
>> please let us know why you sponsored and how happy you were that you
>> did :).
>
> I'll see if I can write something up for ITA.
>
> We should also add all the projects from the launchpad tx (those that
> have actual releases, anyway) to the ProjectsUsingTwisted page.
>
> My "itamar" account appears to no longer be able to edit wiki pages -
> could someone fix that? Thanks!
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Alexandre Quessy
http://alexandre.quessy.net/



From laiw at student.ethz.ch  Tue Mar 23 08:00:50 2010
From: laiw at student.ethz.ch (Willy Lai)
Date: Tue, 23 Mar 2010 15:00:50 +0100
Subject: [Twisted-Python] stdio.StandardIO blocks?
Message-ID: <4BA8C992.1070002@student.ethz.ch>

Hi all

I'm new to twisted and also have not a lot of Python experience.
My problem boils down to following situation:

I have a server and a client over TCP, once the client is connected to 
the server,
the server periodically pings the client in order to check if it is 
still alive.
The client sends a response/pong back to each ping.

These messages are printed to stdout. The two consoles would then look like:

[connected]
ping
pong
...2 seconds ...
ping
pong
...2 seconds ...
ping
pong
...

Now the user should be able to write commands in the command line, which 
get's
sent to the server, without interrupting the pings. But in my case, 
while writing on the console the output stops.
The server will send a ping, but the client does not seem to receive the 
ping, since I don't get a pong on the server.
What happens at the moment I type something in the command line?

What I want, is writing stuff in the console, without interrupting the 
ping mechanism.
(The pings and pongs in my case should continue to be sent while typing 
stuff in the console)

That's how I use StandardIO:

class CommandLine(protocol.Protocol):

     def __init__(self, protocol):
         self.protocol = protocol

     def dataReceived(self, data):
         print('INPUT: %s' % (data)

class Client(protocol.DatagramProtocol):

     def __init__(self):
         # initialize command line connector
         commandLine = CommandLine(self)
         # connect member to command line output
         self.output = stdio.StandardIO(commandLine)

Cheers



From dvkeeney at gmail.com  Tue Mar 23 10:48:41 2010
From: dvkeeney at gmail.com (David)
Date: Tue, 23 Mar 2010 10:48:41 -0600
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
Message-ID: <6e04113a1003230948j41fd0e5bn53ceda6970b36e43@mail.gmail.com>

On Mon, Mar 22, 2010 at 8:39 PM, Glyph Lefkowitz
<glyph at twistedmatrix.com> wrote:

> If you're a happy Twisted user who has used Twisted to do something cool, *please* send in a blurb for the success stories page! This could translate into more money and more development for Twisted, thus making it even more awesome. This goes double if you're a sponsor: please let us know why you sponsored and how happy you were that you did :).


Rdbhost

Rdbhost uses Twisted for a streaming web-server.  The streaming server
allows users to stream large SQL 'dump' files to and from the database
host using a web browser.

http://www.rdbhost.com

-- 
dkeeney at rdbhost.com
Rdbhost -> SQL databases as a webservice [www.rdbhost.com]



From raq at cttc.upc.edu  Tue Mar 23 12:30:36 2010
From: raq at cttc.upc.edu (Ramiro Alba Queipo)
Date: Tue, 23 Mar 2010 19:30:36 +0100
Subject: [Twisted-Python] Logout from a perspective broker server
Message-ID: <1269369036.6222.11.camel@mundo>

Hi all,

I wonder, if I client using pygtk, can logout from the server without
calling reactor.stop(), as you would kill the GUI. I tried to delete the
perspective got from the server but it does not work...

Thanks in advance
Regards

-- 
Ramiro Alba

Centre Tecnolgic de Tranferncia de Calor
http://www.cttc.upc.edu


Escola Tcnica Superior d'Enginyeries
Industrial i Aeronutica de Terrassa
Colom 11, E-08222, Terrassa, Barcelona, Spain
Tel: (+34) 93 739 86 46


-- 
Aquest missatge ha estat analitzat per MailScanner
a la cerca de virus i d'altres continguts perillosos,
i es considera que est net.




From glyph at twistedmatrix.com  Wed Mar 24 03:22:39 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Mar 2010 05:22:39 -0400
Subject: [Twisted-Python] stdio.StandardIO blocks?
In-Reply-To: <4BA8C992.1070002@student.ethz.ch>
References: <4BA8C992.1070002@student.ethz.ch>
Message-ID: <6EB44FA1-3F26-433F-A2B3-3FE4AC3A5BD0@twistedmatrix.com>


On Mar 23, 2010, at 10:00 AM, Willy Lai wrote:

> What I want, is writing stuff in the console, without interrupting the 
> ping mechanism.
> (The pings and pongs in my case should continue to be sent while typing 
> stuff in the console)

Without a *complete* program example, we can't really tell you what might be blocking. It may be a lot of things, from some very simple problems to some very complex ones.  Please see <http://sscce.org/> for details on what types of examples would be useful.

Based on your simple description, this really should work.  If it didn't, 'twistd' wouldn't be able to log to stdout and run a server at the same time (and it definitely can, I do that every day, at least ten times).

Thanks,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100324/65c72bbb/attachment-0001.html>

From glyph at twistedmatrix.com  Wed Mar 24 03:27:13 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Mar 2010 05:27:13 -0400
Subject: [Twisted-Python] Logout from a perspective broker server
In-Reply-To: <1269369036.6222.11.camel@mundo>
References: <1269369036.6222.11.camel@mundo>
Message-ID: <44DAEAB5-A177-4367-BBE0-98475F236004@twistedmatrix.com>


On Mar 23, 2010, at 2:30 PM, Ramiro Alba Queipo wrote:

> I wonder, if I client using pygtk, can logout from the server without
> calling reactor.stop(), as you would kill the GUI. I tried to delete the
> perspective got from the server but it does not work...

The simplest thing you can do to achieve this is 'broker.transport.loseConnection()'.

Of course, that just unceremoniously drops the connection.  You may want to have a 'remote_disconnect' method on the server too, if you have any state you would like to cleanly finish up with first.

Your GUI is already handling disconnection due to network problems though, right?  :-)  So the modification to make it handle this slightly-cleaner disconnect should be minor.  If it doesn't, see the notifyOnDisconnect API in PB: <http://twistedmatrix.com/documents/10.0.0/api/twisted.spread.pb.Broker.html#notifyOnDisconnect>.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100324/dac4c598/attachment.html>

From raq at cttc.upc.edu  Wed Mar 24 06:28:45 2010
From: raq at cttc.upc.edu (Ramiro Alba Queipo)
Date: Wed, 24 Mar 2010 13:28:45 +0100
Subject: [Twisted-Python] Logout from a perspective broker server
In-Reply-To: <44DAEAB5-A177-4367-BBE0-98475F236004@twistedmatrix.com>
References: <1269369036.6222.11.camel@mundo>
	<44DAEAB5-A177-4367-BBE0-98475F236004@twistedmatrix.com>
Message-ID: <1269433725.6222.20.camel@mundo>

Glyph,

> > I wonder, if I client using pygtk, can logout from the server
> > without
> > calling reactor.stop(), as you would kill the GUI. I tried to delete
> > the
> > perspective got from the server but it does not work...
> 
> The simplest thing you can do to achieve this is
> 'broker.transport.loseConnection()'.
> 
> 
> Of course, that just unceremoniously drops the connection.  You may
> want to have a 'remote_disconnect' method on the server too, if you
> have any state you would like to cleanly finish up with first.
> 
After having a look at pb.py code I used

factory = pb.PBClientFactory()
....

factory.disconnect()

Then this makes the server call a 'logout' method for the current
perspective, and makes a clean logout. Any comment?


> 
> Your GUI is already handling disconnection due to network problems
> though, right?  :-)  So the modification to make it handle this
> slightly-cleaner disconnect should be minor.  If it doesn't, see the
> notifyOnDisconnect API in PB:
> <http://twistedmatrix.com/documents/10.0.0/api/twisted.spread.pb.Broker.html#notifyOnDisconnect>.

Yeah. I was already using it. Very nice. I also wanted to enable a way
to conecct and disconnect from the client, apart from the client be
aware of a server restart on simply loosing connection. It works
cleanly.

Really grateful for your info and comments

Regards

> 
-- 
Ramiro Alba

Centre Tecnolgic de Tranferncia de Calor
http://www.cttc.upc.edu


Escola Tcnica Superior d'Enginyeries
Industrial i Aeronutica de Terrassa
Colom 11, E-08222, Terrassa, Barcelona, Spain
Tel: (+34) 93 739 86 46


-- 
Aquest missatge ha estat analitzat per MailScanner
a la cerca de virus i d'altres continguts perillosos,
i es considera que est net.




From albert.brandl at weiermayer.com  Wed Mar 24 06:39:17 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Wed, 24 Mar 2010 13:39:17 +0100
Subject: [Twisted-Python] NetstringReceiver
Message-ID: <20100324123917.GA24344@weiermayer.com>

Hi!

The NetstringReceiver class does not exactly do what I'd expect - see 
issue http://twistedmatrix.com/trac/ticket/4378. Since we plan to use 
netstrings, I am trying to fix it.

I am not quite sure how to handle certain problems, though, and that's 
where I'd appreciate help. If this is the wrong place to ask this kind of 
questions, please redirect me ;-).

1.) In the current implementation, a NetstringParseError results in a 
call to self.transport.loseConnection(). Furthermore the variable 
brokenPeer is set to 1. But this variable is ignored. Would it be better 
to check it before receiving data? If yes: what is the correct way for a 
protocol to handle a broken transport? There is a ConnectionLost 
exception, but I'm not sure if / when a Protocol is allowed to raise it.

2.) The current implementation uses the method dataReceived to assemble 
the content of the netstring. When it is complete, the method 
stringReceived (which raises a NotImplementedError by default) is called. 
But netstrings can be long - would it be better to create a Deferred 
instance and call its callback instead? What would be the right place to 
create this Deferred?

3.) I started testing the NetstringReceiver by creating a class comment 
with doctests. When I later grepped the sources, I found some doctests, 
but there no mention of the doctest module in the test policy document. 
Would it be better to use the unittest framework for testing the code?

Thanks and best regards,

--
Albert Brandl
Weiermayer Solutions GmbH
4813 Altmnster | Abteistrae 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081



From andrew at bemusement.org  Wed Mar 24 16:22:03 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Thu, 25 Mar 2010 09:22:03 +1100
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100324123917.GA24344@weiermayer.com>
References: <20100324123917.GA24344@weiermayer.com>
Message-ID: <20100324222203.GF17997@steerpike.home.puzzling.org>

Albert Brandl wrote:
> Hi!
> 
> The NetstringReceiver class does not exactly do what I'd expect - see 
> issue http://twistedmatrix.com/trac/ticket/4378. Since we plan to use 
> netstrings, I am trying to fix it.
> 
> I am not quite sure how to handle certain problems, though, and that's 
> where I'd appreciate help. If this is the wrong place to ask this kind of 
> questions, please redirect me ;-).
> 
> 1.) In the current implementation, a NetstringParseError results in a 
> call to self.transport.loseConnection(). Furthermore the variable 
> brokenPeer is set to 1. But this variable is ignored. Would it be better 
> to check it before receiving data? If yes: what is the correct way for a 
> protocol to handle a broken transport? There is a ConnectionLost 
> exception, but I'm not sure if / when a Protocol is allowed to raise it.

No; I think once loseConnection has been called dataReceived won't be
called again, so there's no point checking for brokenPeer in
dataReceived.

It might be worth checking in sendString, but I would expect that it
would already raise an appropriate exception because it will try to
write to a closed transport.

> 2.) The current implementation uses the method dataReceived to assemble 
> the content of the netstring. When it is complete, the method 
> stringReceived (which raises a NotImplementedError by default) is called. 
> But netstrings can be long - would it be better to create a Deferred 
> instance and call its callback instead? What would be the right place to 
> create this Deferred?

No.

I'm rather confused about why you're even asking this question.  Exactly
what API are you proposing as an alternative to the existing API (which
is subclass NetstringReceiver and override stringReceived, and
stringReceived will be called for every netstring that is received, as
soon as it is received)?

> 3.) I started testing the NetstringReceiver by creating a class comment 
> with doctests. When I later grepped the sources, I found some doctests, 
> but there no mention of the doctest module in the test policy document. 
> Would it be better to use the unittest framework for testing the code?

Yes please.

There are some existing tests for NetstringReceiver in
twisted/test/test_protocols.py.

-Andrew.




From glyph at twistedmatrix.com  Wed Mar 24 16:53:58 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Mar 2010 18:53:58 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <6e04113a1003230948j41fd0e5bn53ceda6970b36e43@mail.gmail.com>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
	<6e04113a1003230948j41fd0e5bn53ceda6970b36e43@mail.gmail.com>
Message-ID: <CB817FCF-4F65-46C2-9D40-16F6DE0385ED@twistedmatrix.com>


On Mar 23, 2010, at 12:48 PM, David wrote:

> Rdbhost
> 
> Rdbhost uses Twisted for a streaming web-server.  The streaming server
> allows users to stream large SQL 'dump' files to and from the database
> host using a web browser.
> 
> http://www.rdbhost.com

Thanks, David.  I've added that to ProjectsUsingTwisted.

For SuccessStories though, we like it to be a bit punchier, and have at least a small blurb about why Twisted was especially well-suited to the job or how it helped things get done quicker, or something impressive about the performance/scale of the application.  Plus, it's nice to have a name and an official title to put along with the recommendation.  Do you mind if we credit you as "David Keeney, Founder, RdbHost"?  If it's not too much trouble, would you mind having a look at the other stuff at <http://twistedmatrix.com/trac/wiki/SuccessStories> and use one of them as an example?

Thanks again,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100324/986fb0e1/attachment.html>

From glyph at twistedmatrix.com  Wed Mar 24 16:59:39 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Mar 2010 18:59:39 -0400
Subject: [Twisted-Python] Nothing Succeeds Like Success (Stories)
In-Reply-To: <72236ba91003230615k62683450s52b54fca70eae752@mail.gmail.com>
References: <17796A99-6D4D-4B29-8C39-3C3BEAB8F4D9@twistedmatrix.com>
	<1269349096.27623.23.camel@pintsize>
	<72236ba91003230615k62683450s52b54fca70eae752@mail.gmail.com>
Message-ID: <D6D52ED8-766B-40B3-9B6A-4809BA5B0790@twistedmatrix.com>


On Mar 23, 2010, at 9:15 AM, Alexandre Quessy wrote:

> Hello,
> I am in a hurry, but here are a few projects I am working on. They all
> use Twisted. They are all intended to be used in audio-video artworks
> and tools.
> 
> * Toonloop : (toonloop.com) Software suite for performing with live
> frame by frame animation creation
> * Lunch : (http://svn.sat.qc.ca/trac/lunch) Simple process launcher
> for complex distributed setup
> * Scenic : (http://svn.sat.qc.ca/trac/scenic) Telepresence software
> for wide bandwidth networks and oriented toward live performances
> * Purity : (http://wiki.dataflow.ws/Purity) Python library for Pure
> Data dynamic patching to create audio patches.

Thanks!  I've added these to ProjectsUsingTwisted.

If you are in less of a hurry later on and would like to talk about how great Twisted is in the context of one of your projects, it would be great to put a longer blurb on SuccessStories too :).

-glyph




From sara.byh at gmail.com  Wed Mar 24 19:53:17 2010
From: sara.byh at gmail.com (sara bai)
Date: Thu, 25 Mar 2010 09:53:17 +0800
Subject: [Twisted-Python] Twisted-Python Digest, Vol 72, Issue 35
In-Reply-To: <mailman.3.1269446401.3832.twisted-python@twistedmatrix.com>
References: <mailman.3.1269446401.3832.twisted-python@twistedmatrix.com>
Message-ID: <1a16f0711003241853i65d61033h4d6a4a00bfa38612@mail.gmail.com>

hi all, i run into this problem   


The debugged program raised the exception unhandled Error
"[('PEM routines', 'PEM_read_bio', 'no start line'), ('SSL routines',
'SSL_CTX_use_PrivateKey_file', 'PEM lib')]"
File:
/usr/lib/python2.5/site-packages/Twisted-10.0.0-py2.5-linux-i686.egg/twisted/internet/ssl.py,
Line: 99"


 (
usr/lib/python25/site-packages/Twisted-10.0.0-py2.5-linux-i686.egg/twisted/internet/ssl.py
line 99 )

    def cacheContext(self):
        if self._context is None:
            ctx = self._contextFactory(self.sslmethod)
            # Disallow SSLv2!  It's insecure!  SSLv3 has been around since
            # 1996.  It's time to move on.
            ctx.set_options(SSL.OP_NO_SSLv2)
            ctx.use_certificate_file(self.certificateFileName)
            ctx.use_privatekey_file(self.privateKeyFileName)    # Line: 99
            self._context = ctx

here is the way i create privkey file :
   $ openssl genrsa > privkey.pem

then
   $ openssl req -new -x509 -key privkey.pem -out cacert.pem -days 1000

i have checked the cacert.pem file it do has 'strt line ' BEGIN
CERTIFICATE


 part of my code  :


class syslogOptions(usage.Options):
    optParameters = [['cert', 'c', '/home/ssltest/cacert.pem','SSL Server
certificate'],
                            ['ip',   'i', None, 'IP Address to listen on']]
    def postOptions(self):
        if (not self.opts['cert']) or (not
os.path.isfile(self.opts['cert'])):
            raise usage.UsageError, "%s: is not a file" % self.opts['cert']
. . .
syslogSSL = syslogFactory()
    syslogSSL.protocol = outputTCP
    ctx = ssl.DefaultOpenSSLContextFactory(config.opts['cert'],
config.opts['cert'])
 .. .. .
 reactor.listenSSL(708, syslogSSL , ctx, interface=config.opts['ip'])
    reactor.run()

any ideas ? ...







2010/3/25 <twisted-python-request at twistedmatrix.com>

> Send Twisted-Python mailing list submissions to
>        twisted-python at twistedmatrix.com
>
> To subscribe or unsubscribe via the World Wide Web, visit
>        http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> or, via email, send a message with subject or body 'help' to
>        twisted-python-request at twistedmatrix.com
>
> You can reach the person managing the list at
>        twisted-python-owner at twistedmatrix.com
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Twisted-Python digest..."
>
>
> Today's Topics:
>
>   1. Re: Nothing Succeeds Like Success (Stories) (David)
>   2. Logout from a perspective broker server (Ramiro Alba Queipo)
>   3. Re: stdio.StandardIO blocks? (Glyph Lefkowitz)
>   4. Re: Logout from a perspective broker server (Glyph Lefkowitz)
>   5. Re: Logout from a perspective broker server (Ramiro Alba Queipo)
>   6. NetstringReceiver (Albert Brandl)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Tue, 23 Mar 2010 10:48:41 -0600
> From: David <dvkeeney at gmail.com>
> Subject: Re: [Twisted-Python] Nothing Succeeds Like Success (Stories)
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID:
>        <6e04113a1003230948j41fd0e5bn53ceda6970b36e43 at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> On Mon, Mar 22, 2010 at 8:39 PM, Glyph Lefkowitz
> <glyph at twistedmatrix.com> wrote:
>
> > If you're a happy Twisted user who has used Twisted to do something cool,
> *please* send in a blurb for the success stories page! ?This could translate
> into more money and more development for Twisted, thus making it even more
> awesome. ?This goes double if you're a sponsor: please let us know why you
> sponsored and how happy you were that you did :).
>
>
> Rdbhost
>
> Rdbhost uses Twisted for a streaming web-server.  The streaming server
> allows users to stream large SQL 'dump' files to and from the database
> host using a web browser.
>
> http://www.rdbhost.com
>
> --
> dkeeney at rdbhost.com
> Rdbhost -> SQL databases as a webservice [www.rdbhost.com]
>
>
>
> ------------------------------
>
> Message: 2
> Date: Tue, 23 Mar 2010 19:30:36 +0100
> From: Ramiro Alba Queipo <raq at cttc.upc.edu>
> Subject: [Twisted-Python] Logout from a perspective broker server
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID: <1269369036.6222.11.camel at mundo>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Hi all,
>
> I wonder, if I client using pygtk, can logout from the server without
> calling reactor.stop(), as you would kill the GUI. I tried to delete the
> perspective got from the server but it does not work...
>
> Thanks in advance
> Regards
>
> --
> Ramiro Alba
>
> Centre Tecnol?gic de Tranfer?ncia de Calor
> http://www.cttc.upc.edu
>
>
> Escola T?cnica Superior d'Enginyeries
> Industrial i Aeron?utica de Terrassa
> Colom 11, E-08222, Terrassa, Barcelona, Spain
> Tel: (+34) 93 739 86 46
>
>
> --
> Aquest missatge ha estat analitzat per MailScanner
> a la cerca de virus i d'altres continguts perillosos,
> i es considera que est? net.
>
>
>
>
> ------------------------------
>
> Message: 3
> Date: Wed, 24 Mar 2010 05:22:39 -0400
> From: Glyph Lefkowitz <glyph at twistedmatrix.com>
> Subject: Re: [Twisted-Python] stdio.StandardIO blocks?
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID: <6EB44FA1-3F26-433F-A2B3-3FE4AC3A5BD0 at twistedmatrix.com>
> Content-Type: text/plain; charset="us-ascii"
>
>
> On Mar 23, 2010, at 10:00 AM, Willy Lai wrote:
>
> > What I want, is writing stuff in the console, without interrupting the
> > ping mechanism.
> > (The pings and pongs in my case should continue to be sent while typing
> > stuff in the console)
>
> Without a *complete* program example, we can't really tell you what might
> be blocking. It may be a lot of things, from some very simple problems to
> some very complex ones.  Please see <http://sscce.org/> for details on
> what types of examples would be useful.
>
> Based on your simple description, this really should work.  If it didn't,
> 'twistd' wouldn't be able to log to stdout and run a server at the same time
> (and it definitely can, I do that every day, at least ten times).
>
> Thanks,
>
> -glyph
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://twistedmatrix.com/pipermail/twisted-python/attachments/20100324/65c72bbb/attachment.html
>
> ------------------------------
>
> Message: 4
> Date: Wed, 24 Mar 2010 05:27:13 -0400
> From: Glyph Lefkowitz <glyph at twistedmatrix.com>
> Subject: Re: [Twisted-Python] Logout from a perspective broker server
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID: <44DAEAB5-A177-4367-BBE0-98475F236004 at twistedmatrix.com>
> Content-Type: text/plain; charset="us-ascii"
>
>
> On Mar 23, 2010, at 2:30 PM, Ramiro Alba Queipo wrote:
>
> > I wonder, if I client using pygtk, can logout from the server without
> > calling reactor.stop(), as you would kill the GUI. I tried to delete the
> > perspective got from the server but it does not work...
>
> The simplest thing you can do to achieve this is
> 'broker.transport.loseConnection()'.
>
> Of course, that just unceremoniously drops the connection.  You may want to
> have a 'remote_disconnect' method on the server too, if you have any state
> you would like to cleanly finish up with first.
>
> Your GUI is already handling disconnection due to network problems though,
> right?  :-)  So the modification to make it handle this slightly-cleaner
> disconnect should be minor.  If it doesn't, see the notifyOnDisconnect API
> in PB: <
> http://twistedmatrix.com/documents/10.0.0/api/twisted.spread.pb.Broker.html#notifyOnDisconnect
> >.
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://twistedmatrix.com/pipermail/twisted-python/attachments/20100324/dac4c598/attachment-0001.htm
>
> ------------------------------
>
> Message: 5
> Date: Wed, 24 Mar 2010 13:28:45 +0100
> From: Ramiro Alba Queipo <raq at cttc.upc.edu>
> Subject: Re: [Twisted-Python] Logout from a perspective broker server
> To: Twisted general discussion <twisted-python at twistedmatrix.com>
> Message-ID: <1269433725.6222.20.camel at mundo>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Glyph,
>
> > > I wonder, if I client using pygtk, can logout from the server
> > > without
> > > calling reactor.stop(), as you would kill the GUI. I tried to delete
> > > the
> > > perspective got from the server but it does not work...
> >
> > The simplest thing you can do to achieve this is
> > 'broker.transport.loseConnection()'.
> >
> >
> > Of course, that just unceremoniously drops the connection.  You may
> > want to have a 'remote_disconnect' method on the server too, if you
> > have any state you would like to cleanly finish up with first.
> >
> After having a look at pb.py code I used
>
> factory = pb.PBClientFactory()
> ....
>
> factory.disconnect()
>
> Then this makes the server call a 'logout' method for the current
> perspective, and makes a clean logout. Any comment?
>
>
> >
> > Your GUI is already handling disconnection due to network problems
> > though, right?  :-)  So the modification to make it handle this
> > slightly-cleaner disconnect should be minor.  If it doesn't, see the
> > notifyOnDisconnect API in PB:
> > <
> http://twistedmatrix.com/documents/10.0.0/api/twisted.spread.pb.Broker.html#notifyOnDisconnect
> >.
>
> Yeah. I was already using it. Very nice. I also wanted to enable a way
> to conecct and disconnect from the client, apart from the client be
> aware of a server restart on simply loosing connection. It works
> cleanly.
>
> Really grateful for your info and comments
>
> Regards
>
> >
> --
> Ramiro Alba
>
> Centre Tecnol?gic de Tranfer?ncia de Calor
> http://www.cttc.upc.edu
>
>
> Escola T?cnica Superior d'Enginyeries
> Industrial i Aeron?utica de Terrassa
> Colom 11, E-08222, Terrassa, Barcelona, Spain
> Tel: (+34) 93 739 86 46
>
>
> --
> Aquest missatge ha estat analitzat per MailScanner
> a la cerca de virus i d'altres continguts perillosos,
> i es considera que est? net.
>
>
>
>
> ------------------------------
>
> Message: 6
> Date: Wed, 24 Mar 2010 13:39:17 +0100
> From: Albert Brandl <albert.brandl at weiermayer.com>
> Subject: [Twisted-Python] NetstringReceiver
> To: twisted-python at twistedmatrix.com
> Message-ID: <20100324123917.GA24344 at weiermayer.com>
> Content-Type: text/plain; charset=iso-8859-1
>
> Hi!
>
> The NetstringReceiver class does not exactly do what I'd expect - see
> issue http://twistedmatrix.com/trac/ticket/4378. Since we plan to use
> netstrings, I am trying to fix it.
>
> I am not quite sure how to handle certain problems, though, and that's
> where I'd appreciate help. If this is the wrong place to ask this kind of
> questions, please redirect me ;-).
>
> 1.) In the current implementation, a NetstringParseError results in a
> call to self.transport.loseConnection(). Furthermore the variable
> brokenPeer is set to 1. But this variable is ignored. Would it be better
> to check it before receiving data? If yes: what is the correct way for a
> protocol to handle a broken transport? There is a ConnectionLost
> exception, but I'm not sure if / when a Protocol is allowed to raise it.
>
> 2.) The current implementation uses the method dataReceived to assemble
> the content of the netstring. When it is complete, the method
> stringReceived (which raises a NotImplementedError by default) is called.
> But netstrings can be long - would it be better to create a Deferred
> instance and call its callback instead? What would be the right place to
> create this Deferred?
>
> 3.) I started testing the NetstringReceiver by creating a class comment
> with doctests. When I later grepped the sources, I found some doctests,
> but there no mention of the doctest module in the test policy document.
> Would it be better to use the unittest framework for testing the code?
>
> Thanks and best regards,
>
> --
> Albert Brandl
> Weiermayer Solutions GmbH
> 4813 Altm?nster | Abteistra?e 12 | Austria
> Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081
>
>
>
> ------------------------------
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> End of Twisted-Python Digest, Vol 72, Issue 35
> **********************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100325/e22fbf1e/attachment.html>

From albert.brandl at weiermayer.com  Thu Mar 25 02:36:45 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Thu, 25 Mar 2010 09:36:45 +0100
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100324222203.GF17997@steerpike.home.puzzling.org>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
Message-ID: <20100325083644.GA4165@weiermayer.com>

On Thu, Mar 25, 2010 at 09:22:03AM +1100, Andrew Bennetts wrote:
> I'm rather confused about why you're even asking this question.  Exactly
> what API are you proposing as an alternative to the existing API (which
> is subclass NetstringReceiver and override stringReceived, and
> stringReceived will be called for every netstring that is received, as
> soon as it is received)?

Never mind - I didn't understand the concept of deferreds ;-). When
I read the code for FileSender, I thought it might be cool to have
something similar for the NetstringReceiver. But in the case of 
FileSender, the delivery of a file is explicitly triggered by the 
client. 

My vague idea was to create a method beginNetstringReception that 
returns a Deferred. But since Deferred instances are not reusable,
I'd have to call this method each time I wanted to receive a netstring, 
and this is obviously nonsense.

Regards,

--
DI Albert Brandl

Weiermayer Solutions GmbH

4813 Altmnster | Abteistrae 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081



From exarkun at twistedmatrix.com  Thu Mar 25 02:47:19 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Thu, 25 Mar 2010 08:47:19 -0000
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100325083644.GA4165@weiermayer.com>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100325083644.GA4165@weiermayer.com>
Message-ID: <20100325084719.2792.1067689479.divmod.xquotient.1807@localhost.localdomain>

On 08:36 am, albert.brandl at weiermayer.com wrote:
>On Thu, Mar 25, 2010 at 09:22:03AM +1100, Andrew Bennetts wrote:
>>I'm rather confused about why you're even asking this question. 
>>Exactly
>>what API are you proposing as an alternative to the existing API 
>>(which
>>is subclass NetstringReceiver and override stringReceived, and
>>stringReceived will be called for every netstring that is received, as
>>soon as it is received)?
>
>Never mind - I didn't understand the concept of deferreds ;-). When
>I read the code for FileSender, I thought it might be cool to have
>something similar for the NetstringReceiver. But in the case of
>FileSender, the delivery of a file is explicitly triggered by the
>client.
>
>My vague idea was to create a method beginNetstringReception that
>returns a Deferred. But since Deferred instances are not reusable,
>I'd have to call this method each time I wanted to receive a netstring,
>and this is obviously nonsense.

You might want a producer/consumer-based API.
Jean-Paul



From mgwilliams at gmail.com  Thu Mar 25 23:16:50 2010
From: mgwilliams at gmail.com (Matthew Williams)
Date: Fri, 26 Mar 2010 00:16:50 -0500
Subject: [Twisted-Python] SQLAlchemy, Twisted, and sAsync
Message-ID: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>

I have recently started a project using Twisted with a MySQL backend.  
 From previous posts to this and other lists, it seems that ORMs and  
threads don't get along too well... and, as far as I can tell, there's  
no way to get away from threads if you don't want longish queries to  
block your entire application.

At this point, I am using SQLAlchemy's SQL builder functionality (but  
not ORM layer) and using sAsync to manage the threading. Does anyone  
have experience with this technique and, if so, with what results?

It took me quite some time to piece together everything I could find  
related to sAsync (which seems to be a dead but functional project),  
so I threw up a quick Trac page for it at http://sasync.org.

Thanks in advance for any feedback!

Matthew



From chris at simplistix.co.uk  Fri Mar 26 02:20:36 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 26 Mar 2010 08:20:36 +0000
Subject: [Twisted-Python] SQLAlchemy, Twisted, and sAsync
In-Reply-To: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
Message-ID: <4BAC6E54.9010909@simplistix.co.uk>

Matthew Williams wrote:
>  From previous posts to this and other lists, it seems that ORMs and  
> threads don't get along too well...

What makes you think that?

> and, as far as I can tell, there's  
> no way to get away from threads if you don't want longish queries to  
> block your entire application.

Right, SQLAlchemy doesn't play nicely with *non-threaded* environments, 
from my understanding, which may well be wrong ;-)

> It took me quite some time to piece together everything I could find  
> related to sAsync (which seems to be a dead but functional project),  
> so I threw up a quick Trac page for it at http://sasync.org.

Cool. What is it you're doing that needs to mix Twisted and SQLAlchemy?

cheers,

Chris

PS: I've CC'ed the SQLAlchemy list in as well as I think people there 
may want to add to this discussion...

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
            - http://www.simplistix.co.uk



From albert.brandl at weiermayer.com  Fri Mar 26 04:25:48 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Fri, 26 Mar 2010 11:25:48 +0100
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100324222203.GF17997@steerpike.home.puzzling.org>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
Message-ID: <20100326102548.GA8660@weiermayer.com>

On Thu, Mar 25, 2010 at 09:22:03AM +1100, Andrew Bennetts wrote:
> 
> No; I think once loseConnection has been called dataReceived won't be
> called again, so there's no point checking for brokenPeer in
> dataReceived.

There is a unittest that assumes that dataReceives still works after
sending in garbage:

   def test_illegal(self):
        """
        Assert that illegal strings cause the transport to be closed.
        """
        for s in self.illegalStrings:
            r = self.getProtocol()
            for c in s:
                r.dataReceived(c)
            self.assertTrue(r.transport.disconnecting)

self.illegalStrings is defined as

    illegalStrings = [
        '9999999999999999999999', 'abc', '4:abcde',
        '51:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaab,',]

In this implementation, the dataReceived method has to be functional
even after the NetstringReceiver has detected that the received
data are garbage. And there is no direct information that the
received string was no valid netstring - you have to check for
r.transport.disconnecting.

That's why I thought it might be a good idea to raise an appropriate 
exception if the receiver is no longer functional. I use a generator- 
based approach to parsing the netstring (for details see 
http://twistedmatrix.com/trac/attachment/ticket/4378/ticket_4378.patch), 
and the generator raises a StopIteration exception.

But I'd prefer to raise an exception that explains what happened at a 
higher level - that's why I asked if there was some predefined exception 
that would match this kind of problem.

> There are some existing tests for NetstringReceiver in
> twisted/test/test_protocols.py.

Thanks, this was very helpful.

Regards,
-- 
DI Albert Brandl

Weiermayer Solutions GmbH

4813 Altmnster | Abteistrae 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081



From exarkun at twistedmatrix.com  Fri Mar 26 06:08:02 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 26 Mar 2010 12:08:02 -0000
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100326102548.GA8660@weiermayer.com>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100326102548.GA8660@weiermayer.com>
Message-ID: <20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>

On 10:25 am, albert.brandl at weiermayer.com wrote:
>On Thu, Mar 25, 2010 at 09:22:03AM +1100, Andrew Bennetts wrote:
>>
>>No; I think once loseConnection has been called dataReceived won't be
>>called again, so there's no point checking for brokenPeer in
>>dataReceived.
>
>There is a unittest that assumes that dataReceives still works after
>sending in garbage:
>
>   def test_illegal(self):
>        """
>        Assert that illegal strings cause the transport to be closed.
>        """
>        for s in self.illegalStrings:
>            r = self.getProtocol()
>            for c in s:
>                r.dataReceived(c)
>            self.assertTrue(r.transport.disconnecting)
>
>self.illegalStrings is defined as
>
>    illegalStrings = [
>        '9999999999999999999999', 'abc', '4:abcde',
>        '51:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaab,',]
>
>In this implementation, the dataReceived method has to be functional
>even after the NetstringReceiver has detected that the received
>data are garbage.

I'm not sure about this.  Each iteration around this loop creates a new 
instance of NetstringReceiver; after the illegal string is delivered, 
the instance isn't used again.

So, are you sure this is testing what you think it's testing?

Jean-Paul



From mgwilliams at gmail.com  Fri Mar 26 06:09:49 2010
From: mgwilliams at gmail.com (Matthew Williams)
Date: Fri, 26 Mar 2010 07:09:49 -0500
Subject: [Twisted-Python] SQLAlchemy, Twisted, and sAsync
In-Reply-To: <4BAC6E54.9010909@simplistix.co.uk>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
	<4BAC6E54.9010909@simplistix.co.uk>
Message-ID: <52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>


On Mar 26, 2010, at 3:20 AM, Chris Withers wrote:

> Matthew Williams wrote:
>> From previous posts to this and other lists, it seems that ORMs  
>> and  threads don't get along too well...
>
> What makes you think that?

First of all, most of my impressions about ORMs come from SQLAlchemy.   
This quote from this list (http://twistedmatrix.com/pipermail/twisted-python/2009-March/019359.html 
) sums up what I have found as well:

"It's much trickier if you want to use the ORM, unless you are very
careful to fully eager load every thing in any possible database
operation if you have need of the information subsequently in your
twisted code. Otherwise you may block unexpectedly simply when
accessing your objects, and end up with database operations from the
main twisted thread."

So perhaps I should have said "SQL Alchemy's ORM and threads don't get  
along too well"... that's not to say it's impossible, you just have to  
be exceedingly careful how you use it.

>> and, as far as I can tell, there's  no way to get away from threads  
>> if you don't want longish queries to  block your entire application.
>
> Right, SQLAlchemy doesn't play nicely with *non-threaded*  
> environments, from my understanding, which may well be wrong ;-)
>
>> It took me quite some time to piece together everything I could  
>> find  related to sAsync (which seems to be a dead but functional  
>> project),  so I threw up a quick Trac page for it at http://sasync.org 
>> .
>
> Cool. What is it you're doing that needs to mix Twisted and  
> SQLAlchemy?

The project (an internal project) doesn't really *need* to mix them...  
I could just use mysqldb.

Matthew



From chris at simplistix.co.uk  Fri Mar 26 06:16:29 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 26 Mar 2010 12:16:29 +0000
Subject: [Twisted-Python] [sqlalchemy] Re: SQLAlchemy, Twisted,
	and sAsync
In-Reply-To: <52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
	<4BAC6E54.9010909@simplistix.co.uk>
	<52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>
Message-ID: <4BACA59D.7050501@simplistix.co.uk>

Matthew Williams wrote:
> 
> "It's much trickier if you want to use the ORM, unless you are very
> careful to fully eager load every thing in any possible database
> operation if you have need of the information subsequently in your
> twisted code. Otherwise you may block unexpectedly simply when
> accessing your objects, and end up with database operations from the
> main twisted thread."
> 
> So perhaps I should have said "SQL Alchemy's ORM and threads don't get 
> along too well"... that's not to say it's impossible, you just have to 
> be exceedingly careful how you use it.

I think you have the wrong end of the stick.
SQLAlchemy and threads play fine, SQLAlchemy and Twisted's asynchronous 
model, which refuses to use threads on principle, do not, for the 
reasons you describe.

>>> It took me quite some time to piece together everything I could find  
>>> related to sAsync (which seems to be a dead but functional project),  
>>> so I threw up a quick Trac page for it at http://sasync.org.
>>
>> Cool. What is it you're doing that needs to mix Twisted and SQLAlchemy?
> 
> The project (an internal project) doesn't really *need* to mix them... I 
> could just use mysqldb.

Heh, wrong end of the stick again; my question was why you needed to use 
Twisted ;-)

cheers,

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From mgwilliams at gmail.com  Fri Mar 26 07:12:01 2010
From: mgwilliams at gmail.com (Matthew Williams)
Date: Fri, 26 Mar 2010 08:12:01 -0500
Subject: [Twisted-Python] [sqlalchemy] Re: SQLAlchemy, Twisted,
	and sAsync
In-Reply-To: <8D20BBB55F590E42AADF592A815E861704D36D02@zuk35exm65.ds.mot.com>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
	<4BAC6E54.9010909@simplistix.co.uk>
	<52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>
	<8D20BBB55F590E42AADF592A815E861704D36D02@zuk35exm65.ds.mot.com>
Message-ID: <33306522-88A7-4E04-BB87-9F8839369665@gmail.com>

Thank you, Simon, for clarifying this and pointing out that part of  
the SQLAlchemy docs... somehow I missed that part :-).

On Mar 26, 2010, at 7:30 AM, King Simon-NFHD78 wrote:

> I think that point should be clarified, so that people don't later  
> come
> across this post and just accept it without understanding.
>
> I imagine that SQLALchemy is used in a lot of threaded applications.  
> For
> example, it is the recommended ORM in web frameworks such as Pylons  
> and
> TurboGears, which work fine in threaded environments. However,  
> typically
> in these libraries a web request is handled by a single thread, and  
> all
> the SQLAlchemy operations occur within the scope of that request. As
> long as you don't share a Session instance between the threads, you
> won't have any problems. SQLAlchemy provides a ScopedSession class  
> which
> helps in these situations, as you can call the constructor many  
> times on
> a single thread and always get the session instance back for that
> thread. Sessions themselves aren't thread-safe.
>
> When an instance is loaded from the database, it is linked to the
> session that loaded it. This means that when you have lazy-loading
> properties on that instance (such as related classes, or deferred  
> column
> properties), they will be automatically loaded when they are accessed,
> in the same session.
>
> This will cause a problem if you load an instance in thread A, hand  
> the
> object off to thread B, and then thread B accesses one of these
> lazy-loading properties. The load will occur in thread A's session,
> which might be in the middle of doing something else.
>
> The solution to this is either to eager-load all the attributes you
> think you are going to need before handing the instance off to another
> thread (difficult), or (probably better) to detach (expunge) the
> instance from thread A's session. Thread B should then merge the  
> object
> into its own session (using the load=False flag so that it doesn't
> needlessly requery the database).
>
> The Session docs at http://www.sqlalchemy.org/docs/session.html  
> explain
> the lifecycle of loaded instances.
>
> I haven't actually done any of this - I've only ever used SA from TG  
> and
> command-line scripts, but I think the principles are about right. I  
> hope
> that helps,
>
> Simon



From chris at simplistix.co.uk  Fri Mar 26 08:32:04 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Fri, 26 Mar 2010 14:32:04 +0000
Subject: [Twisted-Python] [sqlalchemy] Re: SQLAlchemy, Twisted,
	and sAsync
In-Reply-To: <8D20BBB55F590E42AADF592A815E861704D36D02@zuk35exm65.ds.mot.com>
References: <21F95955-AA0A-4D5B-A6D7-EB6E860E679C@gmail.com>
	<4BAC6E54.9010909@simplistix.co.uk>
	<52FAC15B-FA98-4917-9397-BC1A8CAA2A15@gmail.com>
	<8D20BBB55F590E42AADF592A815E861704D36D02@zuk35exm65.ds.mot.com>
Message-ID: <4BACC564.2030109@simplistix.co.uk>

King Simon-NFHD78 wrote:
> The solution to this is either to eager-load all the attributes you
> think you are going to need before handing the instance off to another
> thread (difficult), or (probably better) to detach (expunge) the
> instance from thread A's session.

Are there any recommended code examples around for doing this?

Once detatched, are these objects (I'm guessing for most people they'll 
be instances of declaratively mapped models) pickleable?

> Thread B should then merge the object
> into its own session (using the load=False flag so that it doesn't
> needlessly requery the database).

Good code examples of this around too?

cheers

Chris

-- 
Simplistix - Content Management, Batch Processing & Python Consulting
             - http://www.simplistix.co.uk



From vlad.shevchenko at gmail.com  Sat Mar 27 15:45:42 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Sat, 27 Mar 2010 23:45:42 +0200
Subject: [Twisted-Python] How to use AmpList?
Message-ID: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>

Hi,
can't find any reference of how to use AmpList. What should be passed to
callRemote? In command: arguments = Amp.List(...) or arguments = [('param',
AmpList(...))]? Responder params?

Please, advice some refs or examples.

-- 
WBR, Vlad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100327/1a841a00/attachment-0001.html>

From exarkun at twistedmatrix.com  Sat Mar 27 22:05:24 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 28 Mar 2010 04:05:24 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1269749124.12.445728512@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100328/bf7043cf/attachment.html>

From andrew at bemusement.org  Sun Mar 28 03:24:20 2010
From: andrew at bemusement.org (Andrew Bennetts)
Date: Sun, 28 Mar 2010 20:24:20 +1100
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100326102548.GA8660@weiermayer.com>
	<20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
Message-ID: <20100328092420.GD7715@steerpike.home.puzzling.org>

exarkun at twistedmatrix.com wrote:
> On 10:25 am, albert.brandl at weiermayer.com wrote:
[...]
> >There is a unittest that assumes that dataReceives still works after
> >sending in garbage:
> >
> >   def test_illegal(self):
> >        """
> >        Assert that illegal strings cause the transport to be closed.
> >        """
> >        for s in self.illegalStrings:
> >            r = self.getProtocol()
> >            for c in s:
> >                r.dataReceived(c)
> >            self.assertTrue(r.transport.disconnecting)
> >
> >self.illegalStrings is defined as
> >
> >    illegalStrings = [
> >        '9999999999999999999999', 'abc', '4:abcde',
> >        '51:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaab,',]
> >
> >In this implementation, the dataReceived method has to be functional
> >even after the NetstringReceiver has detected that the received
> >data are garbage.
> 
> I'm not sure about this.  Each iteration around this loop creates a new 
> instance of NetstringReceiver; after the illegal string is delivered, 
> the instance isn't used again.

That's true  but each illegal string is delivered one byte at a time.  So the
'abc' string will trigger a NetstringParseError on the first dataReceived('a'),
but then the test expects the subsequent dataReceived('b') and dataReceived('c')
to execute without raising.

-Andrew.




From vlad.shevchenko at gmail.com  Mon Mar 29 05:54:08 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Mon, 29 Mar 2010 14:54:08 +0300
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
Message-ID: <572f045e1003290454x73077a92i1b76351cca297362@mail.gmail.com>

No one use AmpList?

On Sat, Mar 27, 2010 at 11:45 PM, Vlad Shevchenko <vlad.shevchenko at gmail.com
> wrote:

> Hi,
> can't find any reference of how to use AmpList. What should be passed to
> callRemote? In command: arguments = Amp.List(...) or arguments = [('param',
> AmpList(...))]? Responder params?
>
> Please, advice some refs or examples.
>
> --
> WBR, Vlad
>
>


-- 
WBR, Vlad Shevchenko
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100329/5e10672c/attachment-0001.html>

From albert.brandl at weiermayer.com  Mon Mar 29 05:11:00 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Mon, 29 Mar 2010 13:11:00 +0200
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100326102548.GA8660@weiermayer.com>
	<20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
Message-ID: <20100329111100.GA4063@weiermayer.com>

On Fri, Mar 26, 2010 at 12:08:02PM -0000, exarkun at twistedmatrix.com wrote:
> 
> So, are you sure this is testing what you think it's testing?

Yes. This test was already there, and it failed in unexpected ways, so I 
had to look at it quite closely. I'm not too happy about it, since it 
tests several things at once (illegal strings, bytewise delivery), but I 
decided to leave it there for now, just to make sure that I don't miss
some test case with the new unit tests.

As Andrew pointed out, this unittest assumes that dataReceived is still
(somewhat) functional after the detection of an invalid netstring. This
does not make much sense IMO, and it complicates the code. I'd prefer
to raise an exception and adapt the unittest accordingly. 

But I still don't know which exception would be best. There is a 
ConnectionLost exception, which is raised in 
twisted.protocols.amp.BinaryBoxProtocol when the transport is None. 
Other options are ConnectionClosed and ConnectionDone (both are not
raised directly anywhere), or a new one. Maybe ConnectionLost is the
most appropriate one.

Best regards,

Albert

-- 
DI Albert Brandl
Weiermayer Solutions GmbH | http://www.weiermayer.com
4813 Altmnster | Abteistrae 12 | Austria 
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081



From peter.westlake at pobox.com  Mon Mar 29 07:51:33 2010
From: peter.westlake at pobox.com (Peter Westlake)
Date: Mon, 29 Mar 2010 14:51:33 +0100
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <572f045e1003290454x73077a92i1b76351cca297362@mail.gmail.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
	<572f045e1003290454x73077a92i1b76351cca297362@mail.gmail.com>
Message-ID: <1269870693.17631.1367260645@webmail.messagingengine.com>



On Mon, 29 Mar 2010 14:54 +0300, "Vlad Shevchenko"
<vlad.shevchenko at gmail.com> wrote:
> No one use AmpList?
> 
> On Sat, Mar 27, 2010 at 11:45 PM, Vlad Shevchenko
> <vlad.shevchenko at gmail.com
> > wrote:
> 
> > Hi,
> > can't find any reference of how to use AmpList. What should be passed to
> > callRemote? In command: arguments = Amp.List(...) or arguments = [('param',
> > AmpList(...))]? Responder params?
> >
> > Please, advice some refs or examples.

Here's an example. I've missed out the other arguments for clarity. The
data being passed is a Unix-style environment string. It needs to be
reformatted to make it suitable for passing in an AmpList, but that's
just an implementation detail. It's because the AmpList requires the
dictionary keys to be declared in advance, but I want to be able to pass
environment variables whose names are only known at run-time. Your code
might not need to do any of that.

First, the command:

  class RunCmd(amp.Command):
      arguments = [...,
                   ('env',  amp.AmpList([('var', amp.String()), ('val',
                   amp.String())])),
                   ...]


Then the call:

          # env is something like {'PATH': '/bin:/usr/bin', 'HOME':
          '/home/peter'}
          # It needs to be converted into a form suitable for AmpList,
          like this:
          # [{'var': 'PATH', 'val': '/bin:/usr/bin'}, {'var': 'HOME',
          'val': '/home/peter'}]
          #
          amp_env  = [{'var': var, 'val': val} for (var, val) in
          env.items()]
          d = self.protocol.callRemote(commands.RunCmd, ...,
          env=amp_env, ...)


Then the responder:

    def runcmd(..., env, ..):
        """Implementation of the AMP command RunCmd.
        ...
        """

        # The "env" argument represents the environment of a process.
        # Convert it from the AmpList format back to a Python
        dictionary.
        #
        envd = {}
        for var in env:
            envd[var['var']] = var['val']
        ...
        return {...}
    
    commands.RunCmd.responder(runcmd)


Peter.



From dripton at ripton.net  Mon Mar 29 07:52:54 2010
From: dripton at ripton.net (David Ripton)
Date: Mon, 29 Mar 2010 06:52:54 -0700
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
Message-ID: <20100329135254.GA21870@vidar.dreamhost.com>

On 2010.03.27 23:45:42 +0200, Vlad Shevchenko wrote:
> Hi,
> can't find any reference of how to use AmpList. What should be passed to
> callRemote? In command: arguments = Amp.List(...) or arguments = [('param',
> AmpList(...))]? Responder params?
> 
> Please, advice some refs or examples.

There are a few small examples in twisted/test/test_amp.py

test_ampListCommand might be a good starting point.

-- 
David Ripton    dripton at ripton.net



From joson.prog at gmail.com  Mon Mar 29 09:04:25 2010
From: joson.prog at gmail.com (Joson Mandaro)
Date: Mon, 29 Mar 2010 23:04:25 +0800
Subject: [Twisted-Python] [twisted-python] a problem about reactor
Message-ID: <6dcfd2ac1003290804w6eaeb1b1te5e1904b1b831cdd@mail.gmail.com>

Hi all,

I'm puzzled by this code:

# -*- coding: utf-8 -*-
from twisted.web.client import reactor

f = open("test1.txt","w")
f.write("html")
reactor.run()

Then it won't write anything into test1.txt. When I deleted "reactor.run()",
it will write contents. It is interesting but I don't know why the reactor
blocks file writing.

Best regards,

Joson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100329/eff238e1/attachment.html>

From exarkun at twistedmatrix.com  Mon Mar 29 09:04:33 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Mon, 29 Mar 2010 15:04:33 -0000
Subject: [Twisted-Python] NetstringReceiver
In-Reply-To: <20100329111100.GA4063@weiermayer.com>
References: <20100324123917.GA24344@weiermayer.com>
	<20100324222203.GF17997@steerpike.home.puzzling.org>
	<20100326102548.GA8660@weiermayer.com>
	<20100326120802.2792.1493718189.divmod.xquotient.1827@localhost.localdomain>
	<20100329111100.GA4063@weiermayer.com>
Message-ID: <20100329150433.2792.1487122440.divmod.xquotient.1864@localhost.localdomain>

On 11:11 am, albert.brandl at weiermayer.com wrote:
>On Fri, Mar 26, 2010 at 12:08:02PM -0000, exarkun at twistedmatrix.com 
>wrote:
>>
>>So, are you sure this is testing what you think it's testing?
>
>Yes. This test was already there, and it failed in unexpected ways, so 
>I
>had to look at it quite closely. I'm not too happy about it, since it
>tests several things at once (illegal strings, bytewise delivery), but 
>I
>decided to leave it there for now, just to make sure that I don't miss
>some test case with the new unit tests.
>
>As Andrew pointed out, this unittest assumes that dataReceived is still
>(somewhat) functional after the detection of an invalid netstring. This
>does not make much sense IMO, and it complicates the code. I'd prefer
>to raise an exception and adapt the unittest accordingly.

I see.  A good first step (separate from fixing any of the 
implementation of NetstringReceiver) might be to clean up the tests, 
then, so that each only exercises one case, and so that only the desired 
behavior is tested (for example, tests for the behavior you're talking 
about, of receiving invalid bytes after the connection has been closed, 
could be removed).
>But I still don't know which exception would be best. There is a
>ConnectionLost exception, which is raised in
>twisted.protocols.amp.BinaryBoxProtocol when the transport is None.
>Other options are ConnectionClosed and ConnectionDone (both are not
>raised directly anywhere), or a new one. Maybe ConnectionLost is the
>most appropriate one.

Feel free to introduce new exception types.  Unfortunately I don't 
remember what change you're actually proposing to make to 
NetstringReceiver anymore, so I won't try to suggest any names.

Jean-Paul



From albert.brandl at weiermayer.com  Mon Mar 29 08:22:02 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Mon, 29 Mar 2010 16:22:02 +0200
Subject: [Twisted-Python] [twisted-python] a problem about reactor
In-Reply-To: <6dcfd2ac1003290804w6eaeb1b1te5e1904b1b831cdd@mail.gmail.com>
References: <6dcfd2ac1003290804w6eaeb1b1te5e1904b1b831cdd@mail.gmail.com>
Message-ID: <20100329142202.GB4063@weiermayer.com>

Hi!

On Mon, Mar 29, 2010 at 11:04:25PM +0800, Joson Mandaro wrote:
>    Then it won't write anything into test1.txt. When I deleted
>    "reactor.run()", it will write contents. It is interesting but I don't
>    know why the reactor blocks file writing.

Try the same code in the interpreter and check the content of the
file:

>>> f=open("test.txt", "w") # creates an empty file
>>> f.write("html")         # file is still empty
>>> f.close()               # content is written to the file

Python is nice enough to close the file when it reaches the end of the
script. But this never happens when the last statement is 
reactor.run().

Regards, 

Albert

--
DI Albert Brandl
Weiermayer Solutions GmbH | http://www.weiermayer.com
4813 Altmnster | Abteistrae 12 | Austria 
| Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081



From bs1984 at gmail.com  Mon Mar 29 09:32:49 2010
From: bs1984 at gmail.com (Bo Shi)
Date: Mon, 29 Mar 2010 11:32:49 -0400
Subject: [Twisted-Python] [twisted-python] a problem about reactor
Message-ID: <-7380736282751865086@unknownmsgid>

Joson, this doesn't have anything to do with the reactor (aside from
perhaps it forcing you to ctrl-c to stop the program).  You never 1.
close() the file or 2. flush() the contents of the file to disk.

Sent from my mobile phone.
Please excuse any typos.

On Mar 29, 2010, at 11:04, Joson Mandaro <joson.prog at gmail.com> wrote:

> Hi all,
>
> I'm puzzled by this code:
>
> # -*- coding: utf-8 -*-
> from twisted.web.client import reactor
>
> f = open("test1.txt","w")
> f.write("html")
> reactor.run()
>
> Then it won't write anything into test1.txt. When I deleted
> "reactor.run()", it will write contents. It is interesting but I
> don't know why the reactor blocks file writing.
>
> Best regards,
>
> Joson
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From albert.brandl at weiermayer.com  Mon Mar 29 08:52:40 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Mon, 29 Mar 2010 16:52:40 +0200
Subject: [Twisted-Python] Supported Python versions for Twisted 10.0
Message-ID: <20100329145240.GA10947@weiermayer.com>

Hi!

By chance, I recently found the following comment by Glyph on Stack Overflow (dated Oct 
18 '08):

> Right now, Twisted supports python 2.3 to 2.5. Currently, we're working on 2.6 support 
> (which we'll obviously have to finish before 3.0!).

What are the supported Python versions for the Twisted 10 development? I think it might 
be a good idea to document these prerequisites in the developer section of the Wiki (or 
make them more prominent, if they are already there)?

I know, I should have made sure _before_ submitting a patch that _sends_ data to a 
generator... ;-).

Regards,

Albert
-- 
DI Albert Brandl
Weiermayer Solutions GmbH | http://www.weiermayer.com
4813 Altmnster | Abteistrae 12 | Austria |
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081



From jml at mumak.net  Mon Mar 29 10:05:37 2010
From: jml at mumak.net (Jonathan Lange)
Date: Mon, 29 Mar 2010 17:05:37 +0100
Subject: [Twisted-Python] Supported Python versions for Twisted 10.0
In-Reply-To: <20100329145240.GA10947@weiermayer.com>
References: <20100329145240.GA10947@weiermayer.com>
Message-ID: <d06a5cd31003290905i1e16cbd3rd0cbf4ebe16a7039@mail.gmail.com>

On Mon, Mar 29, 2010 at 3:52 PM, Albert Brandl
<albert.brandl at weiermayer.com> wrote:
> Hi!
>
> By chance, I recently found the following comment by Glyph on Stack Overflow (dated Oct
> 18 '08):
>
>> Right now, Twisted supports python 2.3 to 2.5. Currently, we're working on 2.6 support
>> (which we'll obviously have to finish before 3.0!).
>
> What are the supported Python versions for the Twisted 10 development? I think it might
> be a good idea to document these prerequisites in the developer section of the Wiki (or
> make them more prominent, if they are already there)?
>
> I know, I should have made sure _before_ submitting a patch that _sends_ data to a
> generator... ;-).
>

Twisted 10.0.0 supports Python 2.4 to 2.6. It's in the README and the
INSTALL file.

jml



From vlad.shevchenko at gmail.com  Mon Mar 29 11:42:04 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Mon, 29 Mar 2010 20:42:04 +0300
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <1269870693.17631.1367260645@webmail.messagingengine.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
	<572f045e1003290454x73077a92i1b76351cca297362@mail.gmail.com>
	<1269870693.17631.1367260645@webmail.messagingengine.com>
Message-ID: <572f045e1003291042p7bc6d650k653d8c82795fb68b@mail.gmail.com>

Thank you, it helps a lot. I've made a mistake in calling callRemote.

On Mon, Mar 29, 2010 at 4:51 PM, Peter Westlake <peter.westlake at pobox.com>wrote:

>
>
> On Mon, 29 Mar 2010 14:54 +0300, "Vlad Shevchenko"
> <vlad.shevchenko at gmail.com> wrote:
> > No one use AmpList?
> >
> > On Sat, Mar 27, 2010 at 11:45 PM, Vlad Shevchenko
> > <vlad.shevchenko at gmail.com
> > > wrote:
> >
> > > Hi,
> > > can't find any reference of how to use AmpList. What should be passed
> to
> > > callRemote? In command: arguments = Amp.List(...) or arguments =
> [('param',
> > > AmpList(...))]? Responder params?
> > >
> > > Please, advice some refs or examples.
>
> Here's an example. I've missed out the other arguments for clarity. The
> data being passed is a Unix-style environment string. It needs to be
> reformatted to make it suitable for passing in an AmpList, but that's
> just an implementation detail. It's because the AmpList requires the
> dictionary keys to be declared in advance, but I want to be able to pass
> environment variables whose names are only known at run-time. Your code
> might not need to do any of that.
>
> First, the command:
>
>  class RunCmd(amp.Command):
>      arguments = [...,
>                   ('env',  amp.AmpList([('var', amp.String()), ('val',
>                   amp.String())])),
>                   ...]
>
>
> Then the call:
>
>          # env is something like {'PATH': '/bin:/usr/bin', 'HOME':
>          '/home/peter'}
>          # It needs to be converted into a form suitable for AmpList,
>          like this:
>          # [{'var': 'PATH', 'val': '/bin:/usr/bin'}, {'var': 'HOME',
>          'val': '/home/peter'}]
>          #
>          amp_env  = [{'var': var, 'val': val} for (var, val) in
>          env.items()]
>          d = self.protocol.callRemote(commands.RunCmd, ...,
>          env=amp_env, ...)
>
>
> Then the responder:
>
>    def runcmd(..., env, ..):
>        """Implementation of the AMP command RunCmd.
>        ...
>        """
>
>        # The "env" argument represents the environment of a process.
>        # Convert it from the AmpList format back to a Python
>        dictionary.
>        #
>        envd = {}
>        for var in env:
>            envd[var['var']] = var['val']
>        ...
>        return {...}
>
>    commands.RunCmd.responder(runcmd)
>
>
> Peter.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
WBR, Vlad Shevchenko
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100329/24ebb9ea/attachment-0001.html>

From vlad.shevchenko at gmail.com  Mon Mar 29 11:46:10 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Mon, 29 Mar 2010 20:46:10 +0300
Subject: [Twisted-Python] How to use AmpList?
In-Reply-To: <20100329135254.GA21870@vidar.dreamhost.com>
References: <572f045e1003271445q7691ef81g3ffdc477ee0d8277@mail.gmail.com>
	<20100329135254.GA21870@vidar.dreamhost.com>
Message-ID: <572f045e1003291046r61cee69cwdbd32ea0af3b8efe@mail.gmail.com>

Thanks, nice point to dive in.

On Mon, Mar 29, 2010 at 4:52 PM, David Ripton <dripton at ripton.net> wrote:

> On 2010.03.27 23:45:42 +0200, Vlad Shevchenko wrote:
> > Hi,
> > can't find any reference of how to use AmpList. What should be passed to
> > callRemote? In command: arguments = Amp.List(...) or arguments =
> [('param',
> > AmpList(...))]? Responder params?
> >
> > Please, advice some refs or examples.
>
> There are a few small examples in twisted/test/test_amp.py
>
> test_ampListCommand might be a good starting point.
>
> --
> David Ripton    dripton at ripton.net
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
WBR, Vlad Shevchenko
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100329/6eb609b2/attachment.html>

From joson.prog at gmail.com  Mon Mar 29 19:35:28 2010
From: joson.prog at gmail.com (Joson Mandaro)
Date: Tue, 30 Mar 2010 09:35:28 +0800
Subject: [Twisted-Python] [twisted-python] a problem about reactor
In-Reply-To: <-7380736282751865086@unknownmsgid>
References: <-7380736282751865086@unknownmsgid>
Message-ID: <6dcfd2ac1003291835s3ae76566nbc9ee8abd5c1105@mail.gmail.com>

Thank you. So it is the point that I've disregarded before.

2010/3/29 Bo Shi <bs1984 at gmail.com>

> Joson, this doesn't have anything to do with the reactor (aside from
> perhaps it forcing you to ctrl-c to stop the program).  You never 1.
> close() the file or 2. flush() the contents of the file to disk.
>
> Sent from my mobile phone.
> Please excuse any typos.
>
> On Mar 29, 2010, at 11:04, Joson Mandaro <joson.prog at gmail.com> wrote:
>
> > Hi all,
> >
> > I'm puzzled by this code:
> >
> > # -*- coding: utf-8 -*-
> > from twisted.web.client import reactor
> >
> > f = open("test1.txt","w")
> > f.write("html")
> > reactor.run()
> >
> > Then it won't write anything into test1.txt. When I deleted
> > "reactor.run()", it will write contents. It is interesting but I
> > don't know why the reactor blocks file writing.
> >
> > Best regards,
> >
> > Joson
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100330/c6d6568b/attachment.html>

From chris at simplistix.co.uk  Tue Mar 30 01:46:29 2010
From: chris at simplistix.co.uk (Chris Withers)
Date: Tue, 30 Mar 2010 08:46:29 +0100
Subject: [Twisted-Python] twisted vs wsgi
Message-ID: <4BB1AC55.6090106@simplistix.co.uk>

Hi All,

I've managed to cobble this together as a way of starting a BFG app 
under Twisted's wsgi server:

"""
from twisted.web.wsgi import WSGIResource
from twisted.web.server import Site
from twisted.internet import reactor

from webob import Response
from repoze.bfg.configuration import Configurator

def hello_world(request):
     return Response('Hello world!')

if __name__ == '__main__':
     config = Configurator()
     config.begin()
     config.add_view(hello_world)
     config.end()

     resource = WSGIResource(reactor, reactor.getThreadPool(),
                             config.make_wsgi_app())
     factory = Site(resource, 'server.log')
     reactor.listenTCP(8080, factory)
     reactor.run()
"""

I struggled to find good narrative docs on using Twisted as a WSGI 
server. Where should I have been looking and have I dropped any clangers 
in the above?

cheers,

Chris




From itamar at itamarst.org  Tue Mar 30 06:11:15 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 30 Mar 2010 08:11:15 -0400
Subject: [Twisted-Python] twisted vs wsgi
In-Reply-To: <4BB1AC55.6090106@simplistix.co.uk>
References: <4BB1AC55.6090106@simplistix.co.uk>
Message-ID: <1269951075.987.100.camel@pintsize>

On Tue, 2010-03-30 at 08:46 +0100, Chris Withers wrote:
> I struggled to find good narrative docs on using Twisted as a WSGI 
> server. Where should I have been looking and have I dropped any clangers 
> in the above?

The "Web in 60 seconds" howto has this:
http://twistedmatrix.com/documents/current/web/howto/web-in-60/wsgi.html

Which, while incomplete in itself, makes sense if you read the whole
howto in order and so know what to do about Resources.


The "Using Twisted.Web" howto has this:
http://twistedmatrix.com/documents/current/web/howto/using-twistedweb.html#auto19





From albert.brandl at weiermayer.com  Tue Mar 30 10:14:18 2010
From: albert.brandl at weiermayer.com (Albert Brandl)
Date: Tue, 30 Mar 2010 18:14:18 +0200
Subject: [Twisted-Python] [Twisted] #4378: Error handling in
	NetstringReceiver broken
In-Reply-To: <057.e6e75afbc77c07499193b1e6757489f1@twistedmatrix.com>
References: <048.8ba8c943d125356d1cae7b68d90508c4@twistedmatrix.com>
	<057.e6e75afbc77c07499193b1e6757489f1@twistedmatrix.com>
Message-ID: <20100330161418.GA9201@weiermayer.com>

On Tue, Mar 30, 2010 at 12:27:54PM -0000, Twisted wrote:
>  1. I'm pretty sure this patch, in its current form, will break in the
>  (still supported) Python 2.4, since it uses the 2.5 generator feature
>  where you pass in data.

Yep - I'll fix this.

>  2. Why not initialize the parser in the Protocol's __init__? Less code in
>  a frequently called path.

Good idea, since there's no need anymore to check in every call of dataReceived.

>  3. ``stringReceived`` in docstring violates coding standard, should be a
>  L{} or C{} or something, I forget which. So does received_string variable
>  name.

Oops - this looks like ReST markup :-(.

>  4. In dataReceived, when would we expect to get StopIteration to be
>  raised? Quick read of the generator doesn't show anywhere it actually
>  returns, it seems to be in infinite loop.

When the generator is left by raising an exception, it will raise a StopIteration
the next time someone sends data. But this is irrelevant now, since Python 2.4
does not support sending data to a generator.

>  5. Using long() is unnecessary, you can just use int().

Ok.

>  6. Hooray for more and better tests! I am uncomfortable about use of
>  transport.disconnecting, but we've already gone down the path of using it
>  elsewhere, and not sure what else you could do, so it's probably fine.

I might introduce a new exception (see discussion on the mailing list) - this
would allow to get rid of the check for transport.disconnecting.

>  7. In test_receiveTwoNetstrings(self), perhaps the second string should be
>  different than the first, e.g. "a" and "woo", to catch theoretical bugs
>  where parser repeatedly spits out first thing it parsed.

Good idea.

Thanks & best regards,

Albert
-- 
DI Albert Brandl
Weiermayer Solutions GmbH | http://www.weiermayer.com
4813 Altmnster | Abteistrae 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081



From rgacote at appropriatesolutions.com  Tue Mar 30 13:22:47 2010
From: rgacote at appropriatesolutions.com (Ray Cote)
Date: Tue, 30 Mar 2010 15:22:47 -0400 (EDT)
Subject: [Twisted-Python] Anyone working on a Twisted txRiak?
Message-ID: <10496611.511269977368521.JavaMail.rgacote@ip-210.Corp.AppropriateSolutions.com>

Curious to know if anyone is working on an interface between Twisted and Riak.
  <http://basho.com/Riak.html>

Before we started one, thought I'd reach out first to ensure we're not duplicating efforts.
--Ray





From elihusmails at gmail.com  Tue Mar 30 14:47:02 2010
From: elihusmails at gmail.com (Mark)
Date: Tue, 30 Mar 2010 16:47:02 -0400
Subject: [Twisted-Python] session management
Message-ID: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>

Greetings,

I am new to this list and twisted.  I have worked with some systems
similar to twisted, notably Apache MINA.  I am trying to find out how
to set up my server to support sessions for multiple clients.  Right
now I am simply developing a telnet-like application to learn twisted
but cannot figure out how to manage sessions for the remote clients.

Thanks,
Mark



From itamar at itamarst.org  Tue Mar 30 16:42:09 2010
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 30 Mar 2010 18:42:09 -0400 (EDT)
Subject: [Twisted-Python] session management
In-Reply-To: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
References: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
Message-ID: <31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>

> Greetings,
>
> I am new to this list and twisted.  I have worked with some systems
> similar to twisted, notably Apache MINA.  I am trying to find out how
> to set up my server to support sessions for multiple clients.  Right
> now I am simply developing a telnet-like application to learn twisted
> but cannot figure out how to manage sessions for the remote clients.

Each Protocol instance stays alive for the lifetime of the connection it
is matched to (via the transport). So just store attributes on the
Protocol instance.




From glyph at twistedmatrix.com  Tue Mar 30 22:01:24 2010
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 31 Mar 2010 00:01:24 -0400
Subject: [Twisted-Python] Anyone working on a Twisted txRiak?
In-Reply-To: <10496611.511269977368521.JavaMail.rgacote@ip-210.Corp.AppropriateSolutions.com>
References: <10496611.511269977368521.JavaMail.rgacote@ip-210.Corp.AppropriateSolutions.com>
Message-ID: <35B630BD-56A4-4F3B-8966-76720EBF46E9@twistedmatrix.com>


On Mar 30, 2010, at 3:22 PM, Ray Cote wrote:

> Curious to know if anyone is working on an interface between Twisted and Riak.
>  <http://basho.com/Riak.html>
> 
> Before we started one, thought I'd reach out first to ensure we're not duplicating efforts.
> --Ray

I can't say for sure, but given that archives of this mailing list post are already showing up as the top hit for "txriak" and "twisted riak" for me, I think you're pretty safe on getting started with it :).

Be sure to mention when you have a release so we can add it to <http://twistedmatrix.com/trac/wiki/ProjectsUsingTwisted>.




From elihusmails at gmail.com  Tue Mar 30 22:10:42 2010
From: elihusmails at gmail.com (Mark)
Date: Wed, 31 Mar 2010 00:10:42 -0400
Subject: [Twisted-Python] session management
In-Reply-To: <31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>
References: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
	<31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>
Message-ID: <9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>

I figured as much that twisted supported the notion of sessions.  Are
there any examples that show me how to access them and
add/remove/update attributes in the session?



On Tue, Mar 30, 2010 at 6:42 PM, Itamar Turner-Trauring
<itamar at itamarst.org> wrote:
>> Greetings,
>>
>> I am new to this list and twisted. I have worked with some systems
>> similar to twisted, notably Apache MINA. I am trying to find out how
>> to set up my server to support sessions for multiple clients. Right
>> now I am simply developing a telnet-like application to learn twisted
>> but cannot figure out how to manage sessions for the remote clients.
>
> Each Protocol instance stays alive for the lifetime of the connection it
> is matched to (via the transport). So just store attributes on the
> Protocol instance.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From rgacote at appropriatesolutions.com  Wed Mar 31 06:32:59 2010
From: rgacote at appropriatesolutions.com (Ray Cote)
Date: Wed, 31 Mar 2010 08:32:59 -0400 (EDT)
Subject: [Twisted-Python] Anyone working on a Twisted txRiak?
In-Reply-To: <35B630BD-56A4-4F3B-8966-76720EBF46E9@twistedmatrix.com>
Message-ID: <6794132.781270039193421.JavaMail.rgacote@ip-210.Corp.AppropriateSolutions.com>

I guess coding starts this morning! 
Yes, we'll make sure it ends up on the wiki. 
--Ray


----- Original Message -----
From: "Glyph Lefkowitz" <glyph at twistedmatrix.com>
To: "Ray Cote" <rgacote at AppropriateSolutions.com>, "Twisted general discussion" <twisted-python at twistedmatrix.com>
Sent: Wednesday, March 31, 2010 12:01:24 AM GMT -05:00 US/Canada Eastern
Subject: Re: [Twisted-Python] Anyone working on a Twisted txRiak?


On Mar 30, 2010, at 3:22 PM, Ray Cote wrote:

> Curious to know if anyone is working on an interface between Twisted and Riak.
>  <http://basho.com/Riak.html>
> 
> Before we started one, thought I'd reach out first to ensure we're not duplicating efforts.
> --Ray

I can't say for sure, but given that archives of this mailing list post are already showing up as the top hit for "txriak" and "twisted riak" for me, I think you're pretty safe on getting started with it :).

Be sure to mention when you have a release so we can add it to <http://twistedmatrix.com/trac/wiki/ProjectsUsingTwisted>.


-- 
Ray Cote, President
Appropriate Solutions, Inc.
We Build Software
603.924.6079



From vlad.shevchenko at gmail.com  Wed Mar 31 09:54:49 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Wed, 31 Mar 2010 18:54:49 +0300
Subject: [Twisted-Python] AmpList: length limitations
Message-ID: <p2i572f045e1003310854g489877f3h837d4a934dc938b4@mail.gmail.com>

Hi all!

    Stuck with AmpList again :( Im trying to send/retrieve data much larger
then 64K and choose AmpList cause it "Convert a list of dictionaries into a
list of AMP boxes".

My original data looks like a long list of dicts [ {1}, {2}, ..., {x} ].
I convert it to [
    {'data': 'json encoded 1,2 dicts'},
    {'data': 'json encoded 3,4 dicts}',
    ...
] hoping EACH element in converted list will be converted to AmpBox and
retriever on wire.

However, still got TooLong exception on AmpBox.serialize(). AmpBox trying to
serialize all my converted list but not each dict in it separately.

Does this behavior ok, or this is a bug?

-- 
WBR, Vlad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100331/19c8fb4a/attachment-0001.html>

From cedric.dugas at gmail.com  Wed Mar 31 10:52:11 2010
From: cedric.dugas at gmail.com (Cedric Dugas)
Date: Wed, 31 Mar 2010 12:52:11 -0400
Subject: [Twisted-Python] Noob alert - Looking for a framework for creating
	a long polling service
Message-ID: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>

Hi guys,

I am a front-end developer, starting with django with some php in the belt.

I am looking for a framework for doing a long polling service where :

clients would connect to a soecific 'channel' and wait for a response

Where a client admin would push a response only to clients connected to the
same channel

It's a bit like a chat where everyone listening and only one is talking with
multiple channels


I am a bit lost in the twisted doc, I know that twisted do a LOT of thing,
and was wondering, if twisted is appropriate for this task,
and do you have a book to recommend for people like me (by that I mean that
I will not be using low level api's)

Thank you!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100331/1dd8daf0/attachment.html>

From rlotun at gmail.com  Wed Mar 31 14:26:47 2010
From: rlotun at gmail.com (Reza Lotun)
Date: Wed, 31 Mar 2010 21:26:47 +0100
Subject: [Twisted-Python] Noob alert - Looking for a framework for
	creating a long polling service
In-Reply-To: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>
References: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>
Message-ID: <v2x95bb10691003311326id1255c01ucba54d3c9ef38c51@mail.gmail.com>

Hi,

> I am looking for a framework for doing a long polling service where :
>
> clients would connect to a soecific 'channel' and wait for a response
>
> Where a client admin would push a response only to clients connected to the
> same channel

There is a project built on top of Twisted that does exactly this,
called Orbited (http://orbited.org/). It works, and I use it for
internal real-time stats web pages. The one caveat I have with it is
that it recently appears to be somewhat inactive - though I use it so
much I might fork it and continue development ;-)

A good article showing you how to use Orbited is:
http://cometdaily.com/2008/10/10/scalable-real-time-web-architecture-part-2-a-live-graph-with-orbited-morbidq-and-jsio/

Other articles are featured on the orbited site.

If you're looking for a scalable, long-polling queue broadcaster *in
general*, I highly suggest nginx_http_push - an addon module for the
popular C-based asynchronous web server nginx
(http://pushmodule.slact.net/).

Start with Orbited though, and see where it takes you ;-)

Cheers,
Reza

-- 
Reza Lotun
mobile: +44 (0)7521 310 763
email:  rlotun at gmail.com
work:   reza at tweetdeck.com
twitter: @rlotun



From ssteinerx at gmail.com  Wed Mar 31 14:58:43 2010
From: ssteinerx at gmail.com (ssteinerX@gmail.com)
Date: Wed, 31 Mar 2010 16:58:43 -0400
Subject: [Twisted-Python] Noob alert - Looking for a framework for
	creating a long polling service
In-Reply-To: <v2x95bb10691003311326id1255c01ucba54d3c9ef38c51@mail.gmail.com>
References: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>
	<v2x95bb10691003311326id1255c01ucba54d3c9ef38c51@mail.gmail.com>
Message-ID: <B995CBB9-AED4-49F7-8589-88DBDAE391AD@gmail.com>


On Mar 31, 2010, at 4:26 PM, Reza Lotun wrote:

> Hi,
> 
>> I am looking for a framework for doing a long polling service where :
>> 
>> clients would connect to a soecific 'channel' and wait for a response
>> 
>> Where a client admin would push a response only to clients connected to the
>> same channel
> 
> There is a project built on top of Twisted that does exactly this,
> called Orbited (http://orbited.org/). It works, and I use it for
> internal real-time stats web pages. The one caveat I have with it is
> that it recently appears to be somewhat inactive - though I use it so
> much I might fork it and continue development ;-)

It seems to have completely stalled just before the big 0.8 refactoring effort.

Have you continued, or do you plan to continue development where it was left off?

They all seem to have gone off to play with node.js instead.

> If you're looking for a scalable, long-polling queue broadcaster *in
> general*, I highly suggest nginx_http_push - an addon module for the
> popular C-based asynchronous web server nginx
> (http://pushmodule.slact.net/).

Very cool, I hadn't seen that before.

S




From exarkun at twistedmatrix.com  Wed Mar 31 15:39:52 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Wed, 31 Mar 2010 21:39:52 -0000
Subject: [Twisted-Python] session management
In-Reply-To: <9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>
References: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
	<31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>
	<9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>
Message-ID: <20100331213952.2792.778856419.divmod.xquotient.1975@localhost.localdomain>

On 04:10 am, elihusmails at gmail.com wrote:
>On Tue, Mar 30, 2010 at 6:42 PM, Itamar Turner-Trauring
><itamar at itamarst.org> wrote:
>>>Greetings,
>>>
>>>I am new to this list and twisted.  I have worked with some systems
>>>similar to twisted, notably Apache MINA.  I am trying to find out how
>>>to set up my server to support sessions for multiple clients.  Right
>>>now I am simply developing a telnet-like application to learn twisted
>>>but cannot figure out how to manage sessions for the remote clients.
>>
>>Each Protocol instance stays alive for the lifetime of the connection 
>>it
>>is matched to (via the transport). So just store attributes on the
>>Protocol instance.
>
>I figured as much that twisted supported the notion of sessions.  Are
>there any examples that show me how to access them and
>add/remove/update attributes in the session?

Protocol instances are normal Python objects.  You can use normal Python 
attributes on them in the normal way.  For example:

    from twisted.internet.protocol import Protocol

    class Counter(Protocol):
        """
        Keep track of how many times data is delivered over a connection.
        """
        def connectionMade(self):
            self.count = 0

        def dataReceived(self, bytes):
            self.count += 1

Jean-Paul



From mebly5343 at gmail.com  Wed Mar 31 15:44:23 2010
From: mebly5343 at gmail.com (Mark Bailey)
Date: Wed, 31 Mar 2010 17:44:23 -0400
Subject: [Twisted-Python] session management
In-Reply-To: <9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>
References: <9f066ee91003301347k16cdd27bo7e8592a6ace38b5@mail.gmail.com>
	<31448.63.107.91.99.1269988929.squirrel@webmail.zoteca.com>
	<9f066ee91003302110r3ed646ffla2821f14991deb55@mail.gmail.com>
Message-ID: <v2qdc408fe51003311444ha3d8bfyb446bb562aec9473@mail.gmail.com>

I found the following example answered my question:

http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother

Good luck.

Mark

On Mar 31, 2010 12:11 AM, "Mark" <elihusmails at gmail.com> wrote:

I figured as much that twisted supported the notion of sessions.  Are
there any examples that show me how to access them and
add/remove/update attributes in the session?




On Tue, Mar 30, 2010 at 6:42 PM, Itamar Turner-Trauring
<itamar at itamarst.org> wrote:
>> Greetings...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100331/4deaa04b/attachment.html>

From exarkun at twistedmatrix.com  Wed Mar 31 15:45:31 2010
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Wed, 31 Mar 2010 21:45:31 -0000
Subject: [Twisted-Python] AmpList: length limitations
In-Reply-To: <p2i572f045e1003310854g489877f3h837d4a934dc938b4@mail.gmail.com>
References: <p2i572f045e1003310854g489877f3h837d4a934dc938b4@mail.gmail.com>
Message-ID: <20100331214531.2792.1585769101.divmod.xquotient.1985@localhost.localdomain>

On 03:54 pm, vlad.shevchenko at gmail.com wrote:
>Hi all!
>
>    Stuck with AmpList again :( Im trying to send/retrieve data much 
>larger
>then 64K and choose AmpList cause it "Convert a list of dictionaries 
>into a
>list of AMP boxes".
>
>My original data looks like a long list of dicts [ {1}, {2}, ..., {x} 
>].
>I convert it to [
>    {'data': 'json encoded 1,2 dicts'},
>    {'data': 'json encoded 3,4 dicts}',
>    ...
>] hoping EACH element in converted list will be converted to AmpBox and
>retriever on wire.
>
>However, still got TooLong exception on AmpBox.serialize(). AmpBox 
>trying to
>serialize all my converted list but not each dict in it separately.
>
>Does this behavior ok, or this is a bug?

When you use an AmpList, the value is still serialized as a single key's 
value string, so the 64k limit still applies, even if it has sub- 
structures of its own, none of which exceed the limit.

At the Twisted sprint hosted by Flumotion last weekend, some people were 
working on adding real streaming support to AMP.  I think most of the 
progress made was in understanding how the implementation should work, 
though.

The associated ticket is #2529.
>
>--
>WBR, Vlad



From donal.mcmullan at gmail.com  Wed Mar 31 15:48:22 2010
From: donal.mcmullan at gmail.com (Donal McMullan)
Date: Thu, 1 Apr 2010 10:48:22 +1300
Subject: [Twisted-Python] Noob alert - Looking for a framework for
	creating a long polling service
In-Reply-To: <B995CBB9-AED4-49F7-8589-88DBDAE391AD@gmail.com>
References: <o2g39f0ac351003310952s6b6e01e4x117dae4cf62be7b6@mail.gmail.com>
	<v2x95bb10691003311326id1255c01ucba54d3c9ef38c51@mail.gmail.com>
	<B995CBB9-AED4-49F7-8589-88DBDAE391AD@gmail.com>
Message-ID: <m2g634095dc1003311448h613a534dye1d6ec1425132ad7@mail.gmail.com>

There's some simple sample code here:
http://zenmachine.wordpress.com/2009/09/19/twisted-and-comet-comet-in-60-seconds/

The formatting's off, but otherwise it's a succinct demo of the kind of
functionality you may be looking for.

Cheers

D

On 1 April 2010 09:58, ssteinerX at gmail.com <ssteinerx at gmail.com> wrote:

>
> On Mar 31, 2010, at 4:26 PM, Reza Lotun wrote:
>
> > Hi,
> >
> >> I am looking for a framework for doing a long polling service where :
> >>
> >> clients would connect to a soecific 'channel' and wait for a response
> >>
> >> Where a client admin would push a response only to clients connected to
> the
> >> same channel
> >
> > There is a project built on top of Twisted that does exactly this,
> > called Orbited (http://orbited.org/). It works, and I use it for
> > internal real-time stats web pages. The one caveat I have with it is
> > that it recently appears to be somewhat inactive - though I use it so
> > much I might fork it and continue development ;-)
>
> It seems to have completely stalled just before the big 0.8 refactoring
> effort.
>
> Have you continued, or do you plan to continue development where it was
> left off?
>
> They all seem to have gone off to play with node.js instead.
>
> > If you're looking for a scalable, long-polling queue broadcaster *in
> > general*, I highly suggest nginx_http_push - an addon module for the
> > popular C-based asynchronous web server nginx
> > (http://pushmodule.slact.net/).
>
> Very cool, I hadn't seen that before.
>
> S
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100401/08ac20fd/attachment.html>

From vlad.shevchenko at gmail.com  Wed Mar 31 16:04:08 2010
From: vlad.shevchenko at gmail.com (Vlad Shevchenko)
Date: Thu, 1 Apr 2010 01:04:08 +0300
Subject: [Twisted-Python] AmpList: length limitations
In-Reply-To: <20100331214531.2792.1585769101.divmod.xquotient.1985@localhost.localdomain>
References: <p2i572f045e1003310854g489877f3h837d4a934dc938b4@mail.gmail.com>
	<20100331214531.2792.1585769101.divmod.xquotient.1985@localhost.localdomain>
Message-ID: <t2p572f045e1003311504z20dbfc59h5da5c4c35da2d431@mail.gmail.com>

Why does not serialize each AmpBox separately?

On Thu, Apr 1, 2010 at 12:45 AM, <exarkun at twistedmatrix.com> wrote:

> On 03:54 pm, vlad.shevchenko at gmail.com wrote:
> >Hi all!
> >
> >    Stuck with AmpList again :( Im trying to send/retrieve data much
> >larger
> >then 64K and choose AmpList cause it "Convert a list of dictionaries
> >into a
> >list of AMP boxes".
> >
> >My original data looks like a long list of dicts [ {1}, {2}, ..., {x}
> >].
> >I convert it to [
> >    {'data': 'json encoded 1,2 dicts'},
> >    {'data': 'json encoded 3,4 dicts}',
> >    ...
> >] hoping EACH element in converted list will be converted to AmpBox and
> >retriever on wire.
> >
> >However, still got TooLong exception on AmpBox.serialize(). AmpBox
> >trying to
> >serialize all my converted list but not each dict in it separately.
> >
> >Does this behavior ok, or this is a bug?
>
> When you use an AmpList, the value is still serialized as a single key's
> value string, so the 64k limit still applies, even if it has sub-
> structures of its own, none of which exceed the limit.
>
> At the Twisted sprint hosted by Flumotion last weekend, some people were
> working on adding real streaming support to AMP.  I think most of the
> progress made was in understanding how the implementation should work,
> though.
>
> The associated ticket is #2529.
> >
> >--
> >WBR, Vlad
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
WBR, Vlad Shevchenko
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20100401/a0cbdb03/attachment.html>

