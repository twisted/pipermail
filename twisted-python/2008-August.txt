From jack-tp at cs.york.ac.uk  Fri Aug  1 08:18:18 2008
From: jack-tp at cs.york.ac.uk (Jack Whitham)
Date: Fri, 1 Aug 2008 13:18:18 +0100
Subject: [Twisted-Python] Modifying Conch example
In-Reply-To: <324cfb540807310819k4a0eb792w6960be9031dcb7b6@mail.gmail.com>
References: <51a7308f0807230139j6c3f333emc538012b4dee43f7@mail.gmail.com>
	<20080723100055.GA24868@cs.york.ac.uk>
	<324cfb540807310819k4a0eb792w6960be9031dcb7b6@mail.gmail.com>
Message-ID: <20080801121818.GA10742@cs.york.ac.uk>

On Thu, Jul 31, 2008 at 11:19:53AM -0400, Paul Swartz wrote:
> On Wed, Jul 23, 2008 at 6:00 AM, Jack Whitham <jack-tp at cs.york.ac.uk> wrote:
> > On Wed, Jul 23, 2008 at 01:39:19AM -0700, Pump Kin wrote:
> >> Step 1) Is really bugging me here; I can't seem to strip the need for
> >> foreknowledge of the public key from the script. I can't easily
> >> programmatically access that information in my use case. I do however have
> >> ready access to the private key and fingerprint for verification. My
> >> modified tutorial scripts just vomit.
> >
> > I had the same problem. Some new key management features have been
> > added to Conch recently, so you now only need the private key:
> >
> > class ClientUserAuth(userauth.SSHUserAuthClient):
> >    def getPrivateKey(self):
> >        return defer.succeed(self.__getKey().keyObject)
> >
> > (Although I still get a deprecation warning about signData if
> > I do this..)
> 
> You're getting the deprecation warning because you're not calling back
> the Deferred with a Key object; you're calling it back with a PyCrypto
> key object (that's what .keyObject is)

Thanks, but this does not fix it. The deprecation warning is:

/usr/lib/python2.5/site-packages/twisted/conch/ssh/userauth.py:376: DeprecationWarning: signData is deprecated since Twisted Conch 0.9.  Use Key(obj).sign(data).
  return keys.signData(privateKey, signData)

I still get this warning even if I change my code to remove ".keyObject"
but authentication no longer works if I do that. It looks like this is
actually a bug in my copy of userauth.py (although it is not a serious
problem - just a deprecation warning). I could get around the
problem by reimplementing the signData method in SSHUserAuthClient.
I am using version 8.1.0 as distributed by Debian, i.e.
http://packages.debian.org/lenny/python-twisted-conch


-- 
Jack Whitham
jack at cs.york.ac.uk




From tarjei at nu.no  Sat Aug  2 10:00:20 2008
From: tarjei at nu.no (tarjei)
Date: Sat, 02 Aug 2008 16:00:20 +0200
Subject: [Twisted-Python] Minor bug in FTPFactory
In-Reply-To: <29ec21540807311710k49b43512g20b2fe12927f3586@mail.gmail.com>
References: <29ec21540807311710k49b43512g20b2fe12927f3586@mail.gmail.com>
Message-ID: <48946874.80506@nu.no>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Adriano Marques wrote:
> Hi folks,
> 
> I found a bug at FTPFactory class. Here is the link to the code:
> http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/protocols/ftp.py#L1247
> 
> The argument userAnonymous is useless as the instance variable is not
> being set by the value received by this argument during object
> construction.
> I don't know if here is the place for such discussion. Is there
> another better place for that? Also, am I supposed to send a patch
> fixing that here? I don't know if this mailing list accept
> attachments.

Hi, the correct thing to do is to write a unittest for it (in [1]) and a
patch and attach it to a ticket on the Twisted website.

1.
http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/test/test_ftp.py

Kind regards,
Tarjei


> 
> 
> Kind Regards,
> 

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFIlGh0YVRKCnSvzfIRAuAWAJ9BePRiBHmW0JuVXXaAK7GEKOe0hgCfW/+1
ysbBQXD17R44yQLAbIJPhkI=
=BhiA
-----END PGP SIGNATURE-----



From exarkun at twistedmatrix.com  Sun Aug  3 00:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 03 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1217736309.84.1621702059@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080803/0dbe8e97/attachment.htm 

From gabriel.rossetti at arimaz.com  Mon Aug  4 03:48:10 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 04 Aug 2008 09:48:10 +0200
Subject: [Twisted-Python] HTTP interface to a program using twisted
Message-ID: <4896B43A.9060700@arimaz.com>

Hello everyone,

I have a program using twisted and I'd like it to obtain it's data via 
the HTTP protocol. The idea is that the clients will connect to a 
service using HTTP and will send it data encapsulated in the HTTP. The 
data will be extracted and sent on to another service to process  it, 
which will in turn send the processed data back to the HTTP service to 
send back to the client. I think twisted.web and/or twisted.web2 should 
be used for this, is that correct? I don't quite get the difference in 
between web/web2, could someone please enlighten me? I have read the 
documentation but it doesn't say much.

Thank you,
Gabriel Rossetti



From p.mayers at imperial.ac.uk  Mon Aug  4 05:25:50 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 4 Aug 2008 10:25:50 +0100
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <4896B43A.9060700@arimaz.com>
References: <4896B43A.9060700@arimaz.com>
Message-ID: <20080804092550.GC32231@doorstop.net.ic.ac.uk>

On Mon, Aug 04, 2008 at 09:48:10AM +0200, Gabriel Rossetti wrote:
> Hello everyone,
>
> I have a program using twisted and I'd like it to obtain it's data via  
> the HTTP protocol. The idea is that the clients will connect to a  

It's best to ask such questions on the twisted-web list.

> service using HTTP and will send it data encapsulated in the HTTP. The  
> data will be extracted and sent on to another service to process  it,  
> which will in turn send the processed data back to the HTTP service to  
> send back to the client. I think twisted.web and/or twisted.web2 should  
> be used for this, is that correct? I don't quite get the difference in  
> between web/web2, could someone please enlighten me? I have read the  
> documentation but it doesn't say much.

Use twisted.web - twisted.web2 will have all its good bits stolen and 
put into .web, then be (I guess) deprecated:

  http://twistedmatrix.com/trac/wiki/TwistedWebPlan

Can someone with access re-add this prominent link to the twistedmatrix 
front page?



From gabriel.rossetti at arimaz.com  Mon Aug  4 08:20:39 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 04 Aug 2008 14:20:39 +0200
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <20080804092550.GC32231@doorstop.net.ic.ac.uk>
References: <4896B43A.9060700@arimaz.com>
	<20080804092550.GC32231@doorstop.net.ic.ac.uk>
Message-ID: <4896F417.2070001@arimaz.com>

Phil Mayers wrote:
> On Mon, Aug 04, 2008 at 09:48:10AM +0200, Gabriel Rossetti wrote:
>> Hello everyone,
>>
>> I have a program using twisted and I'd like it to obtain it's data 
>> via  the HTTP protocol. The idea is that the clients will connect to a  
>
> It's best to ask such questions on the twisted-web list.
>
Ok, but I just want to make sure first it's better to use twisted.web 
rather than implementing my own protocol, since I won't be serving any 
web pages and to me it seams twisted.web is designed to serve web content.
>> service using HTTP and will send it data encapsulated in the HTTP. 
>> The  data will be extracted and sent on to another service to 
>> process  it,  which will in turn send the processed data back to the 
>> HTTP service to  send back to the client. I think twisted.web and/or 
>> twisted.web2 should  be used for this, is that correct? I don't quite 
>> get the difference in  between web/web2, could someone please 
>> enlighten me? I have read the  documentation but it doesn't say much.
>
> Use twisted.web - twisted.web2 will have all its good bits stolen and 
> put into .web, then be (I guess) deprecated:
>
>  http://twistedmatrix.com/trac/wiki/TwistedWebPlan
Ok
>
> Can someone with access re-add this prominent link to the 
> twistedmatrix front page?
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From p.mayers at imperial.ac.uk  Mon Aug  4 10:08:27 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 04 Aug 2008 15:08:27 +0100
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <4896F417.2070001@arimaz.com>
References: <4896B43A.9060700@arimaz.com>	<20080804092550.GC32231@doorstop.net.ic.ac.uk>
	<4896F417.2070001@arimaz.com>
Message-ID: <48970D5B.9080503@imperial.ac.uk>

Gabriel Rossetti wrote:
> Phil Mayers wrote:
>> On Mon, Aug 04, 2008 at 09:48:10AM +0200, Gabriel Rossetti wrote:
>>> Hello everyone,
>>>
>>> I have a program using twisted and I'd like it to obtain it's data 
>>> via  the HTTP protocol. The idea is that the clients will connect to a  
>>
>> It's best to ask such questions on the twisted-web list.
>>
> Ok, but I just want to make sure first it's better to use twisted.web 
> rather than implementing my own protocol, since I won't be serving any 
> web pages and to me it seams twisted.web is designed to serve web content.

No. twisted.web is a general HTTP server. You can use it to implement 
XMLRPC, JSON-RPC or various other non-HTML HTTP applications, as well as 
HTML pages.



From d.a.abernathy at gmail.com  Mon Aug  4 11:09:48 2008
From: d.a.abernathy at gmail.com (DJ)
Date: Mon, 4 Aug 2008 10:09:48 -0500
Subject: [Twisted-Python] Re: Error Request did not return a string
Message-ID: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>

Hello All,

For some strange reason I this text is being added to the end of the html
pages rendered by twisted.
Request did not return a string

Request:

<GET /config/deleteSection HTTP/1.1>


Resource:

<configPages.deleteSection instance at 0x00EC4EE0>


Value:

None

I am using the resource.Resource and render. My html is passed has a string
using request.write.
As far has I can tell, there should not be a problem. Does anyone know why
and what I need to do to fix this.

-- 
Dafina A. Abernathy (DJ)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080804/ceeb1dcc/attachment.htm 

From gabriel.rossetti at arimaz.com  Mon Aug  4 11:13:31 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 04 Aug 2008 17:13:31 +0200
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <48970D5B.9080503@imperial.ac.uk>
References: <4896B43A.9060700@arimaz.com>	<20080804092550.GC32231@doorstop.net.ic.ac.uk>	<4896F417.2070001@arimaz.com>
	<48970D5B.9080503@imperial.ac.uk>
Message-ID: <48971C9B.7000506@arimaz.com>

Phil Mayers wrote:
> Gabriel Rossetti wrote:
>> Phil Mayers wrote:
>>> On Mon, Aug 04, 2008 at 09:48:10AM +0200, Gabriel Rossetti wrote:
>>>> Hello everyone,
>>>>
>>>> I have a program using twisted and I'd like it to obtain it's data 
>>>> via  the HTTP protocol. The idea is that the clients will connect 
>>>> to a  
>>>
>>> It's best to ask such questions on the twisted-web list.
>>>
>> Ok, but I just want to make sure first it's better to use twisted.web 
>> rather than implementing my own protocol, since I won't be serving 
>> any web pages and to me it seams twisted.web is designed to serve web 
>> content.
>
> No. twisted.web is a general HTTP server. You can use it to implement 
> XMLRPC, JSON-RPC or various other non-HTML HTTP applications, as well 
> as HTML pages.
>
Ok, thank you Phil



From d.a.abernathy at gmail.com  Mon Aug  4 11:23:15 2008
From: d.a.abernathy at gmail.com (DJ)
Date: Mon, 4 Aug 2008 10:23:15 -0500
Subject: [Twisted-Python] Re: Running twisted as an http server
Message-ID: <7dfc47fe0808040823j5345c653o5c51255d7a3b21f2@mail.gmail.com>

Hello All,

I have written a small twisted application that I am trying to access over
http.
I have successfully created a tap file using mktap, but I still cannot
access the
application using http. Does anyone know how this is done ?

-- 
Dafina A. Abernathy (DJ)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080804/6ad332a9/attachment.htm 

From maarten at treewalker.org  Mon Aug  4 16:50:24 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Mon, 4 Aug 2008 22:50:24 +0200
Subject: [Twisted-Python] Re: Error Request did not return a string
In-Reply-To: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>
References: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>
Message-ID: <200808042250.31325.maarten@treewalker.org>

On Monday 04 August 2008, DJ wrote:

> For some strange reason I this text is being added to the end of the html
> pages rendered by twisted.
> Request did not return a string
>
> Request:
>
> <GET /config/deleteSection HTTP/1.1>
>
>
> Resource:
>
> <configPages.deleteSection instance at 0x00EC4EE0>
>
>
> Value:
>
> None
>
> I am using the resource.Resource and render. My html is passed has a
> string using request.write.
> As far has I can tell, there should not be a problem. Does anyone know
> why and what I need to do to fix this.

Python functions implicitly return None if there is no return statement.

Twisted.web wants the render method to either return a string, or the 
special object NOT_DONE_YET, which indicates that the reply will be written 
with request.write(). The name was probably chosen for cases where the 
content is written using deferreds, but it should be used even if you call 
request.write() from the render method.

So try putting "return server.NOT_DONE_YET" at the end of your render 
method.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20080804/e48a0bb0/attachment.pgp 

From glyph at divmod.com  Mon Aug  4 21:51:11 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 05 Aug 2008 01:51:11 -0000
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <4896F417.2070001@arimaz.com>
References: <4896B43A.9060700@arimaz.com>
	<20080804092550.GC32231@doorstop.net.ic.ac.uk>
	<4896F417.2070001@arimaz.com>
Message-ID: <20080805015111.25821.952097487.divmod.xquotient.13593@joule.divmod.com>

On 4 Aug, 12:20 pm, gabriel.rossetti at arimaz.com wrote:
>Ok, but I just want to make sure first it's better to use twisted.web 
>rather than implementing my own protocol, since I won't be serving any 
>web pages and to me it seams twisted.web is designed to serve web 
>content.

If you do need to do any of your own protocol work, surely it would be 
easier to write a few patches for twisted.web than to do the whole thing 
over again :).



From glyph at divmod.com  Mon Aug  4 21:53:54 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 05 Aug 2008 01:53:54 -0000
Subject: [Twisted-Python] Re: Running twisted as an http server
In-Reply-To: <7dfc47fe0808040823j5345c653o5c51255d7a3b21f2@mail.gmail.com>
References: <7dfc47fe0808040823j5345c653o5c51255d7a3b21f2@mail.gmail.com>
Message-ID: <20080805015354.25821.902523243.divmod.xquotient.13596@joule.divmod.com>

On 4 Aug, 03:23 pm, d.a.abernathy at gmail.com wrote:
>Hello All,
>
>I have written a small twisted application that I am trying to access 
>over
>http.
>I have successfully created a tap file using mktap, but I still cannot
>access the
>application using http. Does anyone know how this is done ?

If you did

    mktap foo bar baz

to make your tap file, instead do

    twistd foo bar baz

to start the server with your desired configuration rather than 
outputting a tap file.

Tap files are not a really good mechanism for dealing with configuration 
and are being slowly phased out in favor of running twistd plugins 
directly.



From squzer at declum.com  Tue Aug  5 07:43:41 2008
From: squzer at declum.com (Squzer Crawler)
Date: Tue, 5 Aug 2008 17:13:41 +0530
Subject: [Twisted-Python] Permanent Object
Message-ID: <7947f7250808050443r7751aa9dh296862ae3a959b5c@mail.gmail.com>

I want to create a server in twisted that has a permanent variable which i
want to use as the number of request requested to the server. When i use
that for Protocol, each time the variable is created newly.

Then i used
*class Echo(Protocol):
    def dataReceived(self, data):

        if "data" not in dir(self.factory):
            self.factory.data = 0
        self.factory.data = self.factory.data + 1

        """As soon as any data is received, write it back."""
        self.transport.write(data + str(self.factory.data))


but i want to remove the code that is:

**        if "data" not in dir(self.factory):
            self.factory.data = 0
        self.factory.data = self.factory.data + 1


How to do that?
*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080805/7439a969/attachment.htm 

From exarkun at divmod.com  Tue Aug  5 07:47:46 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 5 Aug 2008 07:47:46 -0400
Subject: [Twisted-Python] Permanent Object
In-Reply-To: <7947f7250808050443r7751aa9dh296862ae3a959b5c@mail.gmail.com>
Message-ID: <20080805114746.29191.620304992.divmod.quotient.10652@ohm>

On Tue, 5 Aug 2008 17:13:41 +0530, Squzer Crawler <squzer at declum.com> wrote:
>I want to create a server in twisted that has a permanent variable which i
>want to use as the number of request requested to the server. When i use
>that for Protocol, each time the variable is created newly.
>
>Then i used
>*class Echo(Protocol):
>    def dataReceived(self, data):
>
>        if "data" not in dir(self.factory):
>            self.factory.data = 0
>        self.factory.data = self.factory.data + 1
>
>        """As soon as any data is received, write it back."""
>        self.transport.write(data + str(self.factory.data))
>
>
>but i want to remove the code that is:
>
>**        if "data" not in dir(self.factory):
>            self.factory.data = 0
>        self.factory.data = self.factory.data + 1
>
>
>How to do that?
>*

Why?  You said it's what you wanted.

Jean-Paul



From terry at jon.es  Tue Aug  5 08:14:53 2008
From: terry at jon.es (Terry Jones)
Date: Tue, 5 Aug 2008 14:14:53 +0200
Subject: [Twisted-Python] Permanent Object
In-Reply-To: Your message at 07:47:46 on Tuesday, 5 August 2008
References: <7947f7250808050443r7751aa9dh296862ae3a959b5c@mail.gmail.com>
	<20080805114746.29191.620304992.divmod.quotient.10652@ohm>
Message-ID: <18584.17469.959750.275930@jon.es>

>>>>> "JP" == Jean-Paul Calderone <exarkun at divmod.com> writes:
JP> On Tue, 5 Aug 2008 17:13:41 +0530, Squzer Crawler <squzer at declum.com> wrote:
>> I want to create a server in twisted that has a permanent variable which i
>> want to use as the number of request requested to the server. When i use
>> that for Protocol, each time the variable is created newly.
>> 
>> Then i used
>> *class Echo(Protocol):
>> def dataReceived(self, data):
>> 
>> if "data" not in dir(self.factory):
>> self.factory.data = 0
>> self.factory.data = self.factory.data + 1
>> 
>> """As soon as any data is received, write it back."""
>> self.transport.write(data + str(self.factory.data))
>> 
>> but i want to remove the code that is:
>> 
>> **        if "data" not in dir(self.factory):
>> self.factory.data = 0
>> self.factory.data = self.factory.data + 1
>> 
>> How to do that?

JP> Why?  You said it's what you wanted.

Hi JP

I think Squzer meant that he'd like to put the initialization code elsewhere.

Squzer, why not do the initialization of self.factory.data when the factory
is created, and then increment the variable each time a connection is made?
Is that what you meant?

Terry



From d.a.abernathy at gmail.com  Tue Aug  5 10:50:51 2008
From: d.a.abernathy at gmail.com (DJ)
Date: Tue, 5 Aug 2008 09:50:51 -0500
Subject: [Twisted-Python] Re: Error Request did not return a string
In-Reply-To: <200808042250.31325.maarten@treewalker.org>
References: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>
	<200808042250.31325.maarten@treewalker.org>
Message-ID: <7dfc47fe0808050750j2c3eaa6am7e3da0e558b3fa11@mail.gmail.com>

Will request.finish have the same effect as return server.NOT_DONE_YET ?
Or do the statements do different things ?


On Mon, Aug 4, 2008 at 3:50 PM, Maarten ter Huurne
<maarten at treewalker.org>wrote:

> On Monday 04 August 2008, DJ wrote:
>
> > For some strange reason I this text is being added to the end of the html
> > pages rendered by twisted.
> > Request did not return a string
> >
> > Request:
> >
> > <GET /config/deleteSection HTTP/1.1>
> >
> >
> > Resource:
> >
> > <configPages.deleteSection instance at 0x00EC4EE0>
> >
> >
> > Value:
> >
> > None
> >
> > I am using the resource.Resource and render. My html is passed has a
> > string using request.write.
> > As far has I can tell, there should not be a problem. Does anyone know
> > why and what I need to do to fix this.
>
> Python functions implicitly return None if there is no return statement.
>
> Twisted.web wants the render method to either return a string, or the
> special object NOT_DONE_YET, which indicates that the reply will be written
> with request.write(). The name was probably chosen for cases where the
> content is written using deferreds, but it should be used even if you call
> request.write() from the render method.
>
> So try putting "return server.NOT_DONE_YET" at the end of your render
> method.
>
> Bye,
>                 Maarten
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


-- 
Dafina A. Abernathy (DJ)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080805/88f84b4b/attachment.htm 

From maarten at treewalker.org  Wed Aug  6 02:27:42 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Wed, 6 Aug 2008 08:27:42 +0200
Subject: [Twisted-Python] Re: Error Request did not return a string
In-Reply-To: <7dfc47fe0808050750j2c3eaa6am7e3da0e558b3fa11@mail.gmail.com>
References: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>
	<200808042250.31325.maarten@treewalker.org>
	<7dfc47fe0808050750j2c3eaa6am7e3da0e558b3fa11@mail.gmail.com>
Message-ID: <200808060827.49606.maarten@treewalker.org>

On Tuesday 05 August 2008, DJ wrote:

> Will request.finish have the same effect as return server.NOT_DONE_YET ?
> Or do the statements do different things ?

You have to use both: call request.finish() when you are done writing and 
return NOT_DONE_YET from the render method.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20080806/671d37e8/attachment.pgp 

From nadav at MIT.EDU  Wed Aug  6 15:53:33 2008
From: nadav at MIT.EDU (Nadav Aharony)
Date: Wed, 06 Aug 2008 15:53:33 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
Message-ID: <489A013D.4000807@mit.edu>

(forwarding for Daniel who had some list posting trouble)

Hi all-
I'd like to use Twisted to manage bluetooth communication. I haven't
found any existing method for doing this, so I'd like to write and
implement a new reactor interface (on par with TCP/UDP) that wraps the
lightblue library. What's the right way to go about extending Twisted in
this way?
Thanks,
Daniel




From exarkun at divmod.com  Wed Aug  6 16:04:49 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 6 Aug 2008 16:04:49 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <489A013D.4000807@mit.edu>
Message-ID: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>

On Wed, 06 Aug 2008 15:53:33 -0400, Nadav Aharony <nadav at mit.edu> wrote:
>(forwarding for Daniel who had some list posting trouble)
>
>Hi all-
>I'd like to use Twisted to manage bluetooth communication. I haven't
>found any existing method for doing this, so I'd like to write and
>implement a new reactor interface (on par with TCP/UDP) that wraps the
>lightblue library. What's the right way to go about extending Twisted in
>this way?

A lot of reactors implement `IReactorFDSet?:

  http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorFDSet.html

If you don't mind that some reactors don't implement this, you can
use it to implement bluetooth support.

Jean-Paul



From nadav at MIT.EDU  Thu Aug  7 22:01:41 2008
From: nadav at MIT.EDU (Nadav Aharony)
Date: Thu, 07 Aug 2008 22:01:41 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
Message-ID: <489BA905.8070901@mit.edu>

Jean-Paul Calderone wrote:
> On Wed, 06 Aug 2008 15:53:33 -0400, Nadav Aharony <nadav at mit.edu> wrote:
>> (forwarding for Daniel who had some list posting trouble)
>>
>> Hi all-
>> I'd like to use Twisted to manage bluetooth communication. I haven't
>> found any existing method for doing this, so I'd like to write and
>> implement a new reactor interface (on par with TCP/UDP) that wraps the
>> lightblue library. What's the right way to go about extending Twisted in
>> this way?
>
> A lot of reactors implement `IReactorFDSet?:
>
>  http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorFDSet.html 
>
>
> If you don't mind that some reactors don't implement this, you can
> use it to implement bluetooth support.
>
> Jean-Paul
>
> _________
Thanks! Will look into it (hopefully will be able to understand how to 
use it on our own)





From itamar at itamarst.org  Thu Aug  7 22:59:32 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 08 Aug 2008 02:59:32 +0000
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <489BA905.8070901@mit.edu>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
	<489BA905.8070901@mit.edu>
Message-ID: <1218164372.5308.110.camel@localhost.localdomain>

On Thu, 2008-08-07 at 22:01 -0400, Nadav Aharony wrote:

> Thanks! Will look into it (hopefully will be able to understand how to 
> use it on our own)

If you get stuck, and list doesn't help, show up to next Twisted sprint
and maybe one of us can help.




From glyph at divmod.com  Thu Aug  7 23:53:16 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Fri, 08 Aug 2008 03:53:16 -0000
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <1218164372.5308.110.camel@localhost.localdomain>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
	<489BA905.8070901@mit.edu>
	<1218164372.5308.110.camel@localhost.localdomain>
Message-ID: <20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>

On 02:59 am, itamar at itamarst.org wrote:
>On Thu, 2008-08-07 at 22:01 -0400, Nadav Aharony wrote:
>>Thanks! Will look into it (hopefully will be able to understand how to
>>use it on our own)
>
>If you get stuck, and list doesn't help, show up to next Twisted sprint
>and maybe one of us can help.

Oh yeah!  Twisted sprints!  When is the next one of those, anyway?



From nadav at MIT.EDU  Fri Aug  8 01:40:56 2008
From: nadav at MIT.EDU (Nadav Aharony)
Date: Fri, 08 Aug 2008 01:40:56 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>	<489BA905.8070901@mit.edu>	<1218164372.5308.110.camel@localhost.localdomain>
	<20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>
Message-ID: <489BDC68.1090803@mit.edu>

glyph at divmod.com wrote:
> On 02:59 am, itamar at itamarst.org wrote:
>> On Thu, 2008-08-07 at 22:01 -0400, Nadav Aharony wrote:
>>> Thanks! Will look into it (hopefully will be able to understand how to
>>> use it on our own)
>>
>> If you get stuck, and list doesn't help, show up to next Twisted sprint
>> and maybe one of us can help.
>
> Oh yeah!  Twisted sprints!  When is the next one of those, anyway?
>
Was just about to ask. If it works out I'll happily show up and get 
myself a little Twisted.




From alan.franzoni.xyz at gmail.com  Fri Aug  8 06:05:27 2008
From: alan.franzoni.xyz at gmail.com (Alan Franzoni)
Date: Fri, 8 Aug 2008 12:05:27 +0200
Subject: [Twisted-Python] Jython reactor - a proposal
Message-ID: <1qwea36yndtit.ci6snfvp7paz.dlg@40tude.net>

Hello everybody,
I recently took a look at the current Jython status, and it seems to me
that the latest alpha provides a good compatibility towards the standard
CPython. 

I'd really like running jython+twisted, so when I realized there was no
reactor available for such platform I took some time to analyze the issue:

- An old-and-incomplete java reactor existed in Twisted 1.3 which used
java.io.
- java.nio would be a better choice to implement such a reactor since java
1.4
- a wrapper around java.nio called EIO existed (
http://java.twistedmatrix.com/eio/ ) but there seems no way to take a peek
at it since there's no file that can be accessed beyond its home page
(every single link is broken :-( )
- a kind of async networking library called Apache Mina is avaiable for
java, and it makes use of java.nio
- other java-reactor pattern implementations are available around (e.g.
assorted on sourceforge ).

So, it seems java.nio is the right way to go and there's quite a lot of
code around to look at. Since I'd like to code a java reactory, I've got
some questions:
- any other clue? Is there anything else I should look at before starting
my code?
- is there any way I could be given commit access to a private branch on
twisted svn repository? i could set up a repo elsewhere, but this would
make synchronization and merging a bit more painful and slow.
- is there any other similar project ongoing by anyone else?

Thanks!

-- 
Alan Franzoni <alan.franzoni.xyz at gmail.com>
-
Remove .xyz from my email in order to contact me.
-
GPG Key Fingerprint:
5C77 9DC3 BD5B 3A28 E7BC 921A 0255 42AA FE06 8F3E




From peter at sabaini.at  Fri Aug  8 10:22:02 2008
From: peter at sabaini.at (Peter Sabaini)
Date: Fri, 8 Aug 2008 16:22:02 +0200
Subject: [Twisted-Python] Interest in TIPC support?
Message-ID: <200808081622.08381.peter@sabaini.at>

Hi list,

I'm currently in the process of hacking together TIPC[1] support for Twisted. 
I've got reliable datagram support in a "works for me" state now.

Is anyone interested to see this in Twisted? Thought I'd rather ask here 
before opening a ticket etc. 

peter.


[1] http://tipc.sourceforge.net/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20080808/5f193765/attachment.pgp 

From alan.franzoni.xyz at gmail.com  Sat Aug  9 04:49:13 2008
From: alan.franzoni.xyz at gmail.com (Alan Franzoni)
Date: Sat, 9 Aug 2008 10:49:13 +0200
Subject: [Twisted-Python] Re: Jython reactor - a proposal
References: <1qwea36yndtit.ci6snfvp7paz.dlg@40tude.net>
Message-ID: <jrglic6zoxp6.t1wlzz49mzat.dlg@40tude.net>

Alan Franzoni was kind enough to say:

[cut]

I just discovered jython provides the select module as well (I wouldn't
ever think of that), I'm performing some tests with that before going on
with a brand-new reactor.

-- 
Alan Franzoni <alan.franzoni.xyz at gmail.com>
-
Remove .xyz from my email in order to contact me.
-
GPG Key Fingerprint:
5C77 9DC3 BD5B 3A28 E7BC 921A 0255 42AA FE06 8F3E




From marco.giusti at gmail.com  Sat Aug  9 05:02:17 2008
From: marco.giusti at gmail.com (Marco Giusti)
Date: Sat, 9 Aug 2008 11:02:17 +0200
Subject: [Twisted-Python] foolscap copyable and constraint
Message-ID: <20080809090217.GA8379@lemurdoc>

ciao! i'm playing a bit with foolscap and i try to use RemoteInterface
to describe my constraint but i cannot understand how to use it with
pass-by-copy. this is a small example:


    from foolscap import RemoteInterface, registerCopier, \
            registerRemoteCopyFactory

    class Label:
        def __init__(self, text):
            self.text = text


    def copyLabel(label):
        return ('_Label', {'text': label.text})

    registerCopier(Label, copyLabel)

    def makeLabel(state):
        label = Label(state['text'])
        return label

    registerRemoteCopyFactory('_Label', makeLabel)


    class RITest(RemoteInterface):
        def getLabel():
            return Label


but what i get is:
foolscap.tokens.UnknownSchemaType: can't make constraint from
'__main__.Label' (<type 'classobj'>)

which is the correct way to define a constraint for a third party-class?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20080809/2f9591a5/attachment.pgp 

From exarkun at twistedmatrix.com  Sun Aug 10 00:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 10 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1218341109.11.1385115348@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080810/77448303/attachment.htm 

From Andy at NewWorldElectric.com  Sun Aug 10 19:25:34 2008
From: Andy at NewWorldElectric.com (Andy Fundinger)
Date: Sun, 10 Aug 2008 19:25:34 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <489BDC68.1090803@mit.edu>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
	<489BA905.8070901@mit.edu>
	<1218164372.5308.110.camel@localhost.localdomain>
	<20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>
	<489BDC68.1090803@mit.edu>
Message-ID: <37d49ed40808101625k77bd2a9am121801aa74702212@mail.gmail.com>

Are there ever East Coast sprints, I'd like to make one, but I'm in New
York.

On Fri, Aug 8, 2008 at 1:40 AM, Nadav Aharony <nadav at mit.edu> wrote:

> glyph at divmod.com wrote:
>
>> On 02:59 am, itamar at itamarst.org wrote:
>>
>>> On Thu, 2008-08-07 at 22:01 -0400, Nadav Aharony wrote:
>>>
>>>> Thanks! Will look into it (hopefully will be able to understand how to
>>>> use it on our own)
>>>>
>>>
>>> If you get stuck, and list doesn't help, show up to next Twisted sprint
>>> and maybe one of us can help.
>>>
>>
>> Oh yeah!  Twisted sprints!  When is the next one of those, anyway?
>>
>>  Was just about to ask. If it works out I'll happily show up and get
> myself a little Twisted.
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Blog: http://channel3b.wordpress.com
Second Life Name: Ciemaar Flintoff

What would you do if they outlawed hypothetical questions?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080810/007f9e60/attachment.htm 

From radix at twistedmatrix.com  Sun Aug 10 19:37:22 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 10 Aug 2008 19:37:22 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <37d49ed40808101625k77bd2a9am121801aa74702212@mail.gmail.com>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
	<489BA905.8070901@mit.edu>
	<1218164372.5308.110.camel@localhost.localdomain>
	<20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>
	<489BDC68.1090803@mit.edu>
	<37d49ed40808101625k77bd2a9am121801aa74702212@mail.gmail.com>
Message-ID: <60ed19d40808101637s704617f0wfce28a44609fc6cc@mail.gmail.com>

On Sun, Aug 10, 2008 at 7:25 PM, Andy Fundinger
<Andy at newworldelectric.com> wrote:
> Are there ever East Coast sprints, I'd like to make one, but I'm in New
> York.

Yes, the regular Twisted sprints are held in Cambridge, MA.

Shall we have another one soon? I'm available outside of September 6-20.

-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/



From exarkun at divmod.com  Sun Aug 10 20:03:29 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 10 Aug 2008 20:03:29 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <60ed19d40808101637s704617f0wfce28a44609fc6cc@mail.gmail.com>
Message-ID: <20080811000329.29191.744234800.divmod.quotient.13057@ohm>

On Sun, 10 Aug 2008 19:37:22 -0400, Christopher Armstrong <radix at twistedmatrix.com> wrote:
>On Sun, Aug 10, 2008 at 7:25 PM, Andy Fundinger
><Andy at newworldelectric.com> wrote:
>> Are there ever East Coast sprints, I'd like to make one, but I'm in New
>> York.
>
>Yes, the regular Twisted sprints are held in Cambridge, MA.
>
>Shall we have another one soon? I'm available outside of September 6-20.
>

Yes, let's.  Does August 30th or August 31st work for anyone?  

Jean-Paul



From itamar at itamarst.org  Sun Aug 10 21:29:00 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 10 Aug 2008 21:29:00 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <20080811000329.29191.744234800.divmod.quotient.13057@ohm>
References: <20080811000329.29191.744234800.divmod.quotient.13057@ohm>
Message-ID: <1218418140.5308.140.camel@localhost.localdomain>

On Sun, 2008-08-10 at 20:03 -0400, Jean-Paul Calderone wrote:

> >Shall we have another one soon? I'm available outside of September 6-20.
> >
> 
> Yes, let's.  Does August 30th or August 31st work for anyone?  

Not me, I'm camping on the Cape that weekend (not that I'm much
practical help at sprints :/). How about 16-17 or 23-24?




From exarkun at divmod.com  Sun Aug 10 22:37:38 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 10 Aug 2008 22:37:38 -0400
Subject: Cambridge Twisted Spring (was Re: [Twisted-Python] Bluetooth
	reactor interface)
In-Reply-To: <1218418140.5308.140.camel@localhost.localdomain>
Message-ID: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>

On Sun, 10 Aug 2008 21:29:00 -0400, Itamar Shtull-Trauring <itamar at itamarst.org> wrote:
>On Sun, 2008-08-10 at 20:03 -0400, Jean-Paul Calderone wrote:
>
>> >Shall we have another one soon? I'm available outside of September 6-20.
>> >
>>
>> Yes, let's.  Does August 30th or August 31st work for anyone?
>
>Not me, I'm camping on the Cape that weekend (not that I'm much
>practical help at sprints :/). How about 16-17 or 23-24?
>

I'll be out of town the 16th and 17th; 23rd or 24th works for me.

Jean-Paul



From nadav at MIT.EDU  Mon Aug 11 00:48:02 2008
From: nadav at MIT.EDU (Nadav Aharony)
Date: Mon, 11 Aug 2008 00:48:02 -0400
Subject: Cambridge Twisted Spring (was Re: [Twisted-Python] Bluetooth
	reactor interface)
In-Reply-To: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
References: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
Message-ID: <489FC482.8020808@mit.edu>

Well my schedule should definitely not carry much weight since I am 
totally new to this, bet here goes:
Not available - From now till Sept 2nd, and weekend of Sept 13th. 
Otherwise - will do my best to make it and drag one or two others with me.
(Oh, and I AM located in Cambridge, MA)

-Nadav



but I am located in Cambridge MA
Jean-Paul Calderone wrote:
> On Sun, 10 Aug 2008 21:29:00 -0400, Itamar Shtull-Trauring 
> <itamar at itamarst.org> wrote:
>> On Sun, 2008-08-10 at 20:03 -0400, Jean-Paul Calderone wrote:
>>
>>> >Shall we have another one soon? I'm available outside of September 
>>> 6-20.
>>> >
>>>
>>> Yes, let's.  Does August 30th or August 31st work for anyone?
>>
>> Not me, I'm camping on the Cape that weekend (not that I'm much
>> practical help at sprints :/). How about 16-17 or 23-24?
>>
>
> I'll be out of town the 16th and 17th; 23rd or 24th works for me.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From stephan.jaeger at ewetel.de  Mon Aug 11 10:19:54 2008
From: stephan.jaeger at ewetel.de (Stephan Jaeger)
Date: Mon, 11 Aug 2008 16:19:54 +0200
Subject: [Twisted-Python] AsynQueue: return deferred from queued method
Message-ID: <1218464394.7686.19.camel@localhost>

Hello List,

I'm trying to use AsynQueue for queuing requests for a synchronous
protocol (emi/ucp). Is it possible to return a deferred from the queued
method so the next method in the queue is only called after the deferred
from the first was fired? Or is there a better way to handle synchronous
protocols where i have to wait for an answer of a message sent over the
wire before i can send another one?

Thanks,

Stephan




From general at eepatents.com  Mon Aug 11 11:52:19 2008
From: general at eepatents.com (Ed Suominen)
Date: Mon, 11 Aug 2008 08:52:19 -0700
Subject: [Twisted-Python] AsynQueue: return deferred from queued method
In-Reply-To: <1218464394.7686.19.camel@localhost>
References: <1218464394.7686.19.camel@localhost>
Message-ID: <48A06033.4010107@eepatents.com>

Stephan Jaeger wrote:
> I'm trying to use AsynQueue for queuing requests for a synchronous
> protocol (emi/ucp). Is it possible to return a deferred from the queued
> method so the next method in the queue is only called after the deferred
> from the first was fired? Or is there a better way to handle synchronous
> protocols where i have to wait for an answer of a message sent over the
> wire before i can send another one?

Just use a single implementer of IWorker that only accepts one 
assignment at a time. The queue will not feed it its next task until the 
deferred from its previous one has fired.

What you're trying to do is exactly what AsynQueue is for. For example, 
my sAsync package uses AsynQueue to feed database queries to the SQLite 
database engine one at a time in a single thread.

If you have multiple connections that each can handle successive 
requests successively, but independently the other connection, you can 
simply use an IWorker implementer for each one. (I don't know that 
emi/ucp has any way of doing this.) Then the queue will feed requests to 
whoever is ready, one at a time.

I use this for running jobs asynchronously over a cluster of CPU nodes. 
The queue gets fed thousands of tasks nearly at once, and parcels them 
out one at a time to each node. Some CPU nodes run faster than others, 
and the queueing makes that all work out fine.

Please note that there is also a very simple and elegant queue object in 
twisted.internet.defer that might meet your needs without the complexity 
(and capability) of AsynQueue.

Feel free to contact me offline if you have additional questions on this.

Best regards,
Ed Suominen



From gabriel.rossetti at arimaz.com  Mon Aug 11 12:17:53 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 11 Aug 2008 18:17:53 +0200
Subject: [Twisted-Python] does setTcpNoDelay() not work?
Message-ID: <48A06631.6040107@arimaz.com>

Hello,

I'm needing to send small packets to update a progress bar. My update 
msgs were all being sent in big packets, so I tried setting 
setTcpNoDelay() in connectionMade() but it doesn't change anything, is 
it broken?

Thank you,
Gabriel



From gabriel.rossetti at arimaz.com  Mon Aug 11 13:13:56 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 11 Aug 2008 19:13:56 +0200
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <48A06631.6040107@arimaz.com>
References: <48A06631.6040107@arimaz.com>
Message-ID: <48A07354.3050108@arimaz.com>

Gabriel Rossetti wrote:
> Hello,
>
> I'm needing to send small packets to update a progress bar. My update 
> msgs were all being sent in big packets, so I tried setting 
> setTcpNoDelay() in connectionMade() but it doesn't change anything, is 
> it broken?
>
> Thank you,
> Gabriel
>
I an using code that I wrote using threads.deferToThread(), I wondered 
if it was blocking the reactor maybe, so I tried just using a plain 
deferToThread() call. Here's the code (without all the protocol stuff, 
it's executed when data come in.

    def loop(self):
        import time
        m = utils.createMessage("toto", "hello")
        while(True):
            print "Sending %s" % m.toXml()
            self.sendMessage(m)
            print "Sent!"
            time.sleep(2)


threads.deferToThread(self.loop)

the TCP no delay option is turned on like I said before, the weird thing 
is that I have the same thing, all my msgs get sent in big blocks. 
Either the TCP no delay doesn't work, or the reactor is getting tied up. 
I don' t get it since I'm running the blocking code in a thread, the 
reactor should have nothing to do.

Thank you,
Gabriel

P.S.
I know that I'm not returning a deferred, I am in my real code though, 
but this is just "debug" code.



From exarkun at divmod.com  Mon Aug 11 13:30:04 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 11 Aug 2008 13:30:04 -0400
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <48A07354.3050108@arimaz.com>
Message-ID: <20080811173004.29191.220123618.divmod.quotient.13333@ohm>

On Mon, 11 Aug 2008 19:13:56 +0200, Gabriel Rossetti <gabriel.rossetti at arimaz.com> wrote:
>Gabriel Rossetti wrote:
>>Hello,
>>
>>I'm needing to send small packets to update a progress bar. My update msgs 
>>were all being sent in big packets, so I tried setting setTcpNoDelay() in 
>>connectionMade() but it doesn't change anything, is it broken?
>>
>>Thank you,
>>Gabriel
>I an using code that I wrote using threads.deferToThread(), I wondered if it 
>was blocking the reactor maybe, so I tried just using a plain 
>deferToThread() call. Here's the code (without all the protocol stuff, it's 
>executed when data come in.
>
>    def loop(self):
>        import time
>        m = utils.createMessage("toto", "hello")
>        while(True):
>            print "Sending %s" % m.toXml()
>            self.sendMessage(m)
>            print "Sent!"
>            time.sleep(2)
>
>
>threads.deferToThread(self.loop)
>
>the TCP no delay option is turned on like I said before, the weird thing is 
>that I have the same thing, all my msgs get sent in big blocks. Either the 
>TCP no delay doesn't work, or the reactor is getting tied up. I don' t get 
>it since I'm running the blocking code in a thread, the reactor should have 
>nothing to do.
>

Since you didn't include the definition of `sendMessage?, it's hard to say
what's really going on here.  However, my guess is that you're calling the
transport.write method in a non-reactor thread, which is not allowed.

If this isn't the case, including a full, minimal example in your next
message would be a good idea. :)

Jean-Paul



From glyph at divmod.com  Mon Aug 11 13:35:21 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Mon, 11 Aug 2008 17:35:21 -0000
Subject: Cambridge Twisted Spring (was Re: [Twisted-Python] Bluetooth
	reactor interface)
In-Reply-To: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
References: <1218418140.5308.140.camel@localhost.localdomain>
	<20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
Message-ID: <20080811173521.25821.1551077115.divmod.xquotient.14151@joule.divmod.com>

On 02:37 am, exarkun at divmod.com wrote:
>I'll be out of town the 16th and 17th; 23rd or 24th works for me.

I'll be busy the 24th.  Shall we say the 23rd?



From glyph at divmod.com  Mon Aug 11 13:38:34 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Mon, 11 Aug 2008 17:38:34 -0000
Subject: Cambridge Twisted Spring (was Re: [Twisted-Python] Bluetooth
	reactor interface)
In-Reply-To: <489FC482.8020808@mit.edu>
References: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
	<489FC482.8020808@mit.edu>
Message-ID: <20080811173834.25821.2125603796.divmod.xquotient.14153@joule.divmod.com>

On 04:48 am, nadav at mit.edu wrote:
>Well my schedule should definitely not carry much weight since I am 
>totally new to this, bet here goes:
>Not available - From now till Sept 2nd, and weekend of Sept 13th. 
>Otherwise - will do my best to make it and drag one or two others with 
>me.
>(Oh, and I AM located in Cambridge, MA)

Sounds like you'll be missing the August one (pretty much by definition) 
but hopefully we'll see you in September!



From gabriel.rossetti at arimaz.com  Mon Aug 11 14:18:43 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 11 Aug 2008 20:18:43 +0200
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <20080811173004.29191.220123618.divmod.quotient.13333@ohm>
References: <20080811173004.29191.220123618.divmod.quotient.13333@ohm>
Message-ID: <48A08283.2000200@arimaz.com>

Jean-Paul Calderone wrote:
> On Mon, 11 Aug 2008 19:13:56 +0200, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com> wrote:
>> Gabriel Rossetti wrote:
>>> Hello,
>>>
>>> I'm needing to send small packets to update a progress bar. My 
>>> update msgs were all being sent in big packets, so I tried setting 
>>> setTcpNoDelay() in connectionMade() but it doesn't change anything, 
>>> is it broken?
>>>
>>> Thank you,
>>> Gabriel
>> I an using code that I wrote using threads.deferToThread(), I 
>> wondered if it was blocking the reactor maybe, so I tried just using 
>> a plain deferToThread() call. Here's the code (without all the 
>> protocol stuff, it's executed when data come in.
>>
>>    def loop(self):
>>        import time
>>        m = utils.createMessage("toto", "hello")
>>        while(True):
>>            print "Sending %s" % m.toXml()
>>            self.sendMessage(m)
>>            print "Sent!"
>>            time.sleep(2)
>>
>>
>> threads.deferToThread(self.loop)
>>
>> the TCP no delay option is turned on like I said before, the weird 
>> thing is that I have the same thing, all my msgs get sent in big 
>> blocks. Either the TCP no delay doesn't work, or the reactor is 
>> getting tied up. I don' t get it since I'm running the blocking code 
>> in a thread, the reactor should have nothing to do.
>>
>
> Since you didn't include the definition of `sendMessage?, it's hard to 
> say
> what's really going on here.  However, my guess is that you're calling 
> the
> transport.write method in a non-reactor thread, which is not allowed.
>
> If this isn't the case, including a full, minimal example in your next
> message would be a good idea. :)
>
> Jean-Paul
>
>
Yes, self.sendMessage() calls transport.write. So there's no way of 
sending msgs from a non-reactor thread, even if it has a reference to 
the protocol?

Gabriel



From exarkun at divmod.com  Mon Aug 11 14:22:31 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 11 Aug 2008 14:22:31 -0400
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <48A08283.2000200@arimaz.com>
Message-ID: <20080811182231.29191.697604575.divmod.quotient.13337@ohm>

On Mon, 11 Aug 2008 20:18:43 +0200, Gabriel Rossetti <gabriel.rossetti at arimaz.com> wrote:
>Jean-Paul Calderone wrote:
>>On Mon, 11 Aug 2008 19:13:56 +0200, Gabriel Rossetti 
>><gabriel.rossetti at arimaz.com> wrote:
>>>Gabriel Rossetti wrote:
>>>>Hello,
>>>>
>>>>I'm needing to send small packets to update a progress bar. My update 
>>>>msgs were all being sent in big packets, so I tried setting 
>>>>setTcpNoDelay() in connectionMade() but it doesn't change anything, is it 
>>>>broken?
>>>>
>>>>Thank you,
>>>>Gabriel
>>>I an using code that I wrote using threads.deferToThread(), I wondered if 
>>>it was blocking the reactor maybe, so I tried just using a plain 
>>>deferToThread() call. Here's the code (without all the protocol stuff, 
>>>it's executed when data come in.
>>>
>>>    def loop(self):
>>>        import time
>>>        m = utils.createMessage("toto", "hello")
>>>        while(True):
>>>            print "Sending %s" % m.toXml()
>>>            self.sendMessage(m)
>>>            print "Sent!"
>>>            time.sleep(2)
>>>
>>>
>>>threads.deferToThread(self.loop)
>>>
>>>the TCP no delay option is turned on like I said before, the weird thing 
>>>is that I have the same thing, all my msgs get sent in big blocks. Either 
>>>the TCP no delay doesn't work, or the reactor is getting tied up. I don' t 
>>>get it since I'm running the blocking code in a thread, the reactor should 
>>>have nothing to do.
>>
>>Since you didn't include the definition of `sendMessage?, it's hard to say
>>what's really going on here.  However, my guess is that you're calling the
>>transport.write method in a non-reactor thread, which is not allowed.
>>
>>If this isn't the case, including a full, minimal example in your next
>>message would be a good idea. :)
>>
>>Jean-Paul
>Yes, self.sendMessage() calls transport.write. So there's no way of sending 
>msgs from a non-reactor thread, even if it has a reference to the protocol?
>

There is a way.  The way is to use reactor.callFromThread to schedule a
function to be called in the reactor thread.

eg, reactor.callFromThread(self.sendMessage)

Jean-Paul



From radix at twistedmatrix.com  Mon Aug 11 14:31:03 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 11 Aug 2008 14:31:03 -0400
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <48A08283.2000200@arimaz.com>
References: <20080811173004.29191.220123618.divmod.quotient.13333@ohm>
	<48A08283.2000200@arimaz.com>
Message-ID: <60ed19d40808111131k50ffdd0v61edae6d272e97d5@mail.gmail.com>

On Mon, Aug 11, 2008 at 2:18 PM, Gabriel Rossetti
<gabriel.rossetti at arimaz.com> wrote:
> Jean-Paul Calderone wrote:
>>
>> Since you didn't include the definition of `sendMessage?, it's hard to say
>> what's really going on here.  However, my guess is that you're calling the
>> transport.write method in a non-reactor thread, which is not allowed.
>>
>> If this isn't the case, including a full, minimal example in your next
>> message would be a good idea. :)
>>
>> Jean-Paul
>>
>>
> Yes, self.sendMessage() calls transport.write. So there's no way of sending
> msgs from a non-reactor thread, even if it has a reference to the protocol?

use reactor.callFromThread, which takes as an argument a function to
call in the reactor thread. That function can use Twisted APIs like
transport.write. Most Twisted APIs are not thread-safe, and cannot be
called from a non-reactor thread.


-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/

From warner at lothar.com  Mon Aug 11 19:52:11 2008
From: warner at lothar.com (Brian Warner)
Date: Mon, 11 Aug 2008 16:52:11 -0700
Subject: [Twisted-Python] foolscap copyable and constraint
In-Reply-To: <20080809090217.GA8379@lemurdoc>
References: <20080809090217.GA8379@lemurdoc>
Message-ID: <20080811165211.112bf0b5@fluxx.allmydata.com>

> ciao! i'm playing a bit with foolscap and i try to use RemoteInterface
> to describe my constraint but i cannot understand how to use it with
> pass-by-copy. this is a small example:

My memory is a bit fuzzy, but I think Copyables aren't as mature as they
ought to be, and we don't yet have a way to express a constraint that allows
a Copyable as an argument. When I hit a need for this in Tahoe, I punted and
used an Any() (which just allows anything through).

There's a foolscap.copyable.AttributeDictConstraint, which can be used to
control what gets to go into the Copyable (store an instance of it in the
.stateSchema attribute of your RemoteCopy class, or provide it as the
stateSchema= argument to registerRemoteCopyFactory.. see
foolscap/test/test_copyable.py MyRemoteCopy4 for an example). It might be
used something like this (untested):

 label_constraint = copyable.AttributeDictConstraint( ("text", str) )
 registerRemoteCopyFactory("_Label", makeLabel, label_constraint)

But that doesn't get you the next-higher-level part.

>     class RITest(RemoteInterface):
>         def getLabel():
>             return Label

That's the desired syntax for this sort of constraint, but it doesn't work
yet. We could fix that.. the approach would be:

 1: create a CopyableConstraint class, inheriting from constraint.Constraint,
    and created with a Copyable subclass (or maybe a RemoteCopy subclass)
    1a: implement CopyableConstraint.checkObject(), somehow. If inbound=False
        then it should probably assert an isinstance(obj, myCopyableClass).
        If inbound=True, it should probably check against myRemoteCopyClass
        instead. checkObject() is used outbound before serialization, and
        inbound post-deserialization; i.e. it examines fully-formed objects
        rather than individual tokens.
 2: add code to schema.adapt_obj_to_iconstraint() (or register an adapter)
    that knows how to create a CopyableConstraint from a Copyable or
    RemoteCopy class.

There is a small design issue.. should the constraint reference the Copyable,
or the RemoteCopy? I.e. should your getLabel() interface method say "return
Label" or "return RemoteLabel"? It depends upon how you want to read the
RemoteInterface.. from the point of view of the sender, or that of the
receiver. My casual thought is to use the Copyable.

This makes more difference in constraints that specify pass-by-proxy objects:

 class RIRow(RemoteInterface):
   def get_value(): return int

 class RIDatabase(RemoteInterface)
   def get_row(rownum=int): return RIRow

where the question is: does the get_row() method return a Referenceable
(which gets turned into a RemoteReference by the time it gets to the remote
caller), or are we saying that it has to return a RemoteReference that is
hosted on the caller's side (such that it gets turned back into a local
Referenceable byt the time it gets to that caller). The former is a lot more
useful, but there might be situations where you want to express the latter,
so it would be nice if there were a syntax for it.

I don't remember if there is such a syntax right now, but my point is that
this sort of distinction doesn't show up with pass-by-copy objects like
Copyable. The caller always receives a RemoteCopy of some sort.


hope that helps,
 -Brian



From gabriel.rossetti at arimaz.com  Tue Aug 12 04:34:41 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 12 Aug 2008 10:34:41 +0200
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <20080811182231.29191.697604575.divmod.quotient.13337@ohm>
References: <20080811182231.29191.697604575.divmod.quotient.13337@ohm>
Message-ID: <48A14B21.5070201@arimaz.com>

Jean-Paul Calderone wrote:
> On Mon, 11 Aug 2008 20:18:43 +0200, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com> wrote:
>> Jean-Paul Calderone wrote:
>>> On Mon, 11 Aug 2008 19:13:56 +0200, Gabriel Rossetti 
>>> <gabriel.rossetti at arimaz.com> wrote:
>>>> Gabriel Rossetti wrote:
>>>>> Hello,
>>>>>
>>>>> I'm needing to send small packets to update a progress bar. My 
>>>>> update msgs were all being sent in big packets, so I tried setting 
>>>>> setTcpNoDelay() in connectionMade() but it doesn't change 
>>>>> anything, is it broken?
>>>>>
>>>>> Thank you,
>>>>> Gabriel
>>>> I an using code that I wrote using threads.deferToThread(), I 
>>>> wondered if it was blocking the reactor maybe, so I tried just 
>>>> using a plain deferToThread() call. Here's the code (without all 
>>>> the protocol stuff, it's executed when data come in.
>>>>
>>>>    def loop(self):
>>>>        import time
>>>>        m = utils.createMessage("toto", "hello")
>>>>        while(True):
>>>>            print "Sending %s" % m.toXml()
>>>>            self.sendMessage(m)
>>>>            print "Sent!"
>>>>            time.sleep(2)
>>>>
>>>>
>>>> threads.deferToThread(self.loop)
>>>>
>>>> the TCP no delay option is turned on like I said before, the weird 
>>>> thing is that I have the same thing, all my msgs get sent in big 
>>>> blocks. Either the TCP no delay doesn't work, or the reactor is 
>>>> getting tied up. I don' t get it since I'm running the blocking 
>>>> code in a thread, the reactor should have nothing to do.
>>>
>>> Since you didn't include the definition of `sendMessage?, it's hard 
>>> to say
>>> what's really going on here.  However, my guess is that you're 
>>> calling the
>>> transport.write method in a non-reactor thread, which is not allowed.
>>>
>>> If this isn't the case, including a full, minimal example in your next
>>> message would be a good idea. :)
>>>
>>> Jean-Paul
>> Yes, self.sendMessage() calls transport.write. So there's no way of 
>> sending msgs from a non-reactor thread, even if it has a reference to 
>> the protocol?
>>
>
> There is a way.  The way is to use reactor.callFromThread to schedule a
> function to be called in the reactor thread.
>
> eg, reactor.callFromThread(self.sendMessage)
>
> Jean-Paul
>
>
Thank you Jean-Paul & Christopher, I hadn't realized that. Now I 
understand better why in deferToThread() you use 
reactor.callFromThread() to add callbacks/errbacks. So if I understand, 
anything that uses twisted, that I'd need to call from a thread, needs 
to be called with reactor.callFromThread().

Gabriel



From stephan.jaeger at ewetel.de  Tue Aug 12 07:01:22 2008
From: stephan.jaeger at ewetel.de (Stephan Jaeger)
Date: Tue, 12 Aug 2008 13:01:22 +0200
Subject: [Twisted-Python] AsynQueue: return deferred from queued method
In-Reply-To: <48A06033.4010107@eepatents.com>
References: <1218464394.7686.19.camel@localhost>
	<48A06033.4010107@eepatents.com>
Message-ID: <1218538882.7686.29.camel@localhost>

Thanks for your answer Ed,

Am Montag, den 11.08.2008, 08:52 -0700 schrieb Ed Suominen:

> Just use a single implementer of IWorker that only accepts one 
> assignment at a time. The queue will not feed it its next task until the 
> deferred from its previous one has fired.

Would something like this be ok?

from zope.interface import implements
from asynqueue import IWorker

class DeferredWorker(object):
    
    implements(IWorker)
    cQualified = []
    
    def __init__(self):
        self.iQualified = []
        
    def run(self, task):
        self.task = task
        f, args, kw = task.callTuple
        d = f(*args, **kw)
        d.addCallbacks(task.callback, task.errback)
        return d

    def setResignator(self, callableObject):
        """
        There's nothing that would make me resign.
        """
        
    def stop(self):
        pass
    
    def crash(self):
        return self.task

At least it seems to do the job ;)


regards,

Stephan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Dies ist ein digital signierter Nachrichtenteil
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20080812/4fb2ec38/attachment.pgp 

From mattias.brandstrom at todos.se  Tue Aug 12 11:56:44 2008
From: mattias.brandstrom at todos.se (=?iso-8859-1?Q?Mattias_Br=E4ndstr=F6m?=)
Date: Tue, 12 Aug 2008 17:56:44 +0200
Subject: [Twisted-Python] (no subject)
Message-ID: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>

Hello!

Is there any way I can make twisted stop accepting connections for a short period of time and then start accepting connections? Something like reactor.pause()?

More precisely, what I want to do is to reread my server configuration on SIGHUP (or some other external event). If possible I would like to do this without locking a mutex when accessing (reading or modifying) the configuration info. I figure that reconfiguring the server will be a rare event. So if there is some way that I can:

1. Block incoming requests. Preferable keeping them in the connection queue.
2. Wait for all running requests to complete.
3. Reread the server configuration.
4. Unblock incoming requests. 

What do you think? Is there some simple twisted-way to do this?

If this has been covered in the past, please point me in that direction. :-)

Regards,
Mattias



From wzeller at cs.princeton.edu  Tue Aug 12 16:40:19 2008
From: wzeller at cs.princeton.edu (Bill Zeller)
Date: Tue, 12 Aug 2008 16:40:19 -0400
Subject: [Twisted-Python] twisted python conch SSH shell?
Message-ID: <74a0fd5f0808121340pdf0e46egd4dfb9b1c10cbaf4@mail.gmail.com>

Hi,

I've been playing around with Twisted's Conch client (which looks extremely
well done, thanks!). I've been able to connect to a conch server and also
connect to other ssh servers and execuate various commands. I'd like to be
able to connect to an arbitrary SSH server and run /bin/bash.

I'm able to execute a command like so:

---------------------
class CommandChannel(channel.SSHChannel):
    ....
    def channelOpen(self, data):
        self.conn.sendRequest(
            self, 'exec', common.NS(self.command),
wantReply=True).addCallback(
            self._gotResponse)
---------------------

Looking through the SSH spec (connect protocol, rfc4254), it looks like
shells are opened with this command.

---------------------

      byte      SSH_MSG_CHANNEL_REQUEST
      uint32    recipient channel
      string    "shell"
      boolean   want reply

---------------------

It doesn't look like Conch supports these requests (here's how
CHANNEL_REQUESTs are currently sent out)

---------------------
(Twisted-8.1.0)
twisted/conch/ssh/connection.py (413):
        self.transport.sendPacket(MSG_CHANNEL_REQUEST, struct.pack('>L',
                                    self.channelsToRemoteChannel[channel])
                                  + common.NS(requestType)+chr(wantReply)
                                  + data)
---------------------

I may be misunderstanding how remote shells are started, so any help would
be appreciated.

Again, I'm trying to launch an interactive /bin/bash shell from a Conch SSH
client on an arbitrary remote SSH server.

Thanks for your time.

Best Regards,
Bill Zeller
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080812/68837d32/attachment.htm 

From mattias.brandstrom at todos.se  Wed Aug 13 03:02:59 2008
From: mattias.brandstrom at todos.se (=?iso-8859-1?Q?Mattias_Br=E4ndstr=F6m?=)
Date: Wed, 13 Aug 2008 09:02:59 +0200
Subject: SV: [Twisted-Python] Temporarily blocking connections
In-Reply-To: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
References: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
Message-ID: <B48E5D5E8E1DDE4D816167B851EC44356AB9A9@exchange.mejl.ecode.se>

Ops. I missed the subject. This should make things a little crearer.

> -----Ursprungligt meddelande-----
> Fr?n: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-
> bounces at twistedmatrix.com] F?r Mattias Br?ndstr?m
> Skickat: den 12 augusti 2008 17:57
> Till: twisted-python at twistedmatrix.com
> ?mne: [Twisted-Python] (no subject)
> 
> Hello!
> 
> Is there any way I can make twisted stop accepting connections for a short
> period of time and then start accepting connections? Something like
> reactor.pause()?
> 
> More precisely, what I want to do is to reread my server configuration on
> SIGHUP (or some other external event). If possible I would like to do this
> without locking a mutex when accessing (reading or modifying) the
> configuration info. I figure that reconfiguring the server will be a rare
> event. So if there is some way that I can:
> 
> 1. Block incoming requests. Preferable keeping them in the connection
> queue.
> 2. Wait for all running requests to complete.
> 3. Reread the server configuration.
> 4. Unblock incoming requests.
> 
> What do you think? Is there some simple twisted-way to do this?
> 
> If this has been covered in the past, please point me in that direction.
> :-)
> 
> Regards,
> Mattias
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From Marcin.Kasperski at softax.com.pl  Wed Aug 13 13:47:53 2008
From: Marcin.Kasperski at softax.com.pl (Marcin Kasperski)
Date: Wed, 13 Aug 2008 19:47:53 +0200
Subject: [Twisted-Python] raw deferreds vs deferredGenerator vs
	inlineCallbacks
Message-ID: <87vdy4q01i.fsf@softax.com.pl>


I wrote a short example comparing the 3. Prepared it mostly for
myself, but maybe it will be of some use for somebody:

http://blog.mekk.waw.pl/archives/14-Twisted-inlineCallbacks-and-deferredGenerator.html

PS Crucial function:
  raw deferreds     - 29 non-empty lines of code, 
  deferredGenerator - 26 lines,
  inlineCallbacks   - 17 lines


-- 
----------------------------------------------------------------------
| Marcin Kasperski   | Systems built by humans are always subject
| http://mekk.waw.pl |          to human error. (Parnas)
|                    |
----------------------------------------------------------------------




From exarkun at divmod.com  Wed Aug 13 13:57:34 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 13 Aug 2008 13:57:34 -0400
Subject: [Twisted-Python] raw deferreds vs deferredGenerator vs
	inlineCallbacks
In-Reply-To: <87vdy4q01i.fsf@softax.com.pl>
Message-ID: <20080813175734.29191.321513541.divmod.quotient.13941@ohm>

On Wed, 13 Aug 2008 19:47:53 +0200, Marcin Kasperski <marcin.kasperski at softax.com.pl> wrote:
>
>I wrote a short example comparing the 3. Prepared it mostly for
>myself, but maybe it will be of some use for somebody:
>
>http://blog.mekk.waw.pl/archives/14-Twisted-inlineCallbacks-and-deferredGenerator.html
>
>PS Crucial function:
>  raw deferreds     - 29 non-empty lines of code,
>  deferredGenerator - 26 lines,
>  inlineCallbacks   - 17 lines
>

Nice comparison.  A more idiomatic rendering of the "raw deferred"
example might look like this, though:

  def lookup(country, search_term):
      query = "http://www.google.%s/search?q=%s" % (country,search_term)
      d = getPage(query)
      def cbFirstPage(content, country):
          m = re.search('<div id="?res.*?href="(?P<url>http://[^"]+)"',
                        content, re.DOTALL)
          if not m:
              return None
          url = m.group('url')
          d = getPage(url)
          def cbSecondPage(content, country, url):
              m = re.search("<title>(.*?)</title>", content)
              if m:
                  title = m.group(1)
                  return dict(url = url, title = title)
              else:
                  return dict(url=url, title="<not-specified>")
          d.addCallback(cbSecondPage, country, url)
          return d
      d.addCallback(cbGotPage, country)
      def ebGeneric(err, country):
          print ".%s FAILED: %s" % (country, str(e))
      d.addErrback(ebGeneric, country)
      return d

Converting any failure into a print and a None result is a bit strange,
but it's the same thing your other two examples did so I preserved that
behavior.

Jean-Paul



From Marcin.Kasperski at softax.com.pl  Wed Aug 13 14:28:24 2008
From: Marcin.Kasperski at softax.com.pl (Marcin Kasperski)
Date: Wed, 13 Aug 2008 20:28:24 +0200
Subject: [Twisted-Python] Re: raw deferreds vs deferredGenerator vs
	inlineCallbacks
References: <87vdy4q01i.fsf@softax.com.pl>
	<20080813175734.29191.321513541.divmod.quotient.13941@ohm>
Message-ID: <87r68spy5z.fsf@softax.com.pl>

> Nice comparison.  A more idiomatic rendering of the "raw deferred"
> example might look like this, though:
> (...)

Hmm, I'd be glad to add this to the article in a way or another,
would you mind it?

(btw, I find my "raw" example more readable, but this is likely a
matter of taste...)

> Converting any failure into a print and a None result is a bit strange,

Just wanted to do something illustrating error handling





From exarkun at divmod.com  Wed Aug 13 14:54:25 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 13 Aug 2008 14:54:25 -0400
Subject: [Twisted-Python] Re: raw deferreds vs deferredGenerator vs
	inlineCallbacks
In-Reply-To: <87r68spy5z.fsf@softax.com.pl>
Message-ID: <20080813185425.29191.1762423683.divmod.quotient.13969@ohm>

On Wed, 13 Aug 2008 20:28:24 +0200, Marcin Kasperski <marcin.kasperski at softax.com.pl> wrote:
>> Nice comparison.  A more idiomatic rendering of the "raw deferred"
>> example might look like this, though:
>> (...)
>
>Hmm, I'd be glad to add this to the article in a way or another,
>would you mind it?
>

Sure, that's fine with me.

Jean-Paul



From glyph at divmod.com  Wed Aug 13 15:15:30 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Wed, 13 Aug 2008 19:15:30 -0000
Subject: [Twisted-Python] raw deferreds vs deferredGenerator vs
	inlineCallbacks
In-Reply-To: <87vdy4q01i.fsf@softax.com.pl>
References: <87vdy4q01i.fsf@softax.com.pl>
Message-ID: <20080813191530.25821.682106228.divmod.xquotient.14218@joule.divmod.com>


On 05:47 pm, marcin.kasperski at softax.com.pl wrote:
>I wrote a short example comparing the 3. Prepared it mostly for
>myself, but maybe it will be of some use for somebody:

Thanks for writing this up!  It always makes me happy to see the 
ecosystem around Twisted developing, people blogging about stuff like 
this.  Makes it feel like a real project.

Of course it would make it feel even more like a real project if you 
could be convinced to contribute to the official documentation :). 
There's no mention of inlineCallbacks in the official documentation (the 
stuff in doc/) at all, and it would be helpful to have at least an 
overview.



From f.ingram.lists at gmail.com  Thu Aug 14 07:26:46 2008
From: f.ingram.lists at gmail.com (Felix Ingram)
Date: Thu, 14 Aug 2008 12:26:46 +0100
Subject: [Twisted-Python] HTTP CONNECT support
Message-ID: <41beb4dc0808140426g42c45025y2f75a0d41d0ae373@mail.gmail.com>

Hello all,

I posted the following to the web mailing list but on second thoughts
I think that it's kinda a problem with my understanding of the other
parts of the framework, so I'm reposting it here. I'd appreciate any
pointers. It's a bit lengthy, so apologies for that.



I'm looking into adding HTTPS support to the proxy module for some
testing I'm doing. I'd like to be able to trap requests and responses
as they go to and from the server, so proper CONNECT support is not
really what I'm aiming for. I've come up with the following:

"""
from twisted.web import proxy, http
from twisted.internet import reactor, ssl
from twisted.python import log
import sys
import urlparse

from OpenSSL import SSL as OSSL

class MyProxyClient(proxy.ProxyClient):

   def handleEndHeaders(self):
       print "THOSE HEADERS DONE ENDED"
       self.father.transport.write("\r\n")

   def handleResponsePart(self, buffer):
       print "GOT SOME STUFF TO SEND TO THE BROWSER"
       self.father.transport.write(buffer)

   def dataReceived(self, data):
       print "To the Browser"
       print data # Data sent to the browser
       proxy.ProxyClient.dataReceived(self, data)

   def handleResponseEnd(self):
       print "losing connection..."
       self.transport.loseConnection()
       self.father.channel.transport.loseConnection()


class MyProxyClientFactory(proxy.ProxyClientFactory):
   def buildProtocol(self, addr):
       client = proxy.ProxyClientFactory.buildProtocol(self, addr)
       client.__class__ = MyProxyClient
       return client

class MySSLContext(ssl.ContextFactory):
   def getContext(self):
       ctx = OSSL.Context(OSSL.SSLv23_METHOD)
       ctx.use_certificate_file('server.cert')
       ctx.use_privatekey_file('server.pkey')
       return ctx

class MyProxyRequest(proxy.ProxyRequest):
   protocols = {
           'http': MyProxyClientFactory,
           'https': MyProxyClientFactory
           }
   ports = {
           'http': 80,
           'https': 443
           }

   def requestDone(self, request):
       """Called by first request in queue when it is done."""
       print "REQUESTDONE DONE BE CALLED"
       if request != self.requests[0]: raise TypeError
       del self.requests[0]

       if self.persistent:
           # notify next request it can start writing
           if self.requests:
               self.requests[0].noLongerQueued()
           else:
               if self._savedTimeOut:
                   self.setTimeout(self._savedTimeOut)
       else:
           print "lOSING CONNECTION"
           self.transport.loseConnection()

   def process(self):
       parsed = urlparse.urlparse(self.uri)
       protocol = parsed.scheme
       host = parsed.hostname
       doSSL = False
       if self.method.upper() == "CONNECT":
           self.transport.write("HTTP/1.1 200 Connection established\r\n\r\n")
           self.transport.startTLS(MySSLContext())
           protocol = "https"
           self.host = parsed.scheme
           print "finished connect request"
       else:
           if self.isSecure():
               headers = self.getAllHeaders().copy()
               host = headers["host"]
               protocol = "https"
               doSSL = True
           port = self.ports[protocol]
           if ':' in host:
               host, port = host.split(':')
               port = int(port)
           rest = urlparse.urlunparse(('', '') + parsed[2:])
           if not rest:
               rest = rest + '/'
           class_ = self.protocols[protocol]
           headers = self.getAllHeaders().copy()
           if 'host' not in headers:
               headers['host'] = host
           self.content.seek(0, 0)
           s = self.content.read()
           clientFactory = class_(self.method, rest, self.clientproto, headers,
                           s, self)
           if not doSSL:
               self.reactor.connectTCP(host, port, clientFactory)
           else:
               print "Connecting to SSL"
               self.reactor.connectSSL(host, port, clientFactory,
ssl.ClientContextFactory())

class MyProxy(proxy.Proxy):
   def dataReceived(self, data):
       print "To the Server"
       print data # Data sent to the server
       proxy.Proxy.dataReceived(self, data)

   def requestFactory(self, *args):
       return MyProxyRequest(*args)

class ProxyFactory(http.HTTPFactory):
       protocol = MyProxy

reactor.listenTCP(8081, ProxyFactory())
log.startLogging(sys.stdout) # Log to the console
reactor.run()
"""

Most of the magic is happening in the 'process' method. I've copied
some of the other methods in for debugging. At the moment it's a bit
hackish but it's almost working as expected. When a connect request is
received then the SSL connection is set up as required (using
transport.startTLS). This generates certificate mismatch errors in the
browser, but this is expected and is what I'm looking for as then I can read the
requests as they come through.
The GET request is then received from the browser and forwarded on to the
server. The server appears to be happy with this as it does pass the
appropriate response back to the proxy. For some reason, however, the
browser does not then get passed the response. Comparing identical
requests for the HTTP and HTTPS versions of a site show that the only
apparent difference is that the headers and body are sent in one go
under HTTP and as two separate chunks under HTTPS.

E.g. HTTPS:
"""
2008-08-07 15:34:15+0100 [MyProxyClient,client] To the Browser
2008-08-07 15:34:15+0100 [MyProxyClient,client] HTTP/1.1 200 OK
2008-08-07 15:34:15+0100 [MyProxyClient,client] Date: Thu, 07 Aug 2008
14:34:15 GMT
2008-08-07 15:34:15+0100 [MyProxyClient,client] Server: Apache/2.2.9
(Win32) DAV/2 mod_ssl/2.2.9 Ope
nSSL/0.9.8h mod_autoindex_color PHP/5.2.6
2008-08-07 15:34:15+0100 [MyProxyClient,client] X-Powered-By: PHP/5.2.6
2008-08-07 15:34:15+0100 [MyProxyClient,client] Content-Length: 1325
2008-08-07 15:34:15+0100 [MyProxyClient,client] Connection: close
2008-08-07 15:34:15+0100 [MyProxyClient,client] Content-Type: text/html
2008-08-07 15:34:15+0100 [MyProxyClient,client]
2008-08-07 15:34:15+0100 [MyProxyClient,client]
2008-08-07 15:34:15+0100 [MyProxyClient,client] THOSE HEADERS DONE ENDED
2008-08-07 15:34:15+0100 [MyProxyClient,client] To the Browser
2008-08-07 15:34:15+0100 [MyProxyClient,client] <html>
2008-08-07 15:34:15+0100 [MyProxyClient,client] <head><title>XAMPP</title>
2008-08-07 15:34:15+0100 [MyProxyClient,client] <link href="xampp.css"
rel="stylesheet" type="text/c
...
"""

HTTP:
"""
2008-08-07 15:34:01+0100 [MyProxyClient,client] To the Browser
2008-08-07 15:34:01+0100 [MyProxyClient,client] HTTP/1.1 200 OK
2008-08-07 15:34:01+0100 [MyProxyClient,client] Date: Thu, 07 Aug 2008
14:34:01 GMT
2008-08-07 15:34:01+0100 [MyProxyClient,client] Server: Apache/2.2.9
(Win32) DAV/2 mod_ssl/2.2.9 Ope
nSSL/0.9.8h mod_autoindex_color PHP/5.2.6
2008-08-07 15:34:01+0100 [MyProxyClient,client] X-Powered-By: PHP/5.2.6
2008-08-07 15:34:01+0100 [MyProxyClient,client] Content-Length: 1325
2008-08-07 15:34:01+0100 [MyProxyClient,client] Connection: close
2008-08-07 15:34:01+0100 [MyProxyClient,client] Content-Type: text/html
2008-08-07 15:34:01+0100 [MyProxyClient,client]
2008-08-07 15:34:01+0100 [MyProxyClient,client] <html>
2008-08-07 15:34:01+0100 [MyProxyClient,client] <head><title>XAMPP</title>
2008-08-07 15:34:01+0100 [MyProxyClient,client] <link href="xampp.css"
rel="stylesheet" type="text/c
"""

The HTTPS version seems to have an extra line feed being added after
the headers, which may be causing the problem. I've tried stripping
this out but then I get some other exception being thrown and HTTP
traffic stops working.

I've got a feeling that I'm not quite going about this in the correct
way but I'd appreciate any help or insights that anyone could offer.
If you need any more details then please ask.

Many thanks in advance,

Felix



From lasizoillo at gmail.com  Fri Aug 15 12:21:56 2008
From: lasizoillo at gmail.com (lasizoillo)
Date: Fri, 15 Aug 2008 18:21:56 +0200
Subject: [Twisted-Python] (no subject)
In-Reply-To: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
References: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
Message-ID: <49414f570808150921v166a81f9mbaae63ef25bbd77b@mail.gmail.com>

Hello

2008/8/12 Mattias Br?ndstr?m <mattias.brandstrom at todos.se>:
> Hello!
>
> Is there any way I can make twisted stop accepting connections for a short period of time and then start accepting connections? Something like reactor.pause()?
>
> More precisely, what I want to do is to reread my server configuration on SIGHUP (or some other external event). If possible I would like to do this without locking a mutex when accessing (reading or modifying) the configuration info. I figure that reconfiguring the server will be a rare event. So if there is some way that I can:
>
> 1. Block incoming requests. Preferable keeping them in the connection queue.
> 2. Wait for all running requests to complete.
> 3. Reread the server configuration.
> 4. Unblock incoming requests.
>
> What do you think? Is there some simple twisted-way to do this?
>
It's really necesary do that?

1 Your app have a reference to a object whith the loaded config
2 A defered take a reference to these object
3 A reread event change the app config reference to new loaded config
object. Old defered no change his reference and end whith old config.
4 New defereds take new config and reference that.
5 When old config object have not references is garbaged collected.

No blocking operation is nedded if you can load 2 configuration
objects in memory (the old one for connections in progress and the new
one).

Excuse my poor english.

Regards,

Javi

> If this has been covered in the past, please point me in that direction. :-)
>
> Regards,
> Mattias
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From lasizoillo at gmail.com  Fri Aug 15 21:51:51 2008
From: lasizoillo at gmail.com (lasizoillo)
Date: Sat, 16 Aug 2008 03:51:51 +0200
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <489A013D.4000807@mit.edu>
References: <489A013D.4000807@mit.edu>
Message-ID: <49414f570808151851n3915d3aei9bba811ff818b4c6@mail.gmail.com>

2008/8/6 Nadav Aharony <nadav at mit.edu>:
> (forwarding for Daniel who had some list posting trouble)
>
> Hi all-
> I'd like to use Twisted to manage bluetooth communication. I haven't
> found any existing method for doing this, so I'd like to write and
> implement a new reactor interface (on par with TCP/UDP) that wraps the
> lightblue library. What's the right way to go about extending Twisted in
> this way?
> Thanks,
> Daniel

I recently discovered elisa. A media center implemented with twisted python.
Elisa have a bluetoth plugin than use py-bluez (other bt library). The
code is here:

http://bazaar.launchpad.net/~elisa-developers/elisa/upicek/annotate/11.5.55?filter_file_id=bluetooth_input.py-20080401102113-vcj3p4systzzapcn-411&file_id=bluetooth_input.py-20080401102113-vcj3p4systzzapcn-411

I don't know if it is useful for you.

Regards,

Javi



From pbastov at gmail.com  Sat Aug 16 07:57:47 2008
From: pbastov at gmail.com (Pavel)
Date: Sat, 16 Aug 2008 17:57:47 +0600
Subject: [Twisted-Python] Disable twisted web logging
Message-ID: <eaf39e680808160457q6449dcf9w28016376564cc0fb@mail.gmail.com>

My Twisted server is listening on two ports: 80 for processing http
requrests and xxx for
processing tcp requests from clients.

http logs seem to clutter my log file. Is there any way to disable
http logs only and leave
logging facility otherwise intact? Or at least redirect http logs to a
different file?

Thanks in advance.

-- 
Good luck,

Pavel Bastov



From thenoob06 at gmail.com  Sat Aug 16 08:04:22 2008
From: thenoob06 at gmail.com (The Noob)
Date: Sat, 16 Aug 2008 14:04:22 +0200
Subject: [Twisted-Python] Execute interactive commands with a custom ssh
	shell
Message-ID: <9263743c0808160504m1bf01afbiff248d7899c4f8dc@mail.gmail.com>

Hello all,
I try to implement a custom ssh server with twisted . I use* sshserver.py to
begin (* http://www.devshed.com/c/a/Python/SSH-with-Twisted/ )
I would like to execute interactive scripts which are on my server. The
problem is theses scripts are interactives. How can I redirect IO on my
shell ?
For example, if I want to install a software with apt. I have questions to
install dependencies ( yes/no)
I start to create a definition for this function like def do_apt. And then
when in my custom shell I execute ( apt python)., that executes apt-get
install python on the server. But how can I redirect the output in my shell
to answer dependencies questions ?
Thanks for your help

Best Regards
The Noob06
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080816/8e3eeadb/attachment.htm 

From exarkun at divmod.com  Sat Aug 16 08:05:58 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 16 Aug 2008 08:05:58 -0400
Subject: [Twisted-Python] Disable twisted web logging
In-Reply-To: <eaf39e680808160457q6449dcf9w28016376564cc0fb@mail.gmail.com>
Message-ID: <20080816120558.29191.1320366514.divmod.quotient.15176@ohm>

On Sat, 16 Aug 2008 17:57:47 +0600, Pavel <pbastov at gmail.com> wrote:
>My Twisted server is listening on two ports: 80 for processing http
>requrests and xxx for
>processing tcp requests from clients.
>
>http logs seem to clutter my log file. Is there any way to disable
>http logs only and leave
>logging facility otherwise intact? Or at least redirect http logs to a
>different file?

If you pass a filename for the `logPath? parameter to `Site?, request
logs will be written to that file instead of to the main log.

Jean-Paul



From exarkun at divmod.com  Sat Aug 16 08:14:41 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 16 Aug 2008 08:14:41 -0400
Subject: [Twisted-Python] Execute interactive commands with a custom ssh
	shell
In-Reply-To: <9263743c0808160504m1bf01afbiff248d7899c4f8dc@mail.gmail.com>
Message-ID: <20080816121441.29191.2037211177.divmod.quotient.15180@ohm>

On Sat, 16 Aug 2008 14:04:22 +0200, The Noob <thenoob06 at gmail.com> wrote:
>Hello all,
>I try to implement a custom ssh server with twisted . I use* sshserver.py to
>begin (* http://www.devshed.com/c/a/Python/SSH-with-Twisted/ )
>I would like to execute interactive scripts which are on my server. The
>problem is theses scripts are interactives. How can I redirect IO on my
>shell ?
>For example, if I want to install a software with apt. I have questions to
>install dependencies ( yes/no)
>I start to create a definition for this function like def do_apt. And then
>when in my custom shell I execute ( apt python)., that executes apt-get
>install python on the server. But how can I redirect the output in my shell
>to answer dependencies questions ?
>Thanks for your help

To run a program like apt, you must be using `reactor.spawnProcess?.  That
means that you have two different protocol implementations.  One to talk
to the SSH connection (eg, `SSHDemoProtocol? in the O'Reilly example) and
one to talk to the child process.

If you want output from the child process to show up in the SSH client, then
when the process protocol receives data from it, it should pass it on to the
SSH protocol to write to the client.  Similarly, if you want input from the
SSH client written to the stdin of the child process, when the SSH protocol
receives data it should pass it on to the process protocol to write to the
child process.

You'll have to keep track of what state your application is in to do this
correctly.  Input should only be handled this way when there is actually
a child process running.

Jean-Paul



From thenoob06 at gmail.com  Sat Aug 16 14:06:48 2008
From: thenoob06 at gmail.com (The Noob)
Date: Sat, 16 Aug 2008 20:06:48 +0200
Subject: [Twisted-Python] Execute interactive commands with a custom ssh
	shell
In-Reply-To: <20080816121441.29191.2037211177.divmod.quotient.15180@ohm>
References: <9263743c0808160504m1bf01afbiff248d7899c4f8dc@mail.gmail.com>
	<20080816121441.29191.2037211177.divmod.quotient.15180@ohm>
Message-ID: <9263743c0808161106q6a45b4adx24b978146ed82213@mail.gmail.com>

Thanks very much Jean-Paul for your answer.
I will try to implement reactor.spawnProcess with this example.
Best Regards
TheNoob06

2008/8/16 Jean-Paul Calderone <exarkun at divmod.com>

> On Sat, 16 Aug 2008 14:04:22 +0200, The Noob <thenoob06 at gmail.com> wrote:
>
>> Hello all,
>> I try to implement a custom ssh server with twisted . I use* sshserver.py
>> to
>> begin (* http://www.devshed.com/c/a/Python/SSH-with-Twisted/ )
>> I would like to execute interactive scripts which are on my server. The
>> problem is theses scripts are interactives. How can I redirect IO on my
>> shell ?
>> For example, if I want to install a software with apt. I have questions to
>> install dependencies ( yes/no)
>> I start to create a definition for this function like def do_apt. And then
>> when in my custom shell I execute ( apt python)., that executes apt-get
>> install python on the server. But how can I redirect the output in my
>> shell
>> to answer dependencies questions ?
>> Thanks for your help
>>
>
> To run a program like apt, you must be using `reactor.spawnProcess?.  That
> means that you have two different protocol implementations.  One to talk
> to the SSH connection (eg, `SSHDemoProtocol? in the O'Reilly example) and
> one to talk to the child process.
>
> If you want output from the child process to show up in the SSH client,
> then
> when the process protocol receives data from it, it should pass it on to
> the
> SSH protocol to write to the client.  Similarly, if you want input from the
> SSH client written to the stdin of the child process, when the SSH protocol
> receives data it should pass it on to the process protocol to write to the
> child process.
>
> You'll have to keep track of what state your application is in to do this
> correctly.  Input should only be handled this way when there is actually
> a child process running.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080816/190153b9/attachment.htm 

From exarkun at twistedmatrix.com  Sun Aug 17 00:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 17 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1218945909.18.339001850@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080817/6222529e/attachment.htm 

From pbastov at gmail.com  Mon Aug 18 00:12:14 2008
From: pbastov at gmail.com (Pavel)
Date: Mon, 18 Aug 2008 10:12:14 +0600
Subject: [Twisted-Python] Disable twisted web logging
In-Reply-To: <20080816120558.29191.1320366514.divmod.quotient.15176@ohm>
References: <eaf39e680808160457q6449dcf9w28016376564cc0fb@mail.gmail.com>
	<20080816120558.29191.1320366514.divmod.quotient.15176@ohm>
Message-ID: <eaf39e680808172112l38b90ec2g21ab6c0af8e5d0d8@mail.gmail.com>

Thanks a lot!

Will implement it.

On Sat, Aug 16, 2008 at 6:05 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Sat, 16 Aug 2008 17:57:47 +0600, Pavel <pbastov at gmail.com> wrote:
>>
>> My Twisted server is listening on two ports: 80 for processing http
>> requrests and xxx for
>> processing tcp requests from clients.
>>
>> http logs seem to clutter my log file. Is there any way to disable
>> http logs only and leave
>> logging facility otherwise intact? Or at least redirect http logs to a
>> different file?
>
> If you pass a filename for the `logPath? parameter to `Site?, request
> logs will be written to that file instead of to the main log.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Good luck,

Pavel Bastov
xooChat Team Leader
http://www.xoochat.com/



From newptcai at gmail.com  Mon Aug 18 00:29:46 2008
From: newptcai at gmail.com (Peter Cai)
Date: Mon, 18 Aug 2008 12:29:46 +0800
Subject: [Twisted-Python] Is there any similar programming framework like
	twsited in C/C++ world.
Message-ID: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>

Hi all,

In my opinion, I like twisted very much but my coworkers are all quite
unfamiliar with Python.  And also we are afraid of source code leak problem.

So, can you remember some similar framework in C/C++ world?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080818/47f108f0/attachment.htm 

From glyph at divmod.com  Mon Aug 18 01:56:19 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Mon, 18 Aug 2008 05:56:19 -0000
Subject: [Twisted-Python] Is there any similar programming framework like
	twsited in C/C++ world.
In-Reply-To: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>
References: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>
Message-ID: <20080818055619.25821.1541633807.divmod.xquotient.14370@joule.divmod.com>

On 04:29 am, newptcai at gmail.com wrote:
>So, can you remember some similar framework in C/C++ world?

You might want to try ACE: http://www.cs.wustl.edu/~schmidt/ACE.html
>In my opinion, I like twisted very much but my coworkers are all quite
>unfamiliar with Python.

Understandable, but it might be worthwhile to learn.  Python can be a 
much more productive language than C++.
>And also we are afraid of source code leak problem.

If your users are savvy enough to extract Python source code from a 
trivially obfuscated executable, they are probably savvy enough to 
extract the information they want by decompiling your C++ binaries too. 
There are a lot of people who are really very skilled at this.  You 
should not assume that just because you are using C or C++, your source 
code is safe.



From jakamkon at gmail.com  Mon Aug 18 02:54:48 2008
From: jakamkon at gmail.com (Kuba Konczyk)
Date: Mon, 18 Aug 2008 07:54:48 +0100
Subject: [Twisted-Python] Is there any similar programming framework like
	twsited in C/C++ world.
In-Reply-To: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>
References: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>
Message-ID: <48A91CB8.9040100@gmail.com>

Peter Cai wrote:
>
> So, can you remember some similar framework in C/C++ world?
You can have a look at libevent - http://www.monkey.org/~provos/libevent/



From gabriel.rossetti at arimaz.com  Mon Aug 18 06:11:33 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 18 Aug 2008 12:11:33 +0200
Subject: [Twisted-Python] wxPython integration & msg sending from the GUI
Message-ID: <48A94AD5.5010601@arimaz.com>

Hello everyone,

when using wxPython integration, if my GUI wants to send msgs, do I need 
to schedule the msg sending through the reactor like is needed when 
using non-reactor threads (see my post who's subject is "does 
setTcpNoDelay() not work?"), like :

    reactor.callFromThread(srv.sendMessage, "my msg")


or can I directly call it like :

    srv.sendMessage(my msg")

? I followed the wx integration tutorial on the Twisted homepage. I 
guess my question is more like : "Does the wxPython integration make it 
run in the reactor thread or not".

Thank you,
Gabriel




From mattias.brandstrom at todos.se  Mon Aug 18 06:12:41 2008
From: mattias.brandstrom at todos.se (=?iso-8859-1?Q?Mattias_Br=E4ndstr=F6m?=)
Date: Mon, 18 Aug 2008 12:12:41 +0200
Subject: SV: [Twisted-Python] Reloading server configuration.
In-Reply-To: <49414f570808150921v166a81f9mbaae63ef25bbd77b@mail.gmail.com>
References: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
	<49414f570808150921v166a81f9mbaae63ef25bbd77b@mail.gmail.com>
Message-ID: <B48E5D5E8E1DDE4D816167B851EC44356ABA5A@exchange.mejl.ecode.se>

> -----Ursprungligt meddelande-----
> Fr?n: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-
> bounces at twistedmatrix.com] F?r lasizoillo
> Skickat: den 15 augusti 2008 18:22
> Till: Twisted general discussion
> ?mne: Re: [Twisted-Python] (no subject)
> 
> Hello
> 
> 2008/8/12 Mattias Br?ndstr?m <mattias.brandstrom at todos.se>:
> > Hello!
> >
> > Is there any way I can make twisted stop accepting connections for a
> short period of time and then start accepting connections? Something like
> reactor.pause()?
> >
> > More precisely, what I want to do is to reread my server configuration
> on SIGHUP (or some other external event). If possible I would like to do
> this without locking a mutex when accessing (reading or modifying) the
> configuration info. I figure that reconfiguring the server will be a rare
> event. So if there is some way that I can:
> >
> > 1. Block incoming requests. Preferable keeping them in the connection
> queue.
> > 2. Wait for all running requests to complete.
> > 3. Reread the server configuration.
> > 4. Unblock incoming requests.
> >
> > What do you think? Is there some simple twisted-way to do this?
> >
> It's really necesary do that?
> 
> 1 Your app have a reference to a object whith the loaded config
> 2 A defered take a reference to these object
> 3 A reread event change the app config reference to new loaded config
> object. Old defered no change his reference and end whith old config.
> 4 New defereds take new config and reference that.
> 5 When old config object have not references is garbaged collected.
> 
> No blocking operation is nedded if you can load 2 configuration
> objects in memory (the old one for connections in progress and the new
> one).
> 

OK. This seems like a good approach. However, I am using twisted.web.server.Site as my factory and the resources tied to my Site instance are the ones that need to access the server configuration. How would I go about giving each request its own configuration reference in this case? I'm quite new to twisted and it's not entirely clear to me how to achieve this. :-)

:.:: mattias



From itamar at itamarst.org  Mon Aug 18 08:36:54 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 18 Aug 2008 12:36:54 +0000
Subject: [Twisted-Python] wxPython integration & msg sending from the GUI
In-Reply-To: <48A94AD5.5010601@arimaz.com>
References: <48A94AD5.5010601@arimaz.com>
Message-ID: <1219063014.5308.183.camel@localhost.localdomain>

On Mon, 2008-08-18 at 12:11 +0200, Gabriel Rossetti wrote:

> or can I directly call it like :
> 
>     srv.sendMessage(my msg")
> 

You can do that, yes.

> ? I followed the wx integration tutorial on the Twisted homepage. I 
> guess my question is more like : "Does the wxPython integration make it 
> run in the reactor thread or not".

wxreactor makes wx run in same thread as Twisted, yes (at least from
your point of view).




From psanchez at nortel.com  Mon Aug 18 18:14:02 2008
From: psanchez at nortel.com (Pedro Sanchez)
Date: Mon, 18 Aug 2008 18:14:02 -0400
Subject: [Twisted-Python] Twisted and D-BUS
Message-ID: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>

Hello,

I'd like to get your opinion on using the D-Bus within a twisted
application. Would the Python D-Bus binding at

http://dbus.freedesktop.org/doc/dbus-python/doc/tutorial.html

work with twisted? is there a recommended approach?

Thank you,

-- 
Pedro







From gabriel.rossetti at arimaz.com  Tue Aug 19 02:37:14 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 19 Aug 2008 08:37:14 +0200
Subject: [Twisted-Python] wxPython integration & msg sending from the GUI
In-Reply-To: <1219063014.5308.183.camel@localhost.localdomain>
References: <48A94AD5.5010601@arimaz.com>
	<1219063014.5308.183.camel@localhost.localdomain>
Message-ID: <48AA6A1A.6020806@arimaz.com>

Itamar Shtull-Trauring wrote:
> On Mon, 2008-08-18 at 12:11 +0200, Gabriel Rossetti wrote:
>
>   
>> or can I directly call it like :
>>
>>     srv.sendMessage(my msg")
>>
>>     
>
> You can do that, yes.
>
>   
Ok
>> ? I followed the wx integration tutorial on the Twisted homepage. I 
>> guess my question is more like : "Does the wxPython integration make it 
>> run in the reactor thread or not".
>>     
>
> wxreactor makes wx run in same thread as Twisted, yes (at least from
> your point of view).
>
>   
Ok, thank you!

Gabriel



From p.mayers at imperial.ac.uk  Tue Aug 19 06:13:52 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 19 Aug 2008 11:13:52 +0100
Subject: [Twisted-Python] Twisted tarball unreachable?
Message-ID: <48AA9CE0.5050006@imperial.ac.uk>

Following the link on the home page I get:

[nsg at buildsrv tarballs]$ wget 
http://tmrc.mit.edu/mirror/twisted/Twisted/8.1/Twisted-8.1.0.tar.bz2#md5=a575f29ead4cc02c54e9061d0e6ac7c3
--11:08:27-- 
http://tmrc.mit.edu/mirror/twisted/Twisted/8.1/Twisted-8.1.0.tar.bz2
Resolving tmrc.mit.edu... 18.150.1.81
Connecting to tmrc.mit.edu|18.150.1.81|:80... failed: Connection refused.

Anyone know where I can get the tarball from? Some googling didn't help...



From p.mayers at imperial.ac.uk  Tue Aug 19 06:19:05 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 19 Aug 2008 11:19:05 +0100
Subject: [Twisted-Python] Re: Twisted tarball unreachable?
In-Reply-To: <48AA9CE0.5050006@imperial.ac.uk>
References: <48AA9CE0.5050006@imperial.ac.uk>
Message-ID: <48AA9E19.8020401@imperial.ac.uk>

Phil Mayers wrote:
> Following the link on the home page I get:
> 
> [nsg at buildsrv tarballs]$ wget 
> http://tmrc.mit.edu/mirror/twisted/Twisted/8.1/Twisted-8.1.0.tar.bz2#md5=a575f29ead4cc02c54e9061d0e6ac7c3 
> 
> --11:08:27-- 
> http://tmrc.mit.edu/mirror/twisted/Twisted/8.1/Twisted-8.1.0.tar.bz2
> Resolving tmrc.mit.edu... 18.150.1.81
> Connecting to tmrc.mit.edu|18.150.1.81|:80... failed: Connection refused.
> 
> Anyone know where I can get the tarball from? Some googling didn't help...

Never mind, found it



From thostrup at gmail.com  Tue Aug 19 07:59:39 2008
From: thostrup at gmail.com (Henrik Thostrup Jensen)
Date: Tue, 19 Aug 2008 13:59:39 +0200
Subject: [Twisted-Python] Couched 0.1: CouchDB twisted client
Message-ID: <f33a4da20808190459g1b6cd1fav4ef720a7c526503f@mail.gmail.com>

Hi

I've written a small python/twisted client library for CouchDB.

It's mostly a toy, but it can be fetched from here:
http://www.cs.aau.dk/~htj/code/couched-0.1.tar.gz if anyone is interested.
License: MIT

I'm aware of paisley  (https://launchpad.net/paisley),
The main difference from paisley is that the connection and database
abstraction are separated.
Also couched does connection caching and uses web2 instead of web.
Currently paisley is more feature rich, but couched has slightly nicer error
handling.

-- 
- Henrik
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080819/03f5d32e/attachment.htm 

From newptcai at gmail.com  Tue Aug 19 08:08:19 2008
From: newptcai at gmail.com (Peter Cai)
Date: Tue, 19 Aug 2008 20:08:19 +0800
Subject: [Twisted-Python] Abouth threads in twisted.
Message-ID: <befee6d80808190508n7b0541c9ga2857cdbbf3b6e5a@mail.gmail.com>

Hi All,

QUESTION 1 : callFromThread
~~~~~~~~~~~~~~~~~~~~~~~~~~~

I found this code snippet in twisted manual book.
But I don't quite get it.

What does "run 'notThreadSafe(3)' in the event loop" means?

Does the reactor promise that all those "notThreadSafe" functions
be called one by one so they won't interfere each other?

#======================================

from twisted.internet import reactor

def notThreadSafe(x):
    """do something that isn't thread-safe"""
    # ...

def threadSafeScheduler():
    """Run in thread-safe manner."""

reactor.callFromThread(notThreadSafe, 3) # will run 'notThreadSafe(3)' in
the event loop

#======================================


QUESTION 2 : Integrated with a threaded 3rd party library.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
I have a C library which using a work threaded pool model.  It's interface
is like this.

    void runWorkAsyn(int args, void pcallbackfunc(int));

When runWorkAsyn is called, it dispatch work to a thread in its
own thread pool and call 'pcallbackfunc' in that thread when it's done.

I really got confused by how use this lib from twisted in a thread safe way.
If I use a python callback function as pcallbackfunc and touch the reactor
from it,
it might damage the event look as most twisted APIs are not thread safe.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080819/f7fc712f/attachment.htm 

From radix at twistedmatrix.com  Tue Aug 19 09:48:35 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 19 Aug 2008 09:48:35 -0400
Subject: [Twisted-Python] Twisted and D-BUS
In-Reply-To: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
References: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
Message-ID: <60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>

On Mon, Aug 18, 2008 at 6:14 PM, Pedro Sanchez <psanchez at nortel.com> wrote:
> Hello,
>
> I'd like to get your opinion on using the D-Bus within a twisted
> application. Would the Python D-Bus binding at
>
> http://dbus.freedesktop.org/doc/dbus-python/doc/tutorial.html
>
> work with twisted? is there a recommended approach?


Yes, it works. All you have to do is make sure you use the glib2 or
gtk2 Twisted reactor, and then make sure you use the glib/gobject
event loop integration from dbus-python.


-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/



From radix at twistedmatrix.com  Tue Aug 19 09:56:06 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 19 Aug 2008 09:56:06 -0400
Subject: [Twisted-Python] Twisted and D-BUS
In-Reply-To: <60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>
References: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
	<60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>
Message-ID: <60ed19d40808190656v2f284360yde10d40f8846a44f@mail.gmail.com>

On Tue, Aug 19, 2008 at 9:48 AM, Christopher Armstrong
<radix at twistedmatrix.com> wrote:
> On Mon, Aug 18, 2008 at 6:14 PM, Pedro Sanchez <psanchez at nortel.com> wrote:
>> Hello,
>>
>> I'd like to get your opinion on using the D-Bus within a twisted
>> application. Would the Python D-Bus binding at
>>
>> http://dbus.freedesktop.org/doc/dbus-python/doc/tutorial.html
>>
>> work with twisted? is there a recommended approach?
>
>
> Yes, it works. All you have to do is make sure you use the glib2 or
> gtk2 Twisted reactor, and then make sure you use the glib/gobject
> event loop integration from dbus-python.

Sorry, I have one more thing to add:

I pray that you only have to use recent versions of dbus and
dbus-python. If you have to maintain compatibility with older versions
(like those shipped with Ubuntu 6.06 or 7.04), may God have mercy on
your soul.

-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/



From psanchez at nortel.com  Tue Aug 19 11:38:56 2008
From: psanchez at nortel.com (Pedro Sanchez)
Date: Tue, 19 Aug 2008 11:38:56 -0400
Subject: [Twisted-Python] Twisted and D-BUS
In-Reply-To: <60ed19d40808190656v2f284360yde10d40f8846a44f@mail.gmail.com>
References: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
	<60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>
	<60ed19d40808190656v2f284360yde10d40f8846a44f@mail.gmail.com>
Message-ID: <1219160336.25911.35.camel@pcard0ze.ca.nortel.com>

On Tue, 2008-08-19 at 09:56 -0400, Christopher Armstrong wrote:
> On Tue, Aug 19, 2008 at 9:48 AM, Christopher Armstrong
> <radix at twistedmatrix.com> wrote:
> > On Mon, Aug 18, 2008 at 6:14 PM, Pedro Sanchez <psanchez at nortel.com> wrote:
> >> Hello,
> >>
> >> I'd like to get your opinion on using the D-Bus within a twisted
> >> application. Would the Python D-Bus binding at
> >>
> >> http://dbus.freedesktop.org/doc/dbus-python/doc/tutorial.html
> >>
> >> work with twisted? is there a recommended approach?
> >
> >
> > Yes, it works. All you have to do is make sure you use the glib2 or
> > gtk2 Twisted reactor, and then make sure you use the glib/gobject
> > event loop integration from dbus-python.
> 
> Sorry, I have one more thing to add:
> 
> I pray that you only have to use recent versions of dbus and
> dbus-python. If you have to maintain compatibility with older versions
> (like those shipped with Ubuntu 6.06 or 7.04), may God have mercy on
> your soul.
> 
Thanks for the advice. I will be using Ubuntu 8.04.1 as my development
platform with twisted 2.5. I hope this will be OK, or do I need to move
to the latest twisted 8.1?

Thanks,

-- 
Pedro





From itamar at itamarst.org  Tue Aug 19 11:58:56 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 19 Aug 2008 15:58:56 +0000
Subject: [Twisted-Python] Abouth threads in twisted.
In-Reply-To: <befee6d80808190508n7b0541c9ga2857cdbbf3b6e5a@mail.gmail.com>
References: <befee6d80808190508n7b0541c9ga2857cdbbf3b6e5a@mail.gmail.com>
Message-ID: <1219161536.5308.209.camel@localhost.localdomain>

On Tue, 2008-08-19 at 20:08 +0800, Peter Cai wrote:
> Hi All,
> 
> QUESTION 1 : callFromThread
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~
> 
> I found this code snippet in twisted manual book.  
> But I don't quite get it.
> 
> What does "run 'notThreadSafe(3)' in the event loop" means?
> 
> Does the reactor promise that all those "notThreadSafe" functions
> be called one by one so they won't interfere each other?

They will be called in main thread, the one where you did reactor.run()

> QUESTION 2 : Integrated with a threaded 3rd party library.
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> I have a C library which using a work threaded pool model.  It's
> interface is like this.
> 
>     void runWorkAsyn(int args, void pcallbackfunc(int));
> 
> When runWorkAsyn is called, it dispatch work to a thread in its 
> own thread pool and call 'pcallbackfunc' in that thread when it's
> done.
> 
> I really got confused by how use this lib from twisted in a thread
> safe way.
> If I use a python callback function as pcallbackfunc and touch the
> reactor from it,
> it might damage the event look as most twisted APIs are not thread
> safe.

Rather than passing in callable "doSomething" as callback, pass in:
"lambda *args: reactor.callFromThread(doSomething, *args)".





From radix at twistedmatrix.com  Tue Aug 19 12:58:17 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 19 Aug 2008 12:58:17 -0400
Subject: [Twisted-Python] Twisted and D-BUS
In-Reply-To: <1219160336.25911.35.camel@pcard0ze.ca.nortel.com>
References: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
	<60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>
	<60ed19d40808190656v2f284360yde10d40f8846a44f@mail.gmail.com>
	<1219160336.25911.35.camel@pcard0ze.ca.nortel.com>
Message-ID: <60ed19d40808190958w48d304ew815325cd0d7aa41c@mail.gmail.com>

On Tue, Aug 19, 2008 at 11:38 AM, Pedro Sanchez <psanchez at nortel.com> wrote:
> On Tue, 2008-08-19 at 09:56 -0400, Christopher Armstrong wrote:
>> Sorry, I have one more thing to add:
>>
>> I pray that you only have to use recent versions of dbus and
>> dbus-python. If you have to maintain compatibility with older versions
>> (like those shipped with Ubuntu 6.06 or 7.04), may God have mercy on
>> your soul.
>>
> Thanks for the advice. I will be using Ubuntu 8.04.1 as my development
> platform with twisted 2.5. I hope this will be OK, or do I need to move
> to the latest twisted 8.1?
>
> Thanks,

There's nothing in Twisted 8 that will specifically help with dbus
integration, as far as I know, but there are a number of other
improvements that may be interesting to you for other reasons. I
suggest you check out the release news

http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/NEWS%3Fformat%3Draw

That link contains release notes for 8.0 and 8.1, i.e., all changes since 2.5.


-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/



From newptcai at gmail.com  Tue Aug 19 21:05:59 2008
From: newptcai at gmail.com (Peter Cai)
Date: Wed, 20 Aug 2008 09:05:59 +0800
Subject: [Twisted-Python] Abouth threads in twisted.
In-Reply-To: <1219161536.5308.209.camel@localhost.localdomain>
References: <befee6d80808190508n7b0541c9ga2857cdbbf3b6e5a@mail.gmail.com>
	<1219161536.5308.209.camel@localhost.localdomain>
Message-ID: <befee6d80808191805x3647f523jd51388a15b506f6b@mail.gmail.com>

Thanks for your reply!  But I think I have to read some source code
 of twisted to make sure what was happening behind callFromThread.

On Tue, Aug 19, 2008 at 11:58 PM, Itamar Shtull-Trauring <
itamar at itamarst.org> wrote:

> On Tue, 2008-08-19 at 20:08 +0800, Peter Cai wrote:
> > Hi All,
> >
> > QUESTION 1 : callFromThread
> > ~~~~~~~~~~~~~~~~~~~~~~~~~~~
> >
> > I found this code snippet in twisted manual book.
> > But I don't quite get it.
> >
> > What does "run 'notThreadSafe(3)' in the event loop" means?
> >
> > Does the reactor promise that all those "notThreadSafe" functions
> > be called one by one so they won't interfere each other?
>
> They will be called in main thread, the one where you did reactor.run()
>
> > QUESTION 2 : Integrated with a threaded 3rd party library.
> > ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > I have a C library which using a work threaded pool model.  It's
> > interface is like this.
> >
> >     void runWorkAsyn(int args, void pcallbackfunc(int));
> >
> > When runWorkAsyn is called, it dispatch work to a thread in its
> > own thread pool and call 'pcallbackfunc' in that thread when it's
> > done.
> >
> > I really got confused by how use this lib from twisted in a thread
> > safe way.
> > If I use a python callback function as pcallbackfunc and touch the
> > reactor from it,
> > it might damage the event look as most twisted APIs are not thread
> > safe.
>
> Rather than passing in callable "doSomething" as callback, pass in:
> "lambda *args: reactor.callFromThread(doSomething, *args)".
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
??????????????????????????????????????????????????????????????????????????????????????????
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080820/d806ef5c/attachment.htm 

From elicriffield at gmail.com  Wed Aug 20 22:13:24 2008
From: elicriffield at gmail.com (Eli Criffield)
Date: Wed, 20 Aug 2008 21:13:24 -0500
Subject: [Twisted-Python] twisted python conch SSH shell?
In-Reply-To: <74a0fd5f0808121340pdf0e46egd4dfb9b1c10cbaf4@mail.gmail.com>
References: <74a0fd5f0808121340pdf0e46egd4dfb9b1c10cbaf4@mail.gmail.com>
Message-ID: <18e3f33d0808201913l17fce5d4i3cf29e3bfb8802b4@mail.gmail.com>

check out

http://twistedmatrix.com/pipermail/twisted-python/2007-July/015793.html

Eli Criffield

On Tue, Aug 12, 2008 at 3:40 PM, Bill Zeller <wzeller at cs.princeton.edu> wrote:
> Hi,
>
> I've been playing around with Twisted's Conch client (which looks extremely
> well done, thanks!). I've been able to connect to a conch server and also
> connect to other ssh servers and execuate various commands. I'd like to be
> able to connect to an arbitrary SSH server and run /bin/bash.
>
> I'm able to execute a command like so:
>
> ---------------------
> class CommandChannel(channel.SSHChannel):
>     ....
>     def channelOpen(self, data):
>         self.conn.sendRequest(
>             self, 'exec', common.NS(self.command),
> wantReply=True).addCallback(
>             self._gotResponse)
> ---------------------
>
> Looking through the SSH spec (connect protocol, rfc4254), it looks like
> shells are opened with this command.
>
> ---------------------
>
>       byte      SSH_MSG_CHANNEL_REQUEST
>
>       uint32    recipient channel
>       string    "shell"
>       boolean   want reply
>
> ---------------------
>
> It doesn't look like Conch supports these requests (here's how
> CHANNEL_REQUESTs are currently sent out)
>
> ---------------------
> (Twisted-8.1.0)
> twisted/conch/ssh/connection.py (413):
>         self.transport.sendPacket(MSG_CHANNEL_REQUEST, struct.pack('>L',
>                                     self.channelsToRemoteChannel[channel])
>                                   + common.NS(requestType)+chr(wantReply)
>                                   + data)
> ---------------------
>
> I may be misunderstanding how remote shells are started, so any help would
> be appreciated.
>
> Again, I'm trying to launch an interactive /bin/bash shell from a Conch SSH
> client on an arbitrary remote SSH server.
>
> Thanks for your time.
>
> Best Regards,
> Bill Zeller
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



From arne-weiss at web.de  Thu Aug 21 06:31:23 2008
From: arne-weiss at web.de (arne-weiss at web.de)
Date: Thu, 21 Aug 2008 12:31:23 +0200
Subject: [Twisted-Python] dont get ssl Server working
Message-ID: <945267974@web.de>

I tried to use ssl via twisted and I don't know why it doesn't work. If a client tries to connect ConnectionLost says:
[('SSL routines', 'SSL3_READ_BYTES', 'sslv3 alert bad certificate'), ('SSL routines', 'SSL3_READ_BYTES', 'ssl handshake failure')]

I tried different CAs, so there schould be no failure.
Do I have to do something else like SSL.Context(method).set_accept_state() manually?

My Code in basic looks like the following:
http://nopaste.info/8bd9bd8536.html

# class TLSProtocol(protocol.Protocol,  ssl.Server):
#  
#     def connectionLost(self, reason):
#         print "Connection Lost:"
#         print reason.getErrorMessage()
#  
#     def dataReceived(self, data):
#         print "Data Received: %s"%data
#  
#  
#  
# class Factory(protocol.ServerFactory):
#     protocol = TLSProtocol
#  
#     def buildProtocol(self,  addr):
#         p = self.protocol()
#         return p
#    
#     def clientConnectionLost(self, transport, reason):
#         print "Connection Lost: %s"%reason.getErrorMessage()
#         reactor.stop( )
#        
#     def clientConnectionFailed(self, transport, reason):
#         print "connection Failed: %s"%reason.getErrorMessage( )
#         reactor.stop( )
#  
#  
#  
# class ContextFactory(ssl.ContextFactory):
#  
#     def __init__(self):
#         sslmethod = SSL.TLSv1_METHOD
#  
#         ctx = SSL.Context(sslmethod)
#         ctx.use_certificate_file('ssl.crt')
#         ctx.use_privatekey_file('ssl.key')
#        
#         self._context = ctx
#  
#     def getContext(self):
#         "Create an SSL context"
#  
#         return self._context
#  
#  
#  
# reactor.listenSSL(8601,  Factory(), ContextFactory())
# reactor.run() 
_______________________________________________________________________
EINE F?R ALLE: die kostenlose WEB.DE-Plattform f?r Freunde und Deine
Homepage mit eigenem Namen. Jetzt starten! http://unddu.de/?kid=kid at mf2




From fhauck at srcpsolutions.com  Thu Aug 21 06:37:32 2008
From: fhauck at srcpsolutions.com (fhauck at srcpsolutions.com)
Date: Thu, 21 Aug 2008 05:37:32 -0500
Subject: [Twisted-Python] dont get ssl Server working
Message-ID: <MDAEMON2779200808210537.AA3732828@srcpsolutions.com>

I will be out of the office from 08/15/2008 to
08/25/2008

If this is urgent please contact rgrizzaffi at srcpsolutions.com





From leszczynscy at yahoo.com  Thu Aug 21 06:38:56 2008
From: leszczynscy at yahoo.com (leszczynscy at yahoo.com)
Date: Thu, 21 Aug 2008 03:38:56 -0700 (PDT)
Subject: [Twisted-Python] Yahoo! Auto Response
Message-ID: <949009.41922.qm@web54501.mail.re2.yahoo.com>

Ten adres bedzie sprawdzany do konca lutego 2008. Prosze uzywac mojego nowego adresu. This e-mail will be in use until end of February 2008. Please use my new one instead.

andy.leszczynski
gmail
com



From rajainnov at gmail.com  Thu Aug 21 07:05:55 2008
From: rajainnov at gmail.com (raja pavankumar)
Date: Thu, 21 Aug 2008 16:35:55 +0530
Subject: [Twisted-Python] dont get ssl Server working
In-Reply-To: <MDAEMON2779200808210537.AA3732828@srcpsolutions.com>
References: <MDAEMON2779200808210537.AA3732828@srcpsolutions.com>
Message-ID: <500fd1b0808210405m1357a3dftea469ff1e888bffc@mail.gmail.com>

AS part of my buildbot setup, I am executing a shell command in the slave
environment. (This has been coded as part of the master.cfg file)

This command is failing
f1.addStep(shell.ShellCommand, description= "chdir", command= ['cd',
'./tempGitBranch'])

******* Log Says *************

Upon execvpe cd ['cd', './tempGitBranch'] in environment id -1214057092:
Traceback (most recent call last):
  File "/usr/lib/python2.4/site-packages/twisted/internet/process.py",
line 772, in __init__
    os.execvpe(command, args, environment)
  File "/usr/lib/python2.4/os.py", line 350, in execvpe
    _execvpe(file, args, env)
  File "/usr/lib/python2.4/os.py", line 379, in _execvpe
    func(fullname, *argrest)
OSError: [Errno 2] No such file or directory

**************** Log End *************


This command is succeeding (means that directory is present in the
environment)

f1.addStep(shell.ShellCommand, description= "list", command= ['ls', '-al',
'tempGitBranch'])



On 8/21/08, fhauck at srcpsolutions.com <fhauck at srcpsolutions.com> wrote:
>
> I will be out of the office from 08/15/2008 to
> 08/25/2008
>
> If this is urgent please contact rgrizzaffi at srcpsolutions.com
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080821/2f7ab185/attachment.htm 

From itamar at itamarst.org  Thu Aug 21 09:03:38 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 21 Aug 2008 13:03:38 +0000
Subject: [Twisted-Python] dont get ssl Server working
In-Reply-To: <945267974@web.de>
References: <945267974@web.de>
Message-ID: <1219323818.5308.210.camel@localhost.localdomain>

On Thu, 2008-08-21 at 12:31 +0200, arne-weiss at web.de wrote:
> I tried to use ssl via twisted and I don't know why it doesn't work. If a client tries to connect ConnectionLost says:
> [('SSL routines', 'SSL3_READ_BYTES', 'sslv3 alert bad certificate'), ('SSL routines', 'SSL3_READ_BYTES', 'ssl handshake failure')]
> 
> I tried different CAs, so there schould be no failure.
> Do I have to do something else like SSL.Context(method).set_accept_state() manually?
> 
> My Code in basic looks like the following:
> http://nopaste.info/8bd9bd8536.html
> 
> # class TLSProtocol(protocol.Protocol,  ssl.Server):

Don't inherit your class from ssl.Server, for starters.




From carlo.riva at gmail.com  Thu Aug 21 09:47:49 2008
From: carlo.riva at gmail.com (John Doe)
Date: Thu, 21 Aug 2008 15:47:49 +0200
Subject: [Twisted-Python] Multithreaded UDP server in Twisted?
Message-ID: <1db3ad0a0808210647i1e792b8bjeb2b32e8486c052f@mail.gmail.com>

Hi everyone,

I am trying to implement a multithreaded UDP server in Twisted:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import threads, reactor
from twisted.python import threadable
threadable.init(1)

reactor.suggestThreadPoolSize(32)

class EchoUDP(DatagramProtocol):

   def echoDatagram (self, datagram):
       print datagram

   def datagramReceived(self, datagram, address):
       self.transport.write(datagram, address)
       reactor.callInThread(self.echoDatagram(datagram))

def main():
   reactor.listenUDP(8000, EchoUDP())
   reactor.run()

if __name__ == '__main__':
   main()
although it is working it gives me following error:

Traceback (most recent call last):
 File "C:\Python25\lib\threading.py", line 460, in __bootstrap
   self.run()
 File "C:\Python25\lib\threading.py", line 440, in run
   self.__target(*self.__args, **self.__kwargs)
--- <exception caught here> ---
 File "C:\Python25\lib\site-packages\twisted\python\threadpool.py",
line 148, in _worker
   context.call(ctx, function, *args, **kwargs)
 File "C:\Python25\lib\site-packages\twisted\python\context.py", line
59, in callWithContext
   return self.currentContext().callWithContext(ctx, func, *args, **kw)
 File "C:\Python25\lib\site-packages\twisted\python\context.py", line
37, in callWithContext
   return func(*args,**kw)
exceptions.TypeError: 'NoneType' object is not callable

Does anybody know what is wrong?

Any help is *greatly* appreciated! ;)

Thanks in advance!

Cheers
Carlo



From elicriffield at gmail.com  Thu Aug 21 09:58:08 2008
From: elicriffield at gmail.com (Eli Criffield)
Date: Thu, 21 Aug 2008 08:58:08 -0500
Subject: [Twisted-Python] twisted python conch SSH shell?
In-Reply-To: <9263743c0808210007s1cdbda07s62ef698efe7c057f@mail.gmail.com>
References: <74a0fd5f0808121340pdf0e46egd4dfb9b1c10cbaf4@mail.gmail.com>
	<18e3f33d0808201913l17fce5d4i3cf29e3bfb8802b4@mail.gmail.com>
	<9263743c0808210007s1cdbda07s62ef698efe7c057f@mail.gmail.com>
Message-ID: <18e3f33d0808210658h541f6318n66aa9555ad30df9a@mail.gmail.com>

conchClient.py is libarary. Running it from the command line was an
afterthought just for testing.
To run multiple commands in the same session you just give sshCmds a
list of commands to run and it will return the output of all of them.
Here is an example script that creates a function to up a port and
another to return the wwn (this is from a SAN switch) of a port.

#!/usr/bin/env python
# Eli Criffield

__version__ = 0.1186070837
__author__ = 'Eli Criffield <python AT zendo.net>'

import sys
import re
import time
import os
from conchClient import sshCmds

dryRun = False
Confirm = True
echo = False

class reError(Exception):
    pass

def execList(switch,cmds,change=False):
    global echo, dryRun, Confirm
    # if change is False, the commands arn't suppose to do any damage
    # always exec them, they need the info
    if not change:
        return sshCmds(switch,cmds,echo=echo)

    if dryRun:
        print 'DRY RUN'
        print 'ssh %s'%switch
        for cmd in cmds:
            print cmd
        print 'ENTER to continue:',
        sys.stdin.readline()
        return ('dryrun','')


    if Confirm:
        print "I'm going to run:"
        print '\nssh %s'%switch
        for cmd in cmds:
            print cmd
        ans = raw_input('Does that look ok (yes/no)? ')
        while ans.lower() not in ('yes', 'no'):
            ans = raw_input("Please type 'yes' or 'no': ")
        if ans == 'no':
            print 'exiting out'
            sys.exit(1)
        else:
            return sshCmds(switch,cmds,echo=echo)

    # No dryRun or Confirm just execute it
    return sshCmds(switch,cmds,echo=echo)

def upPort(switch,port):
    cmds=[ 'config term', 'interface fc%s'%port, 'no shutdown' ,'end'
    ,'exit' ]
    execList(switch,cmds,change=True)

def wwnFromPort(switch,port):
    portre = re.compile(r'%s '%port)
    linere = re.compile(r'(\S*)\s*(\S*)\s*(\S*)\s*(\S*)\s*(\S*)')
    (out,err) = execList(switch,['show flogi database'])
    for line in out.split('fc'):
        if portre.match(line):
            #print 'line:',line #DEBUG
            wwn = linere.match(line).groups()[3]
            #print wwn #DEBUG
            return wwn


On Thu, Aug 21, 2008 at 2:07 AM, The Noob <thenoob06 at gmail.com> wrote:
> Hello,
>
> If I understand your code, you can't find a way to run a real shell on Cisco
> ?
> For example if I connect to a router, I send a "sh log" , " conf t "
> commands but I do not know them before. With the actual script:
> conchClient.py 192.168.0.254 sh log
> The script disconnects us from the router
> conchClient.py 192.168.0.254 conf t
> The script disconnects us  disconnect from the router
> I think the problem with your script it is for each command you are
> disconnected The best will be to find a solution to do this:
> conchClient.py 192.168.0.254 sh log
> conchClient.py 192.168.0.254 conf t
> conchClient.py 192.168.0.254 exit
> disconnect from server
>
> I try to do this with a custom ssh server which permits to connect to others
> ssh servers and have a shell. But I don't know how to communicate between my
> custom ssh server and my child ( an expect script which launch ssh root at host
> and permits to have a real shell)
>
>
> Best Regards
> TheNoob06
>
>
> 2008/8/21 Eli Criffield <elicriffield at gmail.com>
>>
>> check out
>>
>> http://twistedmatrix.com/pipermail/twisted-python/2007-July/015793.html
>>
>> Eli Criffield
>>
>> On Tue, Aug 12, 2008 at 3:40 PM, Bill Zeller <wzeller at cs.princeton.edu>
>> wrote:
>> > Hi,
>> >
>> > I've been playing around with Twisted's Conch client (which looks
>> > extremely
>> > well done, thanks!). I've been able to connect to a conch server and
>> > also
>> > connect to other ssh servers and execuate various commands. I'd like to
>> > be
>> > able to connect to an arbitrary SSH server and run /bin/bash.
>> >
>> > I'm able to execute a command like so:
>> >
>> > ---------------------
>> > class CommandChannel(channel.SSHChannel):
>> >     ....
>> >     def channelOpen(self, data):
>> >         self.conn.sendRequest(
>> >             self, 'exec', common.NS(self.command),
>> > wantReply=True).addCallback(
>> >             self._gotResponse)
>> > ---------------------
>> >
>> > Looking through the SSH spec (connect protocol, rfc4254), it looks like
>> > shells are opened with this command.
>> >
>> > ---------------------
>> >
>> >       byte      SSH_MSG_CHANNEL_REQUEST
>> >
>> >       uint32    recipient channel
>> >       string    "shell"
>> >       boolean   want reply
>> >
>> > ---------------------
>> >
>> > It doesn't look like Conch supports these requests (here's how
>> > CHANNEL_REQUESTs are currently sent out)
>> >
>> > ---------------------
>> > (Twisted-8.1.0)
>> > twisted/conch/ssh/connection.py (413):
>> >         self.transport.sendPacket(MSG_CHANNEL_REQUEST, struct.pack('>L',
>> >
>> > self.channelsToRemoteChannel[channel])
>> >                                   +
>> > common.NS(requestType)+chr(wantReply)
>> >                                   + data)
>> > ---------------------
>> >
>> > I may be misunderstanding how remote shells are started, so any help
>> > would
>> > be appreciated.
>> >
>> > Again, I'm trying to launch an interactive /bin/bash shell from a Conch
>> > SSH
>> > client on an arbitrary remote SSH server.
>> >
>> > Thanks for your time.
>> >
>> > Best Regards,
>> > Bill Zeller
>> >
>> > _______________________________________________
>> > Twisted-Python mailing list
>> > Twisted-Python at twistedmatrix.com
>> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>> >
>> >
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



From exarkun at divmod.com  Thu Aug 21 10:12:17 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 21 Aug 2008 10:12:17 -0400
Subject: [Twisted-Python] Multithreaded UDP server in Twisted?
In-Reply-To: <1db3ad0a0808210647i1e792b8bjeb2b32e8486c052f@mail.gmail.com>
Message-ID: <20080821141217.29191.319572987.divmod.quotient.16987@ohm>

On Thu, 21 Aug 2008 15:47:49 +0200, John Doe <carlo.riva at gmail.com> wrote:
> [snip]
>       reactor.callInThread(self.echoDatagram(datagram))

Try reactor.callInThread(self.echoDatagram, datagram)

Jean-Paul



From screwtape at froup.com  Thu Aug 21 20:57:34 2008
From: screwtape at froup.com (Tim Allen)
Date: Fri, 22 Aug 2008 10:57:34 +1000
Subject: [Twisted-Python] dont get ssl Server working
In-Reply-To: <500fd1b0808210405m1357a3dftea469ff1e888bffc@mail.gmail.com>
References: <MDAEMON2779200808210537.AA3732828@srcpsolutions.com>
	<500fd1b0808210405m1357a3dftea469ff1e888bffc@mail.gmail.com>
Message-ID: <20080822005734.GF2478@thristian.org>

On Thu, Aug 21, 2008 at 04:35:55PM +0530, raja pavankumar wrote:
> AS part of my buildbot setup, I am executing a shell command in the slave
> environment. (This has been coded as part of the master.cfg file)
> 
> This command is failing
> f1.addStep(shell.ShellCommand, description= "chdir", command= ['cd',
> './tempGitBranch'])

"cd" isn't a command that can be run - there's no /bin/cd or /usr/bin/cd
binary that you could call. It's a shell built-in, which means it's
available for shell-scripts to use, and it's available when you're using
the shell interactively, but that's it.

You're probably looking for os.chdir("./tempGitBranch")



From gabriel.rossetti at arimaz.com  Fri Aug 22 05:42:08 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 22 Aug 2008 11:42:08 +0200
Subject: [Twisted-Python] wxPython + Twisted = signals no longer caught
Message-ID: <48AE89F0.10004@arimaz.com>

Hello everyone,

I am writing a (Twisted) program that intercepts some signals using , 
such as Ctrl+C, and stops the reactor. I have a base class that sets-up 
signal handlers and it works great. The handlers are in my base factory 
class (we'll call it MyBaseFactory). Here's the code in the 
MyBaseFactory's __init__() :

    def __init__(self, proto, *args, **kwargs):
        self.protocol = proto
       
        if signal.getsignal(signal.SIGINT) == signal.default_int_handler:
            # only handle if there isn't already a handler, e.g. for Pdb.
            signal.signal(signal.SIGINT, self._sigHandler)
        signal.signal(signal.SIGTERM, self._sigHandler)
       
        # Catch Ctrl-Break in windows
        if hasattr(signal, "SIGBREAK"):
            signal.signal(signal.SIGBREAK, self._sigHandler)

    def _sigHandler(self, signum, frame):
        if(signum == signal.SIGINT or signal.SIGTERM):
            reactor.callLater(0, reactor.stop)
        # Catch Ctrl-Break in windows
        elif hasattr(signal, "SIGBREAK") and signum == signal.SIGBREAK:
            reactor.callLater(0, reactor.stop)


I've recently had to integrate wxPython in parts of my application and 
I've inherited from MyBaseFactory and wx.App. When the Gui starts, it 
creates a wx.Dialog descendant/child that creates a wx.TaskBarIcon. I 
use the wxPython integration reactor code. Also, I have tried using 
wx.Frame instead of wx.Dialog but it doesn't change anything.

The interface works great, I can use twisted, I get and receive msgs, 
etc, but when I'm in the terminal were the program was run from, and I 
send SIGINT (Ctrl+C) nothing happens. Does anyone know why wxPython or 
Twisted eats my Ctrl+C in the terminal? This code (MyBaseFactory) works 
without the wxPython (I've been using it for several months).

Thank you,
Gabriel

PS I've also posted before to the wxPython mailing list without 
mentioning the twisted part, but apparently pure wxPython does not do 
this. I've also tested it (removed all the twisted stuff) and it does 
close when a SIGINT is sent.



From grimsqueaker13 at gmail.com  Fri Aug 22 10:05:37 2008
From: grimsqueaker13 at gmail.com (Daniel Browne)
Date: Fri, 22 Aug 2008 16:05:37 +0200
Subject: [Twisted-Python] twisted.web session expiry
Message-ID: <48AEC7B1.3040307@gmail.com>

I need someone to help me with twisted.web.

How can I do something (eg. redirect) once a users session has expired? 
At the point when the session expires your request is finished and your 
session is expired. I have added the notification callback but I can't 
really do anything inside it without a session to store information in 
or a request to redirect with, so I just print a message to the console.

Can anyone help me understand what I'm doing wrong here?

Thanks
Daniel Browne



From flashbuster at gmail.com  Fri Aug 22 11:30:17 2008
From: flashbuster at gmail.com (Sebastian Schulze)
Date: Fri, 22 Aug 2008 17:30:17 +0200
Subject: [Twisted-Python] twisted.web session expiry
In-Reply-To: <48AEC7B1.3040307@gmail.com>
References: <48AEC7B1.3040307@gmail.com>
Message-ID: <c2959a420808220830o6b6bea25kb5e6ab7363a5a770@mail.gmail.com>

I don't see how this would work, as HTTP is a stateless protocol.
Should by possible with AJAX, though (so, athena.livepage may be your
friend).

2008/8/22 Daniel Browne <grimsqueaker13 at gmail.com>

> I need someone to help me with twisted.web.
>
> How can I do something (eg. redirect) once a users session has expired? At
> the point when the session expires your request is finished and your session
> is expired. I have added the notification callback but I can't really do
> anything inside it without a session to store information in or a request to
> redirect with, so I just print a message to the console.
>
> Can anyone help me understand what I'm doing wrong here?
>
> Thanks
> Daniel Browne
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080822/1486d0f0/attachment.htm 

From phil at bubblehouse.org  Fri Aug 22 11:43:50 2008
From: phil at bubblehouse.org (Phil Christensen)
Date: Fri, 22 Aug 2008 11:43:50 -0400
Subject: [Twisted-Python] twisted.web session expiry
In-Reply-To: <48AEC7B1.3040307@gmail.com>
References: <48AEC7B1.3040307@gmail.com>
Message-ID: <E9A68D39-6832-42E6-B28B-C6EADB06AD95@bubblehouse.org>

On Aug 22, 2008, at 10:05 AM, Daniel Browne wrote:
> I need someone to help me with twisted.web.
>
> How can I do something (eg. redirect) once a users session has  
> expired? At the point when the session expires your request is  
> finished and your session is expired. I have added the notification  
> callback but I can't really do anything inside it without a session  
> to store information in or a request to redirect with, so I just  
> print a message to the console.
>
> Can anyone help me understand what I'm doing wrong here?

I can see where that would be a bit tricky.

The best idea I can think of is to have your top-level Resource check  
the session state in the locateChild method. If the session has  
expired, you can return a special Resource that simply redirects  
immediately.

-phil



From joaquin.keller at gmail.com  Fri Aug 22 12:35:08 2008
From: joaquin.keller at gmail.com (Joaquin Keller)
Date: Fri, 22 Aug 2008 18:35:08 +0200
Subject: [Twisted-Python] twisted.words.msn broken ?
Message-ID: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>

Hi all,
when running msn_example.py
I get this:

2008/08/22 17:29 +0200 [-] Log opened.
2008/08/22 17:29 +0200 [-] Starting factory
<twisted.internet.protocol.ClientFactory instance at 0x83d552c>
2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
(Invalid version response)
2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
<twisted.internet.protocol.ClientFactory instance at 0x83d552c>

1 or 2 months ago, it was working perfectly fine.

I suspect that something has changed on messenger.hotmail.com side

bonus: this two-week old bug (closed now) seems to be related and
claims to have a solution:
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908

     [...] their response to the CVR command has changed [...]

Hopefully, it might be only that...
Thanks,
-- Joaquin



From exarkun at divmod.com  Fri Aug 22 12:42:04 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Fri, 22 Aug 2008 12:42:04 -0400
Subject: [Twisted-Python] twisted.words.msn broken ?
In-Reply-To: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>
Message-ID: <20080822164204.29191.1890646986.divmod.quotient.17410@ohm>

On Fri, 22 Aug 2008 18:35:08 +0200, Joaquin Keller <joaquin.keller at gmail.com> wrote:
>Hi all,
>when running msn_example.py
>I get this:
>
>2008/08/22 17:29 +0200 [-] Log opened.
>2008/08/22 17:29 +0200 [-] Starting factory
><twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
>(Invalid version response)
>2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
><twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>
>1 or 2 months ago, it was working perfectly fine.
>
>I suspect that something has changed on messenger.hotmail.com side
>
>bonus: this two-week old bug (closed now) seems to be related and
>claims to have a solution:
>http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908
>
>     [...] their response to the CVR command has changed [...]
>

Can you file a ticket in our issue tracker for this?

Jean-Paul



From db3l.net at gmail.com  Fri Aug 22 16:08:50 2008
From: db3l.net at gmail.com (David Bolen)
Date: Fri, 22 Aug 2008 16:08:50 -0400
Subject: [Twisted-Python] Re: twisted.web session expiry
References: <48AEC7B1.3040307@gmail.com>
Message-ID: <87myj4izhp.fsf@valheru.db3l.homeip.net>

Daniel Browne <grimsqueaker13 at gmail.com> writes:

> How can I do something (eg. redirect) once a users session has
> expired? At the point when the session expires your request is
> finished and your session is expired. I have added the notification
> callback but I can't really do anything inside it without a session to
> store information in or a request to redirect with, so I just print a
> message to the console.

If you're trying to cause something to happen on the user's browser
when their session expires, as others have pointed out default HTTP is
stateless, so without something (like a bit of Javascript) running in
the user's browser staying in contact with your server behind the
scenes you won't be able to trigger any behavior on their end.

A user is likely to be already familiar with how most sites that have
active sessions won't tell them that their session is expired until
they initiate a subsequent request to the server (refresh a page, try
to click on a link, etc...).  Barring unique requirements for your
application, simply behaving that way - check the session for possible
expiration upon any subsequent request from that user and issue the
redirect then if expired - should be a fairly common behavior.


If you want to have something on the server end occur when the session
expires (say to update some internal state, or adjust or clear the
session information), then you can just establish a standard Twisted
callLater callback (which could itself be stored in the session and
reset when requests did come in), or if you may have lots of sessions,
have a separate server side object with a single periodic timer take
care of expiring sessions.  Or any other server side event that occurs
could be used to initiate session expiration processing.

-- David




From joaquin.keller at gmail.com  Fri Aug 22 16:28:30 2008
From: joaquin.keller at gmail.com (Joaquin Keller)
Date: Fri, 22 Aug 2008 22:28:30 +0200
Subject: [Twisted-Python] twisted.words.msn broken ?
In-Reply-To: <20080822164204.29191.1890646986.divmod.quotient.17410@ohm>
References: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>
	<20080822164204.29191.1890646986.divmod.quotient.17410@ohm>
Message-ID: <ede9ca810808221328l6bc08adeyd6852e725689b50f@mail.gmail.com>

done.
maybe is worth moving it to a higher priority since now the whole msn
code is useless while the fix seems not too hard.
-- Joaquin

most people ignore it but imvho twisted is the best network framework.
ever. impressive. thanks.


On Fri, Aug 22, 2008 at 6:42 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Fri, 22 Aug 2008 18:35:08 +0200, Joaquin Keller
> <joaquin.keller at gmail.com> wrote:
>>
>> Hi all,
>> when running msn_example.py
>> I get this:
>>
>> 2008/08/22 17:29 +0200 [-] Log opened.
>> 2008/08/22 17:29 +0200 [-] Starting factory
>> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>> 2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
>> (Invalid version response)
>> 2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
>> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>>
>> 1 or 2 months ago, it was working perfectly fine.
>>
>> I suspect that something has changed on messenger.hotmail.com side
>>
>> bonus: this two-week old bug (closed now) seems to be related and
>> claims to have a solution:
>> http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908
>>
>>    [...] their response to the CVR command has changed [...]
>>
>
> Can you file a ticket in our issue tracker for this?
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From adelagon at gmail.com  Sat Aug 23 07:48:26 2008
From: adelagon at gmail.com (Alvin Delagon)
Date: Sat, 23 Aug 2008 19:48:26 +0800
Subject: [Twisted-Python] twisted.words.msn broken ?
In-Reply-To: <ede9ca810808221328l6bc08adeyd6852e725689b50f@mail.gmail.com>
References: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>
	<20080822164204.29191.1890646986.divmod.quotient.17410@ohm>
	<ede9ca810808221328l6bc08adeyd6852e725689b50f@mail.gmail.com>
Message-ID: <7a01f6c00808230448x6ba13d5bqa89eaedf0c56b092@mail.gmail.com>

Guys,

MSNP8 has been deprecated at some point in time last July. And the MSN
dispatch server's response to a CVR has been changed causing this
loseConnection in the handle_VER to be called:

def handle_VER(self, params):
        versions = params[1:]
        if versions is None or ' '.join(versions) != MSNP_VER:
            self.transport.loseConnection()
        self.sendCommand('CVR %s %s %s' % (self.nextTID(), MSN_CVR_STR,
self.factory.userHandle))

twisted.words.msn has been written to close the session if the versions
doesn't match. This can be easily fixed correcting MSNP_VER variable
somewhere in the  twisted code (remove MSNP8 the current twisted 8.1 still
works with MSNP9).

I could submit a patch on wednesday after I go back from vacation. :)

Cheers,
Alvin Delagon

On Sat, Aug 23, 2008 at 4:28 AM, Joaquin Keller <joaquin.keller at gmail.com>wrote:

> done.
> maybe is worth moving it to a higher priority since now the whole msn
> code is useless while the fix seems not too hard.
> -- Joaquin
>
> most people ignore it but imvho twisted is the best network framework.
> ever. impressive. thanks.
>
>
> On Fri, Aug 22, 2008 at 6:42 PM, Jean-Paul Calderone <exarkun at divmod.com>
> wrote:
> > On Fri, 22 Aug 2008 18:35:08 +0200, Joaquin Keller
> > <joaquin.keller at gmail.com> wrote:
> >>
> >> Hi all,
> >> when running msn_example.py
> >> I get this:
> >>
> >> 2008/08/22 17:29 +0200 [-] Log opened.
> >> 2008/08/22 17:29 +0200 [-] Starting factory
> >> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
> >> 2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
> >> (Invalid version response)
> >> 2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
> >> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
> >>
> >> 1 or 2 months ago, it was working perfectly fine.
> >>
> >> I suspect that something has changed on messenger.hotmail.com side
> >>
> >> bonus: this two-week old bug (closed now) seems to be related and
> >> claims to have a solution:
> >> http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908
> >>
> >>    [...] their response to the CVR command has changed [...]
> >>
> >
> > Can you file a ticket in our issue tracker for this?
> >
> > Jean-Paul
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
http://www.alvinatorsplayground.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080823/aace5138/attachment.htm 

From adelagon at gmail.com  Sat Aug 23 08:10:24 2008
From: adelagon at gmail.com (Alvin Delagon)
Date: Sat, 23 Aug 2008 20:10:24 +0800
Subject: [Twisted-Python] twisted.words.msn broken ?
In-Reply-To: <7a01f6c00808230448x6ba13d5bqa89eaedf0c56b092@mail.gmail.com>
References: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>
	<20080822164204.29191.1890646986.divmod.quotient.17410@ohm>
	<ede9ca810808221328l6bc08adeyd6852e725689b50f@mail.gmail.com>
	<7a01f6c00808230448x6ba13d5bqa89eaedf0c56b092@mail.gmail.com>
Message-ID: <7a01f6c00808230510p1d184c15jd72d2e6d3bb3412a@mail.gmail.com>

My bad, sorry for not reading the last email. :)

Alvin Delagon

On Sat, Aug 23, 2008 at 7:48 PM, Alvin Delagon <adelagon at gmail.com> wrote:

> Guys,
>
> MSNP8 has been deprecated at some point in time last July. And the MSN
> dispatch server's response to a CVR has been changed causing this
> loseConnection in the handle_VER to be called:
>
> def handle_VER(self, params):
>         versions = params[1:]
>         if versions is None or ' '.join(versions) != MSNP_VER:
>             self.transport.loseConnection()
>         self.sendCommand('CVR %s %s %s' % (self.nextTID(), MSN_CVR_STR,
> self.factory.userHandle))
>
> twisted.words.msn has been written to close the session if the versions
> doesn't match. This can be easily fixed correcting MSNP_VER variable
> somewhere in the  twisted code (remove MSNP8 the current twisted 8.1 still
> works with MSNP9).
>
> I could submit a patch on wednesday after I go back from vacation. :)
>
> Cheers,
> Alvin Delagon
>
>
> On Sat, Aug 23, 2008 at 4:28 AM, Joaquin Keller <joaquin.keller at gmail.com>wrote:
>
>> done.
>> maybe is worth moving it to a higher priority since now the whole msn
>> code is useless while the fix seems not too hard.
>> -- Joaquin
>>
>> most people ignore it but imvho twisted is the best network framework.
>> ever. impressive. thanks.
>>
>>
>> On Fri, Aug 22, 2008 at 6:42 PM, Jean-Paul Calderone <exarkun at divmod.com>
>> wrote:
>> > On Fri, 22 Aug 2008 18:35:08 +0200, Joaquin Keller
>> > <joaquin.keller at gmail.com> wrote:
>> >>
>> >> Hi all,
>> >> when running msn_example.py
>> >> I get this:
>> >>
>> >> 2008/08/22 17:29 +0200 [-] Log opened.
>> >> 2008/08/22 17:29 +0200 [-] Starting factory
>> >> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>> >> 2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
>> >> (Invalid version response)
>> >> 2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
>> >> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>> >>
>> >> 1 or 2 months ago, it was working perfectly fine.
>> >>
>> >> I suspect that something has changed on messenger.hotmail.com side
>> >>
>> >> bonus: this two-week old bug (closed now) seems to be related and
>> >> claims to have a solution:
>> >> http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908
>> >>
>> >>    [...] their response to the CVR command has changed [...]
>> >>
>> >
>> > Can you file a ticket in our issue tracker for this?
>> >
>> > Jean-Paul
>> >
>> > _______________________________________________
>> > Twisted-Python mailing list
>> > Twisted-Python at twistedmatrix.com
>> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>> >
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
>
>
> --
> http://www.alvinatorsplayground.blogspot.com/
>



-- 
http://www.alvinatorsplayground.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080823/3e1a68bf/attachment.htm 

From exarkun at twistedmatrix.com  Sun Aug 24 00:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 24 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1219550709.99.50672012@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080824/4c6435f6/attachment.htm 

From ellisonbg.net at gmail.com  Sun Aug 24 02:25:01 2008
From: ellisonbg.net at gmail.com (Brian Granger)
Date: Sat, 23 Aug 2008 23:25:01 -0700
Subject: [Twisted-Python] "_wait" is blowing up?!
Message-ID: <6ce0ac130808232325p666a93cdl85c5cdc54a1a8328@mail.gmail.com>

File "/usr/lib/python2.5/site-packages/twisted/trial/unittest.py",
line 763, in run
   self._wait(d)
 File "/usr/lib/python2.5/site-packages/twisted/trial/unittest.py",
line 901, in _wait
   reactor.run()
 File "/usr/lib/python2.5/site-packages/twisted/internet/posixbase.py",
Hi,

We have a pretty big tests suite that uses trial to test all sorts of
twisted things.  We are pretty careful to do the right thing in our
tests and leave the reactor clean....but recently we began seeing a
transient really wierd bug when we run our test suite.

Some characteristics of the problem:

1.  The problem only appears sometimes - seems random
2.  The problem shows up in different test methods
3.  Sometimes it hangs the tests suite for a long time - eventually
twisted continues though

Here is the traceback we get.

line 220, in run
   self.mainLoop()
 File "/usr/lib/python2.5/site-packages/twisted/internet/posixbase.py",
line 228, in mainLoop
   self.runUntilCurrent()
--- <exception caught here> ---
 File "/usr/lib/python2.5/site-packages/twisted/internet/base.py",
line 533, in runUntilCurrent
   f(*a, **kw)
 File "/usr/lib/python2.5/site-packages/twisted/internet/defer.py",
line 261, in errback
   self._startRunCallbacks(fail)
 File "/usr/lib/python2.5/site-packages/twisted/internet/defer.py",
line 290, in _startRunCallbacks
   raise AlreadyCalledError
twisted.internet.defer.AlreadyCalledError:
ERROR

It appears that something is going on in the deadly _wait.  Any
thoughts on how we might fix this?

Thanks

Brian



From glyph at divmod.com  Sun Aug 24 04:08:03 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Sun, 24 Aug 2008 08:08:03 -0000
Subject: [Twisted-Python] "_wait" is blowing up?!
In-Reply-To: <6ce0ac130808232325p666a93cdl85c5cdc54a1a8328@mail.gmail.com>
References: <6ce0ac130808232325p666a93cdl85c5cdc54a1a8328@mail.gmail.com>
Message-ID: <20080824080803.25821.1654368831.divmod.xquotient.14873@joule.divmod.com>

Hi Brian,

On 06:25 am, ellisonbg.net at gmail.com wrote:
>Some characteristics of the problem:
>
>1.  The problem only appears sometimes - seems random
>2.  The problem shows up in different test methods
>3.  Sometimes it hangs the tests suite for a long time - eventually
>twisted continues though
>
>Here is the traceback we get.
(...)
>It appears that something is going on in the deadly _wait.  Any
>thoughts on how we might fix this?

I realize that this problem is difficult to track down, but I'm not sure 
what to tell you without more specific information about how your code 
is interacting with trial.

Is your code available somewhere?

Do you reliably see this error eventually if you use trial --until- 
failure?

Exactly what version of Twisted are you using?

What reactor do you typically run your tests under?

Not sure that I'd be able to tell you what's going on even with an 
answer to all of these questions, but they'd be a start :).



From aldoogy at gmail.com  Mon Aug 25 12:43:27 2008
From: aldoogy at gmail.com (A)
Date: Mon, 25 Aug 2008 17:43:27 +0100
Subject: [Twisted-Python] a question about self.factory in pb.Broker
Message-ID: <48B2E12F.3040307@gmail.com>

I'm attempting to build a Twisted pb client in Actionscript.
or at least enough to act as the client in this example . .
http://twistedmatrix.com/projects/core/documentation/howto/pb-cred.html#auto18

I'm a bit stuck here . .

def _sendError(self, fail, requestID):
        """(internal) Send an error for a previously sent message.
        """
        if isinstance(fail, failure.Failure):
            # If the failures value is jellyable or allowed through 
security,
            # send the value
            if (isinstance(fail.value, Jellyable) or
                self.security.isClassAllowed(fail.value.__class__)):
                fail = fail.value
            elif not isinstance(fail, CopyableFailure):
                fail = failure2Copyable(fail, self.factory.unsafeTracebacks)
        if isinstance(fail, CopyableFailure):
            fail.unsafeTracebacks = self.factory.unsafeTracebacks
        self.sendCall("error", requestID, self.serialize(fail))


where should  self.factory be set ?
what is self.factory ? PbClientFactory ?



From exarkun at divmod.com  Mon Aug 25 13:14:43 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 25 Aug 2008 13:14:43 -0400
Subject: [Twisted-Python] a question about self.factory in pb.Broker
In-Reply-To: <48B2E12F.3040307@gmail.com>
Message-ID: <20080825171443.29191.1269873416.divmod.quotient.18389@ohm>

On Mon, 25 Aug 2008 17:43:27 +0100, A <aldoogy at gmail.com> wrote:
>I'm attempting to build a Twisted pb client in Actionscript.
>or at least enough to act as the client in this example . .
>http://twistedmatrix.com/projects/core/documentation/howto/pb- 
>cred.html#auto18
>
>I'm a bit stuck here . .
>
> [snip]
>
>
>where should  self.factory be set ?
>what is self.factory ? PbClientFactory ?
>

See http://twistedmatrix.com/trac/browser/trunk/twisted/internet/protocol.py#L87

Jean-Paul




From aldoogy at gmail.com  Mon Aug 25 14:22:10 2008
From: aldoogy at gmail.com (A)
Date: Mon, 25 Aug 2008 19:22:10 +0100
Subject: [Twisted-Python] a question about self.factory in pb.Broker
In-Reply-To: <20080825171443.29191.1269873416.divmod.quotient.18389@ohm>
References: <20080825171443.29191.1269873416.divmod.quotient.18389@ohm>
Message-ID: <48B2F852.8020803@gmail.com>

Thanks,
so out of curiosity , does Factory.buildProtocol() get called after 
PBClientFactory.clientConnectionMade(self,broker) ?
http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/spread/pb.py#L1088

Is the broker parameter a reference to the class rather than an instance 
of Broker ?

A.




Jean-Paul Calderone wrote:
> On Mon, 25 Aug 2008 17:43:27 +0100, A <aldoogy at gmail.com> wrote:
>> I'm attempting to build a Twisted pb client in Actionscript.
>> or at least enough to act as the client in this example . .
>> http://twistedmatrix.com/projects/core/documentation/howto/pb- 
>> cred.html#auto18
>>
>> I'm a bit stuck here . .
>>
>> [snip]
>>
>>
>> where should  self.factory be set ?
>> what is self.factory ? PbClientFactory ?
>>
>
> See 
> http://twistedmatrix.com/trac/browser/trunk/twisted/internet/protocol.py#L87 
>
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>




From exarkun at divmod.com  Mon Aug 25 14:28:36 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 25 Aug 2008 14:28:36 -0400
Subject: [Twisted-Python] a question about self.factory in pb.Broker
In-Reply-To: <48B2F852.8020803@gmail.com>
Message-ID: <20080825182836.29191.995266651.divmod.quotient.18412@ohm>

On Mon, 25 Aug 2008 19:22:10 +0100, A <aldoogy at gmail.com> wrote:
>Thanks,
>so out of curiosity , does Factory.buildProtocol() get called after 
>PBClientFactory.clientConnectionMade(self,broker) ?
>http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/spread/pb.py#L1088

No, buildProtocol gets called first.

>
>Is the broker parameter a reference to the class rather than an instance of 
>Broker ?
>

The `broker? parameter is an instance of `Broker?.

Jean-Paul



From jml at mumak.net  Tue Aug 26 21:19:24 2008
From: jml at mumak.net (Jonathan Lange)
Date: Wed, 27 Aug 2008 11:19:24 +1000
Subject: [Twisted-Python] Use the Launchpad plugin on our trac? (was Fwd:
	Bugzilla and Trac Launchpad plugins: Request for beta testers)
Message-ID: <d06a5cd30808261819wdc57aa0t6256eb01136c8def@mail.gmail.com>

Hello all,

Launchpad has recently released a Trac plugin that lets Launchpad
synchronize bugs and bug comments from Launchpad to Trac and vice
versa.

Can we please install this on our Trac?

jml


---------- Forwarded message ----------
From: Graham Binns <graham at canonical.com>
Date: Sat, Aug 23, 2008 at 7:55 AM
Subject: Bugzilla and Trac Launchpad plugins: Request for beta testers
To: Warthogs list <warthogs at lists.canonical.com>


Howdy, warthogs,

I'm writing to you to ask for help with testing some cool new features
that we're going to be adding to Launchpad shortly.

We've developed (well, we've contracted people to develop) plugins for
Bugzilla and Trac that allow bidirectional communication between
Launchpad and the remote bug trackers that have them installed.

As I said, we need some help testing these plugins. Specifically, we need to
have them installed on a number of remote bug trackers so that we can use the
plugins to communicate with those trackers.

If you know of any bug trackers whose administrators might be interested
in helping us out (or, even better, if you're one of those
administrators yourself),
please point them to the following pages on the help wiki, which will
explain how
to download and install the Launchpad plugins:

For Bugzilla: http://help.launchpad.net/Bugs/BugzillaPlugin
For Trac: http://help.launchpad.net/Bugs/TracPlugin

Installing one of the plugins means that:

 * Launchpad will be able to forward bugs to upstream bug trackers that
  have the plugin installed. Users of those bug trackers won't have to
  check Launchpad for bugs registered against their project; they'll be
  forwarded straight to the upstream tracker.

 * If a bug watch is created against an upstream bug, Launchpad will
  tell the upstream bug tracker which Launchpad bug is watching it.
  This means that not only is there a link in Launchpad to the upstream
  bug, but there's also a link in the upstream bug tracker to the
  Launchpad bug.

 * Launchpad will be able to import comments from upstream bugs which
  are being watched in Launchpad. If you register a bug watch against
  an upstream bug you'll be able to read the conversation about that
  bug on Launchpad, including the comments that are made on the
  upstream bug tracker.

 * Launchpad will be able to push comments to upstream bugs which are
  linked to a Launchpad bug, so if you add a comment on Launchpad in
  reply to a comment which was imported from an upstream bug tracker,
  the comment will automatically be added to the conversation on the
  upstream bug tracker, too. This means that users of both Launchpad
  and the upstream tracker can view the whole conversation about the
  bug without leaving their preferred environments.

If you've got any further questions, please feel free to ask me.

Thanks in advance for your help,

Graham

--
Graham Binns | PGP Key: 4DAD18FA

--
warthogs mailing list
warthogs at lists.canonical.com
https://lists.ubuntu.com/mailman/listinfo/warthogs



From lucc at inf.ufrgs.br  Wed Aug 27 08:14:33 2008
From: lucc at inf.ufrgs.br (Luciano Cavalheiro da Silva)
Date: Wed, 27 Aug 2008 09:14:33 -0300
Subject: [Twisted-Python] Is  Ldaptor stable / still maintained?
Message-ID: <48B54529.5070000@inf.ufrgs.br>

Hi there,

Anybody could tell me whether Ldaptor, which is build on top of twisted,
is still maintained or has been abandoned? Is it stable? I've found on
its home page it has not been updated in the last 3 years...

I'm starting a project (production system) in python which has to access
an Openldap server, so I'm in doubt what would be better to use by now,
ldaptor or python-ldap?

Best regards,

         Luciano




From exarkun at divmod.com  Wed Aug 27 09:54:57 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 27 Aug 2008 09:54:57 -0400
Subject: [Twisted-Python] Use the Launchpad plugin on our trac? (was
	Fwd: Bugzilla and Trac Launchpad plugins: Request for beta testers)
In-Reply-To: <d06a5cd30808261819wdc57aa0t6256eb01136c8def@mail.gmail.com>
Message-ID: <20080827135457.29191.920749908.divmod.quotient.18733@ohm>

On Wed, 27 Aug 2008 11:19:24 +1000, Jonathan Lange <jml at mumak.net> wrote:
>---------- Forwarded message ----------
>From: Graham Binns <graham at canonical.com>
>Date: Sat, Aug 23, 2008 at 7:55 AM
>Subject: Bugzilla and Trac Launchpad plugins: Request for beta testers
>To: Warthogs list <warthogs at lists.canonical.com>
>
>Howdy, warthogs,
>
>I'm writing to you to ask for help with testing some cool new features
>that we're going to be adding to Launchpad shortly.
>
>We've developed (well, we've contracted people to develop) plugins for
>Bugzilla and Trac that allow bidirectional communication between
>Launchpad and the remote bug trackers that have them installed.
>
>As I said, we need some help testing these plugins. Specifically, we need to
>have them installed on a number of remote bug trackers so that we can use the
>plugins to communicate with those trackers.
>
>If you know of any bug trackers whose administrators might be interested
>in helping us out (or, even better, if you're one of those
>administrators yourself),
>please point them to the following pages on the help wiki, which will
>explain how
>to download and install the Launchpad plugins:
>
>For Bugzilla: http://help.launchpad.net/Bugs/BugzillaPlugin
>For Trac: http://help.launchpad.net/Bugs/TracPlugin
>
>Installing one of the plugins means that:
>
> * Launchpad will be able to forward bugs to upstream bug trackers that
>  have the plugin installed. Users of those bug trackers won't have to
>  check Launchpad for bugs registered against their project; they'll be
>  forwarded straight to the upstream tracker.
>
> * If a bug watch is created against an upstream bug, Launchpad will
>  tell the upstream bug tracker which Launchpad bug is watching it.
>  This means that not only is there a link in Launchpad to the upstream
>  bug, but there's also a link in the upstream bug tracker to the
>  Launchpad bug.
>
> * Launchpad will be able to import comments from upstream bugs which
>  are being watched in Launchpad. If you register a bug watch against
>  an upstream bug you'll be able to read the conversation about that
>  bug on Launchpad, including the comments that are made on the
>  upstream bug tracker.
>
> * Launchpad will be able to push comments to upstream bugs which are
>  linked to a Launchpad bug, so if you add a comment on Launchpad in
>  reply to a comment which was imported from an upstream bug tracker,
>  the comment will automatically be added to the conversation on the
>  upstream bug tracker, too. This means that users of both Launchpad
>  and the upstream tracker can view the whole conversation about the
>  bug without leaving their preferred environments.
>
>If you've got any further questions, please feel free to ask me.
>
>Thanks in advance for your help,
>
>Graham
>
>Hello all,
>
>Launchpad has recently released a Trac plugin that lets Launchpad
>synchronize bugs and bug comments from Launchpad to Trac and vice
>versa.
>
>Can we please install this on our Trac?
>

I got stuck when I got to the part of the installation which called for
the addition of the LAUNCHPAD_RPC permission to the launchpad user.  The
LAUNCHPAD_RPC permission isn't recognized and trac-admin refuses to add
it.

    Command failed: LAUNCHPAD_RPC is not a valid action.

Any suggestions?

Also, it seems like it might be a good idea to recommend on the installation
instructions page that the ability to register a new user named "launchpad"
be disabled before enabling this plugin.  Otherwise anyone can come along
and gain launchpad-level access to a tracker.

Jean-Paul



From exarkun at divmod.com  Wed Aug 27 10:21:51 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 27 Aug 2008 10:21:51 -0400
Subject: [Twisted-Python] Use the Launchpad plugin on our trac? (was
	Fwd: Bugzilla and Trac Launchpad plugins: Request for beta testers)
In-Reply-To: <20080827135457.29191.920749908.divmod.quotient.18733@ohm>
Message-ID: <20080827142151.29191.1149130572.divmod.quotient.18743@ohm>

On Wed, 27 Aug 2008 09:54:57 -0400, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> [snip]
>
>I got stuck when I got to the part of the installation which called for
>the addition of the LAUNCHPAD_RPC permission to the launchpad user.  The
>LAUNCHPAD_RPC permission isn't recognized and trac-admin refuses to add
>it.
>
>    Command failed: LAUNCHPAD_RPC is not a valid action.
>
>Any suggestions?
>

Alright, feel free to ignore that.  Purely an administrative error on my
part.

>Also, it seems like it might be a good idea to recommend on the installation
>instructions page that the ability to register a new user named "launchpad"
>be disabled before enabling this plugin.  Otherwise anyone can come along
>and gain launchpad-level access to a tracker.

I have a couple other questions, also.

What's with the "(Private)" bugs which show up on this page?

  https://launchpad.net/bugs/bugtrackers/twisted-bugs

Who controls the list of projects that show up in the "related projects"
box on that page?  What does it mean to be a "related project"?  Does it
mean bugs for those projects can get synchronized with the upstream bug
tracker, or is it just general information?

Jean-Paul



From psanchez at nortel.com  Wed Aug 27 17:31:40 2008
From: psanchez at nortel.com (Pedro Sanchez)
Date: Wed, 27 Aug 2008 17:31:40 -0400
Subject: [Twisted-Python] An XMPP client with SSL support
Message-ID: <1219872700.10045.29.camel@pcard0ze.ca.nortel.com>

Hello,

I have a sample XMPP client with the following structure:

from twisted.words.protocols.jabber import client, jid
from twisted.internet import reactor
...
factory = client.basicClientFactory(myJid, myPasswd)
reactor.connectTCP(host,5222,factory)
reactor.run()

It works well, I can connect to the XMPP server. But I would appreciate
if some one could give me some hints on what's required to get the
client to connect using a secure SSL link. 

Thanks,

-- 
Pedro







From aldoogy at gmail.com  Thu Aug 28 08:19:50 2008
From: aldoogy at gmail.com (A)
Date: Thu, 28 Aug 2008 13:19:50 +0100
Subject: [Twisted-Python] RemoteReference decref
Message-ID: <48B697E6.3000302@gmail.com>

Hi,
I'm still working on an Actionscript pb client,

and have run into a bit of a conundrum with RemoteReference which is 
using python's built-in __del__  to trigger a decref.
Actionscript doesn't have destructors so I will need to trigger the 
decref manually.

based on my capture of a clent/server converation I am thinking that the 
client could do this in proto_answer

s -:  ('version', 6)
r -:  ['version', 6]
r -:  ['message', 1, 'root', 'login', 1, ['tuple', 'alice'], ['dictionary']]
s -:  ('answer', 1, ['tuple', 
'x\x9b\x95\x1c\tJp\xe0\x96]\xf4\xdb\xeb\x13\t9', ('remote', 1)])
r -:  ['message', 2, 1, 'respond', 1, ['tuple', 
'\x06\x04\xf1vI\xfeP\xa0\xdfzl(\xd9\x7f!t', ['remote', 1]], ['dictionary']]
s -:  ('answer', 2, ('remote', 2))
r -:  ['decref', 1]
r -:  ['message', 3, 2, 'joinGroup', 1, ['tuple', '#lookingForFourth'], 
['dictionary']]
s -:  ('answer', 3, ('remote', 3))
r -:  ['decref', 2]
r -:  ['message', 4, 3, 'send', 1, ['tuple', 'You can call me Al.'], 
['dictionary']]
s -:  ('message', 1, 1, 'print', 1, ['tuple', '<alice> says: You can 
call me Al.'], ['dictionary'])
s -:  ('answer', 4, ['None'])
r -:  ['decref', 3]

Not sure where I get a reference to RemoteReference though.
any ideas ?









From exarkun at divmod.com  Thu Aug 28 08:51:21 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 08:51:21 -0400
Subject: [Twisted-Python] RemoteReference decref
In-Reply-To: <48B697E6.3000302@gmail.com>
Message-ID: <20080828125121.29191.814020133.divmod.quotient.18993@ohm>

On Thu, 28 Aug 2008 13:19:50 +0100, A <aldoogy at gmail.com> wrote:
>Hi,
>I'm still working on an Actionscript pb client,
>
>and have run into a bit of a conundrum with RemoteReference which is using 
>python's built-in __del__  to trigger a decref.
>Actionscript doesn't have destructors so I will need to trigger the decref 
>manually.
>
>based on my capture of a clent/server converation I am thinking that the 
>client could do this in proto_answer

This doesn't sound like it makes sense.  You should only decref when the
object is no longer in use.  If you can't do it from a destructor, then
you have to require application code to do it.  The protocol implementation
can't know when the application has finished using the object.

>
>s -:  ('version', 6)
>r -:  ['version', 6]
>r -:  ['message', 1, 'root', 'login', 1, ['tuple', 'alice'], ['dictionary']]
>s -:  ('answer', 1, ['tuple', 
>'x\x9b\x95\x1c\tJp\xe0\x96]\xf4\xdb\xeb\x13\t9', ('remote', 1)])
>r -:  ['message', 2, 1, 'respond', 1, ['tuple', 
>'\x06\x04\xf1vI\xfeP\xa0\xdfzl(\xd9\x7f!t', ['remote', 1]], ['dictionary']]
>s -:  ('answer', 2, ('remote', 2))
>r -:  ['decref', 1]
>r -:  ['message', 3, 2, 'joinGroup', 1, ['tuple', '#lookingForFourth'], 
>['dictionary']]
>s -:  ('answer', 3, ('remote', 3))
>r -:  ['decref', 2]
>r -:  ['message', 4, 3, 'send', 1, ['tuple', 'You can call me Al.'], 
>['dictionary']]
>s -:  ('message', 1, 1, 'print', 1, ['tuple', '<alice> says: You can call me 
>Al.'], ['dictionary'])
>s -:  ('answer', 4, ['None'])
>r -:  ['decref', 3]
>

The protocol capture shows decrefs after answers purely by coincidence.  If
the application code being run to generate this kept references to the
objects longer, then you wouldn't see this pattern.

Jean-Paul



From pbastov at gmail.com  Thu Aug 28 09:05:38 2008
From: pbastov at gmail.com (Pavel)
Date: Thu, 28 Aug 2008 19:05:38 +0600
Subject: [Twisted-Python] Could not accept new connection
Message-ID: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>

Hi all,

today I got this error in my twisted.log

[twisted.web.server.Site] Could not accept new connection (ECONNABORTED)

What could be a possible cause of this? Any ways to fix it?

Thanks in advance.

-- 
Good luck,

Pavel Bastov



From maarten at treewalker.org  Thu Aug 28 09:17:13 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Thu, 28 Aug 2008 15:17:13 +0200
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
References: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
Message-ID: <200808281517.18725.maarten@treewalker.org>

On Thursday 28 August 2008, Pavel wrote:
> Hi all,
>
> today I got this error in my twisted.log
>
> [twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>
> What could be a possible cause of this? Any ways to fix it?

The (ECONNABORTED) suggests that this error originated in the OS and was 
only propagated by Python and Twisted. Which OS are you using?

The documentation of the C accept() call might help. On my Linux system "man 
2 accept" just says "ECONNABORTED: A connection has been aborted." 
though. :(

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20080828/dd47b21a/attachment.pgp 

From adelagon at gmail.com  Thu Aug 28 09:19:21 2008
From: adelagon at gmail.com (Alvin Delagon)
Date: Thu, 28 Aug 2008 21:19:21 +0800
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
References: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
Message-ID: <7a01f6c00808280619n3b2099efnb4f3bd795a468809@mail.gmail.com>

How many simultaneous clients connected on your server? By default, linux is
configured to have 1024 file descriptors pre process. You may have to set
your ulimit higher.


On Thu, Aug 28, 2008 at 9:05 PM, Pavel <pbastov at gmail.com> wrote:

> Hi all,
>
> today I got this error in my twisted.log
>
> [twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>
> What could be a possible cause of this? Any ways to fix it?
>
> Thanks in advance.
>
> --
> Good luck,
>
> Pavel Bastov
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
http://www.alvinatorsplayground.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080828/3fed2964/attachment.htm 

From exarkun at divmod.com  Thu Aug 28 09:22:30 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 09:22:30 -0400
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
Message-ID: <20080828132230.29191.226457487.divmod.quotient.19005@ohm>

On Thu, 28 Aug 2008 19:05:38 +0600, Pavel <pbastov at gmail.com> wrote:
>Hi all,
>
>today I got this error in my twisted.log
>
>[twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>
>What could be a possible cause of this? Any ways to fix it?
>

This means that a client started to connect to your server but then
quickly aborted the attempt.  The server saw the attempt but before
it could accept the new connection, the client had abandoned it.
Assuming other clients are successfully connecting to your server,
you can safely ignore this.

Jean-Paul



From exarkun at divmod.com  Thu Aug 28 09:23:39 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 09:23:39 -0400
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <7a01f6c00808280619n3b2099efnb4f3bd795a468809@mail.gmail.com>
Message-ID: <20080828132339.29191.36350471.divmod.quotient.19007@ohm>

On Thu, 28 Aug 2008 21:19:21 +0800, Alvin Delagon <adelagon at gmail.com> wrote:
>On Thu, Aug 28, 2008 at 9:05 PM, Pavel <pbastov at gmail.com> wrote:
>
>> Hi all,
>>
>> today I got this error in my twisted.log
>>
>> [twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>>
>> What could be a possible cause of this? Any ways to fix it?
>>
>> Thanks in advance.
>>
>> --
>> Good luck,
>>
>> Pavel Bastov
>>
>
>How many simultaneous clients connected on your server? By default, linux is
>configured to have 1024 file descriptors pre process. You may have to set
>your ulimit higher.
>

Encountering a ulimit on open files will result in EMFILE rather than
ECONNABORTED.

Jean-Paul



From spiritualmechanic at yahoo.com  Thu Aug 28 09:25:40 2008
From: spiritualmechanic at yahoo.com (Steve Lewis)
Date: Thu, 28 Aug 2008 06:25:40 -0700 (PDT)
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
Message-ID: <575469.72443.qm@web33703.mail.mud.yahoo.com>

I'm fairly new to twisted, although we are using it in production. What I'd like to do, is have a simple redlight/greenlight method (over XML-RPC) to tell me which methods have been called successfully at least once. The goal of this is not so much performance or uptime, but to just tell me that we are configured correctly.

We're using twisted as a sort of service bus, so we have a decent amount of configuration that needs to be set up.

What I've considered so far:

1. Modifying each xmlrpc method individually and setting a boolean to True in a dictionary:

       if results:
            self._monitor['xmlrpc.method.name'] = True

This is okay, but I'd like something that is more generic so I don't have to write this code in every single XMLRPC method.

2. Extending/subclassing XMLRPC: 

    def _getFunction(self, functionPath):
        '''
        Overrides XMLRPC._getFunction to use our simple mapper.
        '''
        
        ## attempt default behavior for local methods
        try:
            func = XMLRPC._getFunction(self, functionPath)
            return func
        except NoSuchFunction:
            pass

This would work in my head, but in actuality, the call doesn't actually happen here, it just returns the function.

3. Extending/subclassing QueryProtocol:

    def handleStatus(self, version, status, message):
        if status != '200':
            self.factory.badStatus(status, message)

I could override QueryProtocol and in the handleStatus method set a field in a dictionary.

There are probably many ways to do this wrong, and I'm a Java guy just getting used to the twisted way of doing things. I apologize if my attempts are painful and/or hilarious.

Thanks,
Steve L.



      



From exarkun at divmod.com  Thu Aug 28 11:01:10 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 11:01:10 -0400
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
In-Reply-To: <575469.72443.qm@web33703.mail.mud.yahoo.com>
Message-ID: <20080828150111.29191.660945311.divmod.quotient.19037@ohm>

On Thu, 28 Aug 2008 06:25:40 -0700 (PDT), Steve Lewis <spiritualmechanic at yahoo.com> wrote:
>I'm fairly new to twisted, although we are using it in production. What I'd like to do, is have a simple redlight/greenlight method (over XML-RPC) to tell me which methods have been called successfully at least once. The goal of this is not so much performance or uptime, but to just tell me that we are configured correctly.
>
>We're using twisted as a sort of service bus, so we have a decent amount of configuration that needs to be set up.
>
>What I've considered so far:
>
>[snip]
>
>2. Extending/subclassing XMLRPC:
>
>    def _getFunction(self, functionPath):
>        '''
>        Overrides XMLRPC._getFunction to use our simple mapper.
>        '''
>
>        ## attempt default behavior for local methods
>        try:
>            func = XMLRPC._getFunction(self, functionPath)
>            return func
>        except NoSuchFunction:
>            pass
>
>This would work in my head, but in actuality, the call doesn't actually happen here, it just returns the function.
>

This is probably the best approach.  `_getFunction? should probably be a
public method.  Its docstring directs users to override it, which is rather
in conflict with it being private.

To overcome the problem of the function not actually being called inside
`_getFunction?, you just need to apply a wrapper to the function which is
looked up.  The wrapper can mark the call as successful.  For example:

    def _getFunction(self, functionPath):
        f = XMLRPC._getFunction(self, functionPath)
        def wrapper(*a, **kw):
            result = f(*a, **kw)
            self._monitor[functionPath] = True
            return result
        return wrapper

I'd also recommend filing a ticket to make `_getFunction? public, so that
you don't have to rely on a private hook to make this work.

Jean-Paul



From spiritualmechanic at yahoo.com  Thu Aug 28 13:22:01 2008
From: spiritualmechanic at yahoo.com (Steve Lewis)
Date: Thu, 28 Aug 2008 10:22:01 -0700 (PDT)
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
Message-ID: <275280.69794.qm@web33704.mail.mud.yahoo.com>

Okay, that seems to work. One more question:

We've defined a class called XMLRPCWithRemote that subclasses XMLRPC. Some of the methods are local, others with be called using the Proxy. I tried to wrap the function but I'm getting:

exceptions.AttributeError: Deferred instance has no __call__ method


This is the code I have for wrapping:

              def wrapper(*args, **kw):
                        func = self._getProxy(URL["url"], URL["user"], URL["passwd"]).callRemote(remote_method, *args, **kw)
                        result = func(*args, **kw)
                        monitor[functionPath] = True
                                                
                        return result
                        
                    return wrapper

_getProxy is defined thusly:

    def _getProxy(self, url, username=None, password=None):
        log.msg("Get proxy")
        return Proxy(url, user=username, password=password, allowNone=True, useDateTime=True)


So it looks like I'm getting a deferred back from the callRemote, so it appears harder to wrap? I think that's what's going on. I'm guessing the local method doesn't require a deferred, so that's why it works.

Is there something obvious I'm missing? I started going down the path of overriding xmlrpc.Proxy or xmlrpc._QueryFactory but I'm not sure that's the simplest way.

Thanks a bunch,
Steve



----- Original Message ----
From: Jean-Paul Calderone <exarkun at divmod.com>
To: Twisted general discussion <twisted-python at twistedmatrix.com>
Sent: Thursday, August 28, 2008 4:01:10 PM
Subject: Re: [Twisted-Python] Monitoring configuration of twisted calls.

On Thu, 28 Aug 2008 06:25:40 -0700 (PDT), Steve Lewis <spiritualmechanic at yahoo.com> wrote:
>I'm fairly new to twisted, although we are using it in production. What I'd like to do, is have a simple redlight/greenlight method (over XML-RPC) to tell me which methods have been called successfully at least once. The goal of this is not so much performance or uptime, but to just tell me that we are configured correctly.
>
>We're using twisted as a sort of service bus, so we have a decent amount of configuration that needs to be set up.
>
>What I've considered so far:
>
>[snip]
>
>2. Extending/subclassing XMLRPC:
>
>    def _getFunction(self, functionPath):
>        '''
>        Overrides XMLRPC._getFunction to use our simple mapper.
>        '''
>
>        ## attempt default behavior for local methods
>        try:
>            func = XMLRPC._getFunction(self, functionPath)
>            return func
>        except NoSuchFunction:
>            pass
>
>This would work in my head, but in actuality, the call doesn't actually happen here, it just returns the function.
>

This is probably the best approach.  `_getFunction? should probably be a
public method.  Its docstring directs users to override it, which is rather
in conflict with it being private.

To overcome the problem of the function not actually being called inside
`_getFunction?, you just need to apply a wrapper to the function which is
looked up.  The wrapper can mark the call as successful.  For example:

    def _getFunction(self, functionPath):
        f = XMLRPC._getFunction(self, functionPath)
        def wrapper(*a, **kw):
            result = f(*a, **kw)
            self._monitor[functionPath] = True
            return result
        return wrapper

I'd also recommend filing a ticket to make `_getFunction? public, so that
you don't have to rely on a private hook to make this work.

Jean-Paul

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



      



From exarkun at divmod.com  Thu Aug 28 13:29:17 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 13:29:17 -0400
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
In-Reply-To: <275280.69794.qm@web33704.mail.mud.yahoo.com>
Message-ID: <20080828172917.29191.27032108.divmod.quotient.19077@ohm>

On Thu, 28 Aug 2008 10:22:01 -0700 (PDT), Steve Lewis <spiritualmechanic at yahoo.com> wrote:
>Okay, that seems to work. One more question:
>
>We've defined a class called XMLRPCWithRemote that subclasses XMLRPC. Some of the methods are local, others with be called using the Proxy. I tried to wrap the function but I'm getting:
>
>exceptions.AttributeError: Deferred instance has no __call__ method
>
>
>This is the code I have for wrapping:
>
>              def wrapper(*args, **kw):
>                        func = self._getProxy(URL["url"], URL["user"], URL["passwd"]).callRemote(remote_method, *args, **kw)
>                        result = func(*args, **kw)
>                        monitor[functionPath] = True
>
>                        return result
>
>                    return wrapper
>
>_getProxy is defined thusly:
>
>    def _getProxy(self, url, username=None, password=None):
>        log.msg("Get proxy")
>        return Proxy(url, user=username, password=password, allowNone=True, useDateTime=True)
>
>
>So it looks like I'm getting a deferred back from the callRemote, so it appears harder to wrap? I think that's what's going on. I'm guessing the local method doesn't require a deferred, so that's why it works.
>
>Is there something obvious I'm missing? I started going down the path of overriding xmlrpc.Proxy or xmlrpc._QueryFactory but I'm not sure that's the simplest way.

The wrapper I gave as an example doesn't handle Deferreds, indeed.  Have
you worked with Deferreds before?  If not, you may want to read some of
the documentation about them, eg:

 http://twistedmatrix.com/projects/core/documentation/howto/defer.html

That aside, I don't really understand the modifications you've made.  It
seems that you're doing an XML-RPC call to get a function object to call
to produce a result to give to the XML-RPC client which made a call on to
you.  Since XML-RPC calls can't result in functions, I don't understand
this.

Jean-Paul



From spiritualmechanic at yahoo.com  Thu Aug 28 13:42:13 2008
From: spiritualmechanic at yahoo.com (Steve Lewis)
Date: Thu, 28 Aug 2008 10:42:13 -0700 (PDT)
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
Message-ID: <945109.84090.qm@web33704.mail.mud.yahoo.com>

Actually, I think I just figured it out:

                    def wrapper(*args, **kw):
                        func = self._getProxy(URL["url"], URL["user"], URL["passwd"]).callRemote(remote_method, *args, **kw)
                        
                        func.addCallback(self.handleSuccess, method)
                                                
                        return func
                        
                    return wrapper

All I needed was to add a callback!
Steve



----- Original Message ----
From: Jean-Paul Calderone <exarkun at divmod.com>
To: Twisted general discussion <twisted-python at twistedmatrix.com>
Sent: Thursday, August 28, 2008 4:01:10 PM
Subject: Re: [Twisted-Python] Monitoring configuration of twisted calls.

On Thu, 28 Aug 2008 06:25:40 -0700 (PDT), Steve Lewis <spiritualmechanic at yahoo.com> wrote:
>I'm fairly new to twisted, although we are using it in production. What I'd like to do, is have a simple redlight/greenlight method (over XML-RPC) to tell me which methods have been called successfully at least once. The goal of this is not so much performance or uptime, but to just tell me that we are configured correctly.
>
>We're using twisted as a sort of service bus, so we have a decent amount of configuration that needs to be set up.
>
>What I've considered so far:
>
>[snip]
>
>2. Extending/subclassing XMLRPC:
>
>    def _getFunction(self, functionPath):
>        '''
>        Overrides XMLRPC._getFunction to use our simple mapper.
>        '''
>
>        ## attempt default behavior for local methods
>        try:
>            func = XMLRPC._getFunction(self, functionPath)
>            return func
>        except NoSuchFunction:
>            pass
>
>This would work in my head, but in actuality, the call doesn't actually happen here, it just returns the function.
>

This is probably the best approach.  `_getFunction? should probably be a
public method.  Its docstring directs users to override it, which is rather
in conflict with it being private.

To overcome the problem of the function not actually being called inside
`_getFunction?, you just need to apply a wrapper to the function which is
looked up.  The wrapper can mark the call as successful.  For example:

    def _getFunction(self, functionPath):
        f = XMLRPC._getFunction(self, functionPath)
        def wrapper(*a, **kw):
            result = f(*a, **kw)
            self._monitor[functionPath] = True
            return result
        return wrapper

I'd also recommend filing a ticket to make `_getFunction? public, so that
you don't have to rely on a private hook to make this work.

Jean-Paul

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



      



From ellisonbg.net at gmail.com  Thu Aug 28 14:52:02 2008
From: ellisonbg.net at gmail.com (Brian Granger)
Date: Thu, 28 Aug 2008 11:52:02 -0700
Subject: [Twisted-Python] "_wait" is blowing up?!
In-Reply-To: <20080824080803.25821.1654368831.divmod.xquotient.14873@joule.divmod.com>
References: <6ce0ac130808232325p666a93cdl85c5cdc54a1a8328@mail.gmail.com>
	<20080824080803.25821.1654368831.divmod.xquotient.14873@joule.divmod.com>
Message-ID: <6ce0ac130808281152x5b10b6baq67020919e15dd4d2@mail.gmail.com>

> Is your code available somewhere?

yes, the code is the IPython mainline, on launchpad:

$ bzr branch lp:ipython

Then, simply

$ trial IPython

Will show the problem.  You will also need foolcap to run the test suite.

> Do you reliably see this error eventually if you use trial --until- failure?

It shows up as an Error rather than a Failure.  But yes, it still shows up.

> Exactly what version of Twisted are you using?

Latest stable.

> What reactor do you typically run your tests under?

Default on all platforms.

> Not sure that I'd be able to tell you what's going on even with an answer to
> all of these questions, but they'd be a start :).

Thanks, I know this type of thing is tough to debug.  Any clever
tricks I could use to track it down?

Thanks

Brian

> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From exarkun at divmod.com  Thu Aug 28 15:11:33 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 15:11:33 -0400
Subject: [Twisted-Python] "_wait" is blowing up?!
In-Reply-To: <6ce0ac130808281152x5b10b6baq67020919e15dd4d2@mail.gmail.com>
Message-ID: <20080828191133.29191.157249331.divmod.quotient.19100@ohm>



On Thu, 28 Aug 2008 11:52:02 -0700, Brian Granger <ellisonbg.net at gmail.com> wrote:
>> Is your code available somewhere?
>
>yes, the code is the IPython mainline, on launchpad:
>
>$ bzr branch lp:ipython
>
>Then, simply
>
>$ trial IPython
>
>Will show the problem.  You will also need foolcap to run the test suite.
>
>> Do you reliably see this error eventually if you use trial --until- failure?
>
>It shows up as an Error rather than a Failure.  But yes, it still shows up.
>
>> Exactly what version of Twisted are you using?
>
>Latest stable.
>
>> What reactor do you typically run your tests under?
>
>Default on all platforms.
>
>> Not sure that I'd be able to tell you what's going on even with an answer to
>> all of these questions, but they'd be a start :).
>
>Thanks, I know this type of thing is tough to debug.  Any clever
>tricks I could use to track it down?

You can try running with trial --debug (possibly also --nopm).  This will
cause Deferred debugging to be enabled, which will cause the call site of
each Deferred's creation to be saved.  Then you can inspect this to learn
which Deferred is being called back multiple times.  Once you learn this,
further debugging approaches may become apparent (like looking at all the
call sites which can call back a Deferred created there, and figuring out
how more than one of them can be executed).

Jean-Paul



From faraz.khan at emergen.biz  Fri Aug 29 04:08:14 2008
From: faraz.khan at emergen.biz (Faraz Khan)
Date: Fri, 29 Aug 2008 14:08:14 +0600
Subject: [Twisted-Python] Is  Ldaptor stable / still maintained?
In-Reply-To: <48B54529.5070000@inf.ufrgs.br>
References: <48B54529.5070000@inf.ufrgs.br>
Message-ID: <48B7AE6E.9070708@emergen.biz>

I use python-ldap rigorously without issues...

Luciano Cavalheiro da Silva wrote:
> Hi there,
> 
> Anybody could tell me whether Ldaptor, which is build on top of twisted,
> is still maintained or has been abandoned? Is it stable? I've found on
> its home page it has not been updated in the last 3 years...
> 
> I'm starting a project (production system) in python which has to access
> an Openldap server, so I'm in doubt what would be better to use by now,
> ldaptor or python-ldap?
> 
> Best regards,
> 
>         Luciano
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 

-- 
Faraz R Khan
Chief Architect
Emergen Consulting Pvt Ltd
+92.21.529.0381 x200
www.emergen.biz




From pbastov at gmail.com  Fri Aug 29 04:20:45 2008
From: pbastov at gmail.com (Pavel)
Date: Fri, 29 Aug 2008 14:20:45 +0600
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <20080828132339.29191.36350471.divmod.quotient.19007@ohm>
References: <7a01f6c00808280619n3b2099efnb4f3bd795a468809@mail.gmail.com>
	<20080828132339.29191.36350471.divmod.quotient.19007@ohm>
Message-ID: <eaf39e680808290120g380fff90ne5b55030c5c4321b@mail.gmail.com>

Thanks for your replies.

I don't think I have reached the limit of 1024 connections. Other
clients are connecting successfully to
the server, so, I think I should ignore this error as Jean-Paul suggests.

On Thu, Aug 28, 2008 at 7:23 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Thu, 28 Aug 2008 21:19:21 +0800, Alvin Delagon <adelagon at gmail.com>
> wrote:
>>
>> On Thu, Aug 28, 2008 at 9:05 PM, Pavel <pbastov at gmail.com> wrote:
>>
>>> Hi all,
>>>
>>> today I got this error in my twisted.log
>>>
>>> [twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>>>
>>> What could be a possible cause of this? Any ways to fix it?
>>>
>>> Thanks in advance.
>>>
>>> --
>>> Good luck,
>>>
>>> Pavel Bastov
>>>
>>
>> How many simultaneous clients connected on your server? By default, linux
>> is
>> configured to have 1024 file descriptors pre process. You may have to set
>> your ulimit higher.
>>
>
> Encountering a ulimit on open files will result in EMFILE rather than
> ECONNABORTED.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Good luck,

Pavel Bastov
xooChat Team Leader
http://www.xoochat.com/



From gabriel.rossetti at arimaz.com  Fri Aug 29 05:06:59 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 29 Aug 2008 11:06:59 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
Message-ID: <48B7BC33.7090501@arimaz.com>

Hello everyone,

Here's the problem : I need to run a windows executable (proprietary, 
they won't give us the code) with wine to do some audio compression. I 
need to do different processing before (like calling sox, or parsing 
files, etc) so I wrote some functions that do everything. The windows 
exec creates a tmp file named "_tmp" in the working dir, so if I want to 
run several in parallel, I have to create a tmp dir with a unique name 
and change the working dir, if not then the multiple executions will 
overwrite each other's tmp file. So when I call my function that does 
the whole process, I first create a tmp dir, then pass it the tmp dir 
and the input filename, then once inside the function, it does an 
os.chDir() into the tmp dir and at the end it does it again to go back 
to the original current dir. Then I run that function in threads. The 
problem is that threads share the current dir :

http://www.biais.org/blog/index.php/2007/01/23/19-python-threads-and-oschdir 

http://bugs.python.org/issue1367

so I need to use processes instead, as they each have their own current 
dir. The thing is that from what I understand, Twisted's process API is 
intended to be used with external executables only, correct? I wasn' t 
able to fins anything that allowed me to do stuff like I would using 
fork(). Should I just use python's fock() instead? Is it safe with Twisted?

Thank you,
Gabriel



From maarten at treewalker.org  Fri Aug 29 05:23:50 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Fri, 29 Aug 2008 11:23:50 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <48B7BC33.7090501@arimaz.com>
References: <48B7BC33.7090501@arimaz.com>
Message-ID: <200808291123.58131.maarten@treewalker.org>

On Friday 29 August 2008, Gabriel Rossetti wrote:

> Here's the problem : I need to run a windows executable (proprietary,
> they won't give us the code) with wine to do some audio compression. I
> need to do different processing before (like calling sox, or parsing
> files, etc) so I wrote some functions that do everything. The windows
> exec creates a tmp file named "_tmp" in the working dir, so if I want to
> run several in parallel, I have to create a tmp dir with a unique name
> and change the working dir, if not then the multiple executions will
> overwrite each other's tmp file. So when I call my function that does
> the whole process, I first create a tmp dir, then pass it the tmp dir
> and the input filename, then once inside the function, it does an
> os.chDir() into the tmp dir and at the end it does it again to go back
> to the original current dir. Then I run that function in threads. The
> problem is that threads share the current dir :

Maybe you could bypass this problem by generating a short shell script that 
does "cd" before it starts Wine? Since the shell will be a separate 
process, it has its own working dir.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20080829/6cdfa031/attachment.pgp 

From gabriel.rossetti at arimaz.com  Fri Aug 29 05:45:53 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 29 Aug 2008 11:45:53 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <200808291123.58131.maarten@treewalker.org>
References: <48B7BC33.7090501@arimaz.com>
	<200808291123.58131.maarten@treewalker.org>
Message-ID: <48B7C551.7000101@arimaz.com>

Maarten ter Huurne wrote:
> On Friday 29 August 2008, Gabriel Rossetti wrote:
>
>   
>> Here's the problem : I need to run a windows executable (proprietary,
>> they won't give us the code) with wine to do some audio compression. I
>> need to do different processing before (like calling sox, or parsing
>> files, etc) so I wrote some functions that do everything. The windows
>> exec creates a tmp file named "_tmp" in the working dir, so if I want to
>> run several in parallel, I have to create a tmp dir with a unique name
>> and change the working dir, if not then the multiple executions will
>> overwrite each other's tmp file. So when I call my function that does
>> the whole process, I first create a tmp dir, then pass it the tmp dir
>> and the input filename, then once inside the function, it does an
>> os.chDir() into the tmp dir and at the end it does it again to go back
>> to the original current dir. Then I run that function in threads. The
>> problem is that threads share the current dir :
>>     
>
> Maybe you could bypass this problem by generating a short shell script that 
> does "cd" before it starts Wine? Since the shell will be a separate 
> process, it has its own working dir.
>
> Bye,
> 		Maarten
>   
I'd rather not, because that would mean implementing everything (the 
whole conversion process) in the script.
I have stuff to do before the conversion,preparations, those could be 
done in the script, and after : parsing output,
filter and modify the data & then write the new data in binary form -- 
which is harder to do from a non-python shell script.

Maybe I could use a standalone python shell script? Is there no other 
solution?

bye,
Gabriel



From maarten at treewalker.org  Fri Aug 29 06:07:07 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Fri, 29 Aug 2008 12:07:07 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <48B7C551.7000101@arimaz.com>
References: <48B7BC33.7090501@arimaz.com>
	<200808291123.58131.maarten@treewalker.org>
	<48B7C551.7000101@arimaz.com>
Message-ID: <200808291207.15202.maarten@treewalker.org>

On Friday 29 August 2008, Gabriel Rossetti wrote:
> Maarten ter Huurne wrote:
> > Maybe you could bypass this problem by generating a short shell script
> > that does "cd" before it starts Wine? Since the shell will be a
> > separate process, it has its own working dir.
>
> I'd rather not, because that would mean implementing everything (the
> whole conversion process) in the script.

Do the other processing steps also require the working directory to be 
changed? Most unix programs work fine from any dir as long as you provide 
absolute paths for the input and output files.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20080829/91b9eea4/attachment.pgp 

From gabriel.rossetti at arimaz.com  Fri Aug 29 06:40:31 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 29 Aug 2008 12:40:31 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <200808291207.15202.maarten@treewalker.org>
References: <48B7BC33.7090501@arimaz.com>	<200808291123.58131.maarten@treewalker.org>	<48B7C551.7000101@arimaz.com>
	<200808291207.15202.maarten@treewalker.org>
Message-ID: <48B7D21F.5040007@arimaz.com>

Maarten ter Huurne wrote:
> On Friday 29 August 2008, Gabriel Rossetti wrote:
>   
>> Maarten ter Huurne wrote:
>>     
>>> Maybe you could bypass this problem by generating a short shell script
>>> that does "cd" before it starts Wine? Since the shell will be a
>>> separate process, it has its own working dir.
>>>       
>> I'd rather not, because that would mean implementing everything (the
>> whole conversion process) in the script.
>>     
>
> Do the other processing steps also require the working directory to be 
> changed? Most unix programs work fine from any dir as long as you provide 
> absolute paths for the input and output files.
>
> Bye,
> 		Maarten
>   
Hmmm, good question, let me investigate that, I'll keep you updated.

Bye,
Gabriel



From gabriel.rossetti at arimaz.com  Fri Aug 29 07:38:00 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 29 Aug 2008 13:38:00 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <200808291207.15202.maarten@treewalker.org>
References: <48B7BC33.7090501@arimaz.com>	<200808291123.58131.maarten@treewalker.org>	<48B7C551.7000101@arimaz.com>
	<200808291207.15202.maarten@treewalker.org>
Message-ID: <48B7DF98.3020305@arimaz.com>

Maarten ter Huurne wrote:
> On Friday 29 August 2008, Gabriel Rossetti wrote:
>   
>> Maarten ter Huurne wrote:
>>     
>>> Maybe you could bypass this problem by generating a short shell script
>>> that does "cd" before it starts Wine? Since the shell will be a
>>> separate process, it has its own working dir.
>>>       
>> I'd rather not, because that would mean implementing everything (the
>> whole conversion process) in the script.
>>     
>
> Do the other processing steps also require the working directory to be 
> changed? Most unix programs work fine from any dir as long as you provide 
> absolute paths for the input and output files.
>
> Bye,
> 		Maarten
>   
Maarten,

It worked, I was able to do the pre & post processing using abs paths 
(thus from outside of the working dir)
and the encoding was done from a script that changed the working directory.

Thank you,
Gabriel



From glyph at divmod.com  Fri Aug 29 09:35:24 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Fri, 29 Aug 2008 13:35:24 -0000
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <48B7BC33.7090501@arimaz.com>
References: <48B7BC33.7090501@arimaz.com>
Message-ID: <20080829133524.25821.2120076452.divmod.xquotient.15068@joule.divmod.com>

On 09:06 am, gabriel.rossetti at arimaz.com wrote:
>http://www.biais.org/blog/index.php/2007/01/23/19-python-threads-and- 
>oschdir
>http://bugs.python.org/issue1367
>
>so I need to use processes instead, as they each have their own current 
>dir. The thing is that from what I understand, Twisted's process API is 
>intended to be used with external executables only, correct? I wasn' t 
>able to fins anything that allowed me to do stuff like I would using 
>fork(). Should I just use python's fock() instead? Is it safe with 
>Twisted?

As it happens, "python" is an "external executable".  Here's an example 
of spawning it in such a way as to make sure that sys.path is set 
properly: 
http://divmod.org/trac/browser/trunk/Epsilon/epsilon/process.py#L7

However, Wine is also an external process.  Perhaps you just want to 
spawn the Wine command-line using spawnProcess using the 'path' 
parameter set to a directory that you have created in the main process, 
then clean it up when the process exits?

http://twistedmatrix.com/documents/8.1.0/api/twisted.internet.interfaces.IReactorProcess.spawnProcess.html

Using fork() in Python has a lot of confusing issues associated with it 
unless you're going to exec() immediately afterwards.  You probably want 
to stick to one of these other approaches.



From exarkun at divmod.com  Fri Aug 29 09:47:46 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Fri, 29 Aug 2008 09:47:46 -0400
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <20080829133524.25821.2120076452.divmod.xquotient.15068@joule.divmod.com>
Message-ID: <20080829134746.29191.1580174472.divmod.quotient.19372@ohm>

On Fri, 29 Aug 2008 13:35:24 -0000, glyph at divmod.com wrote:
>On 09:06 am, gabriel.rossetti at arimaz.com wrote:
>>
>> [snip]
>>Should I just use python's fock() instead? Is it safe with Twisted?
>
> [snip]
>
>Using fork() in Python has a lot of confusing issues associated with it 
>unless you're going to exec() immediately afterwards.  You probably want to 
>stick to one of these other approaches.
>

You also need to do some other stuff before you call fork(), like close
file descriptors and disable garbage collection.  And then re-enable it
in the parent after the fork().  There's probably even some more things
that are necessary that no one has realized yet.

Jean-Paul



From rlott at evertz.com  Fri Aug 29 11:35:59 2008
From: rlott at evertz.com (Rodney Lott)
Date: Fri, 29 Aug 2008 11:35:59 -0400
Subject: [Twisted-Python] How does the pollreactor work?
Message-ID: <069B6B31F6201B4389D7EEB9AD827BCA05005AF9@otis.burlington.evertz.tv>

Hi, there.

I have been trying to figure out how to use the twisted.internet.pollreactor so that I can use it to monitor a Linux named PIPE (i.e. a FIFO created using mkfifo()).  I tried without success to Google some examples but I couldn't find anything.

Now, for a simple TCP server, the setup looks something like this (i.e. like the QOTD example in the documentation):

	from twisted.internet.protocol import Protocol, Factory
	from twisted.internet import reactor
	
	class QOTD(Protocol):
	
	    def connectionMade(self):
	        self.transport.write("An apple a day keeps the doctor away\r\n") 
	        self.transport.loseConnection()
	
	# Next lines are magic:
	factory = Factory()
	factory.protocol = QOTD
	
	# 8007 is the port you want to run under. Choose something >1024
	reactor.listenTCP(8007, factory)
	reactor.run()

So, the TCP type of reactor has something that tells it to listen to port 8007 and use some form of factory or object to take care of things when a connection occurs.  As far as I can guess, I would need to do some steps like this (NOTE: using mixture of real and pseudo code):

	from twisted.internet import pollreactor
	pollreactor.install()

	<create a FileDescriptor object using /tmp/myfifo, maybe a class?>
	<use the reactor.addReader() call to register the FileDescriptor object with the reactor>
	<call reactor.run() (no loop) or call reactor.doPoll() (in a loop, processing returned events)?>

Anyways, if anyone can give me some direction on how this reactor works.  Ideally, I would assume that the relationships would be somewhat like this:

	Protocol analogous to FileDescriptor
	reactor.listenTCP analogous to reactor.addReader()
	reactor.run() would invoke the appropriate call in my FileDescriptor-based class to handle any read events on /tmp/myfifo

Thanks in advance.

-Rodney

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080829/6afb72ff/attachment.htm 

From aldoogy at gmail.com  Fri Aug 29 11:44:16 2008
From: aldoogy at gmail.com (A)
Date: Fri, 29 Aug 2008 16:44:16 +0100
Subject: [Twisted-Python] RemoteReference decref
In-Reply-To: <20080828125121.29191.814020133.divmod.quotient.18993@ohm>
References: <20080828125121.29191.814020133.divmod.quotient.18993@ohm>
Message-ID: <48B81950.5030700@gmail.com>

Thanks I didn't quite understand what decref was for.
I thought it might be the cause of another problem I was having.
but it's not a major problem - decref will just have to be triggered 
manually in an AS client.

I have a tendency to just jump in at the deep end and hope I can figure 
things out  .. .
so I really appreciate the help.

Jean-Paul Calderone wrote:
> On Thu, 28 Aug 2008 13:19:50 +0100, A <aldoogy at gmail.com> wrote:
>> Hi,
>> I'm still working on an Actionscript pb client,
>>
>> and have run into a bit of a conundrum with RemoteReference which is 
>> using python's built-in __del__  to trigger a decref.
>> Actionscript doesn't have destructors so I will need to trigger the 
>> decref manually.
>>
>> based on my capture of a clent/server converation I am thinking that 
>> the client could do this in proto_answer
>
> This doesn't sound like it makes sense.  You should only decref when the
> object is no longer in use.  If you can't do it from a destructor, then
> you have to require application code to do it.  The protocol 
> implementation
> can't know when the application has finished using the object.
>
>>
>> s -:  ('version', 6)
>> r -:  ['version', 6]
>> r -:  ['message', 1, 'root', 'login', 1, ['tuple', 'alice'], 
>> ['dictionary']]
>> s -:  ('answer', 1, ['tuple', 
>> 'x\x9b\x95\x1c\tJp\xe0\x96]\xf4\xdb\xeb\x13\t9', ('remote', 1)])
>> r -:  ['message', 2, 1, 'respond', 1, ['tuple', 
>> '\x06\x04\xf1vI\xfeP\xa0\xdfzl(\xd9\x7f!t', ['remote', 1]], 
>> ['dictionary']]
>> s -:  ('answer', 2, ('remote', 2))
>> r -:  ['decref', 1]
>> r -:  ['message', 3, 2, 'joinGroup', 1, ['tuple', 
>> '#lookingForFourth'], ['dictionary']]
>> s -:  ('answer', 3, ('remote', 3))
>> r -:  ['decref', 2]
>> r -:  ['message', 4, 3, 'send', 1, ['tuple', 'You can call me Al.'], 
>> ['dictionary']]
>> s -:  ('message', 1, 1, 'print', 1, ['tuple', '<alice> says: You can 
>> call me Al.'], ['dictionary'])
>> s -:  ('answer', 4, ['None'])
>> r -:  ['decref', 3]
>>
>
> The protocol capture shows decrefs after answers purely by 
> coincidence.  If
> the application code being run to generate this kept references to the
> objects longer, then you wouldn't see this pattern.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>




From ddwiggins at advpubtech.com  Fri Aug 29 12:12:24 2008
From: ddwiggins at advpubtech.com (Don Dwiggins)
Date: Fri, 29 Aug 2008 09:12:24 -0700
Subject: [Twisted-Python] Controlling logging in xmlrpc server
Message-ID: <g99759$6ab$1@ger.gmane.org>

I have an XMLRPC server running nicely, and have set up logging to a 
file using t.p.log (mainly for debugging).  It all works fine, but I'm 
getting entries in the log like the following:

2008/08/28 16:44 -0700 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - - 
[28/Aug/2008:23:44:02 +0000] "POST / HTTP/1.1" 200 683 "-" 
"Zend_XmlRpc_Client"

(all one line -- excuse the folding).

I'd like to be able to control this: disable these log messages when I 
want, log additional information about the request, etc.  (In 
particular, I'd like to see the xmlrpc "method" name.)

I've tracked down the source of the messages to HTTPFactory.log in 
t.w.http.py.  At this point, I'm not sure how to proceed.  I don't use 
the factory explicitly, just instantiate a subclass of xmlrpc.XMLRPC, 
wrap it in a server.Site and pass it to the default reactor.  What would 
I need to do to access the HTTPFactory (or maybe subclass it) in this 
context?  Is there a better approach to this?

Thanks,
-- 
Don Dwiggins
Advanced Publishing Technology




From glyph at divmod.com  Fri Aug 29 17:20:34 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Fri, 29 Aug 2008 21:20:34 -0000
Subject: [Twisted-Python] How does the pollreactor work?
In-Reply-To: <069B6B31F6201B4389D7EEB9AD827BCA05005AF9@otis.burlington.evertz.tv>
References: <069B6B31F6201B4389D7EEB9AD827BCA05005AF9@otis.burlington.evertz.tv>
Message-ID: <20080829212034.25821.1674589899.divmod.xquotient.15110@joule.divmod.com>


On 03:35 pm, rlott at evertz.com wrote:
>I have been trying to figure out how to use the 
>twisted.internet.pollreactor so that I can use it to monitor a Linux 
>named PIPE (i.e. a FIFO created using mkfifo()).  I tried without 
>success to Google some examples but I couldn't find anything.

This doesn't really have anything to do with pollreactor.  Any reactor 
that implements IReactorFDSet can monitor a pipe.

It was easier for me to implement this than to explain what to do, so 
here's the code for monitoring a named pipe for read, given its name. 
I'm pretty sure it's not 100% correct, but if you want to read about 
handling I/O events from fifos on your platform, you are welcome to do 
so.

    import os
    from twisted.internet.abstract import FileDescriptor
    from twisted.internet.main import CONNECTION_DONE

    class FIFODescriptor(FileDescriptor):
        def __init__(self, reactor, fifoname, protocol):
            FileDescriptor.__init__(self, reactor)
            self.fifo = os.open(fifoname, os.O_NONBLOCK | os.O_RDONLY)
            self.protocol = protocol
            self.protocol.makeConnection(self)

        def connectionLost(self, reason):
            self.protocol.connectionLost(reason)

        def doRead(self):
            data = os.read(self.fifo, 1024)
            if data:
                self.protocol.dataReceived(data)
            else:
                self.stopReading()
                self.connectionLost(CONNECTION_DONE)

        def fileno(self):
            return self.fifo


And here's a brief program that uses it:

    import sys
    from twisted.internet import reactor
    from twisted.internet.protocol import Protocol
    class PrintingProtocol(Protocol):
        def dataReceived(self, data):
            print 'data', repr(data)
        def connectionMade(self):
            print 'hi'
        def connectionLost(self, reason):
            print 'bye', reason
    fifd = FIFODescriptor(reactor, sys.argv[1], PrintingProtocol())
    fifd.startReading()
    reactor.run()

I tested this by doing 'mkfifo x; python fifo.py x', and in another 
terminal, 'cat > x'.  It should be pretty self-explanitory.



From exarkun at twistedmatrix.com  Sun Aug 31 00:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 31 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1220155509.74.1568671090@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20080831/5e83d670/attachment.htm 

From jack-tp at cs.york.ac.uk  Fri Aug  1 06:18:18 2008
From: jack-tp at cs.york.ac.uk (Jack Whitham)
Date: Fri, 1 Aug 2008 13:18:18 +0100
Subject: [Twisted-Python] Modifying Conch example
In-Reply-To: <324cfb540807310819k4a0eb792w6960be9031dcb7b6@mail.gmail.com>
References: <51a7308f0807230139j6c3f333emc538012b4dee43f7@mail.gmail.com>
	<20080723100055.GA24868@cs.york.ac.uk>
	<324cfb540807310819k4a0eb792w6960be9031dcb7b6@mail.gmail.com>
Message-ID: <20080801121818.GA10742@cs.york.ac.uk>

On Thu, Jul 31, 2008 at 11:19:53AM -0400, Paul Swartz wrote:
> On Wed, Jul 23, 2008 at 6:00 AM, Jack Whitham <jack-tp at cs.york.ac.uk> wrote:
> > On Wed, Jul 23, 2008 at 01:39:19AM -0700, Pump Kin wrote:
> >> Step 1) Is really bugging me here; I can't seem to strip the need for
> >> foreknowledge of the public key from the script. I can't easily
> >> programmatically access that information in my use case. I do however have
> >> ready access to the private key and fingerprint for verification. My
> >> modified tutorial scripts just vomit.
> >
> > I had the same problem. Some new key management features have been
> > added to Conch recently, so you now only need the private key:
> >
> > class ClientUserAuth(userauth.SSHUserAuthClient):
> >    def getPrivateKey(self):
> >        return defer.succeed(self.__getKey().keyObject)
> >
> > (Although I still get a deprecation warning about signData if
> > I do this..)
> 
> You're getting the deprecation warning because you're not calling back
> the Deferred with a Key object; you're calling it back with a PyCrypto
> key object (that's what .keyObject is)

Thanks, but this does not fix it. The deprecation warning is:

/usr/lib/python2.5/site-packages/twisted/conch/ssh/userauth.py:376: DeprecationWarning: signData is deprecated since Twisted Conch 0.9.  Use Key(obj).sign(data).
  return keys.signData(privateKey, signData)

I still get this warning even if I change my code to remove ".keyObject"
but authentication no longer works if I do that. It looks like this is
actually a bug in my copy of userauth.py (although it is not a serious
problem - just a deprecation warning). I could get around the
problem by reimplementing the signData method in SSHUserAuthClient.
I am using version 8.1.0 as distributed by Debian, i.e.
http://packages.debian.org/lenny/python-twisted-conch


-- 
Jack Whitham
jack at cs.york.ac.uk




From tarjei at nu.no  Sat Aug  2 08:00:20 2008
From: tarjei at nu.no (tarjei)
Date: Sat, 02 Aug 2008 16:00:20 +0200
Subject: [Twisted-Python] Minor bug in FTPFactory
In-Reply-To: <29ec21540807311710k49b43512g20b2fe12927f3586@mail.gmail.com>
References: <29ec21540807311710k49b43512g20b2fe12927f3586@mail.gmail.com>
Message-ID: <48946874.80506@nu.no>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Adriano Marques wrote:
> Hi folks,
> 
> I found a bug at FTPFactory class. Here is the link to the code:
> http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/protocols/ftp.py#L1247
> 
> The argument userAnonymous is useless as the instance variable is not
> being set by the value received by this argument during object
> construction.
> I don't know if here is the place for such discussion. Is there
> another better place for that? Also, am I supposed to send a patch
> fixing that here? I don't know if this mailing list accept
> attachments.

Hi, the correct thing to do is to write a unittest for it (in [1]) and a
patch and attach it to a ticket on the Twisted website.

1.
http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/test/test_ftp.py

Kind regards,
Tarjei


> 
> 
> Kind Regards,
> 

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFIlGh0YVRKCnSvzfIRAuAWAJ9BePRiBHmW0JuVXXaAK7GEKOe0hgCfW/+1
ysbBQXD17R44yQLAbIJPhkI=
=BhiA
-----END PGP SIGNATURE-----



From exarkun at twistedmatrix.com  Sat Aug  2 22:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 03 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1217736309.84.1621702059@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080803/0dbe8e97/attachment.html>

From gabriel.rossetti at arimaz.com  Mon Aug  4 01:48:10 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 04 Aug 2008 09:48:10 +0200
Subject: [Twisted-Python] HTTP interface to a program using twisted
Message-ID: <4896B43A.9060700@arimaz.com>

Hello everyone,

I have a program using twisted and I'd like it to obtain it's data via 
the HTTP protocol. The idea is that the clients will connect to a 
service using HTTP and will send it data encapsulated in the HTTP. The 
data will be extracted and sent on to another service to process  it, 
which will in turn send the processed data back to the HTTP service to 
send back to the client. I think twisted.web and/or twisted.web2 should 
be used for this, is that correct? I don't quite get the difference in 
between web/web2, could someone please enlighten me? I have read the 
documentation but it doesn't say much.

Thank you,
Gabriel Rossetti



From p.mayers at imperial.ac.uk  Mon Aug  4 03:25:50 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 4 Aug 2008 10:25:50 +0100
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <4896B43A.9060700@arimaz.com>
References: <4896B43A.9060700@arimaz.com>
Message-ID: <20080804092550.GC32231@doorstop.net.ic.ac.uk>

On Mon, Aug 04, 2008 at 09:48:10AM +0200, Gabriel Rossetti wrote:
> Hello everyone,
>
> I have a program using twisted and I'd like it to obtain it's data via  
> the HTTP protocol. The idea is that the clients will connect to a  

It's best to ask such questions on the twisted-web list.

> service using HTTP and will send it data encapsulated in the HTTP. The  
> data will be extracted and sent on to another service to process  it,  
> which will in turn send the processed data back to the HTTP service to  
> send back to the client. I think twisted.web and/or twisted.web2 should  
> be used for this, is that correct? I don't quite get the difference in  
> between web/web2, could someone please enlighten me? I have read the  
> documentation but it doesn't say much.

Use twisted.web - twisted.web2 will have all its good bits stolen and 
put into .web, then be (I guess) deprecated:

  http://twistedmatrix.com/trac/wiki/TwistedWebPlan

Can someone with access re-add this prominent link to the twistedmatrix 
front page?



From gabriel.rossetti at arimaz.com  Mon Aug  4 06:20:39 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 04 Aug 2008 14:20:39 +0200
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <20080804092550.GC32231@doorstop.net.ic.ac.uk>
References: <4896B43A.9060700@arimaz.com>
	<20080804092550.GC32231@doorstop.net.ic.ac.uk>
Message-ID: <4896F417.2070001@arimaz.com>

Phil Mayers wrote:
> On Mon, Aug 04, 2008 at 09:48:10AM +0200, Gabriel Rossetti wrote:
>> Hello everyone,
>>
>> I have a program using twisted and I'd like it to obtain it's data 
>> via  the HTTP protocol. The idea is that the clients will connect to a  
>
> It's best to ask such questions on the twisted-web list.
>
Ok, but I just want to make sure first it's better to use twisted.web 
rather than implementing my own protocol, since I won't be serving any 
web pages and to me it seams twisted.web is designed to serve web content.
>> service using HTTP and will send it data encapsulated in the HTTP. 
>> The  data will be extracted and sent on to another service to 
>> process  it,  which will in turn send the processed data back to the 
>> HTTP service to  send back to the client. I think twisted.web and/or 
>> twisted.web2 should  be used for this, is that correct? I don't quite 
>> get the difference in  between web/web2, could someone please 
>> enlighten me? I have read the  documentation but it doesn't say much.
>
> Use twisted.web - twisted.web2 will have all its good bits stolen and 
> put into .web, then be (I guess) deprecated:
>
>  http://twistedmatrix.com/trac/wiki/TwistedWebPlan
Ok
>
> Can someone with access re-add this prominent link to the 
> twistedmatrix front page?
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From p.mayers at imperial.ac.uk  Mon Aug  4 08:08:27 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 04 Aug 2008 15:08:27 +0100
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <4896F417.2070001@arimaz.com>
References: <4896B43A.9060700@arimaz.com>	<20080804092550.GC32231@doorstop.net.ic.ac.uk>
	<4896F417.2070001@arimaz.com>
Message-ID: <48970D5B.9080503@imperial.ac.uk>

Gabriel Rossetti wrote:
> Phil Mayers wrote:
>> On Mon, Aug 04, 2008 at 09:48:10AM +0200, Gabriel Rossetti wrote:
>>> Hello everyone,
>>>
>>> I have a program using twisted and I'd like it to obtain it's data 
>>> via  the HTTP protocol. The idea is that the clients will connect to a  
>>
>> It's best to ask such questions on the twisted-web list.
>>
> Ok, but I just want to make sure first it's better to use twisted.web 
> rather than implementing my own protocol, since I won't be serving any 
> web pages and to me it seams twisted.web is designed to serve web content.

No. twisted.web is a general HTTP server. You can use it to implement 
XMLRPC, JSON-RPC or various other non-HTML HTTP applications, as well as 
HTML pages.



From d.a.abernathy at gmail.com  Mon Aug  4 09:09:48 2008
From: d.a.abernathy at gmail.com (DJ)
Date: Mon, 4 Aug 2008 10:09:48 -0500
Subject: [Twisted-Python] Re: Error Request did not return a string
Message-ID: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>

Hello All,

For some strange reason I this text is being added to the end of the html
pages rendered by twisted.
Request did not return a string

Request:

<GET /config/deleteSection HTTP/1.1>


Resource:

<configPages.deleteSection instance at 0x00EC4EE0>


Value:

None

I am using the resource.Resource and render. My html is passed has a string
using request.write.
As far has I can tell, there should not be a problem. Does anyone know why
and what I need to do to fix this.

-- 
Dafina A. Abernathy (DJ)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080804/ceeb1dcc/attachment.html>

From gabriel.rossetti at arimaz.com  Mon Aug  4 09:13:31 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 04 Aug 2008 17:13:31 +0200
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <48970D5B.9080503@imperial.ac.uk>
References: <4896B43A.9060700@arimaz.com>	<20080804092550.GC32231@doorstop.net.ic.ac.uk>	<4896F417.2070001@arimaz.com>
	<48970D5B.9080503@imperial.ac.uk>
Message-ID: <48971C9B.7000506@arimaz.com>

Phil Mayers wrote:
> Gabriel Rossetti wrote:
>> Phil Mayers wrote:
>>> On Mon, Aug 04, 2008 at 09:48:10AM +0200, Gabriel Rossetti wrote:
>>>> Hello everyone,
>>>>
>>>> I have a program using twisted and I'd like it to obtain it's data 
>>>> via  the HTTP protocol. The idea is that the clients will connect 
>>>> to a  
>>>
>>> It's best to ask such questions on the twisted-web list.
>>>
>> Ok, but I just want to make sure first it's better to use twisted.web 
>> rather than implementing my own protocol, since I won't be serving 
>> any web pages and to me it seams twisted.web is designed to serve web 
>> content.
>
> No. twisted.web is a general HTTP server. You can use it to implement 
> XMLRPC, JSON-RPC or various other non-HTML HTTP applications, as well 
> as HTML pages.
>
Ok, thank you Phil



From d.a.abernathy at gmail.com  Mon Aug  4 09:23:15 2008
From: d.a.abernathy at gmail.com (DJ)
Date: Mon, 4 Aug 2008 10:23:15 -0500
Subject: [Twisted-Python] Re: Running twisted as an http server
Message-ID: <7dfc47fe0808040823j5345c653o5c51255d7a3b21f2@mail.gmail.com>

Hello All,

I have written a small twisted application that I am trying to access over
http.
I have successfully created a tap file using mktap, but I still cannot
access the
application using http. Does anyone know how this is done ?

-- 
Dafina A. Abernathy (DJ)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080804/6ad332a9/attachment.html>

From maarten at treewalker.org  Mon Aug  4 14:50:24 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Mon, 4 Aug 2008 22:50:24 +0200
Subject: [Twisted-Python] Re: Error Request did not return a string
In-Reply-To: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>
References: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>
Message-ID: <200808042250.31325.maarten@treewalker.org>

On Monday 04 August 2008, DJ wrote:

> For some strange reason I this text is being added to the end of the html
> pages rendered by twisted.
> Request did not return a string
>
> Request:
>
> <GET /config/deleteSection HTTP/1.1>
>
>
> Resource:
>
> <configPages.deleteSection instance at 0x00EC4EE0>
>
>
> Value:
>
> None
>
> I am using the resource.Resource and render. My html is passed has a
> string using request.write.
> As far has I can tell, there should not be a problem. Does anyone know
> why and what I need to do to fix this.

Python functions implicitly return None if there is no return statement.

Twisted.web wants the render method to either return a string, or the 
special object NOT_DONE_YET, which indicates that the reply will be written 
with request.write(). The name was probably chosen for cases where the 
content is written using deferreds, but it should be used even if you call 
request.write() from the render method.

So try putting "return server.NOT_DONE_YET" at the end of your render 
method.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
URL: </pipermail/twisted-python/attachments/20080804/e48a0bb0/attachment.sig>

From glyph at divmod.com  Mon Aug  4 19:51:11 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 05 Aug 2008 01:51:11 -0000
Subject: [Twisted-Python] HTTP interface to a program using twisted
In-Reply-To: <4896F417.2070001@arimaz.com>
References: <4896B43A.9060700@arimaz.com>
	<20080804092550.GC32231@doorstop.net.ic.ac.uk>
	<4896F417.2070001@arimaz.com>
Message-ID: <20080805015111.25821.952097487.divmod.xquotient.13593@joule.divmod.com>

On 4 Aug, 12:20 pm, gabriel.rossetti at arimaz.com wrote:
>Ok, but I just want to make sure first it's better to use twisted.web 
>rather than implementing my own protocol, since I won't be serving any 
>web pages and to me it seams twisted.web is designed to serve web 
>content.

If you do need to do any of your own protocol work, surely it would be 
easier to write a few patches for twisted.web than to do the whole thing 
over again :).



From glyph at divmod.com  Mon Aug  4 19:53:54 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 05 Aug 2008 01:53:54 -0000
Subject: [Twisted-Python] Re: Running twisted as an http server
In-Reply-To: <7dfc47fe0808040823j5345c653o5c51255d7a3b21f2@mail.gmail.com>
References: <7dfc47fe0808040823j5345c653o5c51255d7a3b21f2@mail.gmail.com>
Message-ID: <20080805015354.25821.902523243.divmod.xquotient.13596@joule.divmod.com>

On 4 Aug, 03:23 pm, d.a.abernathy at gmail.com wrote:
>Hello All,
>
>I have written a small twisted application that I am trying to access 
>over
>http.
>I have successfully created a tap file using mktap, but I still cannot
>access the
>application using http. Does anyone know how this is done ?

If you did

    mktap foo bar baz

to make your tap file, instead do

    twistd foo bar baz

to start the server with your desired configuration rather than 
outputting a tap file.

Tap files are not a really good mechanism for dealing with configuration 
and are being slowly phased out in favor of running twistd plugins 
directly.



From squzer at declum.com  Tue Aug  5 05:43:41 2008
From: squzer at declum.com (Squzer Crawler)
Date: Tue, 5 Aug 2008 17:13:41 +0530
Subject: [Twisted-Python] Permanent Object
Message-ID: <7947f7250808050443r7751aa9dh296862ae3a959b5c@mail.gmail.com>

I want to create a server in twisted that has a permanent variable which i
want to use as the number of request requested to the server. When i use
that for Protocol, each time the variable is created newly.

Then i used
*class Echo(Protocol):
    def dataReceived(self, data):

        if "data" not in dir(self.factory):
            self.factory.data = 0
        self.factory.data = self.factory.data + 1

        """As soon as any data is received, write it back."""
        self.transport.write(data + str(self.factory.data))


but i want to remove the code that is:

**        if "data" not in dir(self.factory):
            self.factory.data = 0
        self.factory.data = self.factory.data + 1


How to do that?
*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080805/7439a969/attachment.html>

From exarkun at divmod.com  Tue Aug  5 05:47:46 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 5 Aug 2008 07:47:46 -0400
Subject: [Twisted-Python] Permanent Object
In-Reply-To: <7947f7250808050443r7751aa9dh296862ae3a959b5c@mail.gmail.com>
Message-ID: <20080805114746.29191.620304992.divmod.quotient.10652@ohm>

On Tue, 5 Aug 2008 17:13:41 +0530, Squzer Crawler <squzer at declum.com> wrote:
>I want to create a server in twisted that has a permanent variable which i
>want to use as the number of request requested to the server. When i use
>that for Protocol, each time the variable is created newly.
>
>Then i used
>*class Echo(Protocol):
>    def dataReceived(self, data):
>
>        if "data" not in dir(self.factory):
>            self.factory.data = 0
>        self.factory.data = self.factory.data + 1
>
>        """As soon as any data is received, write it back."""
>        self.transport.write(data + str(self.factory.data))
>
>
>but i want to remove the code that is:
>
>**        if "data" not in dir(self.factory):
>            self.factory.data = 0
>        self.factory.data = self.factory.data + 1
>
>
>How to do that?
>*

Why?  You said it's what you wanted.

Jean-Paul



From terry at jon.es  Tue Aug  5 06:14:53 2008
From: terry at jon.es (Terry Jones)
Date: Tue, 5 Aug 2008 14:14:53 +0200
Subject: [Twisted-Python] Permanent Object
In-Reply-To: Your message at 07:47:46 on Tuesday, 5 August 2008
References: <7947f7250808050443r7751aa9dh296862ae3a959b5c@mail.gmail.com>
	<20080805114746.29191.620304992.divmod.quotient.10652@ohm>
Message-ID: <18584.17469.959750.275930@jon.es>

>>>>> "JP" == Jean-Paul Calderone <exarkun at divmod.com> writes:
JP> On Tue, 5 Aug 2008 17:13:41 +0530, Squzer Crawler <squzer at declum.com> wrote:
>> I want to create a server in twisted that has a permanent variable which i
>> want to use as the number of request requested to the server. When i use
>> that for Protocol, each time the variable is created newly.
>> 
>> Then i used
>> *class Echo(Protocol):
>> def dataReceived(self, data):
>> 
>> if "data" not in dir(self.factory):
>> self.factory.data = 0
>> self.factory.data = self.factory.data + 1
>> 
>> """As soon as any data is received, write it back."""
>> self.transport.write(data + str(self.factory.data))
>> 
>> but i want to remove the code that is:
>> 
>> **        if "data" not in dir(self.factory):
>> self.factory.data = 0
>> self.factory.data = self.factory.data + 1
>> 
>> How to do that?

JP> Why?  You said it's what you wanted.

Hi JP

I think Squzer meant that he'd like to put the initialization code elsewhere.

Squzer, why not do the initialization of self.factory.data when the factory
is created, and then increment the variable each time a connection is made?
Is that what you meant?

Terry



From d.a.abernathy at gmail.com  Tue Aug  5 08:50:51 2008
From: d.a.abernathy at gmail.com (DJ)
Date: Tue, 5 Aug 2008 09:50:51 -0500
Subject: [Twisted-Python] Re: Error Request did not return a string
In-Reply-To: <200808042250.31325.maarten@treewalker.org>
References: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>
	<200808042250.31325.maarten@treewalker.org>
Message-ID: <7dfc47fe0808050750j2c3eaa6am7e3da0e558b3fa11@mail.gmail.com>

Will request.finish have the same effect as return server.NOT_DONE_YET ?
Or do the statements do different things ?


On Mon, Aug 4, 2008 at 3:50 PM, Maarten ter Huurne
<maarten at treewalker.org>wrote:

> On Monday 04 August 2008, DJ wrote:
>
> > For some strange reason I this text is being added to the end of the html
> > pages rendered by twisted.
> > Request did not return a string
> >
> > Request:
> >
> > <GET /config/deleteSection HTTP/1.1>
> >
> >
> > Resource:
> >
> > <configPages.deleteSection instance at 0x00EC4EE0>
> >
> >
> > Value:
> >
> > None
> >
> > I am using the resource.Resource and render. My html is passed has a
> > string using request.write.
> > As far has I can tell, there should not be a problem. Does anyone know
> > why and what I need to do to fix this.
>
> Python functions implicitly return None if there is no return statement.
>
> Twisted.web wants the render method to either return a string, or the
> special object NOT_DONE_YET, which indicates that the reply will be written
> with request.write(). The name was probably chosen for cases where the
> content is written using deferreds, but it should be used even if you call
> request.write() from the render method.
>
> So try putting "return server.NOT_DONE_YET" at the end of your render
> method.
>
> Bye,
>                 Maarten
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


-- 
Dafina A. Abernathy (DJ)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080805/88f84b4b/attachment.html>

From maarten at treewalker.org  Wed Aug  6 00:27:42 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Wed, 6 Aug 2008 08:27:42 +0200
Subject: [Twisted-Python] Re: Error Request did not return a string
In-Reply-To: <7dfc47fe0808050750j2c3eaa6am7e3da0e558b3fa11@mail.gmail.com>
References: <7dfc47fe0808040809qd29ac88s74af3c0a2b01b27c@mail.gmail.com>
	<200808042250.31325.maarten@treewalker.org>
	<7dfc47fe0808050750j2c3eaa6am7e3da0e558b3fa11@mail.gmail.com>
Message-ID: <200808060827.49606.maarten@treewalker.org>

On Tuesday 05 August 2008, DJ wrote:

> Will request.finish have the same effect as return server.NOT_DONE_YET ?
> Or do the statements do different things ?

You have to use both: call request.finish() when you are done writing and 
return NOT_DONE_YET from the render method.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
URL: </pipermail/twisted-python/attachments/20080806/671d37e8/attachment.sig>

From nadav at MIT.EDU  Wed Aug  6 13:53:33 2008
From: nadav at MIT.EDU (Nadav Aharony)
Date: Wed, 06 Aug 2008 15:53:33 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
Message-ID: <489A013D.4000807@mit.edu>

(forwarding for Daniel who had some list posting trouble)

Hi all-
I'd like to use Twisted to manage bluetooth communication. I haven't
found any existing method for doing this, so I'd like to write and
implement a new reactor interface (on par with TCP/UDP) that wraps the
lightblue library. What's the right way to go about extending Twisted in
this way?
Thanks,
Daniel




From exarkun at divmod.com  Wed Aug  6 14:04:49 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 6 Aug 2008 16:04:49 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <489A013D.4000807@mit.edu>
Message-ID: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>

On Wed, 06 Aug 2008 15:53:33 -0400, Nadav Aharony <nadav at mit.edu> wrote:
>(forwarding for Daniel who had some list posting trouble)
>
>Hi all-
>I'd like to use Twisted to manage bluetooth communication. I haven't
>found any existing method for doing this, so I'd like to write and
>implement a new reactor interface (on par with TCP/UDP) that wraps the
>lightblue library. What's the right way to go about extending Twisted in
>this way?

A lot of reactors implement `IReactorFDSet:

  http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorFDSet.html

If you don't mind that some reactors don't implement this, you can
use it to implement bluetooth support.

Jean-Paul



From nadav at MIT.EDU  Thu Aug  7 20:01:41 2008
From: nadav at MIT.EDU (Nadav Aharony)
Date: Thu, 07 Aug 2008 22:01:41 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
Message-ID: <489BA905.8070901@mit.edu>

Jean-Paul Calderone wrote:
> On Wed, 06 Aug 2008 15:53:33 -0400, Nadav Aharony <nadav at mit.edu> wrote:
>> (forwarding for Daniel who had some list posting trouble)
>>
>> Hi all-
>> I'd like to use Twisted to manage bluetooth communication. I haven't
>> found any existing method for doing this, so I'd like to write and
>> implement a new reactor interface (on par with TCP/UDP) that wraps the
>> lightblue library. What's the right way to go about extending Twisted in
>> this way?
>
> A lot of reactors implement `IReactorFDSet:
>
>  http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorFDSet.html 
>
>
> If you don't mind that some reactors don't implement this, you can
> use it to implement bluetooth support.
>
> Jean-Paul
>
> _________
Thanks! Will look into it (hopefully will be able to understand how to 
use it on our own)





From itamar at itamarst.org  Thu Aug  7 20:59:32 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 08 Aug 2008 02:59:32 +0000
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <489BA905.8070901@mit.edu>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
	<489BA905.8070901@mit.edu>
Message-ID: <1218164372.5308.110.camel@localhost.localdomain>

On Thu, 2008-08-07 at 22:01 -0400, Nadav Aharony wrote:

> Thanks! Will look into it (hopefully will be able to understand how to 
> use it on our own)

If you get stuck, and list doesn't help, show up to next Twisted sprint
and maybe one of us can help.




From glyph at divmod.com  Thu Aug  7 21:53:16 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Fri, 08 Aug 2008 03:53:16 -0000
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <1218164372.5308.110.camel@localhost.localdomain>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
	<489BA905.8070901@mit.edu>
	<1218164372.5308.110.camel@localhost.localdomain>
Message-ID: <20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>

On 02:59 am, itamar at itamarst.org wrote:
>On Thu, 2008-08-07 at 22:01 -0400, Nadav Aharony wrote:
>>Thanks! Will look into it (hopefully will be able to understand how to
>>use it on our own)
>
>If you get stuck, and list doesn't help, show up to next Twisted sprint
>and maybe one of us can help.

Oh yeah!  Twisted sprints!  When is the next one of those, anyway?



From nadav at MIT.EDU  Thu Aug  7 23:40:56 2008
From: nadav at MIT.EDU (Nadav Aharony)
Date: Fri, 08 Aug 2008 01:40:56 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>	<489BA905.8070901@mit.edu>	<1218164372.5308.110.camel@localhost.localdomain>
	<20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>
Message-ID: <489BDC68.1090803@mit.edu>

glyph at divmod.com wrote:
> On 02:59 am, itamar at itamarst.org wrote:
>> On Thu, 2008-08-07 at 22:01 -0400, Nadav Aharony wrote:
>>> Thanks! Will look into it (hopefully will be able to understand how to
>>> use it on our own)
>>
>> If you get stuck, and list doesn't help, show up to next Twisted sprint
>> and maybe one of us can help.
>
> Oh yeah!  Twisted sprints!  When is the next one of those, anyway?
>
Was just about to ask. If it works out I'll happily show up and get 
myself a little Twisted.




From alan.franzoni.xyz at gmail.com  Fri Aug  8 04:05:27 2008
From: alan.franzoni.xyz at gmail.com (Alan Franzoni)
Date: Fri, 8 Aug 2008 12:05:27 +0200
Subject: [Twisted-Python] Jython reactor - a proposal
Message-ID: <1qwea36yndtit.ci6snfvp7paz.dlg@40tude.net>

Hello everybody,
I recently took a look at the current Jython status, and it seems to me
that the latest alpha provides a good compatibility towards the standard
CPython. 

I'd really like running jython+twisted, so when I realized there was no
reactor available for such platform I took some time to analyze the issue:

- An old-and-incomplete java reactor existed in Twisted 1.3 which used
java.io.
- java.nio would be a better choice to implement such a reactor since java
1.4
- a wrapper around java.nio called EIO existed (
http://java.twistedmatrix.com/eio/ ) but there seems no way to take a peek
at it since there's no file that can be accessed beyond its home page
(every single link is broken :-( )
- a kind of async networking library called Apache Mina is avaiable for
java, and it makes use of java.nio
- other java-reactor pattern implementations are available around (e.g.
assorted on sourceforge ).

So, it seems java.nio is the right way to go and there's quite a lot of
code around to look at. Since I'd like to code a java reactory, I've got
some questions:
- any other clue? Is there anything else I should look at before starting
my code?
- is there any way I could be given commit access to a private branch on
twisted svn repository? i could set up a repo elsewhere, but this would
make synchronization and merging a bit more painful and slow.
- is there any other similar project ongoing by anyone else?

Thanks!

-- 
Alan Franzoni <alan.franzoni.xyz at gmail.com>
-
Remove .xyz from my email in order to contact me.
-
GPG Key Fingerprint:
5C77 9DC3 BD5B 3A28 E7BC 921A 0255 42AA FE06 8F3E




From peter at sabaini.at  Fri Aug  8 08:22:02 2008
From: peter at sabaini.at (Peter Sabaini)
Date: Fri, 8 Aug 2008 16:22:02 +0200
Subject: [Twisted-Python] Interest in TIPC support?
Message-ID: <200808081622.08381.peter@sabaini.at>

Hi list,

I'm currently in the process of hacking together TIPC[1] support for Twisted. 
I've got reliable datagram support in a "works for me" state now.

Is anyone interested to see this in Twisted? Thought I'd rather ask here 
before opening a ticket etc. 

peter.


[1] http://tipc.sourceforge.net/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: </pipermail/twisted-python/attachments/20080808/5f193765/attachment.sig>

From alan.franzoni.xyz at gmail.com  Sat Aug  9 02:49:13 2008
From: alan.franzoni.xyz at gmail.com (Alan Franzoni)
Date: Sat, 9 Aug 2008 10:49:13 +0200
Subject: [Twisted-Python] Re: Jython reactor - a proposal
References: <1qwea36yndtit.ci6snfvp7paz.dlg@40tude.net>
Message-ID: <jrglic6zoxp6.t1wlzz49mzat.dlg@40tude.net>

Alan Franzoni was kind enough to say:

[cut]

I just discovered jython provides the select module as well (I wouldn't
ever think of that), I'm performing some tests with that before going on
with a brand-new reactor.

-- 
Alan Franzoni <alan.franzoni.xyz at gmail.com>
-
Remove .xyz from my email in order to contact me.
-
GPG Key Fingerprint:
5C77 9DC3 BD5B 3A28 E7BC 921A 0255 42AA FE06 8F3E




From marco.giusti at gmail.com  Sat Aug  9 03:02:17 2008
From: marco.giusti at gmail.com (Marco Giusti)
Date: Sat, 9 Aug 2008 11:02:17 +0200
Subject: [Twisted-Python] foolscap copyable and constraint
Message-ID: <20080809090217.GA8379@lemurdoc>

ciao! i'm playing a bit with foolscap and i try to use RemoteInterface
to describe my constraint but i cannot understand how to use it with
pass-by-copy. this is a small example:


    from foolscap import RemoteInterface, registerCopier, \
            registerRemoteCopyFactory

    class Label:
        def __init__(self, text):
            self.text = text


    def copyLabel(label):
        return ('_Label', {'text': label.text})

    registerCopier(Label, copyLabel)

    def makeLabel(state):
        label = Label(state['text'])
        return label

    registerRemoteCopyFactory('_Label', makeLabel)


    class RITest(RemoteInterface):
        def getLabel():
            return Label


but what i get is:
foolscap.tokens.UnknownSchemaType: can't make constraint from
'__main__.Label' (<type 'classobj'>)

which is the correct way to define a constraint for a third party-class?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20080809/2f9591a5/attachment.sig>

From exarkun at twistedmatrix.com  Sat Aug  9 22:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 10 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1218341109.11.1385115348@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080810/77448303/attachment.html>

From Andy at NewWorldElectric.com  Sun Aug 10 17:25:34 2008
From: Andy at NewWorldElectric.com (Andy Fundinger)
Date: Sun, 10 Aug 2008 19:25:34 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <489BDC68.1090803@mit.edu>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
	<489BA905.8070901@mit.edu>
	<1218164372.5308.110.camel@localhost.localdomain>
	<20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>
	<489BDC68.1090803@mit.edu>
Message-ID: <37d49ed40808101625k77bd2a9am121801aa74702212@mail.gmail.com>

Are there ever East Coast sprints, I'd like to make one, but I'm in New
York.

On Fri, Aug 8, 2008 at 1:40 AM, Nadav Aharony <nadav at mit.edu> wrote:

> glyph at divmod.com wrote:
>
>> On 02:59 am, itamar at itamarst.org wrote:
>>
>>> On Thu, 2008-08-07 at 22:01 -0400, Nadav Aharony wrote:
>>>
>>>> Thanks! Will look into it (hopefully will be able to understand how to
>>>> use it on our own)
>>>>
>>>
>>> If you get stuck, and list doesn't help, show up to next Twisted sprint
>>> and maybe one of us can help.
>>>
>>
>> Oh yeah!  Twisted sprints!  When is the next one of those, anyway?
>>
>>  Was just about to ask. If it works out I'll happily show up and get
> myself a little Twisted.
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Blog: http://channel3b.wordpress.com
Second Life Name: Ciemaar Flintoff

What would you do if they outlawed hypothetical questions?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080810/007f9e60/attachment.html>

From radix at twistedmatrix.com  Sun Aug 10 17:37:22 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 10 Aug 2008 19:37:22 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <37d49ed40808101625k77bd2a9am121801aa74702212@mail.gmail.com>
References: <20080806200449.29191.1563520430.divmod.quotient.11307@ohm>
	<489BA905.8070901@mit.edu>
	<1218164372.5308.110.camel@localhost.localdomain>
	<20080808035316.25821.341707486.divmod.xquotient.14137@joule.divmod.com>
	<489BDC68.1090803@mit.edu>
	<37d49ed40808101625k77bd2a9am121801aa74702212@mail.gmail.com>
Message-ID: <60ed19d40808101637s704617f0wfce28a44609fc6cc@mail.gmail.com>

On Sun, Aug 10, 2008 at 7:25 PM, Andy Fundinger
<Andy at newworldelectric.com> wrote:
> Are there ever East Coast sprints, I'd like to make one, but I'm in New
> York.

Yes, the regular Twisted sprints are held in Cambridge, MA.

Shall we have another one soon? I'm available outside of September 6-20.

-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/



From exarkun at divmod.com  Sun Aug 10 18:03:29 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 10 Aug 2008 20:03:29 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <60ed19d40808101637s704617f0wfce28a44609fc6cc@mail.gmail.com>
Message-ID: <20080811000329.29191.744234800.divmod.quotient.13057@ohm>

On Sun, 10 Aug 2008 19:37:22 -0400, Christopher Armstrong <radix at twistedmatrix.com> wrote:
>On Sun, Aug 10, 2008 at 7:25 PM, Andy Fundinger
><Andy at newworldelectric.com> wrote:
>> Are there ever East Coast sprints, I'd like to make one, but I'm in New
>> York.
>
>Yes, the regular Twisted sprints are held in Cambridge, MA.
>
>Shall we have another one soon? I'm available outside of September 6-20.
>

Yes, let's.  Does August 30th or August 31st work for anyone?  

Jean-Paul



From itamar at itamarst.org  Sun Aug 10 19:29:00 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 10 Aug 2008 21:29:00 -0400
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <20080811000329.29191.744234800.divmod.quotient.13057@ohm>
References: <20080811000329.29191.744234800.divmod.quotient.13057@ohm>
Message-ID: <1218418140.5308.140.camel@localhost.localdomain>

On Sun, 2008-08-10 at 20:03 -0400, Jean-Paul Calderone wrote:

> >Shall we have another one soon? I'm available outside of September 6-20.
> >
> 
> Yes, let's.  Does August 30th or August 31st work for anyone?  

Not me, I'm camping on the Cape that weekend (not that I'm much
practical help at sprints :/). How about 16-17 or 23-24?




From exarkun at divmod.com  Sun Aug 10 20:37:38 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 10 Aug 2008 22:37:38 -0400
Subject: Cambridge Twisted Spring (was Re: [Twisted-Python] Bluetooth
	reactor interface)
In-Reply-To: <1218418140.5308.140.camel@localhost.localdomain>
Message-ID: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>

On Sun, 10 Aug 2008 21:29:00 -0400, Itamar Shtull-Trauring <itamar at itamarst.org> wrote:
>On Sun, 2008-08-10 at 20:03 -0400, Jean-Paul Calderone wrote:
>
>> >Shall we have another one soon? I'm available outside of September 6-20.
>> >
>>
>> Yes, let's.  Does August 30th or August 31st work for anyone?
>
>Not me, I'm camping on the Cape that weekend (not that I'm much
>practical help at sprints :/). How about 16-17 or 23-24?
>

I'll be out of town the 16th and 17th; 23rd or 24th works for me.

Jean-Paul



From nadav at MIT.EDU  Sun Aug 10 22:48:02 2008
From: nadav at MIT.EDU (Nadav Aharony)
Date: Mon, 11 Aug 2008 00:48:02 -0400
Subject: Cambridge Twisted Spring (was Re: [Twisted-Python] Bluetooth
	reactor interface)
In-Reply-To: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
References: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
Message-ID: <489FC482.8020808@mit.edu>

Well my schedule should definitely not carry much weight since I am 
totally new to this, bet here goes:
Not available - From now till Sept 2nd, and weekend of Sept 13th. 
Otherwise - will do my best to make it and drag one or two others with me.
(Oh, and I AM located in Cambridge, MA)

-Nadav



but I am located in Cambridge MA
Jean-Paul Calderone wrote:
> On Sun, 10 Aug 2008 21:29:00 -0400, Itamar Shtull-Trauring 
> <itamar at itamarst.org> wrote:
>> On Sun, 2008-08-10 at 20:03 -0400, Jean-Paul Calderone wrote:
>>
>>> >Shall we have another one soon? I'm available outside of September 
>>> 6-20.
>>> >
>>>
>>> Yes, let's.  Does August 30th or August 31st work for anyone?
>>
>> Not me, I'm camping on the Cape that weekend (not that I'm much
>> practical help at sprints :/). How about 16-17 or 23-24?
>>
>
> I'll be out of town the 16th and 17th; 23rd or 24th works for me.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From stephan.jaeger at ewetel.de  Mon Aug 11 08:19:54 2008
From: stephan.jaeger at ewetel.de (Stephan Jaeger)
Date: Mon, 11 Aug 2008 16:19:54 +0200
Subject: [Twisted-Python] AsynQueue: return deferred from queued method
Message-ID: <1218464394.7686.19.camel@localhost>

Hello List,

I'm trying to use AsynQueue for queuing requests for a synchronous
protocol (emi/ucp). Is it possible to return a deferred from the queued
method so the next method in the queue is only called after the deferred
from the first was fired? Or is there a better way to handle synchronous
protocols where i have to wait for an answer of a message sent over the
wire before i can send another one?

Thanks,

Stephan




From general at eepatents.com  Mon Aug 11 09:52:19 2008
From: general at eepatents.com (Ed Suominen)
Date: Mon, 11 Aug 2008 08:52:19 -0700
Subject: [Twisted-Python] AsynQueue: return deferred from queued method
In-Reply-To: <1218464394.7686.19.camel@localhost>
References: <1218464394.7686.19.camel@localhost>
Message-ID: <48A06033.4010107@eepatents.com>

Stephan Jaeger wrote:
> I'm trying to use AsynQueue for queuing requests for a synchronous
> protocol (emi/ucp). Is it possible to return a deferred from the queued
> method so the next method in the queue is only called after the deferred
> from the first was fired? Or is there a better way to handle synchronous
> protocols where i have to wait for an answer of a message sent over the
> wire before i can send another one?

Just use a single implementer of IWorker that only accepts one 
assignment at a time. The queue will not feed it its next task until the 
deferred from its previous one has fired.

What you're trying to do is exactly what AsynQueue is for. For example, 
my sAsync package uses AsynQueue to feed database queries to the SQLite 
database engine one at a time in a single thread.

If you have multiple connections that each can handle successive 
requests successively, but independently the other connection, you can 
simply use an IWorker implementer for each one. (I don't know that 
emi/ucp has any way of doing this.) Then the queue will feed requests to 
whoever is ready, one at a time.

I use this for running jobs asynchronously over a cluster of CPU nodes. 
The queue gets fed thousands of tasks nearly at once, and parcels them 
out one at a time to each node. Some CPU nodes run faster than others, 
and the queueing makes that all work out fine.

Please note that there is also a very simple and elegant queue object in 
twisted.internet.defer that might meet your needs without the complexity 
(and capability) of AsynQueue.

Feel free to contact me offline if you have additional questions on this.

Best regards,
Ed Suominen



From gabriel.rossetti at arimaz.com  Mon Aug 11 10:17:53 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 11 Aug 2008 18:17:53 +0200
Subject: [Twisted-Python] does setTcpNoDelay() not work?
Message-ID: <48A06631.6040107@arimaz.com>

Hello,

I'm needing to send small packets to update a progress bar. My update 
msgs were all being sent in big packets, so I tried setting 
setTcpNoDelay() in connectionMade() but it doesn't change anything, is 
it broken?

Thank you,
Gabriel



From gabriel.rossetti at arimaz.com  Mon Aug 11 11:13:56 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 11 Aug 2008 19:13:56 +0200
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <48A06631.6040107@arimaz.com>
References: <48A06631.6040107@arimaz.com>
Message-ID: <48A07354.3050108@arimaz.com>

Gabriel Rossetti wrote:
> Hello,
>
> I'm needing to send small packets to update a progress bar. My update 
> msgs were all being sent in big packets, so I tried setting 
> setTcpNoDelay() in connectionMade() but it doesn't change anything, is 
> it broken?
>
> Thank you,
> Gabriel
>
I an using code that I wrote using threads.deferToThread(), I wondered 
if it was blocking the reactor maybe, so I tried just using a plain 
deferToThread() call. Here's the code (without all the protocol stuff, 
it's executed when data come in.

    def loop(self):
        import time
        m = utils.createMessage("toto", "hello")
        while(True):
            print "Sending %s" % m.toXml()
            self.sendMessage(m)
            print "Sent!"
            time.sleep(2)


threads.deferToThread(self.loop)

the TCP no delay option is turned on like I said before, the weird thing 
is that I have the same thing, all my msgs get sent in big blocks. 
Either the TCP no delay doesn't work, or the reactor is getting tied up. 
I don' t get it since I'm running the blocking code in a thread, the 
reactor should have nothing to do.

Thank you,
Gabriel

P.S.
I know that I'm not returning a deferred, I am in my real code though, 
but this is just "debug" code.



From exarkun at divmod.com  Mon Aug 11 11:30:04 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 11 Aug 2008 13:30:04 -0400
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <48A07354.3050108@arimaz.com>
Message-ID: <20080811173004.29191.220123618.divmod.quotient.13333@ohm>

On Mon, 11 Aug 2008 19:13:56 +0200, Gabriel Rossetti <gabriel.rossetti at arimaz.com> wrote:
>Gabriel Rossetti wrote:
>>Hello,
>>
>>I'm needing to send small packets to update a progress bar. My update msgs 
>>were all being sent in big packets, so I tried setting setTcpNoDelay() in 
>>connectionMade() but it doesn't change anything, is it broken?
>>
>>Thank you,
>>Gabriel
>I an using code that I wrote using threads.deferToThread(), I wondered if it 
>was blocking the reactor maybe, so I tried just using a plain 
>deferToThread() call. Here's the code (without all the protocol stuff, it's 
>executed when data come in.
>
>    def loop(self):
>        import time
>        m = utils.createMessage("toto", "hello")
>        while(True):
>            print "Sending %s" % m.toXml()
>            self.sendMessage(m)
>            print "Sent!"
>            time.sleep(2)
>
>
>threads.deferToThread(self.loop)
>
>the TCP no delay option is turned on like I said before, the weird thing is 
>that I have the same thing, all my msgs get sent in big blocks. Either the 
>TCP no delay doesn't work, or the reactor is getting tied up. I don' t get 
>it since I'm running the blocking code in a thread, the reactor should have 
>nothing to do.
>

Since you didn't include the definition of `sendMessage, it's hard to say
what's really going on here.  However, my guess is that you're calling the
transport.write method in a non-reactor thread, which is not allowed.

If this isn't the case, including a full, minimal example in your next
message would be a good idea. :)

Jean-Paul



From glyph at divmod.com  Mon Aug 11 11:35:21 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Mon, 11 Aug 2008 17:35:21 -0000
Subject: Cambridge Twisted Spring (was Re: [Twisted-Python] Bluetooth
	reactor interface)
In-Reply-To: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
References: <1218418140.5308.140.camel@localhost.localdomain>
	<20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
Message-ID: <20080811173521.25821.1551077115.divmod.xquotient.14151@joule.divmod.com>

On 02:37 am, exarkun at divmod.com wrote:
>I'll be out of town the 16th and 17th; 23rd or 24th works for me.

I'll be busy the 24th.  Shall we say the 23rd?



From glyph at divmod.com  Mon Aug 11 11:38:34 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Mon, 11 Aug 2008 17:38:34 -0000
Subject: Cambridge Twisted Spring (was Re: [Twisted-Python] Bluetooth
	reactor interface)
In-Reply-To: <489FC482.8020808@mit.edu>
References: <20080811023738.29191.2143661857.divmod.quotient.13106@ohm>
	<489FC482.8020808@mit.edu>
Message-ID: <20080811173834.25821.2125603796.divmod.xquotient.14153@joule.divmod.com>

On 04:48 am, nadav at mit.edu wrote:
>Well my schedule should definitely not carry much weight since I am 
>totally new to this, bet here goes:
>Not available - From now till Sept 2nd, and weekend of Sept 13th. 
>Otherwise - will do my best to make it and drag one or two others with 
>me.
>(Oh, and I AM located in Cambridge, MA)

Sounds like you'll be missing the August one (pretty much by definition) 
but hopefully we'll see you in September!



From gabriel.rossetti at arimaz.com  Mon Aug 11 12:18:43 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 11 Aug 2008 20:18:43 +0200
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <20080811173004.29191.220123618.divmod.quotient.13333@ohm>
References: <20080811173004.29191.220123618.divmod.quotient.13333@ohm>
Message-ID: <48A08283.2000200@arimaz.com>

Jean-Paul Calderone wrote:
> On Mon, 11 Aug 2008 19:13:56 +0200, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com> wrote:
>> Gabriel Rossetti wrote:
>>> Hello,
>>>
>>> I'm needing to send small packets to update a progress bar. My 
>>> update msgs were all being sent in big packets, so I tried setting 
>>> setTcpNoDelay() in connectionMade() but it doesn't change anything, 
>>> is it broken?
>>>
>>> Thank you,
>>> Gabriel
>> I an using code that I wrote using threads.deferToThread(), I 
>> wondered if it was blocking the reactor maybe, so I tried just using 
>> a plain deferToThread() call. Here's the code (without all the 
>> protocol stuff, it's executed when data come in.
>>
>>    def loop(self):
>>        import time
>>        m = utils.createMessage("toto", "hello")
>>        while(True):
>>            print "Sending %s" % m.toXml()
>>            self.sendMessage(m)
>>            print "Sent!"
>>            time.sleep(2)
>>
>>
>> threads.deferToThread(self.loop)
>>
>> the TCP no delay option is turned on like I said before, the weird 
>> thing is that I have the same thing, all my msgs get sent in big 
>> blocks. Either the TCP no delay doesn't work, or the reactor is 
>> getting tied up. I don' t get it since I'm running the blocking code 
>> in a thread, the reactor should have nothing to do.
>>
>
> Since you didn't include the definition of `sendMessage, it's hard to 
> say
> what's really going on here.  However, my guess is that you're calling 
> the
> transport.write method in a non-reactor thread, which is not allowed.
>
> If this isn't the case, including a full, minimal example in your next
> message would be a good idea. :)
>
> Jean-Paul
>
>
Yes, self.sendMessage() calls transport.write. So there's no way of 
sending msgs from a non-reactor thread, even if it has a reference to 
the protocol?

Gabriel



From exarkun at divmod.com  Mon Aug 11 12:22:31 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 11 Aug 2008 14:22:31 -0400
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <48A08283.2000200@arimaz.com>
Message-ID: <20080811182231.29191.697604575.divmod.quotient.13337@ohm>

On Mon, 11 Aug 2008 20:18:43 +0200, Gabriel Rossetti <gabriel.rossetti at arimaz.com> wrote:
>Jean-Paul Calderone wrote:
>>On Mon, 11 Aug 2008 19:13:56 +0200, Gabriel Rossetti 
>><gabriel.rossetti at arimaz.com> wrote:
>>>Gabriel Rossetti wrote:
>>>>Hello,
>>>>
>>>>I'm needing to send small packets to update a progress bar. My update 
>>>>msgs were all being sent in big packets, so I tried setting 
>>>>setTcpNoDelay() in connectionMade() but it doesn't change anything, is it 
>>>>broken?
>>>>
>>>>Thank you,
>>>>Gabriel
>>>I an using code that I wrote using threads.deferToThread(), I wondered if 
>>>it was blocking the reactor maybe, so I tried just using a plain 
>>>deferToThread() call. Here's the code (without all the protocol stuff, 
>>>it's executed when data come in.
>>>
>>>    def loop(self):
>>>        import time
>>>        m = utils.createMessage("toto", "hello")
>>>        while(True):
>>>            print "Sending %s" % m.toXml()
>>>            self.sendMessage(m)
>>>            print "Sent!"
>>>            time.sleep(2)
>>>
>>>
>>>threads.deferToThread(self.loop)
>>>
>>>the TCP no delay option is turned on like I said before, the weird thing 
>>>is that I have the same thing, all my msgs get sent in big blocks. Either 
>>>the TCP no delay doesn't work, or the reactor is getting tied up. I don' t 
>>>get it since I'm running the blocking code in a thread, the reactor should 
>>>have nothing to do.
>>
>>Since you didn't include the definition of `sendMessage, it's hard to say
>>what's really going on here.  However, my guess is that you're calling the
>>transport.write method in a non-reactor thread, which is not allowed.
>>
>>If this isn't the case, including a full, minimal example in your next
>>message would be a good idea. :)
>>
>>Jean-Paul
>Yes, self.sendMessage() calls transport.write. So there's no way of sending 
>msgs from a non-reactor thread, even if it has a reference to the protocol?
>

There is a way.  The way is to use reactor.callFromThread to schedule a
function to be called in the reactor thread.

eg, reactor.callFromThread(self.sendMessage)

Jean-Paul



From radix at twistedmatrix.com  Mon Aug 11 12:31:03 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 11 Aug 2008 14:31:03 -0400
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <48A08283.2000200@arimaz.com>
References: <20080811173004.29191.220123618.divmod.quotient.13333@ohm>
	<48A08283.2000200@arimaz.com>
Message-ID: <60ed19d40808111131k50ffdd0v61edae6d272e97d5@mail.gmail.com>

On Mon, Aug 11, 2008 at 2:18 PM, Gabriel Rossetti
<gabriel.rossetti at arimaz.com> wrote:
> Jean-Paul Calderone wrote:
>>
>> Since you didn't include the definition of `sendMessage, it's hard to say
>> what's really going on here.  However, my guess is that you're calling the
>> transport.write method in a non-reactor thread, which is not allowed.
>>
>> If this isn't the case, including a full, minimal example in your next
>> message would be a good idea. :)
>>
>> Jean-Paul
>>
>>
> Yes, self.sendMessage() calls transport.write. So there's no way of sending
> msgs from a non-reactor thread, even if it has a reference to the protocol?

use reactor.callFromThread, which takes as an argument a function to
call in the reactor thread. That function can use Twisted APIs like
transport.write. Most Twisted APIs are not thread-safe, and cannot be
called from a non-reactor thread.


-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/

From warner at lothar.com  Mon Aug 11 17:52:11 2008
From: warner at lothar.com (Brian Warner)
Date: Mon, 11 Aug 2008 16:52:11 -0700
Subject: [Twisted-Python] foolscap copyable and constraint
In-Reply-To: <20080809090217.GA8379@lemurdoc>
References: <20080809090217.GA8379@lemurdoc>
Message-ID: <20080811165211.112bf0b5@fluxx.allmydata.com>

> ciao! i'm playing a bit with foolscap and i try to use RemoteInterface
> to describe my constraint but i cannot understand how to use it with
> pass-by-copy. this is a small example:

My memory is a bit fuzzy, but I think Copyables aren't as mature as they
ought to be, and we don't yet have a way to express a constraint that allows
a Copyable as an argument. When I hit a need for this in Tahoe, I punted and
used an Any() (which just allows anything through).

There's a foolscap.copyable.AttributeDictConstraint, which can be used to
control what gets to go into the Copyable (store an instance of it in the
.stateSchema attribute of your RemoteCopy class, or provide it as the
stateSchema= argument to registerRemoteCopyFactory.. see
foolscap/test/test_copyable.py MyRemoteCopy4 for an example). It might be
used something like this (untested):

 label_constraint = copyable.AttributeDictConstraint( ("text", str) )
 registerRemoteCopyFactory("_Label", makeLabel, label_constraint)

But that doesn't get you the next-higher-level part.

>     class RITest(RemoteInterface):
>         def getLabel():
>             return Label

That's the desired syntax for this sort of constraint, but it doesn't work
yet. We could fix that.. the approach would be:

 1: create a CopyableConstraint class, inheriting from constraint.Constraint,
    and created with a Copyable subclass (or maybe a RemoteCopy subclass)
    1a: implement CopyableConstraint.checkObject(), somehow. If inbound=False
        then it should probably assert an isinstance(obj, myCopyableClass).
        If inbound=True, it should probably check against myRemoteCopyClass
        instead. checkObject() is used outbound before serialization, and
        inbound post-deserialization; i.e. it examines fully-formed objects
        rather than individual tokens.
 2: add code to schema.adapt_obj_to_iconstraint() (or register an adapter)
    that knows how to create a CopyableConstraint from a Copyable or
    RemoteCopy class.

There is a small design issue.. should the constraint reference the Copyable,
or the RemoteCopy? I.e. should your getLabel() interface method say "return
Label" or "return RemoteLabel"? It depends upon how you want to read the
RemoteInterface.. from the point of view of the sender, or that of the
receiver. My casual thought is to use the Copyable.

This makes more difference in constraints that specify pass-by-proxy objects:

 class RIRow(RemoteInterface):
   def get_value(): return int

 class RIDatabase(RemoteInterface)
   def get_row(rownum=int): return RIRow

where the question is: does the get_row() method return a Referenceable
(which gets turned into a RemoteReference by the time it gets to the remote
caller), or are we saying that it has to return a RemoteReference that is
hosted on the caller's side (such that it gets turned back into a local
Referenceable byt the time it gets to that caller). The former is a lot more
useful, but there might be situations where you want to express the latter,
so it would be nice if there were a syntax for it.

I don't remember if there is such a syntax right now, but my point is that
this sort of distinction doesn't show up with pass-by-copy objects like
Copyable. The caller always receives a RemoteCopy of some sort.


hope that helps,
 -Brian



From gabriel.rossetti at arimaz.com  Tue Aug 12 02:34:41 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 12 Aug 2008 10:34:41 +0200
Subject: [Twisted-Python] does setTcpNoDelay() not work?
In-Reply-To: <20080811182231.29191.697604575.divmod.quotient.13337@ohm>
References: <20080811182231.29191.697604575.divmod.quotient.13337@ohm>
Message-ID: <48A14B21.5070201@arimaz.com>

Jean-Paul Calderone wrote:
> On Mon, 11 Aug 2008 20:18:43 +0200, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com> wrote:
>> Jean-Paul Calderone wrote:
>>> On Mon, 11 Aug 2008 19:13:56 +0200, Gabriel Rossetti 
>>> <gabriel.rossetti at arimaz.com> wrote:
>>>> Gabriel Rossetti wrote:
>>>>> Hello,
>>>>>
>>>>> I'm needing to send small packets to update a progress bar. My 
>>>>> update msgs were all being sent in big packets, so I tried setting 
>>>>> setTcpNoDelay() in connectionMade() but it doesn't change 
>>>>> anything, is it broken?
>>>>>
>>>>> Thank you,
>>>>> Gabriel
>>>> I an using code that I wrote using threads.deferToThread(), I 
>>>> wondered if it was blocking the reactor maybe, so I tried just 
>>>> using a plain deferToThread() call. Here's the code (without all 
>>>> the protocol stuff, it's executed when data come in.
>>>>
>>>>    def loop(self):
>>>>        import time
>>>>        m = utils.createMessage("toto", "hello")
>>>>        while(True):
>>>>            print "Sending %s" % m.toXml()
>>>>            self.sendMessage(m)
>>>>            print "Sent!"
>>>>            time.sleep(2)
>>>>
>>>>
>>>> threads.deferToThread(self.loop)
>>>>
>>>> the TCP no delay option is turned on like I said before, the weird 
>>>> thing is that I have the same thing, all my msgs get sent in big 
>>>> blocks. Either the TCP no delay doesn't work, or the reactor is 
>>>> getting tied up. I don' t get it since I'm running the blocking 
>>>> code in a thread, the reactor should have nothing to do.
>>>
>>> Since you didn't include the definition of `sendMessage, it's hard 
>>> to say
>>> what's really going on here.  However, my guess is that you're 
>>> calling the
>>> transport.write method in a non-reactor thread, which is not allowed.
>>>
>>> If this isn't the case, including a full, minimal example in your next
>>> message would be a good idea. :)
>>>
>>> Jean-Paul
>> Yes, self.sendMessage() calls transport.write. So there's no way of 
>> sending msgs from a non-reactor thread, even if it has a reference to 
>> the protocol?
>>
>
> There is a way.  The way is to use reactor.callFromThread to schedule a
> function to be called in the reactor thread.
>
> eg, reactor.callFromThread(self.sendMessage)
>
> Jean-Paul
>
>
Thank you Jean-Paul & Christopher, I hadn't realized that. Now I 
understand better why in deferToThread() you use 
reactor.callFromThread() to add callbacks/errbacks. So if I understand, 
anything that uses twisted, that I'd need to call from a thread, needs 
to be called with reactor.callFromThread().

Gabriel



From stephan.jaeger at ewetel.de  Tue Aug 12 05:01:22 2008
From: stephan.jaeger at ewetel.de (Stephan Jaeger)
Date: Tue, 12 Aug 2008 13:01:22 +0200
Subject: [Twisted-Python] AsynQueue: return deferred from queued method
In-Reply-To: <48A06033.4010107@eepatents.com>
References: <1218464394.7686.19.camel@localhost>
	<48A06033.4010107@eepatents.com>
Message-ID: <1218538882.7686.29.camel@localhost>

Thanks for your answer Ed,

Am Montag, den 11.08.2008, 08:52 -0700 schrieb Ed Suominen:

> Just use a single implementer of IWorker that only accepts one 
> assignment at a time. The queue will not feed it its next task until the 
> deferred from its previous one has fired.

Would something like this be ok?

from zope.interface import implements
from asynqueue import IWorker

class DeferredWorker(object):
    
    implements(IWorker)
    cQualified = []
    
    def __init__(self):
        self.iQualified = []
        
    def run(self, task):
        self.task = task
        f, args, kw = task.callTuple
        d = f(*args, **kw)
        d.addCallbacks(task.callback, task.errback)
        return d

    def setResignator(self, callableObject):
        """
        There's nothing that would make me resign.
        """
        
    def stop(self):
        pass
    
    def crash(self):
        return self.task

At least it seems to do the job ;)


regards,

Stephan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Dies ist ein digital signierter Nachrichtenteil
URL: </pipermail/twisted-python/attachments/20080812/4fb2ec38/attachment.sig>

From mattias.brandstrom at todos.se  Tue Aug 12 09:56:44 2008
From: mattias.brandstrom at todos.se (=?iso-8859-1?Q?Mattias_Br=E4ndstr=F6m?=)
Date: Tue, 12 Aug 2008 17:56:44 +0200
Subject: [Twisted-Python] (no subject)
Message-ID: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>

Hello!

Is there any way I can make twisted stop accepting connections for a short period of time and then start accepting connections? Something like reactor.pause()?

More precisely, what I want to do is to reread my server configuration on SIGHUP (or some other external event). If possible I would like to do this without locking a mutex when accessing (reading or modifying) the configuration info. I figure that reconfiguring the server will be a rare event. So if there is some way that I can:

1. Block incoming requests. Preferable keeping them in the connection queue.
2. Wait for all running requests to complete.
3. Reread the server configuration.
4. Unblock incoming requests. 

What do you think? Is there some simple twisted-way to do this?

If this has been covered in the past, please point me in that direction. :-)

Regards,
Mattias



From wzeller at cs.princeton.edu  Tue Aug 12 14:40:19 2008
From: wzeller at cs.princeton.edu (Bill Zeller)
Date: Tue, 12 Aug 2008 16:40:19 -0400
Subject: [Twisted-Python] twisted python conch SSH shell?
Message-ID: <74a0fd5f0808121340pdf0e46egd4dfb9b1c10cbaf4@mail.gmail.com>

Hi,

I've been playing around with Twisted's Conch client (which looks extremely
well done, thanks!). I've been able to connect to a conch server and also
connect to other ssh servers and execuate various commands. I'd like to be
able to connect to an arbitrary SSH server and run /bin/bash.

I'm able to execute a command like so:

---------------------
class CommandChannel(channel.SSHChannel):
    ....
    def channelOpen(self, data):
        self.conn.sendRequest(
            self, 'exec', common.NS(self.command),
wantReply=True).addCallback(
            self._gotResponse)
---------------------

Looking through the SSH spec (connect protocol, rfc4254), it looks like
shells are opened with this command.

---------------------

      byte      SSH_MSG_CHANNEL_REQUEST
      uint32    recipient channel
      string    "shell"
      boolean   want reply

---------------------

It doesn't look like Conch supports these requests (here's how
CHANNEL_REQUESTs are currently sent out)

---------------------
(Twisted-8.1.0)
twisted/conch/ssh/connection.py (413):
        self.transport.sendPacket(MSG_CHANNEL_REQUEST, struct.pack('>L',
                                    self.channelsToRemoteChannel[channel])
                                  + common.NS(requestType)+chr(wantReply)
                                  + data)
---------------------

I may be misunderstanding how remote shells are started, so any help would
be appreciated.

Again, I'm trying to launch an interactive /bin/bash shell from a Conch SSH
client on an arbitrary remote SSH server.

Thanks for your time.

Best Regards,
Bill Zeller
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080812/68837d32/attachment.html>

From mattias.brandstrom at todos.se  Wed Aug 13 01:02:59 2008
From: mattias.brandstrom at todos.se (=?iso-8859-1?Q?Mattias_Br=E4ndstr=F6m?=)
Date: Wed, 13 Aug 2008 09:02:59 +0200
Subject: SV: [Twisted-Python] Temporarily blocking connections
In-Reply-To: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
References: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
Message-ID: <B48E5D5E8E1DDE4D816167B851EC44356AB9A9@exchange.mejl.ecode.se>

Ops. I missed the subject. This should make things a little crearer.

> -----Ursprungligt meddelande-----
> Frn: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-
> bounces at twistedmatrix.com] Fr Mattias Brndstrm
> Skickat: den 12 augusti 2008 17:57
> Till: twisted-python at twistedmatrix.com
> mne: [Twisted-Python] (no subject)
> 
> Hello!
> 
> Is there any way I can make twisted stop accepting connections for a short
> period of time and then start accepting connections? Something like
> reactor.pause()?
> 
> More precisely, what I want to do is to reread my server configuration on
> SIGHUP (or some other external event). If possible I would like to do this
> without locking a mutex when accessing (reading or modifying) the
> configuration info. I figure that reconfiguring the server will be a rare
> event. So if there is some way that I can:
> 
> 1. Block incoming requests. Preferable keeping them in the connection
> queue.
> 2. Wait for all running requests to complete.
> 3. Reread the server configuration.
> 4. Unblock incoming requests.
> 
> What do you think? Is there some simple twisted-way to do this?
> 
> If this has been covered in the past, please point me in that direction.
> :-)
> 
> Regards,
> Mattias
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From Marcin.Kasperski at softax.com.pl  Wed Aug 13 11:47:53 2008
From: Marcin.Kasperski at softax.com.pl (Marcin Kasperski)
Date: Wed, 13 Aug 2008 19:47:53 +0200
Subject: [Twisted-Python] raw deferreds vs deferredGenerator vs
	inlineCallbacks
Message-ID: <87vdy4q01i.fsf@softax.com.pl>


I wrote a short example comparing the 3. Prepared it mostly for
myself, but maybe it will be of some use for somebody:

http://blog.mekk.waw.pl/archives/14-Twisted-inlineCallbacks-and-deferredGenerator.html

PS Crucial function:
  raw deferreds     - 29 non-empty lines of code, 
  deferredGenerator - 26 lines,
  inlineCallbacks   - 17 lines


-- 
----------------------------------------------------------------------
| Marcin Kasperski   | Systems built by humans are always subject
| http://mekk.waw.pl |          to human error. (Parnas)
|                    |
----------------------------------------------------------------------




From exarkun at divmod.com  Wed Aug 13 11:57:34 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 13 Aug 2008 13:57:34 -0400
Subject: [Twisted-Python] raw deferreds vs deferredGenerator vs
	inlineCallbacks
In-Reply-To: <87vdy4q01i.fsf@softax.com.pl>
Message-ID: <20080813175734.29191.321513541.divmod.quotient.13941@ohm>

On Wed, 13 Aug 2008 19:47:53 +0200, Marcin Kasperski <marcin.kasperski at softax.com.pl> wrote:
>
>I wrote a short example comparing the 3. Prepared it mostly for
>myself, but maybe it will be of some use for somebody:
>
>http://blog.mekk.waw.pl/archives/14-Twisted-inlineCallbacks-and-deferredGenerator.html
>
>PS Crucial function:
>  raw deferreds     - 29 non-empty lines of code,
>  deferredGenerator - 26 lines,
>  inlineCallbacks   - 17 lines
>

Nice comparison.  A more idiomatic rendering of the "raw deferred"
example might look like this, though:

  def lookup(country, search_term):
      query = "http://www.google.%s/search?q=%s" % (country,search_term)
      d = getPage(query)
      def cbFirstPage(content, country):
          m = re.search('<div id="?res.*?href="(?P<url>http://[^"]+)"',
                        content, re.DOTALL)
          if not m:
              return None
          url = m.group('url')
          d = getPage(url)
          def cbSecondPage(content, country, url):
              m = re.search("<title>(.*?)</title>", content)
              if m:
                  title = m.group(1)
                  return dict(url = url, title = title)
              else:
                  return dict(url=url, title="<not-specified>")
          d.addCallback(cbSecondPage, country, url)
          return d
      d.addCallback(cbGotPage, country)
      def ebGeneric(err, country):
          print ".%s FAILED: %s" % (country, str(e))
      d.addErrback(ebGeneric, country)
      return d

Converting any failure into a print and a None result is a bit strange,
but it's the same thing your other two examples did so I preserved that
behavior.

Jean-Paul



From Marcin.Kasperski at softax.com.pl  Wed Aug 13 12:28:24 2008
From: Marcin.Kasperski at softax.com.pl (Marcin Kasperski)
Date: Wed, 13 Aug 2008 20:28:24 +0200
Subject: [Twisted-Python] Re: raw deferreds vs deferredGenerator vs
	inlineCallbacks
References: <87vdy4q01i.fsf@softax.com.pl>
	<20080813175734.29191.321513541.divmod.quotient.13941@ohm>
Message-ID: <87r68spy5z.fsf@softax.com.pl>

> Nice comparison.  A more idiomatic rendering of the "raw deferred"
> example might look like this, though:
> (...)

Hmm, I'd be glad to add this to the article in a way or another,
would you mind it?

(btw, I find my "raw" example more readable, but this is likely a
matter of taste...)

> Converting any failure into a print and a None result is a bit strange,

Just wanted to do something illustrating error handling





From exarkun at divmod.com  Wed Aug 13 12:54:25 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 13 Aug 2008 14:54:25 -0400
Subject: [Twisted-Python] Re: raw deferreds vs deferredGenerator vs
	inlineCallbacks
In-Reply-To: <87r68spy5z.fsf@softax.com.pl>
Message-ID: <20080813185425.29191.1762423683.divmod.quotient.13969@ohm>

On Wed, 13 Aug 2008 20:28:24 +0200, Marcin Kasperski <marcin.kasperski at softax.com.pl> wrote:
>> Nice comparison.  A more idiomatic rendering of the "raw deferred"
>> example might look like this, though:
>> (...)
>
>Hmm, I'd be glad to add this to the article in a way or another,
>would you mind it?
>

Sure, that's fine with me.

Jean-Paul



From glyph at divmod.com  Wed Aug 13 13:15:30 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Wed, 13 Aug 2008 19:15:30 -0000
Subject: [Twisted-Python] raw deferreds vs deferredGenerator vs
	inlineCallbacks
In-Reply-To: <87vdy4q01i.fsf@softax.com.pl>
References: <87vdy4q01i.fsf@softax.com.pl>
Message-ID: <20080813191530.25821.682106228.divmod.xquotient.14218@joule.divmod.com>


On 05:47 pm, marcin.kasperski at softax.com.pl wrote:
>I wrote a short example comparing the 3. Prepared it mostly for
>myself, but maybe it will be of some use for somebody:

Thanks for writing this up!  It always makes me happy to see the 
ecosystem around Twisted developing, people blogging about stuff like 
this.  Makes it feel like a real project.

Of course it would make it feel even more like a real project if you 
could be convinced to contribute to the official documentation :). 
There's no mention of inlineCallbacks in the official documentation (the 
stuff in doc/) at all, and it would be helpful to have at least an 
overview.



From f.ingram.lists at gmail.com  Thu Aug 14 05:26:46 2008
From: f.ingram.lists at gmail.com (Felix Ingram)
Date: Thu, 14 Aug 2008 12:26:46 +0100
Subject: [Twisted-Python] HTTP CONNECT support
Message-ID: <41beb4dc0808140426g42c45025y2f75a0d41d0ae373@mail.gmail.com>

Hello all,

I posted the following to the web mailing list but on second thoughts
I think that it's kinda a problem with my understanding of the other
parts of the framework, so I'm reposting it here. I'd appreciate any
pointers. It's a bit lengthy, so apologies for that.



I'm looking into adding HTTPS support to the proxy module for some
testing I'm doing. I'd like to be able to trap requests and responses
as they go to and from the server, so proper CONNECT support is not
really what I'm aiming for. I've come up with the following:

"""
from twisted.web import proxy, http
from twisted.internet import reactor, ssl
from twisted.python import log
import sys
import urlparse

from OpenSSL import SSL as OSSL

class MyProxyClient(proxy.ProxyClient):

   def handleEndHeaders(self):
       print "THOSE HEADERS DONE ENDED"
       self.father.transport.write("\r\n")

   def handleResponsePart(self, buffer):
       print "GOT SOME STUFF TO SEND TO THE BROWSER"
       self.father.transport.write(buffer)

   def dataReceived(self, data):
       print "To the Browser"
       print data # Data sent to the browser
       proxy.ProxyClient.dataReceived(self, data)

   def handleResponseEnd(self):
       print "losing connection..."
       self.transport.loseConnection()
       self.father.channel.transport.loseConnection()


class MyProxyClientFactory(proxy.ProxyClientFactory):
   def buildProtocol(self, addr):
       client = proxy.ProxyClientFactory.buildProtocol(self, addr)
       client.__class__ = MyProxyClient
       return client

class MySSLContext(ssl.ContextFactory):
   def getContext(self):
       ctx = OSSL.Context(OSSL.SSLv23_METHOD)
       ctx.use_certificate_file('server.cert')
       ctx.use_privatekey_file('server.pkey')
       return ctx

class MyProxyRequest(proxy.ProxyRequest):
   protocols = {
           'http': MyProxyClientFactory,
           'https': MyProxyClientFactory
           }
   ports = {
           'http': 80,
           'https': 443
           }

   def requestDone(self, request):
       """Called by first request in queue when it is done."""
       print "REQUESTDONE DONE BE CALLED"
       if request != self.requests[0]: raise TypeError
       del self.requests[0]

       if self.persistent:
           # notify next request it can start writing
           if self.requests:
               self.requests[0].noLongerQueued()
           else:
               if self._savedTimeOut:
                   self.setTimeout(self._savedTimeOut)
       else:
           print "lOSING CONNECTION"
           self.transport.loseConnection()

   def process(self):
       parsed = urlparse.urlparse(self.uri)
       protocol = parsed.scheme
       host = parsed.hostname
       doSSL = False
       if self.method.upper() == "CONNECT":
           self.transport.write("HTTP/1.1 200 Connection established\r\n\r\n")
           self.transport.startTLS(MySSLContext())
           protocol = "https"
           self.host = parsed.scheme
           print "finished connect request"
       else:
           if self.isSecure():
               headers = self.getAllHeaders().copy()
               host = headers["host"]
               protocol = "https"
               doSSL = True
           port = self.ports[protocol]
           if ':' in host:
               host, port = host.split(':')
               port = int(port)
           rest = urlparse.urlunparse(('', '') + parsed[2:])
           if not rest:
               rest = rest + '/'
           class_ = self.protocols[protocol]
           headers = self.getAllHeaders().copy()
           if 'host' not in headers:
               headers['host'] = host
           self.content.seek(0, 0)
           s = self.content.read()
           clientFactory = class_(self.method, rest, self.clientproto, headers,
                           s, self)
           if not doSSL:
               self.reactor.connectTCP(host, port, clientFactory)
           else:
               print "Connecting to SSL"
               self.reactor.connectSSL(host, port, clientFactory,
ssl.ClientContextFactory())

class MyProxy(proxy.Proxy):
   def dataReceived(self, data):
       print "To the Server"
       print data # Data sent to the server
       proxy.Proxy.dataReceived(self, data)

   def requestFactory(self, *args):
       return MyProxyRequest(*args)

class ProxyFactory(http.HTTPFactory):
       protocol = MyProxy

reactor.listenTCP(8081, ProxyFactory())
log.startLogging(sys.stdout) # Log to the console
reactor.run()
"""

Most of the magic is happening in the 'process' method. I've copied
some of the other methods in for debugging. At the moment it's a bit
hackish but it's almost working as expected. When a connect request is
received then the SSL connection is set up as required (using
transport.startTLS). This generates certificate mismatch errors in the
browser, but this is expected and is what I'm looking for as then I can read the
requests as they come through.
The GET request is then received from the browser and forwarded on to the
server. The server appears to be happy with this as it does pass the
appropriate response back to the proxy. For some reason, however, the
browser does not then get passed the response. Comparing identical
requests for the HTTP and HTTPS versions of a site show that the only
apparent difference is that the headers and body are sent in one go
under HTTP and as two separate chunks under HTTPS.

E.g. HTTPS:
"""
2008-08-07 15:34:15+0100 [MyProxyClient,client] To the Browser
2008-08-07 15:34:15+0100 [MyProxyClient,client] HTTP/1.1 200 OK
2008-08-07 15:34:15+0100 [MyProxyClient,client] Date: Thu, 07 Aug 2008
14:34:15 GMT
2008-08-07 15:34:15+0100 [MyProxyClient,client] Server: Apache/2.2.9
(Win32) DAV/2 mod_ssl/2.2.9 Ope
nSSL/0.9.8h mod_autoindex_color PHP/5.2.6
2008-08-07 15:34:15+0100 [MyProxyClient,client] X-Powered-By: PHP/5.2.6
2008-08-07 15:34:15+0100 [MyProxyClient,client] Content-Length: 1325
2008-08-07 15:34:15+0100 [MyProxyClient,client] Connection: close
2008-08-07 15:34:15+0100 [MyProxyClient,client] Content-Type: text/html
2008-08-07 15:34:15+0100 [MyProxyClient,client]
2008-08-07 15:34:15+0100 [MyProxyClient,client]
2008-08-07 15:34:15+0100 [MyProxyClient,client] THOSE HEADERS DONE ENDED
2008-08-07 15:34:15+0100 [MyProxyClient,client] To the Browser
2008-08-07 15:34:15+0100 [MyProxyClient,client] <html>
2008-08-07 15:34:15+0100 [MyProxyClient,client] <head><title>XAMPP</title>
2008-08-07 15:34:15+0100 [MyProxyClient,client] <link href="xampp.css"
rel="stylesheet" type="text/c
...
"""

HTTP:
"""
2008-08-07 15:34:01+0100 [MyProxyClient,client] To the Browser
2008-08-07 15:34:01+0100 [MyProxyClient,client] HTTP/1.1 200 OK
2008-08-07 15:34:01+0100 [MyProxyClient,client] Date: Thu, 07 Aug 2008
14:34:01 GMT
2008-08-07 15:34:01+0100 [MyProxyClient,client] Server: Apache/2.2.9
(Win32) DAV/2 mod_ssl/2.2.9 Ope
nSSL/0.9.8h mod_autoindex_color PHP/5.2.6
2008-08-07 15:34:01+0100 [MyProxyClient,client] X-Powered-By: PHP/5.2.6
2008-08-07 15:34:01+0100 [MyProxyClient,client] Content-Length: 1325
2008-08-07 15:34:01+0100 [MyProxyClient,client] Connection: close
2008-08-07 15:34:01+0100 [MyProxyClient,client] Content-Type: text/html
2008-08-07 15:34:01+0100 [MyProxyClient,client]
2008-08-07 15:34:01+0100 [MyProxyClient,client] <html>
2008-08-07 15:34:01+0100 [MyProxyClient,client] <head><title>XAMPP</title>
2008-08-07 15:34:01+0100 [MyProxyClient,client] <link href="xampp.css"
rel="stylesheet" type="text/c
"""

The HTTPS version seems to have an extra line feed being added after
the headers, which may be causing the problem. I've tried stripping
this out but then I get some other exception being thrown and HTTP
traffic stops working.

I've got a feeling that I'm not quite going about this in the correct
way but I'd appreciate any help or insights that anyone could offer.
If you need any more details then please ask.

Many thanks in advance,

Felix



From lasizoillo at gmail.com  Fri Aug 15 10:21:56 2008
From: lasizoillo at gmail.com (lasizoillo)
Date: Fri, 15 Aug 2008 18:21:56 +0200
Subject: [Twisted-Python] (no subject)
In-Reply-To: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
References: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
Message-ID: <49414f570808150921v166a81f9mbaae63ef25bbd77b@mail.gmail.com>

Hello

2008/8/12 Mattias Brndstrm <mattias.brandstrom at todos.se>:
> Hello!
>
> Is there any way I can make twisted stop accepting connections for a short period of time and then start accepting connections? Something like reactor.pause()?
>
> More precisely, what I want to do is to reread my server configuration on SIGHUP (or some other external event). If possible I would like to do this without locking a mutex when accessing (reading or modifying) the configuration info. I figure that reconfiguring the server will be a rare event. So if there is some way that I can:
>
> 1. Block incoming requests. Preferable keeping them in the connection queue.
> 2. Wait for all running requests to complete.
> 3. Reread the server configuration.
> 4. Unblock incoming requests.
>
> What do you think? Is there some simple twisted-way to do this?
>
It's really necesary do that?

1 Your app have a reference to a object whith the loaded config
2 A defered take a reference to these object
3 A reread event change the app config reference to new loaded config
object. Old defered no change his reference and end whith old config.
4 New defereds take new config and reference that.
5 When old config object have not references is garbaged collected.

No blocking operation is nedded if you can load 2 configuration
objects in memory (the old one for connections in progress and the new
one).

Excuse my poor english.

Regards,

Javi

> If this has been covered in the past, please point me in that direction. :-)
>
> Regards,
> Mattias
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From lasizoillo at gmail.com  Fri Aug 15 19:51:51 2008
From: lasizoillo at gmail.com (lasizoillo)
Date: Sat, 16 Aug 2008 03:51:51 +0200
Subject: [Twisted-Python] Bluetooth reactor interface
In-Reply-To: <489A013D.4000807@mit.edu>
References: <489A013D.4000807@mit.edu>
Message-ID: <49414f570808151851n3915d3aei9bba811ff818b4c6@mail.gmail.com>

2008/8/6 Nadav Aharony <nadav at mit.edu>:
> (forwarding for Daniel who had some list posting trouble)
>
> Hi all-
> I'd like to use Twisted to manage bluetooth communication. I haven't
> found any existing method for doing this, so I'd like to write and
> implement a new reactor interface (on par with TCP/UDP) that wraps the
> lightblue library. What's the right way to go about extending Twisted in
> this way?
> Thanks,
> Daniel

I recently discovered elisa. A media center implemented with twisted python.
Elisa have a bluetoth plugin than use py-bluez (other bt library). The
code is here:

http://bazaar.launchpad.net/~elisa-developers/elisa/upicek/annotate/11.5.55?filter_file_id=bluetooth_input.py-20080401102113-vcj3p4systzzapcn-411&file_id=bluetooth_input.py-20080401102113-vcj3p4systzzapcn-411

I don't know if it is useful for you.

Regards,

Javi



From pbastov at gmail.com  Sat Aug 16 05:57:47 2008
From: pbastov at gmail.com (Pavel)
Date: Sat, 16 Aug 2008 17:57:47 +0600
Subject: [Twisted-Python] Disable twisted web logging
Message-ID: <eaf39e680808160457q6449dcf9w28016376564cc0fb@mail.gmail.com>

My Twisted server is listening on two ports: 80 for processing http
requrests and xxx for
processing tcp requests from clients.

http logs seem to clutter my log file. Is there any way to disable
http logs only and leave
logging facility otherwise intact? Or at least redirect http logs to a
different file?

Thanks in advance.

-- 
Good luck,

Pavel Bastov



From thenoob06 at gmail.com  Sat Aug 16 06:04:22 2008
From: thenoob06 at gmail.com (The Noob)
Date: Sat, 16 Aug 2008 14:04:22 +0200
Subject: [Twisted-Python] Execute interactive commands with a custom ssh
	shell
Message-ID: <9263743c0808160504m1bf01afbiff248d7899c4f8dc@mail.gmail.com>

Hello all,
I try to implement a custom ssh server with twisted . I use* sshserver.py to
begin (* http://www.devshed.com/c/a/Python/SSH-with-Twisted/ )
I would like to execute interactive scripts which are on my server. The
problem is theses scripts are interactives. How can I redirect IO on my
shell ?
For example, if I want to install a software with apt. I have questions to
install dependencies ( yes/no)
I start to create a definition for this function like def do_apt. And then
when in my custom shell I execute ( apt python)., that executes apt-get
install python on the server. But how can I redirect the output in my shell
to answer dependencies questions ?
Thanks for your help

Best Regards
The Noob06
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080816/8e3eeadb/attachment.html>

From exarkun at divmod.com  Sat Aug 16 06:05:58 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 16 Aug 2008 08:05:58 -0400
Subject: [Twisted-Python] Disable twisted web logging
In-Reply-To: <eaf39e680808160457q6449dcf9w28016376564cc0fb@mail.gmail.com>
Message-ID: <20080816120558.29191.1320366514.divmod.quotient.15176@ohm>

On Sat, 16 Aug 2008 17:57:47 +0600, Pavel <pbastov at gmail.com> wrote:
>My Twisted server is listening on two ports: 80 for processing http
>requrests and xxx for
>processing tcp requests from clients.
>
>http logs seem to clutter my log file. Is there any way to disable
>http logs only and leave
>logging facility otherwise intact? Or at least redirect http logs to a
>different file?

If you pass a filename for the `logPath parameter to `Site, request
logs will be written to that file instead of to the main log.

Jean-Paul



From exarkun at divmod.com  Sat Aug 16 06:14:41 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 16 Aug 2008 08:14:41 -0400
Subject: [Twisted-Python] Execute interactive commands with a custom ssh
	shell
In-Reply-To: <9263743c0808160504m1bf01afbiff248d7899c4f8dc@mail.gmail.com>
Message-ID: <20080816121441.29191.2037211177.divmod.quotient.15180@ohm>

On Sat, 16 Aug 2008 14:04:22 +0200, The Noob <thenoob06 at gmail.com> wrote:
>Hello all,
>I try to implement a custom ssh server with twisted . I use* sshserver.py to
>begin (* http://www.devshed.com/c/a/Python/SSH-with-Twisted/ )
>I would like to execute interactive scripts which are on my server. The
>problem is theses scripts are interactives. How can I redirect IO on my
>shell ?
>For example, if I want to install a software with apt. I have questions to
>install dependencies ( yes/no)
>I start to create a definition for this function like def do_apt. And then
>when in my custom shell I execute ( apt python)., that executes apt-get
>install python on the server. But how can I redirect the output in my shell
>to answer dependencies questions ?
>Thanks for your help

To run a program like apt, you must be using `reactor.spawnProcess.  That
means that you have two different protocol implementations.  One to talk
to the SSH connection (eg, `SSHDemoProtocol in the O'Reilly example) and
one to talk to the child process.

If you want output from the child process to show up in the SSH client, then
when the process protocol receives data from it, it should pass it on to the
SSH protocol to write to the client.  Similarly, if you want input from the
SSH client written to the stdin of the child process, when the SSH protocol
receives data it should pass it on to the process protocol to write to the
child process.

You'll have to keep track of what state your application is in to do this
correctly.  Input should only be handled this way when there is actually
a child process running.

Jean-Paul



From thenoob06 at gmail.com  Sat Aug 16 12:06:48 2008
From: thenoob06 at gmail.com (The Noob)
Date: Sat, 16 Aug 2008 20:06:48 +0200
Subject: [Twisted-Python] Execute interactive commands with a custom ssh
	shell
In-Reply-To: <20080816121441.29191.2037211177.divmod.quotient.15180@ohm>
References: <9263743c0808160504m1bf01afbiff248d7899c4f8dc@mail.gmail.com>
	<20080816121441.29191.2037211177.divmod.quotient.15180@ohm>
Message-ID: <9263743c0808161106q6a45b4adx24b978146ed82213@mail.gmail.com>

Thanks very much Jean-Paul for your answer.
I will try to implement reactor.spawnProcess with this example.
Best Regards
TheNoob06

2008/8/16 Jean-Paul Calderone <exarkun at divmod.com>

> On Sat, 16 Aug 2008 14:04:22 +0200, The Noob <thenoob06 at gmail.com> wrote:
>
>> Hello all,
>> I try to implement a custom ssh server with twisted . I use* sshserver.py
>> to
>> begin (* http://www.devshed.com/c/a/Python/SSH-with-Twisted/ )
>> I would like to execute interactive scripts which are on my server. The
>> problem is theses scripts are interactives. How can I redirect IO on my
>> shell ?
>> For example, if I want to install a software with apt. I have questions to
>> install dependencies ( yes/no)
>> I start to create a definition for this function like def do_apt. And then
>> when in my custom shell I execute ( apt python)., that executes apt-get
>> install python on the server. But how can I redirect the output in my
>> shell
>> to answer dependencies questions ?
>> Thanks for your help
>>
>
> To run a program like apt, you must be using `reactor.spawnProcess.  That
> means that you have two different protocol implementations.  One to talk
> to the SSH connection (eg, `SSHDemoProtocol in the O'Reilly example) and
> one to talk to the child process.
>
> If you want output from the child process to show up in the SSH client,
> then
> when the process protocol receives data from it, it should pass it on to
> the
> SSH protocol to write to the client.  Similarly, if you want input from the
> SSH client written to the stdin of the child process, when the SSH protocol
> receives data it should pass it on to the process protocol to write to the
> child process.
>
> You'll have to keep track of what state your application is in to do this
> correctly.  Input should only be handled this way when there is actually
> a child process running.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080816/190153b9/attachment.html>

From exarkun at twistedmatrix.com  Sat Aug 16 22:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 17 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1218945909.18.339001850@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080817/6222529e/attachment.html>

From pbastov at gmail.com  Sun Aug 17 22:12:14 2008
From: pbastov at gmail.com (Pavel)
Date: Mon, 18 Aug 2008 10:12:14 +0600
Subject: [Twisted-Python] Disable twisted web logging
In-Reply-To: <20080816120558.29191.1320366514.divmod.quotient.15176@ohm>
References: <eaf39e680808160457q6449dcf9w28016376564cc0fb@mail.gmail.com>
	<20080816120558.29191.1320366514.divmod.quotient.15176@ohm>
Message-ID: <eaf39e680808172112l38b90ec2g21ab6c0af8e5d0d8@mail.gmail.com>

Thanks a lot!

Will implement it.

On Sat, Aug 16, 2008 at 6:05 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Sat, 16 Aug 2008 17:57:47 +0600, Pavel <pbastov at gmail.com> wrote:
>>
>> My Twisted server is listening on two ports: 80 for processing http
>> requrests and xxx for
>> processing tcp requests from clients.
>>
>> http logs seem to clutter my log file. Is there any way to disable
>> http logs only and leave
>> logging facility otherwise intact? Or at least redirect http logs to a
>> different file?
>
> If you pass a filename for the `logPath parameter to `Site, request
> logs will be written to that file instead of to the main log.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Good luck,

Pavel Bastov
xooChat Team Leader
http://www.xoochat.com/



From newptcai at gmail.com  Sun Aug 17 22:29:46 2008
From: newptcai at gmail.com (Peter Cai)
Date: Mon, 18 Aug 2008 12:29:46 +0800
Subject: [Twisted-Python] Is there any similar programming framework like
	twsited in C/C++ world.
Message-ID: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>

Hi all,

In my opinion, I like twisted very much but my coworkers are all quite
unfamiliar with Python.  And also we are afraid of source code leak problem.

So, can you remember some similar framework in C/C++ world?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080818/47f108f0/attachment.html>

From glyph at divmod.com  Sun Aug 17 23:56:19 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Mon, 18 Aug 2008 05:56:19 -0000
Subject: [Twisted-Python] Is there any similar programming framework like
	twsited in C/C++ world.
In-Reply-To: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>
References: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>
Message-ID: <20080818055619.25821.1541633807.divmod.xquotient.14370@joule.divmod.com>

On 04:29 am, newptcai at gmail.com wrote:
>So, can you remember some similar framework in C/C++ world?

You might want to try ACE: http://www.cs.wustl.edu/~schmidt/ACE.html
>In my opinion, I like twisted very much but my coworkers are all quite
>unfamiliar with Python.

Understandable, but it might be worthwhile to learn.  Python can be a 
much more productive language than C++.
>And also we are afraid of source code leak problem.

If your users are savvy enough to extract Python source code from a 
trivially obfuscated executable, they are probably savvy enough to 
extract the information they want by decompiling your C++ binaries too. 
There are a lot of people who are really very skilled at this.  You 
should not assume that just because you are using C or C++, your source 
code is safe.



From jakamkon at gmail.com  Mon Aug 18 00:54:48 2008
From: jakamkon at gmail.com (Kuba Konczyk)
Date: Mon, 18 Aug 2008 07:54:48 +0100
Subject: [Twisted-Python] Is there any similar programming framework like
	twsited in C/C++ world.
In-Reply-To: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>
References: <befee6d80808172129n21b2c63t1a49e45a6d7ee315@mail.gmail.com>
Message-ID: <48A91CB8.9040100@gmail.com>

Peter Cai wrote:
>
> So, can you remember some similar framework in C/C++ world?
You can have a look at libevent - http://www.monkey.org/~provos/libevent/



From gabriel.rossetti at arimaz.com  Mon Aug 18 04:11:33 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 18 Aug 2008 12:11:33 +0200
Subject: [Twisted-Python] wxPython integration & msg sending from the GUI
Message-ID: <48A94AD5.5010601@arimaz.com>

Hello everyone,

when using wxPython integration, if my GUI wants to send msgs, do I need 
to schedule the msg sending through the reactor like is needed when 
using non-reactor threads (see my post who's subject is "does 
setTcpNoDelay() not work?"), like :

    reactor.callFromThread(srv.sendMessage, "my msg")


or can I directly call it like :

    srv.sendMessage(my msg")

? I followed the wx integration tutorial on the Twisted homepage. I 
guess my question is more like : "Does the wxPython integration make it 
run in the reactor thread or not".

Thank you,
Gabriel




From mattias.brandstrom at todos.se  Mon Aug 18 04:12:41 2008
From: mattias.brandstrom at todos.se (=?iso-8859-1?Q?Mattias_Br=E4ndstr=F6m?=)
Date: Mon, 18 Aug 2008 12:12:41 +0200
Subject: SV: [Twisted-Python] Reloading server configuration.
In-Reply-To: <49414f570808150921v166a81f9mbaae63ef25bbd77b@mail.gmail.com>
References: <B48E5D5E8E1DDE4D816167B851EC44356AB9A1@exchange.mejl.ecode.se>
	<49414f570808150921v166a81f9mbaae63ef25bbd77b@mail.gmail.com>
Message-ID: <B48E5D5E8E1DDE4D816167B851EC44356ABA5A@exchange.mejl.ecode.se>

> -----Ursprungligt meddelande-----
> Frn: twisted-python-bounces at twistedmatrix.com [mailto:twisted-python-
> bounces at twistedmatrix.com] Fr lasizoillo
> Skickat: den 15 augusti 2008 18:22
> Till: Twisted general discussion
> mne: Re: [Twisted-Python] (no subject)
> 
> Hello
> 
> 2008/8/12 Mattias Brndstrm <mattias.brandstrom at todos.se>:
> > Hello!
> >
> > Is there any way I can make twisted stop accepting connections for a
> short period of time and then start accepting connections? Something like
> reactor.pause()?
> >
> > More precisely, what I want to do is to reread my server configuration
> on SIGHUP (or some other external event). If possible I would like to do
> this without locking a mutex when accessing (reading or modifying) the
> configuration info. I figure that reconfiguring the server will be a rare
> event. So if there is some way that I can:
> >
> > 1. Block incoming requests. Preferable keeping them in the connection
> queue.
> > 2. Wait for all running requests to complete.
> > 3. Reread the server configuration.
> > 4. Unblock incoming requests.
> >
> > What do you think? Is there some simple twisted-way to do this?
> >
> It's really necesary do that?
> 
> 1 Your app have a reference to a object whith the loaded config
> 2 A defered take a reference to these object
> 3 A reread event change the app config reference to new loaded config
> object. Old defered no change his reference and end whith old config.
> 4 New defereds take new config and reference that.
> 5 When old config object have not references is garbaged collected.
> 
> No blocking operation is nedded if you can load 2 configuration
> objects in memory (the old one for connections in progress and the new
> one).
> 

OK. This seems like a good approach. However, I am using twisted.web.server.Site as my factory and the resources tied to my Site instance are the ones that need to access the server configuration. How would I go about giving each request its own configuration reference in this case? I'm quite new to twisted and it's not entirely clear to me how to achieve this. :-)

:.:: mattias



From itamar at itamarst.org  Mon Aug 18 06:36:54 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 18 Aug 2008 12:36:54 +0000
Subject: [Twisted-Python] wxPython integration & msg sending from the GUI
In-Reply-To: <48A94AD5.5010601@arimaz.com>
References: <48A94AD5.5010601@arimaz.com>
Message-ID: <1219063014.5308.183.camel@localhost.localdomain>

On Mon, 2008-08-18 at 12:11 +0200, Gabriel Rossetti wrote:

> or can I directly call it like :
> 
>     srv.sendMessage(my msg")
> 

You can do that, yes.

> ? I followed the wx integration tutorial on the Twisted homepage. I 
> guess my question is more like : "Does the wxPython integration make it 
> run in the reactor thread or not".

wxreactor makes wx run in same thread as Twisted, yes (at least from
your point of view).




From psanchez at nortel.com  Mon Aug 18 16:14:02 2008
From: psanchez at nortel.com (Pedro Sanchez)
Date: Mon, 18 Aug 2008 18:14:02 -0400
Subject: [Twisted-Python] Twisted and D-BUS
Message-ID: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>

Hello,

I'd like to get your opinion on using the D-Bus within a twisted
application. Would the Python D-Bus binding at

http://dbus.freedesktop.org/doc/dbus-python/doc/tutorial.html

work with twisted? is there a recommended approach?

Thank you,

-- 
Pedro







From gabriel.rossetti at arimaz.com  Tue Aug 19 00:37:14 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 19 Aug 2008 08:37:14 +0200
Subject: [Twisted-Python] wxPython integration & msg sending from the GUI
In-Reply-To: <1219063014.5308.183.camel@localhost.localdomain>
References: <48A94AD5.5010601@arimaz.com>
	<1219063014.5308.183.camel@localhost.localdomain>
Message-ID: <48AA6A1A.6020806@arimaz.com>

Itamar Shtull-Trauring wrote:
> On Mon, 2008-08-18 at 12:11 +0200, Gabriel Rossetti wrote:
>
>   
>> or can I directly call it like :
>>
>>     srv.sendMessage(my msg")
>>
>>     
>
> You can do that, yes.
>
>   
Ok
>> ? I followed the wx integration tutorial on the Twisted homepage. I 
>> guess my question is more like : "Does the wxPython integration make it 
>> run in the reactor thread or not".
>>     
>
> wxreactor makes wx run in same thread as Twisted, yes (at least from
> your point of view).
>
>   
Ok, thank you!

Gabriel



From p.mayers at imperial.ac.uk  Tue Aug 19 04:13:52 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 19 Aug 2008 11:13:52 +0100
Subject: [Twisted-Python] Twisted tarball unreachable?
Message-ID: <48AA9CE0.5050006@imperial.ac.uk>

Following the link on the home page I get:

[nsg at buildsrv tarballs]$ wget 
http://tmrc.mit.edu/mirror/twisted/Twisted/8.1/Twisted-8.1.0.tar.bz2#md5=a575f29ead4cc02c54e9061d0e6ac7c3
--11:08:27-- 
http://tmrc.mit.edu/mirror/twisted/Twisted/8.1/Twisted-8.1.0.tar.bz2
Resolving tmrc.mit.edu... 18.150.1.81
Connecting to tmrc.mit.edu|18.150.1.81|:80... failed: Connection refused.

Anyone know where I can get the tarball from? Some googling didn't help...



From p.mayers at imperial.ac.uk  Tue Aug 19 04:19:05 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 19 Aug 2008 11:19:05 +0100
Subject: [Twisted-Python] Re: Twisted tarball unreachable?
In-Reply-To: <48AA9CE0.5050006@imperial.ac.uk>
References: <48AA9CE0.5050006@imperial.ac.uk>
Message-ID: <48AA9E19.8020401@imperial.ac.uk>

Phil Mayers wrote:
> Following the link on the home page I get:
> 
> [nsg at buildsrv tarballs]$ wget 
> http://tmrc.mit.edu/mirror/twisted/Twisted/8.1/Twisted-8.1.0.tar.bz2#md5=a575f29ead4cc02c54e9061d0e6ac7c3 
> 
> --11:08:27-- 
> http://tmrc.mit.edu/mirror/twisted/Twisted/8.1/Twisted-8.1.0.tar.bz2
> Resolving tmrc.mit.edu... 18.150.1.81
> Connecting to tmrc.mit.edu|18.150.1.81|:80... failed: Connection refused.
> 
> Anyone know where I can get the tarball from? Some googling didn't help...

Never mind, found it



From thostrup at gmail.com  Tue Aug 19 05:59:39 2008
From: thostrup at gmail.com (Henrik Thostrup Jensen)
Date: Tue, 19 Aug 2008 13:59:39 +0200
Subject: [Twisted-Python] Couched 0.1: CouchDB twisted client
Message-ID: <f33a4da20808190459g1b6cd1fav4ef720a7c526503f@mail.gmail.com>

Hi

I've written a small python/twisted client library for CouchDB.

It's mostly a toy, but it can be fetched from here:
http://www.cs.aau.dk/~htj/code/couched-0.1.tar.gz if anyone is interested.
License: MIT

I'm aware of paisley  (https://launchpad.net/paisley),
The main difference from paisley is that the connection and database
abstraction are separated.
Also couched does connection caching and uses web2 instead of web.
Currently paisley is more feature rich, but couched has slightly nicer error
handling.

-- 
- Henrik
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080819/03f5d32e/attachment.html>

From newptcai at gmail.com  Tue Aug 19 06:08:19 2008
From: newptcai at gmail.com (Peter Cai)
Date: Tue, 19 Aug 2008 20:08:19 +0800
Subject: [Twisted-Python] Abouth threads in twisted.
Message-ID: <befee6d80808190508n7b0541c9ga2857cdbbf3b6e5a@mail.gmail.com>

Hi All,

QUESTION 1 : callFromThread
~~~~~~~~~~~~~~~~~~~~~~~~~~~

I found this code snippet in twisted manual book.
But I don't quite get it.

What does "run 'notThreadSafe(3)' in the event loop" means?

Does the reactor promise that all those "notThreadSafe" functions
be called one by one so they won't interfere each other?

#======================================

from twisted.internet import reactor

def notThreadSafe(x):
    """do something that isn't thread-safe"""
    # ...

def threadSafeScheduler():
    """Run in thread-safe manner."""

reactor.callFromThread(notThreadSafe, 3) # will run 'notThreadSafe(3)' in
the event loop

#======================================


QUESTION 2 : Integrated with a threaded 3rd party library.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
I have a C library which using a work threaded pool model.  It's interface
is like this.

    void runWorkAsyn(int args, void pcallbackfunc(int));

When runWorkAsyn is called, it dispatch work to a thread in its
own thread pool and call 'pcallbackfunc' in that thread when it's done.

I really got confused by how use this lib from twisted in a thread safe way.
If I use a python callback function as pcallbackfunc and touch the reactor
from it,
it might damage the event look as most twisted APIs are not thread safe.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080819/f7fc712f/attachment.html>

From radix at twistedmatrix.com  Tue Aug 19 07:48:35 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 19 Aug 2008 09:48:35 -0400
Subject: [Twisted-Python] Twisted and D-BUS
In-Reply-To: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
References: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
Message-ID: <60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>

On Mon, Aug 18, 2008 at 6:14 PM, Pedro Sanchez <psanchez at nortel.com> wrote:
> Hello,
>
> I'd like to get your opinion on using the D-Bus within a twisted
> application. Would the Python D-Bus binding at
>
> http://dbus.freedesktop.org/doc/dbus-python/doc/tutorial.html
>
> work with twisted? is there a recommended approach?


Yes, it works. All you have to do is make sure you use the glib2 or
gtk2 Twisted reactor, and then make sure you use the glib/gobject
event loop integration from dbus-python.


-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/



From radix at twistedmatrix.com  Tue Aug 19 07:56:06 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 19 Aug 2008 09:56:06 -0400
Subject: [Twisted-Python] Twisted and D-BUS
In-Reply-To: <60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>
References: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
	<60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>
Message-ID: <60ed19d40808190656v2f284360yde10d40f8846a44f@mail.gmail.com>

On Tue, Aug 19, 2008 at 9:48 AM, Christopher Armstrong
<radix at twistedmatrix.com> wrote:
> On Mon, Aug 18, 2008 at 6:14 PM, Pedro Sanchez <psanchez at nortel.com> wrote:
>> Hello,
>>
>> I'd like to get your opinion on using the D-Bus within a twisted
>> application. Would the Python D-Bus binding at
>>
>> http://dbus.freedesktop.org/doc/dbus-python/doc/tutorial.html
>>
>> work with twisted? is there a recommended approach?
>
>
> Yes, it works. All you have to do is make sure you use the glib2 or
> gtk2 Twisted reactor, and then make sure you use the glib/gobject
> event loop integration from dbus-python.

Sorry, I have one more thing to add:

I pray that you only have to use recent versions of dbus and
dbus-python. If you have to maintain compatibility with older versions
(like those shipped with Ubuntu 6.06 or 7.04), may God have mercy on
your soul.

-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/



From psanchez at nortel.com  Tue Aug 19 09:38:56 2008
From: psanchez at nortel.com (Pedro Sanchez)
Date: Tue, 19 Aug 2008 11:38:56 -0400
Subject: [Twisted-Python] Twisted and D-BUS
In-Reply-To: <60ed19d40808190656v2f284360yde10d40f8846a44f@mail.gmail.com>
References: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
	<60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>
	<60ed19d40808190656v2f284360yde10d40f8846a44f@mail.gmail.com>
Message-ID: <1219160336.25911.35.camel@pcard0ze.ca.nortel.com>

On Tue, 2008-08-19 at 09:56 -0400, Christopher Armstrong wrote:
> On Tue, Aug 19, 2008 at 9:48 AM, Christopher Armstrong
> <radix at twistedmatrix.com> wrote:
> > On Mon, Aug 18, 2008 at 6:14 PM, Pedro Sanchez <psanchez at nortel.com> wrote:
> >> Hello,
> >>
> >> I'd like to get your opinion on using the D-Bus within a twisted
> >> application. Would the Python D-Bus binding at
> >>
> >> http://dbus.freedesktop.org/doc/dbus-python/doc/tutorial.html
> >>
> >> work with twisted? is there a recommended approach?
> >
> >
> > Yes, it works. All you have to do is make sure you use the glib2 or
> > gtk2 Twisted reactor, and then make sure you use the glib/gobject
> > event loop integration from dbus-python.
> 
> Sorry, I have one more thing to add:
> 
> I pray that you only have to use recent versions of dbus and
> dbus-python. If you have to maintain compatibility with older versions
> (like those shipped with Ubuntu 6.06 or 7.04), may God have mercy on
> your soul.
> 
Thanks for the advice. I will be using Ubuntu 8.04.1 as my development
platform with twisted 2.5. I hope this will be OK, or do I need to move
to the latest twisted 8.1?

Thanks,

-- 
Pedro





From itamar at itamarst.org  Tue Aug 19 09:58:56 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 19 Aug 2008 15:58:56 +0000
Subject: [Twisted-Python] Abouth threads in twisted.
In-Reply-To: <befee6d80808190508n7b0541c9ga2857cdbbf3b6e5a@mail.gmail.com>
References: <befee6d80808190508n7b0541c9ga2857cdbbf3b6e5a@mail.gmail.com>
Message-ID: <1219161536.5308.209.camel@localhost.localdomain>

On Tue, 2008-08-19 at 20:08 +0800, Peter Cai wrote:
> Hi All,
> 
> QUESTION 1 : callFromThread
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~
> 
> I found this code snippet in twisted manual book.  
> But I don't quite get it.
> 
> What does "run 'notThreadSafe(3)' in the event loop" means?
> 
> Does the reactor promise that all those "notThreadSafe" functions
> be called one by one so they won't interfere each other?

They will be called in main thread, the one where you did reactor.run()

> QUESTION 2 : Integrated with a threaded 3rd party library.
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> I have a C library which using a work threaded pool model.  It's
> interface is like this.
> 
>     void runWorkAsyn(int args, void pcallbackfunc(int));
> 
> When runWorkAsyn is called, it dispatch work to a thread in its 
> own thread pool and call 'pcallbackfunc' in that thread when it's
> done.
> 
> I really got confused by how use this lib from twisted in a thread
> safe way.
> If I use a python callback function as pcallbackfunc and touch the
> reactor from it,
> it might damage the event look as most twisted APIs are not thread
> safe.

Rather than passing in callable "doSomething" as callback, pass in:
"lambda *args: reactor.callFromThread(doSomething, *args)".





From radix at twistedmatrix.com  Tue Aug 19 10:58:17 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 19 Aug 2008 12:58:17 -0400
Subject: [Twisted-Python] Twisted and D-BUS
In-Reply-To: <1219160336.25911.35.camel@pcard0ze.ca.nortel.com>
References: <1219097642.25911.21.camel@pcard0ze.ca.nortel.com>
	<60ed19d40808190648x68d0a4f3o4ef4c92ae4f73bd@mail.gmail.com>
	<60ed19d40808190656v2f284360yde10d40f8846a44f@mail.gmail.com>
	<1219160336.25911.35.camel@pcard0ze.ca.nortel.com>
Message-ID: <60ed19d40808190958w48d304ew815325cd0d7aa41c@mail.gmail.com>

On Tue, Aug 19, 2008 at 11:38 AM, Pedro Sanchez <psanchez at nortel.com> wrote:
> On Tue, 2008-08-19 at 09:56 -0400, Christopher Armstrong wrote:
>> Sorry, I have one more thing to add:
>>
>> I pray that you only have to use recent versions of dbus and
>> dbus-python. If you have to maintain compatibility with older versions
>> (like those shipped with Ubuntu 6.06 or 7.04), may God have mercy on
>> your soul.
>>
> Thanks for the advice. I will be using Ubuntu 8.04.1 as my development
> platform with twisted 2.5. I hope this will be OK, or do I need to move
> to the latest twisted 8.1?
>
> Thanks,

There's nothing in Twisted 8 that will specifically help with dbus
integration, as far as I know, but there are a number of other
improvements that may be interesting to you for other reasons. I
suggest you check out the release news

http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/NEWS%3Fformat%3Draw

That link contains release notes for 8.0 and 8.1, i.e., all changes since 2.5.


-- 
Christopher Armstrong
International Man of Twistery
http://radix.twistedmatrix.com/
http://twistedmatrix.com/
http://canonical.com/



From newptcai at gmail.com  Tue Aug 19 19:05:59 2008
From: newptcai at gmail.com (Peter Cai)
Date: Wed, 20 Aug 2008 09:05:59 +0800
Subject: [Twisted-Python] Abouth threads in twisted.
In-Reply-To: <1219161536.5308.209.camel@localhost.localdomain>
References: <befee6d80808190508n7b0541c9ga2857cdbbf3b6e5a@mail.gmail.com>
	<1219161536.5308.209.camel@localhost.localdomain>
Message-ID: <befee6d80808191805x3647f523jd51388a15b506f6b@mail.gmail.com>

Thanks for your reply!  But I think I have to read some source code
 of twisted to make sure what was happening behind callFromThread.

On Tue, Aug 19, 2008 at 11:58 PM, Itamar Shtull-Trauring <
itamar at itamarst.org> wrote:

> On Tue, 2008-08-19 at 20:08 +0800, Peter Cai wrote:
> > Hi All,
> >
> > QUESTION 1 : callFromThread
> > ~~~~~~~~~~~~~~~~~~~~~~~~~~~
> >
> > I found this code snippet in twisted manual book.
> > But I don't quite get it.
> >
> > What does "run 'notThreadSafe(3)' in the event loop" means?
> >
> > Does the reactor promise that all those "notThreadSafe" functions
> > be called one by one so they won't interfere each other?
>
> They will be called in main thread, the one where you did reactor.run()
>
> > QUESTION 2 : Integrated with a threaded 3rd party library.
> > ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > I have a C library which using a work threaded pool model.  It's
> > interface is like this.
> >
> >     void runWorkAsyn(int args, void pcallbackfunc(int));
> >
> > When runWorkAsyn is called, it dispatch work to a thread in its
> > own thread pool and call 'pcallbackfunc' in that thread when it's
> > done.
> >
> > I really got confused by how use this lib from twisted in a thread
> > safe way.
> > If I use a python callback function as pcallbackfunc and touch the
> > reactor from it,
> > it might damage the event look as most twisted APIs are not thread
> > safe.
>
> Rather than passing in callable "doSomething" as callback, pass in:
> "lambda *args: reactor.callFromThread(doSomething, *args)".
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080820/d806ef5c/attachment.html>

From elicriffield at gmail.com  Wed Aug 20 20:13:24 2008
From: elicriffield at gmail.com (Eli Criffield)
Date: Wed, 20 Aug 2008 21:13:24 -0500
Subject: [Twisted-Python] twisted python conch SSH shell?
In-Reply-To: <74a0fd5f0808121340pdf0e46egd4dfb9b1c10cbaf4@mail.gmail.com>
References: <74a0fd5f0808121340pdf0e46egd4dfb9b1c10cbaf4@mail.gmail.com>
Message-ID: <18e3f33d0808201913l17fce5d4i3cf29e3bfb8802b4@mail.gmail.com>

check out

http://twistedmatrix.com/pipermail/twisted-python/2007-July/015793.html

Eli Criffield

On Tue, Aug 12, 2008 at 3:40 PM, Bill Zeller <wzeller at cs.princeton.edu> wrote:
> Hi,
>
> I've been playing around with Twisted's Conch client (which looks extremely
> well done, thanks!). I've been able to connect to a conch server and also
> connect to other ssh servers and execuate various commands. I'd like to be
> able to connect to an arbitrary SSH server and run /bin/bash.
>
> I'm able to execute a command like so:
>
> ---------------------
> class CommandChannel(channel.SSHChannel):
>     ....
>     def channelOpen(self, data):
>         self.conn.sendRequest(
>             self, 'exec', common.NS(self.command),
> wantReply=True).addCallback(
>             self._gotResponse)
> ---------------------
>
> Looking through the SSH spec (connect protocol, rfc4254), it looks like
> shells are opened with this command.
>
> ---------------------
>
>       byte      SSH_MSG_CHANNEL_REQUEST
>
>       uint32    recipient channel
>       string    "shell"
>       boolean   want reply
>
> ---------------------
>
> It doesn't look like Conch supports these requests (here's how
> CHANNEL_REQUESTs are currently sent out)
>
> ---------------------
> (Twisted-8.1.0)
> twisted/conch/ssh/connection.py (413):
>         self.transport.sendPacket(MSG_CHANNEL_REQUEST, struct.pack('>L',
>                                     self.channelsToRemoteChannel[channel])
>                                   + common.NS(requestType)+chr(wantReply)
>                                   + data)
> ---------------------
>
> I may be misunderstanding how remote shells are started, so any help would
> be appreciated.
>
> Again, I'm trying to launch an interactive /bin/bash shell from a Conch SSH
> client on an arbitrary remote SSH server.
>
> Thanks for your time.
>
> Best Regards,
> Bill Zeller
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



From arne-weiss at web.de  Thu Aug 21 04:31:23 2008
From: arne-weiss at web.de (arne-weiss at web.de)
Date: Thu, 21 Aug 2008 12:31:23 +0200
Subject: [Twisted-Python] dont get ssl Server working
Message-ID: <945267974@web.de>

I tried to use ssl via twisted and I don't know why it doesn't work. If a client tries to connect ConnectionLost says:
[('SSL routines', 'SSL3_READ_BYTES', 'sslv3 alert bad certificate'), ('SSL routines', 'SSL3_READ_BYTES', 'ssl handshake failure')]

I tried different CAs, so there schould be no failure.
Do I have to do something else like SSL.Context(method).set_accept_state() manually?

My Code in basic looks like the following:
http://nopaste.info/8bd9bd8536.html

# class TLSProtocol(protocol.Protocol,  ssl.Server):
#  
#     def connectionLost(self, reason):
#         print "Connection Lost:"
#         print reason.getErrorMessage()
#  
#     def dataReceived(self, data):
#         print "Data Received: %s"%data
#  
#  
#  
# class Factory(protocol.ServerFactory):
#     protocol = TLSProtocol
#  
#     def buildProtocol(self,  addr):
#         p = self.protocol()
#         return p
#    
#     def clientConnectionLost(self, transport, reason):
#         print "Connection Lost: %s"%reason.getErrorMessage()
#         reactor.stop( )
#        
#     def clientConnectionFailed(self, transport, reason):
#         print "connection Failed: %s"%reason.getErrorMessage( )
#         reactor.stop( )
#  
#  
#  
# class ContextFactory(ssl.ContextFactory):
#  
#     def __init__(self):
#         sslmethod = SSL.TLSv1_METHOD
#  
#         ctx = SSL.Context(sslmethod)
#         ctx.use_certificate_file('ssl.crt')
#         ctx.use_privatekey_file('ssl.key')
#        
#         self._context = ctx
#  
#     def getContext(self):
#         "Create an SSL context"
#  
#         return self._context
#  
#  
#  
# reactor.listenSSL(8601,  Factory(), ContextFactory())
# reactor.run() 
_______________________________________________________________________
EINE FR ALLE: die kostenlose WEB.DE-Plattform fr Freunde und Deine
Homepage mit eigenem Namen. Jetzt starten! http://unddu.de/?kid=kid at mf2




From fhauck at srcpsolutions.com  Thu Aug 21 04:37:32 2008
From: fhauck at srcpsolutions.com (fhauck at srcpsolutions.com)
Date: Thu, 21 Aug 2008 05:37:32 -0500
Subject: [Twisted-Python] dont get ssl Server working
Message-ID: <MDAEMON2779200808210537.AA3732828@srcpsolutions.com>

I will be out of the office from 08/15/2008 to
08/25/2008

If this is urgent please contact rgrizzaffi at srcpsolutions.com





From leszczynscy at yahoo.com  Thu Aug 21 04:38:56 2008
From: leszczynscy at yahoo.com (leszczynscy at yahoo.com)
Date: Thu, 21 Aug 2008 03:38:56 -0700 (PDT)
Subject: [Twisted-Python] Yahoo! Auto Response
Message-ID: <949009.41922.qm@web54501.mail.re2.yahoo.com>

Ten adres bedzie sprawdzany do konca lutego 2008. Prosze uzywac mojego nowego adresu. This e-mail will be in use until end of February 2008. Please use my new one instead.

andy.leszczynski
gmail
com



From rajainnov at gmail.com  Thu Aug 21 05:05:55 2008
From: rajainnov at gmail.com (raja pavankumar)
Date: Thu, 21 Aug 2008 16:35:55 +0530
Subject: [Twisted-Python] dont get ssl Server working
In-Reply-To: <MDAEMON2779200808210537.AA3732828@srcpsolutions.com>
References: <MDAEMON2779200808210537.AA3732828@srcpsolutions.com>
Message-ID: <500fd1b0808210405m1357a3dftea469ff1e888bffc@mail.gmail.com>

AS part of my buildbot setup, I am executing a shell command in the slave
environment. (This has been coded as part of the master.cfg file)

This command is failing
f1.addStep(shell.ShellCommand, description= "chdir", command= ['cd',
'./tempGitBranch'])

******* Log Says *************

Upon execvpe cd ['cd', './tempGitBranch'] in environment id -1214057092:
Traceback (most recent call last):
  File "/usr/lib/python2.4/site-packages/twisted/internet/process.py",
line 772, in __init__
    os.execvpe(command, args, environment)
  File "/usr/lib/python2.4/os.py", line 350, in execvpe
    _execvpe(file, args, env)
  File "/usr/lib/python2.4/os.py", line 379, in _execvpe
    func(fullname, *argrest)
OSError: [Errno 2] No such file or directory

**************** Log End *************


This command is succeeding (means that directory is present in the
environment)

f1.addStep(shell.ShellCommand, description= "list", command= ['ls', '-al',
'tempGitBranch'])



On 8/21/08, fhauck at srcpsolutions.com <fhauck at srcpsolutions.com> wrote:
>
> I will be out of the office from 08/15/2008 to
> 08/25/2008
>
> If this is urgent please contact rgrizzaffi at srcpsolutions.com
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080821/2f7ab185/attachment.html>

From itamar at itamarst.org  Thu Aug 21 07:03:38 2008
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 21 Aug 2008 13:03:38 +0000
Subject: [Twisted-Python] dont get ssl Server working
In-Reply-To: <945267974@web.de>
References: <945267974@web.de>
Message-ID: <1219323818.5308.210.camel@localhost.localdomain>

On Thu, 2008-08-21 at 12:31 +0200, arne-weiss at web.de wrote:
> I tried to use ssl via twisted and I don't know why it doesn't work. If a client tries to connect ConnectionLost says:
> [('SSL routines', 'SSL3_READ_BYTES', 'sslv3 alert bad certificate'), ('SSL routines', 'SSL3_READ_BYTES', 'ssl handshake failure')]
> 
> I tried different CAs, so there schould be no failure.
> Do I have to do something else like SSL.Context(method).set_accept_state() manually?
> 
> My Code in basic looks like the following:
> http://nopaste.info/8bd9bd8536.html
> 
> # class TLSProtocol(protocol.Protocol,  ssl.Server):

Don't inherit your class from ssl.Server, for starters.




From carlo.riva at gmail.com  Thu Aug 21 07:47:49 2008
From: carlo.riva at gmail.com (John Doe)
Date: Thu, 21 Aug 2008 15:47:49 +0200
Subject: [Twisted-Python] Multithreaded UDP server in Twisted?
Message-ID: <1db3ad0a0808210647i1e792b8bjeb2b32e8486c052f@mail.gmail.com>

Hi everyone,

I am trying to implement a multithreaded UDP server in Twisted:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import threads, reactor
from twisted.python import threadable
threadable.init(1)

reactor.suggestThreadPoolSize(32)

class EchoUDP(DatagramProtocol):

   def echoDatagram (self, datagram):
       print datagram

   def datagramReceived(self, datagram, address):
       self.transport.write(datagram, address)
       reactor.callInThread(self.echoDatagram(datagram))

def main():
   reactor.listenUDP(8000, EchoUDP())
   reactor.run()

if __name__ == '__main__':
   main()
although it is working it gives me following error:

Traceback (most recent call last):
 File "C:\Python25\lib\threading.py", line 460, in __bootstrap
   self.run()
 File "C:\Python25\lib\threading.py", line 440, in run
   self.__target(*self.__args, **self.__kwargs)
--- <exception caught here> ---
 File "C:\Python25\lib\site-packages\twisted\python\threadpool.py",
line 148, in _worker
   context.call(ctx, function, *args, **kwargs)
 File "C:\Python25\lib\site-packages\twisted\python\context.py", line
59, in callWithContext
   return self.currentContext().callWithContext(ctx, func, *args, **kw)
 File "C:\Python25\lib\site-packages\twisted\python\context.py", line
37, in callWithContext
   return func(*args,**kw)
exceptions.TypeError: 'NoneType' object is not callable

Does anybody know what is wrong?

Any help is *greatly* appreciated! ;)

Thanks in advance!

Cheers
Carlo



From elicriffield at gmail.com  Thu Aug 21 07:58:08 2008
From: elicriffield at gmail.com (Eli Criffield)
Date: Thu, 21 Aug 2008 08:58:08 -0500
Subject: [Twisted-Python] twisted python conch SSH shell?
In-Reply-To: <9263743c0808210007s1cdbda07s62ef698efe7c057f@mail.gmail.com>
References: <74a0fd5f0808121340pdf0e46egd4dfb9b1c10cbaf4@mail.gmail.com>
	<18e3f33d0808201913l17fce5d4i3cf29e3bfb8802b4@mail.gmail.com>
	<9263743c0808210007s1cdbda07s62ef698efe7c057f@mail.gmail.com>
Message-ID: <18e3f33d0808210658h541f6318n66aa9555ad30df9a@mail.gmail.com>

conchClient.py is libarary. Running it from the command line was an
afterthought just for testing.
To run multiple commands in the same session you just give sshCmds a
list of commands to run and it will return the output of all of them.
Here is an example script that creates a function to up a port and
another to return the wwn (this is from a SAN switch) of a port.

#!/usr/bin/env python
# Eli Criffield

__version__ = 0.1186070837
__author__ = 'Eli Criffield <python AT zendo.net>'

import sys
import re
import time
import os
from conchClient import sshCmds

dryRun = False
Confirm = True
echo = False

class reError(Exception):
    pass

def execList(switch,cmds,change=False):
    global echo, dryRun, Confirm
    # if change is False, the commands arn't suppose to do any damage
    # always exec them, they need the info
    if not change:
        return sshCmds(switch,cmds,echo=echo)

    if dryRun:
        print 'DRY RUN'
        print 'ssh %s'%switch
        for cmd in cmds:
            print cmd
        print 'ENTER to continue:',
        sys.stdin.readline()
        return ('dryrun','')


    if Confirm:
        print "I'm going to run:"
        print '\nssh %s'%switch
        for cmd in cmds:
            print cmd
        ans = raw_input('Does that look ok (yes/no)? ')
        while ans.lower() not in ('yes', 'no'):
            ans = raw_input("Please type 'yes' or 'no': ")
        if ans == 'no':
            print 'exiting out'
            sys.exit(1)
        else:
            return sshCmds(switch,cmds,echo=echo)

    # No dryRun or Confirm just execute it
    return sshCmds(switch,cmds,echo=echo)

def upPort(switch,port):
    cmds=[ 'config term', 'interface fc%s'%port, 'no shutdown' ,'end'
    ,'exit' ]
    execList(switch,cmds,change=True)

def wwnFromPort(switch,port):
    portre = re.compile(r'%s '%port)
    linere = re.compile(r'(\S*)\s*(\S*)\s*(\S*)\s*(\S*)\s*(\S*)')
    (out,err) = execList(switch,['show flogi database'])
    for line in out.split('fc'):
        if portre.match(line):
            #print 'line:',line #DEBUG
            wwn = linere.match(line).groups()[3]
            #print wwn #DEBUG
            return wwn


On Thu, Aug 21, 2008 at 2:07 AM, The Noob <thenoob06 at gmail.com> wrote:
> Hello,
>
> If I understand your code, you can't find a way to run a real shell on Cisco
> ?
> For example if I connect to a router, I send a "sh log" , " conf t "
> commands but I do not know them before. With the actual script:
> conchClient.py 192.168.0.254 sh log
> The script disconnects us from the router
> conchClient.py 192.168.0.254 conf t
> The script disconnects us  disconnect from the router
> I think the problem with your script it is for each command you are
> disconnected The best will be to find a solution to do this:
> conchClient.py 192.168.0.254 sh log
> conchClient.py 192.168.0.254 conf t
> conchClient.py 192.168.0.254 exit
> disconnect from server
>
> I try to do this with a custom ssh server which permits to connect to others
> ssh servers and have a shell. But I don't know how to communicate between my
> custom ssh server and my child ( an expect script which launch ssh root at host
> and permits to have a real shell)
>
>
> Best Regards
> TheNoob06
>
>
> 2008/8/21 Eli Criffield <elicriffield at gmail.com>
>>
>> check out
>>
>> http://twistedmatrix.com/pipermail/twisted-python/2007-July/015793.html
>>
>> Eli Criffield
>>
>> On Tue, Aug 12, 2008 at 3:40 PM, Bill Zeller <wzeller at cs.princeton.edu>
>> wrote:
>> > Hi,
>> >
>> > I've been playing around with Twisted's Conch client (which looks
>> > extremely
>> > well done, thanks!). I've been able to connect to a conch server and
>> > also
>> > connect to other ssh servers and execuate various commands. I'd like to
>> > be
>> > able to connect to an arbitrary SSH server and run /bin/bash.
>> >
>> > I'm able to execute a command like so:
>> >
>> > ---------------------
>> > class CommandChannel(channel.SSHChannel):
>> >     ....
>> >     def channelOpen(self, data):
>> >         self.conn.sendRequest(
>> >             self, 'exec', common.NS(self.command),
>> > wantReply=True).addCallback(
>> >             self._gotResponse)
>> > ---------------------
>> >
>> > Looking through the SSH spec (connect protocol, rfc4254), it looks like
>> > shells are opened with this command.
>> >
>> > ---------------------
>> >
>> >       byte      SSH_MSG_CHANNEL_REQUEST
>> >
>> >       uint32    recipient channel
>> >       string    "shell"
>> >       boolean   want reply
>> >
>> > ---------------------
>> >
>> > It doesn't look like Conch supports these requests (here's how
>> > CHANNEL_REQUESTs are currently sent out)
>> >
>> > ---------------------
>> > (Twisted-8.1.0)
>> > twisted/conch/ssh/connection.py (413):
>> >         self.transport.sendPacket(MSG_CHANNEL_REQUEST, struct.pack('>L',
>> >
>> > self.channelsToRemoteChannel[channel])
>> >                                   +
>> > common.NS(requestType)+chr(wantReply)
>> >                                   + data)
>> > ---------------------
>> >
>> > I may be misunderstanding how remote shells are started, so any help
>> > would
>> > be appreciated.
>> >
>> > Again, I'm trying to launch an interactive /bin/bash shell from a Conch
>> > SSH
>> > client on an arbitrary remote SSH server.
>> >
>> > Thanks for your time.
>> >
>> > Best Regards,
>> > Bill Zeller
>> >
>> > _______________________________________________
>> > Twisted-Python mailing list
>> > Twisted-Python at twistedmatrix.com
>> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>> >
>> >
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



From exarkun at divmod.com  Thu Aug 21 08:12:17 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 21 Aug 2008 10:12:17 -0400
Subject: [Twisted-Python] Multithreaded UDP server in Twisted?
In-Reply-To: <1db3ad0a0808210647i1e792b8bjeb2b32e8486c052f@mail.gmail.com>
Message-ID: <20080821141217.29191.319572987.divmod.quotient.16987@ohm>

On Thu, 21 Aug 2008 15:47:49 +0200, John Doe <carlo.riva at gmail.com> wrote:
> [snip]
>       reactor.callInThread(self.echoDatagram(datagram))

Try reactor.callInThread(self.echoDatagram, datagram)

Jean-Paul



From screwtape at froup.com  Thu Aug 21 18:57:34 2008
From: screwtape at froup.com (Tim Allen)
Date: Fri, 22 Aug 2008 10:57:34 +1000
Subject: [Twisted-Python] dont get ssl Server working
In-Reply-To: <500fd1b0808210405m1357a3dftea469ff1e888bffc@mail.gmail.com>
References: <MDAEMON2779200808210537.AA3732828@srcpsolutions.com>
	<500fd1b0808210405m1357a3dftea469ff1e888bffc@mail.gmail.com>
Message-ID: <20080822005734.GF2478@thristian.org>

On Thu, Aug 21, 2008 at 04:35:55PM +0530, raja pavankumar wrote:
> AS part of my buildbot setup, I am executing a shell command in the slave
> environment. (This has been coded as part of the master.cfg file)
> 
> This command is failing
> f1.addStep(shell.ShellCommand, description= "chdir", command= ['cd',
> './tempGitBranch'])

"cd" isn't a command that can be run - there's no /bin/cd or /usr/bin/cd
binary that you could call. It's a shell built-in, which means it's
available for shell-scripts to use, and it's available when you're using
the shell interactively, but that's it.

You're probably looking for os.chdir("./tempGitBranch")



From gabriel.rossetti at arimaz.com  Fri Aug 22 03:42:08 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 22 Aug 2008 11:42:08 +0200
Subject: [Twisted-Python] wxPython + Twisted = signals no longer caught
Message-ID: <48AE89F0.10004@arimaz.com>

Hello everyone,

I am writing a (Twisted) program that intercepts some signals using , 
such as Ctrl+C, and stops the reactor. I have a base class that sets-up 
signal handlers and it works great. The handlers are in my base factory 
class (we'll call it MyBaseFactory). Here's the code in the 
MyBaseFactory's __init__() :

    def __init__(self, proto, *args, **kwargs):
        self.protocol = proto
       
        if signal.getsignal(signal.SIGINT) == signal.default_int_handler:
            # only handle if there isn't already a handler, e.g. for Pdb.
            signal.signal(signal.SIGINT, self._sigHandler)
        signal.signal(signal.SIGTERM, self._sigHandler)
       
        # Catch Ctrl-Break in windows
        if hasattr(signal, "SIGBREAK"):
            signal.signal(signal.SIGBREAK, self._sigHandler)

    def _sigHandler(self, signum, frame):
        if(signum == signal.SIGINT or signal.SIGTERM):
            reactor.callLater(0, reactor.stop)
        # Catch Ctrl-Break in windows
        elif hasattr(signal, "SIGBREAK") and signum == signal.SIGBREAK:
            reactor.callLater(0, reactor.stop)


I've recently had to integrate wxPython in parts of my application and 
I've inherited from MyBaseFactory and wx.App. When the Gui starts, it 
creates a wx.Dialog descendant/child that creates a wx.TaskBarIcon. I 
use the wxPython integration reactor code. Also, I have tried using 
wx.Frame instead of wx.Dialog but it doesn't change anything.

The interface works great, I can use twisted, I get and receive msgs, 
etc, but when I'm in the terminal were the program was run from, and I 
send SIGINT (Ctrl+C) nothing happens. Does anyone know why wxPython or 
Twisted eats my Ctrl+C in the terminal? This code (MyBaseFactory) works 
without the wxPython (I've been using it for several months).

Thank you,
Gabriel

PS I've also posted before to the wxPython mailing list without 
mentioning the twisted part, but apparently pure wxPython does not do 
this. I've also tested it (removed all the twisted stuff) and it does 
close when a SIGINT is sent.



From grimsqueaker13 at gmail.com  Fri Aug 22 08:05:37 2008
From: grimsqueaker13 at gmail.com (Daniel Browne)
Date: Fri, 22 Aug 2008 16:05:37 +0200
Subject: [Twisted-Python] twisted.web session expiry
Message-ID: <48AEC7B1.3040307@gmail.com>

I need someone to help me with twisted.web.

How can I do something (eg. redirect) once a users session has expired? 
At the point when the session expires your request is finished and your 
session is expired. I have added the notification callback but I can't 
really do anything inside it without a session to store information in 
or a request to redirect with, so I just print a message to the console.

Can anyone help me understand what I'm doing wrong here?

Thanks
Daniel Browne



From flashbuster at gmail.com  Fri Aug 22 09:30:17 2008
From: flashbuster at gmail.com (Sebastian Schulze)
Date: Fri, 22 Aug 2008 17:30:17 +0200
Subject: [Twisted-Python] twisted.web session expiry
In-Reply-To: <48AEC7B1.3040307@gmail.com>
References: <48AEC7B1.3040307@gmail.com>
Message-ID: <c2959a420808220830o6b6bea25kb5e6ab7363a5a770@mail.gmail.com>

I don't see how this would work, as HTTP is a stateless protocol.
Should by possible with AJAX, though (so, athena.livepage may be your
friend).

2008/8/22 Daniel Browne <grimsqueaker13 at gmail.com>

> I need someone to help me with twisted.web.
>
> How can I do something (eg. redirect) once a users session has expired? At
> the point when the session expires your request is finished and your session
> is expired. I have added the notification callback but I can't really do
> anything inside it without a session to store information in or a request to
> redirect with, so I just print a message to the console.
>
> Can anyone help me understand what I'm doing wrong here?
>
> Thanks
> Daniel Browne
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080822/1486d0f0/attachment.html>

From phil at bubblehouse.org  Fri Aug 22 09:43:50 2008
From: phil at bubblehouse.org (Phil Christensen)
Date: Fri, 22 Aug 2008 11:43:50 -0400
Subject: [Twisted-Python] twisted.web session expiry
In-Reply-To: <48AEC7B1.3040307@gmail.com>
References: <48AEC7B1.3040307@gmail.com>
Message-ID: <E9A68D39-6832-42E6-B28B-C6EADB06AD95@bubblehouse.org>

On Aug 22, 2008, at 10:05 AM, Daniel Browne wrote:
> I need someone to help me with twisted.web.
>
> How can I do something (eg. redirect) once a users session has  
> expired? At the point when the session expires your request is  
> finished and your session is expired. I have added the notification  
> callback but I can't really do anything inside it without a session  
> to store information in or a request to redirect with, so I just  
> print a message to the console.
>
> Can anyone help me understand what I'm doing wrong here?

I can see where that would be a bit tricky.

The best idea I can think of is to have your top-level Resource check  
the session state in the locateChild method. If the session has  
expired, you can return a special Resource that simply redirects  
immediately.

-phil



From joaquin.keller at gmail.com  Fri Aug 22 10:35:08 2008
From: joaquin.keller at gmail.com (Joaquin Keller)
Date: Fri, 22 Aug 2008 18:35:08 +0200
Subject: [Twisted-Python] twisted.words.msn broken ?
Message-ID: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>

Hi all,
when running msn_example.py
I get this:

2008/08/22 17:29 +0200 [-] Log opened.
2008/08/22 17:29 +0200 [-] Starting factory
<twisted.internet.protocol.ClientFactory instance at 0x83d552c>
2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
(Invalid version response)
2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
<twisted.internet.protocol.ClientFactory instance at 0x83d552c>

1 or 2 months ago, it was working perfectly fine.

I suspect that something has changed on messenger.hotmail.com side

bonus: this two-week old bug (closed now) seems to be related and
claims to have a solution:
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908

     [...] their response to the CVR command has changed [...]

Hopefully, it might be only that...
Thanks,
-- Joaquin



From exarkun at divmod.com  Fri Aug 22 10:42:04 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Fri, 22 Aug 2008 12:42:04 -0400
Subject: [Twisted-Python] twisted.words.msn broken ?
In-Reply-To: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>
Message-ID: <20080822164204.29191.1890646986.divmod.quotient.17410@ohm>

On Fri, 22 Aug 2008 18:35:08 +0200, Joaquin Keller <joaquin.keller at gmail.com> wrote:
>Hi all,
>when running msn_example.py
>I get this:
>
>2008/08/22 17:29 +0200 [-] Log opened.
>2008/08/22 17:29 +0200 [-] Starting factory
><twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
>(Invalid version response)
>2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
><twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>
>1 or 2 months ago, it was working perfectly fine.
>
>I suspect that something has changed on messenger.hotmail.com side
>
>bonus: this two-week old bug (closed now) seems to be related and
>claims to have a solution:
>http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908
>
>     [...] their response to the CVR command has changed [...]
>

Can you file a ticket in our issue tracker for this?

Jean-Paul



From db3l.net at gmail.com  Fri Aug 22 14:08:50 2008
From: db3l.net at gmail.com (David Bolen)
Date: Fri, 22 Aug 2008 16:08:50 -0400
Subject: [Twisted-Python] Re: twisted.web session expiry
References: <48AEC7B1.3040307@gmail.com>
Message-ID: <87myj4izhp.fsf@valheru.db3l.homeip.net>

Daniel Browne <grimsqueaker13 at gmail.com> writes:

> How can I do something (eg. redirect) once a users session has
> expired? At the point when the session expires your request is
> finished and your session is expired. I have added the notification
> callback but I can't really do anything inside it without a session to
> store information in or a request to redirect with, so I just print a
> message to the console.

If you're trying to cause something to happen on the user's browser
when their session expires, as others have pointed out default HTTP is
stateless, so without something (like a bit of Javascript) running in
the user's browser staying in contact with your server behind the
scenes you won't be able to trigger any behavior on their end.

A user is likely to be already familiar with how most sites that have
active sessions won't tell them that their session is expired until
they initiate a subsequent request to the server (refresh a page, try
to click on a link, etc...).  Barring unique requirements for your
application, simply behaving that way - check the session for possible
expiration upon any subsequent request from that user and issue the
redirect then if expired - should be a fairly common behavior.


If you want to have something on the server end occur when the session
expires (say to update some internal state, or adjust or clear the
session information), then you can just establish a standard Twisted
callLater callback (which could itself be stored in the session and
reset when requests did come in), or if you may have lots of sessions,
have a separate server side object with a single periodic timer take
care of expiring sessions.  Or any other server side event that occurs
could be used to initiate session expiration processing.

-- David




From joaquin.keller at gmail.com  Fri Aug 22 14:28:30 2008
From: joaquin.keller at gmail.com (Joaquin Keller)
Date: Fri, 22 Aug 2008 22:28:30 +0200
Subject: [Twisted-Python] twisted.words.msn broken ?
In-Reply-To: <20080822164204.29191.1890646986.divmod.quotient.17410@ohm>
References: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>
	<20080822164204.29191.1890646986.divmod.quotient.17410@ohm>
Message-ID: <ede9ca810808221328l6bc08adeyd6852e725689b50f@mail.gmail.com>

done.
maybe is worth moving it to a higher priority since now the whole msn
code is useless while the fix seems not too hard.
-- Joaquin

most people ignore it but imvho twisted is the best network framework.
ever. impressive. thanks.


On Fri, Aug 22, 2008 at 6:42 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Fri, 22 Aug 2008 18:35:08 +0200, Joaquin Keller
> <joaquin.keller at gmail.com> wrote:
>>
>> Hi all,
>> when running msn_example.py
>> I get this:
>>
>> 2008/08/22 17:29 +0200 [-] Log opened.
>> 2008/08/22 17:29 +0200 [-] Starting factory
>> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>> 2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
>> (Invalid version response)
>> 2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
>> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>>
>> 1 or 2 months ago, it was working perfectly fine.
>>
>> I suspect that something has changed on messenger.hotmail.com side
>>
>> bonus: this two-week old bug (closed now) seems to be related and
>> claims to have a solution:
>> http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908
>>
>>    [...] their response to the CVR command has changed [...]
>>
>
> Can you file a ticket in our issue tracker for this?
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From adelagon at gmail.com  Sat Aug 23 05:48:26 2008
From: adelagon at gmail.com (Alvin Delagon)
Date: Sat, 23 Aug 2008 19:48:26 +0800
Subject: [Twisted-Python] twisted.words.msn broken ?
In-Reply-To: <ede9ca810808221328l6bc08adeyd6852e725689b50f@mail.gmail.com>
References: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>
	<20080822164204.29191.1890646986.divmod.quotient.17410@ohm>
	<ede9ca810808221328l6bc08adeyd6852e725689b50f@mail.gmail.com>
Message-ID: <7a01f6c00808230448x6ba13d5bqa89eaedf0c56b092@mail.gmail.com>

Guys,

MSNP8 has been deprecated at some point in time last July. And the MSN
dispatch server's response to a CVR has been changed causing this
loseConnection in the handle_VER to be called:

def handle_VER(self, params):
        versions = params[1:]
        if versions is None or ' '.join(versions) != MSNP_VER:
            self.transport.loseConnection()
        self.sendCommand('CVR %s %s %s' % (self.nextTID(), MSN_CVR_STR,
self.factory.userHandle))

twisted.words.msn has been written to close the session if the versions
doesn't match. This can be easily fixed correcting MSNP_VER variable
somewhere in the  twisted code (remove MSNP8 the current twisted 8.1 still
works with MSNP9).

I could submit a patch on wednesday after I go back from vacation. :)

Cheers,
Alvin Delagon

On Sat, Aug 23, 2008 at 4:28 AM, Joaquin Keller <joaquin.keller at gmail.com>wrote:

> done.
> maybe is worth moving it to a higher priority since now the whole msn
> code is useless while the fix seems not too hard.
> -- Joaquin
>
> most people ignore it but imvho twisted is the best network framework.
> ever. impressive. thanks.
>
>
> On Fri, Aug 22, 2008 at 6:42 PM, Jean-Paul Calderone <exarkun at divmod.com>
> wrote:
> > On Fri, 22 Aug 2008 18:35:08 +0200, Joaquin Keller
> > <joaquin.keller at gmail.com> wrote:
> >>
> >> Hi all,
> >> when running msn_example.py
> >> I get this:
> >>
> >> 2008/08/22 17:29 +0200 [-] Log opened.
> >> 2008/08/22 17:29 +0200 [-] Starting factory
> >> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
> >> 2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
> >> (Invalid version response)
> >> 2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
> >> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
> >>
> >> 1 or 2 months ago, it was working perfectly fine.
> >>
> >> I suspect that something has changed on messenger.hotmail.com side
> >>
> >> bonus: this two-week old bug (closed now) seems to be related and
> >> claims to have a solution:
> >> http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908
> >>
> >>    [...] their response to the CVR command has changed [...]
> >>
> >
> > Can you file a ticket in our issue tracker for this?
> >
> > Jean-Paul
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
http://www.alvinatorsplayground.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080823/aace5138/attachment.html>

From adelagon at gmail.com  Sat Aug 23 06:10:24 2008
From: adelagon at gmail.com (Alvin Delagon)
Date: Sat, 23 Aug 2008 20:10:24 +0800
Subject: [Twisted-Python] twisted.words.msn broken ?
In-Reply-To: <7a01f6c00808230448x6ba13d5bqa89eaedf0c56b092@mail.gmail.com>
References: <ede9ca810808220935y2328d1e5t660cfb89ba96849c@mail.gmail.com>
	<20080822164204.29191.1890646986.divmod.quotient.17410@ohm>
	<ede9ca810808221328l6bc08adeyd6852e725689b50f@mail.gmail.com>
	<7a01f6c00808230448x6ba13d5bqa89eaedf0c56b092@mail.gmail.com>
Message-ID: <7a01f6c00808230510p1d184c15jd72d2e6d3bb3412a@mail.gmail.com>

My bad, sorry for not reading the last email. :)

Alvin Delagon

On Sat, Aug 23, 2008 at 7:48 PM, Alvin Delagon <adelagon at gmail.com> wrote:

> Guys,
>
> MSNP8 has been deprecated at some point in time last July. And the MSN
> dispatch server's response to a CVR has been changed causing this
> loseConnection in the handle_VER to be called:
>
> def handle_VER(self, params):
>         versions = params[1:]
>         if versions is None or ' '.join(versions) != MSNP_VER:
>             self.transport.loseConnection()
>         self.sendCommand('CVR %s %s %s' % (self.nextTID(), MSN_CVR_STR,
> self.factory.userHandle))
>
> twisted.words.msn has been written to close the session if the versions
> doesn't match. This can be easily fixed correcting MSNP_VER variable
> somewhere in the  twisted code (remove MSNP8 the current twisted 8.1 still
> works with MSNP9).
>
> I could submit a patch on wednesday after I go back from vacation. :)
>
> Cheers,
> Alvin Delagon
>
>
> On Sat, Aug 23, 2008 at 4:28 AM, Joaquin Keller <joaquin.keller at gmail.com>wrote:
>
>> done.
>> maybe is worth moving it to a higher priority since now the whole msn
>> code is useless while the fix seems not too hard.
>> -- Joaquin
>>
>> most people ignore it but imvho twisted is the best network framework.
>> ever. impressive. thanks.
>>
>>
>> On Fri, Aug 22, 2008 at 6:42 PM, Jean-Paul Calderone <exarkun at divmod.com>
>> wrote:
>> > On Fri, 22 Aug 2008 18:35:08 +0200, Joaquin Keller
>> > <joaquin.keller at gmail.com> wrote:
>> >>
>> >> Hi all,
>> >> when running msn_example.py
>> >> I get this:
>> >>
>> >> 2008/08/22 17:29 +0200 [-] Log opened.
>> >> 2008/08/22 17:29 +0200 [-] Starting factory
>> >> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>> >> 2008/08/22 17:29 +0200 [Dispatch,client] Error in line: VER 1 MSNP8
>> >> (Invalid version response)
>> >> 2008/08/22 17:29 +0200 [Dispatch,client] Stopping factory
>> >> <twisted.internet.protocol.ClientFactory instance at 0x83d552c>
>> >>
>> >> 1 or 2 months ago, it was working perfectly fine.
>> >>
>> >> I suspect that something has changed on messenger.hotmail.com side
>> >>
>> >> bonus: this two-week old bug (closed now) seems to be related and
>> >> claims to have a solution:
>> >> http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493908
>> >>
>> >>    [...] their response to the CVR command has changed [...]
>> >>
>> >
>> > Can you file a ticket in our issue tracker for this?
>> >
>> > Jean-Paul
>> >
>> > _______________________________________________
>> > Twisted-Python mailing list
>> > Twisted-Python at twistedmatrix.com
>> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>> >
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
>
>
> --
> http://www.alvinatorsplayground.blogspot.com/
>



-- 
http://www.alvinatorsplayground.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080823/3e1a68bf/attachment.html>

From exarkun at twistedmatrix.com  Sat Aug 23 22:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 24 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1219550709.99.50672012@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080824/4c6435f6/attachment.html>

From ellisonbg.net at gmail.com  Sun Aug 24 00:25:01 2008
From: ellisonbg.net at gmail.com (Brian Granger)
Date: Sat, 23 Aug 2008 23:25:01 -0700
Subject: [Twisted-Python] "_wait" is blowing up?!
Message-ID: <6ce0ac130808232325p666a93cdl85c5cdc54a1a8328@mail.gmail.com>

File "/usr/lib/python2.5/site-packages/twisted/trial/unittest.py",
line 763, in run
   self._wait(d)
 File "/usr/lib/python2.5/site-packages/twisted/trial/unittest.py",
line 901, in _wait
   reactor.run()
 File "/usr/lib/python2.5/site-packages/twisted/internet/posixbase.py",
Hi,

We have a pretty big tests suite that uses trial to test all sorts of
twisted things.  We are pretty careful to do the right thing in our
tests and leave the reactor clean....but recently we began seeing a
transient really wierd bug when we run our test suite.

Some characteristics of the problem:

1.  The problem only appears sometimes - seems random
2.  The problem shows up in different test methods
3.  Sometimes it hangs the tests suite for a long time - eventually
twisted continues though

Here is the traceback we get.

line 220, in run
   self.mainLoop()
 File "/usr/lib/python2.5/site-packages/twisted/internet/posixbase.py",
line 228, in mainLoop
   self.runUntilCurrent()
--- <exception caught here> ---
 File "/usr/lib/python2.5/site-packages/twisted/internet/base.py",
line 533, in runUntilCurrent
   f(*a, **kw)
 File "/usr/lib/python2.5/site-packages/twisted/internet/defer.py",
line 261, in errback
   self._startRunCallbacks(fail)
 File "/usr/lib/python2.5/site-packages/twisted/internet/defer.py",
line 290, in _startRunCallbacks
   raise AlreadyCalledError
twisted.internet.defer.AlreadyCalledError:
ERROR

It appears that something is going on in the deadly _wait.  Any
thoughts on how we might fix this?

Thanks

Brian



From glyph at divmod.com  Sun Aug 24 02:08:03 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Sun, 24 Aug 2008 08:08:03 -0000
Subject: [Twisted-Python] "_wait" is blowing up?!
In-Reply-To: <6ce0ac130808232325p666a93cdl85c5cdc54a1a8328@mail.gmail.com>
References: <6ce0ac130808232325p666a93cdl85c5cdc54a1a8328@mail.gmail.com>
Message-ID: <20080824080803.25821.1654368831.divmod.xquotient.14873@joule.divmod.com>

Hi Brian,

On 06:25 am, ellisonbg.net at gmail.com wrote:
>Some characteristics of the problem:
>
>1.  The problem only appears sometimes - seems random
>2.  The problem shows up in different test methods
>3.  Sometimes it hangs the tests suite for a long time - eventually
>twisted continues though
>
>Here is the traceback we get.
(...)
>It appears that something is going on in the deadly _wait.  Any
>thoughts on how we might fix this?

I realize that this problem is difficult to track down, but I'm not sure 
what to tell you without more specific information about how your code 
is interacting with trial.

Is your code available somewhere?

Do you reliably see this error eventually if you use trial --until- 
failure?

Exactly what version of Twisted are you using?

What reactor do you typically run your tests under?

Not sure that I'd be able to tell you what's going on even with an 
answer to all of these questions, but they'd be a start :).



From aldoogy at gmail.com  Mon Aug 25 10:43:27 2008
From: aldoogy at gmail.com (A)
Date: Mon, 25 Aug 2008 17:43:27 +0100
Subject: [Twisted-Python] a question about self.factory in pb.Broker
Message-ID: <48B2E12F.3040307@gmail.com>

I'm attempting to build a Twisted pb client in Actionscript.
or at least enough to act as the client in this example . .
http://twistedmatrix.com/projects/core/documentation/howto/pb-cred.html#auto18

I'm a bit stuck here . .

def _sendError(self, fail, requestID):
        """(internal) Send an error for a previously sent message.
        """
        if isinstance(fail, failure.Failure):
            # If the failures value is jellyable or allowed through 
security,
            # send the value
            if (isinstance(fail.value, Jellyable) or
                self.security.isClassAllowed(fail.value.__class__)):
                fail = fail.value
            elif not isinstance(fail, CopyableFailure):
                fail = failure2Copyable(fail, self.factory.unsafeTracebacks)
        if isinstance(fail, CopyableFailure):
            fail.unsafeTracebacks = self.factory.unsafeTracebacks
        self.sendCall("error", requestID, self.serialize(fail))


where should  self.factory be set ?
what is self.factory ? PbClientFactory ?



From exarkun at divmod.com  Mon Aug 25 11:14:43 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 25 Aug 2008 13:14:43 -0400
Subject: [Twisted-Python] a question about self.factory in pb.Broker
In-Reply-To: <48B2E12F.3040307@gmail.com>
Message-ID: <20080825171443.29191.1269873416.divmod.quotient.18389@ohm>

On Mon, 25 Aug 2008 17:43:27 +0100, A <aldoogy at gmail.com> wrote:
>I'm attempting to build a Twisted pb client in Actionscript.
>or at least enough to act as the client in this example . .
>http://twistedmatrix.com/projects/core/documentation/howto/pb- 
>cred.html#auto18
>
>I'm a bit stuck here . .
>
> [snip]
>
>
>where should  self.factory be set ?
>what is self.factory ? PbClientFactory ?
>

See http://twistedmatrix.com/trac/browser/trunk/twisted/internet/protocol.py#L87

Jean-Paul




From aldoogy at gmail.com  Mon Aug 25 12:22:10 2008
From: aldoogy at gmail.com (A)
Date: Mon, 25 Aug 2008 19:22:10 +0100
Subject: [Twisted-Python] a question about self.factory in pb.Broker
In-Reply-To: <20080825171443.29191.1269873416.divmod.quotient.18389@ohm>
References: <20080825171443.29191.1269873416.divmod.quotient.18389@ohm>
Message-ID: <48B2F852.8020803@gmail.com>

Thanks,
so out of curiosity , does Factory.buildProtocol() get called after 
PBClientFactory.clientConnectionMade(self,broker) ?
http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/spread/pb.py#L1088

Is the broker parameter a reference to the class rather than an instance 
of Broker ?

A.




Jean-Paul Calderone wrote:
> On Mon, 25 Aug 2008 17:43:27 +0100, A <aldoogy at gmail.com> wrote:
>> I'm attempting to build a Twisted pb client in Actionscript.
>> or at least enough to act as the client in this example . .
>> http://twistedmatrix.com/projects/core/documentation/howto/pb- 
>> cred.html#auto18
>>
>> I'm a bit stuck here . .
>>
>> [snip]
>>
>>
>> where should  self.factory be set ?
>> what is self.factory ? PbClientFactory ?
>>
>
> See 
> http://twistedmatrix.com/trac/browser/trunk/twisted/internet/protocol.py#L87 
>
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>




From exarkun at divmod.com  Mon Aug 25 12:28:36 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 25 Aug 2008 14:28:36 -0400
Subject: [Twisted-Python] a question about self.factory in pb.Broker
In-Reply-To: <48B2F852.8020803@gmail.com>
Message-ID: <20080825182836.29191.995266651.divmod.quotient.18412@ohm>

On Mon, 25 Aug 2008 19:22:10 +0100, A <aldoogy at gmail.com> wrote:
>Thanks,
>so out of curiosity , does Factory.buildProtocol() get called after 
>PBClientFactory.clientConnectionMade(self,broker) ?
>http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.1.0/twisted/spread/pb.py#L1088

No, buildProtocol gets called first.

>
>Is the broker parameter a reference to the class rather than an instance of 
>Broker ?
>

The `broker parameter is an instance of `Broker.

Jean-Paul



From jml at mumak.net  Tue Aug 26 19:19:24 2008
From: jml at mumak.net (Jonathan Lange)
Date: Wed, 27 Aug 2008 11:19:24 +1000
Subject: [Twisted-Python] Use the Launchpad plugin on our trac? (was Fwd:
	Bugzilla and Trac Launchpad plugins: Request for beta testers)
Message-ID: <d06a5cd30808261819wdc57aa0t6256eb01136c8def@mail.gmail.com>

Hello all,

Launchpad has recently released a Trac plugin that lets Launchpad
synchronize bugs and bug comments from Launchpad to Trac and vice
versa.

Can we please install this on our Trac?

jml


---------- Forwarded message ----------
From: Graham Binns <graham at canonical.com>
Date: Sat, Aug 23, 2008 at 7:55 AM
Subject: Bugzilla and Trac Launchpad plugins: Request for beta testers
To: Warthogs list <warthogs at lists.canonical.com>


Howdy, warthogs,

I'm writing to you to ask for help with testing some cool new features
that we're going to be adding to Launchpad shortly.

We've developed (well, we've contracted people to develop) plugins for
Bugzilla and Trac that allow bidirectional communication between
Launchpad and the remote bug trackers that have them installed.

As I said, we need some help testing these plugins. Specifically, we need to
have them installed on a number of remote bug trackers so that we can use the
plugins to communicate with those trackers.

If you know of any bug trackers whose administrators might be interested
in helping us out (or, even better, if you're one of those
administrators yourself),
please point them to the following pages on the help wiki, which will
explain how
to download and install the Launchpad plugins:

For Bugzilla: http://help.launchpad.net/Bugs/BugzillaPlugin
For Trac: http://help.launchpad.net/Bugs/TracPlugin

Installing one of the plugins means that:

 * Launchpad will be able to forward bugs to upstream bug trackers that
  have the plugin installed. Users of those bug trackers won't have to
  check Launchpad for bugs registered against their project; they'll be
  forwarded straight to the upstream tracker.

 * If a bug watch is created against an upstream bug, Launchpad will
  tell the upstream bug tracker which Launchpad bug is watching it.
  This means that not only is there a link in Launchpad to the upstream
  bug, but there's also a link in the upstream bug tracker to the
  Launchpad bug.

 * Launchpad will be able to import comments from upstream bugs which
  are being watched in Launchpad. If you register a bug watch against
  an upstream bug you'll be able to read the conversation about that
  bug on Launchpad, including the comments that are made on the
  upstream bug tracker.

 * Launchpad will be able to push comments to upstream bugs which are
  linked to a Launchpad bug, so if you add a comment on Launchpad in
  reply to a comment which was imported from an upstream bug tracker,
  the comment will automatically be added to the conversation on the
  upstream bug tracker, too. This means that users of both Launchpad
  and the upstream tracker can view the whole conversation about the
  bug without leaving their preferred environments.

If you've got any further questions, please feel free to ask me.

Thanks in advance for your help,

Graham

--
Graham Binns | PGP Key: 4DAD18FA

--
warthogs mailing list
warthogs at lists.canonical.com
https://lists.ubuntu.com/mailman/listinfo/warthogs



From lucc at inf.ufrgs.br  Wed Aug 27 06:14:33 2008
From: lucc at inf.ufrgs.br (Luciano Cavalheiro da Silva)
Date: Wed, 27 Aug 2008 09:14:33 -0300
Subject: [Twisted-Python] Is  Ldaptor stable / still maintained?
Message-ID: <48B54529.5070000@inf.ufrgs.br>

Hi there,

Anybody could tell me whether Ldaptor, which is build on top of twisted,
is still maintained or has been abandoned? Is it stable? I've found on
its home page it has not been updated in the last 3 years...

I'm starting a project (production system) in python which has to access
an Openldap server, so I'm in doubt what would be better to use by now,
ldaptor or python-ldap?

Best regards,

         Luciano




From exarkun at divmod.com  Wed Aug 27 07:54:57 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 27 Aug 2008 09:54:57 -0400
Subject: [Twisted-Python] Use the Launchpad plugin on our trac? (was
	Fwd: Bugzilla and Trac Launchpad plugins: Request for beta testers)
In-Reply-To: <d06a5cd30808261819wdc57aa0t6256eb01136c8def@mail.gmail.com>
Message-ID: <20080827135457.29191.920749908.divmod.quotient.18733@ohm>

On Wed, 27 Aug 2008 11:19:24 +1000, Jonathan Lange <jml at mumak.net> wrote:
>---------- Forwarded message ----------
>From: Graham Binns <graham at canonical.com>
>Date: Sat, Aug 23, 2008 at 7:55 AM
>Subject: Bugzilla and Trac Launchpad plugins: Request for beta testers
>To: Warthogs list <warthogs at lists.canonical.com>
>
>Howdy, warthogs,
>
>I'm writing to you to ask for help with testing some cool new features
>that we're going to be adding to Launchpad shortly.
>
>We've developed (well, we've contracted people to develop) plugins for
>Bugzilla and Trac that allow bidirectional communication between
>Launchpad and the remote bug trackers that have them installed.
>
>As I said, we need some help testing these plugins. Specifically, we need to
>have them installed on a number of remote bug trackers so that we can use the
>plugins to communicate with those trackers.
>
>If you know of any bug trackers whose administrators might be interested
>in helping us out (or, even better, if you're one of those
>administrators yourself),
>please point them to the following pages on the help wiki, which will
>explain how
>to download and install the Launchpad plugins:
>
>For Bugzilla: http://help.launchpad.net/Bugs/BugzillaPlugin
>For Trac: http://help.launchpad.net/Bugs/TracPlugin
>
>Installing one of the plugins means that:
>
> * Launchpad will be able to forward bugs to upstream bug trackers that
>  have the plugin installed. Users of those bug trackers won't have to
>  check Launchpad for bugs registered against their project; they'll be
>  forwarded straight to the upstream tracker.
>
> * If a bug watch is created against an upstream bug, Launchpad will
>  tell the upstream bug tracker which Launchpad bug is watching it.
>  This means that not only is there a link in Launchpad to the upstream
>  bug, but there's also a link in the upstream bug tracker to the
>  Launchpad bug.
>
> * Launchpad will be able to import comments from upstream bugs which
>  are being watched in Launchpad. If you register a bug watch against
>  an upstream bug you'll be able to read the conversation about that
>  bug on Launchpad, including the comments that are made on the
>  upstream bug tracker.
>
> * Launchpad will be able to push comments to upstream bugs which are
>  linked to a Launchpad bug, so if you add a comment on Launchpad in
>  reply to a comment which was imported from an upstream bug tracker,
>  the comment will automatically be added to the conversation on the
>  upstream bug tracker, too. This means that users of both Launchpad
>  and the upstream tracker can view the whole conversation about the
>  bug without leaving their preferred environments.
>
>If you've got any further questions, please feel free to ask me.
>
>Thanks in advance for your help,
>
>Graham
>
>Hello all,
>
>Launchpad has recently released a Trac plugin that lets Launchpad
>synchronize bugs and bug comments from Launchpad to Trac and vice
>versa.
>
>Can we please install this on our Trac?
>

I got stuck when I got to the part of the installation which called for
the addition of the LAUNCHPAD_RPC permission to the launchpad user.  The
LAUNCHPAD_RPC permission isn't recognized and trac-admin refuses to add
it.

    Command failed: LAUNCHPAD_RPC is not a valid action.

Any suggestions?

Also, it seems like it might be a good idea to recommend on the installation
instructions page that the ability to register a new user named "launchpad"
be disabled before enabling this plugin.  Otherwise anyone can come along
and gain launchpad-level access to a tracker.

Jean-Paul



From exarkun at divmod.com  Wed Aug 27 08:21:51 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 27 Aug 2008 10:21:51 -0400
Subject: [Twisted-Python] Use the Launchpad plugin on our trac? (was
	Fwd: Bugzilla and Trac Launchpad plugins: Request for beta testers)
In-Reply-To: <20080827135457.29191.920749908.divmod.quotient.18733@ohm>
Message-ID: <20080827142151.29191.1149130572.divmod.quotient.18743@ohm>

On Wed, 27 Aug 2008 09:54:57 -0400, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> [snip]
>
>I got stuck when I got to the part of the installation which called for
>the addition of the LAUNCHPAD_RPC permission to the launchpad user.  The
>LAUNCHPAD_RPC permission isn't recognized and trac-admin refuses to add
>it.
>
>    Command failed: LAUNCHPAD_RPC is not a valid action.
>
>Any suggestions?
>

Alright, feel free to ignore that.  Purely an administrative error on my
part.

>Also, it seems like it might be a good idea to recommend on the installation
>instructions page that the ability to register a new user named "launchpad"
>be disabled before enabling this plugin.  Otherwise anyone can come along
>and gain launchpad-level access to a tracker.

I have a couple other questions, also.

What's with the "(Private)" bugs which show up on this page?

  https://launchpad.net/bugs/bugtrackers/twisted-bugs

Who controls the list of projects that show up in the "related projects"
box on that page?  What does it mean to be a "related project"?  Does it
mean bugs for those projects can get synchronized with the upstream bug
tracker, or is it just general information?

Jean-Paul



From psanchez at nortel.com  Wed Aug 27 15:31:40 2008
From: psanchez at nortel.com (Pedro Sanchez)
Date: Wed, 27 Aug 2008 17:31:40 -0400
Subject: [Twisted-Python] An XMPP client with SSL support
Message-ID: <1219872700.10045.29.camel@pcard0ze.ca.nortel.com>

Hello,

I have a sample XMPP client with the following structure:

from twisted.words.protocols.jabber import client, jid
from twisted.internet import reactor
...
factory = client.basicClientFactory(myJid, myPasswd)
reactor.connectTCP(host,5222,factory)
reactor.run()

It works well, I can connect to the XMPP server. But I would appreciate
if some one could give me some hints on what's required to get the
client to connect using a secure SSL link. 

Thanks,

-- 
Pedro







From aldoogy at gmail.com  Thu Aug 28 06:19:50 2008
From: aldoogy at gmail.com (A)
Date: Thu, 28 Aug 2008 13:19:50 +0100
Subject: [Twisted-Python] RemoteReference decref
Message-ID: <48B697E6.3000302@gmail.com>

Hi,
I'm still working on an Actionscript pb client,

and have run into a bit of a conundrum with RemoteReference which is 
using python's built-in __del__  to trigger a decref.
Actionscript doesn't have destructors so I will need to trigger the 
decref manually.

based on my capture of a clent/server converation I am thinking that the 
client could do this in proto_answer

s -:  ('version', 6)
r -:  ['version', 6]
r -:  ['message', 1, 'root', 'login', 1, ['tuple', 'alice'], ['dictionary']]
s -:  ('answer', 1, ['tuple', 
'x\x9b\x95\x1c\tJp\xe0\x96]\xf4\xdb\xeb\x13\t9', ('remote', 1)])
r -:  ['message', 2, 1, 'respond', 1, ['tuple', 
'\x06\x04\xf1vI\xfeP\xa0\xdfzl(\xd9\x7f!t', ['remote', 1]], ['dictionary']]
s -:  ('answer', 2, ('remote', 2))
r -:  ['decref', 1]
r -:  ['message', 3, 2, 'joinGroup', 1, ['tuple', '#lookingForFourth'], 
['dictionary']]
s -:  ('answer', 3, ('remote', 3))
r -:  ['decref', 2]
r -:  ['message', 4, 3, 'send', 1, ['tuple', 'You can call me Al.'], 
['dictionary']]
s -:  ('message', 1, 1, 'print', 1, ['tuple', '<alice> says: You can 
call me Al.'], ['dictionary'])
s -:  ('answer', 4, ['None'])
r -:  ['decref', 3]

Not sure where I get a reference to RemoteReference though.
any ideas ?









From exarkun at divmod.com  Thu Aug 28 06:51:21 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 08:51:21 -0400
Subject: [Twisted-Python] RemoteReference decref
In-Reply-To: <48B697E6.3000302@gmail.com>
Message-ID: <20080828125121.29191.814020133.divmod.quotient.18993@ohm>

On Thu, 28 Aug 2008 13:19:50 +0100, A <aldoogy at gmail.com> wrote:
>Hi,
>I'm still working on an Actionscript pb client,
>
>and have run into a bit of a conundrum with RemoteReference which is using 
>python's built-in __del__  to trigger a decref.
>Actionscript doesn't have destructors so I will need to trigger the decref 
>manually.
>
>based on my capture of a clent/server converation I am thinking that the 
>client could do this in proto_answer

This doesn't sound like it makes sense.  You should only decref when the
object is no longer in use.  If you can't do it from a destructor, then
you have to require application code to do it.  The protocol implementation
can't know when the application has finished using the object.

>
>s -:  ('version', 6)
>r -:  ['version', 6]
>r -:  ['message', 1, 'root', 'login', 1, ['tuple', 'alice'], ['dictionary']]
>s -:  ('answer', 1, ['tuple', 
>'x\x9b\x95\x1c\tJp\xe0\x96]\xf4\xdb\xeb\x13\t9', ('remote', 1)])
>r -:  ['message', 2, 1, 'respond', 1, ['tuple', 
>'\x06\x04\xf1vI\xfeP\xa0\xdfzl(\xd9\x7f!t', ['remote', 1]], ['dictionary']]
>s -:  ('answer', 2, ('remote', 2))
>r -:  ['decref', 1]
>r -:  ['message', 3, 2, 'joinGroup', 1, ['tuple', '#lookingForFourth'], 
>['dictionary']]
>s -:  ('answer', 3, ('remote', 3))
>r -:  ['decref', 2]
>r -:  ['message', 4, 3, 'send', 1, ['tuple', 'You can call me Al.'], 
>['dictionary']]
>s -:  ('message', 1, 1, 'print', 1, ['tuple', '<alice> says: You can call me 
>Al.'], ['dictionary'])
>s -:  ('answer', 4, ['None'])
>r -:  ['decref', 3]
>

The protocol capture shows decrefs after answers purely by coincidence.  If
the application code being run to generate this kept references to the
objects longer, then you wouldn't see this pattern.

Jean-Paul



From pbastov at gmail.com  Thu Aug 28 07:05:38 2008
From: pbastov at gmail.com (Pavel)
Date: Thu, 28 Aug 2008 19:05:38 +0600
Subject: [Twisted-Python] Could not accept new connection
Message-ID: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>

Hi all,

today I got this error in my twisted.log

[twisted.web.server.Site] Could not accept new connection (ECONNABORTED)

What could be a possible cause of this? Any ways to fix it?

Thanks in advance.

-- 
Good luck,

Pavel Bastov



From maarten at treewalker.org  Thu Aug 28 07:17:13 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Thu, 28 Aug 2008 15:17:13 +0200
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
References: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
Message-ID: <200808281517.18725.maarten@treewalker.org>

On Thursday 28 August 2008, Pavel wrote:
> Hi all,
>
> today I got this error in my twisted.log
>
> [twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>
> What could be a possible cause of this? Any ways to fix it?

The (ECONNABORTED) suggests that this error originated in the OS and was 
only propagated by Python and Twisted. Which OS are you using?

The documentation of the C accept() call might help. On my Linux system "man 
2 accept" just says "ECONNABORTED: A connection has been aborted." 
though. :(

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
URL: </pipermail/twisted-python/attachments/20080828/dd47b21a/attachment.sig>

From adelagon at gmail.com  Thu Aug 28 07:19:21 2008
From: adelagon at gmail.com (Alvin Delagon)
Date: Thu, 28 Aug 2008 21:19:21 +0800
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
References: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
Message-ID: <7a01f6c00808280619n3b2099efnb4f3bd795a468809@mail.gmail.com>

How many simultaneous clients connected on your server? By default, linux is
configured to have 1024 file descriptors pre process. You may have to set
your ulimit higher.


On Thu, Aug 28, 2008 at 9:05 PM, Pavel <pbastov at gmail.com> wrote:

> Hi all,
>
> today I got this error in my twisted.log
>
> [twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>
> What could be a possible cause of this? Any ways to fix it?
>
> Thanks in advance.
>
> --
> Good luck,
>
> Pavel Bastov
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
http://www.alvinatorsplayground.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080828/3fed2964/attachment.html>

From exarkun at divmod.com  Thu Aug 28 07:22:30 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 09:22:30 -0400
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <eaf39e680808280605y3a8416ceq5212e8771ed14ef4@mail.gmail.com>
Message-ID: <20080828132230.29191.226457487.divmod.quotient.19005@ohm>

On Thu, 28 Aug 2008 19:05:38 +0600, Pavel <pbastov at gmail.com> wrote:
>Hi all,
>
>today I got this error in my twisted.log
>
>[twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>
>What could be a possible cause of this? Any ways to fix it?
>

This means that a client started to connect to your server but then
quickly aborted the attempt.  The server saw the attempt but before
it could accept the new connection, the client had abandoned it.
Assuming other clients are successfully connecting to your server,
you can safely ignore this.

Jean-Paul



From exarkun at divmod.com  Thu Aug 28 07:23:39 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 09:23:39 -0400
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <7a01f6c00808280619n3b2099efnb4f3bd795a468809@mail.gmail.com>
Message-ID: <20080828132339.29191.36350471.divmod.quotient.19007@ohm>

On Thu, 28 Aug 2008 21:19:21 +0800, Alvin Delagon <adelagon at gmail.com> wrote:
>On Thu, Aug 28, 2008 at 9:05 PM, Pavel <pbastov at gmail.com> wrote:
>
>> Hi all,
>>
>> today I got this error in my twisted.log
>>
>> [twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>>
>> What could be a possible cause of this? Any ways to fix it?
>>
>> Thanks in advance.
>>
>> --
>> Good luck,
>>
>> Pavel Bastov
>>
>
>How many simultaneous clients connected on your server? By default, linux is
>configured to have 1024 file descriptors pre process. You may have to set
>your ulimit higher.
>

Encountering a ulimit on open files will result in EMFILE rather than
ECONNABORTED.

Jean-Paul



From spiritualmechanic at yahoo.com  Thu Aug 28 07:25:40 2008
From: spiritualmechanic at yahoo.com (Steve Lewis)
Date: Thu, 28 Aug 2008 06:25:40 -0700 (PDT)
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
Message-ID: <575469.72443.qm@web33703.mail.mud.yahoo.com>

I'm fairly new to twisted, although we are using it in production. What I'd like to do, is have a simple redlight/greenlight method (over XML-RPC) to tell me which methods have been called successfully at least once. The goal of this is not so much performance or uptime, but to just tell me that we are configured correctly.

We're using twisted as a sort of service bus, so we have a decent amount of configuration that needs to be set up.

What I've considered so far:

1. Modifying each xmlrpc method individually and setting a boolean to True in a dictionary:

       if results:
            self._monitor['xmlrpc.method.name'] = True

This is okay, but I'd like something that is more generic so I don't have to write this code in every single XMLRPC method.

2. Extending/subclassing XMLRPC: 

    def _getFunction(self, functionPath):
        '''
        Overrides XMLRPC._getFunction to use our simple mapper.
        '''
        
        ## attempt default behavior for local methods
        try:
            func = XMLRPC._getFunction(self, functionPath)
            return func
        except NoSuchFunction:
            pass

This would work in my head, but in actuality, the call doesn't actually happen here, it just returns the function.

3. Extending/subclassing QueryProtocol:

    def handleStatus(self, version, status, message):
        if status != '200':
            self.factory.badStatus(status, message)

I could override QueryProtocol and in the handleStatus method set a field in a dictionary.

There are probably many ways to do this wrong, and I'm a Java guy just getting used to the twisted way of doing things. I apologize if my attempts are painful and/or hilarious.

Thanks,
Steve L.



      



From exarkun at divmod.com  Thu Aug 28 09:01:10 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 11:01:10 -0400
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
In-Reply-To: <575469.72443.qm@web33703.mail.mud.yahoo.com>
Message-ID: <20080828150111.29191.660945311.divmod.quotient.19037@ohm>

On Thu, 28 Aug 2008 06:25:40 -0700 (PDT), Steve Lewis <spiritualmechanic at yahoo.com> wrote:
>I'm fairly new to twisted, although we are using it in production. What I'd like to do, is have a simple redlight/greenlight method (over XML-RPC) to tell me which methods have been called successfully at least once. The goal of this is not so much performance or uptime, but to just tell me that we are configured correctly.
>
>We're using twisted as a sort of service bus, so we have a decent amount of configuration that needs to be set up.
>
>What I've considered so far:
>
>[snip]
>
>2. Extending/subclassing XMLRPC:
>
>    def _getFunction(self, functionPath):
>        '''
>        Overrides XMLRPC._getFunction to use our simple mapper.
>        '''
>
>        ## attempt default behavior for local methods
>        try:
>            func = XMLRPC._getFunction(self, functionPath)
>            return func
>        except NoSuchFunction:
>            pass
>
>This would work in my head, but in actuality, the call doesn't actually happen here, it just returns the function.
>

This is probably the best approach.  `_getFunction should probably be a
public method.  Its docstring directs users to override it, which is rather
in conflict with it being private.

To overcome the problem of the function not actually being called inside
`_getFunction, you just need to apply a wrapper to the function which is
looked up.  The wrapper can mark the call as successful.  For example:

    def _getFunction(self, functionPath):
        f = XMLRPC._getFunction(self, functionPath)
        def wrapper(*a, **kw):
            result = f(*a, **kw)
            self._monitor[functionPath] = True
            return result
        return wrapper

I'd also recommend filing a ticket to make `_getFunction public, so that
you don't have to rely on a private hook to make this work.

Jean-Paul



From spiritualmechanic at yahoo.com  Thu Aug 28 11:22:01 2008
From: spiritualmechanic at yahoo.com (Steve Lewis)
Date: Thu, 28 Aug 2008 10:22:01 -0700 (PDT)
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
Message-ID: <275280.69794.qm@web33704.mail.mud.yahoo.com>

Okay, that seems to work. One more question:

We've defined a class called XMLRPCWithRemote that subclasses XMLRPC. Some of the methods are local, others with be called using the Proxy. I tried to wrap the function but I'm getting:

exceptions.AttributeError: Deferred instance has no __call__ method


This is the code I have for wrapping:

              def wrapper(*args, **kw):
                        func = self._getProxy(URL["url"], URL["user"], URL["passwd"]).callRemote(remote_method, *args, **kw)
                        result = func(*args, **kw)
                        monitor[functionPath] = True
                                                
                        return result
                        
                    return wrapper

_getProxy is defined thusly:

    def _getProxy(self, url, username=None, password=None):
        log.msg("Get proxy")
        return Proxy(url, user=username, password=password, allowNone=True, useDateTime=True)


So it looks like I'm getting a deferred back from the callRemote, so it appears harder to wrap? I think that's what's going on. I'm guessing the local method doesn't require a deferred, so that's why it works.

Is there something obvious I'm missing? I started going down the path of overriding xmlrpc.Proxy or xmlrpc._QueryFactory but I'm not sure that's the simplest way.

Thanks a bunch,
Steve



----- Original Message ----
From: Jean-Paul Calderone <exarkun at divmod.com>
To: Twisted general discussion <twisted-python at twistedmatrix.com>
Sent: Thursday, August 28, 2008 4:01:10 PM
Subject: Re: [Twisted-Python] Monitoring configuration of twisted calls.

On Thu, 28 Aug 2008 06:25:40 -0700 (PDT), Steve Lewis <spiritualmechanic at yahoo.com> wrote:
>I'm fairly new to twisted, although we are using it in production. What I'd like to do, is have a simple redlight/greenlight method (over XML-RPC) to tell me which methods have been called successfully at least once. The goal of this is not so much performance or uptime, but to just tell me that we are configured correctly.
>
>We're using twisted as a sort of service bus, so we have a decent amount of configuration that needs to be set up.
>
>What I've considered so far:
>
>[snip]
>
>2. Extending/subclassing XMLRPC:
>
>    def _getFunction(self, functionPath):
>        '''
>        Overrides XMLRPC._getFunction to use our simple mapper.
>        '''
>
>        ## attempt default behavior for local methods
>        try:
>            func = XMLRPC._getFunction(self, functionPath)
>            return func
>        except NoSuchFunction:
>            pass
>
>This would work in my head, but in actuality, the call doesn't actually happen here, it just returns the function.
>

This is probably the best approach.  `_getFunction should probably be a
public method.  Its docstring directs users to override it, which is rather
in conflict with it being private.

To overcome the problem of the function not actually being called inside
`_getFunction, you just need to apply a wrapper to the function which is
looked up.  The wrapper can mark the call as successful.  For example:

    def _getFunction(self, functionPath):
        f = XMLRPC._getFunction(self, functionPath)
        def wrapper(*a, **kw):
            result = f(*a, **kw)
            self._monitor[functionPath] = True
            return result
        return wrapper

I'd also recommend filing a ticket to make `_getFunction public, so that
you don't have to rely on a private hook to make this work.

Jean-Paul

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



      



From exarkun at divmod.com  Thu Aug 28 11:29:17 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 13:29:17 -0400
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
In-Reply-To: <275280.69794.qm@web33704.mail.mud.yahoo.com>
Message-ID: <20080828172917.29191.27032108.divmod.quotient.19077@ohm>

On Thu, 28 Aug 2008 10:22:01 -0700 (PDT), Steve Lewis <spiritualmechanic at yahoo.com> wrote:
>Okay, that seems to work. One more question:
>
>We've defined a class called XMLRPCWithRemote that subclasses XMLRPC. Some of the methods are local, others with be called using the Proxy. I tried to wrap the function but I'm getting:
>
>exceptions.AttributeError: Deferred instance has no __call__ method
>
>
>This is the code I have for wrapping:
>
>              def wrapper(*args, **kw):
>                        func = self._getProxy(URL["url"], URL["user"], URL["passwd"]).callRemote(remote_method, *args, **kw)
>                        result = func(*args, **kw)
>                        monitor[functionPath] = True
>
>                        return result
>
>                    return wrapper
>
>_getProxy is defined thusly:
>
>    def _getProxy(self, url, username=None, password=None):
>        log.msg("Get proxy")
>        return Proxy(url, user=username, password=password, allowNone=True, useDateTime=True)
>
>
>So it looks like I'm getting a deferred back from the callRemote, so it appears harder to wrap? I think that's what's going on. I'm guessing the local method doesn't require a deferred, so that's why it works.
>
>Is there something obvious I'm missing? I started going down the path of overriding xmlrpc.Proxy or xmlrpc._QueryFactory but I'm not sure that's the simplest way.

The wrapper I gave as an example doesn't handle Deferreds, indeed.  Have
you worked with Deferreds before?  If not, you may want to read some of
the documentation about them, eg:

 http://twistedmatrix.com/projects/core/documentation/howto/defer.html

That aside, I don't really understand the modifications you've made.  It
seems that you're doing an XML-RPC call to get a function object to call
to produce a result to give to the XML-RPC client which made a call on to
you.  Since XML-RPC calls can't result in functions, I don't understand
this.

Jean-Paul



From spiritualmechanic at yahoo.com  Thu Aug 28 11:42:13 2008
From: spiritualmechanic at yahoo.com (Steve Lewis)
Date: Thu, 28 Aug 2008 10:42:13 -0700 (PDT)
Subject: [Twisted-Python] Monitoring configuration of twisted calls.
Message-ID: <945109.84090.qm@web33704.mail.mud.yahoo.com>

Actually, I think I just figured it out:

                    def wrapper(*args, **kw):
                        func = self._getProxy(URL["url"], URL["user"], URL["passwd"]).callRemote(remote_method, *args, **kw)
                        
                        func.addCallback(self.handleSuccess, method)
                                                
                        return func
                        
                    return wrapper

All I needed was to add a callback!
Steve



----- Original Message ----
From: Jean-Paul Calderone <exarkun at divmod.com>
To: Twisted general discussion <twisted-python at twistedmatrix.com>
Sent: Thursday, August 28, 2008 4:01:10 PM
Subject: Re: [Twisted-Python] Monitoring configuration of twisted calls.

On Thu, 28 Aug 2008 06:25:40 -0700 (PDT), Steve Lewis <spiritualmechanic at yahoo.com> wrote:
>I'm fairly new to twisted, although we are using it in production. What I'd like to do, is have a simple redlight/greenlight method (over XML-RPC) to tell me which methods have been called successfully at least once. The goal of this is not so much performance or uptime, but to just tell me that we are configured correctly.
>
>We're using twisted as a sort of service bus, so we have a decent amount of configuration that needs to be set up.
>
>What I've considered so far:
>
>[snip]
>
>2. Extending/subclassing XMLRPC:
>
>    def _getFunction(self, functionPath):
>        '''
>        Overrides XMLRPC._getFunction to use our simple mapper.
>        '''
>
>        ## attempt default behavior for local methods
>        try:
>            func = XMLRPC._getFunction(self, functionPath)
>            return func
>        except NoSuchFunction:
>            pass
>
>This would work in my head, but in actuality, the call doesn't actually happen here, it just returns the function.
>

This is probably the best approach.  `_getFunction should probably be a
public method.  Its docstring directs users to override it, which is rather
in conflict with it being private.

To overcome the problem of the function not actually being called inside
`_getFunction, you just need to apply a wrapper to the function which is
looked up.  The wrapper can mark the call as successful.  For example:

    def _getFunction(self, functionPath):
        f = XMLRPC._getFunction(self, functionPath)
        def wrapper(*a, **kw):
            result = f(*a, **kw)
            self._monitor[functionPath] = True
            return result
        return wrapper

I'd also recommend filing a ticket to make `_getFunction public, so that
you don't have to rely on a private hook to make this work.

Jean-Paul

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



      



From ellisonbg.net at gmail.com  Thu Aug 28 12:52:02 2008
From: ellisonbg.net at gmail.com (Brian Granger)
Date: Thu, 28 Aug 2008 11:52:02 -0700
Subject: [Twisted-Python] "_wait" is blowing up?!
In-Reply-To: <20080824080803.25821.1654368831.divmod.xquotient.14873@joule.divmod.com>
References: <6ce0ac130808232325p666a93cdl85c5cdc54a1a8328@mail.gmail.com>
	<20080824080803.25821.1654368831.divmod.xquotient.14873@joule.divmod.com>
Message-ID: <6ce0ac130808281152x5b10b6baq67020919e15dd4d2@mail.gmail.com>

> Is your code available somewhere?

yes, the code is the IPython mainline, on launchpad:

$ bzr branch lp:ipython

Then, simply

$ trial IPython

Will show the problem.  You will also need foolcap to run the test suite.

> Do you reliably see this error eventually if you use trial --until- failure?

It shows up as an Error rather than a Failure.  But yes, it still shows up.

> Exactly what version of Twisted are you using?

Latest stable.

> What reactor do you typically run your tests under?

Default on all platforms.

> Not sure that I'd be able to tell you what's going on even with an answer to
> all of these questions, but they'd be a start :).

Thanks, I know this type of thing is tough to debug.  Any clever
tricks I could use to track it down?

Thanks

Brian

> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From exarkun at divmod.com  Thu Aug 28 13:11:33 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 28 Aug 2008 15:11:33 -0400
Subject: [Twisted-Python] "_wait" is blowing up?!
In-Reply-To: <6ce0ac130808281152x5b10b6baq67020919e15dd4d2@mail.gmail.com>
Message-ID: <20080828191133.29191.157249331.divmod.quotient.19100@ohm>



On Thu, 28 Aug 2008 11:52:02 -0700, Brian Granger <ellisonbg.net at gmail.com> wrote:
>> Is your code available somewhere?
>
>yes, the code is the IPython mainline, on launchpad:
>
>$ bzr branch lp:ipython
>
>Then, simply
>
>$ trial IPython
>
>Will show the problem.  You will also need foolcap to run the test suite.
>
>> Do you reliably see this error eventually if you use trial --until- failure?
>
>It shows up as an Error rather than a Failure.  But yes, it still shows up.
>
>> Exactly what version of Twisted are you using?
>
>Latest stable.
>
>> What reactor do you typically run your tests under?
>
>Default on all platforms.
>
>> Not sure that I'd be able to tell you what's going on even with an answer to
>> all of these questions, but they'd be a start :).
>
>Thanks, I know this type of thing is tough to debug.  Any clever
>tricks I could use to track it down?

You can try running with trial --debug (possibly also --nopm).  This will
cause Deferred debugging to be enabled, which will cause the call site of
each Deferred's creation to be saved.  Then you can inspect this to learn
which Deferred is being called back multiple times.  Once you learn this,
further debugging approaches may become apparent (like looking at all the
call sites which can call back a Deferred created there, and figuring out
how more than one of them can be executed).

Jean-Paul



From faraz.khan at emergen.biz  Fri Aug 29 02:08:14 2008
From: faraz.khan at emergen.biz (Faraz Khan)
Date: Fri, 29 Aug 2008 14:08:14 +0600
Subject: [Twisted-Python] Is  Ldaptor stable / still maintained?
In-Reply-To: <48B54529.5070000@inf.ufrgs.br>
References: <48B54529.5070000@inf.ufrgs.br>
Message-ID: <48B7AE6E.9070708@emergen.biz>

I use python-ldap rigorously without issues...

Luciano Cavalheiro da Silva wrote:
> Hi there,
> 
> Anybody could tell me whether Ldaptor, which is build on top of twisted,
> is still maintained or has been abandoned? Is it stable? I've found on
> its home page it has not been updated in the last 3 years...
> 
> I'm starting a project (production system) in python which has to access
> an Openldap server, so I'm in doubt what would be better to use by now,
> ldaptor or python-ldap?
> 
> Best regards,
> 
>         Luciano
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 

-- 
Faraz R Khan
Chief Architect
Emergen Consulting Pvt Ltd
+92.21.529.0381 x200
www.emergen.biz




From pbastov at gmail.com  Fri Aug 29 02:20:45 2008
From: pbastov at gmail.com (Pavel)
Date: Fri, 29 Aug 2008 14:20:45 +0600
Subject: [Twisted-Python] Could not accept new connection
In-Reply-To: <20080828132339.29191.36350471.divmod.quotient.19007@ohm>
References: <7a01f6c00808280619n3b2099efnb4f3bd795a468809@mail.gmail.com>
	<20080828132339.29191.36350471.divmod.quotient.19007@ohm>
Message-ID: <eaf39e680808290120g380fff90ne5b55030c5c4321b@mail.gmail.com>

Thanks for your replies.

I don't think I have reached the limit of 1024 connections. Other
clients are connecting successfully to
the server, so, I think I should ignore this error as Jean-Paul suggests.

On Thu, Aug 28, 2008 at 7:23 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Thu, 28 Aug 2008 21:19:21 +0800, Alvin Delagon <adelagon at gmail.com>
> wrote:
>>
>> On Thu, Aug 28, 2008 at 9:05 PM, Pavel <pbastov at gmail.com> wrote:
>>
>>> Hi all,
>>>
>>> today I got this error in my twisted.log
>>>
>>> [twisted.web.server.Site] Could not accept new connection (ECONNABORTED)
>>>
>>> What could be a possible cause of this? Any ways to fix it?
>>>
>>> Thanks in advance.
>>>
>>> --
>>> Good luck,
>>>
>>> Pavel Bastov
>>>
>>
>> How many simultaneous clients connected on your server? By default, linux
>> is
>> configured to have 1024 file descriptors pre process. You may have to set
>> your ulimit higher.
>>
>
> Encountering a ulimit on open files will result in EMFILE rather than
> ECONNABORTED.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Good luck,

Pavel Bastov
xooChat Team Leader
http://www.xoochat.com/



From gabriel.rossetti at arimaz.com  Fri Aug 29 03:06:59 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 29 Aug 2008 11:06:59 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
Message-ID: <48B7BC33.7090501@arimaz.com>

Hello everyone,

Here's the problem : I need to run a windows executable (proprietary, 
they won't give us the code) with wine to do some audio compression. I 
need to do different processing before (like calling sox, or parsing 
files, etc) so I wrote some functions that do everything. The windows 
exec creates a tmp file named "_tmp" in the working dir, so if I want to 
run several in parallel, I have to create a tmp dir with a unique name 
and change the working dir, if not then the multiple executions will 
overwrite each other's tmp file. So when I call my function that does 
the whole process, I first create a tmp dir, then pass it the tmp dir 
and the input filename, then once inside the function, it does an 
os.chDir() into the tmp dir and at the end it does it again to go back 
to the original current dir. Then I run that function in threads. The 
problem is that threads share the current dir :

http://www.biais.org/blog/index.php/2007/01/23/19-python-threads-and-oschdir 

http://bugs.python.org/issue1367

so I need to use processes instead, as they each have their own current 
dir. The thing is that from what I understand, Twisted's process API is 
intended to be used with external executables only, correct? I wasn' t 
able to fins anything that allowed me to do stuff like I would using 
fork(). Should I just use python's fock() instead? Is it safe with Twisted?

Thank you,
Gabriel



From maarten at treewalker.org  Fri Aug 29 03:23:50 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Fri, 29 Aug 2008 11:23:50 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <48B7BC33.7090501@arimaz.com>
References: <48B7BC33.7090501@arimaz.com>
Message-ID: <200808291123.58131.maarten@treewalker.org>

On Friday 29 August 2008, Gabriel Rossetti wrote:

> Here's the problem : I need to run a windows executable (proprietary,
> they won't give us the code) with wine to do some audio compression. I
> need to do different processing before (like calling sox, or parsing
> files, etc) so I wrote some functions that do everything. The windows
> exec creates a tmp file named "_tmp" in the working dir, so if I want to
> run several in parallel, I have to create a tmp dir with a unique name
> and change the working dir, if not then the multiple executions will
> overwrite each other's tmp file. So when I call my function that does
> the whole process, I first create a tmp dir, then pass it the tmp dir
> and the input filename, then once inside the function, it does an
> os.chDir() into the tmp dir and at the end it does it again to go back
> to the original current dir. Then I run that function in threads. The
> problem is that threads share the current dir :

Maybe you could bypass this problem by generating a short shell script that 
does "cd" before it starts Wine? Since the shell will be a separate 
process, it has its own working dir.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
URL: </pipermail/twisted-python/attachments/20080829/6cdfa031/attachment.sig>

From gabriel.rossetti at arimaz.com  Fri Aug 29 03:45:53 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 29 Aug 2008 11:45:53 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <200808291123.58131.maarten@treewalker.org>
References: <48B7BC33.7090501@arimaz.com>
	<200808291123.58131.maarten@treewalker.org>
Message-ID: <48B7C551.7000101@arimaz.com>

Maarten ter Huurne wrote:
> On Friday 29 August 2008, Gabriel Rossetti wrote:
>
>   
>> Here's the problem : I need to run a windows executable (proprietary,
>> they won't give us the code) with wine to do some audio compression. I
>> need to do different processing before (like calling sox, or parsing
>> files, etc) so I wrote some functions that do everything. The windows
>> exec creates a tmp file named "_tmp" in the working dir, so if I want to
>> run several in parallel, I have to create a tmp dir with a unique name
>> and change the working dir, if not then the multiple executions will
>> overwrite each other's tmp file. So when I call my function that does
>> the whole process, I first create a tmp dir, then pass it the tmp dir
>> and the input filename, then once inside the function, it does an
>> os.chDir() into the tmp dir and at the end it does it again to go back
>> to the original current dir. Then I run that function in threads. The
>> problem is that threads share the current dir :
>>     
>
> Maybe you could bypass this problem by generating a short shell script that 
> does "cd" before it starts Wine? Since the shell will be a separate 
> process, it has its own working dir.
>
> Bye,
> 		Maarten
>   
I'd rather not, because that would mean implementing everything (the 
whole conversion process) in the script.
I have stuff to do before the conversion,preparations, those could be 
done in the script, and after : parsing output,
filter and modify the data & then write the new data in binary form -- 
which is harder to do from a non-python shell script.

Maybe I could use a standalone python shell script? Is there no other 
solution?

bye,
Gabriel



From maarten at treewalker.org  Fri Aug 29 04:07:07 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Fri, 29 Aug 2008 12:07:07 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <48B7C551.7000101@arimaz.com>
References: <48B7BC33.7090501@arimaz.com>
	<200808291123.58131.maarten@treewalker.org>
	<48B7C551.7000101@arimaz.com>
Message-ID: <200808291207.15202.maarten@treewalker.org>

On Friday 29 August 2008, Gabriel Rossetti wrote:
> Maarten ter Huurne wrote:
> > Maybe you could bypass this problem by generating a short shell script
> > that does "cd" before it starts Wine? Since the shell will be a
> > separate process, it has its own working dir.
>
> I'd rather not, because that would mean implementing everything (the
> whole conversion process) in the script.

Do the other processing steps also require the working directory to be 
changed? Most unix programs work fine from any dir as long as you provide 
absolute paths for the input and output files.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
URL: </pipermail/twisted-python/attachments/20080829/91b9eea4/attachment.sig>

From gabriel.rossetti at arimaz.com  Fri Aug 29 04:40:31 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 29 Aug 2008 12:40:31 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <200808291207.15202.maarten@treewalker.org>
References: <48B7BC33.7090501@arimaz.com>	<200808291123.58131.maarten@treewalker.org>	<48B7C551.7000101@arimaz.com>
	<200808291207.15202.maarten@treewalker.org>
Message-ID: <48B7D21F.5040007@arimaz.com>

Maarten ter Huurne wrote:
> On Friday 29 August 2008, Gabriel Rossetti wrote:
>   
>> Maarten ter Huurne wrote:
>>     
>>> Maybe you could bypass this problem by generating a short shell script
>>> that does "cd" before it starts Wine? Since the shell will be a
>>> separate process, it has its own working dir.
>>>       
>> I'd rather not, because that would mean implementing everything (the
>> whole conversion process) in the script.
>>     
>
> Do the other processing steps also require the working directory to be 
> changed? Most unix programs work fine from any dir as long as you provide 
> absolute paths for the input and output files.
>
> Bye,
> 		Maarten
>   
Hmmm, good question, let me investigate that, I'll keep you updated.

Bye,
Gabriel



From gabriel.rossetti at arimaz.com  Fri Aug 29 05:38:00 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 29 Aug 2008 13:38:00 +0200
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <200808291207.15202.maarten@treewalker.org>
References: <48B7BC33.7090501@arimaz.com>	<200808291123.58131.maarten@treewalker.org>	<48B7C551.7000101@arimaz.com>
	<200808291207.15202.maarten@treewalker.org>
Message-ID: <48B7DF98.3020305@arimaz.com>

Maarten ter Huurne wrote:
> On Friday 29 August 2008, Gabriel Rossetti wrote:
>   
>> Maarten ter Huurne wrote:
>>     
>>> Maybe you could bypass this problem by generating a short shell script
>>> that does "cd" before it starts Wine? Since the shell will be a
>>> separate process, it has its own working dir.
>>>       
>> I'd rather not, because that would mean implementing everything (the
>> whole conversion process) in the script.
>>     
>
> Do the other processing steps also require the working directory to be 
> changed? Most unix programs work fine from any dir as long as you provide 
> absolute paths for the input and output files.
>
> Bye,
> 		Maarten
>   
Maarten,

It worked, I was able to do the pre & post processing using abs paths 
(thus from outside of the working dir)
and the encoding was done from a script that changed the working directory.

Thank you,
Gabriel



From glyph at divmod.com  Fri Aug 29 07:35:24 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Fri, 29 Aug 2008 13:35:24 -0000
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <48B7BC33.7090501@arimaz.com>
References: <48B7BC33.7090501@arimaz.com>
Message-ID: <20080829133524.25821.2120076452.divmod.xquotient.15068@joule.divmod.com>

On 09:06 am, gabriel.rossetti at arimaz.com wrote:
>http://www.biais.org/blog/index.php/2007/01/23/19-python-threads-and- 
>oschdir
>http://bugs.python.org/issue1367
>
>so I need to use processes instead, as they each have their own current 
>dir. The thing is that from what I understand, Twisted's process API is 
>intended to be used with external executables only, correct? I wasn' t 
>able to fins anything that allowed me to do stuff like I would using 
>fork(). Should I just use python's fock() instead? Is it safe with 
>Twisted?

As it happens, "python" is an "external executable".  Here's an example 
of spawning it in such a way as to make sure that sys.path is set 
properly: 
http://divmod.org/trac/browser/trunk/Epsilon/epsilon/process.py#L7

However, Wine is also an external process.  Perhaps you just want to 
spawn the Wine command-line using spawnProcess using the 'path' 
parameter set to a directory that you have created in the main process, 
then clean it up when the process exits?

http://twistedmatrix.com/documents/8.1.0/api/twisted.internet.interfaces.IReactorProcess.spawnProcess.html

Using fork() in Python has a lot of confusing issues associated with it 
unless you're going to exec() immediately afterwards.  You probably want 
to stick to one of these other approaches.



From exarkun at divmod.com  Fri Aug 29 07:47:46 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Fri, 29 Aug 2008 09:47:46 -0400
Subject: [Twisted-Python] Processes in Twisted,
	only possible to run external prog?
In-Reply-To: <20080829133524.25821.2120076452.divmod.xquotient.15068@joule.divmod.com>
Message-ID: <20080829134746.29191.1580174472.divmod.quotient.19372@ohm>

On Fri, 29 Aug 2008 13:35:24 -0000, glyph at divmod.com wrote:
>On 09:06 am, gabriel.rossetti at arimaz.com wrote:
>>
>> [snip]
>>Should I just use python's fock() instead? Is it safe with Twisted?
>
> [snip]
>
>Using fork() in Python has a lot of confusing issues associated with it 
>unless you're going to exec() immediately afterwards.  You probably want to 
>stick to one of these other approaches.
>

You also need to do some other stuff before you call fork(), like close
file descriptors and disable garbage collection.  And then re-enable it
in the parent after the fork().  There's probably even some more things
that are necessary that no one has realized yet.

Jean-Paul



From rlott at evertz.com  Fri Aug 29 09:35:59 2008
From: rlott at evertz.com (Rodney Lott)
Date: Fri, 29 Aug 2008 11:35:59 -0400
Subject: [Twisted-Python] How does the pollreactor work?
Message-ID: <069B6B31F6201B4389D7EEB9AD827BCA05005AF9@otis.burlington.evertz.tv>

Hi, there.

I have been trying to figure out how to use the twisted.internet.pollreactor so that I can use it to monitor a Linux named PIPE (i.e. a FIFO created using mkfifo()).  I tried without success to Google some examples but I couldn't find anything.

Now, for a simple TCP server, the setup looks something like this (i.e. like the QOTD example in the documentation):

	from twisted.internet.protocol import Protocol, Factory
	from twisted.internet import reactor
	
	class QOTD(Protocol):
	
	    def connectionMade(self):
	        self.transport.write("An apple a day keeps the doctor away\r\n") 
	        self.transport.loseConnection()
	
	# Next lines are magic:
	factory = Factory()
	factory.protocol = QOTD
	
	# 8007 is the port you want to run under. Choose something >1024
	reactor.listenTCP(8007, factory)
	reactor.run()

So, the TCP type of reactor has something that tells it to listen to port 8007 and use some form of factory or object to take care of things when a connection occurs.  As far as I can guess, I would need to do some steps like this (NOTE: using mixture of real and pseudo code):

	from twisted.internet import pollreactor
	pollreactor.install()

	<create a FileDescriptor object using /tmp/myfifo, maybe a class?>
	<use the reactor.addReader() call to register the FileDescriptor object with the reactor>
	<call reactor.run() (no loop) or call reactor.doPoll() (in a loop, processing returned events)?>

Anyways, if anyone can give me some direction on how this reactor works.  Ideally, I would assume that the relationships would be somewhat like this:

	Protocol analogous to FileDescriptor
	reactor.listenTCP analogous to reactor.addReader()
	reactor.run() would invoke the appropriate call in my FileDescriptor-based class to handle any read events on /tmp/myfifo

Thanks in advance.

-Rodney

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080829/6afb72ff/attachment.html>

From aldoogy at gmail.com  Fri Aug 29 09:44:16 2008
From: aldoogy at gmail.com (A)
Date: Fri, 29 Aug 2008 16:44:16 +0100
Subject: [Twisted-Python] RemoteReference decref
In-Reply-To: <20080828125121.29191.814020133.divmod.quotient.18993@ohm>
References: <20080828125121.29191.814020133.divmod.quotient.18993@ohm>
Message-ID: <48B81950.5030700@gmail.com>

Thanks I didn't quite understand what decref was for.
I thought it might be the cause of another problem I was having.
but it's not a major problem - decref will just have to be triggered 
manually in an AS client.

I have a tendency to just jump in at the deep end and hope I can figure 
things out  .. .
so I really appreciate the help.

Jean-Paul Calderone wrote:
> On Thu, 28 Aug 2008 13:19:50 +0100, A <aldoogy at gmail.com> wrote:
>> Hi,
>> I'm still working on an Actionscript pb client,
>>
>> and have run into a bit of a conundrum with RemoteReference which is 
>> using python's built-in __del__  to trigger a decref.
>> Actionscript doesn't have destructors so I will need to trigger the 
>> decref manually.
>>
>> based on my capture of a clent/server converation I am thinking that 
>> the client could do this in proto_answer
>
> This doesn't sound like it makes sense.  You should only decref when the
> object is no longer in use.  If you can't do it from a destructor, then
> you have to require application code to do it.  The protocol 
> implementation
> can't know when the application has finished using the object.
>
>>
>> s -:  ('version', 6)
>> r -:  ['version', 6]
>> r -:  ['message', 1, 'root', 'login', 1, ['tuple', 'alice'], 
>> ['dictionary']]
>> s -:  ('answer', 1, ['tuple', 
>> 'x\x9b\x95\x1c\tJp\xe0\x96]\xf4\xdb\xeb\x13\t9', ('remote', 1)])
>> r -:  ['message', 2, 1, 'respond', 1, ['tuple', 
>> '\x06\x04\xf1vI\xfeP\xa0\xdfzl(\xd9\x7f!t', ['remote', 1]], 
>> ['dictionary']]
>> s -:  ('answer', 2, ('remote', 2))
>> r -:  ['decref', 1]
>> r -:  ['message', 3, 2, 'joinGroup', 1, ['tuple', 
>> '#lookingForFourth'], ['dictionary']]
>> s -:  ('answer', 3, ('remote', 3))
>> r -:  ['decref', 2]
>> r -:  ['message', 4, 3, 'send', 1, ['tuple', 'You can call me Al.'], 
>> ['dictionary']]
>> s -:  ('message', 1, 1, 'print', 1, ['tuple', '<alice> says: You can 
>> call me Al.'], ['dictionary'])
>> s -:  ('answer', 4, ['None'])
>> r -:  ['decref', 3]
>>
>
> The protocol capture shows decrefs after answers purely by 
> coincidence.  If
> the application code being run to generate this kept references to the
> objects longer, then you wouldn't see this pattern.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>




From ddwiggins at advpubtech.com  Fri Aug 29 10:12:24 2008
From: ddwiggins at advpubtech.com (Don Dwiggins)
Date: Fri, 29 Aug 2008 09:12:24 -0700
Subject: [Twisted-Python] Controlling logging in xmlrpc server
Message-ID: <g99759$6ab$1@ger.gmane.org>

I have an XMLRPC server running nicely, and have set up logging to a 
file using t.p.log (mainly for debugging).  It all works fine, but I'm 
getting entries in the log like the following:

2008/08/28 16:44 -0700 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - - 
[28/Aug/2008:23:44:02 +0000] "POST / HTTP/1.1" 200 683 "-" 
"Zend_XmlRpc_Client"

(all one line -- excuse the folding).

I'd like to be able to control this: disable these log messages when I 
want, log additional information about the request, etc.  (In 
particular, I'd like to see the xmlrpc "method" name.)

I've tracked down the source of the messages to HTTPFactory.log in 
t.w.http.py.  At this point, I'm not sure how to proceed.  I don't use 
the factory explicitly, just instantiate a subclass of xmlrpc.XMLRPC, 
wrap it in a server.Site and pass it to the default reactor.  What would 
I need to do to access the HTTPFactory (or maybe subclass it) in this 
context?  Is there a better approach to this?

Thanks,
-- 
Don Dwiggins
Advanced Publishing Technology




From glyph at divmod.com  Fri Aug 29 15:20:34 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Fri, 29 Aug 2008 21:20:34 -0000
Subject: [Twisted-Python] How does the pollreactor work?
In-Reply-To: <069B6B31F6201B4389D7EEB9AD827BCA05005AF9@otis.burlington.evertz.tv>
References: <069B6B31F6201B4389D7EEB9AD827BCA05005AF9@otis.burlington.evertz.tv>
Message-ID: <20080829212034.25821.1674589899.divmod.xquotient.15110@joule.divmod.com>


On 03:35 pm, rlott at evertz.com wrote:
>I have been trying to figure out how to use the 
>twisted.internet.pollreactor so that I can use it to monitor a Linux 
>named PIPE (i.e. a FIFO created using mkfifo()).  I tried without 
>success to Google some examples but I couldn't find anything.

This doesn't really have anything to do with pollreactor.  Any reactor 
that implements IReactorFDSet can monitor a pipe.

It was easier for me to implement this than to explain what to do, so 
here's the code for monitoring a named pipe for read, given its name. 
I'm pretty sure it's not 100% correct, but if you want to read about 
handling I/O events from fifos on your platform, you are welcome to do 
so.

    import os
    from twisted.internet.abstract import FileDescriptor
    from twisted.internet.main import CONNECTION_DONE

    class FIFODescriptor(FileDescriptor):
        def __init__(self, reactor, fifoname, protocol):
            FileDescriptor.__init__(self, reactor)
            self.fifo = os.open(fifoname, os.O_NONBLOCK | os.O_RDONLY)
            self.protocol = protocol
            self.protocol.makeConnection(self)

        def connectionLost(self, reason):
            self.protocol.connectionLost(reason)

        def doRead(self):
            data = os.read(self.fifo, 1024)
            if data:
                self.protocol.dataReceived(data)
            else:
                self.stopReading()
                self.connectionLost(CONNECTION_DONE)

        def fileno(self):
            return self.fifo


And here's a brief program that uses it:

    import sys
    from twisted.internet import reactor
    from twisted.internet.protocol import Protocol
    class PrintingProtocol(Protocol):
        def dataReceived(self, data):
            print 'data', repr(data)
        def connectionMade(self):
            print 'hi'
        def connectionLost(self, reason):
            print 'bye', reason
    fifd = FIFODescriptor(reactor, sys.argv[1], PrintingProtocol())
    fifd.startReading()
    reactor.run()

I tested this by doing 'mkfifo x; python fifo.py x', and in another 
terminal, 'cat > x'.  It should be pretty self-explanitory.



From exarkun at twistedmatrix.com  Sat Aug 30 22:05:09 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 31 Aug 2008 04:05:09 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1220155509.74.1568671090@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20080831/5e83d670/attachment.html>

