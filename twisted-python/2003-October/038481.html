<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] newbie: groking flows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20newbie%3A%20groking%20flows&In-Reply-To=%3C25160AB2660F8B449892B0EB9C29C165CE5612%40ex-sea-is2.cobaltgroup.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="038478.html">
   <LINK REL="Next"  HREF="038483.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] newbie: groking flows</H1>
    <B>Nesbitt, Steve</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20newbie%3A%20groking%20flows&In-Reply-To=%3C25160AB2660F8B449892B0EB9C29C165CE5612%40ex-sea-is2.cobaltgroup.com%3E"
       TITLE="[Twisted-Python] newbie: groking flows">snesbitt at cobaltgroup.com
       </A><BR>
    <I>Wed Oct  8 20:21:02 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="038478.html">[Twisted-Python] SSL client certificate verification...
</A></li>
        <LI>Next message (by thread): <A HREF="038483.html">[Twisted-Python] newbie: groking flows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38481">[ date ]</a>
              <a href="thread.html#38481">[ thread ]</a>
              <a href="subject.html#38481">[ subject ]</a>
              <a href="author.html#38481">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>All:

I'm trying to grok flows in general and how to mix cooperative and blocking
flows in particular. I've been reviewing the documentation and have a better
understanding, but something is still eluding me. I'm hoping someone can
help me out with either some pseudocode (or a real world example)

Here's my design problem:
When I start the server, I generate a series of lookup table objects (called
&quot;registries&quot;) by parsing through a series of XML files. XML-RPC requests
come in requesting information and these registries are then used to help
fulfill the request. Periodically, albeit infrequently, one of the original
source XML files may change and an XML-RPC call will request that the
registries be updated/regenerated. During the regeneration process, which
can take multiple seconds, all lookup and additional regeneration requests
should block until completion of the regeneration. Once completed, blocked
requests should resume.

Based on my reading I think this is what should do:
1) Periodically during a lookup call a flow.Cooperate event to allow other
lookup events from other requests to be handled.

2) To avoid a regeneration event in the midst of a lookup, I should make
sure that a flow.Cooperate event is *not* issued at any time during a
critical part of the lookup process ( In other words one can consider the
code executed between two flow.Cooperate statements as a transaction)

3) When I start a regeneration event I should wrap the regeneration method
in a flow.Block controller.


So here are some specific questions:
1) Is my basic understanding correct? In particular am I guaranteed correct
behavior using the above outline?

2) Am I correct in believing that wrapping a method in flow.Block actually
executes the method? That is, the statement flow.Block( foo( bar ) )
   executes foo.bar immediately?

3) How do I access the results of flow.Block( foo( bar ) )? In particular
how do I see the return result or any exceptions tr\hrown by foo?

4) Am I correct in believing that while flow.Block( foo(bar) ) is executing
any incoming requests will be prevented from executing?

5) Is it possible to defer a blocking method? This covers the scenario where
two regeneration events occur within the same time frame.


Thanks in advance for the help and sorry for the length of the post. I'll be
glad to write thisx up as a how to if that would be helpful.


Thanks in advance for the help.

-steve

Stephen Nesbitt
Senior Configuration Management Engineer
The Cobalt Group
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">snesbitt at cobaltgroup.com</A>






This e-mail transmission contains information intended only for the use of
the recipient(s) named above. Further, it contains information that may be
privileged and confidential. If you are not the intended recipient, you are
hereby notified that any dissemination, distribution, or copying of this
message (including any attachments) is strictly prohibited. If you have
received this e-mail in error, please notify the sender by reply e-mail and
then delete this message from your mail system. Thank you for your
compliance.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="038478.html">[Twisted-Python] SSL client certificate verification...
</A></li>
	<LI>Next message (by thread): <A HREF="038483.html">[Twisted-Python] newbie: groking flows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38481">[ date ]</a>
              <a href="thread.html#38481">[ thread ]</a>
              <a href="subject.html#38481">[ subject ]</a>
              <a href="author.html#38481">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
