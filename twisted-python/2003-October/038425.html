<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] SSH client bad packet length
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20SSH%20client%20bad%20packet%20length&In-Reply-To=%3C20031006212313.GC28465%40elmer.skumleren.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="038424.html">
   <LINK REL="Next"  HREF="038426.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] SSH client bad packet length</H1>
    <B>Anders Bruun Olsen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20SSH%20client%20bad%20packet%20length&In-Reply-To=%3C20031006212313.GC28465%40elmer.skumleren.net%3E"
       TITLE="[Twisted-Python] SSH client bad packet length">anders at bruun-olsen.net
       </A><BR>
    <I>Mon Oct  6 15:23:13 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="038424.html">[Twisted-Python] SSH client bad packet length
</A></li>
        <LI>Next message (by thread): <A HREF="038426.html">[Twisted-Python] SSH client bad packet length
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38425">[ date ]</a>
              <a href="thread.html#38425">[ thread ]</a>
              <a href="subject.html#38425">[ subject ]</a>
              <a href="author.html#38425">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Oct 06, 2003 at 05:13:40PM -0400, Paul Swartz wrote:
&gt;<i> &gt; 2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
</I>&gt;<i> &gt;         reason: bad packet length 415956278
</I>&gt;<i> What that error means is that there was an error with one of the
</I>&gt;<i> packets.  Whether it's an error w/ your code or not I can't tell w/out
</I>&gt;<i> seeing the code.
</I>
#!/usr/bin/env python

from twisted.conch import error
from twisted.conch.ssh import transport
from twisted.internet import defer

class ClientTransport(transport.SSHClientTransport):

        def verifyHostKey(self, pubKey, fingerprint):
                return defer.succeed(1)

        def connectionSecure(self):
                self.requestService(ClientUserAuth('user',ClientConnection()))


from twisted.conch.ssh import keys, userauth

publicKey = 'ssh-dss
AAAAB3NzaC1kc3MAAAEBAPUkX9Opu89vLxyMxkssKeGUmfabGRrmiuLplkN34HcScnjf/7H/QDshdcRx4+f8GhJo4yH8DAE0/zVAWZK9aMI5LpjSpr9gR2Vyq5df7vnldJljxlGMnT5W79bloP69Fo3Hjf44dTNATxfFMmwHCwMxj1oDkEn78ANyDa5xjoszT54ucm0bPExiPDQ6sz84FEDdKIrrwi8w+rEN5ReBrUPAq9zXHZjt3AOqiaDXbZsRzh6x+XhX7Wg3EkOUfTEhZ1u6baBH0DLg7jiSnURPUwyYoW5qEB0CypjAhl+EaaASvmGcXAl1JSifp0CQ8MedvCb46dGn10McrDVJvFhRxo0AAAAVAOhkyFrn2qzxUk9XmJVc75DKd9Q/AAABACeR0+IjK7SOmBeNzqnLrp5FY1MhO8KwfLpZaHbQPwo6tPR3DBRCBH3oyhxFGpLxWvHsP2LoxmJbqTaTq4T+svuIjICXtlDVOSLd0o6U4A3aDXsoN2gv04RKEkmxrocnY6dYZisHeavP5S10Ediung23ZxOzsBdPEtRDthxOya4QXlqtjIEqAk702qmZGEYCgSRPOQ5Pwm0S7kD8yOn0XQUEY/WjlbZPiM9QUXlroltLnnSeECvFLePsyEVTrvdr8Bne9NxcMW+YZBroKtLOzgH6PLKn4lB8IGOlg+U1qOlkzjDaAMeNL2Hs8vwYVXIcmm3j5JQ5ZYtx2aRHkIUTY3kAAAEBAJxRVoGskwVDnzukLKRxjuFBSpyNr/Iwp0tPvQIyASPsLh5alHRe/2AMTojKdVJkmCjPCEdL4rlzugLkcv6OPzevH5tCtvyU1X2531h51MtIs8jFF7dGPosdt0+hD1O3fA0bXBO4REw0GcMuo/wV9Flx/FZYIkgvqVGalfH5evU0Hj8wQlZaMrW+HcMUrdLBezdMob4qFTK0TQQ8R0KWwYT++ULOGahzY3HwR8GVYYMMGUtRZY96vYkMpLJkSpHobBh2biVb2DuccPqIzCkJWaVdfl8zj5pi07mojvhLXzfWTkZv+nCzZ6DPoW+dMXqg5OE6e8l00gDefFAi8cj5aKc=
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">drzero at ernest.local</A>'

privateKey = &quot;&quot;&quot;-----BEGIN DSA PRIVATE KEY-----
Key was censored for privacy reasons
-----END DSA PRIVATE KEY-----&quot;&quot;&quot;

class ClientUserAuth(userauth.SSHUserAuthClient):

        def getPassword(self, prompt = None):
                return 
                # this says we won't do password authentication

        def getPublicKey(self):
                return keys.getPublicKeyString(data = publicKey)

        def getPrivateKey(self):
                return defer.succeed(keys.getPrivateKeyObject(data = privateKey))


from twisted.conch.ssh import connection

class ClientConnection(connection.SSHConnection):

        def serviceStarted(self):
                self.openChannel(CatChannel(conn = self))


from twisted.conch.ssh import channel, common

class CatChannel(channel.SSHChannel):

        name = 'session'

        def channelOpen(self, data):
                d = self.conn.sendRequest(self, 'exec', common.NS('cat'), wantReply = 1)
                d.addCallback(self._cbSendRequest)
                self.catData = ''

        def _cbSendRequest(self, ignored):
                self.write('This data will be echoed back to us by &quot;cat.&quot;\r\n')
                self.conn.sendEOF(self)
                self.loseConnection()

        def dataReceived(self, data):
                self.catData += data

        def closed(self):
                print 'We got this from &quot;cat&quot;:', self.catData
                reactor.stop()


from twisted.internet import protocol, reactor
from twisted.python import log
import sys

def main():
        log.startLogging(sys.stdout, setStdout=0)
        factory = protocol.ClientFactory()
        factory.protocol = ClientTransport
        reactor.connectTCP('eduardo.local', 22, factory)
        reactor.run()

if __name__ == &quot;__main__&quot;:
        main()


-- 
Anders
-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GCS/O d--@ s:+ a-- C++ UL+++$ P++ L+++ E- W+ N(+) o K? w O-- M- V
PS+ PE@ Y+ PGP+ t 5 X R+ tv+ b++ DI+++ D+ G e- h !r y?
------END GEEK CODE BLOCK------
PGPKey: <A HREF="http://pgp.mit.edu:11371/pks/lookup?op=get&amp;search=0x8BFECB41">http://pgp.mit.edu:11371/pks/lookup?op=get&amp;search=0x8BFECB41</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="038424.html">[Twisted-Python] SSH client bad packet length
</A></li>
	<LI>Next message (by thread): <A HREF="038426.html">[Twisted-Python] SSH client bad packet length
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38425">[ date ]</a>
              <a href="thread.html#38425">[ thread ]</a>
              <a href="subject.html#38425">[ subject ]</a>
              <a href="author.html#38425">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
