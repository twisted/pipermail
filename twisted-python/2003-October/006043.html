<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] conroller.Controller.handle() returning a Deferred
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20conroller.Controller.handle%28%29%20returning%20a%20Deferred&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006042.html">
   <LINK REL="Next"  HREF="006044.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] conroller.Controller.handle() returning a Deferred</H1>
    <B>Dave Thorne</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20conroller.Controller.handle%28%29%20returning%20a%20Deferred&In-Reply-To="
       TITLE="[Twisted-Python] conroller.Controller.handle() returning a Deferred">Dave at centralmanclc.com
       </A><BR>
    <I>Sun Oct 19 11:44:39 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006042.html">[Twisted-Python] Khashmir log crash
</A></li>
        <LI>Next message: <A HREF="006044.html">[Twisted-Python] Reactor interface for system configuration and events?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6043">[ date ]</a>
              <a href="thread.html#6043">[ thread ]</a>
              <a href="subject.html#6043">[ subject ]</a>
              <a href="author.html#6043">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been attempting to use the IRC channel to ask this question, but to no
avail. Maybe I'm not using the IRC client correctly, who knows.

However, I have a problem in a woven application whereby my Controller
object has a handle() method that returns a deferred (from an adbapi query)
on which I have set a callback to do something with the query data.

I assumed that my set callback would be executed before the callback that is
(presumably) set by woven to deal with the deferred's completion. Indeed,
with some print statements as debug tools I see that my callback really is
being executed, but as soon as the &quot;checkMatch&quot; callback returns the page
stalls.

It is no doubt an easy problem to fix, but any help would be greatly
appreciated! I've placed the code for the controller below...

Cheers,

Dave



My Code:
========

class PreferencesController(controller.Controller):

   def handle(self, request):
      &lt;snip&gt;
      theApp = app.theApplication

      def checkMatch(results):
         #Do Stuff
         #Return: nothing, None, results?

      uname = &quot;myusername&quot;
      query = &quot;SELECT * FROM people WHERE username = '%s'&quot; % (uname)
      return theApp.dbpool.runQuery(query).addCallback(checkMatch)

========


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006042.html">[Twisted-Python] Khashmir log crash
</A></li>
	<LI>Next message: <A HREF="006044.html">[Twisted-Python] Reactor interface for system configuration and events?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6043">[ date ]</a>
              <a href="thread.html#6043">[ thread ]</a>
              <a href="subject.html#6043">[ subject ]</a>
              <a href="author.html#6043">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
