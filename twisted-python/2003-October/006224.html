<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.web and MySQLdb
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.web%20and%20MySQLdb&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006201.html">
   <LINK REL="Next"  HREF="006227.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.web and MySQLdb</H1>
    <B>ecn at metaslash.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.web%20and%20MySQLdb&In-Reply-To="
       TITLE="[Twisted-Python] twisted.web and MySQLdb">ecn at metaslash.com
       </A><BR>
    <I>Wed Oct 29 11:42:52 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006201.html">[Twisted-Python] MSN refactor
</A></li>
        <LI>Next message: <A HREF="006227.html">[Twisted-Python] twisted.web and MySQLdb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6224">[ date ]</a>
              <a href="thread.html#6224">[ thread ]</a>
              <a href="subject.html#6224">[ subject ]</a>
              <a href="author.html#6224">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> &gt; Can you qualify &quot;long time&quot;?  And what's the bottleneck?  At the scale 
 &gt; of 100K or so function calls, Python isn't egregiously slow, certainly 
 &gt; not slow enough to not be able to outrun TCP connection setup...?

Hmm, maybe a minute?  I forget exactly.  It was like 4x slower than C++.
(I'm running Linux 2.6test1 with dual AMD Athlon MP/2000's).

I posted a bug in the poll reactor some time ago.  I was testing
an epoll() subclass I had written at the time.

To test the server, I had written a C++ program to connect, 
asynchronously, over the loopback device.  I had to insert a 
pause in the connector to avoid connection failures.  Mind you,
I had to create several &quot;fake&quot; networks in order to have enough
ports for all those simultaneous connections.  This was an absurd
number of connections (10K, 20K, 40K, etc).

The default TCP connection timeout on Linux is ... what? like 61 
seconds or something? That was the number I was hitting.

Everything ran well, up to about 8-10K.  Then it would fall behind,
and then I was at the mercy of TCP retries.

This customer was particularly performance oriented, so I didn't think
that python was going to fly with them, anyhow.  But it is so much
simpler to code/debug/test, I wanted to see how well it would perform.

I tweaked the acceptor to just accept all the connections it could, 
and that was too slow.  It didn't even get into the event loop.  

I also tweaked ACE to accept connections faster, too.  It's 
just a tough problem.

-Eric



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006201.html">[Twisted-Python] MSN refactor
</A></li>
	<LI>Next message: <A HREF="006227.html">[Twisted-Python] twisted.web and MySQLdb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6224">[ date ]</a>
              <a href="thread.html#6224">[ thread ]</a>
              <a href="subject.html#6224">[ subject ]</a>
              <a href="author.html#6224">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
