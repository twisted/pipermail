<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Woven Model extreme pain
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Woven%20Model%20extreme%20pain&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005935.html">
   <LINK REL="Next"  HREF="005877.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Woven Model extreme pain</H1>
    <B>James Y Knight</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Woven%20Model%20extreme%20pain&In-Reply-To="
       TITLE="[Twisted-Python] Woven Model extreme pain">foom at fuhm.net
       </A><BR>
    <I>Thu Oct  2 11:36:06 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005935.html">[Twisted-Python] Adapter troubles - Copying Quotient's DivmodSession
</A></li>
        <LI>Next message: <A HREF="005877.html">[Twisted-Python] Woven Model extreme pain
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5876">[ date ]</a>
              <a href="thread.html#5876">[ thread ]</a>
              <a href="subject.html#5876">[ subject ]</a>
              <a href="author.html#5876">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Okay, so I'm having a few issues with Models.
I have code that looks like follows (request.dbpool does in fact exist 
in my code):

class DatabaseJunk(model.Model):
	def getData(self, request):
		return request.dbpool.runQuery(&quot;&quot;&quot;select * from stuff&quot;&quot;&quot;)

class Page(page.Page):
	templateFile = &quot;main.html&quot;
	isLeaf = 1
	wmfactory_db(self, request):
		return DatabaseJunk()

and, when i request in main.html the model be rendered like:
&lt;span view=&quot;Text&quot; model=&quot;/db&quot; /&gt;
it gets apparently stuck in an infinite loop. getData keeps getting 
called over and over. What am I doing wrong? If I return a Deferred 
from wmfactory_db, it works fine, but not if I return one from getData.

My first thought was, maybe I should be using the &quot;getter=&quot; attr to the 
initializer instead of overriding getData (and thus using a cache), but 
when I tried that,  my code was never called at all. It seems that the 
cache is set to be initially valid, so the getter is never called!

Argh!

And this is on top of my problems yesterday where I was trying to 
return a Deferred from getSubmodel which excercises a code path that 
never gets called otherwise which looks like it should handle the case 
of a Deferred being returned but apparently has never been tested. I 
was apparently supposed to override submodelFactory() instead of 
getSubmodel, despite the fact that that isn't documented anywhere.

Argh!

James



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005935.html">[Twisted-Python] Adapter troubles - Copying Quotient's DivmodSession
</A></li>
	<LI>Next message: <A HREF="005877.html">[Twisted-Python] Woven Model extreme pain
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5876">[ date ]</a>
              <a href="thread.html#5876">[ thread ]</a>
              <a href="subject.html#5876">[ subject ]</a>
              <a href="author.html#5876">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
