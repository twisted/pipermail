<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] The right way to broadcast to your TCP/IP clients?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20The%20right%20way%20to%20broadcast%20to%20your%20TCP/IP%20clients%3F&In-Reply-To=%3C49199579A2BB32438A7572AF3DBB2FB505A21740%40uscimplm001.net.plm.eds.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="039889.html">
   <LINK REL="Next"  HREF="039893.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] The right way to broadcast to your TCP/IP clients?</H1>
    <B>Schneider, Michael</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20The%20right%20way%20to%20broadcast%20to%20your%20TCP/IP%20clients%3F&In-Reply-To=%3C49199579A2BB32438A7572AF3DBB2FB505A21740%40uscimplm001.net.plm.eds.com%3E"
       TITLE="[Twisted-Python] The right way to broadcast to your TCP/IP clients?">michael.l.schneider at ugsplm.com
       </A><BR>
    <I>Mon Mar 29 05:43:11 MST 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="039889.html">[Twisted-Python] The right way to broadcast to your TCP/IP clients?
</A></li>
        <LI>Next message (by thread): <A HREF="039893.html">[Twisted-Python] Re: Twisted Euphrates (Modified by Glyph Lefkowitz)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39890">[ date ]</a>
              <a href="thread.html#39890">[ thread ]</a>
              <a href="subject.html#39890">[ subject ]</a>
              <a href="author.html#39890">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am in a similar situation.  I am use twisted a grid
server for each node on the computer.

I need to send info like &quot;

- I am online
- Job started
- Job completed
- Ready for job

I am getting ready to prototype with jabber.  Any other thought?

Thanks
Mike

 
----------------------------------------------------------------
Michael Schneider
Senior Software Engineering Consultant
UGS PLM Solutions - an EDS Company
 
&quot;The Greatest Performance Improvement Is the transitioning from a non-working state to the working state&quot;


&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>
</I>&gt;<i> [mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>]On Behalf Of Steve
</I>&gt;<i> Freitas
</I>&gt;<i> Sent: Sunday, March 28, 2004 11:20 PM
</I>&gt;<i> To: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>
</I>&gt;<i> Subject: [Twisted-Python] The right way to broadcast to your TCP/IP
</I>&gt;<i> clients?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> I'm working on a chat server-ish kinda thang, and although 
</I>&gt;<i> the learning curve 
</I>&gt;<i> of twisted was a bit much for my last project, I'm back again 
</I>&gt;<i> for more 
</I>&gt;<i> punishment. In this case, I'm looking to broadcast a message 
</I>&gt;<i> from one client 
</I>&gt;<i> to other connected clients. I came up with a solution, but I 
</I>&gt;<i> wanted to run it 
</I>&gt;<i> by you guys to see whether what I'm doing is The Right Way To 
</I>&gt;<i> Do Things.
</I>&gt;<i> 
</I>&gt;<i> Here's what I did for my simple prototype that takes any 
</I>&gt;<i> message received from 
</I>&gt;<i> a client and sends it to all clients (including the sender):
</I>&gt;<i> 
</I>&gt;<i> -----------
</I>&gt;<i> 
</I>&gt;<i> factory = Factory()
</I>&gt;<i> factory.transports = []
</I>&gt;<i> 
</I>&gt;<i> class Chatterbox(Protocol):
</I>&gt;<i> 
</I>&gt;<i>     def connectionMade(self):
</I>&gt;<i> 	# Make a copy of the new connection's transport and
</I>&gt;<i> 	# stick it somewhere all the Chatterbox instances can
</I>&gt;<i> 	# get to it.
</I>&gt;<i>         self.factory.transports.append(self.transport)
</I>&gt;<i> 
</I>&gt;<i>     def dataReceived(self, data):
</I>&gt;<i> 	# Every time a piece of data comes in, just write it back
</I>&gt;<i> 	# out to all the transports, ergo, clients.
</I>&gt;<i>         for transport in self.factory.transports:
</I>&gt;<i>              transport.write(data)
</I>&gt;<i> 
</I>&gt;<i>     def connectionLost(self, reason):
</I>&gt;<i> 	# When a client disconnects, delete the copy of their
</I>&gt;<i> 	# transport. Bet this'll be slow w/ lotso clients.
</I>&gt;<i>         self.factory.transports.remove(self.transport)
</I>&gt;<i> 
</I>&gt;<i> factory.protocol = Chatterbox
</I>&gt;<i> reactor.listenTCP(8008, factory)
</I>&gt;<i> reactor.run()
</I>&gt;<i> 
</I>&gt;<i> -----------
</I>&gt;<i> 
</I>&gt;<i> What do you think? Is this a properly twisted way to do 
</I>&gt;<i> things? Strike anyone 
</I>&gt;<i> as needlessly inefficient? I'm motivated to make it as fast 
</I>&gt;<i> as possible, so 
</I>&gt;<i> despite what Knuth said, any proferred optimizations would be 
</I>&gt;<i> great to hear. 
</I>&gt;<i> (On a related note, I intend to put the for loop into a map, 
</I>&gt;<i> but I haven't 
</I>&gt;<i> yet embarked on language optimizations, and this question's 
</I>&gt;<i> more about 
</I>&gt;<i> Twisted.)
</I>&gt;<i> 
</I>&gt;<i> Also, I'm obviously, and perhaps incorrectly, assuming that 
</I>&gt;<i> once a transport 
</I>&gt;<i> object is created, it never gets changed. If it does, the 
</I>&gt;<i> copy I made won't 
</I>&gt;<i> be updated -- is this a problem?
</I>&gt;<i> 
</I>&gt;<i> A definite problem with this method is that it sends the data 
</I>&gt;<i> right back to 
</I>&gt;<i> the sender, which actually isn't desirable for my 
</I>&gt;<i> application. Trouble is, to 
</I>&gt;<i> avoid it I think I'd have to do this...
</I>&gt;<i> 
</I>&gt;<i>     def dataReceived(self, data):
</I>&gt;<i>         for transport in self.factory.transports:
</I>&gt;<i> 		if transport != self.transport:
</I>&gt;<i> 	             transport.write(data)
</I>&gt;<i> 
</I>&gt;<i> Seems an inefficient way to do things, as I'd like this 
</I>&gt;<i> server to handle 
</I>&gt;<i> thousands of clients.
</I>&gt;<i> 
</I>&gt;<i> Anyway, any help would be appreciated. :-)
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> 
</I>&gt;<i> Steve
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="039889.html">[Twisted-Python] The right way to broadcast to your TCP/IP clients?
</A></li>
	<LI>Next message (by thread): <A HREF="039893.html">[Twisted-Python] Re: Twisted Euphrates (Modified by Glyph Lefkowitz)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39890">[ date ]</a>
              <a href="thread.html#39890">[ thread ]</a>
              <a href="subject.html#39890">[ subject ]</a>
              <a href="author.html#39890">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
