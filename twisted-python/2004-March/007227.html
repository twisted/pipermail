<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] tracking spawned jobs in a twisted application (code review request)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20tracking%20spawned%20jobs%20in%20a%20twisted%20application%20%28code%20review%20request%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007231.html">
   <LINK REL="Next"  HREF="007228.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] tracking spawned jobs in a twisted application (code review request)</H1>
    <B>Schneider, Michael</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20tracking%20spawned%20jobs%20in%20a%20twisted%20application%20%28code%20review%20request%29&In-Reply-To="
       TITLE="[Twisted-Python] tracking spawned jobs in a twisted application (code review request)">michael.l.schneider at ugsplm.com
       </A><BR>
    <I>Mon Mar  1 11:28:26 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007231.html">[Twisted-Python] SSH connection, redux!
</A></li>
        <LI>Next message: <A HREF="007228.html">[Twisted-Python] RE: tracking spawned jobs in a twisted application (code review request)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7227">[ date ]</a>
              <a href="thread.html#7227">[ thread ]</a>
              <a href="subject.html#7227">[ subject ]</a>
              <a href="author.html#7227">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello All,

I have been pushing some code around.

My problem is that I need to execute OS command line
jobs with twisted.

I started by morphing the twisted tutorial app into a
job runner.


My first path (It was wrong!!) was to morph the database connection
pool to a compute pool using popen2.

This group, suggested that I use reactor.spawn instead of popen2 .

Attached is the resulting code.  

Basic Approach for Command protocol.processProtocol:

1) crate a JobPool Object to manage list of running jobs
2) Create Job Runner Object to wrap individual process info,
   and capture process output.
   (start time, stop time ...)
3) Create CmdProcProtcol  to manage interaction with the reactor


I morphed the twisted application: (Coded in comment section below)
	1) Create JobPoolService
	2) Create JobRunnerProtocol
	3) Create XmlRpc Job Runner Interface that dispatches to job runner service.



My questions are:
	- Is the the twisted way?
      - What are some alternative approaches?
	- Is there a better way?

Thank you very much,
Mike
 
----------------------------------------------------------------
Michael Schneider
Senior Software Engineering Consultant
UGS PLM Solutions - an EDS Company
 
&quot;The Greatest Performance Improvement Is the transitioning from a non-working state to the working state&quot;


&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>
</I>&gt;<i> [mailto:<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>]On Behalf Of 
</I>&gt;<i> Schollnick,
</I>&gt;<i> Benjamin
</I>&gt;<i> Sent: Monday, March 01, 2004 10:26 AM
</I>&gt;<i> To: '<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>'
</I>&gt;<i> Subject: RE: [Twisted-Python] SSH connection, redux!
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Folks,
</I>&gt;<i> 
</I>&gt;<i> 	Thanks for the support, so far...  I downloaded the
</I>&gt;<i> precompiled version of the PyCrypto and everything is working fine...
</I>&gt;<i> 
</I>&gt;<i> 	Except for the fact, that I am attempting to figure out
</I>&gt;<i> how to make this work the way, that I *believe* it needs to work...
</I>&gt;<i> 
</I>&gt;<i> 	By the way, I was unable to get the &quot;Writing a client with 
</I>&gt;<i> Twisted.Conch&quot; FAQ to work....  I did find the sshSimpleClient.py
</I>&gt;<i> example, and that is working okay...
</I>&gt;<i> 
</I>&gt;<i> 	But I am having a problem, trying to figure out how to 
</I>&gt;<i> adapt the 
</I>&gt;<i> reactor model with my program...
</I>&gt;<i> 
</I>&gt;<i> 	The application has, for example, 6 &quot;ssh queries&quot; that 
</I>&gt;<i> it needs to
</I>&gt;<i> send, for example a &quot;/usr/sbin/prtconf -v&quot;, and then 
</I>&gt;<i> &quot;capture&quot; the output,
</I>&gt;<i> and return the output
</I>&gt;<i> for processing...
</I>&gt;<i> 
</I>&gt;<i> 	Then it proceeds to the next query....etc...
</I>&gt;<i> 
</I>&gt;<i> 	Is there a method that I can setup the communication, 
</I>&gt;<i> and say....
</I>&gt;<i> 
</I>&gt;<i> reactor.send (&quot;asdfasdf&quot;)
</I>&gt;<i> data = reactor.recv ()
</I>&gt;<i> 
</I>&gt;<i> 	More along the telnetlib design?  This way, I could branch the
</I>&gt;<i> telnet code
</I>&gt;<i> I use?
</I>&gt;<i> 
</I>&gt;<i> 	Once, I start the reactor, I do not see where I can get 
</I>&gt;<i> data in and
</I>&gt;<i> out,
</I>&gt;<i> without using some form of a global variable...  (Or 
</I>&gt;<i> embedding the reactor
</I>&gt;<i> inside
</I>&gt;<i> another object)
</I>&gt;<i> 
</I>&gt;<i> 				- Benjamin
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007231.html">[Twisted-Python] SSH connection, redux!
</A></li>
	<LI>Next message: <A HREF="007228.html">[Twisted-Python] RE: tracking spawned jobs in a twisted application (code review request)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7227">[ date ]</a>
              <a href="thread.html#7227">[ thread ]</a>
              <a href="subject.html#7227">[ subject ]</a>
              <a href="author.html#7227">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
