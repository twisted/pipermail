<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Soon to be not-a-newbie?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Soon%20to%20be%20not-a-newbie%3F&In-Reply-To=%3C200801261251.34563.maarten%40treewalker.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="049166.html">
   <LINK REL="Next"  HREF="049168.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Soon to be not-a-newbie?</H1>
    <B>Maarten ter Huurne</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Soon%20to%20be%20not-a-newbie%3F&In-Reply-To=%3C200801261251.34563.maarten%40treewalker.org%3E"
       TITLE="[Twisted-Python] Soon to be not-a-newbie?">maarten at treewalker.org
       </A><BR>
    <I>Sat Jan 26 04:51:27 MST 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="049166.html">[Twisted-Python] Soon to be not-a-newbie?
</A></li>
        <LI>Next message (by thread): <A HREF="049168.html">[Twisted-Python] Soon to be not-a-newbie?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49167">[ date ]</a>
              <a href="thread.html#49167">[ thread ]</a>
              <a href="subject.html#49167">[ subject ]</a>
              <a href="author.html#49167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Saturday 26 January 2008, Tristan Seligmann wrote:
&gt;<i> * Nitro &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">nitro at dr-code.org</A>&gt; [2008-01-25 23:42:41 +0100]:
</I>&gt;<i> &gt;&gt;&gt; the recent spate of inlineCallbacks-related posts alarms me.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Why? Using inlineCallbacks just helps writing convenient syntax
</I>&gt;<i> &gt; utilizing deferreds. If you ever wrote code which uses lots of
</I>&gt;<i> &gt; deferreds, you know that the code is (visually) lacking a decent
</I>&gt;<i> &gt; structure. It's just not the way you think and makes things hard to
</I>&gt;<i> &gt; read. inlineCallbacks just turns this into a nice, linear piece of code
</I>&gt;<i> &gt; again (linear not to be confused with synchronous!).
</I>&gt;<i>
</I>&gt;<i> The problem I have with this is that I find that it actually obscures
</I>&gt;<i> the flow of the code and data.
</I>
The low-level flow of code (control going back to the reactor) is obscured, 
but I think that is an advantage rather than a disadvantage, since the 
high-level flow of code (the sequence of operations) becomes more clear. 
The flow of data is explicit in both cases: it is either passed as callback 
parameters or as return values from &quot;yield&quot;.

&gt;<i> Most deferred operations have no need to 
</I>&gt;<i> be serialized, and shouldn't be; the linear nature of
</I>&gt;<i> inlineCallbacks-style makes it very easy to accidentally serialize
</I>&gt;<i> operations that could otherwise run in parallel instead. Even if you
</I>&gt;<i> write the generator correctly, it's not as obvious what the actual flow
</I>&gt;<i> is since it has been crunched into a linear-looking function.
</I>
There are quite a few cases in which the dependencies between the operations 
force sequential processing. In those cases, inline callbacks are useful.

For example, to serve a web page, I want to authenticate the user, then run 
a database query and finally present the result. Running the query before 
authenticating the user is not something I'd recommend. In some cases it 
might be possible to start presenting results before all queries are 
finished, but in many cases that is not worth the complexity.

Writing all your routines as inline callbacks without thinking about the 
dependencies is a bad idea though.

&gt;<i> Finally, 
</I>&gt;<i> it is extremely hard to unit test a generator using inlineCallbacks, as
</I>&gt;<i> there is no easy way of resuming the generator at certain points with
</I>&gt;<i> certain state to test each part of the generator.
</I>
If the code using inline callbacks looks like this, there is no problem in 
testing the parts separately:

	result1 = yield function1(arg)
	result2 = yield function2(result1)

&gt;<i> I'm not necessarily convinced that inlineCallbacks is always bad, but it
</I>&gt;<i> certainly leads to subtle traps in most cases, while providing little
</I>&gt;<i> real benefit (despite the perceived benefit).
</I>
I've converted some routines I wrote before Twisted 2.5 to inline callbacks 
and it became a lot easier for me to read. Like any tool, it can be used or 
abused, but I definately think it has its uses.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part.
URL: &lt;/pipermail/twisted-python/attachments/20080126/9eec3050/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="049166.html">[Twisted-Python] Soon to be not-a-newbie?
</A></li>
	<LI>Next message (by thread): <A HREF="049168.html">[Twisted-Python] Soon to be not-a-newbie?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49167">[ date ]</a>
              <a href="thread.html#49167">[ thread ]</a>
              <a href="subject.html#49167">[ subject ]</a>
              <a href="author.html#49167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
