<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How can I make twisted and dbus work together?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20can%20I%20make%20twisted%20and%20dbus%20work%20together%3F&In-Reply-To=%3C478DED2C.8030709%40pollenation.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="049090.html">
   <LINK REL="Next"  HREF="049121.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How can I make twisted and dbus work together?</H1>
    <B>Matt Goodall</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20can%20I%20make%20twisted%20and%20dbus%20work%20together%3F&In-Reply-To=%3C478DED2C.8030709%40pollenation.net%3E"
       TITLE="[Twisted-Python] How can I make twisted and dbus work together?">matt at pollenation.net
       </A><BR>
    <I>Wed Jan 16 04:40:28 MST 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="049090.html">[Twisted-Python] How can I make twisted and dbus work together?
</A></li>
        <LI>Next message (by thread): <A HREF="049121.html">[Twisted-Python] How can I make twisted and dbus work together?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49091">[ date ]</a>
              <a href="thread.html#49091">[ thread ]</a>
              <a href="subject.html#49091">[ subject ]</a>
              <a href="author.html#49091">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matt Goodall wrote:
&gt;<i> Matt Goodall wrote:
</I>&gt;&gt;<i> Justin Warren wrote:
</I>&gt;&gt;&gt;<i> On Wed, 2008-01-16 at 17:28 +1100, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">hwan2265 at mail.usyd.edu.au</A> wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> But when I was running my code, I got a error:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Traceback (most recent call last):
</I>&gt;&gt;&gt;&gt;<i>   File &quot;dbustwisted.py&quot;, line 5, in &lt;module&gt;
</I>&gt;&gt;&gt;&gt;<i>     glib2reactor.install()
</I>&gt;&gt;&gt;&gt;<i>   File &quot;/usr/lib/python2.5/site-packages/twisted/internet/glib2reactor.py&quot;,
</I>&gt;&gt;&gt;&gt;<i> line 33, in install
</I>&gt;&gt;&gt;&gt;<i>     return gtk2reactor.install(False)
</I>&gt;&gt;&gt;&gt;<i>   File &quot;/usr/lib/python2.5/site-packages/twisted/internet/gtk2reactor.py&quot;,
</I>&gt;&gt;&gt;&gt;<i> line 270, in install
</I>&gt;&gt;&gt;&gt;<i>     installReactor(reactor)
</I>&gt;&gt;&gt;&gt;<i>   File &quot;/usr/lib/python2.5/site-packages/twisted/internet/main.py&quot;, line
</I>&gt;&gt;&gt;&gt;<i> 24, in installReactor
</I>&gt;&gt;&gt;&gt;<i>     &quot;reactor already installed&quot;
</I>&gt;&gt;&gt;&gt;<i> AssertionError: reactor already installed
</I>&gt;&gt;&gt;<i> I suspect your problem may be here:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> if __name__ == &quot;__main__&quot;:
</I>&gt;&gt;&gt;&gt;<i>     from twisted.internet import glib2reactor
</I>&gt;&gt;&gt;&gt;<i>     glib2reactor.install()
</I>&gt;&gt;&gt;&gt;<i>     ################################################
</I>&gt;&gt;&gt;&gt;<i>     # I added the 2 lines here and made the program crash
</I>&gt;&gt;&gt;&gt;<i>     ################################################
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>     from twisted.internet import reactor
</I>&gt;&gt;&gt;<i>       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> You've already imported glib2reactor, so you shouldn't import the
</I>&gt;&gt;&gt;<i> default reactor as well. Try removing this line.
</I>&gt;&gt;<i> Actually, twisted.internet.reactor is quite magic. It is always the
</I>&gt;&gt;<i> installed reactor. However, if there is no reactor installed the first
</I>&gt;&gt;<i> time it is imported it will automatically install the default (select)
</I>&gt;&gt;<i> reactor.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I suspect that the real cause of the problem is that something is doing
</I>&gt;&gt;<i> a &quot;from twisted.internet import reactor&quot;, causing the select reactor to
</I>&gt;&gt;<i> be installed, before the above code is getting the chance to install the
</I>&gt;&gt;<i> glib2reactor.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Looking at the code it must be a Twisted module that is the culprit.
</I>&gt;<i> 
</I>&gt;<i> And the offending module is ... twisted.protocols.policies. Attached is
</I>&gt;<i> a patch (I'll submit it to Trac as a ticket, too.)
</I>

Grepping the Twisted code suggests this is a &quot;problem&quot; that is not
really worth trying to fix fully. It's probably best to just avoid the
problem by making sure you get to install your choice of reactor before
anything else.

Of course, if you use the twistd daemon installing a specific reactor at
the correct time is easy, by using the --reactor flag.


- Matt



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="049090.html">[Twisted-Python] How can I make twisted and dbus work together?
</A></li>
	<LI>Next message (by thread): <A HREF="049121.html">[Twisted-Python] How can I make twisted and dbus work together?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49091">[ date ]</a>
              <a href="thread.html#49091">[ thread ]</a>
              <a href="subject.html#49091">[ subject ]</a>
              <a href="author.html#49091">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
