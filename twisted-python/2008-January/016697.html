<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Help with Simple Trial unit test
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Help%20with%20Simple%20Trial%20unit%20test&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016696.html">
   <LINK REL="Next"  HREF="016703.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Help with Simple Trial unit test</H1>
    <B>Shawn Smiley</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Help%20with%20Simple%20Trial%20unit%20test&In-Reply-To="
       TITLE="[Twisted-Python] Help with Simple Trial unit test">ssmiley483 at yahoo.com
       </A><BR>
    <I>Wed Jan 30 17:16:10 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="016696.html">[Twisted-Python] Help with Simple Trial unit test
</A></li>
        <LI>Next message: <A HREF="016703.html">[Twisted-Python] Re: [Twisted-commits] r22428 - Deprecation API for functions and methods.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16697">[ date ]</a>
              <a href="thread.html#16697">[ thread ]</a>
              <a href="subject.html#16697">[ subject ]</a>
              <a href="author.html#16697">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks a bunch Jean-Paul!!!

That was exactly my problem.

I replaced the reactor.run() line with &quot;return d&quot; and everything works perfectly.

So I guess the lesson here is that if a unit test creates a defer it needs to return that defer for everything to be hooked up properly and execute.


----- Original Message ----
From: Jean-Paul Calderone &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at divmod.com</A>&gt;
To: Twisted general discussion &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&gt;
Sent: Wednesday, January 30, 2008 2:01:34 PM
Subject: Re: [Twisted-Python] Help with Simple Trial unit test


On 
Wed, 
30 
Jan 
2008 
13:45:08 
-0800 
(PST), 
Shawn 
Smiley 
&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">ssmiley483 at yahoo.com</A>&gt; 
wrote:
&gt;<i>Hi 
</I>all,
&gt;<i>
</I>&gt;<i>I 
</I>recently 
started 
learning 
Python 
&amp; 
Twisted 
in 
prep 
for 
a 
big 
project 
at 
work.  
So 
far 
things 
are 
going 
well, 
except 
that 
I 
can't 
quite 
figure 
out 
what 
I'm 
doing 
wrong 
in 
this 
simple 
unit 
test 
I'm 
writing.
&gt;<i>
</I>&gt;<i>One 
</I>of 
the 
features 
of 
the 
project 
I'll 
be 
working 
on 
is 
the 
implementation 
of 
a 
simple 
HTTP 
GET 
Based 
communication 
layer 
between 
legacy 
systems.  
As 
such, 
I 
wanted 
to 
write 
a 
simple 
unit 
test 
that 
uses 
the 
twisted 
client.getPage() 
method 
to 
test 
the 
communication 
process 
(i.e. 
simulates 
a 
legacy 
system 
requesting 
data 
from 
the 
server).
&gt;<i>
</I>&gt;<i>I 
</I>have 
a 
test 
that 
sort 
of 
works.  
However, 
I 
find 
that 
I 
have 
to 
add 
a 
reactor.run() 
command 
in 
the 
unit 
test 
for 
the 
test 
to 
actually 
be 
executed.  
The 
unfortunate 
side 
affect 
of 
this 
is 
that 
you 
then 
have 
to 
ctrl+C 
to 
stop 
the 
reactor 
after 
the 
test 
runs.  
If 
I 
don't 
put 
in 
the 
reactor.run() 
command, 
I 
get 
a 
&quot;REACTOR 
UNCLEAN&quot; 
error 
message 
and 
the 
test 
doesn't 
appear 
to 
run 
(at 
least 
the 
callbacks 
from 
getPage() 
never 
happen).

What 
happens 
if 
you 
take 
the 
Deferred 
created 
in 
the 
test 
method 
and 
return
it, 
instead 
of 
calling 
reactor.run()?

Jean-Paul

_______________________________________________
Twisted-Python 
mailing 
list
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>





      ____________________________________________________________________________________
Be a better friend, newshound, and 
know-it-all with Yahoo! Mobile.  Try it now.  <A HREF="http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ">http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ</A> 



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016696.html">[Twisted-Python] Help with Simple Trial unit test
</A></li>
	<LI>Next message: <A HREF="016703.html">[Twisted-Python] Re: [Twisted-commits] r22428 - Deprecation API for functions and methods.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16697">[ date ]</a>
              <a href="thread.html#16697">[ thread ]</a>
              <a href="subject.html#16697">[ subject ]</a>
              <a href="author.html#16697">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
