From gtwist at nixel.mine.nu  Sat Nov  1 05:41:18 2003
From: gtwist at nixel.mine.nu (Kev)
Date: Sat, 1 Nov 2003 05:41:18 -0500
Subject: [Twisted-Python] connectTCP/listenTCP socks/ssh
Message-ID: <20031101104118.GA21085@nixel.mine.nu>

I'm writing a socks proxy that uses ssh tunnels for connections, I can
get it working by making my connectClass listenTCP with a
forwarding.SSHListenForwardingFactory and then ClientCreator a
SOCKSv4Outgoing to connectTCP, but obviously that's a bad method. 

How can I cut the listen/connect? Is there a way I can do it at that
level or do I need to implement my own .connectSSH method?

It seems I need to get both sides placed in the reactor somehow,
but SSHChannel.conn doesn't have a fileno() so addReader doesn't accept it.
(Is addReader the right function? I found it in the curses example and
 am assuming it's just a generic file descriptor handler)

Thanks much



From z3p at twistedmatrix.com  Sat Nov  1 13:39:46 2003
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Sat, 01 Nov 2003 13:39:46 -0500
Subject: [Twisted-Python] connectTCP/listenTCP socks/ssh
In-Reply-To: <20031101104118.GA21085@nixel.mine.nu>
References: <20031101104118.GA21085@nixel.mine.nu>
Message-ID: <1067711986.7649.4.camel@petra>

On Sat, 2003-11-01 at 05:41, Kev wrote:
> I'm writing a socks proxy that uses ssh tunnels for connections, I can
> get it working by making my connectClass listenTCP with a
> forwarding.SSHListenForwardingFactory and then ClientCreator a
> SOCKSv4Outgoing to connectTCP, but obviously that's a bad method. 

You should definatly look at adding this feature to Conch when you
finish it.  That's been on the TODO list for a while.

> How can I cut the listen/connect? Is there a way I can do it at that
> level or do I need to implement my own .connectSSH method?

Basically, you're going to want to override SOCKSv4.connectClass and
SOCKSv4.listenClass.  connectClass returns a Deferred that is called
back with an unused value.  listenClass returns a Deferred that is
called back with a tuple of (host, port) that is being listened on.

-p
-- 
      Paul Swartz
(o_   z3p at twistedmatrix dot com
//\   http://www.twistedmatrix.com/users/z3p.twistd/
V_/_  AIM: Z3Penguin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031101/c83e7eb2/attachment.pgp 

From gtwist at nixel.mine.nu  Sat Nov  1 15:00:24 2003
From: gtwist at nixel.mine.nu (Kev)
Date: Sat, 1 Nov 2003 15:00:24 -0500
Subject: [Twisted-Python] connectTCP/listenTCP socks/ssh
In-Reply-To: <1067711986.7649.4.camel@petra>
References: <20031101104118.GA21085@nixel.mine.nu> <1067711986.7649.4.camel@petra>
Message-ID: <20031101200024.GA31082@nixel.mine.nu>

On Sat, Nov 01, 2003 at 01:39:46PM -0500, Paul Swartz wrote:
> You should definatly look at adding this feature to Conch when you
> finish it.  That's been on the TODO list for a while.

I got it working this morning, I'll add to to conch (I assume you mean
the conch.py in the scripts directory?) and submit it. It
actually wasn't difficult, well the program is like 60 lines, but it took me
a good 12 hours of keyboard time to write and pleanty of idle brian
cycles. (But part of that was just because I'm new to twisted and
python)





From mcfletch at rogers.com  Sun Nov  2 13:56:15 2003
From: mcfletch at rogers.com (Mike C. Fletcher)
Date: Sun, 02 Nov 2003 13:56:15 -0500
Subject: [Twisted-Python] SNMPProtocol, request for review...
Message-ID: <3FA5534F.4030100@rogers.com>

I've built an SNMP Protocol for Twisted (based on a pattern from Patrick 
K. O'Brien), but as I'm a rather new Twisted developer, I'm wondering if 
someone more "in the know" could take a look at the package and see if I 
got the "ideas" right.  That is, whether I'm going about the entire 
thing incorrectly/correctly, or whether I've missed anything that would 
be obvious to an experienced twisted developer.

The protocol provides for sending get, getnext and getbulk requests, but 
doesn't yet support trap or answering any query (i.e. in SNMP-eese it's 
a manager-only protocol at the moment, not an agent-side protocol).

I'm particularly interested in:

    * whether the timeouts are handled properly (we do a crude callLater
      and check for deferred.called for them), is there a more elegant
      Twisted mechanism for handling timed-out operations?
    * whether the message IDs are handled properly (we just store all
      "live" messages in a dictionary and delete them when they are
      timed out or responded to), is there some more elegant Twisted
      solution?
    * whether the entire approach is okay. I put most of the code and
      API on the protocol object, with a helper object for managing
      tabular downloads.  Is there a more "Twisted" way of doing this? 
      Should the get method on the protocol be implemented as a separate
      object driving the protocol as well?  What should be in the
      "protocol" level, (as opposed to higher-level "application" code)?

Package is here:
    http://members.rogers.com/mcfletch/programming/TwistedSNMP-0.1.tar.gz
It requires pysnmp-3.3.5, available here:
    http://download.sourceforge.net/pysnmp/

You'll need an SNMP agent against which to test (as well as some OIDs 
for that agent), as the ips in the scripts won't work without the proper 
community IDs (or from unrecognised manager IPs, for that matter).

Feedback appreciated,
Mike

_______________________________________
  Mike C. Fletcher
  Designer, VR Plumber, Coder
  http://members.rogers.com/mcfletch/






From andrew-twisted at puzzling.org  Sun Nov  2 17:20:27 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 3 Nov 2003 09:20:27 +1100
Subject: [Twisted-Python] SNMPProtocol, request for review...
In-Reply-To: <3FA5534F.4030100@rogers.com>
References: <3FA5534F.4030100@rogers.com>
Message-ID: <20031102222027.GA4320@frobozz>

On Sun, Nov 02, 2003 at 01:56:15PM -0500, Mike C. Fletcher wrote:
> I'm particularly interested in:
> 
>    * whether the timeouts are handled properly (we do a crude callLater
>      and check for deferred.called for them), is there a more elegant
>      Twisted mechanism for handling timed-out operations?

I haven't yet looked at your code, but there is a .setTimeout method on
Deferreds that sounds applicable here.  By default it will errback your
deferred with a defer.TimeoutError, but you can pass in a custom timeoutFunc
if necessary.

One thing to watch out for when using setTimeout is that you need to wrap
your calls to d.callback/d.errback in try/except defer.AlreadyCalledError,
in case the timeout does happen (alternatively you could pass in a
timeoutFunc that arranges for whatever would call callback/errback to be
cancelled, but that might be harder).  This is probably already the case
with your existing timeouts, though.

>    * whether the message IDs are handled properly (we just store all
>      "live" messages in a dictionary and delete them when they are
>      timed out or responded to), is there some more elegant Twisted
>      solution?

Again, I haven't looked at your code, but that sounds ok to me :)

-Andrew.




From sam at twistedmatrix.com  Mon Nov  3 08:41:14 2003
From: sam at twistedmatrix.com (Sam Jordan)
Date: Mon, 3 Nov 2003 23:41:14 +1000
Subject: [Twisted-Python] Adapting RemoteReferences
Message-ID: <20031103134114.GA9164@twistedmatrix.com>

Hi,

What is the general opinion on having a standard way to adapt
RemoteReferences to specific interfaces which basically just
wraps callRemote for each respective method?

The reason i'm bringing this up is I can imagine various
use-cases for wanting to treat remote objects and local objects
as semantically equivalent. For example, I may be employing
the observer pattern for a simple system to separate UI components
from data components. Currently if I wish to have both remote and
local observers interoperate I would have to either store them
in separate data structures and treat each differently when
sending notifications, or, I could store them in a single
data structure and use appropriate type-checking to dispatch the
calls. IMHO both of these solutions are relatively ugly.

Whether or not there are sufficient use-cases for a standard twisted
way to do this is another story, so i'm wondering what the views of
people are on this subject. Certainly one could just register their own
adapter for RemoteReference in each case, but the code to do this is rather
ugly and for those that _do_ have to deal with such cases I think it would
be nicer to have a simple, standard way of doing it,
e.g. remoteRef.adaptTo(Interface).

I've written a function that outlines the functionality I think it should
provide which is included below; while this implementation is rather ugly
i'm more worried about the idea rather than how it would eventually be
implemented if someone decides this is worth having.

Of course, there are certain constraints, such as the method wrappers
having no way of knowing if the remote object actually implements the
desired interface or not, but I don't see this as a problem for something
that already requires string based dispatch. I guess you could say this
proposal is somewhat similar to java's 'stub' approach, only it doesn't
force it :-).

Cheers,

Sam.

------------------------------------------
import types

class Interface:
  def add(x,y): pass
  def mul(x,y): pass

class Interface2(Interface):
  def div(x,y): pass
  def sub(x,y): pass

class Foo:
  def callRemote(self, name, *args, **kw): print 'calling %s with %s %s' % (name, args, kw)

# this would likely put put in RemoteReference
# to provide context
def adaptTo(self, interface):
    # obtain all interface methods
    methods = interface.__dict__
    for base in interface.__bases__:
        for attrib,val in base.__dict__.iteritems():
            if not methods.has_key(attrib) and isinstance(val, types.FunctionType):
                methods[attrib] = base.__dict__[attrib]

    class _Adapter:
        def __init__(self, original): self.original = original

        for m in methods:
            exec "def %s(self, *args, **kw): return self.original.callRemote('%s', *args, **kw)" % (m,m)

    del _Adapter.m
    del _Adapter.methods
    return _Adapter(self)

def test():
    a = adaptTo(Foo(), Interface2)
    a.add(1,2)
    a.mul(2,4)
    a.div(8,4)
    a.sub(3,5)

test()

------------------------------------------



From ted at powersdk.com  Mon Nov  3 07:03:48 2003
From: ted at powersdk.com (Ted Patrick)
Date: Mon, 3 Nov 2003 07:03:48 -0500
Subject: [Twisted-Python] Socket Read Write
Message-ID: <000b01c3a202$8b1f6270$6401a8c0@ISLAND>

I am writing a chat socket server and need to make sure that there are no
conflicts when writing to other attached clients. I am concerned that when
the server receives lots of messages from many socket connections, several
sockets may encounter write contention. 

Is there a queue for the write method of a socket? 
Should one expect errors in this regard?
Does the Twisted architecture eliminate this class of error?
Using twisted.protocol.basic can 2 lineReceived events happen
simultaneously? How is this addressed?

Thanks,

Theodore E. Patrick
PowerSDK - Code for a distributed world
http://www.powersdk.com
 




From andrew-twisted at puzzling.org  Mon Nov  3 07:24:27 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 3 Nov 2003 23:24:27 +1100
Subject: [Twisted-Python] Socket Read Write
In-Reply-To: <000b01c3a202$8b1f6270$6401a8c0@ISLAND>
References: <000b01c3a202$8b1f6270$6401a8c0@ISLAND>
Message-ID: <20031103122427.GA5467@frobozz>

On Mon, Nov 03, 2003 at 07:03:48AM -0500, Ted Patrick wrote:
> I am writing a chat socket server and need to make sure that there are no
> conflicts when writing to other attached clients. I am concerned that when
> the server receives lots of messages from many socket connections, several
> sockets may encounter write contention. 

Twisted's network code is single-threaded.  Only one event is processed at
once, so the answers to your questions are:

> Is there a queue for the write method of a socket? 

No -- there doesn't need to be.  The transport will buffer any write that
isn't immediately writeable without blocking, but because you never do this
from more than one thread at a time, there are no possible races here.

> Should one expect errors in this regard?

Nope :)

> Does the Twisted architecture eliminate this class of error?

Yep :)

> Using twisted.protocol.basic can 2 lineReceived events happen
> simultaneously? How is this addressed?

They can't happen simultaneously. :)

If you are using threads in your Twisted app, be sure to read:
    http://twistedmatrix.com/documents/howto/threading

-Andrew.




From exarkun at intarweb.us  Mon Nov  3 07:43:10 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Mon, 3 Nov 2003 07:43:10 -0500
Subject: [Twisted-Python] Adapting RemoteReferences
In-Reply-To: <20031103134114.GA9164@twistedmatrix.com>
References: <20031103134114.GA9164@twistedmatrix.com>
Message-ID: <20031103124310.GA8435@intarweb.us>

On Mon, Nov 03, 2003 at 11:41:14PM +1000, Sam Jordan wrote:
> Hi,
> 
> What is the general opinion on having a standard way to adapt
> RemoteReferences to specific interfaces which basically just
> wraps callRemote for each respective method?
> 

  I think the preferred approach is the opposite.  Instead of taking remote
references and trying to treat them as local, take local references and
treat them as remote (this makes sense from an interface enforcement
consistency point of view, too -- it's easier to throw away some information
than you have than to pull information you don't have out of thin air).

  See twisted.spread.util.LocalAsyncForwarder.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031103/f189cfc4/attachment.pgp 

From sam at twistedmatrix.com  Mon Nov  3 20:59:04 2003
From: sam at twistedmatrix.com (Sam Jordan)
Date: Tue, 4 Nov 2003 11:59:04 +1000
Subject: [Twisted-Python] Adapting RemoteReferences
In-Reply-To: <20031103124310.GA8435@intarweb.us>
References: <20031103134114.GA9164@twistedmatrix.com> <20031103124310.GA8435@intarweb.us>
Message-ID: <20031104015904.GA10300@twistedmatrix.com>

Hi,

Thanks for the response Jp ...

On Mon, Nov 03, 2003 at 07:43:10AM -0500, Jp Calderone wrote:
>   I think the preferred approach is the opposite.  Instead of taking remote
> references and trying to treat them as local, take local references and
> treat them as remote (this makes sense from an interface enforcement
> consistency point of view, too -- it's easier to throw away some information
> than you have than to pull information you don't have out of thin air).

Indeed, this does make more sense, I don't know why I didn't think of it in this
way. The way you have described also takes care of emulating the Deferred result
instead of having to specify it as part of the interface as well.

On the other hand, you still end up with basically the same level of interface
enforcement; that is, you can guarantee the interface characteristics of local
objects but not remote objects. This is unlikely to change however, without either
the protocol changing (unlikely - "did somebody mention IDL? :-)") or people obeying
their own interface definition conventions. Still, I can certainly see your point that
publishing an object as implementing an interface when it possibly doesn't is worse
than wrapping a local object with a single string-based dispatching method. 

Other small differences I can think of are that in cases where a system has already
been written and a remote interface is being provided, it may be easier to make
chanes to the effect of:

    # part of remote system wrapper class
    def remote_addObserver(self, observer):
        underlyingSystem.addObserver(observer.adaptTo(IUserInterface))

    # part of the underlying system
    # (code that was written prior to considering a remote interface)
    def addObserver(self, observer): self.observers.append(observer)

So if the underlying system was built without a remote interface in mind
it may be easier to just adapt the remote refs than to change every instance
of calls to the local objects.

If it _was_ written with the knowledge that a remote interface will be placed
on top in the future, I assume the code would look something like:

    # part of remote system wraper class
    def remote_addObserver(self, observer):
        underlyingSystem.addObserver(observer)

    # part of underlying system
    def addObserver(self, observer):
        if not isinstance(observer, RemoteReference):
            observer = LocalAsyncForwarder(observer, IUserInterface)
        # rest of method ...

And then all subsequent calls would use callRemote.

I guess which one you prefer is purely a matter of style and I can
see no real disadvantages from the later approach unless of course,
the system has already been written.

>   See twisted.spread.util.LocalAsyncForwarder.

Thanks for pointing this out.

Cheers,

Sam.



From itamar at itamarst.org  Mon Nov  3 11:25:41 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 3 Nov 2003 11:25:41 -0500
Subject: [Twisted-Python] Adapting RemoteReferences
In-Reply-To: <20031104015904.GA10300@twistedmatrix.com>
References: <20031103134114.GA9164@twistedmatrix.com>
	<20031103124310.GA8435@intarweb.us>
	<20031104015904.GA10300@twistedmatrix.com>
Message-ID: <20031103112541.003c4ad9.itamar@itamarst.org>

On Tue, 4 Nov 2003 11:59:04 +1000
Sam Jordan <sam at twistedmatrix.com> wrote:

> objects but not remote objects. This is unlikely to change however,
> without either the protocol changing (unlikely - "did somebody mention
> IDL? :-)") or people obeying

The PB rewrite in warner's sandbox has (or will have, anyway) schemas
for security.

Until then, you need to do enforcement manually.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From matthew.s.hegedus at lmco.com  Mon Nov  3 11:32:07 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Mon, 03 Nov 2003 10:32:07 -0600
Subject: [Twisted-Python] Woven web question about clearing http request.args
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24FC@EMSS07M12.us.lmco.com>

I've got multiple input buttons and their view is the same logic. The logic
is delete some data on a button press, then rerender the page with the
updated data. The data it will remove depends on the unique ID of the button
pressed.  When the web page is rerendered the view gets called for each
button with the same http request, so the deletion logic will be evaluated
for each button, even though it should be evaluated for just the button that
was pressed. I don't like that. I want to clear request.args so the behavior
will be as if there was only one http event, corresponding to a single
button press. I tried "request.args.clear()", but that doesn't seem to have
the expected effect.

What's worse is when I click the browser's reload button, request.args still
has the last http request that occurred. In other words, if I click my
delete button the page will be rerendered with updated data, then if I click
the browser's reload it will try to delete more data as if I had hit on of
my delete buttons again. Can anyone help me with this problem?

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From allison at shasta.stanford.edu  Mon Nov  3 12:29:03 2003
From: allison at shasta.stanford.edu (Dennis Allison)
Date: Mon, 3 Nov 2003 09:29:03 -0800 (PST)
Subject: [Twisted-Python] design issue wrt exceptional events
Message-ID: <Pine.LNX.4.44.0311020959380.13083-100000@shasta.stanford.edu>

I need a front-end to a complex of Zope systems.  The front-end listens on
an address/port and examines incoming http transactions, and, based upon
http headers and other information, connects to one or another of the Zope
systems.  The underlying approach is straightforward -- a Listener waits 
for a http transaction, it spawns a receiver which gathers the message, 
decides what to do, spawns a sender to the destination.  When the sender
responds, the process is reversed.  

I currently use an adaptation of Antony Baxter's pydirector to do the job.
I use his asynchat version, but have found that it leaks file descriptors
in my application.  I've not tried the twisted version.

So I thought I'd try to craft a tailored, light-weight version using 
the twisted framework.  I see how to manage things when everything works, 
but what if one or another of the endpoints fails?  How do I get 
everything cleaned up?









From itamar at itamarst.org  Mon Nov  3 12:42:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 3 Nov 2003 12:42:20 -0500
Subject: [Twisted-Python] design issue wrt exceptional events
In-Reply-To: <Pine.LNX.4.44.0311020959380.13083-100000@shasta.stanford.edu>
References: <Pine.LNX.4.44.0311020959380.13083-100000@shasta.stanford.edu>
Message-ID: <20031103124220.798ee87a.itamar@itamarst.org>

On Mon, 3 Nov 2003 09:29:03 -0800 (PST)
Dennis Allison <allison at shasta.stanford.edu> wrote:

> I currently use an adaptation of Antony Baxter's pydirector to do the
> job. I use his asynchat version, but have found that it leaks file
> descriptors in my application.  I've not tried the twisted version.

Why not use the Twisted version of pydirector? If it doesn't do exactly
what you want, submit patches.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From allison at shasta.stanford.edu  Mon Nov  3 13:46:22 2003
From: allison at shasta.stanford.edu (Dennis Allison)
Date: Mon, 3 Nov 2003 10:46:22 -0800 (PST)
Subject: [Twisted-Python] design issue wrt exceptional events
In-Reply-To: <20031103124220.798ee87a.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0311031044180.13083-100000@shasta.stanford.edu>

The twisted version does nothing much different from the asyncchat 
version as far as I can see.   Both have comments about a race condition 
on closing which I suspect may be the source of my file descriptor leak.
(Actually, I think it's a socket leak... )


On Mon, 3 Nov 2003, Itamar Shtull-Trauring wrote:

> On Mon, 3 Nov 2003 09:29:03 -0800 (PST)
> Dennis Allison <allison at shasta.stanford.edu> wrote:
> 
> > I currently use an adaptation of Antony Baxter's pydirector to do the
> > job. I use his asynchat version, but have found that it leaks file
> > descriptors in my application.  I've not tried the twisted version.
> 
> Why not use the Twisted version of pydirector? If it doesn't do exactly
> what you want, submit patches.
> 
> 

-- 
Dennis Allison * Computer Systems Laboratory * Gates 227
               * Stanford University *  Stanford CA  94305
	       * (650) 723-9213 * (650) 723-0033 fax
	       * allison at shasta.stanford.edu
	       * allison at sumeru.stanford.edu





From itamar at itamarst.org  Mon Nov  3 14:14:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 3 Nov 2003 14:14:15 -0500
Subject: [Twisted-Python] design issue wrt exceptional events
In-Reply-To: <Pine.LNX.4.44.0311031044180.13083-100000@shasta.stanford.edu>
References: <20031103124220.798ee87a.itamar@itamarst.org>
	<Pine.LNX.4.44.0311031044180.13083-100000@shasta.stanford.edu>
Message-ID: <20031103141415.3242f7e6.itamar@itamarst.org>

On Mon, 3 Nov 2003 10:46:22 -0800 (PST)
Dennis Allison <allison at shasta.stanford.edu> wrote:

> The twisted version does nothing much different from the asyncchat 
> version as far as I can see.   Both have comments about a race
> condition on closing which I suspect may be the source of my file
> descriptor leak.(Actually, I think it's a socket leak... )

Nevertheless, I'd expect it'd be easier to fix a single bug than to
implement a whole program from scratch.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From lists at webcrunchers.com  Mon Nov  3 16:38:32 2003
From: lists at webcrunchers.com (John D.)
Date: Mon, 3 Nov 2003 13:38:32 -0800
Subject: [Twisted-Python] Dynamic form with twisted
In-Reply-To: <3F8C1320.8090408@twistedmatrix.com>
References: <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>
 <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>
Message-ID: <v03110715bbcc7a4da8f9@[192.168.0.3]>

>vicky lupien wrote:
>
>> I want to make a form dynamically. I don't want to use FormProcess and I 
>> do not understand very well how it works.  If someone have documentation 
>> on forms (not the one on twisted matrix), it will be appreciated.
>
>Twisted's layers are relatively well-factored internally.  If you don't 
>like our dynamic form generation tools - and believe me, I know there 
>are good reasons not to like them - you can still use the web server. 
>You can easily write a form processor which uses request.args (a 
>dictionary of HTTP form arguments) as input and produces HTML via 
>request.write.
>
>Your question seems a little vague, though: if you are looking for 
>documentation on forms in general, consider a resource like
>
>	http://www.ku.edu/~acs/docs/other/forms-intro.shtml

darn,  this was something I was also looking for,  but (sigh) that site
must be down right now,  I cannot get anything from that URL.   Would you
happen to know where I can find some good examples of forms processing I can
look at?     I'm still suffering from a lack of useful examples.  The Twisted
tutorial doesn't cover ANY examples of how to process forms pages.

I'm also looking for an implementation of a SMTP server.  A simple one,  just to show how all the components are tied together.   This is what Twisted really lacks,  documentation on how everything is tied together.   The tutorial covers some of that,  and does pretty good job,  but there are NO existing documentation on how to implement the simplest of SMTP servers,  although it appears there are alot of object that support it,  there just isn't any documentation that tell me how it's all tied together.

John





From lists at webcrunchers.com  Mon Nov  3 17:13:52 2003
From: lists at webcrunchers.com (John D.)
Date: Mon, 3 Nov 2003 14:13:52 -0800
Subject: [Twisted-Python] form and submit
In-Reply-To: <BAY1-F40OWGMhLPBLYd00012b78@hotmail.com>
Message-ID: <v03110716bbcc817657b7@[192.168.0.3]>

>I have a form with a submit button.  I want to send my data from the form in 
>a web page to an other web page.  Also, I want to check if the data is 
>correct.
>
>I'm new to twisted, so I need some help
>
>Vicky
>
>_________________________________________________________________
>MSN Messenger : discutez en direct avec vos amis !  
>http://messenger.fr.msn.ca/
>
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


Vickey,

  Here is something that could get you started.   "request.args" returns a 
dictionary of the forms data,  including buttons.

  Copy and paste this code into your Python window and run it,  and 
using your browser,  go to this URL  http://localhost:8080 and play
with it.

from twisted.web import server, resource
from twisted.internet import reactor

class Simple(resource.Resource):
	isLeaf = True
	def render(self, request):
		"""
		request.args.get('key', '') gets the forms values.  This
		"page" just prints a SUBMIT button and a text field.

		There is no actual CGI called "default.cgi",  you would have
		to handle seperate script files manually at this stage,  but
		you could handle your forms page right here.  In this example
		I have a textfield called "Field" as you see in the HTML below.

		when submitting,  this just loops back to this code,  extracts
		the forms values,  then re-renders the forms page in html before 
		it exits and loops back again.
		"""
		IP = request.getClientIP()
		html = ""
		html += "<html>Hello, world!</html><br><br>"
		html += "Keys are...<br>"
		for key in request.args.keys():
			html += "%s " % key
		html += "<br>uri = %s<br>" % request.uri
		html += "<br>method = %s<br>" % request.method
		html += "<br>path = %s<br>" % request.path
		
		field_value = request.args.get('Field', '')
		html += "<br>Field = %s<br>" % field_value
		html += "<br>ClientIP = %s<br>" % IP
		button_val = request.args.get('name_submit','')	
		html += "<br>button_val = %s<br>" % button_val
		form = """
		<FORM ACTION="default.cgi" METHOD="POST" ENCTYPE="application/x-www-form-urlencoded">
<P>Test input: <INPUT TYPE="TEXT" NAME="Field" SIZE="25"><BR>
<INPUT TYPE="SUBMIT" NAME="name_submit" VALUE="Submit">
</FORM>
		"""
		return html + form

site = server.Site(Simple())
reactor.listenTCP(8080, site)
reactor.run()





From uwe at oss4u.com  Tue Nov  4 13:19:31 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Tue, 4 Nov 2003 10:19:31 -0800
Subject: [Twisted-Python] Scaling problem
Message-ID: <200311041019.31926.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Hi guys,

is there a way to have one service start several processes ?
When using twisted everyone connecting to the server ends in the same process. 
This leads to "slowing down" when requesting information whenever a certain 
number of people go on. Each request takes some time to process and meanwhile 
the server is less responsive. I have one particularly expensive function 
that takes a bit. So if several people happen to use this function at a time 
the server slows down, up to where it takes a minute to complete.
It's not a problem of system ressources (it's a quad processor xeon server 
with plenty of RAM and ultra 320 scsi drives running only this application 
and the postgres backend). The machine has a load of 0.2 while slowing down.
Basically most of the machine is idle, since it only runs 2 processes and has 
4 processors.
Is there a way to have twisted do something like apache or postgres and split 
the incoming connection to several processes ? It's not a web application, 
I'm solely using pb.
BTW: You might suggest to break down the expensive function into smaller 
pieces - no way. It has to run in one database transaction otherwise I might 
end up with a inconsistent database - no good in finance business.

Thanks

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/p+2zjqGXBvRToM4RAiLKAKDKjRWiezqXkSLQA0P/TCCcgYwckACePksV
3qxzLR3w0x3jKgKdWf1oNTA=
=LzUM
-----END PGP SIGNATURE-----




From itamar at itamarst.org  Tue Nov  4 14:50:45 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 4 Nov 2003 14:50:45 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311041019.31926.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
Message-ID: <20031104145045.5dd33f75.itamar@itamarst.org>

On Tue, 4 Nov 2003 10:19:31 -0800
"Uwe C. Schroeder" <uwe at oss4u.com> wrote:

> BTW: You might suggest to break down the expensive function into
> smaller pieces - no way. It has to run in one database transaction
> otherwise I might end up with a inconsistent database - no good in
> finance business.

What does this expensive function do? If it's standalone, involves heavy
computation, or blocking resources, running it in a thread pool should
allow you to improve latency. In cases where it goes into C code, it
should also improve performance as it should release the GIL when doing
that.

If that isn't good enough, Quotient has some code for dispatching tasks
to multiple processes.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Tue Nov  4 15:20:46 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 04 Nov 2003 15:20:46 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311041019.31926.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
Message-ID: <3FA80A1E.6050606@twistedmatrix.com>

Uwe C. Schroeder wrote:

> Is there a way to have twisted do something like apache or postgres and split 
> the incoming connection to several processes ? It's not a web application, 
> I'm solely using pb.

This is possible, although not as easy as I'd like it to be.  In 
principle, on most UNIX-based OSes, it's possible to listen() and 
accept() in one process, pass the returned file descriptor to a 
subprocess and do communication there.  I'd like to make this automatic 
at some point, but won't have the time to do it for at least another few 
months.

The fact that it's not as graceful or automatic as I like doesn't mean 
it's impossible though.  If you want to just have one "control" process 
that shuttles around I/O and N worker processes that do the actual work, 
you can still use spawnProcess and communicate over stdin/stdout to the 
subprocesses about new connections using a simple protocol which 
multiplexes multiple socket connections down to the one pipe connection 
and back.

Also, if database latency is your main problem, or you can move a little 
bit of performance-sensitive code into C and relinquish the GIL while 
they're happening, you can just use callInThread to run your 
transactions in threads instead of having the reactor waiting on them.

Is this helpful?




From grib at billgribble.com  Tue Nov  4 16:05:21 2003
From: grib at billgribble.com (Bill Gribble)
Date: Tue, 04 Nov 2003 15:05:21 -0600
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311041019.31926.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
Message-ID: <1067979921.22040.46.camel@serrano>

On Tue, 2003-11-04 at 12:19, Uwe C. Schroeder wrote:
> BTW: You might suggest to break down the expensive function into smaller 
> pieces - no way. It has to run in one database transaction otherwise I might 
> end up with a inconsistent database - no good in finance business.

Would it help you to have the ability to open a database transaction and
keep it open while you do other things?  I have a patch to adbapi that
adds an API to do this.  It's in daily use on my development system but
I haven't quite finished cleaning it up for submission. 

b.g.
 




From bob at redivi.com  Tue Nov  4 16:26:14 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 4 Nov 2003 16:26:14 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <3FA80A1E.6050606@twistedmatrix.com>
References: <200311041019.31926.uwe@oss4u.com> <3FA80A1E.6050606@twistedmatrix.com>
Message-ID: <84E1A160-0F0D-11D8-B158-000A95686CD8@redivi.com>

On Nov 4, 2003, at 3:20 PM, Glyph Lefkowitz wrote:

> Uwe C. Schroeder wrote:
>
>> Is there a way to have twisted do something like apache or postgres 
>> and split the incoming connection to several processes ? It's not a 
>> web application, I'm solely using pb.
>
> This is possible, although not as easy as I'd like it to be.  In 
> principle, on most UNIX-based OSes, it's possible to listen() and 
> accept() in one process, pass the returned file descriptor to a 
> subprocess and do communication there.  I'd like to make this 
> automatic at some point, but won't have the time to do it for at least 
> another few months.

This is also useful for using privileged sockets (ports < 1024).  For 
example, on OS X in a GUI environment one can start a subprocess with 
root privileges w/ the Authorization framework, open the privileged 
socket, and pass it back to the parent process that does not have root 
privs.

-bob




From scosol at yahoo.com  Tue Nov  4 19:21:46 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 4 Nov 2003 16:21:46 -0800 (PST)
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031104145045.5dd33f75.itamar@itamarst.org>
Message-ID: <20031105002146.52106.qmail@web13904.mail.yahoo.com>

--- Itamar Shtull-Trauring <itamar at itamarst.org>
wrote:
> 
> What does this expensive function do? If it's
> standalone, involves heavy
> computation, or blocking resources, running it in a
> thread pool should
> allow you to improve latency. In cases where it goes
> into C code, it
> should also improve performance as it should release
> the GIL when doing
> that.

Am I severely confused here?
The entire point of Twisted (to me anyway) seems to be
to  provide non-blocking interfaces to long-running
and/or blocking resources.

I thought that was the whole point of it being
event-driven.

????????


=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_-jupiter accepts your offer-_



From itamar at itamarst.org  Tue Nov  4 19:49:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 4 Nov 2003 19:49:15 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105002146.52106.qmail@web13904.mail.yahoo.com>
References: <20031104145045.5dd33f75.itamar@itamarst.org>
	<20031105002146.52106.qmail@web13904.mail.yahoo.com>
Message-ID: <20031104194915.34c9c499.itamar@itamarst.org>

On Tue, 4 Nov 2003 16:21:46 -0800 (PST)
Nathan Seven <scosol at yahoo.com> wrote:

> Am I severely confused here?
> The entire point of Twisted (to me anyway) seems to be
> to  provide non-blocking interfaces to long-running
> and/or blocking resources.

Long-running yes, blocking, no. There is no magic way to make a blocking
API not-block. So you need to either rewrite from scratch, or use
threads.

For example, "send an email and return success or failure" can be
written using non-blocking APIs, since sockets have non-blocking APIs.
Calling a DB-API database adapter's cursor.fetchall() method can not
(unless you want to rewrite the database's wire protocol).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From scosol at yahoo.com  Wed Nov  5 02:05:26 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 4 Nov 2003 23:05:26 -0800 (PST)
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031104194915.34c9c499.itamar@itamarst.org>
Message-ID: <20031105070526.97752.qmail@web13906.mail.yahoo.com>

--- Itamar Shtull-Trauring <itamar at itamarst.org>
wrote:
> On Tue, 4 Nov 2003 16:21:46 -0800 (PST)
> Nathan Seven <scosol at yahoo.com> wrote:
> 
> > Am I severely confused here?
> > The entire point of Twisted (to me anyway) seems
> to be
> > to  provide non-blocking interfaces to
> long-running
> > and/or blocking resources.
> 
> Long-running yes, blocking, no. There is no magic
> way to make a blocking
> API not-block. So you need to either rewrite from
> scratch, or use
> threads.
> 
> For example, "send an email and return success or
> failure" can be
> written using non-blocking APIs, since sockets have
> non-blocking APIs.
> Calling a DB-API database adapter's
> cursor.fetchall() method can not
> (unless you want to rewrite the database's wire
> protocol).

But cant I write my code in a manner so that even if
every database call timed out infinitely, my
non-blocking access to it will simply deferr every
response until my machine runs out of resources to
handle the stalled db connections?
(while still responding promptly to the front end web
connections)
That's my understanding at least...


=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_-jupiter accepts your offer-_



From uwe at oss4u.com  Wed Nov  5 05:12:19 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 5 Nov 2003 02:12:19 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <1067979921.22040.46.camel@serrano>
References: <200311041019.31926.uwe@oss4u.com> <1067979921.22040.46.camel@serrano>
Message-ID: <200311050212.19373.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Tuesday 04 November 2003 01:05 pm, Bill Gribble wrote:
> On Tue, 2003-11-04 at 12:19, Uwe C. Schroeder wrote:
> > BTW: You might suggest to break down the expensive function into smaller
> > pieces - no way. It has to run in one database transaction otherwise I
> > might end up with a inconsistent database - no good in finance business.
>
> Would it help you to have the ability to open a database transaction and
> keep it open while you do other things?  I have a patch to adbapi that
> adds an API to do this.  It's in daily use on my development system but
> I haven't quite finished cleaning it up for submission.

I'm already doing that, but without using adbapi. When I started this project 
adbapi was no choice and now it's simply not an option to rewrite a lot of 
code to something I expect to be even slower than my code. I use a very lean 
row class based on slots and a db interface that handles the schema itself 
without me supplying it. This certainly is database dependant but I can 
afford to support postgres only.

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qM0DjqGXBvRToM4RAgizAJ93/N/cmUs5MH7oP3xNfhL4loNk4wCgwBaF
b+i2uqarCqQ9nct+MrUuXLQ=
=zh8w
-----END PGP SIGNATURE-----




From uwe at oss4u.com  Wed Nov  5 05:48:07 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 5 Nov 2003 02:48:07 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <3FA80A1E.6050606@twistedmatrix.com>
References: <200311041019.31926.uwe@oss4u.com> <3FA80A1E.6050606@twistedmatrix.com>
Message-ID: <200311050248.07658.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Tuesday 04 November 2003 12:20 pm, Glyph Lefkowitz wrote:
> Uwe C. Schroeder wrote:
> > Is there a way to have twisted do something like apache or postgres and
> > split the incoming connection to several processes ? It's not a web
> > application, I'm solely using pb.
>
> This is possible, although not as easy as I'd like it to be.  In
> principle, on most UNIX-based OSes, it's possible to listen() and
> accept() in one process, pass the returned file descriptor to a
> subprocess and do communication there.  I'd like to make this automatic
> at some point, but won't have the time to do it for at least another few
> months.
>
> The fact that it's not as graceful or automatic as I like doesn't mean
> it's impossible though.  If you want to just have one "control" process
> that shuttles around I/O and N worker processes that do the actual work,
> you can still use spawnProcess and communicate over stdin/stdout to the
> subprocesses about new connections using a simple protocol which
> multiplexes multiple socket connections down to the one pipe connection
> and back.
>
> Also, if database latency is your main problem, or you can move a little
> bit of performance-sensitive code into C and relinquish the GIL while
> they're happening, you can just use callInThread to run your
> transactions in threads instead of having the reactor waiting on them.

I figured that the impact of callInThread is much higher to the rest of the 
system than I like. I'm already using deferToThread a lot, however there are 
limits to the usefulness of threads.  For example I use it to do page 
formatting (printjobs). Each of the printjobs is about 120 pages to format. 
If I start 20 to 30 such formatting jobs with deferToThread twisted virtually 
becomes unresponsive. If I limit to a max of 3 or so it works. I admit I 
don't understand this, since IMHO defering to a thread should make it 
independant from the parent. I didn't dig into this problem since It's not a 
big deal to limit to a few such jobs at any given time and use a spooler type 
interface to suspend requests for later.

I think I suffer from database latency in general and with the expensive 
function in particular. The expensive function could be moved to a thread and 
maybe I'll give it a try. However if I do this for every method that writes 
more than 10 or 15 records to the database I'll most likely end up with 
thousands of threads. Currently the system is used by up to 15 people, but 
projection goes to 400+ people at any given time. I don't have a problem with 
having people wait for a result, I have a problem with the other people that 
don't get a result because the framework stops responding for a couple of 
functions that just take more than a millisecond to execute. 
I'd rather have 500 processes like with apache and have the OS do the 
scheduling - which is way more efficient than having the framework schedule.
The most expensive function I have (besides the printing mentioned above) 
executes in about 3 seconds. This is not "blocking" in my understanding, 
since the function never waits for something to happen, it just calculates 
and stores stuff. Twisted is unresponsive for those 3 seconds. Multiply that 
by 10 users and one user might end up with a delay of more than 30 seconds 
before his "3 seconds" are evaluated. If I had a lot of processes the OS 
would schedule that more efficiently since then the function might take 5 
seconds to complete, but it would be interrupted by the OS scheduler to hand 
processing time to one of the other processes. 

Maybe I'll look into splitting into n worker processes. Since this would 
involve going into twisted code, where would I start looking ?

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qNVnjqGXBvRToM4RAgyCAJ9d73B7bnWIu4C3NyGDwQ23HqfXRACguodJ
pB5TPkUy6oYjlgC/Fvei36E=
=osgL
-----END PGP SIGNATURE-----




From itamar at itamarst.org  Wed Nov  5 10:11:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 5 Nov 2003 10:11:51 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105070526.97752.qmail@web13906.mail.yahoo.com>
References: <20031104194915.34c9c499.itamar@itamarst.org>
	<20031105070526.97752.qmail@web13906.mail.yahoo.com>
Message-ID: <20031105101151.4f577a0f.itamar@itamarst.org>

On Tue, 4 Nov 2003 23:05:26 -0800 (PST)
Nathan Seven <scosol at yahoo.com> wrote:

> But cant I write my code in a manner so that even if
> every database call timed out infinitely, my
> non-blocking access to it will simply deferr every
> response until my machine runs out of resources to
> handle the stalled db connections?

Yes. If you run the database query in a thread.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Wed Nov  5 10:14:49 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 5 Nov 2003 10:14:49 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311050248.07658.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com> <3FA80A1E.6050606@twistedmatrix.com> <200311050248.07658.uwe@oss4u.com>
Message-ID: <20031105151449.GA20167@intarweb.us>

On Wed, Nov 05, 2003 at 02:48:07AM -0800, Uwe C. Schroeder wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> On Tuesday 04 November 2003 12:20 pm, Glyph Lefkowitz wrote:
> > Uwe C. Schroeder wrote:
> > > Is there a way to have twisted do something like apache or postgres and
> > > split the incoming connection to several processes ? It's not a web
> > > application, I'm solely using pb.
> >
> > This is possible, although not as easy as I'd like it to be.  In
> > principle, on most UNIX-based OSes, it's possible to listen() and
> > accept() in one process, pass the returned file descriptor to a
> > subprocess and do communication there.  I'd like to make this automatic
> > at some point, but won't have the time to do it for at least another few
> > months.
> >
> > The fact that it's not as graceful or automatic as I like doesn't mean
> > it's impossible though.  If you want to just have one "control" process
> > that shuttles around I/O and N worker processes that do the actual work,
> > you can still use spawnProcess and communicate over stdin/stdout to the
> > subprocesses about new connections using a simple protocol which
> > multiplexes multiple socket connections down to the one pipe connection
> > and back.
> >
> > Also, if database latency is your main problem, or you can move a little
> > bit of performance-sensitive code into C and relinquish the GIL while
> > they're happening, you can just use callInThread to run your
> > transactions in threads instead of having the reactor waiting on them.
> 
> I figured that the impact of callInThread is much higher to the rest of the 
> system than I like. I'm already using deferToThread a lot, however there are 
> limits to the usefulness of threads.  For example I use it to do page 
> formatting (printjobs). Each of the printjobs is about 120 pages to format. 
> If I start 20 to 30 such formatting jobs with deferToThread twisted virtually 
> becomes unresponsive. If I limit to a max of 3 or so it works. I admit I 
> don't understand this, since IMHO defering to a thread should make it 
> independant from the parent.

  But it doesn't, not in Python.  Each thread adds new contention for the
GIL, which makes every thread less responsive.  If the print jobs were
managed by a C extension which could release the GIL before doing its work,
then they would be mostly independant.

> I didn't dig into this problem since It's not a big deal to limit to a few
> such jobs at any given time and use a spooler type interface to suspend
> requests for later.

  Yea.  If you only have 4 CPUs, it doesn't make sense to be running 400
CPU-bound threads :)

> 
> I think I suffer from database latency in general and with the expensive 
> function in particular. The expensive function could be moved to a thread and 
> maybe I'll give it a try. However if I do this for every method that writes 
> more than 10 or 15 records to the database I'll most likely end up with 
> thousands of threads. Currently the system is used by up to 15 people, but 
> projection goes to 400+ people at any given time. I don't have a problem with 
> having people wait for a result, I have a problem with the other people that 
> don't get a result because the framework stops responding for a couple of 
> functions that just take more than a millisecond to execute. 
> I'd rather have 500 processes like with apache and have the OS do the 
> scheduling - which is way more efficient than having the framework schedule.
> The most expensive function I have (besides the printing mentioned above) 
> executes in about 3 seconds. This is not "blocking" in my understanding, 
> since the function never waits for something to happen, it just calculates 
> and stores stuff.

  It is blocking.  While the term usually refers to a function that waits
for some I/O to finish, it applies equally well to any functions that run
for a non-trivial amount of time and, while doing so, prevent the rest of
the application from proceeding.

> Twisted is unresponsive for those 3 seconds. Multiply that by 10 users and
> one user might end up with a delay of more than 30 seconds before his "3
> seconds" are evaluated. If I had a lot of processes the OS would schedule
> that more efficiently since then the function might take 5 seconds to
> complete, but it would be interrupted by the OS scheduler to hand
> processing time to one of the other processes.
> 
> Maybe I'll look into splitting into n worker processes. Since this would 
> involve going into twisted code, where would I start looking ?
> 

  Before doing that, you might consider just spawning a handful of worker
threads and giving them queues.  This keeps the application responsive by
not forcing an insane number of context switches but also still allowing all
the expensive functions to run independently of the I/O thread.  

  There is even a ThreadPool class in Twisted already (though I have never
used it myself ;), so giving this approach a try should be pretty quick, and
if it is still not good enough, you haven't lost much time.

  This is not to say that multiple processes would not also be a good
solution, just that it might be a harder one to implement.  If you do end up
looking at multiple processes, reactor.spawnProcess() (as glyph alluded to
earlier) is one way to go about it.  This is basically the equivalent of
popen2() (though with a lot more flexibility).

  On a related, but not necessarily useful note, I've recently begun
investigating ways of moving the state associated with a user request,
including the associated socket object, between processes.  My use case is
not load-balancing, but the code should apply equally well to this as to
what I intend to use it for.  It requires C extensions (which are currently
-just- good enough to play around with higher-level stuff in Python with). 
The code is very short, and lives mostly in sandbox/exarkun/copyover/fdpass.py
in CVS HEAD.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031105/3c284807/attachment.pgp 

From itamar at itamarst.org  Wed Nov  5 10:31:19 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 5 Nov 2003 10:31:19 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311050248.07658.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
	<3FA80A1E.6050606@twistedmatrix.com>
	<200311050248.07658.uwe@oss4u.com>
Message-ID: <20031105103119.2695e083.itamar@itamarst.org>

On Wed, 5 Nov 2003 02:48:07 -0800
"Uwe C. Schroeder" <uwe at oss4u.com> wrote:

> I think I suffer from database latency in general and with the
> expensive function in particular. The expensive function could be
> moved to a thread and maybe I'll give it a try. However if I do this
> for every method that writes more than 10 or 15 records to the
> database I'll most likely end up with thousands of threads.

No, Twisted has a thread pool, so if you are using Twisted APIs you
won't get more than the max number of threads the pool is configured to
use.

> The most expensive function I have (besides the printing mentioned
> above) executes in about 3 seconds. This is not "blocking" in my
> understanding, since the function never waits for something to happen,
> it just calculates and stores stuff. Twisted is unresponsive for those
> 3 seconds.

If Twisted is unresponsive, that means it blocks. Any function that
takes more than 10ms should probably count as blocking, really. Try
running it in a thread. Because of the global interpreter lock, this
won't reduce runtime, but it'll enhance responsiveness to other clients.

In general, it sounds like you are doing a lot of database queries. Some
ways to optimize this:

1. Do less queries - cache, merge identical requests, etc.. 
2. Do a number of queries in a single transaction in a single thread,
rather than deferToThread, get result, run another query with
deferToThread again, etc..
(3. Don't use RDBMS. Use an in-process database like ZODB or Quotient's
atop when it's done.)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Wed Nov  5 11:02:30 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 05 Nov 2003 11:02:30 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105151449.GA20167@intarweb.us>
References: <200311041019.31926.uwe@oss4u.com> <3FA80A1E.6050606@twistedmatrix.com> <200311050248.07658.uwe@oss4u.com> <20031105151449.GA20167@intarweb.us>
Message-ID: <3FA91F16.4050102@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Jp Calderone wrote:

|   There is even a ThreadPool class in Twisted already (though I have never
| used it myself ;), so giving this approach a try should be pretty
quick, and
| if it is still not good enough, you haven't lost much time.

Don't use it! :)  Use reactor.callInThread, as we've been saying.
ThreadPool is an implementation detail of the default reactor, at this
point.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/qR8VvVGR4uSOE2wRAuwLAKCkNBk00PSaI3C9TFK6F3XtosMV5QCdGzZC
fjgaHR76PsQCVMLPdcKwO3w=
=+wz/
-----END PGP SIGNATURE-----




From uwe at oss4u.com  Wed Nov  5 12:32:23 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 5 Nov 2003 09:32:23 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105103119.2695e083.itamar@itamarst.org>
References: <200311041019.31926.uwe@oss4u.com> <200311050248.07658.uwe@oss4u.com> <20031105103119.2695e083.itamar@itamarst.org>
Message-ID: <200311050932.23119.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Wednesday 05 November 2003 07:31 am, Itamar Shtull-Trauring wrote:
> On Wed, 5 Nov 2003 02:48:07 -0800
>
> "Uwe C. Schroeder" <uwe at oss4u.com> wrote:
> > I think I suffer from database latency in general and with the
> > expensive function in particular. The expensive function could be
> > moved to a thread and maybe I'll give it a try. However if I do this
> > for every method that writes more than 10 or 15 records to the
> > database I'll most likely end up with thousands of threads.
>
> No, Twisted has a thread pool, so if you are using Twisted APIs you
> won't get more than the max number of threads the pool is configured to
> use.

I know and I increased the threadpool limit a bit. Not much though because in 
the end it all runs on one cpu. I asume that if I start say 50 threads via 
deferToThread and the pool limit is 25 the requested threads are started when 
one becomes available ?

> > The most expensive function I have (besides the printing mentioned
> > above) executes in about 3 seconds. This is not "blocking" in my
> > understanding, since the function never waits for something to happen,
> > it just calculates and stores stuff. Twisted is unresponsive for those
> > 3 seconds.
>
> If Twisted is unresponsive, that means it blocks. Any function that
> takes more than 10ms should probably count as blocking, really. Try
> running it in a thread. Because of the global interpreter lock, this
> won't reduce runtime, but it'll enhance responsiveness to other clients.
 
Responsiveness is what I need. Users are happy to wait a couple seconds if one 
can notify him and his screen still shows some "progress".

> In general, it sounds like you are doing a lot of database queries. Some
> ways to optimize this:
>
> 1. Do less queries - cache, merge identical requests, etc..

Yep - I already started moving some of the things into the database as stored 
procedures. This reduces the execution time tremendously since it get's rid 
of the DB API overhead. I know I still have some optimization potential by 
handing data blocks between methods so a particular method doesn't have to 
requery the database for something an other method already did.

> 2. Do a number of queries in a single transaction in a single thread,
> rather than deferToThread, get result, run another query with
> deferToThread again, etc..

I already do this, at least in some parts. You're right, the thread handling 
overhead is way too high to have single simple queries running in a thread 
each. It doesn't make sense to use a thread which costs you 1ms to set up for 
something that only runs 1ms.

> (3. Don't use RDBMS. Use an in-process database like ZODB or Quotient's
> atop when it's done.)

:-) I'd probably do that with a web application, but even there I'll allways 
prefer a "real" database system. In process databases may be faster, therefor 
they are less relieable and correcting errors is a virtual impossibility.
Also the sher size of the data I handle would make something like ZODB blow up 
to a couple gigabytes in one month alone. 
Since my customers generally can afford it I rather use big iron for a couple 
thousand $$ to make the database faster. Specially in the finance and 
insurance industry it also makes the management happier if they see some big 
machines that look impressive in the rack. That's what they're used to and it 
gives them confidence in their investment (although one probably only uses 
10% of the machine :-) )
 
	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qTQnjqGXBvRToM4RAqp1AJ4u5ORM99wqwQECY7ilUe5DzZrDGwCgjfEm
QfoGAI5kzxAstClINbfqoaw=
=6MHF
-----END PGP SIGNATURE-----




From uwe at oss4u.com  Wed Nov  5 13:00:23 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 5 Nov 2003 10:00:23 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105151449.GA20167@intarweb.us>
References: <200311041019.31926.uwe@oss4u.com> <200311050248.07658.uwe@oss4u.com> <20031105151449.GA20167@intarweb.us>
Message-ID: <200311051000.23748.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Wednesday 05 November 2003 07:14 am, Jp Calderone wrote:
> On Wed, Nov 05, 2003 at 02:48:07AM -0800, Uwe C. Schroeder wrote:
> > -----BEGIN PGP SIGNED MESSAGE-----
> > Hash: SHA1
> >
> > On Tuesday 04 November 2003 12:20 pm, Glyph Lefkowitz wrote:
> > > Uwe C. Schroeder wrote:
> > > > Is there a way to have twisted do something like apache or postgres
> > > > and split the incoming connection to several processes ? It's not a
> > > > web application, I'm solely using pb.
> > >
> > > This is possible, although not as easy as I'd like it to be.  In
> > > principle, on most UNIX-based OSes, it's possible to listen() and
> > > accept() in one process, pass the returned file descriptor to a
> > > subprocess and do communication there.  I'd like to make this automatic
> > > at some point, but won't have the time to do it for at least another
> > > few months.
> > >
> > > The fact that it's not as graceful or automatic as I like doesn't mean
> > > it's impossible though.  If you want to just have one "control" process
> > > that shuttles around I/O and N worker processes that do the actual
> > > work, you can still use spawnProcess and communicate over stdin/stdout
> > > to the subprocesses about new connections using a simple protocol which
> > > multiplexes multiple socket connections down to the one pipe connection
> > > and back.
> > >
> > > Also, if database latency is your main problem, or you can move a
> > > little bit of performance-sensitive code into C and relinquish the GIL
> > > while they're happening, you can just use callInThread to run your
> > > transactions in threads instead of having the reactor waiting on them.
> >
> > I figured that the impact of callInThread is much higher to the rest of
> > the system than I like. I'm already using deferToThread a lot, however
> > there are limits to the usefulness of threads.  For example I use it to
> > do page formatting (printjobs). Each of the printjobs is about 120 pages
> > to format. If I start 20 to 30 such formatting jobs with deferToThread
> > twisted virtually becomes unresponsive. If I limit to a max of 3 or so it
> > works. I admit I don't understand this, since IMHO defering to a thread
> > should make it independant from the parent.
>
>   But it doesn't, not in Python.  Each thread adds new contention for the
> GIL, which makes every thread less responsive.  If the print jobs were
> managed by a C extension which could release the GIL before doing its work,
> then they would be mostly independant.

That explains it. Maybe I'll go ahead and create a separate "print" server 
process that just produces paper. I'm using reportlab and I even had to turn 
off the c extensions used in reportlab, because they are not threadsafe. 
Printing isn't a big deal at this time, simply because I gave them a "print 
later" checkbox which will suspend formatting and printing for the night. At 
night I then just process all the printjobs sequentially.


> > I didn't dig into this problem since It's not a big deal to limit to a
> > few such jobs at any given time and use a spooler type interface to
> > suspend requests for later.
>
>   Yea.  If you only have 4 CPUs, it doesn't make sense to be running 400
> CPU-bound threads :)

Exactly :-)

>
> > I think I suffer from database latency in general and with the expensive
> > function in particular. The expensive function could be moved to a thread
> > and maybe I'll give it a try. However if I do this for every method that
> > writes more than 10 or 15 records to the database I'll most likely end up
> > with thousands of threads. Currently the system is used by up to 15
> > people, but projection goes to 400+ people at any given time. I don't
> > have a problem with having people wait for a result, I have a problem
> > with the other people that don't get a result because the framework stops
> > responding for a couple of functions that just take more than a
> > millisecond to execute.
> > I'd rather have 500 processes like with apache and have the OS do the
> > scheduling - which is way more efficient than having the framework
> > schedule. The most expensive function I have (besides the printing
> > mentioned above) executes in about 3 seconds. This is not "blocking" in
> > my understanding, since the function never waits for something to happen,
> > it just calculates and stores stuff.
>
>   It is blocking.  While the term usually refers to a function that waits
> for some I/O to finish, it applies equally well to any functions that run
> for a non-trivial amount of time and, while doing so, prevent the rest of
> the application from proceeding.
>
> > Twisted is unresponsive for those 3 seconds. Multiply that by 10 users
> > and one user might end up with a delay of more than 30 seconds before his
> > "3 seconds" are evaluated. If I had a lot of processes the OS would
> > schedule that more efficiently since then the function might take 5
> > seconds to complete, but it would be interrupted by the OS scheduler to
> > hand processing time to one of the other processes.
> >
> > Maybe I'll look into splitting into n worker processes. Since this would
> > involve going into twisted code, where would I start looking ?
>
>   Before doing that, you might consider just spawning a handful of worker
> threads and giving them queues.  This keeps the application responsive by
> not forcing an insane number of context switches but also still allowing
> all the expensive functions to run independently of the I/O thread.
>
>   There is even a ThreadPool class in Twisted already (though I have never
> used it myself ;), so giving this approach a try should be pretty quick,
> and if it is still not good enough, you haven't lost much time.
>
>   This is not to say that multiple processes would not also be a good
> solution, just that it might be a harder one to implement.  If you do end
> up looking at multiple processes, reactor.spawnProcess() (as glyph alluded
> to earlier) is one way to go about it.  This is basically the equivalent of
> popen2() (though with a lot more flexibility).

I think a mixture of both might be the best approach. Having several processes 
would be great for MP machines, so one has the ability to scale on a hardware 
basis. Making more intelligent use of threads could increase responsiveness. 
One user is fine wating  for something to happen, but all the others 
shouldn't have to wait for the one user too.

>   On a related, but not necessarily useful note, I've recently begun
> investigating ways of moving the state associated with a user request,
> including the associated socket object, between processes.  My use case is
> not load-balancing, but the code should apply equally well to this as to
> what I intend to use it for.  It requires C extensions (which are currently
> -just- good enough to play around with higher-level stuff in Python with).
> The code is very short, and lives mostly in
> sandbox/exarkun/copyover/fdpass.py in CVS HEAD.

I'll check that out. I wouldn't name it load-balancing. Would be interesting 
though to check if one could have a single "socket server" that distributes 
to several processes on several machines :-) For an application like mine 
load balancing might be much easier, since I could make the clients reconnect 
to a different server/port.

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qTq3jqGXBvRToM4RAsd8AJ9Xme37KfYCxT+ls4SNOAQrzZTi8gCeK42C
Lwf/hmo+TRp/ulHAA49I3Ck=
=W66T
-----END PGP SIGNATURE-----




From maoy at cis.upenn.edu  Wed Nov  5 16:57:29 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 5 Nov 2003 16:57:29 -0500 (EST)
Subject: [Twisted-Python] rpm package for twisted?
In-Reply-To: <200311051000.23748.uwe@oss4u.com>
Message-ID: <Pine.LNX.4.44.0311051655460.27564-100000@klondike.cis.upenn.edu>

Hi, I found twisted package for debian in the official site. Is there a 
ready rpm package for twisted 1.1.0 release? thanks!

Yun






From alexander.winston at comcast.net  Wed Nov  5 17:35:01 2003
From: alexander.winston at comcast.net (Alexander Winston)
Date: Wed, 05 Nov 2003 17:35:01 -0500
Subject: [Twisted-Python] rpm package for twisted?
In-Reply-To: <Pine.LNX.4.44.0311051655460.27564-100000@klondike.cis.upenn.edu>
References: 
	 <Pine.LNX.4.44.0311051655460.27564-100000@klondike.cis.upenn.edu>
Message-ID: <1068071701.2980.1.camel@shock>

On Wed, 2003-11-05 at 16:57, Yun Mao wrote:
> Hi, I found twisted package for debian in the official site. Is there a 
> ready rpm package for twisted 1.1.0 release? thanks!

They are not distributed as far as I know, but the .spec file
(Twisted/admin/twisted.spec) should produce RPMs without trouble.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031105/494e7c39/attachment.pgp 

From mailinglists at shechen.at  Wed Nov  5 18:13:06 2003
From: mailinglists at shechen.at (stephan)
Date: Wed, 05 Nov 2003 15:13:06 -0800
Subject: [Twisted-Python] request getUser()/getPassword() in Woven and resources...
In-Reply-To: <6.0.0.22.0.20031030154614.01e1f788@anusf.anu.edu.au>
References: <6.0.0.22.0.20031030154614.01e1f788@anusf.anu.edu.au>
Message-ID: <oprx6tf4klwzeeq5@mail.geekmail.cc>

My question goes along the previous one in this thread.
How do you get the browser to prompt for a username and password?
My code is not woking and goes something like this: On every page request 
a certain function is called, say genpage()...

def genpage(request)
     request.getUser()
     request.getPassword()

     return "hello world"


-> Browser does not prompt though. (And this does not even involve woven)

_stephan



On Thu, 30 Oct 2003 15:52:32 +1100, Stuart Hungerford 
<stuart.hungerford at anu.edu.au> wrote:

> Hi all,
>
> I've had a twisted web application running for a while that
> uses request.getUser() and request.getPassword() in a
> resource subclass render() method to make the web browser
> prompt for a username/password.
>
> I've been refactoring this application to use Woven page
> subclasses and the same request.getFoo() calls now
> return empty strings rather than None, and no prompting
> from the browser is done.
>
> Is there some gotcha in using request.getUser() and
> request.getPassword() from Woven page subclasses?
>
>
> Cheers,
>
> Stu
>
> --
> :: Stuart Hungerford (stuart.hungerford at anu.edu.au)
> :: ANU Internet Futures Group
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python





From obowah at yahoo.com  Wed Nov  5 23:00:17 2003
From: obowah at yahoo.com (rddda)
Date: Wed, 5 Nov 2003 20:00:17 -0800 (PST)
Subject: [Twisted-Python] smtp server
Message-ID: <20031106040017.72048.qmail@web10707.mail.yahoo.com>

new to twisted. can't figure how to set up smtp server. is there doc somewhere for Twisted.Mail?
i will try searching archive next


---------------------------------
Do you Yahoo!?
Protect your identity with Yahoo! Mail AddressGuard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031105/f96d303a/attachment.htm 

From sam at twistedmatrix.com  Thu Nov  6 11:45:55 2003
From: sam at twistedmatrix.com (Sam Jordan)
Date: Fri, 7 Nov 2003 02:45:55 +1000
Subject: [Twisted-Python] SelectReactor, readers and writers
Message-ID: <20031106164555.GA16990@psychlaw.com.au>

Hi,

While looking at the code for the default SelectReactor I noticed
that the selectables are stored in the form {object : 1, ...}.
Is there any particular reason they're not stored in the format:
{ fd : object, ...}? A couple I can think of are that duplicate
file-descriptors would cause problems (which they currently most
likely would anyway) and objects which return different values from
fileno based on context would no longer work correctly -- are either
of these use-cases valid?

The reason i'm bringing this up is because since 2.3 (I think) calls
to socket.fileno are wrapped in a python function (as defined in
socket.py) which I assume, when called in a tight loop over a large
number of objects may result in a bottleneck (I certainly remember
profiling code in the past where this was the case).
This could be alleviated by passing a sequence of integers to select
instead of the connection objects themselves.

It could be that i'm missing something, or it could also be that this
has never come up because until a short time ago socket.fileno was, of
course, a C function :-).

Another thing to think about for the future is that on September 10
selectmodule.c was changed so that select.select now supports any
sequence. Currently SelectReactor makes a list from the readers
and writers dictionary (calling dict.keys()) every iteration -- of
course this is likely to remain the same for a while considering
the need for backwards compatibility and i'm not even sure if the
patch has been backported to 2.3 yet (unlikely since my 2.3.2 is
dated Oct 6 and it does not exhibit this behaviour). Still,
it's interesting to note for the future.

Cheers,

Sam.



From john.abel at pa.press.net  Thu Nov  6 02:35:13 2003
From: john.abel at pa.press.net (John Abel)
Date: Thu, 06 Nov 2003 07:35:13 +0000
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
Message-ID: <3FA9F9B1.9050202@pa.press.net>

Hi!

I noticed a couple of posts about 1.1rc's failing to build on Win32, due 
to the the installer not being able to find certain files (rpc.h, and 
portmap.h), but I've not seen any updates.  This problem still exists 
with 1.1.  Is there a way round it?  Or, do I need to create a bug 
report for it?

Regards

John




From syver at inout.no  Thu Nov  6 04:23:07 2003
From: syver at inout.no (Syver Enstad)
Date: 06 Nov 2003 10:23:07 +0100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <3FA9F9B1.9050202@pa.press.net>
References: <3FA9F9B1.9050202@pa.press.net>
Message-ID: <u65hxsves.fsf@inout.no>

John Abel <john.abel at pa.press.net> writes:

> Hi!
> 
> I noticed a couple of posts about 1.1rc's failing to build on Win32,
> due to the the installer not being able to find certain files (rpc.h,
> and portmap.h), but I've not seen any updates.  This problem still
> exists with 1.1.  Is there a way round it?  Or, do I need to create a
> bug report for it?

Comment out the section that tries to compile the extension needing
rpc.h in setup.py (That's what I did). Just subsititute the test that
tries to find out if rpc.h is available with False so that the branch
is never entered.

Also when you get the build to work the twisted.scripts.twistdw.py
script is broken, fix it by looking at twistd.py.





From radix at twistedmatrix.com  Thu Nov  6 06:13:05 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 6 Nov 2003 12:13:05 +0100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <u65hxsves.fsf@inout.no>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no>
Message-ID: <20031106111305.GA899@twistedmatrix.com>

On Thu, Nov 06, 2003 at 10:23:07AM +0100, Syver Enstad wrote:
> John Abel <john.abel at pa.press.net> writes:
> 
> > Hi!
> > 
> > I noticed a couple of posts about 1.1rc's failing to build on Win32,
> > due to the the installer not being able to find certain files (rpc.h,
> > and portmap.h), but I've not seen any updates.  This problem still
> > exists with 1.1.  Is there a way round it?  Or, do I need to create a
> > bug report for it?
> 
> Comment out the section that tries to compile the extension needing
> rpc.h in setup.py (That's what I did). Just subsititute the test that
> tries to find out if rpc.h is available with False so that the branch
> is never entered.
> 
> Also when you get the build to work the twisted.scripts.twistdw.py
> script is broken, fix it by looking at twistd.py.

Can you please report these bugs to the tracker, if they aren't
already?

http://twistedmatrix.com/bugs/


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From john at landahl.org  Wed Nov  5 04:35:29 2003
From: john at landahl.org (John Landahl)
Date: Wed, 05 Nov 2003 01:35:29 -0800
Subject: [Twisted-Python] MANIFEST.in for RPMs
Message-ID: <oprx5rlf08k1a6kk@sfmail3>

If anyone has an interest in using the bdist_rpm option with setup.py to 
build Twisted RPMs, the MANIFEST.in file needs the following additions:

     include twisted/runner/portmap.c
     include twisted/protocols/_c_urlarg.c
     include twisted/lore/template.mgp
     include twisted/web/woven/FlashConduit*
     include twisted/web/woven/WebConduit*
     include twisted/test/process.alias.sh*
     include twisted/test/rfc822.message
     include twisted/test/server.pem

Also, for a Twisted installation that works with any installed version of 
Python (e.g. 2.2 and 2.3), you can install Twisted to /usr/lib/site-python 
by adding these lines to setup.cfg:

     [install]
     install-lib = /usr/lib/site-python

/usr/lib/site-python seems far more convenient than 
/usr/lib/pythonX/site-packages, don't know why it isn't the default.

John Landahl
john at landahl.org



From tv at tv.debian.net  Wed Nov  5 11:05:52 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Wed, 05 Nov 2003 18:05:52 +0200
Subject: [Twisted-Python] Woven web question about clearing http request.args
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FC@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FC@EMSS07M12.us.lmco.com>
Message-ID: <3FA91FE0.20803@tv.debian.net>

Hegedus, Matthew S wrote:
> I've got multiple input buttons and their view is the same logic. The logic
> is delete some data on a button press, then rerender the page with the
> updated data. The data it will remove depends on the unique ID of the button
> pressed.  When the web page is rerendered the view gets called for each
> button with the same http request, so the deletion logic will be evaluated
> for each button, even though it should be evaluated for just the button that
> was pressed. I don't like that. I want to clear request.args so the behavior
> will be as if there was only one http event, corresponding to a single
> button press. I tried "request.args.clear()", but that doesn't seem to have
> the expected effect.

The view factory is called once per use of that view in the template.
If you use the view for three buttons, your view factory gets called 
three times. Whether there were any button presses or not.

Maybe you should move your "delete" logic from the view to the render 
method, or to a model that is used only once in the template. That is 
only called once per request, and is a logical place to do some processing.

> What's worse is when I click the browser's reload button, request.args still
> has the last http request that occurred. In other words, if I click my
> delete button the page will be rerendered with updated data, then if I click
> the browser's reload it will try to delete more data as if I had hit on of
> my delete buttons again. Can anyone help me with this problem?

You should use a POST method for submitting the form; then the browser 
is not allowed to just resend the request without confirming the action 
from the user.




From tv at tv.debian.net  Wed Nov  5 11:14:08 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Wed, 05 Nov 2003 18:14:08 +0200
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311041019.31926.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
Message-ID: <3FA921D0.10701@tv.debian.net>

Uwe C. Schroeder wrote:
> is there a way to have one service start several processes ?
> When using twisted everyone connecting to the server ends in the same process. 
> This leads to "slowing down" when requesting information whenever a certain 
> number of people go on. Each request takes some time to process and meanwhile 
> the server is less responsive. I have one particularly expensive function 
> that takes a bit. So if several people happen to use this function at a time 
> the server slows down, up to where it takes a minute to complete.
> It's not a problem of system ressources (it's a quad processor xeon server 
> with plenty of RAM and ultra 320 scsi drives running only this application 
> and the postgres backend). The machine has a load of 0.2 while slowing down.
> Basically most of the machine is idle, since it only runs 2 processes and has 
> 4 processors.

You should look at having a pool of worker _processes_, to which you 
dispatch work with pb.

Not threads, as python threading will not really scale, and there's 
really no point in threading if the amount of input/output to the worker 
is small enough (shared mem has its good and bad sides).

> Is there a way to have twisted do something like apache or postgres and split 
> the incoming connection to several processes ? It's not a web application, 
> I'm solely using pb.

If you listen in a parent process, fork multiple children, and make the 
children accept, unix does the right thing. I don't think Twisted knows 
how to do that out of the box, but it should be doable.

That's assuming you don't need (much) shared data between the children.

> BTW: You might suggest to break down the expensive function into smaller 
> pieces - no way. It has to run in one database transaction otherwise I might 
> end up with a inconsistent database - no good in finance business.

If you are lucky, you can find a threading DB library (adbapi) that 
actually scales. The other mail in this thread are more helpful there..




From vlupien at drummonddesigns.com  Thu Nov  6 09:26:00 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 6 Nov 2003 09:26:00 -0500
Subject: [Twisted-Python] Deferred problem
Message-ID: <000001c3a471$e6b30ee0$687ba8c0@vicky>

I know that I'd already post a message about deferred but I think I
haven't understand very well.
 
I have a function that is suppose to return a new dictionnary but it
returns a deferred.
 
 
class MainPage(pages.BasePage):
    templateFile = "main.html"
  
    def initialize(self, dbpool=None):
        self.dbpool = dbpool
    
    def setUp(self, request, *args):
        var = self.initPermissions(request)      #var is suppose to get
the new list
        print var
 
    def wmfactory_welcome(self, request):
        return "Bienvenue, %s" %
request.getComponent(myguard.Authenticated).name
 
    def initPermissions(self, request):       #create and return the
results of a sql query
        group = request.getComponent(myguard.Authenticated).group
        listGroup = group.split(',')
        sql = "select permission from permissions where 1"
        for item in listGroup:
            sql += " or permissions.group='%s'" % item.lstrip()
        theDeferred = self.dbpool.runQueryDict(sql)
        return theDeferred.addCallback(self.makeDict)        # suppose
to call makeDict when the results has arrived
 
    def makeDict(self, results):
            # when I print what is in results, I can see all the data
from the sql query
        listPermissions = []
        for item in results:
            listPermissions.append(item.get('permission'))
        return listPermissions                   # return the new list
but the function setUp receive a deferred
 
 
I've put some comments in the code to help you understand what I want.
The big problem is that var receive a deferred and not the new list
 
Vicky
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031106/b04cf941/attachment.htm 

From glyph at twistedmatrix.com  Thu Nov  6 10:08:02 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 06 Nov 2003 10:08:02 -0500
Subject: [Twisted-Python] MANIFEST.in for RPMs
In-Reply-To: <oprx5rlf08k1a6kk@sfmail3>
References: <oprx5rlf08k1a6kk@sfmail3>
Message-ID: <3FAA63D2.6010204@twistedmatrix.com>

John Landahl wrote:
> If anyone has an interest in using the bdist_rpm option with setup.py to 
> build Twisted RPMs, the MANIFEST.in file needs the following additions:

Please enter this as a bug in the tracker, hopefully with a patch?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 256 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031106/da28d687/attachment.pgp 

From itamar at itamarst.org  Thu Nov  6 10:17:21 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 06 Nov 2003 10:17:21 -0500
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <3FA9F9B1.9050202@pa.press.net>
References: <3FA9F9B1.9050202@pa.press.net>
Message-ID: <3FAA6601.90401@itamarst.org>

John Abel wrote:

> I noticed a couple of posts about 1.1rc's failing to build on Win32, due 
> to the the installer not being able to find certain files (rpc.h, and 
> portmap.h), but I've not seen any updates.  This problem still exists 
> with 1.1.  Is there a way round it?  Or, do I need to create a bug 
> report for it?

Cory managed to build win32 exes from 1.1 - they are available from our 
download site...

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting




From itamar at itamarst.org  Thu Nov  6 10:19:13 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 06 Nov 2003 10:19:13 -0500
Subject: [Twisted-Python] MANIFEST.in for RPMs
In-Reply-To: <oprx5rlf08k1a6kk@sfmail3>
References: <oprx5rlf08k1a6kk@sfmail3>
Message-ID: <3FAA6671.9010806@itamarst.org>

John Landahl wrote:

> If anyone has an interest in using the bdist_rpm option with setup.py to 
> build Twisted RPMs, the MANIFEST.in file needs the following additions:

Thanks. I should note however that the recommeded way of building RPMs 
is using admin/twisted.spec.

> Also, for a Twisted installation that works with any installed version 
> of Python (e.g. 2.2 and 2.3), you can install Twisted to 
> /usr/lib/site-python by adding these lines to setup.cfg:
> 
>     [install]
>     install-lib = /usr/lib/site-python
> 
> /usr/lib/site-python seems far more convenient than 
> /usr/lib/pythonX/site-packages, don't know why it isn't the default

Because it's wrong. Twisted has C extensions, and those are specific to 
the version of Python used to compile Twisted.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting




From glyph at twistedmatrix.com  Thu Nov  6 10:49:26 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 06 Nov 2003 10:49:26 -0500
Subject: [Twisted-Python] MANIFEST.in for RPMs
In-Reply-To: <3FAA6671.9010806@itamarst.org>
References: <oprx5rlf08k1a6kk@sfmail3> <3FAA6671.9010806@itamarst.org>
Message-ID: <3FAA6D86.4020802@twistedmatrix.com>

Itamar Shtull-Trauring wrote:
> John Landahl wrote:

>> /usr/lib/site-python seems far more convenient than 
>> /usr/lib/pythonX/site-packages, don't know why it isn't the default
> 
> 
> Because it's wrong. Twisted has C extensions, and those are specific to 
> the version of Python used to compile Twisted.

Even without C, the bytecodes generated for the installed .pyc files are 
different between python versions.




From bob at redivi.com  Thu Nov  6 11:35:32 2003
From: bob at redivi.com (Bob Ippolito)
Date: Thu, 6 Nov 2003 11:35:32 -0500
Subject: [Twisted-Python] MANIFEST.in for RPMs
In-Reply-To: <3FAA6D86.4020802@twistedmatrix.com>
References: <oprx5rlf08k1a6kk@sfmail3> <3FAA6671.9010806@itamarst.org> <3FAA6D86.4020802@twistedmatrix.com>
Message-ID: <3D71C092-1077-11D8-B3CD-000A95686CD8@redivi.com>

On Nov 6, 2003, at 10:49 AM, Glyph Lefkowitz wrote:

> Itamar Shtull-Trauring wrote:
>> John Landahl wrote:
>
>>> /usr/lib/site-python seems far more convenient than 
>>> /usr/lib/pythonX/site-packages, don't know why it isn't the default
>> Because it's wrong. Twisted has C extensions, and those are specific 
>> to the version of Python used to compile Twisted.
>
> Even without C, the bytecodes generated for the installed .pyc files 
> are different between python versions.

That python will try and import every time, and if you don't have the 
same python version installed it will recompile them every run.. and 
not be able to save them for permissions reason.

-bob




From MCStoufer at lbl.gov  Thu Nov  6 11:53:08 2003
From: MCStoufer at lbl.gov (Martin Stoufer)
Date: Thu, 06 Nov 2003 08:53:08 -0800
Subject: [Twisted-Python] Form model examples
Message-ID: <3FAA7C74.6090200@lbl.gov>

I noticed that the Form model document page 
(http://www.twistedmatrix.com/documents/howto/formindepth) had not been 
put up yet. Does anyone out there have any working examples that uses 
this or has some more info on the twisted.web.woven.form 
<http://www.twistedmatrix.com/documents/TwistedDocs/current/api/toc-twisted.web.woven.form.html> 
class? Furthermore, if I can get enough knowledge on this, I would be 
happy to help contribute to the formindepth page.


-- 
* Martin C. Stoufer              *
* MCStoufer at lbl.gov              *
* DIDC/DSD/ITG                   *
* Lawrence Berkeley National Lab *
* MS 50B-2215 510-486-6882       *





-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031106/2cda0e4a/attachment.htm 

From dp at twistedmatrix.com  Thu Nov  6 13:40:15 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Thu, 6 Nov 2003 13:40:15 -0500
Subject: [Twisted-Python] Form model examples
In-Reply-To: <3FAA7C74.6090200@lbl.gov>
References: <3FAA7C74.6090200@lbl.gov>
Message-ID: <A9A0F792-1088-11D8-ABCC-000A95864FC4@twistedmatrix.com>


On Nov 6, 2003, at 11:53 AM, Martin Stoufer wrote:

> I noticed that the Form model document page 
> (http://www.twistedmatrix.com/documents/howto/formindepth) had not 
> been put up yet. Does anyone out there have any working examples that 
> uses this or has some more info on thetwisted.web.woven.formclass? 
> Furthermore, if I can get enough knowledge on this, I would be happy 
> to help contribute to the formindepth page.

Handling form input in a way which is both very abstract and easy for 
the programmer to use without a lot of edge cases has turned out to be 
very difficult. As you may have heard, 'nevow' is the name of a new 
exploratory implementation of the woven ideas which will eventually 
become woven 2.0.  One of the goals of nevow is to take the ideas 
originally explored in twisted.python.formmethod and 
twisted.web.woven.form and re-implement them so they are cleaner, 
easier to use and extend, and have fewer edge cases. The new, 
in-development modules are nevow.formless and nevow.freeform.

Formless is a module which allows you to annotate object properties and 
method parameters with types (By declaring that the 'foo' property is a 
String, and the "bar" method takes two Integers, for example). Freeform 
is a module which uses this type information to automatically render 
forms on the web, perform input validation and form error rendering, 
and ultimately call methods on your objects or set properties on your 
objects.

I am at this very moment doing a lot of freeform development, so now 
would be a good time to raise your use cases, your expectations about 
using a system which renders and validates web forms, etc.

A good place to contact me is in #twisted on irc.openprojects.net. My 
nick is fzZzy.

dp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: text/enriched
Size: 1841 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031106/eb2f8d0c/attachment.bin 

From MCStoufer at lbl.gov  Thu Nov  6 15:56:41 2003
From: MCStoufer at lbl.gov (Martin Stoufer)
Date: Thu, 06 Nov 2003 12:56:41 -0800
Subject: [Twisted-Python] Form model examples
In-Reply-To: <A9A0F792-1088-11D8-ABCC-000A95864FC4@twistedmatrix.com>
References: <3FAA7C74.6090200@lbl.gov> <A9A0F792-1088-11D8-ABCC-000A95864FC4@twistedmatrix.com>
Message-ID: <3FAAB589.6040804@lbl.gov>

 >>I am at this very moment doing a lot of freeform development, so now 
would be a good >>time to raise your use cases, your expectations about 
using a system which renders and >>validates web forms, etc.

I have been put in the unfortunate position of having to 'renovate' a 
lot of existing WebKit oriented CGI scripts. As you would surmise, they 
are a complete failure wrt OO design.

The main use case for me is to generate a form that in itself sets the 
constraints, and thus not requiring much input validation. All the 
scripts I have to deal with present varying views into a DB. Without 
delving into the schema makes it hard to convey what I need.

I guess all I was looking for with Woven was some OO based mechanism to 
build a form w/o all the wvfactory and wmfactory methods for each form 
'widget'

I will take a look at Formless and see how far that gets me.

Thanks for your time!

>
> A good place to contact me is in #twisted on irc.openprojects.net. My 
> nick is fzZzy.
>
> dp
>
>

-- 
* Martin C. Stoufer              *
* MCStoufer at lbl.gov              *
* DIDC/DSD/ITG                   *
* Lawrence Berkeley National Lab *
* MS 50B-2215 510-486-6882       *









From andrew-twisted at puzzling.org  Thu Nov  6 19:49:19 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 7 Nov 2003 11:49:19 +1100
Subject: [Twisted-Python] Deferred problem
In-Reply-To: <000001c3a471$e6b30ee0$687ba8c0@vicky>
References: <000001c3a471$e6b30ee0$687ba8c0@vicky>
Message-ID: <20031107004918.GA16498@frobozz>

On Thu, Nov 06, 2003 at 09:26:00AM -0500, vicky lupien wrote:

[reordered slightly]
> 
>        def initPermissions(self, request):       #create and return the results of a sql query
>            group = request.getComponent(myguard.Authenticated).group
>            listGroup = group.split(',')
>            sql = "select permission from permissions where 1"
>            for item in listGroup:
>                sql += " or permissions.group='%s'" % item.lstrip()
>            theDeferred = self.dbpool.runQueryDict(sql)
>            return theDeferred.addCallback(self.makeDict)        # suppose to call makeDict when the results has arrived
> 
> 
>        def makeDict(self, results):
>                # when I print what is in results, I can see all the data from the sql query
>            listPermissions = []
>            for item in results:
>                listPermissions.append(item.get('permission'))
>            return listPermissions                   # return the new list but the function setUp receive a deferred
> 
>        def setUp(self, request, *args):
>            var = self.initPermissions(request)      #var is suppose to get the new list
>            print var

setUp is receiving a Deferred from self.initPermissions, but then doesn't
wait for its result to arrive.  You should instead do something more like:

        def setUp(self, request, *args):
            d = self.initPermissions(request)
            def printVar(var):
                print var
            d.addCallback(printVar)

Although ideally you should add an errback too, even if it is just
twisted.python.log.err.

(I don't know how this will interact with the rest of Woven, but hopefully
I've clarified how you should be using Deferreds a little)

-Andrew.




From cce at clarkevans.com  Thu Nov  6 21:14:54 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Thu, 6 Nov 2003 21:14:54 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311050932.23119.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com> <200311050248.07658.uwe@oss4u.com> <20031105103119.2695e083.itamar@itamarst.org> <200311050932.23119.uwe@oss4u.com>
Message-ID: <20031107021454.GA8402@clarkevans.com>

On Wed, Nov 05, 2003 at 09:32:23AM -0800, Uwe C. Schroeder wrote:
| > (3. Don't use RDBMS. Use an in-process database like ZODB or Quotient's
| > atop when it's done.)
| 
| :-) I'd probably do that with a web application, but even there I'll allways 
| prefer a "real" database system. In process databases may be faster, therefor 
| they are less relieable and correcting errors is a virtual impossibility.

If you are using PostgreSQL, Gerhard Haring has reportedly
made the async interface work,
http://sourceforge.net/mailarchive/message.php?msg_id=2688514

Clark



From uwe at oss4u.com  Thu Nov  6 23:22:14 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Thu, 6 Nov 2003 20:22:14 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031107021454.GA8402@clarkevans.com>
References: <200311041019.31926.uwe@oss4u.com> <200311050932.23119.uwe@oss4u.com> <20031107021454.GA8402@clarkevans.com>
Message-ID: <200311062022.14143.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Thursday 06 November 2003 06:14 pm, Clark C. Evans wrote:
> On Wed, Nov 05, 2003 at 09:32:23AM -0800, Uwe C. Schroeder wrote:
> | > (3. Don't use RDBMS. Use an in-process database like ZODB or Quotient's
> | > atop when it's done.)
> | >
> | :-) I'd probably do that with a web application, but even there I'll
> | : allways
> |
> | prefer a "real" database system. In process databases may be faster,
> | therefor they are less relieable and correcting errors is a virtual
> | impossibility.
>
> If you are using PostgreSQL, Gerhard Haring has reportedly
> made the async interface work,
> http://sourceforge.net/mailarchive/message.php?msg_id=2688514

Good link. I might start using that for some things.
For now I solved the scaling issue with an (more or less) ugly workaround. 
Since I'm using pb with  dedicated client software I made the logon a 2 step. 
The first step connects to a certain port and gets an IP-address and a port 
back. The server determines which process has the least number of clients 
connected and returns that address. That's where the client then connects for 
real work. So I now just have a bunch of twisted's running on different ports 
- - works nicely for a quickhack.
But in the long run I'll definitely have to do something about the database 
and automatic forking of more server processes.

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qx32jqGXBvRToM4RAmO+AJ97aLqBOO/LLNKd/Q8b3cLNAGOJWQCfZPeg
q1IHghLYQccuWpZISYhQ8+4=
=eY6H
-----END PGP SIGNATURE-----




From mailinglists at shechen.at  Fri Nov  7 03:51:55 2003
From: mailinglists at shechen.at (stephan)
Date: Fri, 07 Nov 2003 00:51:55 -0800
Subject: [Twisted-Python] sessions example
Message-ID: <oprx9ewtrswzeeq5@mail.geekmail.cc>

Just by reading the API doc I somehow cannot figure out how to use session 
in the twisted webserver. Would anybody be so kind and give my a short 
example of how to create a session, store some objects in it and then 
retrive the same session again.

That would be very helpful, thanks,

_stephan



From syver at inout.no  Fri Nov  7 05:05:18 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 11:05:18 +0100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <20031106111305.GA899@twistedmatrix.com>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no>
	<20031106111305.GA899@twistedmatrix.com>
Message-ID: <u7k2cqysh.fsf@inout.no>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> Can you please report these bugs to the tracker, if they aren't
> already?

Done.





From syver at inout.no  Fri Nov  7 05:12:13 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 11:12:13 +0100
Subject: [Twisted-Python] sessions example
In-Reply-To: <oprx9ewtrswzeeq5@mail.geekmail.cc>
References: <oprx9ewtrswzeeq5@mail.geekmail.cc>
Message-ID: <u3cd0qygy.fsf@inout.no>

stephan <mailinglists at shechen.at> writes:

> Just by reading the API doc I somehow cannot figure out how to use
> session in the twisted webserver. Would anybody be so kind and give my
> a short example of how to create a session, store some objects in it
> and then retrive the same session again.

class Foo:
    def doStuff(self):
        ....

You have to have the request.

session = request.getSession()
session.foo = Foo()

Now later in your application you can do:

foo = session.foo
foo.doStuff()

If you use the twisted web server for more than one logical
application you should probably do something like this.

class MyApplicationSession:
   .....

session = request.getSession()

session.sessions = {}

session.sessions[MyApplicationSession] = MyApplicationSession()

And something similar but another class for other applications.




 




From syver at inout.no  Fri Nov  7 07:30:26 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 13:30:26 +0100
Subject: [Twisted-Python] pb help needed.
Message-ID: <ullqspdi5.fsf@inout.no>

I have a bug in my woven application which manifests itself as
win32select failing after doing many http requests. The error is the
constant WSAENOBUFS and I it seems pretty likely that this is caused
by some socket related resource leaking for each request I make. This
hypothesis is further supported by observing that a host of
pb.ClientFactory instances are stopped when shutting down the
application after it crashes. This seems strange to me as I am
thorough in shutting down the connector after every request is
finished.

Turning to that trusty friend printf style debugging, shows that the
PBClientFactory is stopped correctly when performing requests to pages
that use the referenceable and wait for it's deferred's to
complete. There are two cases when it doesn't stop. 

The first is when I press reload quickly a number of times. Then I
just see start messages because my request finish method is not called
(it is a callback to the deferred returned by request.notifyFinish()).

The second case is when I call disconnect on the connector before it's
deferred has been realised. I see in the log the following pattern:
Starting pb.PBClientFactory, disconnect and then the attached event,
stopping factory is not called at all. After stepping I see that
disconnect doesn't do anything when it is called before the connection
has been realized.

So I have a bug, and it's in my code. My question is how does one
manage pb resources correctly and easily (I don't worry about
performance just yet) when each user needs to have it's own
connection?










From syver at inout.no  Fri Nov  7 08:43:51 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 14:43:51 +0100
Subject: [Twisted-Python] pb help needed.
In-Reply-To: <ullqspdi5.fsf@inout.no>
References: <ullqspdi5.fsf@inout.no>
Message-ID: <uznf8nvjc.fsf@inout.no>

Syver Enstad <syver at inout.no> writes:

> I have a bug in my woven application which manifests itself as
> win32select failing after doing many http requests. The error is the
> constant WSAENOBUFS and I it seems pretty likely that this is caused
> by some socket related resource leaking for each request I make. This
> hypothesis is further supported by observing that a host of
> pb.ClientFactory instances are stopped when shutting down the
> application after it crashes. This seems strange to me as I am
> thorough in shutting down the connector after every request is
> finished.
> 
> Turning to that trusty friend printf style debugging, shows that the
> PBClientFactory is stopped correctly when performing requests to pages
> that use the referenceable and wait for it's deferred's to
> complete. There are two cases when it doesn't stop. 
> 
> The first is when I press reload quickly a number of times. Then I
> just see start messages because my request finish method is not called
> (it is a callback to the deferred returned by request.notifyFinish()).
> 
> The second case is when I call disconnect on the connector before it's
> deferred has been realised. I see in the log the following pattern:
> Starting pb.PBClientFactory, disconnect and then the attached event,
> stopping factory is not called at all. After stepping I see that
> disconnect doesn't do anything when it is called before the connection
> has been realized.
> 
> So I have a bug, and it's in my code. My question is how does one
> manage pb resources correctly and easily (I don't worry about
> performance just yet) when each user needs to have it's own
> connection?

Here is what I have come up with so far. It doesn't solve the problem
where I don't get the request finish callback, but seems to be able to
disconnect even if not connected when disconnect is called.

class MyPBClientFactory(pb.PBClientFactory):
    def disconnect(self):
        if not self._broker:
            deferred = self.getRootObject()
            deferred.addCallback(
                lambda unused: pb.PBClientFactory.disconnect(self))
        else:
            pb.PBClientFactory.disconnect(self)





From syver at inout.no  Fri Nov  7 12:20:08 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 18:20:08 +0100
Subject: [Twisted-Python] pb help needed.
In-Reply-To: <uznf8nvjc.fsf@inout.no>
References: <ullqspdi5.fsf@inout.no> <uznf8nvjc.fsf@inout.no>
Message-ID: <ufzh0nliv.fsf@inout.no>

Syver Enstad <syver at inout.no> writes:

> Syver Enstad <syver at inout.no> writes:
> 
> > I have a bug in my woven application which manifests itself as
> > win32select failing after doing many http requests. The error is the
> > constant WSAENOBUFS and I it seems pretty likely that this is caused
> > by some socket related resource leaking for each request I make. This
> > hypothesis is further supported by observing that a host of
> > pb.ClientFactory instances are stopped when shutting down the
> > application after it crashes. This seems strange to me as I am
> > thorough in shutting down the connector after every request is
> > finished.
> > 
> > Turning to that trusty friend printf style debugging, shows that the
> > PBClientFactory is stopped correctly when performing requests to pages
> > that use the referenceable and wait for it's deferred's to
> > complete. There are two cases when it doesn't stop. 
> > 
> > The first is when I press reload quickly a number of times. Then I
> > just see start messages because my request finish method is not called
> > (it is a callback to the deferred returned by request.notifyFinish()).
> > 
> > The second case is when I call disconnect on the connector before it's
> > deferred has been realised. I see in the log the following pattern:
> > Starting pb.PBClientFactory, disconnect and then the attached event,
> > stopping factory is not called at all. After stepping I see that
> > disconnect doesn't do anything when it is called before the connection
> > has been realized.
> > 
> > So I have a bug, and it's in my code. My question is how does one
> > manage pb resources correctly and easily (I don't worry about
> > performance just yet) when each user needs to have it's own
> > connection?
> 
> Here is what I have come up with so far. It doesn't solve the problem
> where I don't get the request finish callback, but seems to be able to
> disconnect even if not connected when disconnect is called.
> 
> class MyPBClientFactory(pb.PBClientFactory):
>     def disconnect(self):
>         if not self._broker:
>             deferred = self.getRootObject()
>             deferred.addCallback(
>                 lambda unused: pb.PBClientFactory.disconnect(self))
>         else:
>             pb.PBClientFactory.disconnect(self)

Since the last post I moved to a persistent PBClientFactory so that
disconnects is not a problem. This fixes the crashes, but there are
still resources that are not released. I only see perspective attached
messages in the log, until I kill twistd when I get a host of detached
messages. My next question must be how do I detach the perspectives in
an orderly fashion after each request? This seems to run into the same
problems as I had with not being able to do cleanup for each request.





From lafou at wanadoo.fr  Fri Nov  7 12:22:36 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 07 Nov 2003 18:22:36 +0100
Subject: [Twisted-Python] twistd and woven restart
Message-ID: <1068225756.7190.5.camel@pcmarie>

Hi,

I'm playing with woven and twistd. Every time I change something, I have
to stop the server, and start it again (except for HTML changes in
templates). Am I doing something wrong ? This is very painful to restart
every time !

I'd love to see a deploy tool like a j2ee application server (you would
just put your tap in the deploy environnement, and the app server loads
it automatically). There was such a tool before in twisted, but it was
removed :( (can't remember the name).

thx for advice !

--
Phil




From lafou at wanadoo.fr  Fri Nov  7 12:30:16 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 07 Nov 2003 18:30:16 +0100
Subject: [Twisted-Python] Woven broken by exceptions
Message-ID: <1068226216.7191.8.camel@pcmarie>

Hi,


when Woven (or twistd) catch exceptions like that :

exceptions.Exception: Node had a model=rootURL attribute, but the
submodel was not found in [<__builtin__.PGAT_Index instance at
0x8488ec4>].

I can't access any pages of the site. I have to restart the whole
service ! Is it normal ? (means that is there's a bug on a site, the
whole site will crash down)
:(




From MCStoufer at lbl.gov  Fri Nov  7 13:40:39 2003
From: MCStoufer at lbl.gov (Martin Stoufer)
Date: Fri, 07 Nov 2003 10:40:39 -0800
Subject: [Twisted-Python] sessions example
In-Reply-To: <oprx9ewtrswzeeq5@mail.geekmail.cc>
References: <oprx9ewtrswzeeq5@mail.geekmail.cc>
Message-ID: <3FABE727.2090107@lbl.gov>

Stephan,
   I found the following link helpful:

http://twistedmatrix.com/documents/howto/picturepile#auto2


stephan wrote:

>
> Just by reading the API doc I somehow cannot figure out how to use 
> session in the twisted webserver. Would anybody be so kind and give my 
> a short example of how to create a session, store some objects in it 
> and then retrive the same session again.
>
> That would be very helpful, thanks,
>
> _stephan
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


-- 
* Martin C. Stoufer              *
* DIDC/DSD/ITG                   *
* Lawrence Berkeley National Lab *
* MS 50B-2215 510-486-8662       *





From corydodt at twistedmatrix.com  Fri Nov  7 14:38:54 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Fri, 07 Nov 2003 11:38:54 -0800
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <u7k2cqysh.fsf@inout.no>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no>	<20031106111305.GA899@twistedmatrix.com> <u7k2cqysh.fsf@inout.no>
Message-ID: <3FABF4CE.5030100@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Syver,

I'm the win32 buildmeister, so I'm looking for this bug to see if I can
reproduce it.  Are you sure you hit "save" on the bug? I can't find it
on any combination of win32, compile, build, windows...

Also, assigning it to me probably wouldn't be a bad thing.

C

Syver Enstad wrote:
| Christopher Armstrong <radix at twistedmatrix.com> writes:
|
|
|>Can you please report these bugs to the tracker, if they aren't
|>already?
|
|
| Done.
|
|
|
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows XP)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/q/TO3A5SrXAiHQcRAqjdAJ0e/7TSVKrJAuinM/VH6gdMSuxShgCffpEF
Hf9aX2cb+QPCOk4abfLw2Vo=
=2G6A
-----END PGP SIGNATURE-----



From andrew-twisted at puzzling.org  Fri Nov  7 21:51:31 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 8 Nov 2003 13:51:31 +1100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <3FABF4CE.5030100@twistedmatrix.com>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no> <20031106111305.GA899@twistedmatrix.com> <u7k2cqysh.fsf@inout.no> <3FABF4CE.5030100@twistedmatrix.com>
Message-ID: <20031108025131.GB17626@frobozz>

On Fri, Nov 07, 2003 at 11:38:54AM -0800, Cory Dodt wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> Syver,
> 
> I'm the win32 buildmeister, so I'm looking for this bug to see if I can
> reproduce it.  Are you sure you hit "save" on the bug? I can't find it
> on any combination of win32, compile, build, windows...
> 
> Also, assigning it to me probably wouldn't be a bad thing.

The twistw bug was submitted, and has already been fixed:
    http://twistedmatrix.com/users/roundup.twistd/twisted/issue389

I see no sign of the build problems in the bug tracker, though.

-Andrew.




From lafou at wanadoo.fr  Sat Nov  8 04:34:47 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sat, 08 Nov 2003 10:34:47 +0100
Subject: [Twisted-Python] API doc
Message-ID: <1068284086.4854.1.camel@pcmarie>

I just discovered the twisted-1.1.0 API doc.
The "Inherited from ..." part are a GREAT idea ! Does it come from
epydoc, or it's twisted related ?




From andrew-twisted at puzzling.org  Sat Nov  8 04:52:44 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 8 Nov 2003 20:52:44 +1100
Subject: [Twisted-Python] API doc
In-Reply-To: <1068284086.4854.1.camel@pcmarie>
References: <1068284086.4854.1.camel@pcmarie>
Message-ID: <20031108095244.GD17626@frobozz>

On Sat, Nov 08, 2003 at 10:34:47AM +0100, Philippe Lafoucri?re wrote:
> I just discovered the twisted-1.1.0 API doc.
> The "Inherited from ..." part are a GREAT idea ! Does it come from
> epydoc, or it's twisted related ?

You can thank epydoc for that :)

-Andrew.




From lafou at wanadoo.fr  Sat Nov  8 06:17:08 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sat, 08 Nov 2003 12:17:08 +0100
Subject: [Twisted-Python] API doc
In-Reply-To: <20031108095244.GD17626@frobozz>
References: <1068284086.4854.1.camel@pcmarie>
	 <20031108095244.GD17626@frobozz>
Message-ID: <1068290228.4854.6.camel@pcmarie>

> You can thank epydoc for that :)


this is a great feature :)
thank you epydoc, and thank you Andrew for response





From andrew-twisted at puzzling.org  Sat Nov  8 09:12:50 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 9 Nov 2003 01:12:50 +1100
Subject: [Twisted-Python] Re: [Twisted-commits] make log.err return the thing you pass to it
In-Reply-To: <E1AIRcj-0002Wl-00@wolfwood>
References: <E1AIRcj-0002Wl-00@wolfwood>
Message-ID: <20031108141250.GE17626@frobozz>

On Sat, Nov 08, 2003 at 04:51:25AM -0700, radix CVS wrote:
> Modified files:
> Twisted/twisted/python/log.py 1.52 1.53
> 
> Log message:
> make log.err return the thing you pass to it

Isn't this a fairly significant change to the API?  Now doing
deferred.addErrback(log.err) will log the error, and then log it again when
the deferred is garbage-collected...

I guess it won't actually break anything, just add some confusion to log
files, but what's the new idiom for

    d.addErrback(log.err)   # log and swallow any errors that happened

going to be?

-Andrew.




From glyph at twistedmatrix.com  Sat Nov  8 11:25:59 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 8 Nov 2003 11:25:59 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] make log.err return the thing you pass to it
In-Reply-To: <20031108141250.GE17626@frobozz>
References: <E1AIRcj-0002Wl-00@wolfwood> <20031108141250.GE17626@frobozz>
Message-ID: <3CDD80E8-1208-11D8-B427-000393C9700E@twistedmatrix.com>

On Nov 8, 2003, at 9:12 AM, Andrew Bennetts wrote:

> Isn't this a fairly significant change to the API?

Yes, and an unnecessary one.  Revert it, and add a 'passerr' method, if 
you really need one.




From glyph at twistedmatrix.com  Sat Nov  8 11:30:23 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 8 Nov 2003 11:30:23 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] make log.err return the thing you pass to it
In-Reply-To: <20031108141250.GE17626@frobozz>
References: <E1AIRcj-0002Wl-00@wolfwood> <20031108141250.GE17626@frobozz>
Message-ID: <DA19957B-1208-11D8-B427-000393C9700E@twistedmatrix.com>

I guess somebody else beat me to telling radix to revert :).  Also,

On Nov 8, 2003, at 9:12 AM, Andrew Bennetts wrote:

> I guess it won't actually break anything

Actually, it will break things, as exarkun pointed out on IRC:

	foo.addErrback(log.err).addCallback(cleanup)

will no longer call 'cleanup'.  Totally unnecessary breakage.




From allison at shasta.stanford.edu  Sat Nov  8 11:38:57 2003
From: allison at shasta.stanford.edu (Dennis Allison)
Date: Sat, 8 Nov 2003 08:38:57 -0800 (PST)
Subject: [Twisted-Python] resource recovery on shutdown
In-Reply-To: <3CDD80E8-1208-11D8-B427-000393C9700E@twistedmatrix.com>
Message-ID: <Pine.LNX.4.44.0311080835010.28163-100000@shasta.stanford.edu>

How does twisted shut things down and recover resources when implementing 
a reverse-proxy.  If one or another of the endpoints dies, I would expect 
there to be some shutdown code to close open sockets, etc.  but I don't 
seem to be able to find it.  Can someone assist?





From allison at shasta.stanford.edu  Sat Nov  8 11:49:38 2003
From: allison at shasta.stanford.edu (Dennis Allison)
Date: Sat, 8 Nov 2003 08:49:38 -0800 (PST)
Subject: [Twisted-Python] resource recovery on shutdown
In-Reply-To: <Pine.LNX.4.44.0311080835010.28163-100000@shasta.stanford.edu>
Message-ID: <Pine.LNX.4.44.0311080848230.28163-100000@shasta.stanford.edu>

And one more thing.  How are timeouts on connections managed?  

On Sat, 8 Nov 2003, Dennis Allison wrote:

> 
> How does twisted shut things down and recover resources when implementing 
> a reverse-proxy.  If one or another of the endpoints dies, I would expect 
> there to be some shutdown code to close open sockets, etc.  but I don't 
> seem to be able to find it.  Can someone assist?
> 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 

-- 
Dennis Allison * Computer Systems Laboratory * Gates 227
               * Stanford University *  Stanford CA  94305
	       * (650) 723-9213 * (650) 723-0033 fax
	       * allison at shasta.stanford.edu
	       * allison at sumeru.stanford.edu





From obowah at yahoo.com  Sat Nov  8 13:47:09 2003
From: obowah at yahoo.com (rddda)
Date: Sat, 8 Nov 2003 10:47:09 -0800 (PST)
Subject: [Twisted-Python] Quotient mktap problem
Message-ID: <20031108184709.75897.qmail@web10708.mail.yahoo.com>

anyone here using Quotient?
it builds, but on 'mktap quotient' i get an error
where it tries to build 'atop'.
it tries to import '_bsddb'. I am using bsddb3 - which
i believe is the more recent version of bsddb. i can
fix the import, but then i have problem with procs
within. stops at DBEnv() which is supposed to be in
bsddb3, but doesn't seem to be available.
any thoughts/clues?
twisted-1.1.0
quotient-0.7.0
on OpenBSD

__________________________________
Do you Yahoo!?
Protect your identity with Yahoo! Mail AddressGuard
http://antispam.yahoo.com/whatsnewfree



From glyph at twistedmatrix.com  Sun Nov  9 01:06:19 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 9 Nov 2003 01:06:19 -0500
Subject: [Twisted-Python] Quotient mktap problem
In-Reply-To: <20031108184709.75897.qmail@web10708.mail.yahoo.com>
References: <20031108184709.75897.qmail@web10708.mail.yahoo.com>
Message-ID: <D633981A-127A-11D8-B427-000393C9700E@twistedmatrix.com>

On Nov 8, 2003, at 1:47 PM, rddda wrote:

> anyone here using Quotient?

It sounds like both your pybsddb  bindings and bsddb system library are 
too old.  Try upgrading.

Also, please discuss this on divmod-dev at divmod.org.




From syver at inout.no  Mon Nov 10 04:23:31 2003
From: syver at inout.no (Syver Enstad)
Date: 10 Nov 2003 10:23:31 +0100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <20031108025131.GB17626@frobozz>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no>
	<20031106111305.GA899@twistedmatrix.com> <u7k2cqysh.fsf@inout.no>
	<3FABF4CE.5030100@twistedmatrix.com> <20031108025131.GB17626@frobozz>
Message-ID: <ud6c07f1o.fsf@inout.no>

Andrew Bennetts <andrew-twisted at puzzling.org> writes:

> On Fri, Nov 07, 2003 at 11:38:54AM -0800, Cory Dodt wrote:
> > -----BEGIN PGP SIGNED MESSAGE-----
> > Hash: SHA1
> > 
> > Syver,
> > 
> > I'm the win32 buildmeister, so I'm looking for this bug to see if I can
> > reproduce it.  Are you sure you hit "save" on the bug? I can't find it
> > on any combination of win32, compile, build, windows...
> > 
> > Also, assigning it to me probably wouldn't be a bad thing.
> 
> The twistw bug was submitted, and has already been fixed:
>     http://twistedmatrix.com/users/roundup.twistd/twisted/issue389
> 
> I see no sign of the build problems in the bug tracker, though.

That's because I haven't submitted a bug report on it. 





From syver at inout.no  Mon Nov 10 05:58:18 2003
From: syver at inout.no (Syver Enstad)
Date: 10 Nov 2003 11:58:18 +0100
Subject: [Twisted-Python] pb help needed.
In-Reply-To: <ufzh0nliv.fsf@inout.no>
References: <ullqspdi5.fsf@inout.no> <uznf8nvjc.fsf@inout.no>
	<ufzh0nliv.fsf@inout.no>
Message-ID: <u3ccw7anp.fsf@inout.no>

How does one detach a perspective? Is there a callRemote method on a
reference that does this or what? Or is it not a problem that a long
running server calls getPerspective and unbounded number of times (I
have two twisted servers communicating via pb).





From itamar at itamarst.org  Mon Nov 10 11:13:04 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 10 Nov 2003 11:13:04 -0500
Subject: [Twisted-Python] pb help needed.
In-Reply-To: <u3ccw7anp.fsf@inout.no>
References: <ullqspdi5.fsf@inout.no>
	<uznf8nvjc.fsf@inout.no>
	<ufzh0nliv.fsf@inout.no>
	<u3ccw7anp.fsf@inout.no>
Message-ID: <20031110111304.1d601fe4.itamar@itamarst.org>

On 10 Nov 2003 11:58:18 +0100
Syver Enstad <syver at inout.no> wrote:

> 
> How does one detach a perspective? Is there a callRemote method on a
> reference that does this or what? Or is it not a problem that a long
> running server calls getPerspective and unbounded number of times (I
> have two twisted servers communicating via pb).

1.1 no longer has the concept of detaching. You can track live
perspectives and choose to not allow users to login if there's still a
connection, or not as you will. Look a bit at
http://twistedmatrix.com/documents/howto/pclients, and put the
appropriate logic in your realm'ds requestAvatar.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From phil at bubblehouse.org  Mon Nov 10 16:12:02 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Mon, 10 Nov 2003 16:12:02 -0500 (EST)
Subject: [Twisted-Python] Twisted Java
Message-ID: <1646.65.246.170.211.1068498722.squirrel@192.168.0.2>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

so, what's the chance of this ever supporting the new auth framework?

i don't want to get into a "why use java, anyway?" debate, but i was just
curious if there were any plans to continue supporting Java with the
twisted framework.

thanks,

- -phil
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (Darwin)

iD8DBQE/r/8cu8x7iJQ4TqURAugoAKCFBpft+N+IhkoSVk+b7+/+AqxJLQCfXrM/
wDDO+TcyH8kpsDANd58xhEE=
=w56/
-----END PGP SIGNATURE-----



From itamar at itamarst.org  Mon Nov 10 17:03:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 10 Nov 2003 17:03:20 -0500
Subject: [Twisted-Python] Twisted Java
In-Reply-To: <1646.65.246.170.211.1068498722.squirrel@192.168.0.2>
References: <1646.65.246.170.211.1068498722.squirrel@192.168.0.2>
Message-ID: <20031110170320.640886ac.itamar@itamarst.org>

On Mon, 10 Nov 2003 16:12:02 -0500 (EST)
"Phil Christensen" <phil at bubblehouse.org> wrote:

> so, what's the chance of this ever supporting the new auth framework?
> 
> i don't want to get into a "why use java, anyway?" debate, but i was
> just curious if there were any plans to continue supporting Java with
> the twisted framework.

I'm not used to having actual users for this code :)

I'll see about adding it sometime this week and doing a new release. 

Long term plans include rewriting to use java.nio when newpb is done, so
if java 1.4 is a problem better say so now. Probably will include EIO
high-level async framework and Straw PB-based transparent java RMI if I
can, and maybe even java cred so you can write PB servers easily.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Mon Nov 10 20:11:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 10 Nov 2003 20:11:15 -0500
Subject: [Twisted-Python] HTTP Basic Auth using cred, an example
Message-ID: <20031110201115.187d566b.itamar@itamarst.org>

I've put up some code showing how to use HTTP Basic authentication
together with cred to guard a resource at
http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue393

You need to implement a realm that returns resources, and then wrap it
in a portal with an appropriate username/password credential checker.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From twisted at zadka.site.co.il  Tue Nov 11 02:47:21 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 11 Nov 2003 07:47:21 -0000
Subject: [Twisted-Python] HTTP Basic Auth using cred, an example
In-Reply-To: <20031110201115.187d566b.itamar@itamarst.org>
References: <20031110201115.187d566b.itamar@itamarst.org>
Message-ID: <20031111074721.26202.qmail@green.zadka.com>

On Mon, 10 Nov 2003, Itamar Shtull-Trauring <itamar at itamarst.org> wrote:

> I've put up some code showing how to use HTTP Basic authentication
> together with cred to guard a resource at
> http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue393

I put a somewhat different version there.
Outside of some cosmetics, not that it .addBoth the logout to the
notifyDone. This is important: the user should be logged out if the
request is severed mid-output

> You need to implement a realm that returns resources, and then wrap it
> in a portal with an appropriate username/password credential checker.

Of course, simpleguard.MarkingRealm can be used for that :)



From graham at hansell.co.uk  Tue Nov 11 10:18:06 2003
From: graham at hansell.co.uk (Graham Hansell)
Date: Tue, 11 Nov 2003 15:18:06 +0000
Subject: [Twisted-Python] A real Newbie question - how to get started
Message-ID: <3FB0FDAE.8010906@hansell.co.uk>

Dear All Twisters out there.

I am a complete Twisted newbie (with a little bit of Python experience) 
and having just installed this (what looks like) a great package, I 
would like advice on my next step.

I am looking to start doing simple (spider) based web clients but really 
would like a guide or tutorial before jsut spending hours pulling my 
hair out. Where do you advise me to go. I have had a look at the 
Tutorial on Finger but this seems like a major development in an area I 
don't even understand.

Is there any specific newbie guides being built or assembled  possibly 
by those on this list.

Thanks for your help with something that could just change my life (well 
a bit of it anyway).

Graham




From pb_twisted at olga.mine.nu  Tue Nov 11 10:31:54 2003
From: pb_twisted at olga.mine.nu (Patrik Blommaskog)
Date: Tue, 11 Nov 2003 16:31:54 +0100
Subject: [Twisted-Python] Twisted and mod_python?
Message-ID: <JAEDJDIBADCJHPFLNEDFIEHKCBAA.pb_twisted@olga.mine.nu>

I am wondering about the feasibility of using mod_python in an Apache server
to make PB requests to a Twisted application.

That is, I have a Twisted application which servers PB requests, e.g. a user
manager. I also have an Apache server. I would like the Apache server to
present dynamic web pages based on the contents of the user manager
application, to act as a web front end (e.g. create/erase/modify user
properties). I was thinking that it could be possible to use mod_python and
Twisted to act as a client to the user manager.

My questions are:

1. Is this possible, fesible and/or reasonable? If so, any hints or examples
would be welcome.

2. Any alternative/better solutions?


I suppose it would be rather easy to use CGI instead, but I'd like to
explore the options.


- Patrik







From vlupien at drummonddesigns.com  Tue Nov 11 13:45:41 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Tue, 11 Nov 2003 13:45:41 -0500
Subject: [Twisted-Python] setUp and rendering
Message-ID: <000001c3a884$024e6f30$687ba8c0@vicky>

I'm  working on a web based application.  I found that the function
setUp is done before the rendering (wmfactory, etc...) of the page.
But I need to have a function that is done after the rendering.  Is
there a function that I can override that do what I need.
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031111/677051f6/attachment.htm 

From phil at bubblehouse.org  Tue Nov 11 14:03:39 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Tue, 11 Nov 2003 14:03:39 -0500 (EST)
Subject: [Twisted-Python] an easy twisted application question
Message-ID: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>

okay, so if i've got a tap with the following updateApplication method:

def updateApplication(app, config):
	app.registry = registry.Registry()
	...
	...

and i want to access that app.registry attribute from an arbitrary
location, how do i do it?

i seem to remember hearing that there was only one instance of Application
in a process, so does that mean that there's some (forgive the Java-speak)
static method defined on the Application module that will get the current
running instance?

thanks in advance,

-phil



From exarkun at intarweb.us  Tue Nov 11 14:50:35 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 11 Nov 2003 14:50:35 -0500
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
Message-ID: <20031111195034.GA14487@intarweb.us>

On Tue, Nov 11, 2003 at 02:03:39PM -0500, Phil Christensen wrote:
> okay, so if i've got a tap with the following updateApplication method:
> 
> def updateApplication(app, config):
> 	app.registry = registry.Registry()
> 	...
> 	...
> 
> and i want to access that app.registry attribute from an arbitrary
> location, how do i do it?
> 
> i seem to remember hearing that there was only one instance of Application
> in a process, so does that mean that there's some (forgive the Java-speak)
> static method defined on the Application module that will get the current
> running instance?

  The old way of doing this would be...

    from twisted.internet.app import theApplication
    theApplication.registry

  However, this bites.

  Newly written programs should implement makeService() instead of
updateApplication().  As a bonus, purely service-based programs can easily
and cleanly do things like the above:

    from twisted.application import service

    class RegistryService(service.Service):
        def __init__(self):
            self.registry = registry.Registry()

    def makeService(config):
        s = RegistryService()
        ...
        anotherS = SomeotherService()
        anotherS.setServiceParent(s)  # Or s.setServiceParent(anotherS)
        ...
        return s # or return anotherS

  `s' can be the parent service of other services, in which case it can be
accessed simply by looking up the parent service, or it could be a child
service of something else, in which case it would be accessed via a call to
getServiceNamed() on the appropriate parent.

  This avoids the need for globals and lets services/applications be more
readily configurable alongside other services/applications (since neither
will have global state that might interfer with the other).

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031111/c0128514/attachment.pgp 

From phil at bubblehouse.org  Tue Nov 11 16:28:55 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Tue, 11 Nov 2003 16:28:55 -0500 (EST)
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <20031111195034.GA14487@intarweb.us>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
    <20031111195034.GA14487@intarweb.us>
Message-ID: <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>

Okay, that answers another question I had, but I'm still not clear on how
to get at that service object from a couple of places.

For example, here's my Realm implementation:

class InnerSpaceRealm:
    __implements__ = portal.IRealm

    def requestAvatar(self, avatarId, mind, *interfaces):
        if pb.IPerspective in interfaces:
            registry = ### how do i get this?
            avatar = UserPerspective(mind, registry.get(avatarId))
            return pb.IPerspective, avatar, avatar.logout
        else:
            raise NotImplementedError("no interface")

what's the right way to get that service object?

this issue comes up again in my UserPerspective class, where i need to
access that registry object during perspective_xxx methods...

there is a part of me that just wants to use registry as a one-off class
with a class variable that returns the current instance, but i don't like
that part ;-).....

thanks again,
-phil


>   Newly written programs should implement makeService() instead of
> updateApplication().  As a bonus, purely service-based programs can easily
> and cleanly do things like the above:
>
>     from twisted.application import service
>
>     class RegistryService(service.Service):
>         def __init__(self):
>             self.registry = registry.Registry()
>
>     def makeService(config):
>         s = RegistryService()
>         ...
>         anotherS = SomeotherService()
>         anotherS.setServiceParent(s)  # Or s.setServiceParent(anotherS)
>         ...
>         return s # or return anotherS
>
>   `s' can be the parent service of other services, in which case it can be
> accessed simply by looking up the parent service, or it could be a child
> service of something else, in which case it would be accessed via a call
> to
> getServiceNamed() on the appropriate parent.
>
>   This avoids the need for globals and lets services/applications be more
> readily configurable alongside other services/applications (since neither
> will have global state that might interfer with the other).
>
>   Jp
>



From stuart.hungerford at anu.edu.au  Tue Nov 11 20:23:49 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Wed, 12 Nov 2003 12:23:49 +1100
Subject: [Twisted-Python] Re: request getUser()/getPassword() in Woven and resources...
Message-ID: <6.0.0.22.0.20031112122128.01d7ebd0@anusf.anu.edu.au>

Hi all,

Was this question about getUser() etc ever resolved?


 > My question goes along the previous one in this thread.
 > How do you get the browser to prompt for a username and password?
 > My code is not woking and goes something like this: On every page request
 > a certain function is called, say genpage()...
 >
 > def genpage(request)
 >     request.getUser()
 >     request.getPassword()
 >
 >     return "hello world"
 >
 >
 > -> Browser does not prompt though. (And this does not even involve woven)
 >
 > _stephan




Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From exarkun at intarweb.us  Tue Nov 11 21:14:30 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 11 Nov 2003 21:14:30 -0500
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2> <20031111195034.GA14487@intarweb.us> <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>
Message-ID: <20031112021430.GA17246@intarweb.us>

On Tue, Nov 11, 2003 at 04:28:55PM -0500, Phil Christensen wrote:
> Okay, that answers another question I had, but I'm still not clear on how
> to get at that service object from a couple of places.
> 
> For example, here's my Realm implementation:
> 
> class InnerSpaceRealm:
>     __implements__ = portal.IRealm
> 
>     def requestAvatar(self, avatarId, mind, *interfaces):
>         if pb.IPerspective in interfaces:
>             registry = ### how do i get this?
>             avatar = UserPerspective(mind, registry.get(avatarId))
>             return pb.IPerspective, avatar, avatar.logout
>         else:
>             raise NotImplementedError("no interface")
> 
> what's the right way to get that service object?
> 

  Like so:

    class InnerSpaceRealm:
        __implements__ = portal.IRealm

        def __init__(self, service):
            self.service = service

        def requestAvatar(self, avatarId, mind, *interfaces):
            ...

  ;)  There are other ways, but I'm sure you don't need me to point them
out.  The key is, just do the obvious thing here.  There's no special way to
manage this.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031111/95cf485a/attachment.pgp 

From itamar at itamarst.org  Tue Nov 11 22:30:01 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 11 Nov 2003 22:30:01 -0500
Subject: [Twisted-Python] Twisted and mod_python?
In-Reply-To: <JAEDJDIBADCJHPFLNEDFIEHKCBAA.pb_twisted@olga.mine.nu>
References: <JAEDJDIBADCJHPFLNEDFIEHKCBAA.pb_twisted@olga.mine.nu>
Message-ID: <20031111223001.6dfe40be.itamar@itamarst.org>

On Tue, 11 Nov 2003 16:31:54 +0100
"Patrik Blommaskog" <pb_twisted at olga.mine.nu> wrote:

> I am wondering about the feasibility of using mod_python in an Apache
> server to make PB requests to a Twisted application.

You'd need to start the Twisted event loop up on each HTTP request.
Or... kinda. It's possible anyway, but you'll need to investigate
mod_python's interpreter lifetime model.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Tue Nov 11 22:31:39 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 11 Nov 2003 22:31:39 -0500
Subject: [Twisted-Python] A real Newbie question - how to get started
In-Reply-To: <3FB0FDAE.8010906@hansell.co.uk>
References: <3FB0FDAE.8010906@hansell.co.uk>
Message-ID: <20031111223139.4f8b26e9.itamar@itamarst.org>

On Tue, 11 Nov 2003 15:18:06 +0000
Graham Hansell <graham at hansell.co.uk> wrote:

> I am looking to start doing simple (spider) based web clients but
> really would like a guide or tutorial before jsut spending hours
> pulling my hair out. Where do you advise me to go. I have had a look
> at the Tutorial on Finger but this seems like a major development in
> an area I don't even understand.

Finger is trivial. It asks a remote server for info about a user.

E.g. "finger foo at example.com" at a unix command line will ask
example.com, using the finger protocol, for foo's info, whatever that
is. Typically a finger server will return contents of the file ".plan"
from the user's home directory.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From maoy at cis.upenn.edu  Tue Nov 11 22:46:14 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Tue, 11 Nov 2003 22:46:14 -0500 (EST)
Subject: [Twisted-Python] rpm package for twisted?
In-Reply-To: <1068071701.2980.1.camel@shock>
Message-ID: <Pine.LNX.4.44.0311112244190.13491-100000@klondike.cis.upenn.edu>

I tried to run rpmbuild -ba twist.spec on the NoDoc .bz2 file. The error 
messages were:

writing list of installed files to 'installed-files'
warning: install: modules installed to 
'/var/tmp/Twisted-buildroot/usr/lib/python2.2/site-packages/', which is 
not in Python's module search path (sys.path) -- you'll have to change the 
search path yourself
+ mkdir -p /var/tmp/Twisted-buildroot//usr/share/man/man1/
+ cp -a 'doc/man/*.1' /var/tmp/Twisted-buildroot//usr/share/man/man1/
cp: cannot stat `doc/man/*.1': No such file or directory
error: Bad exit status from /var/tmp/rpm-tmp.59933 (%install)


Yun


On Wed, 5 Nov 2003, Alexander Winston wrote:

> On Wed, 2003-11-05 at 16:57, Yun Mao wrote:
> > Hi, I found twisted package for debian in the official site. Is there a 
> > ready rpm package for twisted 1.1.0 release? thanks!
> 
> They are not distributed as far as I know, but the .spec file
> (Twisted/admin/twisted.spec) should produce RPMs without trouble.
> 




From glyph at twistedmatrix.com  Wed Nov 12 00:13:10 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Nov 2003 00:13:10 -0500
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <20031112021430.GA17246@intarweb.us>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2> <20031111195034.GA14487@intarweb.us> <4879.65.246.170.211.1068586135.squirrel@192.168.0.2> <20031112021430.GA17246@intarweb.us>
Message-ID: <3FB1C166.6090107@twistedmatrix.com>

Jp Calderone wrote:

>   ;)  There are other ways, but I'm sure you don't need me to point them
> out.  The key is, just do the obvious thing here.  There's no special way to
> manage this.

I might add that this is exactly the reason that Realm is an interface 
and not a class.  Considering that "session logic container" has 
infinite variability in its implementation, the restrictions on how a 
Realm has to work are _really_ light.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 256 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031112/ba998f69/attachment.pgp 

From itamar at itamarst.org  Wed Nov 12 00:22:28 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 12 Nov 2003 00:22:28 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor,
 never installing waker for now
In-Reply-To: <E1AJmqh-0004IX-00@wolfwood>
References: <E1AJmqh-0004IX-00@wolfwood>
Message-ID: <20031112002228.0a2a11a3.itamar@itamarst.org>

On Tue, 11 Nov 2003 21:43:23 -0700
etrepum CVS <etrepum at wolfwood.twistedmatrix.com> wrote:

> Modified files:
> Twisted/twisted/internet/cfreactor.py 1.3 1.4
> 
> Log message:
> Somehow the waker still messes up cfreactor, never installing waker
> for now

That means threaded programs with cfreactor will be really slow.

I think the issue is that the unix waker uses python sockets. You
probably want to write your own waker using whatever APIs you are using.

While we're at it - warner, could we have the mac os x reactor also run
tests with cfreactor?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Wed Nov 12 00:29:13 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Nov 2003 00:29:13 -0500
Subject: [Twisted-Python] Twisted and mod_python?
In-Reply-To: <20031111223001.6dfe40be.itamar@itamarst.org>
References: <JAEDJDIBADCJHPFLNEDFIEHKCBAA.pb_twisted@olga.mine.nu> <20031111223001.6dfe40be.itamar@itamarst.org>
Message-ID: <3FB1C529.4040508@twistedmatrix.com>

Itamar Shtull-Trauring wrote:

> You'd need to start the Twisted event loop up on each HTTP request.
> Or... kinda. It's possible anyway, but you'll need to investigate
> mod_python's interpreter lifetime model.

It's theoretically possible, but almost certainly a bad idea.  Do you 
already have a large mod_python-using codebase?

If not, Twisted includes HTTP support for a reason.  Just use it :).  To 
communicate with your apache server, use mod_proxy or something similar 
to just relay requests to the Twisted web server.

If you do have a large mod_python-using application already and you are 
trying to get it to talk to Twisted, you probably want to continue to 
use the mod_python execution model rather than spin up the twisted event 
loop and switch back and forth: while it's possible if you really need 
it, a better architectural strategy in the average case (to avoid odd 
interactions between the assumptions mod_python has about its 
environment and the assumptions twisted has about its) would be to use 
Twisted's XMLRPC support and talk to it using a blocking XMLRPC library 
from your mod_python scripts.


but-ask-me-again-when-warner-finishes-newpb-ly y'rs,

	-glyph
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 256 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031112/ce6aec11/attachment.pgp 

From bob at redivi.com  Wed Nov 12 01:20:07 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 12 Nov 2003 01:20:07 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor, never installing waker for now
In-Reply-To: <20031112002228.0a2a11a3.itamar@itamarst.org>
References: <E1AJmqh-0004IX-00@wolfwood> <20031112002228.0a2a11a3.itamar@itamarst.org>
Message-ID: <433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>


On Nov 12, 2003, at 12:22 AM, Itamar Shtull-Trauring wrote:

> On Tue, 11 Nov 2003 21:43:23 -0700
> etrepum CVS <etrepum at wolfwood.twistedmatrix.com> wrote:
>
>> Modified files:
>> Twisted/twisted/internet/cfreactor.py 1.3 1.4
>>
>> Log message:
>> Somehow the waker still messes up cfreactor, never installing waker
>> for now
>
> That means threaded programs with cfreactor will be really slow.
>
> I think the issue is that the unix waker uses python sockets. You
> probably want to write your own waker using whatever APIs you are 
> using.
>
> While we're at it - warner, could we have the mac os x reactor also run
> tests with cfreactor?

I don't know what the deal is, exactly, because it uses python sockets 
internally and that works perfectly fine.  I believe that something 
about the waker causes the run loop to think that it's always awake.  I 
didn't feel like looking too far into it.  That said, Apple's 
implementation of CFRunLoop does everything that the reactor does (and 
then some), including thread waking and other thread communication 
facilities.. so when I have more time I'll look into the cause and the 
appropriate solution.    IIRC the only part of Twisted that uses 
threads on its own is the DB stuff, anything else would probably be 
implemented using more native means (nobody uses cfreactor for 
cross-platform applications yet), so I don't see an immediate problem 
with ignoring the waker.  I'd rather punish threaded (from what Twisted 
sees) applications than make all applications really really slow and 
resource hungry.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031112/fe67f30f/attachment.bin 

From twisted at zadka.site.co.il  Wed Nov 12 01:49:23 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 12 Nov 2003 06:49:23 -0000
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>
References: <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>, <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
    <20031111195034.GA14487@intarweb.us>
Message-ID: <20031112064923.1644.qmail@green.zadka.com>

On Tue, 11 Nov 2003, "Phil Christensen" <phil at bubblehouse.org> wrote:

> class InnerSpaceRealm:
>     __implements__ = portal.IRealm
> 
>     def requestAvatar(self, avatarId, mind, *interfaces):
>         if pb.IPerspective in interfaces:
>             registry = ### how do i get this?
>             avatar = UserPerspective(mind, registry.get(avatarId))
>             return pb.IPerspective, avatar, avatar.logout
>         else:
>             raise NotImplementedError("no interface")
> 
> what's the right way to get that service object?

Others have already said that the right way is to "push, not pull":
give the service object as an argument to __init__.
I wanted to add that the correct way to pass the registry to
UserPerspective is probably much the same thing:

class UserPerspective:
    # ...
    def setRegistry(self, registry):
        self.registry = registry

class InnerSpaceRealm:
    __implements__ = portal.IRealm
    def __init__(self, registry):
        self.registry = registry

    def requestAvatar(self, avatarId, mind, *interfaces):
        if pb.IPerspective in interfaces:
            avatar = UserPerspective(mind, self.registry.get(avatarId))
            avatar.setRegistry(self.registry)
            return pb.IPerspective, avatar, avatar.logout
        else:
            raise NotImplementedError("no interface")



From glyph at twistedmatrix.com  Wed Nov 12 01:56:25 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Nov 2003 01:56:25 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still
 messes up cfreactor, never installing waker for now
In-Reply-To: <433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>
References: <E1AJmqh-0004IX-00@wolfwood> <20031112002228.0a2a11a3.itamar@itamarst.org> <433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>
Message-ID: <3FB1D999.6050104@twistedmatrix.com>

Bob Ippolito wrote:

> I don't know what the deal is, exactly, because it uses python sockets 
> internally and that works perfectly fine.  I believe that something 
> about the waker causes the run loop to think that it's always awake.  I 
> didn't feel like looking too far into it.  That said, Apple's 
> implementation of CFRunLoop does everything that the reactor does (and 
> then some), including thread waking and other thread communication 
> facilities.. so when I have more time I'll look into the cause and the 
> appropriate solution.    IIRC the only part of Twisted that uses threads 
> on its own is the DB stuff, anything else would probably be implemented 
> using more native means (nobody uses cfreactor for cross-platform 
> applications yet), so I don't see an immediate problem with ignoring the 
> waker.  I'd rather punish threaded (from what Twisted sees) applications 
> than make all applications really really slow and resource hungry.

If there are better thread communication facilities in the CFRunLoop, 
then make your reactor's call[From/In]Thread use them.  There's nothing 
intrinsically useful about the waker; it's an implementation detail of 
callFromThread which could be better done in another way.

However, "really slow" doesn't quite describe the problem.  A server 
which sends an event to a thread without a waker and then receives a 
callFromThread may never wake up, if there isn't more network activity 
happening.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 256 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031112/a43db6f5/attachment.pgp 

From corydodt at twistedmatrix.com  Wed Nov 12 03:05:42 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed, 12 Nov 2003 00:05:42 -0800
Subject: [Twisted-Python] tap2ntsvc in sandbox
Message-ID: <3FB1E9D6.1000609@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Twisted/sandbox/moonfallen/tap2ntsvc.py

If you have an Twisted application that you want to make into a service
on Windows, give this a try.  It's very basic right now; it absolutely
needs py2exe and Inno setup support before I'll consider it done.  The
goal is to have the output be a complete binary package analogous to the
output of tap2deb or tap2rpm.  The only difference will be that, instead
of depending on software like the Linux versions do, it will do as much
as it can to help you include the dependencies in the package using py2exe.

Right now, nothing beyond generating a service script is done.  Here's
the help:

Usage: tap2ntsvc.py [options] <filename>
Options:
~  -y, --type=          Config file type: pickle, xml, source, or python
~  -o, --output-file=   Name of the setup executable produced
~  -n, --name=          Short name of the service (used with "net start")
~  -d, --display-name=  Human-readable name of the service
~  -e, --description=   Description of the service
~  -r, --reactor=       Reactor to install (like twistd) [default: default]
~      --version
~      --help           Display this help and exit.

Do something like . . .

| python tap2ntsvc.py myapp.tac

The output is myappsvc.py (or <name>svc.py).  Then you run myappsvc.py:

| python myappsvc.py install
Installing service myapp to Python class
C:\myapp\myappsvc.myapp_ServiceControl
Changing service configuration
Service updated

| net start myapp
The myapp run by Twisted service is starting.
The myapp run by Twisted service was started successfully.


Give it a try, let me know if you have any problems with it.

Thanks,

C
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows XP)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/senW3A5SrXAiHQcRAvNdAJ4n7+yfvB/kcKD1pfGjfgqDbFgqcACcCDYZ
jqd+gw+guZ3xg4f5R6I8tIQ=
=kTlI
-----END PGP SIGNATURE-----



From warner at lothar.com  Wed Nov 12 03:37:36 2003
From: warner at lothar.com (Brian Warner)
Date: Wed, 12 Nov 2003 00:37:36 -0800 (PST)
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor,
 never installing waker for now
Message-ID: <20031112.003736.117867178.warner@lothar.com>

> While we're at it - warner, could we have the mac os x reactor also run
> tests with cfreactor?

Oh, does that work now? If I recall, that used to hang the buildslave.

I'll give it a try and turn on a cfreactor pass if it works.

 -Brian




From warner at lothar.com  Wed Nov 12 03:45:46 2003
From: warner at lothar.com (Brian Warner)
Date: Wed, 12 Nov 2003 00:45:46 -0800 (PST)
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor,
 never installing waker for now
Message-ID: <20031112.004546.115075450.warner@lothar.com>

> While we're at it - warner, could we have the mac os x reactor also run
> tests with cfreactor?

My tests failed:

24:buildbot at quartz% python2.2 bin/trial -to -r cf twisted.test
...
  File "/Users/buildbot/Buildbot/slave/OSX-full2.2/Twisted/twisted/internet/cfreactor.py", line 42, in ?
    import cfsupport as cf
ImportError: Failure linking new module


It might be related to the following warning during the compilation phase:

 gcc -arch ppc -bundle -flat_namespace -undefined suppress build/temp.darwin-6.8-Power Macintosh-2.2/cfsupport.o -o twisted/internet/cfsupport.so -framework CoreFoundation -framework CoreServices -framework Carbon
 ld: warning dynamic shared library: /usr/lib/libSystem.dylib not made a weak library in output with MACOSX_DEPLOYMENT_TARGET environment variable set to: 10.1


It doesn't hang, so I'm going to turn on the test anyway (it will just fail
all the time). I don't know a lot about OS-X linker magic.. somebody else
will have to figure out the problem here.

 -Brian




From rudy.schockaert at pandora.be  Wed Nov 12 04:17:38 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Wed, 12 Nov 2003 10:17:38 +0100
Subject: [Twisted-Python] Twisted Names references
Message-ID: <3FB1FAB2.50600@pandora.be>

Hi,

we would like to propose to a customer of our a solution based on 
Twisted Names. The customer is open to this suggestion, but asked us if 
we could provide references of companies using Twisted Names in production?
If you know of companies we can mention (Name and size of the company, 
ev. contact person) it would help us a lot.

Thanks in advance,

Rudy



From abe at fettig.net  Wed Nov 12 08:51:56 2003
From: abe at fettig.net (Abe Fettig)
Date: Wed, 12 Nov 2003 08:51:56 -0500
Subject: [Twisted-Python] tap2ntsvc in sandbox
In-Reply-To: <3FB1E9D6.1000609@twistedmatrix.com>
References: <3FB1E9D6.1000609@twistedmatrix.com>
Message-ID: <3FB23AFC.4040401@fettig.net>

Cory Dodt wrote:

> Twisted/sandbox/moonfallen/tap2ntsvc.py
> 
> If you have an Twisted application that you want to make into a service
> on Windows, give this a try. 

Wow, that's great!  Thanks Cory!

Abe




From bob at redivi.com  Wed Nov 12 09:58:32 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 12 Nov 2003 09:58:32 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor, never installing waker for now
In-Reply-To: <20031112.004546.115075450.warner@lothar.com>
References: <20031112.004546.115075450.warner@lothar.com>
Message-ID: <AF40E3FC-1520-11D8-BF3A-000A95686CD8@redivi.com>


On Nov 12, 2003, at 3:45 AM, Brian Warner wrote:

>> While we're at it - warner, could we have the mac os x reactor also  
>> run
>> tests with cfreactor?
>
> My tests failed:
>
> 24:buildbot at quartz% python2.2 bin/trial -to -r cf twisted.test
> ...
>   File  
> "/Users/buildbot/Buildbot/slave/OSX-full2.2/Twisted/twisted/internet/ 
> cfreactor.py", line 42, in ?
>     import cfsupport as cf
> ImportError: Failure linking new module
>
>
> It might be related to the following warning during the compilation  
> phase:
>
>  gcc -arch ppc -bundle -flat_namespace -undefined suppress  
> build/temp.darwin-6.8-Power Macintosh-2.2/cfsupport.o -o  
> twisted/internet/cfsupport.so -framework CoreFoundation -framework  
> CoreServices -framework Carbon
>  ld: warning dynamic shared library: /usr/lib/libSystem.dylib not made  
> a weak library in output with MACOSX_DEPLOYMENT_TARGET environment  
> variable set to: 10.1
>
>
> It doesn't hang, so I'm going to turn on the test anyway (it will just  
> fail
> all the time). I don't know a lot about OS-X linker magic.. somebody  
> else
> will have to figure out the problem here.

I will not EVER support that version of Python 2.2.  You'll need to use  
python2.3 ( http://homepages.cwi.nl/~jack/macpython/index.html ) or  
upgrade the machine to OS X 10.3.  If it works under that version of  
python, it's purely by chance.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031112/69ccb3cc/attachment.bin 

From itamar at itamarst.org  Wed Nov 12 10:41:54 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 12 Nov 2003 10:41:54 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still
 messes up cfreactor, never installing waker for now
In-Reply-To: <AF40E3FC-1520-11D8-BF3A-000A95686CD8@redivi.com>
References: <20031112.004546.115075450.warner@lothar.com>
	<AF40E3FC-1520-11D8-BF3A-000A95686CD8@redivi.com>
Message-ID: <20031112104154.70593b5a.itamar@itamarst.org>

On Wed, 12 Nov 2003 09:58:32 -0500
Bob Ippolito <bob at redivi.com> wrote:

> I will not EVER support that version of Python 2.2.  You'll need to
> use  python2.3 ( http://homepages.cwi.nl/~jack/macpython/index.html )
> or  upgrade the machine to OS X 10.3.  If it works under that version
> of  python, it's purely by chance.

And we do want a 2.2.0 buildbot going, since that's useful, and lets us
test OS X 10.2's python. Run another buildbot I guess?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Wed Nov 12 10:47:02 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 12 Nov 2003 10:47:02 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still
 messes up cfreactor, never installing waker for now
In-Reply-To: <3FB1D999.6050104@twistedmatrix.com>
References: <E1AJmqh-0004IX-00@wolfwood>
	<20031112002228.0a2a11a3.itamar@itamarst.org>
	<433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>
	<3FB1D999.6050104@twistedmatrix.com>
Message-ID: <20031112104702.515b3f5c.itamar@itamarst.org>

On Wed, 12 Nov 2003 01:56:25 -0500
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> However, "really slow" doesn't quite describe the problem.  A server 
> which sends an event to a thread without a waker and then receives a 
> callFromThread may never wake up, if there isn't more network activity
> 
> happening.

Yep, a reactor without a waker is essentially broken. It'll also break
the SIGCHILD handler in CVS. Please do try to find a solution before our
next release.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Wed Nov 12 11:24:06 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 12 Nov 2003 11:24:06 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor, never installing waker for now
In-Reply-To: <20031112104702.515b3f5c.itamar@itamarst.org>
References: <E1AJmqh-0004IX-00@wolfwood> <20031112002228.0a2a11a3.itamar@itamarst.org> <433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com> <3FB1D999.6050104@twistedmatrix.com> <20031112104702.515b3f5c.itamar@itamarst.org>
Message-ID: <A345F65A-152C-11D8-98F5-000A95686CD8@redivi.com>


On Nov 12, 2003, at 10:47 AM, Itamar Shtull-Trauring wrote:

> On Wed, 12 Nov 2003 01:56:25 -0500
> Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
>
>> However, "really slow" doesn't quite describe the problem.  A server
>> which sends an event to a thread without a waker and then receives a
>> callFromThread may never wake up, if there isn't more network activity
>>
>> happening.
>
> Yep, a reactor without a waker is essentially broken. It'll also break
> the SIGCHILD handler in CVS. Please do try to find a solution before 
> our
> next release.

Signals need a whole different approach because signals do not wake up 
CFRunLoop, so when you install handlers it wakes up once a second 
anyway.  The correct solution is to use a mach port waker for signals, 
I have not implemented this yet because there are no mach port 
facilities available from Python yet (I looked into it, but doing mach 
ports use a lot of C macros, so it would be hard).

When is next release planned?

-bob 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031112/be2b0fd3/attachment.bin 

From itamar at itamarst.org  Wed Nov 12 11:52:43 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 12 Nov 2003 11:52:43 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still
 messes up cfreactor, never installing waker for now
In-Reply-To: <A345F65A-152C-11D8-98F5-000A95686CD8@redivi.com>
References: <E1AJmqh-0004IX-00@wolfwood>
	<20031112002228.0a2a11a3.itamar@itamarst.org>
	<433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>
	<3FB1D999.6050104@twistedmatrix.com>
	<20031112104702.515b3f5c.itamar@itamarst.org>
	<A345F65A-152C-11D8-98F5-000A95686CD8@redivi.com>
Message-ID: <20031112115243.35fa9b3e.itamar@itamarst.org>

On Wed, 12 Nov 2003 11:24:06 -0500
Bob Ippolito <bob at redivi.com> wrote:

> When is next release planned?

Doesn't seem like anyone is in a real rush to have one.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From corydodt at twistedmatrix.com  Wed Nov 12 12:46:14 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed, 12 Nov 2003 09:46:14 -0800
Subject: [Twisted-Python] Re: tap2ntsvc in sandbox
In-Reply-To: <3FB1E9D6.1000609@twistedmatrix.com>
References: <3FB1E9D6.1000609@twistedmatrix.com>
Message-ID: <3FB271E6.1030009@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I should add that, if you do have any problems using it (e.g. net start
doesn't work), check the Application Log in Event Viewer.  There should be a
helpful traceback in an Error event.

C

Cory Dodt wrote:
| Twisted/sandbox/moonfallen/tap2ntsvc.py
|
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/snHm3A5SrXAiHQcRAkKHAJ43fuZ92WgpymWtgs0jBi3SEmIsFACeKHnE
OWPpZLdta3C2vuKhQuGSuEg=
=6bkB
-----END PGP SIGNATURE-----



From phil at bubblehouse.org  Wed Nov 12 13:25:06 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 12 Nov 2003 13:25:06 -0500 (EST)
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <20031111195034.GA14487@intarweb.us>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
    <20031111195034.GA14487@intarweb.us>
Message-ID: <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>

so i followed jp's advice, and my makeService method now looks like this:


###############code#################
def makeService(config):
    registry = Registry()
    reg_service = RegistryService(registry)
    portal = Portal(auth.InnerSpaceRealm(reg_service))
    checker = auth.RegistryChecker(registry)
    portal.registerChecker(checker)
    pb_service = internet.TCPServer(int(config['port']),
                                    pb.PBServerFactory(portal))
    reg_service.setServiceParent(pb_service)
    return pb_service
###############code#################


when i try to build my tap file now, i get


###############traceback#################
Traceback (most recent call last):
  File "/Users/phil/Python/Twisted/bin/mktap", line 30, in ?
    run()
  File "/Users/phil/Python/Twisted/twisted/scripts/mktap.py", line 160, in
run
    options.subOptions)
  File "/Users/phil/Python/Twisted/twisted/scripts/mktap.py", line 58, in
makeService
    ser = mod.makeService(options)
  File "./inner/space/bigbang.py", line 24, in makeService
    reg_service.setServiceParent(pb_service)
  File "/Users/phil/Python/Twisted/twisted/application/service.py", line
116, in setServiceParent
    self.parent.addService(self)
AttributeError: TCPServer instance has no attribute 'addService'
###############traceback#################


i've tried this both ways, with pb_service as the parent, and with
reg_service as the parent, with the same result.

btw, i am working out of a freshly checked-out cvs directory, but i doubt
that matters.

thanks again for any help,
-phil



>   Newly written programs should implement makeService() instead of
> updateApplication().  As a bonus, purely service-based programs can easily
> and cleanly do things like the above:
>
>     from twisted.application import service
>
>     class RegistryService(service.Service):
>         def __init__(self):
>             self.registry = registry.Registry()
>
>     def makeService(config):
>         s = RegistryService()
>         ...
>         anotherS = SomeotherService()
>         anotherS.setServiceParent(s)  # Or s.setServiceParent(anotherS)
>         ...
>         return s # or return anotherS
>
>   `s' can be the parent service of other services, in which case it can be
> accessed simply by looking up the parent service, or it could be a child
> service of something else, in which case it would be accessed via a call
> to getServiceNamed() on the appropriate parent.



From phil at bubblehouse.org  Wed Nov 12 13:59:43 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 12 Nov 2003 13:59:43 -0500 (EST)
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>  
    <20031111195034.GA14487@intarweb.us>
    <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>
Message-ID: <1734.65.246.170.211.1068663583.squirrel@192.168.0.2>

AHA!

i needed to have my parent class subclass MultiService, right? so i tried
this, and the tap built fine...hopefully it was the right thing (still
testing)...

-phil


class RegistryService(service.MultiService):
	def __init__(self, registry):
		service.MultiService.__init__(self)
		self.registry = registry

def makeService(config):
	registry = Registry()
	reg_service = RegistryService(registry)
	portal = Portal(auth.InnerSpaceRealm(reg_service))
	checker = auth.RegistryChecker(registry)
	portal.registerChecker(checker)
	pb_service = internet.TCPServer(int(config['port']),
pb.PBServerFactory(portal))
	pb_service.setServiceParent(reg_service)
	return reg_service



From justinjohnson at fastmail.fm  Wed Nov 12 15:00:48 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 12 Nov 2003 14:00:48 -0600
Subject: [Twisted-Python] Re: tap2ntsvc in sandbox
In-Reply-To: <3FB271E6.1030009@twistedmatrix.com>
References: <3FB1E9D6.1000609@twistedmatrix.com> <3FB271E6.1030009@twistedmatrix.com>
Message-ID: <20031112200049.C1B443E9D1@server1.messagingengine.com>

One problem I had with a python windows service in general ended up being
related to the following tech note.  Took me forever to figure out what
the problem was, but every one of the symptoms in the tech note applied. 
I'm posting this to hopefully save other's the headache.

The immediate output you see is as follows:

E:\scripts>winsvc.py start
Starting service RatControlService
Error starting service: The service did not respond to the start or
control request in a timely fashion.
E:\scripts>

More info was available in the event logs as described in the tech note.

http://support.microsoft.com/default.aspx?scid=kb;en-us;812485


-Justin

On Wed, 12 Nov 2003 09:46:14 -0800, "Cory Dodt"
<corydodt at twistedmatrix.com> said:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> I should add that, if you do have any problems using it (e.g. net start
> doesn't work), check the Application Log in Event Viewer.  There should
> be a
> helpful traceback in an Error event.
> 
> C
> 
> Cory Dodt wrote:
> | Twisted/sandbox/moonfallen/tap2ntsvc.py
> |
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.2.3-nr1 (Windows 2000)
> Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org
> 
> iD8DBQE/snHm3A5SrXAiHQcRAkKHAJ43fuZ92WgpymWtgs0jBi3SEmIsFACeKHnE
> OWPpZLdta3C2vuKhQuGSuEg=
> =6bkB
> -----END PGP SIGNATURE-----
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From lafou at wanadoo.fr  Wed Nov 12 19:05:59 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Thu, 13 Nov 2003 01:05:59 +0100
Subject: [Twisted-Python] Deferred model
Message-ID: <1068681959.7644.1.camel@pcmarie>

Hello

Can someone provide me a good example of a deferred model in woven ?
I have a big model to build, and the page takes a long time to render...
I didn't find any help on twisted site :(

thx for help
--
Philippe




From jsbenson at bensonsystems.com  Wed Nov 12 22:57:47 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Wed, 12 Nov 2003 19:57:47 -0800
Subject: [Twisted-Python] help please: trouble installing twisted python on Windows 2000 Pro, but not Windows XP Pro
Message-ID: <02f901c3a99a$4eef28e0$8209500a@jsbwxp3>

Hi, I just installed twisted python on my Windows XP laptop which has Python 2.3.2.

I went to install it on Windows 2000 Professional version 5.00.2195 Service Pack 4 running Python 2.3 and got the following dialog box diagnostic: "Setup: CreateFile failed; code 5. Access is denied." I've been able to install piles of stuff on this system before, so I figure I have the required administrative privileges. I logon to a Windows domain, and my ID is in the Administrators group of the domain. There is a separate Administrator logon local to the machine which I haven't used, and probably can't get the password for, since this is a managed PC within the domain.

Here are my questions:

1) What does the "code 5" failure mean?

2) What am I doing wrong?

3) Can I just move the twisted site-package folders over from my XP system Python 2.3 folder to the corresponding Windows 2000 Pro folder? I'm mostly interested in just importing the twisted modules and prototyping; I can do without the icons and start menu entries.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031112/96e145b0/attachment.htm 

From twisted at zadka.site.co.il  Thu Nov 13 02:44:03 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 13 Nov 2003 07:44:03 -0000
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>
References: <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>, <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
    <20031111195034.GA14487@intarweb.us>
Message-ID: <20031113074403.2304.qmail@green.zadka.com>

On Wed, 12 Nov 2003, "Phil Christensen" <phil at bubblehouse.org> wrote:

> so i followed jp's advice, and my makeService method now looks like this:
> 
> 
> ###############code#################
> def makeService(config):
>     registry = Registry()
>     reg_service = RegistryService(registry)
>     portal = Portal(auth.InnerSpaceRealm(reg_service))
>     checker = auth.RegistryChecker(registry)
>     portal.registerChecker(checker)
>     pb_service = internet.TCPServer(int(config['port']),
>                                     pb.PBServerFactory(portal))
>     reg_service.setServiceParent(pb_service)
>     return pb_service

Don't use a TCPServer as a parent, use a multi-service

    m = service.MultiService()
    reg_service.setServiceParent(m)
    pb_service.setServiceParent(m)
    return m



From sam at twistedmatrix.com  Thu Nov 13 14:45:52 2003
From: sam at twistedmatrix.com (Sam Jordan)
Date: Fri, 14 Nov 2003 05:45:52 +1000
Subject: [Twisted-Python] SSL.SysCallError in doRead
Message-ID: <20031113194552.GA26576@psychlaw.com.au>

Hi,

I noted the following exception while running some msn related
code earlier:

2003/11/14 05:09 EST [PassportLogin,client] Traceback (most recent call last):
          File "/home/sam/Twisted/twisted/python/log.py", line 65, in callWithLogger
            callWithContext({"system": lp}, func, *args, **kw)
          File "/home/sam/Twisted/twisted/python/log.py", line 52, in callWithContext
            return context.call({ILogContext: newCtx}, func, *args, **kw)
          File "/home/sam/Twisted/twisted/python/context.py", line 32, in callWithContext
            return func(*args,**kw)
          File "/home/sam/Twisted/twisted/internet/default.py", line 513, in _doReadOrWrite
            why = getattr(selectable, method)()
        --- <exception caught here> ---
          File "/home/sam/Twisted/twisted/internet/tcp.py", line 98, in doRead
            return Connection.doRead(self)
          File "/home/sam/Twisted/twisted/internet/tcp.py", line 234, in doRead
            data = self.socket.recv(self.bufferSize)
        SSL.SysCallError: (104, 'Connection reset by peer')

On closer inspection it seems that the surrounding try/except clause only
cares about SSL.SysCallErrors which pertain to unexpected EOF and all others
are re-raised. The only reason I can come up with for why this is the case is
that it was not anticipated that other exceptions (like the one above) could
arise from the given recv call. I would expect that in the above instance,
connectionLost should be called, but it may very well be that i'm missing some
subtlety so I am yet to submit a bug report.

Cheers,

Sam.



From syver-en at online.no  Thu Nov 13 08:29:28 2003
From: syver-en at online.no (Syver Enstad)
Date: 13 Nov 2003 14:29:28 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068681959.7644.1.camel@pcmarie>
References: <1068681959.7644.1.camel@pcmarie>
Message-ID: <ud6bwtn0n.fsf@online.no>

Philippe Lafoucri?re <lafou at wanadoo.fr> writes:

> Hello
> 
> Can someone provide me a good example of a deferred model in woven ?
> I have a big model to build, and the page takes a long time to
> render...

from twisted.web.woven.page import Page
from twised.internet import defer

class OurPage(Page):
    template = '''<html><body>
    <p model="deferredModel" view="Text"></p>
    </body></html>'''
    def wmfactory_deferredModel(self, request):
        """ returns an already callbacked
        Deferred with the string 'Hello world' as it's result
        """
        return defer.succeed('Hello world')


Okay?


-- 

Syver Enstad




From syver-en at online.no  Thu Nov 13 08:32:05 2003
From: syver-en at online.no (Syver Enstad)
Date: 13 Nov 2003 14:32:05 +0100
Subject: [Twisted-Python] help please: trouble installing twisted python on Windows 2000 Pro, but not Windows XP Pro
In-Reply-To: <02f901c3a99a$4eef28e0$8209500a@jsbwxp3>
References: <02f901c3a99a$4eef28e0$8209500a@jsbwxp3>
Message-ID: <u8ymktmwa.fsf@online.no>

"John Benson" <jsbenson at bensonsystems.com> writes:

> I went to install it on Windows 2000 Professional version 5.00.2195
> Service Pack 4 running Python 2.3 and got the following dialog box
> diagnostic: "Setup: CreateFile failed; code 5. Access is denied."
> I've been able to install piles of stuff on this system before, so I
> figure I have the required administrative privileges. I logon to a
> Windows domain, and my ID is in the Administrators group of the
> domain.

What is important here is if you or the group you are member of in the
domain has administrative privileges on the local machine. Check out
computer managment (or whatever) and see which users/groups are
members of the adminstrators group on the local machine (not the
domain admins). 

-- 

Syver Enstad




From exarkun at intarweb.us  Thu Nov 13 09:15:51 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 13 Nov 2003 09:15:51 -0500
Subject: [Twisted-Python] SSL.SysCallError in doRead
In-Reply-To: <20031113194552.GA26576@psychlaw.com.au>
References: <20031113194552.GA26576@psychlaw.com.au>
Message-ID: <20031113141551.GA24724@intarweb.us>

On Fri, Nov 14, 2003 at 05:45:52AM +1000, Sam Jordan wrote:
> Hi,
> 
> I noted the following exception while running some msn related
> code earlier:
> 
> 2003/11/14 05:09 EST [PassportLogin,client] Traceback (most recent call last):
>           File "/home/sam/Twisted/twisted/python/log.py", line 65, in callWithLogger
>             callWithContext({"system": lp}, func, *args, **kw)
>           File "/home/sam/Twisted/twisted/python/log.py", line 52, in callWithContext
>             return context.call({ILogContext: newCtx}, func, *args, **kw)
>           File "/home/sam/Twisted/twisted/python/context.py", line 32, in callWithContext
>             return func(*args,**kw)
>           File "/home/sam/Twisted/twisted/internet/default.py", line 513, in _doReadOrWrite
>             why = getattr(selectable, method)()
>         --- <exception caught here> ---
>           File "/home/sam/Twisted/twisted/internet/tcp.py", line 98, in doRead
>             return Connection.doRead(self)
>           File "/home/sam/Twisted/twisted/internet/tcp.py", line 234, in doRead
>             data = self.socket.recv(self.bufferSize)
>         SSL.SysCallError: (104, 'Connection reset by peer')
> 
> On closer inspection it seems that the surrounding try/except clause only
> cares about SSL.SysCallErrors which pertain to unexpected EOF and all others
> are re-raised. The only reason I can come up with for why this is the case is
> that it was not anticipated that other exceptions (like the one above) could
> arise from the given recv call. I would expect that in the above instance,
> connectionLost should be called, but it may very well be that i'm missing some
> subtlety so I am yet to submit a bug report.

  In tcp.py, on line 114, this exception is being caught and logged, then
CONNECTION_LOST is being returned, which should cause all the appropriate
lost-connection-callbacks to be invoked.

  The error is logged just to err on the side of being overly informative. 
It shouldn't interfere with connectionLost or clientConnectionLost.  If it
is, please do file a bug report.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031113/eb30d119/attachment.pgp 

From lafou at wanadoo.fr  Thu Nov 13 11:36:37 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Thu, 13 Nov 2003 17:36:37 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <ud6bwtn0n.fsf@online.no>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
Message-ID: <1068741397.4978.0.camel@pcmarie>

> from twisted.web.woven.page import Page
> from twised.internet import defer
> 
> class OurPage(Page):
>     template = '''<html><body>
>     <p model="deferredModel" view="Text"></p>
>     </body></html>'''
>     def wmfactory_deferredModel(self, request):
>         """ returns an already callbacked
>         Deferred with the string 'Hello world' as it's result
>         """
>         return defer.succeed('Hello world')
> 
> 
> Okay?


Lovely :)

thank you !




From justinjohnson at fastmail.fm  Thu Nov 13 11:38:59 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 13 Nov 2003 10:38:59 -0600
Subject: [Twisted-Python] LivePage CACHING Problem
Message-ID: <20031113163859.5A293415FE@server1.messagingengine.com>

Hi,

I am currently trying to use LivePage to update the cells of an html
table with results from processes initiated in various PB services.  The
client intiates requests in the services and those services call back
into the client's (a pb.Referenceable) remote_updateStatus method to
update the table which displays the results.  I have test code that
simulates this and everything works fine.  Javascript is sent to the
browser to update the cells of the table.  Works really slick.  However,
now that I tried to hook it up to PB, the LivePage javascript sending
part isn't working.  When I make the page.sendScript(script) call I get
the following in the log.

2003/11/13 10:25 CST [Broker,client] Sending javascript to page
<twisted.web.woven.utils.WovenLivePage instance at 0x4089944c>
2003/11/13 10:25 CST [Broker,client] CACHING
[<twisted.web.woven.utils.Script instance at 0x4089906c>]

All future sendScript calls append the script to the cache.  Everything
else is working appropriately, and all code is executing as I'd expect,
except that the javascript doesn't send properly.  Is there something in
particular I should be looking for here?  I don't see what I'm doing
different, but since LivePage is quite magical to me I'm not sure where
to look.

On a slightly different note, is there LivePage-ish support in nevow, and
do you recommend moving to that yet?

Thanks.
-Justin



From lafou at wanadoo.fr  Thu Nov 13 11:39:42 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Thu, 13 Nov 2003 17:39:42 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <ud6bwtn0n.fsf@online.no>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
Message-ID: <1068741582.4980.2.camel@pcmarie>

> from twisted.web.woven.page import Page
> from twised.internet import defer
> 
> class OurPage(Page):
>     template = '''<html><body>
>     <p model="deferredModel" view="Text"></p>
>     </body></html>'''
>     def wmfactory_deferredModel(self, request):
>         """ returns an already callbacked
>         Deferred with the string 'Hello world' as it's result
>         """
>         return defer.succeed('Hello world')


Last question (sry, I'm still a newbie in twisted :p) :
where do I put my blocking code ? just before the defer.succeed ??




From phil at bubblehouse.org  Thu Nov 13 11:46:09 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Thu, 13 Nov 2003 11:46:09 -0500 (EST)
Subject: [Twisted-Python] Interfaces
Message-ID: <1172.65.246.170.211.1068741969.squirrel@192.168.0.2>

first of all, just wanted to thank you guys for all your help. i'm really
starting to get some of the more advanced stuff in twisted, and it's
definitely totally cool...

i was wondering if someone could give me a quick explanation of how
interfaces work in twisted, or point me towards the right docstrigns to
read...

thanks,

-phil



From justinjohnson at fastmail.fm  Thu Nov 13 12:02:43 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 13 Nov 2003 11:02:43 -0600
Subject: [Twisted-Python] Interfaces
In-Reply-To: <1172.65.246.170.211.1068741969.squirrel@192.168.0.2>
References: <1172.65.246.170.211.1068741969.squirrel@192.168.0.2>
Message-ID: <20031113170243.4465A3D835@server1.messagingengine.com>

I found the following doc to be quite useful.

http://twistedmatrix.com/documents/howto/components


On Thu, 13 Nov 2003 11:46:09 -0500 (EST), "Phil Christensen"
<phil at bubblehouse.org> said:
> first of all, just wanted to thank you guys for all your help. i'm really
> starting to get some of the more advanced stuff in twisted, and it's
> definitely totally cool...
> 
> i was wondering if someone could give me a quick explanation of how
> interfaces work in twisted, or point me towards the right docstrigns to
> read...
> 
> thanks,
> 
> -phil
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From justinjohnson at fastmail.fm  Thu Nov 13 12:19:09 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 13 Nov 2003 11:19:09 -0600
Subject: [Twisted-Python] LivePage CACHING Problem
In-Reply-To: <20031113163859.5A293415FE@server1.messagingengine.com>
References: <20031113163859.5A293415FE@server1.messagingengine.com>
Message-ID: <20031113171909.5C44F40AFC@server1.messagingengine.com>

I found the following post that looks similar to my problem.

http://twistedmatrix.com/pipermail/twisted-python/2003-May/004170.html

But since I have my own tap, I copied the code from web/tap.py into my
code to start up the FlashConduitFactory.  It starts up, but I get the
following errors.  Is this a bug?  Any ideas what I'm doing wrong?

2003/11/13 11:08 CST [twisted.web.woven.flashconduit.FlashConduitFactory]
connection with flash movie opened
2003/11/13 11:08 CST [FlashConduit,3,xxx.xxx.xxx.xxx] Traceback (most
recent call last):
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
          line 501, in doSelect
            _logrun(selectable, _drdw, selectable, method, dict)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
          line 65, in callWithLogger
            callWithContext({"system": lp}, func, *args, **kw)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
          line 52, in callWithContext
            return context.call({ILogContext: newCtx}, func, *args, **kw)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/context.py",
          line 32, in callWithContext
            return func(*args,**kw)
        --- <exception caught here> ---
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
          line 510, in _doReadOrWrite
            why = getattr(selectable, method)()
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/tcp.py",
          line 250, in doRead
            return self.protocol.dataReceived(data)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/protocols/basic.py",
          line 223, in dataReceived
            why = self.lineReceived(line)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/web/woven/flashconduit.py",
          line 19, in lineReceived
            session = self.factory.site.getSession(line)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/web/server.py",
          line 470, in getSession
            return self.sessions[uid]
        exceptions.KeyError: 'd01be6fe334cded345c0b029e29df7ac'

2003/11/13 11:08 CST [FlashConduit,3,xxx.xxx.xxx.xxx] connection lost



On Thu, 13 Nov 2003 10:38:59 -0600, "Justin Johnson"
<justinjohnson at fastmail.fm> said:
> Hi,
> 
> I am currently trying to use LivePage to update the cells of an html
> table with results from processes initiated in various PB services.  The
> client intiates requests in the services and those services call back
> into the client's (a pb.Referenceable) remote_updateStatus method to
> update the table which displays the results.  I have test code that
> simulates this and everything works fine.  Javascript is sent to the
> browser to update the cells of the table.  Works really slick.  However,
> now that I tried to hook it up to PB, the LivePage javascript sending
> part isn't working.  When I make the page.sendScript(script) call I get
> the following in the log.
> 
> 2003/11/13 10:25 CST [Broker,client] Sending javascript to page
> <twisted.web.woven.utils.WovenLivePage instance at 0x4089944c>
> 2003/11/13 10:25 CST [Broker,client] CACHING
> [<twisted.web.woven.utils.Script instance at 0x4089906c>]
> 
> All future sendScript calls append the script to the cache.  Everything
> else is working appropriately, and all code is executing as I'd expect,
> except that the javascript doesn't send properly.  Is there something in
> particular I should be looking for here?  I don't see what I'm doing
> different, but since LivePage is quite magical to me I'm not sure where
> to look.
> 
> On a slightly different note, is there LivePage-ish support in nevow, and
> do you recommend moving to that yet?
> 
> Thanks.
> -Justin
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From mesozoic at polynode.com  Thu Nov 13 13:33:36 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Thu, 13 Nov 2003 13:33:36 -0500
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068741582.4980.2.camel@pcmarie>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
	 <1068741582.4980.2.camel@pcmarie>
Message-ID: <1068748415.939.374.camel@hyla>

On Thu, 2003-11-13 at 11:39, Philippe Lafoucri?re wrote:
> where do I put my blocking code ? just before the defer.succeed ??

I'm sure this has been answered a million times before, but here goes...

Deferreds do not magically turn blocking code into non-blocking code. If
you place blocking code in a wmfactory_ method, it will still interfere
with the event loop.

If you have blocking code, you can either rewrite it in a non-blocking
manner, or you can use a separate thread to run it.
<http://twistedmatrix.com/documents/howto/threading>

If you give more detail about what you're trying to do, I'm sure one of
the Twisted gurus can explain what the best approach(es) might be.

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031113/2d361a81/attachment.pgp 

From lafou at wanadoo.fr  Thu Nov 13 16:14:16 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Thu, 13 Nov 2003 22:14:16 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068748415.939.374.camel@hyla>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
	 <1068741582.4980.2.camel@pcmarie>  <1068748415.939.374.camel@hyla>
Message-ID: <1068758056.6001.4.camel@pcmarie>

> I'm sure this has been answered a million times before, but here goes...

I'm sure too. But I proposed a long time ago (and several times) to use
a forum instead of a mailing list... 

> Deferreds do not magically turn blocking code into non-blocking code. If
> you place blocking code in a wmfactory_ method, it will still interfere
> with the event loop.
> 
> If you have blocking code, you can either rewrite it in a non-blocking
> manner, or you can use a separate thread to run it.
> <http://twistedmatrix.com/documents/howto/threading>
> 
> If you give more detail about what you're trying to do, I'm sure one of
> the Twisted gurus can explain what the best approach(es) might be.

I thought of using the setUp method of page. I can start the calculation
when the page loads, but I don't know what to call (in the callback)
when it's done (a wmfactory_xxx ?). I'll check the threading part you
gave me. Thank you !

-- 
Philippe




From radix at twistedmatrix.com  Thu Nov 13 17:04:15 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 13 Nov 2003 17:04:15 -0500
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068758056.6001.4.camel@pcmarie>
References: <1068681959.7644.1.camel@pcmarie> <ud6bwtn0n.fsf@online.no> <1068741582.4980.2.camel@pcmarie> <1068748415.939.374.camel@hyla> <1068758056.6001.4.camel@pcmarie>
Message-ID: <20031113220415.GG563@radii>

On Thu, Nov 13, 2003 at 10:14:16PM +0100, Philippe Lafoucri?re wrote:
> 
> > I'm sure this has been answered a million times before, but here goes...
> 
> I'm sure too. But I proposed a long time ago (and several times) to use
> a forum instead of a mailing list... 

This is a terrible excuse. Not only do we have our *own* archives:

http://twistedmatrix.com/pipermail/twisted-python 

which, of course, are searchable via google: 

"deferred blocking code site:twistedmatrix.com"

there are *multiple* archives elsewhere that have a built-in search
functionality as well:

http://marc.free.net.ph/list/twisted-python.html

http://news.gmane.org/gmane.comp.python.twisted

I found these with a trivial amount of googling: "twisted-python
mailing list"

Having searchable archives is obviously no reason to switch to a web
forum (ugh), as we have that right now.

> > If you give more detail about what you're trying to do, I'm sure one of
> > the Twisted gurus can explain what the best approach(es) might be.
> 
> I thought of using the setUp method of page. I can start the calculation
> when the page loads, but I don't know what to call (in the callback)
> when it's done (a wmfactory_xxx ?). I'll check the threading part you
> gave me. Thank you !

Unfortunately, I don't think there's any special support in Woven to
handle Deferreds from setUp. You can return Deferreds from
wmfactory_XXX and Woven will handle them correctly: it will not finish
rendering the page until that Deferred has fired and the model is
ready.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From jon at totient.demon.co.uk  Thu Nov 13 17:38:26 2003
From: jon at totient.demon.co.uk (Jon Dyte)
Date: Thu, 13 Nov 2003 22:38:26 +0000
Subject: [Twisted-Python] adbapi.Augmention
Message-ID: <200311132238.26796.jon@totient.demon.co.uk>

Hi 

the doc string of adbapi.Augmentation mentions just using the ConnectionPool 
directly.

"A class which augments a database connector with some functionality.
This class is now deprecated. Just use the ConnectionPool directly.
Conventional usage of me is to write methods that look like..."


Presumbably this means DONT inherit from ConnectionPool like you
used to inherit from Augmentation( or am I reading that incorrectly)
and just create a ConnectionPool instance and run the queries through that.



Jon 



From radix at twistedmatrix.com  Thu Nov 13 17:27:43 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 13 Nov 2003 17:27:43 -0500
Subject: [Twisted-Python] adbapi.Augmention
In-Reply-To: <200311132238.26796.jon@totient.demon.co.uk>
References: <200311132238.26796.jon@totient.demon.co.uk>
Message-ID: <20031113222743.GH563@radii>

On Thu, Nov 13, 2003 at 10:38:26PM +0000, Jon Dyte wrote:
> Presumbably this means DONT inherit from ConnectionPool like you
> used to inherit from Augmentation( or am I reading that incorrectly)
> and just create a ConnectionPool instance and run the queries through that.

right.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From golux at comcast.net  Thu Nov 13 17:47:42 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Thu, 13 Nov 2003 17:47:42 -0500
Subject: [Twisted-Python] adbapi.Augmention
In-Reply-To: <200311132238.26796.jon@totient.demon.co.uk>
References: <200311132238.26796.jon@totient.demon.co.uk>
Message-ID: <3FB40A0E.4080508@comcast.net>

Jon Dyte wrote:

> the doc string of adbapi.Augmentation mentions just using the ConnectionPool 
> directly.
> 
> "A class which augments a database connector with some functionality.
> This class is now deprecated. Just use the ConnectionPool directly.
> Conventional usage of me is to write methods that look like..."
> 
> Presumbably this means DONT inherit from ConnectionPool like you
> used to inherit from Augmentation( or am I reading that incorrectly)
> and just create a ConnectionPool instance and run the queries through that.

Christopher Armstrong wrote:

> right.

But I think it works okay to subclass ConnectionPool ...
at least, it works for me.  Is there a better way to
do something like the following (which is working fine)?
(Admittedly you need to see my other modules for the full
picture, but you can infer what they would do ... as
you can probably guess, I don't use t.e.row.RowObject.)

----------------------------------------------------------------

# Twisted imports ...
from twisted.enterprise import adbapi
from twisted.internet import defer
from twisted.python import log, reflect
# Pan Galactic imports ...
from pangalactic.utils import sql, utils

class PgerDb(adbapi.ConnectionPool):
     """
     I am PGERDB, implemented using the Twisted Enterprise adbapi
     and pyPgSQL on top of the PGERDB Master Schema.
     """

     def __init__(self, dbapiname='pyPgSQL.PgSQL', database='pgerdb'):
         adbapi.ConnectionPool.__init__(self,
                                        dbapiname,
                                        database=database)
         self.dbname = database

     def doPgerdbQuery(self, table, subtypes, *args, **kw):
         """
         Run a query submitted as a list of args against a
         specified table.

         @type table:  string
         @param table: name of the table to search

         @type subtypes:  boolean
         @param subtypes: whether to search only the specified
                          table (False) or to include all subtype
                          tables (True)

         @type args:   list of tuples
         @param args:  a list of tuples, in which each tuple has the
                       tuple has the form:
                         - element[0] = column name
                         - element[1] = search value
                         - element[2] = operator
                       where I{operator} can be any SQL binary
                       operator.

         @param kw:    (optional kw arg)

                       B{sort}: column(s) to be sorted on -- this
                       can be either a string (a single column
                       name) or a list or tuple of column names
         """
         if args:
             sqlargs = sql.buildSelect(table, subtypes, *args, **kw)
             return self.runQuery(*sqlargs)
         else:
             raise TypeError, 'I need at least one search parameter'

     def getByRowKey(self, rowkey):
         """
         Get the resultset for this rowkey.

         @type rowkey:  list
         @param rowkey: a rowkey (for more about rowkeys, see
                        L{pangalactic.repo.factory.record2RowKey})

         @rtype:   a PgResultSet
         @return:  the result set that matches this rowkey.
         """
         sqlargs = sql.buildSelectFromRowKey(rowkey)
         return self.runQuery(*sqlargs)

     def addRow(self, table, *args, **kw):
         """
         Add a row to the specified table.

         @type table:  string
         @param table: name of the table to search

         @type args:   list
         @param args:  a list of 2-tuples:
                       [(colname, value), ...]

         @type kw:     dictionary
         @param kw:    {colname : value, ...}
         """
         parmdict = kw or dict(args)
         sqlcmd, parms = sql.buildInsert(table, parmdict)
         d = self.runOperation(sqlcmd, *parms)
         logmsg = 'addRow:  1 row added to %s table.' % table
         d.addCallback(lambda x: self._addRowDone(x, logmsg))
         d.addErrback(self.operationError)
         return d

     def _addRowDone(self, d, logmsg):
         """Callback for addRow success.
         """
         log.msg("%s operation %s" % (reflect.qual(self.__class__), logmsg))
         return d

     def addRows(self, records):
         """
         Add a series of rows, in a single transaction, from a
         list of records (for a description of "records", see
         L{pangalactic.repo.factory.extract2Record}).

         @type records:  list
         @param records: a list of records -- see
                         L{pangalactic.utils.factory} for the
                         definition of an extract
         """
         tables = utils.unique([rec[0] for rec in records])
         sqlstmt, parms = sql.buildTransactionalInsert(records)
         d = self.runOperation(sqlstmt, *parms)
         logmsg = 'addRows: rows added to tables %s.' % str(tables)
         d.addCallback(lambda x: self._addRowsConfirm(x, logmsg))
         d.addErrback(self.interactionError)
         return d

     def _addRowsConfirm(self, d, logmsg):
         """
         Callback for addRows success.
         """
         log.msg("%s %s" % (reflect.qual(self.__class__), logmsg))
         return d

     def operationDone(self, done):
         """
         Callback for database operation success.
         """
         log.msg("%s Operation done: %s" % (reflect.qual(self.__class__), done))

     def operationError(self, error):
         """
         Callback for database operation failure.
         """
         log.msg("%s Operation failed: %s" % (reflect.qual(self.__class__), error))
         log.err(error)

     def interactionDone(self, done):
         """
         Callback for database interaction success.
         """
         log.msg("%s Interaction done: %s" % (reflect.qual(self.__class__), done))

     def interactionError(self, error):
         """
         Callback for database interaction failure.
         """
         log.msg("%s Interaction failed: %s" % (reflect.qual(self.__class__), error))
         log.err(error)

----------------------------------------------------------------





From radix at twistedmatrix.com  Thu Nov 13 18:03:03 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 13 Nov 2003 18:03:03 -0500
Subject: [Twisted-Python] adbapi.Augmention
In-Reply-To: <3FB40A0E.4080508@comcast.net>
References: <200311132238.26796.jon@totient.demon.co.uk> <3FB40A0E.4080508@comcast.net>
Message-ID: <20031113230303.GI563@radii>

On Thu, Nov 13, 2003 at 05:47:42PM -0500, Stephen C. Waterbury wrote:
> Jon Dyte wrote:
>
> >Presumbably this means DONT inherit from ConnectionPool like you
> >used to inherit from Augmentation( or am I reading that incorrectly)
> >and just create a ConnectionPool instance and run the queries through that.
> 
> Christopher Armstrong wrote:
> 
> >right.
> 
> But I think it works okay to subclass ConnectionPool ...
> at least, it works for me.  Is there a better way to
> do something like the following (which is working fine)?
> (Admittedly you need to see my other modules for the full
> picture, but you can infer what they would do ... as
> you can probably guess, I don't use t.e.row.RowObject.)

Sure, there's no particular reason that subclassing ConnectionPool
can't be done, but the only difference is that you're using methods
like "self.runQuery" instead of "self.db.runQuery" (after doing
"self.db = ConnectionPool(etc)". I probably wouldn't subclass unless I
actually wanted to override one of the methods in ConnectionPool with
a modified implementation and then use it in the same place that a
regular ConnectionPool is expected.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From matthew.s.hegedus at lmco.com  Thu Nov 13 18:39:42 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Thu, 13 Nov 2003 17:39:42 -0600
Subject: [Twisted-Python] Forum vs. mailing list
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>

Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
forum sounds much better to me. Topics can be nicely separated, past
knowledge can be easily searched, and email inboxes can be freed from much
clutter (or at least make room for spam). Is it not too late to implement a
forum?

Matthew Hegedus

-----Original Message-----
From: Philippe Lafoucri?re [mailto:lafou at wanadoo.fr] 
Sent: Thursday, November 13, 2003 3:14 PM
To: Twisted
Subject: Re: [Twisted-Python] Deferred model



> I'm sure this has been answered a million times before, but here 
> goes...

I'm sure too. But I proposed a long time ago (and several times) to use a
forum instead of a mailing list... 

> Deferreds do not magically turn blocking code into non-blocking code. 
> If you place blocking code in a wmfactory_ method, it will still 
> interfere with the event loop.
> 
> If you have blocking code, you can either rewrite it in a non-blocking 
> manner, or you can use a separate thread to run it. 
> <http://twistedmatrix.com/documents/howto/threading>
> 
> If you give more detail about what you're trying to do, I'm sure one 
> of the Twisted gurus can explain what the best approach(es) might be.

I thought of using the setUp method of page. I can start the calculation
when the page loads, but I don't know what to call (in the callback) when
it's done (a wmfactory_xxx ?). I'll check the threading part you gave me.
Thank you !

-- 
Philippe


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From uwe at oss4u.com  Thu Nov 13 18:56:52 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Thu, 13 Nov 2003 15:56:52 -0800
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <200311131556.52724.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Well, on the other hand I wouldn't be reading that anymore. A mailinglist has 
the advantage that it comes to you. I think the likelyness of getting an 
answer is much higher with a mailinglist. To be honest I don't think that 
storing the stuff in a forum will make the FAQ's disappear. People just don't 
search thru the forum, pretty much the same as they don't read FAQ's and 
search mailinglist-archives.

On Thursday 13 November 2003 03:39 pm, Hegedus, Matthew S wrote:
> Philippe Lafoucri?re mentions his favoring of a forum over a mailing list.
> A forum sounds much better to me. Topics can be nicely separated, past
> knowledge can be easily searched, and email inboxes can be freed from much
> clutter (or at least make room for spam). Is it not too late to implement a
> forum?
>
> Matthew Hegedus
>
> -----Original Message-----
> From: Philippe Lafoucri?re [mailto:lafou at wanadoo.fr]
> Sent: Thursday, November 13, 2003 3:14 PM
> To: Twisted
> Subject: Re: [Twisted-Python] Deferred model
>
> > I'm sure this has been answered a million times before, but here
> > goes...
>
> I'm sure too. But I proposed a long time ago (and several times) to use a
> forum instead of a mailing list...
>
> > Deferreds do not magically turn blocking code into non-blocking code.
> > If you place blocking code in a wmfactory_ method, it will still
> > interfere with the event loop.
> >
> > If you have blocking code, you can either rewrite it in a non-blocking
> > manner, or you can use a separate thread to run it.
> > <http://twistedmatrix.com/documents/howto/threading>
> >
> > If you give more detail about what you're trying to do, I'm sure one
> > of the Twisted gurus can explain what the best approach(es) might be.
>
> I thought of using the setUp method of page. I can start the calculation
> when the page loads, but I don't know what to call (in the callback) when
> it's done (a wmfactory_xxx ?). I'll check the threading part you gave me.
> Thank you !

- -- 
	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/tBpEjqGXBvRToM4RArM1AJ4jFYsyn+Qp0/RdQwq5OQt5heN/SQCeMHsF
60pFx0YQtJggCs91Nmcg/Yo=
=6UxF
-----END PGP SIGNATURE-----




From R.Livsey at cache-22.co.uk  Thu Nov 13 19:00:42 2003
From: R.Livsey at cache-22.co.uk (Richard Livsey)
Date: Fri, 14 Nov 2003 00:00:42 +0000
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <3FB41B2A.7040702@cache-22.co.uk>

Hegedus, Matthew S wrote:

>Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
>forum sounds much better to me. Topics can be nicely separated, past
>knowledge can be easily searched, and email inboxes can be freed from much
>clutter (or at least make room for spam). Is it not too late to implement a
>forum?
>  
>
The problem with a forum is that you have to physically go and look to 
see if anything has been posted.
I like forums and have been involved in a number over the years, however 
once the workload increases I tend to find it harder and harder to find 
time to visit and eventually stop visiting altogether. My mail however, 
I always read as it's there *in your face* so to speak.
I'm lazy like that :o)

To address your main points:

- Topics can be nicely seperated
Thats what threading is for, if your mail client does not support it 
then there are many out there that do (I use Thunderbird).

- Past knowledge can be easily searched.
I can easily search through the emails I have from the past, plus 
there's always the archive (URL given in a previous post).

- Email inboxes can be freed from much clutter
Ok, I'll give you that one - although I don't class it as clutter! A 
bunch of mail filters and a handy mbox archiving
script (written in python I might add) keep my system nice and tidy :o)

/me goes back to lurking

-- 
R.Livsey
Incutio Web Developer
www.cache-22.co.uk
www.incutio.com





From radix at twistedmatrix.com  Thu Nov 13 19:08:50 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 13 Nov 2003 19:08:50 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <20031114000850.GJ563@radii>

On Thu, Nov 13, 2003 at 05:39:42PM -0600, Hegedus, Matthew S wrote:
> Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
> forum sounds much better to me. Topics can be nicely separated, past
> knowledge can be easily searched, and email inboxes can be freed from much
> clutter (or at least make room for spam). Is it not too late to implement a
> forum?

This is pointless. If you don't want to subscribe to the mailing list,
don't: just use one of the web interfaces to it that I pointed out
earlier.

If you want to post to the mailing list without requiring moderation,
and you want to read messages through the web and NOT receive them
through the mail, then subscribe and set the "nomail" option on your
account.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From bauer at mit.edu  Mon Nov 10 17:12:20 2003
From: bauer at mit.edu (Steven Bauer)
Date: Mon, 10 Nov 2003 17:12:20 -0500
Subject: [Twisted-Python] Documentation Question
Message-ID: <20031110221220.GA4281@mit.edu>

Being new to twisted I may be lacking a clue, but finding the
proper arguments to twisted.application.internet.UDPServer()
was a major pain in the butt.  

Only by looking at the code could I find all the valid arguments and
that took a lot of tracing because the valid arguments are determined by
listenudp() it seems.

Is their an easier way or is it always frustrating to determine the
acceptable arguments to an init function? 

Thanks,
Steve




From m at zadka.site.co.il  Wed Nov 12 01:39:40 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 12 Nov 2003 06:39:40 -0000
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <20031111195034.GA14487@intarweb.us>
References: <20031111195034.GA14487@intarweb.us>, <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
Message-ID: <20031112063940.1532.qmail@green.zadka.com>

On Tue, 11 Nov 2003, Jp Calderone <exarkun at intarweb.us> wrote:

>     from twisted.application import service
> 
>     class RegistryService(service.Service):
>         def __init__(self):
>             self.registry =3D registry.Registry()
> 
>     def makeService(config):
>         s =3D RegistryService()
>         ...
>         anotherS =3D SomeotherService()
>         anotherS.setServiceParent(s)  # Or s.setServiceParent(anotherS)
>         ...
>         return s # or return anotherS

Almost correct.
The idiomatic way is

class SomeOtherService
    # .... do something interesting here
    def registry(self):
        return self.parent.getServiceNamed('registry')

def makeService(config):
    s = RegistryService()
    s.setName('registry')
    anotherS = SomeOtherService()
    m = service.MultiService()
    s.setServiceParent(m)
    anotherS.setServiceParent(m)
    return m

The trick is to have 's' and 'anotherS' completely symmetrical,
and allow them to access each other.

Everything else Jp said, including the part about "globals bad,
explicit references good" has my whole-hearted blessing.



From rc at pgdn.org  Thu Nov 13 18:59:54 2003
From: rc at pgdn.org (Robert Church)
Date: Thu, 13 Nov 2003 15:59:54 -0800
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <20031113235954.GD7130@pgdn.org>

On Thu, Nov 13, 2003 at 05:39:42PM -0600, Hegedus, Matthew S quipped:
> Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
> forum sounds much better to me. Topics can be nicely separated, past
> knowledge can be easily searched, and email inboxes can be freed from much
> clutter (or at least make room for spam). Is it not too late to implement a
> forum?

As Mr. Armstrong just explaned, you can do all this and more with
the existing mailing list archive. It's here:

http://twistedmatrix.com/pipermail/twisted-python
 
You don't need to be subscried to the list to read the archive. Topics
are nicely seperated. Posts can be easily searched using google. Is it
too late to use the tools we already have before dumping 'em for a
bulletin board? Hm?



From andrew-twisted at puzzling.org  Thu Nov 13 19:29:50 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 14 Nov 2003 11:29:50 +1100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <20031113220415.GG563@radii>
References: <1068681959.7644.1.camel@pcmarie> <ud6bwtn0n.fsf@online.no> <1068741582.4980.2.camel@pcmarie> <1068748415.939.374.camel@hyla> <1068758056.6001.4.camel@pcmarie> <20031113220415.GG563@radii>
Message-ID: <20031114002949.GF29436@frobozz>

On Thu, Nov 13, 2003 at 05:04:15PM -0500, Christopher Armstrong wrote:
> On Thu, Nov 13, 2003 at 10:14:16PM +0100, Philippe Lafoucri?re wrote:
> > 
> > > I'm sure this has been answered a million times before, but here goes...
> > 
> > I'm sure too. But I proposed a long time ago (and several times) to use
> > a forum instead of a mailing list... 
> 
> This is a terrible excuse. Not only do we have our *own* archives:
[...]

And, of course, the mailing list isn't the only source of documentation.
The official docs are far from perfect, but they're getting better (over 300
pages as a PDF, when I last checked!).

For cases like this question, there's the FAQ.  I've just checked in an
addition to it that hopefully addresses this question.  It should be visible
here in a few minutes, once buildbot does its thing:
    http://twistedmatrix.com/users/warner/doc-latest/howto/faq.html#deferreds-aren't-magic
    
-Andrew.




From glyph at twistedmatrix.com  Thu Nov 13 20:09:51 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 13 Nov 2003 20:09:51 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>

On Nov 13, 2003, at 6:39 PM, Hegedus, Matthew S wrote:

> Philippe Lafoucri?re mentions his favoring of a forum over a mailing 
> list. A
> forum sounds much better to me. Topics can be nicely separated, past
> knowledge can be easily searched, and email inboxes can be freed from 
> much
> clutter (or at least make room for spam). Is it not too late to 
> implement a
> forum?

Well, others (and elsewhere, myself) have given the reasons that the 
labs won't host a forum, but I think it would be great if someone else 
would do so.  I've said before that the Twisted community needs more 
than one medium for communication, it seems that enough people here 
have a preference for forum software that it's viable to set one up.

Please send me a link to put on the tm.com site when you do so.




From matthew.s.hegedus at lmco.com  Thu Nov 13 18:43:58 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Thu, 13 Nov 2003 17:43:58 -0600
Subject: [Twisted-Python] Deferred model
Message-ID: <401C60E417B68B48B14B53D845FF596A568E72@EMSS07M12.us.lmco.com>

Oops, sorry Chris, I did not see your response. My message will surely
displease you. Please disregard since you have already made your case
defending the Twisted archives and opposing a forum.

Matthew

-----Original Message-----
From: Christopher Armstrong [mailto:radix at twistedmatrix.com] 
Sent: Thursday, November 13, 2003 4:04 PM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] Deferred model


On Thu, Nov 13, 2003 at 10:14:16PM +0100, Philippe Lafoucri?re wrote:
> 
> > I'm sure this has been answered a million times before, but here 
> > goes...
> 
> I'm sure too. But I proposed a long time ago (and several times) to 
> use a forum instead of a mailing list...

This is a terrible excuse. Not only do we have our *own* archives:

http://twistedmatrix.com/pipermail/twisted-python 

which, of course, are searchable via google: 

"deferred blocking code site:twistedmatrix.com"

there are *multiple* archives elsewhere that have a built-in search
functionality as well:

http://marc.free.net.ph/list/twisted-python.html

http://news.gmane.org/gmane.comp.python.twisted

I found these with a trivial amount of googling: "twisted-python mailing
list"

Having searchable archives is obviously no reason to switch to a web forum
(ugh), as we have that right now.

> > If you give more detail about what you're trying to do, I'm sure one 
> > of the Twisted gurus can explain what the best approach(es) might 
> > be.
> 
> I thought of using the setUp method of page. I can start the 
> calculation when the page loads, but I don't know what to call (in the 
> callback) when it's done (a wmfactory_xxx ?). I'll check the threading 
> part you gave me. Thank you !

Unfortunately, I don't think there's any special support in Woven to handle
Deferreds from setUp. You can return Deferreds from wmfactory_XXX and Woven
will handle them correctly: it will not finish rendering the page until that
Deferred has fired and the model is ready.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From phil at bubblehouse.org  Thu Nov 13 21:45:00 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Thu, 13 Nov 2003 21:45:00 -0500 (EST)
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
    <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>
Message-ID: <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>

i absolutely agree with all of your points. i don't have the hatred of
web-based interfaces that you guys seem to ;-), but i think that there is
definitely a bit of elitism coming into play.

we (as proud geeks) know all the google tricks and mailman preferences to
get things to behave as we like them to. but let's face it, there's more
to gaining "acceptance" or "market share", or whatever you want to call
it, than appealing to the developers.

obviously, that is the level twisted is at now, and i agree the need for a
forum is limited at this point. but for example, pretty soon (in the
scheme of things) people are going to want to tell their bosses about
twisted. many of you seem to be fortunate to have (or be) bosses who are
willing to take a chance on a new framework. however, to clue in the PHBs
that so many of us have making decisions, a centralized, "user-friendly",
web-based forum could be much more accessible.

and there's more than pointy-haired-bosses who could benefit from this,
such as the beginning web developer/administrator who may not think on the
same level, but could really make use of an apache alternative. i'm sure
you're all familiar with the state of IT in businesses today; many a
webmaster is lucky to be able to, forgive the expression, walk and chew
gum at the same time.

i think the biggest reason it might be worth investigating is because as
much as twisted is progressing as a project, i can see it forming a
community of developers willing to, again, please forgive the cliche,
"think outside the box." i have seen mind-blowing levels of genius come
out of this group, so much so that i once made the statement to glyph, "i
want to help, but i feel like i'm just a programmer, and all you guys are
computer scientists."

i know what you mean about using the tools that are already available, but
i think that as twisted grows, if you want the more user-oriented (as in,
non-developer-oriented) parts to be accessible, a more user-oriented
approach might be helpful.

anyways, what it comes down to is this. i've been looking for a reason to
set up this forum software i'm really fond of on my machine, but i haven't
had a reason to do so yet. i'm going to go ahead and give it a try, and
you can check it out and see if you want to bother with it or not. if not,
no big deal, and if it seems interesting and not painful to use, then we
can investigate it further...



From phil at bubblehouse.org  Thu Nov 13 21:50:09 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Thu, 13 Nov 2003 21:50:09 -0500 (EST)
Subject: [Twisted-Python] time and date
Message-ID: <65031.192.168.0.1.1068778209.squirrel@192.168.0.2>

i might just be insane, but is there something crazy going on with date
stamps on this list? about three different messages in the past two days
have weird time stamps on them, that are set in the past or the future.

i noticed some stuff in the archives like that, too. is this an accidental
user thing? or am i suffering from senile dementia exceptionally early in
my life?



From itamar at itamarst.org  Thu Nov 13 22:14:02 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 13 Nov 2003 22:14:02 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	<3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>
	<64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
Message-ID: <20031113221402.54632078.itamar@itamarst.org>

I added a google search to the site, which should also search the
mailing list archives while it's at it.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From scottanderson at comcast.net  Thu Nov 13 23:49:22 2003
From: scottanderson at comcast.net (Scott Anderson)
Date: Thu, 13 Nov 2003 23:49:22 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>    <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com> <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
Message-ID: <3FB45ED2.8050401@comcast.net>

Phil Christensen wrote:

>anyways, what it comes down to is this. i've been looking for a reason to
>set up this forum software i'm really fond of on my machine, but i haven't
>had a reason to do so yet. i'm going to go ahead and give it a try, and
>you can check it out and see if you want to bother with it or not. if not,
>no big deal, and if it seems interesting and not painful to use, then we
>can investigate it further...
>  
>

Not to further muddy the waters, but one reason I've been looking at 
Twisted was to port the software I wrote for Zope that runs at 
http://z.iwethey.org/forums -- we also have a hosting service. If you 
care to look around the site, the software gets extremely good reviews 
from the users with respect to the interface. It has full text indexing 
as well. With Twisted running behind it, I plan on integrating the 
forums with Jabber chat rooms, irc, and email.

I won't be porting it for at least a month or so, however (new baby in 
the house), but I fully intend on completing the project when I get the 
time.

Regards,
-scott





From twisted at zadka.site.co.il  Fri Nov 14 01:24:12 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 14 Nov 2003 06:24:12 -0000
Subject: [Twisted-Python] Documentation Question
In-Reply-To: <20031110221220.GA4281@mit.edu>
References: <20031110221220.GA4281@mit.edu>
Message-ID: <20031114062412.2922.qmail@green.zadka.com>

On Mon, 10 Nov 2003, Steven Bauer <bauer at mit.edu> wrote:

> Being new to twisted I may be lacking a clue, but finding the
> proper arguments to twisted.application.internet.UDPServer()
> was a major pain in the butt.  
> 
> Only by looking at the code could I find all the valid arguments and
> that took a lot of tracing because the valid arguments are determined by
> listenudp() it seems.

Did you try using help(internet.UDPServer) from the interactive interpreter?
Here's what I got:

class UDPServer(_AbstractServer)
 |  Serve UDP clients
 |
 |  Call listenUDP when the service starts, with the
 |  arguments given to the constructor. When the service stops,
 |  stop listening.

I checked in a fix to make it say "reactor.listenUDP" -- I guess it was
just a blindspot of me, I knew what listenUDP means :)
Anyway, this should not have required any "looking at the code".
Hopefully with my fix you'll be able to know you should do
help(reactor.listenUDP) to get the information you're after:

>>> help(reactor.listenUDP)
Help on method listenUDP in module twisted.internet.default:

listenUDP(self, port, protocol, interface='', maxPacketSize=8192) method of twis
ted.internet.default.SelectReactor instance
    Connects a given L{DatagramProtocol} to the given numeric UDP port.

I realize that the indirection is a pain, but it'd be somewhat annoying
(not impossible, though) to lose it, and I would prefer not to do it
unless it's a real deal breaker for someone.

In general, I highly recommend using help() from the interactive interpreter
to read the docstrings of stuff, and see how to call it. If this strategy
does not give you information for a specific method/class, you should
file a documentation bug in http://twistedmatrix.com/bugs -- while
ideally everything should have a docstring, the developers have so much
time, so prioritizing by stuff people need is a necessity.



From rudy.schockaert at pandora.be  Fri Nov 14 01:54:27 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Fri, 14 Nov 2003 07:54:27 +0100
Subject: [Twisted-Python] Documentation Question
In-Reply-To: <20031114062412.2922.qmail@green.zadka.com>
References: <20031110221220.GA4281@mit.edu> <20031114062412.2922.qmail@green.zadka.com>
Message-ID: <3FB47C23.9010109@pandora.be>

>In general, I highly recommend using help() from the interactive interpreter
>to read the docstrings of stuff, and see how to call it. 
>  
>

You can always start using Stani's Python Editor SPE ( 
http://spe.pycs.net/ ) which automagically shows you the docstring and 
required parameterlist. ;-)




From john at landahl.org  Fri Nov 14 02:14:05 2003
From: john at landahl.org (John Landahl)
Date: Thu, 13 Nov 2003 23:14:05 -0800
Subject: [Twisted-Python] Documentation Question
In-Reply-To: <20031114062412.2922.qmail@green.zadka.com>
References: <20031110221220.GA4281@mit.edu> <20031114062412.2922.qmail@green.zadka.com>
Message-ID: <opryl81rpck1a6kk@sfmail3>

On 14 Nov 2003 06:24:12 -0000, Moshe Zadka <twisted at zadka.site.co.il> 
wrote:
> In general, I highly recommend using help() from the interactive 
> interpreter to read the docstrings of stuff, and see how to call it.

And with IPython it's even simpler, e.g. "help reactor.listenUDP".  
IPython does the parens for you, allowing for new heights of laziness. :)

If the docstrings aren't enough and you want to see the source after all, 
"psource reactor.listenUDP" shows you the source for just that single 
function, in pretty colors, even.

And you can't beat the tab completion: "reactor.listen<TAB>" shows you 
lots of interesting things.

Sure, it's slow to load, but IPython takes the interactive Python 
experience to a whole new level, especially in situations like this where 
you're exploring new (to you) code.

Oh yeah, try the @pdb option, which automatically launches the debugger 
*at the point of failure* when an uncaught exception occurs.  Alas, since 
the reactor catches all exceptions, this won't help much with Twisted apps.

_jpl_ (a satisfied customer)



From illumen at yahoo.com  Fri Nov 14 02:47:14 2003
From: illumen at yahoo.com (Rene Dudfield)
Date: Fri, 14 Nov 2003 17:47:14 +1000
Subject: ipython rox was(Re: [Twisted-Python] Documentation Question)
In-Reply-To: <opryl81rpck1a6kk@sfmail3>
References: <20031110221220.GA4281@mit.edu> <20031114062412.2922.qmail@green.zadka.com> <opryl81rpck1a6kk@sfmail3>
Message-ID: <3FB48882.2080600@yahoo.com>

John Landahl wrote:

> On 14 Nov 2003 06:24:12 -0000, Moshe Zadka <twisted at zadka.site.co.il> 
> wrote:
>
>> In general, I highly recommend using help() from the interactive 
>> interpreter to read the docstrings of stuff, and see how to call it.
>
>
> And with IPython it's even simpler, e.g. "help reactor.listenUDP".  
> IPython does the parens for you, allowing for new heights of laziness. :)
>
> If the docstrings aren't enough and you want to see the source after 
> all, "psource reactor.listenUDP" shows you the source for just that 
> single function, in pretty colors, even.
>
> And you can't beat the tab completion: "reactor.listen<TAB>" shows you 
> lots of interesting things.
>
> Sure, it's slow to load, but IPython takes the interactive Python 
> experience to a whole new level, especially in situations like this 
> where you're exploring new (to you) code.
>
> Oh yeah, try the @pdb option, which automatically launches the 
> debugger *at the point of failure* when an uncaught exception occurs.  
> Alas, since the reactor catches all exceptions, this won't help much 
> with Twisted apps.
>
> _jpl_ (a satisfied customer)


I too love ipython :)  Especially since the deep reload command works 
fairly well.  Has macros too.  You can access the lines that you type in 
as a list.  Which makes getting a copy of code you type in there 
easier.  Oh and you can use !ls for shell commands.  More features at 
the website:

http://ipython.scipy.org/



Have fun!
http://www.holepit.com/




From lafou at wanadoo.fr  Fri Nov 14 05:41:18 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 14 Nov 2003 11:41:18 +0100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <200311131556.52724.uwe@oss4u.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	 <200311131556.52724.uwe@oss4u.com>
Message-ID: <1068806478.4923.18.camel@pcmarie>

> Well, on the other hand I wouldn't be reading that anymore. A mailinglist has 
> the advantage that it comes to you. I think the likelyness of getting an 
> answer is much higher with a mailinglist. To be honest I don't think that 
> storing the stuff in a forum will make the FAQ's disappear. People just don't 
> search thru the forum, pretty much the same as they don't read FAQ's and 
> search mailinglist-archives.


The question is not to use the ML OR the forum, but both of them. While
the Ml could be more "dev" oriented, the forum would help newbies to
find answers quicker than in the mailing list. Forums.gentoo.org and
gentoo-user or gentoo-dev mailings lists are a good exemple (there an
irc channel too). Forums.gentoo.org are very popular with their features
(categorize information, advanced search + highlight words, answers are
notified by mail, etc.).

I know Glyph don't want to hear about phpBB, because it's not written
using python&twisted. So, what's the solution ? Create a brand new forum
system using twisted ? Volonteers ? Roundup is quite good, and show the
right road. Twisted needs some killer apps.

--
Philippe




From lafou at wanadoo.fr  Fri Nov 14 07:57:09 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 14 Nov 2003 13:57:09 +0100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031113221402.54632078.itamar@itamarst.org>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	 <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>
	 <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
	 <20031113221402.54632078.itamar@itamarst.org>
Message-ID: <1068814629.4923.24.camel@pcmarie>

On Fri, 2003-11-14 at 04:14, Itamar Shtull-Trauring wrote:
> I added a google search to the site, which should also search the
> mailing list archives while it's at it.

Great idea !
Thank you




From lafou at wanadoo.fr  Fri Nov 14 08:01:12 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 14 Nov 2003 14:01:12 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <20031114002949.GF29436@frobozz>
References: <1068681959.7644.1.camel@pcmarie> <ud6bwtn0n.fsf@online.no>
	 <1068741582.4980.2.camel@pcmarie> <1068748415.939.374.camel@hyla>
	 <1068758056.6001.4.camel@pcmarie> <20031113220415.GG563@radii>
	 <20031114002949.GF29436@frobozz>
Message-ID: <1068814872.4923.26.camel@pcmarie>

>     http://twistedmatrix.com/users/warner/doc-latest/howto/faq.html#deferreds-aren't-magic

the link
http://twistedmatrix.com/documents/TwistedDocs/TwistedDocs-/api/twisted.internet.threads.deferToThread.html
is broken in the faq (defertoThread)




From lafou at wanadoo.fr  Fri Nov 14 10:34:02 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 14 Nov 2003 16:34:02 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068748415.939.374.camel@hyla>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
	 <1068741582.4980.2.camel@pcmarie>  <1068748415.939.374.camel@hyla>
Message-ID: <1068824042.4927.36.camel@pcmarie>

> If you give more detail about what you're trying to do, I'm sure one of
> the Twisted gurus can explain what the best approach(es) might be.

I'm trying to manage my gentoo box with a twisted server (A linux
Distro). Portage is very slow, and build the package first level tree
can take several seconds. I just wanted my page not to block while
loading, and put the result in it when it becomes available.

The list of the category is in a "wmupdate_category(self, request)"
method, in which I'd like to use deferreds.

Thank you gurus for your help !

--
Philippe - kind of lost sometimes with twisted :p




From itamar at itamarst.org  Fri Nov 14 12:29:27 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 14 Nov 2003 12:29:27 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <1068806478.4923.18.camel@pcmarie>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	<200311131556.52724.uwe@oss4u.com>
	<1068806478.4923.18.camel@pcmarie>
Message-ID: <20031114122927.362dcdc3.itamar@itamarst.org>

On Fri, 14 Nov 2003 11:41:18 +0100
Philippe Lafoucri?re <lafou at wanadoo.fr> wrote:

> I know Glyph don't want to hear about phpBB, because it's not written
> using python&twisted. So, what's the solution ? Create a brand new
> forum system using twisted ? Volonteers ? Roundup is quite good, and
> show the right road. Twisted needs some killer apps.

If you want to use phpbb I doubt anyone will boycott it. Again, anyone
who wants to can setup a forum. Roundup is not a twisted product, it's a
CGI.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From cce at clarkevans.com  Fri Nov 14 16:01:00 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Fri, 14 Nov 2003 16:01:00 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <20031114210100.GA70172@clarkevans.com>

Matthew,

A forum does not solve the core issue of organizing information
into a clear hierarchy of topics, filtering relevant questions
and answers, and a whole host of other items.  While a Wiki or
a Forum could be useful, it will only work if there are several
people who care about its structure, moderate it, and work
hard to make the information useful.   Other than that, threaded
email works just as well.  

IMHO, an AutoFAQ would be more appropriate, in particular, if you
or someone else dedicates significant _time_ to make sure that it
stays orderly and useful.   Sort of a AutoFAQ, you could simply
implement or edit a FAQ.  I'm sure if you kept one up-to-date 
it would glady find its way into the source code.

Probably a more "helpful" item would be a "Weekly Report" 
like the Python Developer's list has.  Some dutiful individual
there scans all of the things discussed, lists the topics
discussed, summarizes them into a single paragaraph and 
provides links to particularly insighful emails.  In my 
opinion, this would be far more useful..

Clark

On Thu, Nov 13, 2003 at 05:39:42PM -0600, Hegedus, Matthew S wrote:
| Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
| forum sounds much better to me. Topics can be nicely separated, past
| knowledge can be easily searched, and email inboxes can be freed from much
| clutter (or at least make room for spam). Is it not too late to implement a
| forum?
| 
| Matthew Hegedus
| 
| -----Original Message-----
| From: Philippe Lafoucri?re [mailto:lafou at wanadoo.fr] 
| Sent: Thursday, November 13, 2003 3:14 PM
| To: Twisted
| Subject: Re: [Twisted-Python] Deferred model
| 
| 
| 
| > I'm sure this has been answered a million times before, but here 
| > goes...
| 
| I'm sure too. But I proposed a long time ago (and several times) to use a
| forum instead of a mailing list... 
| 
| > Deferreds do not magically turn blocking code into non-blocking code. 
| > If you place blocking code in a wmfactory_ method, it will still 
| > interfere with the event loop.
| > 
| > If you have blocking code, you can either rewrite it in a non-blocking 
| > manner, or you can use a separate thread to run it. 
| > <http://twistedmatrix.com/documents/howto/threading>
| > 
| > If you give more detail about what you're trying to do, I'm sure one 
| > of the Twisted gurus can explain what the best approach(es) might be.
| 
| I thought of using the setUp method of page. I can start the calculation
| when the page loads, but I don't know what to call (in the callback) when
| it's done (a wmfactory_xxx ?). I'll check the threading part you gave me.
| Thank you !
| 
| -- 
| Philippe
| 
| 
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
| 
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
| 



From radix at twistedmatrix.com  Fri Nov 14 16:39:21 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Fri, 14 Nov 2003 16:39:21 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031114210100.GA70172@clarkevans.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com>
Message-ID: <20031114213921.GB2269@twistedmatrix.com>

On Fri, Nov 14, 2003 at 04:01:00PM -0500, Clark C. Evans wrote:
> Probably a more "helpful" item would be a "Weekly Report" 
> like the Python Developer's list has.  Some dutiful individual
> there scans all of the things discussed, lists the topics
> discussed, summarizes them into a single paragaraph and 
> provides links to particularly insighful emails.  In my 
> opinion, this would be far more useful..

I would love to see this happen! I used to do this waay back in the
day for Twisted, but I apparently don't have the focus to keep it up
(I only got 6 issues out). I would certainly *help* with such an
effort, now, as long as someone is willing to be responsible for it,
and can bug me when they need my help.

Here's an example of what I did, the 6th and final issue:

http://cvs.twistedmatrix.com/cvs/*checkout*/twistedmatrix.com/pages/Attic/twn-6.html?rev=1.5&cvsroot=WebSite&hideattic=0

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From andrew-twisted at puzzling.org  Fri Nov 14 22:17:19 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 15 Nov 2003 14:17:19 +1100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068814872.4923.26.camel@pcmarie>
References: <1068681959.7644.1.camel@pcmarie> <ud6bwtn0n.fsf@online.no> <1068741582.4980.2.camel@pcmarie> <1068748415.939.374.camel@hyla> <1068758056.6001.4.camel@pcmarie> <20031113220415.GG563@radii> <20031114002949.GF29436@frobozz> <1068814872.4923.26.camel@pcmarie>
Message-ID: <20031115031719.GB32299@frobozz>

On Fri, Nov 14, 2003 at 02:01:12PM +0100, Philippe Lafoucri?re wrote:
> >     http://twistedmatrix.com/users/warner/doc-latest/howto/faq.html#deferreds-aren't-magic
> 
> the link
> http://twistedmatrix.com/documents/TwistedDocs/TwistedDocs-/api/twisted.internet.threads.deferToThread.html
> is broken in the faq (defertoThread)

Yeah, that's a known glitch; the docs in the doc-latest directory aren't
generated with valid API links.  I've just checked in a change that will
make the doc-latest docs generate links to
    http://twistedmatrix.com/documents/TwistedDocs/current/...
which will fix the worst of the broken links (there are likely to still be
some, seeing as that is linking CVS howtos to the release version of the API
docs).

There's a seperate bug with the way links to top-level functions in modules
work (as opposed to classes and methods of classes) which means that
particular link will still not work for now.  It'll work when we do another
release, though, which is what matters.  doc-latest docs are just a preview
of the next release, after all, not the final product :)

Anyway, aside from that link, I take it you are happy with that FAQ entry? :)

-Andrew.




From grolgh at online.no  Sat Nov 15 01:34:30 2003
From: grolgh at online.no (benjamin bruheim)
Date: Sat, 15 Nov 2003 07:34:30 +0100
Subject: [Twisted-Python] Forum vs. mailing list
Message-ID: <3FB6A548@epostleser.online.no>

>http://z.iwethey.org/forums -- we also have a hosting service. If you

I liked those forums. Best of both worlds. It does have a slowness I attribute 
to Zope, and so on.

I liked the mixed threads/flat-view that the forum uses. This is good for real 
discussion. And also, it allows one to browse faster.

However, the CSS is IMHO lousy, and very unattractive. I think we could 
configure this better. If it is gets to be available on twisted, it would be 
good. However, I prefer to use lightweight systems; both in bandwidth and CPU. 
I hope this system is made to be scalable and accessible.

You should put up an example setup, clean the CSS to the bare minimums. Put up 
a minimum of forums. I would think: Development, Twisted, Web
Perhaps add: Issues (the workaround forum), Showroom (brag) and General 
Bullshit

Sincerely,
Benjamin Bruheim





From glyph at twistedmatrix.com  Sat Nov 15 03:30:37 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 15 Nov 2003 03:30:37 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031114210100.GA70172@clarkevans.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com>
Message-ID: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>

On Nov 14, 2003, at 4:01 PM, Clark C. Evans wrote:

> A forum does not solve the core issue of organizing information
> into a clear hierarchy of topics, filtering relevant questions
> and answers, and a whole host of other items.  While a Wiki or
> a Forum could be useful, it will only work if there are several
> people who care about its structure, moderate it, and work
> hard to make the information useful.   Other than that, threaded
> email works just as well.

This brings up a sore point yet again - we need a documentation editor. 
  Any volunteers? :)




From lafou at wanadoo.fr  Sat Nov 15 04:11:39 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sat, 15 Nov 2003 10:11:39 +0100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	 <20031114210100.GA70172@clarkevans.com>
	 <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
Message-ID: <1068887499.4985.0.camel@pcmarie>

> This brings up a sore point yet again - we need a documentation editor. 
>   Any volunteers? :)


huh ? what do you mean by documentation editor ?? I can spend some time
to moderate and organise a forum (only the evening, coz, you know, the
real life ........) :D

--
Philippe




From mary-twisted at puzzling.org  Sat Nov 15 04:29:57 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Sat, 15 Nov 2003 20:29:57 +1100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
Message-ID: <20031115092957.GA1401@titus.home.puzzling.org>

On Sat, Nov 15, 2003, Glyph Lefkowitz wrote:
> On Nov 14, 2003, at 4:01 PM, Clark C. Evans wrote:
> 
> >A forum does not solve the core issue of organizing information
> >into a clear hierarchy of topics, filtering relevant questions
> >and answers, and a whole host of other items.  While a Wiki or
> >a Forum could be useful, it will only work if there are several
> >people who care about its structure, moderate it, and work
> >hard to make the information useful.   Other than that, threaded
> >email works just as well.
> 
> This brings up a sore point yet again - we need a documentation editor. 
>  Any volunteers? :)

I'm still willing to do this, as per the mail here:
http://twistedmatrix.com/pipermail/twisted-python/2003-October/006114.html

The four weeks has passed too. I'm not sure whether you were looking for
someone who has previously been involved in Twisted development though.

I'll have a look at the documentation and see what I think of it I
guess (I haven't read all of Twisted's documentation).

-Mary



From scottanderson at comcast.net  Sat Nov 15 09:12:44 2003
From: scottanderson at comcast.net (Scott Anderson)
Date: Sat, 15 Nov 2003 09:12:44 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <3FB6A548@epostleser.online.no>
References: <3FB6A548@epostleser.online.no>
Message-ID: <3FB6345C.1060105@comcast.net>

benjamin bruheim wrote:

>>http://z.iwethey.org/forums -- we also have a hosting service. If you
>>    
>>
>
>I liked those forums. Best of both worlds. It does have a slowness I attribute 
>to Zope, and so on.
>  
>

Yes, there are issues with how the database drivers work. I have to run 
it in single threaded mode or we get problems like lock-ups and 
corruption. :-P

Meh. It's a prototype. One that does half a million hits a month, but a 
prototype nonetheless.

If you were browsing without logging in, keep in mind that you were 
doing full forum scans. When you're logged in and have "Show New Only" 
turned on, things speed up considerably.

>I liked the mixed threads/flat-view that the forum uses. This is good for real 
>discussion. And also, it allows one to browse faster.
>  
>

The views are also configurable by user. The interface has been beaten 
on and dissected by scores of computer professionals for years, all of 
whom know Exactly What They Want. :-)

>However, the CSS is IMHO lousy, and very unattractive. I think we could 
>configure this better. If it is gets to be available on twisted, it would be 
>good. However, I prefer to use lightweight systems; both in bandwidth and CPU. 
>I hope this system is made to be scalable and accessible.
>  
>

The CSS was written before I knew what CSS was, and yes, it could stand 
a lot of improvement. :-)

There's a user option to turn CSS off completely. One of the main design 
goals was to allow anyone to use the forums: they work just as well in 
something like lynx or w3m.

Moving to Twisted is a priority, given the performance.

>You should put up an example setup, clean the CSS to the bare minimums. Put up 
>a minimum of forums. I would think: Development, Twisted, Web
>Perhaps add: Issues (the workaround forum), Showroom (brag) and General 
>Bullshit
>  
>
Perhaps this weekend.

Regards,
-scott






From radix at twistedmatrix.com  Sat Nov 15 10:10:40 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 15 Nov 2003 10:10:40 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031115092957.GA1401@titus.home.puzzling.org>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com> <20031115092957.GA1401@titus.home.puzzling.org>
Message-ID: <20031115151039.GC2269@twistedmatrix.com>

On Sat, Nov 15, 2003 at 08:29:57PM +1100, Mary Gardiner wrote:
> On Sat, Nov 15, 2003, Glyph Lefkowitz wrote:
> > This brings up a sore point yet again - we need a documentation editor. 
> >  Any volunteers? :)
> 
> I'm still willing to do this, as per the mail here:
> http://twistedmatrix.com/pipermail/twisted-python/2003-October/006114.html
> 
> The four weeks has passed too. I'm not sure whether you were looking for
> someone who has previously been involved in Twisted development though.

I would say that's probably not a requirement ;-). If you need me to
do anything, commit patches, update the web site, or whatever, please
ask. I'll try to be around to help for this task, specifically :)

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From glyph at twistedmatrix.com  Sat Nov 15 10:25:56 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 15 Nov 2003 10:25:56 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031115092957.GA1401@titus.home.puzzling.org>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com> <20031115092957.GA1401@titus.home.puzzling.org>
Message-ID: <022115B6-1780-11D8-94C9-000393C9700E@twistedmatrix.com>

On Nov 15, 2003, at 4:29 AM, Mary Gardiner wrote:

> The four weeks has passed too. I'm not sure whether you were looking 
> for
> someone who has previously been involved in Twisted development though.

Beggars can't be choosers!  Plus, I think you've got just the right 
amount of involvement with Twisted development - you clearly understand 
what's going on, but you haven't drunk enough of the kool-aid yet to be 
unable to see other approaches and make comparisons to other 
technologies.




From mary-twisted at puzzling.org  Sat Nov 15 19:43:13 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Sun, 16 Nov 2003 11:43:13 +1100
Subject: Documentation editing tasks (Re: [Twisted-Python] Forum vs. mailing list)
In-Reply-To: <20031115092957.GA1401@titus.home.puzzling.org>
References: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com> <20031115092957.GA1401@titus.home.puzzling.org>
Message-ID: <20031116004313.GA10624@titus.home.puzzling.org>

On Sat, Nov 15, 2003, Mary Gardiner wrote:
> On Sat, Nov 15, 2003, Glyph Lefkowitz wrote:
> > This brings up a sore point yet again - we need a documentation
> > editor.  Any volunteers? :)
> 
> I'm still willing to do this, as per the mail here:
> http://twistedmatrix.com/pipermail/twisted-python/2003-October/006114.html
> 
> The four weeks has passed too. I'm not sure whether you were looking
> for someone who has previously been involved in Twisted development
> though.
> 
> I'll have a look at the documentation and see what I think of it I
> guess (I haven't read all of Twisted's documentation).

As a way of getting a handle on this task, can people mail me offlist
with their understanding of what the current burning issues with the
documentation are, and with wishlist documentation issues too? That
includes documents that aren't written and should be and documents that
are written that need rewriting, as well as overview problems
("documents are poorly indexed" that kind of thing). Specific is better
though...

This will give me a way to start a todo list (oh, if there already is a
doc todo list, can someone tell me where it is?) that would be
considerably faster than doing a initial full review of the docs myself.
In the meantime, I'll have a look at roundup and see what I can do about
using it to keep track of doc bugs/wishlist items (I don't know whether
this would overwhelm the bug tracker with documentation bugs).

I'll summarise for the list in about a week. If you'd prefer me not to
quote your email, please let me know, otherwise I'll assume people are
OK with their responses to this mail being quoted.

-Mary



From alexander.winston at comcast.net  Sat Nov 15 20:34:39 2003
From: alexander.winston at comcast.net (Alexander Winston)
Date: Sat, 15 Nov 2003 20:34:39 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	 <20031114210100.GA70172@clarkevans.com>
	 <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
Message-ID: <1068946479.24600.31.camel@shock>

On Sat, 2003-11-15 at 03:30, Glyph Lefkowitz wrote:
> On Nov 14, 2003, at 4:01 PM, Clark C. Evans wrote:
> 
> > A forum does not solve the core issue of organizing information
> > into a clear hierarchy of topics, filtering relevant questions
> > and answers, and a whole host of other items.  While a Wiki or
> > a Forum could be useful, it will only work if there are several
> > people who care about its structure, moderate it, and work
> > hard to make the information useful.   Other than that, threaded
> > email works just as well.
> 
> This brings up a sore point yet again - we need a documentation editor. 
>   Any volunteers? :)

I'm a fairly pedantic, obsessive-compulsive freak when it comes to
grammar and spelling freak, but we have had some conflicts regarding
that in the past...
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031115/96d10111/attachment.pgp 

From mark at mccoyfam.net  Sat Nov 15 21:07:23 2003
From: mark at mccoyfam.net (Mark D McCoy)
Date: Sat, 15 Nov 2003 20:07:23 -0600
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031113235954.GD7130@pgdn.org>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031113235954.GD7130@pgdn.org>
Message-ID: <3FB6DBDB.4080407@mccoyfam.net>

Robert Church wrote:

>On Thu, Nov 13, 2003 at 05:39:42PM -0600, Hegedus, Matthew S quipped:
>  
>
>>Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
>>forum sounds much better to me. Topics can be nicely separated, past
>>knowledge can be easily searched, and email inboxes can be freed from much
>>clutter (or at least make room for spam). Is it not too late to implement a
>>forum?
>>    
>>
>
>As Mr. Armstrong just explaned, you can do all this and more with
>the existing mailing list archive. It's here:
>
>http://twistedmatrix.com/pipermail/twisted-python
> 
>You don't need to be subscried to the list to read the archive. Topics
>are nicely seperated. Posts can be easily searched using google. Is it
>too late to use the tools we already have before dumping 'em for a
>bulletin board? Hm?
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>  
>
I prefer to use the 'nomail' option to the mailing list (so i can post) 
and use gmane's nntp via mozilla thunderbird to read.  The web interface 
also allows for dearching posts.  Keeps my inbox from getting too 
cluttered, but I have easy access to all of the mailing list (even from 
before I signed up to it) in a nice threaded format.

-- 
Mark McCoy -- US Army SGT
------------------------------------------------------------------------
Proudly supporting the Free    | UNIX was not designed to stop you from
Software movement since 1996.  | doing stupid things, because that would
                               | also stop you from doing clever things.
                               |                  -- Doug Gwyn
------------------------------------------------------------------------





From twisted at st.imul.us  Sat Nov 15 21:57:38 2003
From: twisted at st.imul.us (charles brandt)
Date: Sat, 15 Nov 2003 18:57:38 -0800
Subject: [Twisted-Python] using defers with requests
Message-ID: <002401c3abed$65299a50$2a01a8c0@marge>

I am trying to select some data from a database in hopes of eventually using
it to populate a dynamic page.  Before I dive into woven, I was trying to
get the following to print selected data directly to a html resource using
the following code snippet (or various versions of it).   I've only been
able to get an empty page though ( <html><body></body></html> ).  I'm
wondering if maybe the request is getting returned before the callback makes
it to the defer?  Any ideas? Thanks in advance,

-Charles.

from twisted.web import resource, server
from twisted.enterprise import adbapi

dbpool = adbapi.ConnectionPool(<connection stuff>)

def getData(data):
    return dbpool.runQuery("SELECT * FROM some_table WHERE some_column =
%s", data)

def printResult(data, request):
    request.write("pre-data")
    request.write(data)
    request.write("post-data")
    request.finish()

class myResource(resource.Resource):
    def render(self, request):
        d = getData("some string")
        d.addCallback(printResult, request)
        return server.NOT_DONE_YET

resource = myResource()





From radix at twistedmatrix.com  Sat Nov 15 22:08:14 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 15 Nov 2003 22:08:14 -0500
Subject: [Twisted-Python] using defers with requests
In-Reply-To: <002401c3abed$65299a50$2a01a8c0@marge>
References: <002401c3abed$65299a50$2a01a8c0@marge>
Message-ID: <20031116030814.GD2269@twistedmatrix.com>

On Sat, Nov 15, 2003 at 06:57:38PM -0800, charles brandt wrote:
> I am trying to select some data from a database in hopes of eventually using
> it to populate a dynamic page.  Before I dive into woven, I was trying to
> get the following to print selected data directly to a html resource using
> the following code snippet (or various versions of it).   I've only been
> able to get an empty page though ( <html><body></body></html> ).  I'm
> wondering if maybe the request is getting returned before the callback makes
> it to the defer?  Any ideas? Thanks in advance,

Are you sure your code is even being triggered? Since your code isn't
writing out those HTML tags anywhere, it seems like some completely
different resource is being renderred instead of yours. Can you put
some debug prints in "render" and "printResult"?

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From andrew-twisted at puzzling.org  Sat Nov 15 22:11:46 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 16 Nov 2003 14:11:46 +1100
Subject: [Twisted-Python] using defers with requests
In-Reply-To: <20031116030814.GD2269@twistedmatrix.com>
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com>
Message-ID: <20031116031146.GG32299@frobozz>

On Sat, Nov 15, 2003 at 10:08:14PM -0500, Christopher Armstrong wrote:
> On Sat, Nov 15, 2003 at 06:57:38PM -0800, charles brandt wrote:
> > I am trying to select some data from a database in hopes of eventually using
> > it to populate a dynamic page.  Before I dive into woven, I was trying to
> > get the following to print selected data directly to a html resource using
> > the following code snippet (or various versions of it).   I've only been
> > able to get an empty page though ( <html><body></body></html> ).  I'm
> > wondering if maybe the request is getting returned before the callback makes
> > it to the defer?  Any ideas? Thanks in advance,
> 
> Are you sure your code is even being triggered? Since your code isn't
> writing out those HTML tags anywhere, it seems like some completely
> different resource is being renderred instead of yours. Can you put
> some debug prints in "render" and "printResult"?

Also, Mozilla and IE I think both will say "<html><body></body></html>" even
when nothing was sent.  Try testing with telnet or wget...

-Andrew.




From twisted at st.imul.us  Sat Nov 15 22:59:05 2003
From: twisted at st.imul.us (charles brandt)
Date: Sat, 15 Nov 2003 19:59:05 -0800
Subject: [Twisted-Python] using defers with requests
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com> <20031116031146.GG32299@frobozz>
Message-ID: <003501c3abf5$fab21d60$2a01a8c0@marge>

> On Sat, Nov 15, 2003 at 10:08:14PM -0500, Christopher Armstrong wrote:
> > On Sat, Nov 15, 2003 at 06:57:38PM -0800, charles brandt wrote:
> > > I am trying to select some data from a database in hopes of eventually
using
> > > it to populate a dynamic page.  Before I dive into woven, I was trying
to
> > > get the following to print selected data directly to a html resource
using
> > > the following code snippet (or various versions of it).   I've only
been
> > > able to get an empty page though ( <html><body></body></html> ).  I'm
> > > wondering if maybe the request is getting returned before the callback
makes
> > > it to the defer?  Any ideas? Thanks in advance,
> >
> > Are you sure your code is even being triggered? Since your code isn't
> > writing out those HTML tags anywhere, it seems like some completely
> > different resource is being renderred instead of yours. Can you put
> > some debug prints in "render" and "printResult"?
>
> Also, Mozilla and IE I think both will say "<html><body></body></html>"
even
> when nothing was sent.  Try testing with telnet or wget...
>

Yes, I think Mozilla is the source for the "<html><body></body></html>"
string.  I don't think anything is being sent.  If I put a request.finish()
in "render" then the resource returns any data written to request in
"render" (but not "printResult").  I'm guessing that the connection with the
client gets closed before a request is rendered.

Is anyone aware of any examples of web applications written in twisted that
uses a database to store dynamic elements?  Thats ultimately where I'm
trying to get with this.  Thanks for the responses.

-Charles.

I added some print debug statements as follows:

def printResult(data, request):
    print "entered printResult"
    request.write("pre-data")
    request.write(data)
    request.write("post-data")
    request.finish()
    print request
    return server.NOT_DONE_YET

class myResource(resource.Resource):
    def render(self, request):
        print "entered render"
        d = getData("some string")
        d.addCallback(printResult, request)
        print "after callback"
        return server.NOT_DONE_YET

resource = myResource()

which results in the following logs being generated:

2003/11/15 19:49 PST [HTTPChannel,13,<ip>] entered render
2003/11/15 19:49 PST [HTTPChannel,13,<ip>] after callback
2003/11/15 19:49 PST [HTTPChannel,13,<ip>] adbapi connecting: MySQLdb
{<connection args>}
2003/11/15 19:49 PST [-] entered printResult
2003/11/15 19:49 PST [-] <ip> - - [16/Nov/2003:03:49:11 +0000] "GET
/beta/resource3.rpy HTTP/1.1" 200 18 "-" "Mozilla/5.0"
2003/11/15 19:49 PST [-] <GET /beta/resource3.rpy HTTP/1.1>





From radix at twistedmatrix.com  Sat Nov 15 23:06:06 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 15 Nov 2003 23:06:06 -0500
Subject: [Twisted-Python] using defers with requests
In-Reply-To: <003501c3abf5$fab21d60$2a01a8c0@marge>
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com> <20031116031146.GG32299@frobozz> <003501c3abf5$fab21d60$2a01a8c0@marge>
Message-ID: <20031116040606.GE2269@twistedmatrix.com>

On Sat, Nov 15, 2003 at 07:59:05PM -0800, charles brandt wrote:
> I added some print debug statements as follows:
> 
> def printResult(data, request):
>     print "entered printResult"
>     request.write("pre-data")
>     request.write(data)
>     request.write("post-data")
>     request.finish()
>     print request

What is 'data' here? can you print repr(data)? It might be the empty
string, or something.

>     return server.NOT_DONE_YET

This is unnecessary here, FYI.

> class myResource(resource.Resource):
>     def render(self, request):
>         print "entered render"
>         d = getData("some string")
>         d.addCallback(printResult, request)
>         print "after callback"
>         return server.NOT_DONE_YET
> 
> resource = myResource()

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From twisted at st.imul.us  Sat Nov 15 23:52:32 2003
From: twisted at st.imul.us (charles brandt)
Date: Sat, 15 Nov 2003 20:52:32 -0800
Subject: [Twisted-Python] using defers with requests
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com> <20031116031146.GG32299@frobozz> <003501c3abf5$fab21d60$2a01a8c0@marge> <20031116040606.GE2269@twistedmatrix.com>
Message-ID: <003c01c3abfd$71f73d90$2a01a8c0@marge>

> On Sat, Nov 15, 2003 at 07:59:05PM -0800, charles brandt wrote:
> > I added some print debug statements as follows:
> >
> > def printResult(data, request):
> >     print "entered printResult"
> >     request.write("pre-data")
> >     request.write(data)

    print repr(data)

> >     request.write("post-data")
> >     request.finish()
> >     print request
>
> What is 'data' here? can you print repr(data)? It might be the empty
> string, or something.

2003/11/15 20:43 PST [-] entered printResult
2003/11/15 20:43 PST [-] ((13L, 'Hawaii', 'HI', 'US'),)

Seems like the request might be different from the original, or doesn't have
a channel to respond on?

-Charles





From twisted at st.imul.us  Sun Nov 16 00:47:58 2003
From: twisted at st.imul.us (charles brandt)
Date: Sat, 15 Nov 2003 21:47:58 -0800
Subject: [Twisted-Python] using defers with requests
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com> <20031116031146.GG32299@frobozz> <003501c3abf5$fab21d60$2a01a8c0@marge> <20031116040606.GE2269@twistedmatrix.com> <003c01c3abfd$71f73d90$2a01a8c0@marge>
Message-ID: <004e01c3ac05$30a1a620$2a01a8c0@marge>

For completeness, Christopher pointed out that I was not passing a string to
request.write (str(data)).  Since I did not have an Errback call, the
exception that was raised in the callback was never output.  (fixed by
adding: d.addErrback(log.err)  )

Thanks for the help!

-Charles

> > > I added some print debug statements as follows:
> > >
> > > def printResult(data, request):
> > >     print "entered printResult"
> > >     request.write("pre-data")
> > >     request.write(data)
>
>     print repr(data)
>
> > >     request.write("post-data")
> > >     request.finish()
> > >     print request
> >
> > What is 'data' here? can you print repr(data)? It might be the empty
> > string, or something.
>
> 2003/11/15 20:43 PST [-] entered printResult
> 2003/11/15 20:43 PST [-] ((13L, 'Hawaii', 'HI', 'US'),)
>
> Seems like the request might be different from the original, or doesn't
have
> a channel to respond on?
>
> -Charles
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>





From bauer at mit.edu  Fri Nov 14 10:04:47 2003
From: bauer at mit.edu (Steven Bauer)
Date: Fri, 14 Nov 2003 10:04:47 -0500
Subject: [Twisted-Python] Documentation Question
In-Reply-To: <20031114062412.2922.qmail@green.zadka.com>
References: <20031110221220.GA4281@mit.edu> <20031114062412.2922.qmail@green.zadka.com>
Message-ID: <20031114150447.GA18196@mit.edu>

Moshe Zadka [twisted at zadka.site.co.il] wrote:
>Did you try using help(internet.UDPServer) from the interactive interpreter?
>Here's what I got:
>
>class UDPServer(_AbstractServer)
> |  Serve UDP clients
> |
> |  Call listenUDP when the service starts, with the
> |  arguments given to the constructor. When the service stops,
> |  stop listening.
>
>I checked in a fix to make it say "reactor.listenUDP" -- I guess it was
>just a blindspot of me, I knew what listenUDP means :)
>Anyway, this should not have required any "looking at the code".
>Hopefully with my fix you'll be able to know you should do
>help(reactor.listenUDP) to get the information you're after:

(I am replying off list so that I don't have to wait for moderator approval.)

Thanks for your helpful reply.  I had looked at the web documentation
and interactive help however I evidently have a blind spot for the very
first sentence. :)  I repeatedly skimmed down to the function I am interested
in and saw:

__init__(self, *args, **kwargs)

Not being able to find out what these arguments were *right there* in the
documentation I immediately just checked the code.  This didn't take
long at all of course just annoying.  I then ran into the same issue
with one of the other server classes and figured I must be missing
something.  Turns out I was evidently literally missing something 
in the documentation.  :)

So far though Twisted is a great system.  Thanks for your work and
reply.

-Steve





From robert at redcor.ch  Sat Nov 15 02:54:30 2003
From: robert at redcor.ch (robert)
Date: Sat, 15 Nov 2003 08:54:30 +0100
Subject: [Twisted-Python] Re: [Plone-developers] [Ann] epoz 1.0 beta1 released
In-Reply-To: <3FB4F453.7000800@weitershausen.de>
References: <3FB4F453.7000800@weitershausen.de>
Message-ID: <200311150854.30380.robert@redcor.ch>

Philipp,
thanks for your info and efforts.

I am currently working on a Project using Plone 2.0 for which I need a visual 
editor.
Since the project is due by the end of the year, I need to use a solution that 
is available by then. 
My question therefore is:what is the state of the plone integration?
Is there something I could use to start with?

I would very much like to help beta testing, but it must be in an Plone 
environment.

Robert

Am Freitag, 14. November 2003 16:27 schrieb Philipp von Weitershausen:
> The epoz project is pleased to announce the first beta version of its
> cross-browser visual HTML editor!
>
> Originally written by Maik Jablonski, the editor famous in the world of
> Zope and Plone was completely redesigned by Paul Everitt (Zope Europe
> Association) and Guido Wesdorp (Infrae) and Philipp von Weitershausen
> (philiKON Valley). The result is a very flexible editing machine based
> on the following concepts:
>
>    - Integration
>
>      epoz was designed to be highly integrable into target products. It
>      uses Zope Page Templates (ZPT) for the XHTML templating. ZPTs hide
>      templating instructions in XML namespaces. That way, all XHTML
>      templates in epoz remain valid XHTML documents and should be able
>      to be used in similar templating systems without modification.
>      That also means, epoz can directly be used off of the filesystem
>      or served by Apache, without any templating engine.
>
>    - Document-centric and asynchronous editing
>
>      Other in-browser editors simply provide a replacement for the
>      textarea element in XHTML forms. epoz instead focuses on
>      document-centric editing. It lets you edit the contents of an
>      XHTML document and dublin core metadata (Title, Creator etc.) in a
>      compact and standard-conformant way. Upon save, epoz constructs a
>      full-fledged XHTML document again and invokes a PUT request to the
>      server. Being a standard HTTP command, PUT requests can be served
>      by nearly any webserver, even Apache (with mod_dav)!
>
>    - Customization and extensibility
>
>      The looks of epoz can be modified without having to modify the
>      XHTML templates by simply customizing the Cascading Style
>      Sheets. Its JavaScript architecture has been modelled after the
>      MVC concept. That means you may customize large or small parts of
>      the editor without having to reimplement or subclass anything, but
>      it also means extending epoz's functionality is just as easy.
>
> Where can I get it?
>
>    You may download a tarball at the the epoz project homepage at
>    Sourceforge:
>
>      http://sourceforge.net/project/showfiles.php?group_id=84377
>
> How can I use it?
>
>    epoz comes with a great deal of documentation already. The
>    INSTALL.txt file in the 'doc' directory should provide a small set
>    of introductions for Zope users.
>
>    If you would like to see epoz in action without having to install it
>    in Zope, you may either download the tarball and open
>    'common/epozmacros.html' in your browser or visit the following URL
>    (served by Apache, btw):
>
>      http://www.philikon.de/files/epoz/common/epozmacros.html
>
>    If you happen to succeed at integrating epoz into your favourite web
>    application server, feel free to contact us if you would like to
>    contribute your code to the project. Equally, any documentation
>    about how to integrate, customize or extend are very welcome.
>
> What to expect for future releases
>
>    - Link and image toolbox:
>
>      The original Epoz editor provided a toolbox for Plone users that
>      was loaded in a browser pop-up window. Since epoz 1.0 puts a lot
>      of focus on document-centric editing, it places toolbox elements
>      such as a link or image browser and table creator right on the
>      edit page. Results for link and image searching will be loaded
>      asynchronously in a yet-to-defined XML format.
>
>      In upcoming releases, we will provide asynronous server-side
>      methods for link and image searching in Zope2, CMF, Plone and
>      Zope3.
>
>    - Plone integration:
>
>      Although we have made an effort to integrate it with Plone
>      1.0/2.0, we have seen that current versions of Plone does not
>      allow an editor to take over for document-centric editing. Philipp
>      has made a Plone Improvement Proposal (PLIP) to provide a visual
>      editing architecture in Plone
>      (http://plone.org/development/current/projects/PLIP5). The
>      proposal has been accepted by the community and Philipp is
>      currently implementing. It is expected that Plone 2.1 will be
>      ready to be plugged together with upcoming versions of epoz.
>
> How to report bugs?
>
>    Please help us make epoz 1.0 bugfree and report bugs you encounter
>    at:
>
>      http://codespeak.net/issues/epoz/ (mind the trailing slash)
>
>    Further questions? Write us to:
>
>      epoz-development at lists.sourceforge.net
>
> We are looking forward to your comments.
> On behalf of the epoz project,
>
> Philipp von Weitershausen
>
>
>
>
> -------------------------------------------------------
> This SF.Net email sponsored by: ApacheCon 2003,
> 16-19 November in Las Vegas. Learn firsthand the latest
> developments in Apache, PHP, Perl, XML, Java, MySQL,
> WebDAV, and more! http://www.apachecon.com/
> _______________________________________________
> Plone-developers mailing list
> Plone-developers at lists.sourceforge.net
> https://lists.sourceforge.net/lists/listinfo/plone-developers

-- 
mit freundlichen Gr?ssen

Robert Rottermann
www.redCOR.ch




From justinjohnson at fastmail.fm  Mon Nov 17 14:19:29 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Mon, 17 Nov 2003 11:19:29 -0800
Subject: [Twisted-Python] LivePage patch? - was (LivePage CACHING Problem)
Message-ID: <20031117191929.B0D6141510@server1.messagingengine.com>

Working with fzZzy on #divmod, I made the following change to my local
twisted/web/woven/flashconduit.py to make LivePage work for me.  I'm
using guard sessions (which appear to not be supported by the current
code) so in my case the sessions are stored on the SessionWrapper.  I
really don't know squat about the way the code should be, so hopefully
someone else can take a look at this and apply a real patch.  I'd gladly
do the real thing, but it would take me a *lot* longer to do.  :-)

Thanks.
-Justin


--- flashconduit.py.orig        2003-11-17 13:18:37.000000000 -0600
+++ flashconduit.py     2003-11-17 13:18:43.000000000 -0600
@@ -16,7 +16,8 @@
         #self.lp.unhookOutputConduit()

     def lineReceived(self, line):
-        session = self.factory.site.getSession(line)
+        #session = self.factory.site.getSession(line)
+        session = self.factory.site.resource.sessions[line]
         self.lp = lp = session.getComponent(interfaces.IWovenLivePage)
         lp.hookupOutputConduit(self)




----- Original message -----
From: "Justin Johnson" <justinjohnson at fastmail.fm>
To: "Twisted-Python" <twisted-python at twistedmatrix.com>
Date: Thu, 13 Nov 2003 11:19:09 -0600
Subject: Re: [Twisted-Python] LivePage CACHING Problem

I found the following post that looks similar to my problem.

http://twistedmatrix.com/pipermail/twisted-python/2003-May/004170.html

But since I have my own tap, I copied the code from web/tap.py into my
code to start up the FlashConduitFactory.  It starts up, but I get the
following errors.  Is this a bug?  Any ideas what I'm doing wrong?

2003/11/13 11:08 CST [twisted.web.woven.flashconduit.FlashConduitFactory]
connection with flash movie opened
2003/11/13 11:08 CST [FlashConduit,3,xxx.xxx.xxx.xxx] Traceback (most
recent call last):
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
          line 501, in doSelect
            _logrun(selectable, _drdw, selectable, method, dict)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
          line 65, in callWithLogger
            callWithContext({"system": lp}, func, *args, **kw)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
          line 52, in callWithContext
            return context.call({ILogContext: newCtx}, func, *args, **kw)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/context.py",
          line 32, in callWithContext
            return func(*args,**kw)
        --- <exception caught here> ---
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
          line 510, in _doReadOrWrite
            why = getattr(selectable, method)()
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/tcp.py",
          line 250, in doRead
            return self.protocol.dataReceived(data)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/protocols/basic.py",
          line 223, in dataReceived
            why = self.lineReceived(line)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/web/woven/flashconduit.py",
          line 19, in lineReceived
            session = self.factory.site.getSession(line)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/web/server.py",
          line 470, in getSession
            return self.sessions[uid]
        exceptions.KeyError: 'd01be6fe334cded345c0b029e29df7ac'

2003/11/13 11:08 CST [FlashConduit,3,xxx.xxx.xxx.xxx] connection lost



On Thu, 13 Nov 2003 10:38:59 -0600, "Justin Johnson"
<justinjohnson at fastmail.fm> said:
> Hi,
> 
> I am currently trying to use LivePage to update the cells of an html
> table with results from processes initiated in various PB services.  The
> client intiates requests in the services and those services call back
> into the client's (a pb.Referenceable) remote_updateStatus method to
> update the table which displays the results.  I have test code that
> simulates this and everything works fine.  Javascript is sent to the
> browser to update the cells of the table.  Works really slick.  However,
> now that I tried to hook it up to PB, the LivePage javascript sending
> part isn't working.  When I make the page.sendScript(script) call I get
> the following in the log.
> 
> 2003/11/13 10:25 CST [Broker,client] Sending javascript to page
> <twisted.web.woven.utils.WovenLivePage instance at 0x4089944c>
> 2003/11/13 10:25 CST [Broker,client] CACHING
> [<twisted.web.woven.utils.Script instance at 0x4089906c>]
> 
> All future sendScript calls append the script to the cache.  Everything
> else is working appropriately, and all code is executing as I'd expect,
> except that the javascript doesn't send properly.  Is there something in
> particular I should be looking for here?  I don't see what I'm doing
> different, but since LivePage is quite magical to me I'm not sure where
> to look.
> 
> On a slightly different note, is there LivePage-ish support in nevow, and
> do you recommend moving to that yet?
> 
> Thanks.
> -Justin
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From vlupien at drummonddesigns.com  Mon Nov 17 14:44:36 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Mon, 17 Nov 2003 14:44:36 -0500
Subject: [Twisted-Python] model question
Message-ID: <000001c3ad43$3cdf7f40$687ba8c0@vicky>

I have a web based application.
 
I want to create a model from a sql query that will be accessible from
the web page.
I want to be able to create my model in the setUp fonction.
I also want to access my model from the web page like this:
model="plan_id" (where plan_id is a column from my sql query)
 
I don't know if someone understand what I want.
 
Here's a part of my class:
 
class SummaryDB:
    """PublisherDB Class"""
    def __init__(self, dbpool):
        self.dbpool = dbpool
 
    def getSummary(self, plan_id):
        sql = "select * from plan where plan_id = '%s'" %plan_id
        return self.dbpool.runQueryDict(sql)
 
class SummaryPage(pages.BasePage):
    templateFile = "summary.html"
    
    def initialize(self, dbpool):
        self.dbpool = dbpool
        self.db = SummaryDB(self.dbpool)
            
    def setUp(self, request, *args):
        # I want to do somethings like :
        # self.model = ({'details' : self.db.getSummary(plan_id)}
        # and then, access to details by my web page
        self.contextMenu = menus.build_search_menu()
 
    
And here's my template:
 
<html>
            <head>
                        <title>
                                    Title 
                        </title>
            </head>
            <body>
                        <br />
                        <table border="0" width="100%" cellspacing="1"
cellpadding="2">
                                    <tr>
                                                <th class="header"
colspan="2">
                                                            Sommaire 
                                                </th>
                                    </tr>
                                    <tr>
                                                <td class="label"
width="25%">
                                                            Number 
                                                </td>
                                                <td class="area"
width="75%" model="details/plan_id">&nbsp;2165</td>    #plan_id is a
column from the sql query
                                    </tr>
                        </table>
            </body>
</html>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031117/dff4b20a/attachment.htm 

From lafou at wanadoo.fr  Mon Nov 17 16:50:32 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Mon, 17 Nov 2003 22:50:32 +0100
Subject: [Twisted-Python] model question
In-Reply-To: <000001c3ad43$3cdf7f40$687ba8c0@vicky>
References: <000001c3ad43$3cdf7f40$687ba8c0@vicky>
Message-ID: <200311172250.32947.lafou@wanadoo.fr>

On Monday 17 November 2003 20:44, vicky lupien wrote:
> I have a web based application.
>
> I want to create a model from a sql query that will be accessible from
> the web page.
> I want to be able to create my model in the setUp fonction.
> I also want to access my model from the web page like this:
> model="plan_id" (where plan_id is a column from my sql query)
>
> I don't know if someone understand what I want.
>


Why don't you use a wmfactory_details ?
I don't understand why you want to put it in the setUp method :(




From phil at bubblehouse.org  Mon Nov 17 17:32:44 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Mon, 17 Nov 2003 17:32:44 -0500 (EST)
Subject: [Twisted-Python] another probably very simple question
Message-ID: <1468.65.246.170.211.1069108364.squirrel@192.168.0.2>

this is actually the first time i've ever written a PB client in python.
since my java client was calling the remote methods out of the awt/swing
event thread, i never had to deal with this particular issue. while i'm
waiting for the update to the java pb packages (*cough*itamar*cough* ;-)
), i figured it would be worthwhile to do up a text-based client in
python.

i know this relates to my poor understanding of deferreds, but i just
can't figure out exactly how to go about doing what i want to do.

i want to be able to continually prompt the user for a string that gets
sent to a "parse" method on the remote object. i'm not exactly sure the
right way to do this. do I just add a callback to the deferred returned by

def main():
    config = Options()
    if(config['login'] == None):
        config['login'] = getpass.getuser()
    passwd = getpass.getpass("%s@%s's password: " % (config['login'],
                                                     config['host']))

    client = TextClient()
    factory = pb.PBClientFactory()
    reactor.connectTCP(config['host'], int(config['port']), factory)
    defer = factory.login(credentials.UsernamePassword(config['login'],
                                                       passwd), client)
    defer.addCallback(connected)
    reactor.run()

def connected(perspective):
    command = raw_input("> ");
    defer = perspective.callRemote("parse", command)




From phil at bubblehouse.org  Mon Nov 17 17:34:24 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Mon, 17 Nov 2003 17:34:24 -0500 (EST)
Subject: [Twisted-Python] another probably very simple question
Message-ID: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2>

[whoops, sorry about the previous incomplete message]

this is actually the first time i've ever written a PB client in python.
since my java client was calling the remote methods out of the awt/swing
event thread, i never had to deal with this particular issue. while i'm
waiting for the update to the java pb packages (*cough*itamar*cough* ;-)
), i figured it would be worthwhile to do up a text-based client in
python.

i know this relates to my poor understanding of deferreds, but i just
can't figure out exactly how to go about doing what i want to do.

i want to be able to continually prompt the user for a string that gets
sent to a "parse" method on the remote object. i'm not exactly sure the
right way to do this. do I just add a callback to the deferred returned by
call remote?

here's my code so far:

def main():
    config = Options()
    if(config['login'] == None):
        config['login'] = getpass.getuser()
    passwd = getpass.getpass("%s@%s's password: " % (config['login'],
                                                     config['host']))

    client = TextClient()
    factory = pb.PBClientFactory()
    reactor.connectTCP(config['host'], int(config['port']), factory)
    defer = factory.login(credentials.UsernamePassword(config['login'],
                                                       passwd), client)
    defer.addCallback(connected)
    reactor.run()

def connected(perspective):
    command = raw_input("> ");
    defer = perspective.callRemote("parse", command)
    defer.addCallback(connected)



From andrew-twisted at puzzling.org  Mon Nov 17 20:01:23 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 18 Nov 2003 12:01:23 +1100
Subject: [Twisted-Python] another probably very simple question
In-Reply-To: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2>
Message-ID: <20031118010123.GB12240@frobozz>

On Mon, Nov 17, 2003 at 05:34:24PM -0500, Phil Christensen wrote:
> 
> i want to be able to continually prompt the user for a string that gets
> sent to a "parse" method on the remote object. i'm not exactly sure the
> right way to do this. do I just add a callback to the deferred returned by
> call remote?
> 
> here's my code so far:
> 
> def main():
>     config = Options()
>     if(config['login'] == None):
>         config['login'] = getpass.getuser()
>     passwd = getpass.getpass("%s@%s's password: " % (config['login'],
>                                                      config['host']))
> 
>     client = TextClient()
>     factory = pb.PBClientFactory()
>     reactor.connectTCP(config['host'], int(config['port']), factory)
>     defer = factory.login(credentials.UsernamePassword(config['login'],
>                                                        passwd), client)
>     defer.addCallback(connected)
>     reactor.run()
> 
> def connected(perspective):
>     command = raw_input("> ");
>     defer = perspective.callRemote("parse", command)
>     defer.addCallback(connected)

Calling raw_input is a bad idea.  It will block.

You should either use twisted.internet.stdio (which is probably more work
than you care to do -- but see doc/examples/cursesclient.py for an example
that uses stdio and curses to make a simple irc client), or run raw_input in
a thread:


from twisted.internet import threads

def connected(perspective):
    deferred = threads.deferToThread(raw_input, "> ")
    deferred.addCallback(lambda cmd: perspective.callRemote("parse", cmd))
    deferred.addCallback(lambda res: connected(perspective))


Note that perspective.callRemote will return a Deferred -- but that's ok,
the Deferreds automatically cope with (i.e. wait for) deferred results from
callbacks :)

Something else to notice is that Deferreds pass the result of the previous
callback (or the original result, for the first callback) to each callback,
which is why I wrote:
    deferred.addCallback(lambda res: connected(perspective))
rather than your:
    defer.addCallback(connected)

-Andrew.




From stuart.hungerford at anu.edu.au  Mon Nov 17 20:02:02 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Tue, 18 Nov 2003 12:02:02 +1100
Subject: [Twisted-Python] Browser oddities and Woven...
Message-ID: <6.0.0.22.0.20031118114909.01e82730@anusf.anu.edu.au>

Hi all,

I probably shouldn't be too surprised, but I'm experiencing
some odd behaviour with IE 6.0 .vs. Mozilla 1.5, both on
Windows XP.

I've developed a Woven application that generates three
HTML pages, let's call them A, B, and C.

A's render() method does a redirect to B. B's view methods
generate an XHTML meta tag with the content attribute set
to a refresh and new URL for C:

     <meta content="10;http://example.org/C" http-equiv="refresh" />

With Mozilla as the client everything thing goes as I expected
with pages progressing from A to B to C.

With IE as the client it goes from A to B, then loops continually
on B, i.e A, B, B, B, ... without ever reaching C.

I suspect there's some request header I need to set or set
differently?  Can anyone offer me advice on this strange
situation?


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From matteo.giacomazzi at email.it  Tue Nov 18 02:55:01 2003
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Tue, 18 Nov 2003 08:55:01 +0100
Subject: [Twisted-Python] UNIXServer and its socket
Message-ID: <20574562.20031118085501@email.it>

In my application I have a server that listens on a UNIX socket.
When I kill the application, the socket file remains in the filesystem
so  when  I  restart  it  I always achieve an "Address already in use"
error.

Should  I  delete  it  manually  any time I stop the application or is
there a more elegant way to solve this problem?

The application is a plugin for twistd.

Thank you in advance.
  
 Matteo




From twisted at zadka.site.co.il  Tue Nov 18 06:09:45 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 18 Nov 2003 11:09:45 -0000
Subject: [Twisted-Python] UNIXServer and its socket
In-Reply-To: <20574562.20031118085501@email.it>
References: <20574562.20031118085501@email.it>
Message-ID: <20031118110945.31715.qmail@green.zadka.com>

On Tue, 18 Nov 2003, Matteo Giacomazzi <matteo.giacomazzi at email.it> wrote:

> In my application I have a server that listens on a UNIX socket.
> When I kill the application, the socket file remains in the filesystem
> so  when  I  restart  it  I always achieve an "Address already in use"
> error.

I'm guessing you're using 1.1?
It's fixed in CVS, so when there is a new release, it will be fixed.
I'm not sure what your best course of action, though:
* Live with it, and wait for new release
* Move to CVS, wait for new release to move back to released version
* Implement some work around, wait for new release to remove it

I'm sorry there aren't better news than "it was a bug, we fixed it" --
twisted.application is quite a bit of code, and testing in the field
frequently finds more bugs. You can rest assured that the bug was
not merely fixed, but a unit test added to make sure it doesn't
come back.



From matteo.giacomazzi at email.it  Tue Nov 18 06:36:19 2003
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Tue, 18 Nov 2003 12:36:19 +0100
Subject: [Twisted-Python] UNIXServer and its socket
In-Reply-To: <20031118110945.31715.qmail@green.zadka.com>
References: <20574562.20031118085501@email.it>
 <20031118110945.31715.qmail@green.zadka.com>
Message-ID: <10113852281.20031118123619@email.it>

>> In  my  application  I have a server that listens on a UNIX socket.
>> When  I  kill  the  application,  the  socket  file  remains in the
>> filesystem  so  when  I  restart  it  I  always achieve an "Address
>> already in use" error.

> I'm guessing you're using 1.1?

Right!

> It's fixed in CVS, so when there is a new release, it will be fixed.
> I'm not sure what your best course of action, though:
> * Live with it, and wait for new release
> * Move to CVS, wait for new release to move back to released version
> * Implement some work around, wait for new release to remove it

I will take option number 1.
If I'm not wrong, in version 1.0.7 this error didn't appear.

> I'm  sorry there aren't better news than "it was a bug, we fixed it"
> --  twisted.application  is  quite a bit of code, and testing in the
> field  frequently finds more bugs. You can rest assured that the bug
> was  not merely fixed, but a unit test added to make sure it doesn't
> come back.

That's good, thank you: I will wait for next release.

Regards,
 Matteo




From andrew-twisted at puzzling.org  Tue Nov 18 06:38:31 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 18 Nov 2003 22:38:31 +1100
Subject: [Twisted-Python] UNIXServer and its socket
In-Reply-To: <10113852281.20031118123619@email.it>
References: <20574562.20031118085501@email.it> <20031118110945.31715.qmail@green.zadka.com> <10113852281.20031118123619@email.it>
Message-ID: <20031118113831.GH32299@frobozz>

On Tue, Nov 18, 2003 at 12:36:19PM +0100, Matteo Giacomazzi wrote:
> 
> > It's fixed in CVS, so when there is a new release, it will be fixed.
> > I'm not sure what your best course of action, though:
> > * Live with it, and wait for new release
> > * Move to CVS, wait for new release to move back to released version
> > * Implement some work around, wait for new release to remove it
> 
> I will take option number 1.
> If I'm not wrong, in version 1.0.7 this error didn't appear.

That sounds likely.  twisted.application, and the associated changes to
twistd and other infrastructure, were new to 1.1.

-Andrew.




From lordvan at lordvan.com  Tue Nov 18 06:51:27 2003
From: lordvan at lordvan.com (Thomas Raschbacher)
Date: Tue, 18 Nov 2003 12:51:27 +0100
Subject: [Twisted-Python] Browser oddities and Woven...
In-Reply-To: <6.0.0.22.0.20031118114909.01e82730@anusf.anu.edu.au>
References: <6.0.0.22.0.20031118114909.01e82730@anusf.anu.edu.au>
Message-ID: <3FBA07BF.5030501@lordvan.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


hi!

Stuart Hungerford wrote:
| Hi all,
|
| I probably shouldn't be too surprised, but I'm experiencing
| some odd behaviour with IE 6.0 .vs. Mozilla 1.5, both on
| Windows XP.
|
| I've developed a Woven application that generates three
| HTML pages, let's call them A, B, and C.
|
| A's render() method does a redirect to B. B's view methods
| generate an XHTML meta tag with the content attribute set
| to a refresh and new URL for C:
|
|     <meta content="10;http://example.org/C" http-equiv="refresh" />
|
AFAIK this would be the correct syntax:
<META name="refresh" content="3,http://www.acme.com/intro.html" />
~                               ^
(ie ',' instead of ';')
http://www.w3.org/TR/WD-html40-970708/struct/global.html#h-7.1.3.2

regards


- -----BEGIN GEEK CODE BLOCK-----
GCS/CC/E/M/MU/S d- s: a--- C++++(++) UL++++ P+ L++++ E W+++ N+++ o-- K w-- O
M-- V- PS+ PE-- Y++ PGP+++ t+++ 5+ X- R tv b++++ DI- D+ G++ e-->+++++ h-- !r
z-
- ------END GEEK CODE BLOCK------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/uge/v20tKfoYgekRAi3RAJ42Jo9PG2dtSx9ws+9mEIklD/222gCff981
617IddXHoWDgzfJ3uC7TIgk=
=42Yu
-----END PGP SIGNATURE-----




From twisted at zadka.site.co.il  Tue Nov 18 09:40:03 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 18 Nov 2003 14:40:03 -0000
Subject: [Twisted-Python] UNIXServer and its socket
In-Reply-To: <10113852281.20031118123619@email.it>
References: <10113852281.20031118123619@email.it>, <20574562.20031118085501@email.it>
 <20031118110945.31715.qmail@green.zadka.com>
Message-ID: <20031118144003.3788.qmail@green.zadka.com>

On Tue, 18 Nov 2003, Matteo Giacomazzi <matteo.giacomazzi at email.it> wrote:

> I will take option number 1.
> If I'm not wrong, in version 1.0.7 this error didn't appear.

Neither did UNIXServer :)



From justinjohnson at fastmail.fm  Tue Nov 18 10:14:02 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 18 Nov 2003 07:14:02 -0800
Subject: [Twisted-Python] win32eventreactor bug?
Message-ID: <20031118151402.43857400DF@server1.messagingengine.com>

I was running twistd on windows, serving out a custom tap which is just a
web app and a pb service.  As it was doing it's thing, suddenly a ton of
output started dumping on the log.  Did I find a bug in the win32 event
reactor, or am I hitting some sort of limit?  I can send some code along
if necessary, but nothing in the log looks specific to my code.

Thanks.
-Justin
  

2003/11/18 09:07 Central Standard Time [-] Unexpected error in main loop.
2003/11/18 09:07 Central Standard Time [-] Traceback (most recent call
last):
          File
          "C:\Python23\Lib\site-packages\twisted\application\app.py",
          line
165, in run
            runApp(config)
          File "C:\Python23\Lib\site-packages\twisted\scripts\twistw.py",
          line 5
4, in runApp
            app.runReactorWithLogging(config, oldstdout, oldstderr)
          File
          "C:\Python23\Lib\site-packages\twisted\application\app.py",
          line
61, in runReactorWithLogging
            reactor.run()
          File
          "C:\Python23\Lib\site-packages\twisted\internet\default.py",
          line
 122, in run
            self.mainLoop()
        --- <exception caught here> ---
          File
          "C:\Python23\Lib\site-packages\twisted\internet\default.py",
          line
 133, in mainLoop
            self.doIteration(t)
          File
          "C:\Python23\Lib\site-packages\twisted\internet\win32eventreactor
.py", line 171, in doWaitForMultipleEvents
            val = MsgWaitForMultipleObjects(handles, 0, timeout,
            QS_ALLINPUT | Q
S_ALLEVENTS)
        pywintypes.error: (87, 'MsgWaitForMultipleObjects', 'The
        parameter is in
correct.')

2003/11/18 09:07 Central Standard Time [-] Unexpected error in main loop.
2003/11/18 09:07 Central Standard Time [-] Traceback (most recent call
last):
          File
          "C:\Python23\Lib\site-packages\twisted\application\app.py",
          line
165, in run
            runApp(config)
          File "C:\Python23\Lib\site-packages\twisted\scripts\twistw.py",
          line 5
4, in runApp
            app.runReactorWithLogging(config, oldstdout, oldstderr)
          File
          "C:\Python23\Lib\site-packages\twisted\application\app.py",
          line
61, in runReactorWithLogging
            reactor.run()
          File
          "C:\Python23\Lib\site-packages\twisted\internet\default.py",
          line
 122, in run
            self.mainLoop()
        --- <exception caught here> ---
          File
          "C:\Python23\Lib\site-packages\twisted\internet\default.py",
          line
 133, in mainLoop
            self.doIteration(t)
          File
          "C:\Python23\Lib\site-packages\twisted\internet\win32eventreactor
.py", line 171, in doWaitForMultipleEvents
            val = MsgWaitForMultipleObjects(handles, 0, timeout,
            QS_ALLINPUT | Q
S_ALLEVENTS)
        pywintypes.error: (87, 'MsgWaitForMultipleObjects', 'The
        parameter is in
correct.')

2003/11/18 09:07 Central Standard Time [-] Unexpected error in main loop.



From slyphon at twistedmatrix.com  Tue Nov 18 13:04:21 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Tue, 18 Nov 2003 13:04:21 -0500
Subject: [Twisted-Python] new ftp implementation
Message-ID: <3FBA5F25.4070506@twistedmatrix.com>

Hello all,

Just wanted to announce there is a new version of the ftp server/protocol.

the new protocol:

   - Supports cred, so you can control/abstract the filesystem
   - includes an anonymous-only avatar/realm
   - supports pipelining of commands
   - intentionally does not support globbing (to help prevent security
     holes)
   - connection limiting (ex. max 100 users)
   - individual timeouts for protocol interpreter idle time and dtp
     connection times

todos:
   - the permissions-checking needs improvement. I intend to set up an
     option on the FTPFactory that will let you set the uid of the
     anonymous user, but that's coming in the next week.
   - path purification code needs improvement (to prevent intentionally 	
     stupid paths like "\\//*/*/../../*/.." from borking the server)
   - a couple of other minor odds-and-ends


there's an example tac file in sandbox/slyphon/ftp_refactor/ftpsrv.tac

comments, suggestions, etc. welcomed


-Jonathan Simms
slyphon at twistedmatrix.com




From slyphon at twistedmatrix.com  Tue Nov 18 13:39:20 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Tue, 18 Nov 2003 13:39:20 -0500
Subject: [Twisted-Python] new ftp implementation
In-Reply-To: <3FBA5F25.4070506@twistedmatrix.com>
References: <3FBA5F25.4070506@twistedmatrix.com>
Message-ID: <3FBA6758.4000002@twistedmatrix.com>

Jonathan Simms wrote:
> Hello all,
> 
> Just wanted to announce there is a new version of the ftp server/protocol.
> 
> the new protocol:
> 
>   - Supports cred, so you can control/abstract the filesystem
>   - includes an anonymous-only avatar/realm
>   - supports pipelining of commands
>   - intentionally does not support globbing (to help prevent security
>     holes)
>   - connection limiting (ex. max 100 users)
>   - individual timeouts for protocol interpreter idle time and dtp
>     connection times
> 
> todos:
>   - the permissions-checking needs improvement. I intend to set up an
>     option on the FTPFactory that will let you set the uid of the
>     anonymous user, but that's coming in the next week.
>   - path purification code needs improvement (to prevent intentionally    
>     stupid paths like "\\//*/*/../../*/.." from borking the server)
>   - a couple of other minor odds-and-ends

one more note, as of right now, the avatar i've implemented will only 
work on linux/unix (specifically platforms that support python's pwd and 
grp modules). patches for win32 would be greatly appreciated! :)

> 
> 
> there's an example tac file in sandbox/slyphon/ftp_refactor/ftpsrv.tac
> 
> comments, suggestions, etc. welcomed
> 
> 
> -Jonathan Simms
> slyphon at twistedmatrix.com
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python






From dkuhlman at cutter.rexx.com  Tue Nov 18 18:20:03 2003
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Tue, 18 Nov 2003 15:20:03 -0800
Subject: [Twisted-Python] SOAP client for Twisted
Message-ID: <20031118152003.A985@cutter.rexx.com>

I've added minimal SOAP client support to Twisted.

I did it by copying a bit of code from twisted/web/xmlrpc.py and by
using some of the functionality from SOAPpy and adding it to
twisted/web/soap.py.

I've tested it lightly and it seems to work.

Is this of interest to the Twisted project?

If so, let me know and I'll send it along.

Someone who knows Twisted better than I will have to look at the
code to make sure that, given the way I implemented it, it does not
block.

Dave

-- 
Dave Kuhlman
dkuhlman at rexx.com
http://www.rexx.com/~dkuhlman



From itamar at itamarst.org  Tue Nov 18 18:45:35 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 18 Nov 2003 18:45:35 -0500
Subject: [Twisted-Python] SOAP client for Twisted
In-Reply-To: <20031118152003.A985@cutter.rexx.com>
References: <20031118152003.A985@cutter.rexx.com>
Message-ID: <20031118184535.4b951101.itamar@itamarst.org>

On Tue, 18 Nov 2003 15:20:03 -0800
Dave Kuhlman <dkuhlman at cutter.rexx.com> wrote:

> Is this of interest to the Twisted project?
> 
> If so, let me know and I'll send it along.

Yes indeed, please add a patch to
http://twistedmatrix.com/users/roundup.twistd/twisted/issue61 (note that
adding patches to twisted implies giving copyright to glyph for the copy
you submit.)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Tue Nov 18 19:23:43 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 19 Nov 2003 11:23:43 +1100
Subject: [Twisted-Python] win32eventreactor bug?
In-Reply-To: <20031118151402.43857400DF@server1.messagingengine.com>
References: <20031118151402.43857400DF@server1.messagingengine.com>
Message-ID: <20031119002343.GA15632@frobozz>

On Tue, Nov 18, 2003 at 07:14:02AM -0800, Justin Johnson wrote:
> I was running twistd on windows, serving out a custom tap which is just a
> web app and a pb service.  As it was doing it's thing, suddenly a ton of
> output started dumping on the log.  Did I find a bug in the win32 event
> reactor, or am I hitting some sort of limit?  I can send some code along
> if necessary, but nothing in the log looks specific to my code.

The win32eventreactor is limited to 64 objects, so that might be what's
causing the error.

-Andrew.




From mary-twisted at puzzling.org  Tue Nov 18 21:19:43 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed, 19 Nov 2003 13:19:43 +1100
Subject: Documentation editing tasks (Re: [Twisted-Python] Forum vs. mailing list)
In-Reply-To: <20031116004313.GA10624@titus.home.puzzling.org>
References: <20031115092957.GA1401@titus.home.puzzling.org> <20031116004313.GA10624@titus.home.puzzling.org>
Message-ID: <20031119021943.GA16031@titus.home.puzzling.org>

On Sun, Nov 16, 2003, Mary Gardiner wrote:
> As a way of getting a handle on this task, can people mail me offlist
> with their understanding of what the current burning issues with the
> documentation are, and with wishlist documentation issues too? That
> includes documents that aren't written and should be and documents
> that are written that need rewriting, as well as overview problems
> ("documents are poorly indexed" that kind of thing). Specific is
> better though...

OK, some results of this and later discussion is at
http://twistedmatrix.com/users/roundup.twistd/twisted/issue397

I've assigned a bunch of unclaimed doc bugs in the bug tracker to myself
(hypatia), and people can assign doc bugs to me if they like. I will try
and take responsibility at least for finding someone else to do them
otherwise they will go in what will probably turn out to be quite a long
list of docs to be written by me.

The first item I am likely to look at is an overall guide to the
documentation, probably with sub-topics ("multi-protocol applications
with Twisted", "web development with Twisted" and so on).

There's also a bit of demand for an overview of asynch network
programming and related docs on Deferreds assuming only the knowledge
given in such an overview. This is important but is not high on my own
todo list because I'm not an expert so if anyone wants to produce those
that would be excellent.

If you have comments, feel free to contact me on this list, by email
off-list, or on IRC, probably in that order of preference if you want me
to add stuff to a todo list (I'm terrible at using IRC as a todo list).

-Mary



From henni at brainbot.com  Wed Nov 19 06:59:35 2003
From: henni at brainbot.com (Thorsten Henninger)
Date: Wed, 19 Nov 2003 12:59:35 +0100
Subject: [Twisted-Python] GUI Integration
Message-ID: <3FBB5B27.5030809@brainbot.com>

Hi all,

I would like to integrate the PerspectiveBorker into a 
platform-independant GUI.
If I use Delphi for example, I include the twisted-reactor via the 
Python Deplhi Interface.
But then if I call "reactor.run()" this blocks the Delphi Application!
Since wxPython for is not supported for Windows yet, and I do not want 
to use GTK or PyGui, my question is:
How can I integrate the twisted framework into a GUI environment such as 
Delphi?
Or do I have to use Java?
Can I run the reactor in another thread?

regards,

Thorsten

-- 
brainbot technologies AG 
boppstrasse . 64 . 55118 mainz . germany
fon +49 6131 211639-1 . fax +49 6131 211639-2
http://brainbot.com/  mailto:henni at brainbot.com





From lafou at wanadoo.fr  Wed Nov 19 07:35:23 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 13:35:23 +0100
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <3FBB5B27.5030809@brainbot.com>
References: <3FBB5B27.5030809@brainbot.com>
Message-ID: <200311191335.23097.lafou@wanadoo.fr>

On Wednesday 19 November 2003 12:59, Thorsten Henninger wrote:
> Since wxPython for is not supported for Windows yet, and I do not want
> to use GTK or PyGui, my question is:

Where did you see that wxPython is not supported for windows ? it works 
perfect with windows ! Btw, you can find on this mailing list some examples 
about using twisted in wx apps.

kind regards
Philippe




From henni at brainbot.com  Wed Nov 19 07:49:06 2003
From: henni at brainbot.com (Thorsten Henninger)
Date: Wed, 19 Nov 2003 13:49:06 +0100
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <200311191335.23097.lafou@wanadoo.fr>
References: <3FBB5B27.5030809@brainbot.com> <200311191335.23097.lafou@wanadoo.fr>
Message-ID: <3FBB66C2.5000906@brainbot.com>

>Where did you see that wxPython is not supported for windows ? it works 
>perfect with windows ! Btw, you can find on this mailing list some examples 
>about using twisted in wx apps.
>  
>
this is what happens, if you run the wxdemo on windows 2000:
C:\Dokumente und Einstellungen\henni\Desktop>wxdemo.py
D:\Python23\lib\fcntl.py:7: DeprecationWarning: the FCNTL module is 
deprecated; please use fcntl
  DeprecationWarning)
D:\Python23\lib\site-packages\twisted\internet\wxsupport.py:69: 
UserWarning: Be advised wxsupport is not fully functional on Windows.
  warnings.warn("Be advised wxsupport is not fully functional on Windows.")
Traceback (most recent call last):
  File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line 
65, in ?
    demo()
  File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line 
61, in demo
    reactor.run()
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
121, in run
    self.startRunning(installSignalHandlers=installSignalHandlers)
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
115, in startRunning
    self._handleSignals()
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
87, in _handleSignals
    signal.signal(signal.SIGINT, self.sigInt)
SystemError: error return without exception set
13:45:14: Debug: c:\PROJECTS\wx\src\msw\app.cpp(439): 
'UnregisterClass(canvas)' failed with error 0x00000584 (diese Klasse hat 
noch ge?ffnete Fenster.).

Of course, simulating the reactor via a wxTimer (as seen on ASPN) does 
work, but the latest twisted says, wxsupport is not fully supported on 
Windows.

regards,

Thorsten

-- 
brainbot technologies AG 
boppstrasse . 64 . 55118 mainz . germany
fon +49 6131 211639-1 . fax +49 6131 211639-2
http://brainbot.com/  mailto:henni at brainbot.com





From lafou at wanadoo.fr  Wed Nov 19 08:20:50 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 14:20:50 +0100
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <3FBB66C2.5000906@brainbot.com>
References: <3FBB5B27.5030809@brainbot.com> <200311191335.23097.lafou@wanadoo.fr> <3FBB66C2.5000906@brainbot.com>
Message-ID: <200311191420.50851.lafou@wanadoo.fr>

ouch ! 

I haven't seen this demo, but I think it's quite old. try this instead :

http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/203471


(your warning came from twisted, not wxpython)

and here is the killing tip of the day :

http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/181780


Hope it will help !
--
Philippe

On Wednesday 19 November 2003 13:49, Thorsten Henninger wrote:
> >Where did you see that wxPython is not supported for windows ? it works
> >perfect with windows ! Btw, you can find on this mailing list some
> > examples about using twisted in wx apps.
>
> this is what happens, if you run the wxdemo on windows 2000:
> C:\Dokumente und Einstellungen\henni\Desktop>wxdemo.py
> D:\Python23\lib\fcntl.py:7: DeprecationWarning: the FCNTL module is
> deprecated; please use fcntl
>   DeprecationWarning)
> D:\Python23\lib\site-packages\twisted\internet\wxsupport.py:69:
> UserWarning: Be advised wxsupport is not fully functional on Windows.
>   warnings.warn("Be advised wxsupport is not fully functional on Windows.")
> Traceback (most recent call last):
>   File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line
> 65, in ?
>     demo()
>   File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line
> 61, in demo
>     reactor.run()
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 121, in run
>     self.startRunning(installSignalHandlers=installSignalHandlers)
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 115, in startRunning
>     self._handleSignals()
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 87, in _handleSignals
>     signal.signal(signal.SIGINT, self.sigInt)
> SystemError: error return without exception set
> 13:45:14: Debug: c:\PROJECTS\wx\src\msw\app.cpp(439):
> 'UnregisterClass(canvas)' failed with error 0x00000584 (diese Klasse hat
> noch ge?ffnete Fenster.).
>
> Of course, simulating the reactor via a wxTimer (as seen on ASPN) does
> work, but the latest twisted says, wxsupport is not fully supported on
> Windows.
>
> regards,
>
> Thorsten




From justinjohnson at fastmail.fm  Wed Nov 19 09:06:46 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 19 Nov 2003 06:06:46 -0800
Subject: [Twisted-Python] Retrieving Woven html element IDs
Message-ID: <20031119140646.D9D3941F48@server1.messagingengine.com>

In woven, html elements are automatically given an id (eg. <div
id="woven_id_18612312">... where the number is id(self) for the view).  I
have a div tag I'm trying to using to dump error logs into on the fly
with LivePage and display them to the user.  It seems that I cannot
reference a tag by name with javascript, so I need access to the
auto-generated id.  If I had the id I could do something similar to the
example below.

Does anyone know if it's possible to lookup this id in woven?

Thanks.
-Justin


<html>
<head>
<title>test</title>
<script type="text/javascript">
function displayErrors() {
    id = 'errors'
    document.getElementById(id).innerHTML += '<span>some
    error</span><br/>'
}
</script>
</head>
<body>
<a href="#" onclick="displayErrors()">add to errors</a>
<div id="errors">
</div>
</body>
</html>






From dp at twistedmatrix.com  Wed Nov 19 09:12:20 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 19 Nov 2003 09:12:20 -0500
Subject: [Twisted-Python] Retrieving Woven html element IDs
In-Reply-To: <20031119140646.D9D3941F48@server1.messagingengine.com>
References: <20031119140646.D9D3941F48@server1.messagingengine.com>
Message-ID: <636348AF-1A9A-11D8-AB79-000A95864FC4@twistedmatrix.com>

On Nov 19, 2003, at 9:06 AM, Justin Johnson wrote:

> In woven, html elements are automatically given an id (eg. <div
> id="woven_id_18612312">... where the number is id(self) for the view). 
>  I
> have a div tag I'm trying to using to dump error logs into on the fly
> with LivePage and display them to the user.  It seems that I cannot
> reference a tag by name with javascript, so I need access to the
> auto-generated id.  If I had the id I could do something similar to the
> example below.
>
> Does anyone know if it's possible to lookup this id in woven

The best way to do it is to provide your own ID. When you add an id 
attribute to a
node, woven will refrain from overwriting it with an auto-generated one.

dp




From justinjohnson at fastmail.fm  Wed Nov 19 09:25:35 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 19 Nov 2003 06:25:35 -0800
Subject: [Twisted-Python] Retrieving Woven html element IDs
In-Reply-To: <636348AF-1A9A-11D8-AB79-000A95864FC4@twistedmatrix.com>
References: <20031119140646.D9D3941F48@server1.messagingengine.com> <636348AF-1A9A-11D8-AB79-000A95864FC4@twistedmatrix.com>
Message-ID: <20031119142535.7957040D99@server1.messagingengine.com>

Excellent!  It is working beautifully now.  Thanks so much.

On Wed, 19 Nov 2003 09:12:20 -0500, "Donovan Preston"
<dp at twistedmatrix.com> said:
> 
> On Nov 19, 2003, at 9:06 AM, Justin Johnson wrote:
> 
> > In woven, html elements are automatically given an id (eg. <div
> > id="woven_id_18612312">... where the number is id(self) for the view). 
> >  I
> > have a div tag I'm trying to using to dump error logs into on the fly
> > with LivePage and display them to the user.  It seems that I cannot
> > reference a tag by name with javascript, so I need access to the
> > auto-generated id.  If I had the id I could do something similar to the
> > example below.
> >
> > Does anyone know if it's possible to lookup this id in woven
> 
> The best way to do it is to provide your own ID. When you add an id 
> attribute to a
> node, woven will refrain from overwriting it with an auto-generated one.
> 
> dp
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From lafou at wanadoo.fr  Wed Nov 19 09:43:17 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 15:43:17 +0100
Subject: [Twisted-Python] Retrieving Woven html element IDs
In-Reply-To: <20031119140646.D9D3941F48@server1.messagingengine.com>
References: <20031119140646.D9D3941F48@server1.messagingengine.com>
Message-ID: <200311191543.17302.lafou@wanadoo.fr>

> <html>
> <head>
> <title>test</title>
> <script type="text/javascript">
> function displayErrors() {
>     id = 'errors'
>     document.getElementById(id).innerHTML += '<span>some
>     error</span><br/>'
> }
> </script>
> </head>
> <body>
> <a href="#" onclick="displayErrors()">add to errors</a>
> <div id="errors">
> </div>
> </body>
> </html>


Did you try twisted.web.lmx or twisted.web.microdom ? These packages wil help
you to modify the dom tree. (lmx can modify the rendered tree, and  microdom 
the template tree, if i'm right).




From lafou at wanadoo.fr  Wed Nov 19 09:44:49 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 15:44:49 +0100
Subject: [Twisted-Python] Retrieving Woven html element IDs
In-Reply-To: <20031119142535.7957040D99@server1.messagingengine.com>
References: <20031119140646.D9D3941F48@server1.messagingengine.com> <636348AF-1A9A-11D8-AB79-000A95864FC4@twistedmatrix.com> <20031119142535.7957040D99@server1.messagingengine.com>
Message-ID: <200311191544.49631.lafou@wanadoo.fr>

On Wednesday 19 November 2003 15:25, Justin Johnson wrote:
> Excellent!  It is working beautifully now.  Thanks so much.

ho, this was so simple :p




From lstep at adequat.net  Wed Nov 19 11:03:47 2003
From: lstep at adequat.net (lstep at adequat.net)
Date: Wed, 19 Nov 2003 17:03:47 +0100
Subject: [Twisted-Python] Forum vs. mailing list (first try at a forum)
In-Reply-To: <20031114213921.GB2269@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <20031114213921.GB2269@twistedmatrix.com>
Message-ID: <200311191703.47235.lstep@adequat.net>

Just a note for a "first try" forum for people that like clicking :-)
Any suggestion is accepted! On http://twisted.banquise.org/

Luc



From itamar at itamarst.org  Wed Nov 19 11:09:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 19 Nov 2003 11:09:15 -0500
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <3FBB5B27.5030809@brainbot.com>
References: <3FBB5B27.5030809@brainbot.com>
Message-ID: <20031119110915.67bc4c76.itamar@itamarst.org>

On Wed, 19 Nov 2003 12:59:35 +0100
Thorsten Henninger <henni at brainbot.com> wrote:

> If I use Delphi for example, I include the twisted-reactor via the 
> Python Deplhi Interface.
> But then if I call "reactor.run()" this blocks the Delphi Application!

You want to integrate the Delphi event loop with the Twisted event loop.
This will involve either a custom reactor, or something like what
twisted.internet.wxsupport or tksupport do.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Wed Nov 19 11:44:59 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 19 Nov 2003 11:44:59 -0500
Subject: [Twisted-Python] Forum vs. mailing list (first try at a forum)
In-Reply-To: <200311191703.47235.lstep@adequat.net>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <20031114213921.GB2269@twistedmatrix.com> <200311191703.47235.lstep@adequat.net>
Message-ID: <20031119164459.GA18453@intarweb.us>

On Wed, Nov 19, 2003 at 05:03:47PM +0100, lstep at adequat.net wrote:
> Just a note for a "first try" forum for people that like clicking :-)
> Any suggestion is accepted! On http://twisted.banquise.org/

  Cool.  The clock is an hour fast, it seems (or maybe it just doesn't know
about daylight savings time.  I could hardly blame it), and there are a
couple other minor annoyances (I really wanted to see my name as "last
registered user"!  Oh well, it's only PHP *wink*), but cool.

  I thought I might suggest some other sections to create, but I think I'll
just wait and see what people use it for.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031119/9b18badf/attachment.pgp 

From bob at redivi.com  Wed Nov 19 12:24:33 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 19 Nov 2003 12:24:33 -0500
Subject: [Twisted-Python] Forum vs. mailing list (first try at a forum)
In-Reply-To: <20031119164459.GA18453@intarweb.us>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <20031114213921.GB2269@twistedmatrix.com> <200311191703.47235.lstep@adequat.net> <20031119164459.GA18453@intarweb.us>
Message-ID: <3DFE1622-1AB5-11D8-B7C4-000A95686CD8@redivi.com>


On Nov 19, 2003, at 11:44 AM, Jp Calderone wrote:

> On Wed, Nov 19, 2003 at 05:03:47PM +0100, lstep at adequat.net wrote:
>> Just a note for a "first try" forum for people that like clicking :-)
>> Any suggestion is accepted! On http://twisted.banquise.org/
>
>   Cool.  The clock is an hour fast, it seems (or maybe it just doesn't 
> know
> about daylight savings time.  I could hardly blame it), and there are a
> couple other minor annoyances (I really wanted to see my name as "last
> registered user"!  Oh well, it's only PHP *wink*), but cool.
>
>   I thought I might suggest some other sections to create, but I think 
> I'll
> just wait and see what people use it for.

It's also really slow (a few minutes) to send out that confirmation 
email.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031119/d67343e2/attachment.bin 

From lafou at wanadoo.fr  Wed Nov 19 13:29:52 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 19:29:52 +0100
Subject: [Twisted-Python] Forum vs. mailing list (first try at a forum)
In-Reply-To: <200311191703.47235.lstep@adequat.net>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114213921.GB2269@twistedmatrix.com> <200311191703.47235.lstep@adequat.net>
Message-ID: <200311191929.52552.lafou@wanadoo.fr>

On Wednesday 19 November 2003 17:03, lstep at adequat.net wrote:
> Just a note for a "first try" forum for people that like clicking :-)
> Any suggestion is accepted! On http://twisted.banquise.org/


PHP based, but I love it :D




From jsbenson at bensonsystems.com  Wed Nov 19 14:03:21 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Wed, 19 Nov 2003 11:03:21 -0800
Subject: [Twisted-Python] looking for twisted Tkinter documentation
Message-ID: <02f301c3aecf$cdb35090$a90a500a@jsbwxp3>

Hi, I found the following at
http://twistedmatrix.com/documents/howto/choosing-reactor#auto16:

-----
Tkinter
The support for Tkinter doesn't use a specialized reactor. Instead, there is
some specialized support code:
from Tkinter import *
from twisted.internet import tksupport

root = Tk()
root.withdraw()

# Install the Reactor support
tksupport.install(root)

An example Twisted application that uses Tk can be found in
twisted/words/ui/tkim.py.
-----

But I didn't find it in either the twisted or TwistedDocs directories in my
Python 2.3 site-packages directory. The copyright,.py on my twisted
installation shows twisted version 1.1.0.

I also had a look at the examples index in
http://twistedmatrix.com/documents/examples/#auto8 and found links to uses
of qt, wx, gtk2 and curses, but nothing about Tkinter.

Having loaded up on Tkinter books on the strength of the assertion that
Tkinter is the standard, most cross-platform GUI for Python, I'm
understandably anxious to use it with twisted. I'm writing a socket server
that needs to both respond to incoming client requests and occasionally send
unsolicited messages to the client based on Tkinter button presses and timer
expirations.

I was originally going use some lower-level Python modules, but I was
intrigued by the stylistic and software engineering claims of twisted,
especially the use of aspect-oriented programming as a tool for managing
unrelated complexities, so I'm going to try to dive into twisted a little
deeper before giving up and heading back to the shallow end of the pool.
Thanks in advance for any information that will help me integrate Tkinter
with twisted.

P.S. I found the itamarst.org tutorials (formidavel!) and am working my way
through them.





From itamar at itamarst.org  Wed Nov 19 14:17:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 19 Nov 2003 14:17:51 -0500
Subject: [Twisted-Python] looking for twisted Tkinter documentation
In-Reply-To: <02f301c3aecf$cdb35090$a90a500a@jsbwxp3>
References: <02f301c3aecf$cdb35090$a90a500a@jsbwxp3>
Message-ID: <20031119141751.42151956.itamar@itamarst.org>

On Wed, 19 Nov 2003 11:03:21 -0800
"John Benson" <jsbenson at bensonsystems.com> wrote:

> I also had a look at the examples index in
> http://twistedmatrix.com/documents/examples/#auto8 and found links to
> uses of qt, wx, gtk2 and curses, but nothing about Tkinter.

http://sourceforge.net/projects/originalgamer is a twisted program that
uses Tk.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From jsbenson at bensonsystems.com  Wed Nov 19 15:45:26 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Wed, 19 Nov 2003 12:45:26 -0800
Subject: [Twisted-Python] Python a post-Object Oriented Language?
Message-ID: <035201c3aede$10464800$a90a500a@jsbwxp3>

Hi, I saw the above characterization in one of the itamarst.org twisted presentation slides. Although I'm just a journeyman programmer and somewhat unaccustomed to the rarefied atmosphere of many twisted Python discussions, I'm curious to hear why Python would be "post-OOP".

If I recall correctly, my little O'Reilly C++ book said that OOP meant you had 4 things (abstraction, encapsulation, hierarchy and something else that escapes me at the moment, maybe "coolness"). I also recall that compiled C++ had a hard time doing the neat tricks that an interpreted language can do and was necessarily limited by its origin as a preprocessor step in front of a classic C compiler. There were some minor differences like automatic constructor chaining in C++, as opposed to manual __init__ chaining in Python. There were some major differences like being able to dynamically set attributes on an object, and the replacement of data hiding by convention in Python.

Given that background, I'm just curious to hear the grounds on which Python can be classified as post-OOP. Any comments?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031119/4ae007ee/attachment.htm 

From luc.stepniewski at adelux.fr  Wed Nov 19 10:46:24 2003
From: luc.stepniewski at adelux.fr (Luc Stepniewski)
Date: Wed, 19 Nov 2003 16:46:24 +0100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031114213921.GB2269@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <20031114213921.GB2269@twistedmatrix.com>
Message-ID: <200311191646.24890.luc.stepniewski@adelux.fr>

Just a note for a "first try" forum for people that like clicking :-)
Any suggestion is accepted! On http://twisted.banquise.org/

Luc



From rc at pgdn.org  Wed Nov 19 16:07:30 2003
From: rc at pgdn.org (Robert Church)
Date: Wed, 19 Nov 2003 13:07:30 -0800
Subject: [Twisted-Python] Python a post-Object Oriented Language?
In-Reply-To: <035201c3aede$10464800$a90a500a@jsbwxp3>
References: <035201c3aede$10464800$a90a500a@jsbwxp3>
Message-ID: <20031119210730.GB7130@pgdn.org>

On Wed, Nov 19, 2003 at 12:45:26PM -0800, John Benson quipped:

> Given that background, I'm just curious to hear the grounds on which
> Python can be classified as post-OOP. Any comments?

Fortunately or unfortunately, there's no single, one, common
definition for OOP. There is wide disparity in featuresets among
languages which are commonly held to be object-oriented.

Jonathan Rees gives us a nice catalog of some of the features
typically associated with OO here:

http://paulgraham.com/reesoo.html

In what respect is Python "post-OO"? Well, you could say that a
language which combines OO features with nice first class functions
and list comprehensions, while eliminating some of the Java cruft, is
"post-OO". But you could say the same for CLOS, or Self, which are 20
and 15 years old respectively, predating the widespread adoption of OO
by a good many years. So, maybe Python is "pre-OO"?

Here's an article in American Scientist alledging the existence of a
post-OO paradigm, including XP, aspects, and design patterns:

http://www.americanscientist.org/Issues/Comsci03/03-03Hayes.html



From kunger at intersight.com  Wed Nov 19 17:51:58 2003
From: kunger at intersight.com (Kevin Unger)
Date: Wed, 19 Nov 2003 14:51:58 -0800
Subject: [Twisted-Python] (Woven question)-->wchild_Xxx() called twice per hit
In-Reply-To: <20031119210730.GB7130@pgdn.org>
Message-ID: <FAEF90BE-1AE2-11D8-B544-003065B25CAA@intersight.com>

I have a two-screen mini test application.  Each screen has a page.Page 
subclass and a template associated with the page.Page.   Let's call 
them welcomePage and nextPage.  welcomePage.html has a form whose 
action is "nextPage."  WelcomePage has a wchild_nextPage() method which 
returns an instance of NextPage.

When welcomePage's form is submitted, WelcomePage's wchild_nextPage() 
gets called twice.  The first time it gets called with the expected 
request args, the second time the request args dictionary is empty.

Obviously I'm doing something wrong, but what?

-k




From itamar at itamarst.org  Wed Nov 19 17:55:04 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 19 Nov 2003 17:55:04 -0500
Subject: [Twisted-Python] (Woven question)-->wchild_Xxx() called twice
 per hit
In-Reply-To: <FAEF90BE-1AE2-11D8-B544-003065B25CAA@intersight.com>
References: <20031119210730.GB7130@pgdn.org>
	<FAEF90BE-1AE2-11D8-B544-003065B25CAA@intersight.com>
Message-ID: <20031119175504.641c72f8.itamar@itamarst.org>

On Wed, 19 Nov 2003 14:51:58 -0800
Kevin Unger <kunger at intersight.com> wrote:

> When welcomePage's form is submitted, WelcomePage's wchild_nextPage() 
> gets called twice.  The first time it gets called with the expected 
> request args, the second time the request args dictionary is empty.

Pages by default redirect so they have a / at the end. So you submit to
http://foo/nextPage and that gets redirected to http://foo/nextPage/.

Solutions:
1. submit to /nextPage/ from the start.
2. set addSlash=0 on NextPage.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From phil at bubblehouse.org  Wed Nov 19 18:15:15 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 19 Nov 2003 18:15:15 -0500 (EST)
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <20031118010123.GB12240@frobozz>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2>
    <20031118010123.GB12240@frobozz>
Message-ID: <3238.65.246.170.211.1069283715.squirrel@192.168.0.2>

So i followed Andrew's 'raw_input' advice with much success, but i
naturally wanted to dive into curses. I was checking out the
cursesclient.py file in doc/examples/, but it seems to be broken...

it connects and everything just fine, but as soon as i type anything, i
get the following:

-------------------------------------------------------------
--- <exception caught here> ---
File
"/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/
site-packages/twisted/python/log.py", line 60, in callWithLogger
    lp = logger.logPrefix()                                               
                         exceptions.AttributeError: Screen instance
has no attribute 'logPrefix'

-------------------------------------------------------------

any ideas?

-phil



From andrew-twisted at puzzling.org  Wed Nov 19 18:49:27 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 20 Nov 2003 10:49:27 +1100
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <3238.65.246.170.211.1069283715.squirrel@192.168.0.2>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2>
Message-ID: <20031119234927.GK32299@frobozz>

On Wed, Nov 19, 2003 at 06:15:15PM -0500, Phil Christensen wrote:
> So i followed Andrew's 'raw_input' advice with much success, but i
> naturally wanted to dive into curses. I was checking out the
> cursesclient.py file in doc/examples/, but it seems to be broken...
> 
> it connects and everything just fine, but as soon as i type anything, i
> get the following:
> 
> -------------------------------------------------------------
> --- <exception caught here> ---
> File
> "/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/
> site-packages/twisted/python/log.py", line 60, in callWithLogger
>     lp = logger.logPrefix()                                               
>                          exceptions.AttributeError: Screen instance
> has no attribute 'logPrefix'
> 
> -------------------------------------------------------------
> 
> any ideas?

It's already been fixed in CVS:

    http://cvs.twistedmatrix.com/cvs/doc/examples/cursesclient.py?rev=1.7&content-type=text/vnd.viewcvs-markup

-Andrew.




From stuart.hungerford at anu.edu.au  Wed Nov 19 19:07:09 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Thu, 20 Nov 2003 11:07:09 +1100
Subject: [Twisted-Python] Re: Browser oddities and Woven... (Thomas Raschbacher)
In-Reply-To: <20031119114309.2994.45470.Mailman@pyramid.twistedmatrix.co
 m>
References: <20031119114309.2994.45470.Mailman@pyramid.twistedmatrix.com>
Message-ID: <6.0.0.22.0.20031120105725.01e08070@anusf.anu.edu.au>

Quoth twisted-python-request at twistedmatrix.com:

 >| I've developed a Woven application that generates three
 >| HTML pages, let's call them A, B, and C.
 >|
 >| A's render() method does a redirect to B. B's view methods
 >| generate an XHTML meta tag with the content attribute set
 >| to a refresh and new URL for C:
 >|
 >|     <meta content="10;http://example.org/C" http-equiv="refresh" />
 >|
 >AFAIK this would be the correct syntax:
 ><META name="refresh" content="3,http://www.acme.com/intro.html" />
 >~                               ^
 >(ie ',' instead of ';')
 >http://www.w3.org/TR/WD-html40-970708/struct/global.html#h-7.1.3.2

    Many thanks for pointing that out.  Unfortunately it makes no
    difference to the behaviour with IE or Mozilla.  I've since tried
    with Opera 7 and it goes into the endless loop too, which makes
    me think there's a problem with the (X)HTML my Woven pages are
    generating and Mozilla is being very forgiving.

    I've tried adding the equivalent HTTP headers to the request
    headers in Woven and also run the generated XHTML through the
    W3C validator.  It reported a couple of errors with some
    <tr> attributes but nothing about the <meta> elements.

    This is the generated XHTML <head>:

<?xml version="1.0"?>
<!DOCTYPE html
      PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
   <meta content="en-us" http-equiv="Content-Language" />
   <meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
   <meta content="Pacific And Regional Archive for DIgital Sources in 
Endangered Cultures " name="description" />
   <meta content="digital, digitisation, digitization, pacific,
                                        language, music, endangered, 
university, sydney,
                                        melbourne, ANU, australian, 
national, culture,
                                        metadata" name="keywords" />
   <meta content="language resource, language resources,
                                        language archive, linguistic 
archive, open archives,
                                        metadata, dublin core, controlled 
vocabulary,
                                        linguistics, linguistic data, 
language data, Pacific,
                                        endangered culture, endangered 
language, musicology,
                                        indigneous song" name="keywords" />
   <meta http-equiv="refresh" 
content="5,http://store.apac.edu.au:8181/paradisec/archive/request/download/238/AM3-008-008A.mp3" 
/>
   <link 
href="http://store.apac.edu.au:8181/PARADISEC/resources/css/paradisec.css" 
type="text/css" rel="stylesheet" />
   <title>Downloading your file AM3/008/AM3-008-008A.mp3</title>
  </head>

Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From radix at twistedmatrix.com  Wed Nov 19 19:19:13 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 19 Nov 2003 19:19:13 -0500
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <20031119234927.GK32299@frobozz>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2> <20031119234927.GK32299@frobozz>
Message-ID: <20031120001913.GE20287@radii>

On Thu, Nov 20, 2003 at 10:49:27AM +1100, Andrew Bennetts wrote:
> It's already been fixed in CVS:

Ok, I've heard this enough times. I'm going to release 1.1.1.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From corydodt at twistedmatrix.com  Wed Nov 19 19:29:33 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed, 19 Nov 2003 16:29:33 -0800
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <20031120001913.GE20287@radii>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2> <20031119234927.GK32299@frobozz> <20031120001913.GE20287@radii>
Message-ID: <3FBC0AED.4000600@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Is there a counter?  Do you tie knots in string? :-)

C

Christopher Armstrong wrote:

| On Thu, Nov 20, 2003 at 10:49:27AM +1100, Andrew Bennetts wrote:
|
|>It's already been fixed in CVS:
|
|
| Ok, I've heard this enough times. I'm going to release 1.1.1.
|

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/vArt3A5SrXAiHQcRAk4vAKCsa8U/jmDGGmsJZrK0ljZkloq54QCfbsbd
94xVAAqhXge/t/14l7lz+mA=
=uIxg
-----END PGP SIGNATURE-----



From andrew-twisted at puzzling.org  Wed Nov 19 19:39:30 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 20 Nov 2003 11:39:30 +1100
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <20031120001913.GE20287@radii>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2> <20031119234927.GK32299@frobozz> <20031120001913.GE20287@radii>
Message-ID: <20031120003930.GL32299@frobozz>

On Wed, Nov 19, 2003 at 07:19:13PM -0500, Christopher Armstrong wrote:
> On Thu, Nov 20, 2003 at 10:49:27AM +1100, Andrew Bennetts wrote:
> > It's already been fixed in CVS:
> 
> Ok, I've heard this enough times. I'm going to release 1.1.1.

Hooray! :)

-Andrew.




From andrew-twisted at puzzling.org  Wed Nov 19 19:53:19 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 20 Nov 2003 11:53:19 +1100
Subject: [Twisted-Python] Re: [Twisted-commits] Today is screw with twisted's guts day.
In-Reply-To: <E1AMZY3-0008UW-00@wolfwood>
References: <E1AMZY3-0008UW-00@wolfwood>
Message-ID: <20031120005319.GM32299@frobozz>

On Wed, Nov 19, 2003 at 02:07:39PM -0700, exarkun CVS wrote:
> Index: Twisted/twisted/internet/base.py
> diff -u Twisted/twisted/internet/base.py:1.67 Twisted/twisted/internet/base.py:1.68
> --- Twisted/twisted/internet/base.py:1.67	Fri Oct 24 12:45:58 2003
> +++ Twisted/twisted/internet/base.py	Wed Nov 19 14:07:38 2003
> @@ -400,12 +400,12 @@
>          """Run all pending timed calls.
>          """
>          if self.threadCallQueue:
> -            for i in range(len(self.threadCallQueue)):
> -                callable, args, kw = self.threadCallQueue.pop(0)
> +            for (f, a, kw) in self.threadCallQueue:
>                  try:
> -                    callable(*args, **kw)
> +                    f(*a, **kw)
>                  except:
> -                    log.deferr()
> +                    log.err()
> +            del self.threadCallQueue[:]
>          now = time()
>          while self._pendingTimedCalls and (self._pendingTimedCalls[-1].time <= now):
>              call = self._pendingTimedCalls.pop()

I think this change introduces a race condition.  It's possible for a thread
to call callFromThread between the end of the for loop and the del
statement.

(callFromThread is defined as:
    def callFromThread(self, f, *args, **kw):
        """See twisted.internet.interfaces.IReactorThreads.callFromThread.
        """
        assert callable(f), "%s is not callable" % f
        if threadable.isInIOThread():
            self.callLater(0, f, *args, **kw)
        else:
            # lists are thread-safe in CPython, but not in Jython
            # this is probably a bug in Jython, but until fixed this code
            # won't work in Jython.
            self.threadCallQueue.append((f, args, kw))
            self.wakeUp()
)

So I think it's possible to lose thread calls.  I *think* this patch will
fix it, but more eyeballs are always welcome with threaded code:

diff -u -r1.68 base.py
--- twisted/internet/base.py    19 Nov 2003 21:07:38 -0000      1.68
+++ twisted/internet/base.py    20 Nov 2003 00:52:08 -0000
@@ -400,12 +400,14 @@
         """Run all pending timed calls.
         """
         if self.threadCallQueue:
+            count = 0
             for (f, a, kw) in self.threadCallQueue:
                 try:
                     f(*a, **kw)
                 except:
                     log.err()
-            del self.threadCallQueue[:]
+                count += 1
+            del self.threadCallQueue[:count]
         now = time()
         while self._pendingTimedCalls and (self._pendingTimedCalls[-1].time <= now):
             call = self._pendingTimedCalls.pop()


-Andrew.




From exarkun at intarweb.us  Wed Nov 19 20:12:56 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 19 Nov 2003 20:12:56 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Today is screw with twisted's guts day.
In-Reply-To: <20031120005319.GM32299@frobozz>
References: <E1AMZY3-0008UW-00@wolfwood> <20031120005319.GM32299@frobozz>
Message-ID: <20031120011256.GA20693@intarweb.us>

On Thu, Nov 20, 2003 at 11:53:19AM +1100, Andrew Bennetts wrote:
> [snip]
> 
> So I think it's possible to lose thread calls.  I *think* this patch will
> fix it, but more eyeballs are always welcome with threaded code:

  Thanks for noticing this.

> 
> diff -u -r1.68 base.py
> --- twisted/internet/base.py    19 Nov 2003 21:07:38 -0000      1.68
> +++ twisted/internet/base.py    20 Nov 2003 00:52:08 -0000
> @@ -400,12 +400,14 @@
>          """Run all pending timed calls.
>          """
>          if self.threadCallQueue:
> +            count = 0
>              for (f, a, kw) in self.threadCallQueue:
>                  try:
>                      f(*a, **kw)
>                  except:
>                      log.err()
> -            del self.threadCallQueue[:]
> +                count += 1
> +            del self.threadCallQueue[:count]
>          now = time()
>          while self._pendingTimedCalls and (self._pendingTimedCalls[-1].time <= now):
>              call = self._pendingTimedCalls.pop()
> 

  That looks a little more complex than it needs to be.  What about this
version?


    def runUntilCurrent(self):
        """Run all pending timed calls.
        """
        if self.threadCallQueue:
            calls, self.threadCallQueue = self.threadCallQueue, []
            for (f, a, kw) in calls:               
                try:
                    f(*a, **kw)
                except:
                    log.err()

  I considered doing it this way first, but wasn't sure if anyone relied on
the identity of threadCallQueue (not that anyone should, but one never
knows).  If anyone thinks changing its identity should be avoided, I'd like
this version:

    def runUntilCurrent(self):
        """Run all pending timed calls.
        """
        if self.threadCallQueue:
            calls = self.threadCallQueue[:]
            del self.threadCallQueue[:]
            for (f, a, kw) in calls:
                try:
                    f(*a, **kw)
                except:
                    log.err()


  I suppose reverting it entirely is an option, seeing as how no one has yet
*actually* been bitten by the quadratic behavior (nor does it seem likely
that anyone will be), but all other things equal, it's nicer to use O(N)
algorithms deep down in the guts of Twisted than to use O(N**2) algorithms.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031119/72313699/attachment.pgp 

From andrew-twisted at puzzling.org  Wed Nov 19 20:38:03 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 20 Nov 2003 12:38:03 +1100
Subject: [Twisted-Python] Re: [Twisted-commits] Today is screw with twisted's guts day.
In-Reply-To: <20031120011256.GA20693@intarweb.us>
References: <E1AMZY3-0008UW-00@wolfwood> <20031120005319.GM32299@frobozz> <20031120011256.GA20693@intarweb.us>
Message-ID: <20031120013803.GN32299@frobozz>

On Wed, Nov 19, 2003 at 08:12:56PM -0500, Jp Calderone wrote:
> On Thu, Nov 20, 2003 at 11:53:19AM +1100, Andrew Bennetts wrote:
[patch to keep count of items used from the list]
> 
>   That looks a little more complex than it needs to be.  What about this
> version?
> 
> 
>     def runUntilCurrent(self):
>         """Run all pending timed calls.
>         """
>         if self.threadCallQueue:
>             calls, self.threadCallQueue = self.threadCallQueue, []
>             for (f, a, kw) in calls:               
>                 try:
>                     f(*a, **kw)
>                 except:
>                     log.err()

Yeah, that looks ok too, I think.  I'm less certain though... is it possible
for this to happen:

     reactor thread                 other thread
     --------------                 ------------
                                    call callFromThread
                                      ...get reference to self.threadCallQueue
     call runUntilCurrent
       ...set self.tCQ to a new list
       ...do for loop
                                      ...append to now old threadCallQueue

So that again, a call can go missing?  Hmm, I think this is possible, so
that version is also bad.  It's also harder to reason about than my patch --
I had to disassemble it to help me think about it :)

>   I considered doing it this way first, but wasn't sure if anyone relied on
> the identity of threadCallQueue (not that anyone should, but one never
> knows).  If anyone thinks changing its identity should be avoided, I'd like
> this version:
> 
>     def runUntilCurrent(self):
>         """Run all pending timed calls.
>         """
>         if self.threadCallQueue:
>             calls = self.threadCallQueue[:]
>             del self.threadCallQueue[:]
>             for (f, a, kw) in calls:
>                 try:
>                     f(*a, **kw)
>                 except:
>                     log.err()
> 

That's definitely racy!  What if the call to callFromThread happens between
the "calls = ..." and the del statement?

A version which does
    calls = self.threadCallQueue[:]
    del self.threadCallQueue[:len(calls)]

Should be ok though, for the same reason my patch is (or at least I think it
is :)

The main difference between that version and my is this one involves a small
list copy, but it might still be faster than executing "count += 1" on every
loop iteration.  Either way, it's at the point where I don't care :)

>   I suppose reverting it entirely is an option, seeing as how no one has yet
> *actually* been bitten by the quadratic behavior (nor does it seem likely
> that anyone will be), but all other things equal, it's nicer to use O(N)
> algorithms deep down in the guts of Twisted than to use O(N**2) algorithms.

I think I'd like to see it improved to have O(N) complexity too.

-Andrew.




From exarkun at intarweb.us  Wed Nov 19 20:41:58 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 19 Nov 2003 20:41:58 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Today is screw with twisted's guts day.
In-Reply-To: <20031120013803.GN32299@frobozz>
References: <E1AMZY3-0008UW-00@wolfwood> <20031120005319.GM32299@frobozz> <20031120011256.GA20693@intarweb.us> <20031120013803.GN32299@frobozz>
Message-ID: <20031120014158.GA20826@intarweb.us>

On Thu, Nov 20, 2003 at 12:38:03PM +1100, Andrew Bennetts wrote:
> On Wed, Nov 19, 2003 at 08:12:56PM -0500, Jp Calderone wrote:
> > On Thu, Nov 20, 2003 at 11:53:19AM +1100, Andrew Bennetts wrote:
> [patch to keep count of items used from the list]
> > 
> >   That looks a little more complex than it needs to be.  What about this
> > version?
> > 
> > 
> >     def runUntilCurrent(self):
> >         """Run all pending timed calls.
> >         """
> >         if self.threadCallQueue:
> >             calls, self.threadCallQueue = self.threadCallQueue, []
> >             for (f, a, kw) in calls:               
> >                 try:
> >                     f(*a, **kw)
> >                 except:
> >                     log.err()
> 
> Yeah, that looks ok too, I think.  I'm less certain though... is it possible
> for this to happen:
> 
>      reactor thread                 other thread
>      --------------                 ------------
>                                     call callFromThread
>                                       ...get reference to self.threadCallQueue
>      call runUntilCurrent
>        ...set self.tCQ to a new list
>        ...do for loop
>                                       ...append to now old threadCallQueue
> 
> So that again, a call can go missing?  Hmm, I think this is possible, so
> that version is also bad.  It's also harder to reason about than my patch --
> I had to disassemble it to help me think about it :)
> 
> >   I considered doing it this way first, but wasn't sure if anyone relied on
> > the identity of threadCallQueue (not that anyone should, but one never
> > knows).  If anyone thinks changing its identity should be avoided, I'd like
> > this version:
> > 
> >     def runUntilCurrent(self):
> >         """Run all pending timed calls.
> >         """
> >         if self.threadCallQueue:
> >             calls = self.threadCallQueue[:]
> >             del self.threadCallQueue[:]
> >             for (f, a, kw) in calls:
> >                 try:
> >                     f(*a, **kw)
> >                 except:
> >                     log.err()
> > 
> 
> That's definitely racy!  What if the call to callFromThread happens between
> the "calls = ..." and the del statement?
> 

  Shows how used to thinking about threaded code I am.

> A version which does
>     calls = self.threadCallQueue[:]
>     del self.threadCallQueue[:len(calls)]
> 
> Should be ok though, for the same reason my patch is (or at least I think it
> is :)
> 
> The main difference between that version and my is this one involves a small
> list copy, but it might still be faster than executing "count += 1" on every
> loop iteration.  Either way, it's at the point where I don't care :)
> 

  I think I like your version more now.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031119/f625e059/attachment.pgp 

From michal at pasternak.w.lub.pl  Wed Nov 19 22:20:41 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Thu, 20 Nov 2003 04:20:41 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
Message-ID: <20031120032041.GA11694@pasternak.w.lub.pl>

Hi,

I have a webpage, that is rendered via twisted.web.woven.page.Page class.

In one of it's wvfactory_ methods, I need to send an e-mail. I would also
like to check if sending of the e-mail was successful (eg. mailserver is
up, running, and reachable via network).

I thought about something like this:

  def wvfactory_render(self, req, node, model):
      # do some stuff 
      sendEMail().addCallbacks(self.emailOkay, self.emailFailure)
      return # what should I return here?
      
  def emailOkay(self, *args):
      # render "thank you, e-mail sent" message 
      
  def emailFailure(self, *args):
      # render "error" message
      
My questions:
   1) is it a good, Twisted Python way to do this? If not,
      a) what would be the correct one? 
      b) can you point me to some docs?
   2) if it is a good way:
      a) is it implemented? if yes:
      	 1) what should I return from wvfactory_render? 
	 2) what parameters would be passed to callbacks then?
      b) if not, do you think it would be worth implementing?
      
I have seen something similar like the thing I want to code in some example
sources:

       def render(...):
       	   [ launch some callbacks ] 
	   return server.NOT_DONE_YET
  
... but they were about Resource class, and I'm using Page here.

Anyone?

Regards,
-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From anthony at interlink.com.au  Wed Nov 19 22:26:32 2003
From: anthony at interlink.com.au (Anthony Baxter)
Date: Thu, 20 Nov 2003 14:26:32 +1100
Subject: [Twisted-Python] looking for twisted Tkinter documentation 
In-Reply-To: <20031119141751.42151956.itamar@itamarst.org> 
Message-ID: <200311200326.hAK3QYVl027299@localhost.localdomain>

>>> Itamar Shtull-Trauring wrote
> On Wed, 19 Nov 2003 11:03:21 -0800
> "John Benson" <jsbenson at bensonsystems.com> wrote:
> 
> > I also had a look at the examples index in
> > http://twistedmatrix.com/documents/examples/#auto8 and found links to
> > uses of qt, wx, gtk2 and curses, but nothing about Tkinter.
> 
> http://sourceforge.net/projects/originalgamer is a twisted program that
> uses Tk.

Shtoom (http://sf.net/projects/shtoom) also has a Tk UI (as well as a Qt
one and an MFC one).

Anthony
-- 
Anthony Baxter     <anthony at interlink.com.au>   
It's never too late to have a happy childhood.




From slyphon at twistedmatrix.com  Thu Nov 20 01:38:06 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Thu, 20 Nov 2003 01:38:06 -0500
Subject: [Twisted-Python] home for ftp goodies?
Message-ID: <3FBC614E.6030800@twistedmatrix.com>

I was talking with jp and itamar about the ftp extras. I've implemented 
an anonymous avatar, a realm, and have begun working on a method or two 
for filepath permissions checking. I wanted some opinions on how we can 
separate these extra 'goodies' from the protocol implementation itself.

any thoughts?




From lafou at wanadoo.fr  Thu Nov 20 05:04:31 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Thu, 20 Nov 2003 11:04:31 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <20031120032041.GA11694@pasternak.w.lub.pl>
References: <20031120032041.GA11694@pasternak.w.lub.pl>
Message-ID: <200311201104.32146.lafou@wanadoo.fr>

Same problem here, and I didn't find a solution. This should to the woven faq 
I think.

On Thursday 20 November 2003 04:20, Michal Pasternak wrote:
> Hi,
>
> I have a webpage, that is rendered via twisted.web.woven.page.Page class.
>
> In one of it's wvfactory_ methods, I need to send an e-mail. I would also
> like to check if sending of the e-mail was successful (eg. mailserver is
> up, running, and reachable via network).
>
> I thought about something like this:
>
>   def wvfactory_render(self, req, node, model):
>       # do some stuff
>       sendEMail().addCallbacks(self.emailOkay, self.emailFailure)
>       return # what should I return here?
>
>   def emailOkay(self, *args):
>       # render "thank you, e-mail sent" message
>
>   def emailFailure(self, *args):
>       # render "error" message
>
> My questions:
>    1) is it a good, Twisted Python way to do this? If not,
>       a) what would be the correct one?
>       b) can you point me to some docs?
>    2) if it is a good way:
>       a) is it implemented? if yes:
>       	 1) what should I return from wvfactory_render?
> 	 2) what parameters would be passed to callbacks then?
>       b) if not, do you think it would be worth implementing?
>
> I have seen something similar like the thing I want to code in some example
> sources:
>
>        def render(...):
>        	   [ launch some callbacks ]
> 	   return server.NOT_DONE_YET
>
> ... but they were about Resource class, and I'm using Page here.
>
> Anyone?
>
> Regards,




From oisin at enginesofcreation.ie  Thu Nov 20 05:22:32 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Thu, 20 Nov 2003 10:22:32 +0000
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <20031008020028.GA8353@frobozz>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031008020028.GA8353@frobozz>
Message-ID: <3FBC95E8.9000205@enginesofcreation.ie>

Andrew Bennetts wrote:

>On Fri, Oct 03, 2003 at 11:18:28AM +0100, Oisin Mulvihill wrote:
>  
>
>>Why are there two deferred objects returned by storeFile? The documentation
>>says:
>>    
>>
>
>Try looking at twisted/test/test_ftp.py, line 251 (the testStor method of
>FTPClientAndServerTests).  Hopefully that should help fill in the blanks.
>
>-Andrew.
>
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>  
>
Hi,

I know its been a while, but the project I needed this for has
gone on the back burner. I was going to do an example for
how I got the file to send and then do a recieve. I haven't got
around to it. So for posterity and for anyone else who hits the
same problem here is the modified ftp example that shows
how I uploaded a file using twisted. The answer was in the unit
tests I'd just forgotten twisted had them.

All the best,

om


-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031120/325009ad/attachment.htm 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftpclient.py
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031120/325009ad/attachment.txt 

From Alan.Rushforth at student.shu.ac.uk  Thu Nov 20 05:48:10 2003
From: Alan.Rushforth at student.shu.ac.uk (Alan Rushforth)
Date: Thu, 20 Nov 2003 10:48:10 +0000
Subject: [Twisted-Python] Unable to get the UDP multicasting examples to work
Message-ID: <fc.005b8dcc029335ea005b8dcc029335ea.29336b9@samson.shu.ac.uk>

Hi,

This may well be a very trivial question but i have been trying to get the UDP
multicasting example in the "how to" section of the twisted documentation to
work and have had no success. I can do TCP message and normal UDP but cant
multicast it.

It does not report any errors but nothing every seems to be received by the
echo server.
Don't I need to explicitly join the multicast group at any point?

The code i have been using is as follows:
The multicast client:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
class Client(DatagramProtocol): 
	def datagramReceived(self, data, host):
	 	print 'Response Recieved:', data.strip()
		print 'From Host:', host
reactor.listenUDP(0, Client()).write('broadcast\n', ('224.0.0.1', 9999))
reactor.run() 

The original Echo server:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
class Echo(DatagramProtocol):
	def datagramReceived(self, data, (host, port)):
		print "received %r from %s:%d" % (data, host, port)
		self.transport.write(data, (host, port))
reactor.listenUDP(9999, Echo())
reactor.run() 

Thanks for any help,
Alan.




From michal at pasternak.w.lub.pl  Thu Nov 20 06:25:16 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Thu, 20 Nov 2003 12:25:16 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <200311201104.32146.lafou@wanadoo.fr>
References: <20031120032041.GA11694@pasternak.w.lub.pl> <200311201104.32146.lafou@wanadoo.fr>
Message-ID: <20031120112516.GB9102@pasternak.w.lub.pl>

Philippe Lafoucri?re [Thu, Nov 20, 2003 at 11:04:31AM +0100]:
> Same problem here, and I didn't find a solution. This should to the woven faq 
> I think.

As I am a very, very lazy man, I'd like to hear from at least one Twisted
developer, that it's currently impossible (or unwise to do that) before
trying to implement such functionality.

... and I wonder if it's different for nevow.

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From grib at billgribble.com  Thu Nov 20 08:14:33 2003
From: grib at billgribble.com (Bill Gribble)
Date: Thu, 20 Nov 2003 07:14:33 -0600
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <20031120112516.GB9102@pasternak.w.lub.pl>
References: <20031120032041.GA11694@pasternak.w.lub.pl>
	 <200311201104.32146.lafou@wanadoo.fr>
	 <20031120112516.GB9102@pasternak.w.lub.pl>
Message-ID: <1069334073.8284.4.camel@serrano>

On Thu, 2003-11-20 at 05:25, Michal Pasternak wrote:
> Philippe Lafoucri?re [Thu, Nov 20, 2003 at 11:04:31AM +0100]:
> > Same problem here, and I didn't find a solution. This should to the woven faq 
> > I think.
> 
> As I am a very, very lazy man, I'd like to hear from at least one Twisted
> developer, that it's currently impossible (or unwise to do that) before
> trying to implement such functionality.

Well, it's possible to do if you are willing to do some legwork
yourself.  If you override the render method of your Page, you can
manually handle waiting for the Deferred stuff to finish, because in a
Resource's render you can return NOT_DONE_YET and then call
request.finish() at a later time.  I've done that successfully. 

nevow handles all this stuff much more smoothly.  I wouldn't put a lot
of work into extending woven. 

b.g.
 




From lafou at wanadoo.fr  Thu Nov 20 08:30:29 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Thu, 20 Nov 2003 14:30:29 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <1069334073.8284.4.camel@serrano>
References: <20031120032041.GA11694@pasternak.w.lub.pl> <20031120112516.GB9102@pasternak.w.lub.pl> <1069334073.8284.4.camel@serrano>
Message-ID: <200311201430.29582.lafou@wanadoo.fr>

> Well, it's possible to do if you are willing to do some legwork
> yourself.  If you override the render method of your Page, you can
> manually handle waiting for the Deferred stuff to finish, because in a
> Resource's render you can return NOT_DONE_YET and then call
> request.finish() at a later time.  I've done that successfully.
>
> nevow handles all this stuff much more smoothly.  I wouldn't put a lot
> of work into extending woven.


When will nevow will be considered as stable enough ? I won't create an entire 
app using woven if it's going to be depracated in 1 month :(
Btw, could you send us a  concrete example of what you were talking about ?
thank you
--
Philippe




From 2s7l3way02 at sneakemail.com  Thu Nov 20 10:45:45 2003
From: 2s7l3way02 at sneakemail.com (Mark Evans)
Date: 20 Nov 2003 15:45:45 -0000
Subject: [Twisted-Python] Mixmaster Architecture
Message-ID: <12452-02919@sneakemail.com>


Here's an architecture question for Twisted Matrix gurus.
I need to implement a "mixmaster" scheme, as follows:

                           |--> Remote client A
        UDP            TCP |
Server <---> Mixmaster <---|--> Remote client B
                           |
                           |--> Remote client C
                           |
                           ... (etc.)

Here is the background data:

Server <---> mixmaster is a custom binary protocol
over UDP transport.

Mixmaster <---> clients is custom protocol(s)
over TCP transport.  The most important client type
uses Telnet (raw).

Server and mixmaster script live on the same PC.
Remote clients have individual IPs and MACs.

Server is closed-source Java; I cannot change it.
Server's UDP communications is stock Java from Sun.
Clients are different closed-source systems (not PCs).
Mixmaster script is my Python.  How to architect it?

The Mixmaster script needs to multiplex communications
between clients and server.  The server will think it's
talking to N clients, all of which know its peculiar
protocol.  It's OK for the server to believe they have
the same IP address 127.0.0.1.  There is other identifying
information in the server protocol to distinguish the
clients (including MACs and device name strings).

I have an idea how to proceed, but still would like to
hear your advice, and thank you for it.

Mark



From dp at twistedmatrix.com  Thu Nov 20 10:50:30 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Thu, 20 Nov 2003 10:50:30 -0500
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <20031120032041.GA11694@pasternak.w.lub.pl>
References: <20031120032041.GA11694@pasternak.w.lub.pl>
Message-ID: <44F1BA9E-1B71-11D8-8EF4-000A95864FC4@twistedmatrix.com>

On Nov 19, 2003, at 10:20 PM, Michal Pasternak wrote:

> Hi,
>
> I have a webpage, that is rendered via twisted.web.woven.page.Page 
> class.
>
> In one of it's wvfactory_ methods, I need to send an e-mail. I would 
> also
> like to check if sending of the e-mail was successful (eg. mailserver 
> is
> up, running, and reachable via network).
>
> I thought about something like this:

<snip>

Woven has some, ahem, object identity issues. It really, really wants 
you to return an actual View instance from a wvfactory_. However, it 
does support deferreds being returned from the Widget.generate method. 
A deferred callback should mutate the incoming template node in place 
in order to cause some changes to the final page:

class MyDeferredWidget(widgets.Widget):
	def generate(self, request, node):
		theDeferred = doSomeAction()
		def theCallback(result):
			node.appendChild(
				request.d.createTextNode("the result was: %s" % result)
			)
		theDeferred.addCallback(theCallback)
		return theDeferred


class MyPage(page.Page):
	template = """<html><span view="theDeferredThing" /></html>"""

	def wvfactory_theDeferredThing(self, request, node, model):
		return MyDeferredWidget(model)


This is completely untested, but it gives you an idea of what to do. 
One of the main reasons for embarking upon nevow was that I knew a lot 
more about Deferreds than when I wrote woven, and woven's architecture 
made it very difficult to support deferreds properly. In nevow, the 
code might look like:


class MyPage(renderer.Renderer):
	def render_doSomeAction(self, context, data):
		return doSomeAction().addCallback(
			lambda result: "The result was: %s" % result)

	document = html[
	span[
		render_doSomeAction
	]
]

The point is nevow was designed from the beginning to handle Deferreds 
more gracefully than woven was. Also, because the paradigm in nevow 
sticks far better to "the return value of a callable replaces whatever 
came in" than woven ended up doing, it's impossible to get into funny 
identity situations where you're mutating an object but you don't see 
the result of it in the final page, because you were mutating a copy 
and it was the wrong object.

dp




From itamar at itamarst.org  Thu Nov 20 11:26:44 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 20 Nov 2003 11:26:44 -0500
Subject: [Twisted-Python] Unable to get the UDP multicasting examples to
 work
In-Reply-To: <fc.005b8dcc029335ea005b8dcc029335ea.29336b9@samson.shu.ac.uk>
References: <fc.005b8dcc029335ea005b8dcc029335ea.29336b9@samson.shu.ac.uk>
Message-ID: <20031120112644.230bbc9c.itamar@itamarst.org>

On Thu, 20 Nov 2003 10:48:10 +0000
"Alan Rushforth" <Alan.Rushforth at student.shu.ac.uk> wrote:

> multicasting example in the "how to" section of the twisted
> documentation to work and have had no success. I can do TCP message
> and normal UDP but cant multicast it.

Bleh. My bad (well, and Pahan's). You want to use listenMulticast,
really, and you need to join() a group. See twisted.internet.interfaces
- the multicast stuff, and twisted.test.test_udp. I will remove the
offending docs.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Thu Nov 20 12:20:57 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 20 Nov 2003 12:20:57 -0500
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <3FBC0AED.4000600@twistedmatrix.com>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2> <20031119234927.GK32299@frobozz> <20031120001913.GE20287@radii> <3FBC0AED.4000600@twistedmatrix.com>
Message-ID: <E74993AE-1B7D-11D8-AE63-000393C9700E@twistedmatrix.com>

On Nov 19, 2003, at 7:29 PM, Cory Dodt wrote:

> Is there a counter?  Do you tie knots in string? :-)

Notches on the wall of his cell, I think ;)




From twisted at zadka.site.co.il  Thu Nov 20 12:47:06 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 20 Nov 2003 17:47:06 -0000
Subject: [Twisted-Python] Mixmaster Architecture
In-Reply-To: <12452-02919@sneakemail.com>
References: <12452-02919@sneakemail.com>
Message-ID: <20031120174706.16859.qmail@green.zadka.com>

On 20 Nov 2003, "Mark Evans" <2s7l3way02 at sneakemail.com> wrote:

> Here's an architecture question for Twisted Matrix gurus.
> I need to implement a "mixmaster" scheme, as follows:
> 
>                            |--> Remote client A
>         UDP            TCP |
> Server <---> Mixmaster <---|--> Remote client B
>                            |
>                            |--> Remote client C
>                            |
>                            ... (etc.)
> 

No this is the wrong picture. Here's a right picture:

           |<--|              |--> Remote client A
        UDP|   |          TCP |
Server <---|<--|Mixmaster<----|--> Remote client B
           |   |              |
           |<--|              |--> Remote client C
           |   |              |
                             ... (etc.)

so you'll want something like

class MixmasterProtocol(protocol.Protocol) # the TCP side

    def connectionMade(self):
        self.udp = p = protocol.ConnectedDatagramProtocol()
        p.datagramReceived = self.datagramReceived
        self.server = reactor.connectUDP('127.0.0.1', PORT, p)

    def connectionLost(self):
        self.server.stopListening()

    def dataReceived(self, data):
        pass # handle data from TCP client, maybe use self.udp.transport.write

    def datagramReceived(self, data):
        pass # handle data from server, maybe use self.transport.write
 
> The most important client type uses Telnet (raw).

Make up your mind, telnet or raw? a Line-based protocol?



From vlupien at drummonddesigns.com  Thu Nov 20 16:06:18 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 20 Nov 2003 16:06:18 -0500
Subject: [Twisted-Python] wvfactory
Message-ID: <000001c3afaa$24c8b3e0$687ba8c0@vicky>

I have a form in a web page and I need to fill it with many sql queries
but only the first time the page is rendered.  
The other times, I want to fill it with the data from request.args.
 
I decided to build a dictionnary that looks like the dictionnary of
request.args to be able to use only one function to validate and fill my
form.
My function that fill my forms need to receive the dictionnary, the
document(node that I need to change) and a signature (signature is a
list of the name and the type of each elements from the form that need
to be fill).
 
In my template, I defined a wmfactory in the tag <form> that return my
dictionnary.  I?ve also define a wvfactory that call my function to fill
the form.
The problems is that wmfactory return a deferred so in wvfactory I have
to call my function to fill like this:  return
model.getData(request).addCallback(my function).  But I think that
return doesn?t wait that the addCallback is done.
 
Is there something I can do to make my returns wait for the addCallback
to return the new node filled with the dictionnary of data.
 
Here?s a part of my code:
 
#verify is the function that fill and verify my form
class handle:
    def __init__(self):
        pass
    
    def verify(self, dict, doc, signature):
        # dict is the dictionnary from the sql queries of the
request.args
        # doc is the node <form> and it?s child
        error = 0
        for item in signature:
            nodeList = domhelpers.locateNodes(doc, 'name', item[0])
            #INTEGER, FLOAT and STRING
            if item[1] == 'integer' or item[1] == 'float' or item[1] ==
'string':
                pass
            #CHECKBOX
            elif item[1] == 'checkbox':
                for node in nodeList:
                    # dict est None s'il n'est pas cochee
                    if dict.get(item[0]) != None and
str(node.getAttribute('value')) in dict.get(item[0]):
                        print 'checked'
                        node.setAttribute('checked', 'checked')
                        print node
                    else:
                        if item[2] == 'true':
                            error = 1
                            l = microdom.lmx(node)
                            l.span(style='color: red').text('donnees
obligatoires')
        return doc
 
# class that execute the queries needed
class SummaryEditDB:
    def __init__(self, dbpool):
        self.dbpool = dbpool
 
    def getSummary(self, plan_id):
        sql = "select * from plan where plan_id = '%s'" %plan_id
        return self.dbpool.runQueryDict(sql)
 
    def getCategoriesIdByPlanId(self, plan_id):
        sql = """select to_plan_category_id from plan_categories
                 where to_plan_id='%s' order by to_plan_category_id""" %
plan_id
        return self.dbpool.runQueryDict(sql)
 
 
class SummaryEditPage(pages.BasePage):
    templateFile = "summary_edit.html"
    
    def initialize(self, dbpool, *args):
        self.dbpool = dbpool
        self.db = SummaryEditDB(self.dbpool)
        self.signature = (('categories', 'checkbox', 'false', 'valeurs
non correctes'))
 
    def executeSQL(self, plan_id):
        def createSummaryDict(results, newDict):
            for item in results[0]:
                for elem in self.signature:
                    if item == elem[0]:
                        newDict[item] = results[0][item]
            return
self.db.getCategoriesIdByPlanId(plan_id).addCallback(createCategoriesDic
t, newDict)
 
        def createCategoriesDict(results, newDict):
            newDict['categories'] = []
            for item in results:
 
newDict['categories'].append(str(item.get('to_plan_category_id')))
            return newDict
 
        newDict = {}    
        return
self.db.getSummary(plan_id).addCallback(createSummaryDict, newDict)    #
first addCallback to fill the dictionnary
                 
 
    def setUp(self, request, *args):
            self.planData = self.executeSQL(plan_id) #this call the
function that return the dictionnary with the data (deferred)
   
    def wmfactory_planData(self, request):
        return self.planData          # Usually, when I return an SQL
queries, the model is not deferred but in this case, it is
    
    def wvfactory_fillFromSQL(self, request, node, model):
        def format(results):
            print results
            return handle().verify(results, node, self.signature) # the
function that fill the form (replace attributes in the node)
          
        return self.planData.addCallback(format)   # to be able to see
the results of self.planData, I need to use a addCallback to be able to
see the results
 
and to call the form filler.  But I seems that it doesn?t wait to the
addCallback to be done
        
    def wchild_update(self, request):
        return self
        
Here?s a part of my template file:
 
<form action="/summary/edit/update" method="post"
enctype="multipart/form-data" view="fillFromSQL" model="planData">
<table border="0" width="100%" cellspacing="1" cellpadding="2">
                        <tr>
                                    <td class="label" width="25%"
valign="top">
                                                &nbsp;Cat&eacute;gories 
                                    </td>
                                    <td class="area" width="75%">
                                                <input class="box"
type="checkbox" name="categories" value="1000001" />1 ?tage<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000002" />1/2 ?tages<br/> 
                                                <input class="box"
type="checkbox" name="categories" value="1000003" />2 ?tages<br/>
<input class="box" type="checkbox" name="categories" value="1000004"
/>Split-Level<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000005" />Chalet 4 saisons<br
/> 
                                                <input class="box"
type="checkbox" name="categories" value="1000006" />Bi-G?n?ration<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000007" />Semi-D?tach?<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000008" />Townhouse<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000009" />Duplex<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000010" />Triplex<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000011" />Appartement (4+)<br
/> 
                                    </td>
                        </tr>
            </table>
</form>
 
I really need help, so if someone wants to help me, it will be
appreciate.
Thx in advance
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031120/043719e1/attachment.htm 

From lafou at wanadoo.fr  Thu Nov 20 16:31:12 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Thu, 20 Nov 2003 22:31:12 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <44F1BA9E-1B71-11D8-8EF4-000A95864FC4@twistedmatrix.com>
References: <20031120032041.GA11694@pasternak.w.lub.pl> <44F1BA9E-1B71-11D8-8EF4-000A95864FC4@twistedmatrix.com>
Message-ID: <200311202231.12700.lafou@wanadoo.fr>

Is there a place to find some doc for nevow ? 

I can't find docs on divmod site :(




From maoy at cis.upenn.edu  Thu Nov 20 17:21:18 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 20 Nov 2003 17:21:18 -0500 (EST)
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <000001c3afaa$24c8b3e0$687ba8c0@vicky>
Message-ID: <Pine.LNX.4.44.0311201717340.12438-100000@klondike.cis.upenn.edu>

Check this out..

Yun
---------
from twisted.internet.protocol import Protocol, ClientFactory
from sys import stdout

class Echo(Protocol):

    def dataReceived(self, data):
        self.transport.loseConnection()

    def connectionLost(self):
        self.transport.startReading()

class EchoClientFactory(ClientFactory):

    def buildProtocol(self, addr):
        print 'Connected.'
        return Echo()

from twisted.internet import reactor
reactor.connectTCP('158.130.68.33', 22, EchoClientFactory())
reactor.run()






From radix at twistedmatrix.com  Thu Nov 20 17:29:25 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 20 Nov 2003 17:29:25 -0500
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <Pine.LNX.4.44.0311201717340.12438-100000@klondike.cis.upenn.edu>
References: <000001c3afaa$24c8b3e0$687ba8c0@vicky> <Pine.LNX.4.44.0311201717340.12438-100000@klondike.cis.upenn.edu>
Message-ID: <20031120222925.GG20287@radii>

On Thu, Nov 20, 2003 at 05:21:18PM -0500, Yun Mao wrote:
> Check this out..

I know a much easier way!

"while 1: pass"


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From 2s7l3way02 at sneakemail.com  Thu Nov 20 17:29:47 2003
From: 2s7l3way02 at sneakemail.com (Mark Evans)
Date: 20 Nov 2003 22:29:47 -0000
Subject: [Twisted-Python] Re: Mixmaster Architecture
Message-ID: <10349-59812@sneakemail.com>


Thank you Moshe Zadka.  What you're saying is that TCP
connections can trigger ephemeral UDP pseudo-connections.

The server communicates over just one UDP port, and data
flow is bidirectional at all points in the chain.  I'm not
sure whether these facts affect the suggestion here.
The mixmaster opens its own assigned UDP port to receive
data from the server, as well as sending data to the
server over another UDP port.

> Make up your mind, telnet or raw? a Line-based protocol?

You're right, I should.  Here is the scoop.  For manual
device tests I'm using PuTTY in its "raw" mode.  That is
the origin of "raw."  Basically the telnet sessions are
line-based command/response activity.  The devices don't
utilize the full telnet protocol, just a small subset.

The terms "client" and "server" may be mixed up, from a
networking standpoint.  These are just conventions in the
legacy software, right or wrong.  The original authors
called the Java app a server, and the devices clients. 
However the devices supply information that the Java app
requests of them.  So the actual roles are reversed.

Normally, when talking to devices that know its protocol,
the system is very simple.  Here's how it works without a
mixmaster script.  The server initiates communications. 
The server broadcats a public query packet, and devices
respond with their names and technical features.  The
server constructs a list of known devices.  From there, the
server invokes various device capabilities.  When finished,
the server shuts down the devices.

Why the mixmaster?  Many devices offer identical
capabilites, but don't know the server's protocol.  The
mixmaster allows the server to use them.

My apologies for confusing terminology and my thanks for
your answers.

Mark



From maoy at cis.upenn.edu  Thu Nov 20 17:36:26 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 20 Nov 2003 17:36:26 -0500 (EST)
Subject: [Twisted-Python] How to let twisted fall into a deadloop with
 100% CPU usage
In-Reply-To: <20031120222925.GG20287@radii>
Message-ID: <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>

This is different. I believe twisted is responsible for the error report.  
It actually did, but for some reason it made itself fall into a dead loop.
I would like to call this bug, and encountered this when I play with
producer, consumer, etc. ( resumeProducing() is startReading!) I wish 
someone could fix this. Thanks.

Yun

On Thu, 20 Nov 2003, Christopher Armstrong wrote:

> On Thu, Nov 20, 2003 at 05:21:18PM -0500, Yun Mao wrote:
> > Check this out..
> 
> I know a much easier way!
> 
> "while 1: pass"
> 
> 
> 




From radix at twistedmatrix.com  Thu Nov 20 18:01:03 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 20 Nov 2003 18:01:03 -0500
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>
References: <20031120222925.GG20287@radii> <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>
Message-ID: <20031120230103.GH20287@radii>

On Thu, Nov 20, 2003 at 05:36:26PM -0500, Yun Mao wrote:
> This is different. I believe twisted is responsible for the error report.  
> It actually did, but for some reason it made itself fall into a dead loop.
> I would like to call this bug, and encountered this when I play with
> producer, consumer, etc. ( resumeProducing() is startReading!) I wish 
> someone could fix this. Thanks.

You didn't make it clear that you actually considered this a
bug. Please post it to http://twistedmatrix.com/bugs/ -- and please
include the errors that happen, etc, and any suggestions for
fixes. Thanks.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From exarkun at intarweb.us  Thu Nov 20 18:17:27 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 20 Nov 2003 18:17:27 -0500
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>
References: <20031120222925.GG20287@radii> <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>
Message-ID: <20031120231727.GA24833@intarweb.us>

On Thu, Nov 20, 2003 at 05:36:26PM -0500, Yun Mao wrote:
> This is different. I believe twisted is responsible for the error report.  
> It actually did, but for some reason it made itself fall into a dead loop.
> I would like to call this bug, and encountered this when I play with
> producer, consumer, etc. ( resumeProducing() is startReading!) I wish 
> someone could fix this. Thanks.
> 

  startReading() is not a public API.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031120/679d9586/attachment.pgp 

From exarkun at intarweb.us  Thu Nov 20 18:20:26 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 20 Nov 2003 18:20:26 -0500
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <20031120231727.GA24833@intarweb.us>
References: <20031120222925.GG20287@radii> <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu> <20031120231727.GA24833@intarweb.us>
Message-ID: <20031120232026.GA24851@intarweb.us>

On Thu, Nov 20, 2003 at 06:17:27PM -0500, Jp Calderone wrote:
> On Thu, Nov 20, 2003 at 05:36:26PM -0500, Yun Mao wrote:
> > This is different. I believe twisted is responsible for the error report.  
> > It actually did, but for some reason it made itself fall into a dead loop.
> > I would like to call this bug, and encountered this when I play with
> > producer, consumer, etc. ( resumeProducing() is startReading!) I wish 
> > someone could fix this. Thanks.
> > 
> 
>   startReading() is not a public API.
> 

  Ahem.  I did not read very carefully. :)

>   Jp
> 


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031120/4c5ea969/attachment.pgp 

From jsbenson at bensonsystems.com  Thu Nov 20 20:34:19 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Thu, 20 Nov 2003 17:34:19 -0800
Subject: [Twisted-Python] reactor/transport/protocol relationship?
Message-ID: <022801c3afcf$980aedd0$a90a500a@jsbwxp3>

>From the http://www.itamarst.org/writings/OSCON03/twisted_internet-18.html
slide, I gather that objects in twisted connect as follows:

(internet cloud) <---> transport <---> reactor <---> protocol

In the http://www.itamarst.org/writings/OSCON03/twisted_internet-19.html
diagram however, there is a different connectivity. What am I missing here?





From jsbenson at bensonsystems.com  Thu Nov 20 20:56:39 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Thu, 20 Nov 2003 17:56:39 -0800
Subject: [Twisted-Python] problem installing twisted on Windows 2000 Professional
Message-ID: <022d01c3afd2$b5263980$a90a500a@jsbwxp3>

I'm running Python 2.3 on Windows 2000 version 5.00.2195 Service Pack 4 and
having trouble running the Twisted-1.1.0.win32-py2.3.exe installation.

I downloaded the .exe to a local folder, got to the Install button, clicked
on it and while the "Saving uninstall information" message was displayed but
before the progress bar showed any progress, I got a Setup message box
saying "CreateFile failed; code 5. Access is denied"

Can anyone tell me what code 5 means?

I've got 112 MB left on the C: drive, I hope that's not the problem.





From andrew-twisted at puzzling.org  Thu Nov 20 21:05:36 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 21 Nov 2003 13:05:36 +1100
Subject: [Twisted-Python] problem installing twisted on Windows 2000 Professional
In-Reply-To: <022d01c3afd2$b5263980$a90a500a@jsbwxp3>
References: <022d01c3afd2$b5263980$a90a500a@jsbwxp3>
Message-ID: <20031121020536.GA22725@frobozz>

On Thu, Nov 20, 2003 at 05:56:39PM -0800, John Benson wrote:
> I'm running Python 2.3 on Windows 2000 version 5.00.2195 Service Pack 4 and
> having trouble running the Twisted-1.1.0.win32-py2.3.exe installation.
> 
> I downloaded the .exe to a local folder, got to the Install button, clicked
> on it and while the "Saving uninstall information" message was displayed but
> before the progress bar showed any progress, I got a Setup message box
> saying "CreateFile failed; code 5. Access is denied"
> 
> Can anyone tell me what code 5 means?
> 
> I've got 112 MB left on the C: drive, I hope that's not the problem.

I don't have a Windows installation to play with anymore, so this is just a
guess...

Mysterious installation errors are often due to installing Twisted and/or
Python as a non-Adminstrator.   Perhaps that's the problem here?

-Andrew.




From itamar at itamarst.org  Thu Nov 20 21:50:26 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 20 Nov 2003 21:50:26 -0500
Subject: [Twisted-Python] reactor/transport/protocol relationship?
In-Reply-To: <022801c3afcf$980aedd0$a90a500a@jsbwxp3>
References: <022801c3afcf$980aedd0$a90a500a@jsbwxp3>
Message-ID: <20031120215026.346fb824.itamar@itamarst.org>

On Thu, 20 Nov 2003 17:34:19 -0800
"John Benson" <jsbenson at bensonsystems.com> wrote:

> From the
> http://www.itamarst.org/writings/OSCON03/twisted_internet-18.html
> slide, I gather that objects in twisted connect as follows:
> 
> (internet cloud) <---> transport <---> reactor <---> protocol

> In the
> http://www.itamarst.org/writings/OSCON03/twisted_internet-19.html
> diagram however, there is a different connectivity. What am I missing
> here?

Both of them are slightly unaccurate. I'll update my slides for the next
time I give the tutorial to be consistent.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From arslan at transporeon.com  Fri Nov 21 06:47:17 2003
From: arslan at transporeon.com (Ahmet Arslan)
Date: Fri, 21 Nov 2003 12:47:17 +0100
Subject: [Twisted-Python] FTP Server
Message-ID: <003401c3b025$372620b0$1600a8c0@sunrise>

Hi,

I'm new to twisted and searching for exampels to create an FTP Server
with
Twisted.

Any help apreciated.

Thx.
Ahmet




From slyphon at twistedmatrix.com  Fri Nov 21 15:51:12 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Fri, 21 Nov 2003 15:51:12 -0500
Subject: [Twisted-Python] FTP Server
In-Reply-To: <003401c3b025$372620b0$1600a8c0@sunrise>
References: <003401c3b025$372620b0$1600a8c0@sunrise>
Message-ID: <3FBE7AC0.6020106@twistedmatrix.com>

Ahmet Arslan wrote:
> Hi,
> 
> I'm new to twisted and searching for exampels to create an FTP Server
> with
> Twisted.
> 
> Any help apreciated.
> 
> Thx.
> Ahmet
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

Well, you may be in luck. I've just re-written the ftp protocol for 
twisted. if you want an example of how to set one up, you can look (in 
the cvs version of twisted) at sandbox/slyphon/ftpsrv.tac.

You'll need to make some local edits (such as what you want your 
root/tld to be) but you can get a feel for how it can be done.

please note, the ftp server implementation is *very* *new*.








From corydodt at twistedmatrix.com  Sat Nov 22 20:19:11 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Sat, 22 Nov 2003 17:19:11 -0800
Subject: [Twisted-Python] tap2ntsvc future
Message-ID: <3FC00B0F.10703@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I've finished the initial work on tap2ntsvc.  This script does the
tedious work of creating an installer around your Twisted service.  A
quick howto:

1. Create a tap or tac file for your application, using the method you
normally use.  **Test with twistd to make sure that you can start the
app from the command line, _before_ you wrap a service around it.**

2. Acquire and install the prerequisites of tap2ntsvc.  It depends on
software outside of Twisted, specifically:
win32all @ http://starship.python.net/crew/mhammond/win32/Downloads.html
Innoconda @ http://twistedmatrix.com/~moonfallen/innoconda.html

3. Run tap2ntsvc from the command line.  (*This is not yet integrated
with the "Twisted Command Prompt" available on MSWindows with the
official Twisted installer, but it will be when the script becomes an
official part of Twisted.) Use --help to get the command line options.
To start with, all you need to provide is the name of your tap or tac file.
| python .../Twisted/sandbox/moonfallen/tap2ntsvc myapp.tac
This will build an installable package using Innoconda.

4. Install the package.  It will be in myappsvc/myapp-...-setup.exe.

5. Start the service; it will fail, but you'll find out what modules you
need to add.
| net start myapp
**It's ok if this doesn't work.**

6. Check the Application event log to find out what modules failed to
import; you will be re-running py2exe after you add the missing modules.

7. Either: (a) re-run tap2ntsvc with the -i option or (b) add your
modules to myappsvc/setup.cfg on the "includes=" line.  If you choose to
do the latter, read myappsvc/README.txt to find out how to recompile
just the parts you need.

8. Redo steps 3 through 7 until you no longer get ImportErrors in the
Application log.

9. Some applications need data files.  If you need data files in your
application, consult myappsvc/README.txt and edit myappsvc/myapp.fms.
myapp.fms uses a special command language to make adding data files as
intuitive as possible.  You can put files in c:\Program Files\myapp or
any subdirectory thereof, so make sure your application code can find
data files there.

When you're done, you should be able to 'net start myapp' successfully.
~   When you want to rebuild it in the future, just keep these files in
your version control:
~  myappsvc/do_inno_script.py
~           do_inno.py
~           setup.cfg
~           setup.py
~           myapp.fms

Caveats, bugs, TODO:
- - you must be able to start your application in py2exe.  Things most
likely to not work are finding important data files based on the value
of __file__ in some module.
- - if you install the same service multiple times without uninstalling it
in between installs, then start it, then uninstall it, it will crash on
uninstall.  Just be sure to uninstall it in between installs while
you're experimenting.
- - I want to make the module finder more foolproof, saving several of the
steps above.  This is a non-trivial problem, however.
- - Really, it needs a frontend.  And I hate Tk.  Can I put a Gtk app into
~ Twisted proper? :-)


The future:
I want to move tap2ntsvc out of sandbox and into main Twisted.  I want
people to read this email over and try it before I do so, in case there
are important concerns I need to address.  We need to give some thought
to what to do about the 2 significant dependencies.  Should this block
tap2ntsvc from being in Twisted proper?  Is there a policy for this sort
of thing?

C
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows XP)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/wAsO3A5SrXAiHQcRAhrbAJ4yqGWtbEZcuClQ7f2R8dTsgPt6BACfUfH+
w0KVf7umWJW/jJ5S8w/TQak=
=B3a8
-----END PGP SIGNATURE-----



From uwe at oss4u.com  Sat Nov 22 20:22:25 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Sat, 22 Nov 2003 17:22:25 -0800
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <3FBB66C2.5000906@brainbot.com>
References: <3FBB5B27.5030809@brainbot.com> <200311191335.23097.lafou@wanadoo.fr> <3FBB66C2.5000906@brainbot.com>
Message-ID: <200311221722.25738.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


The wxsupport is broken, no matter which platform. That's why I invented the 
timer thing on ASPN. Wxsupport will fail the moment you open a modal dialog 
(or use a pulldown menu, which also is a modal). Probably there will never be 
a real reactor, well - unless someone with a lot of knowledge of both twisted 
and wxpython writes one. The problem is that wx - being platform independent 
uses the native event-loop, which behaves differently on windows, gtk or 
whatever. So a reactor would have to take care of that. The timer recipe 
works nicely though.

UC


On Wednesday 19 November 2003 04:49 am, Thorsten Henninger wrote:
> >Where did you see that wxPython is not supported for windows ? it works
> >perfect with windows ! Btw, you can find on this mailing list some
> > examples about using twisted in wx apps.
>
> this is what happens, if you run the wxdemo on windows 2000:
> C:\Dokumente und Einstellungen\henni\Desktop>wxdemo.py
> D:\Python23\lib\fcntl.py:7: DeprecationWarning: the FCNTL module is
> deprecated; please use fcntl
>   DeprecationWarning)
> D:\Python23\lib\site-packages\twisted\internet\wxsupport.py:69:
> UserWarning: Be advised wxsupport is not fully functional on Windows.
>   warnings.warn("Be advised wxsupport is not fully functional on Windows.")
> Traceback (most recent call last):
>   File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line
> 65, in ?
>     demo()
>   File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line
> 61, in demo
>     reactor.run()
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 121, in run
>     self.startRunning(installSignalHandlers=installSignalHandlers)
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 115, in startRunning
>     self._handleSignals()
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 87, in _handleSignals
>     signal.signal(signal.SIGINT, self.sigInt)
> SystemError: error return without exception set
> 13:45:14: Debug: c:\PROJECTS\wx\src\msw\app.cpp(439):
> 'UnregisterClass(canvas)' failed with error 0x00000584 (diese Klasse hat
> noch ge?ffnete Fenster.).
>
> Of course, simulating the reactor via a wxTimer (as seen on ASPN) does
> work, but the latest twisted says, wxsupport is not fully supported on
> Windows.
>
> regards,
>
> Thorsten

- -- 
	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/wAvRjqGXBvRToM4RAnHAAJ4j1l1IhMVoZEF9CVrabf7QDaX5RQCfX7rB
1MZg9UNdRIARS3skbevb3tw=
=Y5Ca
-----END PGP SIGNATURE-----




From maoy at cis.upenn.edu  Sun Nov 23 16:42:07 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Sun, 23 Nov 2003 16:42:07 -0500 (EST)
Subject: [Twisted-Python] Application help
In-Reply-To: <200311221722.25738.uwe@oss4u.com>
Message-ID: <Pine.LNX.4.44.0311231639520.17466-100000@klondike.cis.upenn.edu>

What is the difference between

twisted.internet.app.Application
and
twisted.application.service.Application?

Thanks a lot.

Yun






From itamar at itamarst.org  Sun Nov 23 19:03:25 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 23 Nov 2003 19:03:25 -0500
Subject: [Twisted-Python] Application help
In-Reply-To: <Pine.LNX.4.44.0311231639520.17466-100000@klondike.cis.upenn.edu>
References: <200311221722.25738.uwe@oss4u.com>
	<Pine.LNX.4.44.0311231639520.17466-100000@klondike.cis.upenn.edu>
Message-ID: <20031123190325.42476266.itamar@itamarst.org>

On Sun, 23 Nov 2003 16:42:07 -0500 (EST)
Yun Mao <maoy at cis.upenn.edu> wrote:

> What is the difference between
> 
> twisted.internet.app.Application

This is old and deprecated. Don't use it. Use the other (i.e. what the
1.1 documentation covers.)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From rdrb at 123.cl  Sun Nov 23 21:29:45 2003
From: rdrb at 123.cl (RITA Y/O RODRIGO DIAZ Y/O BENENSON)
Date: Sun, 23 Nov 2003 23:29:45 -0300
Subject: [Twisted-Python] Unit test
Message-ID: <177600174ecd.174ecd177600@noborrar.co.cl>

Short question,
which is the adecuate way of doing unit test of a sequence of defered events ? one chained to the other.

If each deferred need a callback method, I have already more that thirty functiones defined, and each time I need more.

How to do it ?

defered = something

<the magic>

defered = the_next_thing # that need the previous defered to have been acomplished

etc...

I can imagine various tricks, but I supose there is a standart way. 

Thanks.
RodrigoB.




From exarkun at intarweb.us  Sun Nov 23 21:49:38 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 23 Nov 2003 21:49:38 -0500
Subject: [Twisted-Python] Unit test
In-Reply-To: <177600174ecd.174ecd177600@noborrar.co.cl>
References: <177600174ecd.174ecd177600@noborrar.co.cl>
Message-ID: <20031124024938.GA6291@intarweb.us>

On Sun, Nov 23, 2003 at 11:29:45PM -0300, RITA Y/O RODRIGO DIAZ Y/O BENENSON wrote:
> Short question,
> which is the adecuate way of doing unit test of a sequence of defered
> events ? one chained to the other.
> 
> If each deferred need a callback method, I have already more that thirty
> functiones defined, and each time I need more.
> 
> How to do it ?
> 
> defered = something
> 
> <the magic>
> 
> defered = the_next_thing # that need the previous defered to have been acomplished
> 
> etc...
> 
> I can imagine various tricks, but I supose there is a standart way. 

    from twisted.trial import unittest

    result = unittest.deferredResult(theDeferred)

  "deferredResult" iterates the reactor until the given deferred has a
result, then returns that result.

  See its sibling, deferredError, for testing of failure conditions.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031123/669d7d12/attachment.pgp 

From cce at clarkevans.com  Mon Nov 24 03:52:13 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Mon, 24 Nov 2003 03:52:13 -0500
Subject: [Twisted-Python] web/client.py add parameter to get raw redirects
Message-ID: <20031124085213.GA46767@clarkevans.com>

Hello.  I'm working on some testing harness for my application
(in twisted, of course) and I found I needed to record when 
the app is expected to send back a redirect.  So, this needed
a few changes in client.py ; if this seems resonable, I can
commit it.  - Clark

...

--- client.py.bc	Sun Nov 23 23:45:10 2003
+++ client.py	Mon Nov 24 03:46:55 2003
@@ -28,10 +28,19 @@
 from twisted.web import error
 import urlparse, os, types
 
+from twisted.internet.error import ConnectionDone
+class PageRedirect(ConnectionDone):
+    """A request resulted in a redirect (followRedirect = 0) """
+    def __init__(self, status, location):
+        Exception.__init__(self, 
+          "%s redirection to: %s" % (status, location))
+        self.status = status
+        self.location = location
+
 class HTTPPageGetter(http.HTTPClient):
 
     quietLoss = 0
-    
+    followRedirect = 1 
     failed = 0
 
     def connectionMade(self):
@@ -79,6 +88,10 @@
         if not l:
             self.handleStatusDefault()
         url = l[0]
+        if not self.followRedirect:
+            self.handleStatusDefault()
+            self.factory.noPage(PageRedirect(self.status,url))
+            return
         scheme, host, port, path = _parse(url, defaultPort=self.transport.addr[1])
         self.factory.setURL(url)
 
@@ -173,7 +186,9 @@
     path = None
 
     def __init__(self, url, method='GET', postdata=None, headers=None,
-                 agent="Twisted PageGetter", timeout=0, cookies=None):
+                 agent="Twisted PageGetter", timeout=0, cookies=None,
+                 followRedirect=1):
+        self.protocol.followRedirect = followRedirect
         self.timeout = timeout
         self.agent = agent
 



From syver at inout.no  Mon Nov 24 03:56:17 2003
From: syver at inout.no (Syver Enstad)
Date: 24 Nov 2003 09:56:17 +0100
Subject: [Twisted-Python] Unit test
In-Reply-To: <20031124024938.GA6291@intarweb.us>
References: <177600174ecd.174ecd177600@noborrar.co.cl>
	<20031124024938.GA6291@intarweb.us>
Message-ID: <uy8u6uoum.fsf@inout.no>

Jp Calderone <exarkun at intarweb.us> writes:

>     from twisted.trial import unittest
> 
>     result = unittest.deferredResult(theDeferred)
> 
>   "deferredResult" iterates the reactor until the given deferred has a
> result, then returns that result.
> 
>   See its sibling, deferredError, for testing of failure conditions.

A little comment on unittest and the use of deferredResult. If you use
the optional timeout argument to deferredResult you have to be sure
that theDeferred's callback method has not been called before passing
it to deferredResult or you will get an error about pending calls when
twisted.trial cleans up after your test is run.





From justinjohnson at fastmail.fm  Mon Nov 24 10:23:25 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Mon, 24 Nov 2003 07:23:25 -0800
Subject: [Twisted-Python] Woven problems after upgrading to 1.1.1rc1
Message-ID: <20031124152325.9436B428FC@server1.messagingengine.com>

After upgrading to 1.1.1rc1, when I startup my tap which starts up a web
server and a flash conduit server for LivePage, as soon as I try to
access the page with my browser, I get a never ending stream of log
entries as seen below.

I've attached 2 files, tap.py and pages.py, which contain most of the
code involved.

Let me know if anything else is needed.


2003/11/24 09:18 CST [-] Log opened.
2003/11/24 09:18 CST [-] twistd 1.1.1rc1 (/usr/local/bin/python 2.3.0)
starting up
2003/11/24 09:18 CST [-] reactor class:
twisted.internet.default.SelectReactor
2003/11/24 09:18 CST [-] Loading ratcontrol.tap...
2003/11/24 09:18 CST [-] Loaded.
2003/11/24 09:18 CST [-] twisted.web.server.Site starting on 8888
2003/11/24 09:18 CST [-] Starting factory <twisted.web.server.Site
instance at 0x4065aa8c>
2003/11/24 09:18 CST [-]
twisted.web.woven.flashconduit.FlashConduitFactory starting on 4321
2003/11/24 09:18 CST [-] Starting factory
<twisted.web.woven.flashconduit.FlashConduitFactory instance at
0x4086a2ec>
2003/11/24 09:18 CST [-] twisted.spread.pb.PBServerFactory starting on
8787
2003/11/24 09:18 CST [-] Starting factory
<twisted.spread.pb.PBServerFactory instance at 0x40866fec>
2003/11/24 09:18 CST [-] set uid/gid 503/504
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:19 +0000] "GET /?__session_just_started__=1 HTTP/1.1"
302 422 "http://host/" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] session given the
will to live for 60 more seconds
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:19 +0000] "GET
/session-init/?__session_just_started__=%5B%271%27%5D HTTP/1.1" 302 516
"http://host/" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:19 +0000] "GET
/__session_key__c3726c12d656a8b7d9e478fea6d773a3/?__session_just_started__=%5B%22%5B%271%27%5D%22%5D
HTTP/1.1" 302 372 "http://host/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:19 +0000] "GET /?__session_just_started__=1 HTTP/1.1"
200 3642 "http://host/" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /WebConduit2_js HTTP/1.1" 302 348
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/?__session_just_started__=1" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /WebConduit2_js/ HTTP/1.1" 200 3642
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html HTTP/1.1" 302 340
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET
/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 352 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/ HTTP/1.1" 200 3642
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /FlashConduit_swf/ HTTP/1.1" 200 3642
"-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/WebConduit2_js HTTP/1.1"
302 370 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE
6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/WebConduit2_js/ HTTP/1.1"
200 3642 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE
6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/input_html HTTP/1.1" 302
362 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET
/input_html/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 374 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/input_html/ HTTP/1.1" 200
3642 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/input_html/input_html/" "Mozilla/4.0 (compatible; MSIE
6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/input_html/WebConduit2_js
HTTP/1.1" 302 392 "http://host:8888/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /input_html/FlashConduit_swf/ HTTP/1.1"
200 3642 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/input_html/input_html/" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /input_html/input_html/WebConduit2_js/
HTTP/1.1" 200 3642 "http://host:8888/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /input_html/input_html/input_html
HTTP/1.1" 302 384 "http://host:8888/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 396 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/FlashConduit_swf/ HTTP/1.1" 200 3642 "-"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /input_html/input_html/input_html/
HTTP/1.1" 200 3642 "http://host:8888/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/WebConduit2_js HTTP/1.1" 302 414
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/WebConduit2_js/ HTTP/1.1" 200 3642
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/input_html HTTP/1.1" 302 406
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 418 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/input_html/ HTTP/1.1" 200 3642
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/input_html/WebConduit2_js HTTP/1.1" 302
436 "http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/FlashConduit_swf/ HTTP/1.1" 200 3642
"-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:22 +0000] "GET
/input_html/input_html/input_html/input_html/WebConduit2_js/ HTTP/1.1"
200 3642 "http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:22 +0000] "GET
/input_html/input_html/input_html/input_html/input_html HTTP/1.1" 302 428
"http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:22 +0000] "GET
/input_html/input_html/input_html/input_html/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 440 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:22 +0000] "GET
/input_html/input_html/input_html/input_html/FlashConduit_swf/ HTTP/1.1"
200 3642 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tap.py
Type: application/unknown
Size: 3250 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031124/6bf393e3/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pages.py
Type: application/unknown
Size: 8657 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031124/6bf393e3/attachment-0001.bin 

From obowah at yahoo.com  Mon Nov 24 16:59:27 2003
From: obowah at yahoo.com (rddda)
Date: Mon, 24 Nov 2003 13:59:27 -0800 (PST)
Subject: [Twisted-Python] trouble building Quotient
Message-ID: <20031124215927.81933.qmail@web10704.mail.yahoo.com>

trying to build Quotient-0.7.0 with Twisted-4.1.6 on OpenBSD with Berkeley DB (bsddb3-).
made change to atop/store.py to use bsddb3:
from bsddb3.db import *
 
i get this error:
...
    obj = self._loadItemByPath(ctxstore, *path)
  File "/usr/local/lib/python2.3/site-packages/atop/store.py", line 386, in _loadItemByPath
    raise KeyError(path)
KeyError: (0, 0)

this is the code at that point:
def _loadItemByPath(self, ctxstore, *path):
        """
        Retrieve an item given a sequence of integers.
        """
        stringKey = self._formatIDPath(path)
        print "str=%s"%stringKey;   #debugging...
        stringValue = self.db.get(stringKey, txn=context.get('txn'))
        if stringValue is None:
            raise KeyError(path)
   ...
 
so stringValue is 'None'.
stringKey is shown by the print to be: id00000000000000000000
 
any hints <where to look>/<what to try>?


---------------------------------
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031124/52ca7d6f/attachment.htm 

From michal at pasternak.w.lub.pl  Mon Nov 24 17:04:59 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Mon, 24 Nov 2003 23:04:59 +0100
Subject: [Twisted-Python] Contributing to Twisted
Message-ID: <20031124220459.GA9641@pasternak.w.lub.pl>

Hi,

I'd like to setup buildbot on my machine and help Twisted building and
testing packages - as my contribution to Twisted project. I can install it
on a 700 MHz / 256 RAM / NetBSD-stable machine.

Do you accept such submissions? Who should I contact about it?

Take care,
-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From itamar at itamarst.org  Mon Nov 24 17:32:41 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 24 Nov 2003 17:32:41 -0500
Subject: [Twisted-Python] Contributing to Twisted
In-Reply-To: <20031124220459.GA9641@pasternak.w.lub.pl>
References: <20031124220459.GA9641@pasternak.w.lub.pl>
Message-ID: <20031124173241.0b94a352.itamar@itamarst.org>

On Mon, 24 Nov 2003 23:04:59 +0100
Michal Pasternak <michal at pasternak.w.lub.pl> wrote:

> I'd like to setup buildbot on my machine and help Twisted building and
> testing packages - as my contribution to Twisted project. I can
> install it on a 700 MHz / 256 RAM / NetBSD-stable machine.
> 
> Do you accept such submissions? Who should I contact about it?

Yes indeed, thank you! Brian Warner should get in touch with you, as
he's on the list.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From jsbenson at bensonsystems.com  Mon Nov 24 17:36:42 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Mon, 24 Nov 2003 14:36:42 -0800
Subject: [Twisted-Python] Informal poll, and Resolution of earlier post Fw: help please: trouble installing twisted python on Windows 2000 Pro, but not Windows XP Pro
Message-ID: <007701c3b2db$6f1fe8d0$f00a500a@jsbwxp3>

Hi, I'm answering my own post for the benefit if future newbies:

I was having an awful time installing twisted on a W2K Professional machine.
In desperation, I uninstalled all the Python things (Python 2.3 and
Pythonwin), reinstalled Python 2.3, installed Twisted, and then Pythonwin
and all the installations seemed to go OK. Plus I rebooted in between the
installations because I didn't have a rubber chicken handy to wave over the
computer.

Not much of a technical note, but there it is.

Informal poll: How many of you out there have ever indulged a taste for
totemic decoration and/or fetishistic rituals in connection with debugging?

----- Original Message ----- 
From: John Benson
To: twisted python
Sent: Wednesday, November 12, 2003 7:57 PM
Subject: help please: trouble installing twisted python on Windows 2000 Pro,
but not Windows XP Pro


Hi, I just installed twisted python on my Windows XP laptop which has Python
2.3.2.

I went to install it on Windows 2000 Professional version 5.00.2195 Service
Pack 4 running Python 2.3 and got the following dialog box diagnostic:
"Setup: CreateFile failed; code 5. Access is denied." I've been able to
install piles of stuff on this system before, so I figure I have the
required administrative privileges. I logon to a Windows domain, and my ID
is in the Administrators group of the domain. There is a separate
Administrator logon local to the machine which I haven't used, and probably
can't get the password for, since this is a managed PC within the domain.

Here are my questions:

1) What does the "code 5" failure mean?

2) What am I doing wrong?

3) Can I just move the twisted site-package folders over from my XP system
Python 2.3 folder to the corresponding Windows 2000 Pro folder? I'm mostly
interested in just importing the twisted modules and prototyping; I can do
without the icons and start menu entries.





From michal at pasternak.w.lub.pl  Mon Nov 24 17:53:35 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Mon, 24 Nov 2003 23:53:35 +0100
Subject: [Twisted-Python] trouble building Quotient
In-Reply-To: <20031124215927.81933.qmail@web10704.mail.yahoo.com>
References: <20031124215927.81933.qmail@web10704.mail.yahoo.com>
Message-ID: <20031124225335.GA9933@pasternak.w.lub.pl>

rddda [Mon, Nov 24, 2003 at 01:59:27PM -0800]:
> trying to build Quotient-0.7.0 with Twisted-4.1.6 on OpenBSD with Berkeley DB (bsddb3-).
[...]
> any hints <where to look>/<what to try>?

Yes. Install a recent Quotient (0.8.2) and try again.

If you have any other problems with Python on *BSD systems, e-mail me
directly.

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From michal at pasternak.w.lub.pl  Mon Nov 24 19:32:31 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Tue, 25 Nov 2003 01:32:31 +0100
Subject: [Twisted-Python] Informal poll, and Resolution of earlier post Fw: help please: trouble installing twisted python on Windows 2000 Pro, but not Windows XP Pro
In-Reply-To: <007701c3b2db$6f1fe8d0$f00a500a@jsbwxp3>
References: <007701c3b2db$6f1fe8d0$f00a500a@jsbwxp3>
Message-ID: <20031125003231.GB13442@pasternak.w.lub.pl>

John Benson [Mon, Nov 24, 2003 at 02:36:42PM -0800]:
> I was having an awful time installing twisted on a W2K Professional machine.

On my W2K laptop Twisted works without installation problems, since 1.0.7,
then upgraded many times.

> Not much of a technical note, but there it is.

You just described "in case of problems, format & reinstall" procedure,
that's known to fix 99.99% problems with Windows machines :)

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From obowah at yahoo.com  Mon Nov 24 23:25:14 2003
From: obowah at yahoo.com (rddda)
Date: Mon, 24 Nov 2003 20:25:14 -0800 (PST)
Subject: [Twisted-Python] trouble building Quotient
In-Reply-To: <20031124225335.GA9933@pasternak.w.lub.pl>
Message-ID: <20031125042514.82010.qmail@web10707.mail.yahoo.com>

ok. i got Quotient-0.8.2 and installed.
on 'mktap quotient ...'
i get 'Unknown command: quotient'
i then removed current 'quotient' from python site-packages dir and re-installed.
same error.
mktap itself runs and 'mktap --help' works.
 
TIA for help.
 
bob ackerman

Michal Pasternak <michal at pasternak.w.lub.pl> wrote:

rddda [Mon, Nov 24, 2003 at 01:59:27PM -0800]:

Yes. Install a recent Quotient (0.8.2) and try again.

If you have any other problems with Python on *BSD systems, e-mail me
directly.



---------------------------------
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031124/2a91295b/attachment.htm 

From itamar at itamarst.org  Mon Nov 24 23:51:01 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 24 Nov 2003 23:51:01 -0500
Subject: [Twisted-Python] trouble building Quotient
In-Reply-To: <20031125042514.82010.qmail@web10707.mail.yahoo.com>
References: <20031124225335.GA9933@pasternak.w.lub.pl>
	<20031125042514.82010.qmail@web10707.mail.yahoo.com>
Message-ID: <20031124235101.2b4690f7.itamar@itamarst.org>

On Mon, 24 Nov 2003 20:25:14 -0800 (PST)
rddda <obowah at yahoo.com> wrote:

> ok. i got Quotient-0.8.2 and installed.
> on 'mktap quotient ...'
> i get 'Unknown command: quotient'
> i then removed current 'quotient' from python site-packages dir and
> re-installed. same error.
> mktap itself runs and 'mktap --help' works.

Make sure mktap is running with same version as python as quotient was
installed with (both should be the same python, and version 2.3).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From stuart.hungerford at anu.edu.au  Tue Nov 25 00:03:32 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Tue, 25 Nov 2003 16:03:32 +1100
Subject: [Twisted-Python] Why would getUser()/getPassword() return ""?
Message-ID: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>

Hi all,

Before I move onto learning about cred, guard and more
sophisticated authentication schemes, I'm trying to get a
simple example working with basic HTTP authentication.

I have a resource subclass who's render() method checks the
values of request.getUsername() and request.getPassword():


class request_create(twisted.web.resource.Resource):
     isLeaf = 1
     addSlash = 0

     def render(self, request):
         if (not request.getUser()) or (not request.getPassword()):
             request.setResponseCode(401, 'Authentication required')
             return twisted.web.error.ForbiddenResource().render(request)

         # do work and render HTML ...

The problem is that no matter what I try getUser() and getPassword()
both return the string "" and the web browser never prompts for a
username/password.

Is the above enough for the simplest possible HTTP authentication
approach in Twisted web or should I be setting HTTP headers before the
request.getUser()/request.getPassword() is performed?

Any advice much appreciated,





Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From jsbenson at bensonsystems.com  Tue Nov 25 00:28:49 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Mon, 24 Nov 2003 21:28:49 -0800
Subject: [Twisted-Python] how to use the twisted logging facility?
Message-ID: <005301c3b315$03170030$4a09500a@jsbwxp3>

I've looked at the log module documentation of twisted.python and more or
less guess that you can redirect the print statement to a log, and somehow
observe the stuff that is being logged in case you want to write it
somewhere else too. I was able to redirect the Python print statement to a
disk file, but am at a loss when it comes to properly configuring and
installing an observer. I want to observe the logging stream and throw it
out to a Tkinter text window.

Thanks in advance for any advice.





From itamar at itamarst.org  Tue Nov 25 01:00:35 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 25 Nov 2003 01:00:35 -0500
Subject: [Twisted-Python] Why would getUser()/getPassword() return ""?
In-Reply-To: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>
References: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>
Message-ID: <20031125010035.1bac193f.itamar@itamarst.org>

On Tue, 25 Nov 2003 16:03:32 +1100
Stuart Hungerford <stuart.hungerford at anu.edu.au> wrote:

> Before I move onto learning about cred, guard and more
> sophisticated authentication schemes, I'm trying to get a
> simple example working with basic HTTP authentication.

See http://twistedmatrix.com/users/roundup.twistd/twisted/issue393

But you should also read the appropriate RFC. You need to return an
Unauthorized status code (401) and appropriate header if you got no
credentials in order to request browser to send it on next request.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From radix at twistedmatrix.com  Tue Nov 25 01:14:19 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 25 Nov 2003 01:14:19 -0500
Subject: [Twisted-Python] trouble building Quotient
In-Reply-To: <20031124235101.2b4690f7.itamar@itamarst.org>
References: <20031124225335.GA9933@pasternak.w.lub.pl> <20031125042514.82010.qmail@web10707.mail.yahoo.com> <20031124235101.2b4690f7.itamar@itamarst.org>
Message-ID: <20031125061419.GA614@radii>

This is the mailing list for Twisted, not Quotient; The list for
discussion of Quotient and other Divmod technologies is here:

http://divmod.org/users/mailman.twistd/listinfo/divmod-dev


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From michal at pasternak.w.lub.pl  Tue Nov 25 01:15:19 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Tue, 25 Nov 2003 07:15:19 +0100
Subject: [Twisted-Python] Why would getUser()/getPassword() return ""?
In-Reply-To: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>
References: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>
Message-ID: <20031125061519.GB15436@pasternak.w.lub.pl>

Stuart Hungerford [Tue, Nov 25, 2003 at 04:03:32PM +1100]:
> Before I move onto learning about cred, guard and more
> sophisticated authentication schemes, I'm trying to get a
> simple example working with basic HTTP authentication.

Checkout Twisted CVS, then Twisted/sandbox/tv/simplyguarded/

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From syver at inout.no  Tue Nov 25 07:10:09 2003
From: syver at inout.no (Syver Enstad)
Date: 25 Nov 2003 13:10:09 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
Message-ID: <uznektzry.fsf@inout.no>

I have a serious problem with some woven applications where deferreds
and their results returned from wmfactory_ methods are not garbage
collected. They just stack up in gc.garbage. The python documentation
states that the contents of gc.garbage are objects that are part of a
cycle can't be collected because they have a __del__ method.

Any help on this issue would be really appreciated.





From andrew-twisted at puzzling.org  Tue Nov 25 08:13:38 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 26 Nov 2003 00:13:38 +1100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <uznektzry.fsf@inout.no>
References: <uznektzry.fsf@inout.no>
Message-ID: <20031125131338.GB6016@frobozz>

On Tue, Nov 25, 2003 at 01:10:09PM +0100, Syver Enstad wrote:
> 
> I have a serious problem with some woven applications where deferreds
> and their results returned from wmfactory_ methods are not garbage
> collected. They just stack up in gc.garbage. The python documentation
> states that the contents of gc.garbage are objects that are part of a
> cycle can't be collected because they have a __del__ method.
> 
> Any help on this issue would be really appreciated.

Deferreds have a __del__ method, used to log unhandled errors, which has
often proved to be a valuable debugging aid (people often forget to
.addErrback(log.err)).

Unfortunately, this means that Deferreds in reference cycles can't be
automatically garbage collected.  Can you boil this down to a minimal test
case?  This sounds like the probable cause of a memory leak some users have
reported with Twisted Web.

The trick will be to figure out what the reference cycle is, and breaking
it.  It may help to do:
    twisted.internet.defer.Deferred.debug = True
and then inspect the .creator attribute of the Deferreds the end up in
gc.garbage.  You could also try manually poking around with gc.get_referrers
on those Deferreds.

If we can find a good enough test case, we might be able to write a unit
test to trigger it and then check gc.garbage, so that we can include it in
the test suite and stop it from happening again.

I'm very keen to find out what's causing this -- let me know if there's
anything I can help with.

-Andrew.





From andrew at puzzling.org  Tue Nov 25 08:19:19 2003
From: andrew at puzzling.org (Andrew Bennetts)
Date: Wed, 26 Nov 2003 00:19:19 +1100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125131338.GB6016@frobozz>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
Message-ID: <20031125131919.GC6016@frobozz>

On Wed, Nov 26, 2003 at 12:13:38AM +1100, Andrew Bennetts wrote:
> 
> If we can find a good enough test case, we might be able to write a unit
> test to trigger it and then check gc.garbage, so that we can include it in
> the test suite and stop it from happening again.

Thinking about this further, I just wrote the following hack for trial:

bash-2.05b$ cvs diff -u twisted/scripts/trial.py
Index: twisted/scripts/trial.py
===================================================================
RCS file: /cvs/Twisted/twisted/scripts/trial.py,v
retrieving revision 1.51
diff -u -r1.51 trial.py
--- twisted/scripts/trial.py    17 Oct 2003 21:48:16 -0000      1.51
+++ twisted/scripts/trial.py    25 Nov 2003 13:17:02 -0000
@@ -328,6 +328,11 @@
                                suite.run, reporter, config['random'])
         else:
             suite.run(reporter, config['random'])
+    import gc
+    gc.collect()
+    if gc.garbage:
+        print "GARBAGE: %d objects" % len(gc.garbage)
+        print "GARBAGE: " + repr(gc.garbage)
     sys.exit(not reporter.allPassed())
 
 if __name__ == '__main__':


I've only just started playing with this, but none of the web or woven tests
show anything.  test_pb seems to leak a whole bunch of stuff, though...

-Andrew.




From andrew-twisted at puzzling.org  Tue Nov 25 08:33:52 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 26 Nov 2003 00:33:52 +1100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125131338.GB6016@frobozz>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
Message-ID: <20031125133352.GE6016@frobozz>

[list admins: I originally posted this from the wrong address.  Please delete
 the dupe from the moderation queue.]

On Wed, Nov 26, 2003 at 12:13:38AM +1100, Andrew Bennetts wrote:
> 
> If we can find a good enough test case, we might be able to write a unit
> test to trigger it and then check gc.garbage, so that we can include it in
> the test suite and stop it from happening again.

Thinking about this further, I just wrote the following hack for trial:

bash-2.05b$ cvs diff -u twisted/scripts/trial.py
Index: twisted/scripts/trial.py
===================================================================
RCS file: /cvs/Twisted/twisted/scripts/trial.py,v
retrieving revision 1.51
diff -u -r1.51 trial.py
--- twisted/scripts/trial.py    17 Oct 2003 21:48:16 -0000      1.51
+++ twisted/scripts/trial.py    25 Nov 2003 13:17:02 -0000
@@ -328,6 +328,11 @@
                                suite.run, reporter, config['random'])
         else:
             suite.run(reporter, config['random'])
+    import gc
+    gc.collect()
+    if gc.garbage:
+        print "GARBAGE: %d objects" % len(gc.garbage)
+        print "GARBAGE: " + repr(gc.garbage)
     sys.exit(not reporter.allPassed())

 if __name__ == '__main__':


I've only just started playing with this, but none of the web or woven tests
show anything.  test_pb seems to leak a whole bunch of stuff, though...

-Andrew.




From syver at inout.no  Tue Nov 25 08:34:28 2003
From: syver at inout.no (Syver Enstad)
Date: 25 Nov 2003 14:34:28 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <uznektzry.fsf@inout.no>
References: <uznektzry.fsf@inout.no>
Message-ID: <usmkctvvf.fsf@inout.no>

Syver Enstad <syver at inout.no> writes:

> I have a serious problem with some woven applications where deferreds
> and their results returned from wmfactory_ methods are not garbage
> collected. They just stack up in gc.garbage. The python documentation
> states that the contents of gc.garbage are objects that are part of a
> cycle can't be collected because they have a __del__ method.

It seems that it is only when the deferreds are instance variables in
the Page that they end up in gc.garbage. It might be related that an
empty Page class with a __del__ method also end up in gc.garbage.





From syver at inout.no  Tue Nov 25 08:56:26 2003
From: syver at inout.no (Syver Enstad)
Date: 25 Nov 2003 14:56:26 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125131919.GC6016@frobozz>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
	<20031125131919.GC6016@frobozz>
Message-ID: <uhe0stuut.fsf@inout.no>

Andrew Bennetts <andrew at puzzling.org> writes:

> On Wed, Nov 26, 2003 at 12:13:38AM +1100, Andrew Bennetts wrote:
> > 
> > If we can find a good enough test case, we might be able to write a unit
> > test to trigger it and then check gc.garbage, so that we can include it in
> > the test suite and stop it from happening again.
> 
> Thinking about this further, I just wrote the following hack for trial:
> 
> bash-2.05b$ cvs diff -u twisted/scripts/trial.py
> Index: twisted/scripts/trial.py
> ===================================================================
> RCS file: /cvs/Twisted/twisted/scripts/trial.py,v
> retrieving revision 1.51
> diff -u -r1.51 trial.py
> --- twisted/scripts/trial.py    17 Oct 2003 21:48:16 -0000      1.51
> +++ twisted/scripts/trial.py    25 Nov 2003 13:17:02 -0000
> @@ -328,6 +328,11 @@
>                                 suite.run, reporter, config['random'])
>          else:
>              suite.run(reporter, config['random'])
> +    import gc
> +    gc.collect()
> +    if gc.garbage:
> +        print "GARBAGE: %d objects" % len(gc.garbage)
> +        print "GARBAGE: " + repr(gc.garbage)
>      sys.exit(not reporter.allPassed())
>  
>  if __name__ == '__main__':
> 
> 
> I've only just started playing with this, but none of the web or woven tests
> show anything.  test_pb seems to leak a whole bunch of stuff, though...

The deferreds that are leaking are coming from pb (aReferenceable.callRemote).

I think that a minimal test case to show the problem would be: (I'll test this later, I have to go in five minutes time).

Pseudo code:
class Page:
   def initialize(self, ...):
       self._deferred = defer.succeed([1, 2, 3])

   def wmfactory_oneTwoThree(self, request):
       return self._deferred


My guess is that self._deferred will end up in gc.garbage.

I will test this later.






From exarkun at intarweb.us  Tue Nov 25 09:12:24 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 25 Nov 2003 09:12:24 -0500
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <uhe0stuut.fsf@inout.no>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz> <20031125131919.GC6016@frobozz> <uhe0stuut.fsf@inout.no>
Message-ID: <20031125141224.GA11518@intarweb.us>

On Tue, Nov 25, 2003 at 02:56:26PM +0100, Syver Enstad wrote:
> [snip]
> 
> The deferreds that are leaking are coming from pb (aReferenceable.callRemote).
> 
> I think that a minimal test case to show the problem would be: (I'll test this later, I have to go in five minutes time).
> 
> Pseudo code:
> class Page:
>    def initialize(self, ...):
>        self._deferred = defer.succeed([1, 2, 3])
> 
>    def wmfactory_oneTwoThree(self, request):
>        return self._deferred
> 

  Presumably at some later point you will have a line like
"self._deferred.callback(value)".  Immediately after this (actually, before
is preferable, how is left as an exercise for the reader), you should
"self._deferred = None".  The cycle will be broken and the garbage will be
collectable.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031125/6d63e847/attachment.pgp 

From cosoria at sentai.com  Tue Nov 25 10:54:05 2003
From: cosoria at sentai.com (Carlos A. Osoria)
Date: Tue, 25 Nov 2003 08:54:05 -0700
Subject: [Twisted-Python] New to Twisted trying to find telnet client sample code
In-Reply-To: <20031125141224.GA11518@intarweb.us>
Message-ID: <EBEJLPFDAPGBHHHKOENOGEBLCAAA.cosoria@sentai.com>

Hi there !!

I'm new to twisted, I jump into cuz it looks that is gonna make my work lot
lot easier, I have to write a telnet client code to connect to systems. I
have been looking for telnet client samples out there but no luck so far,
can anyone point me in the right direction ???  :))

Any help will be well appreciated.





From henni at brainbot.com  Tue Nov 25 11:18:27 2003
From: henni at brainbot.com (Thorsten Henninger)
Date: Tue, 25 Nov 2003 17:18:27 +0100
Subject: [Twisted-Python] Twisted Signal Handler and wxPython
Message-ID: <3FC380D3.2080202@brainbot.com>

Hi,

I had a problem using wxPython together with twisted.
The following code shows, that one has to start the reactor with the 
flag "installSignalHandlers=0", otherwise an SystemError occures.
How does this affect my Twsited-Application?

regards,

Thorsten

import traceback
from wxPython.wx import *
from twisted.internet import  reactor


class MyApp(wxApp):
    def OnInit(self):

        # Twisted Reactor Code
        print "reator start running"
        #reactor.startRunning(installSignalHandlers=0)
        #reactor.startRunning(installSignalHandlers=1)
        timerid = wxNewId()
        EVT_TIMER(self,timerid,self.OnTimer)
        self.timer=wxTimer(self,timerid)
        self.timer.Start(100,True)
        # End Twisted Code
    # Do whatever you need to do here
       
        return True

    def OnTimer(self,event):
        reactor.runUntilCurrent()
        reactor.doIteration(0)


def main():
    """
    """
   
    try:
        app = MyApp(0)
        print "CALLING MAIN LOOP"
        app.MainLoop()
        print "MAIN LOOP DONE"
    except SystemExit, err:
        print err
    except:
        exc_info = sys.exc_info()
        print "--------------------- CAUGHT EXCECPTION:", exc_info
        traceback.print_exc(file=sys.stdout)
       

if __name__ == "__main__":
    try:
        main()
    finally:
        print "MAIN THREAD HAS EXITED"


The following error occures on Windows 2000, Python 2.3.2 and wxPython 
2.4.2:

D:\Python23\lib\fcntl.py:7: DeprecationWarning: the FCNTL module is 
deprecated; please use fcntl
  DeprecationWarning)
reator start running
--------------------- CAUGHT EXCECPTION: (<class exceptions.SystemError 
at 0x007780F0>, <exceptions.SystemError instance at 0x011775D0>, 
<traceback object at 0x011775F8>)
Traceback (most recent call last):
  File "E:\bbot\nextbot\gui\wxpython\application.py", line 41, in main
    app = MyApp(0)
  File "D:\Python23\lib\site-packages\wxPython\wx.py", line 1945, in 
__init__
    _wxStart(self.OnInit)
  File "E:\bbot\nextbot\gui\wxpython\application.py", line 18, in OnInit
    reactor.startRunning(installSignalHandlers=1)
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
115, in startRunning
    self._handleSignals()
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
87, in _handleSignals
    signal.signal(signal.SIGINT, self.sigInt)
SystemError: error return without exception set

-- 
brainbot technologies AG 
boppstrasse . 64 . 55118 mainz . germany
fon +49 6131 211639-1 . fax +49 6131 211639-2
http://brainbot.com/  mailto:henni at brainbot.com





From itamar at itamarst.org  Tue Nov 25 11:42:50 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 25 Nov 2003 11:42:50 -0500
Subject: [Twisted-Python] Twisted Signal Handler and wxPython
In-Reply-To: <3FC380D3.2080202@brainbot.com>
References: <3FC380D3.2080202@brainbot.com>
Message-ID: <20031125114250.1257734f.itamar@itamarst.org>

On Tue, 25 Nov 2003 17:18:27 +0100
Thorsten Henninger <henni at brainbot.com> wrote:

> I had a problem using wxPython together with twisted.
> The following code shows, that one has to start the reactor with the 
> flag "installSignalHandlers=0", otherwise an SystemError occures.
> How does this affect my Twsited-Application?

C-c and friends won't work, that's it. And reactor.spawnProcess may have
issues. This is a bug in wxPython which may have been fixed in newer
versions (and didn't occur in older versions).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From henni at brainbot.com  Tue Nov 25 12:13:46 2003
From: henni at brainbot.com (Thorsten Henninger)
Date: Tue, 25 Nov 2003 18:13:46 +0100
Subject: [Twisted-Python] Twisted Signal Handler and wxPython
In-Reply-To: <20031125114250.1257734f.itamar@itamarst.org>
References: <3FC380D3.2080202@brainbot.com> <20031125114250.1257734f.itamar@itamarst.org>
Message-ID: <3FC38DCA.1010803@brainbot.com>

Hi all,

this bug in wxPython has been fixed since wxPython 2.4.2.4

thanks,

Thorsten


Itamar Shtull-Trauring wrote:

>On Tue, 25 Nov 2003 17:18:27 +0100
>Thorsten Henninger <henni at brainbot.com> wrote:
>
>  
>
>>I had a problem using wxPython together with twisted.
>>The following code shows, that one has to start the reactor with the 
>>flag "installSignalHandlers=0", otherwise an SystemError occures.
>>How does this affect my Twsited-Application?
>>    
>>
>
>C-c and friends won't work, that's it. And reactor.spawnProcess may have
>issues. This is a bug in wxPython which may have been fixed in newer
>versions (and didn't occur in older versions).
>
>  
>


-- 
brainbot technologies AG 
boppstrasse . 64 . 55118 mainz . germany
fon +49 6131 211639-1 . fax +49 6131 211639-2
http://brainbot.com/  mailto:henni at brainbot.com





From syver-en at online.no  Tue Nov 25 15:28:08 2003
From: syver-en at online.no (Syver Enstad)
Date: 25 Nov 2003 21:28:08 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125141224.GA11518@intarweb.us>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
	<20031125131919.GC6016@frobozz> <uhe0stuut.fsf@inout.no>
	<20031125141224.GA11518@intarweb.us>
Message-ID: <ullq4tcpz.fsf@online.no>

Jp Calderone <exarkun at intarweb.us> writes:

>   Presumably at some later point you will have a line like
> "self._deferred.callback(value)".  

No I just return the deferred to woven (with defer.succeed the
callback is already called). 

> Immediately after this (actually, before is preferable, how is left
> as an exercise for the reader), you should "self._deferred = None".
> The cycle will be broken and the garbage will be collectable.

I think I'll have to override Page.pageRenderComplete and set it to
None there.


-- 

Syver Enstad




From syver-en at online.no  Tue Nov 25 15:52:43 2003
From: syver-en at online.no (Syver Enstad)
Date: 25 Nov 2003 21:52:43 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125141224.GA11518@intarweb.us>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
	<20031125131919.GC6016@frobozz> <uhe0stuut.fsf@inout.no>
	<20031125141224.GA11518@intarweb.us>
Message-ID: <uu14srx0k.fsf@online.no>

Jp Calderone <exarkun at intarweb.us> writes:

> On Tue, Nov 25, 2003 at 02:56:26PM +0100, Syver Enstad wrote:
> > Pseudo code:
> > class Page:
> >    def initialize(self, ...):
> >        self._deferred = defer.succeed([1, 2, 3])
> > 
> >    def wmfactory_oneTwoThree(self, request):
> >        return self._deferred
> > 
> 

Hi Jp. It seems that changing the wmfactory_method to do:

        def wmfactory_oneTwoThree(self, request):
            deferred = defer.Deferred()
            self._deferred.chainDeferred(deferred)
            return deferred

Does the trick.


>   Presumably at some later point you will have a line like
> "self._deferred.callback(value)".  Immediately after this (actually,
> before
> 
> is preferable, how is left as an exercise for the reader), you
> should "self._deferred = None".  The cycle will be broken and the
> garbage will be collectable.

-- 

Syver Enstad




From jjanecek at telusplanet.net  Tue Nov 25 22:04:00 2003
From: jjanecek at telusplanet.net (jjanecek at telusplanet.net)
Date: Tue, 25 Nov 2003 19:04:00 -0800
Subject: [Twisted-Python] Possible bug in from twisted.internet.app import Application ?
Message-ID: <1069815840.3fc4182061cb1@webmail.telus.net>

I am running freebsd with python 2.2.2 and twisted 1.10

the same code worked fine on another server which is identical
except it is running twisted 1.07 

anyways

from twisted.internet.app import Application
from pyRtpRelay import TRelayService

print "Relay Going Up"
application = Application('pyRtpRelay')
RelayService=TRelayService(application)
RelayService.Start()

Inside my object TRelayService when I call

application.ListenUDP(XXXXXXXX) it will not listen on the required UDP ports and
returns None.

As a temporary hack I then when
       from twisted.internet import reactor
       reactor.ListenUDP(XXXXXX)

and it worked fine

Thanx John







From itamar at itamarst.org  Tue Nov 25 22:44:41 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 25 Nov 2003 22:44:41 -0500
Subject: [Twisted-Python] Possible bug in from twisted.internet.app
 import Application ?
In-Reply-To: <1069815840.3fc4182061cb1@webmail.telus.net>
References: <1069815840.3fc4182061cb1@webmail.telus.net>
Message-ID: <20031125224441.076adc27.itamar@itamarst.org>

On Tue, 25 Nov 2003 19:04:00 -0800
jjanecek at telusplanet.net wrote:

> I am running freebsd with python 2.2.2 and twisted 1.10

> application.ListenUDP(XXXXXXXX) it will not listen on the required UDP
> ports and returns None.

This is for a reason, too complicated to get into (in 1.0.7 it would
sometimes return None as well, in some cases). You should upgrade your
code to use twisted.application instead of twisted.internet.app, which
is deprecated.

Also, sounds like you want to be doing reactor.listenUDP.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From slyphon at twistedmatrix.com  Wed Nov 26 03:10:11 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Wed, 26 Nov 2003 03:10:11 -0500
Subject: [Twisted-Python] protocol factory interfaces?? (FTP)
Message-ID: <1069834211.24112.3.camel@willie-the-pimp.embassynetworks.com>

Is it possible (or even useful) to have a protocol which expects the
factory which builds it to have a specific interface? (as the protocol
has a .factory attribute and therefore can access methods and attributes
on it's factory)

or must all twisted.protocols be able to work with
internet.protocol.Factory() off-the-shelf?






From radix at twistedmatrix.com  Wed Nov 26 03:59:02 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 26 Nov 2003 03:59:02 -0500
Subject: [Twisted-Python] protocol factory interfaces?? (FTP)
In-Reply-To: <1069834211.24112.3.camel@willie-the-pimp.embassynetworks.com>
References: <1069834211.24112.3.camel@willie-the-pimp.embassynetworks.com>
Message-ID: <20031126085902.GC2548@radii>

On Wed, Nov 26, 2003 at 03:10:11AM -0500, Jonathan Simms wrote:
> Is it possible (or even useful) to have a protocol which expects the
> factory which builds it to have a specific interface? (as the protocol
> has a .factory attribute and therefore can access methods and attributes
> on it's factory)
> 
> or must all twisted.protocols be able to work with
> internet.protocol.Factory() off-the-shelf?

Nope, it's perfectly fine to have a factory tightly bound to the
protocol. The reason that they're separate objects isn't for
separation of knowledge, but for having a 1-N relationship (N protocol
instances (i.e., connections) per factory).

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From phil at bubblehouse.org  Wed Nov 26 14:49:46 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 26 Nov 2003 14:49:46 -0500 (EST)
Subject: [Twisted-Python] plugin vs. dropin
Message-ID: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>

i was going through the docs, and i found the two classes in
twisted/python/plugin.py, and i was wondering what the difference is
between the two.

i'd like to be able to make a sort of plugin that when the plugin package
is in the path, it interacts in arbitrary ways with my main application.
however, i don't think i'd want it to appear in mktap, as that doesn't
really make sense in this situation.....or does it?

-phil



From exarkun at intarweb.us  Wed Nov 26 15:24:08 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 26 Nov 2003 15:24:08 -0500
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
Message-ID: <20031126202408.GA16267@intarweb.us>

On Wed, Nov 26, 2003 at 02:49:46PM -0500, Phil Christensen wrote:
> i was going through the docs, and i found the two classes in
> twisted/python/plugin.py, and i was wondering what the difference is
> between the two.
> 
> i'd like to be able to make a sort of plugin that when the plugin package
> is in the path, it interacts in arbitrary ways with my main application.
> however, i don't think i'd want it to appear in mktap, as that doesn't
> really make sense in this situation.....or does it?
> 


  a DropIn is an abstraction for an entire plugins.tml file.

  a PlugIn is a single entity, typically corresponding to a register() call
in a plugins.tml file.

  mktap only shows plugins of type "tap" (because that is the only kind of
plugin it knows how to use!), so if you make your plugins of a different
type, they won't show up there.


  Jp


> -phil
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031126/85157397/attachment.pgp 

From itamar at itamarst.org  Wed Nov 26 15:24:50 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 26 Nov 2003 15:24:50 -0500
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
Message-ID: <20031126152450.03865bec.itamar@itamarst.org>

On Wed, 26 Nov 2003 14:49:46 -0500 (EST)
"Phil Christensen" <phil at bubblehouse.org> wrote:

> i'd like to be able to make a sort of plugin that when the plugin
> package is in the path, it interacts in arbitrary ways with my main
> application. however, i don't think i'd want it to appear in mktap, as
> that doesn't really make sense in this situation.....or does it?

You can have different types of plugins. For example, mktap uses one
kind of plugin, but twisted.lore uses another. IIRC there's a type
keyword arg that indicates what kind of plugin it is.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From phil at bubblehouse.org  Wed Nov 26 16:08:14 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 26 Nov 2003 16:08:14 -0500 (EST)
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <20031126202408.GA16267@intarweb.us>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
    <20031126202408.GA16267@intarweb.us>
Message-ID: <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>

I've figured out that part. I created a plugin directory, and i set the
type to "myPluginType"...now how do i access my plugin from within the
app?

i've got this in my plugins.tml file:

register ("My plugin package",
		"core.plugin",
		description = """
		Provides functionality to my app.
		""",
		type ="myPluginType")

i did the following in the interpreter:

>>> from twisted.python import plugin
>>> plugin.getPlugIns("myPluginType")
[<Plugin 'My plugin package' core.plugin>]

so i guess my question is, what to i do with this plugin object? i see it
has a property named "module", which is the string i gave it of
"core.plugin". this file doesn't exist yet since i don't know what to put
in it.

i guess i just need a little more guidance. i'm looking through the code
too, but i'm not sure what calls what...

thanks for any help,

-phil

> On Wed, Nov 26, 2003 at 02:49:46PM -0500, Phil Christensen wrote:
[snip snip snip]
>> i'd like to be able to make a sort of plugin that when the plugin
>> package
>> is in the path, it interacts in arbitrary ways with my main application.
>> however, i don't think i'd want it to appear in mktap, as that doesn't
>> really make sense in this situation.....or does it?
>>
>
>
>   a DropIn is an abstraction for an entire plugins.tml file.
>
>   a PlugIn is a single entity, typically corresponding to a register()
> call
> in a plugins.tml file.
>
>   mktap only shows plugins of type "tap" (because that is the only kind of
> plugin it knows how to use!), so if you make your plugins of a different
> type, they won't show up there.




From exarkun at intarweb.us  Wed Nov 26 19:27:30 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 26 Nov 2003 19:27:30 -0500
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2> <20031126202408.GA16267@intarweb.us> <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>
Message-ID: <20031127002730.GA17062@intarweb.us>

On Wed, Nov 26, 2003 at 04:08:14PM -0500, Phil Christensen wrote:
> I've figured out that part. I created a plugin directory, and i set the
> type to "myPluginType"...now how do i access my plugin from within the
> app?
> 
> i've got this in my plugins.tml file:
> 
> register ("My plugin package",
> 		"core.plugin",
> 		description = """
> 		Provides functionality to my app.
> 		""",
> 		type ="myPluginType")
> 
> i did the following in the interpreter:
> 
> >>> from twisted.python import plugin
> >>> plugin.getPlugIns("myPluginType")
> [<Plugin 'My plugin package' core.plugin>]

  Call .load() on it, and do something with the result.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031126/76053f96/attachment.pgp 

From robert.penz at outertech.com  Thu Nov 27 15:58:41 2003
From: robert.penz at outertech.com (Robert Penz)
Date: Thu, 27 Nov 2003 21:58:41 +0100
Subject: [Twisted-Python] log irc bot example problem
Message-ID: <200311272158.41234.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi!

I'm playing with the twisted irclogbot example .. I've no problem in the 
ircnet, but it I always get disconnected from the efnet, but a eggdrop on the 
same machine has no problem

[21:34:05] [connected at Thu Nov 27 21:34:05 2003]
[21:34:51] [disconnected at Thu Nov 27 21:34:51 2003 reason([Failure instance: 
Traceback: twisted.internet.error.ConnectionDone, Connection was closed 
cleanly.
])]

I've looked at it with tcpdump and got following, but what should that tell 
me:

NICK bla!
NOTICE AUTH :*** Looking up your hostname.
USER bla! foo bar :None
NOTICE AUTH :*** Checking Ident
NOTICE AUTH :*** Found your hostname
NOTICE AUTH :*** Got Ident response
:efnet.demon.co.uk 432 * rim! :Erroneous NERROR :Closing Link: mydnsname.com


- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/xmWB8tTsQqJDUBMRApfXAJ0a5qB4qcIm4cX1e1M1qBuQY7femACfby7W
DLQgXXnZXNiJanDLBA9VxK0=
=D0R7
-----END PGP SIGNATURE-----




From exarkun at intarweb.us  Thu Nov 27 20:34:06 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 27 Nov 2003 20:34:06 -0500
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <200311272158.41234.robert.penz@outertech.com>
References: <200311272158.41234.robert.penz@outertech.com>
Message-ID: <20031128013406.GA19313@intarweb.us>

On Thu, Nov 27, 2003 at 09:58:41PM +0100, Robert Penz wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> Hi!
> 
> I'm playing with the twisted irclogbot example .. I've no problem in the 
> ircnet, but it I always get disconnected from the efnet, but a eggdrop on the 
> same machine has no problem
> 
> [21:34:05] [connected at Thu Nov 27 21:34:05 2003]
> [21:34:51] [disconnected at Thu Nov 27 21:34:51 2003 reason([Failure instance: 
> Traceback: twisted.internet.error.ConnectionDone, Connection was closed 
> cleanly.
> ])]
> 
> I've looked at it with tcpdump and got following, but what should that tell 
> me:
> 
> NICK bla!
> NOTICE AUTH :*** Looking up your hostname.
> USER bla! foo bar :None
> NOTICE AUTH :*** Checking Ident
> NOTICE AUTH :*** Found your hostname
> NOTICE AUTH :*** Got Ident response
> :efnet.demon.co.uk 432 * rim! :Erroneous NERROR :Closing Link: mydnsname.com

  432 is erroneous nickname.  Likely, the server doesn't like the "!" in
your nick.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031127/85eeb836/attachment.pgp 

From glyph at twistedmatrix.com  Thu Nov 27 23:05:13 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 27 Nov 2003 23:05:13 -0500
Subject: [Twisted-Python] Fwd: Seems like the remote stuff works almost TOO well!
Message-ID: <11359D4A-2158-11D8-8A5A-000393C9700E@twistedmatrix.com>

I am not sure if this was just the most creative unsolicited mail I 
ever received, or if it's a complaint from an unsuspecting user.  I 
think the "werewolf" comment is from the "AUSPEX" capability of the 
POP3 server.

Have crackers been using Twisted for some nefarious scheme?

Begin forwarded message:

> From: "D Triplett" <censored>
> Date: November 27, 2003 2:55:46 PM EST
> To: Glyph at twistedmatrix.com
> Subject: Seems like the remote stuff works almost TOO well!
>
> Hi,
>
> Long story short, I wonder if you happen to play an online game named 
> "werewolf"?
>
> Better yet, could you tell me where I can get a floppy disk that would 
> wipe out any "twisted" remote network from my computer that I do not 
> know the password for, the network drive number, or anything?
>
> See, I don't know any of this because I didn't create or approve it.  
> But, hey, I bet whoever's taken 109 gigs of my hard drive (leaving me 
> with 11 gigs - sweet of them) were having a good time for a while...
>
> A few of the couple hundred txt docs led me to some stuff, which led 
> me to some more stuff, then a banana driver came along, and somehow, I 
> ended up reading about my cool remote server and compliments of 
> "twisted".
>
> I sure would appreciate any help you can give.




From wenderson at casadosprogramadores.com.br  Fri Nov 28 06:41:21 2003
From: wenderson at casadosprogramadores.com.br (Wenderson Teixeira)
Date: Fri, 28 Nov 2003 09:41:21 -0200
Subject: [Twisted-Python] Woven and nested database queries
Message-ID: <003401c3b5a4$8e2aa7d0$4501a8c0@wteixeiradsk1>

	Hi,

	I'm new to the list and I'm just starting with Twisted and Woven.
	I think the framework is great, but I'm having some problems.
	When I try to make two nested <div>, both with independent queries,
	I get na error, the solution I've found is to create another model
	called "loaddata", which does nothing, except call the queries.
	If anyone knows a better way, I'd like to hear, I've searched all
	over the Internet, and found nothing that could help.

	Thanks in advance,
 	 	
	Wenderson Teixeira


	Here is the minimum working code that exemplifies it:

from twisted.web.resource import Resource

from twisted.web.woven import page
from twisted.web import microdom
from twisted.enterprise import adbapi

class A(page.Page):

    # When "loaddata" is not present, I get the following error:
    # exceptions.AttributeError: DeferredWidget instance has no attribute 'd'
    template = """
                <html>
                <body>
                    <div model="loaddata"/>
                    <p>A</p>
                    <div model="a">
                        <div view="Text"/>
                        <p>B</p>
                        <ul model="b" view="List">
                            <li pattern="listItem" view="Text" />
                        </ul>
                    </div>
                </body>
                </html>
                """    

    def wmfactory_loaddata(self, request):
        self.runAQuery(request)
        self.runBQuery(request)
        return []

    def wmfactory_a(self, request):
        return self.runAQuery(request)

    def wmfactory_b(self, request):
        return self.runBQuery(request)

    def runQuery(self, queryStr, attr, callback):
        if not hasattr(self, attr):
            dbpool = adbapi.ConnectionPool("pyPgSQL.PgSQL", "192.168.1.180::manesco_01:manesco")
            deferredQuery = dbpool.runQuery(queryStr)
            deferredQuery.addCallback(callback)
            dbpool.close()
            return deferredQuery
        return getattr(self, attr)
    
    def runAQuery(self, request):
        # Sample data
        #return [[1, 'Wenderson', 'WT', 2, 'Tex', None]]
        return self.runQuery("SELECT * FROM advogado WHERE id_adv=77", "aDataset", self.gotAResult)

    def runBQuery(self, request):
        # Sample data
        #return [
        #    [1, 'Advogado Sr.'],
        #    [2, 'Advogado Pleno'],
        #    [3, 'Advogado Jr.'],
        #    [4, 'Estagiario'],
        #    [5, 'Assist. Criatividade'],
        #    [6, 'Empresario'],
        #    [7, 'Departamento Pessoal']
        #]
        return self.runQuery("SELECT * FROM categoria", "bDataset", self.gotBResult)

    def gotAResult(self, data):
        self.aDataset = data
        return data
    
    def gotBResult(self, data):
        self.bDataset = data
        return data

resource = A(directory = "C:\inetpub\wwwroot\man")

	




From robert.penz at outertech.com  Fri Nov 28 12:05:10 2003
From: robert.penz at outertech.com (Robert Penz)
Date: Fri, 28 Nov 2003 18:05:10 +0100
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <20031128013406.GA19313@intarweb.us>
References: <200311272158.41234.robert.penz@outertech.com> <20031128013406.GA19313@intarweb.us>
Message-ID: <200311281805.10427.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Friday 28 November 2003 02:34, Jp Calderone wrote:

>   432 is erroneous nickname.  Likely, the server doesn't like the "!" in
> your nick.

ok changed the nick now I get following

NICK blabla31
NOTICE AUTH :*** Looking up your hostname.
USER blabla31 foo bar :None
NOTICE AUTH :*** Checking Ident
NOTICE AUTH :*** Found your hostname
NOTICE AUTH :*** Got Ident response
:efnet.demon.co.uk NOTICE blabla31 :*** BaERROR :Closing Link: mydnsname.com

whats this ?


- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/x4BG8tTsQqJDUBMRApLpAKCPXikRxQ9H3PEIoq3Hx/ZhBCY6EACfZ+Tq
oMms6KhRVXKf822ZMbX5+k4=
=o87D
-----END PGP SIGNATURE-----




From michal at pasternak.w.lub.pl  Fri Nov 28 12:38:12 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Fri, 28 Nov 2003 18:38:12 +0100
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <200311281805.10427.robert.penz@outertech.com>
References: <200311272158.41234.robert.penz@outertech.com> <20031128013406.GA19313@intarweb.us> <200311281805.10427.robert.penz@outertech.com>
Message-ID: <20031128173812.GC24887@pasternak.w.lub.pl>

Robert Penz [Fri, Nov 28, 2003 at 06:05:10PM +0100]:
> :efnet.demon.co.uk NOTICE blabla31 :*** BaERROR :Closing Link: mydnsname.com
> 
> whats this ?

Robert,

your questions have nothing to do with Twisted, those are IRC problems. It's
closing link, because - propably - mydnsname.com is not allowed to connect
to that IRC server. I'd suggest e-mailing some local irc-oriented newsgroup
or list. Thank you.

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From robert.penz at outertech.com  Fri Nov 28 13:15:33 2003
From: robert.penz at outertech.com (Robert Penz)
Date: Fri, 28 Nov 2003 19:15:33 +0100
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <20031128173812.GC24887@pasternak.w.lub.pl>
References: <200311272158.41234.robert.penz@outertech.com> <200311281805.10427.robert.penz@outertech.com> <20031128173812.GC24887@pasternak.w.lub.pl>
Message-ID: <200311281915.33884.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Friday 28 November 2003 18:38, Michal Pasternak wrote:
> your questions have nothing to do with Twisted, those are IRC problems.
> It's closing link, because - propably - mydnsname.com is not allowed to
> connect to that IRC server. I'd suggest e-mailing some local irc-oriented
> newsgroup or list. Thank you.

but if I start eggdrop on the same machine it works.

- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/x5DF8tTsQqJDUBMRAs1rAJ0cepGVJ8RcFbwzWEzNN2BjWbsrKwCdGdxw
f045prIe9eLmyRnEJP7YhqY=
=dA+w
-----END PGP SIGNATURE-----




From pje at telecommunity.com  Fri Nov 28 16:17:36 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Fri, 28 Nov 2003 16:17:36 -0500
Subject: [Twisted-Python] PyProtocols 0.9.1 Released
Message-ID: <5.1.0.14.0.20031128160119.028e9dc0@mail.telecommunity.com>

What is PyProtocols?
--------------------

PyProtocols is an extended implementation of PEP 246, adding a new 
"declaration  API" that lets you easily define your own interfaces and 
adapters, and declare what adapters should be used to adapt what types, 
objects, or interfaces.  Using PyProtocols, you can easily make flexible 
frameworks that you or other developers can extend without needing to 
modify the base framework.  PyProtocols interfaces can interoperate with 
those of Twisted and Zope, or can be used entirely standalone.

PyProtocols may be used, modified, and distributed under the same terms
and conditions as Python or Zope.


What's new in version 0.9.1?
----------------------------

* Implemented Samuele Pedroni's "subproto" idea (see 
http://mail.python.org/pipermail/python-dev/2003-June/036242.html) as the 
new 'protocolForType()' API.

* Added other APIs to automatically generate protocols, such as 
'protocolForURI()', 'sequenceOf()', and 'Variation()'.

* Compatible with Zope X3 Milestone 4, Python 2.3.2, and Twisted 
1.1.0.  (Also runs on Python 2.2.2+, if you don't need Zope 3 compatibility.)

* New 'Adapter' and 'StickyAdapter' convenience base classes

* Fixes for compatibility with 'ExtensionClass', and for a memory leak in 
the optional C "speedups" module


PyProtocols Resources
---------------------

* Detailed Changes since the 0.9 release:
    http://peak.telecommunity.com/protocol_api/CHANGES.txt.html

* Release notes, installation instructions, and browsable API docs:
    http://peak.telecommunity.com/protocol_api/

* Source and Binary Releases:
    http://peak.telecommunity.com/dist/

* Reference Manual (HTML):
    http://peak.telecommunity.com/protocol_ref/module-protocols.html

* Reference Manual (PDF):
    http://peak.telecommunity.com/protocol_ref.pdf

* Browsable CVS Repository:
    http://cvs.eby-sarna.com/PyProtocols/




From flxkid at techemail.com  Sat Nov 29 01:59:17 2003
From: flxkid at techemail.com (Oliver Nelson)
Date: Fri, 28 Nov 2003 22:59:17 -0800 (PST)
Subject: [Twisted-Python] using twisted web server as a type of REST server
Message-ID: <20031129065917.9276B725B@sitemail.everyone.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031128/c1a18a36/attachment.txt 

From robert.penz at outertech.com  Sat Nov 29 04:01:01 2003
From: robert.penz at outertech.com (Robert Penz)
Date: Sat, 29 Nov 2003 10:01:01 +0100
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <200311281915.33884.robert.penz@outertech.com>
References: <200311272158.41234.robert.penz@outertech.com> <20031128173812.GC24887@pasternak.w.lub.pl> <200311281915.33884.robert.penz@outertech.com>
Message-ID: <200311291001.04537.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Friday 28 November 2003 19:15, Robert Penz wrote:
> On Friday 28 November 2003 18:38, Michal Pasternak wrote:
> > your questions have nothing to do with Twisted, those are IRC problems.
> > It's closing link, because - propably - mydnsname.com is not allowed to
> > connect to that IRC server. I'd suggest e-mailing some local irc-oriented
> > newsgroup or list. Thank you.
> but if I start eggdrop on the same machine it works.

found the problem ... 

- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/yGBQ8tTsQqJDUBMRAmrqAJ0ZRZxsFMFbpfNsJwYF5wB4Wbl7PACfSVpC
wc/6F6wT5yLQQ/+6Wws8WfE=
=MTiQ
-----END PGP SIGNATURE-----




From lists at webcrunchers.com  Sat Nov 29 16:07:34 2003
From: lists at webcrunchers.com (JD)
Date: Sat, 29 Nov 2003 13:07:34 -0800
Subject: [Twisted-Python] Anyone want to join our Spammer hooneypot project?
In-Reply-To: <200311291001.04537.robert.penz@outertech.com>
References: <200311272158.41234.robert.penz@outertech.com> <20031128173812.GC24887@pasternak.w.lub.pl> <200311281915.33884.robert.penz@outertech.com> <200311291001.04537.robert.penz@outertech.com>
Message-ID: <0DAD250E-22B0-11D8-8F1A-0030656C6B9E@webcrunchers.com>

Hi,

This is an initial inquiry to find out if anyone really familiar with 
Twisted would want to join me in the development of
a Spammer honeypot system to release into the public domain.

A recent "securityfocus" article seems to indicate some project like 
this might be worthwhile,  and Twisted seems
to be the perfect tool for this....

Not only would it be used to "fool" spammers,  but it also could be 
used to "detect" proxy connections from IRC
bots,  and return the proper "fingerprints" to convince the spammers 
this is a really legit proxy.

I've done a lot of research in this project,  and come to the 
realization that the ONLY way to catch these people
who write such viruses,  is to "suck them into" a honeypot.

Anyone interested,  please Email me at 'crunch at shopip dot com'

Don't reply to my 'lists' mailbox,  as this is only for my mailing 
lists.

Regards
John




From maoy at cis.upenn.edu  Sat Nov 29 18:06:05 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Sat, 29 Nov 2003 18:06:05 -0500 (EST)
Subject: [Twisted-Python] SSL example in tutorial isn't working for me
In-Reply-To: <0DAD250E-22B0-11D8-8F1A-0030656C6B9E@webcrunchers.com>
Message-ID: <Pine.LNX.4.44.0311291803190.32236-100000@klondike.cis.upenn.edu>

http://www.twistedmatrix.com/documents/howto/listings/finger/finger22.py

Error:

2003/11/29 18:00 EST [-] NameError: global name 'SSL' is not defined

Is it because someone commented out from OpenSSL import SSL? I uncomment 
it and emerge pyOpennSSL but it still doesn't work. :(

Yun






From slyphon at twistedmatrix.com  Sat Nov 29 19:41:55 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Sat, 29 Nov 2003 19:41:55 -0500
Subject: [Twisted-Python] using twisted web server as a type of REST
	server
In-Reply-To: <20031129065917.9276B725B@sitemail.everyone.net>
References: <20031129065917.9276B725B@sitemail.everyone.net>
Message-ID: <1070152915.662.42.camel@willie-the-pimp.embassynetworks.com>

On Sat, 2003-11-29 at 01:59, Oliver Nelson wrote:
> Reading the docs on the twisted web server I see that it automatically 
> handles object publishing.  But what if I want to respond to requests 
> that aren't based on a object structure?  IOW:
> 
> Client does a GET on:
> localhost/infodir/subdir/doc.txt
> 
> in this case infodir, subdir, and doc.txt would actually be info to 
> lookup in a database on the fly, no object structure.  Is this possible?
> 
> I hope I'm explaining myself ok...

Well, I'm no expert on twisted-web, but I wanted to answer your question
in at least a general sense. It is indeed possible to perform such a
task, as twisted.web's object lookup is completely customizable. Drop in
on #twisted on irc.freenode.net and ask someone in there, or if no one
else responds to this thread, email me and I'll help you find out how to
do what you're interested in doing.

- Jonathan Simms (slyphon)




From exarkun at intarweb.us  Sat Nov 29 20:41:55 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 29 Nov 2003 20:41:55 -0500
Subject: [Twisted-Python] SSL example in tutorial isn't working for me
In-Reply-To: <Pine.LNX.4.44.0311291803190.32236-100000@klondike.cis.upenn.edu>
References: <0DAD250E-22B0-11D8-8F1A-0030656C6B9E@webcrunchers.com> <Pine.LNX.4.44.0311291803190.32236-100000@klondike.cis.upenn.edu>
Message-ID: <20031130014155.GA25459@intarweb.us>

On Sat, Nov 29, 2003 at 06:06:05PM -0500, Yun Mao wrote:
> http://www.twistedmatrix.com/documents/howto/listings/finger/finger22.py
> 
> Error:
> 
> 2003/11/29 18:00 EST [-] NameError: global name 'SSL' is not defined
> 
> Is it because someone commented out from OpenSSL import SSL? 

  Probably.  It is unclear why this has been done.

> I uncomment it and emerge pyOpennSSL but it still doesn't work. :(

  How does it not work?

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031129/c5586fd1/attachment.pgp 

From andrew-twisted at puzzling.org  Sat Nov 29 20:50:22 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 30 Nov 2003 12:50:22 +1100
Subject: [Twisted-Python] using twisted web server as a type of REST server
In-Reply-To: <20031129065917.9276B725B@sitemail.everyone.net>
References: <20031129065917.9276B725B@sitemail.everyone.net>
Message-ID: <20031130015021.GB8856@frobozz>

On Fri, Nov 28, 2003 at 10:59:17PM -0800, Oliver Nelson wrote:
> Reading the docs on the twisted web server I see that it automatically
> handles object publishing.  But what if I want to respond to requests that
> aren't based on a object structure?  IOW:
> 
> Client does a GET on:
> localhost/infodir/subdir/doc.txt
> 
> in this case infodir, subdir, and doc.txt would actually be info to lookup
> in a database on the fly, no object structure.  Is this possible?

Yep.  Write a custom Resource, and override getChild:
    http://twistedmatrix.com/documents/howto/using-twistedweb#auto3

-Andrew.




From maoy at cis.upenn.edu  Sat Nov 29 21:17:36 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Sat, 29 Nov 2003 21:17:36 -0500 (EST)
Subject: [Twisted-Python] SSL example in tutorial isn't working for me
In-Reply-To: <20031130014155.GA25459@intarweb.us>
Message-ID: <Pine.LNX.4.44.0311292055060.32236-100000@klondike.cis.upenn.edu>

I see what's wrong here.

This is part of finger22.py

    def getContext(self):
        """Create an SSL context.

        This is a sample implementation that loads a certificate from a 
file
        called 'server.pem'."""                               
        ctx = SSL.Context(SSL.SSLv23_METHOD)
        ctx.use_certificate_file('server.pem')
        ctx.use_privatekey_file('server.pem')
        return ctx

I should have substituted the certificate_file to the certificate file..

Yun


On Sat, 29 Nov 2003, Jp Calderone wrote:

> On Sat, Nov 29, 2003 at 06:06:05PM -0500, Yun Mao wrote:
> > http://www.twistedmatrix.com/documents/howto/listings/finger/finger22.py
> > 
> > Error:
> > 
> > 2003/11/29 18:00 EST [-] NameError: global name 'SSL' is not defined
> > 
> > Is it because someone commented out from OpenSSL import SSL? 
> 
>   Probably.  It is unclear why this has been done.
> 
> > I uncomment it and emerge pyOpennSSL but it still doesn't work. :(
> 
>   How does it not work?
> 
>   Jp
> 




From jsbenson at bensonsystems.com  Sat Nov 29 23:26:50 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Sat, 29 Nov 2003 20:26:50 -0800
Subject: [Twisted-Python] Re: python-list query re sockets, select or: twisted and other file-descriptors & twisted question
Message-ID: <061d01c3b6fa$2d0a12e0$210110ac@jsbwxp3>

In response to the question about doing serial i/o and using a select
statement, I'd like to quote from
http://www.python.org/doc/current/lib/module-select.html

select(iwtd, owtd, ewtd[, timeout])

This is a straightforward interface to the Unix select() system call. The
first three arguments are lists of `waitable objects': either integers
representing file descriptors or objects with a parameterless method named
fileno() returning such an integer. The three lists of waitable objects are
for input, output and `exceptional conditions', respectively. Empty lists
are allowed, but acceptance of three empty lists is platform-dependent. (It
is known to work on Unix but not on Windows.) The optional timeout argument
specifies a time-out as a floating point number in seconds. When the timeout
argument is omitted the function blocks until at least one file descriptor
is ready. A time-out value of zero specifies a poll and never blocks.
The return value is a triple of lists of objects that are ready: subsets of
the first three arguments. When the time-out is reached without a file
descriptor becoming ready, three empty lists are returned.
Among the acceptable object types in the lists are Python file objects (e.g.
sys.stdin, or objects returned by open() or os.popen()), socket objects
returned by socket.socket().  You may also define a wrapper class yourself,
as long as it has an appropriate fileno() method (that really returns a file
descriptor, not just a random integer). Note: File objects on Windows are
not acceptable, but sockets are.  On Windows, the underlying select()
function is provided by the WinSock library, and does not handle file
desciptors that don't originate from WinSock.

(end quote)

So, select might not yet work on Windows serial ports as well as sockets.
This is also a subject of interest to me, but all I can think of is handling
the sockets via select() and polling periodically for data on the serial
port using callLater() and some win32 calls. Maybe the win32 serial port
handling could even be wrapped in a 'waitable object' as described above for
use with the Python select() call.

I recall reading somewhere that the twisted framework has the ability to
handle serial communications in connection with Global Positioning System
device interaction, but don't have any information about it. I'm going to
post this to the twisted mailing list :

Question for twisted folks: How can I add serial Windows serial port
communications as a twisted protocol? Please cross-post back to the
python-list.





From radix at twistedmatrix.com  Sun Nov 30 00:42:23 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 30 Nov 2003 00:42:23 -0500
Subject: [Twisted-Python] python-interfaces mailing list
Message-ID: <20031130054223.GC3019@radii>

I just set up a new mailing list on twistedmatrix.com to discuss
interface/component systems with possible future interest in a SIG for
"integrating" (to some extent) existing Interface systems and putting
an Interface/component system into python. Even this interest is
controversial, though, I think it's mostly my own ;-)

You can subscribe at 

http://twistedmatrix.com/cgi-bin/listinfo/python-interfaces

And that page has a link to archives containing the few messages which
have been posted so far.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From radix at twistedmatrix.com  Sun Nov 30 02:03:48 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 30 Nov 2003 02:03:48 -0500
Subject: [Twisted-Python] python-interfaces mailing list
In-Reply-To: <20031130054223.GC3019@radii>
References: <20031130054223.GC3019@radii>
Message-ID: <20031130070348.GA5788@radii>

On Sun, Nov 30, 2003 at 12:42:23AM -0500, Christopher Armstrong wrote:
> I just set up a new mailing list on twistedmatrix.com to discuss
> interface/component systems with possible future interest in a SIG for
> "integrating" (to some extent) existing Interface systems and putting
> an Interface/component system into python. Even this interest is
> controversial, though, I think it's mostly my own ;-)
> 
> You can subscribe at 
> 
> http://twistedmatrix.com/cgi-bin/listinfo/python-interfaces

Bah, I didn't check this URL.

http://twistedmatrix.com/cgi-bin/mailman/listinfo/python-interfaces

Sorry.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From tv at tv.debian.net  Fri Nov 28 09:09:14 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Fri, 28 Nov 2003 16:09:14 +0200
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>    <20031126202408.GA16267@intarweb.us> <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>
Message-ID: <3FC7570A.9060106@tv.debian.net>

Phil Christensen wrote:
>>>>from twisted.python import plugin
>>>>plugin.getPlugIns("myPluginType")
> 
> [<Plugin 'My plugin package' core.plugin>]
> 
> so i guess my question is, what to i do with this plugin object? i see it
> has a property named "module", which is the string i gave it of
> "core.plugin". this file doesn't exist yet since i don't know what to put
> in it.
> 
> i guess i just need a little more guidance. i'm looking through the code
> too, but i'm not sure what calls what...

You may want to look at how TouRSSt uses plugins.
http://ftp.debian.org/debian/pool/main/t/toursst/




From tv at tv.debian.net  Fri Nov 28 09:12:47 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Fri, 28 Nov 2003 16:12:47 +0200
Subject: [Twisted-Python] Woven and nested database queries
In-Reply-To: <003401c3b5a4$8e2aa7d0$4501a8c0@wteixeiradsk1>
References: <003401c3b5a4$8e2aa7d0$4501a8c0@wteixeiradsk1>
Message-ID: <3FC757DF.5010405@tv.debian.net>

Wenderson Teixeira wrote:
> 	I'm new to the list and I'm just starting with Twisted and Woven.
> 	I think the framework is great, but I'm having some problems.
> 	When I try to make two nested <div>, both with independent queries,
> 	I get na error, the solution I've found is to create another model
> 	called "loaddata", which does nothing, except call the queries.
> 	If anyone knows a better way, I'd like to hear, I've searched all
> 	over the Internet, and found nothing that could help.

Your problem is most likely Deferred models of which you need a 
submodel. Woven is buggy.

>                     <div model="a">
>                         <div view="Text"/>
>                         <p>B</p>
>                         <ul model="b" view="List">
>                             <li pattern="listItem" view="Text" />
>                         </ul>

Try <ul model="./b" view="List">, that should work.




From kevin at mobilewareinc.com  Fri Nov 28 18:34:25 2003
From: kevin at mobilewareinc.com (Kevin Unger)
Date: Fri, 28 Nov 2003 15:34:25 -0800
Subject: [Twisted-Python] no reponse from mktap on windows
Message-ID: <000c01c3b608$2b5c9ff0$0201a8c0@telecaster>

I just downloaded twisted 1.1.0 forWindows and I get no response from mktap:

    python %TWISTEDSCRIPTS%\mktap.py web --help

What am I doing wrong?

thanks,

-k

Kevin Unger
MobileWare, Inc.
kevin at mobilewareinc.com
707-769-7441
707-364-1176 (cell)




From andrew-pythonlist at puzzling.org  Sun Nov 30 02:08:53 2003
From: andrew-pythonlist at puzzling.org (Andrew Bennetts)
Date: Sun, 30 Nov 2003 18:08:53 +1100
Subject: [Twisted-Python] Re: python-list query re sockets, select or: twisted and other file-descriptors & twisted question
In-Reply-To: <061d01c3b6fa$2d0a12e0$210110ac@jsbwxp3>
References: <061d01c3b6fa$2d0a12e0$210110ac@jsbwxp3>
Message-ID: <20031130070853.GE8856@frobozz>

On Sat, Nov 29, 2003 at 08:26:50PM -0800, John Benson wrote:
> 
> So, select might not yet work on Windows serial ports as well as sockets.

That's correct.  Windows select is from the Winsock library, and only works
with sockets.

> This is also a subject of interest to me, but all I can think of is handling
> the sockets via select() and polling periodically for data on the serial
> port using callLater() and some win32 calls. Maybe the win32 serial port
> handling could even be wrapped in a 'waitable object' as described above for
> use with the Python select() call.

Thankfully, pySerial has already taken care of the details of cross-platform
serial-port access (apparently, I've never used it):

    http://pyserial.sourceforge.net/

> I recall reading somewhere that the twisted framework has the ability to
> handle serial communications in connection with Global Positioning System
> device interaction, but don't have any information about it. I'm going to
> post this to the twisted mailing list :
> 
> Question for twisted folks: How can I add serial Windows serial port
> communications as a twisted protocol? Please cross-post back to the
> python-list.

Twisted uses pySerial, so the platform you're running Twisted on shouldn't
matter.  There are some examples in the doc/examples directory of Twisted
that use the serial port:

    mouse.py -- example using MouseMan protocol with the SerialPort
                transport
    gpsfix.py -- example using the SerialPort transport and the NMEA 0183
                 and Rockwell Zodiac GPS protocols to display fix data as it
                 is received from the device.

-Andrew.




From lafou at wanadoo.fr  Sun Nov 30 13:17:36 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Sun, 30 Nov 2003 19:17:36 +0100
Subject: [Twisted-Python] getProcessOutpout
Message-ID: <200311301917.36596.lafou@wanadoo.fr>

I have a pb with twisted.internet.utils.getProcessOutput (i never get the 
output :() here is an exemple :

class PGAT_deftest(GAT_page):

    template="""<html><body><span view="Viewtest"></span></body></html>"""

    def wvfactory_Viewtest(self, request, node, model):
        return MyDeferredWidget(model)

    def render(self, request):
        request.write('<html><body><h1>DEFTEST</h1>'+ time.asctime()+'<br >')
        print "Emerge !"
        d = getProcessOutput("ps")
        d.setTimeout(5,self.renderProcessOutput, request)
        d.addCallback(self.renderProcessOutput, request)
        d.addErrback(self.renderError, request)
        d.addCallback(self.finishPage, request)
        return NOT_DONE_YET

    def renderProcessOutput(self, output, request):
        request.write(output)

    def renderError(self, failure, request):
        request.write('it broke! (error : "'+failure.getErrorMessage()+'")')

    def finishPage(self, _, request):
        request.write('</body></html>')
        request.finish()

def montest():
    time.sleep(5)
    return "Ca marche !"

If I create a bash script with :
---
sleep(5)
echo "Hello world"
---
the twisted code above works great. But If I use a system program like "ps" or 
"emerge" , the callback is never called :(

(btw : getProcessOutput ("date") works)




From gtwist at nixel.mine.nu  Sat Nov  1 03:41:18 2003
From: gtwist at nixel.mine.nu (Kev)
Date: Sat, 1 Nov 2003 05:41:18 -0500
Subject: [Twisted-Python] connectTCP/listenTCP socks/ssh
Message-ID: <20031101104118.GA21085@nixel.mine.nu>

I'm writing a socks proxy that uses ssh tunnels for connections, I can
get it working by making my connectClass listenTCP with a
forwarding.SSHListenForwardingFactory and then ClientCreator a
SOCKSv4Outgoing to connectTCP, but obviously that's a bad method. 

How can I cut the listen/connect? Is there a way I can do it at that
level or do I need to implement my own .connectSSH method?

It seems I need to get both sides placed in the reactor somehow,
but SSHChannel.conn doesn't have a fileno() so addReader doesn't accept it.
(Is addReader the right function? I found it in the curses example and
 am assuming it's just a generic file descriptor handler)

Thanks much



From z3p at twistedmatrix.com  Sat Nov  1 11:39:46 2003
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Sat, 01 Nov 2003 13:39:46 -0500
Subject: [Twisted-Python] connectTCP/listenTCP socks/ssh
In-Reply-To: <20031101104118.GA21085@nixel.mine.nu>
References: <20031101104118.GA21085@nixel.mine.nu>
Message-ID: <1067711986.7649.4.camel@petra>

On Sat, 2003-11-01 at 05:41, Kev wrote:
> I'm writing a socks proxy that uses ssh tunnels for connections, I can
> get it working by making my connectClass listenTCP with a
> forwarding.SSHListenForwardingFactory and then ClientCreator a
> SOCKSv4Outgoing to connectTCP, but obviously that's a bad method. 

You should definatly look at adding this feature to Conch when you
finish it.  That's been on the TODO list for a while.

> How can I cut the listen/connect? Is there a way I can do it at that
> level or do I need to implement my own .connectSSH method?

Basically, you're going to want to override SOCKSv4.connectClass and
SOCKSv4.listenClass.  connectClass returns a Deferred that is called
back with an unused value.  listenClass returns a Deferred that is
called back with a tuple of (host, port) that is being listened on.

-p
-- 
      Paul Swartz
(o_   z3p at twistedmatrix dot com
//\   http://www.twistedmatrix.com/users/z3p.twistd/
V_/_  AIM: Z3Penguin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031101/c83e7eb2/attachment.sig>

From gtwist at nixel.mine.nu  Sat Nov  1 13:00:24 2003
From: gtwist at nixel.mine.nu (Kev)
Date: Sat, 1 Nov 2003 15:00:24 -0500
Subject: [Twisted-Python] connectTCP/listenTCP socks/ssh
In-Reply-To: <1067711986.7649.4.camel@petra>
References: <20031101104118.GA21085@nixel.mine.nu> <1067711986.7649.4.camel@petra>
Message-ID: <20031101200024.GA31082@nixel.mine.nu>

On Sat, Nov 01, 2003 at 01:39:46PM -0500, Paul Swartz wrote:
> You should definatly look at adding this feature to Conch when you
> finish it.  That's been on the TODO list for a while.

I got it working this morning, I'll add to to conch (I assume you mean
the conch.py in the scripts directory?) and submit it. It
actually wasn't difficult, well the program is like 60 lines, but it took me
a good 12 hours of keyboard time to write and pleanty of idle brian
cycles. (But part of that was just because I'm new to twisted and
python)





From mcfletch at rogers.com  Sun Nov  2 11:56:15 2003
From: mcfletch at rogers.com (Mike C. Fletcher)
Date: Sun, 02 Nov 2003 13:56:15 -0500
Subject: [Twisted-Python] SNMPProtocol, request for review...
Message-ID: <3FA5534F.4030100@rogers.com>

I've built an SNMP Protocol for Twisted (based on a pattern from Patrick 
K. O'Brien), but as I'm a rather new Twisted developer, I'm wondering if 
someone more "in the know" could take a look at the package and see if I 
got the "ideas" right.  That is, whether I'm going about the entire 
thing incorrectly/correctly, or whether I've missed anything that would 
be obvious to an experienced twisted developer.

The protocol provides for sending get, getnext and getbulk requests, but 
doesn't yet support trap or answering any query (i.e. in SNMP-eese it's 
a manager-only protocol at the moment, not an agent-side protocol).

I'm particularly interested in:

    * whether the timeouts are handled properly (we do a crude callLater
      and check for deferred.called for them), is there a more elegant
      Twisted mechanism for handling timed-out operations?
    * whether the message IDs are handled properly (we just store all
      "live" messages in a dictionary and delete them when they are
      timed out or responded to), is there some more elegant Twisted
      solution?
    * whether the entire approach is okay. I put most of the code and
      API on the protocol object, with a helper object for managing
      tabular downloads.  Is there a more "Twisted" way of doing this? 
      Should the get method on the protocol be implemented as a separate
      object driving the protocol as well?  What should be in the
      "protocol" level, (as opposed to higher-level "application" code)?

Package is here:
    http://members.rogers.com/mcfletch/programming/TwistedSNMP-0.1.tar.gz
It requires pysnmp-3.3.5, available here:
    http://download.sourceforge.net/pysnmp/

You'll need an SNMP agent against which to test (as well as some OIDs 
for that agent), as the ips in the scripts won't work without the proper 
community IDs (or from unrecognised manager IPs, for that matter).

Feedback appreciated,
Mike

_______________________________________
  Mike C. Fletcher
  Designer, VR Plumber, Coder
  http://members.rogers.com/mcfletch/






From andrew-twisted at puzzling.org  Sun Nov  2 15:20:27 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 3 Nov 2003 09:20:27 +1100
Subject: [Twisted-Python] SNMPProtocol, request for review...
In-Reply-To: <3FA5534F.4030100@rogers.com>
References: <3FA5534F.4030100@rogers.com>
Message-ID: <20031102222027.GA4320@frobozz>

On Sun, Nov 02, 2003 at 01:56:15PM -0500, Mike C. Fletcher wrote:
> I'm particularly interested in:
> 
>    * whether the timeouts are handled properly (we do a crude callLater
>      and check for deferred.called for them), is there a more elegant
>      Twisted mechanism for handling timed-out operations?

I haven't yet looked at your code, but there is a .setTimeout method on
Deferreds that sounds applicable here.  By default it will errback your
deferred with a defer.TimeoutError, but you can pass in a custom timeoutFunc
if necessary.

One thing to watch out for when using setTimeout is that you need to wrap
your calls to d.callback/d.errback in try/except defer.AlreadyCalledError,
in case the timeout does happen (alternatively you could pass in a
timeoutFunc that arranges for whatever would call callback/errback to be
cancelled, but that might be harder).  This is probably already the case
with your existing timeouts, though.

>    * whether the message IDs are handled properly (we just store all
>      "live" messages in a dictionary and delete them when they are
>      timed out or responded to), is there some more elegant Twisted
>      solution?

Again, I haven't looked at your code, but that sounds ok to me :)

-Andrew.




From sam at twistedmatrix.com  Mon Nov  3 06:41:14 2003
From: sam at twistedmatrix.com (Sam Jordan)
Date: Mon, 3 Nov 2003 23:41:14 +1000
Subject: [Twisted-Python] Adapting RemoteReferences
Message-ID: <20031103134114.GA9164@twistedmatrix.com>

Hi,

What is the general opinion on having a standard way to adapt
RemoteReferences to specific interfaces which basically just
wraps callRemote for each respective method?

The reason i'm bringing this up is I can imagine various
use-cases for wanting to treat remote objects and local objects
as semantically equivalent. For example, I may be employing
the observer pattern for a simple system to separate UI components
from data components. Currently if I wish to have both remote and
local observers interoperate I would have to either store them
in separate data structures and treat each differently when
sending notifications, or, I could store them in a single
data structure and use appropriate type-checking to dispatch the
calls. IMHO both of these solutions are relatively ugly.

Whether or not there are sufficient use-cases for a standard twisted
way to do this is another story, so i'm wondering what the views of
people are on this subject. Certainly one could just register their own
adapter for RemoteReference in each case, but the code to do this is rather
ugly and for those that _do_ have to deal with such cases I think it would
be nicer to have a simple, standard way of doing it,
e.g. remoteRef.adaptTo(Interface).

I've written a function that outlines the functionality I think it should
provide which is included below; while this implementation is rather ugly
i'm more worried about the idea rather than how it would eventually be
implemented if someone decides this is worth having.

Of course, there are certain constraints, such as the method wrappers
having no way of knowing if the remote object actually implements the
desired interface or not, but I don't see this as a problem for something
that already requires string based dispatch. I guess you could say this
proposal is somewhat similar to java's 'stub' approach, only it doesn't
force it :-).

Cheers,

Sam.

------------------------------------------
import types

class Interface:
  def add(x,y): pass
  def mul(x,y): pass

class Interface2(Interface):
  def div(x,y): pass
  def sub(x,y): pass

class Foo:
  def callRemote(self, name, *args, **kw): print 'calling %s with %s %s' % (name, args, kw)

# this would likely put put in RemoteReference
# to provide context
def adaptTo(self, interface):
    # obtain all interface methods
    methods = interface.__dict__
    for base in interface.__bases__:
        for attrib,val in base.__dict__.iteritems():
            if not methods.has_key(attrib) and isinstance(val, types.FunctionType):
                methods[attrib] = base.__dict__[attrib]

    class _Adapter:
        def __init__(self, original): self.original = original

        for m in methods:
            exec "def %s(self, *args, **kw): return self.original.callRemote('%s', *args, **kw)" % (m,m)

    del _Adapter.m
    del _Adapter.methods
    return _Adapter(self)

def test():
    a = adaptTo(Foo(), Interface2)
    a.add(1,2)
    a.mul(2,4)
    a.div(8,4)
    a.sub(3,5)

test()

------------------------------------------



From ted at powersdk.com  Mon Nov  3 05:03:48 2003
From: ted at powersdk.com (Ted Patrick)
Date: Mon, 3 Nov 2003 07:03:48 -0500
Subject: [Twisted-Python] Socket Read Write
Message-ID: <000b01c3a202$8b1f6270$6401a8c0@ISLAND>

I am writing a chat socket server and need to make sure that there are no
conflicts when writing to other attached clients. I am concerned that when
the server receives lots of messages from many socket connections, several
sockets may encounter write contention. 

Is there a queue for the write method of a socket? 
Should one expect errors in this regard?
Does the Twisted architecture eliminate this class of error?
Using twisted.protocol.basic can 2 lineReceived events happen
simultaneously? How is this addressed?

Thanks,

Theodore E. Patrick
PowerSDK - Code for a distributed world
http://www.powersdk.com
 




From andrew-twisted at puzzling.org  Mon Nov  3 05:24:27 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 3 Nov 2003 23:24:27 +1100
Subject: [Twisted-Python] Socket Read Write
In-Reply-To: <000b01c3a202$8b1f6270$6401a8c0@ISLAND>
References: <000b01c3a202$8b1f6270$6401a8c0@ISLAND>
Message-ID: <20031103122427.GA5467@frobozz>

On Mon, Nov 03, 2003 at 07:03:48AM -0500, Ted Patrick wrote:
> I am writing a chat socket server and need to make sure that there are no
> conflicts when writing to other attached clients. I am concerned that when
> the server receives lots of messages from many socket connections, several
> sockets may encounter write contention. 

Twisted's network code is single-threaded.  Only one event is processed at
once, so the answers to your questions are:

> Is there a queue for the write method of a socket? 

No -- there doesn't need to be.  The transport will buffer any write that
isn't immediately writeable without blocking, but because you never do this
from more than one thread at a time, there are no possible races here.

> Should one expect errors in this regard?

Nope :)

> Does the Twisted architecture eliminate this class of error?

Yep :)

> Using twisted.protocol.basic can 2 lineReceived events happen
> simultaneously? How is this addressed?

They can't happen simultaneously. :)

If you are using threads in your Twisted app, be sure to read:
    http://twistedmatrix.com/documents/howto/threading

-Andrew.




From exarkun at intarweb.us  Mon Nov  3 05:43:10 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Mon, 3 Nov 2003 07:43:10 -0500
Subject: [Twisted-Python] Adapting RemoteReferences
In-Reply-To: <20031103134114.GA9164@twistedmatrix.com>
References: <20031103134114.GA9164@twistedmatrix.com>
Message-ID: <20031103124310.GA8435@intarweb.us>

On Mon, Nov 03, 2003 at 11:41:14PM +1000, Sam Jordan wrote:
> Hi,
> 
> What is the general opinion on having a standard way to adapt
> RemoteReferences to specific interfaces which basically just
> wraps callRemote for each respective method?
> 

  I think the preferred approach is the opposite.  Instead of taking remote
references and trying to treat them as local, take local references and
treat them as remote (this makes sense from an interface enforcement
consistency point of view, too -- it's easier to throw away some information
than you have than to pull information you don't have out of thin air).

  See twisted.spread.util.LocalAsyncForwarder.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031103/f189cfc4/attachment.sig>

From sam at twistedmatrix.com  Mon Nov  3 18:59:04 2003
From: sam at twistedmatrix.com (Sam Jordan)
Date: Tue, 4 Nov 2003 11:59:04 +1000
Subject: [Twisted-Python] Adapting RemoteReferences
In-Reply-To: <20031103124310.GA8435@intarweb.us>
References: <20031103134114.GA9164@twistedmatrix.com> <20031103124310.GA8435@intarweb.us>
Message-ID: <20031104015904.GA10300@twistedmatrix.com>

Hi,

Thanks for the response Jp ...

On Mon, Nov 03, 2003 at 07:43:10AM -0500, Jp Calderone wrote:
>   I think the preferred approach is the opposite.  Instead of taking remote
> references and trying to treat them as local, take local references and
> treat them as remote (this makes sense from an interface enforcement
> consistency point of view, too -- it's easier to throw away some information
> than you have than to pull information you don't have out of thin air).

Indeed, this does make more sense, I don't know why I didn't think of it in this
way. The way you have described also takes care of emulating the Deferred result
instead of having to specify it as part of the interface as well.

On the other hand, you still end up with basically the same level of interface
enforcement; that is, you can guarantee the interface characteristics of local
objects but not remote objects. This is unlikely to change however, without either
the protocol changing (unlikely - "did somebody mention IDL? :-)") or people obeying
their own interface definition conventions. Still, I can certainly see your point that
publishing an object as implementing an interface when it possibly doesn't is worse
than wrapping a local object with a single string-based dispatching method. 

Other small differences I can think of are that in cases where a system has already
been written and a remote interface is being provided, it may be easier to make
chanes to the effect of:

    # part of remote system wrapper class
    def remote_addObserver(self, observer):
        underlyingSystem.addObserver(observer.adaptTo(IUserInterface))

    # part of the underlying system
    # (code that was written prior to considering a remote interface)
    def addObserver(self, observer): self.observers.append(observer)

So if the underlying system was built without a remote interface in mind
it may be easier to just adapt the remote refs than to change every instance
of calls to the local objects.

If it _was_ written with the knowledge that a remote interface will be placed
on top in the future, I assume the code would look something like:

    # part of remote system wraper class
    def remote_addObserver(self, observer):
        underlyingSystem.addObserver(observer)

    # part of underlying system
    def addObserver(self, observer):
        if not isinstance(observer, RemoteReference):
            observer = LocalAsyncForwarder(observer, IUserInterface)
        # rest of method ...

And then all subsequent calls would use callRemote.

I guess which one you prefer is purely a matter of style and I can
see no real disadvantages from the later approach unless of course,
the system has already been written.

>   See twisted.spread.util.LocalAsyncForwarder.

Thanks for pointing this out.

Cheers,

Sam.



From itamar at itamarst.org  Mon Nov  3 09:25:41 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 3 Nov 2003 11:25:41 -0500
Subject: [Twisted-Python] Adapting RemoteReferences
In-Reply-To: <20031104015904.GA10300@twistedmatrix.com>
References: <20031103134114.GA9164@twistedmatrix.com>
	<20031103124310.GA8435@intarweb.us>
	<20031104015904.GA10300@twistedmatrix.com>
Message-ID: <20031103112541.003c4ad9.itamar@itamarst.org>

On Tue, 4 Nov 2003 11:59:04 +1000
Sam Jordan <sam at twistedmatrix.com> wrote:

> objects but not remote objects. This is unlikely to change however,
> without either the protocol changing (unlikely - "did somebody mention
> IDL? :-)") or people obeying

The PB rewrite in warner's sandbox has (or will have, anyway) schemas
for security.

Until then, you need to do enforcement manually.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From matthew.s.hegedus at lmco.com  Mon Nov  3 09:32:07 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Mon, 03 Nov 2003 10:32:07 -0600
Subject: [Twisted-Python] Woven web question about clearing http request.args
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24FC@EMSS07M12.us.lmco.com>

I've got multiple input buttons and their view is the same logic. The logic
is delete some data on a button press, then rerender the page with the
updated data. The data it will remove depends on the unique ID of the button
pressed.  When the web page is rerendered the view gets called for each
button with the same http request, so the deletion logic will be evaluated
for each button, even though it should be evaluated for just the button that
was pressed. I don't like that. I want to clear request.args so the behavior
will be as if there was only one http event, corresponding to a single
button press. I tried "request.args.clear()", but that doesn't seem to have
the expected effect.

What's worse is when I click the browser's reload button, request.args still
has the last http request that occurred. In other words, if I click my
delete button the page will be rerendered with updated data, then if I click
the browser's reload it will try to delete more data as if I had hit on of
my delete buttons again. Can anyone help me with this problem?

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From allison at shasta.stanford.edu  Mon Nov  3 10:29:03 2003
From: allison at shasta.stanford.edu (Dennis Allison)
Date: Mon, 3 Nov 2003 09:29:03 -0800 (PST)
Subject: [Twisted-Python] design issue wrt exceptional events
Message-ID: <Pine.LNX.4.44.0311020959380.13083-100000@shasta.stanford.edu>

I need a front-end to a complex of Zope systems.  The front-end listens on
an address/port and examines incoming http transactions, and, based upon
http headers and other information, connects to one or another of the Zope
systems.  The underlying approach is straightforward -- a Listener waits 
for a http transaction, it spawns a receiver which gathers the message, 
decides what to do, spawns a sender to the destination.  When the sender
responds, the process is reversed.  

I currently use an adaptation of Antony Baxter's pydirector to do the job.
I use his asynchat version, but have found that it leaks file descriptors
in my application.  I've not tried the twisted version.

So I thought I'd try to craft a tailored, light-weight version using 
the twisted framework.  I see how to manage things when everything works, 
but what if one or another of the endpoints fails?  How do I get 
everything cleaned up?









From itamar at itamarst.org  Mon Nov  3 10:42:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 3 Nov 2003 12:42:20 -0500
Subject: [Twisted-Python] design issue wrt exceptional events
In-Reply-To: <Pine.LNX.4.44.0311020959380.13083-100000@shasta.stanford.edu>
References: <Pine.LNX.4.44.0311020959380.13083-100000@shasta.stanford.edu>
Message-ID: <20031103124220.798ee87a.itamar@itamarst.org>

On Mon, 3 Nov 2003 09:29:03 -0800 (PST)
Dennis Allison <allison at shasta.stanford.edu> wrote:

> I currently use an adaptation of Antony Baxter's pydirector to do the
> job. I use his asynchat version, but have found that it leaks file
> descriptors in my application.  I've not tried the twisted version.

Why not use the Twisted version of pydirector? If it doesn't do exactly
what you want, submit patches.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From allison at shasta.stanford.edu  Mon Nov  3 11:46:22 2003
From: allison at shasta.stanford.edu (Dennis Allison)
Date: Mon, 3 Nov 2003 10:46:22 -0800 (PST)
Subject: [Twisted-Python] design issue wrt exceptional events
In-Reply-To: <20031103124220.798ee87a.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0311031044180.13083-100000@shasta.stanford.edu>

The twisted version does nothing much different from the asyncchat 
version as far as I can see.   Both have comments about a race condition 
on closing which I suspect may be the source of my file descriptor leak.
(Actually, I think it's a socket leak... )


On Mon, 3 Nov 2003, Itamar Shtull-Trauring wrote:

> On Mon, 3 Nov 2003 09:29:03 -0800 (PST)
> Dennis Allison <allison at shasta.stanford.edu> wrote:
> 
> > I currently use an adaptation of Antony Baxter's pydirector to do the
> > job. I use his asynchat version, but have found that it leaks file
> > descriptors in my application.  I've not tried the twisted version.
> 
> Why not use the Twisted version of pydirector? If it doesn't do exactly
> what you want, submit patches.
> 
> 

-- 
Dennis Allison * Computer Systems Laboratory * Gates 227
               * Stanford University *  Stanford CA  94305
	       * (650) 723-9213 * (650) 723-0033 fax
	       * allison at shasta.stanford.edu
	       * allison at sumeru.stanford.edu





From itamar at itamarst.org  Mon Nov  3 12:14:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 3 Nov 2003 14:14:15 -0500
Subject: [Twisted-Python] design issue wrt exceptional events
In-Reply-To: <Pine.LNX.4.44.0311031044180.13083-100000@shasta.stanford.edu>
References: <20031103124220.798ee87a.itamar@itamarst.org>
	<Pine.LNX.4.44.0311031044180.13083-100000@shasta.stanford.edu>
Message-ID: <20031103141415.3242f7e6.itamar@itamarst.org>

On Mon, 3 Nov 2003 10:46:22 -0800 (PST)
Dennis Allison <allison at shasta.stanford.edu> wrote:

> The twisted version does nothing much different from the asyncchat 
> version as far as I can see.   Both have comments about a race
> condition on closing which I suspect may be the source of my file
> descriptor leak.(Actually, I think it's a socket leak... )

Nevertheless, I'd expect it'd be easier to fix a single bug than to
implement a whole program from scratch.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From lists at webcrunchers.com  Mon Nov  3 14:38:32 2003
From: lists at webcrunchers.com (John D.)
Date: Mon, 3 Nov 2003 13:38:32 -0800
Subject: [Twisted-Python] Dynamic form with twisted
In-Reply-To: <3F8C1320.8090408@twistedmatrix.com>
References: <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>
 <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>
Message-ID: <v03110715bbcc7a4da8f9@[192.168.0.3]>

>vicky lupien wrote:
>
>> I want to make a form dynamically. I don't want to use FormProcess and I 
>> do not understand very well how it works.  If someone have documentation 
>> on forms (not the one on twisted matrix), it will be appreciated.
>
>Twisted's layers are relatively well-factored internally.  If you don't 
>like our dynamic form generation tools - and believe me, I know there 
>are good reasons not to like them - you can still use the web server. 
>You can easily write a form processor which uses request.args (a 
>dictionary of HTTP form arguments) as input and produces HTML via 
>request.write.
>
>Your question seems a little vague, though: if you are looking for 
>documentation on forms in general, consider a resource like
>
>	http://www.ku.edu/~acs/docs/other/forms-intro.shtml

darn,  this was something I was also looking for,  but (sigh) that site
must be down right now,  I cannot get anything from that URL.   Would you
happen to know where I can find some good examples of forms processing I can
look at?     I'm still suffering from a lack of useful examples.  The Twisted
tutorial doesn't cover ANY examples of how to process forms pages.

I'm also looking for an implementation of a SMTP server.  A simple one,  just to show how all the components are tied together.   This is what Twisted really lacks,  documentation on how everything is tied together.   The tutorial covers some of that,  and does pretty good job,  but there are NO existing documentation on how to implement the simplest of SMTP servers,  although it appears there are alot of object that support it,  there just isn't any documentation that tell me how it's all tied together.

John





From lists at webcrunchers.com  Mon Nov  3 15:13:52 2003
From: lists at webcrunchers.com (John D.)
Date: Mon, 3 Nov 2003 14:13:52 -0800
Subject: [Twisted-Python] form and submit
In-Reply-To: <BAY1-F40OWGMhLPBLYd00012b78@hotmail.com>
Message-ID: <v03110716bbcc817657b7@[192.168.0.3]>

>I have a form with a submit button.  I want to send my data from the form in 
>a web page to an other web page.  Also, I want to check if the data is 
>correct.
>
>I'm new to twisted, so I need some help
>
>Vicky
>
>_________________________________________________________________
>MSN Messenger : discutez en direct avec vos amis !  
>http://messenger.fr.msn.ca/
>
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


Vickey,

  Here is something that could get you started.   "request.args" returns a 
dictionary of the forms data,  including buttons.

  Copy and paste this code into your Python window and run it,  and 
using your browser,  go to this URL  http://localhost:8080 and play
with it.

from twisted.web import server, resource
from twisted.internet import reactor

class Simple(resource.Resource):
	isLeaf = True
	def render(self, request):
		"""
		request.args.get('key', '') gets the forms values.  This
		"page" just prints a SUBMIT button and a text field.

		There is no actual CGI called "default.cgi",  you would have
		to handle seperate script files manually at this stage,  but
		you could handle your forms page right here.  In this example
		I have a textfield called "Field" as you see in the HTML below.

		when submitting,  this just loops back to this code,  extracts
		the forms values,  then re-renders the forms page in html before 
		it exits and loops back again.
		"""
		IP = request.getClientIP()
		html = ""
		html += "<html>Hello, world!</html><br><br>"
		html += "Keys are...<br>"
		for key in request.args.keys():
			html += "%s " % key
		html += "<br>uri = %s<br>" % request.uri
		html += "<br>method = %s<br>" % request.method
		html += "<br>path = %s<br>" % request.path
		
		field_value = request.args.get('Field', '')
		html += "<br>Field = %s<br>" % field_value
		html += "<br>ClientIP = %s<br>" % IP
		button_val = request.args.get('name_submit','')	
		html += "<br>button_val = %s<br>" % button_val
		form = """
		<FORM ACTION="default.cgi" METHOD="POST" ENCTYPE="application/x-www-form-urlencoded">
<P>Test input: <INPUT TYPE="TEXT" NAME="Field" SIZE="25"><BR>
<INPUT TYPE="SUBMIT" NAME="name_submit" VALUE="Submit">
</FORM>
		"""
		return html + form

site = server.Site(Simple())
reactor.listenTCP(8080, site)
reactor.run()





From uwe at oss4u.com  Tue Nov  4 11:19:31 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Tue, 4 Nov 2003 10:19:31 -0800
Subject: [Twisted-Python] Scaling problem
Message-ID: <200311041019.31926.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Hi guys,

is there a way to have one service start several processes ?
When using twisted everyone connecting to the server ends in the same process. 
This leads to "slowing down" when requesting information whenever a certain 
number of people go on. Each request takes some time to process and meanwhile 
the server is less responsive. I have one particularly expensive function 
that takes a bit. So if several people happen to use this function at a time 
the server slows down, up to where it takes a minute to complete.
It's not a problem of system ressources (it's a quad processor xeon server 
with plenty of RAM and ultra 320 scsi drives running only this application 
and the postgres backend). The machine has a load of 0.2 while slowing down.
Basically most of the machine is idle, since it only runs 2 processes and has 
4 processors.
Is there a way to have twisted do something like apache or postgres and split 
the incoming connection to several processes ? It's not a web application, 
I'm solely using pb.
BTW: You might suggest to break down the expensive function into smaller 
pieces - no way. It has to run in one database transaction otherwise I might 
end up with a inconsistent database - no good in finance business.

Thanks

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/p+2zjqGXBvRToM4RAiLKAKDKjRWiezqXkSLQA0P/TCCcgYwckACePksV
3qxzLR3w0x3jKgKdWf1oNTA=
=LzUM
-----END PGP SIGNATURE-----




From itamar at itamarst.org  Tue Nov  4 12:50:45 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 4 Nov 2003 14:50:45 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311041019.31926.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
Message-ID: <20031104145045.5dd33f75.itamar@itamarst.org>

On Tue, 4 Nov 2003 10:19:31 -0800
"Uwe C. Schroeder" <uwe at oss4u.com> wrote:

> BTW: You might suggest to break down the expensive function into
> smaller pieces - no way. It has to run in one database transaction
> otherwise I might end up with a inconsistent database - no good in
> finance business.

What does this expensive function do? If it's standalone, involves heavy
computation, or blocking resources, running it in a thread pool should
allow you to improve latency. In cases where it goes into C code, it
should also improve performance as it should release the GIL when doing
that.

If that isn't good enough, Quotient has some code for dispatching tasks
to multiple processes.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Tue Nov  4 13:20:46 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 04 Nov 2003 15:20:46 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311041019.31926.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
Message-ID: <3FA80A1E.6050606@twistedmatrix.com>

Uwe C. Schroeder wrote:

> Is there a way to have twisted do something like apache or postgres and split 
> the incoming connection to several processes ? It's not a web application, 
> I'm solely using pb.

This is possible, although not as easy as I'd like it to be.  In 
principle, on most UNIX-based OSes, it's possible to listen() and 
accept() in one process, pass the returned file descriptor to a 
subprocess and do communication there.  I'd like to make this automatic 
at some point, but won't have the time to do it for at least another few 
months.

The fact that it's not as graceful or automatic as I like doesn't mean 
it's impossible though.  If you want to just have one "control" process 
that shuttles around I/O and N worker processes that do the actual work, 
you can still use spawnProcess and communicate over stdin/stdout to the 
subprocesses about new connections using a simple protocol which 
multiplexes multiple socket connections down to the one pipe connection 
and back.

Also, if database latency is your main problem, or you can move a little 
bit of performance-sensitive code into C and relinquish the GIL while 
they're happening, you can just use callInThread to run your 
transactions in threads instead of having the reactor waiting on them.

Is this helpful?




From grib at billgribble.com  Tue Nov  4 14:05:21 2003
From: grib at billgribble.com (Bill Gribble)
Date: Tue, 04 Nov 2003 15:05:21 -0600
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311041019.31926.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
Message-ID: <1067979921.22040.46.camel@serrano>

On Tue, 2003-11-04 at 12:19, Uwe C. Schroeder wrote:
> BTW: You might suggest to break down the expensive function into smaller 
> pieces - no way. It has to run in one database transaction otherwise I might 
> end up with a inconsistent database - no good in finance business.

Would it help you to have the ability to open a database transaction and
keep it open while you do other things?  I have a patch to adbapi that
adds an API to do this.  It's in daily use on my development system but
I haven't quite finished cleaning it up for submission. 

b.g.
 




From bob at redivi.com  Tue Nov  4 14:26:14 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 4 Nov 2003 16:26:14 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <3FA80A1E.6050606@twistedmatrix.com>
References: <200311041019.31926.uwe@oss4u.com> <3FA80A1E.6050606@twistedmatrix.com>
Message-ID: <84E1A160-0F0D-11D8-B158-000A95686CD8@redivi.com>

On Nov 4, 2003, at 3:20 PM, Glyph Lefkowitz wrote:

> Uwe C. Schroeder wrote:
>
>> Is there a way to have twisted do something like apache or postgres 
>> and split the incoming connection to several processes ? It's not a 
>> web application, I'm solely using pb.
>
> This is possible, although not as easy as I'd like it to be.  In 
> principle, on most UNIX-based OSes, it's possible to listen() and 
> accept() in one process, pass the returned file descriptor to a 
> subprocess and do communication there.  I'd like to make this 
> automatic at some point, but won't have the time to do it for at least 
> another few months.

This is also useful for using privileged sockets (ports < 1024).  For 
example, on OS X in a GUI environment one can start a subprocess with 
root privileges w/ the Authorization framework, open the privileged 
socket, and pass it back to the parent process that does not have root 
privs.

-bob




From scosol at yahoo.com  Tue Nov  4 17:21:46 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 4 Nov 2003 16:21:46 -0800 (PST)
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031104145045.5dd33f75.itamar@itamarst.org>
Message-ID: <20031105002146.52106.qmail@web13904.mail.yahoo.com>

--- Itamar Shtull-Trauring <itamar at itamarst.org>
wrote:
> 
> What does this expensive function do? If it's
> standalone, involves heavy
> computation, or blocking resources, running it in a
> thread pool should
> allow you to improve latency. In cases where it goes
> into C code, it
> should also improve performance as it should release
> the GIL when doing
> that.

Am I severely confused here?
The entire point of Twisted (to me anyway) seems to be
to  provide non-blocking interfaces to long-running
and/or blocking resources.

I thought that was the whole point of it being
event-driven.

????????


=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_-jupiter accepts your offer-_



From itamar at itamarst.org  Tue Nov  4 17:49:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 4 Nov 2003 19:49:15 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105002146.52106.qmail@web13904.mail.yahoo.com>
References: <20031104145045.5dd33f75.itamar@itamarst.org>
	<20031105002146.52106.qmail@web13904.mail.yahoo.com>
Message-ID: <20031104194915.34c9c499.itamar@itamarst.org>

On Tue, 4 Nov 2003 16:21:46 -0800 (PST)
Nathan Seven <scosol at yahoo.com> wrote:

> Am I severely confused here?
> The entire point of Twisted (to me anyway) seems to be
> to  provide non-blocking interfaces to long-running
> and/or blocking resources.

Long-running yes, blocking, no. There is no magic way to make a blocking
API not-block. So you need to either rewrite from scratch, or use
threads.

For example, "send an email and return success or failure" can be
written using non-blocking APIs, since sockets have non-blocking APIs.
Calling a DB-API database adapter's cursor.fetchall() method can not
(unless you want to rewrite the database's wire protocol).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From scosol at yahoo.com  Wed Nov  5 00:05:26 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 4 Nov 2003 23:05:26 -0800 (PST)
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031104194915.34c9c499.itamar@itamarst.org>
Message-ID: <20031105070526.97752.qmail@web13906.mail.yahoo.com>

--- Itamar Shtull-Trauring <itamar at itamarst.org>
wrote:
> On Tue, 4 Nov 2003 16:21:46 -0800 (PST)
> Nathan Seven <scosol at yahoo.com> wrote:
> 
> > Am I severely confused here?
> > The entire point of Twisted (to me anyway) seems
> to be
> > to  provide non-blocking interfaces to
> long-running
> > and/or blocking resources.
> 
> Long-running yes, blocking, no. There is no magic
> way to make a blocking
> API not-block. So you need to either rewrite from
> scratch, or use
> threads.
> 
> For example, "send an email and return success or
> failure" can be
> written using non-blocking APIs, since sockets have
> non-blocking APIs.
> Calling a DB-API database adapter's
> cursor.fetchall() method can not
> (unless you want to rewrite the database's wire
> protocol).

But cant I write my code in a manner so that even if
every database call timed out infinitely, my
non-blocking access to it will simply deferr every
response until my machine runs out of resources to
handle the stalled db connections?
(while still responding promptly to the front end web
connections)
That's my understanding at least...


=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_-jupiter accepts your offer-_



From uwe at oss4u.com  Wed Nov  5 03:12:19 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 5 Nov 2003 02:12:19 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <1067979921.22040.46.camel@serrano>
References: <200311041019.31926.uwe@oss4u.com> <1067979921.22040.46.camel@serrano>
Message-ID: <200311050212.19373.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Tuesday 04 November 2003 01:05 pm, Bill Gribble wrote:
> On Tue, 2003-11-04 at 12:19, Uwe C. Schroeder wrote:
> > BTW: You might suggest to break down the expensive function into smaller
> > pieces - no way. It has to run in one database transaction otherwise I
> > might end up with a inconsistent database - no good in finance business.
>
> Would it help you to have the ability to open a database transaction and
> keep it open while you do other things?  I have a patch to adbapi that
> adds an API to do this.  It's in daily use on my development system but
> I haven't quite finished cleaning it up for submission.

I'm already doing that, but without using adbapi. When I started this project 
adbapi was no choice and now it's simply not an option to rewrite a lot of 
code to something I expect to be even slower than my code. I use a very lean 
row class based on slots and a db interface that handles the schema itself 
without me supplying it. This certainly is database dependant but I can 
afford to support postgres only.

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qM0DjqGXBvRToM4RAgizAJ93/N/cmUs5MH7oP3xNfhL4loNk4wCgwBaF
b+i2uqarCqQ9nct+MrUuXLQ=
=zh8w
-----END PGP SIGNATURE-----




From uwe at oss4u.com  Wed Nov  5 03:48:07 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 5 Nov 2003 02:48:07 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <3FA80A1E.6050606@twistedmatrix.com>
References: <200311041019.31926.uwe@oss4u.com> <3FA80A1E.6050606@twistedmatrix.com>
Message-ID: <200311050248.07658.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Tuesday 04 November 2003 12:20 pm, Glyph Lefkowitz wrote:
> Uwe C. Schroeder wrote:
> > Is there a way to have twisted do something like apache or postgres and
> > split the incoming connection to several processes ? It's not a web
> > application, I'm solely using pb.
>
> This is possible, although not as easy as I'd like it to be.  In
> principle, on most UNIX-based OSes, it's possible to listen() and
> accept() in one process, pass the returned file descriptor to a
> subprocess and do communication there.  I'd like to make this automatic
> at some point, but won't have the time to do it for at least another few
> months.
>
> The fact that it's not as graceful or automatic as I like doesn't mean
> it's impossible though.  If you want to just have one "control" process
> that shuttles around I/O and N worker processes that do the actual work,
> you can still use spawnProcess and communicate over stdin/stdout to the
> subprocesses about new connections using a simple protocol which
> multiplexes multiple socket connections down to the one pipe connection
> and back.
>
> Also, if database latency is your main problem, or you can move a little
> bit of performance-sensitive code into C and relinquish the GIL while
> they're happening, you can just use callInThread to run your
> transactions in threads instead of having the reactor waiting on them.

I figured that the impact of callInThread is much higher to the rest of the 
system than I like. I'm already using deferToThread a lot, however there are 
limits to the usefulness of threads.  For example I use it to do page 
formatting (printjobs). Each of the printjobs is about 120 pages to format. 
If I start 20 to 30 such formatting jobs with deferToThread twisted virtually 
becomes unresponsive. If I limit to a max of 3 or so it works. I admit I 
don't understand this, since IMHO defering to a thread should make it 
independant from the parent. I didn't dig into this problem since It's not a 
big deal to limit to a few such jobs at any given time and use a spooler type 
interface to suspend requests for later.

I think I suffer from database latency in general and with the expensive 
function in particular. The expensive function could be moved to a thread and 
maybe I'll give it a try. However if I do this for every method that writes 
more than 10 or 15 records to the database I'll most likely end up with 
thousands of threads. Currently the system is used by up to 15 people, but 
projection goes to 400+ people at any given time. I don't have a problem with 
having people wait for a result, I have a problem with the other people that 
don't get a result because the framework stops responding for a couple of 
functions that just take more than a millisecond to execute. 
I'd rather have 500 processes like with apache and have the OS do the 
scheduling - which is way more efficient than having the framework schedule.
The most expensive function I have (besides the printing mentioned above) 
executes in about 3 seconds. This is not "blocking" in my understanding, 
since the function never waits for something to happen, it just calculates 
and stores stuff. Twisted is unresponsive for those 3 seconds. Multiply that 
by 10 users and one user might end up with a delay of more than 30 seconds 
before his "3 seconds" are evaluated. If I had a lot of processes the OS 
would schedule that more efficiently since then the function might take 5 
seconds to complete, but it would be interrupted by the OS scheduler to hand 
processing time to one of the other processes. 

Maybe I'll look into splitting into n worker processes. Since this would 
involve going into twisted code, where would I start looking ?

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qNVnjqGXBvRToM4RAgyCAJ9d73B7bnWIu4C3NyGDwQ23HqfXRACguodJ
pB5TPkUy6oYjlgC/Fvei36E=
=osgL
-----END PGP SIGNATURE-----




From itamar at itamarst.org  Wed Nov  5 08:11:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 5 Nov 2003 10:11:51 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105070526.97752.qmail@web13906.mail.yahoo.com>
References: <20031104194915.34c9c499.itamar@itamarst.org>
	<20031105070526.97752.qmail@web13906.mail.yahoo.com>
Message-ID: <20031105101151.4f577a0f.itamar@itamarst.org>

On Tue, 4 Nov 2003 23:05:26 -0800 (PST)
Nathan Seven <scosol at yahoo.com> wrote:

> But cant I write my code in a manner so that even if
> every database call timed out infinitely, my
> non-blocking access to it will simply deferr every
> response until my machine runs out of resources to
> handle the stalled db connections?

Yes. If you run the database query in a thread.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Wed Nov  5 08:14:49 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 5 Nov 2003 10:14:49 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311050248.07658.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com> <3FA80A1E.6050606@twistedmatrix.com> <200311050248.07658.uwe@oss4u.com>
Message-ID: <20031105151449.GA20167@intarweb.us>

On Wed, Nov 05, 2003 at 02:48:07AM -0800, Uwe C. Schroeder wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> On Tuesday 04 November 2003 12:20 pm, Glyph Lefkowitz wrote:
> > Uwe C. Schroeder wrote:
> > > Is there a way to have twisted do something like apache or postgres and
> > > split the incoming connection to several processes ? It's not a web
> > > application, I'm solely using pb.
> >
> > This is possible, although not as easy as I'd like it to be.  In
> > principle, on most UNIX-based OSes, it's possible to listen() and
> > accept() in one process, pass the returned file descriptor to a
> > subprocess and do communication there.  I'd like to make this automatic
> > at some point, but won't have the time to do it for at least another few
> > months.
> >
> > The fact that it's not as graceful or automatic as I like doesn't mean
> > it's impossible though.  If you want to just have one "control" process
> > that shuttles around I/O and N worker processes that do the actual work,
> > you can still use spawnProcess and communicate over stdin/stdout to the
> > subprocesses about new connections using a simple protocol which
> > multiplexes multiple socket connections down to the one pipe connection
> > and back.
> >
> > Also, if database latency is your main problem, or you can move a little
> > bit of performance-sensitive code into C and relinquish the GIL while
> > they're happening, you can just use callInThread to run your
> > transactions in threads instead of having the reactor waiting on them.
> 
> I figured that the impact of callInThread is much higher to the rest of the 
> system than I like. I'm already using deferToThread a lot, however there are 
> limits to the usefulness of threads.  For example I use it to do page 
> formatting (printjobs). Each of the printjobs is about 120 pages to format. 
> If I start 20 to 30 such formatting jobs with deferToThread twisted virtually 
> becomes unresponsive. If I limit to a max of 3 or so it works. I admit I 
> don't understand this, since IMHO defering to a thread should make it 
> independant from the parent.

  But it doesn't, not in Python.  Each thread adds new contention for the
GIL, which makes every thread less responsive.  If the print jobs were
managed by a C extension which could release the GIL before doing its work,
then they would be mostly independant.

> I didn't dig into this problem since It's not a big deal to limit to a few
> such jobs at any given time and use a spooler type interface to suspend
> requests for later.

  Yea.  If you only have 4 CPUs, it doesn't make sense to be running 400
CPU-bound threads :)

> 
> I think I suffer from database latency in general and with the expensive 
> function in particular. The expensive function could be moved to a thread and 
> maybe I'll give it a try. However if I do this for every method that writes 
> more than 10 or 15 records to the database I'll most likely end up with 
> thousands of threads. Currently the system is used by up to 15 people, but 
> projection goes to 400+ people at any given time. I don't have a problem with 
> having people wait for a result, I have a problem with the other people that 
> don't get a result because the framework stops responding for a couple of 
> functions that just take more than a millisecond to execute. 
> I'd rather have 500 processes like with apache and have the OS do the 
> scheduling - which is way more efficient than having the framework schedule.
> The most expensive function I have (besides the printing mentioned above) 
> executes in about 3 seconds. This is not "blocking" in my understanding, 
> since the function never waits for something to happen, it just calculates 
> and stores stuff.

  It is blocking.  While the term usually refers to a function that waits
for some I/O to finish, it applies equally well to any functions that run
for a non-trivial amount of time and, while doing so, prevent the rest of
the application from proceeding.

> Twisted is unresponsive for those 3 seconds. Multiply that by 10 users and
> one user might end up with a delay of more than 30 seconds before his "3
> seconds" are evaluated. If I had a lot of processes the OS would schedule
> that more efficiently since then the function might take 5 seconds to
> complete, but it would be interrupted by the OS scheduler to hand
> processing time to one of the other processes.
> 
> Maybe I'll look into splitting into n worker processes. Since this would 
> involve going into twisted code, where would I start looking ?
> 

  Before doing that, you might consider just spawning a handful of worker
threads and giving them queues.  This keeps the application responsive by
not forcing an insane number of context switches but also still allowing all
the expensive functions to run independently of the I/O thread.  

  There is even a ThreadPool class in Twisted already (though I have never
used it myself ;), so giving this approach a try should be pretty quick, and
if it is still not good enough, you haven't lost much time.

  This is not to say that multiple processes would not also be a good
solution, just that it might be a harder one to implement.  If you do end up
looking at multiple processes, reactor.spawnProcess() (as glyph alluded to
earlier) is one way to go about it.  This is basically the equivalent of
popen2() (though with a lot more flexibility).

  On a related, but not necessarily useful note, I've recently begun
investigating ways of moving the state associated with a user request,
including the associated socket object, between processes.  My use case is
not load-balancing, but the code should apply equally well to this as to
what I intend to use it for.  It requires C extensions (which are currently
-just- good enough to play around with higher-level stuff in Python with). 
The code is very short, and lives mostly in sandbox/exarkun/copyover/fdpass.py
in CVS HEAD.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031105/3c284807/attachment.sig>

From itamar at itamarst.org  Wed Nov  5 08:31:19 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 5 Nov 2003 10:31:19 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311050248.07658.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
	<3FA80A1E.6050606@twistedmatrix.com>
	<200311050248.07658.uwe@oss4u.com>
Message-ID: <20031105103119.2695e083.itamar@itamarst.org>

On Wed, 5 Nov 2003 02:48:07 -0800
"Uwe C. Schroeder" <uwe at oss4u.com> wrote:

> I think I suffer from database latency in general and with the
> expensive function in particular. The expensive function could be
> moved to a thread and maybe I'll give it a try. However if I do this
> for every method that writes more than 10 or 15 records to the
> database I'll most likely end up with thousands of threads.

No, Twisted has a thread pool, so if you are using Twisted APIs you
won't get more than the max number of threads the pool is configured to
use.

> The most expensive function I have (besides the printing mentioned
> above) executes in about 3 seconds. This is not "blocking" in my
> understanding, since the function never waits for something to happen,
> it just calculates and stores stuff. Twisted is unresponsive for those
> 3 seconds.

If Twisted is unresponsive, that means it blocks. Any function that
takes more than 10ms should probably count as blocking, really. Try
running it in a thread. Because of the global interpreter lock, this
won't reduce runtime, but it'll enhance responsiveness to other clients.

In general, it sounds like you are doing a lot of database queries. Some
ways to optimize this:

1. Do less queries - cache, merge identical requests, etc.. 
2. Do a number of queries in a single transaction in a single thread,
rather than deferToThread, get result, run another query with
deferToThread again, etc..
(3. Don't use RDBMS. Use an in-process database like ZODB or Quotient's
atop when it's done.)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Wed Nov  5 09:02:30 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 05 Nov 2003 11:02:30 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105151449.GA20167@intarweb.us>
References: <200311041019.31926.uwe@oss4u.com> <3FA80A1E.6050606@twistedmatrix.com> <200311050248.07658.uwe@oss4u.com> <20031105151449.GA20167@intarweb.us>
Message-ID: <3FA91F16.4050102@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Jp Calderone wrote:

|   There is even a ThreadPool class in Twisted already (though I have never
| used it myself ;), so giving this approach a try should be pretty
quick, and
| if it is still not good enough, you haven't lost much time.

Don't use it! :)  Use reactor.callInThread, as we've been saying.
ThreadPool is an implementation detail of the default reactor, at this
point.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/qR8VvVGR4uSOE2wRAuwLAKCkNBk00PSaI3C9TFK6F3XtosMV5QCdGzZC
fjgaHR76PsQCVMLPdcKwO3w=
=+wz/
-----END PGP SIGNATURE-----




From uwe at oss4u.com  Wed Nov  5 10:32:23 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 5 Nov 2003 09:32:23 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105103119.2695e083.itamar@itamarst.org>
References: <200311041019.31926.uwe@oss4u.com> <200311050248.07658.uwe@oss4u.com> <20031105103119.2695e083.itamar@itamarst.org>
Message-ID: <200311050932.23119.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Wednesday 05 November 2003 07:31 am, Itamar Shtull-Trauring wrote:
> On Wed, 5 Nov 2003 02:48:07 -0800
>
> "Uwe C. Schroeder" <uwe at oss4u.com> wrote:
> > I think I suffer from database latency in general and with the
> > expensive function in particular. The expensive function could be
> > moved to a thread and maybe I'll give it a try. However if I do this
> > for every method that writes more than 10 or 15 records to the
> > database I'll most likely end up with thousands of threads.
>
> No, Twisted has a thread pool, so if you are using Twisted APIs you
> won't get more than the max number of threads the pool is configured to
> use.

I know and I increased the threadpool limit a bit. Not much though because in 
the end it all runs on one cpu. I asume that if I start say 50 threads via 
deferToThread and the pool limit is 25 the requested threads are started when 
one becomes available ?

> > The most expensive function I have (besides the printing mentioned
> > above) executes in about 3 seconds. This is not "blocking" in my
> > understanding, since the function never waits for something to happen,
> > it just calculates and stores stuff. Twisted is unresponsive for those
> > 3 seconds.
>
> If Twisted is unresponsive, that means it blocks. Any function that
> takes more than 10ms should probably count as blocking, really. Try
> running it in a thread. Because of the global interpreter lock, this
> won't reduce runtime, but it'll enhance responsiveness to other clients.
 
Responsiveness is what I need. Users are happy to wait a couple seconds if one 
can notify him and his screen still shows some "progress".

> In general, it sounds like you are doing a lot of database queries. Some
> ways to optimize this:
>
> 1. Do less queries - cache, merge identical requests, etc..

Yep - I already started moving some of the things into the database as stored 
procedures. This reduces the execution time tremendously since it get's rid 
of the DB API overhead. I know I still have some optimization potential by 
handing data blocks between methods so a particular method doesn't have to 
requery the database for something an other method already did.

> 2. Do a number of queries in a single transaction in a single thread,
> rather than deferToThread, get result, run another query with
> deferToThread again, etc..

I already do this, at least in some parts. You're right, the thread handling 
overhead is way too high to have single simple queries running in a thread 
each. It doesn't make sense to use a thread which costs you 1ms to set up for 
something that only runs 1ms.

> (3. Don't use RDBMS. Use an in-process database like ZODB or Quotient's
> atop when it's done.)

:-) I'd probably do that with a web application, but even there I'll allways 
prefer a "real" database system. In process databases may be faster, therefor 
they are less relieable and correcting errors is a virtual impossibility.
Also the sher size of the data I handle would make something like ZODB blow up 
to a couple gigabytes in one month alone. 
Since my customers generally can afford it I rather use big iron for a couple 
thousand $$ to make the database faster. Specially in the finance and 
insurance industry it also makes the management happier if they see some big 
machines that look impressive in the rack. That's what they're used to and it 
gives them confidence in their investment (although one probably only uses 
10% of the machine :-) )
 
	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qTQnjqGXBvRToM4RAqp1AJ4u5ORM99wqwQECY7ilUe5DzZrDGwCgjfEm
QfoGAI5kzxAstClINbfqoaw=
=6MHF
-----END PGP SIGNATURE-----




From uwe at oss4u.com  Wed Nov  5 11:00:23 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 5 Nov 2003 10:00:23 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031105151449.GA20167@intarweb.us>
References: <200311041019.31926.uwe@oss4u.com> <200311050248.07658.uwe@oss4u.com> <20031105151449.GA20167@intarweb.us>
Message-ID: <200311051000.23748.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Wednesday 05 November 2003 07:14 am, Jp Calderone wrote:
> On Wed, Nov 05, 2003 at 02:48:07AM -0800, Uwe C. Schroeder wrote:
> > -----BEGIN PGP SIGNED MESSAGE-----
> > Hash: SHA1
> >
> > On Tuesday 04 November 2003 12:20 pm, Glyph Lefkowitz wrote:
> > > Uwe C. Schroeder wrote:
> > > > Is there a way to have twisted do something like apache or postgres
> > > > and split the incoming connection to several processes ? It's not a
> > > > web application, I'm solely using pb.
> > >
> > > This is possible, although not as easy as I'd like it to be.  In
> > > principle, on most UNIX-based OSes, it's possible to listen() and
> > > accept() in one process, pass the returned file descriptor to a
> > > subprocess and do communication there.  I'd like to make this automatic
> > > at some point, but won't have the time to do it for at least another
> > > few months.
> > >
> > > The fact that it's not as graceful or automatic as I like doesn't mean
> > > it's impossible though.  If you want to just have one "control" process
> > > that shuttles around I/O and N worker processes that do the actual
> > > work, you can still use spawnProcess and communicate over stdin/stdout
> > > to the subprocesses about new connections using a simple protocol which
> > > multiplexes multiple socket connections down to the one pipe connection
> > > and back.
> > >
> > > Also, if database latency is your main problem, or you can move a
> > > little bit of performance-sensitive code into C and relinquish the GIL
> > > while they're happening, you can just use callInThread to run your
> > > transactions in threads instead of having the reactor waiting on them.
> >
> > I figured that the impact of callInThread is much higher to the rest of
> > the system than I like. I'm already using deferToThread a lot, however
> > there are limits to the usefulness of threads.  For example I use it to
> > do page formatting (printjobs). Each of the printjobs is about 120 pages
> > to format. If I start 20 to 30 such formatting jobs with deferToThread
> > twisted virtually becomes unresponsive. If I limit to a max of 3 or so it
> > works. I admit I don't understand this, since IMHO defering to a thread
> > should make it independant from the parent.
>
>   But it doesn't, not in Python.  Each thread adds new contention for the
> GIL, which makes every thread less responsive.  If the print jobs were
> managed by a C extension which could release the GIL before doing its work,
> then they would be mostly independant.

That explains it. Maybe I'll go ahead and create a separate "print" server 
process that just produces paper. I'm using reportlab and I even had to turn 
off the c extensions used in reportlab, because they are not threadsafe. 
Printing isn't a big deal at this time, simply because I gave them a "print 
later" checkbox which will suspend formatting and printing for the night. At 
night I then just process all the printjobs sequentially.


> > I didn't dig into this problem since It's not a big deal to limit to a
> > few such jobs at any given time and use a spooler type interface to
> > suspend requests for later.
>
>   Yea.  If you only have 4 CPUs, it doesn't make sense to be running 400
> CPU-bound threads :)

Exactly :-)

>
> > I think I suffer from database latency in general and with the expensive
> > function in particular. The expensive function could be moved to a thread
> > and maybe I'll give it a try. However if I do this for every method that
> > writes more than 10 or 15 records to the database I'll most likely end up
> > with thousands of threads. Currently the system is used by up to 15
> > people, but projection goes to 400+ people at any given time. I don't
> > have a problem with having people wait for a result, I have a problem
> > with the other people that don't get a result because the framework stops
> > responding for a couple of functions that just take more than a
> > millisecond to execute.
> > I'd rather have 500 processes like with apache and have the OS do the
> > scheduling - which is way more efficient than having the framework
> > schedule. The most expensive function I have (besides the printing
> > mentioned above) executes in about 3 seconds. This is not "blocking" in
> > my understanding, since the function never waits for something to happen,
> > it just calculates and stores stuff.
>
>   It is blocking.  While the term usually refers to a function that waits
> for some I/O to finish, it applies equally well to any functions that run
> for a non-trivial amount of time and, while doing so, prevent the rest of
> the application from proceeding.
>
> > Twisted is unresponsive for those 3 seconds. Multiply that by 10 users
> > and one user might end up with a delay of more than 30 seconds before his
> > "3 seconds" are evaluated. If I had a lot of processes the OS would
> > schedule that more efficiently since then the function might take 5
> > seconds to complete, but it would be interrupted by the OS scheduler to
> > hand processing time to one of the other processes.
> >
> > Maybe I'll look into splitting into n worker processes. Since this would
> > involve going into twisted code, where would I start looking ?
>
>   Before doing that, you might consider just spawning a handful of worker
> threads and giving them queues.  This keeps the application responsive by
> not forcing an insane number of context switches but also still allowing
> all the expensive functions to run independently of the I/O thread.
>
>   There is even a ThreadPool class in Twisted already (though I have never
> used it myself ;), so giving this approach a try should be pretty quick,
> and if it is still not good enough, you haven't lost much time.
>
>   This is not to say that multiple processes would not also be a good
> solution, just that it might be a harder one to implement.  If you do end
> up looking at multiple processes, reactor.spawnProcess() (as glyph alluded
> to earlier) is one way to go about it.  This is basically the equivalent of
> popen2() (though with a lot more flexibility).

I think a mixture of both might be the best approach. Having several processes 
would be great for MP machines, so one has the ability to scale on a hardware 
basis. Making more intelligent use of threads could increase responsiveness. 
One user is fine wating  for something to happen, but all the others 
shouldn't have to wait for the one user too.

>   On a related, but not necessarily useful note, I've recently begun
> investigating ways of moving the state associated with a user request,
> including the associated socket object, between processes.  My use case is
> not load-balancing, but the code should apply equally well to this as to
> what I intend to use it for.  It requires C extensions (which are currently
> -just- good enough to play around with higher-level stuff in Python with).
> The code is very short, and lives mostly in
> sandbox/exarkun/copyover/fdpass.py in CVS HEAD.

I'll check that out. I wouldn't name it load-balancing. Would be interesting 
though to check if one could have a single "socket server" that distributes 
to several processes on several machines :-) For an application like mine 
load balancing might be much easier, since I could make the clients reconnect 
to a different server/port.

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qTq3jqGXBvRToM4RAsd8AJ9Xme37KfYCxT+ls4SNOAQrzZTi8gCeK42C
Lwf/hmo+TRp/ulHAA49I3Ck=
=W66T
-----END PGP SIGNATURE-----




From maoy at cis.upenn.edu  Wed Nov  5 14:57:29 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 5 Nov 2003 16:57:29 -0500 (EST)
Subject: [Twisted-Python] rpm package for twisted?
In-Reply-To: <200311051000.23748.uwe@oss4u.com>
Message-ID: <Pine.LNX.4.44.0311051655460.27564-100000@klondike.cis.upenn.edu>

Hi, I found twisted package for debian in the official site. Is there a 
ready rpm package for twisted 1.1.0 release? thanks!

Yun






From alexander.winston at comcast.net  Wed Nov  5 15:35:01 2003
From: alexander.winston at comcast.net (Alexander Winston)
Date: Wed, 05 Nov 2003 17:35:01 -0500
Subject: [Twisted-Python] rpm package for twisted?
In-Reply-To: <Pine.LNX.4.44.0311051655460.27564-100000@klondike.cis.upenn.edu>
References: 	 <Pine.LNX.4.44.0311051655460.27564-100000@klondike.cis.upenn.edu>
Message-ID: <1068071701.2980.1.camel@shock>

On Wed, 2003-11-05 at 16:57, Yun Mao wrote:
> Hi, I found twisted package for debian in the official site. Is there a 
> ready rpm package for twisted 1.1.0 release? thanks!

They are not distributed as far as I know, but the .spec file
(Twisted/admin/twisted.spec) should produce RPMs without trouble.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031105/494e7c39/attachment.sig>

From mailinglists at shechen.at  Wed Nov  5 16:13:06 2003
From: mailinglists at shechen.at (stephan)
Date: Wed, 05 Nov 2003 15:13:06 -0800
Subject: [Twisted-Python] request getUser()/getPassword() in Woven and resources...
In-Reply-To: <6.0.0.22.0.20031030154614.01e1f788@anusf.anu.edu.au>
References: <6.0.0.22.0.20031030154614.01e1f788@anusf.anu.edu.au>
Message-ID: <oprx6tf4klwzeeq5@mail.geekmail.cc>

My question goes along the previous one in this thread.
How do you get the browser to prompt for a username and password?
My code is not woking and goes something like this: On every page request 
a certain function is called, say genpage()...

def genpage(request)
     request.getUser()
     request.getPassword()

     return "hello world"


-> Browser does not prompt though. (And this does not even involve woven)

_stephan



On Thu, 30 Oct 2003 15:52:32 +1100, Stuart Hungerford 
<stuart.hungerford at anu.edu.au> wrote:

> Hi all,
>
> I've had a twisted web application running for a while that
> uses request.getUser() and request.getPassword() in a
> resource subclass render() method to make the web browser
> prompt for a username/password.
>
> I've been refactoring this application to use Woven page
> subclasses and the same request.getFoo() calls now
> return empty strings rather than None, and no prompting
> from the browser is done.
>
> Is there some gotcha in using request.getUser() and
> request.getPassword() from Woven page subclasses?
>
>
> Cheers,
>
> Stu
>
> --
> :: Stuart Hungerford (stuart.hungerford at anu.edu.au)
> :: ANU Internet Futures Group
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python





From obowah at yahoo.com  Wed Nov  5 21:00:17 2003
From: obowah at yahoo.com (rddda)
Date: Wed, 5 Nov 2003 20:00:17 -0800 (PST)
Subject: [Twisted-Python] smtp server
Message-ID: <20031106040017.72048.qmail@web10707.mail.yahoo.com>

new to twisted. can't figure how to set up smtp server. is there doc somewhere for Twisted.Mail?
i will try searching archive next


---------------------------------
Do you Yahoo!?
Protect your identity with Yahoo! Mail AddressGuard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031105/f96d303a/attachment.html>

From sam at twistedmatrix.com  Thu Nov  6 09:45:55 2003
From: sam at twistedmatrix.com (Sam Jordan)
Date: Fri, 7 Nov 2003 02:45:55 +1000
Subject: [Twisted-Python] SelectReactor, readers and writers
Message-ID: <20031106164555.GA16990@psychlaw.com.au>

Hi,

While looking at the code for the default SelectReactor I noticed
that the selectables are stored in the form {object : 1, ...}.
Is there any particular reason they're not stored in the format:
{ fd : object, ...}? A couple I can think of are that duplicate
file-descriptors would cause problems (which they currently most
likely would anyway) and objects which return different values from
fileno based on context would no longer work correctly -- are either
of these use-cases valid?

The reason i'm bringing this up is because since 2.3 (I think) calls
to socket.fileno are wrapped in a python function (as defined in
socket.py) which I assume, when called in a tight loop over a large
number of objects may result in a bottleneck (I certainly remember
profiling code in the past where this was the case).
This could be alleviated by passing a sequence of integers to select
instead of the connection objects themselves.

It could be that i'm missing something, or it could also be that this
has never come up because until a short time ago socket.fileno was, of
course, a C function :-).

Another thing to think about for the future is that on September 10
selectmodule.c was changed so that select.select now supports any
sequence. Currently SelectReactor makes a list from the readers
and writers dictionary (calling dict.keys()) every iteration -- of
course this is likely to remain the same for a while considering
the need for backwards compatibility and i'm not even sure if the
patch has been backported to 2.3 yet (unlikely since my 2.3.2 is
dated Oct 6 and it does not exhibit this behaviour). Still,
it's interesting to note for the future.

Cheers,

Sam.



From john.abel at pa.press.net  Thu Nov  6 00:35:13 2003
From: john.abel at pa.press.net (John Abel)
Date: Thu, 06 Nov 2003 07:35:13 +0000
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
Message-ID: <3FA9F9B1.9050202@pa.press.net>

Hi!

I noticed a couple of posts about 1.1rc's failing to build on Win32, due 
to the the installer not being able to find certain files (rpc.h, and 
portmap.h), but I've not seen any updates.  This problem still exists 
with 1.1.  Is there a way round it?  Or, do I need to create a bug 
report for it?

Regards

John




From syver at inout.no  Thu Nov  6 02:23:07 2003
From: syver at inout.no (Syver Enstad)
Date: 06 Nov 2003 10:23:07 +0100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <3FA9F9B1.9050202@pa.press.net>
References: <3FA9F9B1.9050202@pa.press.net>
Message-ID: <u65hxsves.fsf@inout.no>

John Abel <john.abel at pa.press.net> writes:

> Hi!
> 
> I noticed a couple of posts about 1.1rc's failing to build on Win32,
> due to the the installer not being able to find certain files (rpc.h,
> and portmap.h), but I've not seen any updates.  This problem still
> exists with 1.1.  Is there a way round it?  Or, do I need to create a
> bug report for it?

Comment out the section that tries to compile the extension needing
rpc.h in setup.py (That's what I did). Just subsititute the test that
tries to find out if rpc.h is available with False so that the branch
is never entered.

Also when you get the build to work the twisted.scripts.twistdw.py
script is broken, fix it by looking at twistd.py.





From radix at twistedmatrix.com  Thu Nov  6 04:13:05 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 6 Nov 2003 12:13:05 +0100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <u65hxsves.fsf@inout.no>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no>
Message-ID: <20031106111305.GA899@twistedmatrix.com>

On Thu, Nov 06, 2003 at 10:23:07AM +0100, Syver Enstad wrote:
> John Abel <john.abel at pa.press.net> writes:
> 
> > Hi!
> > 
> > I noticed a couple of posts about 1.1rc's failing to build on Win32,
> > due to the the installer not being able to find certain files (rpc.h,
> > and portmap.h), but I've not seen any updates.  This problem still
> > exists with 1.1.  Is there a way round it?  Or, do I need to create a
> > bug report for it?
> 
> Comment out the section that tries to compile the extension needing
> rpc.h in setup.py (That's what I did). Just subsititute the test that
> tries to find out if rpc.h is available with False so that the branch
> is never entered.
> 
> Also when you get the build to work the twisted.scripts.twistdw.py
> script is broken, fix it by looking at twistd.py.

Can you please report these bugs to the tracker, if they aren't
already?

http://twistedmatrix.com/bugs/


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From john at landahl.org  Wed Nov  5 02:35:29 2003
From: john at landahl.org (John Landahl)
Date: Wed, 05 Nov 2003 01:35:29 -0800
Subject: [Twisted-Python] MANIFEST.in for RPMs
Message-ID: <oprx5rlf08k1a6kk@sfmail3>

If anyone has an interest in using the bdist_rpm option with setup.py to 
build Twisted RPMs, the MANIFEST.in file needs the following additions:

     include twisted/runner/portmap.c
     include twisted/protocols/_c_urlarg.c
     include twisted/lore/template.mgp
     include twisted/web/woven/FlashConduit*
     include twisted/web/woven/WebConduit*
     include twisted/test/process.alias.sh*
     include twisted/test/rfc822.message
     include twisted/test/server.pem

Also, for a Twisted installation that works with any installed version of 
Python (e.g. 2.2 and 2.3), you can install Twisted to /usr/lib/site-python 
by adding these lines to setup.cfg:

     [install]
     install-lib = /usr/lib/site-python

/usr/lib/site-python seems far more convenient than 
/usr/lib/pythonX/site-packages, don't know why it isn't the default.

John Landahl
john at landahl.org



From tv at tv.debian.net  Wed Nov  5 09:05:52 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Wed, 05 Nov 2003 18:05:52 +0200
Subject: [Twisted-Python] Woven web question about clearing http request.args
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FC@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FC@EMSS07M12.us.lmco.com>
Message-ID: <3FA91FE0.20803@tv.debian.net>

Hegedus, Matthew S wrote:
> I've got multiple input buttons and their view is the same logic. The logic
> is delete some data on a button press, then rerender the page with the
> updated data. The data it will remove depends on the unique ID of the button
> pressed.  When the web page is rerendered the view gets called for each
> button with the same http request, so the deletion logic will be evaluated
> for each button, even though it should be evaluated for just the button that
> was pressed. I don't like that. I want to clear request.args so the behavior
> will be as if there was only one http event, corresponding to a single
> button press. I tried "request.args.clear()", but that doesn't seem to have
> the expected effect.

The view factory is called once per use of that view in the template.
If you use the view for three buttons, your view factory gets called 
three times. Whether there were any button presses or not.

Maybe you should move your "delete" logic from the view to the render 
method, or to a model that is used only once in the template. That is 
only called once per request, and is a logical place to do some processing.

> What's worse is when I click the browser's reload button, request.args still
> has the last http request that occurred. In other words, if I click my
> delete button the page will be rerendered with updated data, then if I click
> the browser's reload it will try to delete more data as if I had hit on of
> my delete buttons again. Can anyone help me with this problem?

You should use a POST method for submitting the form; then the browser 
is not allowed to just resend the request without confirming the action 
from the user.




From tv at tv.debian.net  Wed Nov  5 09:14:08 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Wed, 05 Nov 2003 18:14:08 +0200
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311041019.31926.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com>
Message-ID: <3FA921D0.10701@tv.debian.net>

Uwe C. Schroeder wrote:
> is there a way to have one service start several processes ?
> When using twisted everyone connecting to the server ends in the same process. 
> This leads to "slowing down" when requesting information whenever a certain 
> number of people go on. Each request takes some time to process and meanwhile 
> the server is less responsive. I have one particularly expensive function 
> that takes a bit. So if several people happen to use this function at a time 
> the server slows down, up to where it takes a minute to complete.
> It's not a problem of system ressources (it's a quad processor xeon server 
> with plenty of RAM and ultra 320 scsi drives running only this application 
> and the postgres backend). The machine has a load of 0.2 while slowing down.
> Basically most of the machine is idle, since it only runs 2 processes and has 
> 4 processors.

You should look at having a pool of worker _processes_, to which you 
dispatch work with pb.

Not threads, as python threading will not really scale, and there's 
really no point in threading if the amount of input/output to the worker 
is small enough (shared mem has its good and bad sides).

> Is there a way to have twisted do something like apache or postgres and split 
> the incoming connection to several processes ? It's not a web application, 
> I'm solely using pb.

If you listen in a parent process, fork multiple children, and make the 
children accept, unix does the right thing. I don't think Twisted knows 
how to do that out of the box, but it should be doable.

That's assuming you don't need (much) shared data between the children.

> BTW: You might suggest to break down the expensive function into smaller 
> pieces - no way. It has to run in one database transaction otherwise I might 
> end up with a inconsistent database - no good in finance business.

If you are lucky, you can find a threading DB library (adbapi) that 
actually scales. The other mail in this thread are more helpful there..




From vlupien at drummonddesigns.com  Thu Nov  6 07:26:00 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 6 Nov 2003 09:26:00 -0500
Subject: [Twisted-Python] Deferred problem
Message-ID: <000001c3a471$e6b30ee0$687ba8c0@vicky>

I know that I'd already post a message about deferred but I think I
haven't understand very well.
 
I have a function that is suppose to return a new dictionnary but it
returns a deferred.
 
 
class MainPage(pages.BasePage):
    templateFile = "main.html"
  
    def initialize(self, dbpool=None):
        self.dbpool = dbpool
    
    def setUp(self, request, *args):
        var = self.initPermissions(request)      #var is suppose to get
the new list
        print var
 
    def wmfactory_welcome(self, request):
        return "Bienvenue, %s" %
request.getComponent(myguard.Authenticated).name
 
    def initPermissions(self, request):       #create and return the
results of a sql query
        group = request.getComponent(myguard.Authenticated).group
        listGroup = group.split(',')
        sql = "select permission from permissions where 1"
        for item in listGroup:
            sql += " or permissions.group='%s'" % item.lstrip()
        theDeferred = self.dbpool.runQueryDict(sql)
        return theDeferred.addCallback(self.makeDict)        # suppose
to call makeDict when the results has arrived
 
    def makeDict(self, results):
            # when I print what is in results, I can see all the data
from the sql query
        listPermissions = []
        for item in results:
            listPermissions.append(item.get('permission'))
        return listPermissions                   # return the new list
but the function setUp receive a deferred
 
 
I've put some comments in the code to help you understand what I want.
The big problem is that var receive a deferred and not the new list
 
Vicky
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031106/b04cf941/attachment.html>

From glyph at twistedmatrix.com  Thu Nov  6 08:08:02 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 06 Nov 2003 10:08:02 -0500
Subject: [Twisted-Python] MANIFEST.in for RPMs
In-Reply-To: <oprx5rlf08k1a6kk@sfmail3>
References: <oprx5rlf08k1a6kk@sfmail3>
Message-ID: <3FAA63D2.6010204@twistedmatrix.com>

John Landahl wrote:
> If anyone has an interest in using the bdist_rpm option with setup.py to 
> build Twisted RPMs, the MANIFEST.in file needs the following additions:

Please enter this as a bug in the tracker, hopefully with a patch?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 256 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031106/da28d687/attachment.sig>

From itamar at itamarst.org  Thu Nov  6 08:17:21 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 06 Nov 2003 10:17:21 -0500
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <3FA9F9B1.9050202@pa.press.net>
References: <3FA9F9B1.9050202@pa.press.net>
Message-ID: <3FAA6601.90401@itamarst.org>

John Abel wrote:

> I noticed a couple of posts about 1.1rc's failing to build on Win32, due 
> to the the installer not being able to find certain files (rpc.h, and 
> portmap.h), but I've not seen any updates.  This problem still exists 
> with 1.1.  Is there a way round it?  Or, do I need to create a bug 
> report for it?

Cory managed to build win32 exes from 1.1 - they are available from our 
download site...

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting




From itamar at itamarst.org  Thu Nov  6 08:19:13 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 06 Nov 2003 10:19:13 -0500
Subject: [Twisted-Python] MANIFEST.in for RPMs
In-Reply-To: <oprx5rlf08k1a6kk@sfmail3>
References: <oprx5rlf08k1a6kk@sfmail3>
Message-ID: <3FAA6671.9010806@itamarst.org>

John Landahl wrote:

> If anyone has an interest in using the bdist_rpm option with setup.py to 
> build Twisted RPMs, the MANIFEST.in file needs the following additions:

Thanks. I should note however that the recommeded way of building RPMs 
is using admin/twisted.spec.

> Also, for a Twisted installation that works with any installed version 
> of Python (e.g. 2.2 and 2.3), you can install Twisted to 
> /usr/lib/site-python by adding these lines to setup.cfg:
> 
>     [install]
>     install-lib = /usr/lib/site-python
> 
> /usr/lib/site-python seems far more convenient than 
> /usr/lib/pythonX/site-packages, don't know why it isn't the default

Because it's wrong. Twisted has C extensions, and those are specific to 
the version of Python used to compile Twisted.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting




From glyph at twistedmatrix.com  Thu Nov  6 08:49:26 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 06 Nov 2003 10:49:26 -0500
Subject: [Twisted-Python] MANIFEST.in for RPMs
In-Reply-To: <3FAA6671.9010806@itamarst.org>
References: <oprx5rlf08k1a6kk@sfmail3> <3FAA6671.9010806@itamarst.org>
Message-ID: <3FAA6D86.4020802@twistedmatrix.com>

Itamar Shtull-Trauring wrote:
> John Landahl wrote:

>> /usr/lib/site-python seems far more convenient than 
>> /usr/lib/pythonX/site-packages, don't know why it isn't the default
> 
> 
> Because it's wrong. Twisted has C extensions, and those are specific to 
> the version of Python used to compile Twisted.

Even without C, the bytecodes generated for the installed .pyc files are 
different between python versions.




From bob at redivi.com  Thu Nov  6 09:35:32 2003
From: bob at redivi.com (Bob Ippolito)
Date: Thu, 6 Nov 2003 11:35:32 -0500
Subject: [Twisted-Python] MANIFEST.in for RPMs
In-Reply-To: <3FAA6D86.4020802@twistedmatrix.com>
References: <oprx5rlf08k1a6kk@sfmail3> <3FAA6671.9010806@itamarst.org> <3FAA6D86.4020802@twistedmatrix.com>
Message-ID: <3D71C092-1077-11D8-B3CD-000A95686CD8@redivi.com>

On Nov 6, 2003, at 10:49 AM, Glyph Lefkowitz wrote:

> Itamar Shtull-Trauring wrote:
>> John Landahl wrote:
>
>>> /usr/lib/site-python seems far more convenient than 
>>> /usr/lib/pythonX/site-packages, don't know why it isn't the default
>> Because it's wrong. Twisted has C extensions, and those are specific 
>> to the version of Python used to compile Twisted.
>
> Even without C, the bytecodes generated for the installed .pyc files 
> are different between python versions.

That python will try and import every time, and if you don't have the 
same python version installed it will recompile them every run.. and 
not be able to save them for permissions reason.

-bob




From MCStoufer at lbl.gov  Thu Nov  6 09:53:08 2003
From: MCStoufer at lbl.gov (Martin Stoufer)
Date: Thu, 06 Nov 2003 08:53:08 -0800
Subject: [Twisted-Python] Form model examples
Message-ID: <3FAA7C74.6090200@lbl.gov>

I noticed that the Form model document page 
(http://www.twistedmatrix.com/documents/howto/formindepth) had not been 
put up yet. Does anyone out there have any working examples that uses 
this or has some more info on the twisted.web.woven.form 
<http://www.twistedmatrix.com/documents/TwistedDocs/current/api/toc-twisted.web.woven.form.html> 
class? Furthermore, if I can get enough knowledge on this, I would be 
happy to help contribute to the formindepth page.


-- 
* Martin C. Stoufer              *
* MCStoufer at lbl.gov              *
* DIDC/DSD/ITG                   *
* Lawrence Berkeley National Lab *
* MS 50B-2215 510-486-6882       *





-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031106/2cda0e4a/attachment.html>

From dp at twistedmatrix.com  Thu Nov  6 11:40:15 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Thu, 6 Nov 2003 13:40:15 -0500
Subject: [Twisted-Python] Form model examples
In-Reply-To: <3FAA7C74.6090200@lbl.gov>
References: <3FAA7C74.6090200@lbl.gov>
Message-ID: <A9A0F792-1088-11D8-ABCC-000A95864FC4@twistedmatrix.com>


On Nov 6, 2003, at 11:53 AM, Martin Stoufer wrote:

> I noticed that the Form model document page 
> (http://www.twistedmatrix.com/documents/howto/formindepth) had not 
> been put up yet. Does anyone out there have any working examples that 
> uses this or has some more info on thetwisted.web.woven.formclass? 
> Furthermore, if I can get enough knowledge on this, I would be happy 
> to help contribute to the formindepth page.

Handling form input in a way which is both very abstract and easy for 
the programmer to use without a lot of edge cases has turned out to be 
very difficult. As you may have heard, 'nevow' is the name of a new 
exploratory implementation of the woven ideas which will eventually 
become woven 2.0.  One of the goals of nevow is to take the ideas 
originally explored in twisted.python.formmethod and 
twisted.web.woven.form and re-implement them so they are cleaner, 
easier to use and extend, and have fewer edge cases. The new, 
in-development modules are nevow.formless and nevow.freeform.

Formless is a module which allows you to annotate object properties and 
method parameters with types (By declaring that the 'foo' property is a 
String, and the "bar" method takes two Integers, for example). Freeform 
is a module which uses this type information to automatically render 
forms on the web, perform input validation and form error rendering, 
and ultimately call methods on your objects or set properties on your 
objects.

I am at this very moment doing a lot of freeform development, so now 
would be a good time to raise your use cases, your expectations about 
using a system which renders and validates web forms, etc.

A good place to contact me is in #twisted on irc.openprojects.net. My 
nick is fzZzy.

dp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: text/enriched
Size: 1841 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031106/eb2f8d0c/attachment-0002.bin>

From MCStoufer at lbl.gov  Thu Nov  6 13:56:41 2003
From: MCStoufer at lbl.gov (Martin Stoufer)
Date: Thu, 06 Nov 2003 12:56:41 -0800
Subject: [Twisted-Python] Form model examples
In-Reply-To: <A9A0F792-1088-11D8-ABCC-000A95864FC4@twistedmatrix.com>
References: <3FAA7C74.6090200@lbl.gov> <A9A0F792-1088-11D8-ABCC-000A95864FC4@twistedmatrix.com>
Message-ID: <3FAAB589.6040804@lbl.gov>

 >>I am at this very moment doing a lot of freeform development, so now 
would be a good >>time to raise your use cases, your expectations about 
using a system which renders and >>validates web forms, etc.

I have been put in the unfortunate position of having to 'renovate' a 
lot of existing WebKit oriented CGI scripts. As you would surmise, they 
are a complete failure wrt OO design.

The main use case for me is to generate a form that in itself sets the 
constraints, and thus not requiring much input validation. All the 
scripts I have to deal with present varying views into a DB. Without 
delving into the schema makes it hard to convey what I need.

I guess all I was looking for with Woven was some OO based mechanism to 
build a form w/o all the wvfactory and wmfactory methods for each form 
'widget'

I will take a look at Formless and see how far that gets me.

Thanks for your time!

>
> A good place to contact me is in #twisted on irc.openprojects.net. My 
> nick is fzZzy.
>
> dp
>
>

-- 
* Martin C. Stoufer              *
* MCStoufer at lbl.gov              *
* DIDC/DSD/ITG                   *
* Lawrence Berkeley National Lab *
* MS 50B-2215 510-486-6882       *









From andrew-twisted at puzzling.org  Thu Nov  6 17:49:19 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 7 Nov 2003 11:49:19 +1100
Subject: [Twisted-Python] Deferred problem
In-Reply-To: <000001c3a471$e6b30ee0$687ba8c0@vicky>
References: <000001c3a471$e6b30ee0$687ba8c0@vicky>
Message-ID: <20031107004918.GA16498@frobozz>

On Thu, Nov 06, 2003 at 09:26:00AM -0500, vicky lupien wrote:

[reordered slightly]
> 
>        def initPermissions(self, request):       #create and return the results of a sql query
>            group = request.getComponent(myguard.Authenticated).group
>            listGroup = group.split(',')
>            sql = "select permission from permissions where 1"
>            for item in listGroup:
>                sql += " or permissions.group='%s'" % item.lstrip()
>            theDeferred = self.dbpool.runQueryDict(sql)
>            return theDeferred.addCallback(self.makeDict)        # suppose to call makeDict when the results has arrived
> 
> 
>        def makeDict(self, results):
>                # when I print what is in results, I can see all the data from the sql query
>            listPermissions = []
>            for item in results:
>                listPermissions.append(item.get('permission'))
>            return listPermissions                   # return the new list but the function setUp receive a deferred
> 
>        def setUp(self, request, *args):
>            var = self.initPermissions(request)      #var is suppose to get the new list
>            print var

setUp is receiving a Deferred from self.initPermissions, but then doesn't
wait for its result to arrive.  You should instead do something more like:

        def setUp(self, request, *args):
            d = self.initPermissions(request)
            def printVar(var):
                print var
            d.addCallback(printVar)

Although ideally you should add an errback too, even if it is just
twisted.python.log.err.

(I don't know how this will interact with the rest of Woven, but hopefully
I've clarified how you should be using Deferreds a little)

-Andrew.




From cce at clarkevans.com  Thu Nov  6 19:14:54 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Thu, 6 Nov 2003 21:14:54 -0500
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <200311050932.23119.uwe@oss4u.com>
References: <200311041019.31926.uwe@oss4u.com> <200311050248.07658.uwe@oss4u.com> <20031105103119.2695e083.itamar@itamarst.org> <200311050932.23119.uwe@oss4u.com>
Message-ID: <20031107021454.GA8402@clarkevans.com>

On Wed, Nov 05, 2003 at 09:32:23AM -0800, Uwe C. Schroeder wrote:
| > (3. Don't use RDBMS. Use an in-process database like ZODB or Quotient's
| > atop when it's done.)
| 
| :-) I'd probably do that with a web application, but even there I'll allways 
| prefer a "real" database system. In process databases may be faster, therefor 
| they are less relieable and correcting errors is a virtual impossibility.

If you are using PostgreSQL, Gerhard Haring has reportedly
made the async interface work,
http://sourceforge.net/mailarchive/message.php?msg_id=2688514

Clark



From uwe at oss4u.com  Thu Nov  6 21:22:14 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Thu, 6 Nov 2003 20:22:14 -0800
Subject: [Twisted-Python] Scaling problem
In-Reply-To: <20031107021454.GA8402@clarkevans.com>
References: <200311041019.31926.uwe@oss4u.com> <200311050932.23119.uwe@oss4u.com> <20031107021454.GA8402@clarkevans.com>
Message-ID: <200311062022.14143.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Thursday 06 November 2003 06:14 pm, Clark C. Evans wrote:
> On Wed, Nov 05, 2003 at 09:32:23AM -0800, Uwe C. Schroeder wrote:
> | > (3. Don't use RDBMS. Use an in-process database like ZODB or Quotient's
> | > atop when it's done.)
> | >
> | :-) I'd probably do that with a web application, but even there I'll
> | : allways
> |
> | prefer a "real" database system. In process databases may be faster,
> | therefor they are less relieable and correcting errors is a virtual
> | impossibility.
>
> If you are using PostgreSQL, Gerhard Haring has reportedly
> made the async interface work,
> http://sourceforge.net/mailarchive/message.php?msg_id=2688514

Good link. I might start using that for some things.
For now I solved the scaling issue with an (more or less) ugly workaround. 
Since I'm using pb with  dedicated client software I made the logon a 2 step. 
The first step connects to a certain port and gets an IP-address and a port 
back. The server determines which process has the least number of clients 
connected and returns that address. That's where the client then connects for 
real work. So I now just have a bunch of twisted's running on different ports 
- - works nicely for a quickhack.
But in the long run I'll definitely have to do something about the database 
and automatic forking of more server processes.

	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/qx32jqGXBvRToM4RAmO+AJ97aLqBOO/LLNKd/Q8b3cLNAGOJWQCfZPeg
q1IHghLYQccuWpZISYhQ8+4=
=eY6H
-----END PGP SIGNATURE-----




From mailinglists at shechen.at  Fri Nov  7 01:51:55 2003
From: mailinglists at shechen.at (stephan)
Date: Fri, 07 Nov 2003 00:51:55 -0800
Subject: [Twisted-Python] sessions example
Message-ID: <oprx9ewtrswzeeq5@mail.geekmail.cc>

Just by reading the API doc I somehow cannot figure out how to use session 
in the twisted webserver. Would anybody be so kind and give my a short 
example of how to create a session, store some objects in it and then 
retrive the same session again.

That would be very helpful, thanks,

_stephan



From syver at inout.no  Fri Nov  7 03:05:18 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 11:05:18 +0100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <20031106111305.GA899@twistedmatrix.com>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no>
	<20031106111305.GA899@twistedmatrix.com>
Message-ID: <u7k2cqysh.fsf@inout.no>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> Can you please report these bugs to the tracker, if they aren't
> already?

Done.





From syver at inout.no  Fri Nov  7 03:12:13 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 11:12:13 +0100
Subject: [Twisted-Python] sessions example
In-Reply-To: <oprx9ewtrswzeeq5@mail.geekmail.cc>
References: <oprx9ewtrswzeeq5@mail.geekmail.cc>
Message-ID: <u3cd0qygy.fsf@inout.no>

stephan <mailinglists at shechen.at> writes:

> Just by reading the API doc I somehow cannot figure out how to use
> session in the twisted webserver. Would anybody be so kind and give my
> a short example of how to create a session, store some objects in it
> and then retrive the same session again.

class Foo:
    def doStuff(self):
        ....

You have to have the request.

session = request.getSession()
session.foo = Foo()

Now later in your application you can do:

foo = session.foo
foo.doStuff()

If you use the twisted web server for more than one logical
application you should probably do something like this.

class MyApplicationSession:
   .....

session = request.getSession()

session.sessions = {}

session.sessions[MyApplicationSession] = MyApplicationSession()

And something similar but another class for other applications.




 




From syver at inout.no  Fri Nov  7 05:30:26 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 13:30:26 +0100
Subject: [Twisted-Python] pb help needed.
Message-ID: <ullqspdi5.fsf@inout.no>

I have a bug in my woven application which manifests itself as
win32select failing after doing many http requests. The error is the
constant WSAENOBUFS and I it seems pretty likely that this is caused
by some socket related resource leaking for each request I make. This
hypothesis is further supported by observing that a host of
pb.ClientFactory instances are stopped when shutting down the
application after it crashes. This seems strange to me as I am
thorough in shutting down the connector after every request is
finished.

Turning to that trusty friend printf style debugging, shows that the
PBClientFactory is stopped correctly when performing requests to pages
that use the referenceable and wait for it's deferred's to
complete. There are two cases when it doesn't stop. 

The first is when I press reload quickly a number of times. Then I
just see start messages because my request finish method is not called
(it is a callback to the deferred returned by request.notifyFinish()).

The second case is when I call disconnect on the connector before it's
deferred has been realised. I see in the log the following pattern:
Starting pb.PBClientFactory, disconnect and then the attached event,
stopping factory is not called at all. After stepping I see that
disconnect doesn't do anything when it is called before the connection
has been realized.

So I have a bug, and it's in my code. My question is how does one
manage pb resources correctly and easily (I don't worry about
performance just yet) when each user needs to have it's own
connection?










From syver at inout.no  Fri Nov  7 06:43:51 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 14:43:51 +0100
Subject: [Twisted-Python] pb help needed.
In-Reply-To: <ullqspdi5.fsf@inout.no>
References: <ullqspdi5.fsf@inout.no>
Message-ID: <uznf8nvjc.fsf@inout.no>

Syver Enstad <syver at inout.no> writes:

> I have a bug in my woven application which manifests itself as
> win32select failing after doing many http requests. The error is the
> constant WSAENOBUFS and I it seems pretty likely that this is caused
> by some socket related resource leaking for each request I make. This
> hypothesis is further supported by observing that a host of
> pb.ClientFactory instances are stopped when shutting down the
> application after it crashes. This seems strange to me as I am
> thorough in shutting down the connector after every request is
> finished.
> 
> Turning to that trusty friend printf style debugging, shows that the
> PBClientFactory is stopped correctly when performing requests to pages
> that use the referenceable and wait for it's deferred's to
> complete. There are two cases when it doesn't stop. 
> 
> The first is when I press reload quickly a number of times. Then I
> just see start messages because my request finish method is not called
> (it is a callback to the deferred returned by request.notifyFinish()).
> 
> The second case is when I call disconnect on the connector before it's
> deferred has been realised. I see in the log the following pattern:
> Starting pb.PBClientFactory, disconnect and then the attached event,
> stopping factory is not called at all. After stepping I see that
> disconnect doesn't do anything when it is called before the connection
> has been realized.
> 
> So I have a bug, and it's in my code. My question is how does one
> manage pb resources correctly and easily (I don't worry about
> performance just yet) when each user needs to have it's own
> connection?

Here is what I have come up with so far. It doesn't solve the problem
where I don't get the request finish callback, but seems to be able to
disconnect even if not connected when disconnect is called.

class MyPBClientFactory(pb.PBClientFactory):
    def disconnect(self):
        if not self._broker:
            deferred = self.getRootObject()
            deferred.addCallback(
                lambda unused: pb.PBClientFactory.disconnect(self))
        else:
            pb.PBClientFactory.disconnect(self)





From syver at inout.no  Fri Nov  7 10:20:08 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Nov 2003 18:20:08 +0100
Subject: [Twisted-Python] pb help needed.
In-Reply-To: <uznf8nvjc.fsf@inout.no>
References: <ullqspdi5.fsf@inout.no> <uznf8nvjc.fsf@inout.no>
Message-ID: <ufzh0nliv.fsf@inout.no>

Syver Enstad <syver at inout.no> writes:

> Syver Enstad <syver at inout.no> writes:
> 
> > I have a bug in my woven application which manifests itself as
> > win32select failing after doing many http requests. The error is the
> > constant WSAENOBUFS and I it seems pretty likely that this is caused
> > by some socket related resource leaking for each request I make. This
> > hypothesis is further supported by observing that a host of
> > pb.ClientFactory instances are stopped when shutting down the
> > application after it crashes. This seems strange to me as I am
> > thorough in shutting down the connector after every request is
> > finished.
> > 
> > Turning to that trusty friend printf style debugging, shows that the
> > PBClientFactory is stopped correctly when performing requests to pages
> > that use the referenceable and wait for it's deferred's to
> > complete. There are two cases when it doesn't stop. 
> > 
> > The first is when I press reload quickly a number of times. Then I
> > just see start messages because my request finish method is not called
> > (it is a callback to the deferred returned by request.notifyFinish()).
> > 
> > The second case is when I call disconnect on the connector before it's
> > deferred has been realised. I see in the log the following pattern:
> > Starting pb.PBClientFactory, disconnect and then the attached event,
> > stopping factory is not called at all. After stepping I see that
> > disconnect doesn't do anything when it is called before the connection
> > has been realized.
> > 
> > So I have a bug, and it's in my code. My question is how does one
> > manage pb resources correctly and easily (I don't worry about
> > performance just yet) when each user needs to have it's own
> > connection?
> 
> Here is what I have come up with so far. It doesn't solve the problem
> where I don't get the request finish callback, but seems to be able to
> disconnect even if not connected when disconnect is called.
> 
> class MyPBClientFactory(pb.PBClientFactory):
>     def disconnect(self):
>         if not self._broker:
>             deferred = self.getRootObject()
>             deferred.addCallback(
>                 lambda unused: pb.PBClientFactory.disconnect(self))
>         else:
>             pb.PBClientFactory.disconnect(self)

Since the last post I moved to a persistent PBClientFactory so that
disconnects is not a problem. This fixes the crashes, but there are
still resources that are not released. I only see perspective attached
messages in the log, until I kill twistd when I get a host of detached
messages. My next question must be how do I detach the perspectives in
an orderly fashion after each request? This seems to run into the same
problems as I had with not being able to do cleanup for each request.





From lafou at wanadoo.fr  Fri Nov  7 10:22:36 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 07 Nov 2003 18:22:36 +0100
Subject: [Twisted-Python] twistd and woven restart
Message-ID: <1068225756.7190.5.camel@pcmarie>

Hi,

I'm playing with woven and twistd. Every time I change something, I have
to stop the server, and start it again (except for HTML changes in
templates). Am I doing something wrong ? This is very painful to restart
every time !

I'd love to see a deploy tool like a j2ee application server (you would
just put your tap in the deploy environnement, and the app server loads
it automatically). There was such a tool before in twisted, but it was
removed :( (can't remember the name).

thx for advice !

--
Phil




From lafou at wanadoo.fr  Fri Nov  7 10:30:16 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 07 Nov 2003 18:30:16 +0100
Subject: [Twisted-Python] Woven broken by exceptions
Message-ID: <1068226216.7191.8.camel@pcmarie>

Hi,


when Woven (or twistd) catch exceptions like that :

exceptions.Exception: Node had a model=rootURL attribute, but the
submodel was not found in [<__builtin__.PGAT_Index instance at
0x8488ec4>].

I can't access any pages of the site. I have to restart the whole
service ! Is it normal ? (means that is there's a bug on a site, the
whole site will crash down)
:(




From MCStoufer at lbl.gov  Fri Nov  7 11:40:39 2003
From: MCStoufer at lbl.gov (Martin Stoufer)
Date: Fri, 07 Nov 2003 10:40:39 -0800
Subject: [Twisted-Python] sessions example
In-Reply-To: <oprx9ewtrswzeeq5@mail.geekmail.cc>
References: <oprx9ewtrswzeeq5@mail.geekmail.cc>
Message-ID: <3FABE727.2090107@lbl.gov>

Stephan,
   I found the following link helpful:

http://twistedmatrix.com/documents/howto/picturepile#auto2


stephan wrote:

>
> Just by reading the API doc I somehow cannot figure out how to use 
> session in the twisted webserver. Would anybody be so kind and give my 
> a short example of how to create a session, store some objects in it 
> and then retrive the same session again.
>
> That would be very helpful, thanks,
>
> _stephan
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


-- 
* Martin C. Stoufer              *
* DIDC/DSD/ITG                   *
* Lawrence Berkeley National Lab *
* MS 50B-2215 510-486-8662       *





From corydodt at twistedmatrix.com  Fri Nov  7 12:38:54 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Fri, 07 Nov 2003 11:38:54 -0800
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <u7k2cqysh.fsf@inout.no>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no>	<20031106111305.GA899@twistedmatrix.com> <u7k2cqysh.fsf@inout.no>
Message-ID: <3FABF4CE.5030100@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Syver,

I'm the win32 buildmeister, so I'm looking for this bug to see if I can
reproduce it.  Are you sure you hit "save" on the bug? I can't find it
on any combination of win32, compile, build, windows...

Also, assigning it to me probably wouldn't be a bad thing.

C

Syver Enstad wrote:
| Christopher Armstrong <radix at twistedmatrix.com> writes:
|
|
|>Can you please report these bugs to the tracker, if they aren't
|>already?
|
|
| Done.
|
|
|
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows XP)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/q/TO3A5SrXAiHQcRAqjdAJ0e/7TSVKrJAuinM/VH6gdMSuxShgCffpEF
Hf9aX2cb+QPCOk4abfLw2Vo=
=2G6A
-----END PGP SIGNATURE-----



From andrew-twisted at puzzling.org  Fri Nov  7 19:51:31 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 8 Nov 2003 13:51:31 +1100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <3FABF4CE.5030100@twistedmatrix.com>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no> <20031106111305.GA899@twistedmatrix.com> <u7k2cqysh.fsf@inout.no> <3FABF4CE.5030100@twistedmatrix.com>
Message-ID: <20031108025131.GB17626@frobozz>

On Fri, Nov 07, 2003 at 11:38:54AM -0800, Cory Dodt wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> Syver,
> 
> I'm the win32 buildmeister, so I'm looking for this bug to see if I can
> reproduce it.  Are you sure you hit "save" on the bug? I can't find it
> on any combination of win32, compile, build, windows...
> 
> Also, assigning it to me probably wouldn't be a bad thing.

The twistw bug was submitted, and has already been fixed:
    http://twistedmatrix.com/users/roundup.twistd/twisted/issue389

I see no sign of the build problems in the bug tracker, though.

-Andrew.




From lafou at wanadoo.fr  Sat Nov  8 02:34:47 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sat, 08 Nov 2003 10:34:47 +0100
Subject: [Twisted-Python] API doc
Message-ID: <1068284086.4854.1.camel@pcmarie>

I just discovered the twisted-1.1.0 API doc.
The "Inherited from ..." part are a GREAT idea ! Does it come from
epydoc, or it's twisted related ?




From andrew-twisted at puzzling.org  Sat Nov  8 02:52:44 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 8 Nov 2003 20:52:44 +1100
Subject: [Twisted-Python] API doc
In-Reply-To: <1068284086.4854.1.camel@pcmarie>
References: <1068284086.4854.1.camel@pcmarie>
Message-ID: <20031108095244.GD17626@frobozz>

On Sat, Nov 08, 2003 at 10:34:47AM +0100, Philippe Lafoucrire wrote:
> I just discovered the twisted-1.1.0 API doc.
> The "Inherited from ..." part are a GREAT idea ! Does it come from
> epydoc, or it's twisted related ?

You can thank epydoc for that :)

-Andrew.




From lafou at wanadoo.fr  Sat Nov  8 04:17:08 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sat, 08 Nov 2003 12:17:08 +0100
Subject: [Twisted-Python] API doc
In-Reply-To: <20031108095244.GD17626@frobozz>
References: <1068284086.4854.1.camel@pcmarie>
	 <20031108095244.GD17626@frobozz>
Message-ID: <1068290228.4854.6.camel@pcmarie>

> You can thank epydoc for that :)


this is a great feature :)
thank you epydoc, and thank you Andrew for response





From andrew-twisted at puzzling.org  Sat Nov  8 07:12:50 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 9 Nov 2003 01:12:50 +1100
Subject: [Twisted-Python] Re: [Twisted-commits] make log.err return the thing you pass to it
In-Reply-To: <E1AIRcj-0002Wl-00@wolfwood>
References: <E1AIRcj-0002Wl-00@wolfwood>
Message-ID: <20031108141250.GE17626@frobozz>

On Sat, Nov 08, 2003 at 04:51:25AM -0700, radix CVS wrote:
> Modified files:
> Twisted/twisted/python/log.py 1.52 1.53
> 
> Log message:
> make log.err return the thing you pass to it

Isn't this a fairly significant change to the API?  Now doing
deferred.addErrback(log.err) will log the error, and then log it again when
the deferred is garbage-collected...

I guess it won't actually break anything, just add some confusion to log
files, but what's the new idiom for

    d.addErrback(log.err)   # log and swallow any errors that happened

going to be?

-Andrew.




From glyph at twistedmatrix.com  Sat Nov  8 09:25:59 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 8 Nov 2003 11:25:59 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] make log.err return the thing you pass to it
In-Reply-To: <20031108141250.GE17626@frobozz>
References: <E1AIRcj-0002Wl-00@wolfwood> <20031108141250.GE17626@frobozz>
Message-ID: <3CDD80E8-1208-11D8-B427-000393C9700E@twistedmatrix.com>

On Nov 8, 2003, at 9:12 AM, Andrew Bennetts wrote:

> Isn't this a fairly significant change to the API?

Yes, and an unnecessary one.  Revert it, and add a 'passerr' method, if 
you really need one.




From glyph at twistedmatrix.com  Sat Nov  8 09:30:23 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 8 Nov 2003 11:30:23 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] make log.err return the thing you pass to it
In-Reply-To: <20031108141250.GE17626@frobozz>
References: <E1AIRcj-0002Wl-00@wolfwood> <20031108141250.GE17626@frobozz>
Message-ID: <DA19957B-1208-11D8-B427-000393C9700E@twistedmatrix.com>

I guess somebody else beat me to telling radix to revert :).  Also,

On Nov 8, 2003, at 9:12 AM, Andrew Bennetts wrote:

> I guess it won't actually break anything

Actually, it will break things, as exarkun pointed out on IRC:

	foo.addErrback(log.err).addCallback(cleanup)

will no longer call 'cleanup'.  Totally unnecessary breakage.




From allison at shasta.stanford.edu  Sat Nov  8 09:38:57 2003
From: allison at shasta.stanford.edu (Dennis Allison)
Date: Sat, 8 Nov 2003 08:38:57 -0800 (PST)
Subject: [Twisted-Python] resource recovery on shutdown
In-Reply-To: <3CDD80E8-1208-11D8-B427-000393C9700E@twistedmatrix.com>
Message-ID: <Pine.LNX.4.44.0311080835010.28163-100000@shasta.stanford.edu>

How does twisted shut things down and recover resources when implementing 
a reverse-proxy.  If one or another of the endpoints dies, I would expect 
there to be some shutdown code to close open sockets, etc.  but I don't 
seem to be able to find it.  Can someone assist?





From allison at shasta.stanford.edu  Sat Nov  8 09:49:38 2003
From: allison at shasta.stanford.edu (Dennis Allison)
Date: Sat, 8 Nov 2003 08:49:38 -0800 (PST)
Subject: [Twisted-Python] resource recovery on shutdown
In-Reply-To: <Pine.LNX.4.44.0311080835010.28163-100000@shasta.stanford.edu>
Message-ID: <Pine.LNX.4.44.0311080848230.28163-100000@shasta.stanford.edu>

And one more thing.  How are timeouts on connections managed?  

On Sat, 8 Nov 2003, Dennis Allison wrote:

> 
> How does twisted shut things down and recover resources when implementing 
> a reverse-proxy.  If one or another of the endpoints dies, I would expect 
> there to be some shutdown code to close open sockets, etc.  but I don't 
> seem to be able to find it.  Can someone assist?
> 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 

-- 
Dennis Allison * Computer Systems Laboratory * Gates 227
               * Stanford University *  Stanford CA  94305
	       * (650) 723-9213 * (650) 723-0033 fax
	       * allison at shasta.stanford.edu
	       * allison at sumeru.stanford.edu





From obowah at yahoo.com  Sat Nov  8 11:47:09 2003
From: obowah at yahoo.com (rddda)
Date: Sat, 8 Nov 2003 10:47:09 -0800 (PST)
Subject: [Twisted-Python] Quotient mktap problem
Message-ID: <20031108184709.75897.qmail@web10708.mail.yahoo.com>

anyone here using Quotient?
it builds, but on 'mktap quotient' i get an error
where it tries to build 'atop'.
it tries to import '_bsddb'. I am using bsddb3 - which
i believe is the more recent version of bsddb. i can
fix the import, but then i have problem with procs
within. stops at DBEnv() which is supposed to be in
bsddb3, but doesn't seem to be available.
any thoughts/clues?
twisted-1.1.0
quotient-0.7.0
on OpenBSD

__________________________________
Do you Yahoo!?
Protect your identity with Yahoo! Mail AddressGuard
http://antispam.yahoo.com/whatsnewfree



From glyph at twistedmatrix.com  Sat Nov  8 23:06:19 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 9 Nov 2003 01:06:19 -0500
Subject: [Twisted-Python] Quotient mktap problem
In-Reply-To: <20031108184709.75897.qmail@web10708.mail.yahoo.com>
References: <20031108184709.75897.qmail@web10708.mail.yahoo.com>
Message-ID: <D633981A-127A-11D8-B427-000393C9700E@twistedmatrix.com>

On Nov 8, 2003, at 1:47 PM, rddda wrote:

> anyone here using Quotient?

It sounds like both your pybsddb  bindings and bsddb system library are 
too old.  Try upgrading.

Also, please discuss this on divmod-dev at divmod.org.




From syver at inout.no  Mon Nov 10 02:23:31 2003
From: syver at inout.no (Syver Enstad)
Date: 10 Nov 2003 10:23:31 +0100
Subject: [Twisted-Python] 1.1 Will Not Build Under Win32
In-Reply-To: <20031108025131.GB17626@frobozz>
References: <3FA9F9B1.9050202@pa.press.net> <u65hxsves.fsf@inout.no>
	<20031106111305.GA899@twistedmatrix.com> <u7k2cqysh.fsf@inout.no>
	<3FABF4CE.5030100@twistedmatrix.com> <20031108025131.GB17626@frobozz>
Message-ID: <ud6c07f1o.fsf@inout.no>

Andrew Bennetts <andrew-twisted at puzzling.org> writes:

> On Fri, Nov 07, 2003 at 11:38:54AM -0800, Cory Dodt wrote:
> > -----BEGIN PGP SIGNED MESSAGE-----
> > Hash: SHA1
> > 
> > Syver,
> > 
> > I'm the win32 buildmeister, so I'm looking for this bug to see if I can
> > reproduce it.  Are you sure you hit "save" on the bug? I can't find it
> > on any combination of win32, compile, build, windows...
> > 
> > Also, assigning it to me probably wouldn't be a bad thing.
> 
> The twistw bug was submitted, and has already been fixed:
>     http://twistedmatrix.com/users/roundup.twistd/twisted/issue389
> 
> I see no sign of the build problems in the bug tracker, though.

That's because I haven't submitted a bug report on it. 





From syver at inout.no  Mon Nov 10 03:58:18 2003
From: syver at inout.no (Syver Enstad)
Date: 10 Nov 2003 11:58:18 +0100
Subject: [Twisted-Python] pb help needed.
In-Reply-To: <ufzh0nliv.fsf@inout.no>
References: <ullqspdi5.fsf@inout.no> <uznf8nvjc.fsf@inout.no>
	<ufzh0nliv.fsf@inout.no>
Message-ID: <u3ccw7anp.fsf@inout.no>

How does one detach a perspective? Is there a callRemote method on a
reference that does this or what? Or is it not a problem that a long
running server calls getPerspective and unbounded number of times (I
have two twisted servers communicating via pb).





From itamar at itamarst.org  Mon Nov 10 09:13:04 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 10 Nov 2003 11:13:04 -0500
Subject: [Twisted-Python] pb help needed.
In-Reply-To: <u3ccw7anp.fsf@inout.no>
References: <ullqspdi5.fsf@inout.no>
	<uznf8nvjc.fsf@inout.no>
	<ufzh0nliv.fsf@inout.no>
	<u3ccw7anp.fsf@inout.no>
Message-ID: <20031110111304.1d601fe4.itamar@itamarst.org>

On 10 Nov 2003 11:58:18 +0100
Syver Enstad <syver at inout.no> wrote:

> 
> How does one detach a perspective? Is there a callRemote method on a
> reference that does this or what? Or is it not a problem that a long
> running server calls getPerspective and unbounded number of times (I
> have two twisted servers communicating via pb).

1.1 no longer has the concept of detaching. You can track live
perspectives and choose to not allow users to login if there's still a
connection, or not as you will. Look a bit at
http://twistedmatrix.com/documents/howto/pclients, and put the
appropriate logic in your realm'ds requestAvatar.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From phil at bubblehouse.org  Mon Nov 10 14:12:02 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Mon, 10 Nov 2003 16:12:02 -0500 (EST)
Subject: [Twisted-Python] Twisted Java
Message-ID: <1646.65.246.170.211.1068498722.squirrel@192.168.0.2>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

so, what's the chance of this ever supporting the new auth framework?

i don't want to get into a "why use java, anyway?" debate, but i was just
curious if there were any plans to continue supporting Java with the
twisted framework.

thanks,

- -phil
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (Darwin)

iD8DBQE/r/8cu8x7iJQ4TqURAugoAKCFBpft+N+IhkoSVk+b7+/+AqxJLQCfXrM/
wDDO+TcyH8kpsDANd58xhEE=
=w56/
-----END PGP SIGNATURE-----



From itamar at itamarst.org  Mon Nov 10 15:03:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 10 Nov 2003 17:03:20 -0500
Subject: [Twisted-Python] Twisted Java
In-Reply-To: <1646.65.246.170.211.1068498722.squirrel@192.168.0.2>
References: <1646.65.246.170.211.1068498722.squirrel@192.168.0.2>
Message-ID: <20031110170320.640886ac.itamar@itamarst.org>

On Mon, 10 Nov 2003 16:12:02 -0500 (EST)
"Phil Christensen" <phil at bubblehouse.org> wrote:

> so, what's the chance of this ever supporting the new auth framework?
> 
> i don't want to get into a "why use java, anyway?" debate, but i was
> just curious if there were any plans to continue supporting Java with
> the twisted framework.

I'm not used to having actual users for this code :)

I'll see about adding it sometime this week and doing a new release. 

Long term plans include rewriting to use java.nio when newpb is done, so
if java 1.4 is a problem better say so now. Probably will include EIO
high-level async framework and Straw PB-based transparent java RMI if I
can, and maybe even java cred so you can write PB servers easily.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Mon Nov 10 18:11:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 10 Nov 2003 20:11:15 -0500
Subject: [Twisted-Python] HTTP Basic Auth using cred, an example
Message-ID: <20031110201115.187d566b.itamar@itamarst.org>

I've put up some code showing how to use HTTP Basic authentication
together with cred to guard a resource at
http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue393

You need to implement a realm that returns resources, and then wrap it
in a portal with an appropriate username/password credential checker.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From twisted at zadka.site.co.il  Tue Nov 11 00:47:21 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 11 Nov 2003 07:47:21 -0000
Subject: [Twisted-Python] HTTP Basic Auth using cred, an example
In-Reply-To: <20031110201115.187d566b.itamar@itamarst.org>
References: <20031110201115.187d566b.itamar@itamarst.org>
Message-ID: <20031111074721.26202.qmail@green.zadka.com>

On Mon, 10 Nov 2003, Itamar Shtull-Trauring <itamar at itamarst.org> wrote:

> I've put up some code showing how to use HTTP Basic authentication
> together with cred to guard a resource at
> http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue393

I put a somewhat different version there.
Outside of some cosmetics, not that it .addBoth the logout to the
notifyDone. This is important: the user should be logged out if the
request is severed mid-output

> You need to implement a realm that returns resources, and then wrap it
> in a portal with an appropriate username/password credential checker.

Of course, simpleguard.MarkingRealm can be used for that :)



From graham at hansell.co.uk  Tue Nov 11 08:18:06 2003
From: graham at hansell.co.uk (Graham Hansell)
Date: Tue, 11 Nov 2003 15:18:06 +0000
Subject: [Twisted-Python] A real Newbie question - how to get started
Message-ID: <3FB0FDAE.8010906@hansell.co.uk>

Dear All Twisters out there.

I am a complete Twisted newbie (with a little bit of Python experience) 
and having just installed this (what looks like) a great package, I 
would like advice on my next step.

I am looking to start doing simple (spider) based web clients but really 
would like a guide or tutorial before jsut spending hours pulling my 
hair out. Where do you advise me to go. I have had a look at the 
Tutorial on Finger but this seems like a major development in an area I 
don't even understand.

Is there any specific newbie guides being built or assembled  possibly 
by those on this list.

Thanks for your help with something that could just change my life (well 
a bit of it anyway).

Graham




From pb_twisted at olga.mine.nu  Tue Nov 11 08:31:54 2003
From: pb_twisted at olga.mine.nu (Patrik Blommaskog)
Date: Tue, 11 Nov 2003 16:31:54 +0100
Subject: [Twisted-Python] Twisted and mod_python?
Message-ID: <JAEDJDIBADCJHPFLNEDFIEHKCBAA.pb_twisted@olga.mine.nu>

I am wondering about the feasibility of using mod_python in an Apache server
to make PB requests to a Twisted application.

That is, I have a Twisted application which servers PB requests, e.g. a user
manager. I also have an Apache server. I would like the Apache server to
present dynamic web pages based on the contents of the user manager
application, to act as a web front end (e.g. create/erase/modify user
properties). I was thinking that it could be possible to use mod_python and
Twisted to act as a client to the user manager.

My questions are:

1. Is this possible, fesible and/or reasonable? If so, any hints or examples
would be welcome.

2. Any alternative/better solutions?


I suppose it would be rather easy to use CGI instead, but I'd like to
explore the options.


- Patrik







From vlupien at drummonddesigns.com  Tue Nov 11 11:45:41 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Tue, 11 Nov 2003 13:45:41 -0500
Subject: [Twisted-Python] setUp and rendering
Message-ID: <000001c3a884$024e6f30$687ba8c0@vicky>

I'm  working on a web based application.  I found that the function
setUp is done before the rendering (wmfactory, etc...) of the page.
But I need to have a function that is done after the rendering.  Is
there a function that I can override that do what I need.
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031111/677051f6/attachment.html>

From phil at bubblehouse.org  Tue Nov 11 12:03:39 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Tue, 11 Nov 2003 14:03:39 -0500 (EST)
Subject: [Twisted-Python] an easy twisted application question
Message-ID: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>

okay, so if i've got a tap with the following updateApplication method:

def updateApplication(app, config):
	app.registry = registry.Registry()
	...
	...

and i want to access that app.registry attribute from an arbitrary
location, how do i do it?

i seem to remember hearing that there was only one instance of Application
in a process, so does that mean that there's some (forgive the Java-speak)
static method defined on the Application module that will get the current
running instance?

thanks in advance,

-phil



From exarkun at intarweb.us  Tue Nov 11 12:50:35 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 11 Nov 2003 14:50:35 -0500
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
Message-ID: <20031111195034.GA14487@intarweb.us>

On Tue, Nov 11, 2003 at 02:03:39PM -0500, Phil Christensen wrote:
> okay, so if i've got a tap with the following updateApplication method:
> 
> def updateApplication(app, config):
> 	app.registry = registry.Registry()
> 	...
> 	...
> 
> and i want to access that app.registry attribute from an arbitrary
> location, how do i do it?
> 
> i seem to remember hearing that there was only one instance of Application
> in a process, so does that mean that there's some (forgive the Java-speak)
> static method defined on the Application module that will get the current
> running instance?

  The old way of doing this would be...

    from twisted.internet.app import theApplication
    theApplication.registry

  However, this bites.

  Newly written programs should implement makeService() instead of
updateApplication().  As a bonus, purely service-based programs can easily
and cleanly do things like the above:

    from twisted.application import service

    class RegistryService(service.Service):
        def __init__(self):
            self.registry = registry.Registry()

    def makeService(config):
        s = RegistryService()
        ...
        anotherS = SomeotherService()
        anotherS.setServiceParent(s)  # Or s.setServiceParent(anotherS)
        ...
        return s # or return anotherS

  `s' can be the parent service of other services, in which case it can be
accessed simply by looking up the parent service, or it could be a child
service of something else, in which case it would be accessed via a call to
getServiceNamed() on the appropriate parent.

  This avoids the need for globals and lets services/applications be more
readily configurable alongside other services/applications (since neither
will have global state that might interfer with the other).

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031111/c0128514/attachment.sig>

From phil at bubblehouse.org  Tue Nov 11 14:28:55 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Tue, 11 Nov 2003 16:28:55 -0500 (EST)
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <20031111195034.GA14487@intarweb.us>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
    <20031111195034.GA14487@intarweb.us>
Message-ID: <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>

Okay, that answers another question I had, but I'm still not clear on how
to get at that service object from a couple of places.

For example, here's my Realm implementation:

class InnerSpaceRealm:
    __implements__ = portal.IRealm

    def requestAvatar(self, avatarId, mind, *interfaces):
        if pb.IPerspective in interfaces:
            registry = ### how do i get this?
            avatar = UserPerspective(mind, registry.get(avatarId))
            return pb.IPerspective, avatar, avatar.logout
        else:
            raise NotImplementedError("no interface")

what's the right way to get that service object?

this issue comes up again in my UserPerspective class, where i need to
access that registry object during perspective_xxx methods...

there is a part of me that just wants to use registry as a one-off class
with a class variable that returns the current instance, but i don't like
that part ;-).....

thanks again,
-phil


>   Newly written programs should implement makeService() instead of
> updateApplication().  As a bonus, purely service-based programs can easily
> and cleanly do things like the above:
>
>     from twisted.application import service
>
>     class RegistryService(service.Service):
>         def __init__(self):
>             self.registry = registry.Registry()
>
>     def makeService(config):
>         s = RegistryService()
>         ...
>         anotherS = SomeotherService()
>         anotherS.setServiceParent(s)  # Or s.setServiceParent(anotherS)
>         ...
>         return s # or return anotherS
>
>   `s' can be the parent service of other services, in which case it can be
> accessed simply by looking up the parent service, or it could be a child
> service of something else, in which case it would be accessed via a call
> to
> getServiceNamed() on the appropriate parent.
>
>   This avoids the need for globals and lets services/applications be more
> readily configurable alongside other services/applications (since neither
> will have global state that might interfer with the other).
>
>   Jp
>



From stuart.hungerford at anu.edu.au  Tue Nov 11 18:23:49 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Wed, 12 Nov 2003 12:23:49 +1100
Subject: [Twisted-Python] Re: request getUser()/getPassword() in Woven and resources...
Message-ID: <6.0.0.22.0.20031112122128.01d7ebd0@anusf.anu.edu.au>

Hi all,

Was this question about getUser() etc ever resolved?


 > My question goes along the previous one in this thread.
 > How do you get the browser to prompt for a username and password?
 > My code is not woking and goes something like this: On every page request
 > a certain function is called, say genpage()...
 >
 > def genpage(request)
 >     request.getUser()
 >     request.getPassword()
 >
 >     return "hello world"
 >
 >
 > -> Browser does not prompt though. (And this does not even involve woven)
 >
 > _stephan




Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From exarkun at intarweb.us  Tue Nov 11 19:14:30 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 11 Nov 2003 21:14:30 -0500
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2> <20031111195034.GA14487@intarweb.us> <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>
Message-ID: <20031112021430.GA17246@intarweb.us>

On Tue, Nov 11, 2003 at 04:28:55PM -0500, Phil Christensen wrote:
> Okay, that answers another question I had, but I'm still not clear on how
> to get at that service object from a couple of places.
> 
> For example, here's my Realm implementation:
> 
> class InnerSpaceRealm:
>     __implements__ = portal.IRealm
> 
>     def requestAvatar(self, avatarId, mind, *interfaces):
>         if pb.IPerspective in interfaces:
>             registry = ### how do i get this?
>             avatar = UserPerspective(mind, registry.get(avatarId))
>             return pb.IPerspective, avatar, avatar.logout
>         else:
>             raise NotImplementedError("no interface")
> 
> what's the right way to get that service object?
> 

  Like so:

    class InnerSpaceRealm:
        __implements__ = portal.IRealm

        def __init__(self, service):
            self.service = service

        def requestAvatar(self, avatarId, mind, *interfaces):
            ...

  ;)  There are other ways, but I'm sure you don't need me to point them
out.  The key is, just do the obvious thing here.  There's no special way to
manage this.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031111/95cf485a/attachment.sig>

From itamar at itamarst.org  Tue Nov 11 20:30:01 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 11 Nov 2003 22:30:01 -0500
Subject: [Twisted-Python] Twisted and mod_python?
In-Reply-To: <JAEDJDIBADCJHPFLNEDFIEHKCBAA.pb_twisted@olga.mine.nu>
References: <JAEDJDIBADCJHPFLNEDFIEHKCBAA.pb_twisted@olga.mine.nu>
Message-ID: <20031111223001.6dfe40be.itamar@itamarst.org>

On Tue, 11 Nov 2003 16:31:54 +0100
"Patrik Blommaskog" <pb_twisted at olga.mine.nu> wrote:

> I am wondering about the feasibility of using mod_python in an Apache
> server to make PB requests to a Twisted application.

You'd need to start the Twisted event loop up on each HTTP request.
Or... kinda. It's possible anyway, but you'll need to investigate
mod_python's interpreter lifetime model.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Tue Nov 11 20:31:39 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 11 Nov 2003 22:31:39 -0500
Subject: [Twisted-Python] A real Newbie question - how to get started
In-Reply-To: <3FB0FDAE.8010906@hansell.co.uk>
References: <3FB0FDAE.8010906@hansell.co.uk>
Message-ID: <20031111223139.4f8b26e9.itamar@itamarst.org>

On Tue, 11 Nov 2003 15:18:06 +0000
Graham Hansell <graham at hansell.co.uk> wrote:

> I am looking to start doing simple (spider) based web clients but
> really would like a guide or tutorial before jsut spending hours
> pulling my hair out. Where do you advise me to go. I have had a look
> at the Tutorial on Finger but this seems like a major development in
> an area I don't even understand.

Finger is trivial. It asks a remote server for info about a user.

E.g. "finger foo at example.com" at a unix command line will ask
example.com, using the finger protocol, for foo's info, whatever that
is. Typically a finger server will return contents of the file ".plan"
from the user's home directory.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From maoy at cis.upenn.edu  Tue Nov 11 20:46:14 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Tue, 11 Nov 2003 22:46:14 -0500 (EST)
Subject: [Twisted-Python] rpm package for twisted?
In-Reply-To: <1068071701.2980.1.camel@shock>
Message-ID: <Pine.LNX.4.44.0311112244190.13491-100000@klondike.cis.upenn.edu>

I tried to run rpmbuild -ba twist.spec on the NoDoc .bz2 file. The error 
messages were:

writing list of installed files to 'installed-files'
warning: install: modules installed to 
'/var/tmp/Twisted-buildroot/usr/lib/python2.2/site-packages/', which is 
not in Python's module search path (sys.path) -- you'll have to change the 
search path yourself
+ mkdir -p /var/tmp/Twisted-buildroot//usr/share/man/man1/
+ cp -a 'doc/man/*.1' /var/tmp/Twisted-buildroot//usr/share/man/man1/
cp: cannot stat `doc/man/*.1': No such file or directory
error: Bad exit status from /var/tmp/rpm-tmp.59933 (%install)


Yun


On Wed, 5 Nov 2003, Alexander Winston wrote:

> On Wed, 2003-11-05 at 16:57, Yun Mao wrote:
> > Hi, I found twisted package for debian in the official site. Is there a 
> > ready rpm package for twisted 1.1.0 release? thanks!
> 
> They are not distributed as far as I know, but the .spec file
> (Twisted/admin/twisted.spec) should produce RPMs without trouble.
> 




From glyph at twistedmatrix.com  Tue Nov 11 22:13:10 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Nov 2003 00:13:10 -0500
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <20031112021430.GA17246@intarweb.us>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2> <20031111195034.GA14487@intarweb.us> <4879.65.246.170.211.1068586135.squirrel@192.168.0.2> <20031112021430.GA17246@intarweb.us>
Message-ID: <3FB1C166.6090107@twistedmatrix.com>

Jp Calderone wrote:

>   ;)  There are other ways, but I'm sure you don't need me to point them
> out.  The key is, just do the obvious thing here.  There's no special way to
> manage this.

I might add that this is exactly the reason that Realm is an interface 
and not a class.  Considering that "session logic container" has 
infinite variability in its implementation, the restrictions on how a 
Realm has to work are _really_ light.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 256 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031112/ba998f69/attachment.sig>

From itamar at itamarst.org  Tue Nov 11 22:22:28 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 12 Nov 2003 00:22:28 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor,
 never installing waker for now
In-Reply-To: <E1AJmqh-0004IX-00@wolfwood>
References: <E1AJmqh-0004IX-00@wolfwood>
Message-ID: <20031112002228.0a2a11a3.itamar@itamarst.org>

On Tue, 11 Nov 2003 21:43:23 -0700
etrepum CVS <etrepum at wolfwood.twistedmatrix.com> wrote:

> Modified files:
> Twisted/twisted/internet/cfreactor.py 1.3 1.4
> 
> Log message:
> Somehow the waker still messes up cfreactor, never installing waker
> for now

That means threaded programs with cfreactor will be really slow.

I think the issue is that the unix waker uses python sockets. You
probably want to write your own waker using whatever APIs you are using.

While we're at it - warner, could we have the mac os x reactor also run
tests with cfreactor?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Tue Nov 11 22:29:13 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Nov 2003 00:29:13 -0500
Subject: [Twisted-Python] Twisted and mod_python?
In-Reply-To: <20031111223001.6dfe40be.itamar@itamarst.org>
References: <JAEDJDIBADCJHPFLNEDFIEHKCBAA.pb_twisted@olga.mine.nu> <20031111223001.6dfe40be.itamar@itamarst.org>
Message-ID: <3FB1C529.4040508@twistedmatrix.com>

Itamar Shtull-Trauring wrote:

> You'd need to start the Twisted event loop up on each HTTP request.
> Or... kinda. It's possible anyway, but you'll need to investigate
> mod_python's interpreter lifetime model.

It's theoretically possible, but almost certainly a bad idea.  Do you 
already have a large mod_python-using codebase?

If not, Twisted includes HTTP support for a reason.  Just use it :).  To 
communicate with your apache server, use mod_proxy or something similar 
to just relay requests to the Twisted web server.

If you do have a large mod_python-using application already and you are 
trying to get it to talk to Twisted, you probably want to continue to 
use the mod_python execution model rather than spin up the twisted event 
loop and switch back and forth: while it's possible if you really need 
it, a better architectural strategy in the average case (to avoid odd 
interactions between the assumptions mod_python has about its 
environment and the assumptions twisted has about its) would be to use 
Twisted's XMLRPC support and talk to it using a blocking XMLRPC library 
from your mod_python scripts.


but-ask-me-again-when-warner-finishes-newpb-ly y'rs,

	-glyph
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 256 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031112/ce6aec11/attachment.sig>

From bob at redivi.com  Tue Nov 11 23:20:07 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 12 Nov 2003 01:20:07 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor, never installing waker for now
In-Reply-To: <20031112002228.0a2a11a3.itamar@itamarst.org>
References: <E1AJmqh-0004IX-00@wolfwood> <20031112002228.0a2a11a3.itamar@itamarst.org>
Message-ID: <433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>


On Nov 12, 2003, at 12:22 AM, Itamar Shtull-Trauring wrote:

> On Tue, 11 Nov 2003 21:43:23 -0700
> etrepum CVS <etrepum at wolfwood.twistedmatrix.com> wrote:
>
>> Modified files:
>> Twisted/twisted/internet/cfreactor.py 1.3 1.4
>>
>> Log message:
>> Somehow the waker still messes up cfreactor, never installing waker
>> for now
>
> That means threaded programs with cfreactor will be really slow.
>
> I think the issue is that the unix waker uses python sockets. You
> probably want to write your own waker using whatever APIs you are 
> using.
>
> While we're at it - warner, could we have the mac os x reactor also run
> tests with cfreactor?

I don't know what the deal is, exactly, because it uses python sockets 
internally and that works perfectly fine.  I believe that something 
about the waker causes the run loop to think that it's always awake.  I 
didn't feel like looking too far into it.  That said, Apple's 
implementation of CFRunLoop does everything that the reactor does (and 
then some), including thread waking and other thread communication 
facilities.. so when I have more time I'll look into the cause and the 
appropriate solution.    IIRC the only part of Twisted that uses 
threads on its own is the DB stuff, anything else would probably be 
implemented using more native means (nobody uses cfreactor for 
cross-platform applications yet), so I don't see an immediate problem 
with ignoring the waker.  I'd rather punish threaded (from what Twisted 
sees) applications than make all applications really really slow and 
resource hungry.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031112/fe67f30f/attachment-0002.bin>

From twisted at zadka.site.co.il  Tue Nov 11 23:49:23 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 12 Nov 2003 06:49:23 -0000
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>
References: <4879.65.246.170.211.1068586135.squirrel@192.168.0.2>, <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
    <20031111195034.GA14487@intarweb.us>
Message-ID: <20031112064923.1644.qmail@green.zadka.com>

On Tue, 11 Nov 2003, "Phil Christensen" <phil at bubblehouse.org> wrote:

> class InnerSpaceRealm:
>     __implements__ = portal.IRealm
> 
>     def requestAvatar(self, avatarId, mind, *interfaces):
>         if pb.IPerspective in interfaces:
>             registry = ### how do i get this?
>             avatar = UserPerspective(mind, registry.get(avatarId))
>             return pb.IPerspective, avatar, avatar.logout
>         else:
>             raise NotImplementedError("no interface")
> 
> what's the right way to get that service object?

Others have already said that the right way is to "push, not pull":
give the service object as an argument to __init__.
I wanted to add that the correct way to pass the registry to
UserPerspective is probably much the same thing:

class UserPerspective:
    # ...
    def setRegistry(self, registry):
        self.registry = registry

class InnerSpaceRealm:
    __implements__ = portal.IRealm
    def __init__(self, registry):
        self.registry = registry

    def requestAvatar(self, avatarId, mind, *interfaces):
        if pb.IPerspective in interfaces:
            avatar = UserPerspective(mind, self.registry.get(avatarId))
            avatar.setRegistry(self.registry)
            return pb.IPerspective, avatar, avatar.logout
        else:
            raise NotImplementedError("no interface")



From glyph at twistedmatrix.com  Tue Nov 11 23:56:25 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 12 Nov 2003 01:56:25 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still
 messes up cfreactor, never installing waker for now
In-Reply-To: <433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>
References: <E1AJmqh-0004IX-00@wolfwood> <20031112002228.0a2a11a3.itamar@itamarst.org> <433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>
Message-ID: <3FB1D999.6050104@twistedmatrix.com>

Bob Ippolito wrote:

> I don't know what the deal is, exactly, because it uses python sockets 
> internally and that works perfectly fine.  I believe that something 
> about the waker causes the run loop to think that it's always awake.  I 
> didn't feel like looking too far into it.  That said, Apple's 
> implementation of CFRunLoop does everything that the reactor does (and 
> then some), including thread waking and other thread communication 
> facilities.. so when I have more time I'll look into the cause and the 
> appropriate solution.    IIRC the only part of Twisted that uses threads 
> on its own is the DB stuff, anything else would probably be implemented 
> using more native means (nobody uses cfreactor for cross-platform 
> applications yet), so I don't see an immediate problem with ignoring the 
> waker.  I'd rather punish threaded (from what Twisted sees) applications 
> than make all applications really really slow and resource hungry.

If there are better thread communication facilities in the CFRunLoop, 
then make your reactor's call[From/In]Thread use them.  There's nothing 
intrinsically useful about the waker; it's an implementation detail of 
callFromThread which could be better done in another way.

However, "really slow" doesn't quite describe the problem.  A server 
which sends an event to a thread without a waker and then receives a 
callFromThread may never wake up, if there isn't more network activity 
happening.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 256 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031112/a43db6f5/attachment.sig>

From corydodt at twistedmatrix.com  Wed Nov 12 01:05:42 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed, 12 Nov 2003 00:05:42 -0800
Subject: [Twisted-Python] tap2ntsvc in sandbox
Message-ID: <3FB1E9D6.1000609@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Twisted/sandbox/moonfallen/tap2ntsvc.py

If you have an Twisted application that you want to make into a service
on Windows, give this a try.  It's very basic right now; it absolutely
needs py2exe and Inno setup support before I'll consider it done.  The
goal is to have the output be a complete binary package analogous to the
output of tap2deb or tap2rpm.  The only difference will be that, instead
of depending on software like the Linux versions do, it will do as much
as it can to help you include the dependencies in the package using py2exe.

Right now, nothing beyond generating a service script is done.  Here's
the help:

Usage: tap2ntsvc.py [options] <filename>
Options:
~  -y, --type=          Config file type: pickle, xml, source, or python
~  -o, --output-file=   Name of the setup executable produced
~  -n, --name=          Short name of the service (used with "net start")
~  -d, --display-name=  Human-readable name of the service
~  -e, --description=   Description of the service
~  -r, --reactor=       Reactor to install (like twistd) [default: default]
~      --version
~      --help           Display this help and exit.

Do something like . . .

| python tap2ntsvc.py myapp.tac

The output is myappsvc.py (or <name>svc.py).  Then you run myappsvc.py:

| python myappsvc.py install
Installing service myapp to Python class
C:\myapp\myappsvc.myapp_ServiceControl
Changing service configuration
Service updated

| net start myapp
The myapp run by Twisted service is starting.
The myapp run by Twisted service was started successfully.


Give it a try, let me know if you have any problems with it.

Thanks,

C
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows XP)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/senW3A5SrXAiHQcRAvNdAJ4n7+yfvB/kcKD1pfGjfgqDbFgqcACcCDYZ
jqd+gw+guZ3xg4f5R6I8tIQ=
=kTlI
-----END PGP SIGNATURE-----



From warner at lothar.com  Wed Nov 12 01:37:36 2003
From: warner at lothar.com (Brian Warner)
Date: Wed, 12 Nov 2003 00:37:36 -0800 (PST)
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor,
 never installing waker for now
Message-ID: <20031112.003736.117867178.warner@lothar.com>

> While we're at it - warner, could we have the mac os x reactor also run
> tests with cfreactor?

Oh, does that work now? If I recall, that used to hang the buildslave.

I'll give it a try and turn on a cfreactor pass if it works.

 -Brian




From warner at lothar.com  Wed Nov 12 01:45:46 2003
From: warner at lothar.com (Brian Warner)
Date: Wed, 12 Nov 2003 00:45:46 -0800 (PST)
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor,
 never installing waker for now
Message-ID: <20031112.004546.115075450.warner@lothar.com>

> While we're at it - warner, could we have the mac os x reactor also run
> tests with cfreactor?

My tests failed:

24:buildbot at quartz% python2.2 bin/trial -to -r cf twisted.test
...
  File "/Users/buildbot/Buildbot/slave/OSX-full2.2/Twisted/twisted/internet/cfreactor.py", line 42, in ?
    import cfsupport as cf
ImportError: Failure linking new module


It might be related to the following warning during the compilation phase:

 gcc -arch ppc -bundle -flat_namespace -undefined suppress build/temp.darwin-6.8-Power Macintosh-2.2/cfsupport.o -o twisted/internet/cfsupport.so -framework CoreFoundation -framework CoreServices -framework Carbon
 ld: warning dynamic shared library: /usr/lib/libSystem.dylib not made a weak library in output with MACOSX_DEPLOYMENT_TARGET environment variable set to: 10.1


It doesn't hang, so I'm going to turn on the test anyway (it will just fail
all the time). I don't know a lot about OS-X linker magic.. somebody else
will have to figure out the problem here.

 -Brian




From rudy.schockaert at pandora.be  Wed Nov 12 02:17:38 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Wed, 12 Nov 2003 10:17:38 +0100
Subject: [Twisted-Python] Twisted Names references
Message-ID: <3FB1FAB2.50600@pandora.be>

Hi,

we would like to propose to a customer of our a solution based on 
Twisted Names. The customer is open to this suggestion, but asked us if 
we could provide references of companies using Twisted Names in production?
If you know of companies we can mention (Name and size of the company, 
ev. contact person) it would help us a lot.

Thanks in advance,

Rudy



From abe at fettig.net  Wed Nov 12 06:51:56 2003
From: abe at fettig.net (Abe Fettig)
Date: Wed, 12 Nov 2003 08:51:56 -0500
Subject: [Twisted-Python] tap2ntsvc in sandbox
In-Reply-To: <3FB1E9D6.1000609@twistedmatrix.com>
References: <3FB1E9D6.1000609@twistedmatrix.com>
Message-ID: <3FB23AFC.4040401@fettig.net>

Cory Dodt wrote:

> Twisted/sandbox/moonfallen/tap2ntsvc.py
> 
> If you have an Twisted application that you want to make into a service
> on Windows, give this a try. 

Wow, that's great!  Thanks Cory!

Abe




From bob at redivi.com  Wed Nov 12 07:58:32 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 12 Nov 2003 09:58:32 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor, never installing waker for now
In-Reply-To: <20031112.004546.115075450.warner@lothar.com>
References: <20031112.004546.115075450.warner@lothar.com>
Message-ID: <AF40E3FC-1520-11D8-BF3A-000A95686CD8@redivi.com>


On Nov 12, 2003, at 3:45 AM, Brian Warner wrote:

>> While we're at it - warner, could we have the mac os x reactor also  
>> run
>> tests with cfreactor?
>
> My tests failed:
>
> 24:buildbot at quartz% python2.2 bin/trial -to -r cf twisted.test
> ...
>   File  
> "/Users/buildbot/Buildbot/slave/OSX-full2.2/Twisted/twisted/internet/ 
> cfreactor.py", line 42, in ?
>     import cfsupport as cf
> ImportError: Failure linking new module
>
>
> It might be related to the following warning during the compilation  
> phase:
>
>  gcc -arch ppc -bundle -flat_namespace -undefined suppress  
> build/temp.darwin-6.8-Power Macintosh-2.2/cfsupport.o -o  
> twisted/internet/cfsupport.so -framework CoreFoundation -framework  
> CoreServices -framework Carbon
>  ld: warning dynamic shared library: /usr/lib/libSystem.dylib not made  
> a weak library in output with MACOSX_DEPLOYMENT_TARGET environment  
> variable set to: 10.1
>
>
> It doesn't hang, so I'm going to turn on the test anyway (it will just  
> fail
> all the time). I don't know a lot about OS-X linker magic.. somebody  
> else
> will have to figure out the problem here.

I will not EVER support that version of Python 2.2.  You'll need to use  
python2.3 ( http://homepages.cwi.nl/~jack/macpython/index.html ) or  
upgrade the machine to OS X 10.3.  If it works under that version of  
python, it's purely by chance.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031112/69ccb3cc/attachment-0002.bin>

From itamar at itamarst.org  Wed Nov 12 08:41:54 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 12 Nov 2003 10:41:54 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still
 messes up cfreactor, never installing waker for now
In-Reply-To: <AF40E3FC-1520-11D8-BF3A-000A95686CD8@redivi.com>
References: <20031112.004546.115075450.warner@lothar.com>
	<AF40E3FC-1520-11D8-BF3A-000A95686CD8@redivi.com>
Message-ID: <20031112104154.70593b5a.itamar@itamarst.org>

On Wed, 12 Nov 2003 09:58:32 -0500
Bob Ippolito <bob at redivi.com> wrote:

> I will not EVER support that version of Python 2.2.  You'll need to
> use  python2.3 ( http://homepages.cwi.nl/~jack/macpython/index.html )
> or  upgrade the machine to OS X 10.3.  If it works under that version
> of  python, it's purely by chance.

And we do want a 2.2.0 buildbot going, since that's useful, and lets us
test OS X 10.2's python. Run another buildbot I guess?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Wed Nov 12 08:47:02 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 12 Nov 2003 10:47:02 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still
 messes up cfreactor, never installing waker for now
In-Reply-To: <3FB1D999.6050104@twistedmatrix.com>
References: <E1AJmqh-0004IX-00@wolfwood>
	<20031112002228.0a2a11a3.itamar@itamarst.org>
	<433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>
	<3FB1D999.6050104@twistedmatrix.com>
Message-ID: <20031112104702.515b3f5c.itamar@itamarst.org>

On Wed, 12 Nov 2003 01:56:25 -0500
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> However, "really slow" doesn't quite describe the problem.  A server 
> which sends an event to a thread without a waker and then receives a 
> callFromThread may never wake up, if there isn't more network activity
> 
> happening.

Yep, a reactor without a waker is essentially broken. It'll also break
the SIGCHILD handler in CVS. Please do try to find a solution before our
next release.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Wed Nov 12 09:24:06 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 12 Nov 2003 11:24:06 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still messes up cfreactor, never installing waker for now
In-Reply-To: <20031112104702.515b3f5c.itamar@itamarst.org>
References: <E1AJmqh-0004IX-00@wolfwood> <20031112002228.0a2a11a3.itamar@itamarst.org> <433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com> <3FB1D999.6050104@twistedmatrix.com> <20031112104702.515b3f5c.itamar@itamarst.org>
Message-ID: <A345F65A-152C-11D8-98F5-000A95686CD8@redivi.com>


On Nov 12, 2003, at 10:47 AM, Itamar Shtull-Trauring wrote:

> On Wed, 12 Nov 2003 01:56:25 -0500
> Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
>
>> However, "really slow" doesn't quite describe the problem.  A server
>> which sends an event to a thread without a waker and then receives a
>> callFromThread may never wake up, if there isn't more network activity
>>
>> happening.
>
> Yep, a reactor without a waker is essentially broken. It'll also break
> the SIGCHILD handler in CVS. Please do try to find a solution before 
> our
> next release.

Signals need a whole different approach because signals do not wake up 
CFRunLoop, so when you install handlers it wakes up once a second 
anyway.  The correct solution is to use a mach port waker for signals, 
I have not implemented this yet because there are no mach port 
facilities available from Python yet (I looked into it, but doing mach 
ports use a lot of C macros, so it would be hard).

When is next release planned?

-bob 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031112/be2b0fd3/attachment-0002.bin>

From itamar at itamarst.org  Wed Nov 12 09:52:43 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 12 Nov 2003 11:52:43 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Somehow the waker still
 messes up cfreactor, never installing waker for now
In-Reply-To: <A345F65A-152C-11D8-98F5-000A95686CD8@redivi.com>
References: <E1AJmqh-0004IX-00@wolfwood>
	<20031112002228.0a2a11a3.itamar@itamarst.org>
	<433BF266-14D8-11D8-BF3A-000A95686CD8@redivi.com>
	<3FB1D999.6050104@twistedmatrix.com>
	<20031112104702.515b3f5c.itamar@itamarst.org>
	<A345F65A-152C-11D8-98F5-000A95686CD8@redivi.com>
Message-ID: <20031112115243.35fa9b3e.itamar@itamarst.org>

On Wed, 12 Nov 2003 11:24:06 -0500
Bob Ippolito <bob at redivi.com> wrote:

> When is next release planned?

Doesn't seem like anyone is in a real rush to have one.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From corydodt at twistedmatrix.com  Wed Nov 12 10:46:14 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed, 12 Nov 2003 09:46:14 -0800
Subject: [Twisted-Python] Re: tap2ntsvc in sandbox
In-Reply-To: <3FB1E9D6.1000609@twistedmatrix.com>
References: <3FB1E9D6.1000609@twistedmatrix.com>
Message-ID: <3FB271E6.1030009@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I should add that, if you do have any problems using it (e.g. net start
doesn't work), check the Application Log in Event Viewer.  There should be a
helpful traceback in an Error event.

C

Cory Dodt wrote:
| Twisted/sandbox/moonfallen/tap2ntsvc.py
|
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/snHm3A5SrXAiHQcRAkKHAJ43fuZ92WgpymWtgs0jBi3SEmIsFACeKHnE
OWPpZLdta3C2vuKhQuGSuEg=
=6bkB
-----END PGP SIGNATURE-----



From phil at bubblehouse.org  Wed Nov 12 11:25:06 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 12 Nov 2003 13:25:06 -0500 (EST)
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <20031111195034.GA14487@intarweb.us>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
    <20031111195034.GA14487@intarweb.us>
Message-ID: <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>

so i followed jp's advice, and my makeService method now looks like this:


###############code#################
def makeService(config):
    registry = Registry()
    reg_service = RegistryService(registry)
    portal = Portal(auth.InnerSpaceRealm(reg_service))
    checker = auth.RegistryChecker(registry)
    portal.registerChecker(checker)
    pb_service = internet.TCPServer(int(config['port']),
                                    pb.PBServerFactory(portal))
    reg_service.setServiceParent(pb_service)
    return pb_service
###############code#################


when i try to build my tap file now, i get


###############traceback#################
Traceback (most recent call last):
  File "/Users/phil/Python/Twisted/bin/mktap", line 30, in ?
    run()
  File "/Users/phil/Python/Twisted/twisted/scripts/mktap.py", line 160, in
run
    options.subOptions)
  File "/Users/phil/Python/Twisted/twisted/scripts/mktap.py", line 58, in
makeService
    ser = mod.makeService(options)
  File "./inner/space/bigbang.py", line 24, in makeService
    reg_service.setServiceParent(pb_service)
  File "/Users/phil/Python/Twisted/twisted/application/service.py", line
116, in setServiceParent
    self.parent.addService(self)
AttributeError: TCPServer instance has no attribute 'addService'
###############traceback#################


i've tried this both ways, with pb_service as the parent, and with
reg_service as the parent, with the same result.

btw, i am working out of a freshly checked-out cvs directory, but i doubt
that matters.

thanks again for any help,
-phil



>   Newly written programs should implement makeService() instead of
> updateApplication().  As a bonus, purely service-based programs can easily
> and cleanly do things like the above:
>
>     from twisted.application import service
>
>     class RegistryService(service.Service):
>         def __init__(self):
>             self.registry = registry.Registry()
>
>     def makeService(config):
>         s = RegistryService()
>         ...
>         anotherS = SomeotherService()
>         anotherS.setServiceParent(s)  # Or s.setServiceParent(anotherS)
>         ...
>         return s # or return anotherS
>
>   `s' can be the parent service of other services, in which case it can be
> accessed simply by looking up the parent service, or it could be a child
> service of something else, in which case it would be accessed via a call
> to getServiceNamed() on the appropriate parent.



From phil at bubblehouse.org  Wed Nov 12 11:59:43 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 12 Nov 2003 13:59:43 -0500 (EST)
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>
References: <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>  
    <20031111195034.GA14487@intarweb.us>
    <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>
Message-ID: <1734.65.246.170.211.1068663583.squirrel@192.168.0.2>

AHA!

i needed to have my parent class subclass MultiService, right? so i tried
this, and the tap built fine...hopefully it was the right thing (still
testing)...

-phil


class RegistryService(service.MultiService):
	def __init__(self, registry):
		service.MultiService.__init__(self)
		self.registry = registry

def makeService(config):
	registry = Registry()
	reg_service = RegistryService(registry)
	portal = Portal(auth.InnerSpaceRealm(reg_service))
	checker = auth.RegistryChecker(registry)
	portal.registerChecker(checker)
	pb_service = internet.TCPServer(int(config['port']),
pb.PBServerFactory(portal))
	pb_service.setServiceParent(reg_service)
	return reg_service



From justinjohnson at fastmail.fm  Wed Nov 12 13:00:48 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 12 Nov 2003 14:00:48 -0600
Subject: [Twisted-Python] Re: tap2ntsvc in sandbox
In-Reply-To: <3FB271E6.1030009@twistedmatrix.com>
References: <3FB1E9D6.1000609@twistedmatrix.com> <3FB271E6.1030009@twistedmatrix.com>
Message-ID: <20031112200049.C1B443E9D1@server1.messagingengine.com>

One problem I had with a python windows service in general ended up being
related to the following tech note.  Took me forever to figure out what
the problem was, but every one of the symptoms in the tech note applied. 
I'm posting this to hopefully save other's the headache.

The immediate output you see is as follows:

E:\scripts>winsvc.py start
Starting service RatControlService
Error starting service: The service did not respond to the start or
control request in a timely fashion.
E:\scripts>

More info was available in the event logs as described in the tech note.

http://support.microsoft.com/default.aspx?scid=kb;en-us;812485


-Justin

On Wed, 12 Nov 2003 09:46:14 -0800, "Cory Dodt"
<corydodt at twistedmatrix.com> said:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> I should add that, if you do have any problems using it (e.g. net start
> doesn't work), check the Application Log in Event Viewer.  There should
> be a
> helpful traceback in an Error event.
> 
> C
> 
> Cory Dodt wrote:
> | Twisted/sandbox/moonfallen/tap2ntsvc.py
> |
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.2.3-nr1 (Windows 2000)
> Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org
> 
> iD8DBQE/snHm3A5SrXAiHQcRAkKHAJ43fuZ92WgpymWtgs0jBi3SEmIsFACeKHnE
> OWPpZLdta3C2vuKhQuGSuEg=
> =6bkB
> -----END PGP SIGNATURE-----
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From lafou at wanadoo.fr  Wed Nov 12 17:05:59 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Thu, 13 Nov 2003 01:05:59 +0100
Subject: [Twisted-Python] Deferred model
Message-ID: <1068681959.7644.1.camel@pcmarie>

Hello

Can someone provide me a good example of a deferred model in woven ?
I have a big model to build, and the page takes a long time to render...
I didn't find any help on twisted site :(

thx for help
--
Philippe




From jsbenson at bensonsystems.com  Wed Nov 12 20:57:47 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Wed, 12 Nov 2003 19:57:47 -0800
Subject: [Twisted-Python] help please: trouble installing twisted python on Windows 2000 Pro, but not Windows XP Pro
Message-ID: <02f901c3a99a$4eef28e0$8209500a@jsbwxp3>

Hi, I just installed twisted python on my Windows XP laptop which has Python 2.3.2.

I went to install it on Windows 2000 Professional version 5.00.2195 Service Pack 4 running Python 2.3 and got the following dialog box diagnostic: "Setup: CreateFile failed; code 5. Access is denied." I've been able to install piles of stuff on this system before, so I figure I have the required administrative privileges. I logon to a Windows domain, and my ID is in the Administrators group of the domain. There is a separate Administrator logon local to the machine which I haven't used, and probably can't get the password for, since this is a managed PC within the domain.

Here are my questions:

1) What does the "code 5" failure mean?

2) What am I doing wrong?

3) Can I just move the twisted site-package folders over from my XP system Python 2.3 folder to the corresponding Windows 2000 Pro folder? I'm mostly interested in just importing the twisted modules and prototyping; I can do without the icons and start menu entries.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031112/96e145b0/attachment.html>

From twisted at zadka.site.co.il  Thu Nov 13 00:44:03 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 13 Nov 2003 07:44:03 -0000
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>
References: <1643.65.246.170.211.1068661506.squirrel@192.168.0.2>, <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
    <20031111195034.GA14487@intarweb.us>
Message-ID: <20031113074403.2304.qmail@green.zadka.com>

On Wed, 12 Nov 2003, "Phil Christensen" <phil at bubblehouse.org> wrote:

> so i followed jp's advice, and my makeService method now looks like this:
> 
> 
> ###############code#################
> def makeService(config):
>     registry = Registry()
>     reg_service = RegistryService(registry)
>     portal = Portal(auth.InnerSpaceRealm(reg_service))
>     checker = auth.RegistryChecker(registry)
>     portal.registerChecker(checker)
>     pb_service = internet.TCPServer(int(config['port']),
>                                     pb.PBServerFactory(portal))
>     reg_service.setServiceParent(pb_service)
>     return pb_service

Don't use a TCPServer as a parent, use a multi-service

    m = service.MultiService()
    reg_service.setServiceParent(m)
    pb_service.setServiceParent(m)
    return m



From sam at twistedmatrix.com  Thu Nov 13 12:45:52 2003
From: sam at twistedmatrix.com (Sam Jordan)
Date: Fri, 14 Nov 2003 05:45:52 +1000
Subject: [Twisted-Python] SSL.SysCallError in doRead
Message-ID: <20031113194552.GA26576@psychlaw.com.au>

Hi,

I noted the following exception while running some msn related
code earlier:

2003/11/14 05:09 EST [PassportLogin,client] Traceback (most recent call last):
          File "/home/sam/Twisted/twisted/python/log.py", line 65, in callWithLogger
            callWithContext({"system": lp}, func, *args, **kw)
          File "/home/sam/Twisted/twisted/python/log.py", line 52, in callWithContext
            return context.call({ILogContext: newCtx}, func, *args, **kw)
          File "/home/sam/Twisted/twisted/python/context.py", line 32, in callWithContext
            return func(*args,**kw)
          File "/home/sam/Twisted/twisted/internet/default.py", line 513, in _doReadOrWrite
            why = getattr(selectable, method)()
        --- <exception caught here> ---
          File "/home/sam/Twisted/twisted/internet/tcp.py", line 98, in doRead
            return Connection.doRead(self)
          File "/home/sam/Twisted/twisted/internet/tcp.py", line 234, in doRead
            data = self.socket.recv(self.bufferSize)
        SSL.SysCallError: (104, 'Connection reset by peer')

On closer inspection it seems that the surrounding try/except clause only
cares about SSL.SysCallErrors which pertain to unexpected EOF and all others
are re-raised. The only reason I can come up with for why this is the case is
that it was not anticipated that other exceptions (like the one above) could
arise from the given recv call. I would expect that in the above instance,
connectionLost should be called, but it may very well be that i'm missing some
subtlety so I am yet to submit a bug report.

Cheers,

Sam.



From syver-en at online.no  Thu Nov 13 06:29:28 2003
From: syver-en at online.no (Syver Enstad)
Date: 13 Nov 2003 14:29:28 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068681959.7644.1.camel@pcmarie>
References: <1068681959.7644.1.camel@pcmarie>
Message-ID: <ud6bwtn0n.fsf@online.no>

Philippe Lafoucrire <lafou at wanadoo.fr> writes:

> Hello
> 
> Can someone provide me a good example of a deferred model in woven ?
> I have a big model to build, and the page takes a long time to
> render...

from twisted.web.woven.page import Page
from twised.internet import defer

class OurPage(Page):
    template = '''<html><body>
    <p model="deferredModel" view="Text"></p>
    </body></html>'''
    def wmfactory_deferredModel(self, request):
        """ returns an already callbacked
        Deferred with the string 'Hello world' as it's result
        """
        return defer.succeed('Hello world')


Okay?


-- 

Syver Enstad




From syver-en at online.no  Thu Nov 13 06:32:05 2003
From: syver-en at online.no (Syver Enstad)
Date: 13 Nov 2003 14:32:05 +0100
Subject: [Twisted-Python] help please: trouble installing twisted python on Windows 2000 Pro, but not Windows XP Pro
In-Reply-To: <02f901c3a99a$4eef28e0$8209500a@jsbwxp3>
References: <02f901c3a99a$4eef28e0$8209500a@jsbwxp3>
Message-ID: <u8ymktmwa.fsf@online.no>

"John Benson" <jsbenson at bensonsystems.com> writes:

> I went to install it on Windows 2000 Professional version 5.00.2195
> Service Pack 4 running Python 2.3 and got the following dialog box
> diagnostic: "Setup: CreateFile failed; code 5. Access is denied."
> I've been able to install piles of stuff on this system before, so I
> figure I have the required administrative privileges. I logon to a
> Windows domain, and my ID is in the Administrators group of the
> domain.

What is important here is if you or the group you are member of in the
domain has administrative privileges on the local machine. Check out
computer managment (or whatever) and see which users/groups are
members of the adminstrators group on the local machine (not the
domain admins). 

-- 

Syver Enstad




From exarkun at intarweb.us  Thu Nov 13 07:15:51 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 13 Nov 2003 09:15:51 -0500
Subject: [Twisted-Python] SSL.SysCallError in doRead
In-Reply-To: <20031113194552.GA26576@psychlaw.com.au>
References: <20031113194552.GA26576@psychlaw.com.au>
Message-ID: <20031113141551.GA24724@intarweb.us>

On Fri, Nov 14, 2003 at 05:45:52AM +1000, Sam Jordan wrote:
> Hi,
> 
> I noted the following exception while running some msn related
> code earlier:
> 
> 2003/11/14 05:09 EST [PassportLogin,client] Traceback (most recent call last):
>           File "/home/sam/Twisted/twisted/python/log.py", line 65, in callWithLogger
>             callWithContext({"system": lp}, func, *args, **kw)
>           File "/home/sam/Twisted/twisted/python/log.py", line 52, in callWithContext
>             return context.call({ILogContext: newCtx}, func, *args, **kw)
>           File "/home/sam/Twisted/twisted/python/context.py", line 32, in callWithContext
>             return func(*args,**kw)
>           File "/home/sam/Twisted/twisted/internet/default.py", line 513, in _doReadOrWrite
>             why = getattr(selectable, method)()
>         --- <exception caught here> ---
>           File "/home/sam/Twisted/twisted/internet/tcp.py", line 98, in doRead
>             return Connection.doRead(self)
>           File "/home/sam/Twisted/twisted/internet/tcp.py", line 234, in doRead
>             data = self.socket.recv(self.bufferSize)
>         SSL.SysCallError: (104, 'Connection reset by peer')
> 
> On closer inspection it seems that the surrounding try/except clause only
> cares about SSL.SysCallErrors which pertain to unexpected EOF and all others
> are re-raised. The only reason I can come up with for why this is the case is
> that it was not anticipated that other exceptions (like the one above) could
> arise from the given recv call. I would expect that in the above instance,
> connectionLost should be called, but it may very well be that i'm missing some
> subtlety so I am yet to submit a bug report.

  In tcp.py, on line 114, this exception is being caught and logged, then
CONNECTION_LOST is being returned, which should cause all the appropriate
lost-connection-callbacks to be invoked.

  The error is logged just to err on the side of being overly informative. 
It shouldn't interfere with connectionLost or clientConnectionLost.  If it
is, please do file a bug report.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031113/eb30d119/attachment.sig>

From lafou at wanadoo.fr  Thu Nov 13 09:36:37 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Thu, 13 Nov 2003 17:36:37 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <ud6bwtn0n.fsf@online.no>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
Message-ID: <1068741397.4978.0.camel@pcmarie>

> from twisted.web.woven.page import Page
> from twised.internet import defer
> 
> class OurPage(Page):
>     template = '''<html><body>
>     <p model="deferredModel" view="Text"></p>
>     </body></html>'''
>     def wmfactory_deferredModel(self, request):
>         """ returns an already callbacked
>         Deferred with the string 'Hello world' as it's result
>         """
>         return defer.succeed('Hello world')
> 
> 
> Okay?


Lovely :)

thank you !




From justinjohnson at fastmail.fm  Thu Nov 13 09:38:59 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 13 Nov 2003 10:38:59 -0600
Subject: [Twisted-Python] LivePage CACHING Problem
Message-ID: <20031113163859.5A293415FE@server1.messagingengine.com>

Hi,

I am currently trying to use LivePage to update the cells of an html
table with results from processes initiated in various PB services.  The
client intiates requests in the services and those services call back
into the client's (a pb.Referenceable) remote_updateStatus method to
update the table which displays the results.  I have test code that
simulates this and everything works fine.  Javascript is sent to the
browser to update the cells of the table.  Works really slick.  However,
now that I tried to hook it up to PB, the LivePage javascript sending
part isn't working.  When I make the page.sendScript(script) call I get
the following in the log.

2003/11/13 10:25 CST [Broker,client] Sending javascript to page
<twisted.web.woven.utils.WovenLivePage instance at 0x4089944c>
2003/11/13 10:25 CST [Broker,client] CACHING
[<twisted.web.woven.utils.Script instance at 0x4089906c>]

All future sendScript calls append the script to the cache.  Everything
else is working appropriately, and all code is executing as I'd expect,
except that the javascript doesn't send properly.  Is there something in
particular I should be looking for here?  I don't see what I'm doing
different, but since LivePage is quite magical to me I'm not sure where
to look.

On a slightly different note, is there LivePage-ish support in nevow, and
do you recommend moving to that yet?

Thanks.
-Justin



From lafou at wanadoo.fr  Thu Nov 13 09:39:42 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Thu, 13 Nov 2003 17:39:42 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <ud6bwtn0n.fsf@online.no>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
Message-ID: <1068741582.4980.2.camel@pcmarie>

> from twisted.web.woven.page import Page
> from twised.internet import defer
> 
> class OurPage(Page):
>     template = '''<html><body>
>     <p model="deferredModel" view="Text"></p>
>     </body></html>'''
>     def wmfactory_deferredModel(self, request):
>         """ returns an already callbacked
>         Deferred with the string 'Hello world' as it's result
>         """
>         return defer.succeed('Hello world')


Last question (sry, I'm still a newbie in twisted :p) :
where do I put my blocking code ? just before the defer.succeed ??




From phil at bubblehouse.org  Thu Nov 13 09:46:09 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Thu, 13 Nov 2003 11:46:09 -0500 (EST)
Subject: [Twisted-Python] Interfaces
Message-ID: <1172.65.246.170.211.1068741969.squirrel@192.168.0.2>

first of all, just wanted to thank you guys for all your help. i'm really
starting to get some of the more advanced stuff in twisted, and it's
definitely totally cool...

i was wondering if someone could give me a quick explanation of how
interfaces work in twisted, or point me towards the right docstrigns to
read...

thanks,

-phil



From justinjohnson at fastmail.fm  Thu Nov 13 10:02:43 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 13 Nov 2003 11:02:43 -0600
Subject: [Twisted-Python] Interfaces
In-Reply-To: <1172.65.246.170.211.1068741969.squirrel@192.168.0.2>
References: <1172.65.246.170.211.1068741969.squirrel@192.168.0.2>
Message-ID: <20031113170243.4465A3D835@server1.messagingengine.com>

I found the following doc to be quite useful.

http://twistedmatrix.com/documents/howto/components


On Thu, 13 Nov 2003 11:46:09 -0500 (EST), "Phil Christensen"
<phil at bubblehouse.org> said:
> first of all, just wanted to thank you guys for all your help. i'm really
> starting to get some of the more advanced stuff in twisted, and it's
> definitely totally cool...
> 
> i was wondering if someone could give me a quick explanation of how
> interfaces work in twisted, or point me towards the right docstrigns to
> read...
> 
> thanks,
> 
> -phil
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From justinjohnson at fastmail.fm  Thu Nov 13 10:19:09 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 13 Nov 2003 11:19:09 -0600
Subject: [Twisted-Python] LivePage CACHING Problem
In-Reply-To: <20031113163859.5A293415FE@server1.messagingengine.com>
References: <20031113163859.5A293415FE@server1.messagingengine.com>
Message-ID: <20031113171909.5C44F40AFC@server1.messagingengine.com>

I found the following post that looks similar to my problem.

http://twistedmatrix.com/pipermail/twisted-python/2003-May/004170.html

But since I have my own tap, I copied the code from web/tap.py into my
code to start up the FlashConduitFactory.  It starts up, but I get the
following errors.  Is this a bug?  Any ideas what I'm doing wrong?

2003/11/13 11:08 CST [twisted.web.woven.flashconduit.FlashConduitFactory]
connection with flash movie opened
2003/11/13 11:08 CST [FlashConduit,3,xxx.xxx.xxx.xxx] Traceback (most
recent call last):
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
          line 501, in doSelect
            _logrun(selectable, _drdw, selectable, method, dict)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
          line 65, in callWithLogger
            callWithContext({"system": lp}, func, *args, **kw)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
          line 52, in callWithContext
            return context.call({ILogContext: newCtx}, func, *args, **kw)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/context.py",
          line 32, in callWithContext
            return func(*args,**kw)
        --- <exception caught here> ---
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
          line 510, in _doReadOrWrite
            why = getattr(selectable, method)()
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/tcp.py",
          line 250, in doRead
            return self.protocol.dataReceived(data)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/protocols/basic.py",
          line 223, in dataReceived
            why = self.lineReceived(line)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/web/woven/flashconduit.py",
          line 19, in lineReceived
            session = self.factory.site.getSession(line)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/web/server.py",
          line 470, in getSession
            return self.sessions[uid]
        exceptions.KeyError: 'd01be6fe334cded345c0b029e29df7ac'

2003/11/13 11:08 CST [FlashConduit,3,xxx.xxx.xxx.xxx] connection lost



On Thu, 13 Nov 2003 10:38:59 -0600, "Justin Johnson"
<justinjohnson at fastmail.fm> said:
> Hi,
> 
> I am currently trying to use LivePage to update the cells of an html
> table with results from processes initiated in various PB services.  The
> client intiates requests in the services and those services call back
> into the client's (a pb.Referenceable) remote_updateStatus method to
> update the table which displays the results.  I have test code that
> simulates this and everything works fine.  Javascript is sent to the
> browser to update the cells of the table.  Works really slick.  However,
> now that I tried to hook it up to PB, the LivePage javascript sending
> part isn't working.  When I make the page.sendScript(script) call I get
> the following in the log.
> 
> 2003/11/13 10:25 CST [Broker,client] Sending javascript to page
> <twisted.web.woven.utils.WovenLivePage instance at 0x4089944c>
> 2003/11/13 10:25 CST [Broker,client] CACHING
> [<twisted.web.woven.utils.Script instance at 0x4089906c>]
> 
> All future sendScript calls append the script to the cache.  Everything
> else is working appropriately, and all code is executing as I'd expect,
> except that the javascript doesn't send properly.  Is there something in
> particular I should be looking for here?  I don't see what I'm doing
> different, but since LivePage is quite magical to me I'm not sure where
> to look.
> 
> On a slightly different note, is there LivePage-ish support in nevow, and
> do you recommend moving to that yet?
> 
> Thanks.
> -Justin
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From mesozoic at polynode.com  Thu Nov 13 11:33:36 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Thu, 13 Nov 2003 13:33:36 -0500
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068741582.4980.2.camel@pcmarie>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
	 <1068741582.4980.2.camel@pcmarie>
Message-ID: <1068748415.939.374.camel@hyla>

On Thu, 2003-11-13 at 11:39, Philippe Lafoucrire wrote:
> where do I put my blocking code ? just before the defer.succeed ??

I'm sure this has been answered a million times before, but here goes...

Deferreds do not magically turn blocking code into non-blocking code. If
you place blocking code in a wmfactory_ method, it will still interfere
with the event loop.

If you have blocking code, you can either rewrite it in a non-blocking
manner, or you can use a separate thread to run it.
<http://twistedmatrix.com/documents/howto/threading>

If you give more detail about what you're trying to do, I'm sure one of
the Twisted gurus can explain what the best approach(es) might be.

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031113/2d361a81/attachment.sig>

From lafou at wanadoo.fr  Thu Nov 13 14:14:16 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Thu, 13 Nov 2003 22:14:16 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068748415.939.374.camel@hyla>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
	 <1068741582.4980.2.camel@pcmarie>  <1068748415.939.374.camel@hyla>
Message-ID: <1068758056.6001.4.camel@pcmarie>

> I'm sure this has been answered a million times before, but here goes...

I'm sure too. But I proposed a long time ago (and several times) to use
a forum instead of a mailing list... 

> Deferreds do not magically turn blocking code into non-blocking code. If
> you place blocking code in a wmfactory_ method, it will still interfere
> with the event loop.
> 
> If you have blocking code, you can either rewrite it in a non-blocking
> manner, or you can use a separate thread to run it.
> <http://twistedmatrix.com/documents/howto/threading>
> 
> If you give more detail about what you're trying to do, I'm sure one of
> the Twisted gurus can explain what the best approach(es) might be.

I thought of using the setUp method of page. I can start the calculation
when the page loads, but I don't know what to call (in the callback)
when it's done (a wmfactory_xxx ?). I'll check the threading part you
gave me. Thank you !

-- 
Philippe




From radix at twistedmatrix.com  Thu Nov 13 15:04:15 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 13 Nov 2003 17:04:15 -0500
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068758056.6001.4.camel@pcmarie>
References: <1068681959.7644.1.camel@pcmarie> <ud6bwtn0n.fsf@online.no> <1068741582.4980.2.camel@pcmarie> <1068748415.939.374.camel@hyla> <1068758056.6001.4.camel@pcmarie>
Message-ID: <20031113220415.GG563@radii>

On Thu, Nov 13, 2003 at 10:14:16PM +0100, Philippe Lafoucri?re wrote:
> 
> > I'm sure this has been answered a million times before, but here goes...
> 
> I'm sure too. But I proposed a long time ago (and several times) to use
> a forum instead of a mailing list... 

This is a terrible excuse. Not only do we have our *own* archives:

http://twistedmatrix.com/pipermail/twisted-python 

which, of course, are searchable via google: 

"deferred blocking code site:twistedmatrix.com"

there are *multiple* archives elsewhere that have a built-in search
functionality as well:

http://marc.free.net.ph/list/twisted-python.html

http://news.gmane.org/gmane.comp.python.twisted

I found these with a trivial amount of googling: "twisted-python
mailing list"

Having searchable archives is obviously no reason to switch to a web
forum (ugh), as we have that right now.

> > If you give more detail about what you're trying to do, I'm sure one of
> > the Twisted gurus can explain what the best approach(es) might be.
> 
> I thought of using the setUp method of page. I can start the calculation
> when the page loads, but I don't know what to call (in the callback)
> when it's done (a wmfactory_xxx ?). I'll check the threading part you
> gave me. Thank you !

Unfortunately, I don't think there's any special support in Woven to
handle Deferreds from setUp. You can return Deferreds from
wmfactory_XXX and Woven will handle them correctly: it will not finish
rendering the page until that Deferred has fired and the model is
ready.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From jon at totient.demon.co.uk  Thu Nov 13 15:38:26 2003
From: jon at totient.demon.co.uk (Jon Dyte)
Date: Thu, 13 Nov 2003 22:38:26 +0000
Subject: [Twisted-Python] adbapi.Augmention
Message-ID: <200311132238.26796.jon@totient.demon.co.uk>

Hi 

the doc string of adbapi.Augmentation mentions just using the ConnectionPool 
directly.

"A class which augments a database connector with some functionality.
This class is now deprecated. Just use the ConnectionPool directly.
Conventional usage of me is to write methods that look like..."


Presumbably this means DONT inherit from ConnectionPool like you
used to inherit from Augmentation( or am I reading that incorrectly)
and just create a ConnectionPool instance and run the queries through that.



Jon 



From radix at twistedmatrix.com  Thu Nov 13 15:27:43 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 13 Nov 2003 17:27:43 -0500
Subject: [Twisted-Python] adbapi.Augmention
In-Reply-To: <200311132238.26796.jon@totient.demon.co.uk>
References: <200311132238.26796.jon@totient.demon.co.uk>
Message-ID: <20031113222743.GH563@radii>

On Thu, Nov 13, 2003 at 10:38:26PM +0000, Jon Dyte wrote:
> Presumbably this means DONT inherit from ConnectionPool like you
> used to inherit from Augmentation( or am I reading that incorrectly)
> and just create a ConnectionPool instance and run the queries through that.

right.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From golux at comcast.net  Thu Nov 13 15:47:42 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Thu, 13 Nov 2003 17:47:42 -0500
Subject: [Twisted-Python] adbapi.Augmention
In-Reply-To: <200311132238.26796.jon@totient.demon.co.uk>
References: <200311132238.26796.jon@totient.demon.co.uk>
Message-ID: <3FB40A0E.4080508@comcast.net>

Jon Dyte wrote:

> the doc string of adbapi.Augmentation mentions just using the ConnectionPool 
> directly.
> 
> "A class which augments a database connector with some functionality.
> This class is now deprecated. Just use the ConnectionPool directly.
> Conventional usage of me is to write methods that look like..."
> 
> Presumbably this means DONT inherit from ConnectionPool like you
> used to inherit from Augmentation( or am I reading that incorrectly)
> and just create a ConnectionPool instance and run the queries through that.

Christopher Armstrong wrote:

> right.

But I think it works okay to subclass ConnectionPool ...
at least, it works for me.  Is there a better way to
do something like the following (which is working fine)?
(Admittedly you need to see my other modules for the full
picture, but you can infer what they would do ... as
you can probably guess, I don't use t.e.row.RowObject.)

----------------------------------------------------------------

# Twisted imports ...
from twisted.enterprise import adbapi
from twisted.internet import defer
from twisted.python import log, reflect
# Pan Galactic imports ...
from pangalactic.utils import sql, utils

class PgerDb(adbapi.ConnectionPool):
     """
     I am PGERDB, implemented using the Twisted Enterprise adbapi
     and pyPgSQL on top of the PGERDB Master Schema.
     """

     def __init__(self, dbapiname='pyPgSQL.PgSQL', database='pgerdb'):
         adbapi.ConnectionPool.__init__(self,
                                        dbapiname,
                                        database=database)
         self.dbname = database

     def doPgerdbQuery(self, table, subtypes, *args, **kw):
         """
         Run a query submitted as a list of args against a
         specified table.

         @type table:  string
         @param table: name of the table to search

         @type subtypes:  boolean
         @param subtypes: whether to search only the specified
                          table (False) or to include all subtype
                          tables (True)

         @type args:   list of tuples
         @param args:  a list of tuples, in which each tuple has the
                       tuple has the form:
                         - element[0] = column name
                         - element[1] = search value
                         - element[2] = operator
                       where I{operator} can be any SQL binary
                       operator.

         @param kw:    (optional kw arg)

                       B{sort}: column(s) to be sorted on -- this
                       can be either a string (a single column
                       name) or a list or tuple of column names
         """
         if args:
             sqlargs = sql.buildSelect(table, subtypes, *args, **kw)
             return self.runQuery(*sqlargs)
         else:
             raise TypeError, 'I need at least one search parameter'

     def getByRowKey(self, rowkey):
         """
         Get the resultset for this rowkey.

         @type rowkey:  list
         @param rowkey: a rowkey (for more about rowkeys, see
                        L{pangalactic.repo.factory.record2RowKey})

         @rtype:   a PgResultSet
         @return:  the result set that matches this rowkey.
         """
         sqlargs = sql.buildSelectFromRowKey(rowkey)
         return self.runQuery(*sqlargs)

     def addRow(self, table, *args, **kw):
         """
         Add a row to the specified table.

         @type table:  string
         @param table: name of the table to search

         @type args:   list
         @param args:  a list of 2-tuples:
                       [(colname, value), ...]

         @type kw:     dictionary
         @param kw:    {colname : value, ...}
         """
         parmdict = kw or dict(args)
         sqlcmd, parms = sql.buildInsert(table, parmdict)
         d = self.runOperation(sqlcmd, *parms)
         logmsg = 'addRow:  1 row added to %s table.' % table
         d.addCallback(lambda x: self._addRowDone(x, logmsg))
         d.addErrback(self.operationError)
         return d

     def _addRowDone(self, d, logmsg):
         """Callback for addRow success.
         """
         log.msg("%s operation %s" % (reflect.qual(self.__class__), logmsg))
         return d

     def addRows(self, records):
         """
         Add a series of rows, in a single transaction, from a
         list of records (for a description of "records", see
         L{pangalactic.repo.factory.extract2Record}).

         @type records:  list
         @param records: a list of records -- see
                         L{pangalactic.utils.factory} for the
                         definition of an extract
         """
         tables = utils.unique([rec[0] for rec in records])
         sqlstmt, parms = sql.buildTransactionalInsert(records)
         d = self.runOperation(sqlstmt, *parms)
         logmsg = 'addRows: rows added to tables %s.' % str(tables)
         d.addCallback(lambda x: self._addRowsConfirm(x, logmsg))
         d.addErrback(self.interactionError)
         return d

     def _addRowsConfirm(self, d, logmsg):
         """
         Callback for addRows success.
         """
         log.msg("%s %s" % (reflect.qual(self.__class__), logmsg))
         return d

     def operationDone(self, done):
         """
         Callback for database operation success.
         """
         log.msg("%s Operation done: %s" % (reflect.qual(self.__class__), done))

     def operationError(self, error):
         """
         Callback for database operation failure.
         """
         log.msg("%s Operation failed: %s" % (reflect.qual(self.__class__), error))
         log.err(error)

     def interactionDone(self, done):
         """
         Callback for database interaction success.
         """
         log.msg("%s Interaction done: %s" % (reflect.qual(self.__class__), done))

     def interactionError(self, error):
         """
         Callback for database interaction failure.
         """
         log.msg("%s Interaction failed: %s" % (reflect.qual(self.__class__), error))
         log.err(error)

----------------------------------------------------------------





From radix at twistedmatrix.com  Thu Nov 13 16:03:03 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 13 Nov 2003 18:03:03 -0500
Subject: [Twisted-Python] adbapi.Augmention
In-Reply-To: <3FB40A0E.4080508@comcast.net>
References: <200311132238.26796.jon@totient.demon.co.uk> <3FB40A0E.4080508@comcast.net>
Message-ID: <20031113230303.GI563@radii>

On Thu, Nov 13, 2003 at 05:47:42PM -0500, Stephen C. Waterbury wrote:
> Jon Dyte wrote:
>
> >Presumbably this means DONT inherit from ConnectionPool like you
> >used to inherit from Augmentation( or am I reading that incorrectly)
> >and just create a ConnectionPool instance and run the queries through that.
> 
> Christopher Armstrong wrote:
> 
> >right.
> 
> But I think it works okay to subclass ConnectionPool ...
> at least, it works for me.  Is there a better way to
> do something like the following (which is working fine)?
> (Admittedly you need to see my other modules for the full
> picture, but you can infer what they would do ... as
> you can probably guess, I don't use t.e.row.RowObject.)

Sure, there's no particular reason that subclassing ConnectionPool
can't be done, but the only difference is that you're using methods
like "self.runQuery" instead of "self.db.runQuery" (after doing
"self.db = ConnectionPool(etc)". I probably wouldn't subclass unless I
actually wanted to override one of the methods in ConnectionPool with
a modified implementation and then use it in the same place that a
regular ConnectionPool is expected.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From matthew.s.hegedus at lmco.com  Thu Nov 13 16:39:42 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Thu, 13 Nov 2003 17:39:42 -0600
Subject: [Twisted-Python] Forum vs. mailing list
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>

Philippe Lafoucrire mentions his favoring of a forum over a mailing list. A
forum sounds much better to me. Topics can be nicely separated, past
knowledge can be easily searched, and email inboxes can be freed from much
clutter (or at least make room for spam). Is it not too late to implement a
forum?

Matthew Hegedus

-----Original Message-----
From: Philippe Lafoucrire [mailto:lafou at wanadoo.fr] 
Sent: Thursday, November 13, 2003 3:14 PM
To: Twisted
Subject: Re: [Twisted-Python] Deferred model



> I'm sure this has been answered a million times before, but here 
> goes...

I'm sure too. But I proposed a long time ago (and several times) to use a
forum instead of a mailing list... 

> Deferreds do not magically turn blocking code into non-blocking code. 
> If you place blocking code in a wmfactory_ method, it will still 
> interfere with the event loop.
> 
> If you have blocking code, you can either rewrite it in a non-blocking 
> manner, or you can use a separate thread to run it. 
> <http://twistedmatrix.com/documents/howto/threading>
> 
> If you give more detail about what you're trying to do, I'm sure one 
> of the Twisted gurus can explain what the best approach(es) might be.

I thought of using the setUp method of page. I can start the calculation
when the page loads, but I don't know what to call (in the callback) when
it's done (a wmfactory_xxx ?). I'll check the threading part you gave me.
Thank you !

-- 
Philippe


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From uwe at oss4u.com  Thu Nov 13 16:56:52 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Thu, 13 Nov 2003 15:56:52 -0800
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <200311131556.52724.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Well, on the other hand I wouldn't be reading that anymore. A mailinglist has 
the advantage that it comes to you. I think the likelyness of getting an 
answer is much higher with a mailinglist. To be honest I don't think that 
storing the stuff in a forum will make the FAQ's disappear. People just don't 
search thru the forum, pretty much the same as they don't read FAQ's and 
search mailinglist-archives.

On Thursday 13 November 2003 03:39 pm, Hegedus, Matthew S wrote:
> Philippe Lafoucrire mentions his favoring of a forum over a mailing list.
> A forum sounds much better to me. Topics can be nicely separated, past
> knowledge can be easily searched, and email inboxes can be freed from much
> clutter (or at least make room for spam). Is it not too late to implement a
> forum?
>
> Matthew Hegedus
>
> -----Original Message-----
> From: Philippe Lafoucrire [mailto:lafou at wanadoo.fr]
> Sent: Thursday, November 13, 2003 3:14 PM
> To: Twisted
> Subject: Re: [Twisted-Python] Deferred model
>
> > I'm sure this has been answered a million times before, but here
> > goes...
>
> I'm sure too. But I proposed a long time ago (and several times) to use a
> forum instead of a mailing list...
>
> > Deferreds do not magically turn blocking code into non-blocking code.
> > If you place blocking code in a wmfactory_ method, it will still
> > interfere with the event loop.
> >
> > If you have blocking code, you can either rewrite it in a non-blocking
> > manner, or you can use a separate thread to run it.
> > <http://twistedmatrix.com/documents/howto/threading>
> >
> > If you give more detail about what you're trying to do, I'm sure one
> > of the Twisted gurus can explain what the best approach(es) might be.
>
> I thought of using the setUp method of page. I can start the calculation
> when the page loads, but I don't know what to call (in the callback) when
> it's done (a wmfactory_xxx ?). I'll check the threading part you gave me.
> Thank you !

- -- 
	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/tBpEjqGXBvRToM4RArM1AJ4jFYsyn+Qp0/RdQwq5OQt5heN/SQCeMHsF
60pFx0YQtJggCs91Nmcg/Yo=
=6UxF
-----END PGP SIGNATURE-----




From R.Livsey at cache-22.co.uk  Thu Nov 13 17:00:42 2003
From: R.Livsey at cache-22.co.uk (Richard Livsey)
Date: Fri, 14 Nov 2003 00:00:42 +0000
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <3FB41B2A.7040702@cache-22.co.uk>

Hegedus, Matthew S wrote:

>Philippe Lafoucrire mentions his favoring of a forum over a mailing list. A
>forum sounds much better to me. Topics can be nicely separated, past
>knowledge can be easily searched, and email inboxes can be freed from much
>clutter (or at least make room for spam). Is it not too late to implement a
>forum?
>  
>
The problem with a forum is that you have to physically go and look to 
see if anything has been posted.
I like forums and have been involved in a number over the years, however 
once the workload increases I tend to find it harder and harder to find 
time to visit and eventually stop visiting altogether. My mail however, 
I always read as it's there *in your face* so to speak.
I'm lazy like that :o)

To address your main points:

- Topics can be nicely seperated
Thats what threading is for, if your mail client does not support it 
then there are many out there that do (I use Thunderbird).

- Past knowledge can be easily searched.
I can easily search through the emails I have from the past, plus 
there's always the archive (URL given in a previous post).

- Email inboxes can be freed from much clutter
Ok, I'll give you that one - although I don't class it as clutter! A 
bunch of mail filters and a handy mbox archiving
script (written in python I might add) keep my system nice and tidy :o)

/me goes back to lurking

-- 
R.Livsey
Incutio Web Developer
www.cache-22.co.uk
www.incutio.com





From radix at twistedmatrix.com  Thu Nov 13 17:08:50 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 13 Nov 2003 19:08:50 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <20031114000850.GJ563@radii>

On Thu, Nov 13, 2003 at 05:39:42PM -0600, Hegedus, Matthew S wrote:
> Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
> forum sounds much better to me. Topics can be nicely separated, past
> knowledge can be easily searched, and email inboxes can be freed from much
> clutter (or at least make room for spam). Is it not too late to implement a
> forum?

This is pointless. If you don't want to subscribe to the mailing list,
don't: just use one of the web interfaces to it that I pointed out
earlier.

If you want to post to the mailing list without requiring moderation,
and you want to read messages through the web and NOT receive them
through the mail, then subscribe and set the "nomail" option on your
account.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From bauer at mit.edu  Mon Nov 10 15:12:20 2003
From: bauer at mit.edu (Steven Bauer)
Date: Mon, 10 Nov 2003 17:12:20 -0500
Subject: [Twisted-Python] Documentation Question
Message-ID: <20031110221220.GA4281@mit.edu>

Being new to twisted I may be lacking a clue, but finding the
proper arguments to twisted.application.internet.UDPServer()
was a major pain in the butt.  

Only by looking at the code could I find all the valid arguments and
that took a lot of tracing because the valid arguments are determined by
listenudp() it seems.

Is their an easier way or is it always frustrating to determine the
acceptable arguments to an init function? 

Thanks,
Steve




From m at zadka.site.co.il  Tue Nov 11 23:39:40 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 12 Nov 2003 06:39:40 -0000
Subject: [Twisted-Python] an easy twisted application question
In-Reply-To: <20031111195034.GA14487@intarweb.us>
References: <20031111195034.GA14487@intarweb.us>, <3068.65.246.170.211.1068577419.squirrel@192.168.0.2>
Message-ID: <20031112063940.1532.qmail@green.zadka.com>

On Tue, 11 Nov 2003, Jp Calderone <exarkun at intarweb.us> wrote:

>     from twisted.application import service
> 
>     class RegistryService(service.Service):
>         def __init__(self):
>             self.registry =3D registry.Registry()
> 
>     def makeService(config):
>         s =3D RegistryService()
>         ...
>         anotherS =3D SomeotherService()
>         anotherS.setServiceParent(s)  # Or s.setServiceParent(anotherS)
>         ...
>         return s # or return anotherS

Almost correct.
The idiomatic way is

class SomeOtherService
    # .... do something interesting here
    def registry(self):
        return self.parent.getServiceNamed('registry')

def makeService(config):
    s = RegistryService()
    s.setName('registry')
    anotherS = SomeOtherService()
    m = service.MultiService()
    s.setServiceParent(m)
    anotherS.setServiceParent(m)
    return m

The trick is to have 's' and 'anotherS' completely symmetrical,
and allow them to access each other.

Everything else Jp said, including the part about "globals bad,
explicit references good" has my whole-hearted blessing.



From rc at pgdn.org  Thu Nov 13 16:59:54 2003
From: rc at pgdn.org (Robert Church)
Date: Thu, 13 Nov 2003 15:59:54 -0800
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <20031113235954.GD7130@pgdn.org>

On Thu, Nov 13, 2003 at 05:39:42PM -0600, Hegedus, Matthew S quipped:
> Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
> forum sounds much better to me. Topics can be nicely separated, past
> knowledge can be easily searched, and email inboxes can be freed from much
> clutter (or at least make room for spam). Is it not too late to implement a
> forum?

As Mr. Armstrong just explaned, you can do all this and more with
the existing mailing list archive. It's here:

http://twistedmatrix.com/pipermail/twisted-python
 
You don't need to be subscried to the list to read the archive. Topics
are nicely seperated. Posts can be easily searched using google. Is it
too late to use the tools we already have before dumping 'em for a
bulletin board? Hm?



From andrew-twisted at puzzling.org  Thu Nov 13 17:29:50 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 14 Nov 2003 11:29:50 +1100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <20031113220415.GG563@radii>
References: <1068681959.7644.1.camel@pcmarie> <ud6bwtn0n.fsf@online.no> <1068741582.4980.2.camel@pcmarie> <1068748415.939.374.camel@hyla> <1068758056.6001.4.camel@pcmarie> <20031113220415.GG563@radii>
Message-ID: <20031114002949.GF29436@frobozz>

On Thu, Nov 13, 2003 at 05:04:15PM -0500, Christopher Armstrong wrote:
> On Thu, Nov 13, 2003 at 10:14:16PM +0100, Philippe Lafoucri?re wrote:
> > 
> > > I'm sure this has been answered a million times before, but here goes...
> > 
> > I'm sure too. But I proposed a long time ago (and several times) to use
> > a forum instead of a mailing list... 
> 
> This is a terrible excuse. Not only do we have our *own* archives:
[...]

And, of course, the mailing list isn't the only source of documentation.
The official docs are far from perfect, but they're getting better (over 300
pages as a PDF, when I last checked!).

For cases like this question, there's the FAQ.  I've just checked in an
addition to it that hopefully addresses this question.  It should be visible
here in a few minutes, once buildbot does its thing:
    http://twistedmatrix.com/users/warner/doc-latest/howto/faq.html#deferreds-aren't-magic
    
-Andrew.




From glyph at twistedmatrix.com  Thu Nov 13 18:09:51 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 13 Nov 2003 20:09:51 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>

On Nov 13, 2003, at 6:39 PM, Hegedus, Matthew S wrote:

> Philippe Lafoucrire mentions his favoring of a forum over a mailing 
> list. A
> forum sounds much better to me. Topics can be nicely separated, past
> knowledge can be easily searched, and email inboxes can be freed from 
> much
> clutter (or at least make room for spam). Is it not too late to 
> implement a
> forum?

Well, others (and elsewhere, myself) have given the reasons that the 
labs won't host a forum, but I think it would be great if someone else 
would do so.  I've said before that the Twisted community needs more 
than one medium for communication, it seems that enough people here 
have a preference for forum software that it's viable to set one up.

Please send me a link to put on the tm.com site when you do so.




From matthew.s.hegedus at lmco.com  Thu Nov 13 16:43:58 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Thu, 13 Nov 2003 17:43:58 -0600
Subject: [Twisted-Python] Deferred model
Message-ID: <401C60E417B68B48B14B53D845FF596A568E72@EMSS07M12.us.lmco.com>

Oops, sorry Chris, I did not see your response. My message will surely
displease you. Please disregard since you have already made your case
defending the Twisted archives and opposing a forum.

Matthew

-----Original Message-----
From: Christopher Armstrong [mailto:radix at twistedmatrix.com] 
Sent: Thursday, November 13, 2003 4:04 PM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] Deferred model


On Thu, Nov 13, 2003 at 10:14:16PM +0100, Philippe Lafoucri?re wrote:
> 
> > I'm sure this has been answered a million times before, but here 
> > goes...
> 
> I'm sure too. But I proposed a long time ago (and several times) to 
> use a forum instead of a mailing list...

This is a terrible excuse. Not only do we have our *own* archives:

http://twistedmatrix.com/pipermail/twisted-python 

which, of course, are searchable via google: 

"deferred blocking code site:twistedmatrix.com"

there are *multiple* archives elsewhere that have a built-in search
functionality as well:

http://marc.free.net.ph/list/twisted-python.html

http://news.gmane.org/gmane.comp.python.twisted

I found these with a trivial amount of googling: "twisted-python mailing
list"

Having searchable archives is obviously no reason to switch to a web forum
(ugh), as we have that right now.

> > If you give more detail about what you're trying to do, I'm sure one 
> > of the Twisted gurus can explain what the best approach(es) might 
> > be.
> 
> I thought of using the setUp method of page. I can start the 
> calculation when the page loads, but I don't know what to call (in the 
> callback) when it's done (a wmfactory_xxx ?). I'll check the threading 
> part you gave me. Thank you !

Unfortunately, I don't think there's any special support in Woven to handle
Deferreds from setUp. You can return Deferreds from wmfactory_XXX and Woven
will handle them correctly: it will not finish rendering the page until that
Deferred has fired and the model is ready.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From phil at bubblehouse.org  Thu Nov 13 19:45:00 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Thu, 13 Nov 2003 21:45:00 -0500 (EST)
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
    <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>
Message-ID: <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>

i absolutely agree with all of your points. i don't have the hatred of
web-based interfaces that you guys seem to ;-), but i think that there is
definitely a bit of elitism coming into play.

we (as proud geeks) know all the google tricks and mailman preferences to
get things to behave as we like them to. but let's face it, there's more
to gaining "acceptance" or "market share", or whatever you want to call
it, than appealing to the developers.

obviously, that is the level twisted is at now, and i agree the need for a
forum is limited at this point. but for example, pretty soon (in the
scheme of things) people are going to want to tell their bosses about
twisted. many of you seem to be fortunate to have (or be) bosses who are
willing to take a chance on a new framework. however, to clue in the PHBs
that so many of us have making decisions, a centralized, "user-friendly",
web-based forum could be much more accessible.

and there's more than pointy-haired-bosses who could benefit from this,
such as the beginning web developer/administrator who may not think on the
same level, but could really make use of an apache alternative. i'm sure
you're all familiar with the state of IT in businesses today; many a
webmaster is lucky to be able to, forgive the expression, walk and chew
gum at the same time.

i think the biggest reason it might be worth investigating is because as
much as twisted is progressing as a project, i can see it forming a
community of developers willing to, again, please forgive the cliche,
"think outside the box." i have seen mind-blowing levels of genius come
out of this group, so much so that i once made the statement to glyph, "i
want to help, but i feel like i'm just a programmer, and all you guys are
computer scientists."

i know what you mean about using the tools that are already available, but
i think that as twisted grows, if you want the more user-oriented (as in,
non-developer-oriented) parts to be accessible, a more user-oriented
approach might be helpful.

anyways, what it comes down to is this. i've been looking for a reason to
set up this forum software i'm really fond of on my machine, but i haven't
had a reason to do so yet. i'm going to go ahead and give it a try, and
you can check it out and see if you want to bother with it or not. if not,
no big deal, and if it seems interesting and not painful to use, then we
can investigate it further...



From phil at bubblehouse.org  Thu Nov 13 19:50:09 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Thu, 13 Nov 2003 21:50:09 -0500 (EST)
Subject: [Twisted-Python] time and date
Message-ID: <65031.192.168.0.1.1068778209.squirrel@192.168.0.2>

i might just be insane, but is there something crazy going on with date
stamps on this list? about three different messages in the past two days
have weird time stamps on them, that are set in the past or the future.

i noticed some stuff in the archives like that, too. is this an accidental
user thing? or am i suffering from senile dementia exceptionally early in
my life?



From itamar at itamarst.org  Thu Nov 13 20:14:02 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 13 Nov 2003 22:14:02 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	<3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>
	<64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
Message-ID: <20031113221402.54632078.itamar@itamarst.org>

I added a google search to the site, which should also search the
mailing list archives while it's at it.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From scottanderson at comcast.net  Thu Nov 13 21:49:22 2003
From: scottanderson at comcast.net (Scott Anderson)
Date: Thu, 13 Nov 2003 23:49:22 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>    <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com> <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
Message-ID: <3FB45ED2.8050401@comcast.net>

Phil Christensen wrote:

>anyways, what it comes down to is this. i've been looking for a reason to
>set up this forum software i'm really fond of on my machine, but i haven't
>had a reason to do so yet. i'm going to go ahead and give it a try, and
>you can check it out and see if you want to bother with it or not. if not,
>no big deal, and if it seems interesting and not painful to use, then we
>can investigate it further...
>  
>

Not to further muddy the waters, but one reason I've been looking at 
Twisted was to port the software I wrote for Zope that runs at 
http://z.iwethey.org/forums -- we also have a hosting service. If you 
care to look around the site, the software gets extremely good reviews 
from the users with respect to the interface. It has full text indexing 
as well. With Twisted running behind it, I plan on integrating the 
forums with Jabber chat rooms, irc, and email.

I won't be porting it for at least a month or so, however (new baby in 
the house), but I fully intend on completing the project when I get the 
time.

Regards,
-scott





From twisted at zadka.site.co.il  Thu Nov 13 23:24:12 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 14 Nov 2003 06:24:12 -0000
Subject: [Twisted-Python] Documentation Question
In-Reply-To: <20031110221220.GA4281@mit.edu>
References: <20031110221220.GA4281@mit.edu>
Message-ID: <20031114062412.2922.qmail@green.zadka.com>

On Mon, 10 Nov 2003, Steven Bauer <bauer at mit.edu> wrote:

> Being new to twisted I may be lacking a clue, but finding the
> proper arguments to twisted.application.internet.UDPServer()
> was a major pain in the butt.  
> 
> Only by looking at the code could I find all the valid arguments and
> that took a lot of tracing because the valid arguments are determined by
> listenudp() it seems.

Did you try using help(internet.UDPServer) from the interactive interpreter?
Here's what I got:

class UDPServer(_AbstractServer)
 |  Serve UDP clients
 |
 |  Call listenUDP when the service starts, with the
 |  arguments given to the constructor. When the service stops,
 |  stop listening.

I checked in a fix to make it say "reactor.listenUDP" -- I guess it was
just a blindspot of me, I knew what listenUDP means :)
Anyway, this should not have required any "looking at the code".
Hopefully with my fix you'll be able to know you should do
help(reactor.listenUDP) to get the information you're after:

>>> help(reactor.listenUDP)
Help on method listenUDP in module twisted.internet.default:

listenUDP(self, port, protocol, interface='', maxPacketSize=8192) method of twis
ted.internet.default.SelectReactor instance
    Connects a given L{DatagramProtocol} to the given numeric UDP port.

I realize that the indirection is a pain, but it'd be somewhat annoying
(not impossible, though) to lose it, and I would prefer not to do it
unless it's a real deal breaker for someone.

In general, I highly recommend using help() from the interactive interpreter
to read the docstrings of stuff, and see how to call it. If this strategy
does not give you information for a specific method/class, you should
file a documentation bug in http://twistedmatrix.com/bugs -- while
ideally everything should have a docstring, the developers have so much
time, so prioritizing by stuff people need is a necessity.



From rudy.schockaert at pandora.be  Thu Nov 13 23:54:27 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Fri, 14 Nov 2003 07:54:27 +0100
Subject: [Twisted-Python] Documentation Question
In-Reply-To: <20031114062412.2922.qmail@green.zadka.com>
References: <20031110221220.GA4281@mit.edu> <20031114062412.2922.qmail@green.zadka.com>
Message-ID: <3FB47C23.9010109@pandora.be>

>In general, I highly recommend using help() from the interactive interpreter
>to read the docstrings of stuff, and see how to call it. 
>  
>

You can always start using Stani's Python Editor SPE ( 
http://spe.pycs.net/ ) which automagically shows you the docstring and 
required parameterlist. ;-)




From john at landahl.org  Fri Nov 14 00:14:05 2003
From: john at landahl.org (John Landahl)
Date: Thu, 13 Nov 2003 23:14:05 -0800
Subject: [Twisted-Python] Documentation Question
In-Reply-To: <20031114062412.2922.qmail@green.zadka.com>
References: <20031110221220.GA4281@mit.edu> <20031114062412.2922.qmail@green.zadka.com>
Message-ID: <opryl81rpck1a6kk@sfmail3>

On 14 Nov 2003 06:24:12 -0000, Moshe Zadka <twisted at zadka.site.co.il> 
wrote:
> In general, I highly recommend using help() from the interactive 
> interpreter to read the docstrings of stuff, and see how to call it.

And with IPython it's even simpler, e.g. "help reactor.listenUDP".  
IPython does the parens for you, allowing for new heights of laziness. :)

If the docstrings aren't enough and you want to see the source after all, 
"psource reactor.listenUDP" shows you the source for just that single 
function, in pretty colors, even.

And you can't beat the tab completion: "reactor.listen<TAB>" shows you 
lots of interesting things.

Sure, it's slow to load, but IPython takes the interactive Python 
experience to a whole new level, especially in situations like this where 
you're exploring new (to you) code.

Oh yeah, try the @pdb option, which automatically launches the debugger 
*at the point of failure* when an uncaught exception occurs.  Alas, since 
the reactor catches all exceptions, this won't help much with Twisted apps.

_jpl_ (a satisfied customer)



From illumen at yahoo.com  Fri Nov 14 00:47:14 2003
From: illumen at yahoo.com (Rene Dudfield)
Date: Fri, 14 Nov 2003 17:47:14 +1000
Subject: ipython rox was(Re: [Twisted-Python] Documentation Question)
In-Reply-To: <opryl81rpck1a6kk@sfmail3>
References: <20031110221220.GA4281@mit.edu> <20031114062412.2922.qmail@green.zadka.com> <opryl81rpck1a6kk@sfmail3>
Message-ID: <3FB48882.2080600@yahoo.com>

John Landahl wrote:

> On 14 Nov 2003 06:24:12 -0000, Moshe Zadka <twisted at zadka.site.co.il> 
> wrote:
>
>> In general, I highly recommend using help() from the interactive 
>> interpreter to read the docstrings of stuff, and see how to call it.
>
>
> And with IPython it's even simpler, e.g. "help reactor.listenUDP".  
> IPython does the parens for you, allowing for new heights of laziness. :)
>
> If the docstrings aren't enough and you want to see the source after 
> all, "psource reactor.listenUDP" shows you the source for just that 
> single function, in pretty colors, even.
>
> And you can't beat the tab completion: "reactor.listen<TAB>" shows you 
> lots of interesting things.
>
> Sure, it's slow to load, but IPython takes the interactive Python 
> experience to a whole new level, especially in situations like this 
> where you're exploring new (to you) code.
>
> Oh yeah, try the @pdb option, which automatically launches the 
> debugger *at the point of failure* when an uncaught exception occurs.  
> Alas, since the reactor catches all exceptions, this won't help much 
> with Twisted apps.
>
> _jpl_ (a satisfied customer)


I too love ipython :)  Especially since the deep reload command works 
fairly well.  Has macros too.  You can access the lines that you type in 
as a list.  Which makes getting a copy of code you type in there 
easier.  Oh and you can use !ls for shell commands.  More features at 
the website:

http://ipython.scipy.org/



Have fun!
http://www.holepit.com/




From lafou at wanadoo.fr  Fri Nov 14 03:41:18 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 14 Nov 2003 11:41:18 +0100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <200311131556.52724.uwe@oss4u.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	 <200311131556.52724.uwe@oss4u.com>
Message-ID: <1068806478.4923.18.camel@pcmarie>

> Well, on the other hand I wouldn't be reading that anymore. A mailinglist has 
> the advantage that it comes to you. I think the likelyness of getting an 
> answer is much higher with a mailinglist. To be honest I don't think that 
> storing the stuff in a forum will make the FAQ's disappear. People just don't 
> search thru the forum, pretty much the same as they don't read FAQ's and 
> search mailinglist-archives.


The question is not to use the ML OR the forum, but both of them. While
the Ml could be more "dev" oriented, the forum would help newbies to
find answers quicker than in the mailing list. Forums.gentoo.org and
gentoo-user or gentoo-dev mailings lists are a good exemple (there an
irc channel too). Forums.gentoo.org are very popular with their features
(categorize information, advanced search + highlight words, answers are
notified by mail, etc.).

I know Glyph don't want to hear about phpBB, because it's not written
using python&twisted. So, what's the solution ? Create a brand new forum
system using twisted ? Volonteers ? Roundup is quite good, and show the
right road. Twisted needs some killer apps.

--
Philippe




From lafou at wanadoo.fr  Fri Nov 14 05:57:09 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 14 Nov 2003 13:57:09 +0100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031113221402.54632078.itamar@itamarst.org>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	 <3FD33C76-163F-11D8-B1BF-000393C9700E@twistedmatrix.com>
	 <64818.192.168.0.1.1068777900.squirrel@192.168.0.2>
	 <20031113221402.54632078.itamar@itamarst.org>
Message-ID: <1068814629.4923.24.camel@pcmarie>

On Fri, 2003-11-14 at 04:14, Itamar Shtull-Trauring wrote:
> I added a google search to the site, which should also search the
> mailing list archives while it's at it.

Great idea !
Thank you




From lafou at wanadoo.fr  Fri Nov 14 06:01:12 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 14 Nov 2003 14:01:12 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <20031114002949.GF29436@frobozz>
References: <1068681959.7644.1.camel@pcmarie> <ud6bwtn0n.fsf@online.no>
	 <1068741582.4980.2.camel@pcmarie> <1068748415.939.374.camel@hyla>
	 <1068758056.6001.4.camel@pcmarie> <20031113220415.GG563@radii>
	 <20031114002949.GF29436@frobozz>
Message-ID: <1068814872.4923.26.camel@pcmarie>

>     http://twistedmatrix.com/users/warner/doc-latest/howto/faq.html#deferreds-aren't-magic

the link
http://twistedmatrix.com/documents/TwistedDocs/TwistedDocs-/api/twisted.internet.threads.deferToThread.html
is broken in the faq (defertoThread)




From lafou at wanadoo.fr  Fri Nov 14 08:34:02 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Fri, 14 Nov 2003 16:34:02 +0100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068748415.939.374.camel@hyla>
References: <1068681959.7644.1.camel@pcmarie>  <ud6bwtn0n.fsf@online.no>
	 <1068741582.4980.2.camel@pcmarie>  <1068748415.939.374.camel@hyla>
Message-ID: <1068824042.4927.36.camel@pcmarie>

> If you give more detail about what you're trying to do, I'm sure one of
> the Twisted gurus can explain what the best approach(es) might be.

I'm trying to manage my gentoo box with a twisted server (A linux
Distro). Portage is very slow, and build the package first level tree
can take several seconds. I just wanted my page not to block while
loading, and put the result in it when it becomes available.

The list of the category is in a "wmupdate_category(self, request)"
method, in which I'd like to use deferreds.

Thank you gurus for your help !

--
Philippe - kind of lost sometimes with twisted :p




From itamar at itamarst.org  Fri Nov 14 10:29:27 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 14 Nov 2003 12:29:27 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <1068806478.4923.18.camel@pcmarie>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	<200311131556.52724.uwe@oss4u.com>
	<1068806478.4923.18.camel@pcmarie>
Message-ID: <20031114122927.362dcdc3.itamar@itamarst.org>

On Fri, 14 Nov 2003 11:41:18 +0100
Philippe Lafoucrire <lafou at wanadoo.fr> wrote:

> I know Glyph don't want to hear about phpBB, because it's not written
> using python&twisted. So, what's the solution ? Create a brand new
> forum system using twisted ? Volonteers ? Roundup is quite good, and
> show the right road. Twisted needs some killer apps.

If you want to use phpbb I doubt anyone will boycott it. Again, anyone
who wants to can setup a forum. Roundup is not a twisted product, it's a
CGI.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From cce at clarkevans.com  Fri Nov 14 14:01:00 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Fri, 14 Nov 2003 16:01:00 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
Message-ID: <20031114210100.GA70172@clarkevans.com>

Matthew,

A forum does not solve the core issue of organizing information
into a clear hierarchy of topics, filtering relevant questions
and answers, and a whole host of other items.  While a Wiki or
a Forum could be useful, it will only work if there are several
people who care about its structure, moderate it, and work
hard to make the information useful.   Other than that, threaded
email works just as well.  

IMHO, an AutoFAQ would be more appropriate, in particular, if you
or someone else dedicates significant _time_ to make sure that it
stays orderly and useful.   Sort of a AutoFAQ, you could simply
implement or edit a FAQ.  I'm sure if you kept one up-to-date 
it would glady find its way into the source code.

Probably a more "helpful" item would be a "Weekly Report" 
like the Python Developer's list has.  Some dutiful individual
there scans all of the things discussed, lists the topics
discussed, summarizes them into a single paragaraph and 
provides links to particularly insighful emails.  In my 
opinion, this would be far more useful..

Clark

On Thu, Nov 13, 2003 at 05:39:42PM -0600, Hegedus, Matthew S wrote:
| Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
| forum sounds much better to me. Topics can be nicely separated, past
| knowledge can be easily searched, and email inboxes can be freed from much
| clutter (or at least make room for spam). Is it not too late to implement a
| forum?
| 
| Matthew Hegedus
| 
| -----Original Message-----
| From: Philippe Lafoucri?re [mailto:lafou at wanadoo.fr] 
| Sent: Thursday, November 13, 2003 3:14 PM
| To: Twisted
| Subject: Re: [Twisted-Python] Deferred model
| 
| 
| 
| > I'm sure this has been answered a million times before, but here 
| > goes...
| 
| I'm sure too. But I proposed a long time ago (and several times) to use a
| forum instead of a mailing list... 
| 
| > Deferreds do not magically turn blocking code into non-blocking code. 
| > If you place blocking code in a wmfactory_ method, it will still 
| > interfere with the event loop.
| > 
| > If you have blocking code, you can either rewrite it in a non-blocking 
| > manner, or you can use a separate thread to run it. 
| > <http://twistedmatrix.com/documents/howto/threading>
| > 
| > If you give more detail about what you're trying to do, I'm sure one 
| > of the Twisted gurus can explain what the best approach(es) might be.
| 
| I thought of using the setUp method of page. I can start the calculation
| when the page loads, but I don't know what to call (in the callback) when
| it's done (a wmfactory_xxx ?). I'll check the threading part you gave me.
| Thank you !
| 
| -- 
| Philippe
| 
| 
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
| 
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
| 



From radix at twistedmatrix.com  Fri Nov 14 14:39:21 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Fri, 14 Nov 2003 16:39:21 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031114210100.GA70172@clarkevans.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com>
Message-ID: <20031114213921.GB2269@twistedmatrix.com>

On Fri, Nov 14, 2003 at 04:01:00PM -0500, Clark C. Evans wrote:
> Probably a more "helpful" item would be a "Weekly Report" 
> like the Python Developer's list has.  Some dutiful individual
> there scans all of the things discussed, lists the topics
> discussed, summarizes them into a single paragaraph and 
> provides links to particularly insighful emails.  In my 
> opinion, this would be far more useful..

I would love to see this happen! I used to do this waay back in the
day for Twisted, but I apparently don't have the focus to keep it up
(I only got 6 issues out). I would certainly *help* with such an
effort, now, as long as someone is willing to be responsible for it,
and can bug me when they need my help.

Here's an example of what I did, the 6th and final issue:

http://cvs.twistedmatrix.com/cvs/*checkout*/twistedmatrix.com/pages/Attic/twn-6.html?rev=1.5&cvsroot=WebSite&hideattic=0

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From andrew-twisted at puzzling.org  Fri Nov 14 20:17:19 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 15 Nov 2003 14:17:19 +1100
Subject: [Twisted-Python] Deferred model
In-Reply-To: <1068814872.4923.26.camel@pcmarie>
References: <1068681959.7644.1.camel@pcmarie> <ud6bwtn0n.fsf@online.no> <1068741582.4980.2.camel@pcmarie> <1068748415.939.374.camel@hyla> <1068758056.6001.4.camel@pcmarie> <20031113220415.GG563@radii> <20031114002949.GF29436@frobozz> <1068814872.4923.26.camel@pcmarie>
Message-ID: <20031115031719.GB32299@frobozz>

On Fri, Nov 14, 2003 at 02:01:12PM +0100, Philippe Lafoucrire wrote:
> >     http://twistedmatrix.com/users/warner/doc-latest/howto/faq.html#deferreds-aren't-magic
> 
> the link
> http://twistedmatrix.com/documents/TwistedDocs/TwistedDocs-/api/twisted.internet.threads.deferToThread.html
> is broken in the faq (defertoThread)

Yeah, that's a known glitch; the docs in the doc-latest directory aren't
generated with valid API links.  I've just checked in a change that will
make the doc-latest docs generate links to
    http://twistedmatrix.com/documents/TwistedDocs/current/...
which will fix the worst of the broken links (there are likely to still be
some, seeing as that is linking CVS howtos to the release version of the API
docs).

There's a seperate bug with the way links to top-level functions in modules
work (as opposed to classes and methods of classes) which means that
particular link will still not work for now.  It'll work when we do another
release, though, which is what matters.  doc-latest docs are just a preview
of the next release, after all, not the final product :)

Anyway, aside from that link, I take it you are happy with that FAQ entry? :)

-Andrew.




From grolgh at online.no  Fri Nov 14 23:34:30 2003
From: grolgh at online.no (benjamin bruheim)
Date: Sat, 15 Nov 2003 07:34:30 +0100
Subject: [Twisted-Python] Forum vs. mailing list
Message-ID: <3FB6A548@epostleser.online.no>

>http://z.iwethey.org/forums -- we also have a hosting service. If you

I liked those forums. Best of both worlds. It does have a slowness I attribute 
to Zope, and so on.

I liked the mixed threads/flat-view that the forum uses. This is good for real 
discussion. And also, it allows one to browse faster.

However, the CSS is IMHO lousy, and very unattractive. I think we could 
configure this better. If it is gets to be available on twisted, it would be 
good. However, I prefer to use lightweight systems; both in bandwidth and CPU. 
I hope this system is made to be scalable and accessible.

You should put up an example setup, clean the CSS to the bare minimums. Put up 
a minimum of forums. I would think: Development, Twisted, Web
Perhaps add: Issues (the workaround forum), Showroom (brag) and General 
Bullshit

Sincerely,
Benjamin Bruheim





From glyph at twistedmatrix.com  Sat Nov 15 01:30:37 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 15 Nov 2003 03:30:37 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031114210100.GA70172@clarkevans.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com>
Message-ID: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>

On Nov 14, 2003, at 4:01 PM, Clark C. Evans wrote:

> A forum does not solve the core issue of organizing information
> into a clear hierarchy of topics, filtering relevant questions
> and answers, and a whole host of other items.  While a Wiki or
> a Forum could be useful, it will only work if there are several
> people who care about its structure, moderate it, and work
> hard to make the information useful.   Other than that, threaded
> email works just as well.

This brings up a sore point yet again - we need a documentation editor. 
  Any volunteers? :)




From lafou at wanadoo.fr  Sat Nov 15 02:11:39 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sat, 15 Nov 2003 10:11:39 +0100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	 <20031114210100.GA70172@clarkevans.com>
	 <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
Message-ID: <1068887499.4985.0.camel@pcmarie>

> This brings up a sore point yet again - we need a documentation editor. 
>   Any volunteers? :)


huh ? what do you mean by documentation editor ?? I can spend some time
to moderate and organise a forum (only the evening, coz, you know, the
real life ........) :D

--
Philippe




From mary-twisted at puzzling.org  Sat Nov 15 02:29:57 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Sat, 15 Nov 2003 20:29:57 +1100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
Message-ID: <20031115092957.GA1401@titus.home.puzzling.org>

On Sat, Nov 15, 2003, Glyph Lefkowitz wrote:
> On Nov 14, 2003, at 4:01 PM, Clark C. Evans wrote:
> 
> >A forum does not solve the core issue of organizing information
> >into a clear hierarchy of topics, filtering relevant questions
> >and answers, and a whole host of other items.  While a Wiki or
> >a Forum could be useful, it will only work if there are several
> >people who care about its structure, moderate it, and work
> >hard to make the information useful.   Other than that, threaded
> >email works just as well.
> 
> This brings up a sore point yet again - we need a documentation editor. 
>  Any volunteers? :)

I'm still willing to do this, as per the mail here:
http://twistedmatrix.com/pipermail/twisted-python/2003-October/006114.html

The four weeks has passed too. I'm not sure whether you were looking for
someone who has previously been involved in Twisted development though.

I'll have a look at the documentation and see what I think of it I
guess (I haven't read all of Twisted's documentation).

-Mary



From scottanderson at comcast.net  Sat Nov 15 07:12:44 2003
From: scottanderson at comcast.net (Scott Anderson)
Date: Sat, 15 Nov 2003 09:12:44 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <3FB6A548@epostleser.online.no>
References: <3FB6A548@epostleser.online.no>
Message-ID: <3FB6345C.1060105@comcast.net>

benjamin bruheim wrote:

>>http://z.iwethey.org/forums -- we also have a hosting service. If you
>>    
>>
>
>I liked those forums. Best of both worlds. It does have a slowness I attribute 
>to Zope, and so on.
>  
>

Yes, there are issues with how the database drivers work. I have to run 
it in single threaded mode or we get problems like lock-ups and 
corruption. :-P

Meh. It's a prototype. One that does half a million hits a month, but a 
prototype nonetheless.

If you were browsing without logging in, keep in mind that you were 
doing full forum scans. When you're logged in and have "Show New Only" 
turned on, things speed up considerably.

>I liked the mixed threads/flat-view that the forum uses. This is good for real 
>discussion. And also, it allows one to browse faster.
>  
>

The views are also configurable by user. The interface has been beaten 
on and dissected by scores of computer professionals for years, all of 
whom know Exactly What They Want. :-)

>However, the CSS is IMHO lousy, and very unattractive. I think we could 
>configure this better. If it is gets to be available on twisted, it would be 
>good. However, I prefer to use lightweight systems; both in bandwidth and CPU. 
>I hope this system is made to be scalable and accessible.
>  
>

The CSS was written before I knew what CSS was, and yes, it could stand 
a lot of improvement. :-)

There's a user option to turn CSS off completely. One of the main design 
goals was to allow anyone to use the forums: they work just as well in 
something like lynx or w3m.

Moving to Twisted is a priority, given the performance.

>You should put up an example setup, clean the CSS to the bare minimums. Put up 
>a minimum of forums. I would think: Development, Twisted, Web
>Perhaps add: Issues (the workaround forum), Showroom (brag) and General 
>Bullshit
>  
>
Perhaps this weekend.

Regards,
-scott






From radix at twistedmatrix.com  Sat Nov 15 08:10:40 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 15 Nov 2003 10:10:40 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031115092957.GA1401@titus.home.puzzling.org>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com> <20031115092957.GA1401@titus.home.puzzling.org>
Message-ID: <20031115151039.GC2269@twistedmatrix.com>

On Sat, Nov 15, 2003 at 08:29:57PM +1100, Mary Gardiner wrote:
> On Sat, Nov 15, 2003, Glyph Lefkowitz wrote:
> > This brings up a sore point yet again - we need a documentation editor. 
> >  Any volunteers? :)
> 
> I'm still willing to do this, as per the mail here:
> http://twistedmatrix.com/pipermail/twisted-python/2003-October/006114.html
> 
> The four weeks has passed too. I'm not sure whether you were looking for
> someone who has previously been involved in Twisted development though.

I would say that's probably not a requirement ;-). If you need me to
do anything, commit patches, update the web site, or whatever, please
ask. I'll try to be around to help for this task, specifically :)

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From glyph at twistedmatrix.com  Sat Nov 15 08:25:56 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 15 Nov 2003 10:25:56 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031115092957.GA1401@titus.home.puzzling.org>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com> <20031115092957.GA1401@titus.home.puzzling.org>
Message-ID: <022115B6-1780-11D8-94C9-000393C9700E@twistedmatrix.com>

On Nov 15, 2003, at 4:29 AM, Mary Gardiner wrote:

> The four weeks has passed too. I'm not sure whether you were looking 
> for
> someone who has previously been involved in Twisted development though.

Beggars can't be choosers!  Plus, I think you've got just the right 
amount of involvement with Twisted development - you clearly understand 
what's going on, but you haven't drunk enough of the kool-aid yet to be 
unable to see other approaches and make comparisons to other 
technologies.




From mary-twisted at puzzling.org  Sat Nov 15 17:43:13 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Sun, 16 Nov 2003 11:43:13 +1100
Subject: Documentation editing tasks (Re: [Twisted-Python] Forum vs. mailing list)
In-Reply-To: <20031115092957.GA1401@titus.home.puzzling.org>
References: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com> <20031115092957.GA1401@titus.home.puzzling.org>
Message-ID: <20031116004313.GA10624@titus.home.puzzling.org>

On Sat, Nov 15, 2003, Mary Gardiner wrote:
> On Sat, Nov 15, 2003, Glyph Lefkowitz wrote:
> > This brings up a sore point yet again - we need a documentation
> > editor.  Any volunteers? :)
> 
> I'm still willing to do this, as per the mail here:
> http://twistedmatrix.com/pipermail/twisted-python/2003-October/006114.html
> 
> The four weeks has passed too. I'm not sure whether you were looking
> for someone who has previously been involved in Twisted development
> though.
> 
> I'll have a look at the documentation and see what I think of it I
> guess (I haven't read all of Twisted's documentation).

As a way of getting a handle on this task, can people mail me offlist
with their understanding of what the current burning issues with the
documentation are, and with wishlist documentation issues too? That
includes documents that aren't written and should be and documents that
are written that need rewriting, as well as overview problems
("documents are poorly indexed" that kind of thing). Specific is better
though...

This will give me a way to start a todo list (oh, if there already is a
doc todo list, can someone tell me where it is?) that would be
considerably faster than doing a initial full review of the docs myself.
In the meantime, I'll have a look at roundup and see what I can do about
using it to keep track of doc bugs/wishlist items (I don't know whether
this would overwhelm the bug tracker with documentation bugs).

I'll summarise for the list in about a week. If you'd prefer me not to
quote your email, please let me know, otherwise I'll assume people are
OK with their responses to this mail being quoted.

-Mary



From alexander.winston at comcast.net  Sat Nov 15 18:34:39 2003
From: alexander.winston at comcast.net (Alexander Winston)
Date: Sat, 15 Nov 2003 20:34:39 -0500
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com>
	 <20031114210100.GA70172@clarkevans.com>
	 <FD4112FE-1745-11D8-94C9-000393C9700E@twistedmatrix.com>
Message-ID: <1068946479.24600.31.camel@shock>

On Sat, 2003-11-15 at 03:30, Glyph Lefkowitz wrote:
> On Nov 14, 2003, at 4:01 PM, Clark C. Evans wrote:
> 
> > A forum does not solve the core issue of organizing information
> > into a clear hierarchy of topics, filtering relevant questions
> > and answers, and a whole host of other items.  While a Wiki or
> > a Forum could be useful, it will only work if there are several
> > people who care about its structure, moderate it, and work
> > hard to make the information useful.   Other than that, threaded
> > email works just as well.
> 
> This brings up a sore point yet again - we need a documentation editor. 
>   Any volunteers? :)

I'm a fairly pedantic, obsessive-compulsive freak when it comes to
grammar and spelling freak, but we have had some conflicts regarding
that in the past...
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031115/96d10111/attachment.sig>

From mark at mccoyfam.net  Sat Nov 15 19:07:23 2003
From: mark at mccoyfam.net (Mark D McCoy)
Date: Sat, 15 Nov 2003 20:07:23 -0600
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031113235954.GD7130@pgdn.org>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031113235954.GD7130@pgdn.org>
Message-ID: <3FB6DBDB.4080407@mccoyfam.net>

Robert Church wrote:

>On Thu, Nov 13, 2003 at 05:39:42PM -0600, Hegedus, Matthew S quipped:
>  
>
>>Philippe Lafoucri?re mentions his favoring of a forum over a mailing list. A
>>forum sounds much better to me. Topics can be nicely separated, past
>>knowledge can be easily searched, and email inboxes can be freed from much
>>clutter (or at least make room for spam). Is it not too late to implement a
>>forum?
>>    
>>
>
>As Mr. Armstrong just explaned, you can do all this and more with
>the existing mailing list archive. It's here:
>
>http://twistedmatrix.com/pipermail/twisted-python
> 
>You don't need to be subscried to the list to read the archive. Topics
>are nicely seperated. Posts can be easily searched using google. Is it
>too late to use the tools we already have before dumping 'em for a
>bulletin board? Hm?
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>  
>
I prefer to use the 'nomail' option to the mailing list (so i can post) 
and use gmane's nntp via mozilla thunderbird to read.  The web interface 
also allows for dearching posts.  Keeps my inbox from getting too 
cluttered, but I have easy access to all of the mailing list (even from 
before I signed up to it) in a nice threaded format.

-- 
Mark McCoy -- US Army SGT
------------------------------------------------------------------------
Proudly supporting the Free    | UNIX was not designed to stop you from
Software movement since 1996.  | doing stupid things, because that would
                               | also stop you from doing clever things.
                               |                  -- Doug Gwyn
------------------------------------------------------------------------





From twisted at st.imul.us  Sat Nov 15 19:57:38 2003
From: twisted at st.imul.us (charles brandt)
Date: Sat, 15 Nov 2003 18:57:38 -0800
Subject: [Twisted-Python] using defers with requests
Message-ID: <002401c3abed$65299a50$2a01a8c0@marge>

I am trying to select some data from a database in hopes of eventually using
it to populate a dynamic page.  Before I dive into woven, I was trying to
get the following to print selected data directly to a html resource using
the following code snippet (or various versions of it).   I've only been
able to get an empty page though ( <html><body></body></html> ).  I'm
wondering if maybe the request is getting returned before the callback makes
it to the defer?  Any ideas? Thanks in advance,

-Charles.

from twisted.web import resource, server
from twisted.enterprise import adbapi

dbpool = adbapi.ConnectionPool(<connection stuff>)

def getData(data):
    return dbpool.runQuery("SELECT * FROM some_table WHERE some_column =
%s", data)

def printResult(data, request):
    request.write("pre-data")
    request.write(data)
    request.write("post-data")
    request.finish()

class myResource(resource.Resource):
    def render(self, request):
        d = getData("some string")
        d.addCallback(printResult, request)
        return server.NOT_DONE_YET

resource = myResource()





From radix at twistedmatrix.com  Sat Nov 15 20:08:14 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 15 Nov 2003 22:08:14 -0500
Subject: [Twisted-Python] using defers with requests
In-Reply-To: <002401c3abed$65299a50$2a01a8c0@marge>
References: <002401c3abed$65299a50$2a01a8c0@marge>
Message-ID: <20031116030814.GD2269@twistedmatrix.com>

On Sat, Nov 15, 2003 at 06:57:38PM -0800, charles brandt wrote:
> I am trying to select some data from a database in hopes of eventually using
> it to populate a dynamic page.  Before I dive into woven, I was trying to
> get the following to print selected data directly to a html resource using
> the following code snippet (or various versions of it).   I've only been
> able to get an empty page though ( <html><body></body></html> ).  I'm
> wondering if maybe the request is getting returned before the callback makes
> it to the defer?  Any ideas? Thanks in advance,

Are you sure your code is even being triggered? Since your code isn't
writing out those HTML tags anywhere, it seems like some completely
different resource is being renderred instead of yours. Can you put
some debug prints in "render" and "printResult"?

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From andrew-twisted at puzzling.org  Sat Nov 15 20:11:46 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 16 Nov 2003 14:11:46 +1100
Subject: [Twisted-Python] using defers with requests
In-Reply-To: <20031116030814.GD2269@twistedmatrix.com>
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com>
Message-ID: <20031116031146.GG32299@frobozz>

On Sat, Nov 15, 2003 at 10:08:14PM -0500, Christopher Armstrong wrote:
> On Sat, Nov 15, 2003 at 06:57:38PM -0800, charles brandt wrote:
> > I am trying to select some data from a database in hopes of eventually using
> > it to populate a dynamic page.  Before I dive into woven, I was trying to
> > get the following to print selected data directly to a html resource using
> > the following code snippet (or various versions of it).   I've only been
> > able to get an empty page though ( <html><body></body></html> ).  I'm
> > wondering if maybe the request is getting returned before the callback makes
> > it to the defer?  Any ideas? Thanks in advance,
> 
> Are you sure your code is even being triggered? Since your code isn't
> writing out those HTML tags anywhere, it seems like some completely
> different resource is being renderred instead of yours. Can you put
> some debug prints in "render" and "printResult"?

Also, Mozilla and IE I think both will say "<html><body></body></html>" even
when nothing was sent.  Try testing with telnet or wget...

-Andrew.




From twisted at st.imul.us  Sat Nov 15 20:59:05 2003
From: twisted at st.imul.us (charles brandt)
Date: Sat, 15 Nov 2003 19:59:05 -0800
Subject: [Twisted-Python] using defers with requests
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com> <20031116031146.GG32299@frobozz>
Message-ID: <003501c3abf5$fab21d60$2a01a8c0@marge>

> On Sat, Nov 15, 2003 at 10:08:14PM -0500, Christopher Armstrong wrote:
> > On Sat, Nov 15, 2003 at 06:57:38PM -0800, charles brandt wrote:
> > > I am trying to select some data from a database in hopes of eventually
using
> > > it to populate a dynamic page.  Before I dive into woven, I was trying
to
> > > get the following to print selected data directly to a html resource
using
> > > the following code snippet (or various versions of it).   I've only
been
> > > able to get an empty page though ( <html><body></body></html> ).  I'm
> > > wondering if maybe the request is getting returned before the callback
makes
> > > it to the defer?  Any ideas? Thanks in advance,
> >
> > Are you sure your code is even being triggered? Since your code isn't
> > writing out those HTML tags anywhere, it seems like some completely
> > different resource is being renderred instead of yours. Can you put
> > some debug prints in "render" and "printResult"?
>
> Also, Mozilla and IE I think both will say "<html><body></body></html>"
even
> when nothing was sent.  Try testing with telnet or wget...
>

Yes, I think Mozilla is the source for the "<html><body></body></html>"
string.  I don't think anything is being sent.  If I put a request.finish()
in "render" then the resource returns any data written to request in
"render" (but not "printResult").  I'm guessing that the connection with the
client gets closed before a request is rendered.

Is anyone aware of any examples of web applications written in twisted that
uses a database to store dynamic elements?  Thats ultimately where I'm
trying to get with this.  Thanks for the responses.

-Charles.

I added some print debug statements as follows:

def printResult(data, request):
    print "entered printResult"
    request.write("pre-data")
    request.write(data)
    request.write("post-data")
    request.finish()
    print request
    return server.NOT_DONE_YET

class myResource(resource.Resource):
    def render(self, request):
        print "entered render"
        d = getData("some string")
        d.addCallback(printResult, request)
        print "after callback"
        return server.NOT_DONE_YET

resource = myResource()

which results in the following logs being generated:

2003/11/15 19:49 PST [HTTPChannel,13,<ip>] entered render
2003/11/15 19:49 PST [HTTPChannel,13,<ip>] after callback
2003/11/15 19:49 PST [HTTPChannel,13,<ip>] adbapi connecting: MySQLdb
{<connection args>}
2003/11/15 19:49 PST [-] entered printResult
2003/11/15 19:49 PST [-] <ip> - - [16/Nov/2003:03:49:11 +0000] "GET
/beta/resource3.rpy HTTP/1.1" 200 18 "-" "Mozilla/5.0"
2003/11/15 19:49 PST [-] <GET /beta/resource3.rpy HTTP/1.1>





From radix at twistedmatrix.com  Sat Nov 15 21:06:06 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 15 Nov 2003 23:06:06 -0500
Subject: [Twisted-Python] using defers with requests
In-Reply-To: <003501c3abf5$fab21d60$2a01a8c0@marge>
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com> <20031116031146.GG32299@frobozz> <003501c3abf5$fab21d60$2a01a8c0@marge>
Message-ID: <20031116040606.GE2269@twistedmatrix.com>

On Sat, Nov 15, 2003 at 07:59:05PM -0800, charles brandt wrote:
> I added some print debug statements as follows:
> 
> def printResult(data, request):
>     print "entered printResult"
>     request.write("pre-data")
>     request.write(data)
>     request.write("post-data")
>     request.finish()
>     print request

What is 'data' here? can you print repr(data)? It might be the empty
string, or something.

>     return server.NOT_DONE_YET

This is unnecessary here, FYI.

> class myResource(resource.Resource):
>     def render(self, request):
>         print "entered render"
>         d = getData("some string")
>         d.addCallback(printResult, request)
>         print "after callback"
>         return server.NOT_DONE_YET
> 
> resource = myResource()

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From twisted at st.imul.us  Sat Nov 15 21:52:32 2003
From: twisted at st.imul.us (charles brandt)
Date: Sat, 15 Nov 2003 20:52:32 -0800
Subject: [Twisted-Python] using defers with requests
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com> <20031116031146.GG32299@frobozz> <003501c3abf5$fab21d60$2a01a8c0@marge> <20031116040606.GE2269@twistedmatrix.com>
Message-ID: <003c01c3abfd$71f73d90$2a01a8c0@marge>

> On Sat, Nov 15, 2003 at 07:59:05PM -0800, charles brandt wrote:
> > I added some print debug statements as follows:
> >
> > def printResult(data, request):
> >     print "entered printResult"
> >     request.write("pre-data")
> >     request.write(data)

    print repr(data)

> >     request.write("post-data")
> >     request.finish()
> >     print request
>
> What is 'data' here? can you print repr(data)? It might be the empty
> string, or something.

2003/11/15 20:43 PST [-] entered printResult
2003/11/15 20:43 PST [-] ((13L, 'Hawaii', 'HI', 'US'),)

Seems like the request might be different from the original, or doesn't have
a channel to respond on?

-Charles





From twisted at st.imul.us  Sat Nov 15 22:47:58 2003
From: twisted at st.imul.us (charles brandt)
Date: Sat, 15 Nov 2003 21:47:58 -0800
Subject: [Twisted-Python] using defers with requests
References: <002401c3abed$65299a50$2a01a8c0@marge> <20031116030814.GD2269@twistedmatrix.com> <20031116031146.GG32299@frobozz> <003501c3abf5$fab21d60$2a01a8c0@marge> <20031116040606.GE2269@twistedmatrix.com> <003c01c3abfd$71f73d90$2a01a8c0@marge>
Message-ID: <004e01c3ac05$30a1a620$2a01a8c0@marge>

For completeness, Christopher pointed out that I was not passing a string to
request.write (str(data)).  Since I did not have an Errback call, the
exception that was raised in the callback was never output.  (fixed by
adding: d.addErrback(log.err)  )

Thanks for the help!

-Charles

> > > I added some print debug statements as follows:
> > >
> > > def printResult(data, request):
> > >     print "entered printResult"
> > >     request.write("pre-data")
> > >     request.write(data)
>
>     print repr(data)
>
> > >     request.write("post-data")
> > >     request.finish()
> > >     print request
> >
> > What is 'data' here? can you print repr(data)? It might be the empty
> > string, or something.
>
> 2003/11/15 20:43 PST [-] entered printResult
> 2003/11/15 20:43 PST [-] ((13L, 'Hawaii', 'HI', 'US'),)
>
> Seems like the request might be different from the original, or doesn't
have
> a channel to respond on?
>
> -Charles
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>





From bauer at mit.edu  Fri Nov 14 08:04:47 2003
From: bauer at mit.edu (Steven Bauer)
Date: Fri, 14 Nov 2003 10:04:47 -0500
Subject: [Twisted-Python] Documentation Question
In-Reply-To: <20031114062412.2922.qmail@green.zadka.com>
References: <20031110221220.GA4281@mit.edu> <20031114062412.2922.qmail@green.zadka.com>
Message-ID: <20031114150447.GA18196@mit.edu>

Moshe Zadka [twisted at zadka.site.co.il] wrote:
>Did you try using help(internet.UDPServer) from the interactive interpreter?
>Here's what I got:
>
>class UDPServer(_AbstractServer)
> |  Serve UDP clients
> |
> |  Call listenUDP when the service starts, with the
> |  arguments given to the constructor. When the service stops,
> |  stop listening.
>
>I checked in a fix to make it say "reactor.listenUDP" -- I guess it was
>just a blindspot of me, I knew what listenUDP means :)
>Anyway, this should not have required any "looking at the code".
>Hopefully with my fix you'll be able to know you should do
>help(reactor.listenUDP) to get the information you're after:

(I am replying off list so that I don't have to wait for moderator approval.)

Thanks for your helpful reply.  I had looked at the web documentation
and interactive help however I evidently have a blind spot for the very
first sentence. :)  I repeatedly skimmed down to the function I am interested
in and saw:

__init__(self, *args, **kwargs)

Not being able to find out what these arguments were *right there* in the
documentation I immediately just checked the code.  This didn't take
long at all of course just annoying.  I then ran into the same issue
with one of the other server classes and figured I must be missing
something.  Turns out I was evidently literally missing something 
in the documentation.  :)

So far though Twisted is a great system.  Thanks for your work and
reply.

-Steve





From robert at redcor.ch  Sat Nov 15 00:54:30 2003
From: robert at redcor.ch (robert)
Date: Sat, 15 Nov 2003 08:54:30 +0100
Subject: [Twisted-Python] Re: [Plone-developers] [Ann] epoz 1.0 beta1 released
In-Reply-To: <3FB4F453.7000800@weitershausen.de>
References: <3FB4F453.7000800@weitershausen.de>
Message-ID: <200311150854.30380.robert@redcor.ch>

Philipp,
thanks for your info and efforts.

I am currently working on a Project using Plone 2.0 for which I need a visual 
editor.
Since the project is due by the end of the year, I need to use a solution that 
is available by then. 
My question therefore is:what is the state of the plone integration?
Is there something I could use to start with?

I would very much like to help beta testing, but it must be in an Plone 
environment.

Robert

Am Freitag, 14. November 2003 16:27 schrieb Philipp von Weitershausen:
> The epoz project is pleased to announce the first beta version of its
> cross-browser visual HTML editor!
>
> Originally written by Maik Jablonski, the editor famous in the world of
> Zope and Plone was completely redesigned by Paul Everitt (Zope Europe
> Association) and Guido Wesdorp (Infrae) and Philipp von Weitershausen
> (philiKON Valley). The result is a very flexible editing machine based
> on the following concepts:
>
>    - Integration
>
>      epoz was designed to be highly integrable into target products. It
>      uses Zope Page Templates (ZPT) for the XHTML templating. ZPTs hide
>      templating instructions in XML namespaces. That way, all XHTML
>      templates in epoz remain valid XHTML documents and should be able
>      to be used in similar templating systems without modification.
>      That also means, epoz can directly be used off of the filesystem
>      or served by Apache, without any templating engine.
>
>    - Document-centric and asynchronous editing
>
>      Other in-browser editors simply provide a replacement for the
>      textarea element in XHTML forms. epoz instead focuses on
>      document-centric editing. It lets you edit the contents of an
>      XHTML document and dublin core metadata (Title, Creator etc.) in a
>      compact and standard-conformant way. Upon save, epoz constructs a
>      full-fledged XHTML document again and invokes a PUT request to the
>      server. Being a standard HTTP command, PUT requests can be served
>      by nearly any webserver, even Apache (with mod_dav)!
>
>    - Customization and extensibility
>
>      The looks of epoz can be modified without having to modify the
>      XHTML templates by simply customizing the Cascading Style
>      Sheets. Its JavaScript architecture has been modelled after the
>      MVC concept. That means you may customize large or small parts of
>      the editor without having to reimplement or subclass anything, but
>      it also means extending epoz's functionality is just as easy.
>
> Where can I get it?
>
>    You may download a tarball at the the epoz project homepage at
>    Sourceforge:
>
>      http://sourceforge.net/project/showfiles.php?group_id=84377
>
> How can I use it?
>
>    epoz comes with a great deal of documentation already. The
>    INSTALL.txt file in the 'doc' directory should provide a small set
>    of introductions for Zope users.
>
>    If you would like to see epoz in action without having to install it
>    in Zope, you may either download the tarball and open
>    'common/epozmacros.html' in your browser or visit the following URL
>    (served by Apache, btw):
>
>      http://www.philikon.de/files/epoz/common/epozmacros.html
>
>    If you happen to succeed at integrating epoz into your favourite web
>    application server, feel free to contact us if you would like to
>    contribute your code to the project. Equally, any documentation
>    about how to integrate, customize or extend are very welcome.
>
> What to expect for future releases
>
>    - Link and image toolbox:
>
>      The original Epoz editor provided a toolbox for Plone users that
>      was loaded in a browser pop-up window. Since epoz 1.0 puts a lot
>      of focus on document-centric editing, it places toolbox elements
>      such as a link or image browser and table creator right on the
>      edit page. Results for link and image searching will be loaded
>      asynchronously in a yet-to-defined XML format.
>
>      In upcoming releases, we will provide asynronous server-side
>      methods for link and image searching in Zope2, CMF, Plone and
>      Zope3.
>
>    - Plone integration:
>
>      Although we have made an effort to integrate it with Plone
>      1.0/2.0, we have seen that current versions of Plone does not
>      allow an editor to take over for document-centric editing. Philipp
>      has made a Plone Improvement Proposal (PLIP) to provide a visual
>      editing architecture in Plone
>      (http://plone.org/development/current/projects/PLIP5). The
>      proposal has been accepted by the community and Philipp is
>      currently implementing. It is expected that Plone 2.1 will be
>      ready to be plugged together with upcoming versions of epoz.
>
> How to report bugs?
>
>    Please help us make epoz 1.0 bugfree and report bugs you encounter
>    at:
>
>      http://codespeak.net/issues/epoz/ (mind the trailing slash)
>
>    Further questions? Write us to:
>
>      epoz-development at lists.sourceforge.net
>
> We are looking forward to your comments.
> On behalf of the epoz project,
>
> Philipp von Weitershausen
>
>
>
>
> -------------------------------------------------------
> This SF.Net email sponsored by: ApacheCon 2003,
> 16-19 November in Las Vegas. Learn firsthand the latest
> developments in Apache, PHP, Perl, XML, Java, MySQL,
> WebDAV, and more! http://www.apachecon.com/
> _______________________________________________
> Plone-developers mailing list
> Plone-developers at lists.sourceforge.net
> https://lists.sourceforge.net/lists/listinfo/plone-developers

-- 
mit freundlichen Grssen

Robert Rottermann
www.redCOR.ch




From justinjohnson at fastmail.fm  Mon Nov 17 12:19:29 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Mon, 17 Nov 2003 11:19:29 -0800
Subject: [Twisted-Python] LivePage patch? - was (LivePage CACHING Problem)
Message-ID: <20031117191929.B0D6141510@server1.messagingengine.com>

Working with fzZzy on #divmod, I made the following change to my local
twisted/web/woven/flashconduit.py to make LivePage work for me.  I'm
using guard sessions (which appear to not be supported by the current
code) so in my case the sessions are stored on the SessionWrapper.  I
really don't know squat about the way the code should be, so hopefully
someone else can take a look at this and apply a real patch.  I'd gladly
do the real thing, but it would take me a *lot* longer to do.  :-)

Thanks.
-Justin


--- flashconduit.py.orig        2003-11-17 13:18:37.000000000 -0600
+++ flashconduit.py     2003-11-17 13:18:43.000000000 -0600
@@ -16,7 +16,8 @@
         #self.lp.unhookOutputConduit()

     def lineReceived(self, line):
-        session = self.factory.site.getSession(line)
+        #session = self.factory.site.getSession(line)
+        session = self.factory.site.resource.sessions[line]
         self.lp = lp = session.getComponent(interfaces.IWovenLivePage)
         lp.hookupOutputConduit(self)




----- Original message -----
From: "Justin Johnson" <justinjohnson at fastmail.fm>
To: "Twisted-Python" <twisted-python at twistedmatrix.com>
Date: Thu, 13 Nov 2003 11:19:09 -0600
Subject: Re: [Twisted-Python] LivePage CACHING Problem

I found the following post that looks similar to my problem.

http://twistedmatrix.com/pipermail/twisted-python/2003-May/004170.html

But since I have my own tap, I copied the code from web/tap.py into my
code to start up the FlashConduitFactory.  It starts up, but I get the
following errors.  Is this a bug?  Any ideas what I'm doing wrong?

2003/11/13 11:08 CST [twisted.web.woven.flashconduit.FlashConduitFactory]
connection with flash movie opened
2003/11/13 11:08 CST [FlashConduit,3,xxx.xxx.xxx.xxx] Traceback (most
recent call last):
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
          line 501, in doSelect
            _logrun(selectable, _drdw, selectable, method, dict)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
          line 65, in callWithLogger
            callWithContext({"system": lp}, func, *args, **kw)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
          line 52, in callWithContext
            return context.call({ILogContext: newCtx}, func, *args, **kw)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/python/context.py",
          line 32, in callWithContext
            return func(*args,**kw)
        --- <exception caught here> ---
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
          line 510, in _doReadOrWrite
            why = getattr(selectable, method)()
          File
          "/usr/local/lib/python2.3/site-packages/twisted/internet/tcp.py",
          line 250, in doRead
            return self.protocol.dataReceived(data)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/protocols/basic.py",
          line 223, in dataReceived
            why = self.lineReceived(line)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/web/woven/flashconduit.py",
          line 19, in lineReceived
            session = self.factory.site.getSession(line)
          File
          "/usr/local/lib/python2.3/site-packages/twisted/web/server.py",
          line 470, in getSession
            return self.sessions[uid]
        exceptions.KeyError: 'd01be6fe334cded345c0b029e29df7ac'

2003/11/13 11:08 CST [FlashConduit,3,xxx.xxx.xxx.xxx] connection lost



On Thu, 13 Nov 2003 10:38:59 -0600, "Justin Johnson"
<justinjohnson at fastmail.fm> said:
> Hi,
> 
> I am currently trying to use LivePage to update the cells of an html
> table with results from processes initiated in various PB services.  The
> client intiates requests in the services and those services call back
> into the client's (a pb.Referenceable) remote_updateStatus method to
> update the table which displays the results.  I have test code that
> simulates this and everything works fine.  Javascript is sent to the
> browser to update the cells of the table.  Works really slick.  However,
> now that I tried to hook it up to PB, the LivePage javascript sending
> part isn't working.  When I make the page.sendScript(script) call I get
> the following in the log.
> 
> 2003/11/13 10:25 CST [Broker,client] Sending javascript to page
> <twisted.web.woven.utils.WovenLivePage instance at 0x4089944c>
> 2003/11/13 10:25 CST [Broker,client] CACHING
> [<twisted.web.woven.utils.Script instance at 0x4089906c>]
> 
> All future sendScript calls append the script to the cache.  Everything
> else is working appropriately, and all code is executing as I'd expect,
> except that the javascript doesn't send properly.  Is there something in
> particular I should be looking for here?  I don't see what I'm doing
> different, but since LivePage is quite magical to me I'm not sure where
> to look.
> 
> On a slightly different note, is there LivePage-ish support in nevow, and
> do you recommend moving to that yet?
> 
> Thanks.
> -Justin
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From vlupien at drummonddesigns.com  Mon Nov 17 12:44:36 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Mon, 17 Nov 2003 14:44:36 -0500
Subject: [Twisted-Python] model question
Message-ID: <000001c3ad43$3cdf7f40$687ba8c0@vicky>

I have a web based application.
 
I want to create a model from a sql query that will be accessible from
the web page.
I want to be able to create my model in the setUp fonction.
I also want to access my model from the web page like this:
model="plan_id" (where plan_id is a column from my sql query)
 
I don't know if someone understand what I want.
 
Here's a part of my class:
 
class SummaryDB:
    """PublisherDB Class"""
    def __init__(self, dbpool):
        self.dbpool = dbpool
 
    def getSummary(self, plan_id):
        sql = "select * from plan where plan_id = '%s'" %plan_id
        return self.dbpool.runQueryDict(sql)
 
class SummaryPage(pages.BasePage):
    templateFile = "summary.html"
    
    def initialize(self, dbpool):
        self.dbpool = dbpool
        self.db = SummaryDB(self.dbpool)
            
    def setUp(self, request, *args):
        # I want to do somethings like :
        # self.model = ({'details' : self.db.getSummary(plan_id)}
        # and then, access to details by my web page
        self.contextMenu = menus.build_search_menu()
 
    
And here's my template:
 
<html>
            <head>
                        <title>
                                    Title 
                        </title>
            </head>
            <body>
                        <br />
                        <table border="0" width="100%" cellspacing="1"
cellpadding="2">
                                    <tr>
                                                <th class="header"
colspan="2">
                                                            Sommaire 
                                                </th>
                                    </tr>
                                    <tr>
                                                <td class="label"
width="25%">
                                                            Number 
                                                </td>
                                                <td class="area"
width="75%" model="details/plan_id">&nbsp;2165</td>    #plan_id is a
column from the sql query
                                    </tr>
                        </table>
            </body>
</html>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031117/dff4b20a/attachment.html>

From lafou at wanadoo.fr  Mon Nov 17 14:50:32 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Mon, 17 Nov 2003 22:50:32 +0100
Subject: [Twisted-Python] model question
In-Reply-To: <000001c3ad43$3cdf7f40$687ba8c0@vicky>
References: <000001c3ad43$3cdf7f40$687ba8c0@vicky>
Message-ID: <200311172250.32947.lafou@wanadoo.fr>

On Monday 17 November 2003 20:44, vicky lupien wrote:
> I have a web based application.
>
> I want to create a model from a sql query that will be accessible from
> the web page.
> I want to be able to create my model in the setUp fonction.
> I also want to access my model from the web page like this:
> model="plan_id" (where plan_id is a column from my sql query)
>
> I don't know if someone understand what I want.
>


Why don't you use a wmfactory_details ?
I don't understand why you want to put it in the setUp method :(




From phil at bubblehouse.org  Mon Nov 17 15:32:44 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Mon, 17 Nov 2003 17:32:44 -0500 (EST)
Subject: [Twisted-Python] another probably very simple question
Message-ID: <1468.65.246.170.211.1069108364.squirrel@192.168.0.2>

this is actually the first time i've ever written a PB client in python.
since my java client was calling the remote methods out of the awt/swing
event thread, i never had to deal with this particular issue. while i'm
waiting for the update to the java pb packages (*cough*itamar*cough* ;-)
), i figured it would be worthwhile to do up a text-based client in
python.

i know this relates to my poor understanding of deferreds, but i just
can't figure out exactly how to go about doing what i want to do.

i want to be able to continually prompt the user for a string that gets
sent to a "parse" method on the remote object. i'm not exactly sure the
right way to do this. do I just add a callback to the deferred returned by

def main():
    config = Options()
    if(config['login'] == None):
        config['login'] = getpass.getuser()
    passwd = getpass.getpass("%s@%s's password: " % (config['login'],
                                                     config['host']))

    client = TextClient()
    factory = pb.PBClientFactory()
    reactor.connectTCP(config['host'], int(config['port']), factory)
    defer = factory.login(credentials.UsernamePassword(config['login'],
                                                       passwd), client)
    defer.addCallback(connected)
    reactor.run()

def connected(perspective):
    command = raw_input("> ");
    defer = perspective.callRemote("parse", command)




From phil at bubblehouse.org  Mon Nov 17 15:34:24 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Mon, 17 Nov 2003 17:34:24 -0500 (EST)
Subject: [Twisted-Python] another probably very simple question
Message-ID: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2>

[whoops, sorry about the previous incomplete message]

this is actually the first time i've ever written a PB client in python.
since my java client was calling the remote methods out of the awt/swing
event thread, i never had to deal with this particular issue. while i'm
waiting for the update to the java pb packages (*cough*itamar*cough* ;-)
), i figured it would be worthwhile to do up a text-based client in
python.

i know this relates to my poor understanding of deferreds, but i just
can't figure out exactly how to go about doing what i want to do.

i want to be able to continually prompt the user for a string that gets
sent to a "parse" method on the remote object. i'm not exactly sure the
right way to do this. do I just add a callback to the deferred returned by
call remote?

here's my code so far:

def main():
    config = Options()
    if(config['login'] == None):
        config['login'] = getpass.getuser()
    passwd = getpass.getpass("%s@%s's password: " % (config['login'],
                                                     config['host']))

    client = TextClient()
    factory = pb.PBClientFactory()
    reactor.connectTCP(config['host'], int(config['port']), factory)
    defer = factory.login(credentials.UsernamePassword(config['login'],
                                                       passwd), client)
    defer.addCallback(connected)
    reactor.run()

def connected(perspective):
    command = raw_input("> ");
    defer = perspective.callRemote("parse", command)
    defer.addCallback(connected)



From andrew-twisted at puzzling.org  Mon Nov 17 18:01:23 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 18 Nov 2003 12:01:23 +1100
Subject: [Twisted-Python] another probably very simple question
In-Reply-To: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2>
Message-ID: <20031118010123.GB12240@frobozz>

On Mon, Nov 17, 2003 at 05:34:24PM -0500, Phil Christensen wrote:
> 
> i want to be able to continually prompt the user for a string that gets
> sent to a "parse" method on the remote object. i'm not exactly sure the
> right way to do this. do I just add a callback to the deferred returned by
> call remote?
> 
> here's my code so far:
> 
> def main():
>     config = Options()
>     if(config['login'] == None):
>         config['login'] = getpass.getuser()
>     passwd = getpass.getpass("%s@%s's password: " % (config['login'],
>                                                      config['host']))
> 
>     client = TextClient()
>     factory = pb.PBClientFactory()
>     reactor.connectTCP(config['host'], int(config['port']), factory)
>     defer = factory.login(credentials.UsernamePassword(config['login'],
>                                                        passwd), client)
>     defer.addCallback(connected)
>     reactor.run()
> 
> def connected(perspective):
>     command = raw_input("> ");
>     defer = perspective.callRemote("parse", command)
>     defer.addCallback(connected)

Calling raw_input is a bad idea.  It will block.

You should either use twisted.internet.stdio (which is probably more work
than you care to do -- but see doc/examples/cursesclient.py for an example
that uses stdio and curses to make a simple irc client), or run raw_input in
a thread:


from twisted.internet import threads

def connected(perspective):
    deferred = threads.deferToThread(raw_input, "> ")
    deferred.addCallback(lambda cmd: perspective.callRemote("parse", cmd))
    deferred.addCallback(lambda res: connected(perspective))


Note that perspective.callRemote will return a Deferred -- but that's ok,
the Deferreds automatically cope with (i.e. wait for) deferred results from
callbacks :)

Something else to notice is that Deferreds pass the result of the previous
callback (or the original result, for the first callback) to each callback,
which is why I wrote:
    deferred.addCallback(lambda res: connected(perspective))
rather than your:
    defer.addCallback(connected)

-Andrew.




From stuart.hungerford at anu.edu.au  Mon Nov 17 18:02:02 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Tue, 18 Nov 2003 12:02:02 +1100
Subject: [Twisted-Python] Browser oddities and Woven...
Message-ID: <6.0.0.22.0.20031118114909.01e82730@anusf.anu.edu.au>

Hi all,

I probably shouldn't be too surprised, but I'm experiencing
some odd behaviour with IE 6.0 .vs. Mozilla 1.5, both on
Windows XP.

I've developed a Woven application that generates three
HTML pages, let's call them A, B, and C.

A's render() method does a redirect to B. B's view methods
generate an XHTML meta tag with the content attribute set
to a refresh and new URL for C:

     <meta content="10;http://example.org/C" http-equiv="refresh" />

With Mozilla as the client everything thing goes as I expected
with pages progressing from A to B to C.

With IE as the client it goes from A to B, then loops continually
on B, i.e A, B, B, B, ... without ever reaching C.

I suspect there's some request header I need to set or set
differently?  Can anyone offer me advice on this strange
situation?


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From matteo.giacomazzi at email.it  Tue Nov 18 00:55:01 2003
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Tue, 18 Nov 2003 08:55:01 +0100
Subject: [Twisted-Python] UNIXServer and its socket
Message-ID: <20574562.20031118085501@email.it>

In my application I have a server that listens on a UNIX socket.
When I kill the application, the socket file remains in the filesystem
so  when  I  restart  it  I always achieve an "Address already in use"
error.

Should  I  delete  it  manually  any time I stop the application or is
there a more elegant way to solve this problem?

The application is a plugin for twistd.

Thank you in advance.
  
 Matteo




From twisted at zadka.site.co.il  Tue Nov 18 04:09:45 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 18 Nov 2003 11:09:45 -0000
Subject: [Twisted-Python] UNIXServer and its socket
In-Reply-To: <20574562.20031118085501@email.it>
References: <20574562.20031118085501@email.it>
Message-ID: <20031118110945.31715.qmail@green.zadka.com>

On Tue, 18 Nov 2003, Matteo Giacomazzi <matteo.giacomazzi at email.it> wrote:

> In my application I have a server that listens on a UNIX socket.
> When I kill the application, the socket file remains in the filesystem
> so  when  I  restart  it  I always achieve an "Address already in use"
> error.

I'm guessing you're using 1.1?
It's fixed in CVS, so when there is a new release, it will be fixed.
I'm not sure what your best course of action, though:
* Live with it, and wait for new release
* Move to CVS, wait for new release to move back to released version
* Implement some work around, wait for new release to remove it

I'm sorry there aren't better news than "it was a bug, we fixed it" --
twisted.application is quite a bit of code, and testing in the field
frequently finds more bugs. You can rest assured that the bug was
not merely fixed, but a unit test added to make sure it doesn't
come back.



From matteo.giacomazzi at email.it  Tue Nov 18 04:36:19 2003
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Tue, 18 Nov 2003 12:36:19 +0100
Subject: [Twisted-Python] UNIXServer and its socket
In-Reply-To: <20031118110945.31715.qmail@green.zadka.com>
References: <20574562.20031118085501@email.it>
 <20031118110945.31715.qmail@green.zadka.com>
Message-ID: <10113852281.20031118123619@email.it>

>> In  my  application  I have a server that listens on a UNIX socket.
>> When  I  kill  the  application,  the  socket  file  remains in the
>> filesystem  so  when  I  restart  it  I  always achieve an "Address
>> already in use" error.

> I'm guessing you're using 1.1?

Right!

> It's fixed in CVS, so when there is a new release, it will be fixed.
> I'm not sure what your best course of action, though:
> * Live with it, and wait for new release
> * Move to CVS, wait for new release to move back to released version
> * Implement some work around, wait for new release to remove it

I will take option number 1.
If I'm not wrong, in version 1.0.7 this error didn't appear.

> I'm  sorry there aren't better news than "it was a bug, we fixed it"
> --  twisted.application  is  quite a bit of code, and testing in the
> field  frequently finds more bugs. You can rest assured that the bug
> was  not merely fixed, but a unit test added to make sure it doesn't
> come back.

That's good, thank you: I will wait for next release.

Regards,
 Matteo




From andrew-twisted at puzzling.org  Tue Nov 18 04:38:31 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 18 Nov 2003 22:38:31 +1100
Subject: [Twisted-Python] UNIXServer and its socket
In-Reply-To: <10113852281.20031118123619@email.it>
References: <20574562.20031118085501@email.it> <20031118110945.31715.qmail@green.zadka.com> <10113852281.20031118123619@email.it>
Message-ID: <20031118113831.GH32299@frobozz>

On Tue, Nov 18, 2003 at 12:36:19PM +0100, Matteo Giacomazzi wrote:
> 
> > It's fixed in CVS, so when there is a new release, it will be fixed.
> > I'm not sure what your best course of action, though:
> > * Live with it, and wait for new release
> > * Move to CVS, wait for new release to move back to released version
> > * Implement some work around, wait for new release to remove it
> 
> I will take option number 1.
> If I'm not wrong, in version 1.0.7 this error didn't appear.

That sounds likely.  twisted.application, and the associated changes to
twistd and other infrastructure, were new to 1.1.

-Andrew.




From lordvan at lordvan.com  Tue Nov 18 04:51:27 2003
From: lordvan at lordvan.com (Thomas Raschbacher)
Date: Tue, 18 Nov 2003 12:51:27 +0100
Subject: [Twisted-Python] Browser oddities and Woven...
In-Reply-To: <6.0.0.22.0.20031118114909.01e82730@anusf.anu.edu.au>
References: <6.0.0.22.0.20031118114909.01e82730@anusf.anu.edu.au>
Message-ID: <3FBA07BF.5030501@lordvan.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


hi!

Stuart Hungerford wrote:
| Hi all,
|
| I probably shouldn't be too surprised, but I'm experiencing
| some odd behaviour with IE 6.0 .vs. Mozilla 1.5, both on
| Windows XP.
|
| I've developed a Woven application that generates three
| HTML pages, let's call them A, B, and C.
|
| A's render() method does a redirect to B. B's view methods
| generate an XHTML meta tag with the content attribute set
| to a refresh and new URL for C:
|
|     <meta content="10;http://example.org/C" http-equiv="refresh" />
|
AFAIK this would be the correct syntax:
<META name="refresh" content="3,http://www.acme.com/intro.html" />
~                               ^
(ie ',' instead of ';')
http://www.w3.org/TR/WD-html40-970708/struct/global.html#h-7.1.3.2

regards


- -----BEGIN GEEK CODE BLOCK-----
GCS/CC/E/M/MU/S d- s: a--- C++++(++) UL++++ P+ L++++ E W+++ N+++ o-- K w-- O
M-- V- PS+ PE-- Y++ PGP+++ t+++ 5+ X- R tv b++++ DI- D+ G++ e-->+++++ h-- !r
z-
- ------END GEEK CODE BLOCK------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/uge/v20tKfoYgekRAi3RAJ42Jo9PG2dtSx9ws+9mEIklD/222gCff981
617IddXHoWDgzfJ3uC7TIgk=
=42Yu
-----END PGP SIGNATURE-----




From twisted at zadka.site.co.il  Tue Nov 18 07:40:03 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 18 Nov 2003 14:40:03 -0000
Subject: [Twisted-Python] UNIXServer and its socket
In-Reply-To: <10113852281.20031118123619@email.it>
References: <10113852281.20031118123619@email.it>, <20574562.20031118085501@email.it>
 <20031118110945.31715.qmail@green.zadka.com>
Message-ID: <20031118144003.3788.qmail@green.zadka.com>

On Tue, 18 Nov 2003, Matteo Giacomazzi <matteo.giacomazzi at email.it> wrote:

> I will take option number 1.
> If I'm not wrong, in version 1.0.7 this error didn't appear.

Neither did UNIXServer :)



From justinjohnson at fastmail.fm  Tue Nov 18 08:14:02 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 18 Nov 2003 07:14:02 -0800
Subject: [Twisted-Python] win32eventreactor bug?
Message-ID: <20031118151402.43857400DF@server1.messagingengine.com>

I was running twistd on windows, serving out a custom tap which is just a
web app and a pb service.  As it was doing it's thing, suddenly a ton of
output started dumping on the log.  Did I find a bug in the win32 event
reactor, or am I hitting some sort of limit?  I can send some code along
if necessary, but nothing in the log looks specific to my code.

Thanks.
-Justin
  

2003/11/18 09:07 Central Standard Time [-] Unexpected error in main loop.
2003/11/18 09:07 Central Standard Time [-] Traceback (most recent call
last):
          File
          "C:\Python23\Lib\site-packages\twisted\application\app.py",
          line
165, in run
            runApp(config)
          File "C:\Python23\Lib\site-packages\twisted\scripts\twistw.py",
          line 5
4, in runApp
            app.runReactorWithLogging(config, oldstdout, oldstderr)
          File
          "C:\Python23\Lib\site-packages\twisted\application\app.py",
          line
61, in runReactorWithLogging
            reactor.run()
          File
          "C:\Python23\Lib\site-packages\twisted\internet\default.py",
          line
 122, in run
            self.mainLoop()
        --- <exception caught here> ---
          File
          "C:\Python23\Lib\site-packages\twisted\internet\default.py",
          line
 133, in mainLoop
            self.doIteration(t)
          File
          "C:\Python23\Lib\site-packages\twisted\internet\win32eventreactor
.py", line 171, in doWaitForMultipleEvents
            val = MsgWaitForMultipleObjects(handles, 0, timeout,
            QS_ALLINPUT | Q
S_ALLEVENTS)
        pywintypes.error: (87, 'MsgWaitForMultipleObjects', 'The
        parameter is in
correct.')

2003/11/18 09:07 Central Standard Time [-] Unexpected error in main loop.
2003/11/18 09:07 Central Standard Time [-] Traceback (most recent call
last):
          File
          "C:\Python23\Lib\site-packages\twisted\application\app.py",
          line
165, in run
            runApp(config)
          File "C:\Python23\Lib\site-packages\twisted\scripts\twistw.py",
          line 5
4, in runApp
            app.runReactorWithLogging(config, oldstdout, oldstderr)
          File
          "C:\Python23\Lib\site-packages\twisted\application\app.py",
          line
61, in runReactorWithLogging
            reactor.run()
          File
          "C:\Python23\Lib\site-packages\twisted\internet\default.py",
          line
 122, in run
            self.mainLoop()
        --- <exception caught here> ---
          File
          "C:\Python23\Lib\site-packages\twisted\internet\default.py",
          line
 133, in mainLoop
            self.doIteration(t)
          File
          "C:\Python23\Lib\site-packages\twisted\internet\win32eventreactor
.py", line 171, in doWaitForMultipleEvents
            val = MsgWaitForMultipleObjects(handles, 0, timeout,
            QS_ALLINPUT | Q
S_ALLEVENTS)
        pywintypes.error: (87, 'MsgWaitForMultipleObjects', 'The
        parameter is in
correct.')

2003/11/18 09:07 Central Standard Time [-] Unexpected error in main loop.



From slyphon at twistedmatrix.com  Tue Nov 18 11:04:21 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Tue, 18 Nov 2003 13:04:21 -0500
Subject: [Twisted-Python] new ftp implementation
Message-ID: <3FBA5F25.4070506@twistedmatrix.com>

Hello all,

Just wanted to announce there is a new version of the ftp server/protocol.

the new protocol:

   - Supports cred, so you can control/abstract the filesystem
   - includes an anonymous-only avatar/realm
   - supports pipelining of commands
   - intentionally does not support globbing (to help prevent security
     holes)
   - connection limiting (ex. max 100 users)
   - individual timeouts for protocol interpreter idle time and dtp
     connection times

todos:
   - the permissions-checking needs improvement. I intend to set up an
     option on the FTPFactory that will let you set the uid of the
     anonymous user, but that's coming in the next week.
   - path purification code needs improvement (to prevent intentionally 	
     stupid paths like "\\//*/*/../../*/.." from borking the server)
   - a couple of other minor odds-and-ends


there's an example tac file in sandbox/slyphon/ftp_refactor/ftpsrv.tac

comments, suggestions, etc. welcomed


-Jonathan Simms
slyphon at twistedmatrix.com




From slyphon at twistedmatrix.com  Tue Nov 18 11:39:20 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Tue, 18 Nov 2003 13:39:20 -0500
Subject: [Twisted-Python] new ftp implementation
In-Reply-To: <3FBA5F25.4070506@twistedmatrix.com>
References: <3FBA5F25.4070506@twistedmatrix.com>
Message-ID: <3FBA6758.4000002@twistedmatrix.com>

Jonathan Simms wrote:
> Hello all,
> 
> Just wanted to announce there is a new version of the ftp server/protocol.
> 
> the new protocol:
> 
>   - Supports cred, so you can control/abstract the filesystem
>   - includes an anonymous-only avatar/realm
>   - supports pipelining of commands
>   - intentionally does not support globbing (to help prevent security
>     holes)
>   - connection limiting (ex. max 100 users)
>   - individual timeouts for protocol interpreter idle time and dtp
>     connection times
> 
> todos:
>   - the permissions-checking needs improvement. I intend to set up an
>     option on the FTPFactory that will let you set the uid of the
>     anonymous user, but that's coming in the next week.
>   - path purification code needs improvement (to prevent intentionally    
>     stupid paths like "\\//*/*/../../*/.." from borking the server)
>   - a couple of other minor odds-and-ends

one more note, as of right now, the avatar i've implemented will only 
work on linux/unix (specifically platforms that support python's pwd and 
grp modules). patches for win32 would be greatly appreciated! :)

> 
> 
> there's an example tac file in sandbox/slyphon/ftp_refactor/ftpsrv.tac
> 
> comments, suggestions, etc. welcomed
> 
> 
> -Jonathan Simms
> slyphon at twistedmatrix.com
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python






From dkuhlman at cutter.rexx.com  Tue Nov 18 16:20:03 2003
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Tue, 18 Nov 2003 15:20:03 -0800
Subject: [Twisted-Python] SOAP client for Twisted
Message-ID: <20031118152003.A985@cutter.rexx.com>

I've added minimal SOAP client support to Twisted.

I did it by copying a bit of code from twisted/web/xmlrpc.py and by
using some of the functionality from SOAPpy and adding it to
twisted/web/soap.py.

I've tested it lightly and it seems to work.

Is this of interest to the Twisted project?

If so, let me know and I'll send it along.

Someone who knows Twisted better than I will have to look at the
code to make sure that, given the way I implemented it, it does not
block.

Dave

-- 
Dave Kuhlman
dkuhlman at rexx.com
http://www.rexx.com/~dkuhlman



From itamar at itamarst.org  Tue Nov 18 16:45:35 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 18 Nov 2003 18:45:35 -0500
Subject: [Twisted-Python] SOAP client for Twisted
In-Reply-To: <20031118152003.A985@cutter.rexx.com>
References: <20031118152003.A985@cutter.rexx.com>
Message-ID: <20031118184535.4b951101.itamar@itamarst.org>

On Tue, 18 Nov 2003 15:20:03 -0800
Dave Kuhlman <dkuhlman at cutter.rexx.com> wrote:

> Is this of interest to the Twisted project?
> 
> If so, let me know and I'll send it along.

Yes indeed, please add a patch to
http://twistedmatrix.com/users/roundup.twistd/twisted/issue61 (note that
adding patches to twisted implies giving copyright to glyph for the copy
you submit.)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Tue Nov 18 17:23:43 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 19 Nov 2003 11:23:43 +1100
Subject: [Twisted-Python] win32eventreactor bug?
In-Reply-To: <20031118151402.43857400DF@server1.messagingengine.com>
References: <20031118151402.43857400DF@server1.messagingengine.com>
Message-ID: <20031119002343.GA15632@frobozz>

On Tue, Nov 18, 2003 at 07:14:02AM -0800, Justin Johnson wrote:
> I was running twistd on windows, serving out a custom tap which is just a
> web app and a pb service.  As it was doing it's thing, suddenly a ton of
> output started dumping on the log.  Did I find a bug in the win32 event
> reactor, or am I hitting some sort of limit?  I can send some code along
> if necessary, but nothing in the log looks specific to my code.

The win32eventreactor is limited to 64 objects, so that might be what's
causing the error.

-Andrew.




From mary-twisted at puzzling.org  Tue Nov 18 19:19:43 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed, 19 Nov 2003 13:19:43 +1100
Subject: Documentation editing tasks (Re: [Twisted-Python] Forum vs. mailing list)
In-Reply-To: <20031116004313.GA10624@titus.home.puzzling.org>
References: <20031115092957.GA1401@titus.home.puzzling.org> <20031116004313.GA10624@titus.home.puzzling.org>
Message-ID: <20031119021943.GA16031@titus.home.puzzling.org>

On Sun, Nov 16, 2003, Mary Gardiner wrote:
> As a way of getting a handle on this task, can people mail me offlist
> with their understanding of what the current burning issues with the
> documentation are, and with wishlist documentation issues too? That
> includes documents that aren't written and should be and documents
> that are written that need rewriting, as well as overview problems
> ("documents are poorly indexed" that kind of thing). Specific is
> better though...

OK, some results of this and later discussion is at
http://twistedmatrix.com/users/roundup.twistd/twisted/issue397

I've assigned a bunch of unclaimed doc bugs in the bug tracker to myself
(hypatia), and people can assign doc bugs to me if they like. I will try
and take responsibility at least for finding someone else to do them
otherwise they will go in what will probably turn out to be quite a long
list of docs to be written by me.

The first item I am likely to look at is an overall guide to the
documentation, probably with sub-topics ("multi-protocol applications
with Twisted", "web development with Twisted" and so on).

There's also a bit of demand for an overview of asynch network
programming and related docs on Deferreds assuming only the knowledge
given in such an overview. This is important but is not high on my own
todo list because I'm not an expert so if anyone wants to produce those
that would be excellent.

If you have comments, feel free to contact me on this list, by email
off-list, or on IRC, probably in that order of preference if you want me
to add stuff to a todo list (I'm terrible at using IRC as a todo list).

-Mary



From henni at brainbot.com  Wed Nov 19 04:59:35 2003
From: henni at brainbot.com (Thorsten Henninger)
Date: Wed, 19 Nov 2003 12:59:35 +0100
Subject: [Twisted-Python] GUI Integration
Message-ID: <3FBB5B27.5030809@brainbot.com>

Hi all,

I would like to integrate the PerspectiveBorker into a 
platform-independant GUI.
If I use Delphi for example, I include the twisted-reactor via the 
Python Deplhi Interface.
But then if I call "reactor.run()" this blocks the Delphi Application!
Since wxPython for is not supported for Windows yet, and I do not want 
to use GTK or PyGui, my question is:
How can I integrate the twisted framework into a GUI environment such as 
Delphi?
Or do I have to use Java?
Can I run the reactor in another thread?

regards,

Thorsten

-- 
brainbot technologies AG 
boppstrasse . 64 . 55118 mainz . germany
fon +49 6131 211639-1 . fax +49 6131 211639-2
http://brainbot.com/  mailto:henni at brainbot.com





From lafou at wanadoo.fr  Wed Nov 19 05:35:23 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 13:35:23 +0100
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <3FBB5B27.5030809@brainbot.com>
References: <3FBB5B27.5030809@brainbot.com>
Message-ID: <200311191335.23097.lafou@wanadoo.fr>

On Wednesday 19 November 2003 12:59, Thorsten Henninger wrote:
> Since wxPython for is not supported for Windows yet, and I do not want
> to use GTK or PyGui, my question is:

Where did you see that wxPython is not supported for windows ? it works 
perfect with windows ! Btw, you can find on this mailing list some examples 
about using twisted in wx apps.

kind regards
Philippe




From henni at brainbot.com  Wed Nov 19 05:49:06 2003
From: henni at brainbot.com (Thorsten Henninger)
Date: Wed, 19 Nov 2003 13:49:06 +0100
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <200311191335.23097.lafou@wanadoo.fr>
References: <3FBB5B27.5030809@brainbot.com> <200311191335.23097.lafou@wanadoo.fr>
Message-ID: <3FBB66C2.5000906@brainbot.com>

>Where did you see that wxPython is not supported for windows ? it works 
>perfect with windows ! Btw, you can find on this mailing list some examples 
>about using twisted in wx apps.
>  
>
this is what happens, if you run the wxdemo on windows 2000:
C:\Dokumente und Einstellungen\henni\Desktop>wxdemo.py
D:\Python23\lib\fcntl.py:7: DeprecationWarning: the FCNTL module is 
deprecated; please use fcntl
  DeprecationWarning)
D:\Python23\lib\site-packages\twisted\internet\wxsupport.py:69: 
UserWarning: Be advised wxsupport is not fully functional on Windows.
  warnings.warn("Be advised wxsupport is not fully functional on Windows.")
Traceback (most recent call last):
  File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line 
65, in ?
    demo()
  File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line 
61, in demo
    reactor.run()
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
121, in run
    self.startRunning(installSignalHandlers=installSignalHandlers)
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
115, in startRunning
    self._handleSignals()
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
87, in _handleSignals
    signal.signal(signal.SIGINT, self.sigInt)
SystemError: error return without exception set
13:45:14: Debug: c:\PROJECTS\wx\src\msw\app.cpp(439): 
'UnregisterClass(canvas)' failed with error 0x00000584 (diese Klasse hat 
noch geffnete Fenster.).

Of course, simulating the reactor via a wxTimer (as seen on ASPN) does 
work, but the latest twisted says, wxsupport is not fully supported on 
Windows.

regards,

Thorsten

-- 
brainbot technologies AG 
boppstrasse . 64 . 55118 mainz . germany
fon +49 6131 211639-1 . fax +49 6131 211639-2
http://brainbot.com/  mailto:henni at brainbot.com





From lafou at wanadoo.fr  Wed Nov 19 06:20:50 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 14:20:50 +0100
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <3FBB66C2.5000906@brainbot.com>
References: <3FBB5B27.5030809@brainbot.com> <200311191335.23097.lafou@wanadoo.fr> <3FBB66C2.5000906@brainbot.com>
Message-ID: <200311191420.50851.lafou@wanadoo.fr>

ouch ! 

I haven't seen this demo, but I think it's quite old. try this instead :

http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/203471


(your warning came from twisted, not wxpython)

and here is the killing tip of the day :

http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/181780


Hope it will help !
--
Philippe

On Wednesday 19 November 2003 13:49, Thorsten Henninger wrote:
> >Where did you see that wxPython is not supported for windows ? it works
> >perfect with windows ! Btw, you can find on this mailing list some
> > examples about using twisted in wx apps.
>
> this is what happens, if you run the wxdemo on windows 2000:
> C:\Dokumente und Einstellungen\henni\Desktop>wxdemo.py
> D:\Python23\lib\fcntl.py:7: DeprecationWarning: the FCNTL module is
> deprecated; please use fcntl
>   DeprecationWarning)
> D:\Python23\lib\site-packages\twisted\internet\wxsupport.py:69:
> UserWarning: Be advised wxsupport is not fully functional on Windows.
>   warnings.warn("Be advised wxsupport is not fully functional on Windows.")
> Traceback (most recent call last):
>   File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line
> 65, in ?
>     demo()
>   File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line
> 61, in demo
>     reactor.run()
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 121, in run
>     self.startRunning(installSignalHandlers=installSignalHandlers)
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 115, in startRunning
>     self._handleSignals()
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 87, in _handleSignals
>     signal.signal(signal.SIGINT, self.sigInt)
> SystemError: error return without exception set
> 13:45:14: Debug: c:\PROJECTS\wx\src\msw\app.cpp(439):
> 'UnregisterClass(canvas)' failed with error 0x00000584 (diese Klasse hat
> noch geffnete Fenster.).
>
> Of course, simulating the reactor via a wxTimer (as seen on ASPN) does
> work, but the latest twisted says, wxsupport is not fully supported on
> Windows.
>
> regards,
>
> Thorsten




From justinjohnson at fastmail.fm  Wed Nov 19 07:06:46 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 19 Nov 2003 06:06:46 -0800
Subject: [Twisted-Python] Retrieving Woven html element IDs
Message-ID: <20031119140646.D9D3941F48@server1.messagingengine.com>

In woven, html elements are automatically given an id (eg. <div
id="woven_id_18612312">... where the number is id(self) for the view).  I
have a div tag I'm trying to using to dump error logs into on the fly
with LivePage and display them to the user.  It seems that I cannot
reference a tag by name with javascript, so I need access to the
auto-generated id.  If I had the id I could do something similar to the
example below.

Does anyone know if it's possible to lookup this id in woven?

Thanks.
-Justin


<html>
<head>
<title>test</title>
<script type="text/javascript">
function displayErrors() {
    id = 'errors'
    document.getElementById(id).innerHTML += '<span>some
    error</span><br/>'
}
</script>
</head>
<body>
<a href="#" onclick="displayErrors()">add to errors</a>
<div id="errors">
</div>
</body>
</html>






From dp at twistedmatrix.com  Wed Nov 19 07:12:20 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 19 Nov 2003 09:12:20 -0500
Subject: [Twisted-Python] Retrieving Woven html element IDs
In-Reply-To: <20031119140646.D9D3941F48@server1.messagingengine.com>
References: <20031119140646.D9D3941F48@server1.messagingengine.com>
Message-ID: <636348AF-1A9A-11D8-AB79-000A95864FC4@twistedmatrix.com>

On Nov 19, 2003, at 9:06 AM, Justin Johnson wrote:

> In woven, html elements are automatically given an id (eg. <div
> id="woven_id_18612312">... where the number is id(self) for the view). 
>  I
> have a div tag I'm trying to using to dump error logs into on the fly
> with LivePage and display them to the user.  It seems that I cannot
> reference a tag by name with javascript, so I need access to the
> auto-generated id.  If I had the id I could do something similar to the
> example below.
>
> Does anyone know if it's possible to lookup this id in woven

The best way to do it is to provide your own ID. When you add an id 
attribute to a
node, woven will refrain from overwriting it with an auto-generated one.

dp




From justinjohnson at fastmail.fm  Wed Nov 19 07:25:35 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 19 Nov 2003 06:25:35 -0800
Subject: [Twisted-Python] Retrieving Woven html element IDs
In-Reply-To: <636348AF-1A9A-11D8-AB79-000A95864FC4@twistedmatrix.com>
References: <20031119140646.D9D3941F48@server1.messagingengine.com> <636348AF-1A9A-11D8-AB79-000A95864FC4@twistedmatrix.com>
Message-ID: <20031119142535.7957040D99@server1.messagingengine.com>

Excellent!  It is working beautifully now.  Thanks so much.

On Wed, 19 Nov 2003 09:12:20 -0500, "Donovan Preston"
<dp at twistedmatrix.com> said:
> 
> On Nov 19, 2003, at 9:06 AM, Justin Johnson wrote:
> 
> > In woven, html elements are automatically given an id (eg. <div
> > id="woven_id_18612312">... where the number is id(self) for the view). 
> >  I
> > have a div tag I'm trying to using to dump error logs into on the fly
> > with LivePage and display them to the user.  It seems that I cannot
> > reference a tag by name with javascript, so I need access to the
> > auto-generated id.  If I had the id I could do something similar to the
> > example below.
> >
> > Does anyone know if it's possible to lookup this id in woven
> 
> The best way to do it is to provide your own ID. When you add an id 
> attribute to a
> node, woven will refrain from overwriting it with an auto-generated one.
> 
> dp
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From lafou at wanadoo.fr  Wed Nov 19 07:43:17 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 15:43:17 +0100
Subject: [Twisted-Python] Retrieving Woven html element IDs
In-Reply-To: <20031119140646.D9D3941F48@server1.messagingengine.com>
References: <20031119140646.D9D3941F48@server1.messagingengine.com>
Message-ID: <200311191543.17302.lafou@wanadoo.fr>

> <html>
> <head>
> <title>test</title>
> <script type="text/javascript">
> function displayErrors() {
>     id = 'errors'
>     document.getElementById(id).innerHTML += '<span>some
>     error</span><br/>'
> }
> </script>
> </head>
> <body>
> <a href="#" onclick="displayErrors()">add to errors</a>
> <div id="errors">
> </div>
> </body>
> </html>


Did you try twisted.web.lmx or twisted.web.microdom ? These packages wil help
you to modify the dom tree. (lmx can modify the rendered tree, and  microdom 
the template tree, if i'm right).




From lafou at wanadoo.fr  Wed Nov 19 07:44:49 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 15:44:49 +0100
Subject: [Twisted-Python] Retrieving Woven html element IDs
In-Reply-To: <20031119142535.7957040D99@server1.messagingengine.com>
References: <20031119140646.D9D3941F48@server1.messagingengine.com> <636348AF-1A9A-11D8-AB79-000A95864FC4@twistedmatrix.com> <20031119142535.7957040D99@server1.messagingengine.com>
Message-ID: <200311191544.49631.lafou@wanadoo.fr>

On Wednesday 19 November 2003 15:25, Justin Johnson wrote:
> Excellent!  It is working beautifully now.  Thanks so much.

ho, this was so simple :p




From lstep at adequat.net  Wed Nov 19 09:03:47 2003
From: lstep at adequat.net (lstep at adequat.net)
Date: Wed, 19 Nov 2003 17:03:47 +0100
Subject: [Twisted-Python] Forum vs. mailing list (first try at a forum)
In-Reply-To: <20031114213921.GB2269@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <20031114213921.GB2269@twistedmatrix.com>
Message-ID: <200311191703.47235.lstep@adequat.net>

Just a note for a "first try" forum for people that like clicking :-)
Any suggestion is accepted! On http://twisted.banquise.org/

Luc



From itamar at itamarst.org  Wed Nov 19 09:09:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 19 Nov 2003 11:09:15 -0500
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <3FBB5B27.5030809@brainbot.com>
References: <3FBB5B27.5030809@brainbot.com>
Message-ID: <20031119110915.67bc4c76.itamar@itamarst.org>

On Wed, 19 Nov 2003 12:59:35 +0100
Thorsten Henninger <henni at brainbot.com> wrote:

> If I use Delphi for example, I include the twisted-reactor via the 
> Python Deplhi Interface.
> But then if I call "reactor.run()" this blocks the Delphi Application!

You want to integrate the Delphi event loop with the Twisted event loop.
This will involve either a custom reactor, or something like what
twisted.internet.wxsupport or tksupport do.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Wed Nov 19 09:44:59 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 19 Nov 2003 11:44:59 -0500
Subject: [Twisted-Python] Forum vs. mailing list (first try at a forum)
In-Reply-To: <200311191703.47235.lstep@adequat.net>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <20031114213921.GB2269@twistedmatrix.com> <200311191703.47235.lstep@adequat.net>
Message-ID: <20031119164459.GA18453@intarweb.us>

On Wed, Nov 19, 2003 at 05:03:47PM +0100, lstep at adequat.net wrote:
> Just a note for a "first try" forum for people that like clicking :-)
> Any suggestion is accepted! On http://twisted.banquise.org/

  Cool.  The clock is an hour fast, it seems (or maybe it just doesn't know
about daylight savings time.  I could hardly blame it), and there are a
couple other minor annoyances (I really wanted to see my name as "last
registered user"!  Oh well, it's only PHP *wink*), but cool.

  I thought I might suggest some other sections to create, but I think I'll
just wait and see what people use it for.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031119/9b18badf/attachment.sig>

From bob at redivi.com  Wed Nov 19 10:24:33 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 19 Nov 2003 12:24:33 -0500
Subject: [Twisted-Python] Forum vs. mailing list (first try at a forum)
In-Reply-To: <20031119164459.GA18453@intarweb.us>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <20031114213921.GB2269@twistedmatrix.com> <200311191703.47235.lstep@adequat.net> <20031119164459.GA18453@intarweb.us>
Message-ID: <3DFE1622-1AB5-11D8-B7C4-000A95686CD8@redivi.com>


On Nov 19, 2003, at 11:44 AM, Jp Calderone wrote:

> On Wed, Nov 19, 2003 at 05:03:47PM +0100, lstep at adequat.net wrote:
>> Just a note for a "first try" forum for people that like clicking :-)
>> Any suggestion is accepted! On http://twisted.banquise.org/
>
>   Cool.  The clock is an hour fast, it seems (or maybe it just doesn't 
> know
> about daylight savings time.  I could hardly blame it), and there are a
> couple other minor annoyances (I really wanted to see my name as "last
> registered user"!  Oh well, it's only PHP *wink*), but cool.
>
>   I thought I might suggest some other sections to create, but I think 
> I'll
> just wait and see what people use it for.

It's also really slow (a few minutes) to send out that confirmation 
email.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031119/d67343e2/attachment-0002.bin>

From lafou at wanadoo.fr  Wed Nov 19 11:29:52 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Wed, 19 Nov 2003 19:29:52 +0100
Subject: [Twisted-Python] Forum vs. mailing list (first try at a forum)
In-Reply-To: <200311191703.47235.lstep@adequat.net>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114213921.GB2269@twistedmatrix.com> <200311191703.47235.lstep@adequat.net>
Message-ID: <200311191929.52552.lafou@wanadoo.fr>

On Wednesday 19 November 2003 17:03, lstep at adequat.net wrote:
> Just a note for a "first try" forum for people that like clicking :-)
> Any suggestion is accepted! On http://twisted.banquise.org/


PHP based, but I love it :D




From jsbenson at bensonsystems.com  Wed Nov 19 12:03:21 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Wed, 19 Nov 2003 11:03:21 -0800
Subject: [Twisted-Python] looking for twisted Tkinter documentation
Message-ID: <02f301c3aecf$cdb35090$a90a500a@jsbwxp3>

Hi, I found the following at
http://twistedmatrix.com/documents/howto/choosing-reactor#auto16:

-----
Tkinter
The support for Tkinter doesn't use a specialized reactor. Instead, there is
some specialized support code:
from Tkinter import *
from twisted.internet import tksupport

root = Tk()
root.withdraw()

# Install the Reactor support
tksupport.install(root)

An example Twisted application that uses Tk can be found in
twisted/words/ui/tkim.py.
-----

But I didn't find it in either the twisted or TwistedDocs directories in my
Python 2.3 site-packages directory. The copyright,.py on my twisted
installation shows twisted version 1.1.0.

I also had a look at the examples index in
http://twistedmatrix.com/documents/examples/#auto8 and found links to uses
of qt, wx, gtk2 and curses, but nothing about Tkinter.

Having loaded up on Tkinter books on the strength of the assertion that
Tkinter is the standard, most cross-platform GUI for Python, I'm
understandably anxious to use it with twisted. I'm writing a socket server
that needs to both respond to incoming client requests and occasionally send
unsolicited messages to the client based on Tkinter button presses and timer
expirations.

I was originally going use some lower-level Python modules, but I was
intrigued by the stylistic and software engineering claims of twisted,
especially the use of aspect-oriented programming as a tool for managing
unrelated complexities, so I'm going to try to dive into twisted a little
deeper before giving up and heading back to the shallow end of the pool.
Thanks in advance for any information that will help me integrate Tkinter
with twisted.

P.S. I found the itamarst.org tutorials (formidavel!) and am working my way
through them.





From itamar at itamarst.org  Wed Nov 19 12:17:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 19 Nov 2003 14:17:51 -0500
Subject: [Twisted-Python] looking for twisted Tkinter documentation
In-Reply-To: <02f301c3aecf$cdb35090$a90a500a@jsbwxp3>
References: <02f301c3aecf$cdb35090$a90a500a@jsbwxp3>
Message-ID: <20031119141751.42151956.itamar@itamarst.org>

On Wed, 19 Nov 2003 11:03:21 -0800
"John Benson" <jsbenson at bensonsystems.com> wrote:

> I also had a look at the examples index in
> http://twistedmatrix.com/documents/examples/#auto8 and found links to
> uses of qt, wx, gtk2 and curses, but nothing about Tkinter.

http://sourceforge.net/projects/originalgamer is a twisted program that
uses Tk.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From jsbenson at bensonsystems.com  Wed Nov 19 13:45:26 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Wed, 19 Nov 2003 12:45:26 -0800
Subject: [Twisted-Python] Python a post-Object Oriented Language?
Message-ID: <035201c3aede$10464800$a90a500a@jsbwxp3>

Hi, I saw the above characterization in one of the itamarst.org twisted presentation slides. Although I'm just a journeyman programmer and somewhat unaccustomed to the rarefied atmosphere of many twisted Python discussions, I'm curious to hear why Python would be "post-OOP".

If I recall correctly, my little O'Reilly C++ book said that OOP meant you had 4 things (abstraction, encapsulation, hierarchy and something else that escapes me at the moment, maybe "coolness"). I also recall that compiled C++ had a hard time doing the neat tricks that an interpreted language can do and was necessarily limited by its origin as a preprocessor step in front of a classic C compiler. There were some minor differences like automatic constructor chaining in C++, as opposed to manual __init__ chaining in Python. There were some major differences like being able to dynamically set attributes on an object, and the replacement of data hiding by convention in Python.

Given that background, I'm just curious to hear the grounds on which Python can be classified as post-OOP. Any comments?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031119/4ae007ee/attachment.html>

From luc.stepniewski at adelux.fr  Wed Nov 19 08:46:24 2003
From: luc.stepniewski at adelux.fr (Luc Stepniewski)
Date: Wed, 19 Nov 2003 16:46:24 +0100
Subject: [Twisted-Python] Forum vs. mailing list
In-Reply-To: <20031114213921.GB2269@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24FF@EMSS07M12.us.lmco.com> <20031114210100.GA70172@clarkevans.com> <20031114213921.GB2269@twistedmatrix.com>
Message-ID: <200311191646.24890.luc.stepniewski@adelux.fr>

Just a note for a "first try" forum for people that like clicking :-)
Any suggestion is accepted! On http://twisted.banquise.org/

Luc



From rc at pgdn.org  Wed Nov 19 14:07:30 2003
From: rc at pgdn.org (Robert Church)
Date: Wed, 19 Nov 2003 13:07:30 -0800
Subject: [Twisted-Python] Python a post-Object Oriented Language?
In-Reply-To: <035201c3aede$10464800$a90a500a@jsbwxp3>
References: <035201c3aede$10464800$a90a500a@jsbwxp3>
Message-ID: <20031119210730.GB7130@pgdn.org>

On Wed, Nov 19, 2003 at 12:45:26PM -0800, John Benson quipped:

> Given that background, I'm just curious to hear the grounds on which
> Python can be classified as post-OOP. Any comments?

Fortunately or unfortunately, there's no single, one, common
definition for OOP. There is wide disparity in featuresets among
languages which are commonly held to be object-oriented.

Jonathan Rees gives us a nice catalog of some of the features
typically associated with OO here:

http://paulgraham.com/reesoo.html

In what respect is Python "post-OO"? Well, you could say that a
language which combines OO features with nice first class functions
and list comprehensions, while eliminating some of the Java cruft, is
"post-OO". But you could say the same for CLOS, or Self, which are 20
and 15 years old respectively, predating the widespread adoption of OO
by a good many years. So, maybe Python is "pre-OO"?

Here's an article in American Scientist alledging the existence of a
post-OO paradigm, including XP, aspects, and design patterns:

http://www.americanscientist.org/Issues/Comsci03/03-03Hayes.html



From kunger at intersight.com  Wed Nov 19 15:51:58 2003
From: kunger at intersight.com (Kevin Unger)
Date: Wed, 19 Nov 2003 14:51:58 -0800
Subject: [Twisted-Python] (Woven question)-->wchild_Xxx() called twice per hit
In-Reply-To: <20031119210730.GB7130@pgdn.org>
Message-ID: <FAEF90BE-1AE2-11D8-B544-003065B25CAA@intersight.com>

I have a two-screen mini test application.  Each screen has a page.Page 
subclass and a template associated with the page.Page.   Let's call 
them welcomePage and nextPage.  welcomePage.html has a form whose 
action is "nextPage."  WelcomePage has a wchild_nextPage() method which 
returns an instance of NextPage.

When welcomePage's form is submitted, WelcomePage's wchild_nextPage() 
gets called twice.  The first time it gets called with the expected 
request args, the second time the request args dictionary is empty.

Obviously I'm doing something wrong, but what?

-k




From itamar at itamarst.org  Wed Nov 19 15:55:04 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 19 Nov 2003 17:55:04 -0500
Subject: [Twisted-Python] (Woven question)-->wchild_Xxx() called twice
 per hit
In-Reply-To: <FAEF90BE-1AE2-11D8-B544-003065B25CAA@intersight.com>
References: <20031119210730.GB7130@pgdn.org>
	<FAEF90BE-1AE2-11D8-B544-003065B25CAA@intersight.com>
Message-ID: <20031119175504.641c72f8.itamar@itamarst.org>

On Wed, 19 Nov 2003 14:51:58 -0800
Kevin Unger <kunger at intersight.com> wrote:

> When welcomePage's form is submitted, WelcomePage's wchild_nextPage() 
> gets called twice.  The first time it gets called with the expected 
> request args, the second time the request args dictionary is empty.

Pages by default redirect so they have a / at the end. So you submit to
http://foo/nextPage and that gets redirected to http://foo/nextPage/.

Solutions:
1. submit to /nextPage/ from the start.
2. set addSlash=0 on NextPage.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From phil at bubblehouse.org  Wed Nov 19 16:15:15 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 19 Nov 2003 18:15:15 -0500 (EST)
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <20031118010123.GB12240@frobozz>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2>
    <20031118010123.GB12240@frobozz>
Message-ID: <3238.65.246.170.211.1069283715.squirrel@192.168.0.2>

So i followed Andrew's 'raw_input' advice with much success, but i
naturally wanted to dive into curses. I was checking out the
cursesclient.py file in doc/examples/, but it seems to be broken...

it connects and everything just fine, but as soon as i type anything, i
get the following:

-------------------------------------------------------------
--- <exception caught here> ---
File
"/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/
site-packages/twisted/python/log.py", line 60, in callWithLogger
    lp = logger.logPrefix()                                               
                         exceptions.AttributeError: Screen instance
has no attribute 'logPrefix'

-------------------------------------------------------------

any ideas?

-phil



From andrew-twisted at puzzling.org  Wed Nov 19 16:49:27 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 20 Nov 2003 10:49:27 +1100
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <3238.65.246.170.211.1069283715.squirrel@192.168.0.2>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2>
Message-ID: <20031119234927.GK32299@frobozz>

On Wed, Nov 19, 2003 at 06:15:15PM -0500, Phil Christensen wrote:
> So i followed Andrew's 'raw_input' advice with much success, but i
> naturally wanted to dive into curses. I was checking out the
> cursesclient.py file in doc/examples/, but it seems to be broken...
> 
> it connects and everything just fine, but as soon as i type anything, i
> get the following:
> 
> -------------------------------------------------------------
> --- <exception caught here> ---
> File
> "/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/
> site-packages/twisted/python/log.py", line 60, in callWithLogger
>     lp = logger.logPrefix()                                               
>                          exceptions.AttributeError: Screen instance
> has no attribute 'logPrefix'
> 
> -------------------------------------------------------------
> 
> any ideas?

It's already been fixed in CVS:

    http://cvs.twistedmatrix.com/cvs/doc/examples/cursesclient.py?rev=1.7&content-type=text/vnd.viewcvs-markup

-Andrew.




From stuart.hungerford at anu.edu.au  Wed Nov 19 17:07:09 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Thu, 20 Nov 2003 11:07:09 +1100
Subject: [Twisted-Python] Re: Browser oddities and Woven... (Thomas Raschbacher)
In-Reply-To: <20031119114309.2994.45470.Mailman@pyramid.twistedmatrix.co
 m>
References: <20031119114309.2994.45470.Mailman@pyramid.twistedmatrix.com>
Message-ID: <6.0.0.22.0.20031120105725.01e08070@anusf.anu.edu.au>

Quoth twisted-python-request at twistedmatrix.com:

 >| I've developed a Woven application that generates three
 >| HTML pages, let's call them A, B, and C.
 >|
 >| A's render() method does a redirect to B. B's view methods
 >| generate an XHTML meta tag with the content attribute set
 >| to a refresh and new URL for C:
 >|
 >|     <meta content="10;http://example.org/C" http-equiv="refresh" />
 >|
 >AFAIK this would be the correct syntax:
 ><META name="refresh" content="3,http://www.acme.com/intro.html" />
 >~                               ^
 >(ie ',' instead of ';')
 >http://www.w3.org/TR/WD-html40-970708/struct/global.html#h-7.1.3.2

    Many thanks for pointing that out.  Unfortunately it makes no
    difference to the behaviour with IE or Mozilla.  I've since tried
    with Opera 7 and it goes into the endless loop too, which makes
    me think there's a problem with the (X)HTML my Woven pages are
    generating and Mozilla is being very forgiving.

    I've tried adding the equivalent HTTP headers to the request
    headers in Woven and also run the generated XHTML through the
    W3C validator.  It reported a couple of errors with some
    <tr> attributes but nothing about the <meta> elements.

    This is the generated XHTML <head>:

<?xml version="1.0"?>
<!DOCTYPE html
      PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
   <meta content="en-us" http-equiv="Content-Language" />
   <meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
   <meta content="Pacific And Regional Archive for DIgital Sources in 
Endangered Cultures " name="description" />
   <meta content="digital, digitisation, digitization, pacific,
                                        language, music, endangered, 
university, sydney,
                                        melbourne, ANU, australian, 
national, culture,
                                        metadata" name="keywords" />
   <meta content="language resource, language resources,
                                        language archive, linguistic 
archive, open archives,
                                        metadata, dublin core, controlled 
vocabulary,
                                        linguistics, linguistic data, 
language data, Pacific,
                                        endangered culture, endangered 
language, musicology,
                                        indigneous song" name="keywords" />
   <meta http-equiv="refresh" 
content="5,http://store.apac.edu.au:8181/paradisec/archive/request/download/238/AM3-008-008A.mp3" 
/>
   <link 
href="http://store.apac.edu.au:8181/PARADISEC/resources/css/paradisec.css" 
type="text/css" rel="stylesheet" />
   <title>Downloading your file AM3/008/AM3-008-008A.mp3</title>
  </head>

Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From radix at twistedmatrix.com  Wed Nov 19 17:19:13 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 19 Nov 2003 19:19:13 -0500
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <20031119234927.GK32299@frobozz>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2> <20031119234927.GK32299@frobozz>
Message-ID: <20031120001913.GE20287@radii>

On Thu, Nov 20, 2003 at 10:49:27AM +1100, Andrew Bennetts wrote:
> It's already been fixed in CVS:

Ok, I've heard this enough times. I'm going to release 1.1.1.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From corydodt at twistedmatrix.com  Wed Nov 19 17:29:33 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed, 19 Nov 2003 16:29:33 -0800
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <20031120001913.GE20287@radii>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2> <20031119234927.GK32299@frobozz> <20031120001913.GE20287@radii>
Message-ID: <3FBC0AED.4000600@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Is there a counter?  Do you tie knots in string? :-)

C

Christopher Armstrong wrote:

| On Thu, Nov 20, 2003 at 10:49:27AM +1100, Andrew Bennetts wrote:
|
|>It's already been fixed in CVS:
|
|
| Ok, I've heard this enough times. I'm going to release 1.1.1.
|

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/vArt3A5SrXAiHQcRAk4vAKCsa8U/jmDGGmsJZrK0ljZkloq54QCfbsbd
94xVAAqhXge/t/14l7lz+mA=
=uIxg
-----END PGP SIGNATURE-----



From andrew-twisted at puzzling.org  Wed Nov 19 17:39:30 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 20 Nov 2003 11:39:30 +1100
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <20031120001913.GE20287@radii>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2> <20031119234927.GK32299@frobozz> <20031120001913.GE20287@radii>
Message-ID: <20031120003930.GL32299@frobozz>

On Wed, Nov 19, 2003 at 07:19:13PM -0500, Christopher Armstrong wrote:
> On Thu, Nov 20, 2003 at 10:49:27AM +1100, Andrew Bennetts wrote:
> > It's already been fixed in CVS:
> 
> Ok, I've heard this enough times. I'm going to release 1.1.1.

Hooray! :)

-Andrew.




From andrew-twisted at puzzling.org  Wed Nov 19 17:53:19 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 20 Nov 2003 11:53:19 +1100
Subject: [Twisted-Python] Re: [Twisted-commits] Today is screw with twisted's guts day.
In-Reply-To: <E1AMZY3-0008UW-00@wolfwood>
References: <E1AMZY3-0008UW-00@wolfwood>
Message-ID: <20031120005319.GM32299@frobozz>

On Wed, Nov 19, 2003 at 02:07:39PM -0700, exarkun CVS wrote:
> Index: Twisted/twisted/internet/base.py
> diff -u Twisted/twisted/internet/base.py:1.67 Twisted/twisted/internet/base.py:1.68
> --- Twisted/twisted/internet/base.py:1.67	Fri Oct 24 12:45:58 2003
> +++ Twisted/twisted/internet/base.py	Wed Nov 19 14:07:38 2003
> @@ -400,12 +400,12 @@
>          """Run all pending timed calls.
>          """
>          if self.threadCallQueue:
> -            for i in range(len(self.threadCallQueue)):
> -                callable, args, kw = self.threadCallQueue.pop(0)
> +            for (f, a, kw) in self.threadCallQueue:
>                  try:
> -                    callable(*args, **kw)
> +                    f(*a, **kw)
>                  except:
> -                    log.deferr()
> +                    log.err()
> +            del self.threadCallQueue[:]
>          now = time()
>          while self._pendingTimedCalls and (self._pendingTimedCalls[-1].time <= now):
>              call = self._pendingTimedCalls.pop()

I think this change introduces a race condition.  It's possible for a thread
to call callFromThread between the end of the for loop and the del
statement.

(callFromThread is defined as:
    def callFromThread(self, f, *args, **kw):
        """See twisted.internet.interfaces.IReactorThreads.callFromThread.
        """
        assert callable(f), "%s is not callable" % f
        if threadable.isInIOThread():
            self.callLater(0, f, *args, **kw)
        else:
            # lists are thread-safe in CPython, but not in Jython
            # this is probably a bug in Jython, but until fixed this code
            # won't work in Jython.
            self.threadCallQueue.append((f, args, kw))
            self.wakeUp()
)

So I think it's possible to lose thread calls.  I *think* this patch will
fix it, but more eyeballs are always welcome with threaded code:

diff -u -r1.68 base.py
--- twisted/internet/base.py    19 Nov 2003 21:07:38 -0000      1.68
+++ twisted/internet/base.py    20 Nov 2003 00:52:08 -0000
@@ -400,12 +400,14 @@
         """Run all pending timed calls.
         """
         if self.threadCallQueue:
+            count = 0
             for (f, a, kw) in self.threadCallQueue:
                 try:
                     f(*a, **kw)
                 except:
                     log.err()
-            del self.threadCallQueue[:]
+                count += 1
+            del self.threadCallQueue[:count]
         now = time()
         while self._pendingTimedCalls and (self._pendingTimedCalls[-1].time <= now):
             call = self._pendingTimedCalls.pop()


-Andrew.




From exarkun at intarweb.us  Wed Nov 19 18:12:56 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 19 Nov 2003 20:12:56 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Today is screw with twisted's guts day.
In-Reply-To: <20031120005319.GM32299@frobozz>
References: <E1AMZY3-0008UW-00@wolfwood> <20031120005319.GM32299@frobozz>
Message-ID: <20031120011256.GA20693@intarweb.us>

On Thu, Nov 20, 2003 at 11:53:19AM +1100, Andrew Bennetts wrote:
> [snip]
> 
> So I think it's possible to lose thread calls.  I *think* this patch will
> fix it, but more eyeballs are always welcome with threaded code:

  Thanks for noticing this.

> 
> diff -u -r1.68 base.py
> --- twisted/internet/base.py    19 Nov 2003 21:07:38 -0000      1.68
> +++ twisted/internet/base.py    20 Nov 2003 00:52:08 -0000
> @@ -400,12 +400,14 @@
>          """Run all pending timed calls.
>          """
>          if self.threadCallQueue:
> +            count = 0
>              for (f, a, kw) in self.threadCallQueue:
>                  try:
>                      f(*a, **kw)
>                  except:
>                      log.err()
> -            del self.threadCallQueue[:]
> +                count += 1
> +            del self.threadCallQueue[:count]
>          now = time()
>          while self._pendingTimedCalls and (self._pendingTimedCalls[-1].time <= now):
>              call = self._pendingTimedCalls.pop()
> 

  That looks a little more complex than it needs to be.  What about this
version?


    def runUntilCurrent(self):
        """Run all pending timed calls.
        """
        if self.threadCallQueue:
            calls, self.threadCallQueue = self.threadCallQueue, []
            for (f, a, kw) in calls:               
                try:
                    f(*a, **kw)
                except:
                    log.err()

  I considered doing it this way first, but wasn't sure if anyone relied on
the identity of threadCallQueue (not that anyone should, but one never
knows).  If anyone thinks changing its identity should be avoided, I'd like
this version:

    def runUntilCurrent(self):
        """Run all pending timed calls.
        """
        if self.threadCallQueue:
            calls = self.threadCallQueue[:]
            del self.threadCallQueue[:]
            for (f, a, kw) in calls:
                try:
                    f(*a, **kw)
                except:
                    log.err()


  I suppose reverting it entirely is an option, seeing as how no one has yet
*actually* been bitten by the quadratic behavior (nor does it seem likely
that anyone will be), but all other things equal, it's nicer to use O(N)
algorithms deep down in the guts of Twisted than to use O(N**2) algorithms.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031119/72313699/attachment.sig>

From andrew-twisted at puzzling.org  Wed Nov 19 18:38:03 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 20 Nov 2003 12:38:03 +1100
Subject: [Twisted-Python] Re: [Twisted-commits] Today is screw with twisted's guts day.
In-Reply-To: <20031120011256.GA20693@intarweb.us>
References: <E1AMZY3-0008UW-00@wolfwood> <20031120005319.GM32299@frobozz> <20031120011256.GA20693@intarweb.us>
Message-ID: <20031120013803.GN32299@frobozz>

On Wed, Nov 19, 2003 at 08:12:56PM -0500, Jp Calderone wrote:
> On Thu, Nov 20, 2003 at 11:53:19AM +1100, Andrew Bennetts wrote:
[patch to keep count of items used from the list]
> 
>   That looks a little more complex than it needs to be.  What about this
> version?
> 
> 
>     def runUntilCurrent(self):
>         """Run all pending timed calls.
>         """
>         if self.threadCallQueue:
>             calls, self.threadCallQueue = self.threadCallQueue, []
>             for (f, a, kw) in calls:               
>                 try:
>                     f(*a, **kw)
>                 except:
>                     log.err()

Yeah, that looks ok too, I think.  I'm less certain though... is it possible
for this to happen:

     reactor thread                 other thread
     --------------                 ------------
                                    call callFromThread
                                      ...get reference to self.threadCallQueue
     call runUntilCurrent
       ...set self.tCQ to a new list
       ...do for loop
                                      ...append to now old threadCallQueue

So that again, a call can go missing?  Hmm, I think this is possible, so
that version is also bad.  It's also harder to reason about than my patch --
I had to disassemble it to help me think about it :)

>   I considered doing it this way first, but wasn't sure if anyone relied on
> the identity of threadCallQueue (not that anyone should, but one never
> knows).  If anyone thinks changing its identity should be avoided, I'd like
> this version:
> 
>     def runUntilCurrent(self):
>         """Run all pending timed calls.
>         """
>         if self.threadCallQueue:
>             calls = self.threadCallQueue[:]
>             del self.threadCallQueue[:]
>             for (f, a, kw) in calls:
>                 try:
>                     f(*a, **kw)
>                 except:
>                     log.err()
> 

That's definitely racy!  What if the call to callFromThread happens between
the "calls = ..." and the del statement?

A version which does
    calls = self.threadCallQueue[:]
    del self.threadCallQueue[:len(calls)]

Should be ok though, for the same reason my patch is (or at least I think it
is :)

The main difference between that version and my is this one involves a small
list copy, but it might still be faster than executing "count += 1" on every
loop iteration.  Either way, it's at the point where I don't care :)

>   I suppose reverting it entirely is an option, seeing as how no one has yet
> *actually* been bitten by the quadratic behavior (nor does it seem likely
> that anyone will be), but all other things equal, it's nicer to use O(N)
> algorithms deep down in the guts of Twisted than to use O(N**2) algorithms.

I think I'd like to see it improved to have O(N) complexity too.

-Andrew.




From exarkun at intarweb.us  Wed Nov 19 18:41:58 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 19 Nov 2003 20:41:58 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] Today is screw with twisted's guts day.
In-Reply-To: <20031120013803.GN32299@frobozz>
References: <E1AMZY3-0008UW-00@wolfwood> <20031120005319.GM32299@frobozz> <20031120011256.GA20693@intarweb.us> <20031120013803.GN32299@frobozz>
Message-ID: <20031120014158.GA20826@intarweb.us>

On Thu, Nov 20, 2003 at 12:38:03PM +1100, Andrew Bennetts wrote:
> On Wed, Nov 19, 2003 at 08:12:56PM -0500, Jp Calderone wrote:
> > On Thu, Nov 20, 2003 at 11:53:19AM +1100, Andrew Bennetts wrote:
> [patch to keep count of items used from the list]
> > 
> >   That looks a little more complex than it needs to be.  What about this
> > version?
> > 
> > 
> >     def runUntilCurrent(self):
> >         """Run all pending timed calls.
> >         """
> >         if self.threadCallQueue:
> >             calls, self.threadCallQueue = self.threadCallQueue, []
> >             for (f, a, kw) in calls:               
> >                 try:
> >                     f(*a, **kw)
> >                 except:
> >                     log.err()
> 
> Yeah, that looks ok too, I think.  I'm less certain though... is it possible
> for this to happen:
> 
>      reactor thread                 other thread
>      --------------                 ------------
>                                     call callFromThread
>                                       ...get reference to self.threadCallQueue
>      call runUntilCurrent
>        ...set self.tCQ to a new list
>        ...do for loop
>                                       ...append to now old threadCallQueue
> 
> So that again, a call can go missing?  Hmm, I think this is possible, so
> that version is also bad.  It's also harder to reason about than my patch --
> I had to disassemble it to help me think about it :)
> 
> >   I considered doing it this way first, but wasn't sure if anyone relied on
> > the identity of threadCallQueue (not that anyone should, but one never
> > knows).  If anyone thinks changing its identity should be avoided, I'd like
> > this version:
> > 
> >     def runUntilCurrent(self):
> >         """Run all pending timed calls.
> >         """
> >         if self.threadCallQueue:
> >             calls = self.threadCallQueue[:]
> >             del self.threadCallQueue[:]
> >             for (f, a, kw) in calls:
> >                 try:
> >                     f(*a, **kw)
> >                 except:
> >                     log.err()
> > 
> 
> That's definitely racy!  What if the call to callFromThread happens between
> the "calls = ..." and the del statement?
> 

  Shows how used to thinking about threaded code I am.

> A version which does
>     calls = self.threadCallQueue[:]
>     del self.threadCallQueue[:len(calls)]
> 
> Should be ok though, for the same reason my patch is (or at least I think it
> is :)
> 
> The main difference between that version and my is this one involves a small
> list copy, but it might still be faster than executing "count += 1" on every
> loop iteration.  Either way, it's at the point where I don't care :)
> 

  I think I like your version more now.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031119/f625e059/attachment.sig>

From michal at pasternak.w.lub.pl  Wed Nov 19 20:20:41 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Thu, 20 Nov 2003 04:20:41 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
Message-ID: <20031120032041.GA11694@pasternak.w.lub.pl>

Hi,

I have a webpage, that is rendered via twisted.web.woven.page.Page class.

In one of it's wvfactory_ methods, I need to send an e-mail. I would also
like to check if sending of the e-mail was successful (eg. mailserver is
up, running, and reachable via network).

I thought about something like this:

  def wvfactory_render(self, req, node, model):
      # do some stuff 
      sendEMail().addCallbacks(self.emailOkay, self.emailFailure)
      return # what should I return here?
      
  def emailOkay(self, *args):
      # render "thank you, e-mail sent" message 
      
  def emailFailure(self, *args):
      # render "error" message
      
My questions:
   1) is it a good, Twisted Python way to do this? If not,
      a) what would be the correct one? 
      b) can you point me to some docs?
   2) if it is a good way:
      a) is it implemented? if yes:
      	 1) what should I return from wvfactory_render? 
	 2) what parameters would be passed to callbacks then?
      b) if not, do you think it would be worth implementing?
      
I have seen something similar like the thing I want to code in some example
sources:

       def render(...):
       	   [ launch some callbacks ] 
	   return server.NOT_DONE_YET
  
... but they were about Resource class, and I'm using Page here.

Anyone?

Regards,
-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From anthony at interlink.com.au  Wed Nov 19 20:26:32 2003
From: anthony at interlink.com.au (Anthony Baxter)
Date: Thu, 20 Nov 2003 14:26:32 +1100
Subject: [Twisted-Python] looking for twisted Tkinter documentation 
In-Reply-To: <20031119141751.42151956.itamar@itamarst.org> 
Message-ID: <200311200326.hAK3QYVl027299@localhost.localdomain>

>>> Itamar Shtull-Trauring wrote
> On Wed, 19 Nov 2003 11:03:21 -0800
> "John Benson" <jsbenson at bensonsystems.com> wrote:
> 
> > I also had a look at the examples index in
> > http://twistedmatrix.com/documents/examples/#auto8 and found links to
> > uses of qt, wx, gtk2 and curses, but nothing about Tkinter.
> 
> http://sourceforge.net/projects/originalgamer is a twisted program that
> uses Tk.

Shtoom (http://sf.net/projects/shtoom) also has a Tk UI (as well as a Qt
one and an MFC one).

Anthony
-- 
Anthony Baxter     <anthony at interlink.com.au>   
It's never too late to have a happy childhood.




From slyphon at twistedmatrix.com  Wed Nov 19 23:38:06 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Thu, 20 Nov 2003 01:38:06 -0500
Subject: [Twisted-Python] home for ftp goodies?
Message-ID: <3FBC614E.6030800@twistedmatrix.com>

I was talking with jp and itamar about the ftp extras. I've implemented 
an anonymous avatar, a realm, and have begun working on a method or two 
for filepath permissions checking. I wanted some opinions on how we can 
separate these extra 'goodies' from the protocol implementation itself.

any thoughts?




From lafou at wanadoo.fr  Thu Nov 20 03:04:31 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Thu, 20 Nov 2003 11:04:31 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <20031120032041.GA11694@pasternak.w.lub.pl>
References: <20031120032041.GA11694@pasternak.w.lub.pl>
Message-ID: <200311201104.32146.lafou@wanadoo.fr>

Same problem here, and I didn't find a solution. This should to the woven faq 
I think.

On Thursday 20 November 2003 04:20, Michal Pasternak wrote:
> Hi,
>
> I have a webpage, that is rendered via twisted.web.woven.page.Page class.
>
> In one of it's wvfactory_ methods, I need to send an e-mail. I would also
> like to check if sending of the e-mail was successful (eg. mailserver is
> up, running, and reachable via network).
>
> I thought about something like this:
>
>   def wvfactory_render(self, req, node, model):
>       # do some stuff
>       sendEMail().addCallbacks(self.emailOkay, self.emailFailure)
>       return # what should I return here?
>
>   def emailOkay(self, *args):
>       # render "thank you, e-mail sent" message
>
>   def emailFailure(self, *args):
>       # render "error" message
>
> My questions:
>    1) is it a good, Twisted Python way to do this? If not,
>       a) what would be the correct one?
>       b) can you point me to some docs?
>    2) if it is a good way:
>       a) is it implemented? if yes:
>       	 1) what should I return from wvfactory_render?
> 	 2) what parameters would be passed to callbacks then?
>       b) if not, do you think it would be worth implementing?
>
> I have seen something similar like the thing I want to code in some example
> sources:
>
>        def render(...):
>        	   [ launch some callbacks ]
> 	   return server.NOT_DONE_YET
>
> ... but they were about Resource class, and I'm using Page here.
>
> Anyone?
>
> Regards,




From oisin at enginesofcreation.ie  Thu Nov 20 03:22:32 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Thu, 20 Nov 2003 10:22:32 +0000
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <20031008020028.GA8353@frobozz>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031008020028.GA8353@frobozz>
Message-ID: <3FBC95E8.9000205@enginesofcreation.ie>

Andrew Bennetts wrote:

>On Fri, Oct 03, 2003 at 11:18:28AM +0100, Oisin Mulvihill wrote:
>  
>
>>Why are there two deferred objects returned by storeFile? The documentation
>>says:
>>    
>>
>
>Try looking at twisted/test/test_ftp.py, line 251 (the testStor method of
>FTPClientAndServerTests).  Hopefully that should help fill in the blanks.
>
>-Andrew.
>
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>  
>
Hi,

I know its been a while, but the project I needed this for has
gone on the back burner. I was going to do an example for
how I got the file to send and then do a recieve. I haven't got
around to it. So for posterity and for anyone else who hits the
same problem here is the modified ftp example that shows
how I uploaded a file using twisted. The answer was in the unit
tests I'd just forgotten twisted had them.

All the best,

om


-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540


-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031120/325009ad/attachment.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftpclient.py
URL: </pipermail/twisted-python/attachments/20031120/325009ad/attachment.ksh>

From Alan.Rushforth at student.shu.ac.uk  Thu Nov 20 03:48:10 2003
From: Alan.Rushforth at student.shu.ac.uk (Alan Rushforth)
Date: Thu, 20 Nov 2003 10:48:10 +0000
Subject: [Twisted-Python] Unable to get the UDP multicasting examples to work
Message-ID: <fc.005b8dcc029335ea005b8dcc029335ea.29336b9@samson.shu.ac.uk>

Hi,

This may well be a very trivial question but i have been trying to get the UDP
multicasting example in the "how to" section of the twisted documentation to
work and have had no success. I can do TCP message and normal UDP but cant
multicast it.

It does not report any errors but nothing every seems to be received by the
echo server.
Don't I need to explicitly join the multicast group at any point?

The code i have been using is as follows:
The multicast client:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
class Client(DatagramProtocol): 
	def datagramReceived(self, data, host):
	 	print 'Response Recieved:', data.strip()
		print 'From Host:', host
reactor.listenUDP(0, Client()).write('broadcast\n', ('224.0.0.1', 9999))
reactor.run() 

The original Echo server:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
class Echo(DatagramProtocol):
	def datagramReceived(self, data, (host, port)):
		print "received %r from %s:%d" % (data, host, port)
		self.transport.write(data, (host, port))
reactor.listenUDP(9999, Echo())
reactor.run() 

Thanks for any help,
Alan.




From michal at pasternak.w.lub.pl  Thu Nov 20 04:25:16 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Thu, 20 Nov 2003 12:25:16 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <200311201104.32146.lafou@wanadoo.fr>
References: <20031120032041.GA11694@pasternak.w.lub.pl> <200311201104.32146.lafou@wanadoo.fr>
Message-ID: <20031120112516.GB9102@pasternak.w.lub.pl>

Philippe Lafoucri?re [Thu, Nov 20, 2003 at 11:04:31AM +0100]:
> Same problem here, and I didn't find a solution. This should to the woven faq 
> I think.

As I am a very, very lazy man, I'd like to hear from at least one Twisted
developer, that it's currently impossible (or unwise to do that) before
trying to implement such functionality.

... and I wonder if it's different for nevow.

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From grib at billgribble.com  Thu Nov 20 06:14:33 2003
From: grib at billgribble.com (Bill Gribble)
Date: Thu, 20 Nov 2003 07:14:33 -0600
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <20031120112516.GB9102@pasternak.w.lub.pl>
References: <20031120032041.GA11694@pasternak.w.lub.pl>
	 <200311201104.32146.lafou@wanadoo.fr>
	 <20031120112516.GB9102@pasternak.w.lub.pl>
Message-ID: <1069334073.8284.4.camel@serrano>

On Thu, 2003-11-20 at 05:25, Michal Pasternak wrote:
> Philippe Lafoucri?re [Thu, Nov 20, 2003 at 11:04:31AM +0100]:
> > Same problem here, and I didn't find a solution. This should to the woven faq 
> > I think.
> 
> As I am a very, very lazy man, I'd like to hear from at least one Twisted
> developer, that it's currently impossible (or unwise to do that) before
> trying to implement such functionality.

Well, it's possible to do if you are willing to do some legwork
yourself.  If you override the render method of your Page, you can
manually handle waiting for the Deferred stuff to finish, because in a
Resource's render you can return NOT_DONE_YET and then call
request.finish() at a later time.  I've done that successfully. 

nevow handles all this stuff much more smoothly.  I wouldn't put a lot
of work into extending woven. 

b.g.
 




From lafou at wanadoo.fr  Thu Nov 20 06:30:29 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Thu, 20 Nov 2003 14:30:29 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <1069334073.8284.4.camel@serrano>
References: <20031120032041.GA11694@pasternak.w.lub.pl> <20031120112516.GB9102@pasternak.w.lub.pl> <1069334073.8284.4.camel@serrano>
Message-ID: <200311201430.29582.lafou@wanadoo.fr>

> Well, it's possible to do if you are willing to do some legwork
> yourself.  If you override the render method of your Page, you can
> manually handle waiting for the Deferred stuff to finish, because in a
> Resource's render you can return NOT_DONE_YET and then call
> request.finish() at a later time.  I've done that successfully.
>
> nevow handles all this stuff much more smoothly.  I wouldn't put a lot
> of work into extending woven.


When will nevow will be considered as stable enough ? I won't create an entire 
app using woven if it's going to be depracated in 1 month :(
Btw, could you send us a  concrete example of what you were talking about ?
thank you
--
Philippe




From 2s7l3way02 at sneakemail.com  Thu Nov 20 08:45:45 2003
From: 2s7l3way02 at sneakemail.com (Mark Evans)
Date: 20 Nov 2003 15:45:45 -0000
Subject: [Twisted-Python] Mixmaster Architecture
Message-ID: <12452-02919@sneakemail.com>


Here's an architecture question for Twisted Matrix gurus.
I need to implement a "mixmaster" scheme, as follows:

                           |--> Remote client A
        UDP            TCP |
Server <---> Mixmaster <---|--> Remote client B
                           |
                           |--> Remote client C
                           |
                           ... (etc.)

Here is the background data:

Server <---> mixmaster is a custom binary protocol
over UDP transport.

Mixmaster <---> clients is custom protocol(s)
over TCP transport.  The most important client type
uses Telnet (raw).

Server and mixmaster script live on the same PC.
Remote clients have individual IPs and MACs.

Server is closed-source Java; I cannot change it.
Server's UDP communications is stock Java from Sun.
Clients are different closed-source systems (not PCs).
Mixmaster script is my Python.  How to architect it?

The Mixmaster script needs to multiplex communications
between clients and server.  The server will think it's
talking to N clients, all of which know its peculiar
protocol.  It's OK for the server to believe they have
the same IP address 127.0.0.1.  There is other identifying
information in the server protocol to distinguish the
clients (including MACs and device name strings).

I have an idea how to proceed, but still would like to
hear your advice, and thank you for it.

Mark



From dp at twistedmatrix.com  Thu Nov 20 08:50:30 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Thu, 20 Nov 2003 10:50:30 -0500
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <20031120032041.GA11694@pasternak.w.lub.pl>
References: <20031120032041.GA11694@pasternak.w.lub.pl>
Message-ID: <44F1BA9E-1B71-11D8-8EF4-000A95864FC4@twistedmatrix.com>

On Nov 19, 2003, at 10:20 PM, Michal Pasternak wrote:

> Hi,
>
> I have a webpage, that is rendered via twisted.web.woven.page.Page 
> class.
>
> In one of it's wvfactory_ methods, I need to send an e-mail. I would 
> also
> like to check if sending of the e-mail was successful (eg. mailserver 
> is
> up, running, and reachable via network).
>
> I thought about something like this:

<snip>

Woven has some, ahem, object identity issues. It really, really wants 
you to return an actual View instance from a wvfactory_. However, it 
does support deferreds being returned from the Widget.generate method. 
A deferred callback should mutate the incoming template node in place 
in order to cause some changes to the final page:

class MyDeferredWidget(widgets.Widget):
	def generate(self, request, node):
		theDeferred = doSomeAction()
		def theCallback(result):
			node.appendChild(
				request.d.createTextNode("the result was: %s" % result)
			)
		theDeferred.addCallback(theCallback)
		return theDeferred


class MyPage(page.Page):
	template = """<html><span view="theDeferredThing" /></html>"""

	def wvfactory_theDeferredThing(self, request, node, model):
		return MyDeferredWidget(model)


This is completely untested, but it gives you an idea of what to do. 
One of the main reasons for embarking upon nevow was that I knew a lot 
more about Deferreds than when I wrote woven, and woven's architecture 
made it very difficult to support deferreds properly. In nevow, the 
code might look like:


class MyPage(renderer.Renderer):
	def render_doSomeAction(self, context, data):
		return doSomeAction().addCallback(
			lambda result: "The result was: %s" % result)

	document = html[
	span[
		render_doSomeAction
	]
]

The point is nevow was designed from the beginning to handle Deferreds 
more gracefully than woven was. Also, because the paradigm in nevow 
sticks far better to "the return value of a callable replaces whatever 
came in" than woven ended up doing, it's impossible to get into funny 
identity situations where you're mutating an object but you don't see 
the result of it in the final page, because you were mutating a copy 
and it was the wrong object.

dp




From itamar at itamarst.org  Thu Nov 20 09:26:44 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 20 Nov 2003 11:26:44 -0500
Subject: [Twisted-Python] Unable to get the UDP multicasting examples to
 work
In-Reply-To: <fc.005b8dcc029335ea005b8dcc029335ea.29336b9@samson.shu.ac.uk>
References: <fc.005b8dcc029335ea005b8dcc029335ea.29336b9@samson.shu.ac.uk>
Message-ID: <20031120112644.230bbc9c.itamar@itamarst.org>

On Thu, 20 Nov 2003 10:48:10 +0000
"Alan Rushforth" <Alan.Rushforth at student.shu.ac.uk> wrote:

> multicasting example in the "how to" section of the twisted
> documentation to work and have had no success. I can do TCP message
> and normal UDP but cant multicast it.

Bleh. My bad (well, and Pahan's). You want to use listenMulticast,
really, and you need to join() a group. See twisted.internet.interfaces
- the multicast stuff, and twisted.test.test_udp. I will remove the
offending docs.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Thu Nov 20 10:20:57 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 20 Nov 2003 12:20:57 -0500
Subject: [Twisted-Python] cursesclient bugs?
In-Reply-To: <3FBC0AED.4000600@twistedmatrix.com>
References: <1470.65.246.170.211.1069108464.squirrel@192.168.0.2> <20031118010123.GB12240@frobozz> <3238.65.246.170.211.1069283715.squirrel@192.168.0.2> <20031119234927.GK32299@frobozz> <20031120001913.GE20287@radii> <3FBC0AED.4000600@twistedmatrix.com>
Message-ID: <E74993AE-1B7D-11D8-AE63-000393C9700E@twistedmatrix.com>

On Nov 19, 2003, at 7:29 PM, Cory Dodt wrote:

> Is there a counter?  Do you tie knots in string? :-)

Notches on the wall of his cell, I think ;)




From twisted at zadka.site.co.il  Thu Nov 20 10:47:06 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 20 Nov 2003 17:47:06 -0000
Subject: [Twisted-Python] Mixmaster Architecture
In-Reply-To: <12452-02919@sneakemail.com>
References: <12452-02919@sneakemail.com>
Message-ID: <20031120174706.16859.qmail@green.zadka.com>

On 20 Nov 2003, "Mark Evans" <2s7l3way02 at sneakemail.com> wrote:

> Here's an architecture question for Twisted Matrix gurus.
> I need to implement a "mixmaster" scheme, as follows:
> 
>                            |--> Remote client A
>         UDP            TCP |
> Server <---> Mixmaster <---|--> Remote client B
>                            |
>                            |--> Remote client C
>                            |
>                            ... (etc.)
> 

No this is the wrong picture. Here's a right picture:

           |<--|              |--> Remote client A
        UDP|   |          TCP |
Server <---|<--|Mixmaster<----|--> Remote client B
           |   |              |
           |<--|              |--> Remote client C
           |   |              |
                             ... (etc.)

so you'll want something like

class MixmasterProtocol(protocol.Protocol) # the TCP side

    def connectionMade(self):
        self.udp = p = protocol.ConnectedDatagramProtocol()
        p.datagramReceived = self.datagramReceived
        self.server = reactor.connectUDP('127.0.0.1', PORT, p)

    def connectionLost(self):
        self.server.stopListening()

    def dataReceived(self, data):
        pass # handle data from TCP client, maybe use self.udp.transport.write

    def datagramReceived(self, data):
        pass # handle data from server, maybe use self.transport.write
 
> The most important client type uses Telnet (raw).

Make up your mind, telnet or raw? a Line-based protocol?



From vlupien at drummonddesigns.com  Thu Nov 20 14:06:18 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 20 Nov 2003 16:06:18 -0500
Subject: [Twisted-Python] wvfactory
Message-ID: <000001c3afaa$24c8b3e0$687ba8c0@vicky>

I have a form in a web page and I need to fill it with many sql queries
but only the first time the page is rendered.  
The other times, I want to fill it with the data from request.args.
 
I decided to build a dictionnary that looks like the dictionnary of
request.args to be able to use only one function to validate and fill my
form.
My function that fill my forms need to receive the dictionnary, the
document(node that I need to change) and a signature (signature is a
list of the name and the type of each elements from the form that need
to be fill).
 
In my template, I defined a wmfactory in the tag <form> that return my
dictionnary.  Ive also define a wvfactory that call my function to fill
the form.
The problems is that wmfactory return a deferred so in wvfactory I have
to call my function to fill like this:  return
model.getData(request).addCallback(my function).  But I think that
return doesnt wait that the addCallback is done.
 
Is there something I can do to make my returns wait for the addCallback
to return the new node filled with the dictionnary of data.
 
Heres a part of my code:
 
#verify is the function that fill and verify my form
class handle:
    def __init__(self):
        pass
    
    def verify(self, dict, doc, signature):
        # dict is the dictionnary from the sql queries of the
request.args
        # doc is the node <form> and its child
        error = 0
        for item in signature:
            nodeList = domhelpers.locateNodes(doc, 'name', item[0])
            #INTEGER, FLOAT and STRING
            if item[1] == 'integer' or item[1] == 'float' or item[1] ==
'string':
                pass
            #CHECKBOX
            elif item[1] == 'checkbox':
                for node in nodeList:
                    # dict est None s'il n'est pas cochee
                    if dict.get(item[0]) != None and
str(node.getAttribute('value')) in dict.get(item[0]):
                        print 'checked'
                        node.setAttribute('checked', 'checked')
                        print node
                    else:
                        if item[2] == 'true':
                            error = 1
                            l = microdom.lmx(node)
                            l.span(style='color: red').text('donnees
obligatoires')
        return doc
 
# class that execute the queries needed
class SummaryEditDB:
    def __init__(self, dbpool):
        self.dbpool = dbpool
 
    def getSummary(self, plan_id):
        sql = "select * from plan where plan_id = '%s'" %plan_id
        return self.dbpool.runQueryDict(sql)
 
    def getCategoriesIdByPlanId(self, plan_id):
        sql = """select to_plan_category_id from plan_categories
                 where to_plan_id='%s' order by to_plan_category_id""" %
plan_id
        return self.dbpool.runQueryDict(sql)
 
 
class SummaryEditPage(pages.BasePage):
    templateFile = "summary_edit.html"
    
    def initialize(self, dbpool, *args):
        self.dbpool = dbpool
        self.db = SummaryEditDB(self.dbpool)
        self.signature = (('categories', 'checkbox', 'false', 'valeurs
non correctes'))
 
    def executeSQL(self, plan_id):
        def createSummaryDict(results, newDict):
            for item in results[0]:
                for elem in self.signature:
                    if item == elem[0]:
                        newDict[item] = results[0][item]
            return
self.db.getCategoriesIdByPlanId(plan_id).addCallback(createCategoriesDic
t, newDict)
 
        def createCategoriesDict(results, newDict):
            newDict['categories'] = []
            for item in results:
 
newDict['categories'].append(str(item.get('to_plan_category_id')))
            return newDict
 
        newDict = {}    
        return
self.db.getSummary(plan_id).addCallback(createSummaryDict, newDict)    #
first addCallback to fill the dictionnary
                 
 
    def setUp(self, request, *args):
            self.planData = self.executeSQL(plan_id) #this call the
function that return the dictionnary with the data (deferred)
   
    def wmfactory_planData(self, request):
        return self.planData          # Usually, when I return an SQL
queries, the model is not deferred but in this case, it is
    
    def wvfactory_fillFromSQL(self, request, node, model):
        def format(results):
            print results
            return handle().verify(results, node, self.signature) # the
function that fill the form (replace attributes in the node)
          
        return self.planData.addCallback(format)   # to be able to see
the results of self.planData, I need to use a addCallback to be able to
see the results
 
and to call the form filler.  But I seems that it doesnt wait to the
addCallback to be done
        
    def wchild_update(self, request):
        return self
        
Heres a part of my template file:
 
<form action="/summary/edit/update" method="post"
enctype="multipart/form-data" view="fillFromSQL" model="planData">
<table border="0" width="100%" cellspacing="1" cellpadding="2">
                        <tr>
                                    <td class="label" width="25%"
valign="top">
                                                &nbsp;Cat&eacute;gories 
                                    </td>
                                    <td class="area" width="75%">
                                                <input class="box"
type="checkbox" name="categories" value="1000001" />1 tage<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000002" />1/2 tages<br/> 
                                                <input class="box"
type="checkbox" name="categories" value="1000003" />2 tages<br/>
<input class="box" type="checkbox" name="categories" value="1000004"
/>Split-Level<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000005" />Chalet 4 saisons<br
/> 
                                                <input class="box"
type="checkbox" name="categories" value="1000006" />Bi-Gnration<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000007" />Semi-Dtach<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000008" />Townhouse<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000009" />Duplex<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000010" />Triplex<br /> 
                                                <input class="box"
type="checkbox" name="categories" value="1000011" />Appartement (4+)<br
/> 
                                    </td>
                        </tr>
            </table>
</form>
 
I really need help, so if someone wants to help me, it will be
appreciate.
Thx in advance
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031120/043719e1/attachment.html>

From lafou at wanadoo.fr  Thu Nov 20 14:31:12 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Thu, 20 Nov 2003 22:31:12 +0100
Subject: [Twisted-Python] Woven View factories: defered rendering?
In-Reply-To: <44F1BA9E-1B71-11D8-8EF4-000A95864FC4@twistedmatrix.com>
References: <20031120032041.GA11694@pasternak.w.lub.pl> <44F1BA9E-1B71-11D8-8EF4-000A95864FC4@twistedmatrix.com>
Message-ID: <200311202231.12700.lafou@wanadoo.fr>

Is there a place to find some doc for nevow ? 

I can't find docs on divmod site :(




From maoy at cis.upenn.edu  Thu Nov 20 15:21:18 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 20 Nov 2003 17:21:18 -0500 (EST)
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <000001c3afaa$24c8b3e0$687ba8c0@vicky>
Message-ID: <Pine.LNX.4.44.0311201717340.12438-100000@klondike.cis.upenn.edu>

Check this out..

Yun
---------
from twisted.internet.protocol import Protocol, ClientFactory
from sys import stdout

class Echo(Protocol):

    def dataReceived(self, data):
        self.transport.loseConnection()

    def connectionLost(self):
        self.transport.startReading()

class EchoClientFactory(ClientFactory):

    def buildProtocol(self, addr):
        print 'Connected.'
        return Echo()

from twisted.internet import reactor
reactor.connectTCP('158.130.68.33', 22, EchoClientFactory())
reactor.run()






From radix at twistedmatrix.com  Thu Nov 20 15:29:25 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 20 Nov 2003 17:29:25 -0500
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <Pine.LNX.4.44.0311201717340.12438-100000@klondike.cis.upenn.edu>
References: <000001c3afaa$24c8b3e0$687ba8c0@vicky> <Pine.LNX.4.44.0311201717340.12438-100000@klondike.cis.upenn.edu>
Message-ID: <20031120222925.GG20287@radii>

On Thu, Nov 20, 2003 at 05:21:18PM -0500, Yun Mao wrote:
> Check this out..

I know a much easier way!

"while 1: pass"


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From 2s7l3way02 at sneakemail.com  Thu Nov 20 15:29:47 2003
From: 2s7l3way02 at sneakemail.com (Mark Evans)
Date: 20 Nov 2003 22:29:47 -0000
Subject: [Twisted-Python] Re: Mixmaster Architecture
Message-ID: <10349-59812@sneakemail.com>


Thank you Moshe Zadka.  What you're saying is that TCP
connections can trigger ephemeral UDP pseudo-connections.

The server communicates over just one UDP port, and data
flow is bidirectional at all points in the chain.  I'm not
sure whether these facts affect the suggestion here.
The mixmaster opens its own assigned UDP port to receive
data from the server, as well as sending data to the
server over another UDP port.

> Make up your mind, telnet or raw? a Line-based protocol?

You're right, I should.  Here is the scoop.  For manual
device tests I'm using PuTTY in its "raw" mode.  That is
the origin of "raw."  Basically the telnet sessions are
line-based command/response activity.  The devices don't
utilize the full telnet protocol, just a small subset.

The terms "client" and "server" may be mixed up, from a
networking standpoint.  These are just conventions in the
legacy software, right or wrong.  The original authors
called the Java app a server, and the devices clients. 
However the devices supply information that the Java app
requests of them.  So the actual roles are reversed.

Normally, when talking to devices that know its protocol,
the system is very simple.  Here's how it works without a
mixmaster script.  The server initiates communications. 
The server broadcats a public query packet, and devices
respond with their names and technical features.  The
server constructs a list of known devices.  From there, the
server invokes various device capabilities.  When finished,
the server shuts down the devices.

Why the mixmaster?  Many devices offer identical
capabilites, but don't know the server's protocol.  The
mixmaster allows the server to use them.

My apologies for confusing terminology and my thanks for
your answers.

Mark



From maoy at cis.upenn.edu  Thu Nov 20 15:36:26 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 20 Nov 2003 17:36:26 -0500 (EST)
Subject: [Twisted-Python] How to let twisted fall into a deadloop with
 100% CPU usage
In-Reply-To: <20031120222925.GG20287@radii>
Message-ID: <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>

This is different. I believe twisted is responsible for the error report.  
It actually did, but for some reason it made itself fall into a dead loop.
I would like to call this bug, and encountered this when I play with
producer, consumer, etc. ( resumeProducing() is startReading!) I wish 
someone could fix this. Thanks.

Yun

On Thu, 20 Nov 2003, Christopher Armstrong wrote:

> On Thu, Nov 20, 2003 at 05:21:18PM -0500, Yun Mao wrote:
> > Check this out..
> 
> I know a much easier way!
> 
> "while 1: pass"
> 
> 
> 




From radix at twistedmatrix.com  Thu Nov 20 16:01:03 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 20 Nov 2003 18:01:03 -0500
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>
References: <20031120222925.GG20287@radii> <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>
Message-ID: <20031120230103.GH20287@radii>

On Thu, Nov 20, 2003 at 05:36:26PM -0500, Yun Mao wrote:
> This is different. I believe twisted is responsible for the error report.  
> It actually did, but for some reason it made itself fall into a dead loop.
> I would like to call this bug, and encountered this when I play with
> producer, consumer, etc. ( resumeProducing() is startReading!) I wish 
> someone could fix this. Thanks.

You didn't make it clear that you actually considered this a
bug. Please post it to http://twistedmatrix.com/bugs/ -- and please
include the errors that happen, etc, and any suggestions for
fixes. Thanks.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From exarkun at intarweb.us  Thu Nov 20 16:17:27 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 20 Nov 2003 18:17:27 -0500
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>
References: <20031120222925.GG20287@radii> <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu>
Message-ID: <20031120231727.GA24833@intarweb.us>

On Thu, Nov 20, 2003 at 05:36:26PM -0500, Yun Mao wrote:
> This is different. I believe twisted is responsible for the error report.  
> It actually did, but for some reason it made itself fall into a dead loop.
> I would like to call this bug, and encountered this when I play with
> producer, consumer, etc. ( resumeProducing() is startReading!) I wish 
> someone could fix this. Thanks.
> 

  startReading() is not a public API.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031120/679d9586/attachment.sig>

From exarkun at intarweb.us  Thu Nov 20 16:20:26 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 20 Nov 2003 18:20:26 -0500
Subject: [Twisted-Python] How to let twisted fall into a deadloop with 100% CPU usage
In-Reply-To: <20031120231727.GA24833@intarweb.us>
References: <20031120222925.GG20287@radii> <Pine.LNX.4.44.0311201730320.12438-100000@klondike.cis.upenn.edu> <20031120231727.GA24833@intarweb.us>
Message-ID: <20031120232026.GA24851@intarweb.us>

On Thu, Nov 20, 2003 at 06:17:27PM -0500, Jp Calderone wrote:
> On Thu, Nov 20, 2003 at 05:36:26PM -0500, Yun Mao wrote:
> > This is different. I believe twisted is responsible for the error report.  
> > It actually did, but for some reason it made itself fall into a dead loop.
> > I would like to call this bug, and encountered this when I play with
> > producer, consumer, etc. ( resumeProducing() is startReading!) I wish 
> > someone could fix this. Thanks.
> > 
> 
>   startReading() is not a public API.
> 

  Ahem.  I did not read very carefully. :)

>   Jp
> 


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031120/4c5ea969/attachment.sig>

From jsbenson at bensonsystems.com  Thu Nov 20 18:34:19 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Thu, 20 Nov 2003 17:34:19 -0800
Subject: [Twisted-Python] reactor/transport/protocol relationship?
Message-ID: <022801c3afcf$980aedd0$a90a500a@jsbwxp3>

>From the http://www.itamarst.org/writings/OSCON03/twisted_internet-18.html
slide, I gather that objects in twisted connect as follows:

(internet cloud) <---> transport <---> reactor <---> protocol

In the http://www.itamarst.org/writings/OSCON03/twisted_internet-19.html
diagram however, there is a different connectivity. What am I missing here?





From jsbenson at bensonsystems.com  Thu Nov 20 18:56:39 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Thu, 20 Nov 2003 17:56:39 -0800
Subject: [Twisted-Python] problem installing twisted on Windows 2000 Professional
Message-ID: <022d01c3afd2$b5263980$a90a500a@jsbwxp3>

I'm running Python 2.3 on Windows 2000 version 5.00.2195 Service Pack 4 and
having trouble running the Twisted-1.1.0.win32-py2.3.exe installation.

I downloaded the .exe to a local folder, got to the Install button, clicked
on it and while the "Saving uninstall information" message was displayed but
before the progress bar showed any progress, I got a Setup message box
saying "CreateFile failed; code 5. Access is denied"

Can anyone tell me what code 5 means?

I've got 112 MB left on the C: drive, I hope that's not the problem.





From andrew-twisted at puzzling.org  Thu Nov 20 19:05:36 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 21 Nov 2003 13:05:36 +1100
Subject: [Twisted-Python] problem installing twisted on Windows 2000 Professional
In-Reply-To: <022d01c3afd2$b5263980$a90a500a@jsbwxp3>
References: <022d01c3afd2$b5263980$a90a500a@jsbwxp3>
Message-ID: <20031121020536.GA22725@frobozz>

On Thu, Nov 20, 2003 at 05:56:39PM -0800, John Benson wrote:
> I'm running Python 2.3 on Windows 2000 version 5.00.2195 Service Pack 4 and
> having trouble running the Twisted-1.1.0.win32-py2.3.exe installation.
> 
> I downloaded the .exe to a local folder, got to the Install button, clicked
> on it and while the "Saving uninstall information" message was displayed but
> before the progress bar showed any progress, I got a Setup message box
> saying "CreateFile failed; code 5. Access is denied"
> 
> Can anyone tell me what code 5 means?
> 
> I've got 112 MB left on the C: drive, I hope that's not the problem.

I don't have a Windows installation to play with anymore, so this is just a
guess...

Mysterious installation errors are often due to installing Twisted and/or
Python as a non-Adminstrator.   Perhaps that's the problem here?

-Andrew.




From itamar at itamarst.org  Thu Nov 20 19:50:26 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 20 Nov 2003 21:50:26 -0500
Subject: [Twisted-Python] reactor/transport/protocol relationship?
In-Reply-To: <022801c3afcf$980aedd0$a90a500a@jsbwxp3>
References: <022801c3afcf$980aedd0$a90a500a@jsbwxp3>
Message-ID: <20031120215026.346fb824.itamar@itamarst.org>

On Thu, 20 Nov 2003 17:34:19 -0800
"John Benson" <jsbenson at bensonsystems.com> wrote:

> From the
> http://www.itamarst.org/writings/OSCON03/twisted_internet-18.html
> slide, I gather that objects in twisted connect as follows:
> 
> (internet cloud) <---> transport <---> reactor <---> protocol

> In the
> http://www.itamarst.org/writings/OSCON03/twisted_internet-19.html
> diagram however, there is a different connectivity. What am I missing
> here?

Both of them are slightly unaccurate. I'll update my slides for the next
time I give the tutorial to be consistent.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From arslan at transporeon.com  Fri Nov 21 04:47:17 2003
From: arslan at transporeon.com (Ahmet Arslan)
Date: Fri, 21 Nov 2003 12:47:17 +0100
Subject: [Twisted-Python] FTP Server
Message-ID: <003401c3b025$372620b0$1600a8c0@sunrise>

Hi,

I'm new to twisted and searching for exampels to create an FTP Server
with
Twisted.

Any help apreciated.

Thx.
Ahmet




From slyphon at twistedmatrix.com  Fri Nov 21 13:51:12 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Fri, 21 Nov 2003 15:51:12 -0500
Subject: [Twisted-Python] FTP Server
In-Reply-To: <003401c3b025$372620b0$1600a8c0@sunrise>
References: <003401c3b025$372620b0$1600a8c0@sunrise>
Message-ID: <3FBE7AC0.6020106@twistedmatrix.com>

Ahmet Arslan wrote:
> Hi,
> 
> I'm new to twisted and searching for exampels to create an FTP Server
> with
> Twisted.
> 
> Any help apreciated.
> 
> Thx.
> Ahmet
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

Well, you may be in luck. I've just re-written the ftp protocol for 
twisted. if you want an example of how to set one up, you can look (in 
the cvs version of twisted) at sandbox/slyphon/ftpsrv.tac.

You'll need to make some local edits (such as what you want your 
root/tld to be) but you can get a feel for how it can be done.

please note, the ftp server implementation is *very* *new*.








From corydodt at twistedmatrix.com  Sat Nov 22 18:19:11 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Sat, 22 Nov 2003 17:19:11 -0800
Subject: [Twisted-Python] tap2ntsvc future
Message-ID: <3FC00B0F.10703@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I've finished the initial work on tap2ntsvc.  This script does the
tedious work of creating an installer around your Twisted service.  A
quick howto:

1. Create a tap or tac file for your application, using the method you
normally use.  **Test with twistd to make sure that you can start the
app from the command line, _before_ you wrap a service around it.**

2. Acquire and install the prerequisites of tap2ntsvc.  It depends on
software outside of Twisted, specifically:
win32all @ http://starship.python.net/crew/mhammond/win32/Downloads.html
Innoconda @ http://twistedmatrix.com/~moonfallen/innoconda.html

3. Run tap2ntsvc from the command line.  (*This is not yet integrated
with the "Twisted Command Prompt" available on MSWindows with the
official Twisted installer, but it will be when the script becomes an
official part of Twisted.) Use --help to get the command line options.
To start with, all you need to provide is the name of your tap or tac file.
| python .../Twisted/sandbox/moonfallen/tap2ntsvc myapp.tac
This will build an installable package using Innoconda.

4. Install the package.  It will be in myappsvc/myapp-...-setup.exe.

5. Start the service; it will fail, but you'll find out what modules you
need to add.
| net start myapp
**It's ok if this doesn't work.**

6. Check the Application event log to find out what modules failed to
import; you will be re-running py2exe after you add the missing modules.

7. Either: (a) re-run tap2ntsvc with the -i option or (b) add your
modules to myappsvc/setup.cfg on the "includes=" line.  If you choose to
do the latter, read myappsvc/README.txt to find out how to recompile
just the parts you need.

8. Redo steps 3 through 7 until you no longer get ImportErrors in the
Application log.

9. Some applications need data files.  If you need data files in your
application, consult myappsvc/README.txt and edit myappsvc/myapp.fms.
myapp.fms uses a special command language to make adding data files as
intuitive as possible.  You can put files in c:\Program Files\myapp or
any subdirectory thereof, so make sure your application code can find
data files there.

When you're done, you should be able to 'net start myapp' successfully.
~   When you want to rebuild it in the future, just keep these files in
your version control:
~  myappsvc/do_inno_script.py
~           do_inno.py
~           setup.cfg
~           setup.py
~           myapp.fms

Caveats, bugs, TODO:
- - you must be able to start your application in py2exe.  Things most
likely to not work are finding important data files based on the value
of __file__ in some module.
- - if you install the same service multiple times without uninstalling it
in between installs, then start it, then uninstall it, it will crash on
uninstall.  Just be sure to uninstall it in between installs while
you're experimenting.
- - I want to make the module finder more foolproof, saving several of the
steps above.  This is a non-trivial problem, however.
- - Really, it needs a frontend.  And I hate Tk.  Can I put a Gtk app into
~ Twisted proper? :-)


The future:
I want to move tap2ntsvc out of sandbox and into main Twisted.  I want
people to read this email over and try it before I do so, in case there
are important concerns I need to address.  We need to give some thought
to what to do about the 2 significant dependencies.  Should this block
tap2ntsvc from being in Twisted proper?  Is there a policy for this sort
of thing?

C
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows XP)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQE/wAsO3A5SrXAiHQcRAhrbAJ4yqGWtbEZcuClQ7f2R8dTsgPt6BACfUfH+
w0KVf7umWJW/jJ5S8w/TQak=
=B3a8
-----END PGP SIGNATURE-----



From uwe at oss4u.com  Sat Nov 22 18:22:25 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Sat, 22 Nov 2003 17:22:25 -0800
Subject: [Twisted-Python] GUI Integration
In-Reply-To: <3FBB66C2.5000906@brainbot.com>
References: <3FBB5B27.5030809@brainbot.com> <200311191335.23097.lafou@wanadoo.fr> <3FBB66C2.5000906@brainbot.com>
Message-ID: <200311221722.25738.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


The wxsupport is broken, no matter which platform. That's why I invented the 
timer thing on ASPN. Wxsupport will fail the moment you open a modal dialog 
(or use a pulldown menu, which also is a modal). Probably there will never be 
a real reactor, well - unless someone with a lot of knowledge of both twisted 
and wxpython writes one. The problem is that wx - being platform independent 
uses the native event-loop, which behaves differently on windows, gtk or 
whatever. So a reactor would have to take care of that. The timer recipe 
works nicely though.

UC


On Wednesday 19 November 2003 04:49 am, Thorsten Henninger wrote:
> >Where did you see that wxPython is not supported for windows ? it works
> >perfect with windows ! Btw, you can find on this mailing list some
> > examples about using twisted in wx apps.
>
> this is what happens, if you run the wxdemo on windows 2000:
> C:\Dokumente und Einstellungen\henni\Desktop>wxdemo.py
> D:\Python23\lib\fcntl.py:7: DeprecationWarning: the FCNTL module is
> deprecated; please use fcntl
>   DeprecationWarning)
> D:\Python23\lib\site-packages\twisted\internet\wxsupport.py:69:
> UserWarning: Be advised wxsupport is not fully functional on Windows.
>   warnings.warn("Be advised wxsupport is not fully functional on Windows.")
> Traceback (most recent call last):
>   File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line
> 65, in ?
>     demo()
>   File "C:\Dokumente und Einstellungen\henni\Desktop\wxdemo.py", line
> 61, in demo
>     reactor.run()
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 121, in run
>     self.startRunning(installSignalHandlers=installSignalHandlers)
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 115, in startRunning
>     self._handleSignals()
>   File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line
> 87, in _handleSignals
>     signal.signal(signal.SIGINT, self.sigInt)
> SystemError: error return without exception set
> 13:45:14: Debug: c:\PROJECTS\wx\src\msw\app.cpp(439):
> 'UnregisterClass(canvas)' failed with error 0x00000584 (diese Klasse hat
> noch geffnete Fenster.).
>
> Of course, simulating the reactor via a wxTimer (as seen on ASPN) does
> work, but the latest twisted says, wxsupport is not fully supported on
> Windows.
>
> regards,
>
> Thorsten

- -- 
	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/wAvRjqGXBvRToM4RAnHAAJ4j1l1IhMVoZEF9CVrabf7QDaX5RQCfX7rB
1MZg9UNdRIARS3skbevb3tw=
=Y5Ca
-----END PGP SIGNATURE-----




From maoy at cis.upenn.edu  Sun Nov 23 14:42:07 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Sun, 23 Nov 2003 16:42:07 -0500 (EST)
Subject: [Twisted-Python] Application help
In-Reply-To: <200311221722.25738.uwe@oss4u.com>
Message-ID: <Pine.LNX.4.44.0311231639520.17466-100000@klondike.cis.upenn.edu>

What is the difference between

twisted.internet.app.Application
and
twisted.application.service.Application?

Thanks a lot.

Yun






From itamar at itamarst.org  Sun Nov 23 17:03:25 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 23 Nov 2003 19:03:25 -0500
Subject: [Twisted-Python] Application help
In-Reply-To: <Pine.LNX.4.44.0311231639520.17466-100000@klondike.cis.upenn.edu>
References: <200311221722.25738.uwe@oss4u.com>
	<Pine.LNX.4.44.0311231639520.17466-100000@klondike.cis.upenn.edu>
Message-ID: <20031123190325.42476266.itamar@itamarst.org>

On Sun, 23 Nov 2003 16:42:07 -0500 (EST)
Yun Mao <maoy at cis.upenn.edu> wrote:

> What is the difference between
> 
> twisted.internet.app.Application

This is old and deprecated. Don't use it. Use the other (i.e. what the
1.1 documentation covers.)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From rdrb at 123.cl  Sun Nov 23 19:29:45 2003
From: rdrb at 123.cl (RITA Y/O RODRIGO DIAZ Y/O BENENSON)
Date: Sun, 23 Nov 2003 23:29:45 -0300
Subject: [Twisted-Python] Unit test
Message-ID: <177600174ecd.174ecd177600@noborrar.co.cl>

Short question,
which is the adecuate way of doing unit test of a sequence of defered events ? one chained to the other.

If each deferred need a callback method, I have already more that thirty functiones defined, and each time I need more.

How to do it ?

defered = something

<the magic>

defered = the_next_thing # that need the previous defered to have been acomplished

etc...

I can imagine various tricks, but I supose there is a standart way. 

Thanks.
RodrigoB.




From exarkun at intarweb.us  Sun Nov 23 19:49:38 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 23 Nov 2003 21:49:38 -0500
Subject: [Twisted-Python] Unit test
In-Reply-To: <177600174ecd.174ecd177600@noborrar.co.cl>
References: <177600174ecd.174ecd177600@noborrar.co.cl>
Message-ID: <20031124024938.GA6291@intarweb.us>

On Sun, Nov 23, 2003 at 11:29:45PM -0300, RITA Y/O RODRIGO DIAZ Y/O BENENSON wrote:
> Short question,
> which is the adecuate way of doing unit test of a sequence of defered
> events ? one chained to the other.
> 
> If each deferred need a callback method, I have already more that thirty
> functiones defined, and each time I need more.
> 
> How to do it ?
> 
> defered = something
> 
> <the magic>
> 
> defered = the_next_thing # that need the previous defered to have been acomplished
> 
> etc...
> 
> I can imagine various tricks, but I supose there is a standart way. 

    from twisted.trial import unittest

    result = unittest.deferredResult(theDeferred)

  "deferredResult" iterates the reactor until the given deferred has a
result, then returns that result.

  See its sibling, deferredError, for testing of failure conditions.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031123/669d7d12/attachment.sig>

From cce at clarkevans.com  Mon Nov 24 01:52:13 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Mon, 24 Nov 2003 03:52:13 -0500
Subject: [Twisted-Python] web/client.py add parameter to get raw redirects
Message-ID: <20031124085213.GA46767@clarkevans.com>

Hello.  I'm working on some testing harness for my application
(in twisted, of course) and I found I needed to record when 
the app is expected to send back a redirect.  So, this needed
a few changes in client.py ; if this seems resonable, I can
commit it.  - Clark

...

--- client.py.bc	Sun Nov 23 23:45:10 2003
+++ client.py	Mon Nov 24 03:46:55 2003
@@ -28,10 +28,19 @@
 from twisted.web import error
 import urlparse, os, types
 
+from twisted.internet.error import ConnectionDone
+class PageRedirect(ConnectionDone):
+    """A request resulted in a redirect (followRedirect = 0) """
+    def __init__(self, status, location):
+        Exception.__init__(self, 
+          "%s redirection to: %s" % (status, location))
+        self.status = status
+        self.location = location
+
 class HTTPPageGetter(http.HTTPClient):
 
     quietLoss = 0
-    
+    followRedirect = 1 
     failed = 0
 
     def connectionMade(self):
@@ -79,6 +88,10 @@
         if not l:
             self.handleStatusDefault()
         url = l[0]
+        if not self.followRedirect:
+            self.handleStatusDefault()
+            self.factory.noPage(PageRedirect(self.status,url))
+            return
         scheme, host, port, path = _parse(url, defaultPort=self.transport.addr[1])
         self.factory.setURL(url)
 
@@ -173,7 +186,9 @@
     path = None
 
     def __init__(self, url, method='GET', postdata=None, headers=None,
-                 agent="Twisted PageGetter", timeout=0, cookies=None):
+                 agent="Twisted PageGetter", timeout=0, cookies=None,
+                 followRedirect=1):
+        self.protocol.followRedirect = followRedirect
         self.timeout = timeout
         self.agent = agent
 



From syver at inout.no  Mon Nov 24 01:56:17 2003
From: syver at inout.no (Syver Enstad)
Date: 24 Nov 2003 09:56:17 +0100
Subject: [Twisted-Python] Unit test
In-Reply-To: <20031124024938.GA6291@intarweb.us>
References: <177600174ecd.174ecd177600@noborrar.co.cl>
	<20031124024938.GA6291@intarweb.us>
Message-ID: <uy8u6uoum.fsf@inout.no>

Jp Calderone <exarkun at intarweb.us> writes:

>     from twisted.trial import unittest
> 
>     result = unittest.deferredResult(theDeferred)
> 
>   "deferredResult" iterates the reactor until the given deferred has a
> result, then returns that result.
> 
>   See its sibling, deferredError, for testing of failure conditions.

A little comment on unittest and the use of deferredResult. If you use
the optional timeout argument to deferredResult you have to be sure
that theDeferred's callback method has not been called before passing
it to deferredResult or you will get an error about pending calls when
twisted.trial cleans up after your test is run.





From justinjohnson at fastmail.fm  Mon Nov 24 08:23:25 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Mon, 24 Nov 2003 07:23:25 -0800
Subject: [Twisted-Python] Woven problems after upgrading to 1.1.1rc1
Message-ID: <20031124152325.9436B428FC@server1.messagingengine.com>

After upgrading to 1.1.1rc1, when I startup my tap which starts up a web
server and a flash conduit server for LivePage, as soon as I try to
access the page with my browser, I get a never ending stream of log
entries as seen below.

I've attached 2 files, tap.py and pages.py, which contain most of the
code involved.

Let me know if anything else is needed.


2003/11/24 09:18 CST [-] Log opened.
2003/11/24 09:18 CST [-] twistd 1.1.1rc1 (/usr/local/bin/python 2.3.0)
starting up
2003/11/24 09:18 CST [-] reactor class:
twisted.internet.default.SelectReactor
2003/11/24 09:18 CST [-] Loading ratcontrol.tap...
2003/11/24 09:18 CST [-] Loaded.
2003/11/24 09:18 CST [-] twisted.web.server.Site starting on 8888
2003/11/24 09:18 CST [-] Starting factory <twisted.web.server.Site
instance at 0x4065aa8c>
2003/11/24 09:18 CST [-]
twisted.web.woven.flashconduit.FlashConduitFactory starting on 4321
2003/11/24 09:18 CST [-] Starting factory
<twisted.web.woven.flashconduit.FlashConduitFactory instance at
0x4086a2ec>
2003/11/24 09:18 CST [-] twisted.spread.pb.PBServerFactory starting on
8787
2003/11/24 09:18 CST [-] Starting factory
<twisted.spread.pb.PBServerFactory instance at 0x40866fec>
2003/11/24 09:18 CST [-] set uid/gid 503/504
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:19 +0000] "GET /?__session_just_started__=1 HTTP/1.1"
302 422 "http://host/" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] session given the
will to live for 60 more seconds
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:19 +0000] "GET
/session-init/?__session_just_started__=%5B%271%27%5D HTTP/1.1" 302 516
"http://host/" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:19 +0000] "GET
/__session_key__c3726c12d656a8b7d9e478fea6d773a3/?__session_just_started__=%5B%22%5B%271%27%5D%22%5D
HTTP/1.1" 302 372 "http://host/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:19 +0000] "GET /?__session_just_started__=1 HTTP/1.1"
200 3642 "http://host/" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /WebConduit2_js HTTP/1.1" 302 348
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/?__session_just_started__=1" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /WebConduit2_js/ HTTP/1.1" 200 3642
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html HTTP/1.1" 302 340
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET
/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 352 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/ HTTP/1.1" 200 3642
"http://host:8888/?__session_just_started__=1" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /FlashConduit_swf/ HTTP/1.1" 200 3642
"-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/WebConduit2_js HTTP/1.1"
302 370 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE
6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/WebConduit2_js/ HTTP/1.1"
200 3642 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE
6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/input_html HTTP/1.1" 302
362 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET
/input_html/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 374 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/input_html/ HTTP/1.1" 200
3642 "http://host:8888/input_html/" "Mozilla/4.0 (compatible; MSIE 6.0;
Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/input_html/input_html/" "Mozilla/4.0 (compatible; MSIE
6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:20 +0000] "GET /input_html/input_html/WebConduit2_js
HTTP/1.1" 302 392 "http://host:8888/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /input_html/FlashConduit_swf/ HTTP/1.1"
200 3642 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/input_html/input_html/" "Mozilla/4.0 (compatible;
MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /input_html/input_html/WebConduit2_js/
HTTP/1.1" 200 3642 "http://host:8888/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /input_html/input_html/input_html
HTTP/1.1" 302 384 "http://host:8888/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 396 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/FlashConduit_swf/ HTTP/1.1" 200 3642 "-"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /input_html/input_html/input_html/
HTTP/1.1" 200 3642 "http://host:8888/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/WebConduit2_js HTTP/1.1" 302 414
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/WebConduit2_js/ HTTP/1.1" 200 3642
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/input_html HTTP/1.1" 302 406
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 418 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/input_html/ HTTP/1.1" 200 3642
"http://host:8888/input_html/input_html/input_html/" "Mozilla/4.0
(compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css HTTP/1.1" 302 358
"http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/input_html/WebConduit2_js HTTP/1.1" 302
436 "http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET
/input_html/input_html/input_html/FlashConduit_swf/ HTTP/1.1" 200 3642
"-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:21 +0000] "GET /templates/style.css/ HTTP/1.1" 200
3642 "http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:22 +0000] "GET
/input_html/input_html/input_html/input_html/WebConduit2_js/ HTTP/1.1"
200 3642 "http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,1,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:22 +0000] "GET
/input_html/input_html/input_html/input_html/input_html HTTP/1.1" 302 428
"http://host:8888/input_html/input_html/input_html/input_html/"
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:22 +0000] "GET
/input_html/input_html/input_html/input_html/FlashConduit_swf?twisted_session=c3726c12d656a8b7d9e478fea6d773a3
HTTP/1.1" 302 440 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT
5.0)"
2003/11/24 09:18 CST [HTTPChannel,0,xxx.xxx.xxx.xxx] xxx.xxx.xxx.xxx - -
[24/Nov/2003:15:18:22 +0000] "GET
/input_html/input_html/input_html/input_html/FlashConduit_swf/ HTTP/1.1"
200 3642 "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tap.py
Type: application/unknown
Size: 3250 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031124/6bf393e3/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pages.py
Type: application/unknown
Size: 8657 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031124/6bf393e3/attachment-0005.bin>

From obowah at yahoo.com  Mon Nov 24 14:59:27 2003
From: obowah at yahoo.com (rddda)
Date: Mon, 24 Nov 2003 13:59:27 -0800 (PST)
Subject: [Twisted-Python] trouble building Quotient
Message-ID: <20031124215927.81933.qmail@web10704.mail.yahoo.com>

trying to build Quotient-0.7.0 with Twisted-4.1.6 on OpenBSD with Berkeley DB (bsddb3-).
made change to atop/store.py to use bsddb3:
from bsddb3.db import *
 
i get this error:
...
    obj = self._loadItemByPath(ctxstore, *path)
  File "/usr/local/lib/python2.3/site-packages/atop/store.py", line 386, in _loadItemByPath
    raise KeyError(path)
KeyError: (0, 0)

this is the code at that point:
def _loadItemByPath(self, ctxstore, *path):
        """
        Retrieve an item given a sequence of integers.
        """
        stringKey = self._formatIDPath(path)
        print "str=%s"%stringKey;   #debugging...
        stringValue = self.db.get(stringKey, txn=context.get('txn'))
        if stringValue is None:
            raise KeyError(path)
   ...
 
so stringValue is 'None'.
stringKey is shown by the print to be: id00000000000000000000
 
any hints <where to look>/<what to try>?


---------------------------------
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031124/52ca7d6f/attachment.html>

From michal at pasternak.w.lub.pl  Mon Nov 24 15:04:59 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Mon, 24 Nov 2003 23:04:59 +0100
Subject: [Twisted-Python] Contributing to Twisted
Message-ID: <20031124220459.GA9641@pasternak.w.lub.pl>

Hi,

I'd like to setup buildbot on my machine and help Twisted building and
testing packages - as my contribution to Twisted project. I can install it
on a 700 MHz / 256 RAM / NetBSD-stable machine.

Do you accept such submissions? Who should I contact about it?

Take care,
-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From itamar at itamarst.org  Mon Nov 24 15:32:41 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 24 Nov 2003 17:32:41 -0500
Subject: [Twisted-Python] Contributing to Twisted
In-Reply-To: <20031124220459.GA9641@pasternak.w.lub.pl>
References: <20031124220459.GA9641@pasternak.w.lub.pl>
Message-ID: <20031124173241.0b94a352.itamar@itamarst.org>

On Mon, 24 Nov 2003 23:04:59 +0100
Michal Pasternak <michal at pasternak.w.lub.pl> wrote:

> I'd like to setup buildbot on my machine and help Twisted building and
> testing packages - as my contribution to Twisted project. I can
> install it on a 700 MHz / 256 RAM / NetBSD-stable machine.
> 
> Do you accept such submissions? Who should I contact about it?

Yes indeed, thank you! Brian Warner should get in touch with you, as
he's on the list.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From jsbenson at bensonsystems.com  Mon Nov 24 15:36:42 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Mon, 24 Nov 2003 14:36:42 -0800
Subject: [Twisted-Python] Informal poll, and Resolution of earlier post Fw: help please: trouble installing twisted python on Windows 2000 Pro, but not Windows XP Pro
Message-ID: <007701c3b2db$6f1fe8d0$f00a500a@jsbwxp3>

Hi, I'm answering my own post for the benefit if future newbies:

I was having an awful time installing twisted on a W2K Professional machine.
In desperation, I uninstalled all the Python things (Python 2.3 and
Pythonwin), reinstalled Python 2.3, installed Twisted, and then Pythonwin
and all the installations seemed to go OK. Plus I rebooted in between the
installations because I didn't have a rubber chicken handy to wave over the
computer.

Not much of a technical note, but there it is.

Informal poll: How many of you out there have ever indulged a taste for
totemic decoration and/or fetishistic rituals in connection with debugging?

----- Original Message ----- 
From: John Benson
To: twisted python
Sent: Wednesday, November 12, 2003 7:57 PM
Subject: help please: trouble installing twisted python on Windows 2000 Pro,
but not Windows XP Pro


Hi, I just installed twisted python on my Windows XP laptop which has Python
2.3.2.

I went to install it on Windows 2000 Professional version 5.00.2195 Service
Pack 4 running Python 2.3 and got the following dialog box diagnostic:
"Setup: CreateFile failed; code 5. Access is denied." I've been able to
install piles of stuff on this system before, so I figure I have the
required administrative privileges. I logon to a Windows domain, and my ID
is in the Administrators group of the domain. There is a separate
Administrator logon local to the machine which I haven't used, and probably
can't get the password for, since this is a managed PC within the domain.

Here are my questions:

1) What does the "code 5" failure mean?

2) What am I doing wrong?

3) Can I just move the twisted site-package folders over from my XP system
Python 2.3 folder to the corresponding Windows 2000 Pro folder? I'm mostly
interested in just importing the twisted modules and prototyping; I can do
without the icons and start menu entries.





From michal at pasternak.w.lub.pl  Mon Nov 24 15:53:35 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Mon, 24 Nov 2003 23:53:35 +0100
Subject: [Twisted-Python] trouble building Quotient
In-Reply-To: <20031124215927.81933.qmail@web10704.mail.yahoo.com>
References: <20031124215927.81933.qmail@web10704.mail.yahoo.com>
Message-ID: <20031124225335.GA9933@pasternak.w.lub.pl>

rddda [Mon, Nov 24, 2003 at 01:59:27PM -0800]:
> trying to build Quotient-0.7.0 with Twisted-4.1.6 on OpenBSD with Berkeley DB (bsddb3-).
[...]
> any hints <where to look>/<what to try>?

Yes. Install a recent Quotient (0.8.2) and try again.

If you have any other problems with Python on *BSD systems, e-mail me
directly.

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From michal at pasternak.w.lub.pl  Mon Nov 24 17:32:31 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Tue, 25 Nov 2003 01:32:31 +0100
Subject: [Twisted-Python] Informal poll, and Resolution of earlier post Fw: help please: trouble installing twisted python on Windows 2000 Pro, but not Windows XP Pro
In-Reply-To: <007701c3b2db$6f1fe8d0$f00a500a@jsbwxp3>
References: <007701c3b2db$6f1fe8d0$f00a500a@jsbwxp3>
Message-ID: <20031125003231.GB13442@pasternak.w.lub.pl>

John Benson [Mon, Nov 24, 2003 at 02:36:42PM -0800]:
> I was having an awful time installing twisted on a W2K Professional machine.

On my W2K laptop Twisted works without installation problems, since 1.0.7,
then upgraded many times.

> Not much of a technical note, but there it is.

You just described "in case of problems, format & reinstall" procedure,
that's known to fix 99.99% problems with Windows machines :)

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From obowah at yahoo.com  Mon Nov 24 21:25:14 2003
From: obowah at yahoo.com (rddda)
Date: Mon, 24 Nov 2003 20:25:14 -0800 (PST)
Subject: [Twisted-Python] trouble building Quotient
In-Reply-To: <20031124225335.GA9933@pasternak.w.lub.pl>
Message-ID: <20031125042514.82010.qmail@web10707.mail.yahoo.com>

ok. i got Quotient-0.8.2 and installed.
on 'mktap quotient ...'
i get 'Unknown command: quotient'
i then removed current 'quotient' from python site-packages dir and re-installed.
same error.
mktap itself runs and 'mktap --help' works.
 
TIA for help.
 
bob ackerman

Michal Pasternak <michal at pasternak.w.lub.pl> wrote:

rddda [Mon, Nov 24, 2003 at 01:59:27PM -0800]:

Yes. Install a recent Quotient (0.8.2) and try again.

If you have any other problems with Python on *BSD systems, e-mail me
directly.



---------------------------------
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031124/2a91295b/attachment.html>

From itamar at itamarst.org  Mon Nov 24 21:51:01 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 24 Nov 2003 23:51:01 -0500
Subject: [Twisted-Python] trouble building Quotient
In-Reply-To: <20031125042514.82010.qmail@web10707.mail.yahoo.com>
References: <20031124225335.GA9933@pasternak.w.lub.pl>
	<20031125042514.82010.qmail@web10707.mail.yahoo.com>
Message-ID: <20031124235101.2b4690f7.itamar@itamarst.org>

On Mon, 24 Nov 2003 20:25:14 -0800 (PST)
rddda <obowah at yahoo.com> wrote:

> ok. i got Quotient-0.8.2 and installed.
> on 'mktap quotient ...'
> i get 'Unknown command: quotient'
> i then removed current 'quotient' from python site-packages dir and
> re-installed. same error.
> mktap itself runs and 'mktap --help' works.

Make sure mktap is running with same version as python as quotient was
installed with (both should be the same python, and version 2.3).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From stuart.hungerford at anu.edu.au  Mon Nov 24 22:03:32 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Tue, 25 Nov 2003 16:03:32 +1100
Subject: [Twisted-Python] Why would getUser()/getPassword() return ""?
Message-ID: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>

Hi all,

Before I move onto learning about cred, guard and more
sophisticated authentication schemes, I'm trying to get a
simple example working with basic HTTP authentication.

I have a resource subclass who's render() method checks the
values of request.getUsername() and request.getPassword():


class request_create(twisted.web.resource.Resource):
     isLeaf = 1
     addSlash = 0

     def render(self, request):
         if (not request.getUser()) or (not request.getPassword()):
             request.setResponseCode(401, 'Authentication required')
             return twisted.web.error.ForbiddenResource().render(request)

         # do work and render HTML ...

The problem is that no matter what I try getUser() and getPassword()
both return the string "" and the web browser never prompts for a
username/password.

Is the above enough for the simplest possible HTTP authentication
approach in Twisted web or should I be setting HTTP headers before the
request.getUser()/request.getPassword() is performed?

Any advice much appreciated,





Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From jsbenson at bensonsystems.com  Mon Nov 24 22:28:49 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Mon, 24 Nov 2003 21:28:49 -0800
Subject: [Twisted-Python] how to use the twisted logging facility?
Message-ID: <005301c3b315$03170030$4a09500a@jsbwxp3>

I've looked at the log module documentation of twisted.python and more or
less guess that you can redirect the print statement to a log, and somehow
observe the stuff that is being logged in case you want to write it
somewhere else too. I was able to redirect the Python print statement to a
disk file, but am at a loss when it comes to properly configuring and
installing an observer. I want to observe the logging stream and throw it
out to a Tkinter text window.

Thanks in advance for any advice.





From itamar at itamarst.org  Mon Nov 24 23:00:35 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 25 Nov 2003 01:00:35 -0500
Subject: [Twisted-Python] Why would getUser()/getPassword() return ""?
In-Reply-To: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>
References: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>
Message-ID: <20031125010035.1bac193f.itamar@itamarst.org>

On Tue, 25 Nov 2003 16:03:32 +1100
Stuart Hungerford <stuart.hungerford at anu.edu.au> wrote:

> Before I move onto learning about cred, guard and more
> sophisticated authentication schemes, I'm trying to get a
> simple example working with basic HTTP authentication.

See http://twistedmatrix.com/users/roundup.twistd/twisted/issue393

But you should also read the appropriate RFC. You need to return an
Unauthorized status code (401) and appropriate header if you got no
credentials in order to request browser to send it on next request.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From radix at twistedmatrix.com  Mon Nov 24 23:14:19 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 25 Nov 2003 01:14:19 -0500
Subject: [Twisted-Python] trouble building Quotient
In-Reply-To: <20031124235101.2b4690f7.itamar@itamarst.org>
References: <20031124225335.GA9933@pasternak.w.lub.pl> <20031125042514.82010.qmail@web10707.mail.yahoo.com> <20031124235101.2b4690f7.itamar@itamarst.org>
Message-ID: <20031125061419.GA614@radii>

This is the mailing list for Twisted, not Quotient; The list for
discussion of Quotient and other Divmod technologies is here:

http://divmod.org/users/mailman.twistd/listinfo/divmod-dev


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From michal at pasternak.w.lub.pl  Mon Nov 24 23:15:19 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Tue, 25 Nov 2003 07:15:19 +0100
Subject: [Twisted-Python] Why would getUser()/getPassword() return ""?
In-Reply-To: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>
References: <6.0.0.22.0.20031125155558.01e4d8d0@anusf.anu.edu.au>
Message-ID: <20031125061519.GB15436@pasternak.w.lub.pl>

Stuart Hungerford [Tue, Nov 25, 2003 at 04:03:32PM +1100]:
> Before I move onto learning about cred, guard and more
> sophisticated authentication schemes, I'm trying to get a
> simple example working with basic HTTP authentication.

Checkout Twisted CVS, then Twisted/sandbox/tv/simplyguarded/

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From syver at inout.no  Tue Nov 25 05:10:09 2003
From: syver at inout.no (Syver Enstad)
Date: 25 Nov 2003 13:10:09 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
Message-ID: <uznektzry.fsf@inout.no>

I have a serious problem with some woven applications where deferreds
and their results returned from wmfactory_ methods are not garbage
collected. They just stack up in gc.garbage. The python documentation
states that the contents of gc.garbage are objects that are part of a
cycle can't be collected because they have a __del__ method.

Any help on this issue would be really appreciated.





From andrew-twisted at puzzling.org  Tue Nov 25 06:13:38 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 26 Nov 2003 00:13:38 +1100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <uznektzry.fsf@inout.no>
References: <uznektzry.fsf@inout.no>
Message-ID: <20031125131338.GB6016@frobozz>

On Tue, Nov 25, 2003 at 01:10:09PM +0100, Syver Enstad wrote:
> 
> I have a serious problem with some woven applications where deferreds
> and their results returned from wmfactory_ methods are not garbage
> collected. They just stack up in gc.garbage. The python documentation
> states that the contents of gc.garbage are objects that are part of a
> cycle can't be collected because they have a __del__ method.
> 
> Any help on this issue would be really appreciated.

Deferreds have a __del__ method, used to log unhandled errors, which has
often proved to be a valuable debugging aid (people often forget to
.addErrback(log.err)).

Unfortunately, this means that Deferreds in reference cycles can't be
automatically garbage collected.  Can you boil this down to a minimal test
case?  This sounds like the probable cause of a memory leak some users have
reported with Twisted Web.

The trick will be to figure out what the reference cycle is, and breaking
it.  It may help to do:
    twisted.internet.defer.Deferred.debug = True
and then inspect the .creator attribute of the Deferreds the end up in
gc.garbage.  You could also try manually poking around with gc.get_referrers
on those Deferreds.

If we can find a good enough test case, we might be able to write a unit
test to trigger it and then check gc.garbage, so that we can include it in
the test suite and stop it from happening again.

I'm very keen to find out what's causing this -- let me know if there's
anything I can help with.

-Andrew.





From andrew at puzzling.org  Tue Nov 25 06:19:19 2003
From: andrew at puzzling.org (Andrew Bennetts)
Date: Wed, 26 Nov 2003 00:19:19 +1100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125131338.GB6016@frobozz>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
Message-ID: <20031125131919.GC6016@frobozz>

On Wed, Nov 26, 2003 at 12:13:38AM +1100, Andrew Bennetts wrote:
> 
> If we can find a good enough test case, we might be able to write a unit
> test to trigger it and then check gc.garbage, so that we can include it in
> the test suite and stop it from happening again.

Thinking about this further, I just wrote the following hack for trial:

bash-2.05b$ cvs diff -u twisted/scripts/trial.py
Index: twisted/scripts/trial.py
===================================================================
RCS file: /cvs/Twisted/twisted/scripts/trial.py,v
retrieving revision 1.51
diff -u -r1.51 trial.py
--- twisted/scripts/trial.py    17 Oct 2003 21:48:16 -0000      1.51
+++ twisted/scripts/trial.py    25 Nov 2003 13:17:02 -0000
@@ -328,6 +328,11 @@
                                suite.run, reporter, config['random'])
         else:
             suite.run(reporter, config['random'])
+    import gc
+    gc.collect()
+    if gc.garbage:
+        print "GARBAGE: %d objects" % len(gc.garbage)
+        print "GARBAGE: " + repr(gc.garbage)
     sys.exit(not reporter.allPassed())
 
 if __name__ == '__main__':


I've only just started playing with this, but none of the web or woven tests
show anything.  test_pb seems to leak a whole bunch of stuff, though...

-Andrew.




From andrew-twisted at puzzling.org  Tue Nov 25 06:33:52 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 26 Nov 2003 00:33:52 +1100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125131338.GB6016@frobozz>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
Message-ID: <20031125133352.GE6016@frobozz>

[list admins: I originally posted this from the wrong address.  Please delete
 the dupe from the moderation queue.]

On Wed, Nov 26, 2003 at 12:13:38AM +1100, Andrew Bennetts wrote:
> 
> If we can find a good enough test case, we might be able to write a unit
> test to trigger it and then check gc.garbage, so that we can include it in
> the test suite and stop it from happening again.

Thinking about this further, I just wrote the following hack for trial:

bash-2.05b$ cvs diff -u twisted/scripts/trial.py
Index: twisted/scripts/trial.py
===================================================================
RCS file: /cvs/Twisted/twisted/scripts/trial.py,v
retrieving revision 1.51
diff -u -r1.51 trial.py
--- twisted/scripts/trial.py    17 Oct 2003 21:48:16 -0000      1.51
+++ twisted/scripts/trial.py    25 Nov 2003 13:17:02 -0000
@@ -328,6 +328,11 @@
                                suite.run, reporter, config['random'])
         else:
             suite.run(reporter, config['random'])
+    import gc
+    gc.collect()
+    if gc.garbage:
+        print "GARBAGE: %d objects" % len(gc.garbage)
+        print "GARBAGE: " + repr(gc.garbage)
     sys.exit(not reporter.allPassed())

 if __name__ == '__main__':


I've only just started playing with this, but none of the web or woven tests
show anything.  test_pb seems to leak a whole bunch of stuff, though...

-Andrew.




From syver at inout.no  Tue Nov 25 06:34:28 2003
From: syver at inout.no (Syver Enstad)
Date: 25 Nov 2003 14:34:28 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <uznektzry.fsf@inout.no>
References: <uznektzry.fsf@inout.no>
Message-ID: <usmkctvvf.fsf@inout.no>

Syver Enstad <syver at inout.no> writes:

> I have a serious problem with some woven applications where deferreds
> and their results returned from wmfactory_ methods are not garbage
> collected. They just stack up in gc.garbage. The python documentation
> states that the contents of gc.garbage are objects that are part of a
> cycle can't be collected because they have a __del__ method.

It seems that it is only when the deferreds are instance variables in
the Page that they end up in gc.garbage. It might be related that an
empty Page class with a __del__ method also end up in gc.garbage.





From syver at inout.no  Tue Nov 25 06:56:26 2003
From: syver at inout.no (Syver Enstad)
Date: 25 Nov 2003 14:56:26 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125131919.GC6016@frobozz>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
	<20031125131919.GC6016@frobozz>
Message-ID: <uhe0stuut.fsf@inout.no>

Andrew Bennetts <andrew at puzzling.org> writes:

> On Wed, Nov 26, 2003 at 12:13:38AM +1100, Andrew Bennetts wrote:
> > 
> > If we can find a good enough test case, we might be able to write a unit
> > test to trigger it and then check gc.garbage, so that we can include it in
> > the test suite and stop it from happening again.
> 
> Thinking about this further, I just wrote the following hack for trial:
> 
> bash-2.05b$ cvs diff -u twisted/scripts/trial.py
> Index: twisted/scripts/trial.py
> ===================================================================
> RCS file: /cvs/Twisted/twisted/scripts/trial.py,v
> retrieving revision 1.51
> diff -u -r1.51 trial.py
> --- twisted/scripts/trial.py    17 Oct 2003 21:48:16 -0000      1.51
> +++ twisted/scripts/trial.py    25 Nov 2003 13:17:02 -0000
> @@ -328,6 +328,11 @@
>                                 suite.run, reporter, config['random'])
>          else:
>              suite.run(reporter, config['random'])
> +    import gc
> +    gc.collect()
> +    if gc.garbage:
> +        print "GARBAGE: %d objects" % len(gc.garbage)
> +        print "GARBAGE: " + repr(gc.garbage)
>      sys.exit(not reporter.allPassed())
>  
>  if __name__ == '__main__':
> 
> 
> I've only just started playing with this, but none of the web or woven tests
> show anything.  test_pb seems to leak a whole bunch of stuff, though...

The deferreds that are leaking are coming from pb (aReferenceable.callRemote).

I think that a minimal test case to show the problem would be: (I'll test this later, I have to go in five minutes time).

Pseudo code:
class Page:
   def initialize(self, ...):
       self._deferred = defer.succeed([1, 2, 3])

   def wmfactory_oneTwoThree(self, request):
       return self._deferred


My guess is that self._deferred will end up in gc.garbage.

I will test this later.






From exarkun at intarweb.us  Tue Nov 25 07:12:24 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 25 Nov 2003 09:12:24 -0500
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <uhe0stuut.fsf@inout.no>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz> <20031125131919.GC6016@frobozz> <uhe0stuut.fsf@inout.no>
Message-ID: <20031125141224.GA11518@intarweb.us>

On Tue, Nov 25, 2003 at 02:56:26PM +0100, Syver Enstad wrote:
> [snip]
> 
> The deferreds that are leaking are coming from pb (aReferenceable.callRemote).
> 
> I think that a minimal test case to show the problem would be: (I'll test this later, I have to go in five minutes time).
> 
> Pseudo code:
> class Page:
>    def initialize(self, ...):
>        self._deferred = defer.succeed([1, 2, 3])
> 
>    def wmfactory_oneTwoThree(self, request):
>        return self._deferred
> 

  Presumably at some later point you will have a line like
"self._deferred.callback(value)".  Immediately after this (actually, before
is preferable, how is left as an exercise for the reader), you should
"self._deferred = None".  The cycle will be broken and the garbage will be
collectable.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031125/6d63e847/attachment.sig>

From cosoria at sentai.com  Tue Nov 25 08:54:05 2003
From: cosoria at sentai.com (Carlos A. Osoria)
Date: Tue, 25 Nov 2003 08:54:05 -0700
Subject: [Twisted-Python] New to Twisted trying to find telnet client sample code
In-Reply-To: <20031125141224.GA11518@intarweb.us>
Message-ID: <EBEJLPFDAPGBHHHKOENOGEBLCAAA.cosoria@sentai.com>

Hi there !!

I'm new to twisted, I jump into cuz it looks that is gonna make my work lot
lot easier, I have to write a telnet client code to connect to systems. I
have been looking for telnet client samples out there but no luck so far,
can anyone point me in the right direction ???  :))

Any help will be well appreciated.





From henni at brainbot.com  Tue Nov 25 09:18:27 2003
From: henni at brainbot.com (Thorsten Henninger)
Date: Tue, 25 Nov 2003 17:18:27 +0100
Subject: [Twisted-Python] Twisted Signal Handler and wxPython
Message-ID: <3FC380D3.2080202@brainbot.com>

Hi,

I had a problem using wxPython together with twisted.
The following code shows, that one has to start the reactor with the 
flag "installSignalHandlers=0", otherwise an SystemError occures.
How does this affect my Twsited-Application?

regards,

Thorsten

import traceback
from wxPython.wx import *
from twisted.internet import  reactor


class MyApp(wxApp):
    def OnInit(self):

        # Twisted Reactor Code
        print "reator start running"
        #reactor.startRunning(installSignalHandlers=0)
        #reactor.startRunning(installSignalHandlers=1)
        timerid = wxNewId()
        EVT_TIMER(self,timerid,self.OnTimer)
        self.timer=wxTimer(self,timerid)
        self.timer.Start(100,True)
        # End Twisted Code
    # Do whatever you need to do here
       
        return True

    def OnTimer(self,event):
        reactor.runUntilCurrent()
        reactor.doIteration(0)


def main():
    """
    """
   
    try:
        app = MyApp(0)
        print "CALLING MAIN LOOP"
        app.MainLoop()
        print "MAIN LOOP DONE"
    except SystemExit, err:
        print err
    except:
        exc_info = sys.exc_info()
        print "--------------------- CAUGHT EXCECPTION:", exc_info
        traceback.print_exc(file=sys.stdout)
       

if __name__ == "__main__":
    try:
        main()
    finally:
        print "MAIN THREAD HAS EXITED"


The following error occures on Windows 2000, Python 2.3.2 and wxPython 
2.4.2:

D:\Python23\lib\fcntl.py:7: DeprecationWarning: the FCNTL module is 
deprecated; please use fcntl
  DeprecationWarning)
reator start running
--------------------- CAUGHT EXCECPTION: (<class exceptions.SystemError 
at 0x007780F0>, <exceptions.SystemError instance at 0x011775D0>, 
<traceback object at 0x011775F8>)
Traceback (most recent call last):
  File "E:\bbot\nextbot\gui\wxpython\application.py", line 41, in main
    app = MyApp(0)
  File "D:\Python23\lib\site-packages\wxPython\wx.py", line 1945, in 
__init__
    _wxStart(self.OnInit)
  File "E:\bbot\nextbot\gui\wxpython\application.py", line 18, in OnInit
    reactor.startRunning(installSignalHandlers=1)
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
115, in startRunning
    self._handleSignals()
  File "D:\Python23\Lib\site-packages\twisted\internet\default.py", line 
87, in _handleSignals
    signal.signal(signal.SIGINT, self.sigInt)
SystemError: error return without exception set

-- 
brainbot technologies AG 
boppstrasse . 64 . 55118 mainz . germany
fon +49 6131 211639-1 . fax +49 6131 211639-2
http://brainbot.com/  mailto:henni at brainbot.com





From itamar at itamarst.org  Tue Nov 25 09:42:50 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 25 Nov 2003 11:42:50 -0500
Subject: [Twisted-Python] Twisted Signal Handler and wxPython
In-Reply-To: <3FC380D3.2080202@brainbot.com>
References: <3FC380D3.2080202@brainbot.com>
Message-ID: <20031125114250.1257734f.itamar@itamarst.org>

On Tue, 25 Nov 2003 17:18:27 +0100
Thorsten Henninger <henni at brainbot.com> wrote:

> I had a problem using wxPython together with twisted.
> The following code shows, that one has to start the reactor with the 
> flag "installSignalHandlers=0", otherwise an SystemError occures.
> How does this affect my Twsited-Application?

C-c and friends won't work, that's it. And reactor.spawnProcess may have
issues. This is a bug in wxPython which may have been fixed in newer
versions (and didn't occur in older versions).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From henni at brainbot.com  Tue Nov 25 10:13:46 2003
From: henni at brainbot.com (Thorsten Henninger)
Date: Tue, 25 Nov 2003 18:13:46 +0100
Subject: [Twisted-Python] Twisted Signal Handler and wxPython
In-Reply-To: <20031125114250.1257734f.itamar@itamarst.org>
References: <3FC380D3.2080202@brainbot.com> <20031125114250.1257734f.itamar@itamarst.org>
Message-ID: <3FC38DCA.1010803@brainbot.com>

Hi all,

this bug in wxPython has been fixed since wxPython 2.4.2.4

thanks,

Thorsten


Itamar Shtull-Trauring wrote:

>On Tue, 25 Nov 2003 17:18:27 +0100
>Thorsten Henninger <henni at brainbot.com> wrote:
>
>  
>
>>I had a problem using wxPython together with twisted.
>>The following code shows, that one has to start the reactor with the 
>>flag "installSignalHandlers=0", otherwise an SystemError occures.
>>How does this affect my Twsited-Application?
>>    
>>
>
>C-c and friends won't work, that's it. And reactor.spawnProcess may have
>issues. This is a bug in wxPython which may have been fixed in newer
>versions (and didn't occur in older versions).
>
>  
>


-- 
brainbot technologies AG 
boppstrasse . 64 . 55118 mainz . germany
fon +49 6131 211639-1 . fax +49 6131 211639-2
http://brainbot.com/  mailto:henni at brainbot.com





From syver-en at online.no  Tue Nov 25 13:28:08 2003
From: syver-en at online.no (Syver Enstad)
Date: 25 Nov 2003 21:28:08 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125141224.GA11518@intarweb.us>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
	<20031125131919.GC6016@frobozz> <uhe0stuut.fsf@inout.no>
	<20031125141224.GA11518@intarweb.us>
Message-ID: <ullq4tcpz.fsf@online.no>

Jp Calderone <exarkun at intarweb.us> writes:

>   Presumably at some later point you will have a line like
> "self._deferred.callback(value)".  

No I just return the deferred to woven (with defer.succeed the
callback is already called). 

> Immediately after this (actually, before is preferable, how is left
> as an exercise for the reader), you should "self._deferred = None".
> The cycle will be broken and the garbage will be collectable.

I think I'll have to override Page.pageRenderComplete and set it to
None there.


-- 

Syver Enstad




From syver-en at online.no  Tue Nov 25 13:52:43 2003
From: syver-en at online.no (Syver Enstad)
Date: 25 Nov 2003 21:52:43 +0100
Subject: [Twisted-Python] Woven application, objects not collected.
In-Reply-To: <20031125141224.GA11518@intarweb.us>
References: <uznektzry.fsf@inout.no> <20031125131338.GB6016@frobozz>
	<20031125131919.GC6016@frobozz> <uhe0stuut.fsf@inout.no>
	<20031125141224.GA11518@intarweb.us>
Message-ID: <uu14srx0k.fsf@online.no>

Jp Calderone <exarkun at intarweb.us> writes:

> On Tue, Nov 25, 2003 at 02:56:26PM +0100, Syver Enstad wrote:
> > Pseudo code:
> > class Page:
> >    def initialize(self, ...):
> >        self._deferred = defer.succeed([1, 2, 3])
> > 
> >    def wmfactory_oneTwoThree(self, request):
> >        return self._deferred
> > 
> 

Hi Jp. It seems that changing the wmfactory_method to do:

        def wmfactory_oneTwoThree(self, request):
            deferred = defer.Deferred()
            self._deferred.chainDeferred(deferred)
            return deferred

Does the trick.


>   Presumably at some later point you will have a line like
> "self._deferred.callback(value)".  Immediately after this (actually,
> before
> 
> is preferable, how is left as an exercise for the reader), you
> should "self._deferred = None".  The cycle will be broken and the
> garbage will be collectable.

-- 

Syver Enstad




From jjanecek at telusplanet.net  Tue Nov 25 20:04:00 2003
From: jjanecek at telusplanet.net (jjanecek at telusplanet.net)
Date: Tue, 25 Nov 2003 19:04:00 -0800
Subject: [Twisted-Python] Possible bug in from twisted.internet.app import Application ?
Message-ID: <1069815840.3fc4182061cb1@webmail.telus.net>

I am running freebsd with python 2.2.2 and twisted 1.10

the same code worked fine on another server which is identical
except it is running twisted 1.07 

anyways

from twisted.internet.app import Application
from pyRtpRelay import TRelayService

print "Relay Going Up"
application = Application('pyRtpRelay')
RelayService=TRelayService(application)
RelayService.Start()

Inside my object TRelayService when I call

application.ListenUDP(XXXXXXXX) it will not listen on the required UDP ports and
returns None.

As a temporary hack I then when
       from twisted.internet import reactor
       reactor.ListenUDP(XXXXXX)

and it worked fine

Thanx John







From itamar at itamarst.org  Tue Nov 25 20:44:41 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 25 Nov 2003 22:44:41 -0500
Subject: [Twisted-Python] Possible bug in from twisted.internet.app
 import Application ?
In-Reply-To: <1069815840.3fc4182061cb1@webmail.telus.net>
References: <1069815840.3fc4182061cb1@webmail.telus.net>
Message-ID: <20031125224441.076adc27.itamar@itamarst.org>

On Tue, 25 Nov 2003 19:04:00 -0800
jjanecek at telusplanet.net wrote:

> I am running freebsd with python 2.2.2 and twisted 1.10

> application.ListenUDP(XXXXXXXX) it will not listen on the required UDP
> ports and returns None.

This is for a reason, too complicated to get into (in 1.0.7 it would
sometimes return None as well, in some cases). You should upgrade your
code to use twisted.application instead of twisted.internet.app, which
is deprecated.

Also, sounds like you want to be doing reactor.listenUDP.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From slyphon at twistedmatrix.com  Wed Nov 26 01:10:11 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Wed, 26 Nov 2003 03:10:11 -0500
Subject: [Twisted-Python] protocol factory interfaces?? (FTP)
Message-ID: <1069834211.24112.3.camel@willie-the-pimp.embassynetworks.com>

Is it possible (or even useful) to have a protocol which expects the
factory which builds it to have a specific interface? (as the protocol
has a .factory attribute and therefore can access methods and attributes
on it's factory)

or must all twisted.protocols be able to work with
internet.protocol.Factory() off-the-shelf?






From radix at twistedmatrix.com  Wed Nov 26 01:59:02 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 26 Nov 2003 03:59:02 -0500
Subject: [Twisted-Python] protocol factory interfaces?? (FTP)
In-Reply-To: <1069834211.24112.3.camel@willie-the-pimp.embassynetworks.com>
References: <1069834211.24112.3.camel@willie-the-pimp.embassynetworks.com>
Message-ID: <20031126085902.GC2548@radii>

On Wed, Nov 26, 2003 at 03:10:11AM -0500, Jonathan Simms wrote:
> Is it possible (or even useful) to have a protocol which expects the
> factory which builds it to have a specific interface? (as the protocol
> has a .factory attribute and therefore can access methods and attributes
> on it's factory)
> 
> or must all twisted.protocols be able to work with
> internet.protocol.Factory() off-the-shelf?

Nope, it's perfectly fine to have a factory tightly bound to the
protocol. The reason that they're separate objects isn't for
separation of knowledge, but for having a 1-N relationship (N protocol
instances (i.e., connections) per factory).

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From phil at bubblehouse.org  Wed Nov 26 12:49:46 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 26 Nov 2003 14:49:46 -0500 (EST)
Subject: [Twisted-Python] plugin vs. dropin
Message-ID: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>

i was going through the docs, and i found the two classes in
twisted/python/plugin.py, and i was wondering what the difference is
between the two.

i'd like to be able to make a sort of plugin that when the plugin package
is in the path, it interacts in arbitrary ways with my main application.
however, i don't think i'd want it to appear in mktap, as that doesn't
really make sense in this situation.....or does it?

-phil



From exarkun at intarweb.us  Wed Nov 26 13:24:08 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 26 Nov 2003 15:24:08 -0500
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
Message-ID: <20031126202408.GA16267@intarweb.us>

On Wed, Nov 26, 2003 at 02:49:46PM -0500, Phil Christensen wrote:
> i was going through the docs, and i found the two classes in
> twisted/python/plugin.py, and i was wondering what the difference is
> between the two.
> 
> i'd like to be able to make a sort of plugin that when the plugin package
> is in the path, it interacts in arbitrary ways with my main application.
> however, i don't think i'd want it to appear in mktap, as that doesn't
> really make sense in this situation.....or does it?
> 


  a DropIn is an abstraction for an entire plugins.tml file.

  a PlugIn is a single entity, typically corresponding to a register() call
in a plugins.tml file.

  mktap only shows plugins of type "tap" (because that is the only kind of
plugin it knows how to use!), so if you make your plugins of a different
type, they won't show up there.


  Jp


> -phil
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031126/85157397/attachment.sig>

From itamar at itamarst.org  Wed Nov 26 13:24:50 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 26 Nov 2003 15:24:50 -0500
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
Message-ID: <20031126152450.03865bec.itamar@itamarst.org>

On Wed, 26 Nov 2003 14:49:46 -0500 (EST)
"Phil Christensen" <phil at bubblehouse.org> wrote:

> i'd like to be able to make a sort of plugin that when the plugin
> package is in the path, it interacts in arbitrary ways with my main
> application. however, i don't think i'd want it to appear in mktap, as
> that doesn't really make sense in this situation.....or does it?

You can have different types of plugins. For example, mktap uses one
kind of plugin, but twisted.lore uses another. IIRC there's a type
keyword arg that indicates what kind of plugin it is.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From phil at bubblehouse.org  Wed Nov 26 14:08:14 2003
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 26 Nov 2003 16:08:14 -0500 (EST)
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <20031126202408.GA16267@intarweb.us>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>
    <20031126202408.GA16267@intarweb.us>
Message-ID: <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>

I've figured out that part. I created a plugin directory, and i set the
type to "myPluginType"...now how do i access my plugin from within the
app?

i've got this in my plugins.tml file:

register ("My plugin package",
		"core.plugin",
		description = """
		Provides functionality to my app.
		""",
		type ="myPluginType")

i did the following in the interpreter:

>>> from twisted.python import plugin
>>> plugin.getPlugIns("myPluginType")
[<Plugin 'My plugin package' core.plugin>]

so i guess my question is, what to i do with this plugin object? i see it
has a property named "module", which is the string i gave it of
"core.plugin". this file doesn't exist yet since i don't know what to put
in it.

i guess i just need a little more guidance. i'm looking through the code
too, but i'm not sure what calls what...

thanks for any help,

-phil

> On Wed, Nov 26, 2003 at 02:49:46PM -0500, Phil Christensen wrote:
[snip snip snip]
>> i'd like to be able to make a sort of plugin that when the plugin
>> package
>> is in the path, it interacts in arbitrary ways with my main application.
>> however, i don't think i'd want it to appear in mktap, as that doesn't
>> really make sense in this situation.....or does it?
>>
>
>
>   a DropIn is an abstraction for an entire plugins.tml file.
>
>   a PlugIn is a single entity, typically corresponding to a register()
> call
> in a plugins.tml file.
>
>   mktap only shows plugins of type "tap" (because that is the only kind of
> plugin it knows how to use!), so if you make your plugins of a different
> type, they won't show up there.




From exarkun at intarweb.us  Wed Nov 26 17:27:30 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 26 Nov 2003 19:27:30 -0500
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2> <20031126202408.GA16267@intarweb.us> <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>
Message-ID: <20031127002730.GA17062@intarweb.us>

On Wed, Nov 26, 2003 at 04:08:14PM -0500, Phil Christensen wrote:
> I've figured out that part. I created a plugin directory, and i set the
> type to "myPluginType"...now how do i access my plugin from within the
> app?
> 
> i've got this in my plugins.tml file:
> 
> register ("My plugin package",
> 		"core.plugin",
> 		description = """
> 		Provides functionality to my app.
> 		""",
> 		type ="myPluginType")
> 
> i did the following in the interpreter:
> 
> >>> from twisted.python import plugin
> >>> plugin.getPlugIns("myPluginType")
> [<Plugin 'My plugin package' core.plugin>]

  Call .load() on it, and do something with the result.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031126/76053f96/attachment.sig>

From robert.penz at outertech.com  Thu Nov 27 13:58:41 2003
From: robert.penz at outertech.com (Robert Penz)
Date: Thu, 27 Nov 2003 21:58:41 +0100
Subject: [Twisted-Python] log irc bot example problem
Message-ID: <200311272158.41234.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi!

I'm playing with the twisted irclogbot example .. I've no problem in the 
ircnet, but it I always get disconnected from the efnet, but a eggdrop on the 
same machine has no problem

[21:34:05] [connected at Thu Nov 27 21:34:05 2003]
[21:34:51] [disconnected at Thu Nov 27 21:34:51 2003 reason([Failure instance: 
Traceback: twisted.internet.error.ConnectionDone, Connection was closed 
cleanly.
])]

I've looked at it with tcpdump and got following, but what should that tell 
me:

NICK bla!
NOTICE AUTH :*** Looking up your hostname.
USER bla! foo bar :None
NOTICE AUTH :*** Checking Ident
NOTICE AUTH :*** Found your hostname
NOTICE AUTH :*** Got Ident response
:efnet.demon.co.uk 432 * rim! :Erroneous NERROR :Closing Link: mydnsname.com


- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/xmWB8tTsQqJDUBMRApfXAJ0a5qB4qcIm4cX1e1M1qBuQY7femACfby7W
DLQgXXnZXNiJanDLBA9VxK0=
=D0R7
-----END PGP SIGNATURE-----




From exarkun at intarweb.us  Thu Nov 27 18:34:06 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 27 Nov 2003 20:34:06 -0500
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <200311272158.41234.robert.penz@outertech.com>
References: <200311272158.41234.robert.penz@outertech.com>
Message-ID: <20031128013406.GA19313@intarweb.us>

On Thu, Nov 27, 2003 at 09:58:41PM +0100, Robert Penz wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> Hi!
> 
> I'm playing with the twisted irclogbot example .. I've no problem in the 
> ircnet, but it I always get disconnected from the efnet, but a eggdrop on the 
> same machine has no problem
> 
> [21:34:05] [connected at Thu Nov 27 21:34:05 2003]
> [21:34:51] [disconnected at Thu Nov 27 21:34:51 2003 reason([Failure instance: 
> Traceback: twisted.internet.error.ConnectionDone, Connection was closed 
> cleanly.
> ])]
> 
> I've looked at it with tcpdump and got following, but what should that tell 
> me:
> 
> NICK bla!
> NOTICE AUTH :*** Looking up your hostname.
> USER bla! foo bar :None
> NOTICE AUTH :*** Checking Ident
> NOTICE AUTH :*** Found your hostname
> NOTICE AUTH :*** Got Ident response
> :efnet.demon.co.uk 432 * rim! :Erroneous NERROR :Closing Link: mydnsname.com

  432 is erroneous nickname.  Likely, the server doesn't like the "!" in
your nick.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031127/85eeb836/attachment.sig>

From glyph at twistedmatrix.com  Thu Nov 27 21:05:13 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 27 Nov 2003 23:05:13 -0500
Subject: [Twisted-Python] Fwd: Seems like the remote stuff works almost TOO well!
Message-ID: <11359D4A-2158-11D8-8A5A-000393C9700E@twistedmatrix.com>

I am not sure if this was just the most creative unsolicited mail I 
ever received, or if it's a complaint from an unsuspecting user.  I 
think the "werewolf" comment is from the "AUSPEX" capability of the 
POP3 server.

Have crackers been using Twisted for some nefarious scheme?

Begin forwarded message:

> From: "D Triplett" <censored>
> Date: November 27, 2003 2:55:46 PM EST
> To: Glyph at twistedmatrix.com
> Subject: Seems like the remote stuff works almost TOO well!
>
> Hi,
>
> Long story short, I wonder if you happen to play an online game named 
> "werewolf"?
>
> Better yet, could you tell me where I can get a floppy disk that would 
> wipe out any "twisted" remote network from my computer that I do not 
> know the password for, the network drive number, or anything?
>
> See, I don't know any of this because I didn't create or approve it.  
> But, hey, I bet whoever's taken 109 gigs of my hard drive (leaving me 
> with 11 gigs - sweet of them) were having a good time for a while...
>
> A few of the couple hundred txt docs led me to some stuff, which led 
> me to some more stuff, then a banana driver came along, and somehow, I 
> ended up reading about my cool remote server and compliments of 
> "twisted".
>
> I sure would appreciate any help you can give.




From wenderson at casadosprogramadores.com.br  Fri Nov 28 04:41:21 2003
From: wenderson at casadosprogramadores.com.br (Wenderson Teixeira)
Date: Fri, 28 Nov 2003 09:41:21 -0200
Subject: [Twisted-Python] Woven and nested database queries
Message-ID: <003401c3b5a4$8e2aa7d0$4501a8c0@wteixeiradsk1>

	Hi,

	I'm new to the list and I'm just starting with Twisted and Woven.
	I think the framework is great, but I'm having some problems.
	When I try to make two nested <div>, both with independent queries,
	I get na error, the solution I've found is to create another model
	called "loaddata", which does nothing, except call the queries.
	If anyone knows a better way, I'd like to hear, I've searched all
	over the Internet, and found nothing that could help.

	Thanks in advance,
 	 	
	Wenderson Teixeira


	Here is the minimum working code that exemplifies it:

from twisted.web.resource import Resource

from twisted.web.woven import page
from twisted.web import microdom
from twisted.enterprise import adbapi

class A(page.Page):

    # When "loaddata" is not present, I get the following error:
    # exceptions.AttributeError: DeferredWidget instance has no attribute 'd'
    template = """
                <html>
                <body>
                    <div model="loaddata"/>
                    <p>A</p>
                    <div model="a">
                        <div view="Text"/>
                        <p>B</p>
                        <ul model="b" view="List">
                            <li pattern="listItem" view="Text" />
                        </ul>
                    </div>
                </body>
                </html>
                """    

    def wmfactory_loaddata(self, request):
        self.runAQuery(request)
        self.runBQuery(request)
        return []

    def wmfactory_a(self, request):
        return self.runAQuery(request)

    def wmfactory_b(self, request):
        return self.runBQuery(request)

    def runQuery(self, queryStr, attr, callback):
        if not hasattr(self, attr):
            dbpool = adbapi.ConnectionPool("pyPgSQL.PgSQL", "192.168.1.180::manesco_01:manesco")
            deferredQuery = dbpool.runQuery(queryStr)
            deferredQuery.addCallback(callback)
            dbpool.close()
            return deferredQuery
        return getattr(self, attr)
    
    def runAQuery(self, request):
        # Sample data
        #return [[1, 'Wenderson', 'WT', 2, 'Tex', None]]
        return self.runQuery("SELECT * FROM advogado WHERE id_adv=77", "aDataset", self.gotAResult)

    def runBQuery(self, request):
        # Sample data
        #return [
        #    [1, 'Advogado Sr.'],
        #    [2, 'Advogado Pleno'],
        #    [3, 'Advogado Jr.'],
        #    [4, 'Estagiario'],
        #    [5, 'Assist. Criatividade'],
        #    [6, 'Empresario'],
        #    [7, 'Departamento Pessoal']
        #]
        return self.runQuery("SELECT * FROM categoria", "bDataset", self.gotBResult)

    def gotAResult(self, data):
        self.aDataset = data
        return data
    
    def gotBResult(self, data):
        self.bDataset = data
        return data

resource = A(directory = "C:\inetpub\wwwroot\man")

	




From robert.penz at outertech.com  Fri Nov 28 10:05:10 2003
From: robert.penz at outertech.com (Robert Penz)
Date: Fri, 28 Nov 2003 18:05:10 +0100
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <20031128013406.GA19313@intarweb.us>
References: <200311272158.41234.robert.penz@outertech.com> <20031128013406.GA19313@intarweb.us>
Message-ID: <200311281805.10427.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Friday 28 November 2003 02:34, Jp Calderone wrote:

>   432 is erroneous nickname.  Likely, the server doesn't like the "!" in
> your nick.

ok changed the nick now I get following

NICK blabla31
NOTICE AUTH :*** Looking up your hostname.
USER blabla31 foo bar :None
NOTICE AUTH :*** Checking Ident
NOTICE AUTH :*** Found your hostname
NOTICE AUTH :*** Got Ident response
:efnet.demon.co.uk NOTICE blabla31 :*** BaERROR :Closing Link: mydnsname.com

whats this ?


- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/x4BG8tTsQqJDUBMRApLpAKCPXikRxQ9H3PEIoq3Hx/ZhBCY6EACfZ+Tq
oMms6KhRVXKf822ZMbX5+k4=
=o87D
-----END PGP SIGNATURE-----




From michal at pasternak.w.lub.pl  Fri Nov 28 10:38:12 2003
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Fri, 28 Nov 2003 18:38:12 +0100
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <200311281805.10427.robert.penz@outertech.com>
References: <200311272158.41234.robert.penz@outertech.com> <20031128013406.GA19313@intarweb.us> <200311281805.10427.robert.penz@outertech.com>
Message-ID: <20031128173812.GC24887@pasternak.w.lub.pl>

Robert Penz [Fri, Nov 28, 2003 at 06:05:10PM +0100]:
> :efnet.demon.co.uk NOTICE blabla31 :*** BaERROR :Closing Link: mydnsname.com
> 
> whats this ?

Robert,

your questions have nothing to do with Twisted, those are IRC problems. It's
closing link, because - propably - mydnsname.com is not allowed to connect
to that IRC server. I'd suggest e-mailing some local irc-oriented newsgroup
or list. Thank you.

-- 
Michal Pasternak :: http://pasternak.w.lub.pl



From robert.penz at outertech.com  Fri Nov 28 11:15:33 2003
From: robert.penz at outertech.com (Robert Penz)
Date: Fri, 28 Nov 2003 19:15:33 +0100
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <20031128173812.GC24887@pasternak.w.lub.pl>
References: <200311272158.41234.robert.penz@outertech.com> <200311281805.10427.robert.penz@outertech.com> <20031128173812.GC24887@pasternak.w.lub.pl>
Message-ID: <200311281915.33884.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Friday 28 November 2003 18:38, Michal Pasternak wrote:
> your questions have nothing to do with Twisted, those are IRC problems.
> It's closing link, because - propably - mydnsname.com is not allowed to
> connect to that IRC server. I'd suggest e-mailing some local irc-oriented
> newsgroup or list. Thank you.

but if I start eggdrop on the same machine it works.

- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/x5DF8tTsQqJDUBMRAs1rAJ0cepGVJ8RcFbwzWEzNN2BjWbsrKwCdGdxw
f045prIe9eLmyRnEJP7YhqY=
=dA+w
-----END PGP SIGNATURE-----




From pje at telecommunity.com  Fri Nov 28 14:17:36 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Fri, 28 Nov 2003 16:17:36 -0500
Subject: [Twisted-Python] PyProtocols 0.9.1 Released
Message-ID: <5.1.0.14.0.20031128160119.028e9dc0@mail.telecommunity.com>

What is PyProtocols?
--------------------

PyProtocols is an extended implementation of PEP 246, adding a new 
"declaration  API" that lets you easily define your own interfaces and 
adapters, and declare what adapters should be used to adapt what types, 
objects, or interfaces.  Using PyProtocols, you can easily make flexible 
frameworks that you or other developers can extend without needing to 
modify the base framework.  PyProtocols interfaces can interoperate with 
those of Twisted and Zope, or can be used entirely standalone.

PyProtocols may be used, modified, and distributed under the same terms
and conditions as Python or Zope.


What's new in version 0.9.1?
----------------------------

* Implemented Samuele Pedroni's "subproto" idea (see 
http://mail.python.org/pipermail/python-dev/2003-June/036242.html) as the 
new 'protocolForType()' API.

* Added other APIs to automatically generate protocols, such as 
'protocolForURI()', 'sequenceOf()', and 'Variation()'.

* Compatible with Zope X3 Milestone 4, Python 2.3.2, and Twisted 
1.1.0.  (Also runs on Python 2.2.2+, if you don't need Zope 3 compatibility.)

* New 'Adapter' and 'StickyAdapter' convenience base classes

* Fixes for compatibility with 'ExtensionClass', and for a memory leak in 
the optional C "speedups" module


PyProtocols Resources
---------------------

* Detailed Changes since the 0.9 release:
    http://peak.telecommunity.com/protocol_api/CHANGES.txt.html

* Release notes, installation instructions, and browsable API docs:
    http://peak.telecommunity.com/protocol_api/

* Source and Binary Releases:
    http://peak.telecommunity.com/dist/

* Reference Manual (HTML):
    http://peak.telecommunity.com/protocol_ref/module-protocols.html

* Reference Manual (PDF):
    http://peak.telecommunity.com/protocol_ref.pdf

* Browsable CVS Repository:
    http://cvs.eby-sarna.com/PyProtocols/




From flxkid at techemail.com  Fri Nov 28 23:59:17 2003
From: flxkid at techemail.com (Oliver Nelson)
Date: Fri, 28 Nov 2003 22:59:17 -0800 (PST)
Subject: [Twisted-Python] using twisted web server as a type of REST server
Message-ID: <20031129065917.9276B725B@sitemail.everyone.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: </pipermail/twisted-python/attachments/20031128/c1a18a36/attachment.ksh>

From robert.penz at outertech.com  Sat Nov 29 02:01:01 2003
From: robert.penz at outertech.com (Robert Penz)
Date: Sat, 29 Nov 2003 10:01:01 +0100
Subject: [Twisted-Python] log irc bot example problem
In-Reply-To: <200311281915.33884.robert.penz@outertech.com>
References: <200311272158.41234.robert.penz@outertech.com> <20031128173812.GC24887@pasternak.w.lub.pl> <200311281915.33884.robert.penz@outertech.com>
Message-ID: <200311291001.04537.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Friday 28 November 2003 19:15, Robert Penz wrote:
> On Friday 28 November 2003 18:38, Michal Pasternak wrote:
> > your questions have nothing to do with Twisted, those are IRC problems.
> > It's closing link, because - propably - mydnsname.com is not allowed to
> > connect to that IRC server. I'd suggest e-mailing some local irc-oriented
> > newsgroup or list. Thank you.
> but if I start eggdrop on the same machine it works.

found the problem ... 

- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/yGBQ8tTsQqJDUBMRAmrqAJ0ZRZxsFMFbpfNsJwYF5wB4Wbl7PACfSVpC
wc/6F6wT5yLQQ/+6Wws8WfE=
=MTiQ
-----END PGP SIGNATURE-----




From lists at webcrunchers.com  Sat Nov 29 14:07:34 2003
From: lists at webcrunchers.com (JD)
Date: Sat, 29 Nov 2003 13:07:34 -0800
Subject: [Twisted-Python] Anyone want to join our Spammer hooneypot project?
In-Reply-To: <200311291001.04537.robert.penz@outertech.com>
References: <200311272158.41234.robert.penz@outertech.com> <20031128173812.GC24887@pasternak.w.lub.pl> <200311281915.33884.robert.penz@outertech.com> <200311291001.04537.robert.penz@outertech.com>
Message-ID: <0DAD250E-22B0-11D8-8F1A-0030656C6B9E@webcrunchers.com>

Hi,

This is an initial inquiry to find out if anyone really familiar with 
Twisted would want to join me in the development of
a Spammer honeypot system to release into the public domain.

A recent "securityfocus" article seems to indicate some project like 
this might be worthwhile,  and Twisted seems
to be the perfect tool for this....

Not only would it be used to "fool" spammers,  but it also could be 
used to "detect" proxy connections from IRC
bots,  and return the proper "fingerprints" to convince the spammers 
this is a really legit proxy.

I've done a lot of research in this project,  and come to the 
realization that the ONLY way to catch these people
who write such viruses,  is to "suck them into" a honeypot.

Anyone interested,  please Email me at 'crunch at shopip dot com'

Don't reply to my 'lists' mailbox,  as this is only for my mailing 
lists.

Regards
John




From maoy at cis.upenn.edu  Sat Nov 29 16:06:05 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Sat, 29 Nov 2003 18:06:05 -0500 (EST)
Subject: [Twisted-Python] SSL example in tutorial isn't working for me
In-Reply-To: <0DAD250E-22B0-11D8-8F1A-0030656C6B9E@webcrunchers.com>
Message-ID: <Pine.LNX.4.44.0311291803190.32236-100000@klondike.cis.upenn.edu>

http://www.twistedmatrix.com/documents/howto/listings/finger/finger22.py

Error:

2003/11/29 18:00 EST [-] NameError: global name 'SSL' is not defined

Is it because someone commented out from OpenSSL import SSL? I uncomment 
it and emerge pyOpennSSL but it still doesn't work. :(

Yun






From slyphon at twistedmatrix.com  Sat Nov 29 17:41:55 2003
From: slyphon at twistedmatrix.com (Jonathan Simms)
Date: Sat, 29 Nov 2003 19:41:55 -0500
Subject: [Twisted-Python] using twisted web server as a type of REST
	server
In-Reply-To: <20031129065917.9276B725B@sitemail.everyone.net>
References: <20031129065917.9276B725B@sitemail.everyone.net>
Message-ID: <1070152915.662.42.camel@willie-the-pimp.embassynetworks.com>

On Sat, 2003-11-29 at 01:59, Oliver Nelson wrote:
> Reading the docs on the twisted web server I see that it automatically 
> handles object publishing.  But what if I want to respond to requests 
> that aren't based on a object structure?  IOW:
> 
> Client does a GET on:
> localhost/infodir/subdir/doc.txt
> 
> in this case infodir, subdir, and doc.txt would actually be info to 
> lookup in a database on the fly, no object structure.  Is this possible?
> 
> I hope I'm explaining myself ok...

Well, I'm no expert on twisted-web, but I wanted to answer your question
in at least a general sense. It is indeed possible to perform such a
task, as twisted.web's object lookup is completely customizable. Drop in
on #twisted on irc.freenode.net and ask someone in there, or if no one
else responds to this thread, email me and I'll help you find out how to
do what you're interested in doing.

- Jonathan Simms (slyphon)




From exarkun at intarweb.us  Sat Nov 29 18:41:55 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 29 Nov 2003 20:41:55 -0500
Subject: [Twisted-Python] SSL example in tutorial isn't working for me
In-Reply-To: <Pine.LNX.4.44.0311291803190.32236-100000@klondike.cis.upenn.edu>
References: <0DAD250E-22B0-11D8-8F1A-0030656C6B9E@webcrunchers.com> <Pine.LNX.4.44.0311291803190.32236-100000@klondike.cis.upenn.edu>
Message-ID: <20031130014155.GA25459@intarweb.us>

On Sat, Nov 29, 2003 at 06:06:05PM -0500, Yun Mao wrote:
> http://www.twistedmatrix.com/documents/howto/listings/finger/finger22.py
> 
> Error:
> 
> 2003/11/29 18:00 EST [-] NameError: global name 'SSL' is not defined
> 
> Is it because someone commented out from OpenSSL import SSL? 

  Probably.  It is unclear why this has been done.

> I uncomment it and emerge pyOpennSSL but it still doesn't work. :(

  How does it not work?

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031129/c5586fd1/attachment.sig>

From andrew-twisted at puzzling.org  Sat Nov 29 18:50:22 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 30 Nov 2003 12:50:22 +1100
Subject: [Twisted-Python] using twisted web server as a type of REST server
In-Reply-To: <20031129065917.9276B725B@sitemail.everyone.net>
References: <20031129065917.9276B725B@sitemail.everyone.net>
Message-ID: <20031130015021.GB8856@frobozz>

On Fri, Nov 28, 2003 at 10:59:17PM -0800, Oliver Nelson wrote:
> Reading the docs on the twisted web server I see that it automatically
> handles object publishing.  But what if I want to respond to requests that
> aren't based on a object structure?  IOW:
> 
> Client does a GET on:
> localhost/infodir/subdir/doc.txt
> 
> in this case infodir, subdir, and doc.txt would actually be info to lookup
> in a database on the fly, no object structure.  Is this possible?

Yep.  Write a custom Resource, and override getChild:
    http://twistedmatrix.com/documents/howto/using-twistedweb#auto3

-Andrew.




From maoy at cis.upenn.edu  Sat Nov 29 19:17:36 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Sat, 29 Nov 2003 21:17:36 -0500 (EST)
Subject: [Twisted-Python] SSL example in tutorial isn't working for me
In-Reply-To: <20031130014155.GA25459@intarweb.us>
Message-ID: <Pine.LNX.4.44.0311292055060.32236-100000@klondike.cis.upenn.edu>

I see what's wrong here.

This is part of finger22.py

    def getContext(self):
        """Create an SSL context.

        This is a sample implementation that loads a certificate from a 
file
        called 'server.pem'."""                               
        ctx = SSL.Context(SSL.SSLv23_METHOD)
        ctx.use_certificate_file('server.pem')
        ctx.use_privatekey_file('server.pem')
        return ctx

I should have substituted the certificate_file to the certificate file..

Yun


On Sat, 29 Nov 2003, Jp Calderone wrote:

> On Sat, Nov 29, 2003 at 06:06:05PM -0500, Yun Mao wrote:
> > http://www.twistedmatrix.com/documents/howto/listings/finger/finger22.py
> > 
> > Error:
> > 
> > 2003/11/29 18:00 EST [-] NameError: global name 'SSL' is not defined
> > 
> > Is it because someone commented out from OpenSSL import SSL? 
> 
>   Probably.  It is unclear why this has been done.
> 
> > I uncomment it and emerge pyOpennSSL but it still doesn't work. :(
> 
>   How does it not work?
> 
>   Jp
> 




From jsbenson at bensonsystems.com  Sat Nov 29 21:26:50 2003
From: jsbenson at bensonsystems.com (John Benson)
Date: Sat, 29 Nov 2003 20:26:50 -0800
Subject: [Twisted-Python] Re: python-list query re sockets, select or: twisted and other file-descriptors & twisted question
Message-ID: <061d01c3b6fa$2d0a12e0$210110ac@jsbwxp3>

In response to the question about doing serial i/o and using a select
statement, I'd like to quote from
http://www.python.org/doc/current/lib/module-select.html

select(iwtd, owtd, ewtd[, timeout])

This is a straightforward interface to the Unix select() system call. The
first three arguments are lists of `waitable objects': either integers
representing file descriptors or objects with a parameterless method named
fileno() returning such an integer. The three lists of waitable objects are
for input, output and `exceptional conditions', respectively. Empty lists
are allowed, but acceptance of three empty lists is platform-dependent. (It
is known to work on Unix but not on Windows.) The optional timeout argument
specifies a time-out as a floating point number in seconds. When the timeout
argument is omitted the function blocks until at least one file descriptor
is ready. A time-out value of zero specifies a poll and never blocks.
The return value is a triple of lists of objects that are ready: subsets of
the first three arguments. When the time-out is reached without a file
descriptor becoming ready, three empty lists are returned.
Among the acceptable object types in the lists are Python file objects (e.g.
sys.stdin, or objects returned by open() or os.popen()), socket objects
returned by socket.socket().  You may also define a wrapper class yourself,
as long as it has an appropriate fileno() method (that really returns a file
descriptor, not just a random integer). Note: File objects on Windows are
not acceptable, but sockets are.  On Windows, the underlying select()
function is provided by the WinSock library, and does not handle file
desciptors that don't originate from WinSock.

(end quote)

So, select might not yet work on Windows serial ports as well as sockets.
This is also a subject of interest to me, but all I can think of is handling
the sockets via select() and polling periodically for data on the serial
port using callLater() and some win32 calls. Maybe the win32 serial port
handling could even be wrapped in a 'waitable object' as described above for
use with the Python select() call.

I recall reading somewhere that the twisted framework has the ability to
handle serial communications in connection with Global Positioning System
device interaction, but don't have any information about it. I'm going to
post this to the twisted mailing list :

Question for twisted folks: How can I add serial Windows serial port
communications as a twisted protocol? Please cross-post back to the
python-list.





From radix at twistedmatrix.com  Sat Nov 29 22:42:23 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 30 Nov 2003 00:42:23 -0500
Subject: [Twisted-Python] python-interfaces mailing list
Message-ID: <20031130054223.GC3019@radii>

I just set up a new mailing list on twistedmatrix.com to discuss
interface/component systems with possible future interest in a SIG for
"integrating" (to some extent) existing Interface systems and putting
an Interface/component system into python. Even this interest is
controversial, though, I think it's mostly my own ;-)

You can subscribe at 

http://twistedmatrix.com/cgi-bin/listinfo/python-interfaces

And that page has a link to archives containing the few messages which
have been posted so far.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From radix at twistedmatrix.com  Sun Nov 30 00:03:48 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 30 Nov 2003 02:03:48 -0500
Subject: [Twisted-Python] python-interfaces mailing list
In-Reply-To: <20031130054223.GC3019@radii>
References: <20031130054223.GC3019@radii>
Message-ID: <20031130070348.GA5788@radii>

On Sun, Nov 30, 2003 at 12:42:23AM -0500, Christopher Armstrong wrote:
> I just set up a new mailing list on twistedmatrix.com to discuss
> interface/component systems with possible future interest in a SIG for
> "integrating" (to some extent) existing Interface systems and putting
> an Interface/component system into python. Even this interest is
> controversial, though, I think it's mostly my own ;-)
> 
> You can subscribe at 
> 
> http://twistedmatrix.com/cgi-bin/listinfo/python-interfaces

Bah, I didn't check this URL.

http://twistedmatrix.com/cgi-bin/mailman/listinfo/python-interfaces

Sorry.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/



From tv at tv.debian.net  Fri Nov 28 07:09:14 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Fri, 28 Nov 2003 16:09:14 +0200
Subject: [Twisted-Python] plugin vs. dropin
In-Reply-To: <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>
References: <2321.65.246.170.211.1069876186.squirrel@192.168.0.2>    <20031126202408.GA16267@intarweb.us> <2490.65.246.170.211.1069880894.squirrel@192.168.0.2>
Message-ID: <3FC7570A.9060106@tv.debian.net>

Phil Christensen wrote:
>>>>from twisted.python import plugin
>>>>plugin.getPlugIns("myPluginType")
> 
> [<Plugin 'My plugin package' core.plugin>]
> 
> so i guess my question is, what to i do with this plugin object? i see it
> has a property named "module", which is the string i gave it of
> "core.plugin". this file doesn't exist yet since i don't know what to put
> in it.
> 
> i guess i just need a little more guidance. i'm looking through the code
> too, but i'm not sure what calls what...

You may want to look at how TouRSSt uses plugins.
http://ftp.debian.org/debian/pool/main/t/toursst/




From tv at tv.debian.net  Fri Nov 28 07:12:47 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Fri, 28 Nov 2003 16:12:47 +0200
Subject: [Twisted-Python] Woven and nested database queries
In-Reply-To: <003401c3b5a4$8e2aa7d0$4501a8c0@wteixeiradsk1>
References: <003401c3b5a4$8e2aa7d0$4501a8c0@wteixeiradsk1>
Message-ID: <3FC757DF.5010405@tv.debian.net>

Wenderson Teixeira wrote:
> 	I'm new to the list and I'm just starting with Twisted and Woven.
> 	I think the framework is great, but I'm having some problems.
> 	When I try to make two nested <div>, both with independent queries,
> 	I get na error, the solution I've found is to create another model
> 	called "loaddata", which does nothing, except call the queries.
> 	If anyone knows a better way, I'd like to hear, I've searched all
> 	over the Internet, and found nothing that could help.

Your problem is most likely Deferred models of which you need a 
submodel. Woven is buggy.

>                     <div model="a">
>                         <div view="Text"/>
>                         <p>B</p>
>                         <ul model="b" view="List">
>                             <li pattern="listItem" view="Text" />
>                         </ul>

Try <ul model="./b" view="List">, that should work.




From kevin at mobilewareinc.com  Fri Nov 28 16:34:25 2003
From: kevin at mobilewareinc.com (Kevin Unger)
Date: Fri, 28 Nov 2003 15:34:25 -0800
Subject: [Twisted-Python] no reponse from mktap on windows
Message-ID: <000c01c3b608$2b5c9ff0$0201a8c0@telecaster>

I just downloaded twisted 1.1.0 forWindows and I get no response from mktap:

    python %TWISTEDSCRIPTS%\mktap.py web --help

What am I doing wrong?

thanks,

-k

Kevin Unger
MobileWare, Inc.
kevin at mobilewareinc.com
707-769-7441
707-364-1176 (cell)




From andrew-pythonlist at puzzling.org  Sun Nov 30 00:08:53 2003
From: andrew-pythonlist at puzzling.org (Andrew Bennetts)
Date: Sun, 30 Nov 2003 18:08:53 +1100
Subject: [Twisted-Python] Re: python-list query re sockets, select or: twisted and other file-descriptors & twisted question
In-Reply-To: <061d01c3b6fa$2d0a12e0$210110ac@jsbwxp3>
References: <061d01c3b6fa$2d0a12e0$210110ac@jsbwxp3>
Message-ID: <20031130070853.GE8856@frobozz>

On Sat, Nov 29, 2003 at 08:26:50PM -0800, John Benson wrote:
> 
> So, select might not yet work on Windows serial ports as well as sockets.

That's correct.  Windows select is from the Winsock library, and only works
with sockets.

> This is also a subject of interest to me, but all I can think of is handling
> the sockets via select() and polling periodically for data on the serial
> port using callLater() and some win32 calls. Maybe the win32 serial port
> handling could even be wrapped in a 'waitable object' as described above for
> use with the Python select() call.

Thankfully, pySerial has already taken care of the details of cross-platform
serial-port access (apparently, I've never used it):

    http://pyserial.sourceforge.net/

> I recall reading somewhere that the twisted framework has the ability to
> handle serial communications in connection with Global Positioning System
> device interaction, but don't have any information about it. I'm going to
> post this to the twisted mailing list :
> 
> Question for twisted folks: How can I add serial Windows serial port
> communications as a twisted protocol? Please cross-post back to the
> python-list.

Twisted uses pySerial, so the platform you're running Twisted on shouldn't
matter.  There are some examples in the doc/examples directory of Twisted
that use the serial port:

    mouse.py -- example using MouseMan protocol with the SerialPort
                transport
    gpsfix.py -- example using the SerialPort transport and the NMEA 0183
                 and Rockwell Zodiac GPS protocols to display fix data as it
                 is received from the device.

-Andrew.




From lafou at wanadoo.fr  Sun Nov 30 11:17:36 2003
From: lafou at wanadoo.fr (Philippe =?iso-8859-1?q?Lafoucri=E8re?=)
Date: Sun, 30 Nov 2003 19:17:36 +0100
Subject: [Twisted-Python] getProcessOutpout
Message-ID: <200311301917.36596.lafou@wanadoo.fr>

I have a pb with twisted.internet.utils.getProcessOutput (i never get the 
output :() here is an exemple :

class PGAT_deftest(GAT_page):

    template="""<html><body><span view="Viewtest"></span></body></html>"""

    def wvfactory_Viewtest(self, request, node, model):
        return MyDeferredWidget(model)

    def render(self, request):
        request.write('<html><body><h1>DEFTEST</h1>'+ time.asctime()+'<br >')
        print "Emerge !"
        d = getProcessOutput("ps")
        d.setTimeout(5,self.renderProcessOutput, request)
        d.addCallback(self.renderProcessOutput, request)
        d.addErrback(self.renderError, request)
        d.addCallback(self.finishPage, request)
        return NOT_DONE_YET

    def renderProcessOutput(self, output, request):
        request.write(output)

    def renderError(self, failure, request):
        request.write('it broke! (error : "'+failure.getErrorMessage()+'")')

    def finishPage(self, _, request):
        request.write('</body></html>')
        request.finish()

def montest():
    time.sleep(5)
    return "Ca marche !"

If I create a bash script with :
---
sleep(5)
echo "Hello world"
---
the twisted code above works great. But If I use a system program like "ps" or 
"emerge" , the callback is never called :(

(btw : getProcessOutput ("date") works)




From flxkid at techemail.com  Sun Nov 30 22:45:01 2003
From: flxkid at techemail.com (Oliver Nelson)
Date: Sun, 30 Nov 2003 21:45:01 -0800 (PST)
Subject: [Twisted-Python] Re: using twisted web server as a type of REST server
Message-ID: <20031201054501.39CB7393B@sitemail.everyone.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: </pipermail/twisted-python/attachments/20031130/fa25716f/attachment.ksh>

