<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Interactive Twisted client (newbie question?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Interactive%20Twisted%20client%20%28newbie%20question%3F%29&In-Reply-To=%3C1104793201.41d9ce715e8e8%40www.nerc-essc.ac.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="041857.html">
   <LINK REL="Next"  HREF="041795.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Interactive Twisted client (newbie question?)</H1>
    <B>Jon Blower</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Interactive%20Twisted%20client%20%28newbie%20question%3F%29&In-Reply-To=%3C1104793201.41d9ce715e8e8%40www.nerc-essc.ac.uk%3E"
       TITLE="[Twisted-Python] Interactive Twisted client (newbie question?)">jdb at mail.nerc-essc.ac.uk
       </A><BR>
    <I>Mon Jan  3 16:00:01 MST 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="041857.html">[Twisted-Python] Weekly Bug Summary
</A></li>
        <LI>Next message (by thread): <A HREF="041795.html">[Twisted-Python] Interactive Twisted client (newbie question?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41786">[ date ]</a>
              <a href="thread.html#41786">[ thread ]</a>
              <a href="subject.html#41786">[ subject ]</a>
              <a href="author.html#41786">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I'm new to Twisted, and I'm trying to create an implementation of a client
program that communicates over a network with a server using a protocol called
Styx.  (In case you're interested, Styx is a protocol for distributed systems,
as used by the Inferno operating system:
<A HREF="http://www.vitanuova.com/inferno/papers/styx.html.">http://www.vitanuova.com/inferno/papers/styx.html.</A>)  In short, Styx is a pretty
simple call-response type of protocol, in which the client sends a T-message
and waits for the corresponding R-message from the server.  There is a
one-to-one correspondence between T- and R-messages.

I understand that Twisted is an event-driven framework and I have written a
basic client program.  My initial attempt has involved creating a StyxProtocol
class that inherits from protocol.Protocol, in which I override key methods
such as dataReceived() and connectionMade().  Having created this protocol and
told it how to respond to messages that arrive, I created a simple Factory
class, then set the whole thing running with reactor.run().  It works fine, but
it's not quite in the form I'd like.  In my current attempt, what I've done is
essentially to create a load of callbacks and &quot;press GO&quot;.  Once I've set the
program running I can't interact with it until one of the methods calls
reactor.stop().

What I'd like to be able to do is illustrated by the following pseudo-Python. 
This could be a script or could be typed into an interactive Python shell:

conn = StyxConnection(&quot;myserver.remotehost.com&quot;, 6666)
conn.connect() # Starts the reactor going and performs handshakes
# The connection is now open and I can interact with it
myRemoteFile = conn.openFile(&quot;/path/to/myfile&quot;) # Gets handle to file on remote
server, by exchange of a few messages
data = myRemoteFile.read() # Reads data from the remote file, again by exchange
of some messages
conn.close() # Closes the connection to the remote server and stops the reactor

How can I do this with the Twisted framework?  As far as I can tell,
reactor.run() will not return until something calls reactor.stop().  I could
achieve what I want using threads (I think), but I'd like to avoid this if
possible.

I'm sure I'm not the first to ask this sort of question, but I've looked through
the docs and example code and haven't been able to track down an answer.  I'd
be very grateful for any pointers that anyone could offer.

Regards,
Jon

-- 
--------------------------------------------------------------
Dr Jon Blower              Tel: +44 118 378 5213 (direct line)
Technical Director         Tel: +44 118 378 8741 (ESSC)
Reading e-Science Centre   Fax: +44 118 378 6413
ESSC                       Email: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jdb at mail.nerc-essc.ac.uk</A>
University of Reading
3 Earley Gate
Reading RG6 6AL, UK
--------------------------------------------------------------

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="041857.html">[Twisted-Python] Weekly Bug Summary
</A></li>
	<LI>Next message (by thread): <A HREF="041795.html">[Twisted-Python] Interactive Twisted client (newbie question?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41786">[ date ]</a>
              <a href="thread.html#41786">[ thread ]</a>
              <a href="subject.html#41786">[ subject ]</a>
              <a href="author.html#41786">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
