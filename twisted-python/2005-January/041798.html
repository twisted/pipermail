<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Interactive Twisted client (newbie question?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Interactive%20Twisted%20client%20%28newbie%20question%3F%29&In-Reply-To=%3Cf2b573190501051019613f3791%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="041797.html">
   <LINK REL="Next"  HREF="041799.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Interactive Twisted client (newbie question?)</H1>
    <B>Anthony Tarlano</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Interactive%20Twisted%20client%20%28newbie%20question%3F%29&In-Reply-To=%3Cf2b573190501051019613f3791%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Interactive Twisted client (newbie question?)">mailinglist.account at gmail.com
       </A><BR>
    <I>Wed Jan  5 11:19:23 MST 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="041797.html">[Twisted-Python] Interactive Twisted client (newbie question?)
</A></li>
        <LI>Next message (by thread): <A HREF="041799.html">[Twisted-Python] Interactive Twisted client (newbie question?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41798">[ date ]</a>
              <a href="thread.html#41798">[ thread ]</a>
              <a href="subject.html#41798">[ subject ]</a>
              <a href="author.html#41798">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jon,

Interesting that you are implementing Styx with Twisted, I used to
work with Inferno and its father 9P (plan9) back during my Lucent
days.

Are you creating just creating a twisted Styx protocol client to use
with the vitanuova styx server or are you looking to do a server in
twisted as well? Let me know if you are redoing the styx server as
well in twisted, but back to your original problem question...

Keeping thing nice an simple, the pythonic way, I did a similar thing
in Twisted, but using a different method.. From what I can tell from
your post is you *really* want is a twisted styx client that sends
T-messages to a styx server to serve its namespace with R-messages,
and *you* want to interact with the client synchronously.. You also
asked for a better way to implement the client not using callbacks,
but that was not the real issue. For _you_ the real issue is
synchronously communicating _with_the_styx_client from a command
line..

If this assumption is correct then all you have to do is make the styx
client a server as well, for let's say the telnet protocol. Then you
can use a telnet client to connect to the telnet server (which is also
the styx client) and bingo issue commands to the styx server (via the
styx client that is also the telnet server)... Of course you will have
to pass the styx server messages back to the telnet client

Let me know if that answers you problem..

There is even an example in the howto's to setup both a client and
server from one factory

Cheers,

Anthony


On Mon,  3 Jan 2005 23:00:01 +0000, Jon Blower &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jdb at mail.nerc-essc.ac.uk</A>&gt; wrote:
&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> I'm new to Twisted, and I'm trying to create an implementation of a client
</I>&gt;<i> program that communicates over a network with a server using a protocol called
</I>&gt;<i> Styx.  (In case you're interested, Styx is a protocol for distributed systems,
</I>&gt;<i> as used by the Inferno operating system:
</I>&gt;<i> <A HREF="http://www.vitanuova.com/inferno/papers/styx.html.">http://www.vitanuova.com/inferno/papers/styx.html.</A>)  In short, Styx is a pretty
</I>&gt;<i> simple call-response type of protocol, in which the client sends a T-message
</I>&gt;<i> and waits for the corresponding R-message from the server.  There is a
</I>&gt;<i> one-to-one correspondence between T- and R-messages.
</I>&gt;<i> 
</I>&gt;<i> I understand that Twisted is an event-driven framework and I have written a
</I>&gt;<i> basic client program.  My initial attempt has involved creating a StyxProtocol
</I>&gt;<i> class that inherits from protocol.Protocol, in which I override key methods
</I>&gt;<i> such as dataReceived() and connectionMade().  Having created this protocol and
</I>&gt;<i> told it how to respond to messages that arrive, I created a simple Factory
</I>&gt;<i> class, then set the whole thing running with reactor.run().  It works fine, but
</I>&gt;<i> it's not quite in the form I'd like.  In my current attempt, what I've done is
</I>&gt;<i> essentially to create a load of callbacks and &quot;press GO&quot;.  Once I've set the
</I>&gt;<i> program running I can't interact with it until one of the methods calls
</I>&gt;<i> reactor.stop().
</I>&gt;<i> 
</I>&gt;<i> What I'd like to be able to do is illustrated by the following pseudo-Python.
</I>&gt;<i> This could be a script or could be typed into an interactive Python shell:
</I>&gt;<i> 
</I>&gt;<i> conn = StyxConnection(&quot;myserver.remotehost.com&quot;, 6666)
</I>&gt;<i> conn.connect() # Starts the reactor going and performs handshakes
</I>&gt;<i> # The connection is now open and I can interact with it
</I>&gt;<i> myRemoteFile = conn.openFile(&quot;/path/to/myfile&quot;) # Gets handle to file on remote
</I>&gt;<i> server, by exchange of a few messages
</I>&gt;<i> data = myRemoteFile.read() # Reads data from the remote file, again by exchange
</I>&gt;<i> of some messages
</I>&gt;<i> conn.close() # Closes the connection to the remote server and stops the reactor
</I>&gt;<i> 
</I>&gt;<i> How can I do this with the Twisted framework?  As far as I can tell,
</I>&gt;<i> reactor.run() will not return until something calls reactor.stop().  I could
</I>&gt;<i> achieve what I want using threads (I think), but I'd like to avoid this if
</I>&gt;<i> possible.
</I>&gt;<i> 
</I>&gt;<i> I'm sure I'm not the first to ask this sort of question, but I've looked through
</I>&gt;<i> the docs and example code and haven't been able to track down an answer.  I'd
</I>&gt;<i> be very grateful for any pointers that anyone could offer.
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> Jon
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> --------------------------------------------------------------
</I>&gt;<i> Dr Jon Blower              Tel: +44 118 378 5213 (direct line)
</I>&gt;<i> Technical Director         Tel: +44 118 378 8741 (ESSC)
</I>&gt;<i> Reading e-Science Centre   Fax: +44 118 378 6413
</I>&gt;<i> ESSC                       Email: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jdb at mail.nerc-essc.ac.uk</A>
</I>&gt;<i> University of Reading
</I>&gt;<i> 3 Earley Gate
</I>&gt;<i> Reading RG6 6AL, UK
</I>&gt;<i> --------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> ----------------------------------------------------------------
</I>&gt;<i> This message was sent using IMP, the Internet Messaging Program.
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="041797.html">[Twisted-Python] Interactive Twisted client (newbie question?)
</A></li>
	<LI>Next message (by thread): <A HREF="041799.html">[Twisted-Python] Interactive Twisted client (newbie question?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41798">[ date ]</a>
              <a href="thread.html#41798">[ thread ]</a>
              <a href="subject.html#41798">[ subject ]</a>
              <a href="author.html#41798">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
