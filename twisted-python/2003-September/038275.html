<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted scalability question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20scalability%20question&In-Reply-To=%3C200309222358.55540.matti.jagula%40proekspert.ee%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="038301.html">
   <LINK REL="Next"  HREF="038276.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted scalability question</H1>
    <B>Matti Jagula</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20scalability%20question&In-Reply-To=%3C200309222358.55540.matti.jagula%40proekspert.ee%3E"
       TITLE="[Twisted-Python] Twisted scalability question">matti.jagula at proekspert.ee
       </A><BR>
    <I>Mon Sep 22 14:58:55 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="038301.html">[Twisted-Python] twisted socksv4 proxy
</A></li>
        <LI>Next message (by thread): <A HREF="038276.html">[Twisted-Python] Twisted scalability question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38275">[ date ]</a>
              <a href="thread.html#38275">[ thread ]</a>
              <a href="subject.html#38275">[ subject ]</a>
              <a href="author.html#38275">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I've got a task to write a DHCP server for a local cable operator and I'm 
considering different frameworks to write it in. I've looked at Twisted a 
couple of times and thought I'd do some little experimenting to see how well 
it behaves with the current task at hand.

The DHCP server needs to do some database interaction to support the business 
logic. So to model the problem I wrote two simple QOTD servers for UDP 
protocol, using a postresql backend for quotes. 

One server is written using a Twisted DatagramProtocol and uses Deferreds for 
database query using adbapi. The other is a dead-simple single-threaded 
block-and-wait UDP socket server with a single database connection that just 
reads from the udp socket, queries the database and writes the result back.

So far so good. I wanted to see how well these servers scale with a lot of 
requests. First I tried making just a lot of sequential requests from a 
single-threaded client, but that showed that the Twisted version was slower 
by a factor of ~4. 

After a little consideration I thought that Twisted must be better for a lot 
of concurrent requests, because of the threaded database access. Twisted 
should be able to accept more than one client at a time and keep all the 
database connections (5 by default, i guess) busy. So I forked 20 clients off 
using a simple bash script with a for loop. The result was that the Twisted 
is still slower, by the same factor of 4.

The &quot;top&quot; shows that while the Twisted server is running, the 5 postgresql 
connections are mostly in &quot;idle&quot; state (they change the name of the process 
to show it). However, while the single threaded server is running, the only 
active pgsql connection is mostly in its &quot;select&quot; state.

So, after the rather lengthy introduction, I'd like to know what am I doing 
wrong? How can I show the better scalability of Twisted platform?

-- 
  Matti Jagula



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="038301.html">[Twisted-Python] twisted socksv4 proxy
</A></li>
	<LI>Next message (by thread): <A HREF="038276.html">[Twisted-Python] Twisted scalability question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38275">[ date ]</a>
              <a href="thread.html#38275">[ thread ]</a>
              <a href="subject.html#38275">[ subject ]</a>
              <a href="author.html#38275">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
