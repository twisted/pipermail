<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Question about using the adbapi
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Question%20about%20using%20the%20adbapi&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023975.html">
   <LINK REL="Next"  HREF="023979.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Question about using the adbapi</H1>
    <B>Albert Brandl</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Question%20about%20using%20the%20adbapi&In-Reply-To="
       TITLE="[Twisted-Python] Question about using the adbapi">albert.brandl at weiermayer.com
       </A><BR>
    <I>Mon May  9 06:50:46 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="023975.html">[Twisted-Python] Weekly Bug Summary
</A></li>
        <LI>Next message: <A HREF="023979.html">[Twisted-Python] Question about using the adbapi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23978">[ date ]</a>
              <a href="thread.html#23978">[ thread ]</a>
              <a href="subject.html#23978">[ subject ]</a>
              <a href="author.html#23978">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi!

In the application I'm currently working on, we gather data from 
different sources and store them in a database, but only if the
values have changed.

One example is GPS information. We don't want to store hundreds of 
identical values that are sent by the receiver, so we have to compare the 
last written row with the current latitude / longitude pair.

I use a subclass of NMEARreceiver class to determine the current latitude 
and longitude. Then I query the database using a ConnectionPool instance 
to get the previous values for latitude and longitude. If the result 
differs from the current values, a new entry is stored, again using the 
ConnectionPool.

The problem is: How do I &quot;connect&quot; the current latitude and longitude to 
the database query? The query returns a Deferred object, but this expects 
a callback with only one argument, the result of the query.

Storing them as instance variables of NMEAReceiver does not seem to be 
the right way, since I don't know how long it takes to query the database 
- the relevant GPS information might be overwritten by a new NMEA 
telegram when the connection pool finally triggers the callback

One workaround I've found is to add this information to the SQL query, 
but this seems quite weird to me (and doesn't work in the case that the 
query does not return a result).

A different approach would be to implement a callback with three 
arguments (result, latitude and longitude), and wrap it in a lambda 
function that fills latitude and longitude with the current values.
Would this would be a better way to handle this requirement?

How would you implement this?

Thanks &amp; best regards,

Albert
-- 
Albert Brandl
Weiermayer Solutions GmbH      | Abteistra&#223;e 12, A-4813 Altm&#252;nster
phone: +43 (0) 720 70 30 14    | fax: +43 (0) 7612 20 3 56
web: <A HREF="http://www.weiermayer.com">http://www.weiermayer.com</A>

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023975.html">[Twisted-Python] Weekly Bug Summary
</A></li>
	<LI>Next message: <A HREF="023979.html">[Twisted-Python] Question about using the adbapi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23978">[ date ]</a>
              <a href="thread.html#23978">[ thread ]</a>
              <a href="subject.html#23978">[ subject ]</a>
              <a href="author.html#23978">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
