<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] integrating a python REPL into my	existing	twisted application
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20integrating%20a%20python%20REPL%20into%20my%0A%09existing%09twisted%20application&In-Reply-To=%3C20110526133856.3983.355407659.divmod.xquotient.281%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="056496.html">
   <LINK REL="Next"  HREF="056498.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] integrating a python REPL into my	existing	twisted application</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20integrating%20a%20python%20REPL%20into%20my%0A%09existing%09twisted%20application&In-Reply-To=%3C20110526133856.3983.355407659.divmod.xquotient.281%40localhost.localdomain%3E"
       TITLE="[Twisted-Python] integrating a python REPL into my	existing	twisted application">exarkun at twistedmatrix.com
       </A><BR>
    <I>Thu May 26 07:38:56 MDT 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="056496.html">[Twisted-Python] integrating a python REPL into my existing twisted application
</A></li>
        <LI>Next message (by thread): <A HREF="056498.html">[Twisted-Python] integrating a python REPL into my existing twisted application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56497">[ date ]</a>
              <a href="thread.html#56497">[ thread ]</a>
              <a href="subject.html#56497">[ subject ]</a>
              <a href="author.html#56497">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02:27 am, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rutt.4 at osu.edu</A> wrote:
&gt;<i>Dear twisted-python,
</I>&gt;<i>
</I>&gt;<i>I 19m trying to integrate a python REPL into my existing twisted 8.2.0
</I>&gt;<i>client-side program (which talks to another twisted server running a 
</I>&gt;<i>custom
</I>&gt;<i>protocol).  This client side program uses 
</I>&gt;<i>twisted.internet.stdio.StandardIO
</I>&gt;<i>already to interact with the user, to read commands from the user and 
</I>&gt;<i>send
</I>&gt;<i>them to the server.  What 19s the best way to add functionality to drop 
</I>&gt;<i>into a
</I>&gt;<i>python REPL?  I adapted the doc/core/examples/stdin.py code below to 
</I>&gt;<i>drop
</I>&gt;<i>into the  18code 19 stdlib module to try to model for the mailing list what 
</I>&gt;<i>my
</I>&gt;<i>larger client program is trying to do.  It works fine on linux, until 
</I>&gt;<i>you
</I>&gt;<i>enter a command which outputs a large amount of data, at which point 
</I>&gt;<i>you get
</I>&gt;<i>a  1CResource temporarily unavailable 1D as can be seen below.  I 19m 
</I>&gt;<i>assuming the
</I>&gt;<i>issue is related to StandardIO taking control of reads/writes to the 
</I>&gt;<i>stdio
</I>&gt;<i>file descriptors, and not integrating well with python code that writes
</I>&gt;<i>directly to sys.stderr, but I 19m not sure what the right solution is.
</I>
In addition to what Andrew said, I'll also point out that rather than 
making code that expects blocking writes to stdout work by putting 
stdout back into blocking mode, you can make it work by instead 
providing a stdout which will buffer anything that cannot immediately be 
written non-blockingly.  StandardIO gives you exactly this; its `write` 
knows how to deal with non-blocking descriptors and buffer as necessary. 
This is why manhole doesn't have the same problem as your code calling 
directly into `code.interact`.  For details, 
&lt;<A HREF="http://twistedmatrix.com/trac/browser/trunk/twisted/conch/manhole.py#L45">http://twistedmatrix.com/trac/browser/trunk/twisted/conch/manhole.py#L45</A>&gt;.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="056496.html">[Twisted-Python] integrating a python REPL into my existing twisted application
</A></li>
	<LI>Next message (by thread): <A HREF="056498.html">[Twisted-Python] integrating a python REPL into my existing twisted application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56497">[ date ]</a>
              <a href="thread.html#56497">[ thread ]</a>
              <a href="subject.html#56497">[ subject ]</a>
              <a href="author.html#56497">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
