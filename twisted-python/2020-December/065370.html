<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Logging and SpawnProcess
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Logging%20and%20SpawnProcess&In-Reply-To=%3C6D12404C-4534-4DFA-B9B9-6EC41F8A7ED9%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065369.html">
   <LINK REL="Next"  HREF="065371.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Logging and SpawnProcess</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Logging%20and%20SpawnProcess&In-Reply-To=%3C6D12404C-4534-4DFA-B9B9-6EC41F8A7ED9%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Logging and SpawnProcess">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Dec 30 23:03:15 MST 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065369.html">[Twisted-Python] Logging and SpawnProcess
</A></li>
        <LI>Next message (by thread): <A HREF="065371.html">[Twisted-Python] Logging and SpawnProcess
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65370">[ date ]</a>
              <a href="thread.html#65370">[ thread ]</a>
              <a href="subject.html#65370">[ subject ]</a>
              <a href="author.html#65370">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>One minor point, if this is within your power: don't marshal data over stdout; sometimes libraries scribble on it.  Open an arbitrary additional file descriptor - say, 7 - and put your marshalled data there.

Definitely never use stderr for marshaling anything but lines of text - you're not gonna get away with that :-).  Even well-behaved libraries sometimes dump random text to stderr, that's what it's there for, so you don't do it with stdout!

Subunit has some really interesting ideas here - it's not Twisted code, but it does deal with communicating structured data over stdio streams in such a way that random overzealous SSH MOTD messages won't ruin your day:

<A HREF="https://github.com/testing-cabal/subunit/tree/0e9f67b9683bf2c8c82edb4e511d9b2c7708d900#version-2">https://github.com/testing-cabal/subunit/tree/0e9f67b9683bf2c8c82edb4e511d9b2c7708d900#version-2</A> &lt;<A HREF="https://github.com/testing-cabal/subunit/tree/0e9f67b9683bf2c8c82edb4e511d9b2c7708d900#version-2">https://github.com/testing-cabal/subunit/tree/0e9f67b9683bf2c8c82edb4e511d9b2c7708d900#version-2</A>&gt;

Hope this is helpful,

-g

&gt;<i> On Dec 30, 2020, at 9:12 PM, Tom Most &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twm at freecog.net</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> I'm not entirely following the question (is the log output intermixed with other data on stdout?) but I think that you might find the implementation of twisted.internet.endpoints.ProcessEndpoint a useful example. It relays stderr to the logging stream: <A HREF="https://github.com/twisted/twisted/blob/c8064075a207af1fc9ce19d8f885a986bc5ab00c/src/twisted/internet/endpoints.py#L336-L479">https://github.com/twisted/twisted/blob/c8064075a207af1fc9ce19d8f885a986bc5ab00c/src/twisted/internet/endpoints.py#L336-L479</A> &lt;<A HREF="https://github.com/twisted/twisted/blob/c8064075a207af1fc9ce19d8f885a986bc5ab00c/src/twisted/internet/endpoints.py#L336-L479">https://github.com/twisted/twisted/blob/c8064075a207af1fc9ce19d8f885a986bc5ab00c/src/twisted/internet/endpoints.py#L336-L479</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> ---Tom
</I>&gt;<i> 
</I>&gt;<i> On Wed, Dec 30, 2020, at 11:38 AM, Robert DiFalco wrote:
</I>&gt;&gt;<i> Can anyone point me to some sample code for handling logging with SpawnProcess? Right now I'm using an EchoProtocol that takes stdout and resends it to the log. But it's kludgy because some sub-processes use stdin/stderr for marshaling data. What I'd most like to do is separate data transfer from log output in a clean way. 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A> &lt;mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A> &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>&gt;
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A> &lt;mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>&gt;
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A> &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>&gt;
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20201230/44d59ee1/attachment.htm&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065369.html">[Twisted-Python] Logging and SpawnProcess
</A></li>
	<LI>Next message (by thread): <A HREF="065371.html">[Twisted-Python] Logging and SpawnProcess
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65370">[ date ]</a>
              <a href="thread.html#65370">[ thread ]</a>
              <a href="subject.html#65370">[ subject ]</a>
              <a href="author.html#65370">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
