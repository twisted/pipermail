<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Current twisted dns client just doesn't work
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Current%20twisted%20dns%20client%20just%20doesn%27t%20work&In-Reply-To=%3C2901313.CbtlEUcBR6%40fpbarry%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065323.html">
   <LINK REL="Next"  HREF="065325.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Current twisted dns client just doesn't work</H1>
    <B>Barry Scott</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Current%20twisted%20dns%20client%20just%20doesn%27t%20work&In-Reply-To=%3C2901313.CbtlEUcBR6%40fpbarry%3E"
       TITLE="[Twisted-Python] Current twisted dns client just doesn't work">barry.scott at forcepoint.com
       </A><BR>
    <I>Thu Dec 10 10:30:05 MST 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065323.html">[Twisted-Python] Current twisted dns client just doesn't work
</A></li>
        <LI>Next message (by thread): <A HREF="065325.html">[Twisted-Python] Current twisted dns client just doesn't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65324">[ date ]</a>
              <a href="thread.html#65324">[ thread ]</a>
              <a href="subject.html#65324">[ subject ]</a>
              <a href="author.html#65324">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Answers to but your emails in line.

I've added the twisted list back in so others can comment.

On Wednesday, 9 December 2020 21:17:51 GMT spam tam wrote:
&gt;<i> As additional information you can check how operation system works with dns.
</I>&gt;<i> You can run
</I>&gt;<i> 
</I>&gt;<i> *sudo tcpdump -i lo -v port 53*
</I>&gt;<i> as UDP local sniffer.
</I>
Agreed great tool to debug this stuff with.
And use wireshark to decode the output.

&gt;<i> And run
</I>&gt;<i> 
</I>&gt;<i> *dig google.com &lt;<A HREF="http://google.com">http://google.com</A>&gt;*
</I>&gt;<i> 
</I>&gt;<i> And you will see that it makes A request. Not ANY
</I>
That is the dig default to use A. Use this to do a any query.

   dig google.com any

I checked the man page to see if anything extra can be printed but it looks like
the default is to print everything dig knows how to print. The options only
remove output it seems.

&gt;<i> On Wed, Dec 9, 2020 at 11:42 PM spam tam &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">kuchaspama at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Yes. You are correct. My local dns just is not stable. But try this:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; python3.8 dns_lookup6.py amazon.in
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It provides response:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --- dnsLookupDone ([&lt;RR name=amazon.in type=HINFO class=IN ttl=3599s
</I>&gt;<i> &gt; auth=False&gt;], [], [])
</I>&gt;<i> &gt; --- dnsLookupDone RR &lt;RR name=amazon.in type=HINFO class=IN ttl=3599s
</I>&gt;<i> &gt; auth=False&gt; type 13 payload &lt;HINFO cpu='RFC8482' os='' ttl=3599&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; There are not CNAME, A, AAAA or NS records. This means that current
</I>&gt;<i> &gt; twisted.names.common.extractRecord will not provide IP.
</I>&gt;<i> &gt; What do you think about this? May be we should replace dns ANY request
</I>&gt;<i> &gt; with A and AAAA?
</I>
Now that is interesting because dig returns 54 lines of output from:

   dig amazon.in any

(I won't paste the 54 lines).

I good question is why did twisted not see that huge set of records?

I'd want to understand why twisted is only seeing the HINFO and not all the other
records. Fixing that would, I'm guessing, fix a lot of things.

I'm not sure when I can look at this. Do you want to look at the packets that
twisted sends and receives and compared to dig?

Barry



&gt;<i> &gt;
</I>&gt;<i> &gt; On Wed, Dec 9, 2020 at 12:16 PM Barry Scott &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">barry.scott at forcepoint.com</A>&gt;
</I>&gt;<i> &gt; wrote:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; On Tuesday, 8 December 2020 21:01:56 GMT spam tam wrote:
</I>&gt;<i> &gt; &gt; &gt; I continue to investigate the issue. I try to call your script like
</I>&gt;<i> &gt; this:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; python dns_lookup6.py www.washingtonexaminer.com
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; And get response:
</I>&gt;<i> &gt; &gt; &gt; dnsLookupFailed &lt;twisted.python.failure.Failure
</I>&gt;<i> &gt; &gt; &gt; twisted.names.error.DNSServerError: &lt;Message id=55958 rCode=2
</I>&gt;<i> &gt; &gt; &gt; maxSize=0 flags=answer,recDes,recAv
</I>&gt;<i> &gt; &gt; &gt; queries=[Query('www.washingtonexaminer.com', 255, 1)]&gt;&gt;
</I>&gt;<i> &gt; &gt; &gt; result.value.__dict__ {}
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Is that ok?
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; The output I get is this:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; $ python3.8 dns_lookup6.py www.washingtonexaminer.com
</I>&gt;<i> &gt; &gt; Took: 0.029293
</I>&gt;<i> &gt; &gt; --- dnsLookupDone ([&lt;RR name=www.washingtonexaminer.com type=CNAME
</I>&gt;<i> &gt; class=IN ttl=37s auth=False&gt;], [], [])
</I>&gt;<i> &gt; &gt; --- dnsLookupDone RR &lt;RR name=www.washingtonexaminer.com type=CNAME
</I>&gt;<i> &gt; class=IN ttl=37s auth=False&gt; type 5 payload &lt;CNAME name=
</I>&gt;<i> &gt; 4067e1ed38.10005.sucurifirewall.com ttl=37&gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; And this is the output of dig:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; $ dig www.washingtonexaminer.com
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ; &lt;&lt;&gt;&gt; DiG 9.11.24-RedHat-9.11.24-2.fc32 &lt;&lt;&gt;&gt; www.washingtonexaminer.com
</I>&gt;<i> &gt; &gt; ;; global options: +cmd
</I>&gt;<i> &gt; &gt; ;; Got answer:
</I>&gt;<i> &gt; &gt; ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 61831
</I>&gt;<i> &gt; &gt; ;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ;; OPT PSEUDOSECTION:
</I>&gt;<i> &gt; &gt; ; EDNS: version: 0, flags:; udp: 4000
</I>&gt;<i> &gt; &gt; ;; QUESTION SECTION:
</I>&gt;<i> &gt; &gt; ;www.washingtonexaminer.com.    IN      A
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ;; ANSWER SECTION:
</I>&gt;<i> &gt; &gt; www.washingtonexaminer.com. 599 IN      CNAME
</I>&gt;<i> &gt; 4067e1ed38.10005.sucurifirewall.com.
</I>&gt;<i> &gt; &gt; 4067e1ed38.10005.sucurifirewall.com. 7199 IN A  192.124.249.5
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ;; Query time: 50 msec
</I>&gt;<i> &gt; &gt; ;; SERVER: 10.5.10.11#53(10.5.10.11)
</I>&gt;<i> &gt; &gt; ;; WHEN: Wed Dec 09 09:13:54 GMT 2020
</I>&gt;<i> &gt; &gt; ;; MSG SIZE  rcvd: 117
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Barry
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>



</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065323.html">[Twisted-Python] Current twisted dns client just doesn't work
</A></li>
	<LI>Next message (by thread): <A HREF="065325.html">[Twisted-Python] Current twisted dns client just doesn't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65324">[ date ]</a>
              <a href="thread.html#65324">[ thread ]</a>
              <a href="subject.html#65324">[ subject ]</a>
              <a href="author.html#65324">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
