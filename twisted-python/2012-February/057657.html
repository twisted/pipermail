<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] CopyableFailure fails
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20CopyableFailure%20fails&In-Reply-To=%3C2425488.4tZL83B2Xu%40i5%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="057656.html">
   <LINK REL="Next"  HREF="057732.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] CopyableFailure fails</H1>
    <B>Wolfgang Rohdewald</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20CopyableFailure%20fails&In-Reply-To=%3C2425488.4tZL83B2Xu%40i5%3E"
       TITLE="[Twisted-Python] CopyableFailure fails">wolfgang at rohdewald.de
       </A><BR>
    <I>Mon Feb  6 17:41:20 MST 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="057656.html">[Twisted-Python] CopyableFailure fails
</A></li>
        <LI>Next message (by thread): <A HREF="057732.html">[Twisted-Python] CopyableFailure fails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57657">[ date ]</a>
              <a href="thread.html#57657">[ thread ]</a>
              <a href="subject.html#57657">[ subject ]</a>
              <a href="author.html#57657">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am Montag, 6. Februar 2012, 23:12:29 schrieb <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>:
&gt;<i> On 08:07 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">wolfgang at rohdewald.de</A> wrote:
</I>&gt;<i> &gt;Hi,
</I>&gt;<i> 
</I>&gt;<i> &gt;with twisted 11.0.0 and python 2.7, my error fails here:
</I>&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> Please provide a minimal example reproducing the problem so we can 
</I>&gt;<i> discuss it.  See <A HREF="http://sscce.org/">http://sscce.org/</A> for more details.
</I>
I was hoping it would be self-evident. Trimming this to a short example 
could be rather much work. I hope the full backtrace will help.

anyway I overlooked the fact that two backtraces are printed where
the first on gives me my own calling stack. But the second one
(UnicodeEncodeError) should not happen IMHO, and it does not with my patch.

Unhandled Error
Traceback (most recent call last):
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 1348, in remote_respond
    d = self.portal.login(self, mind, IPerspective)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/cred/portal.py&quot;, line 116, in login
    ).addCallback(self.realm.requestAvatar, mind, *interfaces
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/internet/defer.py&quot;, line 297, in addCallback
    callbackKeywords=kw)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/internet/defer.py&quot;, line 286, in addCallbacks
    self._runCallbacks()
--- &lt;exception caught here&gt; ---
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/internet/defer.py&quot;, line 542, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File &quot;/hdd/pub/src/gitgames/kajongg/src/server.py&quot;, line 956, in requestAvatar
    avatar.attached(mind)
  File &quot;/hdd/pub/src/gitgames/kajongg/src/server.py&quot;, line 908, in attached
    self.server.login(self)
  File &quot;/hdd/pub/src/gitgames/kajongg/src/server.py&quot;, line 717, in login
    self.loadSuspendedTables(user)
  File &quot;/hdd/pub/src/gitgames/kajongg/src/server.py&quot;, line 889, in loadSuspendedTables
    table = Table(self, None, Ruleset.cached(ruleset, used=True), playOpen, autoPlay=False, seed=seed)
  File &quot;/hdd/pub/src/gitgames/kajongg/src/scoringengine.py&quot;, line 77, in cached
    result = Ruleset(name, used)
  File &quot;/hdd/pub/src/gitgames/kajongg/src/scoringengine.py&quot;, line 110, in __init__
    self.initRuleset()
  File &quot;/hdd/pub/src/gitgames/kajongg/src/scoringengine.py&quot;, line 167, in initRuleset
    raise Exception(u'just one unicode char:Ã¤')
exceptions.Exception: Exception(u'just one unicode char:\xe4',)
fail: &lt;twisted.spread.pb.CopyableFailure &lt;type 'exceptions.Exception'&gt;&gt;
Unhandled error in Deferred:
Unhandled Error
Traceback (most recent call last):
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 515, in expressionReceived
    method(*sexp[1:])
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 827, in proto_message
    self._recvMessage(self.localObjectForID, requestID, objectID, message, answerRequired, netArgs, netKw)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 865, in _recvMessage
    callbackArgs=args, errbackArgs=args)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/internet/defer.py&quot;, line 286, in addCallbacks
    self._runCallbacks()
--- &lt;exception caught here&gt; ---
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/internet/defer.py&quot;, line 542, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 896, in _sendFailureOrError
    self._sendFailure(fail, requestID)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 905, in _sendFailure
    self._sendError(fail, requestID)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 921, in _sendError
    self.sendCall(&quot;error&quot;, requestID, self.serialize(fail))
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 764, in serialize
    return jelly(object, self.security, None, self)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/jelly.py&quot;, line 1122, in jelly
    return _Jellier(taster, persistentStore, invoker).jelly(object)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/jelly.py&quot;, line 475, in jelly
    return obj.jellyFor(self)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/flavors.py&quot;, line 299, in jellyFor
    state = self.getStateToCopyFor(p)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/flavors.py&quot;, line 267, in getStateToCopyFor
    return self.getStateToCopy()
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-11.0.0-py2.7-linux-x86_64.egg/twisted/spread/pb.py&quot;, line 407, in getStateToCopy
    state['value'] = str(self.value) # Exception instance
exceptions.UnicodeEncodeError: UnicodeEncodeError('ascii', u'just one unicode char:\xe4', 22, 23, 'ordinal not in range(128)')


-- 
Wolfgang


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="057656.html">[Twisted-Python] CopyableFailure fails
</A></li>
	<LI>Next message (by thread): <A HREF="057732.html">[Twisted-Python] CopyableFailure fails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57657">[ date ]</a>
              <a href="thread.html#57657">[ thread ]</a>
              <a href="subject.html#57657">[ subject ]</a>
              <a href="author.html#57657">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
