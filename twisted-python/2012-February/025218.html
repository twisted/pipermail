<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] pushing out same message on 100k TCPs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20pushing%20out%20same%20message%20on%20100k%20TCPs&In-Reply-To=4F3558A6.7070008%40imperial.ac.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025217.html">
   <LINK REL="Next"  HREF="025223.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] pushing out same message on 100k TCPs</H1>
    <B>Tobias Oberstein</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20pushing%20out%20same%20message%20on%20100k%20TCPs&In-Reply-To=4F3558A6.7070008%40imperial.ac.uk"
       TITLE="[Twisted-Python] pushing out same message on 100k TCPs">tobias.oberstein at tavendo.de
       </A><BR>
    <I>Fri Feb 10 15:20:34 EST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="025217.html">[Twisted-Python] pushing out same message on 100k TCPs
</A></li>
        <LI>Next message: <A HREF="025223.html">[Twisted-Python] pushing out same message on 100k TCPs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25218">[ date ]</a>
              <a href="thread.html#25218">[ thread ]</a>
              <a href="subject.html#25218">[ subject ]</a>
              <a href="author.html#25218">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> &gt; what is the most efficient/performant way of doing the following?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have a short message prepared .. say a string of 100 octets.
</I>&gt;<i> &gt; I want to push out that _same_ string on 100k connected TCPs (on a server).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ==
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; My thinking was: ideally, the 100 bytes would be transferred to
</I>&gt;<i> &gt; kernel/NIC space just _once_, and then the kernel is only told to
</I>&gt;<i> &gt; resend that buffer on the 100k connected TCPs.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Does that make sense, is that even possible, with Twisted, or in general?
</I>&gt;<i> 
</I>&gt;<i> Not really, no.
</I>&gt;<i> 
</I>&gt;<i> The problem is that TCP requires the sender of data to buffer so that it can re-
</I>&gt;<i> send. The only way to store one copy of the data whilst doing this would be to
</I>
Resends -- oh, yes, right. Forgot about that.

&gt;<i> store the socket buffer as a (fairly complex) linked list of reference-counted
</I>&gt;<i> blocks, and use scatter-gather IO to the network card.
</I>
Doesn't a (modern) kernel do something like that for virtual memory pages ie.?

For if processes mmap files or load shared objects, the kernel must keep track
of pages which are needed by active processes.

So in theory, if my message is 1 VM page, kernel could pin that page (make it
non-swappable etc) until all TCP ACKs have arrived ..

&gt;<i> In short; this kind of thing seems easy and desirable but actually it's really hard
</I>
Probably quite hard ..

&gt;<i> and not useful.
</I>
When using VM pages (_if_ that would be possible) and thus no data duplication,
then why not useful?

However I now can see that it's likely outside of what can be done with a stock
kernel .. if it can be done at all anyway ..

Thanks! 

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025217.html">[Twisted-Python] pushing out same message on 100k TCPs
</A></li>
	<LI>Next message: <A HREF="025223.html">[Twisted-Python] pushing out same message on 100k TCPs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25218">[ date ]</a>
              <a href="thread.html#25218">[ thread ]</a>
              <a href="subject.html#25218">[ subject ]</a>
              <a href="author.html#25218">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
