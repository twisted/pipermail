<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] how to get an idle callback while running a	reactor?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20how%20to%20get%20an%20idle%20callback%20while%20running%20a%0A%09reactor%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018905.html">
   <LINK REL="Next"  HREF="018908.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] how to get an idle callback while running a	reactor?</H1>
    <B>Andrew Francis</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20how%20to%20get%20an%20idle%20callback%20while%20running%20a%0A%09reactor%3F&In-Reply-To="
       TITLE="[Twisted-Python] how to get an idle callback while running a	reactor?">andrewfr_ice at yahoo.com
       </A><BR>
    <I>Sat Dec 20 17:13:01 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="018905.html">[Twisted-Python] how to get an idle callback while running a	reactor?
</A></li>
        <LI>Next message: <A HREF="018908.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18907">[ date ]</a>
              <a href="thread.html#18907">[ thread ]</a>
              <a href="subject.html#18907">[ subject ]</a>
              <a href="author.html#18907">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Message: 6
Date: Sat, 20 Dec 2008 08:28:20 -0700
From: Joe Strout &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">joe at strout.net</A>&gt;
Subject: Re: [Twisted-Python] how to get an idle callback while
    running a    reactor?
To: Twisted general discussion &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&gt;
Message-ID: &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">494D0F14.3000105 at strout.net</A>&gt;
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi Joe:

&gt;<i>Well, the thing is that there will actually be a great many things that
</I>&gt;<i>could cause it to need to send a message, such as the time, a change in
</I>&gt;<i>the outside temperature, a certain change in the value of a stock fund,
</I>&gt;<i>etc.  And the AIM interface isn't the only interface to this bot. 
</I>
I would argue all these things can be viewed external events - even time (imagine a clock source is calling your system every N time units). In turn, your programme reacts to the external events.  

At a more concrete level, you have to ask yourself questions like &quot;is my programme a client, a server (or both)? That is, is my programme making connections? Or is it waiting for connections? This will affect how you structure and start-up your application. From I see SkippyTalkBot is a client.

&gt;<i>Now, that does suggest an alternative approach, which is to ignore
</I>&gt;<i>twisted's event/idle mechanisms and use something external to it.  But
</I>&gt;<i>I'm also fairly newish to Python, so I'm not sure exactly how to do that
</I>&gt;<i>either -- reactor.run() is a blocking call, so I supposed I'd have to
</I>&gt;<i>use threads.
</I>
Yes under the hood reactor.run() blocks. However the reactor is what effectively starts a Twisted application. I would argue that under most circumstances, you probably don't care that the reactor blocks because your application isn't doing anything until it receives an event from the reactor. As for threads. Off hand, I suspect you don't need threads .....

&gt;<i>But if there's a simple way to do this within Twisted, I'd like to learn
</I>&gt;<i>what that is
</I>
Let us pretend your programme polls various network sources at regular intervals. So perhaps your code could look like:

if __name__ == &quot;__main__&quot;:
   # it may be helpful to keep track of the task objects
   source['source-a] = task.LoopingCall(callback-for-stockTicker, ...)
   source['source-b] = task.loopingCall(callback-for-thermostat, ...)
   source['source-c] = task.loopingCall(callback-for-timer, ....)

   for source in sources:
       source.start(someInterval, True | False)
   reactor.run()

and each callback-for-X sets up the appropriate call to the remove source and its callback chain.

# assume we are using SOAP
def callback-for-stockTicker():
    ticker = soap.Proxy(....)
    ticker.callRemote(....).addCallback().addErrback()


Cheers,
Andrew










      


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018905.html">[Twisted-Python] how to get an idle callback while running a	reactor?
</A></li>
	<LI>Next message: <A HREF="018908.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18907">[ date ]</a>
              <a href="thread.html#18907">[ thread ]</a>
              <a href="subject.html#18907">[ subject ]</a>
              <a href="author.html#18907">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
