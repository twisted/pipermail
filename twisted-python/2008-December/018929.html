<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: A question about ITransport.write()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20A%20question%20about%20ITransport.write%28%29&In-Reply-To=20081228071317.GA24777%40steerpike.home.puzzling.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018928.html">
   <LINK REL="Next"  HREF="018926.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: A question about ITransport.write()</H1>
    <B>Lian Cheng</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20A%20question%20about%20ITransport.write%28%29&In-Reply-To=20081228071317.GA24777%40steerpike.home.puzzling.org"
       TITLE="[Twisted-Python] Re: A question about ITransport.write()">rhythm.mail at gmail.com
       </A><BR>
    <I>Sun Dec 28 04:01:50 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="018928.html">[Twisted-Python] A question about ITransport.write()
</A></li>
        <LI>Next message: <A HREF="018926.html">[Twisted-Python] Twisted and Urwid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18929">[ date ]</a>
              <a href="thread.html#18929">[ thread ]</a>
              <a href="subject.html#18929">[ subject ]</a>
              <a href="author.html#18929">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Andrew!

Andrew Bennetts &#20889;&#36947;:
&gt;<i> Lian Cheng wrote:
</I>&gt;&gt;<i> Hi, all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As a Twisted newbie, I read the Twisted documentation, and found that:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   1. ITransport.write() doesn't return a deferred.
</I>&gt;&gt;<i>   2. IProtocol doesn't have a dataSent() callback or something alike.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Since ITransport.write() is a non-blocking call, how can I be informed  
</I>&gt;&gt;<i> when data sent by ITransport.write() is actually sent successfully?
</I>&gt;<i> 
</I>&gt;<i> It depends on what exactly you mean by &quot;successfully&quot;.  Just because Twisted
</I>&gt;<i> has delivered the bytes to the OS for delivery (e.g. via the send(2)
</I>&gt;<i> syscall) doesn't mean they'll actually arrive at your intended destination.
</I>&gt;<i> 
</I>&gt;<i> So,
</I>&gt;<i> 
</I>&gt;<i> If you want to know if the bytes have arrived, get the remote side to send
</I>&gt;<i> back an explicit ACK of some sort.
</I>
I was actually confused by the words written in the documentation:

     If possible, make sure that it is all written. No data will ever be 
lost, although (obviously) the connection may be closed before it all 
gets through.

Seems here the documentation means that the connection may be closed due 
to some fatal errors such as network cable unplugged rather than calling 
ITransport.loseConnection().

&gt;<i> 
</I>&gt;<i> If you want to know when the send buffer[1] isn't full anymore, so that you
</I>&gt;<i> can start working to fill it again, implement a pull producer
</I>&gt;<i> &lt;<A HREF="http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4">http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4</A>&gt;
</I>&gt;<i> and call the transport's registerProducer method with it.
</I>
Seems like what I'm looking for :-)

&gt;<i> 
</I>&gt;<i> If you want something else, reply and tell us what :)
</I>
Thanks a lot again :-)

&gt;<i> 
</I>&gt;<i> -Andrew.
</I>&gt;<i> 
</I>&gt;<i> [1] &#8220;send buffer&#8221; is fairly loose terminology, but it'll do.
</I>
&gt;<i> Lian Cheng wrote:
</I>&gt;&gt;<i> Hi, all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As a Twisted newbie, I read the Twisted documentation, and found that:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   1. ITransport.write() doesn't return a deferred.
</I>&gt;&gt;<i>   2. IProtocol doesn't have a dataSent() callback or something alike.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Since ITransport.write() is a non-blocking call, how can I be informed  
</I>&gt;&gt;<i> when data sent by ITransport.write() is actually sent successfully?
</I>&gt;<i> 
</I>&gt;<i> It depends on what exactly you mean by &quot;successfully&quot;.  Just because Twisted
</I>&gt;<i> has delivered the bytes to the OS for delivery (e.g. via the send(2)
</I>&gt;<i> syscall) doesn't mean they'll actually arrive at your intended destination.
</I>&gt;<i> 
</I>&gt;<i> So,
</I>&gt;<i> 
</I>&gt;<i> If you want to know if the bytes have arrived, get the remote side to send
</I>&gt;<i> back an explicit ACK of some sort.
</I>&gt;<i> 
</I>&gt;<i> If you want to know when the send buffer[1] isn't full anymore, so that you
</I>&gt;<i> can start working to fill it again, implement a pull producer
</I>&gt;<i> &lt;<A HREF="http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4">http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4</A>&gt;
</I>&gt;<i> and call the transport's registerProducer method with it.
</I>&gt;<i> 
</I>&gt;<i> If you want something else, reply and tell us what :)
</I>&gt;<i> 
</I>&gt;<i> -Andrew.
</I>&gt;<i> 
</I>&gt;<i> [1] &#8220;send buffer&#8221; is fairly loose terminology, but it'll do.
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018928.html">[Twisted-Python] A question about ITransport.write()
</A></li>
	<LI>Next message: <A HREF="018926.html">[Twisted-Python] Twisted and Urwid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18929">[ date ]</a>
              <a href="thread.html#18929">[ thread ]</a>
              <a href="subject.html#18929">[ subject ]</a>
              <a href="author.html#18929">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
