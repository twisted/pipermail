<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Non-blocking http client?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Non-blocking%20http%20client%3F&In-Reply-To=3d381e170812131008m993e220jd586d63097d1b192%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018861.html">
   <LINK REL="Next"  HREF="018862.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Non-blocking http client?</H1>
    <B>Denis Bilenko</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Non-blocking%20http%20client%3F&In-Reply-To=3d381e170812131008m993e220jd586d63097d1b192%40mail.gmail.com"
       TITLE="[Twisted-Python] Non-blocking http client?">denis.bilenko at gmail.com
       </A><BR>
    <I>Sun Dec 14 12:58:58 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="018861.html">[Twisted-Python] Non-blocking http client?
</A></li>
        <LI>Next message: <A HREF="018862.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18863">[ date ]</a>
              <a href="thread.html#18863">[ thread ]</a>
              <a href="subject.html#18863">[ subject ]</a>
              <a href="author.html#18863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been working on eventlet-twisted integration and it includes a drop-in
replacements for standard Python modules (including urllib and httplib) that
do not block the reactor.

There was no release yet and there're no documentation written.
(You can find the documentation for the original eventlet here
<A HREF="http://wiki.secondlife.com/wiki/Eventlet,">http://wiki.secondlife.com/wiki/Eventlet,</A>
however, not all of it is applicable. You can also read the
documentation of greenlet here
<A HREF="http://codespeak.net/py/dist/greenlet.html">http://codespeak.net/py/dist/greenlet.html</A>)

However, usage is very simple.
1. add this line before using any eventlet functions
from eventlet.twistedutil import join_reactor
2. import eventlet.green.urllib instead of urllib
3. Use eventlet.twistedutil.deferToGreenThread function to make
&quot;blocking&quot; functions
from eventlet.green.urllib return Deferred.

Here's an example on how to use eventlet.green.httplib and twisted's
LineReceiver
together to build a toy http proxy:

<A HREF="http://devel.ag-projects.com/~denis/cgi-bin/hgweb.cgi/file/097d879e0228/examples/twisted_http_proxy.py">http://devel.ag-projects.com/~denis/cgi-bin/hgweb.cgi/file/097d879e0228/examples/twisted_http_proxy.py</A>

To get the repository:

hg clone <A HREF="http://devel.ag-projects.com/~denis/cgi-bin/hgweb.cgi/eventlet_twisted">http://devel.ag-projects.com/~denis/cgi-bin/hgweb.cgi/eventlet_twisted</A>

The only dependency is py.magic.greenlet from py library.
The code is only tested on python2.5 linux &amp; macos so it probably won't work
on python2.4/windows but that will be fixed sometime in the future.

On Sun, Dec 14, 2008 at 12:08 AM, Erik Wickstrom &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">erik at erikwickstrom.com</A>&gt; wrote:
&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I have an application that is doing some web spidering.  Right now I'm
</I>&gt;<i> using urllib to retrieve the URLs, but it is painfully slow.  I was
</I>&gt;<i> wondering if it's feasible to swap out urllib with a twisted client
</I>&gt;<i> that uses deferds so I can process urls in a more &quot;parallel&quot; fashion?
</I>&gt;<i>
</I>&gt;<i> I've done a bunch of Googleing, but I haven't come across anything
</I>&gt;<i> that I can use as a drop in replacement.   If you can point me in the
</I>&gt;<i> right direction I'd really appreciate it!
</I>&gt;<i>
</I>&gt;<i> Thanks for your help!
</I>&gt;<i> Erik
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018861.html">[Twisted-Python] Non-blocking http client?
</A></li>
	<LI>Next message: <A HREF="018862.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18863">[ date ]</a>
              <a href="thread.html#18863">[ thread ]</a>
              <a href="subject.html#18863">[ subject ]</a>
              <a href="author.html#18863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
