<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Proposal: changes to reactor.clientTCP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Proposal%3A%20changes%20to%20reactor.clientTCP&In-Reply-To=20020618.234847.123286215.glyph%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001233.html">
   <LINK REL="Next"  HREF="001246.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Proposal: changes to reactor.clientTCP</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Proposal%3A%20changes%20to%20reactor.clientTCP&In-Reply-To=20020618.234847.123286215.glyph%40twistedmatrix.com"
       TITLE="[Twisted-Python] Proposal: changes to reactor.clientTCP">tv at twistedmatrix.com
       </A><BR>
    <I>Fri Jun 21 15:04:08 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001233.html">[Twisted-Python] Proposal: changes to reactor.clientTCP
</A></li>
        <LI>Next message: <A HREF="001246.html">[Twisted-Python] Proposal: changes to reactor.clientTCP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1243">[ date ]</a>
              <a href="thread.html#1243">[ thread ]</a>
              <a href="subject.html#1243">[ subject ]</a>
              <a href="author.html#1243">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Glyph Lefkowitz &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; writes:

&gt;<i> &gt; &gt; 	Please do not clobber the information given by the
</I>&gt;<i> &gt; &gt;         kernel in errno. Translating errno to 2 different failures
</I>&gt;<i> &gt; &gt;         is not nice.
</I>&gt;<i> 
</I>&gt;<i> &gt; It needs to be clobbered, at least in some sense, for portability.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Jython does not have errno and win32's support for it is very weak.
</I>&gt;<i> 
</I>&gt;<i> Reading this a few hours later, I think my tone was wrong and I was altogether
</I>&gt;<i> too brief here. :-).  To rephrase in a more constructive manner:
</I>&gt;<i> 
</I>&gt;<i> I believe that it needs to be clobbered, and some information lost, because I
</I>&gt;<i> don't see any other way to retain portability.  Also, we're losing information
</I>&gt;<i> already, since errno is used to report things that aren't &quot;errors&quot; in the
</I>&gt;<i> Twisted worldview (or at least, not errors that the user can deal with
</I>&gt;<i> directly).  Jython and win32 both have error-reporting mechanisms; Jython's is
</I>&gt;<i> exceptions, win32 is a sort of wacked-out informal errno.  Can you think of a
</I>&gt;<i> few primitive errors that we should support, rather than just the 2 types?
</I>&gt;<i> (I'd rather use Failure than just integer error codes, personally.)
</I>&gt;<i> 
</I>&gt;<i> I think that if we're going to add a new error reporting mechanism we need to
</I>&gt;<i> do it carefully so that we don't miss the same kind of information that we did
</I>&gt;<i> the last time we architected this API.  (Protocol.connectionLost used to take
</I>&gt;<i> an integer error code which was one of these two errors; that was a bad idea,
</I>&gt;<i> too).
</I>&gt;<i> 
</I>&gt;<i> Thanks for your feedback.  Does anybody have a solution?
</I>
	Allow portable programs to get a &quot;sanitized version&quot;, but
        allow my POSIX-only programs get errno. For what kind of
        sanitization one might want, you probably want to look at the
        man page for say connect(2) for all the possible error cases,
        and categorize them based on local/remote, temporary/permanent,
        etc., and create a &quot;high-level error&quot; for each class, with
        perhaps the string corresponding to the errno as extra info
        meant for users (and not if statements).

        But please do _not_ loose any information in the translation.
        Say people shouldn't look at the error objects errno attribute
        to decide what to do, as not all platforms provide it. But
        don't hide the actual error.

        Remember my background; I'm a kernel hacker, and I know the
        UNIX libc/kernel API. If I run a program that tries to
        e.g. connect with TCP, and it fails without giving me a good
        reason, I _will_ run it under strace -e trace=connect just to
        see whether connect failed, and with what errno. Operating
        systems without BSD sockets just aren't, and I write my
        programs to use fork anyway. My point -- don't decide for me,
        let me decide on my own.

-- 
tv@{{hq.yok.utu,havoc,gaeshido}.fi,{debian,wanderer}.org,stonesoft.com}
double a,b=4,c;main(){for(;++a&lt;2e6;c-=(b=-b)/a++);printf(&quot;%f\n&quot;,c);}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001233.html">[Twisted-Python] Proposal: changes to reactor.clientTCP
</A></li>
	<LI>Next message: <A HREF="001246.html">[Twisted-Python] Proposal: changes to reactor.clientTCP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1243">[ date ]</a>
              <a href="thread.html#1243">[ thread ]</a>
              <a href="subject.html#1243">[ subject ]</a>
              <a href="author.html#1243">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
