<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Proposal: changes to reactor.clientTCP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Proposal%3A%20changes%20to%20reactor.clientTCP&In-Reply-To=%3C20020621.185923.75772697.glyph%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="033751.html">
   <LINK REL="Next"  HREF="033755.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Proposal: changes to reactor.clientTCP</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Proposal%3A%20changes%20to%20reactor.clientTCP&In-Reply-To=%3C20020621.185923.75772697.glyph%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Proposal: changes to reactor.clientTCP">glyph at twistedmatrix.com
       </A><BR>
    <I>Fri Jun 21 17:59:23 MDT 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="033751.html">[Twisted-Python] Proposal: changes to reactor.clientTCP
</A></li>
        <LI>Next message (by thread): <A HREF="033755.html">[Twisted-Python] Proposal: changes to reactor.clientTCP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33754">[ date ]</a>
              <a href="thread.html#33754">[ thread ]</a>
              <a href="subject.html#33754">[ subject ]</a>
              <a href="author.html#33754">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
From: Tommi Virtanen &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">tv at twistedmatrix.com</A>&gt;
Subject: Re: [Twisted-Python] Proposal: changes to reactor.clientTCP
Date: 21 Jun 2002 22:04:08 +0300

&gt;<i> Allow portable programs to get a &quot;sanitized version&quot;, but allow my POSIX-only
</I>&gt;<i> programs get errno. For what kind of sanitization one might want, you
</I>&gt;<i> probably want to look at the man page for say connect(2) for all the possible
</I>&gt;<i> error cases, and categorize them based on local/remote, temporary/permanent,
</I>&gt;<i> etc., and create a &quot;high-level error&quot; for each class, with perhaps the string
</I>&gt;<i> corresponding to the errno as extra info meant for users (and not if
</I>&gt;<i> statements).
</I>
&gt;<i> But please do _not_ loose any information in the translation.  Say people
</I>&gt;<i> shouldn't look at the error objects errno attribute to decide what to do, as
</I>&gt;<i> not all platforms provide it. But don't hide the actual error.
</I>
Upon consideration I strongly agree that no information should be lost.

So, let's have such a high-level error, and a .platformError attribute on the
connection error object which is an object specific to the &quot;OS&quot; that you're
running under.  On POSIX this will be (or contain) an errno error code, but on
Jython and elsewhere it will be whatever's appropriate.  Does that work for
you?

&gt;<i> Remember my background; I'm a kernel hacker, and I know the UNIX libc/kernel
</I>&gt;<i> API. If I run a program that tries to e.g. connect with TCP, and it fails
</I>&gt;<i> without giving me a good reason, I _will_ run it under strace -e
</I>&gt;<i> trace=connect just to see whether connect failed, and with what
</I>&gt;<i> errno. Operating systems without BSD sockets just aren't, and I write my
</I>&gt;<i> programs to use fork anyway. My point -- don't decide for me, let me decide
</I>&gt;<i> on my own.
</I>
The reason I'm resistent to this is that I would like to encourage writing
portable programs with Twisted, especially in cases where platform specificity
doesn't add any functionality.  On the other hand, I don't want to be Java here
and try to _force_ programmers to write their programmers in a portable way
when they really know better than I do what they want.

Problem is, programmers rarely know what they want.  For example; if you're
using Twisted, why use fork?  You ought to be using reactor.spawnProcess for
non-portability-related reasons anyway; Python's refcounting doesn't work
reliably with COW memory.  Of course, there are reasons not to do this; of
course, there are times when you just _need_ to get down to the OS and do
something in a very, very platform specific way (sometimes even specific to
your particular OS vendor, not just POSIX).  This should not be the default.

Handling an errno error code specifically should also be considered a *very*
esoteric operation.  I personally can't come up with any need to use it except
debugging under a particular environment; I would far rather that people used
to the POSIX API learned how to use the Twisted APIs to do POSIX-y things, so
that their programs would be more portable.  

Balancing this with the need not to piss people off is difficult :-).  I can't
think of a way to say &quot;DON'T USE .platformError UNLESS YOU REALLY NEED IT,
WHICH YOU DON'T&quot; without making everybody read the documentation, which they
won't anyway.  I can imagine many programs made non-portable by someone looking
for the answer to the question &quot;how do I find the errno of what happened&quot;
rather than the correct question &quot;how do I handle a connection error&quot;.

So I guess I'll provide the platform specific information and put my faith in
the worldview of applications programmers; please try to give them good
examples to look at :)


-- 
 |    &lt;`'&gt;    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   &lt; _/ &gt;   |  Lead Developer,  the Twisted project  |
 |  &lt; ___/ &gt;  |      <A HREF="http://www.twistedmatrix.com">http://www.twistedmatrix.com</A>      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20020621/254e5b2f/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="033751.html">[Twisted-Python] Proposal: changes to reactor.clientTCP
</A></li>
	<LI>Next message (by thread): <A HREF="033755.html">[Twisted-Python] Proposal: changes to reactor.clientTCP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33754">[ date ]</a>
              <a href="thread.html#33754">[ thread ]</a>
              <a href="subject.html#33754">[ subject ]</a>
              <a href="author.html#33754">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
