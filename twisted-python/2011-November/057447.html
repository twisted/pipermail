<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Log output formatting (was Re: logging	question)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Log%20output%20formatting%20%28was%20Re%3A%20logging%0A%09question%29&In-Reply-To=%3C20111130040722.GA3713%40boombah.thristian.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="057446.html">
   <LINK REL="Next"  HREF="057448.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Log output formatting (was Re: logging	question)</H1>
    <B>Tim Allen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Log%20output%20formatting%20%28was%20Re%3A%20logging%0A%09question%29&In-Reply-To=%3C20111130040722.GA3713%40boombah.thristian.org%3E"
       TITLE="[Twisted-Python] Log output formatting (was Re: logging	question)">screwtape at froup.com
       </A><BR>
    <I>Tue Nov 29 21:07:22 MST 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="057446.html">[Twisted-Python] Log output formatting (was Re: logging	question)
</A></li>
        <LI>Next message (by thread): <A HREF="057448.html">[Twisted-Python] Log output formatting (was Re: logging	question)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57447">[ date ]</a>
              <a href="thread.html#57447">[ thread ]</a>
              <a href="subject.html#57447">[ subject ]</a>
              <a href="author.html#57447">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Nov 29, 2011 at 10:44:21AM -0800, Don Dwiggins wrote:
&gt;<i> Looking at the source of log.py, I'm at a bit of a loss to reconcile 
</I>&gt;<i> these two forces.  Certainly, the two log observers implemented there 
</I>&gt;<i> use textFromEventDict, but one could create a different observer that 
</I>&gt;<i> does things entirely differently.
</I>&gt;<i> 
</I>&gt;<i> The best idea I can come up with is, in the documentation for msg, refer 
</I>&gt;<i> to the documentation for the chosen log observer; then, in each log 
</I>&gt;<i> observer's documentation, describe how the formatting is done, either 
</I>&gt;<i> explicitly, or by reference to textFromEventDict.  (And maybe in the 
</I>&gt;<i> documentation for ILogObserver, recommend strongly that each 
</I>&gt;<i> implementation be explicit about message formatting.)  There should 
</I>&gt;<i> probably also be something in the logging howto.
</I>&gt;<i> 
</I>&gt;<i> Any better suggestions?
</I>
While not every log observer needs to flatten a log event dict into
a string, that particular approach is probably common enough that it
deserves a simple solution. I think, in my ideal world, there would be
a LogMessage class that inherits from dict, with a __str__ method that
looks something like:

    def __str__(self):
	if &quot;msg&quot; in self:
	    return self[&quot;msg&quot;]
	elif &quot;format&quot; in self:
	    return self[&quot;format&quot;] % self
	else return dict.__str__(self)

If the standard Twisted logging functions automatically constructed
LogMessage instances from dict instances, it should be easy enough for
future ILogObserver implementations to do the right thing (by just
calling str(msg)). Of course, they could also do more sophisticated
things like pulling particular keys out of the message to set
observer-specific message properties (like syslog channel and severity,
etc.)

The documentation for the standard Twisted logging functions could then
just point to the LogMessage documentation to describe what goes into
a log event and how it gets interpreted, with a footnote to the effect
that different log observers can handle the same message in different
ways.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="057446.html">[Twisted-Python] Log output formatting (was Re: logging	question)
</A></li>
	<LI>Next message (by thread): <A HREF="057448.html">[Twisted-Python] Log output formatting (was Re: logging	question)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57447">[ date ]</a>
              <a href="thread.html#57447">[ thread ]</a>
              <a href="subject.html#57447">[ subject ]</a>
              <a href="author.html#57447">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
