<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] data dispatch on massive connection counts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20data%20dispatch%20on%20massive%20connection%20counts&In-Reply-To=%3C634914A010D0B943A035D226786325D42D0C264714%40EXVMBX020-12.exch020.serverdata.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="057357.html">
   <LINK REL="Next"  HREF="057359.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] data dispatch on massive connection counts</H1>
    <B>Tobias Oberstein</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20data%20dispatch%20on%20massive%20connection%20counts&In-Reply-To=%3C634914A010D0B943A035D226786325D42D0C264714%40EXVMBX020-12.exch020.serverdata.net%3E"
       TITLE="[Twisted-Python] data dispatch on massive connection counts">tobias.oberstein at tavendo.de
       </A><BR>
    <I>Mon Nov 14 07:57:21 MST 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="057357.html">[Twisted-Python] data dispatch on massive connection counts
</A></li>
        <LI>Next message (by thread): <A HREF="057359.html">[Twisted-Python] data dispatch on massive connection counts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57358">[ date ]</a>
              <a href="thread.html#57358">[ thread ]</a>
              <a href="subject.html#57358">[ subject ]</a>
              <a href="author.html#57358">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> &gt; 2) Too many files.
</I>&gt;<i> &gt; Is there another limit specifically for files, and/or something tunable in
</I>&gt;<i> Python/Twisted?
</I>&gt;<i> 
</I>&gt;<i> That's definitely not a limit on Python or Twisted. That's an OS limit.
</I>&gt;<i> Are you opening lots of files in addition to your sockets?
</I>
Python open() will bail out at 32768 open files.

This despite the fact that 

a) resource.getrlimit(resource.RLIMIT_NOFILE) = 200k
b) I can accept 50k sockets

Obviously, it's at least not Twisted related ..

=========

import resource

max = resource.getrlimit(resource.RLIMIT_NOFILE)
cnt = 0
print &quot;maximum FDs&quot;, max

fds = []

while cnt &lt; max:
   f = open(&quot;/tmp/test_%d&quot; % cnt, &quot;w&quot;)
   f.write(&quot;test&quot;)
   fds.append(f)
   cnt += 1
   if cnt % 1000 == 0:
      print &quot;opened %d files&quot; % cnt

print &quot;ok, created %d files&quot; % cnt

=========

maximum FDs (200000L, 200000L)
opened 1000 files
opened 2000 files
opened 3000 files
opened 4000 files
opened 5000 files
opened 6000 files
opened 7000 files
opened 8000 files
opened 9000 files
opened 10000 files
opened 11000 files
opened 12000 files
opened 13000 files
opened 14000 files
opened 15000 files
opened 16000 files
opened 17000 files
opened 18000 files
opened 19000 files
opened 20000 files
opened 21000 files
opened 22000 files
opened 23000 files
opened 24000 files
opened 25000 files
opened 26000 files
opened 27000 files
opened 28000 files
opened 29000 files
opened 30000 files
opened 31000 files
opened 32000 files
Traceback (most recent call last):
  File &quot;/home/autobahn/fdtest.py&quot;, line 10, in &lt;module&gt;
IOError: [Errno 24] Too many open files: '/tmp/test_32765'
^C
[<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">autobahn at autobahnhub</A> ~/AutobahnHub/service/autobahnhub/script]$



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="057357.html">[Twisted-Python] data dispatch on massive connection counts
</A></li>
	<LI>Next message (by thread): <A HREF="057359.html">[Twisted-Python] data dispatch on massive connection counts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57358">[ date ]</a>
              <a href="thread.html#57358">[ thread ]</a>
              <a href="subject.html#57358">[ subject ]</a>
              <a href="author.html#57358">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
