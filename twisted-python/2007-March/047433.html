<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] using a reactor in a loop
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20using%20a%20reactor%20in%20a%20loop&In-Reply-To=%3C45E74E43.1070005%40densedata.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047430.html">
   <LINK REL="Next"  HREF="047434.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] using a reactor in a loop</H1>
    <B>Johann Borck</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20using%20a%20reactor%20in%20a%20loop&In-Reply-To=%3C45E74E43.1070005%40densedata.com%3E"
       TITLE="[Twisted-Python] using a reactor in a loop">johann.borck at densedata.com
       </A><BR>
    <I>Thu Mar  1 15:05:55 MST 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047430.html">[Twisted-Python] using a reactor in a loop
</A></li>
        <LI>Next message (by thread): <A HREF="047434.html">[Twisted-Python] Help -- can't install Twisted/Zope on x86_64	(RHEL5-beta)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47433">[ date ]</a>
              <a href="thread.html#47433">[ thread ]</a>
              <a href="subject.html#47433">[ subject ]</a>
              <a href="author.html#47433">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tom Brown wrote:
&gt;<i>
</I>&gt;<i> My goal is this:
</I>&gt;<i> 1) do specific tasks
</I>&gt;<i> 2) run the server and wait for a connection
</I>&gt;<i> 3) when a connection is made, do tasks as instructed by the client in the 
</I>&gt;<i> AqapProtocol code.
</I>&gt;<i> 4) when connection is lost, close server and go back to 1)
</I>&gt;<i>
</I>&gt;<i> Shutting down the server is not necessary if I could get past the 
</I>&gt;<i> reactor.run(). A previous post suggested I use deferreds. So, that is 
</I>&gt;<i> probably what I need to. I just need to learn how to use them.
</I>&gt;<i>
</I>&gt;<i>   
</I>
There's really good documentation about twisted and its event-driven 
programming model, there you'll find what you're looking for. in twisted 
you never &quot;get past&quot; the reactor.run() (until you quit the application), 
everything is done inside its loop. so when using twisted you should 
rather consider this:

1) run the event-loop
2) do specific tasks (if you need to complete long running tasks, you could use deferToThread or a pool of threads, to keep your event-loop responsive ) 
3) setup listener for connections (now you have your server)
4) when a connection is made, do tasks as instructed by the client in the 
AqapProtocol code.
5) if really necessary, stop listening for/refuse connections without stopping the eventloop, but maybe it's better to return a &quot;service suspended, come back later&quot; kind of message
6) goto 2) 

AFAIK twisted doesn't support restarting the reactor, there're some issues with cleaning up the state. But when you get used to it, you'll never feel the need to do that anyway, which might be the main reason why it's neither supported nor really discussed. You can do anything you want while the reactor is running. 

Johann


&gt;<i> Thanks,
</I>&gt;<i> Tom
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>   
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047430.html">[Twisted-Python] using a reactor in a loop
</A></li>
	<LI>Next message (by thread): <A HREF="047434.html">[Twisted-Python] Help -- can't install Twisted/Zope on x86_64	(RHEL5-beta)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47433">[ date ]</a>
              <a href="thread.html#47433">[ thread ]</a>
              <a href="subject.html#47433">[ subject ]</a>
              <a href="author.html#47433">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
