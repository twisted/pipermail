<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] newbe twisted xmpp load
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20newbe%20twisted%20xmpp%20load&In-Reply-To=5A9F82CC-6B5D-4DFB-A7AF-F7D9364E4F04%40cox.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014972.html">
   <LINK REL="Next"  HREF="014998.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] newbe twisted xmpp load</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20newbe%20twisted%20xmpp%20load&In-Reply-To=5A9F82CC-6B5D-4DFB-A7AF-F7D9364E4F04%40cox.net"
       TITLE="[Twisted-Python] newbe twisted xmpp load">exarkun at divmod.com
       </A><BR>
    <I>Sun Mar 11 21:02:31 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="014972.html">[Twisted-Python] newbe twisted xmpp load
</A></li>
        <LI>Next message: <A HREF="014998.html">[Twisted-Python] newbe twisted xmpp load
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14973">[ date ]</a>
              <a href="thread.html#14973">[ thread ]</a>
              <a href="subject.html#14973">[ subject ]</a>
              <a href="author.html#14973">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 11 Mar 2007 19:43:15 -0400, Wrene Robyn &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">wrobyn at cox.net</A>&gt; wrote:
&gt;<i>Thanks for all your help thus far. Here is my code which does run  with 
</I>&gt;<i>normal select reactor. How to switch it to use poll reactor?  that is really 
</I>&gt;<i>the crux of my problem.
</I>
As in my previous post, you switch it to the poll reactor by importing and installing the poll reactor before the default reactor is imported and installed.  You can do this by adding these two lines:

    from twisted.internet import pollreactor
    pollreactor.install()

to the program anywhere before the default reactor is imported.  For example, you could add them before the &quot;import sys&quot; line.

&gt;<i>
</I>&gt;<i>import sys
</I>&gt;<i>import socket
</I>&gt;<i>import time
</I>&gt;<i>import resource
</I>&gt;<i>from threading import Thread
</I>&gt;<i>from twisted.words.protocols.jabber import client, jid
</I>&gt;<i>from twisted.words.xish import domish
</I>&gt;<i>from twisted.internet import reactor
</I>&gt;<i>
</I>&gt;<i>resource.setrlimit(8,[65000,65000])
</I>&gt;<i>class testit():
</I>&gt;<i>
</I>&gt;<i>     def authd(xmlstream):
</I>&gt;<i>         print &quot;authenticated&quot;
</I>&gt;<i>
</I>&gt;<i>         presence = domish.Element(('jabber:client','presence'))
</I>&gt;<i>         xmlstream.send(presence)
</I>&gt;<i>     #xmlstream.addObserver('/message',  debug)
</I>&gt;<i>     #xmlstream.addObserver('/presence', debug)
</I>&gt;<i>     #xmlstream.addObserver('/iq',       debug)
</I>&gt;<i>
</I>&gt;<i>     def debug(elem):
</I>&gt;<i>         print elem.toXml().encode('utf-8')
</I>&gt;<i>         print &quot;=&quot;*20
</I>
Note that this code:

&gt;<i>     for i in range(1,2000):
</I>&gt;<i>         print i
</I>&gt;<i>         myJid = jid.JID(str(i)+'@jbrsrvrnamt/twisted_words')
</I>&gt;<i>         factory = client.basicClientFactory(myJid, 'test')
</I>&gt;<i>         factory.addBootstrap('//event/stream/authd',authd)
</I>&gt;<i>         reactor.connectTCP('jbrsrvrname',5222,factory)
</I>&gt;<i>
</I>&gt;<i>     reactor.run()
</I>
is all at the class definition level, so it is executed when the class
is defined.  This means you are starting the reactor before the class
definition has even completed.  You probably don't want to do this.  All
the code after this point doesn't even get a chance to run until the
reactor stops.

&gt;<i>
</I>&gt;<i>current = testit()
</I>&gt;<i>current.start()
</I>&gt;<i>
</I>
Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014972.html">[Twisted-Python] newbe twisted xmpp load
</A></li>
	<LI>Next message: <A HREF="014998.html">[Twisted-Python] newbe twisted xmpp load
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14973">[ date ]</a>
              <a href="thread.html#14973">[ thread ]</a>
              <a href="subject.html#14973">[ subject ]</a>
              <a href="author.html#14973">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
