<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] newbe twisted xmpp load
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20newbe%20twisted%20xmpp%20load&In-Reply-To=%3C63EAC33B-9D6C-4C8E-84A6-D595AAD62061%40cox.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047464.html">
   <LINK REL="Next"  HREF="047467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] newbe twisted xmpp load</H1>
    <B>Wrene Robyn</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20newbe%20twisted%20xmpp%20load&In-Reply-To=%3C63EAC33B-9D6C-4C8E-84A6-D595AAD62061%40cox.net%3E"
       TITLE="[Twisted-Python] newbe twisted xmpp load">wrobyn at cox.net
       </A><BR>
    <I>Fri Mar  9 14:34:47 MST 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047464.html">[Twisted-Python] newbe twisted xmpp load
</A></li>
        <LI>Next message (by thread): <A HREF="047467.html">[Twisted-Python] newbe twisted xmpp load
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47466">[ date ]</a>
              <a href="thread.html#47466">[ thread ]</a>
              <a href="subject.html#47466">[ subject ]</a>
              <a href="author.html#47466">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>and for some reason from twisted.words.protocols.jabber.jid
imports reactor but doesnt use it as far as I can tell, that caused  
the below code to fail if you imported pollreactor.
Still would love to see an example of the below code converted to use  
pollreactor

On Mar 9, 2007, at 7:04 AM, Wrene Robyn wrote:

&gt;<i> Hi,
</I>&gt;<i> Yes I am on os X. Could you show me how to convert my code below to  
</I>&gt;<i> use poll? Thanks!
</I>&gt;<i> [mport sys
</I>&gt;<i> import socket
</I>&gt;<i> import time
</I>&gt;<i> import resource
</I>&gt;<i> from threading import Thread
</I>&gt;<i> from twisted.words.protocols.jabber import client, jid
</I>&gt;<i> from twisted.words.xish import domish
</I>&gt;<i> from twisted.internet import reactor
</I>&gt;<i>
</I>&gt;<i> resource.setrlimit(8,[65000,65000])
</I>&gt;<i> class testit():
</I>&gt;<i>
</I>&gt;<i>     def authd(xmlstream):
</I>&gt;<i>         print &quot;authenticated&quot;
</I>&gt;<i>
</I>&gt;<i>         presence = domish.Element(('jabber:client','presence'))
</I>&gt;<i>         xmlstream.send(presence)
</I>&gt;<i>     #xmlstream.addObserver('/message',  debug)
</I>&gt;<i>     #xmlstream.addObserver('/presence', debug)
</I>&gt;<i>     #xmlstream.addObserver('/iq',       debug)
</I>&gt;<i>
</I>&gt;<i>     def debug(elem):
</I>&gt;<i>         print elem.toXml().encode('utf-8')
</I>&gt;<i>         print &quot;=&quot;*20
</I>&gt;<i>     for i in range(981,2000):
</I>&gt;<i>         print i
</I>&gt;<i>         myJid = jid.JID(str(i)+'@jbrsrvrnamt/twisted_words')
</I>&gt;<i>         factory = client.basicClientFactory(myJid, 'test')
</I>&gt;<i>         factory.addBootstrap('//event/stream/authd',authd)
</I>&gt;<i>         reactor.connectTCP('jbrsrvrname',5222,factory)
</I>&gt;<i>
</I>&gt;<i>     reactor.run()
</I>&gt;<i>
</I>&gt;<i> current = testit()
</I>&gt;<i> current.start()
</I>&gt;<i>
</I>&gt;<i> On Mar 6, 2007, at 10:01 AM, Jean-Paul Calderone wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Tue, 6 Mar 2007 9:44:49 -0500, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">wrobyn at cox.net</A> wrote:
</I>&gt;&gt;&gt;<i> Hello,
</I>&gt;&gt;&gt;<i> I am attempting to write an xmpp load testing thingy in python. I  
</I>&gt;&gt;&gt;<i> am hitting big walls with regard to creating concurrent  
</I>&gt;&gt;&gt;<i> connections above 250.. I need really 1-n concurrent connections,  
</I>&gt;&gt;&gt;<i> the upper limit would be around 500,000 but I would be happy at  
</I>&gt;&gt;&gt;<i> this point breaching the 250 ceiling.
</I>&gt;&gt;&gt;<i> Would twisted be able to handle this? Can someone post a simple  
</I>&gt;&gt;&gt;<i> loop or routine to log in 1-n &quot;people&quot; (i am using the increment  
</I>&gt;&gt;&gt;<i> in a counter as username) into a jabber server?
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> From the ~250 limit, I would guess you're on OS X and running  
</I>&gt;&gt;&gt;<i> into the
</I>&gt;&gt;<i> default per-process open file limit.  You can raise this using the  
</I>&gt;&gt;<i> `ulimit'
</I>&gt;&gt;<i> command. If you're on some other platform, then it'd be helpful if  
</I>&gt;&gt;<i> you gave
</I>&gt;&gt;<i> more details about the exact failure you're running into.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Overall, if you use the select reactor, you're limited to  
</I>&gt;&gt;<i> FD_SETSIZE, which
</I>&gt;&gt;<i> varies, but is usually within an order of magnitude of 1000.  If  
</I>&gt;&gt;<i> you use the
</I>&gt;&gt;<i> poll reactor, then you're limited to the number of TCP connections  
</I>&gt;&gt;<i> you can
</I>&gt;&gt;<i> have, which is going to be at most 65000 per IP address (and  
</I>&gt;&gt;<i> possibly as low
</I>&gt;&gt;<i> as 32000).  You might find performance lacking with large numbers  
</I>&gt;&gt;<i> of clients
</I>&gt;&gt;<i> even with the poll reactor, but the epoll reactor should do  
</I>&gt;&gt;<i> somewhat better.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I don't know if you'll be able to do 500k with a single process,  
</I>&gt;&gt;<i> but I think
</I>&gt;&gt;<i> you should at least be able to get to the point where the limit  
</I>&gt;&gt;<i> you hit is
</I>&gt;&gt;<i> the CPU, not something related to file descriptors.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Jean-Paul
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047464.html">[Twisted-Python] newbe twisted xmpp load
</A></li>
	<LI>Next message (by thread): <A HREF="047467.html">[Twisted-Python] newbe twisted xmpp load
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47466">[ date ]</a>
              <a href="thread.html#47466">[ thread ]</a>
              <a href="subject.html#47466">[ subject ]</a>
              <a href="author.html#47466">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
