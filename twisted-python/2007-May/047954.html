<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Modifying a web proxy to use SSL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Modifying%20a%20web%20proxy%20to%20use%20SSL&In-Reply-To=%3C5DA9F92FACA0914D951AE5EB57F9236E02B9BB9E%40THN-EXCLS1.dc1.doubleclick.corp%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047944.html">
   <LINK REL="Next"  HREF="047963.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Modifying a web proxy to use SSL</H1>
    <B>Adams, Larry</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Modifying%20a%20web%20proxy%20to%20use%20SSL&In-Reply-To=%3C5DA9F92FACA0914D951AE5EB57F9236E02B9BB9E%40THN-EXCLS1.dc1.doubleclick.corp%3E"
       TITLE="[Twisted-Python] Modifying a web proxy to use SSL">LAdams at doubleclick.com
       </A><BR>
    <I>Tue May 29 14:47:10 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047944.html">[Twisted-Python] Use of XML RPC, ssl and twisted.cred
</A></li>
        <LI>Next message (by thread): <A HREF="047963.html">[Twisted-Python] RE: Modifying a web proxy to use SSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47954">[ date ]</a>
              <a href="thread.html#47954">[ thread ]</a>
              <a href="subject.html#47954">[ subject ]</a>
              <a href="author.html#47954">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm trying to use twisted to proxy all web requests for a set of PCs
(virtual machines actually). I've created my own ProxyRequest class to
override the process() method so that it will use SSL if the URL is
secure. It makes the connection and retrieves the data successfully, but
the browser still doesn't display the HTML. I must be missing some other
class/method that I have to override, but I'm at a loss as to which one
at the moment.

Below is some logging from my application for the same page called via
http and https respectively. Any help or pointers to working examples
would be greatly appreciated!

Thanks,
Larry Adams 
2007/05/29 15:10 -0500 [SerpicoProxy,11,172.18.36.22] Starting factory
&lt;__main__.SerpicoProxyClientFactory instance at 0xb71d8cec&gt;

2007/05/29 15:10 -0500 [Uninitialized] building protocol for addr:
IPv4Address(TCP, 'www.connectcommerce.com
&lt;<A HREF="file://www.connectcommerce.com">file://www.connectcommerce.com</A>&gt; ', 80)
2007/05/29 15:10 -0500 [Uninitialized] initializing connection
2007/05/29 15:10 -0500 [Uninitialized] MACHINE NAME IS surfsidekick
2007/05/29 15:10 -0500 [Uninitialized] PROXYREQUEST
<A HREF="http://www.connectcommerce.com/">http://www.connectcommerce.com/</A> &lt;<A HREF="http://www.connectcommerce.com/">http://www.connectcommerce.com/</A>&gt; 
2007/05/29 15:10 -0500 [Uninitialized] TRANSPORT &lt;&lt;class
'twisted.internet.tcp.Client'&gt; to ('www.connectcommerce.com
&lt;<A HREF="file://www.connectcommerce.com">file://www.connectcommerce.com</A>&gt; ', 80) at b71d8ccc&gt;

2007/05/29 15:10 -0500 [Uninitialized] ISSECURE False
2007/05/29 15:10 -0500 [SerpicoProxyClient,client] Date : Tue, 29 May
2007 20:11:27 GMT added
2007/05/29 15:10 -0500 [SerpicoProxyClient,client] Server :
Apache/1.3.33 (Unix) (Gentoo/Linux) added
2007/05/29 15:10 -0500 [SerpicoProxyClient,client] Location :
<A HREF="http://www.connectcommerce.com/global/login.html">http://www.connectcommerce.com/global/login.html</A>
&lt;<A HREF="http://www.connectcommerce.com/global/login.html">http://www.connectcommerce.com/global/login.html</A>&gt;  added
2007/05/29 15:10 -0500 [SerpicoProxyClient,client] Connection : close
added
2007/05/29 15:10 -0500 [SerpicoProxyClient,client] Content-Type :
text/html; charset=iso-8859-1 added
2007/05/29 15:10 -0500 [SerpicoProxyClient,client] trying to lose
connection for transport: &lt;&lt;class 'twisted.internet.tcp.Client'&gt; to
('www.connectcommerce.com &lt;<A HREF="file://www.connectcommerce.com">file://www.connectcommerce.com</A>&gt; ', 80) at
b71d8ccc&gt;

2007/05/29 15:10 -0500 [SerpicoProxyClient,client] parent transport :
&lt;SerpicoProxy #11 on 74007&gt;
2007/05/29 15:10 -0500 [SerpicoProxyClient,client] Stopping factory
&lt;__main__.SerpicoProxyClientFactory instance at 0xb71d8cec&gt;

2007/05/29 15:11 -0500 [SerpicoProxy,18,172.18.36.22] Starting factory
&lt;__main__.SerpicoProxyClientFactory instance at 0xb71d8d0c&gt;

2007/05/29 15:11 -0500 [Uninitialized] building protocol for addr:
IPv4Address(TCP, 'www.connectcommerce.com
&lt;<A HREF="file://www.connectcommerce.com">file://www.connectcommerce.com</A>&gt; ', 443)
2007/05/29 15:11 -0500 [Uninitialized] initializing connection
2007/05/29 15:11 -0500 [Uninitialized] MACHINE NAME IS surfsidekick
2007/05/29 15:11 -0500 [Uninitialized] PROXYREQUEST
<A HREF="https://www.connectcommerce.com">https://www.connectcommerce.com</A> &lt;<A HREF="https://www.connectcommerce.com">https://www.connectcommerce.com</A>&gt; 
2007/05/29 15:11 -0500 [Uninitialized] TRANSPORT &lt;&lt;class
'twisted.internet.tcp.TLSConnection'&gt; to ('www.connectcommerce.com
&lt;<A HREF="file://www.connectcommerce.com">file://www.connectcommerce.com</A>&gt; ', 443) at b71bd86c&gt;

2007/05/29 15:11 -0500 [Uninitialized] ISSECURE True
2007/05/29 15:11 -0500 [SerpicoProxyClient,client] Date : Tue, 29 May
2007 20:12:00 GMT added
2007/05/29 15:11 -0500 [SerpicoProxyClient,client] Server :
Apache/1.3.33 (Unix) (Gentoo/Linux) added
2007/05/29 15:11 -0500 [SerpicoProxyClient,client] Location :
<A HREF="http://www.connectcommerce.com/global/login.html">http://www.connectcommerce.com/global/login.html</A>
&lt;<A HREF="http://www.connectcommerce.com/global/login.html">http://www.connectcommerce.com/global/login.html</A>&gt;  added
2007/05/29 15:11 -0500 [SerpicoProxyClient,client] Connection : close
added
2007/05/29 15:11 -0500 [SerpicoProxyClient,client] Content-Type :
text/html; charset=iso-8859-1 added
2007/05/29 15:11 -0500 [SerpicoProxyClient,client] trying to lose
connection for transport: &lt;&lt;class 'twisted.internet.tcp.TLSConnection'&gt;
to ('www.connectcommerce.com &lt;<A HREF="file://www.connectcommerce.com">file://www.connectcommerce.com</A>&gt; ', 443) at
b71bd86c&gt;

2007/05/29 15:11 -0500 [SerpicoProxyClient,client] parent transport :
&lt;SerpicoProxy #18 on 74007&gt;
2007/05/29 15:11 -0500 [SerpicoProxyClient,client] Stopping factory
&lt;__main__.SerpicoProxyClientFactory instance at 0xb71d8d0c&gt;

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20070529/ba240d33/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047944.html">[Twisted-Python] Use of XML RPC, ssl and twisted.cred
</A></li>
	<LI>Next message (by thread): <A HREF="047963.html">[Twisted-Python] RE: Modifying a web proxy to use SSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47954">[ date ]</a>
              <a href="thread.html#47954">[ thread ]</a>
              <a href="subject.html#47954">[ subject ]</a>
              <a href="author.html#47954">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
