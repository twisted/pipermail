<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Sequential use of asynchronous calls
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Sequential%20use%20of%20asynchronous%20calls&In-Reply-To=%3C6C6D8683-E148-41D2-BE54-AC6A31C0F117%40artins.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047947.html">
   <LINK REL="Next"  HREF="047950.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Sequential use of asynchronous calls</H1>
    <B>Ben Artin</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Sequential%20use%20of%20asynchronous%20calls&In-Reply-To=%3C6C6D8683-E148-41D2-BE54-AC6A31C0F117%40artins.org%3E"
       TITLE="[Twisted-Python] Sequential use of asynchronous calls">ben at artins.org
       </A><BR>
    <I>Sat May 26 21:45:14 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047947.html">[Twisted-Python] Sequential use of asynchronous calls
</A></li>
        <LI>Next message (by thread): <A HREF="047950.html">[Twisted-Python] Sequential use of asynchronous calls
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47948">[ date ]</a>
              <a href="thread.html#47948">[ thread ]</a>
              <a href="subject.html#47948">[ subject ]</a>
              <a href="author.html#47948">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Since it is used as a decorator, the @sequential line will be  
</I>&gt;<i> written by the
</I>&gt;<i> same person who wrote the function itself. If the author of the  
</I>&gt;<i> function
</I>&gt;<i> knows it is not a generator, why would he apply @sequential (or
</I>&gt;<i> @inlineCallbacks) to it?
</I>
One reason is that if the function returns None, then if you require  
it to be a generator, you have to add a gratuitous &quot;yield None&quot; just  
to shut up the piece of code that requires a generator. For example:

@sequential
def foo():
	blah = blah

would cause the error, but

@sequential
def foo():
	blah = blah
	yield None

would not. In my opinion, that &quot;yield None&quot; is just noise, and  
doesn't make the code any better, faster, safer, or easier to read,  
so given the option I would make @sequential cope even when yield  
None is not there.


The other main case where I've run into this is when you have a  
protocol that expects some method to behave according to @sequential,  
but a particular implementation of that protocol doesn't need to do  
more than immediately return. For example:

class TakesALongTime():
	@sequential
	def doSomething(self):
		yield doPart1()
		yield doPart2()
		yield someResult


class ReturnsImmediately():
	@sequential
	def doSomething(self):
		return someResult


Now, if you use &quot;return&quot; in the first class, you get a syntax error  
right away, because a non-empty return in a generator is a syntax  
error. On the other hand, if you use &quot;return&quot; in the second class,  
you don't get a syntax error, but your implementation of @sequential  
would produce a runtime error. I understand why it's easy to produce  
that runtime error, but I don't see any benefit to it -- it doesn't  
really save the users of @sequential any effort.

&gt;<i> But should it be given any interpretation at all? Unless there is a  
</I>&gt;<i> real use
</I>&gt;<i> case for it, I think it's better to consider it an error.
</I>
I would agree with you if I thought there was any possibility that  
interpreting a plain function as a generator with a single yield  
could yield unintended results, but I have yet to find such a case.

Ben

--

&lt;<A HREF="http://artins.org/ben">http://artins.org/ben</A>&gt;

&quot;The last great thing written in C was Franz Schubert's Symphony  
number 9.&quot;




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047947.html">[Twisted-Python] Sequential use of asynchronous calls
</A></li>
	<LI>Next message (by thread): <A HREF="047950.html">[Twisted-Python] Sequential use of asynchronous calls
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47948">[ date ]</a>
              <a href="thread.html#47948">[ thread ]</a>
              <a href="subject.html#47948">[ subject ]</a>
              <a href="author.html#47948">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
