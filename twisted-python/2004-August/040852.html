<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted+M2Crypto patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2BM2Crypto%20patch&In-Reply-To=%3C411A7844.3060103%40osafoundation.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040850.html">
   <LINK REL="Next"  HREF="040853.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted+M2Crypto patch</H1>
    <B>Heikki Toivonen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2BM2Crypto%20patch&In-Reply-To=%3C411A7844.3060103%40osafoundation.org%3E"
       TITLE="[Twisted-Python] Twisted+M2Crypto patch">heikki at osafoundation.org
       </A><BR>
    <I>Wed Aug 11 13:49:24 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040850.html">[Twisted-Python] Architecture question for multiple	client	connections (longish)
</A></li>
        <LI>Next message (by thread): <A HREF="040853.html">[Twisted-Python] Twisted+M2Crypto patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40852">[ date ]</a>
              <a href="thread.html#40852">[ thread ]</a>
              <a href="subject.html#40852">[ subject ]</a>
              <a href="author.html#40852">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been working on integrating M2Crypto to Twisted. M2Crypto is a 
Python wrapper for OpenSSL.

Twisted already integrates with PyOpenSSL, which is another Python 
wrapper for OpenSSL. However, PyOpenSSL has been dormant for a couple of 
years (although I have heard there might be a a rewrite in the making). 
M2Crypto has been under continuous development, and wraps more of 
OpenSSL. Additional point why I have been working on this is that 
Chandler project started using M2Crypto before choosing to use Twisted, 
and we are/will be relying on more and more M2Crypto functionality and 
it does not make sense to have two OpenSSL wrappers in one application.

So, now I have a patch that let's you choose which of these OpenSSL 
wrappers you want to use with Twisted.

By default PyOpenSSL will be selected. If you set 'useM2' attribute to 
true on the SSL context factory (for example 
twisted.internet.ssl.ClientContextFactory(useM2=True)), then M2Crypto 
will be used.

I have tested using Twisted's echoclient_ssl.py/echoserv_ssl.py example 
files (<A HREF="http://twistedmatrix.com/documents/current/examples/">http://twistedmatrix.com/documents/current/examples/</A>), as well as 
imap and smtp using samples from here: 
<A HREF="http://wiki.osafoundation.org/twiki/bin/view/Chandler/TwistedHome.">http://wiki.osafoundation.org/twiki/bin/view/Chandler/TwistedHome.</A> I've 
also read imap email using Chandler 
(<A HREF="http://wiki.osafoundation.org/twiki/bin/view/Chandler/WebHome">http://wiki.osafoundation.org/twiki/bin/view/Chandler/WebHome</A>) with 
this code. They rely on the patch that was submitted by OSAF's Brian 
Kirsch earlier. I have tested on systems that have both M2Crypto and 
PyOpenSSL installed, or only one but not the other. Test OSes have been 
Windows XP and Debian (unstable).

There is one nasty hack in the patch which I have not yet ironed out: 
the changes in abstract.py. If I take those out, I cannot connect to an 
smtp server, and connection to a newly started server won't work the 
first time. Any help in figuring this out would be appreciated.

Any review comments appreciated. And if you have any question, please 
let me know.

-- 
   Heikki Toivonen

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: m2-patches
URL: &lt;/pipermail/twisted-python/attachments/20040811/a0963b81/attachment.ksh&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 249 bytes
Desc: OpenPGP digital signature
URL: &lt;/pipermail/twisted-python/attachments/20040811/a0963b81/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040850.html">[Twisted-Python] Architecture question for multiple	client	connections (longish)
</A></li>
	<LI>Next message (by thread): <A HREF="040853.html">[Twisted-Python] Twisted+M2Crypto patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40852">[ date ]</a>
              <a href="thread.html#40852">[ thread ]</a>
              <a href="subject.html#40852">[ subject ]</a>
              <a href="author.html#40852">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
