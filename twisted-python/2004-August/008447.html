<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> select(2) is just a hint (Was: Re: [Twisted-Python] ENOBUF and	Twisted)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=select%282%29%20is%20just%20a%20hint%20%28Was%3A%20Re%3A%20%5BTwisted-Python%5D%20ENOBUF%20and%0A%09Twisted%29&In-Reply-To=20040819130202.GI23028%40frobozz">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008445.html">
   <LINK REL="Next"  HREF="008449.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>select(2) is just a hint (Was: Re: [Twisted-Python] ENOBUF and	Twisted)</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=select%282%29%20is%20just%20a%20hint%20%28Was%3A%20Re%3A%20%5BTwisted-Python%5D%20ENOBUF%20and%0A%09Twisted%29&In-Reply-To=20040819130202.GI23028%40frobozz"
       TITLE="select(2) is just a hint (Was: Re: [Twisted-Python] ENOBUF and	Twisted)">tv at twistedmatrix.com
       </A><BR>
    <I>Fri Aug 20 03:30:21 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008445.html">[Twisted-Python] ENOBUF and Twisted
</A></li>
        <LI>Next message: <A HREF="008449.html">select(2) is just a hint (Was: Re: [Twisted-Python] ENOBUF and	Twisted)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8447">[ date ]</a>
              <a href="thread.html#8447">[ thread ]</a>
              <a href="subject.html#8447">[ subject ]</a>
              <a href="author.html#8447">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrew Bennetts wrote:
&gt;<i> Well, the problem is that currently the select reactor assumes that if
</I>&gt;<i> select says a socket is writeable, then it is writeable, i.e it is safe to
</I>&gt;<i> attempt to write any amount of data to it (with the understanding that being
</I>&gt;<i> non-blocking it might only be able to accept some of that data immediately).
</I>&gt;<i> Apparently this assumption is not quite accurate.
</I>
That's not a safe assumption under UNIX. select(2) is just a hint; writing
to the socket may still give you EAGAIN, even if select(2) said it's writable.
And the same goes for reading, too.

For the reason why this must be allowed, think about a non-blocking fd shared
between two processes:

	Process 1			Process 2
	select() says fd 4 writable
					select() says fd 4 writable
	write(4, ...) success
					write(4, ...) = -1, EAGAIN

But this isn't the only case when select is unable to predict the future;
as soon as your code _must_ support the above case in order to work, the
kernel can use that feature of the API to make some socket bookkeeping
things easier.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008445.html">[Twisted-Python] ENOBUF and Twisted
</A></li>
	<LI>Next message: <A HREF="008449.html">select(2) is just a hint (Was: Re: [Twisted-Python] ENOBUF and	Twisted)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8447">[ date ]</a>
              <a href="thread.html#8447">[ thread ]</a>
              <a href="subject.html#8447">[ subject ]</a>
              <a href="author.html#8447">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
