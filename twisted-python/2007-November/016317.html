<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Calling reactor.run() / reactor.stop() twice
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Calling%20reactor.run%28%29%20/%20reactor.stop%28%29%20twice&In-Reply-To=1194991816.20835.3.camel%40fnord.melbourne.eigenmagic.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016315.html">
   <LINK REL="Next"  HREF="016316.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Calling reactor.run() / reactor.stop() twice</H1>
    <B>John Dawson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Calling%20reactor.run%28%29%20/%20reactor.stop%28%29%20twice&In-Reply-To=1194991816.20835.3.camel%40fnord.melbourne.eigenmagic.net"
       TITLE="[Twisted-Python] Calling reactor.run() / reactor.stop() twice">jdawson at io.com
       </A><BR>
    <I>Tue Nov 13 17:47:12 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="016315.html">[Twisted-Python] Calling reactor.run() / reactor.stop() twice
</A></li>
        <LI>Next message: <A HREF="016316.html">[Twisted-Python] Calling reactor.run() / reactor.stop() twice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16317">[ date ]</a>
              <a href="thread.html#16317">[ thread ]</a>
              <a href="subject.html#16317">[ subject ]</a>
              <a href="author.html#16317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I know it's a bizarre thing to want.  I've got a client/server system
using Twisted.  The client doesn't do anything asynchronously, except,
of course, for its interaction with the server via Perspective Broker.
 The way the code is written right now, the code is only starts up the
reactor and interacts with the server when it needs to send an RPC to
the server.  Until now, it would only ever do (at most) one RPC to the
server.  But I now need to do two.  It would have been simpler to fix
the client code if the reactor were restartable.  But given your
feedback, it looks I'll have to restructure things a bit to
accommodate having a long-running reactor.

The client pseudocode looks something like this:

    def start_server():
        # Fire off an ssh command to run the server on the remote host

    def stop_server():
        # start reactor
        # connect to server
        # send PB message to server to tell it to shut down
        # stop reactor

    def get_server_status():
        # start reactor
        # connect to server
        # stop reactor
        # return True/False of whether connect was successful

    def restart_server():
        if get_server_status():
            stop_server()
        start_server()

But, it's certainly fixable to have just one run/stop of the reactor loop.

Thanks for help!
John


On 11/13/07, Justin Warren &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">daedalus at eigenmagic.com</A>&gt; wrote:
&gt;<i> On Tue, 2007-11-13 at 15:43 -0600, John Dawson wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The following Twisted code hangs, since the second call to
</I>&gt;<i> &gt; reactor.stop() doesn't seem to really stop the reactor.  Is this a bug
</I>&gt;<i> &gt; in Twisted, or is it impermissible to run/stop a reactor more than
</I>&gt;<i> &gt; once?
</I>&gt;<i>
</I>&gt;<i> The reactor is not restartable. Attempting to restart the reactor will
</I>&gt;<i> result in unpredictable behaviour.
</I>&gt;<i>
</I>&gt;<i> Why do you want to do this?
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Justin Warren &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">daedalus at eigenmagic.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>

-- 
John Dawson &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jdawson at io.com</A>&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016315.html">[Twisted-Python] Calling reactor.run() / reactor.stop() twice
</A></li>
	<LI>Next message: <A HREF="016316.html">[Twisted-Python] Calling reactor.run() / reactor.stop() twice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16317">[ date ]</a>
              <a href="thread.html#16317">[ thread ]</a>
              <a href="subject.html#16317">[ subject ]</a>
              <a href="author.html#16317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
