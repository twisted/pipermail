<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] profiling live twisted application
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20profiling%20live%20twisted%20application&In-Reply-To=066a01c82255%247d5276a0%2477f763e0%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016265.html">
   <LINK REL="Next"  HREF="016267.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] profiling live twisted application</H1>
    <B>Maarten ter Huurne</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20profiling%20live%20twisted%20application&In-Reply-To=066a01c82255%247d5276a0%2477f763e0%24%40com"
       TITLE="[Twisted-Python] profiling live twisted application">maarten at treewalker.org
       </A><BR>
    <I>Thu Nov  8 18:40:04 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="016265.html">[Twisted-Python] profiling live twisted application
</A></li>
        <LI>Next message: <A HREF="016267.html">[Twisted-Python] profiling live twisted application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16266">[ date ]</a>
              <a href="thread.html#16266">[ thread ]</a>
              <a href="subject.html#16266">[ subject ]</a>
              <a href="author.html#16266">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thursday 08 November 2007, Alec Matusis wrote:

&gt;<i> What is the best non-intrusive way to profile a live twisted application?
</I>
I'm not sure it's possible to do profiling in a non-intrusive way: the more 
detailed measurements you want to take, the more you're going to slow down 
execution. I hear quantum mechanics has similar problems ;)

&gt;<i> We have TCP servers with epoll reactors.
</I>&gt;<i>
</I>&gt;<i> We want to optimize them as our usage grows.
</I>
What I did for our web app is add an option to log the time it took to 
handle each page fetch. By looking at the log, you can spot pages that are 
always slow, pages which are slow for certain inputs and pages which vary 
in speed.

There are several profilers available for Python, but their overhead is 
probably too much to use in a live environment. Maybe you can duplicate the 
data sets and requests from the live environment in a test environment 
though and profile your server there.

Here is some example code:

if _timeRender:
	from time import time
if _profileRender:
	from hotshot import Profile

[...]

	if _timeRender:
		start = time()
	if _profileRender:
		profile = Profile('request.prof')
		profile.runcall(page.respond, req)
		profile.close()
	else:
		page.respond(req)
	if _timeRender:
		end = time()
		print 'Responding took %1.3f seconds' % (end - start)

HotShot profile results are binary files, read the Python library 
documentation to learn how you can create human readable output from them.

Bye,
		Maarten
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20071109/ead574a0/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-python/attachments/20071109/ead574a0/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016265.html">[Twisted-Python] profiling live twisted application
</A></li>
	<LI>Next message: <A HREF="016267.html">[Twisted-Python] profiling live twisted application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16266">[ date ]</a>
              <a href="thread.html#16266">[ thread ]</a>
              <a href="subject.html#16266">[ subject ]</a>
              <a href="author.html#16266">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
