<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Problem passing objects with perspective broker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Problem%20passing%20objects%20with%20perspective%20broker&In-Reply-To=CAC6f7iPja2wFuRLGZ_E9_n3REOYoLSeN4hyeQfv%2BTmCH%3DLwpzA%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025153.html">
   <LINK REL="Next"  HREF="025155.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Problem passing objects with perspective broker</H1>
    <B>David Ripton</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Problem%20passing%20objects%20with%20perspective%20broker&In-Reply-To=CAC6f7iPja2wFuRLGZ_E9_n3REOYoLSeN4hyeQfv%2BTmCH%3DLwpzA%40mail.gmail.com"
       TITLE="[Twisted-Python] Problem passing objects with perspective broker">dripton at ripton.net
       </A><BR>
    <I>Sun Jan 29 01:11:56 EST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="025153.html">[Twisted-Python] Problem passing objects with perspective broker
</A></li>
        <LI>Next message: <A HREF="025155.html">[Twisted-Python] Problem passing objects with perspective broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25154">[ date ]</a>
              <a href="thread.html#25154">[ thread ]</a>
              <a href="subject.html#25154">[ subject ]</a>
              <a href="author.html#25154">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/29/12 00:57, Fourat ZOUARI wrote:

&gt;<i> Whenever i try to pass an object (aClass) with a property with a second
</I>&gt;<i> object (bClass) Am getting:
</I>&gt;<i>
</I>&gt;<i>     *Unpersistable('Unpersistable data: instance of class amodule.bClass
</I>&gt;<i>     deemed insecure')*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The aClass is copyable and unjellied, the bClass is not.
</I>&gt;<i>
</I>&gt;<i> Here's my code:
</I>&gt;<i>
</I>&gt;<i> server.py:
</I>&gt;<i>
</I>&gt;<i>     from twisted.application import internet, service
</I>&gt;<i>     from twisted.spread import pb
</I>&gt;<i>     from amodule import PBServer
</I>&gt;<i>
</I>&gt;<i>     application = service.Application(&quot;Test app&quot;)
</I>&gt;<i>
</I>&gt;<i>     # Prepare managers
</I>&gt;<i>     clientManager = internet.TCPServer(8282,
</I>&gt;<i>     pb.PBServerFactory(PBServer()));
</I>&gt;<i>     clientManager.setServiceParent(application)
</I>&gt;<i>
</I>&gt;<i>     if __name__ == '__main__':
</I>&gt;<i>          print &quot;Run with twistd&quot;
</I>&gt;<i>          import sys
</I>&gt;<i>          sys.exit(1)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> amodule.py:
</I>&gt;<i>
</I>&gt;<i>     from twisted.spread import pb
</I>&gt;<i>
</I>&gt;<i>     class bClass:
</I>&gt;<i>     &quot;&quot;&quot;This is not a Copyable class
</I>&gt;<i>     &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i>     class aClass(pb.RemoteCopy, pb.Copyable):
</I>&gt;<i>          b = bClass()
</I>&gt;<i>     pb.setUnjellyableForClass(aClass, aClass)
</I>&gt;<i>
</I>&gt;<i>     class PBServer(pb.Root):
</I>&gt;<i>          def remote_echo(self, a):
</I>&gt;<i>              return a.b
</I>&gt;<i>
</I>&gt;<i> Is there anyway to unjelly aClass and all the objects it can contain ?
</I>&gt;<i> because unjellying included object is a headache and may turn into dirty
</I>&gt;<i> code ...
</I>
If you make bClass inherit from pb.Copyable and do 
pb.setUnjellyableForClass(bClass, bClass) then everything should work.

Twisted knows how to do what you want, but it's refusing to do because 
you haven't marked bClass as safe to pass over the wire.

-- 
David Ripton    <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dripton at ripton.net</A>

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025153.html">[Twisted-Python] Problem passing objects with perspective broker
</A></li>
	<LI>Next message: <A HREF="025155.html">[Twisted-Python] Problem passing objects with perspective broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25154">[ date ]</a>
              <a href="thread.html#25154">[ thread ]</a>
              <a href="subject.html#25154">[ subject ]</a>
              <a href="author.html#25154">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
