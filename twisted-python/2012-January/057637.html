<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] how to ensure writes to stdout via stdio.StandardIO are completed before we shutdown the reactor?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20how%20to%20ensure%20writes%20to%20stdout%20via%0A%20stdio.StandardIO%20are%20completed%20before%20we%20shutdown%20the%20reactor%3F&In-Reply-To=%3CCAMWA1_pGBmFoeYimm8WXJaCdNCDCmXVwF7xoBm8o83fWW_QTGQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="057636.html">
   <LINK REL="Next"  HREF="025163.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] how to ensure writes to stdout via stdio.StandardIO are completed before we shutdown the reactor?</H1>
    <B>Benjamin Rutt</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20how%20to%20ensure%20writes%20to%20stdout%20via%0A%20stdio.StandardIO%20are%20completed%20before%20we%20shutdown%20the%20reactor%3F&In-Reply-To=%3CCAMWA1_pGBmFoeYimm8WXJaCdNCDCmXVwF7xoBm8o83fWW_QTGQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] how to ensure writes to stdout via stdio.StandardIO are completed before we shutdown the reactor?">rutt.4 at osu.edu
       </A><BR>
    <I>Tue Jan 31 20:59:30 MST 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="057636.html">[Twisted-Python] Twisted Sprint at PyCon 2012 -- please sign up!
</A></li>
        <LI>Next message (by thread): <A HREF="025163.html">[Twisted-Python] how to ensure writes to stdout via stdio.StandardIO are completed before we shutdown the reactor?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57637">[ date ]</a>
              <a href="thread.html#57637">[ thread ]</a>
              <a href="subject.html#57637">[ subject ]</a>
              <a href="author.html#57637">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi twisted community,

What’s the best way to ensure writes to stdout via stdio.StandardIO
are completed before we shutdown the reactor?   The use case is to
emit an error message before we shutdown the reactor and stop our
program.  Dummy code snippet:

--------------------------------------------
#!/usr/bin/python

from twisted.internet import reactor, stdio
from twisted.protocols.basic  import LineReceiver

class StdinInteractor(LineReceiver):
  delimiter = '\n'

def go():
  stdio_proto = StdinInteractor()
  stdio.StandardIO(stdio_proto)
  stdio_proto.transport.write('did we get this message?\n')
  if 0:
    reactor.stop()
  else:
    reactor.callLater(1.0, reactor.stop)

reactor.callWhenRunning(go)
reactor.run()
--------------------------------------------

If I change ‘if 0’ to ‘if 1’, I don’t get the message on stdout.  The
‘reactor.callLater(1.0, reactor.stop)’ is obviously a hack to let the
reactor send out the buffered message before shutting down.  Any
ideas?

Thanks,

-- 
Benjamin Rutt


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="057636.html">[Twisted-Python] Twisted Sprint at PyCon 2012 -- please sign up!
</A></li>
	<LI>Next message (by thread): <A HREF="025163.html">[Twisted-Python] how to ensure writes to stdout via stdio.StandardIO are completed before we shutdown the reactor?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57637">[ date ]</a>
              <a href="thread.html#57637">[ thread ]</a>
              <a href="subject.html#57637">[ subject ]</a>
              <a href="author.html#57637">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
