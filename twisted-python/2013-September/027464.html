<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Running unit tests without trial?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Running%20unit%20tests%20without%20trial%3F&In-Reply-To=%3C20130925184544.26068.1404349410.divmod.xquotient.2424%40top%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027463.html">
   <LINK REL="Next"  HREF="027467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Running unit tests without trial?</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Running%20unit%20tests%20without%20trial%3F&In-Reply-To=%3C20130925184544.26068.1404349410.divmod.xquotient.2424%40top%3E"
       TITLE="[Twisted-Python] Running unit tests without trial?">exarkun at twistedmatrix.com
       </A><BR>
    <I>Wed Sep 25 12:45:44 MDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027463.html">[Twisted-Python] Running unit tests without trial?
</A></li>
        <LI>Next message: <A HREF="027467.html">[Twisted-Python] Running unit tests without trial?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27464">[ date ]</a>
              <a href="thread.html#27464">[ thread ]</a>
              <a href="subject.html#27464">[ subject ]</a>
              <a href="author.html#27464">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06:15 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rowen at uw.edu</A> wrote:
&gt;<i>Is it possible to run twisted.trial unit tests using python instead of
</I>&gt;<i>trial, i.e.: &quot;python mytest.py&quot; instead of  &quot;trial mytest.py&quot;?
</I>
Sure.  Here's the worst case answer (contents of mytest.py):

    import os
    os.system(&quot;trial myrealtests.py&quot;)

By the way, it's usually better to use the FQPN to run tests - not the 
filename.  Using the filename exposes you to all kinds of gross edge 
cases that trial doesn't always handle very well (having to do with how 
modules are loaded in Python).  So consider this instead:

    trial mytest

Or better yet, since you should be distributing and installing your test 
suite along with your package:

    trial myproject.test

There *are* better ways than `os.system&#180; to get a runnable Python source 
file that will run your tests though.

One that shouldn't be much of a surprise is to do exactly what you would 
do for a stdlib unittest-based test module:

    if __name__ == '__main__':
        import unittest
        unittest.main()

Or you can just invoke the same code that the command line trial script 
invokes:

    from twisted.scripts.trial import run
    run()

(That's not exactly the same as /usr/bin/trial, but you can read 
/usr/bin/trial to see the differences if you're interested).

Jean-Paul

&gt;<i>I'm hoping there is some simple magic I can put into the unit test
</I>&gt;<i>itself to make this work. Perhaps something in
</I>&gt;<i>if __name__ == &quot;__main__&quot;:
</I>&gt;<i>   ...?
</I>&gt;<i>to make it start up the reactor and run it correctly.
</I>&gt;<i>
</I>&gt;<i>I ask because I'm using a build environment that runs all unit tests
</I>&gt;<i>this way. It does the sniffing out and the saving of logs, but it
</I>&gt;<i>insists on running .py tests using python.
</I>&gt;<i>
</I>&gt;<i>-- Russell
</I>&gt;<i>
</I>&gt;<i>P.S. being *able* to run trial unit tests using python seems like a
</I>&gt;<i>feature to me in any case -- one I'd be willing to add extra code to
</I>&gt;<i>support. Trial has some nice features, but I find it confusing that it
</I>&gt;<i>is *required* to run a single test with a &quot;.py&quot; extension when visually
</I>&gt;<i>it looks like a python file.
</I>
For what it's worth, just having a &quot;.py&quot; extension doesn't mean a file 
is intended to be run directly.  In fact, the vast majority of &quot;.py&quot; 
files are not intended to be run directly.  For example, out of the 816 
&quot;.py&quot; files that are part of Twisted, probably only a handful are meant 
to be run directly.

What the &quot;.py&quot; extension unquestionably means is &quot;this is a python 
module, it can be imported&quot;.  Arguably command line entrypoints should 
not have a &quot;.py&quot; extension - just as command line tools written in C and 
compiled to some version of native don't have a &quot;.a&quot; or &quot;.so&quot; extension 
(let alone a &quot;.c&quot; extension).

Jean-Paul

</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027463.html">[Twisted-Python] Running unit tests without trial?
</A></li>
	<LI>Next message: <A HREF="027467.html">[Twisted-Python] Running unit tests without trial?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27464">[ date ]</a>
              <a href="thread.html#27464">[ thread ]</a>
              <a href="subject.html#27464">[ subject ]</a>
              <a href="author.html#27464">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
