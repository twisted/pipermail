<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to disconnect an HTTP connection and notify	the far end
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20disconnect%20an%20HTTP%20connection%20and%20notify%0A%09the%20far%20end&In-Reply-To=%3C009401ceb4b1%24fd4435c0%24f7cca140%24%40shinkuro.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059909.html">
   <LINK REL="Next"  HREF="059916.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to disconnect an HTTP connection and notify	the far end</H1>
    <B>Bob Novas</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20disconnect%20an%20HTTP%20connection%20and%20notify%0A%09the%20far%20end&In-Reply-To=%3C009401ceb4b1%24fd4435c0%24f7cca140%24%40shinkuro.com%3E"
       TITLE="[Twisted-Python] How to disconnect an HTTP connection and notify	the far end">bob.novas at shinkuro.com
       </A><BR>
    <I>Wed Sep 18 14:59:38 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059909.html">[Twisted-Python] Cancelling a pb callRemote
</A></li>
        <LI>Next message (by thread): <A HREF="059916.html">[Twisted-Python] How to disconnect an HTTP connection and	notify the far end
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27449">[ date ]</a>
              <a href="thread.html#27449">[ thread ]</a>
              <a href="subject.html#27449">[ subject ]</a>
              <a href="author.html#27449">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've got a question on how to explicitly disconnect a connection from the
client side so that the server side knows that the connection has been
disconnected. I'd be happy if this worked even with no guarantees, i.e.,
only when the client and server were in fact well-connected. It's just an
optimization to allow the server to cleanup.

 

I've got an HTTP client that uses HTTPConnectionPool to get an Agent, gets a
Request from the Agent, and sends the Request to a WebServer on a linux box.


 

On a Mac client, if I call closeCachedConnections() on the
HTTPConnectionPool, the client immediately sends FIN on the port with the
Request outstanding, the server delivers a callback registered on the
Request via NotifyFinish() and the server knows the client has disconnected.

 

On a Windows client, if I do the same, same code, the client waits until the
outstanding Request finishes and then sends FIN. Nothing happens at the
server - there's no Request outstanding on which to deliver a callback,
twisted.internet.tcp.Port.connectionLost() doesn't get called, nada.

 

Am I missing something?  Is there a way to send a FIN on a connection on
which there is an outstanding Request on Windows?

 

Thanks in advance,

Bob

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20130918/152633fb/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20130918/152633fb/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 6085 bytes
Desc: not available
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20130918/152633fb/attachment.bin">http://twistedmatrix.com/pipermail/twisted-python/attachments/20130918/152633fb/attachment.bin</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059909.html">[Twisted-Python] Cancelling a pb callRemote
</A></li>
	<LI>Next message (by thread): <A HREF="059916.html">[Twisted-Python] How to disconnect an HTTP connection and	notify the far end
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27449">[ date ]</a>
              <a href="thread.html#27449">[ thread ]</a>
              <a href="subject.html#27449">[ subject ]</a>
              <a href="author.html#27449">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
