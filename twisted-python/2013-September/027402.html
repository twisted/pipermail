<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Asynchronously reading posted data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Asynchronously%20reading%20posted%20data&In-Reply-To=%3CCACgdh2hh9TdZSTBrYF%3DxJwdoaspBVwmLQDL7ZrTP-%2Bt-nQV4RA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027397.html">
   <LINK REL="Next"  HREF="027405.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Asynchronously reading posted data</H1>
    <B>Paul Wiseman</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Asynchronously%20reading%20posted%20data&In-Reply-To=%3CCACgdh2hh9TdZSTBrYF%3DxJwdoaspBVwmLQDL7ZrTP-%2Bt-nQV4RA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Asynchronously reading posted data">poalman at gmail.com
       </A><BR>
    <I>Thu Sep  5 02:50:26 MDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027397.html">[Twisted-Python] Asynchronously reading posted data
</A></li>
        <LI>Next message: <A HREF="027405.html">[Twisted-Python] Asynchronously reading posted data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27402">[ date ]</a>
              <a href="thread.html#27402">[ thread ]</a>
              <a href="subject.html#27402">[ subject ]</a>
              <a href="author.html#27402">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey,

Thanks for your reply! The json data should never be too long so I'm not
worried about the memory usage, I need the whole json object to start
working anyway realistically - I was more concerned about blocking reading
the data from the network - specifically the request.content.read(), if the
client happens to be sending it very slowly this would block everything up
right? - or would this not be an issue?

Maybe because I have fairly small content bodies I wont have to worry?

Payl


On 4 September 2013 22:45, Glyph &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> On Sep 4, 2013, at 10:48 AM, Paul Wiseman &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">poalman at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I'm still pretty new to twisted and feel I'm slowly getting the hang of
</I>&gt;<i> it, enough to realise that this line of code is probably going to block and
</I>&gt;<i> not do me any favours, the line is the first line in a resource.Resource
</I>&gt;<i> render_POST.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; json_request = json.loads(request.content.read())
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The resource.Resource is a child of another resource which is passed to
</I>&gt;<i> server.Site which is passed to internent.TCPServer.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The problem is I can't work out how I can read the post data from the
</I>&gt;<i> request in an async way.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have a feeling I need to implement a protocol, I'm guessing a
</I>&gt;<i> LineReceiver but I can't figure out how I'd tie that in with my current
</I>&gt;<i> solution or specifically how the LineReceiver would even read
</I>&gt;<i> asynchronously to be honest..
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Maybe the read is fine? I need the whole post data to do anything useful
</I>&gt;<i> I guess as I can't string to a json decoder that I'm aware of. Just it will
</I>&gt;<i> block everything up while I read, which shouldn't be long but I guess I'm
</I>&gt;<i> bound to the speed of the person posting.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks all!
</I>&gt;<i>
</I>&gt;<i> If you're parsing a JSON object, you're going to be representing the whole
</I>&gt;<i> thing in memory at the end of the interaction regardless, even if you
</I>&gt;<i> parsed it and buffered it in an event-driven way.
</I>&gt;<i>
</I>&gt;<i> That means you need to keep this data relatively small no matter what; if
</I>&gt;<i> it's arbitrarily large, you are going to start swapping anyway.
</I>&gt;<i>
</I>&gt;<i> So probably, just doing the blocking parse is fine.  You might be able to
</I>&gt;<i> save a *little* memory by parsing it as it comes in, but you're also going
</I>&gt;<i> to have to write your own JSON parser, which is probably going to take more
</I>&gt;<i> programmer time than you will ever save in execution time by this marginal
</I>&gt;<i> memory reduction :-).  Better would be to spend that effort enforcing
</I>&gt;<i> stringent resource limits so that you will give up reading before you ever
</I>&gt;<i> get to the parse in the case where it's big enough to cause a problem.
</I>&gt;<i>
</I>&gt;<i> -glyph
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20130905/924eaa60/attachment-0001.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20130905/924eaa60/attachment-0001.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027397.html">[Twisted-Python] Asynchronously reading posted data
</A></li>
	<LI>Next message: <A HREF="027405.html">[Twisted-Python] Asynchronously reading posted data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27402">[ date ]</a>
              <a href="thread.html#27402">[ thread ]</a>
              <a href="subject.html#27402">[ subject ]</a>
              <a href="author.html#27402">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
