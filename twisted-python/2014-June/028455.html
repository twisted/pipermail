<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twistedcat - twisted endpoint concatenator
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twistedcat%20-%20twisted%20endpoint%20concatenator&In-Reply-To=%3C94DBA4C4-072C-4068-B969-15E98554E85D%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028451.html">
   <LINK REL="Next"  HREF="028453.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twistedcat - twisted endpoint concatenator</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twistedcat%20-%20twisted%20endpoint%20concatenator&In-Reply-To=%3C94DBA4C4-072C-4068-B969-15E98554E85D%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] twistedcat - twisted endpoint concatenator">glyph at twistedmatrix.com
       </A><BR>
    <I>Sat Jun 21 22:02:57 MDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="028451.html">[Twisted-Python] twistedcat - twisted endpoint concatenator
</A></li>
        <LI>Next message: <A HREF="028453.html">[Twisted-Python] [RELEASE] Nevow 0.11.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28455">[ date ]</a>
              <a href="thread.html#28455">[ thread ]</a>
              <a href="subject.html#28455">[ subject ]</a>
              <a href="author.html#28455">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jun 21, 2014, at 7:12 AM, David Stainton &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dstainton415 at gmail.com</A>&gt; wrote:

&gt;<i> Greetings,
</I>&gt;<i> 
</I>&gt;<i> I was inspired by the &quot;socat&quot; CLI utility to write something similar called twistedcat.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://github.com/david415/twistedcat">https://github.com/david415/twistedcat</A>
</I>&gt;<i> <A HREF="https://github.com/david415/twistedcat/blob/master/twistedcat/twistedcat.py">https://github.com/david415/twistedcat/blob/master/twistedcat/twistedcat.py</A>
</I>&gt;<i> 
</I>&gt;<i> Obviously it should have the &quot;cat&quot; word in the name... so what do you suggest?
</I>
How about &quot;nocat&quot; (network oriented cat), in honor of &lt;<A HREF="http://quoteinvestigator.com/2012/02/24/telegraph-cat/">http://quoteinvestigator.com/2012/02/24/telegraph-cat/</A>&gt;?

&gt;<i> What do people think of this?
</I>&gt;<i> Do you have ascii art drawings of cats can use or suggestions for me to improve the code quality?
</I>
Are you saying that you have internet access, but cannot find pictures of cats? :-)

&gt;<i> Right now I'm cleaning the code out of main() and creating an EndpointCombiner class
</I>&gt;<i> to encapsulate the endpoint pipe logic (c2c, s2s, c2s).
</I>&gt;<i> 
</I>&gt;<i> The reason I am very interested in improving the code to assist in pipe-lining endpoints is because it can be used by more than just this commandline tool. Any Twisted app wishing to create custom protocols can do so by pipe-lining endpoints. I think the API for this could be very easy to use.
</I>
We do have some work going in to making a generic wrapper-endpoint facility so it's easier to add wrapping to endpoints.  The branch for &lt;<A HREF="https://twistedmatrix.com/trac/ticket/5642#comment:28">https://twistedmatrix.com/trac/ticket/5642#comment:28</A>&gt; has such features.

&gt;<i> socat has an enormous feature set that I am not sufficiently motivated to duplicate here.
</I>
Yes, I think it would be better to focus on the alternate/awesome features that Twisted already gives you, rather than aiming for parity.

&gt;<i> <A HREF="http://www.dest-unreach.org/socat/doc/socat.html#ADDRESS_TYPES">http://www.dest-unreach.org/socat/doc/socat.html#ADDRESS_TYPES</A>
</I>&gt;<i> 
</I>&gt;<i> It was really interesting for me to read about these socat address types... there are many of them.
</I>&gt;<i> Twisted has some of the same types... and in some cases they are even spelled the same.
</I>&gt;<i> I am interested in implementing some of these socat address types in Twisted, including a TUN endpoint and endpoint parser plugin.
</I>&gt;<i> I've played around with the new twisted pair TUN stuff... but I was using producers and consumers to make a VPN...
</I>&gt;<i> and as it turns out this task should be greatly simplified by using pipelined Twisted endpoints.
</I>
Well, this all sounds amazing to me.  Please keep us posted!

&gt;<i> I've also been toying with the idea of writing an obfsproxy Twisted endpoint which would work similar to the txtorcon endpoint in that it would launch an external command... and then perform a tcp connect. obfsproxy can be launched in external mode and has several obfuscation protocols to choose from... some of which are very sophisticated. If someone actually had a good use case for obfuscating pipelined endpoint protocols then I would love to hear about it (besides the obvious VPN use-case)!
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://www.torproject.org/projects/obfsproxy">https://www.torproject.org/projects/obfsproxy</A>
</I>&gt;<i> 
</I>&gt;<i> Twisted endpoint descriptor strings are just like socat address specifications... except that in socat the client and server endpoint types are in the same name space. Therefore twistedcat needs to know if the endpoint string is a server or client endpoint. It defaults to client unless -s or --server specifies it as a server endpoint string. Or do you dare suggest that it would be better to try clientFromString and then if that fails try serverFromString?
</I>
Personally I think having a -s option (or -l to follow the tradition set forth by nc?) to be explicit is better.

Have you considered making wrappers in both directions though: a string-parsing plugin that turns a server endpoint into a client endpoint by making .listen() call connect, and one that turns a client endpoint into a server endpoint by having .connect() listen and wait for the first inbound connection?

&gt;<i> We've already created a Tor client endpoint/parser plugin (<A HREF="https://github.com/david415/txsocksx">https://github.com/david415/txsocksx</A>)
</I>&gt;<i> and a Tor Hidden Service endpoint/parser plugin (<A HREF="https://github.com/meejah/txtorcon">https://github.com/meejah/txtorcon</A>)...
</I>&gt;<i> Obviously twistedcat doesn't know anything about Tor... because it's completely endpoint agnostic.
</I>&gt;<i> 
</I>&gt;<i> Here's my silly twistedcat Tor experimentations:
</I>&gt;<i> 
</I>&gt;<i> $ ./twistedcat.py -s stdio: -s onion:80:hiddenServiceDir=/home/human/hs
</I>&gt;<i> 
</I>&gt;<i> After running this one liner... I checked the contents of /home/human/hs/
</I>&gt;<i> and found my new onion address in the &quot;hostname&quot; file.
</I>&gt;<i> I used my Tor browser to send a request... and here we see twistedcat printed it to stdout via the stdio endpoint:
</I>&gt;<i> 
</I>&gt;<i> GET / HTTP/1.1
</I>&gt;<i> Host: ibce3yvjdb3mzcrq.onion
</I>&gt;<i> User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:24.0) Gecko/20100101 Firefox/24.0
</I>&gt;<i> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
</I>&gt;<i> Accept-Language: en-us,en;q=0.5
</I>&gt;<i> Accept-Encoding: gzip, deflate
</I>&gt;<i> Connection: keep-alive
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> And then there is this:
</I>&gt;<i> 
</I>&gt;<i> $ ./twistedcat.py tor:timaq4ygg2iegci7.onion:80 -s onion:80:hiddenServiceDir=/home/human/hs
</I>&gt;<i> 
</I>&gt;<i> Which of course proxies requests from my new onion to timaq4ygg2iegci7.onion... the onion address of the txtordoc documentation website.
</I>&gt;<i> But this is crazy... um how many hops is that exactly? 14? 15?
</I>
Sounds like fun to me :-).

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20140621/73d72e11/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20140621/73d72e11/attachment.html</A>&gt;
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028451.html">[Twisted-Python] twistedcat - twisted endpoint concatenator
</A></li>
	<LI>Next message: <A HREF="028453.html">[Twisted-Python] [RELEASE] Nevow 0.11.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28455">[ date ]</a>
              <a href="thread.html#28455">[ thread ]</a>
              <a href="subject.html#28455">[ subject ]</a>
              <a href="author.html#28455">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
