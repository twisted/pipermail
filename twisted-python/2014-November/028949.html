<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How do I debug this network problem?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20do%20I%20debug%20this%20network%20problem%3F&In-Reply-To=%3C20141114203607.13007.153683668.divmod.xquotient.8%40top%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028948.html">
   <LINK REL="Next"  HREF="028950.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How do I debug this network problem?</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20do%20I%20debug%20this%20network%20problem%3F&In-Reply-To=%3C20141114203607.13007.153683668.divmod.xquotient.8%40top%3E"
       TITLE="[Twisted-Python] How do I debug this network problem?">exarkun at twistedmatrix.com
       </A><BR>
    <I>Fri Nov 14 13:36:07 MST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="028948.html">[Twisted-Python] How do I debug this network problem?
</A></li>
        <LI>Next message: <A HREF="028950.html">[Twisted-Python] How do I debug this network problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28949">[ date ]</a>
              <a href="thread.html#28949">[ thread ]</a>
              <a href="subject.html#28949">[ subject ]</a>
              <a href="author.html#28949">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05:38 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">peter.westlake at pobox.com</A> wrote:
&gt;<i>
</I>&gt;<i>Here is some highly suspicious-looking output from strace:
</I>&gt;<i>
</I>&gt;<i>sendto(5, &quot;\0\4_ask\0\004867c\0\10_command\0\tLogOutpu&quot;..., 343, 0,
</I>&gt;<i>NULL, 0) = 343 recvfrom(5,
</I>&gt;<i>&quot;\0\7_answer\0\004867c\0\6status\0\4True\0\0&quot;, 65536, 0, NULL, NULL) =
</I>&gt;<i>31 sendto(5, &quot;\0\4_ask\0\004867d\0\10_command\0\tLogOutpu&quot;..., 183, 0,
</I>&gt;<i>NULL, 0) = 183 sendto(5, &quot;\0\4_ask\0\004867e\0\10_command\0\4Ping\0\0&quot;,
</I>&gt;<i>30, 0, NULL, 0) = 30 recvfrom(5, 0x7fec3005c6d4, 65536, 0, 0, 0) = -1
</I>&gt;<i>EAGAIN (Resource temporarily unavailable) sendto(5,
</I>&gt;<i>&quot;\0\4_ask\0\004867f\0\10_command\0\4Ping\0\0&quot;, 30, 0, NULL, 0) = 30
</I>&gt;<i>recvfrom(5, &quot;\0\7_answer\0\004867f\0\3ack\0\4True\0\0&quot;, 65536, 0, NULL,
</I>&gt;<i>NULL) = 28
</I>&gt;<i>
</I>&gt;<i>Requests 867d and 867e never receive their callbacks.
</I>
But in this trace, it looks like those two calls also never received a 
response from the server - so it's correct that the callbacks never 
fire.

Keep in mind this is a totally valid AMP interaction.  The reason these 
things have unique identifiers is so responses can arrive out of order.

Earlier you mentioned you saw tcpdump reporting that the response data 
corresponding to the unfired Deferreds was arriving.  Can you double 
check that?  From this `strace` output I would guess that it isn't.  The 
alternative explanation is a terrible, data-losing bug in the kernel's 
TCP stack...
&gt;<i>I see that twisted.internet.tcp.Connection.doRead() does check for
</I>&gt;<i>EWOULDBLOCK (=EAGAIN), and returns None. Shouldn't it try to read 
</I>&gt;<i>again?
</I>
It will try again - later, when select or epoll or whatever tells it 
that there's a better chance of some data coming out.

Jean-Paul

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028948.html">[Twisted-Python] How do I debug this network problem?
</A></li>
	<LI>Next message: <A HREF="028950.html">[Twisted-Python] How do I debug this network problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28949">[ date ]</a>
              <a href="thread.html#28949">[ thread ]</a>
              <a href="subject.html#28949">[ subject ]</a>
              <a href="author.html#28949">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
