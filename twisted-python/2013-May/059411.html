<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Recommended daemon monitoring tools for ubuntu
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Recommended%20daemon%20monitoring%20tools%20for%20ubuntu&In-Reply-To=%3C4733ab28-9f0f-41b2-9c57-846e4d407157%40me.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059410.html">
   <LINK REL="Next"  HREF="059420.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Recommended daemon monitoring tools for ubuntu</H1>
    <B>Louis D. Burr</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Recommended%20daemon%20monitoring%20tools%20for%20ubuntu&In-Reply-To=%3C4733ab28-9f0f-41b2-9c57-846e4d407157%40me.com%3E"
       TITLE="[Twisted-Python] Recommended daemon monitoring tools for ubuntu">ldanielburr at me.com
       </A><BR>
    <I>Thu May 16 12:14:38 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059410.html">[Twisted-Python] Recommended daemon monitoring tools for ubuntu
</A></li>
        <LI>Next message (by thread): <A HREF="059420.html">[Twisted-Python] Recommended daemon monitoring tools for ubuntu
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59411">[ date ]</a>
              <a href="thread.html#59411">[ thread ]</a>
              <a href="subject.html#59411">[ subject ]</a>
              <a href="author.html#59411">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On May 16, 2013, at 12:34 PM, Justin Venus &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">justin.venus at gmail.com</A>&gt; wrote:

&gt;<i> IMO monit is pretty easy to setup and probably your best bet.  However you could get puppet, chef, or cfengine to start processes for you.  If you are feeling adventurous, you could set up something like apache mesos to keep your tasks running.
</I>&gt;<i>
</I>&gt;<i> Justin Venus
</I>&gt;<i> On May 16, 2013 10:27 AM, &quot;Jonathan Vanasco&quot; &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at 2xlp.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     Hi,
</I>&gt;<i>
</I>&gt;<i>     i'm running a twisted daemon on ubuntu
</I>&gt;<i>
</I>&gt;<i>     It seems to get shut down by the system periodically.  Logs show that the kernel (or something) kills it for taking up too much memory.  I definitely have coding issues in there that i'm working on to address this.
</I>&gt;<i>
</I>&gt;<i>     Does anyone have a suggestion for tools I can easily use on ubuntu to monitor and restart if needed ?  I haven't had to do something like this in 5 years, and back then it was a hassle to get monit or supervisord working.
</I>&gt;<i>
</I>&gt;<i>     thanks
</I>&gt;<i>
</I>&gt;<i>     /jonathan
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     Twisted-Python mailing list
</I>&gt;<i>     <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i>     <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I> 

Another simple option is to use twisted's own procmon.ProcessMonitor to launch your twistd daemon.  You can use it &quot;out of the box&quot;, or implement your own service based upon it, e.g.,


from twisted.python import usage
from twisted.runner import procmon



class Options(usage.Options):
    synopsis = '[mymonitor options] commandline'

    optParameters = (
        (
            'threshold',
            't',
            1,
            'How many seconds a process has to run before it is considered to have died instantly.',
            float
        ),
        (
            'killtime',
            'k',
            5,
            'How many seconds a process being killed has to get its affairs in order before it gets killed with an unmaskable signal.',
            float
        ),
        (
            'minrestartdelay',
            'm',
            1,
            'The minimum number of seconds to wait before attempting to restart a process.',
            float
        ),
        (
            'maxrestartdelay',
            'M',
            3600,
            'The maximum number of seconds to wait before attempting to restart a process.',
            float
        )
    )

    optFlags = ()


    longdesc = &quot;&quot;&quot;Blah blah blah&quot;&quot;&quot;

    def parseArgs(self, *args):
        &quot;&quot;&quot;
        Grab the command line that is going to be started and monitored
        &quot;&quot;&quot;
        self['args'] = args


    def postOptions(self):
        &quot;&quot;&quot;
        Check for dependencies.
        &quot;&quot;&quot;
        if len(self['args']) &lt; 1:
            raise usage.UsageError('Please specify a process commandline')


def makeService(config):
    from twisted.internet import reactor

    myMonitorService = procmon.ProcessMonitor(reactor)

    myMonitorService.threshold = config['threshold']
    myMonitorService.killTime = config['killtime']
    myMonitorService.minRestartDelay = config['minrestartdelay']
    myMonitorService.maxRestartDelay = config['maxrestartdelay']
    myMonitorService.addProcess(
        'MyTwistedServiceThatSometimesBlowsUp',
        config['args'],
        uid=None,
        gid=None,
        env={}
    )
    return myMonitorService


Hope this helps,

Danielï»¿
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20130516/f63a03ce/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059410.html">[Twisted-Python] Recommended daemon monitoring tools for ubuntu
</A></li>
	<LI>Next message (by thread): <A HREF="059420.html">[Twisted-Python] Recommended daemon monitoring tools for ubuntu
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59411">[ date ]</a>
              <a href="thread.html#59411">[ thread ]</a>
              <a href="subject.html#59411">[ subject ]</a>
              <a href="author.html#59411">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
