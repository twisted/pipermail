<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Unhandled error in Deferred with twisted-8.2.0,	but not with twisted-2.1.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Unhandled%20error%20in%20Deferred%20with%20twisted-8.2.0%2C%0A%09but%20not%20with%20twisted-2.1.0&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019870.html">
   <LINK REL="Next"  HREF="019872.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Unhandled error in Deferred with twisted-8.2.0,	but not with twisted-2.1.0</H1>
    <B>Rutt, Benjamin</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Unhandled%20error%20in%20Deferred%20with%20twisted-8.2.0%2C%0A%09but%20not%20with%20twisted-2.1.0&In-Reply-To="
       TITLE="[Twisted-Python] Unhandled error in Deferred with twisted-8.2.0,	but not with twisted-2.1.0">Benjamin.Rutt at gs.com
       </A><BR>
    <I>Fri Jun 26 12:33:06 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019870.html">[Twisted-Python] How to disable XMLRPC logging
</A></li>
        <LI>Next message: <A HREF="019872.html">[Twisted-Python] Unhandled error in Deferred with twisted-8.2.0,	but not with twisted-2.1.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19871">[ date ]</a>
              <a href="thread.html#19871">[ thread ]</a>
              <a href="subject.html#19871">[ subject ]</a>
              <a href="author.html#19871">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am currently trying to upgrade to twisted-8.2.0.  For some reason,
twisted-8.2.0 thinks my deferred below was gc'd with an unhandled error,
and tells me about it upon reactor exit.  With
python-2.4.2/twisted-2.1.0, no issues.  With python-2.6.1/twisted-8.2.0,
I see these issues.  Any ideas why?  Thanks.

$ cat ./deferred-errors.py
#!/usr/bin/env python
import datetime, logging, os, random, re, shutil, socket
import subprocess, sys, tempfile, threading, time, traceback

from twisted.internet       import reactor
from twisted.internet       import defer
from twisted.internet.utils import getProcessOutput
from twisted.python         import log
import twisted

print 'twisted version is', twisted.__version__

def foo():
    d = getProcessOutput('/bin/hostnameX')
    def cb(result):
        print 'cb: %s' % (result)
    def eb(failure):
        print 'eb caught the failure!'
    d.addCallback(cb)
    d.addErrback(eb)

reactor.callWhenRunning(foo)
reactor.callLater(3, reactor.stop)
reactor.run()

$ /sw/external/python-2.4.2/bin/python ./deferred-errors.py 
twisted version is 2.1.0
eb caught the failure!

$ /sw/external/python-2.6.1/bin/python ./deferred-errors.py 
twisted version is 8.2.0
eb caught the failure!
Unhandled error in Deferred:
Traceback (most recent call last):
Failure: twisted.internet.error.ProcessTerminated: A process has ended
with a probable error condition: process ended with exit code 1.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20090626/dcb43718/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20090626/dcb43718/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019870.html">[Twisted-Python] How to disable XMLRPC logging
</A></li>
	<LI>Next message: <A HREF="019872.html">[Twisted-Python] Unhandled error in Deferred with twisted-8.2.0,	but not with twisted-2.1.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19871">[ date ]</a>
              <a href="thread.html#19871">[ thread ]</a>
              <a href="subject.html#19871">[ subject ]</a>
              <a href="author.html#19871">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
