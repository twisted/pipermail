<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Dropin.cache errors after clean	installof	twisted-8.2.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Dropin.cache%20errors%20after%20clean%0A%09installof%09twisted-8.2.0&In-Reply-To=20090618051836.12555.2104995843.divmod.xquotient.12754%40weber.divmod.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019833.html">
   <LINK REL="Next"  HREF="019822.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Dropin.cache errors after clean	installof	twisted-8.2.0</H1>
    <B>Rutt, Benjamin</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Dropin.cache%20errors%20after%20clean%0A%09installof%09twisted-8.2.0&In-Reply-To=20090618051836.12555.2104995843.divmod.xquotient.12754%40weber.divmod.com"
       TITLE="[Twisted-Python] Dropin.cache errors after clean	installof	twisted-8.2.0">Benjamin.Rutt at gs.com
       </A><BR>
    <I>Thu Jun 18 11:09:07 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019833.html">[Twisted-Python] Dropin.cache errors after clean install	of	twisted-8.2.0
</A></li>
        <LI>Next message: <A HREF="019822.html">[Twisted-Python] Twisted perspective broker on port 80, problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19839">[ date ]</a>
              <a href="thread.html#19839">[ thread ]</a>
              <a href="subject.html#19839">[ subject ]</a>
              <a href="author.html#19839">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I installed twisted on linux (RHEL4), solx86 and solsparc using 'python
setup.py install --home=...'.  

I looked at ticket 2410.  I see that you added a thorough summary of the
problem recently on that ticket - thank you.  While I would like to help
if I could, I'm afraid I don't know enough about the python packaging
technical details to be of much use.  Was not aware setup.py could not
run arbitrary code at the end.  Thanks for the discussion - I'll work
around it as needed via python -c 'from twisted.plugin import IPlugin,
getPlugins; list(getPlugins(IPlugin))' as a post-install hook of my own.

Until a solution emerges, I suppose the INSTALL file in the root of the
distribution could contain this text?

  * Other
    As with other Python packages, the standard way of installing from
source
    is:

      python setup.py install

    If you install from source you may wish to generate the plugin
cache, post-install, via:

      python -c 'from twisted.plugin import IPlugin, getPlugins;
list(getPlugins(IPlugin))'

    See
<A HREF="http://twistedmatrix.com/projects/core/documentation/howto/plugin.html">http://twistedmatrix.com/projects/core/documentation/howto/plugin.html</A>
for more details.

Although it would complicate the INSTALL file quite a bit for an
admittedly minor issue.  Thanks.

-----Original Message-----
From: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-bounces at twistedmatrix.com</A>
[mailto:<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-bounces at twistedmatrix.com</A>] On Behalf Of
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at divmod.com</A>
Sent: Thursday, June 18, 2009 1:19 AM
To: Twisted general discussion
Subject: Re: [Twisted-Python] Dropin.cache errors after clean installof
twisted-8.2.0


On 17 Jun, 07:47 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">benjamin.rutt at gs.com</A> wrote:
&gt;<i>I recently installed python-2.6.1 and then twisted-8.2.0 (outside of 
</I>&gt;<i>the
</I>&gt;<i>python tree).  One of my users is complaining that when he uses trial 
</I>&gt;<i>to
</I>&gt;<i>test some twisted programs, although his test passes, he has to stare 
</I>&gt;<i>at
</I>&gt;<i>a stack trace like this which mentions dropin.cache.new failing to be
</I>&gt;<i>written:
</I>
How did you install Twisted?  What distribution are you using?
&gt;<i>I would consider this to be an install bug.  Evidently, trial uses
</I>&gt;<i>plugins, (...)
</I>
I would also consider this to be an installer bug.
&gt;<i>Regardless of whether ticket 2409 goes anywhere, should I raise an 
</I>&gt;<i>issue
</I>&gt;<i>that the install should really take care of initial dropin.cache
</I>&gt;<i>generation, much like python install takes care of std lib .py-&gt;.pyc
</I>&gt;<i>generation?
</I>
No need to open a new ticket.  Here's the one you're looking for:

    <A HREF="http://twistedmatrix.com/trac/ticket/2410">http://twistedmatrix.com/trac/ticket/2410</A>

It would be very helpful if you would add a patch for this ticket, 
though; I'll go so far as to personally volunteer to review it until 
it's done if you do.

However, that ticket is somewhat anemic in its description of the 
problem.  Please be aware that distutils doesn't support post-install 
hooks in a general way (it leaves things up to the various 'bdist_' 
plugins), so it's hard to do this in a way which is unambiguously 
correct.  For example, the way post-installation scripts are specified 
to bdist_wininst, bdist_rpm, and bdist_msi are all subtly different. 
Also, the debian and redhat packages for twisted use 'setup.py install' 
but install to a different root, and then have their own custom post- 
installation hooks.  I'm sure that other packages (gentoo, for example) 
probably invoke setup.py as well, in slightly different ways.  bdist_egg

doesn't allow for post-installation hooks *at all*, as you can see from 
&lt;<A HREF="http://bugs.python.org/setuptools/issue41">http://bugs.python.org/setuptools/issue41</A>&gt;.  So something that modified

the behavior of setup.py install would have to carefully encapsulate its

post-install hook and only invoke it if appropriate.

If you manage to circumnavigate all this nonsense and produce a nice, 
simple post-install hook with some unit tests, you will be a Twisted 
hero :).

_______________________________________________
Twisted-Python mailing list
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019833.html">[Twisted-Python] Dropin.cache errors after clean install	of	twisted-8.2.0
</A></li>
	<LI>Next message: <A HREF="019822.html">[Twisted-Python] Twisted perspective broker on port 80, problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19839">[ date ]</a>
              <a href="thread.html#19839">[ thread ]</a>
              <a href="subject.html#19839">[ subject ]</a>
              <a href="author.html#19839">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
