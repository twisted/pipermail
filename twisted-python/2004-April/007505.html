<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: [Twisted-commits] r10475 - Use writeSequence	instead of silly for-loop.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20%5BTwisted-commits%5D%20r10475%20-%20Use%20writeSequence%0A%09instead%20of%20silly%20for-loop.&In-Reply-To=1082052017.24618.382.camel%40sheriffpony">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007504.html">
   <LINK REL="Next"  HREF="007506.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: [Twisted-commits] r10475 - Use writeSequence	instead of silly for-loop.</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20%5BTwisted-commits%5D%20r10475%20-%20Use%20writeSequence%0A%09instead%20of%20silly%20for-loop.&In-Reply-To=1082052017.24618.382.camel%40sheriffpony"
       TITLE="[Twisted-Python] Re: [Twisted-commits] r10475 - Use writeSequence	instead of silly for-loop.">bob at redivi.com
       </A><BR>
    <I>Thu Apr 15 14:27:16 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007504.html">[Twisted-Python] Re: [Twisted-commits] r10475 - Use	writeSequence instead of silly for-loop.
</A></li>
        <LI>Next message: <A HREF="007506.html">[Twisted-Python] Re: [Twisted-commits] r10475 - Use writeSequence	instead of silly for-loop.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7505">[ date ]</a>
              <a href="thread.html#7505">[ thread ]</a>
              <a href="subject.html#7505">[ subject ]</a>
              <a href="author.html#7505">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Apr 15, 2004, at 2:00 PM, Itamar Shtull-Trauring wrote:

&gt;<i> On Thu, 2004-04-15 at 13:27, James Y Knight wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Unfortunately, python doesn't expose the writev syscall, which means
</I>&gt;&gt;<i> that you depend on Nagling to not coalesce the TCP packets. There *is*
</I>&gt;&gt;<i> a TCP option which you can use to help fix too many small packets:
</I>&gt;&gt;<i> TCP_CORK on linux and TCP_NOPUSH on FreeBSD. This keeps partial 
</I>&gt;&gt;<i> packets
</I>&gt;&gt;<i> from being sent at all until you close the connection or turn off the
</I>&gt;&gt;<i> option (except on older freebsd, where it's broken and you need to 
</I>&gt;&gt;<i> turn
</I>&gt;&gt;<i> off the option and call write again to wake it up).
</I>&gt;<i>
</I>&gt;<i> JP has code for using writev in the sandbox (sandbox/exarkun/iovec/)
</I>&gt;<i> which ought to be integrated at some point.
</I>
I think the best answer to this performance talk is: don't bother.  I 
once set out to fix his implementation, and did (but I'm not sure what 
happened to it).  It wasn't really much faster, definitely not enough 
to warrant an extension.  You know what?  The overhead doesn't seem to 
be in the write calls or the str joins, it's the rest of Python that's 
slow :)

I think that this sort of time would be better spent on epoll and 
kqueue.  Last I checked, enabling kqueue in Twisted required 
downloading some ancient code written for Python 1.5 from a ftp site 
that hasn't been updated since 2001, patching it, writing a makefile 
for your platform, and building the extension separately.

-bob



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007504.html">[Twisted-Python] Re: [Twisted-commits] r10475 - Use	writeSequence instead of silly for-loop.
</A></li>
	<LI>Next message: <A HREF="007506.html">[Twisted-Python] Re: [Twisted-commits] r10475 - Use writeSequence	instead of silly for-loop.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7505">[ date ]</a>
              <a href="thread.html#7505">[ thread ]</a>
              <a href="subject.html#7505">[ subject ]</a>
              <a href="author.html#7505">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
