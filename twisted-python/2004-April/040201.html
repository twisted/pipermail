<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted gtk-reactor bug 552
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted%20gtk-reactor%20bug%20552&In-Reply-To=%3C408D835E.2050309%40lbl.gov%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040204.html">
   <LINK REL="Next"  HREF="040205.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted gtk-reactor bug 552</H1>
    <B>David E. Konerding DSD Staff</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted%20gtk-reactor%20bug%20552&In-Reply-To=%3C408D835E.2050309%40lbl.gov%3E"
       TITLE="[Twisted-Python] twisted gtk-reactor bug 552">dekonerding at lbl.gov
       </A><BR>
    <I>Mon Apr 26 15:47:10 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040204.html">[Twisted-Python] Bug in reactor.iterate()?
</A></li>
        <LI>Next message (by thread): <A HREF="040205.html">[Twisted-Python] Zope3 components port status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40201">[ date ]</a>
              <a href="thread.html#40201">[ thread ]</a>
              <a href="subject.html#40201">[ subject ]</a>
              <a href="author.html#40201">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm checking in again to see if anybody had taken a look at my bug report,

<A HREF="http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue552">http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue552</A>

I discussed it a little bit on a slow day on IRC, but nobody had any 
solutions.
However, it was reproduced on NetBSD-current w/ pygtk-2 and gtk-2.4, so I'm
pretty sure it's not specific to my location.

In summary:

I'm using the gtk2reactor, and periodically scheduled events (invoked 
via reactor.callLater-&gt;reactor.callInThread)
are not being fired in a timely fashion.  When I originally mentioned 
the bug on the mailing list, people thought
I was calling 'sleep' in the main (reactor) thread, but actually, sleep 
is only called in another thread, and
it works fine with the plain reactor and the wx reactor.

Here is the example program (you should see 'TestThingy message' every 
0.1 seconds or so..)
Note that the bug report has two lines improperly indented.

import time, sys

from twisted.internet import gtk2reactor
gtk2reactor.install()
from twisted.python import threadable
threadable.init()
from twisted.internet import reactor
from twisted.python import log
log.startLogging(sys.stdout)

class TestThingy:
 def __init__(self):
     print &quot;TestThingy created&quot;

 def run(self):
     print &quot;TestThingy run&quot;
     for i in range(10):
         print &quot;TestThingy message&quot;
         time.sleep(0.1)
     print &quot;TestThingy done&quot;

class ThingyManager:
 def __init__(self):
     pass

 def submitThingy(self):
     log.err(&quot;ThingyManager submitting&quot;)
     f = TestThingy()
     log.err(&quot;ThingyManager created&quot;)
     reactor.callInThread(f.run)
     log.err(&quot;ThingyManager calledInThread&quot;)

def ticker(*args):
 log.err(&quot;ticker: %d&quot; % time.time())
 reactor.callLater(1, ticker)

t = ThingyManager()
reactor.callLater(0, ticker)
reactor.callLater(3, t.submitThingy)
reactor.run()
log.err(&quot;Reactor done&quot;)


Dave




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040204.html">[Twisted-Python] Bug in reactor.iterate()?
</A></li>
	<LI>Next message (by thread): <A HREF="040205.html">[Twisted-Python] Zope3 components port status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40201">[ date ]</a>
              <a href="thread.html#40201">[ thread ]</a>
              <a href="subject.html#40201">[ subject ]</a>
              <a href="author.html#40201">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
