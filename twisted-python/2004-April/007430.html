<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Perspective Broker and [WINSOCK] Connection reset	by peer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Perspective%20Broker%20and%20%5BWINSOCK%5D%20Connection%20reset%0A%09by%20peer&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007428.html">
   <LINK REL="Next"  HREF="007432.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Perspective Broker and [WINSOCK] Connection reset	by peer</H1>
    <B>Justin Johnson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Perspective%20Broker%20and%20%5BWINSOCK%5D%20Connection%20reset%0A%09by%20peer&In-Reply-To="
       TITLE="[Twisted-Python] Perspective Broker and [WINSOCK] Connection reset	by peer">justinjohnson at fastmail.fm
       </A><BR>
    <I>Fri Apr  2 10:10:32 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007428.html">[Twisted-Python] Trivial bug in StandardIO.connectionLost()
</A></li>
        <LI>Next message: <A HREF="007432.html">[Twisted-Python] Can I connect multiple class instances to 1	Twisted factory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7430">[ date ]</a>
              <a href="thread.html#7430">[ thread ]</a>
              <a href="subject.html#7430">[ subject ]</a>
              <a href="author.html#7430">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm trying to track down a problem and I'm not sure if Twisted is
involved or not.  Here are the details.

I administer Rational ClearCase.  One task I do is removing repositories
(a repository is called a VOB in ClearCase).  If I am logged onto the
machine locally I run the command &quot;cleartool rmvob -f C:\VOBs\myvob.vbs&quot;.
 ClearCase uses RPC calls in some manner unknown to me for most of its
operations (probably with this command too).  So when I run the command,
some RPC interaction probably takes place and then the VOB is removed. 
The command is being run on the server where the VOB exists, but I
believe it still uses RPC, even if everything is local.

I have been using Twisted, specifically PB, to help me administer these
servers.  The PB service has a method remote_rmvob that can be called
remotely to remove a VOB.  Sometimes this works, but other times I get
the following error:

[WINSOCK] Connection reset by peer
cleartool: Error: Versioned object base &quot;C:\VOBS\myvob.vbs&quot; not deleted.
cleartool: Error: Trouble removing versioned object base
&quot;C:\VOBS\myvob.vbs&quot;.

If I retry the PB operation again and again, eventually it succeeds.  On
some servers it takes more retries than others to get a successful
removal, but eventually it succeeds.  If I run the command locally with
no PB/Twisted involved I never get this error.

So I've been doing some research on this WINSOCK error, trying to
determine if it is being caused by the fact that I'm running the command
via PB.

The site <A HREF="http://frontier.userland.com/discuss/msgReader$173">http://frontier.userland.com/discuss/msgReader$173</A> has the
following info:

10054

WSAECONNRESET -- Connection reset by peer. This occurs when an
established connection is shut down for some reason by the remote
computer. 

The following thread discusses a similar problem with rsync where the
connection wasn't shutdown gracefully and a similar error occurred.

<A HREF="http://lists.samba.org/archive/rsync/2001-October/000407.html">http://lists.samba.org/archive/rsync/2001-October/000407.html</A>
<A HREF="http://lists.samba.org/archive/rsync/2002-April/002076.html">http://lists.samba.org/archive/rsync/2002-April/002076.html</A>

Does anyone with more networking knowledge than me have any ideas on what
might be causing this problem?  All I have is fuzzy ideas in my head,
like the command running in a ProcessProtocol might cause some problems,
or PB closing the connection before some important thing happens, ...  As
you can see, it is very fuzzy for me.  :-(

Any help you can provide is appreciated.
Thanks.
-Justin


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007428.html">[Twisted-Python] Trivial bug in StandardIO.connectionLost()
</A></li>
	<LI>Next message: <A HREF="007432.html">[Twisted-Python] Can I connect multiple class instances to 1	Twisted factory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7430">[ date ]</a>
              <a href="thread.html#7430">[ thread ]</a>
              <a href="subject.html#7430">[ subject ]</a>
              <a href="author.html#7430">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
