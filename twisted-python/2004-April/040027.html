<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] New user, help needed with raw UDP packets
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20New%20user%2C%20help%20needed%20with%20raw%20UDP%20packets&In-Reply-To=%3C40806940.9030500%40tv.debian.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040023.html">
   <LINK REL="Next"  HREF="040059.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] New user, help needed with raw UDP packets</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20New%20user%2C%20help%20needed%20with%20raw%20UDP%20packets&In-Reply-To=%3C40806940.9030500%40tv.debian.net%3E"
       TITLE="[Twisted-Python] New user, help needed with raw UDP packets">tv at tv.debian.net
       </A><BR>
    <I>Fri Apr 16 17:16:16 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040023.html">[Twisted-Python] New user, help needed with raw UDP packets
</A></li>
        <LI>Next message (by thread): <A HREF="040059.html">[Twisted-Python] New user, help needed with raw UDP packets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40027">[ date ]</a>
              <a href="thread.html#40027">[ thread ]</a>
              <a href="subject.html#40027">[ subject ]</a>
              <a href="author.html#40027">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Richard Taylor wrote:
&gt;<i> I am writing a UDP proxy/relay that needs to make detailed changes to the 
</I>&gt;<i> internals of the UDP packets as they pass through. I intend to use 'Impacket' 
</I>&gt;<i> to access the packet internals. One of the things that I need is to 'fake' 
</I>&gt;<i> the destination address of packets leaving the proxy so that they look like 
</I>&gt;<i> they have come from the original sender, Impacket has methods to do this for 
</I>&gt;<i> 'raw' udp packets.
</I>&gt;<i> 
</I>&gt;<i> I think that I need to use a sub-class of ConnectedDatagramProtocol to send my 
</I>&gt;<i> packets but the &quot;self.transport.write&quot; method takes only the packet payload 
</I>&gt;<i> not the headers.
</I>
More to the point, normal UDP sockets cannot forge the source IP
address, as you seem to want to do.

You want &quot;twisted.pair&quot;, RawUDPProtocol, and such things I sort of
half-wrote once. It's just about all there, you can make it work, but
it's not very complete and definitely not well documented.

doc/examples/pairudp.py shows a raw packet listener that reads from
a tuntap device and print out UDP packets with destination port 42.
You can also write such packets to the tuntap device, and the kernel
will route them from there on.

If you want to avoid tuntap, use packet sockets -- eunuchs (see
twisted.pair.tuntap docstring) has recvmsg() and sendmsg() wrappers that
should help.

For pcap integration, you're pretty much on your own.


My advice: don't try to do it with Python and Twisted unless you
already know how to do it in C :)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040023.html">[Twisted-Python] New user, help needed with raw UDP packets
</A></li>
	<LI>Next message (by thread): <A HREF="040059.html">[Twisted-Python] New user, help needed with raw UDP packets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40027">[ date ]</a>
              <a href="thread.html#40027">[ thread ]</a>
              <a href="subject.html#40027">[ subject ]</a>
              <a href="author.html#40027">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
