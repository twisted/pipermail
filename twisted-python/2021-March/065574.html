<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] GitHub Actions parallelism limit increase
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20GitHub%20Actions%20parallelism%20limit%20increase&In-Reply-To=%3CCAFycZ9d%3D2g4ou81OkPV2f-_i7NFZ2%3DmSdCq9GPA0q0iAQBz4jg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065573.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] GitHub Actions parallelism limit increase</H1>
    <B>Adi Roiban</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20GitHub%20Actions%20parallelism%20limit%20increase&In-Reply-To=%3CCAFycZ9d%3D2g4ou81OkPV2f-_i7NFZ2%3DmSdCq9GPA0q0iAQBz4jg%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] GitHub Actions parallelism limit increase">adi at roiban.ro
       </A><BR>
    <I>Wed Mar 31 03:45:07 MDT 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065573.html">[Twisted-Python] GitHub Actions parallelism limit increase
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65574">[ date ]</a>
              <a href="thread.html#65574">[ thread ]</a>
              <a href="subject.html#65574">[ subject ]</a>
              <a href="author.html#65574">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 30 Mar 2021, 22:23 Kyle Altendorf, &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sda at fstab.net</A>&gt; wrote:

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 2021-03-30 15:24, Glyph wrote:
</I>&gt;<i> &gt;&gt; On Mar 30, 2021, at 7:57 AM, Kyle Altendorf &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sda at fstab.net</A>&gt; wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Hi All,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Has anyone contacted GitHub to see if they would be willing to
</I>&gt;<i> &gt;&gt; increase the parallelism limit in Actions?  My understanding is that
</I>&gt;<i> &gt;&gt; we maintain two CI systems (GitHub Actions and Azure Pipelines) for
</I>&gt;<i> &gt;&gt; the sake of more parallelism.  While perhaps worthwhile, this doesn't
</I>&gt;<i> &gt;&gt; seem fun.  Maybe GitHub would be willing to help out.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Not as far as I know. Do you want to give it a shot?
</I>&gt;<i>
</I>&gt;<i> That was the plan.  Submitted.  I'll let you all know.
</I>&gt;<i>
</I>
Thanks.

On a related note I am working to reduce the general duration of Twisted CI
jobs.

This should result in keeping the jobs slot busy for less time and allowing
more total jobs per day.

The first step was to enable parallel trial tests. Use both CPUs available
to the CI VMs.
This was already done for Linux and MacOS.

Distributed trial is not yet supported on Windows, but I am working on it.
I already have a working distributed trial for Windows on my system.
It needs various fixed and I have submitted smaller PR for review.

Just getting distrial to work on Windows is not all...as we need to update
and clean the  Twsited test to reduce the side effects.
Linux and macOS are more relaxed in terms of file access and for example
you can delete a file, even if its opened by another process or by the same
process.
Windows is not happy about that.

And then there are the 2 pypy jobs taking 30 minutes each - working to fix
it here <A HREF="https://github.com/twisted/twisted/pull/1543/">https://github.com/twisted/twisted/pull/1543/</A>

And then there are also general CI jobs improvements.

For example we can save about 40 seconds  if we decide to stop sending
coverage to coveralls and only use codecov.io
Another example is save another 1 minute by stop using `tox --notests` and
replace it with something like <A HREF="https://github.com/twisted/python-info-action">https://github.com/twisted/python-info-action</A>
to show the dependencies.
With `tox --notest` we now create the wheels and install the dependencies
twice for each job.

There is an extra 1 minute required for each job to generate the coverage
XML file. We can download all the coverage artifacts and generate the XML
only once.

-------------

Now the actual job duration will differ... I see the pip cache download
taking 2 seconds or 2 minutes.

But on Linux it takes about 4 minutes to run the tests (inside tox with
wheel creation)... and then from 2minutes and above is the extra overhead

Cheers

&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20210331/a52ef5cc/attachment.htm&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065573.html">[Twisted-Python] GitHub Actions parallelism limit increase
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65574">[ date ]</a>
              <a href="thread.html#65574">[ thread ]</a>
              <a href="subject.html#65574">[ subject ]</a>
              <a href="author.html#65574">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
