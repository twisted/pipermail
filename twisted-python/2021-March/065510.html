<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted v21.2.0 breaks Crossbar.io
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20v21.2.0%20breaks%20Crossbar.io&In-Reply-To=%3C10F361D4-F098-4C11-B979-ED0076779F58%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065509.html">
   <LINK REL="Next"  HREF="065511.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted v21.2.0 breaks Crossbar.io</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20v21.2.0%20breaks%20Crossbar.io&In-Reply-To=%3C10F361D4-F098-4C11-B979-ED0076779F58%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Twisted v21.2.0 breaks Crossbar.io">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Mar  3 01:07:44 MST 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065509.html">[Twisted-Python] Twisted v21.2.0 breaks Crossbar.io
</A></li>
        <LI>Next message (by thread): <A HREF="065511.html">[Twisted-Python] Twisted v21.2.0 breaks Crossbar.io
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65510">[ date ]</a>
              <a href="thread.html#65510">[ thread ]</a>
              <a href="subject.html#65510">[ subject ]</a>
              <a href="author.html#65510">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Mar 2, 2021, at 6:10 PM, Jean-Paul Calderone &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Policy aside, this change doesn't seem like much of an improvement to me.  If I were to guess, I would guess the change was made to satisfy some check Mypy is now being asked to make about Twisted.  If that's the case, it seems unfortunate that real-world software is suffering so that a synthetic goal can be achieved.  I do recognize there is a perception that practical value can come from attending to the errors Mypy reports.  It would probably benefit everyone if more care were taken to consider the real-world consequences of changes that are made to satisfy the non-real-world goalposts set by tools like Mypy.
</I>
I do think that Mypy was likely highlighting a real issue here, and it should have been fixed.  We had documented interfaces already, and we were failing to adhere to them properly, and Mypy was complaining about that.

For easy reference, the change that made these fixes is here <A HREF="https://github.com/twisted/twisted/pull/1298">https://github.com/twisted/twisted/pull/1298</A> &lt;<A HREF="https://github.com/twisted/twisted/pull/1298">https://github.com/twisted/twisted/pull/1298</A>&gt;

This genre of fix is definitely something we should unwind over time, although it does make it easier to start mypy-clean rather than have hundreds of exclusion lines that need to be manually adjusted, so on balance I agree with this tradeoff at the point it was made.

Specifically what I mean by &quot;this genre of fix&quot; is that you can always make mypy happy by transforming code like this:

class Thing:
    pass

Thing().stuff()

into code like this:

class Thing:
    @property
    def stuff(self):
        raise AttributeError(&quot;no such thing as `stuff`&quot;)

Thing().stuff()

The runtime behavior is the same, but now Mypy can't tell you about this class of bug any more.

So, at some point, we should slowly unwind all `NotImplementedError` methods and find ways to either implement them for real or make their required use raise at import time.

Finally: let's not develop an aversion to new tooling and change because it might create problems; experience over the last few years has shown me that Mypy can catch tons of real bugs and it's well worth getting the codebase to type check.  If we want to prevent breakages like this in the future, the answer is not to stop trying to get linters and typecheckers to run cleanly with arbitrary changes, but to figure out some kind of continuous integration solution that's actually continuous with our downstream dependencies

If dependencies could start testing against Twisted trunk in some capacity, we could get notified close to when unintentionally breaking changes occur, and dependencies can let us know well before the release happens, and we can either revert or they can fix things if the error is on their end.  If initially, say, crossbar and matrix would like to work with us to set up some kind of repeatable pattern we can suggest to others, that would be great.

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20210303/238728f0/attachment.htm&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065509.html">[Twisted-Python] Twisted v21.2.0 breaks Crossbar.io
</A></li>
	<LI>Next message (by thread): <A HREF="065511.html">[Twisted-Python] Twisted v21.2.0 breaks Crossbar.io
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65510">[ date ]</a>
              <a href="thread.html#65510">[ thread ]</a>
              <a href="subject.html#65510">[ subject ]</a>
              <a href="author.html#65510">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
