<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] automat question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20automat%20question&In-Reply-To=%3C0BC099BC-DFC3-4588-8A03-A2A14C904F9B%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065559.html">
   <LINK REL="Next"  HREF="065537.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] automat question</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20automat%20question&In-Reply-To=%3C0BC099BC-DFC3-4588-8A03-A2A14C904F9B%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] automat question">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Mar 16 15:28:07 MDT 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065559.html">[Twisted-Python] automat question
</A></li>
        <LI>Next message (by thread): <A HREF="065537.html">[Twisted-Python] Strange recursion error with twisted.web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65561">[ date ]</a>
              <a href="thread.html#65561">[ thread ]</a>
              <a href="subject.html#65561">[ subject ]</a>
              <a href="author.html#65561">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

&gt;<i> On Mar 16, 2021, at 1:09 AM, Chris Withers &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">chris at withers.org</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 15/03/2021 09:34, Glyph wrote:
</I>&gt;&gt;&gt;<i> Right, but as best I can tell, outputs in automat have to be defined as part of the state machine class, I need targets only available after class instantiation to be notified.
</I>&gt;&gt;<i> Outputs are just methods, so it sort of depends what you mean by &quot;after class instantiation&quot;.  You can call whatever you want /in/ an output.
</I>&gt;<i> 
</I>&gt;<i> Right, but then I'd have to maintain my own list of subscribers and figure out a way to duplicate in that logic in each of the output methods defined on the machine.
</I>&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Again... have outputs.  I think there's something you're leaving out about how you want to have some /generalized/ output, but without knowing a bit more it's hard to say how it could help more :).
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> I think it's what I said above. TBH, I'm probably going to end up writing &quot;yet another state machine class&quot; that does just what I need, but I think that's okay - not everything has to work for every situation :-)
</I>&gt;&gt;<i> It sounds like what you /might/ want here is soemthing for constructing arbitrary machines at runtime, 
</I>&gt;<i> 
</I>&gt;<i> The states and transitions are very rigid.
</I>&gt;<i> 
</I>&gt;&gt;<i> and automat is all about enforcing that your machine is static so that (for example) it can be visualized statically.  So yeah in that case, different library.
</I>&gt;<i> 
</I>&gt;<i> Take this example:
</I>&gt;<i> 
</I>&gt;<i> class LightSwitch(object):
</I>&gt;<i>    _machine = MethodicalMachine()
</I>&gt;<i> 
</I>&gt;<i>    @_machine.state(serialized=&quot;on&quot;)
</I>&gt;<i>    def on_state(self):
</I>&gt;<i>        &quot;the switch is on&quot;
</I>&gt;<i> 
</I>&gt;<i>    @_machine.state(serialized=&quot;off&quot;, initial=True)
</I>&gt;<i>    def off_state(self):
</I>&gt;<i>        &quot;the switch is off&quot;
</I>&gt;<i> 
</I>&gt;<i>    @_machine.input()
</I>&gt;<i>    def flip(self):
</I>&gt;<i>        &quot;flip the switch&quot;
</I>&gt;<i> 
</I>&gt;<i>    on_state.upon(flip, enter=off_state, outputs=[])
</I>&gt;<i>    off_state.upon(flip, enter=on_state, outputs=[])
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> What I'm looking to do is something along the lines of:
</I>&gt;<i> 
</I>&gt;<i> aSwitch = LightSwitch()
</I>&gt;<i> aSwitch.flip.addListener(myCallable)
</I>&gt;<i> 
</I>&gt;<i> myCallable might well be a deferred that something else is waiting on...
</I>
Thanks for the example.

My opinion is definitely that this should be an output produced by both edges here, and that output should manage an observer which does this extra functionality.  By modeling it as an output, you can see in your visual DFA where observers will be notified; and managing the list of observers is something that might have its own state-controlled lifecycle.

You can disagree of course but I think that's a very different design idiom than automat :)

-g


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065559.html">[Twisted-Python] automat question
</A></li>
	<LI>Next message (by thread): <A HREF="065537.html">[Twisted-Python] Strange recursion error with twisted.web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65561">[ date ]</a>
              <a href="thread.html#65561">[ thread ]</a>
              <a href="subject.html#65561">[ subject ]</a>
              <a href="author.html#65561">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
