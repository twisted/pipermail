<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Screen clearing in the Manhole
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Screen%20clearing%20in%20the%20Manhole&In-Reply-To=%3C1150825182032.31305G-100000%40joonya.egh.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="062156.html">
   <LINK REL="Next"  HREF="062158.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Screen clearing in the Manhole</H1>
    <B>John Santos</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Screen%20clearing%20in%20the%20Manhole&In-Reply-To=%3C1150825182032.31305G-100000%40joonya.egh.com%3E"
       TITLE="[Twisted-Python] Screen clearing in the Manhole">JOHN at egh.com
       </A><BR>
    <I>Tue Aug 25 16:58:31 MDT 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="062156.html">[Twisted-Python] Screen clearing in the Manhole
</A></li>
        <LI>Next message (by thread): <A HREF="062158.html">[Twisted-Python] Screen clearing in the Manhole
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62157">[ date ]</a>
              <a href="thread.html#62157">[ thread ]</a>
              <a href="subject.html#62157">[ subject ]</a>
              <a href="author.html#62157">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Someone wrote:  (Sorry, reply in my mail client doesn't give me an
editable text version of the mail.  Instead, it is including it as an
attachment.  I don't know why this happens.  I do know from bitter
experience that if I don't delete the attachments from my reply, users
of brain-dead mail clients (I'm looking at you, Outlook) can't see
me reply but just see the attached copy of the original message.  So
I cut and pasted some context so people know what I'm talking about.)

&gt;<i> As to where it happens, look at
</I>&gt;<i> twisted.conch.recvline.RecvLine.connectionMade() and
</I>&gt;<i> twisted.conch.insults.insults.TerminalProtocol.makeConnection()
</I>&gt;<i> 
</I>&gt;<i> You could step on the RecvLine. initializeScreen(), but I have no idea what
</I>&gt;<i> the side effects are. (And of course if you bypass all or part of it, even
</I>&gt;<i> if it works now, it's alway subject to future breakage.
</I>&gt;<i>
</I>&gt;<i> On Tue, Aug 25, 2015 at 12:27 PM, Peter Westlake 
</I>&gt;<i> &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">peter.westlake at pobox.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm making a manhole service in the usual way:
</I>[...]

t.c.r.R.connectionMade() calls self.initializeScreen(), which in turn 
calls self.terminal.reset()

I'm pretty sure s.t.reset() is actually twisted.conch.insults.reset(),
which has a bug (or an undesirable feature), it sends a &quot;hard reset&quot;
escape sequence to the terminal (&lt;ESC&gt;c).  This freaks out many terminal
emulators, and real, VT100-compatible terminals, in many different ways.

I've tested in Kermit-95, PuTTy, xterm, DECterm (a VT emulator written for
DECwindows, DEC's X implementation) and on real DEC VT420 and VT520
terminals.  They act differently, but none are pleasant.  For example, a
VT520 does a power-cycle on the CRT (which takes about 10 seconds),
reloads the saved configuration, and (if you have multiple sessions
enabled) switches to Session 1. 

The VT420 and VT520 manuals say about &quot;hard reset&quot;, basically, &quot;Don't
do that!!&quot;

I have a patch to change it to send a soft reset (&lt;ESC&gt;[!p) and to set the
terminal into &quot;replace mode&quot; (&lt;ESC&gt;[4l) (sometimes the software thought it
was in overstrike mode, but the terminal thought it was in insert mode,
with bad results. Ideally, it would set both the software and hardware to
what ever mode the user desired.  The hard reset would set the terminal to
whichever mode was stored in its permanent settings.  For a software
terminal emulator, it was a dice roll.)

Depending on the terminal emulator or physical terminal you are using,
this probably explains your symptoms.

See ticket # 7514: <A HREF="https://twistedmatrix.com/trac/ticket/7514">https://twistedmatrix.com/trac/ticket/7514</A>

-- 
John Santos
Evans Griffiths &amp; Hart, Inc.
781-861-0670 ext 539
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="062156.html">[Twisted-Python] Screen clearing in the Manhole
</A></li>
	<LI>Next message (by thread): <A HREF="062158.html">[Twisted-Python] Screen clearing in the Manhole
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62157">[ date ]</a>
              <a href="thread.html#62157">[ thread ]</a>
              <a href="subject.html#62157">[ subject ]</a>
              <a href="author.html#62157">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
