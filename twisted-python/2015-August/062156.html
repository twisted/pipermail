<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Screen clearing in the Manhole
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Screen%20clearing%20in%20the%20Manhole&In-Reply-To=%3CCACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi%3DP6GvMA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="029694.html">
   <LINK REL="Next"  HREF="062157.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Screen clearing in the Manhole</H1>
    <B>Brian Costlow</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Screen%20clearing%20in%20the%20Manhole&In-Reply-To=%3CCACLJ_dEasBKLczTTy6UFqrty6xHByAGWdLOiFRyvCyi%3DP6GvMA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Screen clearing in the Manhole">brian.costlow at gmail.com
       </A><BR>
    <I>Tue Aug 25 15:26:27 MDT 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="029694.html">[Twisted-Python] Screen clearing in the Manhole
</A></li>
        <LI>Next message (by thread): <A HREF="062157.html">[Twisted-Python] Screen clearing in the Manhole
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62156">[ date ]</a>
              <a href="thread.html#62156">[ thread ]</a>
              <a href="subject.html#62156">[ subject ]</a>
              <a href="author.html#62156">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>As to where it happens, look at
twisted.conch.recvline.RecvLine.connectionMade() and
twisted.conch.insults.insults.TerminalProtocol.makeConnection()

You could step on the RecvLine. initializeScreen(), but I have no idea what
the side effects are. (And of course if you bypass all or part of it, even
if it works now, it's alway subject to future breakage.

On Tue, Aug 25, 2015 at 12:27 PM, Peter Westlake &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">peter.westlake at pobox.com</A>&gt;
wrote:

&gt;<i> I'm making a manhole service in the usual way:
</I>&gt;<i>
</I>&gt;<i>     class PF(ServerProtocol):
</I>&gt;<i>         def protocolFactory(*a, **kw):
</I>&gt;<i>             return manhole.Manhole(namespace)
</I>&gt;<i>
</I>&gt;<i>     realm = manhole_ssh.TerminalRealm()
</I>&gt;<i>     realm.chainedProtocolFactory = PF
</I>&gt;<i>     mh_portal = portal.Portal(realm)
</I>&gt;<i>     mh_portal.registerChecker(checker)
</I>&gt;<i>
</I>&gt;<i>     manhole_service = TCPServer(0, manhole_ssh.ConchFactory(mh_portal))
</I>&gt;<i>     manhole_service.startService()
</I>&gt;<i>
</I>&gt;<i> and I'd like to print a message when the terminal is opened. This change
</I>&gt;<i> does it:
</I>&gt;<i>
</I>&gt;<i>     class PF(ServerProtocol):
</I>&gt;<i>         def protocolFactory(*a, **kw):
</I>&gt;<i>             class Manhole(manhole.Manhole):
</I>&gt;<i>                 def connectionMade(self):
</I>&gt;<i>                     super(Manhole, self).connectionMade()
</I>&gt;<i>                     self.terminal.write('Hello')
</I>&gt;<i>             return manhole.Manhole(namespace)
</I>&gt;<i>
</I>&gt;<i> and so does this version, which is better because
</I>&gt;<i> t.c.i.i.ServerProtocol.connectionMade says it is the place to write
</I>&gt;<i> messages:
</I>&gt;<i>
</I>&gt;<i>     class PF(ServerProtocol):
</I>&gt;<i>         def protocolFactory(*a, **kw):
</I>&gt;<i>             return manhole.Manhole(namespace)
</I>&gt;<i>
</I>&gt;<i>         def connectionMade(self):
</I>&gt;<i>             ServerProtocol.connectionMade(self)
</I>&gt;<i>             self.write('Hello')
</I>&gt;<i>
</I>&gt;<i> But in both cases, after the message the screen is cleared by what looks
</I>&gt;<i> like a form feed, and another prompt is printed. So far I can't find where
</I>&gt;<i> in the code this happens. Is there a way to print a message and not have it
</I>&gt;<i> scrolled off the screen?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Peter.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20150825/cf915b69/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="029694.html">[Twisted-Python] Screen clearing in the Manhole
</A></li>
	<LI>Next message (by thread): <A HREF="062157.html">[Twisted-Python] Screen clearing in the Manhole
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62156">[ date ]</a>
              <a href="thread.html#62156">[ thread ]</a>
              <a href="subject.html#62156">[ subject ]</a>
              <a href="author.html#62156">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
