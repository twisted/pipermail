<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: plus mode was Re: how winnt fileops work and	what to do about it
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20plus%20mode%20was%20Re%3A%20how%20winnt%20fileops%20work%20and%0A%09what%20to%20do%20about%20it&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012262.html">
   <LINK REL="Next"  HREF="012270.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: plus mode was Re: how winnt fileops work and	what to do about it</H1>
    <B>Paul G</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20plus%20mode%20was%20Re%3A%20how%20winnt%20fileops%20work%20and%0A%09what%20to%20do%20about%20it&In-Reply-To="
       TITLE="[Twisted-Python] Re: plus mode was Re: how winnt fileops work and	what to do about it">paul-lists at perforge.com
       </A><BR>
    <I>Sat Dec 31 15:21:45 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012262.html">[Twisted-Python] Re: plus mode was Re: how winnt fileops work and what to do about it
</A></li>
        <LI>Next message: <A HREF="012270.html">[Twisted-Python] Re: plus mode was Re: how winnt fileops work	and what to do about it
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12266">[ date ]</a>
              <a href="thread.html#12266">[ thread ]</a>
              <a href="subject.html#12266">[ subject ]</a>
              <a href="author.html#12266">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
----- Original Message ----- 
From: &quot;Cory Dodt&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">corydodt at twistedmatrix.com</A>&gt;
To: &quot;Twisted general discussion&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&gt;
Sent: Saturday, December 31, 2005 1:46 PM
Subject: [Twisted-Python] Re: plus mode was Re: how winnt fileops work and 
what to do about it


&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i> Paul, flush fixes one kind of insanity and seek fixes another:
</I>&gt;<i>
</I>&gt;<i> One ===========
</I>&gt;<i> $ echo abcdef &gt; foo
</I>&gt;<i> $ python
</I>&gt;&gt;&gt;&gt;<i> f = file('foo', 'r+b')
</I>&gt;&gt;&gt;&gt;<i> f.write('ghi')
</I>&gt;&gt;&gt;&gt;<i> f.flush()
</I>&gt;&gt;&gt;&gt;<i> f.read()
</I>&gt;<i> 'def\n'
</I>&gt;&gt;&gt;&gt;<i> # hooray!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Two ===========
</I>&gt;<i> $ echo abcdef &gt; foo
</I>&gt;<i> $ python
</I>&gt;&gt;&gt;&gt;<i> f = file('foo','r+b')
</I>&gt;&gt;&gt;&gt;<i> f.read()
</I>&gt;<i> 'abcdef\n'
</I>&gt;&gt;&gt;&gt;<i> f.seek(7, 0)
</I>&gt;&gt;&gt;&gt;<i> f.write('xyz')
</I>&gt;&gt;&gt;&gt;<i> ^D
</I>&gt;<i> $ cat foo
</I>&gt;<i> abcdef
</I>&gt;<i> xyz
</I>&gt;<i> $ # hooray
</I>&gt;<i>
</I>&gt;<i> Paul - Do you still think this is a Python bug?
</I>
depends on what you call a bug. this behaviour is, afaik, specific to 
microsoft libc's (aka c runtime)  implementation of file streams. since 
their implementation exhibits arcanely and somewhat subtly (subtle in terms 
of cause, as opposed to effect - the effect is quite apparent) divergent 
behaviour, it definitely violates the users' expectations, so it is a bug in 
that sense. with that said, they never claimed to be $standard compliant and 
they do document this, iirc, so it is not quite a bug in that sense. in 
practical terms, their implementation is not likely to 'get fixed', so the 
failure to deal with this quirk is a python bug. there are two options for 
python:

1. say that python expects users to be aware of quirks on specific platforms 
and the responsibility of dealing with them lies with the user. in this 
case, this quirk needs to be mentioned in the python docs, since it is not 
reasonable to expect people to figure out that they need to look at msdn c 
runtime api docs.

2. say that across all platforms python supports given functionality on, 
said functionality needs to have functionally identical results given 
identical input. in this case, the flush+seek workaround needs to be 
utilized on all cpythons linked with msvscrt in a manner transparent to the 
user.

make sense?

-p 



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012262.html">[Twisted-Python] Re: plus mode was Re: how winnt fileops work and what to do about it
</A></li>
	<LI>Next message: <A HREF="012270.html">[Twisted-Python] Re: plus mode was Re: how winnt fileops work	and what to do about it
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12266">[ date ]</a>
              <a href="thread.html#12266">[ thread ]</a>
              <a href="subject.html#12266">[ subject ]</a>
              <a href="author.html#12266">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
