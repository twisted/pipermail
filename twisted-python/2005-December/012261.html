<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: [Twisted-commits] r15451 - Fix test failures	under windows by changing the eventual-send operation to
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20%5BTwisted-commits%5D%20r15451%20-%20Fix%20test%20failures%0A%09under%20windows%20by%20changing%20the%20eventual-send%20operation%20to&In-Reply-To=89CC1D6D-85D4-4998-94F1-E25384FC2B5A%40fuhm.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012260.html">
   <LINK REL="Next"  HREF="012263.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: [Twisted-commits] r15451 - Fix test failures	under windows by changing the eventual-send operation to</H1>
    <B>James Y Knight</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20%5BTwisted-commits%5D%20r15451%20-%20Fix%20test%20failures%0A%09under%20windows%20by%20changing%20the%20eventual-send%20operation%20to&In-Reply-To=89CC1D6D-85D4-4998-94F1-E25384FC2B5A%40fuhm.net"
       TITLE="[Twisted-Python] Re: [Twisted-commits] r15451 - Fix test failures	under windows by changing the eventual-send operation to">foom at fuhm.net
       </A><BR>
    <I>Sat Dec 31 12:42:07 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012260.html">[Twisted-Python] Re: [Twisted-commits] r15451 - Fix test failures	under windows by changing the eventual-send operation to
</A></li>
        <LI>Next message: <A HREF="012263.html">[Twisted-Python] Re: r15451 - Fix test failures under windows by changing the eventual-send operation to
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12261">[ date ]</a>
              <a href="thread.html#12261">[ thread ]</a>
              <a href="subject.html#12261">[ subject ]</a>
              <a href="author.html#12261">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Dec 31, 2005, at 11:59 AM, James Y Knight wrote:

&gt;<i> On Dec 31, 2005, at 1:39 AM, Brian Warner wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> callLater(0) does not guarantee
</I>&gt;&gt;<i> relative ordering of sequentially-scheduled calls,
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Yes it does: order of method call.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> and the windows
</I>&gt;&gt;<i> reactors in fact execute them in random order.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That is broken.
</I>
I'm afraid this is my fault. Heapq does not guarantee stable ordering  
amongst elements with the same key, and on windows, two successive  
calls to time.time() are very likely to return the same number,  
because of its poor resolution. The same error could probably occur  
on unix/linux systems as well, although currently unlikely to the  
point of impossibility. It should be fixable by storing the last time  
of an element added to the queue, and adding epsilon if current time  
is the same.

Just as a point of interest, on my system, this loop never finishes:
import time
def f():
  while 1:
   if time.time()==time.time():
    break

But this one does:
from time import time
def f():
  while 1:
   if time()==time():
    break


James


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012260.html">[Twisted-Python] Re: [Twisted-commits] r15451 - Fix test failures	under windows by changing the eventual-send operation to
</A></li>
	<LI>Next message: <A HREF="012263.html">[Twisted-Python] Re: r15451 - Fix test failures under windows by changing the eventual-send operation to
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12261">[ date ]</a>
              <a href="thread.html#12261">[ thread ]</a>
              <a href="subject.html#12261">[ subject ]</a>
              <a href="author.html#12261">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
