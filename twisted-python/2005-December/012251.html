<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Qtreactor problem on twisted 2.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Qtreactor%20problem%20on%20twisted%202.1&In-Reply-To=d95439ec0512300647j29e8b78cv5f2649a16d37e87f%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012291.html">
   <LINK REL="Next"  HREF="012252.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Qtreactor problem on twisted 2.1</H1>
    <B>Umit Oztosun</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Qtreactor%20problem%20on%20twisted%202.1&In-Reply-To=d95439ec0512300647j29e8b78cv5f2649a16d37e87f%40mail.gmail.com"
       TITLE="[Twisted-Python] Qtreactor problem on twisted 2.1">umit at liqia.com
       </A><BR>
    <I>Fri Dec 30 10:26:08 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012291.html">[Twisted-Python] Depreciation of trial.unittest functions?
</A></li>
        <LI>Next message: <A HREF="012252.html">[Twisted-Python] Qtreactor problem on twisted 2.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12251">[ date ]</a>
              <a href="thread.html#12251">[ thread ]</a>
              <a href="subject.html#12251">[ subject ]</a>
              <a href="author.html#12251">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Our application uses twisted as the core network framework. It
basically consists of a server and multiple clients. All communication
is carried on a twisted.spread.pb channel. We have been using twisted
1.3 since the beginning, we decided to switch to twisted 2.1, the
switch was easy but an interesting problem showed up.

Our client is based on PyQt, so uses qtreactor. If something goes
wrong on the server side, the error is transferred to the client
(automagically, thanks to twisted &amp; deferreds), and handled there
(with an errback). We warn our users about the failure with a dialog.
The interesting part is, with twisted 2.1, at the dialog's exec_loop()
call, occasionally the connection between the server and client goes
away with the following exception:
-------------------------------------------
2005/12/30 15:51 GTB Standard Time [-] Error in &lt;&lt;class
'twisted.internet.tcp.TLSConnection'&gt; to (u'localhost', 4243) at
1312e50&gt;.doRead()
2005/12/30 15:51 GTB Standard Time [-] Traceback (most recent call last):
          File &quot;C:\Python24\Lib\site-packages\twisted\internet\defer.py&quot;,
line 182, in addCallbacks
            self._runCallbacks()
          File &quot;C:\Python24\Lib\site-packages\twisted\internet\defer.py&quot;,
line 307, in _runCallbacks
            self.result = callback(self.result, *args, **kw)
          File &quot;.\lq\lqtrxutils.py&quot;, line 126, in eb_localFailed

          File &quot;.\lq\lqdialog.py&quot;, line 201, in showDialog

        --- &lt;exception caught here&gt; ---
          File &quot;C:\Python24\Lib\site-packages\twisted\internet\qtreactor.py&quot;,
line 62, in read
            why = w.doRead()
          File &quot;C:\Python24\Lib\site-packages\twisted\internet\tcp.py&quot;, line
111, in doRead
            return Connection.doRead(self)
          File &quot;C:\Python24\Lib\site-packages\twisted\internet\tcp.py&quot;, line
347, in doRead
            return self.protocol.dataReceived(data)
          File &quot;C:\Python24\Lib\site-packages\twisted\spread\banana.py&quot;, line
173, in dataReceived
            gotItem(self.incomingVocabulary[num])
          File &quot;C:\Python24\Lib\site-packages\twisted\spread\banana.py&quot;, line
114, in gotItem
            self.callExpressionReceived(item)
          File &quot;C:\Python24\Lib\site-packages\twisted\spread\banana.py&quot;, line
81, in callExpressionReceived
            self.expressionReceived(obj)
          File &quot;C:\Python24\Lib\site-packages\twisted\spread\pb.py&quot;, line
567, in expressionReceived
            raise ProtocolError(&quot;Non-list expression received.&quot;)
        twisted.spread.pb.ProtocolError: Non-list expression received.

2005/12/30 15:51 GTB Standard Time [-] &lt;twisted.internet.ssl.Connector
instance at 0x0134BE90&gt; will retry in 2 seconds
2005/12/30 15:51 GTB Standard Time [-] Stopping factory
&lt;lqclientfactory.lqClientFactory instance at 0x0134BDF0&gt;
-------------------------------------------
Line 201 at lqdialog.py reads as
    result = self.exec_loop()

We are using a reconnecting client factory, the application reconnects
in a matter of seconds but this behaviour is annoying. As I wrote
above, the we had no problem when using 1.3.

Any ideas?

Regards, and happy new year!
Umit Oztosun

P.S.: Tested on both Windows XP and Ubuntu Linux (5.10 and 5.04).
Disconnection occurs regardless of using or not using SSL.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012291.html">[Twisted-Python] Depreciation of trial.unittest functions?
</A></li>
	<LI>Next message: <A HREF="012252.html">[Twisted-Python] Qtreactor problem on twisted 2.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12251">[ date ]</a>
              <a href="thread.html#12251">[ thread ]</a>
              <a href="subject.html#12251">[ subject ]</a>
              <a href="author.html#12251">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
