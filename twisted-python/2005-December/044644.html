<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] RE: waiting on transport return
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20RE%3A%20waiting%20on%20transport%20return&In-Reply-To=%3C3E7F9D21F31D094DB7721553EA2CD1B5E72AE8%40NTXBOIMBX15.micron.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="044643.html">
   <LINK REL="Next"  HREF="044645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] RE: waiting on transport return</H1>
    <B>jmbenski at micron.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20RE%3A%20waiting%20on%20transport%20return&In-Reply-To=%3C3E7F9D21F31D094DB7721553EA2CD1B5E72AE8%40NTXBOIMBX15.micron.com%3E"
       TITLE="[Twisted-Python] RE: waiting on transport return">jmbenski at micron.com
       </A><BR>
    <I>Fri Dec  9 11:02:03 MST 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="044643.html">[Twisted-Python] RE: waiting on transport return
</A></li>
        <LI>Next message (by thread): <A HREF="044645.html">[Twisted-Python] RE: waiting on transport return
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44644">[ date ]</a>
              <a href="thread.html#44644">[ thread ]</a>
              <a href="subject.html#44644">[ subject ]</a>
              <a href="author.html#44644">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I guess I'm still trying to wrap my head around deferreds and how best to use them as they were intended.  The way that code works, I have to pass my deferred chain to sendCommand.  The protocol needs to store that deferred on its deferred stack, so that I can pass the results of the command back to the deferred function.

After looking at the code a bit more and your change below, I'm surprised that my code works.  Why isn't the reactor kicking off my deferreds that are stored in the queue?  My current logic is dependent on the protocol running the commandComplete function before the deferreds fire in the protocol's deferred queue.  

#Do some thing
#Send the command
self.processProtocol.sendCommand
#Do some more
#return control to the reactor

??Here the reactor should kick off my command and run any deferreds.

Am I just lucky that my server returns the response(commandComplete) before the deferreds in the queue fire?  The return of the data and the chain of deferreds are not linked in any way, which I guess is what my original question is.  How can my commandComplete return a deferred and kick off a logic chain?  How is it working now?


-----Original Message-----
From: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-bounces at twistedmatrix.com</A> [mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-bounces at twistedmatrix.com</A>] On Behalf Of Jean-Paul Calderone
Sent: Friday, December 09, 2005 10:01 AM
To: Twisted general discussion
Subject: RE: [Twisted-Python] RE: waiting on transport return

On Fri, 9 Dec 2005 09:03:52 -0700, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jmbenski at micron.com</A> wrote:
&gt;<i>I'm not trying to bump my question, but if someone could tell me if I'm just being stupid and missing something with this code or that it isn't possible to do what I need with a spawned process?  If I know it isn't possible, I can just continue down the path I am.  It's not too much of a pain, but it just feels...wrong.
</I>&gt;<i>
</I>
The code mostly seems good to me.  The only thing I might change is 
completely trivial: instead of passing a Deferred in to sendCommand, 
I'd have sendCommand be responsible for creating the Deferred and 
then return it, so your application code would look like this - 

  d = self.processprotocol.sendCommand(&quot;syncCmd&quot;, cmd)
  d.addCallback(self.handleTheCommand)
  d.addCallback(Self.theRestOfTheCommands)

I'm not sure from where your unhappyness with the version you posted 
stems, so I'm not sure what other comments to make.

Jean-Paul

_______________________________________________
Twisted-Python mailing list
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="044643.html">[Twisted-Python] RE: waiting on transport return
</A></li>
	<LI>Next message (by thread): <A HREF="044645.html">[Twisted-Python] RE: waiting on transport return
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44644">[ date ]</a>
              <a href="thread.html#44644">[ thread ]</a>
              <a href="subject.html#44644">[ subject ]</a>
              <a href="author.html#44644">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
