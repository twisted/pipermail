<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] threading issues with DB connection pooling and	ReconnectingClientFactory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20threading%20issues%20with%20DB%20connection%20pooling%20and%0A%09ReconnectingClientFactory&In-Reply-To=20051214004712.GL4771%40home.puzzling.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012151.html">
   <LINK REL="Next"  HREF="012152.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] threading issues with DB connection pooling and	ReconnectingClientFactory</H1>
    <B>Andreas Poisel</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20threading%20issues%20with%20DB%20connection%20pooling%20and%0A%09ReconnectingClientFactory&In-Reply-To=20051214004712.GL4771%40home.puzzling.org"
       TITLE="[Twisted-Python] threading issues with DB connection pooling and	ReconnectingClientFactory">a.poisel at acat.cc
       </A><BR>
    <I>Wed Dec 14 06:33:10 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012151.html">[Twisted-Python] threading issues with DB connection pooling and	ReconnectingClientFactory
</A></li>
        <LI>Next message: <A HREF="012152.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12155">[ date ]</a>
              <a href="thread.html#12155">[ thread ]</a>
              <a href="subject.html#12155">[ subject ]</a>
              <a href="author.html#12155">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrew,

thank you for your comments.

* Andrew Bennetts &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">andrew-twisted at puzzling.org</A>&gt; [051214 02:00]:

&gt;<i> If you are using any Twisted objects, such as transports, in a thread, you are
</I>&gt;<i> doing something wrong.
</I>
I'm really sorry, my assumptions were totally wrong.

&gt;<i>     # run queryDB in a thread
</I>&gt;<i>     deferred = deferToThread(queryDB)
</I>
I'm using dbapi to query the database and now I understand that I'm back
in the main thread when the query results are available.

Now I think my problem (no valid transport object after reconnect) has
nothing to do with threads.

I'm using task.LoopingCall() to query the database frequently.  After
reconnecting to the server, the protocol object which is in charge for
the looping calls to the database does not reconnect to the server
automatically.  I think I have to stop() and start() the looping calls
after reconnecting to get a working transport again.

&gt;<i> The twisted.enterprise.adbapi module works much like this.
</I>
Sorry for wasting your time but you nevertheless helped me &quot;getting&quot;
some aspects of twisted.

-- 
Regards, Andi


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012151.html">[Twisted-Python] threading issues with DB connection pooling and	ReconnectingClientFactory
</A></li>
	<LI>Next message: <A HREF="012152.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12155">[ date ]</a>
              <a href="thread.html#12155">[ thread ]</a>
              <a href="subject.html#12155">[ subject ]</a>
              <a href="author.html#12155">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
