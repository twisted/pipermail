<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] sending large files from web2 http server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20sending%20large%20files%20from%20web2%20http%20server&In-Reply-To=%3C49AFEDBB.3090402%40bluegap.ch%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="051799.html">
   <LINK REL="Next"  HREF="051801.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] sending large files from web2 http server</H1>
    <B>Markus Wanner</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20sending%20large%20files%20from%20web2%20http%20server&In-Reply-To=%3C49AFEDBB.3090402%40bluegap.ch%3E"
       TITLE="[Twisted-Python] sending large files from web2 http server">markus at bluegap.ch
       </A><BR>
    <I>Thu Mar  5 08:20:27 MST 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="051799.html">[Twisted-Python] Twisted Sprint at PyCon
</A></li>
        <LI>Next message (by thread): <A HREF="051801.html">[Twisted-Python] sending large files from web2 http server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51800">[ date ]</a>
              <a href="thread.html#51800">[ thread ]</a>
              <a href="subject.html#51800">[ subject ]</a>
              <a href="author.html#51800">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm trying to stream longish data via web2, but experience sudden stalls
in data transfer, followed by a connection abort after a certain
timeout. I can't completely reproduce the issue, yet, but figured that
the size of the blocks I'm returning via the stream's read method
affects the failure rate (an stream.IByteStream implementation).

I've tried with chunk sizes between 1 MiB down to 256 bytes. At that
rate, I suddenly get the following unhandled errors, which don't seem to
have to do much with my code.

2009/03/05 16:02 CET [-] Unhandled error in Deferred:
2009/03/05 16:02 CET [-] Traceback (most recent call last):
	  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/defer.py&quot;,
line 267, in unpause
	    self._runCallbacks()
	  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/defer.py&quot;,
line 307, in _runCallbacks
	    self.result = callback(self.result, *args, **kw)
	  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/defer.py&quot;,
line 271, in _continue
	    self.unpause()
	  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/defer.py&quot;,
line 267, in unpause
	    self._runCallbacks()
	--- &lt;exception caught here&gt; ---
	  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/defer.py&quot;,
line 307, in _runCallbacks
	    self.result = callback(self.result, *args, **kw)
	  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/defer.py&quot;,
line 271, in _continue
	    self.unpause()
	  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/defer.py&quot;,
line 267, in unpause
	    self._runCallbacks()
	  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/defer.py&quot;,
line 321, in _runCallbacks
	    self.result = failure.Failure()
	  File &quot;/usr/lib/python2.4/site-packages/twisted/python/failure.py&quot;,
line 205, in __init__
	    parentCs = reflect.allYourBase(self.type)
	  File &quot;/usr/lib/python2.4/site-packages/twisted/python/reflect.py&quot;,
line 480, in allYourBase
	    accumulateBases(classObj, l, baseClass)
	exceptions.RuntimeError: maximum recursion depth exceeded


Are there any known problems with web2 and large files (not that 64 MiB
is *that* large...). Any hint regarding the above error? Is the same to
be expected with a chunk size of 8 KiB and a file of 2 GiB size (as that
would result in the same amount of chunks)?

Any hints would be greatly appreciated.

Kind Regards

Markus Wanner


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="051799.html">[Twisted-Python] Twisted Sprint at PyCon
</A></li>
	<LI>Next message (by thread): <A HREF="051801.html">[Twisted-Python] sending large files from web2 http server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51800">[ date ]</a>
              <a href="thread.html#51800">[ thread ]</a>
              <a href="subject.html#51800">[ subject ]</a>
              <a href="author.html#51800">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
