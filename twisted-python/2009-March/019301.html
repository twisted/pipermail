<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] A few comments on deferreds
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20A%20few%20comments%20on%20deferreds&In-Reply-To=18865.1215.882543.689802%40jon.es">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019298.html">
   <LINK REL="Next"  HREF="019304.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] A few comments on deferreds</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20A%20few%20comments%20on%20deferreds&In-Reply-To=18865.1215.882543.689802%40jon.es"
       TITLE="[Twisted-Python] A few comments on deferreds">exarkun at divmod.com
       </A><BR>
    <I>Fri Mar  6 07:49:10 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019298.html">[Twisted-Python] A few comments on deferreds
</A></li>
        <LI>Next message: <A HREF="019304.html">[Twisted-Python] A few comments on deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19301">[ date ]</a>
              <a href="thread.html#19301">[ thread ]</a>
              <a href="subject.html#19301">[ subject ]</a>
              <a href="author.html#19301">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 6 Mar 2009 12:10:55 +0100, Terry Jones &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">terry at jon.es</A>&gt; wrote:
&gt;<i>Here are a few comments on deferreds. I'll keep this short. These sort of
</I>&gt;<i>posts don't seem to generate much/any discussion (e.g., <A HREF="http://bit.ly/YkSD">http://bit.ly/YkSD</A>
</I>&gt;<i>which I thought was cool). I'm not sure why - I find deferreds infinitely
</I>&gt;<i>interesting, and don't understand why other people don't seem to share the
</I>&gt;<i>passion :-)
</I>&gt;<i>
</I>&gt;<i>1. If you have a deferred d1, and you call d1.chainDeferred(d2) I think it
</I>&gt;<i>   makes sense for there to be a flag inside the deferred class that warns
</I>&gt;<i>   you if you later call d1.addCallbacks. That's because adding more
</I>&gt;<i>   functions to d1's callback/errback chain is probably not useful. (It
</I>&gt;<i>   might conceivably be useful, e.g., to let you know that d1 has been
</I>&gt;<i>   called). The result of d1 has been passed to d2, and because d2.callback
</I>&gt;<i>   and d2.errback don't return it (see point 2 below), it is not passed
</I>&gt;<i>   further down d1's chain. So it's most likely that someone adding a
</I>&gt;<i>   callback to d1 after calling d1.chainDeferred doesn't really know what
</I>&gt;<i>   they're doing.
</I>
Indeed.  I can't think of any case where I've wanted to add more callbacks
to a Deferred after chaining it to (from?  with?) another Deferred.

&gt;<i>2. Deferred.callback and Deferred.errback currently (implicitly) return
</I>&gt;<i>   None.  They could be changed to return their passed argument.  That
</I>&gt;<i>   would make a call to d1.chainDeferred act like a deferred fork - the
</I>&gt;<i>   result would go down d2's callback chain, but also continue down the
</I>&gt;<i>   callback/errback chain of d1.
</I>
But it would be catastrophic for error handling.  Suddenly all of your
errors on d1 which are handled perfectly correctly with an errback on
d2 would become unhandled failures.

&gt;<i>3. There's also the possibility of adding a function to the Deferred class:
</I>&gt;<i>
</I>&gt;<i>     def incorporateDeferred(self, d2):
</I>&gt;<i>         self.callbacks.extend(d2.callbacks)
</I>&gt;<i>
</I>&gt;<i>   which might be what a naive reader might expect chainDeferred to do.
</I>&gt;<i>   This raises the question of what you might later do with d2 (probably
</I>&gt;<i>   nothing), but that's just like what happens with d1: if you call
</I>&gt;<i>   d1.chainDeferred you're probably not going to return d1 to anyone. All
</I>&gt;<i>   you can usefully do is fire it.
</I>
If this accounted for future changes to d2, it would make more sense.  I
think the correct direction to go in is to prevent people from trying to
add more callbacks to d1.

&gt;<i>I'll stop for now. There's lots more that could be said, but lets see if
</I>&gt;<i>anyone's interested. I wish I were going to PyCon :-(
</I>&gt;<i>
</I>&gt;<i>BTW, points 1 and 2 above are key to understanding what goes on in the
</I>&gt;<i>interview question code I recently posted (<A HREF="http://bit.ly/T3xKs">http://bit.ly/T3xKs</A>).
</I>&gt;<i>
</I>
Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019298.html">[Twisted-Python] A few comments on deferreds
</A></li>
	<LI>Next message: <A HREF="019304.html">[Twisted-Python] A few comments on deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19301">[ date ]</a>
              <a href="thread.html#19301">[ thread ]</a>
              <a href="subject.html#19301">[ subject ]</a>
              <a href="author.html#19301">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
