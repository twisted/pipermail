<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: So how does everyone use an ORM in twisted?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20So%20how%20does%20everyone%20use%20an%20ORM%20in%20twisted%3F&In-Reply-To=%3C49C03B22.6020603%40eepatents.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="051875.html">
   <LINK REL="Next"  HREF="051869.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: So how does everyone use an ORM in twisted?</H1>
    <B>Ed Suominen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20So%20how%20does%20everyone%20use%20an%20ORM%20in%20twisted%3F&In-Reply-To=%3C49C03B22.6020603%40eepatents.com%3E"
       TITLE="[Twisted-Python] Re: So how does everyone use an ORM in twisted?">general at eepatents.com
       </A><BR>
    <I>Tue Mar 17 18:06:58 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="051875.html">[Twisted-Python] Re: So how does everyone use an ORM in twisted?
</A></li>
        <LI>Next message (by thread): <A HREF="051869.html">[Twisted-Python] Ticket 1138 Re: Twisted-Python Digest, Vol 60,	Issue 12
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51874">[ date ]</a>
              <a href="thread.html#51874">[ thread ]</a>
              <a href="subject.html#51874">[ subject ]</a>
              <a href="author.html#51874">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>For what it's worth, I've never used SQLAlchemy's ORM capabilities and 
don't support it in sAsync. I agree that it really isn't compatible with 
the asynchronous nature of Twisted, and I don't see it as adding 
anything. To me, the power of SQLAlchemy is in the clean and convenient 
way it permits you to access the underlying relational database, and 
sAsync merely lets you do that access in an asynchronous manner, in a 
single thread or with multiple threads.

Best regards, Ed

David Bolen wrote:
&gt;<i> Don Dwiggins &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">ddwiggins at advpubtech.com</A>&gt; writes:
</I>&gt;<i> 
</I>&gt;&gt;<i> So if someone wanted the use of the ORM, would you say that they
</I>&gt;&gt;<i> should access the objects through deferreds, just as they would with
</I>&gt;&gt;<i> SQL?  Or is it worse than that?
</I>&gt;<i> 
</I>&gt;<i> If by deferreds you mean pushing the ORM operation (including all
</I>&gt;<i> possible ancillary object loading) into a separate thread via
</I>&gt;<i> deferToThread, yes, that's a possibility.  But that likely will only
</I>&gt;<i> work best if you can work with a structure where the results of
</I>&gt;<i> database operations can be encapsulated into a fairly simple
</I>&gt;<i> interface, and not as much if the mainline code wants access to the
</I>&gt;<i> entire object tree.  Otherwise, you end up doing a lot of work to
</I>&gt;<i> protect against the very features (especially lazy loading) that often
</I>&gt;<i> makes an ORM attractive to people in order to ensure that the object
</I>&gt;<i> tree is safe to use from within the non-ORM thread.
</I>&gt;<i> 
</I>&gt;<i> If, however, you mean some other use of deferreds, then no - I agree
</I>&gt;<i> with Jean-Paul's earlier comment that most ORMs are simply not
</I>&gt;<i> designed to play nicely with the non-blocking Twisted main loop.
</I>&gt;<i> Database operations typically trigger from simple attribute access, or
</I>&gt;<i> from within, say an iteration loop.  They then block, so unless they
</I>&gt;<i> happen to execute very quickly you're blocking the Twisted main loop.
</I>&gt;<i> And it's tough to insert a normal deferred callback into that
</I>&gt;<i> equation.
</I>&gt;<i> 
</I>&gt;<i> You can try to offload the underlying DB operation to a thread pool,
</I>&gt;<i> but then you start having to fight to explicitly control all DB
</I>&gt;<i> access, some of which can occur during a simple attribute reference -
</I>&gt;<i> at which point there's no reasonable way to use a Deferred to postpone
</I>&gt;<i> the attribute lookup.
</I>&gt;<i> 
</I>&gt;<i> It's been a while since I looked at it, so I'm not sure of its status,
</I>&gt;<i> but sAsync was actually a interesting effort to at least get as good a
</I>&gt;<i> wrapper as possible, but it doesn't preclude having to be cautious
</I>&gt;<i> about ensuring any objects returned from the wrapper have been fully
</I>&gt;<i> loaded, or that any interaction that might require going back to the
</I>&gt;<i> database only be through wrapped methods and not direct attribute
</I>&gt;<i> access.  This can turn out to be a bunch of extra work when you start
</I>&gt;<i> talking about walking lists of related (one to many) records,
</I>&gt;<i> traversing the links of foreign keys among records, etc.. much of
</I>&gt;<i> which is the attractive part of ORMs for those who like them.
</I>&gt;<i> 
</I>&gt;<i> I suppose it is only fair to also say that if you don't mind some
</I>&gt;<i> arbitrary delays in the mainline code, there's nothing stopping you
</I>&gt;<i> from just using an ORM like SQLAlchemy right inline and ignoring the
</I>&gt;<i> whole issue.  For smaller databases or ones whose server are on the
</I>&gt;<i> local host (or internal to the process like sqlite), it might not even
</I>&gt;<i> be a real problem.  It's certainly flawed structurally and likely
</I>&gt;<i> won't scale, but that doesn't mean it might not be suitable in certain
</I>&gt;<i> cases if you know the tradeoffs.
</I>&gt;<i> 
</I>&gt;<i> -- David
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="051875.html">[Twisted-Python] Re: So how does everyone use an ORM in twisted?
</A></li>
	<LI>Next message (by thread): <A HREF="051869.html">[Twisted-Python] Ticket 1138 Re: Twisted-Python Digest, Vol 60,	Issue 12
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51874">[ date ]</a>
              <a href="thread.html#51874">[ thread ]</a>
              <a href="subject.html#51874">[ subject ]</a>
              <a href="author.html#51874">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
