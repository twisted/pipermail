<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Clarification or pausing a consumer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Clarification%20or%20pausing%20a%20consumer&In-Reply-To=%3C3A039F2B-32D9-4740-B46C-986B457A9CD0%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="064162.html">
   <LINK REL="Next"  HREF="064169.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Clarification or pausing a consumer</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Clarification%20or%20pausing%20a%20consumer&In-Reply-To=%3C3A039F2B-32D9-4740-B46C-986B457A9CD0%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Clarification or pausing a consumer">glyph at twistedmatrix.com
       </A><BR>
    <I>Sat Oct 14 00:44:12 MDT 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="064162.html">[Twisted-Python] Clarification or pausing a consumer
</A></li>
        <LI>Next message (by thread): <A HREF="064169.html">[Twisted-Python] COMMERCIAL:Re: Clarification or pausing a	consumer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64163">[ date ]</a>
              <a href="thread.html#64163">[ thread ]</a>
              <a href="subject.html#64163">[ subject ]</a>
              <a href="author.html#64163">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

&gt;<i> On Oct 13, 2017, at 5:47 PM, Jean-Paul Calderone &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> On Fri, Oct 13, 2017 at 8:29 AM, Barry Scott &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">barry.scott at forcepoint.com</A> &lt;mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">barry.scott at forcepoint.com</A>&gt;&gt; wrote:
</I>&gt;<i> I have a app that needs to send data as an http response. But the data is
</I>&gt;<i> produced slowly. More slowly then the time taken to transmit it.
</I>&gt;<i> 
</I>&gt;<i> The consumer keeps calling resumeProducing, but there is no data to send
</I>&gt;<i> often.
</I>&gt;<i> 
</I>&gt;<i> This sounds like a bug in the consumer.  There are two cases.
</I>&gt;<i> 
</I>&gt;<i> If the producer is &quot;streaming&quot; or &quot;push&quot; (two words, one meaning) then the consumer should call resumeProducing once and let data come.  If it wants to slow down the data, it can call pauseProducing.  There's nothing else it should be doing.
</I>
This is the good kind of producer.

&gt;<i> If the producer is &quot;not streaming&quot; or &quot;pull&quot; (again, one meaning) then the consumer should call resumeProducing and wait for a write call.  Then it should call resumeProducing again (if it wants more data).  It should not call resumeProducing again while waiting for a write call.
</I>
This is the bad kind.  It is basically pointless.  It was a design error to include it and it should be removed from Twisted eventually.

&gt;<i> What is the correct way to pause the consumer so that it does not keep
</I>&gt;<i> calling resumeProducing? unregisterProducer?
</I>&gt;<i> 
</I>&gt;<i> Probably just fix the consumer implementation to not be broken.  Or switch to tubes which has a simpler model and (in principle) fewer places to make mistakes.
</I>
My guess is not that the consumer is broken, but rather, you registered your producer as the bad kind of producer (&quot;pull&quot;) and it's just doing as it was told, which is to keep calling resumeProducing over and over again every time it wants data.

Let us know how it works out!

&gt;<i>  
</I>&gt;<i> Then when the next block of data is available what is the correct way to
</I>&gt;<i> resume the consumer? registerProducer?
</I>&gt;<i> 
</I>&gt;<i> Related to that why does HTTPChannel.registerProducer convert a IPullProducer
</I>&gt;<i> into a IPushProducer using _PullToPush?
</I>&gt;<i> 
</I>&gt;<i> Probably as an attempt to simplify the implementation - to make it so the consumer can pretend there's just one kind of producer instead of two (which would be nice for everyone).
</I>&gt;<i> 
</I>&gt;<i> Jean-Paul
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20171013/8d3972c6/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="064162.html">[Twisted-Python] Clarification or pausing a consumer
</A></li>
	<LI>Next message (by thread): <A HREF="064169.html">[Twisted-Python] COMMERCIAL:Re: Clarification or pausing a	consumer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64163">[ date ]</a>
              <a href="thread.html#64163">[ thread ]</a>
              <a href="subject.html#64163">[ subject ]</a>
              <a href="author.html#64163">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
