<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Potential PB Security Problem (And Solution)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Potential%20PB%20Security%20Problem%20%28And%20Solution%29&In-Reply-To=1013832278.2075.114.camel%40troglodyte">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000801.html">
   <LINK REL="Next"  HREF="000806.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Potential PB Security Problem (And Solution)</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Potential%20PB%20Security%20Problem%20%28And%20Solution%29&In-Reply-To=1013832278.2075.114.camel%40troglodyte"
       TITLE="[Twisted-Python] Potential PB Security Problem (And Solution)">glyph at twistedmatrix.com
       </A><BR>
    <I>Sat Feb 16 06:42:48 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="000801.html">[Twisted-Python] Potential PB Security Problem (And Solution)
</A></li>
        <LI>Next message: <A HREF="000806.html">[Twisted-Python] Potential PB Security Problem (And Solution)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#804">[ date ]</a>
              <a href="thread.html#804">[ thread ]</a>
              <a href="subject.html#804">[ subject ]</a>
              <a href="author.html#804">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2002-02-15 at 22:04, Kevin Turner wrote:
&gt;<i> On Fri, 2002-02-15 at 19:12, Christopher Armstrong wrote:
</I>&gt;<i> &gt; For as long as I remember, that was *never* the point. Haven't you ever
</I>&gt;<i> &gt; heard glyph shouting from on high, &quot;Explicit is better than implicit!&quot;?
</I>&gt;<i> 
</I>&gt;<i> Funny words for a sect which celebrates in masqurading objects and
</I>&gt;<i> generally deplores strict type checking.
</I>
Dynamic typing is very cool, for reasons I've described in detail
elsewhere.  Hence, I want to make it still be easy to write secure PB
code without mandating the writing of IDLs.  Assuming that whatever code
you write *must* be secure, which is more of a hindrance:
foo.callRemote(&quot;bar&quot;) or requiring a full interface definition before
you can even publish your object?

The distinction between masquerading locally (fooling yourself) and
masquerading remotely (fooling others) is the difference between having
a vivid imagination and being a con artist...

&gt;<i> &gt; Well, the point was, the code wasn't *meant* to pass privelaged
</I>&gt;<i> &gt; information to an object across the wire - notice that it was a Copied.
</I>&gt;<i> &gt; This could also be done for more things than Copied - imagine a method
</I>&gt;<i> &gt; that takes a list as one of its arguments and appends some secure data
</I>&gt;<i> &gt; to it. You could spoof a list with a remote object that has an append()
</I>&gt;<i> &gt; method.
</I>&gt;<i> 
</I>&gt;<i> What do you mean, &quot;wasn't meant to pass privledged information&quot;?  Your
</I>&gt;<i> example has you appending the &quot;secure data&quot; to a list that's from who
</I>&gt;<i> knows where!  You have no idea who holds a reference to that list, or
</I>&gt;<i> who will hold references to the list (or certain items on the list) in
</I>&gt;<i> the near future.  And, as a happy little object, I don't see why you
</I>&gt;<i> should care.  You perform your operation with the given parameters, and
</I>&gt;<i> that's all your job is, isn't it?
</I>
There are two kinds of &quot;who&quot; here.  One &quot;who&quot; is to know the objects
that will have knowledge of your object.  That's encapsulation, which is
all well and good, but we break it sometimes, for various reasons;
python's nifty because it lets us do that when necessary.  The other
&quot;who&quot; is more important, though: it's the actual *people* that will have
access to the information that you're sending through that method call.

&gt;<i> I guess there's the &quot;Referenceable vs Copyable&quot; facet which I haven't
</I>&gt;<i> been paying a lot of attention to in this discussion.  When I choose
</I>&gt;<i> between those two spreadable flavours (the module name is spelled wrong,
</I>&gt;<i> BTW), I am thinking about what goes over the wire, but only in terms of
</I>&gt;<i> how much it will change, how much the states of the objects need to be
</I>&gt;<i> synchronized, how much traffic it's generating, etc.  But I've never
</I>&gt;<i> seen the use of Copyable as a security option.  If I had data I did not
</I>&gt;<i> want getting outside, I do not think I should entrust it to *any* object
</I>&gt;<i> which came from Outside, whether it be a RemoteCopy or RemoteCache or a
</I>&gt;<i> list-like object with whiskers.
</I>
RemoteCopy and RemoteCache are both local classes; e.g. any information
you pass to methods that exist on them gets dealt with locally.  At
least in the code I'm writing for work, I'll often want to embed
&quot;privileged&quot; code in a RemoteCopy class, since it is dealing with
*information* from the &quot;outside&quot;, but behavior locally.  For mirroring
the view of a simulation on a server, this is a common design pattern,
I'd imagine.

The proposal on the table makes the locality of the behavior much more
explicit -- unless your method begins with 'callRemote', the behavior
you're invoking will *definitely* be local.  Attempts to invoke
(potentially) remote behavior without first saying so will just blow up.

&gt;<i> I guess it's only fair to admit that I've written very little
</I>&gt;<i> application code with twisted.spread and read even less, so it's
</I>&gt;<i> entirely possible that I lack the experience to understand the issues
</I>&gt;<i> here...  but some things bein' said just don't ring true to me.
</I>
WELL OF COURSE YOU HAVE NO IDEA WHAT YOU'RE TALKING ABOUT THEN!!!! ;-)

Seriously, thanks for your response; this is exactly the sort of
discussion I wanted to generate.  You haven't convinced me that I was
wrong yet ;-), but I would like it if the motivations for doing this are
clearly understood.

If you haven't read much PB code, the problem I'm describing might seem
a trivial concern, but I've found at least two instances of this problem
&quot;in the wild&quot;.  One was a mistake made by me and one was someone else. 
Neither could be made to divulge critical information, but both could be
exploited to give a user an unfair advantage or consume a large
proportion of the server's CPU/bandwidth.

Do you have a solution that's less aesthetically unpleasant?  I think
that this is a good compromise all around (mumble, frotz, I want macros
and promises and continuations so I can say [wait-for [tell obj message
arg arg arg]]).  But then again, I actually find it *more* aesthetically
pleasant to say THIS HERE IS LIKELY TO BE REMOTE.  Despite the other
advantages of moving to PB methods returning Deferreds, I was glad that
I could previously grep for 'pbcallback' and get most of the methods
that would be invoked remotely.

&gt;<i> &quot;So-at-least-ONE-of-us-has-been-replaced-by-an-evil-robot&quot;-ly yours,
</I>
Who would want to replace me with another evil robot?

-- 
&quot;Cannot stand to be one of many -- I'm not what they are.&quot;
        -Guster, &quot;Rocketship&quot;
                glyph lefkowitz; ninjaneer, freelance demiurge
    glyph @ [ninjaneering|twistedmatrix].com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20020216/9c34ec4d/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-python/attachments/20020216/9c34ec4d/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000801.html">[Twisted-Python] Potential PB Security Problem (And Solution)
</A></li>
	<LI>Next message: <A HREF="000806.html">[Twisted-Python] Potential PB Security Problem (And Solution)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#804">[ date ]</a>
              <a href="thread.html#804">[ thread ]</a>
              <a href="subject.html#804">[ subject ]</a>
              <a href="author.html#804">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
