<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.lumberjack clobbers existing logs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.lumberjack%20clobbers%20existing%20logs&In-Reply-To=20020225230812.GA1658%40ritsuko.xware.cx">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000853.html">
   <LINK REL="Next"  HREF="000856.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.lumberjack clobbers existing logs</H1>
    <B>Andreas Kostyrka</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.lumberjack%20clobbers%20existing%20logs&In-Reply-To=20020225230812.GA1658%40ritsuko.xware.cx"
       TITLE="[Twisted-Python] twisted.lumberjack clobbers existing logs">andreas at mtg.co.at
       </A><BR>
    <I>Wed Feb 27 04:22:20 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="000853.html">[Twisted-Python] twisted.lumberjack clobbers existing logs
</A></li>
        <LI>Next message: <A HREF="000856.html">[Twisted-Python] twisted.lumberjack clobbers existing logs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#855">[ date ]</a>
              <a href="thread.html#855">[ thread ]</a>
              <a href="subject.html#855">[ subject ]</a>
              <a href="author.html#855">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> On Mon, Feb 25, 2002 at 05:27:33PM +0000, Itamar Shtull-Trauring wrote:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; # assuming &quot;file&quot; exists
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; f = open(&quot;file&quot;, &quot;r+&quot;)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; f.seek(0, 2)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; see the code I checked in for a complete example.
</I>Well, this assumes that there is only one writer for the file.
O_APPEND OTOH, when implemented in the kernel (and not emulated
with the above code in the library), makes this as ONE atomic call.
(basically, it seeks to the end of the file before any write). 

&gt;<i>From open(2):
</I>       O_APPEND
              The file is opened  in  append  mode.  Before  each
              write, the file pointer is positioned at the end of
              the file, as if with lseek.  O_APPEND may  lead  to
              corrupted  files  on  NFS file systems if more than
              one process appends data to a file at  once.   This
              is  because  NFS  does  not  support appending to a
              file, so the client  kernel  has  to  simulate  it,
              which can't be done without a race condition.

Basically, in the NFS case the kernel is not able to do it atomic
so there might be problems.

Side note: It's quite acceptable to use seek/read with an O_RDWR|O_APPEND file. 
It's just automatically seeks to the end before writing. So O_APPEND is quite useful.


Andreas


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000853.html">[Twisted-Python] twisted.lumberjack clobbers existing logs
</A></li>
	<LI>Next message: <A HREF="000856.html">[Twisted-Python] twisted.lumberjack clobbers existing logs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#855">[ date ]</a>
              <a href="thread.html#855">[ thread ]</a>
              <a href="subject.html#855">[ subject ]</a>
              <a href="author.html#855">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
