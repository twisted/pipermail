<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Weird PyPY twisted.internet.defer.TimeoutError ERROR*12 during full test run
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Weird%20PyPY%20twisted.internet.defer.TimeoutError%0A%20ERROR%2A12%20during%20full%20test%20run&In-Reply-To=%3CCAMcKhMSoBALGPnLtoeP6CiO3Gkfs7AZfaXJRS2E28mKjiEGSvQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="031562.html">
   <LINK REL="Next"  HREF="031565.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Weird PyPY twisted.internet.defer.TimeoutError ERROR*12 during full test run</H1>
    <B>Tristan Seligmann</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Weird%20PyPY%20twisted.internet.defer.TimeoutError%0A%20ERROR%2A12%20during%20full%20test%20run&In-Reply-To=%3CCAMcKhMSoBALGPnLtoeP6CiO3Gkfs7AZfaXJRS2E28mKjiEGSvQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Weird PyPY twisted.internet.defer.TimeoutError ERROR*12 during full test run">mithrandi at mithrandi.net
       </A><BR>
    <I>Fri Aug  4 21:22:14 MDT 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="031562.html">[Twisted-Python] Weird PyPY twisted.internet.defer.TimeoutError ERROR*12 during full test run
</A></li>
        <LI>Next message (by thread): <A HREF="031565.html">[Twisted-Python] Weird PyPY twisted.internet.defer.TimeoutError ERROR*12 during full test run
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31563">[ date ]</a>
              <a href="thread.html#31563">[ thread ]</a>
              <a href="subject.html#31563">[ subject ]</a>
              <a href="author.html#31563">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 5 Aug 2017 at 00:44 Daniel Sutcliffe &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dansut at gmail.com</A>&gt; wrote:

&gt;<i> For the buildbot:
</I>&gt;<i> <A HREF="https://buildbot.twistedmatrix.com/builders/ubuntu16.04-pypy5/">https://buildbot.twistedmatrix.com/builders/ubuntu16.04-pypy5/</A>
</I>&gt;<i> they seem to pretty much consistently happen during:
</I>&gt;<i>   twisted.protocols.test.test_tls.TLSMemoryBIOTests.test_hugeWrite_TLSv1_1
</I>&gt;<i> but running in my own environment(s) I also always see the 12
</I>&gt;<i> TimoutError but they can occur in a variety of different tests, I've
</I>&gt;<i> seen them in these as well as the above:
</I>&gt;<i>    twisted.news.test.test_news.NewsTests.testArticleRequest
</I>&gt;<i>    twisted.names.test.test_server.DNSServerFactoryTests.test_verboseDefault
</I>&gt;<i>
</I>&gt;<i>  twisted.positioning.test.test_nmea.BrokenSentenceCallbackTests.test_dontSwallowCallbackException
</I>&gt;<i> and a bunch of others.
</I>&gt;<i>
</I>
This kind of timeout usually means that the test is waiting for some event,
and due to an event ordering that wasn't expected, the event never happens;
for example, it might have already happened before you start waiting for
it, or it might not happen at all due to an error.

Sometimes this means that the test is really stuck, but often it means that
an error has occurred but was not handled by the test, so you get an error
(maybe logged, maybe not) but also the test never ends.

Always exactly 12 and always during same test for a single test run.
&gt;<i> I've not been able to reproduce running anything but the full
</I>&gt;<i> testsuite - but they have always occured for me during full run.
</I>&gt;<i>
</I>&gt;<i> Just wondered if anybody with more experience had a clue/idea as to
</I>&gt;<i> why this could happen (why 12), and how I could go about tracking down
</I>&gt;<i> the root cause.
</I>&gt;<i>
</I>
Look for missing error handling in the test to see if an error is occurring
that the test does not notice; if you're lucky, these errors may have been
logged (check test.log). If not, you may need to improve the error handling
and / or play around in a debugger.

If the test really is stuck, a common cause of PyPy vs CPython issues is
garbage collection or weakref callbacks happening in an unpredictable
ordering of events. I haven't looked at the tests in question but I would
check for things like __del__ methods (eg. files not being closed
explicitly) or weakref use in the vicinity.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20170805/ae2040ad/attachment.html&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="031562.html">[Twisted-Python] Weird PyPY twisted.internet.defer.TimeoutError ERROR*12 during full test run
</A></li>
	<LI>Next message (by thread): <A HREF="031565.html">[Twisted-Python] Weird PyPY twisted.internet.defer.TimeoutError ERROR*12 during full test run
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31563">[ date ]</a>
              <a href="thread.html#31563">[ thread ]</a>
              <a href="subject.html#31563">[ subject ]</a>
              <a href="author.html#31563">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
