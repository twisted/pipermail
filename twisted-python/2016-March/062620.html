<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] how to implement login form logic with twisted.cred checkers, credentials and portal
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20how%20to%20implement%20login%20form%20logic%20with%0A%20twisted.cred%20checkers%2C%20credentials%20and%20portal&In-Reply-To=%3C56DB9FDB.3080701%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="030157.html">
   <LINK REL="Next"  HREF="062641.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] how to implement login form logic with twisted.cred checkers, credentials and portal</H1>
    <B>Mashiat Sarker Shakkhar</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20how%20to%20implement%20login%20form%20logic%20with%0A%20twisted.cred%20checkers%2C%20credentials%20and%20portal&In-Reply-To=%3C56DB9FDB.3080701%40gmail.com%3E"
       TITLE="[Twisted-Python] how to implement login form logic with twisted.cred checkers, credentials and portal">mashiat.sarker at gmail.com
       </A><BR>
    <I>Sat Mar  5 20:11:23 MST 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="030157.html">[Twisted-Python] how to implement login form logic with twisted.cred checkers, credentials and portal
</A></li>
        <LI>Next message (by thread): <A HREF="062641.html">[Twisted-Python] how to implement login form logic with twisted.cred checkers, credentials and portal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62620">[ date ]</a>
              <a href="thread.html#62620">[ thread ]</a>
              <a href="subject.html#62620">[ subject ]</a>
              <a href="author.html#62620">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3/2/16 9:32 AM, snailcoder wrote:
&gt;<i> I'm trying to implement some login logic using twisted.cred module for 
</I>&gt;<i> a website. In short, there's a login page with username/password 
</I>&gt;<i> forms. Once the user input the right username/password, the browser 
</I>&gt;<i> will redirect to another page which includes the user's profile.
</I>&gt;<i>
</I>&gt;<i> Does anyone have any ideas about how to implement this logic with 
</I>&gt;<i> twisted.cred checkers, credentials and portal? Any suggestion is 
</I>&gt;<i> appreciated :-)
</I>
Hi

Before I answer your question, allow me to give you a word of advice. 
Twisted is a low-level library. While you can build a web application 
directly on top of Twisted, I would not recommend it. You need 
higher-level abstractions to write manageable code. I recommend that you 
find a framework that builds on top of Twisted.

As for your question, you will find many examples of Twisted 
authentication if you Google a bit. You should probably start by reading 
this page: 
<A HREF="https://twistedmatrix.com/documents/current/core/howto/cred.html.">https://twistedmatrix.com/documents/current/core/howto/cred.html.</A> Below 
you will find a simple (and not very secure) example. It uses HTTP Basic 
authentication. It owes its verbosity to the low-level nature of Twisted.


     from twisted.cred import portal, checkers, credentials, error as 
credError
     from twisted.internet import defer, reactor
     from twisted.web import guard, http, resource, server
     from zope.interface import implements

     class HttpPasswordRealm(object):
         implements(portal.IRealm)

         def __init__(self, resource):
             self.resource = resource

         def requestAvatar(self, avatarId, mind, *interfaces):
             if resource.IResource in interfaces:
                 return (resource.IResource, self.resource, lambda: None)
             raise NotImplementedError()

     class MyPasswordChecker(object):
         implements(checkers.ICredentialsChecker)
         credentialInterfaces = (credentials.IUsernamePassword, )
         MY_INSECURE_CREDS = {'name': 'pa$$w0rd'}

         @defer.inlineCallbacks
         def requestAvatarId(self, creds):
             pw = self.MY_INSECURE_CREDS.get(creds.username) or b''
             pw_match = yield creds.checkPassword(pw)
             if pw_match is True:
                 defer.returnValue(creds.username)
             else:
                 raise credError.UnauthorizedLogin('Incorrect username 
or password')

     class MyPortal(resource.Resource):
         isLeaf = True

         def render_GET(self, request):
             return 'Top secret content'

     checker = MyPasswordChecker()
     realm = HttpPasswordRealm(MyPortal())
     p = portal.Portal(realm, [checker, ])

     factory = guard.BasicCredentialFactory('My secret portal')
     protected_resource = guard.HTTPAuthSessionWrapper(p, [factory, ])

     site = server.Site(protected_resource)
     site.protocol = http.HTTPChannel
     reactor.listenTCP(8080, site)

     reactor.run()


Do not go and copy-paste the above. Please do your research. To build 
the interaction you described, I will recommend using Klein 
(<A HREF="https://github.com/twisted/klein">https://github.com/twisted/klein</A>). Klein can give you your entire app 
as a Resource instance. This example does not manage sessions or lets 
you log out. It only describes how you can protect a Resource using 
Twisted.cred. Good luck.

Regards
Shakkhar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20160305/11d6aa49/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="030157.html">[Twisted-Python] how to implement login form logic with twisted.cred checkers, credentials and portal
</A></li>
	<LI>Next message (by thread): <A HREF="062641.html">[Twisted-Python] how to implement login form logic with twisted.cred checkers, credentials and portal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62620">[ date ]</a>
              <a href="thread.html#62620">[ thread ]</a>
              <a href="subject.html#62620">[ subject ]</a>
              <a href="author.html#62620">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
