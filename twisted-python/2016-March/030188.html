<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Cannot perform IPv6 Link-Local Multicast on	Twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Cannot%20perform%20IPv6%20Link-Local%20Multicast%20on%0A%09Twisted&In-Reply-To=%3CA0AA2F82-2AFE-46A9-B6E3-C931F43E092E%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030187.html">
   <LINK REL="Next"  HREF="030189.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Cannot perform IPv6 Link-Local Multicast on	Twisted</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Cannot%20perform%20IPv6%20Link-Local%20Multicast%20on%0A%09Twisted&In-Reply-To=%3CA0AA2F82-2AFE-46A9-B6E3-C931F43E092E%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Cannot perform IPv6 Link-Local Multicast on	Twisted">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Mar 16 11:55:05 MDT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="030187.html">[Twisted-Python] Cannot perform IPv6 Link-Local Multicast on Twisted
</A></li>
        <LI>Next message: <A HREF="030189.html">[Twisted-Python] upcoming changes to twistedmatrix.com mail	infrastructure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30188">[ date ]</a>
              <a href="thread.html#30188">[ thread ]</a>
              <a href="subject.html#30188">[ subject ]</a>
              <a href="author.html#30188">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Mar 16, 2016, at 6:41 AM, Shantanoo Desai &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">itsmeshantanu at hotmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> I am trying to use the .joinGroup() by passing the IPv6 link-local multicast add. ff02::1 but get DNS lookup failure error.
</I>&gt;<i> 
</I>&gt;<i> I am trying to use the UDP multicast example on the twistedmatrix.com &lt;<A HREF="http://twistedmatrix.com/">http://twistedmatrix.com/</A>&gt; website and simply replacing the IPv4 multicast address with the IPv6 one.
</I>&gt;<i> 
</I>&gt;<i> I have also posted a query on StackOverflow: <A HREF="http://stackoverflow.com/questions/36034258/ipv6-link-local-multicast-on-twisted">http://stackoverflow.com/questions/36034258/ipv6-link-local-multicast-on-twisted</A> &lt;<A HREF="http://stackoverflow.com/questions/36034258/ipv6-link-local-multicast-on-twisted">http://stackoverflow.com/questions/36034258/ipv6-link-local-multicast-on-twisted</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> I am newbie on Twisted and some suggestions would be appreciated. 
</I>
I haven't had time to fully investigate, but unfortunately, this is probably a hard-coded limitation of Twisted, currently.  The right thing for you to do would be to contribute a patch to Twisted that fixes this; please file a ticket for that if there isn't one already.

But, in the interests both of telling you how you might write that patch, and also how to work around it right now, let me explain: 'listenMulticast' constructs a MulticastPort which has an addressFamily of AF_INET (i.e.: IPv4).  In order to join an IPv6 group, you would need one that supports IPv6.

The right way to do this within Twisted is to set the address family the way that twisted.internet.tcp._BaseTCPClient does; check if the input 'interface' is a literal ipv4 or ipv6 address and set the self.addressFamily accordingly.

However, assuming you don't care about Windows, as a quick workaround (this is NOT a good long-term solution; at some point in the distant future, `twisted.internet.udp&#180; will hopefully disappear as an importable module, since you should always be doing this sort of thing via the reactor), you could do something like this:

from socket import AF_INET6
from twisted.internet.udp import MulticastPort

class MyMulticastPort(MulticastPort, object):
    addressFamily = AF_INET6

def listenMulticast(reactor, port, protocol, interface='', maxPacketSize=8192,
                    listenMultiple=False):
    p = MyMulticastPort(port, protocol, interface, maxPacketSize, reactor,
                        listenMultiple)
    p.startListening()
    return p

Note that this is totally untested, which is why I'm answering here and not Stack Overflow :-).  Let me know if it works!

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20160316/47fa5855/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20160316/47fa5855/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030187.html">[Twisted-Python] Cannot perform IPv6 Link-Local Multicast on Twisted
</A></li>
	<LI>Next message: <A HREF="030189.html">[Twisted-Python] upcoming changes to twistedmatrix.com mail	infrastructure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30188">[ date ]</a>
              <a href="thread.html#30188">[ thread ]</a>
              <a href="subject.html#30188">[ subject ]</a>
              <a href="author.html#30188">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
