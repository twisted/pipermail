<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Embedding manhole interpreter into insults	widget.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Embedding%20manhole%20interpreter%20into%20insults%0A%09widget.&In-Reply-To=%3CCAKef57Pyk30bOGZAfp8QpPuHJP37j3KAwj_ycKzv11STWfN2wQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028574.html">
   <LINK REL="Next"  HREF="028577.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Embedding manhole interpreter into insults	widget.</H1>
    <B>Maxim Lacrima</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Embedding%20manhole%20interpreter%20into%20insults%0A%09widget.&In-Reply-To=%3CCAKef57Pyk30bOGZAfp8QpPuHJP37j3KAwj_ycKzv11STWfN2wQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Embedding manhole interpreter into insults	widget.">lacrima.maxim at gmail.com
       </A><BR>
    <I>Thu Aug  7 03:00:20 MDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="028574.html">[Twisted-Python] Embedding manhole interpreter into insults	widget.
</A></li>
        <LI>Next message: <A HREF="028577.html">[Twisted-Python] Embedding manhole interpreter into insults widget.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28576">[ date ]</a>
              <a href="thread.html#28576">[ thread ]</a>
              <a href="subject.html#28576">[ subject ]</a>
              <a href="author.html#28576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6 August 2014 22:48, Glyph Lefkowitz &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> Optimizing this will almost certainly involve patching Twisted.  Which you
</I>&gt;<i> should definitely do :).
</I>&gt;<i>
</I>&gt;<i> The reason the entire screen is redrawn is that a *general* implementation
</I>&gt;<i> of a widget, i.e. one that can be displayed anywhere on the terminal, you
</I>&gt;<i> do just have to redraw the entire widget when certain things happen, like
</I>&gt;<i> when the screen scrolls.  You can see this in other software by observing
</I>&gt;<i> the fairly significant performance difference between a vertical split and
</I>&gt;<i> a horizontal split in tmux.  Nothing to do with Twisted there, just a
</I>&gt;<i> general limitation of terminals.
</I>&gt;<i>
</I>
&gt;<i> The optimizations you could implement are one where inputting individual
</I>&gt;<i> characters doesn't cause a full screen redraw, and avoiding a full screen
</I>&gt;<i> redraw when scrolling if the edges of the widget touch the edges of the
</I>&gt;<i> full terminal (setting up a scroll area for that case).
</I>&gt;<i>
</I>
When manhole is used directly, then it is very responsive, and the
performance doesn't degrade with increase of screen size. It holds only
what user entered and writes the input line and command output directly to
its transport, without bothering itself with processing of the whole
screen. When I embed manhole into the widget like above, then the
performance suffers. I think this is due to `TerminalBuffer` having to hold
whole widget area (columns * rows) in memory, even if only a small portion
of it is actually occupied by user input and command output. Rendering the
whole buffer on each keystroke is slow. After experimenting a little bit, I
think optimizations that you described mostly apply to
`ManholeWidget.render` method, which shouldn't traverse the whole buffer on
each keystroke. Currently I don't see how this involves patching widget
implementation in Twisted. What is more important to me is that
`TerminalBuffer` implementation is slightly incomplete. I think it misses
color support, because I couldn't make it work with `ColoredManhole`.


&gt;<i>
</I>&gt;<i> -glyph
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Regards,
Maxim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20140807/19bfd0ef/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20140807/19bfd0ef/attachment.html</A>&gt;
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028574.html">[Twisted-Python] Embedding manhole interpreter into insults	widget.
</A></li>
	<LI>Next message: <A HREF="028577.html">[Twisted-Python] Embedding manhole interpreter into insults widget.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28576">[ date ]</a>
              <a href="thread.html#28576">[ thread ]</a>
              <a href="subject.html#28576">[ subject ]</a>
              <a href="author.html#28576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
