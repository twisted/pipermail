<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Serving WSGIResource via SSL endpoint
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Serving%20WSGIResource%20via%20SSL%20endpoint&In-Reply-To=%3CA6EE6F78-8DF3-44AF-9A2C-4C06B6C670D4%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="028627.html">
   <LINK REL="Next"  HREF="061092.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Serving WSGIResource via SSL endpoint</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Serving%20WSGIResource%20via%20SSL%20endpoint&In-Reply-To=%3CA6EE6F78-8DF3-44AF-9A2C-4C06B6C670D4%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Serving WSGIResource via SSL endpoint">glyph at twistedmatrix.com
       </A><BR>
    <I>Fri Aug 15 02:15:53 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="028627.html">[Twisted-Python] Serving WSGIResource via SSL endpoint
</A></li>
        <LI>Next message (by thread): <A HREF="061092.html">[Twisted-Python] Serving WSGIResource via SSL endpoint
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61089">[ date ]</a>
              <a href="thread.html#61089">[ thread ]</a>
              <a href="subject.html#61089">[ subject ]</a>
              <a href="author.html#61089">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Aug 14, 2014, at 3:54 PM, Piper Masden &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">piper.masden at gmail.com</A>&gt; wrote:

&gt;<i> Hi Twistedeers!
</I>&gt;<i> 
</I>&gt;<i>   I have a twisted plugin that I created to replace the Django dev server for our devs.
</I>
Cool!

&gt;<i> It sets up a separate twisted service for serving media, so we don't need any urls.py tomfoolery in dev. It also sets up an experimental REST api server which we hope to make javascript requests to in the near future.
</I>
Glad to hear you're using Twisted for this.

&gt;<i>   The core of the code looks like this:
</I>&gt;<i> 
</I>&gt;<i>     resource = WSGIResource(reactor, reactor.getThreadPool(), WSGIHandler())
</I>&gt;<i>     endpoint = 'tcp:port=8000'
</I>&gt;<i>     server = strports.service(endpoint, server.Site(resource))
</I>&gt;<i>     server.setServiceParent(application)
</I>&gt;<i> 
</I>&gt;<i>   This has worked great for a while. However, we have some views that we require https on, and so this dev server doesn't allow us to get to those views at all. I generated a .key file and a .crt file with openssl, and then cat'd them together to make a pem, and then changed the endpoint to be...
</I>&gt;<i> 
</I>&gt;<i>     endpoint = 'ssl:port=8000:privateKey=/path/to/key.pem'
</I>&gt;<i> 
</I>&gt;<i>   Now when I open my browser and type <A HREF="https://localhost:8000,">https://localhost:8000,</A> chrome just hangs. I don't really know how to diagnose this, because I don't really know anything about SSL (it's all just magic security goodness to me). I don't necessarily need a direct answer (though it will certainly make me look good to all the other devs), but maybe some pointers in the right direction would help.
</I>
This isn't really enough information to diagnose a problem, but here are some things you could try:

openssl s_client -connect localhost:8000
curl -vvvv <A HREF="https://localhost:8000/">https://localhost:8000/</A>

These should output some stuff about your TLS connection, and will perhaps emit an error message which looks obvious to you.  If not, seeing some of that output might be useful to help diagnose it.  Also, trying other web browsers is always helpful.

You might also try replacing your SSL string endpoint description with a TXSNI endpoint plugin: &lt;<A HREF="https://github.com/glyph/txsni">https://github.com/glyph/txsni</A>&gt;.  This is just a little easier to get right because of how it reads certificates (for example you don't need to get your private key, chain cert, and main cert in the right order, as long as they're all in the appropriate file.

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20140815/0ca60cf4/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="028627.html">[Twisted-Python] Serving WSGIResource via SSL endpoint
</A></li>
	<LI>Next message (by thread): <A HREF="061092.html">[Twisted-Python] Serving WSGIResource via SSL endpoint
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61089">[ date ]</a>
              <a href="thread.html#61089">[ thread ]</a>
              <a href="subject.html#61089">[ subject ]</a>
              <a href="author.html#61089">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
