<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] running twisted with supervisord -- logging question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20running%20twisted%20with%20supervisord%20--%20logging%0A%20question&In-Reply-To=%3CetPan.53f97ea3.6763845e.35a6%40densetsu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="061124.html">
   <LINK REL="Next"  HREF="061128.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] running twisted with supervisord -- logging question</H1>
    <B>Christopher Armstrong</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20running%20twisted%20with%20supervisord%20--%20logging%0A%20question&In-Reply-To=%3CetPan.53f97ea3.6763845e.35a6%40densetsu%3E"
       TITLE="[Twisted-Python] running twisted with supervisord -- logging question">radix at twistedmatrix.com
       </A><BR>
    <I>Sat Aug 23 23:56:50 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="061124.html">[Twisted-Python] running twisted with supervisord -- logging question
</A></li>
        <LI>Next message (by thread): <A HREF="061128.html">[Twisted-Python] running twisted with supervisord -- logging question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61126">[ date ]</a>
              <a href="thread.html#61126">[ thread ]</a>
              <a href="subject.html#61126">[ subject ]</a>
              <a href="author.html#61126">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On August 23, 2014 at 6:50:32 PM, Jonathan Vanasco (<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at 2xlp.com</A>) wrote:
Christopher-

Thanks for the insight.  I was stupid and didn't include my code.

I don't actually want supervisor to handle the logging.  I wanted to have this app's logs in /var/log/myapp-twisted/twisted.log

I just can't figure out how to make this happen.  i've been playing with different permutations of twistd commands, redirect_stderr and stdout_logfile, and haven't found the right balance

the actual logging calls are just to python's logger ( `import logging` ; logging.getLogger(), log.debug(), etc)

---------
[program:myapp-twisted]
priority=100
process_name=%(program_name)s
autostart=true
autorestart=true
stopsignal=QUIT
redirect_stderr = false
stdout_logfile = /var/log/myapp-twisted/twisted.log
directory = /var/www/sites/myapp-svn_tag-current_production/daemon/twisted
environment = PATH=&quot;/var/www/sites/myapp-virtualenv/bin:$PATH&quot;
command = /var/www/sites/myapp-virtualenv/bin/twistd -y controller-production.tac --pidfile /tmp/myapp-twisted.pid
----------



You’re seemingly contradicting yourself: you say you don’t want supervisor to handle logging, but the supervisor configuration you've shown is handling the logging, by routing its stdout to /var/log/myapp-twisted/twisted.log (which I think is a fine thing to do, fwiw).

If this isn’t working, then the problem is probably in your python code, not the supervisor configuration: are you sure it’s writing logs to stdout? Again, we need to see your actual python code (or a minimal reproducible example) to diagnose this.

Since you’re not using twisted’s logging system, I really can’t make any guesses here. If you *were* using twisted’s logging system, I would point out that you should add “-l -“ to your twistd command line in that supervisor config, to make twisted’s logs go to stdout as well (maybe you want to do this even if your application isn’t using twisted’s log system, so that both the logs of twisted and of your application are going to the same place).


-- 
Christopher Armstrong
<A HREF="http://twitter.com/radix">http://twitter.com/radix</A>
<A HREF="http://wordeology.com/">http://wordeology.com/</A>






On Aug 22, 2014, at 11:50 PM, Christopher Armstrong wrote:


On August 22, 2014 at 6:52:02 PM, Jonathan Vanasco (<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at 2xlp.com</A>) wrote:

hoping someone can answer this question- 

i can't seem to get my logging right while using supervisord 

i'm not using twisted logging, just the regular python logging infrastructure. 

the two end-results I've had: 

- everything double-logs into twistd.log &amp; /var/log/supervisor.log 
- anything this is `print`'ed appears in my twistd.log , but none of the `log.debug()` lines appear 

the end result I want, is for debug info from the twisted process to be recorded in a single file 


I prefer to use



twistd -n -l - ...



passing ‘-' to -l means “log to stdout”.



Without your code, we can’t know how you’re configuring python logging, and what may be wrong with it. This should be the baseline for using twistd with supervisor if you want to let supervisor handle logging. FYI, you can configure supervisor to put the output in a different file than /var/log/supervisor.log, too.



-- 
Christopher Armstrong
<A HREF="http://twitter.com/radix">http://twitter.com/radix</A>
<A HREF="http://wordeology.com/">http://wordeology.com/</A>

_______________________________________________
Twisted-Python mailing list
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>

// Jonathan Vanasco

c. 646.729.6436  |  415.501.9815
e. <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jonathan at 2xlp.com</A>
w. <A HREF="http://findmeon.com/user/jvanasco&#194;&#160;">http://findmeon.com/user/jvanasco </A>
linkedin. <A HREF="http://linkedin.com/in/jonathanvanasco">http://linkedin.com/in/jonathanvanasco</A>
blog. <A HREF="http://destructuring.net">http://destructuring.net</A>

_______________________________________________  
Twisted-Python mailing list  
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>  
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20140824/02a6907b/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="061124.html">[Twisted-Python] running twisted with supervisord -- logging question
</A></li>
	<LI>Next message (by thread): <A HREF="061128.html">[Twisted-Python] running twisted with supervisord -- logging question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61126">[ date ]</a>
              <a href="thread.html#61126">[ thread ]</a>
              <a href="subject.html#61126">[ subject ]</a>
              <a href="author.html#61126">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
