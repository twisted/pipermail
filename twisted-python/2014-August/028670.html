<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] running twisted with supervisord -- logging	question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20running%20twisted%20with%20supervisord%20--%20logging%0A%09question&In-Reply-To=%3C834BACD1-1428-413C-A622-72ABECF1940A%402xlp.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028667.html">
   <LINK REL="Next"  HREF="028669.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] running twisted with supervisord -- logging	question</H1>
    <B>Jonathan Vanasco</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20running%20twisted%20with%20supervisord%20--%20logging%0A%09question&In-Reply-To=%3C834BACD1-1428-413C-A622-72ABECF1940A%402xlp.com%3E"
       TITLE="[Twisted-Python] running twisted with supervisord -- logging	question">twisted-python at 2xlp.com
       </A><BR>
    <I>Mon Aug 25 16:37:12 MDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="028667.html">[Twisted-Python] running twisted with supervisord -- logging question
</A></li>
        <LI>Next message: <A HREF="028669.html">[Twisted-Python] Twisted Trac
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28670">[ date ]</a>
              <a href="thread.html#28670">[ thread ]</a>
              <a href="subject.html#28670">[ subject ]</a>
              <a href="author.html#28670">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Thanks Hynek and Christopher. 

Hynek- That's basically what I want -- but i am always quickly LOST when it comes to logging. It is my weakness.

Christopher-- The code is definitely contradicting me. I am admittedly lost.

I'll have to play around with this more in depth later -- but now I have an temporarily acceptable solution.

For the most part, I'm not logging anything myself.   I'm really concerned with all the debug messages that various PyPi packages send to the standard library's logging facility.  While running the twisted daemon outside of supervisord, this stuff ends up on the console( which i believe is both stdout/stderr ).

When I wrote &quot;not having supervisord handle the logging&quot; , I should have chosen better words.  It could have been stated as &quot;I don't want /var/log/supervisord.log to handle the logging&quot;.  I don't care who handles the logging, I just wanted debug data from my twisted app in it's own file, and not in another.

I was trying to route the stderr into the /var/log/myapp-twisted/log ; but it was going into both that AND the /var/log/supervisord.log file

I tried using different permutations of the `-l` format, but without a bit of configuring, I could only get the &quot;log.debug()&quot; lines in twisted code to output; not the submodules.

After playing around, this seems to work the best:

[supervisord]
logfile=/var/log/supervisord.log
loglevel=warn

[myapp]
redirect_stderr = true
stdout_logfile = /var/log/myapp-twisted/twisted.log

It's not a perfect solution, but works for now --  I just raised the loglevel for supervisord to `warn`, so it doesn't doubly log any data.  The downside is that i'm not getting the debug messages from other apps that supervisord handles.  






On Aug 24, 2014, at 2:36 AM, Hynek Schlawack wrote:

&gt;<i> I would strongly urge you to do what Christopher told you, and not just for Twisted but in general.
</I>&gt;<i> 
</I>&gt;<i> Logging everything to stdout/stderr and then using some proper system tool to catch and process that instead of the finicky stdlib (or Twisted&#8217;s for that matter) logging will save you a lot of headaches and gain some love if you work with ops people.  Another alternative is using syslog which is directly supported by twistd.
</I>


On Aug 24, 2014, at 1:56 AM, Christopher Armstrong wrote:
&gt;<i> 
</I>&gt;<i> You&#8217;re seemingly contradicting yourself: you say you don&#8217;t want supervisor to handle logging, but the supervisor configuration you've shown is handling the logging, by routing its stdout to /var/log/myapp-twisted/twisted.log (which I think is a fine thing to do, fwiw).
</I>&gt;<i> 
</I>&gt;<i> If this isn&#8217;t working, then the problem is probably in your python code, not the supervisor configuration: are you sure it&#8217;s writing logs to stdout? Again, we need to see your actual python code (or a minimal reproducible example) to diagnose this.
</I>&gt;<i> 
</I>&gt;<i> Since you&#8217;re not using twisted&#8217;s logging system, I really can&#8217;t make any guesses here. If you *were* using twisted&#8217;s logging system, I would point out that you should add &#8220;-l -&#8220; to your twistd command line in that supervisor config, to make twisted&#8217;s logs go to stdout as well (maybe you want to do this even if your application isn&#8217;t using twisted&#8217;s log system, so that both the logs of twisted and of your application are going to the same place).
</I>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20140825/30d77db6/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20140825/30d77db6/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028667.html">[Twisted-Python] running twisted with supervisord -- logging question
</A></li>
	<LI>Next message: <A HREF="028669.html">[Twisted-Python] Twisted Trac
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28670">[ date ]</a>
              <a href="thread.html#28670">[ thread ]</a>
              <a href="subject.html#28670">[ subject ]</a>
              <a href="author.html#28670">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
