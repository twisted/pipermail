<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Scalability of timers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Scalability%20of%20timers&In-Reply-To=%3C634914A010D0B943A035D226786325D4447940E044%40EXVMBX020-12.exch020.serverdata.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="061065.html">
   <LINK REL="Next"  HREF="061070.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Scalability of timers</H1>
    <B>Tobias Oberstein</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Scalability%20of%20timers&In-Reply-To=%3C634914A010D0B943A035D226786325D4447940E044%40EXVMBX020-12.exch020.serverdata.net%3E"
       TITLE="[Twisted-Python] Scalability of timers">tobias.oberstein at tavendo.de
       </A><BR>
    <I>Sun Aug 10 15:38:09 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="061065.html">[Twisted-Python] Scalability of timers
</A></li>
        <LI>Next message (by thread): <A HREF="061070.html">[Twisted-Python] Scalability of timers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61067">[ date ]</a>
              <a href="thread.html#61067">[ thread ]</a>
              <a href="subject.html#61067">[ subject ]</a>
              <a href="author.html#61067">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>There is only one select() call (or whatever) at any given time, regardless of how many timers.
</I>
Yes, I do understand this.

&gt;<i>Syscalls are thus O(1). Timers are stored in sorted order. When event loop wakes up it removes timers that have been reached, which is fast because they're sorted so when you hit one that is still in future you can stop. So that's pretty scalable.
</I>
syscalls are O(1). But the constant is non zero. A syscall is still quite expensive. try doing 1 mio. syscalls/sec on any x86 box (Linux, BSD, whatever). DEC Alphas and Itanium might be able to do more, but the context switching overhead of x86 architecture is &quot;huge&quot;.

But I feel I failed in formulating what I am asking.

Could you please correct where my thinking below goes wrong?

Let's say I issue 1 mio. timers with expirary times t0, t0+1us, t0+2us, .., t0+1s

That is 1 mio. timers expiring in 1us pitch within 1s.

That will mean 1 mio. select() syscalls done in 1s each with timeout set to 1us

Since it's unlikely that a box supports a rate of 1 mio. syscalls/sec, that means a select with timeout 1us won't return after 1us, but &gt;1us. Twisted will process all timers that have expired in the meantime. But there is no way of letting 1 mio. timers fire in 1us pitch within 1s using a syscall.

What I am after is to explicitly _control_ the maximum syscall rate to select() - not simply max. out the box on syscall rate.

Like: limit syscall rate to select() at 1000Hz - regardless how many timers I issue per second.

In above example, with syscall max set to 1000Hz, each time select() returns 1000 timers would have expired. That's fine. That's what I want.

How can I do that?

Thanks!
Tobias


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="061065.html">[Twisted-Python] Scalability of timers
</A></li>
	<LI>Next message (by thread): <A HREF="061070.html">[Twisted-Python] Scalability of timers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61067">[ date ]</a>
              <a href="thread.html#61067">[ thread ]</a>
              <a href="subject.html#61067">[ subject ]</a>
              <a href="author.html#61067">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
