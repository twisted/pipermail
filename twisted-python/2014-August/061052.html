<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] help with listening to UDP broadcast?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20help%20with%20listening%20to%20UDP%20broadcast%3F&In-Reply-To=%3CCAE3TBxzddTKSaemEF26VNVRXafac1WAhxA7gLxqacZd2sho0pg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="028590.html">
   <LINK REL="Next"  HREF="028594.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] help with listening to UDP broadcast?</H1>
    <B>Pantelis Theodosiou</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20help%20with%20listening%20to%20UDP%20broadcast%3F&In-Reply-To=%3CCAE3TBxzddTKSaemEF26VNVRXafac1WAhxA7gLxqacZd2sho0pg%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] help with listening to UDP broadcast?">ypercube at gmail.com
       </A><BR>
    <I>Fri Aug  8 18:04:31 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="028590.html">[Twisted-Python] help with listening to UDP broadcast?
</A></li>
        <LI>Next message (by thread): <A HREF="028594.html">[Twisted-Python] On problems with inlineCallbacks (was Re: Is there pb documentation somewhere?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61052">[ date ]</a>
              <a href="thread.html#61052">[ thread ]</a>
              <a href="subject.html#61052">[ subject ]</a>
              <a href="author.html#61052">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Russell,

In an old script I've written, I see the following differences with your
code:

I hadn't used at all  allsetBroadcastAllowed()
but joinGroup()   (in startPrtotocol).

And I don't think the 255.255.255.255 will work. You'll need something like
192.168.1.1 or 127.0.0.1

The code (stripped from irrelevant parts) was:

from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
from twisted.application.internet import MulticastServer

# Set ports and hosts
ip = '224.0.5.228'
port = 8228

# our interface
interface = '192.168.1.1'

class MulticastClientUDP(DatagramProtocol):

    def startProtocol(self):
        # Join the multicast group
        self.transport.joinGroup(ip, interface)
        self.transport.setTTL(255)

    def datagramReceived(self, datagram, address):
        print &quot;got a UDP broadcast packet&quot;


# set reactor to listen on multicast channels
alertsClient = MulticastClientUDP()
reactor.listenMulticast(port, alertsClient)

reactor.run()


Pantelis Theodosiou


On Fri, Aug 8, 2014 at 11:58 PM, Russell E. Owen &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rowen at uw.edu</A>&gt; wrote:

&gt;<i> I've found an example for UDP broadcasting:
</I>&gt;<i> &lt;<A HREF="https://twistedmatrix.com/trac/browser/trunk/docs/projects/core/examples">https://twistedmatrix.com/trac/browser/trunk/docs/projects/core/examples</A>
</I>&gt;<i> /udpbroadcast.py?rev=41516
</I>&gt;<i> &lt;<A HREF="https://twistedmatrix.com/trac/browser/trunk/docs/projects/core/examples/udpbroadcast.py?rev=41516">https://twistedmatrix.com/trac/browser/trunk/docs/projects/core/examples/udpbroadcast.py?rev=41516</A>&gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> However, it combines the sender and receiver in a way that I find
</I>&gt;<i> confusing. I figured out how output UDP broadcast packets, but not how
</I>&gt;<i> to make a client that receives to the packets.
</I>&gt;<i>
</I>&gt;<i> Here is what we have, which doesn't work. Based on a comment on the
</I>&gt;<i> broadcast UDP ticket. I suspect the problem is specifying the broadcast
</I>&gt;<i> address using the interface argument to listenUDP, but I'm not sure. In
</I>&gt;<i> any case, no value for interface that I've tried works:
</I>&gt;<i> -&quot;&lt;broadcast&gt;&quot; (which is what my senders uses) results in
</I>&gt;<i> twisted.internet.error.InvalidAddressError
</I>&gt;<i> -&quot;255.255.255.255&quot; results in twisted.internet.error.CannotListenError:
</I>&gt;<i> Couldn't listen on 255.255.255.255:1235: [Errno 49] Can't assign
</I>&gt;<i> requested address.
</I>&gt;<i> - omitting it results in no packets received.
</I>&gt;<i> I also tried listenMulticast, but it didn't work (and I didn't expect it
</I>&gt;<i> to, based on comments I saw on the ticket for implementing UDP broadcast
</I>&gt;<i> support).
</I>&gt;<i>
</I>&gt;<i> Any hints would be appreciated.
</I>&gt;<i>
</I>&gt;<i> #!/usr/bin/env python2
</I>&gt;<i> &quot;&quot;&quot;Attempt to listen to UDP broadcasts
</I>&gt;<i> &quot;&quot;&quot;
</I>&gt;<i> from twisted.internet.protocol import DatagramProtocol
</I>&gt;<i> from twisted.internet import reactor
</I>&gt;<i>
</I>&gt;<i> Port = 1235
</I>&gt;<i>
</I>&gt;<i> class BroadcastUDPClient(DatagramProtocol):
</I>&gt;<i>     def startProtocol(self):
</I>&gt;<i>         self.transport.setBroadcastAllowed(True)
</I>&gt;<i>
</I>&gt;<i>     def datagramReceived(self, datagram, address):
</I>&gt;<i>         print &quot;got a UDP broadcast packet&quot;
</I>&gt;<i>
</I>&gt;<i> class UDPListener(object):
</I>&gt;<i>     def __init__(self, port):
</I>&gt;<i>         self.port = port
</I>&gt;<i>         self.broadcastClient = BroadcastUDPClient()
</I>&gt;<i>         self.listener = None
</I>&gt;<i>         self.startListening()
</I>&gt;<i>
</I>&gt;<i>     def startListening(self):
</I>&gt;<i>         if self.listener is None:
</I>&gt;<i>             interface = &quot;255.255.255.255&quot;
</I>&gt;<i>             self.listener = reactor.listenUDP(self.port,
</I>&gt;<i>                 self.broadcastClient, interface)
</I>&gt;<i>
</I>&gt;<i>     def stopListening(self):
</I>&gt;<i>         if self.listener is not None:
</I>&gt;<i>             self.listener.stopListening()
</I>&gt;<i>             self.listener = None
</I>&gt;<i>
</I>&gt;<i> if __name__ == &quot;__main__&quot;:
</I>&gt;<i>     listener = UDPListener(Port)
</I>&gt;<i>     reactor.run()
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20140809/f86c99db/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="028590.html">[Twisted-Python] help with listening to UDP broadcast?
</A></li>
	<LI>Next message (by thread): <A HREF="028594.html">[Twisted-Python] On problems with inlineCallbacks (was Re: Is there pb documentation somewhere?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61052">[ date ]</a>
              <a href="thread.html#61052">[ thread ]</a>
              <a href="subject.html#61052">[ subject ]</a>
              <a href="author.html#61052">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
