<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Is there pb documentation somewhere?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Is%20there%20pb%20documentation%20somewhere%3F&In-Reply-To=%3CCAJtE5vT3SCHOwa8H-JeMJtXON32fieW%3DcOXeOr1ggZEpb5m_Fw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="061110.html">
   <LINK REL="Next"  HREF="061112.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Is there pb documentation somewhere?</H1>
    <B>Dustin J. Mitchell</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Is%20there%20pb%20documentation%20somewhere%3F&In-Reply-To=%3CCAJtE5vT3SCHOwa8H-JeMJtXON32fieW%3DcOXeOr1ggZEpb5m_Fw%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Is there pb documentation somewhere?">dustin at v.igoro.us
       </A><BR>
    <I>Mon Aug 18 21:16:03 MDT 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="061110.html">[Twisted-Python] Is there pb documentation somewhere?
</A></li>
        <LI>Next message (by thread): <A HREF="061112.html">[Twisted-Python] Is there pb documentation somewhere?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61111">[ date ]</a>
              <a href="thread.html#61111">[ thread ]</a>
              <a href="subject.html#61111">[ subject ]</a>
              <a href="author.html#61111">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Adding what amounts to a use-after-free bug to the protocol seems like a
really bad idea to me.

Perhaps you see a more compelling use-case than the chess example.  In just
about any case I can think of, I'm not at all concerned about when garbage
collection takes place.  Certainly it opens you to a denial of service from
a malicious client, which might hold references to objects you'd rather it
didn't, but PB's not made for use in hostile situations, and anyway it has
an upper limit (hard-coded to 4096) on the number of references a client
can hold.  Trust me, Buildbot users run up against that limit all the time.

If your server-side app is sensitive to when objects are destroyed for any
reason aside from management of its memory consumption, I'd argue your app
is broken.

It's worth noting that Buildbot also ran into a nasty bug in an older
version of Twisted that caused the broker to not unreference objects
correctly, which led to quite a bit of memory usage.

Dustin



On Mon, Aug 18, 2014 at 8:28 PM, Daniel Sank &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sank.daniel at gmail.com</A>&gt; wrote:

&gt;<i> Dustin and glyph,
</I>&gt;<i>
</I>&gt;<i> &gt; Indeed, what you're expecting is very much against the design of PB.
</I>&gt;<i>
</I>&gt;<i> I see. The existing Referenceable code now makes sense to me, since I now
</I>&gt;<i> understand the intent. Thank you.
</I>&gt;<i>
</I>&gt;<i> Would having something like Referenceable but which is not reference
</I>&gt;<i> counted across the network, and which receives a notification when the
</I>&gt;<i> server-side object dies, be useful [1]?
</I>&gt;<i>
</I>&gt;<i> I'm thinking of the case where I use pb to play chess over the network. If
</I>&gt;<i> a piece is captured, the server's reference to that object will be deleted.
</I>&gt;<i> There is no sense, in this case, for the object representing the piece to
</I>&gt;<i> persist, and certainly not because the client's happen to have knowledge
</I>&gt;<i> that the piece existed once upon a time.
</I>&gt;<i>
</I>&gt;<i> Daniel
</I>&gt;<i>
</I>&gt;<i> [1] I haven't delved into the Viewable code yet, so that might be what I'm
</I>&gt;<i> describing.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, Aug 18, 2014 at 4:30 PM, Dustin J. Mitchell &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dustin at v.igoro.us</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Indeed, what you're expecting is very much against the design of PB.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Dustin
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Mon, Aug 18, 2014 at 5:25 PM, Daniel Sank &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sank.daniel at gmail.com</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Dustin,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &gt; No, this is simply incorrect.  'del myThingy' simply removes
</I>&gt;&gt;&gt;<i> &gt; a reference to the object to which myThingy refers.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Argh. I'm assuming, as in the example, that the only strong reference to
</I>&gt;&gt;&gt;<i> myThingy is the one I own.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &gt; the Broker keeps a Python reference to the object internally,
</I>&gt;&gt;&gt;<i> &gt; preventing the reference count from reaching zero,
</I>&gt;&gt;&gt;<i> &gt; preventing the object from being deleted.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I understand that. I'm trying to ask if that's how it _should_ work. If
</I>&gt;&gt;&gt;<i> I have a resource and make a Referenceable to give you access to it, it
</I>&gt;&gt;&gt;<i> doesn't really make sense to me that my resource should be kept alive just
</I>&gt;&gt;&gt;<i> because you have that access. It seems more reasonable to me that your
</I>&gt;&gt;&gt;<i> access object should reference my resource _weakly_ and that you should
</I>&gt;&gt;&gt;<i> receive some kind of notification if and when the resource expires.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It's just like the case of a GUI and a business logic object. The GUI
</I>&gt;&gt;&gt;<i> probably gets a reference to the business logic object so that eg. button
</I>&gt;&gt;&gt;<i> pushes can invoke methods on the object. However, that reference should
</I>&gt;&gt;&gt;<i> probably be weak so that the business logic object can be garbage collected
</I>&gt;&gt;&gt;<i> when it's finished with its business. There's no sense (to me) in keeping
</I>&gt;&gt;&gt;<i> an object alive because a GUI, logger, or other observer is observing it.
</I>&gt;&gt;&gt;<i> Am I just wrong?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Daniel
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Mon, Aug 18, 2014 at 2:18 PM, Dustin J. Mitchell &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dustin at v.igoro.us</A>&gt;
</I>&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> On Mon, Aug 18, 2014 at 3:37 PM, Daniel Sank &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sank.daniel at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;&gt;<i> &gt; and I send you the Referenceable. Now suppose I do
</I>&gt;&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;&gt;<i> &gt; del myThingy
</I>&gt;&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;&gt;<i> &gt; Now myThingy will be garbage collected.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> No, this is simply incorrect.  'del myThingy' simply removes a
</I>&gt;&gt;&gt;&gt;<i> reference to the object to which myThingy refers.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> If and only if that's the last reference (as determined by Python's
</I>&gt;&gt;&gt;&gt;<i> reference counting), it is deleted.  As glyph said, as long as there
</I>&gt;&gt;&gt;&gt;<i> is an outstanding remote reference, the Broker keeps a Python
</I>&gt;&gt;&gt;&gt;<i> reference to the object internally, preventing the reference count
</I>&gt;&gt;&gt;&gt;<i> from reaching zero, preventing the object from being deleted.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Dustin
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> Daniel Sank
</I>&gt;&gt;&gt;<i> Department of Physics
</I>&gt;&gt;&gt;<i> Broida Hall
</I>&gt;&gt;&gt;<i> University of California
</I>&gt;&gt;&gt;<i> Santa Barbara, CA 93117
</I>&gt;&gt;&gt;<i> (805)893-3899
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Daniel Sank
</I>&gt;<i> Department of Physics
</I>&gt;<i> Broida Hall
</I>&gt;<i> University of California
</I>&gt;<i> Santa Barbara, CA 93117
</I>&gt;<i> (805)893-3899
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20140818/a8f1c5a7/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="061110.html">[Twisted-Python] Is there pb documentation somewhere?
</A></li>
	<LI>Next message (by thread): <A HREF="061112.html">[Twisted-Python] Is there pb documentation somewhere?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61111">[ date ]</a>
              <a href="thread.html#61111">[ thread ]</a>
              <a href="subject.html#61111">[ subject ]</a>
              <a href="author.html#61111">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
