<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] how to write a safe catch-all
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20how%20to%20write%20a%20safe%20catch-all&In-Reply-To=%3CF3E27175-C87B-466A-A3AC-D2E4140A5FFF%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="055448.html">
   <LINK REL="Next"  HREF="055431.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] how to write a safe catch-all</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20how%20to%20write%20a%20safe%20catch-all&In-Reply-To=%3CF3E27175-C87B-466A-A3AC-D2E4140A5FFF%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] how to write a safe catch-all">glyph at twistedmatrix.com
       </A><BR>
    <I>Thu Sep 30 12:52:52 MDT 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="055448.html">[Twisted-Python] how to write a safe catch-all
</A></li>
        <LI>Next message (by thread): <A HREF="055431.html">[Twisted-Python] reactor.stop if no any clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55460">[ date ]</a>
              <a href="thread.html#55460">[ thread ]</a>
              <a href="subject.html#55460">[ subject ]</a>
              <a href="author.html#55460">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Chris,

My original reply jumped into the middle of the thread and I didn't completely understand what you were asking.  Let's get back to your original message:

On Sep 28, 2010, at 9:48 AM, Chris Withers wrote:

&gt;<i> The loop() function is supposed to be a &quot;catch all and report&quot; error handler. However, when the async code initiated by doStuff throws the AttributeError, what actually gets logged is:
</I>&gt;<i> 
</I>&gt;<i> 2010-09-28 14:41:15,706 ERROR   : log         (14757|7f691ba676e0): Unhandled Error
</I>&gt;<i> Traceback (most recent call last):
</I>&gt;<i>  File &quot;test_looping.py&quot;, line 41, in &lt;module&gt;
</I>&gt;<i>    reactor.run()
</I>&gt;<i>  File &quot;Twisted-8.2.0-py2.5-linux-x86_64.egg/twisted/internet/base.py&quot;, line 1128, in run
</I>&gt;<i>    self.mainLoop()
</I>&gt;<i>  File &quot;Twisted-8.2.0-py2.5-linux-x86_64.egg/twisted/internet/base.py&quot;, line 1137, in mainLoop
</I>&gt;<i>    self.runUntilCurrent()
</I>&gt;<i> --- &lt;exception caught here&gt; ---
</I>&gt;<i>  File &quot;Twisted-8.2.0-py2.5-linux-x86_64.egg/twisted/internet/base.py&quot;, line 757, in runUntilCurrent
</I>&gt;<i>    call.func(*call.args, **call.kw)
</I>&gt;<i>  File &quot;test_looping.py&quot;, line 24, in __call__
</I>&gt;<i>    del self.connector
</I>&gt;<i> exceptions.AttributeError: Break instance has no attribute 'connector'
</I>
This traceback indicates a bug in Twisted.

This is an error that other people have very occasionally spotted, and we have never been able to reliably reproduce it.  Over the years we have tried to diagnose it in various ways and we have always failed.

It would be really valuable to everyone if you could write up a bug and provide detailed reproduction instructions, ideally with some python code that triggers this error, so that we can address the bug.  It would be super useful if you could write an example that reproduces the same bug on a recent Twisted version (8.2 is pretty old), especially the 10.2 prerelease.  But, if your example reproduces on 8.2 and not 10.0, that tells us something too.

A unit test would be best, but any complete script which reproduces the problem reliably would be extremely useful; we can transform it into a unit test ourselves.

To reiterate, as this pertains to your problem: there is no way for your application code to fix this exception, because it is happening in the guts of the reactor and entirely out of your control.  It is going to screw things up in some pretty arbitrary ways.  The only way to deal with it would be to figure out why it happens and come up with a proper fix for the bug.  And we can't do that without a way to reproduce the bug.

Thanks for your help,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20100930/901ff180/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="055448.html">[Twisted-Python] how to write a safe catch-all
</A></li>
	<LI>Next message (by thread): <A HREF="055431.html">[Twisted-Python] reactor.stop if no any clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55460">[ date ]</a>
              <a href="thread.html#55460">[ thread ]</a>
              <a href="subject.html#55460">[ subject ]</a>
              <a href="author.html#55460">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
