<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Strange error: SQL-Server tries to rollback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Strange%20error%3A%20SQL-Server%20tries%20to%20rollback&In-Reply-To=53EC192B-E1E3-475B-B6BB-30AEF71753F6%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022843.html">
   <LINK REL="Next"  HREF="022845.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Strange error: SQL-Server tries to rollback</H1>
    <B>Pantelis Theodosiou</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Strange%20error%3A%20SQL-Server%20tries%20to%20rollback&In-Reply-To=53EC192B-E1E3-475B-B6BB-30AEF71753F6%40gmail.com"
       TITLE="[Twisted-Python] Strange error: SQL-Server tries to rollback">ypercube at gmail.com
       </A><BR>
    <I>Fri Sep 10 11:54:34 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="022843.html">[Twisted-Python] Strange error: SQL-Server tries to rollback
</A></li>
        <LI>Next message: <A HREF="022845.html">[Twisted-Python] Strange error: SQL-Server tries to rollback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22844">[ date ]</a>
              <a href="thread.html#22844">[ thread ]</a>
              <a href="subject.html#22844">[ subject ]</a>
              <a href="author.html#22844">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have no experience with MS SQL, only with PostgreSQL via psycopg2, but the
&gt;<i> idea is:
</I>&gt;<i>
</I>&gt;<i> you want to execute many statements, probably in a blocking fashion:
</I>&gt;<i> runInteraction()
</I>&gt;<i> you want to execute just one statement: runQuery()/runOperation()
</I>&gt;<i>
</I>&gt;<i> AFAIK the latter one will do a commit for you if it is needed.
</I>&gt;<i>
</I>&gt;<i> Anyway, for PostgreSQL I can specify isolation level I need.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>
thnx to all. I used runOperation with the INSERTs and it was solved (or i
think that was the cause).

The part of code with the problem was:

-----------------
from twisted.enterprise import adbapi
import pymssql


class DBAccess:

    def __init__(self):
        # SQL-Server
        myhost = &quot;64.x.x.x:4000&quot;
        mydatabase = &quot;db&quot;
        myuser = &quot;user&quot;
        mypassword = &quot;password&quot;

        try:
            self.dbpool = adbapi.ConnectionPool(&quot;pymssql&quot;
                                    , host=myhost
                                    , user=myuser
                                    , password=mypassword
                                    , database=mydatabase
                                    , cp_noisy=False)
            print(&quot;db connection pool created&quot;)
        except Exception as e:
            print(&quot;error starting the ConnectionPool&quot;)
            print(e)

    def insertDATA(self
            , serialNumber
            , customerAccount
            , dateAndTime
            , camcount
            , fpv
            , reff
            , restOfFrame
            ):
        sql = ''.join(
            [
             &quot;INSERT INTO fts_data VALUES (&quot;
                    ,  &quot;'&quot; , serialNumber , &quot;'&quot;
            , &quot;,&quot; , &quot;'&quot; , customerAccount , &quot;'&quot;
            , &quot;,&quot; , &quot;'&quot; , dateAndTime , &quot;'&quot;
            , &quot;,&quot; , camcount
            , &quot;,&quot; , fpv
            , &quot;,&quot; , &quot;'&quot; , reff , &quot;'&quot;
            , &quot;,&quot; , &quot;'&quot; , restOfFrame , &quot;'&quot;
            , &quot;) &quot;
            ] )
        #print(sql)
        try:
            deferred = self.dbpool.runOperation(sql)
            #print(&quot;DATA sent&quot;)
        except Exception as e:
            print(&quot;error in insertDATA&quot;)
            print(e)
            return
        return deferred
------------------

Anyway, I'm now stuck at other levels, and I'm kind of out of ideas and the
customer wants (or has to) finish the whole project in a  very, very short
notice. Like yesterday. And my experience in Python and Twisted is not at
the level to solve problems and fix bugs quickly.

Since the program is written using Twisted, if anyone likes to step over,
contact me directly and i'll provide details.

Pandelis Theodosiou
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20100910/d3e5035f/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20100910/d3e5035f/attachment-0001.htm</A> 
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022843.html">[Twisted-Python] Strange error: SQL-Server tries to rollback
</A></li>
	<LI>Next message: <A HREF="022845.html">[Twisted-Python] Strange error: SQL-Server tries to rollback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22844">[ date ]</a>
              <a href="thread.html#22844">[ thread ]</a>
              <a href="subject.html#22844">[ subject ]</a>
              <a href="author.html#22844">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
