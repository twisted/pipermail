<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] neverending connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20neverending%20connection&In-Reply-To=%3C3AFC7DB2%40epostleser.online.no%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="032576.html">
   <LINK REL="Next"  HREF="032578.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] neverending connection</H1>
    <B>grolgh</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20neverending%20connection&In-Reply-To=%3C3AFC7DB2%40epostleser.online.no%3E"
       TITLE="[Twisted-Python] neverending connection">grolgh at online.no
       </A><BR>
    <I>Thu May 10 13:02:37 MDT 2001</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="032576.html">[Twisted-Python] Handling of spurious \r\n
</A></li>
        <LI>Next message (by thread): <A HREF="032578.html">[Twisted-Python] Configuration: The Never Ending Story.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32577">[ date ]</a>
              <a href="thread.html#32577">[ thread ]</a>
              <a href="subject.html#32577">[ subject ]</a>
              <a href="author.html#32577">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello twisted.minions :)

This is my first mail on tp-ml; hello! I'm currently working on twisted.ftp 
and it's about 30% into acceptable working state. To hack it you need to press 
enter twice :) But I've run into a known problem.

I just noticed that TCPServer.loseConnection never trigs 
TCPServer.connectionLost. I think this is the famous 
never-ending-connection-bug, and I think the bug has its origin in 
selectable.doWrite.

I'll here present my current findings with it. Note that doSelect will run its 
selectable.connectionLost() if selectable's doRead or doWrite returns anything 
non-zero.
 
I'll take it step by step.
A call to loseConnection, will set __reap
Afterwards, __reap appears in doWrite which will write out its buffer and 
return CONNECTION_DONE
doSelect terminates the connection

Well, if we take a closer look at doWrite we find that it has several layers 
of if's before a CONNECTION_DONE is returned. Especially &quot;if not self.unsent&quot;! 
:<i>/
</I>
Well, hope anyone finds this useful; and squash that horrible thing out. :)




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="032576.html">[Twisted-Python] Handling of spurious \r\n
</A></li>
	<LI>Next message (by thread): <A HREF="032578.html">[Twisted-Python] Configuration: The Never Ending Story.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32577">[ date ]</a>
              <a href="thread.html#32577">[ thread ]</a>
              <a href="subject.html#32577">[ subject ]</a>
              <a href="author.html#32577">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
