<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Configuration: The Never Ending Story.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Configuration%3A%20The%20Never%20Ending%20Story.&In-Reply-To=%3C20010511123214.A3318%40Fookidla.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="032578.html">
   <LINK REL="Next"  HREF="032580.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Configuration: The Never Ending Story.</H1>
    <B>Chris Armstrong</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Configuration%3A%20The%20Never%20Ending%20Story.&In-Reply-To=%3C20010511123214.A3318%40Fookidla.org%3E"
       TITLE="[Twisted-Python] Configuration: The Never Ending Story.">carmstro at dynup.net
       </A><BR>
    <I>Fri May 11 10:36:24 MDT 2001</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="032578.html">[Twisted-Python] Configuration: The Never Ending Story.
</A></li>
        <LI>Next message (by thread): <A HREF="032580.html">[Twisted-Python] Configuration: The Never Ending Story.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32579">[ date ]</a>
              <a href="thread.html#32579">[ thread ]</a>
              <a href="subject.html#32579">[ subject ]</a>
              <a href="author.html#32579">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[Ed.: I'm sending it on behalf of Chris since his mail server is down.
I have not edited the mail, and I will reply to it seperately]

Alright, I discussed this with moshe for a while on IRC, and here's my summary
of the discussion.

On Fri, May 11, 2001 at 04:53:15PM +0300, Moshe Zadka wrote:
&gt;<i> OK, let me first state some axioms:
</I>&gt;<i> 
</I>&gt;<i> 1. Everything should be configurable the same way, from within twisted.
</I>&gt;<i> 
</I>&gt;<i> Glyph has mentioned that he's not familiar with what's in bin/ anymore: 
</I>&gt;<i> he just mktelnetserver, and configures from within the telnet server
</I>&gt;<i> everything. This is what should happen, except not limited to the telnet
</I>&gt;<i> server.
</I>
Yes, this is definitely good, and planned this way.

&gt;<i> 2. The configuration interface must not be ui specific.
</I>&gt;<i> 
</I>&gt;<i> This is obvious, right? Command line and web based aren't the only option.
</I>&gt;<i> No reason why we can't implement a special purpose client/server for configuring
</I>&gt;<i> twisted.
</I>
Again, this was planned. web UIs, reality UIs (you enter the magic box, there
is a web server floating here. You configure the web server.), GTK UIs are
all distant goals.

&gt;<i> 3. It should be easy to optimize the configuration for a ui
</I>&gt;<i> 
</I>&gt;<i> This is like the last one -- since we might deal with very good UIs, we
</I>&gt;<i> need to give them enough information for using all their abilities to
</I>&gt;<i> help us.
</I>&gt;<i> 
</I>&gt;<i> 4. It should be very easy to make an object configurable.
</I>&gt;<i> 
</I>&gt;<i> This is very important -- the harder it is, the less it will be easy
</I>&gt;<i> to add *good* code to twisted. This is what may be the single most idiotic
</I>&gt;<i> thing in Zope (and DC is aware of it! and thinking of how to fix it!). Let's
</I>&gt;<i> learn from their mistakes: the less methods, the better. The more the
</I>&gt;<i> learning curve is gradual (not needing to learn a class/method/interface
</I>&gt;<i> before you need the functionality), the better.
</I>
I think this is also very important to end-user acceptance of TPy. If it's
got an easy-to-use and robust configurator, people will use it.

&gt;<i> OK, so what do we need to do about it?
</I>&gt;<i> Here's a rough proposition:
</I>&gt;<i> 
</I>&gt;<i> the configurable *interface*, which will be a class, but not a class
</I>&gt;<i> people should inherit from, will contain the following methods:
</I>&gt;<i> 
</I>&gt;<i> .getQuestions() --&gt; return a dictionary: name of question, Question object
</I>
name change: getParamaters().

&gt;<i> .getAnswer(name, answer) --&gt; notify the application that an answer has been
</I>&gt;<i>                              given to a particular question
</I>&gt;<i>                              It can throw an InvalidAnswer exception with
</I>&gt;<i>                              a string for a reason. This is for 
</I>&gt;<i>                              application-level verification, and is discouraged.
</I>
name change: setParamaters()
Also, throwing the exception is what's discouraged, not the actual use of the
method. :)

&gt;<i> .endAnswer() --&gt; the &quot;application&quot; promises that no methods of the object
</I>&gt;<i>                  will be called between a series of .getAnswer()s and 
</I>&gt;<i>                  .endAnswer(). So, this means that if the UI got a bunch 
</I>&gt;<i>                  of answers, it will call .getAnswer() several times, and
</I>&gt;<i>                  then .endAnswer(). The UI will *check* for this method's
</I>&gt;<i>                  existance, and will not call it if it doesn't exist.
</I>
name change: i'm not sure what, but endAnswer doesn't sound right.
What this is for is deferred calculation of answers. the not-calling-methods
thing needs to be thought about, so we don't have some weird bugs where TPy
goes completely haywire while configuring. (For instance, what if we're
configuring a web server through the web interface?)

&gt;<i> Question objects are meant to be open ended. 
</I>&gt;<i> They can contain a default.
</I>&gt;<i> 
</I>&gt;<i> Here is the general interface of the Question, that all objects conform
</I>&gt;<i> too:
</I>&gt;<i> 
</I>&gt;<i> .hasAnswer() --&gt; boolean, whether the Question already contains an 
</I>&gt;<i>                  answer/default
</I>&gt;<i> .getValue() --&gt; will only work if .hasAnswer() is true, returns the answer
</I>&gt;<i> .setValue(val) --&gt; make .hasAnswer() true
</I>&gt;<i> 
</I>
name change: hasValue()?

&gt;<i> Objects which can be created by the UI should have an __init__ which
</I>&gt;<i> can be called without arguments. If there is any initialization which
</I>&gt;<i> requires arguments, it should be done in endAnswer(). The UI also promises
</I>&gt;<i> not to call .endAnswer() for an object if there any questions which have
</I>&gt;<i> not been answered and do not have a default (.hasAnswer is false.)
</I>
Ok, instead of __init__s that don't take arguments, we have klass.getInitArgs()
that is another set of questions that the user answers before the UI
instantiates the object (well, it'll have to be klass.__dict__['getInitArgs'](),
as glyph pointed out to me). Also, when we instantiate the object, we call
newObject.setParent(parent), as moshe talks about in the open questions at
the bottom of his mail.

&gt;<i> Well, my proposal would not be complete if I didn't say what questions are
</I>&gt;<i> available. Keep in mind, though, that the set of questions is *open ended*.
</I>&gt;<i> That does not violate the light-and-lean guidelines, since a specific
</I>&gt;<i> Question class will only be used if the functionality is needed.
</I>&gt;<i> 
</I>&gt;<i> Without further ado:
</I>
name change for all of the following: *Parameter

&gt;<i> 
</I>&gt;<i> class BooleanQuestion:
</I>&gt;<i> class IntQuestion: (can have .min and .max)
</I>&gt;<i> class FloatQuestion:
</I>&gt;<i> class StringQuestion: (can have .maxlength)
</I>&gt;<i> class LongStringQuestion: (same as above -- it's a hint to the ui)
</I>&gt;<i> class InterfaceQuestion: (specify interface, valid answers are objects)
</I>&gt;<i> class ArrayQuestion: (an array of the same kind of question)
</I>
moshe told me this was a thinko, so forget about array of questions :)

&gt;<i> class DictQuestion: (a dictionary mapping strings -&gt; same kind of question)
</I>
I don't really get this one.


&gt;<i> example:
</I>&gt;<i> 
</I>&gt;<i> class Server: # note -- not inheriting from anything
</I>&gt;<i> 
</I>&gt;<i>     name = port = None
</I>&gt;<i> 
</I>&gt;<i>     def getQuestions(self):
</I>&gt;<i>         name = StringQuestion()
</I>&gt;<i>         if self.name is not None:
</I>&gt;<i>             name.setValue(self.name)
</I>&gt;<i>         port = IntQuestion()
</I>&gt;<i>         if self.port is not None:
</I>&gt;<i>             port.setValue(self.port)
</I>&gt;<i>         return {'port': port, 'name': name}
</I>&gt;<i> 
</I>&gt;<i>     def getAnswer(self, name, answer):
</I>&gt;<i>         # note: no need to use int(answer)
</I>&gt;<i>         # for port: an IntQuestion has an integer as a .getValue()
</I>&gt;<i>         setattr(self, name, answer)
</I>&gt;<i> 
</I>&gt;<i> Open questions:
</I>&gt;<i> * How do we connect classes to interfaces?
</I>&gt;<i>   Suggestion: each class has an attribute __implements__ containig a list
</I>&gt;<i>   of interfaces. Alternatively, an interface is really a list of 
</I>&gt;<i>   (callable, Questions) tuples, which are answered and passed to the callable.
</I>&gt;<i>   Modules with relevant classes register with the correct interface.
</I>
I seem to remember some standardization of this that was proposed in a PEP.
Maybe we should use that standard for now, but of course just use our own
implementation of the implementation-checking stuff. (tongue twister, eh?)

&gt;<i> * How do we let objects created inside another object who their parent are?
</I>&gt;<i>   Suggestion: if an object from on Interface question has a method .setParent,
</I>&gt;<i>   call it with the parent as argument. This should be done by the Question
</I>&gt;<i>   object, so it knows how to call it for each object in a ListQuestion
</I>
After thinking about this for a while, I decided it's a good idea. At first,
it seemed like an arbitrary fix to a problem, but when moshe brought up
how useful it would be when &quot;moving&quot; objects around.

&gt;<i> * How do we let objects &quot;title&quot; a question?
</I>&gt;<i>   Suggestion: a question has a string argument on __init__ titling it.
</I>
that's simple enough.

&gt;<i> * How do we allow the object to signify groupings of questions?
</I>&gt;<i>   Suggestion: this means the design is bad -- break down the object
</I>&gt;<i>   into smaller objects
</I>
I'm not sure of my stance on this. I'll try to think of some examples and
discuss.


-- 
Chris Armstrong                        <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">carmstro at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/~carmstro">http://twistedmatrix.com/~carmstro</A>     <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">carmstro at dynup.net</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="032578.html">[Twisted-Python] Configuration: The Never Ending Story.
</A></li>
	<LI>Next message (by thread): <A HREF="032580.html">[Twisted-Python] Configuration: The Never Ending Story.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32579">[ date ]</a>
              <a href="thread.html#32579">[ thread ]</a>
              <a href="subject.html#32579">[ subject ]</a>
              <a href="author.html#32579">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
