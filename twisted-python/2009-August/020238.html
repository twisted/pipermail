<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to do basic authentication on twisted web
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20do%20basic%20authentication%20on%20twisted%20web&In-Reply-To=4120a220908170655r2aa9d3bdre918b422348540d3%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020237.html">
   <LINK REL="Next"  HREF="020231.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to do basic authentication on twisted web</H1>
    <B>Reza Lotun</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20do%20basic%20authentication%20on%20twisted%20web&In-Reply-To=4120a220908170655r2aa9d3bdre918b422348540d3%40mail.gmail.com"
       TITLE="[Twisted-Python] How to do basic authentication on twisted web">rlotun at gmail.com
       </A><BR>
    <I>Mon Aug 17 10:24:39 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020237.html">[Twisted-Python] How to do basic authentication on twisted web
</A></li>
        <LI>Next message: <A HREF="020231.html">[Twisted-Python] Ldaptor patch for Interfaces
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20238">[ date ]</a>
              <a href="thread.html#20238">[ thread ]</a>
              <a href="subject.html#20238">[ subject ]</a>
              <a href="author.html#20238">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Chris,

&gt;<i> Automatic daemonization and monitoring? This sounds like exactly what I'm after.
</I>&gt;<i>
</I>&gt;<i> I've been calling twisted like so for a project: explicitly setting
</I>&gt;<i> the process id, logger and source file here. And relying on a separate
</I>&gt;<i> cron script to check if all is well:
</I>&gt;<i>
</I>&gt;<i> twistd --pidfile=$PIDFILE --syslog --prefix=program_name --python
</I>&gt;<i> program_name.py
</I>&gt;<i>
</I>&gt;<i> Would using a .tac file make some of these flags redundant?
</I>&gt;<i>
</I>&gt;<i> All I could found about .tac files is here -
</I>&gt;<i> <A HREF="http://twistedmatrix.com/projects/core/documentation/howto/application.html">http://twistedmatrix.com/projects/core/documentation/howto/application.html</A>
</I>&gt;<i>
</I>&gt;<i> Are there any other resources where I can found out about the
</I>&gt;<i> advantages of using .tac files instead the way I've bee doing stuff?
</I>
Well, it won't make all the flags redundant - the default .pid file is
still twistd.pid, and you'd have to set your --prefix, etc. However,
you definitely should be using .tac files since you can handle
daemonization through twistd by using the application framework (you
can select a reactor from twistd by using the -r flag - for example
`twistd -r epoll -y myapp.tac --pidfile=...`).

The link you've posted is the de-facto source for .tac file
documentation. I can post a simple .tac file used for an internal web
tool:

---
from twisted.application import service, internet
from twisted.internet import defer
from twisted.python.log import ILogObserver, FileLogObserver
from twisted.python.logfile import DailyLogFile
from twisted.web import guard, server
from twisted.cred.portal import Portal
from twisted.cred.checkers import FilePasswordDB

from tdusers.lookup import SimpleRealm

import crypt

def cmp_pass(uname, password, storedpass):
    return crypt.crypt(password, storedpass[:2])

def get_api_service():
    &quot;&quot;&quot; Return a service suitable for creating an application object. &quot;&quot;&quot;
    checkers = [FilePasswordDB('/home/repo/.htpasswd',
                hash=cmp_pass)]
    wrapper = guard.HTTPAuthSessionWrapper(
                    Portal(SimpleRealm(), checkers),
                    [guard.BasicCredentialFactory('auth')])
    return internet.TCPServer(8080, server.Site(resource=wrapper))

application = service.Application('Lookup')
logfile = DailyLogFile('lookup.log', '.')
application.setComponent(ILogObserver, FileLogObserver(logfile).emit)

# attach the service to its parent application
service = get_api_service()
service.setServiceParent(application)
----

I then start my tool using twistd -r epoll -y mytacfile.tac. The good
thing about this approach is that your code can live in a seperate
file and no mention of the *running* of it has to be made in that file
- that is, you shouldn't have to explicity choose what reactor you're
using since that's more of a deployment question.

I don't really know of a more comprehensive source for twistd and .tac
files - I suppose if you fancy dong a writeup that'd be appreciated by
the rest of us ;-)

Cheers,
Reza

-- 
Reza Lotun
mobile: +44 (0)7521 310 763
email:  <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rlotun at gmail.com</A>
work:   <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">reza at tweetdeck.com</A>
twitter: @rlotun

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020237.html">[Twisted-Python] How to do basic authentication on twisted web
</A></li>
	<LI>Next message: <A HREF="020231.html">[Twisted-Python] Ldaptor patch for Interfaces
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20238">[ date ]</a>
              <a href="thread.html#20238">[ thread ]</a>
              <a href="subject.html#20238">[ subject ]</a>
              <a href="author.html#20238">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
