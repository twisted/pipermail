<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] OT - adbapi, connection timeouts, mysql - OT
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20OT%20-%20adbapi%2C%20connection%20timeouts%2C%20mysql%20-%20OT&In-Reply-To=%3C4F06DBDD-7E67-4513-8EE6-F1406014C141%40bubblehouse.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052783.html">
   <LINK REL="Next"  HREF="052786.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] OT - adbapi, connection timeouts, mysql - OT</H1>
    <B>Phil Christensen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20OT%20-%20adbapi%2C%20connection%20timeouts%2C%20mysql%20-%20OT&In-Reply-To=%3C4F06DBDD-7E67-4513-8EE6-F1406014C141%40bubblehouse.org%3E"
       TITLE="[Twisted-Python] OT - adbapi, connection timeouts, mysql - OT">phil at bubblehouse.org
       </A><BR>
    <I>Tue Aug 25 08:31:19 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052783.html">[Twisted-Python] OT - adbapi, connection timeouts, mysql - OT
</A></li>
        <LI>Next message (by thread): <A HREF="052786.html">[Twisted-Python] OT - adbapi, connection timeouts, mysql - OT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52785">[ date ]</a>
              <a href="thread.html#52785">[ thread ]</a>
              <a href="subject.html#52785">[ subject ]</a>
              <a href="author.html#52785">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Aug 24, 2009, at 9:14 PM, Garret Heaton wrote:
&gt;<i> On Mon, Aug 24, 2009 at 3:53 PM, Phil Christensen &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">phil at bubblehouse.org</A> 
</I>&gt;<i> &gt; wrote:
</I>&gt;&gt;<i> I feel like I can think of any number of ways running the same  
</I>&gt;&gt;<i> series of queries twice would be a bad thing. I have some very  
</I>&gt;&gt;<i> important queries that are run inside a interaction because they do  
</I>&gt;&gt;<i> a series of operations in sequence. I can't use transactions  
</I>&gt;&gt;<i> because my tables are MyISAM.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Perhaps I'm jumping at shadows, but automatic re-querying just  
</I>&gt;&gt;<i> seems dangerous to me. Only the particular application knows when  
</I>&gt;&gt;<i> it's safe.
</I>&gt;<i>
</I>&gt;<i> This is very true, and I should have mentioned it in my reply. Re- 
</I>&gt;<i> running queries is only possible when you know your application can  
</I>&gt;<i> do it safely.
</I>&gt;<i>
</I>&gt;<i> How would you solve the issue of a lost connection in your case?
</I>
Honestly, I have never actually solved it. I pretty much only write  
webapps these days, so when a ConnectionLost happens, it just  
propagates up the stack and displays an error to the user. Not ideal,  
by any means.

However, in my case, the only time I really get ConnectionLost errors  
is when the MySQL connection timeout closes idle connections in the  
pool. I accidentally fixed this months ago by setting up Nagios to  
monitor the web services, and it runs often enough that it usually  
hits every open connection within that timeout (8hrs).

The only safe way I can think of to do this is run a simple query  
(like SELECT 1) before every interaction. Then you would only  
reconnect/requery if that fails.

The only problem with this is that it still doesn't protect you from  
lost connections that occur during a multi-query interaction.

-phil


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052783.html">[Twisted-Python] OT - adbapi, connection timeouts, mysql - OT
</A></li>
	<LI>Next message (by thread): <A HREF="052786.html">[Twisted-Python] OT - adbapi, connection timeouts, mysql - OT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52785">[ date ]</a>
              <a href="thread.html#52785">[ thread ]</a>
              <a href="subject.html#52785">[ subject ]</a>
              <a href="author.html#52785">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
