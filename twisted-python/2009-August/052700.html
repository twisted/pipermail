<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.names.error.DNSNameError on MacOsX but not	on linux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.names.error.DNSNameError%20on%20MacOsX%20but%0A%20not%09on%20linux&In-Reply-To=%3C4A819C99.8030100%40arimaz.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052701.html">
   <LINK REL="Next"  HREF="052702.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.names.error.DNSNameError on MacOsX but not	on linux</H1>
    <B>Gabriel Rossetti</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.names.error.DNSNameError%20on%20MacOsX%20but%0A%20not%09on%20linux&In-Reply-To=%3C4A819C99.8030100%40arimaz.com%3E"
       TITLE="[Twisted-Python] twisted.names.error.DNSNameError on MacOsX but not	on linux">gabriel.rossetti at arimaz.com
       </A><BR>
    <I>Tue Aug 11 10:30:17 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052701.html">[Twisted-Python] twisted.names.error.DNSNameError on MacOsX	but not on linux
</A></li>
        <LI>Next message (by thread): <A HREF="052702.html">[Twisted-Python] twisted.names.error.DNSNameError on MacOsX	but	not on linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52700">[ date ]</a>
              <a href="thread.html#52700">[ thread ]</a>
              <a href="subject.html#52700">[ subject ]</a>
              <a href="author.html#52700">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gabriel Rossetti wrote:
&gt;<i> Hello everyone,
</I>&gt;<i>
</I>&gt;<i> I wrote a twisted app using the XMPP code that works fin on linux (and 
</I>&gt;<i> windows), but on Mac I get a twisted.names.error.DNSNameError, I 
</I>&gt;<i> searched google but found nothing on this, is there a known bug with 
</I>&gt;<i> Twisted on Mac?
</I>&gt;<i>
</I>&gt;<i> I have Mac OS X 10.5.8, and the latest version of twisted from the website.
</I>&gt;<i>
</I>&gt;<i> Thank you,
</I>&gt;<i> Gabriel
</I>&gt;<i>   
</I>
Here is some example code (from Twisted), this works as-is on linux but 
not on Mac. I tried an internal and an external XMPP server. On Mac I 
get this :

python xmpp_client.py <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">test at toto.com</A> 123

2009/08/11 18:21 +0200 [-] Log opened.

2009/08/11 18:21 +0200 [-] Starting factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:21 +0200 [-] /etc/resolv.conf changed, reparsing

2009/08/11 18:21 +0200 [-] Resolver added ('83.219.127.194', 53) to 
server list

2009/08/11 18:21 +0200 [-] Resolver added ('83.219.127.226', 53) to 
server list

2009/08/11 18:21 +0200 [-] twisted.names.dns.DNSDatagramProtocol 
starting on 49226

2009/08/11 18:21 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
&lt;__main__.XMPPClientConnector instance at 0x1003aa8&gt; will retry in 2 seconds

2009/08/11 18:21 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
Stopping factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:21 +0200 [-] Starting factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:21 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
&lt;__main__.XMPPClientConnector instance at 0x1003aa8&gt; will retry in 7 seconds

2009/08/11 18:21 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
Stopping factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:21 +0200 [-] Starting factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:21 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
&lt;__main__.XMPPClientConnector instance at 0x1003aa8&gt; will retry in 14 
seconds

2009/08/11 18:21 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
Stopping factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:21 +0200 [-] Starting factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:21 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
&lt;__main__.XMPPClientConnector instance at 0x1003aa8&gt; will retry in 30 
seconds

2009/08/11 18:21 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
Stopping factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:22 +0200 [-] Starting factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:22 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
&lt;__main__.XMPPClientConnector instance at 0x1003aa8&gt; will retry in 83 
seconds

2009/08/11 18:22 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
Stopping factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:23 +0200 [-] Starting factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;

2009/08/11 18:23 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
&lt;__main__.XMPPClientConnector instance at 0x1003aa8&gt; will retry in 241 
seconds

2009/08/11 18:23 +0200 [twisted.names.dns.DNSDatagramProtocol (UDP)] 
Stopping factory 
&lt;twisted.words.protocols.jabber.xmlstream.XmlStreamFactory instance at 
0x1003a80&gt;


##############################################################

# -*- coding: utf-8 -*-
# Copyright (c) 2001-2006 Twisted Matrix Laboratories.
# See LICENSE for details.

import sys
from twisted.internet import reactor
from twisted.names.srvconnect import SRVConnector
from twisted.words.xish import domish
from twisted.words.protocols.jabber import xmlstream, client, jid
from twisted.python import log

log.startLogging(sys.stdout)


class XMPPClientConnector(SRVConnector):
    def __init__(self, reactor, domain, factory):
        SRVConnector.__init__(self, reactor, 'xmpp-client', domain, factory)
   
    def pickServer(self):
        host, port = SRVConnector.pickServer(self)
        if not self.servers and not self.orderedServers:
            # no SRV record, fall back..
            port = 5222
        return host, port


class Client(object):
    def __init__(self, client_jid, secret):
        f = client.XMPPClientFactory(client_jid, secret)
        f.addBootstrap(xmlstream.STREAM_CONNECTED_EVENT, self.connected)
        f.addBootstrap(xmlstream.STREAM_END_EVENT, self.disconnected)
        f.addBootstrap(xmlstream.STREAM_AUTHD_EVENT, self.authenticated)
        f.addBootstrap(xmlstream.INIT_FAILED_EVENT, self.init_failed)
        f.addBootstrap(xmlstream.STREAM_ERROR_EVENT, self.error)
        connector = XMPPClientConnector(reactor, &quot;10.204.232.117&quot;, f)
        connector.connect()

    def rawDataIn(self, buf):
        print &quot;RECV: %s&quot; % unicode(buf, 'utf-8')

    def rawDataOut(self, buf):
        print &quot;SEND: %s&quot; % unicode(buf, 'utf-8')

    def connected(self, xs):
        print 'Connected.'
        self.xmlstream = xs
        # Log all traffic
        xs.rawDataInFn = self.rawDataIn
        xs.rawDataOutFn = self.rawDataOut
       
    def disconnected(self, xs):
        print 'Disconnected.'
        reactor.stop()

    def authenticated(self, xs):
        print &quot;Authenticated.&quot;
        presence = domish.Element((None, 'presence'))
        xs.send(presence)

    def init_failed(self, failure):
        print &quot;Initialization failed.&quot;
        print failure
        self.xmlstream.sendFooter()
       
    def error(self, failure):
        print &quot;error&quot;
        print failure
        self.xmlstream.sendFooter()


client_jid = jid.JID(sys.argv[1])
secret = sys.argv[2]
c = Client(client_jid, secret)

reactor.run()


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052701.html">[Twisted-Python] twisted.names.error.DNSNameError on MacOsX	but not on linux
</A></li>
	<LI>Next message (by thread): <A HREF="052702.html">[Twisted-Python] twisted.names.error.DNSNameError on MacOsX	but	not on linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52700">[ date ]</a>
              <a href="thread.html#52700">[ thread ]</a>
              <a href="subject.html#52700">[ subject ]</a>
              <a href="author.html#52700">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
