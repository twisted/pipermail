<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to do basic authentication on twisted web
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20do%20basic%20authentication%20on%20twisted%20web&In-Reply-To=%3C95bb10690908170245x4f968145o48a2578e9e0e4678%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052736.html">
   <LINK REL="Next"  HREF="052739.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to do basic authentication on twisted web</H1>
    <B>Reza Lotun</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20do%20basic%20authentication%20on%20twisted%20web&In-Reply-To=%3C95bb10690908170245x4f968145o48a2578e9e0e4678%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] How to do basic authentication on twisted web">rlotun at gmail.com
       </A><BR>
    <I>Mon Aug 17 03:45:35 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052736.html">[Twisted-Python] How to do basic authentication on twisted web
</A></li>
        <LI>Next message (by thread): <A HREF="052739.html">[Twisted-Python] How to do basic authentication on twisted web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52738">[ date ]</a>
              <a href="thread.html#52738">[ thread ]</a>
              <a href="subject.html#52738">[ subject ]</a>
              <a href="author.html#52738">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Chris,

&gt;<i> I'm using twisted-web on an openwrt computer, using busybox, and after
</I>&gt;<i> looking through the docs, I'm a little unclear about how to implement
</I>&gt;<i> something like apache's htpasswd style authentication.
</I>&gt;<i>
</I>&gt;<i> Using apache, I'd do something like:
</I>&gt;<i>
</I>&gt;<i> htpasswd -c passwrods admin topSecretPassword
</I>&gt;<i>
</I>&gt;<i> What's the simplest way to add a simple check for a username and
</I>&gt;<i> password like this using twisted web?
</I>&gt;<i>
</I>&gt;<i> Where possible, I'd like to keep all of this inside twisted rather
</I>&gt;<i> than rely on installing other binaries, that might not work within the
</I>&gt;<i> confined of a small openwrt install.
</I>
The short answer is that you need to use twisted.cred. It's an
abstraction that allows you to implement authentication without
directly exposing the hashing method or password database details.
Take a look at this example:
<A HREF="http://twistedmatrix.com/projects/web/documentation/examples/webguard.py">http://twistedmatrix.com/projects/web/documentation/examples/webguard.py</A>

It demonstrates an in memory database, which should generally be used
for testing/debugging only - but you might not care about that an be
happy to have an in memory database. If you want to use an .htaccess
apache style password db, you'll have to make a slight modification:

from twisted.web import guard, server
from twisted.cred.portal import Portal
from twisted.cred.checkers import FilePasswordDB

import crypt

def cmp_pass(uname, password, storedpass):
    return crypt.crypt(password, storedpass[:2])

checkers = [FilePasswordDB(path_to_htpasswd,
                                               hash=cmp_pass)]
 wrapper = guard.HTTPAuthSessionWrapper(
                    Portal(SimpleRealm(), checkers),
                    [guard.BasicCredentialFactory('yoursite.com')])
 return internet.TCPServer(8080, server.Site(resource=wrapper))

I'll probably contribute the Htaccess style checker to twisted at some
point, as I've found it useful in the past and others may too.

Cheers,
Reza



-- 
Reza Lotun
+44 (0)7521 310 763
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rlotun at gmail.com</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052736.html">[Twisted-Python] How to do basic authentication on twisted web
</A></li>
	<LI>Next message (by thread): <A HREF="052739.html">[Twisted-Python] How to do basic authentication on twisted web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52738">[ date ]</a>
              <a href="thread.html#52738">[ thread ]</a>
              <a href="subject.html#52738">[ subject ]</a>
              <a href="author.html#52738">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
