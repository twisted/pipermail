<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] sending 'tail -f' command to a remote host	using	conch?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20sending%20%27tail%20-f%27%20command%20to%20a%20remote%20host%0A%09using%09conch%3F&In-Reply-To=%3C20090810132925.7136.2016719798.divmod.xquotient.8%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="052693.html">
   <LINK REL="Next"  HREF="020188.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] sending 'tail -f' command to a remote host	using	conch?</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20sending%20%27tail%20-f%27%20command%20to%20a%20remote%20host%0A%09using%09conch%3F&In-Reply-To=%3C20090810132925.7136.2016719798.divmod.xquotient.8%40localhost.localdomain%3E"
       TITLE="[Twisted-Python] sending 'tail -f' command to a remote host	using	conch?">exarkun at twistedmatrix.com
       </A><BR>
    <I>Mon Aug 10 07:29:25 MDT 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="052693.html">[Twisted-Python] sending 'tail -f' command to a remote host using	conch?
</A></li>
        <LI>Next message (by thread): <A HREF="020188.html">[Twisted-Python] Documentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52696">[ date ]</a>
              <a href="thread.html#52696">[ thread ]</a>
              <a href="subject.html#52696">[ subject ]</a>
              <a href="author.html#52696">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06:10 am, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">nharsha at gmail.com</A> wrote:
&gt;<i>Hi All,
</I>&gt;<i>
</I>&gt;<i>A day back I install Twisted and Conch on RHEL5. I am a novice user of
</I>&gt;<i>Twisted software.
</I>&gt;<i>I copied an example from dev-shed website (attached herewith). This 
</I>&gt;<i>example
</I>&gt;<i>script uses conch to talk to a ssh deamon.
</I>&gt;<i>
</I>&gt;<i>This script was able to capture and return the output of simple 
</I>&gt;<i>commands
</I>&gt;<i>such as - ls, cat etc.
</I>&gt;<i>I mean, when I run the script to execute 'ls -al' on a remote machine 
</I>&gt;<i>it
</I>&gt;<i>does and returns the prompt.
</I>&gt;<i>
</I>&gt;<i>Where as, when I run the script to execute '*tail -f 
</I>&gt;<i>/path/to/mylog.txt*' I
</I>&gt;<i>get the ouput of this command but the prompt never returns.
</I>&gt;<i>When I press ^C (Control-C) I get the following run-time error.
</I>&gt;<i>[snip]
</I>&gt;<i>  File &quot;shankha.py&quot;, line 56, in closed
</I>&gt;<i>    reactor.stop()
</I>&gt;<i>  File
</I>&gt;<i>&quot;/usr/lib/python2.4/site- 
</I>&gt;<i>packages/Twisted-8.2.0-py2.4-linux-i686.egg/twisted/internet/base.py&quot;,
</I>&gt;<i>line 526, in stop
</I>&gt;<i>    raise error.ReactorNotRunning(
</I>&gt;<i>twisted.internet.error.ReactorNotRunning: Can't stop reactor that isn't
</I>&gt;<i>running.*
</I>
This happens because your program tries to stop the reactor twice. 
First, it tries to stop it when you hit ^C - the default handing of ^C 
is to stop the reactor.  Then, your SSH connection is closed (because 
all connections are closed when the reactor is stopped).  Your code 
handles this by calling reactor.stop() again.
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>*I know that 'tail -f' command is expecting &quot;Control-C&quot; or Break to 
</I>&gt;<i>return
</I>&gt;<i>the prompt on remote host.
</I>&gt;<i>But my attempt to send the ^C character is failing..
</I>&gt;<i>
</I>&gt;<i>I am doing somethink like this:
</I>&gt;<i>
</I>&gt;<i>python sshc.py &lt;hostname&gt; 'tail -f mylog.txt ; \x03'
</I>&gt;<i>
</I>&gt;<i>What is the recommended method to adopt such cases?
</I>
You need to set up some glue.  Right now, ^C is not being sent to the 
remote process at all.  It's only being sent to your local sshc.py 
process.  You may want to install your own SIGINT handler, or you may 
want to add a before shutdown trigger (or use a service's stopService 
method) to send ^C to the remote process.  As to what the Conch API is 
for sending a signal to a process, I'm not sure.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="052693.html">[Twisted-Python] sending 'tail -f' command to a remote host using	conch?
</A></li>
	<LI>Next message (by thread): <A HREF="020188.html">[Twisted-Python] Documentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52696">[ date ]</a>
              <a href="thread.html#52696">[ thread ]</a>
              <a href="subject.html#52696">[ subject ]</a>
              <a href="author.html#52696">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
