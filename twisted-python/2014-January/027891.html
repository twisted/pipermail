<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] different import paths lead to insecureJelly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20different%20import%20paths%20lead%20to%20insecureJelly&In-Reply-To=%3C20140102113737.17936.1625910912.divmod.xquotient.23%40top%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027890.html">
   <LINK REL="Next"  HREF="027893.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] different import paths lead to insecureJelly</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20different%20import%20paths%20lead%20to%20insecureJelly&In-Reply-To=%3C20140102113737.17936.1625910912.divmod.xquotient.23%40top%3E"
       TITLE="[Twisted-Python] different import paths lead to insecureJelly">exarkun at twistedmatrix.com
       </A><BR>
    <I>Thu Jan  2 04:37:37 MST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="027890.html">[Twisted-Python] different import paths lead to insecureJelly
</A></li>
        <LI>Next message: <A HREF="027893.html">[Twisted-Python] different import paths lead to insecureJelly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27891">[ date ]</a>
              <a href="thread.html#27891">[ thread ]</a>
              <a href="subject.html#27891">[ subject ]</a>
              <a href="author.html#27891">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07:54 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sank.daniel at gmail.com</A> wrote:
&gt;<i>I have a project in which various modules need to import a particular
</I>&gt;<i>module &quot;util&quot; which has the following content:
</I>&gt;<i>
</I>&gt;<i>    # util.py
</I>&gt;<i>    class FooMaster(pb.Cacheable):
</I>&gt;<i>        ...
</I>&gt;<i>
</I>&gt;<i>    class FooSlave(pb.RemoteCache):
</I>&gt;<i>        ...
</I>&gt;<i>
</I>&gt;<i>    pb.setUnjellyableForClass(FooMaster, FooSlave)
</I>&gt;<i>
</I>&gt;<i>Module &quot;server&quot; lives in the same directory as util and imports it like 
</I>&gt;<i>this
</I>&gt;<i>    # server.py
</I>&gt;<i>    import util
</I>&gt;<i>
</I>&gt;<i>Module clent lives in an entirely different directory and imports util 
</I>&gt;<i>like
</I>&gt;<i>this
</I>&gt;<i>    # client.py
</I>&gt;<i>    import myproject.path.to.some.files.util as util
</I>&gt;<i>
</I>&gt;<i>This leads to the infamous insecureJelly exception because the name of 
</I>&gt;<i>the
</I>&gt;<i>FooMaster class winds up being different due to the different import
</I>&gt;<i>statements. Specifically, server's copy of pb registers it as
</I>&gt;<i>
</I>&gt;<i>&quot;util.FooMaster&quot;
</I>&gt;<i>
</I>&gt;<i>but client's copy registers it as
</I>&gt;<i>
</I>&gt;<i>&quot;myproject.path.to.some.files.util.FooMaster&quot;
</I>&gt;<i>
</I>&gt;<i>1. Is it a bug that pb cares about how something was imported when
</I>&gt;<i>registering unjellyable classes?
</I>
No.  It's a bug in your application. ;)
&gt;<i>2. If not, how am I supposed to work around this?
</I>
Always refer to modules in the same way.  Never use relative imports.
&gt;<i>3. The problem goes away if I use the long, fully qualified import
</I>&gt;<i>statement everywhere. Is that what I'm supposed to do?
</I>
Yep!

If you really had different classes on the client and the server 
representing the same abstract entity then you could explicitly register 
them as being related by registering them using a name instead of using 
a class object.  When you pass a class object, pb just computes that 
name for you.

However, you don't really have different classes here: just differently 
named copies of the same class.  Consistently importing the class using 
the correct, fully qualified package name will cause the classes to have 
the same name (and, if you load the client and server in once process, 
will cause only *one* copy of the module and class to be loaded, rather 
than two) and fix the PB issue.

Jean-Paul
&gt;<i>
</I>&gt;<i>I read the howto and the on Stackoverflow question I could find 
</I>&gt;<i>regarding
</I>&gt;<i>this issue. In both cases, it says to not define names in a main file
</I>&gt;<i>precisely to avoid this issue, but not what to do in my case.
</I>&gt;<i>
</I>&gt;<i>Thank you for any advice.
</I>&gt;<i>
</I>&gt;<i>--
</I>&gt;<i>Daniel Sank
</I>&gt;<i>Department of Physics
</I>&gt;<i>Broida Hall
</I>&gt;<i>University of California
</I>&gt;<i>Santa Barbara, CA 93117
</I>&gt;<i>(805)893-3899
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027890.html">[Twisted-Python] different import paths lead to insecureJelly
</A></li>
	<LI>Next message: <A HREF="027893.html">[Twisted-Python] different import paths lead to insecureJelly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27891">[ date ]</a>
              <a href="thread.html#27891">[ thread ]</a>
              <a href="subject.html#27891">[ subject ]</a>
              <a href="author.html#27891">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
