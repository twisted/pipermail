<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] a question ablout DeferredList
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20a%20question%20ablout%20DeferredList&In-Reply-To=%3C7AD9D575-B77A-4335-B3F7-137E39A3C8DD%40osafoundation.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047063.html">
   <LINK REL="Next"  HREF="047065.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] a question ablout DeferredList</H1>
    <B>Grant Baillie</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20a%20question%20ablout%20DeferredList&In-Reply-To=%3C7AD9D575-B77A-4335-B3F7-137E39A3C8DD%40osafoundation.org%3E"
       TITLE="[Twisted-Python] a question ablout DeferredList">grant at osafoundation.org
       </A><BR>
    <I>Tue Jan  2 20:40:46 MST 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047063.html">[Twisted-Python] a question ablout DeferredList
</A></li>
        <LI>Next message (by thread): <A HREF="047065.html">[Twisted-Python] a question ablout DeferredList
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47064">[ date ]</a>
              <a href="thread.html#47064">[ thread ]</a>
              <a href="subject.html#47064">[ subject ]</a>
              <a href="author.html#47064">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 2 Jan, 2007, at 18:32, hzqij wrote:

&gt;<i> i have a sample code about DeferredList like this:
</I>&gt;<i>
</I>&gt;<i> from twisted.internet import reactor, defer
</I>&gt;<i>
</I>&gt;<i> def printResult(results):
</I>&gt;<i>   for resultInfo in results:
</I>&gt;<i>       success, result = resultInfo
</I>&gt;<i>       if success:
</I>&gt;<i>           print result
</I>&gt;<i>   reactor.stop()
</I>&gt;<i>
</I>&gt;<i> def addTen(result):
</I>&gt;<i>   return result + &quot; ten&quot;
</I>&gt;<i>
</I>&gt;<i> deferred1 = defer.Deferred()
</I>&gt;<i> deferred2 = defer.Deferred()
</I>&gt;<i> deferred3 = defer.Deferred()
</I>&gt;<i> dl = defer.DeferredList([deferred1, deferred2,
</I>&gt;<i> deferred3]).addCallback(printResult)
</I>&gt;<i> deferred1.callback('one')
</I>&gt;<i> deferred2.callback('two')
</I>&gt;<i> deferred3.callback('three')
</I>
At this point, printResult() will get called, because you just fired  
all the deferreds in the DeferredList. But, your printResult()  
assumes the reactor is running, and you haven't started it yet ...

&gt;<i> reactor.run()
</I>
It seems to me that if all you're doing is trying out Deferred/ 
DeferredList, you could just remove the calls to reactor.stop/start 
(): It kind of depends on what your sample code is going to be doing.

--Grant

&gt;<i> then i run this code, it print:
</I>&gt;<i>
</I>&gt;<i> one
</I>&gt;<i> two
</I>&gt;<i> three
</I>&gt;<i>
</I>&gt;<i> but the reactor never stop even i have call reactor.stop() on
</I>&gt;<i> printResult, i press CTRL+C, some error happen:
</I>&gt;<i>
</I>&gt;<i> Unhandled error in Deferred:
</I>&gt;<i> Traceback (most recent call last):
</I>&gt;<i>  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/ 
</I>&gt;<i> defer.py&quot;,
</I>&gt;<i> line 317, in _runCallbacks
</I>&gt;<i>   self.result = callback(self.result, *args, **kw)
</I>&gt;<i>  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/ 
</I>&gt;<i> defer.py&quot;,
</I>&gt;<i> line 507, in _cbDeferred
</I>&gt;<i>   self.callback(self.resultList)
</I>&gt;<i>  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/ 
</I>&gt;<i> defer.py&quot;,
</I>&gt;<i> line 239, in callback
</I>&gt;<i>   self._startRunCallbacks(result)
</I>&gt;<i>  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/ 
</I>&gt;<i> defer.py&quot;,
</I>&gt;<i> line 304, in _startRunCallbacks
</I>&gt;<i>   self._runCallbacks()
</I>&gt;<i> --- &lt;exception caught here&gt; ---
</I>&gt;<i>  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/ 
</I>&gt;<i> defer.py&quot;,
</I>&gt;<i> line 317, in _runCallbacks
</I>&gt;<i>   self.result = callback(self.result, *args, **kw)
</I>&gt;<i>  File &quot;defer5.py&quot;, line 8, in printResult
</I>&gt;<i>   reactor.stop()
</I>&gt;<i>  File &quot;/usr/local/lib/python2.4/site-packages/twisted/internet/ 
</I>&gt;<i> base.py&quot;,
</I>&gt;<i> line 342, in stop
</I>&gt;<i>   raise RuntimeError, &quot;can't stop reactor that isn't running&quot;
</I>&gt;<i> exceptions.RuntimeError: can't stop reactor that isn't running
</I>&gt;<i>
</I>&gt;<i> plz help me, thank you!
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047063.html">[Twisted-Python] a question ablout DeferredList
</A></li>
	<LI>Next message (by thread): <A HREF="047065.html">[Twisted-Python] a question ablout DeferredList
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47064">[ date ]</a>
              <a href="thread.html#47064">[ thread ]</a>
              <a href="subject.html#47064">[ subject ]</a>
              <a href="author.html#47064">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
