<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: client crashed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20client%20crashed&In-Reply-To=E1H5nAi-0006pw-02%40pyramid.twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014624.html">
   <LINK REL="Next"  HREF="014629.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: client crashed</H1>
    <B>Rick Graves</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20client%20crashed&In-Reply-To=E1H5nAi-0006pw-02%40pyramid.twistedmatrix.com"
       TITLE="[Twisted-Python] Re: client crashed">gravesricharde at yahoo.com
       </A><BR>
    <I>Sat Jan 13 17:15:01 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="014624.html">[Twisted-Python] documentation
</A></li>
        <LI>Next message: <A HREF="014629.html">[Twisted-Python] Re: client crashed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14625">[ date ]</a>
              <a href="thread.html#14625">[ thread ]</a>
              <a href="subject.html#14625">[ subject ]</a>
              <a href="author.html#14625">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrew,

Thanks for the feedback. 

BTW, I am new to twisted but not to python.

&gt;<i> Anyway, there's nothing Twisted specific here that I
</I>can see.

I disagree -- I was trying to make a suggestion that
would make future releases of twisted more
bulletproof. 

Specifically, perhaps _parse() should be changed as
follows (4 out of the last 5 lines are different):


def _parse(url, defaultPort=None):
    parsed = urlparse.urlparse(url)
    scheme = parsed[0]
    path = urlparse.urlunparse(('','')+parsed[2:])
    if defaultPort is None:
        if scheme == 'https':
            defaultPort = 443
        else:
            defaultPort = 80
    host, port = parsed[1], defaultPort
    if ':' in host:
        host, port = host.split(':')
        try:
             port = int(port)
        except ValueError:
             port = defaultPort
    return scheme, host, port, path


But I will not change the copy of client.py on my
computer.  I worked around this problem by making sure
all the URL's were clean before giving them to
twisted.  

Going at this from the top down (or bottom up,
depending on your perspective):

lURLs = map( GetCleanURL, lURLs )

def GetCleanURL( sURL ):
    #
    return UrlUnSplitMore( UrlSplitMore( sURL ) )


UrlUnSplitMore and UrlSplitMore have longer lines
which this mail client would wrap, and the result
would look terrible.  In case you are interested, they
are in this plain text file:

<A HREF="http://www.advanced-app.com.hk/MiscJunk/UrlSplitAndUnSplit.txt">http://www.advanced-app.com.hk/MiscJunk/UrlSplitAndUnSplit.txt</A>

Maybe I am making a suggestion to change twisted in
the wrong place.  I will try posting my suggested
change as a &quot;bug&quot; -- client.py crashes on a URL that
most browsers clean up automatically with no problem. 


Thanks,

Rick



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014624.html">[Twisted-Python] documentation
</A></li>
	<LI>Next message: <A HREF="014629.html">[Twisted-Python] Re: client crashed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14625">[ date ]</a>
              <a href="thread.html#14625">[ thread ]</a>
              <a href="subject.html#14625">[ subject ]</a>
              <a href="author.html#14625">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
