<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] patch for background processing (delay 0)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20patch%20for%20background%20processing%20%28delay%200%29&In-Reply-To=%3CE9DE8A67-A952-11D8-A675-000A95686CD8%40redivi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040333.html">
   <LINK REL="Next"  HREF="040335.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] patch for background processing (delay 0)</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20patch%20for%20background%20processing%20%28delay%200%29&In-Reply-To=%3CE9DE8A67-A952-11D8-A675-000A95686CD8%40redivi.com%3E"
       TITLE="[Twisted-Python] patch for background processing (delay 0)">bob at redivi.com
       </A><BR>
    <I>Tue May 18 23:10:58 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040333.html">[Twisted-Python] patch for background processing (delay 0)
</A></li>
        <LI>Next message (by thread): <A HREF="040335.html">[Twisted-Python] patch for background processing (delay 0)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40334">[ date ]</a>
              <a href="thread.html#40334">[ thread ]</a>
              <a href="subject.html#40334">[ subject ]</a>
              <a href="author.html#40334">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In my heapq implementation of a similar timer mechanism (outside of 
Twisted), I did three things that twisted doesn't:
- cancelling a timer doesn't try and remove it from the heapq, instead 
it just marks the timer as dead.
- the time when it's supposed to fire is passed to the fire method so 
that the timer can determine whether it's supposed to actually fire or 
not (in the case of a time change it is actually added to the queue a 
second time without being removed so that I don't have to disrupt the 
heapq).
- it's two phase.. I have a list of newly added timers, and a heapq of 
waiting-to-fire timers.  At the end of the iteration I shove the list 
into the heapq and clear the list.  This prevents infinite callLater(0, 
...) situations.

-bob

On May 19, 2004, at 12:53 AM, Bill la Forge wrote:

&gt;<i>
</I>&gt;<i> You're quite welcome. I just hope it passes the regression tests!
</I>&gt;<i>  
</I>&gt;<i> I did manage, finally, to download cygwin. (Been a few years since I've
</I>&gt;<i>  used it.) Here in India, bandwidth depends on a lot more than the 
</I>&gt;<i> dialup
</I>&gt;<i>  connection. ;-) (Though things have improved greatly in the last few
</I>&gt;<i>  years.)
</I>&gt;<i>  
</I>&gt;<i> As for speed, I still suspect that heapq may be faster than insort. I 
</I>&gt;<i> know
</I>&gt;<i>  there's a few places in the code base where the last element is
</I>&gt;<i>  inspected (timeout method comes to mind) that would need to be
</I>&gt;<i>  changed to the first element.
</I>&gt;<i>   
</I>&gt;<i> And, of course, Heapq is mising the remove method (I've since coded 
</I>&gt;<i> it).
</I>&gt;<i>  
</I>&gt;<i> But then there's the resetter method... might be impacted and I can't
</I>&gt;<i>  figure it out. ;-(
</I>&gt;<i>  
</I>&gt;<i> Bill
</I>&gt;<i>
</I>&gt;<i> Jp Calderone &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at divmod.com</A>&gt; wrote:
</I>&gt;<i> Thanks for the contribution :) By the way, for a slightly less hefty
</I>&gt;<i>  download than cygwin, check out <A HREF="http://unxutils.sourceforge.net/">http://unxutils.sourceforge.net/</A> 
</I>&gt;<i> (kindly
</I>&gt;<i>  pointed out by bear in #twisted). It includes a Windows-native diff 
</I>&gt;<i> tool.
</I>&gt;<i>
</I>&gt;<i> Jp
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Bill la Forge
</I>&gt;<i> <A HREF="http://www.geocities.com/laforge49/">http://www.geocities.com/laforge49/</A>
</I>&gt;<i>
</I>&gt;<i> Yahoo! India Matrimony: Find your partner  online.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20040519/48f4342f/attachment-0002.bin&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040333.html">[Twisted-Python] patch for background processing (delay 0)
</A></li>
	<LI>Next message (by thread): <A HREF="040335.html">[Twisted-Python] patch for background processing (delay 0)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40334">[ date ]</a>
              <a href="thread.html#40334">[ thread ]</a>
              <a href="subject.html#40334">[ subject ]</a>
              <a href="author.html#40334">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
