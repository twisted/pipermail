<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20pb.Copyable%2C%20round%20trip%20objects%2C%09and%20untrusted%0A%09clients&In-Reply-To=%3C40AD8B27.7090503%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040366.html">
   <LINK REL="Next"  HREF="040371.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients</H1>
    <B>Christopher Armstrong</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20pb.Copyable%2C%20round%20trip%20objects%2C%09and%20untrusted%0A%09clients&In-Reply-To=%3C40AD8B27.7090503%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients">radix at twistedmatrix.com
       </A><BR>
    <I>Thu May 20 22:52:55 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040366.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted clients
</A></li>
        <LI>Next message (by thread): <A HREF="040371.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40368">[ date ]</a>
              <a href="thread.html#40368">[ thread ]</a>
              <a href="subject.html#40368">[ subject ]</a>
              <a href="author.html#40368">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>David Ripton wrote:
&gt;<i> On 2004.05.20 13:07:06 +0000, Christopher Armstrong wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i>Well, your example didn't look like it had much use for using 
</I>&gt;&gt;<i>particularly complex state going both ways. Maybe you can explain this 
</I>&gt;&gt;<i>game-choosing process in a bit more detail? Without knowing any more, 
</I>&gt;&gt;<i>letting the user choose which game he wants to play sounds like it 
</I>&gt;&gt;<i>shouldn't be more complex than the server giving the client a list of 
</I>&gt;&gt;<i>strings of game-names (like &quot;Bob's l33t Server&quot;) and the client sending 
</I>&gt;&gt;<i>back &quot;Bob's l33t Server&quot; in a request later on.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> The full game has much more complex state, which I will resist spelling
</I>&gt;<i> out in detail.  I was just trying to show a minimal example. 
</I>&gt;<i> 
</I>&gt;<i> Yes, that particular event would only really require sending a list of 
</I>&gt;<i> dicts or tuples, with each dict or tuple holding the ~6 attributes of 
</I>&gt;<i> a single game that need to be displayed in a table, from server to 
</I>&gt;<i> client.  And then sending just the name or id of the one game that 
</I>&gt;<i> the user wants to join back to the server.  (Another event would send a
</I>&gt;<i> different subset of the game state.)
</I>&gt;<i> 
</I>&gt;<i> But there is a (small) code size cost to pass just the attributes of 
</I>&gt;<i> the Game class that are needed for that GUI display.  Passing the
</I>&gt;<i> whole Game class (censored in a global rather than event-specific way)
</I>&gt;<i> is simpler.  And if I decide to add another column to that table,
</I>&gt;<i> passing the whole object probably doesn't require a change to the 
</I>&gt;<i> remote call arguments, while passing the minimal bits does.  And it just
</I>&gt;<i> feels like better OO design to pass a whole object rather than ripping
</I>&gt;<i> out bits and pieces of it.
</I>
Ok, I'm going to debate this assumption of yours. It seems you're 
complaining about something that is barely a problem: let's talk about 
code size. Here's an example of how stuff could work.

In the client:

persp.callRemote(&quot;getCurrentGames&quot;).addCallback(_cbGotGames)

def _cbGotGames(self, games):
     # games is a list of complex objects, or whatever
     print &quot;games are&quot;, games
     print &quot;which one?&quot;
     ui.whichGame(games).addCallback(_cbChosenGame)

def _cbChosenGame(self, game):
     #here's what you think saves a lot of code space:
     persp.callRemote(&quot;chooseGame&quot;, game)
     #as opposed to
     persp.callRemote(&quot;chooseGame&quot;, game.id())


Hmm, I count a single extra method call there. That doesn't seem like a 
whole lot to me. :-) This is not worth getting worked up over. 
Unfortunately, the Python community has somehow gotten into an obsession 
with syntax, and is trying to reduce tiny amounts of extra syntax at all 
costs.... but that's a rant for somewhere other than twisted-python.

 &gt; None of which matters much, if passing just dicts and strings and ints
 &gt; is secure, and passing copies of complex objects is not.  (This seems to
 &gt; happen in every &quot;distributed object system&quot; I try.  Basic RPC works
 &gt; [except in Java RMI, which appears to be an April Fool's joke];
 &gt; anything more complex works for &quot;Hello World&quot; then falls over in
 &gt; production.)

There's certainly applications using Copyable and Cacheable in 
production; I'm not sure what exactly you're talking about.

[snip]

I'll wait until you respond to this email before going over the points 
in the second section of your email.

&gt;&gt;<i>IOW, the poster who said that your second and third points are basically 
</I>&gt;&gt;<i>the same is correct; the API you're designing needs to be looked at 
</I>&gt;&gt;<i>specifically to see the optimal secure/easy solution.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Sure.
</I>&gt;<i> 
</I>&gt;<i> Upon further review, I'm back to throwing minimal action objects both
</I>&gt;<i> ways, eschewing Copyable and Cacheable completely in favor of manual
</I>&gt;<i> solutions involving dicts and lists of strings and ints.  Which is 
</I>&gt;<i> where I was a couple of weeks ago.  The grass is always greener...
</I>&gt;<i> 
</I>&gt;<i> The security issues in Copyable / Cacheable should knock me off this 
</I>&gt;<i> particular fence for long enough to have enough code written that I'm
</I>&gt;<i> unwilling to climb back up.
</I>
Well, I'm defending my point in the name of sane, easy to implement 
design, and not primarily security. I'm not really sure what big 
security issues you're complaining about here. I think you're largely 
overreacting; Copyable and Cacheable are certainly useful, usable 
functionality. Of course, things aren't perfect, but we admit this with 
the newpb project. We are trying to solve all of the problems with the 
current PB there, especially security related. OTOH, I don't think 
you've pointed out any real problems with it. It mostly seems to be 
based on weird desires, to me. In fact, let me go back to your original 
post...


&gt;<i> Obviously, the client should only be able to change the server's 
</I> &gt; game state via a well-defined error-checked interface.  Also fairly
 &gt; straightforward, though error-prone since you need to forsee and
 &gt; test against every way to cheat.
&gt;<i>
</I>&gt;<i> There's a third hole to plug, which is passing an object from the server
</I> &gt; to the client as an argument of a client-side remote_* method, and later
 &gt; getting it back as an argument to a server-side perspective_* method.
 &gt; (e.g. the server passes the client a list of games in progress, and
 &gt; later the client passes back the game it wants to join.)  If the client
 &gt; changes the object before passing it back, it might trick the server
 &gt; into doing the wrong thing with it.

See, what it seems like you're saying here is &quot;I want the client to be 
able to send me data that I don't care about and that it shouldn't be 
able to have control to change in the first place, but then I want to do 
extra work on the server to throw that data out&quot;. I should have made 
this point earlier, but I was rather tired when I last posted to this 
thread :). Anyway, that's what I'm hearing, and it doesn't really make 
sense to me.

-- 
  Twisted | Christopher Armstrong: International Man of Twistery
   Radix  |          Release Manager,  Twisted Project
---------+           <A HREF="http://radix.twistedmatrix.com/">http://radix.twistedmatrix.com/</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 256 bytes
Desc: OpenPGP digital signature
URL: &lt;/pipermail/twisted-python/attachments/20040521/513cb3e0/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040366.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted clients
</A></li>
	<LI>Next message (by thread): <A HREF="040371.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40368">[ date ]</a>
              <a href="thread.html#40368">[ thread ]</a>
              <a href="subject.html#40368">[ subject ]</a>
              <a href="author.html#40368">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
