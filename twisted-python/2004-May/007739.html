<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] adbapi/postgresql and xml-rpc
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20adbapi/postgresql%20and%20xml-rpc&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007738.html">
   <LINK REL="Next"  HREF="007740.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] adbapi/postgresql and xml-rpc</H1>
    <B>James R. Saker Jr.</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20adbapi/postgresql%20and%20xml-rpc&In-Reply-To="
       TITLE="[Twisted-Python] adbapi/postgresql and xml-rpc">jsaker at americanrelay.com
       </A><BR>
    <I>Wed May 12 15:52:34 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007738.html">[Twisted-Python] When do calls to transport.write() block ?
</A></li>
        <LI>Next message: <A HREF="007740.html">[Twisted-Python] adbapi/postgresql and xml-rpc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7739">[ date ]</a>
              <a href="thread.html#7739">[ thread ]</a>
              <a href="subject.html#7739">[ subject ]</a>
              <a href="author.html#7739">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Have a design question to pass to the list. I've gotten my distributed
app working - pulling snort data from a postgresql database via
twisted's adbapi and handling via xml-rpc - though xml-rpc is screaming
about not being able to serialize postgresql's timestamp format. 

For instance, this query works (using a query test client and a &quot;take
any SQL string in and process it&quot; xmlrpc method on the server local to
database):

# snipped python code setting things up. here's the xmlrpc call:
(answer,) = connection.remote(&quot;fetch&quot;, ('SELECT sid, cid, signature from
event LIMIT 5',))
print answer

prints:

[[1, 1, 1], [1, 2, 2], [1, 3, 1], [1, 4, 3], [1, 5, 1]]

(nice and easy to work with on client side)

but by adding the timestamp to the select query (SELECT sid, cid,
signature, timestamp...), I get the dreaded can't serialize output
error:

Traceback (most recent call last):
  File &quot;x8.py&quot;, line 59, in ?
    (answer,) = connection.remote(&quot;fetch&quot;, ('SELECT sid, cid, signature,
timestamp from event LIMIT 5',))
## some deleted
  File &quot;/usr/lib/python2.3/xmlrpclib.py&quot;, line 742, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: &lt;Fault 8002: &quot;can't serialize output&quot;&gt;


QUESTION: While I think I could build more precise queries on the server
side, e.g. xmlrpc_getAllSIDbyDate and massage timestamp and other
formats before dumping into xmlrpc, this might not be the most elegant
method. It makes every query something both ends have to be recoded for
- not just the client - simply because I can't get timestamp to pass
through XMLRPC. I've tried converting the tuples from the adbapi output
to strings before handing back but that has other issues.

Is this a limitation of XMLRPC that would merit using an approach like
PB instead? Eventually my text client will go the way of a Qt GUI and I
thought XMLRPC would make a nice lightweight distributed interface, but
the serialization issues are making me wonder if the approach is right.

Jamie





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007738.html">[Twisted-Python] When do calls to transport.write() block ?
</A></li>
	<LI>Next message: <A HREF="007740.html">[Twisted-Python] adbapi/postgresql and xml-rpc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7739">[ date ]</a>
              <a href="thread.html#7739">[ thread ]</a>
              <a href="subject.html#7739">[ subject ]</a>
              <a href="author.html#7739">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
