<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] pb.Copyable, round trip objects,	and untrusted clients
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20pb.Copyable%2C%20round%20trip%20objects%2C%0A%09and%20untrusted%20clients&In-Reply-To=%3C20040521044512.GA28968%40vidar.dreamhost.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040352.html">
   <LINK REL="Next"  HREF="040372.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] pb.Copyable, round trip objects,	and untrusted clients</H1>
    <B>David Ripton</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20pb.Copyable%2C%20round%20trip%20objects%2C%0A%09and%20untrusted%20clients&In-Reply-To=%3C20040521044512.GA28968%40vidar.dreamhost.com%3E"
       TITLE="[Twisted-Python] pb.Copyable, round trip objects,	and untrusted clients">dripton at ripton.net
       </A><BR>
    <I>Thu May 20 22:45:12 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040352.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients
</A></li>
        <LI>Next message (by thread): <A HREF="040372.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40367">[ date ]</a>
              <a href="thread.html#40367">[ thread ]</a>
              <a href="subject.html#40367">[ subject ]</a>
              <a href="author.html#40367">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2004.05.20 02:25:20 +0000, Jasper Phillips wrote:
&gt;<i> 
</I>&gt;<i> On Wed, 19 May 2004, David Ripton wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; I'm working on a client-server game, with hidden information, using PB. 
</I>&gt;<i> &gt;   I don't want to trust the clients.
</I>&gt;<i> 
</I>&gt;<i> Titan, I presume?  Nice game!
</I>
Yeah.  I don't have time to maintain 50k lines of Java code, so I need
to rewrite it in 5k lines of Python.  :-&gt;

&gt;<i> I'm working on a game more akin to Civilization or Age of Wonders, but have
</I>&gt;<i> basically the same problem.
</I>
That if the Mongols upgrade early from horsies to tanks, Europe is toast,
but it's hard to make the game dynamic enough to show the Eiffel Yurt?

&gt;<i> &gt; Because there is hidden information, it's important not to send anything 
</I>&gt;<i> &gt; to the client that it's player shouldn't see.  Doing that with PB is 
</I>&gt;<i> &gt; pretty straightforward.  If a class's data is always secret, don't make 
</I>&gt;<i> &gt; it Copyable.  If parts of a class are secret, censor them in getStateToCopy.
</I>&gt;<i> 
</I>&gt;<i> For me this was more complex, as what a Player knows is itself a true part
</I>&gt;<i> of the Game's State, potentially affecting Action/Event resolution.  I end
</I>&gt;<i> up calculating each Players state myself, and passing them explictly.
</I>
What happens if players conspire to share their secret information offline?
Is it okay if someone knows stuff but doesn't Officially Know it, or
does the whole game tend to fall over in the face of such weenie behavior?

If B, you've got a hard ceiling to the amount of security you can
program in, which is both annoying and refreshing (I don't need to fix 
this extremely theoretical security flaw, because there's a much larger 
one I can never fix.  It's like a security variant of Amdahl's Law.  If
your company insists on running Exchange, at least you don't need to worry 
about triply-redundant power supplies on the mail server.)

&gt;<i> Plus this feels to me more like it should be part of the game itself, rather
</I>&gt;<i> than some oblique networking aspect.  Same end effect though.
</I>
I've decided to have the server and each client save the action stream
it's seen, which is somewhat similar.  I have code in the previous
version of this game to deduce and predict which stack hidden enemy 
units are in based on partial information.  But the AI isn't smart
enough to worry about what other players know, only what it knows, so
this is essentially local information.  I don't consider it part of the
server's game model.  (Maybe I should, from an everything-in-one-place
perspective.  It would make it easier to persist this information
rather than recompute it.)

Why is what other players know an important part of your game state?
The exact extents of other players' knowledge can't be public, so nobody
but the server can really use this information, right?  What does the
server do with it?  I guess it's useful for diplomacy, if you allow
bartering information.

&gt;<i> &gt; Obviously, the client should only be able to change the server's game 
</I>&gt;<i> &gt; state via a well-defined error-checked interface.  Also fairly 
</I>&gt;<i> &gt; straightforward, though error-prone since you need to forsee and test 
</I>&gt;<i> &gt; against every way to cheat.
</I>&gt;<i> 
</I>&gt;<i> IMHO handling this can avoid the 3rd problem you mention.  I have Players
</I>&gt;<i> send Actions for a given Turn as the only API to change Game State.  These
</I>&gt;<i> actions don't take game object as args, but rather Ids as you suggest below.
</I>
I'm now back to wanting to do that in both directions.  Except using
strings instead of object IDs, since the parallel objects on the client 
and server will be distinct.  (But they will use the same class, which
is key to maintainability.  When you find yourself writing ClientGame
and ServerGame, scream until the urge passes, then decouple the concept
from its context until the need is gone.)

&gt;<i> I do send actual objects from the Game to Players, but IMHO this is a bit
</I>&gt;<i> error prone lest you accidentally leave in secret info.  I only do it so
</I>&gt;<i> that the clients can validate actions they plan sending against their
</I>&gt;<i> perceived State using the same mechanism as the Game.
</I>
I want to make it symmetrical, so I want to build the client-side model
objects using the action stream, rather than copying them directly.  It
will be painfully boring, but I don't have *that* many actions, and
they're fully documented from last time I decided to go this way.

&gt;<i> IMHO it seems superflous to have the game update the information a client
</I>&gt;<i> sends, only to later access this same information for calculations.  Why not
</I>&gt;<i> just pass back the relavent Ids, and have the Game API look up their True
</I>&gt;<i> counterpart as needed?  This doesn't seem onerous to me.
</I>
I wanted a way to bury this detail inside the framework, but it's not
currently practical so I'm flipping completely the other way.  I'd forgotten
how badly I want the ability to fast-forward and rewind through game history
by applying and undoing actions.  (Lets the AI free-run while giving the
ability to watch it as if it were moving more slowly.  Also lets you
review other people's savegames to pick up strategy hints.)

-- 
David Ripton    <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dripton at ripton.net</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040352.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients
</A></li>
	<LI>Next message (by thread): <A HREF="040372.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40367">[ date ]</a>
              <a href="thread.html#40367">[ thread ]</a>
              <a href="subject.html#40367">[ subject ]</a>
              <a href="author.html#40367">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
