<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] A problem with runUntilCurrent
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20A%20problem%20with%20runUntilCurrent&In-Reply-To=20040517150438.56987.qmail%40web8307.mail.in.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007804.html">
   <LINK REL="Next"  HREF="007806.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] A problem with runUntilCurrent</H1>
    <B>Phillip J. Eby</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20A%20problem%20with%20runUntilCurrent&In-Reply-To=20040517150438.56987.qmail%40web8307.mail.in.yahoo.com"
       TITLE="[Twisted-Python] A problem with runUntilCurrent">pje at telecommunity.com
       </A><BR>
    <I>Mon May 17 11:46:35 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007804.html">[Twisted-Python] A problem with runUntilCurrent
</A></li>
        <LI>Next message: <A HREF="007806.html">[Twisted-Python] A problem with runUntilCurrent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7805">[ date ]</a>
              <a href="thread.html#7805">[ thread ]</a>
              <a href="subject.html#7805">[ subject ]</a>
              <a href="author.html#7805">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>At 04:04 PM 5/17/04 +0100, Bill la Forge wrote:
&gt;<i>Itamar,
</I>&gt;<i>
</I>&gt;<i>This is also problematic. What this code does is limit the number of
</I>&gt;<i>calls that will be made by runUntilCurrent. However, if there's code
</I>&gt;<i>that does a callLater with a delay of 0, it will always execute that.
</I>
What I don't understand is why that should be the case.  A delay of zero 
should equal the *current time* plus zero.  The 'now' variable, however, is 
fixed at the time when 'runUntilCurrent()' is called.  Therefore, as soon 
as any time has elapsed (i.e. time() advances one quantum), a newly 
scheduled callLater(0,) must be scheduled for a time that is *after* 'now', 
and therefore ineligible for call within the loop.

(I'm particularly puzzled, therefore, by the part of Itamar's patch that 
sets the scheduled time to zero for callLater(0,).)

The real problem here, if any, is likely the use of a low-resolution time() 
value.  On Windows, for example, the tick granularity is like 1/18th of a 
second, so a callLater(0,) loop will consume a huge amount of time.  On 
Windows, a scheduler should probably use the high-res clock() rather than 
the low-res time() in order to work around this, which will ensure that 
nothing scheduled during a 'runUntilCurrent()' call will be executed until 
the *next* 'runUntilCurrent()' call.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007804.html">[Twisted-Python] A problem with runUntilCurrent
</A></li>
	<LI>Next message: <A HREF="007806.html">[Twisted-Python] A problem with runUntilCurrent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7805">[ date ]</a>
              <a href="thread.html#7805">[ thread ]</a>
              <a href="subject.html#7805">[ subject ]</a>
              <a href="author.html#7805">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
