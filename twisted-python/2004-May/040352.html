<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20pb.Copyable%2C%20round%20trip%20objects%2C%09and%20untrusted%0A%09clients&In-Reply-To=%3CPine.LNX.4.53.0405200204510.7527%40a.shell.peak.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040370.html">
   <LINK REL="Next"  HREF="040367.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients</H1>
    <B>Jasper Phillips</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20pb.Copyable%2C%20round%20trip%20objects%2C%09and%20untrusted%0A%09clients&In-Reply-To=%3CPine.LNX.4.53.0405200204510.7527%40a.shell.peak.org%3E"
       TITLE="[Twisted-Python] pb.Copyable, round trip objects,	and untrusted	clients">jasper at peak.org
       </A><BR>
    <I>Thu May 20 03:25:20 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040370.html">[Twisted-Python] pb.Copyable, round trip objects, and	untrusted	clients
</A></li>
        <LI>Next message (by thread): <A HREF="040367.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40352">[ date ]</a>
              <a href="thread.html#40352">[ thread ]</a>
              <a href="subject.html#40352">[ subject ]</a>
              <a href="author.html#40352">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Wed, 19 May 2004, David Ripton wrote:

&gt;<i> I'm working on a client-server game, with hidden information, using PB. 
</I>&gt;<i>   I don't want to trust the clients.
</I>
Titan, I presume?  Nice game!

I'm working on a game more akin to Civilization or Age of Wonders, but have
basically the same problem.


&gt;<i> Because there is hidden information, it's important not to send anything 
</I>&gt;<i> to the client that it's player shouldn't see.  Doing that with PB is 
</I>&gt;<i> pretty straightforward.  If a class's data is always secret, don't make 
</I>&gt;<i> it Copyable.  If parts of a class are secret, censor them in getStateToCopy.
</I>
For me this was more complex, as what a Player knows is itself a true part
of the Game's State, potentially affecting Action/Event resolution.  I end
up calculating each Players state myself, and passing them explictly.

Plus this feels to me more like it should be part of the game itself, rather
than some oblique networking aspect.  Same end effect though.


&gt;<i> Obviously, the client should only be able to change the server's game 
</I>&gt;<i> state via a well-defined error-checked interface.  Also fairly 
</I>&gt;<i> straightforward, though error-prone since you need to forsee and test 
</I>&gt;<i> against every way to cheat.
</I>
IMHO handling this can avoid the 3rd problem you mention.  I have Players
send Actions for a given Turn as the only API to change Game State.  These
actions don't take game object as args, but rather Ids as you suggest below.

I do send actual objects from the Game to Players, but IMHO this is a bit
error prone lest you accidentally leave in secret info.  I only do it so
that the clients can validate actions they plan sending against their
perceived State using the same mechanism as the Game.


&gt;<i> There's a third hole to plug, which is passing an object from the server 
</I>&gt;<i> to the client as an argument of a client-side remote_* method, and later 
</I>&gt;<i> getting it back as an argument to a server-side perspective_* method. 
</I>&gt;<i> (e.g. the server passes the client a list of games in progress, and 
</I>&gt;<i> later the client passes back the game it wants to join.)  If the client 
</I>&gt;<i> changes the object before passing it back, it might trick the server 
</I>&gt;<i> into doing the wrong thing with it.
</I>&gt;<i> 
</I>&gt;<i> Anyway, it seems easy enough to avoid this problem, by just rewinding 
</I>&gt;<i> any changes the client has made to such objects.  At some point before 
</I>&gt;<i> sending an object to the client side, add it to a dict, keyed by its id. 
</I>&gt;<i>   When an object comes back from the client as an argument in a 
</I>&gt;<i> perspective_* call, use its id to lookup the server's copy of the object 
</I>&gt;<i> in the dict, and then reassign the current name to the good version of 
</I>&gt;<i> the object, losing any changes the client may have made.  In other 
</I>&gt;<i> words, the client is treated as if it only passed the object's id back, 
</I>&gt;<i> not its __dict__.  But the interface is simpler.
</I>
IMHO it seems superflous to have the game update the information a client
sends, only to later access this same information for calculations.  Why not
just pass back the relavent Ids, and have the Game API look up their True
counterpart as needed?  This doesn't seem onerous to me.

-Jasper



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040370.html">[Twisted-Python] pb.Copyable, round trip objects, and	untrusted	clients
</A></li>
	<LI>Next message (by thread): <A HREF="040367.html">[Twisted-Python] pb.Copyable, round trip objects,	and untrusted clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40352">[ date ]</a>
              <a href="thread.html#40352">[ thread ]</a>
              <a href="subject.html#40352">[ subject ]</a>
              <a href="author.html#40352">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
