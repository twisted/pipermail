<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] bsddb?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20bsddb%3F&In-Reply-To=%3C20040514122708.86658.qmail%40web8310.mail.in.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040259.html">
   <LINK REL="Next"  HREF="040261.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] bsddb?</H1>
    <B>Bill la Forge</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20bsddb%3F&In-Reply-To=%3C20040514122708.86658.qmail%40web8310.mail.in.yahoo.com%3E"
       TITLE="[Twisted-Python] bsddb?">laforge49 at yahoo.co.in
       </A><BR>
    <I>Fri May 14 06:27:08 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040259.html">[Twisted-Python] bsddb?
</A></li>
        <LI>Next message (by thread): <A HREF="040261.html">[Twisted-Python] bsddb?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40260">[ date ]</a>
              <a href="thread.html#40260">[ thread ]</a>
              <a href="subject.html#40260">[ subject ]</a>
              <a href="author.html#40260">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>But it blocks, mm?
 
I could break things into small chuncks, so I could likely get away with
not using a thread. But shouldn't it ideally be accessed from a thread?
 
I'll note that you can open bsddb (using the new interface, not the
one documented in Python) in a thread-safe way, but any given iteration
(using a cursor object) must be done from a single thread--cursors
are not thread-free.
 
One approach might be to create a cursor in a server thread and then
use a fixed-size queue to retrieve the iterations, but then you'll need
at least as many server threads as you have open cursors.
 
So the best approach might be to have a cursor manager which handles
many such cursors/queues running on a single thread. (Invoking the
manager, it returns a master queue for handling subsequent requests.)
But then it sounds like a dedicated thread is again the best approach.
 
It seems to me that a nice general solution would be a project in its own 
right. (I've found bsddb to be pretty powerful/useful/fast/handy.)
 
Ah, Atop looks interesting. Thanks!
 
Bill

Matt Goodall &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">matt at pollenation.net</A>&gt; wrote:
On Fri, 2004-05-14 at 08:17, Bill la Forge wrote:
&gt;<i> New to twisted, interested in porting a project, but I can't find
</I>&gt;<i> anything on using bsddb.
</I>
Open a bdb at the start of the app, use it as necessary, close the bdb
at the end of the app. What could be easier ;-).

It's probably worth creating a Service
(<A HREF="http://twistedmatrix.com/documents/current/api/">http://twistedmatrix.com/documents/current/api/</A>) to help manage the
bsddb resource.

&gt;<i> I assume I need a dedicated thread. Has anyone else worked on this?
</I>
You probably only need a thread for operations that you know will take a
long time. Retrieving a single, keyed object should be so quick with
bsdbd that it's probably not with the effort/expense of a thread. On the
other hand, iterating an entire bdb will (possibly) take quite some
time, so a thread may be a good idea. (Note that Python's bsdbd is not
threadsafe so you will have to manage that yourself.)

I don't know enough about the bsddb api but I suspect it's possible to
avoid threads altogether by iterating an entire bdb in small chunks and
relinquishing control to the event loop at the end of each chunk to
allow other events to run.

&gt;<i> (I did a web search, but couldn't relate what I found to any code in
</I>&gt;<i> the 1.2 release I just downloaded. I also read the May list archive.)
</I>
You may find Atop (<A HREF="http://www.divmod.org/Home/Projects/Atop/index.html">http://www.divmod.org/Home/Projects/Atop/index.html</A>)
interesting.

Hope this helps.

Cheers, Matt

-- 
__
/ \__ Matt Goodall, Pollenation Internet Ltd
\__/ \ w: <A HREF="http://www.pollenation.net">http://www.pollenation.net</A>
__/ \__/ e: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">matt at pollenation.net</A>
/ \__/ \ t: +44 (0)113 2252500
\__/ \__/
/ \ Any views expressed are my own and do not necessarily
\__/ reflect the views of my employer.


_______________________________________________
Twisted-Python mailing list
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>

Bill la Forge
<A HREF="http://www.geocities.com/laforge49/">http://www.geocities.com/laforge49/</A>
Yahoo! India Matrimony: Find your partner online.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20040514/63bc01b3/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040259.html">[Twisted-Python] bsddb?
</A></li>
	<LI>Next message (by thread): <A HREF="040261.html">[Twisted-Python] bsddb?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40260">[ date ]</a>
              <a href="thread.html#40260">[ thread ]</a>
              <a href="subject.html#40260">[ subject ]</a>
              <a href="author.html#40260">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
