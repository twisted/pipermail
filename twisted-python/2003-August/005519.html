<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Deferred database transaction confusion
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Deferred%20database%20transaction%20confusion&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005542.html">
   <LINK REL="Next"  HREF="005520.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Deferred database transaction confusion</H1>
    <B>Lucas Taylor</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Deferred%20database%20transaction%20confusion&In-Reply-To="
       TITLE="[Twisted-Python] Deferred database transaction confusion">lucas at lucaserve.com
       </A><BR>
    <I>Wed Aug 13 06:04:17 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005542.html">[Twisted-Python] Support for ICMP / traceroute ?
</A></li>
        <LI>Next message: <A HREF="005520.html">[Twisted-Python] Deferred database transaction confusion
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5519">[ date ]</a>
              <a href="thread.html#5519">[ thread ]</a>
              <a href="subject.html#5519">[ subject ]</a>
              <a href="author.html#5519">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings!

I'm trying to figure out the best way to accomplish database
transactions and I haven't quite got my head wrapped around deferreds
and the adbapi. I'm hoping someone can nudge me in the right direction.

Basically, we have simple terminals that communicate over dialup lines
to a host server. The host server essentially handles the modem
negotiation and passes everything else through to our Twisted server. We
process the transaction and return the result to the client, and the
protocol specifies an ACK is to be returned on successful receipt. So
I've got a dictionary of transport.sessionnos which hold the ACK state
of the connection. Once the terminal has ACKed the host server, it
passes that along to the Twisted server and drops the connection. On
connectionLost I lookup the ACK value of the connection to make sure the
terminal rx'd the data and then I should be able to commit or rollback
any pending db transactions.

Now here's where I'm stuck. I've got a rudimentary idea of how I will be
chaining callbacks to the deferred results of my db interactions, and
once complete the data will be sent to the terminal. And the registered
errbacks need to be able to rollback if necessary. But how do I get the
protocol handler to access the database connection to issue the
commit/rollback?

btw, thanks to the developers for making my project so incredibly
'do-able'. It's really quite cool - I was able to demo a proof of
concept in an evening after downloading Twisted. The protocol handling
was so easy to setup for what we needed that it was silly.


Thanks,

Lucas Taylor



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005542.html">[Twisted-Python] Support for ICMP / traceroute ?
</A></li>
	<LI>Next message: <A HREF="005520.html">[Twisted-Python] Deferred database transaction confusion
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5519">[ date ]</a>
              <a href="thread.html#5519">[ thread ]</a>
              <a href="subject.html#5519">[ subject ]</a>
              <a href="author.html#5519">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
