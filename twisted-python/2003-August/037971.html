<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted Style
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20Style&In-Reply-To=%3CPine.BSO.4.44.0308091637310.32656-100000%40cyclops4.esentire.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037976.html">
   <LINK REL="Next"  HREF="037972.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted Style</H1>
    <B>Edmund Dengler</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20Style&In-Reply-To=%3CPine.BSO.4.44.0308091637310.32656-100000%40cyclops4.esentire.com%3E"
       TITLE="[Twisted-Python] Twisted Style">edmundd at eSentire.com
       </A><BR>
    <I>Sat Aug  9 14:57:06 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037976.html">[Twisted-Python] SQL, Threaded, and flows
</A></li>
        <LI>Next message (by thread): <A HREF="037972.html">[Twisted-Python] Revisiting sessions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37971">[ date ]</a>
              <a href="thread.html#37971">[ thread ]</a>
              <a href="subject.html#37971">[ subject ]</a>
              <a href="author.html#37971">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all!

The Twisted stuff looks very good, and I think I am getting my head around
to the way it works. I am looking for how I should be approaching a basic
problem, and how to cast it in the Twisted model.

Basically, I have a client transferring database rows to a server. I would
like to transfer each row one-at-a-time, and I need information coming
back to know whether the transfer was successful and to record in the
client's database.

I have tried the following (please note that the code has been stripped
to show the essence):

Server (using PB)
-----------------

Has a Perspective:

class MyPerspective(pb.Perspective):
    def attached(self, clientref, identity):
        ...

    def attached(self, ref, identity):
        ...

    def perspective_transferXXX(self, XXX):
        ...

...create an app and a service...
...create appropriate perspective and identity things...
...listen at a socket...


Client (1)
----------

class TransferClient:
    def __init__(self):

    def go(self):
        ...connect to server, defer to connection()...

    def connection(self, perspective):
        # Connection to server has been made
        ...save away perspective...
        self.transferCycle()

    def transferCycle(self):
        # Start a whole cycle (each cycle may transfer multiple rows)
        self.transferXXXs()

    def getXXXs(self):
        # Lets get the data to transfer
        ...setup database query, defer result set to transferXXXs()...

    def transferXXXs(self, XXXs):
        # We have our data from the query
        ...save away some state information...
        self.transferXXX(...first row...)

    def transferXXX(self, XXX):
        # Transfer a single row
        ...call remote perspective for XXX, defer return to doneXXX()...

    def doneXXX(self, result):
        # The row has been transferred and returned a result
        if successfully transferred:
            ...do appropriate work...
        if we still need to transfer more rows:
            self.transferXXX(...with the next row...)
        else:
            self.cycleDone()
            # Note: if we had other stuff, we would start them
            # transferring as well

    def cycleDone(self):
        # We have done a single cycle of transfers
        ...put a deferred for YYY seconds to start the cycle again...


Now, this seems like an awful lot of methods simply to support deferred
execution. Is there a way to use flows to acheive this? I have looked at
the HowTo pages, but it is not clear how to use the Flow components within
a PB model. Is there another approach?

Regards!
Ed





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037976.html">[Twisted-Python] SQL, Threaded, and flows
</A></li>
	<LI>Next message (by thread): <A HREF="037972.html">[Twisted-Python] Revisiting sessions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37971">[ date ]</a>
              <a href="thread.html#37971">[ thread ]</a>
              <a href="subject.html#37971">[ subject ]</a>
              <a href="author.html#37971">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
