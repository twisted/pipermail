<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted sure is Twisted :)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20sure%20is%20Twisted%20%3A%29&In-Reply-To=5.1.0.14.2.20030830040248.00b59830%40pop.telusplanet.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005646.html">
   <LINK REL="Next"  HREF="005648.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted sure is Twisted :)</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20sure%20is%20Twisted%20%3A%29&In-Reply-To=5.1.0.14.2.20030830040248.00b59830%40pop.telusplanet.net"
       TITLE="[Twisted-Python] Twisted sure is Twisted :)">andrew-twisted at puzzling.org
       </A><BR>
    <I>Sat Aug 30 21:53:35 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005646.html">[Twisted-Python] Twisted sure is Twisted :)
</A></li>
        <LI>Next message: <A HREF="005648.html">[Twisted-Python] error in pollreactor.py
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5647">[ date ]</a>
              <a href="thread.html#5647">[ thread ]</a>
              <a href="subject.html#5647">[ subject ]</a>
              <a href="author.html#5647">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Aug 30, 2003 at 04:34:58AM -0600, John Janecek wrote:
&gt;<i> Twisted once u get a grip on it sure is pretty impressive.
</I>&gt;<i> I used twisted to forward UDP packets as a relay. Take one
</I>&gt;<i> UDP packet and then retrans it to many other clients. On
</I>&gt;<i> a FreeBSD box P3 750 the delay in retrans on packet to
</I>&gt;<i> like 5 clients was less then 1ms which was very impressive.
</I>&gt;<i> 
</I>&gt;<i> In using twisted i know the reactor is broken in wxpython.
</I>&gt;<i> 
</I>&gt;<i> What would happen if u ran a normal reactor in a seperate thread,
</I>&gt;<i> and then passed the info from twisted into wxpython using an event
</I>&gt;<i> handler similar to the wxpython thread demo ??
</I>
You could use reactor.callInThread(myWxMainLoop), I guess -- but last time I
looked at wxpython, it *had* to be run in the main thread, so this might get
slightly messy (I'm pretty sure the Twisted reactor doesn't mind being run
in a non-main thread, so this shouldn't be insurmountable).  Of course, it's
been quite a while since I've used wxpython, so this might not be an issue
anymore.

&gt;<i> The only problem with that is i can not see how u would pass info
</I>&gt;<i> from wxpython back into twisted. Hmmmm maybe if u made a queue,
</I>
Just use reactor.callFromThread -- a thread can call this to safely schedule a
function to be run in the main event loop.  See
<A HREF="http://twistedmatrix.com/documents/howto/threading.">http://twistedmatrix.com/documents/howto/threading.</A>  

&gt;<i> The idea behind deferred is intresting. The defered call back does not
</I>&gt;<i> seem to fire until it is added. How the heck does that work ? I am
</I>&gt;<i> refering to the database example. Hmmmm not really important but kinda
</I>&gt;<i> neat.
</I>
Deferred callbacks obviously can't fire until they're added to the deferred,
but of course they might not fire immediately upon addCallback, though --
because the deferred might not have been called yet.

&gt;<i> def getAge(user):
</I>&gt;<i>     return dbpool.runQuery(&quot;SELECT age FROM users WHERE name = ?&quot;, user)
</I>&gt;<i> 
</I>&gt;<i> def printResult(l):
</I>&gt;<i>     if l:
</I>&gt;<i>         print l[0][0], &quot;years old&quot;
</I>&gt;<i>     else:
</I>&gt;<i>         print &quot;No such user&quot;
</I>&gt;<i> 
</I>&gt;<i> d=getAge(&quot;joe&quot;)
</I>&gt;<i> d.addCallback(printResult)
</I>&gt;<i> 
</I>&gt;<i> like here d is the function getAge. My gut instict tell me the moment I
</I>
No, here 'd' is a deferred result from the function 'getAge'.  A deferred is
simply an object that represents a result that probably hasn't arrived yet.

&gt;<i> call getAge the database query should be run. But yet it is not run till u
</I>&gt;<i> add the callback.  and if i add an errorback after it, it is not run till
</I>&gt;<i> it has been added also, I can not see how it works :)). Hmmmm must be part
</I>&gt;<i> of the magic :))
</I>
So, in this case, dbpool.runQuery ducks off and runs the database query in a
thread behind the scenes, and returns immediately without waiting for the
result to arrive -- because databases can take an arbitrarily long time to
return a result.  In the meantime, the code that called runQuery can add
callbacks and errbacks to the deferred result from runQuery, and the
deferred will see to it that those are run when the result does arrive (if
the result has already arrived by the time you add a callback, it will be
run immediately).

The running of the callback is completely independent to the running of the
query.  If you never add any callbacks or errbacks and just discard the
deferred from dbpool.runQuery immediately, the query is still run on the
database -- it's just that when the twisted.enterprise.adbapi code gets the
result back from the database, it will fire the deferred (using
Deferred.callback or Deferred.errback), and the deferred will find it has no
callbacks to trigger, which is fine.

If you haven't already, read <A HREF="http://twistedmatrix.com/documents/howto/defer.">http://twistedmatrix.com/documents/howto/defer.</A>

[...]
&gt;<i> Anyway this is the crap i ramble off at 4 am :)
</I>&gt;<i> Just basically wanted to say twisted is cool.
</I>
Thanks!  :)

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005646.html">[Twisted-Python] Twisted sure is Twisted :)
</A></li>
	<LI>Next message: <A HREF="005648.html">[Twisted-Python] error in pollreactor.py
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5647">[ date ]</a>
              <a href="thread.html#5647">[ thread ]</a>
              <a href="subject.html#5647">[ subject ]</a>
              <a href="author.html#5647">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
