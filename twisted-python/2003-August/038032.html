<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Deferred database transaction confusion
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Deferred%20database%20transaction%20confusion&In-Reply-To=%3C01e901c361be%24de0e1050%240201a8c0%40lucas2k%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="038028.html">
   <LINK REL="Next"  HREF="038033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Deferred database transaction confusion</H1>
    <B>Lucas Taylor</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Deferred%20database%20transaction%20confusion&In-Reply-To=%3C01e901c361be%24de0e1050%240201a8c0%40lucas2k%3E"
       TITLE="[Twisted-Python] Deferred database transaction confusion">lucas at lucaserve.com
       </A><BR>
    <I>Wed Aug 13 11:18:07 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="038028.html">[Twisted-Python] Deferred database transaction confusion
</A></li>
        <LI>Next message (by thread): <A HREF="038033.html">[Twisted-Python] Deferred database transaction confusion
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38032">[ date ]</a>
              <a href="thread.html#38032">[ thread ]</a>
              <a href="subject.html#38032">[ subject ]</a>
              <a href="author.html#38032">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK, I receive a response from my interaction, and it will have been
committed if no exceptions occurred. Does this mean I have no way of
controlling the commit/rollback behavior? How would you wrap a series of
transactions that relied on each other?
Say I have a series of db work that needs to be done, like:

selectCustomer
(do some work)
updateCustomer
updateBalance
(do some more work)
insertTxTable

Ignoring the fact that I don't want to commit any of these transactions
until I rx a response from the client, how would I treat these as
atomic? I don't want the updates to actually commit until the insert is
complete into the TxTable. I guess I could move a lot of the logic to a
single stored procedure if it's going to be committed on execution
before the client actually receives the results. But that's no fun.

Maybe what I'll have to do is keep track of every db update/insert and
have corresponding balancing procedures so that I can do a manual
rollback

Thanks,

Lucas Taylor


----- Original Message -----
From: &quot;Itamar Shtull-Trauring&quot; &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">itamar at itamarst.org</A>&gt;
To: &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&gt;
Sent: Wednesday, August 13, 2003 5:23 AM
Subject: Re: [Twisted-Python] Deferred database transaction confusion


&gt;<i>
</I>&gt;<i> You don't. The commit/rollback happens before the Deferred's callbacks
</I>&gt;<i> get called. In fact, the commit/rollback are done for you
</I>automatically
&gt;<i> - if you runInteraction the operations you did will be committed if
</I>they
&gt;<i> succeeded or rolled back if an exception was raised in the interaction
</I>&gt;<i> function.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Itamar Shtull-Trauring    <A HREF="http://itamarst.org/">http://itamarst.org/</A>
</I>&gt;<i> Available for Python &amp; Twisted consulting
</I>&gt;<i>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="038028.html">[Twisted-Python] Deferred database transaction confusion
</A></li>
	<LI>Next message (by thread): <A HREF="038033.html">[Twisted-Python] Deferred database transaction confusion
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38032">[ date ]</a>
              <a href="thread.html#38032">[ thread ]</a>
              <a href="subject.html#38032">[ subject ]</a>
              <a href="author.html#38032">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
