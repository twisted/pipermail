<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] problems with threadedselectreactor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20problems%20with%20threadedselectreactor&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012069.html">
   <LINK REL="Next"  HREF="012073.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] problems with threadedselectreactor</H1>
    <B>Antony Kummel</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20problems%20with%20threadedselectreactor&In-Reply-To="
       TITLE="[Twisted-Python] problems with threadedselectreactor">antonykummel at yahoo.com
       </A><BR>
    <I>Tue Nov 29 07:15:08 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="012069.html">[Twisted-Python] Re: My review of Abe's book &quot;Twisted	NetworkProgramming Essentials&quot;
</A></li>
        <LI>Next message: <A HREF="012073.html">[Twisted-Python] problems with threadedselectreactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12059">[ date ]</a>
              <a href="thread.html#12059">[ thread ]</a>
              <a href="subject.html#12059">[ subject ]</a>
              <a href="author.html#12059">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi!
  
  I encountered two problems when using threadedselectreactor on win32. I  am not versed enough with reactor technicalities to resolve them  myself, but I would gladly conduct any tests the experts recommend.
  
  1. I often get tracebacks similar to this:
        File  &quot;C:\Python23\Lib\site-packages\twisted\internet\threadedselectreactor.py&quot;,  line 299, in _doReadOrWrite
          why = getattr(selectable, method)()
        File &quot;C:\Python23\Lib\site-packages\twisted\internet\abstract.py&quot;, line 108, in doWrite
          l = self.writeSomeData(self.dataBuffer)
        File &quot;C:\Python23\lib\site-packages\twisted\internet\tcp.py&quot;, line 358, in writeSomeData
          return self.socket.send(buffer(data, 0, self.SEND_LIMIT))
      exceptions.AttributeError: 'Server' object has no attribute 'socket'
  
  To my understanding, this can only happen if the Server's  connectionLost method had been called before the exception happened,  but for some reason, writeSomeData (or sometimes another method) was  still called. I hypothesize that the Server should have been removed  from some list or another but wasn't, and that this is the reactor's  responsibility.
  
  2. Sometimes I get this error:
  Traceback (most recent call last):
    File &quot;C:\Python23\Lib\site-packages\wx-2.6-msw-unicode\wx\_core.py&quot;, line 7493, in MainLoop
      wx.PyApp.MainLoop(self)
    File &quot;C:\Python23\Lib\site-packages\wx-2.6-msw-unicode\wx\_core.py&quot;, line 6926, in MainLoop
      return _core_.PyApp_MainLoop(*args, **kwargs)
    File &quot;C:\Python23\Lib\site-packages\wx-2.6-msw-unicode\wx\_core.py&quot;, line 13266, in &lt;lambda&gt;
      lambda event: event.callable(*event.args, **event.kw) )
    File &quot;C:\Python23\Lib\site-packages\twisted\internet\threadedselectreactor.py&quot;, line 241, in _interleave
      self.runUntilCurrent()
  --- &lt;exception caught here&gt; ---
    File &quot;C:\Python23\Lib\site-packages\twisted\internet\base.py&quot;, line 541, in runUntilCurrent
      call.func(*call.args, **call.kw)
    File &quot;C:\Python23\Lib\site-packages\twisted\internet\task.py&quot;, line 91, in __call__
      self._reschedule()
    File &quot;C:\Python23\Lib\site-packages\twisted\internet\task.py&quot;, line 108, in _reschedule
      self.call = reactor.callLater(delay, self)
    File &quot;C:\Python23\Lib\site-packages\twisted\internet\threadedselectreactor.py&quot;, line 116, in callLater
      self.wakeUp()
    File &quot;C:\Python23\Lib\site-packages\twisted\internet\threadedselectreactor.py&quot;, line 112, in wakeUp
      self.waker.wakeUp()
    File &quot;C:\Python23\Lib\site-packages\twisted\internet\posixbase.py&quot;, line 85, in wakeUp
      self.w.send('x')
  socket.error: (10055, 'No buffer space available')
  
  This doesn't seem to be a threadedselectreactor problem, but rather a  problem that stems from it's use with arbitrary event loops. I suspect  that it happens when the main thread doesn't respond for some time. I  think that the best way to deal with it is simply to ignore this error  (in wakeUp), because if the buffer is full, then the main thread  already knows (or about to find out) that it needs to wake up, although  maybe the user should be somehow notified that there is a problem (log  message?).
  
  Thanks,
  
  Antony Kummel
  

		
---------------------------------
 Yahoo! Personals
 Single? There's someone we'd like you to meet.
 Lots of someones, actually. Yahoo! Personals
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20051129/96310b5b/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20051129/96310b5b/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012069.html">[Twisted-Python] Re: My review of Abe's book &quot;Twisted	NetworkProgramming Essentials&quot;
</A></li>
	<LI>Next message: <A HREF="012073.html">[Twisted-Python] problems with threadedselectreactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12059">[ date ]</a>
              <a href="thread.html#12059">[ thread ]</a>
              <a href="subject.html#12059">[ subject ]</a>
              <a href="author.html#12059">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
