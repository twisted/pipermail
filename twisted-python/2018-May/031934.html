<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Python 3: Odd failure to print unhandled error tb
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Python%203%3A%20Odd%20failure%20to%20print%20unhandled%20error%20tb&In-Reply-To=%3C20180531050408.GA8999%40arch-tinker.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="064394.html">
   <LINK REL="Next"  HREF="064396.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Python 3: Odd failure to print unhandled error tb</H1>
    <B>Jason Litzinger</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Python%203%3A%20Odd%20failure%20to%20print%20unhandled%20error%20tb&In-Reply-To=%3C20180531050408.GA8999%40arch-tinker.localdomain%3E"
       TITLE="[Twisted-Python] Python 3: Odd failure to print unhandled error tb">jlitzingerdev at gmail.com
       </A><BR>
    <I>Wed May 30 23:04:08 MDT 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="064394.html">[Twisted-Python] (no subject)
</A></li>
        <LI>Next message (by thread): <A HREF="064396.html">[Twisted-Python] Python 3: Odd failure to print unhandled error tb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31934">[ date ]</a>
              <a href="thread.html#31934">[ thread ]</a>
              <a href="subject.html#31934">[ subject ]</a>
              <a href="author.html#31934">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been looking at cleaning up cases where a traceback isn't printed
for deferreds with an unhandled error, and there is one strange case I'm
hoping someone might have thoughts about*.  For reference, some of this is part
of 7927 and related tickets.

Consider:
from __future__ import print_function

import sys

from twisted.internet import reactor, defer
from twisted.logger import (
    globalLogBeginner,
    textFileLogObserver,
)

def raiseException(res):
    raise Exception(&quot;I am a traceback!&quot;)


if sys.argv[1] == '1':
    globalLogBeginner.beginLoggingTo([textFileLogObserver(sys.stdout)])
    d = defer.Deferred()
    d.addCallback(raiseException)
    d.callback(None)
elif sys.argv[1] == '2':
    globalLogBeginner.beginLoggingTo([textFileLogObserver(sys.stdout)])
    def go():
        d = defer.Deferred()
        d.addCallback(raiseException)
        d.callback(None)

    go()
elif sys.argv[1] == '3':
    globalLogBeginner.beginLoggingTo([textFileLogObserver(sys.stdout)])
    def go2():
        d = defer.Deferred()
        d.addCallback(raiseException)
        d.callback(None)
        reactor.stop()

    reactor.callWhenRunning(go2)
    reactor.run()

For '1' above, nothing will be printed for python3, python2 is fine.
All other cases print a traceback as expected.  While case 1 isn't
necessarily not a &quot;normal&quot; case of twisted usage, but it is a 
short and clear way to demonstrate the logger that has at least a few
examples:

<A HREF="https://twistedmatrix.com/trac/ticket/7927">https://twistedmatrix.com/trac/ticket/7927</A> (original description)
<A HREF="https://twistedmatrix.com/pipermail/twisted-python/2018-May/031922.html">https://twistedmatrix.com/pipermail/twisted-python/2018-May/031922.html</A>

After a little debugging, I did see a few places where an exception
complaining about sys.meta path being none and the interpreter
shutting down, but I'm not confident enough in my tests to know whether
that wasn't triggered by me.

Any thoughts on why no traceback is printed for case 1?  Is it even
worth worrying about?

Thanks,
-Jason Litzinger

* Tested with Python 3.6 on Arch Linux, Python 3.5.2 on ubuntu

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="064394.html">[Twisted-Python] (no subject)
</A></li>
	<LI>Next message (by thread): <A HREF="064396.html">[Twisted-Python] Python 3: Odd failure to print unhandled error tb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31934">[ date ]</a>
              <a href="thread.html#31934">[ thread ]</a>
              <a href="subject.html#31934">[ subject ]</a>
              <a href="author.html#31934">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
