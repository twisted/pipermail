<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Subproject releases
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Subproject%20releases&In-Reply-To=%3C1129680205.31353.10.camel%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="044200.html">
   <LINK REL="Next"  HREF="044210.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Subproject releases</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Subproject%20releases&In-Reply-To=%3C1129680205.31353.10.camel%40localhost.localdomain%3E"
       TITLE="[Twisted-Python] Subproject releases">glyph at divmod.com
       </A><BR>
    <I>Tue Oct 18 18:03:25 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="044200.html">[Twisted-Python] Subproject releases
</A></li>
        <LI>Next message (by thread): <A HREF="044210.html">[Twisted-Python] Subproject releases
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44209">[ date ]</a>
              <a href="thread.html#44209">[ thread ]</a>
              <a href="subject.html#44209">[ subject ]</a>
              <a href="author.html#44209">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2005-10-18 at 00:04 -0400, James Y Knight wrote:
&gt;<i> On Oct 12, 2005, at 10:29 PM, Glyph Lefkowitz wrote:
</I>&gt;<i> &gt; Hmm.  Trial interaction is something I haven't messed with yet; I
</I>&gt;<i> &gt; haven't put trial directory below a __path__ entry.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Arguably this is simply a bug in Trial that should be fixed, though.
</I>
[snip explanation]

&gt;<i> So, my solution:
</I>&gt;<i> I changed the recursive process to actually import every package (not  
</I>&gt;<i> every module!), so it can use the package's __path__ attribute to  
</I>&gt;<i> find submodules. This works, mostly.
</I>
Well, thanks for fixing that bug :).  Is there any issue for this
somewhere already, before I file one?

&gt;<i> One issue is that it causes trial to emit an import error message  
</I>&gt;<i> from trying to import twisted.internet.iocpreactor and  
</I>&gt;<i> twisted.internet.serialport (because they aren't importable on my  
</I>&gt;<i> system). This is necessary -- trial does not know they don't have a  
</I>&gt;<i> __path__ attribute before importing them, so it has no way of telling  
</I>&gt;<i> that they don't have test modules hidden inside. It would similarly  
</I>&gt;<i> be a bad idea to simply ignore all import errors of packages, as then  
</I>&gt;<i> real errors may be silenced. This could be simply solvable via a  
</I>&gt;<i> special attribute like &quot;no_tests_in_packages= ['iocpreactor',  
</I>&gt;<i> 'serialport']&quot; to twisted/internet/__init__ so trial knows not to  
</I>&gt;<i> bother trying to import those.
</I>
That sounds like a good solution to an unfortunate problem.  I notice
that the practice used in iocp and serialport is standardized in the
coding standard (and I probably put it there); is there *any* better way
to do module-level promotions?  Really the way things like that should
work should be a __getattr__ on the module or something, so that you
don't do unnecessary imports.

&gt;<i> The other issue is that test files expecting to be imported as  
</I>&gt;<i> modules _still_ won't work if specified by filename. But, I think  
</I>&gt;<i> that's just a fact of life -- it is not possible in general to do the  
</I>&gt;<i> correct back conversion. AFAICT we will just have to accept this  
</I>&gt;<i> slight functionality loss and recommend that everybody specify module  
</I>&gt;<i> names rather than file names (at least for running twisted's tests --  
</I>&gt;<i> it's only broken when filenameToModuleName is wrong). Also, Trial  
</I>&gt;<i> *does* run the file specified even if it can't figure out how to  
</I>&gt;<i> import it, so if the test code doesn't actually depend on having its  
</I>&gt;<i> real module name (e.g. it doesn't use things like relative imports or  
</I>&gt;<i> __name__), it will also still work.
</I>
While we're at this, should we also be talking about running unit tests
which are packaged within zipfiles?  It seems like some of the same
problems might be addressed, as long as we are suggesting that
specifying filenames for tests is not a good idea.

I'm more interested in testing the actual code packaged in zipfiles than
running the tests from there, but it seems like having the whole package
zipped up would be an interesting meta-test case.




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="044200.html">[Twisted-Python] Subproject releases
</A></li>
	<LI>Next message (by thread): <A HREF="044210.html">[Twisted-Python] Subproject releases
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44209">[ date ]</a>
              <a href="thread.html#44209">[ thread ]</a>
              <a href="subject.html#44209">[ subject ]</a>
              <a href="author.html#44209">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
