<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Thoughts about testing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Thoughts%20about%20testing&In-Reply-To=%3C20051027033526.GA28791%40vidar.dreamhost.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="044309.html">
   <LINK REL="Next"  HREF="044310.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Thoughts about testing</H1>
    <B>David Ripton</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Thoughts%20about%20testing&In-Reply-To=%3C20051027033526.GA28791%40vidar.dreamhost.com%3E"
       TITLE="[Twisted-Python] Thoughts about testing">dripton at ripton.net
       </A><BR>
    <I>Wed Oct 26 21:35:27 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="044309.html">[Twisted-Python] Thoughts about testing
</A></li>
        <LI>Next message (by thread): <A HREF="044310.html">[Twisted-Python] Thoughts about testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44315">[ date ]</a>
              <a href="thread.html#44315">[ thread ]</a>
              <a href="subject.html#44315">[ subject ]</a>
              <a href="author.html#44315">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2005.10.26 13:14:56 -0400, Glyph Lefkowitz wrote:
&gt;<i> On Wed, 2005-10-26 at 04:56 -0700, David Ripton wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Things I particularly like about py.test, vs. unittest:
</I>&gt;<i> 
</I>&gt;<i> Can we compare to trial as it stands please?  I don't think anyone is
</I>
Sorry.  Haven't used trial lately, and didn't want to make outdated
comparisons.  unittest is the lingua franca; if I accidentally say
something useful, the trial guys can surely translate.

&gt;<i> &gt; 1. assert, not self.failUnlessAllThisUglyCamelCaseActuallyKillsMe()
</I>&gt;<i> 
</I>&gt;<i> This is cute - more in the way it deals with printing appropriate
</I>&gt;<i> context than the fact that you actually use 'assert' - but it's a shame
</I>&gt;<i> that they resorted to a language hack rather than a simple function like
</I>&gt;<i> 'test()' or something.  Using 'assert' makes it impossible to test with
</I>&gt;<i> -O or -OO.  I personally don't use those options, but some people do,
</I>&gt;<i> and they should be testable.
</I>
$ python -O `which py.test` test_assert.py
inserting into sys.path: /home/dripton/py-dist
/home/dripton/py-dist/py/test/cmdline.py:30: UserWarning: Assertions are
turned off! (are you using python -O?)
  py.std.warnings.warn(&quot;Assertions are turned off!&quot;
...

So I think this is a purely theoretical problem.  I can respect
disliking the magic assert on general principles, though, even though
it's very handy.  (Kinda like the print statement.)

&gt;<i> &gt; 2. You can use module-level test functions.  No need to make a test
</I>&gt;<i> &gt; class unless it's actually helpful.  (Yay Java.)
</I>&gt;<i> 
</I>&gt;<i> Handy in some cases, but from what I've seen in my brief survey of
</I>&gt;<i> py.test-based tests the only thing this does is make it more of a
</I>&gt;<i> convention to smear unit test state across a bunch of shared globals ...
</I>
Well, you can abuse globals to carry state across test methods in
unittest and trial as well.  (Init them at the module level rather than
in setUp.)

&gt;<i> &gt; 3. Tests execute in predictable order.
</I>&gt;<i> 
</I>&gt;<i> ... and then since there is now global state smeared across your whole
</I>&gt;<i> module, the tests have to run in an exact order because each one sets up
</I>&gt;<i> things for the next, rather than proper setUp/tearDown encapsulation.
</I>
If someone insists on writing bad tests, I don't think there's much a
Python framework is going to do to stop them.  It's just not a very
authoritarian language.  &quot;Stop, or I'll say 'stop' again!&quot;  But I think
most slackers tend to skip writing bad tests and go straight to writing
no tests.

I admit to reusing expensive-to-create objects across multiple test
functions/methods for performance, but I have been conditioned by years
of xUnit to treat such objects as immutable.  (Okay, in the case of
database connections, I put a rollback call in the teardown, which is
not quite the same thing.)

There are other uses for predictable order, even if the tests are fully
independent.  Like running the test you're currently trying to fix
first, or moving the slowest ones to the end.  Knowing what your program
is going to do is sometimes handy.  (unittest is random enough that one
of my co-workers insisted it must be multi-threaded.)

&gt;<i> &gt; 6. You can fill your tests with print statements, and only see their
</I>&gt;<i> &gt; output if the test fails (or you pass the -s option).
</I>&gt;<i> 
</I>&gt;<i> This is like a replication of trial's AND unittest's worst feature - the
</I>&gt;<i> fact that tracebacks are deferred until execution is finished, so tests
</I>&gt;<i> which hang intermittently are un-debuggable.  I believe it is only for
</I>&gt;<i> the buildbot that -e is not the default.  Speaking of which, let me go
</I>&gt;<i> update TwistedEmacs...
</I>
Yeah, that makes sense.  But *if* you're going to have deferred
tracebacks, then having print statements silenced when the test passes
can be nice, so that you can lie in wait for intermittent bugs without
generating too much noise.

-- 
David Ripton    <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dripton at ripton.net</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="044309.html">[Twisted-Python] Thoughts about testing
</A></li>
	<LI>Next message (by thread): <A HREF="044310.html">[Twisted-Python] Thoughts about testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44315">[ date ]</a>
              <a href="thread.html#44315">[ thread ]</a>
              <a href="subject.html#44315">[ subject ]</a>
              <a href="author.html#44315">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
