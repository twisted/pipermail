<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20exceptions.AttributeError%3A%20%27NoneType%27%20object%0A%09has%20no%20attribute%20%27write%27&In-Reply-To=1129640785.11441.31.camel%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011708.html">
   <LINK REL="Next"  HREF="011698.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'</H1>
    <B>Johann Borck</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20exceptions.AttributeError%3A%20%27NoneType%27%20object%0A%09has%20no%20attribute%20%27write%27&In-Reply-To=1129640785.11441.31.camel%40localhost.localdomain"
       TITLE="[Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'">johann.borck at densedata.com
       </A><BR>
    <I>Tue Oct 18 11:42:43 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011708.html">[Twisted-Python] Stability of the IOCP Reactor
</A></li>
        <LI>Next message: <A HREF="011698.html">[Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11696">[ date ]</a>
              <a href="thread.html#11696">[ thread ]</a>
              <a href="subject.html#11696">[ subject ]</a>
              <a href="author.html#11696">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Stefano Canepa wrote:

&gt;<i>
</I>&gt;<i>class Receiver(pb.Root, HL7LLPClientProtocol):
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>first of all, i think your pb.Root shouldn't be your protocol, you get
this error because you assume that your Receiver instance is the
protocol. PB uses it's own protocol, there is no use in deriving your
Receiver from your protocol,  I even think it's not possible at all to
implement it that way, and even if it worked it'd be confusing

def __init__(self):
    HL7LLPClientProtocol.__init__(self)

btw: AttributeError: class HL7LLPClientProtocol has no attribute
'__init__'      is what i get, if i don't comment out the above line -
there is no __init__ in that class and in LineReceiver and it's bases
(at least not in my version of twisted, but if you don't get this error,
there must be one somewhere)

&gt;<i>        
</I>&gt;<i>    def remote_sendToTCA(self, msg):
</I>&gt;<i>
</I>&gt;<i>        self.delimiter = &quot;\x02&quot;
</I>&gt;<i>        
</I>&gt;<i>        ## if DEBUG:
</I>&gt;<i>        print 'sending to TCA:', msg
</I>&gt;<i>        # Create creator and connect
</I>&gt;<i>        clientCreator = protocol.ClientCreator(reactor,  
</I>&gt;<i>                        HL7LLPClientProtocol)
</I>&gt;<i>  
</I>&gt;<i>
</I>Here you give the HL7LLPClientProtocol to the client creator, NOT your
Receiver - so you can't call self.sendMsg on your Receiver-instance
(which is good)

&gt;<i>        d = clientCreator.connectTCP(SERVER, PORT)
</I>&gt;<i>  
</I>&gt;<i>
</I>this deferred returns a _new_ instance of the HL7LLPClientProtocol
protocol-class, and _that_ instance has an initialized transport, not
your Receiver-instance, where you call self.sendMsg on.  Further you
don't use addCallback like you do it, you have to use it like:
addCallback(self.method, arg1, arg2, ... ), addCallback wants the
_method_ not it's result.   you have to write a method that gets the
instance of your Protocol from the deferred, and call sendMsg on that,
something like:

...

    clientCreator = protocol.ClientCreator(reactor, HL7LLPClientProtocol)
    d = clientCreator.connectTCP(SERVER, PORT)
    d.addCallback(self.getProto,msg,RETRIES)
    return msg

  def getProto(self,proto,msg,retries):
	proto.sendMsg(msg,retries)


moreover your Protocol should implement lineReceived - that is the next
error i got, running this. Maybe you read the twisted docs about
deferreds and PB.  :)

i hope this helps


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011708.html">[Twisted-Python] Stability of the IOCP Reactor
</A></li>
	<LI>Next message: <A HREF="011698.html">[Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11696">[ date ]</a>
              <a href="thread.html#11696">[ thread ]</a>
              <a href="subject.html#11696">[ subject ]</a>
              <a href="author.html#11696">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
