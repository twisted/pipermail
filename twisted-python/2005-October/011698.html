<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20exceptions.AttributeError%3A%20%27NoneType%27%20object%0A%09has%20no%20attribute%20%27write%27&In-Reply-To=435517F3.3040402%40densedata.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011696.html">
   <LINK REL="Next"  HREF="011694.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'</H1>
    <B>Stefano Canepa</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20exceptions.AttributeError%3A%20%27NoneType%27%20object%0A%09has%20no%20attribute%20%27write%27&In-Reply-To=435517F3.3040402%40densedata.com"
       TITLE="[Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'">sc at linux.it
       </A><BR>
    <I>Tue Oct 18 12:12:46 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011696.html">[Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'
</A></li>
        <LI>Next message: <A HREF="011694.html">[Twisted-Python] Win32 installers of Twisted 2.1?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11698">[ date ]</a>
              <a href="thread.html#11698">[ thread ]</a>
              <a href="subject.html#11698">[ subject ]</a>
              <a href="author.html#11698">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Il giorno mar, 18/10/2005 alle 17.42 +0200, Johann Borck ha scritto:
&gt;<i> Stefano Canepa wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;class Receiver(pb.Root, HL7LLPClientProtocol):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  
</I>&gt;<i> &gt;
</I>&gt;<i> first of all, i think your pb.Root shouldn't be your protocol, you get
</I>&gt;<i> this error because you assume that your Receiver instance is the
</I>&gt;<i> protocol. PB uses it's own protocol, there is no use in deriving your
</I>&gt;<i> Receiver from your protocol,  I even think it's not possible at all to
</I>&gt;<i> implement it that way, and even if it worked it'd be confusing
</I>&gt;<i> 
</I>&gt;<i> def __init__(self):
</I>&gt;<i>     HL7LLPClientProtocol.__init__(self)
</I>&gt;<i> 
</I>&gt;<i> btw: AttributeError: class HL7LLPClientProtocol has no attribute
</I>&gt;<i> '__init__'      is what i get, if i don't comment out the above line -
</I>&gt;<i> there is no __init__ in that class and in LineReceiver and it's bases
</I>&gt;<i> (at least not in my version of twisted, but if you don't get this error,
</I>&gt;<i> there must be one somewhere)
</I>
Sorry, I did an error pasting

&gt;<i> &gt;        
</I>&gt;<i> &gt;    def remote_sendToTCA(self, msg):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;        self.delimiter = &quot;\x02&quot;
</I>&gt;<i> &gt;        
</I>&gt;<i> &gt;        ## if DEBUG:
</I>&gt;<i> &gt;        print 'sending to TCA:', msg
</I>&gt;<i> &gt;        # Create creator and connect
</I>&gt;<i> &gt;        clientCreator = protocol.ClientCreator(reactor,  
</I>&gt;<i> &gt;                        HL7LLPClientProtocol)
</I>&gt;<i> &gt;  
</I>&gt;<i> &gt;
</I>&gt;<i> Here you give the HL7LLPClientProtocol to the client creator, NOT your
</I>&gt;<i> Receiver - so you can't call self.sendMsg on your Receiver-instance
</I>&gt;<i> (which is good)
</I>&gt;<i> 
</I>&gt;<i> &gt;        d = clientCreator.connectTCP(SERVER, PORT)
</I>&gt;<i> &gt;  
</I>&gt;<i> &gt;
</I>&gt;<i> this deferred returns a _new_ instance of the HL7LLPClientProtocol
</I>&gt;<i> protocol-class, and _that_ instance has an initialized transport, not
</I>&gt;<i> your Receiver-instance, where you call self.sendMsg on.  Further you
</I>&gt;<i> don't use addCallback like you do it, you have to use it like:
</I>&gt;<i> addCallback(self.method, arg1, arg2, ... ), addCallback wants the
</I>&gt;<i> _method_ not it's result.   you have to write a method that gets the
</I>&gt;<i> instance of your Protocol from the deferred, and call sendMsg on that,
</I>&gt;<i> something like:
</I>&gt;<i> 
</I>&gt;<i> ...
</I>&gt;<i> 
</I>&gt;<i>     clientCreator = protocol.ClientCreator(reactor, HL7LLPClientProtocol)
</I>&gt;<i>     d = clientCreator.connectTCP(SERVER, PORT)
</I>&gt;<i>     d.addCallback(self.getProto,msg,RETRIES)
</I>&gt;<i>     return msg
</I>&gt;<i> 
</I>&gt;<i>   def getProto(self,proto,msg,retries):
</I>&gt;<i> 	proto.sendMsg(msg,retries)
</I>&gt;<i> 
</I>
Thanks I arrived a the point with the help of Jp on IRC and reading docs
once again.

&gt;<i> moreover your Protocol should implement lineReceived - that is the next
</I>&gt;<i> error i got, running this. Maybe you read the twisted docs about
</I>&gt;<i> deferreds and PB.  :)
</I>&gt;<i> 
</I>&gt;<i> i hope this helps
</I>
It helped.

Thanks
Stefano

-- 
Stefano Canepa aka sc: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sc at linux.it</A>  <A HREF="http://www.stefanocanepa.it">http://www.stefanocanepa.it</A>
Three great virtues of a programmer: laziness, impatience and hubris.
Le tre grandi virt&#249; di un programmatore: pigrizia, impazienza e
arroganza. (Larry Wall)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20051018/3c830169/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-python/attachments/20051018/3c830169/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011696.html">[Twisted-Python] exceptions.AttributeError: 'NoneType' object	has no attribute 'write'
</A></li>
	<LI>Next message: <A HREF="011694.html">[Twisted-Python] Win32 installers of Twisted 2.1?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11698">[ date ]</a>
              <a href="thread.html#11698">[ thread ]</a>
              <a href="subject.html#11698">[ subject ]</a>
              <a href="author.html#11698">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
