<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to force synchronous behavior
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20force%20synchronous%20behavior&In-Reply-To=%3C20051031134814.10365.325034977.divmod.quotient.2278%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="044371.html">
   <LINK REL="Next"  HREF="044373.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to force synchronous behavior</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20force%20synchronous%20behavior&In-Reply-To=%3C20051031134814.10365.325034977.divmod.quotient.2278%40ohm%3E"
       TITLE="[Twisted-Python] How to force synchronous behavior">exarkun at divmod.com
       </A><BR>
    <I>Mon Oct 31 06:48:14 MST 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="044371.html">[Twisted-Python] How to force synchronous behavior
</A></li>
        <LI>Next message (by thread): <A HREF="044373.html">[Twisted-Python] How to force synchronous behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44372">[ date ]</a>
              <a href="thread.html#44372">[ thread ]</a>
              <a href="subject.html#44372">[ subject ]</a>
              <a href="author.html#44372">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 31 Oct 2005 08:28:39 -0500, Pedro Sanchez &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">psanchez at nortel.com</A>&gt; wrote:
&gt;<i>I am the original poster of this thread. First of all, thank you for the 
</I>&gt;<i>different responses. However I still don't have a clear answer (other than 
</I>&gt;<i>what I'm thinking of doing is wrong, which is OK, it can be fixed).
</I>&gt;<i>
</I>&gt;<i>I'm working on a Twisted/Nevow application, and yes, I'm new to both and I 
</I>&gt;<i>can tell that if learning Twisted has a step curve, doing it in conjuction 
</I>&gt;<i>with Nevow is really almost vertical. But, nevertheless, my application is 
</I>&gt;<i>working well these days.
</I>&gt;<i>
</I>&gt;<i>The motivation for my question is the following: I added the 
</I>&gt;<i>guard/credentials stuff to my application. The issue is that in order to 
</I>&gt;<i>accept a login my application requires several things to happen before 
</I>&gt;<i>access can be granted. I therefore implemented my own AuthChecker() which 
</I>&gt;<i>fires several deferreds to acomplish its task. This is working well, 
</I>&gt;<i>including the use of deferToThread() in several places.
</I>&gt;<i>
</I>&gt;<i>But, the behavior of the authentication wrapper is synchronous. That is, 
</I>&gt;<i>access to the system cannot be granted until all deferred operations have 
</I>&gt;<i>happended. In this wrapper I have something like:
</I>&gt;<i>
</I>&gt;<i>     def requestAvatar(self, avatarId, mind, *interfaces):
</I>&gt;<i>         for iface in interfaces:
</I>&gt;<i>             if iface is inevow.IResource:
</I>&gt;<i>                 if avatarId is checkers.ANONYMOUS:
</I>&gt;<i>                     resc = login.LoginPage()
</I>&gt;<i>                     resc.realm = self
</I>&gt;<i>                     return (inevow.IResource, resc, noLogout)
</I>&gt;<i>                 else:
</I>&gt;<i>                     resc = home.RootPage()
</I>&gt;<i>                     resc.realm = self
</I>&gt;<i>                     return (inevow.IResource, resc,
</I>&gt;<i>                             self.createLogout(avatarId, mind))
</I>&gt;<i>             else:
</I>&gt;<i>                 raise NotImplementedError(&quot;Not supported.&quot;)
</I>&gt;<i>
</I>&gt;<i>So let me rephrase my original question. Given that the real user 
</I>&gt;<i>authentication is happening in my AuthChecker() implemented somewhere else, 
</I>&gt;<i>with deferreds and what not, how can I force this requestAvatar() thing to 
</I>&gt;<i>wait until the whole login process has finished? My idea was to force a 
</I>&gt;<i>synchronous behavior on AuthChecker() forcing this way the login process to 
</I>&gt;<i>wait for it to finish.
</I>&gt;<i>
</I>&gt;<i>While writting this I realize that I may be missunderstanding how the 
</I>&gt;<i>credentials stuff works ... who knows.
</I>&gt;<i>
</I>&gt;<i>Any suggestions are appreciated,
</I>
Cred supports Deferreds, so there's no need to make your requestAvatar or requestAvatarId methods synchronous.  They can simply return Deferreds.  If you have several Deferreds going in requestAvatarId, you may want to use a DeferredList, which behaves very similarly to a Deferred, but takes several other Deferreds as input and only fires when all those Deferreds have fired.

requestAvatar won't be called until the Deferred you return from requestAvatarId fires.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="044371.html">[Twisted-Python] How to force synchronous behavior
</A></li>
	<LI>Next message (by thread): <A HREF="044373.html">[Twisted-Python] How to force synchronous behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44372">[ date ]</a>
              <a href="thread.html#44372">[ thread ]</a>
              <a href="subject.html#44372">[ subject ]</a>
              <a href="author.html#44372">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
