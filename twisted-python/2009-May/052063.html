<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] TCP Proxy scalability issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20TCP%20Proxy%20scalability%20issue&In-Reply-To=%3CEA2F29B650A22546932C85031ED4F98AE07649%40mail-37ps.atlarge.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   <LINK REL="Next"  HREF="052064.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] TCP Proxy scalability issue</H1>
    <B>Mohapatra Saurav</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20TCP%20Proxy%20scalability%20issue&In-Reply-To=%3CEA2F29B650A22546932C85031ED4F98AE07649%40mail-37ps.atlarge.net%3E"
       TITLE="[Twisted-Python] TCP Proxy scalability issue">saurav.mohapatra at dimdim.com
       </A><BR>
    <I>Fri May  1 08:02:47 MDT 2009</I>
    <P><UL>
        
        <LI>Next message (by thread): <A HREF="052064.html">[Twisted-Python] TCP Proxy scalability issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52063">[ date ]</a>
              <a href="thread.html#52063">[ thread ]</a>
              <a href="subject.html#52063">[ subject ]</a>
              <a href="author.html#52063">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

 

We're currently running a TCP proxy  / port multiplexer written in
Twisted to route to multiple worker server processes running on loopback
ports.

 

The architecture is something like this

 

Worker processes W1...n run listening on P1..n on the loopback and one
router process (twisted based) runs on public port P0 exposed to the
real world.

 

The clients connect to P0 and the first few bytes they send indicates
which worker process they wish to connect to. The Twisted protocol
implementation then creates a relay TCP connection to loopback worker
process port and after that forwards received data on P0 to the worker
port on loop back and sends back data received from worker port to the
external connection.

 

We're noticing significant degradation / starvation of the clients under
load (around 25 concurrent connections are enough to simulate this).

 

We're running on Linux (CentOS 5.2) using python 2.5 and Twisted latest
source tarball using the epoll reactor and all settings are default.
Each connection sends back around 8-24kb data per second.

 

My question is are there any &quot;production&quot; settings I need to do
(threadpool etc.) to get the maximum out of twisted.

 

Regards

Saurav

 

 

 

Saurav Mohapatra
Director of Technology


(  508.875.9501  | Mobile: 774.242.7422
*  <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">saurav at dimdim.com</A>
Skype: mohaps   |   AIM: mohaps

    Meet freely.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20090501/d4a6327e/attachment.html&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 6358 bytes
Desc: image001.png
URL: &lt;/pipermail/twisted-python/attachments/20090501/d4a6327e/attachment-0002.png&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message (by thread): <A HREF="052064.html">[Twisted-Python] TCP Proxy scalability issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52063">[ date ]</a>
              <a href="thread.html#52063">[ thread ]</a>
              <a href="subject.html#52063">[ subject ]</a>
              <a href="author.html#52063">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
