<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Question about deferreds
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Question%20about%20deferreds&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019580.html">
   <LINK REL="Next"  HREF="019582.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Question about deferreds</H1>
    <B>Doug Farrell</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Question%20about%20deferreds&In-Reply-To="
       TITLE="[Twisted-Python] Question about deferreds">dfarrell at mypublisher.com
       </A><BR>
    <I>Tue May  5 09:48:25 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019580.html">[Twisted-Python] RTFM about custom reactors
</A></li>
        <LI>Next message: <A HREF="019582.html">[Twisted-Python] Question about deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19581">[ date ]</a>
              <a href="thread.html#19581">[ thread ]</a>
              <a href="subject.html#19581">[ subject ]</a>
              <a href="author.html#19581">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

 

I consider myself a Twisted &quot;newbie&quot;, so this might seem like a simple
couple of questions, hope you'll indulge me.

 

When I first began experimenting with deferreds I was breaking up tasks
into sequences of steps something like this:

 

d = Deferred()

d.succeed(True)

d.addCallback(step1)

d.addCallback(step2)

d.addCallback(step3)

etc.

 

When this runs I was under the mistaken impression that at the end of
each callback (step1, step2, step3, etc) the deferred would yield back
to the main loop (reactor) and allow other deferreds to run. Now I know
that the callback functions run sequentially one after another with no
break. So my first question is this: what is the advantage of this over
just combining the callback functions into one big function?, something
like this:

 

d = Deferred()

d.succeed(True)

d.addCallback(OneBigStep)

 

If step1(), step2() and step3() take a fair bit of time to complete,
doesn't this effectively block the reactor loop for the entire exection
of all the steps?

 

My second question is related to this; what is a recommended way to
create the cooperative state machine I'm thinking of using deferreds?
For example if I create something like this:

 

d1 = Deferred()

d1.succeed(True)

d1.addCallback(d1_step1)

d1.addCallback(d1_step2)

d1.addCallback(d1_step3)

 

d2 = Deferred()

d2.succeed(True)

d2.addCallback(d2_step1)

d2.addCallback(d2_step2)

d2.addCallback(d2_step3)

 

How do I get the execution of this to be this:

 

1)      d1_step1

2)      d2_step1

3)      d1_step2

4)      d2_step2

5)      d1_step3

6)      d2_step3

 

I want to have the state machines I create cooperatively 'multi-task',
yielding control back to the main loop at each state transition.

 

Thanks in advance for any help, guidance or references you can provide.
I really enjoy Twisted, I'm still working on getting the 'Zen' of it.

 

Doug

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20090505/f4da5d28/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20090505/f4da5d28/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019580.html">[Twisted-Python] RTFM about custom reactors
</A></li>
	<LI>Next message: <A HREF="019582.html">[Twisted-Python] Question about deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19581">[ date ]</a>
              <a href="thread.html#19581">[ thread ]</a>
              <a href="subject.html#19581">[ subject ]</a>
              <a href="author.html#19581">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
