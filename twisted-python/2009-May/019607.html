<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Another approach to allowing __init__ to	work	with Deferreds
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Another%20approach%20to%20allowing%20__init__%20to%0A%09work%09with%20Deferreds&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019605.html">
   <LINK REL="Next"  HREF="019608.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Another approach to allowing __init__ to	work	with Deferreds</H1>
    <B>Terry Jones</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Another%20approach%20to%20allowing%20__init__%20to%0A%09work%09with%20Deferreds&In-Reply-To="
       TITLE="[Twisted-Python] Another approach to allowing __init__ to	work	with Deferreds">terry.jones at gmail.com
       </A><BR>
    <I>Tue May 12 00:28:42 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019605.html">[Twisted-Python] Another approach to allowing __init__ to work	with Deferreds
</A></li>
        <LI>Next message: <A HREF="019608.html">[Twisted-Python] Another approach to allowing __init__ to	work	with Deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19607">[ date ]</a>
              <a href="thread.html#19607">[ thread ]</a>
              <a href="subject.html#19607">[ subject ]</a>
              <a href="author.html#19607">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Drew. Thanks for the reply.

&gt;&gt;&gt;&gt;&gt;<i> &quot;Drew&quot; == Drew Smathers &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">drew.smathers at gmail.com</A>&gt; writes:
</I>
Drew&gt; Somewhere, someplace something has to get a reference to the object
Drew&gt; and it seems to me you're trying to prevent that something from
Drew&gt; calling methods on the instance of the object before it's ready.  So
Drew&gt; why not just defer providing the reference instead of wrapping
Drew&gt; methods and intercepting calls?  To illustrate, here's a simple
Drew&gt; modification of your example--assuming that `deferred' is an
Drew&gt; attribute on Things set in __int__()--that would achieve this without
Drew&gt; any special mixins:

Drew&gt; def theThingThatGetsTheReference(t):
Drew&gt;     d1 = t. f1(44)
[snip]
Drew&gt; if __name__ == '__main__':
Drew&gt; t = Thing()
Drew&gt; t.deferred.addCallback(lambda ign: theThingThatGetTheReference(t))

I hadn't thought about doing it that way. It's in the first category of
approaches: making the instance available when the deferred fires. Several
approaches with the same flavor are in the original thread.  I agree your
way is simpler, but I like it less:

 - The class is now special, in the sense that a caller can't just treat it
   as a normal class and call its instance methods. You need to know this
   before using the class...

 - If you don't, it's nevertheless possible to call instance methods
   directly (without waiting on the deferred).  The solutions in the
   original thread did not allow this. They guaranteed that the deferred
   had fired via a metaclass, via using __new__, or via using a classmethod
   to call __init__.

 - It puts the extra work of getting a properly initialized instance onto
   the caller. This may seem like a trivial concern, but I'd rather my
   classes looked/behaved like regular Python classes if possible: i.e.,
   get an instance, immediately use it.

If I'd thought of your approach initially, I almost certainly would have
gone with it and not spent time trying to dream up more elaborate
solutions.  Thanks again for replying. It's good to get a reply at all,
and, as usual, I've learned something.

Terry


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019605.html">[Twisted-Python] Another approach to allowing __init__ to work	with Deferreds
</A></li>
	<LI>Next message: <A HREF="019608.html">[Twisted-Python] Another approach to allowing __init__ to	work	with Deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19607">[ date ]</a>
              <a href="thread.html#19607">[ thread ]</a>
              <a href="subject.html#19607">[ subject ]</a>
              <a href="author.html#19607">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
