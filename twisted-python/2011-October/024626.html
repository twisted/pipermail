<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Ticket%20%234519%2C%0A%09other%20possible%20spawnProcess%20enhancments&In-Reply-To=CAOUOUDw8huB75UtLNZSk0JWKEk9EqiOZEveV4-eseAXxWRZiZg%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024609.html">
   <LINK REL="Next"  HREF="024631.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Ticket%20%234519%2C%0A%09other%20possible%20spawnProcess%20enhancments&In-Reply-To=CAOUOUDw8huB75UtLNZSk0JWKEk9EqiOZEveV4-eseAXxWRZiZg%40mail.gmail.com"
       TITLE="[Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Oct 10 09:53:38 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="024609.html">[Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments
</A></li>
        <LI>Next message: <A HREF="024631.html">[Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24626">[ date ]</a>
              <a href="thread.html#24626">[ thread ]</a>
              <a href="subject.html#24626">[ subject ]</a>
              <a href="author.html#24626">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Andrew,

Thanks for your work on this.

On Oct 7, 2011, at 1:45 AM, Andrew Mahone wrote:

&gt;<i> I've been working on <A HREF="http://twistedmatrix.com/trac/ticket/4159">http://twistedmatrix.com/trac/ticket/4159</A> and
</I>&gt;<i> there has been a bit of discussion on IRC regarding appropriate
</I>&gt;<i> interfaces for various things. I think in the long run, the only
</I>&gt;<i> python state that setupChild should be allowed to modify should be
</I>&gt;<i> args, environment, and the win32 StartupInfo object. This leaves my
</I>&gt;<i> own personal use case for it impossible, but I'm working out how to
</I>&gt;<i> handle that - special childFDs objects. My proposal so far is that
</I>&gt;<i> there be a ProcessFileDescriptor object that inherits from
</I>&gt;<i> FileDescriptor. It would add a setup method, which Process would call
</I>&gt;<i> in the parent, and separate finishChild and finishParent methods that
</I>&gt;<i> would handle things like closing the other end of any pipe-like
</I>&gt;<i> objects, and would return a file descriptor - the child would place
</I>&gt;<i> this fd in childFDs, the parent would use it for communications with
</I>&gt;<i> the child, in the case of objects that wrap pipes or PTYs. I would
</I>&gt;<i> also extend the win32 implementation to include some limited support
</I>&gt;<i> for childFDs - they could be used to allow the child to inherit
</I>&gt;<i> specific file handles as its stdin, stdout, and stderr, instead of
</I>&gt;<i> using these exclusively for communications with the parent, so that
</I>&gt;<i> redirection to a pipe, to a file, and the building of pipelines could
</I>&gt;<i> be accomplished on win32 (I have a project that uses twisted for this
</I>&gt;<i> purpose, and I don't use windows, but I would like support to at least
</I>&gt;<i> be possible).
</I>
I've been sitting on this message for a couple of days trying to come up with a good reply.  Unfortunately this whole description is phrased in terms of conflicting desires for the implementation, rather than a design strategy or a set of goals or requirements for the API, so my attempted replies have ended up playing whack-a-mole with the concerns one at a time, rather than making an informed critique of the whole proposal.

Could you try to re-phrase your design here in terms of why we want each of these things, some use-cases, and then maybe spell out the methods and stuff in terms of Python interfaces or classes (or perhaps links to your patch if it already implements what you've described here)?

Sorry that this probably isn't terribly useful feedback.  I really appreciate the time you've put in thus far, and I think I like where you're going with this, I just haven't had time to turn everything inside-out so that I can see it clearly :).

&gt;<i> I'm seeking comments on whether an extended childFDs interface is the
</I>&gt;<i> best way to manipulate the inherited files of the child process, and
</I>&gt;<i> whether, if so, fdmap ought to be visible in setupChild at all - in my
</I>&gt;<i> opinion, setupChild should be strictly for things like setting the
</I>&gt;<i> child PID in an environment variable or as a command line argument,
</I>&gt;<i> manipulating scheduler and other parameters external to twisted
</I>&gt;<i> itself, and other things of that nature, and the existing childFDs
</I>&gt;<i> mechanism should handle any manipulation of file redirection or
</I>&gt;<i> inheritance. If there are suggestions on what an extended childFD
</I>&gt;<i> object ought to look like, these are welcome as well - I think the
</I>&gt;<i> specified methods should handle trivial cases even on platforms
</I>&gt;<i> without fork, and should handle nearly anything that really is a file
</I>&gt;<i> descriptor on POSIX platforms, but maybe there is something I have
</I>&gt;<i> missed.
</I>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20111010/90651d71/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20111010/90651d71/attachment-0001.htm</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024609.html">[Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments
</A></li>
	<LI>Next message: <A HREF="024631.html">[Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24626">[ date ]</a>
              <a href="thread.html#24626">[ thread ]</a>
              <a href="subject.html#24626">[ subject ]</a>
              <a href="author.html#24626">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
