<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Running the same trial test suite against a live server and a mock server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Running%20the%20same%20trial%20test%20suite%20against%20a%0A%20live%20server%20and%20a%20mock%20server&In-Reply-To=65DEEACA-ECB1-49DF-A9E3-B44B4BD5FE21%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024631.html">
   <LINK REL="Next"  HREF="024616.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Running the same trial test suite against a live server and a mock server</H1>
    <B>Tom Cocagne</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Running%20the%20same%20trial%20test%20suite%20against%20a%0A%20live%20server%20and%20a%20mock%20server&In-Reply-To=65DEEACA-ECB1-49DF-A9E3-B44B4BD5FE21%40twistedmatrix.com"
       TITLE="[Twisted-Python] Running the same trial test suite against a live server and a mock server">tom.cocagne at gmail.com
       </A><BR>
    <I>Sat Oct  8 22:55:41 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="024631.html">[Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments
</A></li>
        <LI>Next message: <A HREF="024616.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24615">[ date ]</a>
              <a href="thread.html#24615">[ thread ]</a>
              <a href="subject.html#24615">[ subject ]</a>
              <a href="author.html#24615">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>   I recently ran into a similar problem while developing a native
python DBus implementation. Initially I implemented only the
client-side portion and pointed all my tests at the OS-provided
session bus. However, once I got around to implementing the
server-side portion of DBus, simply pointing all those &quot;known-good&quot;
client-side tests at the new bus implementation was a handy way to
test out the new code. To mechanism I used was to modify the
client-side testing module to use top-level module variables to tune
the connection setup code and then created &quot;test_bus.py&quot; with the
following content:

-----
import sys

from twisted.trial import unittest

import test_client

# Force the test code to use the internal bus rather than the
# OS-native bus
test_client.USE_INTERNAL_BUS = True

# &quot;Copy&quot; the test cases into this module
m = sys.modules[ __name__ ]

for k,v in test_client.__dict__.iteritems():
    if isinstance(v, type) and issubclass(v, unittest.TestCase):
        setattr(m, type(k, (v,), dict()))
-----

It's a bit of a hack, of course, but it's conceptually simple and
doesn't require much extra effort. Glyph's or Tim's suggestions may be
better for your project but I've been pretty happy with this mechanism
so far so I thought I'd toss it out there.

Cheers,

Tom



On Mon, Sep 26, 2011 at 5:24 PM, Glyph Lefkowitz
&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> On Sep 26, 2011, at 7:37 AM, Laurens Van Houtven wrote:
</I>&gt;<i>
</I>&gt;<i> Are there any better ways to pass test data to trial?
</I>&gt;<i>
</I>&gt;<i> Environment variables.
</I>&gt;<i> This isn't a great&#160;option, but I'd say it's definitely a better one than
</I>&gt;<i> modules which monkeypatch stuff.
</I>&gt;<i> You can also have your test cases synthesize stuff out of data files or
</I>&gt;<i> config files in your environment.
</I>&gt;<i> I'm not really inclined to make this super easy, since tests should by
</I>&gt;<i> definition not be terribly configurable: the more knobs like this you have
</I>&gt;<i> to turn, the less meaningful your test suite is likely to be.
</I>&gt;<i> So, today, I'd write something like this:
</I>&gt;<i> TXIEVERY_USERNAME=foo&#160;TXIEVERY_PW=bar&#160;TXIEVERY_CERT=baz.pem&#160;trial txievery
</I>&gt;<i> but if someone has a better thought, please chime in - this is by no means
</I>&gt;<i> the last word on this. &#160;And I'm facing a similar issue soon so I'd love to
</I>&gt;<i> hear some diversity of opinion here.
</I>&gt;<i> -glyph
</I>&gt;<i> PS: love the module name.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024631.html">[Twisted-Python] Ticket #4519,	other possible spawnProcess enhancments
</A></li>
	<LI>Next message: <A HREF="024616.html">[Twisted-Python] Weekly Bug Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24615">[ date ]</a>
              <a href="thread.html#24615">[ thread ]</a>
              <a href="subject.html#24615">[ subject ]</a>
              <a href="author.html#24615">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
