<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted 16.7.0rc1 Release Candidate	Announcement
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2016.7.0rc1%20Release%20Candidate%0A%09Announcement&In-Reply-To=%3C78CE3AEC-5516-4F8B-9E33-F62DEF02F380%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="063474.html">
   <LINK REL="Next"  HREF="030990.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted 16.7.0rc1 Release Candidate	Announcement</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%2016.7.0rc1%20Release%20Candidate%0A%09Announcement&In-Reply-To=%3C78CE3AEC-5516-4F8B-9E33-F62DEF02F380%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Twisted 16.7.0rc1 Release Candidate	Announcement">glyph at twistedmatrix.com
       </A><BR>
    <I>Thu Dec 29 19:07:32 MST 2016</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="063474.html">[Twisted-Python] Twisted 16.7.0rc1 Release Candidate	Announcement
</A></li>
        <LI>Next message (by thread): <A HREF="030990.html">[Twisted-Python] New Supported Platforms - FreeBSD (2.7 &amp; 3.5),	Python 3.6 (Linux)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63477">[ date ]</a>
              <a href="thread.html#63477">[ thread ]</a>
              <a href="subject.html#63477">[ subject ]</a>
              <a href="author.html#63477">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Dec 29, 2016, at 4:20 PM, Tim Allen &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">screwtape at froup.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> On Thu, Dec 29, 2016 at 05:27:44AM -0800, Glyph Lefkowitz wrote:
</I>&gt;&gt;<i> Increasingly, we are assuming a pip-like packaging toolchain for
</I>&gt;&gt;<i> dealing with Twisted's dependencies, so getting familiar with this
</I>&gt;&gt;<i> stuff - pip, requirements.txt, pinning, virtualenv - is worthwhile.
</I>&gt;&gt;<i> (It'll make your life easier in more ways than one.)
</I>&gt;<i> 
</I>&gt;<i> I wasn't going to mention it (because we found a workaround), but since
</I>&gt;<i> the topic has come up...
</I>&gt;<i> 
</I>&gt;<i> My current employer has a fully pip-based packaging toolchain for all
</I>&gt;<i> our internal Python apps, where we build wheels for our apps and all
</I>&gt;<i> their dependencies, and then deploy them into a virtualenv in
</I>&gt;<i> production. For reproducability reasons, we have a PyPI mirror inside
</I>&gt;<i> the corporate firewall, and our wheel-building Docker image has
</I>&gt;<i> a `pip.conf` configured to point at it.
</I>&gt;<i> 
</I>&gt;<i> Twisted 16.6 broke this system when it added a package named
</I>&gt;<i> &quot;incremental&quot; to the `setup_requires` list in setup.py. Because
</I>&gt;<i> `setup_requires` is a feature provided by setuptools, packages listed
</I>&gt;<i> there are installed by (the same machinery as) setuptools' `ez_install`
</I>&gt;<i> command, which does *not* respect `pip.conf`, and so it tried to
</I>&gt;<i> download the package from upstream PyPI and timed out banging its head
</I>&gt;<i> against the firewall.
</I>
Thanks, this is very useful information.

If you wanted to have this verified for the future, a network-isolated buildbot would be a good way to ensure we don't mess this up in other ways.  Based on this thread it seems that multiple users have this concern, so it's certainly not specific to you, either.

It would also force us to fix the dang documentation-generator test cases that keep failing when a certain someone forgets to update their SSL cert :-).

&gt;<i> As a workaround, we messed with our build-scripts to manually &quot;pip
</I>&gt;<i> install&quot; incremental before installing Twisted, or anything that depends
</I>&gt;<i> on it, so everything's fine again.
</I>&gt;<i> 
</I>&gt;<i> The Python Packaging Authority already has plans for replacing
</I>&gt;<i> `setup_requires` with something more Pip-friendly (see PEP 518), so over
</I>&gt;<i> time this won't be an issue. For the short term, though, I hope there
</I>&gt;<i> won't be too many more things added to `setup_requires` without
</I>&gt;<i> announcement.
</I>
Incremental is a bit of a special case, since &quot;version definition&quot; is one of the few things that needs synchronization between setup-time and run-time.  I was pretty nervous about adding `setup_requires`, but the value of getting our versioning logic outside of Twisted itself seemed worth the potential packaging fallout.

So, while you can expect to see many more things showing up in install_requires unannounced, as we split out low-level portions of Twisted and adopt libraries like h11, I doubt that you'll see another setup_requires arrive, especially before PyPA gets together a better approach than the literal setup.py setup_requires.  Given that you've specifically asked for notice, any project member submitting or reviewing a patch that adds one should give a shout here.

-glyph

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="063474.html">[Twisted-Python] Twisted 16.7.0rc1 Release Candidate	Announcement
</A></li>
	<LI>Next message (by thread): <A HREF="030990.html">[Twisted-Python] New Supported Platforms - FreeBSD (2.7 &amp; 3.5),	Python 3.6 (Linux)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63477">[ date ]</a>
              <a href="thread.html#63477">[ thread ]</a>
              <a href="subject.html#63477">[ subject ]</a>
              <a href="author.html#63477">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
