<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Wrapping a Perspective
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Wrapping%20a%20Perspective&In-Reply-To=1189157685.3460.10.camel%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015998.html">
   <LINK REL="Next"  HREF="015981.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Wrapping a Perspective</H1>
    <B>Rasjid Wilcox</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Wrapping%20a%20Perspective&In-Reply-To=1189157685.3460.10.camel%40localhost.localdomain"
       TITLE="[Twisted-Python] Wrapping a Perspective">rasjidw at gmail.com
       </A><BR>
    <I>Fri Sep  7 08:01:16 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="015998.html">[Twisted-Python] Wrapping a Perspective
</A></li>
        <LI>Next message: <A HREF="015981.html">[Twisted-Python] Properly handling Connection Refused
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15999">[ date ]</a>
              <a href="thread.html#15999">[ thread ]</a>
              <a href="subject.html#15999">[ subject ]</a>
              <a href="author.html#15999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/7/07, Phil Mayers &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">p.mayers at imperial.ac.uk</A>&gt; wrote:
&gt;<i> So, let me be be sure I've understood what you want:
</I>&gt;<i>
</I>&gt;<i> windows client
</I>&gt;<i>  |
</I>&gt;<i>  \- VB process
</I>&gt;<i>     |
</I>&gt;<i>   &lt;COM&gt;
</I>&gt;<i>     |
</I>&gt;<i>     \- python COM component
</I>&gt;<i>             |
</I>&gt;<i>   &lt;maybe Twisted in a thread&gt;
</I>&gt;<i>             |
</I>&gt;<i>   &lt;some kind of complex object/callback capable RMI&gt;
</I>&gt;<i>             |
</I>&gt;<i>      /- Python object ----&gt; another COM object
</I>&gt;<i>      |
</I>&gt;<i>  /- Twisted Process
</I>&gt;<i>  |
</I>&gt;<i> windows server
</I>
That is pretty much it exactly!  :-)

&gt;<i> I have a hard time seeing why you wouldn't just use DCOM for this, but
</I>&gt;<i> anyway...
</I>
Primarily because DCOM seems pretty fixed client -&gt; server, whereas I
want to be able to send out a UDP multicast packet, discover which PCs
I wish to talk to, query a number of them, and then run some remote
methods.  And as indicated in your diagram above, the remote python
object may or may not be a COM object. The above arrangement also
allows the remote object to be running on a Linux box for example,
which is trickier (or at least more expensive) with DCOM.  I would
also consider running PB over SSL across the public internet, whereas
DCOM would have to be via a VPN.

The very long term goal is the gradual migration from VB to Python.
That is, gradually more all core code into Python, wraping Python code
up as COM objects so it can be used within the current program.  At
some point (might take a year or two) the VB program is nothing but a
front-end to Python code, at which point we could migrate the
front-end to wxPython or similar.  And at that point a migration from
Windows to Linux at least becomes a feasible option to contemplate.
Thus I have a long term motivation to avoid DCOM even if it was easier
in the first instance.

&gt;<i> Is the python COM component on the client in-process or out of process?
</I>
I have not decided that yet.  I have a feeling that out-of-process is
probably better in this case, but I'm still doing a fair bit of
research and learning on all this.

&gt;<i> I assume you have no issues creating and talking to the COM object on
</I>&gt;<i> the server?
</I>
At the moment the 'server side' object in question is a Python object
that wraps up several COM objects and presents a much simpler
interface.

&gt;<i> Christopher Armstrong has already suggested looking at COM to see if it
</I>&gt;<i> can support &quot;async&quot; components; it's been a while, but I seem to recall
</I>&gt;<i> it can.
</I>
I believe it can, but the examples in win32com are a bit terse.

&gt;<i> You'll still need to run the reactor in a thread of course.
</I>
Yes!  And this is the part where I want some advice.  What are the
do's and don't of doing this?  And what are the most important things
I need to read / research?

Cheers,

Rasjid.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015998.html">[Twisted-Python] Wrapping a Perspective
</A></li>
	<LI>Next message: <A HREF="015981.html">[Twisted-Python] Properly handling Connection Refused
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15999">[ date ]</a>
              <a href="thread.html#15999">[ thread ]</a>
              <a href="subject.html#15999">[ subject ]</a>
              <a href="author.html#15999">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
