<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Wrapping a Perspective Broker remote object with	a blocking API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Wrapping%20a%20Perspective%20Broker%20remote%20object%20with%0A%09a%20blocking%20API&In-Reply-To=%3C6ce0ac130709041145l3c633588ob5cfbe016b8f91dd%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="048479.html">
   <LINK REL="Next"  HREF="048482.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Wrapping a Perspective Broker remote object with	a blocking API</H1>
    <B>Brian Granger</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Wrapping%20a%20Perspective%20Broker%20remote%20object%20with%0A%09a%20blocking%20API&In-Reply-To=%3C6ce0ac130709041145l3c633588ob5cfbe016b8f91dd%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Wrapping a Perspective Broker remote object with	a blocking API">ellisonbg.net at gmail.com
       </A><BR>
    <I>Tue Sep  4 12:45:17 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="048479.html">[Twisted-Python] Wrapping a Perspective Broker remote object	with a blocking API
</A></li>
        <LI>Next message (by thread): <A HREF="048482.html">[Twisted-Python] Wrapping a Perspective Broker remote object with	a blocking API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48481">[ date ]</a>
              <a href="thread.html#48481">[ thread ]</a>
              <a href="subject.html#48481">[ subject ]</a>
              <a href="author.html#48481">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> &gt;This is a usage case that we run into regularly.  We have a lot of PB
</I>&gt;<i> &gt;based servers, but sometimes people want to use a client to them from
</I>&gt;<i> &gt;an interactive Python or IPython prompt.  At that point you have to
</I>&gt;<i> &gt;run the reactor in a different thread.
</I>&gt;<i>
</I>&gt;<i> Not true, in fact.  See twisted/conch/stdio.py, for example.  I don't know
</I>&gt;<i> what the Twisted/IPython integration code ended up looking like (or if it
</I>&gt;<i> was ever taken to a satisfactory &quot;completion&quot; point) but I don't think it
</I>&gt;<i> is necessary to have multiple threads for that use case, either.
</I>
I have, but this doesn't solve the problem as I recall.  First, these
users want to be able to use PB clients from vanilla python
interpreters and IPython out of the box - not from within some other
process doing the tricks that are in conch/stdio.py.  Am I not correct
that threads are needed in this case?  Second, what this module does
is actually make the terminal asynchronous, which is exactly the
opposite of what these users want.  They *want* a synchronous terminal
and a blocking PB clients.  I hope I am not coming across as angry
about this - I'm not.  To me the lesson is that as long as everything
is really asynchronous anything is possible within the constraints of
this asynchronous universe.  It's the multiple universe things that
makes life complicated (asyn + syn).

&gt;<i> &gt;But, I have never seen a
</I>&gt;<i> &gt;method of putting a blocking API on top of such a client that was
</I>&gt;<i> &gt;_really_ thread safe.  I have seen a few approaches that seem to work,
</I>&gt;<i> &gt;but that are clearly non-thread safe.  I would love to see a robust
</I>&gt;<i> &gt;solution for this problem though - one that could be fully trusted.
</I>&gt;<i>
</I>&gt;<i> Why isn't a solution based on Twisted's thread-safe event-posting API
</I>&gt;<i> (reactor.callFromThread) and the thread-safe event-posting API of whatever
</I>&gt;<i> other thing is being integrated with &quot;really&quot; thread-safe?  Sure, you can
</I>&gt;<i> write programs which will deadlock as a result of application-level bugs
</I>&gt;<i> where one thread is blocked on a request and the other thread needs some
</I>&gt;<i> information from it before the request can be satisfied, but this is inherent
</I>&gt;<i> to wanting to drive an asynchronous API synchronously.  Aside from it, I
</I>&gt;<i> don't think there are any problems with what I described above.
</I>
It probably is, but I have never seen an implementation that actually
does this.  Do you know of one?  The ones that I have seen - even
those which use callFromThread have not filled me with thoughts of
robustness, stability and thread safety.  I should look at this again
though.

Also, I should mention that in IPython this is not a show stopper for
us, but it does mean that we currently don't use PB in all of the
places we might otherwise.

Brian



&gt;<i> Jean-Paul
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="048479.html">[Twisted-Python] Wrapping a Perspective Broker remote object	with a blocking API
</A></li>
	<LI>Next message (by thread): <A HREF="048482.html">[Twisted-Python] Wrapping a Perspective Broker remote object with	a blocking API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48481">[ date ]</a>
              <a href="thread.html#48481">[ thread ]</a>
              <a href="subject.html#48481">[ subject ]</a>
              <a href="author.html#48481">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
