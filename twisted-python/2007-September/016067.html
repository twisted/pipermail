<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> AW: Re: [Twisted-Python] Can a deferred catch a segmentation fault ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=AW%3A%20Re%3A%20%5BTwisted-Python%5D%20Can%20a%20deferred%20catch%20a%20segmentation%20fault%20%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016069.html">
   <LINK REL="Next"  HREF="016068.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>AW: Re: [Twisted-Python] Can a deferred catch a segmentation fault ?</H1>
    <B>Andreas Kostyrka</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=AW%3A%20Re%3A%20%5BTwisted-Python%5D%20Can%20a%20deferred%20catch%20a%20segmentation%20fault%20%3F&In-Reply-To="
       TITLE="AW: Re: [Twisted-Python] Can a deferred catch a segmentation fault ?">andreas at kostyrka.org
       </A><BR>
    <I>Thu Sep 20 13:50:44 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="016069.html">[Twisted-Python] Re: Can a deferred catch a segmentation fault?
</A></li>
        <LI>Next message: <A HREF="016068.html">AW: Re: [Twisted-Python] Can a deferred catch a segmentation	fault ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16067">[ date ]</a>
              <a href="thread.html#16067">[ thread ]</a>
              <a href="subject.html#16067">[ subject ]</a>
              <a href="author.html#16067">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Setting up such signal handler wouldn't be trivial (as in unsafe). The &quot;normal&quot; thing in such a situation is to longjmp (in C) or to let the process to die (which is the safe thing to do),

Now presuming that you cannot fix the segfaults (which as sad it sounds is quite common when using commercial 3rd party DLLs. Practice shows that being even a huge customer often get a quick turn around on bugs especially if its a hard to reproduce random crash. Driver DLLs for hardware costing $10K upwards come to mind, *shudder*), your only safe way is to isolate the driver usage into a seperate process. (If you are unlucky not even that is enough because some hardware gets stuck in a state that needs manual cold reseting, but let's be optimistic here).

With a seperate process, you can restart it should it die.

Andreas  

-- Urspr&#252;ngl. Mitteil. --
Betreff:	Re: [Twisted-Python] Can a deferred catch a segmentation fault?
Von:	Jean-Paul Calderone &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at divmod.com</A>&gt;
Datum:		20.09.2007 16:34

On Thu, 20 Sep 2007 09:14:11 -0700, &quot;Gerald John M. Manipon&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">geraldjohn.m.manipon at jpl.nasa.gov</A>&gt; wrote:
&gt;<i>Hi,
</I>&gt;<i>
</I>&gt;<i>I'm using deferToThread to run some python code which may or may not
</I>&gt;<i>be safe.  In particular, the code may load some modules that could
</I>&gt;<i>seg fault.  In this case, deferToThread won't work and the python
</I>&gt;<i>process will bomb so I was wondering what Defer strategy I could
</I>&gt;<i>use to handle this situation:
</I>
Deferreds don't do anything which will directly help in this situation.
If your process receives a signal for which the action is to exit, then
it will exit.  If you want, you can change the action associated with
certain signals (even SIGSEGV).  What action you *do* cause to happen
in such a case is independent of Deferreds.  You could, conceivably,
turn a segfault into an exception and then errback a Deferred.  However,
I wouldn't actually recommend this.  I would recommend not using software
which segfaults, fixing segfault bugs you find in software you are
using, and having comprehensive unit tests so that if something is
going to segfault, it does so during the course of development, not
on whatever server or client machines your software is deployed to.

Jean-Paul

_______________________________________________
Twisted-Python mailing list
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016069.html">[Twisted-Python] Re: Can a deferred catch a segmentation fault?
</A></li>
	<LI>Next message: <A HREF="016068.html">AW: Re: [Twisted-Python] Can a deferred catch a segmentation	fault ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16067">[ date ]</a>
              <a href="thread.html#16067">[ thread ]</a>
              <a href="subject.html#16067">[ subject ]</a>
              <a href="author.html#16067">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
