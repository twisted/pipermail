<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Wrapping a Perspective
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Wrapping%20a%20Perspective&In-Reply-To=E1ITDyB-0000u6-W7%40cube.twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016028.html">
   <LINK REL="Next"  HREF="016001.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Wrapping a Perspective</H1>
    <B>Andrew Francis</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Wrapping%20a%20Perspective&In-Reply-To=E1ITDyB-0000u6-W7%40cube.twistedmatrix.com"
       TITLE="[Twisted-Python] Wrapping a Perspective">andrewfr_ice at yahoo.com
       </A><BR>
    <I>Fri Sep  7 13:16:12 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="016028.html">[Twisted-Python] Cometd?
</A></li>
        <LI>Next message: <A HREF="016001.html">[Twisted-Python] How to ... in Conch?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16000">[ date ]</a>
              <a href="thread.html#16000">[ thread ]</a>
              <a href="subject.html#16000">[ subject ]</a>
              <a href="author.html#16000">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Rasjid:

&gt;<i>I have read about Stackless, and it looks like it
</I>&gt;<i>would be really fun to play with.  But I don't think
</I>my employer would be keen to go as 'fringe' as
Stackless.

Once you get the swing of it, Stackless Python is
pretty fun... and powerful. Even more fun when one
figures out how to properly integrate Stackless Python
with Twisted. 

Anyhow I haven't played with the Perspective Broker
before. So I read the Bruce Eckel &quot;Grokking Twisted&quot;
article and wrote a simple example to illustrate how
to make Twisted inter-operate with Stackless. 

The essense of the solution is the approach Armstrong
takes in threadless.py.  I provide a bit more
syntactic sugaring: 

1) Use a proxy that slightly modifies the method
calls, mainly to hide the underlying deferred.

2) trigger a &quot;TwistedException.&quot; 

example fragment:

   def execute(self, host, port):
        global flag
        
        factory = pb.PBClientFactory()
        log.msg(&quot;connecting&quot;)
        reactor.connectTCP(host, port, factory)
        log.msg(&quot;connected&quot;)
        
        try:
           perspective =
self.processor.getRootObject(factory)
           print &quot;=&gt;&quot;,
processor.calculate(perspective, 10, 20)
           flag = False
        
        except TwistedException:
            log.msg(&quot;A Twisted Exception was thrown&quot;)
            log.msg(sys.exc_info())

One of my long term goals is to standardise the
approach and auto generate proxies and exceptions as
to make Twisted safe for the average Stackless Python
programmer.

Cheers,
Andrew

P.S - reference
<A HREF="http://www.artima.com/weblogs/viewpost.jsp?thread=156396">http://www.artima.com/weblogs/viewpost.jsp?thread=156396</A>

PBServer.py - is Bruce Eckel's server slightly
modified.



       
____________________________________________________________________________________
Got a little couch potato? 
Check out fun summer activities for kids.
<A HREF="http://search.yahoo.com/search?fr=oni_on_mail&amp;p=summer+activities+for+kids&amp;cs=bz">http://search.yahoo.com/search?fr=oni_on_mail&amp;p=summer+activities+for+kids&amp;cs=bz</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PBExample.py
Type: text/x-python
Size: 2589 bytes
Desc: pat706081052
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20070907/063141da/attachment.py">http://twistedmatrix.com/pipermail/twisted-python/attachments/20070907/063141da/attachment.py</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PBServer.py
Type: text/x-python
Size: 662 bytes
Desc: 2825570039-PBServer.py
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20070907/063141da/attachment-0001.py">http://twistedmatrix.com/pipermail/twisted-python/attachments/20070907/063141da/attachment-0001.py</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016028.html">[Twisted-Python] Cometd?
</A></li>
	<LI>Next message: <A HREF="016001.html">[Twisted-Python] How to ... in Conch?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16000">[ date ]</a>
              <a href="thread.html#16000">[ thread ]</a>
              <a href="subject.html#16000">[ subject ]</a>
              <a href="author.html#16000">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
