<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] UDP with multiple connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20UDP%20with%20multiple%20connections&In-Reply-To=%3C20071011202749.5579.863387732.divmod.xquotient.5483%40joule.divmod.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="048667.html">
   <LINK REL="Next"  HREF="048661.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] UDP with multiple connections</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20UDP%20with%20multiple%20connections&In-Reply-To=%3C20071011202749.5579.863387732.divmod.xquotient.5483%40joule.divmod.com%3E"
       TITLE="[Twisted-Python] UDP with multiple connections">glyph at divmod.com
       </A><BR>
    <I>Thu Oct 11 14:27:49 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="048667.html">[Twisted-Python] UDP with multiple connections
</A></li>
        <LI>Next message (by thread): <A HREF="048661.html">[Twisted-Python] UDP with multiple connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48668">[ date ]</a>
              <a href="thread.html#48668">[ thread ]</a>
              <a href="subject.html#48668">[ subject ]</a>
              <a href="author.html#48668">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 08:04 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">radix at twistedmatrix.com</A> wrote:
&gt;<i>On 10/11/07, Simon Pickles &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sipickles at hotmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>My problem is my app needs to be a server to many clients (thru TCP -
</I>&gt;&gt;<i>twisted.protocols.basic) but a client to a further server, to which it
</I>&gt;&gt;<i>passes occasional information.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Is this possible through twisted, since I need two threads, one with 
</I>&gt;&gt;<i>the
</I>&gt;&gt;<i>server reactor.run() and one with the client connection listenTCP()?
</I>&gt;<i>
</I>&gt;<i>No you don't!
</I>&gt;<i>
</I>&gt;<i>listenTCP does not block. You can have as many connections as you want
</I>&gt;<i>in a single reactor. Twisted is an *asynchronous* networking
</I>&gt;<i>framework. You don't need multiple threads for this use case.
</I>
Please allow me to emphasize.  This is an important point.

Call listenTCP.  Then, immediately call listenUDP.  Then you will have a 
TCP server and a UDP server.  When TCP connections arrive, they will be 
connected using buildProtocol on your factory.  When UDP packets arrive, 
they will be delivered to datagramReceived on your UDP protocol.  You 
can then deliver those packets to whatever code you need to, whether 
it's C++ or Python or whatever.  You do not need, and should not want, 
threads for multiple sources of I/O.  If you want to take advantage of 
multiple cores or something, you can always run your C++ code that 
responds to some events in a separate process (or thread, if you are so 
inclined).

I would, however, suggest that you implement _all_ your messages using 
TCP over a single connection at first.  Once you have really understood 
and internalized the event-driven nature of Twisted, and implemented all 
the code needed to respond to position updates and so on, you will be 
able to easily split out the code that receives and parses those updates 
into a separate UDP class.  This will force you to deal with the fact 
that there is no deep architectural difference between delivering some 
messages over TCP and others over UDP.  If you instead start off with a 
two-protocol design that you do not entirely understand, your game's 
network architecture will be the result of a series of 
misunderstandings, not a well-planned whole.

Using UDP for position updates is simply an optimization, and one that 
you can make fairly late in development.  All the code to process and 
respond to them *should* be unchanged, regardless of how they are 
delivered.  Testing on local networks and fast links should be 
unaffected at first: UDP's performance advantage only comes into play 
when packets are being dropped, so it's only going to affect your game 
over long-haul links or really slow local networks.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="048667.html">[Twisted-Python] UDP with multiple connections
</A></li>
	<LI>Next message (by thread): <A HREF="048661.html">[Twisted-Python] UDP with multiple connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48668">[ date ]</a>
              <a href="thread.html#48668">[ thread ]</a>
              <a href="subject.html#48668">[ subject ]</a>
              <a href="author.html#48668">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
