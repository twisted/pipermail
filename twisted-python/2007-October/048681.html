<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.names.client.getHostByName Error when DNS	Server return Auth NS Server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.names.client.getHostByName%20Error%20when%20DNS%0A%09Server%20return%20Auth%20NS%20Server&In-Reply-To=%3C353309580710142309v404d8e0mb9ff3aeb5a2a516b%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="048680.html">
   <LINK REL="Next"  HREF="048682.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.names.client.getHostByName Error when DNS	Server return Auth NS Server</H1>
    <B>wangmm</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.names.client.getHostByName%20Error%20when%20DNS%0A%09Server%20return%20Auth%20NS%20Server&In-Reply-To=%3C353309580710142309v404d8e0mb9ff3aeb5a2a516b%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] twisted.names.client.getHostByName Error when DNS	Server return Auth NS Server">kernellearn at gmail.com
       </A><BR>
    <I>Mon Oct 15 00:09:08 MDT 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="048680.html">[Twisted-Python] Regarding &quot;add&quot; method in microdom.lmx
</A></li>
        <LI>Next message (by thread): <A HREF="048682.html">[Twisted-Python] returning strings with twisted.web.xmlrpc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48681">[ date ]</a>
              <a href="thread.html#48681">[ thread ]</a>
              <a href="subject.html#48681">[ subject ]</a>
              <a href="author.html#48681">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> There is a bug in the extractRecord function of common.py. And I open a
ticket in <A HREF="http://twistedmatrix.com/trac/ticket/2850">http://twistedmatrix.com/trac/ticket/2850</A>
----------------------------------------------------------------------------------------------------

Python Version:2.5
Twisted Version:2.5
Names Version:0.4


 When we got a resolver and call getHostByname, perhaps DNS server can
return CNAME, Auth NS Server Name and Auth NS Server IP Address. So
extractRecord function will extract the Auth NS Server and send the DNS
request to the Auth NS Server. But there is a bug in the extractRecord
function.

Code:

 # No answers, but maybe there's a hint at who we should be asking about
this for r in answers:

 if r.type == dns.NS:

 from twisted.names import client r = client.Resolver(servers=[(str(
r.payload.name), dns.PORT)]) return r.lookupAddress(str(name)

 Generally, the Auth NS Server is the Domain name, and it's IP contained in
the addition fields. If we get the NS Server by r.payload.name, we will get
the DNS Server Domain, so the Domain as server will pass to
client.queryUDPas DNS Server Address.
UDP.write will complaint that warnings.warn(&quot;Please only pass IPs to
write(), not hostnames &quot;+addr[0] &lt;<A HREF="http://twistedmatrix.com/trac/changeset/0">http://twistedmatrix.com/trac/changeset/0</A>&gt;,
DeprecationWarning? &lt;<A HREF="http://twistedmatrix.com/trac/wiki/DeprecationWarning">http://twistedmatrix.com/trac/wiki/DeprecationWarning</A>&gt;,
stacklevel=2). In addition, self.socket.sendto(datagram, addr) will call
socket.gethostbyname(addr), but this call is block.

I think we should use the Auth NS Server IP to replace the Domain. The patch
code as fellow:

Any comment is welcome!

 # No answers, but maybe there's a hint at who we should be asking about
this for r in answers:

 if r.type == dns.NS:

 from twisted.names import client

server = str(r.payload.name)

    for s in answers:

 if s.type==dns.A and str(s.name)==server :

 server = socket.inet_ntop(socket.AF_INET, s.payload.address) break

    r = client.Resolver(servers=[(server, dns.PORT)])
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20071015/1e9e3ceb/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="048680.html">[Twisted-Python] Regarding &quot;add&quot; method in microdom.lmx
</A></li>
	<LI>Next message (by thread): <A HREF="048682.html">[Twisted-Python] returning strings with twisted.web.xmlrpc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48681">[ date ]</a>
              <a href="thread.html#48681">[ thread ]</a>
              <a href="subject.html#48681">[ subject ]</a>
              <a href="author.html#48681">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
