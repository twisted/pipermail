<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Running commands (ssh) from a GUI client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Running%20commands%20%28ssh%29%20from%20a%20GUI%20client&In-Reply-To=OF0ED303F2.E7706FBC-ON8625736F.0060300F-8625736F.0061032D%40uscmail.uscourts.gov">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016135.html">
   <LINK REL="Next"  HREF="016145.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Running commands (ssh) from a GUI client</H1>
    <B>Ra&#250;l G&#243;mez C.</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Running%20commands%20%28ssh%29%20from%20a%20GUI%20client&In-Reply-To=OF0ED303F2.E7706FBC-ON8625736F.0060300F-8625736F.0061032D%40uscmail.uscourts.gov"
       TITLE="[Twisted-Python] Running commands (ssh) from a GUI client">nachogomez at gmail.com
       </A><BR>
    <I>Tue Oct  9 15:21:54 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="016135.html">[Twisted-Python] Running commands (ssh) from a GUI client
</A></li>
        <LI>Next message: <A HREF="016145.html">[Twisted-Python] Re: Running commands (ssh) from a GUI client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16136">[ date ]</a>
              <a href="thread.html#16136">[ thread ]</a>
              <a href="subject.html#16136">[ subject ]</a>
              <a href="author.html#16136">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you very much Paul, I'll give it a try and I'll post any change, I'm
really grateful... but giving it an overview, I think you are not executing
the commands the way I want, when you pass a list of commands on the
Dashboard (self.run_commands(&quot;myhost&quot;, &quot;myusername&quot;, &quot;mypassword&quot;, [&quot;id&quot;,
&quot;pwd&quot;, &quot;ls -l&quot;])) you are running it asynchronously (the way I'm getting it,
I mean, the three commands are passed to the CommandChannel class, and then
they gets run, and later they return it's data), I need to run commands from
the GUI, without previously knowing what commands will the user want to run
(the normal GUI interaction), and avoiding to all cost to authenticate for
each command (that's because some networks that my tool will connect takes
too long to authenticate ssh connections, but once they are authenticated,
they works just fine).

But thanks again Paul, if you want a suggestion on your code, I think (but
I'm not sure) you can get rid of a lot of code if you implement something
like I have (see below, in the answer to Jean-Paul), if you iterate on the
list of command, you can change the raw_input() with something like this:

for cmd in self.cmds:
    self.requestService(PasswordAuth(self.username, self.password,
ClientConnection(cmd)))

Just a suggestion, hope that helps...


On 10/9/07, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Paul_S_Johnson at mnb.uscourts.gov</A> &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Paul_S_Johnson at mnb.uscourts.gov</A>&gt;
wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Raul,
</I>&gt;<i>
</I>&gt;<i> This is simply some work-in-progress code, but is basically what you are
</I>&gt;<i> looking for even written for PythonCard. This takes a list of three commands
</I>&gt;<i> and runs them in the order given using deferreds to wait for the previous to
</I>&gt;<i> complete before executing the next.
</I>&gt;<i>
</I>&gt;<i> This took me about forever to get it this far. If you make and significant
</I>&gt;<i> improvements, please share.
</I>&gt;<i>
</I>&gt;<i> One remaining mystery is how to switch users once logged in. For example,
</I>&gt;<i> I need to run some things as root.
</I>&gt;<i>
</I>&gt;<i> Paul
</I>&gt;<i>
</I>

Jean-Paul, is not easy to post only a small working (by itself) part of what
I'm trying to do, is the sshclient.py (example
10-4)&lt;<A HREF="http://www.ora.de/catalog/twistedadn/chapter/ch10.pdf">http://www.ora.de/catalog/twistedadn/chapter/ch10.pdf</A>&gt;of the
Twisted
Network Programming Essentials Book by Abe Fettig (based on the
sshsimpleclient.py by Paul Swartz), but modified in order ask for the
command when the ClientConnection class is called in the
ClientCommandTransport class, like this:


class ClientCommandTransport(transport.SSHClientTransport):

    def __init__(self, username, password):
        self.username = username
        self.password = password

    def verifyHostKey(self, pubKey, fingerprint):
        # in a real app, you should verify that the fingerprint matches
        # the one you expected to get from this server
        return defer.succeed(True)

    def connectionSecure(self):
        cmd= ''
        while True:
            cmd = raw_input('Command: ')
            if cmd != 'quit':
                self.requestService(PasswordAuth(self.username,
self.password, ClientConnection(cmd)))
            else:
                print '\nGood Bye!\n'
                break

Note: the Bold part is what I've added to the original code


PD: I think Paul is a popular name in this list :p
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20071009/b7ec8cce/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20071009/b7ec8cce/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016135.html">[Twisted-Python] Running commands (ssh) from a GUI client
</A></li>
	<LI>Next message: <A HREF="016145.html">[Twisted-Python] Re: Running commands (ssh) from a GUI client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16136">[ date ]</a>
              <a href="thread.html#16136">[ thread ]</a>
              <a href="subject.html#16136">[ subject ]</a>
              <a href="author.html#16136">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
