<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] cBanana diffs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20cBanana%20diffs&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001290.html">
   <LINK REL="Next"  HREF="001292.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] cBanana diffs</H1>
    <B>Bruce Mitchener</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20cBanana%20diffs&In-Reply-To="
       TITLE="[Twisted-Python] cBanana diffs">bruce at cubik.org
       </A><BR>
    <I>Mon Jul  8 04:56:04 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001290.html">[Twisted-Python] Re: [Twisted-commits] Contributor agreement first commit.  (don't panic!)
</A></li>
        <LI>Next message: <A HREF="001292.html">[Twisted-Python] cBanana diffs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1291">[ date ]</a>
              <a href="thread.html#1291">[ thread ]</a>
              <a href="subject.html#1291">[ subject ]</a>
              <a href="author.html#1291">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've made a couple of local changes to cBanana to look at improving the 
performance of it some.

The diff is available from:
   <A HREF="http://day.cubik.org/~bruce/spread.diff">http://day.cubik.org/~bruce/spread.diff</A>

The change from the malloc/memcpy/free sequence to a realloc should be 
pretty clear.

The remainder of the changes are intended to let us allocate the python 
list objects in the correct size (since we know that) and to then use 
PyList_SET_ITEM() rather than PyList_Append().  In theory, that should 
help, in practice, it didn't much on simple tests.

One thing that was taking a while in simple runs was the handling of 
LONGINT and LONGNEG values (which call back into Python rather than 
using C code).  I've not yet optimized that at all as I don't yet have a 
good enough understanding.

I'll also run this new cBanana.c under valgrind or Purify this week to 
make sure that I didn't introduce any memory leaks.

Comments and suggestions are welcome.

  - Bruce



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001290.html">[Twisted-Python] Re: [Twisted-commits] Contributor agreement first commit.  (don't panic!)
</A></li>
	<LI>Next message: <A HREF="001292.html">[Twisted-Python] cBanana diffs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1291">[ date ]</a>
              <a href="thread.html#1291">[ thread ]</a>
              <a href="subject.html#1291">[ subject ]</a>
              <a href="author.html#1291">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
