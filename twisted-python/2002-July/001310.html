<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Question regarding async stuff
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Question%20regarding%20async%20stuff&In-Reply-To=200207110032.g6B0WjV89279%40steamteam.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001309.html">
   <LINK REL="Next"  HREF="001313.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Question regarding async stuff</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Question%20regarding%20async%20stuff&In-Reply-To=200207110032.g6B0WjV89279%40steamteam.com"
       TITLE="[Twisted-Python] Question regarding async stuff">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Jul 10 21:51:41 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001309.html">[Twisted-Python] Question regarding async stuff
</A></li>
        <LI>Next message: <A HREF="001313.html">[Twisted-Python] Question regarding async stuff
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1310">[ date ]</a>
              <a href="thread.html#1310">[ thread ]</a>
              <a href="subject.html#1310">[ subject ]</a>
              <a href="author.html#1310">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Wed, 10 Jul 2002 14:30:38 -0400, Greg Fortune &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">lists at gregfortune.com</A>&gt; wrote:

&gt;<i> I'm working on a network file server right now and am using Twisted as my
</I>&gt;<i> networking framework.  Overall, it's working really well.  The only thing I
</I>&gt;<i> haven't been able to figure out so far is what is async and what is not.  It
</I>&gt;<i> looks like data transfer is async (self.transport.write(msg)), but the
</I>&gt;<i> functions called in the protocol can block the entire twisted main loop.
</I>
Anything that returns a Deferred is asynchronous; everything else is
synchronous.  I think that your use of these terms belies a misunderstanding of
what's going on.

&gt;<i> [...] What is replacing Delayed [...]
</I>
IReactorTime.callLater(...)

    <A HREF="http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.19.0rc3/twisted/internet/interfaces_IReactorTime.py.html#callLater">http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.19.0rc3/twisted/internet/interfaces_IReactorTime.py.html#callLater</A>

&gt;<i> The reason I ask is that it doesn't appear that a twisted server can handle 
</I>&gt;<i> processing multiple requests at the same time.  It appears that a request 
</I>&gt;<i> must come in and be processed before another request can be serviced.  It 
</I>&gt;<i> probably isn't a big deal for me as the number of requests and amount of 
</I>&gt;<i> processing per request will be low, but it could be that I'm totally 
</I>&gt;<i> misunderstanding how the framework works.
</I>
Yeah, I think you're misunderstanding something ;).

Protocol.dataReceived is called only when data is available from a network
connection; therefore, partial requests coming in are partially parsed and
buffered by state machines (Protocol instances).

When a full request has been received, the request can be processed.  If
processing that request requires accessing other asynchronous data that's not
yet available, that's fine too -- just do your transport.write(...) to respond
later on, when a different event arrives.  Some parts of the framework
(twisted.spread, twisted.enterprise) make this extremely explicit, by allowing
the user to return a Deferred when their response is not yet ready.

Twisted can be &quot;processing multiple requests at the same time&quot; in the sense
that while it's waiting on data from the network, it won't be blocked, since
all I/O is asynchronous.  It will be &quot;stopped&quot; while doing literal CPU-bound
&quot;processing&quot; of a request; but while this may seem bad if you look at it
naively, 90% of all request-processing you'll do is incredibly brief, and
managing the resources needed to parallelize that processing is an order of
magnitude (or more, thanks to python's global interpreter lock, mutex
contention, context switching, and other thread nastinesses) more intensive
than just running the requests one after another.

This is before we even start talking about the inherent, dangerous complexity
of thread-based approaches to state management; they're inefficient, and
they're often buggy too.

Even given all that, Twisted does have good support for threads when you really
need them.

    <A HREF="http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.19.0rc3/twisted/internet/interfaces_IReactorThreads.py.html">http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.19.0rc3/twisted/internet/interfaces_IReactorThreads.py.html</A>

I hope this answers your questions.  What sort of file server are you writing?

-- 
 |    &lt;`'&gt;    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   &lt; _/ &gt;   |  Lead Developer,  the Twisted project  |
 |  &lt; ___/ &gt;  |      <A HREF="http://www.twistedmatrix.com">http://www.twistedmatrix.com</A>      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20020710/f1f7d2a2/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-python/attachments/20020710/f1f7d2a2/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001309.html">[Twisted-Python] Question regarding async stuff
</A></li>
	<LI>Next message: <A HREF="001313.html">[Twisted-Python] Question regarding async stuff
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1310">[ date ]</a>
              <a href="thread.html#1310">[ thread ]</a>
              <a href="subject.html#1310">[ subject ]</a>
              <a href="author.html#1310">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
