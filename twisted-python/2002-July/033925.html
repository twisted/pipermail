<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Large file transfers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Large%20file%20transfers&In-Reply-To=%3C20020729.103559.08323574.glyph%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="033929.html">
   <LINK REL="Next"  HREF="033930.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Large file transfers</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Large%20file%20transfers&In-Reply-To=%3C20020729.103559.08323574.glyph%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Large file transfers">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Jul 29 09:35:59 MDT 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="033929.html">[Twisted-Python] Large file transfers
</A></li>
        <LI>Next message (by thread): <A HREF="033930.html">[Twisted-Python] Large file transfers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33925">[ date ]</a>
              <a href="thread.html#33925">[ thread ]</a>
              <a href="subject.html#33925">[ subject ]</a>
              <a href="author.html#33925">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Mon, 29 Jul 2002 12:35:31 +0300, Tommi Virtanen &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">tv at twistedmatrix.com</A>&gt; wrote:
&gt;<i> On Fri, Jul 26, 2002 at 07:41:27AM -0500, Chris Armstrong wrote:
</I>&gt;<i> &gt; AFAIK, twisted.web.static _does_ do non-blocking reading, so check
</I>&gt;<i> &gt; that out.  I don't think anyone has implemented non-blocking writing
</I>&gt;<i> &gt; yet. (There's some sort of FileWrapper protocol or somesuch IIRC,
</I>&gt;<i> &gt; but it just assumes that write() won't take very long -- it's only
</I>&gt;<i> &gt; for testing)
</I>
&gt;<i> 	Bzzt, wrong. All file IO is sync. To do async file IO,
</I>&gt;<i> 	you need to use a different kernel API -- called AIO,
</I>&gt;<i> 	and not very widely available. (Or emulate it by forking
</I>&gt;<i> 	worker processes that pass data between stdin/stdout and
</I>&gt;<i> 	file).
</I>
Mr. Virtanen is right. The reason you might think it's async is that most File
I/O operations in Twisted are performed in a response to some request (web,
ftp), and are treated as &quot;large file&quot; operations.  The file is read one 'chunk'
at a time, and more is only read when the network connection it's being written
to becomes available for writing again.  This is what the &quot;producer/consumer&quot;
API in twisted.internet is for.  In general, on linux, this will mean that your
data is available in most cases anyway, due to the speed difference between
network &amp; file I/O.  In the cases where it's not, it's likely that your server
is under high enough load that it's OK to block for an ms or two to wait for
the data.

Asyncore has a great little comment about this:

# After a little research (reading man pages on various unixen, and
# digging through the linux kernel), I've determined that select()
# isn't meant for doing doing asynchronous file i/o.
# Heartening, though - reading linux/mm/filemap.c shows that linux
# supports asynchronous read-ahead.  So _MOST_ of the time, the data
# will be sitting in memory for us already when we go to read it.

Hope this is enlightening.

-- 
 |    &lt;`'&gt;    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   &lt; _/ &gt;   |  Lead Developer,  the Twisted project  |
 |  &lt; ___/ &gt;  |      <A HREF="http://www.twistedmatrix.com">http://www.twistedmatrix.com</A>      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20020729/137d0477/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="033929.html">[Twisted-Python] Large file transfers
</A></li>
	<LI>Next message (by thread): <A HREF="033930.html">[Twisted-Python] Large file transfers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33925">[ date ]</a>
              <a href="thread.html#33925">[ thread ]</a>
              <a href="subject.html#33925">[ subject ]</a>
              <a href="author.html#33925">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
