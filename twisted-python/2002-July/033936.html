<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Dynamic web application using twisted.web.resource
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Dynamic%20web%20application%20using%20twisted.web.resource&In-Reply-To=%3CACFC8A92-A3F0-11D6-8A4F-003065B25CAA%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="033935.html">
   <LINK REL="Next"  HREF="033939.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Dynamic web application using twisted.web.resource</H1>
    <B>Donovan Preston</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Dynamic%20web%20application%20using%20twisted.web.resource&In-Reply-To=%3CACFC8A92-A3F0-11D6-8A4F-003065B25CAA%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Dynamic web application using twisted.web.resource">dp at twistedmatrix.com
       </A><BR>
    <I>Tue Jul 30 13:15:13 MDT 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="033935.html">[Twisted-Python] Dynamic web application using twisted.web.resource
</A></li>
        <LI>Next message (by thread): <A HREF="033939.html">[Twisted-Python] You guys rock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33936">[ date ]</a>
              <a href="thread.html#33936">[ thread ]</a>
              <a href="subject.html#33936">[ subject ]</a>
              <a href="author.html#33936">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tuesday, July 30, 2002, at 09:19 AM, Mukhsein Johari wrote:
&gt;<i>
</I>&gt;<i> The project:
</I>&gt;<i> I would like to serve a dynamic website using the twisted web server. I
</I>&gt;<i> understand that the webserver's 'root' directory can be set at a file? 
</I>&gt;<i> I may
</I>&gt;<i> have a misunderstanding of the code and docs but if so, feel free to 
</I>&gt;<i> set me
</I>&gt;<i> straight.
</I>
When you create a tap file using &quot;bin/mktap web --path /foo/bar/baz&quot;, 
mktap creates a File instance, which is a Resource subclass, which knows 
to look in &quot;/foo/bar/baz&quot; as the root directory of the site. However, 
mktap is just a &quot;helper&quot; script that instanciates, configures, and 
persists various common application types. If you want the root object 
of your web site to be a custom Resource subclass that only serves 
dynamic pages, you're free to do that.

&gt;<i> The website (not real):
</I>&gt;<i> <A HREF="http://www.mywebsite.com/">http://www.mywebsite.com/</A>
</I>&gt;<i>
</I>&gt;<i> This is the root of the site, which is in reality a erm..rpy? program? 
</I>&gt;<i> Which
</I>&gt;<i> means that there are _no_ static pages at all. And no other 'file' -
</I>&gt;<i> everything goes through that .rpy file. (or whatever else I should be 
</I>&gt;<i> using)
</I>
So, as I just said, what you should do is create your own Application 
instance, create an instance of twisted.web.server.Site, and create your 
own custom Resource subclass to act as the root of that site. Your 
Resource subclass should override getChild(name, request) and 
render(request), as I will describe below. Here's how you would go about 
starting your custom server:

# MyCoolWebServer.py

from twisted.web import server
from twisted.internet import reactor

import myGreatResourceSubclass

root = myGreatResourceSubclass.MyRoot()

site = server.Site(root)

reactor.listenTCP(8080, site)
reactor.run()

&gt;<i> In a browser, entering this would get a dynamically 'constructed' page 
</I>&gt;<i> which
</I>&gt;<i> is in fact:
</I>&gt;<i>
</I>&gt;<i> myobject.index()
</I>
In the example above, visiting the root page would end up invoking 
root.render(request).

&gt;<i> From here on, something like:
</I>&gt;<i> <A HREF="http://www.mywebsite.com/projects/project_ako">http://www.mywebsite.com/projects/project_ako</A>
</I>&gt;<i>
</I>&gt;<i> would actually be (in the code) something like:
</I>&gt;<i>
</I>&gt;<i> myobject.projects[&quot;project_ako&quot;].index(myvar=None)
</I>
If these semantics are what you *really* want (i.e. transparency, 
getitem, or getattr being used for traversal), I suggest looking at Zope 
or Quixote, as Itamar suggested. However, here's how the following would 
look in twisted:

root.getChild(&quot;projects&quot;, request).getChild(&quot;project_ako&quot;, 
request).render(request)

In your root Resource subclass, you can define getChild to do whatever 
you wish such as dynamically generate a new Resource subclass to handle 
the &quot;projects&quot; portion, which in turn has a getChild that knows how to 
create an object to handle the &quot;project_ako&quot; portion, which in turn has 
a render() method that returns a string, which will be sent to the 
browser.

&gt;<i> which returns an html page suitable for the browser's consumption.
</I>&gt;<i> On the other hand this:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.mywebsite.com/projects/project_ako?myvar=bold">http://www.mywebsite.com/projects/project_ako?myvar=bold</A>
</I>&gt;<i>
</I>&gt;<i> (for http GET. POST should be handled as well...how? I am guessing the 
</I>&gt;<i> request
</I>&gt;<i> object?)
</I>&gt;<i>
</I>&gt;<i> Would call:
</I>&gt;<i> myobject.projects[&quot;project_ako&quot;].index(myvar='bold')
</I>
It would be exactly the same call as above, except request.args would be 
a dictionary that looked like this:

{'myvar': ['bold']}

Note that every value in the args dictionary is always a list, to make 
handling lists and non lists more uniform.

&gt;<i> Any other subobject of project_ako would 'call' a method on that object.
</I>&gt;<i>
</I>&gt;<i> So for:
</I>&gt;<i> <A HREF="http://www.mywebsite.com/projects/project_ako/getSize">http://www.mywebsite.com/projects/project_ako/getSize</A>
</I>&gt;<i>
</I>&gt;<i> Would call:
</I>&gt;<i> myobject.projects[&quot;project_ako&quot;].getSize()
</I>&gt;<i>
</I>&gt;<i> The return value being sent back to the browser. Calls to non-existing 
</I>&gt;<i> methods
</I>&gt;<i> get a &quot;No such method or object&quot; error returned - formatted, of course.
</I>
If you want automatic getChild traversal to stop at the object 
representing &quot;project_ako&quot;, set isLeaf = 1 on the object representing 
&quot;project_ako&quot;. This will cause render(request) to be called on 
&quot;project_ako&quot; with the remaining elements of the path in 
request.postpath. You can then implement the semantics described above 
in your render() method.

However, I find it much easier to divide functionality into separate 
classes and always use render() to do the html generation.

&gt;<i> The question is of course, how do you differentiate between an object 
</I>&gt;<i> and a
</I>&gt;<i> method? This is done by the application itself. It would check to see 
</I>&gt;<i> if that
</I>&gt;<i> object has a method with that name, if not check to see if it has a 
</I>&gt;<i> child
</I>&gt;<i> object with that name. Else return error.
</I>
If this is *really* the functionality that you want, again, this is far 
more similar to the traversal semantics of Zope or Quixote. Twisted has 
taken a far more explicit tack, where there is a specific api that your 
objects must implement to provide object-publishing functionality.

&gt;<i>
</I>&gt;<i> The thing is, I know I need to use twisted.web.resource but I'm not sure
</I>&gt;<i> _how_. How does this fit in with the .rpy file? I think I need to 
</I>&gt;<i> create my
</I>&gt;<i> modules and classes and then create an .rpy which acts as the
</I>&gt;<i> erm..'interface' to the modules and classes. Could someone give me some 
</I>&gt;<i> hints
</I>&gt;<i> and tips?
</I>&gt;<i>
</I>&gt;<i> Conceptually, it's quite simple but I can't seem to figure out how to 
</I>&gt;<i> do it
</I>&gt;<i> with twisted...Anyway, thanks for any help, in advance.
</I>
Hope this helps!

Donovan



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="033935.html">[Twisted-Python] Dynamic web application using twisted.web.resource
</A></li>
	<LI>Next message (by thread): <A HREF="033939.html">[Twisted-Python] You guys rock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33936">[ date ]</a>
              <a href="thread.html#33936">[ thread ]</a>
              <a href="subject.html#33936">[ subject ]</a>
              <a href="author.html#33936">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
