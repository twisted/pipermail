<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] threading on windows?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20threading%20on%20windows%3F&In-Reply-To=%3CHOEEKPCOKELHCNIJNMAGCEHACBAA.sean%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="032777.html">
   <LINK REL="Next"  HREF="032780.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] threading on windows?</H1>
    <B>Sean Riley</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20threading%20on%20windows%3F&In-Reply-To=%3CHOEEKPCOKELHCNIJNMAGCEHACBAA.sean%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] threading on windows?">sean at twistedmatrix.com
       </A><BR>
    <I>Tue Aug 21 16:08:34 MDT 2001</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="032777.html">[Twisted-Python] threading on windows?
</A></li>
        <LI>Next message (by thread): <A HREF="032780.html">[Twisted-Python] threading on windows?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32779">[ date ]</a>
              <a href="thread.html#32779">[ thread ]</a>
              <a href="subject.html#32779">[ subject ]</a>
              <a href="author.html#32779">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>threaded initialization stuff twisted.internet.main.py is not working for me
on windows.

I propose we put all threaded initialization into a method of
twisted.internet.main and have it called from threadable.init() in one
place.

This would include:
	installWaker()
	delayeds.append(threadtask.theScheduler)

how about internet.main.enableThreading() which would do the work that is
currently in installWaker and set up the delayed scheduler?

On my machine with that change and some minor changes to threading.init() I
can run both threaded and non-threaded code on windows.

-----Original Message-----
From: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>
[mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>]On Behalf Of Sean Riley
Sent: Tuesday, August 21, 2001 3:23 PM
To: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>
Subject: [Twisted-Python] threading on windows?


I am trying to get a threaded twisted server to run on windows (Windows2000
SP3) and having some issues.

There is an assert in threadable.py in init():

def init(with_threads):
    global threaded, _to_be_synched, dispatcher, dispatch, Waiter,
dispatchOS
    print &quot;Threadable init&quot;, with_threads
    if threaded == with_threads:
        return
    assert threaded is None
    threaded = with_threads

that always asserts whether I pass &quot;-t&quot; to twistd or not.  It seems that
requireInit() gets called before init() so the code:

def requireInit():
    global threaded
    if threaded is None:
        init(0)

is always run to initialize the global &quot;threaded&quot; to zero.

If i take out that &quot;assert threaded in None&quot; it seems to initialize
correctly on the &quot;second&quot; time through.

But, in internet.main the global &quot;waker&quot; is never initialized as
installWaker() is never called. I think that is because threadable.threaded
was initialized as 0 the &quot;first&quot; time through when it was called by
requireInit() and the code:

if threadable.threaded:
    installWaker()

in internet.main.py skips the installWaker() call.

Anyone else tried running a threaded server on windows?




_______________________________________________
Twisted-Python mailing list
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="032777.html">[Twisted-Python] threading on windows?
</A></li>
	<LI>Next message (by thread): <A HREF="032780.html">[Twisted-Python] threading on windows?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32779">[ date ]</a>
              <a href="thread.html#32779">[ thread ]</a>
              <a href="subject.html#32779">[ subject ]</a>
              <a href="author.html#32779">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
