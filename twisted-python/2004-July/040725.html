<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> process hangs (was Re: [Twisted-Python] Re: [Twisted-commits]	r11107 - Delete fundamentally broken test.)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20process%20hangs%20%28was%20Re%3A%20%5BTwisted-Python%5D%20Re%3A%20%5BTwisted-commits%5D%0A%09r11107%20-%20Delete%20fundamentally%20broken%20test.%29&In-Reply-To=%3C1091158754.1830.5790.camel%40oneiros%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040672.html">
   <LINK REL="Next"  HREF="040726.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>process hangs (was Re: [Twisted-Python] Re: [Twisted-commits]	r11107 - Delete fundamentally broken test.)</H1>
    <B>Dave Peticolas</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20process%20hangs%20%28was%20Re%3A%20%5BTwisted-Python%5D%20Re%3A%20%5BTwisted-commits%5D%0A%09r11107%20-%20Delete%20fundamentally%20broken%20test.%29&In-Reply-To=%3C1091158754.1830.5790.camel%40oneiros%3E"
       TITLE="process hangs (was Re: [Twisted-Python] Re: [Twisted-commits]	r11107 - Delete fundamentally broken test.)">dave at krondo.com
       </A><BR>
    <I>Thu Jul 29 21:39:14 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040672.html">[Twisted-Python] Re: [Twisted-commits] r11107 - Delete	fundamentally broken test.
</A></li>
        <LI>Next message (by thread): <A HREF="040726.html">process hangs (was Re: [Twisted-Python] Re: [Twisted-commits]	r11107 - Delete fundamentally broken test.)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40725">[ date ]</a>
              <a href="thread.html#40725">[ thread ]</a>
              <a href="subject.html#40725">[ subject ]</a>
              <a href="author.html#40725">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 2004-07-23 at 07:07, Andrew Bennetts wrote:
&gt;<i> On Fri, Jul 23, 2004 at 09:38:56AM -0400, James Y Knight wrote:
</I>&gt;<i> &gt; Wait, wait, that causes *hangs*? That seems like a bad thing. It 
</I>&gt;<i> &gt; doesn't look like an obviously wrong thing to do to me. Do you know 
</I>&gt;<i> &gt; *why* it's hanging?
</I>&gt;<i> 
</I>&gt;<i> I'm not sure why it's hanging, and I'd be happy for someone to figure out
</I>&gt;<i> why.  Ideally they'd fix the problem too, if there is one.
</I>&gt;<i> 
</I>&gt;<i> My suspicion is that the bug is in that test, not in Twisted, though.  The
</I>&gt;<i> process_pausing.py script itself is far too ugly to have any confidence in.
</I>&gt;<i> It tries to detect that writes to stdout block by looking at times, which is
</I>&gt;<i> extremely fragile.  Worse, detecting that writing to stdout blocks doesn't
</I>&gt;<i> necessarily prove anything anyway: the intention (presumably, the test has
</I>&gt;<i> no comments) is apparently to test that pauseProducing on a transport will
</I>&gt;<i> cause pipes from a child process to be unread and hence let the buffers
</I>&gt;<i> fill.  But the child process could just as easily be finding that the writes
</I>&gt;<i> are blocking because it's simply writing more frequently than the parent is
</I>&gt;<i> reading, e.g. due to scheduling anomalies... 
</I>&gt;<i> 
</I>&gt;<i> I'm also not aware of any real world reports of problems with the process
</I>&gt;<i> code hanging, despite the test being pretty prone to intermittent failure,
</I>&gt;<i> which is also highly suggestive that the test is broken, not the code.
</I>
I have a somewhat annoying problem related to the process code,
though possibly not caused by it. I have a script that is managing large
numbers of processes (sometimes hundreds, over time) and occasionally a
process will manage to exit and twisted's process code doesn't get the
waitpid info for it, but instead gets the ECHILD (no such child) system
error. In that case, twisted will keep trying to reap the process and
will never figure out the process is gone.

This is on a Redhat 7.2 system using python2.3 and a newish version
of twisted. I don't know why the process seems to get lost, but it
would be nice if Twisted would at least notice the ECHILD and signal
process termination (or lost, or something).

Has anyone else experienced this problem?

thanks,
dave




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040672.html">[Twisted-Python] Re: [Twisted-commits] r11107 - Delete	fundamentally broken test.
</A></li>
	<LI>Next message (by thread): <A HREF="040726.html">process hangs (was Re: [Twisted-Python] Re: [Twisted-commits]	r11107 - Delete fundamentally broken test.)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40725">[ date ]</a>
              <a href="thread.html#40725">[ thread ]</a>
              <a href="subject.html#40725">[ subject ]</a>
              <a href="author.html#40725">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
