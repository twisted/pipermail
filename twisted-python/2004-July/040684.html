<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Wiring  a new reactor/Client into Twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Wiring%20%20a%20new%20reactor/Client%20into%20Twisted&In-Reply-To=%3C41055022.3050506%40reedflute.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="040688.html">
   <LINK REL="Next"  HREF="040685.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Wiring  a new reactor/Client into Twisted</H1>
    <B>Eugene Coetzee</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Wiring%20%20a%20new%20reactor/Client%20into%20Twisted&In-Reply-To=%3C41055022.3050506%40reedflute.com%3E"
       TITLE="[Twisted-Python] Wiring  a new reactor/Client into Twisted">projects at reedflute.com
       </A><BR>
    <I>Mon Jul 26 12:40:34 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="040688.html">[Twisted-Python] reconnecting from the client
</A></li>
        <LI>Next message (by thread): <A HREF="040685.html">[Twisted-Python] Wiring  a new reactor/Client into Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40684">[ date ]</a>
              <a href="thread.html#40684">[ thread ]</a>
              <a href="subject.html#40684">[ subject ]</a>
              <a href="author.html#40684">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm using Twisted in an industrial application to replace a 
multi-threaded C++ driver which I developed some time ago to drive an 
array of serial ports (COM port expander) simultaneously. This is quite 
a typical application found in industrial control, building 
security/access control systems,  etc.  where an extended multi-drop 
serial  protocol like RS485/422 is used together with a standard message 
format such as Modbus to do remote data aquisition and control of 
embedded devices.

These kind of systems make use of what is refered  to as a master/slave 
serial driver i.e. there is only one master (typically a PC)  and a 
slave device may only respond to polls from the master.

My aim is to create a new Twisted package - say twisted.industrial  - 
which I hope contribute to the  Twisted platform.  I want to achieve 
this by extending Twisted  without modifying any Twisted sources, 
reusing as much as possible of existing Twisted code and * doing things 
very much the &quot;Twisted way&quot; * :)

The main problem is that most of Twisted's base classes seems to  have 
TCP/UDP network connectivity in mind.

I have managed to subclass SelectReactor in order to create 
SerialSelectReactor, base.BaseConnector to create SerialConnector, 
SerialPort to create ExtendedSerialPort  and I have the following piece 
of code working. 

***********************************************************
if __name__=='__main__':
        from serialreactor import serialreactor
        factory = ModbusFactory()
        factory.protocol=Modbus()
        serialreactor.connectSerial('/dev/ttyS0',9600,factory)
        print &quot;start reactor&quot;
        serialreactor.run()
        print &quot;exit reactor&quot;
***********************************************************

This is good but I want to run more than one serialport (or serial 
protocol) simultaneously - i.e I need to drive up to 64 serial ports at 
the same time. I believe I need  to do something like:

************************************************************
if __name__=='__main__':
        from serialapplication import SerialClient,service
        application=service.Application('Serial',uid=1,gid=1)
        factory = ModbusFactory()
        factory.protocol=Modbus()
        print &quot;start client&quot;
        
internet.SerialClient(79,factory).setServiceParent(service.IServiceCollection(app
lication))
        print &quot;exit client&quot;
**************************************************************

But I'm finding difficulty in grasping the code in application.internet 
(do not understand why it was done like that)  since I want to subclass 
_AbstractClient which is  seems to be  the product of some clever text 
manipulation and dynamic &quot;class creation&quot;.

Any comments, suggestions, recommendations  and am I one the right track?

regards,

Eugene






</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="040688.html">[Twisted-Python] reconnecting from the client
</A></li>
	<LI>Next message (by thread): <A HREF="040685.html">[Twisted-Python] Wiring  a new reactor/Client into Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40684">[ date ]</a>
              <a href="thread.html#40684">[ thread ]</a>
              <a href="subject.html#40684">[ subject ]</a>
              <a href="author.html#40684">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
