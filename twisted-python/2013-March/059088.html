<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Epoll error after upgrading from 10.0 to 12.3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Epoll%20error%20after%20upgrading%20from%2010.0%20to%2012.3&In-Reply-To=%3C069d01ce17cf%24070377e0%24150a67a0%24%40com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059227.html">
   <LINK REL="Next"  HREF="059089.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Epoll error after upgrading from 10.0 to 12.3</H1>
    <B>Alec Matusis</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Epoll%20error%20after%20upgrading%20from%2010.0%20to%2012.3&In-Reply-To=%3C069d01ce17cf%24070377e0%24150a67a0%24%40com%3E"
       TITLE="[Twisted-Python] Epoll error after upgrading from 10.0 to 12.3">matusis at yahoo.com
       </A><BR>
    <I>Sat Mar  2 22:21:57 MST 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059227.html">[Twisted-Python] Weekly Bug Summary
</A></li>
        <LI>Next message (by thread): <A HREF="059089.html">[Twisted-Python] Epoll error after upgrading from 10.0 to 12.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59088">[ date ]</a>
              <a href="thread.html#59088">[ thread ]</a>
              <a href="subject.html#59088">[ subject ]</a>
              <a href="author.html#59088">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I had 60 busy tcp servers that ran on Python 2.6/Twisted 10.0 (or Twisted
9.0) for over two years with not problems. After I upgraded to Twisted
12.3/Python 2.7, I started getting the errors below (no application code
changes). It took about two days for the first error to appear on a busy
server under heavy load:

[twisted.internet.protocol.ServerFactory] Unhandled Error
        Traceback (most recent call last):
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/python/lo
g.py&quot;, line 73, in callWithCon
text
            return context.call({ILogContext: newCtx}, func, *args, **kw)
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/python/co
ntext.py&quot;, line 118, in callWi
thContext
            return self.currentContext().callWithContext(ctx, func, *args,
**kw)
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/python/co
ntext.py&quot;, line 81, in callWit
hContext
            return func(*args,**kw)
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/internet/
posixbase.py&quot;, line 614, in _d
oReadOrWrite
            why = selectable.doRead()
        --- &lt;exception caught here&gt; ---
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/internet/
tcp.py&quot;, line 1069, in doRead
            transport = self.transport(skt, protocol, addr, self, s,
self.reactor)
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/internet/
tcp.py&quot;, line 786, in __init__
            self.startReading()
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/internet/
abstract.py&quot;, line 429, in sta
rtReading
            self.reactor.addReader(self)
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/internet/
epollreactor.py&quot;, line 256, in
 addReader
            _epoll.EPOLLIN, _epoll.EPOLLOUT)
          File
&quot;/usr/local/encap/Python-2.7.3/lib/python2.7/site-packages/twisted/internet/
epollreactor.py&quot;, line 240, in
 _add
            self._poller.modify(fd, flags)
        exceptions.IOError: [Errno 2] No such file or directory


After the error occurs, the server usually locks up and does not accept new
connections. One server self-recovered after these errors after 30min
outage, and started accepting new connections.
Apparently I am not the ony one who has enountered this:
<A HREF="http://stackoverflow.com/questions/12600137/twisted-internet-epollreactor-py">http://stackoverflow.com/questions/12600137/twisted-internet-epollreactor-py</A>
-line-238-in-add

Is there a patch available, or should I roll back to 10.0.0?




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059227.html">[Twisted-Python] Weekly Bug Summary
</A></li>
	<LI>Next message (by thread): <A HREF="059089.html">[Twisted-Python] Epoll error after upgrading from 10.0 to 12.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59088">[ date ]</a>
              <a href="thread.html#59088">[ thread ]</a>
              <a href="subject.html#59088">[ subject ]</a>
              <a href="author.html#59088">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
