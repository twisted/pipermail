<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] debugging listenTCP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20debugging%20listenTCP&In-Reply-To=%3C366DD0FD-01BD-44B1-BE87-7E374C44E055%40conundrum.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059124.html">
   <LINK REL="Next"  HREF="059183.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] debugging listenTCP</H1>
    <B>Matthew Pounsett</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20debugging%20listenTCP&In-Reply-To=%3C366DD0FD-01BD-44B1-BE87-7E374C44E055%40conundrum.com%3E"
       TITLE="[Twisted-Python] debugging listenTCP">matt at conundrum.com
       </A><BR>
    <I>Mon Mar 11 19:40:30 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059124.html">[Twisted-Python] Sprinting on Twisted at PyCon
</A></li>
        <LI>Next message (by thread): <A HREF="059183.html">[Twisted-Python] debugging listenTCP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59130">[ date ]</a>
              <a href="thread.html#59130">[ thread ]</a>
              <a href="subject.html#59130">[ subject ]</a>
              <a href="author.html#59130">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I've got a weird one here.   I've just come back to some code that I haven't worked on in a while, which is a simple XMLRPC server.  Last time I touched it I was working on adding cred support, so I'd gone from using a direct call to server.Site() in my listenTCP call to using my own factory/portal/etc.

When I fired it up this time, listenTCP was failing to bind to the requested ports, but not raising an exception.  I started writing up an email to ask about debugging this, but while doing information collection it started working again.  Then not.  Now it's working again.  It looks like I've got some sort of intermittent failure, but I have no idea how to track it down.

    # 'interfaces' is just a simple list of IP addresses.  The map()
    # call provides formatting for the log message
    logger.debug(&quot;Connecting to port {} on interfaces: {}&quot;.format(
        port, &quot;, &quot;.join(map( lambda x: &quot;'{}'&quot;.format(x), interfaces))))
    for iface in interfaces:
        reactor.listenTCP(port, factory, interface=iface)
    reactor.run()

The application should bind to [::1]:8602 and 127.0.0.1:8602, and logging seems to indicate this is what it's trying to do.

01:28:31 [server      ] Connecting to port 8602 on interfaces: '::1', '127.0.0.1'

However, intermittently lsof and netstat are showing no binding.

&gt;<i> netstat -an | grep -c 8602
</I>0

I tried turning on twisted's internal logging, but that is giving me nothing useful.  I see no way to turn up the debugging level on this log, but I normally use python's standard logger and perhaps I've missed some piece of documentation.  This is a sample from when it was failing:

2013-03-12 01:28:31+0000 [-] Log opened.
2013-03-12 01:28:31+0000 [-] ServerFactory starting on 8602
2013-03-12 01:28:31+0000 [-] Starting factory &lt;insurrection.server.ServerFactory instance at 0x85a81488&gt;
2013-03-12 01:28:31+0000 [-] ServerFactory starting on 8602

Can anyone suggest anything more I can do to track down the problem next time it crops up?




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059124.html">[Twisted-Python] Sprinting on Twisted at PyCon
</A></li>
	<LI>Next message (by thread): <A HREF="059183.html">[Twisted-Python] debugging listenTCP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59130">[ date ]</a>
              <a href="thread.html#59130">[ thread ]</a>
              <a href="subject.html#59130">[ subject ]</a>
              <a href="author.html#59130">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
