<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Lore and generating reStructuredText	(Lore2Sphinx)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Lore%20and%20generating%20reStructuredText%0A%09%28Lore2Sphinx%29&In-Reply-To=%3CCA%2BU%3DzK25eDrMWQAkr9YXUR%3DVyGDqb%3DhKhuDaT8RGtJON%3DHZJkQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="059181.html">
   <LINK REL="Next"  HREF="059196.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Lore and generating reStructuredText	(Lore2Sphinx)</H1>
    <B>Kevin Horn</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Lore%20and%20generating%20reStructuredText%0A%09%28Lore2Sphinx%29&In-Reply-To=%3CCA%2BU%3DzK25eDrMWQAkr9YXUR%3DVyGDqb%3DhKhuDaT8RGtJON%3DHZJkQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Lore and generating reStructuredText	(Lore2Sphinx)">kevin.horn at gmail.com
       </A><BR>
    <I>Mon Mar 25 10:16:08 MDT 2013</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="059181.html">[Twisted-Python] Lore and generating reStructuredText	(Lore2Sphinx)
</A></li>
        <LI>Next message (by thread): <A HREF="059196.html">[Twisted-Python] Lore and generating reStructuredText	(Lore2Sphinx)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59187">[ date ]</a>
              <a href="thread.html#59187">[ thread ]</a>
              <a href="subject.html#59187">[ subject ]</a>
              <a href="author.html#59187">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Mar 23, 2013 at 9:57 PM, Glyph &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> On Mar 21, 2013, at 7:17 AM, Kevin Horn &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">kevin.horn at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> Notice that the node trees look exactly the same.  Now this is not quite
</I>&gt;<i> true, as there's probably some attributes on the actual Python nodes that
</I>&gt;<i> might be used to distinguish them when writing output which aren't
</I>&gt;<i> displayed here...they certainly get rendered into HTML differently.  But
</I>&gt;<i> the point is that the directive itself is GONE and you have no real way of
</I>&gt;<i> recreating it from the node tree.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The directive isn't &quot;gone&quot;; it turns into the attributes on the Python
</I>&gt;<i> nodes that you're talking about.  Presumably that's what's used to render
</I>&gt;<i> it into HTML.  I believe it was Doug Hellmann who indicated to Jean-Paul
</I>&gt;<i> that this was possible.
</I>&gt;<i>
</I>&gt;<i>
</I>While this is true for some built-in docutils directives, there is no
guarantee that this will be the case.  A directive basically says &quot;call a
Python callable according to a certain interface, and put the returned
nodes here.&quot;  If the directive in question uses a callable that returns
nodes with attributes set in a certain way, then you have some breadcrumbs
to figure out how those nodes were created, but there's nothing that says
that the nodes will definitely be set up that way.

For example, you could have a directive that has a ReST list as content,
and changes the items in the list into some kind of link or something.
 maybe it looks something like this (not a real/valid nodetree...):

&lt;list&gt;
    &lt;link&gt;...
    &lt;link&gt;...
    &lt;link&gt;...

How can you tell that this was created by a directive?  You can't, because
it could just as easily have been a list full of links to begin with.

This is why rstgen has it's own node definitions, as it is focused on what
source constructs should be generated, rather than what the docutils output
should look like.

Of course it's possible that the docutils nodes that we would actually need
from the Twisted docs are all introspectible *enough* that you could maybe
just build a docutils doctree and make good enough guesses to create output
which included directives.  It might even be easy to make those guesses.
 But you'd still be guessing, and would fail in the general case.  Also,
you'd still need to write the code to render those nodes into valid ReST,
which is really the hard part of the process.  Also, you'd need to &quot;parse&quot;
everything inside the &quot;directive node&quot; (or whichever node you've decided
represents the directive) in order to turn it into directive arguments,
options and contents.

Reading exarkun's expansion of the notes Itamar posted [1]_ it looks like
another idea proposed was to generate Sphinx (or maybe Sphinx-looking)
output directly from Lore, which could maybe work, but I think would also
be a lot of work, for a lot less benefit.

However, if what you really want is to have a Lore plugin that generates
RestructuredText, then why not have a lore plugin that generates a rstgen
tree, which rstgen will already know how to render into ReST?  Other than
the obvious objection that rstgen isn't done yet, this seems the best
solution to me.  Of course I may be biased. :)

Even if you didn't want to use rstgen itself, though, I still think you're
better off creating some tree-like structure that is *not* a docutils
document tree, and then have that structure render itself into ReST.

BTW, Doug Hellman almost certainly knows more about the internals of
docutils than I do, so maybe he's right and there is a way to (relatively)
easily generate ReST from a docutils tree including the directives.  But I
don't think it is.


&gt;<i> Perhaps you mean &quot;there's no public API for constructing the node tree
</I>&gt;<i> representation of an arbitrary directive&quot;?
</I>&gt;<i>
</I>&gt;<i>
</I>This is certainly true, but I think it doesn't go far enough in describing
the issue



.. [1] <A HREF="https://twistedmatrix.com/trac/wiki/Fellowship2013/Priorities">https://twistedmatrix.com/trac/wiki/Fellowship2013/Priorities</A>

--
Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20130325/95d0bc2b/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="059181.html">[Twisted-Python] Lore and generating reStructuredText	(Lore2Sphinx)
</A></li>
	<LI>Next message (by thread): <A HREF="059196.html">[Twisted-Python] Lore and generating reStructuredText	(Lore2Sphinx)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#59187">[ date ]</a>
              <a href="thread.html#59187">[ thread ]</a>
              <a href="subject.html#59187">[ subject ]</a>
              <a href="author.html#59187">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
