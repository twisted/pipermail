<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] App design / Twisted Logging?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20App%20design%20/%20Twisted%20Logging%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009776.html">
   <LINK REL="Next"  HREF="009779.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] App design / Twisted Logging?</H1>
    <B>Henning.Ramm at mediapro-gmbh.de</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20App%20design%20/%20Twisted%20Logging%3F&In-Reply-To="
       TITLE="[Twisted-Python] App design / Twisted Logging?">Henning.Ramm at mediapro-gmbh.de
       </A><BR>
    <I>Fri Mar 11 05:31:09 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="009776.html">[Twisted-Python] POSTing http requests
</A></li>
        <LI>Next message: <A HREF="009779.html">[Twisted-Python] Re: More on PB Copyable Errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9778">[ date ]</a>
              <a href="thread.html#9778">[ thread ]</a>
              <a href="subject.html#9778">[ subject ]</a>
              <a href="author.html#9778">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Paul, thank you very much for taking the time to answer my confusion.

&gt;&gt;<i> -&gt; Do I need a thread for every copy/move operation (large 
</I>&gt;<i>files via network)?
</I>&gt;<i>
</I>&gt;<i>Nope. That's the beauty of twisted code. I've written this 
</I>&gt;<i>sort of handling
</I>&gt;<i>multiple packet trains many times. Write a protocol.
</I>
Hm, sounds like using FTP and not shutil.move via system's SMB?
Or is there already something better in twisted?

If I'd write my own protocol to wrap shutil.move,
the operation would be blocking because I don't
work on file block level and the protocol doesn't make sense.
I'm not feeling like writing file transfer code on file block level.
Or do you think it would be worth the hassle?

&gt;&gt;<i> Another part reads some XML files (using minidom) and writes 
</I>...
&gt;<i>I ran into long processing problems before. There's a simple 
</I>&gt;<i>solution. Pick
</I>&gt;<i>something convenient such as simply chunking everything up 
</I>&gt;<i>into processing one line at a time.
</I>
So not using DOM but per-line XML handling.
Not that convenient, because I use only small bits
of all the XML data that are spread all over the files,
but I guess it would become better twisted code.

&gt;<i>your constructs using deferreds. And the Flow module allows 
</I>&gt;<i>you to go even
</I>&gt;<i>further than the hard coded version I'm suggesting here. Try 
</I>&gt;<i>reading through
</I>&gt;<i>the Flow module documentation. Just don't get hung up about 
</I>&gt;<i>using it. For my
</I>&gt;<i>purposes, it was usually better just to have the basic concept 
</I>&gt;<i>in mind than to actually use Flow.
</I>
That's perhaps a general problem with twisted: There are great
solutions for everything, but you need to know them in detail
to know which fits your problem. Or you must know how you should
reshape your problem to fit in some twisted solution...

I know twisted &quot;does it all&quot;(TM), but was is &quot;it&quot;? ;-)


&gt;<i>Yep. Frequently, this is where I'd run a deferred() just after 
</I>&gt;<i>sending the request to the known-to-be-slow process.
</I>&gt;<i>Read that section carefully too. Then
</I>&gt;<i>your code gets called back immediately when the process 
</I>&gt;<i>completes. You will
</I>&gt;<i>need to understand deferred's to fully utilize twisted's 
</I>&gt;<i>threading interface,
</I>&gt;<i>and then you'll realize that you probably don't need threads.
</I>
I'm just trying to write a simple directory watcher (I need
this at every corner of my app), Patrick Lauber wrote an answer
to my initial question on that, but that wasn't really what I needed.

It works so far that it calls a deferred callback if it gets a
notify on a new/changed file, but only once; next time I get an
&quot;AlreadyCalledError&quot; - looks like I don't yet understand deferreds.

At the moment it's inherited from pb.Root, because I'll need it to
run remotely sometimes, but perhaps it would be better to use a
service or something else -- it should run &quot;all the time&quot; if not
stopped and call a callback for every file.
I attached the file, perhaps someone can point out my biggest mistakes?


&gt;<i>first but once you get used to it, deferred's seem just well...obvious.
</I>
I hope to get into that higher state of mind soon. ;-)

&gt;<i>As to logging itself...it might be easier to just write your 
</I>&gt;<i>own. Usually I
</I>&gt;<i>haven't been overly thrilled with the mechanical-looking output of
</I>&gt;<i>off-the-shelf loggers and logging is little more than just 
</I>&gt;<i>printing to a file
</I>&gt;<i>anyways, sometimes with some extra (chop it up and reclaim 
</I>&gt;<i>space) features added.
</I>
I enjoyed being able to switch the logging output, e.g. from file to
database or email per config file without the need to go into the code.
I don't feel like re-inventing the wheel, but as Glyph pointed out,
the config syntax of standard logging is just ugly and messy; the
config syntax of log4[j|perl|net] ist much more logical. Perhaps
someone should write a log4twisted module...


Best regards,
Henning Hraban Ramm
S&#252;dkurier Medienhaus / MediaPro
Support/Admin/Development Dept.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dirwatcher.py
Type: application/octet-stream
Size: 2570 bytes
Desc: dirwatcher.py
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20050311/1e803d04/attachment.obj">http://twistedmatrix.com/pipermail/twisted-python/attachments/20050311/1e803d04/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009776.html">[Twisted-Python] POSTing http requests
</A></li>
	<LI>Next message: <A HREF="009779.html">[Twisted-Python] Re: More on PB Copyable Errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9778">[ date ]</a>
              <a href="thread.html#9778">[ thread ]</a>
              <a href="subject.html#9778">[ subject ]</a>
              <a href="author.html#9778">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
