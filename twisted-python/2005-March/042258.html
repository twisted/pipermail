<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] setTimeout in Deferred
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20setTimeout%20in%20Deferred&In-Reply-To=%3C20050310061604.GB15800%40trogdor.home.puzzling.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="042256.html">
   <LINK REL="Next"  HREF="042227.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] setTimeout in Deferred</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20setTimeout%20in%20Deferred&In-Reply-To=%3C20050310061604.GB15800%40trogdor.home.puzzling.org%3E"
       TITLE="[Twisted-Python] setTimeout in Deferred">andrew-twisted at puzzling.org
       </A><BR>
    <I>Wed Mar  9 23:16:04 MST 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="042256.html">[Twisted-Python] setTimeout in Deferred
</A></li>
        <LI>Next message (by thread): <A HREF="042227.html">[Twisted-Python] Twisted Allen-Bradley PLC Protocol
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42258">[ date ]</a>
              <a href="thread.html#42258">[ thread ]</a>
              <a href="subject.html#42258">[ subject ]</a>
              <a href="author.html#42258">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Mar 09, 2005 at 11:53:58PM -0500, Yun Mao wrote:
[...]
&gt;<i> 
</I>&gt;<i> The problem is: many of the result-generating APIs do not have a timeout 
</I>&gt;<i> option, for example, XMLRPC calls, Database queries, etc. What can we do?
</I>&gt;<i> Are you suggesting to modify those APIs? I believe the framework should 
</I>&gt;<i> have something related to that.
</I>
At the moment, the best thing to do is to modify those APIs, yes.
Fundamentally, cancellation needs to be supported by whatever code is
managing the operation that the Deferred is waiting on. 

There may be a better way to do this, see the discussion in
<A HREF="http://twistedmatrix.com/bugs/issue178">http://twistedmatrix.com/bugs/issue178</A> (and the mailing list thread it links
to).  Realistically, not all operations can be cancelled, even though the
clients of those operations may no longer care about the result.  Any
solution needs to have sensible support for this case, and at the moment
setTimeout doesn't.

[...]
&gt;<i> Even with APIs that have the timeout option, there could also be problems 
</I>&gt;<i> when you use them in some form of combination. E.g. I'd write a procedure 
</I>&gt;<i> which involves one DNSLookup and one getPage() sequentially. I could 
</I>&gt;<i> specify timeout value with 2 seconds each, however what I really want the 
</I>&gt;<i> total time to be less than 4 seconds in which case DNS could take longer. 
</I>&gt;<i> It is not terribly hard to implement base on what we have now but it would 
</I>&gt;<i> be nice if there is a framework support that can calculate the correct 
</I>&gt;<i> timers for me.
</I>
Right, what is actually the case there is there are three different
operations:

   1. the DNS lookup
   2. the getPage
   3. your procedure that invokes 1 and 2.

The code responsible for 3 would also be responsible for cancelling 1 and 2
when 3 is cancelled.  No fancy timeout calculations would be required.

Currently we lack ways to cancel in-progress getPage operations (and
probably DNS lookups, I haven't looked), and we certainly lack any standard
APIs or framework for supporting cancellations.  This is the root problem
that needs fixing, rather than timeouts, I think.

&gt;<i> Another form of &quot;cancellation&quot; is also related to the chaining effect. 
</I>&gt;<i> Suppose I want to start following two jobs at the same time:
</I>&gt;<i> 
</I>&gt;<i> 1: A()-&gt;B()-C()
</I>&gt;<i> 2: D()-&gt;E()
</I>&gt;<i> 
</I>&gt;<i> However, I only need the result from any of of them. i.e. as long as one 
</I>&gt;<i> of them is finished, the other thread is useless and should be canceled 
</I>&gt;<i> ASAP to prevent from resource consuming. Right now, I'm using 
</I>&gt;<i> DeferredList, but it doesn't cancel the other thread. A similar 
</I>&gt;<i> requirement is that if either one of them got errback, the other should be 
</I>&gt;<i> canceled.
</I>
Yeah, this would be nice... but of course there's no generic way to kill
another thread in python.  The thread needs to co-operate somehow.

&gt;<i> Anyway, being able to schedule flexible timers is a very big advantage in 
</I>&gt;<i> async programming over multithreading to me. Otherwise, signals, locks, 
</I>&gt;<i> etc could just drive me nuts. However, I still believe in Twisted has the 
</I>&gt;<i> potential to have better framework support.
</I>
Magic bullets welcome ;)

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="042256.html">[Twisted-Python] setTimeout in Deferred
</A></li>
	<LI>Next message (by thread): <A HREF="042227.html">[Twisted-Python] Twisted Allen-Bradley PLC Protocol
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42258">[ date ]</a>
              <a href="thread.html#42258">[ thread ]</a>
              <a href="subject.html#42258">[ subject ]</a>
              <a href="author.html#42258">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
