<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to accept connections faster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20accept%20connections%20faster&In-Reply-To=048A40781D05D143842A596D7C78F40F0540837E%40spi-mail2003.spitech.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009879.html">
   <LINK REL="Next"  HREF="009881.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to accept connections faster</H1>
    <B>Antoine Pitrou</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20accept%20connections%20faster&In-Reply-To=048A40781D05D143842A596D7C78F40F0540837E%40spi-mail2003.spitech.com"
       TITLE="[Twisted-Python] How to accept connections faster">solipsis at pitrou.net
       </A><BR>
    <I>Wed Mar 16 05:44:04 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="009879.html">[Twisted-Python] How to accept connections faster
</A></li>
        <LI>Next message: <A HREF="009881.html">[Twisted-Python] declare  pb.Copyable only once
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9880">[ date ]</a>
              <a href="thread.html#9880">[ thread ]</a>
              <a href="subject.html#9880">[ subject ]</a>
              <a href="author.html#9880">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i>     def connectionMade(self):
</I>&gt;<i>  
</I>&gt;<i>         print &quot;Got a connection from on &quot; + time.asctime()
</I>&gt;<i>         self.transport.write(&quot;Welcome. You are client number : &quot;)
</I>&gt;<i>         print &quot;Looping...&quot;
</I>&gt;<i>         for i in range(10000000):
</I>&gt;<i>             pass
</I>
Why are you doing that ?
An event loop-based server like Twisted is not multithreaded. It means
during the handling of any event (e.g. connectionMade), other events
will not be processed, they will just be queued (by the OS usually).
When you return from the event handler, the Twisted event loop will
resume and process other events.

If you really have heavy calculations and want to keep good latencies,
you have two solutions:
- either slice your calculations in small pieces and call them one after
the other with reactor.callLater(), which ensures that you let other
events slip by
- or defer the calculations to a helper thread or process, with which
you will have to synchronize in the traditional way
(reactor.callFromThread() and reactor.callInThread() may help... I don't
know)

Good luck

Antoine.




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009879.html">[Twisted-Python] How to accept connections faster
</A></li>
	<LI>Next message: <A HREF="009881.html">[Twisted-Python] declare  pb.Copyable only once
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9880">[ date ]</a>
              <a href="thread.html#9880">[ thread ]</a>
              <a href="subject.html#9880">[ subject ]</a>
              <a href="author.html#9880">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
