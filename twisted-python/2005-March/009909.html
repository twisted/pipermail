<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] help with InsecureJelly for	unkown	objects	inclasses--solution
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20help%20with%20InsecureJelly%20for%0A%09unkown%09objects%09inclasses--solution&In-Reply-To=20050317174418.13806.591692018.divmod.quotient.8068%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009905.html">
   <LINK REL="Next"  HREF="009897.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] help with InsecureJelly for	unkown	objects	inclasses--solution</H1>
    <B>Ben Olsen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20help%20with%20InsecureJelly%20for%0A%09unkown%09objects%09inclasses--solution&In-Reply-To=20050317174418.13806.591692018.divmod.quotient.8068%40ohm"
       TITLE="[Twisted-Python] help with InsecureJelly for	unkown	objects	inclasses--solution">bolsen at verio.net
       </A><BR>
    <I>Thu Mar 17 15:03:43 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="009905.html">[Twisted-Python] help with InsecureJelly for unkown	objects	inclasses
</A></li>
        <LI>Next message: <A HREF="009897.html">[Twisted-Python] help with ssl timeout and not reconnecting client	factory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9909">[ date ]</a>
              <a href="thread.html#9909">[ thread ]</a>
              <a href="subject.html#9909">[ subject ]</a>
              <a href="author.html#9909">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Jp, someone else had that suggestion too, and it ended up working 
just fine. Using getStateToCopy and setCopyableState, I can convert a 
pygame.Rect to a tuple before sending, then convert it back when 
receiving. For those curious, the class looks something like this:

class GameState(pb.Copyable, pb.RemoteCopy):
    def __init__(self, id):
        ... define various game state properties ...
        self.ball = Rect([0,0,32,32])

    def getStateToCopy(self):
        ret = self.__dict__.copy()
        del ret['ball']
        ret['balltuple'] = (self.ball.x, self.ball.y, self.ball.w, 
self.ball.h)
        return ret
       
    def setCopyableState(self, state):
        self.ball = Rect(state['balltuple'])
        return self.__dict__

This class is inherited on both server and client. This makes passing 
the pygame.Rect transparent, so no work is required on either the server 
or client side.

Ben

Jp Calderone wrote:

&gt;<i>
</I>&gt;<i>  One approach is to override getStateToCopy (or jellyFor, or getStateToCopyFor, or __getstate__, or several of the above, or all of the above, depending) on your GameState class.  Your implementation can do something like convert the rect to a tuple (or something else easily jellyable).  Similarly, your unjellier can convert the tuple back to a rect.
</I>&gt;<i>
</I>&gt;<i>  Jp
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Twisted-Python mailing list
</I>&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>  
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009905.html">[Twisted-Python] help with InsecureJelly for unkown	objects	inclasses
</A></li>
	<LI>Next message: <A HREF="009897.html">[Twisted-Python] help with ssl timeout and not reconnecting client	factory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9909">[ date ]</a>
              <a href="thread.html#9909">[ thread ]</a>
              <a href="subject.html#9909">[ subject ]</a>
              <a href="author.html#9909">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
