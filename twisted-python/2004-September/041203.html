<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Status of Twisted Tests
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Status%20of%20Twisted%20Tests&In-Reply-To=%3CCB91E540-0DA8-11D9-BF25-000A95A50FB2%40fuhm.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="041202.html">
   <LINK REL="Next"  HREF="041204.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Status of Twisted Tests</H1>
    <B>James Y Knight</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Status%20of%20Twisted%20Tests&In-Reply-To=%3CCB91E540-0DA8-11D9-BF25-000A95A50FB2%40fuhm.net%3E"
       TITLE="[Twisted-Python] Status of Twisted Tests">foom at fuhm.net
       </A><BR>
    <I>Thu Sep 23 15:37:40 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="041202.html">[Twisted-Python] Status of Twisted Tests
</A></li>
        <LI>Next message (by thread): <A HREF="041204.html">[Twisted-Python] Status of Twisted Tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41203">[ date ]</a>
              <a href="thread.html#41203">[ thread ]</a>
              <a href="subject.html#41203">[ subject ]</a>
              <a href="author.html#41203">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sep 23, 2004, at 3:00 PM, Jp Calderone wrote:
&gt;<i> ======================================================================= 
</I>&gt;<i> ========
</I>&gt;<i> ERROR: testOurServerCmdLineClient  
</I>&gt;<i> (twisted.conch.test.test_conch.SSHTransportTestCase)
</I>&gt;<i> ----------------------------------------------------------------------- 
</I>&gt;<i> --------
</I>&gt;<i> Traceback: twisted.trial.unittest.FailTest, unexpectedly lost  
</I>&gt;<i> connection &lt;twisted.conch.test.test_conch.SSHTestServer instance at  
</I>&gt;<i> 0x8dc2a5c&gt;
</I>&gt;<i> [Failure instance: Traceback: twisted.internet.error.ConnectionDone,  
</I>&gt;<i> Connection was closed cleanly.
</I>&gt;<i> ]
</I>&gt;<i> /home/buildbot/run/full2.2/Twisted/twisted/python/log.py:53: 
</I>&gt;<i> callWithLogger
</I>&gt;<i> /home/buildbot/run/full2.2/Twisted/twisted/python/log.py:40: 
</I>&gt;<i> callWithContext
</I>&gt;<i> /home/buildbot/run/full2.2/Twisted/twisted/python/context.py:52: 
</I>&gt;<i> callWithContext
</I>&gt;<i> /home/buildbot/run/full2.2/Twisted/twisted/python/context.py:31: 
</I>&gt;<i> callWithContext
</I>&gt;<i> /home/buildbot/run/full2.2/Twisted/twisted/internet/default.py:521: 
</I>&gt;<i> _doReadOrWrite
</I>&gt;<i> /home/buildbot/run/full2.2/Twisted/twisted/internet/tcp.py:296: 
</I>&gt;<i> connectionLost
</I>&gt;<i> /home/buildbot/run/full2.2/Twisted/twisted/conch/test/test_conch.py: 
</I>&gt;<i> 334:connectionLost
</I>&gt;<i> /home/buildbot/run/full2.2/Twisted/twisted/trial/unittest.py:86:fail
</I>&gt;<i> ----------------------------------------------------------------------- 
</I>&gt;<i> --------
</I>
Since this one appeared to be my fault I investigated it, and found the  
following:
The test is highly sensitive to what order events come back. It wants  
them in the following order:
1) The pipe from the SSH client subprocess has the data &quot;goodbye&quot;  
appear on it.
2) The ssh server's connection to the client gets closed.
3) The ssh client process dies

However, with my buffering change, *sometimes* (not always) the  
following happens instead:
1) The ssh server's connection to the client gets closed.
2) The pipe from the SSH client subprocess has the data &quot;goodbye&quot;  
appear on it.
3) The ssh client process dies

It seems to me that this ordering change could have happened before, as  
there is nothing that guarantees the ordering of data sent over  
different sockets. So, I think this is a bug in the test.

&gt;<i>   Python 2.4:
</I>&gt;<i> testAPileOfThings (twisted.mail.test.test_imap.TLSTestCase) ...
</I>&gt;<i> /home/buildbot/run/full2.4/Twisted/twisted/internet/tcp.py:531:  
</I>&gt;<i> exceptions.RuntimeWarning: startTLS with unwritten buffered data  
</I>&gt;<i> currently doesn't work right. See issue #686. Closing connection.
</I>
*No* idea why this would show up only in Py 2.4...if anyone could help  
out here..

James



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="041202.html">[Twisted-Python] Status of Twisted Tests
</A></li>
	<LI>Next message (by thread): <A HREF="041204.html">[Twisted-Python] Status of Twisted Tests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41203">[ date ]</a>
              <a href="thread.html#41203">[ thread ]</a>
              <a href="subject.html#41203">[ subject ]</a>
              <a href="author.html#41203">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
