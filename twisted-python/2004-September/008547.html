<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Implementing a custom FTP server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Implementing%20a%20custom%20FTP%20server&In-Reply-To=1094500365.23898.2.camel%40petra">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008546.html">
   <LINK REL="Next"  HREF="008548.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Implementing a custom FTP server</H1>
    <B>Andy Gayton</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Implementing%20a%20custom%20FTP%20server&In-Reply-To=1094500365.23898.2.camel%40petra"
       TITLE="[Twisted-Python] Implementing a custom FTP server">andy at thecablelounge.com
       </A><BR>
    <I>Mon Sep  6 21:35:34 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008546.html">[Twisted-Python] Implementing a custom FTP server
</A></li>
        <LI>Next message: <A HREF="008548.html">[Twisted-Python] Implementing a custom FTP server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8547">[ date ]</a>
              <a href="thread.html#8547">[ thread ]</a>
              <a href="subject.html#8547">[ subject ]</a>
              <a href="author.html#8547">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;&gt;<i> On Mon, 2004-09-06 at 14:34 -0500, Jason Stitt wrote:
</I>&gt;&gt;<i>To answer your further questions, I'm not that experienced with 
</I>&gt;&gt;<i>programming the FTP or SFTP protocol (yet...) so I don't know a lot 
</I>&gt;&gt;<i>about the differences. I want to use SFTP eventually for security 
</I>&gt;&gt;<i>reasons but figured that FTP would be simpler to start out with. If 
</I>&gt;&gt;<i>they're that different, perhaps I should start looking into SFTP from 
</I>&gt;&gt;<i>the start.
</I>

Paul Swartz wrote:
&gt;<i> It's easier to talk about the similarities between SFTP and FTP than the
</I>&gt;<i> differences.  The only real similarities between the two protocols are
</I>&gt;<i> 1) the names 2) that they interface to a filesystem.  Other than that,
</I>&gt;<i> they're two entirely different protocols.  The Interfaces that Conch's
</I>&gt;<i> SFTP implementation uses are twisted.conch.interfaces.ISFTPServer and
</I>&gt;<i> ISFTPFile.
</I>
G'dday Jason,

I'm chipping away in this area as well as I find time.  I started with 
SFTP - but also want to support all filelike interfaces in the future.

I've opened up svn access to what I have so far:

svn list <A HREF="svn://twisted.cablelounge.com/welsh/trunk">svn://twisted.cablelounge.com/welsh/trunk</A>

Its very rough .. pretty embarrassing really :) .. hopefully its of some 
help though, and it'd be good to get feedback - particularly as you're 
working with FTP.

The general strategy is to represent your file store independent of any 
protocol.  I've a simple sambaish like file store in file.py.  Then for 
each protocol write an adaptor from your file store objects to the 
interface that protocols expects.  fileadapt.py does this for SFTP. 
realm.py ties it all together.

You can play with it by creating a tap file:

mktap welsh -p 5822 -d /etc/ssh

or something similiar - it's pretty much conch ..

Then create a file 'welshpasswd' to define the accounts on your system 
and place it in the same directory as the tap file.

The file sets up a users variable:

users = {
     loginuserid : {
         nameOfVirtualDirectory  : (uid, gid, realSystemDirectory),
         nameOfVirtualDirectory2 : (uid, gid, realSystemDirectory2),
     }
}

example welshpasswd:
---------------------
users = {
     &quot;andy&quot; : {
             &quot;home&quot;   : ( 509, 509, &quot;/home/andy&quot; ),
     },
     &quot;az&quot; : {
             &quot;home&quot;              : ( 518, 518, &quot;/home/az/incoming&quot; ),
             &quot;giiwa&quot;             : ( 108, 108, &quot;/home/giiwa&quot; ),
             &quot;muddypigrecords&quot;   : (  99,  99, &quot;/home/muddypigrecords&quot; ),
     },
}
----------------------

erg, apologies for the roughness :(

When az logins in, he'll see three directories, home, giiwa and 
muddypigrecords - while working in those directories he'll assume the 
uid and gid and be working in the physical directory as defined above.

 &gt; Itamar Shtull-Trauring wrote:
&gt;<i> 1. Twisted's FTP server has in theory support for generic backends?
</I>&gt;<i> (though it is currently being rewritten, so you could help with that).
</I>
Good luck!  I'm yet to take a look, but wouldn't mind helping out if the 
FTP backend needs a bit of work to be made more accessible.

Andy.











</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008546.html">[Twisted-Python] Implementing a custom FTP server
</A></li>
	<LI>Next message: <A HREF="008548.html">[Twisted-Python] Implementing a custom FTP server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8547">[ date ]</a>
              <a href="thread.html#8547">[ thread ]</a>
              <a href="subject.html#8547">[ subject ]</a>
              <a href="author.html#8547">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
