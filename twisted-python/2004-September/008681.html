<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] TCP wrapper support for twisted servers -	solution !
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20TCP%20wrapper%20support%20for%20twisted%20servers%20-%0A%09solution%20%21&In-Reply-To=4150501B.3090502%40reedflute.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008680.html">
   <LINK REL="Next"  HREF="008683.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] TCP wrapper support for twisted servers -	solution !</H1>
    <B>exarkun at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20TCP%20wrapper%20support%20for%20twisted%20servers%20-%0A%09solution%20%21&In-Reply-To=4150501B.3090502%40reedflute.com"
       TITLE="[Twisted-Python] TCP wrapper support for twisted servers -	solution !">exarkun at divmod.com
       </A><BR>
    <I>Tue Sep 21 13:11:02 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008680.html">[Twisted-Python] TCP wrapper support for twisted servers -	solution !
</A></li>
        <LI>Next message: <A HREF="008683.html">[Twisted-Python] TCP wrapper support for twisted servers	-	solution !
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8681">[ date ]</a>
              <a href="thread.html#8681">[ thread ]</a>
              <a href="subject.html#8681">[ subject ]</a>
              <a href="author.html#8681">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 21 Sep 2004 18:00:27 +0200, Eugene Coetzee &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">projects at reedflute.com</A>&gt; wrote:
&gt;<i> [snip]
</I>&gt;<i> If I &quot;should not rely on transport&quot; (I imagine this refers to IP 
</I>&gt;<i> spoofing) - what is the most reliable way of getting  the client's IP 
</I>&gt;<i> address from inside an instance of http.Request ? I would also like to 
</I>&gt;<i> drop the illegal connection as quickly as possible - much sooner than 
</I>&gt;<i> http.Request.process() happens.
</I>
  Indeed you do want to do it much sooner - I don't think you want to be modifying HTTP code to use TCP wrappers.

  I think you want to modify the protocol factory (Site, in the case of HTTP) to use TCP wrappers.  buildProtocol takes an address argument.  If the factory returns None, the connection is dropped before any bytes are read from it.

  You should be able to implement this as a factory wrapper, too, so that it is useable with any existing factory.  See twisted.protocols.policies for examples of how to do this.

  Jp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008680.html">[Twisted-Python] TCP wrapper support for twisted servers -	solution !
</A></li>
	<LI>Next message: <A HREF="008683.html">[Twisted-Python] TCP wrapper support for twisted servers	-	solution !
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8681">[ date ]</a>
              <a href="thread.html#8681">[ thread ]</a>
              <a href="subject.html#8681">[ subject ]</a>
              <a href="author.html#8681">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
