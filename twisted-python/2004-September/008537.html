<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Performance issue in reactor.callLater
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Performance%20issue%20in%20reactor.callLater&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008581.html">
   <LINK REL="Next"  HREF="008538.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Performance issue in reactor.callLater</H1>
    <B>Stefan Behnel</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Performance%20issue%20in%20reactor.callLater&In-Reply-To="
       TITLE="[Twisted-Python] Performance issue in reactor.callLater">behnel_ml at gkec.informatik.tu-darmstadt.de
       </A><BR>
    <I>Mon Sep  6 09:43:04 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008581.html">[Twisted-Python] Re: Implementing a custom FTP server
</A></li>
        <LI>Next message: <A HREF="008538.html">[Twisted-Python] Performance issue in reactor.callLater
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8537">[ date ]</a>
              <a href="thread.html#8537">[ thread ]</a>
              <a href="subject.html#8537">[ subject ]</a>
              <a href="author.html#8537">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everyone!

I'm running a network simulator on top of Twisted and that made me realize a heavy performance bottleneck.

When I'm simulating a larger number of network nodes each of which uses two or three delayed calls, that adds up and then adding and cancelling calls becomes /really/ expensive. We are talking about ~ one millisecond per add and even a few milliseconds per cancel.

The problem is the implementation that uses a linear list. A heap would be /much/ more appropriate. But especially the cancel could be spead up by factors by not actually removing the object but just setting a flag that it was canceled. The canceled DelayedCall objects would then be filtered out when looking for the next delay.

I already implemented that in my simulator when I was trying to eliminate the calls to dc.cancel(). Works perfectly well, but I'd rather see Twisted scale better itself.

Are there any objections to replacing the current implementation?

Otherwise I'd just send a patch to the list as soon as I have integrated my version into the respective classes.

Stefan


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008581.html">[Twisted-Python] Re: Implementing a custom FTP server
</A></li>
	<LI>Next message: <A HREF="008538.html">[Twisted-Python] Performance issue in reactor.callLater
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8537">[ date ]</a>
              <a href="thread.html#8537">[ thread ]</a>
              <a href="subject.html#8537">[ subject ]</a>
              <a href="author.html#8537">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
