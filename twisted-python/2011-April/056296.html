<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Where is buildslave configuration?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Where%20is%20buildslave%20configuration%3F&In-Reply-To=%3C20110404195542.1992.1439171256.divmod.xquotient.183%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="056294.html">
   <LINK REL="Next"  HREF="056297.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Where is buildslave configuration?</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Where%20is%20buildslave%20configuration%3F&In-Reply-To=%3C20110404195542.1992.1439171256.divmod.xquotient.183%40localhost.localdomain%3E"
       TITLE="[Twisted-Python] Where is buildslave configuration?">exarkun at twistedmatrix.com
       </A><BR>
    <I>Mon Apr  4 13:55:42 MDT 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="056294.html">[Twisted-Python] Where is buildslave configuration?
</A></li>
        <LI>Next message (by thread): <A HREF="056297.html">[Twisted-Python] Where is buildslave configuration?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56296">[ date ]</a>
              <a href="thread.html#56296">[ thread ]</a>
              <a href="subject.html#56296">[ subject ]</a>
              <a href="author.html#56296">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01:59 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">techtonik at gmail.com</A> wrote:
&gt;<i>On Mon, Apr 4, 2011 at 4:15 PM, Andrew Bennetts &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">andrew at bemusement.org</A>&gt; 
</I>&gt;<i>wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>So your problem isn't the version string, but that running bin/trial 
</I>&gt;&gt;<i>in
</I>&gt;&gt;<i>your Twisted checkout is finding the wrong version of Twisted?
</I>&gt;<i>
</I>&gt;<i>Exactly. But wrong version string was the cause of troubles with 
</I>&gt;<i>debugging it.
</I>&gt;&gt;<i>Also, rather than editing random library files, why not just look at 
</I>&gt;&gt;<i>the
</I>&gt;&gt;<i>output of python -v bin/trial?
</I>&gt;<i>
</I>&gt;<i>I forgot about it, so I've just used python bin/trial --version
</I>&gt;<i>..and it showed me the version..
</I>&gt;<i>..it was 11.0.0..
</I>&gt;<i>..but 11.0.0 is the released version I've installed..
</I>&gt;<i>..and the version in the trunk/ (i.e. my working copy)..
</I>&gt;<i>..so I decided to modify these versions to differentiate copies 
</I>&gt;<i>somehow..
</I>&gt;<i>..because it was 1 minute fix..
</I>&gt;<i>..because I forgot about python -v bin/trial..
</I>&gt;<i>..which is 1 second test..
</I>&gt;<i>..so I've looked up where the script reads version..
</I>&gt;<i>..and it appeared that it imports copyright.py..
</I>&gt;<i>..which in turn imports version from _version.py..
</I>&gt;<i>..so I've modified _version.py in my working copy..
</I>&gt;<i>..and got the same 11.0.0 version in bin/trial --version...
</I>&gt;<i>..&quot;AHA!&quot;, - said I to myself..
</I>&gt;<i>..but decided to check ..
</I>&gt;<i>..&quot;just in case&quot;..
</I>&gt;<i>..because I like to be sure..
</I>&gt;<i>..and because you never know who listens to your trac.core.Component..
</I>&gt;<i>..or zope.interface..
</I>&gt;<i>..or whatever..
</I>&gt;<i>..unless you run it..
</I>&gt;<i>..so, I've modified _version.py in my installation..
</I>&gt;<i>..and..
</I>&gt;<i>..guess that?..
</I>&gt;<i>..still got the 11.0.0..
</I>&gt;<i>..$%#!, - said I to myself..
</I>&gt;<i>..[$%#!] * 3, - said I to myself three minutes later..
</I>&gt;<i>..or five..
</I>&gt;<i>..or more..
</I>&gt;<i>..I don't remember..
</I>&gt;<i>..but if took less than three minutes, I wouldn't be writing this 
</I>&gt;<i>letter..
</I>&gt;<i>..so..
</I>&gt;<i>..I compared source trees..
</I>&gt;<i>..and found..
</I>&gt;<i>..that there is an extra version assignment..
</I>&gt;<i>..at the end of copyright.py
</I>&gt;<i>
</I>&gt;<i>So, I wasted some more time (I won't tell how much) to find where is
</I>&gt;<i>this funny piece of code in release toolchain that inserts this
</I>&gt;<i>version string? After looking at some note that .msi is downloaded
</I>&gt;<i>from buildbot, I though &quot;No, that's impossible&quot;, but, alas, it was
</I>&gt;<i>there. Not even open sourced as it appears.
</I>&gt;<i>
</I>&gt;<i>So, now I am curious why this copyright.py patch is required?
</I>
It's required because of restrictions on what version you are allowed to 
use when building an MSI.  These rules are codified in 
distutils.version.StrictVersion:

    &gt;&gt;&gt; from distutils.version import StrictVersion
    &gt;&gt;&gt; from twisted import __version__
    &gt;&gt;&gt; StrictVersion(__version__)
    Traceback (most recent call last):
      File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
      File &quot;/usr/lib/python2.6/distutils/version.py&quot;, line 40, in 
__init__
        self.parse(vstring)
      File &quot;/usr/lib/python2.6/distutils/version.py&quot;, line 107, in parse
        raise ValueError, &quot;invalid version number '%s'&quot; % vstring
    ValueError: invalid version number '11.0.0+r31541'
    &gt;&gt;&gt; StrictVersion('11.0.0pre1')
    Traceback (most recent call last):
      File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
      File &quot;/usr/lib/python2.6/distutils/version.py&quot;, line 40, in 
__init__
        self.parse(vstring)
      File &quot;/usr/lib/python2.6/distutils/version.py&quot;, line 107, in parse
        raise ValueError, &quot;invalid version number '%s'&quot; % vstring
    ValueError: invalid version number '11.0.0pre1'

The build step is there to ensure the version is something bdist_msi 
will accept.  It's an unintentional side-effect that the change survives 
all the way through to the built page.
&gt;<i>My ultimate goal is to run a complete build of Twisted will all tests
</I>&gt;<i>that results in .msi installer on my Vista machine - the machine with
</I>&gt;<i>operating system that was in the list of NeededBuildSlaves 30 minutes
</I>&gt;<i>ago. =)
</I>
Coincidentally, I noticed that page was somewhat outdated and updated 
it.  If someone would *like* to contribute Vista slaves, that's 
completely fine, but I think the Twisted project will be happy enough if 
we have to skip over Vista and just pay attention to Windows 7.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="056294.html">[Twisted-Python] Where is buildslave configuration?
</A></li>
	<LI>Next message (by thread): <A HREF="056297.html">[Twisted-Python] Where is buildslave configuration?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56296">[ date ]</a>
              <a href="thread.html#56296">[ thread ]</a>
              <a href="subject.html#56296">[ subject ]</a>
              <a href="author.html#56296">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
