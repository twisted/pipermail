<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] 100% CPU on high opened descriptors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20100%25%20CPU%20on%20high%20opened%20descriptors&In-Reply-To=%3C82B5C858-6C53-489E-B9A1-547B32125BD5%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="056409.html">
   <LINK REL="Next"  HREF="056424.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] 100% CPU on high opened descriptors</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20100%25%20CPU%20on%20high%20opened%20descriptors&In-Reply-To=%3C82B5C858-6C53-489E-B9A1-547B32125BD5%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] 100% CPU on high opened descriptors">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Apr 26 15:30:41 MDT 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="056409.html">[Twisted-Python] 100% CPU on high opened descriptors
</A></li>
        <LI>Next message (by thread): <A HREF="056424.html">[Twisted-Python] 100% CPU on high opened descriptors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56410">[ date ]</a>
              <a href="thread.html#56410">[ thread ]</a>
              <a href="subject.html#56410">[ subject ]</a>
              <a href="author.html#56410">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Apr 26, 2011, at 4:34 PM, Ray Cote wrote:

&gt;<i> ----- Original Message -----
</I>&gt;&gt;<i> From: &quot;Luke Marsden&quot; &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">luke-lists at hybrid-logic.co.uk</A>&gt;
</I>&gt;&gt;<i> To: &quot;Twisted general discussion&quot; &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&gt;
</I>&gt;&gt;<i> Sent: Tuesday, April 26, 2011 2:08:40 PM
</I>&gt;&gt;<i> Subject: Re: [Twisted-Python] 100% CPU on high opened descriptors
</I>&gt;&gt;<i> On Tue, 2011-04-26 at 17:42 +0200, Juan Antonio Iba√±ez Santorum wrote:
</I>&gt;&gt;&gt;<i> Hello!
</I>&gt;&gt;&gt;<i>   I have a Linux box serving my twisted app. All works ok except
</I>&gt;&gt;&gt;<i> after some days running (where I can see my CPU going to 100%). I
</I>&gt;&gt;&gt;<i> saw
</I>&gt;&gt;&gt;<i> that CPU goes 100% usage when the app reaches to 1024 opened
</I>&gt;&gt;&gt;<i> descriptors (sockets).
</I>&gt;<i> 
</I>&gt;<i> I assume that using a reverse proxy (Apache, nginx, etc.) in front of Twisted removes this problem? 
</I>&gt;<i> (or at least displaces it from being Twisted's problem to being the proxies problem.)
</I>&gt;<i> 
</I>&gt;<i> Is it recommended to always run Twisted behind a proxy?
</I>
No.  It's recommended to fix bugs in Twisted that affect you :).  And besides, this problem is not specific to HTTP; it affects any Twisted service that runs on a port, so there are lots of uses of Twisted where you can't run Twisted behind a proxy.

Plus, this affects clients as well; if you have a twisted spidering application, your client connections could get into this same state.  It's possible to handle this sort of attack without any changes to Twisted, by carefully monitoring the number of connections you have open.

Of course most people just crank up their ulimits and forget about it.

&gt;<i> We've been doing that simply to offload delivery to the final client, but I'm thinking it may have a more general need.
</I>
If you have to do it anyway then the discussion is somewhat academic, isn't it? :)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20110426/d23de324/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="056409.html">[Twisted-Python] 100% CPU on high opened descriptors
</A></li>
	<LI>Next message (by thread): <A HREF="056424.html">[Twisted-Python] 100% CPU on high opened descriptors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56410">[ date ]</a>
              <a href="thread.html#56410">[ thread ]</a>
              <a href="subject.html#56410">[ subject ]</a>
              <a href="author.html#56410">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
