<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Understanding deferred and error handling
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Understanding%20deferred%20and%20error%20handling&In-Reply-To=%3CBANLkTinCMP6jG8sSDC3yJBfW%2BUVwryKYNQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="056380.html">
   <LINK REL="Next"  HREF="056382.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Understanding deferred and error handling</H1>
    <B>Tristan Seligmann</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Understanding%20deferred%20and%20error%20handling&In-Reply-To=%3CBANLkTinCMP6jG8sSDC3yJBfW%2BUVwryKYNQ%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Understanding deferred and error handling">mithrandi at mithrandi.net
       </A><BR>
    <I>Wed Apr 20 04:44:12 MDT 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="056380.html">[Twisted-Python] Understanding deferred and error handling
</A></li>
        <LI>Next message (by thread): <A HREF="056382.html">[Twisted-Python] Understanding deferred and error handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56381">[ date ]</a>
              <a href="thread.html#56381">[ thread ]</a>
              <a href="subject.html#56381">[ subject ]</a>
              <a href="author.html#56381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Apr 20, 2011 at 12:15 PM, Jason Rennie &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jrennie at gmail.com</A>&gt; wrote:
&gt;&gt;<i>
</I>&gt;&gt;<i>     def log_error(failure):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         log.err(failure.printTraceback())
</I>&gt;&gt;<i>         return failure
</I>&gt;&gt;<i>     d.addErrback(log_error)
</I>&gt;&gt;<i>     d.addBoth(_stop)
</I>&gt;<i>
</I>&gt;<i> Use d.addCallbacks(_stop, log_error) instead of addBoth/addErrback.  Also,
</I>&gt;<i> you probably want &quot;log.err(failure.getTraceback())&quot; instead of
</I>&gt;<i> &quot;log.err(failure.printTraceback())&quot;.  printTraceback does not return a
</I>&gt;<i> meaningful value IIUC.
</I>
Actually, you just want:

    log.err(failure)

I don't think there's anything particularly wrong with using
addErrback / addBoth in that way, either. If there is an error, you
want to log it; and then regardless of whether there was an error or
not, and whether the attempt to log the error failed, you want to stop
the reactor; this is exactly what the addErrback/addBoth code achieves
in this case. The equivalent synchronous code looks something like:

try:
    remote_call()
except:
    logTheError()
finally:
    reactor.stop()

The reason you don't get a traceback in this case is that there isn't
one; the exception is created directly as a result of parsing the
response from the HTTP server, instead of being thrown in code lower
down the stack and caught higher up. Unfortunately this situation is
quite common in asynchronous code; there is no direct equivalent of a
&quot;stack trace&quot; for asynchronous code, so often you have a Failure that
carries no indication of where the operation that failed was
initiated, although turning on Deferred debugging (see
Deferred.setDebugging) can sometimes be helpful in these situations.
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="056380.html">[Twisted-Python] Understanding deferred and error handling
</A></li>
	<LI>Next message (by thread): <A HREF="056382.html">[Twisted-Python] Understanding deferred and error handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56381">[ date ]</a>
              <a href="thread.html#56381">[ thread ]</a>
              <a href="subject.html#56381">[ subject ]</a>
              <a href="author.html#56381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
