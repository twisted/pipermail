<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted ldaptor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted%20ldaptor&In-Reply-To=%3C5549176E.10000%40otpme.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="061917.html">
   <LINK REL="Next"  HREF="029448.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted ldaptor</H1>
    <B>the2nd</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted%20ldaptor&In-Reply-To=%3C5549176E.10000%40otpme.org%3E"
       TITLE="[Twisted-Python] twisted ldaptor">the2nd at otpme.org
       </A><BR>
    <I>Tue May  5 13:18:06 MDT 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="061917.html">[Twisted-Python] twisted ldaptor
</A></li>
        <LI>Next message (by thread): <A HREF="029448.html">[Twisted-Python] Urgent - reactor is not working out of a sudden
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61918">[ date ]</a>
              <a href="thread.html#61918">[ thread ]</a>
              <a href="subject.html#61918">[ subject ]</a>
              <a href="author.html#61918">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am 03.05.2015 um 14:03 schrieb bret curtis:
&gt;<i> Hello there,
</I>&gt;<i>
</I>&gt;<i> if you wish to make a pull request, file a bug report or ask Ldaptor 
</I>&gt;<i> specific questions, you can contact the developer directly here:
</I>&gt;<i> <A HREF="https://github.com/twisted/ldaptor/issues">https://github.com/twisted/ldaptor/issues</A>
</I>&gt;<i>
</I>&gt;<i> Not everyone who works on Ldaptor is a member of this mailing list.
</I>
Okay. I was not sure if it's okay to ask questions via the issue tracker. :)

&gt;<i>
</I>&gt;<i> I'll try to answer inline:
</I>&gt;<i>
</I>&gt;<i> On Sat, May 2, 2015 at 12:37 PM, &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">the2nd at otpme.org</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">the2nd at otpme.org</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     i'm currently investigating how to add ldap server support to
</I>&gt;<i>     OTPme (<A HREF="https://www.otpme.org">https://www.otpme.org</A>) as i want to extend it to be a
</I>&gt;<i>     complete authentication/authorization system including some kind
</I>&gt;<i>     of directory service. so i started working on integration with
</I>&gt;<i>     ldaptor. my first problem, adding search support, is partly solved
</I>&gt;<i>     now. i've checked ldifftree.py and after some debugging i got a
</I>&gt;<i>     search() method that is able to do an indexed search of OTPme's
</I>&gt;<i>     directory (which is not in svn yet) which allows fast search
</I>&gt;<i>     results for a directory with more than 2048 users.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Congratulations! :) How are you going about this? Are these additions 
</I>&gt;<i> backwards compatible with OpenLDAP? Are you also writing test-cases to 
</I>&gt;<i> cover these?
</I>
Thanks. :) But its still in an early stage.

Currently the ldap support is implemented on top of OTPme's users, 
groups, units etc. and will be read-only.

I've decided to implement it as OTPme extensions e.g. a &quot;base&quot; extension 
that handles object classes like &quot;dcObject&quot;, &quot;organizationalUnit&quot;, 
&quot;inetOrgPerson&quot; etc. and an &quot;posix&quot; extension for &quot;posixAccount&quot;, 
&quot;posixGroup&quot; and so on. the extensions will also do things like 
uidNumber/gidNumber allocation etc.

An extension also automatically adds the needed objectClass if the 
attribute the admin adds to a user needs it. if the admin disables an 
extension (e.g. posix or maybe samba later) for a user the corresponding 
ldap attributes are no longer visible via ldap(tor) but not removed from 
the user so they can be re-enabled if needed. To resolve the attribute 
&lt;&gt; objectClass dependencies i've written a simple (and maybe incomplete 
;)) parser that can read openldap's schema files using 
<A HREF="http://www.python-ldap.org/doc/html/ldap-schema.html#module-ldap.schema">http://www.python-ldap.org/doc/html/ldap-schema.html#module-ldap.schema</A>

The OTPme specific attributes (tokens, timeout values etc.) are not 
implemented as ldap objects/attributes. The main reason for this is that 
i didn't had any plan about the features that OTPme will have as i 
started writing it a few months ago. I decided to learn python as my 
first language in december last year and just wanted write anything 
useful. it all started with the goal to implement 
<A HREF="http://motp.sourceforge.net/">http://motp.sourceforge.net/</A> in python. :)

So atm i haven't done anything more than writing a class (staring at the 
magic of ldiftree.py and friends ;)) that gets all needed objects, 
attributes etc. from the OTPme backend as ldif and that can do an 
indexed search using an OTPme function. This class basically works with 
ldaptor. The OTPme backend is implemented using flat files with some 
in-memory caching feature. It also supports AES encryption and i started 
writing an master/slave synchronization for it that should be later used 
to add some kind of cluster support to OTPme.

Maybe i'll implement all OTPme objects (tokens etc.) as ldap 
objects/attributes some day because this would make it possible to also 
get them from an external ldap server like openldap. But this also means 
that i need to create a OTPme schema that can be used with an ldap 
server like openldap. so i'm not sure if i'll go this road because not 
everyone can/wants to add a schema extension. Another idea would be to 
synchronize users from e.g. openldap and add them to OTPme/ldaptor. But 
all of this is not on my current todo.

Continuous integration is on my todo but as there are so many things to 
learn when one wants to learn wrinting software i haven't found the time 
yet.

&gt;<i>     but as this is just a start there will be more problems to solve i
</I>&gt;<i>     guess.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> There always are, when I first started using Ldaptor, startTLS was 
</I>&gt;<i> broken which was a requirement for me to do any work with it.
</I>&gt;<i>
</I>&gt;<i>     one issue i have is that an ldapsearch against ldaptor which
</I>&gt;<i>     requests just some attributes instead of all always returns all
</I>&gt;<i>     object attributes.
</I>&gt;<i>     for example the ldapsearch below returns the complete ldif of each
</I>&gt;<i>     found user in ldaptor (tested also with ldiftree.py):
</I>&gt;<i>     ldapsearch -H <A HREF="ldap://localhost:8080">ldap://localhost:8080</A> -b
</I>&gt;<i>     &quot;ou=users,dc=domain,dc=intern&quot; -w abcd -x '(uid=*)' givenName
</I>&gt;<i>     Running the same search against my openldap server it returns just
</I>&gt;<i>     the dn and givenName attributes of each found user.
</I>&gt;<i>     Is this a missing feature or do i just miss something in my db class?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Please file an issue on github with an example (ldif entries in a txt 
</I>&gt;<i> file would work) that can be used to test with a real OpenLDAP server. 
</I>&gt;<i> Then the ldapsearch like you provided above and a snippit of your 
</I>&gt;<i> ldaptor code so we can try to reproduce it.
</I>
Done: <A HREF="https://github.com/twisted/ldaptor/issues/38">https://github.com/twisted/ldaptor/issues/38</A>

&gt;<i>     another important part i haven't looked at yet is how to implement
</I>&gt;<i>     authentication. as OTPme focus on OTPs i dont want to add any user
</I>&gt;<i>     passwords to the ldap tree. the smoothest solution would be to get
</I>&gt;<i>     username+OTP from ldaptor to do authentication. maybe you can give
</I>&gt;<i>     me some hints in the right direction? :)
</I>&gt;<i>
</I>&gt;<i> Another issue/question for github, there are others that have spent 
</I>&gt;<i> more time in this area of the codebase.
</I>&gt;<i>
</I>
Done: <A HREF="https://github.com/twisted/ldaptor/issues/39">https://github.com/twisted/ldaptor/issues/39</A>

&gt;<i>
</I>&gt;<i>     and the last question for now is related the licensing. OTPme is
</I>&gt;<i>     licensed under GPLv2. do i run into any licensing issues when
</I>&gt;<i>     using ldaptor with OTPme?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Ldaptor is MIT/Expat license, if you would like to commit code then 
</I>&gt;<i> that too must be MIT/Expat otherwise it won't be accepted. As for 
</I>&gt;<i> using Ldaptor to talk with OTPme, there shouldn't be a license problem 
</I>&gt;<i> as they are two separate applications/services. What exactly is your 
</I>&gt;<i> concern there?
</I>
I dont have any special concern. I'm just new to all of this and wanted 
to make sure it's okay to use ldaptor it with an GPL'ed software.

And if i ever will (be able to ;)) commit any code to ldaptor i'm fine 
with the MIT/Expat license. :)

&gt;<i>
</I>&gt;<i>     regards
</I>&gt;<i>     the2nd
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Bret
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20150505/24eed37e/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="061917.html">[Twisted-Python] twisted ldaptor
</A></li>
	<LI>Next message (by thread): <A HREF="029448.html">[Twisted-Python] Urgent - reactor is not working out of a sudden
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61918">[ date ]</a>
              <a href="thread.html#61918">[ thread ]</a>
              <a href="subject.html#61918">[ subject ]</a>
              <a href="author.html#61918">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
