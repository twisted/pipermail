<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] trial internals help?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20trial%20internals%20help%3F&In-Reply-To=%3C20150519113113.21155.1818683239.divmod.xquotient.21%40top%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029498.html">
   <LINK REL="Next"  HREF="029500.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] trial internals help?</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20trial%20internals%20help%3F&In-Reply-To=%3C20150519113113.21155.1818683239.divmod.xquotient.21%40top%3E"
       TITLE="[Twisted-Python] trial internals help?">exarkun at twistedmatrix.com
       </A><BR>
    <I>Tue May 19 05:31:13 MDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="029498.html">[Twisted-Python] trial internals help?
</A></li>
        <LI>Next message: <A HREF="029500.html">[Twisted-Python] Multiple plugins in &quot;twistd&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29499">[ date ]</a>
              <a href="thread.html#29499">[ thread ]</a>
              <a href="subject.html#29499">[ subject ]</a>
              <a href="author.html#29499">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10:50 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">wsanchez at wsanchez.net</A> wrote:
&gt;<i>  I took a stab at porting trial to use twisted.logger 
</I>&gt;<i>(<A HREF="http://tm.tl/7863">http://tm.tl/7863</A>) but I have a test failing:
</I>&gt;<i>
</I>&gt;<i>twisted.trial.test.test_reporter.TestErrorReporting.test_hiddenException
</I>&gt;<i>
</I>&gt;<i>  I don&#8217;t quite know what that test is doing.  I added some additional 
</I>&gt;<i>output on my branch (branches/log-trial-7863) but that didn&#8217;t make me 
</I>&gt;<i>any smarter.
</I>&gt;<i>
</I>&gt;<i>  Is anyone familiar with this code able to explain how I may have 
</I>&gt;<i>broken it?
</I>&gt;<i>
</I>&gt;<i>         -wsv
</I>
Hi Wilfredo,

This looks like a test for the logging done in the implementation of 
`IReactorTime`.

The test runs another test, `testHiddenException`. 
`testHiddenException` uses `reactor.callLater` to run a function that 
raises an exception.  Then `testHiddenException` does a horrible thing 
to the reactor to make the delayed call run (and thus raise the 
exception which it then expects to be attributed to the running test as 
an error).  Then it *also* fails the test - I suppose because at some 
point there was a bug where &quot;failure&quot; results interfered with &quot;error&quot; 
results somehow.

I don't see how this test is particularly different from one like:

    def test_hiddenException(self):
        try:
            raise SomeException()
        except:
            log.deferr()
        self.fail(&quot;something else&quot;)

Does your branch need to port the `IReactorTime` exception handling to 
the new logging API?  Or maybe it needs to port the way Trial itself 
integrates with the logging system so that it can observe failures like 
this one?

Jean-Paul

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029498.html">[Twisted-Python] trial internals help?
</A></li>
	<LI>Next message: <A HREF="029500.html">[Twisted-Python] Multiple plugins in &quot;twistd&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29499">[ date ]</a>
              <a href="thread.html#29499">[ thread ]</a>
              <a href="subject.html#29499">[ subject ]</a>
              <a href="author.html#29499">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
