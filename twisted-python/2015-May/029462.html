<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Fwd: Adding callbacks using loop variables
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Fwd%3A%20Adding%20callbacks%20using%20loop%20variables&In-Reply-To=%3CCAMcKhMSL7f%3DZbadgyZx%3DqQv2SCzAw4u81WQcseoUviN37g%2BB9w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029461.html">
   <LINK REL="Next"  HREF="029463.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Fwd: Adding callbacks using loop variables</H1>
    <B>Tristan Seligmann</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Fwd%3A%20Adding%20callbacks%20using%20loop%20variables&In-Reply-To=%3CCAMcKhMSL7f%3DZbadgyZx%3DqQv2SCzAw4u81WQcseoUviN37g%2BB9w%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Fwd: Adding callbacks using loop variables">mithrandi at mithrandi.net
       </A><BR>
    <I>Wed May  6 04:15:44 MDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="029461.html">[Twisted-Python] Fwd: Adding callbacks using loop variables
</A></li>
        <LI>Next message: <A HREF="029463.html">[Twisted-Python] Fwd: Adding callbacks using loop variables
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29462">[ date ]</a>
              <a href="thread.html#29462">[ thread ]</a>
              <a href="subject.html#29462">[ subject ]</a>
              <a href="author.html#29462">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6 May 2015 at 10:26, Saoili &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">saoili at gmail.com</A>&gt; wrote:
&gt;<i> Eg. code BEFORE
</I>&gt;<i>             for loop_var in a_dict['loop_vars']:
</I>&gt;<i>                 d = self.returns_a_deferred(loop_var[&quot;x&quot;])
</I>&gt;<i>                 d.addCallback(
</I>&gt;<i>                     lambda ret_val: self.do_another_thing(
</I>&gt;<i>                         other_param, loop_var.copy(), ret_val
</I>&gt;<i>                     )
</I>&gt;<i>                 )
</I>&gt;<i>                 _dlist.append(d)
</I>&gt;<i>             return defer.DeferredList(_dlist)
</I>&gt;<i>
</I>&gt;<i> Eg. code AFTER
</I>&gt;<i>             def other_func(ret_val, other_param, loop_var):
</I>&gt;<i>                 return self.do_other_thing(
</I>&gt;<i>                     other_param, loop_var, ret_val
</I>&gt;<i>                 )
</I>&gt;<i>
</I>&gt;<i>             for loop_var in a_dict['loop_vars']:
</I>&gt;<i>                 d = self.returns_a_deferred(loop_var[&quot;x&quot;])
</I>&gt;<i>                 d.addCallback(other_func, other_param, loop_var)
</I>&gt;<i>                 _dlist.append(d)
</I>&gt;<i>             return defer.DeferredList(_dlist)
</I>
There's another common trick for dealing with this, that relies on the
fact that default argument values are evaluated when the lambda
expression itself (not the body of the lambda!) is initially
evaluated; basically, just add an extra parameter with a default value
of the loop variable. For example:

             for loop_var in a_dict['loop_vars']:
                 d = self.returns_a_deferred(loop_var[&quot;x&quot;])
                 d.addCallback(
                     lambda ret_val, loop_var=loop_var: self.do_another_thing(
                         other_param, loop_var.copy(), ret_val
                     )
                 )
                 _dlist.append(d)
             return defer.DeferredList(_dlist)

However, separating the code out into a separate function may serve to
make the code clearer.
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029461.html">[Twisted-Python] Fwd: Adding callbacks using loop variables
</A></li>
	<LI>Next message: <A HREF="029463.html">[Twisted-Python] Fwd: Adding callbacks using loop variables
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29462">[ date ]</a>
              <a href="thread.html#29462">[ thread ]</a>
              <a href="subject.html#29462">[ subject ]</a>
              <a href="author.html#29462">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
