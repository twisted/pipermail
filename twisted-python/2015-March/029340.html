<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Unhandled Error in python 3 test suite
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Unhandled%20Error%20in%20python%203%20test%20suite&In-Reply-To=%3C488A5704-11F1-47D9-8F3C-9AB988CBD0E2%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029338.html">
   <LINK REL="Next"  HREF="029315.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Unhandled Error in python 3 test suite</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Unhandled%20Error%20in%20python%203%20test%20suite&In-Reply-To=%3C488A5704-11F1-47D9-8F3C-9AB988CBD0E2%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Unhandled Error in python 3 test suite">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Mar 30 14:28:50 MDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="029338.html">[Twisted-Python] Unhandled Error in python 3 test suite
</A></li>
        <LI>Next message: <A HREF="029315.html">[Twisted-Python] JOB: Senior and Lead Engineers | ClusterHQ |	Bristol, UK | relocation offered
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29340">[ date ]</a>
              <a href="thread.html#29340">[ thread ]</a>
              <a href="subject.html#29340">[ subject ]</a>
              <a href="author.html#29340">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Mar 30, 2015, at 3:52 AM, Adi Roiban &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">adi at roiban.ro</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> On 23 March 2015 at 15:29, Tristan Seligmann &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mithrandi at mithrandi.net</A>&gt; wrote:
</I>&gt;&gt;<i> On 23 March 2015 at 16:25, HawkOwl &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">hawkowl at atleastfornow.net</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> It's not really a bug -- it's just that the stderr isn't being captured like real Trial does. Twisted will reraise errors so they show up in logs, but will actually handle them (I think, anyway). The traceback formatting just says it's an unhandled error. That is, it was handled by Twisted, but it was unhandled by user code, and generated an errback or such.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Note that &quot;Unhandled error in Deferred&quot; is the default log message for
</I>&gt;&gt;<i> log.err, and a lot (most?) of the code that logs a failure calls
</I>&gt;&gt;<i> log.err without passing a different message.
</I>&gt;<i> 
</I>&gt;<i> I have no idea what you are talking about :(
</I>&gt;<i> 
</I>&gt;<i> I run deferred related tests using nose and standard pyunit 2.7.
</I>&gt;<i> Each time I see an  &quot;Unhandled error in Deferred&quot;  message in the log
</I>&gt;<i> it means that my test is poorly written and
</I>&gt;<i> does not make an explicit call to check the deferred value.. for
</I>&gt;<i> example using something similar to self.successResultOf()
</I>&gt;<i> 
</I>&gt;<i> If you say that it is ok to ignore those errors, fine by me.
</I>
If you run a test under trial that logs a traceback (whether the result of an unhandled error in a Deferred or any other `log.err&#180; call), the test will fail.

If you run a test under trial that logs a traceback and you call self.flushLoggedErrors() to clear that logged error, then it won't fail.

However, twisted cannot control what your other test runners do, so maybe nose (and definitely stdlib unittest) don't think logged errors are sufficient to fail a test.  Right now lots of tests on the py3 builder with the primitive test runner are spewing tracebacks which are _supposed_ to be logged, and which are properly being caught and &quot;flushed&quot;.  When we switch to trial these will show up only in test.log and not on stderr.

&gt;<i> I think that soon we should have trial on py3 and we will no longer
</I>&gt;<i> need to worry about this primitive test runner.
</I>

YES.  Thanks to HawkOwl for all her recent work which is going towards making this possible soon!!!

-glyph


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029338.html">[Twisted-Python] Unhandled Error in python 3 test suite
</A></li>
	<LI>Next message: <A HREF="029315.html">[Twisted-Python] JOB: Senior and Lead Engineers | ClusterHQ |	Bristol, UK | relocation offered
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29340">[ date ]</a>
              <a href="thread.html#29340">[ thread ]</a>
              <a href="subject.html#29340">[ subject ]</a>
              <a href="author.html#29340">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
