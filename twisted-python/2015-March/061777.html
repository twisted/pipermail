<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] LoopingCall.withCount countCallable called with 0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20LoopingCall.withCount%20countCallable%20called%20with%200&In-Reply-To=%3CCALTAbW%3DPEr3sn5E8bcCF13w-injhC9ojCJVrNb1biFRN7QNMOw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] LoopingCall.withCount countCallable called with 0</H1>
    <B>Dario Vinella</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20LoopingCall.withCount%20countCallable%20called%20with%200&In-Reply-To=%3CCALTAbW%3DPEr3sn5E8bcCF13w-injhC9ojCJVrNb1biFRN7QNMOw%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] LoopingCall.withCount countCallable called with 0">d.vinella at gmail.com
       </A><BR>
    <I>Tue Mar 24 03:49:46 MDT 2015</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61777">[ date ]</a>
              <a href="thread.html#61777">[ thread ]</a>
              <a href="subject.html#61777">[ subject ]</a>
              <a href="author.html#61777">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I found an odd behavior using a LoopingCall.withCount with a very small
interval (0.02 sec): sometimes the countCallable is called with 0 as
argument and it looks like the now - _realLastTime is smaller than the
looping interval.

Here you can find the very simple code I use to reproduce the &quot;anomaly&quot;,
with a main loopingCall and another one that prints its internals

<A HREF="https://gist.github.com/dvinella/31d94f9dd0e47586658d">https://gist.github.com/dvinella/31d94f9dd0e47586658d</A>

and here an extract of the logs it produces

<A HREF="https://gist.github.com/dvinella/8cfdce0b9f5fdda7b375">https://gist.github.com/dvinella/8cfdce0b9f5fdda7b375</A>

The doc for the withCount states that the argument should be normally 1,
higher if the reactor blocks for some reason, but it doesn't say anything
about 0.
The beahavior is quite misleading since the loop seems to anticipate the
interval timeout, saying &quot;I've been called, but I should have not been
called&quot;

I must add that the anomaly doesn't appear right at the start, but after
tens of seconds, mostly when the system is under medium/heavy load.

So is it only a documentation issue for an exceptional case, due to timers
imprecision, that should be handled at higher levels, or is it a real issue?

dario
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20150324/b5384e20/attachment-0002.html&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61777">[ date ]</a>
              <a href="thread.html#61777">[ thread ]</a>
              <a href="subject.html#61777">[ subject ]</a>
              <a href="author.html#61777">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
