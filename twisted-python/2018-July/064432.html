<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] &quot;Cleared to Land&quot;?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%22Cleared%20to%20Land%22%3F&In-Reply-To=%3C1531288441.2839748.1436853672.175D0B1C%40webmail.messagingengine.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="064430.html">
   <LINK REL="Next"  HREF="064448.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] &quot;Cleared to Land&quot;?</H1>
    <B>Tom Most</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%22Cleared%20to%20Land%22%3F&In-Reply-To=%3C1531288441.2839748.1436853672.175D0B1C%40webmail.messagingengine.com%3E"
       TITLE="[Twisted-Python] &quot;Cleared to Land&quot;?">twm at freecog.net
       </A><BR>
    <I>Tue Jul 10 23:54:01 MDT 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="064430.html">[Twisted-Python] &quot;Cleared to Land&quot;?
</A></li>
        <LI>Next message (by thread): <A HREF="064448.html">[Twisted-Python] &quot;Cleared to Land&quot;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64432">[ date ]</a>
              <a href="thread.html#64432">[ thread ]</a>
              <a href="subject.html#64432">[ subject ]</a>
              <a href="author.html#64432">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Jul 8, 2018, at 11:45 PM, Glyph wrote:
&gt;&gt;<i> On Jul 8, 2018, at 6:21 PM, Tom Most &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twm at freecog.net</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Sun, Jul 8, 2018, at 12:06 PM, Glyph wrote:
</I>&gt;&gt;&gt;&gt;<i> On Jul 8, 2018, at 7:44 AM, Adi Roiban &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">adi at roiban.ro</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> On Sat, 7 Jul 2018 at 22:45, Glyph &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:&gt;&gt;&gt;&gt;&gt; On Jul 7, 2018, at 12:36 PM, Tom Most &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twm at freecog.net</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> [snip]
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> Thanks for driving this to completion, Tom!  Much appreciated.
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> For future reference though, when landing stuff on trunk, please
</I>&gt;&gt;&gt;&gt;&gt;<i> use this format exactly:&gt;&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://twistedmatrix.com/trac/wiki/ReviewProcess#Authors:Howtomergethechangetotrunk">https://twistedmatrix.com/trac/wiki/ReviewProcess#Authors:Howtomergethechangetotrunk</A>&gt;&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;&gt;<i> This helps with both automatically closing the associated Trac
</I>&gt;&gt;&gt;&gt;&gt;<i> ticket (I already did that in this case) and properly attributing
</I>&gt;&gt;&gt;&gt;&gt;<i> credit for reviewer points on
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://twistedmatrix.com/highscores/.">https://twistedmatrix.com/highscores/.</A>&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;<i> I always forget the format and then I have to search previous
</I>&gt;&gt;&gt;&gt;<i> commits or wiki.&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;<i> We make reference to the Trac ticket in PR title, Branch Name, PR
</I>&gt;&gt;&gt;&gt;<i> description (As part of checklist).
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Do we really need to make another reference in the merge commit?
</I>&gt;&gt;&gt;&gt;<i> For me, it's red tape.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> I don't think that we should make things more complicated, just to&gt;&gt;&gt;&gt; have a functional <A HREF="https://twistedmatrix.com/highscores/">https://twistedmatrix.com/highscores/</A>
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> If we forget every so often, it's not a big deal, but I find it's
</I>&gt;&gt;&gt;<i> nice to have a generally consistent merge format.  I do really wish
</I>&gt;&gt;&gt;<i> that Github could do this in the same way that it does for a PR
</I>&gt;&gt;&gt;<i> template so we didn't have to remember manually.&gt;&gt; 
</I>&gt;&gt;<i> Ah, sorry. It looks like I've done this a few times. I had wondered
</I>&gt;&gt;<i> why my points weren't changing.&gt;&gt; 
</I>&gt;&gt;<i> A template would be nice, if only as a reminder, but I think that I
</I>&gt;&gt;<i> will always struggle with this if I use the GitHub UI to merge --- no
</I>&gt;&gt;<i> other project to which I contribute has requirements w.r.t. the merge
</I>&gt;&gt;<i> commit message, so I am fighting habit. I'll look into scripting it.&gt;&gt; 
</I>&gt;&gt;<i> As an aside, could you update &quot;&lt;comma_separated_names&gt;&quot; in the merge
</I>&gt;&gt;<i> commit message example to &quot;&lt;comma_separated_github_usernames&gt;&quot;? I
</I>&gt;&gt;<i> always have to look at the repository history to see if this is
</I>&gt;&gt;<i> supposed to be full names or Trac/GitHub handles.&gt; 
</I>&gt;<i> I've just made you a trac admin, so you should be able to have
</I>&gt;<i> at it :-).
</I>Thanks, done! :-)

&gt;&gt;&gt;&gt;&gt;<i> Perhaps we should avoid the &quot;cleared to land&quot; label on PRs from
</I>&gt;&gt;&gt;&gt;&gt;<i> non-committers? I scan through open PRs for ones which require a
</I>&gt;&gt;&gt;&gt;&gt;<i> procedural nudge now and again, but I had not looked at this one
</I>&gt;&gt;&gt;&gt;&gt;<i> as the process appeared to be done with it, and I missed that it
</I>&gt;&gt;&gt;&gt;&gt;<i> was from a non-committer.&gt;&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> Ideally it would be used sparingly, but, the availability of such
</I>&gt;&gt;&gt;&gt;&gt;<i> a process release-valve allows someone to do a review even if they
</I>&gt;&gt;&gt;&gt;&gt;<i> only have time to read the code, and not the time to sit around
</I>&gt;&gt;&gt;&gt;&gt;<i> waiting 40 minutes for some intermittent CI nonsense to shake out.&gt;&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;&gt;<i> Since this doesn't have a <A HREF="https://twisted.reviews/">https://twisted.reviews/</A> -like &quot;core
</I>&gt;&gt;&gt;&gt;&gt;<i> gameplay loop&quot; that project members regularly visit, perhaps if
</I>&gt;&gt;&gt;&gt;&gt;<i> you're going to use this label you should always shoot a message
</I>&gt;&gt;&gt;&gt;&gt;<i> to this list as well, to let other contributors know that they
</I>&gt;&gt;&gt;&gt;&gt;<i> should take a look if they have a minute?&gt;&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;&gt;<i> On that note, it looks like
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://github.com/twisted/twisted/pull/1010">https://github.com/twisted/twisted/pull/1010</A> has suffered the same
</I>&gt;&gt;&gt;&gt;&gt;<i> fate?  Any other committers have a minute to land that one? :)&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://github.com/twisted/twisted/pull/1010">https://github.com/twisted/twisted/pull/1010</A> was merged now.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Do we really need and up to date branch before a merge?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The GitHub UI currently requires this for non-admins, though it can
</I>&gt;&gt;<i> be bypassed with a manual merge, much like the requirement for a
</I>&gt;&gt;<i> green build. As a new committer I haven't felt comfortable doing that
</I>&gt;&gt;<i> bypass, so I spend a lot of time merging forward and kicking builds
</I>&gt;&gt;<i> to get a green check mark. Should I be bothering? Particularly for
</I>&gt;&gt;<i> documentation changes[1]. I'd rather spend that time on work product
</I>&gt;&gt;<i> than process.&gt; 
</I>&gt;<i> On the one hand it saddens me that contributors are having their time
</I>&gt;<i> wasted by this pointless pacifying of CI machines.  On the other hand,
</I>&gt;<i> to echo your sentiment of &quot;buggy tests are worse than no tests&quot;, I
</I>&gt;<i> think that there's no point to having CI at all unless we're paying
</I>&gt;<i> attention to it, so I would wholeheartedly support the deletion or
</I>&gt;<i> skipping of any tests that are causing real problems.&gt; 
</I>&gt;&gt;&gt;&gt;<i> I was thinking that with the &quot;clear to land&quot; label, we can have a
</I>&gt;&gt;&gt;&gt;<i> robot which checks for the PR and once all tests are green, the
</I>&gt;&gt;&gt;&gt;<i> robot&gt;&gt;&gt;&gt; will automatically merge based on
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://developer.github.com/v3/pulls/#merge-a-pull-request-merge-button">https://developer.github.com/v3/pulls/#merge-a-pull-request-merge-button</A>&gt;&gt;&gt; 
</I>&gt;&gt;&gt;<i> This sounds like a great idea, and is very close to what I would do
</I>&gt;&gt;&gt;<i> if I had time for working on automation :).&gt;&gt;&gt; 
</I>&gt;&gt;&gt;<i> Rather than using the &quot;clear to land&quot; label, however, I'd probably
</I>&gt;&gt;&gt;<i> do this on the basis of a passing review from a project member being
</I>&gt;&gt;&gt;<i> present, and a passing build.  (The &quot;clear to land&quot; convention
</I>&gt;&gt;&gt;<i> predates Github native code reviews.)&gt;&gt; 
</I>&gt;&gt;<i> I think we'd still need a label or other explicit indicator that an
</I>&gt;&gt;<i> automatic merge should occur, or we won't be able to leave a passing
</I>&gt;&gt;<i> review which suggests trivial fixes. &quot;Please fix this typo, then
</I>&gt;&gt;<i> merge&quot; reviews are pretty common.&gt; 
</I>&gt;<i> Hmm.  Fair point there.  Label it is.
</I>&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> The robot can also auto-update with 'trunk/master' a PR with clear
</I>&gt;&gt;&gt;&gt;<i> to land.&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;<i> I am happy to work at automation and improving the Twisted PR
</I>&gt;&gt;&gt;&gt;<i> process.&gt;&gt;&gt; 
</I>&gt;&gt;&gt;<i> I know you're not a huge fan of Trac either - it would be a nice
</I>&gt;&gt;&gt;<i> touch if the robot here could also notice Github reviews and delete
</I>&gt;&gt;&gt;<i> the 'review' keyword; this would keep our highscores and stats stuff
</I>&gt;&gt;&gt;<i> working, but eliminate a manual step for reviewers :).&gt;&gt; 
</I>&gt;&gt;<i> Yes, let's also add/remove remove the &quot;review required&quot; label on
</I>&gt;&gt;<i> GitHub or it ends up[2] out of sync[3]. :)&gt; 
</I>&gt;<i> &quot;review requested&quot; is pretty close to this state; I don't think *this*
</I>&gt;<i> one needs a custom label? :)
</I>Good point! Setting the &quot;review&quot; keyword in Trac should automatically
request a review from twisted/twisted-contributors. Adding a review
should remove the &quot;review&quot; keyword from Trac and add a comment to the
ticket which points at the review. Does that sound correct?
&gt;&gt;<i> Have you seen the Bors approach[4]? Roughly, Bors is a bot which
</I>&gt;&gt;<i> merges a PR to the mainline on a temporary branch, runs the tests,
</I>&gt;&gt;<i> and then fast-forwards the mainline if they pass. If we took that
</I>&gt;&gt;<i> approach we'd not have to manually merge forward all the time.&gt; 
</I>&gt;<i> This looks super interesting.  I would definitely like to have a
</I>&gt;<i> commit queue, so that we don't have to sit around manually waiting on
</I>&gt;<i> CI, but we don't have to reduce our CI coverage platforms (especially
</I>&gt;<i> for alternate kernels, which it's really Twisted's job to cope with).&gt; 
</I>&gt;&gt;&gt;&gt;<i> For example, I have this PR
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://github.com/twisted/twisted/pull/1011">https://github.com/twisted/twisted/pull/1011</A>&gt;&gt;&gt;&gt; 
</I>&gt;&gt;&gt;&gt;<i> It only touches  .circleci/config.yml .... why should we block
</I>&gt;&gt;&gt;&gt;<i> or wait&gt;&gt;&gt;&gt; for the merge/review of this PR due to random failures on Buildbot?&gt;&gt;&gt; 
</I>&gt;&gt;&gt;<i> It looks like this is another case of  twisted.python.test.test_sen-
</I>&gt;&gt;&gt;<i> dmsg.CModuleSendmsgTests.test_shortsend messing up our build
</I>&gt;&gt;&gt;<i> results.&gt;&gt; 
</I>&gt;&gt;<i> This failure has been wasting a lot of time over the past two months.
</I>&gt;&gt;<i> I think that we should disable this test on Travis until we have a
</I>&gt;&gt;<i> proper fix. It still runs on Buildbot, no? Buggy tests are worse than
</I>&gt;&gt;<i> no tests, as they let one portion of the project prevent forward
</I>&gt;&gt;<i> progress on all others.&gt;&gt; 
</I>&gt;&gt;<i> The rhel7-py27-coverage builder seems to be having issues downloading
</I>&gt;&gt;<i> packages from PyPI, too. Fortunately it fails fast and the queue is
</I>&gt;&gt;<i> usually short so it's a quick to kick:
</I>&gt;&gt;<i> <A HREF="https://buildbot.twistedmatrix.com/builders/rhel7-py2.7-coverage">https://buildbot.twistedmatrix.com/builders/rhel7-py2.7-coverage</A>&gt; Please go ahead and disable this test everywhere.  The test itself
</I>&gt;<i> must be buggy, if it doesn't work in the Travis environment where
</I>&gt;<i> presumably sendmsg actually works fine.  (Also, this is a 27-only test
</I>&gt;<i> and if we wait long enough before fixing any underlying issue we can
</I>&gt;<i> probably just delete it...)
</I>Done! Per Adi's review I deleted it entirely.
<A HREF="https://github.com/twisted/twisted/pull/1038[5">https://github.com/twisted/twisted/pull/1038[5</A>]
Thanks,
Tom


Links:

  1. <A HREF="https://github.com/twisted/twisted/pull/1037">https://github.com/twisted/twisted/pull/1037</A>
  2. <A HREF="https://github.com/twisted/twisted/pull/1021">https://github.com/twisted/twisted/pull/1021</A>
  3. <A HREF="https://github.com/twisted/twisted/pull/1037">https://github.com/twisted/twisted/pull/1037</A>
  4. <A HREF="https://github.com/graydon/bors">https://github.com/graydon/bors</A>
  5. <A HREF="https://github.com/twisted/twisted/pull/1038#pullrequestreview-135761507">https://github.com/twisted/twisted/pull/1038#pullrequestreview-135761507</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20180710/857e99d9/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="064430.html">[Twisted-Python] &quot;Cleared to Land&quot;?
</A></li>
	<LI>Next message (by thread): <A HREF="064448.html">[Twisted-Python] &quot;Cleared to Land&quot;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64432">[ date ]</a>
              <a href="thread.html#64432">[ thread ]</a>
              <a href="subject.html#64432">[ subject ]</a>
              <a href="author.html#64432">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
