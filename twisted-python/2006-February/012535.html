<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Conch: multiple commands
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Conch%3A%20multiple%20commands&In-Reply-To=E1F7G5N-0003rF-02%40pyramid.twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012534.html">
   <LINK REL="Next"  HREF="012538.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Conch: multiple commands</H1>
    <B>Brendan Simon</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Conch%3A%20multiple%20commands&In-Reply-To=E1F7G5N-0003rF-02%40pyramid.twistedmatrix.com"
       TITLE="[Twisted-Python] Conch: multiple commands">Brendan at BrendanSimon.com
       </A><BR>
    <I>Thu Feb  9 16:02:40 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="012534.html">[Twisted-Python] sprinting at PyCon
</A></li>
        <LI>Next message: <A HREF="012538.html">[Twisted-Python] Conch: multiple commands
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12535">[ date ]</a>
              <a href="thread.html#12535">[ thread ]</a>
              <a href="subject.html#12535">[ subject ]</a>
              <a href="author.html#12535">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Paul Swartz &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">paulswartz at gmail.com</A>&gt; wrote:
&gt;&gt;<i> Is it possible to open _one_ channel, and send commands in a 
</I>&gt;&gt;<i> synchronously?  ie. wait for commands to return output and then issue 
</I>&gt;&gt;<i> other commands if necesary??
</I>&gt;&gt;<i> Maybe this goes against the grain of the Twisted Asynchronous Framework ???
</I>&gt;&gt;<i>     
</I>&gt;<i> You can send one command at a time, but you still have to write the code 
</I>&gt;<i> asynchronously.
</I>&gt;<i>   
</I>I think this is half my problem, working out how to use the asynchronous 
framework properly ;-)

&gt;&gt;<i>    def servicesStarted(self):
</I>&gt;&gt;<i>        self.openChannel(CommandChannel.openChannel('ls /tmp/dir1')
</I>&gt;&gt;<i>        # how do I wait for list of dir1 to finish?
</I>&gt;&gt;<i>        self.openChannel(CommandChannel.openChannel('ls /tmp/dir2')
</I>&gt;&gt;<i>        # how do I wait for list of dir2 to finish?
</I>&gt;&gt;<i>        self.openChannel(CommandChannel.openChannel('ls /tmp/dir3')
</I>&gt;&gt;<i>        # how do I wait for list of dir3 to finish?
</I>&gt;&gt;<i>     
</I>&gt;<i> What I'd do is also pass a Deferred to CommandChannel, that is 
</I>&gt;<i> call/errbacked when the command finishes.
</I>&gt;<i>
</I>&gt;<i> def servicesStarted(self):
</I>&gt;<i>      d = defer.Deferred()
</I>&gt;<i>      d.addCallback(self._cbFirstLs)
</I>&gt;<i>      d.addErrback(self._ebFirstLs)
</I>&gt;<i>      self.openChannel(CommandChannel(d, &quot;ls /tmp/dir1&quot;))
</I>&gt;<i>
</I>&gt;<i> def _cbFirstLs(self, result):
</I>&gt;<i>      print 'directory listing', result
</I>&gt;<i>      d = defer.Deferred()
</I>&gt;<i>      self.openChannel(CommandChannel(d, &quot;ls /tmp/dir2&quot;))
</I>&gt;<i>
</I>&gt;<i> def _ebFirstLs(self, f):
</I>&gt;<i>      log.err()
</I>&gt;<i>
</I>&gt;<i> etc., for all the commands you want to run.
</I>&gt;<i>   
</I>Thanks.  I'll play with this a little more.  Guess I may need some kind 
of state machine in the callback function if different unrelated 
commands are to be sent at different times based on various application 
events.  Does that sound like a good way to use Twisted???

Thanks,
Brendan.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012534.html">[Twisted-Python] sprinting at PyCon
</A></li>
	<LI>Next message: <A HREF="012538.html">[Twisted-Python] Conch: multiple commands
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12535">[ date ]</a>
              <a href="thread.html#12535">[ thread ]</a>
              <a href="subject.html#12535">[ subject ]</a>
              <a href="author.html#12535">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
