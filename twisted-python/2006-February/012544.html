<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] calling reactor.run() twice in PB app
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20calling%20reactor.run%28%29%20twice%20in%20PB%20app&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012543.html">
   <LINK REL="Next"  HREF="012545.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] calling reactor.run() twice in PB app</H1>
    <B>Eric Smith</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20calling%20reactor.run%28%29%20twice%20in%20PB%20app&In-Reply-To="
       TITLE="[Twisted-Python] calling reactor.run() twice in PB app">eric+twisted at trueblade.com
       </A><BR>
    <I>Wed Feb 15 13:58:48 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="012543.html">[Twisted-Python] Weekly Bug Summary
</A></li>
        <LI>Next message: <A HREF="012545.html">[Twisted-Python] calling reactor.run() twice in PB app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12544">[ date ]</a>
              <a href="thread.html#12544">[ thread ]</a>
              <a href="subject.html#12544">[ subject ]</a>
              <a href="author.html#12544">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a non-authenticating, single-threaded, Perspective Broker
application.  I'm running Python 2.3, Twisted 2.0.1 on Fedora Core 2.

I want to run the reactor multiple times, serially.  Essentially I have 
an existing program, and I want to make some PB calls to get some data. 
  The existing program isn't twisted-aware, nor do I want it to be.  I 
just want them to do what's needed to contact a PB server, get some 
data, and disconnect.

To demonstrate the problem,  I took the PB code from chapter 5 of the 
O'Reilly twisted book (pb_client.py and pb_server.py).  In pb_client.py, 
I duplicated the last 3 lines so now it says:

------------------
t = PbTester()
t.runTests()
reactor.run()

t = PbTester()
t.runTests()
reactor.run()
------------------

The code runs twice, but the second call to reactor.run() never returns 
because the getRootObject() deferred never gets called.  If I wait long 
enough, I get a timeout.

While the client is hung, I can connect to the same server with another 
client, and it works normally (at least until the second reactor.run() 
call).  The server seems to be perfectly fine, and keeps responding. 
CPU usage on the box is normal.

Is there something I need to do to run the reactor twice?  I've tried 
changing to Unix domain sockets, but other than not getting a timeout, I 
get the same behavior.

Any hints or debugging tips would be appreciated.

Thanks.

Eric.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012543.html">[Twisted-Python] Weekly Bug Summary
</A></li>
	<LI>Next message: <A HREF="012545.html">[Twisted-Python] calling reactor.run() twice in PB app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12544">[ date ]</a>
              <a href="thread.html#12544">[ thread ]</a>
              <a href="subject.html#12544">[ subject ]</a>
              <a href="author.html#12544">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
