<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted TCP frame size
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted%20TCP%20frame%20size&In-Reply-To=44032C62.7090904%40imperial.ac.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012584.html">
   <LINK REL="Next"  HREF="012587.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted TCP frame size</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted%20TCP%20frame%20size&In-Reply-To=44032C62.7090904%40imperial.ac.uk"
       TITLE="[Twisted-Python] twisted TCP frame size">exarkun at divmod.com
       </A><BR>
    <I>Mon Feb 27 12:44:36 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="012584.html">[Twisted-Python] twisted TCP frame size
</A></li>
        <LI>Next message: <A HREF="012587.html">[Twisted-Python] Re: [Twisted-commits] r16103 - Make loopbackTCP and loopbackUNIX return Deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12586">[ date ]</a>
              <a href="thread.html#12586">[ thread ]</a>
              <a href="subject.html#12586">[ subject ]</a>
              <a href="author.html#12586">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 27 Feb 2006 16:44:18 +0000, Phil Mayers &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">p.mayers at imperial.ac.uk</A>&gt; wrote:
&gt;<i>Thys Meintjes wrote:
</I>&gt;&gt;<i>1) is there a way to force dataReceived() to return when a certain data
</I>&gt;&gt;<i>length has been received ?
</I>&gt;<i>
</I>&gt;<i>dataReceived() is called via doRead() on the file descriptor, which is 
</I>&gt;<i>called via a select([fd,], [], []) event in the default reactor.
</I>&gt;<i>
</I>&gt;<i>If you are doing something (executing code) and a TCP segment comes in, then 
</I>&gt;<i>another, then another, *then* you exit your code and the reactor falls back 
</I>&gt;<i>to select(), it'll return with the fd and doRead() will be called, and 
</I>&gt;<i>you'll get everything from the socket - 3 frames worth.
</I>&gt;<i>
</I>&gt;<i>The correct question is, given your test script has a very small 
</I>&gt;<i>dataReceived method that returns quickly (I presume), why isn't the reactor 
</I>&gt;<i>&quot;beating&quot; the server and getting 49 bytes every time?
</I>
Of course, it isn't necessarily the case that multiple TCP packets, each with 49 bytes of application-level data, are arriving between the times doRead()/dataReceived() get invoked.  Nagling on the server could cause data to arrive in multiples of 49 bytes just as easily as a slow receiver.  This could happen with the synchronous version too, you just wouldn't be able to notice it.  What Twisted does in this case is actually more efficient, since it involves fewer trips into recv(), less memory copying, etc.

Of course all the other stuff Twisted does might outweigh this (and likely does - the overhead associated with synchronously reading from one socket is much lower than the overhead of performing the same task asynchronously, at least when using select()).  Which is not to say that the Twisted version has to be slower, but you might have to work harder to see any benefits at this (essentially non-existent) level of concurrency.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012584.html">[Twisted-Python] twisted TCP frame size
</A></li>
	<LI>Next message: <A HREF="012587.html">[Twisted-Python] Re: [Twisted-commits] r16103 - Make loopbackTCP and loopbackUNIX return Deferreds
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12586">[ date ]</a>
              <a href="thread.html#12586">[ thread ]</a>
              <a href="subject.html#12586">[ subject ]</a>
              <a href="author.html#12586">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
