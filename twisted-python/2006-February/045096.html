<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Sending commands when using Telnet client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Sending%20commands%20when%20using%20Telnet%20client&In-Reply-To=%3C24f63c200602281059g56f65c4ckffaf57d0ef9547c9%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="045098.html">
   <LINK REL="Next"  HREF="045099.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Sending commands when using Telnet client</H1>
    <B>Don Smith</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Sending%20commands%20when%20using%20Telnet%20client&In-Reply-To=%3C24f63c200602281059g56f65c4ckffaf57d0ef9547c9%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Sending commands when using Telnet client">donwsmith at gmail.com
       </A><BR>
    <I>Tue Feb 28 11:59:50 MST 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="045098.html">[Twisted-Python] Re: [Twisted-commits] r16103 - Make loopbackTCP	and loopbackUNIX return Deferreds
</A></li>
        <LI>Next message (by thread): <A HREF="045099.html">[Twisted-Python] Sending commands when using Telnet client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45096">[ date ]</a>
              <a href="thread.html#45096">[ thread ]</a>
              <a href="subject.html#45096">[ subject ]</a>
              <a href="author.html#45096">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes, I'm sort of a Twisted newbie, so maybe this has an obvious answer, but
I'm just not seeing it.

I have a Twisted program that I need to add in the ability to make a client
telnet connection to a remote server and send some commands to it and deal
with the data received.

In my main program I have this line of code:
    reactor.connectTCP(&quot;mytelnethost&quot;, 24, Connections.TelnetConnection(&quot;myname
of object&quot;,events,&quot;command to run&quot;))

My Connections.TelnetConnection class looks like this:

from twisted.internet.protocol import Protocol, ReconnectingClientFactory
from twisted.conch.telnet import Telnet

class TelnetClient(Telnet):
    def connectionMade(self):
        print &quot;connection made&quot;
    self.write(&quot;\r\n&quot;)

    def write(self, data):
    print data
    Telnet._write(self, data+&quot;\r\n&quot;)

    def dataReceived(self, data):
        print &quot;received:&quot;, data
    if &quot;User Name:&quot; in data:
       self.write(&quot;user&quot;)

    if &quot;Password:&quot; in data:
       self.write(&quot;password&quot;)


    if &quot;&gt;&quot; in data:
       time.sleep(2)
       self.write(&quot;connect&quot;)
    if &quot;Connector Name:&quot; in data:
       time.sleep(2)
       self.write(&quot;another command&quot;)



class TelnetConnection(Connection, ReconnectingClientFactory):
    &quot;&quot;&quot; Telnets to host:port and executes cmd. cmd &quot;&quot;&quot;
    protocol = TelnetClient
    def  __init__(self, name, eventQueue, cmd=None):
        Connection.__init__(self, name)

    def clientConnectionFailed(self, connector, reason):
        print 'connection failed:', reason.getErrorMessage()


    def clientConnectionLost(self, connector, reason):
        print 'connection lost:', reason.getErrorMessage()



This all works great, except that the command sequence is hard coded in the
TelnetClient class. I want to be able to reference the &quot;cmd&quot; parameter,
which could be a list of commands to iterate over,etc. But I don't see how I
can access the &quot;cmd&quot; parameter that gets passed into the TelnetConnection
class from within the TelnetClient class.

I'm really desparate for some help, I've been racking my brain on this since
yesterday morning.

Thanks,

Don
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20060228/228e3b14/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="045098.html">[Twisted-Python] Re: [Twisted-commits] r16103 - Make loopbackTCP	and loopbackUNIX return Deferreds
</A></li>
	<LI>Next message (by thread): <A HREF="045099.html">[Twisted-Python] Sending commands when using Telnet client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45096">[ date ]</a>
              <a href="thread.html#45096">[ thread ]</a>
              <a href="subject.html#45096">[ subject ]</a>
              <a href="author.html#45096">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
