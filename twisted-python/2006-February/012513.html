<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: Making DeferredList look like Deferred
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Making%20DeferredList%20look%20like%20Deferred&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012515.html">
   <LINK REL="Next"  HREF="012519.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: Making DeferredList look like Deferred</H1>
    <B>Lenny G Arbage</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Making%20DeferredList%20look%20like%20Deferred&In-Reply-To="
       TITLE="[Twisted-Python] Re: Making DeferredList look like Deferred">alengarbage at yahoo.com
       </A><BR>
    <I>Mon Feb  6 16:23:39 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="012515.html">[Twisted-Python] Help: how to run something at shutdown time
</A></li>
        <LI>Next message: <A HREF="012519.html">[Twisted-Python] Re: Making DeferredList look like Deferred
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12513">[ date ]</a>
              <a href="thread.html#12513">[ thread ]</a>
              <a href="subject.html#12513">[ subject ]</a>
              <a href="author.html#12513">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thomas HERVE therve at free.fr wrote:
&gt;<i>
</I>&gt;<i> But really, I don't see the point of this. 
</I>&gt;<i> If you want to have an exception somewhere,
</I>&gt;<i> use fireOnOneErrback. Else there's no need
</I>&gt;<i> to build the result list, if you're
</I>&gt;<i> actually raising an Exception for *one*
</I>&gt;<i> error.
</I>
  What if the desired exception handling should occur
*after* all the Deferreds have fired, regardless of
whether they fired err or callback?

  This is particularly useful for p2p-style apps.  For
example, suppose I want to maintain a maximum of 20
outstanding requests for a given operation -- I don't
want to spin off another 20 (or another X) until I
know exactly how many of the original 20 failed and
how many succeeded.  (This type of operation is
common, for instance, when you are doing erasure
coding or shamir secret sharing, where you really only
need Y out of Z requests to succeed, but where you do
need to respawn W new requests if you didn't get Y
after the first round.)
  fireOnOneErrback doesn't seem to give me that
functionality -- it gets fired only once, for the
first failure.  I don't know which other of the 20
requests failed or will fail, and there may be
outstanding requests that will yet succeed that I'll
never learn about.

  I think I'm beginning to see, though, that this is
all accounted for by just letting the DeferredList's
callback get invoked, and wrapping it similarly to
what you posted.  My only complaint, as you pointed
out, is that this seems a bit clumsy.

  However, cluttering up the API with another special
flag to handle my border case where I want the
DeferredList's errback to be invoked just like the
callback, but only if =&gt; 1 of its Deferreds
errback'ed, may be even worse.  It sure would be handy
for me, however, so I'll likely create my own
SpecialDeferredList that does the wrapping behind the
scenes and fires the back() that I expect.

  Unless, of course, there is a better way.  Here's
what I'm currently using to wrap:

def DeferredListToDeferred(result):
    print &quot; result was: %s&quot; % result
    for code, res in result:
        if code == False:
            # assumes failed results have 
            # (False, failure) pairs, and
            # only returns the first of
            # these.
            return res
    return result



__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
<A HREF="http://mail.yahoo.com">http://mail.yahoo.com</A> 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012515.html">[Twisted-Python] Help: how to run something at shutdown time
</A></li>
	<LI>Next message: <A HREF="012519.html">[Twisted-Python] Re: Making DeferredList look like Deferred
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12513">[ date ]</a>
              <a href="thread.html#12513">[ thread ]</a>
              <a href="subject.html#12513">[ subject ]</a>
              <a href="author.html#12513">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
