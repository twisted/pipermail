<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] calling reactor.run() twice in PB app
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20calling%20reactor.run%28%29%20twice%20in%20PB%20app&In-Reply-To=%3C20060216030010.6122.417722554.divmod.quotient.133%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="045065.html">
   <LINK REL="Next"  HREF="045055.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] calling reactor.run() twice in PB app</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20calling%20reactor.run%28%29%20twice%20in%20PB%20app&In-Reply-To=%3C20060216030010.6122.417722554.divmod.quotient.133%40ohm%3E"
       TITLE="[Twisted-Python] calling reactor.run() twice in PB app">exarkun at divmod.com
       </A><BR>
    <I>Wed Feb 15 20:00:10 MST 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="045065.html">[Twisted-Python] calling reactor.run() twice in PB app
</A></li>
        <LI>Next message (by thread): <A HREF="045055.html">[Twisted-Python] calling reactor.run() twice in PB app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45064">[ date ]</a>
              <a href="thread.html#45064">[ thread ]</a>
              <a href="subject.html#45064">[ subject ]</a>
              <a href="author.html#45064">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 15 Feb 2006 19:59:48 -0500, Eric Smith &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">eric+twisted at trueblade.com</A>&gt; wrote:
&gt;<i>Jean-Paul Calderone wrote:
</I>&gt;&gt;<i>On Thu, 16 Feb 2006 10:27:27 +1100, Andrew Bennetts &lt;andrew- 
</I>&gt;&gt;<i><A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted at puzzling.org</A>&gt; wrote:
</I>&gt;&gt;&gt;<i>On Thu, Feb 16, 2006 at 08:17:42AM +1100, Jonathan Lange wrote:
</I>&gt;&gt;&gt;&gt;<i>On 2/16/06, Mike Pelletier &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mike at mkp.ca</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> &gt; What you want is not supported.  If it were, Trial would be a lot 
</I>&gt;&gt;&gt;&gt;<i>simpler.
</I>&gt;&gt;&gt;&gt;<i> &gt; There is some pressure to support it, but I think it's low-priority. 
</I>&gt;&gt;&gt;&gt;<i>(If I
</I>&gt;&gt;&gt;&gt;<i> &gt; understand correctly.)  Perhaps you can just block the reactor by 
</I>&gt;&gt;&gt;&gt;<i>calling
</I>&gt;&gt;&gt;&gt;<i> &gt; into your app rather than vice-versa?
</I>&gt;&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>You understand correctly. It is not supported, Trial would be simpler
</I>&gt;&gt;&gt;&gt;<i>and it is never going to be supported.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Never is a long time :)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Last time I pestered glyph about this, I got him to agree that it should 
</I>&gt;&gt;&gt;<i>work.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Now we just need to find someone to implement it for all the reactors :)
</I>&gt;<i>
</I>&gt;<i>Well, I happen to be motivated just now.  I'm new to twisted, but I'm not 
</I>&gt;<i>new to Python and I'm reasonably familiar with the style twisted uses (I've 
</I>&gt;<i>written lots of IOCP code).
</I>&gt;<i>
</I>&gt;<i>If anyone could summarize the problem, and if you're serious about it 
</I>&gt;<i>getting fixed, I could look at it.
</I>
There's no single particular problem preventing this from working.  More, 
the feature is generally not considered when making changes to an existing 
reactor or implementing a new one.  Startup and shutdown involve certain 
internal and external state changes which the existing reactors generally 
aren't care to allow to happen repeatedly.  For example, ReactorBase's 
__init__ method sets up two event triggers to run during shutdown.  One of 
these disconnects all connected sockets; the other actually causes the run() 
method to return.  Since system event triggers are removed as they are run, 
neither of these things happens the 2nd time a reactor deriving from 
ReactorBase shuts down.

Since most reactors in Twisted subclass ReactorBase, fixing problems in it 
will probably fix many of the reactors, although subclasses may introduce 
their own problems as well.  At least the IOCP reactor does not subclass it, 
though, so it will need to addressed separately.  Also, some testing strategy 
needs to be developed to ensure assumptions of a single run/stop pair don't 
creep back into the code.

Documentation and interfaces will also need to be updated, of course.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="045065.html">[Twisted-Python] calling reactor.run() twice in PB app
</A></li>
	<LI>Next message (by thread): <A HREF="045055.html">[Twisted-Python] calling reactor.run() twice in PB app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45064">[ date ]</a>
              <a href="thread.html#45064">[ thread ]</a>
              <a href="subject.html#45064">[ subject ]</a>
              <a href="author.html#45064">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
