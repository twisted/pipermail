<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] help with deferreds??
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20help%20with%20deferreds%3F%3F&In-Reply-To=%3C20060207155222.96627.qmail%40web36712.mail.mud.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="045028.html">
   <LINK REL="Next"  HREF="044988.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] help with deferreds??</H1>
    <B>john peter</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20help%20with%20deferreds%3F%3F&In-Reply-To=%3C20060207155222.96627.qmail%40web36712.mail.mud.yahoo.com%3E"
       TITLE="[Twisted-Python] help with deferreds??">neuzhoundxx at yahoo.com
       </A><BR>
    <I>Tue Feb  7 08:52:22 MST 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="045028.html">[Twisted-Python] help with deferreds??
</A></li>
        <LI>Next message (by thread): <A HREF="044988.html">[Twisted-Python] callback and errback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45029">[ date ]</a>
              <a href="thread.html#45029">[ thread ]</a>
              <a href="subject.html#45029">[ subject ]</a>
              <a href="author.html#45029">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all!  After I asked someone to take a look at our legacy app setup, this code seems to work now!

john peter &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">neuzhoundxx at yahoo.com</A>&gt; wrote:    This client code is making connections to a legacy app.  I do have Java code that simulates what the server side essentially does and this client code does seem to
  work as expected when run against that server code:
   
  commandline=python dd.py localhost 140 W04FSRV W04PS01 2
   
  buildProtocol with myName= W04PS01 instanceName= conn1
  conn1 connection made. requesting session establishment ...
myName= W04PS01   remoteName= W04FSRV
  buildProtocol with myName= W04BS03 instanceName= conn2
  conn2 connection made. requesting session establishment ...
myName= W04BS03   remoteName= W04FSRV
  conn1 Server said: '\x82\x00\x00\x00'
conn1 Positive Service Response Packet received!
conn1 TRANS CODE= 998
  conn1 sending server data ...
conn1 finished sending server data
conn1 connection lost
conn1 Connection lost - goodbye!
conn2 Server said: '\x82\x00\x00\x00'
conn2 Positive Service Response Packet received!
conn2 TRANS CODE= 998
  conn2 sending server data ...
conn2 finished sending server data
conn2 connection lost
conn2 Connection lost - goodbye!

  -------------------------------------------------------------------
  When run against the legacy app on &lt;ip address&gt;, only one connection seems to be 
  working (see output below).  Also, when I run the code one connection at a time, 
  the code works.
   
  Any suggestion what I can do on the client side to help me debug?
  I noticed there's log.msg()'s in the twisted code.  Would they have printed out
  on the dos console (i'm using windows xp as the client machine) if they had
  occurred?
   
  Also, one difference between the two &quot;invocations&quot; (connecting to java server code vs connecting to legacy app) is the port. For connecting to the java server code on localhost, the &quot;remote&quot; port is 140; for connecting  to the legacy app, the remote port
  is the usual NBT port 139. i don't think this should matter; just thought i'd mention it...
   
  commandline= python dd.py &lt;ip address&gt; 139 W04FSRV W04PS01 2

  buildProtocol with myName= W04PS01 instanceName= conn1
  conn1 connection made. requesting session establishment ...
myName= W04PS01   remoteName= W04FSRV
  buildProtocol with myName= W04BS03 instanceName= conn2
  conn2 connection made. requesting session establishment ...
myName= W04BS03   remoteName= W04FSRV
  conn2 Server said: '\x82\x00\x00\x00'
conn2 Positive Service Response Packet received!
conn2 TRANS CODE= 998
  conn2 sending server data ...
conn2 finished sending server data
conn2 connection lost
conn2 Connection lost - goodbye!

  <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at divmod.com</A> wrote:
  
On Fri, 3 Feb 2006 07:42:27 -0800 (PST), john peter wrote:

&gt;<i> With my initial attempt using Twisted, only one connection seems to succeed, and the other basically hangs.
</I>
This isn't quite a &quot;minimal&quot; example, since I don't have access to the server side that this code is expecting to talk to. Have you tried setting up a simpler server which does a listenTCP and then a server which does connectTCP to it multiple times? Does that work?

One thing that occurs to me is that if the first byte of the connection is not \x82 it will be disconnected immediately; the dataReceived you've written doesn't actually parse any protocol data. Depending on which prints are actually commented out or not that might look like hanging :)

_______________________________________________
Twisted-Python mailing list
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
  

    
---------------------------------
  Yahoo! Mail - Helps protect you from nasty viruses._______________________________________________
Twisted-Python mailing list
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>



			
---------------------------------
 Yahoo! Mail - Helps protect you from nasty viruses.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20060207/ef741aa4/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="045028.html">[Twisted-Python] help with deferreds??
</A></li>
	<LI>Next message (by thread): <A HREF="044988.html">[Twisted-Python] callback and errback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45029">[ date ]</a>
              <a href="thread.html#45029">[ thread ]</a>
              <a href="subject.html#45029">[ subject ]</a>
              <a href="author.html#45029">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
