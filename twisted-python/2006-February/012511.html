<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: Making DeferredList look like Deferred
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Making%20DeferredList%20look%20like%20Deferred&In-Reply-To=20060206180501.74252.qmail%40web31510.mail.mud.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012510.html">
   <LINK REL="Next"  HREF="012512.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: Making DeferredList look like Deferred</H1>
    <B>Thomas HERVE</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Making%20DeferredList%20look%20like%20Deferred&In-Reply-To=20060206180501.74252.qmail%40web31510.mail.mud.yahoo.com"
       TITLE="[Twisted-Python] Re: Making DeferredList look like Deferred">therve at free.fr
       </A><BR>
    <I>Mon Feb  6 15:35:27 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="012510.html">[Twisted-Python] Re: Making DeferredList look like Deferred
</A></li>
        <LI>Next message: <A HREF="012512.html">[Twisted-Python] Help: how to run something at shutdown time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12511">[ date ]</a>
              <a href="thread.html#12511">[ thread ]</a>
              <a href="subject.html#12511">[ subject ]</a>
              <a href="author.html#12511">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Quoting Lenny G Arbage &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">alengarbage at yahoo.com</A>&gt;:

&gt;<i>  Now, though, this leads me to one more question:
</I>&gt;<i> what if I want to wait until all the Deferreds have
</I>&gt;<i> fired (either err or callback), and only then call the
</I>&gt;<i> callback if all callbacks were fired, otherwise call
</I>&gt;<i> the errback?
</I>&gt;<i>  To accomplish this, I'm currently just 'wrapping'
</I>&gt;<i> the DeferredList in a regular Deferred.  It's callback
</I>&gt;<i> is always called on completion, so when it fires I
</I>&gt;<i> look at all the results given to the callback, and if
</I>&gt;<i> any have failed, raise an exception.  Otherwise I
</I>&gt;<i> return a result.
</I>&gt;<i>  This feels a little bit clunky, but I don't have a
</I>&gt;<i> good suggestion for improving it --
</I>&gt;<i> 'fireOnErrbackAfterAllCompleted=True'?
</I>
Well that's near the default behaviour with fireOnOneErrback=False. 
Don't forget
you have the status of each requests in the result list. You could something
like this :

d = DeferredList(myList)
d.addCallback(mycb)

def mycb(results):
    ret = []
    # Warning clumsy code
    for code, res in results:
        if code == defer.FAILURE: # or 'not code'
             return failure.Failure(res)
        else: # defer.SUCCESS
             ret.append(res)
     return ret

But really, I don't see the point of this. If you want to have an exception
somewhere, use fireOnOneErrback. Else there's no need to build the 
result list,
if you're actually raising an Exception for *one* error.

-- 
Thomas




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012510.html">[Twisted-Python] Re: Making DeferredList look like Deferred
</A></li>
	<LI>Next message: <A HREF="012512.html">[Twisted-Python] Help: how to run something at shutdown time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12511">[ date ]</a>
              <a href="thread.html#12511">[ thread ]</a>
              <a href="subject.html#12511">[ subject ]</a>
              <a href="author.html#12511">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
