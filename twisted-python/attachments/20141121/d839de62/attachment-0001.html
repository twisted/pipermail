<tt>
&lt;!DOCTYPE&nbsp;html&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;title&gt;&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;&lt;div&gt;On&nbsp;Fri,&nbsp;21&nbsp;Nov&nbsp;2014,&nbsp;at&nbsp;14:08,&nbsp;Peter&nbsp;Westlake&nbsp;wrote:&lt;br&gt;&lt;/div&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;Found&nbsp;it!&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;ClientFactory,&nbsp;Protocol,&nbsp;ProcessProtocol&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;devnull&nbsp;=&nbsp;open('/dev/null').fileno()&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;print&nbsp;devnull&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;factory&nbsp;=&nbsp;ClientFactory()&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;factory.protocol&nbsp;=&nbsp;Protocol&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;reactor.connectTCP('localhost',&nbsp;'http',&nbsp;factory)&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;reactor.callWhenRunning(reactor.spawnProcess,&nbsp;ProcessProtocol(),&nbsp;'/bin/sleep',&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args=['/bin/sleep',&nbsp;'1000'],&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;childFDs={0:&nbsp;devnull,&nbsp;1:&nbsp;'r',&nbsp;2:'r'})&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;reactor.run()&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Run&nbsp;this,&nbsp;then:&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:menlo,consolas,&quot;courier&nbsp;new&quot;,monospace,sans-serif&quot;&nbsp;class=&quot;font&quot;&gt;lsof&nbsp;-I&nbsp;@localhost&lt;/span&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;will&nbsp;show&nbsp;that&nbsp;the&nbsp;child&nbsp;process&nbsp;has&nbsp;the&nbsp;socket&nbsp;open&nbsp;on&nbsp;FD&nbsp;0.&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Now&nbsp;I&nbsp;grant&nbsp;that&nbsp;there's&nbsp;no&nbsp;need&nbsp;to&nbsp;pass&nbsp;/dev/null&nbsp;to&nbsp;the&nbsp;stdin&nbsp;of&nbsp;the&nbsp;process.&nbsp;I&nbsp;should&nbsp;just&nbsp;leave&nbsp;0&nbsp;out&nbsp;of&nbsp;childFDs&nbsp;instead.&nbsp;But&nbsp;why&nbsp;does&nbsp;this&nbsp;not&nbsp;work?&nbsp;lsof&nbsp;shows&nbsp;that&nbsp;the&nbsp;socket&nbsp;is&nbsp;on&nbsp;FD&nbsp;3&nbsp;in&nbsp;the&nbsp;parent&nbsp;process,&nbsp;and&nbsp;the&nbsp;print&nbsp;statement&nbsp;shows&nbsp;that&nbsp;the&nbsp;FD&nbsp;of&nbsp;devnull&nbsp;is&nbsp;3&nbsp;as&nbsp;well!&nbsp;Am&nbsp;I&nbsp;missing&nbsp;something&nbsp;obvious?&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Peter.&lt;br&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;&lt;i&gt;am&lt;/i&gt;&nbsp;missing&nbsp;something&nbsp;obvious.&nbsp;The&nbsp;file&nbsp;opened&nbsp;by&nbsp;open()&nbsp;immediately&nbsp;goes&nbsp;out&nbsp;of&nbsp;scope.&nbsp;&nbsp;AAAUGH!&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Peter.&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
