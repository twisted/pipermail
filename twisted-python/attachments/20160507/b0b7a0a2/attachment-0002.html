<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&#39;m&nbsp;still&nbsp;working&nbsp;through&nbsp;your&nbsp;code&nbsp;example&nbsp;and&nbsp;trying&nbsp;to&nbsp;get&nbsp;a&nbsp;better&nbsp;grasp&nbsp;of&nbsp;what,&nbsp;exactly,&nbsp;you&#39;re&nbsp;trying&nbsp;to&nbsp;implement&nbsp;as&nbsp;far&nbsp;as&nbsp;client&nbsp;behavior&nbsp;is&nbsp;concerned.&nbsp;In&nbsp;the&nbsp;meantime,&nbsp;it&nbsp;sounds,&nbsp;on&nbsp;the&nbsp;surface,&nbsp;like&nbsp;you&nbsp;are&nbsp;trying&nbsp;to&nbsp;implement&nbsp;a&nbsp;form&nbsp;of&nbsp;the&nbsp;ReconnectingClientFactory:&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/current/api/twisted.internet.protocol.ReconnectingClientFactory.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/documents/current/api/twisted.internet.protocol.ReconnectingClientFactory.html&lt;/a&gt;.&lt;/div&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Your&nbsp;client&nbsp;protocol&nbsp;must&nbsp;be&nbsp;factory&nbsp;aware&nbsp;and&nbsp;call&nbsp;the&nbsp;resetDelay&nbsp;method&nbsp;on&nbsp;the&nbsp;factory&nbsp;when&nbsp;a&nbsp;connection&nbsp;is&nbsp;made,&nbsp;but&nbsp;the&nbsp;factory&nbsp;will&nbsp;handle&nbsp;reconnecting&nbsp;and&nbsp;generating&nbsp;a&nbsp;new&nbsp;protocol&nbsp;instance.&nbsp;Is&nbsp;that&nbsp;similar&nbsp;to&nbsp;what&nbsp;you&nbsp;are&nbsp;trying&nbsp;to&nbsp;accomplish?&nbsp;Maybe&nbsp;see&nbsp;also &nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/current/core/howto/clients.html#reconnection&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/documents/current/core/howto/clients.html#reconnection&lt;/a&gt;&nbsp;for&nbsp;a&nbsp;quick&nbsp;example&nbsp;of&nbsp;using&nbsp;the&nbsp;reconnecting&nbsp;factory.&lt;/p&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;On&nbsp;Fri,&nbsp;May&nbsp;6,&nbsp;2016,&nbsp;12:23&nbsp;Daniel&nbsp;Sutcliffe&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:dansut@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;dansut@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hello&nbsp;all,&nbsp;my&nbsp;first&nbsp;post&nbsp;here&nbsp;-&nbsp;only&nbsp;been&nbsp;using&nbsp;Twisted&nbsp;for&nbsp;about&nbsp;a&lt;br&gt;<br>
month&nbsp;and&nbsp;am&nbsp;also&nbsp;a&nbsp;relative&nbsp;newcomer&nbsp;to&nbsp;Python&nbsp;but&nbsp;have&nbsp;been&nbsp;coding&lt;br&gt;<br>
professionally&nbsp;for&nbsp;20+&nbsp;years.&nbsp;I&nbsp;was&nbsp;attracted&nbsp;to&nbsp;Twisted&nbsp;and&nbsp;Python&lt;br&gt;<br>
for&nbsp;a&nbsp;particular&nbsp;project&nbsp;purely&nbsp;because&nbsp;after&nbsp;research&nbsp;it&nbsp;seemed&nbsp;to&nbsp;be&lt;br&gt;<br>
the&nbsp;best&nbsp;tool&nbsp;for&nbsp;the&nbsp;job,&nbsp;and&nbsp;have&nbsp;actually&nbsp;been&nbsp;enjoying&nbsp;both&nbsp;Python&lt;br&gt;<br>
and&nbsp;Twisted&nbsp;much&nbsp;more&nbsp;than&nbsp;I&nbsp;ever&nbsp;thought&nbsp;I&nbsp;would.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;project&nbsp;I&nbsp;am&nbsp;coding&nbsp;towards&nbsp;is&nbsp;creating&nbsp;a&nbsp;sensor&nbsp;data&nbsp;collection&lt;br&gt;<br>
gateway.&nbsp;First&nbsp;iteration&nbsp;needs&nbsp;are&nbsp;simply&nbsp;pulling&nbsp;data&nbsp;from&nbsp;ModBus&nbsp;TCP&lt;br&gt;<br>
slave&nbsp;PLCs&nbsp;and&nbsp;writing&nbsp;it&nbsp;to&nbsp;a&nbsp;MySQL&nbsp;database,&nbsp;but&nbsp;goals&nbsp;beyond&nbsp;that&lt;br&gt;<br>
are&nbsp;making&nbsp;the&nbsp;source&nbsp;of&nbsp;the&nbsp;data&nbsp;and&nbsp;its&nbsp;destination(s)&nbsp;very&lt;br&gt;<br>
flexible(pluggable).&nbsp;Therefore&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;create&nbsp;a&nbsp;good&nbsp;clean&lt;br&gt;<br>
architecture&nbsp;from&nbsp;the&nbsp;outset&nbsp;so&nbsp;as&nbsp;I&nbsp;iterate&nbsp;forwards&nbsp;I&nbsp;don&#39;t&nbsp;finish&lt;br&gt;<br>
up&nbsp;having&nbsp;to&nbsp;take&nbsp;too&nbsp;many&nbsp;steps&nbsp;backwards&nbsp;before&nbsp;heading&nbsp;forwards.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;using&nbsp;pymodbus&nbsp;to&nbsp;pull&nbsp;the&nbsp;data&nbsp;which&nbsp;works&nbsp;well&nbsp;for&nbsp;my&nbsp;devices,&lt;br&gt;<br>
has&nbsp;a&nbsp;twisted&nbsp;async&nbsp;API,&nbsp;and&nbsp;have&nbsp;created&nbsp;more&nbsp;than&nbsp;a&nbsp;few&nbsp;prototypes&lt;br&gt;<br>
that&nbsp;demonstrate&nbsp;all&nbsp;works&nbsp;as&nbsp;I&nbsp;expect.&nbsp;Where&nbsp;I&nbsp;am&nbsp;a&nbsp;bit&nbsp;stalled&nbsp;is&lt;br&gt;<br>
getting&nbsp;to&nbsp;grips&nbsp;with&nbsp;a&nbsp;good&nbsp;architecture&nbsp;that&nbsp;fulfills&nbsp;my&nbsp;needs&nbsp;-&nbsp;my&lt;br&gt;<br>
intention&nbsp;is&nbsp;that&nbsp;the&nbsp;application&nbsp;that&nbsp;meets&nbsp;my&nbsp;first&nbsp;goal&nbsp;will&nbsp;be&nbsp;a&lt;br&gt;<br>
twistd&nbsp;plugin.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;new&nbsp;ClientService&nbsp;class&nbsp;seems&nbsp;like&nbsp;it&nbsp;will&nbsp;fit&nbsp;my&nbsp;needs&nbsp;very&lt;br&gt;<br>
closely&nbsp;but&nbsp;I&nbsp;am&nbsp;struggling&nbsp;with&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;reconnections...&nbsp;I&lt;br&gt;<br>
have&nbsp;been&nbsp;using&nbsp;the&nbsp;whenConnected()&nbsp;method&nbsp;to&nbsp;grab&nbsp;the&nbsp;Protocol&nbsp;for&lt;br&gt;<br>
the&nbsp;initial&nbsp;connection&nbsp;and&nbsp;then&nbsp;use&nbsp;a&nbsp;method&nbsp;of&nbsp;this&nbsp;to&nbsp;poll&nbsp;the&lt;br&gt;<br>
connected&nbsp;slave.&nbsp;When&nbsp;the&nbsp;connection&nbsp;is&nbsp;lost&nbsp;I&nbsp;get&nbsp;an&nbsp;errback&nbsp;from&lt;br&gt;<br>
this&nbsp;method&#39;s&nbsp;deferred&nbsp;which&nbsp;I&nbsp;use&nbsp;as&nbsp;a&nbsp;signal&nbsp;to&nbsp;abandon&nbsp;the&nbsp;Protocol&lt;br&gt;<br>
and&nbsp;call&nbsp;whenConnected()&nbsp;again...&nbsp;at&nbsp;this&nbsp;point&nbsp;I&nbsp;have&nbsp;an&nbsp;issue&nbsp;though&lt;br&gt;<br>
as&nbsp;the&nbsp;returned&nbsp;deferred&nbsp;immediately&nbsp;gives&nbsp;me&nbsp;a&nbsp;callback&nbsp;with&nbsp;the&nbsp;same&lt;br&gt;<br>
Protocol&nbsp;which&nbsp;has&nbsp;just&nbsp;lost&nbsp;its&nbsp;connection,&nbsp;and&nbsp;thus&nbsp;loop...&lt;br&gt;<br>
&lt;br&gt;<br>
Before&nbsp;I&nbsp;got&nbsp;on&nbsp;this&nbsp;mailing&nbsp;list&nbsp;I&nbsp;posted&nbsp;this&nbsp;Q&nbsp;to&nbsp;stackoverflow&lt;br&gt;<br>
with&nbsp;some&nbsp;example&nbsp;code:&lt;br&gt;<br>
 &nbsp; &nbsp;&lt;a&nbsp;href=&quot;http://stackoverflow.com/q/37061807/3448214&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://stackoverflow.com/q/37061807/3448214&lt;/a&gt;&lt;br&gt;<br>
but&nbsp;no&nbsp;solution&nbsp;or&nbsp;much&nbsp;attention&nbsp;there&nbsp;yet.&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;I&nbsp;say&nbsp;there,&nbsp;I&nbsp;realize&nbsp;I&nbsp;have&nbsp;probably&nbsp;just&nbsp;made&nbsp;a&nbsp;bad&nbsp;pattern&lt;br&gt;<br>
choice&nbsp;for&nbsp;how&nbsp;to&nbsp;use&nbsp;this&nbsp;API,&nbsp;but&nbsp;I&nbsp;have&nbsp;not&nbsp;been&nbsp;able&nbsp;to&nbsp;work&nbsp;out&nbsp;a&lt;br&gt;<br>
better&nbsp;choice&nbsp;which&nbsp;seems&nbsp;clean&nbsp;and&nbsp;fits&nbsp;my&nbsp;needs/understanding&nbsp;well.&lt;br&gt;<br>
I&nbsp;have&nbsp;tried&nbsp;deriving&nbsp;my&nbsp;own&nbsp;Protocol/Factory&nbsp;and&nbsp;handling&nbsp;the&nbsp;polling&lt;br&gt;<br>
there&nbsp;but&nbsp;this&nbsp;seems&nbsp;to&nbsp;get&nbsp;really&nbsp;messy&nbsp;once&nbsp;I&nbsp;start&nbsp;to&nbsp;add&nbsp;code&nbsp;to&lt;br&gt;<br>
get&nbsp;the&nbsp;collected&nbsp;data&nbsp;to&nbsp;a&nbsp;destination&nbsp;at&nbsp;that&nbsp;level,&nbsp;involving&lt;br&gt;<br>
giving&nbsp;the&nbsp;Protocol&nbsp;too&nbsp;much&nbsp;knowledge&nbsp;of&nbsp;how&nbsp;the&nbsp;data&nbsp;is&nbsp;to&nbsp;be&lt;br&gt;<br>
handled.&lt;br&gt;<br>
&lt;br&gt;<br>
Any&nbsp;advice,&nbsp;good&nbsp;patterns,&nbsp;or&nbsp;pointers&nbsp;to&nbsp;other&nbsp;projects&nbsp;which&nbsp;do&lt;br&gt;<br>
something&nbsp;similar&nbsp;is&nbsp;appreciated,&lt;br&gt;<br>
Cheers&lt;br&gt;<br>
/dan&lt;br&gt;<br>
--&lt;br&gt;<br>
Daniel&nbsp;Sutcliffe&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:dansut@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;dansut@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
