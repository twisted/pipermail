<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sat,&nbsp;Mar&nbsp;12,&nbsp;2011&nbsp;at&nbsp;3:32&nbsp;AM,&nbsp;Tim&nbsp;Allen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:screwtape@froup.com&quot;&gt;screwtape@froup.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;Fri,&nbsp;Mar&nbsp;11,&nbsp;2011&nbsp;at&nbsp;01:15:47PM&nbsp;-0600,&nbsp;SIC&nbsp;FS&nbsp;LIST&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;So&nbsp;far&nbsp;I&nbsp;have&nbsp;a&nbsp;&amp;quot;working&amp;quot;&nbsp;implementation&nbsp;...&nbsp;but&nbsp;I&amp;#39;m&nbsp;noticing&nbsp;that&nbsp;if&nbsp;I&nbsp;do&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;following:&lt;br&gt;<br>
&amp;gt;&nbsp;--&nbsp;log&nbsp;when&nbsp;a&nbsp;message&nbsp;is&nbsp;received&lt;br&gt;<br>
&amp;gt;&nbsp;--&nbsp;that&nbsp;for&nbsp;that&nbsp;message&nbsp;it&nbsp;&amp;quot;might&amp;quot;&nbsp;show&nbsp;up&nbsp;in&nbsp;the&nbsp;file&nbsp;a&nbsp;pretty&nbsp;lengthy&lt;br&gt;<br>
&amp;gt;&nbsp;period&nbsp;of&nbsp;time&nbsp;later&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Assuming&nbsp;the&nbsp;objects&nbsp;stored&nbsp;in&nbsp;DISKINFO[1]&nbsp;etc.&nbsp;are&nbsp;file&nbsp;objects,&nbsp;you&lt;br&gt;<br>
seem&nbsp;to&nbsp;be&nbsp;writing&nbsp;to&nbsp;the&nbsp;files&nbsp;but&nbsp;never&nbsp;calling&nbsp;flush().&nbsp;If&nbsp;you&nbsp;don&amp;#39;t&lt;br&gt;<br>
call&nbsp;flush(),&nbsp;Python&nbsp;(well,&nbsp;the&nbsp;C&nbsp;standard&nbsp;library)&nbsp;won&amp;#39;t&nbsp;send&nbsp;the&nbsp;data&lt;br&gt;<br>
on&nbsp;to&nbsp;the&nbsp;OS&nbsp;until&nbsp;its&nbsp;buffer&nbsp;is&nbsp;full,&nbsp;or&nbsp;the&nbsp;file&nbsp;handle&nbsp;is&nbsp;closed.&nbsp;If&lt;br&gt;<br>
you&amp;#39;re&nbsp;not&nbsp;getting&nbsp;that&nbsp;many&nbsp;log&nbsp;lines,&nbsp;it&nbsp;can&nbsp;take&nbsp;a&nbsp;while&nbsp;for&nbsp;that&nbsp;to&lt;br&gt;<br>
happen.&lt;br&gt;<br>
&lt;br&gt;<br>
Of&nbsp;course,&nbsp;if&nbsp;you&nbsp;flush&nbsp;after&nbsp;every&nbsp;disk&nbsp;read,&nbsp;your&nbsp;program&nbsp;will&nbsp;run&lt;br&gt;<br>
a&nbsp;bit&nbsp;more&nbsp;slowly&nbsp;and&nbsp;with&nbsp;more&nbsp;I/O...&nbsp;for&nbsp;an&nbsp;application&nbsp;where&lt;br&gt;<br>
reliability&nbsp;is&nbsp;more&nbsp;important&nbsp;than&nbsp;performance&nbsp;(like&nbsp;logging)&nbsp;that&amp;#39;s&lt;br&gt;<br>
probably&nbsp;acceptable.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;You&nbsp;may&nbsp;also&nbsp;setup&nbsp;a&nbsp;timer&nbsp;that&nbsp;flushes&nbsp;files&nbsp;every,&nbsp;say,&nbsp;5&nbsp;minutes.&lt;br&gt; &lt;br&gt;One&nbsp;other&nbsp;thing&nbsp;I&amp;#39;ve&nbsp;read&nbsp;in&nbsp;the&nbsp;Python.org&nbsp;site&nbsp;is&nbsp;that&nbsp;flush()&nbsp;is&nbsp;not&nbsp;100%&nbsp;sure&nbsp;to&nbsp;work&nbsp;immediately&nbsp;and&nbsp;should&nbsp;be&nbsp;used&nbsp;in&nbsp;combination&nbsp;with&nbsp;os.fsync().&nbsp;Is&nbsp;there&nbsp;someone&nbsp;that&nbsp;can&nbsp;explain&nbsp;if&nbsp;that&nbsp;is&nbsp;correct?&lt;br&gt;<br>
 &lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;actual&nbsp;UDP&nbsp;protocol:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;class&nbsp;VocsLogger(DatagramProtocol):&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp;def&nbsp;datagramReceived(self,&nbsp;data,&nbsp;(host,&nbsp;port)):&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_proc_msg(self.transport,&nbsp;data,&nbsp;(host,&lt;br&gt;<br>
&amp;gt;&nbsp;port))._new_msg().addCallback(handler)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;_proc_msg&nbsp;doesn&amp;#39;t&nbsp;seem&nbsp;to&nbsp;be&nbsp;complicated&nbsp;enough&nbsp;to&nbsp;need&nbsp;its&nbsp;own&nbsp;class,&lt;br&gt;<br>
why&nbsp;not&nbsp;just&nbsp;do&nbsp;what&nbsp;_proc_msg&nbsp;does&nbsp;in&nbsp;VocsLogger?&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;_proc_msg&nbsp;class:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;class&nbsp;_proc_msg:&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp;def&nbsp;__init__(self,&nbsp;sck,&nbsp;data,&nbsp;(host,&nbsp;port)):&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._sck&nbsp;=&nbsp;sck&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._data&nbsp;=&nbsp;data&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._host&nbsp;=&nbsp;host&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._port&nbsp;=&nbsp;port&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp;def&nbsp;_new_msg(self):&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;d,&nbsp;_&nbsp;=&nbsp;LogMsg().ParseSocketMsg(self._data)&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;d.type.upper()&nbsp;==&nbsp;DISKINFO[0]:&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DISKINFO[1].write(d.ToString()&nbsp;+&nbsp;&amp;quot;\n%s\n&amp;quot;&nbsp;%&nbsp;(LOG_DELIM))&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif&nbsp;d.type.upper()&nbsp;==&nbsp;LOADAVG[0]:&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LOADAVG[1].write(d.ToString()&nbsp;+&nbsp;&amp;quot;\n%s\n&amp;quot;&nbsp;%&nbsp;(LOG_DELIM))&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif&nbsp;d.type.upper()&nbsp;==&nbsp;MEMINFO[0]:&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MEMINFO[1].write(d.ToString()&nbsp;+&nbsp;&amp;quot;\n%s\n&amp;quot;&nbsp;%&nbsp;(LOG_DELIM))&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif&nbsp;d.type.upper()&nbsp;==&nbsp;NETDEV[0]:&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;NETDEV[1].write(d.ToString()&nbsp;+&nbsp;&amp;quot;\n%s\n&amp;quot;&nbsp;%&nbsp;(LOG_DELIM))&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif&nbsp;d.type.upper()&nbsp;==&nbsp;PSAUX[0]:&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PSAUX[1].write(d.ToString()&nbsp;+&nbsp;&amp;quot;\n%s\n&amp;quot;&nbsp;%&nbsp;(LOG_DELIM))&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif&nbsp;d.type.upper()&nbsp;==&nbsp;WHOINFO[0]:&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WHOINFO[1].write(d.ToString()&nbsp;+&nbsp;&amp;quot;\n%s\n&amp;quot;&nbsp;%&nbsp;(LOG_DELIM))&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else:&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DEFAULT[1].write(d.ToString()&nbsp;+&nbsp;&amp;quot;\n%s\n&amp;quot;&nbsp;%&nbsp;(LOG_DELIM))&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;It&nbsp;depends&nbsp;on&nbsp;what&nbsp;DISKINFO[0]&nbsp;and&nbsp;DISKINFO[1]&nbsp;actually&nbsp;are,&nbsp;but&lt;br&gt;<br>
assuming&nbsp;they&amp;#39;re&nbsp;a&nbsp;string&nbsp;and&nbsp;a&nbsp;file-handle,&nbsp;this&nbsp;code&nbsp;would&nbsp;look&nbsp;more&lt;br&gt;<br>
Pythonic&nbsp;as&nbsp;something&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
LOGSINKS&nbsp;=&nbsp;{&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;DISKINFO&amp;quot;:&nbsp;open(&amp;quot;/var/log/diskinfo&amp;quot;,&nbsp;&amp;quot;w&amp;quot;),&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;LOADAVG&amp;quot;:&nbsp;open(&amp;quot;/var/log/loadavg&amp;quot;,&nbsp;&amp;quot;w&amp;quot;),&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;MEMINFO&amp;quot;:&nbsp;open(&amp;quot;/var/log/meminfo&amp;quot;,&nbsp;&amp;quot;w&amp;quot;),&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;NETDEV&amp;quot;:&nbsp;open(&amp;quot;/var/log/netdev&amp;quot;,&nbsp;&amp;quot;w&amp;quot;),&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;PSAUX&amp;quot;:&nbsp;open(&amp;quot;/var/log/psaux&amp;quot;,&nbsp;&amp;quot;w&amp;quot;),&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;WHOINFO&amp;quot;:&nbsp;open(&amp;quot;/var/log/whoinfo&amp;quot;,&nbsp;&amp;quot;w&amp;quot;),&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;DEFAULT&amp;quot;:&nbsp;open(&amp;quot;/var/log/default&amp;quot;,&nbsp;&amp;quot;w&amp;quot;),&lt;br&gt;<br>
&nbsp; &nbsp; }&lt;br&gt;<br>
&lt;br&gt;<br>
def&nbsp;_new_msg(self,&nbsp;data):&lt;br&gt;<br>
&nbsp; &nbsp; d,&nbsp;_&nbsp;=&nbsp;LogMsg().ParseSocketMsg(data)&lt;br&gt;<br>
&nbsp; &nbsp; type&nbsp;=&nbsp;d.type.upper()&lt;br&gt;<br>
&nbsp; &nbsp; sink&nbsp;=&nbsp;LOGSINKS.get(type,&nbsp;LOGSINKS[&amp;#39;DEFAULT&amp;#39;])&lt;br&gt;<br>
&nbsp; &nbsp; sink.write(&amp;quot;%s\n%s\n&amp;quot;&nbsp;%&nbsp;(d.ToString(),&nbsp;LOG_DELIM))&lt;br&gt;<br>
&lt;br&gt;<br>
Hope&nbsp;that&nbsp;helps!&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
