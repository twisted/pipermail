<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;wondering&nbsp;how&nbsp;I&nbsp;should&nbsp;combine&nbsp;various&nbsp;twisted&nbsp;interfaces&lt;br&gt;in&nbsp;a&nbsp;way&nbsp;that&nbsp;makes&nbsp;sense.&nbsp;It&nbsp;probably&nbsp;shows&nbsp;here...&nbsp;that&nbsp;I&#39;m&nbsp;new&nbsp;to&nbsp;twisted.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;Linux&nbsp;iptables&nbsp;can&nbsp;log&nbsp;packets&nbsp;to&nbsp;the&nbsp;netfilter_log&nbsp;which&nbsp;can&nbsp;give&nbsp;access&nbsp;to&nbsp;user&nbsp;space.&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;wrote&nbsp;a&nbsp;simple&nbsp;twisted&nbsp;Reader&nbsp;(IReadDescriptor&nbsp;implementation)&nbsp;that&nbsp;is&nbsp;working&nbsp;functional&nbsp;code...&lt;br&gt;&lt;a&nbsp;href=&quot;https://gist.github.com/david415/6789612&quot;&gt;https://gist.github.com/david415/6789612&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;But&nbsp;since&nbsp;these&nbsp;are&nbsp;packets&nbsp;it&nbsp;returns...&nbsp;should&nbsp;I&nbsp;implement&nbsp;a&nbsp;&quot;read&nbsp;only&nbsp;Protocol&quot;?&lt;br&gt;&lt;div&gt;&lt;div&gt;The&nbsp;protocol&#39;s&nbsp;dataReceive()&nbsp;method&nbsp;could&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;NFLogReader&#39;s&nbsp;doRead()&nbsp;method.&lt;/div&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;div&gt;Does&nbsp;this&nbsp;mean&nbsp;that&nbsp;NFLogReader&nbsp;would&nbsp;be&nbsp;responsible&nbsp;for&nbsp;calling&nbsp;buildProtocol&nbsp;to&nbsp;construct&nbsp;the&nbsp;NFLogProtocol?&lt;/div&gt;&lt;div&gt;In&nbsp;the&nbsp;normal&nbsp;Twisted&nbsp;examples&nbsp;the&nbsp;buildProtocol&nbsp;seems&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;react&nbsp;loop..&lt;/div&gt;<br>
&lt;div&gt;&lt;div&gt;Should&nbsp;I&nbsp;pass&nbsp;the&nbsp;protocol&nbsp;factory&nbsp;and&nbsp;the&nbsp;reader&nbsp;to&nbsp;the&nbsp;service?&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;If&nbsp;I&nbsp;want&nbsp;to&nbsp;drop&nbsp;privileges&nbsp;right&nbsp;after&nbsp;retrieving&nbsp;the&nbsp;filedescriptor&nbsp;for&nbsp;netfilter_log,&nbsp;shall&nbsp;I&nbsp;use&nbsp;a&nbsp;Twisted&nbsp;Service/Application&nbsp;to&nbsp;drop&nbsp;the&nbsp;root&nbsp;privs&nbsp;to&nbsp;a&nbsp;non-superuser?&lt;br&gt;<br>
Should&nbsp;the&nbsp;privileges&nbsp;be&nbsp;dropped&nbsp;by&nbsp;the&nbsp;privilegedStartService()&nbsp;method?&lt;br&gt;The&nbsp;manual&nbsp;says&nbsp;that&nbsp;method&nbsp;is&nbsp;for&nbsp;preparing&nbsp;to&nbsp;drop&nbsp;services...&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;I&nbsp;want&nbsp;out&nbsp;of&nbsp;all&nbsp;of&nbsp;this&nbsp;is&nbsp;the&nbsp;most&nbsp;high&nbsp;performance&nbsp;and&nbsp;general&nbsp;solution&nbsp;to&nbsp;utilizing&nbsp;netfilter_log&nbsp;in&nbsp;twisted...&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;David&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
