<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=US-ASCII&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;5.5.2657.73&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[Twisted-Python]&nbsp;TCP&nbsp;Packet&nbsp;Size&nbsp;Considerations&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;JP&nbsp;wrote:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;gt;&nbsp;There&nbsp;are&nbsp;no&nbsp;such&nbsp;known&nbsp;limits.&amp;nbsp;&nbsp;I&nbsp;might&nbsp;even&nbsp;go&nbsp;as&nbsp;far&nbsp;to&nbsp;say&nbsp;that&nbsp;there&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;gt;&nbsp;are&nbsp;no&nbsp;such&nbsp;limits,&nbsp;if&nbsp;I&nbsp;were&nbsp;feeling&nbsp;daring.&nbsp;:)&amp;nbsp;&nbsp;Do&nbsp;you&nbsp;have&nbsp;a&nbsp;short&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;gt;&nbsp;program&nbsp;which&nbsp;demonstrates&nbsp;this&nbsp;behavior&nbsp;that&nbsp;you&nbsp;can&nbsp;share?&amp;nbsp;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;gt;&nbsp;Perhaps&nbsp;after&nbsp;looking&nbsp;at&nbsp;that&nbsp;someone&nbsp;can&nbsp;suggest&nbsp;the&nbsp;cause&nbsp;of&nbsp;the&nbsp;disconnects.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;After&nbsp;looking&nbsp;into&nbsp;it&nbsp;some&nbsp;more&nbsp;myself&nbsp;i&nbsp;realised&nbsp;an&nbsp;uncaught&nbsp;exception&nbsp;was&nbsp;dropping&nbsp;the&nbsp;connection&nbsp;but&nbsp;the&nbsp;after&nbsp;cutting&nbsp;my&nbsp;test&nbsp;code&nbsp;back&nbsp;to&nbsp;minimal&nbsp;functionality&nbsp;the&nbsp;inconsistency&nbsp;with&nbsp;received&nbsp;data&nbsp;was&nbsp;still&nbsp;there.&nbsp;The&nbsp;last&nbsp;4KB&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;received&nbsp;and&nbsp;the&nbsp;first&nbsp;14KB&nbsp;discarded&nbsp;somewhere!&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;I&nbsp;have&nbsp;created&nbsp;a&nbsp;minimal&nbsp;example&nbsp;from&nbsp;my&nbsp;initial&nbsp;test&nbsp;code.&nbsp;Start&nbsp;the&nbsp;simpleserver&nbsp;with&nbsp;twistd.py&nbsp;-y&nbsp;simpleserver.py&nbsp;and&nbsp;just&nbsp;run&nbsp;the&nbsp;simpleclient.py&nbsp;the&nbsp;builder.dat&nbsp;file&nbsp;is&nbsp;just&nbsp;a&nbsp;nonsense&nbsp;file&nbsp;that&nbsp;is&nbsp;about&nbsp;18KB&nbsp;in&nbsp;size.&nbsp;Testing&nbsp;on&nbsp;my&nbsp;machine&nbsp;produced&nbsp;a&nbsp;received.dat&nbsp;file&nbsp;which&nbsp;was&nbsp;4KB&nbsp;in&nbsp;size.&nbsp;I&nbsp;am&nbsp;currently&nbsp;using&nbsp;Python&nbsp;2.3.3&nbsp;and&nbsp;Twisted&nbsp;1.3.0.&nbsp;The&nbsp;code&nbsp;is&nbsp;as&nbsp;follows&nbsp;(and&nbsp;is&nbsp;also&nbsp;attached&nbsp;for&nbsp;convenient&nbsp;running):&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;###&nbsp;------------&nbsp;simpleclient.py&nbsp;---------------------------------&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;Protocol&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;import&nbsp;twisted.internet.error&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;from&nbsp;simpleprotos&nbsp;import&nbsp;SimpleClientFactory&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;factory&nbsp;=&nbsp;SimpleClientFactory()&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;#&nbsp;open&nbsp;a&nbsp;large&nbsp;nonsense&nbsp;file&nbsp;to&nbsp;send&nbsp;(18KB)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;f&nbsp;=&nbsp;file('builder.dat')&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;data&nbsp;=&nbsp;f.read()&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;print&nbsp;len(data)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;f.close()&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;reactor.connectTCP('127.0.0.1',&nbsp;10000,&nbsp;factory)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;reactor.callLater(1.0,&nbsp;factory.sendMessage,&nbsp;data)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;reactor.run()&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;###&nbsp;-------------&nbsp;end&nbsp;---------------------------------------------&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;###&nbsp;------------&nbsp;simpleserver.py&nbsp;----------------------------------&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;from&nbsp;twisted.application&nbsp;import&nbsp;internet&nbsp;#&nbsp;services&nbsp;that&nbsp;run&nbsp;TCP/SSL/etc.&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;from&nbsp;twisted.application&nbsp;import&nbsp;service&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;from&nbsp;simpleprotos&nbsp;import&nbsp;ServerDataConnection,&nbsp;SimpleFactory&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;def&nbsp;makeService():&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;factory&nbsp;=&nbsp;SimpleFactory()&nbsp;#&nbsp;here&nbsp;we&nbsp;create&nbsp;a&nbsp;ConnectionManager&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;internet.TCPServer(10000,&nbsp;factory)&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;application&nbsp;=&nbsp;service.Application(&amp;quot;Connection&nbsp;Manager&amp;quot;)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;sc&nbsp;=&nbsp;service.IServiceCollection(application)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;sc.addService(makeService())&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;###&nbsp;-------------&nbsp;end&nbsp;---------------------------------------------&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;###&nbsp;------------&nbsp;simpleprotos.py&nbsp;----------------------------------&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;ClientFactory,&nbsp;Factory,&nbsp;Protocol&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;class&nbsp;SimpleClientFactory(ClientFactory):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;buildProtocol(self,&nbsp;addr):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.p&nbsp;=&nbsp;ClientDataConnection()&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.p.factory&nbsp;=&nbsp;self&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;self.p&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;sendMessage(self,&nbsp;data):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;'p'):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.p.sendData(data)&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;class&nbsp;SimpleFactory(Factory):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;buildProtocol(self,&nbsp;addr):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.p&nbsp;=&nbsp;ServerDataConnection()&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.p.factory&nbsp;=&nbsp;self&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;self.p&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;class&nbsp;ServerDataConnection(Protocol):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;closeConnection(self):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.transport.loseConnection()&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;f&nbsp;=&nbsp;file('received.dat',&nbsp;'w')&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;f.write(data)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;f.close()&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;class&nbsp;ClientDataConnection(Protocol):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;closeConnection(self):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.transport.loseConnection()&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;sendData(self,&nbsp;data):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.transport.write(data)&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;###&nbsp;-------------&nbsp;end&nbsp;---------------------------------------------&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Regards,&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Grant&nbsp;McDonald&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;FACE=&quot;Arial&quot;&nbsp;SIZE=2&nbsp;COLOR=&quot;#000000&quot;&gt;&lt;/FONT&gt;&lt;FONT&nbsp;FACE=&quot;Arial&quot;&nbsp;SIZE=2&nbsp;COLOR=&quot;#000000&quot;&gt;&lt;/FONT&gt;&lt;FONT&nbsp;FACE=&quot;Arial&quot;&nbsp;SIZE=2&nbsp;COLOR=&quot;#000000&quot;&gt;&lt;/FONT&gt;&lt;FONT&nbsp;FACE=&quot;Arial&quot;&nbsp;SIZE=2&nbsp;COLOR=&quot;#000000&quot;&gt;&lt;/FONT&gt;&amp;nbsp;<br>
<br>
&lt;/BODY&gt;<br>
&lt;!--[object_id=#infocomp.com#]--&gt;&lt;P&gt;&lt;FONT&nbsp;face=Arial&nbsp;color=#808080&nbsp;size=1&gt;Important&nbsp;notice:&nbsp;This&nbsp;message&nbsp;is&nbsp;intended&nbsp;for&nbsp;the&nbsp;individual(s)&nbsp;and&nbsp;entity(s)&nbsp;addressed.&nbsp;The&nbsp;information&nbsp;contained&nbsp;in&nbsp;this&nbsp;transmission&nbsp;and&nbsp;any&nbsp;attached,&nbsp;may&nbsp;be&nbsp;confidential&nbsp;and&nbsp;may&nbsp;also&nbsp;be&nbsp;the&nbsp;subject&nbsp;of&nbsp;legal&nbsp;privilege,&nbsp;public&nbsp;interest&nbsp;immunity&nbsp;or&nbsp;legal&nbsp;professional&nbsp;privilege.&nbsp;Any&nbsp;review,&nbsp;retransmission,&nbsp;dissemination&nbsp;or&nbsp;other&nbsp;use&nbsp;of,&nbsp;taking&nbsp;of&nbsp;any&nbsp;action&nbsp;in&nbsp;reliance&nbsp;upon&nbsp;this&nbsp;information&nbsp;by&nbsp;person&nbsp;or&nbsp;entities&nbsp;other&nbsp;than&nbsp;the&nbsp;recipient&nbsp;is&nbsp;prohibited&nbsp;and&nbsp;requires&nbsp;authorization&nbsp;from&nbsp;the&nbsp;sender.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;addressee&nbsp;indicated&nbsp;in&nbsp;this&nbsp;message&nbsp;(or&nbsp;responsible&nbsp;for&nbsp;delivery&nbsp;of&nbsp;the&nbsp;message&nbsp;to&nbsp;such&nbsp;person)&nbsp;you&nbsp;may&nbsp;not&nbsp;copy&nbsp;or&nbsp;deliver&nbsp;this&nbsp;message&nbsp;to&nbsp;anyone.&nbsp;In&nbsp;such&nbsp;cases&nbsp;you&nbsp;should&nbsp;destroy&nbsp;this&nbsp;message&nbsp;and&nbsp;kindly&nbsp;notify&nbsp;the&nbsp;sender&nbsp;by&nbsp;reply&nbsp;email.&nbsp;&lt;/FONT&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;FONT&nbsp;face=Arial&nbsp;color=#808080&nbsp;size=1&gt;WARNING:&nbsp;Although&nbsp;Infocomp&nbsp;has&nbsp;taken&nbsp;reasonable&nbsp;precautions&nbsp;so&nbsp;that&nbsp;no&nbsp;viruses&amp;nbsp;are&nbsp;present&nbsp;in&nbsp;this&nbsp;e-mail,&nbsp;the&nbsp;company&nbsp;cannot&nbsp;accept&nbsp;responsibility&nbsp;for&nbsp;any&nbsp;loss&nbsp;or&nbsp;damage&nbsp;arising&nbsp;from&nbsp;the&nbsp;use&nbsp;of&nbsp;e-mail&nbsp;attachments.&lt;/FONT&gt;&lt;/P&gt;&lt;/HTML&gt;
</tt>
