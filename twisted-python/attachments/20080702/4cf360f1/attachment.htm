<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Jeff&nbsp;Dyke&nbsp;wrote:<br>
&lt;blockquote<br>
&nbsp;cite=&quot;mid:8496caf30807020539l5e1eca75t77bbe4a64c247ef8@mail.gmail.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;I&nbsp;just&nbsp;parse&nbsp;the&nbsp;twistd.pid&nbsp;file&nbsp;and&nbsp;os.kill(pid,&nbsp;signal.SIGTERM).&nbsp;&nbsp;This<br>
does&nbsp;a&nbsp;'nice'&nbsp;shutdown,&nbsp;each&nbsp;service&nbsp;that&nbsp;the&nbsp;twistd&nbsp;daemon&nbsp;is&nbsp;running&nbsp;will<br>
call&nbsp;it's&nbsp;stopService&nbsp;method&nbsp;for&nbsp;cleanup&nbsp;and&nbsp;shut&nbsp;down&nbsp;in&nbsp;an&nbsp;orderly&nbsp;manner.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;makes&nbsp;sense.<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;PS.&nbsp;the&nbsp;signal&nbsp;above&nbsp;is&nbsp;in&nbsp;a&nbsp;shutdown&nbsp;command&nbsp;in&nbsp;the&nbsp;app&nbsp;that&nbsp;does&nbsp;any<br>
necessary&nbsp;app&nbsp;level&nbsp;clean-up&nbsp;first,&nbsp;although&nbsp;I&nbsp;guess&nbsp;you&nbsp;could&nbsp;put&nbsp;that<br>
clean-up&nbsp;in&nbsp;your&nbsp;service's&nbsp;stopService&nbsp;method&nbsp;too.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
what&nbsp;do&nbsp;you&nbsp;mean&nbsp;is&nbsp;in&nbsp;a&nbsp;shutdown&nbsp;command&nbsp;in&nbsp;the&nbsp;app,&nbsp;how&nbsp;do&nbsp;you&nbsp;tell<br>
the&nbsp;app&nbsp;to&nbsp;execute&nbsp;the&nbsp;shutdown&nbsp;command&nbsp;containing&nbsp;os.kill?&nbsp;&nbsp;&nbsp;If&nbsp;i&nbsp;can<br>
figure&nbsp;all&nbsp;this&nbsp;out&nbsp;and&nbsp;more,&nbsp;i'd&nbsp;love&nbsp;to&nbsp;fulfill&nbsp;that&nbsp;feature<br>
request.<br>
<br>
thanks<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;handle_shutdown(self,&nbsp;user,&nbsp;*args):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;user.account.access&nbsp;is&nbsp;not&nbsp;AllAccess.Owner:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.hideCommand(user)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;pid&nbsp;=&nbsp;int(file('twistd.pid',&nbsp;mode&nbsp;=&nbsp;'r').readline())&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;os.kill(pid,&nbsp;signal.SIGUSR1)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;user.socket.sendToClient('Normal&nbsp;shutdown,&nbsp;rotating<br>
logfiles.\r\n')&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;os.kill(pid,&nbsp;signal.SIGTERM)&lt;br&gt;<br>
&lt;br&gt;<br>
Here's&nbsp;my&nbsp;handle_shutdown&nbsp;method,&nbsp;slightly&nbsp;abbreviated.&lt;br&gt;<br>
Just&nbsp;call&nbsp;this&nbsp;the&nbsp;same&nbsp;way&nbsp;you&nbsp;give&nbsp;the&nbsp;app&nbsp;any&nbsp;other&nbsp;input....IE:&nbsp;if<br>
it&nbsp;is&nbsp;a&nbsp;web&nbsp;app,&nbsp;put&nbsp;an&nbsp;admin&nbsp;control&nbsp;clickie&nbsp;somewhere&nbsp;that&nbsp;activates<br>
it.&amp;nbsp;&nbsp;If&nbsp;it&nbsp;is&nbsp;a&nbsp;custom&nbsp;client,&nbsp;put&nbsp;a&nbsp;control&nbsp;in&nbsp;that,&nbsp;if&nbsp;it&nbsp;is&nbsp;a&nbsp;direct<br>
TCP&nbsp;app&nbsp;(telnet)&nbsp;make&nbsp;the&nbsp;command&nbsp;parser&nbsp;call&nbsp;it&nbsp;when&nbsp;the&nbsp;user&nbsp;enters<br>
the&nbsp;proper&nbsp;command.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>
<br>
<br>

</tt>
