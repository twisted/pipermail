Index: twisted/protocols/imap4.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/imap4.py,v
retrieving revision 1.99
diff -u -r1.99 imap4.py
--- twisted/protocols/imap4.py	3 Jul 2003 08:13:09 -0000	1.99
+++ twisted/protocols/imap4.py	3 Jul 2003 11:02:19 -0000
@@ -438,6 +438,8 @@
     # Command data to be processed when literal data is received
     _pendingLiteral = None
 
+    _literalStringLimit = 4096
+
     # Challenge generators for AUTHENTICATE command
     challengers = None
     
@@ -567,6 +569,10 @@
             log.err(failure)
         
     def _stringLiteral(self, size):
+        if size > self._literalStringLimit:
+            raise IllegalClientResponse(
+                "Literal to long! I accept at most %d octets" %
+                (self._literalStringLimit))
         d = defer.Deferred()
         self._pendingLiteral = LiteralString(size, d)
         self.sendContinuationRequest('Ready for %d octets of text' % size)
