<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Jun&nbsp;18,&nbsp;2010&nbsp;at&nbsp;12:55&nbsp;PM,&nbsp;Szabolcs&nbsp;Balogh&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:bszabolcs@gmail.com&quot;&gt;bszabolcs@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;It&nbsp;is&nbsp;possible&nbsp;to:&lt;br&gt;<br>
 -&nbsp;start&nbsp;the&nbsp;reactor&nbsp;when&nbsp;I&nbsp;initialize&nbsp;my&nbsp;program&nbsp;(eg.&nbsp;in&nbsp;main)&lt;br&gt;<br>
 -&nbsp;call&nbsp;connectTCP&nbsp;or&nbsp;connectSSL&nbsp;when&nbsp;I&nbsp;want&nbsp;and&nbsp;every&nbsp;time&nbsp;I&nbsp;want?&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yes,&nbsp;this&nbsp;is&nbsp;exactly&nbsp;what&nbsp;you&nbsp;are&nbsp;supposed&nbsp;to&nbsp;do. &nbsp;Call&nbsp;the&nbsp;reactor&nbsp;_once_&nbsp;and&nbsp;once&nbsp;only.&lt;br&gt;&lt;br&gt;The&nbsp;call&nbsp;connectTCP&nbsp;or&nbsp;whatever&nbsp;whenever&nbsp;is&nbsp;appropriate&nbsp;for&nbsp;your&nbsp;program.&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
Something&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
def&nbsp;check_messages(account):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;connect&nbsp;to&nbsp;imap&nbsp;server&nbsp;and&nbsp;check&nbsp;for&nbsp;new&nbsp;mailboxes/messages&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; reactor.connectSSL(...)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; reactor.run()&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; check_message(account1)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; check_message(account2)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; ...&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; do&nbsp;something&nbsp;else&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; ...&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; check_message(accountn)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Because&nbsp;I&nbsp;can&#39;t&nbsp;implement&nbsp;this&nbsp;:}&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;started&nbsp;the&nbsp;implementation&nbsp;based&nbsp;on&nbsp;&quot;Twisted&nbsp;Network&nbsp;Programming&lt;br&gt;<br>
Essential&quot;,&nbsp;but&nbsp;this&nbsp;book&nbsp;doesn&#39;t&nbsp;treat&nbsp;multiple&nbsp;connections...&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;The&nbsp;above&nbsp;won&#39;t&nbsp;work,&nbsp;because&nbsp;run()&nbsp;blocks. &nbsp;So&nbsp;in&nbsp;your&nbsp;example&nbsp;here,&nbsp;check_messages()&nbsp;won&#39;t&nbsp;be&nbsp;called&nbsp;until&nbsp;after&nbsp;the&nbsp;run()&nbsp;call&nbsp;returns,&nbsp;which&nbsp;means&nbsp;the&nbsp;reactor&nbsp;won&#39;t&nbsp;be&nbsp;running,&nbsp;which&nbsp;means&nbsp;check_messages&nbsp;won&#39;t&nbsp;work.&lt;br&gt;<br>
&lt;br&gt;look&nbsp;into&nbsp;callWhenRunning:&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.interfaces.IReactorCore.html#callWhenRunning&quot;&gt;http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.interfaces.IReactorCore.html#callWhenRunning&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;and&nbsp;do&nbsp;something&nbsp;like:&lt;br&gt;&lt;br&gt;def&nbsp;start_checking():&lt;br&gt;   &nbsp;(do&nbsp;your&nbsp;check_messages&nbsp;stuff&nbsp;here)&lt;br&gt;&lt;br&gt;if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:&lt;br&gt;   &nbsp;reactor.callWhenRunning(start_checking)&lt;br&gt;   &nbsp;&lt;br&gt;   &nbsp;reactor.run()&lt;br&gt;&lt;br&gt;<br>
using&nbsp;callWhenRunning&nbsp;isn&#39;t&nbsp;necessary,&nbsp;but&nbsp;I&nbsp;find&nbsp;that&nbsp;it&nbsp;clarifies&nbsp;things&nbsp;for&nbsp;me&nbsp;sometimes&lt;br&gt;&lt;br&gt;reactor.run()&nbsp;is&nbsp;usually&nbsp;the&nbsp;_last_&nbsp;thing&nbsp;I&nbsp;call&nbsp;in&nbsp;my&nbsp;Twisted&nbsp;programs,&nbsp;unless&nbsp;I&nbsp;have&nbsp;some&nbsp;shutdown&nbsp;cleanup&nbsp;to&nbsp;do,&nbsp;and&nbsp;even&nbsp;that&nbsp;is&nbsp;usually&nbsp;better&nbsp;done&nbsp;in&nbsp;the&nbsp;reactor&nbsp;shutdown&nbsp;hook &nbsp;&lt;br&gt;<br>
(see:&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.interfaces.IReactorCore.html#addSystemEventTrigger&quot;&gt;http://twistedmatrix.com/documents/10.0.0/api/twisted.internet.interfaces.IReactorCore.html#addSystemEventTrigger&lt;/a&gt;)&lt;br&gt;<br>
&lt;br&gt;you&nbsp;also&nbsp;need&nbsp;to&nbsp;figure&nbsp;out&nbsp;how&nbsp;to&nbsp;structure&nbsp;your&nbsp;program&nbsp;flow&nbsp;using&nbsp;deferreds,&nbsp;which&nbsp;is&nbsp;not&nbsp;always&nbsp;easy,&nbsp;and&nbsp;depends&nbsp;greatly&nbsp;on&nbsp;your&nbsp;specific&nbsp;application.&lt;br&gt;&lt;br&gt;remember&nbsp;that&nbsp;deferreds&nbsp;are&nbsp;just&nbsp;a&nbsp;way&nbsp;of&nbsp;organizing&nbsp;callback&nbsp;functions&lt;br&gt;<br>
&lt;br&gt;you&nbsp;can&nbsp;&quot;chain&quot;&nbsp;deferreds&nbsp;something&nbsp;like&nbsp;this&nbsp;(assuming&nbsp;your&nbsp;functions&nbsp;return&nbsp;Deferreds):&lt;br&gt;&lt;br&gt;d&nbsp;=&nbsp;check_first_one()&lt;br&gt;d.addCallback(check_second_one,&nbsp;...)&lt;br&gt;&lt;br&gt;etc...&lt;br&gt;&lt;br&gt;which&nbsp;will&nbsp;make&nbsp;check_second_one&nbsp;start&nbsp;after&nbsp;check_first_one&nbsp;completes&lt;br&gt;<br>
&lt;br&gt;You&nbsp;can&nbsp;also&nbsp;use&nbsp;a&nbsp;deferredList,&nbsp;which&nbsp;is&nbsp;often&nbsp;handy&nbsp;when&nbsp;you&nbsp;want&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;several&nbsp;deferred&nbsp;operations&nbsp;which&nbsp;are&nbsp;operating&nbsp;simultaneously&lt;br&gt;(I&nbsp;haven&#39;t&nbsp;used&nbsp;one&nbsp;in&nbsp;a&nbsp;while,&nbsp;so&nbsp;I&nbsp;don&#39;t&nbsp;have&nbsp;a&nbsp;simple&nbsp;example&nbsp;off&nbsp;the&nbsp;top&nbsp;of&nbsp;my&nbsp;head,&nbsp;but&nbsp;there&#39;s&nbsp;a&nbsp;simple&nbsp;example&nbsp;in&nbsp;the&nbsp;Twisted&nbsp;book)&lt;br&gt;<br>
&lt;br&gt;Hope&nbsp;this&nbsp;helps,&lt;br&gt;&lt;br&gt;Kevin&nbsp;Horn&lt;br&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;visibility:&nbsp;hidden;&nbsp;display:&nbsp;inline;&quot;&nbsp;id=&quot;avg_ls_inline_popup&quot;&gt;&lt;/div&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;#avg_ls_inline_popup&nbsp;{&nbsp;&nbsp;position:absolute;&nbsp;&nbsp;z-index:9999;&nbsp;&nbsp;padding:&nbsp;0px&nbsp;0px;&nbsp;&nbsp;margin-left:&nbsp;0px;&nbsp;&nbsp;margin-top:&nbsp;0px;&nbsp;&nbsp;width:&nbsp;240px;&nbsp;&nbsp;overflow:&nbsp;hidden;&nbsp;&nbsp;word-wrap:&nbsp;break-word;&nbsp;&nbsp;color:&nbsp;black;&nbsp;&nbsp;font-size:&nbsp;10px;&nbsp;&nbsp;text-align:&nbsp;left;&nbsp;&nbsp;line-height:&nbsp;13px;}&lt;/style&gt;<br>

</tt>
