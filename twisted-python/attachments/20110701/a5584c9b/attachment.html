<tt>
Ok,&nbsp;here&nbsp;goes&nbsp;:&lt;br&gt;The&nbsp;test&nbsp;code&nbsp;:&lt;br&gt;&lt;br&gt;from&nbsp;twisted.trial&nbsp;import&nbsp;unittest&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;defer,&nbsp;protocol,&nbsp;reactor&lt;br&gt;class&nbsp;TestAccountStatus(unittest.TestCase):&lt;br&gt;    &nbsp;def&nbsp;setUp(self):&lt;br&gt;        &nbsp;ssh_server&nbsp;=&nbsp;Server()&lt;br&gt;<br>
        &nbsp;self.server&nbsp;=&nbsp;reactor.listenTCP(ssh_server.port,&nbsp;&lt;br&gt;                     &nbsp;ssh_server.application(),&nbsp;&lt;br&gt;                     &nbsp;interface=ssh_server.interface)&lt;br&gt;        &nbsp;return&nbsp;self.server&lt;br&gt;    &nbsp;def&nbsp;tearDown(self):&lt;br&gt;<br>
        &nbsp;server,&nbsp;self.server&nbsp;=&nbsp;self.server,None&lt;br&gt;        &nbsp;return&nbsp;server.stopListening()&lt;br&gt;    &nbsp;def&nbsp;test_1(self):&lt;br&gt;        &nbsp;def&nbsp;got_data(data):&lt;br&gt;            &nbsp;self.assertEquals(data,&quot;a&quot;)&lt;br&gt;        &nbsp;d&nbsp;=&nbsp;protocol.ClientCreator(reactor,&nbsp;SimpleTransport).connectTCP(&#39;localhost&#39;,&nbsp;self.server.getHost().port)&lt;br&gt;<br>
        &nbsp;d.addCallback(got_data)&lt;br&gt;        &nbsp;return&nbsp;d&lt;br&gt;&lt;br&gt;The&nbsp;client&nbsp;code&nbsp;:&lt;br&gt;from&nbsp;twisted.conch.ssh&nbsp;import&nbsp;transport,&nbsp;userauth,&nbsp;connection,&nbsp;common,&nbsp;keys,&nbsp;channel&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;defer,&nbsp;protocol,&nbsp;reactor&lt;br&gt;<br>
class&nbsp;SimpleTransport(transport.SSHClientTransport):&lt;br&gt;   &nbsp;def&nbsp;verifyHostKey(self,&nbsp;hostKey,&nbsp;fingerprint):&lt;br&gt;       &nbsp;print&nbsp;&#39;host&nbsp;key&nbsp;fingerprint:&nbsp;%s&#39;&nbsp;%&nbsp;fingerprint&lt;br&gt;       &nbsp;return&nbsp;defer.succeed(1)&nbsp;&lt;br&gt;&lt;br&gt;   &nbsp;def&nbsp;connectionSecure(self):&lt;br&gt;<br>
       &nbsp;self.requestService(&lt;br&gt;           &nbsp;SimpleUserAuth(&#39;webchick&#39;,&lt;br&gt;               &nbsp;SimpleConnection()))&lt;br&gt;&lt;br&gt;class&nbsp;SimpleUserAuth(userauth.SSHUserAuthClient):&lt;br&gt;   &nbsp;def&nbsp;getPassword(self):&lt;br&gt;       &nbsp;print&nbsp;&quot;Get&nbsp;Password&nbsp;called&quot;&lt;br&gt;<br>
       &nbsp;return&nbsp;defer.succeed(&quot;Thai1mil3ahb&quot;)&lt;br&gt;&lt;br&gt;When&nbsp;I&nbsp;run&nbsp;the&nbsp;test&nbsp;I&nbsp;expect&nbsp;:&lt;br&gt; &nbsp;tests&lt;br&gt; &nbsp;TestAccountStatus&lt;br&gt;   &nbsp;test_1&nbsp;...&nbsp;Get&nbsp;Password&nbsp;called&nbsp;&lt;br&gt;&lt;br&gt;followed&nbsp;by&nbsp;some&nbsp;errors&nbsp;,&nbsp;but&nbsp;atleast&nbsp;this&nbsp;much&nbsp;should&nbsp;be&nbsp;printed&nbsp;if&nbsp;the&nbsp;client&nbsp;code&nbsp;is&nbsp;being&nbsp;called&nbsp;properly.&lt;br&gt;<br>
Instead&nbsp;I&nbsp;get:&lt;br&gt;&lt;br&gt;[FAIL]:&nbsp;tests.TestAccountStatus.test_1&lt;br&gt;&lt;br&gt;Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):&lt;br&gt; &nbsp;File&nbsp;&quot;tests.py&quot;,&nbsp;line&nbsp;92,&nbsp;in&nbsp;got_data&lt;br&gt;   &nbsp;self.assertEquals(data,&quot;a&quot;)&lt;br&gt;twisted.trial.unittest.FailTest:&nbsp;not&nbsp;equal:&lt;br&gt;<br>
a&nbsp;=&nbsp;&lt;tests.SimpleTransport&nbsp;instance&nbsp;at&nbsp;0x1024aa128&gt;&lt;br&gt;b&nbsp;=&nbsp;&#39;a&#39;&lt;br&gt;&lt;br&gt;Instead&nbsp;of&nbsp;running&nbsp;the&nbsp;client&nbsp;the&nbsp;deferred&nbsp;is&nbsp;just&nbsp;returning&nbsp;an&nbsp;instance&nbsp;of&nbsp;the&nbsp;Client&nbsp;Transport&nbsp;used&nbsp;by&nbsp;me &nbsp;(SimpleTransport).&nbsp;Any&nbsp;ideas&nbsp;why&nbsp;this&nbsp;is&nbsp;happening?&nbsp;Is&nbsp;this&nbsp;becuse&nbsp;I&#39;m&nbsp;not&nbsp;using&nbsp;a&nbsp;ClientFactory&nbsp;or&nbsp;am&nbsp;I&nbsp;using&nbsp;the&nbsp;deferred&nbsp;all&nbsp;wrong?&nbsp;&lt;br&gt;<br>

</tt>
