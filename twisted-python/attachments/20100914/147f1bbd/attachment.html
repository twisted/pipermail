<tt>
&lt;pre&gt;Here&nbsp;is&nbsp;my&nbsp;code&nbsp;for&nbsp;Plug&nbsp;&#39;n&nbsp;Play&nbsp;detection&nbsp;of&nbsp;serial&nbsp;devices.&nbsp;It&#39;s&nbsp;not&nbsp;yet&nbsp;ready&nbsp;for&nbsp;showtime,&nbsp;but&nbsp;it&nbsp;works&nbsp;with&nbsp;my&nbsp;serial&nbsp;attached&nbsp;Wacom.&lt;br&gt;&lt;br&gt;Best&nbsp;regards,&lt;br&gt;eulores&lt;br&gt;&lt;br&gt;&lt;br&gt;#&nbsp;-*-&nbsp;coding:&nbsp;utf-8&nbsp;-*-&lt;br&gt;<br>
&lt;br&gt;import&nbsp;sys&lt;br&gt;if&nbsp;sys.platform&nbsp;==&nbsp;&#39;win32&#39;:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;win32eventreactor&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;win32eventreactor.install()&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor,&nbsp;protocol&lt;br&gt;from&nbsp;twisted.internet.task&nbsp;import&nbsp;deferLater,&nbsp;LoopingCall&lt;br&gt;<br>
from&nbsp;twisted.internet.defer&nbsp;import&nbsp;Deferred,&nbsp;inlineCallbacks,&nbsp;returnValue&lt;br&gt;from&nbsp;twisted.internet.serialport&nbsp;import&nbsp;*&lt;br&gt;import&nbsp;re&lt;br&gt;&lt;br&gt;def&nbsp;wait(seconds):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;deferLater(reactor,&nbsp;seconds,&nbsp;lambda:None)&lt;br&gt;&lt;br&gt;<br>
class&nbsp;StructuredPnP(object):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&#39;&#39;&nbsp;The&nbsp;structured&nbsp;PnP&nbsp;field&nbsp;is&nbsp;available&nbsp;with&nbsp;these&nbsp;fields:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;&nbsp;&nbsp;&nbsp;string,&nbsp;required.&nbsp;Original&nbsp;unformatted&nbsp;string.&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other:&nbsp;&nbsp;&nbsp;string,&nbsp;optional&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rev:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer,&nbsp;required.&nbsp;Revision&nbsp;of&nbsp;the&nbsp;PnP&nbsp;standard.&nbsp;100&nbsp;is&nbsp;standard&nbsp;version&nbsp;1.00&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eisa:&nbsp;&nbsp;&nbsp;&nbsp;string,&nbsp;required&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;product:&nbsp;string,&nbsp;required&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;serial:&nbsp;&nbsp;string,&nbsp;optional&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;klass:&nbsp;&nbsp;&nbsp;string,&nbsp;optional&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compat:&nbsp;&nbsp;string,&nbsp;optional.&nbsp;Other&nbsp;older&nbsp;products&nbsp;with&nbsp;similar&nbsp;functionality&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user:&nbsp;&nbsp;&nbsp;&nbsp;string,&nbsp;optional.&nbsp;Free&nbsp;flowing&nbsp;field&nbsp;useful&nbsp;for&nbsp;the&nbsp;end-user&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&#39;&#39;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;data):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#data&nbsp;=&nbsp;&#39;\\96,N,8,1(\x01$WAC0608\\\\PEN\\WAC0000\\WACOM&nbsp;UD\r\nUD-0608-R,V1.4-4\r\nF4)&#39;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;test&nbsp;string&nbsp;for&nbsp;a&nbsp;7-bit&nbsp;character&nbsp;string&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#data&nbsp;=&nbsp;&#39;aaa(bbcccdddd\\eeeeeeee\\fff\\gggg\\hhhhii)&#39;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;test&nbsp;string&nbsp;for&nbsp;a&nbsp;6-bit&nbsp;character&nbsp;string&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#data&nbsp;=&nbsp;&#39;AAA\x08BBCCCDDDD&lt;EEEEEEEE&lt;FFF&lt;GGGG&lt;HHHHII\x09&#39;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.data&nbsp;=&nbsp;data&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;&quot;other&nbsp;eisa&nbsp;product&nbsp;serial&nbsp;klass&nbsp;compat&nbsp;user&quot;.split():&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;key,&nbsp;&#39;&#39;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rev&nbsp;=&nbsp;&#39;\0\0&#39;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prologue&nbsp;=&nbsp;r&#39;(?P&lt;other&gt;[^(]{,16}?)&#39;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix&nbsp;=&nbsp;r&#39;(?P&lt;rev&gt;..)(?P&lt;eisa&gt;...)(?P&lt;product&gt;....)(?:@(?P&lt;serial&gt;[^@]{,8}))?(?:@(?P&lt;klass&gt;[^@]{,32}))?(?:@(?P&lt;compat&gt;[^@]{,40}))?(?:@(?P&lt;user&gt;.{,40}?))?(?:..)?&#39;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;needle1&nbsp;=&nbsp;prologue&nbsp;+&nbsp;&#39;\\(&#39;&nbsp;+&nbsp;matrix.replace(&#39;@&#39;,&#39;\\\\&#39;)&nbsp;+&nbsp;&#39;\\)&#39;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;needle2&nbsp;=&nbsp;prologue&nbsp;+&nbsp;&#39;\\\x08&#39;&nbsp;+&nbsp;matrix.replace(&#39;@&#39;,&#39;\\\x3C&#39;)&nbsp;+&nbsp;&#39;\\\x09&#39;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dct&nbsp;=&nbsp;dict()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mo&nbsp;=&nbsp;re.match(needle1,&nbsp;data,&nbsp;re.S)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mo:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dct&nbsp;=&nbsp;mo.groupdict()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mo&nbsp;=&nbsp;re.match(needle2,&nbsp;data,&nbsp;re.S)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mo:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dct&nbsp;=&nbsp;mo.groupdict()&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;&quot;eisa&nbsp;product&nbsp;serial&nbsp;klass&nbsp;compat&nbsp;user&quot;.split():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;=&nbsp;dct[k]&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dct[k]&nbsp;=&nbsp;&#39;&#39;.join([chr(ord(ch)+0x20)&nbsp;for&nbsp;ch&nbsp;in&nbsp;list(v)])&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k,v&nbsp;in&nbsp;dct.items():&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;k,&nbsp;v)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rev&nbsp;=&nbsp;((ord(self.rev[0])&amp;0x3f)&lt;&lt;6)&nbsp;+&nbsp;(ord(self.rev[1])&amp;0x3f)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__str__(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.data&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__repr__(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;[&#39;&lt;StructuredPnP&nbsp;object&gt;&nbsp;%r&#39;&nbsp;%&nbsp;self.data]&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;&quot;other&nbsp;rev&nbsp;eisa&nbsp;product&nbsp;serial&nbsp;klass&nbsp;compat&nbsp;user&quot;.split():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l.append(&#39;&nbsp;&nbsp;%-8s&nbsp;%r&#39;&nbsp;%&nbsp;(k,&nbsp;getattr(self,k,False)))&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;\n&#39;.join(l)&lt;br&gt;&lt;br&gt;class&nbsp;PnPProtocol(protocol.Protocol):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;&nbsp;See&nbsp;Plug&nbsp;and&nbsp;Play&nbsp;External&nbsp;COM&nbsp;device&nbsp;Specification,&nbsp;rev&nbsp;1.00&nbsp;from&nbsp;Microsoft&nbsp;&amp;&nbsp;Hayes,&nbsp;1994-1995&quot;&quot;&quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;deferred):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.deferred&nbsp;=&nbsp;deferred&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.data&nbsp;=&nbsp;&#39;&#39;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.timeout&nbsp;=&nbsp;1.4&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.T5&nbsp;=&nbsp;reactor.callLater(self.timeout,&nbsp;self.deliverPnP)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;deliverPnP(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.loseConnection()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.deferred&nbsp;is&nbsp;not&nbsp;None:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d,&nbsp;self.deferred&nbsp;=&nbsp;self.deferred,&nbsp;None&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.callback(StructuredPnP(self.data))&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.T5.reset(self.timeout)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.data&nbsp;+=&nbsp;data&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(self.data)&gt;=256:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.T5.reset(0)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;@inlineCallbacks&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionMade(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;1:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&quot;2.1.1&quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setDTR(1)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setRTS(0)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yield&nbsp;wait(0.2)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;self.transport.getDSR():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&quot;2.1.3&nbsp;part&nbsp;A&quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setDTR(0)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yield&nbsp;wait(0.2)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&quot;2.1.3&nbsp;part&nbsp;B&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setDTR(1)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yield&nbsp;wait(0.2)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&quot;2.1.4&quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setRTS(1)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;timer&nbsp;T5&nbsp;is&nbsp;now&nbsp;used&nbsp;for&nbsp;per-character&nbsp;timeout&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.timeout&nbsp;=&nbsp;0.2&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yield&nbsp;wait(0.2)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.data:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&quot;2.1.5&quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setDTR(0)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setRTS(0)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yield&nbsp;wait(0.2)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&quot;2.1.6&quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setDTR(1)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setRTS(1)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yield&nbsp;wait(0.2)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;self.data:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.T5.reset(0)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returnValue(None)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionLost(self,&nbsp;reason=&#39;connectionDone&#39;):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Connection&nbsp;lost:&quot;,&nbsp;reason&lt;br&gt;&lt;br&gt;def&nbsp;pnpString(port=0):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;Deferred()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;=&nbsp;PnPProtocol(d)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;try:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#SerialPort(protocol,&nbsp;port,&nbsp;reactor,&nbsp;baudrate=1200,&nbsp;bytesize=SEVENBITS,&nbsp;parity=PARITY_NONE,&nbsp;stopbits=STOPBITS_ONE,&nbsp;timeout=0,&nbsp;xonxoff=0,&nbsp;rtscts=0)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SerialPort(protocol,&nbsp;port,&nbsp;reactor,&nbsp;baudrate=1200,&nbsp;bytesize=SEVENBITS,&nbsp;parity=PARITY_NONE,&nbsp;stopbits=STOPBITS_ONE,&nbsp;xonxoff=0,&nbsp;rtscts=0)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;serial.SerialException:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.callback(StructuredPnP(&#39;&#39;))&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;d&lt;br&gt;&lt;br&gt;@inlineCallbacks&lt;br&gt;def&nbsp;imRunning():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;PnP&nbsp;string:&nbsp;%r&quot;&nbsp;%&nbsp;(yield&nbsp;pnpString(3))&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.stop()&lt;br&gt;<br>
&lt;br&gt;if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.callWhenRunning(imRunning)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.run()&lt;/pre&gt;&lt;br&gt;&lt;br&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;14,&nbsp;2010&nbsp;at&nbsp;11:24&nbsp;AM,&nbsp;Markus&nbsp;Hubig&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:mhubig@imko.de&quot;&gt;mhubig@imko.de&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi&nbsp;@all!&lt;br&gt;&gt;&nbsp;I&#39;m&nbsp;trying&nbsp;to&nbsp;write&nbsp;a&nbsp;python&nbsp;library&nbsp;module&nbsp;for&nbsp;a&nbsp;special&lt;br&gt;&gt;&nbsp;serial communication&nbsp;protocol&nbsp;called&nbsp;IMPBUS.&nbsp;To&nbsp;use&nbsp;the&nbsp;serial&lt;br&gt;&gt;&nbsp;interface&nbsp;for&nbsp;sending&nbsp;and receiving&nbsp;packets&nbsp;as&nbsp;for&nbsp;now&nbsp;I&#39;m&lt;br&gt;<br>
&gt;&nbsp;sub-classing&nbsp;pyserial.&nbsp;My&nbsp;code&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;&gt;&lt;br&gt;&gt;&nbsp;But&nbsp;the&nbsp;problem&nbsp;is&nbsp;that&nbsp;I&nbsp;can&#39;t&nbsp;use&nbsp;select&nbsp;with&nbsp;pyserial&nbsp;on&nbsp;Windows,&lt;br&gt;&gt;&nbsp;because&nbsp;it&nbsp;don&#39;t&nbsp;provide&nbsp;the fileno()&nbsp;methode.&nbsp;So&nbsp;after&nbsp;some&nbsp;googling&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;found twisted.internet.serialport&nbsp;&quot;A&nbsp;select()able&nbsp;serial&nbsp;device,&nbsp;acting&lt;br&gt;&gt;&nbsp;as&nbsp;a&nbsp;transport.&quot; &lt;br&gt;&gt;&nbsp;I&nbsp;never&nbsp;used&nbsp;twisted&nbsp;before&nbsp;so&nbsp;I&#39;m&nbsp;a&nbsp;little overwhelmed by&nbsp;how&nbsp;I&nbsp;can&lt;br&gt;&gt;&nbsp;replace&nbsp;pyserial&nbsp;with&nbsp;twisted&nbsp;in&nbsp;the&nbsp;code&nbsp;above&nbsp;... maybe&nbsp;someone&nbsp;can&lt;br&gt;<br>
&gt;&nbsp;point&nbsp;me&nbsp;to&nbsp;the&nbsp;right&nbsp;direction.&nbsp;It&nbsp;seems&nbsp;I&nbsp;need&nbsp;a&nbsp;&quot;Protocol&quot;&nbsp;and&nbsp;a&lt;br&gt;&gt;&nbsp;&quot;receiver&quot;&nbsp;... &lt;br&gt;&gt;&nbsp;-&nbsp;Markus&lt;br&gt;&gt;&nbsp;--&lt;br&gt;&lt;br&gt;<br>

</tt>
