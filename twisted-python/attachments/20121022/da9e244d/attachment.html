<tt>
From:&nbsp;&lt;a&nbsp;href=&quot;mailto:exarkun@twistedmatrix.com&quot;&gt;exarkun@twistedmatrix.com&lt;/a&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Subject:&nbsp;Re:&nbsp;[Twisted-Python]&nbsp;Adding&nbsp;mock&nbsp;as&nbsp;a&nbsp;test&nbsp;suite&nbsp;dependency&lt;br&gt;&lt;br&gt;<br>
On&nbsp;03:00&nbsp;am,&nbsp;&lt;a&nbsp;href=&quot;mailto:glyph@twistedmatrix.com&quot;&gt;glyph@twistedmatrix.com&lt;/a&gt;&nbsp;wrote:&lt;br&gt;&gt;Also&nbsp;I&nbsp;don&#39;t&nbsp;particularly&nbsp;like&nbsp;the&nbsp;testing&nbsp;style&nbsp;associated&nbsp;with&nbsp;Mock.&lt;br&gt;<br>
&gt;I&nbsp;think&nbsp;it&nbsp;might&nbsp;discourage&nbsp;us&nbsp;yet&nbsp;further&nbsp;from&nbsp;writing&nbsp;verified&nbsp;fakes,&lt;br&gt;<br>
&gt;i.e.&nbsp;supported&nbsp;in-memory&nbsp;implementations&nbsp;of&nbsp;things&nbsp;like&nbsp;IReactorTCP,&lt;br&gt;<br>
&gt;that&nbsp;have&nbsp;somewhat&nbsp;intricate&nbsp;behavior&nbsp;that&#39;s&nbsp;tedious&nbsp;to&nbsp;emulate&nbsp;with&lt;br&gt;<br>
&gt;Mock.&lt;br&gt;<br>
&lt;br&gt;<br>
I&#39;m&nbsp;also&nbsp;not&nbsp;a&nbsp;huge&nbsp;fan&nbsp;of&nbsp;the&nbsp;*unverified*&nbsp;mock&nbsp;style&nbsp;of&nbsp;testing.&nbsp; I&lt;br&gt;<br>
don&#39;t&nbsp;think&nbsp;anything&nbsp;says&nbsp;that&nbsp;mocks&nbsp;*have*&nbsp;to&nbsp;be&nbsp;unverified,&nbsp;though&nbsp;it&lt;br&gt;<br>
seems&nbsp;they&#39;re&nbsp;often&nbsp;used&nbsp;that&nbsp;way.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;mock&nbsp;library&nbsp;that&nbsp;got&nbsp;added&nbsp;to&nbsp;the&nbsp;stdlib&nbsp;has&nbsp;the&nbsp;notion&nbsp;of&lt;br&gt;<br>
constructing&nbsp;a&nbsp;mock&nbsp;using&nbsp;another&nbsp;object&nbsp;as&nbsp;a&nbsp;template.&nbsp; I&nbsp;haven&#39;t&nbsp;used&lt;br&gt;<br>
this&nbsp;feature,&nbsp;but&nbsp;it&nbsp;seems&nbsp;like&nbsp;the&nbsp;intent&nbsp;is&nbsp;to&nbsp;at&nbsp;least&nbsp;take&nbsp;a&nbsp;step&lt;br&gt;<br>
towards&nbsp;verification.&nbsp; It&#39;d&nbsp;be&nbsp;nice&nbsp;if&nbsp;someone&nbsp;who&nbsp;knows&nbsp;more&nbsp;about&nbsp;the&lt;br&gt;<br>
features&nbsp;of&nbsp;this&nbsp;library&nbsp;could&nbsp;give&nbsp;some&nbsp;examples.&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;case&nbsp;anyone&nbsp;isn&#39;t&nbsp;clear,&nbsp;the&nbsp;problem&nbsp;with&nbsp;unverified&nbsp;fakes&nbsp;is&nbsp;that&lt;br&gt;<br>
they&nbsp;either&nbsp;start&nbsp;out&nbsp;incompatible&nbsp;with&nbsp;the&nbsp;objects&nbsp;they&#39;re&nbsp;fakes&nbsp;of,&nbsp;or&lt;br&gt;<br>
else&nbsp;they&nbsp;become&nbsp;incompatible&nbsp;with&nbsp;them&nbsp;over&nbsp;time.&nbsp; Once&nbsp;they&#39;re&lt;br&gt;<br>
incompatible,&nbsp;the&nbsp;tests&nbsp;that&nbsp;use&nbsp;them&nbsp;become&nbsp;significantly&nbsp;less&nbsp;useful,&lt;br&gt;<br>
since&nbsp;they&nbsp;demonstrate&nbsp;little&nbsp;or&nbsp;nothing&nbsp;about&nbsp;what&nbsp;will&nbsp;happen&nbsp;when&nbsp;you&lt;br&gt;<br>
try&nbsp;to&nbsp;use&nbsp;the&nbsp;code&nbsp;for&nbsp;real.&lt;br&gt;<br>
&lt;br&gt;<br>
Verified&nbsp;fakes&nbsp;solve&nbsp;this&nbsp;problem&nbsp;by&nbsp;adding&nbsp;assertions&nbsp;that&nbsp;objects&nbsp;and&lt;br&gt;<br>
their&nbsp;fakes&nbsp;have&nbsp;the&nbsp;necessary&nbsp;overlap&nbsp;in&nbsp;either&nbsp;interface&nbsp;or&lt;br&gt;<br>
functionality&nbsp;in&nbsp;order&nbsp;for&nbsp;the&nbsp;tests&nbsp;using&nbsp;them&nbsp;to&nbsp;be&nbsp;valid.&lt;br&gt;<br>
&lt;br&gt;<br>
Beyond&nbsp;that,&nbsp;considering&nbsp;the&nbsp;particular&nbsp;example&nbsp;presented,&nbsp;I&nbsp;wouldn&#39;t&lt;br&gt;<br>
actually&nbsp;use&nbsp;mocks&nbsp;to&nbsp;test&nbsp;this.&nbsp; The&nbsp;real&nbsp;object,&nbsp;the&nbsp;debugger,&nbsp;should&lt;br&gt;<br>
be&nbsp;perfectly&nbsp;usable&nbsp;in&nbsp;unit&nbsp;tests.&nbsp; It&nbsp;doesn&#39;t&nbsp;allocate&nbsp;or&nbsp;depend&nbsp;on&lt;br&gt;<br>
expensive&nbsp;resources,&nbsp;it&nbsp;doesn&#39;t&nbsp;do&nbsp;network&nbsp;I/O,&nbsp;etc.&nbsp; Mocks&nbsp;are&nbsp;perhaps&lt;br&gt;<br>
an&nbsp;attractive&nbsp;nuisance&nbsp;that&nbsp;distract&nbsp;from&nbsp;coming&nbsp;up&nbsp;with&nbsp;a&nbsp;better&nbsp;test.&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Well&nbsp;it&nbsp;seems&nbsp;I&nbsp;sidestepped&nbsp;behavior&nbsp;vs.&nbsp;state&nbsp;but&nbsp;fell&nbsp;into&nbsp;isolationist&nbsp;vs&nbsp;integration&nbsp;:).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;reason&nbsp;I&nbsp;think&nbsp;even&nbsp;this&nbsp;was&nbsp;a&nbsp;reasonable&nbsp;example&nbsp;is&nbsp;because&nbsp;in&nbsp;the&nbsp;code&nbsp;that&nbsp;this&lt;/div&gt;<br>
&lt;div&gt;will&nbsp;test,&nbsp;there&nbsp;is&nbsp;no&nbsp;dependence&nbsp;on&nbsp;an&nbsp;actual&nbsp;debugger&nbsp;whatsoever.&nbsp;What&nbsp;this&nbsp;test&nbsp;should&lt;/div&gt;&lt;div&gt;be&nbsp;testing&nbsp;is&nbsp;that&nbsp;an&nbsp;object&nbsp;whose&nbsp;interface&nbsp;is&nbsp;irrelevant&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;test&nbsp;was&lt;/div&gt;&lt;div&gt;handed&nbsp;off&nbsp;to&nbsp;another&nbsp;method&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;that&nbsp;is&nbsp;expected.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;short,&nbsp;the&nbsp;isolationist&nbsp;view&nbsp;as&nbsp;I&nbsp;understand&nbsp;and&nbsp;have&nbsp;come&nbsp;to&nbsp;appreciate&nbsp;says&nbsp;that&lt;/div&gt;&lt;div&gt;mocks&nbsp;(in&nbsp;a&nbsp;broader&nbsp;sense&nbsp;here&nbsp;since&nbsp;these&nbsp;aren&#39;t&nbsp;true&nbsp;mocks&nbsp;I&nbsp;guess)&nbsp;aren&#39;t&nbsp;just&nbsp;for&lt;/div&gt;&lt;div&gt;cases&nbsp;where&nbsp;the&nbsp;real&nbsp;object&nbsp;is&nbsp;expensive&nbsp;or&nbsp;annoying&nbsp;to&nbsp;create&nbsp;–&nbsp;they&nbsp;also&nbsp;remove&lt;/div&gt;<br>
&lt;div&gt;irrelevant&nbsp;details&nbsp;from&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;test.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;being&nbsp;said&nbsp;though,&nbsp;I&#39;m&nbsp;still&nbsp;looking&nbsp;(read:&nbsp;I&nbsp;have&nbsp;not&nbsp;yet&nbsp;looked&nbsp;but&nbsp;will&nbsp;do&nbsp;so&nbsp;when&nbsp;I&lt;/div&gt;&lt;div&gt;get&nbsp;home)&nbsp;for&nbsp;actual&nbsp;examples&nbsp;in&nbsp;the&nbsp;test&nbsp;suite&nbsp;I&nbsp;can&nbsp;point&nbsp;to&nbsp;and&nbsp;say&nbsp;that&nbsp;real,&nbsp;actual&nbsp;mocks&lt;/div&gt;<br>
&lt;div&gt;would&nbsp;have&nbsp;helped&nbsp;if&nbsp;that&#39;s&nbsp;what&nbsp;you&#39;d&nbsp;be&nbsp;looking&nbsp;for.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;div&gt;To&nbsp;go&nbsp;back&nbsp;to&nbsp;your&nbsp;first&nbsp;point&nbsp;about&nbsp;verification,&nbsp;mock&nbsp;has&nbsp;a&nbsp;bunch&nbsp;of&nbsp;things&nbsp;there&nbsp;of&nbsp;which&lt;/div&gt;&lt;div&gt;if&nbsp;I&#39;m&nbsp;truthful&nbsp;I&nbsp;only&nbsp;use&nbsp;some&nbsp;of&nbsp;them&nbsp;with&nbsp;any&nbsp;regularity.&nbsp;The&nbsp;thing&nbsp;that&nbsp;sounds&nbsp;like&nbsp;what&lt;/div&gt;<br>
&lt;div&gt;you&#39;re&nbsp;referring&nbsp;to&nbsp;is&nbsp;likely&nbsp;the&nbsp;`spec`&nbsp;argument,&nbsp;which&nbsp;will&nbsp;do&nbsp;something&nbsp;like:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;import&nbsp;mock&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;from&nbsp;twisted.trial.itrial&nbsp;import&nbsp;ITestCase&lt;/div&gt;&lt;div&gt;<br>
&gt;&gt;&gt;&nbsp;testCase&nbsp;=&nbsp;mock.Mock(spec=ITestCase.names())&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;testCase.run&lt;/div&gt;&lt;div&gt;&lt;Mock&nbsp;name=&#39;mock.run&#39;&nbsp;id=&#39;4319309392&#39;&gt;&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;testCase.jump&lt;/div&gt;&lt;div&gt;Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):&lt;/div&gt;<br>
&lt;div&gt; &nbsp;File&nbsp;&quot;&lt;input&gt;&quot;,&nbsp;line&nbsp;1,&nbsp;in&nbsp;&lt;module&gt;&lt;/div&gt;&lt;div&gt; &nbsp;File&nbsp;&quot;/usr/local/Cellar/python/2.7.3/lib/python2.7/site-packages/mock.py&quot;,&nbsp;line&nbsp;647,&nbsp;in&nbsp;__getattr__&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;raise&nbsp;AttributeError(&quot;Mock&nbsp;object&nbsp;has&nbsp;no&nbsp;attribute&nbsp;%r&quot;&nbsp;%&nbsp;name)&lt;/div&gt;<br>
&lt;div&gt;AttributeError:&nbsp;Mock&nbsp;object&nbsp;has&nbsp;no&nbsp;attribute&nbsp;&#39;jump&#39;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;someone&nbsp;mentioned&nbsp;you&nbsp;also&nbsp;can&nbsp;hand&nbsp;it&nbsp;an&nbsp;implementor&nbsp;of&nbsp;ITestCase&nbsp;too&nbsp;but&nbsp;it&nbsp;will&nbsp;then&nbsp;pull&lt;/div&gt;&lt;div&gt;off&nbsp;all&nbsp;attributes&nbsp;that&nbsp;that&nbsp;object&nbsp;has.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&#39;s&nbsp;plenty&nbsp;more&nbsp;granularity,&nbsp;but&nbsp;like&nbsp;anything&nbsp;else&nbsp;the&nbsp;design&nbsp;of&nbsp;the&nbsp;test&nbsp;requires&nbsp;common&nbsp;sense.&lt;/div&gt;&lt;div&gt;If&nbsp;the&nbsp;test&nbsp;is&nbsp;meant&nbsp;to&nbsp;test&nbsp;how&nbsp;a&nbsp;specific&nbsp;method&nbsp;on&nbsp;the&nbsp;testCase&nbsp;mock&nbsp;is&nbsp;being&nbsp;used&nbsp;then&nbsp;assertions&lt;/div&gt;<br>
&lt;div&gt;on&nbsp;how&nbsp;it&nbsp;was&nbsp;called&nbsp;generally&nbsp;seem&nbsp;most&nbsp;natural.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;an&nbsp;alternate&nbsp;approach,&nbsp;I&#39;ve&nbsp;learned&nbsp;(from&nbsp;a&nbsp;few&nbsp;places&nbsp;I&nbsp;think)&nbsp;that&nbsp;in&nbsp;cases&nbsp;where&nbsp;I&nbsp;want&nbsp;to&nbsp;verify&lt;/div&gt;&lt;div&gt;that&nbsp;the places&nbsp;I&#39;ve&nbsp;mocked&nbsp;are&nbsp;being&nbsp;used&nbsp;in&nbsp;a&nbsp;way&nbsp;that&nbsp;isn&#39;t&nbsp;going&nbsp;to&nbsp;differ&nbsp;from&nbsp;their&nbsp;actual&nbsp;use&nbsp;in&nbsp;the&lt;/div&gt;<br>
&lt;div&gt;code, that&nbsp;a&nbsp;much&nbsp;wider&nbsp;scoped&nbsp;test&nbsp;that&nbsp;does&nbsp;integrate&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;a&nbsp;unit&nbsp;test can&nbsp;be&nbsp;helpful,&lt;/div&gt;&lt;div&gt;such&nbsp;that&nbsp;there&nbsp;are&nbsp;a&nbsp;whole&nbsp;bunch&nbsp;of&nbsp;isolated&nbsp;tests&nbsp;for&nbsp;each&nbsp;piece&nbsp;of&nbsp;logic&nbsp;and&nbsp;then&nbsp;one&nbsp;integrated&nbsp;test&lt;/div&gt;<br>
&lt;div&gt;that&nbsp;actually&nbsp;does&nbsp;push the&nbsp;real&nbsp;object&nbsp;through&nbsp;such&nbsp;that&nbsp;anyone&nbsp;who&nbsp;does&nbsp;change&nbsp;the&nbsp;way&nbsp;that&nbsp;the&nbsp;two&lt;/div&gt;&lt;div&gt;objects&nbsp;interacts&nbsp;still&nbsp;will&nbsp;have&nbsp;something&nbsp;telling&nbsp;them&nbsp;that&nbsp;the&nbsp;tests&nbsp;need&nbsp;updating&nbsp;as&nbsp;they&nbsp;would&nbsp;if&nbsp;all&nbsp;of&lt;/div&gt;<br>
&lt;div&gt;the&nbsp;tests&nbsp;integrated.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Jean-Paul&lt;br&gt;<br>
&gt;Personally&nbsp;I&#39;m&nbsp;-0.&nbsp; Don&#39;t&nbsp;let&nbsp;that&nbsp;stop&nbsp;you&nbsp;from&nbsp;cooking&nbsp;up&nbsp;a&nbsp;patch&lt;br&gt;<br>
&gt;that&nbsp;would&nbsp;include&nbsp;it&nbsp;though,&nbsp;I&nbsp;might&nbsp;be&nbsp;in&nbsp;the&nbsp;minority&nbsp;here.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;-glyph&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
