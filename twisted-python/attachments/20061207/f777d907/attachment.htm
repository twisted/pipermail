<tt>
Hello,&lt;br&gt;&lt;br&gt;I'm&nbsp;having&nbsp;a&nbsp;problem&nbsp;using&nbsp;twisted.enterprise.adbapi.&lt;br&gt;&lt;br&gt;The&nbsp;problem&nbsp;has&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;'delay_connect'&nbsp;option&nbsp;I&nbsp;send&nbsp;with&nbsp;my&nbsp;db&nbsp;connection&nbsp;kwargs.&amp;nbsp;&nbsp;I&nbsp;want&nbsp;to&nbsp;send&nbsp;sybase&nbsp;connection&nbsp;appname&nbsp;and&nbsp;hostname&nbsp;info.&amp;nbsp;&nbsp;The&nbsp;only&nbsp;way&nbsp;I&nbsp;can&nbsp;do&nbsp;this&nbsp;is&nbsp;<br>
using&nbsp;the&nbsp;delayed&nbsp;connect&nbsp;option.&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;div&nbsp;id=&quot;mb_0&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;br&gt;I&nbsp;have&nbsp;the&nbsp;following&nbsp;standalone&nbsp;program&nbsp;example&nbsp;that&nbsp;works&nbsp;just&nbsp;fine:&lt;br&gt;&lt;br&gt;vrdb&nbsp;=&nbsp;vr_db('billing_db',&nbsp;'appname')&amp;nbsp;&nbsp;&amp;nbsp;<br>
&lt;br&gt;#&nbsp;vr_db&nbsp;just&nbsp;is&nbsp;a&nbsp;helper&nbsp;class&nbsp;for&nbsp;logical&nbsp;dbname&nbsp;-&amp;gt;&nbsp;db&nbsp;connection&nbsp;info&lt;br&gt;&lt;br&gt;db_kwargs&amp;nbsp;&nbsp;=&nbsp;vrdb.return_kwargs()&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;br&gt;<br>
&lt;br&gt;db_kwargs['cp_min']&nbsp;=&nbsp;1&amp;nbsp;&nbsp;#&nbsp;one&nbsp;thread&nbsp;min&lt;br&gt;db_kwargs['cp_max']&nbsp;=&nbsp;1&amp;nbsp;&nbsp;#&nbsp;one&nbsp;thread&nbsp;max&amp;nbsp;&nbsp;=&nbsp;only&nbsp;one&nbsp;db&nbsp;connection&lt;br&gt;db_kwargs['cp_reconnect']&nbsp;=&nbsp;1&amp;nbsp;&nbsp;#&nbsp;reconnect&nbsp;if&nbsp;die&lt;br&gt;db_kwargs['cp_noisy']&nbsp;=&amp;nbsp;&nbsp;1&lt;br&gt;db_kwargs['delay_connect']&nbsp;=&nbsp;1&nbsp;#&amp;nbsp;&nbsp;do&nbsp;the&nbsp;delayed&nbsp;connect<br>
&lt;br&gt;db_kwargs['cp_openfun']&nbsp;=&nbsp;vrdb._vrdbOptions&lt;br&gt;&lt;br&gt;print&nbsp;db_kwargs&lt;br&gt;dbpool&nbsp;=&nbsp;adbapi.ConnectionPool(vrdb.return_import_name(),&nbsp;**db_kwargs)&lt;br&gt;&lt;br&gt;#&nbsp;_vrdbOptions&nbsp;adds&nbsp;the&nbsp;following&nbsp;two&nbsp;things&nbsp;to&nbsp;the&nbsp;connection&lt;br&gt;#&nbsp;<br>
conn.set_property<br>
(Sybase.CS_HOSTNAME,&nbsp;self.hostname)&nbsp;&lt;br&gt;<br>
<br>
#&nbsp;conn.set_property(Sybase.CS_APPNAME,&nbsp;self.appname)&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&lt;br&gt;a&nbsp;=&nbsp;storage(dbpool,&nbsp;d)&lt;br&gt;a.run()&lt;br&gt;reactor.run()&lt;br&gt;&lt;br&gt;run&nbsp;does&nbsp;a&nbsp;sql&nbsp;query.&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;run(self):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;'''&nbsp;utility&nbsp;method&nbsp;if&nbsp;the&nbsp;script&nbsp;is&nbsp;called&nbsp;directly&nbsp;'''&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.get_campaign_info('id',&nbsp;588103).addCallback(<br>
self.print_result).addErrback(self.error_happened)&lt;br&gt;&lt;br&gt;This<br>
works&nbsp;fine&nbsp;and&nbsp;dandy.&amp;nbsp;&nbsp;With&nbsp;the&nbsp;hostname&nbsp;and&nbsp;appname&nbsp;showing&nbsp;up&nbsp;in&nbsp;my<br>
sp_who&nbsp;optput&nbsp;(show's&nbsp;you&nbsp;who's&nbsp;logged&nbsp;in&nbsp;from&nbsp;where&nbsp;with&nbsp;what&nbsp;appname<br>
)&nbsp;&lt;br&gt;&lt;br&gt;Now&nbsp;my&nbsp;problem&nbsp;is&nbsp;when&nbsp;I&nbsp;use&nbsp;the&nbsp;database&nbsp;connection&nbsp;part&nbsp;in<br>
makeService(config)&nbsp;and&nbsp;pass&nbsp;a&nbsp;dbpool&nbsp;to&nbsp;a&nbsp;service,&nbsp;my&nbsp;service&nbsp;starts<br>
up&nbsp;fine,&amp;nbsp;&nbsp;but&nbsp;when&nbsp;&lt;br&gt;I&nbsp;have&nbsp;a&nbsp;database&nbsp;operation&nbsp;I&nbsp;get&nbsp;this:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;br&gt;&lt;br&gt;2006/12/07&nbsp;15:46:17&nbsp;PST&nbsp;[-]&nbsp;[Failure&nbsp;instance:&nbsp;Traceback:&nbsp;<br>
twisted.enterprise.adbapi.ConnectionLost:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;/usr/lib/python2.4/threading.py:422:run&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;/usr/lib/python2.4/site-packages/twisted/python/threadpool.py:148:_worker&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;/usr/lib/python2.4/site-packages/twisted/python/context.py:59:callWithContext<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;/usr/lib/python2.4/site-packages/twisted/python/context.py:37:callWithContext&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;---&nbsp;&amp;lt;exception&nbsp;caught&nbsp;here&amp;gt;&nbsp;---&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;/usr/lib/python2.4/site-packages/twisted/internet/threads.py:25:_putResultInDeferred<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;/usr/lib/python2.4/site-packages/twisted/enterprise/adbapi.py:379:_runInteraction&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;/usr/lib/python2.4/site-packages/twisted/enterprise/adbapi.py:64:rollback&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;]&lt;br&gt;&lt;br&gt;&lt;br&gt;So<br>
I've&nbsp;reverted&nbsp;my&nbsp;code&nbsp;to&nbsp;pass&nbsp;db_kwargs['delay_connect']&nbsp;=&nbsp;0&nbsp;and&nbsp;it's<br>
working&nbsp;fine&nbsp;as&nbsp;long&nbsp;as&nbsp;I&nbsp;don't&nbsp;try&nbsp;the&nbsp;delay_connect.&amp;nbsp;&amp;nbsp;&nbsp;I'm&amp;nbsp;&nbsp;hoping<br>
someone&nbsp;has&nbsp;seen&nbsp;this&nbsp;before&nbsp;and&nbsp;can&nbsp;point&nbsp;me&nbsp;in&nbsp;the&nbsp;right&nbsp;direction.&amp;nbsp;<br>
I'd&nbsp;really&nbsp;like&nbsp;to&nbsp;have&nbsp;my&nbsp;appname&nbsp;and&nbsp;hostname&nbsp;show&nbsp;up&nbsp;on&nbsp;the&nbsp;db&nbsp;side.<br>
&lt;br&gt;&lt;br&gt;I'm&nbsp;using&nbsp;twisted,&nbsp;sybase&nbsp;12.5,&amp;nbsp;&nbsp;and&nbsp;the&nbsp;most&nbsp;recent&nbsp;Sybase<br>
module.&amp;nbsp;&nbsp;The&nbsp;only&nbsp;difference&nbsp;is&nbsp;the&nbsp;way&nbsp;I'm&nbsp;connecting&nbsp;is&nbsp;one&nbsp;program<br>
is&nbsp;a&nbsp;tap&nbsp;created&nbsp;from&nbsp;mktap&nbsp;and&nbsp;the&nbsp;other&nbsp;a&nbsp;standalone&nbsp;script.&lt;br&gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;import&nbsp;Sybase<br>
&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Sybase.__version__&lt;br&gt;'0.37'&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;import&nbsp;twisted&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;twisted.__version__&lt;br&gt;'2.4.0'&lt;br&gt;&lt;br&gt;Thanks&lt;br&gt;&lt;br&gt;-rob&lt;br&gt;&lt;span&nbsp;class=&quot;sg&quot;&gt;&lt;/span&gt;&lt;/div&gt;<br>

</tt>
