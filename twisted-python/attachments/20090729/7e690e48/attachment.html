<tt>
On&nbsp;Wed,&nbsp;Jul&nbsp;29,&nbsp;2009&nbsp;at&nbsp;6:08&nbsp;PM,&nbsp;Laurens&nbsp;Van&nbsp;Houtven&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:lvh@laurensvh.be&quot;&gt;lvh@laurensvh.be&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
As&nbsp;you&nbsp;might&nbsp;remember,&nbsp;we&nbsp;(thanks&nbsp;to&nbsp;the&nbsp;adhoc&nbsp;code&nbsp;reviews&nbsp;from&lt;br&gt;<br>
glyph,&nbsp;tazle,&nbsp;dash&nbsp;andexarkun)&nbsp;decided&nbsp;on&nbsp;an&nbsp;implementation&nbsp;slightly&lt;br&gt;<br>
different&nbsp;from&nbsp;the&nbsp;original&nbsp;one,&nbsp;using:&lt;br&gt;<br>
&nbsp; &nbsp; -&nbsp;an&nbsp;NMEAReceiver&nbsp;class,&nbsp;which&nbsp;*only*&nbsp;does&nbsp;the&nbsp;receiving&nbsp;bit&nbsp;and&lt;br&gt;<br>
is&nbsp;perfectly&nbsp;stateless:&nbsp;this&nbsp;does&nbsp;things&nbsp;like&nbsp;unpacking&nbsp;the&nbsp;sentence&lt;br&gt;<br>
and&nbsp;checking&nbsp;the&nbsp;checksum&lt;br&gt;<br>
&nbsp; &nbsp; -&nbsp;an&nbsp;IPositioningReceiver&nbsp;(now&nbsp;renamed&nbsp;IPositioningProvider,&nbsp;but&lt;br&gt;<br>
I&#39;m&nbsp;not&nbsp;sure&nbsp;that&#39;s&nbsp;the&nbsp;right&nbsp;name&nbsp;yet)&nbsp;interface&nbsp;that&nbsp;has&nbsp;a&nbsp;bunch&nbsp;of&lt;br&gt;<br>
*sane*&nbsp;callbacks&nbsp;--&nbsp;ones&nbsp;you&nbsp;actually&nbsp;want&nbsp;instead&nbsp;of&nbsp;ones&nbsp;that&nbsp;are&lt;br&gt;<br>
directly&nbsp;a&nbsp;consequence&nbsp;of&nbsp;NMEA&nbsp;being&nbsp;a&nbsp;steaming&nbsp;pile&nbsp;of&nbsp;dung&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Presumably&nbsp;the&nbsp;future&nbsp;plan&nbsp;is&nbsp;to&nbsp;have&nbsp;IPositioningProvider&nbsp;that&nbsp;receives&nbsp;data&nbsp;from&nbsp;something&nbsp;other&nbsp;than&nbsp;NMEA,&nbsp;as&nbsp;well? &nbsp;(Other&nbsp;GPS&nbsp;protocols,&nbsp;whatever&nbsp;cell&nbsp;phones&nbsp;give&nbsp;you&nbsp;for&nbsp;triangulation,&nbsp;skyhook,&nbsp;etc.)&lt;br&gt;<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;  &nbsp;-&nbsp;an&nbsp;NMEAAdapter&nbsp;that&nbsp;would&nbsp;adapt&nbsp;the&nbsp;receiver&nbsp;and&nbsp;keep&nbsp;as&nbsp;much&lt;br&gt;<br>
state&nbsp;as&nbsp;necessary&nbsp;internally&nbsp;to&nbsp;produce&nbsp;the&nbsp;meaningful&nbsp;callbacks&nbsp;as&lt;br&gt;<br>
defined&nbsp;in&nbsp;the&nbsp;interface&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;This&nbsp;all&nbsp;sounds&nbsp;good.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Here&#39;s&nbsp;the&nbsp;code&nbsp;right&nbsp;now:&nbsp;&lt;a&nbsp;href=&quot;http://bit.ly/1azA5q&quot;&nbsp;target=&quot;_blank&quot;&gt;http://bit.ly/1azA5q&lt;/a&gt;&lt;br&gt;<br>
<br>
The&nbsp;interface&nbsp;lives&nbsp;in&nbsp;this&nbsp;file:&nbsp;&lt;a&nbsp;href=&quot;http://bit.ly/3wWL2c&quot;&nbsp;target=&quot;_blank&quot;&gt;http://bit.ly/3wWL2c&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;think&nbsp;you&nbsp;mean&nbsp;the&nbsp;interface&nbsp;lives&nbsp;in&nbsp;this&nbsp;file:&nbsp;&lt;a&nbsp;href=&quot;http://bit.ly/5Jc7p&quot;&gt;http://bit.ly/5Jc7p&lt;/a&gt;  &nbsp;(Your&nbsp;second&nbsp;link&nbsp;was&nbsp;to&nbsp;a&nbsp;directory.)&lt;br&gt;&lt;br&gt;A&nbsp;minor&nbsp;nit&nbsp;here,&nbsp;would&nbsp;you&nbsp;put&nbsp;the&nbsp;interfaces&nbsp;in&nbsp;their&nbsp;own&nbsp;module,&nbsp;&#39;twisted.position.ipositioning&#39;? &nbsp;There&nbsp;are&nbsp;use-cases&nbsp;where&nbsp;one&nbsp;may&nbsp;want&nbsp;to&nbsp;import&nbsp;interfaces,&nbsp;but&nbsp;not&nbsp;actually&nbsp;load&nbsp;any&nbsp;of&nbsp;the&nbsp;code&nbsp;from&nbsp;a&nbsp;package,&nbsp;so&nbsp;in&nbsp;new&nbsp;code&nbsp;we&nbsp;try&nbsp;to&nbsp;segregate&nbsp;them&nbsp;out&nbsp;into&nbsp;their&nbsp;own&nbsp;modules.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;I&nbsp;originally&nbsp;thought&nbsp;that&nbsp;the&nbsp;NMEAAdapter&nbsp;(which&nbsp;adapts&nbsp;an&lt;br&gt;<br>
NMEAReceiver&nbsp;to&nbsp;the&nbsp; IPositioningReceiver&nbsp;interface)&nbsp;was&nbsp;really&nbsp;an&lt;br&gt;<br>
adapter&nbsp;in&nbsp;the&nbsp;twisted.python.components&nbsp;sense&nbsp;of&nbsp;the&nbsp;word,&nbsp;so&nbsp;that&lt;br&gt;<br>
you&nbsp;could&nbsp;do&nbsp;something&nbsp;like&nbsp;PositioningReceiver(NMEAReceiver())&nbsp;and&lt;br&gt;<br>
you&#39;d&nbsp;get&nbsp;and&nbsp;NMEAAdapter&nbsp;object,&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;Twisted&lt;br&gt;<br>
components&nbsp;howto.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;This&nbsp;is&nbsp;the&nbsp;relationship,&nbsp;but&nbsp;it&#39;s&nbsp;backwards&nbsp;:).&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;The&nbsp;problem&nbsp;is&nbsp;attaching&nbsp;the&nbsp;method&nbsp;stubs&nbsp;in&nbsp;NMEAReceiver&nbsp;(nmea_GPGGA,&lt;br&gt;<br>
<br>
nmea_GPRMC,&nbsp;nmea_GPGSV)&nbsp;to&nbsp;the&nbsp;methods&nbsp;in&nbsp;the&nbsp;NMEAAdapter&nbsp;that&lt;br&gt;<br>
actually&nbsp;interpret&nbsp;these&nbsp;sentences.&nbsp;Ordinarily,&nbsp;you&#39;d&nbsp;subclass&nbsp;that&lt;br&gt;<br>
class&nbsp;to&nbsp;override&nbsp;those&nbsp;stubs.&nbsp;How&nbsp;do&nbsp;you&nbsp;feel&nbsp;this&nbsp;should&nbsp;be&nbsp;done&lt;br&gt;<br>
while&nbsp;keeping&nbsp;the&nbsp;adapter?&nbsp;Should&nbsp;we&nbsp;keep&nbsp;the&nbsp;adapter&nbsp;at&nbsp;all?&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;There&nbsp;are&nbsp;multiple&nbsp;layers&nbsp;here. &nbsp;Let&#39;s&nbsp;have&nbsp;an&nbsp;object&nbsp;for&nbsp;each&nbsp;layer. &nbsp;The&nbsp;NMEA&nbsp;protocol&nbsp;parser&nbsp;object&nbsp;should&nbsp;send&nbsp;NMEA-sentence&nbsp;events&nbsp;to&nbsp;a&nbsp;sentence&nbsp;receiver&nbsp;object,&nbsp;then&nbsp;there&nbsp;should&nbsp;be&nbsp;an&nbsp;implementation&nbsp;of&nbsp;the&nbsp;sentence-receiver&nbsp;interface&nbsp;which&nbsp;generates&nbsp;positioning&nbsp;events&nbsp;and&nbsp;sends&nbsp;them&nbsp;on&nbsp;to&nbsp;a&nbsp;positioning-receiver&nbsp;interface.&lt;br&gt;<br>
&lt;br&gt;The&nbsp;dispatch&nbsp;from&nbsp;the&nbsp;nmea-sentence-received&nbsp;method&nbsp;to&nbsp;the&nbsp;nmea_-prefixed&nbsp;methods&nbsp;is&nbsp;an&nbsp;internal&nbsp;implementation&nbsp;detail&nbsp;of&nbsp;the&nbsp;specific&nbsp;implementation&nbsp;of&nbsp;the&nbsp;NMEA-event-to-positioning-event&nbsp;object,&nbsp;which&nbsp;users&nbsp;can&nbsp;subclass&nbsp;if&nbsp;they&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;same&nbsp;dispatch.&lt;br&gt;<br>
&lt;br&gt;I&#39;ve&nbsp;attached&nbsp;a&nbsp;sketch,&nbsp;but&nbsp;it&nbsp;elides&nbsp;certain&nbsp;details&nbsp;like&nbsp;set-up&nbsp;and&nbsp;tear-down;&nbsp;there&nbsp;should&nbsp;be&nbsp;methods&nbsp;which&nbsp;allow&nbsp;users&nbsp;to&nbsp;tell&nbsp;when&nbsp;sentences&nbsp;and&nbsp;positions&nbsp;start&nbsp;and&nbsp;stop&nbsp;arriving. &nbsp;The&nbsp;gist&nbsp;would&nbsp;be&nbsp;to&nbsp;have&nbsp;a&nbsp;connectionMade&nbsp;and&nbsp;connectionLost&nbsp;invoke&nbsp;startReceivingNMEA,&nbsp;stopReceivingNMEA,&nbsp;which&nbsp;in&nbsp;turn&nbsp;would&nbsp;invoke&nbsp;startReceivingPositions,&nbsp;and&nbsp;stopReceivingPositions.&lt;br&gt;<br>
&lt;br&gt;There&nbsp;should&nbsp;also&nbsp;be&nbsp;a&nbsp;factory&nbsp;which&nbsp;nicely&nbsp;hooks&nbsp;everything&nbsp;together&nbsp;and&nbsp;takes&nbsp;only&nbsp;a&nbsp;factory&nbsp;for&nbsp;your&nbsp;IPositioningProvider,&nbsp;so&nbsp;that&nbsp;users&nbsp;can&nbsp;quickly&nbsp;get&nbsp;started&nbsp;with&nbsp;a&nbsp;positioning&nbsp;provider.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Of&nbsp;course,&nbsp;I&nbsp;could&nbsp;do&nbsp;ugly&nbsp;things&nbsp;in&nbsp;the&nbsp;adapters&#39;&nbsp;__init__&nbsp;like:&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Let&#39;s&nbsp;please&nbsp;not&nbsp;do&nbsp;that;&nbsp;there&#39;s&nbsp;no&nbsp;reason&nbsp;to.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
But&nbsp;that&nbsp;looks&nbsp;like&nbsp;a&nbsp;really&nbsp;bad&nbsp;idea:&nbsp;it&#39;s&nbsp;like&nbsp;I&#39;m&nbsp;subverting&lt;br&gt;<br>
inheritance.&nbsp;Instead,&nbsp;I&#39;m&nbsp;currently&nbsp;doing&nbsp;this&nbsp;by&nbsp;subclassing&nbsp;the&lt;br&gt;<br>
receiver&nbsp;(thanks&nbsp;to&nbsp;exarkun&nbsp;for&nbsp;this&nbsp;suggestion):&lt;/blockquote&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;class&nbsp;NMEAAdapter(NMEAReceiver):&lt;br&gt;<br>
<br>
&lt;/blockquote&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;This&nbsp;fixes&nbsp;the&nbsp;method&nbsp;stubs&nbsp;being&nbsp;correctly&nbsp;assigned&nbsp;(I&nbsp;suppose&nbsp;the&lt;br&gt;<br>
<br>
correct&nbsp;term&nbsp;would&nbsp;be&nbsp;overriding,&nbsp;through&nbsp;plain&nbsp;old&nbsp;inheritance).&nbsp;The&lt;br&gt;<br>
problem&nbsp;is&nbsp;that&nbsp;neither&nbsp;the&nbsp;interface&nbsp;nor&nbsp;components/adapters&nbsp;are&lt;br&gt;<br>
involved&nbsp;in&nbsp;any&nbsp;way,&nbsp;so&nbsp;I&nbsp;feel&nbsp;like&nbsp;I&#39;m&nbsp;missing&nbsp;something&nbsp;important.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;This&nbsp;is&nbsp;an&nbsp;OK&nbsp;approach,&nbsp;convenient,&nbsp;and&nbsp;less&nbsp;code&nbsp;than&nbsp;what&nbsp;I&#39;m&nbsp;proposing,&nbsp;but&nbsp;it&nbsp;means&nbsp;that&nbsp;users&nbsp;need&nbsp;to&nbsp;subclass&nbsp;something&nbsp;to&nbsp;get&nbsp;the&nbsp;functionality&nbsp;they&nbsp;want,&nbsp;and&nbsp;there&#39;s&nbsp;no&nbsp;nice,&nbsp;clean&nbsp;interface&nbsp;that&nbsp;just&nbsp;describes&nbsp;what&nbsp;your&nbsp;application&nbsp;needs&nbsp;to&nbsp;do&nbsp;at&nbsp;each&nbsp;level.&lt;br&gt;<br>
&lt;br&gt;That&nbsp;might&nbsp;be&nbsp;fine&nbsp;if&nbsp;you&nbsp;really&nbsp;want&nbsp;to&nbsp;punt&nbsp;on&nbsp;allowing&nbsp;anyone&nbsp;to&nbsp;deal&nbsp;with&nbsp;NMEA&nbsp;data&nbsp;directly,&nbsp;but&nbsp;given&nbsp;that&nbsp;the&nbsp;object&nbsp;is&nbsp;going&nbsp;to&nbsp;be&nbsp;public&nbsp;and&nbsp;subclassing&nbsp;is&nbsp;going&nbsp;to&nbsp;be&nbsp;possible&nbsp;anyway,&nbsp;I&#39;d&nbsp;rather&nbsp;that&nbsp;it&nbsp;be&nbsp;nice&nbsp;and&nbsp;clean. &nbsp;When&nbsp;we&nbsp;did&nbsp;twisted.words&nbsp;for&nbsp;example,&nbsp;I&nbsp;assumed&nbsp;that&nbsp;everyone&nbsp;would&nbsp;want&nbsp;the&nbsp;nice,&nbsp;&quot;high&nbsp;level&quot;&nbsp;interface&nbsp;that&nbsp;abstractly&nbsp;defined&nbsp;chat&nbsp;events,&nbsp;but&nbsp;instead&nbsp;users&nbsp;want&nbsp;to&nbsp;write&nbsp;XMPP&nbsp;and&nbsp;IRC&nbsp;bots&nbsp;directly,&nbsp;dealing&nbsp;with&nbsp;gross&nbsp;protocol&nbsp;implementation&nbsp;details&nbsp;in&nbsp;their&nbsp;applications. &nbsp;I&nbsp;suspect&nbsp;that&nbsp;will&nbsp;be&nbsp;less&nbsp;common&nbsp;in&nbsp;the&nbsp;world&nbsp;of&nbsp;positioning&nbsp;data,&nbsp;but&nbsp;I&nbsp;certainly&nbsp;don&#39;t&nbsp;know&nbsp;for&nbsp;sure,&nbsp;and&nbsp;it&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid&nbsp;having&nbsp;to&nbsp;suppot&nbsp;a&nbsp;grotty&nbsp;subclassing&nbsp;interface&nbsp;in&nbsp;the&nbsp;future,&nbsp;since&nbsp;the&nbsp;whole&nbsp;point&nbsp;of&nbsp;this&nbsp;nice&nbsp;new&nbsp;system&nbsp;is&nbsp;to&nbsp;get&nbsp;rid&nbsp;of&nbsp;our&nbsp;old&nbsp;grotty&nbsp;interfaces&nbsp;:).&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
