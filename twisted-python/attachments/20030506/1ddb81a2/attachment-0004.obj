--- stikiwiki.py.orig	Tue May  6 15:11:39 2003
+++ stikiwiki.py	Tue May  6 15:11:28 2003
@@ -290,11 +290,14 @@
 
     def render(self, request):
         pub = core.Publisher()
-        pub.set_reader('restructuredtext', None, 'restructuredtext')
+        pub.set_reader('standalone', None, 'restructuredtext')
         pub.set_writer('html')
-        pub.set_options()
-        pub.options._destination = ''
-        pub.options.stylesheet = '/default.css'
+        pub.get_settings()
+        pub.settings._destination = ''
+        pub.settings.stylesheet = '/default.css'
+        pub.settings.report_level = 5
+        pub.settings.halt_level = 6
+        pub.settings.warning_stream = StringIO()
         source = self.value
         uri = request.uri
         if not uri.endswith("/"):
@@ -305,12 +308,8 @@
 `Edit this?`_
             
 .. _`edit this?`: %s""" % (uri)
-        pub.source = io.StringIO(pub.options, source = source)
-        pub.destination = io.StringIO(pub.options)
-        pub.options.report_level = 5
-        pub.options.halt_level = 6
-        warnings = StringIO()
-        pub.options.warning_stream = warnings
+        pub.source = io.StringInput(pub.settings, source = source)
+        pub.destination = io.StringOutput(pub.settings)
         return pub.publish()
 
     def putChild(self, path, res):
