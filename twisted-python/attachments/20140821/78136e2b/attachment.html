<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&gt;On&nbsp;Aug&nbsp;19,&nbsp;2014,&nbsp;at&nbsp;3:58&nbsp;PM,&nbsp;Jan&nbsp;Pobrislo&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ccx@webprojekty.cz&quot;&gt;ccx@webprojekty.cz&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;On&nbsp;Thu,&nbsp;14&nbsp;Aug&nbsp;2014&nbsp;14:29:56&nbsp;-0700&lt;br&gt;Glyph&nbsp;Lefkowitz&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:glyph@twistedmatrix.com&quot;&gt;glyph@twistedmatrix.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;On&nbsp;Aug&nbsp;11,&nbsp;2014,&nbsp;at&nbsp;6:51&nbsp;AM,&nbsp;&lt;a&nbsp;href=&quot;mailto:ccx@webprojekty.cz&quot;&gt;ccx@webprojekty.cz&lt;/a&gt;&nbsp;wrote:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Hello,&nbsp;I've&nbsp;been&nbsp;playing&nbsp;with&nbsp;the&nbsp;new&nbsp;tubes&nbsp;that&nbsp;are&nbsp;being&lt;br&gt;implemented:&lt;br&gt;&lt;a&nbsp;href=&quot;http://comments.gmane.org/gmane.comp.python.twisted/27248&quot;&gt;http://comments.gmane.org/gmane.comp.python.twisted/27248&lt;/a&gt;&lt;br&gt;https://twistedmatrix.com/trac/ticket/1956&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Thanks&nbsp;so&nbsp;much&nbsp;for&nbsp;taking&nbsp;the&nbsp;time&nbsp;to&nbsp;play&nbsp;with&nbsp;it,&nbsp;and&nbsp;taking&nbsp;some&lt;br&gt;time&nbsp;to&nbsp;write&nbsp;feedback.&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Here&nbsp;are&nbsp;few&nbsp;things&nbsp;that&nbsp;I&nbsp;did&nbsp;with&nbsp;it.&nbsp;I&nbsp;won't&nbsp;publish&nbsp;the&nbsp;full&lt;br&gt;code&nbsp;now,&nbsp;as&nbsp;in&nbsp;it's&nbsp;current&nbsp;shape&nbsp;it&nbsp;could&nbsp;implode&nbsp;eyeballs&nbsp;of&lt;br&gt;twisted&nbsp;devs&nbsp;and&nbsp;possibly&nbsp;make&nbsp;them&nbsp;summon&nbsp;some&nbsp;of&nbsp;the&nbsp;elder&nbsp;gods,&lt;br&gt;but&nbsp;I'll&nbsp;see&nbsp;if&nbsp;I&nbsp;can&nbsp;produce&nbsp;something&nbsp;less&nbsp;vile&nbsp;as&nbsp;I&nbsp;merge&nbsp;the&lt;br&gt;ongoing&nbsp;changes&nbsp;to&nbsp;the&nbsp;tubes&nbsp;branch.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I'd&nbsp;be&nbsp;interested&nbsp;to&nbsp;see&nbsp;the&nbsp;code&nbsp;nevertheless.&nbsp;&nbsp;If&nbsp;you&nbsp;had&nbsp;to&nbsp;do&lt;br&gt;eyeball-imploding&nbsp;antics&nbsp;to&nbsp;get&nbsp;Tubes&nbsp;to&nbsp;work&nbsp;well&nbsp;for&nbsp;your&nbsp;use-case,&lt;br&gt;being&nbsp;able&nbsp;to&nbsp;have&nbsp;a&nbsp;look&nbsp;at&nbsp;that&nbsp;would&nbsp;help&nbsp;us&nbsp;evaluate&nbsp;whether&lt;br&gt;those&nbsp;antics&nbsp;were&nbsp;required&nbsp;by&nbsp;the&nbsp;code,&nbsp;encouraged&nbsp;by&nbsp;misfeatures&nbsp;of&lt;br&gt;the&nbsp;API&nbsp;design,&nbsp;or&nbsp;just&nbsp;issues&nbsp;with&nbsp;lack&nbsp;of&nbsp;documentation.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;It's&nbsp;mostly&nbsp;me&nbsp;not&nbsp;really&nbsp;documenting&nbsp;anything,&nbsp;not&nbsp;writing&nbsp;tests&nbsp;and&lt;br&gt;littering&nbsp;it&nbsp;with&nbsp;debug&nbsp;statements&nbsp;(which&nbsp;will&nbsp;go&nbsp;away&nbsp;as&nbsp;soon&nbsp;as&nbsp;I&lt;br&gt;find&nbsp;time&nbsp;to&nbsp;improve&nbsp;my&nbsp;debugging&nbsp;module&nbsp;so&nbsp;it&nbsp;can&nbsp;monkeypatch&nbsp;them).&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;debug&nbsp;tubes&nbsp;mostly&nbsp;with&nbsp;composition&nbsp;to&nbsp;analyze&nbsp;flows.&nbsp;&nbsp;If&nbsp;you&nbsp;can't&nbsp;do&nbsp;what&nbsp;you&nbsp;want&nbsp;with&nbsp;that,&nbsp;we&nbsp;should&nbsp;talk&nbsp;:-).&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;a&nbsp;href=&quot;http://wpr.cz/ccx/bzr/tubes7/&quot;&gt;http://wpr.cz/ccx/bzr/tubes7/&lt;/a&gt;&lt;span&nbsp;class=&quot;Apple-converted-space&quot;&gt;&nbsp;&lt;/span&gt;for&nbsp;my&nbsp;changes&nbsp;only&lt;br&gt;&lt;a&nbsp;href=&quot;http://wpr.cz/ccx/bzr/tubes7-merge-2/&quot;&gt;http://wpr.cz/ccx/bzr/tubes7-merge-2/&lt;/a&gt;&lt;span&nbsp;class=&quot;Apple-converted-space&quot;&gt;&nbsp;&lt;/span&gt;for&nbsp;changes&nbsp;on&nbsp;top&nbsp;of&nbsp;the&nbsp;bzr&lt;br&gt;mirror&nbsp;of&nbsp;the&nbsp;svn&nbsp;branch&lt;br&gt;&lt;br&gt;example&nbsp;usage:&lt;br&gt;&lt;a&nbsp;href=&quot;http://wpr.cz/ccx/paste/2014-08-19/2/&quot;&gt;http://wpr.cz/ccx/paste/2014-08-19/2/&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://wpr.cz/ccx/paste/2014-08-19/3/&quot;&gt;http://wpr.cz/ccx/paste/2014-08-19/3/&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://wpr.cz/ccx/paste/2014-08-19/4/&quot;&gt;http://wpr.cz/ccx/paste/2014-08-19/4/&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://wpr.cz/ccx/paste/2014-08-19/5/&quot;&gt;http://wpr.cz/ccx/paste/2014-08-19/5/&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;div&gt;I&nbsp;think&nbsp;I&nbsp;don't&nbsp;understand&nbsp;the&nbsp;purpose&nbsp;of&nbsp;all&nbsp;of&nbsp;these.&nbsp;&nbsp;Particularly,&nbsp;what&nbsp;is&nbsp;the&nbsp;purpose&nbsp;of&nbsp;TypedTube,&nbsp;since&nbsp;Tube&nbsp;already&nbsp;supports&nbsp;specification&nbsp;of&nbsp;input&nbsp;and&nbsp;output&nbsp;types?&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;So&nbsp;far&nbsp;I&nbsp;wrote&nbsp;relatively&nbsp;simple&nbsp;app&nbsp;that&nbsp;read&nbsp;logfiles,&nbsp;parse&nbsp;them&lt;br&gt;and&nbsp;insert&nbsp;what&nbsp;they&nbsp;got&nbsp;out&nbsp;of&nbsp;them&nbsp;into&nbsp;a&nbsp;database.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;If&nbsp;it's&nbsp;actually&nbsp;reading&nbsp;a&nbsp;file,&nbsp;another&nbsp;nice&nbsp;to-do&nbsp;would&nbsp;be&nbsp;an&lt;br&gt;IFount&nbsp;provider&nbsp;that&nbsp;provides&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;file&nbsp;with&nbsp;appropriate&lt;br&gt;flow&nbsp;control,&nbsp;and&nbsp;maybe&nbsp;a&nbsp;thread&nbsp;or&nbsp;process&nbsp;in&nbsp;the&nbsp;background&nbsp;to&nbsp;do&lt;br&gt;the&nbsp;file&nbsp;I/O.&nbsp;&nbsp;Another&nbsp;thing&nbsp;you&nbsp;could&nbsp;contribute&nbsp;to&nbsp;the&nbsp;branch,&lt;br&gt;possibly?&nbsp;&nbsp;:-)&nbsp;&nbsp;How&nbsp;did&nbsp;you&nbsp;implement&nbsp;this?&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;At&nbsp;the&nbsp;moment&nbsp;I&nbsp;don't&nbsp;mind&nbsp;the&nbsp;blockingness&nbsp;of&nbsp;the&nbsp;calls.&nbsp;I&nbsp;did&nbsp;write&nbsp;a&lt;br&gt;ThreadReader&nbsp;and&nbsp;ThreadWriter&nbsp;though&nbsp;for&nbsp;my&nbsp;earlier&nbsp;tubes-alike&nbsp;with&lt;br&gt;Queue-based&nbsp;loop.&lt;br&gt;&lt;br&gt;What&nbsp;is&nbsp;more&nbsp;interesting&nbsp;challenge&nbsp;(and&nbsp;we&nbsp;discussed&nbsp;this&nbsp;earlier&nbsp;on&lt;br&gt;irc)&nbsp;would&nbsp;be&nbsp;generic&nbsp;async&nbsp;file&nbsp;api.&nbsp;I&nbsp;suggested&nbsp;implementing&nbsp;9p2000&lt;br&gt;back&nbsp;then&nbsp;and&nbsp;I&nbsp;still&nbsp;think&nbsp;it&nbsp;is&nbsp;a&nbsp;good&nbsp;starting&nbsp;point...&nbsp;but&nbsp;nothing&lt;br&gt;I&nbsp;have&nbsp;spare&nbsp;time&nbsp;for&nbsp;at&nbsp;the&nbsp;moment.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;point&nbsp;is&nbsp;not&nbsp;to&nbsp;use&nbsp;a&nbsp;specific&nbsp;implementation.&nbsp;&nbsp;Rather,&nbsp;the&nbsp;point&nbsp;is&nbsp;to&nbsp;get&nbsp;a&nbsp;single&nbsp;well-documented&nbsp;entry-point&nbsp;within&nbsp;Twisted&nbsp;for&nbsp;asynchronously&nbsp;reading&nbsp;a&nbsp;file&nbsp;so&nbsp;that&nbsp;people&nbsp;can&nbsp;start&nbsp;using&nbsp;it.&nbsp;&nbsp;Frankly&nbsp;this&nbsp;entrypoint&nbsp;could&nbsp;be&nbsp;a&nbsp;total&nbsp;lie&nbsp;and&nbsp;actually&nbsp;do&nbsp;the&nbsp;I/O&nbsp;synchronously&nbsp;on&nbsp;the&nbsp;main&nbsp;thread,&nbsp;as&nbsp;long&nbsp;as&nbsp;it&nbsp;could&nbsp;be&nbsp;transparently&nbsp;upgraded&nbsp;to&nbsp;being&nbsp;the&nbsp;truth&nbsp;without&nbsp;exposing&nbsp;the&nbsp;change&nbsp;to&nbsp;applications&nbsp;in&nbsp;the&nbsp;future&nbsp;:-).&nbsp;&nbsp;If&nbsp;we&nbsp;make&nbsp;everyone&nbsp;implement&nbsp;their&nbsp;own&nbsp;read-a-file&nbsp;fount,&nbsp;then&nbsp;there's&nbsp;no&nbsp;hope&nbsp;that&nbsp;future&nbsp;Twisted&nbsp;maintenance&nbsp;could&nbsp;improve&nbsp;their&nbsp;performance.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I'm&nbsp;not&nbsp;sure&nbsp;I&nbsp;totally&nbsp;understand&nbsp;the&nbsp;case&nbsp;that&nbsp;you're&nbsp;describing&lt;br&gt;right&nbsp;now.&nbsp;&nbsp;Can&nbsp;you&nbsp;perhaps&nbsp;contribute&nbsp;a&nbsp;unit&nbsp;test&nbsp;which&nbsp;demonstrates&lt;br&gt;why&nbsp;this&nbsp;line&nbsp;of&nbsp;code&nbsp;is&nbsp;necessary?&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I'd&nbsp;love&nbsp;to,&nbsp;alas&nbsp;I'll&nbsp;be&nbsp;bit&nbsp;preocuppied&nbsp;with&nbsp;some&nbsp;more&nbsp;urgent&nbsp;matters&lt;br&gt;for&nbsp;following&nbsp;week&nbsp;or&nbsp;two.&nbsp;The&nbsp;short&nbsp;version&nbsp;is&nbsp;&quot;flowStopped&nbsp;just&lt;br&gt;didn't&nbsp;get&nbsp;passed&nbsp;through&nbsp;the&nbsp;series&nbsp;otherwise&quot;.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;hope&nbsp;I'll&nbsp;have&nbsp;some&nbsp;time&nbsp;later&nbsp;in&nbsp;the&nbsp;week&nbsp;to&nbsp;investigate&nbsp;this.&nbsp;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Are&nbsp;you&nbsp;running&nbsp;into&nbsp;&lt;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/trac/ticket/7546&quot;&gt;https://twistedmatrix.com/trac/ticket/7546&lt;/a&gt;&gt;?&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Most&nbsp;probably,&nbsp;as&nbsp;far&nbsp;as&nbsp;I&nbsp;can&nbsp;tell&nbsp;from&nbsp;the&nbsp;vague&nbsp;description.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Well,&nbsp;you'll&nbsp;be&nbsp;glad&nbsp;to&nbsp;know&nbsp;that's&nbsp;also&nbsp;on&nbsp;my&nbsp;to-do&nbsp;list&nbsp;:-).&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;That&nbsp;...&nbsp;definitely&nbsp;sounds&nbsp;kind&nbsp;of&nbsp;gross.&nbsp;&nbsp;As&nbsp;does&nbsp;actually&nbsp;setting&lt;br&gt;the&nbsp;nextFount&nbsp;attribute&nbsp;directly&nbsp;on&nbsp;the&nbsp;fan.Out.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Indeed.&nbsp;The&nbsp;point&nbsp;of&nbsp;the&nbsp;experiment&nbsp;was&nbsp;not&nbsp;produce&nbsp;nice&nbsp;code&nbsp;but&nbsp;to&lt;br&gt;see&nbsp;if&nbsp;there&nbsp;are&nbsp;any&nbsp;major&nbsp;pitfalls&nbsp;using&nbsp;the&nbsp;tubes&nbsp;API.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;long&nbsp;as&nbsp;it's&nbsp;clear&nbsp;that&nbsp;this&nbsp;is&nbsp;not&nbsp;really&nbsp;necessary&nbsp;:).&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;twisted.web.client.Agent&nbsp;has&nbsp;a&nbsp;solution&nbsp;to&nbsp;this&nbsp;where&nbsp;there's&nbsp;a&lt;br&gt;multi-failure&nbsp;object&nbsp;that&nbsp;aggregates&nbsp;multiple&nbsp;errors&nbsp;into&nbsp;one&nbsp;thing.&lt;br&gt;I&nbsp;think&nbsp;we&nbsp;have&nbsp;to&nbsp;do&nbsp;something&nbsp;similar.&nbsp;&nbsp;Unfortunately&nbsp;this&nbsp;is&nbsp;a&lt;br&gt;very&nbsp;confusing&nbsp;interface&nbsp;in&nbsp;addition&nbsp;to&nbsp;being&nbsp;poorly&nbsp;documented&nbsp;and&lt;br&gt;relies&nbsp;on&nbsp;private&nbsp;classes&nbsp;that&nbsp;expose&nbsp;ostensibly&nbsp;public&nbsp;attributes.&lt;br&gt;We&nbsp;need&nbsp;to&nbsp;very&nbsp;carefully&nbsp;document&nbsp;this&nbsp;within&nbsp;fan.In.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Some&nbsp;nice&nbsp;abstraction&nbsp;of&nbsp;multiple&nbsp;failures&nbsp;would&nbsp;be&nbsp;indeed&nbsp;handy.&nbsp;I'm&lt;br&gt;pretty&nbsp;sure&nbsp;DeferredList&nbsp;could&nbsp;use&nbsp;one&nbsp;too.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yeah,&nbsp;uh,&nbsp;maybe.&nbsp;&nbsp;Also&nbsp;DeferredList&nbsp;should&nbsp;go&nbsp;away&nbsp;and&nbsp;be&nbsp;replaced&nbsp;with&nbsp;something&nbsp;that&nbsp;doesn't&nbsp;inherit&nbsp;from&nbsp;Deferred,&nbsp;and&nbsp;instead&nbsp;is&nbsp;just&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;regular-old-Deferred,&nbsp;since&nbsp;the&nbsp;subclassing&nbsp;is&nbsp;entirely&nbsp;unnecessary.&nbsp;&nbsp;But&nbsp;I&nbsp;digress.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;As&nbsp;for&nbsp;data&nbsp;representation&nbsp;that&nbsp;I&nbsp;choose&nbsp;to&nbsp;pass&nbsp;between&nbsp;each&nbsp;tube&lt;br&gt;I've&nbsp;started&nbsp;with&nbsp;simple&nbsp;namedtuples&nbsp;and&nbsp;following&nbsp;that&nbsp;I've&nbsp;built&lt;br&gt;a&nbsp;simple&nbsp;&quot;datatype&quot;&nbsp;class&nbsp;somewhat&nbsp;reminiscent&nbsp;of&lt;br&gt;&lt;a&nbsp;href=&quot;https://github.com/hynek/characteristic&quot;&gt;https://github.com/hynek/characteristic&lt;/a&gt;&lt;br&gt;which&nbsp;I&nbsp;learned&nbsp;of&nbsp;few&nbsp;moments&nbsp;after&nbsp;I&nbsp;finished&nbsp;polishing&nbsp;my&nbsp;own&lt;br&gt;implementation.&nbsp;What&nbsp;I&nbsp;have&nbsp;there&nbsp;is&nbsp;added&nbsp;layer&nbsp;above&nbsp;namedtuples&lt;br&gt;that&nbsp;autogenerate&nbsp;zope&nbsp;Interfaces&nbsp;(so&nbsp;I&nbsp;can&nbsp;have&nbsp;adaptation),&nbsp;do&lt;br&gt;field&nbsp;type&nbsp;and&nbsp;value&nbsp;validation/adaptation&nbsp;and&nbsp;possibly&nbsp;(as&nbsp;a&lt;br&gt;future&nbsp;extension)&nbsp;provide&nbsp;easy&nbsp;way&nbsp;to&nbsp;make&nbsp;them&nbsp;into&nbsp;AMP&nbsp;commands&lt;br&gt;so&nbsp;the&nbsp;series&nbsp;can&nbsp;be&nbsp;split&nbsp;into&nbsp;communicating&nbsp;processes&nbsp;as&nbsp;needed.&lt;br&gt;(What&nbsp;would&nbsp;be&nbsp;interesting&nbsp;imo&nbsp;is&nbsp;something&nbsp;like&nbsp;ampoule&nbsp;for&nbsp;tubes,&lt;br&gt;or&nbsp;perhaps&nbsp;a&nbsp;ThreadTube&nbsp;and&nbsp;SubprocessTube&nbsp;for&nbsp;performing&nbsp;blocking&lt;br&gt;operations)&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I&nbsp;think&nbsp;it's&nbsp;likely&nbsp;we'll&nbsp;acquire&nbsp;a&nbsp;dependency&nbsp;on&nbsp;Characteristic&lt;br&gt;sometime&nbsp;soon,&nbsp;I&nbsp;have&nbsp;promised&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;issues&nbsp;on&lt;br&gt;&lt;&lt;a&nbsp;href=&quot;https://github.com/hynek/characteristic/pull/13&quot;&gt;https://github.com/hynek/characteristic/pull/13&lt;/a&gt;&gt;&nbsp;and&nbsp;try&nbsp;to&nbsp;address&lt;br&gt;them&nbsp;already&nbsp;:).&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;What&nbsp;makes&nbsp;me&nbsp;ponder&nbsp;is&nbsp;how&nbsp;to&nbsp;work&nbsp;with&nbsp;multiple&nbsp;types&nbsp;of&nbsp;messages&lt;br&gt;being&nbsp;passed&nbsp;through.&nbsp;Traditionally&nbsp;in&nbsp;twisted&nbsp;one&nbsp;would&nbsp;use&nbsp;different&lt;br&gt;methods&nbsp;for&nbsp;handling&nbsp;each&nbsp;one,&nbsp;eg.&nbsp;IRCClient&nbsp;has&nbsp;userJoined,&nbsp;userLeft,&lt;br&gt;and&nbsp;so&nbsp;on.&nbsp;If&nbsp;we&nbsp;keep&nbsp;tubes&nbsp;as&nbsp;they&nbsp;are&nbsp;with&nbsp;a&nbsp;single&nbsp;received()&nbsp;method&lt;br&gt;then&nbsp;somehow&nbsp;we&nbsp;need&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;tell&nbsp;those&nbsp;messages&nbsp;apart,&lt;br&gt;deconstruct&nbsp;them&nbsp;and&nbsp;mainly&nbsp;document&nbsp;them&nbsp;and&nbsp;test&nbsp;for&nbsp;proper&nbsp;handling&lt;br&gt;of&nbsp;all&nbsp;cases.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Dispatching&nbsp;from&nbsp;a&nbsp;single&nbsp;&quot;received&quot;&nbsp;message&nbsp;to&nbsp;multiple&nbsp;distinct&nbsp;methods&nbsp;based&nbsp;on&nbsp;type&nbsp;is&nbsp;a&nbsp;pretty&nbsp;well&nbsp;solved&nbsp;problem&nbsp;in&nbsp;Python&nbsp;:-).&nbsp;&nbsp;There&nbsp;is&nbsp;a&nbsp;whole&nbsp;class&nbsp;of&nbsp;design&nbsp;patterns&nbsp;for&nbsp;this&nbsp;which&nbsp;we&nbsp;could&nbsp;apply&nbsp;to&nbsp;Tubes.&nbsp;&nbsp;I&nbsp;don't&nbsp;think&nbsp;we&nbsp;need&nbsp;this&nbsp;in&nbsp;the&nbsp;first&nbsp;release&nbsp;though;&nbsp;it's&nbsp;easy&nbsp;to&nbsp;implement&nbsp;yourself,&nbsp;there&nbsp;are&nbsp;a&nbsp;few&nbsp;different&nbsp;styles&nbsp;which&nbsp;might&nbsp;be&nbsp;a&nbsp;good&nbsp;idea&nbsp;that&nbsp;we'll&nbsp;need&nbsp;to&nbsp;try&nbsp;out,&nbsp;and&nbsp;many&nbsp;of&nbsp;the&nbsp;examples&nbsp;in&nbsp;the&nbsp;documentation&nbsp;that&nbsp;we've&nbsp;written&nbsp;so&nbsp;far&nbsp;don't&nbsp;require&nbsp;them.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;Instinctively&nbsp;I&nbsp;started&nbsp;looking&nbsp;for&nbsp;algebraic&nbsp;data&nbsp;types,&nbsp;but&nbsp;making&lt;br&gt;those&nbsp;work&nbsp;on&nbsp;python&nbsp;is&nbsp;high-level&nbsp;metaprogramming&nbsp;magic&nbsp;and&nbsp;that&lt;br&gt;either&nbsp;implies&nbsp;python3.3+&nbsp;or&nbsp;AST&nbsp;rewriting:&lt;br&gt;&lt;a&nbsp;href=&quot;https://github.com/lihaoyi/macropy&quot;&gt;https://github.com/lihaoyi/macropy&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yeesh.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;Perhaps&nbsp;what&nbsp;would&nbsp;be&nbsp;bearable&nbsp;is&nbsp;AST-based&nbsp;checker&nbsp;(integrated&nbsp;into&lt;br&gt;testcases&nbsp;perhaps)&nbsp;that&nbsp;would&nbsp;do&nbsp;exhaustiveness&nbsp;and&nbsp;field&nbsp;name&nbsp;checking&lt;br&gt;for&nbsp;such&nbsp;complex&nbsp;data&nbsp;-&nbsp;so&nbsp;all&nbsp;users&nbsp;of&nbsp;a&nbsp;tube/fount&nbsp;producing&nbsp;some&lt;br&gt;type&nbsp;woud&nbsp;be&nbsp;flagged&nbsp;whenever&nbsp;the&nbsp;type&nbsp;signature&nbsp;of&nbsp;it&nbsp;changes.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;this&nbsp;really&nbsp;a&nbsp;substantial&nbsp;enough&nbsp;advantage&nbsp;over,&nbsp;say,&nbsp;a&nbsp;dictionary&nbsp;with&nbsp;types&nbsp;as&nbsp;keys&nbsp;and&nbsp;callables&nbsp;as&nbsp;values,&nbsp;that&nbsp;it&nbsp;would&nbsp;be&nbsp;worth&nbsp;the&nbsp;(frankly&nbsp;insane-sounding)&nbsp;level&nbsp;of&nbsp;complexity&nbsp;involved&nbsp;in&nbsp;its&nbsp;implementation?&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;Other&nbsp;possible&nbsp;resolution&nbsp;is&nbsp;to&nbsp;mantain&nbsp;the&nbsp;multi-method&nbsp;approach&nbsp;and&lt;br&gt;make&nbsp;tubes&nbsp;into&nbsp;pausing&nbsp;mechanism&nbsp;only.&nbsp;I&nbsp;think&nbsp;it&nbsp;could&nbsp;work&nbsp;somewhat&lt;br&gt;like:&lt;br&gt;&lt;br&gt;@pauseable&lt;br&gt;def&nbsp;lineReceived(line):&lt;br&gt;&nbsp;&nbsp;&nbsp;...&lt;br&gt;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;reference&nbsp;object&nbsp;of&nbsp;specified&nbsp;interface&lt;br&gt;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;wait&nbsp;until&nbsp;it&nbsp;is&nbsp;unpaused&lt;br&gt;&nbsp;&nbsp;&nbsp;(yield&nbsp;IIRCClient).userJoined(...)&lt;br&gt;&lt;br&gt;The&nbsp;first&nbsp;obvious&nbsp;downside&nbsp;of&nbsp;this&nbsp;approach&nbsp;that&nbsp;I&nbsp;see&nbsp;is&nbsp;that&nbsp;we&nbsp;now&lt;br&gt;need&nbsp;proxy&nbsp;objects&nbsp;for&nbsp;generic&nbsp;fan-in/out.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yeah,&nbsp;I,&nbsp;uh,&nbsp;don't&nbsp;quite&nbsp;understand&nbsp;what&nbsp;you're&nbsp;getting&nbsp;at&nbsp;here.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Also&nbsp;maybe&nbsp;of&nbsp;note&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;Pipes&nbsp;in&nbsp;Async&nbsp;library&lt;br&gt;for&nbsp;OCaml&nbsp;which&nbsp;I've&nbsp;been&nbsp;examining&nbsp;lately.&nbsp;What&nbsp;they&nbsp;seem&nbsp;to&nbsp;do&lt;br&gt;there&nbsp;is&nbsp;that&nbsp;they&nbsp;push&nbsp;values&nbsp;downstream&nbsp;and&nbsp;the&nbsp;function&nbsp;called&lt;br&gt;in&nbsp;each&nbsp;processing&nbsp;step&nbsp;may&nbsp;return&nbsp;deferred&nbsp;signifying&nbsp;a&nbsp;pause&nbsp;is&lt;br&gt;requested&nbsp;until&nbsp;this&nbsp;deferred&nbsp;is&nbsp;fired.&nbsp;For&nbsp;those&nbsp;interested&nbsp;in&nbsp;the&lt;br&gt;details&nbsp;you&nbsp;can&nbsp;refer&nbsp;to:&lt;br&gt;&lt;a&nbsp;href=&quot;https://ocaml.janestreet.com/ocaml-core/111.25.00/doc/async/#Std.Pipe&quot;&gt;https://ocaml.janestreet.com/ocaml-core/111.25.00/doc/async/#Std.Pipe&lt;/a&gt;&lt;br&gt;and&nbsp;the&nbsp;relevant&nbsp;section&nbsp;of&nbsp;Real&nbsp;World&nbsp;OCaml&nbsp;book&nbsp;(available&lt;br&gt;online).&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Creating&nbsp;a&nbsp;token&nbsp;for&nbsp;every&nbsp;single&nbsp;call&nbsp;to&nbsp;.receive()&nbsp;makes&nbsp;life&lt;br&gt;hard.&nbsp;&nbsp;Deferred&nbsp;could&nbsp;go&nbsp;to&nbsp;some&nbsp;trouble&nbsp;to&nbsp;be&nbsp;a&nbsp;cheaper&nbsp;token&nbsp;to&lt;br&gt;pass&nbsp;around&nbsp;(especially&nbsp;on&nbsp;PyPy)&nbsp;but&nbsp;doing&nbsp;it&nbsp;this&nbsp;way&nbsp;is&nbsp;also&lt;br&gt;error-prone&nbsp;as&nbsp;a&nbsp;mistaken&nbsp;error-handler&nbsp;in&nbsp;the&nbsp;Deferred&nbsp;chain&nbsp;means&lt;br&gt;that&nbsp;the&nbsp;default&nbsp;behavior&nbsp;of&nbsp;buggy&nbsp;code&nbsp;un-hooks&nbsp;your&nbsp;loop&nbsp;and&nbsp;leaves&lt;br&gt;idle&nbsp;data&nbsp;sources&nbsp;that&nbsp;will&nbsp;never&nbsp;be&nbsp;cleaned&nbsp;up.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;How&nbsp;does&nbsp;current&nbsp;approach&nbsp;prevent&nbsp;that?&nbsp;From&nbsp;what&nbsp;I&nbsp;see&nbsp;unhandled&lt;br&gt;exception&nbsp;in&nbsp;non-well&nbsp;written&nbsp;drain&nbsp;can&nbsp;do&nbsp;the&nbsp;very&nbsp;much&nbsp;same.&nbsp;Tubes&lt;br&gt;are&nbsp;handled&nbsp;specially&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;prevented&nbsp;there.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That's&nbsp;exactly&nbsp;the&nbsp;point&nbsp;-&nbsp;applications&nbsp;should&nbsp;very&nbsp;rarely&nbsp;need&nbsp;to&nbsp;create&nbsp;new&nbsp;drains&nbsp;or&nbsp;founts,&nbsp;they&nbsp;should&nbsp;be&nbsp;working&nbsp;mostly&nbsp;in&nbsp;terms&nbsp;of&nbsp;tubes,&nbsp;fan.In,&nbsp;fan.Out,&nbsp;protocol&nbsp;founts&nbsp;and&nbsp;drains,&nbsp;and&nbsp;process&nbsp;founts&nbsp;and&nbsp;drains.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;a&nbsp;buggy&nbsp;drain,&nbsp;protocol&nbsp;founts&nbsp;and&nbsp;tubes&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;handle&nbsp;the&nbsp;error&nbsp;_and&nbsp;cleanly&nbsp;shut&nbsp;down&nbsp;the&nbsp;whole&nbsp;flow_.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;the&nbsp;Streams&nbsp;(i.e.&nbsp;every-read-returns-a-Deferred)&nbsp;approach,&nbsp;you&nbsp;don't&nbsp;know&nbsp;who&nbsp;your&nbsp;caller&nbsp;is&nbsp;except&nbsp;that&nbsp;they&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;callback&nbsp;to&nbsp;you.&nbsp;&nbsp;There's&nbsp;no&nbsp;way&nbsp;to&nbsp;propagate&nbsp;other&nbsp;notifications&nbsp;or&nbsp;inspect&nbsp;the&nbsp;chain&nbsp;for&nbsp;debugging&nbsp;in&nbsp;case&nbsp;of&nbsp;errors.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I&nbsp;worked&nbsp;quite&nbsp;a&nbsp;bit&nbsp;with&nbsp;the&nbsp;'Streams'&nbsp;interface&nbsp;in&nbsp;web2&nbsp;on&nbsp;Calendar&lt;br&gt;Server,&nbsp;and&nbsp;my&nbsp;conclusion&nbsp;there&nbsp;is&nbsp;that&nbsp;while&nbsp;this&nbsp;is&nbsp;better&nbsp;than&lt;br&gt;nothing&nbsp;(it&nbsp;was&nbsp;very&nbsp;nice&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;just&nbsp;return&nbsp;a&nbsp;Stream&nbsp;rather&lt;br&gt;than&nbsp;cobble&nbsp;together&nbsp;something&nbsp;that&nbsp;returned&nbsp;NOT_DONE_YET&nbsp;every&nbsp;time)&lt;br&gt;it&nbsp;was&nbsp;(A)&nbsp;slow&nbsp;and&nbsp;(B)&nbsp;error&nbsp;prone.&nbsp;&nbsp;Tubes&nbsp;are&nbsp;designed&nbsp;specifically&lt;br&gt;to&nbsp;avoid&nbsp;this&nbsp;error.&nbsp;&nbsp;Although&nbsp;you&nbsp;can&nbsp;return&nbsp;Deferreds&nbsp;internally,&lt;br&gt;no&nbsp;consumer&nbsp;ever&nbsp;needs&nbsp;to&nbsp;write&nbsp;the&nbsp;callback-loop&nbsp;that&nbsp;calls&nbsp;.read()&lt;br&gt;again&nbsp;from&nbsp;a&nbsp;callback&nbsp;on&nbsp;.read().&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I&nbsp;agree&nbsp;that&nbsp;something&nbsp;like&nbsp;tubes&nbsp;is&nbsp;needed,&nbsp;but&nbsp;it&nbsp;can&nbsp;be&nbsp;a&lt;br&gt;upper-level&nbsp;layer&nbsp;over&nbsp;something&nbsp;simple&nbsp;as&nbsp;flow-signalling&nbsp;callbacks.&lt;br&gt;&lt;br&gt;Anyway,&nbsp;linked&nbsp;mostly&nbsp;for&nbsp;inspiration.&lt;br&gt;&lt;br&gt;What&nbsp;I'd&nbsp;really&nbsp;like&nbsp;to&nbsp;see&nbsp;though&nbsp;is&nbsp;some&nbsp;rationale&nbsp;for&nbsp;current&nbsp;design&lt;br&gt;choices&nbsp;of&nbsp;tubes&nbsp;-&nbsp;eg.&nbsp;list&nbsp;of&nbsp;reasons&nbsp;the&nbsp;previous&nbsp;attempts&nbsp;failed&nbsp;and&lt;br&gt;how&nbsp;does&nbsp;each&nbsp;next&nbsp;address&nbsp;the&nbsp;issues.&nbsp;:-)&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;Hmm.&nbsp;&nbsp;It's&nbsp;tough&nbsp;to&nbsp;document&nbsp;these,&nbsp;because&nbsp;there&nbsp;was&nbsp;a&nbsp;lot&nbsp;of&nbsp;experimenting&nbsp;in&nbsp;tubes,&nbsp;a&nbsp;lot&nbsp;of&nbsp;backtracking,&nbsp;some&nbsp;influence&nbsp;from&nbsp;other&nbsp;projects&nbsp;and&nbsp;a&nbsp;lot&nbsp;of&nbsp;parallel&nbsp;invention.&nbsp;&nbsp;Trying&nbsp;to&nbsp;outline&nbsp;all&nbsp;the&nbsp;things&nbsp;we&nbsp;tried&nbsp;and&nbsp;why&nbsp;they&nbsp;did&nbsp;or&nbsp;didn't&nbsp;work&nbsp;would&nbsp;be&nbsp;extremely&nbsp;time-consuming&nbsp;for&nbsp;us&nbsp;and&nbsp;probably&nbsp;pretty&nbsp;confusing&nbsp;and&nbsp;unhelpful&nbsp;for&nbsp;the&nbsp;reader.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;would&nbsp;you&nbsp;be&nbsp;looking&nbsp;to&nbsp;get&nbsp;from&nbsp;such&nbsp;a&nbsp;write-up?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-g&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
