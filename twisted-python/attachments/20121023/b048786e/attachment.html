<tt>
I&nbsp;have&nbsp;been&nbsp;looking&nbsp;at&nbsp;running&nbsp;some&nbsp;twisted&nbsp;programs&nbsp;as&nbsp;a&nbsp;windows&nbsp;service.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;in&nbsp;the&nbsp;end&nbsp;I&nbsp;took&nbsp;a&nbsp;copy&nbsp;of&nbsp;twistd.py&nbsp;and&nbsp;adapted&nbsp;it&nbsp;to&nbsp;load&nbsp;my&nbsp;tac&nbsp;file&nbsp;and&nbsp;run&nbsp;it&nbsp;as&nbsp;a&nbsp;windows&nbsp;service.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;Of&nbsp;course&nbsp;the&nbsp;windows&nbsp;service&nbsp;will&nbsp;run&nbsp;it&nbsp;in&nbsp;a&nbsp;separate&nbsp;thread. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;now&nbsp;have&nbsp;it&nbsp;running&nbsp;on&nbsp;XP,&nbsp;2003&nbsp;Server&nbsp;Twisted&nbsp;10&nbsp;and&nbsp;12&nbsp;and&nbsp;it&nbsp;all&nbsp;seemed&nbsp;fine.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However&nbsp;when&nbsp;I&nbsp;install&nbsp;it&nbsp;on&nbsp;Windows&nbsp;7&nbsp;I&nbsp;get&nbsp;an&nbsp;error&lt;br&nbsp;clear=&quot;all&quot;&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;2012-10-23&nbsp;07:54:49+0100&nbsp;[-]&nbsp;Unhandled&nbsp;Error&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; File&nbsp;&quot;C:\Python27\lib\site-packages\twisted\internet\base.py&quot;,&nbsp;line&nbsp;413,&nbsp;in&nbsp;fireEvent&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; &nbsp; DeferredList(beforeResults).addCallback(self._continueFiring)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; File&nbsp;&quot;C:\Python27\lib\site-packages\twisted\internet\defer.py&quot;,&nbsp;line&nbsp;297,&nbsp;in&nbsp;addCallback&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; &nbsp; callbackKeywords=kw)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; File&nbsp;&quot;C:\Python27\lib\site-packages\twisted\internet\defer.py&quot;,&nbsp;line&nbsp;286,&nbsp;in&nbsp;addCallbacks&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; &nbsp; self._runCallbacks()&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; File&nbsp;&quot;C:\Python27\lib\site-packages\twisted\internet\defer.py&quot;,&nbsp;line&nbsp;542,&nbsp;in&nbsp;_runCallbacks&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; &nbsp; current.result&nbsp;=&nbsp;callback(current.result,&nbsp;*args,&nbsp;**kw)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;---&nbsp;&lt;exception&nbsp;caught&nbsp;here&gt;&nbsp;---&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; File&nbsp;&quot;C:\Python27\lib\site-packages\twisted\internet\base.py&quot;,&nbsp;line&nbsp;426,&nbsp;in&nbsp;_continueFiring&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; &nbsp; callable(*args,&nbsp;**kwargs)&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; File&nbsp;&quot;C:\Python27\lib\site-packages\twisted\internet\base.py&quot;,&nbsp;line&nbsp;1153,&nbsp;in&nbsp;_reallyStartRunning&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&lt;/span&gt;&nbsp; &nbsp; self._handleSignals()&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; File&nbsp;&quot;C:\Python27\lib\site-packages\twisted\internet\posixbase.py&quot;,&nbsp;line&nbsp;277,&nbsp;in&nbsp;_handleSignals&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp; &nbsp; _SignalReactorMixin._handleSignals(self)&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; File&nbsp;&quot;C:\Python27\lib\site-packages\twisted\internet\base.py&quot;,&nbsp;line&nbsp;1118,&nbsp;in&nbsp;_handleSignals&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp; &nbsp; signal.signal(signal.SIGINT,&nbsp;self.sigInt)&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;exceptions.ValueError:&nbsp;signal&nbsp;only&nbsp;works&nbsp;in&nbsp;main&nbsp;thread&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Looking&nbsp;around&nbsp;it&nbsp;would&nbsp;seem&nbsp;I&nbsp;need&nbsp;to&nbsp;tell&nbsp;the&nbsp;reactor&nbsp; &#39;installsignalhandlers=0&#39;.&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;if&nbsp;I&nbsp;should&nbsp;do&nbsp;this&nbsp;with&nbsp;windows&nbsp;or&nbsp;not.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Has&nbsp;anyone&nbsp;got&nbsp;twistd.py&nbsp;to&nbsp;run&nbsp;as&nbsp;a&nbsp;service&nbsp;on&nbsp;windows&nbsp;because&nbsp;I&nbsp;would&nbsp;be&nbsp;glad&nbsp;to&nbsp;know&nbsp;what&nbsp;other&nbsp;people&nbsp;have&nbsp;done&nbsp;to&nbsp;solve&nbsp;the&nbsp;problem.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;any&nbsp;info.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;b&gt;John&nbsp;Aherne&lt;/b&gt;&lt;div&gt;<br>
&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;img&nbsp;src=&quot;http://www.rocs.co.uk/Images/rocs_logo_sig.gif&quot;&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;&lt;a&nbsp;href=&quot;http://www.rocs.co.uk&quot;&nbsp;target=&quot;_blank&quot;&gt;www.rocs.co.uk&lt;/a&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;<br>
020&nbsp;7223&nbsp;7567&lt;/div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>

</tt>
