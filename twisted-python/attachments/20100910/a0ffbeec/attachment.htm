<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Sep&nbsp;10,&nbsp;2010,&nbsp;at&nbsp;5:17&nbsp;AM,&nbsp;Pantelis&nbsp;Theodosiou&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I&nbsp;have&nbsp;a&nbsp;simple&nbsp;INSERT&nbsp;INTO&nbsp;statement&nbsp;sent&nbsp;to&nbsp;SQL-Server&nbsp;using&nbsp;pymssql&nbsp;module.&lt;br&gt;&lt;br&gt;I&nbsp;use&nbsp;the&nbsp;runOperation&nbsp;method&nbsp;to&nbsp;send&nbsp;the&nbsp;query&nbsp;and&nbsp;I&nbsp;get&nbsp;this&nbsp;strange&nbsp;error.&nbsp;The&nbsp;data&nbsp;goes&nbsp;through&nbsp;OK&nbsp;and&nbsp;is&nbsp;written&nbsp;in&nbsp;the&nbsp;database&nbsp;but&nbsp;SQL-Server&nbsp;tries&nbsp;to&nbsp;rollback.&lt;br&gt;<br>
&lt;br&gt;Perhaps&nbsp;this&nbsp;is&nbsp;a&nbsp;pymssql&nbsp;problem.&nbsp;In&nbsp;the&nbsp;&lt;br&gt;&lt;a&nbsp;href=&quot;http://code.google.com/p/pymssql/wiki/PymssqlExamples&quot;&gt;http://code.google.com/p/pymssql/wiki/PymssqlExamples&lt;/a&gt;&nbsp;&lt;br&gt;page,&nbsp;they&nbsp;state:&lt;br&gt;&lt;br&gt;&lt;pre&nbsp;class=&quot;prettyprint&quot;&gt;&lt;span&nbsp;class=&quot;kwd&quot;&gt;import&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;pymssql&lt;br&gt;conn&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;pymssql&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;connect&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;host&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;str&quot;&gt;'SQL01'&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;user&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;str&quot;&gt;'user'&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;password&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;str&quot;&gt;'password'&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;database&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;str&quot;&gt;'mydatabase'&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&lt;br&gt;<br>
cur&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;conn&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;cursor&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;()&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&lt;br&gt;cur&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;execute&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;str&quot;&gt;'CREATE&nbsp;TABLE&nbsp;persons(id&nbsp;INT,&nbsp;name&nbsp;VARCHAR(100))'&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&lt;br&gt;<br>
cur&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;executemany&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;str&quot;&gt;&quot;INSERT&nbsp;INTO&nbsp;persons&nbsp;VALUES(%d,&nbsp;%s)&quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;\&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&lt;br&gt;<br>
&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;[&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;str&quot;&gt;'John&nbsp;Doe'&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;),&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;str&quot;&gt;'Jane&nbsp;Doe'&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;])&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&lt;br&gt;<br>
conn&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;commit&lt;/span&gt;&lt;span&nbsp;class=&quot;pun&quot;&gt;()&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&nbsp;&amp;nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;com&quot;&gt;#&nbsp;you&nbsp;must&nbsp;call&nbsp;commit()&nbsp;to&nbsp;persist&nbsp;your&nbsp;data&nbsp;if&nbsp;you&nbsp;don't&nbsp;set&nbsp;autocommit&nbsp;to&nbsp;True&lt;/span&gt;&lt;span&nbsp;class=&quot;pln&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/pre&gt;&lt;br&gt;But&nbsp;how&nbsp;can&nbsp;I&nbsp;use&nbsp;the&nbsp;con.commit&nbsp;method&nbsp;with&nbsp;runOperation&nbsp;and&nbsp;runQuery&nbsp;that&nbsp;I&nbsp;use&nbsp;in&nbsp;my&nbsp;application?&lt;br&gt;&lt;br&gt;thank&nbsp;you,&lt;br&gt;&lt;br&gt;Pandelis&nbsp;Theodosiou&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;no&nbsp;experience&nbsp;with&nbsp;MS&nbsp;SQL,&nbsp;only&nbsp;with&nbsp;PostgreSQL&nbsp;via&nbsp;psycopg2,&nbsp;but&nbsp;the&nbsp;idea&nbsp;is:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;you&nbsp;want&nbsp;to&nbsp;execute&nbsp;many&nbsp;statements,&nbsp;probably&nbsp;in&nbsp;a&nbsp;blocking&nbsp;fashion:&nbsp;runInteraction()&lt;/div&gt;&lt;div&gt;you&nbsp;want&nbsp;to&nbsp;execute&nbsp;just&nbsp;one&nbsp;statement:&nbsp;runQuery()/runOperation()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;AFAIK&nbsp;the&nbsp;latter&nbsp;one&nbsp;will&nbsp;do&nbsp;a&nbsp;commit&nbsp;for&nbsp;you&nbsp;if&nbsp;it&nbsp;is&nbsp;needed.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyway,&nbsp;for&nbsp;PostgreSQL&nbsp;I&nbsp;can&nbsp;specify&nbsp;isolation&nbsp;level&nbsp;I&nbsp;need.&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
