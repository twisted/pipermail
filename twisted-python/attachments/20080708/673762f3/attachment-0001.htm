<tt>
&lt;br&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jul&nbsp;8,&nbsp;2008&nbsp;at&nbsp;2:07&nbsp;PM,&nbsp;Wu&nbsp;Zhe&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jessewoo@gmail.com&quot;&gt;jessewoo@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;Hi&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;a&nbsp;series&nbsp;of&nbsp;files&nbsp;to&nbsp;transfer,&nbsp;each&nbsp;followed&nbsp;by&nbsp;a&nbsp;line&nbsp;sent&nbsp;to&lt;br&gt;specify&nbsp;the&nbsp;file&nbsp;size&nbsp;and&nbsp;crc&nbsp;number.&nbsp;As&nbsp;we&nbsp;can&nbsp;see&nbsp;here&nbsp;I&nbsp;need&lt;br&gt;<br>
synchronous&nbsp;behavior,&nbsp;only&nbsp;after&nbsp;the&nbsp;previous&nbsp;file&nbsp;transfer&nbsp;complete,&lt;br&gt;can&nbsp;the&nbsp;for&nbsp;loop&nbsp;step&nbsp;into&nbsp;the&nbsp;next&nbsp;iteration&nbsp;to&nbsp;send&nbsp;the&nbsp;next&nbsp;file&lt;br&gt;via&nbsp;sender.beginFileTransfer.&nbsp;How&nbsp;can&nbsp;i&nbsp;achieve&nbsp;this?&nbsp;Here&nbsp;is&nbsp;the&lt;br&gt;problematic&nbsp;code:&lt;br&gt;<br>
&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;def&nbsp;import_query(self,&nbsp;path_list):&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;number_of_files&nbsp;=&nbsp;len(path_list)&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;line&nbsp;=&nbsp;&amp;#39;3#%s&amp;#39;&nbsp;%&nbsp;number_of_files&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;self.client_instance.sendLine(line)&lt;br&gt;&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sender&nbsp;=&nbsp;FileSender()&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;sender.CHUNK_SIZE&nbsp;=&nbsp;common.chunk_size&lt;br&gt;<br>
&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;for&nbsp;path&nbsp;in&nbsp;path_list:&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;f&nbsp;=&nbsp;open(path,&nbsp;&amp;#39;rb&amp;#39;)&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;s&nbsp;=&nbsp;f.read()&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;filesize&nbsp;=&nbsp;len(s)&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;crc&nbsp;=&nbsp;crc32(s)&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;line&nbsp;=&nbsp;&amp;#39;3#%s:%s&amp;#39;&nbsp;%&nbsp;(filesize,&nbsp;crc)&lt;br&gt;<br>
&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;self.client_instance.sendLine(line)&lt;br&gt;&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;def&nbsp;transfer_completed(lastsent):&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;f.close()&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;self.client_instance.setLineMode()&lt;br&gt;&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;#&nbsp;send&nbsp;the&nbsp;file&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;self.setRawMode()&lt;br&gt;<br>
&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;d&nbsp;=&nbsp;sender.beginFileTransfer(f,&nbsp;self.client_instance.transport)&lt;br&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;d.addCallback(transfer_completed)&lt;br&gt;&lt;/blockquote&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;I&nbsp;think&nbsp;I&nbsp;would&nbsp;try&nbsp;this&nbsp;(Python&nbsp;2.5)&nbsp;-&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&nbsp;@defer.inlineCallbacks&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;def&nbsp;import_query(self,&nbsp;path_list):&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;...&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for&nbsp;path&nbsp;in&nbsp;path_list:&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;...&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;lt;&nbsp;delete&nbsp;transfer_complete()&nbsp;&amp;gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;...&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;yield&nbsp;sender.beginFileTransfer(f,&nbsp;self.client_instance.transport)&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;f.close()&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;...&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;Harald&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,sans-serif&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
