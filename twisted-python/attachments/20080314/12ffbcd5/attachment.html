<tt>
I&nbsp;have&nbsp;it&nbsp;working&nbsp;now.&nbsp;&nbsp;I&nbsp;have&nbsp;attached&nbsp;a&nbsp;working&nbsp;programme&nbsp;below.&nbsp;&nbsp;(Note:&nbsp;the&nbsp;RRHeader&#39;s&nbsp;name&nbsp;should&nbsp;be&nbsp;gathered&nbsp;from&nbsp;one&nbsp;of&nbsp;the&nbsp;queries,&nbsp;rather&nbsp;than&nbsp;being&nbsp;hard-coded,&nbsp;as&nbsp;in&nbsp;my&nbsp;example&nbsp;below.&nbsp;&nbsp;I&nbsp;did&nbsp;it&nbsp;this&nbsp;way,&nbsp;as&nbsp;it&nbsp;more&nbsp;obviously&nbsp;illustrates&nbsp;RRHeader&#39;s&nbsp;constructor.)&lt;br&gt;<br>
&lt;br&gt;Thanks&nbsp;for&nbsp;your&nbsp;help,&nbsp;&lt;br&gt;&lt;br&gt;Chris.&lt;br&gt;&lt;br&gt;&lt;br&gt;#!/usr/bin/python&lt;br&gt;&lt;br&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;Protocol,&nbsp;Factory&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;from&nbsp;twisted.names.server&nbsp;import&nbsp;DNSServerFactory&lt;br&gt;<br>
from&nbsp;twisted.names.dns&nbsp;import&nbsp;Query,&nbsp;DNSDatagramProtocol,&nbsp;RRHeader,&nbsp;Record_CNAME,&nbsp;Record_A,&nbsp;Message&lt;br&gt;from&nbsp;twisted.names&nbsp;import&nbsp;dns&lt;br&gt;from&nbsp;twisted.internet.interfaces&nbsp;import&nbsp;IAddress&lt;br&gt;&lt;br&gt;class&nbsp;Controller(object):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;messageReceived(self,&nbsp;m,&nbsp;protocol,&nbsp;addr):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;m,&nbsp;dir(m),&nbsp;m.queries,&nbsp;m.answers&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;this&nbsp;should&nbsp;always&nbsp;answer&nbsp;&lt;a&nbsp;href=&quot;http://10.11.12.13&quot;&gt;10.11.12.13&lt;/a&gt;,&nbsp;regardless&nbsp;of&nbsp;the&nbsp;query&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.answer&nbsp;=&nbsp;1&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.answers.append(RRHeader(name=&quot;foo.bar&quot;,&nbsp;payload=Record_A(address=&quot;&lt;a&nbsp;href=&quot;http://10.11.12.13&quot;&gt;10.11.12.13&lt;/a&gt;&quot;)))&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol.transport.write(m.toStr(),&nbsp;addr)&lt;br&gt;&lt;br&gt;controller&nbsp;=&nbsp;Controller()&lt;br&gt;<br>
&lt;br&gt;if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.listenUDP(53,&nbsp;DNSDatagramProtocol(controller))&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.run()&lt;br&gt;&lt;br&gt;&nbsp;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;13/03/2008,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Jean-Paul&nbsp;Calderone&lt;/b&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:exarkun@divmod.com&quot;&gt;exarkun@divmod.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
On&nbsp;Thu,&nbsp;13&nbsp;Mar&nbsp;2008&nbsp;07:52:24&nbsp;+0000,&nbsp;Chris&nbsp;Dew&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:chris@sidwells.com&quot;&gt;chris@sidwells.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&nbsp;&gt;Thanks&nbsp;for&nbsp;your&nbsp;reply.&nbsp;&nbsp;I&nbsp;have&nbsp;tried&nbsp;setting&nbsp;answer&nbsp;to&nbsp;1.&nbsp;&nbsp;I&nbsp;have&nbsp;included&lt;br&gt;&nbsp;&gt;an&nbsp;amended&nbsp;version&nbsp;of&nbsp;my&nbsp;programme&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;this&nbsp;email.&lt;br&gt;<br>
&nbsp;&gt;&lt;br&gt;&nbsp;&gt;When&nbsp;I&nbsp;run&nbsp;this,&nbsp;the&nbsp;server&nbsp;reports&nbsp;no&nbsp;error.&nbsp;&nbsp;When&nbsp;I&nbsp;&nbsp;&#39;dig&nbsp;@localhost&lt;br&gt;&nbsp;&gt;foo.bar&#39;&nbsp;I&nbsp;get&nbsp;the&nbsp;response:&lt;br&gt;&nbsp;&gt;&lt;br&gt;&nbsp;&lt;br&gt;&gt;&nbsp;[snip]&lt;br&gt;&nbsp;&lt;br&gt;&gt;&lt;br&gt;&nbsp;&gt;Could&nbsp;you&nbsp;point&nbsp;out&nbsp;my&nbsp;mistake?&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;bug&nbsp;in&nbsp;twisted.names,&nbsp;I&#39;m&nbsp;happy&lt;br&gt;<br>
&nbsp;&gt;to&nbsp;look&nbsp;at&nbsp;fixing&nbsp;it&nbsp;(I&#39;ve&nbsp;worked&nbsp;with&nbsp;the&nbsp;dns&nbsp;protocol&nbsp;at&nbsp;packet&nbsp;level&lt;br&gt;&nbsp;&gt;before),&nbsp;but&nbsp;I&nbsp;first&nbsp;want&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;I&nbsp;am&nbsp;using&nbsp;the&nbsp;API&nbsp;correctly.&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;&lt;br&gt;See&nbsp;below.&nbsp;&nbsp;I&nbsp;think&nbsp;it&#39;s&nbsp;a&nbsp;documentation&nbsp;deficiency,&nbsp;but&nbsp;probably&nbsp;not&nbsp;a&lt;br&gt;<br>
&nbsp;bug&nbsp;in&nbsp;the&nbsp;code.&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;&gt;&nbsp;[snip]&lt;br&gt;&nbsp;&lt;br&gt;&gt;&lt;br&gt;&nbsp;&gt;#!/usr/bin/python&lt;br&gt;&nbsp;&gt;&lt;br&gt;&nbsp;&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;Protocol,&nbsp;Factory&lt;br&gt;&nbsp;&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;&nbsp;&gt;from&nbsp;twisted.names.server&nbsp;import&nbsp;DNSServerFactory&lt;br&gt;<br>
&nbsp;&gt;from&nbsp;twisted.names.dns&nbsp;import&nbsp;Query,&nbsp;DNSDatagramProtocol,&nbsp;RRHeader,&lt;br&gt;&nbsp;&gt;Record_CNAME,&nbsp;Record_A,&nbsp;Message&lt;br&gt;&nbsp;&gt;from&nbsp;twisted.names&nbsp;import&nbsp;dns&lt;br&gt;&nbsp;&gt;from&nbsp;twisted.internet.interfaces&nbsp;import&nbsp;IAddress&lt;br&gt;&nbsp;&gt;&lt;br&gt;&nbsp;&gt;class&nbsp;Controller(object):&lt;br&gt;<br>
&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;messageReceived(self,&nbsp;m,&nbsp;protocol,&nbsp;addr):&lt;br&gt;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;m,&nbsp;dir(m),&nbsp;m.queries,&nbsp;m.answers&lt;br&gt;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;this&nbsp;should&nbsp;always&nbsp;answer&nbsp;&lt;a&nbsp;href=&quot;http://10.11.12.13&quot;&gt;10.11.12.13&lt;/a&gt;,&nbsp;regardless&nbsp;of&nbsp;the&nbsp;query&lt;br&gt;<br>
&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.answer&nbsp;=&nbsp;1&lt;br&gt;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.answers.append(Record_A(address=&quot;&lt;a&nbsp;href=&quot;http://10.11.12.13&quot;&gt;10.11.12.13&lt;/a&gt;&quot;))&lt;br&gt;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol.transport.write(m.toStr(),&nbsp;addr)&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;&lt;br&gt;Answers&nbsp;should&nbsp;be&nbsp;a&nbsp;list&nbsp;of&nbsp;RRHeaders,&nbsp;not&nbsp;bare&nbsp;Record_As.&lt;br&gt;<br>
&nbsp;&lt;br&gt;&lt;br&gt;&nbsp;&gt;&lt;br&gt;&nbsp;&gt;controller&nbsp;=&nbsp;Controller()&lt;br&gt;&nbsp;&gt;&lt;br&gt;&nbsp;&gt;if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:&lt;br&gt;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.listenUDP(53,&nbsp;DNSDatagramProtocol(controller))&lt;br&gt;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.run()&lt;br&gt;&nbsp;&gt;&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;&lt;br&gt;Jean-Paul&lt;br&gt;<br>
&nbsp;&lt;br&gt;&nbsp;_______________________________________________&lt;br&gt;&nbsp;Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
