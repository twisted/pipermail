<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;On&nbsp;Mar&nbsp;24,&nbsp;2020,&nbsp;at&nbsp;4:05&nbsp;PM,&nbsp;Tom&nbsp;Most&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:twm@freecog.net&quot;&nbsp;class=&quot;&quot;&gt;twm@freecog.net&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;I'll&nbsp;offer&nbsp;a&nbsp;dissenting&nbsp;opinion:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;I've&nbsp;worked&nbsp;on&nbsp;systems&nbsp;where&nbsp;the&nbsp;reactor&nbsp;is&nbsp;patched&nbsp;to&nbsp;use&nbsp;monotonic&nbsp;time.&nbsp;(This&nbsp;is&nbsp;essential&nbsp;on&nbsp;embedded&nbsp;systems&nbsp;that&nbsp;lack&nbsp;a&nbsp;real-time&nbsp;clock.)&nbsp;I'm&nbsp;not&nbsp;aware&nbsp;of&nbsp;this&nbsp;causing&nbsp;any&nbsp;issues,&nbsp;and&nbsp;it&nbsp;fixed&nbsp;real&nbsp;problems.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;curious&nbsp;to&nbsp;know&nbsp;the&nbsp;problems&nbsp;that&nbsp;were&nbsp;fixed&nbsp;here,&nbsp;but,&nbsp;this&nbsp;is&nbsp;a&nbsp;violation&nbsp;of&nbsp;the&nbsp;IReactorTime&nbsp;contract,&nbsp;implicit&nbsp;as&nbsp;it&nbsp;may&nbsp;be.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;reactor&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;should&lt;/i&gt;&lt;span&nbsp;style=&quot;font-style:&nbsp;normal;&quot;&nbsp;class=&quot;&quot;&gt;&nbsp;have&nbsp;a&nbsp;monotonic-time&nbsp;interface,&nbsp;and&nbsp;maybe&nbsp;we&nbsp;should&nbsp;even&nbsp;use&nbsp;it&nbsp;to&nbsp;implement&nbsp;callLater.&nbsp;&nbsp;But&nbsp;.seconds()&nbsp;is&nbsp;wall-clock&nbsp;time.&lt;/span&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;HTTPFactory&nbsp;is&nbsp;quite&nbsp;unusual&nbsp;in&nbsp;assuming&nbsp;that&nbsp;it&nbsp;is&nbsp;epoch&nbsp;time.&nbsp;Most&nbsp;parts&nbsp;of&nbsp;Twisted&nbsp;that&nbsp;require&nbsp;wall&nbsp;time&nbsp;call&nbsp;`time.time()`&nbsp;or&nbsp;equivalent&nbsp;directly.&nbsp;IMO&nbsp;HTTPFactory&nbsp;is&nbsp;in&nbsp;error&nbsp;here,&nbsp;and&nbsp;this&nbsp;is&nbsp;simply&nbsp;a&nbsp;bug.&nbsp;We&nbsp;should&nbsp;change&nbsp;HTTPFactory&nbsp;to&nbsp;use&nbsp;`time.time()`&nbsp;directly.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Nope.&nbsp;&nbsp;This&nbsp;breaks&nbsp;a&nbsp;whole&nbsp;class&nbsp;of&nbsp;testing&nbsp;strategies,&nbsp;which&nbsp;are&nbsp;explicitly&nbsp;documented&nbsp;in&nbsp;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/documents/20.3.0/core/howto/trial.html#testing-scheduling&quot;&nbsp;class=&quot;&quot;&gt;https://twistedmatrix.com/documents/20.3.0/core/howto/trial.html#testing-scheduling&lt;/a&gt;&nbsp;.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;However,&nbsp;I&nbsp;can&nbsp;definitely&nbsp;see&nbsp;the&nbsp;need&nbsp;for&nbsp;monotonic&nbsp;time.&nbsp;&nbsp;`IReactorTimeEx`&nbsp;should&nbsp;probably&nbsp;include&nbsp;methods&nbsp;for&nbsp;getting&nbsp;monotonic&nbsp;time,&nbsp;getting&nbsp;civil&nbsp;times,&nbsp;scheduling&nbsp;callables&nbsp;at&nbsp;future&nbsp;civil&nbsp;times&nbsp;explicitly&nbsp;rather&nbsp;than&nbsp;using&nbsp;relative&nbsp;timestamps,&nbsp;etc.&nbsp;&nbsp;Possibly&nbsp;some&nbsp;of&nbsp;these&nbsp;should&nbsp;be&nbsp;different&nbsp;interfaces.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Since&nbsp;the&nbsp;time&nbsp;base&nbsp;of&nbsp;IReactorTime.seconds()&nbsp;hasn't&nbsp;ever&nbsp;been&nbsp;clearly&nbsp;defined,&nbsp;I&nbsp;think&nbsp;that&nbsp;we&nbsp;should&nbsp;really&nbsp;go&nbsp;the&nbsp;other&nbsp;way:&nbsp;use&nbsp;`time.monotonic()`&nbsp;by&nbsp;default&nbsp;where&nbsp;possible.&nbsp;(Or,&nbsp;more&nbsp;realistically,&nbsp;make&nbsp;it&nbsp;an&nbsp;option&nbsp;and&nbsp;maybe&nbsp;the&nbsp;default.)&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Definitely&nbsp;not.&nbsp;&nbsp;Huge&nbsp;huge&nbsp;swathes&nbsp;of&nbsp;Twisted&nbsp;code&nbsp;would&nbsp;break,&nbsp;not&nbsp;least&nbsp;of&nbsp;which&nbsp;would&nbsp;be&nbsp;Twisted's&nbsp;own&nbsp;HTTP&nbsp;access&nbsp;logs&nbsp;which&nbsp;rely&nbsp;on&nbsp;.seconds()&nbsp;to&nbsp;be&nbsp;wall&nbsp;clock.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;---Tom&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;On&nbsp;Mon,&nbsp;Mar&nbsp;23,&nbsp;2020,&nbsp;at&nbsp;1:24&nbsp;PM,&nbsp;Amber&nbsp;Brown&nbsp;(hawkowl)&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;On&nbsp;24/3/20&nbsp;6:45&nbsp;am,&nbsp;Richard&nbsp;van&nbsp;der&nbsp;Hoff&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;HTTPFactory&nbsp;seems&nbsp;to&nbsp;think&nbsp;that&nbsp;`reactor.seconds`&nbsp;is&nbsp;reliably&nbsp;an&nbsp;epoch&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;time&nbsp;(see&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;a&nbsp;href=&quot;https://github.com/twisted/twisted/blob/trunk/src/twisted/web/http.py#L3110&quot;&nbsp;class=&quot;&quot;&gt;https://github.com/twisted/twisted/blob/trunk/src/twisted/web/http.py#L3110&lt;/a&gt;,&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;etc).&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;On&nbsp;the&nbsp;other&nbsp;hand.&nbsp;AsyncioSelectorReactor.seconds()&nbsp;returns&nbsp;a&nbsp;monotonic&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;time:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;python3&nbsp;-c&nbsp;'from&nbsp;twisted.internet&nbsp;import&nbsp;asyncioreactor;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;print(asyncioreactor.AsyncioSelectorReactor().seconds())'&lt;br&nbsp;class=&quot;&quot;&gt;41116.763594412&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;One&nbsp;of&nbsp;these&nbsp;is&nbsp;wrong...&nbsp;I&nbsp;think&nbsp;it's&nbsp;HTTPFactory&nbsp;making&nbsp;bad&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;assumptions,&nbsp;but&nbsp;can&nbsp;anyone&nbsp;confirm&nbsp;the&nbsp;intention&nbsp;here?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;It's&nbsp;a&nbsp;bug&nbsp;in&nbsp;asyncioreactor.&nbsp;IReactorTime&nbsp;defines&nbsp;it&nbsp;as&nbsp;&quot;current&nbsp;time&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;in&nbsp;seconds&quot;,&nbsp;which&nbsp;_probably_&nbsp;should&nbsp;be&nbsp;defined&nbsp;nicer&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;(&lt;a&nbsp;href=&quot;https://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorTime.html#seconds&quot;&nbsp;class=&quot;&quot;&gt;https://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorTime.html#seconds&lt;/a&gt;)&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;but&nbsp;is&nbsp;generally&nbsp;epoch&nbsp;time.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;asyncioreactor&nbsp;does&nbsp;have&nbsp;a&nbsp;few&nbsp;problems&nbsp;with&nbsp;time:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/trac/ticket/9611&quot;&nbsp;class=&quot;&quot;&gt;https://twistedmatrix.com/trac/ticket/9611&lt;/a&gt;&lt;br&nbsp;class=&quot;&quot;&gt;https://twistedmatrix.com/trac/ticket/9780&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;I&nbsp;can't&nbsp;find&nbsp;a&nbsp;bug&nbsp;for&nbsp;this&nbsp;issue,&nbsp;though,&nbsp;although&nbsp;I'm&nbsp;almost&nbsp;sure&nbsp;I've&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;seen&nbsp;it&nbsp;before...&nbsp;so,&nbsp;if&nbsp;you&nbsp;could&nbsp;file&nbsp;one&nbsp;(and&nbsp;maybe&nbsp;a&nbsp;patch&nbsp;to&nbsp;fix&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;it!)&nbsp;then&nbsp;that&nbsp;would&nbsp;be&nbsp;appreciated.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;-&nbsp;Amber&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;_______________________________________________&lt;br&nbsp;class=&quot;&quot;&gt;Twisted-Python&nbsp;mailing&nbsp;list&lt;br&nbsp;class=&quot;&quot;&gt;Twisted-Python@twistedmatrix.com&lt;br&nbsp;class=&quot;&quot;&gt;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;_______________________________________________&lt;br&nbsp;class=&quot;&quot;&gt;Twisted-Python&nbsp;mailing&nbsp;list&lt;br&nbsp;class=&quot;&quot;&gt;&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&nbsp;class=&quot;&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&nbsp;class=&quot;&quot;&gt;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
