"""
Connects to QueryProxy.
"""

from twisted.spread import pb
from twisted.internet import reactor
from twisted.python import util

try: import readline
except: pass

sql = raw_input('Enter a sql statement: ')

factory = pb.PBClientFactory()
reactor.connectTCP("localhost", 9523, factory)
d = factory.getRootObject()
d.addCallback(lambda object: object.callRemote("execute", sql))
d.addCallback(lambda echo: 'Server Responded: '+echo)
d.addErrback(lambda reason: 'error: '+str(reason.value))
d.addCallback(util.println)
d.addCallback(lambda _: reactor.stop())
reactor.run()
