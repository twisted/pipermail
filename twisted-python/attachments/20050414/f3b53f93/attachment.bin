"""
Simple QueryProxy
"""

from twisted.spread import pb
from twisted.internet import reactor
from twisted.enterprise import adbapi

class QueryProxy(pb.Root):
	def __init__(self):
		self._pool = None
		
	def getpool(self):
		if not self._pool:
			self._pool = adbapi.ConnectionPool("MySQLdb", 'foobar', 'user', 'pass')
		return self._pool
	pool = property(getpool)
	
	def remote_execute(self, statement, *args):
		return self.pool.runQuery(statement, args)

if __name__ == '__main__':
	reactor.listenTCP(9523, pb.PBServerFactory(QueryProxy()))
	reactor.run()