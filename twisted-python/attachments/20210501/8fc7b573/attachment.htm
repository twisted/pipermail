<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Sat,&nbsp;1&nbsp;May&nbsp;2021&nbsp;at&nbsp;07:43,&nbsp;&lt;a&nbsp;href=&quot;mailto:contact@benoit-laviale.fr&quot;&gt;contact@benoit-laviale.fr&lt;/a&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:contact@benoit-laviale.fr&quot;&gt;contact@benoit-laviale.fr&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;Dear&nbsp;all,&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;working&nbsp;on&nbsp;twisted&nbsp;names&nbsp;since&nbsp;some&nbsp;days&nbsp;to&nbsp;make&nbsp;kind&nbsp;of&nbsp;filtering&nbsp;system&nbsp;(with&nbsp;domains&nbsp;blacklists).&lt;br&gt;So&nbsp;I&nbsp;made&nbsp;my&nbsp;own&nbsp;resolver&nbsp;that&nbsp;can&nbsp;reply&nbsp;defer.fail(error.DomainError())&nbsp;to&nbsp;send&nbsp;the&nbsp;query&nbsp;to&nbsp;the&nbsp;next&nbsp;resolver&nbsp;(and&nbsp;in&nbsp;this&nbsp;case,&nbsp;it&nbsp;will&nbsp;be&nbsp;resolve)&nbsp;or&nbsp;defer.fail(dns.AuthoritativeDomainError(&lt;a&nbsp;href=&quot;http://query.name.name&quot;&nbsp;target=&quot;_blank&quot;&gt;query.name.name&lt;/a&gt;))&nbsp;to&nbsp;reply&nbsp;NXDOMAIN&nbsp;that&nbsp;can&nbsp;&quot;block&quot;&nbsp;the&nbsp;domain&nbsp;to&nbsp;the&nbsp;final&nbsp;client.    &lt;br&gt;&lt;br&gt;That&nbsp;part&nbsp;is&nbsp;working&nbsp;well.&lt;br&gt;&lt;br&gt;Next,&nbsp;i&nbsp;would&nbsp;like&nbsp;to&nbsp;&quot;block&quot;&nbsp;the&nbsp;resolution&nbsp;regarding&nbsp;the&nbsp;device&nbsp;(Mac&nbsp;address/IP/???).&lt;br&gt;&lt;br&gt;I&nbsp;would&nbsp;like&nbsp;something&nbsp;like&nbsp;that&nbsp;:&lt;br&gt;&lt;br&gt;if&nbsp;self.query.meta.client.ip&nbsp;==&nbsp;b&quot;192.168.0.5&quot;&nbsp;or&nbsp;self.query.meta.client.mac&nbsp;==&nbsp;&quot;XX:YY:ZZ:....&quot;:&lt;br&gt;        &nbsp;self.do_something()&lt;br&gt;&lt;br&gt;My&nbsp;use&nbsp;case&nbsp;is&nbsp;that&nbsp;device&nbsp;of&nbsp;Kelly,&nbsp;(Kelly&nbsp;is&nbsp;a&nbsp;teenager&nbsp;of&nbsp;12&nbsp;years)&nbsp;cant&nbsp;use&nbsp;&lt;a&nbsp;href=&quot;http://youtube.com&quot;&nbsp;target=&quot;_blank&quot;&gt;youtube.com&lt;/a&gt;&nbsp;at&nbsp;all,&nbsp;but&nbsp;other&nbsp;devices&nbsp;are&nbsp;allowed&nbsp;to&nbsp;get&nbsp;the&nbsp;resolution.&lt;br&gt;How&nbsp;can&nbsp;I&nbsp;get&nbsp;the&nbsp;IP/Name/mac&nbsp;(an&nbsp;identifier)&nbsp;of&nbsp;the&nbsp;device&nbsp;that&#39;s&nbsp;querying&nbsp;my&nbsp;custom&nbsp;dns?&lt;br&gt;I&nbsp;read&nbsp;something&nbsp;about&nbsp;datagrams,&nbsp;but&nbsp;in&nbsp;my&nbsp;case&nbsp;i&nbsp;think&nbsp;i&nbsp;must&nbsp;get&nbsp;this&nbsp;information&nbsp;in&nbsp;my&nbsp;resolver...&lt;br&gt;&lt;br&gt;Thx&nbsp;and&nbsp;cheers.&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;you&nbsp;are&nbsp;using&nbsp;DNS&nbsp;over&nbsp;UDP...&nbsp;so&nbsp;to&nbsp;understand&nbsp;how&nbsp;UDP&nbsp;works&nbsp;with&nbsp;Twisted&nbsp;you&nbsp;can&nbsp;check&nbsp;this&nbsp;page&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/documents/current/core/howto/udp.html&quot;&gt;https://twistedmatrix.com/documents/current/core/howto/udp.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; I&nbsp;have&nbsp;never&nbsp;used&nbsp;Twisted&nbsp;names&nbsp;so&nbsp;I&nbsp;am&nbsp;just&nbsp;trying&nbsp;to&nbsp;help&nbsp;based&nbsp;on&nbsp;my&nbsp;general&nbsp;knowledge&nbsp;of&nbsp;Twisted&nbsp;design&lt;br&gt;&lt;/div&gt;&lt;div&gt;...&nbsp;but&nbsp;I&nbsp;think&nbsp;the&nbsp;entry&nbsp;point&nbsp;is&nbsp;here&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://github.com/twisted/twisted/blob/63649469c1fe46d8a713e8034239ac3cc0498ea7/src/twisted/names/dns.py#L3242&quot;&gt;https://github.com/twisted/twisted/blob/63649469c1fe46d8a713e8034239ac3cc0498ea7/src/twisted/names/dns.py#L3242&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;then&nbsp;it&nbsp;goes&nbsp;to&nbsp;here&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://github.com/twisted/twisted/blob/63649469c1fe46d8a713e8034239ac3cc0498ea7/src/twisted/names/server.py#L538&quot;&gt;https://github.com/twisted/twisted/blob/63649469c1fe46d8a713e8034239ac3cc0498ea7/src/twisted/names/server.py#L538&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&nbsp;then&nbsp;in&nbsp;handleQuery&nbsp;where&nbsp;I&nbsp;see&nbsp;that&nbsp;the &nbsp;query&nbsp;is&nbsp;done&nbsp;without&nbsp;the&nbsp;`address`...but&nbsp;the&nbsp;address&nbsp;is&nbsp;available&nbsp;again&nbsp;in&lt;/div&gt;&lt;div&gt;`gotResolverResponse`..&nbsp;so&nbsp;maybe&nbsp;that&nbsp;help&nbsp;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-------&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Hope&nbsp;it&nbsp;helps&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&nbsp;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&gt;Adi&nbsp;Roiban&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
