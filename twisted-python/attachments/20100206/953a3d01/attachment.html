<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/3.28.1&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
On&nbsp;Sat,&nbsp;2010-02-06&nbsp;at&nbsp;17:13&nbsp;+0000,&nbsp;exarkun@twistedmatrix.com&nbsp;wrote:<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
On&nbsp;04:42&nbsp;pm,&nbsp;&lt;A&nbsp;HREF=&quot;mailto:darren@ontrenet.com&quot;&gt;darren@ontrenet.com&lt;/A&gt;&nbsp;wrote:<br>
&gt;Hi,<br>
&gt;&nbsp;&nbsp;I&nbsp;have&nbsp;a&nbsp;simple&nbsp;protocol&nbsp;listening&nbsp;on&nbsp;a&nbsp;port.&nbsp;I&nbsp;send&nbsp;it&nbsp;a&nbsp;text&nbsp;message<br>
&gt;(a&nbsp;filename)<br>
&gt;and&nbsp;the&nbsp;protocol&nbsp;tries&nbsp;to&nbsp;stream&nbsp;back&nbsp;the&nbsp;bytes&nbsp;of&nbsp;the&nbsp;file.&nbsp;Mostly,<br>
&gt;this&nbsp;works<br>
&gt;but&nbsp;in&nbsp;some&nbsp;cases,&nbsp;the&nbsp;receiving&nbsp;side&nbsp;receives&nbsp;less&nbsp;bytes&nbsp;than&nbsp;is<br>
&gt;written&nbsp;by:<br>
&gt;<br>
&gt;self.transport.write(bytes)<br>
&gt;<br>
&gt;I&nbsp;read&nbsp;the&nbsp;API&nbsp;which&nbsp;says&nbsp;it&nbsp;can&nbsp;receive&nbsp;less&nbsp;than&nbsp;expected&nbsp;bytes&nbsp;or<br>
&gt;messages.&nbsp;Why?<br>
<br>
That's&nbsp;how&nbsp;TCP&nbsp;works.&nbsp;&nbsp;Bytes&nbsp;you&nbsp;send&nbsp;with&nbsp;one&nbsp;call&nbsp;to&nbsp;write&nbsp;may&nbsp;be&nbsp;<br>
split&nbsp;into&nbsp;two&nbsp;or&nbsp;more&nbsp;chunks&nbsp;and&nbsp;delivered&nbsp;to&nbsp;the&nbsp;remote&nbsp;dataReceived&nbsp;<br>
separately,&nbsp;or&nbsp;bytes&nbsp;you&nbsp;send&nbsp;with&nbsp;two&nbsp;or&nbsp;more&nbsp;calls&nbsp;to&nbsp;write&nbsp;may&nbsp;be&nbsp;<br>
combined&nbsp;into&nbsp;fewer&nbsp;chunks&nbsp;and&nbsp;delivered&nbsp;to&nbsp;the&nbsp;remote&nbsp;dataReceived&nbsp;all&nbsp;<br>
as&nbsp;one&nbsp;string.<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
Yes,&nbsp;at&nbsp;the&nbsp;lower&nbsp;OSI&nbsp;layers&nbsp;it&nbsp;does.&nbsp;But&nbsp;in&nbsp;most&nbsp;modern&nbsp;programming&nbsp;languages,&lt;BR&gt;<br>
the&nbsp;notion&nbsp;of&nbsp;an&nbsp;I/O&nbsp;stream&nbsp;is&nbsp;built&nbsp;atop&nbsp;it&nbsp;(e.g.&nbsp;sockets&nbsp;will&nbsp;recombine&nbsp;and&nbsp;order&lt;BR&gt;<br>
the&nbsp;packets,&nbsp;but&nbsp;twisted&nbsp;does&nbsp;not?).&nbsp;So&nbsp;naturally,&nbsp;I&nbsp;don't&nbsp;want&nbsp;to&nbsp;emulate&nbsp;IP&nbsp;in&lt;BR&gt;<br>
my&nbsp;Twisted&nbsp;app.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
&gt;<br>
&gt;So&nbsp;how&nbsp;can&nbsp;I&nbsp;reliably&nbsp;send&nbsp;a&nbsp;sequences&nbsp;of&nbsp;bytes&nbsp;via&nbsp;&quot;dataReceived&quot;&nbsp;in&nbsp;<br>
&gt;my<br>
&gt;protocol?<br>
<br>
If&nbsp;you&nbsp;want&nbsp;&quot;framing&quot;&nbsp;-&nbsp;a&nbsp;byte&nbsp;format&nbsp;built&nbsp;on&nbsp;top&nbsp;of&nbsp;the&nbsp;basic&nbsp;<br>
functionality&nbsp;provided&nbsp;by&nbsp;TCP,&nbsp;allowing&nbsp;you&nbsp;to&nbsp;differentiate&nbsp;bytes&nbsp;<br>
belonging&nbsp;to&nbsp;different&nbsp;logical&nbsp;messages&nbsp;from&nbsp;each&nbsp;other&nbsp;-&nbsp;then&nbsp;you&nbsp;<br>
should&nbsp;take&nbsp;a&nbsp;look&nbsp;at&nbsp;some&nbsp;of&nbsp;the&nbsp;protocols&nbsp;in&nbsp;twisted.protocols.basic&nbsp;<br>
(NetstringReceiver,&nbsp;Int32StringReceiver,&nbsp;etc)&nbsp;or&nbsp;twisted.protocols.amp&nbsp;<br>
which&nbsp;expands&nbsp;on&nbsp;this&nbsp;idea&nbsp;to&nbsp;a&nbsp;much&nbsp;greater&nbsp;degree.<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
Ok,&nbsp;cool.&nbsp;I&nbsp;thought&nbsp;this&nbsp;would&nbsp;be&nbsp;easier&nbsp;in&nbsp;Twisted,&nbsp;but&nbsp;I&nbsp;will&nbsp;research&nbsp;it&nbsp;more.<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
<br>
You&nbsp;can&nbsp;read&nbsp;a&nbsp;lot&nbsp;more&nbsp;about&nbsp;these&nbsp;ideas&nbsp;in&nbsp;this&nbsp;series&nbsp;of&nbsp;articles&nbsp;by&nbsp;<br>
Itamar&nbsp;Turner-Trauring:<br>
<br>
&nbsp;&nbsp;&lt;A&nbsp;HREF=&quot;http://www.xml.com/pub/au/215&quot;&gt;http://www.xml.com/pub/au/215&lt;/A&gt;<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
Thanks&nbsp;again.<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
<br>
Jean-Paul<br>
<br>
_______________________________________________<br>
Twisted-Python&nbsp;mailing&nbsp;list<br>
&lt;A&nbsp;HREF=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/A&gt;<br>
&lt;A&nbsp;HREF=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/A&gt;<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
&lt;BR&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
