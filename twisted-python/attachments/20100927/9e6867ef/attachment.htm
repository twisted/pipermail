<tt>
To&nbsp;me&nbsp;this&nbsp;seems&nbsp;like&nbsp;a&nbsp;very&nbsp;strange&nbsp;problem&nbsp;and&nbsp;I&amp;#39;ve&nbsp;tried&nbsp;to&nbsp;debug&nbsp;it&nbsp;best&nbsp;I&nbsp;can&nbsp;but&nbsp;I&nbsp;don&amp;#39;t&nbsp;know&nbsp;much&nbsp;about&nbsp;many&nbsp;of&nbsp;the&nbsp;components&nbsp;at&nbsp;work.&nbsp;Here&amp;#39;s&nbsp;what&nbsp;happened:&lt;br&gt;&lt;br&gt;&lt;div&gt;I&amp;#39;ve&nbsp;been&nbsp;happily&nbsp;using&nbsp;Capistrano&nbsp;to&nbsp;deploy&nbsp;many&nbsp;twistd&nbsp;services&nbsp;to&nbsp;Ubuntu&nbsp;9.04&nbsp;machines.&nbsp;It&nbsp;restarts&nbsp;them&nbsp;via&nbsp;an&nbsp;init.d&nbsp;script&nbsp;based&nbsp;off&nbsp;this&nbsp;template: &lt;a&nbsp;href=&quot;http://twistedmatrix.com/trac/attachment/ticket/3434/twistdplugin&quot;&gt;http://twistedmatrix.com/trac/attachment/ticket/3434/twistdplugin&lt;/a&gt;.&nbsp;I&amp;#39;m&nbsp;running&nbsp;a&nbsp;self-installed&nbsp;Twisted&nbsp;8.2.0&nbsp;on&nbsp;both&nbsp;systems&nbsp;with&nbsp;some&nbsp;small&nbsp;tweaks&nbsp;to&nbsp;logging.&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;newer&nbsp;Ubuntu&nbsp;10.04&nbsp;machines&nbsp;I&amp;#39;ve&nbsp;been&nbsp;deploying&nbsp;to&nbsp;the&nbsp;twistd&nbsp;services&nbsp;don&amp;#39;t&nbsp;restart&nbsp;properly.&nbsp;There&nbsp;are&nbsp;no&nbsp;errors&nbsp;in&nbsp;the&nbsp;log.&nbsp;The&nbsp;only&nbsp;log&nbsp;lines&nbsp;I&amp;#39;d&nbsp;get&nbsp;were:&lt;br&gt;[-]&nbsp;Log&nbsp;opened.&lt;br&gt;[-]&nbsp;twistd&nbsp;8.2.0&nbsp;(/usr/bin/python&nbsp;2.6.5)&nbsp;starting&nbsp;up.&lt;br&gt;<br>
<br>
[-]&nbsp;reactor&nbsp;class:&nbsp;twisted.internet.epollreactor.EPollReactor.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But&nbsp;they&nbsp;were&nbsp;only&nbsp;failing&nbsp;to&nbsp;restart&nbsp;when&nbsp;run&nbsp;via&nbsp;Capistrano.&nbsp;I&nbsp;realized&nbsp;that&nbsp;the&nbsp;only&nbsp;difference&nbsp;was&nbsp;that&nbsp;Capistrano&nbsp;was&nbsp;using&nbsp;a&nbsp;pseudo&nbsp;terminal&nbsp;when&nbsp;it&nbsp;issued&nbsp;its&nbsp;commands.&nbsp;To&nbsp;recreate&nbsp;the&nbsp;problem&nbsp;without&nbsp;Capistrano&nbsp;I&nbsp;can&nbsp;run:&lt;/div&gt;<br>
<br>
&lt;div&gt;&amp;gt;&nbsp;ssh&nbsp;-t&nbsp;user@host&nbsp;&amp;quot;/etc/init.d/service&nbsp;start&amp;quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But&nbsp;it&nbsp;works&nbsp;fine&nbsp;when&nbsp;I&nbsp;run:&lt;/div&gt;&lt;div&gt;&lt;div&gt;&amp;gt;&nbsp;ssh&nbsp;user@host&nbsp;&amp;quot;/etc/init.d/service&nbsp;start&amp;quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
<br>
The&nbsp;3&nbsp;log&nbsp;lines&nbsp;I&nbsp;see&nbsp;in&nbsp;the&nbsp;failed&nbsp;case&nbsp;are&nbsp;written&nbsp;by&nbsp;twistd&nbsp;before&nbsp;it&nbsp;forks&nbsp;(clone()&nbsp;syscall)&nbsp;to&nbsp;create&nbsp;the&nbsp;daemon&nbsp;process.&nbsp;The&nbsp;strace&nbsp;dump&nbsp;of&nbsp;twistd&nbsp;when&nbsp;run&nbsp;with&nbsp;and&nbsp;without&nbsp;pseudo&nbsp;terminal&nbsp;were&nbsp;identical.&nbsp;I&nbsp;tried&nbsp;running&nbsp;strace&nbsp;with&nbsp;the&nbsp;-f&nbsp;option&nbsp;to&nbsp;get&nbsp;some&nbsp;info&nbsp;about&nbsp;the&nbsp;child&nbsp;process&nbsp;but&nbsp;it&nbsp;didn&amp;#39;t&nbsp;fail&nbsp;in&nbsp;that&nbsp;case&nbsp;since&nbsp;I&nbsp;guess&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;actually&nbsp;fork.&nbsp;Running&nbsp;in&nbsp;a&nbsp;pseudo&nbsp;terminal&nbsp;with&nbsp;--nodaemon&nbsp;passed&nbsp;to&nbsp;twistd&nbsp;also&nbsp;works&nbsp;fine.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;ve&nbsp;tested&nbsp;this&nbsp;with&nbsp;multiple&nbsp;twistd&nbsp;services&nbsp;and&nbsp;am&nbsp;having&nbsp;the&nbsp;same&nbsp;issue&nbsp;with&nbsp;all&nbsp;of&nbsp;them.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;ideas?&nbsp;Did&nbsp;I&nbsp;completely&nbsp;misdiagnose&nbsp;the&nbsp;problem?&nbsp;Has&nbsp;there&nbsp;been&nbsp;some&nbsp;change&nbsp;in&nbsp;this&nbsp;area&nbsp;between&nbsp;Twisted&nbsp;8.2.0&nbsp;and&nbsp;10.x?&nbsp;I&amp;#39;m&nbsp;certainly&nbsp;confused.&nbsp;:)&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;Garret&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
