#!/usr/bin/env python

import sys
from twisted.internet import reactor
from foolscap import UnauthenticatedTub

import DateCopy
import xmlrpclib


def _eb ( e ):
    print "Errback called: ", e
    reactor.stop()


def _cb2 ( r ):
    print "Received reply: ", r
    reactor.stop()


def _cb1 ( reference ):
    print "Got Reference to remote server: ", reference
    xd = xmlrpclib.DateTime ( "20040506T00:00:00" )
    print "Calling printDate ( %s )" % ( xd )
    d = reference.callRemote ( "printDate", date = xd )
    d.addCallbacks ( _cb2, _eb )


if len ( sys.argv ) < 2:
    print "Usage: %s URL" % ( sys.argv [ 0 ] )
    sys.exit ( 1 )
    
script = sys.argv[0]
url    = sys.argv[1]
ut = UnauthenticatedTub()
d = ut.getReference ( url )
d.addCallbacks ( _cb1, _eb )

ut.startService()
reactor.run()
