<tt>
&lt;DIV&gt;Well,&nbsp;we're&nbsp;in&nbsp;the&nbsp;process&nbsp;of&nbsp;doing&nbsp;your&nbsp;third&nbsp;item,&nbsp;at&nbsp;least--making&nbsp;it&nbsp;two-phase.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Bill&lt;BR&gt;&lt;BR&gt;&lt;B&gt;&lt;I&gt;Bob&nbsp;Ippolito&nbsp;&lt;bob@redivi.com&gt;&lt;/I&gt;&lt;/B&gt;&nbsp;wrote:&lt;/DIV&gt;<br>
&lt;BLOCKQUOTE&nbsp;class=replbq&nbsp;style=&quot;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#1010ff&nbsp;2px&nbsp;solid&quot;&gt;In&nbsp;my&nbsp;heapq&nbsp;implementation&nbsp;of&nbsp;a&nbsp;similar&nbsp;timer&nbsp;mechanism&nbsp;(outside&nbsp;of&nbsp;&lt;BR&gt;Twisted),&nbsp;I&nbsp;did&nbsp;three&nbsp;things&nbsp;that&nbsp;twisted&nbsp;doesn't:&lt;BR&gt;-&nbsp;cancelling&nbsp;a&nbsp;timer&nbsp;doesn't&nbsp;try&nbsp;and&nbsp;remove&nbsp;it&nbsp;from&nbsp;the&nbsp;heapq,&nbsp;instead&nbsp;&lt;BR&gt;it&nbsp;just&nbsp;marks&nbsp;the&nbsp;timer&nbsp;as&nbsp;dead.&lt;BR&gt;-&nbsp;the&nbsp;time&nbsp;when&nbsp;it's&nbsp;supposed&nbsp;to&nbsp;fire&nbsp;is&nbsp;passed&nbsp;to&nbsp;the&nbsp;fire&nbsp;method&nbsp;so&nbsp;&lt;BR&gt;that&nbsp;the&nbsp;timer&nbsp;can&nbsp;determine&nbsp;whether&nbsp;it's&nbsp;supposed&nbsp;to&nbsp;actually&nbsp;fire&nbsp;or&nbsp;&lt;BR&gt;not&nbsp;(in&nbsp;the&nbsp;case&nbsp;of&nbsp;a&nbsp;time&nbsp;change&nbsp;it&nbsp;is&nbsp;actually&nbsp;added&nbsp;to&nbsp;the&nbsp;queue&nbsp;a&nbsp;&lt;BR&gt;second&nbsp;time&nbsp;without&nbsp;being&nbsp;removed&nbsp;so&nbsp;that&nbsp;I&nbsp;don't&nbsp;have&nbsp;to&nbsp;disrupt&nbsp;the&nbsp;&lt;BR&gt;heapq).&lt;BR&gt;-&nbsp;it's&nbsp;two&nbsp;phase..&nbsp;I&nbsp;have&nbsp;a&nbsp;list&nbsp;of&nbsp;newly&nbsp;added&nbsp;timers,&nbsp;and&nbsp;a&nbsp;heapq&nbsp;of&nbsp;&lt;BR&gt;waiting-to-fire&nbsp;timers.&nbsp;At&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;iteration&nbsp;I&nbsp;shove&nbsp;the&nbsp;list&nbsp;&lt;BR&gt;into&nbsp;the&nbsp;heapq&nbsp;and&nbsp;clear&nbsp;the&nbsp;list.&nbsp;This&nbsp;prevents&nbsp;infinite&nbsp;callLater(0,&nbsp;&lt;BR&gt;...)&nbsp;situations.&lt;BR&gt;&lt;BR&gt;-bob&lt;BR&gt;&lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;p&gt;&lt;font&nbsp;face=arial&nbsp;size=-1&gt;<br>
&lt;a&nbsp;href=&quot;http://in.rd.yahoo.com/specials/mailtg/*http://yahoo.shaadi.com/india-matrimony/&quot;&nbsp;target=&quot;_blank&quot;&gt;<br>
&lt;b&gt;Yahoo!&nbsp;India&nbsp;Matrimony&lt;/a&gt;:&lt;/b&gt;&nbsp;Find&nbsp;your&nbsp;partner&nbsp;<br>
&lt;a&nbsp;href=&quot;http://in.rd.yahoo.com/specials/mailtg2/*http://yahoo.shaadi.com/india-matrimony/community.php&quot;&nbsp;target=&quot;_blank&quot;&gt;online&lt;/a&gt;.&lt;/font&gt;
</tt>
