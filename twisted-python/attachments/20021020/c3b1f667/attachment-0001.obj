# Twisted, the Framework of Your Internet
# Copyright (C) 2001 Matthew W. Lefkowitz
# 
# This library is free software; you can redistribute it and/or
# modify it under the terms of version 2.1 of the GNU Lesser General Public
# License as published by the Free Software Foundation.
# 
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
# 
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

from twisted.im import minchat, baseaccount

import os


#
# Get a list of accounts
#
# This is a bit ugly, but with no actual user interface, adding accounts *is* a bit ugly.
#

# I'd use "~/.InstanceMessenger" like gtkcommon, but I don't want to clobber its settings.
accountFile = os.path.expanduser("~/.twisted-im-accounts")

try:
    execfile(accountFile)
except:
    try:
        from twisted.im.accounts import accounts
    except:
        accounts = []

import minchat

class AccountManager (baseaccount.AccountManager):
    """This class is a minimal implementation of the Acccount Manager.

    Most implementations will show some screen that lets the user add and
    remove accounts, but we're not quite that sophisticated.
    """

    def __init__(self):

        self.chatui = minchat.MinChat()

        if len(accounts) == 0:
            print "You have defined no accounts."
            print "Put some in ~/.twisted-im-accounts."
        for acct in accounts:
            acct.logOn(self.chatui)
