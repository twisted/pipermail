<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;div&gt;So,&nbsp;I&nbsp;agree&nbsp;pretty&nbsp;much&nbsp;completely&nbsp;with&nbsp;everything&nbsp;exarkun&nbsp;said,&nbsp;but&nbsp;I&nbsp;do&nbsp;feel&nbsp;like&nbsp;I&nbsp;should&nbsp;add&nbsp;a&nbsp;bit&nbsp;more&nbsp;here&nbsp;about&nbsp;the&nbsp;high-level&nbsp;questions&nbsp;raised&nbsp;here:&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Jun&nbsp;6,&nbsp;2010,&nbsp;at&nbsp;3:59&nbsp;PM,&nbsp;Laurens&nbsp;Van&nbsp;Houtven&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;font-family:&nbsp;'Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono';&nbsp;font-size:&nbsp;medium;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;0px;&nbsp;-webkit-border-vertical-spacing:&nbsp;0px;&nbsp;-webkit-text-decorations-in-effect:&nbsp;none;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;A&nbsp;potential&nbsp;option&nbsp;for&nbsp;Twisted,&nbsp;which&nbsp;some&nbsp;people&nbsp;don't&nbsp;quite&nbsp;like,&amp;nbsp;would&nbsp;be&nbsp;to&nbsp;have&nbsp;a&nbsp;listenZMQ&nbsp;and&nbsp;connectZMQ,&nbsp;analogous&nbsp;to&amp;nbsp;listenTCP/listenUDP/listenSSL&nbsp;and&nbsp;the&nbsp;respective&nbsp;connect*s.&lt;/span&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;listenTCP/listenUDP&nbsp;are&nbsp;very&nbsp;different&nbsp;from&nbsp;listenSSL.&nbsp;&amp;nbsp;JP&nbsp;already&nbsp;made&nbsp;an&nbsp;oblique&nbsp;reference&nbsp;to&nbsp;this&nbsp;when&nbsp;talking&nbsp;about&nbsp;ZMQ&nbsp;possibly&nbsp;being&nbsp;implemented&nbsp;in&nbsp;the&nbsp;kernel.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;listenTCP&nbsp;and&nbsp;listenUDP&nbsp;are&nbsp;different&nbsp;kernel-level&nbsp;things.&nbsp;&amp;nbsp;Not&nbsp;only&nbsp;are&nbsp;they&nbsp;implemented&nbsp;differently,&nbsp;they&nbsp;have&nbsp;different&nbsp;semantics&nbsp;and&nbsp;interact&nbsp;with&nbsp;different&nbsp;interfaces.&nbsp;&amp;nbsp;UDP&nbsp;is&nbsp;datagram-oriented,&nbsp;TCP&nbsp;is&nbsp;stream-oriented.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;listenSSL,&nbsp;on&nbsp;the&nbsp;other&nbsp;hand,&nbsp;is&nbsp;a&nbsp;stream&nbsp;transport,&nbsp;implemented&nbsp;in&nbsp;userspace,&nbsp;by&nbsp;a&nbsp;C&nbsp;library.&nbsp;&amp;nbsp;It&nbsp;can&nbsp;be&nbsp;(and&nbsp;actually&nbsp;is,&nbsp;in&nbsp;twisted.protocols.tls)&nbsp;implemented&nbsp;as&nbsp;a&nbsp;regular&nbsp;TCP&nbsp;IProtocol&nbsp;along&nbsp;with&nbsp;providing&nbsp;its&nbsp;own&nbsp;stream-oriented&nbsp;ITransport.&nbsp;&amp;nbsp;There&nbsp;are&nbsp;a&nbsp;couple&nbsp;of&nbsp;reasons&nbsp;that&nbsp;listenSSL&nbsp;and&nbsp;startTLS&nbsp;are&nbsp;implemented&nbsp;as&nbsp;reactor&nbsp;and&nbsp;transport&nbsp;methods,&nbsp;and&nbsp;none&nbsp;of&nbsp;them&nbsp;have&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;intrinsic&nbsp;specialness&nbsp;of&nbsp;TLS&nbsp;itself:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;At&nbsp;the&nbsp;time&nbsp;we&nbsp;wrote&nbsp;them,&nbsp;the&nbsp;APIs&nbsp;to&nbsp;implement&nbsp;twisted.protocols.tls&nbsp;simply&nbsp;weren't&nbsp;available.&nbsp;&amp;nbsp;So,&nbsp;we&nbsp;used&nbsp;the&nbsp;mechanisms&nbsp;available&nbsp;to&nbsp;us&nbsp;to&nbsp;interface&nbsp;with&nbsp;the&nbsp;available&nbsp;library&nbsp;at&nbsp;the&nbsp;time,&nbsp;and&nbsp;that&nbsp;meant&nbsp;having&nbsp;a&nbsp;reactor&nbsp;method.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;reason&nbsp;that&nbsp;the&nbsp;code&nbsp;remains&nbsp;now&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;protocol&nbsp;implementation&nbsp;is&nbsp;that&nbsp;the&nbsp;C&nbsp;code&nbsp;in&nbsp;OpenSSL&nbsp;is&nbsp;faster&nbsp;at&nbsp;getting&nbsp;bytes&nbsp;out&nbsp;of&nbsp;a&nbsp;socket&nbsp;than&nbsp;Twisted;&nbsp;it&nbsp;can&nbsp;do&nbsp;less&nbsp;memory&nbsp;copying&nbsp;while&nbsp;parsing&nbsp;the&nbsp;protocol,&nbsp;and&nbsp;efficiency&nbsp;is&nbsp;really&nbsp;important&nbsp;in&nbsp;TLS;&nbsp;you&nbsp;can&nbsp;visibly&nbsp;notice&nbsp;it&nbsp;when&nbsp;a&nbsp;little&nbsp;extra&nbsp;memory&nbsp;copying&nbsp;starts&nbsp;happening&nbsp;at&nbsp;that&nbsp;layer.&nbsp;&amp;nbsp;Nevertheless,&nbsp;when&nbsp;we&nbsp;encounter&nbsp;a&nbsp;situation&nbsp;which&nbsp;that&nbsp;library&nbsp;doesn't&nbsp;support,&nbsp;such&nbsp;as&nbsp;in&nbsp;the&nbsp;IOCP&nbsp;reactor,&nbsp;we&nbsp;need&nbsp;an&nbsp;implementation&nbsp;that&nbsp;can&nbsp;work&nbsp;with&nbsp;Twisted's&nbsp;native&nbsp;I/O&nbsp;APIs;&nbsp;this&nbsp;becomes&nbsp;a&nbsp;tradeoff&nbsp;between&nbsp;a&nbsp;scalable&nbsp;multiplexor&nbsp;and&nbsp;a&nbsp;slightly&nbsp;faster&nbsp;recv()&nbsp;code-path.&nbsp;&amp;nbsp;As&nbsp;far&nbsp;as&nbsp;I'm&nbsp;aware,&nbsp;nobody's&nbsp;done&nbsp;any&nbsp;particular&nbsp;benchmarks&nbsp;on&nbsp;that&nbsp;one,&nbsp;but&nbsp;I&nbsp;would&nbsp;guess&nbsp;that&nbsp;you&nbsp;win&nbsp;a&nbsp;little&nbsp;and&nbsp;you&nbsp;lose&nbsp;a&nbsp;little&nbsp;and&nbsp;it&nbsp;tends&nbsp;to&nbsp;balance&nbsp;out.&nbsp;&amp;nbsp;Still,&nbsp;when&nbsp;it's&nbsp;possible&nbsp;to&nbsp;gain&nbsp;a&nbsp;little&nbsp;efficiency&nbsp;by&nbsp;doing&nbsp;so,&nbsp;it&nbsp;does&nbsp;make&nbsp;some&nbsp;sense&nbsp;for&nbsp;it&nbsp;to&nbsp;be&nbsp;its&nbsp;own&nbsp;transport&nbsp;API.&nbsp;&amp;nbsp;This&nbsp;may&nbsp;also&nbsp;apply&nbsp;to&nbsp;ZMQ,&nbsp;since&nbsp;they&nbsp;appear&nbsp;to&nbsp;be&nbsp;obsessed&nbsp;with&nbsp;performance.&nbsp;&amp;nbsp;(Although&nbsp;that&nbsp;does&nbsp;beg&nbsp;the&nbsp;question&nbsp;why&nbsp;they&nbsp;seem&nbsp;to&nbsp;recommend&nbsp;a&nbsp;'select'-style&nbsp;API,&nbsp;when&nbsp;as&nbsp;JP&nbsp;notes,&nbsp;that&nbsp;form&nbsp;of&nbsp;API&nbsp;is&nbsp;not&nbsp;great&nbsp;for&nbsp;performance.)&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;font-family:&nbsp;'Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono';&nbsp;font-size:&nbsp;medium;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;0px;&nbsp;-webkit-border-vertical-spacing:&nbsp;0px;&nbsp;-webkit-text-decorations-in-effect:&nbsp;none;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;I&nbsp;think&amp;nbsp;this&nbsp;makes&nbsp;more&nbsp;sense&nbsp;to&nbsp;the&nbsp;ZeroMQ&nbsp;people&nbsp;(who&nbsp;think&nbsp;of&nbsp;ZeroMQ&nbsp;as&nbsp;a&amp;nbsp;layer&nbsp;&quot;next&nbsp;to&quot;&nbsp;TCP&nbsp;which&nbsp;happens&nbsp;to&nbsp;be&nbsp;implemented&nbsp;on&nbsp;top&nbsp;of&nbsp;TCP,&amp;nbsp;on&amp;nbsp;top&nbsp;of&nbsp;which&nbsp;you&nbsp;build&nbsp;your&nbsp;stuff)&lt;/span&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;still&nbsp;hold&nbsp;that&nbsp;the&nbsp;ZMQ&nbsp;people&nbsp;are&nbsp;somewhat&nbsp;confused,&nbsp;and&nbsp;I&nbsp;believe&nbsp;that&nbsp;this&nbsp;very&nbsp;basic&nbsp;breakdown&nbsp;in&nbsp;their&nbsp;spatial&nbsp;reasoning&nbsp;is&nbsp;a&nbsp;good&nbsp;indication&nbsp;of&nbsp;how&nbsp;;-).&nbsp;&amp;nbsp;If&nbsp;you&nbsp;inhabit&nbsp;the&nbsp;same&nbsp;physical&nbsp;reality&nbsp;that&nbsp;I&nbsp;do,&nbsp;you&nbsp;may&nbsp;have&nbsp;noticed&nbsp;that&nbsp;one&nbsp;object&nbsp;cannot,&nbsp;in&nbsp;fact,&nbsp;be&nbsp;both&nbsp;&quot;next&nbsp;to&quot;&nbsp;and&nbsp;&quot;on&nbsp;top&nbsp;of&quot;&nbsp;something&nbsp;else.&nbsp;&amp;nbsp;These&nbsp;are&nbsp;distinct&nbsp;coordinates.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;font-family:&nbsp;'Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono';&nbsp;font-size:&nbsp;medium;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;0px;&nbsp;-webkit-border-vertical-spacing:&nbsp;0px;&nbsp;-webkit-text-decorations-in-effect:&nbsp;none;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;&quot;&gt;than&nbsp;the&nbsp;Twisted&nbsp;people&nbsp;(who&nbsp;think&amp;nbsp;of&nbsp;ZeroMQ's&nbsp;protocol&nbsp;as&nbsp;yet&nbsp;another&nbsp;TCP-using&nbsp;protocol&nbsp;just&nbsp;like&nbsp;HTTP&amp;nbsp;for&nbsp;example).&nbsp;Having&nbsp;worked&nbsp;with&nbsp;both&nbsp;pieces&nbsp;of&nbsp;software,&nbsp;the&nbsp;more&nbsp;I&amp;nbsp;play&nbsp;with&nbsp;ZeroMQ&nbsp;the&nbsp;more&nbsp;I&nbsp;think&nbsp;listenZMQ/connectZMQ&nbsp;make&nbsp;sense.&amp;nbsp;ZeroMQ&nbsp;really&nbsp;tries&nbsp;to&nbsp;be&nbsp;one&nbsp;of&nbsp;those&nbsp;things&nbsp;and&nbsp;it&nbsp;shows.&nbsp;What&amp;nbsp;ZeroMQ&nbsp;wants&nbsp;to&nbsp;do&nbsp;is&nbsp;semantically&nbsp;much&nbsp;closer&nbsp;to&nbsp;the&nbsp;existing&amp;nbsp;connects&nbsp;and&nbsp;listens.&nbsp;I'm&nbsp;not&nbsp;just&nbsp;making&nbsp;this&nbsp;up:&nbsp;the&nbsp;ZeroMQ&nbsp;people&amp;nbsp;have&nbsp;reviewed&nbsp;this&nbsp;and&nbsp;this&nbsp;is&nbsp;really&nbsp;what&nbsp;ZeroMQ&nbsp;wants&nbsp;to&nbsp;be.&lt;/span&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;More&nbsp;seriously,&nbsp;I&nbsp;don't&nbsp;think&nbsp;you&nbsp;should&nbsp;care&nbsp;what&nbsp;ZeroMQ&nbsp;&quot;wants&nbsp;to&nbsp;be&quot;.&nbsp;&amp;nbsp;The&nbsp;question&nbsp;isn't&nbsp;one&nbsp;of&nbsp;existential&nbsp;confusion,&nbsp;it's&nbsp;a&nbsp;practical&nbsp;question&nbsp;of&nbsp;what&nbsp;exactly&nbsp;the&nbsp;library&nbsp;*does*,&nbsp;and&nbsp;what&nbsp;a&nbsp;sensible&nbsp;way&nbsp;to&nbsp;integrate&nbsp;that&nbsp;with&nbsp;Twisted&nbsp;is.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To&nbsp;avoid&nbsp;confusion&nbsp;about&nbsp;endpoints&nbsp;vs.&nbsp;reactor&nbsp;methods,&nbsp;I&nbsp;think&nbsp;it's&nbsp;safe&nbsp;to&nbsp;say&nbsp;that&nbsp;you&nbsp;have&nbsp;three&nbsp;implementation&nbsp;options:&nbsp;let's&nbsp;call&nbsp;them&amp;nbsp;&quot;ZMQProtocol&quot;,&amp;nbsp;&quot;ZMQTransport&quot;,&nbsp;and&nbsp;&quot;ZMQReactor&quot;.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;thing&nbsp;that&nbsp;you&nbsp;appear&nbsp;to&nbsp;be&nbsp;talking&nbsp;down&nbsp;over&nbsp;and&nbsp;over&nbsp;again,&nbsp;implementing&nbsp;ZeroMQ&nbsp;as&nbsp;a&nbsp;'regular&nbsp;TCP'&nbsp;IProtocol&nbsp;provider,&nbsp;does&nbsp;not&nbsp;sound&nbsp;like&nbsp;a&nbsp;viable&nbsp;option.&nbsp;&amp;nbsp;The&nbsp;advantage&nbsp;of&nbsp;this&nbsp;option&nbsp;is&nbsp;that&nbsp;it&nbsp;would&nbsp;allow&nbsp;you&nbsp;to&nbsp;transport&nbsp;ZMQ&nbsp;messages&nbsp;over&nbsp;completely&nbsp;arbitrary&nbsp;Twisted&nbsp;ITransport&nbsp;providers&nbsp;and&nbsp;IReactorTCP&nbsp;providers.&nbsp;&amp;nbsp;However,&nbsp;you've&nbsp;never&nbsp;talked&nbsp;about&nbsp;wanting&nbsp;to&nbsp;do&nbsp;that.&nbsp;&amp;nbsp;The&nbsp;disadvantages&nbsp;are&nbsp;that&nbsp;it&nbsp;doesn't&nbsp;sound&nbsp;like&nbsp;it&nbsp;makes&nbsp;sense&nbsp;to&nbsp;you,&nbsp;none&nbsp;of&nbsp;the&nbsp;APIs&nbsp;are&nbsp;exposed,&nbsp;and&nbsp;it&nbsp;generally&nbsp;goes&nbsp;against&nbsp;the&nbsp;grain&nbsp;of&nbsp;the&nbsp;library.&nbsp;&amp;nbsp;So&nbsp;let's&nbsp;forget&nbsp;about&nbsp;that.&nbsp;&amp;nbsp;(Again,&nbsp;it&nbsp;doesn't&nbsp;matter&nbsp;if&nbsp;ZMQ&nbsp;&quot;really&nbsp;is&quot;&nbsp;a&nbsp;layer&nbsp;&quot;next&nbsp;to&quot;&nbsp;or&nbsp;&quot;on&nbsp;top&nbsp;of&quot;&nbsp;TCP&nbsp;or&nbsp;whatever:&nbsp;if&nbsp;the&nbsp;library&nbsp;makes&nbsp;this&nbsp;difficult&nbsp;or&nbsp;impossible,&nbsp;then&nbsp;it&nbsp;doesn't&nbsp;matter&nbsp;where&nbsp;its&nbsp;true&nbsp;soul&nbsp;lies.)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;JP's&nbsp;option,&nbsp;ZMQTransport,&nbsp;suggests&nbsp;that&nbsp;you&nbsp;should&nbsp;implement&nbsp;it&nbsp;as&nbsp;an&nbsp;IReadDescriptor/IWriteDescriptor.&nbsp;That&nbsp;works&nbsp;if&nbsp;the&nbsp;ZeroMQ&nbsp;library&nbsp;will&nbsp;expose&nbsp;the&nbsp;file&nbsp;descriptors&nbsp;it's&nbsp;using&nbsp;to&nbsp;you.&nbsp;&amp;nbsp;The&nbsp;advantage&nbsp;of&nbsp;this&nbsp;option&nbsp;is&nbsp;that&nbsp;it&nbsp;will&nbsp;work&nbsp;with&nbsp;an&nbsp;arbitrary&nbsp;IReactorFDSet&nbsp;implementation,&nbsp;which&nbsp;basically&nbsp;all&nbsp;of&nbsp;the&nbsp;reactors&nbsp;which&nbsp;can&nbsp;run&nbsp;on&nbsp;a&nbsp;UNIX-like&nbsp;OS&nbsp;are.&nbsp;&amp;nbsp;Also,&nbsp;as&nbsp;JP&nbsp;has&nbsp;described,&nbsp;it's&nbsp;probably&nbsp;not&nbsp;too&nbsp;much&nbsp;code.&nbsp;&amp;nbsp;You&nbsp;can&nbsp;use&nbsp;it&nbsp;with&nbsp;GUI&nbsp;integration,&nbsp;even&nbsp;GUI&nbsp;integration&nbsp;on&nbsp;Windows,&nbsp;and&nbsp;it&nbsp;should&nbsp;work&nbsp;fine.&nbsp;&amp;nbsp;The&nbsp;disadvantages&nbsp;of&nbsp;this&nbsp;option&nbsp;are&nbsp;that&nbsp;apparently&nbsp;ZMQ&nbsp;is&nbsp;going&nbsp;to&nbsp;need&nbsp;to&nbsp;change,&nbsp;because&nbsp;it&nbsp;doesn't&nbsp;want&nbsp;to&nbsp;expose&nbsp;its&nbsp;file&nbsp;descriptors&nbsp;to&nbsp;Python,&nbsp;and&nbsp;it&nbsp;may&nbsp;be&nbsp;complicated&nbsp;to&nbsp;juggle&nbsp;them,&nbsp;depending&nbsp;on&nbsp;when&nbsp;it&nbsp;opens&nbsp;and&nbsp;closes&nbsp;sockets&nbsp;in&nbsp;response&nbsp;to&nbsp;the&nbsp;inner&nbsp;workings&nbsp;of&nbsp;the&nbsp;library.&nbsp;&amp;nbsp;For&nbsp;example,&nbsp;can&nbsp;one&nbsp;&quot;send&nbsp;a&nbsp;ZMQ&nbsp;event&quot;&nbsp;open&nbsp;3&nbsp;UDP&nbsp;sockets&nbsp;and&nbsp;a&nbsp;TCP&nbsp;socket,&nbsp;do&nbsp;a&nbsp;bunch&nbsp;of&nbsp;stuff&nbsp;with&nbsp;them,&nbsp;and&nbsp;shut&nbsp;some&nbsp;of&nbsp;them&nbsp;down?&nbsp;&amp;nbsp;Do&nbsp;multiple&nbsp;logical&nbsp;transports,&nbsp;ahem,&nbsp;I&nbsp;mean,&nbsp;&quot;Sockets&quot;&nbsp;(good&nbsp;job&nbsp;naming&nbsp;that,&nbsp;ZMQ&nbsp;guys)&nbsp;ever&nbsp;share&nbsp;their&nbsp;underlying&nbsp;TCP&nbsp;sockets,&nbsp;and&nbsp;thereby&nbsp;require&nbsp;independent&nbsp;management?&nbsp;&amp;nbsp;I&nbsp;don't&nbsp;know,&nbsp;but&nbsp;I&nbsp;can&nbsp;imagine&nbsp;that&nbsp;it&nbsp;might,&nbsp;and&nbsp;that&nbsp;could&nbsp;be&nbsp;a&nbsp;pain&nbsp;to&nbsp;expose&nbsp;sensibly.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;third&nbsp;option,&nbsp;which&nbsp;you've&nbsp;discussed,&nbsp;is&nbsp;implementing&nbsp;a&nbsp;reactor&nbsp;in&nbsp;terms&nbsp;of&nbsp;pyzmq's&nbsp;existing&nbsp;multiplexing&nbsp;mechanisms.&nbsp;&amp;nbsp;One&nbsp;advantage&nbsp;of&nbsp;this&nbsp;approach&nbsp;is&nbsp;that&nbsp;it&nbsp;will&nbsp;support&nbsp;ZMQ&nbsp;the&nbsp;most&nbsp;naturally;&nbsp;you&nbsp;can&nbsp;just&nbsp;call&nbsp;the&nbsp;relevant&nbsp;APIs.&nbsp;One&nbsp;advantage&nbsp;which&nbsp;it&nbsp;*may*&nbsp;have&nbsp;-&nbsp;I'm&nbsp;not&nbsp;quite&nbsp;sure&nbsp;-&nbsp;is&nbsp;performance.&nbsp;&amp;nbsp;It&nbsp;may&nbsp;be&nbsp;possible&nbsp;for&nbsp;the&nbsp;ZMQ&nbsp;library&nbsp;to&nbsp;do&nbsp;a&nbsp;bunch&nbsp;of&nbsp;work&nbsp;inside&nbsp;zmq.select()&nbsp;without&nbsp;talking&nbsp;to&nbsp;Twisted's&nbsp;abstractions&nbsp;at&nbsp;all.&nbsp;&amp;nbsp;And&nbsp;while&nbsp;Twisted&nbsp;can&nbsp;be&nbsp;pretty&nbsp;fast,&nbsp;especially&nbsp;for&nbsp;Python,&nbsp;I&nbsp;have&nbsp;never&nbsp;even&nbsp;*heard*&nbsp;of&nbsp;anyone&nbsp;trying&nbsp;to&nbsp;run&nbsp;it&nbsp;over&nbsp;InfiniBand,&nbsp;and&nbsp;if&nbsp;they&nbsp;did,&nbsp;I&nbsp;would&nbsp;not&nbsp;expect&nbsp;8&nbsp;million&nbsp;messages&nbsp;per&nbsp;second&nbsp;on&nbsp;any&nbsp;hardware&nbsp;I&nbsp;can&nbsp;think&nbsp;of;&nbsp;the&nbsp;mainloop&nbsp;has&nbsp;too&nbsp;much&nbsp;overhead.&nbsp;&amp;nbsp;Based&nbsp;on&nbsp;some&nbsp;back-of-the-envelope&nbsp;(and&nbsp;probably&nbsp;highly&nbsp;inaccurate)&nbsp;math,&nbsp;Python&nbsp;*bytecode&nbsp;execution*&nbsp;is&nbsp;too&nbsp;much&nbsp;overhead&nbsp;to&nbsp;get&nbsp;that&nbsp;level&nbsp;of&nbsp;performance;&nbsp;I'm&nbsp;kind&nbsp;of&nbsp;skeptical&nbsp;that&nbsp;they&nbsp;even&nbsp;get&nbsp;it&nbsp;in&nbsp;C&nbsp;without&nbsp;benchmark&nbsp;hax&nbsp;of&nbsp;some&nbsp;kind;&nbsp;but&nbsp;nevertheless,&nbsp;they&nbsp;advertise&nbsp;this&nbsp;performance&nbsp;on&nbsp;their&nbsp;home&nbsp;page&nbsp;and&nbsp;they&nbsp;obviously&nbsp;care&nbsp;about&nbsp;it&nbsp;quite&nbsp;a&nbsp;lot.&nbsp;&amp;nbsp;It's&nbsp;not&nbsp;going&nbsp;to&nbsp;speed&nbsp;up&nbsp;your&nbsp;Twisted&nbsp;code&nbsp;at&nbsp;all,&nbsp;of&nbsp;course,&nbsp;and&nbsp;I&nbsp;have&nbsp;no&nbsp;idea&nbsp;if&nbsp;ZMQ&nbsp;messaging&nbsp;dominates&nbsp;your&nbsp;workload,&nbsp;so&nbsp;it&nbsp;may&nbsp;be&nbsp;a&nbsp;negligible&nbsp;gain.&nbsp;&amp;nbsp;The&nbsp;disadvantages&nbsp;of&nbsp;this&nbsp;approach,&nbsp;as&nbsp;several&nbsp;people&nbsp;have&nbsp;already&nbsp;pointed&nbsp;out,&nbsp;are&nbsp;that&nbsp;it&nbsp;won't&nbsp;work&nbsp;with&nbsp;GUI&nbsp;integration,&nbsp;or&nbsp;any&nbsp;custom&nbsp;third-party&nbsp;reactors,&nbsp;or...&nbsp;well,&nbsp;pretty&nbsp;much&nbsp;any&nbsp;features&nbsp;except&nbsp;the&nbsp;ones&nbsp;you&nbsp;explicitly&nbsp;build&nbsp;in&nbsp;yourself.&nbsp;&amp;nbsp;Also,&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;properly&nbsp;stick&nbsp;to&nbsp;public&nbsp;APIs&nbsp;and&nbsp;build&nbsp;this&nbsp;as&nbsp;an&nbsp;extension&nbsp;to&nbsp;Twisted,&nbsp;you&nbsp;may&nbsp;find&nbsp;yourself&nbsp;rewriting&nbsp;some&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;twisted.internet,&nbsp;or&nbsp;inheriting&nbsp;some&nbsp;public-but-ugh-we-wish-it-weren't&nbsp;classes.&nbsp;&amp;nbsp;This&nbsp;option&nbsp;may&nbsp;be&nbsp;somewhat&nbsp;labor&nbsp;intensive&nbsp;on&nbsp;the&nbsp;Twisted&nbsp;side&nbsp;of&nbsp;things,&nbsp;although&nbsp;as&nbsp;you&nbsp;note,&nbsp;it&nbsp;will&nbsp;probably&nbsp;be&nbsp;pretty&nbsp;easy&nbsp;with&nbsp;ZMQ.&nbsp;&amp;nbsp;It&nbsp;shouldn't&nbsp;be&nbsp;*too*&nbsp;hard&nbsp;though,&nbsp;and&nbsp;if&nbsp;you're&nbsp;willing&nbsp;to&nbsp;resort&nbsp;to&nbsp;heinous&nbsp;unsupported&nbsp;hacks,&nbsp;you&nbsp;could&nbsp;do&nbsp;something&nbsp;like&nbsp;subclass&nbsp;PollReactor&nbsp;and&nbsp;just&nbsp;replace&nbsp;'_poller'&nbsp;with&nbsp;a&nbsp;poller&nbsp;from&nbsp;zmq.poll,&nbsp;which&nbsp;is&nbsp;at&nbsp;least&nbsp;advertised&nbsp;to&nbsp;be&nbsp;compatible&nbsp;(although&nbsp;I&nbsp;suspect&nbsp;that&nbsp;the&nbsp;reality&nbsp;may&nbsp;fall&nbsp;short&nbsp;slightly,&nbsp;as&nbsp;it&nbsp;often&nbsp;does).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Based&nbsp;on&nbsp;this&nbsp;analysis,&nbsp;which&nbsp;is&nbsp;far&nbsp;more&nbsp;thorough&nbsp;than&nbsp;I&nbsp;really&nbsp;wanted&nbsp;to&nbsp;do&nbsp;:(,&nbsp;it&nbsp;sounds&nbsp;to&nbsp;me&nbsp;like&nbsp;ZMQTransport&nbsp;and&nbsp;ZMQReactor&nbsp;are&nbsp;both&nbsp;somewhat&nbsp;feasible,&nbsp;and&nbsp;have&nbsp;overlapping&nbsp;advantages&nbsp;and&nbsp;disadvantages&nbsp;which&nbsp;may&nbsp;make&nbsp;each&nbsp;of&nbsp;them&nbsp;an&nbsp;attractive&nbsp;option&nbsp;in&nbsp;different&nbsp;circumstances.&nbsp;&amp;nbsp;There&nbsp;are&nbsp;probably&nbsp;situations&nbsp;where&nbsp;even&nbsp;ZMQProtocol&nbsp;would&nbsp;make&nbsp;sense.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;BOTH&nbsp;of&nbsp;these&nbsp;options,&nbsp;you're&nbsp;going&nbsp;to&nbsp;need&nbsp;to&nbsp;define,&nbsp;implicitly&nbsp;or&nbsp;explicitly,&nbsp;IZMQTransport&nbsp;and&nbsp;IZMQProtocol&nbsp;interfaces,&nbsp;stipulating&nbsp;the&nbsp;interaction&nbsp;between&nbsp;the&nbsp;transport&nbsp;layer&nbsp;of&nbsp;your&nbsp;ZMQ&nbsp;API&nbsp;and&nbsp;the&nbsp;protocol&nbsp;layer&nbsp;which&nbsp;applications&nbsp;implement.&nbsp;&amp;nbsp;Maybe&nbsp;pyzmq&nbsp;already&nbsp;outlines&nbsp;this&nbsp;for&nbsp;you,&nbsp;maybe&nbsp;not;&nbsp;but&nbsp;the&nbsp;point&nbsp;is,&nbsp;you&nbsp;should&nbsp;really&nbsp;be&nbsp;focusing&nbsp;on&nbsp;defining&nbsp;*that*&nbsp;interface&nbsp;in&nbsp;a&nbsp;way&nbsp;that&nbsp;makes&nbsp;sense.&nbsp;&amp;nbsp;The&nbsp;rest&nbsp;of&nbsp;this&nbsp;stuff&nbsp;is&nbsp;all&nbsp;implementation&nbsp;details.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;define&nbsp;those&nbsp;interfaces&nbsp;well,&nbsp;then&nbsp;whatever&nbsp;integration&nbsp;option&nbsp;you&nbsp;start&nbsp;with,&nbsp;you&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;change&nbsp;the&nbsp;internal&nbsp;implementation,&nbsp;or&nbsp;perhaps&nbsp;even&nbsp;use&nbsp;multiple&nbsp;implementations.&nbsp;&amp;nbsp;For&nbsp;example,&nbsp;you&nbsp;may&nbsp;discover&nbsp;that&nbsp;the&nbsp;performance&nbsp;thing&nbsp;is&nbsp;actually&nbsp;significant,&nbsp;and&nbsp;want&nbsp;to&nbsp;use&nbsp;ZMQReactor&nbsp;on&nbsp;your&nbsp;back-end&nbsp;servers,&nbsp;but&nbsp;eventually&nbsp;write&nbsp;some&nbsp;client-side&nbsp;GUI&nbsp;tools&nbsp;which&nbsp;also&nbsp;want&nbsp;to&nbsp;use&nbsp;ZMQ&nbsp;but&nbsp;aren't&nbsp;quite&nbsp;as&nbsp;performance-sensitive.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;personally&nbsp;have&nbsp;little&nbsp;interest&nbsp;in&nbsp;ZMQ&nbsp;itself,&nbsp;but&nbsp;I&nbsp;think&nbsp;this&nbsp;general&nbsp;pattern&nbsp;stands&nbsp;for&nbsp;any&nbsp;large,&nbsp;existing&nbsp;C&nbsp;protocol&nbsp;library&nbsp;that&nbsp;someone&nbsp;might&nbsp;want&nbsp;to&nbsp;integrate&nbsp;with&nbsp;Twisted.&nbsp;&amp;nbsp;In&nbsp;most&nbsp;cases&nbsp;the&nbsp;'reactor'&nbsp;option&nbsp;probably&nbsp;isn't&nbsp;there,&nbsp;but&nbsp;'is&nbsp;it&nbsp;a&nbsp;protocol&nbsp;or&nbsp;is&nbsp;it&nbsp;a&nbsp;transport'&nbsp;would&nbsp;be&nbsp;a&nbsp;FAQ,&nbsp;if&nbsp;there&nbsp;were&nbsp;more&nbsp;in&nbsp;the&nbsp;way&nbsp;of&nbsp;large,&nbsp;useful&nbsp;C&nbsp;libraries&nbsp;that&nbsp;did&nbsp;async&nbsp;networking&nbsp;stuff&nbsp;:).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
