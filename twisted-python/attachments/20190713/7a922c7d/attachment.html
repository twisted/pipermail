<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;Hi,&lt;div&gt; &nbsp;Thank&nbsp;you&nbsp;all&nbsp;for&nbsp;your&nbsp;kind&nbsp;response.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;use&nbsp;treq&nbsp;library&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;import&nbsp;treq&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail-gs&quot;&nbsp;style=&quot;margin:0px;padding:0px&nbsp;0px&nbsp;20px;width:1082.02px;font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif;font-size:medium&quot;&gt;&lt;div&nbsp;class=&quot;gmail-&quot;&gt;&lt;div&nbsp;id=&quot;gmail-:mk&quot;&nbsp;class=&quot;gmail-ii&nbsp;gmail-gt&nbsp;gmail-adO&quot;&nbsp;style=&quot;font-size:0.875rem;direction:ltr;margin:8px&nbsp;0px&nbsp;0px;padding:0px&quot;&gt;&lt;div&nbsp;id=&quot;gmail-:dx&quot;&nbsp;class=&quot;gmail-a3s&nbsp;gmail-aXjCH&quot;&nbsp;style=&quot;overflow:hidden;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:small;line-height:1.5;font-family:Arial,Helvetica,sans-serif&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;&lt;a&nbsp;class=&quot;gmail_plusreply&quot;&nbsp;id=&quot;gmail-m_-8329566451866347139gmail-m_696722601013816822plusReplyChip-3&quot;&gt;@defer.inlinecallbacks&lt;/a&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;white-space:pre-wrap;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;def&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;long_computation&lt;/span&gt;(&lt;span&nbsp;style=&quot;color:rgb(128,128,128);background-color:rgb(255,216,236)&quot;&gt;rec_type,&nbsp;data&lt;/span&gt;)&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;:&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&nbsp;style=&quot;color:rgb(80,0,80)&quot;&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;#&nbsp;some&nbsp;long&nbsp;computation&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;defer.returnValue(recs)&lt;/b&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;gmail-im&quot;&nbsp;style=&quot;color:rgb(80,0,80)&quot;&gt;&lt;div&gt;@defer.inlinecallbacks&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;fetch_data(user_id):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;  &lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(128,128,128);background-color:rgb(255,216,236)&quot;&gt;r&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(128,128,128)&quot;&gt; &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-weight:bold&quot;&gt;=&nbsp;yield&nbsp;treq.get&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(221,17,68);background-color:rgb(247,231,241)&quot;&gt;&#39;url/to/fetch/%s&#39;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-weight:bold&quot;&gt;%&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-style:italic&quot;&gt;user_id&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt; &nbsp; &nbsp;text&nbsp;=&nbsp;yield&nbsp;r.text()&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; defer.returnValue(text)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;@defer.inlinecallbacks&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;fetch_recs(user_id):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; data&nbsp;=&nbsp;yield&nbsp;fetch_data(user_id)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;recs&nbsp;=&nbsp;{}&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; for&nbsp;stype&nbsp;in&nbsp;similar_types:&lt;/div&gt;&lt;/span&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;b&gt;d&nbsp;=&nbsp;defer.ToThread(&lt;span&nbsp;style=&quot;color:rgb(153,0,0);background-color:rgb(248,248,255);font-family:Menlo;font-size:9pt&quot;&gt;long_computation&lt;/span&gt;,&nbsp;*(stype,&nbsp;data))&nbsp;//&nbsp;typo&nbsp;was&nbsp;here&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;Now,&nbsp;I&nbsp;do&nbsp;believe&nbsp;that&nbsp;the&nbsp;call&nbsp;is&nbsp;happening&nbsp;asyncronously.&nbsp;So..&nbsp;yay..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But&nbsp;then,&nbsp;I&nbsp;feel&nbsp;like&nbsp;I&nbsp;have&nbsp;a&nbsp;misconception&nbsp;on&nbsp;how&nbsp;the&nbsp;yield&nbsp;works.&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;color:rgb(80,0,80)&quot;&gt;data&nbsp;=&nbsp;yield&nbsp;fetch_data(user_id)&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;I&nbsp;was&nbsp;hoping&nbsp;data&nbsp;here&nbsp;was&nbsp;actual&nbsp;data..&nbsp;But&nbsp;it&nbsp;is&nbsp;a&nbsp;deferred..&nbsp;Which&nbsp;makes&nbsp;sense.&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;And&nbsp;then..&nbsp;this&nbsp;deferred&nbsp;is&nbsp;being&nbsp;passed&nbsp;on&nbsp;instead&nbsp;of&nbsp;the&nbsp;actual&nbsp;data...&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;My&nbsp;couple&nbsp;of&nbsp;questions&nbsp;are:&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80)&quot;&gt;1)&nbsp;&lt;/span&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;What&nbsp;is&nbsp;the&nbsp;difference&nbsp;between&lt;/font&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&nbsp;data&nbsp;=&nbsp;yield&nbsp;fetch_data(user_id)&nbsp;&lt;/font&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;and&lt;/font&gt;&lt;font&nbsp;color=&quot;#500050&quot;&gt;&nbsp;data&nbsp;=&nbsp;fetch_data(user_id)&lt;/font&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&nbsp;(without&nbsp;yield).&nbsp;How&nbsp;does&nbsp;twisted&nbsp;handle&nbsp;these&nbsp;two&nbsp;?&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(80,0,80)&quot;&gt;2)&nbsp;&lt;/span&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;How&nbsp;do&nbsp;I&nbsp;actually&nbsp;send&nbsp;the&nbsp;data&nbsp;to&nbsp;long&nbsp;computation&nbsp;rather&nbsp;than&nbsp;a&nbsp;deferred.&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;br&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;Appreciate&nbsp;all&nbsp;the&nbsp;help.&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;Thanks&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail-hi&quot;&nbsp;style=&quot;border-bottom-left-radius:1px;border-bottom-right-radius:1px;padding:0px;width:auto;background:rgb(242,242,242);margin:0px&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;gmail-Apple-interchange-newline&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Sat,&nbsp;Jul&nbsp;13,&nbsp;2019&nbsp;at&nbsp;1:57&nbsp;AM&nbsp;Tom&nbsp;Most&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:twm@freecog.net&quot;&gt;twm@freecog.net&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;Thu,&nbsp;Jul&nbsp;11,&nbsp;2019,&nbsp;at&nbsp;1:46&nbsp;AM,&nbsp;Scott,&nbsp;Barry&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;Tuesday,&nbsp;9&nbsp;July&nbsp;2019&nbsp;22:04:11&nbsp;BST&nbsp;Tom&nbsp;Most&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;...snip...&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;The&nbsp;reactor&#39;s&nbsp;own&nbsp;thread&nbsp;pool&nbsp;is&nbsp;really&nbsp;for&nbsp;DNS&nbsp;resolution.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Is&nbsp;that&nbsp;still&nbsp;true&nbsp;in&nbsp;the&nbsp;default&nbsp;case?&nbsp;We&nbsp;are&nbsp;use&nbsp;the&nbsp;twisted&nbsp;code&nbsp;that&nbsp;talks&nbsp;&lt;br&gt;<br>
&gt;&nbsp;to&nbsp;DNS&nbsp;servers&nbsp;as&nbsp;the&nbsp;threaded&nbsp;resolver&nbsp;adds&nbsp;too&nbsp;much&nbsp;latency.&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;far&nbsp;as&nbsp;I&nbsp;know,&nbsp;yes.&nbsp;The&nbsp;higher-level&nbsp;APIs&nbsp;use&nbsp;getaddrinfo()&nbsp;at&nbsp;least.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://twistedmatrix.com/documents/current/api/twisted.internet._resolver.GAIResolver.html&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://twistedmatrix.com/documents/current/api/twisted.internet._resolver.GAIResolver.html&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://github.com/twisted/twisted/blob/c0776850e756adfcdc179a7fd9e4c8f5cbc4838d/src/twisted/internet/base.py#L1007&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/twisted/twisted/blob/c0776850e756adfcdc179a7fd9e4c8f5cbc4838d/src/twisted/internet/base.py#L1007&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
TCP6ClientEndpoint&nbsp;also&nbsp;invoke&nbsp;getaddrinfo()&nbsp;directly.&lt;br&gt;<br>
&lt;br&gt;<br>
twisted.names&nbsp;is&nbsp;certainly&nbsp;more&nbsp;performance&nbsp;but&nbsp;it&#39;s&nbsp;missing&nbsp;some&nbsp;system&nbsp;integration&nbsp;features&nbsp;that&nbsp;make&nbsp;it&nbsp;unsuitable&nbsp;as&nbsp;a&nbsp;default:&lt;br&gt;<br>
&lt;br&gt;<br>
*&nbsp;No&nbsp;support&nbsp;for&nbsp;the&nbsp;domain&nbsp;or&nbsp;search&nbsp;resolv.conf&nbsp;directives&lt;br&gt;<br>
*&nbsp;No&nbsp;NSS&nbsp;lookups&nbsp;(e.g.,&nbsp;systemd&nbsp;integration)&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;all&nbsp;on&nbsp;Linux,&nbsp;YMMV&nbsp;on&nbsp;other&nbsp;platforms.&lt;br&gt;<br>
&lt;br&gt;<br>
---Tom&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
