<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;Verdana;font-size:&nbsp;12.0px;&quot;&gt;&lt;div&gt;Hey&nbsp;there,&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;Setup:&lt;/div&gt;<br>
<br>
&lt;div&gt;-i&nbsp;got&nbsp;a&nbsp;Server&nbsp;which&nbsp;is&nbsp;running&nbsp;a&nbsp;Delphi&nbsp;application&nbsp;on&nbsp;Windows7&nbsp;using&nbsp;WinSocketComponents&lt;/div&gt;<br>
<br>
&lt;div&gt;-i&nbsp;got&nbsp;a&nbsp;Client&nbsp;(Raspberry&nbsp;Pi)&nbsp;which&nbsp;is&nbsp;running&nbsp;my&nbsp;python&nbsp;client&nbsp;application&nbsp;with&nbsp;twisted&lt;/div&gt;<br>
<br>
&lt;div&gt;-the&nbsp;server&nbsp;collects&nbsp;data&nbsp;which&nbsp;the&nbsp;client&nbsp;is&nbsp;sending,&nbsp;sometimes&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;Problem:&lt;/div&gt;<br>
<br>
&lt;div&gt;-the&nbsp;client&nbsp;connects&nbsp;and&nbsp;starts&nbsp;sending,&nbsp;the&nbsp;communication&nbsp;works&nbsp;fine&nbsp;at&nbsp;first&lt;/div&gt;<br>
<br>
&lt;div&gt;-after&nbsp;some&nbsp;time&nbsp;(rigth&nbsp;now&nbsp;i&nbsp;see&nbsp;no&nbsp;correlation&nbsp;or&nbsp;principle)&nbsp;the&nbsp;server&nbsp;won&#39;t&nbsp;get&nbsp;any&nbsp;messages&nbsp;anymore,&nbsp;although&nbsp;the&nbsp;client&nbsp;keeps&nbsp;sending&nbsp;(or&nbsp;at&nbsp;least&nbsp;the&nbsp;client&nbsp;keeps&nbsp;calling&nbsp;the&nbsp;sendMessage()&nbsp;function&lt;/div&gt;<br>
<br>
&lt;div&gt;-&gt;the&nbsp;client&nbsp;is&nbsp;still&nbsp;able&nbsp;to&nbsp;receive&nbsp;messages!&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;I&nbsp;have&nbsp;no&nbsp;clue&nbsp;whats&nbsp;happening.&nbsp;There&nbsp;is&nbsp;no&nbsp;suspicious&nbsp;behavior&nbsp;nor&nbsp;a&nbsp;exception&nbsp;call.&lt;/div&gt;<br>
<br>
&lt;div&gt;When&nbsp;i&nbsp;stop&nbsp;the&nbsp;client,&nbsp;the&nbsp;server&nbsp;recognizes&nbsp;a&nbsp;disconnect,&nbsp;but&nbsp;before,&nbsp;no&nbsp;disconnect&nbsp;is&nbsp;recognized.&lt;/div&gt;<br>
<br>
&lt;div&gt;Has&nbsp;anyone&nbsp;of&nbsp;you&nbsp;an&nbsp;idea&nbsp;or&nbsp;does&nbsp;anyone&nbsp;see&nbsp;a&nbsp;mistake&nbsp;in&nbsp;the&nbsp;design&nbsp;of&nbsp;my&nbsp;Factory&nbsp;or&nbsp;Protocol?&lt;/div&gt;<br>
<br>
&lt;div&gt;Are&nbsp;there&nbsp;known&nbsp;problems&nbsp;with&nbsp;the&nbsp;combination&nbsp;of&nbsp;python&nbsp;twisted&nbsp;and&nbsp;WinSocket&nbsp;of&nbsp;Windows?&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;Here&nbsp;are&nbsp;both:&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;<br>
&lt;div&gt;class&nbsp;ControllerProtocol(Protocol):&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionMade(self):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;send&nbsp;Greeting&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.factory.isConnected&nbsp;=&nbsp;True&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.write(&quot;Hi&nbsp;there&nbsp;Mother.&quot;)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.factory.resetDelay()&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#self.RefToOperator.debug(&#39;0&nbsp;&#124;-&gt;&nbsp;ConnectionMade.&#39;)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Parse&nbsp;received&nbsp;data&nbsp;and&nbsp;send&nbsp;corresponding&nbsp;Message.&quot;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.write(self.factory.reactOnReceive(data))&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionLost(self,&nbsp;reason):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#try&nbsp;to&nbsp;reconnect&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.factory.isConnected&nbsp;=&nbsp;False&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#self.RefToOperator.debug(&nbsp;&quot;0&nbsp;Connection&nbsp;lost&quot;)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;sendMessage(self,&nbsp;data):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.factory.RefToOperator.debug(&#39;2&nbsp;Sending&nbsp;Message.&#39;)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.write(data)&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br/&gt;<br>
class&nbsp;Communicator(ReconnectingClientFactory):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;=&nbsp;ControllerProtocol&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;operator):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:param&nbsp;operator:&nbsp;Operator&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:type&nbsp;self.RefToOperator:&nbsp;Operator&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.isConnected&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;False&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.connectedProtocol&nbsp;=&nbsp;None&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.RefToOperator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;operator&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.maxDelay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;maximum&nbsp;number&nbsp;of&nbsp;seconds&nbsp;between&nbsp;connection&nbsp;attempts&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__del__(self):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.RefToOperator.debug(&nbsp;&#39;0&nbsp;Stopping&nbsp;SocketClient.&#39;)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;buildProtocol(self,&nbsp;addr):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;ReconnectingClientFactory.buildProtocol(self,&nbsp;addr)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.connectedProtocol&nbsp;=&nbsp;p&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;clientConnectionFailed(self,&nbsp;connector,&nbsp;reason):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.RefToOperator.debug(&#39;0&nbsp;Connection&nbsp;failed.&nbsp;Reason:&#39;&nbsp;+&nbsp;str(reason))&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning(&#39;Connection&nbsp;failed.&nbsp;Reason:&nbsp;%s&#39;,&nbsp;reason)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReconnectingClientFactory.clientConnectionFailed(self,&nbsp;connector,&nbsp;reason)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;clientConnectionLost(self,&nbsp;connector,&nbsp;reason):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.RefToOperator.debug(&#39;0&nbsp;Lost&nbsp;connection.&nbsp;&nbsp;Reason:&#39;&nbsp;+&nbsp;str(reason))&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.connectedProtocol&nbsp;=&nbsp;None&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(&#39;Connection&nbsp;lost.&nbsp;Reason:&nbsp;%s&#39;,&nbsp;reason)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReconnectingClientFactory.clientConnectionLost(self,&nbsp;connector,&nbsp;reason)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;reactOnReceive(self,&nbsp;String):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.RefToOperator.debug(&#39;2&nbsp;Received&nbsp;Data&nbsp;from&nbsp;Mothership:&#39;&nbsp;+&nbsp;str(String))&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.RefToOperator.reactOnReceivedData(String)&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;sendMessage(self,&nbsp;Message):&lt;br/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.connectedProtocol.SendMessage(Message)&lt;/div&gt;<br>
<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
<br>
&lt;div&gt;I&nbsp;woul&#39;d&nbsp;be&nbsp;glad&nbsp;about&nbsp;any&nbsp;help&nbsp;or&nbsp;clue.&lt;/div&gt;<br>
<br>
&lt;div&gt;Greets,&lt;/div&gt;<br>
<br>
&lt;div&gt;Toni&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<br>
<br>
<br>

</tt>
