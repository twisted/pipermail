<tt>
On&nbsp;6/20/07,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Delgado,&nbsp;Edgardo&nbsp;&nbsp;CIV&nbsp;NAVAIR&nbsp;&lt;a&nbsp;href=&quot;http://4.1.4.3&quot;&gt;4.1.4.3&lt;/a&gt;&lt;/b&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:edgardo.delgado@navy.mil&quot;&gt;edgardo.delgado@navy.mil&lt;/a&gt;&gt;&nbsp;wrote:&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Here&#39;s&nbsp;the&nbsp;code:&lt;br&gt;&lt;br&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;ServerFactory,&nbsp;ClientFactory,<br>
&lt;br&gt;Protocol,&nbsp;ClientCreator&lt;br&gt;from&nbsp;twisted.protocols.basic&nbsp;import&nbsp;LineReceiver&lt;br&gt;from&nbsp;twisted.application.service&nbsp;import&nbsp;Service,&nbsp;Application,&lt;br&gt;IServiceCollection&lt;br&gt;from&nbsp;twisted.application.internet&nbsp;import&nbsp;TCPServer,&nbsp;TCPClient<br>
&lt;br&gt;from&nbsp;twisted.internet.stdio&nbsp;import&nbsp;StandardIO&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;import&nbsp;re&lt;br&gt;&lt;br&gt;class&nbsp;DnLinkProtocol(LineReceiver):&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionMade(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Connected&nbsp;from:&nbsp;&quot;&nbsp;+&nbsp;&quot;host&nbsp;&quot;&nbsp;+<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str(self.transport.getPeer().host)&nbsp;+&nbsp;&quot;&nbsp;&quot;&nbsp;+&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;port&nbsp;&quot;&nbsp;+&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str(self.transport.getPeer().port)&nbsp;+&nbsp;&#39;\n&#39;)&lt;br&gt;<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;lineReceived(self,&nbsp;line):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;DnLink&nbsp;echo:&nbsp;&quot;&nbsp;+&nbsp;line&nbsp;+&nbsp;&#39;\n&#39;)&lt;br&gt;&lt;br&gt;class&nbsp;DSPEProtocol(LineReceiver):&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionMade(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Connected&nbsp;from:&nbsp;&quot;&nbsp;+&nbsp;&quot;host&nbsp;&quot;&nbsp;+<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str(self.transport.getPeer().host)&nbsp;+&nbsp;&quot;&nbsp;&quot;&nbsp;+&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;port&nbsp;&quot;&nbsp;+&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str(self.transport.getPeer().port)&nbsp;+&nbsp;&#39;\n&#39;)&lt;br&gt;<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;lineReceived(self,&nbsp;line):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;DSPE&nbsp;echo:&nbsp;&quot;&nbsp;+&nbsp;line&nbsp;+&nbsp;&#39;\n&#39;)&lt;br&gt;&lt;br&gt;class&nbsp;PAPSExecService(Service):&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getDnLinkInFactory(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;ServerFactory()&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.protocol&nbsp;=&nbsp;DnLinkProtocol&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.startService&nbsp;=&nbsp;self.startService&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;f&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getDSPEInFactory(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;ServerFactory()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.protocol&nbsp;=&nbsp;DSPEProtocol&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.startService<br>
&nbsp;=&nbsp;self.startService&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;f&lt;br&gt;&lt;br&gt;application&nbsp;=&nbsp;Application(&#39;PAPSExec&#39;)&lt;br&gt;f&nbsp;=&nbsp;PAPSExecService()&lt;br&gt;serviceCollection&nbsp;=&nbsp;IServiceCollection(application)&lt;br&gt;TCPServer(9595,&lt;br&gt;f.getDnLinkInFactory()).setServiceParent(serviceCollection)<br>
&lt;br&gt;TCPServer(8585,&lt;br&gt;f.getDSPEInFactory()).setServiceParent(serviceCollection)&lt;br&gt;&lt;br&gt;&lt;br&gt;I&nbsp;would&nbsp;like&nbsp;that,&nbsp;for&nbsp;example,&nbsp;when&nbsp;data&nbsp;is&nbsp;received&nbsp;in&nbsp;port&nbsp;9595&nbsp;it&lt;br&gt;will&nbsp;forward&nbsp;the&nbsp;data&nbsp;to&nbsp;another&nbsp;server&nbsp;in&nbsp;port&nbsp;xxxx.&lt;br&gt;<br>
Where&nbsp;would&nbsp;I&nbsp;create&nbsp;a&nbsp;TPC&nbsp;Client&nbsp;connection?&lt;br&gt;Where&nbsp;would&nbsp;I&nbsp;send&nbsp;the&nbsp;message?&lt;br&gt;&lt;br&gt;Edgar&lt;br&gt;&lt;br&gt;-----Original&nbsp;Message-----&lt;br&gt;From:&nbsp;&lt;a&nbsp;href=&quot;mailto:twisted-python-bounces@twistedmatrix.com&quot;&gt;twisted-python-bounces@twistedmatrix.com<br>
&lt;/a&gt;&lt;br&gt;[mailto:&lt;a&nbsp;href=&quot;mailto:twisted-python-bounces@twistedmatrix.com&quot;&gt;twisted-python-bounces@twistedmatrix.com&lt;/a&gt;]&nbsp;On&nbsp;Behalf&nbsp;Of&nbsp;Christian&lt;br&gt;Simms&lt;br&gt;Sent:&nbsp;Wednesday,&nbsp;June&nbsp;20,&nbsp;2007&nbsp;11:01&nbsp;AM&lt;br&gt;To:&nbsp;Twisted&nbsp;general&nbsp;discussion<br>
&lt;br&gt;Subject:&nbsp;Re:&nbsp;[Twisted-Python]&nbsp;Server/Client&lt;br&gt;&lt;br&gt;On&nbsp;6/20/07,&nbsp;Delgado,&nbsp;Edgardo&nbsp;CIV&nbsp;NAVAIR&nbsp;&lt;a&nbsp;href=&quot;http://4.1.4.3&quot;&gt;4.1.4.3&lt;/a&gt;&lt;br&gt;&lt;&lt;a&nbsp;href=&quot;mailto:edgardo.delgado@navy.mil&quot;&gt;edgardo.delgado@navy.mil&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;build&nbsp;a&nbsp;server&nbsp;that&nbsp;when&nbsp;it&nbsp;gets&nbsp;a&nbsp;message&nbsp;on&nbsp;a&lt;br&gt;specific&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port&nbsp;it&nbsp;will&nbsp;&quot;forward&quot;&nbsp;that&nbsp;message&nbsp;to&nbsp;another&nbsp;port.&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I.e.&nbsp;&quot;Server1&quot;&nbsp;listens&nbsp;on&nbsp;port&nbsp;10000.&nbsp;When&nbsp;it&nbsp;gets&nbsp;data&nbsp;on&nbsp;port<br>
&lt;br&gt;10000&nbsp;it&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will&nbsp;forward&nbsp;the&nbsp;data&nbsp;to&nbsp;&quot;Server2&quot;&nbsp;listening&nbsp;on&nbsp;port&nbsp;15000.&lt;br&gt;&lt;br&gt;&lt;br&gt;Assuming&nbsp;you&#39;re&nbsp;using&nbsp;TCP,&nbsp;you&nbsp;could&nbsp;just&nbsp;create&nbsp;a&nbsp;server&nbsp;listening&nbsp;on&nbsp;a&lt;br&gt;port&nbsp;using&nbsp;reactor.listenTCP(port,&nbsp;factory)&nbsp;as&nbsp;detailed&nbsp;here<br>
&lt;br&gt;&lt;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/projects/core/documentation/howto/servers.html&quot;&gt;http://twistedmatrix.com/projects/core/documentation/howto/servers.html&lt;/a&gt;&lt;br&gt;&gt;&nbsp;&nbsp;and&nbsp;when&nbsp;you&nbsp;receive&nbsp;a&nbsp;message&nbsp;you&nbsp;would&nbsp;create&nbsp;a&nbsp;client&nbsp;using<br>
&lt;br&gt;reactor.connectTCP(host,&nbsp;port,&nbsp;factory)&nbsp;as&nbsp;detailed&nbsp;here&lt;br&gt;&lt;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/projects/core/documentation/howto/clients.html&quot;&gt;http://twistedmatrix.com/projects/core/documentation/howto/clients.html<br>
&lt;/a&gt;&lt;br&gt;&gt;&nbsp;&nbsp;to&nbsp;then&nbsp;send&nbsp;the&nbsp;message.&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;Christian&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Assuming&nbsp;you&nbsp;want&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;connection&nbsp;every&nbsp;time&nbsp;a&nbsp;client&nbsp;connects&nbsp;to&nbsp;your&nbsp;port&nbsp;9595,&nbsp;it&#39;s&nbsp;slightly&nbsp;tricky&nbsp;because&nbsp;you&nbsp;&nbsp;can&#39;t&nbsp;just&nbsp;forward&nbsp;the&nbsp;data&nbsp;as&nbsp;soon&nbsp;as&nbsp;you&nbsp;get&nbsp;it,&nbsp;since&nbsp;the&nbsp;connection&nbsp;to&nbsp;the&nbsp;other&nbsp;server&nbsp;may&nbsp;not&nbsp;be&nbsp;created&nbsp;yet.&nbsp;&nbsp;A&nbsp;relatively&nbsp;complex&nbsp;way&nbsp;is&nbsp;explained&nbsp;in&nbsp;the&nbsp;Python&nbsp;Cookbook&nbsp;in&nbsp;<br>
&lt;a&nbsp;href=&quot;http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/502293&quot;&gt;article&nbsp;&quot;Hex-dump&nbsp;port-forwarding&nbsp;network&nbsp;proxy&nbsp;server&quot;&lt;/a&gt;,&nbsp;where&nbsp;it&nbsp;queues&nbsp;up&nbsp;the&nbsp;data&nbsp;until&nbsp;the&nbsp;outgoing&nbsp;connection&nbsp;is&nbsp;made.&nbsp;&nbsp;A&nbsp;simpler&nbsp;way&nbsp;is&nbsp;used&nbsp;in&nbsp;<br>
twisted.protocols.portforward.ProxyFactory/ProxyServer,&nbsp;where&nbsp;it&nbsp;just&nbsp;pauses&nbsp;receiving&nbsp;data&nbsp;until&nbsp;the&nbsp;outgoing&nbsp;connection&nbsp;is&nbsp;made.&nbsp;&nbsp;I&nbsp;found&nbsp;a&nbsp;&lt;a&nbsp;href=&quot;http://mail.python.org/pipermail/python-list/2003-June/212102.html&quot;&gt;Python&nbsp;mailing&nbsp;list&nbsp;entry<br>
&lt;/a&gt;&nbsp;which&nbsp;explains&nbsp;how&nbsp;to&nbsp;override&nbsp;the&nbsp;portforward&#39;s&nbsp;methods.&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;Christian&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
