<tt>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;TITLE&gt;Re:&nbsp;[Twisted-Python]&nbsp;Need&nbsp;replacement&nbsp;for&nbsp;subprocess.call&nbsp;within&nbsp;a&nbsp;pyAMF&nbsp;method&nbsp;-&nbsp;any&nbsp;suggestions?&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:14pt'&gt;Hello&nbsp;Jean-Paul&nbsp;;&lt;BR&gt;<br>
&lt;BR&gt;<br>
Thank&nbsp;you&nbsp;very&nbsp;much!&nbsp;For&nbsp;my&nbsp;simply&nbsp;workflow,&nbsp;blocking&nbsp;during&nbsp;a&nbsp;reactor&nbsp;call&nbsp;is&nbsp;acceptable,&nbsp;and&nbsp;simply&nbsp;calling&nbsp;reactor.run&nbsp;with&nbsp;installSignalHandlers=False&nbsp;does&nbsp;allow&nbsp;subprocess.Popen&nbsp;to&nbsp;work.&nbsp;&amp;nbsp;My&nbsp;application&nbsp;is&nbsp;working,&nbsp;and&nbsp;I&nbsp;can&nbsp;continue&nbsp;development&nbsp;&amp;#8211;&nbsp;I&nbsp;was&nbsp;totally&nbsp;blocked&nbsp;until&nbsp;I&nbsp;had&nbsp;this&nbsp;problem&nbsp;solved.&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;have&nbsp;not&nbsp;yet&nbsp;learned&nbsp;how&nbsp;to&nbsp;use&nbsp;inlineCallbacks,&nbsp;&amp;nbsp;and&nbsp;will&nbsp;study&nbsp;up&nbsp;in&nbsp;this,&nbsp;as&nbsp;in&nbsp;the&nbsp;long&nbsp;run,&nbsp;I&nbsp;would&nbsp;like&nbsp;&amp;nbsp;to&nbsp;server&nbsp;&amp;nbsp;side&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;handle&nbsp;multiple&nbsp;calls.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Much&nbsp;appreciated,&lt;BR&gt;<br>
&amp;nbsp;&amp;nbsp;Read&nbsp;Roberts&lt;BR&gt;<br>
&lt;BR&gt;<br>
On&nbsp;11/3/09&nbsp;4:08&nbsp;PM,&nbsp;&amp;quot;&lt;a&nbsp;href=&quot;exarkun@twistedmatrix.com&quot;&gt;exarkun@twistedmatrix.com&lt;/a&gt;&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;exarkun@twistedmatrix.com&quot;&gt;exarkun@twistedmatrix.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;BLOCKQUOTE&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:14pt'&gt;On&nbsp;3&nbsp;Nov,&nbsp;11:55&nbsp;pm,&nbsp;&lt;a&nbsp;href=&quot;rroberts@adobe.com&quot;&gt;rroberts@adobe.com&lt;/a&gt;&nbsp;wrote:&lt;BR&gt;<br>
&amp;gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;use&nbsp;the&nbsp;twisted&nbsp;reactor&nbsp;as&nbsp;a&nbsp;basis&nbsp;for&nbsp;a&nbsp;Python&nbsp;server&lt;BR&gt;<br>
&amp;gt;for&nbsp;a&lt;BR&gt;<br>
&amp;gt;Flex&nbsp;app,&nbsp;using&nbsp;pyAMF.&nbsp;&amp;nbsp;My&nbsp;problem&nbsp;is&nbsp;that&nbsp;one&nbsp;&amp;nbsp;of&nbsp;the&nbsp;server&nbsp;methods&lt;BR&gt;<br>
&amp;gt;requires&nbsp;me&nbsp;to&nbsp;run&nbsp;a&nbsp;series&nbsp;of&nbsp;command-line&nbsp;tools&nbsp;to&nbsp;complete&nbsp;parsing&lt;BR&gt;<br>
&amp;gt;data&lt;BR&gt;<br>
&amp;gt;from&nbsp;a&nbsp;file&nbsp;into&nbsp;an&nbsp;XML&nbsp;object,&nbsp;with&nbsp;lots&nbsp;of&nbsp;Python&nbsp;processing&nbsp;on&nbsp;the&lt;BR&gt;<br>
&amp;gt;results&nbsp;of&nbsp;one&nbsp;command-line&nbsp;tool&nbsp;to&nbsp;provide&nbsp;the&nbsp;input&nbsp;to&nbsp;the&nbsp;next&nbsp;one.&lt;BR&gt;<br>
&amp;gt;I&lt;BR&gt;<br>
&amp;gt;have&nbsp;been&nbsp;using&nbsp;&amp;nbsp;subprocess.call&nbsp;&amp;nbsp;to&nbsp;invoke&nbsp;the&nbsp;command-line&nbsp;tools,&nbsp;but&lt;BR&gt;<br>
&amp;gt;these&nbsp;intermittently&nbsp;-&nbsp;and&nbsp;frequently&nbsp;-&nbsp;&amp;nbsp;fail&nbsp;with&nbsp;an&nbsp;error&nbsp;&amp;quot;IOError:&lt;BR&gt;<br>
&amp;gt;[Errno&lt;BR&gt;<br>
&amp;gt;4]&nbsp;Interrupted&nbsp;system&nbsp;call&amp;quot;.&lt;BR&gt;<br>
&amp;gt;&lt;BR&gt;<br>
&amp;gt;I&nbsp;do&nbsp;know&nbsp;that&nbsp;this&nbsp;was&nbsp;supposed&nbsp;to&nbsp;be&nbsp;fixed&nbsp;in&nbsp;twisted&nbsp;for&nbsp;Python&nbsp;2.6,&lt;BR&gt;<br>
&amp;gt;but&lt;BR&gt;<br>
&amp;gt;it&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;be.&lt;BR&gt;<br>
&lt;BR&gt;<br>
I'm&nbsp;not&nbsp;sure&nbsp;why&nbsp;you&nbsp;know&nbsp;this.&nbsp;&amp;nbsp;I&nbsp;sure&nbsp;would&nbsp;be&nbsp;great&nbsp;if&nbsp;that&nbsp;were&nbsp;the&lt;BR&gt;<br>
case,&nbsp;but&nbsp;it's&nbsp;not.&nbsp;&amp;nbsp;More&nbsp;changes&nbsp;in&nbsp;Twisted&nbsp;are&nbsp;necessary&nbsp;to&nbsp;let&nbsp;things&lt;BR&gt;<br>
like&nbsp;subprocess.call&nbsp;work&nbsp;properly&nbsp;alongside&nbsp;Twisted's&nbsp;process&nbsp;API.&lt;BR&gt;<br>
&amp;gt;I&nbsp;have&nbsp;python&nbsp;2.6.3&nbsp;under&nbsp;Mac&nbsp;OSX&nbsp;10.5.8,&nbsp;and&nbsp;twisted&lt;BR&gt;<br>
&amp;gt;8.2.0.&nbsp;Is&nbsp;there&nbsp;a&nbsp;work-around&nbsp;for&nbsp;this&nbsp;problem,&nbsp;or&nbsp;a&nbsp;better&nbsp;way&nbsp;to&nbsp;do&lt;BR&gt;<br>
&amp;gt;this&lt;BR&gt;<br>
&amp;gt;with&nbsp;twisted?&nbsp;I&nbsp;do&nbsp;know&nbsp;that&nbsp;I&nbsp;can&nbsp;make&nbsp;a&nbsp;command-line&nbsp;call&nbsp;with&lt;BR&gt;<br>
&amp;gt;reactor.callLater,&nbsp;and&nbsp;that&nbsp;I&nbsp;can&nbsp;return&nbsp;a&nbsp;deferred&nbsp;from&nbsp;my&nbsp;server&lt;BR&gt;<br>
&amp;gt;method,&lt;BR&gt;<br>
&amp;gt;but&nbsp;I&nbsp;don't&nbsp;see&nbsp;how&nbsp;to&nbsp;easily&nbsp;accomplish&nbsp;the&nbsp;chain&nbsp;of&nbsp;calls&nbsp;that&nbsp;I&lt;BR&gt;<br>
&amp;gt;need,&lt;BR&gt;<br>
&amp;gt;short&nbsp;of&nbsp;breaking&nbsp;up&nbsp;my&nbsp;serverMethod1&nbsp;into&nbsp;the&nbsp;several&nbsp;sequential&lt;BR&gt;<br>
&amp;gt;parts,&nbsp;and&lt;BR&gt;<br>
&amp;gt;calling&nbsp;each&nbsp;from&nbsp;the&nbsp;result&nbsp;handler&nbsp;of&nbsp;the&nbsp;previous&nbsp;one.&nbsp;I'd&nbsp;rather&lt;BR&gt;<br>
&amp;gt;not&nbsp;go&lt;BR&gt;<br>
&amp;gt;that&nbsp;route,&nbsp;as&nbsp;the&nbsp;logic&nbsp;of&nbsp;which&nbsp;command-line&nbsp;call&nbsp;gets&nbsp;made&nbsp;when&nbsp;is&lt;BR&gt;<br>
&amp;gt;actually&nbsp;quite&nbsp;complicated.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Are&nbsp;you&nbsp;aware&nbsp;that&nbsp;this&nbsp;means&nbsp;your&nbsp;server&nbsp;will&nbsp;only&nbsp;be&nbsp;able&nbsp;to&nbsp;handle&lt;BR&gt;<br>
one&nbsp;request&nbsp;at&nbsp;a&nbsp;time?&nbsp;&amp;nbsp;If&nbsp;so&nbsp;and&nbsp;that's&nbsp;what&nbsp;you're&nbsp;shooting&nbsp;for,&nbsp;then&lt;BR&gt;<br>
you&nbsp;can&nbsp;fix&nbsp;this&nbsp;easily,&nbsp;by&nbsp;passing&nbsp;False&nbsp;to&nbsp;reactor.run.&nbsp;&amp;nbsp;This&lt;BR&gt;<br>
disable's&nbsp;Twisted's&nbsp;own&nbsp;process&nbsp;support&nbsp;and&nbsp;lets&nbsp;things&nbsp;like&lt;BR&gt;<br>
subprocess.call&nbsp;work&nbsp;(blockingly,&nbsp;of&nbsp;course).&lt;BR&gt;<br>
&amp;gt;What&nbsp;I&nbsp;have&nbsp;now&nbsp;looks&nbsp;like&nbsp;(enormously&nbsp;simplified):&lt;BR&gt;<br>
&amp;gt;class&nbsp;MyPythonServer:&lt;BR&gt;<br>
&amp;gt;&lt;BR&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;def&nbsp;serverMethod1(self,&nbsp;dummyPost,&nbsp;inputFilePath):&lt;BR&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#&nbsp;Open&nbsp;inputFilePath,&nbsp;do&nbsp;stuff,&nbsp;save&nbsp;results&nbsp;to&nbsp;file2&lt;BR&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;subprocess.call([&amp;quot;command1&amp;quot;,&nbsp;&amp;quot;file2&amp;quot;,&nbsp;&amp;quot;file3&amp;quot;])&lt;BR&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#&nbsp;Open&nbsp;file3,&nbsp;do&nbsp;stuff&nbsp;to&nbsp;the&nbsp;data,&nbsp;save&nbsp;results&nbsp;to&nbsp;file4&lt;BR&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;subprocess.call([&amp;quot;command2&amp;quot;,&nbsp;&amp;quot;file4&amp;quot;,&nbsp;&amp;quot;file5&amp;quot;])&lt;BR&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#&nbsp;Open&nbsp;file5,&nbsp;convert&nbsp;data&nbsp;to&nbsp;a&nbsp;large&nbsp;string&nbsp;containing&nbsp;XML.&lt;BR&gt;<br>
&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return&nbsp;xmlString&lt;BR&gt;<br>
&lt;BR&gt;<br>
Of&nbsp;course,&nbsp;you&nbsp;can&nbsp;still&nbsp;have&nbsp;methods&nbsp;that&nbsp;look&nbsp;like&nbsp;this&nbsp;if&nbsp;you&nbsp;use&lt;BR&gt;<br>
things&nbsp;like&nbsp;inlineCallbacks&nbsp;(which&nbsp;you&nbsp;can,&nbsp;since&nbsp;you&nbsp;said&nbsp;you're&nbsp;using&lt;BR&gt;<br>
Python&nbsp;2.6).&nbsp;&amp;nbsp;That&nbsp;way&nbsp;you&nbsp;preserve&nbsp;the&nbsp;style&nbsp;you&nbsp;seem&nbsp;to&nbsp;prefer&nbsp;and&lt;BR&gt;<br>
avoid&nbsp;blocking&nbsp;your&nbsp;server&nbsp;any&nbsp;time&nbsp;you&nbsp;need&nbsp;to&nbsp;launch&nbsp;a&nbsp;child&nbsp;process.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Jean-Paul&lt;BR&gt;<br>
&lt;BR&gt;<br>
_______________________________________________&lt;BR&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;BR&gt;<br>
&lt;a&nbsp;href=&quot;Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;BR&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/BLOCKQUOTE&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
