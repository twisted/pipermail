<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;color:#000;&nbsp;background-color:#fff;&nbsp;font-family:times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;font-size:12pt&quot;&gt;&lt;div&gt;&lt;span&gt;Maybe&nbsp;I&nbsp;asked&nbsp;the&nbsp;wrong&nbsp;question?&nbsp;&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;use&nbsp;the&nbsp;imap4&nbsp;library&nbsp;from&nbsp;twisted&nbsp;to&nbsp;write&nbsp;an&nbsp;imap4&nbsp;proxy?&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&nbsp;&nbsp;&lt;div&nbsp;style=&quot;font-family:&nbsp;'times&nbsp;new&nbsp;roman',&nbsp;'new&nbsp;york',&nbsp;times,&nbsp;serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&nbsp;&lt;div&nbsp;style=&quot;font-family:&nbsp;'times&nbsp;new&nbsp;roman',&nbsp;'new&nbsp;york',&nbsp;times,&nbsp;serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&nbsp;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&nbsp;&lt;hr&nbsp;size=&quot;1&quot;&gt;&nbsp;&nbsp;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;Arial&quot;&gt;&nbsp;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:bold;&quot;&gt;From:&lt;/span&gt;&lt;/b&gt;&nbsp;Krzysztof&nbsp;Oblucki&nbsp;&lt;koblucki@yahoo.com&gt;&lt;br&gt;&nbsp;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;To:&lt;/span&gt;&lt;/b&gt;&nbsp;&quot;twisted-python@twistedmatrix.com&quot;&nbsp;&lt;twisted-python@twistedmatrix.com&gt;&nbsp;&lt;br&gt;&nbsp;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Sent:&lt;/span&gt;&lt;/b&gt;&nbsp;Monday,&nbsp;November&nbsp;25,&nbsp;2013&nbsp;11:27&nbsp;AM&lt;br&gt;&nbsp;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Subject:&lt;/span&gt;&lt;/b&gt;&nbsp;IMAP4&nbsp;Proxy&nbsp;to&nbsp;add&nbsp;headers&nbsp;and&nbsp;modify&nbsp;body&nbsp;of&nbsp;an&nbsp;incoming<br>
&nbsp;message&lt;br&gt;&nbsp;&lt;/font&gt;&nbsp;&lt;/div&gt;&nbsp;&lt;div&nbsp;class=&quot;y_msg_container&quot;&gt;&lt;br&gt;<br>
&lt;div&nbsp;id=&quot;yiv502660025&quot;&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&nbsp;font-family:&nbsp;'times&nbsp;new&nbsp;roman',&nbsp;'new&nbsp;york',&nbsp;times,&nbsp;serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&lt;div&gt;Hello,&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;write&nbsp;an&nbsp;IMAP&nbsp;proxy&nbsp;to&nbsp;modify&nbsp;headers&nbsp;and&nbsp;the&nbsp;body&nbsp;of&nbsp;an&nbsp;incoming&nbsp;message&nbsp;using&nbsp;twisted.&nbsp;&nbsp;I&nbsp;am&nbsp;new&nbsp;to&nbsp;python&nbsp;and&nbsp;twisted&nbsp;so&nbsp;maybe&nbsp;this&nbsp;is&nbsp;why&nbsp;I&nbsp;either&nbsp;picked&nbsp;the&nbsp;wrong&nbsp;route&nbsp;or&nbsp;don't&nbsp;have&nbsp;the&nbsp;skills&nbsp;to&nbsp;get&nbsp;through&nbsp;some&nbsp;issues&nbsp;and&nbsp;I'm&nbsp;hoping&nbsp;that&nbsp;some&nbsp;you&nbsp;fine&nbsp;list&nbsp;members&nbsp;can&nbsp;point&nbsp;me&nbsp;in&nbsp;the&nbsp;right&nbsp;direction.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;'times&nbsp;new&nbsp;roman',&nbsp;'new&nbsp;york',&nbsp;times,&nbsp;serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;I&nbsp;started&nbsp;by&nbsp;using&nbsp;the&nbsp;IMAP4Client&nbsp;and&nbsp;IMAP4Server&nbsp;to&nbsp;do&nbsp;the&nbsp;proxying.&nbsp;&nbsp;However,&nbsp;I&nbsp;realized&nbsp;that&nbsp;in&nbsp;certain&nbsp;cases,&nbsp;the&nbsp;IMAP4Server&nbsp;requires&nbsp;synchronous&nbsp;results&nbsp;but&nbsp;since&nbsp;I&nbsp;need&nbsp;to&nbsp;do&nbsp;an&nbsp;async&nbsp;call&nbsp;using&nbsp;the&nbsp;client&nbsp;the&nbsp;handling&nbsp;is&nbsp;not&nbsp;working&nbsp;properly.<br>
&nbsp;&nbsp;I&nbsp;ran&nbsp;into&nbsp;this&nbsp;when&nbsp;implementing&nbsp;getFlags()<br>
&nbsp;in&nbsp;the&nbsp;IMessage&nbsp;and&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;how&nbsp;I&nbsp;can&nbsp;get&nbsp;out&nbsp;of&nbsp;this&nbsp;short&nbsp;of&nbsp;changing&nbsp;the&nbsp;IMAP4Server&nbsp;code&nbsp;to&nbsp;handle&nbsp;Deferreds.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;'times&nbsp;new&nbsp;roman',&nbsp;'new&nbsp;york',&nbsp;times,&nbsp;serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;'times&nbsp;new&nbsp;roman',&nbsp;'new&nbsp;york',&nbsp;times,&nbsp;serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;Am&nbsp;I&nbsp;on&nbsp;the&nbsp;right&nbsp;track?&nbsp;&nbsp;Is&nbsp;imap4&nbsp;lib&nbsp;the&nbsp;right&nbsp;tool&nbsp;for&nbsp;this&nbsp;job?&nbsp;&nbsp;If&nbsp;so,&nbsp;is&nbsp;modifying&nbsp;IMAP4Server&nbsp;to&nbsp;handle&nbsp;Deferreds&nbsp;the&nbsp;right&nbsp;thing&nbsp;to&nbsp;do?&nbsp;&nbsp;If&nbsp;not,&nbsp;what&nbsp;would&nbsp;you&nbsp;recommend?&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&nbsp;&lt;/div&gt;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
