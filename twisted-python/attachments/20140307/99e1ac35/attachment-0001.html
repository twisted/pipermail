<tt>
﻿&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&quot;&gt;<br>
&lt;HTML&gt;&lt;HEAD&gt;<br>
&lt;META&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;http-equiv=Content-Type&gt;<br>
&lt;STYLE&gt;<br>
BLOCKQUOTE&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MARGIN-BOTTOM:&nbsp;0px;&nbsp;MARGIN-LEFT:&nbsp;2em;&nbsp;MARGIN-TOP:&nbsp;0px<br>
}<br>
OL&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MARGIN-BOTTOM:&nbsp;0px;&nbsp;MARGIN-TOP:&nbsp;0px<br>
}<br>
UL&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MARGIN-BOTTOM:&nbsp;0px;&nbsp;MARGIN-TOP:&nbsp;0px<br>
}<br>
P&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MARGIN-BOTTOM:&nbsp;0px;&nbsp;MARGIN-TOP:&nbsp;0px<br>
}<br>
BODY&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FONT-SIZE:&nbsp;10.5pt;&nbsp;FONT-FAMILY:&nbsp;微软雅黑;&nbsp;COLOR:&nbsp;#000000;&nbsp;LINE-HEIGHT:&nbsp;1.5<br>
}<br>
&lt;/STYLE&gt;<br>
<br>
&lt;META&nbsp;name=GENERATOR&nbsp;content=&quot;MSHTML&nbsp;11.00.9600.16518&quot;&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;style=&quot;MARGIN:&nbsp;10px&quot;&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Thank&nbsp;you&nbsp;very&nbsp;much.&lt;/DIV&gt;<br>
&lt;DIV&gt;I&nbsp;got&nbsp;it,&nbsp;I&nbsp;changed&nbsp;it&nbsp;to&nbsp;use&nbsp;&nbsp;a&nbsp;defer&nbsp;object,&nbsp;not&nbsp;<br>
deferredlist&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;BORDER-TOP:&nbsp;#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;BORDER-RIGHT:&nbsp;medium&nbsp;none;&nbsp;BORDER-BOTTOM:&nbsp;medium&nbsp;none;&nbsp;PADDING-BOTTOM:&nbsp;0cm;&nbsp;PADDING-TOP:&nbsp;3pt;&nbsp;PADDING-LEFT:&nbsp;0cm;&nbsp;BORDER-LEFT:&nbsp;medium&nbsp;none;&nbsp;PADDING-RIGHT:&nbsp;0cm&quot;&gt;<br>
&lt;DIV&nbsp;<br>
style=&quot;FONT-SIZE:&nbsp;12px;&nbsp;FONT-FAMILY:&nbsp;tahoma;&nbsp;BACKGROUND:&nbsp;#efefef;&nbsp;COLOR:&nbsp;#000000;&nbsp;PADDING-BOTTOM:&nbsp;8px;&nbsp;PADDING-TOP:&nbsp;8px;&nbsp;PADDING-LEFT:&nbsp;8px;&nbsp;PADDING-RIGHT:&nbsp;8px&quot;&gt;<br>
&lt;DIV&gt;&lt;B&gt;From:&lt;/B&gt;&nbsp;&lt;A&nbsp;<br>
href=&quot;mailto:exarkun@twistedmatrix.com&quot;&gt;exarkun&lt;/A&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;B&gt;Date:&lt;/B&gt;&nbsp;2014-03-05&nbsp;23:00&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;B&gt;To:&lt;/B&gt;&nbsp;&lt;A&nbsp;href=&quot;mailto:twisted-python@twistedmatrix.com&quot;&gt;Twisted&nbsp;<br>
general&nbsp;discussion&lt;/A&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;B&gt;Subject:&lt;/B&gt;&nbsp;Re:&nbsp;[Twisted-Python]&nbsp;Using&nbsp;DeferredList,&nbsp;on&nbsp;the&nbsp;remote&nbsp;<br>
method&nbsp;get&nbsp;parameter&nbsp;of&nbsp;None&nbsp;type?&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;On&nbsp;02:35&nbsp;pm,&nbsp;yangyouxiu@gmail.com&nbsp;wrote:&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;When&nbsp;developing&nbsp;server-client&nbsp;software,&nbsp;on&nbsp;the&nbsp;client&nbsp;i&nbsp;call&nbsp;the&nbsp;method&nbsp;<br>
&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;getTrafficDate,&nbsp;but&nbsp;on&nbsp;the&nbsp;server&nbsp;end,&nbsp;i&nbsp;got&nbsp;nio&nbsp;is&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;None(d2=d.addCallback(lambda&nbsp;object:&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;object.callRemote(&quot;getNIOTrafficInfo&quot;,&nbsp;node,&nbsp;nio)))&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;,so,&nbsp;what's&nbsp;the&nbsp;key&nbsp;point?&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;[snip]&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;interface&nbsp;in&nbsp;<br>
interfaces:&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nio=&nbsp;<br>
&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;self.interfacenio_dict[node]['interfaceinfo'][interface]&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;<br>
nio&nbsp;is&nbsp;not&nbsp;None:&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
if&nbsp;'nio_tap'&nbsp;in&nbsp;nio&nbsp;or&nbsp;'NIO_NF_tap'&nbsp;in&nbsp;nio:&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
d=&nbsp;globals.perspective.callRemote('getServerRoot')&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
d2=d.addCallback(&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
lambda&nbsp;object:&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
object.callRemote(&quot;getNIOTrafficInfo&quot;,&nbsp;node,&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;nio))&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;[snip]&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;The&nbsp;value&nbsp;of&nbsp;`nio`&nbsp;varies&nbsp;for&nbsp;each&nbsp;iteration&nbsp;of&nbsp;the&nbsp;loop.&nbsp;&nbsp;The&nbsp;value&nbsp;<br>
of&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;`nio`&nbsp;isn't&nbsp;passed&nbsp;to&nbsp;the&nbsp;getNIOTrafficInfo&nbsp;remote&nbsp;method&nbsp;until&nbsp;the&nbsp;`d`&nbsp;<br>
&lt;/DIV&gt;<br>
&lt;DIV&gt;Deferred&nbsp;fires&nbsp;-&nbsp;this&nbsp;will&nbsp;almost&nbsp;certainly&nbsp;be&nbsp;only&nbsp;after&nbsp;the&nbsp;loop&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;finishes&nbsp;(since&nbsp;it&nbsp;depends&nbsp;on&nbsp;network&nbsp;traffic&nbsp;which&nbsp;will&nbsp;only&nbsp;happen&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;after&nbsp;this&nbsp;method&nbsp;returns).&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;So&nbsp;all&nbsp;of&nbsp;the&nbsp;remote&nbsp;calls&nbsp;will&nbsp;be&nbsp;made&nbsp;with&nbsp;whatever&nbsp;value&nbsp;`nio`&nbsp;has&nbsp;on&nbsp;<br>
&lt;/DIV&gt;<br>
&lt;DIV&gt;the&nbsp;last&nbsp;iteration&nbsp;of&nbsp;the&nbsp;loop.&nbsp;&nbsp;This&nbsp;is&nbsp;just&nbsp;how&nbsp;scopes&nbsp;work&nbsp;in&nbsp;<br>
Python.&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Consider&nbsp;this&nbsp;simplified&nbsp;example:&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&gt;&gt;def&nbsp;foo():&lt;/DIV&gt;<br>
&lt;DIV&gt;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;functions&nbsp;=&nbsp;[]&lt;/DIV&gt;<br>
&lt;DIV&gt;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(3):&lt;/DIV&gt;<br>
&lt;DIV&gt;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
functions.append(lambda:&nbsp;i)&lt;/DIV&gt;<br>
&lt;DIV&gt;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;f&nbsp;in&nbsp;functions:&lt;/DIV&gt;<br>
&lt;DIV&gt;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;f()&lt;/DIV&gt;<br>
&lt;DIV&gt;...&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&gt;&gt;foo()&lt;/DIV&gt;<br>
&lt;DIV&gt;2&lt;/DIV&gt;<br>
&lt;DIV&gt;2&lt;/DIV&gt;<br>
&lt;DIV&gt;2&lt;/DIV&gt;<br>
&lt;DIV&gt;&gt;&gt;&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Jean-Paul&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;_______________________________________________&lt;/DIV&gt;<br>
&lt;DIV&gt;Twisted-Python&nbsp;mailing&nbsp;list&lt;/DIV&gt;<br>
&lt;DIV&gt;Twisted-Python@twistedmatrix.com&lt;/DIV&gt;<br>
&lt;DIV&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
