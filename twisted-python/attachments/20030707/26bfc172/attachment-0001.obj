#!/usr/bin/python

import sys
import pprint

from twisted.names import client
from twisted.internet import reactor

import dns_sd

def printResults(results):
    for r in results:
        pprint.pprint(r)

    reactor.stop()

def printFailure(failure):
    print failure
    reactor.stop()

try:
    service, proto, domain = sys.argv[1:]
except ValueError:
    sys.stderr.write('%s: usage:\n' % sys.argv[0] +
                     '  %s SERVICE PROTO DOMAIN\n' % sys.argv[0])
    sys.exit(1)

d = dns_sd.findServices(service, proto, domain)
d.addCallbacks(printResults, printFailure)

reactor.run()
