<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2015-03-24&nbsp;23:18&nbsp;GMT+01:00&nbsp;Glyph&nbsp;Lefkowitz&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:glyph@twistedmatrix.com&quot;&nbsp;target=&quot;_blank&quot;&gt;glyph@twistedmatrix.com&lt;/a&gt;&gt;&lt;/span&gt;:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;It&nbsp;would&nbsp;be&nbsp;good&nbsp;to&nbsp;look&nbsp;at&nbsp;how&nbsp;many&nbsp;of&nbsp;these&nbsp;numbers&nbsp;are&nbsp;negative.&lt;/div&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Not&nbsp;a&nbsp;single&nbsp;one,&nbsp;running&nbsp;the&nbsp;script&nbsp;for&nbsp;a&nbsp;couple&nbsp;of&nbsp;hours,&nbsp;under&nbsp;any&nbsp;condition&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;div&gt;That&nbsp;seems&nbsp;right. &nbsp;I&nbsp;think&nbsp;there&#39;s&nbsp;a&nbsp;real&nbsp;problem&nbsp;here,&nbsp;since&nbsp;physical&nbsp;clocks&nbsp;do&nbsp;just&nbsp;fail,&nbsp;and&nbsp;sometimes&nbsp;NTP&nbsp;slew&nbsp;has&nbsp;to&nbsp;happen. &nbsp;LoopingCall.withCount&nbsp;has&nbsp;a&nbsp;clear&nbsp;opportunity&nbsp;to&nbsp;notice&nbsp;that&nbsp;time&nbsp;has&nbsp;gone&nbsp;backwards,&nbsp;and&nbsp;can&nbsp;just&nbsp;skip&nbsp;that&nbsp;call. &nbsp;This&nbsp;is&nbsp;assuming&nbsp;that&nbsp;time&nbsp;has&nbsp;gone&nbsp;backwards&nbsp;by&nbsp;a&nbsp;tiny&nbsp;amount&nbsp;for&nbsp;a&nbsp;brief&nbsp;period&nbsp;of&nbsp;time,&nbsp;though,&nbsp;and&nbsp;does&nbsp;not&nbsp;address&nbsp;the&nbsp;more&nbsp;complex&nbsp;issue&nbsp;of&nbsp;&quot;the&nbsp;clock&nbsp;was&nbsp;set&nbsp;some&nbsp;significant&nbsp;distance&nbsp;into&nbsp;the&nbsp;past&quot;. &nbsp;LoopingCall&nbsp;still&nbsp;isn&#39;t&nbsp;going&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;deal&nbsp;with&nbsp;large&nbsp;amounts&nbsp;of&nbsp;clock&nbsp;drift,&nbsp;we&#39;d&nbsp;need&nbsp;a&nbsp;monotonic&nbsp;version&nbsp;for&nbsp;that&nbsp;:).&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;must&nbsp;add&nbsp;that&nbsp;the&nbsp;anomaly&nbsp;doesn&#39;t&nbsp;appear&nbsp;right&nbsp;at&nbsp;the&nbsp;start,&nbsp;but&nbsp;after&nbsp;tens&nbsp;of&nbsp;seconds,&nbsp;mostly&nbsp;when&nbsp;the&nbsp;system&nbsp;is&nbsp;under&nbsp;medium/heavy&nbsp;load.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;div&gt;Even&nbsp;seriously&nbsp;broken&nbsp;clocks&nbsp;don&#39;t&nbsp;go&nbsp;backwards&nbsp;a&nbsp;&lt;i&gt;lot&lt;/i&gt;.&nbsp;;-)&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;can&nbsp;reproduce&nbsp;the&nbsp;anomaly&nbsp;with&nbsp;my&nbsp;previous&nbsp;script&nbsp;on&nbsp;my&nbsp;linux&nbsp;machine&nbsp;with&nbsp;or&nbsp;without&nbsp;ntp&nbsp;(systemd-timesyncd)&nbsp;enabled&nbsp;and&nbsp;on&nbsp;a&nbsp;macbook&nbsp;(with&nbsp;kqreactor).&lt;br&gt;The&nbsp;only&nbsp;difference&nbsp;is&nbsp;that&nbsp;since&nbsp;the&nbsp;mac&nbsp;is&nbsp;beefier&nbsp;than&nbsp;the&nbsp;linux&nbsp;box&nbsp;I&nbsp;need&nbsp;to&nbsp;stress&nbsp;it&nbsp;more&nbsp;to&nbsp;trigger&nbsp;the&nbsp;anomaly&nbsp;(a&nbsp;couple&nbsp;of&nbsp;vms&nbsp;+&nbsp;some&nbsp;heavy&nbsp;apps)&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;the&nbsp;ntp&nbsp;cause&nbsp;can&nbsp;be&nbsp;excluded&nbsp;since&nbsp;the&nbsp;issue&nbsp;is&nbsp;reproducible&nbsp;without&nbsp;it&nbsp;and&nbsp;furthermore&nbsp;because&nbsp;once&nbsp;triggered&nbsp;the&nbsp;anomaly&nbsp;happens&nbsp;too&nbsp;frequently&nbsp;to&nbsp;think&nbsp;the&nbsp;ntpd&nbsp;applies&nbsp;so&nbsp;many&nbsp;(negative)&nbsp;fixes&nbsp;in&nbsp;such&nbsp;short&nbsp;time.&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;it&nbsp;is&nbsp;a&nbsp;log&nbsp;where&nbsp;I&nbsp;print&nbsp;a&nbsp;dot&nbsp;when&nbsp;the&nbsp;calls&nbsp;arg&nbsp;is&nbsp;1,&nbsp;the&nbsp;value&nbsp;if&nbsp;not&nbsp;1,&nbsp;each&nbsp;dot&nbsp;is&nbsp;separated&nbsp;by&nbsp;0.02s&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://gist.github.com/dvinella/73e5e45a04c428f037bf&quot;&gt;https://gist.github.com/dvinella/73e5e45a04c428f037bf&lt;/a&gt;&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;reporting! &nbsp;Can&nbsp;you&nbsp;open&nbsp;a&nbsp;ticket?&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;Sure,&nbsp;I&#39;ll&nbsp;open&nbsp;it!&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
