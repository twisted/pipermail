<tt>
&lt;html&nbsp;xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:m=&quot;http://schemas.microsoft.com/office/2004/12/omml&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br>
<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=Content-Type&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;meta&nbsp;name=Generator&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;12&nbsp;(filtered&nbsp;medium)&quot;&gt;<br>
&lt;style&gt;<br>
&lt;!--<br>
&nbsp;/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
&nbsp;@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
&nbsp;/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
&nbsp;p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0cm;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:11.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:blue;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:purple;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
span.EmailStyle17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal-compose;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:windowtext;}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;}<br>
@page&nbsp;Section1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{size:612.0pt&nbsp;792.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:72.0pt&nbsp;72.0pt&nbsp;72.0pt&nbsp;72.0pt;}<br>
div.Section1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{page:Section1;}<br>
--&gt;<br>
&lt;/style&gt;<br>
&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&nbsp;&lt;o:shapedefaults&nbsp;v:ext=&quot;edit&quot;&nbsp;spidmax=&quot;1026&quot;&nbsp;/&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&nbsp;&lt;o:shapelayout&nbsp;v:ext=&quot;edit&quot;&gt;<br>
&nbsp;&nbsp;&lt;o:idmap&nbsp;v:ext=&quot;edit&quot;&nbsp;data=&quot;1&quot;&nbsp;/&gt;<br>
&nbsp;&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;<br>
&lt;/head&gt;<br>
<br>
&lt;body&nbsp;lang=EN-AU&nbsp;link=blue&nbsp;vlink=purple&gt;<br>
<br>
&lt;div&nbsp;class=Section1&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Hi,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;I&nbsp;have&nbsp;an&nbsp;existing&nbsp;application,&nbsp;written&nbsp;using&nbsp;Ice&nbsp;Middleware<br>
(&lt;a&nbsp;href=&quot;http://www.zeroc.com&quot;&gt;www.zeroc.com&lt;/a&gt;)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;This&nbsp;application&nbsp;is&nbsp;my&nbsp;source&nbsp;of&nbsp;infinite&nbsp;queue&nbsp;(server)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Following&nbsp;is&nbsp;my&nbsp;application&nbsp;(processing&nbsp;client&nbsp;to&nbsp;my<br>
infinite&nbsp;queue&nbsp;server)&nbsp;idea&nbsp;to&nbsp;be&nbsp;implemented&nbsp;using&nbsp;Twisted&nbsp;Framework.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;I&nbsp;can&nbsp;loop&nbsp;through&nbsp;my&nbsp;infinite&nbsp;queue&nbsp;and&nbsp;receive&nbsp;email&nbsp;data<br>
(Using&nbsp;.next()&nbsp;kind&nbsp;of&nbsp;function)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Using&nbsp;this&nbsp;email&nbsp;data&nbsp;object,&nbsp;I&nbsp;need&nbsp;to&nbsp;trigger&nbsp;event&nbsp;to<br>
send&nbsp;email&nbsp;using&nbsp;ESMTPSenderFactory&nbsp;and&nbsp;ESMTPSender.&nbsp;As,&nbsp;later&nbsp;I&nbsp;would&nbsp;be<br>
extending&nbsp;ESMTP*&nbsp;classes&nbsp;to&nbsp;do&nbsp;my&nbsp;little&nbsp;funky&nbsp;stuff.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;What&nbsp;is&nbsp;the&nbsp;best&nbsp;code&nbsp;design&nbsp;I&nbsp;can&nbsp;use&nbsp;to&nbsp;implement&nbsp;this<br>
stuff.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Following&nbsp;is&nbsp;basic&nbsp;algorithm&nbsp;kind&nbsp;of&nbsp;code&nbsp;I&nbsp;am&nbsp;doing&nbsp;right<br>
now,&nbsp;but&nbsp;I&nbsp;feel&nbsp;I&nbsp;am&nbsp;missing&nbsp;something.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;#================&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;#Code&nbsp;Begins&nbsp;Here:&nbsp;&lt;b&gt;.tac&nbsp;file&lt;/b&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;#================&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='text-autospace:none'&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;import&lt;/span&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;StringIO&lt;/span&gt;&lt;span&nbsp;style='font-size:<br>
10.0pt;font-family:&quot;Courier&nbsp;New&quot;'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='text-autospace:none'&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;'&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='text-autospace:none'&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;from&lt;/span&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;twisted.application&nbsp;&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;import&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;service&nbsp;&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='text-autospace:none'&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;'&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='text-autospace:none'&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;from&lt;/span&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;twisted.application&nbsp;&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;import&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;internet&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='text-autospace:none'&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;from&lt;/span&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;twisted.internet&nbsp;&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;import&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;protocol,&nbsp;defer&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='text-autospace:none'&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;from&lt;/span&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;twisted.mail&nbsp;&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;import&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;smtp,<br>
relaymanager&lt;/span&gt;&lt;span&nbsp;style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&nbsp;style='text-autospace:none'&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;from&lt;/span&gt;&lt;span&nbsp;style='font-size:10.0pt;<br>
font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;twisted.internet&nbsp;&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:blue'&gt;import&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;;color:black'&gt;&nbsp;reactor&lt;/span&gt;&lt;span<br>
style='font-size:10.0pt;font-family:&quot;Courier&nbsp;New&quot;'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Def&nbsp;process_queue:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;While&nbsp;True:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Try:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Data<br>
=&nbsp;my_queue.next()&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getMailExchange(&lt;i&gt;'localhost&lt;/i&gt;).addCallback(cbMailExchange,<br>
data)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Except:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Break&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;Reactor.stop()&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;reactor.callLater(0,&nbsp;process_queue)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;application&nbsp;=&nbsp;service.Application(&quot;SMTP&nbsp;Client<br>
Tutorial&quot;)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;class&nbsp;SMTPTutorialClient(smtp.ESMTPClient):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;mailFrom&nbsp;=&nbsp;&quot;test@test.com&quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;mailTo&nbsp;=&nbsp;&quot;receiver@test.com&quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;mailData&nbsp;=&nbsp;'''\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Date:&nbsp;Fri,&nbsp;6&nbsp;Feb&nbsp;2004&nbsp;10:14:39&nbsp;-0800&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;From:&nbsp;Test&nbsp;&lt;test@test.com&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;To:&nbsp;Receiver&nbsp;&lt;receiver@test.com&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Subject:&nbsp;Test&nbsp;Mail!&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Hello,&nbsp;how&nbsp;are&nbsp;you,&nbsp;goodbye.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;'''&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;secret=&quot;&quot;,<br>
identity=&quot;&quot;,&nbsp;data&nbsp;=&nbsp;&quot;&quot;):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
smtp.ESMTPClient.__init__(self,&nbsp;secret=secret,&nbsp;identity=identity)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.secret&nbsp;=<br>
secret&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.identity&nbsp;=<br>
identity&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.data&nbsp;=&nbsp;data&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getMailFrom(self):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=<br>
self.mailFrom&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.mailFrom&nbsp;=<br>
None&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getMailTo(self):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
[self.mailTo]&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getMailData(self):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
StringIO.StringIO(self.mailData+self.data)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;sentMail(self,&nbsp;code,&nbsp;resp,&nbsp;numOk,<br>
addresses,&nbsp;log):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'Sent',<br>
numOk,&nbsp;'messages&#8217;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#reactor.stop()&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;def&nbsp;getMailExchange(host):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cbMX(mxRecord):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;str(mxRecord.name)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
relaymanager.MXCalculator().getMX(host).addCallback(cbMX)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;class&nbsp;SMTPClientFactory(protocol.ClientFactory):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;=&nbsp;SMTPTutorialClient&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;data):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.data&nbsp;=&nbsp;data&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;buildProtocol(self,&nbsp;addr):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
self.protocol(secret=None,&nbsp;identity='example.com',&nbsp;data=self.data)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;def&nbsp;cbMailExchange(exchange,&nbsp;data):&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;smtpClientService&nbsp;=<br>
internet.TCPClient(exchange,&nbsp;2500,&nbsp;SMTPClientFactory(data))&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;<br>
smtpClientService.setServiceParent(application)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&nbsp;&nbsp;&nbsp;&nbsp;#reactor.run()&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;reactor.run()&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;#================&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;#Code&nbsp;Ends&nbsp;Here&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;#================&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;I&nbsp;have&nbsp;couple&nbsp;of&nbsp;&lt;b&gt;#reactor.run()&lt;/b&gt;&nbsp;commented&nbsp;code,&nbsp;I<br>
feel&nbsp;like&nbsp;lost&nbsp;between&nbsp;&lt;b&gt;application&lt;/b&gt;&nbsp;and&nbsp;&lt;b&gt;reactor&lt;/b&gt;&nbsp;based&nbsp;code.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;My&nbsp;understanding&nbsp;is&nbsp;that&nbsp;function&nbsp;&lt;b&gt;process_queue&nbsp;&lt;/b&gt;drives<br>
the&nbsp;control&nbsp;flow&nbsp;of&nbsp;my&nbsp;application.&nbsp;Please&nbsp;correct&nbsp;me.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;What&nbsp;is&nbsp;happening&nbsp;is,&nbsp;when&nbsp;my&nbsp;loop&nbsp;is&nbsp;finished&nbsp;in&nbsp;function&nbsp;&lt;b&gt;process_queue,<br>
&lt;/b&gt;then&nbsp;only&nbsp;actual&nbsp;events&nbsp;of&nbsp;SMTP&nbsp;factory&nbsp;and&nbsp;protocol&nbsp;objects&nbsp;are&nbsp;created.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Therefore,&nbsp;I&nbsp;am&nbsp;not&nbsp;getting&nbsp;event&nbsp;driven&nbsp;code,&nbsp;which&nbsp;is&nbsp;the<br>
beauty&nbsp;of&nbsp;Twisted&nbsp;Framework.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Please&nbsp;advice&nbsp;the&nbsp;best&nbsp;document&nbsp;to&nbsp;look&nbsp;and&nbsp;fix&nbsp;this&nbsp;code.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;Thanks.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=MsoNormal&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;____________________________________&lt;br&gt;<br>
Sury&nbsp;Prakash&nbsp;Soni&lt;br&gt;<br>
Developer&lt;/span&gt;&lt;span&nbsp;style='font-size:12.0pt;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,&quot;serif&quot;;<br>
color:silver'&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;____________________________________&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;b&gt;Next&nbsp;Digital&lt;br&gt;<br>
&lt;/b&gt;Level&nbsp;8,&nbsp;15&nbsp;William&nbsp;St,&nbsp;Melbourne&nbsp;&lt;br&gt;<br>
VIC&nbsp;3000&nbsp;Australia&lt;br&gt;<br>
&lt;/span&gt;&lt;b&gt;&lt;i&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;p&lt;/span&gt;&lt;/i&gt;&lt;/b&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;&nbsp;+61&nbsp;3&nbsp;8612&nbsp;6888&lt;br&gt;<br>
&lt;/span&gt;&lt;b&gt;&lt;i&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;f&lt;/span&gt;&lt;/i&gt;&lt;/b&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;&nbsp;&nbsp;+61&nbsp;3&nbsp;8612&nbsp;6899&lt;br&gt;<br>
&lt;/span&gt;&lt;b&gt;&lt;i&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;m&nbsp;0&lt;/span&gt;&lt;/i&gt;&lt;/b&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;433&nbsp;661&nbsp;327&lt;br&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style='font-size:12.0pt;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,&quot;serif&quot;;<br>
color:silver'&gt;&lt;a&nbsp;href=&quot;mailto:ssoni@nextdigital.com&quot;<br>
title=&quot;mailto:rmarshall@nextdigital.com&#10;mailto:agoldman@nextdigital.com&quot;&gt;&lt;span<br>
style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#0066CC'&gt;ssoni@nextdigital.com&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span<br>
style='font-size:12.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#0066CC'&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style='font-size:12.0pt;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,&quot;serif&quot;;<br>
color:silver'&gt;&lt;a&nbsp;href=&quot;http://www.nextdigital.com/&quot;<br>
title=&quot;http://www.nextdigital.com/&quot;&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:<br>
&quot;Arial&quot;,&quot;sans-serif&quot;;color:#0066CC'&gt;www.nextdigital.com&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span<br>
style='font-size:12.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:silver'&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style='font-size:9.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:silver'&gt;____________________________________&lt;/span&gt;&lt;span<br>
style='font-size:12.0pt;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,&quot;serif&quot;;color:silver'&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style='font-size:7.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;<br>
color:gray'&gt;This&nbsp;email&nbsp;and&nbsp;any&nbsp;attachments&nbsp;are&nbsp;intended&nbsp;only&nbsp;for&nbsp;the&nbsp;use&nbsp;of&nbsp;the<br>
recipient&nbsp;and&nbsp;may&nbsp;be&nbsp;confidential&nbsp;and/or&nbsp;legally&nbsp;privileged.&nbsp;Next&nbsp;Digital&nbsp;Group<br>
Pty&nbsp;Ltd&nbsp;(&quot;Next&nbsp;Digital&quot;)&nbsp;disclaims&nbsp;liability&nbsp;for&nbsp;any&nbsp;errors,<br>
omissions,&nbsp;viruses,&nbsp;loss&nbsp;and/or&nbsp;damage&nbsp;arising&nbsp;from&nbsp;using,&nbsp;opening&nbsp;or<br>
transmitting&nbsp;this&nbsp;email.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient&nbsp;you&nbsp;must&nbsp;not<br>
use,&nbsp;interfere&nbsp;with,&nbsp;disclose,&nbsp;copy&nbsp;or&nbsp;retain&nbsp;this&nbsp;email&nbsp;and&nbsp;you&nbsp;should&nbsp;notify<br>
the&nbsp;sender&nbsp;immediately&nbsp;by&nbsp;return&nbsp;email&nbsp;or&nbsp;by&nbsp;contacting&nbsp;Next&nbsp;Digital&nbsp;by&nbsp;telephone<br>
on&nbsp;+61&nbsp;3&nbsp;8612&nbsp;6888.&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;/div&gt;<br>
<br>
&lt;/body&gt;<br>
<br>
&lt;/html&gt;<br>

</tt>
