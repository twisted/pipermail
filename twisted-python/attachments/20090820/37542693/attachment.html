<tt>
&lt;html&gt;&lt;head&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&lt;!--&nbsp;DIV&nbsp;{margin:0px;}&nbsp;--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:tahoma,new&nbsp;york,times,serif;font-size:12pt&quot;&gt;&lt;div&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&lt;!--DIV&nbsp;{margin:0px;}--&gt;&lt;/style&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;tahoma,new&nbsp;york,times,serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;tahoma,new&nbsp;york,times,serif;&quot;&gt;Hello,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;created&nbsp;a&nbsp;telnet&nbsp;server&nbsp;in&nbsp;python.&lt;br&gt;<br>
&lt;br&gt;<br>
Maybe&nbsp;you&nbsp;wonder&nbsp;why&nbsp;to&nbsp;create&nbsp;a&nbsp;telnet&nbsp;server&nbsp;while&nbsp;Windows&nbsp;has&nbsp;one?<br>
Because&nbsp;the&nbsp;windows&nbsp;telnet&nbsp;server&nbsp;does&nbsp;not&nbsp;allow&nbsp;to&nbsp;interract&nbsp;with&nbsp;the<br>
desktop.&nbsp;If&nbsp;you&nbsp;try&nbsp;to&nbsp;start&nbsp;a&nbsp;GUI&nbsp;app,&nbsp;it&nbsp;will&nbsp;start&nbsp;and&nbsp;run&nbsp;but&nbsp;will<br>
not&nbsp;be&nbsp;displayed&nbsp;on&nbsp;the&nbsp;server&nbsp;desktop.&lt;br&gt;<br>
&lt;br&gt;<br>
My&nbsp;telnet&nbsp;server&nbsp;will&nbsp;allow&nbsp;to&nbsp;start&nbsp;a&nbsp;GUI&nbsp;application&nbsp;interracting&nbsp;with&nbsp;the&nbsp;windows&nbsp;desktop&nbsp;of&nbsp;the&nbsp;server.&lt;br&gt;<br>
Ex.&nbsp;:&nbsp;typing&nbsp;&quot;notepad&quot;&nbsp;in&nbsp;the&nbsp;telnet&nbsp;console&nbsp;will&nbsp;pop&nbsp;up&nbsp;the&nbsp;notepad&nbsp;on&nbsp;the&nbsp;Windows&nbsp;desktop&nbsp;of&nbsp;the&nbsp;server.&lt;br&gt;<br>
&lt;br&gt;<br>
At&nbsp;the&nbsp;time&nbsp;this&nbsp;server&nbsp;works&nbsp;but&nbsp;has&nbsp;no&nbsp;authentication&nbsp;feature&nbsp;implemented.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;would&nbsp;like&nbsp;to&nbsp;implement&nbsp;the&nbsp;authentication&nbsp;using&nbsp;AuthenticatingTelnetProtocol&nbsp;and&nbsp;credential.&lt;br&gt;I&nbsp;found&nbsp;the&nbsp;&quot;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://twistedmatrix.com/projects/core/documentation/examples/cred.py&quot;&gt;cred.py&lt;/a&gt;&quot;&nbsp;example&nbsp;on&nbsp;the&nbsp;twistedmatrix&nbsp;website&nbsp;(in&nbsp;the&nbsp;example&nbsp;section)&nbsp;and&nbsp;looked&nbsp;fine&nbsp;as&nbsp;starting&nbsp;point.&lt;br&gt;&lt;br&gt;I&nbsp;quite&nbsp;well&nbsp;understand&nbsp;this&nbsp;expample.&lt;br&gt;&lt;br&gt;I&nbsp;modified&nbsp;the&nbsp;code&nbsp;as&nbsp;follow&nbsp;but&nbsp;always&nbsp;got&nbsp;the&nbsp;same&nbsp;error&nbsp;message&nbsp;when&nbsp;a&nbsp;connectiion&nbsp;is&nbsp;attempted.&lt;br&gt;I&nbsp;have&nbsp;been&nbsp;trying&nbsp;since&nbsp;two&nbsp;weeks&nbsp;but&nbsp;I&nbsp;cannot&nbsp;get&nbsp;it&nbsp;work.&lt;br&gt;&lt;br&gt;Is&nbsp;there&nbsp;a&nbsp;problem&nbsp;with&nbsp;&quot;AuthenticatingTelnetProtocol&quot;&lt;br&gt;&lt;br&gt;The&nbsp;error&nbsp;message:&lt;br&gt;<br>
************************************************************&lt;br&gt;<br>
D:\workspace\twisted&gt;telnet_cred.py&lt;br&gt;<br>
2009-08-20&nbsp;08:57:11+0200&nbsp;[-]&nbsp;Log&nbsp;opened.&lt;br&gt;<br>
2009-08-20&nbsp;08:57:11+0200&nbsp;[-]&nbsp;__main__.ServerFactory&nbsp;starting&nbsp;on&nbsp;4738&lt;br&gt;<br>
2009-08-20&nbsp;08:57:11+0200&nbsp;[-]&nbsp;Starting&nbsp;factory&nbsp;&lt;__main__.ServerFactory&nbsp;instance&nbsp;at&nbsp;0x00D79C60&gt;&lt;br&gt;<br>
2009-08-20&nbsp;08:57:15+0200&nbsp;[__main__.ServerFactory]&nbsp;DEBUG:&nbsp;buildProtocol&nbsp;-&nbsp;addr&nbsp;IPv4Address(TCP,&nbsp;'127.0.0.1',&nbsp;4978)&lt;br&gt;<br>
2009-08-20&nbsp;08:57:15+0200&nbsp;[__main__.ServerFactory]&nbsp;Unhandled&nbsp;Error&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;&quot;C:\Python25\lib\site-packages\twisted\python\log.py&quot;,&nbsp;line&nbsp;69,&nbsp;in&nbsp;callWithContext&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;context.call({ILogContext:&nbsp;newCtx},&nbsp;func,&nbsp;*args,&nbsp;**kw)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;&quot;C:\Python25\lib\site-packages\twisted\python\context.py&quot;,&nbsp;line&nbsp;59,&nbsp;in&nbsp;callWithContext&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.currentContext().callWithContext(ctx,&nbsp;func,&nbsp;*args,&nbsp;**kw)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;&quot;C:\Python25\lib\site-packages\twisted\python\context.py&quot;,&nbsp;line&nbsp;37,&nbsp;in&nbsp;callWithContext&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;func(*args,**kw)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;&quot;C:\Python25\lib\site-packages\twisted\internet\selectreactor.py&quot;,&nbsp;line&nbsp;146,&nbsp;in&nbsp;_doReadOrWrite&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;why&nbsp;=&nbsp;getattr(selectable,&nbsp;method)()&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---&nbsp;&lt;exception&nbsp;caught&nbsp;here&gt;&nbsp;---&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;&quot;C:\Python25\lib\site-packages\twisted\internet\tcp.py&quot;,&nbsp;line&nbsp;932,&nbsp;in&nbsp;doRead&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;=&nbsp;self.factory.buildProtocol(self._buildAddr(addr))&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;&quot;D:\workspace\twisted\telnet_cred.py&quot;,&nbsp;line&nbsp;130,&nbsp;in&nbsp;buildProtocol&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;protocol.ServerFactory.buildProtocol(self,&nbsp;addr)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;&quot;C:\Python25\lib\site-packages\twisted\internet\protocol.py&quot;,&nbsp;line&nbsp;98,&nbsp;in&nbsp;buildProtocol&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;self.protocol()&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exceptions.TypeError:&nbsp;__init__()&nbsp;takes&nbsp;exactly&nbsp;2&nbsp;arguments&nbsp;(1&nbsp;given)&lt;br&gt;<br>
************************************************************&lt;br&gt;<br>
&lt;br&gt;The&nbsp;modified&nbsp;code:&lt;br&gt;************************************************************&lt;br&gt;&lt;br&gt;#&nbsp;Copyright&nbsp;(c)&nbsp;2001-2004&nbsp;Twisted&nbsp;Matrix&nbsp;Laboratories.&lt;br&gt;#&nbsp;See&nbsp;LICENSE&nbsp;for&nbsp;details.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;import&nbsp;sys&lt;br&gt;from&nbsp;zope.interface&nbsp;import&nbsp;implements,&nbsp;Interface&lt;br&gt;&lt;br&gt;from&nbsp;twisted.protocols&nbsp;import&nbsp;basic&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;protocol&lt;br&gt;from&nbsp;twisted.python&nbsp;import&nbsp;log&lt;br&gt;&lt;br&gt;from&nbsp;twisted.cred&nbsp;import&nbsp;error&lt;br&gt;from&nbsp;twisted.cred&nbsp;import&nbsp;portal&lt;br&gt;from&nbsp;twisted.cred&nbsp;import&nbsp;checkers&lt;br&gt;from&nbsp;twisted.cred&nbsp;import&nbsp;credentials&lt;br&gt;&lt;br&gt;from&nbsp;twisted.conch.telnet&nbsp;import&nbsp;AuthenticatingTelnetProtocol,&nbsp;ITelnetProtocol,&nbsp;TelnetProtocol&lt;br&gt;&lt;br&gt;class&nbsp;IProtocolUser(Interface):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getPrivileges():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Return&nbsp;a&nbsp;list&nbsp;of&nbsp;privileges&nbsp;this&nbsp;user&nbsp;has.&quot;&quot;&quot;&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;logout():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Cleanup&nbsp;per-login&nbsp;resources&nbsp;allocated&nbsp;to&nbsp;this&nbsp;avatar&quot;&quot;&quot;&lt;br&gt;&lt;br&gt;class<br>
&nbsp;AnonymousUser:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;implements(IProtocolUser)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getPrivileges(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[1,&nbsp;2,&nbsp;3]&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;logout(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Cleaning&nbsp;up&nbsp;anonymous&nbsp;user&nbsp;resources&quot;&lt;br&gt;&lt;br&gt;class&nbsp;RegularUser:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;implements(IProtocolUser)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getPrivileges(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[1,&nbsp;2,&nbsp;3,&nbsp;5,&nbsp;6]&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;logout(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Cleaning&nbsp;up&nbsp;regular&nbsp;user&nbsp;resources&quot;&lt;br&gt;&lt;br&gt;class&nbsp;Administrator:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;implements(IProtocolUser)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getPrivileges(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;range(50)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def<br>
&nbsp;logout(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Cleaning&nbsp;up&nbsp;administrator&nbsp;resources&quot;&lt;br&gt;&lt;br&gt;class&nbsp;Protocol(basic.LineReceiver):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;user&nbsp;=&nbsp;None&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;portal&nbsp;=&nbsp;None&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;avatar&nbsp;=&nbsp;None&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;logout&nbsp;=&nbsp;None&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionMade(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Login&nbsp;with&nbsp;USER&nbsp;&lt;name&gt;&nbsp;followed&nbsp;by&nbsp;PASS&nbsp;&lt;password&gt;&nbsp;or&nbsp;ANON&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Check&nbsp;privileges&nbsp;with&nbsp;PRIVS&quot;)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionLost(self,&nbsp;reason):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.logout:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.logout()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.avatar&nbsp;=&nbsp;None&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.logout&nbsp;=<br>
&nbsp;None&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;lineReceived(self,&nbsp;line):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;getattr(self,&nbsp;'cmd_'&nbsp;+&nbsp;line.upper().split()[0])&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;f:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(*line.split()[1:])&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;TypeError:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Wrong&nbsp;number&nbsp;of&nbsp;arguments.&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Server&nbsp;error&nbsp;(probably&nbsp;your&nbsp;fault)&quot;)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cmd_ANON(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if<br>
&nbsp;self.portal:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.portal.login(credentials.Anonymous(),&nbsp;None,&nbsp;IProtocolUser&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).addCallbacks(self._cbLogin,&nbsp;self._ebLogin&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;DENIED&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cmd_USER(self,&nbsp;name):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.user&nbsp;=&nbsp;name&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Alright.&nbsp;&nbsp;Now&nbsp;PASS?&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cmd_PASS(self,&nbsp;password):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;self.user:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;self.sendLine(&quot;USER&nbsp;required&nbsp;before&nbsp;PASS&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.portal:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.portal.login(&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;credentials.UsernamePassword(self.user,&nbsp;password),&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IProtocolUser&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).addCallbacks(self._cbLogin,&nbsp;self._ebLogin&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;DENIED&quot;)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cmd_PRIVS(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;You&nbsp;have&nbsp;the&nbsp;following&nbsp;privileges:&nbsp;&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;&nbsp;&quot;.join(map(str,&nbsp;self.avatar.getPrivileges())))&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_cbLogin(self,&nbsp;(interface,&nbsp;avatar,&nbsp;logout)):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;interface&nbsp;is&nbsp;IProtocolUser&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.avatar&nbsp;=&nbsp;avatar&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.logout&nbsp;=&nbsp;logout&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Login&nbsp;successful.&nbsp;&nbsp;Available&nbsp;commands:&nbsp;PRIVS&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_ebLogin(self,<br>
&nbsp;failure):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failure.trap(error.UnauthorizedLogin)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sendLine(&quot;Login&nbsp;denied!&nbsp;&nbsp;Go&nbsp;away.&quot;)&lt;br&gt;&lt;br&gt;class&nbsp;ServerFactory(protocol.ServerFactory):&lt;br&gt;##&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;=&nbsp;Protocol&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;=&nbsp;AuthenticatingTelnetProtocol&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;portal):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.portal&nbsp;=&nbsp;portal&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;buildProtocol(self,&nbsp;addr):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;DEBUG:&nbsp;buildProtocol&nbsp;-&nbsp;addr&quot;,&nbsp;addr&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;protocol.ServerFactory.buildProtocol(self,&nbsp;addr)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;DEBUG2:&nbsp;buildProtocol&nbsp;-&nbsp;addr&quot;,&nbsp;addr&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.portal&nbsp;=&nbsp;self.portal&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
&nbsp;p&lt;br&gt;&lt;br&gt;class&nbsp;Realm:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;implements(portal.IRealm)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;requestAvatar(self,&nbsp;avatarId,&nbsp;mind,&nbsp;*interfaces):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IProtocolUser&nbsp;in&nbsp;interfaces:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;avatarId&nbsp;==&nbsp;checkers.ANONYMOUS:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;av&nbsp;=&nbsp;AnonymousUser()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;avatarId.isupper():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Capitalized&nbsp;usernames&nbsp;are&nbsp;administrators.&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;av&nbsp;=&nbsp;Administrator()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;av&nbsp;=&nbsp;RegularUser()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IProtocolUser,&nbsp;av,&nbsp;av.logout&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;ITelnetProtocol&nbsp;in&nbsp;interfaces:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;BEGUG:&nbsp;aaaa&quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;avatarId.isupper():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;av&nbsp;=&nbsp;TelnetProtocol()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ITelnetProtocol,&nbsp;av,&nbsp;None&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(&quot;Only&nbsp;IProtocolUser&nbsp;interface&nbsp;is&nbsp;supported&nbsp;by&nbsp;this&nbsp;realm&quot;)&lt;br&gt;&lt;br&gt;def&nbsp;main():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;Realm()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;portal.Portal(r)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;checkers.InMemoryUsernamePasswordDatabaseDontUse()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;c.addUser(&quot;auser&quot;,<br>
&nbsp;&quot;thepass&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;c.addUser(&quot;SECONDUSER&quot;,&nbsp;&quot;secret&quot;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;p.registerChecker(c)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;p.registerChecker(checkers.AllowAnonymousAccess())&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;ServerFactory(p)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;log.startLogging(sys.stdout)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.listenTCP(4738,&nbsp;f)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.run()&lt;br&gt;&lt;br&gt;if&nbsp;__name__&nbsp;==&nbsp;'__main__':&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;main()&lt;br&gt;&lt;br&gt;************************************************************&lt;br&gt;&lt;br&gt;If&nbsp;someone&nbsp;could&nbsp;help&nbsp;me.&lt;br&gt;&lt;br&gt;Philippe&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>
<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>
<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;&lt;/html&gt;
</tt>
