<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;requested&nbsp;during&nbsp;review&nbsp;I&nbsp;am&nbsp;moving&nbsp;this&nbsp;to&nbsp;mailing&nbsp;list&nbsp;for&nbsp;discussions.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;initial&nbsp;ticket&nbsp;is&nbsp;here&nbsp;: &lt;a&nbsp;href=&quot;https://twistedmatrix.com/trac/ticket/6928&quot;&gt;https://twistedmatrix.com/trac/ticket/6928&lt;/a&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-------&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;current&nbsp;Twisted&nbsp;implementation&nbsp;of RFC&nbsp;2616&nbsp;-&nbsp;8.2.3&nbsp;is&nbsp;very&nbsp;simple&nbsp;and&nbsp;Twisted&nbsp;will&nbsp;always&nbsp;reply&nbsp;with&nbsp;continue&nbsp;to&nbsp;Accept:&nbsp;100-continue&nbsp;requests.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;I&nbsp;am&nbsp;working&nbsp;at&nbsp;web&nbsp;application&nbsp;based&nbsp;on&nbsp;Twisted&nbsp;web&nbsp;so&nbsp;I&nbsp;did&nbsp;a&nbsp;quick&nbsp;security&nbsp;check&nbsp;for&nbsp;current&nbsp;twisted&nbsp;web&nbsp;code.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;major&nbsp;problem&nbsp;is&nbsp;that&nbsp;when&nbsp;reading&nbsp;POST&nbsp;data,&nbsp;requests&nbsp;under&nbsp;1M&nbsp;are&nbsp;kept&nbsp;in&nbsp;memory,&nbsp;the&nbsp;other&nbsp;being&nbsp;stored&nbsp;in&nbsp;temporary&nbsp;file...&nbsp;but&nbsp;for&nbsp;form-mulipart&nbsp;request&nbsp;the&nbsp;whole&nbsp;data&nbsp;is&nbsp;loaded&nbsp;again&nbsp;in&nbsp;memory&nbsp;for&nbsp;parsing.&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;Now,&nbsp;if&nbsp;the&nbsp;client&nbsp;initially&nbsp;reports&nbsp;that&nbsp;content&nbsp;is&nbsp;less&nbsp;than&nbsp;1M,&nbsp;but&nbsp;then&nbsp;continue&nbsp;to&nbsp;send&nbsp;more&nbsp;than&nbsp;1M,&nbsp;twisted.web&nbsp;will&nbsp;continue&nbsp;to&nbsp;keep&nbsp;all&nbsp;data&nbsp;in&nbsp;memory.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To&nbsp;address&nbsp;the&nbsp;problem&nbsp;of&nbsp;unwanted&nbsp;big&nbsp;post&nbsp;requests&nbsp;I&nbsp;first&nbsp;start&nbsp;with&nbsp;implementing&nbsp;support&nbsp;for&nbsp;well&nbsp;behaved&nbsp;HTTP/1.1&nbsp;clients.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;current&nbsp;code,&nbsp;Resource&nbsp;objects&nbsp;are&nbsp;called&nbsp;only&nbsp;after&nbsp;whole&nbsp;request&nbsp;data&nbsp;was&nbsp;received&nbsp;and&nbsp;processed&nbsp;so&nbsp;a&nbsp;resource&nbsp;can&nbsp;not&nbsp;decide&nbsp;whether&nbsp;or&nbsp;not&nbsp;it&nbsp;accepts&nbsp;the&nbsp;request,&nbsp;just&nbsp;by&nbsp;looking&nbsp;at&nbsp;headers.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Also&nbsp;the&nbsp;Request&nbsp;object&nbsp;is&nbsp;called&nbsp;after&nbsp;headers&nbsp;are&nbsp;received&nbsp;but&nbsp;with&nbsp;calls&nbsp;like&nbsp;parseCookie&nbsp;or&nbsp;gotLength.&nbsp;So&nbsp;there&nbsp;is&nbsp;no&nbsp;API&nbsp;for&nbsp;Request&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;a&nbsp;request&nbsp;based&nbsp;on&nbsp;headers.&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;--------&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To&nbsp;solve&nbsp;this&nbsp;problem,&nbsp;I&nbsp;add&nbsp;a&nbsp;new&nbsp;`headersReceived`&nbsp;API&nbsp;call&nbsp;on&nbsp;Request&nbsp;and&nbsp;Resource&nbsp;so&nbsp;that&nbsp;Requests&nbsp;and&nbsp;Resources&nbsp;can&nbsp;decided&nbsp;if&nbsp;they&nbsp;want&nbsp;to&nbsp;accept&nbsp;the&nbsp;request.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;The&nbsp;biggest&nbsp;change&nbsp;required&nbsp;to&nbsp;implement&nbsp;this&nbsp;API&nbsp;is&nbsp;that&nbsp;URL&nbsp;traversal&nbsp;can&nbsp;now&nbsp;begin&nbsp;before&nbsp;a&nbsp;resource&nbsp;has&nbsp;received&nbsp;all&nbsp;its&nbsp;content.&lt;/div&gt;&lt;div&gt;If&nbsp;a&nbsp;resource&nbsp;needs&nbsp;full&nbsp;request&nbsp;content&nbsp;before&nbsp;making&nbsp;a&nbsp;traversal&nbsp;decistion,&nbsp;then&nbsp;this&nbsp;API&nbsp;does&nbsp;not&nbsp;work.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;why&nbsp;this&nbsp;is&nbsp;an&nbsp;optional&nbsp;API&nbsp;not&nbsp;enforced&nbsp;on&nbsp;all&nbsp;resources.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;now&nbsp;the&nbsp;ticket&nbsp;only&nbsp;has&nbsp;demo&nbsp;code&nbsp;as&nbsp;I&nbsp;wanted&nbsp;to&nbsp;highlight&nbsp;the&nbsp;API&nbsp;changes.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;already&nbsp;implemented&nbsp;this&nbsp;code&nbsp;in&nbsp;my&nbsp;project&nbsp;and&nbsp;wrote&nbsp;full&nbsp;test&nbsp;for&nbsp;these&nbsp;changes.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;this&nbsp;kind&nbsp;of&nbsp;API&nbsp;is&nbsp;accepted&nbsp;in&nbsp;Twisted&nbsp;I&nbsp;can&nbsp;port&nbsp;the&nbsp;code&nbsp;and&nbsp;tests,&nbsp;otherwise&nbsp;I&nbsp;can&nbsp;try&nbsp;to&nbsp;work&nbsp;on&nbsp;a&nbsp;different&nbsp;implementation.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;Adi&nbsp;Roiban<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
