<tt>
Howdy&nbsp;list,&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;implement&nbsp;a&nbsp;protocol&nbsp;using&nbsp;Twisted&nbsp;which&nbsp;has&nbsp;a&nbsp;&amp;quot;STARTTLS&amp;quot;&nbsp;command&nbsp;to&nbsp;switch&nbsp;the&nbsp;protocol&nbsp;from&nbsp;plain&nbsp;TCP&nbsp;to&nbsp;TCP&nbsp;over&nbsp;TLS.&lt;br&gt;&lt;br&gt;I&amp;#39;ve&nbsp;mostly&nbsp;been&nbsp;going&nbsp;by&nbsp;the&nbsp;way&nbsp;that&nbsp;the&nbsp;imap4.py&nbsp;module&nbsp;seems&nbsp;to&nbsp;do&nbsp;it,&nbsp;but&nbsp;I&nbsp;can&amp;#39;t&nbsp;seem&nbsp;to&nbsp;get&nbsp;a&nbsp;handshake&nbsp;to&nbsp;complete.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;found&nbsp;this&nbsp;page&nbsp;(&nbsp;&lt;a&nbsp;href=&quot;http://wiki.vislab.usyd.edu.au/moin.cgi/SSLCertNotes&quot;&gt;http://wiki.vislab.usyd.edu.au/moin.cgi/SSLCertNotes&lt;/a&gt;&nbsp;)&nbsp;which&nbsp;was&nbsp;helpful,&nbsp;but&nbsp;I&nbsp;don&amp;#39;t&nbsp;want&nbsp;to&nbsp;force&nbsp;client&nbsp;cert&nbsp;authentication.&lt;br&gt;<br>
&lt;br&gt;In&nbsp;order&nbsp;to&nbsp;separate&nbsp;this&nbsp;problem&nbsp;from&nbsp;other&nbsp;issues,&nbsp;I&amp;#39;ve&nbsp;adapted&nbsp;the&nbsp;echo&nbsp;protocol&nbsp;code&nbsp;from&nbsp;above&nbsp;the&nbsp;above&nbsp;page&nbsp;to&nbsp;try&nbsp;and&nbsp;get&nbsp;a&nbsp;simple&nbsp;test&nbsp;case&nbsp;(my&nbsp;code&nbsp;below)&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;recieving&nbsp;the&nbsp;following&nbsp;output&nbsp;and&nbsp;traceback&nbsp;when&nbsp;running&nbsp;the&nbsp;client&nbsp;code&nbsp;(&nbsp;on&nbsp;both&nbsp;Windows&nbsp;and&nbsp;Linux&nbsp;):&lt;br&gt;<br>
&lt;br&gt;using&nbsp;TLSv1:&lt;br&gt;&lt;br&gt;&amp;gt;tls_echoclient.py&lt;br&gt;&lt;br&gt;Sending:&nbsp;Hello,&nbsp;world!&lt;br&gt;receive:&nbsp;ERROR:&nbsp;Must&nbsp;authenticate&lt;br&gt;Sending:&nbsp;STARTTLS&lt;br&gt;receive:&nbsp;READY&lt;br&gt;Sending:&nbsp;Continuing&lt;br&gt;connection&nbsp;lost&nbsp;(protocol)&lt;br&gt;connection&nbsp;lost:&nbsp;[(&amp;#39;SSL&nbsp;routines&amp;#39;,&nbsp;&amp;#39;SSL3_READ_BYTES&amp;#39;,&nbsp;&amp;#39;sslv3&nbsp;alert&nbsp;handshake&nbsp;failure&amp;#39;),&nbsp;(&amp;#39;SSL&nbsp;routines&amp;#39;,&nbsp;&amp;#39;SSL3_READ_BYTES&amp;#39;,&nbsp;&amp;#39;ssl&nbsp;handshake&nbsp;failure&amp;#39;)]&lt;br&gt;<br>
Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):&lt;br&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;C:\Documents&nbsp;and&nbsp;Settings\kevinh\Desktop\mine_id\sandbox\funsize\sslecho\tls_echoclient.py&amp;quot;,&nbsp;line&nbsp;58,&nbsp;in&nbsp;&amp;lt;module&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reactor.run()&lt;br&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;C:\Python25\lib\site-packages\twisted\internet\posixbase.py&amp;quot;,&nbsp;line&nbsp;223,&nbsp;in&nbsp;run&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.mainLoop()&lt;br&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;C:\Python25\lib\site-packages\twisted\internet\posixbase.py&amp;quot;,&nbsp;line&nbsp;234,&nbsp;in&nbsp;mainLoop&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.doIteration(t)&lt;br&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;C:\Python25\lib\site-packages\twisted\internet\selectreactor.py&amp;quot;,&nbsp;line&nbsp;140,&nbsp;in&nbsp;doSelect&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;_logrun(selectable,&nbsp;_drdw,&nbsp;selectable,&nbsp;method,&nbsp;dict)&lt;br&gt;---&nbsp;&amp;lt;exception&nbsp;caught&nbsp;here&amp;gt;&nbsp;---&lt;br&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;C:\Python25\lib\site-packages\twisted\python\log.py&amp;quot;,&nbsp;line&nbsp;51,&nbsp;in&nbsp;callWithLogger&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;callWithContext({&amp;quot;system&amp;quot;:&nbsp;lp},&nbsp;func,&nbsp;*args,&nbsp;**kw)&lt;br&gt;<br>
&amp;lt;&amp;lt;&nbsp;SNIP&nbsp;&amp;gt;&amp;gt;&lt;br&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;C:\Python25\lib\site-packages\twisted\internet\base.py&amp;quot;,&nbsp;line&nbsp;490,&nbsp;in&nbsp;stop&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;quot;Can&amp;#39;t&nbsp;stop&nbsp;reactor&nbsp;that&nbsp;isn&amp;#39;t&nbsp;running.&amp;quot;)&lt;br&gt;twisted.internet.error.ReactorNotRunning:&nbsp;Can&amp;#39;t&nbsp;stop&nbsp;reactor&nbsp;that&nbsp;isn&amp;#39;t&nbsp;running.&lt;br&gt;<br>
&lt;br&gt;What&nbsp;am&nbsp;I&nbsp;doing&nbsp;wrong?&amp;nbsp;&nbsp;Is&nbsp;there&nbsp;a&nbsp;SSL&nbsp;config&nbsp;option&nbsp;I&amp;#39;m&nbsp;setting&nbsp;incorrectly?&amp;nbsp;&nbsp;Do&nbsp;I&nbsp;need&nbsp;to&nbsp;use&nbsp;a&nbsp;different&nbsp;SSL&nbsp;Context?&nbsp;Am&nbsp;I&nbsp;totally&nbsp;off&nbsp;base?&lt;br&gt;&lt;br&gt;Thanks,&nbsp;&lt;br&gt;&lt;br&gt;Kevin&nbsp;Horn&lt;br&gt;&lt;br&gt;=========&nbsp;tls_echoserver.py&lt;br&gt;<br>
&lt;br&gt;#&nbsp;adapted&nbsp;from:&nbsp;&lt;a&nbsp;href=&quot;http://wiki.vislab.usyd.edu.au/moin.cgi/SSLCertNotes&quot;&gt;http://wiki.vislab.usyd.edu.au/moin.cgi/SSLCertNotes&lt;/a&gt;&lt;br&gt;&lt;br&gt;import&nbsp;sys&lt;br&gt;from&nbsp;OpenSSL&nbsp;import&nbsp;SSL&lt;br&gt;from&nbsp;twisted.python&nbsp;import&nbsp;log&lt;br&gt;<br>
from&nbsp;twisted.internet&nbsp;import&nbsp;ssl,&nbsp;reactor&lt;br&gt;from&nbsp;twisted.protocols.basic&nbsp;import&nbsp;LineReceiver&lt;br&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;Factory&lt;br&gt;&lt;br&gt;private_key_file&nbsp;=&nbsp;&amp;quot;privkey_dsa.pem&amp;quot;&lt;br&gt;cert_file_name&nbsp;=&nbsp;&amp;quot;cacert.pem&amp;quot;&lt;br&gt;<br>
sslmethod&nbsp;=&nbsp;ssl.SSL.TLSv1_METHOD&lt;br&gt;#~&nbsp;sslmethod&nbsp;=&nbsp;ssl.SSL.SSLv23_METHOD&lt;br&gt;&lt;br&gt;class&nbsp;Echo(LineReceiver):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;donetls&nbsp;=&nbsp;0&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;sendLine(self,&nbsp;line):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;quot;Sending:&amp;quot;,line&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;LineReceiver.sendLine(self,line)&lt;br&gt;<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;lineReceived(self,&nbsp;line):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;quot;Got:&amp;quot;,line&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;self.donetls:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;quot;Sending&nbsp;OK&amp;quot;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.transport.write(&amp;quot;OK&amp;quot;)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;elif&nbsp;line&nbsp;==&nbsp;&amp;quot;STARTTLS&amp;quot;:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.sendLine(&amp;quot;READY&amp;quot;)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#~&nbsp;self.tlsCtx&nbsp;=&nbsp;CtxFactory()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.tlsCtx&nbsp;=&nbsp;ssl.DefaultOpenSSLContextFactory(private_key_file,&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;cert_file_name,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;sslmethod)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.transport.startTLS(self.tlsCtx)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.donetls&nbsp;=&nbsp;1&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.sendLine(&amp;quot;ERROR:&nbsp;Must&nbsp;authenticate&amp;quot;)&lt;br&gt;<br>
&lt;br&gt;factory&nbsp;=&nbsp;Factory()&lt;br&gt;factory.protocol&nbsp;=&nbsp;Echo&lt;br&gt;reactor.listenTCP(8000,&nbsp;factory)&lt;br&gt;reactor.run()&lt;br&gt;&lt;br&gt;=========&nbsp;tls_echoclient.py&lt;br&gt;&lt;br&gt;#&nbsp;adapted&nbsp;from:&nbsp;&lt;a&nbsp;href=&quot;http://wiki.vislab.usyd.edu.au/moin.cgi/SSLCertNotes&quot;&gt;http://wiki.vislab.usyd.edu.au/moin.cgi/SSLCertNotes&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;from&nbsp;OpenSSL&nbsp;import&nbsp;SSL&lt;br&gt;import&nbsp;sys&lt;br&gt;&lt;br&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;ClientFactory&lt;br&gt;from&nbsp;twisted.protocols.basic&nbsp;import&nbsp;LineReceiver&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;ssl,&nbsp;reactor&lt;br&gt;&lt;br&gt;class&nbsp;EchoClient(LineReceiver):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;end=&amp;quot;Bye-bye!&amp;quot;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;connectionMade(self):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.sendLine(&amp;quot;Hello,&nbsp;world!&amp;quot;)&amp;nbsp;&nbsp;#&nbsp;Signals&nbsp;error&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;connectionLost(self,&nbsp;reason):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;#39;connection&nbsp;lost&nbsp;(protocol)&amp;#39;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reactor.stop()&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;sendLine(self,&nbsp;line):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;quot;Sending:&amp;quot;,line&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;LineReceiver.sendLine(self,line)&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;lineReceived(self,&nbsp;line):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;quot;receive:&amp;quot;,&nbsp;line&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;line&nbsp;==&nbsp;&amp;quot;ERROR:&nbsp;Must&nbsp;authenticate&amp;quot;:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.sendLine(&amp;quot;STARTTLS&amp;quot;)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;elif&nbsp;line&nbsp;==&nbsp;&amp;quot;READY&amp;quot;:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#~&nbsp;self.ctx&nbsp;=&nbsp;CxtFactory()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.ctx&nbsp;=&nbsp;ssl.ClientContextFactory()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.ctx.method&nbsp;=&nbsp;ssl.SSL.TLSv1_METHOD&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#~&nbsp;self.ctx.method&nbsp;=&nbsp;ssl.SSL.SSLv23_METHOD&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.transport.startTLS(self.ctx)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.sendLine(&amp;quot;Continuing&amp;quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.sendLine(&amp;quot;wibble&amp;quot;)&lt;br&gt;&lt;br&gt;class&nbsp;EchoClientFactory(ClientFactory):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;protocol&nbsp;=&nbsp;EchoClient&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;clientConnectionFailed(self,&nbsp;connector,&nbsp;reason):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;#39;connection&nbsp;failed:&amp;#39;,&nbsp;reason.getErrorMessage()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reactor.stop()&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;clientConnectionLost(self,&nbsp;connector,&nbsp;reason):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;#39;connection&nbsp;lost:&amp;#39;,&nbsp;reason.getErrorMessage()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reactor.stop()&lt;br&gt;&lt;br&gt;factory&nbsp;=&nbsp;EchoClientFactory()&lt;br&gt;<br>
reactor.connectTCP(&amp;#39;localhost&amp;#39;,&nbsp;8000,&nbsp;factory)&lt;br&gt;reactor.run()&lt;br&gt;<br>

</tt>
