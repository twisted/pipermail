<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Don't&nbsp;know&nbsp;if&nbsp;this&nbsp;is&nbsp;still&nbsp;state&nbsp;of&nbsp;the&nbsp;art,&nbsp;but&nbsp;I've&nbsp;been&nbsp;using<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;off&nbsp;and&nbsp;on&nbsp;and&nbsp;please&nbsp;don't&nbsp;use&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;checkers.InMemoryUsernamePasswordDatabaseDontUse<br>
<br>
HTH,&nbsp;Werner<br>
<br>
<br>
<br>
<br>
####&nbsp;controlling&nbsp;terminal&nbsp;command&nbsp;line&nbsp;server<br>
#<br>
#on&nbsp;port&nbsp;9999.&nbsp;Connect&nbsp;with<br>
#<br>
#ssh&nbsp;admin@localhost&nbsp;-p&nbsp;9999<br>
#<br>
#accept&nbsp;new&nbsp;keys&nbsp;and&nbsp;start&nbsp;work<br>
#<br>
from&nbsp;twisted.conch&nbsp;import&nbsp;manhole,&nbsp;manhole_ssh<br>
from&nbsp;twisted.conch.ssh&nbsp;import&nbsp;keys,&nbsp;userauth,&nbsp;factory,&nbsp;connection<br>
from&nbsp;twisted.conch.ssh.transport&nbsp;import&nbsp;SSHServerTransport<br>
from&nbsp;twisted.cred&nbsp;import&nbsp;portal,&nbsp;checkers<br>
<br>
&quot;&quot;&quot;<br>
Generate&nbsp;these&nbsp;keys&nbsp;with<br>
<br>
$&nbsp;ckeygen&nbsp;-t&nbsp;rsa&nbsp;-f&nbsp;ssh-keys/ssh_host_rsa_key<br>
$&nbsp;ckeygen&nbsp;-t&nbsp;rsa&nbsp;-f&nbsp;ssh-keys/client_rsa<br>
<br>
ssh_host_rsa_key.pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;file<br>
ssh_host_rsa_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;file<br>
&quot;&quot;&quot;<br>
publicKey&nbsp;=&nbsp;&quot;&quot;&quot;ssh-rsa&nbsp;AAAAB3NzaC1yc2EAAAADAQABAAAAgQCoJSZjqVJdh36RoNvwsTMNlqk8heFV6DxNhhkw3uZ58uyrsnz+7JHGpu56tJAO39WMJPLQfdtyWxCy1P2RRKh65hGznvyt2UaAHdZDMqbNcMlupFPg8P4pCgR+/2M14QSopqysfjgXUJRfR/pD93Ofy0L2N5uEGipTjVAjKwxbzQ==&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:wthie@qubik.local&quot;&gt;wthie@qubik.local&lt;/a&gt;&quot;&quot;&quot;<br>
<br>
privateKey&nbsp;=&nbsp;&quot;&quot;&quot;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
MIICXgIBAAKBgQCoJSZjqVJdh36RoNvwsTMNlqk8heFV6DxNhhkw3uZ58uyrsnz+<br>
7JHGpu56tJAO39WMJPLQfdtyWxCy1P2RRKh65hGznvyt2UaAHdZDMqbNcMlupFPg<br>
8P4pCgR+/2M14QSopqysfjgXUJRfR/pD93Ofy0L2N5uEGipTjVAjKwxbzQIDAQAB<br>
AoGBAKD/8WI8HsGvm2GVxQMSqO+58xIgn0LCu/r/C9/fjo/2Kue8YDM4Ed1EudSE<br>
T+vuJ2updVZtLFKzH6ochy8xrp9wbEPhhQqAl8OEvjFa932mSNqg69403qU57eu1<br>
6j0gqE7Z8pQAyM685RwAv4UujRrT1Vi3EmHu8Rvl7/4MRn+BAkEAwBVzxD7XbEoi<br>
lGCoKSvs2JczVIpOOp8s1FCAvsvbRBKzuqLI9N8J9ljM+SalLecalFqsDMJdx4b5<br>
nfPPoK2wswJBAOAYfrih+3pKznkiW56oVlsTBw20baJpD7D9mRBUkURpu/6zaSLh<br>
7mPP5nxnw+92jOmwXW/9/fqSmOT/wNKLAX8CQHxLZWYP5AZG0qmBAk/iBJkC/kwu<br>
UwDMD44zqZvM/k3GbFbRD4ik6yVlwP1YbHqPmTt2kO6Qt25tgQkcw7YNrtECQQDG<br>
xLNR7Utz03qEc3c0qTe/nIb7HvjHv8yNPsNPetNHDUoUxuoQaLncioF0A04Fzu96<br>
MFcQiQeIBBPduwQ7O9TdAkEAvsQWuNmvVFTg0KQLP2Ity5wHSwoIRWjUq19ciHZu<br>
acFIvir+6kDMWEooqY0uXfKx7UUWJAMCjVJztFoSp/jobw==<br>
-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----&quot;&quot;&quot;<br>
<br>
class&nbsp;ConchSSHFactory(factory.SSHFactory):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;the&nbsp;entry&nbsp;point&nbsp;of&nbsp;our&nbsp;SSH&nbsp;server&nbsp;implementation.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;SSH&nbsp;transport&nbsp;layer&nbsp;is&nbsp;implemented&nbsp;by&nbsp;L{SSHTransport}&nbsp;and&nbsp;is&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;of&nbsp;this&nbsp;factory.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;we&nbsp;configure&nbsp;the&nbsp;server's&nbsp;identity&nbsp;(host&nbsp;keys)&nbsp;and&nbsp;handlers&nbsp;for&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;SSH&nbsp;services:<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;L{connection.SSHConnection}&nbsp;handles&nbsp;requests&nbsp;for&nbsp;the&nbsp;channel&nbsp;multiplexing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;service.<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;L{userauth.SSHUserAuthServer}&nbsp;handlers&nbsp;requests&nbsp;for&nbsp;the&nbsp;user<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authentication&nbsp;service.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;=&nbsp;SSHServerTransport<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;services&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'ssh-userauth':&nbsp;userauth.SSHUserAuthServer,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'ssh-connection':&nbsp;connection.SSHConnection<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;portal):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.portal&nbsp;=&nbsp;portal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.publicKeys&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'ssh-rsa':&nbsp;keys.Key.fromString(data=publicKey)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.privateKeys&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'ssh-rsa':&nbsp;keys.Key.fromString(data=privateKey)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
<br>
def&nbsp;get_manhole_factory(namespace,&nbsp;**passwords):<br>
&nbsp;&nbsp;&nbsp;&nbsp;realm&nbsp;=&nbsp;manhole_ssh.TerminalRealm()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;get_manhole(_):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;manhole.Manhole(namespace)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;realm.chainedProtocolFactory.protocolFactory&nbsp;=&nbsp;get_manhole<br>
&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;portal.Portal(realm)<br>
&nbsp;&nbsp;&nbsp;&nbsp;checker&nbsp;=&nbsp;checkers.InMemoryUsernamePasswordDatabaseDontUse(**passwords)<br>
&nbsp;&nbsp;&nbsp;&nbsp;p.registerChecker(checker)<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ConchSSHFactory(p)<br>
<br>
console&nbsp;=&nbsp;get_manhole_factory(pbRoot.initCommands(),&nbsp;admin='admin')<br>
internet.TCPServer(9999,&nbsp;console,&nbsp;interface='localhost').setServiceParent(application)<br>
<br>
<br>
<br>
<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;For&nbsp;memory&nbsp;debugging&nbsp;I&nbsp;found&nbsp;these&nbsp;few&nbsp;lines&nbsp;helpful&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;exc&nbsp;=&nbsp;[<br>
&nbsp;&nbsp;&quot;function&quot;,<br>
&nbsp;&nbsp;&quot;type&quot;,<br>
&nbsp;&nbsp;&quot;list&quot;,<br>
&nbsp;&nbsp;&quot;dict&quot;,<br>
&nbsp;&nbsp;&quot;tuple&quot;,<br>
&nbsp;&nbsp;&quot;wrapper_descriptor&quot;,<br>
&nbsp;&nbsp;&quot;module&quot;,<br>
&nbsp;&nbsp;&quot;method_descriptor&quot;,<br>
&nbsp;&nbsp;&quot;member_descriptor&quot;,<br>
&nbsp;&nbsp;&quot;instancemethod&quot;,<br>
&nbsp;&nbsp;&quot;builtin_function_or_method&quot;,<br>
&nbsp;&nbsp;&quot;frame&quot;,<br>
&nbsp;&nbsp;&quot;classmethod&quot;,<br>
&nbsp;&nbsp;&quot;classmethod_descriptor&quot;,<br>
&nbsp;&nbsp;&quot;_Environ&quot;,<br>
&nbsp;&nbsp;&quot;MemoryError&quot;,<br>
&nbsp;&nbsp;&quot;_Printer&quot;,<br>
&nbsp;&nbsp;&quot;_Helper&quot;,<br>
&nbsp;&nbsp;&quot;getset_descriptor&quot;,<br>
&nbsp;&nbsp;&quot;weakreaf&quot;<br>
]<br>
<br>
inc&nbsp;=&nbsp;[<br>
]<br>
<br>
prev&nbsp;=&nbsp;{}<br>
<br>
def&nbsp;dumpObjects(delta=True,&nbsp;limit=0,&nbsp;include=inc,&nbsp;exclude=[]):<br>
&nbsp;&nbsp;global&nbsp;prev<br>
&nbsp;&nbsp;if&nbsp;include&nbsp;!=&nbsp;[]&nbsp;and&nbsp;exclude&nbsp;!=&nbsp;[]:<br>
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'cannot&nbsp;use&nbsp;include&nbsp;and&nbsp;exclude&nbsp;at&nbsp;the&nbsp;same&nbsp;time'<br>
&nbsp;&nbsp;&nbsp;&nbsp;return<br>
&nbsp;&nbsp;print&nbsp;'working&nbsp;with:'<br>
&nbsp;&nbsp;print&nbsp;'&nbsp;&nbsp;&nbsp;delta:&nbsp;',&nbsp;delta<br>
&nbsp;&nbsp;print&nbsp;'&nbsp;&nbsp;&nbsp;limit:&nbsp;',&nbsp;limit<br>
&nbsp;&nbsp;print&nbsp;'&nbsp;include:&nbsp;',&nbsp;include<br>
&nbsp;&nbsp;print&nbsp;'&nbsp;exclude:&nbsp;',&nbsp;exclude<br>
&nbsp;&nbsp;objects&nbsp;=&nbsp;{}<br>
&nbsp;&nbsp;gc.collect()<br>
&nbsp;&nbsp;oo&nbsp;=&nbsp;gc.get_objects()<br>
&nbsp;&nbsp;for&nbsp;o&nbsp;in&nbsp;oo:<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;getattr(o,&nbsp;&quot;__class__&quot;,&nbsp;None):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;o.__class__.__name__<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((exclude&nbsp;==&nbsp;[]&nbsp;and&nbsp;include&nbsp;==&nbsp;[])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(exclude&nbsp;!=&nbsp;[]&nbsp;and&nbsp;name&nbsp;not&nbsp;in&nbsp;exclude)&nbsp;or&nbsp;\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(include&nbsp;!=&nbsp;[]&nbsp;and&nbsp;name&nbsp;in&nbsp;include)):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objects[name]&nbsp;=&nbsp;objects.get(name,&nbsp;0)&nbsp;+&nbsp;1<br>
##&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;more:<br>
##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;o<br>
&nbsp;&nbsp;pk&nbsp;=&nbsp;prev.keys()<br>
&nbsp;&nbsp;pk.sort()<br>
&nbsp;&nbsp;names&nbsp;=&nbsp;objects.keys()<br>
&nbsp;&nbsp;names.sort()<br>
&nbsp;&nbsp;for&nbsp;name&nbsp;in&nbsp;names:<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;limit&nbsp;==&nbsp;0&nbsp;or&nbsp;objects[name]&nbsp;&gt;&nbsp;limit:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;prev.has_key(name):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prev[name]&nbsp;=&nbsp;objects[name]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt&nbsp;=&nbsp;objects[name]&nbsp;-&nbsp;prev[name]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;delta&nbsp;or&nbsp;dt&nbsp;!=&nbsp;0:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'%0.6d&nbsp;--&nbsp;%0.6d&nbsp;--&nbsp;'&nbsp;%&nbsp;(dt,&nbsp;objects[name]),&nbsp;&nbsp;name<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prev[name]&nbsp;=&nbsp;objects[name]<br>
<br>
def&nbsp;getObjects(oname):<br>
&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;gets&nbsp;an&nbsp;object&nbsp;list&nbsp;with&nbsp;all&nbsp;the&nbsp;named&nbsp;objects&nbsp;out&nbsp;of&nbsp;the&nbsp;sea&nbsp;of<br>
&nbsp;&nbsp;gc'ed&nbsp;objects<br>
&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;olist&nbsp;=&nbsp;[]<br>
&nbsp;&nbsp;objects&nbsp;=&nbsp;{}<br>
&nbsp;&nbsp;gc.collect()<br>
&nbsp;&nbsp;oo&nbsp;=&nbsp;gc.get_objects()<br>
&nbsp;&nbsp;for&nbsp;o&nbsp;in&nbsp;oo:<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;getattr(o,&nbsp;&quot;__class__&quot;,&nbsp;None):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;o.__class__.__name__<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(name&nbsp;==&nbsp;oname):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;olist.append(o)<br>
&nbsp;&nbsp;return&nbsp;olist<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;4/19/20&nbsp;00:03,&nbsp;salil&nbsp;GK&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;<br>
cite=&quot;mid:CAPACB-z0PMTBno1mX-LDiRNA-FBRv8G_jZ0qxTpF-E4prjfBOg@mail.gmail.com&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-quote-pre&quot;&nbsp;wrap=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;am&nbsp;real&nbsp;need&nbsp;to&nbsp;debug&nbsp;my&nbsp;python&nbsp;application&nbsp;for&nbsp;memory&nbsp;issues.&nbsp;I<br>
found&nbsp;that&nbsp;using&nbsp;twisted.conch.manhole&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;telnet&nbsp;session&nbsp;to<br>
python&nbsp;interpreter&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;do&nbsp;some&nbsp;debugging&nbsp;sessions&nbsp;there.&nbsp;I<br>
am&nbsp;using&nbsp;twisted&nbsp;16.6&nbsp;in&nbsp;my&nbsp;server.&nbsp;Could&nbsp;you&nbsp;some&nbsp;one&nbsp;please&nbsp;give&nbsp;me<br>
some&nbsp;sample&nbsp;program&nbsp;for&nbsp;achieving&nbsp;this.<br>
<br>
Thanks&nbsp;~S<br>
<br>
PS:&nbsp;I&nbsp;have&nbsp;posted&nbsp;this&nbsp;message&nbsp;in&nbsp;stack&nbsp;overflow.&nbsp;Sorry&nbsp;for&nbsp;cross<br>
posting.&nbsp;I&nbsp;have&nbsp;joined&nbsp;this&nbsp;group&nbsp;only&nbsp;today.<br>
<br>
_______________________________________________<br>
Twisted-Python&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
