<tt>
hi,&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;I&nbsp;have&nbsp;to&nbsp;deal&nbsp;with&nbsp;flash&nbsp;players&nbsp;(I&#39;m&nbsp;deeply&nbsp;ashamed&nbsp;for&nbsp;what&nbsp;I&#39;m&nbsp;doing&nbsp;;-),&nbsp;and&nbsp;their&nbsp;somewhat&nbsp;cumberstone&nbsp;constraints.&nbsp;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;The&nbsp;main&nbsp;part&nbsp;of&nbsp;the&nbsp;communication&nbsp;is&nbsp;handled&nbsp;via&nbsp;an&nbsp;tcp&nbsp;socket&nbsp;using&nbsp;the&nbsp;amf&nbsp;protocol.&nbsp;But&nbsp;I&nbsp;have&nbsp;to&nbsp;handle&nbsp;&quot;file&nbsp;uploads&quot;&nbsp;via&nbsp;http&nbsp;POST&nbsp;multipart&nbsp;from&nbsp;client&nbsp;to&nbsp;server&nbsp;and&nbsp;sending&nbsp;it&nbsp;back&nbsp;to&nbsp;the&nbsp;flash&nbsp;player&nbsp;since&nbsp;flash&nbsp;only&nbsp;allows&nbsp;domain&nbsp;specific&nbsp;content&nbsp;-&nbsp;no&nbsp;content&nbsp;from&nbsp;the&nbsp;users&#39;&nbsp;file&nbsp;system.&nbsp;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;So&nbsp;my&nbsp;first&nbsp;attempt&nbsp;to&nbsp;solve&nbsp;this&nbsp;big&nbsp;mess&nbsp;was&nbsp;to&nbsp;create&nbsp;a&nbsp;tac&nbsp;like&nbsp;that:&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;############################################&lt;br&nbsp;/&gt;tac&nbsp;file&lt;br&nbsp;/&gt;############################################&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;import&nbsp;sys,&nbsp;os&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;sys.path.append(os.getcwd())&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;from&nbsp;twisted.application&nbsp;import&nbsp;internet,&nbsp;service&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;#&nbsp;my&nbsp;custom&nbsp;backend&nbsp;factory&nbsp;subclassed&nbsp;from&nbsp;ServerFactory&lt;br&nbsp;/&gt;from&nbsp;socketManager&nbsp;import&nbsp;SocketManager&nbsp;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;from&nbsp;policySocketFactory&nbsp;import&nbsp;PolicySocketFactory&lt;br&nbsp;/&gt;from&nbsp;twisted.web2&nbsp;import&nbsp;server,&nbsp;channel,&nbsp;static&lt;br&nbsp;/&gt;from&nbsp;twisted.application&nbsp;import&nbsp;service,&nbsp;strports&lt;br&nbsp;/&gt;from&nbsp;fileupload&nbsp;import&nbsp;Toplevel&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;application&nbsp;=&nbsp;service.Application(&#39;backend&#39;)&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;#&nbsp;backend&nbsp;service&nbsp;-&nbsp;all&nbsp;client/server&nbsp;communication&nbsp;should&nbsp;go&nbsp;via&nbsp;that&nbsp;sockets&lt;br&nbsp;/&gt;backendService&nbsp;=&nbsp;internet.TCPServer(8600,&nbsp;SocketManager())&lt;br&nbsp;/&gt;backendService.setServiceParent(application)&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;#&nbsp;policy&nbsp;service&lt;br&nbsp;/&gt;socketPolicyService&nbsp;=&nbsp;internet.TCPServer(8601,&nbsp;PolicySocketFactory(&#39;socket-policy.xml&#39;))&lt;br&nbsp;/&gt;socketPolicyService.setServiceParent(application)&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;#&nbsp;http&nbsp;service&lt;br&nbsp;/&gt;site&nbsp;=&nbsp;server.Site(Toplevel())&lt;br&nbsp;/&gt;fileUploadService&nbsp;=&nbsp;strports.service(&#39;tcp:8080&#39;,&nbsp;channel.HTTPFactory(site))&lt;br&nbsp;/&gt;fileUploadService.setServiceParent(application)&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;############################################&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Authentication&nbsp;/Authorization&nbsp;is&nbsp;implemented&nbsp;in&nbsp;the&nbsp;backend&nbsp;service,&nbsp;so&nbsp;I&#39;m&nbsp;searching&nbsp;for&nbsp;a&nbsp;solution&nbsp;to&nbsp;fire&nbsp;some&nbsp;sort&nbsp;of&nbsp;event&nbsp;in&nbsp;the&nbsp;fileUploadService&nbsp;to&nbsp;be&nbsp;handled&nbsp;in&nbsp;the&nbsp;backendService,&nbsp;and&nbsp;to&nbsp;restrict&nbsp;the&nbsp;file&nbsp;upload&nbsp;to&nbsp;already&nbsp;logged&nbsp;in&nbsp;users.&nbsp;I&nbsp;thought&nbsp;about&nbsp;using&nbsp;&quot;inotify&quot;&nbsp;for&nbsp;watching&nbsp;the&nbsp;upload&nbsp;directory,&nbsp;but&nbsp;I&nbsp;would&nbsp;prefer&nbsp;a&nbsp;twisted&nbsp;/pythonic&nbsp;solution.&nbsp;Perhaps&nbsp;someone&nbsp;could&nbsp;give&nbsp;me&nbsp;some&nbsp;advice&nbsp;about&nbsp;what&nbsp;would&nbsp;be&nbsp;a&nbsp;sane&nbsp;way&nbsp;to&nbsp;solve&nbsp;this&nbsp;2&nbsp;problems.&nbsp;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Thank&nbsp;you&nbsp;in&nbsp;advance,&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Stefan&nbsp;K&ouml;gl&lt;br&nbsp;type=&quot;_moz&quot;&nbsp;/&gt;
</tt>
