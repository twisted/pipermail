<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;been&nbsp;submitting&nbsp;many&nbsp;patches&nbsp;to&nbsp;get&nbsp;buildbot&nbsp;working&nbsp;on&nbsp;Python&nbsp;3:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://bit.ly/2jCCMPW&quot;&gt;http://bit.ly/2jCCMPW&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;run&nbsp;into&nbsp;one&nbsp;problem&nbsp;involving&nbsp;inlineCallback,&nbsp;Deferred,&nbsp;and&nbsp;yield&lt;/div&gt;&lt;div&gt;which&nbsp;I&nbsp;am&nbsp;having&nbsp;difficulty&nbsp;solving. &nbsp;Can&nbsp;someone&nbsp;help&nbsp;me?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;do&nbsp;the&nbsp;following&nbsp;inside&nbsp;a&nbsp;Python&nbsp;3&nbsp;virtualenv&nbsp;to&nbsp;set&nbsp;things&nbsp;up:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;git&nbsp;clone&nbsp;&lt;a&nbsp;href=&quot;https://github.com/buildbot/buildbot&quot;&gt;https://github.com/buildbot/buildbot&lt;/a&gt;&nbsp;buildbot_test&lt;/div&gt;&lt;div&gt;cd&nbsp;buildbot_test&lt;/div&gt;&lt;div&gt;pip&nbsp;install&nbsp;-e&nbsp;pkg&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail-s1&quot;&gt;pip&nbsp;install&nbsp;-e&nbsp;worker&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail-s2&quot;&gt;pip&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-s1&quot;&gt;&nbsp;install&nbsp;-e&nbsp;&#39;master[tls,tests]&#39;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail-s1&quot;&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;p&nbsp;class=&quot;gmail-p1&quot;&gt;&lt;span&nbsp;class=&quot;gmail-s1&quot;&gt;trial &lt;/span&gt;buildbot.test.unit.test_process_buildrequestdistributor&lt;/p&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;get&nbsp;this&nbsp;error:&lt;/div&gt;&lt;br&gt;==================================================================&lt;br&gt; &nbsp;File&nbsp;&quot;/Users/crodrigues/buildbot_test/master/buildbot/process/buildrequestdistributor.py&quot;,&nbsp;line&nbsp;93,&nbsp;in&nbsp;&lt;lambda&gt;^M&lt;br&gt; &nbsp; &nbsp;brdicts.sort(key=lambda&nbsp;brd:&nbsp;brd[&#39;submitted_at&#39;])&lt;br&gt;builtins.TypeError:&nbsp;&#39;Deferred&#39;&nbsp;object&nbsp;is&nbsp;not&nbsp;subscriptable&lt;br&gt;&lt;br&gt;buildbot.test.unit.test_process_buildrequestdistributor.TestMaybeStartBuilds.test_slow_db^M&lt;div&gt;==================================================================&lt;/div&gt; &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;code&nbsp;causing&nbsp;this&nbsp;problem&nbsp;is&nbsp;on&nbsp;line&nbsp;93 of&nbsp;master/buildbot/process/buildrequestdistributor.py:&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;br&gt; 78&nbsp; &nbsp; &nbsp;@defer.inlineCallbacks&lt;br&gt; 79&nbsp; &nbsp; &nbsp;def&nbsp;_fetchUnclaimedBrdicts(self):&lt;br&gt; 80&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;Sets&nbsp;up&nbsp;a&nbsp;cache&nbsp;of&nbsp;all&nbsp;the&nbsp;unclaimed&nbsp;brdicts.&nbsp;The&nbsp;cache&nbsp;is&lt;br&gt; 81&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;saved&nbsp;at&nbsp;self.unclaimedBrdicts&nbsp;cache.&nbsp;If&nbsp;the&nbsp;cache&nbsp;already&lt;br&gt; 82&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;exists,&nbsp;this&nbsp;function&nbsp;does&nbsp;nothing.&nbsp;If&nbsp;a&nbsp;refetch&nbsp;is&nbsp;desired,&nbsp;set&lt;br&gt; 83&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;the&nbsp;self.unclaimedBrdicts&nbsp;to&nbsp;None&nbsp;before&nbsp;calling.&quot;&quot;&quot;&lt;br&gt; 84&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;self.unclaimedBrdicts&nbsp;is&nbsp;None:&lt;br&gt; 85&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;TODO:&nbsp;use&nbsp;order&nbsp;of&nbsp;the&nbsp;DATA&nbsp;API&lt;br&gt; 86&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;brdicts&nbsp;=&nbsp;yield&nbsp;self.master.data.get((&#39;builders&#39;,&lt;br&gt; 87&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(yield&nbsp;self.bldr.getBuilderId()),&lt;br&gt; 88&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;buildrequests&#39;),&lt;br&gt; 89&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [resultspec.Filter(&#39;claimed&#39;,&lt;br&gt; 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;eq&#39;,&lt;br&gt; 91&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[False])])&lt;br&gt; 92&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;sort&nbsp;by&nbsp;submitted_at,&nbsp;so&nbsp;the&nbsp;first&nbsp;is&nbsp;the&nbsp;oldest&lt;br&gt; 93&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;brdicts.sort(key=lambda&nbsp;brd:&nbsp;brd[&#39;submitted_at&#39;])&lt;br&gt; 94&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.unclaimedBrdicts&nbsp;=&nbsp;brdicts&lt;br&gt; 95&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;defer.returnValue(self.unclaimedBrdicts)&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;run&nbsp;the&nbsp;test&nbsp;on&nbsp;Python&nbsp;2,&nbsp;I&nbsp;don&#39;t&nbsp;get&nbsp;the&nbsp;error,&nbsp;and&nbsp;on&nbsp;line&nbsp;93,&nbsp;brdicts&nbsp;is&nbsp;a&nbsp;dict.&lt;/div&gt;&lt;div&gt;However,&nbsp;if&nbsp;I&nbsp;run&nbsp;the&nbsp;test&nbsp;on&nbsp;Python&nbsp;3,&nbsp;brdicts&nbsp;is&nbsp;a&nbsp;Deferred,&nbsp;thus&nbsp;the&nbsp;error.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can&nbsp;someone&nbsp;point&nbsp;me&nbsp;in&nbsp;the&nbsp;right&nbsp;direction&nbsp;for&nbsp;solving&nbsp;this&nbsp;problem?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;not&nbsp;so&nbsp;familiar&nbsp;with&nbsp;the&nbsp;differences&nbsp;in&nbsp;generators&nbsp;and&nbsp;Deferreds&nbsp;between&nbsp;Python&nbsp;2&nbsp;and&nbsp;3.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&lt;/div&gt;&lt;div&gt;Craig&lt;/div&gt;&lt;/div&gt;<br>

</tt>
