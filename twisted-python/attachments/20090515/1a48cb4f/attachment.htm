<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2009/5/11&nbsp;Jean-Paul&nbsp;Calderone&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:exarkun@divmod.com&quot;&gt;exarkun@divmod.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
On&nbsp;Mon,&nbsp;11&nbsp;May&nbsp;2009&nbsp;19:49:19&nbsp;+0200,&nbsp;Luigi&nbsp;Conte&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:luigiandcosolutions@gmail.com&quot;&gt;luigiandcosolutions@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;[snip]&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&amp;gt;in&nbsp;my&nbsp;script&nbsp;I&nbsp;have&nbsp;to&nbsp;use&nbsp;connect&nbsp;method&nbsp;and&nbsp;then&nbsp;I&nbsp;have&nbsp;to&nbsp;do&nbsp;some&lt;br&gt;<br>
&amp;gt;operations&nbsp;first&nbsp;of&nbsp;calling&nbsp;the&nbsp;start&nbsp;method&lt;br&gt;<br>
&amp;gt;1)&nbsp;start&nbsp;connection&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; def&nbsp;startConnection(self):&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; d&nbsp;=&nbsp;my_api.connect(self.ctrl_ip,&nbsp;self.ctrl_port,&nbsp;self.user,&lt;br&gt;<br>
&amp;gt;self.pwd)&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; d.addCallback(self.postConnection)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Since&nbsp;you&nbsp;omitted&nbsp;the&nbsp;definition&nbsp;of&nbsp;postConnection,&nbsp;I&nbsp;have&nbsp;no&nbsp;way&nbsp;to&nbsp;know&lt;br&gt;<br>
what&nbsp;this&nbsp;does.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; d.addErrback(twisted.python.log.err)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Regardless,&nbsp;this&nbsp;is&nbsp;the&nbsp;wrong&nbsp;place&nbsp;to&nbsp;insert&nbsp;this&nbsp;errback.&nbsp; You&nbsp;should&nbsp;read&lt;br&gt;<br>
the&nbsp;Deferred&nbsp;documentation&nbsp;to&nbsp;learn&nbsp;what&nbsp;consequence&nbsp;it&nbsp;will&nbsp;have&nbsp;on&nbsp;your&lt;br&gt;<br>
program&amp;#39;s&nbsp;flow.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/projects/core/documentation/howto/defer.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/projects/core/documentation/howto/defer.html&lt;/a&gt;&nbsp;is&lt;br&gt;<br>
probably&nbsp;a&nbsp;good&nbsp;place&nbsp;to&nbsp;start.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; print&nbsp;&amp;quot;Connection&nbsp;added&amp;quot;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;d&lt;br&gt;<br>
&amp;gt;2)&nbsp;operation&nbsp;before&nbsp;starting&nbsp;a&nbsp;virtual&nbsp;machine:&lt;br&gt;<br>
&amp;gt;def&nbsp;newVMCfg(self,&nbsp;new_vms_cfg):&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp;#...&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp;#some&nbsp;operations&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp;#if&nbsp;condition&nbsp;valid&nbsp;I&nbsp;try&nbsp;to&nbsp;start&nbsp;the&nbsp;virtual&nbsp;machine&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;is&nbsp;this&nbsp;the&nbsp;correct&nbsp;way&nbsp;to&nbsp;pass&nbsp;args&nbsp;to&nbsp;the&nbsp;start&lt;br&gt;<br>
&amp;gt;method?&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d&nbsp;=&nbsp;self.d.addCallback(self.startVM,(new_vm,&lt;br&gt;<br>
&amp;gt;self.lnms[i])&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print&nbsp;&amp;quot;started&nbsp;vm&nbsp;%s&amp;quot;%new_vm&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; return&nbsp;d&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;in&nbsp;the&nbsp;main&nbsp;process&nbsp;I&nbsp;call&nbsp;them&nbsp;as:&lt;br&gt;<br>
&amp;gt;d&nbsp;=&nbsp;startConnection()&lt;br&gt;<br>
&amp;gt;d.addCallback(newVMCfg,&nbsp;arg)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Is&nbsp;it&nbsp;correct?&nbsp;Because&nbsp;the&nbsp;process&nbsp;stops&nbsp;at&nbsp;the&nbsp;first&nbsp;method&nbsp;called:&nbsp;I&nbsp;see&lt;br&gt;<br>
&amp;gt;only&nbsp;&amp;quot;connection&nbsp;added&amp;quot;.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;That&nbsp;should&nbsp;indicate&nbsp;to&nbsp;you&nbsp;that&nbsp;something&nbsp;is&nbsp;going&nbsp;wrong&nbsp;after&nbsp;that&nbsp;print&lt;br&gt;<br>
statement&nbsp;is&nbsp;reached.&nbsp; So&nbsp;examine&nbsp;what&nbsp;your&nbsp;program&nbsp;tries&nbsp;to&nbsp;do&nbsp;after&nbsp;that&lt;br&gt;<br>
point.&nbsp; You&nbsp;may&nbsp;want&nbsp;to&nbsp;use&nbsp;a&nbsp;debugger.&nbsp; You&nbsp;may&nbsp;want&nbsp;to&nbsp;try&nbsp;writing&nbsp;some&lt;br&gt;<br>
unit&nbsp;tests.&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
Jean-Paul&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;looked&nbsp;at&nbsp;the&nbsp;documentation&nbsp;and&nbsp;I&nbsp;understood&nbsp;something&nbsp;about&nbsp;defferd&nbsp;and&nbsp;callbacks.&nbsp;I&nbsp;edited&nbsp;my&nbsp;code&nbsp;but&nbsp;it&nbsp;does&nbsp;nothing...&lt;br&gt;<br>
I&amp;#39;m&nbsp;going&nbsp;to&nbsp;explain&nbsp;the&nbsp;scenario&nbsp;and&nbsp;what&nbsp;I&nbsp;want&nbsp;to&nbsp;do:&lt;br&gt;-&nbsp;there&nbsp;is&nbsp;an&nbsp;api&nbsp;that&nbsp;provides&nbsp;some&nbsp;methods&nbsp;(connect,&nbsp;start,&nbsp;disconnect).&lt;br&gt;-&nbsp;all&nbsp;those&nbsp;methods&nbsp;return&nbsp;a&nbsp;deferred&nbsp;object&lt;br&gt;-&nbsp;I&nbsp;have&nbsp;an&nbsp;object&nbsp;that&nbsp;first&nbsp;tries&nbsp;to&nbsp;connect,&nbsp;then&nbsp;reads&nbsp;a&nbsp;file&nbsp;and&nbsp;calls&nbsp;the&nbsp;start&nbsp;method&nbsp;many&nbsp;times&nbsp;in&nbsp;a&nbsp;loop&nbsp;cicle&nbsp;of&nbsp;his&nbsp;method.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;want&nbsp;to&nbsp;use&nbsp;the&nbsp;connect&nbsp;and&nbsp;wait&nbsp;until&nbsp;I&amp;#39;m&nbsp;really&nbsp;connected.&nbsp;How&nbsp;can&nbsp;I&nbsp;do&nbsp;this&nbsp;using&nbsp;the&nbsp;deferred&nbsp;object&nbsp;that&nbsp;the&nbsp;api&nbsp;returns&nbsp;to&nbsp;me?&lt;br&gt;I&nbsp;want&nbsp;to&nbsp;do&nbsp;the&nbsp;same&nbsp;thing&nbsp;each&nbsp;time&nbsp;I&nbsp;call&nbsp;the&nbsp;start&nbsp;method&nbsp;from&nbsp;the&nbsp;api:&nbsp;I&nbsp;want&nbsp;to&nbsp;wait&nbsp;the&nbsp;completing&nbsp;of&nbsp;start&nbsp;operation&nbsp;before&nbsp;doing&nbsp;another&nbsp;start&nbsp;invocation.&lt;br&gt;<br>
&lt;br&gt;so&nbsp;I&nbsp;do:&lt;br&gt;in&nbsp;the&nbsp;main&nbsp;process:&lt;br&gt;   &nbsp;d&nbsp;=&nbsp;gest.connettiCLI_to_CTRL()&lt;br&gt;&lt;br&gt;in&nbsp;gest&nbsp;class&nbsp;I&nbsp;have:&lt;br&gt;   &nbsp;def&nbsp;connettiCLI_to_CTRL(self):&lt;br&gt;       &nbsp;d&nbsp;=&nbsp;api.connect(self.ctrl_ip,&nbsp;self.ctrl_port,&nbsp;self.user,&nbsp;self.pwd)&lt;br&gt;<br>
       &nbsp;d.addCallback(self.cbConnected)&lt;br&gt;       &nbsp;return&nbsp;d&lt;br&gt;&lt;br&gt;   &nbsp;def&nbsp;cbConnected(self,&nbsp;connectResult):&lt;br&gt;       &nbsp;return&nbsp;self.postConnection()&lt;br&gt;&lt;br&gt;   &nbsp;def&nbsp;postConnection(self):&lt;br&gt;       &nbsp;#&nbsp;I&nbsp;do&nbsp;something&nbsp;but&nbsp;I&nbsp;don&amp;#39;t&nbsp;call&nbsp;api&amp;#39;s&nbsp;methods&nbsp;here&lt;br&gt;<br>
       &nbsp;#&nbsp;then&nbsp;I&nbsp;go&nbsp;to&nbsp;the&nbsp;next&nbsp;step&nbsp;returning&nbsp;the&nbsp;next&nbsp;method&lt;br&gt;       &nbsp;return&nbsp;self.interpretaNewVMCfg(self.vms_cfg)&lt;br&gt;&lt;br&gt;   &nbsp;def&nbsp;interpretaNewVMCfg(self,&nbsp;new_vms_cfg):&lt;br&gt;       &nbsp;for&nbsp;i&nbsp;in&nbsp;candidati:&lt;br&gt;           &nbsp;#start&nbsp;operation&nbsp;in&nbsp;loop&lt;br&gt;<br>
           &nbsp;#here&nbsp;I&nbsp;want&nbsp;to&nbsp;control&nbsp;each&nbsp;start&nbsp;operation&lt;br&gt;           &nbsp;d&nbsp;=&nbsp;api.startVM(new_vm,&nbsp;self.lnms[i])&lt;br&gt;       &nbsp;return&nbsp;d&lt;br&gt;&lt;br&gt;thank&nbsp;you&nbsp;so&nbsp;much&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
