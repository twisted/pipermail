<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&lt;pre&gt;On&nbsp;Tue,&nbsp;31&nbsp;Jan&nbsp;2006&nbsp;11:43:02&nbsp;+0000,&nbsp;Rob&nbsp;Mason&nbsp;&lt;&lt;a<br>
&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;rob.mason&nbsp;at&nbsp;ammeon.com&lt;/a&gt;&gt;&nbsp;wrote:<br>
&gt;&gt;&lt;i&gt;Hi&nbsp;,<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;I&nbsp;am&nbsp;using&nbsp;twisted&nbsp;to&nbsp;write&nbsp;a&nbsp;test&nbsp;client&nbsp;to&nbsp;interface&nbsp;with&nbsp;a&nbsp;server&nbsp;running&nbsp;<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;a&nbsp;bespoke&nbsp;protocol.<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;The&nbsp;server&nbsp;expects&nbsp;interactions&nbsp;from&nbsp;the&nbsp;client&nbsp;something&nbsp;like:<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;attach<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendMessage<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendMessage<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;&nbsp;&nbsp;unattach<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;If&nbsp;the&nbsp;server&nbsp;does&nbsp;not&nbsp;receive&nbsp;a&nbsp;specific&nbsp;unattach&nbsp;from&nbsp;the&nbsp;client&nbsp;,&nbsp;it&nbsp;will&nbsp;<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;maintain&nbsp;a&nbsp;resource&nbsp;open&nbsp;for&nbsp;the&nbsp;client&nbsp;even&nbsp;though&nbsp;there&nbsp;is&nbsp;no&nbsp;connection.<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;Eventually&nbsp;the&nbsp;server&nbsp;will&nbsp;refuse&nbsp;additional&nbsp;connections&nbsp;(once&nbsp;it's&nbsp;number&nbsp;<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;of&nbsp;'open'&nbsp;connections&nbsp;exceeds&nbsp;some&nbsp;limit).<br>
&lt;/i&gt;<br>
&gt;&nbsp;&nbsp;Is&nbsp;it&nbsp;intentional&nbsp;that&nbsp;resource&nbsp;allocation&nbsp;is&nbsp;independent&nbsp;of&nbsp;actual&nbsp;TCP&nbsp;connections?&nbsp;&nbsp;If&nbsp;not,&nbsp;perhaps&nbsp;you&nbsp;just&nbsp;want&nbsp;to&nbsp;clean&nbsp;things&nbsp;up&nbsp;when&nbsp;a&nbsp;connection&nbsp;is&nbsp;lost.&nbsp;&nbsp;You&nbsp;may&nbsp;also&nbsp;want&nbsp;to&nbsp;use&nbsp;a&nbsp;TCP&nbsp;or&nbsp;app-level&nbsp;keep&nbsp;alive&nbsp;so&nbsp;as&nbsp;to&nbsp;notice&nbsp;connections&nbsp;lost&nbsp;due&nbsp;to&nbsp;network&nbsp;problems.<br>
<br>
It&nbsp;is&nbsp;intentional&nbsp;in&nbsp;the&nbsp;design&nbsp;of&nbsp;the&nbsp;server&nbsp;protocol,&nbsp;and&nbsp;the&nbsp;protocol&nbsp;supports&nbsp;a&nbsp;keep&nbsp;alive&nbsp;PDU!<br>
<br>
&gt;&gt;&lt;i&gt;<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;I&nbsp;want&nbsp;my&nbsp;client&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;send&nbsp;an&nbsp;'unattach'&nbsp;message&nbsp;before&nbsp;closing.<br>
&lt;/i&gt;&gt;&gt;&lt;i&gt;<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;I&nbsp;can&nbsp;override&nbsp;the&nbsp;default&nbsp;reactor&nbsp;behaviour&nbsp;in&nbsp;handling&nbsp;e.g.&nbsp;<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;SIGINT&nbsp;so&nbsp;that&nbsp;I&nbsp;can&nbsp;force&nbsp;my&nbsp;client&nbsp;to&nbsp;send&nbsp;the&nbsp;unattach&nbsp;message&nbsp;before&nbsp;<br>
&lt;/i&gt;&gt;&lt;i&gt;&gt;proceeding&nbsp;with&nbsp;normal&nbsp;reactor&nbsp;sigint&nbsp;handling?<br>
&lt;/i&gt;<br>
&gt;You&nbsp;don't&nbsp;actually&nbsp;care&nbsp;about&nbsp;SIGINT,&nbsp;just&nbsp;shutdown.&nbsp;&nbsp;The&nbsp;lowest&nbsp;level&nbsp;hook&nbsp;available&nbsp;for&nbsp;this&nbsp;is&nbsp;the&nbsp;shutdown&nbsp;system&nbsp;event,&nbsp;which&nbsp;can&nbsp;receive&nbsp;notification&nbsp;of&nbsp;via:<br>
<br>
&gt;&nbsp;&nbsp;&nbsp;reactor.addSystemEventTrigger('before',&nbsp;'shutdown',&nbsp;f)<br>
<br>
&gt;Twisted&nbsp;includes&nbsp;a&nbsp;service&nbsp;system&nbsp;which&nbsp;takes&nbsp;advantage&nbsp;of&nbsp;this&nbsp;feature,&nbsp;which&nbsp;you&nbsp;may&nbsp;want&nbsp;to&nbsp;use&nbsp;instead.&nbsp;&nbsp;See&nbsp;&lt;&lt;a<br>
&nbsp;href=&quot;http://twistedmatrix.com/projects/core/documentation/howto/application.html&quot;&gt;http://twistedmatrix.com/projects/core/documentation/howto/application.html&lt;/a&gt;&gt;,&nbsp;which&nbsp;mostly&nbsp;talks&nbsp;about&nbsp;servers,&nbsp;but&nbsp;clients&nbsp;are&nbsp;approximately&nbsp;the&nbsp;same.<br>
<br>
Thanks&nbsp;,&nbsp;I&nbsp;will&nbsp;try&nbsp;this.<br>
<br>
&gt;Jean-Paul&lt;/pre&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>
<br>
<br>

</tt>
