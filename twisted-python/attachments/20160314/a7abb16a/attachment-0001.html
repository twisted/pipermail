<tt>
&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;微软雅黑;&nbsp;font-size:&nbsp;10.5pt;&quot;&nbsp;spellcheck=&quot;false&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
Thanks&nbsp;for&nbsp;sucn&nbsp;a&nbsp;detailed&nbsp;explanation&nbsp;and&nbsp;sample&nbsp;codes!&nbsp;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Your&nbsp;code&nbsp;demonstrated&nbsp;header-based&nbsp;authentication,&nbsp;&nbsp;I've&nbsp;read&nbsp;some&nbsp;codes&nbsp;similar&nbsp;to&nbsp;this,&nbsp;but&nbsp;still&nbsp;got&nbsp;no&nbsp;idea&nbsp;about&nbsp;how&nbsp;to&nbsp;implement&nbsp;the&nbsp;form-based&nbsp;authentication&nbsp;with&nbsp;twisted.cred&nbsp;credentials&nbsp;and&nbsp;portal.&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;suggesstion&nbsp;for&nbsp;form-based&nbsp;authentication?&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards&lt;/div&gt;&lt;div&gt;Wang&nbsp;Yan&lt;br&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;hr&nbsp;class=&quot;-eMc-email-sig&quot;&nbsp;style=&quot;width:&nbsp;101px;border:&nbsp;0;border-top:&nbsp;1px&nbsp;solid&nbsp;#ccc;&quot;&nbsp;align=&quot;left&quot;&gt;<br>
&lt;div&nbsp;class=&quot;yomail-sig&quot;&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;&lt;div&nbsp;class=&quot;yomail-sig&quot;&nbsp;style=&quot;padding:0;margin:0;&quot;&gt;&lt;a&nbsp;href=&quot;http://www.yomail.com/?utm_source=signature&quot;&nbsp;style=&quot;font-size:10.5pt;font-family:微软雅黑;&quot;&gt;Sent&nbsp;from&nbsp;YoMail&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left-width:&nbsp;1px;&nbsp;border-left-color:&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;border-left-style:&nbsp;solid;&nbsp;padding-left:&nbsp;1ex;&nbsp;display:&nbsp;block;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;href=&quot;mailto:mashiat.sarker@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Mashiat&nbsp;Sarker&nbsp;Shakkhar&lt;/a&gt;&gt;&nbsp;2016-03-06&nbsp;11:11:26&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left-width:&nbsp;1px;&nbsp;border-left-color:&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;border-left-style:&nbsp;solid;&nbsp;padding-left:&nbsp;1ex;&nbsp;display:&nbsp;block;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;On&nbsp;3/2/16&nbsp;9:32&nbsp;AM,&nbsp;snailcoder&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;cite=&quot;mid:56d6fa13.45cfca0a.84bbe.62e7SMTPIN_ADDED_BROKEN@mx.google.com&quot;&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;微软雅黑;&nbsp;font-size:&nbsp;10.5pt;&quot;&nbsp;spellcheck=&quot;false&quot;&gt;I'm&nbsp;trying&nbsp;to&nbsp;implement&nbsp;some&nbsp;login&nbsp;logic&nbsp;using&nbsp;twisted.cred&nbsp;module&nbsp;for&nbsp;a&nbsp;website.&nbsp;In&nbsp;short,&nbsp;there's&nbsp;a&nbsp;login&nbsp;page&nbsp;with&nbsp;username/password&nbsp;forms.&nbsp;Once&nbsp;the&nbsp;user&nbsp;input&nbsp;the&nbsp;right&nbsp;username/password,&nbsp;the&nbsp;browser&nbsp;will&nbsp;redirect&nbsp;to&nbsp;another&nbsp;page&nbsp;which&nbsp;includes&nbsp;the&nbsp;user's&nbsp;profile.&nbsp;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Does&nbsp;anyone&nbsp;have&nbsp;any&nbsp;ideas&nbsp;about&nbsp;how&nbsp;to&nbsp;implement&nbsp;this&nbsp;logic&nbsp;with&nbsp;twisted.cred&nbsp;checkers,&nbsp;credentials&nbsp;and&nbsp;portal?&nbsp;Any&nbsp;suggestion&nbsp;is&nbsp;appreciated&nbsp;:-)&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&gt;Hi&lt;br&gt;&lt;br&gt;Before&nbsp;I&nbsp;answer&nbsp;your&nbsp;question,&nbsp;allow&nbsp;me&nbsp;to&nbsp;give&nbsp;you&nbsp;a&nbsp;word&nbsp;of&nbsp;advice.&nbsp;Twisted&nbsp;is&nbsp;a&nbsp;low-level&nbsp;library.&nbsp;While&nbsp;you&nbsp;can&nbsp;build&nbsp;a&nbsp;web&nbsp;application&nbsp;directly&nbsp;on&nbsp;top&nbsp;of&nbsp;Twisted,&nbsp;I&nbsp;would&nbsp;not&nbsp;recommend&nbsp;it.&nbsp;You&nbsp;need&nbsp;higher-level&nbsp;abstractions&nbsp;to&nbsp;write&nbsp;manageable&nbsp;code.&nbsp;I&nbsp;recommend&nbsp;that&nbsp;you&nbsp;find&nbsp;a&nbsp;framework&nbsp;that&nbsp;builds&nbsp;on&nbsp;top&nbsp;of&nbsp;Twisted.&lt;br&gt;&lt;br&gt;As&nbsp;for&nbsp;your&nbsp;question,&nbsp;you&nbsp;will&nbsp;find&nbsp;many&nbsp;examples&nbsp;of&nbsp;Twisted&nbsp;authentication&nbsp;if&nbsp;you&nbsp;Google&nbsp;a&nbsp;bit.&nbsp;You&nbsp;should&nbsp;probably&nbsp;start&nbsp;by&nbsp;reading&nbsp;this&nbsp;page:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://twistedmatrix.com/documents/current/core/howto/cred.html&quot;&gt;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/documents/current/core/howto/cred.html&quot;&gt;https://twistedmatrix.com/documents/current/core/howto/cred.html&lt;/a&gt;&lt;/a&gt;.&nbsp;Below&nbsp;you&nbsp;will&nbsp;find&nbsp;a&nbsp;simple&nbsp;(and&nbsp;not&nbsp;very&nbsp;secure)&nbsp;example.&nbsp;It&nbsp;uses&nbsp;HTTP&nbsp;Basic&nbsp;authentication.&nbsp;It&nbsp;owes&nbsp;its&nbsp;verbosity&nbsp;to&nbsp;the&nbsp;low-level&nbsp;nature&nbsp;of&nbsp;Twisted.&lt;br&gt;&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;twisted.cred&nbsp;import&nbsp;portal,&nbsp;checkers,&nbsp;credentials,&nbsp;error&nbsp;as&nbsp;credError&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;defer,&nbsp;reactor&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;twisted.web&nbsp;import&nbsp;guard,&nbsp;http,&nbsp;resource,&nbsp;server&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zope.interface&nbsp;import&nbsp;implements&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;HttpPasswordRealm(object):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;implements(portal.IRealm)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;resource):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.resource&nbsp;=&nbsp;resource&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;requestAvatar(self,&nbsp;avatarId,&nbsp;mind,&nbsp;*interfaces):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;resource.IResource&nbsp;in&nbsp;interfaces:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(resource.IResource,&nbsp;self.resource,&nbsp;lambda:&nbsp;None)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError()&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;MyPasswordChecker(object):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;implements(checkers.ICredentialsChecker)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;credentialInterfaces&nbsp;=&nbsp;(credentials.IUsernamePassword,&nbsp;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MY_INSECURE_CREDS&nbsp;=&nbsp;{'name':&nbsp;'pa$$w0rd'}&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@defer.inlineCallbacks&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;requestAvatarId(self,&nbsp;creds):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pw&nbsp;=&nbsp;self.MY_INSECURE_CREDS.get(creds.username)&nbsp;or&nbsp;b''&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pw_match&nbsp;=&nbsp;yield&nbsp;creds.checkPassword(pw)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pw_match&nbsp;is&nbsp;True:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defer.returnValue(creds.username)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;credError.UnauthorizedLogin('Incorrect&nbsp;username&nbsp;or&nbsp;password')&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;MyPortal(resource.Resource):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isLeaf&nbsp;=&nbsp;True&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;render_GET(self,&nbsp;request):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'Top&nbsp;secret&nbsp;content'&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;checker&nbsp;=&nbsp;MyPasswordChecker()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;realm&nbsp;=&nbsp;HttpPasswordRealm(MyPortal())&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;portal.Portal(realm,&nbsp;[checker,&nbsp;])&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;factory&nbsp;=&nbsp;guard.BasicCredentialFactory('My&nbsp;secret&nbsp;portal')&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;protected_resource&nbsp;=&nbsp;guard.HTTPAuthSessionWrapper(p,&nbsp;[factory,&nbsp;])&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;site&nbsp;=&nbsp;server.Site(protected_resource)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;site.protocol&nbsp;=&nbsp;http.HTTPChannel&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.listenTCP(8080,&nbsp;site)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;reactor.run()&lt;br&gt;&lt;br&gt;&lt;br&gt;Do&nbsp;not&nbsp;go&nbsp;and&nbsp;copy-paste&nbsp;the&nbsp;above.&nbsp;Please&nbsp;do&nbsp;your&nbsp;research.&nbsp;To&nbsp;build&nbsp;the&nbsp;interaction&nbsp;you&nbsp;described,&nbsp;I&nbsp;will&nbsp;recommend&nbsp;using&nbsp;Klein&nbsp;(&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://github.com/twisted/klein&quot;&gt;&lt;a&nbsp;href=&quot;https://github.com/twisted/klein&quot;&gt;https://github.com/twisted/klein&lt;/a&gt;&lt;/a&gt;).&nbsp;Klein&nbsp;can&nbsp;give&nbsp;you&nbsp;your&nbsp;entire&nbsp;app&nbsp;as&nbsp;a&nbsp;Resource&nbsp;instance.&nbsp;This&nbsp;example&nbsp;does&nbsp;not&nbsp;manage&nbsp;sessions&nbsp;or&nbsp;lets&nbsp;you&nbsp;log&nbsp;out.&nbsp;It&nbsp;only&nbsp;describes&nbsp;how&nbsp;you&nbsp;can&nbsp;protect&nbsp;a&nbsp;Resource&nbsp;using&nbsp;Twisted.cred.&nbsp;Good&nbsp;luck.&lt;br&gt;&lt;br&gt;Regards&lt;br&gt;Shakkhar&lt;br&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;
</tt>
