<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Hi&nbsp;Exarkun,&lt;br&gt;<br>
&lt;br&gt;<br>
Ah,&nbsp;that&nbsp;should&nbsp;work&nbsp;correctly&nbsp;and&nbsp;as&nbsp;catered&nbsp;in&nbsp;the&nbsp;framework.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Btw,&nbsp;for&nbsp;imap4.py&nbsp;i&nbsp;have&nbsp;a&nbsp;suggestion&nbsp;to&nbsp;improve&nbsp;&nbsp;the&nbsp;performance&nbsp;in<br>
fetch&nbsp;:&lt;br&gt;<br>
&lt;br&gt;<br>
Fetch&nbsp;can&nbsp;be&nbsp;an&nbsp;expensive&nbsp;operation&nbsp;if&nbsp;the&nbsp;number&nbsp;of&nbsp;messages&nbsp;is&nbsp;a&nbsp;lot,<br>
this&nbsp;can&nbsp;be&nbsp;more&nbsp;&quot;reactor&quot;&nbsp;friendly&nbsp;if&nbsp;we&nbsp;use&nbsp;&quot;fetch&quot;&lt;br&gt;<br>
as&nbsp;a&nbsp;generator.&lt;br&gt;<br>
&lt;br&gt;<br>
def&nbsp;fetch(self,&nbsp;messages,&nbsp;uid):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yield&nbsp;xxxx&lt;br&gt;<br>
&lt;br&gt;<br>
Then&nbsp;imap4.py&nbsp;needs&nbsp;to&nbsp;update&nbsp;the&nbsp;__cbManualSearch&nbsp;to&nbsp;use&nbsp;this&nbsp;instead<br>
of&nbsp;&quot;reactor.callLater(&nbsp;.....result[5:],&nbsp;tag..)&quot;&nbsp;(see&nbsp;attached).&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Marcus.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:exarkun@twistedmatrix.com&quot;&gt;exarkun@twistedmatrix.com&lt;/a&gt;&nbsp;wrote:<br>
&lt;blockquote<br>
&nbsp;cite=&quot;mid:20101017142810.2414.2079664616.divmod.xquotient.500@localhost.localdomain&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;On&nbsp;16&nbsp;Oct,&nbsp;02:02&nbsp;pm,&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:marcus@internetnowasp.net&quot;&gt;marcus@internetnowasp.net&lt;/a&gt;&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hi,<br>
<br>
This&nbsp;might&nbsp;seems&nbsp;like&nbsp;a&nbsp;trivial&nbsp;question&nbsp;or&nbsp;at&nbsp;least&nbsp;i&nbsp;would&nbsp;have<br>
thought&nbsp;so&nbsp;but&nbsp;it&nbsp;has&nbsp;eluded&nbsp;me&nbsp;for&nbsp;some&nbsp;time&nbsp;on&nbsp;how&nbsp;to&nbsp;do&nbsp;this&nbsp;<br>
elegantly.<br>
In&nbsp;twisted&nbsp;mail,&nbsp;since&nbsp;the&nbsp;only&nbsp;part&nbsp;where&nbsp;we&nbsp;instantiate&nbsp;an&nbsp;instance&nbsp;<br>
of<br>
account&nbsp;&nbsp;is&nbsp;under&nbsp;:<br>
<br>
&nbsp;&nbsp;def&nbsp;requestAvatar(self,&nbsp;avatarId,&nbsp;mind,&nbsp;*interfaces):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;account&nbsp;=&nbsp;xxinterface()&nbsp;#&nbsp;instantiate&nbsp;our&nbsp;account<br>
<br>
How&nbsp;do&nbsp;i&nbsp;find&nbsp;out&nbsp;if&nbsp;a&nbsp;particular&nbsp;connection&nbsp;is&nbsp;already&nbsp;dead&nbsp;in&nbsp;the<br>
given&nbsp;&quot;account&quot;&nbsp;class?&nbsp;For&nbsp;smtp&nbsp;for&nbsp;example,<br>
&quot;mind&quot;&nbsp;is&nbsp;None&nbsp;and&nbsp;avatarId&nbsp;is&nbsp;just&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;login&nbsp;user.&nbsp;Even&nbsp;if<br>
this&nbsp;is&nbsp;pop3&nbsp;or&nbsp;imap,&nbsp;the&nbsp;same&nbsp;problem&nbsp;arise<br>
how&nbsp;do&nbsp;i&nbsp;know&nbsp;if&nbsp;the&nbsp;connection&nbsp;of&nbsp;the&nbsp;particular&nbsp;&quot;Server&quot;&nbsp;instance&nbsp;is<br>
dead.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
Perhaps&nbsp;you&nbsp;want&nbsp;to&nbsp;do&nbsp;something&nbsp;with&nbsp;the&nbsp;logout&nbsp;callback&nbsp;that&nbsp;<br>
requestAvatar&nbsp;is&nbsp;also&nbsp;responsible&nbsp;for&nbsp;returning?&nbsp;&nbsp;The&nbsp;SMTP&nbsp;protocol&nbsp;<br>
implementation&nbsp;will&nbsp;call&nbsp;it&nbsp;when&nbsp;the&nbsp;connection&nbsp;is&nbsp;lost.<br>
<br>
Jean-Paul<br>
<br>
_______________________________________________<br>
Twisted-Python&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
