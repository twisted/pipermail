<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Dear&nbsp;Twisted&nbsp;users,&lt;br&gt;&lt;div&gt;&lt;br&gt;I&nbsp;recently&nbsp;found&nbsp;myself&nbsp;implementing&nbsp;a&nbsp;design&nbsp;pattern&nbsp;that&nbsp;I&nbsp;think&nbsp;twisted.pb&nbsp;was&nbsp;specifically&nbsp;designed&nbsp;to&nbsp;address.&nbsp;I&nbsp;think&nbsp;I&#39;m&nbsp;not&nbsp;using&nbsp;pb&nbsp;correctly&nbsp;so&nbsp;I&#39;d&nbsp;like&nbsp;advice.&nbsp;This&nbsp;is&nbsp;a&nbsp;somewhat&nbsp;longish&nbsp;post&nbsp;because&nbsp;I&nbsp;need&nbsp;to&nbsp;describe&nbsp;the&nbsp;problem&nbsp;I&#39;m&nbsp;trying&nbsp;to&nbsp;solve.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;have&nbsp;done&nbsp;internet&nbsp;searches&nbsp;on&nbsp;Stack&nbsp;Overflow&nbsp;and&nbsp;this&nbsp;list&nbsp;but&nbsp;have&nbsp;not&nbsp;found&nbsp;the&nbsp;answer&nbsp;to&nbsp;my&nbsp;question.&nbsp;If&nbsp;I&#39;ve&nbsp;missed&nbsp;something&nbsp;kindly&nbsp;direct&nbsp;me&nbsp;to&nbsp;the&nbsp;appropriate&nbsp;reference.&lt;br&gt;&lt;br&gt;I&nbsp;want&nbsp;to&nbsp;implement&nbsp;something&nbsp;functionally&nbsp;equivalent&nbsp;to&nbsp;a&nbsp;network&nbsp;chess&nbsp;game.&nbsp;I&nbsp;first&nbsp;consider&nbsp;how&nbsp;I&nbsp;would&nbsp;do&nbsp;this&nbsp;on&nbsp;a&nbsp;single&nbsp;computer&nbsp;with&nbsp;no&nbsp;network&nbsp;(maybe&nbsp;this&nbsp;is&nbsp;bad&nbsp;thinking).&nbsp;Each&nbsp;piece&nbsp;in&nbsp;the&nbsp;game&nbsp;is&nbsp;represented&nbsp;by&nbsp;an&nbsp;instance&nbsp;of&nbsp;class&nbsp;Agent.&nbsp;Each&nbsp;agent&nbsp;has&nbsp;a&nbsp;.graphics&nbsp;attribute&nbsp;which&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;a&nbsp;class&nbsp;from&nbsp;a&nbsp;GUI&nbsp;toolkit&nbsp;library&nbsp;or&nbsp;equivalent.&nbsp;Whenever&nbsp;an&nbsp;agent&nbsp;in&nbsp;the&nbsp;game&nbsp;needs&nbsp;to&nbsp;do&nbsp;something&nbsp;there&nbsp;will&nbsp;be&nbsp;business&nbsp;logic&nbsp;executed&nbsp;by&nbsp;the&nbsp;game&nbsp;objects&nbsp;proper&nbsp;(ie&nbsp;the&nbsp;agents)&nbsp;which&nbsp;will&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;the&nbsp;.graphics&nbsp;objects&nbsp;to&nbsp;update&nbsp;the&nbsp;screen.&nbsp;This&nbsp;sort&nbsp;of&nbsp;structure&nbsp;seems&nbsp;natural&nbsp;as&nbsp;it&nbsp;allows&nbsp;easy&nbsp;integration&nbsp;of&nbsp;drag/drop,&nbsp;mouse&nbsp;click&nbsp;detection&nbsp;etc.&nbsp;It&nbsp;also&nbsp;nicely&nbsp;separates&nbsp;the&nbsp;real&nbsp;business&nbsp;logic&nbsp;from&nbsp;the&nbsp;GUI.&lt;br&gt;<br>
&lt;br&gt;Now&nbsp;I&nbsp;want&nbsp;to&nbsp;run&nbsp;over&nbsp;the&nbsp;network.&nbsp;The&nbsp;question&nbsp;is&nbsp;how&nbsp;should&nbsp;I&nbsp;set&nbsp;up&nbsp;references&nbsp;between&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;objects?&lt;br&gt;&lt;br&gt;Surely&nbsp;the&nbsp;server&nbsp;will&nbsp;maintain&nbsp;a&nbsp;set&nbsp;of&nbsp;objects&nbsp;representing&nbsp;the&nbsp;pieces&nbsp;in&nbsp;the&nbsp;game.&nbsp;It&nbsp;seems&nbsp;reasonable&nbsp;that&nbsp;each&nbsp;user&#39;s&nbsp;program&nbsp;will&nbsp;have&nbsp;a&nbsp;corresponding&nbsp;set&nbsp;of&nbsp;objects&nbsp;(with&nbsp;.graphics&nbsp;attributes).&nbsp;The&nbsp;issue&nbsp;is,&nbsp;what&nbsp;do&nbsp;we&nbsp;mean&nbsp;by&nbsp;&quot;corresponding&quot;&nbsp;and&nbsp;how&nbsp;do&nbsp;these&nbsp;objects&nbsp;talk&nbsp;to&nbsp;one&nbsp;another?&nbsp;Following&nbsp;is&nbsp;my&nbsp;idea&nbsp;so&nbsp;far:&lt;br&gt;<br>
&lt;br&gt;Each&nbsp;instance&nbsp;of&nbsp;AgentClient&nbsp;has&nbsp;a&nbsp;.server&nbsp;attribute&nbsp;which&nbsp;is&nbsp;a&nbsp;remote&nbsp;reference&nbsp;to&nbsp;an&nbsp;instance&nbsp;of&nbsp;AgentServer,&nbsp;and&nbsp;each&nbsp;instance&nbsp;of&nbsp;AgentServer&nbsp;has&nbsp;a&nbsp;.clients&nbsp;attribute&nbsp;which&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;remote&nbsp;references&nbsp;to&nbsp;instances&nbsp;of&nbsp;AgentClient.&lt;br&gt;<br>
&lt;br&gt;class&nbsp;AgentServer(pb.referenceable):&lt;br&gt;   &nbsp;&lt;br&gt;   &nbsp;def&nbsp;remote_move(self,&nbsp;targetSquare):&lt;br&gt;       &nbsp;&quot;&quot;&quot;Handle&nbsp;move&nbsp;request&nbsp;from&nbsp;client&quot;&quot;&quot;&lt;br&gt;       &nbsp;if&nbsp;self.thisMoveIsLegal(targetSquare):&lt;br&gt;<br>
           &nbsp;self.position&nbsp;=&nbsp;targetSquare&lt;br&gt;           &nbsp;for&nbsp;client&nbsp;in&nbsp;self.clients:&lt;br&gt;               &nbsp;client.callRemote(&quot;move&quot;,&nbsp;targetSquare)&lt;br&gt;   &nbsp;&lt;br&gt;   &nbsp;def&nbsp;thisMoveIsLegal(self,&nbsp;targetSquare):&lt;br&gt;       &nbsp;&lt;check&nbsp;that&nbsp;this&nbsp;is&nbsp;a&nbsp;legal&nbsp;move&gt;&lt;br&gt;<br>
   &nbsp;&lt;br&gt;class&nbsp;AgentClient(pb.referenceable):&lt;br&gt;   &nbsp;&lt;br&gt;   &nbsp;def&nbsp;requestMove(self,&nbsp;targetSquare):&lt;br&gt;       &nbsp;&quot;&quot;&quot;Tell&nbsp;server&nbsp;we&#39;d&nbsp;like&nbsp;to&nbsp;move&quot;&quot;&quot;&lt;br&gt;       &nbsp;self.server.callRemote(&quot;move&quot;,&nbsp;targetSquare)&lt;br&gt;<br>
   &nbsp;&lt;br&gt;   &nbsp;def&nbsp;remote_move(self,&nbsp;targetSquare):&lt;br&gt;       &nbsp;&quot;&quot;&quot;Server&nbsp;told&nbsp;us&nbsp;we&nbsp;moved&quot;&quot;&quot;&lt;br&gt;       &nbsp;self.position&nbsp;=&nbsp;targetSquare&lt;br&gt;       &nbsp;self.graphics.setNewPosition(targetSquare)&lt;br&gt;&lt;br&gt;<br>
This&nbsp;isn&#39;t&nbsp;THAT&nbsp;bad.&nbsp;The&nbsp;client&#39;s&nbsp;requestMove&nbsp;is&nbsp;thin&nbsp;and&nbsp;unecessary&nbsp;(I&nbsp;put&nbsp;it&nbsp;there&nbsp;for&nbsp;illustration).&nbsp;Still&nbsp;I&nbsp;need&nbsp;to&nbsp;have&nbsp;two&nbsp;separate&nbsp;classes&nbsp;with&nbsp;corresponding&nbsp;methods&nbsp;to&nbsp;handle&nbsp;moving&nbsp;the&nbsp;piece.&nbsp;This&nbsp;seems&nbsp;like&nbsp;the&nbsp;kind&nbsp;of&nbsp;thing&nbsp;I&nbsp;could&nbsp;twisted.pb&nbsp;to&nbsp;solve&nbsp;more&nbsp;cleanly&nbsp;if&nbsp;I&nbsp;only&nbsp;would&nbsp;look&nbsp;in&nbsp;the&nbsp;right&nbsp;place.&lt;br&gt;<br>
&lt;br&gt;This&nbsp;problem&nbsp;gets&nbsp;even&nbsp;worse&nbsp;when&nbsp;I&nbsp;think&nbsp;about&nbsp;how&nbsp;to&nbsp;birth&nbsp;new&nbsp;in-game&nbsp;objects.&nbsp;It&nbsp;would&nbsp;have&nbsp;to&nbsp;look&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;class&nbsp;PlayerServer(pb.referenceable):&lt;br&gt;   &nbsp;&lt;br&gt;   &nbsp;def&nbsp;newAgent(self,&nbsp;asker):&lt;br&gt;       &nbsp;&quot;&quot;&quot;Client&nbsp;told&nbsp;us&nbsp;it&nbsp;wants&nbsp;a&nbsp;new&nbsp;Agent&quot;&quot;&quot;&lt;br&gt;<br>
       &nbsp;if&nbsp;self.thisIsLegal():&lt;br&gt;           &nbsp;a&nbsp;=&nbsp;AgentServer()&lt;br&gt;           &nbsp;self.agents.append(a)&lt;br&gt;           &nbsp;for&nbsp;client&nbsp;in&nbsp;self.clients:&lt;br&gt;               &nbsp;d&nbsp;=&nbsp;client.callRemote(&quot;newAgent&quot;,&nbsp;a)&lt;br&gt;               &nbsp;d.addCallback(lambda&nbsp;obj:&nbsp;a.clients.append(obj))&lt;br&gt;<br>
   &nbsp;&lt;br&gt;class&nbsp;PlayerClient(bp.referenceable):&lt;br&gt;   &nbsp;&lt;br&gt;   &nbsp;def&nbsp;requestNewAgent(self):&lt;br&gt;       &nbsp;&quot;&quot;&quot;Tell&nbsp;the&nbsp;server&nbsp;we&nbsp;want&nbsp;to&nbsp;spawn&nbsp;a&nbsp;new&nbsp;Agent&quot;&quot;&quot;&lt;br&gt;       &nbsp;self.server.callRemote(&quot;newAgent&quot;,&nbsp;self)&lt;br&gt;<br>
   &nbsp;&lt;br&gt;   &nbsp;def&nbsp;newAgent(self,&nbsp;serverObj):&lt;br&gt;       &nbsp;a&nbsp;=&nbsp;AgentClient()&lt;br&gt;       &nbsp;self.agents.append(a)&lt;br&gt;       &nbsp;a.server&nbsp;=&nbsp;serverObj&lt;br&gt;       &nbsp;return&nbsp;a&lt;br&gt;&lt;br&gt;This&nbsp;just&nbsp;looks&nbsp;wrong.&nbsp;Any&nbsp;advice?&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you&nbsp;in&nbsp;advance&nbsp;for&nbsp;your&nbsp;help.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;br&gt;Daniel&nbsp;Sank&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
