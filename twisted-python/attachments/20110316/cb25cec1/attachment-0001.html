<tt>
Hi<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;a&nbsp;series&nbsp;of&nbsp;MultiService&nbsp;objects,&nbsp;with&nbsp;child&nbsp;Services.&nbsp;Some&nbsp;of&nbsp;these&nbsp;services&nbsp;are&nbsp;TCPServers,&nbsp;for&nbsp;example,&nbsp;and&nbsp;others&nbsp;are&nbsp;my&nbsp;own&nbsp;objects&nbsp;(extending&nbsp;from&nbsp;Service).&lt;/div&gt;&lt;div&gt;In&nbsp;the&nbsp;instance&nbsp;that&nbsp;I&nbsp;have&nbsp;a&nbsp;Service&nbsp;which&nbsp;controls&nbsp;a&nbsp;LoopingCall,&nbsp;I&nbsp;am&nbsp;getting&nbsp;intermittent&nbsp;&#39;unclean&nbsp;reactor&#39;&nbsp;errors&nbsp;during&nbsp;tests.&nbsp;I&nbsp;feel&nbsp;I&nbsp;might&nbsp;be&nbsp;missing&nbsp;some&nbsp;handling&nbsp;of&nbsp;deferreds,&nbsp;perhaps.&lt;/div&gt;<br>
&lt;div&gt;(using&nbsp;8.2.0&nbsp;-&nbsp;looking&nbsp;to&nbsp;migrate&nbsp;to&nbsp;10.2.0&nbsp;soon)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;an&nbsp;example&nbsp;of&nbsp;the&nbsp;approach&nbsp;being&nbsp;used:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;class AdapterQueue(service.MultiService):&lt;/div&gt;&lt;div&gt;&lt;div&gt;  &nbsp; def&nbsp;startService(self):&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; &nbsp; &nbsp; service.Service.startService(self)&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; self._looping_controller&nbsp;=&nbsp;LoopingCall(self._action)&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; d&nbsp;=&nbsp;self._looping_controller.start(self.delay,&nbsp;False)&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; d.addErrback(self._errorInScheduler)&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;  &nbsp; def&nbsp;stopService(self):&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; service.Service.stopService(self)&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; d&nbsp;=&nbsp;self._looping_controller.deferred&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; self._looping_controller.stop()&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; &nbsp; &nbsp; return&nbsp;d&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;an&nbsp;example&nbsp;error&nbsp;(happens&nbsp;about&nbsp;1/3&nbsp;of&nbsp;the&nbsp;time):&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;DirtyReactorAggregateError:&nbsp;Reactor&nbsp;was&nbsp;unclean.&lt;/div&gt;&lt;div&gt;DelayedCalls:&nbsp;(set&nbsp;twisted.internet.base.DelayedCall.debug&nbsp;=&nbsp;True&nbsp;to&nbsp;debug)&lt;/div&gt;<br>
&lt;div&gt;&lt;DelayedCall&nbsp;30800112&nbsp;[0.0189974308014s]&nbsp;called=0&nbsp;cancelled=0&nbsp;LoopingCall&lt;0.033333333333333333&gt;(AdapterQueue._action,&nbsp;*(),&nbsp;**{})()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;traceback&nbsp;at&nbsp;creation: &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  File&nbsp;&quot;C:\Python26\lib\threading.py&quot;,&nbsp;line&nbsp;497,&nbsp;in&nbsp;__bootstrap&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; self.__bootstrap_inner()&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;C:\Python26\lib\threading.py&quot;,&nbsp;line&nbsp;525,&nbsp;in&nbsp;__bootstrap_inner&lt;/div&gt;&lt;div&gt;  &nbsp; self.run()&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;C:\Python26\lib\threading.py&quot;,&nbsp;line&nbsp;477,&nbsp;in&nbsp;run&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; self.__target(*self.__args,&nbsp;**self.__kwargs)&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\nose-0.11.3-py2.6.egg\nose\twistedtools.py&quot;,&nbsp;line&nbsp;57,&nbsp;in&nbsp;&lt;lambda&gt;&lt;/div&gt;&lt;div&gt;  &nbsp; installSignalHandlers=False))&lt;/div&gt;&lt;div&gt;<br>
  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\base.py&quot;,&nbsp;line&nbsp;1128,&nbsp;in&nbsp;run&lt;/div&gt;&lt;div&gt;  &nbsp; self.mainLoop()&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\base.py&quot;,&nbsp;line&nbsp;1137,&nbsp;in&nbsp;mainLoop&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; self.runUntilCurrent()&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\base.py&quot;,&nbsp;line&nbsp;757,&nbsp;in&nbsp;runUntilCurrent&lt;/div&gt;&lt;div&gt;  &nbsp; call.func(*call.args,&nbsp;**&lt;a&nbsp;href=&quot;http://call.kw&quot;&gt;call.kw&lt;/a&gt;)&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\task.py&quot;,&nbsp;line&nbsp;115,&nbsp;in&nbsp;__call__&lt;/div&gt;&lt;div&gt;  &nbsp; d.addCallback(cb)&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\defer.py&quot;,&nbsp;line&nbsp;195,&nbsp;in&nbsp;addCallback&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; callbackKeywords=kw)&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\defer.py&quot;,&nbsp;line&nbsp;186,&nbsp;in&nbsp;addCallbacks&lt;/div&gt;&lt;div&gt;  &nbsp; self._runCallbacks()&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\defer.py&quot;,&nbsp;line&nbsp;328,&nbsp;in&nbsp;_runCallbacks&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; self.result&nbsp;=&nbsp;callback(self.result,&nbsp;*args,&nbsp;**kw)&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\task.py&quot;,&nbsp;line&nbsp;103,&nbsp;in&nbsp;cb&lt;/div&gt;&lt;div&gt;  &nbsp; self._reschedule()&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; File&nbsp;&quot;D:\dev\eggs\twisted-8.2.0-py2.6-win32.egg\twisted\internet\task.py&quot;,&nbsp;line&nbsp;139,&nbsp;in&nbsp;_reschedule&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; self.call&nbsp;=&nbsp;self.clock.callLater(nextTime&nbsp;-&nbsp;currentTime,&nbsp;self)&lt;/div&gt;&lt;div&gt;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Many&nbsp;thanks&lt;/div&gt;&lt;div&gt;Brad&lt;/div&gt;<br>

</tt>
