<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Dec&nbsp;2,&nbsp;2016,&nbsp;at&nbsp;12:37&nbsp;AM,&nbsp;Glyph&nbsp;Lefkowitz&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:glyph@twistedmatrix.com&quot;&nbsp;class=&quot;&quot;&gt;glyph@twistedmatrix.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Dec&nbsp;2,&nbsp;2016,&nbsp;at&nbsp;12:27&nbsp;AM,&nbsp;Glyph&nbsp;Lefkowitz&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:glyph@twistedmatrix.com&quot;&nbsp;class=&quot;&quot;&gt;glyph@twistedmatrix.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Dec&nbsp;2,&nbsp;2016,&nbsp;at&nbsp;12:19&nbsp;AM,&nbsp;Glyph&nbsp;Lefkowitz&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:glyph@twistedmatrix.com&quot;&nbsp;class=&quot;&quot;&gt;glyph@twistedmatrix.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Dec&nbsp;1,&nbsp;2016,&nbsp;at&nbsp;7:01&nbsp;PM,&nbsp;Mark&nbsp;Williams&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:markrwilliams@gmail.com&quot;&nbsp;class=&quot;&quot;&gt;markrwilliams@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Thu,&nbsp;Dec&nbsp;01,&nbsp;2016&nbsp;at&nbsp;05:11:37PM&nbsp;-0800,&nbsp;Craig&nbsp;Rodrigues&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;Hi,&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;I&nbsp;filed&nbsp;this&nbsp;bug:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/trac/ticket/8931&quot;&nbsp;class=&quot;&quot;&gt;https://twistedmatrix.com/trac/ticket/8931&lt;/a&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;At&nbsp;least&nbsp;for&nbsp;me,&nbsp;conch&nbsp;fails&nbsp;to&nbsp;parse&nbsp;a&nbsp;host&nbsp;key&nbsp;created&nbsp;by&nbsp;OpenSSH&lt;br&nbsp;class=&quot;&quot;&gt;in&nbsp;~/.ssh/known_hosts&lt;br&nbsp;class=&quot;&quot;&gt;which&nbsp;is&nbsp;of&nbsp;type&nbsp;ecdsa-sha2-nistp256.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Anyone&nbsp;have&nbsp;an&nbsp;idea&nbsp;as&nbsp;to&nbsp;how&nbsp;to&nbsp;fix&nbsp;this?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;As&nbsp;usual&nbsp;you've&nbsp;found&nbsp;a&nbsp;fantastically&nbsp;interesting&nbsp;issue.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;This&nbsp;is&nbsp;conch,&nbsp;the&nbsp;client,&nbsp;right?&nbsp;&nbsp;I'm&nbsp;guessing&nbsp;so&nbsp;because&lt;br&nbsp;class=&quot;&quot;&gt;~/.ssh/known_hosts&nbsp;contains&nbsp;the&nbsp;servers&nbsp;the&nbsp;ssh&nbsp;client&nbsp;trusts.&lt;br&nbsp;class=&quot;&quot;&gt;(Specifically,&nbsp;among&nbsp;other&nbsp;things&nbsp;it&nbsp;contains&nbsp;a&nbsp;hostname&nbsp;and&nbsp;that&lt;br&nbsp;class=&quot;&quot;&gt;host's&nbsp;sshd&nbsp;server's&nbsp;public&nbsp;key&nbsp;fingerprint).&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;If&nbsp;it&nbsp;is&nbsp;conch,&nbsp;the-client,&nbsp;then&nbsp;deleting&nbsp;the&nbsp;offending&nbsp;entry&nbsp;from&lt;br&nbsp;class=&quot;&quot;&gt;~/.ssh/known_hosts&nbsp;and&nbsp;getting&nbsp;a&nbsp;new&nbsp;one&nbsp;makes&nbsp;sense.&nbsp;&nbsp;That's&nbsp;because&lt;br&nbsp;class=&quot;&quot;&gt;sshd&nbsp;usually&nbsp;generates&nbsp;a&nbsp;couple&nbsp;of&nbsp;different&nbsp;keys&nbsp;in&nbsp;case&nbsp;clients&lt;br&nbsp;class=&quot;&quot;&gt;don't&nbsp;support&nbsp;the&nbsp;latest&nbsp;and&nbsp;greatest&nbsp;technology.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;I&nbsp;think&nbsp;deleting&nbsp;the&nbsp;entry&nbsp;in&nbsp;~/.ssh/known_hosts&nbsp;allows&nbsp;conch&nbsp;to&nbsp;ask&lt;br&nbsp;class=&quot;&quot;&gt;the&nbsp;server&nbsp;for&nbsp;a&nbsp;different&nbsp;key&nbsp;that&nbsp;it&nbsp;*can*&nbsp;understand.&nbsp;&nbsp;You&nbsp;should&lt;br&nbsp;class=&quot;&quot;&gt;be&nbsp;able&nbsp;to&nbsp;find&nbsp;out&nbsp;which&nbsp;server&nbsp;key&nbsp;conch&nbsp;negotiated&nbsp;by&nbsp;doing&nbsp;thing&lt;br&nbsp;class=&quot;&quot;&gt;following&nbsp;after&nbsp;deleting&nbsp;the&nbsp;offending&nbsp;~/.ssh/known_hosts&nbsp;entry:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;(&lt;hostname&nbsp;is&nbsp;the&nbsp;problematic&nbsp;OS&nbsp;X&nbsp;server&gt;)&lt;br&nbsp;class=&quot;&quot;&gt;$&nbsp;ssh-keygen&nbsp;-H&nbsp;-F&nbsp;&lt;hostname&gt;&nbsp;|&nbsp;awk&nbsp;'{&nbsp;print&nbsp;$NF&nbsp;}'&lt;br&nbsp;class=&quot;&quot;&gt;dGhpcyBpcyB2ZXJ5IHZlcnkgdmVyeSB2ZXJ5IHZlcnkgbG9uZyBob3N0IGtleQ==&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Then&nbsp;on&nbsp;the&nbsp;OS&nbsp;X&nbsp;server,&nbsp;grep&nbsp;for&nbsp;that&nbsp;in&nbsp;/etc/ssh/*.pub&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;I&nbsp;bet&nbsp;the&nbsp;key&nbsp;negotiated&nbsp;by&nbsp;conch&nbsp;is&nbsp;not&nbsp;an&nbsp;ECDSA&nbsp;key&nbsp;but&nbsp;rather&nbsp;an&lt;br&nbsp;class=&quot;&quot;&gt;RSA&nbsp;key.&nbsp;&nbsp;If&nbsp;this&nbsp;is&nbsp;all&nbsp;the&nbsp;case,&nbsp;then&nbsp;I&nbsp;think&nbsp;you've&nbsp;found&nbsp;a&nbsp;key&lt;br&nbsp;class=&quot;&quot;&gt;that&nbsp;LibreSSL&nbsp;supports&nbsp;but&nbsp;your&nbsp;client's&nbsp;libssl&nbsp;(which&nbsp;conch&nbsp;calls&lt;br&nbsp;class=&quot;&quot;&gt;into&nbsp;via&nbsp;cryptography)&nbsp;does&nbsp;not.&nbsp;&nbsp;What&nbsp;version&nbsp;of&nbsp;libssl&nbsp;do&nbsp;you&nbsp;have?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;If&nbsp;any&nbsp;of&nbsp;this&nbsp;is&nbsp;helpful&nbsp;or&nbsp;relevant&nbsp;I'll&nbsp;ask&nbsp;more&nbsp;questions&nbsp;in&nbsp;the&lt;br&nbsp;class=&quot;&quot;&gt;ticket.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;I&nbsp;think&nbsp;there&nbsp;might&nbsp;be&nbsp;a&nbsp;regression&nbsp;in&nbsp;16.6.0.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;For&nbsp;every&nbsp;version&nbsp;up&nbsp;to&nbsp;16.6.0,&nbsp;I&nbsp;can&nbsp;do&nbsp;'conch&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/&quot;&nbsp;class=&quot;&quot;&gt;twistedmatrix.com&lt;/a&gt;'&nbsp;in&nbsp;a&nbsp;shell&nbsp;and&nbsp;it&nbsp;works&nbsp;fine.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;16.6.0,&nbsp;I&nbsp;get:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Connection&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/&quot;&nbsp;class=&quot;&quot;&gt;twistedmatrix.com&lt;/a&gt;&nbsp;closed.&lt;br&nbsp;class=&quot;&quot;&gt;conch:&nbsp;exiting&nbsp;with&nbsp;error&nbsp;[Failure&nbsp;instance:&nbsp;Traceback&nbsp;(failure&nbsp;with&nbsp;no&nbsp;frames):&nbsp;&lt;class&nbsp;'twisted.conch.error.ConchError'&gt;:&nbsp;('bad&nbsp;host&nbsp;key',&nbsp;9)&lt;br&nbsp;class=&quot;&quot;&gt;]&lt;/div&gt;&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;instead.&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Worth&nbsp;noting:&nbsp;the&nbsp;keys&nbsp;I&nbsp;have&nbsp;for&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/&quot;&nbsp;class=&quot;&quot;&gt;twistedmatrix.com&lt;/a&gt;&nbsp;are&nbsp;RSA&nbsp;keys.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;What&nbsp;did&nbsp;we&nbsp;add&nbsp;recently&nbsp;that&nbsp;changes&nbsp;key&nbsp;parsing?&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;The&nbsp;offending&nbsp;commit&nbsp;is&nbsp;8164d89104a453947215b9296e8b406f15e63252.&nbsp;&nbsp;Clearly&nbsp;something&nbsp;went&nbsp;wrong&nbsp;when&nbsp;introducing&nbsp;ECDSA&nbsp;parsing.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;The&nbsp;problem&nbsp;is&nbsp;not&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;quite&lt;/i&gt;&nbsp;as&nbsp;bad&nbsp;as&nbsp;breaking&nbsp;RSA&nbsp;parsing,&nbsp;at&nbsp;least;&nbsp;the&nbsp;issue&nbsp;is&nbsp;that&nbsp;my&nbsp;known_hosts&nbsp;file&nbsp;includes&nbsp;an&nbsp;ecdsa-sha2-nistp256&nbsp;entry&nbsp;that&nbsp;_precedes_&nbsp;my&nbsp;ssh-rsa&nbsp;entry.&nbsp;&nbsp;So&nbsp;the&nbsp;problem&nbsp;is&nbsp;that&nbsp;parsing&nbsp;one&nbsp;of&nbsp;those&nbsp;entries&nbsp;raises&nbsp;an&nbsp;exception&nbsp;which&nbsp;propagates.&nbsp;&nbsp;From&nbsp;a&nbsp;superficial&nbsp;investigation,&nbsp;it&nbsp;would&nbsp;appear&nbsp;that&nbsp;_all_&nbsp;ecdsa&nbsp;keys&nbsp;cause&nbsp;this&nbsp;failure,&nbsp;though.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Investigating&nbsp;further,&nbsp;I&nbsp;think&nbsp;I've&nbsp;figured&nbsp;it&nbsp;out.&nbsp;&nbsp;Here's&nbsp;a&nbsp;patch&nbsp;that&nbsp;fixes&nbsp;the&nbsp;problem:&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;div&gt;diff&nbsp;--git&nbsp;a/src/twisted/conch/ssh/keys.py&nbsp;b/src/twisted/conch/ssh/keys.py&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;index&nbsp;d47db7f..570f524&nbsp;100644&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;---&nbsp;a/src/twisted/conch/ssh/keys.py&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;+++&nbsp;b/src/twisted/conch/ssh/keys.py&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;@@&nbsp;-247,8&nbsp;+247,10&nbsp;@@&nbsp;class&nbsp;Key(object):&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).public_key(default_backend())&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;keyType&nbsp;in&nbsp;[b'ecdsa-sha2-'&nbsp;+&nbsp;curve&nbsp;for&nbsp;curve&nbsp;in&nbsp;list(_curveTable.keys())]:&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x,&nbsp;y,&nbsp;rest&nbsp;=&nbsp;common.getMP(rest,&nbsp;2)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cls._fromECComponents(x=x,&nbsp;y=y,&nbsp;curve=keyType)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cls(load_ssh_public_key(&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyType&nbsp;+&nbsp;b'&nbsp;'&nbsp;+&nbsp;base64.encodestring(blob),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default_backend())&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;BadKeyError('unknown&nbsp;blob&nbsp;type:&nbsp;%s'&nbsp;%&nbsp;(keyType,))&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;I&nbsp;suspect,&nbsp;but&nbsp;do&nbsp;not&nbsp;fully&nbsp;understand,&nbsp;that&nbsp;the&nbsp;problem&nbsp;here&nbsp;is&nbsp;point&nbsp;compression.&nbsp;&nbsp;Key._fromString_BLOB&nbsp;naively&nbsp;just&nbsp;does&nbsp;getMP(blob,&nbsp;2)&nbsp;and&nbsp;expects&nbsp;that&nbsp;the&nbsp;x,y&nbsp;will&nbsp;be&nbsp;the&nbsp;EC&nbsp;point.&nbsp;&nbsp;However,&nbsp;to&nbsp;quote&nbsp;&lt;a&nbsp;href=&quot;https://tools.ietf.org/html/rfc5656#section-3.1&quot;&nbsp;class=&quot;&quot;&gt;https://tools.ietf.org/html/rfc5656#section-3.1&lt;/a&gt;,&nbsp;&quot;point&nbsp;compression&nbsp;MAY&nbsp;be&nbsp;used&quot;.&nbsp;&nbsp;I&nbsp;don't&nbsp;know&nbsp;exactly&nbsp;how&nbsp;point&nbsp;compression&nbsp;works,&nbsp;but&nbsp;I&nbsp;do&nbsp;understand&nbsp;that&nbsp;it&nbsp;means&nbsp;you&nbsp;do&nbsp;funky&nbsp;stuff&nbsp;with&nbsp;the&nbsp;Y&nbsp;value.&nbsp;&nbsp;I&nbsp;do&nbsp;not&nbsp;believe&nbsp;that&nbsp;EllipticCurvePrivateNumbers&nbsp;understands&nbsp;said&nbsp;funky&nbsp;stuff.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;A&nbsp;specific&nbsp;ECC&nbsp;integration&nbsp;test&nbsp;with&nbsp;ssh-keygen&nbsp;from&nbsp;OpenSSH&nbsp;and&nbsp;twisted.conch.client.knownhosts.KnownHostsFile&nbsp;would&nbsp;have&nbsp;spotted&nbsp;this&nbsp;specific&nbsp;manifestation&nbsp;of&nbsp;the&nbsp;issue.&nbsp;&nbsp;However,&nbsp;another&nbsp;underlying&nbsp;bug&nbsp;is&nbsp;that&nbsp;KnownHostsFile&nbsp;_should_&nbsp;ignore&nbsp;lines&nbsp;that&nbsp;it&nbsp;can't&nbsp;parse.&nbsp;&nbsp;And,&nbsp;there's&nbsp;another&nbsp;potential&nbsp;manifestation&nbsp;of&nbsp;the&nbsp;issue&nbsp;where&nbsp;loading&nbsp;from&nbsp;an&nbsp;actual&nbsp;key&nbsp;blob&nbsp;might&nbsp;not&nbsp;work;&nbsp;arguably&nbsp;the&nbsp;problem&nbsp;here&nbsp;is&nbsp;that&nbsp;KnownHostsFile&nbsp;made&nbsp;the&nbsp;questionable&nbsp;decision&nbsp;to&nbsp;do&nbsp;its&nbsp;own&nbsp;base64-decoding&nbsp;and&nbsp;pass&nbsp;the&nbsp;blob&nbsp;straight&nbsp;to&nbsp;the&nbsp;key&nbsp;rather&nbsp;than&nbsp;just&nbsp;pass&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;line&nbsp;after&nbsp;the&nbsp;hostname&nbsp;and&nbsp;load&nbsp;it&nbsp;as&nbsp;an&nbsp;openssh-format&nbsp;key&nbsp;directly.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;-glyph&lt;/div&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
