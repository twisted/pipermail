<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;May&nbsp;19,&nbsp;2020,&nbsp;at&nbsp;5:41&nbsp;AM,&nbsp;Jean-Paul&nbsp;Calderone&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:exarkun@twistedmatrix.com&quot;&nbsp;class=&quot;&quot;&gt;exarkun@twistedmatrix.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;&quot;&gt;On&nbsp;Tue,&nbsp;May&nbsp;19,&nbsp;2020&nbsp;at&nbsp;8:33&nbsp;AM&nbsp;Barry&nbsp;Scott&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:barry.scott@forcepoint.com&quot;&nbsp;class=&quot;&quot;&gt;barry.scott@forcepoint.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;Monday,&nbsp;18&nbsp;May&nbsp;2020&nbsp;22:21:16&nbsp;BST&nbsp;Tom&nbsp;Most&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&gt;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&gt;&nbsp;If&nbsp;looking&nbsp;improve&nbsp;process&nbsp;management&nbsp;in&nbsp;Twisted,&nbsp;I&nbsp;think&nbsp;that&nbsp;the&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&gt;&nbsp;lowest-hanging&nbsp;fruit&nbsp;is&nbsp;to&nbsp;watch&nbsp;children&nbsp;with&nbsp;pidfd,&nbsp;rather&nbsp;than&nbsp;reaping&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&gt;&nbsp;all&nbsp;children&nbsp;on&nbsp;SIGCHLD.&nbsp;This&nbsp;O(n)&nbsp;reaping&nbsp;---&nbsp;one&nbsp;waitpid()&nbsp;call&nbsp;per&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&gt;&nbsp;running&nbsp;process&nbsp;---&nbsp;starts&nbsp;to&nbsp;consume&nbsp;substantial&nbsp;CPU.&nbsp;IIRC&nbsp;it&nbsp;pegged&nbsp;a&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&gt;&nbsp;core&nbsp;at&nbsp;20,000&nbsp;processes&nbsp;or&nbsp;so.&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&lt;br&nbsp;class=&quot;&quot;&gt;<br>
Why&nbsp;not&nbsp;waitpid&nbsp;for&nbsp;all&nbsp;children&nbsp;(pid=0&nbsp;or&nbsp;pid=-1)&nbsp;in&nbsp;a&nbsp;single&nbsp;call?&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&lt;br&nbsp;class=&quot;&quot;&gt;<br>
Barry&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Because&nbsp;then&nbsp;you&nbsp;might&nbsp;reap&nbsp;a&nbsp;child&nbsp;process&nbsp;someone&nbsp;launched&nbsp;with&nbsp;a&nbsp;different&nbsp;API&nbsp;-&nbsp;eg&nbsp;the&nbsp;Python&nbsp;subprocess&nbsp;module.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;case&nbsp;it&nbsp;is&nbsp;not&nbsp;clear&nbsp;from&nbsp;context&nbsp;-&nbsp;we&nbsp;used&nbsp;to&nbsp;do&nbsp;exactly&nbsp;this.&nbsp;&nbsp;It&nbsp;broke&nbsp;a&nbsp;lot&nbsp;of&nbsp;stuff.&nbsp;&nbsp;The&nbsp;current&nbsp;approach&nbsp;is&nbsp;slow,&nbsp;but&nbsp;robust.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;-g&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
