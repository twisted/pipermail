<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;May&nbsp;19,&nbsp;2020,&nbsp;at&nbsp;11:14&nbsp;AM,&nbsp;Tom&nbsp;Most&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:twm@freecog.net&quot;&nbsp;class=&quot;&quot;&gt;twm@freecog.net&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;style=&quot;caret-color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Menlo-Regular;&nbsp;font-size:&nbsp;12px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant-caps:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;text-decoration:&nbsp;none;&quot;&nbsp;class=&quot;&quot;&gt;On&nbsp;Tue,&nbsp;May&nbsp;19,&nbsp;2020,&nbsp;at&nbsp;5:41&nbsp;AM,&nbsp;Jean-Paul&nbsp;Calderone&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;id=&quot;qt&quot;&nbsp;style=&quot;font-family:&nbsp;Menlo-Regular;&nbsp;font-size:&nbsp;12px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant-caps:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;text-decoration:&nbsp;none;&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;&quot;&gt;On&nbsp;Tue,&nbsp;May&nbsp;19,&nbsp;2020&nbsp;at&nbsp;8:33&nbsp;AM&nbsp;Barry&nbsp;Scott&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:barry.scott@forcepoint.com&quot;&nbsp;class=&quot;&quot;&gt;barry.scott@forcepoint.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;qt-gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;qt-gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left-color:&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;border-left-style:&nbsp;solid;&nbsp;border-left-width:&nbsp;1px;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Why&nbsp;not&nbsp;waitpid&nbsp;for&nbsp;all&nbsp;children&nbsp;(pid=0&nbsp;or&nbsp;pid=-1)&nbsp;in&nbsp;a&nbsp;single&nbsp;call?&lt;span&nbsp;class=&quot;Apple-converted-space&quot;&gt;&nbsp;&lt;/span&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Because&nbsp;then&nbsp;you&nbsp;might&nbsp;reap&nbsp;a&nbsp;child&nbsp;process&nbsp;someone&nbsp;launched&nbsp;with&nbsp;a&nbsp;different&nbsp;API&nbsp;-&nbsp;eg&nbsp;the&nbsp;Python&nbsp;subprocess&nbsp;module.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&nbsp;style=&quot;caret-color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Menlo-Regular;&nbsp;font-size:&nbsp;12px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant-caps:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;text-decoration:&nbsp;none;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;caret-color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Menlo-Regular;&nbsp;font-size:&nbsp;12px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant-caps:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;text-decoration:&nbsp;none;&quot;&nbsp;class=&quot;&quot;&gt;Exactly.&nbsp;I&nbsp;am&nbsp;currently&nbsp;using&nbsp;this&nbsp;as&nbsp;a&nbsp;workaround,&nbsp;but&nbsp;it's&nbsp;not&nbsp;a&nbsp;general&nbsp;solution.&nbsp;You&nbsp;need&nbsp;to&nbsp;be&nbsp;careful&nbsp;because&nbsp;subprocess&nbsp;use&nbsp;hides&nbsp;in&nbsp;many&nbsp;places.&nbsp;For&nbsp;example,&nbsp;beware&nbsp;uuid.uuid1().&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;pidfd's&nbsp;cool,&nbsp;we&nbsp;should&nbsp;totally&nbsp;use&nbsp;it.&nbsp;&nbsp;Also&nbsp;we&nbsp;should&nbsp;use&nbsp;posix_spawn&nbsp;and&nbsp;maybe&nbsp;some&nbsp;other&nbsp;stuff&nbsp;too.&nbsp;&nbsp;But&nbsp;I&nbsp;wonder&nbsp;if&nbsp;there's&nbsp;any&nbsp;heuristic&nbsp;we&nbsp;could&nbsp;use&nbsp;to&nbsp;speed&nbsp;up&nbsp;our&nbsp;current&nbsp;strategy,&nbsp;like&nbsp;ordering&nbsp;the&nbsp;to-reap&nbsp;list&nbsp;by&nbsp;putting&nbsp;things&nbsp;with&nbsp;no&nbsp;open&nbsp;FDs&nbsp;at&nbsp;the&nbsp;front&nbsp;of&nbsp;it?&nbsp;&nbsp;And&nbsp;optimistically&nbsp;assuming&nbsp;that&nbsp;once&nbsp;we've&nbsp;found&nbsp;something&nbsp;to&nbsp;reap,&nbsp;maybe&nbsp;we&nbsp;can&nbsp;stop?&nbsp;&nbsp;And&nbsp;maybe&nbsp;it&nbsp;should&nbsp;run&nbsp;in&nbsp;a&nbsp;cooperator,&nbsp;rather&nbsp;than&nbsp;just&nbsp;blocking&nbsp;the&nbsp;reactor&nbsp;indefinitely?&nbsp;&nbsp;Honestly&nbsp;it&nbsp;had&nbsp;not&nbsp;occurred&nbsp;to&nbsp;me&nbsp;that&nbsp;people&nbsp;were&nbsp;managing&nbsp;20k+&nbsp;python&nbsp;interpreters&nbsp;at&nbsp;a&nbsp;time&nbsp;with&nbsp;spawnProcess&nbsp;(although,&nbsp;yikes,&nbsp;amazing,&nbsp;you've&nbsp;gotta&nbsp;talk&nbsp;more&nbsp;about&nbsp;this&nbsp;application,&nbsp;and&nbsp;what&nbsp;kind&nbsp;of&nbsp;hardware&nbsp;you're&nbsp;on!)&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Anyway&nbsp;there's&nbsp;lot&nbsp;of&nbsp;exciting&nbsp;room&nbsp;for&nbsp;performance&nbsp;improvements&nbsp;here,&nbsp;it&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;have&nbsp;some&nbsp;benchmarks&nbsp;for&nbsp;this&nbsp;kind&nbsp;of&nbsp;high-load&nbsp;process-monitor&nbsp;application.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;-g&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
