<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Nov&nbsp;20,&nbsp;2016,&nbsp;at&nbsp;19:35,&nbsp;Mark&nbsp;Williams&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:markrwilliams@gmail.com&quot;&nbsp;class=&quot;&quot;&gt;markrwilliams@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Fri,&nbsp;Nov&nbsp;18,&nbsp;2016&nbsp;at&nbsp;05:36:16PM&nbsp;-0800,&nbsp;Glyph&nbsp;Lefkowitz&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&quot;doesn't&nbsp;work&quot;&nbsp;is&nbsp;a&nbsp;pretty&nbsp;black-and-white&nbsp;assessment.&nbsp;&nbsp;Are&nbsp;you&nbsp;anticipating&nbsp;a&nbsp;problem&nbsp;with&nbsp;the&nbsp;way&nbsp;the&nbsp;interface&nbsp;is&nbsp;specified&nbsp;that&nbsp;it&nbsp;can't&nbsp;be&nbsp;easily&nbsp;changed?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Yes.&nbsp;&nbsp;Here's&nbsp;the&nbsp;lede:&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you&nbsp;for&nbsp;summarizing!&nbsp;&nbsp;Point&nbsp;by&nbsp;point,&nbsp;here's&nbsp;my&nbsp;position:&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;IRCClient&nbsp;should&nbsp;deal&nbsp;in&nbsp;bytes&nbsp;and&nbsp;we&nbsp;should&nbsp;introduce&nbsp;a&nbsp;ProtocolWrapper-like&nbsp;thing&nbsp;that&nbsp;encodes&nbsp;and&nbsp;decodes&lt;br&nbsp;class=&quot;&quot;&gt;command&nbsp;prefixes&nbsp;and&nbsp;parameters.&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;I&nbsp;disagree.&nbsp;&nbsp;Any&nbsp;user-facing&nbsp;API&nbsp;should&nbsp;deal&nbsp;in&nbsp;unicode&nbsp;objects.&nbsp;&nbsp;(There&nbsp;is&nbsp;one&nbsp;caveat&nbsp;here;&nbsp;there&nbsp;really&nbsp;should&nbsp;be&nbsp;a&nbsp;separate&nbsp;layer&nbsp;for&nbsp;dealing&nbsp;with&nbsp;text;&nbsp;IRCClient&nbsp;being&nbsp;a&nbsp;subclassing-based&nbsp;API&nbsp;pollutes&nbsp;the&nbsp;whole&nbsp;issue.&nbsp;&nbsp;But&nbsp;that&nbsp;API&nbsp;shouldn't&nbsp;be&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;public&lt;/i&gt;,&nbsp;so&nbsp;this&nbsp;is&nbsp;largely&nbsp;minutae;&nbsp;the&nbsp;&quot;right&quot;&nbsp;answer&nbsp;here&nbsp;has&nbsp;nothing&nbsp;to&nbsp;do&nbsp;with&nbsp;bytes&nbsp;or&nbsp;text&nbsp;and&nbsp;everything&nbsp;to&nbsp;do&nbsp;with&nbsp;adopting&nbsp;.)&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;It&nbsp;should&nbsp;implement&nbsp;an&nbsp;interface,&nbsp;and&nbsp;we&nbsp;can&nbsp;start&nbsp;with&nbsp;an&nbsp;implementation&nbsp;that&nbsp;only&nbsp;knows&nbsp;about&nbsp;UTF-8.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;should&nbsp;have&nbsp;the&nbsp;implementation&nbsp;initially&nbsp;know&nbsp;about&nbsp;UTF-8,&nbsp;yes.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;The&nbsp;obvious&nbsp;advantage&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;you&nbsp;can&nbsp;more&nbsp;easily&nbsp;write&nbsp;IRCClients&nbsp;that&nbsp;work&nbsp;on&nbsp;both&nbsp;Python&nbsp;2&nbsp;and&nbsp;3.&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;the&nbsp;part&nbsp;that&nbsp;I'm&nbsp;worried&nbsp;about.&nbsp;&nbsp;It&nbsp;kinda&nbsp;seems&nbsp;like&nbsp;we're&nbsp;moving&nbsp;toward&nbsp;&quot;native&nbsp;string&quot;&nbsp;being&nbsp;the&nbsp;type&nbsp;used&nbsp;in&nbsp;IRCClient,&nbsp;and&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;that&lt;/i&gt;&nbsp;is&nbsp;capital-W&nbsp;Wrong.&nbsp;&nbsp;Native&nbsp;strings&nbsp;are&nbsp;for&nbsp;Python-native&nbsp;types&nbsp;only,&nbsp;i.e.&nbsp;docstrings&nbsp;and&nbsp;method&nbsp;names.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;I'm&nbsp;also&nbsp;not&nbsp;entirely&nbsp;sure&nbsp;of&nbsp;the&nbsp;consequences&nbsp;of&nbsp;this&nbsp;interface&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;change.&nbsp;&nbsp;I&nbsp;think&nbsp;it&nbsp;deserves&nbsp;more&nbsp;thought&nbsp;before&nbsp;it&nbsp;becomes&nbsp;an&nbsp;API&lt;br&nbsp;class=&quot;&quot;&gt;that&nbsp;we&nbsp;have&nbsp;to&nbsp;support.&nbsp;&nbsp;This&nbsp;is&nbsp;the&nbsp;primary&nbsp;reason&nbsp;I&nbsp;opened&nbsp;the&lt;br&nbsp;class=&quot;&quot;&gt;revert&nbsp;PR.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;One&nbsp;of&nbsp;the&nbsp;things&nbsp;that's&nbsp;informing&nbsp;my&nbsp;decision&nbsp;is&nbsp;that&nbsp;IRCClient&nbsp;is&nbsp;already&nbsp;an&nbsp;incredibly&nbsp;ill-defined&nbsp;API&nbsp;that&nbsp;probably&nbsp;needs&nbsp;to&nbsp;be&nbsp;deprecated&nbsp;and&nbsp;overhauled&nbsp;at&nbsp;some&nbsp;point.&nbsp;&nbsp;However,&nbsp;in&nbsp;the&nbsp;intervening&nbsp;(what&nbsp;will&nbsp;almost&nbsp;certainly&nbsp;be&nbsp;a)&nbsp;decade,&nbsp;I'd&nbsp;like&nbsp;it&nbsp;to&nbsp;work&nbsp;on&nbsp;Python&nbsp;3.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;I'm&nbsp;more&nbsp;precisely&nbsp;worried&nbsp;about&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;implementation&lt;br&nbsp;class=&quot;&quot;&gt;raises&nbsp;a&nbsp;decoding&nbsp;exception&nbsp;that&nbsp;cannot&nbsp;be&nbsp;handled&nbsp;in&nbsp;user&nbsp;code&nbsp;when&lt;br&nbsp;class=&quot;&quot;&gt;it&nbsp;receives&nbsp;non-UTF-8&nbsp;messages,&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;right&nbsp;way&nbsp;to&nbsp;deal&nbsp;with&nbsp;this&nbsp;is&nbsp;twofold:&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&nbsp;class=&quot;MailOutline&quot;&gt;&lt;li&nbsp;class=&quot;&quot;&gt;Add&nbsp;the&nbsp;ability&nbsp;to&nbsp;specify&nbsp;both&nbsp;the&nbsp;&quot;encoding&quot;&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;and&nbsp;the&nbsp;&quot;errors&quot;&lt;/i&gt;&nbsp;of&nbsp;the&nbsp;relevant&nbsp;codec&nbsp;&lt;&lt;a&nbsp;href=&quot;https://docs.python.org/2.7/library/codecs.html#codecs.decode&quot;&nbsp;class=&quot;&quot;&gt;https://docs.python.org/2.7/library/codecs.html#codecs.decode&lt;/a&gt;&gt;,&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;choose&nbsp;error&nbsp;handling&nbsp;strategies.&lt;/li&gt;&lt;li&nbsp;class=&quot;&quot;&gt;(potentially,&nbsp;if&nbsp;you&nbsp;have&nbsp;very&nbsp;nuanced&nbsp;requirements&nbsp;for&nbsp;dealing&nbsp;with&nbsp;weird&nbsp;encodings)&nbsp;write&nbsp;a&nbsp;codec&nbsp;that&nbsp;logs&nbsp;and&nbsp;handles&nbsp;its&nbsp;own&nbsp;errors.&nbsp;&nbsp;(We&nbsp;probably&nbsp;shouldn't&nbsp;be&nbsp;logging&nbsp;a&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;traceback&lt;/i&gt;&nbsp;for&nbsp;encoding&nbsp;problems&nbsp;regardless,&nbsp;if&nbsp;it's&nbsp;UnicodeDecodeError.&nbsp;&nbsp;But&nbsp;that's&nbsp;something&nbsp;that&nbsp;can&nbsp;easily&nbsp;be&nbsp;fixed&nbsp;in&nbsp;subsequent&nbsp;releases&nbsp;as&nbsp;well)&lt;/li&gt;&lt;/ol&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;and&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;line&nbsp;length&nbsp;checks&nbsp;occur&nbsp;prior&nbsp;to&nbsp;encoding,&nbsp;ensuring&nbsp;mid-codepoint&nbsp;truncation.&nbsp;These&nbsp;issues&nbsp;also&nbsp;contributed&nbsp;to&nbsp;my&nbsp;revert.&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Line&nbsp;length&nbsp;checks&nbsp;are&nbsp;a&nbsp;super&nbsp;interesting&nbsp;example&nbsp;because&nbsp;I&nbsp;think&nbsp;they&nbsp;also&nbsp;illustrate&nbsp;my&nbsp;concerns&nbsp;as&nbsp;well.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;To&nbsp;properly&nbsp;do&nbsp;message-splitting&nbsp;(which&nbsp;is&nbsp;why&nbsp;we're&nbsp;checking&nbsp;line&nbsp;length),&nbsp;you&nbsp;have&nbsp;to:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;ol&nbsp;class=&quot;MailOutline&quot;&gt;&lt;li&nbsp;class=&quot;&quot;&gt;check&nbsp;the&nbsp;length&nbsp;in&nbsp;octets&nbsp;(because&nbsp;it's&nbsp;actually&nbsp;a&nbsp;message-length&nbsp;limit&nbsp;in&nbsp;octets,&nbsp;not&nbsp;a&nbsp;line-length&nbsp;limit&nbsp;in&nbsp;characters)&lt;/li&gt;&lt;li&nbsp;class=&quot;&quot;&gt;split&nbsp;the&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;textual&lt;/i&gt;&nbsp;representation&nbsp;-&nbsp;ideally&nbsp;somewhere&nbsp;relevant&nbsp;like&nbsp;a&nbsp;word&nbsp;break,&nbsp;which&nbsp;you&nbsp;can&nbsp;only&nbsp;detect&nbsp;in&nbsp;text!&lt;/li&gt;&lt;li&nbsp;class=&quot;&quot;&gt;try&nbsp;encoding&nbsp;again&nbsp;and&nbsp;ensure&nbsp;that&nbsp;the&nbsp;encoded&nbsp;representation&nbsp;is&nbsp;the&nbsp;correct&nbsp;length,&nbsp;repeating&nbsp;if&nbsp;necessary.&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;This&nbsp;is&nbsp;an&nbsp;implementation-level&nbsp;bug&nbsp;though,&nbsp;not&nbsp;an&nbsp;interface-level&nbsp;one,&nbsp;so&nbsp;I'm&nbsp;also&nbsp;comfortable&nbsp;fixing&nbsp;this&nbsp;bug&nbsp;in&nbsp;the&nbsp;future.&lt;/div&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;My&nbsp;points&nbsp;are,&nbsp;separately:&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;IRC&nbsp;is&nbsp;text.&nbsp;It's&nbsp;nonsensical&nbsp;to&nbsp;process&nbsp;it&nbsp;as&nbsp;bytes,&nbsp;because&nbsp;you&nbsp;can't&nbsp;process&nbsp;it&nbsp;as&nbsp;bytes.&nbsp;&nbsp;This&nbsp;is&nbsp;separate&nbsp;from&nbsp;the&nbsp;question&nbsp;of&nbsp;&quot;what&nbsp;encoding&nbsp;is&nbsp;IRC&quot;.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;It's&nbsp;nonsensical&nbsp;that&nbsp;it&nbsp;be&nbsp;finally&nbsp;presented&nbsp;to&nbsp;a&nbsp;human&nbsp;as&nbsp;raw&nbsp;bytes.&lt;br&nbsp;class=&quot;&quot;&gt;I'm&nbsp;advocating&nbsp;for&nbsp;the&nbsp;decision&nbsp;to&nbsp;be&nbsp;made&nbsp;as&nbsp;late&nbsp;as&nbsp;possible.&nbsp;&nbsp;That&lt;br&nbsp;class=&quot;&quot;&gt;doesn't&nbsp;mean&nbsp;we&nbsp;can't&nbsp;provide&nbsp;an&nbsp;easy-to-use&nbsp;recoding&nbsp;client&nbsp;that&nbsp;we&lt;br&nbsp;class=&quot;&quot;&gt;encourage&nbsp;people&nbsp;to&nbsp;turn&nbsp;to&nbsp;first.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;can't&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;process&lt;/i&gt;&nbsp;it&nbsp;as&nbsp;bytes&nbsp;either,&nbsp;though.&nbsp;&nbsp;In&nbsp;some&nbsp;cases&nbsp;you&nbsp;think&nbsp;you&nbsp;can,&nbsp;but&nbsp;then&nbsp;you&nbsp;get&nbsp;mid-codepoint&nbsp;truncation&nbsp;:-).&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;But&nbsp;we&nbsp;can't&nbsp;have&nbsp;*a*&nbsp;fallback&nbsp;encoding.&nbsp;&nbsp;My&nbsp;encoding&nbsp;detector&nbsp;program&lt;br&nbsp;class=&quot;&quot;&gt;indicates&nbsp;that&nbsp;latin-1&nbsp;is&nbsp;the&nbsp;second&nbsp;most&nbsp;popular&nbsp;encoding&nbsp;for&lt;br&nbsp;class=&quot;&quot;&gt;European&nbsp;IRC&nbsp;servers,&nbsp;but&nbsp;Russian&nbsp;servers&nbsp;I&nbsp;sampled&nbsp;(not&nbsp;in&lt;br&nbsp;class=&quot;&quot;&gt;&lt;a&nbsp;href=&quot;http://netsplit.de&quot;&nbsp;class=&quot;&quot;&gt;netsplit.de&lt;/a&gt;'s&nbsp;top&nbsp;10)&nbsp;used&nbsp;a&nbsp;variety&nbsp;of&nbsp;Cyrillic&nbsp;encodings.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;really&nbsp;want&nbsp;to&nbsp;do&nbsp;something&nbsp;this&nbsp;sophisticated&nbsp;(and,&nbsp;I&nbsp;should&nbsp;note:&nbsp;no&nbsp;other&nbsp;IRC&nbsp;clients&nbsp;or&nbsp;bots&nbsp;I'm&nbsp;aware&nbsp;of&nbsp;do,&nbsp;so&nbsp;I&nbsp;think&nbsp;you've&nbsp;got&nbsp;an&nbsp;unrealistically&nbsp;tight&nbsp;set&nbsp;of&nbsp;requirements)&nbsp;then&nbsp;you&nbsp;can&nbsp;just&nbsp;write&nbsp;your&nbsp;own&nbsp;single&nbsp;codec&nbsp;that&nbsp;composes&nbsp;a&nbsp;bunch&nbsp;of&nbsp;others,&nbsp;and&nbsp;install&nbsp;it.&nbsp;&nbsp;Python's&nbsp;encoding&nbsp;system&nbsp;is&nbsp;extensible&nbsp;for&nbsp;exactly&nbsp;this&nbsp;reason&nbsp;:).&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;I&nbsp;also&nbsp;want&nbsp;to&nbsp;enable&nbsp;arbitrary&nbsp;recovery&nbsp;strategies&nbsp;for&nbsp;bad&nbsp;encodings.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;totally&nbsp;not&nbsp;an&nbsp;IRC-specific&nbsp;thing&nbsp;though&nbsp;:-).&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;For&nbsp;instance,&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;an&nbsp;IRC&nbsp;client&nbsp;or&nbsp;server&nbsp;truncates&nbsp;a&lt;br&nbsp;class=&quot;&quot;&gt;code&nbsp;point&nbsp;at&nbsp;a&nbsp;line&nbsp;boundary,&nbsp;it&nbsp;might&nbsp;be&nbsp;the&nbsp;right&nbsp;idea&nbsp;to&nbsp;binary&lt;br&nbsp;class=&quot;&quot;&gt;search&nbsp;until&nbsp;the&nbsp;invalid&nbsp;byte&nbsp;sequence&nbsp;is&nbsp;found,&nbsp;and&nbsp;then&nbsp;exclude&nbsp;it.&lt;br&nbsp;class=&quot;&quot;&gt;It&nbsp;might&nbsp;be&nbsp;the&nbsp;right&nbsp;idea&nbsp;to&nbsp;buffer&nbsp;the&nbsp;message&nbsp;for&nbsp;a&nbsp;time&nbsp;in&nbsp;the&lt;br&nbsp;class=&quot;&quot;&gt;hopes&nbsp;that&nbsp;the&nbsp;codepoint&nbsp;got&nbsp;split&nbsp;over&nbsp;two&nbsp;lines.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;And&nbsp;what&nbsp;if&nbsp;somebody&nbsp;wants&nbsp;to&nbsp;run&nbsp;another&nbsp;encoding&nbsp;survey?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Decode&nbsp;as&nbsp;charmap,&nbsp;which&nbsp;is&nbsp;what&nbsp;we&nbsp;call&nbsp;latin-1&nbsp;when&nbsp;we&nbsp;want&nbsp;to&nbsp;do&nbsp;this&nbsp;:).&nbsp;&nbsp;That's&nbsp;a&nbsp;super&nbsp;edge-case,&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;easy&nbsp;by&nbsp;default.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;I&nbsp;don't&nbsp;expect&nbsp;most&nbsp;users&nbsp;to&nbsp;do&nbsp;any&nbsp;of&nbsp;that,&nbsp;but&nbsp;*I*&nbsp;certainly&nbsp;want&nbsp;to&lt;br&nbsp;class=&quot;&quot;&gt;without&nbsp;having&nbsp;to&nbsp;copy&nbsp;and&nbsp;paste&nbsp;a&nbsp;bunch&nbsp;of&nbsp;code.&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;can&nbsp;totally&nbsp;do&nbsp;all&nbsp;of&nbsp;these&nbsp;things&nbsp;once&nbsp;we&nbsp;can&nbsp;specify&nbsp;an&nbsp;encoding.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;arabic&nbsp;USB&nbsp;drive&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;My&nbsp;real&nbsp;point&nbsp;was&nbsp;that&nbsp;dealing&nbsp;with&nbsp;bad&nbsp;encodings&nbsp;is&nbsp;not&nbsp;theoretical.&lt;br&nbsp;class=&quot;&quot;&gt;Nobody&nbsp;knew&nbsp;the&nbsp;encoding,&nbsp;by&nbsp;the&nbsp;way;&nbsp;they&nbsp;just&nbsp;knew&nbsp;the&nbsp;USB&nbsp;drive&lt;br&nbsp;class=&quot;&quot;&gt;worked&nbsp;for&nbsp;some&nbsp;of&nbsp;them&nbsp;and&nbsp;not&nbsp;others,&nbsp;and&nbsp;were&nbsp;resulting&nbsp;to&nbsp;printing&lt;br&nbsp;class=&quot;&quot;&gt;things&nbsp;out&nbsp;or&nbsp;taking&nbsp;screen&nbsp;shots.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Sure,&nbsp;sorry&nbsp;for&nbsp;my&nbsp;sarcastic&nbsp;retort.&nbsp;&nbsp;The&nbsp;example&nbsp;is&nbsp;totally&nbsp;germane;&nbsp;I&nbsp;didn't&nbsp;mean&nbsp;to&nbsp;say&nbsp;it&nbsp;wasn't.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;That's&nbsp;the&nbsp;situation&nbsp;opinionated&nbsp;software&nbsp;with&nbsp;monolithic&nbsp;abstractions&lt;br&nbsp;class=&quot;&quot;&gt;creates.&nbsp;&nbsp;People&nbsp;*will*&nbsp;find&nbsp;workarounds&nbsp;that&nbsp;are&nbsp;terrible&nbsp;for&nbsp;a&nbsp;bunch&lt;br&nbsp;class=&quot;&quot;&gt;of&nbsp;reasons.&nbsp;&nbsp;I&nbsp;can&nbsp;vouch&nbsp;for&nbsp;the&nbsp;utility&nbsp;of&nbsp;tools&nbsp;that&nbsp;decide&nbsp;on&lt;br&nbsp;class=&quot;&quot;&gt;encodings&nbsp;as&nbsp;late&nbsp;as&nbsp;possible.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Wouldn't&nbsp;it&nbsp;have&nbsp;been&nbsp;great&nbsp;if&nbsp;you&nbsp;couldn't&nbsp;create&nbsp;this&nbsp;mess&nbsp;in&nbsp;the&nbsp;first&nbsp;place,&nbsp;though?&nbsp;&nbsp;The&nbsp;ability&nbsp;to&nbsp;recover&nbsp;is&nbsp;good&nbsp;(and&nbsp;being&nbsp;able&nbsp;to&nbsp;specify&nbsp;the&nbsp;encoding,&nbsp;and&nbsp;write&nbsp;your&nbsp;own&nbsp;custom&nbsp;codec,&nbsp;for&nbsp;IRC&nbsp;is&nbsp;certainly&nbsp;important).&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;I&nbsp;don't&nbsp;remember&nbsp;either.&nbsp;&nbsp;But,&nbsp;now&nbsp;the&nbsp;driver&nbsp;*allows*&nbsp;me&nbsp;to&nbsp;do&nbsp;that&lt;br&nbsp;class=&quot;&quot;&gt;without&nbsp;requiring&nbsp;it,&nbsp;and&nbsp;also&nbsp;allows&nbsp;me&nbsp;to&nbsp;mount&nbsp;the&nbsp;file&nbsp;system&nbsp;so&lt;br&nbsp;class=&quot;&quot;&gt;that&nbsp;the&nbsp;paths&nbsp;are&nbsp;exposed&nbsp;as&nbsp;bytes.&nbsp;&nbsp;Since&nbsp;nobody&nbsp;knew&nbsp;the&nbsp;encoding,&lt;br&nbsp;class=&quot;&quot;&gt;that&nbsp;was&nbsp;essential&nbsp;to&nbsp;letting&nbsp;me&nbsp;use&nbsp;mlterm&nbsp;to&nbsp;determine&nbsp;it.&nbsp;&nbsp;Nowadays&lt;br&nbsp;class=&quot;&quot;&gt;I'd&nbsp;probably&nbsp;use&nbsp;chardet&nbsp;but&nbsp;would&nbsp;still&nbsp;need&nbsp;the&nbsp;raw&nbsp;bytes.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Using&nbsp;latin-1&nbsp;in&nbsp;this&nbsp;scenario&nbsp;would&nbsp;have&nbsp;worked&nbsp;as&nbsp;well,&nbsp;though.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;And&nbsp;as&nbsp;far&nbsp;as&nbsp;I&nbsp;know&nbsp;code&nbsp;point&nbsp;sequence&nbsp;truncation&nbsp;can&nbsp;also&nbsp;occur&nbsp;on&lt;br&nbsp;class=&quot;&quot;&gt;FAT16/32&nbsp;partitions.&nbsp;&nbsp;In&nbsp;the&nbsp;event&nbsp;of&nbsp;such&nbsp;truncation&nbsp;the&nbsp;automatic&lt;br&nbsp;class=&quot;&quot;&gt;decoding&nbsp;would&nbsp;only&nbsp;prevent&nbsp;me&nbsp;from&nbsp;mounting&nbsp;the&nbsp;partition.&nbsp;&nbsp;I'm&lt;br&nbsp;class=&quot;&quot;&gt;thankful&nbsp;that&nbsp;the&nbsp;implementation&nbsp;allows&nbsp;me&nbsp;to&nbsp;choose&nbsp;a&nbsp;recovery&lt;br&nbsp;class=&quot;&quot;&gt;strategy&nbsp;in&nbsp;a&nbsp;very&nbsp;real&nbsp;edge&nbsp;case.&nbsp;&nbsp;If&nbsp;it&nbsp;didn't,&nbsp;I'd&nbsp;have&nbsp;to&nbsp;look&nbsp;up&lt;br&nbsp;class=&quot;&quot;&gt;the&nbsp;file&nbsp;system's&nbsp;on&nbsp;disk&nbsp;format&nbsp;and&nbsp;reimplement&nbsp;99%&nbsp;of&nbsp;a&nbsp;FAT16&nbsp;driver&lt;br&nbsp;class=&quot;&quot;&gt;to&nbsp;get&nbsp;at&nbsp;the&nbsp;data.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;OK,&nbsp;now&nbsp;we're&nbsp;getting&nbsp;into&nbsp;some&nbsp;real&nbsp;filesystem&nbsp;esoterica&nbsp;which&nbsp;I'm&nbsp;not&nbsp;sure&nbsp;applies&nbsp;any&nbsp;more&nbsp;:-).&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;Sorry,&nbsp;my&nbsp;statement&nbsp;you&nbsp;were&nbsp;responding&nbsp;to&nbsp;here&nbsp;was&nbsp;way&nbsp;too&nbsp;strong.&nbsp;&nbsp;What&nbsp;I&nbsp;meant&nbsp;to&nbsp;say&nbsp;here&nbsp;is&nbsp;that&nbsp;long&nbsp;term&nbsp;there&nbsp;is&nbsp;no&nbsp;way&nbsp;to&nbsp;get&nbsp;a&nbsp;&quot;right&quot;&nbsp;answer&nbsp;in&nbsp;this&nbsp;ecosystem,&nbsp;so&nbsp;&quot;UTF-8&nbsp;is&nbsp;the&nbsp;only&nbsp;correct&nbsp;answer&quot;&nbsp;is&nbsp;the&nbsp;only&nbsp;direction&nbsp;we&nbsp;can&nbsp;push&nbsp;in&nbsp;to&nbsp;actually&nbsp;make&nbsp;things&nbsp;work&nbsp;reasonably&nbsp;by&nbsp;default&nbsp;an&nbsp;increasing&nbsp;proportion&nbsp;of&nbsp;the&nbsp;time.&nbsp;&nbsp;For&nbsp;the&nbsp;forseeable&nbsp;future,&nbsp;adding&nbsp;the&nbsp;ability&nbsp;to&nbsp;cope&nbsp;with&nbsp;other&nbsp;encodings&nbsp;(encoding&nbsp;a&nbsp;fallback&nbsp;to&nbsp;latin-1&nbsp;so&nbsp;that&nbsp;you&nbsp;can&nbsp;at&nbsp;least&nbsp;do&nbsp;demojibakefication&nbsp;manually&nbsp;after&nbsp;copy/pasting)&nbsp;is&nbsp;something&nbsp;a&nbsp;general-purpose&nbsp;IRC&nbsp;library&nbsp;absolutely&nbsp;needs.&nbsp;&nbsp;This&nbsp;is&nbsp;why&nbsp;every&nbsp;client&nbsp;has&nbsp;an&nbsp;&quot;encoding&quot;&nbsp;selection&nbsp;menu,&nbsp;too.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;For&nbsp;what&nbsp;it's&nbsp;worth,&nbsp;I&nbsp;want&nbsp;to&nbsp;make&nbsp;it&nbsp;easy&nbsp;to&nbsp;use&nbsp;UTF-8.&nbsp;&nbsp;I&nbsp;just&lt;br&nbsp;class=&quot;&quot;&gt;don't&nbsp;want&nbsp;to&nbsp;make&nbsp;it&nbsp;hard&nbsp;to&nbsp;use&nbsp;an&nbsp;encoding&nbsp;that's&nbsp;*not*&nbsp;UTF-8.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;want&nbsp;to&nbsp;make&nbsp;it&nbsp;a&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;little&lt;/i&gt;&nbsp;hard.&nbsp;&nbsp;Having&nbsp;a&nbsp;version&nbsp;floating&nbsp;around&nbsp;for&nbsp;a&nbsp;few&nbsp;releases&nbsp;that&nbsp;only&nbsp;supports&nbsp;UTF-8&nbsp;creates&nbsp;gentle&nbsp;social&nbsp;pressure&nbsp;for&nbsp;everyone&nbsp;to&nbsp;fix&nbsp;their&nbsp;encodings.&nbsp;&nbsp;Later&nbsp;releasing&nbsp;the&nbsp;version&nbsp;that&nbsp;supports&nbsp;arbitrary&nbsp;stuff&nbsp;including&nbsp;chardet&nbsp;addresses&nbsp;the&nbsp;long&nbsp;tail&nbsp;of&nbsp;brokenness&nbsp;that&nbsp;can't&nbsp;be&nbsp;fixed&nbsp;by&nbsp;a&nbsp;nudge.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;It&nbsp;makes&nbsp;more&nbsp;sense&nbsp;to&nbsp;have&nbsp;an&nbsp;implementation&nbsp;that&nbsp;parses&nbsp;protocol&lt;br&nbsp;class=&quot;&quot;&gt;elements&nbsp;as&nbsp;bytes&nbsp;and&nbsp;provides&nbsp;a&nbsp;bytes&nbsp;API.&nbsp;&nbsp;It's&nbsp;fine&nbsp;to&nbsp;also&nbsp;provide&lt;br&nbsp;class=&quot;&quot;&gt;a&nbsp;decoded&nbsp;text&nbsp;API,&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;exclusion&nbsp;of&nbsp;bytes.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;This&nbsp;is&nbsp;the&nbsp;point&nbsp;where&nbsp;I&nbsp;think&nbsp;we&nbsp;diverge.&nbsp;&nbsp;I&nbsp;don't&nbsp;think&nbsp;adding&nbsp;a&nbsp;bytes&nbsp;API&nbsp;actually&nbsp;adds&nbsp;any&nbsp;value.&nbsp;&nbsp;Trying&nbsp;to&nbsp;process&nbsp;the&nbsp;contents&nbsp;of&nbsp;IRC&nbsp;as&nbsp;bytes&nbsp;as&nbsp;any&nbsp;way&nbsp;leads&nbsp;to&nbsp;inevitable&nbsp;failures&nbsp;(&quot;line&quot;&nbsp;truncation&nbsp;midway&nbsp;through&nbsp;a&nbsp;UTF-8&nbsp;escape&nbsp;sequence&nbsp;for&nbsp;example).&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;This&nbsp;is&nbsp;precisely&nbsp;where&nbsp;we&nbsp;disagree.&nbsp;&nbsp;As&nbsp;I&nbsp;described&nbsp;above,&nbsp;I&nbsp;can&lt;br&nbsp;class=&quot;&quot;&gt;think&nbsp;of&nbsp;a&nbsp;couple&nbsp;ways&nbsp;to&nbsp;handle&nbsp;mid-codepoint&nbsp;truncation.&nbsp;&nbsp;A&lt;br&nbsp;class=&quot;&quot;&gt;Twisted-based&nbsp;IRC&nbsp;client&nbsp;should&nbsp;have&nbsp;the&nbsp;option&nbsp;to&nbsp;implement&nbsp;its&nbsp;own.&lt;br&nbsp;class=&quot;&quot;&gt;The&nbsp;end&nbsp;result&nbsp;would&nbsp;still&nbsp;be&nbsp;text&nbsp;(or&nbsp;at&nbsp;least&nbsp;an&nbsp;informative&nbsp;log&lt;br&nbsp;class=&quot;&quot;&gt;message.)&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;OK,&nbsp;this&nbsp;is&nbsp;definitely&nbsp;the&nbsp;part&nbsp;where&nbsp;we&nbsp;diverge.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;care&nbsp;so&nbsp;much&nbsp;about&nbsp;the&nbsp;hairsplitting&nbsp;specifics&nbsp;of&nbsp;IRC&nbsp;byte&nbsp;handling&nbsp;that&nbsp;you&nbsp;want&nbsp;to&nbsp;change&nbsp;the&nbsp;line-splitting&nbsp;algorithm&nbsp;to&nbsp;do&nbsp;something&nbsp;specific,&nbsp;you&nbsp;should&nbsp;be&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;maintaining&lt;/i&gt;&nbsp;Twisted,&nbsp;not&nbsp;writing&nbsp;applications&nbsp;with&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;suppose&nbsp;I&nbsp;should&nbsp;reveal&nbsp;my&nbsp;bias&nbsp;here:&nbsp;IRC&nbsp;is&nbsp;a&nbsp;garbage&nbsp;protocol,&nbsp;and&nbsp;its&nbsp;implementations'&nbsp;main&nbsp;utility&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;should&lt;/i&gt;&nbsp;be&nbsp;upward&nbsp;compatibility&nbsp;with&nbsp;something&nbsp;more&nbsp;modern,&nbsp;maybe&nbsp;a&nbsp;line-delimited&nbsp;JSON&nbsp;thing,&nbsp;since&nbsp;XMPP&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;have&nbsp;taken&nbsp;off.&nbsp;&nbsp;That&nbsp;thing&nbsp;hasn't&nbsp;arrived&nbsp;yet,&nbsp;whatever&nbsp;it&nbsp;will&nbsp;be,&nbsp;but&nbsp;when&nbsp;we&nbsp;present&nbsp;an&nbsp;application-level&nbsp;interface&nbsp;to&nbsp;it,&nbsp;we&nbsp;should&nbsp;strip&nbsp;away&nbsp;as&nbsp;much&nbsp;IRC-specific&nbsp;junk&nbsp;as&nbsp;we&nbsp;can,&nbsp;while&nbsp;still&nbsp;maintaining&nbsp;enough&nbsp;specificity&nbsp;that&nbsp;consumers&nbsp;of&nbsp;the&nbsp;API&nbsp;can&nbsp;provoke&nbsp;specific&nbsp;desired&nbsp;user-facing&nbsp;behaviors&nbsp;in&nbsp;user&nbsp;interfaces&nbsp;(for&nbsp;example,&nbsp;preserving&nbsp;the&nbsp;distinction&nbsp;between&nbsp;&quot;notice&quot;&nbsp;and&nbsp;&quot;message&quot;).&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Twisted's&nbsp;IRC&nbsp;support's&nbsp;job,&nbsp;in&nbsp;my&nbsp;mind,&nbsp;is&nbsp;to&nbsp;support&nbsp;applications&nbsp;that&nbsp;want&nbsp;to&nbsp;interact&nbsp;with&nbsp;users&nbsp;and&nbsp;servers,&nbsp;and&nbsp;possibly&nbsp;process&nbsp;messages&nbsp;in&nbsp;between.&nbsp;&nbsp;You&nbsp;can't&nbsp;process&nbsp;messages&nbsp;as&nbsp;bytes&nbsp;(see&nbsp;mid-codepoint&nbsp;truncation&nbsp;above),&nbsp;so&nbsp;presenting&nbsp;a&nbsp;bytes-oriented&nbsp;interface&nbsp;is&nbsp;useless&nbsp;for&nbsp;this&nbsp;whole&nbsp;class&nbsp;of&nbsp;application,&nbsp;not&nbsp;just&nbsp;for&nbsp;the&nbsp;final&nbsp;step&nbsp;where&nbsp;the&nbsp;message&nbsp;is&nbsp;presented&nbsp;to&nbsp;a&nbsp;human.&nbsp;&nbsp;Presenting&nbsp;this&nbsp;low-level&nbsp;interface&nbsp;to&nbsp;enable&nbsp;users&nbsp;the&nbsp;ability&nbsp;to&nbsp;&lt;i&nbsp;class=&quot;&quot;&gt;customize&nbsp;line-splitting&lt;/i&gt;&nbsp;is&nbsp;just&nbsp;bonkers.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;I&nbsp;think&nbsp;the&nbsp;best&nbsp;way&nbsp;to&nbsp;handle&nbsp;this&nbsp;is&nbsp;to&nbsp;have&nbsp;a&nbsp;bytes-only&nbsp;IRC&nbsp;client&lt;br&nbsp;class=&quot;&quot;&gt;that&nbsp;can&nbsp;then&nbsp;be&nbsp;wrapped&nbsp;with&nbsp;something&nbsp;that&nbsp;decodes&nbsp;prefixes&nbsp;and&lt;br&nbsp;class=&quot;&quot;&gt;parameters.&nbsp;&nbsp;We&nbsp;can&nbsp;provide&nbsp;a&nbsp;UTF-8&nbsp;recoder&nbsp;that&nbsp;people&nbsp;are&nbsp;encouraged&lt;br&nbsp;class=&quot;&quot;&gt;to&nbsp;use,&nbsp;and&nbsp;an&nbsp;interface&nbsp;that&nbsp;allows&nbsp;implementers&nbsp;to&nbsp;choose&nbsp;their&nbsp;own&lt;br&nbsp;class=&quot;&quot;&gt;encoding&nbsp;strategy.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;At&nbsp;the&nbsp;risk&nbsp;of&nbsp;repeating&nbsp;myself,&nbsp;the&nbsp;way&nbsp;you&nbsp;select&nbsp;an&nbsp;encoding&nbsp;strategy&nbsp;in&nbsp;Python&nbsp;is&nbsp;selecting&nbsp;an&nbsp;encoding&nbsp;:).&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;I&nbsp;will&nbsp;say&nbsp;I'm&nbsp;happy&nbsp;to&nbsp;take&nbsp;a&nbsp;stab&nbsp;at&nbsp;a&nbsp;recoder.&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;You've&nbsp;used&nbsp;this&nbsp;word&nbsp;a&nbsp;few&nbsp;times&nbsp;-&nbsp;what&nbsp;is&nbsp;a&nbsp;&quot;recoder&quot;?&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;Shipping&nbsp;what&nbsp;we&nbsp;have&nbsp;now&nbsp;will&nbsp;mean&nbsp;we're&nbsp;putting&nbsp;bugs&nbsp;out&nbsp;there&nbsp;(see&lt;br&nbsp;class=&quot;&quot;&gt;the&nbsp;line&nbsp;length&nbsp;issues&nbsp;called&nbsp;out&nbsp;in&nbsp;the&nbsp;ticket)&nbsp;and&nbsp;an&nbsp;interface&nbsp;I&lt;br&nbsp;class=&quot;&quot;&gt;think&nbsp;we&nbsp;haven't&nbsp;thought&nbsp;through,&nbsp;but&nbsp;that&nbsp;certainly&nbsp;limits&nbsp;what&nbsp;IRC&lt;br&nbsp;class=&quot;&quot;&gt;protocol&nbsp;messages&nbsp;you&nbsp;can&nbsp;receive.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;I'm&nbsp;OK&nbsp;with&nbsp;there&nbsp;being&nbsp;edge-case&nbsp;bugs&nbsp;like&nbsp;this:&nbsp;we&nbsp;should&nbsp;fix&nbsp;them&nbsp;one&nbsp;at&nbsp;a&nbsp;time.&nbsp;&nbsp;Smaller&nbsp;PRs&nbsp;are&nbsp;better,&nbsp;even&nbsp;if&nbsp;it&nbsp;means&nbsp;not&nbsp;everything&nbsp;works&nbsp;perfectly&nbsp;in&nbsp;every&nbsp;release.&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;I&nbsp;guess&nbsp;charmap&nbsp;could&nbsp;be&nbsp;used&nbsp;to&nbsp;implement&nbsp;the&nbsp;recovery&nbsp;scheme&nbsp;I&nbsp;keep&lt;br&nbsp;class=&quot;&quot;&gt;talking&nbsp;about,&nbsp;but&nbsp;then&nbsp;we'd&nbsp;be&nbsp;telling&nbsp;people&nbsp;to&nbsp;work&nbsp;out&nbsp;the&lt;br&nbsp;class=&quot;&quot;&gt;recoding&nbsp;interaction&nbsp;between&nbsp;IRCClient&nbsp;and&nbsp;their&nbsp;own&nbsp;implementation.&lt;br&nbsp;class=&quot;&quot;&gt;I'd&nbsp;like&nbsp;to&nbsp;provide&nbsp;a&nbsp;defined&nbsp;way&nbsp;of&nbsp;doing&nbsp;so&nbsp;eventually.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;Kay&nbsp;put&nbsp;it,&nbsp;simple&nbsp;things&nbsp;should&nbsp;be&nbsp;easy,&nbsp;and&nbsp;complex&nbsp;things&nbsp;should&nbsp;be&nbsp;possible.&nbsp;&nbsp;I&nbsp;am&nbsp;happy&nbsp;with&nbsp;this&nbsp;tradeoff&nbsp;-&nbsp;writing&nbsp;this&nbsp;weird&nbsp;transcoding&nbsp;nexus&nbsp;IRC&nbsp;proxy&nbsp;application&nbsp;_should_&nbsp;be&nbsp;kind&nbsp;of&nbsp;hard&nbsp;;).&nbsp;&nbsp;Writing&nbsp;a&nbsp;bot&nbsp;that&nbsp;spits&nbsp;out&nbsp;emoji&nbsp;in&nbsp;response&nbsp;to&nbsp;jokes&nbsp;should&nbsp;be&nbsp;easy.&nbsp;&nbsp;(And&nbsp;you&nbsp;can't&nbsp;even&nbsp;encode&nbsp;emoji&nbsp;in&nbsp;KOI-8,&nbsp;so.)&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;So...&nbsp;have&nbsp;I&nbsp;sold&nbsp;you?&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;br&nbsp;class=&quot;&quot;&gt;On&nbsp;default&nbsp;UTF-8?&nbsp;&nbsp;Absolutely!&nbsp;&nbsp;But&nbsp;I&nbsp;don't&nbsp;know&nbsp;exactly&nbsp;the&nbsp;way&nbsp;to&nbsp;do&lt;br&nbsp;class=&quot;&quot;&gt;it,&nbsp;so&nbsp;I'd&nbsp;rather&nbsp;provide&nbsp;a&nbsp;Python&nbsp;3&nbsp;port&nbsp;that&nbsp;actually&nbsp;implements&nbsp;the&lt;br&nbsp;class=&quot;&quot;&gt;protocol,&nbsp;and&nbsp;then&nbsp;work&nbsp;out&nbsp;a&nbsp;nice&nbsp;recoding&nbsp;API.&lt;br&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;Thanks&nbsp;for&nbsp;taking&nbsp;the&nbsp;time&nbsp;to&nbsp;talk&nbsp;through&nbsp;this.&nbsp;&nbsp;I&nbsp;appreciate&nbsp;it!&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Sorry&nbsp;to&nbsp;say&nbsp;my&nbsp;final&nbsp;call&nbsp;(as&nbsp;backed&nbsp;up&nbsp;by&nbsp;Amber,&nbsp;apropos&nbsp;of&nbsp;our&nbsp;earlier&nbsp;IRC&nbsp;conversation&nbsp;(WHICH&nbsp;I&nbsp;SHOULD&nbsp;NOTE&nbsp;WAS&nbsp;CONDUCTED&nbsp;USING&nbsp;UTF-8&nbsp;TEXT!!!))&nbsp;is&nbsp;not&nbsp;to&nbsp;act&nbsp;on&nbsp;the&nbsp;revert.&nbsp;&nbsp;But&nbsp;you&nbsp;raise&nbsp;many&nbsp;valid&nbsp;issues&nbsp;and&nbsp;I&nbsp;hope&nbsp;that&nbsp;we&nbsp;can&nbsp;get&nbsp;those&nbsp;nailed&nbsp;by&nbsp;the&nbsp;next&nbsp;release&nbsp;as&nbsp;just&nbsp;regular&nbsp;old&nbsp;bugfixes&nbsp;:).&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;has&nbsp;been&nbsp;a&nbsp;great&nbsp;conversation&nbsp;though,&nbsp;I&nbsp;hope&nbsp;we&nbsp;can&nbsp;have&nbsp;more&nbsp;like&nbsp;it&nbsp;on&nbsp;the&nbsp;mailing&nbsp;list&nbsp;:).&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;-glyph&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
