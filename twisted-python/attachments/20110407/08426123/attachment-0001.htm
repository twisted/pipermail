<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Apr&nbsp;7,&nbsp;2011,&nbsp;at&nbsp;12:06&nbsp;AM,&nbsp;Phil&nbsp;Christensen&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;On&nbsp;Apr&nbsp;6,&nbsp;2011,&nbsp;at&nbsp;8:35&nbsp;PM,&nbsp;Stephen&nbsp;Thorne&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;For&nbsp;your&nbsp;consideration,&nbsp;and&nbsp;(constructive)&nbsp;critcism,&nbsp;here&nbsp;is&nbsp;a&nbsp;twisted&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;plugin&nbsp;that&nbsp;is&nbsp;nearly&nbsp;identical&nbsp;to&nbsp;6&nbsp;that&nbsp;I&nbsp;have&nbsp;running&nbsp;in&nbsp;&amp;nbsp;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;production:&lt;br&gt;&lt;/blockquote&gt;[snip]&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;serviceMaker&nbsp;=&nbsp;ExampleServiceMaker()&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;From&nbsp;these&nbsp;19&nbsp;lines&nbsp;of&nbsp;code&nbsp;there&nbsp;are&nbsp;4&nbsp;things&nbsp;that&nbsp;are&nbsp;relevent:&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;tapname&nbsp;=&nbsp;example&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;description&nbsp;=&nbsp;'Example&nbsp;Twistd&nbsp;Plugin'&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;options&nbsp;=&nbsp;{'debug':True}&nbsp;if&nbsp;args&nbsp;==&nbsp;['--debug']&nbsp;else&nbsp;{'debug':False}&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;service&nbsp;=&nbsp;examplepackage.examplemodule.make_service(**options)&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Only&nbsp;2&nbsp;of&nbsp;which&nbsp;are&nbsp;relevent&nbsp;for&nbsp;running&nbsp;a&nbsp;twistd&nbsp;daemon&nbsp;other&nbsp;than&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;'example'&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;So&nbsp;the&nbsp;goal&nbsp;of&nbsp;my&nbsp;post&nbsp;to&nbsp;this&nbsp;mailing&nbsp;list&nbsp;is:&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;*&nbsp;I&nbsp;would&nbsp;like&nbsp;glyph's&nbsp;goal&nbsp;of&nbsp;having&nbsp;less&nbsp;arbitary&nbsp;code&nbsp;executed&nbsp;at&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&nbsp;twistd&nbsp;launch&nbsp;time&nbsp;to&nbsp;become&nbsp;a&nbsp;realisation,&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Makes&nbsp;sense.&nbsp;My&nbsp;first&nbsp;inclination&nbsp;is&nbsp;to&nbsp;suggest&nbsp;creating&nbsp;metadata&nbsp;&amp;nbsp;&lt;br&gt;files&nbsp;that&nbsp;are&nbsp;found&nbsp;via&nbsp;pkg_resources.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;already&nbsp;use&nbsp;a&nbsp;similar&nbsp;mechanism,&nbsp;twisted.python.modules,&nbsp;which&nbsp;uses&nbsp;the&nbsp;same&nbsp;underlying&nbsp;standards&nbsp;as&nbsp;pkg_resources&nbsp;(PEP&nbsp;302)&nbsp;but&nbsp;is&nbsp;somewhat&nbsp;more&nbsp;flexible.&nbsp;&amp;nbsp;And&nbsp;we&nbsp;create&nbsp;a&nbsp;metadata&nbsp;file&nbsp;(dropin.cache)&nbsp;which&nbsp;is&nbsp;stored&nbsp;and&nbsp;retrieved&nbsp;using&nbsp;this&nbsp;mechanism.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;*&nbsp;The&nbsp;entire&nbsp;task&nbsp;of&nbsp;having&nbsp;this&nbsp;python&nbsp;plugin&nbsp;is&nbsp;to&nbsp;link&nbsp;up&nbsp;the&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&nbsp;metadata&nbsp;with&nbsp;a&nbsp;more&nbsp;or&nbsp;less&nbsp;standard&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Not&nbsp;sure&nbsp;if&nbsp;I&nbsp;get&nbsp;this&nbsp;part.&nbsp;I&nbsp;tend&nbsp;to&nbsp;think&nbsp;of&nbsp;plugins&nbsp;as&nbsp;the&nbsp;service&nbsp;&amp;nbsp;&lt;br&gt;bootstrap&nbsp;file,&nbsp;like&nbsp;an&nbsp;int&nbsp;main().&nbsp;I&nbsp;would&nbsp;probably&nbsp;*not*&nbsp;be&nbsp;into&nbsp;the&nbsp;&amp;nbsp;&lt;br&gt;idea&nbsp;of&nbsp;passing&nbsp;sys.argv&nbsp;directly&nbsp;to&nbsp;a&nbsp;service,&nbsp;for&nbsp;example.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Why&nbsp;not?&nbsp;&amp;nbsp;It's&nbsp;just&nbsp;a&nbsp;list&nbsp;of&nbsp;strings.&nbsp;&amp;nbsp;You&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;deal&nbsp;with&nbsp;it&nbsp;how&nbsp;you&nbsp;like.&nbsp;&amp;nbsp;(But&nbsp;as&nbsp;I&nbsp;said&nbsp;in&nbsp;a&nbsp;previous&nbsp;message:&nbsp;this&nbsp;is&nbsp;a&nbsp;separate&nbsp;issue.)&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;*&nbsp;It's&nbsp;very&nbsp;easy&nbsp;to&nbsp;accidentally&nbsp;make&nbsp;your&nbsp;plugin&nbsp;load&nbsp;your&nbsp;package&nbsp;&amp;nbsp;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;for&amp;nbsp;every&nbsp;other&nbsp;twistd&nbsp;daemon&nbsp;running&nbsp;out&nbsp;of&nbsp;the&nbsp;same&nbsp;plugin&nbsp;cache.&lt;/blockquote&gt;&lt;br&gt;Never&nbsp;had&nbsp;this&nbsp;happen,&nbsp;but&nbsp;I&nbsp;think&nbsp;I&nbsp;can&nbsp;see&nbsp;where&nbsp;it&nbsp;might.&nbsp;It&nbsp;would&nbsp;&amp;nbsp;&lt;br&gt;be&nbsp;solved&nbsp;by&nbsp;some&nbsp;kind&nbsp;of&nbsp;external&nbsp;metadata,&nbsp;though,&nbsp;right?&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;already&nbsp;is&nbsp;solved&nbsp;by&nbsp;the&nbsp;external&nbsp;metadata...&nbsp;sort&nbsp;of.&nbsp;&amp;nbsp;If&nbsp;you&nbsp;look&nbsp;at&nbsp;the&nbsp;implementation&nbsp;of&nbsp;CachedPlugin,&nbsp;you&nbsp;can&nbsp;see&nbsp;that&nbsp;it&nbsp;actually&nbsp;already&nbsp;has&nbsp;a&nbsp;name&nbsp;and&nbsp;description!&nbsp;&amp;nbsp;There&nbsp;are&nbsp;two&nbsp;problems&nbsp;though:&nbsp;first&nbsp;is&nbsp;that&nbsp;this&nbsp;is&nbsp;hard-coded&nbsp;to&nbsp;be&nbsp;the&nbsp;module's&nbsp;name&nbsp;and&nbsp;docstring,&nbsp;but&nbsp;more&nbsp;importantly,&nbsp;there's&nbsp;just&nbsp;no&nbsp;way&nbsp;to&nbsp;get&nbsp;at&nbsp;those&nbsp;attributes&nbsp;via&nbsp;the&nbsp;getPlugin&nbsp;interface,&nbsp;which&nbsp;implicitly&nbsp;invokes&nbsp;'__conform__'&nbsp;via&nbsp;adaptation&nbsp;(and&nbsp;therefore&nbsp;load()).&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;*&nbsp;The&nbsp;practice&nbsp;of&nbsp;putting&nbsp;a&nbsp;module&nbsp;under&nbsp;twisted/plugins/&amp;nbsp;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;$mymodulehere.py&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&nbsp;upsets&nbsp;my&nbsp;equilibrium,&nbsp;the&nbsp;only&nbsp;reason&nbsp;I&nbsp;tolerate&nbsp;this&nbsp;kind&nbsp;of&nbsp;thing&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&nbsp;is&nbsp;that&nbsp;I&nbsp;install&nbsp;my&nbsp;python&nbsp;code&nbsp;via&nbsp;rpms&nbsp;and&nbsp;I&nbsp;automatically&nbsp;get&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&nbsp;installation,&nbsp;ownership&nbsp;and&nbsp;uninstallation&nbsp;done&nbsp;in&nbsp;a&nbsp;stable&nbsp;manner.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;The&nbsp;only&nbsp;issue&nbsp;I've&nbsp;found&nbsp;with&nbsp;this&nbsp;is&nbsp;the&nbsp;issue&nbsp;of&nbsp;having&nbsp;to&nbsp;create&nbsp;&amp;nbsp;&lt;br&gt;plugin&nbsp;cache&nbsp;files.&nbsp;Apart&nbsp;from&nbsp;the&nbsp;spurious&nbsp;error&nbsp;messages&nbsp;that&nbsp;were&nbsp;&amp;nbsp;&lt;br&gt;(partially?)&nbsp;covered&nbsp;at&nbsp;the&nbsp;sprint&nbsp;recently,&nbsp;the&nbsp;benefit&nbsp;they&nbsp;provide&nbsp;&amp;nbsp;&lt;br&gt;is&nbsp;definitely&nbsp;negated&nbsp;by&nbsp;bad&nbsp;permissions.&nbsp;I've&nbsp;done&nbsp;some&nbsp;acrobatics&nbsp;&amp;nbsp;&lt;br&gt;inside&nbsp;my&nbsp;setup.py&nbsp;to&nbsp;make&nbsp;it&nbsp;work,&nbsp;but&nbsp;it&nbsp;involves&nbsp;different&nbsp;steps&nbsp;&amp;nbsp;&lt;br&gt;depending&nbsp;on&nbsp;whether&nbsp;you're&nbsp;installing&nbsp;or&nbsp;building&nbsp;a&nbsp;package.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;is&nbsp;&quot;this&nbsp;kind&nbsp;of&nbsp;thing&quot;,&nbsp;though?&nbsp;&amp;nbsp;The&nbsp;plugins&nbsp;have&nbsp;to&nbsp;go&nbsp;in&nbsp;some&nbsp;defined&nbsp;namespace&nbsp;in&nbsp;order&nbsp;to&nbsp;be&nbsp;enumerated.&nbsp;&amp;nbsp;Even&nbsp;if&nbsp;we&nbsp;were&nbsp;to&nbsp;implement&nbsp;something&nbsp;based&nbsp;on&nbsp;purely&nbsp;static&nbsp;metadata,&nbsp;you'd&nbsp;still&nbsp;have&nbsp;to&nbsp;list&nbsp;a&nbsp;directory&nbsp;to&nbsp;get&nbsp;at&nbsp;that&nbsp;metadata.&nbsp;&amp;nbsp;Making&nbsp;the&nbsp;namespace&nbsp;be&nbsp;owned&nbsp;by&nbsp;the&nbsp;module&nbsp;doing&nbsp;the&nbsp;importing&nbsp;makes&nbsp;sense.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;what&nbsp;it's&nbsp;worth,&nbsp;bzrlib&nbsp;does&nbsp;this&nbsp;too,&nbsp;but&nbsp;by&nbsp;convention&nbsp;in&nbsp;a&nbsp;bzr&nbsp;plugin&nbsp;you&nbsp;put&nbsp;_all_&nbsp;your&nbsp;code&nbsp;into&nbsp;bzrlib/plugins/foo/*.py,&nbsp;and&nbsp;your&nbsp;package&nbsp;is&nbsp;bzrlib.plugins.foo.&nbsp;&amp;nbsp;(This&nbsp;will&nbsp;work&nbsp;fine&nbsp;with&nbsp;Twisted&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;do&nbsp;it&nbsp;that&nbsp;way.)&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;Still,&nbsp;it&nbsp;seems&nbsp;like&nbsp;most&nbsp;of&nbsp;their&nbsp;necessity&nbsp;would&nbsp;be&nbsp;negated&nbsp;by&nbsp;using&nbsp;&amp;nbsp;&lt;br&gt;external&nbsp;metadata&nbsp;files.&nbsp;It&nbsp;seems&nbsp;to&nbsp;be&nbsp;the&nbsp;way&nbsp;most&nbsp;plugin&nbsp;systems&nbsp;&amp;nbsp;&lt;br&gt;end&nbsp;up&nbsp;going&nbsp;in&nbsp;some&nbsp;way&nbsp;or&nbsp;another.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;dropin.cache&nbsp;is&nbsp;an&nbsp;external&nbsp;metadata&nbsp;file&nbsp;;-).&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;Anyways,&nbsp;that's&nbsp;just&nbsp;my&nbsp;2/100ths.&nbsp;I'm&nbsp;pretty&nbsp;happy&nbsp;with&nbsp;most&nbsp;of&nbsp;the&nbsp;&amp;nbsp;&lt;br&gt;plugin&nbsp;model,&nbsp;but&nbsp;I&nbsp;think&nbsp;there's&nbsp;a&nbsp;lot&nbsp;of&nbsp;room&nbsp;for&nbsp;improvement,&nbsp;&amp;nbsp;&lt;br&gt;particularly&nbsp;in&nbsp;the&nbsp;area&nbsp;of&nbsp;dropin.cache&nbsp;files.&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#144FAE&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;feedback.&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
