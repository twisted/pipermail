<tt>
&lt;html&gt;&lt;body&gt;&lt;br&nbsp;/&gt;On&nbsp;05:58&nbsp;pm,&nbsp;bradley.s.gaspard@saic.com&nbsp;wrote:&lt;br&nbsp;/&gt;&gt;&lt;br&nbsp;/&gt;&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;write&nbsp;a&nbsp;TCP&nbsp;client&nbsp;that&nbsp;at&nbsp;regular&nbsp;intervals&nbsp;connects&nbsp;to&nbsp;a&nbsp;server&nbsp;makes&nbsp;a&nbsp;request&nbsp;and&nbsp;then&nbsp;closes&nbsp;the&nbsp;connection.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Your&nbsp;code&nbsp;has&nbsp;a&nbsp;fatal&nbsp;problem.&nbsp;&#160;Nowhere&nbsp;are&nbsp;you&nbsp;actually&nbsp;creating&nbsp;a&nbsp;client&nbsp;connection,&nbsp;you're&nbsp;just&nbsp;creating&nbsp;protocol&nbsp;objects&nbsp;and&nbsp;not&nbsp;hooking&nbsp;them&nbsp;up&nbsp;to&nbsp;anything!&nbsp;&#160;I've&nbsp;whipped&nbsp;up&nbsp;a&nbsp;quick&nbsp;periodic&nbsp;ping/pong&nbsp;client/server&nbsp;pair&nbsp;for&nbsp;you&nbsp;here,&nbsp;which&nbsp;should&nbsp;provide&nbsp;a&nbsp;useful&nbsp;starting&nbsp;point&nbsp;for&nbsp;you.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;The&nbsp;key&nbsp;thing&nbsp;is&nbsp;the&nbsp;call&nbsp;to&nbsp;the&nbsp;ClientCreator's&nbsp;'connectTCP'&nbsp;method,&nbsp;which&nbsp;actually&nbsp;hooks&nbsp;up&nbsp;an&nbsp;instantiated&nbsp;PingSender&nbsp;to&nbsp;a&nbsp;socket.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;--------&nbsp;cut&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;Protocol,&nbsp;ClientCreator,&nbsp;Factory&lt;br&nbsp;/&gt;from&nbsp;twisted.internet.task&nbsp;import&nbsp;LoopingCall&lt;br&nbsp;/&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;class&nbsp;PingResponder(Protocol):&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;buf&nbsp;=&nbsp;''&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;self.buf&nbsp;+=&nbsp;data&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;if&nbsp;self.buf&nbsp;==&nbsp;'PING':&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;print&nbsp;'PONGED!'&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;self.transport.write('PONG')&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;self.transport.loseConnection()&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;class&nbsp;PingSender(Protocol):&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;buf&nbsp;=&nbsp;''&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;def&nbsp;connectionMade(self):&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;self.transport.write(&quot;PING&quot;)&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;self.buf&nbsp;+=&nbsp;data&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;def&nbsp;connectionLost(self,&nbsp;reason):&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;print&nbsp;&quot;PONGED&nbsp;WITH:&nbsp;&quot;&nbsp;+self.buf&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;def&nbsp;client():&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;cc&nbsp;=&nbsp;ClientCreator(reactor,&nbsp;PingSender)&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;def&nbsp;dontDelay():&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;&#160;&nbsp;cc.connectTCP('localhost',&nbsp;4321)&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;lc&nbsp;=&nbsp;LoopingCall(dontDelay)&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;lc.start(0.5)&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;def&nbsp;server():&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;pf&nbsp;=&nbsp;Factory()&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;pf.protocol&nbsp;=&nbsp;PingResponder&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;svr&nbsp;=&nbsp;reactor.listenTCP(4321,&nbsp;pf)&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;import&nbsp;sys&lt;br&nbsp;/&gt;if&nbsp;sys.argv[1]&nbsp;==&nbsp;'client':&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;client()&lt;br&nbsp;/&gt;else:&lt;br&nbsp;/&gt;&#160;&nbsp;&#160;&nbsp;server()&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;reactor.run()&lt;br&nbsp;/&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
