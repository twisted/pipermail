<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;By&nbsp;the&nbsp;way,&nbsp;I&nbsp;don&#39;t&nbsp;need&nbsp;any&nbsp;of&nbsp;this&nbsp;to&nbsp;make&nbsp;its&nbsp;way&nbsp;into&nbsp;Twisted.&nbsp;I&nbsp;can&nbsp;still&nbsp;write&nbsp;my&nbsp;own&nbsp;class&nbsp;that&nbsp;does&nbsp;what&nbsp;I&nbsp;want&nbsp;(well,&nbsp;wanted).&nbsp; Below&nbsp;is&nbsp;a&nbsp;2013&nbsp;version&nbsp;of&nbsp;the&nbsp; CancelableDeferred.&nbsp;It&#39;s&nbsp;untested.&nbsp;The&nbsp;basic&nbsp;idea&nbsp;is&nbsp;that&nbsp;if&nbsp;you&nbsp;get&nbsp;a&nbsp;regular&nbsp;deferred&nbsp;from&nbsp;somewhere,&nbsp;you&nbsp;can&nbsp;use&nbsp;the&nbsp;class&nbsp;below&nbsp;to&nbsp;make&nbsp;a&nbsp;new&nbsp;deferred&nbsp;that&nbsp;you&nbsp;can&nbsp;callback,&nbsp;errback,&nbsp;or&nbsp;cancel&nbsp;at&nbsp;will.&nbsp;You&nbsp;can&nbsp;give&nbsp;a&nbsp;value&nbsp;to&nbsp;&#39;cancel&#39;&nbsp;and&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;args[0]&nbsp;of&nbsp;the&nbsp;CancelledError&nbsp;that&nbsp;your&nbsp;errback&nbsp;will&nbsp;receive.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;still&nbsp;find&nbsp;this&nbsp;approach&nbsp;attractive&nbsp;because&nbsp;it&nbsp;maintains&nbsp;the&nbsp;power/elegance&nbsp;of&nbsp;coding&nbsp;with&nbsp;Twisted&nbsp;deferreds&nbsp;but&nbsp;also&nbsp;gives&nbsp;the&nbsp;caller&nbsp;of&nbsp;deferred-producing&nbsp;code&nbsp;more&nbsp;flexibility.&nbsp;That&#39;s&nbsp;got&nbsp;to&nbsp;be&nbsp;a&nbsp;good&nbsp;thing,&nbsp;right?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;hope&nbsp;the&nbsp;code&nbsp;makes&nbsp;the&nbsp;intention&nbsp;more&nbsp;clear,&nbsp;not&nbsp;less.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Terry&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;from&nbsp;twisted.internet.defer&nbsp;import&nbsp;CancelledError,&nbsp;Deferred&lt;/div&gt;<br>
&lt;div&gt;from&nbsp;twisted.python.failure&nbsp;import&nbsp;Failure&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;class&nbsp;ControllableDeferred2013(object):&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;&#39;&#39;&#39;A&nbsp;Deferred-like&nbsp;class&nbsp;that&nbsp;takes&nbsp;a&nbsp;regular&nbsp;Twisted&nbsp;Deferred&nbsp;and&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;provides&nbsp;a&nbsp;deferred&nbsp;that&nbsp;can&nbsp;be&nbsp;fired&nbsp;at&nbsp;will.&nbsp;If&nbsp;you&nbsp;have&nbsp;a&nbsp;regular&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;Twisted&nbsp;Deferred,&nbsp;you&nbsp;can&nbsp;produce&nbsp;a&nbsp;deferred&nbsp;you&nbsp;have&nbsp;more&nbsp;control&nbsp;over&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;by&nbsp;using&nbsp;your&nbsp;Deferred&nbsp;instance&nbsp;to&nbsp;make&nbsp;an&nbsp;instance&nbsp;of&nbsp;this&nbsp;class.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;Any&nbsp;time&nbsp;you&nbsp;need&nbsp;to&nbsp;fire&nbsp;a&nbsp;ControllableDeferred2013&nbsp;instance&nbsp;for&nbsp;any&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;reason,&nbsp;call&nbsp;its&nbsp;callback,&nbsp;errback&nbsp;or&nbsp;cancel&nbsp;method.&nbsp;It&nbsp;will&nbsp;fire&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;immediately&nbsp;with&nbsp;the&nbsp;value&nbsp;you&nbsp;provide&nbsp;and&nbsp;the&nbsp;original&nbsp;Deferred&nbsp;will&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;be&nbsp;cancelled.&#39;&#39;&#39;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;__init__(self,&nbsp;originalDeferred):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;self._fired&nbsp;=&nbsp;False&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;self._originalDeferred&nbsp;=&nbsp;originalDeferred&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;self._newDeferred&nbsp;=&nbsp;Deferred()&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;for&nbsp;method&nbsp;in&nbsp;(&#39;addBoth&#39;,&nbsp;&#39;addCallback&#39;,&nbsp;&#39;addCallbacks&#39;,&nbsp;&#39;addErrback&#39;,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;chainDeferred&#39;):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setattr(self,&nbsp;method,&nbsp;getattr(self._newDeferred,&nbsp;method))&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;originalDeferred.addBoth(self._originalFired)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;_originalFired(self,&nbsp;result):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;not&nbsp;self._fired:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._fired&nbsp;=&nbsp;True&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._originalDeferred.chainDeferred(self._newDeferred)&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;cancel(self,&nbsp;value=None):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;not&nbsp;self._fired:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._fired&nbsp;=&nbsp;True&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._newDeferred.errback(Failure(CancelledError(value)))&lt;/div&gt;&lt;div&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._originalDeferred.cancel()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;callback(self,&nbsp;result=None):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;not&nbsp;self._fired:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._fired&nbsp;=&nbsp;True&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._newDeferred.callback(result)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._originalDeferred.cancel()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;errback(self,&nbsp;fail=None):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;not&nbsp;self._fired:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._fired&nbsp;=&nbsp;True&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._newDeferred.errback(fail)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self._originalDeferred.cancel()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;pause(self):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;self._newDeferred.pause()&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;self._originalDeferred.pause()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;unpause(self):&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;self._newDeferred.unpause()&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;self._originalDeferred.unpause()&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;BTW,&nbsp;I&nbsp;posted&nbsp;the&nbsp;above&nbsp;code&nbsp;to &lt;a&nbsp;href=&quot;http://blogs.fluidinfo.com/terry/2013/06/20/yet-another-cancelable-twisted-deferred-class/&quot;&gt;http://blogs.fluidinfo.com/terry/2013/06/20/yet-another-cancelable-twisted-deferred-class/&lt;/a&gt;&nbsp;as&nbsp;well.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
