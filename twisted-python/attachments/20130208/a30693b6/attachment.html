<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;can&#39;t&nbsp;figure&nbsp;out&nbsp;how&nbsp;to&nbsp;use&nbsp;Perspective&nbsp;broker&nbsp;over&nbsp;stdio.&nbsp;Say&nbsp;I&nbsp;have&nbsp;file&nbsp;`child.py`:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;----&lt;/div&gt;&lt;div&gt;&lt;div&gt;from&nbsp;twisted.internet.endpoints&nbsp;import&nbsp;StandardIOEndpoint&lt;/div&gt;<br>
<br>
&lt;div&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.spread&nbsp;import&nbsp;pb&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;class&nbsp;Foo(pb.Root):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;remote_do_smth(self):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;pass&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;def&nbsp;main():&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;endpoint&nbsp;=&nbsp;StandardIOEndpoint(reactor)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;f&nbsp;=&nbsp;pb.PBServerFactory(Foo())&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;endpoint.listen(f)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;reactor.run()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp;main()&lt;/div&gt;&lt;/div&gt;&lt;div&gt;----&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Then&nbsp;say&nbsp;I&nbsp;have&nbsp;`main.py`:&lt;/div&gt;&lt;div&nbsp;style&gt;----&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;div&gt;import&nbsp;sys&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.spread&nbsp;import&nbsp;pb&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;cb(o):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;d&nbsp;=&nbsp;o.callRemote(&quot;do_smth&quot;)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;return&nbsp;d&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;main():&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;exe&nbsp;=&nbsp;sys.executable&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;args&nbsp;=&nbsp;[exe,&nbsp;&#39;/path/to/child.py&#39;]&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;factory&nbsp;=&nbsp;pb.PBClientFactory()&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;#&nbsp;now&nbsp;what?&nbsp;The&nbsp;below&nbsp;is&nbsp;a&nbsp;wrong&nbsp;way&nbsp;to&nbsp;create&nbsp;protocol. &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;#&nbsp;But&nbsp;how&nbsp;do&nbsp;I&nbsp;do&nbsp;this?&lt;/div&gt;&lt;div&nbsp;style&gt; &nbsp; &nbsp;proto&nbsp;=&nbsp;factory.buildProtocol((&#39;foo&#39;,))&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;reactor.spawnProcess(proto,&nbsp;exe,&nbsp;args)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp;d&nbsp;=&nbsp;factory.getRootObject()&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;d.addCallback(cb)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;d.addCallback(lambda&nbsp;_:&nbsp;reactor.stop())&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;reactor.run()&lt;/div&gt;&lt;div&gt; &nbsp;  &lt;/div&gt;&lt;div&gt;if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;main()&lt;/div&gt;&lt;div&gt;----&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;How&nbsp;do&nbsp;I&nbsp;spawn&nbsp;`child.py`&nbsp;from&nbsp;a&nbsp;parent&nbsp;process,&nbsp;such&nbsp;that&nbsp;the&nbsp;parent&nbsp;can&nbsp;retrieve&nbsp;the&nbsp;root&nbsp;object&nbsp;and&nbsp;call&nbsp;methods&nbsp;on&nbsp;it?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;code&nbsp;above&nbsp;throws&nbsp;errors:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://pastebin.com/7TiZdDVc&quot;&gt;http://pastebin.com/7TiZdDVc&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;in&nbsp;advance.&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
--&nbsp;&lt;br&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Regards,&lt;br&gt;Maxim&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
