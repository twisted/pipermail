<tt>
Instead&nbsp;of&nbsp;trying&nbsp;to&nbsp;keep&nbsp;the&nbsp;connection&nbsp;alive&nbsp;you&nbsp;can&nbsp;also&nbsp;just&nbsp;reconnect&nbsp;when&nbsp;necessary.&nbsp;Example&nbsp;code&nbsp;here:&nbsp;&lt;a&nbsp;href=&quot;http://stackoverflow.com/questions/207981/how-to-enable-mysql-client-auto-re-connect-with-mysqldb/982873#982873&quot;&gt;http://stackoverflow.com/questions/207981/how-to-enable-mysql-client-auto-re-connect-with-mysqldb/982873#982873&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jul&nbsp;21,&nbsp;2009&nbsp;at&nbsp;2:18&nbsp;PM,&nbsp;Clay&nbsp;Gerrard&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:clay.gerrard@rackspace.com&quot;&gt;clay.gerrard@rackspace.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
Regarding&nbsp;the&nbsp;original&nbsp;question:&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&quot;how&nbsp;to&nbsp;make&nbsp;mysql&#39;s&nbsp;idle&nbsp;timeouts&nbsp;shorter&nbsp;so&nbsp;that&nbsp;I&nbsp;can&nbsp;debug&nbsp;my&nbsp;code?&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;You&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;do&nbsp;that&nbsp;in&nbsp;the&nbsp;mysql&nbsp;shell:&lt;br&gt;<br>
mysql&gt;&nbsp;show&nbsp;variables&nbsp;like&nbsp;&#39;%timeout%&#39;;&lt;br&gt;<br>
+----------------------------+-------+&lt;br&gt;<br>
|&nbsp;Variable_name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;Value&nbsp;|&lt;br&gt;<br>
+----------------------------+-------+&lt;br&gt;<br>
|&nbsp;connect_timeout&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;5&nbsp; &nbsp; &nbsp;|&lt;br&gt;<br>
|&nbsp;delayed_insert_timeout&nbsp; &nbsp; &nbsp;|&nbsp;300&nbsp; &nbsp;|&lt;br&gt;<br>
|&nbsp;innodb_lock_wait_timeout&nbsp; &nbsp;|&nbsp;50&nbsp; &nbsp; |&lt;br&gt;<br>
|&nbsp;innodb_rollback_on_timeout&nbsp;|&nbsp;OFF&nbsp; &nbsp;|&lt;br&gt;<br>
|&nbsp;interactive_timeout&nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;600&nbsp; &nbsp;|&lt;br&gt;<br>
|&nbsp;net_read_timeout&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;30&nbsp; &nbsp; |&lt;br&gt;<br>
|&nbsp;net_write_timeout&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;60&nbsp; &nbsp; |&lt;br&gt;<br>
|&nbsp;slave_net_timeout&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp;3600&nbsp; |&lt;br&gt;<br>
|&nbsp;table_lock_wait_timeout&nbsp; &nbsp; |&nbsp;50&nbsp; &nbsp; |&lt;br&gt;<br>
|&nbsp;wait_timeout&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;600&nbsp; &nbsp;|&lt;br&gt;<br>
+----------------------------+-------+&lt;br&gt;<br>
10&nbsp;rows&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;set&nbsp;global&nbsp;variable&nbsp;interactive_timeout&nbsp;=&nbsp;5;&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;in&nbsp;my&nbsp;experience&nbsp;MySQLdb&nbsp;makes&nbsp;the&nbsp;idle&nbsp;connection&nbsp;timeout&nbsp;very&nbsp;difficult&nbsp;to&nbsp;debug&nbsp;effectively.&lt;br&gt;<br>
&lt;br&gt;<br>
Will&nbsp;twisted.adbapi.ConnectionPool&nbsp;ever&nbsp;offer&nbsp;a&nbsp;pool_recycle&nbsp;kw&nbsp;like&nbsp;sqlalchemy?&lt;br&gt;<br>
&lt;br&gt;<br>
Clay&nbsp;Gerrard&lt;br&gt;<br>
Office:&nbsp;210-312-3443&lt;br&gt;<br>
Mobile:&nbsp;210-788-9431&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;-----Original&nbsp;Message-----&lt;br&gt;<br>
From:&nbsp;&lt;a&nbsp;href=&quot;mailto:twisted-python-bounces@twistedmatrix.com&quot;&gt;twisted-python-bounces@twistedmatrix.com&lt;/a&gt;&nbsp;[mailto:&lt;a&nbsp;href=&quot;mailto:twisted-python-bounces@twistedmatrix.com&quot;&gt;twisted-python-bounces@twistedmatrix.com&lt;/a&gt;]&nbsp;On&nbsp;Behalf&nbsp;Of&nbsp;Werner&nbsp;Thie&lt;br&gt;<br>
<br>
<br>
Sent:&nbsp;Tuesday,&nbsp;July&nbsp;21,&nbsp;2009&nbsp;4:05&nbsp;PM&lt;br&gt;<br>
To:&nbsp;Twisted&nbsp;general&nbsp;discussion&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[Twisted-Python]&nbsp;OT&nbsp;-&nbsp;adbapi,&nbsp;connection&nbsp;timeouts,&nbsp;mysql&nbsp;-&nbsp;OT&lt;br&gt;<br>
&lt;br&gt;<br>
Hi&nbsp;Gabriel&lt;br&gt;<br>
&lt;br&gt;<br>
had&nbsp;the&nbsp;same&nbsp;problem,&nbsp;solved&nbsp;it&nbsp;by&nbsp;having&nbsp;keepalive()&nbsp;called&nbsp;in&nbsp;a&lt;br&gt;<br>
LoopingCall(),&nbsp;MySQL&nbsp;sitting&nbsp;at&nbsp;defaults&nbsp;timingwise.&lt;br&gt;<br>
&lt;br&gt;<br>
DB_DRIVER&nbsp;=&nbsp;&quot;MySQLdb&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
USERDB_ARGS&nbsp;=&nbsp;{&lt;br&gt;<br>
&nbsp; &nbsp;&#39;host&#39;:&nbsp;&#39;&#39;,&lt;br&gt;<br>
&nbsp; &nbsp;&#39;db&#39;:&nbsp;&#39;&#39;,&lt;br&gt;<br>
&nbsp; &nbsp;&#39;user&#39;:&nbsp;&#39;&#39;,&lt;br&gt;<br>
&nbsp; &nbsp;&#39;passwd&#39;:&nbsp;&#39;&#39;,&lt;br&gt;<br>
&nbsp; &nbsp;&#39;cp_reconnect&#39;:&nbsp;True&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
storekeeper&nbsp;=&nbsp;StoreKeeper(DB_DRIVER,&nbsp;**USERDB_ARGS)&lt;br&gt;<br>
&lt;br&gt;<br>
ka&nbsp;=&nbsp;task.LoopingCall(storekeeper.store.keepAlive)&lt;br&gt;<br>
ka.start(300)&lt;br&gt;<br>
&lt;br&gt;<br>
class&nbsp;StoreKeeper(object):&lt;br&gt;<br>
&nbsp; &nbsp;def&nbsp;__init__(self,&nbsp;dbapiName,&nbsp;**params):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;self.store&nbsp;=&nbsp;Store(dbapiName,&nbsp;**params)&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp;def&nbsp;dbdisconn(self,&nbsp;reason):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;print&nbsp;&#39;db&nbsp;disconnected&nbsp;for&nbsp;&#39;,&nbsp;reason&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp;def&nbsp;keepAlive(self):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;d&nbsp;=&nbsp;self.store.runQuery(&#39;SELECT&nbsp;1&#39;)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;d.addErrback(self.dbdisconn)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
#with&nbsp;store&nbsp;being&nbsp;something&nbsp;like:&lt;br&gt;<br>
&lt;br&gt;<br>
class&nbsp;Store(object):&lt;br&gt;<br>
&nbsp; &nbsp;def&nbsp;__init__(self,&nbsp;dbapiName,&nbsp;**params):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;self.__pool&nbsp; &nbsp;=&nbsp;adbapi.ConnectionPool(dbapiName,&nbsp;**params)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;print&nbsp;self.__pool.__getstate__()&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;self.runOperation(&#39;SET&nbsp;autocommit&nbsp;=&nbsp;%s&#39;,&nbsp;1)&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp;def&nbsp;runQuery(self,&nbsp;query,&nbsp;*args):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;d&nbsp;=&nbsp;self.__pool.runInteraction(self.mapQuery,&nbsp;query,&nbsp;args)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;return&nbsp;d&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp;def&nbsp;mapQuery(self,&nbsp;curs,&nbsp;query,&nbsp;*args):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;try:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;curs.execute(query,&nbsp;*args)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;except&nbsp;adbapi.ConnectionLost:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;print&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;print&nbsp;&#39;++++++++++++&nbsp;rerunning&nbsp;query&#39;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;print&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;curs.execute(query,&nbsp;*args)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #simply&nbsp;resend&lt;br&gt;<br>
query,&nbsp;assuming&nbsp;cp_reconnect=True&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;result&nbsp;=&nbsp;curs.fetchall()&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;columns&nbsp;=&nbsp;[d[0]&nbsp;for&nbsp;d&nbsp;in&nbsp;curs.description]&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;return&nbsp;[dict(zip(columns,&nbsp;r))&nbsp;for&nbsp;r&nbsp;in&nbsp;result]&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp;def&nbsp;runOperation(self,&nbsp;query,&nbsp;*args):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;d&nbsp;=&nbsp;self.__pool.runOperation(query,&nbsp;args)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;return&nbsp;d&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp;def&nbsp;runInteraction(self,&nbsp;fun,&nbsp;queries=(),&nbsp;args=()):&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;d&nbsp;=&nbsp;self.__pool.runInteraction(fun,&nbsp;queries,&nbsp;args)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;return&nbsp;d&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
HTH,&nbsp;Werner&lt;br&gt;<br>
&lt;br&gt;<br>
Gabriel&nbsp;Rossetti&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hello&nbsp;everyone,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;been&nbsp;experiencing&nbsp;the&nbsp;ConnectionError&nbsp;with&nbsp;adbapi&nbsp;&amp;&lt;br&gt;<br>
&gt;&nbsp;cp_reconnect=True.&nbsp;I&nbsp;know&nbsp;that&nbsp;because&nbsp;of&nbsp;the&nbsp;cp_reconnect=True&nbsp;param&lt;br&gt;<br>
&gt;&nbsp;tha&nbsp;is&nbsp;reconnects&nbsp;and&nbsp;that&nbsp;the&nbsp;query&nbsp;is&nbsp;not&nbsp;re-run.&nbsp;I&nbsp;have&nbsp;written&nbsp;some&lt;br&gt;<br>
&gt;&nbsp;code&nbsp;that&nbsp;should&nbsp;re-run&nbsp;the&nbsp;query&nbsp;in&nbsp;that&nbsp;case&nbsp;(if&nbsp;I&nbsp;get&nbsp;a&nbsp;Failure&nbsp;back&lt;br&gt;<br>
&gt;&nbsp;because&nbsp;of&nbsp;a&nbsp;ConnectionError),&nbsp;but&nbsp;it&nbsp;doesn&#39;t&nbsp;seem&nbsp;to&nbsp;work.&nbsp;My&nbsp;question&lt;br&gt;<br>
&gt;&nbsp;is&nbsp;if&nbsp;anyone&nbsp;knows&nbsp;how&nbsp;to&nbsp;make&nbsp;mysql&#39;s&nbsp;idle&nbsp;timeouts&nbsp;shorter&nbsp;so&nbsp;that&nbsp;I&lt;br&gt;<br>
&gt;&nbsp;can&nbsp;debug&nbsp;my&nbsp;code?&nbsp;I&nbsp;searched&nbsp;google&nbsp;and&nbsp;the&nbsp;mysql&nbsp;site&nbsp;with&nbsp;no&nbsp;luck.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;thank&nbsp;you,&lt;br&gt;<br>
&gt;&nbsp;Gabriel&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;Confidentiality&nbsp;Notice:&nbsp;This&nbsp;e-mail&nbsp;message&nbsp;(including&nbsp;any&nbsp;attached&nbsp;or&lt;br&gt;<br>
embedded&nbsp;documents)&nbsp;is&nbsp;intended&nbsp;for&nbsp;the&nbsp;exclusive&nbsp;and&nbsp;confidential&nbsp;use&nbsp;of&nbsp;the&lt;br&gt;<br>
individual&nbsp;or&nbsp;entity&nbsp;to&nbsp;which&nbsp;this&nbsp;message&nbsp;is&nbsp;addressed,&nbsp;and&nbsp;unless&nbsp;otherwise&lt;br&gt;<br>
expressly&nbsp;indicated,&nbsp;is&nbsp;confidential&nbsp;and&nbsp;privileged&nbsp;information&nbsp;of&nbsp;Rackspace.&lt;br&gt;<br>
Any&nbsp;dissemination,&nbsp;distribution&nbsp;or&nbsp;copying&nbsp;of&nbsp;the&nbsp;enclosed&nbsp;material&nbsp;is&nbsp;prohibited.&lt;br&gt;<br>
If&nbsp;you&nbsp;receive&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;notify&nbsp;us&nbsp;immediately&nbsp;by&nbsp;e-mail&lt;br&gt;<br>
at&nbsp;&lt;a&nbsp;href=&quot;mailto:abuse@rackspace.com&quot;&gt;abuse@rackspace.com&lt;/a&gt;,&nbsp;and&nbsp;delete&nbsp;the&nbsp;original&nbsp;message.&lt;br&gt;<br>
Your&nbsp;cooperation&nbsp;is&nbsp;appreciated.&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
