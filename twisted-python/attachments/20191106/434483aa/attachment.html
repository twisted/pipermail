<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Marteen,&lt;br&gt;&lt;div&gt; &nbsp;Thanks&nbsp;for&nbsp;the&nbsp;response. &lt;/div&gt;&lt;div&gt;When&nbsp;you&nbsp;say&nbsp;&quot;when&nbsp;one&nbsp;process&nbsp;mutates&nbsp;the&nbsp;dictionary&nbsp;while&nbsp;another&nbsp;is&nbsp;looking&nbsp;up&nbsp;something&nbsp;or&nbsp;also&nbsp;mutating&nbsp;it.&quot; &nbsp;Do&nbsp;you&nbsp;mean&nbsp;that&nbsp;a&nbsp;key/value&nbsp;pair&nbsp;is&nbsp;getting&nbsp;modified&nbsp;or&nbsp;is&nbsp;it&nbsp;that&nbsp;a&nbsp;dict,&nbsp;in&nbsp;general,&nbsp;is&nbsp;getting&nbsp;modified.&lt;/div&gt;&lt;div&gt;The&nbsp;first&nbsp;one&nbsp;is&nbsp;not&nbsp;really&nbsp;a&nbsp;concern&nbsp;as&nbsp;the&nbsp;key&nbsp;to&nbsp;value&nbsp;mapping&nbsp;is&nbsp;unique(so&nbsp;all&nbsp;the&nbsp;processes&nbsp;will&nbsp;require&nbsp;the&nbsp;same&nbsp;value&nbsp;for&nbsp;same&nbsp;key).&nbsp;So&nbsp;read/write &nbsp;to&nbsp;dict&nbsp;doesnt&nbsp;really&nbsp;have&nbsp;to&nbsp;be&nbsp;&quot;threadsafe&quot;&nbsp;or&nbsp;anything&nbsp;like&nbsp;that.&lt;/div&gt;&lt;div&gt;But,&nbsp;dict&nbsp;getting&nbsp;modified&nbsp;and&nbsp;made&nbsp;available&nbsp;across&nbsp;rest&nbsp;of&nbsp;the&nbsp;processes&nbsp;will&nbsp;be&nbsp;common.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;thing&nbsp;is,&nbsp;the&nbsp;major&nbsp;cost&nbsp;of&nbsp;our&nbsp;task&nbsp;is&nbsp;I/O.&nbsp;So,&nbsp;when&nbsp;a&nbsp;request&nbsp;comes&nbsp;in&nbsp;we&nbsp;fetch&nbsp;some&nbsp;data&nbsp;and&nbsp;then&nbsp;cache&nbsp;it.&nbsp;Now,&nbsp;each&nbsp;processes&nbsp;has&nbsp;their&nbsp;own&nbsp;cache&nbsp;and&nbsp;that&nbsp;is&nbsp;very&nbsp;inefficient.&nbsp;One&nbsp;idea&nbsp;is&nbsp;to&nbsp;share&nbsp;the&nbsp;cache&nbsp;across&nbsp;processes. &lt;/div&gt;&lt;div&gt;Does&nbsp;that&nbsp;make&nbsp;sense?&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;help.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Wed,&nbsp;Nov&nbsp;6,&nbsp;2019&nbsp;at&nbsp;6:22&nbsp;AM&nbsp;Maarten&nbsp;ter&nbsp;Huurne&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:maarten@treewalker.org&quot;&gt;maarten@treewalker.org&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;On&nbsp;Wednesday,&nbsp;6&nbsp;November&nbsp;2019&nbsp;07:19:56&nbsp;CET&nbsp;Waqar&nbsp;Khan&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi,&lt;br&gt;<br>
&gt;&nbsp;So,&nbsp;I&nbsp;am&nbsp;writing&nbsp;a&nbsp;twisted&nbsp;server.&nbsp;This&nbsp;server&nbsp;spawn&nbsp;multiple&nbsp;child&lt;br&gt;<br>
&gt;&nbsp;processes&nbsp;using&nbsp;reactor&nbsp;spawnProcess&nbsp;that&nbsp;initializes&nbsp;a&nbsp;process&lt;br&gt;<br>
&gt;&nbsp;protocol.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Now,&nbsp;each&nbsp;of&nbsp;the&nbsp;childprocess&nbsp;receives&nbsp;some&nbsp;REST&nbsp;requests.&nbsp;Each&lt;br&gt;<br>
&gt;&nbsp;process&nbsp;has&nbsp;a&nbsp;dict&nbsp;that&nbsp;acts&nbsp;as&nbsp;cache.&lt;br&gt;<br>
&gt;&nbsp;Now,&nbsp;I&nbsp;want&nbsp;to&nbsp;share&nbsp;dict&nbsp;across&nbsp;processes.&lt;br&gt;<br>
&gt;&nbsp;In&nbsp;general,&nbsp;python&nbsp;has&nbsp;SharedMemoryManager&nbsp;in&nbsp;multiprocessing&nbsp;module&lt;br&gt;<br>
&gt;&nbsp;which&nbsp;would&nbsp;have&nbsp;helped.&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://docs.python.org/3/library/multiprocessing.shared_memory.html#m&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://docs.python.org/3/library/multiprocessing.shared_memory.html#m&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;ultiprocessing.managers.SharedMemoryManager.SharedMemory&nbsp;But&nbsp;since&nbsp;I&lt;br&gt;<br>
&gt;&nbsp;am&nbsp;using&nbsp;twisted&nbsp;internal&nbsp;process&nbsp;implementation,&nbsp;how&nbsp;do&nbsp;I&nbsp;share&nbsp;this&lt;br&gt;<br>
&gt;&nbsp;dict&nbsp;across&nbsp;the&nbsp;processes&nbsp;so&nbsp;that&nbsp;all&nbsp;the&nbsp;processes&nbsp;use&nbsp;this&nbsp;common&lt;br&gt;<br>
&gt;&nbsp;cache?&lt;br&gt;<br>
&lt;br&gt;<br>
Keeping&nbsp;a&nbsp;dictionary&nbsp;in&nbsp;SharedMemoryManager&nbsp;seems&nbsp;far&nbsp;from&nbsp;trivial.&nbsp;I&nbsp;&lt;br&gt;<br>
don&#39;t&nbsp;think&nbsp;you&nbsp;can&nbsp;allocate&nbsp;arbitrary&nbsp;Python&nbsp;objects&nbsp;in&nbsp;the&nbsp;shared&nbsp;&lt;br&gt;<br>
memory&nbsp;and&nbsp;even&nbsp;if&nbsp;you&nbsp;could,&nbsp;you&nbsp;would&nbsp;run&nbsp;into&nbsp;problems&nbsp;when&nbsp;one&nbsp;&lt;br&gt;<br>
process&nbsp;mutates&nbsp;the&nbsp;dictionary&nbsp;while&nbsp;another&nbsp;is&nbsp;looking&nbsp;up&nbsp;something&nbsp;or&nbsp;&lt;br&gt;<br>
also&nbsp;mutating&nbsp;it.&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;could&nbsp;in&nbsp;theory&nbsp;work&nbsp;if&nbsp;you&nbsp;implement&nbsp;a&nbsp;custom&nbsp;lock-less&nbsp;dictionary,&nbsp;&lt;br&gt;<br>
but&nbsp;that&nbsp;would&nbsp;be&nbsp;a&nbsp;lot&nbsp;of&nbsp;work&nbsp;and&nbsp;hard&nbsp;to&nbsp;get&nbsp;right.&nbsp;Also&nbsp;having&nbsp;&lt;br&gt;<br>
shared&nbsp;memory&nbsp;mutations&nbsp;be&nbsp;synced&nbsp;between&nbsp;multiple&nbsp;CPU&nbsp;cores&nbsp;could&nbsp;&lt;br&gt;<br>
degrade&nbsp;performance,&nbsp;since&nbsp;keeping&nbsp;core-local&nbsp;CPU&nbsp;caches&nbsp;in&nbsp;sync&nbsp;is&nbsp;&lt;br&gt;<br>
expensive.&lt;br&gt;<br>
&lt;br&gt;<br>
Would&nbsp;it&nbsp;be&nbsp;an&nbsp;option&nbsp;to&nbsp;have&nbsp;only&nbsp;one&nbsp;process&nbsp;accept&nbsp;the&nbsp;REST&nbsp;requests,&nbsp;&lt;br&gt;<br>
check&nbsp;whether&nbsp;the&nbsp;result&nbsp;is&nbsp;in&nbsp;the&nbsp;cache&nbsp;and&nbsp;only&nbsp;distribute&nbsp;work&nbsp;to&nbsp;the&nbsp;&lt;br&gt;<br>
other&nbsp;processes&nbsp;if&nbsp;you&nbsp;get&nbsp;a&nbsp;cache&nbsp;miss?&nbsp;Typically&nbsp;the&nbsp;case&nbsp;where&nbsp;an&nbsp;&lt;br&gt;<br>
answer&nbsp;is&nbsp;cached&nbsp;is&nbsp;pretty&nbsp;fast,&nbsp;so&nbsp;perhaps&nbsp;you&nbsp;don&#39;t&nbsp;need&nbsp;multiple&nbsp;&lt;br&gt;<br>
processes&nbsp;to&nbsp;handle&nbsp;incoming&nbsp;requests.&lt;br&gt;<br>
&lt;br&gt;<br>
Bye,&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Maarten&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
