<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;A&nbsp;while&nbsp;back&nbsp;on&nbsp;Oct&nbsp;13,&nbsp;2010,&nbsp;at&nbsp;7:20&nbsp;PM,&nbsp;James&nbsp;Y&nbsp;Knight&nbsp;wrote:&lt;div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;font-family:&nbsp;'Eames&nbsp;Century&nbsp;Modern';&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;0px;&nbsp;-webkit-border-vertical-spacing:&nbsp;0px;&nbsp;-webkit-text-decorations-in-effect:&nbsp;none;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;font-size:&nbsp;medium;&nbsp;&quot;&gt;You&nbsp;need&nbsp;to&nbsp;avoid&nbsp;using&nbsp;or&nbsp;importing&nbsp;any&nbsp;OSX&nbsp;APIs&nbsp;until&nbsp;after&nbsp;the&nbsp;daemonization&nbsp;has&nbsp;occurred.&nbsp;Unfortunately,&nbsp;twisted&nbsp;executes&nbsp;the&nbsp;entire&nbsp;script&nbsp;file&nbsp;before&nbsp;daemonizing.&nbsp;[that's&nbsp;unfortunate&nbsp;for&nbsp;other&nbsp;reasons&nbsp;besides&nbsp;this,&nbsp;too]&lt;br&gt;&lt;br&gt;Here's&nbsp;a&nbsp;corrected&nbsp;version&nbsp;of&nbsp;your&nbsp;script&nbsp;which&nbsp;works&nbsp;properly.&nbsp;It&nbsp;defers&nbsp;importing&nbsp;Quartz&nbsp;until&nbsp;the&nbsp;reactor&nbsp;is&nbsp;running,&nbsp;by&nbsp;moving&nbsp;it&nbsp;into&nbsp;a&nbsp;function&nbsp;called&nbsp;by&nbsp;reactor.callWhenRunning().&lt;br&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;Deferring&nbsp;OSX&nbsp;API's&nbsp;until&nbsp;after&nbsp;daemonisation&nbsp;was&nbsp;the&nbsp;solution.&nbsp;My&nbsp;test&nbsp;script,&nbsp;fixed&nbsp;by&nbsp;James,&nbsp;works&nbsp;on&nbsp;macbook,&nbsp;but&nbsp;when&nbsp;I&nbsp;run&nbsp;it&nbsp;on&nbsp;a&nbsp;remote&nbsp;OSX&nbsp;server&nbsp;mini,&nbsp;it&nbsp;doesn't.&nbsp;It&nbsp;crashes&nbsp;as&nbsp;before&nbsp;with&nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;b&gt;USING_FORK_WITHOUT_EXEC_IS_NOT_SUPPORTED_BY_FILE_MANAGER)&nbsp;&lt;/b&gt;&lt;/span&gt;.&nbsp;Both&nbsp;machines&nbsp;run&nbsp;the&nbsp;same&nbsp;versions&nbsp;of&nbsp;python,&nbsp;pyobjc,&nbsp;twisted.&nbsp;&nbsp;Some&nbsp;digging&nbsp;showed&nbsp;that&nbsp;on&nbsp;the&nbsp;mini&nbsp;twisted.application.reactors&nbsp;imports&nbsp;zope.interface,&nbsp;which&nbsp;in&nbsp;turn&nbsp;runs&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&lt;/span&gt;__import__('pkg_resources').declare_namespace(__name__)&lt;/div&gt;&lt;div&gt;and&nbsp;this&nbsp;causes&nbsp;Carbon&nbsp;to&nbsp;be&nbsp;loaded,&nbsp;before&nbsp;daemonisation.&nbsp;I&nbsp;can't&nbsp;defer&nbsp;loading&nbsp;reactor&nbsp;because&nbsp;I&nbsp;need&nbsp;it&nbsp;to&nbsp;make&nbsp;things&nbsp;tick,&nbsp;so&nbsp;I'm&nbsp;stuck.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Could&nbsp;this&nbsp;be&nbsp;related&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/trac/ticket/4644&quot;&gt;http://twistedmatrix.com/trac/ticket/4644&lt;/a&gt;&nbsp;?&lt;/div&gt;&lt;div&gt;Any&nbsp;clues&nbsp;to&nbsp;why&nbsp;pkg_resources&nbsp;would&nbsp;cause&nbsp;Carbon&nbsp;to&nbsp;load&nbsp;on&nbsp;one&nbsp;machine,&nbsp;but&nbsp;not&nbsp;on&nbsp;another?&lt;/div&gt;&lt;div&gt;Any&nbsp;clues&nbsp;to&nbsp;prevent&nbsp;it&nbsp;these&nbsp;modules&nbsp;from&nbsp;loading?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Local:&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;174.9px;&nbsp;text-indent:&nbsp;-174.9px;&nbsp;font:&nbsp;normal&nbsp;normal&nbsp;normal&nbsp;11px/normal&nbsp;'Lucida&nbsp;Grande';&nbsp;&quot;&gt;&nbsp;&nbsp;System&nbsp;Version:&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&lt;/span&gt;Mac&nbsp;OS&nbsp;X&nbsp;10.6.4&nbsp;(10F569)&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;174.9px;&nbsp;text-indent:&nbsp;-174.9px;&nbsp;font:&nbsp;normal&nbsp;normal&nbsp;normal&nbsp;11px/normal&nbsp;'Lucida&nbsp;Grande';&nbsp;&quot;&gt;&nbsp;&nbsp;Kernel&nbsp;Version:&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Darwin&nbsp;10.4.0&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Remote:&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;174.9px;&nbsp;text-indent:&nbsp;-174.9px;&nbsp;font:&nbsp;normal&nbsp;normal&nbsp;normal&nbsp;11px/normal&nbsp;'Lucida&nbsp;Grande';&nbsp;&quot;&gt;&nbsp;System&nbsp;Version:&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Mac&nbsp;OS&nbsp;X&nbsp;Server&nbsp;10.6.4&nbsp;(10F569)&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;174.9px;&nbsp;text-indent:&nbsp;-174.9px;&nbsp;font:&nbsp;normal&nbsp;normal&nbsp;normal&nbsp;11px/normal&nbsp;'Lucida&nbsp;Grande';&nbsp;&quot;&gt;&nbsp;&nbsp;Kernel&nbsp;Version:&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Darwin&nbsp;10.4.0&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;174.9px;&nbsp;text-indent:&nbsp;-174.9px;&nbsp;font:&nbsp;normal&nbsp;normal&nbsp;normal&nbsp;11px/normal&nbsp;'Lucida&nbsp;Grande';&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;174.9px;&nbsp;text-indent:&nbsp;-174.9px;&nbsp;font:&nbsp;normal&nbsp;normal&nbsp;normal&nbsp;11px/normal&nbsp;'Lucida&nbsp;Grande';&nbsp;&quot;&gt;Thanks,&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;174.9px;&nbsp;text-indent:&nbsp;-174.9px;&nbsp;font:&nbsp;normal&nbsp;normal&nbsp;normal&nbsp;11px/normal&nbsp;'Lucida&nbsp;Grande';&nbsp;&quot;&gt;Erik&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
