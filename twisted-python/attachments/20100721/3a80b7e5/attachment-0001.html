<tt>
I&nbsp;can&#39;t&nbsp;seem&nbsp;to&nbsp;figure&nbsp;out&nbsp;how&nbsp;a&nbsp;client&nbsp;uploads&nbsp;a&nbsp;file&nbsp;to&nbsp;the&nbsp;server&nbsp;using&nbsp;twisted.protocols.ftp.&nbsp;For&nbsp;the&nbsp;server&nbsp;side&nbsp;I&nbsp;am&nbsp;using&nbsp;the&nbsp;ftpserver&nbsp;example&nbsp;from&nbsp;the&nbsp;twisted&nbsp;website.&nbsp;For&nbsp;the&nbsp;client&nbsp;I&nbsp;have&nbsp;the&nbsp;following:&lt;br&gt;&lt;br&gt;<br>
from&nbsp;twisted.protocols.ftp&nbsp;import&nbsp;FTPClient,&nbsp;FTPFileListProtocol&lt;br&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;Protocol,&nbsp;ClientCreator&lt;br&gt;from&nbsp;twisted.python&nbsp;import&nbsp;usage&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;&lt;br&gt;from&nbsp;twisted.protocols.basic&nbsp;import&nbsp;FileSender&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;#&nbsp;Standard&nbsp;library&nbsp;imports&lt;br&gt;import&nbsp;string&lt;br&gt;import&nbsp;sys&lt;br&gt;try:&lt;br&gt;   &nbsp;from&nbsp;cStringIO&nbsp;import&nbsp;StringIO&lt;br&gt;except&nbsp;ImportError:&lt;br&gt;   &nbsp;from&nbsp;StringIO&nbsp;import&nbsp;StringIO&lt;br&gt;&lt;br&gt;&lt;br&gt;class&nbsp;BufferingProtocol(Protocol):&lt;br&gt;<br>
   &nbsp;&quot;&quot;&quot;Simple&nbsp;utility&nbsp;class&nbsp;that&nbsp;holds&nbsp;all&nbsp;data&nbsp;written&nbsp;to&nbsp;it&nbsp;in&nbsp;a&nbsp;buffer.&quot;&quot;&quot;&lt;br&gt;   &nbsp;def&nbsp;__init__(self,&nbsp;fileToWrite):&lt;br&gt;       &nbsp;self.buffer&nbsp;=&nbsp;StringIO()&lt;br&gt;       &nbsp;self.fileToWrite&nbsp;=&nbsp;fileToWrite&lt;br&gt;<br>
&lt;br&gt;   &nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;br&gt;       &nbsp;self.buffer.write(data)&lt;br&gt;&lt;br&gt;#&nbsp;Define&nbsp;some&nbsp;callbacks&lt;br&gt;&lt;br&gt;def&nbsp;success(response):&lt;br&gt;   &nbsp;print&nbsp;&#39;Success! &nbsp;Got&nbsp;response:&#39;&lt;br&gt;   &nbsp;print&nbsp;&#39;---&#39;&lt;br&gt;   &nbsp;if&nbsp;response&nbsp;is&nbsp;None:&lt;br&gt;<br>
       &nbsp;print&nbsp;None&lt;br&gt;   &nbsp;else:&lt;br&gt;       &nbsp;print&nbsp;string.join(response,&nbsp;&#39;\n&#39;)&lt;br&gt;   &nbsp;print&nbsp;&#39;---&#39;&lt;br&gt;&lt;br&gt;&lt;br&gt;def&nbsp;fail(error):&lt;br&gt;   &nbsp;print&nbsp;&#39;Failed. &nbsp;Error&nbsp;was:&#39;&lt;br&gt;   &nbsp;print&nbsp;error&lt;br&gt;&lt;br&gt;def&nbsp;showFiles(result,&nbsp;fileListProtocol):&lt;br&gt;<br>
   &nbsp;print&nbsp;&#39;Processed&nbsp;file&nbsp;listing:&#39;&lt;br&gt;   &nbsp;for&nbsp;file&nbsp;in&nbsp;fileListProtocol.files:&lt;br&gt;       &nbsp;print&nbsp;&#39;   &nbsp;%s:&nbsp;%d&nbsp;bytes,&nbsp;%s&#39;&nbsp;\&lt;br&gt;             &nbsp;%&nbsp;(file[&#39;filename&#39;],&nbsp;file[&#39;size&#39;],&nbsp;file[&#39;date&#39;])&lt;br&gt;<br>
   &nbsp;print&nbsp;&#39;Total:&nbsp;%d&nbsp;files&#39;&nbsp;%&nbsp;(len(fileListProtocol.files))&lt;br&gt;&lt;br&gt;def&nbsp;showBuffer(result,&nbsp;bufferProtocol):&lt;br&gt;   &nbsp;print&nbsp;&#39;Got&nbsp;data:&#39;&lt;br&gt;   &nbsp;print&nbsp;bufferProtocol.buffer.getvalue()&lt;br&gt;&lt;br&gt;def&nbsp;writeBufferToFile(result,&nbsp;bufferProtocol):&lt;br&gt;<br>
   &nbsp;f&nbsp;=&nbsp;open(bufferProtocol.fileToWrite,&nbsp;&#39;w&#39;)&lt;br&gt;   &nbsp;f.write(bufferProtocol.buffer.getvalue())&lt;br&gt;   &nbsp;f.close()&lt;br&gt;&lt;br&gt;&lt;br&gt;class&nbsp;Options(usage.Options):&lt;br&gt;   &nbsp;optParameters&nbsp;=&nbsp;[[&#39;host&#39;,&nbsp;&#39;h&#39;,&nbsp;&#39;localhost&#39;],&lt;br&gt;<br>
                    &nbsp;[&#39;port&#39;,&nbsp;&#39;p&#39;,&nbsp;21],&lt;br&gt;                    &nbsp;[&#39;username&#39;,&nbsp;&#39;u&#39;,&nbsp;&#39;anonymous&#39;],&lt;br&gt;                    &nbsp;[&#39;password&#39;,&nbsp;None,&nbsp;&#39;bozo&#39;],&lt;br&gt;                    &nbsp;[&#39;passive&#39;,&nbsp;None,&nbsp;0],&lt;br&gt;<br>
                    &nbsp;[&#39;debug&#39;,&nbsp;&#39;d&#39;,&nbsp;1],&lt;br&gt;                   &nbsp;]&lt;br&gt;&lt;br&gt;def&nbsp;run():&lt;br&gt;   &nbsp;#&nbsp;Get&nbsp;config&lt;br&gt;   &nbsp;config&nbsp;=&nbsp;Options()&lt;br&gt;   &nbsp;config.parseOptions()&lt;br&gt;   &nbsp;config.opts[&#39;port&#39;]&nbsp;=&nbsp;int(config.opts[&#39;port&#39;])&lt;br&gt;<br>
   &nbsp;config.opts[&#39;passive&#39;]&nbsp;=&nbsp;int(config.opts[&#39;passive&#39;])&lt;br&gt;   &nbsp;config.opts[&#39;debug&#39;]&nbsp;=&nbsp;int(config.opts[&#39;debug&#39;])&lt;br&gt;   &nbsp;&lt;br&gt;   &nbsp;#&nbsp;Create&nbsp;the&nbsp;client&lt;br&gt;   &nbsp;FTPClient.debug&nbsp;=&nbsp;config.opts[&#39;debug&#39;]&lt;br&gt;<br>
   &nbsp;creator&nbsp;=&nbsp;ClientCreator(reactor,&nbsp;FTPClient,&nbsp;config.opts[&#39;username&#39;],&lt;br&gt;                           &nbsp;config.opts[&#39;password&#39;],&nbsp;passive=config.opts[&#39;passive&#39;])&lt;br&gt;   &nbsp;creator.connectTCP(config.opts[&#39;host&#39;],&nbsp;config.opts[&#39;port&#39;]).addCallback(connectionMade).addErrback(connectionFailed)&lt;br&gt;<br>
   &nbsp;reactor.run()&lt;br&gt;&lt;br&gt;def&nbsp;connectionFailed(f):&lt;br&gt;   &nbsp;print&nbsp;&quot;Connection&nbsp;Failed:&quot;,&nbsp;f&lt;br&gt;   &nbsp;reactor.stop()&lt;br&gt;&lt;br&gt;def&nbsp;fileTransferFail(failure):&lt;br&gt;   &nbsp;failure.printTraceback()&lt;br&gt;   &nbsp;reactor.stop()&lt;br&gt; &lt;br&gt;def&nbsp;cbStore(consumer,&nbsp;filename):&lt;br&gt;<br>
   &nbsp;fs&nbsp;=&nbsp;FileSender()&lt;br&gt;   &nbsp;d&nbsp;=&nbsp;fs.beginFileTransfer(open(filename,&nbsp;&#39;r&#39;),&nbsp;consumer)&lt;br&gt;   &nbsp;d.addCallback(lambda&nbsp;_:&nbsp;consumer.finish()).addErrback(fileTransferFail)&lt;br&gt;   &nbsp;return&nbsp;d&lt;br&gt;&lt;br&gt;&lt;br&gt;def&nbsp;connectionMade(ftpClient):&lt;br&gt;<br>
   &nbsp;#&nbsp;Get&nbsp;the&nbsp;current&nbsp;working&nbsp;directory&lt;br&gt;   &nbsp;ftpClient.pwd().addCallbacks(success,&nbsp;fail)&lt;br&gt;&lt;br&gt;   &nbsp;#&nbsp;Get&nbsp;a&nbsp;detailed&nbsp;listing&nbsp;of&nbsp;the&nbsp;current&nbsp;directory&lt;br&gt;   &nbsp;fileList&nbsp;=&nbsp;FTPFileListProtocol()&lt;br&gt;   &nbsp;d&nbsp;=&nbsp;ftpClient.list(&#39;.&#39;,&nbsp;fileList)&lt;br&gt;<br>
   &nbsp;d.addCallbacks(showFiles,&nbsp;fail,&nbsp;callbackArgs=(fileList,))&lt;br&gt;&lt;br&gt;   &nbsp;#&nbsp;Change&nbsp;to&nbsp;the&nbsp;parent&nbsp;directory&lt;br&gt;   &nbsp;ftpClient.cdup().addCallbacks(success,&nbsp;fail)&nbsp;&lt;br&gt;&lt;br&gt;   &nbsp;filename&nbsp;=&nbsp;&quot;FtpDownload.txt&quot;&lt;br&gt;   &nbsp;uploadpath&nbsp;=&nbsp;&quot;FtpUpload.txt&quot;&lt;br&gt;<br>
   &nbsp;d1,&nbsp;d2&nbsp;=&nbsp;ftpClient.storeFile(uploadpath)&lt;br&gt;   &nbsp;d1.addCallback(cbStore,&nbsp;filename).addErrback(fileTransferFail)&lt;br&gt;   &nbsp;d2.addCallback(lambda&nbsp;_:&nbsp;reactor.stop())&lt;br&gt;&lt;br&gt;&lt;br&gt;#&nbsp;this&nbsp;only&nbsp;runs&nbsp;if&nbsp;the&nbsp;module&nbsp;was&nbsp;*not*&nbsp;imported&lt;br&gt;<br>
if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:&lt;br&gt;   &nbsp;run()&lt;br&gt;&lt;br&gt;When&nbsp;I&nbsp;run&nbsp;this,&nbsp;it&nbsp;returns&nbsp;“Failure:&nbsp;twisted.protocols.ftp.CommandFailed:&nbsp;[&#39;550&nbsp;FtpUpload.txt:&nbsp;Permission&nbsp;denied&#39;]”.&nbsp;I&nbsp;can&nbsp;download&nbsp;a&nbsp;file,&nbsp;and&nbsp;view&nbsp;the&nbsp;files&nbsp;in&nbsp;a&nbsp;folder,&nbsp;I&nbsp;just&nbsp;can&#39;t&nbsp;upload&nbsp;a&nbsp;file.&nbsp;Also&nbsp;if&nbsp;I&nbsp;log-in&nbsp;as&nbsp;one&nbsp;the&nbsp;users&nbsp;in&nbsp;the&nbsp;.dat&nbsp;file,&nbsp;instead&nbsp;of&nbsp;anonymous,&nbsp;I&nbsp;can&#39;t&nbsp;even&nbsp;view&nbsp;the&nbsp;files&nbsp;in&nbsp;a&nbsp;folder.&nbsp;So&nbsp;is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;give&nbsp;anonymous&nbsp;or&nbsp;a&nbsp;user&nbsp;in&nbsp;the&nbsp;.dat&nbsp;file&nbsp;more&nbsp;permissions,&nbsp;like&nbsp;the&nbsp;write&nbsp;permission?&lt;br&gt;<br>
&lt;div&nbsp;style=&quot;visibility:&nbsp;hidden;&nbsp;display:&nbsp;inline;&quot;&nbsp;id=&quot;avg_ls_inline_popup&quot;&gt;&lt;/div&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;#avg_ls_inline_popup&nbsp;{&nbsp;&nbsp;position:absolute;&nbsp;&nbsp;z-index:9999;&nbsp;&nbsp;padding:&nbsp;0px&nbsp;0px;&nbsp;&nbsp;margin-left:&nbsp;0px;&nbsp;&nbsp;margin-top:&nbsp;0px;&nbsp;&nbsp;width:&nbsp;240px;&nbsp;&nbsp;overflow:&nbsp;hidden;&nbsp;&nbsp;word-wrap:&nbsp;break-word;&nbsp;&nbsp;color:&nbsp;black;&nbsp;&nbsp;font-size:&nbsp;10px;&nbsp;&nbsp;text-align:&nbsp;left;&nbsp;&nbsp;line-height:&nbsp;13px;}&lt;/style&gt;<br>

</tt>
