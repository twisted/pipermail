<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;To&nbsp;be&nbsp;clear:&nbsp;my&nbsp;current&nbsp;interest&nbsp;is&nbsp;really&nbsp;just&nbsp;doing&nbsp;this&nbsp;during&nbsp;unit&nbsp;tests/ongoing&nbsp;development&nbsp;(e.g.&nbsp;not&nbsp;diagnosing&nbsp;prod&nbsp;issues,&nbsp;where&nbsp;Wireshark&nbsp;would&nbsp;make&nbsp;plenty&nbsp;of&nbsp;sense).&nbsp;&amp;nbsp;So&nbsp;something&nbsp;integrated&nbsp;into&nbsp;Twisted&nbsp;feels&nbsp;natural.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;said,&nbsp;is&nbsp;the&nbsp;unit&nbsp;test&nbsp;pattern&nbsp;I'm&nbsp;seeing&nbsp;in&nbsp;the&nbsp;mail/test/test_imap.py&nbsp;module&nbsp;atypical?&nbsp;&amp;nbsp;Most&nbsp;of&nbsp;the&nbsp;doc'd&nbsp;examples&nbsp;for&nbsp;trial&nbsp;don't&nbsp;seem&nbsp;to&nbsp;be&nbsp;using&nbsp;loopbackTCP,&nbsp;so&nbsp;much&nbsp;as&nbsp;directly&nbsp;writing&nbsp;to&nbsp;lineReceived&nbsp;or&nbsp;something&nbsp;similar.&nbsp;&amp;nbsp;It's&nbsp;only&nbsp;because&nbsp;these&nbsp;tests&nbsp;are&nbsp;doing&nbsp;end-to-end&nbsp;things,&nbsp;by&nbsp;way&nbsp;of&nbsp;constructing&nbsp;both&nbsp;an&nbsp;IMAP&nbsp;server&nbsp;and&nbsp;client,&nbsp;and&nbsp;hooking&nbsp;them&nbsp;up,&nbsp;that&nbsp;I'm&nbsp;in&nbsp;this&nbsp;situation.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-D&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Jul&nbsp;13,&nbsp;2012,&nbsp;at&nbsp;6:21&nbsp;PM,&nbsp;Glyph&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Jul&nbsp;12,&nbsp;2012,&nbsp;at&nbsp;1:31&nbsp;PM,&nbsp;Dan&nbsp;Milstein&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:dan@wingu.com&quot;&gt;dan@wingu.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;'lo&nbsp;all,&lt;br&gt;&lt;br&gt;I've&nbsp;been&nbsp;doing&nbsp;some&nbsp;work&nbsp;with&nbsp;the&nbsp;twisted.mail.imap4&nbsp;module,&nbsp;and&nbsp;its&nbsp;associated&nbsp;unit&nbsp;tests&nbsp;(in&nbsp;order&nbsp;to&nbsp;learn&nbsp;the&nbsp;code&nbsp;more,&nbsp;I'm&nbsp;tackling&nbsp;a&nbsp;few&nbsp;of&nbsp;the&nbsp;outstanding&nbsp;tickets).&lt;br&gt;&lt;br&gt;When&nbsp;running&nbsp;those&nbsp;tests,&nbsp;I'd&nbsp;often&nbsp;like&nbsp;to&nbsp;log&nbsp;all&nbsp;the&nbsp;server/client&nbsp;interaction.&nbsp;&amp;nbsp;I&nbsp;managed&nbsp;to&nbsp;do&nbsp;so&nbsp;by&nbsp;way&nbsp;of&nbsp;hacking&nbsp;the&nbsp;code&nbsp;in&nbsp;twisted.protocols.loopback,&nbsp;but&nbsp;that&nbsp;feels&nbsp;pretty&nbsp;wrong.&nbsp;&amp;nbsp;What's&nbsp;a&nbsp;good&nbsp;way&nbsp;to&nbsp;get&nbsp;all&nbsp;the&nbsp;interaction&nbsp;logged?&lt;br&gt;&lt;br&gt;To&nbsp;be&nbsp;more&nbsp;specific,&nbsp;the&nbsp;tests&nbsp;in&nbsp;question&nbsp;(e.g.&nbsp;test_imap.NewFetchTestCase),&nbsp;do&nbsp;a&nbsp;lot&nbsp;of:&lt;br&gt;&lt;br&gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;d&nbsp;=&nbsp;loopback.loopbackTCP(self.server,&nbsp;self.client,&nbsp;noisy=False)&lt;br&gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;d.addCallback(lambda&nbsp;x&nbsp;:&nbsp;self.assertEqual(self.result,&nbsp;self.expected))&lt;br&gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return&nbsp;d&lt;br&gt;&lt;br&gt;What's&nbsp;a&nbsp;Good&nbsp;Way&nbsp;to&nbsp;get&nbsp;all&nbsp;the&nbsp;traffic&nbsp;going&nbsp;over&nbsp;that&nbsp;loopback&nbsp;logged?&nbsp;&amp;nbsp;Setting&nbsp;noisy&nbsp;to&nbsp;True&nbsp;merely&nbsp;gets&nbsp;it&nbsp;to&nbsp;log&nbsp;some&nbsp;protocol&nbsp;startup/teardown-type&nbsp;messages.&nbsp;&amp;nbsp;&lt;br&gt;&lt;br&gt;Or:&nbsp;given&nbsp;that&nbsp;I've&nbsp;figured&nbsp;out&nbsp;how&nbsp;to&nbsp;hack&nbsp;loopback.lookupbackTCP,&nbsp;if&nbsp;there's&nbsp;general&nbsp;utility,&nbsp;I&nbsp;can&nbsp;certainly&nbsp;add&nbsp;a&nbsp;keyword&nbsp;arg&nbsp;to&nbsp;trigger&nbsp;logging&nbsp;of&nbsp;all&nbsp;messages,&nbsp;e.g.&nbsp;logAll=False&nbsp;(I'm&nbsp;trying&nbsp;to&nbsp;find&nbsp;something&nbsp;which&nbsp;feels&nbsp;meaningfully&nbsp;different&nbsp;from&nbsp;'noisy',&nbsp;because&nbsp;it&nbsp;would&nbsp;seem&nbsp;Very&nbsp;Wrong&nbsp;Indeed&nbsp;to&nbsp;make&nbsp;noisy&nbsp;suddenly&nbsp;produce&nbsp;vastly&nbsp;more&nbsp;log&nbsp;output).&nbsp;&amp;nbsp;Is&nbsp;that&nbsp;something&nbsp;people&nbsp;might&nbsp;be&nbsp;interested&nbsp;in?&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you're&nbsp;interested&nbsp;in&nbsp;logging&nbsp;at&nbsp;the&nbsp;TCP&nbsp;connection&nbsp;level,&nbsp;have&nbsp;you&nbsp;considered&nbsp;moving&nbsp;this&nbsp;out&nbsp;of&nbsp;your&nbsp;Twisted&nbsp;process&nbsp;entirely&nbsp;and&nbsp;using&nbsp;some&nbsp;tool&nbsp;like&nbsp;Wireshark?&nbsp;&amp;nbsp;You&nbsp;&lt;i&gt;could&lt;/i&gt;&amp;nbsp;build&nbsp;something&nbsp;yourself&nbsp;by&nbsp;interposing&nbsp;transport&nbsp;objects&nbsp;that&nbsp;dump&nbsp;their&nbsp;data,&nbsp;but&nbsp;you'd&nbsp;have&nbsp;to&nbsp;build&nbsp;your&nbsp;own&nbsp;toolchain&nbsp;(command&nbsp;line&nbsp;tools,&nbsp;GUIs,&nbsp;etc)&nbsp;for&nbsp;actually&nbsp;examining&nbsp;the&nbsp;output,&nbsp;whereas&nbsp;existing&nbsp;protocol&nbsp;analysis&nbsp;tools&nbsp;would&nbsp;just&nbsp;do&nbsp;that&nbsp;for&nbsp;you.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-glyph&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;_______________________________________________&lt;br&gt;Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
