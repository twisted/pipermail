<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Sep&nbsp;20,&nbsp;2014,&nbsp;at&nbsp;11:31&nbsp;AM,&nbsp;weykent&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:weykent@weasyl.com&quot;&gt;weykent@weasyl.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Hi,&lt;br&gt;&lt;br&gt;Recently&nbsp;I&nbsp;worked&nbsp;on&nbsp;refactoring&nbsp;a&nbsp;project&nbsp;so&nbsp;that&nbsp;it&nbsp;was,&nbsp;in&nbsp;my&nbsp;opinion,&nbsp;more&nbsp;testable.&nbsp;For&nbsp;reference,&nbsp;the&nbsp;diff&nbsp;is&nbsp;available&nbsp;at&nbsp;&lt;&lt;a&nbsp;href=&quot;https://github.com/Weasyl/txyam/compare/Weasyl:9230b7d09c1413a09d776700f26a01865aa99604...cdf7aef9e3425f27016f8e97c59bd2143fbf805c&quot;&gt;https://github.com/Weasyl/txyam/compare/Weasyl:9230b7d09c1413a09d776700f26a01865aa99604...cdf7aef9e3425f27016f8e97c59bd2143fbf805c&lt;/a&gt;&gt;,&nbsp;and&nbsp;the&nbsp;important&nbsp;parts&nbsp;in&nbsp;the&nbsp;changed&nbsp;version&nbsp;are&nbsp;at&nbsp;&lt;&lt;a&nbsp;href=&quot;https://github.com/Weasyl/txyam/blob/cdf7aef9e3425f27016f8e97c59bd2143fbf805c/txyam/client.py#L24-L49&quot;&gt;https://github.com/Weasyl/txyam/blob/cdf7aef9e3425f27016f8e97c59bd2143fbf805c/txyam/client.py#L24-L49&lt;/a&gt;&gt;.&nbsp;&lt;br&gt;&lt;br&gt;My&nbsp;question:&nbsp;is&nbsp;this&nbsp;a&nbsp;good&nbsp;factoring&nbsp;for&nbsp;testing&nbsp;a&nbsp;wrapper?&nbsp;It&nbsp;seems&nbsp;to&nbsp;make&nbsp;sense&nbsp;to&nbsp;split&nbsp;apart&nbsp;crafting&nbsp;and&nbsp;issuing&nbsp;requests&nbsp;to&nbsp;clients,&nbsp;as&nbsp;it&nbsp;lets&nbsp;you&nbsp;test&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;request&nbsp;to&nbsp;see&nbsp;what&nbsp;will&nbsp;happen&nbsp;instead&nbsp;of&nbsp;having&nbsp;to&nbsp;issue&nbsp;the&nbsp;request&nbsp;and&nbsp;test&nbsp;that&nbsp;its&nbsp;effects&nbsp;happened.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;anything&nbsp;I'd&nbsp;say&nbsp;that&nbsp;the&nbsp;problem&nbsp;with&nbsp;this&nbsp;code&nbsp;is&nbsp;that&nbsp;it's&nbsp;not&nbsp;a&nbsp;public,&nbsp;documented&nbsp;interface.&nbsp;The&nbsp;clients&nbsp;of&nbsp;this&nbsp;library&nbsp;might&nbsp;want&nbsp;to&nbsp;test&nbsp;it&nbsp;as&nbsp;well&nbsp;:).&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;On&nbsp;a&nbsp;previous&nbsp;iteration&nbsp;of&nbsp;this&nbsp;project,&nbsp;I&nbsp;wrote&nbsp;tests&nbsp;that&nbsp;did&nbsp;exactly&nbsp;that:&nbsp;issued&nbsp;requests&nbsp;and&nbsp;checked&nbsp;the&nbsp;bytes&nbsp;that&nbsp;were&nbsp;sent&nbsp;to&nbsp;a&nbsp;StringTransport.&nbsp;Those&nbsp;tests&nbsp;ended&nbsp;up&nbsp;being&nbsp;harder&nbsp;to&nbsp;read&nbsp;and&nbsp;write,&nbsp;and&nbsp;seemed&nbsp;to&nbsp;rely&nbsp;on&nbsp;the&nbsp;exact&nbsp;implementation&nbsp;of&nbsp;the&nbsp;thing&nbsp;I&nbsp;was&nbsp;wrapping.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you're&nbsp;going&nbsp;to&nbsp;check&nbsp;the&nbsp;bytes&nbsp;in&nbsp;a&nbsp;StringTransport,&nbsp;that&nbsp;means&nbsp;you&nbsp;need&nbsp;an&nbsp;implementation&nbsp;of&nbsp;the&nbsp;other&nbsp;end&nbsp;of&nbsp;the&nbsp;protocol&nbsp;as&nbsp;well.&nbsp;&nbsp;If&nbsp;you're&nbsp;just&nbsp;asserting&nbsp;about&nbsp;the&nbsp;exact&nbsp;bytes,&nbsp;then&nbsp;that's&nbsp;really&nbsp;brittle&nbsp;and&nbsp;will&nbsp;break&nbsp;in&nbsp;response&nbsp;to&nbsp;lots&nbsp;of&nbsp;incidental&nbsp;changes.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;can&nbsp;use&nbsp;this&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;a&nbsp;higher-level&nbsp;testing&nbsp;strategy,&nbsp;like&nbsp;so:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;&lt;a&nbsp;href=&quot;https://github.com/rackerlabs/mimic/blob/master/mimic/test/helpers.py&quot;&gt;https://github.com/rackerlabs/mimic/blob/master/mimic/test/helpers.py&lt;/a&gt;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;but&nbsp;in&nbsp;this&nbsp;case&nbsp;the&nbsp;unit&nbsp;test&nbsp;code&nbsp;doesn't&nbsp;see&nbsp;the&nbsp;response&nbsp;to&nbsp;its&nbsp;requests&nbsp;until&nbsp;it's&nbsp;been&nbsp;parsed&nbsp;into&nbsp;a&nbsp;sensible&nbsp;data&nbsp;structure,&nbsp;and&nbsp;assertions&nbsp;are&nbsp;about&nbsp;that.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-glyph&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
