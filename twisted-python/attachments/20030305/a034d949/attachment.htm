<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&quot;&gt;<br>
&lt;HTML&gt;&lt;HEAD&gt;<br>
&lt;META&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&nbsp;http-equiv=Content-Type&gt;<br>
&lt;META&nbsp;content=&quot;MSHTML&nbsp;5.00.2314.1000&quot;&nbsp;name=GENERATOR&gt;<br>
&lt;STYLE&gt;&lt;/STYLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;bgColor=#ffffff&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;I&nbsp;have&nbsp;what&nbsp;I&nbsp;think&nbsp;is&nbsp;a&nbsp;unique&nbsp;issue&nbsp;and&nbsp;hoping&nbsp;someone&nbsp;might&nbsp;<br>
be&nbsp;able&nbsp;to&nbsp;offer&nbsp;a&nbsp;suggestion.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;PROBLEM:&amp;nbsp;&nbsp;Can't&nbsp;get&nbsp;Do/Loop&nbsp;and&nbsp;Timer/Loop&nbsp;to&nbsp;<br>
Exit&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;I&nbsp;have&nbsp;a&nbsp;static&nbsp;counter&nbsp;in&nbsp;the&nbsp;PAINT&nbsp;event&nbsp;to&nbsp;set&nbsp;up&nbsp;a&nbsp;trigger&nbsp;<br>
to&nbsp;call&nbsp;a&nbsp;Do/Loop.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;This&nbsp;is&nbsp;done&nbsp;to&nbsp;allow&nbsp;the&nbsp;screen&nbsp;to&nbsp;be&nbsp;painted&nbsp;to&nbsp;a&nbsp;certain&nbsp;<br>
point&nbsp;and&nbsp;then&nbsp;the&nbsp;loop&nbsp;is&nbsp;designed&nbsp;to&nbsp;finish&nbsp;painting&nbsp;the&nbsp;screen&nbsp;in&nbsp;slow&nbsp;<br>
motion.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;Once&nbsp;the&nbsp;Do/Loop&nbsp;is&nbsp;entered&nbsp;it&nbsp;is&nbsp;controlled&nbsp;(slow&nbsp;motion)&nbsp;by&nbsp;<br>
calling&amp;nbsp;the&nbsp;Timer/Loop&nbsp;routine&amp;nbsp;&lt;/FONT&gt;&lt;FONT&nbsp;size=2&gt;which&nbsp;uses&nbsp;<br>
SetWaitableTimer&nbsp;and&nbsp;MsgWaitForMultipleObjects&nbsp;to&nbsp;control&nbsp;the&nbsp;speed&nbsp;of&nbsp;painting&nbsp;<br>
and&nbsp;allow&nbsp;the&nbsp;user&nbsp;interface&nbsp;to&nbsp;still&nbsp;be&nbsp;active.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;Everything&nbsp;works&nbsp;well.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;-----&nbsp;Heres&nbsp;were&nbsp;the&nbsp;problem&nbsp;is:&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;If&nbsp;the&nbsp;program&nbsp;is&nbsp;to&nbsp;exited&nbsp;prior&nbsp;to&nbsp;the&nbsp;loop&nbsp;finishing,&nbsp;&nbsp;the&nbsp;<br>
user&nbsp;clicks&nbsp;File/Exit.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;A&nbsp;global&nbsp;structure&nbsp;variable&nbsp;was&nbsp;included&nbsp;in&nbsp;the&nbsp;loop&nbsp;&lt;U&gt;in&nbsp;an&nbsp;<br>
attempt&nbsp;&lt;/U&gt;to&nbsp;quickly&nbsp;exit&nbsp;both&nbsp;the&nbsp;Do/Loop&nbsp;and&nbsp;the&nbsp;Timer/Loop,&nbsp;but&nbsp;whatever&nbsp;<br>
reason&nbsp;is&nbsp;never&nbsp;seen&nbsp;by&nbsp;the&nbsp;Loops&nbsp;prior&amp;nbsp;to&nbsp;the&nbsp;call&nbsp;to&nbsp;unload&nbsp;the&nbsp;MDI&nbsp;<br>
form.&amp;nbsp;&nbsp;The&nbsp;system&nbsp;locks&nbsp;or&nbsp;generates&nbsp;an&nbsp;error.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;Any&nbsp;ideas&nbsp;how&nbsp;to&nbsp;resolve?&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;Thanks&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;David&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
