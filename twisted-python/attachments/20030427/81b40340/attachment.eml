[From nobody Sun Jul  5 16:39:11 2009
X-From-Line: pinard@IRO.UMontreal.CA  Sun Apr 27 14:25:42 2003
Return-Path: &lt;pinard@IRO.UMontreal.CA&gt;
Delivered-To: pinard@progiciels-bpi.ca
Received: from mercure.iro.umontreal.ca (mercure.iro.umontreal.ca
	[132.204.24.67])
	by alcyon.progiciels-bpi.ca (Postfix) with ESMTP id 8FF51A156
	for &lt;pinard@progiciels-bpi.ca&gt;; Sun, 27 Apr 2003 14:25:42 -0400 (EDT)
Received: from mercure.iro.umontreal.ca (localhost.iro.umontreal.ca
	[127.0.0.1])
	by mercure.iro.umontreal.ca (8.12.9/8.12.9) with ESMTP id
	h3RIPe2W011653
	for &lt;pinard@progiciels-bpi.ca&gt;; Sun, 27 Apr 2003 14:25:40 -0400
Received: (from pinard@localhost)
	by mercure.iro.umontreal.ca (8.12.9/8.12.1/Submit) id h3RIPeJW011652
	for pinard@progiciels-bpi.ca; Sun, 27 Apr 2003 14:25:40 -0400
Received: from perlin.iro.umontreal.ca (perlin.iro.umontreal.ca
	[132.204.24.51])
	by mercure.iro.umontreal.ca (8.12.9/8.12.9) with ESMTP id
	h3RIPc2W011637
	for &lt;pinard@mercure.iro.umontreal.ca&gt;; Sun, 27 Apr 2003 14:25:38 -0400
Received: by perlin.iro.umontreal.ca (Postfix)
	id 4E9F730DE7; Sun, 27 Apr 2003 14:25:38 -0400 (EDT)
Delivered-To: pinard@iro.umontreal.ca
Received: from alcyon.progiciels-bpi.ca (alcyon.progiciels-bpi.ca
	[207.35.30.254])
	by perlin.iro.umontreal.ca (Postfix) with ESMTP id B6C3330DE2
	for &lt;pinard@iro.umontreal.ca&gt;; Sun, 27 Apr 2003 14:25:36 -0400 (EDT)
Received: by alcyon.progiciels-bpi.ca (Postfix, from userid 405)
	id 7806BAF14; Sun, 27 Apr 2003 14:25:28 -0400 (EDT)
Sender: pinard@progiciels-bpi.ca
To: twisted-python@twistedmatrix.com
Subject: Re: Twisted 1.0.4 - Heavy search for `plugins.tml'
References: &lt;oqel3oc7gx.fsf@alcyon.progiciels-bpi.ca&gt;
	&lt;20030427162702.GA7671@toshi.anaprd01.md.comcast.net&gt;
	&lt;oqvfwzc2ak.fsf@alcyon.progiciels-bpi.ca&gt;
	&lt;20030427171435.GC7671@toshi.anaprd01.md.comcast.net&gt;
X-Face: &quot;b_m|CE6#'Q8fliQrwHl9K,
	]PA_o'*S~Dva{~b1n*)K*A(BIwQW.:LY?t4~xhYka_.LV?Qq
	`}X|71X0ea&amp;H]9Dsk!`kxBXlG;
	q$mLfv_vtaHK_rHFKu]4'&lt;*LWCyUe@ZcI6&quot;*wB5M@[m&lt;Ok5/cC^= CxDhg=TJi^o[E
From: Francois Pinard &lt;pinard@IRO.UMontreal.CA&gt;
Date: 27 Apr 2003 14:25:28 -0400
In-Reply-To: &lt;20030427171435.GC7671@toshi.anaprd01.md.comcast.net&gt;
Message-ID: &lt;oqof2rbxwn.fsf@alcyon.progiciels-bpi.ca&gt;
User-Agent: Gnus/5.09 (Gnus v5.9.0) Emacs/21.2.95
X-MailScanner: Found to be clean, Found to be clean
Lines: 1364
Xref: alcyon.progiciels-bpi.ca net.twisted:1094
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

[Christopher Armstrong]

&gt; It's not using the shell load path.  /usr/bin just happens to be in
&gt; your sys.path.

No, it is not.  How can you be so assertive?

&gt; And inventing a new environment variable is contrary to the stated goal,
&gt; which is the lack of a registration process (apart from what you need
&gt; to do to have your package work with Python).

Stated where?  The book does not clearly indicate (or I did not read that
part yet) where `.tml' files are exactly looked for.

&gt; Now, are you actually having a *problem* with the performance of mktap?

I'm surely a patient man.  Yet, `mktap' could be faster, and nobody
would complain.

And besides and moreover, I may well report a bug, without having an actual
problem with it.  Having to much insist that a bug exists remembers me
the old times of contacting vendors of non-free software.  This is the
second time in the Python community that I observe this phenomenon.
Being receptive to feedback is a good way to keep it coming, you know.

&gt; On 2003.04.27 12:50, Francois Pinard wrote:
&gt; &gt; It still looks like Twisted is going overboard with this.  If `plugins.tml'
&gt; &gt; files were being collected from the top-level directories along `sys.path'
&gt; &gt; and maybe no more than one-level below, and maybe also for test purposes
&gt; &gt; (despite the security weakness), into the current directory and one
&gt; &gt; level of directories below, it would probably make a lot of sense at a
&gt; &gt; reasonable cost.

&gt; That's exactly what it's documented to do.  If it's not doing that,
&gt; it's a bug.  (btw, the current directory gets no special treatment. If
&gt; it's searching the current directory, it's because the current directory
&gt; is somehow in sys.path)

OK then.  I am now reporting a bug.  The default Python path for this
Python 2.2.1, which I installed over a SuSE 8.0 Linux distribution, is:

----------------------------------------------------------------------&gt;
&gt;&gt;&gt; sys.path
['',
 '/usr/lib/python2.2',
 '/usr/lib/python2.2/plat-linux2',
 '/usr/lib/python2.2/lib-tk',
 '/usr/lib/python2.2/lib-dynload',
 '/usr/lib/python2.2/site-packages',
 '/usr/lib/python2.2/site-packages/PIL',
 '/sram/griffon/local/lib/python2.2/site-packages']
----------------------------------------------------------------------&lt;

The last line comes from a local `sitecustomize.py'.  The current directory
while testing is:

----------------------------------------------------------------------&gt;
~/sram/twisted/web
----------------------------------------------------------------------&lt;

Doing `strace mktap', and cleaning out from the result what is expected
from the current value of `sys.path' (yet without checking if the depth
of search is reasonable), leaves these to consider, explain and justify:

----------------------------------------------------------------------&gt;
stat64(&quot;/usr/bin/[/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/w/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/bc/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/ar/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/as/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/at/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/cc/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/ci/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/dc/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/co/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/ed/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/du/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/ex/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/gs/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/m4/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/id/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/im/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/ld/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/mc/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/lp/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
[...]
stat64(&quot;/usr/bin/gimp-1.2/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/ssh-keygen/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pygtk-codegen-1.2/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pbmtoepsi/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pbmtoicon/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pnmhisteq/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/socklist/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pbmtoln03/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pbmtomacp/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pbmtoplot/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pbmtopsg3/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pbmtowbmp/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pslatex/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/pbmtozinc/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/tixindex/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/gimptool/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/psmerge/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/psselect/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/atktopbm/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
stat64(&quot;/usr/bin/rletopnm/plugins.tml&quot;, 0xbfffe2bc) = -1 ENOTDIR (Not a directory)
----------------------------------------------------------------------&lt;

-- 
François Pinard   http://www.iro.umontreal.ca/~pinard
]