<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Here&#39;s&nbsp;code&nbsp;that&nbsp;generates&nbsp;an&nbsp;error&nbsp;on&nbsp;line&nbsp;#9&nbsp;in&nbsp;f1()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;1&nbsp;import&nbsp;time,&nbsp;sys&lt;/div&gt;&lt;div&gt; &nbsp;2&nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/div&gt;&lt;div&gt; &nbsp;3&nbsp;from&nbsp;twisted.internet.task&nbsp;import&nbsp;deferLater&lt;/div&gt;&lt;div&gt; &nbsp;4&nbsp;from&nbsp;twisted.internet.defer&nbsp;import&nbsp;inlineCallbacks&lt;/div&gt;&lt;div&gt; &nbsp;5&lt;/div&gt;&lt;div&gt; &nbsp;6&nbsp;@inlineCallbacks&lt;/div&gt;&lt;div&gt; &nbsp;7&nbsp;def&nbsp;f1():&lt;/div&gt;&lt;div&gt; &nbsp;8&nbsp; &nbsp; &nbsp;yield&nbsp;time.time()&lt;/div&gt;&lt;div&gt; &nbsp;9&nbsp; &nbsp; &nbsp;{&#39;a&#39;:&nbsp;&#39;A&#39;,&nbsp;&#39;b&#39;:&nbsp;&#39;B&#39;}[&#39;c&#39;]&nbsp;#&nbsp;KeyError&lt;/div&gt;&lt;div&gt; 10&lt;/div&gt;&lt;div&gt; 11&nbsp;@inlineCallbacks&lt;/div&gt;&lt;div&gt; 12&nbsp;def&nbsp;f2():&lt;/div&gt;&lt;div&gt; 13&nbsp; &nbsp; &nbsp;yield&nbsp;f1()&lt;/div&gt;&lt;div&gt; 14&lt;/div&gt;&lt;div&gt; 15&nbsp;def&nbsp;on_err(failure):&lt;/div&gt;&lt;div&gt; 16&nbsp; &nbsp; &nbsp;print(&quot;on_err:&nbsp;===&gt;&quot;,&nbsp;failure.getErrorMessage())&lt;/div&gt;&lt;div&gt; 17&nbsp; &nbsp; &nbsp;failure.printTraceback(file=sys.stderr)&lt;/div&gt;&lt;div&gt; 18&nbsp; &nbsp; &nbsp;if&nbsp;reactor.running:&lt;/div&gt;&lt;div&gt; 19&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;reactor.stop()&lt;/div&gt;&lt;div&gt; 20&lt;/div&gt;&lt;div&gt; 21&nbsp;def&nbsp;done(*args,&nbsp;**kargs):&lt;/div&gt;&lt;div&gt; 22&nbsp; &nbsp; &nbsp;print(&quot;done.&quot;)&lt;/div&gt;&lt;div&gt; 23&nbsp; &nbsp; &nbsp;reactor.stop()&lt;/div&gt;&lt;div&gt; 24&lt;/div&gt;&lt;div&gt; 25&nbsp;deferLater(reactor,&nbsp;0,&nbsp;f2).addCallback(done).addErrback(on_err)&lt;/div&gt;&lt;div&gt; 26&nbsp;reactor.run()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;running&nbsp;w/&nbsp;python&nbsp;2.7&nbsp;outputs&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt;---&nbsp;&lt;exception&nbsp;caught&nbsp;here&gt;&nbsp;---&lt;/div&gt;&lt;div&gt; &nbsp;File&nbsp;&quot;.....\lib\site-packages\twisted\internet\defer.py&quot;,&nbsp;line&nbsp;1128,&nbsp;in&nbsp;_inlineCallbacks&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;result&nbsp;=&nbsp;g.send(result)&lt;/div&gt;&lt;div&gt; &nbsp;File&nbsp;&quot;../temp/tb.py&quot;,&nbsp;line&nbsp;9,&nbsp;in&nbsp;f1&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;{&#39;a&#39;:&nbsp;&#39;A&#39;,&nbsp;&#39;b&#39;:&nbsp;&#39;B&#39;}[&#39;c&#39;]&lt;/div&gt;&lt;div&gt;exceptions.KeyError:&nbsp;&#39;c&#39;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;python&nbsp;3.6.1&nbsp;(twisted&nbsp;17.5.0)&nbsp;outputs&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt; &nbsp;File&nbsp;&quot;.....\lib\site-packages\twisted\internet\defer.py&quot;,&nbsp;line&nbsp;1299,&nbsp;in&nbsp;_inlineCallbacks&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;result&nbsp;=&nbsp;result.throwExceptionIntoGenerator(g)&lt;/div&gt;&lt;div&gt; &nbsp;File&nbsp;&quot;.....\lib\site-packages\twisted\python\failure.py&quot;,&nbsp;line&nbsp;393,&nbsp;in&nbsp;throwExceptionIntoGenerator&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;return&nbsp;g.throw(self.type,&nbsp;self.value,&nbsp;self.tb)&lt;/div&gt;&lt;div&gt; &nbsp;File&nbsp;&quot;../temp/tb.py&quot;,&nbsp;line&nbsp;13,&nbsp;in&nbsp;f2&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;yield&nbsp;f1()&lt;/div&gt;&lt;div&gt;builtins.KeyError:&nbsp;&#39;c&#39;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;can&nbsp;know&nbsp;there&nbsp;is&nbsp;a&nbsp;failure&nbsp;in&nbsp;f1()&nbsp;but&nbsp;line&nbsp;and&nbsp;other&nbsp;specifics&nbsp;are&nbsp;dropped&lt;/div&gt;&lt;div&gt;changing&nbsp;line&nbsp;#25&nbsp;to&nbsp;call&nbsp;f1()&nbsp;gives&nbsp;a&nbsp;better&nbsp;message,&nbsp;so&nbsp;it&#39;s&nbsp;something&nbsp;related&nbsp;to&nbsp;stack&nbsp;frame.&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;any&nbsp;way&nbsp;(aside&nbsp;from&nbsp;adding&nbsp;logging&nbsp;at&nbsp;each&nbsp;level&nbsp;to&nbsp;internet/defer.py:_inlineCallbacks)&nbsp;to&nbsp;get&nbsp;a&nbsp;better&nbsp;error&nbsp;message&nbsp;in&nbsp;py3?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thank&nbsp;you&lt;/div&gt;&lt;div&gt;-&nbsp;Aaron&nbsp; &lt;/div&gt;&lt;/div&gt;<br>

</tt>
