<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;Well,&nbsp;you&amp;#39;d&nbsp;presumably&nbsp;have&nbsp;a&nbsp;connection&nbsp;to&nbsp;each&nbsp;of&nbsp;the&nbsp;servers&nbsp;in&nbsp;the&nbsp;form&nbsp;of&nbsp;a&nbsp;client&nbsp;factory&nbsp;and&nbsp;a&nbsp;protocol&nbsp;instance.&nbsp;Then,&nbsp;every&nbsp;time&nbsp;you&nbsp;get&nbsp;a&nbsp;message,&nbsp;you&nbsp;figure&nbsp;out&nbsp;which&nbsp;protocol&nbsp;instance&nbsp;you&nbsp;want&nbsp;(the&nbsp;one&nbsp;for&nbsp;the&nbsp;appropriate&nbsp;server)&nbsp;and&nbsp;send&nbsp;a&nbsp;message&nbsp;to&nbsp;it.&nbsp;You&nbsp;could&nbsp;do&nbsp;that&nbsp;with&nbsp;self.transport.write,&nbsp;of&nbsp;course,&nbsp;but&nbsp;it&nbsp;would&nbsp;be&nbsp;much&nbsp;easier&nbsp;to&nbsp;just&nbsp;use&nbsp;a&nbsp;ready-made&nbsp;RPC&nbsp;thing.&lt;br&gt;<br>
<br>
&lt;br&gt;One&nbsp;such&nbsp;RPC&nbsp;thing&nbsp;is&nbsp;AMP,&nbsp;which&nbsp;comes&nbsp;with&nbsp;Twisted.&nbsp;You&nbsp;can&nbsp;read&nbsp;more&nbsp;about&nbsp;it&nbsp;here:&lt;br&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://amp-protocol.net/&quot;&gt;http://amp-protocol.net/&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/documents/current/core/howto/amp.html&quot;&gt;https://twistedmatrix.com/documents/current/core/howto/amp.html&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;You&nbsp;will&nbsp;probably&nbsp;end&nbsp;up&nbsp;having&nbsp;a&nbsp;command&nbsp;like&nbsp;HandlePacket&nbsp;or&nbsp;something&nbsp;(presumably&nbsp;you&nbsp;can&nbsp;come&nbsp;up&nbsp;with&nbsp;a&nbsp;more&nbsp;apt&nbsp;domain-specific&nbsp;name),&nbsp;and&nbsp;something&nbsp;close&nbsp;to&nbsp;self.servers[serverFor(packet.origin)].callRemote(HandlePacket,&nbsp;packet.data),&nbsp;or&nbsp;whatever.&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;I&nbsp;realize&nbsp;this&nbsp;is&nbsp;still&nbsp;pretty&nbsp;vague&nbsp;and&nbsp;high&nbsp;level,&nbsp;so&nbsp;feel&nbsp;free&nbsp;to&nbsp;ask&nbsp;more&nbsp;questions&nbsp;about&nbsp;the&nbsp;parts&nbsp;that&nbsp;are&nbsp;unclear&nbsp;:)&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Feb&nbsp;28,&nbsp;2013&nbsp;at&nbsp;10:59&nbsp;PM,&nbsp;Benjamin&nbsp;BERTRAND&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:beenje@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;beenje@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;to&nbsp;replace&nbsp;a&nbsp;piece&nbsp;of&nbsp;software&nbsp;that&nbsp;sniffs&nbsp;the&nbsp;traffic&nbsp;on&nbsp;one&nbsp;interface.&nbsp;It&nbsp;gets&nbsp;different&nbsp;messages&nbsp;that&nbsp;are&nbsp;each&nbsp;associated&nbsp;to&nbsp;a&nbsp;specific&nbsp;emitter.&lt;br&gt;<br>
On&nbsp;the&nbsp;same&nbsp;machine,&nbsp;one&nbsp;server&nbsp;is&nbsp;started&nbsp;for&nbsp;each&nbsp;emitter&nbsp;(on&nbsp;a&nbsp;different&nbsp;port).&lt;br&gt;<br>
And&nbsp;the&nbsp;application&nbsp;is&nbsp;just&nbsp;supposed&nbsp;to&nbsp;use&nbsp;the&nbsp;proper&nbsp;server&nbsp;to&nbsp;send&nbsp;the&nbsp;messages&nbsp;captured&nbsp;(to&nbsp;a&nbsp;client&nbsp;on&nbsp;another&nbsp;machine).&lt;br&gt;<br>
&lt;br&gt;<br>
Not&nbsp;sure&nbsp;if&nbsp;it&amp;#39;s&nbsp;clear,&nbsp;but&nbsp;basically&nbsp;if&nbsp;I&nbsp;have&nbsp;2&nbsp;emitters&nbsp;A&nbsp;and&nbsp;B,&nbsp;I&amp;#39;ll&nbsp;start&nbsp;2&nbsp;servers&nbsp;(a&nbsp;and&nbsp;b).&lt;br&gt;<br>
My&nbsp;sniffer&nbsp;will&nbsp;get&nbsp;messages&nbsp;A1,&nbsp;A2,&nbsp;B1,&nbsp;B2,&nbsp;B3...&lt;br&gt;<br>
I&nbsp;have&nbsp;to&nbsp;pass&nbsp;messages&nbsp;A1,&nbsp;A2&nbsp;to&nbsp;server&nbsp;a,&nbsp;that&nbsp;will&nbsp;just&nbsp;send&nbsp;them&nbsp;to&nbsp;the&nbsp;client&nbsp;(if&nbsp;it&nbsp;is&nbsp;connected&nbsp;of&nbsp;course).&lt;br&gt;<br>
And&nbsp;B1,&nbsp;B2,&nbsp;B3&nbsp;to&nbsp;server&nbsp;b.&lt;br&gt;<br>
I&nbsp;don&amp;#39;t&nbsp;need&nbsp;any&nbsp;buffering.&nbsp;If&nbsp;no&nbsp;client&nbsp;is&nbsp;connected,&nbsp;messages&nbsp;captured&nbsp;are&nbsp;just&nbsp;discarded.&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;sniff&nbsp;the&nbsp;network,&nbsp;I&nbsp;want&nbsp;to&nbsp;use&nbsp;pylibpcap&nbsp;or&nbsp;pcapy.&lt;br&gt;<br>
I&nbsp;found&nbsp;this&nbsp;example&nbsp;to&nbsp;make&nbsp;it&nbsp;work&nbsp;with&nbsp;twisted:&nbsp;&lt;a&nbsp;href=&quot;http://dound.com/2009/09/integrating-twisted-with-a-pcap-based-python-packet-sniffer/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://dound.com/2009/09/integrating-twisted-with-a-pcap-based-python-packet-sniffer/&lt;/a&gt;&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
Starting&nbsp;several&nbsp;servers&nbsp;that&nbsp;use&nbsp;the&nbsp;same&nbsp;protocol&nbsp;is&nbsp;not&nbsp;a&nbsp;problem.&lt;br&gt;<br>
But&nbsp;how&nbsp;do&nbsp;I&nbsp;pass&nbsp;the&nbsp;messages&nbsp;captured&nbsp;to&nbsp;the&nbsp;right&nbsp;server?&lt;br&gt;<br>
How&nbsp;do&nbsp;I&nbsp;make&nbsp;the&nbsp;link&nbsp;between&nbsp;the&nbsp;function&nbsp;sniffing&nbsp;the&nbsp;network&nbsp;and&nbsp;the&nbsp;servers?&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&lt;br&gt;<br>
&lt;br&gt;<br>
Benjamin&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;cheers&lt;div&gt;lvh&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
