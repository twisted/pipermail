<tt>
&lt;!DOCTYPE&nbsp;html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;/title&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;p.MsoNormal,p.MsoNoSpacing{margin:0}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;Hi&nbsp;Cheng,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;deferToThread&nbsp;*returns*&nbsp;a&nbsp;deferred,&nbsp;and&nbsp;sends&nbsp;the&nbsp;work&nbsp;to&nbsp;a&nbsp;thread&nbsp;pool.&nbsp;The&nbsp;other&nbsp;two&nbsp;functions&nbsp;are&nbsp;useful&nbsp;for&nbsp;manipulating&nbsp;deferreds&nbsp;or&nbsp;other&nbsp;promises,&nbsp;but&nbsp;will&nbsp;not&nbsp;send&nbsp;work&nbsp;to&nbsp;a&nbsp;separate&nbsp;thread,&nbsp;so&nbsp;they&nbsp;cannot&nbsp;be&nbsp;used&nbsp;instead.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;simple&nbsp;example&nbsp;is&nbsp;pretty&nbsp;simple,&nbsp;it's&nbsp;pretty&nbsp;much&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;@inlineCallbacks&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;some_function():&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1&nbsp;=&nbsp;&nbsp;deferToThread(cpu_heavy_square,&nbsp;5)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d2&nbsp;=&nbsp;deferToThread(cpu_heavy_square,&nbsp;6)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;five_squared,&nbsp;six_squared&nbsp;&nbsp;=&nbsp;yield&nbsp;gatherResults([d1,&nbsp;d2])&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returnValue(five_squared&nbsp;+&nbsp;six_squared)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Note&nbsp;that&nbsp;the&nbsp;tutorial&nbsp;below&nbsp;can&nbsp;be&nbsp;downloaded&nbsp;in&nbsp;notebook&nbsp;form&nbsp;from&nbsp;&lt;a&nbsp;href=&quot;https://github.com/moshez/twisted-tutorial/blob/master/Twisted-Tutorial.ipynb&quot;&gt;https://github.com/moshez/twisted-tutorial/blob/master/Twisted-Tutorial.ipynb&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However,&nbsp;as&nbsp;explained,&nbsp;this&nbsp;will&nbsp;*defer&nbsp;to&nbsp;threads*,&nbsp;but&nbsp;will&nbsp;*not*&nbsp;use&nbsp;multiple&nbsp;cores,&nbsp;since&nbsp;Python&nbsp;is&nbsp;single-core.&nbsp;This&nbsp;is&nbsp;not&nbsp;entirely&nbsp;accurate:&nbsp;if&nbsp;your&nbsp;heavy&nbsp;functions&nbsp;are&nbsp;using&nbsp;numpy,&nbsp;numpy&nbsp;will&nbsp;release&nbsp;the&nbsp;GIL&nbsp;sometimes.&nbsp;Otherwise,&nbsp;you&nbsp;might&nbsp;want&nbsp;to&nbsp;use&nbsp;ampoule,&nbsp;but&nbsp;there&nbsp;are&nbsp;no&nbsp;easy&nbsp;tutorials&nbsp;for&nbsp;it&nbsp;that&nbsp;I'm&nbsp;aware&nbsp;of.&nbsp;&nbsp;You&nbsp;might&nbsp;want&nbsp;to&nbsp;consider&nbsp;something&nbsp;like&nbsp;dask&nbsp;+&nbsp;deferToThread&nbsp;for&nbsp;using&nbsp;multiple&nbsp;cores.&nbsp;See&nbsp;&lt;a&nbsp;href=&quot;https://github.com/dask/dask-tutorial/blob/master/01_dask.delayed.ipynb&quot;&gt;https://github.com/dask/dask-tutorial/blob/master/01_dask.delayed.ipynb&lt;/a&gt;&nbsp;for&nbsp;a&nbsp;simple&nbsp;example:&nbsp;you&nbsp;just&nbsp;plan&nbsp;your&nbsp;computation,&nbsp;and&nbsp;run&nbsp;the&nbsp;`compute`&nbsp;method&nbsp;in&nbsp;a&nbsp;thread.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;only&nbsp;thing&nbsp;the&nbsp;thread&nbsp;is&nbsp;doing&nbsp;is&nbsp;avoiding&nbsp;blocking&nbsp;the&nbsp;reactor,&nbsp;while&nbsp;dask&nbsp;internally&nbsp;apportions&nbsp;computations.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;(Thank&nbsp;you&nbsp;for&nbsp;the&nbsp;kind&nbsp;of&nbsp;words&nbsp;about&nbsp;the&nbsp;tutorial&nbsp;--&nbsp;I'm&nbsp;one&nbsp;of&nbsp;the&nbsp;presenters.)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Moshe&nbsp;Z.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;Mon,&nbsp;Jun&nbsp;24,&nbsp;2019,&nbsp;at&nbsp;11:34,&nbsp;Chengi&nbsp;Liu&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;id=&quot;qt&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;pointing&nbsp;that&nbsp;out.&nbsp;Is&nbsp;there&nbsp;a&nbsp;dead&nbsp;simply&nbsp;example&nbsp;on&nbsp;how&nbsp;to&nbsp;parallelize&nbsp;a&nbsp;function&nbsp;using&nbsp;ampoule.&lt;br&gt;&lt;/div&gt;&lt;div&gt;Again,&nbsp;I&nbsp;have&nbsp;a&nbsp;function..&nbsp;I&nbsp;have&nbsp;a&nbsp;for&nbsp;loop..&nbsp;the&nbsp;function&nbsp;takes&nbsp;in&nbsp;an&nbsp;argument&nbsp;from&nbsp;loop..&nbsp;but&nbsp;the&nbsp;for&nbsp;loop&nbsp;is&nbsp;extremely&nbsp;parallelizable.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Also,&nbsp;I&nbsp;was&nbsp;going&nbsp;thru&nbsp;this&nbsp;awesome&nbsp;twisted&nbsp;tutorial&nbsp;from&nbsp;pycon&nbsp;2107&nbsp;(&lt;a&nbsp;href=&quot;https://www.youtube.com/watch?v=ztkBG4qLR_4&quot;&gt;https://www.youtube.com/watch?v=ztkBG4qLR_4&lt;/a&gt;)&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;found&nbsp;couple&nbsp;of&nbsp;use&nbsp;features.&lt;br&gt;&lt;/div&gt;&lt;div&gt;(&lt;span&nbsp;style=&quot;background-color:rgb(248,&nbsp;248,&nbsp;255)&quot;&nbsp;class=&quot;highlight&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,&nbsp;0,&nbsp;0)&quot;&nbsp;class=&quot;colour&quot;&gt;&lt;span&nbsp;style=&quot;font-family:Menlo&quot;&nbsp;class=&quot;font&quot;&gt;&lt;span&nbsp;style=&quot;font-size:9pt&quot;&nbsp;class=&quot;size&quot;&gt;defer.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,&nbsp;0,&nbsp;0)&quot;&nbsp;class=&quot;colour&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:Menlo&quot;&nbsp;class=&quot;font&quot;&gt;&lt;span&nbsp;style=&quot;font-size:9pt&quot;&nbsp;class=&quot;size&quot;&gt;ensureDeferred&lt;/span&gt;&lt;/span&gt;&lt;/b&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;background-color:rgb(248,&nbsp;248,&nbsp;255);color:rgb(0,&nbsp;0,&nbsp;0);font-family:Menlo;font-size:9pt;&quot;&gt;defer.&lt;span&nbsp;style=&quot;color:rgb(153,&nbsp;0,&nbsp;0)&quot;&nbsp;class=&quot;colour&quot;&gt;&lt;b&gt;gatherResults&lt;/b&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;)&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can&nbsp;these&nbsp;two&nbsp;be&nbsp;used&nbsp;instead&nbsp;of&nbsp;deferToThread.&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;are&nbsp;the&nbsp;above&nbsp;defered&nbsp;used&nbsp;and&nbsp;when&nbsp;to&nbsp;use&nbsp;deferToThread.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;entertaining&nbsp;my&nbsp;dumb&nbsp;questions.&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;qt-gmail_quote&quot;&gt;&lt;div&nbsp;class=&quot;qt-gmail_attr&quot;&nbsp;dir=&quot;ltr&quot;&gt;On&nbsp;Mon,&nbsp;Jun&nbsp;24,&nbsp;2019&nbsp;at&nbsp;1:28&nbsp;AM&nbsp;Gelin&nbsp;Yan&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:dynamicgl@gmail.com&quot;&gt;dynamicgl@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-style:solid;border-left-color:rgb(204,&nbsp;204,&nbsp;204);padding-left:1ex;&quot;&nbsp;class=&quot;qt-gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;If&nbsp;your&nbsp;purpose&nbsp;is&nbsp;merely&nbsp;not&nbsp;to&nbsp;block&nbsp;the&nbsp;reactor,&nbsp;you&nbsp;can&nbsp;run&nbsp;your&nbsp;code&nbsp;in&nbsp;a&nbsp;separate&nbsp;thread&nbsp;by&nbsp;using&nbsp;deferToThread.&nbsp;If&nbsp;you&nbsp;want&nbsp;to&nbsp;benefit&nbsp;from&nbsp;multi&nbsp;cores,&nbsp;you&nbsp;may&nbsp;consider&nbsp;use&nbsp;&lt;a&nbsp;href=&quot;https://github.com/twisted/ampoule&quot;&gt;https://github.com/twisted/ampoule&lt;/a&gt;&nbsp;or&nbsp;other&nbsp;similar&nbsp;tools.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;gelin&nbsp;yan&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;_______________________________________________&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&lt;a&nbsp;rel=&quot;noreferrer&quot;&nbsp;href=&quot;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;_______________________________________________&lt;br&gt;&lt;/div&gt;&lt;div&gt;Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;&lt;/div&gt;&lt;div&gt;Twisted-Python@twistedmatrix.com&lt;br&gt;&lt;/div&gt;&lt;div&gt;https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
