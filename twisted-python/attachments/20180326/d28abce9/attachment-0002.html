<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Mar&nbsp;26,&nbsp;2018&nbsp;at&nbsp;10:47&nbsp;AM,&nbsp;Barry&nbsp;Scott&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:barry.scott@forcepoint.com&quot;&nbsp;target=&quot;_blank&quot;&gt;barry.scott@forcepoint.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;gmail-&quot;&gt;On&nbsp;Sunday,&nbsp;18&nbsp;March&nbsp;2018&nbsp;15:23:58&nbsp;BST&nbsp;Jean-Paul&nbsp;Calderone&nbsp;wrote:&lt;br&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;Try&nbsp;this:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; from&nbsp;twisted.internet.defer&nbsp;import&nbsp;setDebugging&lt;br&gt;<br>
&gt; &nbsp; &nbsp; setDebugging(True)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;This&nbsp;gives&nbsp;you&nbsp;creation&nbsp;and&nbsp;callback&nbsp;stacks&nbsp;in&nbsp;the&nbsp;logs.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;If&nbsp;you&nbsp;need&nbsp;to&nbsp;track&nbsp;down&nbsp;who&nbsp;put&nbsp;the&nbsp;value&nbsp;into&nbsp;the&nbsp;deferred&lt;br&gt;<br>
you&nbsp;need&nbsp;to&nbsp;patch&nbsp;the&nbsp;defer.py&nbsp;code&nbsp;to&nbsp;log&nbsp;that&nbsp;info.&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;are&nbsp;2&nbsp;places&nbsp;that&nbsp;a&nbsp;value&nbsp;enters&nbsp;the&nbsp;Deferred.&lt;br&gt;<br>
The&nbsp;first&nbsp;is&nbsp;the&nbsp;callback()&nbsp;call.&nbsp;The&nbsp;other&nbsp;is&nbsp;in&lt;br&gt;<br>
&lt;br&gt;<br>
defer.py:653&nbsp;Deffered._runCallbacks()&lt;br&gt;<br>
&lt;br&gt;<br>
653: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;current.result&nbsp;=&nbsp;callback(current.result,&nbsp;*args,&lt;br&gt;<br>
**kw)&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;No,&nbsp;you&nbsp;don&#39;t:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;exarkun@baryon:/tmp$&nbsp;cat&nbsp;deferreddebug.py &lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;from&nbsp;twisted.internet.defer&nbsp;import&nbsp;fail,&nbsp;setDebugging&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;setDebugging(True)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;def&nbsp;foo():&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; &nbsp; &nbsp;return&nbsp;fail(Exception(&quot;boo&quot;))&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;foo()&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;exarkun@baryon:/tmp$&nbsp;python&nbsp;deferreddebug.py &lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;Unhandled&nbsp;error&nbsp;in&nbsp;Deferred:&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;(debug: &nbsp;C:&nbsp;Deferred&nbsp;was&nbsp;created:&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; C: &nbsp;File&nbsp;&quot;deferreddebug.py&quot;,&nbsp;line&nbsp;5,&nbsp;in&nbsp;&lt;module&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; C: &nbsp; &nbsp;foo()&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; C: &nbsp;File&nbsp;&quot;deferreddebug.py&quot;,&nbsp;line&nbsp;4,&nbsp;in&nbsp;foo&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; C: &nbsp; &nbsp;return&nbsp;fail(Exception(&quot;boo&quot;))&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; C: &nbsp;File&nbsp;&quot;/home/exarkun/.local/lib/python2.7/site-packages/twisted/internet/defer.py&quot;,&nbsp;line&nbsp;106,&nbsp;in&nbsp;fail&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; C: &nbsp; &nbsp;d&nbsp;=&nbsp;Deferred()&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; I:&nbsp;First&nbsp;Invoker&nbsp;was:&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; I: &nbsp;File&nbsp;&quot;deferreddebug.py&quot;,&nbsp;line&nbsp;5,&nbsp;in&nbsp;&lt;module&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; I: &nbsp; &nbsp;foo()&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; I: &nbsp;File&nbsp;&quot;deferreddebug.py&quot;,&nbsp;line&nbsp;4,&nbsp;in&nbsp;foo&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; I: &nbsp; &nbsp;return&nbsp;fail(Exception(&quot;boo&quot;))&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; I: &nbsp;File&nbsp;&quot;/home/exarkun/.local/lib/python2.7/site-packages/twisted/internet/defer.py&quot;,&nbsp;line&nbsp;107,&nbsp;in&nbsp;fail&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt; I: &nbsp; &nbsp;d.errback(result)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;monospace,&nbsp;monospace&quot;&gt;exarkun@baryon:/tmp$ &lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Although&nbsp;it&nbsp;is&nbsp;true&nbsp;that&nbsp;you&nbsp;only&nbsp;get&nbsp;this&nbsp;behavior&nbsp;for&nbsp;the&nbsp;&quot;Unhandled&nbsp;error&nbsp;in&nbsp;Deferred&quot;&nbsp;case. &nbsp;If&nbsp;you&nbsp;explicitly&nbsp;log&nbsp;a&nbsp;Failure&nbsp;from&nbsp;a&nbsp;Deferred,&nbsp;even&nbsp;with&nbsp;Deferred&nbsp;debugging&nbsp;on,&nbsp;you&nbsp;will&nbsp;not&nbsp;get&nbsp;a&nbsp;callstack&nbsp;for&nbsp;the&nbsp;creator&nbsp;or&nbsp;invoker. &nbsp;You&#39;ll&nbsp;just&nbsp;get&nbsp;whatever&nbsp;callstack&nbsp;the&nbsp;Failure&nbsp;has&nbsp;(and&nbsp;the&nbsp;Failure&nbsp;is&nbsp;independent&nbsp;of&nbsp;the&nbsp;Deferred).&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Jean-Paul&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
