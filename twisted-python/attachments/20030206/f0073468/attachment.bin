Index: qtreactor.py
===================================================================
RCS file: /cvs/Twisted/twisted/internet/qtreactor.py,v
retrieving revision 1.10
diff -u -3 -r1.10 qtreactor.py
--- qtreactor.py	11 Dec 2002 21:50:01 -0000	1.10
+++ qtreactor.py	6 Feb 2003 11:21:48 -0000
@@ -77,12 +77,12 @@
             log.msg('Error in %s.doRead()' % w)
             log.deferr()
         if why:
+            self.reactor.removeReader(w)
+            self.reactor.removeWriter(w)
             try:
                 w.connectionLost(failure.Failure(why))
             except:
                 log.deferr()
-            self.reactor.removeReader(w)
-            self.reactor.removeWriter(w)
         self.reactor.simulate()
 
     def write(self, sock):
@@ -96,12 +96,12 @@
             log.msg('Error in %s.doWrite()' % w)
             log.deferr()
         if why:
+            self.reactor.removeReader(w)
+            self.reactor.removeWriter(w)
             try:
                 w.connectionLost(failure.Failure(why))
             except:
                 log.deferr()
-            self.reactor.removeReader(w)
-            self.reactor.removeWriter(w)
         elif self.watcher:
             self.setEnabled(1)
         self.reactor.simulate()
