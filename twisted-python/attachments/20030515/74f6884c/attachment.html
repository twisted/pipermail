<tt>
&lt;html&gt;&lt;div&nbsp;style='background-color:'&gt;&lt;DIV&gt;&lt;FONT&nbsp;size=2&gt;<br>
&lt;P&gt;I'm&nbsp;having&nbsp;some&nbsp;trouble&nbsp;exiting&nbsp;this&nbsp;plugin.&lt;/P&gt;<br>
&lt;P&gt;I&nbsp;only&nbsp;addes&nbsp;the&nbsp;small&nbsp;dialog&nbsp;so&nbsp;I&nbsp;can&nbsp;easily&nbsp;close&nbsp;the&nbsp;ftp&nbsp;for&nbsp;testingpurposes....&lt;/P&gt;<br>
&lt;P&gt;and&nbsp;it&nbsp;used&nbsp;to&nbsp;work&nbsp;fine..actually&nbsp;the&nbsp;servers&nbsp;still&nbsp;does&lt;/P&gt;<br>
&lt;P&gt;but&nbsp;now&nbsp;I&nbsp;added&nbsp;the&nbsp;database-support&nbsp;and&nbsp;it&nbsp;crashes&nbsp;as&nbsp;soon&nbsp;as&nbsp;I&nbsp;press&nbsp;my&nbsp;closebutton...&lt;/P&gt;<br>
&lt;P&gt;it&nbsp;doesn't&nbsp;give&nbsp;any&nbsp;exceptions,&nbsp;just&nbsp;some&nbsp;access&nbsp;violations...&lt;/P&gt;<br>
&lt;P&gt;code:&lt;/P&gt;<br>
&lt;P&gt;class&nbsp;CustomDialog(Dialog):&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;button_1_command(self,&nbsp;*args):&lt;/P&gt;<br>
&lt;P&gt;top&nbsp;=&nbsp;Toplevel(self.root)&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;&quot;User&nbsp;Stopped&nbsp;Reator&quot;&lt;/P&gt;<br>
&lt;P&gt;self.pol.close()&lt;/P&gt;<br>
&lt;P&gt;reactor.stop()&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;setconn(self,&nbsp;dbppol):&lt;/P&gt;<br>
&lt;P&gt;self.pol&nbsp;=&nbsp;dbppol&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;class&nbsp;FtpDatabase(adbapi.Augmentation):&lt;/P&gt;<br>
&lt;P&gt;&quot;&quot;&quot;Extension&nbsp;for&nbsp;databaseaccess&quot;&quot;&quot;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;getDescription(self,&nbsp;user):&lt;/P&gt;<br>
&lt;P&gt;#get&nbsp;the&nbsp;users&nbsp;welcomedescription&lt;/P&gt;<br>
&lt;P&gt;sql&nbsp;=&nbsp;&quot;&quot;&quot;SELECT&nbsp;welcomemessage&nbsp;FROM&nbsp;access&nbsp;WHERE&nbsp;name&nbsp;=&nbsp;'&quot;&quot;&quot;&nbsp;+&nbsp;user&nbsp;+&nbsp;&quot;&quot;&quot;'&quot;&quot;&quot;&lt;/P&gt;<br>
&lt;P&gt;return&nbsp;self.runQuery(sql)&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;setCon(self,&nbsp;conne):&lt;/P&gt;<br>
&lt;P&gt;self.con&nbsp;=&nbsp;conne&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;class&nbsp;FtpServFactory(FTPFactory):&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;protocol&nbsp;=&nbsp;ftpserv&lt;/P&gt;<br>
&lt;P&gt;root&nbsp;=&nbsp;&quot;/temp&quot;&lt;/P&gt;<br>
&lt;P&gt;anonymous&nbsp;=&nbsp;0&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;buildProtocol(self,&nbsp;addr):&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;&quot;Building&nbsp;Protocol&quot;&lt;/P&gt;<br>
&lt;P&gt;p=ftpserv()&lt;/P&gt;<br>
&lt;P&gt;p.debug&nbsp;=&nbsp;1&lt;/P&gt;<br>
&lt;P&gt;p.passw&nbsp;=&nbsp;&quot;&quot;&lt;/P&gt;<br>
&lt;P&gt;p.factory&nbsp;=&nbsp;self&lt;/P&gt;<br>
&lt;P&gt;return&nbsp;p&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;setloc(self,op):&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;&quot;Setting&nbsp;Adminlib-location&quot;&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;op&lt;/P&gt;<br>
&lt;P&gt;try:&lt;/P&gt;<br>
&lt;P&gt;b&nbsp;=&nbsp;AdminLib.setLocation(&quot;c:\\temp\\adminlib\\&quot;)&lt;/P&gt;<br>
&lt;P&gt;val&nbsp;=&nbsp;AdminLib.getFullName(&quot;TascAdmin&quot;)&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;&quot;Location&nbsp;set!&quot;&lt;/P&gt;<br>
&lt;P&gt;except:&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;&quot;Location&nbsp;failed&nbsp;to&nbsp;be&nbsp;set!&quot;&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;gotDescription(self,resultlist):&lt;/P&gt;<br>
&lt;P&gt;&quot;&quot;&quot;Callback&nbsp;for&nbsp;handling&nbsp;teh&nbsp;result&nbsp;of&nbsp;the&nbsp;query&quot;&quot;&quot;&lt;/P&gt;<br>
&lt;P&gt;try:&lt;/P&gt;<br>
&lt;P&gt;descr&nbsp;=&nbsp;resultlist[0][0]&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;&quot;Beschrijving:&nbsp;&quot;&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;descr&nbsp;&lt;/P&gt;<br>
&lt;P&gt;except:&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;&quot;no&nbsp;description&nbsp;found&quot;&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;initt(self,suc):&lt;/P&gt;<br>
&lt;P&gt;self.dbpool&nbsp;=&nbsp;adbapi.ConnectionPool(&quot;MySQLdb&quot;,host=&quot;10.10.0.47&quot;,db=&quot;pythonftpserv&quot;,port=3306&lt;/P&gt;<br>
&lt;P&gt;,user=&quot;root&quot;,passwd=&quot;&quot;)&lt;/P&gt;<br>
&lt;P&gt;self.db&nbsp;=&nbsp;FtpDatabase(self.dbpool)&lt;/P&gt;<br>
&lt;P&gt;self.db.getDescription(&quot;TascAdmin&quot;).addCallbacks(self.gotDescription,self.db.operationError)&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;root&nbsp;=&nbsp;Tk()&lt;/P&gt;<br>
&lt;P&gt;demo&nbsp;=&nbsp;CustomDialog(root,&nbsp;self)&lt;/P&gt;<br>
&lt;P&gt;demo.setconn(self.dbpool)&lt;/P&gt;<br>
&lt;P&gt;root.protocol('WM_DELETE_WINDOW',&nbsp;root.quit)&lt;/P&gt;<br>
&lt;P&gt;root.title('Dialog')&lt;/P&gt;<br>
&lt;P&gt;tksupport.install(root)&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;def&nbsp;startFactory(self):&lt;/P&gt;<br>
&lt;P&gt;print&nbsp;&quot;Starting&nbsp;Factory&quot;&lt;/P&gt;<br>
&lt;P&gt;self.AdLib&nbsp;=&nbsp;AdminLib&lt;/P&gt;<br>
&lt;P&gt;self.d&nbsp;=&nbsp;defer.Deferred()&lt;/P&gt;<br>
&lt;P&gt;reactor.callLater(1,self.setloc,1)&lt;/P&gt;<br>
&lt;P&gt;self.initt(3)&lt;/P&gt;<br>
&lt;P&gt;############&lt;/P&gt;<br>
&lt;P&gt;&lt;/P&gt;<br>
&lt;P&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;BR&gt;&nbsp;&lt;/P&gt;&lt;/DIV&gt;&lt;/div&gt;&lt;br&nbsp;clear=all&gt;&lt;hr&gt;&nbsp;&nbsp;&lt;/html&gt;<br>
<br>
<br>

</tt>
