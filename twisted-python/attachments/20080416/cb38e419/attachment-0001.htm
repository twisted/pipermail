<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:E1JlnZk-0006P9-Ec@cube.twistedmatrix.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Date:&nbsp;Tue,&nbsp;15&nbsp;Apr&nbsp;2008&nbsp;18:38:28&nbsp;+0800<br>
From:&nbsp;Chris&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:chris.yan@saybot.com&quot;&gt;&amp;lt;chris.yan@saybot.com&amp;gt;&lt;/a&gt;<br>
Subject:&nbsp;[Twisted-Python]&nbsp;about&nbsp;smtp&nbsp;client&nbsp;auth&nbsp;problem.<br>
To:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:twisted-python@twistedmatrix.com&quot;&gt;twisted-python@twistedmatrix.com&lt;/a&gt;<br>
Message-ID:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:480485A4.6060808@saybot.com&quot;&gt;&amp;lt;480485A4.6060808@saybot.com&amp;gt;&lt;/a&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=GB2312<br>
<br>
Hi,<br>
I&nbsp;am&nbsp;trying&nbsp;to&nbsp;use&nbsp;twisted&nbsp;to&nbsp;implement&nbsp;a&nbsp;script&nbsp;to&nbsp;send&nbsp;the&nbsp;email,I&nbsp;got<br>
some&nbsp;problem.here&nbsp;is&nbsp;the&nbsp;script:<br>
####################<br>
import&nbsp;StringIO<br>
<br>
from&nbsp;twisted.application&nbsp;import&nbsp;service<br>
<br>
application&nbsp;=&nbsp;service.Application(&quot;SMTP&nbsp;Client&nbsp;Tutorial&quot;)<br>
<br>
from&nbsp;twisted.application&nbsp;import&nbsp;internet<br>
from&nbsp;twisted.python&nbsp;import&nbsp;log<br>
from&nbsp;twisted.internet&nbsp;import&nbsp;defer,&nbsp;reactor<br>
from&nbsp;twisted.mail&nbsp;import&nbsp;smtp<br>
<br>
mailFrom&nbsp;=&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:chris.yan@xxxx.com&quot;&gt;&quot;chris.yan@xxxx.com&quot;&lt;/a&gt;<br>
mailTo&nbsp;=&nbsp;[&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:chrisyan81@gmail.com&quot;&gt;&quot;chrisyan81@gmail.com&quot;&lt;/a&gt;,]<br>
mail&nbsp;=&nbsp;StringIO.StringIO(&quot;&quot;&quot;Date:&nbsp;Fri,&nbsp;3&nbsp;Nov&nbsp;2006&nbsp;230:14:39&nbsp;+0000<br>
From:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:chris.yan@xxxx.com&quot;&gt;chris.yan@xxxx.com&lt;/a&gt;<br>
To:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:chrisyan81@gmail.com&quot;&gt;chrisyan81@gmail.com&lt;/a&gt;<br>
Subject:&nbsp;Tutorate!<br>
<br>
Hello,&nbsp;how&nbsp;are&nbsp;you,&nbsp;goodbye.<br>
&quot;&quot;&quot;)<br>
<br>
whenDone&nbsp;=&nbsp;defer.Deferred()<br>
<br>
def&nbsp;send(r):<br>
print&nbsp;&quot;message&nbsp;sent:&quot;,&nbsp;r<br>
<br>
whenDone.addCallbacks(send,&nbsp;log.err)<br>
<br>
def&nbsp;done(d):<br>
from&nbsp;twisted.internet&nbsp;import&nbsp;reactor<br>
reactor.callLater(1,&nbsp;reactor.stop)<br>
<br>
whenDone.addBoth(done)<br>
<br>
<br>
sender&nbsp;=&nbsp;smtp.ESMTPSenderFactory(<br>
'chris.yan',<br>
'xxxxxx',<br>
mailFrom,<br>
mailTo,<br>
mail,<br>
whenDone,<br>
requireTransportSecurity=False<br>
)<br>
<br>
smtpClientService&nbsp;=&nbsp;internet.TCPClient('smtp.xxxx.com',&nbsp;25,&nbsp;sender)<br>
smtpClientService.setServiceParent(application)<br>
<br>
in&nbsp;fact&nbsp;the&nbsp;script&nbsp;from<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://twistedmatrix.com/pipermail/twisted-python/2006-November/014299.html,and&quot;&gt;http://twistedmatrix.com/pipermail/twisted-python/2006-November/014299.html,and&lt;/a&gt;<br>
I&nbsp;didn't&nbsp;modify&nbsp;anything&nbsp;except&nbsp;my&nbsp;own&nbsp;information.Because&nbsp;the&nbsp;smtp<br>
server&nbsp;doesn't&nbsp;support&nbsp;SSL,so&nbsp;I&nbsp;use&nbsp;requireTransportSecurity=False.<br>
<br>
here&nbsp;is&nbsp;the&nbsp;output:<br>
<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[-]&nbsp;Log&nbsp;opened.<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[-]&nbsp;twistd&nbsp;2.5.0&nbsp;(C:\Python25\python.exe&nbsp;2.5.2)<br>
starting&nbsp;up<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[-]&nbsp;reactor&nbsp;class:&nbsp;&amp;lt;class<br>
'twisted.internet.selectreactor.SelectReactor'&amp;gt;<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[-]&nbsp;Loading&nbsp;smtpclient_tls_001.py...<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[-]&nbsp;Loaded.<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[-]&nbsp;Starting&nbsp;factory<br>
&amp;lt;twisted.mail.smtp.ESMTPSenderFactory&nbsp;instance&nbsp;at&nbsp;0x01347878&amp;gt;<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[ESMTPSender,client]&nbsp;Unhandled&nbsp;Error<br>
Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):<br>
Failure:&nbsp;twisted.mail.smtp.AUTHRequiredError:&nbsp;502&nbsp;Server&nbsp;does&nbsp;not<br>
support&nbsp;Client&nbsp;Authentication&nbsp;schemes&nbsp;[CRAM-MD<br>
5,&nbsp;LOGIN,&nbsp;PLAIN]<br>
<br>
&amp;lt;&amp;lt;&amp;lt;&nbsp;250-AUTH<br>
&amp;lt;&amp;lt;&amp;lt;&nbsp;250-AUTH=PLAIN&nbsp;LOGIN&nbsp;LOGIN<br>
&amp;lt;&amp;lt;&amp;lt;&nbsp;250-XXXXXXXA<br>
&amp;lt;&amp;lt;&amp;lt;&nbsp;250&nbsp;XXXB<br>
<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[ESMTPSender,client]&nbsp;Stopping&nbsp;factory<br>
&amp;lt;twisted.mail.smtp.ESMTPSenderFactory&nbsp;instance&nbsp;at&nbsp;0x0134787<br>
8&amp;gt;<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[-]&nbsp;Main&nbsp;loop&nbsp;terminated.<br>
2008/04/15&nbsp;17:56&nbsp;+0800&nbsp;[-]&nbsp;Server&nbsp;Shut&nbsp;Down.<br>
<br>
but&nbsp;when&nbsp;I&nbsp;use&nbsp;another&nbsp;script&nbsp;which&nbsp;uses&nbsp;smtplib:<br>
SMTP_server='smtp.xxxx.com'<br>
SMTP_user='chris.yan'<br>
SMTP_passwd='xxxxx'<br>
<br>
def<br>
send_email(Subject,From,To,Attachment,Body,SMTP_server,SMTP_user,SMTP_passwd):<br>
msg&nbsp;=&nbsp;MIMEMultipart()<br>
msg['Subject']&nbsp;=&nbsp;Subject<br>
msg['From']&nbsp;=&nbsp;From<br>
msg['To']&nbsp;=&nbsp;To<br>
<br>
<br>
txt&nbsp;=&nbsp;MIMEText(Body,_charset='utf-8')<br>
msg.attach(txt)<br>
<br>
filename&nbsp;=&nbsp;Attachment<br>
if&nbsp;not&nbsp;os.path.isfile(filename):<br>
print&nbsp;'Can&nbsp;not&nbsp;find&nbsp;file&nbsp;%s,please&nbsp;check!'&nbsp;%&nbsp;filename<br>
sys.exit(1)<br>
<br>
fp&nbsp;=&nbsp;open(filename,'rb')<br>
ctype,encoding&nbsp;=&nbsp;mimetypes.guess_type(filename)<br>
if&nbsp;ctype&nbsp;is&nbsp;None&nbsp;or&nbsp;encoding&nbsp;is&nbsp;not&nbsp;None:<br>
ctype&nbsp;=&nbsp;'application/octet-stream'<br>
maintype,subtype&nbsp;=&nbsp;ctype.split('/',1)<br>
m&nbsp;=&nbsp;MIMEBase(maintype,subtype)<br>
m.set_payload(fp.read())<br>
fp.close()<br>
Encoders.encode_base64(m)<br>
m.add_header('Content-disposition','attachment',filename=filename)<br>
msg.attach(m)<br>
<br>
s&nbsp;=&nbsp;smtplib.SMTP(SMTP_server)<br>
s.debuglevel&nbsp;=&nbsp;5<br>
s.ehlo()<br>
s.esmtp_features[&quot;auth&quot;]&nbsp;=&nbsp;&quot;LOGIN&quot;<br>
<br>
s.login(SMTP_user,SMTP_passwd)<br>
s.sendmail(From,To,msg.as_string())<br>
s.close()<br>
<br>
I&nbsp;can&nbsp;get&nbsp;the&nbsp;output:<br>
send:&nbsp;'ehlo&nbsp;chris.shuobaotang.com\r\n'<br>
reply:&nbsp;'250-mail.saybot.com&nbsp;Hello&nbsp;chris.shuobaotang.com&nbsp;[218.79.132.2]\r\n'<br>
reply:&nbsp;'250-SIZE&nbsp;52428800\r\n'<br>
reply:&nbsp;'250-PIPELINING\r\n'<br>
reply:&nbsp;'250-AUTH&nbsp;\r\n'<br>
reply:&nbsp;'250-AUTH=PLAIN&nbsp;LOGIN&nbsp;LOGIN\r\n'<br>
reply:&nbsp;'250-XXXXXXXA\r\n'<br>
reply:&nbsp;'250&nbsp;XXXB\r\n'<br>
reply:&nbsp;retcode&nbsp;(250);&nbsp;Msg:&nbsp;mail.saybot.com&nbsp;Hello&nbsp;chris.shuobaotang.com<br>
[218.79.132.2]<br>
SIZE&nbsp;52428800<br>
PIPELINING<br>
AUTH<br>
AUTH=PLAIN&nbsp;LOGIN&nbsp;LOGIN<br>
XXXXXXXA<br>
XXXB<br>
send:&nbsp;'AUTH&nbsp;LOGIN&nbsp;Y2hyaXMueWFu\r\n'<br>
reply:&nbsp;'334&nbsp;UGFzc3dvcmQ6\r\n'<br>
reply:&nbsp;retcode&nbsp;(334);&nbsp;Msg:&nbsp;UGFzc3dvcmQ6<br>
send:&nbsp;'d3JpbHV5Yg==\r\n'<br>
reply:&nbsp;'235&nbsp;Authentication&nbsp;succeeded\r\n'<br>
reply:&nbsp;retcode&nbsp;(235);&nbsp;Msg:&nbsp;Authentication&nbsp;succeeded<br>
send:&nbsp;'mail&nbsp;FROM:&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:chris.yan@saybot.com&quot;&gt;&amp;lt;chris.yan@saybot.com&amp;gt;&lt;/a&gt;&nbsp;size=668\r\n'<br>
reply:&nbsp;'250&nbsp;OK\r\n'<br>
reply:&nbsp;retcode&nbsp;(250);&nbsp;Msg:&nbsp;OK<br>
send:&nbsp;'rcpt&nbsp;TO:&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:chrisyan81@gmail.com&quot;&gt;&amp;lt;chrisyan81@gmail.com&amp;gt;&lt;/a&gt;\r\n'<br>
reply:&nbsp;'250&nbsp;Accepted\r\n'<br>
reply:&nbsp;retcode&nbsp;(250);&nbsp;Msg:&nbsp;Accepted<br>
send:&nbsp;'data\r\n'<br>
reply:&nbsp;'354&nbsp;Enter&nbsp;message,&nbsp;ending&nbsp;with&nbsp;&quot;.&quot;&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself\r\n'<br>
reply:&nbsp;retcode&nbsp;(354);&nbsp;Msg:&nbsp;Enter&nbsp;message,&nbsp;ending&nbsp;with&nbsp;&quot;.&quot;&nbsp;on&nbsp;a&nbsp;line&nbsp;by<br>
itself<br>
data:&nbsp;(354,&nbsp;'Enter&nbsp;message,&nbsp;ending&nbsp;with&nbsp;&quot;.&quot;&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself')<br>
send:&nbsp;'Content-Type:&nbsp;multipart/mixed;<br>
boundary=&quot;===============1595669237==&quot;\r\nMIME-Version:&nbsp;1.0\r\nSubject:<br>
scores&nbsp;fro<br>
m&nbsp;saybot&nbsp;rater.\r\nFrom:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:chris.yan@saybot.com\r\nTo:&quot;&gt;chris.yan@saybot.com\r\nTo:&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:chrisyan81@gmail.com\r\n\r\n--===============1595669237==\r\nConten&quot;&gt;chrisyan81@gmail.com\r\n\r\n--===============1595669237==\r\nConten&lt;/a&gt;<br>
t-Type:&nbsp;text/plain;&nbsp;charset=&quot;utf-8&quot;\r\nMIME-Version:<br>
1.0\r\nContent-Transfer-Encoding:&nbsp;base64\r\n\r\nSGksCiAgICBUaGlzIGl<br>
zIHRoZSBzY29yZXMgd2hpY2ggZ2VuZXJhdGVkIGJ5IHNheWJvdCByYXRl\r\ncixwbGVhc2UgY2hlY2sgdGhlIGF0dGFjaG1lbnQhCgpCZXN0UmVnYXJkCkN<br>
ocmlzCg==\r\n\r\n--===============1595669237==\r\nContent-Type:<br>
text/plain\r\nMIME-Version:&nbsp;1.0\r\nContent-Transfer-Enco<br>
ding:&nbsp;base64\r\nContent-disposition:&nbsp;attachment;<br>
filename=&quot;scores.txt&quot;\r\n\r\nMTM4MTMwMzE0NzUg17/Hvw0K\r\n\r\n--========<br>
=======1595669237==--\r\n.\r\n'<br>
reply:&nbsp;'250&nbsp;OK&nbsp;id=1Jlhvl-00071w-1f\r\n'<br>
reply:&nbsp;retcode&nbsp;(250);&nbsp;Msg:&nbsp;OK&nbsp;id=1Jlhvl-00071w-1f<br>
data:&nbsp;(250,&nbsp;'OK&nbsp;id=1Jlhvl-00071w-1f')<br>
Done.<br>
<br>
some&nbsp;guy&nbsp;said,this&nbsp;script&nbsp;force&nbsp;to&nbsp;use&nbsp;the&nbsp;LOGIN&nbsp;auth,because&nbsp;something<br>
wrong&nbsp;with&nbsp;the&nbsp;server,is&nbsp;it&nbsp;true?I&nbsp;don't&nbsp;know&nbsp;very&nbsp;much&nbsp;about&nbsp;the&nbsp;mail<br>
server,does&nbsp;any&nbsp;one&nbsp;can&nbsp;tell&nbsp;me&nbsp;if&nbsp;I&nbsp;can&nbsp;make&nbsp;my&nbsp;twisted&nbsp;script&nbsp;work?I<br>
really&nbsp;like&nbsp;to&nbsp;implement&nbsp;a&nbsp;twisted&nbsp;one.<br>
<br>
BestWishes<br>
Chris<br>
<br>
<br>
<br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message:&nbsp;3<br>
Date:&nbsp;Tue,&nbsp;15&nbsp;Apr&nbsp;2008&nbsp;13:24:12&nbsp;+0200<br>
From:&nbsp;Gabriel&nbsp;Rossetti&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:mailing_lists@evotex.ch&quot;&gt;&amp;lt;mailing_lists@evotex.ch&amp;gt;&lt;/a&gt;<br>
Subject:&nbsp;Re:&nbsp;[Twisted-Python]&nbsp;shared&nbsp;list&nbsp;in&nbsp;factory,&nbsp;mutexes?<br>
To:&nbsp;Twisted&nbsp;general&nbsp;discussion&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:twisted-python@twistedmatrix.com&quot;&gt;&amp;lt;twisted-python@twistedmatrix.com&amp;gt;&lt;/a&gt;<br>
Message-ID:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:4804905C.5030608@evotex.ch&quot;&gt;&amp;lt;4804905C.5030608@evotex.ch&amp;gt;&lt;/a&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=ISO-8859-1;&nbsp;format=flowed<br>
<br>
Simon&nbsp;Pickles&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
Gabriel&nbsp;Rossetti&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;each&nbsp;thread&nbsp;is&nbsp;an&nbsp;individual&nbsp;self-contained&nbsp;unit&nbsp;that&nbsp;does&nbsp;whatever&nbsp;<br>
processing&nbsp;it&nbsp;needs&nbsp;to&nbsp;do&nbsp;however&nbsp;long&nbsp;it&nbsp;may&nbsp;need&nbsp;to&nbsp;take,&nbsp;and&nbsp;the&nbsp;<br>
OS&nbsp;takes&nbsp;care&nbsp;of&nbsp;scheduling&nbsp;each&nbsp;thread,&nbsp;but&nbsp;with&nbsp;twisted,&nbsp;the&nbsp;main&nbsp;<br>
thread&nbsp;executes&nbsp;each&nbsp;connection&nbsp;one&nbsp;by&nbsp;one&nbsp;sequentially&nbsp;and&nbsp;thus&nbsp;if&nbsp;<br>
one&nbsp;of&nbsp;them&nbsp;needs&nbsp;to&nbsp;to&nbsp;some&nbsp;lengthy&nbsp;processing,&nbsp;it&nbsp;will&nbsp;block&nbsp;all&nbsp;<br>
other&nbsp;connections&nbsp;from&nbsp;being&nbsp;processed,&nbsp;so&nbsp;you&nbsp;have&nbsp;to&nbsp;use&nbsp;threads&nbsp;to&nbsp;<br>
keep&nbsp;it&nbsp;from&nbsp;blocking,&nbsp;but&nbsp;somehow&nbsp;the&nbsp;active&nbsp;connection&nbsp;should&nbsp;<br>
become&nbsp;inactive&nbsp;while&nbsp;the&nbsp;processing&nbsp;thread&nbsp;does&nbsp;it's&nbsp;work,&nbsp;so&nbsp;that&nbsp;<br>
another&nbsp;connection&nbsp;can&nbsp;be&nbsp;processed&nbsp;in&nbsp;the&nbsp;meantime.<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hi&nbsp;Gabriel,<br>
<br>
Have&nbsp;you&nbsp;considered&nbsp;implementing&nbsp;Stackless&nbsp;python&nbsp;in&nbsp;partnership&nbsp;with&nbsp;<br>
Twisted?&nbsp;I&nbsp;am&nbsp;finding&nbsp;it&nbsp;very&nbsp;useful&nbsp;for&nbsp;handling&nbsp;multiple&nbsp;concurrent&nbsp;<br>
connections&nbsp;in&nbsp;a&nbsp;single&nbsp;thread.&nbsp;(it&nbsp;uses&nbsp;a&nbsp;scheduler&nbsp;which&nbsp;can&nbsp;switch&nbsp;<br>
between&nbsp;tasklets,&nbsp;in&nbsp;a&nbsp;yield&nbsp;fashion.)<br>
<br>
The&nbsp;programmer&nbsp;has&nbsp;complete&nbsp;control&nbsp;over&nbsp;where&nbsp;this&nbsp;tasklet&nbsp;switching&nbsp;<br>
takes&nbsp;place,&nbsp;vastly&nbsp;simplifying&nbsp;things&nbsp;over&nbsp;multi-threading.&nbsp;If&nbsp;one&nbsp;<br>
connection&nbsp;involves&nbsp;some&nbsp;heavy&nbsp;processing,&nbsp;I&nbsp;simply&nbsp;add&nbsp;a&nbsp;<br>
stackless.schedule()&nbsp;in&nbsp;the&nbsp;blocking&nbsp;loop&nbsp;which&nbsp;allows&nbsp;waiting&nbsp;jobs&nbsp;to&nbsp;<br>
run&nbsp;too.&nbsp;Overhead&nbsp;for&nbsp;this&nbsp;tasklet&nbsp;switching&nbsp;is&nbsp;almost&nbsp;negligible&nbsp;too,&nbsp;<br>
unlike&nbsp;threads.<br>
<br>
Regards<br>
<br>
Simon<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;Thanks&nbsp;Simon,&nbsp;I'll&nbsp;look&nbsp;into&nbsp;that,&nbsp;but&nbsp;I&nbsp;think&nbsp;that&nbsp;now&nbsp;that&nbsp;I&nbsp;<br>
understand&nbsp;better&nbsp;how&nbsp;twisted&nbsp;works,&nbsp;I'll&nbsp;stick&nbsp;with&nbsp;it&nbsp;&quot;purely&quot;&nbsp;:-)<br>
<br>
Stackless&nbsp;is&nbsp;a&nbsp;python&nbsp;distrib&nbsp;though,&nbsp;from&nbsp;what&nbsp;I&nbsp;see.<br>
<br>
Thanks,<br>
Gabriel<br>
<br>
<br>
<br>
------------------------------<br>
<br>
Message:&nbsp;4<br>
Date:&nbsp;Tue,&nbsp;15&nbsp;Apr&nbsp;2008&nbsp;08:01:13&nbsp;-0400<br>
From:&nbsp;Jean-Paul&nbsp;Calderone&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:exarkun@divmod.com&quot;&gt;&amp;lt;exarkun@divmod.com&amp;gt;&lt;/a&gt;<br>
Subject:&nbsp;Re:&nbsp;[Twisted-Python]&nbsp;about&nbsp;smtp&nbsp;client&nbsp;auth&nbsp;problem.<br>
To:&nbsp;Twisted&nbsp;general&nbsp;discussion&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:twisted-python@twistedmatrix.com&quot;&gt;&amp;lt;twisted-python@twistedmatrix.com&amp;gt;&lt;/a&gt;<br>
Message-ID:&nbsp;&amp;lt;20080415120113.6859.490721552.divmod.quotient.30011@ohm&amp;gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;format=flowed<br>
<br>
On&nbsp;Tue,&nbsp;15&nbsp;Apr&nbsp;2008&nbsp;18:38:28&nbsp;+0800,&nbsp;Chris&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:chris.yan@saybot.com&quot;&gt;&amp;lt;chris.yan@saybot.com&amp;gt;&lt;/a&gt;&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hi,<br>
I&nbsp;am&nbsp;trying&nbsp;to&nbsp;use&nbsp;twisted&nbsp;to&nbsp;implement&nbsp;a&nbsp;script&nbsp;to&nbsp;send&nbsp;the&nbsp;email,I&nbsp;got<br>
some&nbsp;problem.here&nbsp;is&nbsp;the&nbsp;script:<br>
####################<br>
[snip]<br>
<br>
&amp;lt;&amp;lt;&amp;lt;&nbsp;250-AUTH<br>
&amp;lt;&amp;lt;&amp;lt;&nbsp;250-AUTH=PLAIN&nbsp;LOGIN&nbsp;LOGIN<br>
&amp;lt;&amp;lt;&amp;lt;&nbsp;250-XXXXXXXA<br>
&amp;lt;&amp;lt;&amp;lt;&nbsp;250&nbsp;XXXB<br>
<br>
[snip]<br>
<br>
some&nbsp;guy&nbsp;said,this&nbsp;script&nbsp;force&nbsp;to&nbsp;use&nbsp;the&nbsp;LOGIN&nbsp;auth,because&nbsp;something<br>
wrong&nbsp;with&nbsp;the&nbsp;server,is&nbsp;it&nbsp;true?I&nbsp;don't&nbsp;know&nbsp;very&nbsp;much&nbsp;about&nbsp;the&nbsp;mail<br>
server,does&nbsp;any&nbsp;one&nbsp;can&nbsp;tell&nbsp;me&nbsp;if&nbsp;I&nbsp;can&nbsp;make&nbsp;my&nbsp;twisted&nbsp;script&nbsp;work?I<br>
really&nbsp;like&nbsp;to&nbsp;implement&nbsp;a&nbsp;twisted&nbsp;one.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
Indeed,&nbsp;the&nbsp;ESMTP&nbsp;server&nbsp;is&nbsp;not&nbsp;correctly&nbsp;advertising&nbsp;its&nbsp;support&nbsp;for&nbsp;the<br>
AUTH&nbsp;extension.&nbsp;&nbsp;<br>
<br>
You&nbsp;can&nbsp;hack&nbsp;around&nbsp;this&nbsp;by&nbsp;going&nbsp;up&nbsp;to&nbsp;the&nbsp;ESMTP&nbsp;protocol&nbsp;implementation<br>
in&nbsp;Twisted&nbsp;and&nbsp;tweaking&nbsp;its&nbsp;behavior&nbsp;a&nbsp;bit&nbsp;with&nbsp;a&nbsp;subclass&nbsp;(untested):<br>
<br>
&nbsp;&nbsp;from&nbsp;twisted.mail.smtp&nbsp;import&nbsp;ESMTPClient<br>
<br>
&nbsp;&nbsp;class&nbsp;ForceLOGINESMTPClient(ESMTPClient):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;authenticate(self,&nbsp;code,&nbsp;resp,&nbsp;items):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;'AUTH=PLAIN'&nbsp;in&nbsp;items:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;items['AUTH']&nbsp;=&nbsp;'PLAIN&nbsp;'&nbsp;+&nbsp;items['AUTH=PLAIN']<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ESMTPClient.authenticate(self,&nbsp;code,&nbsp;resp,&nbsp;items)<br>
<br>
Then,&nbsp;use&nbsp;this&nbsp;protocol&nbsp;with&nbsp;your&nbsp;ESMTPSenderFactory.&nbsp;&nbsp;The&nbsp;idea&nbsp;here&nbsp;is<br>
that&nbsp;this&nbsp;subclass&nbsp;notices&nbsp;the&nbsp;particular&nbsp;kind&nbsp;of&nbsp;malformed&nbsp;response&nbsp;this<br>
server&nbsp;sends&nbsp;and&nbsp;adjusts&nbsp;it&nbsp;slightly.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;bit&nbsp;better&nbsp;than&nbsp;the&nbsp;other<br>
version&nbsp;you&nbsp;gave&nbsp;which&nbsp;just&nbsp;hard-coded&nbsp;LOGIN,&nbsp;since&nbsp;it&nbsp;should&nbsp;manage&nbsp;to<br>
actually&nbsp;correctly&nbsp;interpret&nbsp;the&nbsp;mechanisms&nbsp;the&nbsp;server&nbsp;is&nbsp;advertising.&nbsp;&nbsp;Of<br>
course,&nbsp;it&nbsp;may&nbsp;be&nbsp;a&nbsp;bit&nbsp;more&nbsp;fragile&nbsp;too,&nbsp;since&nbsp;it&nbsp;depends&nbsp;on&nbsp;the&nbsp;exact<br>
kind&nbsp;of&nbsp;misformatting&nbsp;the&nbsp;server&nbsp;is&nbsp;doing.&nbsp;&nbsp;If&nbsp;you&nbsp;want&nbsp;to&nbsp;avoid&nbsp;that,<br>
you&nbsp;can&nbsp;hard-code&nbsp;LOGIN&nbsp;by&nbsp;just&nbsp;setting&nbsp;items['AUTH']&nbsp;=&nbsp;'LOGIN'.<br>
<br>
Hope&nbsp;this&nbsp;helps,<br>
<br>
Jean-Paul<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
Hi&nbsp;Jean-Paul,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Thank&nbsp;you&nbsp;very&nbsp;much,I&nbsp;think&nbsp;it&nbsp;works.this&nbsp;is&nbsp;the&nbsp;script:&lt;br&gt;<br>
#!/usr/bin/env&nbsp;python&lt;br&gt;<br>
import&nbsp;StringIO&lt;br&gt;<br>
&lt;br&gt;<br>
from&nbsp;twisted.application&nbsp;import&nbsp;service&lt;br&gt;<br>
&lt;br&gt;<br>
application&nbsp;=&nbsp;service.Application(&quot;SMTP&nbsp;Client&nbsp;Tutorial&quot;)&lt;br&gt;<br>
&lt;br&gt;<br>
from&nbsp;twisted.application&nbsp;import&nbsp;internet&lt;br&gt;<br>
from&nbsp;twisted.python&nbsp;import&nbsp;log&lt;br&gt;<br>
from&nbsp;twisted.internet&nbsp;import&nbsp;defer,&nbsp;reactor&lt;br&gt;<br>
from&nbsp;twisted.mail&nbsp;import&nbsp;smtp&lt;br&gt;<br>
&lt;br&gt;<br>
mailFrom&nbsp;=&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:chris.yan@saybot.com&quot;&gt;&quot;chris.yan@saybot.com&quot;&lt;/a&gt;&lt;br&gt;<br>
mailTo&nbsp;=&nbsp;[&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:chrisyan81@gmail.com&quot;&gt;&quot;chrisyan81@gmail.com&quot;&lt;/a&gt;,]&lt;br&gt;<br>
mail&nbsp;=&nbsp;StringIO.StringIO(&quot;&quot;&quot;Date:&nbsp;Fri,&nbsp;3&nbsp;Nov&nbsp;2006&nbsp;230:14:39&nbsp;+0000&lt;br&gt;<br>
From:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:chris.yan@saybot.com&quot;&gt;chris.yan@saybot.com&lt;/a&gt;&lt;br&gt;<br>
To:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:chrisyan81@gmail.com&quot;&gt;chrisyan81@gmail.com&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;Tutorate!&lt;br&gt;<br>
&lt;br&gt;<br>
Hello,&nbsp;how&nbsp;are&nbsp;you,&nbsp;goodbye.&lt;br&gt;<br>
&quot;&quot;&quot;)&lt;br&gt;<br>
&lt;br&gt;<br>
whenDone&nbsp;=&nbsp;defer.Deferred()&lt;br&gt;<br>
&lt;br&gt;<br>
def&nbsp;send(r):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&quot;message&nbsp;sent:&quot;,&nbsp;r&lt;br&gt;<br>
&lt;br&gt;<br>
whenDone.addCallbacks(send,&nbsp;log.err)&lt;br&gt;<br>
&lt;br&gt;<br>
def&nbsp;done(d):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reactor.callLater(1,&nbsp;reactor.stop)&lt;br&gt;<br>
&lt;br&gt;<br>
whenDone.addBoth(done)&lt;br&gt;<br>
&lt;br&gt;<br>
#this&nbsp;is&nbsp;the&nbsp;class&nbsp;from&nbsp;you&lt;br&gt;<br>
class&nbsp;ForceLOGINESMTPClient(smtp.ESMTPClient):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;authenticate(self,&nbsp;code,&nbsp;resp,&nbsp;items):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#if&nbsp;'AUTH=PLAIN'&nbsp;in&nbsp;items:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&amp;nbsp;&amp;nbsp;&nbsp;items['AUTH']&nbsp;=&nbsp;'PLAIN&nbsp;'&nbsp;+&nbsp;items['AUTH=PLAIN']&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;items['AUTH']&nbsp;=&nbsp;'LOGIN'&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;smtp.ESMTPClient.authenticate(self,&nbsp;code,&nbsp;resp,&nbsp;items)&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;#I&nbsp;saw&nbsp;the&nbsp;twisted.mail.smtp.ESMTPSenderFactory&nbsp;use&nbsp;the&nbsp;ESMTPSender&nbsp;as<br>
the&nbsp;protocol,so&nbsp;I&nbsp;copied&nbsp;the&nbsp;implementation&nbsp;here,just&nbsp;make&nbsp;new&nbsp;one&amp;nbsp;<br>
inherit&nbsp;from&nbsp;ForceLOGINESMTPClient,I&nbsp;did&nbsp;not&nbsp;touch&nbsp;anything&nbsp;else.&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;<br>
class&nbsp;ForceLOGINESMTPSender(smtp.SenderMixin,ForceLOGINESMTPClient):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;requireAuthentication&nbsp;=&nbsp;True&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;requireTransportSecurity&nbsp;=&nbsp;True&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;username,&nbsp;secret,&nbsp;contextFactory=None,&nbsp;*args,<br>
**kw):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.heloFallback&nbsp;=&nbsp;0&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.username&nbsp;=&nbsp;username&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;contextFactory&nbsp;is&nbsp;None:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;contextFactory&nbsp;=&nbsp;self._getContextFactory()&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ForceLOGINESMTPClient.__init__(self,&nbsp;secret,&nbsp;contextFactory,<br>
*args,&nbsp;**kw)&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self._registerAuthenticators()&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;_registerAuthenticators(self):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&nbsp;Register&nbsp;Authenticator&nbsp;in&nbsp;order&nbsp;from&nbsp;most&nbsp;secure&nbsp;to&nbsp;least<br>
secure&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
self.registerAuthenticator(smtp.CramMD5ClientAuthenticator(self.username))&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
self.registerAuthenticator(smtp.LOGINAuthenticator(self.username))&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
self.registerAuthenticator(smtp.PLAINAuthenticator(self.username))&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;_getContextFactory(self):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;self.context&nbsp;is&nbsp;not&nbsp;None:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;self.context&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;try:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;ssl&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;except&nbsp;ImportError:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;None&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;try:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;context&nbsp;=&nbsp;ssl.ClientContextFactory()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;context.method&nbsp;=&nbsp;ssl.SSL.TLSv1_METHOD&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;context&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;except&nbsp;AttributeError:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;None&lt;br&gt;<br>
&lt;br&gt;<br>
#use&nbsp;the&nbsp;ForceLOGINESMTPSender&nbsp;as&nbsp;the&nbsp;protocol,&amp;nbsp;&nbsp;inherit&nbsp;the&nbsp;rest&nbsp;from&amp;nbsp;<br>
ESMTPSenderFactory&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;<br>
class&nbsp;ForceLOGNINESMTPSenderFactory(smtp.ESMTPSenderFactory):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;protocol&nbsp;=&nbsp;ForceLOGINESMTPSender&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
sender&nbsp;=&nbsp;ForceLOGNINESMTPSenderFactory(&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;'chris.yan',&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;'xxxx',&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;mailFrom,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;mailTo,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;mail,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;whenDone,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;requireTransportSecurity=False&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;)&lt;br&gt;<br>
&lt;br&gt;<br>
smtpClientService&nbsp;=&nbsp;internet.TCPClient('smtp.xxxx.com',&nbsp;25,&nbsp;sender)&lt;br&gt;<br>
smtpClientService.setServiceParent(application)&lt;br&gt;<br>
&lt;br&gt;<br>
BestRegards&lt;br&gt;<br>
Chris&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>
<br>
<br>

</tt>
