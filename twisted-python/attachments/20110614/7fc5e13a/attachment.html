<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Jun&nbsp;14,&nbsp;2011,&nbsp;at&nbsp;2:37&nbsp;PM,&nbsp;&lt;a&nbsp;href=&quot;mailto:exarkun@twistedmatrix.com&quot;&gt;exarkun@twistedmatrix.com&lt;/a&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;On&nbsp;07:37&nbsp;am,&nbsp;&lt;a&nbsp;href=&quot;mailto:albert.brandl@weiermayer.com&quot;&gt;albert.brandl@weiermayer.com&lt;/a&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;We've&nbsp;defined&nbsp;a&nbsp;constant&nbsp;GPS_PORT&nbsp;as&nbsp;&quot;SERIAL:/dev/ttyS2:baudrate=4800&quot;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;for&nbsp;the&nbsp;production&nbsp;environment&nbsp;and&nbsp;&quot;tcp:1049&quot;&nbsp;for&nbsp;the&nbsp;test&nbsp;environment&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;To&nbsp;be&nbsp;clear,&nbsp;though,&nbsp;it&nbsp;sounds&nbsp;like&nbsp;you're&nbsp;defining&nbsp;GPS_PORT&nbsp;in&nbsp;a&nbsp;.py&nbsp;&lt;br&gt;file,&nbsp;and&nbsp;that's&nbsp;more&nbsp;or&nbsp;less&nbsp;what&nbsp;I&nbsp;was&nbsp;speaking&nbsp;against.&nbsp;:)&nbsp;&nbsp;Instead,&nbsp;&lt;br&gt;I&nbsp;would&nbsp;define&nbsp;GPS_PORT&nbsp;as&nbsp;either&nbsp;SerialEndpoint(reactor,&nbsp;&quot;/dev/ttyS2&quot;,&nbsp;&lt;br&gt;baudrate=4800)&nbsp;or&nbsp;TCP4ServerEndpoint(reactor,&nbsp;1049).&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;a&nbsp;rare&nbsp;show&nbsp;of&nbsp;dissent&nbsp;within&nbsp;the&nbsp;cabal[1],&nbsp;I&nbsp;disagree&nbsp;with&nbsp;Jean-Paul&nbsp;on&nbsp;this.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;The&nbsp;rest&nbsp;of&nbsp;your&nbsp;code&nbsp;can&nbsp;still&nbsp;be&nbsp;indifferent&nbsp;to&nbsp;which&nbsp;of&nbsp;these&nbsp;is&nbsp;in&nbsp;play&nbsp;(and&nbsp;you&nbsp;can&nbsp;have&nbsp;a&nbsp;service&nbsp;for&nbsp;either&nbsp;of&nbsp;these&nbsp;using&nbsp;StreamServerEndpointService).&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;the&nbsp;most&nbsp;important&nbsp;point&nbsp;to&nbsp;take&nbsp;away,&nbsp;and&nbsp;I&nbsp;agree&nbsp;with&nbsp;it.&nbsp;&nbsp;As&nbsp;much&nbsp;as&nbsp;possible,&nbsp;code&nbsp;should&nbsp;interact&nbsp;with&nbsp;endpoints&nbsp;as&nbsp;parameters.&nbsp;&nbsp;If&nbsp;you&nbsp;need&nbsp;to&nbsp;pass&nbsp;something&nbsp;around,&nbsp;pass&nbsp;the&nbsp;endpoint&nbsp;or&nbsp;the&nbsp;service&nbsp;itself,&nbsp;not&nbsp;the&nbsp;string&nbsp;or&nbsp;the&nbsp;parameters&nbsp;used&nbsp;to&nbsp;construct&nbsp;it.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;If&nbsp;you&nbsp;misspell&nbsp;something&nbsp;or&nbsp;leave&nbsp;off&nbsp;a&nbsp;required&nbsp;argument,&nbsp;though,&nbsp;you're&nbsp;more&nbsp;likely&nbsp;to&nbsp;get&nbsp;an&nbsp;exception&nbsp;that&nbsp;points&nbsp;more&nbsp;directly&nbsp;at&nbsp;the&nbsp;problem.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;First,&nbsp;if&nbsp;you&nbsp;find&nbsp;bad&nbsp;error&nbsp;reporting&nbsp;while&nbsp;using&nbsp;the&nbsp;string-using&nbsp;APIs,&nbsp;it&nbsp;would&nbsp;be&nbsp;better&nbsp;to&nbsp;file&nbsp;a&nbsp;bug&nbsp;for&nbsp;improved&nbsp;error&nbsp;handling&nbsp;than&nbsp;to&nbsp;switch&nbsp;to&nbsp;hard-coding&nbsp;your&nbsp;endpoint&nbsp;types.&nbsp;&nbsp;There's&nbsp;no&nbsp;particular&nbsp;reason&nbsp;that&nbsp;error-reporting&nbsp;needs&nbsp;to&nbsp;be&nbsp;worse&nbsp;in&nbsp;that&nbsp;case.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Second,&nbsp;I&nbsp;hate&nbsp;to&nbsp;say&nbsp;so,&nbsp;but&nbsp;the&nbsp;current&nbsp;error-reporting&nbsp;behavior&nbsp;wasn't&nbsp;designed&nbsp;particularly&nbsp;thoughtfully&nbsp;in&nbsp;either&nbsp;system,&nbsp;so&nbsp;in&nbsp;practice,&nbsp;sometimes&nbsp;you'll&nbsp;get&nbsp;better&nbsp;reporting&nbsp;from&nbsp;one&nbsp;and&nbsp;in&nbsp;some&nbsp;you'll&nbsp;get&nbsp;it&nbsp;from&nbsp;the&nbsp;other.&nbsp;&nbsp;For&nbsp;example:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;webkit-indent-blockquote&quot;&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;from&nbsp;twisted.internet.endpoints&nbsp;import&nbsp;TCP4ServerEndpoint,&nbsp;serverFromString&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/div&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;serverFromString(reactor,&nbsp;'bananas')&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;...&lt;/div&gt;&lt;div&gt;ValueError:&nbsp;Unqualified&nbsp;strport&nbsp;description&nbsp;passed&nbsp;to&nbsp;'service'.&nbsp;Use&nbsp;qualified&nbsp;endpoint&nbsp;descriptions;&nbsp;for&nbsp;example,&nbsp;'tcp:bananas'.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;serverFromString(reactor,&nbsp;'tcp:bananas')&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;...&lt;/div&gt;&lt;div&gt;ValueError:&nbsp;invalid&nbsp;literal&nbsp;for&nbsp;int()&nbsp;with&nbsp;base&nbsp;10:&nbsp;'bananas'&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;TCP4ServerEndpoint(reactor,&nbsp;'bananas')&lt;/div&gt;&lt;div&gt;&lt;twisted.internet.endpoints.TCP4ServerEndpoint&nbsp;object&nbsp;at&nbsp;0x103629190&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;TCP4ServerEndpoint(reactor)&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;...&lt;/div&gt;&lt;div&gt;TypeError:&nbsp;__init__()&nbsp;takes&nbsp;at&nbsp;least&nbsp;3&nbsp;arguments&nbsp;(2&nbsp;given)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;serverFromString(reactor,&nbsp;'tcp:')&lt;/div&gt;&lt;div&gt;Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;...&lt;/div&gt;&lt;div&gt;ValueError:&nbsp;invalid&nbsp;literal&nbsp;for&nbsp;int()&nbsp;with&nbsp;base&nbsp;10:&nbsp;''&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;serverFromString(reactor,&nbsp;&quot;bananas:&quot;)&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;...&lt;/div&gt;&lt;div&gt;ValueError:&nbsp;Unknown&nbsp;endpoint&nbsp;type:&nbsp;'bananas'&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Both&nbsp;of&nbsp;these&nbsp;really&nbsp;*should*&nbsp;be&nbsp;saying:&nbsp;&quot;'bananas'&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;TCP&nbsp;port&nbsp;number&quot;&nbsp;or&nbsp;&quot;TCP&nbsp;requires&nbsp;a&nbsp;port&nbsp;number&quot;.&nbsp;&nbsp;(Python's&nbsp;error&nbsp;reporting&nbsp;could&nbsp;use&nbsp;some&nbsp;improving&nbsp;here&nbsp;too:&nbsp;which&nbsp;__init__,&nbsp;exactly?)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Personally,&nbsp;I&nbsp;recommend&nbsp;that&nbsp;most&nbsp;developers&nbsp;prefer&nbsp;the&nbsp;string-based&nbsp;APIs,&nbsp;because&nbsp;they&nbsp;allow&nbsp;for&nbsp;more&nbsp;flexibility&nbsp;with&nbsp;less&nbsp;code.&nbsp;&nbsp;(Granted,&nbsp;not&nbsp;a&nbsp;&lt;i&gt;lot&lt;/i&gt;&nbsp;less&nbsp;code:&nbsp;just&nbsp;the&nbsp;N&nbsp;imports&nbsp;for&nbsp;each&nbsp;endpoint&nbsp;type&nbsp;you&nbsp;might&nbsp;support&nbsp;vs.&nbsp;the&nbsp;1&nbsp;import&nbsp;for&nbsp;serverFromString&nbsp;or&nbsp;strports.service.)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;you&nbsp;create&nbsp;a&nbsp;TCP4ServerEndpoint,&nbsp;that&nbsp;is&nbsp;an&nbsp;object&nbsp;with&nbsp;a&nbsp;very&nbsp;specific&nbsp;contract.&nbsp;&nbsp;However,&nbsp;an&nbsp;endpoint&nbsp;created&nbsp;with&nbsp;the&nbsp;&quot;tcp:&quot;&nbsp;prefix&nbsp;passed&nbsp;to&nbsp;serverFromString&nbsp;has&nbsp;an&nbsp;opportunity&nbsp;for&nbsp;more&nbsp;dynamic&nbsp;behavior.&nbsp;&nbsp;The&nbsp;former&nbsp;must&nbsp;always&nbsp;bind&nbsp;to&nbsp;TCPv4&nbsp;sockets.&nbsp;&nbsp;The&nbsp;latter,&nbsp;however,&nbsp;may&nbsp;develop&nbsp;different&nbsp;behavior.&nbsp;&nbsp;For&nbsp;example,&nbsp;IPv6&nbsp;support&nbsp;&quot;for&nbsp;free&quot;&nbsp;would&nbsp;be&nbsp;possible&nbsp;with&nbsp;this&nbsp;API,&nbsp;because&nbsp;by&nbsp;using&nbsp;the&nbsp;string-based&nbsp;APIs&nbsp;you&nbsp;are&nbsp;explicitly&nbsp;saying&nbsp;&quot;I&nbsp;am&nbsp;passing&nbsp;some&nbsp;input&nbsp;in&nbsp;here,&nbsp;and&nbsp;I&nbsp;don't&nbsp;know&nbsp;what&nbsp;kind&nbsp;of&nbsp;stream-based&nbsp;transport&nbsp;I&nbsp;might&nbsp;get&quot;.&nbsp;&nbsp;The&nbsp;compatibility&nbsp;contract&nbsp;with&nbsp;this&nbsp;code&nbsp;is&nbsp;much&nbsp;weaker,&nbsp;because&nbsp;it&nbsp;supports&nbsp;plugins,&nbsp;and&nbsp;&lt;i&gt;already&lt;/i&gt;&nbsp;might&nbsp;be&nbsp;giving&nbsp;you&nbsp;lots&nbsp;of&nbsp;different&nbsp;kinds&nbsp;of&nbsp;objects&nbsp;depending&nbsp;on&nbsp;your&nbsp;configuration.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;place&nbsp;where&nbsp;I&nbsp;would&nbsp;recommend&nbsp;&lt;i&gt;against&lt;/i&gt;&nbsp;using&nbsp;the&nbsp;string-based&nbsp;APIs&nbsp;is&nbsp;in&nbsp;systems&nbsp;which&nbsp;require&nbsp;knowledge&nbsp;of&nbsp;their&nbsp;transports.&nbsp;&nbsp;For&nbsp;example,&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;report&nbsp;about&nbsp;the&nbsp;apparent&nbsp;address&nbsp;of&nbsp;your&nbsp;peer&nbsp;in&nbsp;a&nbsp;protocol&nbsp;message&nbsp;with&nbsp;a&nbsp;specific&nbsp;format,&nbsp;you&nbsp;can't&nbsp;correctly&nbsp;do&nbsp;that&nbsp;with&nbsp;an&nbsp;arbitrary&nbsp;endpoint,&nbsp;because&nbsp;you&nbsp;won't&nbsp;know&nbsp;what&nbsp;datatype&nbsp;to&nbsp;expect&nbsp;from&nbsp;the&nbsp;getPeer()&nbsp;and&nbsp;getHost()&nbsp;methods&nbsp;on&nbsp;your&nbsp;transport.&nbsp;&nbsp;You&nbsp;can't&nbsp;accept&nbsp;any&nbsp;endpoint&nbsp;that&nbsp;serverFromString&nbsp;might&nbsp;give&nbsp;you&nbsp;and&nbsp;then&nbsp;assume&nbsp;it&nbsp;will&nbsp;give&nbsp;you&nbsp;an&nbsp;IPv4Address&nbsp;as&nbsp;a&nbsp;peer.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;you&nbsp;should&nbsp;be&nbsp;as&nbsp;flexible&nbsp;as&nbsp;you&nbsp;can,&nbsp;but&nbsp;no&nbsp;more.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;Put&nbsp;another&nbsp;way,&nbsp;I&nbsp;suggest&nbsp;writing&nbsp;this:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;debug_mode():&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gps_port&nbsp;=&nbsp;TCP4ServerEndpoint(reactor,&nbsp;1049)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;else:&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gps_port&nbsp;=&nbsp;SerialEndpoint(reactor,&nbsp;&quot;/dev/ttyS2&quot;,&nbsp;baudrate=4800)&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;...&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;gps_service&nbsp;=&nbsp;StreamServerEndpointService(gps_port,&nbsp;gps_factory)&lt;br&gt;&lt;br&gt;And&nbsp;save&nbsp;the&nbsp;&quot;tcp:1049&quot;-style&nbsp;strings&nbsp;for&nbsp;your&nbsp;.ini&nbsp;files&nbsp;where&nbsp;you&nbsp;&lt;br&gt;cannot&nbsp;write&nbsp;it&nbsp;that&nbsp;way.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;This&nbsp;then&nbsp;begs&nbsp;the&nbsp;question:&nbsp;where&nbsp;does&nbsp;&quot;debug_mode()&quot;'s&nbsp;result&nbsp;come&nbsp;from?&nbsp;&nbsp;Presumably&nbsp;someone&nbsp;had&nbsp;to&nbsp;indicate&nbsp;a&nbsp;boolean&nbsp;to&nbsp;this&nbsp;code&nbsp;somehow.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;simpler&nbsp;for&nbsp;whoever&nbsp;was&nbsp;supplying&nbsp;the&nbsp;value&nbsp;for&nbsp;debug_mode&nbsp;to&nbsp;just&nbsp;supply&nbsp;a&nbsp;value&nbsp;for&nbsp;the&nbsp;endpoint&nbsp;string&nbsp;description&nbsp;instead.&nbsp;&nbsp;And&nbsp;if&nbsp;it's&nbsp;OK&nbsp;to&nbsp;hard-code&nbsp;the&nbsp;debug_mode&nbsp;boolean,&nbsp;why&nbsp;not&nbsp;just&nbsp;hard-code&nbsp;the&nbsp;string?&nbsp;&nbsp;Since&nbsp;gps_factory&nbsp;already&nbsp;needs&nbsp;to&nbsp;accept&nbsp;being&nbsp;connected&nbsp;to&nbsp;different&nbsp;transport&nbsp;types,&nbsp;this&nbsp;is&nbsp;8&nbsp;lines&nbsp;of&nbsp;code&nbsp;(including&nbsp;the&nbsp;imports,&nbsp;not&nbsp;shown&nbsp;above)&nbsp;where&nbsp;3&nbsp;will&nbsp;do&nbsp;fine.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can&nbsp;this&nbsp;code&nbsp;really&nbsp;only&nbsp;run&nbsp;over&nbsp;plain&nbsp;TCP&nbsp;and&nbsp;serial&nbsp;ports?&nbsp;&nbsp;If&nbsp;not,&nbsp;then&nbsp;you&nbsp;might&nbsp;have&nbsp;to&nbsp;add&nbsp;an&nbsp;'if&nbsp;secure()'&nbsp;to&nbsp;the&nbsp;TCP&nbsp;case.&nbsp;&nbsp;And&nbsp;then&nbsp;you&nbsp;suddenly&nbsp;need&nbsp;a&nbsp;way&nbsp;to&nbsp;get&nbsp;a&nbsp;certificate&nbsp;in&nbsp;there,&nbsp;and&nbsp;all&nbsp;kinds&nbsp;of&nbsp;other&nbsp;information&nbsp;related&nbsp;to&nbsp;TLS.&nbsp;&nbsp;Better&nbsp;to&nbsp;let&nbsp;the&nbsp;existing&nbsp;string-parsing&nbsp;configuration&nbsp;system&nbsp;do&nbsp;that&nbsp;for&nbsp;you.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-glyph&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;[1]:&nbsp;There&nbsp;is&nbsp;no&nbsp;cabal.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
