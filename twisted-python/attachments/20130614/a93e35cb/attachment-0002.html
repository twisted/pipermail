<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Jun&nbsp;14,&nbsp;2013,&nbsp;at&nbsp;3:43&nbsp;PM,&nbsp;Glyph&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:glyph@twistedmatrix.com&quot;&gt;glyph@twistedmatrix.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;Menlo-Regular;&nbsp;font-size:&nbsp;12px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;I&nbsp;think&nbsp;that&nbsp;we&nbsp;can&nbsp;satisfy&nbsp;all&nbsp;of&nbsp;these&nbsp;requirements&nbsp;by&nbsp;expanding&nbsp;the&nbsp;notion&nbsp;of&nbsp;an&nbsp;&quot;identifier&quot;&nbsp;a&nbsp;bit.&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;In&nbsp;our&nbsp;last&nbsp;episode,&nbsp;I&nbsp;mentioned&nbsp;that&nbsp;an&nbsp;identifier&nbsp;should&nbsp;have&nbsp;several&nbsp;properties:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&nbsp;class=&quot;MailOutline&quot;&gt;&lt;li&gt;human&nbsp;readable&nbsp;(and&nbsp;potentially&nbsp;non-unique)&nbsp;for&nbsp;ease&nbsp;of&nbsp;writing&nbsp;messages&nbsp;and&nbsp;reading&nbsp;them&nbsp;to&nbsp;get&nbsp;a&nbsp;general&nbsp;sense&nbsp;of&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;system&lt;/li&gt;&lt;li&gt;globally&nbsp;unique&nbsp;(and&nbsp;potentially&nbsp;hard&nbsp;to&nbsp;read)&nbsp;for&nbsp;ease&nbsp;of&nbsp;filtering&nbsp;and&nbsp;monitoring&lt;/li&gt;&lt;li&gt;long-term&nbsp;(and&nbsp;potentially&nbsp;unique&nbsp;to&nbsp;humans)&nbsp;for&nbsp;ease&nbsp;of&nbsp;writing&nbsp;tools&nbsp;to&nbsp;deal&nbsp;with&nbsp;particular&nbsp;messages,&nbsp;whose&nbsp;exact&nbsp;details&nbsp;may&nbsp;change&nbsp;over&nbsp;time&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;we&nbsp;can&nbsp;achieve&nbsp;all&nbsp;of&nbsp;these&nbsp;things&nbsp;by&nbsp;making&nbsp;there&nbsp;be&nbsp;&lt;i&gt;multiple&lt;/i&gt;&nbsp;ways&nbsp;to&nbsp;identify&nbsp;a&nbsp;log&nbsp;message.&nbsp;&nbsp;Here's&nbsp;how&nbsp;that&nbsp;could&nbsp;work:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;you&nbsp;are&nbsp;first&nbsp;writing&nbsp;a&nbsp;log&nbsp;message,&nbsp;just&nbsp;do&nbsp;this,&nbsp;as&nbsp;you&nbsp;usually&nbsp;would;&nbsp;toss&nbsp;off&nbsp;some&nbsp;crummy&nbsp;english&nbsp;message:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;log.info(&quot;hey&nbsp;check&nbsp;it&nbsp;out&nbsp;I&nbsp;just&nbsp;{verb}ed&nbsp;a&nbsp;{noun}&quot;,&nbsp;verb=request.method,&nbsp;noun=request.uri)&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Asking&nbsp;the&nbsp;author&nbsp;to&nbsp;write&nbsp;a&nbsp;log&nbsp;message&nbsp;with&nbsp;more&nbsp;detail&nbsp;and&nbsp;care&nbsp;than&nbsp;this&nbsp;is&nbsp;basically&nbsp;just&nbsp;a&nbsp;recipe&nbsp;for&nbsp;disappointment&nbsp;:).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Later,&nbsp;someone&nbsp;might&nbsp;want&nbsp;to&nbsp;instrument&nbsp;these&nbsp;messages.&nbsp;&nbsp;We've&nbsp;all&nbsp;agreed&nbsp;that&nbsp;re.findall(&quot;hey&nbsp;check&nbsp;it&nbsp;out.*&quot;)&nbsp;is&nbsp;a&nbsp;crummy&nbsp;way&nbsp;to&nbsp;do&nbsp;this.&nbsp;&nbsp;The&nbsp;obvious&nbsp;thing&nbsp;would&nbsp;be&nbsp;something&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;tapEventsLike(myObserver,&nbsp;publisher,&nbsp;log_format=&quot;hey&nbsp;check&nbsp;it&nbsp;out&nbsp;I&nbsp;just&nbsp;{verb}ed&nbsp;a&nbsp;{noun}&quot;)&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;That's&nbsp;fine&nbsp;to&nbsp;start&nbsp;with,&nbsp;of&nbsp;course,&nbsp;but&nbsp;it's&nbsp;not&nbsp;very&nbsp;resilient&nbsp;to&nbsp;changes&nbsp;in&nbsp;the&nbsp;code;&nbsp;the&nbsp;developer&nbsp;might&nbsp;later&nbsp;change&nbsp;this&nbsp;line&nbsp;to&nbsp;read:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;log.info(&quot;hey&nbsp;check&nbsp;it&nbsp;out&nbsp;I&nbsp;just&nbsp;{verb}ed&nbsp;a&nbsp;{noun}&nbsp;and&nbsp;got&nbsp;a&nbsp;{result}&quot;,&nbsp;verb=request.method,&nbsp;noun=request.uri,&nbsp;result=request.response.status)&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Now&nbsp;the&nbsp;log&nbsp;tap&nbsp;is&nbsp;broken,&nbsp;and&nbsp;there's&nbsp;no&nbsp;reasonable&nbsp;way&nbsp;to&nbsp;fix&nbsp;it;&nbsp;the&nbsp;format&nbsp;string&nbsp;doesn't&nbsp;have&nbsp;a&nbsp;place&nbsp;that&nbsp;it&nbsp;could&nbsp;go.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But,&nbsp;the&nbsp;'log'&nbsp;in&nbsp;the&nbsp;above&nbsp;example&nbsp;is&nbsp;a&nbsp;logger&nbsp;object&nbsp;associated&nbsp;with&nbsp;a&nbsp;class&nbsp;or&nbsp;module,&nbsp;and&nbsp;so&nbsp;has&nbsp;3&nbsp;persistent&nbsp;pieces&nbsp;of&nbsp;information&nbsp;it&nbsp;can&nbsp;use&nbsp;to&nbsp;build&nbsp;a&nbsp;long-term&nbsp;identifier&nbsp;that&nbsp;the&nbsp;event&nbsp;tap&nbsp;can&nbsp;use.&nbsp;&nbsp;We&nbsp;could&nbsp;reflect&nbsp;that&nbsp;in&nbsp;an&nbsp;API&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;from&nbsp;example.module&nbsp;import&nbsp;log&lt;/div&gt;&lt;div&gt;tapEventsLike(myObserver,&nbsp;publisher,&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_id=log.idForOriginalFormat(&quot;hey&nbsp;check&nbsp;it&nbsp;out&nbsp;I&nbsp;just&nbsp;{verb}ed&nbsp;a&nbsp;{noun}&quot;))&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;which&nbsp;could&nbsp;be&nbsp;computed&nbsp;offline,&nbsp;and&nbsp;then&nbsp;specified&nbsp;like&nbsp;this,&nbsp;to&nbsp;be&nbsp;even&nbsp;more&nbsp;resilient&nbsp;to&nbsp;API&nbsp;changes:&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;&lt;div&gt;tapEventsLike(myObserver,&nbsp;publisher,&nbsp;log_id='604e45b5-2d41-5ba5-9ae1-7205163c3e3f')&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;string,&nbsp;of&nbsp;course,&nbsp;is&nbsp;computed&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;import&nbsp;uuid&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;from&nbsp;urllib&nbsp;import&nbsp;urlencode&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;uri&nbsp;=&nbsp;&quot;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/ns/log/?&quot;&gt;http://twistedmatrix.com/ns/log/?&lt;/a&gt;&quot;&nbsp;+&nbsp;urlencode(dict(format=&quot;hey&nbsp;check&nbsp;it&nbsp;out&nbsp;I&nbsp;just&nbsp;{verb}ed&nbsp;a&nbsp;{noun}&quot;,&nbsp;module=&quot;example.module&quot;))&lt;/div&gt;&lt;div&gt;&gt;&gt;&gt;&nbsp;uuid.uuid5(uuid.NAMESPACE_URL,&nbsp;uri)&lt;/div&gt;&lt;div&gt;UUID('604e45b5-2d41-5ba5-9ae1-7205163c3e3f')&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;(Although&nbsp;if&nbsp;we&nbsp;decide&nbsp;we&nbsp;like&nbsp;this&nbsp;system,&nbsp;we&nbsp;could&nbsp;of&nbsp;course&nbsp;go&nbsp;with&nbsp;a&nbsp;helpful&nbsp;command-line&nbsp;tool&nbsp;to&nbsp;generate&nbsp;these&nbsp;for&nbsp;you.)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;you&nbsp;evolve&nbsp;your&nbsp;codebase&nbsp;to&nbsp;take&nbsp;logging&nbsp;more&nbsp;seriously,&nbsp;you&nbsp;could&nbsp;change&nbsp;the&nbsp;original&nbsp;'log.info'&nbsp;call&nbsp;to&nbsp;instead&nbsp;look&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;verbANoun&nbsp;=&nbsp;log.declare(&lt;/blockquote&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&quot;hey&nbsp;check&nbsp;it&nbsp;out&nbsp;I&nbsp;just&nbsp;{verb}ed&nbsp;a&nbsp;{noun}&nbsp;and&nbsp;got&nbsp;a&nbsp;{result}&quot;,&lt;/blockquote&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;log_id='604e45b5-2d41-5ba5-9ae1-7205163c3e3f',&lt;/blockquote&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;)&lt;/blockquote&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;#&nbsp;...&lt;/blockquote&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;verbANoun(verb=request.method,&nbsp;noun=request.uri,&nbsp;result=request.response.status)&lt;/blockquote&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&nbsp;then&nbsp;monitoring&nbsp;can&nbsp;be&nbsp;accomplished&nbsp;via&nbsp;public&nbsp;API:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;&lt;div&gt;from&nbsp;example.module&nbsp;import&nbsp;verbANoun&lt;/div&gt;&lt;/div&gt;&lt;div&gt;verbANoun.tap(myObserver,&nbsp;theLogPublisher)&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;after&nbsp;some&nbsp;evolution,&nbsp;our&nbsp;message&nbsp;has&nbsp;3&nbsp;identifiers:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&nbsp;class=&quot;MailOutline&quot;&gt;&lt;li&gt;the&nbsp;original&nbsp;format&nbsp;string,&nbsp;which&nbsp;was&nbsp;easy&nbsp;to&nbsp;come&nbsp;up&nbsp;with&nbsp;on&nbsp;the&nbsp;spot,&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;unique&lt;/li&gt;&lt;li&gt;a&nbsp;UUID,&nbsp;that&nbsp;was&nbsp;automatically&nbsp;generated&nbsp;but&nbsp;can&nbsp;be&nbsp;carried&nbsp;around&nbsp;to&nbsp;allow&nbsp;for&nbsp;cleaning&nbsp;up&nbsp;the&nbsp;codebase&nbsp;and&nbsp;the&nbsp;message&nbsp;without&nbsp;breaking&nbsp;any&nbsp;code&nbsp;doing&nbsp;monitoring&lt;/li&gt;&lt;li&gt;an&nbsp;API&nbsp;name&nbsp;that&nbsp;the&nbsp;logger&nbsp;and&nbsp;the&nbsp;logee&nbsp;can&nbsp;use&nbsp;to&nbsp;agree&nbsp;on&nbsp;the&nbsp;semantics&nbsp;of&nbsp;a&nbsp;particular&nbsp;message&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Best&nbsp;of&nbsp;all,&nbsp;you&nbsp;can&nbsp;get&nbsp;this&nbsp;&lt;i&gt;even&nbsp;for&nbsp;the&nbsp;plethora&nbsp;of&nbsp;existing&nbsp;log&nbsp;messages&nbsp;within&nbsp;Twisted&nbsp;that&nbsp;aren't&nbsp;even&nbsp;using&nbsp;structured&nbsp;values&lt;/i&gt;,&nbsp;as&nbsp;we&nbsp;evolve&nbsp;them&nbsp;to&nbsp;have&nbsp;more&nbsp;metadata.&nbsp;&nbsp;You&nbsp;also&nbsp;now&nbsp;have&nbsp;the&nbsp;ability&nbsp;to&nbsp;localize&nbsp;the&nbsp;format&nbsp;string,&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;start&nbsp;presenting&nbsp;these&nbsp;log&nbsp;messages&nbsp;in&nbsp;contexts&nbsp;other&nbsp;than&nbsp;log&nbsp;files&nbsp;for&nbsp;system&nbsp;administrators.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thoughts?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-glyph&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
