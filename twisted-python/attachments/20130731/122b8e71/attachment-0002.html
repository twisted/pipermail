<tt>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;<br>
On&nbsp;Jul&nbsp;31,&nbsp;2013&nbsp;4:19&nbsp;AM,&nbsp;&quot;zipxing&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:zipxing@hotmail.com&quot;&gt;zipxing@hotmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Great!&nbsp;pypy&nbsp;take&nbsp;20%&nbsp;cpu,&nbsp;3x&nbsp;fast&nbsp;than&nbsp;cpython!&lt;br&gt;<br>
&gt;&nbsp;Thanks!&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;A&nbsp;little&nbsp;problem:&nbsp;cjson&nbsp;and&nbsp;ujson&nbsp;can&#39;t&nbsp;install&nbsp;to&nbsp;pypy...&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;What&#39;s&nbsp;wrong&nbsp;with&nbsp;the&nbsp;builtin&nbsp;json&nbsp;module?&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;&gt;&nbsp;ZipXing&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;________________________________&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;From:&nbsp;_@&lt;a&nbsp;href=&quot;http://lvh.io&quot;&gt;lvh.io&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Date:&nbsp;Tue,&nbsp;30&nbsp;Jul&nbsp;2013&nbsp;13:09:33&nbsp;+0200&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;To:&nbsp;&lt;a&nbsp;href=&quot;mailto:twisted-python@twistedmatrix.com&quot;&gt;twisted-python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[Twisted-Python]&nbsp;transport.write&nbsp;performance.&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Hi&nbsp;zipxing,&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;You&nbsp;don&#39;t&nbsp;mention&nbsp;the&nbsp;interpreter.&nbsp;Is&nbsp;it&nbsp;CPython?&nbsp;What&nbsp;kind&nbsp;of&nbsp;results&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;do&nbsp;you&nbsp;get&nbsp;trying&nbsp;it&nbsp;on&nbsp;PyPy?&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Also,&nbsp;you&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;specify&nbsp;epollreactor.&nbsp;Recent&nbsp;versions&nbsp;of&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;twisted&nbsp;will&nbsp;automagically&nbsp;choose&nbsp;the&nbsp;appropriate&nbsp;backend.&nbsp;I&nbsp;fixed&nbsp;this&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;and&nbsp;some&nbsp;other&nbsp;cleanups&nbsp;and&nbsp;got:&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;----&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;from&nbsp;time&nbsp;import&nbsp;clock&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;protocol,&nbsp;reactor&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;from&nbsp;twisted.protocols&nbsp;import&nbsp;basic&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;class&nbsp;MeasuringEchoProtocol(basic.LineReceiver):&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;MEASUREMENT_INTERVAL&nbsp;=&nbsp;1000&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;def&nbsp;lineReceived(self,&nbsp;data):&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;self.factory.requests&nbsp;+=&nbsp;1&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;if&nbsp;self.factory.requests&nbsp;%&nbsp;self.MEASUREMENT_INTERVAL&nbsp;==&nbsp;0:&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;print&nbsp;&quot;RPS:&nbsp;{0}&quot;.format(self.factory.requests&nbsp;/&nbsp;clock())&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;self.transport.write(data)&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;class&nbsp;ServerFactory(protocol.ServerFactory):&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;protocol&nbsp;=&nbsp;MeasuringEchoProtocol&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;def&nbsp;__init__(self):&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;self.requests&nbsp;=&nbsp;0&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;def&nbsp;main():&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;reactor.listenTCP(9976,&nbsp;ServerFactory())&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;clock()&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;reactor.run()&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;main()&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;----&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;Keep&nbsp;in&nbsp;mind&nbsp;that&nbsp;due&nbsp;to&nbsp;setup&nbsp;time&nbsp;few&nbsp;requests&nbsp;get&nbsp;handled&nbsp;right&nbsp;when&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;it&nbsp;starts,&nbsp;so&nbsp;the&nbsp;server&nbsp;RPS&nbsp;will&nbsp;take&nbsp;some&nbsp;time&nbsp;to&nbsp;balance&nbsp;out.&nbsp;On&nbsp;my&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;wimpy&nbsp;laptop&nbsp;on&nbsp;battery&nbsp;power,&nbsp;that&nbsp;was&nbsp;around&nbsp;420.274404782.&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;cheers&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;lvh&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;_______________________________________________&nbsp;Twisted-Python&nbsp;mailing&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;list&nbsp;&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/p&gt;<br>

</tt>
