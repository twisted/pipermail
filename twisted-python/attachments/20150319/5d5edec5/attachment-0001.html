<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Mar&nbsp;19,&nbsp;2015,&nbsp;at&nbsp;8:36&nbsp;AM,&nbsp;Louis&nbsp;D.&nbsp;Burr&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ldanielburr@me.com&quot;&nbsp;class=&quot;&quot;&gt;ldanielburr@me.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;Hi&nbsp;Timothy,&lt;div&nbsp;class=&quot;&quot;&gt;<br>
&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Mar&nbsp;19,&nbsp;2015,&nbsp;at&nbsp;9:56&nbsp;AM,&nbsp;Timothy&nbsp;Gallagher&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:timothy.gallagher@nuspire.com&quot;&nbsp;class=&quot;&quot;&gt;timothy.gallagher@nuspire.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;WordSection1&quot;&nbsp;style=&quot;page:&nbsp;WordSection1;&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:&nbsp;11pt;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&quot;&nbsp;class=&quot;&quot;&gt;Hello&nbsp;all,&lt;o:p&nbsp;class=&quot;&quot;&gt;&lt;/o:p&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:&nbsp;11pt;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&quot;&nbsp;class=&quot;&quot;&gt;I&nbsp;have&nbsp;a&nbsp;project&nbsp;that&nbsp;requires&nbsp;client&nbsp;server&nbsp;with&nbsp;ssl/tls&nbsp;including&nbsp;client&nbsp;certificate&nbsp;authentication.&nbsp;&nbsp;Also&nbsp;the&nbsp;a&nbsp;requirement&nbsp;is&nbsp;that&nbsp;the&nbsp;client&nbsp;needs&nbsp;to&nbsp;use&nbsp;a&nbsp;.p12&nbsp;file&nbsp;to&nbsp;house&nbsp;its&nbsp;keys.&nbsp;&nbsp;I&nbsp;have&nbsp;the&nbsp;server&nbsp;part&nbsp;and&nbsp;client&nbsp;part&nbsp;down&nbsp;except&nbsp;I&nbsp;cannot&nbsp;find&nbsp;any&nbsp;code&nbsp;examples&nbsp;using&nbsp;a&nbsp;.p12&nbsp;file&nbsp;to&nbsp;get&nbsp;the&nbsp;certificates.&nbsp;&nbsp;Can&nbsp;this&nbsp;be&nbsp;done&nbsp;without&nbsp;having&nbsp;to&nbsp;hack&nbsp;into&nbsp;the&nbsp;ssl.ClientConextFactory?&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Maybe&nbsp;&lt;a&nbsp;href=&quot;http://stackoverflow.com/questions/6345786/python-reading-a-pkcs12-certificate-with-pyopenssl-crypto&quot;&nbsp;class=&quot;&quot;&gt;http://stackoverflow.com/questions/6345786/python-reading-a-pkcs12-certificate-with-pyopenssl-crypto&lt;/a&gt;&nbsp;will&nbsp;be&nbsp;useful&nbsp;to&nbsp;you.&nbsp;&nbsp;Twisted&nbsp;uses&nbsp;pyopenssl&nbsp;under&nbsp;the&nbsp;covers,&nbsp;so&nbsp;the&nbsp;solution&nbsp;exarkun&nbsp;posted&nbsp;to&nbsp;StackOverflow&nbsp;should&nbsp;be&nbsp;applicable.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Hope&nbsp;this&nbsp;helps,&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;-&nbsp;L.&nbsp;Daniel&nbsp;Burr&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;You&nbsp;definitely&nbsp;shouldn't&nbsp;use&nbsp;ssl.ClientContextFactory.&nbsp;&nbsp;It&nbsp;doesn't&nbsp;verify&nbsp;certificates,&nbsp;or&nbsp;provide&nbsp;any&nbsp;authentication&nbsp;of&nbsp;the&nbsp;server.&nbsp;&nbsp;We&nbsp;should&nbsp;really&nbsp;remove&nbsp;and&nbsp;deprecate&nbsp;it&nbsp;:-\.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;You&nbsp;should&nbsp;use&nbsp;ssl.optionsForClientTLS,&nbsp;and&nbsp;you&nbsp;should&nbsp;build&nbsp;it&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;import&nbsp;getpass&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;from&nbsp;OpenSSL.crypto&nbsp;import&nbsp;load_pkcs12&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;from&nbsp;twisted.internet.ssl&nbsp;import&nbsp;(&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;PrivateCertificate,&nbsp;KeyPair,&nbsp;Certificate,&nbsp;optionsForClientTLS&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;Factory,&nbsp;Protocol&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;from&nbsp;twisted.internet.endpoints&nbsp;import&nbsp;SSL4ClientEndpoint&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;from&nbsp;twisted.internet.defer&nbsp;import&nbsp;inlineCallbacks,&nbsp;Deferred&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;from&nbsp;twisted.internet.task&nbsp;import&nbsp;react&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;@inlineCallbacks&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;def&nbsp;main(reactor,&nbsp;p12file,&nbsp;host,&nbsp;port=443):&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;host&nbsp;=&nbsp;host.decode(&quot;utf-8&quot;)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;port&nbsp;=&nbsp;int(port)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(p12file)&nbsp;as&nbsp;f:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pkcs12&nbsp;=&nbsp;load_pkcs12(f.read(),&nbsp;getpass.getpass())&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;publicCertificate&nbsp;=&nbsp;Certificate(pkcs12.get_certificate())&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;privateKey&nbsp;=&nbsp;KeyPair(pkcs12.get_privatekey())&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;privateCertificate&nbsp;=&nbsp;PrivateCertificate.fromCertificateAndKeyPair(&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;publicCertificate,&nbsp;privateKey&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;contextFactory&nbsp;=&nbsp;optionsForClientTLS(host,&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clientCertificate=privateCertificate)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;endpoint&nbsp;=&nbsp;SSL4ClientEndpoint(reactor,&nbsp;host,&nbsp;port,&nbsp;contextFactory)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;Deferred()&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;it(Protocol,&nbsp;object):&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionMade(self):&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.write(b&quot;GET&nbsp;/&nbsp;HTTP/1.1\r\n\r\n&quot;)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.callback(Certificate.peerFromTransport(self.transport))&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.abortConnection()&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;yield&nbsp;endpoint.connect(Factory.forProtocol(it))&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;cert&nbsp;=&nbsp;yield&nbsp;x&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;print(cert)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;from&nbsp;sys&nbsp;import&nbsp;argv&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;react(main,&nbsp;argv[1:])&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Hopefully&nbsp;that's&nbsp;a&nbsp;pretty&nbsp;complete&nbsp;answer&nbsp;:-).&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;-glyph&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
