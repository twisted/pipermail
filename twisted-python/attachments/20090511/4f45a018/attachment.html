<tt>
Hi&nbsp;people,&lt;br&gt;I&#39;m&nbsp;luigi&nbsp;and&nbsp;I&#39;m&nbsp;a&nbsp;student&nbsp;at&nbsp;Politecnico&nbsp;di&nbsp;Milano,&nbsp;Italy.&nbsp;I&#39;m&nbsp;working&nbsp;for&nbsp;a&nbsp;graduate&nbsp;thesis&nbsp;on&nbsp;a&nbsp;framework&nbsp;called&nbsp;usher.&nbsp;It&nbsp;provides&nbsp;an&nbsp;API&nbsp;to&nbsp;do&nbsp;connect&nbsp;e&nbsp;command&nbsp;operations.&nbsp;It&nbsp;manages&nbsp;all&nbsp;those&nbsp;calls&nbsp;with&nbsp;a&nbsp;defferred&nbsp;object&nbsp;(i&nbsp;think).&nbsp;In&nbsp;fact&nbsp;when&nbsp;I&nbsp;call&nbsp;the&nbsp;connect&nbsp;it&nbsp;returns&nbsp;me&nbsp;a&nbsp;defferred&nbsp;object.&nbsp;All&nbsp;that&nbsp;i&nbsp;want&nbsp;to&nbsp;know&nbsp;is&nbsp;how&nbsp;to&nbsp;call&nbsp;the&nbsp;other&nbsp;operations&nbsp;with&nbsp;this&nbsp;object&nbsp;and&nbsp;how&nbsp;to&nbsp;know&nbsp;when&nbsp;an&nbsp;operation&nbsp;is&nbsp;completely&nbsp;done.&lt;br&gt;<br>
The&nbsp;procedure&nbsp;I&nbsp;call&nbsp;is&nbsp;simple:&nbsp;connect&nbsp;method,&nbsp;start&nbsp;method&nbsp;many&nbsp;times,&nbsp;stop&nbsp;method,&nbsp;disconnect&nbsp;method.&nbsp;I&nbsp;want&nbsp;to&nbsp;call&nbsp;these&nbsp;methods&nbsp;sequentially&nbsp;because&nbsp;I&nbsp;have&nbsp;to&nbsp;fallow&nbsp;a&nbsp;list&nbsp;of&nbsp;commands&nbsp;so&nbsp;I&nbsp;have&nbsp;to&nbsp;be&nbsp;sure&nbsp;the&nbsp;previous&nbsp;methods&nbsp;are&nbsp;already&nbsp;been&nbsp;invoked.&nbsp;I&#39;ll&nbsp;post&nbsp;the&nbsp;main&nbsp;methods&nbsp;hoping&nbsp;someone&nbsp;could&nbsp;help&nbsp;me&nbsp;in&nbsp;how&nbsp;to&nbsp;add&nbsp;the&nbsp;method&nbsp;in&nbsp;the&nbsp;deferred&nbsp;and&nbsp;how&nbsp;to&nbsp;know&nbsp;when&nbsp;it&nbsp;is&nbsp;completely&nbsp;invoked.&lt;br&gt;<br>
#&nbsp;Connect&lt;br&gt;def&nbsp;connect(self,&nbsp;ctrl_host,&nbsp;ctrl_port,&nbsp;user,&nbsp;passwd):&lt;br&gt;       &nbsp;&quot;&quot;&quot;Connect&nbsp;to&nbsp;an&nbsp;Usher&nbsp;control&nbsp;server.&lt;br&gt;&lt;br&gt;       &nbsp;@param&nbsp;ctrl_host:&nbsp;fqdn&nbsp;where&nbsp;Usher&nbsp;controller&nbsp;is&nbsp;running&lt;br&gt;       &nbsp;@type&nbsp;ctrl_host:&nbsp;string&lt;br&gt;<br>
       &nbsp;@param&nbsp;ctrl_port:&nbsp;port&nbsp;number&nbsp;Usher&nbsp;controller&nbsp;is&nbsp;listening&nbsp;on&lt;br&gt;       &nbsp;@type&nbsp;ctrl_port:&nbsp;int&lt;br&gt;       &nbsp;@param&nbsp;user:&nbsp;username&nbsp;of&nbsp;user&nbsp;connecting&nbsp;to&nbsp;Usher&nbsp;controller&lt;br&gt;       &nbsp;@type&nbsp;user:&nbsp;string&lt;br&gt;       &nbsp;@param&nbsp;passwd:&nbsp;password&nbsp;of&nbsp;user&nbsp;connecting&nbsp;to&nbsp;Usher&nbsp;controller&lt;br&gt;<br>
       &nbsp;@type&nbsp;passwd:&nbsp;string&lt;br&gt;&lt;br&gt;       &nbsp;return:&nbsp;Deferred&nbsp;which&nbsp;returns&nbsp;and&nbsp;L{UsherResult}&lt;br&gt;       &nbsp;rtype:&nbsp;twisted.internet.defer.Deferred&lt;br&gt;       &nbsp;&quot;&quot;&quot;&lt;br&gt;       &nbsp;#&nbsp;serialize&nbsp;access&nbsp;to&nbsp;connect&lt;br&gt;       &nbsp;if&nbsp;not&nbsp;self.connect_lock.acquire(False):&lt;br&gt;<br>
           &nbsp;raise&nbsp;UsherEx,&nbsp;&quot;Connection&nbsp;Pending&quot;&lt;br&gt;&lt;br&gt;       &nbsp;if&nbsp;self.factory:&lt;br&gt;           &nbsp;self.disconnect()&lt;br&gt;&lt;br&gt;       &nbsp;#&nbsp;reset&nbsp;vms&lt;br&gt;       &nbsp;self.vms&nbsp;=&nbsp;{}&lt;br&gt;       &nbsp;#&nbsp;reset&nbsp;passwd&nbsp;to&nbsp;None&nbsp;until&nbsp;we&#39;re&nbsp;connected&lt;br&gt;<br>
       &nbsp;self.passwd&nbsp;=&nbsp;None&lt;br&gt;       &nbsp;self.factory&nbsp;=&nbsp;APIFactory()&lt;br&gt;       &nbsp;self.factory.api&nbsp;=&nbsp;self&lt;br&gt;       &nbsp;#&nbsp;connect&nbsp;to&nbsp;server&lt;br&gt;       &nbsp;reactor.connectSSL(ctrl_host,&nbsp;ctrl_port,&nbsp;self.factory,&lt;br&gt;           &nbsp;ssl.ClientContextFactory())&lt;br&gt;<br>
       &nbsp;d&nbsp;=&nbsp;self.factory.login(credentials.UsernamePassword(user,&nbsp;passwd),&lt;br&gt;           &nbsp;client=self)&lt;br&gt;       &nbsp;d.addErrback(self._handle_err,&nbsp;misc.whoami())&lt;br&gt;       &nbsp;d.addCallback(self._connected_to_ctrl,&nbsp;ctrl_host,&nbsp;ctrl_port,&nbsp;user,&lt;br&gt;<br>
           &nbsp;passwd)&lt;br&gt;       &nbsp;return&nbsp;d&lt;br&gt;&lt;br&gt;#&nbsp;start&lt;br&gt;def&nbsp;start(self,&lt;br&gt;             &nbsp;cluster=None,&lt;br&gt;             &nbsp;prefix=&#39;&#39;,&lt;br&gt;             &nbsp;vmlist=None,&lt;br&gt;             &nbsp;count=None,&lt;br&gt;             &nbsp;first=None,&lt;br&gt;<br>
             &nbsp;last=None,&lt;br&gt;             &nbsp;dregex=None,&lt;br&gt;             &nbsp;dlist=None,&lt;br&gt;             &nbsp;dryrun=False,&lt;br&gt;             &nbsp;eid=None,&lt;br&gt;             &nbsp;**kw):&lt;br&gt;       &nbsp;&quot;&quot;&quot;Start&nbsp;a&nbsp;VM&nbsp;or&nbsp;set&nbsp;of&nbsp;VMs&lt;br&gt;<br>
&lt;br&gt;       &nbsp;@param&nbsp;cluster:&nbsp;Name&nbsp;of&nbsp;cluster&nbsp;to&nbsp;which&nbsp;VMs&nbsp;should&nbsp;belong&lt;br&gt;       &nbsp;@type&nbsp;cluster:&nbsp;string&lt;br&gt;       &nbsp;@param&nbsp;prefix:&nbsp;prefix&nbsp;to&nbsp;prepend&nbsp;to&nbsp;VM&nbsp;names&lt;br&gt;       &nbsp;@type&nbsp;prefix:&nbsp;string&lt;br&gt;       &nbsp;@param&nbsp;vmlist:&nbsp;list&nbsp;of&nbsp;strings&nbsp;of&nbsp;VMs&nbsp;to&nbsp;start&lt;br&gt;<br>
       &nbsp;@type&nbsp;vmlist:&nbsp;list&nbsp;of&nbsp;strings&lt;br&gt;       &nbsp;@param&nbsp;count:&nbsp;Number&nbsp;of&nbsp;consecutive&nbsp;VMs&nbsp;to&nbsp;start&lt;br&gt;       &nbsp;@type&nbsp;count:&nbsp;int&lt;br&gt;       &nbsp;@param&nbsp;first:&nbsp;Lowest&nbsp;number&nbsp;of&nbsp;VM&nbsp;to&nbsp;start&nbsp;&lt;br&gt;       &nbsp;@type&nbsp;first:&nbsp;int&lt;br&gt;       &nbsp;@param&nbsp;last:&nbsp;Highest&nbsp;number&nbsp;of&nbsp;VM&nbsp;to&nbsp;start&lt;br&gt;<br>
       &nbsp;@type&nbsp;last:&nbsp;int&lt;br&gt;       &nbsp;@param&nbsp;dregex:&nbsp;regular&nbsp;expression&nbsp;to&nbsp;match&nbsp;against&nbsp;destination&nbsp;LNM&lt;br&gt;           &nbsp;names&lt;br&gt;       &nbsp;@type&nbsp;dregex:&nbsp;list&nbsp;of&nbsp;strings&lt;br&gt;       &nbsp;@param&nbsp;dlist:&nbsp;list&nbsp;of&nbsp;strings&nbsp;to&nbsp;match&nbsp;against&nbsp;destination&nbsp;LNM&nbsp;names&lt;br&gt;<br>
       &nbsp;@type&nbsp;dlist:&nbsp;list&nbsp;of&nbsp;strings&lt;br&gt;       &nbsp;@param&nbsp;dryrun:&nbsp;Show&nbsp;what&nbsp;would&nbsp;have&nbsp;happened&nbsp;if&nbsp;the&nbsp;command&nbsp;had&nbsp;been&lt;br&gt;               &nbsp;run&nbsp;without&nbsp;the&nbsp;dryrun&nbsp;command&nbsp;(at&nbsp;the&nbsp;instant&nbsp;that&nbsp;the&nbsp;dryrun&lt;br&gt;               &nbsp;command&nbsp;was&nbsp;run&nbsp;of&nbsp;course)&lt;br&gt;<br>
       &nbsp;@type&nbsp;dryrun:&nbsp;bool&lt;br&gt;       &nbsp;@param&nbsp;eid:&nbsp;mechanism&nbsp;for&nbsp;admin&nbsp;user&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;specify&nbsp;an&nbsp;alternate&lt;br&gt;               &nbsp;username&nbsp;for&nbsp;forming&nbsp;suffix&nbsp;for&nbsp;regex&lt;br&gt;       &nbsp;@type&nbsp;eid:&nbsp;string&lt;br&gt;       &nbsp;@param&nbsp;kw:&nbsp;Extra&nbsp;arguments&nbsp;passed&nbsp;to&nbsp;controller&nbsp;for&nbsp;use&nbsp;by&nbsp;plugins&nbsp;or&lt;br&gt;<br>
           &nbsp;LNM. &nbsp;Any&nbsp;keywords&nbsp;starting&nbsp;with&nbsp;&#39;vm_&#39;&nbsp;are&nbsp;added&nbsp;to&nbsp;VM&#39;s&nbsp;uargs&lt;br&gt;           &nbsp;parameter. &nbsp;Note,&nbsp;the&nbsp;controller&nbsp;actually&nbsp;checks&nbsp;for&nbsp;two&nbsp;kw&lt;br&gt;           &nbsp;arguments:&nbsp;ram&nbsp;and&nbsp;ip_addrs. &nbsp;Though&nbsp;these&nbsp;are,&nbsp;strictly&nbsp;speaking,&lt;br&gt;<br>
           &nbsp;VM&nbsp;parameters,&nbsp;they&#39;re&nbsp;considered&nbsp;important&nbsp;enough&nbsp;that&nbsp;the&lt;br&gt;           &nbsp;controller&nbsp;checks&nbsp;for&nbsp;them.&lt;br&gt;       &nbsp;@type&nbsp;kw:&nbsp;dict&lt;br&gt;&lt;br&gt;       &nbsp;@return:&nbsp;Deferred&nbsp;which&nbsp;returns&nbsp;an&nbsp;L{UsherResult}&lt;br&gt;       &nbsp;@rtype:&nbsp;twisted.internet.defer.Deferred&lt;br&gt;<br>
&lt;br&gt;       &nbsp;@raise&nbsp;UsherNotConnected:&nbsp;Raised&nbsp;when&nbsp;not&nbsp;connected&nbsp;to&nbsp;Usher&lt;br&gt;           &nbsp;Controller&lt;br&gt;       &nbsp;@raise&nbsp;UsherPBDeadRefEx:&nbsp;Raised&nbsp;when&nbsp;capability&nbsp;for&nbsp;Usher&lt;br&gt;           &nbsp;Controller&nbsp;goes&nbsp;stale. &nbsp;Must&nbsp;reconnect&nbsp;when&nbsp;this&nbsp;happens&lt;br&gt;<br>
       &nbsp;@raise&nbsp;UsherInvalidInputEx:&nbsp;Raised&nbsp;when&nbsp;an&nbsp;invalid&nbsp;input&nbsp;or&lt;br&gt;           &nbsp;combination&nbsp;of&nbsp;parameters&nbsp;is&nbsp;received.&lt;br&gt;&lt;br&gt;       &nbsp;@attention:&nbsp;The&nbsp;following&nbsp;conditions&nbsp;must&nbsp;hold:&lt;br&gt;               &nbsp;1.&nbsp;first,&nbsp;last,&nbsp;and&nbsp;count&nbsp;must&nbsp;be&nbsp;non-negative&lt;br&gt;<br>
               &nbsp;2.&nbsp;specifying&nbsp;first&nbsp;requires&nbsp;last&nbsp;or&nbsp;count&lt;br&gt;               &nbsp;3.&nbsp;cannot&nbsp;use&nbsp;count&nbsp;with&nbsp;vmlist&lt;br&gt;               &nbsp;4.&nbsp;cannot&nbsp;use&nbsp;count&nbsp;with&nbsp;both&nbsp;first&nbsp;and&nbsp;last&lt;br&gt; &lt;br&gt;      &nbsp;&quot;&quot;&quot;&lt;br&gt;       &nbsp;#&nbsp;make&nbsp;sure&nbsp;we&#39;re&nbsp;connected&lt;br&gt;<br>
       &nbsp;if&nbsp;not&nbsp;self.aref:&lt;br&gt;           &nbsp;raise&nbsp;UsherNotConnectedEx&lt;br&gt;&lt;br&gt;       &nbsp;#&nbsp;combine&nbsp;these&nbsp;to&nbsp;reduce&nbsp;params&lt;br&gt;       &nbsp;if&nbsp;((first&nbsp;and&nbsp;first&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;(last&nbsp;and&nbsp;last&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;(count&nbsp;and&nbsp;count&nbsp;&lt;&lt;br&gt;           &nbsp;0)):&lt;br&gt;<br>
           &nbsp;raise&nbsp;UsherInvalidInputEx(&lt;br&gt;                   &nbsp;&quot;first,&nbsp;last,&nbsp;and&nbsp;count&nbsp;must&nbsp;be&nbsp;non-negative&quot;)&lt;br&gt;       &nbsp;vmrange&nbsp;=&nbsp;(first,last,count)&lt;br&gt;       &nbsp;#&nbsp;arg&nbsp;check&lt;br&gt;       &nbsp;self._arg_check(vmlist,&nbsp;vmrange)&lt;br&gt;<br>
&lt;br&gt;       &nbsp;#&nbsp;get&nbsp;final&nbsp;destination&nbsp;list&lt;br&gt;       &nbsp;dlist&nbsp;=&nbsp;self._namecomplete(dlist,&nbsp;suffix=self.suffix)&lt;br&gt;       &nbsp;self._check_lnmlist(dlist)&lt;br&gt;       &nbsp;dregex&nbsp;=&nbsp;self._regex_append(dregex,&nbsp;dlist)&lt;br&gt;       &nbsp;dlist&nbsp;=&nbsp;self._regex_filter(dregex,&nbsp;self.lnms.keys())&nbsp;&lt;br&gt;<br>
&lt;br&gt;       &nbsp;#&nbsp;complete&nbsp;names&nbsp;(if&nbsp;necessary)&nbsp;in&nbsp;the&nbsp;vmlist&lt;br&gt;       &nbsp;vmlist&nbsp;=&nbsp;self._namecomplete(vmlist,&nbsp;cluster,&nbsp;eid)&lt;br&gt;       &nbsp;#&nbsp;check&nbsp;that&nbsp;the&nbsp;vms&nbsp;specified&nbsp;don&#39;t&nbsp;already&nbsp;exist&lt;br&gt;       &nbsp;self._check_vmlist(vmlist,&nbsp;isin=True)&lt;br&gt;<br>
       &nbsp;vmlist&nbsp;=&nbsp;self._get_vm_names_to_start(vmlist,&nbsp;cluster,&nbsp;prefix,&nbsp;vmrange,&lt;br&gt;           &nbsp;eid)&lt;br&gt;&lt;br&gt;       &nbsp;#&nbsp;controller&nbsp;handles&nbsp;eid&nbsp;from&nbsp;kw,&nbsp;so&nbsp;add&nbsp;it&lt;br&gt;       &nbsp;if&nbsp;eid:&lt;br&gt;           &nbsp;kw[&#39;eid&#39;]&nbsp;=&nbsp;eid&lt;br&gt;&lt;br&gt;<br>
       &nbsp;if&nbsp;dryrun:&lt;br&gt;           &nbsp;d&nbsp;=&nbsp;UsherResult(&#39;dryrun&#39;,&nbsp;msg&nbsp;=&nbsp;&#39;started:&#39;&nbsp;+&nbsp;linesep&nbsp;+&lt;br&gt;                   &nbsp;linesep.join(vmlist))&lt;br&gt;           &nbsp;return&nbsp;d&lt;br&gt;&lt;br&gt;       &nbsp;try:&lt;br&gt;           &nbsp;if&nbsp;vmlist:&lt;br&gt;<br>
               &nbsp;d&nbsp;=&nbsp;self.aref.callRemote(&quot;start&quot;,&nbsp;vmlist,&nbsp;dlist,&lt;br&gt;                   &nbsp;**kw)&lt;br&gt;               &nbsp;d.addErrback(self._handle_err,&nbsp;misc.whoami())&lt;br&gt;           &nbsp;else:&lt;br&gt;               &nbsp;raise&nbsp;UsherInvalidInputEx(&nbsp;&lt;br&gt;<br>
                       &nbsp;&quot;No&nbsp;VMs&nbsp;started. &nbsp;No&nbsp;unique&nbsp;VMs&nbsp;specified&nbsp;in&nbsp;command&quot;)&lt;br&gt;           &nbsp;return&nbsp;d&lt;br&gt;       &nbsp;except&nbsp;pb.DeadReferenceError,&nbsp;ex:&lt;br&gt;           &nbsp;raise&nbsp;UsherPBDeadRefEx&lt;br&gt;&lt;br&gt;If&nbsp;you&nbsp;want,&nbsp;all&nbsp;the&nbsp;package&nbsp;is&nbsp;at&nbsp;&lt;a&nbsp;href=&quot;http://usher.ucsd.edu/downloads/snapshots/usher/latest/usher-latest.tgz&quot;&gt;http://usher.ucsd.edu/downloads/snapshots/usher/latest/usher-latest.tgz&lt;/a&gt;&lt;br&gt;<br>
in&nbsp;the&nbsp;client&nbsp;folder&nbsp;you&#39;ll&nbsp;find&nbsp;the&nbsp;api.py&lt;br&gt;&lt;br&gt;Thank&nbsp;you&nbsp;very&nbsp;much&nbsp;hoping&nbsp;someone&nbsp;will&nbsp;help&nbsp;this&nbsp;totally&nbsp;inexpert&nbsp;user,&lt;br&gt;Luigi.&lt;br&gt;<br>

</tt>
