<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Laurens,&lt;br&gt;&lt;br&gt;&gt;&nbsp;Cześć&lt;br&gt;&lt;br&gt;Cześć!&nbsp;:)&nbsp;&lt;br&gt;&lt;br&gt;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;answer.&nbsp;I&#39;m&nbsp;explicitly&nbsp;interested&nbsp;in&nbsp;the&nbsp;following&nbsp;combination:&lt;br&gt;&lt;br&gt;&gt;&nbsp;.addCallback(cb).addErrback(eb)&lt;br&gt;&lt;br&gt;If&nbsp;I&nbsp;understand&nbsp;correctly&nbsp;errback&nbsp;&quot;eb&quot;&nbsp;catches&nbsp;errors&nbsp;from&nbsp;both&nbsp;callback&nbsp;&quot;cb&quot;,&nbsp;and&nbsp;from&nbsp;agent.request&nbsp;(agent.request&nbsp;errors&nbsp;pass&nbsp;through&nbsp;default&nbsp;empty&nbsp;errback&nbsp;that&nbsp;re-raises&nbsp;them).&lt;br&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;&gt;&nbsp;Also,&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;do&nbsp;scraping&nbsp;with&nbsp;Twisted,&nbsp;consider&nbsp;looking&nbsp;at&nbsp;Scrapy,&nbsp;a&nbsp;fully-featured&nbsp;web&nbsp;scraper&nbsp;that&nbsp;uses&nbsp;Twisted&nbsp;internally.&lt;br&gt;<br>
&lt;/p&gt;&lt;p&gt;I&#39;m&nbsp;working&nbsp;on&nbsp;CoAP&nbsp;protocol&nbsp;which&nbsp;runs&nbsp;on&nbsp;top&nbsp;of&nbsp;UDP.&nbsp;My&nbsp;actual&nbsp;code&nbsp;is&nbsp;request&nbsp;processing&nbsp;(but&nbsp;the&nbsp;problem&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;in&nbsp;my&nbsp;previous&nbsp;post):&lt;/p&gt;&lt;p&gt;_________________________________________________&lt;br&gt;&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC716&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;processRequest&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;):&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;(...)&lt;br&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC729&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;defer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;succeed&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC730&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;addCallback&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;processBlock1&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC731&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;addCallback&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;dispatchRequest&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC782&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;dispatchRequest&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;):&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC783&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;(...)&lt;br&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC786&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;resource&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;endpoint&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;getResourceFor&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC787&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;if&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;resource&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;is&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;None&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC788&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;response&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;Message&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;code&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;NOT_FOUND&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;payload&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&#39;Resource&nbsp;not&nbsp;found!&#39;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC789&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;respond&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;response&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC790&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC791&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;try&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC792&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;resource&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;render&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC793&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;except&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;iot&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;error&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;UnallowedMethod&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC794&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;response&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;Message&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;code&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;METHOD_NOT_ALLOWED&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;payload&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&#39;Method&nbsp;not&nbsp;allowed!&#39;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC795&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;respond&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;response&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC796&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC797&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;except&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;iot&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;error&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;UnsupportedMethod&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC798&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;response&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;Message&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;code&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;NOT_IMPLEMENTED&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;payload&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&#39;Method&nbsp;not&nbsp;implemented!&#39;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC799&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;respond&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;response&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC800&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC801&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;delayed_ack&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;reactor&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;callLater&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;EMPTY_ACK_DELAY&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;sendEmptyAck&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC802&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;addCallback&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;respond&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;delayed_ack&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC803&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;return&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;p&nbsp;dir=&quot;ltr&quot;&gt;__________________________________________________&lt;br&gt;&lt;/p&gt;&lt;p&gt;I&nbsp;would&nbsp;like&nbsp;to&nbsp;rewrite&nbsp;it&nbsp;to:&lt;/p&gt;<br>
&lt;p&gt;__________________________________________________&lt;br&gt;&lt;/p&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC716&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;processRequest&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;):&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;(...)&lt;br&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC729&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;defer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;succeed&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC730&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;addCallback&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;processBlock1&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC731&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;addCallback&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;dispatchRequest&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;).addErrback(self.handleRequestError)&lt;br&gt;<br>
&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC782&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;dispatchRequest&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;):&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC783&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;(...)&lt;br&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC786&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;resource&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;endpoint&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;getResourceFor&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC787&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;if&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;resource&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;is&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;None&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC788&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;           &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;raise&nbsp;NoResource()&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC791&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;try&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC792&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;            &lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;resource&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;render&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC793&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;except&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;iot&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;error&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;UnallowedMethod&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:     &nbsp;#Explicit&nbsp;re-rise&nbsp;for&nbsp;this&nbsp;example&nbsp;only&lt;br&gt;<br>
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC794&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;           &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;raise&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;UnallowedMethod&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;()             &nbsp;&lt;br&gt;<br>
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC797&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;except&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;iot&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;error&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;UnsupportedMethod&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC798&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;           &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;raise&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;UnsupportedMethod&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;()&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC801&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC802&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;addCallback&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;respond&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC803&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;return&lt;/span&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;d&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;def&nbsp;handleRequestErrors(self,&nbsp;failure,&nbsp;request???)&lt;br&gt;<br>
&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC803&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;       &nbsp;#&nbsp;handle&nbsp;exceptions,&nbsp;send&nbsp;error&nbsp;response&nbsp;to&nbsp;client&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;p&nbsp;dir=&quot;ltr&quot;&gt;_______________________________________________&lt;/p&gt;<br>
&lt;p&gt;I&nbsp;would&nbsp;like&nbsp;to&nbsp;handle&nbsp;Exceptions&nbsp;in&nbsp;handleRequestErrors().&nbsp;However&nbsp;handleRequestErrors()&nbsp;has&nbsp;to&nbsp;send&nbsp;a&nbsp;response&nbsp;to&nbsp;the&nbsp;client,&nbsp;so&nbsp;it&nbsp;needs&nbsp;the&nbsp;request,&nbsp;and&nbsp;I&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;pass&nbsp;it&nbsp;from&nbsp;inside&nbsp;dispatchRequest().&lt;/p&gt;<br>
&lt;p&gt;I&nbsp;see&nbsp;two&nbsp;possibilities:&lt;br&gt;   &nbsp;1.&nbsp;Pass&nbsp;request&nbsp;inside&nbsp;Failure&nbsp;object&lt;br&gt;   &nbsp;2.&nbsp;Leave&nbsp;the&nbsp;original&nbsp;code&nbsp;(process&nbsp;errors&nbsp;inside&nbsp;callback)&lt;br&gt;&lt;br&gt;Which&nbsp;solution&nbsp;is&nbsp;more&nbsp;elegant?&lt;/p&gt;&lt;p&nbsp;dir=&quot;ltr&quot;&gt;&lt;/p&gt;&lt;p&gt;Best&nbsp;Regards&lt;/p&gt;&lt;p&gt;<br>
Maciek&lt;br&gt;<br>
&lt;/p&gt;<br>
&lt;/div&gt;<br>

</tt>
