import sys

from twisted.internet import reactor
from twisted.enterprise import adbapi

dbpool = adbapi.ConnectionPool('DCOracle2', LOGIN)

def interaction(trans, num, div):
    trans.execute('select %d/%d from dual' % (num, div))
    return trans.fetchall()[0][0]

def stop(_): reactor.stop()

def use_pool():
    d = dbpool.runInteraction(interaction, num=10, div=2)
    d.addCallback(lambda res: sys.stdout.write(str(res)+'\n'))
    d.addCallback(stop)

reactor.callLater(0, use_pool)
reactor.run()
