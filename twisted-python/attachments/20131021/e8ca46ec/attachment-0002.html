<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;Hi,&lt;/span&gt;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;new&nbsp;to&nbsp;Python.&nbsp;Trying&nbsp;to&nbsp;figure&nbsp;out&nbsp;how&nbsp;to&nbsp;use&nbsp;the&nbsp;serial&nbsp;port&nbsp;I&nbsp;started&nbsp;with&nbsp;pyserial.&lt;/div&gt;<br>
&lt;div&gt;Works&nbsp;-&nbsp;but&nbsp;the&nbsp;CPU&nbsp;usage&nbsp;on&nbsp;my&nbsp;Raspberry&nbsp;Pi&nbsp;is&nbsp;at&nbsp;about&nbsp;30%&nbsp;just&nbsp;for&nbsp;reading&nbsp;the&nbsp;port.&nbsp;Before&nbsp;I&nbsp;started&nbsp;to&nbsp;optimize&nbsp;the&nbsp;code&nbsp;it&nbsp;was&nbsp;even&nbsp;90+%.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;I&nbsp;tried&nbsp;twisted&nbsp;-&nbsp;and&nbsp;boom&nbsp;down&nbsp;to&nbsp;3-4%.&nbsp;Even&nbsp;though&nbsp;twisted&nbsp;also&nbsp;uses&nbsp;pyserial&nbsp;(as&nbsp;far&nbsp;as&nbsp;I&nbsp;read)&nbsp;-&nbsp;obviously&nbsp;better&nbsp;than&nbsp;I&nbsp;do.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;far&nbsp;so&nbsp;good.&lt;/div&gt;&lt;div&gt;With&nbsp;copy&amp;paste&nbsp;from&nbsp;the&nbsp;internet&nbsp;and&nbsp;some&nbsp;editing&nbsp;I&nbsp;got&nbsp;the&nbsp;PI&nbsp;to&nbsp;read&nbsp;from&nbsp;my&nbsp;Arduino.&nbsp;(code&nbsp;below)&lt;/div&gt;&lt;div&gt;But&nbsp;the&nbsp;code&nbsp;seems&nbsp;to&nbsp;be&nbsp;blocking.&nbsp;I&nbsp;tried&nbsp;putting&nbsp;things&nbsp;in&nbsp;a&nbsp;thread&nbsp;-&nbsp;but&nbsp;I&nbsp;must&nbsp;have&nbsp;done&nbsp;something&nbsp;wrong.&nbsp;It&nbsp;is&nbsp;still&nbsp;blocking.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;also&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;write.&lt;/div&gt;&lt;div&gt;Does&nbsp;s.write(&quot;test&quot;)&nbsp;work?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Would&nbsp;be&nbsp;great&nbsp;if&nbsp;someone&nbsp;could&nbsp;help&nbsp;me&nbsp;out&nbsp;here.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;a&nbsp;lot.&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;Robert&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;import&nbsp;logging&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.protocols.basic&nbsp;import&nbsp;LineReceiver&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.protocols.basic&nbsp;import&nbsp;LineReceiver&lt;/div&gt;&lt;div&gt;  &lt;/div&gt;&lt;div&gt;<br>
from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.internet.serialport&nbsp;import&nbsp;SerialPort&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.python&nbsp;import&nbsp;usage&lt;/div&gt;&lt;div&gt;import&nbsp;thread&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;class&nbsp;THOptions(usage.Options):&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;optParameters&nbsp;=&nbsp;[&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;[&#39;baudrate&#39;,&nbsp;&#39;b&#39;,&nbsp;115200,&nbsp;&#39;Serial&nbsp;baudrate&#39;],&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;[&#39;port&#39;,&nbsp;&#39;p&#39;,&nbsp;&#39;/dev/ttyACM0&#39;,&nbsp;&#39;Serial&nbsp;port&nbsp;to&nbsp;use&#39;],]&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;class&nbsp;Echo(LineReceiver):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;processData(self,&nbsp;data):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;print(data)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;lineReceived(self,&nbsp;line):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;try:&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;data&nbsp;=&nbsp;line.rstrip()&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#logging.debug(data)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.processData(data)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#print(line.rstrip())&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#pass&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;except&nbsp;ValueError:&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;logging.error(&#39;Unable&nbsp;to&nbsp;parse&nbsp;data&nbsp;%s&#39;&nbsp;%&nbsp;line)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;SerialInit():&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;o&nbsp;=&nbsp;THOptions()&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;try:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;o.parseOptions()&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;except&nbsp;usage.UsageError,&nbsp;errortext:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;logging.error(&#39;%s&nbsp;%s&#39;&nbsp;%&nbsp;(sys.argv[0],&nbsp;errortext))&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;  &lt;a&nbsp;href=&quot;http://logging.info/&quot;&nbsp;target=&quot;_blank&quot;&gt;logging.info&lt;/a&gt;(&#39;Try&nbsp;%s&nbsp;--help&nbsp;for&nbsp;usage&nbsp;details&#39;&nbsp;%&nbsp;sys.argv[0])&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;raise&nbsp;SystemExit,&nbsp;1&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;  &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;baudrate&nbsp;=&nbsp;o.opts[&#39;baudrate&#39;]&nbsp;#int(&#39;115200&#39;)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;port&nbsp;=&nbsp;o.opts[&#39;port&#39;]&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;logging.debug(&#39;About&nbsp;to&nbsp;open&nbsp;port&nbsp;%s&#39;&nbsp;%&nbsp;port)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;s&nbsp;=&nbsp;SerialPort(Echo(),&nbsp;port,&nbsp;reactor,&nbsp;baudrate=baudrate)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;reactor.run()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thread.start_new_thread(SerialInit())&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;print(&quot;-----&quot;)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;s.write(&#39;123456789&#39;)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;#s.write(&quot;\n&quot;)&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
