<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;PR&nbsp;at&nbsp;&lt;a&nbsp;href=&quot;https://github.com/twisted/twisted/pull/1592&quot;&gt;https://github.com/twisted/twisted/pull/1592&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;hope&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;quick&nbsp;review&nbsp;and&nbsp;make&nbsp;the&nbsp;trunk&nbsp;green&nbsp;again&nbsp;:)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheeers&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Wed,&nbsp;28&nbsp;Apr&nbsp;2021&nbsp;at&nbsp;10:30,&nbsp;Adi&nbsp;Roiban&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:adi@roiban.ro&quot;&gt;adi@roiban.ro&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;A&nbsp;quick&nbsp;diff&nbsp;to&nbsp;fix&nbsp;it...&nbsp;and&nbsp;a&nbsp;ticket&nbsp;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/trac/ticket/10187&quot;&nbsp;target=&quot;_blank&quot;&gt;https://twistedmatrix.com/trac/ticket/10187&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;will&nbsp;create&nbsp;a&nbsp;PR&nbsp;and&nbsp;we&nbsp;can&nbsp;refine&nbsp;the&nbsp;fix&nbsp;during&nbsp;the&nbsp;review.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;diff&nbsp;--git&nbsp;a/src/twisted/words/protocols/irc.py&nbsp;b/src/twisted/words/protocols/irc.py&lt;br&gt;index&nbsp;75300019b..a97abce2e&nbsp;100644&lt;br&gt;---&nbsp;a/src/twisted/words/protocols/irc.py&lt;br&gt;+++&nbsp;b/src/twisted/words/protocols/irc.py&lt;br&gt;@@&nbsp;-3678,10&nbsp;+3678,10&nbsp;@@&nbsp;def&nbsp;ctcpExtract(message):&lt;br&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; normal_messages.append(messages.pop(0))&lt;br&gt; &nbsp; &nbsp; &nbsp; &nbsp; odd&nbsp;=&nbsp;not&nbsp;odd&lt;br&gt; &lt;br&gt;-&nbsp; &nbsp; extended_messages[:]&nbsp;=&nbsp;filter(None,&nbsp;extended_messages)&lt;br&gt;-&nbsp; &nbsp; normal_messages[:]&nbsp;=&nbsp;filter(None,&nbsp;normal_messages)&lt;br&gt;+&nbsp; &nbsp; extended_messages[:]&nbsp;=&nbsp;list(filter(None,&nbsp;extended_messages))&lt;br&gt;+&nbsp; &nbsp; normal_messages[:]&nbsp;=&nbsp;list(filter(None,&nbsp;normal_messages))&lt;br&gt; &lt;br&gt;-&nbsp; &nbsp; extended_messages[:]&nbsp;=&nbsp;map(ctcpDequote,&nbsp;extended_messages)&lt;br&gt;+&nbsp; &nbsp; extended_messages[:]&nbsp;=&nbsp;list(map(ctcpDequote,&nbsp;extended_messages))&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Wed,&nbsp;28&nbsp;Apr&nbsp;2021&nbsp;at&nbsp;10:01,&nbsp;Adi&nbsp;Roiban&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:adi@roiban.ro&quot;&nbsp;target=&quot;_blank&quot;&gt;adi@roiban.ro&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi&nbsp;Wim,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;report&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Tue,&nbsp;27&nbsp;Apr&nbsp;2021&nbsp;at&nbsp;08:14,&nbsp;Wim&nbsp;Lewis&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:wiml@hhhh.org&quot;&nbsp;target=&quot;_blank&quot;&gt;wiml@hhhh.org&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;TLDR:&nbsp;Twisted&nbsp;appears&nbsp;broken&nbsp;on&nbsp;PyPy&nbsp;7.3.4&nbsp;(aka&nbsp;&quot;3.7.10&quot;)?&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;don&#39;t&nbsp;have&nbsp;time&nbsp;right&nbsp;now&nbsp;to&nbsp;set&nbsp;up&nbsp;a&nbsp;PyPy-capable&nbsp;environment&nbsp;and&nbsp;try&nbsp;&lt;br&gt;<br>
to&nbsp;reproduce&nbsp;this,&nbsp;but&nbsp;perhaps&nbsp;someone&nbsp;does?&lt;br&gt;<br>
&lt;br&gt;<br>
Long&nbsp;version:&lt;br&gt;<br>
&lt;br&gt;<br>
Trunk&nbsp;has&nbsp;been&nbsp;broken&nbsp;since&nbsp;the&nbsp;last&nbsp;merge&nbsp;a&nbsp;week&nbsp;or&nbsp;so&nbsp;ago,&nbsp;but&nbsp;I&nbsp;&lt;br&gt;<br>
don&#39;t&nbsp;think&nbsp;the&nbsp;breakage&nbsp;is&nbsp;due&nbsp;to&nbsp;that&nbsp;merge. &nbsp;As&nbsp;an&nbsp;experiment&nbsp;I&nbsp;made&nbsp;&lt;br&gt;<br>
a&nbsp;PR&nbsp;based&nbsp;off&nbsp;the&nbsp;last&nbsp;successful&nbsp;version&nbsp;of&nbsp;trunk,&nbsp;with&nbsp;a&nbsp;whitespace&nbsp;&lt;br&gt;<br>
change,&nbsp;and&nbsp;it&nbsp;now&nbsp;fails&nbsp;CI&nbsp;as&nbsp;well.&nbsp;So&nbsp;I&nbsp;think&nbsp;the&nbsp;failure&nbsp;must&nbsp;be&nbsp;due&nbsp;&lt;br&gt;<br>
to&nbsp;some&nbsp;change&nbsp;that&nbsp;isn&#39;t&nbsp;in&nbsp;Twisted&nbsp;or&nbsp;controlled-for&nbsp;by&nbsp;tox.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;failure&nbsp;in&nbsp;all&nbsp;cases&nbsp;is&nbsp;in&nbsp;the&nbsp;pypy-3.7-alldeps-nocov-posix&nbsp;task.&nbsp;&lt;br&gt;<br>
Unlike&nbsp;our&nbsp;usual&nbsp;CI&nbsp;problems&nbsp;it&nbsp;doesn&#39;t&nbsp;seem&nbsp;to&nbsp;be&nbsp;a&nbsp;random&nbsp;failure:&nbsp;it&nbsp;&lt;br&gt;<br>
fails&nbsp;all&nbsp;the&nbsp;time&nbsp;in&nbsp;the&nbsp;same&nbsp;place.&nbsp;But&nbsp;the&nbsp;place&nbsp;doesn&#39;t&nbsp;make&nbsp;sense&nbsp;&lt;br&gt;<br>
to&nbsp;me.&nbsp;It&#39;s&nbsp;in&nbsp;the&nbsp;IRC&nbsp;CTCP&nbsp;tests,&nbsp;and&nbsp;they&nbsp;fail&nbsp;in&nbsp;the&nbsp;same&nbsp;ways&nbsp;each&nbsp;&lt;br&gt;<br>
time&nbsp;(an&nbsp;expected&nbsp;response&nbsp;is&nbsp;not&nbsp;received).&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;pair&nbsp;of&nbsp;CI&nbsp;runs&nbsp;closest&nbsp;to&nbsp;the&nbsp;change&nbsp;are&nbsp;these:&lt;br&gt;<br>
&lt;br&gt;<br>
run&nbsp;5793:&nbsp;&lt;a&nbsp;href=&quot;https://github.com/twisted/twisted/runs/2328450554&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/twisted/twisted/runs/2328450554&lt;/a&gt;&lt;br&gt;<br>
run&nbsp;5809:&nbsp;&lt;a&nbsp;href=&quot;https://github.com/twisted/twisted/runs/2360415474&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/twisted/twisted/runs/2360415474&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;are&nbsp;a&nbsp;lot&nbsp;of&nbsp;differences,&nbsp;but&nbsp;sys.version&nbsp;went&nbsp;from&nbsp;3.7.9&nbsp;to&nbsp;&lt;br&gt;<br>
3.7.10&nbsp;between&nbsp;those&nbsp;runs,&nbsp;so&nbsp;that&nbsp;seems&nbsp;like&nbsp;the&nbsp;most&nbsp;likely&nbsp;culprit.&lt;br&gt;<br>
&lt;br&gt;<br>
Last&nbsp;working:&lt;br&gt;<br>
&gt; &nbsp;sys.version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp;3.7.9&nbsp;(7e6e2bb30ac5,&nbsp;Nov&nbsp;18&nbsp;2020,&nbsp;10:55:52)&lt;br&gt;<br>
&gt; &nbsp;[PyPy&nbsp;7.3.3-beta0&nbsp;with&nbsp;GCC&nbsp;7.3.1&nbsp;20180303&nbsp;(Red&nbsp;Hat&nbsp;7.3.1-5)]&lt;br&gt;<br>
&gt; &nbsp;sys.prefix &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp;/opt/hostedtoolcache/PyPy/3.7.9/x64&lt;br&gt;<br>
&gt; &nbsp;sys.exec_prefix &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp;/opt/hostedtoolcache/PyPy/3.7.9/x64&lt;br&gt;<br>
&gt; &nbsp;sys.executable &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp;/opt/hostedtoolcache/PyPy/3.7.9/x64/bin/python&lt;br&gt;<br>
&lt;br&gt;<br>
First&nbsp;broken:&lt;br&gt;<br>
&gt; &nbsp;sys.version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp;3.7.10&nbsp;(51efa818fd9b,&nbsp;Apr&nbsp;04&nbsp;2021,&nbsp;11:22:34)&lt;br&gt;<br>
&gt; &nbsp;[PyPy&nbsp;7.3.4&nbsp;with&nbsp;GCC&nbsp;7.3.1&nbsp;20180303&nbsp;(Red&nbsp;Hat&nbsp;7.3.1-5)]&lt;br&gt;<br>
&gt; &nbsp;sys.prefix &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp;/opt/hostedtoolcache/PyPy/3.7.10/x64&lt;br&gt;<br>
&gt; &nbsp;sys.exec_prefix &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp;/opt/hostedtoolcache/PyPy/3.7.10/x64&lt;br&gt;<br>
&gt; &nbsp;sys.executable &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp;/opt/hostedtoolcache/PyPy/3.7.10/x64/bin/python&lt;br&gt;<br>
&lt;br&gt;<br>
PyPy&#39;s&nbsp;release&nbsp;notes&nbsp;for&nbsp;7.3.4&nbsp;don&#39;t&nbsp;list&nbsp;anything&nbsp;that&nbsp;jumps&nbsp;out&nbsp;at&nbsp;me:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://doc.pypy.org/en/latest/whatsnew-pypy3-7.3.4.html&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://doc.pypy.org/en/latest/whatsnew-pypy3-7.3.4.html&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
My&nbsp;guess&nbsp;would&nbsp;be&nbsp;some&nbsp;latent&nbsp;timing&nbsp;bug&nbsp;in&nbsp;Twisted&nbsp;that&nbsp;was&nbsp;uncovered&nbsp;&lt;br&gt;<br>
by&nbsp;pypy&nbsp;execution&nbsp;time&nbsp;changes&nbsp;(I&nbsp;don&#39;t&nbsp;imagine&nbsp;that&nbsp;the&nbsp;CTCP&nbsp;code&nbsp;gets&nbsp;&lt;br&gt;<br>
exercised&nbsp;very&nbsp;heavily&nbsp;these&nbsp;days)&nbsp;or&nbsp;perhaps&nbsp;PyPy&nbsp;got&nbsp;a&nbsp;bug.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Wim.&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;setup&nbsp;a&nbsp;pyp3.7.4&nbsp;and&nbsp;I&nbsp;can&nbsp;reproduce&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;see&nbsp;3&nbsp;options:&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;*&nbsp;Option&nbsp;A:&nbsp;Skip&nbsp;those&nbsp;tests&nbsp;on&nbsp;pypy &nbsp;and&nbsp;open&nbsp;a&nbsp;separate&nbsp;ticket&nbsp;to&nbsp;fix&nbsp;the&nbsp;test&lt;/div&gt;&lt;div&gt;*&nbsp;Option&nbsp;B:&nbsp;Pin&nbsp;&nbsp;pypy&nbsp;3.7.9&nbsp;for&nbsp;GHA&nbsp;and&nbsp;open&nbsp;a&nbsp;separate&nbsp;ticket&nbsp;to&nbsp;fix&nbsp;the&nbsp;test&nbsp;and&nbsp;unpin&nbsp;it&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;*&nbsp;Option&nbsp;C:&nbsp;Just&nbsp;fix&nbsp;the&nbsp;tests&nbsp;:)&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;I&nbsp;am&nbsp;looking&nbsp;at&nbsp;option&nbsp;C&nbsp;for&nbsp;one&nbsp;hour...&nbsp;if&nbsp;I&nbsp;can&#39;t&nbsp;find&nbsp;a&nbsp;fix&nbsp;will&nbsp;look&nbsp;into&nbsp;option&nbsp;A.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;Cheers&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Adi&nbsp;Roiban&lt;/div&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Adi&nbsp;Roiban&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&gt;Adi&nbsp;Roiban&lt;/div&gt;<br>

</tt>
