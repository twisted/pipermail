<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:19574.17828.236399.757022@jon.es&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Yes,&nbsp;I&nbsp;was&nbsp;expecting&nbsp;you&nbsp;to&nbsp;wrap&nbsp;item.obsolete()&nbsp;and&nbsp;renew(data)&nbsp;in<br>
try/except,&nbsp;as&nbsp;needed.&nbsp;&nbsp;If&nbsp;you&nbsp;want&nbsp;a&nbsp;clean&nbsp;but&nbsp;slightly&nbsp;slower&nbsp;way&nbsp;to&nbsp;do<br>
that,&nbsp;how&nbsp;about&nbsp;something&nbsp;like:<br>
<br>
<br>
def&nbsp;getCachedResult(cache,&nbsp;key):<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;release(result,&nbsp;item):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.release()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;renew(data):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;renew(data)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;notFound(fail):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fail.trap(NotFound)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;readItem(item):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;item.read()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;checkObsolete(item):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;defer.maybeDeferred(item.obsolete)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.addCallback(lambda&nbsp;_:&nbsp;readItem(item))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.addBoth(release,&nbsp;item)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.addCallback(renew)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;d<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;cache.open(key)<br>
&nbsp;&nbsp;&nbsp;&nbsp;d.addCallbacks(checkObsolete,&nbsp;notFound)<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;d<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
Thanks,&nbsp;maybeDeferred&lt;span&nbsp;id=&quot;result_box&quot;&nbsp;class=&quot;short_text&quot;&gt;&lt;span<br>
&nbsp;style=&quot;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&quot;<br>
&nbsp;title=&quot;&quot;&gt;&nbsp;&lt;/span&gt;&lt;/span&gt;&lt;span&nbsp;id=&quot;result_box&quot;&nbsp;class=&quot;short_text&quot;&gt;&lt;span<br>
&nbsp;style=&quot;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&quot;<br>
&nbsp;title=&quot;&quot;&gt;is&nbsp;what&nbsp;I&nbsp;missed&lt;/span&gt;&lt;/span&gt;&lt;span&nbsp;id=&quot;result_box&quot;<br>
&nbsp;class=&quot;short_text&quot;&gt;&lt;span<br>
&nbsp;style=&quot;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&quot;<br>
&nbsp;title=&quot;&quot;&gt;&nbsp;:)&lt;br&gt;<br>
&lt;/span&gt;&lt;/span&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
