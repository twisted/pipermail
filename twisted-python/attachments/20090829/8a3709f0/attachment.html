<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Aug&nbsp;28,&nbsp;2009&nbsp;at&nbsp;7:49&nbsp;PM,&nbsp;陶艺夫&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:artman328@gmail.com&quot;&gt;artman328@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Hi,&lt;br&gt;I&nbsp;copied&nbsp;the&nbsp;code&nbsp;from:&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/pipermail/twisted-python/2007-May/015377.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/pipermail/twisted-python/2007-May/015377.html&lt;/a&gt;&nbsp;and&nbsp;it&nbsp;ran&nbsp;ok.&lt;br&gt;<br>
And&nbsp;then&nbsp;I&nbsp;followed&nbsp;David&#39;s&nbsp;advice&nbsp;from&nbsp;here:&nbsp;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/pipermail/twisted-python/2007-May/015383.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/pipermail/twisted-python/2007-May/015383.html&lt;/a&gt;&nbsp;to&nbsp;use&nbsp;threading.Event&nbsp;to&nbsp;control&nbsp;server&#39;s&nbsp;stop,&nbsp;it&nbsp;ran&nbsp;ok&nbsp;too.&nbsp;But&nbsp;David&#39;s&nbsp;boot_service.py&nbsp;just&nbsp;could&nbsp;install&nbsp;the&nbsp;service,&nbsp;error&nbsp;on&nbsp;start&nbsp;(error&nbsp;1063).&nbsp;Any&nbsp;help?&lt;br&gt;<br>
<br>
One&nbsp;more&nbsp;question,&nbsp;who&nbsp;can&nbsp;fill&nbsp;in&nbsp;David&#39;s&nbsp;&#39;py2exe&#39;&nbsp;setup&nbsp;file&nbsp;more&nbsp;codes&nbsp;to&nbsp;guide&nbsp;me&nbsp;&nbsp;moving&nbsp;to&nbsp;next&nbsp;step?&nbsp;David,&nbsp;are&nbsp;you&nbsp;there?&nbsp;:)&lt;br&gt;&lt;br&gt;Thanks.&nbsp; &nbsp;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;看你的名字，我认为我写中文你应该能看懂。&lt;br&gt;我给你段可以通用的代码吧。&lt;br&gt;&lt;br&gt;首先，是一个你要编译成ntservice的模块的文件。似设abcservice.py&nbsp;,内容如下&lt;br&gt;&lt;br&gt;#coding=utf-8&lt;br&gt;import&nbsp;win32serviceutil&lt;br&gt;import&nbsp;os&lt;br&gt;import&nbsp;sys&lt;br&gt;import&nbsp;win32api&lt;br&gt;sys.path&nbsp;=&nbsp;sys.path&nbsp;+&nbsp;[os.path.dirname(win32api.GetModuleFileName(0))]&lt;br&gt;<br>
import&nbsp;server&lt;br&gt;&lt;br&gt;&lt;br&gt;class&nbsp;PowerService(win32serviceutil.ServiceFramework):&lt;br&gt;   &nbsp;_svc_name_&nbsp;=&nbsp;&quot;Your&nbsp;Service&nbsp;Name&quot;&lt;br&gt;   &nbsp;_svc_display_name_&nbsp;=&nbsp;&quot;Your&nbsp;Service&nbsp;Display&nbsp;Name&quot;&lt;br&gt;   &nbsp;_svc_description_&nbsp;=&nbsp;unicode(&quot;&quot;&quot;&nbsp;这里可以写多行的中文。&lt;br&gt;<br>
也可以写&nbsp;作者：你的名字。&nbsp;&lt;br&gt;因为文件是utf-8的，在这里，要把中文转成gb2312，才能在windows里正常显示.&lt;br&gt;&quot;&quot;&quot;,&#39;utf-8&#39;).encode(&#39;gb2312&#39;)&lt;br&gt;&lt;br&gt;   &nbsp;def&nbsp;SvcDoRun(self):&lt;br&gt;       &nbsp;server.start()&lt;br&gt;&lt;br&gt;   &nbsp;def&nbsp;SvcStop(self):&lt;br&gt;       &nbsp;server.stop()&lt;br&gt;<br>
&lt;br&gt;if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:&lt;br&gt;   &nbsp;win32serviceutil.HandleCommandLine(PowerService)&lt;br&gt;&lt;br&gt;&lt;br&gt;用把这个程序打包成.exe以后，它就是一个可以通用的启动服务的程序了。&lt;br&gt;你的不同程序，只要在同一目录下，修改你的server.py文件，就可以了。&lt;br&gt;&lt;br&gt;&lt;br&gt;下面举例一个server.py&lt;br&gt;&lt;br&gt;#coding=utf-8&lt;br&gt;<br>
from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;&lt;br&gt;def&nbsp;start():&lt;br&gt;   &nbsp;reactor.run(installSignalHandlers=0)&lt;br&gt;&lt;br&gt;def&nbsp;stop():&lt;br&gt;   &nbsp;reactor.callFromThread(reactor.stop)&lt;br&gt;&lt;br&gt;&lt;br&gt;下面是py2exe打包用的setup.py文件内容&lt;br&gt;&lt;br&gt;rom&nbsp;distutils.core&nbsp;import&nbsp;setup&lt;br&gt;<br>
import&nbsp;py2exe&lt;br&gt;&lt;br&gt;import&nbsp;sys&lt;br&gt;&lt;br&gt;&lt;br&gt;setup(name=&#39;service&nbsp;name&#39;,&lt;br&gt;     &nbsp;version=&#39;1.0&#39;,&lt;br&gt;     &nbsp;author=&#39;your&nbsp;name&#39;,&lt;br&gt;     &nbsp;service=[&#39;abcservice&#39;])&lt;br&gt;&lt;br&gt;print&nbsp;&quot;---Done---&quot;&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;然后用python&nbsp;setup.py&nbsp;py2exe命令打包。&lt;br&gt;打包好以后，就可以直接发布了。&lt;br&gt;如果缺什么模块，直接复到到abcservice.exe文件所有目录就行。&lt;br&gt;如果你的程序修改什么，只直接修改好代码，放在目录下就行。修改程序不用重新py2exe打包。&lt;br&gt;&lt;i&gt;&lt;br&gt;&lt;br&gt;&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
