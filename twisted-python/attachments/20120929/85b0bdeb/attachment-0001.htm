<tt>
On&nbsp;28&nbsp;September&nbsp;2012&nbsp;15:32,&nbsp;Tom&nbsp;Sheffler&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:tom.sheffler@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;tom.sheffler@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;Paul&nbsp;-&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;I&amp;#39;m&nbsp;very&nbsp;new&nbsp;to&nbsp;twisted&nbsp;(I&amp;#39;ve&nbsp;only&nbsp;just&nbsp;started&nbsp;using&nbsp;it,&nbsp;so&nbsp;I&nbsp;apologise&nbsp;if&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;anything&nbsp;I&nbsp;ask&nbsp;is&nbsp;seemingly&nbsp;obvious!).&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;<br>
<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;I&amp;#39;m&nbsp;looking&nbsp;to&nbsp;try&nbsp;and&nbsp;set&nbsp;up&nbsp;a&nbsp;FTP&nbsp;server&nbsp;which&nbsp;will&nbsp;serve&nbsp;a&nbsp;file&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;structure&nbsp;and&nbsp;files&nbsp;which&nbsp;don&amp;#39;t&nbsp;exists&nbsp;on&nbsp;the&nbsp;server&nbsp;(the&nbsp;file&nbsp;structure&lt;br&gt;<br>
<br>
<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;information&nbsp;is&nbsp;stored&nbsp;on&nbsp;cassandra,&nbsp;and&nbsp;the&nbsp;files&nbsp;are&nbsp;on&nbsp;s3).&nbsp;The&nbsp;file&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;structure&nbsp;and&nbsp;files&nbsp;will&nbsp;also&nbsp;be&nbsp;unique&nbsp;to&nbsp;the&nbsp;user,&nbsp;so&nbsp;different&nbsp;logins&lt;br&gt;<br>
<br>
<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;will&nbsp;generate&nbsp;the&nbsp;file&nbsp;structure&nbsp;for&nbsp;that&nbsp;particular&nbsp;user,&nbsp;but&nbsp;I&nbsp;guess&nbsp;I&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;can&nbsp;adress&nbsp;that&nbsp;later.&lt;/span&gt;&lt;/blockquote&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Here&nbsp;is&nbsp;a&nbsp;quick&nbsp;sketch&nbsp;of&nbsp;some&nbsp;of&nbsp;the&nbsp;steps&nbsp;...&nbsp;but&nbsp;beware,&nbsp;I&nbsp;haven&amp;#39;t&nbsp;debugged&nbsp;this.&nbsp; You&amp;#39;ll&nbsp;want&nbsp;to&nbsp;subclass&nbsp;twisted.protocols.ftp.FTPShell&nbsp;with&nbsp;a&nbsp;new&nbsp;command&nbsp;interpreter&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt; &nbsp; &nbsp;class&nbsp;PaulsFTPShell(FTPShell):&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt; &nbsp; &nbsp; &nbsp; &nbsp;....&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;The&nbsp;you&amp;#39;ll&nbsp;need&nbsp;to&nbsp;write&nbsp;a&nbsp;Realm&nbsp;that&nbsp;returns&nbsp;an&nbsp;instance&nbsp;of&nbsp;your&nbsp;FTP&nbsp;Shell:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;br&gt;<br>
<br>
<br>
&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;div&gt;class&nbsp;PaulsFTPRealm(FTPRealm):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;@type&nbsp;anonymousRoot:&nbsp;L{twisted.python.filepath.FilePath}&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;@ivar&nbsp;anonymousRoot:&nbsp;Root&nbsp;of&nbsp;the&nbsp;filesystem&nbsp;to&nbsp;which&nbsp;anonymous&lt;/div&gt;<br>
<br>
<br>
&lt;div&gt; &nbsp; &nbsp;users&nbsp;will&nbsp;be&nbsp;granted&nbsp;access.&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;implements(portal.IRealm)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;__init__(self,&nbsp;....)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;....&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;requestAvatar(self,&nbsp;avatarId,&nbsp;mind,&nbsp;*interfaces):&lt;/div&gt;<br>
<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;for&nbsp;iface&nbsp;in&nbsp;interfaces:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;iface&nbsp;is&nbsp;IFTPShell:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;avatarId&nbsp;is&nbsp;checkers.ANONYMOUS:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;avatar&nbsp;=&nbsp;None&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else:&lt;/div&gt;<br>
<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;avatar&nbsp;=&nbsp;PaulsFTPShell(&nbsp;...)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;IFTPShell,&nbsp;avatar,&nbsp;getattr(avatar,&nbsp;&amp;#39;logout&amp;#39;,&nbsp;lambda:&nbsp;None)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;raise&nbsp;NotImplementedError(&amp;quot;Only&nbsp;IFTPShell&nbsp;interface&nbsp;is&nbsp;supported&nbsp;by&nbsp;this&nbsp;realm&amp;quot;)&lt;/div&gt;<br>
<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Then&nbsp;you&amp;#39;ll&nbsp;stich&nbsp;it&nbsp;all&nbsp;together&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt; &nbsp; &nbsp;f&nbsp;=&nbsp;FTPFactory()&lt;/font&gt;&lt;/div&gt;&lt;div&gt;<br>
<br>
<br>
&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt; &nbsp; &nbsp;r&nbsp;=&nbsp;PaulsFTPRealm()&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt; &nbsp; &nbsp;p&nbsp;=&nbsp;Portal.Portal(r)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt; &nbsp; &nbsp;p.registerChecker(...)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;br&gt;<br>
<br>
<br>
<br>
&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt; &nbsp; &nbsp;f.portal&nbsp;=&nbsp;p&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Hope&nbsp;this&nbsp;helps&nbsp;get&nbsp;you&nbsp;started.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;br&gt;<br>
<br>
<br>
&lt;/font&gt;&lt;/div&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you.&nbsp;I&amp;#39;ve&nbsp;made&nbsp;quite&nbsp;a&nbsp;bit&nbsp;of&nbsp;progress&nbsp;and&nbsp;now&nbsp;have&nbsp;my&nbsp;own&nbsp;Portal,&nbsp;CredentialsChecker,&nbsp;Realm,&nbsp;Shell,&nbsp;and&nbsp;FilePath&nbsp;object.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;One&nbsp;thing&nbsp;I&nbsp;haven&amp;#39;t&nbsp;been&nbsp;able&nbsp;to&nbsp;work&nbsp;out&nbsp;is,&nbsp;when&nbsp;I&nbsp;override,&nbsp;lets&nbsp;say&nbsp;listdir&nbsp;for&nbsp;example&nbsp;in&nbsp;FilePath,&nbsp;I&nbsp;need&nbsp;to&nbsp;make&nbsp;a&nbsp;webcall&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;folder&nbsp;contents,&nbsp;how&nbsp;can&nbsp;I&nbsp;make&nbsp;this&nbsp;call&nbsp;asynchronously?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;m&nbsp;guessing&nbsp;I&nbsp;need&nbsp;to&nbsp;used&nbsp;deferred&nbsp;in&nbsp;someway,&nbsp;but&nbsp;seeing&nbsp;as&nbsp;listdir&nbsp;doesn&amp;#39;t&nbsp;return&nbsp;deferred&nbsp;objects&nbsp;I&amp;#39;m&nbsp;not&nbsp;sure&nbsp;how&nbsp;to&nbsp;make&nbsp;it&nbsp;work.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;listdir&nbsp;gets&nbsp;called&nbsp;from&nbsp;the&nbsp;Shell&nbsp;I&nbsp;guess&nbsp;I&nbsp;could&nbsp;change&nbsp;how&nbsp;blocking&nbsp;calls&nbsp;in&nbsp;my&nbsp;FilePath&nbsp;object&nbsp;get&nbsp;called?&lt;/div&gt;<br>

</tt>
