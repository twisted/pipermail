<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;/div&gt;Sorry&nbsp;I&nbsp;had&nbsp;a&nbsp;typo&nbsp;in&nbsp;twisted&nbsp;program&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;&lt;a&nbsp;class=&quot;gmail_plusreply&quot;&nbsp;id=&quot;gmail-m_696722601013816822plusReplyChip-3&quot;&gt;@defer.inlinecallbacks&lt;/a&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;def&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;long_computation&lt;/span&gt;(&lt;span&nbsp;style=&quot;color:rgb(128,128,128);background-color:rgb(255,216,236)&quot;&gt;rec_type,&nbsp;data&lt;/span&gt;)&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;:&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;#&nbsp;some&nbsp;long&nbsp;computation&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;defer.returnValue(recs)&lt;/b&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;@defer.inlinecallbacks&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;fetch_data(user_id):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;  &lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(128,128,128);background-color:rgb(255,216,236)&quot;&gt;r&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(128,128,128)&quot;&gt; &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-weight:bold&quot;&gt;=&nbsp;yield&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;json.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(153,0,0);font-weight:bold&quot;&gt;loads&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;(requests.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(153,0,0);font-weight:bold&quot;&gt;get&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(221,17,68);background-color:rgb(247,231,241)&quot;&gt;&#39;url/to/fetch/%s&#39;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-weight:bold&quot;&gt;%&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-style:italic&quot;&gt;user_id&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;).text)&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; defer.returnValue(r)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;@defer.inlinecallbacks&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;fetch_recs(user_id):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; data&nbsp;=&nbsp;yield&nbsp;fetch_data(user_id)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;recs&nbsp;=&nbsp;{}&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; for&nbsp;stype&nbsp;in&nbsp;similar_types:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;b&gt;d&nbsp;=&nbsp;defer.ToThread(&lt;span&nbsp;style=&quot;color:rgb(153,0,0);background-color:rgb(248,248,255);font-family:Menlo;font-size:9pt&quot;&gt;long_computation&lt;/span&gt;,&nbsp;*(stype,&nbsp;data))&nbsp;//&nbsp;typo&nbsp;was&nbsp;here&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rec&nbsp;=&nbsp;yield&nbsp;d&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; recs[stype]&nbsp;=&nbsp;rec&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; defer.returnValue(recs)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_attr&quot;&gt;On&nbsp;Tue,&nbsp;Jun&nbsp;25,&nbsp;2019&nbsp;at&nbsp;11:48&nbsp;PM&nbsp;Waqar&nbsp;Khan&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:wk80333@gmail.com&quot;&gt;wk80333@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello&nbsp;folks,&lt;div&gt; &nbsp;I&nbsp;recently&nbsp;stumbled&nbsp;upon&nbsp;twisted&nbsp;and&nbsp;was&nbsp;wondering&nbsp;if&nbsp;it&nbsp;could&nbsp;suit&nbsp;my&nbsp;needs.&nbsp;On&nbsp;one&nbsp;hand,&nbsp;I&nbsp;want&nbsp;to&nbsp;use&nbsp;python&nbsp;but&nbsp;on&nbsp;another&nbsp;hand&nbsp;there&nbsp;are&nbsp;all&nbsp;these&nbsp;scalability&nbsp;concerns&nbsp;with&nbsp;this&nbsp;language&nbsp;so,&nbsp;I&nbsp;though&nbsp;I&nbsp;would&nbsp;pick&nbsp;the&nbsp;brains&nbsp;of&nbsp;the&nbsp;community.&nbsp;So..&nbsp;a&nbsp;flask&nbsp;based&nbsp;app&nbsp;would&nbsp;look&nbsp;something&nbsp;like&nbsp;this.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;similar_types&nbsp;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;=&nbsp;&lt;/span&gt;[&lt;span&nbsp;style=&quot;color:rgb(221,17,68);background-color:rgb(247,231,241)&quot;&gt;&#39;foo&#39;&lt;/span&gt;,&nbsp;&lt;span&nbsp;style=&quot;color:rgb(221,17,68);background-color:rgb(247,231,241)&quot;&gt;&#39;bar&#39;&lt;/span&gt;,&nbsp;&lt;span&nbsp;style=&quot;color:rgb(221,17,68);background-color:rgb(247,231,241)&quot;&gt;&#39;baz&#39;&lt;/span&gt;]&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;def&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;long_computation&lt;/span&gt;(&lt;span&nbsp;style=&quot;color:rgb(128,128,128);background-color:rgb(255,216,236)&quot;&gt;rec_type&lt;/span&gt;)&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;:&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;#&nbsp;some&nbsp;long&nbsp;computation&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;return&nbsp;&lt;/span&gt;recs&lt;br&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;@app.route&lt;/span&gt;(&lt;span&nbsp;style=&quot;color:rgb(221,17,68);background-color:rgb(247,231,241)&quot;&gt;&#39;/fetch_similar_users/&lt;user_id&gt;&#39;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;def&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;fetch_similar_users&lt;/span&gt;(&lt;span&nbsp;style=&quot;font-style:italic&quot;&gt;user_id&lt;/span&gt;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;color:rgb(128,128,128);background-color:rgb(255,216,236)&quot;&gt;r&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(128,128,128)&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;=&nbsp;&lt;/span&gt;json.&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;loads&lt;/span&gt;(requests.&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;get&lt;/span&gt;(&lt;span&nbsp;style=&quot;color:rgb(221,17,68);background-color:rgb(247,231,241)&quot;&gt;&#39;url/to/fetch/%s&#39;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;%&lt;/span&gt;&lt;span&nbsp;style=&quot;font-style:italic&quot;&gt;user_id&lt;/span&gt;).text)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recs&nbsp;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;=&nbsp;&lt;/span&gt;{}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;for&nbsp;&lt;/span&gt;stype&nbsp;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;in&nbsp;&lt;/span&gt;similar_types&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;:&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;recs[stype]&nbsp;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;=&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;long_computation&lt;/span&gt;(rec_type)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;return&nbsp;&lt;/span&gt;recs&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now,&nbsp;I&nbsp;tried&nbsp;to&nbsp;&quot;twistify&quot;&nbsp;but&nbsp;it&nbsp;failed.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;&lt;a&nbsp;class=&quot;gmail_plusreply&quot;&nbsp;id=&quot;gmail-m_696722601013816822plusReplyChip-3&quot;&gt;@defer.inlinecallbacks&lt;/a&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;def&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;long_computation&lt;/span&gt;(&lt;span&nbsp;style=&quot;color:rgb(128,128,128);background-color:rgb(255,216,236)&quot;&gt;rec_type&lt;/span&gt;)&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;:&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;#&nbsp;some&nbsp;long&nbsp;computation&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;defer.returnValue(recs)&lt;/b&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;@defer.inlinecallbacks&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;fetch_data(user_id):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;  &lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(128,128,128);background-color:rgb(255,216,236)&quot;&gt;r&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(128,128,128)&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-weight:bold&quot;&gt;=&nbsp;yield&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;json.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(153,0,0);font-weight:bold&quot;&gt;loads&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;(requests.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(153,0,0);font-weight:bold&quot;&gt;get&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Menlo;font-size:9pt;color:rgb(221,17,68);background-color:rgb(247,231,241)&quot;&gt;&#39;url/to/fetch/%s&#39;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-weight:bold&quot;&gt;%&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Menlo;font-size:9pt;font-style:italic&quot;&gt;user_id&lt;/span&gt;&lt;span&nbsp;style=&quot;background-color:rgb(248,248,255);color:rgb(0,0,0);font-family:Menlo;font-size:9pt&quot;&gt;).text)&lt;/span&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; defer.returnValue(r)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;@defer.inlinecallbacks&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;fetch_recs(user_id):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; data&nbsp;=&nbsp;yield&nbsp;fetch_data(user_id)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;recs&nbsp;=&nbsp;{}&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; for&nbsp;stype&nbsp;in&nbsp;similar_types:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;d&nbsp;=&nbsp;defer.ToThread(fetch_data,&nbsp;*(stype))&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rec&nbsp;=&nbsp;yield&nbsp;d&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; recs[stype]&nbsp;=&nbsp;rec&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; defer.returnValue(recs)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;wrapped&nbsp;all&nbsp;the&nbsp;above&nbsp;in&nbsp;twisted&nbsp;render_Get&nbsp;method..&nbsp;but&nbsp;then&nbsp;I&nbsp;did&nbsp;a&nbsp;load&nbsp;test&nbsp;with&nbsp;locust&nbsp;(&lt;a&nbsp;href=&quot;https://docs.locust.io/en/latest/what-is-locust.html&quot;&nbsp;target=&quot;_blank&quot;&gt;https://docs.locust.io/en/latest/what-is-locust.html&lt;/a&gt;)&nbsp;framework.&lt;/div&gt;&lt;div&gt;It&nbsp;choked.&nbsp;As&nbsp;the&nbsp;time&nbsp;progressed,&nbsp;the&nbsp;response&nbsp;time&nbsp;increased.&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;guessing,&nbsp;things&nbsp;are&nbsp;still&nbsp;blocking. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can&nbsp;you&nbsp;please&nbsp;help&nbsp;me&nbsp;look&nbsp;into&nbsp;the&nbsp;right&nbsp;place.&nbsp;Why&nbsp;exactly&nbsp;am&nbsp;I&nbsp;seeing&nbsp;increase&nbsp;in&nbsp;response&nbsp;time&nbsp;as&nbsp;the&nbsp;time&nbsp;progresses.&nbsp;I&nbsp;am&nbsp;guessing&nbsp;things&nbsp;are&nbsp;still&nbsp;working&nbsp;in&nbsp;&quot;blocking&quot;&nbsp;fashion&nbsp;but&nbsp;i&nbsp;thought&nbsp;the&nbsp;above&nbsp;should&nbsp;run&nbsp;things&nbsp;in&nbsp;async.&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;  &lt;/div&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
