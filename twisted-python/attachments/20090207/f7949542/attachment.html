<tt>
Thank&nbsp;you&nbsp;very&nbsp;much&nbsp;for&nbsp;you&nbsp;answer.&nbsp;Maybe&nbsp;the&nbsp;twisted&nbsp;details&nbsp;removed&nbsp;my&nbsp;focus&nbsp;from&nbsp;the&nbsp;&quot;big&nbsp;picture&quot;.&nbsp;&lt;br&gt;I&nbsp;have&nbsp;one&nbsp;followup&nbsp;question,&nbsp;added&nbsp;next&nbsp;to&nbsp;its&nbsp;context&nbsp;below..&nbsp;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Feb&nbsp;6,&nbsp;2009&nbsp;at&nbsp;8:29&nbsp;PM,&nbsp;Jean-Paul&nbsp;Calderone&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:exarkun@divmod.com&quot;&gt;exarkun@divmod.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;On&nbsp;Fri,&nbsp;6&nbsp;Feb&nbsp;2009&nbsp;17:30:19&nbsp;+0100,&nbsp;&quot;B.&nbsp;B.&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:thebbzoo@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;thebbzoo@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Hello,&nbsp;I&nbsp;am&nbsp;relative&nbsp;new&nbsp;to&nbsp;twisted,&nbsp;though&nbsp;I&nbsp;have&nbsp;manage&nbsp;to&nbsp;make&nbsp;a&nbsp;simple&lt;br&gt;<br>
client&nbsp;server&nbsp;solution&nbsp;(&nbsp;using&nbsp;perspective&nbsp;broker&nbsp;)&nbsp;that&nbsp;I&nbsp;am&nbsp;now&nbsp;try&nbsp;to&lt;br&gt;<br>
refactor&nbsp;a&nbsp;little.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;solution&nbsp;is&nbsp;now&nbsp;something&nbsp;like&nbsp;:&lt;br&gt;<br>
&lt;br&gt;<br>
Using&nbsp;perspective&nbsp;broker,&nbsp;clients&nbsp;connects&nbsp;to&nbsp;the&nbsp;server&nbsp;(&nbsp;setting&nbsp;up&nbsp;a&lt;br&gt;<br>
remote&nbsp;reference&nbsp;to&nbsp;each&nbsp;other&nbsp;).&lt;br&gt;<br>
Via&nbsp;a&nbsp;PB&nbsp;call,&nbsp;each&nbsp;client&nbsp;can&nbsp;request&nbsp;the&nbsp;server&nbsp;do&nbsp;some&nbsp;processing.&nbsp;The&lt;br&gt;<br>
result&nbsp;of&nbsp;&nbsp;the&nbsp;processing&nbsp;is&nbsp;distributed&nbsp;to&nbsp;each&nbsp;connected&nbsp;client&nbsp;-&nbsp;and&nbsp;the&lt;br&gt;<br>
client&nbsp;asking&nbsp;for&nbsp;the&nbsp;request&nbsp;gets&nbsp;a&nbsp;simple&nbsp;status&nbsp;report!&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;solution&nbsp;works&nbsp;quite&nbsp;well,&nbsp;the&nbsp;only&nbsp;bottleneck&nbsp;is&nbsp;that&nbsp;all&nbsp;the&lt;br&gt;<br>
&quot;thread-safe&quot;&nbsp;processing&nbsp;on&nbsp;the&nbsp;server&nbsp;is&nbsp;done&nbsp;in&nbsp;the&nbsp;mainloop&nbsp;of&nbsp;the&nbsp;server&lt;br&gt;<br>
reactor.&nbsp;I&nbsp;want&nbsp;to&nbsp;do&nbsp;concurrent&nbsp;processing&nbsp;on&nbsp;the&nbsp;server!&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
That&nbsp;requires&nbsp;that&nbsp;your&nbsp;server&nbsp;be&nbsp;capable&nbsp;of&nbsp;doing&nbsp;the&nbsp;processing&lt;br&gt;<br>
concurrently.&nbsp;&nbsp;If&nbsp;the&nbsp;processing&nbsp;is&nbsp;CPU&nbsp;bound,&nbsp;then&nbsp;you&nbsp;need&nbsp;multiple&lt;br&gt;<br>
CPUs.&nbsp;&nbsp;If&nbsp;it&nbsp;is&nbsp;disk&nbsp;I/O&nbsp;bound,&nbsp;you&nbsp;need&nbsp;multiple&nbsp;disks.&nbsp;&nbsp;etc.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Actually&nbsp;I&nbsp;use&nbsp;a&nbsp;quadcore&nbsp;processor&nbsp;and&nbsp;there&nbsp;is&nbsp;only&nbsp;a&nbsp;litte&nbsp;diskusage.&nbsp;But&nbsp;thanks&nbsp;to&nbsp;your&nbsp;reply,&nbsp;I&nbsp;am&nbsp;thinking&nbsp;on&nbsp;the&nbsp;famous&nbsp;&quot;Global&nbsp;Interpreter&nbsp;Lock&quot;&nbsp;in&nbsp;python.&nbsp;&lt;br&gt;<br>
Since&nbsp;allmost&nbsp;all&nbsp;processing&nbsp;is&nbsp;happing&nbsp;in&nbsp;pure&nbsp;python,&nbsp;does&#39;nt&nbsp;the&nbsp;GIL&nbsp;prevent&nbsp;me&nbsp;to&nbsp;obtain&nbsp;any&nbsp;remarkable&nbsp;performance&nbsp;gain&nbsp;by&nbsp;doing&nbsp;concurrent&nbsp;processing&nbsp;in&nbsp;pure&nbsp;python???&lt;br&gt;(&nbsp;At&nbsp;least&nbsp;as&nbsp;long&nbsp;as&nbsp;I&nbsp;only&nbsp;use&nbsp;one&nbsp;process&nbsp;for&nbsp;the&nbsp;threads&nbsp;)&nbsp;&nbsp;&lt;br&gt;<br>
&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
The&nbsp;function&nbsp;doing&nbsp;the&nbsp;processing&nbsp;on&nbsp;the&nbsp;server,&nbsp;also&nbsp;distribute&nbsp;the&nbsp;result&lt;br&gt;<br>
to&nbsp;all&nbsp;the&nbsp;connected&nbsp;clients,&nbsp;and&nbsp;returns&nbsp;the&nbsp;result&nbsp;to&nbsp;the&nbsp;klient&nbsp;asking&lt;br&gt;<br>
for&nbsp;the&nbsp;request.&lt;br&gt;<br>
&lt;br&gt;<br>
My&nbsp;question&nbsp;is&nbsp;:&lt;br&gt;<br>
If&nbsp;I&nbsp;just&nbsp;&quot;defer&quot;&nbsp;that&nbsp;function&nbsp;&quot;toThread&quot;&nbsp;(&nbsp;like&nbsp;&nbsp;threads.deferToThread(&lt;br&gt;<br>
myServerProcessingFunction&nbsp;)&nbsp;).&nbsp;Do&nbsp;I&nbsp;have&nbsp;potential&nbsp;problems,&nbsp;when&nbsp;several&lt;br&gt;<br>
threads&nbsp;try&nbsp;to&nbsp;distribute&nbsp;its&nbsp;result&nbsp;to&nbsp;the&nbsp;connecting&nbsp;clients???&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
If&nbsp;you&nbsp;use&nbsp;deferToThread&nbsp;with&nbsp;your&nbsp;&quot;processing&quot;&nbsp;function,&nbsp;then&nbsp;the&nbsp;function&lt;br&gt;<br>
must&nbsp;be&nbsp;thread-safe.&nbsp;&nbsp;Since&nbsp;nearly&nbsp;no&nbsp;Twisted&nbsp;APIs&nbsp;are&nbsp;thread-safe,&nbsp;it&nbsp;cannot&lt;br&gt;<br>
use&nbsp;them&nbsp;directly.&nbsp;&nbsp;It&nbsp;may&nbsp;only&nbsp;use&nbsp;reactor.callFromThread&nbsp;to&nbsp;send&nbsp;events&lt;br&gt;<br>
back&nbsp;to&nbsp;the&nbsp;reactor&nbsp;thread.&nbsp;&nbsp;So,&nbsp;in&nbsp;general,&nbsp;yes,&nbsp;the&nbsp;potential&nbsp;for&nbsp;problems&lt;br&gt;<br>
exists.&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
If&nbsp;I&nbsp;have&nbsp;a&nbsp;problem:&lt;br&gt;<br>
Can&nbsp;I&nbsp;make&nbsp;a&nbsp;quick&nbsp;fix&nbsp;as&nbsp;follows:&nbsp;&nbsp;Within&nbsp;each&nbsp;thread&nbsp;(&nbsp;started&nbsp;with&nbsp;the&lt;br&gt;<br>
threads.deferToThread&nbsp;function&nbsp;),&nbsp;I&nbsp;do&nbsp;the&nbsp;distributing&nbsp;to&nbsp;the&nbsp;clients&nbsp;by&lt;br&gt;<br>
using&nbsp;the&nbsp;&quot;reactor.callFromThread&quot;&lt;br&gt;<br>
(&nbsp;like&nbsp;reactor.callFromThread(&nbsp;distributeToAllClient&nbsp;,&nbsp;myResult&nbsp;)&nbsp;where&nbsp;the&lt;br&gt;<br>
function&nbsp;distributeToAllClient&nbsp;are&nbsp;using&nbsp;the&nbsp;remoteReference&nbsp;for&nbsp;each&nbsp;client&lt;br&gt;<br>
to&nbsp;send&nbsp;the&nbsp;&quot;myResult&quot;&nbsp;)&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
This&nbsp;may&nbsp;work.&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Or&nbsp;is&nbsp;the&nbsp;only&nbsp;solution,&nbsp;to&nbsp;let&nbsp;the&nbsp;myServerProcessingFunction&nbsp;returns&nbsp;the&lt;br&gt;<br>
&quot;myResult&quot;&nbsp;to&nbsp;be&nbsp;distributed&nbsp;to&nbsp;all&nbsp;connected&nbsp;clients,&nbsp;and&nbsp;do&nbsp;the&lt;br&gt;<br>
distribution&nbsp;in&nbsp;the&nbsp;reactor&nbsp;mainthread???&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
There&nbsp;are&nbsp;always&nbsp;lots&nbsp;of&nbsp;possible&nbsp;solutions.&nbsp;&nbsp;Since&nbsp;you&nbsp;are&nbsp;particularly&lt;br&gt;<br>
interested&nbsp;in&nbsp;performance,&nbsp;it&nbsp;will&nbsp;probably&nbsp;be&nbsp;necessary&nbsp;for&nbsp;you&nbsp;to&nbsp;create&lt;br&gt;<br>
a&nbsp;way&nbsp;to&nbsp;measure&nbsp;how&nbsp;well&nbsp;your&nbsp;application&nbsp;is&nbsp;performing&nbsp;and&nbsp;then&nbsp;repeat&lt;br&gt;<br>
these&nbsp;measurements&nbsp;using&nbsp;different&nbsp;implementation&nbsp;techniques.&nbsp;&nbsp;That&nbsp;is&nbsp;the&lt;br&gt;<br>
only&nbsp;way&nbsp;you&#39;ll&nbsp;know&nbsp;which&nbsp;one&nbsp;is&nbsp;best.&lt;br&gt;<br>
&lt;br&gt;<br>
Jean-Paul&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
