<tt>
Dear&nbsp;twisted-python,&lt;br&gt; &lt;br&gt;I’m&nbsp;trying&nbsp;to&nbsp;integrate&nbsp;a&nbsp;python&nbsp;REPL&nbsp;into&nbsp;my&nbsp;existing&nbsp;twisted&nbsp;8.2.0&nbsp;client-side&nbsp;program&nbsp;(which&nbsp;talks&nbsp;to&nbsp;another&nbsp;twisted&nbsp;server&nbsp;running&nbsp;a&nbsp;custom&nbsp;protocol). &nbsp;This&nbsp;client&nbsp;side&nbsp;program&nbsp;uses&nbsp;twisted.internet.stdio.StandardIO&nbsp;already&nbsp;to&nbsp;interact&nbsp;with&nbsp;the&nbsp;user,&nbsp;to&nbsp;read&nbsp;commands&nbsp;from&nbsp;the&nbsp;user&nbsp;and&nbsp;send&nbsp;them&nbsp;to&nbsp;the&nbsp;server. &nbsp;What’s&nbsp;the&nbsp;best&nbsp;way&nbsp;to&nbsp;add&nbsp;functionality&nbsp;to&nbsp;drop&nbsp;into&nbsp;a&nbsp;python&nbsp;REPL? &nbsp;I&nbsp;adapted&nbsp;the&nbsp;doc/core/examples/stdin.py&nbsp;code&nbsp;below&nbsp;to&nbsp;drop&nbsp;into&nbsp;the&nbsp;‘code’&nbsp;stdlib&nbsp;module&nbsp;to&nbsp;try&nbsp;to&nbsp;model&nbsp;for&nbsp;the&nbsp;mailing&nbsp;list&nbsp;what&nbsp;my&nbsp;larger&nbsp;client&nbsp;program&nbsp;is&nbsp;trying&nbsp;to&nbsp;do. &nbsp;It&nbsp;works&nbsp;fine&nbsp;on&nbsp;linux,&nbsp;until&nbsp;you&nbsp;enter&nbsp;a&nbsp;command&nbsp;which&nbsp;outputs&nbsp;a&nbsp;large&nbsp;amount&nbsp;of&nbsp;data,&nbsp;at&nbsp;which&nbsp;point&nbsp;you&nbsp;get&nbsp;a&nbsp;“Resource&nbsp;temporarily&nbsp;unavailable”&nbsp;as&nbsp;can&nbsp;be&nbsp;seen&nbsp;below. &nbsp;I’m&nbsp;assuming&nbsp;the&nbsp;issue&nbsp;is&nbsp;related&nbsp;to&nbsp;StandardIO&nbsp;taking&nbsp;control&nbsp;of&nbsp;reads/writes&nbsp;to&nbsp;the&nbsp;stdio&nbsp;file&nbsp;descriptors,&nbsp;and&nbsp;not&nbsp;integrating&nbsp;well&nbsp;with&nbsp;python&nbsp;code&nbsp;that&nbsp;writes&nbsp;directly&nbsp;to&nbsp;sys.stderr,&nbsp;but&nbsp;I’m&nbsp;not&nbsp;sure&nbsp;what&nbsp;the&nbsp;right&nbsp;solution&nbsp;is. &nbsp;I&nbsp;don’t&nbsp;mind&nbsp;that&nbsp;the&nbsp;call&nbsp;to&nbsp;‘code.interact()’&nbsp;blocks&nbsp;the&nbsp;reactor&nbsp;for&nbsp;my&nbsp;use&nbsp;case,&nbsp;but&nbsp;I&nbsp;don’t&nbsp;mind&nbsp;if&nbsp;better&nbsp;solutions&nbsp;are&nbsp;available&nbsp;which&nbsp;don’t&nbsp;have&nbsp;that&nbsp;problem,&nbsp;either.&lt;br&gt;<br>
 &lt;br&gt;Modified&nbsp;doc/core/examples/stdin.py:&lt;br&gt;---------------------------------------&lt;br&gt;&amp;quot;&amp;quot;&amp;quot;&lt;br&gt;An&nbsp;example&nbsp;of&nbsp;reading&nbsp;a&nbsp;line&nbsp;at&nbsp;a&nbsp;time&nbsp;from&nbsp;standard&nbsp;input&lt;br&gt;without&nbsp;blocking&nbsp;the&nbsp;reactor.&lt;br&gt;&amp;quot;&amp;quot;&amp;quot;&lt;br&gt;<br>
 &lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;stdio&lt;br&gt;from&nbsp;twisted.protocols&nbsp;import&nbsp;basic&lt;br&gt; &lt;br&gt;class&nbsp;Echo(basic.LineReceiver):&lt;br&gt;   &nbsp;from&nbsp;os&nbsp;import&nbsp;linesep&nbsp;as&nbsp;delimiter&lt;br&gt; &lt;br&gt;   &nbsp;def&nbsp;connectionMade(self):&lt;br&gt;       &nbsp;self.transport.write(&amp;#39;&amp;gt;&nbsp;&amp;#39;)&lt;br&gt;<br>
 &lt;br&gt;   &nbsp;def&nbsp;lineReceived(self,&nbsp;line):&lt;br&gt;       &nbsp;self.sendLine(&amp;#39;Echo:&nbsp;&amp;#39;&nbsp;+&nbsp;line)&lt;br&gt;       &nbsp;self.transport.write(&amp;#39;&amp;gt;&nbsp;&amp;#39;)&lt;br&gt;       &nbsp;import&nbsp;code&lt;br&gt;       &nbsp;code.interact()&lt;br&gt; &lt;br&gt;def&nbsp;main():&lt;br&gt;   &nbsp;stdio.StandardIO(Echo())&lt;br&gt;<br>
   &nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;   &nbsp;reactor.run()&lt;br&gt; &lt;br&gt;if&nbsp;__name__&nbsp;==&nbsp;&amp;#39;__main__&amp;#39;:&lt;br&gt;   &nbsp;main()&lt;br&gt;---------------------------------------&lt;br&gt;A&nbsp;sample&nbsp;run:&lt;br&gt; &lt;br&gt;$&nbsp;./twisted-stdio.py&lt;br&gt;&amp;gt;&nbsp;foo&lt;br&gt;<br>
Python&nbsp;2.6.1&nbsp;(r261:67515,&nbsp;Jun &nbsp;4&nbsp;2009,&nbsp;11:06:31)&lt;br&gt;[GCC&nbsp;4.1.2&nbsp;20071124&nbsp;(Red&nbsp;Hat&nbsp;4.1.2-43)]&nbsp;on&nbsp;linux2&lt;br&gt;Type&nbsp;&amp;quot;help&amp;quot;,&nbsp;&amp;quot;copyright&amp;quot;,&nbsp;&amp;quot;credits&amp;quot;&nbsp;or&nbsp;&amp;quot;license&amp;quot;&nbsp;for&nbsp;more&nbsp;information.&lt;br&gt;(InteractiveConsole)&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;11&nbsp;*&nbsp;&amp;#39;x&amp;#39;&lt;br&gt;&amp;#39;xxxxxxxxxxx&amp;#39;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;11111&nbsp;*&nbsp;&amp;#39;x&amp;#39;&lt;br&gt;&amp;#39;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxTraceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):&lt;br&gt;<br>
 &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/python/log.py&amp;quot;,&nbsp;line&nbsp;84,&nbsp;in&nbsp;callWithLogger&lt;br&gt;   &nbsp;return&nbsp;callWithContext({&amp;quot;system&amp;quot;:&nbsp;lp},&nbsp;func,&nbsp;*args,&nbsp;**kw)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/python/log.py&amp;quot;,&nbsp;line&nbsp;69,&nbsp;in&nbsp;callWithContext&lt;br&gt;<br>
   &nbsp;return&nbsp;context.call({ILogContext:&nbsp;newCtx},&nbsp;func,&nbsp;*args,&nbsp;**kw)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/python/context.py&amp;quot;,&nbsp;line&nbsp;59,&nbsp;in&nbsp;callWithContext&lt;br&gt;   &nbsp;return&nbsp;self.currentContext().callWithContext(ctx,&nbsp;func,&nbsp;*args,&nbsp;**kw)&lt;br&gt;<br>
 &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/python/context.py&amp;quot;,&nbsp;line&nbsp;37,&nbsp;in&nbsp;callWithContext&lt;br&gt;   &nbsp;return&nbsp;func(*args,**kw)&lt;br&gt;---&nbsp;&amp;lt;exception&nbsp;caught&nbsp;here&amp;gt;&nbsp;---&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/internet/selectreactor.py&amp;quot;,&nbsp;line&nbsp;146,&nbsp;in&nbsp;_doReadOrWrite&lt;br&gt;<br>
   &nbsp;why&nbsp;=&nbsp;getattr(selectable,&nbsp;method)()&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/internet/process.py&amp;quot;,&nbsp;line&nbsp;242,&nbsp;in&nbsp;doRead&lt;br&gt;   &nbsp;return&nbsp;fdesc.readFromFD(self.fd,&nbsp;self.dataReceived)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/internet/fdesc.py&amp;quot;,&nbsp;line&nbsp;70,&nbsp;in&nbsp;readFromFD&lt;br&gt;<br>
   &nbsp;callback(output)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/internet/process.py&amp;quot;,&nbsp;line&nbsp;245,&nbsp;in&nbsp;dataReceived&lt;br&gt;   &nbsp;self.proc.childDataReceived(&lt;a&nbsp;href=&quot;http://self.name&quot;&gt;self.name&lt;/a&gt;,&nbsp;data)&lt;br&gt;<br>
 &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/internet/_posixstdio.py&amp;quot;,&nbsp;line&nbsp;73,&nbsp;in&nbsp;childDataReceived&lt;br&gt;   &nbsp;self.protocol.dataReceived(data)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/twisted-8.2.0/lib/python/twisted/protocols/basic.py&amp;quot;,&nbsp;line&nbsp;231,&nbsp;in&nbsp;dataReceived&lt;br&gt;<br>
   &nbsp;why&nbsp;=&nbsp;self.lineReceived(line)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;./twisted-stdio.py&amp;quot;,&nbsp;line&nbsp;27,&nbsp;in&nbsp;lineReceived&lt;br&gt;   &nbsp;code.interact()&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/python-2.6.1/lib/python2.6/code.py&amp;quot;,&nbsp;line&nbsp;306,&nbsp;in&nbsp;interact&lt;br&gt;   &nbsp;console.interact(banner)&lt;br&gt;<br>
 &nbsp;File&nbsp;&amp;quot;/sw/external/python-2.6.1/lib/python2.6/code.py&amp;quot;,&nbsp;line&nbsp;243,&nbsp;in&nbsp;interact&lt;br&gt;   &nbsp;more&nbsp;=&nbsp;self.push(line)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/python-2.6.1/lib/python2.6/code.py&amp;quot;,&nbsp;line&nbsp;265,&nbsp;in&nbsp;push&lt;br&gt;   &nbsp;more&nbsp;=&nbsp;self.runsource(source,&nbsp;self.filename)&lt;br&gt;<br>
 &nbsp;File&nbsp;&amp;quot;/sw/external/python-2.6.1/lib/python2.6/code.py&amp;quot;,&nbsp;line&nbsp;87,&nbsp;in&nbsp;runsource&lt;br&gt;   &nbsp;self.runcode(code)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/python-2.6.1/lib/python2.6/code.py&amp;quot;,&nbsp;line&nbsp;107,&nbsp;in&nbsp;runcode&lt;br&gt;   &nbsp;self.showtraceback()&lt;br&gt;<br>
 &nbsp;File&nbsp;&amp;quot;/sw/external/python-2.6.1/lib/python2.6/code.py&amp;quot;,&nbsp;line&nbsp;162,&nbsp;in&nbsp;showtraceback&lt;br&gt;   &nbsp;map(self.write,&nbsp;list)&lt;br&gt; &nbsp;File&nbsp;&amp;quot;/sw/external/python-2.6.1/lib/python2.6/code.py&amp;quot;,&nbsp;line&nbsp;171,&nbsp;in&nbsp;write&lt;br&gt;   &nbsp;sys.stderr.write(data)&lt;br&gt;<br>
exceptions.IOError:&nbsp;[Errno&nbsp;11]&nbsp;Resource&nbsp;temporarily&nbsp;unavailable&lt;br&gt;&lt;br&gt;My&nbsp;colleague&nbsp;discovered&nbsp;the&nbsp;below&nbsp;workaround&nbsp;which&nbsp;temporarily&nbsp;changes&nbsp;the&nbsp;nonblocking&nbsp;status&nbsp;of&nbsp;sys.stderr&nbsp;(and&nbsp;restores&nbsp;it&nbsp;afterwards),&nbsp;but&nbsp;feels&nbsp;like&nbsp;a&nbsp;hack&nbsp;which&nbsp;violates&nbsp;across&nbsp;abstraction&nbsp;layers&nbsp;and&nbsp;which&nbsp;might&nbsp;not&nbsp;work&nbsp;correctly&nbsp;in&nbsp;future&nbsp;versions&nbsp;of&nbsp;twisted:&lt;br&gt;<br>
 &lt;br&gt;+ &nbsp;import&nbsp;fcntl&lt;br&gt;+ &nbsp;oldval&nbsp;=&nbsp;fcntl.fcntl(sys.stderr.fileno(),&nbsp;fcntl.F_GETFL)&lt;br&gt;+ &nbsp;fcntl.fcntl(sys.stderr.fileno(),&nbsp;fcntl.F_SETFL,&nbsp;oldval&nbsp;&amp;amp;&nbsp;~os.O_NONBLOCK)&lt;br&gt;  &nbsp;code.interact()&lt;br&gt;+ &nbsp;fcntl.fcntl(sys.stderr.fileno(),&nbsp;fcntl.F_SETFL,&nbsp;oldval)&lt;br&gt;<br>
 &lt;br&gt;So,&nbsp;any&nbsp;tips&nbsp;on&nbsp;integrating&nbsp;a&nbsp;REPL&nbsp;into&nbsp;our&nbsp;existing&nbsp;program&nbsp;without&nbsp;resorting&nbsp;to&nbsp;this&nbsp;hack&nbsp;would&nbsp;be&nbsp;appreciated! &nbsp;Thanks.&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Benjamin&lt;br&gt;<br>

</tt>
