<tt>
Hi,&lt;br&gt;&lt;br&gt;&lt;br&gt;I&amp;#39;ve&nbsp;been&nbsp;trying&nbsp;to&nbsp;play&nbsp;with&nbsp;SockJS&nbsp;+&nbsp;Twisted.&nbsp;There&amp;#39;s&nbsp;an&nbsp;implementation&nbsp;here:&nbsp;&lt;a&nbsp;href=&quot;https://github.com/Fugiman/sockjs-twisted&quot;&gt;https://github.com/Fugiman/sockjs-twisted&lt;/a&gt;&lt;br&gt;&lt;br&gt;However,&nbsp;I&amp;#39;m&nbsp;already&nbsp;running&nbsp;a&nbsp;web&nbsp;server,&nbsp;and&nbsp;as&nbsp;the&nbsp;README&nbsp;says&nbsp;sockjs-twisted&nbsp;is&nbsp;*not*&nbsp;intended&nbsp;to&nbsp;be&nbsp;run&nbsp;together&nbsp;with&nbsp;a&nbsp;web&nbsp;server.&nbsp;It&nbsp;doesn&amp;#39;t&nbsp;really&nbsp;use&nbsp;any&nbsp;of&nbsp;the&nbsp;mechanics&nbsp;in&nbsp;twisted.web.&lt;br&gt;<br>
<br>
&lt;br&gt;So,&nbsp;I&nbsp;tried&nbsp;to&nbsp;make&nbsp;it&nbsp;work&nbsp;using&nbsp;Resources&nbsp;anyway:&nbsp;reconstructing&nbsp;the&nbsp;equivalent&nbsp;bytes&nbsp;in&nbsp;render,&nbsp;and&nbsp;replaying&nbsp;them&nbsp;with&nbsp;the&nbsp;SockJSFactory:&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC1&quot;&gt;&lt;span&nbsp;class=&quot;k&quot;&gt;class&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;nc&quot;&gt;SockJSResource&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;Resource&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;):&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC2&quot;&gt;    &lt;span&nbsp;class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC3&quot;&gt;&lt;span&nbsp;class=&quot;sd&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;resource&nbsp;that&nbsp;defers&nbsp;to&nbsp;a&nbsp;SockJS&nbsp;factory.&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC4&quot;&gt;&lt;span&nbsp;class=&quot;sd&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC5&quot;&gt;    &lt;span&nbsp;class=&quot;n&quot;&gt;isLeaf&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC6&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC7&quot;&gt;    &lt;span&nbsp;class=&quot;k&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;):&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC8&quot;&gt;        &lt;span&nbsp;class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;_factory&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;SockJSFactory&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC9&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC10&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC11&quot;&gt;    &lt;span&nbsp;class=&quot;k&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;nf&quot;&gt;render&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;):&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC12&quot;&gt;        &lt;span&nbsp;class=&quot;n&quot;&gt;transport&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;transport&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;transport&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC13&quot;&gt;        &lt;span&nbsp;class=&quot;n&quot;&gt;protocol&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;_factory&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;buildProtocol&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;transport&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;getPeer&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC14&quot;&gt;        &lt;span&nbsp;class=&quot;n&quot;&gt;protocol&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;makeConnection&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;transport&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC15&quot;&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC16&quot;&gt;        &lt;span&nbsp;class=&quot;n&quot;&gt;path&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;s&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span&nbsp;class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;]&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;+&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;postpath&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC17&quot;&gt;        &lt;span&nbsp;class=&quot;n&quot;&gt;lines&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span&nbsp;class=&quot;s&quot;&gt;&amp;quot;{0}&nbsp;{1}&nbsp;HTTP/1.1&amp;quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC18&quot;&gt;        &lt;span&nbsp;class=&quot;k&quot;&gt;for&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;values&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;ow&quot;&gt;in&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;requestHeaders&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;getAllRawHeaders&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;():&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC19&quot;&gt;            &lt;span&nbsp;class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;s&quot;&gt;&amp;quot;{0}:&nbsp;{1}&amp;quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;s&quot;&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;)))&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC20&quot;&gt;        &lt;span&nbsp;class=&quot;n&quot;&gt;lines&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;+=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span&nbsp;class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;()]&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC21&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC22&quot;&gt;        &lt;span&nbsp;class=&quot;n&quot;&gt;data&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;o&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;s&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span&nbsp;class=&quot;s&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC23&quot;&gt;        &lt;span&nbsp;class=&quot;n&quot;&gt;protocol&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;dataReceived&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span&nbsp;class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC24&quot;&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;line&quot;&nbsp;id=&quot;LC25&quot;&gt;        &lt;span&nbsp;class=&quot;k&quot;&gt;return&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span&nbsp;class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;n&quot;&gt;NOT_DONE_YET&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;This&nbsp;only&nbsp;kind&nbsp;of&nbsp;works.&nbsp;There&amp;#39;s&nbsp;an&nbsp;external&nbsp;sockjs&nbsp;test&nbsp;suite&nbsp;(more&nbsp;like&nbsp;an&nbsp;acceptance&nbsp;test&nbsp;suite):&nbsp;&lt;a&nbsp;href=&quot;https://github.com/sockjs/sockjs-protocol&quot;&gt;https://github.com/sockjs/sockjs-protocol&lt;/a&gt;,&nbsp;that&nbsp;has&nbsp;multiple&nbsp;failing&nbsp;tests.&nbsp;If&nbsp;anyone&nbsp;needs&nbsp;help&nbsp;running&nbsp;these,&nbsp;I&amp;#39;ll&nbsp;gladly&nbsp;assist&nbsp;there.&lt;br&gt;<br>
<br>
&lt;br&gt;In&nbsp;an&nbsp;attempt&nbsp;to&nbsp;begin&nbsp;debugging&nbsp;this,&nbsp;I&amp;#39;ve&nbsp;found&nbsp;that&nbsp;basically&nbsp;none&nbsp;of&nbsp;the&nbsp;protocol&nbsp;methods&nbsp;get&nbsp;called&nbsp;on&nbsp;that&nbsp;protocol&nbsp;instance&nbsp;I&nbsp;make&nbsp;on&nbsp;the&nbsp;third&nbsp;line&nbsp;of&nbsp;render.&nbsp;This&nbsp;took&nbsp;me&nbsp;a&nbsp;while&nbsp;to&nbsp;figure&nbsp;out&nbsp;because&nbsp;dataReceived&nbsp;*was*&nbsp;being&nbsp;called&nbsp;--&nbsp;except&nbsp;then&nbsp;I&nbsp;realized&nbsp;I&amp;#39;m&nbsp;calling&nbsp;it&nbsp;myself&nbsp;in&nbsp;that&nbsp;render&nbsp;method&nbsp;:)&lt;br&gt;<br>
<br>
&lt;br&gt;This&nbsp;leads&nbsp;me&nbsp;to&nbsp;believe&nbsp;I&amp;#39;m&nbsp;essentially&nbsp;just&nbsp;screwing&nbsp;up&nbsp;transplanting&nbsp;this&nbsp;transport&nbsp;entirely.&nbsp;Is&nbsp;that&nbsp;the&nbsp;case?&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;cheers&lt;div&gt;lvh&lt;/div&gt;&lt;br&gt;<br>

</tt>
