<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;A&nbsp;couple&nbsp;of&nbsp;days&nbsp;ago&nbsp;I&nbsp;asked&nbsp;on&nbsp;Stack&nbsp;Overflow&nbsp;about&nbsp;returning&nbsp;a&nbsp;deferred&nbsp;from&nbsp;an&nbsp;SNI&nbsp;callback&nbsp;and&nbsp;have&nbsp;pyOpenSSL&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;fire&nbsp;before&nbsp;continuing&nbsp;handling&nbsp;the&nbsp;request.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;to&nbsp;some&nbsp;pointers&nbsp;by&nbsp;Gyph&nbsp;I&#39;ve&nbsp;found&nbsp;a&nbsp;solution&nbsp;(&quot;workaround&quot;)&nbsp;for&nbsp;my&nbsp;problem,&nbsp;involving&nbsp;a&nbsp;fake&nbsp;TLSMemoryBIOProtocol&nbsp;to&nbsp;handle&nbsp;the&nbsp;client&nbsp;hello&nbsp;until&nbsp;the&nbsp;SNI&nbsp;is&nbsp;received,&nbsp;firing&nbsp;the&nbsp;SNI&nbsp;callback,&nbsp;waiting&nbsp;for&nbsp;it&nbsp;to&nbsp;callback&nbsp;and&nbsp;then&nbsp;re-feeding&nbsp;the&nbsp;resulting&nbsp;context&nbsp;to&nbsp;the&nbsp;real&nbsp;TLSMemoryBIOProtocol.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;implementation&nbsp;of&nbsp;this&nbsp;solution&nbsp;is&nbsp;available&nbsp;atÂ &lt;a&nbsp;href=&quot;https://gist.github.com/GaretJax/124c523a62ba48c9eec1&quot;&gt;https://gist.github.com/GaretJax/124c523a62ba48c9eec1&lt;/a&gt;,&nbsp;and&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;contribute&nbsp;it&nbsp;back&nbsp;to&nbsp;Twisted,&nbsp;however,&nbsp;it&nbsp;has&nbsp;no&nbsp;unit&nbsp;tests&nbsp;and&nbsp;needs&nbsp;some&nbsp;design&nbsp;decisions/validation.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;ve&nbsp;opened&nbsp;a&nbsp;ticket&nbsp;to&nbsp;track&nbsp;it&nbsp;at&nbsp;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/trac/ticket/8065&quot;&gt;https://twistedmatrix.com/trac/ticket/8065&lt;/a&gt;.&nbsp;Real-life&nbsp;impediments&nbsp;permitting,&nbsp;I&#39;m&nbsp;willing&nbsp;to&nbsp;work&nbsp;on&nbsp;it&nbsp;and&nbsp;get&nbsp;the&nbsp;feature&nbsp;supported&nbsp;in&nbsp;Twisted&nbsp;core.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyone&nbsp;willing&nbsp;to&nbsp;help&nbsp;me&nbsp;getting&nbsp;a&nbsp;proper&nbsp;patch?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Best,&lt;/div&gt;&lt;div&gt;Jonathan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;P.S.:&nbsp;A&nbsp;big&nbsp;shout-out&nbsp;to&nbsp;Twisted&nbsp;for&nbsp;its&nbsp;excellent&nbsp;TLS&nbsp;support&nbsp;out&nbsp;of&nbsp;the&nbsp;box.&nbsp;We&nbsp;got&nbsp;a&nbsp;straight&nbsp;A&nbsp;rating&nbsp;out&nbsp;of&nbsp;the&nbsp;box&nbsp;on&nbsp;ssl&nbsp;labs!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
