<tt>
&lt;html&gt;&lt;body&gt;On&nbsp;11:35&nbsp;pm,&nbsp;jarrod@vertigrated.com&nbsp;wrote:&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;There&nbsp;is&nbsp;a&nbsp;&quot;backend&quot;&nbsp;C&nbsp;module&nbsp;that&nbsp;our&nbsp;Twisted&nbsp;server&nbsp;front&nbsp;ends,&nbsp;and&nbsp;it&nbsp;is&lt;br&nbsp;/&gt;&amp;gt;highly&nbsp;multi-threaded.&lt;br&nbsp;/&gt;&amp;gt;So&nbsp;the&nbsp;T1000&nbsp;is&nbsp;PERFECT&nbsp;for&nbsp;our&nbsp;application,&nbsp;except&nbsp;that&nbsp;now&nbsp;Twisted&nbsp;is&nbsp;the&lt;br&nbsp;/&gt;&amp;gt;bottleneck.&nbsp;:-(&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;This&nbsp;seems&nbsp;odd&nbsp;to&nbsp;me.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;If&nbsp;all&nbsp;the&nbsp;CPUs&nbsp;are&nbsp;going&nbsp;to&nbsp;be&nbsp;busy&nbsp;doing&nbsp;a&nbsp;multi-threaded&nbsp;back-end's&nbsp;work,&nbsp;and&nbsp;Twisted&nbsp;is&nbsp;just&nbsp;doing&nbsp;the&nbsp;I/O,&nbsp;then&nbsp;it&nbsp;seems&nbsp;the&nbsp;T1000&nbsp;would&nbsp;still&nbsp;be&nbsp;a&nbsp;benefit.&nbsp;&amp;#160;The&nbsp;benchmark&nbsp;you&nbsp;mentioned&nbsp;was&nbsp;completely&nbsp;static;&nbsp;there&nbsp;was&nbsp;no&nbsp;backend&nbsp;library,&nbsp;no&nbsp;multithreaded&nbsp;CPU&nbsp;load.&nbsp;&amp;#160;Is&nbsp;the&nbsp;performance&nbsp;disparity&nbsp;similar&nbsp;when&nbsp;you're&nbsp;running&nbsp;actual&nbsp;workloads?&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Sure,&nbsp;Twisted&nbsp;isn't&nbsp;going&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;dole&nbsp;out&nbsp;as&nbsp;much&nbsp;work&nbsp;as&nbsp;something&nbsp;optimized&nbsp;to&nbsp;balance&nbsp;the&nbsp;I/O&nbsp;management&nbsp;CPU&nbsp;across&nbsp;N+1&nbsp;cores;&nbsp;but&nbsp;if&nbsp;those&nbsp;cores&nbsp;are&nbsp;going&nbsp;to&nbsp;be&nbsp;busy&nbsp;anyway&nbsp;in&nbsp;realistic&nbsp;use,&nbsp;then&nbsp;presumably&nbsp;having&nbsp;Twisted&nbsp;contending&nbsp;for&nbsp;all&nbsp;of&nbsp;them&nbsp;wouldn't&nbsp;be&nbsp;much&nbsp;of&nbsp;a&nbsp;performance&nbsp;boost.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;I&nbsp;actually&nbsp;do&nbsp;have&nbsp;a&nbsp;little&nbsp;experience&nbsp;with&nbsp;Twisted-*like*&nbsp;software&nbsp;on&nbsp;Solaris,&nbsp;although&nbsp;not&nbsp;Twisted&nbsp;itself.&nbsp;&amp;#160;The&nbsp;proprietary&nbsp;system&nbsp;which&nbsp;originally&nbsp;inspired&nbsp;Twisted's&nbsp;networking&nbsp;core&nbsp;was&nbsp;actually&nbsp;designed&nbsp;to&nbsp;run&nbsp;on&nbsp;Solaris,&nbsp;and&nbsp;took&nbsp;Sparc&nbsp;hardware&nbsp;advantages&nbsp;into&nbsp;account.&nbsp;&amp;#160;It&nbsp;still&nbsp;ran&nbsp;all&nbsp;of&nbsp;its&nbsp;I/O&nbsp;in&nbsp;a&nbsp;single&nbsp;thread.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;So&nbsp;we&nbsp;either&nbsp;scrap&nbsp;our&nbsp;Twisted&nbsp;implementation&nbsp;and&nbsp;have&nbsp;to&nbsp;spend&nbsp;extra&nbsp;time&lt;br&nbsp;/&gt;&amp;gt;on&nbsp;another&nbsp;network&nbsp;handling&nbsp;layer,&nbsp;or&nbsp;run&nbsp;5&nbsp;times&nbsp;as&nbsp;many&nbsp;instances&nbsp;of&nbsp;our&lt;br&nbsp;/&gt;&amp;gt;server&nbsp;to&nbsp;service&nbsp;the&nbsp;same&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;clients.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Congratulations.&nbsp;&amp;#160;For&nbsp;years,&nbsp;I've&nbsp;been&nbsp;warning&nbsp;people&nbsp;that&nbsp;Twisted&nbsp;cannot&nbsp;transparently&nbsp;take&nbsp;full&nbsp;advantage&nbsp;of&nbsp;vertical&nbsp;scaling&nbsp;with&nbsp;SMP.&nbsp;&amp;#160;While&nbsp;I've&nbsp;heard&nbsp;a&nbsp;lot&nbsp;of&nbsp;uninformed&nbsp;whinging&nbsp;about&nbsp;how&nbsp;this&nbsp;is&nbsp;a&nbsp;huge&nbsp;problem,&nbsp;you&nbsp;are&nbsp;the&nbsp;first&nbsp;person&nbsp;to&nbsp;report&nbsp;an&nbsp;actual&nbsp;performance&nbsp;problem&nbsp;related&nbsp;to&nbsp;that&nbsp;fact&nbsp;:).&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Running&nbsp;5&nbsp;times&nbsp;as&nbsp;many&nbsp;instances&nbsp;of&nbsp;the&nbsp;server&nbsp;does&nbsp;make&nbsp;sense,&nbsp;and&nbsp;shouldn't&nbsp;have&nbsp;a&nbsp;significant&nbsp;downside.&nbsp;&amp;#160;The&nbsp;parallelism&nbsp;strategy&nbsp;I've&nbsp;used&nbsp;pretty&nbsp;much&nbsp;everywhere&nbsp;is&nbsp;multiprocessing&nbsp;rather&nbsp;than&nbsp;multithreading,&nbsp;and&nbsp;it&nbsp;works&nbsp;well.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;If&nbsp;the&nbsp;issue&nbsp;is&nbsp;that&nbsp;you&nbsp;don't&nbsp;want&nbsp;to&nbsp;have&nbsp;that&nbsp;many&nbsp;different&nbsp;open&nbsp;ports&nbsp;on&nbsp;each&nbsp;machine,&nbsp;would&nbsp;it&nbsp;be&nbsp;possible&nbsp;to&nbsp;have&nbsp;a&nbsp;small&nbsp;front-end&nbsp;server&nbsp;accept()ing&nbsp;and&nbsp;sending&nbsp;sockets&nbsp;to&nbsp;N+1&nbsp;(where&nbsp;N&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;cores)&nbsp;other&nbsp;Twisted&nbsp;processes?&nbsp;&amp;#160;I&nbsp;don't&nbsp;know&nbsp;how&nbsp;this&nbsp;might&nbsp;be&nbsp;accomplished&nbsp;on&nbsp;solaris,&nbsp;but&nbsp;if&nbsp;it's&nbsp;possible,&nbsp;it&nbsp;should&nbsp;be&nbsp;transparent&nbsp;to&nbsp;the&nbsp;clients&nbsp;and&nbsp;let&nbsp;Twisted&nbsp;itself&nbsp;take&nbsp;advantage&nbsp;of&nbsp;the&nbsp;hardware.&nbsp;&amp;#160;It&nbsp;would&nbsp;take&nbsp;some&nbsp;work,&nbsp;but&nbsp;not&nbsp;as&nbsp;much&nbsp;as&nbsp;a&nbsp;rewrite.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Again,&nbsp;it&nbsp;seems&nbsp;weird&nbsp;to&nbsp;me&nbsp;that&nbsp;this&nbsp;is&nbsp;necessary&nbsp;if&nbsp;the&nbsp;back-end&nbsp;library&nbsp;is&nbsp;really&nbsp;utilizing&nbsp;all&nbsp;the&nbsp;CPUs&nbsp;already&nbsp;and&nbsp;you&nbsp;are&nbsp;not&nbsp;I/O&nbsp;bound.&lt;br&nbsp;/&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
