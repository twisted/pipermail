<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#3333FF&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;Hi,&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;I'm&nbsp;running&nbsp;Twisted&nbsp;17.5.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;Python&nbsp;3.5.3&nbsp;and&nbsp;want&nbsp;to&nbsp;create&nbsp;a&nbsp;TLS&nbsp;server&nbsp;with&nbsp;Twisted.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;strictly&nbsp;sticked&nbsp;to&nbsp;the&nbsp;example&nbsp;of&nbsp;echoserv_ssl.py&nbsp;on<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://twistedmatrix.com/documents/current/core/howto/ssl.html&quot;&gt;http://twistedmatrix.com/documents/current/core/howto/ssl.html&lt;/a&gt;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;TLS&nbsp;server&nbsp;is&nbsp;not&nbsp;running&nbsp;properly.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;Despite&nbsp;the&nbsp;server&nbsp;starts<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;correctly,&nbsp;it&nbsp;doesn't&nbsp;offer&nbsp;any&nbsp;cipher&nbsp;suites&nbsp;to&nbsp;the&nbsp;client,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;matter&nbsp;what&nbsp;kind&nbsp;of&nbsp;client&nbsp;is&nbsp;trying&nbsp;to&nbsp;connect.&nbsp;Any&nbsp;time&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client&nbsp;connects,&nbsp;the&nbsp;connection&nbsp;is&nbsp;immediately&nbsp;aborted&nbsp;by<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;with&nbsp;the&nbsp;error&nbsp;message&nbsp;of:&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;&lt;class&nbsp;'OpenSSL.SSL.Error'&gt;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[('SSL&nbsp;routines','tls_post_process_client_hello',no&nbsp;shared<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cipher')]&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;I&nbsp;tried&nbsp;to&nbsp;connect&nbsp;to&nbsp;server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;TLS&nbsp;echo&nbsp;client&nbsp;example&nbsp;of&nbsp;echoclient_ssl.py,&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openssl&nbsp;s_client&nbsp;command&nbsp;and&nbsp;with&nbsp;nmap&nbsp;by&nbsp;using&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--ssl-enum-ciphers&nbsp;script.&nbsp;Each&nbsp;time&nbsp;it&nbsp;failed&nbsp;with&nbsp;the&nbsp;above<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;message.&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;If&nbsp;I&nbsp;do&nbsp;not&nbsp;use&nbsp;the&nbsp;options<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offered&nbsp;by&nbsp;ssl.CertificateOptions()&nbsp;as&nbsp;suggested&nbsp;in&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example,&nbsp;but&nbsp;instead&nbsp;create&nbsp;a&nbsp;ssl.DefaultOpenSSLContextFactory()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;I&nbsp;provide&nbsp;the&nbsp;privateKey&nbsp;and&nbsp;Certificate&nbsp;as<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename-strings,&nbsp;the&nbsp;server&nbsp;works&nbsp;correctly&nbsp;and&nbsp;offers&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intended&nbsp;cipher&nbsp;suites.&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;But&nbsp;I&nbsp;need&nbsp;to&nbsp;create&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SSLContext&nbsp;from&nbsp;a&nbsp;OpenSSL&nbsp;PKey-Object&nbsp;(private&nbsp;Key)&nbsp;and&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OpenSSL&nbsp;Certificate-Object.&nbsp;Therefore&nbsp;I&nbsp;adjusted&nbsp;the&nbsp;server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;of&nbsp;the&nbsp;TLS&nbsp;server&nbsp;example&nbsp;to:&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;certificate&nbsp;=&nbsp;ssl.Certificate(cert_obj)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;privkey&nbsp;=&nbsp;ssl.KeyPair(pkey)   &nbsp;#&nbsp;pkey&nbsp;is&nbsp;the&nbsp;OpenSSL&nbsp;PKey<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prkey_and_cert&nbsp;=&nbsp;ssl.PrivateCertificate.fromCertificateAndKeyPair(certificate,privkey)&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;factory&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol.Factory.forProtocol(Echo)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reactor.listenSSL(7498,factory,prkey_and_cert.options())&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;Again,&nbsp;the&nbsp;server&nbsp;starts,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;provide&nbsp;cipher&nbsp;suites&nbsp;so&nbsp;that&nbsp;no&nbsp;client&nbsp;can<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connect.&nbsp;Same&nbsp;as&nbsp;above!&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;-1&quot;&gt;&lt;font&nbsp;face=&quot;Calibri&quot;&gt;Appreciate&nbsp;any&nbsp;help!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
