
from twisted.web.woven import controller, page


class CIncrement(controller.Controller):
    def handle(self, request):
        self.view.addEventHandler("onclick", self.onClick)
    
    def onClick(self, request, widget):
        current = self.model.getData(request)
        self.model.setData(current + 1)
        self.model.notify({'request': request})


class DHTML(page.LivePage):
    template = """<html>
    <body>
        <div view="Widget" controller="increment" style="border: 1px solid red; margin: 1em; padding: 1em; cursor: pointer">
            <span view="Text" />
        </div>
        <script language="javascript" src="WebConduit2.js" />
        <iframe style="width: 99%; height: 2in" id="woven_inputConduit" src="input_html">
            Sorry, this probably won't work if your browser doesn't support IFrames.
        </iframe>
    </body>
</html>"""

    def wcfactory_increment(self, request, node, model):
        return CIncrement(model)


resource = DHTML(0)
