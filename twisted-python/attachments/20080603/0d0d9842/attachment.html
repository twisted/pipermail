<tt>
Problem&nbsp;solved!&nbsp;I&nbsp;digged&nbsp;through&nbsp;the&nbsp;twisted.internet&nbsp;source&nbsp;codes&nbsp;and&nbsp;found&nbsp;this&nbsp;facility:&lt;br&gt;&lt;br&gt;&nbsp;def&nbsp;setTcpKeepAlive(self,&nbsp;enabled):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.socket.setsockopt(socket.SOL_SOCKET,&nbsp;socket.SO_KEEPALIVE,&nbsp;enabled)&lt;br&gt;<br>
&lt;br&gt;I&nbsp;modifying&nbsp;the&nbsp;simple&nbsp;twisted&nbsp;server:&lt;br&gt;&lt;br&gt;#!/usr/bin/python&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;protocol&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;&lt;br&gt;class&nbsp;EchoProtocol(protocol.Protocol):&lt;br&gt;&lt;div&nbsp;id=&quot;1fr4&quot;&nbsp;class=&quot;ArwC7c&nbsp;ckChnd&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionMade(self):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Client&nbsp;Connected&nbsp;Detected!&quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(255,&nbsp;0,&nbsp;0);&quot;&gt;###&nbsp;enable&nbsp;keepalive&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(255,&nbsp;0,&nbsp;0);&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(255,&nbsp;0,&nbsp;0);&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.setTcpKeepAlive(1)&nbsp;&lt;/span&gt;&lt;br&gt;<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;connectionLost(self,&nbsp;reason):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Client&nbsp;Connection&nbsp;Lost!&quot;&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transport.write(data)&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;factory&nbsp;=&nbsp;protocol.Factory()&lt;br&gt;factory.protocol&nbsp;=&nbsp;EchoProtocol&lt;br&gt;reactor.listenTCP(8000,&nbsp;factory)&lt;br&gt;reactor.run()&lt;/div&gt;&lt;br&gt;Now&nbsp;the&nbsp;server&nbsp;is&nbsp;aware&nbsp;of&nbsp;keepalive&nbsp;timeouts&nbsp;now.&nbsp;Might&nbsp;as&nbsp;well&nbsp;use&nbsp;it&nbsp;in&nbsp;my&nbsp;xmpp&nbsp;server.&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;---&lt;br&gt;Alvin&nbsp;Delagon&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jun&nbsp;3,&nbsp;2008&nbsp;at&nbsp;3:21&nbsp;PM,&nbsp;Alvin&nbsp;Delagon&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:adelagon@gmail.com&quot;&gt;adelagon@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Yes&nbsp;it&nbsp;supposed&nbsp;to&nbsp;be&nbsp;handled&nbsp;by&nbsp;the&nbsp;tcp_keepalive&nbsp;itself&nbsp;(as&nbsp;I&nbsp;assumed).&nbsp;The&nbsp;weird&nbsp;thing&nbsp;was&nbsp;that&nbsp;we&nbsp;had&nbsp;this&nbsp;configuration:&lt;br&gt;&lt;br&gt;Ubuntu&nbsp;Linux&nbsp;Server&nbsp;2.6.15-26&lt;br&gt;tcp_keepalive_time&nbsp;7200&lt;br&gt;tcp_keepalive_probes&nbsp;9&lt;br&gt;tcp_keepalive_intvl&nbsp;75&lt;br&gt;<br>
<br>
&lt;br&gt;I&nbsp;have&nbsp;an&nbsp;XMPP&nbsp;client&nbsp;last&nbsp;sent&nbsp;a&nbsp;packet&nbsp;to&nbsp;the&nbsp;server&nbsp;at&nbsp;May&nbsp;29&nbsp;15:57:25&nbsp;telling&nbsp;that&nbsp;it&nbsp;will&nbsp;enter&nbsp;an&nbsp;idle&nbsp;state.&nbsp;On&nbsp;May&nbsp;30&nbsp;approx&nbsp;08:00:00&nbsp;I&nbsp;shut&nbsp;down&nbsp;my&nbsp;PC&nbsp;which&nbsp;hosts&nbsp;my&nbsp;XMPP&nbsp;client&nbsp;thus&nbsp;causing&nbsp;a&nbsp;half-opened&nbsp;state.&nbsp;The&nbsp;next&nbsp;day&nbsp;(17:41:11)&nbsp;while&nbsp;checking&nbsp;the&nbsp;logs,&nbsp;its&nbsp;still&nbsp;in&nbsp;half-opened&nbsp;state&nbsp;and&nbsp;my&nbsp;server&nbsp;still&nbsp;thinks&nbsp;that&nbsp;I&#39;m&nbsp;online.&nbsp;It&nbsp;seems&nbsp;that&nbsp;tcp_keepalive&nbsp;kernel&nbsp;feature&nbsp;that&#39;s&nbsp;supposed&nbsp;to&nbsp;run&nbsp;every&nbsp;2&nbsp;hours&nbsp;didn&#39;t&nbsp;kick&nbsp;in.&lt;br&gt;<br>
<br>
&lt;br&gt;---&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;Alvin&nbsp;Delagon&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;Wj3C7c&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jun&nbsp;3,&nbsp;2008&nbsp;at&nbsp;2:42&nbsp;PM,&nbsp;Gabriel&nbsp;Rossetti&nbsp;&lt;mailing_lists@evotex.ch&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;<br>
Alvin&nbsp;Delagon&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
I&nbsp;just&nbsp;recently&nbsp;discovered&nbsp;that&nbsp;it&#39;s&nbsp;a&nbsp;TCP&nbsp;half-open&nbsp;socket&nbsp;scenario&nbsp;that&nbsp;can&nbsp;be&nbsp;remedied&nbsp;by&nbsp;monitoring&nbsp;client&nbsp;heartbeats.&nbsp;This&nbsp;is&nbsp;not&nbsp;twisted&nbsp;related&nbsp;issue.&nbsp;Thanks&nbsp;anyway.&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;<br>
Alvin&nbsp;Delagon&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Just&nbsp;a&nbsp;question,&nbsp;could&nbsp;setting&nbsp;the&nbsp;tcp&nbsp;keepalive&nbsp;feature&nbsp;on&nbsp;the&nbsp;server&nbsp;side&nbsp;(not&nbsp;sure&nbsp;if&nbsp;that&nbsp;is&nbsp;possible),&nbsp;would&nbsp;that&nbsp;make&nbsp;the&nbsp;server&nbsp;detect&nbsp;that&nbsp;the&nbsp;connection&nbsp;is&nbsp;dead/half-open?&lt;br&gt;<br>
&lt;br&gt;<br>
Gabriel&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&nbsp;target=&quot;_blank&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;Wj3C7c&quot;&gt;--&nbsp;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.alvinatorsplayground.blogspot.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.alvinatorsplayground.blogspot.com/&lt;/a&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.alvinatorsplayground.blogspot.com/&quot;&gt;http://www.alvinatorsplayground.blogspot.com/&lt;/a&gt;<br>

</tt>
