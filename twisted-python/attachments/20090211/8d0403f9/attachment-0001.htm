<tt>
&lt;div&gt;hello,&nbsp;everyone:&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;I&amp;#39;m&nbsp;new&nbsp;to&nbsp;twisted&nbsp;and&nbsp;ftp&nbsp;protocol.&nbsp;for&nbsp;some&nbsp;purpose,&nbsp;i&nbsp;need&nbsp;a&nbsp;python&nbsp;ftp&nbsp;client&nbsp;to&nbsp;do&nbsp;list,&nbsp;get,&nbsp;put,&nbsp;remove&amp;nbsp;operations&amp;nbsp;upon&nbsp;a&nbsp;FTP&nbsp;server&nbsp;which&nbsp;is&nbsp;implemented&nbsp;with&nbsp;twisted.&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;here&nbsp;is&nbsp;my&nbsp;codes,&nbsp;testing&nbsp;for&amp;nbsp;&amp;#39;get&amp;#39;&nbsp;passed,&nbsp;but&nbsp;&amp;#39;put&amp;#39;&nbsp;failed.&nbsp;i&nbsp;checked&nbsp;the&nbsp;api&nbsp;of&nbsp;storeFile,&nbsp;abd&nbsp;got&nbsp;these:&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;functionHeader&quot;&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&gt;def&nbsp;storeFile(self,&nbsp;path,&nbsp;offset=0):&nbsp;&lt;/font&gt;&lt;/em&gt;&lt;a&nbsp;class=&quot;functionSourceLink&quot;&nbsp;href=&quot;http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.2.0/twisted/protocols/ftp.py#L2389&quot;&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&gt;(source)&nbsp;&lt;/font&gt;&lt;/em&gt;&lt;/a&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;functionHeader&quot;&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&gt;&lt;/font&gt;&lt;/em&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;functionHeader&quot;&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&gt;Store&nbsp;a&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;path.&lt;/font&gt;&lt;/em&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;functionBody&quot;&gt;<br>
&lt;div&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&gt;This&nbsp;method&nbsp;issues&nbsp;the&nbsp;&amp;#39;STOR&amp;#39;&nbsp;FTP&nbsp;command.&nbsp;&lt;/font&gt;&lt;/em&gt;<br>
&lt;table&nbsp;class=&quot;fieldTable&quot;&gt;<br>
&lt;tbody&gt;<br>
&lt;tr&nbsp;class=&quot;fieldStart&quot;&gt;<br>
&lt;td&nbsp;class=&quot;fieldName&quot;&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;Returns&lt;/em&gt;&lt;/font&gt;&lt;/td&gt;<br>
&lt;td&nbsp;colspan=&quot;2&quot;&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;A&nbsp;tuple&nbsp;of&nbsp;two&nbsp;&lt;/em&gt;&lt;/font&gt;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html&quot;&gt;&lt;code&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;Deferred&lt;/em&gt;&lt;/font&gt;&lt;/code&gt;&lt;/a&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;s:&nbsp;&lt;/em&gt;&lt;/font&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html&quot;&gt;&lt;code&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;Deferred&lt;/em&gt;&lt;/font&gt;&lt;/code&gt;&lt;/a&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;&nbsp;&lt;/em&gt;&lt;/font&gt;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IFinishableConsumer.html&quot;&gt;&lt;code&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;IFinishableConsumer&lt;/em&gt;&lt;/font&gt;&lt;/code&gt;&lt;/a&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;.&nbsp;You&nbsp;must&nbsp;call&nbsp;the&nbsp;&lt;code&gt;finish&lt;/code&gt;&nbsp;method&nbsp;on&nbsp;the&nbsp;IFinishableConsumer&nbsp;when&nbsp;the&nbsp;file&nbsp;is&nbsp;completely&nbsp;transferred.&nbsp;&lt;/em&gt;&lt;/font&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html&quot;&gt;&lt;code&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&nbsp;size=&quot;2&quot;&gt;&lt;em&gt;Deferred&lt;/em&gt;&lt;/font&gt;&lt;/code&gt;&lt;/a&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#00cccc&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&nbsp;list&nbsp;of&nbsp;control-connection&nbsp;responses.&lt;/font&gt;&nbsp;&lt;/font&gt;&lt;/em&gt;&lt;/li&gt;<br>
&lt;/li&gt;&lt;/ul&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;div&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;but&nbsp;i&nbsp;don&amp;#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;it,&nbsp;:)&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;sorry&nbsp;for&nbsp;the&nbsp;rubbish&nbsp;codes,&nbsp;but&nbsp;i&nbsp;really&nbsp;need&nbsp;help&nbsp;from&nbsp;you&nbsp;guys,&nbsp;it&amp;#39;s&nbsp;hard&nbsp;to&nbsp;find&nbsp;some&nbsp;useful&nbsp;info&nbsp;from&nbsp;twisted&nbsp;official&nbsp;doc,&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;Any&nbsp;suggestion&amp;nbsp;on&nbsp;how&nbsp;to&amp;nbsp;write&nbsp;a&nbsp;nice&nbsp;ftp&nbsp;client&nbsp;with&nbsp;twisted&nbsp;is&nbsp;welcome.&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;Thanks&nbsp;in&nbsp;advance.&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;IOSCAS&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;______________________________________________________________________________&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;from&nbsp;twisted.protocols.ftp&nbsp;import&nbsp;FTPClient,&nbsp;FTPFileListProtocol&lt;br&gt;from&nbsp;twisted.internet.protocol&nbsp;import&nbsp;Protocol,&nbsp;ClientCreator&lt;br&gt;from&nbsp;twisted.python&nbsp;import&nbsp;usage&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor,&nbsp;defer&lt;/div&gt;<br>
<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;class&nbsp;SaveFile(Protocol):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;save&nbsp;the&nbsp;ftp&nbsp;file&nbsp;to&nbsp;local&nbsp;filesystem&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;output):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.fout&nbsp;=&nbsp;open(output,&nbsp;&amp;#39;w&amp;#39;)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;dataReceived(self,&nbsp;data):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.fout.write(data)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.fout.close()&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;class&nbsp;FTP:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;a&nbsp;simple&nbsp;ftp&nbsp;client&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;host,&nbsp;port):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;init&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.__host&nbsp;=&nbsp;host&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.__port&nbsp;=&nbsp;port&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.__username&nbsp;=&nbsp;&amp;#39;aaa&amp;#39;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.__passwd&nbsp;=&nbsp;&amp;#39;bbb&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.__passive&nbsp;=&amp;nbsp;1&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;__get(self,&nbsp;ftp_client,&nbsp;src,&nbsp;des):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;save_file&nbsp;=&nbsp;SaveFile(des)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;d&nbsp;=&nbsp;ftp_client.retrieveFile(src,&nbsp;save_file)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;d&nbsp;=&nbsp;ftp_client.quit()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;d.addCallback(lambda&nbsp;result:&nbsp;reactor.stop())&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;d&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;def&nbsp;get(self,&nbsp;src,&nbsp;des):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;get&nbsp;src&nbsp;file&nbsp;from&nbsp;ftp&nbsp;server,&nbsp;store&nbsp;it&nbsp;in&nbsp;des&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;creator&nbsp;=&nbsp;ClientCreator(reactor,&nbsp;FTPClient,&nbsp;self.__username,&nbsp;self.__passwd,&nbsp;self.__passive)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;defer&nbsp;=&nbsp;creator.connectTCP(self.__host,&nbsp;self.__port).addCallback(self.__get,&nbsp;src,&nbsp;des)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reactor.run()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;defer.result&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;__put(self,&nbsp;ftp_client,&nbsp;src,&nbsp;des):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;source_file&nbsp;=&nbsp;os.path.basename(src)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;target_dir&nbsp;=&nbsp;os.path.dirname(des)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ftp_client.changeDirectory(target_dir)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;d&nbsp;=&nbsp;ftp_client.storeFile(src)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;d&nbsp;=&nbsp;ftp_client.quit()&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;d.addCallback(lambda&nbsp;result:&nbsp;reactor.stop())&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;d&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;def&nbsp;put(self,&nbsp;src,&nbsp;des):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;put&nbsp;src&nbsp;file&nbsp;to&nbsp;ftp&nbsp;server,&nbsp;store&nbsp;it&nbsp;in&nbsp;des&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;#39;&amp;#39;&amp;#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;creator&nbsp;=&nbsp;ClientCreator(reactor,&nbsp;FTPClient,&nbsp;self.__username,&nbsp;self.__passwd,&nbsp;self.__passive)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;defer&nbsp;=&nbsp;creator.connectTCP(self.__host,&nbsp;self.__port).addCallback(self.__put,&nbsp;src,&nbsp;des)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reactor.run()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;defer.result&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>

</tt>
