<tt>
&lt;html&gt;&lt;body&gt;On&nbsp;05:36&nbsp;pm,&nbsp;antoine.pitrou@wengo.com&nbsp;wrote:&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;More&nbsp;serious&nbsp;than&nbsp;the&nbsp;process-running&nbsp;issue,&nbsp;from&nbsp;my&nbsp;point&nbsp;of&nbsp;view,&nbsp;is&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;the&nbsp;fact&nbsp;that&nbsp;if&nbsp;you&nbsp;forget&nbsp;the&nbsp;&quot;@deferred&quot;&nbsp;decorator&nbsp;on&nbsp;a&nbsp;test&nbsp;that&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;uses&nbsp;any&nbsp;reactor&nbsp;API,&nbsp;or&nbsp;code&nbsp;that&nbsp;internally&nbsp;_uses_&nbsp;any&nbsp;reactor&nbsp;API,&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;you&nbsp;will&nbsp;put&nbsp;your&nbsp;tests&nbsp;into&nbsp;a&nbsp;non-deterministic&nbsp;state,&nbsp;and&nbsp;although&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;they'll&nbsp;pass&nbsp;_most_&nbsp;of&nbsp;the&nbsp;time,&nbsp;they&nbsp;will&nbsp;die&nbsp;depending&nbsp;on&nbsp;the&nbsp;load&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;characteristics&nbsp;of&nbsp;your&nbsp;machine&nbsp;at&nbsp;the&nbsp;time&nbsp;and&nbsp;(insert&nbsp;long-winded&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;rant&nbsp;about&nbsp;the&nbsp;evil&nbsp;things&nbsp;threads&nbsp;do&nbsp;to&nbsp;your&nbsp;code&nbsp;here).&nbsp;&amp;#160;Tests&nbsp;are&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;exactly&nbsp;the&nbsp;place&nbsp;you&nbsp;never&nbsp;want&nbsp;this&nbsp;to&nbsp;happen&nbsp;:).&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;That's&nbsp;certainly&nbsp;right,&nbsp;although&nbsp;you&nbsp;should&nbsp;get&nbsp;messages&nbsp;about&nbsp;uncaught&lt;br&nbsp;/&gt;&amp;gt;exceptions&nbsp;or&nbsp;unhandled&nbsp;errbacks,&nbsp;so&nbsp;you'll&nbsp;know&nbsp;that&nbsp;something&nbsp;went&lt;br&nbsp;/&gt;&amp;gt;wrong.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;That's&nbsp;not&nbsp;the&nbsp;sort&nbsp;of&nbsp;problem&nbsp;I'm&nbsp;talking&nbsp;about.&nbsp;&amp;#160;Some&nbsp;reactor&nbsp;APIs&nbsp;will&nbsp;appear&nbsp;to&nbsp;work&nbsp;when&nbsp;called&nbsp;from&nbsp;the&nbsp;wrong&nbsp;thread,&nbsp;so&nbsp;if&nbsp;you&nbsp;forget&nbsp;a&nbsp;@deferred&nbsp;somewhere,&nbsp;your&nbsp;test&nbsp;might&nbsp;seem&nbsp;to&nbsp;work,&nbsp;or&nbsp;hang&nbsp;in&nbsp;a&nbsp;weird&nbsp;place,&nbsp;or&nbsp;produce&nbsp;different&nbsp;error&nbsp;output&nbsp;each&nbsp;time.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;What&nbsp;happens&nbsp;with&nbsp;Trial&nbsp;when&nbsp;you&nbsp;forget&nbsp;to&nbsp;return&nbsp;the&nbsp;Deferred&nbsp;the&nbsp;test&lt;br&nbsp;/&gt;&amp;gt;should&nbsp;wait&nbsp;on?&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Trial&nbsp;doesn't&nbsp;require&nbsp;tests&nbsp;to&nbsp;return&nbsp;Deferreds.&nbsp;&amp;#160;If&nbsp;there&nbsp;is&nbsp;no&nbsp;Deferred,&nbsp;the&nbsp;test&nbsp;completes&nbsp;immediately.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;All&nbsp;in&nbsp;all&nbsp;it&nbsp;seems&nbsp;like&nbsp;it&nbsp;would&nbsp;be&nbsp;simpler&nbsp;to&nbsp;just&nbsp;use&nbsp;trials'&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;TestCase&nbsp;class&nbsp;with&nbsp;nose.&nbsp;&amp;#160;Is&nbsp;there&nbsp;any&nbsp;reason&nbsp;not&nbsp;to?&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;Given&nbsp;that&nbsp;Trial&nbsp;is&nbsp;a&nbsp;self-contained&nbsp;tool,&nbsp;and&nbsp;given&nbsp;that&nbsp;nose&nbsp;also&nbsp;has&lt;br&nbsp;/&gt;&amp;gt;its&nbsp;own&nbsp;test&nbsp;running&nbsp;and&nbsp;collecting,&nbsp;I&nbsp;simply&nbsp;didn't&nbsp;expect&nbsp;this&nbsp;to&nbsp;work&lt;br&nbsp;/&gt;&amp;gt;or&nbsp;to&nbsp;keep&nbsp;working&nbsp;accross&nbsp;versions&nbsp;of&nbsp;both&nbsp;tools.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;This&nbsp;is&nbsp;definitely&nbsp;a&nbsp;concern,&nbsp;but&nbsp;your&nbsp;current&nbsp;approach&nbsp;doesn't&nbsp;seem&nbsp;any&nbsp;less&nbsp;fragile.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;Trial&nbsp;doesn't&nbsp;force&nbsp;your&nbsp;code&nbsp;to&nbsp;make&nbsp;use&nbsp;of&nbsp;Twisted,&nbsp;and&nbsp;as&nbsp;Mr.&nbsp;Lange&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;has&nbsp;declared&nbsp;previously,&nbsp;it&nbsp;goes&nbsp;to&nbsp;some&nbsp;lengths&nbsp;to&nbsp;be&nbsp;compatible&nbsp;with&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&nbsp;stdlib&nbsp;unit&nbsp;tests.&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;Of&nbsp;course,&nbsp;but&nbsp;to&nbsp;use&nbsp;Trial&nbsp;you&nbsp;must&nbsp;install&nbsp;Twisted&nbsp;don't&nbsp;you&nbsp;?&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;Which&nbsp;is&nbsp;quite&nbsp;a&nbsp;big&nbsp;dependency,&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Is&nbsp;2&nbsp;megabytes&nbsp;really&nbsp;too&nbsp;big?&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;and&nbsp;Twisted&nbsp;does&nbsp;not&nbsp;yet&nbsp;support&nbsp;being&nbsp;easy_install'ed.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;...&nbsp;and&nbsp;nose&nbsp;doesn't&nbsp;yet&nbsp;support&nbsp;being&nbsp;apt-get&nbsp;installed&nbsp;;-)&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;If&nbsp;you'd&nbsp;like&nbsp;to&nbsp;see&nbsp;easy_install&nbsp;support&nbsp;for&nbsp;Twisted,&nbsp;please&nbsp;feel&nbsp;free&nbsp;to&nbsp;contribute&nbsp;support&nbsp;for&nbsp;it;&nbsp;the&nbsp;release&nbsp;manager&nbsp;could&nbsp;probably&nbsp;use&nbsp;some&nbsp;help&nbsp;maintaining&nbsp;setup.py&nbsp;in&nbsp;general.&lt;br&nbsp;/&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
