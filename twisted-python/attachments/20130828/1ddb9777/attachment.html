<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;trying&nbsp;to&nbsp;implement&nbsp;graceful&nbsp;shutdown&nbsp;of&nbsp;a&nbsp;HTTP&nbsp;server&nbsp;and&nbsp;I&nbsp;am&nbsp;unsure&nbsp;of&nbsp;the&nbsp;preferred&nbsp;way&nbsp;of&nbsp;implementing&nbsp;it. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;attempting&nbsp;to&nbsp;do&nbsp;this&nbsp;by&nbsp;adding&nbsp;a&nbsp;system&nbsp;event&nbsp;trigger&nbsp;for&nbsp;&quot;before&quot;&nbsp;&quot;shutdown&quot;&nbsp;that&nbsp;should&nbsp;stop&nbsp;accepting&nbsp;new&nbsp;requests&nbsp;and&nbsp;wait&nbsp;for&nbsp;current&nbsp;ones&nbsp;to&nbsp;finish.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;problem&nbsp;is&nbsp;that&nbsp;though&nbsp;my&nbsp;requests&nbsp;has&nbsp;fired&nbsp;their&nbsp;notifyFinish()&nbsp;deferreds&nbsp;the&nbsp;data&nbsp;has&nbsp;not&nbsp;been&nbsp;written&nbsp;to&nbsp;the&nbsp;client.&nbsp;Calling&nbsp;reactor.getWriters()&nbsp;shows&nbsp;me&nbsp;that&nbsp;there&nbsp;are&nbsp;active&nbsp;writers&nbsp;who&nbsp;are&nbsp;probably&nbsp;writing/flushing&nbsp;data&nbsp;to&nbsp;the&nbsp;client.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;is&nbsp;the&nbsp;preferred&nbsp;way&nbsp;of&nbsp;waiting&nbsp;for&nbsp;the&nbsp;requests&nbsp;to&nbsp;finish&nbsp;and&nbsp;finish&nbsp;writing&nbsp;the&nbsp;response&nbsp;to&nbsp;the&nbsp;client?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;example&nbsp;code&nbsp;for&nbsp;my&nbsp;own&nbsp;attempt:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
<br>
&lt;pre&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,&#39;Liberation&nbsp;Mono&#39;,Courier,monospace;font-size:12px;line-height:16px;width:744px;margin-top:0px;margin-bottom:0px;padding:0px;color:rgb(0,0,0)&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC1&quot;&gt;<br>
<br>
&lt;pre&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,&#39;Liberation&nbsp;Mono&#39;,Courier,monospace;width:744px;margin-top:0px;margin-bottom:0px;padding:0px&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC1&quot;&gt;&lt;pre&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,&#39;Liberation&nbsp;Mono&#39;,Courier,monospace;width:744px;margin-top:0px;margin-bottom:0px;padding:0px&quot;&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC1&quot;&gt;&lt;pre&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-family:Consolas,&#39;Liberation&nbsp;Mono&#39;,Courier,monospace;width:744px;margin-top:0px;margin-bottom:0px;padding:0px&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC1&quot;&gt;<br>
<br>
&lt;span&nbsp;class=&quot;&quot;&gt;from&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85)&quot;&gt;twisted.internet&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;import&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;reactor&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;defer&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC2&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;from&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85)&quot;&gt;twisted.application&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;import&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;internet&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;service&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC3&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;from&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85)&quot;&gt;twisted.web.server&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;import&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;Site&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;NOT_DONE_YET&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC4&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;from&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85)&quot;&gt;twisted.web.resource&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;import&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;Resource&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC5&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC6&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;class&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(68,85,136);font-weight:bold&quot;&gt;SlowResource&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;Resource&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;):&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC7&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;isLeaf&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;True&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC8&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;waiting_requests&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;[]&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC9&quot;&gt;<br>
<br>
 &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC10&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;notify_no_more_waiting&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;):&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC11&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;if&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;not&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;waiting_requests&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC12&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;return&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;defer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;succeed&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;None&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC13&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;return&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;defer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;gatherResults&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;waiting_requests&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;consumeErrors&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;True&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&nbsp;\&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC14&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;addBoth&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;lambda&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;ign&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;None&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC15&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC16&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;write_result&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;):&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC17&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;write&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&#39;{}&#39;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC18&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;finish&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC19&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC20&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;render_GET&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;):&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC21&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;reactor&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;callLater&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,153,153)&quot;&gt;5&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;write_result&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC22&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC23&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;d&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;request&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;notifyFinish&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC24&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;waiting_requests&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;append&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC25&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;addBoth&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;lambda&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;ign&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;self&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;waiting_requests&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;remove&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC26&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC27&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;return&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;NOT_DONE_YET&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC28&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC29&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC30&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;slow_resource&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;SlowResource&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC31&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;site&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;Site&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;slow_resource&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC32&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;application&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;service&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;Application&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&quot;MyApp&quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC33&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;server&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;internet&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;TCPServer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,153,153)&quot;&gt;8080&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;site&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC34&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;server&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;setServiceParent&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;application&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC35&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC36&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;wait_for_writers&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;():&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC37&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;d&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;defer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;Deferred&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC38&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC39&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;check_writers&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;():&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC40&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;if&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,134,179)&quot;&gt;len&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;reactor&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;getWriters&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;())&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;&gt;&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,153,153)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC41&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;reactor&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;callLater&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,153,153)&quot;&gt;0.1&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;check_writers&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC42&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;else&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC43&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;d&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;callback&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,153)&quot;&gt;None&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC44&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC45&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;check_writers&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC46&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;return&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;d&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC47&quot;&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC48&quot;&gt;<br>
<br>
&lt;span&nbsp;class=&quot;&quot;&gt;@defer.inlineCallbacks&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC49&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;def&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;graceful_shutdown&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;():&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC50&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;yield&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;server&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;stopService&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC51&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;yield&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;slow_resource&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;notify_no_more_waiting&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC52&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,153,136);font-style:italic&quot;&gt;#yield&nbsp;wait_for_writers()&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC53&quot;&gt;<br>
<br>
 &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;file-graceful-twisted-shutdown-py-LC54&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;reactor&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;addSystemEventTrigger&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&#39;before&#39;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&#39;shutdown&#39;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51)&quot;&gt;graceful_shutdown&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/pre&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Uncommenting&nbsp;the&nbsp;yield&nbsp;in&nbsp;graceful_shutdown&nbsp;gives&nbsp;me&nbsp;my&nbsp;intended&nbsp;behaviour&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;like&nbsp;the&nbsp;solution&nbsp;since&nbsp;I&nbsp;have&nbsp;no&nbsp;idea&nbsp;if&nbsp;the&nbsp;writers&nbsp;there&nbsp;have&nbsp;anything&nbsp;to&nbsp;do&nbsp;with&nbsp;writing&nbsp;the&nbsp;results.&nbsp;They&nbsp;could&nbsp;be&nbsp;any&nbsp;writer&nbsp;writing&nbsp;anything&nbsp;I&nbsp;assume.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Running&nbsp;this&nbsp;code&nbsp;with&nbsp;twistd&nbsp;-ny&nbsp;graceful.tac&nbsp;and&nbsp;curling&nbsp;&lt;a&nbsp;href=&quot;http://localhost:8080&quot;&gt;http://localhost:8080&lt;/a&gt;&nbsp;and&nbsp;then&nbsp;issuing&nbsp;a&nbsp;SIGINT&nbsp;to&nbsp;the&nbsp;twistd&nbsp;process&nbsp;results&nbsp;in&nbsp;an&nbsp;curl:&nbsp;(52)&nbsp;Empty&nbsp;reply&nbsp;from&nbsp;server.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;-- &lt;/div&gt;&lt;div&gt;/Jonas&lt;/div&gt;&lt;/div&gt;<br>

</tt>
