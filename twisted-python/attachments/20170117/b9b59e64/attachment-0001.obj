"""
This is a Twisted Application Configuration (tac) file.  Run with e.g.
   twistd -ny master_player.tac

See the twistd(1) man page or
http://twistedmatrix.com/documents/current/howto/application for details.
"""

from __future__ import print_function

# Standard modules
import sys
##if __name__ == '__main__':
##    print(__doc__)
##    sys.exit(1)

import ConfigParser

# Third-party modules
from twisted.application import service, internet
from twisted.spread import pb
from twisted.internet import reactor

# Application-specific modules
from shared import shared_types
from master_player import MasterPlayer

CONFIG_FILE_NAME = "master.conf"

config = ConfigParser.RawConfigParser()
config.read(CONFIG_FILE_NAME)

application = service.Application("master_player")
internet.TCPServer(config.getint(shared_types.CONFIG_SECTION_GENERAL, shared_types.CONFIG_PARAMETER_SERVER_PORT),
                   pb.PBServerFactory(MasterPlayer(CONFIG_FILE_NAME, reactor)),
                   50, config.get(shared_types.CONFIG_SECTION_GENERAL, shared_types.CONFIG_PARAMETER_SERVER_IP)).setServiceParent(
                       service.IServiceCollection(application))


