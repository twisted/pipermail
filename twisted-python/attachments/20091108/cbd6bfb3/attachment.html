<tt>
Sure,&nbsp;you&nbsp;can&nbsp;find&nbsp;a&nbsp;slightly&nbsp;updated&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;the&nbsp;attachment,&nbsp;licensed&nbsp;under&nbsp;the&nbsp;two&nbsp;clause&nbsp;BSD&nbsp;license&nbsp;and&nbsp;without&nbsp;the&nbsp;syntax&nbsp;error.&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;br&gt;Thank&nbsp;you&nbsp;very&nbsp;much&nbsp;for&nbsp;being&nbsp;willing&nbsp;to&nbsp;share&nbsp;this&nbsp;code&nbsp;under&nbsp;the&nbsp;BSD&nbsp;license. &nbsp;I&nbsp;will&nbsp;try&nbsp;this&nbsp;out&nbsp;and&nbsp;see&nbsp;if&nbsp;it&nbsp;does&nbsp;the&nbsp;job&nbsp;for&nbsp;us.&lt;br&gt;<br>
&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
It&nbsp;would&nbsp;be&nbsp;even&nbsp;better&nbsp;if&nbsp;you&nbsp;could&nbsp;try&nbsp;to&nbsp;integrate&nbsp;the&nbsp;functionality&nbsp;into&nbsp;Twisted&nbsp;itself,&nbsp;if&nbsp;the&nbsp;core&nbsp;developers&nbsp;agree&nbsp;that&nbsp;it&nbsp;would&nbsp;be&nbsp;useful.&nbsp;I&nbsp;opened&nbsp;a&nbsp;ticket&nbsp;for&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/trac/ticket/4073&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/trac/ticket/4073&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yes,&nbsp;it&nbsp;would&nbsp;be&nbsp;nice&nbsp;if&nbsp;this&nbsp;was&nbsp;in&nbsp;twisted&nbsp;itself. &nbsp;I&nbsp;will&nbsp;probably&nbsp;include&nbsp;it&nbsp;in&nbsp;IPython&nbsp;for&nbsp;now&nbsp;and&nbsp;see&nbsp;how&nbsp;it&nbsp;works&nbsp;for&nbsp;us&nbsp;-&nbsp;use&nbsp;that&nbsp;as&nbsp;a&nbsp;medium&nbsp;term&nbsp;test&nbsp;of&nbsp;the&nbsp;approach. &nbsp;I&nbsp;will&nbsp;provide&nbsp;feeback&nbsp;and&nbsp;any&nbsp;changes&nbsp;to&nbsp;the&nbsp;twisted&nbsp;ticket&nbsp;as&nbsp;appropriate.&lt;br&gt;<br>
&lt;br&gt;Thanks&nbsp;again,&lt;br&gt;&lt;br&gt;Brian&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Regards,&lt;br&gt;<br>
Ziga&lt;br&gt;<br>
&lt;br&gt;#&nbsp;Copyright&nbsp;(c)&nbsp;2009&nbsp;Ziga&nbsp;Seilnacht.&nbsp;All&nbsp;rights&nbsp;reserved.&lt;br&gt;<br>
#&lt;br&gt;<br>
#&nbsp;Redistribution&nbsp;and&nbsp;use&nbsp;in&nbsp;source&nbsp;and&nbsp;binary&nbsp;forms,&nbsp;with&nbsp;or&nbsp;without&lt;br&gt;<br>
#&nbsp;modification,&nbsp;are&nbsp;permitted&nbsp;provided&nbsp;that&nbsp;the&nbsp;following&nbsp;conditions&nbsp;are&nbsp;met:&lt;br&gt;<br>
#&lt;br&gt;<br>
#&nbsp;1.&nbsp;Redistributions&nbsp;of&nbsp;source&nbsp;code&nbsp;must&nbsp;retain&nbsp;the&nbsp;above&nbsp;copyright&nbsp;notice,&lt;br&gt;<br>
#&nbsp; &nbsp; this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer.&lt;br&gt;<br>
#&nbsp;2.&nbsp;Redistributions&nbsp;in&nbsp;binary&nbsp;form&nbsp;must&nbsp;reproduce&nbsp;the&nbsp;above&nbsp;copyright&nbsp;notice,&lt;br&gt;<br>
#&nbsp; &nbsp; this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer&nbsp;in&nbsp;the&nbsp;documentation&lt;br&gt;<br>
#&nbsp; &nbsp; and/or&nbsp;other&nbsp;materials&nbsp;provided&nbsp;with&nbsp;the&nbsp;distribution.&lt;br&gt;<br>
#&lt;br&gt;<br>
#&nbsp;THIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;FREEBSD&nbsp;PROJECT&nbsp;&#39;&#39;AS&nbsp;IS&#39;&#39;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS&nbsp;OR&lt;br&gt;<br>
#&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;THE&nbsp;IMPLIED&nbsp;WARRANTIES&nbsp;OF&lt;br&gt;<br>
#&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE&nbsp;ARE&nbsp;DISCLAIMED.&nbsp;IN&nbsp;NO&lt;br&gt;<br>
#&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;FREEBSD&nbsp;PROJECT&nbsp;OR&nbsp;CONTRIBUTORS&nbsp;BE&nbsp;LIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&lt;br&gt;<br>
#&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&lt;br&gt;<br>
#&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF&nbsp;SUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;USE,&lt;br&gt;<br>
#&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR&nbsp;BUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&lt;br&gt;<br>
#&nbsp;LIABILITY,&nbsp;WHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE&lt;br&gt;<br>
#&nbsp;OR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,&nbsp;EVEN&nbsp;IF&lt;br&gt;<br>
#&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGE.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
import&nbsp;os&lt;br&gt;<br>
import&nbsp;sys&lt;br&gt;<br>
import&nbsp;msvcrt&lt;br&gt;<br>
&lt;br&gt;<br>
try:&lt;br&gt;<br>
&nbsp; &nbsp; import&nbsp;win32con&lt;br&gt;<br>
&nbsp; &nbsp; import&nbsp;win32process&lt;br&gt;<br>
&nbsp; &nbsp; import&nbsp;win32security&lt;br&gt;<br>
&nbsp; &nbsp; import&nbsp;win32service&lt;br&gt;<br>
except&nbsp;ImportError:&lt;br&gt;<br>
&nbsp; &nbsp; win32process&nbsp;=&nbsp;None&lt;br&gt;<br>
&lt;br&gt;<br>
from&nbsp;twisted.python&nbsp;import&nbsp;win32&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
def&nbsp;getPythonArgs():&lt;br&gt;<br>
&nbsp; &nbsp; &quot;&quot;&quot;&lt;br&gt;<br>
&nbsp; &nbsp; Return&nbsp;the&nbsp;list&nbsp;of&nbsp;command&nbsp;line&nbsp;args&nbsp;that&nbsp;were&nbsp;used&nbsp;to&nbsp;start&lt;br&gt;<br>
&nbsp; &nbsp; the&nbsp;current&nbsp;Python&nbsp;interpreter&nbsp;and&nbsp;were&nbsp;not&nbsp;stored&nbsp;in&nbsp;C{sys.argv}.&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; These&nbsp;are&nbsp;the&nbsp;options&nbsp;that&nbsp;control&nbsp;the&nbsp;Python&nbsp;interpreter&nbsp;itself,&lt;br&gt;<br>
&nbsp; &nbsp; like&nbsp;the&nbsp;Python&nbsp;executable,&nbsp;optimization&nbsp;level,&nbsp;warning&nbsp;filters,&lt;br&gt;<br>
&nbsp; &nbsp; division&nbsp;behaviour&nbsp;and&nbsp;literal&nbsp;string&nbsp;handling.&lt;br&gt;<br>
&nbsp; &nbsp; &quot;&quot;&quot;&lt;br&gt;<br>
&nbsp; &nbsp; args&nbsp;=&nbsp;[sys.executable]&lt;br&gt;<br>
&nbsp; &nbsp; for&nbsp;warnoption&nbsp;in&nbsp;sys.warnoptions:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; args.append(&quot;-W&quot;)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; args.append(warnoption)&lt;br&gt;<br>
&nbsp; &nbsp; if&nbsp;type(1&nbsp;/&nbsp;2)&nbsp;is&nbsp;not&nbsp;int:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; args.append(&quot;-Qnew&quot;)&lt;br&gt;<br>
&nbsp; &nbsp; if&nbsp;type(&quot;&quot;)&nbsp;is&nbsp;not&nbsp;str:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; args.append(&quot;-U&quot;)&lt;br&gt;<br>
&nbsp; &nbsp; if&nbsp;not&nbsp;__debug__:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; if&nbsp;getPythonArgs.__doc__&nbsp;is&nbsp;None:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; args.append(&quot;-OO&quot;)&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; else:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; args.append(&quot;-O&quot;)&lt;br&gt;<br>
&nbsp; &nbsp; return&nbsp;args&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
def&nbsp;daemonize():&lt;br&gt;<br>
&nbsp; &nbsp; args&nbsp;=&nbsp;[os.path.abspath(__file__)]&nbsp;+&nbsp;sys.argv&lt;br&gt;<br>
&nbsp; &nbsp; executable&nbsp;=&nbsp;sys.executable&lt;br&gt;<br>
&nbsp; &nbsp; cmdline&nbsp;=&nbsp;win32.quoteArguments(getPythonArgs()&nbsp;+&nbsp;args)&lt;br&gt;<br>
&nbsp; &nbsp; inherit&nbsp;=&nbsp;False&lt;br&gt;<br>
&nbsp; &nbsp; priority&nbsp;=&nbsp;win32process.GetPriorityClass(win32process.GetCurrentProcess())&lt;br&gt;<br>
&nbsp; &nbsp; flags&nbsp;=&nbsp;(win32process.CREATE_BREAKAWAY_FROM_JOB&nbsp;|&nbsp;#&nbsp;session&nbsp;leader&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;win32process.CREATE_NEW_PROCESS_GROUP&nbsp;|&nbsp; #&nbsp;group&nbsp;leader&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;win32process.DETACHED_PROCESS&nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;no&nbsp;controlling&nbsp;terminal&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;priority)&lt;br&gt;<br>
&nbsp; &nbsp; info&nbsp;=&nbsp;win32process.STARTUPINFO()&lt;br&gt;<br>
&nbsp; &nbsp; win32process.CreateProcess(executable,&nbsp;cmdline,&nbsp;None,&nbsp;None,&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;inherit,&nbsp;flags,&nbsp;None,&nbsp;None,&nbsp;info)&lt;br&gt;<br>
&nbsp; &nbsp; #&nbsp;Do&nbsp;what&nbsp;exec*&nbsp;functions&nbsp;do,&nbsp;let&nbsp;the&nbsp;OS&nbsp;do&nbsp;the&nbsp;cleanup.&lt;br&gt;<br>
&nbsp; &nbsp; os._exit(0)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
def&nbsp;daemonize2():&lt;br&gt;<br>
&nbsp; &nbsp; args&nbsp;=&nbsp;[sys.argv[1],&nbsp;&quot;--nodaemon&quot;]&nbsp;+&nbsp;sys.argv[2:]&lt;br&gt;<br>
&nbsp; &nbsp; executable&nbsp;=&nbsp;sys.executable&lt;br&gt;<br>
&nbsp; &nbsp; cmdline&nbsp;=&nbsp;win32.quoteArguments(getPythonArgs()&nbsp;+&nbsp;args)&lt;br&gt;<br>
&nbsp; &nbsp; inherit&nbsp;=&nbsp;True&lt;br&gt;<br>
&nbsp; &nbsp; priority&nbsp;=&nbsp;win32process.GetPriorityClass(win32process.GetCurrentProcess())&lt;br&gt;<br>
&nbsp; &nbsp; flags&nbsp;=&nbsp;(win32process.CREATE_NO_WINDOW&nbsp;|&nbsp;#&nbsp;create&nbsp;an&nbsp;invisible&nbsp;console&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;win32process.CREATE_NEW_PROCESS_GROUP&nbsp;|&nbsp;#&nbsp;group&nbsp;leader&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;priority)&lt;br&gt;<br>
&nbsp; &nbsp; attributes&nbsp;=&nbsp;win32security.SECURITY_ATTRIBUTES()&lt;br&gt;<br>
&nbsp; &nbsp; attributes.bInheritHandle&nbsp;=&nbsp;True&lt;br&gt;<br>
&nbsp; &nbsp; station&nbsp;=&nbsp;win32service.CreateWindowStation(None,&nbsp;0,&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;win32con.GENERIC_READ&nbsp;|&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;win32con.GENERIC_WRITE,&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;attributes)&lt;br&gt;<br>
&nbsp; &nbsp; station.SetProcessWindowStation()&lt;br&gt;<br>
&nbsp; &nbsp; sname&nbsp;=&nbsp;win32service.GetUserObjectInformation(station,&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; win32service.UOI_NAME)&lt;br&gt;<br>
&nbsp; &nbsp; dname&nbsp;=&nbsp;str(os.getpid())&lt;br&gt;<br>
&nbsp; &nbsp; desktop&nbsp;=&nbsp;win32service.CreateDesktop(dname,&nbsp;0,&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;win32con.GENERIC_READ&nbsp;|&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;win32con.GENERIC_WRITE,&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;attributes)&lt;br&gt;<br>
&nbsp; &nbsp; desktop.SetThreadDesktop()&lt;br&gt;<br>
&nbsp; &nbsp; null&nbsp;=&nbsp;os.open(&quot;NUL&quot;,&nbsp;os.O_RDWR)&lt;br&gt;<br>
&nbsp; &nbsp; handle&nbsp;=&nbsp;msvcrt.get_osfhandle(null)&lt;br&gt;<br>
&nbsp; &nbsp; info&nbsp;=&nbsp;win32process.STARTUPINFO()&lt;br&gt;<br>
&nbsp; &nbsp; info.lpDesktop&nbsp;=&nbsp;&quot;%s\\%s&quot;&nbsp;%&nbsp;(sname,&nbsp;dname)&lt;br&gt;<br>
&nbsp; &nbsp; info.dwFlags&nbsp;=&nbsp;win32process.STARTF_USESTDHANDLES&lt;br&gt;<br>
&nbsp; &nbsp; info.hStdInput&nbsp;=&nbsp;info.hStdOutput&nbsp;=&nbsp;info.hStdError&nbsp;=&nbsp;handle&lt;br&gt;<br>
&nbsp; &nbsp; win32process.CreateProcess(executable,&nbsp;cmdline,&nbsp;None,&nbsp;None,&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;inherit,&nbsp;flags,&nbsp;None,&nbsp;None,&nbsp;info)&lt;br&gt;<br>
&nbsp; &nbsp; #&nbsp;Same&nbsp;as&nbsp;above,&nbsp;exit&nbsp;as&nbsp;fast&nbsp;as&nbsp;posible.&lt;br&gt;<br>
&nbsp; &nbsp; os._exit(0)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:&lt;br&gt;<br>
&nbsp; &nbsp; daemonize2()&lt;br&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Twisted-Python&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-Python@twistedmatrix.com&quot;&gt;Twisted-Python@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
