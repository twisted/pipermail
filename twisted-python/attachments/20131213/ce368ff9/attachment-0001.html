<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=us-ascii&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Dec&nbsp;13,&nbsp;2013,&nbsp;at&nbsp;7:09&nbsp;AM,&nbsp;Tobias&nbsp;Oberstein&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:tobias.oberstein@tavendo.de&quot;&gt;tobias.oberstein@tavendo.de&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I&nbsp;am&nbsp;working&nbsp;on&nbsp;Twisted&nbsp;Endpoint&nbsp;support&nbsp;in&nbsp;Autobahn&lt;br&gt;&lt;/blockquote&gt;&lt;a&nbsp;href=&quot;https://github.com/tavendo/AutobahnPython&quot;&gt;https://github.com/tavendo/AutobahnPython&lt;/a&gt;.&lt;br&gt;&lt;br&gt;Yay!&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Endpoints&nbsp;are&nbsp;cool.&lt;br&gt;&lt;br&gt;FWIW,&nbsp;here&nbsp;is&nbsp;a&nbsp;working&nbsp;example&nbsp;of&nbsp;WebSocket&nbsp;I&nbsp;tested&nbsp;over&nbsp;both&nbsp;Unix&nbsp;domain&nbsp;sockets&nbsp;and&nbsp;the&nbsp;usual&nbsp;TCP/TLS&nbsp;endpoints:&lt;br&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_endpoints&quot;&gt;https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_endpoints&lt;/a&gt;&lt;br&gt;&lt;br&gt;This&nbsp;works&nbsp;with&nbsp;all&nbsp;features&nbsp;Autobahn&nbsp;provides&nbsp;like&nbsp;support&nbsp;for&nbsp;different&nbsp;WebSocket&nbsp;versions&nbsp;(Hixie-76,&nbsp;RFC6455)&nbsp;and&lt;br&gt;WebSocket&nbsp;extensions&nbsp;(like&nbsp;permessage-compression&nbsp;with&nbsp;deflate,&nbsp;snappy,&nbsp;bzip2).&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cool!&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Sure.&nbsp;Can&nbsp;I&nbsp;use:&lt;br&gt;&lt;br&gt;&quot;autobahn.websocket&quot;?&lt;br&gt;&lt;br&gt;Since&nbsp;Autobahn&nbsp;also&nbsp;provides&nbsp;other&nbsp;protocols&nbsp;(WAMP),&nbsp;and&nbsp;..&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sure.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;endpoint&nbsp;=&nbsp;serverFromString(reactor,&quot;autobahn.websocket:&nbsp;tcp:80:url=&lt;a&nbsp;href=&quot;ws://myhostname.com/somepath&quot;&gt;ws://myhostname.com/somepath&lt;/a&gt;&quot;)&lt;br&gt;&lt;br&gt;Here,&nbsp;a&nbsp;single&nbsp;endpoint&nbsp;descriptor&nbsp;is&nbsp;specifying&nbsp;parameters&nbsp;for&nbsp;both&nbsp;WebSocket,&nbsp;and&nbsp;the&nbsp;underlying&nbsp;transport.&lt;br&gt;&lt;br&gt;Underlying&nbsp;transport:&lt;br&gt;tcp:80&lt;br&gt;&lt;br&gt;WebSocket&nbsp;overlay:&lt;br&gt;autobahn.websocket:url=&lt;a&nbsp;href=&quot;ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy&quot;&gt;ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy&lt;/a&gt;&lt;br&gt;&lt;br&gt;So&nbsp;the&nbsp;plugin&nbsp;needs&nbsp;to&nbsp;parse&nbsp;not&nbsp;only&nbsp;the&nbsp;&quot;overlay&nbsp;transport&quot;&nbsp;spec,&nbsp;but&nbsp;also&nbsp;the&nbsp;underlying&nbsp;spec&nbsp;(&quot;tcp:80&quot;)&nbsp;and&nbsp;all&nbsp;variants&nbsp;thereof?&lt;br&gt;&lt;br&gt;Or&nbsp;can&nbsp;I&nbsp;let&nbsp;the&nbsp;existing&nbsp;Twisted&nbsp;machinery&nbsp;do&nbsp;the&nbsp;parsing&nbsp;of&nbsp;the&nbsp;underlying,&nbsp;and&nbsp;only&nbsp;parse&nbsp;off&nbsp;the&nbsp;remaining&lt;br&gt;stuff&nbsp;(&quot;url=&lt;a&nbsp;href=&quot;ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy&quot;&gt;ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy&lt;/a&gt;&quot;&nbsp;in&nbsp;this&nbsp;case)&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There's&nbsp;some&nbsp;discussion&nbsp;of&nbsp;this&nbsp;here:&nbsp;&lt;&lt;a&nbsp;href=&quot;http://twistedmatrix.com/trac/ticket/5642&quot;&gt;http://twistedmatrix.com/trac/ticket/5642&lt;/a&gt;&gt;.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It's&nbsp;probably&nbsp;possible,&nbsp;the&nbsp;rules&nbsp;are&nbsp;reasonably&nbsp;simple.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;And&nbsp;if&nbsp;not,&nbsp;does&nbsp;that&nbsp;mean&nbsp;not&nbsp;only&nbsp;the&nbsp;endpoint&nbsp;main&nbsp;identifier&nbsp;(&quot;tcp&quot;&nbsp;vs&nbsp;&quot;unix&quot;&nbsp;vs&nbsp;&quot;autobahn.websocket&quot;)&nbsp;must&lt;br&gt;be&nbsp;non-overlapping,&nbsp;but&nbsp;also&nbsp;all&nbsp;the&nbsp;individual&nbsp;parameters?&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Nope;&nbsp;the&nbsp;first&nbsp;one&nbsp;has&nbsp;to&nbsp;be&nbsp;non-overlapping,&nbsp;then&nbsp;you&nbsp;just&nbsp;have&nbsp;to&nbsp;decide&nbsp;on&nbsp;a&nbsp;definite&nbsp;place&nbsp;where&nbsp;the&nbsp;&quot;wrapped&quot;&nbsp;endpoint&nbsp;begins.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Like&nbsp;in&nbsp;the&nbsp;case&nbsp;for&nbsp;WebSocket,&nbsp;there&nbsp;is&nbsp;a&nbsp;need&lt;br&gt;for&nbsp;a&nbsp;&quot;url&quot;&nbsp;parameter.&lt;br&gt;&lt;br&gt;These&nbsp;Qs&nbsp;have&nbsp;brought&nbsp;me&nbsp;to&nbsp;..&lt;br&gt;&lt;br&gt;&lt;br&gt;Variant&nbsp;2)&lt;br&gt;&lt;br&gt;endpoint&nbsp;=&nbsp;serverFromString(reactor,&nbsp;&quot;tcp:80&quot;)&lt;br&gt;wrappedEndpoint&nbsp;=&nbsp;serverFromString(reactor,&nbsp;endpoint,&nbsp;&quot;autobahn.websocket:url=&lt;a&nbsp;href=&quot;ws://myhost.com/mypath&quot;&gt;ws://myhost.com/mypath&lt;/a&gt;&quot;)&lt;br&gt;&lt;br&gt;where&nbsp;I&nbsp;would&nbsp;start&nbsp;a&nbsp;program&nbsp;like&lt;br&gt;&lt;br&gt;python&nbsp;myprog.py&nbsp;--transport&nbsp;&quot;tcp:80&quot;&nbsp;--wrappingTransport&nbsp;&quot;autobahn.websocket:url=&lt;a&nbsp;href=&quot;ws://myhost.com/mypath&quot;&gt;ws://myhost.com/mypath&lt;/a&gt;&quot;&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;variant&nbsp;is&nbsp;worse&nbsp;because&nbsp;you&nbsp;can't&nbsp;change&nbsp;the&nbsp;command&nbsp;lines&nbsp;of&nbsp;other&nbsp;twistd&nbsp;plugins,&nbsp;which&nbsp;might&nbsp;be&nbsp;able&nbsp;to&nbsp;use&nbsp;websockets&nbsp;unchanged&nbsp;if&nbsp;you&nbsp;could&nbsp;just&nbsp;get&nbsp;it&nbsp;returned&nbsp;by&nbsp;serverFromString.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Is&nbsp;there&nbsp;such&nbsp;thing&nbsp;as&nbsp;a&nbsp;WrappingEndpoint?&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Not&nbsp;yet,&nbsp;no.&nbsp;&nbsp;Comment&nbsp;on&nbsp;that&nbsp;ticket&nbsp;:).&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;==&lt;br&gt;&lt;br&gt;This&nbsp;is&nbsp;yet&nbsp;another&nbsp;topic/question,&nbsp;but&nbsp;it&nbsp;fits&nbsp;here.&lt;br&gt;&lt;br&gt;Twisted&nbsp;has&nbsp;defined&nbsp;interfaces&nbsp;for&nbsp;both&nbsp;stream&nbsp;(and&nbsp;datagram&nbsp;transports).&lt;br&gt;&lt;br&gt;WebSocket&nbsp;is&nbsp;essentially&nbsp;a&nbsp;bidirectional,&nbsp;reliable,&nbsp;ordered&nbsp;datagram&nbsp;transport&nbsp;(with&nbsp;2&nbsp;payload&nbsp;types:&nbsp;binary&nbsp;and&nbsp;utf8).&lt;br&gt;&lt;br&gt;Is&nbsp;there&nbsp;a&nbsp;Twisted&nbsp;Interface&nbsp;for&nbsp;such&nbsp;transports?&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;No.&nbsp;&nbsp;Websockets&nbsp;are&nbsp;incredibly&nbsp;bizarre;&nbsp;most&nbsp;protocols&nbsp;support&nbsp;either&nbsp;arbitrarily&nbsp;typed&nbsp;data&nbsp;or&nbsp;just&nbsp;bytes/just&nbsp;text.&nbsp;&nbsp;The&nbsp;hybrid&nbsp;weirdness&nbsp;of&nbsp;&quot;binary&quot;&nbsp;(with&nbsp;no&nbsp;additional&nbsp;type&nbsp;information)&nbsp;and&nbsp;&quot;text&quot;&nbsp;is&nbsp;unique.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I&nbsp;am&nbsp;asking,&nbsp;since&nbsp;I&nbsp;am&nbsp;right&nbsp;now&nbsp;also&nbsp;refactoring&nbsp;the&nbsp;code&nbsp;within&nbsp;Autobahn&nbsp;that&nbsp;lays&nbsp;above&nbsp;raw&nbsp;WebSocket&nbsp;..&nbsp;a&nbsp;PubSub+RPC&nbsp;protocol,&nbsp;that&nbsp;essentially&nbsp;only&nbsp;assumes&nbsp;a&nbsp;transport&nbsp;like&nbsp;above.&lt;br&gt;&lt;br&gt;I&nbsp;want&nbsp;to&nbsp;make&nbsp;it&nbsp;independent&nbsp;of&nbsp;WebSocket&nbsp;and&nbsp;only&nbsp;assume&nbsp;a&nbsp;bidirectional,&nbsp;reliable,&nbsp;ordered,&nbsp;datagram&nbsp;transport.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;can&nbsp;do&nbsp;this&nbsp;with&nbsp;length&nbsp;prefixing,&nbsp;but&nbsp;arguably&nbsp;Twisted&nbsp;&lt;i&gt;should&lt;/i&gt;&nbsp;have&nbsp;such&nbsp;an&nbsp;interface&nbsp;that&nbsp;can&nbsp;express&nbsp;this&nbsp;combination&nbsp;of&nbsp;concepts,&nbsp;because&nbsp;I&nbsp;think&nbsp;these&nbsp;are,&nbsp;technically&nbsp;speaking,&nbsp;the&nbsp;semantics&nbsp;of&nbsp;a&nbsp;UNIX&nbsp;datagram&nbsp;endpoint,&nbsp;but&nbsp;the&nbsp;required&nbsp;interface&nbsp;(actually&nbsp;a&nbsp;superclass,&nbsp;bleh)&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;for&nbsp;UDP,&nbsp;implying&nbsp;unreliability.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-glyph&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
