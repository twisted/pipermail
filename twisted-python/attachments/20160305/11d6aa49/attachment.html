<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;On&nbsp;3/2/16&nbsp;9:32&nbsp;AM,&nbsp;snailcoder&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cite=&quot;mid:56d6fa13.45cfca0a.84bbe.62e7SMTPIN_ADDED_BROKEN@mx.google.com&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;style=&quot;font-family:&nbsp;微软雅黑;&nbsp;font-size:&nbsp;10.5pt;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spellcheck=&quot;false&quot;&gt;I'm&nbsp;trying&nbsp;to&nbsp;implement&nbsp;some&nbsp;login<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logic using&nbsp;twisted.cred&nbsp;module for&nbsp;a&nbsp;website.&nbsp;In&nbsp;short,&nbsp;there's<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;login&nbsp;page&nbsp;with&nbsp;username/password&nbsp;forms.&nbsp;Once&nbsp;the&nbsp;user&nbsp;input<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;right&nbsp;username/password,&nbsp;the&nbsp;browser&nbsp;will&nbsp;redirect&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;another&nbsp;page&nbsp;which&nbsp;includes&nbsp;the&nbsp;user's&nbsp;profile. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;Does&nbsp;anyone&nbsp;have&nbsp;any&nbsp;ideas&nbsp;about&nbsp;how&nbsp;to&nbsp;implement&nbsp;this<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logic&nbsp;with&nbsp;twisted.cred&nbsp;checkers,&nbsp;credentials&nbsp;and&nbsp;portal?&nbsp;Any<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suggestion&nbsp;is&nbsp;appreciated&nbsp;:-)&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Before&nbsp;I&nbsp;answer&nbsp;your&nbsp;question,&nbsp;allow&nbsp;me&nbsp;to&nbsp;give&nbsp;you&nbsp;a&nbsp;word&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;advice.&nbsp;Twisted&nbsp;is&nbsp;a&nbsp;low-level&nbsp;library.&nbsp;While&nbsp;you&nbsp;can&nbsp;build&nbsp;a&nbsp;web<br>
&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;directly&nbsp;on&nbsp;top&nbsp;of&nbsp;Twisted,&nbsp;I&nbsp;would&nbsp;not&nbsp;recommend&nbsp;it.<br>
&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;need&nbsp;higher-level&nbsp;abstractions&nbsp;to&nbsp;write&nbsp;manageable&nbsp;code.&nbsp;I<br>
&nbsp;&nbsp;&nbsp;&nbsp;recommend&nbsp;that&nbsp;you&nbsp;find&nbsp;a&nbsp;framework&nbsp;that&nbsp;builds&nbsp;on&nbsp;top&nbsp;of&nbsp;Twisted.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;for&nbsp;your&nbsp;question,&nbsp;you&nbsp;will&nbsp;find&nbsp;many&nbsp;examples&nbsp;of&nbsp;Twisted<br>
&nbsp;&nbsp;&nbsp;&nbsp;authentication&nbsp;if&nbsp;you&nbsp;Google&nbsp;a&nbsp;bit.&nbsp;You&nbsp;should&nbsp;probably&nbsp;start&nbsp;by<br>
&nbsp;&nbsp;&nbsp;&nbsp;reading&nbsp;this&nbsp;page:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://twistedmatrix.com/documents/current/core/howto/cred.html&quot;&gt;https://twistedmatrix.com/documents/current/core/howto/cred.html&lt;/a&gt;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Below&nbsp;you&nbsp;will&nbsp;find&nbsp;a&nbsp;simple&nbsp;(and&nbsp;not&nbsp;very&nbsp;secure)&nbsp;example.&nbsp;It&nbsp;uses<br>
&nbsp;&nbsp;&nbsp;&nbsp;HTTP&nbsp;Basic&nbsp;authentication.&nbsp;It&nbsp;owes&nbsp;its&nbsp;verbosity&nbsp;to&nbsp;the&nbsp;low-level<br>
&nbsp;&nbsp;&nbsp;&nbsp;nature&nbsp;of&nbsp;Twisted.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;from&nbsp;twisted.cred&nbsp;import&nbsp;portal,&nbsp;checkers,&nbsp;credentials,&nbsp;error&nbsp;as<br>
&nbsp;&nbsp;&nbsp;&nbsp;credError&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;defer,&nbsp;reactor&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;from&nbsp;twisted.web&nbsp;import&nbsp;guard,&nbsp;http,&nbsp;resource,&nbsp;server&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;from&nbsp;zope.interface&nbsp;import&nbsp;implements&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;class&nbsp;HttpPasswordRealm(object):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;implements(portal.IRealm)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;def&nbsp;__init__(self,&nbsp;resource):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;           &nbsp;self.resource&nbsp;=&nbsp;resource&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;def&nbsp;requestAvatar(self,&nbsp;avatarId,&nbsp;mind,&nbsp;*interfaces):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;           &nbsp;if&nbsp;resource.IResource&nbsp;in&nbsp;interfaces:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;               &nbsp;return&nbsp;(resource.IResource,&nbsp;self.resource,&nbsp;lambda:<br>
&nbsp;&nbsp;&nbsp;&nbsp;None)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;           &nbsp;raise&nbsp;NotImplementedError()&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;class&nbsp;MyPasswordChecker(object):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;implements(checkers.ICredentialsChecker)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;credentialInterfaces&nbsp;=&nbsp;(credentials.IUsernamePassword,&nbsp;)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;MY_INSECURE_CREDS&nbsp;=&nbsp;{'name':&nbsp;'pa$$w0rd'}&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;@defer.inlineCallbacks&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;def&nbsp;requestAvatarId(self,&nbsp;creds):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;           &nbsp;pw&nbsp;=&nbsp;self.MY_INSECURE_CREDS.get(creds.username)&nbsp;or&nbsp;b''&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;           &nbsp;pw_match&nbsp;=&nbsp;yield&nbsp;creds.checkPassword(pw)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;           &nbsp;if&nbsp;pw_match&nbsp;is&nbsp;True:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;               &nbsp;defer.returnValue(creds.username)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;           &nbsp;else:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;               &nbsp;raise&nbsp;credError.UnauthorizedLogin('Incorrect<br>
&nbsp;&nbsp;&nbsp;&nbsp;username&nbsp;or&nbsp;password')&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;class&nbsp;MyPortal(resource.Resource):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;isLeaf&nbsp;=&nbsp;True&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;       &nbsp;def&nbsp;render_GET(self,&nbsp;request):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;           &nbsp;return&nbsp;'Top&nbsp;secret&nbsp;content'&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;checker&nbsp;=&nbsp;MyPasswordChecker()&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;realm&nbsp;=&nbsp;HttpPasswordRealm(MyPortal())&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;p&nbsp;=&nbsp;portal.Portal(realm,&nbsp;[checker,&nbsp;])&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;factory&nbsp;=&nbsp;guard.BasicCredentialFactory('My&nbsp;secret&nbsp;portal')&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;protected_resource&nbsp;=&nbsp;guard.HTTPAuthSessionWrapper(p,&nbsp;[factory,<br>
&nbsp;&nbsp;&nbsp;&nbsp;])&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;site&nbsp;=&nbsp;server.Site(protected_resource)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;site.protocol&nbsp;=&nbsp;http.HTTPChannel&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;reactor.listenTCP(8080,&nbsp;site)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;reactor.run()&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Do&nbsp;not&nbsp;go&nbsp;and&nbsp;copy-paste&nbsp;the&nbsp;above.&nbsp;Please&nbsp;do&nbsp;your&nbsp;research.&nbsp;To<br>
&nbsp;&nbsp;&nbsp;&nbsp;build&nbsp;the&nbsp;interaction&nbsp;you&nbsp;described,&nbsp;I&nbsp;will&nbsp;recommend&nbsp;using&nbsp;Klein<br>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://github.com/twisted/klein&quot;&gt;https://github.com/twisted/klein&lt;/a&gt;).&nbsp;Klein&nbsp;can&nbsp;give&nbsp;you&nbsp;your&nbsp;entire<br>
&nbsp;&nbsp;&nbsp;&nbsp;app&nbsp;as&nbsp;a&nbsp;Resource&nbsp;instance.&nbsp;This&nbsp;example&nbsp;does&nbsp;not&nbsp;manage&nbsp;sessions&nbsp;or<br>
&nbsp;&nbsp;&nbsp;&nbsp;lets&nbsp;you&nbsp;log&nbsp;out.&nbsp;It&nbsp;only&nbsp;describes&nbsp;how&nbsp;you&nbsp;can&nbsp;protect&nbsp;a&nbsp;Resource<br>
&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;Twisted.cred.&nbsp;Good&nbsp;luck.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Regards&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Shakkhar&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
