<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] patch for protocols.telnet.Telnet
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20patch%20for%20protocols.telnet.Telnet&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001859.html">
   <LINK REL="Next"  HREF="001856.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] patch for protocols.telnet.Telnet</H1>
    <B>Jeremy Noetzelman</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20patch%20for%20protocols.telnet.Telnet&In-Reply-To="
       TITLE="[Twisted-Python] patch for protocols.telnet.Telnet">jjn at kriln.com
       </A><BR>
    <I>Mon Oct  7 14:41:11 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001859.html">[Twisted-Python] Twisted performance?
</A></li>
        <LI>Next message: <A HREF="001856.html">[Twisted-Python] JSPB on mozdev.org
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1855">[ date ]</a>
              <a href="thread.html#1855">[ thread ]</a>
              <a href="subject.html#1855">[ subject ]</a>
              <a href="author.html#1855">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There's a bug in the telnet protocol, which will only process one 'line'
per call to processChunk().  This is buggy, because if you send a large
amount of data to a connection, such as via copy/paste, it will only
process the first two lines of it, and you're stuck mashing the enter key
to get it to process the rest.

Patch makes it process all lines instead of just one.

Index: telnet.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/telnet.py,v
retrieving revision 1.16
diff -u -r1.16 telnet.py
--- telnet.py   15 Jul 2002 23:51:33 -0000      1.16
+++ telnet.py   7 Oct 2002 18:35:02 -0000
@@ -250,12 +250,16 @@
             idx = string.find(self.buffer, delim)
             if idx != -1:
                 break
-
-        if idx != -1:
+        while idx != -1:
             buf, self.buffer = self.buffer[:idx], self.buffer[idx+2:]
             self.processLine(buf)
             if self.mode == 'Done':
                 self.transport.loseConnection()
+
+            for delim in self.delimiters:
+                idx = string.find(self.buffer, delim)
+                if idx != -1:
+                    break

     def dataReceived(self, data):
         chunk = StringIO()




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001859.html">[Twisted-Python] Twisted performance?
</A></li>
	<LI>Next message: <A HREF="001856.html">[Twisted-Python] JSPB on mozdev.org
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1855">[ date ]</a>
              <a href="thread.html#1855">[ thread ]</a>
              <a href="subject.html#1855">[ subject ]</a>
              <a href="author.html#1855">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
