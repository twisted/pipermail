<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twistedchecker now uses pylint &gt;= 2.4.4, can we use type annotations in Twisted now?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twistedchecker%20now%20uses%20pylint%20%3E%3D%202.4.4%2C%0A%20can%20we%20use%20type%20annotations%20in%20Twisted%20now%3F&In-Reply-To=%3CB7036604-8208-491E-BEA0-58E0B6858FD0%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065061.html">
   <LINK REL="Next"  HREF="065066.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twistedchecker now uses pylint &gt;= 2.4.4, can we use type annotations in Twisted now?</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twistedchecker%20now%20uses%20pylint%20%3E%3D%202.4.4%2C%0A%20can%20we%20use%20type%20annotations%20in%20Twisted%20now%3F&In-Reply-To=%3CB7036604-8208-491E-BEA0-58E0B6858FD0%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] twistedchecker now uses pylint &gt;= 2.4.4, can we use type annotations in Twisted now?">glyph at twistedmatrix.com
       </A><BR>
    <I>Thu May  7 18:48:56 MDT 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065061.html">[Twisted-Python] twistedchecker now uses pylint &gt;= 2.4.4, can we use type annotations in Twisted now?
</A></li>
        <LI>Next message (by thread): <A HREF="065066.html">[Twisted-Python] [RFC] Drop support for Python 3.5 sometime after May 2021?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65062">[ date ]</a>
              <a href="thread.html#65062">[ thread ]</a>
              <a href="subject.html#65062">[ subject ]</a>
              <a href="author.html#65062">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On May 7, 2020, at 1:56 PM, Craig Rodrigues &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rodrigc at crodrigues.org</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Wed, Apr 22, 2020 at 12:28 AM Glyph &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A> &lt;mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> On Apr 21, 2020, at 8:57 PM, Craig Rodrigues &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rodrigc at crodrigues.org</A> &lt;mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rodrigc at crodrigues.org</A>&gt;&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Does anyone else have opinions on
</I>&gt;&gt;<i> type hints and mypy?
</I>&gt;<i> 
</I>&gt;<i> We use them at work, and on some other Twisted projects (Klein) and they're absolutely awesome.  Even with type comments, mypy is a huge upgrade to how one writes and maintains Python; with annotations, it's a major upgrade to the language.
</I>&gt;<i> 
</I>&gt;<i> The first step here, however, is to set up the CI infrastructure (tox, etc) to run mypy so that we can ensure that as we start writing type hints, we don't accidentally get any of them wrong and back ourselves into any corners.  Mypy can catch a surprising number of bugs with just the implicit type-checking it does on values that come from the standard library.  In fact, if we do `mypy src/twisted` right now, and exclude the things that would be fixed by adding in <A HREF="https://github.com/Shoobx/mypy-zope">https://github.com/Shoobx/mypy-zope</A> &lt;<A HREF="https://github.com/Shoobx/mypy-zope">https://github.com/Shoobx/mypy-zope</A>&gt; (&quot;method must have at least one argument&quot; zope.interface definition errors) and fixing up some simple type hints (has no attribute &quot;skip&quot;) we still have almost a thousand type errors that we should figure out a way to start correcting or systematically skipping if they're false positives.  I guarantee you there's at least one real bug in there though.
</I>&gt;<i> 
</I>&gt;<i> As you know, I tend to be pretty cautious about sweeping changes to the code that might make it harder to maintain on older versions - type hints are an exception where I think it's absolutely worthwhile to go All In early on.  But CI infrastructure for this stuff is a must-have and it might be tricky to get set up initially.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Earlier this week, I merged to trunk a new tox rule for running mypy with mypy-zope.  You can use it by
</I>&gt;<i> running the following command in the top-level Twisted directory:
</I>&gt;<i> 
</I>&gt;<i> tox -e  mypy
</I>&gt;<i> 
</I>&gt;<i> mypy reports a lot of errors, but I think we can take several passes through the Twisted codebase to clean those up.
</I>&gt;<i> 
</I>&gt;<i> Once we clean up the errors, we can integrate the tox rule with Travis or Azure CI or CircleCI (whatever works best).
</I>&gt;<i> 
</I>&gt;<i> I submitted a few PR's to start cleaning up these errors:
</I>&gt;<i> <A HREF="https://github.com/twisted/twisted/pull/1264">https://github.com/twisted/twisted/pull/1264</A> &lt;<A HREF="https://github.com/twisted/twisted/pull/1264">https://github.com/twisted/twisted/pull/1264</A>&gt;  (has no attribute &quot;skip&quot;)
</I>&gt;<i> <A HREF="https://github.com/twisted/twisted/pull/1261">https://github.com/twisted/twisted/pull/1261</A> &lt;<A HREF="https://github.com/twisted/twisted/pull/1261">https://github.com/twisted/twisted/pull/1261</A>&gt; (Too few arguments to &quot;makeTestCaseClasses&quot;)
</I>
Thank you for doing this work, Craig!  I strongly suspect that mypy is going to spot more than a few real bugs in our codebase, and I can think of at least one enthusiastic user (me) who wants Twisted to start shipping stubs for our users to use!

This also reminded me to file <A HREF="https://twistedmatrix.com/trac/ticket/9816#ticket">https://twistedmatrix.com/trac/ticket/9816#ticket</A> &lt;<A HREF="https://twistedmatrix.com/trac/ticket/9816#ticket">https://twistedmatrix.com/trac/ticket/9816#ticket</A>&gt; because i couldn't find it filed already.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20200507/e4c92b30/attachment.htm&gt;
</PRE>





























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065061.html">[Twisted-Python] twistedchecker now uses pylint &gt;= 2.4.4, can we use type annotations in Twisted now?
</A></li>
	<LI>Next message (by thread): <A HREF="065066.html">[Twisted-Python] [RFC] Drop support for Python 3.5 sometime after May 2021?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65062">[ date ]</a>
              <a href="thread.html#65062">[ thread ]</a>
              <a href="subject.html#65062">[ subject ]</a>
              <a href="author.html#65062">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
