<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to make a custom transport based	on	sendmsg/recvmsg?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20make%20a%20custom%20transport%20based%0A%09on%09sendmsg/recvmsg%3F&In-Reply-To=368574aa0802221335p7bebc061x9547f968b1d44a02%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016846.html">
   <LINK REL="Next"  HREF="016769.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to make a custom transport based	on	sendmsg/recvmsg?</H1>
    <B>Philippe Frycia</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20make%20a%20custom%20transport%20based%0A%09on%09sendmsg/recvmsg%3F&In-Reply-To=368574aa0802221335p7bebc061x9547f968b1d44a02%40mail.gmail.com"
       TITLE="[Twisted-Python] How to make a custom transport based	on	sendmsg/recvmsg?">phil-twisted at tuxeo.org
       </A><BR>
    <I>Fri Feb 22 17:10:35 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="016846.html">[Twisted-Python] How to make a custom transport based on	sendmsg/recvmsg?
</A></li>
        <LI>Next message: <A HREF="016769.html">[Twisted-Python] Re: How to make a secure connection between two	computers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16847">[ date ]</a>
              <a href="thread.html#16847">[ thread ]</a>
              <a href="subject.html#16847">[ subject ]</a>
              <a href="author.html#16847">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Drew Smathers wrote:
&gt;<i> You should not make assumptions about the transport layer in your
</I>&gt;<i> protocol implementation - be it Unix domain sockets, TCP, etc.
</I>&gt;<i>   
</I>In my case, it is not only an assumption: the applications I want to 
interact with do use unix sockets and file descriptor passing.
Maybe my assumption that I need to use a Protocol is wrong, if I need a 
specific transport.

&gt;<i> If you don't see an attribute documented in the interface for
</I>&gt;<i> something (ITransport here for example), and you're referencing it on
</I>&gt;<i> the implementation, then you're most definitely doing something bad.
</I>&gt;<i> The attribute I'm talking about here is &quot;socket.&quot;
</I>&gt;<i>   
</I>OK. So what attribute(s) do I have to replace/override to plug my 
low-level read/write routines in a protocol ?

&gt;<i> It sounds like you're trying to do something relatively low-level
</I>&gt;<i> (interfacing with eunuchs directly) at a high-level using Protocols.
</I>&gt;<i>   
</I>Maybe I don't need to use a Protocol at all. But what else ?
&gt;<i> So to do something that isn't just a hack, you'll need to do a lot
</I>&gt;<i> more work - and it might not be worth the effort.  Can you describe
</I>&gt;<i> first why you need to use sendmsg/recvmsg in your application?
</I>&gt;<i>   
</I>
As I said above, I would like to interact with a set of (existing) 
applications that use unix sockets and TLV-based messages for 
interprocess communication.
They also use file descriptor passing with sendmsg/recvmsg.
In fact, this is the way they find each other: services announce 
themselves to a central broker, and clients ask for services to this 
broker. The broker then creates a socketpair and passes the file 
descriptor of both ends to each party.
They also make use of this file descriptor passing mechanism to use 
specific devices from different processes while keeping their state and 
&quot;ownership&quot;: once one process has made some initialization on a device, 
it can pass the descriptor to another process that can use it further.

The C framework on which these applications are written is completely 
asynchronous and the model seems fine.
I was able to use asyncore with eunuchs to do this low-level stuff as 
prototype, but I really would like to use Twisted instead.

As far as I can see, the low-level doRead and doWrite implementations 
are about the only thing I have to plug in the system to have it working.
In fact my sample code is mostly working, I just want to be sure I do it 
The Right Way, if at all possible.

Please, don't tell me Twisted is not made for something other than byte 
stream based comms... :-)

Thank you for your help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20080222/db13b90e/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20080222/db13b90e/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016846.html">[Twisted-Python] How to make a custom transport based on	sendmsg/recvmsg?
</A></li>
	<LI>Next message: <A HREF="016769.html">[Twisted-Python] Re: How to make a secure connection between two	computers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16847">[ date ]</a>
              <a href="thread.html#16847">[ thread ]</a>
              <a href="subject.html#16847">[ subject ]</a>
              <a href="author.html#16847">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
