<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Help using XmlStreamFactory	&amp;	XmlStream	:	XPathQuery error?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Help%20using%20XmlStreamFactory%0A%09%26%09XmlStream%09%3A%09XPathQuery%20error%3F&In-Reply-To=47BC4518.2090405%40evotex.ch">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016819.html">
   <LINK REL="Next"  HREF="016821.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Help using XmlStreamFactory	&amp;	XmlStream	:	XPathQuery error?</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Help%20using%20XmlStreamFactory%0A%09%26%09XmlStream%09%3A%09XPathQuery%20error%3F&In-Reply-To=47BC4518.2090405%40evotex.ch"
       TITLE="[Twisted-Python] Help using XmlStreamFactory	&amp;	XmlStream	:	XPathQuery error?">exarkun at divmod.com
       </A><BR>
    <I>Wed Feb 20 10:35:54 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="016819.html">[Twisted-Python] Help using	XmlStreamFactory	&amp;	XmlStream	:	XPathQuery error?
</A></li>
        <LI>Next message: <A HREF="016821.html">[Twisted-Python] Help using	XmlStreamFactory	&amp;	XmlStream	:	XPathQuery error?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16820">[ date ]</a>
              <a href="thread.html#16820">[ thread ]</a>
              <a href="subject.html#16820">[ subject ]</a>
              <a href="author.html#16820">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 20 Feb 2008 16:19:52 +0100, Gabriel Rossetti &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mailing_lists at evotex.ch</A>&gt; wrote:
&gt;<i> [snip]
</I>&gt;<i>And if I'm not mistaking, 
</I>&gt;<i>if I have multiple connections, then the events get mixed up (from my own 
</I>&gt;<i>tests anyways), the processing is not atomic. If I have let's say that I 
</I>&gt;<i>have :
</I>&gt;<i>
</I>&gt;<i>client1 : &lt;test&gt;&lt;header  id=&quot;1&quot;/&gt;
</I>&gt;<i>client2 : &lt;test&gt;&lt;header  id=&quot;2&quot;/&gt;&lt;feed name=&quot;myName&quot;&gt;toto&lt;/feed&gt;&lt;/test&gt;
</I>&gt;<i>client2 : &lt;feed name=&quot;myName2&quot;&gt;lala&lt;/feed&gt;&lt;/test&gt;
</I>
I think the 3rd line should be client1?

&gt;<i>
</I>&gt;<i>my stanzas will get processed in that order, thus I can't even recreate the 
</I>&gt;<i>message (without a complicated state machine of some kind).
</I>&gt;<i>
</I>&gt;<i>I'm kind of mixed up, because when using a thread based network framework, 
</I>&gt;<i>one tcp connection = one thread, thus the protocol execution is atomic, but 
</I>&gt;<i>this doesn't seam to be the case with Twisted (event based), is this correct 
</I>&gt;<i>or have I missed something again?
</I>
If you send all events to a single function with no indication of where they
came from, then you will certainly have difficulty figuring out what's going
on.  So, don't do that. ;)

One solution is to have a difference instance for each connection and to use
a bound method as the event handler.  This gives you an obvious per-instance
place to keep state and such - on the instance.  There are other solutions,
of course, like passing in some extra object to the event handler so you can
differentiate between clients.

If you use instances and bound methods, then client1's stanzas will be sent
to the instance you created to handle client1 and client2's stanzas will be
sent to the instance you created to handle client2.  This way, it should be
trivial to keep track of what's going on.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016819.html">[Twisted-Python] Help using	XmlStreamFactory	&amp;	XmlStream	:	XPathQuery error?
</A></li>
	<LI>Next message: <A HREF="016821.html">[Twisted-Python] Help using	XmlStreamFactory	&amp;	XmlStream	:	XPathQuery error?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16820">[ date ]</a>
              <a href="thread.html#16820">[ thread ]</a>
              <a href="subject.html#16820">[ subject ]</a>
              <a href="author.html#16820">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
