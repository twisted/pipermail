<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Throttling a web2 server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Throttling%20a%20web2%20server&In-Reply-To=20080227111959.4hppx6x0v4ogoos8%40wasabox.wasabout.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016884.html">
   <LINK REL="Next"  HREF="016873.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Throttling a web2 server</H1>
    <B>Cameron Dale</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Throttling%20a%20web2%20server&In-Reply-To=20080227111959.4hppx6x0v4ogoos8%40wasabox.wasabout.net"
       TITLE="[Twisted-Python] Throttling a web2 server">camrdale at gmail.com
       </A><BR>
    <I>Thu Feb 28 15:34:34 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="016884.html">[Twisted-Python] Throttling a web2 server
</A></li>
        <LI>Next message: <A HREF="016873.html">[Twisted-Python] DeferredList?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16916">[ date ]</a>
              <a href="thread.html#16916">[ thread ]</a>
              <a href="subject.html#16916">[ subject ]</a>
              <a href="author.html#16916">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/27/08, Thomas Herv&#233; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">therve at free.fr</A>&gt; wrote:
&gt;<i> Thanks. Some maintenance on this would be great.
</I>
I'm not sure what you mean, is there some current maintenance (e.g.
more comments) you think should be added now? or do you refer to
future maintenance in case things break?

&gt;<i> I haven't very closely at your patch, but there is definitely
</I>&gt;<i>  something missing: tests. It's a requirement for anything going into
</I>&gt;<i>  Twisted, and generally a requirement for making something works.
</I>
Attached is a patch to twisted.test.test_policies.py to work with the
modified policies.py. In preparing it, I did fix one bug in my
previous policies.py which caused the write limiter to always be
active, so I attach an updated (fixed) patch of policies.py.

One thing I found in the tests is that the resumeProducing() calls
that my modified policies.py schedules via reactor.callLater() are
never called. This is (I believe) an artifact of the test, as the test
uses the twisted.internet.task.Clock's advance function, which only
runs scheduled calls added to it and not the reactor. Being unfamiliar
with twisted's testing framework, and having spent FAR too much time
on this already, I was not able to modify the test to work properly
with the reactor.callLater's, so I commented out those parts of the
test.

&gt;<i>  The discussion should probably continue in the tracker. You can open a
</I>&gt;<i>  ticket, or maybe attach your patch at
</I>&gt;<i>  <A HREF="http://twistedmatrix.com/trac/ticket/1460">http://twistedmatrix.com/trac/ticket/1460</A> (which doesn't exactly
</I>&gt;<i>  describe the same goal).
</I>
Noted, though I prefer email.

Thanks,
Cameron
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_policies.py.patch
Type: text/x-diff
Size: 1550 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20080228/dd4955f5/attachment.patch">http://twistedmatrix.com/pipermail/twisted-python/attachments/20080228/dd4955f5/attachment.patch</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: policies.py.patch
Type: text/x-diff
Size: 7651 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20080228/dd4955f5/attachment-0001.patch">http://twistedmatrix.com/pipermail/twisted-python/attachments/20080228/dd4955f5/attachment-0001.patch</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016884.html">[Twisted-Python] Throttling a web2 server
</A></li>
	<LI>Next message: <A HREF="016873.html">[Twisted-Python] DeferredList?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16916">[ date ]</a>
              <a href="thread.html#16916">[ thread ]</a>
              <a href="subject.html#16916">[ subject ]</a>
              <a href="author.html#16916">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
