<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Custom DNS server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Custom%20DNS%20server&In-Reply-To=20030723143538.GA4915%40intarweb.us">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005172.html">
   <LINK REL="Next"  HREF="005175.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Custom DNS server</H1>
    <B>Rudy Schockaert</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Custom%20DNS%20server&In-Reply-To=20030723143538.GA4915%40intarweb.us"
       TITLE="[Twisted-Python] Custom DNS server">Rudy.Schockaert at pandora.be
       </A><BR>
    <I>Wed Jul 23 16:50:00 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005172.html">[Twisted-Python] Custom DNS server
</A></li>
        <LI>Next message: <A HREF="005175.html">[Twisted-Python] Custom DNS server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5174">[ date ]</a>
              <a href="thread.html#5174">[ thread ]</a>
              <a href="subject.html#5174">[ subject ]</a>
              <a href="author.html#5174">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jp Calderone wrote:

&gt;<i>  This should be pretty easy.  I think the way to go about it would be to
</I>&gt;<i>subclass t.names.client.Resolver and override lookupMailExchange(),
</I>&gt;<i>returning the central relay address instead for the affected domains, and
</I>&gt;<i>deferring (english meaning) to the parent implementation of the method for
</I>&gt;<i>everyone else.
</I>&gt;<i>  
</I>&gt;<i>
</I>Hi Jp,

I was trying to figure out how the twisted.names package works and I 
think I found a solution where I don't need to modify anything.

When I create a DNS server as follows:

mycache = {.........} # valid cache entries
ca, cl = [], []
ca.append(twisted.names.cache.CacheResolver(cache=mycache)) # preloaded 
cache
ca.append(twisted.names.cache.CacheResolver()) # regular empty cache
cl.append(twisted.names.client.createResolver())
f = twisted.names.server.DNSServerFactory(caches=ca, clients=cl)
p = twisted.protocols.dns.DNSDatagramProtocol(f)
app.listenUDP(53, p)
app.listenTCP(53, f)

I have two caches: one preloaded with my entries and a second one that 
is empty at the start.
When a request arrives for a record that is in my preloaded cache it is 
returned, but also added to the second cache (actually to the last cache 
passed to the DNSServerFactory)..
callLater in cacheResult will remove it later from the second cache but 
not from the first cache.
All other entries will follow the normal way, be it with one 
cache-lookup extra.

Is there somewhere an error in my reasoning? Are there other reasons why 
this is not a good approach?

Bet regards,

/Rudy



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005172.html">[Twisted-Python] Custom DNS server
</A></li>
	<LI>Next message: <A HREF="005175.html">[Twisted-Python] Custom DNS server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5174">[ date ]</a>
              <a href="thread.html#5174">[ thread ]</a>
              <a href="subject.html#5174">[ subject ]</a>
              <a href="author.html#5174">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
