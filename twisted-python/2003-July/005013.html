<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted CallLater: Advanced Usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20CallLater%3A%20Advanced%20Usage&In-Reply-To=20030713122434.21978.qmail%40green.zadka.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005027.html">
   <LINK REL="Next"  HREF="005014.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted CallLater: Advanced Usage</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20CallLater%3A%20Advanced%20Usage&In-Reply-To=20030713122434.21978.qmail%40green.zadka.com"
       TITLE="[Twisted-Python] Twisted CallLater: Advanced Usage">bob at redivi.com
       </A><BR>
    <I>Sun Jul 13 16:47:38 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005027.html">[Twisted-Python] Accessing ClientFactory methods?
</A></li>
        <LI>Next message: <A HREF="005014.html">[Twisted-Python] Twisted CallLater: Advanced Usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5013">[ date ]</a>
              <a href="thread.html#5013">[ thread ]</a>
              <a href="subject.html#5013">[ subject ]</a>
              <a href="author.html#5013">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sunday, Jul 13, 2003, at 08:24 America/New_York, Moshe Zadka wrote:

&gt;<i> from __future__ import generators
</I>&gt;<i> def os_path_walk(path, visit, arg):
</I>&gt;<i>     d = defer.Deferred()
</I>&gt;<i>     def walk(path):
</I>&gt;<i>         files = os.listdir(path)
</I>&gt;<i>         visit(arg, path, files)
</I>&gt;<i>         for file in files:
</I>&gt;<i>             yield None
</I>&gt;<i>             if os.path.isdir(file):
</I>&gt;<i>                 for _ in walk(os.path.join(path, file):
</I>&gt;<i>                     pass
</I>&gt;<i>     next = walk(path).next
</I>&gt;<i>     def caller():
</I>&gt;<i>         try:
</I>&gt;<i>             next()
</I>&gt;<i>         except StopIteration:
</I>&gt;<i>             d.callback(None)
</I>&gt;<i>         except:
</I>&gt;<i>             d.errback(sys.exc_info()[1])
</I>&gt;<i>         else:
</I>&gt;<i>             reactor.callLater(0, caller)
</I>&gt;<i>     caller()
</I>&gt;<i>     return d
</I>
This is close to what I did when I wrote 'flow' (different from cce's), 
except I did the &quot;caller&quot; phase as a function-wrapper (akin to 
staticmethod or classmethod), and I made it smarter, such that it could 
return a value, get the result of a deferred (the next() wouldn't 
happen until the result of the deferred was ready), etc.

AFAIK, since cce's flow is in Twisted now, this example is better 
served using that.  Also, you should be showing people Failure() 
instead of sys.exc_info()[1].

-bob



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005027.html">[Twisted-Python] Accessing ClientFactory methods?
</A></li>
	<LI>Next message: <A HREF="005014.html">[Twisted-Python] Twisted CallLater: Advanced Usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5013">[ date ]</a>
              <a href="thread.html#5013">[ thread ]</a>
              <a href="subject.html#5013">[ subject ]</a>
              <a href="author.html#5013">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
