<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Throttling Factory Problem ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Throttling%20Factory%20Problem%20...&In-Reply-To=%3C200307201346.17206.joel.vennin%40wanadoo.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037620.html">
   <LINK REL="Next"  HREF="037623.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Throttling Factory Problem ...</H1>
    <B>JoÃ«l Vennin</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Throttling%20Factory%20Problem%20...&In-Reply-To=%3C200307201346.17206.joel.vennin%40wanadoo.fr%3E"
       TITLE="[Twisted-Python] Throttling Factory Problem ...">joel.vennin at wanadoo.fr
       </A><BR>
    <I>Sun Jul 20 05:46:14 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037620.html">[Twisted-Python] htp example and twisted CPU usage
</A></li>
        <LI>Next message (by thread): <A HREF="037623.html">[Twisted-Python] Throttling Factory Problem ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37621">[ date ]</a>
              <a href="thread.html#37621">[ thread ]</a>
              <a href="subject.html#37621">[ subject ]</a>
              <a href="author.html#37621">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello all, 

I'm making an example to limit bandwidth with ThrottlingFactory. I've a server 
and a client. Client and server make echo. So it's an infinite process. I've 
limited the bandwith to 1Ko/s.

The problem is that the client send a lot's of data  (more than the limited 
bandwidth) during a little time. The server get all the data (more than the 
limited bandwith) and after each wait a long of time before send/received 
something.


Maybe i miss something, can you help me.

Thank you, jol


client.py:
from twisted.protocols import policies
from twisted.internet import protocol, reactor

class SenderProtocol(protocol.Protocol):

    def connectionMade(self):
        self.transport.registerProducer (self, 1)
        self.sendSomething ()

    def pauseProducing(self):
        print &quot;Sender Protocol make a Pause&quot;

    def resumeProducing(self):
        print &quot;Sender Protocol make a Resume&quot;

    def stopProducing(self):
        pass

    def sendSomething (self):
        self.transport.write (500 * &quot;c&quot;)

    def dataReceived(self, data):
        self.transport.write(data)

    
class Client(protocol.ClientFactory):

    protocol = SenderProtocol
    
client = Client()
tClient = policies.ThrottlingFactory(client, readLimit=1000)

#port = reactor.listenTCP (7000, tServer, interface=&quot;127.0.0.1&quot;)

port = reactor.connectTCP (&quot;127.0.0.1&quot;, 7000, tClient)

reactor.run ()




server.py:
from twisted.protocols import policies
from twisted.internet import protocol, reactor

class EchoProtocol(protocol.Protocol):

    def connectionMade(self):
        self.transport.registerProducer (self, 1)
        
    def pauseProducing(self):
        print &quot;Echo Protocol make a Pause&quot;

    def resumeProducing(self):
        print &quot;Echo Protocol make a Resume&quot;

    def stopProducing(self):
        pass

    def dataReceived(self, data):
        self.transport.write(data)

    
class Server(protocol.ServerFactory):

    protocol = EchoProtocol
    

server = Server()
tServer = policies.ThrottlingFactory(server, writeLimit=1000, readLimit=1000)

port = reactor.listenTCP (7000, tServer, interface=&quot;127.0.0.1&quot;)
reactor.run ()

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (GNU/Linux)

iD8DBQE/GoEJOzJ7itUoJpQRAgHgAJ9uDoy6Rj13J4mNC1PUp/GbhDMoWACdGv5/
KO7Hj3TchnGjizz3tM5l9jw=
=swOH
-----END PGP SIGNATURE-----



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037620.html">[Twisted-Python] htp example and twisted CPU usage
</A></li>
	<LI>Next message (by thread): <A HREF="037623.html">[Twisted-Python] Throttling Factory Problem ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37621">[ date ]</a>
              <a href="thread.html#37621">[ thread ]</a>
              <a href="subject.html#37621">[ subject ]</a>
              <a href="author.html#37621">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
