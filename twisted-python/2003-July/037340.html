<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Controlling the classes being Jellied
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Controlling%20the%20classes%20being%20Jellied&In-Reply-To=%3C20030702.015903.06353698.warner%40lothar.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037330.html">
   <LINK REL="Next"  HREF="037344.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Controlling the classes being Jellied</H1>
    <B>Brian Warner</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Controlling%20the%20classes%20being%20Jellied&In-Reply-To=%3C20030702.015903.06353698.warner%40lothar.com%3E"
       TITLE="[Twisted-Python] Controlling the classes being Jellied">warner at lothar.com
       </A><BR>
    <I>Wed Jul  2 02:59:03 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037330.html">[Twisted-Python] Controlling the classes being Jellied
</A></li>
        <LI>Next message (by thread): <A HREF="037344.html">[Twisted-Python] Controlling the classes being Jellied
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37340">[ date ]</a>
              <a href="thread.html#37340">[ thread ]</a>
              <a href="subject.html#37340">[ subject ]</a>
              <a href="author.html#37340">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&quot;Patrik Blommaskog&quot; &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">pb_twisted at olga.mine.nu</A>&gt; writes:

&gt;<i> I'm using PB and want to accomplish something like this:
</I>&gt;<i> 
</I>&gt;<i> On the server, I have the following class hierarchy:
</I>&gt;<i> 
</I>&gt;<i>     Actor(pb.Copyable)
</I>&gt;<i>   
</I>&gt;<i>     GoodActor(Actor)
</I>&gt;<i>     BadActor(Actor)
</I>&gt;<i>     ...
</I>&gt;<i>     WhateverActor(Actor)
</I>&gt;<i> 
</I>&gt;<i> There exists a number of instances of each of these classes.
</I>&gt;<i> 
</I>&gt;<i> When Jellying them over to the client, I want each of them to create 
</I>&gt;<i> instances of the client class RemoteActor, no matter which of the server 
</I>&gt;<i> classes they are of. In practice, the different server classes will 
</I>&gt;<i> generate different state data that is transmitted to the client, where 
</I>&gt;<i> that state data just updates __dict__ , at least for now.
</I>
You probably want something like this on the sending side:
  
  class Actor(pb.Copyable):
    def getTypeToCopy(self):
      return &quot;package.module.Actor&quot;
  
  class GoodActor(Actor):
    def getStateToCopy(self):
      return good_dict
  
  class BadActor(Actor):
    def getStateToCopy(self):
      return bad_dict

and then the receiving side can just do:
  
  class RemoteActor(pb.RemoteCopy):
    ...
  
  pb.setUnjellyableForClass(&quot;package.module.Actor&quot;, RemoteActor)


The two important points are:

 1: by overriding .getTypeToCopy(), the sending class can control what class
    name is put into the serialized stream.

 2: pb.setUnjellyableForClass maps a name (the one in the serialized stream)
    to a local class. The name can be specified either as a string or as a
    class. If you don't have access to the the class, just use a string that
    matches the one used by the sender. The only caveat is to make sure the
    string is unique with respect to packages and modules and such.. in
    general is should be a &quot;fully qualified&quot; class name.


Hope that helps.. let me know if you've got more questions. I think we could
use an example of this (string-based jellied class names instead of classes
shared between sender and recipient) in the docs.

cheers,
 -Brian


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037330.html">[Twisted-Python] Controlling the classes being Jellied
</A></li>
	<LI>Next message (by thread): <A HREF="037344.html">[Twisted-Python] Controlling the classes being Jellied
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37340">[ date ]</a>
              <a href="thread.html#37340">[ thread ]</a>
              <a href="subject.html#37340">[ subject ]</a>
              <a href="author.html#37340">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
