<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Woven LivePage sendScript works with some scripts but not others
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Woven%20LivePage%20sendScript%20works%20with%20some%20scripts%20but%20not%20others&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005095.html">
   <LINK REL="Next"  HREF="005090.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Woven LivePage sendScript works with some scripts but not others</H1>
    <B>Tim Andrews</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Woven%20LivePage%20sendScript%20works%20with%20some%20scripts%20but%20not%20others&In-Reply-To="
       TITLE="[Twisted-Python] Woven LivePage sendScript works with some scripts but not others">tim.andrews at adpro.com.au
       </A><BR>
    <I>Thu Jul 17 20:37:23 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005095.html">[Twisted-Python] Simplifying my StatusMonitor
</A></li>
        <LI>Next message: <A HREF="005090.html">[Twisted-Python] Woven LivePage sendScript works with some scripts but not others
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5087">[ date ]</a>
              <a href="thread.html#5087">[ thread ]</a>
              <a href="subject.html#5087">[ subject ]</a>
              <a href="author.html#5087">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi twisted,

I'm trying to use LivePage to send some script to a web page.

All works well if the script is as per the manual example, ie
sendScript(&quot;alert('Hello world!')&quot;)
will pop up a window as expected.

However, if i try a script like &quot;document.all.fred.innerHTML='FRED'&quot; I get
an error on the page &quot;Error: document.all.fred is null or not an object&quot;. I
know the script is okay because if it is on the on the page it will work.

Any clues?

Thanks,

Tim


Some example code for your perusal ...


from twisted.web.woven import page, controller, interfaces

model = {
    'name': 'LivePage Handled Events',
    'link': '<A HREF="http://link',">http://link',</A>
}

template = &quot;&quot;&quot;
  &lt;html&gt;
   &lt;body&gt;
     &lt;h3&gt; Watch me change! &lt;/h3&gt;
     &lt;div id = &quot;fred&quot;&gt; blah &lt;/div&gt;
     &lt;h3 model=&quot;name&quot; view=&quot;Text&quot;/&gt;
     &lt;div model=&quot;link&quot; view=&quot;Link&quot; controller=&quot;foo&quot;&gt;mouse here won't work
:<i>(&lt;/div&gt;
</I>     &lt;span view=&quot;webConduitGlue&quot; /&gt;
     &lt;h3&gt;Locally Handled Events&lt;/h3&gt;
     &lt;a href=&quot;<A HREF="http://link&quot;">http://link&quot;</A>
        onmouseover=&quot;document.all.fred.innerHTML='FRED'&quot;
        onmouseout=&quot;document.all.fred.innerHTML='fred'&quot;&gt;mouse here will work
:<i>)
</I>     &lt;/a&gt;
   &lt;/body&gt;
  &lt;/html&gt;
&quot;&quot;&quot;

class fooController(controller.Controller):

  def handle(self, request):
    global currentPage
    currentPage = request.getSession(interfaces.IWovenLivePage)
    self.view.addEventHandler(&quot;onmouseover&quot;, self.foo_onMouseOver)
    self.view.addEventHandler(&quot;onmouseout&quot;, self.foo_onMouseOut)

  def foo_onMouseOver(self, request, widget):
    global currentPage
    print 'foo over'
    currentPage.sendScript(&quot;document.all.fred.innerHTML='FRED'&quot;) # :( this
doesn't work
    # currentPage.sendScript(&quot;alert('Hello world!')&quot;) # :) this works

  def foo_onMouseOut(self, request, widget):
    global currentPage
    print 'foo out'
    currentPage.sendScript(&quot;document.all.fred.innerHTML='fred'&quot;) # :( this
doesn't work

class fooPage(page.LivePage):

  def wcfactory_foo(self, request, node, model):
    return fooController(model)

resource = fooPage(model, template=template)



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005095.html">[Twisted-Python] Simplifying my StatusMonitor
</A></li>
	<LI>Next message: <A HREF="005090.html">[Twisted-Python] Woven LivePage sendScript works with some scripts but not others
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5087">[ date ]</a>
              <a href="thread.html#5087">[ thread ]</a>
              <a href="subject.html#5087">[ subject ]</a>
              <a href="author.html#5087">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
