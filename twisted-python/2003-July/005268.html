<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] problems with callback in an iteration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20problems%20with%20callback%20in%20an%20iteration&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005316.html">
   <LINK REL="Next"  HREF="005282.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] problems with callback in an iteration</H1>
    <B>Justin Johnson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20problems%20with%20callback%20in%20an%20iteration&In-Reply-To="
       TITLE="[Twisted-Python] problems with callback in an iteration">justinjohnson at fastmail.fm
       </A><BR>
    <I>Wed Jul 30 15:44:14 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005316.html">[Twisted-Python] the right way of unit testing protocols
</A></li>
        <LI>Next message: <A HREF="005282.html">[Twisted-Python] adbapi weirdness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5268">[ date ]</a>
              <a href="thread.html#5268">[ thread ]</a>
              <a href="subject.html#5268">[ subject ]</a>
              <a href="author.html#5268">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In the code below, I create a Trigger object (something I defined) and
call the &quot;make&quot; method on it.  Then I add a callback so that I can &quot;lock&quot;
it after it has been made.  I'm getting some wierd results though.  The
output from the first print statement...

print &quot;trigger name&quot;, self.name

...prints the names of the triggers correctly, as they appear in the list
(trigger1 followed by trigger2).  However, the callback to _lock is only
called with the last element in the list (trigger2), but it is called
twice.  So instead of calling _lock on trigger1 and then on trigger2, it
is called twice on trigger2.

Does anyone see what I'm doing wrong?

[snip]
def applyTriggers(self):
	&quot;&quot;&quot;Apply the standard triggers to the VOB.
	&quot;&quot;&quot;
	deferreds = []
	trigger1 = trigger.PreRmverTrigger(&quot;pre_rmver&quot;,&quot;Prevent removing of versions&quot;,config.thisServer,self.tag)
	trigger2 = trigger.PreRmelemTrigger(&quot;pre_rmelem&quot;,&quot;Prevent removing of elements&quot;,config.thisServer,self.tag)

	for t in [trigger1, trigger2]:
		print &quot;trigger name:&quot;, t.name

		def _lock(results):
			print &quot;*** locking trigger:&quot;, t.name
			d = t.lock()
			return d

		d = t.make()
		d.addCallbacks(_lock, log.err)
		deferreds.append(d)
	return defer.DeferredList(deferreds)
[/snip]


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005316.html">[Twisted-Python] the right way of unit testing protocols
</A></li>
	<LI>Next message: <A HREF="005282.html">[Twisted-Python] adbapi weirdness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5268">[ date ]</a>
              <a href="thread.html#5268">[ thread ]</a>
              <a href="subject.html#5268">[ subject ]</a>
              <a href="author.html#5268">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
