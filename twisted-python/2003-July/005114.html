<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: help, my woven web app won't work on win32 but will on linux!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20help%2C%20my%20woven%20web%20app%20won%27t%20work%20on%20win32%20but%20will%20on%20linux%21&In-Reply-To=3F17D99C.9000908%40enginesofcreation.ie">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005094.html">
   <LINK REL="Next"  HREF="005096.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: help, my woven web app won't work on win32 but will on linux!</H1>
    <B>Oisin Mulvihill</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20help%2C%20my%20woven%20web%20app%20won%27t%20work%20on%20win32%20but%20will%20on%20linux%21&In-Reply-To=3F17D99C.9000908%40enginesofcreation.ie"
       TITLE="[Twisted-Python] Re: help, my woven web app won't work on win32 but will on linux!">oisin at enginesofcreation.ie
       </A><BR>
    <I>Sun Jul 20 08:31:31 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005094.html">[Twisted-Python] help, my woven web app won't work on win32 but will on linux!
</A></li>
        <LI>Next message: <A HREF="005096.html">[Twisted-Python] Accessing app-wide data in Woven
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5114">[ date ]</a>
              <a href="thread.html#5114">[ thread ]</a>
              <a href="subject.html#5114">[ subject ]</a>
              <a href="author.html#5114">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Well I have had various comments that the code I attached
does not work at all. I tried it on my osx machine with the
twisted 1.0.6 and Twisted-1.0.7alpha2 and found my code
didn't work on windows and linux machines. My suse linux
machine has Twisted-1.0.5 and this is the only machine on
which my program works. I installed 1.0.5 on my osx machine
and low and behold my program works.

I decided to try the &quot;Page in depth&quot; example on which my code
is based to see if I could track the problem. The index.rpy contains
this example. This example does not now work in 1.0.6 and
1.0.7alpha.

When you run this example with 1.0.5 and you can click on the
&quot;fred&quot; or &quot;bob&quot; link you get the following urls and the example
works:

<A HREF="http://localhost:20808/fred">http://localhost:20808/fred</A>
<A HREF="http://localhost:20808/bob">http://localhost:20808/bob</A>

This is what the woven page in depth documentation says and
it works.

If you run this example with 1.0.6/7 you get &quot;resource not found&quot;
error. If however you go to the following url first

<A HREF="http://localhost:20808/index.rpy/">http://localhost:20808/index.rpy/</A>

and then click on the &quot;fred&quot; or &quot;bob&quot; link, you get the follow urls
and the example works:

<A HREF="http://localhost:20808/index.rpy/fred/">http://localhost:20808/index.rpy/fred/</A>
<A HREF="http://localhost:20808/index.rpy/bob/">http://localhost:20808/index.rpy/bob/</A>

This is not what the documentation says should happen. This
appears to be a bug in the new twisted versions. Has something
changed, that means woven child page methods no longer work,
as they did in twisted 1.0.5.

Can someone please shed some light on this?

Thanks,

om




Oisin Mulvihill wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I've produced a small model of my program which hightlights
</I>&gt;<i> the problem I'm having. Attached are two files main.py and
</I>&gt;<i> index.rpy. To run the web app run main and make sure index.rpy
</I>&gt;<i> is in the same directory. Then point your web browser to
</I>&gt;<i> <A HREF="http://localhost:20808">http://localhost:20808</A>
</I>&gt;<i>
</I>&gt;<i> On linux I can click on the web buttons and the app works
</I>&gt;<i> fine. One windows (I'm using win2k) I simply get
</I>&gt;<i> &quot;No Such Resource, File not found&quot;.
</I>&gt;<i>
</I>&gt;<i> The button press issues a post and this shows up as the url
</I>&gt;<i> &quot;<A HREF="http://localhost:20808/control?action=set_view&amp;view=view1&quot;">http://localhost:20808/control?action=set_view&amp;view=view1&quot;</A>
</I>&gt;<i>
</I>&gt;<i> When you look at the MyPage class in index.rpy I have a
</I>&gt;<i> wchild_control method. This method is called on linux and
</I>&gt;<i> I then process the request and take the required action.
</I>&gt;<i>
</I>&gt;<i> On windows the wchild_control method does not appear to be
</I>&gt;<i> called at all and I don't know why.
</I>&gt;<i>
</I>&gt;<i> Can anyone shed any light on this problem?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> om
</I>&gt;<i>
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> import time import urlparse import twisted.web.server from 
</I>&gt;<i> twisted.web.woven import view from twisted.web.woven import page from 
</I>&gt;<i> twisted.web.woven import model from twisted.web.woven import input 
</I>&gt;<i> from twisted.web.microdom import lmx from twisted.web.woven import 
</I>&gt;<i> widgets from twisted.web.woven import controller from twisted.python 
</I>&gt;<i> import components # # Set up the session I'll be using: # class 
</I>&gt;<i> IPreferences(components.Interface): pass class 
</I>&gt;<i> Preferences(components.Adapter): __implements__ = IPreferences 
</I>&gt;<i> components.registerAdapter(Preferences, twisted.web.server.Session, 
</I>&gt;<i> IPreferences) class MyModel(model.MethodModel): &quot;&quot;&quot; &quot;&quot;&quot; pass class 
</I>&gt;<i> NavigationControlsDisplay(view.View): template = &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>  
</I>&gt;<i> &quot;&quot;&quot; class View1(view.View): &quot;&quot;&quot; &quot;&quot;&quot; template = &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i> View One
</I>&gt;<i>
</I>&gt;<i> &quot;&quot;&quot; class View2(view.View): &quot;&quot;&quot; &quot;&quot;&quot; template = &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i> View Two
</I>&gt;<i>
</I>&gt;<i> &quot;&quot;&quot; class MyPage(page.Page): &quot;&quot;&quot; &quot;&quot;&quot; template =&quot;&quot;&quot;
</I>&gt;<i> &quot;&quot;&quot; def wvfactory_current_view(self, request, node, model): 
</I>&gt;<i> print(&quot;cafemonitor.CafePage.wvfactory_current_view&quot;) prefs = 
</I>&gt;<i> request.getSession(IPreferences) view = getattr(prefs, 
</I>&gt;<i> 'current_view','live_view') print(&quot;Selecting view &lt;%s&gt;.&quot; % view) if 
</I>&gt;<i> view == &quot;view1&quot;: print(&quot;Returning View1.&quot;) return View1(model) elif 
</I>&gt;<i> view == &quot;view2&quot;: print(&quot;Returning View2.&quot;) return View2(model) else: 
</I>&gt;<i> print(&quot;unknown view &lt;%s&gt;. Returning View1.&quot; % view) return 
</I>&gt;<i> View1(model) def wchild_control(self, request): &quot;&quot;&quot;This is a fake 
</I>&gt;<i> /control subdirectory used to control a specific machine. request - 
</I>&gt;<i> action: new, complete, void, restore. &quot;&quot;&quot; print(&quot;wchild_control - 
</I>&gt;<i> request.args &lt;%s&gt;.&quot; % str(request.args)) action = 
</I>&gt;<i> request.args.get(&quot;action&quot;, 0)[0] if action == &quot;set_view&quot;: prefs = 
</I>&gt;<i> request.getSession(IPreferences) view = request.args.get(&quot;view&quot;, 0)[0] 
</I>&gt;<i> print(&quot;Setting new view from navigation menu selection &lt;%s&gt;.&quot; % view) 
</I>&gt;<i> prefs.current_view = view else: print(&quot;unknown action &lt;%s&gt;.&quot; % action) 
</I>&gt;<i> return self resource = MyPage(MyModel()) 
</I>&gt;<i> resource.setSubviewFactory(&quot;navigation&quot;, NavigationControlsDisplay)
</I>&gt;<i>
</I>&gt;<i>------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>#!/usr/bin/env python
</I>&gt;<i>from twisted.internet import reactor
</I>&gt;<i>from twisted.internet.app import Application
</I>&gt;<i>from twisted.web import static, server, script
</I>&gt;<i>
</I>&gt;<i>def main():
</I>&gt;<i>	&quot;&quot;&quot;Run the xml rpc server.
</I>&gt;<i>	&quot;&quot;&quot;
</I>&gt;<i>	app = Application(&quot;CafeMonitor&quot;)
</I>&gt;<i>
</I>&gt;<i>	root = static.File(&quot;./&quot;)
</I>&gt;<i>	root.processors = {
</I>&gt;<i>		'.rpy': script.ResourceScript,
</I>&gt;<i>		}
</I>&gt;<i>
</I>&gt;<i>	app.listenTCP(
</I>&gt;<i>		port=20808,
</I>&gt;<i>		factory=server.Site(root),
</I>&gt;<i>		interface=&quot;localhost&quot;
</I>&gt;<i>	)
</I>&gt;<i>	print(&quot;Web Frontend - &lt;%s:%s&gt;.&quot; % (&quot;localhost&quot;, &quot;20808&quot;))
</I>&gt;<i>	app.run(0)
</I>&gt;<i>	
</I>&gt;<i>if __name__ == '__main__':
</I>&gt;<i>	main()
</I>&gt;<i>	
</I>&gt;<i>  
</I>&gt;<i>
</I>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: main.py
Url: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20030720/844266e4/attachment.txt">http://twistedmatrix.com/pipermail/twisted-python/attachments/20030720/844266e4/attachment.txt</A> 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: index.rpy
Url: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20030720/844266e4/attachment-0001.txt">http://twistedmatrix.com/pipermail/twisted-python/attachments/20030720/844266e4/attachment-0001.txt</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005094.html">[Twisted-Python] help, my woven web app won't work on win32 but will on linux!
</A></li>
	<LI>Next message: <A HREF="005096.html">[Twisted-Python] Accessing app-wide data in Woven
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5114">[ date ]</a>
              <a href="thread.html#5114">[ thread ]</a>
              <a href="subject.html#5114">[ subject ]</a>
              <a href="author.html#5114">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
