<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Callbacks, Looping, and Variable Binding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Callbacks%2C%20Looping%2C%20and%20Variable%20Binding&In-Reply-To=20030731195004.GB32069%40lapdog">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005312.html">
   <LINK REL="Next"  HREF="005314.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Callbacks, Looping, and Variable Binding</H1>
    <B>Justin Johnson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Callbacks%2C%20Looping%2C%20and%20Variable%20Binding&In-Reply-To=20030731195004.GB32069%40lapdog"
       TITLE="[Twisted-Python] Callbacks, Looping, and Variable Binding">justinjohnson at fastmail.fm
       </A><BR>
    <I>Thu Jul 31 16:20:24 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005312.html">[Twisted-Python] Callbacks, Looping, and Variable Binding
</A></li>
        <LI>Next message: <A HREF="005314.html">[Twisted-Python] Callbacks, Looping, and Variable Binding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5313">[ date ]</a>
              <a href="thread.html#5313">[ thread ]</a>
              <a href="subject.html#5313">[ subject ]</a>
              <a href="author.html#5313">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 31 Jul 2003 22:50:04 +0300, &quot;Tommi Virtanen&quot;
&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">tv at twistedmatrix.com</A>&gt; said:
&gt;<i> On Thu, Jul 31, 2003 at 11:13:28AM -0600, Justin Johnson wrote:
</I>&gt;<i> &gt; When I run the following code, everytime the callbacks to &quot;onSuccess&quot; get
</I>&gt;<i> &gt; called, &quot;item&quot; is bound to the last element in &quot;list&quot;.  Obviously what I
</I>&gt;<i> &gt; want is to have &quot;item&quot; bound to the value it had when I added the
</I>&gt;<i> &gt; callback.  How does one handle looping constructs like this in Twisted?
</I>&gt;<i> 
</I>&gt;<i> 	Then don't inherit the namespace of someFunc. You could even
</I>&gt;<i> 	move onSuccess outside of someFunc, to make sure you don't do
</I>&gt;<i> 	that by accident.
</I>
My problem (besides just having a lot to learn) was that I was writing
the callbacks to use variables that were defined in the loop, thinking I
had no other option besides using results passed by previous callbacks. 
The results that were returned from doSomethingThatReturnsDeferred (and
thus were arguments to the next callback) were needed (not right away,
but I wanted the results to continue being passed down the callback
chain), and I wasn't aware of any other way to get &quot;item&quot; passed to my
callback.  However, I tried using callbackArgs to pass &quot;item&quot; in a tuple,
like this...

     for item in list:
         d.addCallbacks(onSuccess, log.err, callbackArgs=(item,))
         deferreds.append(d)

and then defining onSuccess like...

    def onSuccess(results, args):
        item = args[0]
        d = item.doSomethingElseThatReturnsDeferred()
        return d

Is this an acceptable way to accomplish this?  It is working in my code
but I'd like to do things the right way.

&gt;<i> 
</I>&gt;<i> 	Besides, you are adding the outer d to deferreds once per
</I>&gt;<i> 	iteration. That's broken.
</I>
I'm not sure what you mean here.  I was adding my deferred to a list and
it seemed to be doing what I wanted (at least I think it was).

Your help is appreciated.
-Justin


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005312.html">[Twisted-Python] Callbacks, Looping, and Variable Binding
</A></li>
	<LI>Next message: <A HREF="005314.html">[Twisted-Python] Callbacks, Looping, and Variable Binding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5313">[ date ]</a>
              <a href="thread.html#5313">[ thread ]</a>
              <a href="subject.html#5313">[ subject ]</a>
              <a href="author.html#5313">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
