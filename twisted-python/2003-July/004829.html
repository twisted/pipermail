<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] ldaptor feedback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20ldaptor%20feedback&In-Reply-To=20030702032744.GA80790%40doublegemini.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004833.html">
   <LINK REL="Next"  HREF="004830.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] ldaptor feedback</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20ldaptor%20feedback&In-Reply-To=20030702032744.GA80790%40doublegemini.com"
       TITLE="[Twisted-Python] ldaptor feedback">tv at twistedmatrix.com
       </A><BR>
    <I>Wed Jul  2 02:35:20 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004833.html">[Twisted-Python] windows binary install.
</A></li>
        <LI>Next message: <A HREF="004830.html">[Twisted-Python] ldaptor feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4829">[ date ]</a>
              <a href="thread.html#4829">[ thread ]</a>
              <a href="subject.html#4829">[ subject ]</a>
              <a href="author.html#4829">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Jul 02, 2003 at 03:27:44AM +0000, Clark C. Evans wrote:
&gt;<i> 1.  I would like to see ldap in twisted proper, it is really a
</I>&gt;<i>     core protocol (like imap, etc.).   From what I heared there are
</I>&gt;<i>     two arguments against, size and licensing.
</I>&gt;<i> 
</I>&gt;<i>     As for size, I think that LDAP is so important that it really
</I>&gt;<i>     belongs in twisted.   It is at the same level as IMAP.   I do not
</I>&gt;<i>     want to have to go to an external module, hence LDAP is in-scope
</I>&gt;<i>     so the size argument does not matter to me.
</I>
	IMAP is &lt;4200 lines with tests, and I believe it is expected
	to be pretty complete protocol, including client and server
	sides. Ldaptor is already almost three times that big,
	client-only, and is still only scratching the surface.

	LDAP is not really used commonly enough to bloat the twisted
	core with it. (Quick! Name three end user applications using
	LDAP!)

	If you think installing two libraries instead of one is too
	hard, you need to get a better OS ;)

&gt;<i>     As for licensing, I understand your concerns.  However, it is very
</I>&gt;<i>     important for enforcement of copyright and for the ability to 'fix'
</I>&gt;<i>     the license that a single entity have the ability to license the
</I>&gt;<i>     and enforce the work as needed.    Long term I'd like to see Glyph
</I>&gt;<i>     form some sort of non-profit to hold the copyrights, or at the
</I>&gt;<i>     very least present a 'will' of sorts describing what happens to
</I>&gt;<i>     the copyrights in the event that he is incapacitated or gets 
</I>&gt;<i>     hit by a MAC truck.    For now, I'm not too worried about this.
</I>
	I think we as the community don't need anything better than
	LGPL.

&gt;<i>     As for Glyph selling the software and making a profit... well, 
</I>&gt;<i>     as a bunch of individual packages this just is not an option at
</I>&gt;<i>     all, so better someone than no one.
</I>
	I don't feel that way. And most of all, I am not willing to
	delegate that power when it comes to my creation.

	Besides, glyph's major point on that was the game industry.
	I'm betting they will not be interested in LDAP.

&gt;<i>     So, Glyph approving, would you consider contributing ldaptor
</I>&gt;<i>     to twisted?
</I>
	No, you are missing the point. That was the starting point;
	if I had been happy with that I would never have moved the
	code from Twisted to Ldaptor.

&gt;<i> 2.  Your package hierarchy needs help... lots of help.
</I>
	Agreed.

&gt;<i>     Let's start with this example... 
</I>&gt;<i> 
</I>&gt;<i>     from ldaptor.protocols.ldap.ldapsyntax import LDAPJournalOperation_Replace
</I>&gt;<i>
</I>&gt;<i>     Arg!
</I>
	You never do that.

	1. s/from foo.bar import OneClass/from foo import bar/

	2. users of the API never need to touch LDAPJournalOperations,
	   or even the journal itself.

	The current situation looks more like

	from ldaptor.protocol.ldap import ldapsyntax

	o = ldapsyntax.LDAPObject(..)

	which is within the limits of what my emacs is willing to
	dabbrev-expand. Most of the time you just do things like

	d = o.search(...)
	d.addCallback(foo)

&gt;<i>     First, ldaptor has one protocol... ldap.  So &quot;protocols.ldap&quot; is
</I>&gt;<i>     quite redundant.
</I>
	There's likely to be LDAPv4. LDAP protocol versions aren't really
	compatible.

	I think LDIF-as-a-replication format is a protocol.

	There's LDUP, the LDAP replication protocol, but that's probably
	just a superset of LDAPv3.

	I think I may end up supporting LDAP-over-UDP, if the standard
	is stable.

	What's really making you grit your teeth is that the mechanism
	an LDAP client uses to open a connection to an LDAP server should
	be in ldaptor.client; and it will be, once I have a clear idea
	what the API should look like. For now, you need to make your own
	subclass of ldapclient.LDAPClient, a Protocol, even if you
	only override *1* method of it! And, remember what I said, everything
	in ldapclient is the old, ugly, API.

	In the future, it'll look more like

	from ldaptor import client

	d=client.openDN('dc=example,dc=com')
	d.addCallback(lambda o: o.search('cn=foo'))

	and you won't need to import the low-level things.

&gt;<i>     Second, ldapsyntax is describing a ldap proxy 
</I>&gt;<i>     object with the ability to journal its changes and save.  It has
</I>&gt;<i>     nothing to do with &quot;syntax&quot; let alone &quot;ldapsyntax&quot;, how about 
</I>&gt;<i>     'object' or 'proxy'?.
</I>
	Yes, the word syntax is bad. It dates back to the time I tried to
	make the data in LDAP be manipulatable as Python objects, from the
	days before Twisted.

	I refuse to name a class &quot;Object&quot;. I refuse to name a class
	&quot;Proxy&quot;.

	Besides, I'm a TCP/IP person. To me, a proxy is a thing that
	intermediates between two (different or the same) protocols,
	not something that is really a client-side state for a
	networking API.

&gt;<i>     Third, I count 3 occurances of LDAP... Uncle!
</I>
	You purposefully imported the lowest-level thing you could find.
	I could care less how ugly that seems to you. You are not supposed
	to touch that. Internal consistency matters more than shortness
	of the names.

&gt;<i>     Fourth, the class name is *huge* and using prefixes this way sucks, 
</I>&gt;<i>     JournalOperations should be in a file called 'journal'.    In short, 
</I>&gt;<i>     what I'd want to see...
</I>&gt;<i> 
</I>&gt;<i>        from ldaptor import ldap
</I>&gt;<i>        op = ldap.journal.Replace()
</I>
	Class named Replace? That way leads to insanity, IMHO.
	What does it replace? With what? Where? Remember, you are
	talking about an implementation detail users of the library
	should never see.

&gt;<i>     The 'low-level' pureber and pureldap are really not protocol
</I>&gt;<i>     items so much as they are parsers/emitters.  You could stuff
</I>&gt;<i>     these, as well as the filter, ldif, and schema all into 
</I>&gt;<i>     another part of ldaptor, ldaptor.parse.ldif, etc.
</I>
	There are two things in a protocol:

	1. the wire representation of things
		ldaptor.protocols.pureber
		ldaptor.protocols.pureldap

	2. the state machine
		ldaptor.protocols.ldap.ldapclient
		ldaptor.protocols.ldap.ldapsyntax

	(often #1 is so simple it's not implemented separately)

	The wire representation of the LDAP messages is never
	written to a file, so there's no use for it outside of
	the protocol scope.

	Filter and ldif need to move some day. They started life
	as residing inside the neighbouring .py files, and were
	split out when they grew too big; moving them should be
	reasonably trivial.

	schema needs to be split into pure-ASCII-parser
	(ldaptor.schema?) and the state machine to fetch the used
	schema from the server over LDAP (which should be refactored
	to use LDAPObjects).

&gt;<i>     Anyway, for ldaptor to be understandable it really needs a 
</I>&gt;<i>     refactor like this.   Just look at your commands as to how
</I>&gt;<i>     ugly the packaging is.   Good packaging and naming takes quite
</I>&gt;<i>     a bit of effort and thought.
</I>
	Agreed.

&gt;<i> 3.  I can help convert your public interfaces to use Deferreds, and I 
</I>&gt;<i>     can rewrite your examples to use flow (so that they are more
</I>&gt;<i>     readable).    In particular, I was playing with a flow version
</I>&gt;<i>     of your ldap client and it makes things quite clean; to use
</I>&gt;<i>     the client you have a generator which yield ldap commands...
</I>
	Thank you for that.

	Please, no flow rewrites for Ldaptor as of now; when flow has
	been in use in Twisted core protocols for ~ 3 months, we can
	talk again.

&gt;<i>     If I'm to help, I'll need commit access and you can't be 
</I>&gt;<i>     completely opposed to me restructuring/commenting things as
</I>&gt;<i>     I move along.   If you need an example of my work, see flow.py
</I>
	I think we got a good start on that in IRC.

	I hope to make ldaptor cleaner and clearer. Any help from
	you is welcome.

	Of course, I still get to review your changes and bitch about
	them ;)

&gt;<i> Anyway, I'm curious how open you are to these items.   Adding this to
</I>&gt;<i> Twisted (with alot of work) is probably a good bargin; you get more
</I>&gt;<i> eyes helping your project along, documentation, etc.  
</I>
	I have long hoped for some other developers to share the work.

	But no, I will not donate &gt;10000 lines of my work to glyph.
	I'm too much a free software bigot; I want to force him to
	the rules of LGPL. Just like everyone else. In fact, that's
	why I still consider him to have a partial copyright on Ldaptor,
	even though he wrote none of it; that makes _me_ faithful to
	the LGPL, too. And that's a good thing.

	Oh, by the way, you are horribly naive for thinking that
	merely having the code located in the Twisted CVS makes
	everyone else maintain it. That just isn't the way things
	have happened. LDAP is not a core protocol for most people.

-- 
:<i>(){ :|:&amp;};:
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004833.html">[Twisted-Python] windows binary install.
</A></li>
	<LI>Next message: <A HREF="004830.html">[Twisted-Python] ldaptor feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4829">[ date ]</a>
              <a href="thread.html#4829">[ thread ]</a>
              <a href="subject.html#4829">[ subject ]</a>
              <a href="author.html#4829">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
