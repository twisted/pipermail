<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] submodel caching in woven
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20submodel%20caching%20in%20woven&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005203.html">
   <LINK REL="Next"  HREF="005209.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] submodel caching in woven</H1>
    <B>Michael Shyne</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20submodel%20caching%20in%20woven&In-Reply-To="
       TITLE="[Twisted-Python] submodel caching in woven">devmail at crazydiamonds.com
       </A><BR>
    <I>Sat Jul 26 20:22:37 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005203.html">[Twisted-Python] Considering Twisted for OfflineIMAP
</A></li>
        <LI>Next message: <A HREF="005209.html">[Twisted-Python] How can ftpclient.py work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5208">[ date ]</a>
              <a href="thread.html#5208">[ thread ]</a>
              <a href="subject.html#5208">[ subject ]</a>
              <a href="author.html#5208">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm trying to create a web-app in woven using already existing data
objects.  I'm starting by just trying to display a name.  This is what
I've done:

components.registerAdapter(model.ObjectWrapper, myObj, interfaces.IModel)
class DisplayObj(page.Page):

    templateFile = &quot;display-obj.html&quot;

    def wmfactory_obj(self, request):
        id = request.args.get('id', (0,))[0]

        if id:
            return objFactory.getObj(id)

        return None

The template only referes to &quot;obj/name&quot;.  This all works fine... except
when I change the id in the URL and reload the page.  The name displayed
doesn't change.  The problem is with the submodel caching in the root
model (the page).  I've attached the changes I made to fix it.  I'm new to
woven (and twisted in general) so I don't know if I'm doing something
wrong, or if my changes have far-reaching effects.

I should note that these changes merely improved the situation to mostly
working (which, of course, is much better than never working).  The
caching is keyed off of &quot;id(request)&quot;.  However, it seems there is object
caching occuring with the request objects, &quot;id(request)&quot; often returns
identical results.  I believe that the submodel caching will also have to
look at a timestamp to work consistently.  This was too big of a change to
make at this point.  But if the list agrees with my current changes and
thinks adding a timestamp comparison is the right way to go, I would be
more than happy to do it.

-Michael Shyne

-------------- next part --------------
A non-text attachment was scrubbed...
Name: model.diff
Type: application/octet-stream
Size: 607 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20030726/1966f68a/attachment.obj">http://twistedmatrix.com/pipermail/twisted-python/attachments/20030726/1966f68a/attachment.obj</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005203.html">[Twisted-Python] Considering Twisted for OfflineIMAP
</A></li>
	<LI>Next message: <A HREF="005209.html">[Twisted-Python] How can ftpclient.py work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5208">[ date ]</a>
              <a href="thread.html#5208">[ thread ]</a>
              <a href="subject.html#5208">[ subject ]</a>
              <a href="author.html#5208">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
