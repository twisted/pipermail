<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Explicit disconnect from pb
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Explicit%20disconnect%20from%20pb&In-Reply-To=%3C3F1CB956.5010104%40yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037652.html">
   <LINK REL="Next"  HREF="037655.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Explicit disconnect from pb</H1>
    <B>Rene Dudfield</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Explicit%20disconnect%20from%20pb&In-Reply-To=%3C3F1CB956.5010104%40yahoo.com%3E"
       TITLE="[Twisted-Python] Explicit disconnect from pb">illumen at yahoo.com
       </A><BR>
    <I>Mon Jul 21 22:11:02 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037652.html">[Twisted-Python] Explicit disconnect from pb
</A></li>
        <LI>Next message (by thread): <A HREF="037655.html">[Twisted-Python] Explicit disconnect from pb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37657">[ date ]</a>
              <a href="thread.html#37657">[ thread ]</a>
              <a href="subject.html#37657">[ subject ]</a>
              <a href="author.html#37657">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Uwe C. Schroeder wrote:

&gt;<i>On Monday 21 July 2003 06:35 pm, Andrew Bennetts wrote:
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>On Mon, Jul 21, 2003 at 06:21:05PM -0700, Uwe C. Schroeder wrote:
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Hi,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I looked qround, but I can't find any information on how to disconnect
</I>&gt;&gt;&gt;<i>from a pb session without ending the client.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I have a service which I'm connecting to. Some time later I want to
</I>&gt;&gt;&gt;<i>disconnect from this service to free up ressources ( the service keeps
</I>&gt;&gt;&gt;<i>database connections etc, and I want to get rid of them ).
</I>&gt;&gt;&gt;<i>The only thing I have on the client side is a remotereference to the
</I>&gt;&gt;&gt;<i>perspective instance. So how do I disconnect from something I don't have
</I>&gt;&gt;&gt;<i>a reference to ? Somehow there must be something I can call to disconnect
</I>&gt;&gt;&gt;<i>the session (and on the server side trigger the disconnect handlers)
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>This sounds related to this bug:
</I>&gt;&gt;<i>    <A HREF="http://twistedmatrix.com/bugs/issue62">http://twistedmatrix.com/bugs/issue62</A>
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Yep, sound like it.
</I>&gt;<i>What I just tried ( and what partially works, at least for my purpose) is to 
</I>&gt;<i>have a perspective_disconnect method in the perspective class which just 
</I>&gt;<i>free's up the ressources I want to get rid of. certainly the connection still 
</I>&gt;<i>hangs around until I close the client. I my case droping the database 
</I>&gt;<i>connection which is no longer in use is more of a concern, so that works for 
</I>&gt;<i>me. (each client opens 2 database connections at startup - one is solely for 
</I>&gt;<i>login and gui definitions and has no password, the second is started after 
</I>&gt;<i>login. Therefor I don't need the first connection anymore. But I need to 
</I>&gt;<i>close the db connection since this server is intended to serve possibly up to 
</I>&gt;<i>500 clients at a time, which would be 500 useless db connections)
</I>&gt;<i>
</I>&gt;<i>	UC
</I>&gt;<i>  
</I>&gt;<i>
</I>
I was asking a very similar question yesterday on irc.

My problem was if a client connects to the server and does nothing, how 
do I disconnect it if I want to(from the server).

Radix came up with the suggestion of
&quot;&quot;&quot;
best idea I can think of is to only put a single method on your Root 
object which returns a Referenceable that has your &quot;real&quot; client interface
...
 implement a remote_login(self, clientobj) method on your pb.Root that 
returns a Referenceable that actually gives access to your app
...
 the client will need to implement a small Referenceable that implements 
`remote_ping' and it needs to pass it to that `login' method on the Root 
so it can get back the app interface object
&quot;&quot;&quot;

That still doesn't allow you to take care of misbehaving clients which 
never make calls.  But it should allow you do disconnect clients which 
log in.  As it will allow you to ping it over pb occasionally to make 
sure it is still there.






</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037652.html">[Twisted-Python] Explicit disconnect from pb
</A></li>
	<LI>Next message (by thread): <A HREF="037655.html">[Twisted-Python] Explicit disconnect from pb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37657">[ date ]</a>
              <a href="thread.html#37657">[ thread ]</a>
              <a href="subject.html#37657">[ subject ]</a>
              <a href="author.html#37657">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
