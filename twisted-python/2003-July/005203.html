<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Considering Twisted for OfflineIMAP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Considering%20Twisted%20for%20OfflineIMAP&In-Reply-To=20030726134815.GA26482%40complete.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005207.html">
   <LINK REL="Next"  HREF="005208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Considering Twisted for OfflineIMAP</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Considering%20Twisted%20for%20OfflineIMAP&In-Reply-To=20030726134815.GA26482%40complete.org"
       TITLE="[Twisted-Python] Considering Twisted for OfflineIMAP">tv at twistedmatrix.com
       </A><BR>
    <I>Sat Jul 26 12:35:03 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="005207.html">[Twisted-Python] Re: Considering Twisted for OfflineIMAP
</A></li>
        <LI>Next message: <A HREF="005208.html">[Twisted-Python] submodel caching in woven
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5203">[ date ]</a>
              <a href="thread.html#5203">[ thread ]</a>
              <a href="subject.html#5203">[ subject ]</a>
              <a href="author.html#5203">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Jul 26, 2003 at 08:48:15AM -0500, John Goerzen wrote:
&gt;<i> My first plan was to just rewrite imaplib, which wouldn't be too
</I>&gt;<i> hard.  But someone on the OfflineIMAP list pointed me to Twisted,
</I>&gt;<i> which I observe already contains an IMAP library that looks nice, plus
</I>&gt;<i> a different paradigm that may spare me from the whole thread groups
</I>&gt;<i> question altogether.
</I>
	Oooh! I'm very motivated to helping you; I've used offlineimap
	for a long time now, and I think I grok Twisted reasonably
	well.

	We're on IRC at #twisted on freenode. I'd be happy to help you
	while you are getting to know twisted.

	Andrew gave pretty good answers already, so I'll keep my
	answers short.

&gt;<i> 1. How does Twisted interact with things like threads and connection
</I>&gt;<i>    pooling?
</I>
	You really don't want to use threads; Twisted gives you everything
	you need to implement offlineimap asynchronously.

	(There is e.g. deferToThread, used when interfacing to e.g. database
	APIs that block, but that really should not be used if possible.)

&gt;<i>    I currently let the user control the maximum number of connections
</I>&gt;<i>    that are open to a given server, and whenever the code needs to
</I>&gt;<i>    access an IMAP server, it grabs a connection from the appropriate
</I>&gt;<i>    pool and uses it (using threading primitives to block if no
</I>&gt;<i>    connection is available.)  Can Twisted handle multiple connections
</I>&gt;<i>    to multiple servers doing multiple things at once?  Can it do
</I>&gt;<i>    connection pools?  If it needs threading to do these things, does
</I>&gt;<i>    it play nice with it?
</I>
	That should be pretty doable, not with thread pooling but by just
	counting the currently open IMAP connections and when the number
	is below the limit, taking more work from a queue and starting
	to process it (asynchronously).

&gt;<i> 4. The howto &quot;book&quot; alludes to pending improvements on the mail
</I>&gt;<i>    infrastructure.  Anything I should be aware of here?
</I>
	I believe much of that has already happened.

&gt;<i> 5. Is there any sort of unified mail API in Twisted (like JavaMail)
</I>&gt;<i>    that would present me with a single API to both IMAP and Maildir
</I>&gt;<i>    repositories, or is that something I need to do on my own?  (I've
</I>&gt;<i>    already done it, so it's no big deal to do that again)
</I>
	Well, see twisted.protocols.imap4.IMailbox for _something_.

&gt;<i> 6. OfflineIMAP supports several different user interfaces (two written
</I>&gt;<i>    with Tkinter, 1 using Curses, and three plain console ones.)  I would
</I>&gt;<i>    like to reimplement the Tkinter ones with wxPython, and am glad to
</I>&gt;<i>    see that Twisted works well with this.
</I>&gt;<i> 
</I>&gt;<i>    One concern, though, is that the users can supply a list of UIs to try
</I>&gt;<i>    in the config file: for instance, Tk, Curses, Noninteractive.  The
</I>&gt;<i>    system will try each one in turn until it reaches one that works.
</I>&gt;<i>    (For instance, Tk may not work if the user is not in X, and Curses
</I>&gt;<i>    may not work if stdout is not a tty).  It looks like this may be
</I>&gt;<i>    problematic with Twisted since the UI selection always seems to be
</I>&gt;<i>    known in advance with the import commands related to the reactor.
</I>&gt;<i>    Any thoughts here?
</I>
	Hmm. It seems you'd need to read the configuration before starting
	the reactor (event loop). That should be enough.

-- 
:<i>(){ :|:&amp;};:
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005207.html">[Twisted-Python] Re: Considering Twisted for OfflineIMAP
</A></li>
	<LI>Next message: <A HREF="005208.html">[Twisted-Python] submodel caching in woven
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5203">[ date ]</a>
              <a href="thread.html#5203">[ thread ]</a>
              <a href="subject.html#5203">[ subject ]</a>
              <a href="author.html#5203">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
