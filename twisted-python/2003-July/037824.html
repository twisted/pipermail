<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] the right way of unit testing protocols
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20the%20right%20way%20of%20unit%20testing%20protocols&In-Reply-To=%3C20030801012130.GA32720%40frobozz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037819.html">
   <LINK REL="Next"  HREF="037776.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] the right way of unit testing protocols</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20the%20right%20way%20of%20unit%20testing%20protocols&In-Reply-To=%3C20030801012130.GA32720%40frobozz%3E"
       TITLE="[Twisted-Python] the right way of unit testing protocols">andrew-twisted at puzzling.org
       </A><BR>
    <I>Thu Jul 31 19:21:30 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037819.html">[Twisted-Python] the right way of unit testing protocols
</A></li>
        <LI>Next message (by thread): <A HREF="037776.html">[Twisted-Python] problems with callback in an iteration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37824">[ date ]</a>
              <a href="thread.html#37824">[ thread ]</a>
              <a href="subject.html#37824">[ subject ]</a>
              <a href="author.html#37824">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Jul 31, 2003 at 10:43:55PM +0300, Tommi Virtanen wrote:
&gt;<i> On Thu, Jul 31, 2003 at 11:03:07AM -0400, Itamar Shtull-Trauring wrote:
</I>&gt;<i> &gt; &gt; 	Opening TCP sockets in unit tests is just not _unit_ testing
</I>&gt;<i> &gt; &gt; 	in my book. Please don't do it in unit tests. It just makes it
</I>&gt;<i> &gt; &gt; 	harder to run your unit tests in varying environments. (Who
</I>&gt;<i> &gt; &gt; 	says I allow you to bind to port 1234? Who says it's free?
</I>&gt;<i> &gt; &gt; 	Who says I allow you to listen *at all*?)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Most of Twisted's unittests listen on 0 and then figure out which port
</I>&gt;<i> &gt; was bound to. 
</I>&gt;<i> 
</I>&gt;<i> 	Which is mostly the reason why I'm bitch about it on _this_
</I>&gt;<i> 	mailing list.
</I>&gt;<i> 
</I>&gt;<i> 	I dislike that method. I really do.
</I>&gt;<i> 
</I>&gt;<i> 	There have been _months_ during which certain twisted unit
</I>&gt;<i> 	tests randomly fail; many of those have been due to
</I>&gt;<i> 	interaction with local TCP stack, networking, firewall and
</I>&gt;<i> 	miscellanous experimental security features.
</I>
I've *never* seen a failure due to listening on 0, either on my own
machines, or on the buildslaves, or reports on this list or IRC.  I'd be
inclined to agree with you if there was actually some evidence of a problem.

I *have* seen failures due to assuming that a *particular* port is
available, and that's definitely a no-no, because it could legitimately be
in use (especially if someone else is running tests on the same machine! :).
That's why none of the Twisted unit tests do this anymore.  Listening on 0
(as our TCP tests do, and as twisted.protocols.loopback.loopbackTCP does)
asks the OS to use any available port it likes, and I've never seen it fail.

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037819.html">[Twisted-Python] the right way of unit testing protocols
</A></li>
	<LI>Next message (by thread): <A HREF="037776.html">[Twisted-Python] problems with callback in an iteration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37824">[ date ]</a>
              <a href="thread.html#37824">[ thread ]</a>
              <a href="subject.html#37824">[ subject ]</a>
              <a href="author.html#37824">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
