<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Considering Twisted for OfflineIMAP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Considering%20Twisted%20for%20OfflineIMAP&In-Reply-To=%3C20030726153605.GB3046%40frobozz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037709.html">
   <LINK REL="Next"  HREF="037712.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Considering Twisted for OfflineIMAP</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Considering%20Twisted%20for%20OfflineIMAP&In-Reply-To=%3C20030726153605.GB3046%40frobozz%3E"
       TITLE="[Twisted-Python] Considering Twisted for OfflineIMAP">andrew-twisted at puzzling.org
       </A><BR>
    <I>Sat Jul 26 09:36:05 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037709.html">[Twisted-Python] Considering Twisted for OfflineIMAP
</A></li>
        <LI>Next message (by thread): <A HREF="037712.html">[Twisted-Python] Re: Considering Twisted for OfflineIMAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37710">[ date ]</a>
              <a href="thread.html#37710">[ thread ]</a>
              <a href="subject.html#37710">[ subject ]</a>
              <a href="author.html#37710">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Jul 26, 2003 at 08:48:15AM -0500, John Goerzen wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I am the author of OfflineIMAP, a multi-threaded multi-account
</I>&gt;<i> bi-directional synchronization tool
</I>&gt;<i> (<A HREF="http://quux.org/devel/offlineimap">http://quux.org/devel/offlineimap</A>) written in Python.
</I>
Ooh, nifty :)

[...]
&gt;<i> 
</I>&gt;<i> My questions, then, are these:
</I>&gt;<i> 
</I>&gt;<i> 1. How does Twisted interact with things like threads and connection
</I>&gt;<i>    pooling?
</I>&gt;<i>    
</I>&gt;<i>    I currently let the user control the maximum number of connections
</I>&gt;<i>    that are open to a given server, and whenever the code needs to
</I>&gt;<i>    access an IMAP server, it grabs a connection from the appropriate
</I>&gt;<i>    pool and uses it (using threading primitives to block if no
</I>&gt;<i>    connection is available.)  Can Twisted handle multiple connections
</I>&gt;<i>    to multiple servers doing multiple things at once?  Can it do
</I>&gt;<i>    connection pools?  If it needs threading to do these things, does
</I>&gt;<i>    it play nice with it?
</I>
Twisted uses non-blocking sockets, so it can do an arbitrary amount of
connections (both client and server) without any threads.  Running multiple
clients (or servers) at a time is as easy as calling reactor.connectTCP more
than once.

[What happened to question 2?]

&gt;<i> 3. I notice the &quot;Deferred&quot; object and the benefits it provides when a
</I>&gt;<i>    server response is expected to take some time.  I assume that some
</I>&gt;<i>    sort of internal threading is taking place here?
</I>
No threading.  Deferreds aren't magical at all.  Deferreds are simply an
object a function can return to say &quot;I don't have a result ready yet; as
soon as I've got it, I'll let you know.&quot;  The caller can then register
callbacks and errbacks that will be called when the result does become
available.

How the Deferred eventually gets called is up to the code that originally
created it; it might be the result of query sent to the network being
answered (e.g. twisted.web.client.getPage), a spawned process terminating
(e.g. twisted.internet.utils.getProcessOutput), a function call in another
thread completing (e.g. twisted.internet.threads.deferToThread), and so on.

&gt;<i>    What if the server *request* takes some time -- say, uploading a
</I>&gt;<i>    2MB e-mail over a dialup link.  Are we still OK with handling that
</I>&gt;<i>    in a non-blocking fashion?
</I>
Absolutely!  Twisted handles large transfers via a consumer/producer
interface, though, rather than with Deferreds (which are one-shot results,
rather than streaming).

&gt;<i> 4. The howto &quot;book&quot; alludes to pending improvements on the mail
</I>&gt;<i>    infrastructure.  Anything I should be aware of here?
</I>
Jp has been doing a lot of great work on this recently -- you should
definitely be working with CVS rather than 1.0.6 if you can.  I don't know
much about the details, though.

&gt;<i> 5. Is there any sort of unified mail API in Twisted (like JavaMail)
</I>&gt;<i>    that would present me with a single API to both IMAP and Maildir
</I>&gt;<i>    repositories, or is that something I need to do on my own?  (I've
</I>&gt;<i>    already done it, so it's no big deal to do that again)
</I>
I've no idea -- Jp?

&gt;<i> 6. OfflineIMAP supports several different user interfaces (two written
</I>&gt;<i>    with Tkinter, 1 using Curses, and three plain console ones.)  I would
</I>&gt;<i>    like to reimplement the Tkinter ones with wxPython, and am glad to
</I>&gt;<i>    see that Twisted works well with this.
</I>&gt;<i> 
</I>&gt;<i>    One concern, though, is that the users can supply a list of UIs to try
</I>&gt;<i>    in the config file: for instance, Tk, Curses, Noninteractive.  The
</I>&gt;<i>    system will try each one in turn until it reaches one that works.
</I>&gt;<i>    (For instance, Tk may not work if the user is not in X, and Curses
</I>&gt;<i>    may not work if stdout is not a tty).  It looks like this may be
</I>&gt;<i>    problematic with Twisted since the UI selection always seems to be
</I>&gt;<i>    known in advance with the import commands related to the reactor.
</I>&gt;<i>    Any thoughts here?
</I>
I suspect this can be dealt with, but I'm not sure off the top of my head
how... hopefully someone else can help you here.

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037709.html">[Twisted-Python] Considering Twisted for OfflineIMAP
</A></li>
	<LI>Next message (by thread): <A HREF="037712.html">[Twisted-Python] Re: Considering Twisted for OfflineIMAP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37710">[ date ]</a>
              <a href="thread.html#37710">[ thread ]</a>
              <a href="subject.html#37710">[ subject ]</a>
              <a href="author.html#37710">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
