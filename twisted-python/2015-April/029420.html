<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] attribute error when I am trying to make one	factory to send data to another
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20attribute%20error%20when%20I%20am%20trying%20to%20make%20one%0A%09factory%20to%20send%20data%20to%20another&In-Reply-To=%3CCALgu0tiq%3DUYFYqrPRjv2vnD98hiRhQVUzJp%3D-TPpNxM9jUEApw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="061894.html">
   <LINK REL="Next"  HREF="061882.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] attribute error when I am trying to make one	factory to send data to another</H1>
    <B>Jessica Tsui</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20attribute%20error%20when%20I%20am%20trying%20to%20make%20one%0A%09factory%20to%20send%20data%20to%20another&In-Reply-To=%3CCALgu0tiq%3DUYFYqrPRjv2vnD98hiRhQVUzJp%3D-TPpNxM9jUEApw%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] attribute error when I am trying to make one	factory to send data to another">jesadjust at gmail.com
       </A><BR>
    <I>Tue Apr 28 09:14:36 MDT 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="061894.html">[Twisted-Python] revisiting onboarding
</A></li>
        <LI>Next message (by thread): <A HREF="061882.html">[Twisted-Python] attribute error when I am trying to make	one	factory to send data to another
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29420">[ date ]</a>
              <a href="thread.html#29420">[ thread ]</a>
              <a href="subject.html#29420">[ subject ]</a>
              <a href="author.html#29420">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am working on this messaging app and I would like to pass data from one
factory to another. I have been referencing to other answers provided in
other similar questions by trying to add a variable storing the data from
one factory then initiate another factory and write the data to it.
Unfortunately there is an error when i call the other class, and I cannot
figure out why. Is there anything I can do to fix it? I have been stuck in
here for quite a while

this is the error:

 receivermessage = self.factory.app.handle_message2(data)
 exceptions.AttributeError: MultiEcho instance has no attribute 'factory'

Here is the code:


import kivyfrom kivy.app import Appfrom kivy.uix.label import
Labelfrom kivy.uix.scatter import Scatterfrom kivy.uix.boxlayout
import BoxLayoutfrom kivy.uix.scrollview import ScrollViewfrom
kivy.uix.button import Buttonfrom kivy.graphics.vertex_instructions
import Rectanglefrom kivy.graphics.context_instructions import
Colorfrom kivy.graphics.instructions import Instructionfrom kivy.base
import runTouchAppfrom kivy.lang import Builderimport socketfrom
kivy.core.window import Windowimport pygameimport randomfrom
kivy.support import install_twisted_reactor

install_twisted_reactor()from twisted.internet import reactor, protocol
Window.size = (550, 400)
# monitoring wordlistwith open(&quot;wordlist.txt&quot;) as word_file:
    wordlist = list(word.strip().lower() for word in word_file)
# protocols for senderclass EchoProtocol(protocol.Protocol):
    &quot;&quot;&quot;This is just about the simplest possible protocol&quot;&quot;&quot;

    def dataReceived(self, data):
        &quot;As soon as any data is received, write it back.&quot;
        sendermessage = self.factory.app.handle_message(data)
        if sendermessage:
            self.transport.write(data)

            #this line here is the trouble maker that caused the error

MultiEcho().dataReceived(sendermessage) class EchoFactory(protocol.Factory):
protocol = EchoProtocol def __init__(self, app): self.app = app # protocols
for receiver class MultiEcho(protocol.Protocol): def connectionMade(self):
self.factory.echoers.append(self) def dataReceived(self, data):
receivermessage = self.factory.app.handle_message2(data) if receivermessage:
self.transport.write(data)

            #this line here is the trouble maker that caused the error
            EchoProtocol().dataReceived(receivermessage)

class MultiEchoFactory(protocol.Factory):
    protocol = MultiEcho

    def __init__(self, app):
        self.echoers = []
        self.app = app

class ServerApp(App):
    def build(self):
        self.layout = BoxLayout(orientation='vertical', spacing=10)

        self.label = Button(text='Censoring process begin\nBeware of
keyword &quot;umbrella&quot;\n ', color=[1.0, 1.0, 1.0, 1.0])
        self.label.color = [0.9, 0.2, 0.2, 1.0]

        self.upperscroll = Button(pos_hint={'x': 0, 'center_y': .5},
size_hint=(None, None))

        self.scatter = Scatter()

        self.displaybox = Label()
        self.displaybox.color = [0.4, 0.9, 0.4, 1.0]

        reactor.listenTCP(8000, EchoFactory(self))  # for sender
        reactor.listenTCP(8001, MultiEchoFactory(self))  # for receiver

        self.layout.add_widget(self.label)
        self.layout.add_widget(self.scatter)

        self.scatter.add_widget(self.displaybox)

        return self.layout

    def handle_message(self, msg):

        if any(word in msg.lower() for word in wordlist):

            self.displaybox.color = [0.9, 0.4, 0.4, 1.0]
            self.displaybox.text = &quot;content blocked&quot;
            self.label.text += &quot;Alert! Sender posts %s \n&quot; % msg


        else:
            self.label.text += &quot;Safe - sender posts %s \n&quot; % msg
            self.displaybox.color = [0.4, 0.9, 0.4, 1.0]
            self.displaybox.text = &quot;%s&quot; % msg

        msg = msg

        return msg

    def handle_message2(self, msg):

        if any(word in msg.lower() for word in wordlist):
            self.label.color = [0.8, 0.8, 0.5, 1.0]
            self.label.text += &quot;Alert! Receiver got %s \n&quot; % msg
        else:
            self.label.color = [0.2, 0.2, 1.0, 1.0]
            self.label.text += &quot;Safe - receiver sends %s \n&quot; % msg

        msg = msg

        return msg

if __name__ == '__main__':
    ServerApp().run()
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20150428/832941fd/attachment-0001.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20150428/832941fd/attachment-0001.html</A>&gt;
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="061894.html">[Twisted-Python] revisiting onboarding
</A></li>
	<LI>Next message (by thread): <A HREF="061882.html">[Twisted-Python] attribute error when I am trying to make	one	factory to send data to another
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29420">[ date ]</a>
              <a href="thread.html#29420">[ thread ]</a>
              <a href="subject.html#29420">[ subject ]</a>
              <a href="author.html#29420">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
