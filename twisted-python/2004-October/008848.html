<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Query output from pyPgSQL via Perspective Broker,	how?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Query%20output%20from%20pyPgSQL%20via%20Perspective%20Broker%2C%0A%09how%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008847.html">
   <LINK REL="Next"  HREF="008849.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Query output from pyPgSQL via Perspective Broker,	how?</H1>
    <B>Nicola Larosa</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Query%20output%20from%20pyPgSQL%20via%20Perspective%20Broker%2C%0A%09how%3F&In-Reply-To="
       TITLE="[Twisted-Python] Query output from pyPgSQL via Perspective Broker,	how?">nico at tekNico.net
       </A><BR>
    <I>Wed Oct 20 04:26:22 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008847.html">[Twisted-Python] Oops ...
</A></li>
        <LI>Next message: <A HREF="008849.html">[Twisted-Python] Re: Query output from pyPgSQL via Perspective	Broker, how?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8848">[ date ]</a>
              <a href="thread.html#8848">[ thread ]</a>
              <a href="subject.html#8848">[ subject ]</a>
              <a href="author.html#8848">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a pyPgSQL-Twisted mixed question, I post it here because I recently
saw Gerard Haering posting, hi Gerard. :-)

I'm trying to remotely send the PostgreSQL query output from pyPgSQL via
Perspective Broker, and finding it difficult to prevent all the
InsecureJelly exceptions. I'm trying to avoid modifying hundreds of already
written queries, and I'm patching pyPgSQL instead (albeit at runtime).

A first problem is that the make_PgResultSetClass factory function
dinamically builds a subclass of the PgResultSet class, making it
impossible to statically subclass it with pb.Copyable and pb.RemoteCopy . I
worked around that making the make_PgResultSetClass return an object of the
PgResultSet class, instead of a new subclass. This seems to work.

Now I'm fighting against all the pyPgSQL special types. I'm changing the
typecast method in the TypeCache class to return only standard types, and
while it works fine for number and strings, it seems that mx.DateTime and
PG_INET values are not intercepted.

I convert the mx.DateTime and mx.DateTimeDelta instances into standard
datetime and timedelta ones, since the Twisted docs says PB already knows
those. I also added a check for PG_INET, returning str(value) in that case.
I'm still getting InsecureJelly exceptions for these two data types,
though.

I feel like I'm following the tough road doing this, maube there's a simpler
way of achieving what I need. Any suggestions? Thanks in advance.

[P.S.: the .sig was not manually chosen, just happened. ;-) ]

-- 
Nicola Larosa - <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">nico at tekNico.net</A>

With Twisted, you don't need threads. You don't want threads. Threads 
are actually harmful: <A HREF="http://www.kuro5hin.org/story/2002/11/18/22112/860">http://www.kuro5hin.org/story/2002/11/18/22112/860</A>
 -- Jonathan Lange, August 2004





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008847.html">[Twisted-Python] Oops ...
</A></li>
	<LI>Next message: <A HREF="008849.html">[Twisted-Python] Re: Query output from pyPgSQL via Perspective	Broker, how?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8848">[ date ]</a>
              <a href="thread.html#8848">[ thread ]</a>
              <a href="subject.html#8848">[ subject ]</a>
              <a href="author.html#8848">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
