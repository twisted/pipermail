<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] reactor.stop() won't, threads and Queue to blame?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20reactor.stop%28%29%20won%27t%2C%20threads%20and%20Queue%20to%20blame%3F&In-Reply-To=20041025090718.GG5033%40frobozz">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008903.html">
   <LINK REL="Next"  HREF="008905.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] reactor.stop() won't, threads and Queue to blame?</H1>
    <B>Brett Viren</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20reactor.stop%28%29%20won%27t%2C%20threads%20and%20Queue%20to%20blame%3F&In-Reply-To=20041025090718.GG5033%40frobozz"
       TITLE="[Twisted-Python] reactor.stop() won't, threads and Queue to blame?">bv at bnl.gov
       </A><BR>
    <I>Mon Oct 25 12:41:12 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008903.html">[Twisted-Python] reactor.stop() won't, threads and Queue to blame?
</A></li>
        <LI>Next message: <A HREF="008905.html">[Twisted-Python] reactor.stop() won't, threads and Queue to blame?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8904">[ date ]</a>
              <a href="thread.html#8904">[ thread ]</a>
              <a href="subject.html#8904">[ subject ]</a>
              <a href="author.html#8904">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrew Bennetts &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">andrew-twisted at puzzling.org</A>&gt; writes:

&gt;<i> Yep, that's the problem here.  Change this:
</I>&gt;<i>     d.callback(meth(*a,**k))
</I>&gt;<i> to this:
</I>&gt;<i>     reactor.callFromThread(d.callback, meth(*a, **k))
</I>&gt;<i>
</I>&gt;<i> (Or perhaps less confusingly:
</I>&gt;<i>     result = meth(*a, **kw)
</I>&gt;<i>     reactor.callFromThread(d.callback, result)
</I>&gt;<i> )
</I>
Yes, that did it.

&gt;<i> There's no reason why Deferreds wouldn't work in another thread, if that's
</I>&gt;<i> what you want.  It's just that generally it's not what you want...
</I>
In this case the Deferred is used as a return value for Twisted's
XML-RPC server implementation.  I go to this trouble of a CommandQueue
because my system blurs the distinction between server and client and
this was leading to deadlocks.  This CommandQueue should make sure
that all the troublesome communications are atomic.

Thanks to both you and Clark for your help.

-Brett.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008903.html">[Twisted-Python] reactor.stop() won't, threads and Queue to blame?
</A></li>
	<LI>Next message: <A HREF="008905.html">[Twisted-Python] reactor.stop() won't, threads and Queue to blame?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8904">[ date ]</a>
              <a href="thread.html#8904">[ thread ]</a>
              <a href="subject.html#8904">[ subject ]</a>
              <a href="author.html#8904">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
