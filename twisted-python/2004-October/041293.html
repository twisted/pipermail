<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Sending other things than strings in UDP packets
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Sending%20other%20things%20than%20strings%20in%20UDP%20packets&In-Reply-To=%3C20041008214212.GA13649%40ref.nmedia.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="041291.html">
   <LINK REL="Next"  HREF="041294.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Sending other things than strings in UDP packets</H1>
    <B>Paul Campbell</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Sending%20other%20things%20than%20strings%20in%20UDP%20packets&In-Reply-To=%3C20041008214212.GA13649%40ref.nmedia.net%3E"
       TITLE="[Twisted-Python] Sending other things than strings in UDP packets">paul at ref.nmedia.net
       </A><BR>
    <I>Fri Oct  8 15:42:12 MDT 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="041291.html">[Twisted-Python] Re: Sending other things than strings in UDP	packets
</A></li>
        <LI>Next message (by thread): <A HREF="041294.html">[Twisted-Python] Sending other things than strings in UDP packets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41293">[ date ]</a>
              <a href="thread.html#41293">[ thread ]</a>
              <a href="subject.html#41293">[ subject ]</a>
              <a href="author.html#41293">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Message: 5
</I>&gt;<i> Date: Thu, 7 Oct 2004 08:53:08 +1100
</I>&gt;<i> From: Christopher Armstrong &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">radeex at gmail.com</A>&gt;
</I>&gt;<i> Subject: Re: [Twisted-Python] Sending other things than strings in UDP
</I>&gt;<i> 	packets
</I>&gt;<i> To: Twisted general discussion &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&gt;
</I>&gt;<i> Message-ID: &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">60ed19d404100614531935658a at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=US-ASCII
</I>&gt;<i> 
</I>Christopher Armstrong &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">radeex at gmail.com</A>&gt; wrote:
&gt;<i> 
</I>&gt;<i> Ergh. Please don't do anything _close_ to suggesting this. This is not
</I>&gt;<i> the &quot;python way&quot;, it is the &quot;stupid, insecure,
</I>&gt;<i> let-people-rm-rf-your-home-directory way&quot;.
</I>
You apparently read part of the message and then you failed to read the
next paragraph, right? At the risk of being redundant, let me reiterate:

&quot;Read the documentation on the pickle module for more information. And be
forewarned: pickle will dump/load ANYTHING. For safety reasons, there's also
a 'safe_pickle' variant floating around.&quot;

I guess writing instructive and marginal (and probably nonworking) code for
helping out newbies is not what this mailing list is all about. I thought I
said &quot;nonworking&quot;, &quot;no error checking&quot;, and &quot;lots of issues&quot; enough times
to get the point across. Sorry, I'll &quot;mail.compose.elitist_mode=true&quot; next
time and give some flippant answer like &quot;UDP sucks dude. Just use PB under
TCP.&quot;

At the risk of leaving you hanging with regards to whether such variants
actually exist, below are pointers to two that can be used off the shelf, and
possibly a third already contained within the twisted code base.

Here's one variant that includes the a &quot;safe pickle&quot; call:
<A HREF="http://zgp.org/pipermail/p2p-hackers/2004-August/002046.html">http://zgp.org/pipermail/p2p-hackers/2004-August/002046.html</A>

Incidentally, the protocol contains a lot of the extras that I mentioned
my stripped-down code was lacking (as well as a few small bugs). It also
handles long messages and retries as well within UDP. It has an interesting
&quot;microprotocol&quot; sort of structure (where each layer of the protocol builds
on the previous one). Read it in addition to the first couple functions
that handle pickling/unpickling.

Another &quot;safe pickle&quot; module is buried in the code for &quot;thecircle&quot;
(www.thecircle.org.au). Just download it and rip out the &quot;safe_pickle.py&quot;
module from circlelib. It is stand-alone, and designed for UDP transportation
(although not currently using Twisted).

I haven't dug really deep, but banana (part of PB) appears to be essentially
yet another incarnation of exactly the same idea. The code pattern looked
identical to the two pieces of code I just mentioned. In fact, I haven't
looked at it but I suspect that even pickle itself has the same pattern,
other than being more generalized (it will handle executables and instances,
while the safe variants will reject that).

The code for all of these modules has an identical structure. It takes
a structure and walks down it. It reads each piece and codes it in a
&quot;Type+data&quot; format. It rejects anything that it can't inherently decode
without aid (such as class instances). In those cases, at least the banana
variant does allow the possibility to kick it up to a higher level (via
Jelly) to handle user-level structures.

The &quot;unpickle&quot; code does exactly the same thing except in reverse, converting
the coded data back into a structure. There are standards (S-expressions or
XML) for the format itself but I haven't seen any truly compelling reasons to
follow those. They seem to add lots of overhead without any additional benefit.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="041291.html">[Twisted-Python] Re: Sending other things than strings in UDP	packets
</A></li>
	<LI>Next message (by thread): <A HREF="041294.html">[Twisted-Python] Sending other things than strings in UDP packets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41293">[ date ]</a>
              <a href="thread.html#41293">[ thread ]</a>
              <a href="subject.html#41293">[ subject ]</a>
              <a href="author.html#41293">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
