<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] reactor.stop() won't, threads and Queue to blame?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20reactor.stop%28%29%20won%27t%2C%20threads%20and%20Queue%20to%20blame%3F&In-Reply-To=ir4fz42agyf.fsf%40minos.phy.bnl.gov">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008904.html">
   <LINK REL="Next"  HREF="008907.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] reactor.stop() won't, threads and Queue to blame?</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20reactor.stop%28%29%20won%27t%2C%20threads%20and%20Queue%20to%20blame%3F&In-Reply-To=ir4fz42agyf.fsf%40minos.phy.bnl.gov"
       TITLE="[Twisted-Python] reactor.stop() won't, threads and Queue to blame?">glyph at divmod.com
       </A><BR>
    <I>Mon Oct 25 13:32:02 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008904.html">[Twisted-Python] reactor.stop() won't, threads and Queue to blame?
</A></li>
        <LI>Next message: <A HREF="008907.html">[Twisted-Python] reactor.stop() won't, threads and Queue to blame?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8905">[ date ]</a>
              <a href="thread.html#8905">[ thread ]</a>
              <a href="subject.html#8905">[ subject ]</a>
              <a href="author.html#8905">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 2004-10-25 at 12:41 -0400, Brett Viren wrote:

&gt;<i> In this case the Deferred is used as a return value for Twisted's
</I>&gt;<i> XML-RPC server implementation.  I go to this trouble of a CommandQueue
</I>&gt;<i> because my system blurs the distinction between server and client and
</I>&gt;<i> this was leading to deadlocks.  This CommandQueue should make sure
</I>&gt;<i> that all the troublesome communications are atomic.
</I>
Doing things in threads almost always makes things *less* atomic than
just leaving them all in the main reactor thread.  Even if I'm totally
mistaken, I feel like I have to ask a few questions to make sure that
newbies don't stumble across this thread in the future and think they
need to start managing their own threadpools so Twisted won't
deadlock ;)

When you say you're &quot;blurring the distinction between server and
client&quot;, do you mean you're implementing something like an XMLRPC proxy,
where the server is itself a client, relaying requests elswhere and
waiting for their results?  Or something else?

Were you running requests in threads before you came up with the
CommandQueue abstraction?  If not, what caused the deadlocks?  How was
the client/server blurring related to the deadlocks?

Finally, did you consider an approach where, rather than queueing
commands, you just executed them synchronously and let the reactor
serialize them?  If so, what lead to the decision to change to a
thread-based approach?



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008904.html">[Twisted-Python] reactor.stop() won't, threads and Queue to blame?
</A></li>
	<LI>Next message: <A HREF="008907.html">[Twisted-Python] reactor.stop() won't, threads and Queue to blame?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8905">[ date ]</a>
              <a href="thread.html#8905">[ thread ]</a>
              <a href="subject.html#8905">[ subject ]</a>
              <a href="author.html#8905">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
