<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Status of current proxy support (of various	kinds)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Status%20of%20current%20proxy%20support%20%28of%20various%0A%09kinds%29&In-Reply-To=9C5743A2-0141-459B-B014-1B256A045B97%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024375.html">
   <LINK REL="Next"  HREF="024402.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Status of current proxy support (of various	kinds)</H1>
    <B>Kevin Horn</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Status%20of%20current%20proxy%20support%20%28of%20various%0A%09kinds%29&In-Reply-To=9C5743A2-0141-459B-B014-1B256A045B97%40twistedmatrix.com"
       TITLE="[Twisted-Python] Status of current proxy support (of various	kinds)">kevin.horn at gmail.com
       </A><BR>
    <I>Tue Aug  9 12:17:43 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="024375.html">[Twisted-Python] Status of current proxy support (of various	kinds)
</A></li>
        <LI>Next message: <A HREF="024402.html">[Twisted-Python] Status of current proxy support (of various kinds)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24376">[ date ]</a>
              <a href="thread.html#24376">[ thread ]</a>
              <a href="subject.html#24376">[ subject ]</a>
              <a href="author.html#24376">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Also, anyone working on socks5 in twisted should be aware of this project:

<A HREF="http://code.google.com/p/proxy65/">http://code.google.com/p/proxy65/</A>

which implements a SOCK5 server.  It's in the context of a Jabber/XMPP
XEP-0065 proxy server, but a lot of it should be applicable, if just as an
example.

I make no guarantees about the quality and/or correctness of the code, as
I've only skimmed it a couple of times.  I do know it predates the endpoint
API, and I doubt it has been updated.

(getting SOCS5 support into twisted has been on my 'maybe someday&quot; todo
list, and I was planning on looking at this in more detail as a reference).

It's MIT licensed.

Kevin Horn

On Mon, Aug 8, 2011 at 11:31 PM, Glyph Lefkowitz &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt;wrote:

&gt;<i> On Aug 8, 2011, at 10:10 PM, Peter Le Bek wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; Myself and another are working on adding SOCKS client support to Twisted
</I>&gt;<i> for
</I>&gt;<i> &gt; use in Tor related projects. I'm also convinced there's an abstraction
</I>&gt;<i> that would
</I>&gt;<i> &gt; make it easier to implement proxy clients (or any transparent
</I>&gt;<i> data/endpoint
</I>&gt;<i> &gt; modifying protocol) in Twisted. I agree that it's difficult to
</I>&gt;<i> generalise, but there's a
</I>&gt;<i> &gt; class of protocol that does one or more of the following, transparently,
</I>&gt;<i> and little
</I>&gt;<i> &gt; else:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - append data, before switching to application protocol (SSL handshake,
</I>&gt;<i> SOCKS connect/bind)
</I>&gt;<i> &gt; - prepend data, after losing connection on application protocol (SSL
</I>&gt;<i> shutdown)
</I>&gt;<i> &gt; - modify application data (SSL &quot;recordification&quot;, encryption)
</I>&gt;<i> &gt; - modify the endpoint (any proxy)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Endpoints can do all these things - SSL4ClientEndpoint, for example, does
</I>&gt;<i> the first
</I>&gt;<i> &gt; three - but does it make sense to use Endpoints for this purpose?
</I>&gt;<i>
</I>&gt;<i> I think so.
</I>&gt;<i>
</I>&gt;<i> &gt; Endpoints aren't stackable, so no good if I want to run a SOCKS client
</I>&gt;<i> over SSL.
</I>&gt;<i>
</I>&gt;<i> Sure they are.  There's no SOCKS endpoint yet, but if you were to implement
</I>&gt;<i> one, you could make it take another endpoint (or endpoint factory, as the
</I>&gt;<i> case may be) as an argument to its constructor.  The implementation of the
</I>&gt;<i> various current SSL* enpdoints would set a better example if it weren't for
</I>&gt;<i> the legacy connectSSL/listenSSL APIs.  However, those APIs are being slowly
</I>&gt;<i> phased out in favor of the endpoints themselves, as well as the internal
</I>&gt;<i> implementation being moved to use a wrapping / delegation approach &lt;
</I>&gt;<i> <A HREF="http://twistedmatrix.com/trac/ticket/4854">http://twistedmatrix.com/trac/ticket/4854</A>&gt; between transports and
</I>&gt;<i> protocols instead of OpenSSL's SSL-is-a-socket-except-when-it-isn't
</I>&gt;<i> strategy.
</I>&gt;<i>
</I>&gt;<i> &gt; Also, with a proxied connection you have two Endpoints, one to the proxy
</I>&gt;<i> server
</I>&gt;<i> &gt; and one 'virtual Endpoint' to wherever. The Endpoints API doesn't
</I>&gt;<i> accommodate
</I>&gt;<i> &gt; this.
</I>&gt;<i>
</I>&gt;<i> How doesn't it?  It's exactly this kind of API that endpoints were
</I>&gt;<i> _designed_ to accommodate - the original impetus to create them was the
</I>&gt;<i> Vertex project (now part of &lt;<A HREF="https://launchpad.net/divmod.org/">https://launchpad.net/divmod.org/</A>&gt;), which
</I>&gt;<i> proxies traffic in a variety of different ways.
</I>&gt;<i>
</I>&gt;<i> &gt; Would it make sense to have Endpoint wrappers for this purpose? A sort of
</I>&gt;<i> &gt; middleware (hate that word) to intercept transport events (including
</I>&gt;<i> transport
</I>&gt;<i> &gt; formation, i.e. Endpoint.connect()).
</I>&gt;<i>
</I>&gt;<i> It might make sense to have some utilities around this area.  There are
</I>&gt;<i> definitely parts of the process - especially producers and consumers - where
</I>&gt;<i> you have to write a lot of boilerplate code to make sure everything's hooked
</I>&gt;<i> up properly.  But it's all certainly _possible_ now with the existing
</I>&gt;<i> interfaces.
</I>&gt;<i>
</I>&gt;<i> You'd probably be interested in this ticket: &lt;
</I>&gt;<i> <A HREF="http://twistedmatrix.com/trac/ticket/3204">http://twistedmatrix.com/trac/ticket/3204</A>&gt;.  Perhaps you could submit a
</I>&gt;<i> patch? :)
</I>&gt;<i>
</I>&gt;<i> &gt; I'm looking forward to being proven wrong on this as it will make my
</I>&gt;<i> SOCKS work
</I>&gt;<i> &gt; easier, or else if this turns out to be interesting then I have more
</I>&gt;<i> ideas on how it
</I>&gt;<i> &gt; should be implemented.
</I>&gt;<i>
</I>&gt;<i> It would help with that proof if you would be a bit more precise about
</I>&gt;<i> where you think the current code falls short.
</I>&gt;<i>
</I>&gt;<i> -glyph
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20110809/4f55903b/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20110809/4f55903b/attachment.htm</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024375.html">[Twisted-Python] Status of current proxy support (of various	kinds)
</A></li>
	<LI>Next message: <A HREF="024402.html">[Twisted-Python] Status of current proxy support (of various kinds)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24376">[ date ]</a>
              <a href="thread.html#24376">[ thread ]</a>
              <a href="subject.html#24376">[ subject ]</a>
              <a href="author.html#24376">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
