<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] TCP: can't redo connectTCP() from same local port	if server did not explicitly close connection ??
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20TCP%3A%20can%27t%20redo%20connectTCP%28%29%20from%20same%20local%20port%0A%09if%20server%20did%20not%20explicitly%20close%20connection%20%3F%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019042.html">
   <LINK REL="Next"  HREF="019029.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] TCP: can't redo connectTCP() from same local port	if server did not explicitly close connection ??</H1>
    <B>Alessio Pace</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20TCP%3A%20can%27t%20redo%20connectTCP%28%29%20from%20same%20local%20port%0A%09if%20server%20did%20not%20explicitly%20close%20connection%20%3F%3F&In-Reply-To="
       TITLE="[Twisted-Python] TCP: can't redo connectTCP() from same local port	if server did not explicitly close connection ??">alessio.pace at gmail.com
       </A><BR>
    <I>Thu Jan 15 05:44:44 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019042.html">[Twisted-Python] django with twisted 8.2.x: 2009
</A></li>
        <LI>Next message: <A HREF="019029.html">[Twisted-Python] TCP: can't redo connectTCP() from same local	port if server did not explicitly close connection ??
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19028">[ date ]</a>
              <a href="thread.html#19028">[ thread ]</a>
              <a href="subject.html#19028">[ subject ]</a>
              <a href="author.html#19028">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I would like to have a client connect via TCP to a server (say, server &quot;A&quot;),
then the client close the connection and connect via TCP to another server
(say, server &quot;B&quot;) using the same TCP port that was bound locally while
connecting to &quot;A&quot;. And then this done over and over again switching from B
to A to B etc..

The fact is that it all works if both the client and the server do
transport.loseConnection() before the client tries to connect to the other
server from the same local port, instead if *only* the client does
transport.loseConnection(), I obtain:

[Failure instance: Traceback (failure with no frames): &lt;class
&gt;<i> 'twisted.internet.error.ConnectBindError'&gt;: Couldn't bind: 98: Address
</I>&gt;<i> already in use.
</I>

which it is strange to me as the next connectTCP() attempt is called in the
connectionLost() method of the client, so the socket should be closed
already.

For the very generous readers, I post at <A HREF="http://pastebin.com/m31b0d911">http://pastebin.com/m31b0d911</A> the
code which can be just executed in this way:

* on a terminal, for the server:  python tcp_listen_connect.py -server

* on another terminal, for the client:  python tcp_listen_connect.py -client
127.0.0.1

Comment/uncomment line number 21 to see the affected behaviour.

Sorry for the &quot;please download and verify&quot; approach, but it's 2 days I'm
struggling with it and I was wondering if there is really something I'm
doing wrong or it's just that it works like that.

Thanks in advance.
Regards,
Alessio Pace.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20090115/f5d71b63/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20090115/f5d71b63/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019042.html">[Twisted-Python] django with twisted 8.2.x: 2009
</A></li>
	<LI>Next message: <A HREF="019029.html">[Twisted-Python] TCP: can't redo connectTCP() from same local	port if server did not explicitly close connection ??
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19028">[ date ]</a>
              <a href="thread.html#19028">[ thread ]</a>
              <a href="subject.html#19028">[ subject ]</a>
              <a href="author.html#19028">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
