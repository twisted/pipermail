<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] connectionLost not always getting called?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20connectionLost%20not%20always%20getting%20called%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018985.html">
   <LINK REL="Next"  HREF="018990.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] connectionLost not always getting called?</H1>
    <B>Rob Bredow</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20connectionLost%20not%20always%20getting%20called%3F&In-Reply-To="
       TITLE="[Twisted-Python] connectionLost not always getting called?">rob at 185vfx.com
       </A><BR>
    <I>Sun Jan 11 18:55:03 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="018985.html">[Twisted-Python] Weekly Bug Summary
</A></li>
        <LI>Next message: <A HREF="018990.html">[Twisted-Python] connectionLost not always getting called?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18987">[ date ]</a>
              <a href="thread.html#18987">[ thread ]</a>
              <a href="subject.html#18987">[ subject ]</a>
              <a href="author.html#18987">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've implemented a twisted server using the basic.lineReceiver class.  The
client is a socket based client implemented in flash and the connections are
long-lived (minutes or hours).  To handle cleaning up the players when they
disconnect, I'm using the connectionLost function in my player class.  99%
of the time, things work as expected.

However in rare cases, connectionLost is not getting called when the
flash-based client disappears.  Even completely quitting the client's
web-browser does not always trigger a connectionLost call.  I tracked down
one specific instance yesterday where the server thought the client was
still connected even though the client had been gone for 30+ minutes--but
after a few hours the server noticed that the client was gone and then
connectionLost was called like normal.  That made me think that it might be
a problem on the server side and maybe not client related.

I'm starting on a workaround now where the client will issue a &quot;PING&quot; every
30 seconds and the server will use the ping information to manually trigger
loseConnection when needed.  Are there a better workarounds for this, better
practices or some error checking I can do to avoid these intermidant laggy
connectionLost calls?

Thanks in advance.

Rob

P.S.  I've found twisted to have incredible performance compared to
everything else we've tried.  If you're interested you can see the client at
<A HREF="http://www.guessasketch.com/">http://www.guessasketch.com/</A> .  I'm happy to post server code excerpts if it
would be helpful.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20090111/c9112933/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20090111/c9112933/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018985.html">[Twisted-Python] Weekly Bug Summary
</A></li>
	<LI>Next message: <A HREF="018990.html">[Twisted-Python] connectionLost not always getting called?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18987">[ date ]</a>
              <a href="thread.html#18987">[ thread ]</a>
              <a href="subject.html#18987">[ subject ]</a>
              <a href="author.html#18987">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
