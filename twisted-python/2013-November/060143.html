<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Determine TLS version from within request handler	? (twisted web)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Determine%20TLS%20version%20from%20within%20request%20handler%0A%09%3F%20%28twisted%20web%29&In-Reply-To=%3C8c39dc05b2eb20388476cfdcc5836647.squirrel%40webmail.xs4all.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Determine TLS version from within request handler	? (twisted web)</H1>
    <B>Rob Meijer</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Determine%20TLS%20version%20from%20within%20request%20handler%0A%09%3F%20%28twisted%20web%29&In-Reply-To=%3C8c39dc05b2eb20388476cfdcc5836647.squirrel%40webmail.xs4all.nl%3E"
       TITLE="[Twisted-Python] Determine TLS version from within request handler	? (twisted web)">rmeijer at xs4all.nl
       </A><BR>
    <I>Wed Nov  6 04:43:24 MST 2013</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60143">[ date ]</a>
              <a href="thread.html#60143">[ thread ]</a>
              <a href="subject.html#60143">[ subject ]</a>
              <a href="author.html#60143">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using twisted web for an https connection. At first I start with
creating and configuring a ssl.DefaultOpenSSLContextFactory derived class
that disables SSLv2 and SSLv3. So (basically we're left with TLS1.0 and
up) and forces the use of a single strong (non RC4 but BEAST vulnerable)
cipher.

Than I have a http.HTTPFactory derived class with a 'buildProtocol'that
return a http.HTTPChannel derived object, that in turn returns a
http.Request derived object.

Than reactor.listenSSL is invoked with both the SSL factory and the HTTP
factory. Now my problem. I don't really understand how these two are
connected once the request handler gets invoked.

What I would like to do is that I would want to allow TLS1.0 users to use
the server, but only after explicitly agreeing that they understand the
risks involved with using an old BEAST vulnerable browser.

Is there any way to retrieve info on what TLS version has been negotiated
from within the HTTP request handler? I've been walking the 'self' object
a bit, and self.transport.getHandle() seems to have some tls stuff like
'get_cipher_list' and 'get_peer_certificate', but the simple TLS version
number does not seem to be available.

Is the twisted web API simply insuficient to retreive this information
from within the request handler, or am I missing something here?

T.I.A,

Rob



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60143">[ date ]</a>
              <a href="thread.html#60143">[ thread ]</a>
              <a href="subject.html#60143">[ subject ]</a>
              <a href="author.html#60143">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
