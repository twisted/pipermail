<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Returning a deferred from buildProtocol t.i.p.Factory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Returning%20a%20deferred%20from%20buildProtocol%0A%20t.i.p.Factory&In-Reply-To=%3C20131117200815.15706.211386549.divmod.xquotient.45%40top%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027730.html">
   <LINK REL="Next"  HREF="027718.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Returning a deferred from buildProtocol t.i.p.Factory</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Returning%20a%20deferred%20from%20buildProtocol%0A%20t.i.p.Factory&In-Reply-To=%3C20131117200815.15706.211386549.divmod.xquotient.45%40top%3E"
       TITLE="[Twisted-Python] Returning a deferred from buildProtocol t.i.p.Factory">exarkun at twistedmatrix.com
       </A><BR>
    <I>Sun Nov 17 13:08:15 MST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027730.html">[Twisted-Python] Returning a deferred from buildProtocol	t.i.p.Factory
</A></li>
        <LI>Next message: <A HREF="027718.html">[Twisted-Python] Ticket #1330 - Socks V5 functionality
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27731">[ date ]</a>
              <a href="thread.html#27731">[ thread ]</a>
              <a href="subject.html#27731">[ subject ]</a>
              <a href="author.html#27731">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05:44 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted at tomvn.com</A> wrote:
&gt;<i>Thanks for both those suggestions.
</I>&gt;<i>I'll be taking a closer look at txLoadbabancer when I get time as it 
</I>&gt;<i>looks
</I>&gt;<i>like it'll take care of a lot of my desired functionality out the box.
</I>&gt;<i>To get started tho I'll move my async routing decision call into the
</I>&gt;<i>protocol as suggested.
</I>&gt;<i>
</I>&gt;<i>Is there any reason why the internal calls to buildProtocol shouldn't 
</I>&gt;<i>be
</I>&gt;<i>wrapped in a maybeDeferred?
</I>
I'm not sure what you mean by &quot;internal&quot; here.  I think you might mean 
&quot;calls to buildProtocol made by reactor implementations&quot;.  It is a 
mistake to take this perspective, though.  If buildProtocol is allowed 
to return a Deferred sometimes then *all* callers have to be prepared to 
handle a Deferred (by using `maybeDeferred` or using some other 
strategy).

This points to the reason *buildProtocol* can't be allowed to return a 
Deferred.  It is already defined as not returning a Deferred and 
changing this definition would potentially break every call, both those 
in reactor implementations and elsewhere (and there are plenty of other 
places that call `buildProtocol`).

Whether there is any good reason we could not introduce a new interface 
that is like `buildProtocol` but is also allowed to return a Deferred is 
another (more interesting :) question.  I can't think of any offhand.

The reactor would probably want to avoid monitoring new connections for 
read or write events until this Deferred fired (but bonus points if it 
still monitors it for connection lost and cancels the Deferred if this 
happens before it fires).  That's all relatively straightforward to 
implement though, for someone sufficiently motivated.

Jean-Paul

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027730.html">[Twisted-Python] Returning a deferred from buildProtocol	t.i.p.Factory
</A></li>
	<LI>Next message: <A HREF="027718.html">[Twisted-Python] Ticket #1330 - Socks V5 functionality
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27731">[ date ]</a>
              <a href="thread.html#27731">[ thread ]</a>
              <a href="subject.html#27731">[ subject ]</a>
              <a href="author.html#27731">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
