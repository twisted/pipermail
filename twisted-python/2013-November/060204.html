<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] AMP Argument.toBox's proto argument is a locator, not the proto?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20AMP%20Argument.toBox%27s%20proto%20argument%20is%20a%0A%20locator%2C%20not%20the%20proto%3F&In-Reply-To=%3CCAE_Hg6Z5UdD7JY5MJUOaVXeVCB_wE%2Bs%3DJbUG7-%2B6JJuBvTxjfA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] AMP Argument.toBox's proto argument is a locator, not the proto?</H1>
    <B>Laurens Van Houtven</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20AMP%20Argument.toBox%27s%20proto%20argument%20is%20a%0A%20locator%2C%20not%20the%20proto%3F&In-Reply-To=%3CCAE_Hg6Z5UdD7JY5MJUOaVXeVCB_wE%2Bs%3DJbUG7-%2B6JJuBvTxjfA%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] AMP Argument.toBox's proto argument is a locator, not the proto?">_ at lvh.io
       </A><BR>
    <I>Wed Nov 20 09:50:53 MST 2013</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60204">[ date ]</a>
              <a href="thread.html#60204">[ thread ]</a>
              <a href="subject.html#60204">[ subject ]</a>
              <a href="author.html#60204">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>*deep necromantic thread magic*

On Thu, Oct 3, 2013 at 11:54 AM, Glyph &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt; wrote:

&gt;<i> If I can change &quot;proto&quot; to mean &quot;actually the protocol not something else&quot;
</I>&gt;<i> then that seems plenty easy to add, and it would definitely be cool if
</I>&gt;<i> people don't have to mess with this nonsense themselves for something as
</I>&gt;<i> ostensibly simple as having access to the protocol :-)
</I>&gt;<i>
</I>&gt;<i> Keep in mind that in the authentication case I mentioned, your post-auth
</I>&gt;<i> object may well subclass AMP and therefore &quot;actually&quot; be a protocol; but it
</I>&gt;<i> still won't have a transport.  What do you propose happen in that case?
</I>&gt;<i>
</I>
Isn't the post-auth object a box receiver? I mean, yes, it can be a box
receiver by virtue of subclassing AMP and therefore *secretly* being a
proto. I'd be totally fine (for my use case) to just have the transport
available somewhere :) (The transport that the AMP bytes are being sent
over; so not, say, a TCP transport underlying a TLS connection or
something.)

For fixing this (I'll file tickets if you confirm):

- ResponderLocator's behavior is pretty much just broken. It's using
Command.makeResponse. That says it wants an AMP. It's clearly just getting
a responder locator. However, it seems like the problem here is
makeResponse's crappy interface. It shouldn't want an AMP. So, we should
fix makeResponse's docstring, and all of the other cases where t.p.amp asks
for an AMP and shouldn't.
- The proto argument name is stupid. Can we fix it?
- There should be a new method on IArgumentType, parallel to fromBox (but
not toBox?), that gets a reference to the transport passed to it. If so:
where does it get that?

Does that sound about right?

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20131120/6f4c58cd/attachment-0002.html&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60204">[ date ]</a>
              <a href="thread.html#60204">[ thread ]</a>
              <a href="subject.html#60204">[ subject ]</a>
              <a href="author.html#60204">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
