<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Excel, Twisted, and wxPython
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Excel%2C%20Twisted%2C%20and%20wxPython&In-Reply-To=%3CFE33DCFC-9401-11D7-B9B9-000393C92466%40dalkescientific.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   <LINK REL="Next"  HREF="036825.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Excel, Twisted, and wxPython</H1>
    <B>Andrew Dalke</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Excel%2C%20Twisted%2C%20and%20wxPython&In-Reply-To=%3CFE33DCFC-9401-11D7-B9B9-000393C92466%40dalkescientific.com%3E"
       TITLE="[Twisted-Python] Excel, Twisted, and wxPython">dalke at dalkescientific.com
       </A><BR>
    <I>Sun Jun  1 01:23:51 MDT 2003</I>
    <P><UL>
        
        <LI>Next message (by thread): <A HREF="036825.html">[Twisted-Python] Excel, Twisted, and wxPython
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36824">[ date ]</a>
              <a href="thread.html#36824">[ thread ]</a>
              <a href="subject.html#36824">[ subject ]</a>
              <a href="author.html#36824">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

   I'm working on an add-in for Excel, under MS Windows.  This takes 
information
from the current selection and uses XML-RPC to call a remote server.

   The call may take a while, so I want to have a &quot;Cancel&quot; button.  I
decided to use wxPython for the GUI, with a modal dialog.  Basically,
a wxGauge (for the progress bar) and a &quot;Cancel&quot; button.

   The RPC call itself may take several minutes, so I need to use either
threads or Twisted, and obviously I decided on the latter.  (This is an
in-process add-in; I'm worried about using threads inside the Excel
process itself.)

   I can't figure out how to make this all work together.  There's some
support code in Twisted for wxPython, but it appears to only support
the main event loop, while I'm running a modal window, and never call
my wxApp's MainLoop.

   I tried replacing my wxDialog with a wxFrame, which kinda works, 
except
that the background is very strange.  It looks like it hasn't been
fully initialized.

   I've attached my code, in the hopes that someone here can help me
figure out what to do.

   BTW, Twisted's wxPython support subsumes wx's main loop code.  Is
there any reason there can't be an implementation which hooks into
wx's idle loop, so that users can decide who's in charge?  I think that
would actually fix my problem, since Modals (I think) process the
idle loop ...  Nope, I'm not clever enough to figure that out - my
attempt is attached as &quot;Progress2.py&quot;

					Andrew
					<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dalke at dalkescientific.com</A>

  
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Progress.py
Type: application/octet-stream
Size: 3780 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20030601/3e133d50/attachment-0004.obj&gt;
-------------- next part --------------

-------------- next part --------------
A non-text attachment was scrubbed...
Name: Progress2.py
Type: application/octet-stream
Size: 3784 bytes
Desc: not available
URL: &lt;/pipermail/twisted-python/attachments/20030601/3e133d50/attachment-0005.obj&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message (by thread): <A HREF="036825.html">[Twisted-Python] Excel, Twisted, and wxPython
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36824">[ date ]</a>
              <a href="thread.html#36824">[ thread ]</a>
              <a href="subject.html#36824">[ subject ]</a>
              <a href="author.html#36824">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
