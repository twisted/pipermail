<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Getting Stories Straight (RPYs)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Getting%20Stories%20Straight%20%28RPYs%29&In-Reply-To=%3C20030624094447.20513.qmail%40green.zadka.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037207.html">
   <LINK REL="Next"  HREF="037212.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Getting Stories Straight (RPYs)</H1>
    <B>Moshe Zadka</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Getting%20Stories%20Straight%20%28RPYs%29&In-Reply-To=%3C20030624094447.20513.qmail%40green.zadka.com%3E"
       TITLE="[Twisted-Python] Getting Stories Straight (RPYs)">m at moshez.org
       </A><BR>
    <I>Tue Jun 24 03:44:47 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037207.html">[Twisted-Python] Getting Stories Straight (RPYs)
</A></li>
        <LI>Next message (by thread): <A HREF="037212.html">[Twisted-Python] Getting Stories Straight (RPYs)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37209">[ date ]</a>
              <a href="thread.html#37209">[ thread ]</a>
              <a href="subject.html#37209">[ subject ]</a>
              <a href="author.html#37209">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24 Jun 2003, Philippe &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">lafou at wanadoo.fr</A>&gt; wrote:

&gt;<i> RPY seems to be a good starting point to me.
</I>
It isn't. That was itamar's point: don't use RPYs. It's not that they
are not useful, but...
OK, here's an analogy. When teaching kids correct table manners, you put
books under their arms, and tell them not to let the books fall. It's not
that being able to hold books while eating is a useful skill -- it's that
the books force the kid to constrain the movements of his hands.

In a similar way, not using RPYs will force you to think about the
correct way to build your application. If you feel yourself forced
to use RPY *avoid the temptation*, and know that what you're feeling
is actually a way to build the application *incorrectly*. If you're
still not sure what to do, ask advice -- here or on #twisted. But
in no case succumb to the &quot;just write RPYs&quot;.

You should only use RPY when you are able to build applications without
RPYs. This is why you see tools like Issues, say, use RPYs -- notice
how you *can* use Issues *without* RPYs.

&gt;<i> If I understand it well, I should have :
</I>&gt;<i> 
</I>&gt;<i> - xhtml templates.
</I>&gt;<i> - xhtml macro templates eventually.
</I>&gt;<i> - rpy files.
</I>&gt;<i> - py files.
</I>
NO!
You should *not* have RPY files
Some Python modules will be used for pure, non-web-related business
logic. Some Python modules will define resource trees which bind
together logic and presentation, for example by using Page instances
and defining wchild_* methods. Perhaps you'll find a need to write
an ApplicationService which holds various resources, usually not.
Notice the one thing missing from this paragraph: .rpy files. That's
right, you should not have *any* .rpy files. You *may* have need for
Python modules with long and tortorous functions like:

def buildBlogResource(
  realName,
  numberOfArticles,
  numberOfLines,
  colorScheme,
  ....
  ):
    blogObject = blog.DataRespository(...)
    root = blog.rootResource(blogObject)
    showArticles = blog.Show(blogObject)
    root.putChild('show', showArticles)
    # Notice how I use relative URLs here:
    updateArticlesForm = blog.UpdateForm(blogObject, url=&quot;doupdate&quot;)
    root.putChild('update', updateArticles)
    doUpdate = blog.DoUpdate(blogObject)
    root.putChild('doupdate', doUpdate)
    return root
    
But there should be *no* RPYs. Now, when testing, you might use a script
similar to

&quot;&quot;&quot;
#!/usr/bin/python2.2
from blog import buildBlogResource
from twisted.web import server
from twisted.internet import reactor

resource = buildBlogResource(&quot;Moshe&quot;, 10, 20, &quot;RED&quot;, ...)
reactor.listenTCP(8080, server.Site(resource))
&quot;&quot;&quot;

When you are done testing, you package your Python library. Now,
you may do several things:

1. Put a .rpy in your doc/examples which looks something like

&quot;&quot;&quot;
# change these lines to configure
name = &quot;Moshe&quot;
articles = 10
lines = 20
colorScheme = &quot;RED&quot;
...

# touch nothing below this line
from blog import buildBlogResource
resource = buildBlogResource(name, articles, lines, colorScheme, ...)
&quot;&quot;&quot;

2. Write a TAP plugin to easily generate blogs. See plugin.html for
   full details, I'll show an excerpt here:

&quot;&quot;&quot;&quot;
from blog import buildBlogResource

def updateApplication(app, config):
    name, articles, lines, colorScheme = (config['name'], config['articles'],
                                   config['lines'], config['colorScheme]')
    resource = buildBlogResource(name, articles, lines, colorScheme, ...)
    app.listenTCP(config['port'], server.Site(resource))
&quot;&quot;&quot;

Your users can now do

% mktap myblog --name=Moshe --colorScheme=RED
% twistd -f myblog

3. Supply a twisted-web Debian plugin, which looks like

&quot;&quot;&quot;
# change these lines to configure
name = &quot;Moshe&quot;
articles = 10
lines = 20
colorScheme = &quot;RED&quot;
...

# touch nothing below this line
from blog import buildBlogResource
resource = buildBlogResource(name, articles, lines, colorScheme, ...)
default.putChild('myblog', resource)
&quot;&quot;&quot;

Sitting in /etc/twisted-web/local.d/99myblog.py

4. Document buildBlogResource in your API docs, so savvy Twisted programmers
   can deliver more and better ways to integrate it with a Python app.
   For example, writing through-the-web management to add a blog to a site.

5. Write TRPs (Twisted Resource Pickles) command-line generators.

etc. etc. etc.

Please notice when the RPY arrived on the scene: a long time after
you had a fully functioning blog, and you were *documenting* it. This
is the proper time to think about deployment issues.
-- 
Moshe Zadka -- <A HREF="http://moshez.org/">http://moshez.org/</A>
Buffy: I don't like you hanging out with someone that... short.
Riley: Yeah, a lot of young people nowadays are experimenting with shortness.
Agile Programming Language -- <A HREF="http://www.python.org/">http://www.python.org/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037207.html">[Twisted-Python] Getting Stories Straight (RPYs)
</A></li>
	<LI>Next message (by thread): <A HREF="037212.html">[Twisted-Python] Getting Stories Straight (RPYs)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37209">[ date ]</a>
              <a href="thread.html#37209">[ thread ]</a>
              <a href="subject.html#37209">[ subject ]</a>
              <a href="author.html#37209">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
