<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Patch for twisted.protocols.nntp
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Patch%20for%20twisted.protocols.nntp&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004655.html">
   <LINK REL="Next"  HREF="004665.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Patch for twisted.protocols.nntp</H1>
    <B>Matthias Urlichs</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Patch%20for%20twisted.protocols.nntp&In-Reply-To="
       TITLE="[Twisted-Python] Patch for twisted.protocols.nntp">smurf at smurf.noris.de
       </A><BR>
    <I>Mon Jun 23 06:51:40 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004655.html">[Twisted-Python] Patch for twisted.protocols.nntp
</A></li>
        <LI>Next message: <A HREF="004665.html">[Twisted-Python] Patch for twisted.protocols.nntp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4658">[ date ]</a>
              <a href="thread.html#4658">[ thread ]</a>
              <a href="subject.html#4658">[ subject ]</a>
              <a href="author.html#4658">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, Jp Calderone wrote:

&gt;<i> Hmm, this is the only part of the patch I am unsure about.  The API
</I>&gt;<i> seems a little too tuned to your use-case.  I think the way to go for
</I>&gt;<i> this would be to have a Producer passed in and make the NNTP protocol a
</I>&gt;<i> Consumer for that (in turn acting as a Producer for its transport
</I>&gt;<i> object).  Would you be willing to make this change? (If you need an
</I>&gt;<i> example of how this might work, check out smtp.py)
</I>
Hmm. Looking at the SMTP case, it needs refactoring in that the producer
isn't decoupled from the file object it ends up reading, thus I can't plug
a different kind of producer in there.

Looking further, there's a slightly-broken data-from-file producer in
doc/historic/2003/pycon/twisted-internet/twisted-internet.py ...

Anyway, I need NNTP to be a streaming protocol. With a Deferred, this is
easy -- each Deferred gets a callback which writes TAKETHIS plus the
message to the server (and queues the result code recognition), so these
can complete in any order, which is very nice. A producer interface would
instead have an arbitrary number of producers, all of which are active,
but as soon as the first one returns anything I have to temporarily
deactivate all the others. That sounds dangerous -- what if a producer
can't be paused? Then I need to buffer their data, too, which is no
different from the current case where the article data also end up in
memory.

-- 
Matthias Urlichs   |   {M:U} IT Design @ m-u-it.de   |  <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">smurf at smurf.noris.de</A>
Disclaimer: The quote was selected randomly. Really. | <A HREF="http://smurf.noris.de">http://smurf.noris.de</A>
-- 
Man: I know how to please a woman.
Woman: Then please leave me alone.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004655.html">[Twisted-Python] Patch for twisted.protocols.nntp
</A></li>
	<LI>Next message: <A HREF="004665.html">[Twisted-Python] Patch for twisted.protocols.nntp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4658">[ date ]</a>
              <a href="thread.html#4658">[ thread ]</a>
              <a href="subject.html#4658">[ subject ]</a>
              <a href="author.html#4658">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
