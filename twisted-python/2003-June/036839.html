<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] HTTP versions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20HTTP%20versions&In-Reply-To=%3C6BBAEBF6-948C-11D7-B9B9-000393C92466%40dalkescientific.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="036836.html">
   <LINK REL="Next"  HREF="036844.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] HTTP versions</H1>
    <B>Andrew Dalke</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20HTTP%20versions&In-Reply-To=%3C6BBAEBF6-948C-11D7-B9B9-000393C92466%40dalkescientific.com%3E"
       TITLE="[Twisted-Python] HTTP versions">dalke at dalkescientific.com
       </A><BR>
    <I>Sun Jun  1 17:54:45 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="036836.html">[Twisted-Python] HTTP versions
</A></li>
        <LI>Next message (by thread): <A HREF="036844.html">[Twisted-Python] HTTP versions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36839">[ date ]</a>
              <a href="thread.html#36839">[ thread ]</a>
              <a href="subject.html#36839">[ subject ]</a>
              <a href="author.html#36839">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Itamar:
&gt;<i> I don't really care about this, working with real life code is more
</I>&gt;<i> important. But if you send me a patch I'll accept it.
</I>
I can send a patch, but I don't know the dependencies of clients
on having a version string over a 2-ple, which is what I would
prefer.

What about something like

class Version:
   def __init__(self, s, v):
     self.s = s  # a string, as in &quot;HTTP/1.1&quot;
     self.v = v  # a 2-ple, as in (1, 1)
   def __cmp__(self, other):
     if isinstance(other, Version):
       return cmp(self.v, other.v)
     if isinstance(other, basestring):  # or as appropriate for Python 
2.1
       # generate a deprecation warning here
       return cmp(self.s, other)
     return cmp(self.v, other)
   def __rcmp__(self, other):
     return -cmp(self, other)
   def __getitem__(self, i):
     return self.v[i]

which would be an interim solution that would pass the
existing regression tests and provide a transition to a 2-ple
based version.


&gt;&gt;<i> I noticed that the headers parsing assumes unique names, with
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>          self.requests[-1].received_headers[header] = data
</I>&gt;<i>
</I>&gt;<i> This is indeed a problem. I had a patch that solved it, but had to back
</I>&gt;<i> it out. Sooner or later it will be reintroduced.
</I>
What about using just rfc822.Message?  That's in Python 2.2.

&gt;<i> Twisted depends on 2.2. If you want code to be added to Twisted, it'll
</I>&gt;<i> have to require 2.2 only. We also ned backwards compatability with
</I>&gt;<i> existing code. Most of the problems you mentioned can be solved with
</I>&gt;<i> only a little work using the existing codebase.
</I>&gt;<i>
</I>&gt;<i> Probably what you should do is write a series of patches and send them
</I>&gt;<i> to me. They'll have to be backwards compatible, have tests and work on
</I>&gt;<i> 2.2 in order to be accepted.
</I>
I used the wrong term.  I said &quot;replacement&quot; when I should have
said &quot;in addition to&quot;.  That is, code which would eventually become
the standard code for Twisted once it requires 2.3 (after all, 2.3
isn't out yet!)

My major complaint, by the way, is not that there are small problems
with the code.  It's that Twisted duplicates functionality from standard
Python, when the Python code is just as usable for that situation and
has fewer problems.  And going the other way, the Python 2.3 
implementation
doesn't have the &quot;\r\n&quot; workaround Twisted has for handling IE problems.
If those could be combined, then there are more people supporting the 
same
codebase, so hopefully fewer bugs, and easier to share experience 
between
the two.

A downside is the dependency on Python releases to fix patches, but
any bugs at this point will be distributed at the patch level, and
there's always the possibility of just including the patched code
with Twisted until the next Python update.

&quot;Backwards compatible&quot; is somewhat of an issue.  I don't know which
methods are published and which are unpublished.  Is it expected that
people will (or do) derive from twisted.protocols.http.HTTPChannel ?
If so, then can I change the behaviour or simply eliminate the
headerReceived method?  (I would rather accumulate all headers then
parse them into a Message in one go.)  What about the other methods?

I can make the existing regressions all pass, but a review of the
regressions show that it doesn't test everything that could be tested,
so I need to either ask questions first (as I'm doing) or be extreme
about it and say that if it passes the tests then it must be fine ;)

					Andrew
					<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dalke at dalkescientific.com</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="036836.html">[Twisted-Python] HTTP versions
</A></li>
	<LI>Next message (by thread): <A HREF="036844.html">[Twisted-Python] HTTP versions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36839">[ date ]</a>
              <a href="thread.html#36839">[ thread ]</a>
              <a href="subject.html#36839">[ subject ]</a>
              <a href="author.html#36839">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
