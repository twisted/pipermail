<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Getting Rid of Application in a Compatible Way
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Getting%20Rid%20of%20Application%20in%20a%20Compatible%20Way&In-Reply-To=20030523070247.10334.qmail%40green.zadka.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004598.html">
   <LINK REL="Next"  HREF="004603.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Getting Rid of Application in a Compatible Way</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Getting%20Rid%20of%20Application%20in%20a%20Compatible%20Way&In-Reply-To=20030523070247.10334.qmail%40green.zadka.com"
       TITLE="[Twisted-Python] Getting Rid of Application in a Compatible Way">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Jun 16 07:45:24 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004598.html">[Twisted-Python] Lies, Damn Lies, and Stable Interfaces
</A></li>
        <LI>Next message: <A HREF="004603.html">[Twisted-Python] xmlrpc ExpatError
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4582">[ date ]</a>
              <a href="thread.html#4582">[ thread ]</a>
              <a href="subject.html#4582">[ subject ]</a>
              <a href="author.html#4582">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>(This is in reply to a message sent last month, so apologies if it 
doesn't thread properly.)

On Friday, May 23, 2003, at 02:02 AM, Moshe Zadka wrote:

&gt;<i> class TCPListener(ApplicationService):
</I>
I want to implement this, and also to move ApplicationService into its 
own module and rename it (commensurate with cred changes) - 
twisted.internet.service.Service

&gt;<i>     def __init__(self, port, factory, backlog=5, interface='', *args, 
</I>&gt;<i> **kwargs):
</I>...
&gt;<i>     def startService(self):
</I>&gt;<i>         ApplicationService.startService(self)
</I>&gt;<i>         self._port = reactor.listenTCP(self.port, self.factory, 
</I>&gt;<i> self.backlog,
</I>&gt;<i>                                        self.interface)
</I>
This is great, except for the fact that UNIX likes to make it so that 
only root can bind ports, and that would be way too much work to run in 
a privileged mode.  We need to separate initializeService() (which runs 
with privileges) and startService() (which runs without).  This would 
replace bindPorts().

&gt;<i> TCPListener(8080, server.Site(resource), 
</I>&gt;<i> &quot;foo&quot;).setServiceParent(application)
</I>
The 'setServiceParent' seems a little unweildy.  Why not in the 
__init__?

&gt;<i> The only problem is needing to choose unique names.
</I>
Rather than use the opaque key you suggest, which would be potentially 
confusing to sysadmins, we could use a simple sequence number?  Putting 
sequence number generation into Application is probably not such a bad 
idea anyway.

I would really like this refactoring to happen soon, because 
Application is an ungodly mess.  So, to sum up -

	* move Service to new module
	* write TCPListenerService, SSLConnectService, etc
	* write backwards-compatible listen|connectTCP/SSL/etc
	* update _all_ uses of app.(listen|connect)(TCP|SSL|UNIX) in Twisted.
	* write upgrade function to upgrade Application's mutable state.

Does anybody feel like doing something like this?



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004598.html">[Twisted-Python] Lies, Damn Lies, and Stable Interfaces
</A></li>
	<LI>Next message: <A HREF="004603.html">[Twisted-Python] xmlrpc ExpatError
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4582">[ date ]</a>
              <a href="thread.html#4582">[ thread ]</a>
              <a href="subject.html#4582">[ subject ]</a>
              <a href="author.html#4582">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
