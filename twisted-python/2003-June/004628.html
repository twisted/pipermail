<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Custom webserver
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Custom%20webserver&In-Reply-To=5.1.0.14.0.20030619112356.023a6538%40131.103.204.244">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004616.html">
   <LINK REL="Next"  HREF="004618.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Custom webserver</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Custom%20webserver&In-Reply-To=5.1.0.14.0.20030619112356.023a6538%40131.103.204.244"
       TITLE="[Twisted-Python] Custom webserver">exarkun at intarweb.us
       </A><BR>
    <I>Thu Jun 19 20:15:58 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004616.html">[Twisted-Python] Custom webserver
</A></li>
        <LI>Next message: <A HREF="004618.html">[Twisted-Python] A fake SMTP server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4628">[ date ]</a>
              <a href="thread.html#4628">[ thread ]</a>
              <a href="subject.html#4628">[ subject ]</a>
              <a href="author.html#4628">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Jun 19, 2003 at 11:27:55AM +0530, Vijay Rao wrote:
&gt;<i> At 06:34 16/06/2003 -0500, you wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;Message: 9
</I>&gt;<i> &gt;Date: Mon, 16 Jun 2003 10:03:52 +0300
</I>&gt;<i> &gt;From: Tommi Virtanen &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">tv at twistedmatrix.com</A>&gt;
</I>&gt;<i> &gt;To: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>
</I>&gt;<i> &gt;Subject: Re: [Twisted-Python] Custom webserver
</I>&gt;<i> &gt;Reply-To: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;On Mon, Jun 16, 2003 at 09:57:13AM +0530, Vijay Rao wrote:
</I>&gt;<i> &gt;&gt; I am trying to use twisted as a webserver that serves files only for
</I>&gt;<i> &gt;&gt; requests from the localhost ie the desktop on which it is running by
</I>&gt;<i> &gt;&gt; mapping localhost(127.0.0.1) to a domain pattern ( thru the hosts file on
</I>&gt;<i> &gt;&gt; windows ) so that a particular type of URL is served from this webserver.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;        Easiest way is to make it bind to 127.0.0.1. There's currently
</I>&gt;<i> &gt;        no support in mktap web for this, though there really should
</I>&gt;<i> &gt;        be.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;--
</I>&gt;<i> &gt;:(){ :|:&amp;};:
</I>&gt;<i> 
</I>&gt;<i> Thanks , any pointer as to how to achieve this binding.
</I>
  You can mktap --source or mktap --xml, then edit the resulting .tas or
.tax relatively easily.  The value to change will in tcpPorts and be '' or
&quot;&quot;, representing &quot;all interfaces&quot;.  Changing it to &quot;127.0.0.1&quot; will cause
the app to bind only to localhost when run.

  There certainly should be better support for this.

&gt;<i> Also for refusing any external request I tried this hack and it works :
</I>&gt;<i> 
</I>&gt;<i> (from protocols/http.py)
</I>&gt;<i> 
</I>&gt;<i>     def lineReceived(self, line):
</I>&gt;<i>         if self.__first_line:
</I>&gt;<i>             # if this connection is not persistent, drop any data which
</I>&gt;<i>             # the client (illegally) sent after the last request.
</I>&gt;<i> ......
</I>&gt;<i> .....
</I>&gt;<i> ......
</I>&gt;<i>             if len(parts) != 3:
</I>&gt;<i>                 self.transport.write(&quot;HTTP/1.1 400 Bad Request\r\n\r\n&quot;)
</I>&gt;<i>                 self.transport.loseConnection()
</I>&gt;<i>                 return
</I>&gt;<i>             client = self.transport.getPeer()
</I>&gt;<i>             host = self.transport.getHost()
</I>&gt;<i>             if client[1] != '127.0.0.1' or host[1] != '127.0.0.1' :
</I>&gt;<i>                 self.transport.write(&quot;HTTP/1.1 404 Forbidden\r\n\r\n&quot;)
</I>&gt;<i>                 self.transport.loseConnection()
</I>&gt;<i>                 return
</I>&gt;<i> .......
</I>&gt;<i> ....
</I>&gt;<i> 
</I>&gt;<i> Can this cause any other problem ( One thing I can see is that new channels 
</I>&gt;<i> are created for each external request refused in this manner )
</I>&gt;<i> And the requesting client browser is also not being able to display the 
</I>&gt;<i> result sent.
</I>
  A better way would be to separate this accept/deny logic out into a
separate class, perhaps a Resource subclass.

  Both moshez and I have recently written code to support this.  Moshez's
version is by far the simpler of the two, and is available at
<A HREF="http://moshez.org/localonly.py.">http://moshez.org/localonly.py.</A>  My version uses a mini-language for
creating accept/deny rulesets, and is available in current Twisted CVS, in
sandbox/exarkun/rresource.py.

  Hope this helps,
 
  Jp

-- 
<A HREF="http://catandgirl.com/view.cgi?90">http://catandgirl.com/view.cgi?90</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20030619/4cf9163e/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-python/attachments/20030619/4cf9163e/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004616.html">[Twisted-Python] Custom webserver
</A></li>
	<LI>Next message: <A HREF="004618.html">[Twisted-Python] A fake SMTP server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4628">[ date ]</a>
              <a href="thread.html#4628">[ thread ]</a>
              <a href="subject.html#4628">[ subject ]</a>
              <a href="author.html#4628">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
