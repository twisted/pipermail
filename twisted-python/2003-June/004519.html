<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Submitted for your consideration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Submitted%20for%20your%20consideration&In-Reply-To=20030611095216.GA1346%40meson.dyndns.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004516.html">
   <LINK REL="Next"  HREF="004520.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Submitted for your consideration</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Submitted%20for%20your%20consideration&In-Reply-To=20030611095216.GA1346%40meson.dyndns.org"
       TITLE="[Twisted-Python] Submitted for your consideration">andrew-twisted at puzzling.org
       </A><BR>
    <I>Wed Jun 11 06:27:52 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004516.html">[Twisted-Python] Submitted for your consideration
</A></li>
        <LI>Next message: <A HREF="004520.html">[Twisted-Python] Submitted for your consideration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4519">[ date ]</a>
              <a href="thread.html#4519">[ thread ]</a>
              <a href="subject.html#4519">[ subject ]</a>
              <a href="author.html#4519">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Jun 11, 2003 at 05:52:16AM -0400, Jp Calderone wrote:
&gt;<i>   Attached is a patch to add timeout support to t.web (via a minor
</I>&gt;<i> HTTPChannel change).
</I>&gt;<i> 
</I>&gt;<i>   The performance impact should be light, though it does impose an extra
</I>&gt;<i> function call per received line.  If this is found to unacceptable, I do not
</I>&gt;<i> thing it would be unreasonable to change the &quot;__lastReceived&quot; attribute's
</I>&gt;<i> name, document it as public, and require the update be made inline.
</I>
[I've already made this point on IRC, but anyway...]

It also will timeout clients if a request takes a long time to run.  Think
streaming web pages, e.g. LivePage, or a streaming log from a *very* slow
buildbot build.  This patch should use .setTimeout(None) to disable timeouts
while a request is being processed (and then of course re-enable timeouts
once all outstanding requests have been serviced).  I don't like the idea of
disconnecting a client simply because the server is taking a long time to
serve the request, or because a client has a slow link.

I realise the default timeout is 12 hours, but:
    - I can imagine cases where HTTP connections last longer than 12 hours
      without receiving traffic from the client, e.g. streaming HTTP, where
      the client sends nothing, but the server keeps streaming buildbot
      results/javascript events/music, or simply a very long running request
      (i.e. because of an unusually massive DB query, or something).  You'd
      *really* be annoyed if your query took 13 hours, only to discover
      after 12 hours Twisted Web arbitrarily decided your connection was
      idle and killed it.  
    - Another scenario: A dial-up user downloading an ISO of their favorite
      Linux distro.  This is a legitimate request, and shouldn't be
      arbitrarily cut-off halfway.  If a client wants to download 600Mb at
      5kB/s, Twisted Web should let them.
    - It should still work correctly if the default is changed.  Someone
      might be paranoid, and set the timeout down to, say, 5 minutes.  This
      shouldn't cause adverse affects (beyond killing connections that have
      been idle that long).

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004516.html">[Twisted-Python] Submitted for your consideration
</A></li>
	<LI>Next message: <A HREF="004520.html">[Twisted-Python] Submitted for your consideration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4519">[ date ]</a>
              <a href="thread.html#4519">[ thread ]</a>
              <a href="subject.html#4519">[ subject ]</a>
              <a href="author.html#4519">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
