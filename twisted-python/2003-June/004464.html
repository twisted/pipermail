<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.web.static.loadMimeTypes() patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.web.static.loadMimeTypes%28%29%20patch&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004475.html">
   <LINK REL="Next"  HREF="004467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.web.static.loadMimeTypes() patch</H1>
    <B>Alexander Winston</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20twisted.web.static.loadMimeTypes%28%29%20patch&In-Reply-To="
       TITLE="[Twisted-Python] twisted.web.static.loadMimeTypes() patch">alexander.winston at attbi.com
       </A><BR>
    <I>Sun Jun  8 21:32:50 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004475.html">[Twisted-Python] typos
</A></li>
        <LI>Next message: <A HREF="004467.html">[Twisted-Python] Re: Switch to a different uid/gid after binding reserved ports (G lyph Lefkowitz)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4464">[ date ]</a>
              <a href="thread.html#4464">[ thread ]</a>
              <a href="subject.html#4464">[ subject ]</a>
              <a href="author.html#4464">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This patch is for twisted.web.static.loadMimeTypes().  It reads Python's built-in dictionary and updates its with a dictionary of our own (aka The Usual Suspects).  Support was added for reading/sourcing of an external file (the default being &quot;/etc/mime.types&quot;), which would update the aforementioned dictionary with the contents of the file.  The patch is attached to this E-mail.

----
Alexander Winston (Yeah.) &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">alexander.winston at attbi.com</A>&gt;
-------------- next part --------------
Index: Twisted/twisted/web/static.py
===================================================================
RCS file: /cvs/Twisted/twisted/web/static.py,v
retrieving revision 1.92
diff -u -r1.92 static.py
--- Twisted/twisted/web/static.py	31 May 2003 05:42:42 -0000	1.92
+++ Twisted/twisted/web/static.py	8 Jun 2003 20:41:27 -0000
@@ -147,43 +147,48 @@
                           app.theApplication)
 
 
-def loadMimeTypes():
-    &quot;&quot;&quot;Ugg, does this even need to exist anymore?  Stupid stdlib&quot;&quot;&quot;
+def loadMimeTypes(mimetypes_location='/etc/mime.types'):
+    '''Yay for mime(-type)s!'''
     import mimetypes
-    # let's try a few of the usual suspects...
-    contentTypes = {
-        &quot;.css&quot;: &quot;text/css&quot;,
-        &quot;.exe&quot;: &quot;application/x-executable&quot;,
-        &quot;.flac&quot;: &quot;audio/x-flac&quot;,
-        &quot;.gif&quot;: &quot;image/gif&quot;,
-        &quot;.gtar&quot;: &quot;application/x-gtar&quot;,
-        &quot;.html&quot;: &quot;text/html&quot;,
-        &quot;.htm&quot;: &quot;text/html&quot;,
-        &quot;.java&quot;: &quot;text/plain&quot;,
-        &quot;.jpeg&quot;: &quot;image/jpeg&quot;,
-        &quot;.jpg&quot;: &quot;image/jpeg&quot;,
-        &quot;.lisp&quot;: &quot;text/x-lisp&quot;,
-        &quot;.mp3&quot;:  &quot;audio/mpeg&quot;,
-        &quot;.oz&quot;: &quot;text/x-oz&quot;,
-        &quot;.ogg&quot;: &quot;application/x-ogg&quot;,
-        &quot;.pdf&quot;: &quot;application/x-pdf&quot;,
-        &quot;.png&quot;: &quot;image/png&quot;,
-        &quot;.py&quot;: &quot;text/plain&quot;,
-        &quot;.swf&quot;: &quot;application/x-shockwave-flash&quot;,
-        &quot;.tar&quot;: &quot;application/x-tar&quot;,
-        &quot;.tgz&quot;: &quot;application/x-gtar&quot;,
-        &quot;.tif&quot;: &quot;image/tiff&quot;,
-        &quot;.tiff&quot;: &quot;image/tiff&quot;,
-        &quot;.txt&quot;: &quot;text/plain&quot;,
-        &quot;.wml&quot;: &quot;text/vnd.wap.wml&quot;,
-        &quot;.xul&quot;: &quot;application/vnd.mozilla.xul+xml&quot;,
-        &quot;.zip&quot;: &quot;application/x-zip&quot;,
-        &quot;.patch&quot;: &quot;text/plain&quot;,
+    # Grab Python's built-in mimetypes dictionary.
+    contentTypes = mimetypes.types_map
+    # Update Python's dictionary with a few of our usual suspects.
+    contentTypes.update(
+        {
+            '.conf':  'text/plain',
+            '.css':   'text/css',
+            '.exe':   'application/x-executable',
+            '.flac':  'audio/x-flac',
+            '.gif':   'image/gif',
+            '.gtar':  'application/x-gtar',
+            '.html':  'text/html',
+            '.htm':   'text/html',
+            '.java':  'text/plain',
+            '.jpeg':  'image/jpeg',
+            '.jpg':   'image/jpeg',
+            '.lisp':  'text/x-lisp',
+            '.mp3':   'audio/mpeg',
+            '.ogg':   'application/ogg',
+            '.oz':    'text/x-oz',
+            '.patch': 'text/plain',
+            '.pdf':   'application/x-pdf',
+            '.png':   'image/png',
+            '.py':    'text/plain',
+            '.swf':   'application/x-shockwave-flash',
+            '.tar':   'application/x-tar',
+            '.tgz':   'application/x-gtar',
+            '.tif':   'image/tiff',
+            '.tiff':  'image/tiff',
+            '.txt':   'text/plain',
+            '.wml':   'text/vnd.wap.wml',
+            '.xul':   'application/vnd.mozilla.xul+xml',
+            '.zip':   'application/x-zip',
         }
-    upd = contentTypes.update
-    if os.path.exists(&quot;/etc/mime.types&quot;):
-        upd(mimetypes.read_mime_types(&quot;/etc/mime.types&quot;))
-
+    )
+    # Users can override these mime-types by loading them out of a system-wide
+    # configuration file (this defaults to &quot;/etc/mime.types&quot;).
+    if os.path.exists(mimetypes_location):
+        contentTypes.update(mimetypes.read_mime_types(mimetypes_location))
     return contentTypes
 
 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004475.html">[Twisted-Python] typos
</A></li>
	<LI>Next message: <A HREF="004467.html">[Twisted-Python] Re: Switch to a different uid/gid after binding reserved ports (G lyph Lefkowitz)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4464">[ date ]</a>
              <a href="thread.html#4464">[ thread ]</a>
              <a href="subject.html#4464">[ subject ]</a>
              <a href="author.html#4464">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
