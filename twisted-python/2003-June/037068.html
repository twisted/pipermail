<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] callback style question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20callback%20style%20question&In-Reply-To=%3C20030613202441.0EC4834532%40www.fastmail.fm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037065.html">
   <LINK REL="Next"  HREF="037069.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] callback style question</H1>
    <B>Justin Johnson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20callback%20style%20question&In-Reply-To=%3C20030613202441.0EC4834532%40www.fastmail.fm%3E"
       TITLE="[Twisted-Python] callback style question">justinjohnson at fastmail.fm
       </A><BR>
    <I>Fri Jun 13 14:24:41 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037065.html">[Twisted-Python] benchmarks for twisted.trial
</A></li>
        <LI>Next message (by thread): <A HREF="037069.html">[Twisted-Python] callback style question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37068">[ date ]</a>
              <a href="thread.html#37068">[ thread ]</a>
              <a href="subject.html#37068">[ subject ]</a>
              <a href="author.html#37068">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I wrote an xmlrpc service using twisted for the server portion but using
xmlrpclib on the client side to connect.  It is working beautifully, and
greatly simplifying my job.  However, now I decided that I'd like to take
advantage of Deferred's on the client side so that I can initiate
multiple requests at once.  These requests involve doing something on one
server, and then something on another if the first thing was successful. 
It seems like I'd have quite a chain of callbacks, but maybe this is
normal.  Below I posted the relevant code snippets of what I'm currently
doing on the client side.

Do I need to define methods for every step in the chain?  Would someone
mind giving me advice on how something like this should be written?

Thanks much.
-Justin



def connectToServer(server):
	# s = xmlrpclib.Server('<A HREF="http://%s:%s/">http://%s:%s/</A>' % (server, config.portNumber) )
	s = xmlrpclib.ServerProxy('<A HREF="http://%s:%s">http://%s:%s</A>' % (server, config.portNumber), BasicAuthTransport(config.adminUser,config.adminPassword))
	return s

# Subcommand: mkvob
def doMkvob2(options):
	original_site = options[&quot;original&quot;]
	group = options[&quot;group&quot;]
	vobs = options[&quot;vobs&quot;].split(&quot;,&quot;)
	sites = options[&quot;sites&quot;].split(&quot;,&quot;)

	#s = connectToServer(config.siteToServer[original_site])
	#s = connectToTwistedServer(config.siteToServer[original_site])
	s = xmlrpclib.ServerProxy('<A HREF="http://%s:%s">http://%s:%s</A>' % (server, config.portNumber), BasicAuthTransport(config.adminUser,config.adminPassword))

	print &quot;Successfully connected to %s (%s).&quot; % (original_site, config.siteToServer[original_site])
	print &quot;Calling remote mkvob ...&quot;
	results = s.mkvob(vobs, group)
	results += s.mkReplicaExport(vobs,sites)
	results += s.renameReplica(vobs, &quot;original&quot;, original_site)
	results += s.exportReplica(vobs,sites)
	for site in sites:
		thatServer = connectToServer(config.siteToServer[site])
		results += thatServer.mkReplicaImport(vobs)
		results += thatServer.importReplica(vobs)
		results += thatServer.applyTriggers(vobs)
	print &quot;[output]\n%s[/output]&quot; % results


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037065.html">[Twisted-Python] benchmarks for twisted.trial
</A></li>
	<LI>Next message (by thread): <A HREF="037069.html">[Twisted-Python] callback style question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37068">[ date ]</a>
              <a href="thread.html#37068">[ thread ]</a>
              <a href="subject.html#37068">[ subject ]</a>
              <a href="author.html#37068">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
