<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Patch for twisted.protocols.nntp
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Patch%20for%20twisted.protocols.nntp&In-Reply-To=200306221714.24485%40smurf.noris.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004651.html">
   <LINK REL="Next"  HREF="004658.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Patch for twisted.protocols.nntp</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Patch%20for%20twisted.protocols.nntp&In-Reply-To=200306221714.24485%40smurf.noris.de"
       TITLE="[Twisted-Python] Patch for twisted.protocols.nntp">exarkun at intarweb.us
       </A><BR>
    <I>Mon Jun 23 02:11:35 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004651.html">[Twisted-Python] Patch for twisted.protocols.nntp
</A></li>
        <LI>Next message: <A HREF="004658.html">[Twisted-Python] Patch for twisted.protocols.nntp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4655">[ date ]</a>
              <a href="thread.html#4655">[ thread ]</a>
              <a href="subject.html#4655">[ subject ]</a>
              <a href="author.html#4655">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Jun 22, 2003 at 05:14:24PM +0200, Matthias Urlichs wrote:
&gt;<i> Since &quot;suck&quot; doesn't work for me for a variety of reasons, I decided to 
</I>&gt;<i> replace it with a solution based on twisted.protocol.nntp. After a few hours 
</I>&gt;<i> of hacking, I now have a nice program which nicely saturates my downlink 
</I>&gt;<i> bandwidth. ;-)
</I>&gt;<i> 
</I>
  Cool!

&gt;<i> To make a long story short, the attached patch implements the changes and 
</I>&gt;<i> fixes I needed to actually get there.
</I>&gt;<i> 
</I>&gt;<i> The &quot;Allow the article text to be a callable or deferred&quot; change implements 
</I>&gt;<i> the common situation where I ask server B whether it would like to be fed 
</I>&gt;<i> article X before actually pulling that article from server A, and/or where 
</I>&gt;<i> the pull is still in progress.
</I>&gt;<i> 
</I>
  Hmm, this is the only part of the patch I am unsure about.  The API seems
a little too tuned to your use-case.  I think the way to go for this would
be to have a Producer passed in and make the NNTP protocol a Consumer
for that (in turn acting as a Producer for its transport object).  Would you
be willing to make this change? (If you need an example of how this might
work, check out smtp.py)

&gt;<i> There is one somewhat- incompatible change here, in that I return the GROUP 
</I>&gt;<i> results (article count, high and low numbers) as integers, not as text. In 
</I>&gt;<i> practice they're going to be int()ized anyway, so this should not be a 
</I>&gt;<i> problem.
</I>
  I think this is fine.

&gt;<i> 
</I>&gt;<i> # twisted/protocols/nntp.py
</I>&gt;<i> #     Fixes for news gateways / 'suck'-style operation / INN as server:
</I>&gt;<i> #     - The client uses \n and does NOT esacpe start-of-line dots.
</I>&gt;<i> #       The server uses \r\n and escapes dots ONCE, not twice (ouch).
</I>&gt;<i> #     - POST temporarily blocks streaming. Make sure this is observed,
</I>&gt;<i> #       pass a Deferred out for clients to restart themselves with
</I>&gt;<i> #     - Add a command to allow MODE READER
</I>&gt;<i> #     - Allow bare reply numbers without text
</I>&gt;<i> #     - Allow the article text to be a callable or a deferred
</I>&gt;<i> #     - use CHECK/TAKETHIS if there's a message ID
</I>&gt;<i> #     - return group article numbers (GROUP reply) as numbers
</I>&gt;<i> #     - Clean up article linefeed handling
</I>&gt;<i> # twisted/test/test_nntp.py
</I>&gt;<i> #     Make sure that dot escapes are passed cleanly.
</I>&gt;<i> #     Make sure that no empty lines are added at the end.
</I>&gt;<i> #     Use the unittest object for checking.
</I>&gt;<i> #     Use client-side line endings for the client,
</I>&gt;<i> #       assume that the server side is transparent.
</I>&gt;<i> #     Make sure that the test doesn't just peter out halfway through.
</I>&gt;<i> #     Remove the commented-out iterate() calls.
</I>&gt;<i> #       loopback() already does the work for us.
</I>
  Thanks for these test fixes/cleanups, too.

  Jp

-- 
In the days when Sussman was a novice Minsky once came to him as he sat
hacking at the PDP-6. &quot;What are you doing?&quot; asked Minsky. &quot;I am training a
randomly wired neural net to play Tic-Tac-Toe.&quot; &quot;Why is the net wired
randomly?&quot; asked Minsky. &quot;I do not want it to have any preconceptions of how
to play.&quot; Minsky shut his eyes. &quot;Why do you close your eyes?&quot; Sussman asked
his teacher. &quot;So the room will be empty.&quot; At that moment, Sussman was
enlightened.
 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20030623/55af174a/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-python/attachments/20030623/55af174a/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004651.html">[Twisted-Python] Patch for twisted.protocols.nntp
</A></li>
	<LI>Next message: <A HREF="004658.html">[Twisted-Python] Patch for twisted.protocols.nntp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4655">[ date ]</a>
              <a href="thread.html#4655">[ thread ]</a>
              <a href="subject.html#4655">[ subject ]</a>
              <a href="author.html#4655">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
