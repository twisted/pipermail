<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Simplifying database access in Twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Simplifying%20database%20access%20in%20Twisted&In-Reply-To=%3CCD65C4FA-A2A4-11D7-9259-000A95686CD8%40redivi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="037133.html">
   <LINK REL="Next"  HREF="037137.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Simplifying database access in Twisted</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Simplifying%20database%20access%20in%20Twisted&In-Reply-To=%3CCD65C4FA-A2A4-11D7-9259-000A95686CD8%40redivi.com%3E"
       TITLE="[Twisted-Python] Simplifying database access in Twisted">bob at redivi.com
       </A><BR>
    <I>Thu Jun 19 16:24:33 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="037133.html">[Twisted-Python] Simplifying database access in Twisted
</A></li>
        <LI>Next message (by thread): <A HREF="037137.html">[Twisted-Python] Simplifying database access in Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37135">[ date ]</a>
              <a href="thread.html#37135">[ thread ]</a>
              <a href="subject.html#37135">[ subject ]</a>
              <a href="author.html#37135">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thursday, Jun 19, 2003, at 17:13 America/New_York, Thomas Weholt 
wrote:

&gt;<i> Just read thru <A HREF="http://www.twistedmatrix.com/documents/howto/enterprise">http://www.twistedmatrix.com/documents/howto/enterprise</A> 
</I>&gt;<i> and
</I>&gt;<i> tried to fit the code to my needs, but ... this seems way too 
</I>&gt;<i> complicated.
</I>&gt;<i> All I want is to execute a SQL-query and do something similar to 
</I>&gt;<i> fetchone or
</I>&gt;<i> fetchall etc. in the DB-API 2.0 spec. I don't want to be forced to 
</I>&gt;<i> write
</I>&gt;<i> classes and callbacks etc. just for a simple list of tuples or 
</I>&gt;<i> something
</I>&gt;<i> returned from a SQL-query.
</I>&gt;<i>
</I>&gt;<i> Is there no other way to do simple database access in Twisted? 
</I>&gt;<i> Something
</I>&gt;<i> more like the DB-API 2.0? The docs says &quot;This is straightforward ...&quot;. 
</I>&gt;<i> No,
</I>&gt;<i> it's not. The example a bit further up on the same page, now that's
</I>&gt;<i> straightforward. Perhaps it's just me not getting all the callbacks and
</I>&gt;<i> whatnot, but this seems too hard, too much code for such a simple 
</I>&gt;<i> task. All
</I>&gt;<i> I want is a database-object to feed sql-statements, which returns the
</I>&gt;<i> results as dictionaries or list of tuples, as close to DB-API 2.0 as
</I>&gt;<i> possible. Any hint or clue would be highly appreciated.
</I>&gt;<i>
</I>&gt;<i> PS! I don't mean to step on anyones toes or anything, so forgive me if 
</I>&gt;<i> I'm a
</I>&gt;<i> bit harsh. But this might be the bitter end of my journey into the 
</I>&gt;<i> realms of
</I>&gt;<i> Twisted. Quick, fast and easy access to a database will make-or-break 
</I>&gt;<i> all of
</I>&gt;<i> my current projects, all of which are based on Twisted.
</I>
Here are some doc-examplets not using Augmentation.

from twisted.enterprise import adbapi

noop = lambda x:x
cp = adbapi.ConnectionPool('pyPgSQL.PgSQL', '::yourdatabase::')

deferred = cp.interaction(yourcallback, noop, *yourcallbackargs, 
**yourcallbackkwargs)
#	pass in a callback that receives a cursor as its first argument, 
DBAPI your little heart out.#
#	returns whatever you return in your callback.
#	note that 'yourcallback' does not run in the main reactor thread!  be 
careful not to try and call into it directly from here.

deferred = cp.operation(noop, noop, *executeargs, **executekwargs)
#	does cursor.execute(*executeargs, **executekwargs)
#	returns a deferred that calls back with None.  It fetches no data at 
all, useful for insert/update/stored procedure type stuff.

deferred = cp.query(noop, noop, *executeargs, **executekwargs)
#	does cursor.execute(*executeargs, **executekwargs)
#	returns a deferred that calls back with the fetchall()

noop is used to make these things act more like newer Twisted 
interfaces that were designed with Deferred in mind.

Presumably if all of your current projects are based on Twisted, you're 
comfortable enough with Deferred, so I won't go into that.

-bo



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="037133.html">[Twisted-Python] Simplifying database access in Twisted
</A></li>
	<LI>Next message (by thread): <A HREF="037137.html">[Twisted-Python] Simplifying database access in Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37135">[ date ]</a>
              <a href="thread.html#37135">[ thread ]</a>
              <a href="subject.html#37135">[ subject ]</a>
              <a href="author.html#37135">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
