<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Deferred usage clarification
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Deferred%20usage%20clarification&In-Reply-To=%3C20030602003139.GA3067%40frobozz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="036840.html">
   <LINK REL="Next"  HREF="036842.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Deferred usage clarification</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Deferred%20usage%20clarification&In-Reply-To=%3C20030602003139.GA3067%40frobozz%3E"
       TITLE="[Twisted-Python] Deferred usage clarification">andrew-twisted at puzzling.org
       </A><BR>
    <I>Sun Jun  1 18:31:39 MDT 2003</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="036840.html">[Twisted-Python] Deferred usage clarification
</A></li>
        <LI>Next message (by thread): <A HREF="036842.html">[Twisted-Python] Deferred usage clarification
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36841">[ date ]</a>
              <a href="thread.html#36841">[ thread ]</a>
              <a href="subject.html#36841">[ subject ]</a>
              <a href="author.html#36841">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Jun 01, 2003 at 08:05:02PM -0400, Gary Poster wrote:
&gt;<i> Hi.  A newbie question: I'd like a bit of clarification in Deferred 
</I>&gt;<i> usage.  More specifically, it would be nice if one of the examples on 
</I>&gt;<i> the Twisted Deferred howto page used a real blocking call rather than a 
</I>&gt;<i> reactor.callLater.
</I>&gt;<i> 
</I>&gt;<i> So, to see if I'm on the right track, I'd like to modify the third code 
</I>&gt;<i> example to use a sleep, to make it better parallel the first code 
</I>&gt;<i> snippet on the howto page.
</I>&gt;<i> 
</I>&gt;<i> First, here it is from the page, without modification:
</I>&gt;<i> 
</I>[...]
&gt;<i> 
</I>&gt;<i> Here's my modification.  Is this the right usage?
</I>
No -- see below.

&gt;<i> -----8&lt;-----8&lt;-----8&lt;-----
</I>[...]
&gt;<i> class Getter:
</I>&gt;<i>     def getData(self, x):
</I>&gt;<i>         # this won't block
</I>&gt;<i>         d = defer.Deferred()
</I>&gt;<i>         reactor.callLater(0, self.doWork, x, d)
</I>&gt;<i>         return d
</I>&gt;<i> 
</I>&gt;<i>     def doWork(self, x, deferred):
</I>&gt;<i>         # churn, churn, churn
</I>&gt;<i>         time.sleep(2)
</I>&gt;<i>         deferred.callback(x * 3)
</I>[...]
&gt;<i> -----8&lt;-----8&lt;-----8&lt;-----
</I>
You're misunderstanding the purpose of Deferreds.  They don't do any magic
to make blocking calls happen asynchronously.

A Deferred is simply a result that hasn't arrived yet.  When the result of
some function can take some arbitrary amount of time to happen, it will
return a Deferred, rather than holding up the execution of the rest of the
program.  A Deferred is a promise that a result (or failure) will arrive
eventually, and provides a convenient abstraction to attach callbacks to
that is far more usuable than riddling your code with functions that take a
method to callback when they're done.

How the result arrives later is entirely up to the code that returns the
Deferred.  It might simply send an HTTP request, and wait for the result to
arrive off the network; it might query a database; it might split the work
up into small chunks that it schedules using callLater; or it might just use
deferToThread.  All that matters is that at some point &quot;d.callback(result)&quot;
or &quot;d.errback(failure)&quot; is called (or you could call d.setTimeout(...) if
you aren't sure you want to wait indefinitely).

Does this make sense?

Regards,

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="036840.html">[Twisted-Python] Deferred usage clarification
</A></li>
	<LI>Next message (by thread): <A HREF="036842.html">[Twisted-Python] Deferred usage clarification
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36841">[ date ]</a>
              <a href="thread.html#36841">[ thread ]</a>
              <a href="subject.html#36841">[ subject ]</a>
              <a href="author.html#36841">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
