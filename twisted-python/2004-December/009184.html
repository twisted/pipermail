<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] M2Crypto+Twisted, part 2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20M2Crypto%2BTwisted%2C%20part%202&In-Reply-To=41B65D0C.9080705%40osafoundation.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009177.html">
   <LINK REL="Next"  HREF="009187.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] M2Crypto+Twisted, part 2</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20M2Crypto%2BTwisted%2C%20part%202&In-Reply-To=41B65D0C.9080705%40osafoundation.org"
       TITLE="[Twisted-Python] M2Crypto+Twisted, part 2">exarkun at divmod.com
       </A><BR>
    <I>Wed Dec  8 10:04:46 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009177.html">[Twisted-Python] M2Crypto+Twisted, part 2
</A></li>
        <LI>Next message: <A HREF="009187.html">[Twisted-Python] M2Crypto+Twisted, part 2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9184">[ date ]</a>
              <a href="thread.html#9184">[ thread ]</a>
              <a href="subject.html#9184">[ subject ]</a>
              <a href="author.html#9184">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 07 Dec 2004 17:46:52 -0800, Heikki Toivonen &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">heikki at osafoundation.org</A>&gt; wrote:
&gt;<i>A while back I integrated M2Crypto into Twisted, but the architecture 
</I>&gt;<i> was not deemed good then (it was adding more of the SSL cruft in tcp.py 
</I>&gt;<i> etc.).
</I>&gt;<i> 
</I>&gt;<i> James Knight pointed me to TLS Lite, which had achieved similar 
</I>&gt;<i> functionality by using ProtocolWrapper and WrappingFactory and all the 
</I>&gt;<i> code was outside of Twisted. (Thanks James!)
</I>&gt;<i> 
</I>&gt;<i> I've now got an implementation of M2Crypto + Twisted integration using 
</I>&gt;<i> the TLS Lite approach - no changes in Twisted required. (Client only for 
</I>&gt;<i> now and not yet fully cleaned up, but all the important pieces should be 
</I>&gt;<i> there.)
</I>&gt;<i> 
</I>&gt;<i> However, I've run into some problems and I am not sure if they are bugs 
</I>&gt;<i> in Twisted or if I am using these interfaces wrong. Maybe you can help.
</I>&gt;<i> 
</I>&gt;<i> The most interesting piece of the code is my TLSProtocolWrapper that 
</I>&gt;<i> inherits from ProtocolWrapper. See 
</I>&gt;<i> <A HREF="http://lxr.osafoundation.org/source/internal/m2crypto/M2Crypto/SSL/TwistedProtocolWrapper.py">http://lxr.osafoundation.org/source/internal/m2crypto/M2Crypto/SSL/TwistedProtocolWrapper.py</A>
</I>&gt;<i> 
</I>&gt;<i> Now, this seems to works perfectly with the echoclient samples when the 
</I>&gt;<i> SSL connection has no errors.
</I>&gt;<i> 
</I>&gt;<i> When there is an error in the SSL connection, and I call 
</I>&gt;<i> connectionLost(), I end up with a traceback that feels like it might be 
</I>&gt;<i> a Twisted bug. Or if I am not allowed to call that, how do I signal that 
</I>&gt;<i> I want to break the connection? Here's the traceback:
</I>
  You should call proto.transport.loseConnection() instead of proto.connectionLost().  The former indicates to the reactor that the connection should be dropped, the latter is a callback that the reactor invokes to tell you that the connection has been dropped.

  Jp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009177.html">[Twisted-Python] M2Crypto+Twisted, part 2
</A></li>
	<LI>Next message: <A HREF="009187.html">[Twisted-Python] M2Crypto+Twisted, part 2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9184">[ date ]</a>
              <a href="thread.html#9184">[ thread ]</a>
              <a href="subject.html#9184">[ subject ]</a>
              <a href="author.html#9184">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
