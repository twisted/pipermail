<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] ludicrous timeouts in protocols.http.HTTPFactory	and web.server.Site
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20ludicrous%20timeouts%20in%20protocols.http.HTTPFactory%0A%09and%20web.server.Site&In-Reply-To=%3C20041230233923.GR5117%40frobozz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="041774.html">
   <LINK REL="Next"  HREF="041782.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] ludicrous timeouts in protocols.http.HTTPFactory	and web.server.Site</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20ludicrous%20timeouts%20in%20protocols.http.HTTPFactory%0A%09and%20web.server.Site&In-Reply-To=%3C20041230233923.GR5117%40frobozz%3E"
       TITLE="[Twisted-Python] ludicrous timeouts in protocols.http.HTTPFactory	and web.server.Site">andrew-twisted at puzzling.org
       </A><BR>
    <I>Thu Dec 30 16:39:23 MST 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="041774.html">[Twisted-Python] ludicrous timeouts in protocols.http.HTTPFactory	and web.server.Site
</A></li>
        <LI>Next message (by thread): <A HREF="041782.html">[Twisted-Python] ludicrous timeouts in	protocols.http.HTTPFactory and web.server.Site
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41781">[ date ]</a>
              <a href="thread.html#41781">[ thread ]</a>
              <a href="subject.html#41781">[ subject ]</a>
              <a href="author.html#41781">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Dec 30, 2004 at 03:44:32PM +0100, Antoine Pitrou wrote:
[...]
&gt;<i> Looking at the Twisted code, I see that very long timeouts have been
</I>&gt;<i> defined for both protocols.http.HTTPFactory and web.server.Site
</I>&gt;<i> (60*60*12, that is 12 hours!). If I override the &quot;timeout&quot; parameter
</I>&gt;<i> when constructing the Site receiving XMLRPC connections, then the
</I>&gt;<i> problem disappears:
</I>&gt;<i>         reactor.listenTCP(xmlrpc_port, server.Site(self, timeout=30), interface=xmlrpc_host)
</I>&gt;<i> 
</I>&gt;<i> I think the default values in Twisted are quite bogus and should be
</I>&gt;<i> changed to more sensible ones. 30 or 60 seconds is ok in the context of
</I>&gt;<i> an HTTP connection. Very long timeouts on the other hand make the server
</I>&gt;<i> very vulnerable.
</I>
One person's &quot;reasonable&quot; timeout is another person's &quot;ludicrous&quot;... this
sort of thing will need tuning per-application.  12 hours is conservative,
but highly unlikely to interfere with what anyone with pre-timeout Twisted
expects, while solving the problem twistedmatrix.com's web site was having
with the occasional connection not being closed.  And having long-running
connections mysteriously die due to a timeout setting you didn't even know
existed can be very surprising and frustrating to debug.

That said, the HTTP code is now quite careful with timeouts: it disables
them while sending the response (or more accurately, after receiving a
complete request, and then reenables them after it finishes sending the
response), so the only time a timeout can occur is while waiting for a
request to be sent -- i.e. it won't time out someone that's downloading an
ISO over a dial-up link.  So there probably is room to reduce it.

However, for very large POST requests over a slow link (ever tried to attach
a large file to your webmail over dial-up?), 30 or 60 seconds is still too
slow, but I could see an argument for, say, 30 minutes being the default.
Part of the issue here is backwards compatibility -- there may be
deployments of old versions of Twisted out there that depends on the
conservative (or no!) timeouts, and we don't want to gratuitously break
them.  If we do decide to be more aggressive by default, we need to make
this very clear in the documentation for the next version.

Regardless, if a particular application has specific needs, they can always
change the setting, just like you did.  It's not a major issue.

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="041774.html">[Twisted-Python] ludicrous timeouts in protocols.http.HTTPFactory	and web.server.Site
</A></li>
	<LI>Next message (by thread): <A HREF="041782.html">[Twisted-Python] ludicrous timeouts in	protocols.http.HTTPFactory and web.server.Site
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41781">[ date ]</a>
              <a href="thread.html#41781">[ thread ]</a>
              <a href="subject.html#41781">[ subject ]</a>
              <a href="author.html#41781">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
