<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: More on PB Copyable Errors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20More%20on%20PB%20Copyable%20Errors&In-Reply-To=94a776e70412281234522aa53d%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009256.html">
   <LINK REL="Next"  HREF="009260.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: More on PB Copyable Errors</H1>
    <B>Justin Johnson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20More%20on%20PB%20Copyable%20Errors&In-Reply-To=94a776e70412281234522aa53d%40mail.gmail.com"
       TITLE="[Twisted-Python] Re: More on PB Copyable Errors">justinjohnson at gmail.com
       </A><BR>
    <I>Wed Dec 29 09:56:48 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009256.html">[Twisted-Python] Re: More on PB Copyable Errors
</A></li>
        <LI>Next message: <A HREF="009260.html">[Twisted-Python] Re: More on PB Copyable Errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9259">[ date ]</a>
              <a href="thread.html#9259">[ thread ]</a>
              <a href="subject.html#9259">[ subject ]</a>
              <a href="author.html#9259">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Attached is a patch with modifications to pb.py and jelly.py.  With
the patch applied, CopyableFailure.getStateToCopy first checks to see
if the actual exception instance's class has an unjellyable registered
so it can be unjellied on the other side.  If it does, the actual
exception instance is passed back as failure.value.  Otherwise a
string representation is passed back as it is today.

I'd like some confirmation that this is an acceptable approach.  If so
I will gladly submit an enhancement and attach the patch.

-Justin


On Tue, 28 Dec 2004 14:34:02 -0600, Justin Johnson
&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">justinjohnson at gmail.com</A>&gt; wrote:
&gt;<i> Whoops... forgot the attachments.  Here they are.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Tue, 28 Dec 2004 14:32:04 -0600, Justin Johnson
</I>&gt;<i> &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">justinjohnson at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; I would really like to be able to pass custom exceptions over the wire
</I>&gt;<i> &gt; in PB.  Previous discussion on this list ended with the conclusion
</I>&gt;<i> &gt; that it currently isn't possible without hacking a local copy of
</I>&gt;<i> &gt; Twisted.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have done that to get the result I want, with minimal testing, and
</I>&gt;<i> &gt; would like to get some discussion going around this topic.  Attached
</I>&gt;<i> &gt; are 3 test files, s.py for the server, c.py for the client, and e.py
</I>&gt;<i> &gt; for the error definitions which are imported by both s.py and c.py.
</I>&gt;<i> &gt; If I make the following modification to my local copy of
</I>&gt;<i> &gt; twisted/spread/pb.py in the CopyableFailure's getStateToCopy method,
</I>&gt;<i> &gt; the custom error is passed back as I want.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   #state['value'] = str(self.value) # Exception instance
</I>&gt;<i> &gt;   state['value'] = self.value # Exception instance
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I was wondering if there is a reason we wouldn't want to change the
</I>&gt;<i> &gt; code to check for registered unjellyables for the exception, and
</I>&gt;<i> &gt; return them (or rather go through the jelly/unjelly process) if they
</I>&gt;<i> &gt; exist, but return the string representation otherwise.  Maybe that is
</I>&gt;<i> &gt; more complicated than I realize.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any thoughts or suggestions on how we might make this possible?
</I>&gt;<i> &gt; Thanks.
</I>&gt;<i> &gt; -Justin
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>
</I>-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: patch.txt
Url: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20041229/0184d235/attachment.txt">http://twistedmatrix.com/pipermail/twisted-python/attachments/20041229/0184d235/attachment.txt</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009256.html">[Twisted-Python] Re: More on PB Copyable Errors
</A></li>
	<LI>Next message: <A HREF="009260.html">[Twisted-Python] Re: More on PB Copyable Errors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9259">[ date ]</a>
              <a href="thread.html#9259">[ thread ]</a>
              <a href="subject.html#9259">[ subject ]</a>
              <a href="author.html#9259">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
