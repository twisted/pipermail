<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] giving a reason when adding a timeout
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20giving%20a%20reason%20when%20adding%20a%20timeout&In-Reply-To=%3CCAFycZ9ckLhn_xd%2BVQxku0POn_0d0C%2ByxCDvjEFYmunQ5Dhvk%3Dw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="064665.html">
   <LINK REL="Next"  HREF="032207.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] giving a reason when adding a timeout</H1>
    <B>Adi Roiban</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20giving%20a%20reason%20when%20adding%20a%20timeout&In-Reply-To=%3CCAFycZ9ckLhn_xd%2BVQxku0POn_0d0C%2ByxCDvjEFYmunQ5Dhvk%3Dw%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] giving a reason when adding a timeout">adi at roiban.ro
       </A><BR>
    <I>Wed Mar 13 17:36:38 MDT 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="064665.html">[Twisted-Python] giving a reason when adding a timeout
</A></li>
        <LI>Next message (by thread): <A HREF="032207.html">[Twisted-Python] Any Windows users/reviewers around?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64666">[ date ]</a>
              <a href="thread.html#64666">[ thread ]</a>
              <a href="subject.html#64666">[ subject ]</a>
              <a href="author.html#64666">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 13 Mar 2019 at 16:07, Chris Withers &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">chris at withers.org</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> &gt;&gt; Unless I'm missing something, Deferred.addTimeout is really unhelpful in
</I>&gt;<i> &gt;&gt; terms on providing context about *what* timed out.
</I>&gt;<i> &gt;&gt; TimeoutError(&lt;some number&gt;, 'Deferred') just isn't that useful.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; How come addTimeout doesn't let you specify a textual reason, or
</I>&gt;<i> &gt;&gt; otherwise provide some context about the timeout?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Am I missing something obvious here?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't know what kind of context do you need :)
</I>&gt;<i>
</I>&gt;<i> foo.addTimeout(myTimeout, reactor, message='never heard back')
</I>&gt;<i>
</I>&gt;<i> &gt; You can add your own errback and add your extra error handling there.
</I>&gt;<i>
</I>&gt;<i> What's the must succinct way to get the above by adding an errback?
</I>&gt;<i>
</I>
That is subjective :)
You can try something like this.

def eb_timeoutLog(failure, message):
    failure.trap(TimeoutError)
    print(message)

deferred = someJob()
deferred.addTimeout(10, reactor)
deferred.addErrback(eb_timeoutLog, message='never heard back')

or like this

def eb_timeoutLog(failure, message):
    failure.trap(TimeoutError)
    print(message)

def add_timeout(deferred, timeout, message):
    deferred.addTimeout(10, reactor)
    deferred.addErrback(eb_timeoutLog, message)

deferred = someJob()
add_timeout(deferred, message='never heard back')


&gt;<i> &gt; There is also onTimeoutCancel argument.
</I>&gt;<i>
</I>&gt;<i> Pretty clunky to write a whole function for either this or the errback
</I>&gt;<i> just to change the useless 'Deferred' string in the current
</I>&gt;<i> implementation with something useful.
</I>
For production code I add errbacks anyway.
The errback catches various error conditions and does more than just
printing a text.
I am not missing anything here :)

&gt;<i> &gt; If there is anything missing from the API, feel free to send a pull
</I>&gt;<i> &gt; request in GitHub.
</I>&gt;<i>
</I>&gt;<i> What's the likely turn around time from me submitting a PR to when it
</I>&gt;<i> ends up in a released version of Twisted that I can use?
</I>
I don't you the answer to that question.

If this is something that you want to be improved, my suggestion is to
give it a try.

The whole Twisted was created by people who had an issue and were
willing to effort required to share the solution with the rest of the
world :)

&gt;<i> Chris
</I>


-- 
Adi Roiban


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="064665.html">[Twisted-Python] giving a reason when adding a timeout
</A></li>
	<LI>Next message (by thread): <A HREF="032207.html">[Twisted-Python] Any Windows users/reviewers around?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64666">[ date ]</a>
              <a href="thread.html#64666">[ thread ]</a>
              <a href="subject.html#64666">[ subject ]</a>
              <a href="author.html#64666">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
