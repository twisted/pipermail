<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] reactor for Linux io_uring
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20reactor%20for%20Linux%20io_uring&In-Reply-To=%3CCAEeXt4Od1SDTWSB9ryeDUzc2b6ewOOJB7waLwfdDEBa4XAqyAg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="065385.html">
   <LINK REL="Next"  HREF="065388.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] reactor for Linux io_uring</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20reactor%20for%20Linux%20io_uring&In-Reply-To=%3CCAEeXt4Od1SDTWSB9ryeDUzc2b6ewOOJB7waLwfdDEBa4XAqyAg%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] reactor for Linux io_uring">exarkun at twistedmatrix.com
       </A><BR>
    <I>Tue Jan  5 06:31:49 MST 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="065385.html">[Twisted-Python] reactor for Linux io_uring
</A></li>
        <LI>Next message (by thread): <A HREF="065388.html">[Twisted-Python] reactor for Linux io_uring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65386">[ date ]</a>
              <a href="thread.html#65386">[ thread ]</a>
              <a href="subject.html#65386">[ subject ]</a>
              <a href="author.html#65386">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Jan 5, 2021 at 6:49 AM Barry Scott &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">barry.scott at forcepoint.com</A>&gt;
wrote:

&gt;<i> On Monday, 4 January 2021 04:01:42 GMT Ian Haywood wrote:
</I>&gt;<i> &gt; In investigating async file I/O I came across this. In a nutshell it's
</I>&gt;<i> &gt; the new epoll()
</I>&gt;<i>
</I>&gt;<i> &gt; It's marginally more efficient although this is only apparent at very
</I>&gt;<i> &gt; high loads.
</I>&gt;<i>
</I>&gt;<i> &gt; What's more interesting is that io_uring accepts files as
</I>&gt;<i> &gt; well as network/pipe handles: avoiding the need for threads.
</I>&gt;<i>
</I>&gt;<i> What threads? Why do you call out file FDs different from socket FDs?
</I>&gt;<i>
</I>&gt;<i> The point of io_uring is to avoid transitions between user and kernel
</I>&gt;<i> right?
</I>&gt;<i> Nothing to do with thread.
</I>&gt;<i>
</I>&gt;<i> In current twisted you can run complex network code without threads
</I>&gt;<i> already.
</I>&gt;<i>
</I>&gt;<i> &gt; Here's a good intro: <A HREF="https://unixism.net/loti/index.html">https://unixism.net/loti/index.html</A>
</I>&gt;<i>
</I>&gt;<i> Also there is full coverage of io_uring on lwn.net.
</I>&gt;<i> Its a fast evolving kernel API.
</I>&gt;<i>
</I>&gt;<i> &gt; If people think an IoUringReactor is worthwhile I'll open a ticket and
</I>&gt;<i> &gt; make a start.
</I>&gt;<i>
</I>&gt;<i> I'm guessing that you will need to write a Python extension to get at
</I>&gt;<i> io_uring or use ctypes. Is that what you where expecting?
</I>&gt;<i>
</I>&gt;<i> &gt; However it will need a reviewer... :-)
</I>&gt;<i>
</I>&gt;<i> Yes this is going to be complex code that few people have any experience
</I>&gt;<i> with.
</I>&gt;<i>
</I>
Just so there's a counter-perspective out there, I would like to suggest
that reactors are neither magical nor particular complex in the grand
scheme of software and that if you start with the assumption that a piece
of code is going to be complex and hard to review then you will almost
certainly create a piece of software that is complex and hard to review.

My recommendation would be to instead start with the assumption that it's
just a bit more mundane code binding a relatively small and straightforward
C API related to copying bytes from one location to another.  Yea, maybe
there will be some hassles getting it to compile smoothly in all the
desired environments or maybe there will be a few tricky areas for memory
management or some other kind of low-level, localized bookkeeping - but
those kinds of issues don't have to make for a complex piece of code.
Starting from this assumption, try to produce an implementation that is
straightforward, well-factored, and easily reviewed.  What do you have to
lose?

Jean-Paul


&gt;<i>
</I>&gt;<i> Barry
</I>&gt;<i>
</I>&gt;<i> &gt; Ian
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Twisted-Python mailing list
</I>&gt;<i> &gt; <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> &gt; <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20210105/ac1f399c/attachment.htm&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="065385.html">[Twisted-Python] reactor for Linux io_uring
</A></li>
	<LI>Next message (by thread): <A HREF="065388.html">[Twisted-Python] reactor for Linux io_uring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65386">[ date ]</a>
              <a href="thread.html#65386">[ thread ]</a>
              <a href="subject.html#65386">[ subject ]</a>
              <a href="author.html#65386">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
