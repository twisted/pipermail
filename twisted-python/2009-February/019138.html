<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] RE: [Stackless] Maximum Recursion Depth Error with	Twisted 8.2/Stackless 2.6.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20RE%3A%20%5BStackless%5D%20Maximum%20Recursion%20Depth%20Error%20with%0A%09Twisted%208.2/Stackless%202.6.1&In-Reply-To=930F189C8A437347B80DF2C156F7EC7F04DB227AD5%40exchis.ccp.ad.local">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019144.html">
   <LINK REL="Next"  HREF="019145.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] RE: [Stackless] Maximum Recursion Depth Error with	Twisted 8.2/Stackless 2.6.1</H1>
    <B>Andrew Francis</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20RE%3A%20%5BStackless%5D%20Maximum%20Recursion%20Depth%20Error%20with%0A%09Twisted%208.2/Stackless%202.6.1&In-Reply-To=930F189C8A437347B80DF2C156F7EC7F04DB227AD5%40exchis.ccp.ad.local"
       TITLE="[Twisted-Python] RE: [Stackless] Maximum Recursion Depth Error with	Twisted 8.2/Stackless 2.6.1">andrewfr_ice at yahoo.com
       </A><BR>
    <I>Wed Feb  4 09:20:19 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019144.html">[Twisted-Python] installation help
</A></li>
        <LI>Next message: <A HREF="019145.html">[Twisted-Python] most efficient new connection rate limiting?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19138">[ date ]</a>
              <a href="thread.html#19138">[ thread ]</a>
              <a href="subject.html#19138">[ subject ]</a>
              <a href="author.html#19138">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Kristjan:

Thanks for the explanation and the effort. Tomorrow, I'll hunt down a few things on my end. If you find ToyProcessor5 too convoluted, I'll post the code for another prototype that should be easier to follow.

Cheers,
Andrew


--- On Tue, 2/3/09, Kristj&#225;n Valur J&#243;nsson &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">kristjan at ccpgames.com</A>&gt; wrote:

&gt;<i> From: Kristj&#225;n Valur J&#243;nsson &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">kristjan at ccpgames.com</A>&gt;
</I>&gt;<i> Subject: RE: [Stackless] Maximum Recursion Depth Error with Twisted 8.2/Stackless 2.6.1
</I>&gt;<i> To: &quot;Andrew Francis&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">andrewfr_ice at yahoo.com</A>&gt;, &quot;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>&gt;
</I>&gt;<i> Cc: &quot;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">stackless at stackless.com</A>&quot; &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">stackless at stackless.com</A>&gt;
</I>&gt;<i> Date: Tuesday, February 3, 2009, 1:49 AM
</I>&gt;<i> Stackless does stack copying if it senses that the C stack
</I>&gt;<i> has grown to deep.  But it still tries to maintain the
</I>&gt;<i> recursion depth limit set in &quot;sys&quot;.  There is
</I>&gt;<i> probably a bug somewhere in the bookkeeping of this.
</I>&gt;<i> I'll try trawling through the code for the
</I>&gt;<i> corresponding stuff If I find the time today.
</I>&gt;<i> K
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">stackless-bounces at stackless.com</A>
</I>&gt;<i> [mailto:<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">stackless-bounces at stackless.com</A>] On Behalf Of Andrew
</I>&gt;<i> Francis
</I>&gt;<i> Sent: 2. febr&#250;ar 2009 22:48
</I>&gt;<i> To: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>
</I>&gt;<i> Cc: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">stackless at stackless.com</A>
</I>&gt;<i> Subject: [Stackless] Maximum Recursion Depth Error with
</I>&gt;<i> Twisted 8.2/Stackless 2.6.1
</I>&gt;<i> 
</I>&gt;<i> Hi Colleagues:
</I>&gt;<i> 
</I>&gt;<i> I recently updated to Stackless 2.6.1 and Twisted 8.2. I
</I>&gt;<i> executed the following programme that works fine under
</I>&gt;<i> Stackless 2.5.2 and Twisted (including 8.2) and I received
</I>&gt;<i> the following error:
</I>&gt;<i> 
</I>&gt;<i> traceback (most recent call last):
</I>&gt;<i>           File &quot;ToyProcessor5.py&quot;, line 60, in
</I>&gt;<i> twistedReactor
</I>&gt;<i>             reactor.run()
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/internet/base.py&quot;
</I>&gt;<i> , line 1048, in run
</I>&gt;<i>             self.mainLoop()
</I>&gt;<i>         --- &lt;exception caught here&gt; ---
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/internet/base.py&quot;
</I>&gt;<i> , line 1057, in mainLoop
</I>&gt;<i>             self.runUntilCurrent()
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/internet/base.py&quot;
</I>&gt;<i> , line 707, in runUntilCurrent
</I>&gt;<i>             log.deferr()
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/python/log.py&quot;,
</I>&gt;<i> l ine 153, in err
</I>&gt;<i>             _stuff = failure.Failure()
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/python/failure.py
</I>&gt;<i> &quot;, line 265, in __init__
</I>&gt;<i>             parentCs = reflect.allYourBase(self.type)
</I>&gt;<i> &quot;, line 542, in allYourBase
</I>&gt;<i>             accumulateBases(classObj, l, baseClass)
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/python/reflect.py&quot;,
</I>&gt;<i> line 550, in accumulateBases
</I>&gt;<i>             accumulateBases(base, l, baseClass)
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/python/reflect.py&quot;,
</I>&gt;<i> line 550, in accumulateBases
</I>&gt;<i>             accumulateBases(base, l, baseClass)
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/python/reflect.py&quot;,
</I>&gt;<i> line 550, in accumulateBases
</I>&gt;<i>             accumulateBases(base, l, baseClass)
</I>&gt;<i>           File
</I>&gt;<i> &quot;/usr/local/lib/python2.6/site-packages/twisted/python/reflect.py&quot;,
</I>&gt;<i> line 550, in accumulateBases
</I>&gt;<i>             accumulateBases(base, l, baseClass)
</I>&gt;<i>         exceptions.RuntimeError: maximum recursion depth
</I>&gt;<i> exceeded
</I>&gt;<i> 
</I>&gt;<i> Similarily written programmes fail in the same fashion.
</I>&gt;<i> What is suspicious is that there is no recursion in the
</I>&gt;<i> offending section. Even if I create one worker tasklet, I
</I>&gt;<i> get the same error.
</I>&gt;<i> 
</I>&gt;<i> def twistedReactor():
</I>&gt;<i>     l = task.LoopingCall(stackless.schedule)
</I>&gt;<i>     l.start(.01)
</I>&gt;<i>     reactor.run()
</I>&gt;<i> 
</I>&gt;<i> however, if I change
</I>&gt;<i> 
</I>&gt;<i> l = task.LoopingCall(stackless.schedule)
</I>&gt;<i> 
</I>&gt;<i> to
</I>&gt;<i> 
</I>&gt;<i> l = task.LoopingCall(tick)
</I>&gt;<i> 
</I>&gt;<i> and tick is
</I>&gt;<i> 
</I>&gt;<i> def tick():
</I>&gt;<i>     stackless.schedule()
</I>&gt;<i> 
</I>&gt;<i> the programme works. Although a work around, I would like
</I>&gt;<i> to find the real problem.
</I>&gt;<i> 
</I>&gt;<i> What particular worries me is when I created small test
</I>&gt;<i> examples, I was not  able to recreate the problem. Something
</I>&gt;<i> else is going on....
</I>&gt;<i> 
</I>&gt;<i> What I would appreciate is some hints as to what may be
</I>&gt;<i> happening.  
</I>&gt;<i> 
</I>&gt;<i> - I normally don't expect &quot;Maximum Recursion
</I>&gt;<i> Depth&quot; errors in Stackless. 
</I>&gt;<i> - What is the reflect.allYourBases stuff? 
</I>&gt;<i> - What is log.deferr? (I don't recall seeing that
</I>&gt;<i> method).
</I>&gt;<i> 
</I>&gt;<i> If I get few clues, it would make it easier for me to write
</I>&gt;<i> new tests and zero in on the problem. Hopefully the problem
</I>&gt;<i> is with my code rather than Stackless 2.6.1 and/or Twisted
</I>&gt;<i> 8.2
</I>&gt;<i> 
</I>&gt;<i> I have included some sample code. Unfortunately
</I>&gt;<i> ToyProcessor5.py is a bit large (I have newer code that is
</I>&gt;<i> smaller but requires more files)
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> Andrew
</I>

      


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019144.html">[Twisted-Python] installation help
</A></li>
	<LI>Next message: <A HREF="019145.html">[Twisted-Python] most efficient new connection rate limiting?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19138">[ date ]</a>
              <a href="thread.html#19138">[ thread ]</a>
              <a href="subject.html#19138">[ subject ]</a>
              <a href="author.html#19138">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
