<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted plugins and py2exe
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20plugins%20and%20py2exe&In-Reply-To=%3C20090224195505.12555.1349207332.divmod.xquotient.5060%40weber.divmod.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="051755.html">
   <LINK REL="Next"  HREF="051758.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted plugins and py2exe</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20plugins%20and%20py2exe&In-Reply-To=%3C20090224195505.12555.1349207332.divmod.xquotient.5060%40weber.divmod.com%3E"
       TITLE="[Twisted-Python] Twisted plugins and py2exe">glyph at divmod.com
       </A><BR>
    <I>Tue Feb 24 12:55:05 MST 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="051755.html">[Twisted-Python] Twisted plugins and py2exe
</A></li>
        <LI>Next message (by thread): <A HREF="051758.html">[Twisted-Python] server client in one code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51756">[ date ]</a>
              <a href="thread.html#51756">[ thread ]</a>
              <a href="subject.html#51756">[ subject ]</a>
              <a href="author.html#51756">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 04:55 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at divmod.com</A> wrote:
&gt;<i>Tue, 24 Feb 2009 17:35:14 +0100, Gabriel Rossetti 
</I>&gt;<i>&lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">gabriel.rossetti at arimaz.com</A>&gt; wrote:
</I>&gt;&gt;<i>Jean-Paul Calderone wrote:
</I>&gt;&gt;&gt;<i>On Tue, 24 Feb 2009 11:49:13 +0100, Gabriel Rossetti 
</I>&gt;&gt;&gt;<i>&lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">gabriel.rossetti at arimaz.com</A>&gt; wrote:
</I>
&gt;&gt;&gt;&gt;<i>Has anyone ever had this problem while using plugins with Twisted 
</I>&gt;&gt;&gt;&gt;<i>and py2exe?
</I>
&gt;&gt;&gt;<i>No, but from the traceback, it seems fairly clear that the plugin 
</I>&gt;&gt;&gt;<i>system
</I>&gt;&gt;&gt;<i>is trying to write a plugin cache file into your py2exe-created zip 
</I>&gt;&gt;&gt;<i>file
</I>&gt;&gt;&gt;<i>of Python source.
</I>
&gt;&gt;<i>Ok, I could do this, teach it abot zip files and have it update it's 
</I>&gt;&gt;<i>cache in the zip file, but in certain cases, like mine actually, if 
</I>&gt;&gt;<i>you tell py2exe to include the zip file in the exec, then it won't 
</I>&gt;&gt;<i>work. How about adding the possibility to specify where the cache is 
</I>&gt;&gt;<i>to be written?
</I>
This is almost certainly the wrong solution to your problem, but if you 
disagree with this assessment please feel free to update this ticket:

    <A HREF="http://twistedmatrix.com/trac/ticket/3348">http://twistedmatrix.com/trac/ticket/3348</A>

Several people have requested this feature and nobody has really made a 
good case for why it should be implemented.  (I don't think it should 
be, I just think we should record all the reasons why not on that ticket 
:<i>)).
</I>&gt;<i>Updating the cache in the zip file probably isn't the right thing to 
</I>&gt;<i>do.
</I>&gt;<i>Just skipping cache generation would probably make more sense.  It 
</I>&gt;<i>should
</I>&gt;<i>be easier to implement, anyway.
</I>
Skipping the cache generation is like skipping bytecode compilation. 
It's not a catastrophic error, everything should still work, but it will 
result in more unnecessary work being done at runtime.

IMHO the right solution in this particular case would be to get py2exe 
(or some part of the setup process in py2exe, which I believe is 
implemented using distutils) to generate a cache file as part of the 
built zip file.  Presumably .pyc files are also created and included in 
the zip file.  The appropriate procedure for forcibly generating the 
cache is described here:

<A HREF="http://twistedmatrix.com/projects/core/documentation/howto/plugin.html#auto3">http://twistedmatrix.com/projects/core/documentation/howto/plugin.html#auto3</A>

A cache generated in this manner will be suitable for packaging into a 
zip file.

Another part of the solution would be to implement setContent on 
ZipPath.  However, there are still likely to be erroneous deployment 
scenarios where the ZipPath is not available for writing, just as an 
installation path is frequently not available for writing now.  So an 
initial implementation of setContent on ZipPath could just raise the 
same exception that an unwritable FilePath would, for consistency in 
error handling.

For the issue of quieting the mostly-harmless error message now produced 
by a failure to write the cache file, see here:

    <A HREF="http://twistedmatrix.com/trac/ticket/2409">http://twistedmatrix.com/trac/ticket/2409</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="051755.html">[Twisted-Python] Twisted plugins and py2exe
</A></li>
	<LI>Next message (by thread): <A HREF="051758.html">[Twisted-Python] server client in one code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51756">[ date ]</a>
              <a href="thread.html#51756">[ thread ]</a>
              <a href="subject.html#51756">[ subject ]</a>
              <a href="author.html#51756">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
