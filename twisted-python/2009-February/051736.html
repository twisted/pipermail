<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] monitoring twisted services / processes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20monitoring%20twisted%20services%20/%20processes&In-Reply-To=%3C49A26DBD.8040706%40nu.no%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="051707.html">
   <LINK REL="Next"  HREF="051708.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] monitoring twisted services / processes</H1>
    <B>tarjei</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20monitoring%20twisted%20services%20/%20processes&In-Reply-To=%3C49A26DBD.8040706%40nu.no%3E"
       TITLE="[Twisted-Python] monitoring twisted services / processes">tarjei at nu.no
       </A><BR>
    <I>Mon Feb 23 02:34:53 MST 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="051707.html">[Twisted-Python] monitoring twisted services / processes
</A></li>
        <LI>Next message (by thread): <A HREF="051708.html">[Twisted-Python] mind, twisted.cred and HTTPAuthSessionWrapper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51736">[ date ]</a>
              <a href="thread.html#51736">[ thread ]</a>
              <a href="subject.html#51736">[ subject ]</a>
              <a href="author.html#51736">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi,
&gt;<i> 
</I>&gt;<i> I'm currently working on a PoC with twisted, Python, to prove the
</I>&gt;<i> technology as an alternative to more
</I>&gt;<i> established enterprise choices (java app servers, etc..).
</I>
&gt;<i> the question is: if I have N number of processes running in a M number
</I>&gt;<i> of machines, given that there are no network restriction,
</I>&gt;<i> and that at least http and hhtps are always available, how these
</I>&gt;<i> services would be efficiently monitored?
</I>
I've been planning to blog(done [1]) about this. What I do is to have
the service listen to a http connection that returns some monitoring
data. Something like the one below.

Then I use a custom Nagios plugin to request this url and Nagios-PNP to
make graphs of whatever datapoints the monitor produces.

The plugin setup is done by providing an url (say
<A HREF="http://myservice:893/monitor">http://myservice:893/monitor</A>) to monitor. The plugin will then both
monitor the application and graph it.

I have also added an extra field for &quot;errors&quot; that I use to report odd
exceptions or other types of failures that are non-fatal but should be
investigated. If the error count exceeds a set level the may also go
into the reporting.

<A HREF="http://www.kraken.no/blog/?q=node/9">http://www.kraken.no/blog/?q=node/9</A>


Regards,
Tarjei

class Monitor(rend.Page):
    &quot;&quot;&quot;
    Basic monitoring interface todo: make it even more general.
    Format:

    &lt;itemname value=&quot;int&quot; critical=&quot;int&quot; warning=&quot;int&quot; unit=&quot;UOM&quot;
label=&quot;itemname&quot;
    min=&quot;0&quot; max=&quot;300&quot;
    /&gt;
    UOM (unit of measurement) is one of:
      no unit specified - assume a number (int or float) of things (eg,
users, processes, load averages)
      s - seconds (also us, ms)
      % - percentage
      B - bytes (also KB, MB, TB)
      c - a continous counter (such as bytes transmitted on an interface)

    &quot;&quot;&quot;
    def __init__(self, config):
        self.isLeaf = True
        self.config = config

    def renderHTTP(self, ctx):
        inevow.IRequest(ctx).setHeader('Content-Type', 'text/xml;
charset=UTF-8')

        #que_length = str(len(getter.get_ids(0, -1)))
        #num_updated = str(get_nr_updated_last_day(self.config.get_db()))
        num_errors = str(len(self.config.getErrors()))

        _root = ET.Element('status', {'service' : 'PDFIndexer'})
        if 'total' in self.config.stats:
            _doc = ET.SubElement(_root,'total', {'value':
str(self.config.stats['total']) })

        _doc = ET.SubElement(_root,'runnerStatus', {'value':
str(self.config.checksStatus()) })
        #_doc = ET.SubElement(_root,'itemsAddedlast24', {'value':
num_updated})
        _errors = ET.SubElement(_root,'errors', {'value': num_errors,
'critical': &quot;3&quot; , 'warning': &quot;2&quot;})

        for error in self.config.getErrors():
            t = ET.SubElement(_errors, 'error', text = error)

        _xmlcontainer = StringIO()
        ET.ElementTree(_root).write(_xmlcontainer, encoding=&quot;UTF-8&quot;)
        return _xmlcontainer.getvalue()




&gt;<i> 
</I>&gt;<i> is there a twisted application/plugin/framework to do so? are you just
</I>&gt;<i> create 'polling' requests that an existing monitoring tool (i.e.
</I>&gt;<i> Nagios)
</I>&gt;<i> parses and interprets? How would you build a &quot;console&quot; to manage
</I>&gt;<i> services status?
</I>&gt;<i> In a nutshell, what I'm trying to find out if there is already around
</I>&gt;<i> a &quot;container-like&quot; twisted based application that can be used to
</I>&gt;<i> manage/monitor
</I>&gt;<i> twisted applications provided that they adhere to a given interface
</I>&gt;<i> 
</I>&gt;<i> Thanks for your help
</I>&gt;<i> 
</I>&gt;<i> Micc
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org">http://enigmail.mozdev.org</A>

iD8DBQFJom29YVRKCnSvzfIRAo0XAKCCOhwp1qIi0Qx2Dae0hn5gHkt5rwCfc8fn
XYXuTUrB2c/eR8ex870rXAc=
=pqNc
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="051707.html">[Twisted-Python] monitoring twisted services / processes
</A></li>
	<LI>Next message (by thread): <A HREF="051708.html">[Twisted-Python] mind, twisted.cred and HTTPAuthSessionWrapper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51736">[ date ]</a>
              <a href="thread.html#51736">[ thread ]</a>
              <a href="subject.html#51736">[ subject ]</a>
              <a href="author.html#51736">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
