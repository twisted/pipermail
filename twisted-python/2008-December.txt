From adigeaydin at gmail.com  Mon Dec  1 08:19:47 2008
From: adigeaydin at gmail.com (=?ISO-8859-9?Q?Ayd=FDn_=DEEN?=)
Date: Mon, 1 Dec 2008 15:19:47 +0200
Subject: [Twisted-Python] how to design protocol.
Message-ID: <2196d7e0812010519u56038c85q755044620e946e65@mail.gmail.com>

Let me explain my problem.. I am building an uploader application using
twisted. I am using "Protocol" in both side. What is the best way to
seperate data?
When i try to call "self.transport.write(data)"  it doesnt send data
immediately, it is sending with some other datas whic i send them later. Why
doesnt it send, what for is it waiting?

when i some information data I am sending  with '\n' (there is no other '\n'
in my data) to separate it in the client side but it is getting really
complicated. When i start to send file there is no problem, first send
fileSize then read everything and write in a file till fileSize.

I saw FileWrapper in the api but i couldnt find any tip that how it works,
is it for sending file, is it right way to my goal?

What about sending data like HTTP? What do you think about this way?
8 #bytes of data
11111111 #data
3 #bytes of data
111 #data
0 #finished sending data

I need your suggestions all about these.
(some links, documents, tips would be great)

Thanks..
-- 
Ayd?n ?EN

         Ege ?niversitesi
Uluslararas? Bilgisayar Enstit?s?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081201/1e7ff89f/attachment.htm 

From alessio.pace at gmail.com  Mon Dec  1 08:45:37 2008
From: alessio.pace at gmail.com (Alessio Pace)
Date: Mon, 1 Dec 2008 14:45:37 +0100
Subject: [Twisted-Python] Create a standalone Unix executable for a Twisted
	application?
Message-ID: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>

Hi,

I'm pretty new to Python and Twisted, and I would like to know if anyone
could share some experiences in creating a standalone Unix executable for a
Twisted application I'm building.

I would like in fact to distribute my application on some Unix machines
(onto which I cannot install anything)  which do *not* have Python and
Twisted (and not even GCC).

Thank you in advance for any suggestion.

Regards,
Alessio Pace.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081201/eaebe406/attachment.htm 

From reza at getpeer.com  Mon Dec  1 08:52:04 2008
From: reza at getpeer.com (Reza Lotun)
Date: Mon, 1 Dec 2008 13:52:04 +0000
Subject: [Twisted-Python] Create a standalone Unix executable for a
	Twisted application?
In-Reply-To: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
References: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
Message-ID: <356e30830812010552o267de0ccn99b7e8c017a25eca@mail.gmail.com>

Hi Alessio,

I've found bbfreeze to work quite well for this:

http://pypi.python.org/pypi/bbfreeze/0.95.4

Cheers,
Reza

On Mon, Dec 1, 2008 at 1:45 PM, Alessio Pace <alessio.pace at gmail.com> wrote:

> Hi,
>
> I'm pretty new to Python and Twisted, and I would like to know if anyone
> could share some experiences in creating a standalone Unix executable for a
> Twisted application I'm building.
>
> I would like in fact to distribute my application on some Unix machines
> (onto which I cannot install anything)  which do *not* have Python and
> Twisted (and not even GCC).
>
> Thank you in advance for any suggestion.
>
> Regards,
> Alessio Pace.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


-- 
Reza Lotun
Senior Software Engineer
Peer Technologies Limited
reza at getpeer.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081201/252e8034/attachment.htm 

From reza at getpeer.com  Mon Dec  1 08:52:38 2008
From: reza at getpeer.com (Reza Lotun)
Date: Mon, 1 Dec 2008 13:52:38 +0000
Subject: [Twisted-Python] Create a standalone Unix executable for a
	Twisted application?
In-Reply-To: <356e30830812010552o267de0ccn99b7e8c017a25eca@mail.gmail.com>
References: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
	<356e30830812010552o267de0ccn99b7e8c017a25eca@mail.gmail.com>
Message-ID: <356e30830812010552yb6c7af1m40e3a1058be24d97@mail.gmail.com>

Sorry, the latest version is

http://pypi.python.org/pypi/bbfreeze/0.96.5

On Mon, Dec 1, 2008 at 1:52 PM, Reza Lotun <reza at getpeer.com> wrote:

> Hi Alessio,
>
> I've found bbfreeze to work quite well for this:
>
> http://pypi.python.org/pypi/bbfreeze/0.95.4
>
> Cheers,
> Reza
>
> On Mon, Dec 1, 2008 at 1:45 PM, Alessio Pace <alessio.pace at gmail.com>wrote:
>
>> Hi,
>>
>> I'm pretty new to Python and Twisted, and I would like to know if anyone
>> could share some experiences in creating a standalone Unix executable for a
>> Twisted application I'm building.
>>
>> I would like in fact to distribute my application on some Unix machines
>> (onto which I cannot install anything)  which do *not* have Python and
>> Twisted (and not even GCC).
>>
>> Thank you in advance for any suggestion.
>>
>> Regards,
>> Alessio Pace.
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>>
>
>
> --
> Reza Lotun
> Senior Software Engineer
> Peer Technologies Limited
> reza at getpeer.com
>
>
>


-- 
Reza Lotun
Senior Software Engineer
Peer Technologies Limited
reza at getpeer.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081201/fe5028bb/attachment.htm 

From exarkun at divmod.com  Mon Dec  1 08:56:17 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 1 Dec 2008 08:56:17 -0500
Subject: [Twisted-Python] how to design protocol.
In-Reply-To: <2196d7e0812010519u56038c85q755044620e946e65@mail.gmail.com>
Message-ID: <20081201135617.20272.1337678802.divmod.quotient.13952@ohm>

On Mon, 1 Dec 2008 15:19:47 +0200, Ayd?n ?EN <adigeaydin at gmail.com> wrote:
>Let me explain my problem.. I am building an uploader application using
>twisted. I am using "Protocol" in both side. What is the best way to
>seperate data?
>When i try to call "self.transport.write(data)"  it doesnt send data
>immediately, it is sending with some other datas whic i send them later. Why
>doesnt it send, what for is it waiting?

http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#WhydoesittakealongtimefordataIsendwithtransport.writetoarriveattheothersideoftheconnection

>
>when i some information data I am sending  with '\n' (there is no other '\n'
>in my data) to separate it in the client side but it is getting really
>complicated. When i start to send file there is no problem, first send
>fileSize then read everything and write in a file till fileSize.

I'm not sure what problem you're describing.

>
>I saw FileWrapper in the api but i couldnt find any tip that how it works,
>is it for sending file, is it right way to my goal?

No.  FileWrapper probably isn't going to help you a lot.  It's possible that
twisted.protocols.basic.FileSender will.

>What about sending data like HTTP? What do you think about this way?
>8 #bytes of data
>11111111 #data
>3 #bytes of data
>111 #data
>0 #finished sending data

twisted.protocols.basic.NetstringReceiver (it can send too) might be useful.

>I need your suggestions all about these.
>(some links, documents, tips would be great)
>

Jean-Paul



From exarkun at divmod.com  Mon Dec  1 08:57:33 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 1 Dec 2008 08:57:33 -0500
Subject: [Twisted-Python] Create a standalone Unix executable for a
	Twisted application?
In-Reply-To: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
Message-ID: <20081201135734.20272.20577777.divmod.quotient.13953@ohm>

On Mon, 1 Dec 2008 14:45:37 +0100, Alessio Pace <alessio.pace at gmail.com> wrote:
>Hi,
>
>I'm pretty new to Python and Twisted, and I would like to know if anyone
>could share some experiences in creating a standalone Unix executable for a
>Twisted application I'm building.
>
>I would like in fact to distribute my application on some Unix machines
>(onto which I cannot install anything)  which do *not* have Python and
>Twisted (and not even GCC).
>
>Thank you in advance for any suggestion.

http://wiki.python.org/moin/Freeze might help.  I don't have any experiences
using it with Twisted to share, though.

Jean-Paul



From newptcai at gmail.com  Mon Dec  1 10:45:10 2008
From: newptcai at gmail.com (Peter Cai)
Date: Mon, 1 Dec 2008 23:45:10 +0800
Subject: [Twisted-Python] When would you considering split a server
	application to some physical instance with different logic function?
Message-ID: <befee6d80812010745r41da8efm8da141cd21898c@mail.gmail.com>

Hi all,

First, I am sorry because it's not a question related to twisted.
But since twisted is a networking programming framework,  you might be
interested.

Some of my colleagues have a view that a net work server should be split to
small parts with different functions,
either with processes communicating with socket, or with threads talking on
message queues.

Their points are these:

1.  Each part could it's own state-machine, thus we could split big
state-machines to decoupled small ones.

2.  It makes a pipe line that could handle some requests at the same time
without introducing lock problem of threading.
Just like how CPU use pipe line to improve performance.

3.  It resembles a micro-kernel system which is supposed to have better
availability.

As far as I know, some networking device manufactures use this model to
implement their routers or switches.
but I have never heard any examples besides that.
As twisted book says, most networking application use one of these 3 modes:

1. handle each connection in a separate operating system process, in which
case the operating system will take care
of letting other processes run while one is waiting;

2. handle each connection in a separate thread1 in which the threading
framework takes care of letting other threads
run while one is waiting; or

3. use non-blocking system calls to handle all connections in one thread.
(Like twisted or lib-event or just select)

After considering for a while,  I thought there are some faults in the
multiple parts model:

1. Writing code to handle message is much more tedious than just doing
function calls
2. It's not very easy to make a pipe line works fine.

OK, hope I made myself clear.  Since most of you who are reading this mail
list ,
are experienced networking programmers,  I think you might give some insight
comments.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081201/13fa4c90/attachment.htm 

From alessio.pace at gmail.com  Mon Dec  1 12:34:28 2008
From: alessio.pace at gmail.com (Alessio Pace)
Date: Mon, 1 Dec 2008 18:34:28 +0100
Subject: [Twisted-Python] Create a standalone Unix executable for a
	Twisted application?
In-Reply-To: <20081201135734.20272.20577777.divmod.quotient.13953@ohm>
References: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
	<20081201135734.20272.20577777.divmod.quotient.13953@ohm>
Message-ID: <84987d20812010934v58132651ie00af081769511e6@mail.gmail.com>

Hi all and thanks for the replies.  Apparenlty I managed to make the
standalone application with bbfreeze, I still have to tune a little bit how
it can pack in it also classes which are loaded dynamically, and which from
a static examination of the code are not found then...  I guess there will
be some sort of configuration to specify, but it's already something! :-)

Regards,
Alessio Pace.


On Mon, Dec 1, 2008 at 2:57 PM, Jean-Paul Calderone <exarkun at divmod.com>wrote:

> On Mon, 1 Dec 2008 14:45:37 +0100, Alessio Pace <alessio.pace at gmail.com>
> wrote:
>
>> Hi,
>>
>> I'm pretty new to Python and Twisted, and I would like to know if anyone
>> could share some experiences in creating a standalone Unix executable for
>> a
>> Twisted application I'm building.
>>
>> I would like in fact to distribute my application on some Unix machines
>> (onto which I cannot install anything)  which do *not* have Python and
>> Twisted (and not even GCC).
>>
>> Thank you in advance for any suggestion.
>>
>
> http://wiki.python.org/moin/Freeze might help.  I don't have any
> experiences
> using it with Twisted to share, though.
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081201/43fc3041/attachment.htm 

From rboulle at free.fr  Mon Dec  1 17:10:05 2008
From: rboulle at free.fr (=?UTF-8?B?UsOpbWkgQm91bGxl?=)
Date: Mon, 01 Dec 2008 23:10:05 +0100
Subject: [Twisted-Python] /CTCP user VERSION with twisted ?
Message-ID: <493460BD.8090104@free.fr>

Hi,

I am starting using twisted with an IRC LogBot based on this ones :
http://twistedmatrix.com/projects/words/documentation/examples/ircLogBot.py
I customized it a little bit...

When a user logs in (on the chan), I would like to send him a /CTCP user 
VERSION, read the reply and send onto the chan the VERSION name of this 
user.

In the API, I found this :
http://python.net/crew/mwh/apidocs/twisted.words.protocols.irc.IRCClient.html#ctcpQuery_VERSION
But it seems to be for the bot itself...

How could I do that and let everbody knows on the chan if user is using 
Xchat, irssi, mirc... ;) ?

Thanks.
R?mi.



From maarten at treewalker.org  Mon Dec  1 18:22:13 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Tue, 2 Dec 2008 00:22:13 +0100
Subject: [Twisted-Python] When would you considering split a server
	application to some physical instance with different logic function?
In-Reply-To: <befee6d80812010745r41da8efm8da141cd21898c@mail.gmail.com>
References: <befee6d80812010745r41da8efm8da141cd21898c@mail.gmail.com>
Message-ID: <200812020022.13503.maarten@treewalker.org>

On Monday 01 December 2008, Peter Cai wrote:

> As far as I know, some networking device manufactures use this model to
> implement their routers or switches.
> but I have never heard any examples besides that.

The Postfix mail server uses an architecture of many small processes working 
together:
  http://www.postfix.org/OVERVIEW.html

One of the big motivations for this architecture is security: each process 
only needs to run with the minimum privileges it needs to do its work. Just 
because SMTP has to listen to port 25 does not mean the entire mail server 
has to run as root.

> As twisted book says, most networking application use one of these 3
> modes:
>
> 1. handle each connection in a separate operating system process, in
> which case the operating system will take care
> of letting other processes run while one is waiting;
>
> 2. handle each connection in a separate thread1 in which the threading
> framework takes care of letting other threads
> run while one is waiting; or
>
> 3. use non-blocking system calls to handle all connections in one thread.
> (Like twisted or lib-event or just select)

This describes how multiple connections can be handled (for example Apache 
has several different approaches for this), which is a different issue from 
spreading functionality over different processes (like Postfix does).

Where do you expect the bottleneck to be in your application? Does it have 
to serve a large number of clients? Does it have to send or receive large 
amounts of data? Does it have to do heavy computations? Does it have to get 
data to or from external servers like a DB server or a web service?

> After considering for a while,  I thought there are some faults in the
> multiple parts model:
>
> 1. Writing code to handle message is much more tedious than just doing
> function calls
> 2. It's not very easy to make a pipe line works fine.

It depends a lot on what you are trying to build and where and how you make 
the splits between differents parts of your application.

For example a function call is simple in the case there is only one thread 
and the called operation will not block. If it does block, you need to add a 
callback mechanism like Twisted's Deferred. Or if there are multiple 
threads, you have to be very careful about which functions you are allowed 
to call while your thread is holding one or more locks. So a function call 
is not so simple anymore when it's part of a complex application...

There are libraries that make communication over a pipe more friendly, such 
as Perspective Broker or Foolscap. This does not mean you can replace any 
arbitrary function call by a remote method call, but it does mean you can 
skip writing (de)serialization code again and again.

No matter which model you choose, dividing your application into 
communicating blocks is a good idea: it is absolutely necessary when using 
multiple processes, if avoids a lot of locking issues when using threads and 
it makes your application easier to test in all three models.

Bye,
		Maarten




From gabriel.rossetti at arimaz.com  Tue Dec  2 02:34:19 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 02 Dec 2008 08:34:19 +0100
Subject: [Twisted-Python] XMPP server connection question
Message-ID: <4934E4FB.1060605@arimaz.com>

Hello everyone,

I wrote an XMPP client and I have a question, when it tries to connect 
and the server is not listening, it doesn't send back an error and tries 
forever. I see that this function (twisted/names/srvconnect.py):

def _ebGotServers(self, failure):
        failure.trap(DNSNameError)

        # Some DNS servers reply with NXDOMAIN when in fact there are
        # just no SRV records for that domain. Act as if we just got an
        # empty response and use fallback.

        self.servers = []
        self.orderedServers = []

traps the exception so it never propagates to me, so I can't handle it. 
Any ideas? I using the XMPP client example as a base for my code.

Thank you,
Gabriel




From adigeaydin at gmail.com  Tue Dec  2 07:29:54 2008
From: adigeaydin at gmail.com (=?ISO-8859-9?Q?Ayd=FDn_=DEEN?=)
Date: Tue, 2 Dec 2008 14:29:54 +0200
Subject: [Twisted-Python] Twisted with PyQt
Message-ID: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>

Hi,
i am using qt4reactor with twisted. My app structure is below:

i have pyqt class

class MainWindow(Object):
    bla
    bla
    bla
    from twisted.internet import reactor
    reactor.connectTCP('192.168.1.100', 8000, ClientFactory_(self)) # i am
sending qt object to clientFactory

class ClientFactory_(ClientFactory):
    def __init__(self,ui):
        self.ui = ui
    def buildProtocol(self, addr):
         return Uploader(self.ui)
     bla
     bla

class Uploader(Protocol):
    def __init__(self,ui):
       self.ui = ui
    """ Some upload stuffs"""
    bla
    bla
    bla
    def updateProgressBar(self, newValue):
       self.ui.progressBar.setValue(newValue)

i am updating my progressBar from Upload class, but window is freezing when
i do it (only progressBar isnot, others are freezing when i upload file).
How can i solve this, how can i design it?

Thanks all..

-- 
Ayd?n ?EN

         Ege ?niversitesi
Uluslararas? Bilgisayar Enstit?s?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081202/2312ec90/attachment.htm 

From gabriel.rossetti at arimaz.com  Tue Dec  2 08:21:17 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 02 Dec 2008 14:21:17 +0100
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <4934E4FB.1060605@arimaz.com>
References: <4934E4FB.1060605@arimaz.com>
Message-ID: <4935364D.8060208@arimaz.com>

Gabriel Rossetti wrote:
> Hello everyone,
>
> I wrote an XMPP client and I have a question, when it tries to connect 
> and the server is not listening, it doesn't send back an error and 
> tries forever. I see that this function (twisted/names/srvconnect.py):
>
> def _ebGotServers(self, failure):
>        failure.trap(DNSNameError)
>
>        # Some DNS servers reply with NXDOMAIN when in fact there are
>        # just no SRV records for that domain. Act as if we just got an
>        # empty response and use fallback.
>
>        self.servers = []
>        self.orderedServers = []
>
> traps the exception so it never propagates to me, so I can't handle 
> it. Any ideas? I using the XMPP client example as a base for my code.
>
> Thank you,
> Gabriel
Ok, the code I showed has nothing to do with the problem I think, what I 
don't get is the client never returns an error if nobody's listening...

Best regards,
Gabriel



From reynold.lei at gmail.com  Tue Dec  2 08:38:18 2008
From: reynold.lei at gmail.com (lei ren)
Date: Tue, 2 Dec 2008 21:38:18 +0800
Subject: [Twisted-Python] how to get the user's input
Message-ID: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>

hello ,everybody:
   i am a new to use the twisted. i woul'd like to complete a WEBGAME with
it.but i have a problem for the twisted
i have complete the server ,and the simple client.but ,i want to the client
have more function. one is let the usr input some command to the server
but when i write the code ,i found it's hard ,if i want to get the user's
input with raw_input() in a while loop,but it will block to wait the user'
input
what can i do for this .use thread? of twisted have some more power feature
for the problem,,thank you every body

ps:the problem like a MUD game ,user can send the command to the server and
reveive the message from server .and the user can send command everytime
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081202/f282c413/attachment.htm 

From Sven-Erik.Tiberg at ltu.se  Tue Dec  2 08:45:49 2008
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Tue, 2 Dec 2008 14:45:49 +0100
Subject: [Twisted-Python] www.lua.org with twisted.python
Message-ID: <668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>

Hi

Looking at lua as a possbile network protocol for distributed
simulations.
Anyone used www.lua.org in twisted.
Pro and Con?

/BG 
Sven-Erik Tiberg / ITS
Lulea Univ of Technology
Sweden



From maarten at treewalker.org  Tue Dec  2 08:47:58 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Tue, 2 Dec 2008 14:47:58 +0100
Subject: [Twisted-Python] how to get the user's input
In-Reply-To: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>
References: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>
Message-ID: <200812021447.58619.maarten@treewalker.org>

On Tuesday 02 December 2008, lei ren wrote:

> if i want to get the
> user's input with raw_input() in a while loop,but it will block to wait
> the user' input
> what can i do for this .use thread? of twisted have some more power
> feature for the problem,,thank you every body

Maybe you can put sys.stdin in non-blocking mode? I never tried it though.

Bye,
		Maarten




From christopher.zorn at gmail.com  Tue Dec  2 08:59:37 2008
From: christopher.zorn at gmail.com (Christopher Zorn)
Date: Tue, 2 Dec 2008 08:59:37 -0500
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <4935364D.8060208@arimaz.com>
References: <4934E4FB.1060605@arimaz.com> <4935364D.8060208@arimaz.com>
Message-ID: <149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>

On Tue, Dec 2, 2008 at 8:21 AM, Gabriel Rossetti <
gabriel.rossetti at arimaz.com> wrote:

> Gabriel Rossetti wrote:
>
>> Hello everyone,
>>
>> I wrote an XMPP client and I have a question, when it tries to connect and
>> the server is not listening, it doesn't send back an error and tries
>> forever. I see that this function (twisted/names/srvconnect.py):
>>
>> def _ebGotServers(self, failure):
>>       failure.trap(DNSNameError)
>>
>>       # Some DNS servers reply with NXDOMAIN when in fact there are
>>       # just no SRV records for that domain. Act as if we just got an
>>       # empty response and use fallback.
>>
>>       self.servers = []
>>       self.orderedServers = []
>>
>> traps the exception so it never propagates to me, so I can't handle it.
>> Any ideas? I using the XMPP client example as a base for my code.
>>
>> Thank you,
>> Gabriel
>>
> Ok, the code I showed has nothing to do with the problem I think, what I
> don't get is the client never returns an error if nobody's listening...
>

It may be better to show a log of what is happening.

It should show something like the following :

2008-12-02 08:57:01-0500 [-] reactor class:
twisted.internet.selectreactor.SelectReactor.
2008-12-02 08:57:01-0500 [-] Starting factory
<twisted.words.protocols.jabber.xmlstream.XmlStreamFactory object at
0xf6b490>
2008-12-02 08:57:02-0500 [-] /etc/resolv.conf changed, reparsing
2008-12-02 08:57:02-0500 [-] Resolver added ('192.168.2.1', 53) to server
list
2008-12-02 08:57:02-0500 [-] <class 'twisted.names.dns.DNSDatagramProtocol'>
starting on 31847
2008-12-02 08:57:02-0500 [-] Starting protocol
<twisted.names.dns.DNSDatagramProtocol object at 0xfb9a90>
2008-12-02 08:57:02-0500 [-] (Port 31847 Closed)
2008-12-02 08:57:02-0500 [-] Stopping protocol
<twisted.names.dns.DNSDatagramProtocol object at 0xfb9a90>
2008-12-02 08:57:02-0500 [-] <twisted.names.srvconnect.SRVConnector instance
at 0xa236c8> will retry in 2 seconds
2008-12-02 08:57:02-0500 [-] Stopping factory
<twisted.words.protocols.jabber.xmlstream.XmlStreamFactory object at
0xf6b490>

This will keep trying until you quit. You can set a limit on how many times
it retries.



>
> Best regards,
>
> Gabriel
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081202/db253d0d/attachment.htm 

From exarkun at divmod.com  Tue Dec  2 09:10:02 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 2 Dec 2008 09:10:02 -0500
Subject: [Twisted-Python] Twisted with PyQt
In-Reply-To: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>
Message-ID: <20081202141003.20272.225735855.divmod.quotient.14520@ohm>

On Tue, 2 Dec 2008 14:29:54 +0200, Ayd?n ?EN <adigeaydin at gmail.com> wrote:
>Hi,
>i am using qt4reactor with twisted. My app structure is below:
>
>i have pyqt class
>
> [snip]
>
>i am updating my progressBar from Upload class, but window is freezing when
>i do it (only progressBar isnot, others are freezing when i upload file).
>How can i solve this, how can i design it?

You've probably omitted too many details for anyone to know what is causing
the problem or make a suggestion about how to fix it.  Try posting a complete,
minimal example which demonstrates the problem so that others can reproduce it
themselves.

Jean-Paul



From exarkun at divmod.com  Tue Dec  2 09:11:01 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 2 Dec 2008 09:11:01 -0500
Subject: [Twisted-Python] how to get the user's input
In-Reply-To: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>
Message-ID: <20081202141101.20272.339042903.divmod.quotient.14522@ohm>

On Tue, 2 Dec 2008 21:38:18 +0800, lei ren <reynold.lei at gmail.com> wrote:
>hello ,everybody:
>   i am a new to use the twisted. i woul'd like to complete a WEBGAME with
>it.but i have a problem for the twisted
>i have complete the server ,and the simple client.but ,i want to the client
>have more function. one is let the usr input some command to the server
>but when i write the code ,i found it's hard ,if i want to get the user's
>input with raw_input() in a while loop,but it will block to wait the user'
>input
>what can i do for this .use thread? of twisted have some more power feature
>for the problem,,thank you every body
>
>ps:the problem like a MUD game ,user can send the command to the server and
>reveive the message from server .and the user can send command everytime
>

The way to read from stdin without blocking the reactor is to use
twisted.internet.stdio.StandardIO, a transport which lets a protocol
interact with standard in and standard out.

Jean-Paul



From exarkun at divmod.com  Tue Dec  2 09:11:39 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 2 Dec 2008 09:11:39 -0500
Subject: [Twisted-Python] www.lua.org with twisted.python
In-Reply-To: <668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
Message-ID: <20081202141139.20272.1376079508.divmod.quotient.14523@ohm>

On Tue, 2 Dec 2008 14:45:49 +0100, Sven-Erik Tiberg <sven-erik.tiberg at ltu.se> wrote:
>Hi
>
>Looking at lua as a possbile network protocol for distributed
>simulations.
>Anyone used www.lua.org in twisted.
>Pro and Con?

As far as I know, Lua isn't a network protocol, so your question doesn't
seem to make sense.  Can you be more specific?

Jean-Paul



From jarrod at vertigrated.com  Tue Dec  2 14:19:06 2008
From: jarrod at vertigrated.com (Jarrod Roberson)
Date: Tue, 2 Dec 2008 14:19:06 -0500
Subject: [Twisted-Python] www.lua.org with twisted.python
In-Reply-To: <668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
References: <AclUhEmFgVhhgCuaThqxk2YEoKLYsA==>
	<668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
Message-ID: <fa3d0c740812021119x523634f0h2065272aabbb1c9a@mail.gmail.com>

On Tue, Dec 2, 2008 at 8:45 AM, Sven-Erik Tiberg <Sven-Erik.Tiberg at ltu.se>wrote:

> Hi
>
> Looking at lua as a possbile network protocol for distributed
> simulations.
> Anyone used www.lua.org in twisted.
> Pro and Con?


lua is another scripting language, more aimed at embedding than python.
so what you are asking doesn't make much sense.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081202/9fd4d980/attachment.htm 

From Sven-Erik.Tiberg at ltu.se  Tue Dec  2 15:27:44 2008
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Tue, 2 Dec 2008 21:27:44 +0100
Subject: [Twisted-Python] www.lua.org with twisted.python
References: <AclUhEmFgVhhgCuaThqxk2YEoKLYsA==><668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
	<fa3d0c740812021119x523634f0h2065272aabbb1c9a@mail.gmail.com>
Message-ID: <668D1B8AD729C94DB91D17EC19B8BB9104E84FD6@EMMA.personal.adp.ltu.se>

Hi.
 
I know it now, put a completly wrong question on this forum.
 
The reason are that I'm looking for a protocol to exchange states of objects in 3D worlds ( web3d.org ) and simulation applications so it can form f.ex. driver simulators, flight simulators a.s.o.
In searching for a protocol that connect X3D sceens together, I found some X3D browsers that used custom defined protocols that are not open to make it possible to add other applications than the X3D browsers from the same company.
That's why I installed 2 of this browsers and protocol brokers in my systems to try them out and "sniff" the protocol using wireshark.
Found a chapter in wireshark describing a viewer for lua and assumed it was a networkprotocol, but so wrong I was.
Back to square one, in finding a protocol. Though there are the outdated protocol DIS ( Distributed Interactive Protocol ) defined in the X3D spec. the development for a new spec of protocol needs a boost.
Why bring twisted in to this, well there are a need for two lewel of distributed simulation, one in the same computer ( innerloop ) for fast resonse on stimuli on the model like a emidietly responce to turning of steeringwheel and one slower responce but more complex model ( outer loop ) like the responce of the car on the turning wheel with respect of suspension dynamic, wheel dynamic a.s.o. That need to transfere states over the network.
The innerloop could use python libs to read USB-streams from Human Interface Devices and make some calculations to send states to teh X3D model using twisted and a protocol. The other use of f.ex. twisted could be to interface a simulation engine like pyODE and more python libs or modelica.org or...
 
Have to search on for a usefull protocol, maybee xml based.
 
Thanks for the responces on my Q.
Have also asked at lua dev. group and their responce are the same, a bit negative compared to what I had hoped.
 
/bg
Sven-Erik

________________________________

From: twisted-python-bounces at twistedmatrix.com on behalf of Jarrod Roberson
Sent: Tue 12/2/2008 8:19 PM
To: Twisted general discussion
Subject: Re: [Twisted-Python] www.lua.org with twisted.python




On Tue, Dec 2, 2008 at 8:45 AM, Sven-Erik Tiberg <Sven-Erik.Tiberg at ltu.se> wrote:


	Hi
	
	Looking at lua as a possbile network protocol for distributed
	simulations.
	Anyone used www.lua.org <http://www.lua.org/>  in twisted.
	Pro and Con?


lua is another scripting language, more aimed at embedding than python.
so what you are asking doesn't make much sense. 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/ms-tnef
Size: 6081 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20081202/efd97a52/attachment.bin 

From jarrod at vertigrated.com  Tue Dec  2 16:10:33 2008
From: jarrod at vertigrated.com (Jarrod Roberson)
Date: Tue, 2 Dec 2008 16:10:33 -0500
Subject: [Twisted-Python] www.lua.org with twisted.python
In-Reply-To: <668D1B8AD729C94DB91D17EC19B8BB9104E84FD6@EMMA.personal.adp.ltu.se>
References: <668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
	<fa3d0c740812021119x523634f0h2065272aabbb1c9a@mail.gmail.com>
	<668D1B8AD729C94DB91D17EC19B8BB9104E84FD6@EMMA.personal.adp.ltu.se>
Message-ID: <fa3d0c740812021310x33a72da8t2218366956fa22e4@mail.gmail.com>

On Tue, Dec 2, 2008 at 3:27 PM, Sven-Erik Tiberg <Sven-Erik.Tiberg at ltu.se>wrote:

> Hi.
>
> I know it now, put a completly wrong question on this forum.
>
> The reason are that I'm looking for a protocol to exchange states of
> objects in 3D worlds ( web3d.org ) and simulation applications so it can
> form f.ex. driver simulators, flight simulators a.s.o.
> In searching for a protocol that connect X3D sceens together, I found some
> X3D browsers that used custom defined protocols that are not open to make it
> possible to add other applications than the X3D browsers from the same
> company.
> That's why I installed 2 of this browsers and protocol brokers in my
> systems to try them out and "sniff" the protocol using wireshark.
> Found a chapter in wireshark describing a viewer for lua and assumed it was
> a networkprotocol, but so wrong I was.
> Back to square one, in finding a protocol. Though there are the outdated
> protocol DIS ( Distributed Interactive Protocol ) defined in the X3D spec.
> the development for a new spec of protocol needs a boost.
> Why bring twisted in to this, well there are a need for two lewel of
> distributed simulation, one in the same computer ( innerloop ) for fast
> resonse on stimuli on the model like a emidietly responce to turning of
> steeringwheel and one slower responce but more complex model ( outer loop )
> like the responce of the car on the turning wheel with respect of suspension
> dynamic, wheel dynamic a.s.o. That need to transfere states over the
> network.
> The innerloop could use python libs to read USB-streams from Human
> Interface Devices and make some calculations to send states to teh X3D model
> using twisted and a protocol. The other use of f.ex. twisted could be to
> interface a simulation engine like pyODE and more python libs or
> modelica.org or...
>
> Have to search on for a usefull protocol, maybee xml based.


this is more of what you should be looking for http://www.opentnl.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081202/78d2e104/attachment.htm 

From reynold.lei at gmail.com  Tue Dec  2 21:55:46 2008
From: reynold.lei at gmail.com (lei ren)
Date: Wed, 3 Dec 2008 10:55:46 +0800
Subject: [Twisted-Python] how to get the user's input
In-Reply-To: <20081202141101.20272.339042903.divmod.quotient.14522@ohm>
References: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>
	<20081202141101.20272.339042903.divmod.quotient.14522@ohm>
Message-ID: <f14fd8f20812021855u7606879k918298a1fa12be2a@mail.gmail.com>

thanks jean-Pul.i can use commandline to intercat with server by the
StandardIO.
it's so easy with it

and there is a sample in Twisted NetWork Programming Essentials

wow

from twisted.internet import stdio, reactor, protocol
from twisted.protocols import basic
import re

class DataForwardingProtocol(protocol.Protocol):
    def _ _init_ _(self):
        self.output = None
        self.normalizeNewlines = False

    def dataReceived(self, data):
        if self.normalizeNewlines:
            data = re.sub(r"(\r\n|\n)", "\r\n", data)
        if self.output:
            self.output.write(data)

class StdioProxyProtocol(DataForwardingProtocol):
    def connectionMade(self):
        inputForwarder = DataForwardingProtocol( )
        inputForwarder.output = self.transport
        inputForwarder.normalizeNewlines = True
        stdioWrapper = stdio.StandardIO(inputForwarder)
        self.output = stdioWrapper
        print "Connected to server.  Press ctrl-C to close connection."

class StdioProxyFactory(protocol.ClientFactory):
    protocol = StdioProxyProtocol

    def clientConnectionLost(self, transport, reason):
        reactor.stop( )

    def clientConnectionFailed(self, transport, reason):
        print reason.getErrorMessage( )
        reactor.stop( )

if __name__ == '_ _main_ _':
    import sys
    if not len(sys.argv) == 3:
        print "Usage: %s host port" % _ _file_ _
        sys.exit(1)

    reactor.connectTCP(sys.argv[1], int(sys.argv[2]), StdioProxyFactory( ))

    reactor.run( )




On Tue, Dec 2, 2008 at 10:11 PM, Jean-Paul Calderone <exarkun at divmod.com>wrote:

> On Tue, 2 Dec 2008 21:38:18 +0800, lei ren <reynold.lei at gmail.com> wrote:
>
>> hello ,everybody:
>>  i am a new to use the twisted. i woul'd like to complete a WEBGAME with
>> it.but i have a problem for the twisted
>> i have complete the server ,and the simple client.but ,i want to the
>> client
>> have more function. one is let the usr input some command to the server
>> but when i write the code ,i found it's hard ,if i want to get the user's
>> input with raw_input() in a while loop,but it will block to wait the user'
>> input
>> what can i do for this .use thread? of twisted have some more power
>> feature
>> for the problem,,thank you every body
>>
>> ps:the problem like a MUD game ,user can send the command to the server
>> and
>> reveive the message from server .and the user can send command everytime
>>
>>
> The way to read from stdin without blocking the reactor is to use
> twisted.internet.stdio.StandardIO, a transport which lets a protocol
> interact with standard in and standard out.
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081203/c2397305/attachment.htm 

From adigeaydin at gmail.com  Wed Dec  3 06:13:12 2008
From: adigeaydin at gmail.com (=?ISO-8859-9?Q?Ayd=FDn_=DEEN?=)
Date: Wed, 3 Dec 2008 13:13:12 +0200
Subject: [Twisted-Python] Twisted with PyQt
In-Reply-To: <20081202141003.20272.225735855.divmod.quotient.14520@ohm>
References: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>
	<20081202141003.20272.225735855.divmod.quotient.14520@ohm>
Message-ID: <2196d7e0812030313x4d469567lab8c845796209174@mail.gmail.com>

Hi,
Actuallly i solved my problem but i have another one. I am sending file in
while loop, as you said before it doesnt send data pyhshically, i am
updating my progressBar in while loop, so the progressBar is being updated
before data being sent..

Is there any signal that self.transport.write() creates when data "really"
sent? May be i can update my progressBar with that signal..

Thanks..

-adige-

2008/12/2 Jean-Paul Calderone <exarkun at divmod.com>

> On Tue, 2 Dec 2008 14:29:54 +0200, Ayd?n ?EN <adigeaydin at gmail.com> wrote:
>
>> Hi,
>> i am using qt4reactor with twisted. My app structure is below:
>>
>> i have pyqt class
>>
>> [snip]
>>
>> i am updating my progressBar from Upload class, but window is freezing
>> when
>> i do it (only progressBar isnot, others are freezing when i upload file).
>> How can i solve this, how can i design it?
>>
>
> You've probably omitted too many details for anyone to know what is causing
> the problem or make a suggestion about how to fix it.  Try posting a
> complete,
> minimal example which demonstrates the problem so that others can reproduce
> it
> themselves.
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Ayd?n ?EN

         Ege ?niversitesi
Uluslararas? Bilgisayar Enstit?s?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081203/f70e44c7/attachment.htm 

From glyph at divmod.com  Wed Dec  3 09:05:11 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Wed, 03 Dec 2008 14:05:11 -0000
Subject: [Twisted-Python] Twisted with PyQt
In-Reply-To: <2196d7e0812030313x4d469567lab8c845796209174@mail.gmail.com>
References: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>
	<20081202141003.20272.225735855.divmod.quotient.14520@ohm>
	<2196d7e0812030313x4d469567lab8c845796209174@mail.gmail.com>
Message-ID: <20081203140511.12555.182819756.divmod.xquotient.653@weber.divmod.com>




On 11:13 am, adigeaydin at gmail.com wrote:
>Hi,
>Actuallly i solved my problem but i have another one. I am sending file 
>in
>while loop, as you said before it doesnt send data pyhshically, i am
>updating my progressBar in while loop, so the progressBar is being 
>updated
>before data being sent..
>
>Is there any signal that self.transport.write() creates when data 
>"really"
>sent? May be i can update my progressBar with that signal..

Sort of.  You shouldn't call transport.write() in a loop, you should 
register a producer for the transport and call transport.write when it's 
ready.  Documentation is here: 
http://twistedmatrix.com/projects/core/documentation/howto/producers.html



From adigeaydin at gmail.com  Wed Dec  3 11:18:17 2008
From: adigeaydin at gmail.com (=?ISO-8859-9?Q?Ayd=FDn_=DEEN?=)
Date: Wed, 3 Dec 2008 18:18:17 +0200
Subject: [Twisted-Python] Twisted with PyQt
In-Reply-To: <20081203140511.12555.182819756.divmod.xquotient.653@weber.divmod.com>
References: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>
	<20081202141003.20272.225735855.divmod.quotient.14520@ohm>
	<2196d7e0812030313x4d469567lab8c845796209174@mail.gmail.com>
	<20081203140511.12555.182819756.divmod.xquotient.653@weber.divmod.com>
Message-ID: <2196d7e0812030818g2941bd3bud72a9484e147b710@mail.gmail.com>

Yes, the point is Producer, i solved my problem.

Thanks all.

-adige-

2008/12/3 <glyph at divmod.com>

>
>
>
> On 11:13 am, adigeaydin at gmail.com wrote:
>
>> Hi,
>> Actuallly i solved my problem but i have another one. I am sending file in
>> while loop, as you said before it doesnt send data pyhshically, i am
>> updating my progressBar in while loop, so the progressBar is being updated
>> before data being sent..
>>
>> Is there any signal that self.transport.write() creates when data "really"
>> sent? May be i can update my progressBar with that signal..
>>
>
> Sort of.  You shouldn't call transport.write() in a loop, you should
> register a producer for the transport and call transport.write when it's
> ready.  Documentation is here:
> http://twistedmatrix.com/projects/core/documentation/howto/producers.html
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Ayd?n ?EN

         Ege ?niversitesi
Uluslararas? Bilgisayar Enstit?s?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081203/0e48285e/attachment.htm 

From sidharth.jain at gmail.com  Thu Dec  4 03:59:25 2008
From: sidharth.jain at gmail.com (Sidharth Jain)
Date: Thu, 4 Dec 2008 14:29:25 +0530
Subject: [Twisted-Python] monitoring net resources with twisted
Message-ID: <13a1329c0812040059w2fdff613h5a57e7ca837811ce@mail.gmail.com>

I want to track a set network resources like Linux servers,hosts for network
connectivity , and want to keep track of their activeness and possible
inactivity due to network outage or any other reason. The hosts/serves I'm
trying to monitor are regular Linux boxes with 2.6.x kernel. My personal
preference would be a dynamic background heart-beat process which could sit
on these servers/hosts and send periodic udp-packets to a master server to
signal host activity and inactivity.

As I'm quite new to twisted i would like to know if twisted provides any
functionality/libraries to do net monitoring.Any ideas using twisted to do
the same would be greatly appreciated.

Sid J
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081204/623e752d/attachment.htm 

From maarten at treewalker.org  Thu Dec  4 06:34:35 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Thu, 4 Dec 2008 12:34:35 +0100
Subject: [Twisted-Python] monitoring net resources with twisted
In-Reply-To: <13a1329c0812040059w2fdff613h5a57e7ca837811ce@mail.gmail.com>
References: <13a1329c0812040059w2fdff613h5a57e7ca837811ce@mail.gmail.com>
Message-ID: <200812041234.35715.maarten@treewalker.org>

On Thursday 04 December 2008, Sidharth Jain wrote:
> I want to track a set network resources like Linux servers,hosts for
> network connectivity , and want to keep track of their activeness and
> possible inactivity due to network outage or any other reason. The
> hosts/serves I'm trying to monitor are regular Linux boxes with 2.6.x
> kernel. My personal preference would be a dynamic background heart-beat
> process which could sit on these servers/hosts and send periodic
> udp-packets to a master server to signal host activity and inactivity.

You could certainly write that with Twisted, but why not adopt an existing 
monitoring application like Nagios or Zenoss?

Bye,
		Maarten




From sidharth.jain at gmail.com  Thu Dec  4 09:57:43 2008
From: sidharth.jain at gmail.com (Sidharth Jain)
Date: Thu, 4 Dec 2008 20:27:43 +0530
Subject: [Twisted-Python] monitoring net resources with twisted
In-Reply-To: <200812041234.35715.maarten@treewalker.org>
References: <13a1329c0812040059w2fdff613h5a57e7ca837811ce@mail.gmail.com>
	<200812041234.35715.maarten@treewalker.org>
Message-ID: <13a1329c0812040657t4f5a2981p8305f22746231ad9@mail.gmail.com>

Marteen ,

I certainly don't want to reinvent the wheel by building anything similar to
nagios.

I want to build a small deployable framework without any web-interface or
gui , which doesn't use any web server and should run without any manual
intervention most of the time. It can also be regarded as an automation tool
which will act on data collected after monitoring different hosts at regular
intervals. Depending the state of the resource (host/server) task could be
dynamically assigned to each of the available resources.

I think i wrongly stated my objective earlier, i should be dynamic resource
allocation through net monitoring .

-Sid J


On Thu, Dec 4, 2008 at 5:04 PM, Maarten ter Huurne
<maarten at treewalker.org>wrote:

> On Thursday 04 December 2008, Sidharth Jain wrote:
> > I want to track a set network resources like Linux servers,hosts for
> > network connectivity , and want to keep track of their activeness and
> > possible inactivity due to network outage or any other reason. The
> > hosts/serves I'm trying to monitor are regular Linux boxes with 2.6.x
> > kernel. My personal preference would be a dynamic background heart-beat
> > process which could sit on these servers/hosts and send periodic
> > udp-packets to a master server to signal host activity and inactivity.
>
> You could certainly write that with Twisted, but why not adopt an existing
> monitoring application like Nagios or Zenoss?
>
> Bye,
>                Maarten
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081204/92fe4ded/attachment.htm 

From thejayjay at gmail.com  Thu Dec  4 10:28:46 2008
From: thejayjay at gmail.com (James Joplin)
Date: Thu, 4 Dec 2008 10:28:46 -0500
Subject: [Twisted-Python] Strange downloadPage behavior with embedded Python
Message-ID: <d9b9b1220812040728t3683ca53m97642cbe9835366e@mail.gmail.com>

We have been using python embedded via the C API and have used Twisted for
various things.  We have come across some strange behavior and I cannot
figure out what is going on.


from twisted.internet import reactor
from twisted.web.client import downloadPage

...

def fetchRepo():
        global gameType, gameName, setupComplete, cp
        if (setupComplete):
                url = urlbase + "/" + gameType + "/" + gameName +
"/repo.ini"
                print "url is : " + url
                d = downloadPage(url, "C:\\svntest\\gamerepo.ini")
                d.addCallback(downloadSuccess)
                d.addErrback(downloadFailure)
                #cp.readfp(open("C:\\game-repo.ini"))
        else:
                print "urls not setup, throw errors etc."
...

This is an example of how we have been using downloadPage from
twisted.web.client.  I have no problems getting the example to work when I
make a simple app or write the code into the intrepeter.  But if I use it
inside my app I get the user timeout below.

Unhandled error in Deferred:
Traceback (most recent call last):
Failure: twisted.internet.error.TimeoutError: User timeout caused connection
failure.


Am I forgetting something trivial?  The reactor is running as we use PB for
database pooling.  Can I not call downloadPage after a reactor is setup and
connected?

James
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081204/1d187de7/attachment.htm 

From exarkun at divmod.com  Thu Dec  4 10:43:01 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 4 Dec 2008 10:43:01 -0500
Subject: [Twisted-Python] Strange downloadPage behavior with embedded
	Python
In-Reply-To: <d9b9b1220812040728t3683ca53m97642cbe9835366e@mail.gmail.com>
Message-ID: <20081204154301.20272.2075983920.divmod.quotient.15626@ohm>

On Thu, 4 Dec 2008 10:28:46 -0500, James Joplin <thejayjay at gmail.com> wrote:
>We have been using python embedded via the C API and have used Twisted for
>various things.  We have come across some strange behavior and I cannot
>figure out what is going on.
>
>
>from twisted.internet import reactor
>from twisted.web.client import downloadPage
>
>...
>
>def fetchRepo():
>        global gameType, gameName, setupComplete, cp
>        if (setupComplete):
>                url = urlbase + "/" + gameType + "/" + gameName +
>"/repo.ini"
>                print "url is : " + url
>                d = downloadPage(url, "C:\\svntest\\gamerepo.ini")
>                d.addCallback(downloadSuccess)
>                d.addErrback(downloadFailure)
>                #cp.readfp(open("C:\\game-repo.ini"))
>        else:
>                print "urls not setup, throw errors etc."
>...
>
>This is an example of how we have been using downloadPage from
>twisted.web.client.  I have no problems getting the example to work when I
>make a simple app or write the code into the intrepeter.  But if I use it
>inside my app I get the user timeout below.
>
>Unhandled error in Deferred:
>Traceback (most recent call last):
>Failure: twisted.internet.error.TimeoutError: User timeout caused connection
>failure.
>
>
>Am I forgetting something trivial?  The reactor is running as we use PB for
>database pooling.  Can I not call downloadPage after a reactor is setup and
>connected?

Calling downloadPage after reactor.run is fine.  I'd take a look at DNS and
firewall settings for problems there.

Jean-Paul



From thejayjay at gmail.com  Thu Dec  4 12:20:45 2008
From: thejayjay at gmail.com (James Joplin)
Date: Thu, 4 Dec 2008 12:20:45 -0500
Subject: [Twisted-Python] Strange downloadPage behavior with embedded
	Python
In-Reply-To: <20081204154301.20272.2075983920.divmod.quotient.15626@ohm>
References: <d9b9b1220812040728t3683ca53m97642cbe9835366e@mail.gmail.com>
	<20081204154301.20272.2075983920.divmod.quotient.15626@ohm>
Message-ID: <d9b9b1220812040920ydf57a99hf664d540a1d63cc8@mail.gmail.com>

Wow, I feel like an idiot now!  I never thought to test that.  Thank you so
much!

Is there any reason DNS would work in a standalone python app and when I
embed the library via the C API dns stops working?  Is there a library I
should import to fix that?

James

On Thu, Dec 4, 2008 at 10:43 AM, Jean-Paul Calderone <exarkun at divmod.com>wrote:

> On Thu, 4 Dec 2008 10:28:46 -0500, James Joplin <thejayjay at gmail.com>
> wrote:
>
>> We have been using python embedded via the C API and have used Twisted for
>> various things.  We have come across some strange behavior and I cannot
>> figure out what is going on.
>>
>>
>> from twisted.internet import reactor
>> from twisted.web.client import downloadPage
>>
>> ...
>>
>> def fetchRepo():
>>       global gameType, gameName, setupComplete, cp
>>       if (setupComplete):
>>               url = urlbase + "/" + gameType + "/" + gameName +
>> "/repo.ini"
>>               print "url is : " + url
>>               d = downloadPage(url, "C:\\svntest\\gamerepo.ini")
>>               d.addCallback(downloadSuccess)
>>               d.addErrback(downloadFailure)
>>               #cp.readfp(open("C:\\game-repo.ini"))
>>       else:
>>               print "urls not setup, throw errors etc."
>> ...
>>
>> This is an example of how we have been using downloadPage from
>> twisted.web.client.  I have no problems getting the example to work when I
>> make a simple app or write the code into the intrepeter.  But if I use it
>> inside my app I get the user timeout below.
>>
>> Unhandled error in Deferred:
>> Traceback (most recent call last):
>> Failure: twisted.internet.error.TimeoutError: User timeout caused
>> connection
>> failure.
>>
>>
>> Am I forgetting something trivial?  The reactor is running as we use PB
>> for
>> database pooling.  Can I not call downloadPage after a reactor is setup
>> and
>> connected?
>>
>
> Calling downloadPage after reactor.run is fine.  I'd take a look at DNS and
> firewall settings for problems there.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081204/5e82db6a/attachment.htm 

From muaazhussain128 at gmail.com  Fri Dec  5 03:46:22 2008
From: muaazhussain128 at gmail.com (Muaaz Hussain)
Date: Fri, 5 Dec 2008 11:46:22 +0300
Subject: [Twisted-Python] Re: Twisted-Python Digest, Vol 57, Issue 6
In-Reply-To: <E1L8HYa-0005lW-5r@cube.twistedmatrix.com>
References: <E1L8HYa-0005lW-5r@cube.twistedmatrix.com>
Message-ID: <1ac8ac10812050046o6b450f67wb7949c75f680dbe2@mail.gmail.com>

I'm  a beginner developer and I phase a problem in handling AJAX request by
the server .I wore server side program to read from ulogd  and diplay  ulogd
output  to the client browser using AJAX technology avialable in nevow
athena.
Also I wrote another one to display  tcpdump output .when  I render these
two applications together in the twisted web server .they work proberly and
I see the ulogd and tcpdump output in the client browser and AJAX work also
proberly to display updated output from the server.
  But I observed that when I open many browsers ,the server hang up because
the  load avarge of  the server  CPU  increasing  .the server print error
message "Athena transport duplicate message discarding... " after a few
minutes the OOM-killer of the linux kernel will kill the twisted porcess
because it consume large amount of time and memory.
is there any solution to this problem ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081205/8171c9a3/attachment.htm 

From p.mayers at imperial.ac.uk  Fri Dec  5 05:42:47 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Fri, 05 Dec 2008 10:42:47 +0000
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
References: <4934E4FB.1060605@arimaz.com> <4935364D.8060208@arimaz.com>
	<149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
Message-ID: <493905A7.7030209@imperial.ac.uk>

Christopher Zorn wrote:
> 
> 
> On Tue, Dec 2, 2008 at 8:21 AM, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com <mailto:gabriel.rossetti at arimaz.com>> wrote:
> 
>     Gabriel Rossetti wrote:
> 
>         Hello everyone,
> 
>         I wrote an XMPP client and I have a question, when it tries to
>         connect and the server is not listening, it doesn't send back an
>         error and tries forever. I see that this function
>         (twisted/names/srvconnect.py):
> 
>         def _ebGotServers(self, failure):
>               failure.trap(DNSNameError)
> 
>               # Some DNS servers reply with NXDOMAIN when in fact there are
>               # just no SRV records for that domain. Act as if we just
>         got an
>               # empty response and use fallback.
> 
>               self.servers = []
>               self.orderedServers = []
> 
>         traps the exception so it never propagates to me, so I can't
>         handle it. Any ideas? I using the XMPP client example as a base
>         for my code.
> 
>         Thank you,
>         Gabriel
> 
>     Ok, the code I showed has nothing to do with the problem I think,
>     what I don't get is the client never returns an error if nobody's
>     listening...
> 
> 
> It may be better to show a log of what is happening.
> 

Yeah, the t.w.p.j.xmlstream.XmlStreamFactory inherits from 
ReconnectingClientFactory, which is IMHO wrong.

See also:

http://twistedmatrix.com/trac/ticket/3492



From gabriel.rossetti at arimaz.com  Fri Dec  5 06:22:06 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 05 Dec 2008 12:22:06 +0100
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
References: <4934E4FB.1060605@arimaz.com> <4935364D.8060208@arimaz.com>
	<149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
Message-ID: <49390EDE.7080206@arimaz.com>

Christopher Zorn wrote:
>
>
> On Tue, Dec 2, 2008 at 8:21 AM, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com <mailto:gabriel.rossetti at arimaz.com>> wrote:
>
>     Gabriel Rossetti wrote:
>
>         Hello everyone,
>
>         I wrote an XMPP client and I have a question, when it tries to
>         connect and the server is not listening, it doesn't send back
>         an error and tries forever. I see that this function
>         (twisted/names/srvconnect.py):
>
>         def _ebGotServers(self, failure):
>               failure.trap(DNSNameError)
>
>               # Some DNS servers reply with NXDOMAIN when in fact
>         there are
>               # just no SRV records for that domain. Act as if we just
>         got an
>               # empty response and use fallback.
>
>               self.servers = []
>               self.orderedServers = []
>
>         traps the exception so it never propagates to me, so I can't
>         handle it. Any ideas? I using the XMPP client example as a
>         base for my code.
>
>         Thank you,
>         Gabriel
>
>     Ok, the code I showed has nothing to do with the problem I think,
>     what I don't get is the client never returns an error if nobody's
>     listening...
>
>
> It may be better to show a log of what is happening.
>
> It should show something like the following :
>
> 2008-12-02 08:57:01-0500 [-] reactor class: 
> twisted.internet.selectreactor.SelectReactor.
> 2008-12-02 08:57:01-0500 [-] Starting factory 
> <twisted.words.protocols.jabber.xmlstream.XmlStreamFactory object at 
> 0xf6b490>
> 2008-12-02 08:57:02-0500 [-] /etc/resolv.conf changed, reparsing
> 2008-12-02 08:57:02-0500 [-] Resolver added ('192.168.2.1 
> <http://192.168.2.1>', 53) to server list
> 2008-12-02 08:57:02-0500 [-] <class 
> 'twisted.names.dns.DNSDatagramProtocol'> starting on 31847
> 2008-12-02 08:57:02-0500 [-] Starting protocol 
> <twisted.names.dns.DNSDatagramProtocol object at 0xfb9a90>
> 2008-12-02 08:57:02-0500 [-] (Port 31847 Closed)
> 2008-12-02 08:57:02-0500 [-] Stopping protocol 
> <twisted.names.dns.DNSDatagramProtocol object at 0xfb9a90>
> 2008-12-02 08:57:02-0500 [-] <twisted.names.srvconnect.SRVConnector 
> instance at 0xa236c8> will retry in 2 seconds
> 2008-12-02 08:57:02-0500 [-] Stopping factory 
> <twisted.words.protocols.jabber.xmlstream.XmlStreamFactory object at 
> 0xf6b490>
>
> This will keep trying until you quit. You can set a limit on how many 
> times it retries.
>
>  
>
>
>     Best regards,
>
>     Gabriel
>
>     ______________________
>
>
Ok, I finally created a class that wraps the client.XMPPClientFactory 
function and calls callbacks when the connection fails. Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081205/b1f5d978/attachment.htm 

From gabriel.rossetti at arimaz.com  Fri Dec  5 06:23:08 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 05 Dec 2008 12:23:08 +0100
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <493905A7.7030209@imperial.ac.uk>
References: <4934E4FB.1060605@arimaz.com>
	<4935364D.8060208@arimaz.com>	<149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
	<493905A7.7030209@imperial.ac.uk>
Message-ID: <49390F1C.1010708@arimaz.com>

Phil Mayers wrote:
> Christopher Zorn wrote:
>>
>>
>> On Tue, Dec 2, 2008 at 8:21 AM, Gabriel Rossetti 
>> <gabriel.rossetti at arimaz.com <mailto:gabriel.rossetti at arimaz.com>> 
>> wrote:
>>
>>     Gabriel Rossetti wrote:
>>
>>         Hello everyone,
>>
>>         I wrote an XMPP client and I have a question, when it tries to
>>         connect and the server is not listening, it doesn't send back an
>>         error and tries forever. I see that this function
>>         (twisted/names/srvconnect.py):
>>
>>         def _ebGotServers(self, failure):
>>               failure.trap(DNSNameError)
>>
>>               # Some DNS servers reply with NXDOMAIN when in fact 
>> there are
>>               # just no SRV records for that domain. Act as if we just
>>         got an
>>               # empty response and use fallback.
>>
>>               self.servers = []
>>               self.orderedServers = []
>>
>>         traps the exception so it never propagates to me, so I can't
>>         handle it. Any ideas? I using the XMPP client example as a base
>>         for my code.
>>
>>         Thank you,
>>         Gabriel
>>
>>     Ok, the code I showed has nothing to do with the problem I think,
>>     what I don't get is the client never returns an error if nobody's
>>     listening...
>>
>>
>> It may be better to show a log of what is happening.
>>
>
> Yeah, the t.w.p.j.xmlstream.XmlStreamFactory inherits from 
> ReconnectingClientFactory, which is IMHO wrong.
>
> See also:
>
> http://twistedmatrix.com/trac/ticket/3492
>
Yes, so do I.



From twisted at ralphm.ik.nu  Fri Dec  5 06:23:42 2008
From: twisted at ralphm.ik.nu (Ralph Meijer)
Date: Fri, 05 Dec 2008 12:23:42 +0100
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <493905A7.7030209@imperial.ac.uk>
References: <4934E4FB.1060605@arimaz.com>
	<4935364D.8060208@arimaz.com>	<149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
	<493905A7.7030209@imperial.ac.uk>
Message-ID: <49390F3E.3030201@ralphm.ik.nu>

On 2008-12-05 11:42, Phil Mayers wrote:
> Christopher Zorn wrote:
>
> Yeah, the t.w.p.j.xmlstream.XmlStreamFactory inherits from 
> ReconnectingClientFactory, which is IMHO wrong.
> 
> See also:
> 
> http://twistedmatrix.com/trac/ticket/3492

Wrong? It was just a design choice for this particular factory, made 
more than five years ago. Since then, the code has been refactored in 
such a way that it is pretty straightforward to have a non-reconnecting 
XMPP client:

-----8<-----8<-----8<-----
from twisted.words.xish.xmlstream import BootstrapMixin
from twisted.internet import protocol

class NonReconnectingXmlStreamFactory(BootstrapMixin,
                                       protocol.ClientFactory):
     """
     XmlStream factory that connects at most once.

     @ivar authenticator: The authenticator to be associated with the
                          XmlStream once a connection has been
                          established.
     """

     def __init__(self, authenticator):
         xmlstream.BootstrapMixin.__init__(self)
         self.authenticator = authenticator

     def buildProtocol(self, addr):
         """
         Create an instance of XmlStream and associate the authenticator.
         """
         xs = self.protocol(authenticator)
         self.installBootstraps(xs)
         return xs
-----8<-----8<-----8<-----

You can then also override protocol.ClientFactory's
clientConnectionFailed and clientConnectionLost as desirable. You should
probably add bootstrap handlers for STREAM_AUTHD_EVENT,
INIT_FAILED_EVENT, STREAM_ERROR_EVENT somewhere.

I have a similar special client factory in Wokkel that fires a deferred
as soon as a connection was made and the stream is authenticated. See
wokkel.client.DeferredClientFactory.

ralphm




From dushik at gmail.com  Fri Dec  5 06:44:40 2008
From: dushik at gmail.com (Andrey Kravchuk)
Date: Fri, 5 Dec 2008 13:44:40 +0200
Subject: [Twisted-Python] OSCAR buddy list
Message-ID: <a6c8aa390812050344tec58c81n28503b0a6ed017ea@mail.gmail.com>

Hi.

I am trying to implement an ICQ service using twisted OSCAR protocol.

Everything works fine so far, but i can't find out how to handle the
buddy list there. I can't find anything on this topic neither in
documentation, nor in this list or the source code. Please advice, or
if this is not implemented yet, please tell me where to look so i
could make a patch.

The main problem is if i connect to ICQ service with twisted, the user
appears offline for other users. In order to see his status change I
need to "request authorization" and the service must "grant
authorization". There was a time not so long ago when it was not
required, you could just set "authorization not required" in account
profile and it worked fine, but now it doesn't. Newly added users
appear in my contact list always offline.



From alecf at metaweb.com  Fri Dec  5 15:47:36 2008
From: alecf at metaweb.com (Alec Flett)
Date: Fri, 5 Dec 2008 12:47:36 -0800
Subject: [Twisted-Python] one-shot reactor?
Message-ID: <26702188-2E6D-48BC-B6A6-6332925A5547@metaweb.com>

Hey folks -
So I'm trying what seems to be a fairly unusual use of Twisted, but  
I'm hoping that someone out there has tried the same thing as me and  
can offer some pointers. Bear with me as I explain how we're set up.  
The issues I'm having are at the end..

We're running Pylons as our appserver, but almost all of our internal  
requests from the appserver are actually retrieved over HTTP - i.e.  
database requests, LOBs, etc... we also have one or two other  
proprietary connections that would benefit from asynchronous TCP  
access.. For years I've heard people raving about twisted, and I hate  
threads, so I thought I'd give it a shot.

So here's how this is working, at least in my early prototypes: Pylons  
is a WSGI environment, which means it needs a real callstack for each  
request.

Each request is more or less its own single-threaded environment, and  
the thread is only making new requests to internal services, not  
listening on any ports. So really Twisted is a client here, not a  
server. For each HTTP request, I'm running a "private" twisted reactor  
that simply runs until it runs out of reads/writes/delayedCalls.  My  
theory is this: in a single-threaded environment that is not listening  
for new connections.

So what I've done is make twisted.internet.reactor into a threadlocal  
object with Paste's StackedObjectProxy.

So far I have this mostly working, but I've hit a few stumbling blocks  
along the way:

1) it would be nice if the standard twisted reactors had an API for  
running in a one-off client mode - something like a  
reactor.runUntilExhausted(). I did write a kind of scheduler that does  
this for me (more on that below)

2) it's vaguely annoying that reactors aren't restartable - it means I  
have to destroy any reactor that's left around from the last request.  
Not a huge deal, but I'd much rather just create a single reactor that  
lives the life of the thread, and be able to call .run() / .stop()  
over and over.

3) I've attached my scheduler below. I hook it up with  
reactor.callLater(0, stop_when_complete).

The problem I'm running into with this approach is that many APIs like  
getPage() set a 30 second timeout, and then cancel the timeout later  
when it successfully retrieves the page.

My scheduler picks up the fact that there is a 30-second timeout, but  
because HTTPClientProtocol cancels the timeout, my scheduler isn't  
aware of that, and has already scheduled itself for 30 seconds into  
the future, so it can't call reactor.stop(). So instead, I wake up at  
most every 0.1 seconds - but that kind of defeats the point of the  
reactor blocking on select()/poll() if I have to keep waking up!

Maybe there's a better approach? What I kind of want is a hook into  
the reactor's runUntilCurrent() so I just get notified right before  
the select()/poll(). I'm considering just subclassing the reactor to  
hook into this.. ?


def stop_when_complete(reactor, running=False):
     all_pending = (reactor.getReaders() +
                    reactor.getWriters() +
                    reactor.getDelayedCalls())

     # depending on the platform, the waker is probably in there, and
     # shouldn't count as a pending event
     if reactor.waker in all_pending:
         all_pending.remove(reactor.waker)

     # ok, are we done? if so, tell the reactor to stop after its next
     # iteration.
     if not all_pending:
         reactor.stop()
         return

     # if we got here, we need to basically wait again to see if
     # there's anything left. We get the timeout for the next event, so
     # that we don't wake any more than we would have (this is how
     # ReactorBase.mainLoop works)
     timeout = reactor.timeout()
     if timeout is None:
         timeout = 0.0
     print "Sleeping for no more than %s seconds" % min(timeout, 0.1)
     reactor.callLater(min(timeout, 0.1),
                       stop_when_complete, reactor, running=True)




From nico at teknico.net  Sat Dec  6 02:38:43 2008
From: nico at teknico.net (Nicola Larosa)
Date: Sat, 06 Dec 2008 08:38:43 +0100
Subject: [Twisted-Python] Re: A Python metaclass for Twisted allowing
	__init__ to return a Deferred
References: <18702.15428.547828.694260@jon.es>
	<18703.8010.379291.213184@jon.es>
	<20081103201709.6400.1212227518.divmod.xquotient.746@weber.divmod.com>
	<18703.46231.594938.56742@jon.es>
	<20081104111127.6400.342806414.divmod.xquotient.903@weber.divmod.com>
	<18704.28330.986594.539860@jon.es>
Message-ID: <200812060738.mB67ci0X032297@smtpi1.ngi.it>

Terry Jones wrote:
> BTW, I spent an interesting morning getting my head around *exactly* how
> inlineCallbacks does its thing... No summary of my thoughts could do it
> justice. I wonder how many people on the planet have been down that rabbit
> hole.

Not me, man, not me. I just use the bloody thing, and curse it when it
shortens tracebacks.


> I hope people don't mind my peanut gallery commentary. We're all in this
> together, after all. A little gallows humor occasionally seems in order.

Again, certainly not me. Go right ahead! ;-)

-- 
Nicola Larosa - http://www.tekNico.net/

The rhythm section responds to the orchestra in a way that makes it
significant for a jazz record [Epiphany]. Having a rhythm section
respond to the stimulus of the other players is what jazz is all about. 
 - Vince Mendoza, September 2007





From terry at jon.es  Sat Dec  6 03:06:36 2008
From: terry at jon.es (Terry Jones)
Date: Sat, 6 Dec 2008 09:06:36 +0100
Subject: [Twisted-Python] Re: A Python metaclass for Twisted allowing
	__init__ to return a Deferred
In-Reply-To: Your message at 08:38:43 on Saturday, 6 December 2008
References: <18702.15428.547828.694260@jon.es>
	<18703.8010.379291.213184@jon.es>
	<20081103201709.6400.1212227518.divmod.xquotient.746@weber.divmod.com>
	<18703.46231.594938.56742@jon.es>
	<20081104111127.6400.342806414.divmod.xquotient.903@weber.divmod.com>
	<18704.28330.986594.539860@jon.es>
	<200812060738.mB67ci0X032297@smtpi1.ngi.it>
Message-ID: <18746.12940.638819.228559@jon.es>

Hi Nicola!

>>>>> "Nicola" == Nicola Larosa <nico at teknico.net> writes:
Nicola> Terry Jones wrote:
>> BTW, I spent an interesting morning getting my head around *exactly* how
>> inlineCallbacks does its thing... No summary of my thoughts could do it
>> justice. I wonder how many people on the planet have been down that
>> rabbit hole.

Nicola> Not me, man, not me. I just use the bloody thing, and curse it when
Nicola> it shortens tracebacks.

I know exactly what you're talking about, and I hated that too. But I dug
into that and found out where the problem was: I didn't know Python well
enough :-)

I bet you're doing something like this:

@inlineCallbacks
def f():
    # Whatever
    try:
        # Your code here
    except Exception, e:
        # Do some cleaning up, maybe write to the log, maybe call another
        # function that uses inlineCallbacks
        raise e

or just

@inlineCallbacks
def f():
    # Whatever
    try:
        # Your code here
    except Exception:
        # Do some cleaning up, maybe write to the log, maybe call another
        # function that uses inlineCallbacks
        raise


The problem here is that you're not using the 3-argument form of raise. So
you're either dropping information (with the raise e) or pulling out the
last exception (with the no-arg raise).

Consider the latter case. Suppose your cleanup code calls another function
that uses inlineCallbacks. That function will eventually raise
StopIteration or raise via calling defer.returnValue. So by the time
control returns to your code, your raise (which implicitly uses
sys.exc_info()) raises the wrong exception! So you get e.g., a
StopIteration exception coming at you out of your inlineCallbacks function
and you curse the thing :-) This applies if your cleanup code calls any
iterator, or if you call something that try/except catches a KeyError, etc.

So just use

@inlineCallbacks
def f():
    # Whatever
    try:
        # Your code here
    except Exception:
        info = sys.exc_info()
        # Do some cleaning up, maybe write to the log, maybe call another
        # function that uses inlineCallbacks
        raise info[0], info[1], info[2]

and it just works. Try it :-) You cant do anything nice like raise *info
because Python's parser doesn't like that (AFAIR).

I nearly posted about this to the list, but I figured it might help if I
had more of a clue about Python itself, seeing as what I was doing was
nothing to do with Twisted.


>> I hope people don't mind my peanut gallery commentary. We're all in this
>> together, after all. A little gallows humor occasionally seems in order.
Nicola> Again, certainly not me. Go right ahead! ;-)

Don't encourage me...

Terry



From exarkun at twistedmatrix.com  Sun Dec  7 00:05:20 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 07 Dec 2008 05:05:20 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1228626320.88.1735343683@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081207/1a4082d5/attachment.htm 

From gabriel.rossetti at arimaz.com  Mon Dec  8 04:27:41 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 08 Dec 2008 10:27:41 +0100
Subject: [Twisted-Python] Deferred question
Message-ID: <493CE88D.3070507@arimaz.com>

Hello everyone,

I have a question concerning defers, I have a service that needs to 
query IO until it answers. The IO can be disconnected, connected but 
off, connected and on; depending on the state I get different 
exceptions. I wrote something like :

def __requestId(self, _):
        d = self.callPlugin(PLUGIN_NAME)
        d.addCallback(self.__receivedAns)
        d.addErrback(self.__requestId)

The plugin makes the request in a thread and the deferred is returned 
and called when either an answer is received or am exception is raised 
(e.g. timeout, missing hardware, etc)

This seams to work well, except that when I let the system run for a 
long time without the hardware being present or off (several hours/days) 
the memory consumption goes way up. I don' t really know what is causing 
this, and I'm looking for possible reasons, so I was wondering if maybe 
this could be what is causing the problem. It's probably not that, 
because from what I understand it works like this :

   1. the first request is made
   2. there is a timeout or something that raises the exception
   3. the errback gets called
   4. it makes a new request
   5. the deferred gets garbage collected
   6. the new request follows the same path

Can anyone confirm that this is correct, or are my defers somehow 
staying alive and not being garbage collected?

Thank you,
Gabriel Rossetti



From samslists at gmail.com  Mon Dec  8 19:00:18 2008
From: samslists at gmail.com (Sam's Lists)
Date: Mon, 8 Dec 2008 16:00:18 -0800
Subject: [Twisted-Python] Compress/deflate support for getPage...
Message-ID: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>

Is there any support for compress/deflate for webpages using the web client
via getPage?

If not, does anyone have a wrapper function before I make my own?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081208/008dd1a0/attachment.htm 

From alecf at metaweb.com  Mon Dec  8 19:47:50 2008
From: alecf at metaweb.com (Alec Flett)
Date: Mon, 8 Dec 2008 16:47:50 -0800
Subject: [Twisted-Python] Compress/deflate support for getPage...
In-Reply-To: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
References: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
Message-ID: <15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>

Along similar lines, is there a better API than getPage() that allows  
you to get headers, content-type, etc? The below could be easiliy  
implemented as a callback if the callback knew what headers it got, so  
it knew whether or not to deflate the body.

Alec

On Dec 8, 2008, at 4:00 PM, Sam's Lists wrote:

> Is there any support for compress/deflate for webpages using the web  
> client via getPage?
>
> If not, does anyone have a wrapper function before I make my own?
>
> Thanks
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From aaron.devore at gmail.com  Mon Dec  8 22:32:24 2008
From: aaron.devore at gmail.com (Aaron DeVore)
Date: Mon, 8 Dec 2008 19:32:24 -0800
Subject: [Twisted-Python] Compress/deflate support for getPage...
In-Reply-To: <15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
References: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
	<15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
Message-ID: <2ead2fb0812081932j7d1194fcy75464b856380e50@mail.gmail.com>

For a recent project I directly used HTTPClientFactory, the factory
that getPage is based on. That required a bit more effort than a
simple getPage(...).addCallback(func) but it wasn't terrible.

-Aaron

On Mon, Dec 8, 2008 at 4:47 PM, Alec Flett <alecf at metaweb.com> wrote:
> Along similar lines, is there a better API than getPage() that allows you to
> get headers, content-type, etc? The below could be easiliy implemented as a
> callback if the callback knew what headers it got, so it knew whether or not
> to deflate the body.
>
> Alec
>
> On Dec 8, 2008, at 4:00 PM, Sam's Lists wrote:
>
>> Is there any support for compress/deflate for webpages using the web
>> client via getPage?
>>
>> If not, does anyone have a wrapper function before I make my own?
>>
>> Thanks
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From glyph at divmod.com  Mon Dec  8 23:34:53 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 09 Dec 2008 04:34:53 -0000
Subject: [Twisted-Python] Compress/deflate support for getPage...
In-Reply-To: <15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
References: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
	<15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
Message-ID: <20081209043453.12555.1842136836.divmod.xquotient.1812@weber.divmod.com>


getPage has a number of deficiencies.  JP Calderone and Itamar Shtull- 
Trauring have been working on this ticket: 
<http://twistedmatrix.com/trac/ticket/886> which (among other things) 
adds support for response headers and the hooks with which one would 
implement deflate support.

On 12:47 am, alecf at metaweb.com wrote:
>Along similar lines, is there a better API than getPage() that allows 
>you to get headers, content-type, etc? The below could be easiliy 
>implemented as a callback if the callback knew what headers it got, so 
>it knew whether or not to deflate the body.
>
>Alec
>
>On Dec 8, 2008, at 4:00 PM, Sam's Lists wrote:
>>Is there any support for compress/deflate for webpages using the web 
>>client via getPage?
>>
>>If not, does anyone have a wrapper function before I make my own?
>>
>>Thanks
>>
>>_______________________________________________
>>Twisted-Python mailing list
>>Twisted-Python at twistedmatrix.com
>>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From alessio.pace at gmail.com  Tue Dec  9 03:55:35 2008
From: alessio.pace at gmail.com (Alessio Pace)
Date: Tue, 9 Dec 2008 09:55:35 +0100
Subject: [Twisted-Python] Running commands / collecting datas via SSH on
	many machines: Twisted vs plain old scripts ?
Message-ID: <84987d20812090055n3282b4e6t329f6d3937a28e72@mail.gmail.com>

Hi,

I have to run commands and (later in time) collect logs from many machines,
connecting through SSH.

I was _genuinely_ wondering what an SSH client written in Twisted could give
me more than executing plain old shell scripts in a for loop.

>From what I saw, given the fact that my run/collect commands remain still
shell commands (cp, tar, etc...), the only thing that may change is that
using Twisted I could have a better utilization of resources rather than a
simple shell for loop in which I iterate in order over all the machines on
which I have to issue commands.

Am I missing something? I would like to stress the fact that I'm asking this
as a very specific question for Twisted usage in the context of
running/retrieving results on remote machines (as indeed I already happily
use Twisted for running custom network protocols) and I would right to
choose a simple but effective solution for this case.

Thanks in advance,
Alessio Pace.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081209/5df51110/attachment.htm 

From gabriel.rossetti at arimaz.com  Tue Dec  9 04:09:10 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 09 Dec 2008 10:09:10 +0100
Subject: [Twisted-Python] Deferred question
In-Reply-To: <493CE88D.3070507@arimaz.com>
References: <493CE88D.3070507@arimaz.com>
Message-ID: <493E35B6.7030509@arimaz.com>

Gabriel Rossetti wrote:
> Hello everyone,
>
> I have a question concerning defers, I have a service that needs to 
> query IO until it answers. The IO can be disconnected, connected but 
> off, connected and on; depending on the state I get different 
> exceptions. I wrote something like :
>
> def __requestId(self, _):
>        d = self.callPlugin(PLUGIN_NAME)
>        d.addCallback(self.__receivedAns)
>        d.addErrback(self.__requestId)
>
> The plugin makes the request in a thread and the deferred is returned 
> and called when either an answer is received or am exception is raised 
> (e.g. timeout, missing hardware, etc)
>
> This seams to work well, except that when I let the system run for a 
> long time without the hardware being present or off (several 
> hours/days) the memory consumption goes way up. I don' t really know 
> what is causing this, and I'm looking for possible reasons, so I was 
> wondering if maybe this could be what is causing the problem. It's 
> probably not that, because from what I understand it works like this :
>
>   1. the first request is made
>   2. there is a timeout or something that raises the exception
>   3. the errback gets called
>   4. it makes a new request
>   5. the deferred gets garbage collected
>   6. the new request follows the same path
>
> Can anyone confirm that this is correct, or are my defers somehow 
> staying alive and not being garbage collected?
>
> Thank you,
> Gabriel Rossetti
>
Forget it, I monkey-patched defer.Deferred to add __del__ to see if it 
was called, and it was, so they are getting destroyed...



From gabriel.rossetti at arimaz.com  Tue Dec  9 04:10:58 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 09 Dec 2008 10:10:58 +0100
Subject: [Twisted-Python] How to see the number of received msgs?
Message-ID: <493E3622.3070906@arimaz.com>

Hello eveyone,

is there a way to see how many msgs have been received and are waiting 
to be processed by a client?

Thank you,
Gabriel



From tarjei at nu.no  Tue Dec  9 08:06:01 2008
From: tarjei at nu.no (tarjei)
Date: Tue, 09 Dec 2008 14:06:01 +0100
Subject: [Twisted-Python] How to see the number of received msgs?
In-Reply-To: <493E3622.3070906@arimaz.com>
References: <493E3622.3070906@arimaz.com>
Message-ID: <493E6D39.5020504@nu.no>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Gabriel Rossetti wrote:
> Hello eveyone,
> 
> is there a way to see how many msgs have been received and are waiting
> to be processed by a client?
Hi, I think you need to be far more specific if you want an answer.
Which protocol is this for example?

regards,
Tarjei
> 
> Thank you,
> Gabriel
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD4DBQFJPm05YVRKCnSvzfIRAk3JAJ9IwpmXvQoOOo6OTvw6ch33n9McBgCWLm2W
I0CWa9Gt8AOCirc0IZoZSg==
=ezer
-----END PGP SIGNATURE-----



From gabriel.rossetti at arimaz.com  Tue Dec  9 11:12:32 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 09 Dec 2008 17:12:32 +0100
Subject: [Twisted-Python] How to see the number of received msgs?
In-Reply-To: <493E6D39.5020504@nu.no>
References: <493E3622.3070906@arimaz.com> <493E6D39.5020504@nu.no>
Message-ID: <493E98F0.4050000@arimaz.com>

tarjei wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Gabriel Rossetti wrote:
>   
>> Hello eveyone,
>>
>> is there a way to see how many msgs have been received and are waiting
>> to be processed by a client?
>>     
> Hi, I think you need to be far more specific if you want an answer.
> Which protocol is this for example?
>   
TCP, but I assuming that Twisted gets stuff from the OS's buffer and 
puts it in it's own buffer, this may not be the case though, if it's not 
then my question makes no sense.

Regards,
Gabriel
> regards,
> Tarjei
>   
>> Thank you,
>> Gabriel
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>     
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.6 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
>
> iD4DBQFJPm05YVRKCnSvzfIRAk3JAJ9IwpmXvQoOOo6OTvw6ch33n9McBgCWLm2W
> I0CWa9Gt8AOCirc0IZoZSg==
> =ezer
> -----END PGP SIGNATURE-----
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>   



From foom at fuhm.net  Tue Dec  9 12:10:45 2008
From: foom at fuhm.net (James Y Knight)
Date: Tue, 9 Dec 2008 12:10:45 -0500
Subject: [Twisted-Python] Deferred question
In-Reply-To: <493E35B6.7030509@arimaz.com>
References: <493CE88D.3070507@arimaz.com> <493E35B6.7030509@arimaz.com>
Message-ID: <A11A7114-B968-4404-8C36-E43A51E55F1B@fuhm.net>

On Dec 9, 2008, at 4:09 AM, Gabriel Rossetti wrote:
> Forget it, I monkey-patched defer.Deferred to add __del__ to see if  
> it was called, and it was, so they are getting destroyed...

BTW, that is not a good way to tell if objects are being deleted.  
Simply the act of adding a __del__ to an object can *cause* it to be  
not collected, due to the way python's GC works. Luckily that was not  
the case here. :) A better method to tell if objects are being  
collected is to create a list of weakrefs (with callbacks to print a  
message, say) to the objects.

James



From exarkun at divmod.com  Tue Dec  9 13:41:20 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 9 Dec 2008 13:41:20 -0500
Subject: [Twisted-Python] How to see the number of received msgs?
In-Reply-To: <493E98F0.4050000@arimaz.com>
Message-ID: <20081209184120.20272.949979324.divmod.quotient.18545@ohm>

On Tue, 09 Dec 2008 17:12:32 +0100, Gabriel Rossetti <gabriel.rossetti at arimaz.com> wrote:
>tarjei wrote:
>>-----BEGIN PGP SIGNED MESSAGE-----
>>Hash: SHA1
>>
>>Gabriel Rossetti wrote:
>>
>>>Hello eveyone,
>>>
>>>is there a way to see how many msgs have been received and are waiting
>>>to be processed by a client?
>>>
>>Hi, I think you need to be far more specific if you want an answer.
>>Which protocol is this for example?
>>
>TCP, but I assuming that Twisted gets stuff from the OS's buffer and puts it 
>in it's own buffer, this may not be the case though, if it's not then my 
>question makes no sense.

The TCP transport implementation in Twisted calls the protocol's dataReceived
method *immediately* with any bytes it receives.  In other words, received
data is never buffered.  So the answer to your question is that the number
is always zero.

Additionally, TCP has no notion of messages.  There's just a stream of bytes
from which arbitrarily short or long sequences of bytes may be read.

Jean-Paul



From phil at bubblehouse.org  Tue Dec  9 15:43:00 2008
From: phil at bubblehouse.org (Phil Christensen)
Date: Tue, 9 Dec 2008 15:43:00 -0500
Subject: [Twisted-Python] spawnProcess help needed
Message-ID: <8ACAACEC-AA5D-4BA1-B291-188D7D8F5F45@bubblehouse.org>

Hello All-

I'm running into an issue with a project I'm working on that involves  
coordinating a large number of external processes to encode audio into  
different formats, and do other bookkeeping.

I seem to be having a problem when I use spawnProcess to call the  
md5sum binary. The processes spawned seem to stick around forever,  
until I kill the server. This doesn't appear to happen with any other  
binary.

I start with the following abstract class:

     class DefaultProcessProtocol(protocol.ProcessProtocol):
         def __init__(self, preserveOut=True, preserveErr=True):
             self.deferred = defer.Deferred()
             self.debug = False
             self.preserveOut = preserveOut
             self.out = ''
             self.preserveErr = preserveErr
             self.err = ''

         def connectionMade(self):
             if(self.debug):
                 print '%s connection made' % self.__class__.__name__

         def outReceived(self, data):
             if(self.debug):
                 print '%s stdout: %s' % (self.__class__.__name__, data)
             if(self.preserveOut):
                 self.out += data

         def errReceived(self, data):
             if(self.debug):
                 print '%s stderr: %s' % (self.__class__.__name__, data)
             if(self.preserveErr):
                 self.err += data

         def processEnded(self, status):
             if(isinstance(status.value, error.ProcessDone)):
                 self.deferred.callback(self)
             else:
                 if(self.out):
                     print self.out
                 if(self.err):
                     print self.err
                 self.deferred.errback(status.value)

Then I made a subclass as follows:

     class MD5Checksum(DefaultProcessProtocol):
         @staticmethod
         def run(target, md5_path='/usr/bin/md5sum'):
             hasher = MD5Checksum(preserveOut=True)
             hasher.debug = True
             reactor.spawnProcess(hasher, md5_path, [md5_path, target])
             return hasher.deferred

         def get_checksum(self):
             filehash = self.out
             if(filehash.find('=') == -1):
                 filehash = [output.strip() for output in  
filehash.split(' ')][0]
             else:
                 filehash = [output.strip() for output in  
filehash.split('=')][1]
             return filehash

With the plan of executing it inside an inlineCallbacks-decorated  
function, like this:

         proto = yield process.MD5Checksum.run(filename)
         checksum = proto.get_checksum()

Everything is basically working, except for the fact that the md5sum  
processes never go away. It does seem that processEnded is being  
called, since that's what issues the callback on the deferred returned  
by run(), but the process sticks around, as a non-zombie, non-defunct  
process that still appears to be using small amounts of CPU time.

Also, once the checksum has been retrieved, killing the server doesn't  
cause any errors, unlike when a process is legitimately terminated by  
killing the server, which displays an error (since right now i'm not  
actually catching ProcessTerminated scenarios):

     2008-12-09 15:17:48-0500 [-] Unhandled error in Deferred:
     2008-12-09 15:17:48-0500 [-] Unhandled Error
         Traceback (most recent call last):
         Failure: twisted.internet.error.ProcessTerminated: A process  
has ended with a probable
     error condition: process ended by signal 2.

Any help in this matter would be appreciated...

-phil





From ms at cerenity.org  Tue Dec  9 17:06:36 2008
From: ms at cerenity.org (Michael)
Date: Tue, 9 Dec 2008 22:06:36 +0000
Subject: [Twisted-Python] PDF I thought may be of interest
Message-ID: <200812092206.37080.ms@cerenity.org>

Hi,


I came across this livejournal entry today:
   * http://four.livejournal.com/934085.html

Which has this link:
http://s3.amazonaws.com/four.livejournal/20081209/threads-hotos-2003.pdf

.. which is a paper by Rob von Behren, Jeremy Condit and Eric Brewer. I 
personally raised an eyebrow when I saw that because Eric Brewer was the CTO 
of Inktomi, who back the had a very highly scaleable network system called 
Traffic Server amongst other things (I worked at Inktomi between 2000 & 2002, 
which is why I recognised the name).

Traffic Server's architecture was in many respects reactor based, and in many 
respects it's architecture and twisted's architecture weren't *massively* 
different. OK, TS was written in C++, and twisted is python, but a reactor 
approach is still a reactor approach.

Specifically I found this part particularly surprising:

Abstract
    Event-based programming has been highly touted in recent years as the best
    way to write highly concurrent applications. Having worked on several of
    these systems, we now believe this approach to be a mistake. Specifically,
    we believe that threads can achieve all of the strengths of events,
    including support for high concurrency, low overhead, and a simple
    concurrency model.

The paper appears to be 5 years old already, so the impact of this paper
appears minimal, but I thought it may be of interest to others. (The reason it 
raised such a surprise for me is because it would be as surprising to me as 
it would be to read of any of the core twisted devs to suddenly come out in 
favour of a threading approach rather than non-threading!)

Looking slightly below the surface of things, it appears to be advocating 
something more like stackless's tasklets, rather than OS level threads (since 
it makes reference near the end to Erlang's threading model).

Either why, hopefully interesting :)

Regards,


Michael
-- 
http://yeoldeclue.com/blog




From glyph at divmod.com  Tue Dec  9 17:31:50 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 09 Dec 2008 22:31:50 -0000
Subject: [Twisted-Python] PDF I thought may be of interest
In-Reply-To: <200812092206.37080.ms@cerenity.org>
References: <200812092206.37080.ms@cerenity.org>
Message-ID: <20081209223150.12555.1951446483.divmod.xquotient.1902@weber.divmod.com>

On 10:06 pm, ms at cerenity.org wrote:
>Looking slightly below the surface of things, it appears to be 
>advocating
>something more like stackless's tasklets, rather than OS level threads 
>(since
>it makes reference near the end to Erlang's threading model).

Yes, and for this reason I found the paper to be somewhat disingenuous. 
It pops up every so often.

For one thing, it doesn't mention the extreme difficulty of writing 
correct threaded code that manages shared state.  There is a brief nod 
to this, where they say "Although static detection of race conditions is 
challenging"... then they go on to say maybe it's possible if you do 
some whole-program analysis, completely disregarding the unsuitability 
of whole-program analysis to long-lived, dynamic server systems 
(arguably the most popular choice for highly concurrent systems) which 
often require live, and therefore modular, updates.

Simplicity is Twisted's main advantage - obviously if we were 
performance-obsessed Python would be a poor choice for an implementation 
language, and all the paper really talks about is performance.  It's 
easier to write *correct* code in an event-driven model because 
everything that's happening is obvious once you understand what's going 
on.  I've often spotted concurrency problems in Twisted just in a code 
review.  In a threaded program, even if you're a threading expert, it's 
very very easy to miss subtle concurrency bugs.

For another, the paper arbitrarily redefines the word "threads" to mean 
"this cool thing that doesn't exist yet", rather than existing things 
that people call "threads".  It specifically mentions the deficiencies 
of current thread implementations and does not always point to specific 
improvements, let alone the challenge of popularizing and deploying 
those improvements.  The comparison to erlang's concurrency model is 
interesting, since they specifically avoid the term "threads" - erlang 
calls them "processes" to avoid exactly the confusion the authors are 
attempting to create.

So, in the fantasy world the authors have constructed, where threads are 
different than what we call "threads", they might be better than 
"events" for high-concurrency systems.  I'm probably even glad they 
chose the misleading, but controversial, title to draw attention to 
their work, because I think those ideas are interesting (if impractical) 
and I'm glad I read about them.



From exarkun at divmod.com  Tue Dec  9 17:41:53 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 9 Dec 2008 17:41:53 -0500
Subject: [Twisted-Python] spawnProcess help needed
In-Reply-To: <8ACAACEC-AA5D-4BA1-B291-188D7D8F5F45@bubblehouse.org>
Message-ID: <20081209224153.20272.1558664437.divmod.quotient.18653@ohm>

On Tue, 9 Dec 2008 15:43:00 -0500, Phil Christensen <phil at bubblehouse.org> wrote:
>Hello All-
>
>I'm running into an issue with a project I'm working on that involves 
>coordinating a large number of external processes to encode audio into 
>different formats, and do other bookkeeping.
>
>I seem to be having a problem when I use spawnProcess to call the  md5sum 
>binary. The processes spawned seem to stick around forever,  until I kill 
>the server. This doesn't appear to happen with any other  binary.
>
>I start with the following abstract class:
>
> [snip MD5Checksum ProcessProtocol]
>
>With the plan of executing it inside an inlineCallbacks-decorated  function, 
>like this:
>
>         proto = yield process.MD5Checksum.run(filename)
>         checksum = proto.get_checksum()
>
>Everything is basically working, except for the fact that the md5sum 
>processes never go away. It does seem that processEnded is being  called, 
>since that's what issues the callback on the deferred returned  by run(), 
>but the process sticks around, as a non-zombie, non-defunct  process that 
>still appears to be using small amounts of CPU time.

processEnded shouldn't be called until the child has exited and been
reaped.  This means that the md5sum process should not still exist in
any form if processEnded is being called.  So either the processes you're
seeing aren't associated with the ProcessProtocol instances you think, or
there's a pretty serious bug in Twisted. :)

A self-contained example of this behavior would be pretty handy.  You should
probably start by making sure processEnded is really being called for the
ProcessProtocol instances associated with the processes which aren't actually
exiting.

>
>Also, once the checksum has been retrieved, killing the server doesn't 
>cause any errors, unlike when a process is legitimately terminated by 
>killing the server, which displays an error (since right now i'm not 
>actually catching ProcessTerminated scenarios):
>
>     2008-12-09 15:17:48-0500 [-] Unhandled error in Deferred:
>     2008-12-09 15:17:48-0500 [-] Unhandled Error
>         Traceback (most recent call last):
>         Failure: twisted.internet.error.ProcessTerminated: A process  has 
>ended with a probable
>     error condition: process ended by signal 2.
>
>Any help in this matter would be appreciated...
>

Jean-Paul



From ian at ambientdivide.com  Tue Dec  9 18:27:00 2008
From: ian at ambientdivide.com (Ian Jones)
Date: Tue, 9 Dec 2008 15:27:00 -0800
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
Message-ID: <79190bba0812091527h6ce8090eld8a302f7c62e6553@mail.gmail.com>

I'm trying to create a taskbar app (in wxpython) to monitor job
progress on a render farm. I'd like the taskbar app to have an xmlrpc
server built in so that other applications can inform the taskbar app
additional jobs to monitor.

I found this recipe online which is a great example of the functionality I want:

http://code.activestate.com/recipes/298985/

However when I run the following

from xmlrpclib import *
s = ServerProxy('http://localhost:7080') # Get access to xmlrpc server
s.title('Hallo xmlrpc app')

I don't get a response (though the title in the window changes - so I
know it got it)

I do get this though:

Traceback (most recent call last):
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\protocols\basic.py",
line 239, in dataReceived
    return self.rawDataReceived(data)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\http.py",
line 1117, in rawDataReceived
    self.allContentReceived()
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\http.py",
line 1108, in allContentReceived
    req.requestReceived(command, path, version)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\http.py",
line 626, in requestReceived
    self.process()
--- <exception caught here> ---
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\server.py",
line 150, in process
    self.render(resrc)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\server.py",
line 157, in render
    body = resrc.render(self)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\resource.py",
line 189, in render
    return m(request)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 122, in render_POST
    function = self._getFunction(functionPath)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 170, in _getFunction
    handler = self.getSubHandler(prefix)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 107, in getSubHandler
    return self.subHandlers.get(prefix, None)
exceptions.AttributeError: 'MyXMLRPCApp' object has no attribute 'subHandlers'
Unhandled error in Deferred:
Traceback (most recent call last):
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\resource.py",
line 189, in render
    return m(request)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 126, in render_POST
    defer.maybeDeferred(function, *args).addErrback(
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\internet\defer.py",
line 195, in addCallback
    callbackKeywords=kw)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\internet\defer.py",
line 186, in addCallbacks
    self._runCallbacks()
--- <exception caught here> ---
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\internet\defer.py",
line 328, in _runCallbacks
    self.result = callback(self.result, *args, **kw)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 144, in _cbRender
    allow_none=self.allowNone)
exceptions.AttributeError: 'MyXMLRPCApp' object has no attribute 'allowNone'

I'm assuming this is just a good example that is out of date. However
I'm not sure how to update it so that it works. Can someone help me
out?



From exarkun at divmod.com  Tue Dec  9 19:08:19 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 9 Dec 2008 19:08:19 -0500
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
In-Reply-To: <79190bba0812091527h6ce8090eld8a302f7c62e6553@mail.gmail.com>
Message-ID: <20081210000819.20272.1103441225.divmod.quotient.18694@ohm>

On Tue, 9 Dec 2008 15:27:00 -0800, Ian Jones <ian at ambientdivide.com> wrote:
>I'm trying to create a taskbar app (in wxpython) to monitor job
>progress on a render farm. I'd like the taskbar app to have an xmlrpc
>server built in so that other applications can inform the taskbar app
>additional jobs to monitor.
>
>I found this recipe online which is a great example of the functionality I want:
>
>http://code.activestate.com/recipes/298985/
>
>However when I run the following
>
> [snip]
>
>I'm assuming this is just a good example that is out of date. However
>I'm not sure how to update it so that it works. Can someone help me
>out?

It looks like the direct cause of the problem is that the XMLRPC subclass
in the example prevents XMLRPC.__init__ from being invoked.  It seems to
be doing this by subclassing both wx.App and XMLRPC.  There's probably
no good reason to subclass both of these, and in this case it's causing a
problem, as presumably wx.App has an __init__ which is getting in the way.

Jean-Paul



From alecf at metaweb.com  Tue Dec  9 19:41:50 2008
From: alecf at metaweb.com (Alec Flett)
Date: Tue, 9 Dec 2008 16:41:50 -0800
Subject: [Twisted-Python] lost tracebacks?
Message-ID: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>

So I am constantly "losing" my tracebacks when my defer's callbacks  
throw exceptions that aren't caught. When I get an uncaught exception  
(caught via twisted.log.addObserver()) I am basically storing the  
Failure instance and then later, when it's safe for me to do so,  
calling fail.raiseException() - but the Failure's 'tb' property is None.

I traced this down to the code in Deferred._runCallbacks() which does  
a try: / except: with::

     self.result = failure.Failure()

Seems like this code should say::

     exc_type, exc_value, exc_traceback = sys.exc_info()
     self.result = failure.Failure(exc_value, exc_type, exc_traceback)


I'm dealing with two issues:
1) trying to generically log stack traces that happen
2) provide sane stack traces to my team who is fairly new to twisted

I can see how this might possibly leak if the tracebacks are holding  
onto references to local variables or something, but maybe  
cleanFailure() fixes that? I don't know.

Alec



From glyph at divmod.com  Tue Dec  9 20:29:22 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Wed, 10 Dec 2008 01:29:22 -0000
Subject: [Twisted-Python] lost tracebacks?
In-Reply-To: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>
References: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>
Message-ID: <20081210012922.12555.1049608548.divmod.xquotient.1986@weber.divmod.com>

On 12:41 am, alecf at metaweb.com wrote:
>I traced this down to the code in Deferred._runCallbacks() which does 
>a try: / except: with::
>
>     self.result = failure.Failure()
>
>Seems like this code should say::
>
>     exc_type, exc_value, exc_traceback = sys.exc_info()
>     self.result = failure.Failure(exc_value, exc_type, exc_traceback)

Those are basically equivalent.  Observe:
>>>from twisted.python.failure import Failure
>>>try:
...  1/0
... except:
...  f = Failure()
...
>>>f.printTraceback()
Traceback (most recent call last):
--- <exception caught here> ---
  File "<stdin>", line 2, in <module>

exceptions.ZeroDivisionError: integer division or modulo by zero

Note how it remembers the line number in the traceback.  Your traceback 
must be getting lost for some other reason.



From gabriel.rossetti at arimaz.com  Wed Dec 10 02:27:17 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Wed, 10 Dec 2008 08:27:17 +0100
Subject: [Twisted-Python] How to see the number of received msgs?
In-Reply-To: <20081209184120.20272.949979324.divmod.quotient.18545@ohm>
References: <20081209184120.20272.949979324.divmod.quotient.18545@ohm>
Message-ID: <493F6F55.9010003@arimaz.com>

Jean-Paul Calderone wrote:
> On Tue, 09 Dec 2008 17:12:32 +0100, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com> wrote:
>> tarjei wrote:
>>> -----BEGIN PGP SIGNED MESSAGE-----
>>> Hash: SHA1
>>>
>>> Gabriel Rossetti wrote:
>>>
>>>> Hello eveyone,
>>>>
>>>> is there a way to see how many msgs have been received and are waiting
>>>> to be processed by a client?
>>>>
>>> Hi, I think you need to be far more specific if you want an answer.
>>> Which protocol is this for example?
>>>
>> TCP, but I assuming that Twisted gets stuff from the OS's buffer and 
>> puts it in it's own buffer, this may not be the case though, if it's 
>> not then my question makes no sense.
>
> The TCP transport implementation in Twisted calls the protocol's 
> dataReceived
> method *immediately* with any bytes it receives.  In other words, 
> received
> data is never buffered.  So the answer to your question is that the 
> number
> is always zero.
>
Ok, thank you.
> Additionally, TCP has no notion of messages.  There's just a stream of 
> bytes
> from which arbitrarily short or long sequences of bytes may be read.
>
yes, true.
> Jean-Paul





From gabriel.rossetti at arimaz.com  Wed Dec 10 02:28:22 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Wed, 10 Dec 2008 08:28:22 +0100
Subject: [Twisted-Python] Deferred question
In-Reply-To: <A11A7114-B968-4404-8C36-E43A51E55F1B@fuhm.net>
References: <493CE88D.3070507@arimaz.com> <493E35B6.7030509@arimaz.com>
	<A11A7114-B968-4404-8C36-E43A51E55F1B@fuhm.net>
Message-ID: <493F6F96.7000902@arimaz.com>

James Y Knight wrote:
> On Dec 9, 2008, at 4:09 AM, Gabriel Rossetti wrote:
>> Forget it, I monkey-patched defer.Deferred to add __del__ to see if 
>> it was called, and it was, so they are getting destroyed...
>
> BTW, that is not a good way to tell if objects are being deleted. 
> Simply the act of adding a __del__ to an object can *cause* it to be 
> not collected, due to the way python's GC works. Luckily that was not 
> the case here. :) A better method to tell if objects are being 
> collected is to create a list of weakrefs (with callbacks to print a 
> message, say) to the objects.
>
> James
>
Thank you for the tip James!

Gabriel



From phil at bubblehouse.org  Wed Dec 10 11:45:24 2008
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 10 Dec 2008 11:45:24 -0500
Subject: [Twisted-Python] spawnProcess help needed
In-Reply-To: <20081209224153.20272.1558664437.divmod.quotient.18653@ohm>
References: <20081209224153.20272.1558664437.divmod.quotient.18653@ohm>
Message-ID: <39F280F6-A810-4B22-AC2A-758D72DAE4AE@bubblehouse.org>

On Dec 9, 2008, at 5:41 PM, Jean-Paul Calderone wrote:
> On Tue, 9 Dec 2008 15:43:00 -0500, Phil Christensen <phil at bubblehouse.org 
> > wrote:
>> Everything is basically working, except for the fact that the  
>> md5sum processes never go away. It does seem that processEnded is  
>> being  called, since that's what issues the callback on the  
>> deferred returned  by run(), but the process sticks around, as a  
>> non-zombie, non-defunct  process that still appears to be using  
>> small amounts of CPU time.
>
> processEnded shouldn't be called until the child has exited and been
> reaped.  This means that the md5sum process should not still exist in
> any form if processEnded is being called.  So either the processes  
> you're
> seeing aren't associated with the ProcessProtocol instances you  
> think, or
> there's a pretty serious bug in Twisted. :)


Well,  it looks like I was wrong, and the processes do go away,  
although they take awhile. This isn't that surprising, since I'm  
seeing 10-15 md5 processes happening in parallel, and they're  
checksumming relatively large (~150MB) WAV files.

It ended up being all because of a dumb mistake. Thanks for the help,  
though.

-phil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081210/e406d174/attachment.htm 

From ian at ambientdivide.com  Wed Dec 10 11:54:49 2008
From: ian at ambientdivide.com (Ian Jones)
Date: Wed, 10 Dec 2008 08:54:49 -0800
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
In-Reply-To: <20081210000819.20272.1103441225.divmod.quotient.18694@ohm>
References: <79190bba0812091527h6ce8090eld8a302f7c62e6553@mail.gmail.com>
	<20081210000819.20272.1103441225.divmod.quotient.18694@ohm>
Message-ID: <79190bba0812100854j1eaf559s8f67655e5bb8b884@mail.gmail.com>

"There's probably no good reason to subclass both of these"

I'm relatively new to python so sorry if this should be obvious - but
how else would I get the functionality of both classes if I did
subclass both of them?

Ian


On Tue, Dec 9, 2008 at 4:08 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Tue, 9 Dec 2008 15:27:00 -0800, Ian Jones <ian at ambientdivide.com> wrote:
>>
>> I'm trying to create a taskbar app (in wxpython) to monitor job
>> progress on a render farm. I'd like the taskbar app to have an xmlrpc
>> server built in so that other applications can inform the taskbar app
>> additional jobs to monitor.
>>
>> I found this recipe online which is a great example of the functionality I
>> want:
>>
>> http://code.activestate.com/recipes/298985/
>>
>> However when I run the following
>>
>> [snip]
>>
>> I'm assuming this is just a good example that is out of date. However
>> I'm not sure how to update it so that it works. Can someone help me
>> out?
>
> It looks like the direct cause of the problem is that the XMLRPC subclass
> in the example prevents XMLRPC.__init__ from being invoked.  It seems to
> be doing this by subclassing both wx.App and XMLRPC.  There's probably
> no good reason to subclass both of these, and in this case it's causing a
> problem, as presumably wx.App has an __init__ which is getting in the way.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From ian at ambientdivide.com  Wed Dec 10 11:55:36 2008
From: ian at ambientdivide.com (Ian Jones)
Date: Wed, 10 Dec 2008 08:55:36 -0800
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
In-Reply-To: <79190bba0812100854j1eaf559s8f67655e5bb8b884@mail.gmail.com>
References: <79190bba0812091527h6ce8090eld8a302f7c62e6553@mail.gmail.com>
	<20081210000819.20272.1103441225.divmod.quotient.18694@ohm>
	<79190bba0812100854j1eaf559s8f67655e5bb8b884@mail.gmail.com>
Message-ID: <79190bba0812100855v570c2416xbd4e3834be591007@mail.gmail.com>

didn't subclass both of them rather.


On Wed, Dec 10, 2008 at 8:54 AM, Ian Jones <ian at ambientdivide.com> wrote:
> "There's probably no good reason to subclass both of these"
>
> I'm relatively new to python so sorry if this should be obvious - but
> how else would I get the functionality of both classes if I did
> subclass both of them?
>
> Ian
>
>
> On Tue, Dec 9, 2008 at 4:08 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
>> On Tue, 9 Dec 2008 15:27:00 -0800, Ian Jones <ian at ambientdivide.com> wrote:
>>>
>>> I'm trying to create a taskbar app (in wxpython) to monitor job
>>> progress on a render farm. I'd like the taskbar app to have an xmlrpc
>>> server built in so that other applications can inform the taskbar app
>>> additional jobs to monitor.
>>>
>>> I found this recipe online which is a great example of the functionality I
>>> want:
>>>
>>> http://code.activestate.com/recipes/298985/
>>>
>>> However when I run the following
>>>
>>> [snip]
>>>
>>> I'm assuming this is just a good example that is out of date. However
>>> I'm not sure how to update it so that it works. Can someone help me
>>> out?
>>
>> It looks like the direct cause of the problem is that the XMLRPC subclass
>> in the example prevents XMLRPC.__init__ from being invoked.  It seems to
>> be doing this by subclassing both wx.App and XMLRPC.  There's probably
>> no good reason to subclass both of these, and in this case it's causing a
>> problem, as presumably wx.App has an __init__ which is getting in the way.
>>
>> Jean-Paul
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>



From exarkun at divmod.com  Wed Dec 10 12:04:06 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 10 Dec 2008 12:04:06 -0500
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
In-Reply-To: <79190bba0812100854j1eaf559s8f67655e5bb8b884@mail.gmail.com>
Message-ID: <20081210170406.20272.457531719.divmod.quotient.19083@ohm>

On Wed, 10 Dec 2008 08:54:49 -0800, Ian Jones <ian at ambientdivide.com> wrote:
>"There's probably no good reason to subclass both of these"
>
>I'm relatively new to python so sorry if this should be obvious - but
>how else would I get the functionality of both classes if I did
>subclass both of them?

Create two classes and let instances of one keep references to an instance
of the other.  For example, in this case, you might have a wx.App subclass
with the OnInit method defined in the example and a different XMLRPC
subclass with a reference to instances of the first class.  Then, instead
of doing `self.frame.Close()? or `self.frame.SetTitle(x)?, it would do
`self.appObj.frame.Close()? or `self.appObj.frame.SetTitle(x)?.

Jean-Paul



From cary.hull at gmail.com  Wed Dec 10 12:27:49 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Wed, 10 Dec 2008 09:27:49 -0800
Subject: [Twisted-Python] spawnProcess help needed
In-Reply-To: <39F280F6-A810-4B22-AC2A-758D72DAE4AE@bubblehouse.org>
References: <20081209224153.20272.1558664437.divmod.quotient.18653@ohm>
	<39F280F6-A810-4B22-AC2A-758D72DAE4AE@bubblehouse.org>
Message-ID: <3fce0ae70812100927j1a6681e1w9d763eac095afc67@mail.gmail.com>

Just an fyi, you don't need to code your own process protocol for
programs like md5sum. Take a look at
twisted.internet.utils.getProcessOutput.

-Cary

On Wed, Dec 10, 2008 at 8:45 AM, Phil Christensen <phil at bubblehouse.org> wrote:
> On Dec 9, 2008, at 5:41 PM, Jean-Paul Calderone wrote:
>
> On Tue, 9 Dec 2008 15:43:00 -0500, Phil Christensen <phil at bubblehouse.org>
> wrote:
>
> Everything is basically working, except for the fact that the md5sum
> processes never go away. It does seem that processEnded is being  called,
> since that's what issues the callback on the deferred returned  by run(),
> but the process sticks around, as a non-zombie, non-defunct  process that
> still appears to be using small amounts of CPU time.
>
> processEnded shouldn't be called until the child has exited and been
> reaped.  This means that the md5sum process should not still exist in
> any form if processEnded is being called.  So either the processes you're
> seeing aren't associated with the ProcessProtocol instances you think, or
> there's a pretty serious bug in Twisted. :)
>
> Well,  it looks like I was wrong, and the processes do go away, although
> they take awhile. This isn't that surprising, since I'm seeing 10-15 md5
> processes happening in parallel, and they're checksumming relatively large
> (~150MB) WAV files.
> It ended up being all because of a dumb mistake. Thanks for the help,
> though.
> -phil
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From suchindra at gmail.com  Wed Dec 10 14:02:25 2008
From: suchindra at gmail.com (Suchindra Sandhu)
Date: Wed, 10 Dec 2008 14:02:25 -0500
Subject: [Twisted-Python] Running commands / collecting datas via SSH on
	many machines: Twisted vs plain old scripts ?
In-Reply-To: <84987d20812090055n3282b4e6t329f6d3937a28e72@mail.gmail.com>
References: <84987d20812090055n3282b4e6t329f6d3937a28e72@mail.gmail.com>
Message-ID: <b39d0d980812101102g743d610bue02ee045b7754a5e@mail.gmail.com>

Hi Alessio,

If you have many machines, then running commands via a shell script
for loop quickly gets un-weildly. Especially since some machines could
be slow in responding since they could be busy, faroff etc or it your
command itself takes a long time to complete.

Doing this in twisted will not only give you better resource
allocation, but it will also be easier to get timeouts and such
things. The twisted ssh implementation probably gives you other things
as well, but I am not aware of them.

Hope that helps.

--
/s

On Tue, Dec 9, 2008 at 3:55 AM, Alessio Pace <alessio.pace at gmail.com> wrote:
> Hi,
>
> I have to run commands and (later in time) collect logs from many machines,
> connecting through SSH.
>
> I was _genuinely_ wondering what an SSH client written in Twisted could give
> me more than executing plain old shell scripts in a for loop.
>
> From what I saw, given the fact that my run/collect commands remain still
> shell commands (cp, tar, etc...), the only thing that may change is that
> using Twisted I could have a better utilization of resources rather than a
> simple shell for loop in which I iterate in order over all the machines on
> which I have to issue commands.
>
> Am I missing something? I would like to stress the fact that I'm asking this
> as a very specific question for Twisted usage in the context of
> running/retrieving results on remote machines (as indeed I already happily
> use Twisted for running custom network protocols) and I would right to
> choose a simple but effective solution for this case.
>
> Thanks in advance,
> Alessio Pace.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



From alecf at metaweb.com  Wed Dec 10 15:42:06 2008
From: alecf at metaweb.com (Alec Flett)
Date: Wed, 10 Dec 2008 12:42:06 -0800
Subject: [Twisted-Python] lost tracebacks?
In-Reply-To: <20081210012922.12555.1049608548.divmod.xquotient.1986@weber.divmod.com>
References: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>
	<20081210012922.12555.1049608548.divmod.xquotient.1986@weber.divmod.com>
Message-ID: <C085A466-83DA-40B0-8C90-67264A98EEC0@metaweb.com>

Ah, I found the problem, for anyone else who runs into this...

I am collecting stacks using the logging system's addObserver() -  
trying to access the traceback from a garbage-collected deferred.  
Turns out when the deferred is garbage collected, the failure is  
pickled (to avoid leaks) and so it sets failure.tb to None.

By the time you get it in your log observer and store it for later,  
you can't re-raise the exception with the stack. but  
failure.getTraceback() gave me enough stack to at least debug.

I was hoping for a "real" traceback because Paste's EvalException  
middleware does a nice job debugging "live" stacks, but the 'verbose'  
stack is a pretty decent stand-in.

Alec

On Dec 9, 2008, at 5:29 PM, glyph at divmod.com wrote:

> On 12:41 am, alecf at metaweb.com wrote:
>> I traced this down to the code in Deferred._runCallbacks() which  
>> does a try: / except: with::
>>
>>    self.result = failure.Failure()
>>
>> Seems like this code should say::
>>
>>    exc_type, exc_value, exc_traceback = sys.exc_info()
>>    self.result = failure.Failure(exc_value, exc_type, exc_traceback)
>
> Those are basically equivalent.  Observe:
>>>> from twisted.python.failure import Failure
>>>> try:
> ...  1/0
> ... except:
> ...  f = Failure()
> ...
>>>> f.printTraceback()
> Traceback (most recent call last):
> --- <exception caught here> ---
> File "<stdin>", line 2, in <module>
>
> exceptions.ZeroDivisionError: integer division or modulo by zero
>
> Note how it remembers the line number in the traceback.  Your  
> traceback must be getting lost for some other reason.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From glyph at divmod.com  Wed Dec 10 17:08:52 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Wed, 10 Dec 2008 22:08:52 -0000
Subject: [Twisted-Python] lost tracebacks?
In-Reply-To: <C085A466-83DA-40B0-8C90-67264A98EEC0@metaweb.com>
References: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>
	<20081210012922.12555.1049608548.divmod.xquotient.1986@weber.divmod.com>
	<C085A466-83DA-40B0-8C90-67264A98EEC0@metaweb.com>
Message-ID: <20081210220852.12555.1622226472.divmod.xquotient.1994@weber.divmod.com>


On 08:42 pm, alecf at metaweb.com wrote:
>I was hoping for a "real" traceback because Paste's EvalException 
>middleware does a nice job debugging "live" stacks, but the 'verbose' 
>stack is a pretty decent stand-in.

There's a good reason not to hang on to the "real" traceback.  Failures 
with verbose stacktraces can already take up a shocking amount of memory 
(as you can see on this ticket: 
<http://twistedmatrix.com/trac/ticket/2466>).  Actually keeping around 
*all* of the original stack frames means keeping a live reference to 
everything that was on the stack at the time the error happened, which 
can potentially be the entire world.



From exarkun at divmod.com  Wed Dec 10 18:00:57 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 10 Dec 2008 18:00:57 -0500
Subject: [Twisted-Python] lost tracebacks?
In-Reply-To: <20081210220852.12555.1622226472.divmod.xquotient.1994@weber.divmod.com>
Message-ID: <20081210230057.20272.1529721041.divmod.quotient.19207@ohm>

On Wed, 10 Dec 2008 22:08:52 -0000, glyph at divmod.com wrote:
>
>On 08:42 pm, alecf at metaweb.com wrote:
>>I was hoping for a "real" traceback because Paste's EvalException 
>>middleware does a nice job debugging "live" stacks, but the 'verbose' stack 
>>is a pretty decent stand-in.
>
>There's a good reason not to hang on to the "real" traceback.  Failures with 
>verbose stacktraces can already take up a shocking amount of memory (as you 
>can see on this ticket: <http://twistedmatrix.com/trac/ticket/2466>). 
>Actually keeping around *all* of the original stack frames means keeping a 
>live reference to everything that was on the stack at the time the error 
>happened, which can potentially be the entire world.
>

There's also Failure.getTracebackObject which returns something that is API
compatible with a real traceback object except that you can't use it with
`raise?.  I'm not sure if it's good enough for Paste's EvalException, though.

Jean-Paul



From mk.fraggod at gmail.com  Wed Dec 10 20:46:09 2008
From: mk.fraggod at gmail.com (Mike Kazantsev)
Date: Thu, 11 Dec 2008 06:46:09 +0500
Subject: [Twisted-Python] twisted reverse proxy for web filtering
In-Reply-To: <5acf0ea80811301954q6a3f6938o6d7d3d207b1f7719@mail.gmail.com>
References: <5acf0ea80811301954q6a3f6938o6d7d3d207b1f7719@mail.gmail.com>
Message-ID: <20081211064609.620e9fe8@gmail.com>

On Sun, 30 Nov 2008 21:54:17 -0600
"dave fowler" <davefowler at gmail.com> wrote:

> I'd like to use python and in my research I think a twisted reverse proxy is
> what I want.  I've done the examples for setting up a proxy, including one
> that counts the words on the pages you visit, but i cannot find anything on
> fetching the destination and re-directing.  I've been sifting through the
> many classes of the proxy examples and am pretty lost.  Does anyone have
> some example code for something like this?
> 
> Thanks
> 
> Dave

I use following code to add '/trac' child to nevow (twisted.web extension) page with https-only access, mangling 'Location' header of returned answer to prevent redirects to non-existing urls.
You can probably mangle request the same way before passing it to render method, overriding returned headers and/or data afterwards in client class.
I doubt it'll be the fastest solution out there, but it certainly should be quite flexible.




from urllib import quote as urlquote
from twisted.web.proxy import ReverseProxyResource, ProxyClient, ProxyClientFactory


redirect = '<html><head><title>302 Found</title><meta http-equiv="REFRESH" content="0; url=%s"><script>document.write("<style>a {color:#fff;visibility:hidden;}<style>");window.location="%s"</script></head><body><a href="%s">click here</a></body></html>'


class SokLeechFactory(ProxyClientFactory):
	protocol = SokLeech


class SokLeech(ProxyClient):
	def handleHeader(self, key, value):
		'''Wrapper method to mangle Location header to point to original host'''
		if key == 'Location': value = value.replace(self.father.received_headers['host'], self.father.origin)
		ProxyClient.handleHeader(self, key, value)


class SslLinker(ReverseProxyResource):
	'''Wrapper class to inject some mangling into proxy protocol'''
	proxyClientFactoryClass = SokLeechFactory
	def getChild(self, path, request):
		return self.__class__(self.host, self.port, self.path + '/' + urlquote(path, safe=""))
	def render(self, request):
		'''Wrapper method to store host from original request'''
		if not request.isSecure():
			secure_url = 'https://%s:%s%s'%(request.getRequestHostname(), cfg.web.pen.split(':',3)[1], request.uri)
			request.redirect(secure_url)
			request.finish()
			return redirect.replace('%s', secure_url)
		request.origin = request.getRequestHostname()
		ReverseProxyResource.render(self, request)


class Page(LivePage):
	...
	child_trac = SslLinker(self.cfg.trac.host, self.cfg.trac.port, '/svc/trac')
	...


-- 
Mike Kazantsev // fraggod.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20081211/8f5d6f31/attachment.pgp 

From alessio.pace at gmail.com  Thu Dec 11 02:41:26 2008
From: alessio.pace at gmail.com (Alessio Pace)
Date: Thu, 11 Dec 2008 08:41:26 +0100
Subject: [Twisted-Python] Running commands / collecting datas via SSH on
	many machines: Twisted vs plain old scripts ?
In-Reply-To: <b39d0d980812101102g743d610bue02ee045b7754a5e@mail.gmail.com>
References: <84987d20812090055n3282b4e6t329f6d3937a28e72@mail.gmail.com>
	<b39d0d980812101102g743d610bue02ee045b7754a5e@mail.gmail.com>
Message-ID: <84987d20812102341n547419faia6071914dd59805f@mail.gmail.com>

On Wed, Dec 10, 2008 at 8:02 PM, Suchindra Sandhu <suchindra at gmail.com>wrote:

> Hi Alessio,
>
> If you have many machines, then running commands via a shell script
> for loop quickly gets un-weildly. Especially since some machines could
> be slow in responding since they could be busy, faroff etc or it your
> command itself takes a long time to complete.
>
> Doing this in twisted will not only give you better resource
> allocation, but it will also be easier to get timeouts and such
> things. The twisted ssh implementation probably gives you other things
> as well, but I am not aware of them.
>
> Hope that helps.


Hi,

yes this confirm my "feeling". The fact is that I don't know if in Twisted I
can easily do ssh proxying, as I use to do now configuring  my
.ssh/ssh_config file.. That's why for simplicity I fell back to plain
scripts calling ssh.

But I would like to switch to Twisted for the aforementioned reasons.

Thanks.
--
Alessio Pace



>
>
> --
> /s
>
> On Tue, Dec 9, 2008 at 3:55 AM, Alessio Pace <alessio.pace at gmail.com>
> wrote:
> > Hi,
> >
> > I have to run commands and (later in time) collect logs from many
> machines,
> > connecting through SSH.
> >
> > I was _genuinely_ wondering what an SSH client written in Twisted could
> give
> > me more than executing plain old shell scripts in a for loop.
> >
> > From what I saw, given the fact that my run/collect commands remain still
> > shell commands (cp, tar, etc...), the only thing that may change is that
> > using Twisted I could have a better utilization of resources rather than
> a
> > simple shell for loop in which I iterate in order over all the machines
> on
> > which I have to issue commands.
> >
> > Am I missing something? I would like to stress the fact that I'm asking
> this
> > as a very specific question for Twisted usage in the context of
> > running/retrieving results on remote machines (as indeed I already
> happily
> > use Twisted for running custom network protocols) and I would right to
> > choose a simple but effective solution for this case.
> >
> > Thanks in advance,
> > Alessio Pace.
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
> >
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081211/134007b6/attachment.htm 

From andrewfr_ice at yahoo.com  Thu Dec 11 09:34:24 2008
From: andrewfr_ice at yahoo.com (Andrew Francis)
Date: Thu, 11 Dec 2008 06:34:24 -0800 (PST)
Subject: [Twisted-Python] Re: PDF I thought may be of interest
Message-ID: <159780.57371.qm@web34206.mail.mud.yahoo.com>

Hi Michael and Colleagues:

> .. which is a paper by Rob von Behren, Jeremy Condit and
> Eric Brewer.

As a part of writing "Adventures in Stackless Python/Twisted Integration," I have read "The Why Events are" paper as well as the Ousterhout "Why Threads Are A Bad Idea (for most purposes). 

The "Why Events" paper led me to the Adya et al, "Cooperative task management without manual stack management" and the original Lauer and Needham  "On the duality of operating system structures." I also visited the Schmitt papers on the Reactor pattern. 

>From what I recalled, I preferred the latter three papers because they provide a much better analytic framework for describing the issues. In particular, the Adya provides terminology.

I have two basic sets of take-aways from the paper survey

1) "Events are great papers" state that threads are bad because of A,B, and C. "Threads are great papers" state that events are bad because of X,Y, and Z. As a programmer using these systems, perhaps I should pay special attention to issues A,B,C,X,Y and Z whenever applicable (and by the way papers thanks for telling me C and Y were issues since I didn't know). 

Perhaps out of all this, we can come up with appropriate guidelines for lockless programming?

2) The "Duality" paper argues that messaging passing and procedural systems can be described in terms of each other (bi-simulation?). I found this to be a very powerful way to look at Stackless Python and Twisted's threading models. 

A simple example. 

At the time I presented "Adventures," to avoid deadlock, I ran a reactor protocol instance in its own Stackless thread. This bugged me. It turned out that by replacing channels with deferreds (and doing a little buffering), I could replace the extraneous tasklet. My way of looking at it was, after all, protocol instances/deferreds are just another way of doing continuations... Use them, don't replace them....
 
> Looking slightly below the surface of things, it appears to
> be advocating something more like stackless's tasklets, rather than
> OS level threads (since it makes reference near the end to Erlang's >threading model).

A quote from the paper:

"To evaluate the ability of threads to support high
concurrency, we designed and implemented a simple
(5000 line) user-level cooperative threading package for
Linux. Our thread package uses the coro coroutine
library [15] for minimalist context switching, and it
translates blocking I/O requests to asynchronous requests
internally."

> The paper appears to be 5 years old already, so the impact
> of this paper appears minimal, but I thought it may be of interest to
> others. (The reason it  raised such a surprise for me is because it >would be as surprising to me as it would be to read of any of the core >twisted devs to suddenly come out in  favour of a threading approach >rather than non-threading!)

"The Why Events" is essentially the approach I took in regards to Stackless and Twisted. Right now, I am analyzing Stackless's scheduling model to see if improvements can be made. I feel I have much to learn...

That said, I feel inline callbacks are a step in this direction. As Stackless/PyPy concepts get into mainstream Python, I can see Twisted following in this direction. Already one can see that with stuff like Christopher Armstrong's Corotwine. 

Again, I think the key to incorporate threads and keep to the spirit of Twisted, simplicity and safety, is to come up with some guidelines for lockless programming.

Cheers,
Andrew




      



From fetbiz at gmail.com  Fri Dec 12 19:46:07 2008
From: fetbiz at gmail.com (biziap biziap)
Date: Sat, 13 Dec 2008 08:46:07 +0800
Subject: [Twisted-Python] twisted.mail.relaymanager.MXCalculator.getMX in
	Win32 got problem
Message-ID: <d067ddcf0812121646l20664e7aq9a26d4b9162d25c1@mail.gmail.com>

The problem is that: the UDP listening ports increase rapidly and eventually
come to the end: too many open file in selector.
As many as the hosts you lookup, those UDP ports are still alive. It is very
different from running this script in Linux (gentoo 2.6).
In Linux, the listening UDP port keep only 1 instance no matter how many
lookups .
Try the script below:
------------------------------
from twisted.mail import relaymanager
from twisted.internet import reactor,defer

global MXC
MXC = relaymanager.MXCalculator()
def getMailExchange(host):
    global MXC
    def cbMX(mxRecord):
        print 'Got mxRecord: %s' % mxRecord.name
    return MXC.getMX(host).addCallback(cbMX)

def run():
    d = getMailExchange('gmail.com')
    def next(mxRecord):
        d = getMailExchange('yahoo.com')

    #d.addCallback(next)     ## uncomment the line to increase your UDP
listening ports as many as you want
reactor.callWhenRunning(run)
reactor.run()
--------------------------------------------------

Any hints?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081213/1e6e985e/attachment.htm 

From manlio_perillo at libero.it  Sat Dec 13 05:54:05 2008
From: manlio_perillo at libero.it (Manlio Perillo)
Date: Sat, 13 Dec 2008 11:54:05 +0100
Subject: [Twisted-Python] PDF I thought may be of interest
In-Reply-To: <20081209223150.12555.1951446483.divmod.xquotient.1902@weber.divmod.com>
References: <200812092206.37080.ms@cerenity.org>
	<20081209223150.12555.1951446483.divmod.xquotient.1902@weber.divmod.com>
Message-ID: <4943944D.9050509@libero.it>

glyph at divmod.com ha scritto:
> On 10:06 pm, ms at cerenity.org wrote:
> [...]
> 
> For another, the paper arbitrarily redefines the word "threads" to mean 
> "this cool thing that doesn't exist yet", rather than existing things 
> that people call "threads".  It specifically mentions the deficiencies 
> of current thread implementations and does not always point to specific 
> improvements, let alone the challenge of popularizing and deploying 
> those improvements.  The comparison to erlang's concurrency model is 
> interesting, since they specifically avoid the term "threads" - erlang 
> calls them "processes" to avoid exactly the confusion the authors are 
> attempting to create.
> 

The reason Erlang calls them "processes" is because in Erlang each 
"thread of execution" share nothings with other "threads of execution".

Haskell, as an example, has "micro threads" support, and it calls them 
threads (or "Haskell threads"), since the state is shared (but the 
function that creates a new "thread" is called forkIO, with an 
additional function forkOS, that creates a thread bound to an OS thread).

Haskell also have nice synchronization support, MVar and Chan (with 
equivalent functions based on STM).
Something similar is found in Stackless Python.


As a final note, there is an interesting paper:
http://www.cis.upenn.edu/~lipeng/homepage/unify.html




Regards   Manlio Perillo



From mithrandi at mithrandi.net  Sat Dec 13 10:16:49 2008
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Sat, 13 Dec 2008 17:16:49 +0200
Subject: [Twisted-Python] PDF I thought may be of interest
In-Reply-To: <4943944D.9050509@libero.it>
References: <200812092206.37080.ms@cerenity.org>
	<20081209223150.12555.1951446483.divmod.xquotient.1902@weber.divmod.com>
	<4943944D.9050509@libero.it>
Message-ID: <20081213151649.GA31756@mithrandi.net>

* Manlio Perillo <manlio_perillo at libero.it> [2008-12-13 11:54:05 +0100]:

> glyph at divmod.com ha scritto:
>
>> For another, the paper arbitrarily redefines the word "threads" to mean 
>> "this cool thing that doesn't exist yet", rather than existing things  
>> that people call "threads".  It specifically mentions the deficiencies  
>> of current thread implementations and does not always point to specific 
>> improvements, let alone the challenge of popularizing and deploying  
>> those improvements.  The comparison to erlang's concurrency model is  
>> interesting, since they specifically avoid the term "threads" - erlang  
>> calls them "processes" to avoid exactly the confusion the authors are  
>> attempting to create.
>>
>
> The reason Erlang calls them "processes" is because in Erlang each  
> "thread of execution" share nothings with other "threads of execution".
>
> Haskell, as an example, has "micro threads" support, and it calls them  
> threads (or "Haskell threads"), since the state is shared (but the  
> function that creates a new "thread" is called forkIO, with an  
> additional function forkOS, that creates a thread bound to an OS thread).

There isn't any sharing of *mutable* state, though, unless you
explicitly share it, so this is a lot more similar to Erlang processes
than to Python threads.
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20081213/1e7d8835/attachment.pgp 

From erik at erikwickstrom.com  Sat Dec 13 13:08:43 2008
From: erik at erikwickstrom.com (Erik Wickstrom)
Date: Sat, 13 Dec 2008 10:08:43 -0800
Subject: [Twisted-Python] Non-blocking http client?
Message-ID: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>

Hi all,

I have an application that is doing some web spidering.  Right now I'm
using urllib to retrieve the URLs, but it is painfully slow.  I was
wondering if it's feasible to swap out urllib with a twisted client
that uses deferds so I can process urls in a more "parallel" fashion?

I've done a bunch of Googleing, but I haven't come across anything
that I can use as a drop in replacement.   If you can point me in the
right direction I'd really appreciate it!

Thanks for your help!
Erik



From exarkun at divmod.com  Sat Dec 13 14:14:38 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 13 Dec 2008 14:14:38 -0500
Subject: [Twisted-Python] twisted.mail.relaymanager.MXCalculator.getMX
	in Win32 got problem
In-Reply-To: <d067ddcf0812121646l20664e7aq9a26d4b9162d25c1@mail.gmail.com>
Message-ID: <20081213191438.20272.1880981667.divmod.quotient.20565@ohm>

On Sat, 13 Dec 2008 08:46:07 +0800, biziap biziap <fetbiz at gmail.com> wrote:
>The problem is that: the UDP listening ports increase rapidly and eventually
>come to the end: too many open file in selector.
>As many as the hosts you lookup, those UDP ports are still alive. It is very
>different from running this script in Linux (gentoo 2.6).
>In Linux, the listening UDP port keep only 1 instance no matter how many
>lookups .
>Try the script below:

This may be due to <http://twistedmatrix.com/trac/ticket/970>.

Jean-Paul



From exarkun at divmod.com  Sat Dec 13 14:17:07 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 13 Dec 2008 14:17:07 -0500
Subject: [Twisted-Python] Non-blocking http client?
In-Reply-To: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
Message-ID: <20081213191707.20272.2096389468.divmod.quotient.20568@ohm>

On Sat, 13 Dec 2008 10:08:43 -0800, Erik Wickstrom <erik at erikwickstrom.com> wrote:
>Hi all,
>
>I have an application that is doing some web spidering.  Right now I'm
>using urllib to retrieve the URLs, but it is painfully slow.  I was
>wondering if it's feasible to swap out urllib with a twisted client
>that uses deferds so I can process urls in a more "parallel" fashion?
>
>I've done a bunch of Googleing, but I haven't come across anything
>that I can use as a drop in replacement.   If you can point me in the
>right direction I'd really appreciate it!

There is no drop-in replacement.  There is an HTTP client in Twisted,
`twisted.web.client?.  There is also a more featureful HTTP client in
development but not yet available in a release of Twisted.  You can
find an example of how to use the former in the Twisted Web examples,
<http://twistedmatrix.com/projects/web/documentation/examples/>, and
you can follow progress of the latter at <http://twistedmatrix.com/trac/ticket/886>.

Jean-Paul



From andreas at kostyrka.org  Sat Dec 13 19:21:51 2008
From: andreas at kostyrka.org (Andreas Kostyrka)
Date: Sun, 14 Dec 2008 01:21:51 +0100
Subject: [Twisted-Python] Non-blocking http client?
In-Reply-To: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
References: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
Message-ID: <20081214002151.GA32520@hell.kostyrka.org>

On Sat, Dec 13, 2008 at 10:08:43AM -0800, Erik Wickstrom wrote:
> Hi all,
> 
> I have an application that is doing some web spidering.  Right now I'm
> using urllib to retrieve the URLs, but it is painfully slow.  I was
> wondering if it's feasible to swap out urllib with a twisted client
> that uses deferds so I can process urls in a more "parallel" fashion?
> 
> I've done a bunch of Googleing, but I haven't come across anything
> that I can use as a drop in replacement.   If you can point me in the
> right direction I'd really appreciate it!

Well, twisted.web.client is your path to DoS fame. Actually, if you are intenting to use it for
spidering 3rd party websites, I'd recommend a small dispatcher object that limits the number of concurrent connections per target 
server.

Andreas

> 
> Thanks for your help!
> Erik
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From exarkun at twistedmatrix.com  Sun Dec 14 00:05:11 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 14 Dec 2008 05:05:11 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1229231111.29.537321988@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081214/e153942b/attachment.htm 

From denis.bilenko at gmail.com  Sun Dec 14 12:58:58 2008
From: denis.bilenko at gmail.com (Denis Bilenko)
Date: Sun, 14 Dec 2008 23:58:58 +0600
Subject: [Twisted-Python] Non-blocking http client?
In-Reply-To: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
References: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
Message-ID: <95d6e98c0812140958r2669362bia9489b3032ef41b2@mail.gmail.com>

I've been working on eventlet-twisted integration and it includes a drop-in
replacements for standard Python modules (including urllib and httplib) that
do not block the reactor.

There was no release yet and there're no documentation written.
(You can find the documentation for the original eventlet here
http://wiki.secondlife.com/wiki/Eventlet,
however, not all of it is applicable. You can also read the
documentation of greenlet here
http://codespeak.net/py/dist/greenlet.html)

However, usage is very simple.
1. add this line before using any eventlet functions
from eventlet.twistedutil import join_reactor
2. import eventlet.green.urllib instead of urllib
3. Use eventlet.twistedutil.deferToGreenThread function to make
"blocking" functions
from eventlet.green.urllib return Deferred.

Here's an example on how to use eventlet.green.httplib and twisted's
LineReceiver
together to build a toy http proxy:

http://devel.ag-projects.com/~denis/cgi-bin/hgweb.cgi/file/097d879e0228/examples/twisted_http_proxy.py

To get the repository:

hg clone http://devel.ag-projects.com/~denis/cgi-bin/hgweb.cgi/eventlet_twisted

The only dependency is py.magic.greenlet from py library.
The code is only tested on python2.5 linux & macos so it probably won't work
on python2.4/windows but that will be fixed sometime in the future.

On Sun, Dec 14, 2008 at 12:08 AM, Erik Wickstrom <erik at erikwickstrom.com> wrote:
> Hi all,
>
> I have an application that is doing some web spidering.  Right now I'm
> using urllib to retrieve the URLs, but it is painfully slow.  I was
> wondering if it's feasible to swap out urllib with a twisted client
> that uses deferds so I can process urls in a more "parallel" fashion?
>
> I've done a bunch of Googleing, but I haven't come across anything
> that I can use as a drop in replacement.   If you can point me in the
> right direction I'd really appreciate it!
>
> Thanks for your help!
> Erik
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From mail.sensenmann at googlemail.com  Mon Dec 15 00:38:32 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Mon, 15 Dec 2008 06:38:32 +0100
Subject: [Twisted-Python] Twisted and MVC
Message-ID: <717b5780812142138m10f502ads371c0e3536f04085@mail.gmail.com>

Hi folks.

I want to build a MVC with the Model based on twisted with a custom
protocol. At the moment all my attemps terrible failed. So far the client
build a valid ssl-connection to the server and send the lines he is supposed
to send but don't recognise any incomming lines from the server. So I
decided to build the model from scratch again. The controller inits the
model-class (implementation of the custom chat-protocol) to be able to call
methods of the instance and send messages to the server. So how do I connect
the model to he server? In former implementations I were using the
Clientfactory but this didn't work very well.

Thanks for your help
Christian Scharkus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081215/4dea1b0d/attachment.htm 

From dialtone at gmail.com  Mon Dec 15 01:28:24 2008
From: dialtone at gmail.com (Valentino Volonghi)
Date: Sun, 14 Dec 2008 22:28:24 -0800
Subject: [Twisted-Python] Twisted and MVC
In-Reply-To: <717b5780812142138m10f502ads371c0e3536f04085@mail.gmail.com>
References: <717b5780812142138m10f502ads371c0e3536f04085@mail.gmail.com>
Message-ID: <7955E850-873E-4E33-8552-C5249FC655AD@gmail.com>


On Dec 14, 2008, at 9:38 PM, Christian Scharkus wrote:

> methods of the instance and send messages to the server. So how do I  
> connect
> the model to he server? In former implementations I were using the
> Clientfactory but this didn't work very well.


<mode yoda>
Use the code Luke
</mode yoda>

Without showing the code it's hard to give an help. Anyway it's the
responsibility of the protocol to translate a line into a controller  
call,
and the controller should then consider calling something on the
model but again without the code it's pretty hard to guess which is
edge A5 and which is panel G3. :)

-- 
Valentino Volonghi aka Dialtone
Now running MacOS X 10.5
Home Page: http://www.twisted.it
http://www.adroll.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081214/90881f29/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20081214/90881f29/attachment.pgp 

From mail.sensenmann at googlemail.com  Mon Dec 15 07:22:38 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Mon, 15 Dec 2008 13:22:38 +0100
Subject: [Twisted-Python] Twisted and MVC
In-Reply-To: <7955E850-873E-4E33-8552-C5249FC655AD@gmail.com>
References: <717b5780812142138m10f502ads371c0e3536f04085@mail.gmail.com>
	<7955E850-873E-4E33-8552-C5249FC655AD@gmail.com>
Message-ID: <717b5780812150422x134c6909t22b33542335a10dd@mail.gmail.com>

Well ... you're just right but the code is still closed atm so you have to
be happy with some snippets. I left out unimportant functions and replaced
names with representatives.

The main.py:

import controller

controller.controller().startConnection('127.0.0.1',23002)

The controller.py:

import model, view

class controller():
    def __init__(self):
        self.model = model.Client(self)
        self.view = view.view(self)

    def startConnection(self,server,port):
        self.model.startConnection(server,port)

    def gotConnection(self):
        print 'connection established'
        self.model.sendHandshake('some hash')

And finaly the model.py:

from twisted.internet import reactor, protocol, task, ssl
from twisted.protocols import basic

class Client(basic.LineOnlyReceiver, protocol.Factory):

    def __init__(self,controller):
        """Takes one argument: the instance of the controller Class."""
        self.controller=controller

    def startConnection(self,server,port):
        """Initiate the connection."""
        reactor.connectSSL(server, port, self, ssl.ClientContextFactory())
        reactor.run()

    def buildProtocol(self, addr):
        return self

    def connectionMade(self):
        self.controller.gotConnection()

    def sendHandshake(self,hash):
        """The Handshake has to be send first, after a ssl connection is
established"""
        self.sendLine('line to that the server respond with another line')

    def lineReceived(self,data):
        self.controller.foo(data)

2008/12/15 Valentino Volonghi <dialtone at gmail.com>

>
> On Dec 14, 2008, at 9:38 PM, Christian Scharkus wrote:
>
> methods of the instance and send messages to the server. So how do I
> connect
> the model to he server? In former implementations I were using the
> Clientfactory but this didn't work very well.
>
>
> <mode yoda>
> Use the code Luke
> </mode yoda>
>
> Without showing the code it's hard to give an help. Anyway it's the
> responsibility of the protocol to translate a line into a controller call,
> and the controller should then consider calling something on the
> model but again without the code it's pretty hard to guess which is
> edge A5 and which is panel G3. :)
>
> --
> Valentino Volonghi aka Dialtone
> Now running MacOS X 10.5
> Home Page: http://www.twisted.it
> http://www.adroll.com
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081215/cc06a111/attachment.htm 

From py.adriano at gmail.com  Mon Dec 15 08:11:07 2008
From: py.adriano at gmail.com (Adriano Marques)
Date: Mon, 15 Dec 2008 14:11:07 +0100
Subject: [Twisted-Python] Re: Twisted FTP
In-Reply-To: <ab9df3750812141557v68076808o7c7df6764f79e882@mail.gmail.com>
References: <ab9df3750812141557v68076808o7c7df6764f79e882@mail.gmail.com>
Message-ID: <29ec21540812150511i408bdce6g9be06a1e81df5581@mail.gmail.com>

Hello Gergely,

> I just started to learn twisted. I tried to look after a working FTP example
> on the net for twisted, but unfortunately I could not really found any. This
> one seemed to be the most completed, but it says "Unknown error code" when I
> try to connect to it.

I'm sorry, but I don't have the chance of looking it further right
now, but I took a look at your code, and I say that instead of making
FTPServerFactory inherit from FtpFactory, you opted to instantiate it
inside a object inherited class. I never tried this approach, and that
may be the root of your problem. I'm redirecting you e-mail to twisted
mailing list, so people there can help you better. I advice you to
subscribe to that mailing list to get help (if you aren't subscribed
yet). You may also try the IRC channel for some help. Twisted folks
are very responsive and willing to help.

> In my opinion the code is fine. May I ask you to take a look on it please,
> and give me any suggestions, if you can see, why it is not working?
>
> I would really appreciate your help.


Kind Regards,

-- 
Adriano Monteiro Marques

http://adriano-marques.blogspot.com
http://www.umitproject.org
http://www.pythonbenelux.org

"Don't stay in bed, unless you can make money in bed." - George Burns
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftpServer.py
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081215/f385d79b/attachment.txt 

From muaazhussain128 at gmail.com  Mon Dec 15 12:31:39 2008
From: muaazhussain128 at gmail.com (Muaaz Hussain)
Date: Mon, 15 Dec 2008 20:31:39 +0300
Subject: [Twisted-Python] twisted eat the memory
Message-ID: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>

I wrote web application on twisted and my application read from ulogd daemon
and push the output to the client browser using AJAX  .also I have another
application displaying ethernets traffic using AJAX.
but after some minutes the twisted process in the server eat the memory and
the OOM-killer of the linux will kill the twisted process.
are there any solution to make the twisted release the memory .

note: my ram is 256mb

-- 
Muaaz Osman Hussain

IT Researcher
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081215/8b111dd7/attachment.htm 

From cary.hull at gmail.com  Mon Dec 15 12:43:02 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Mon, 15 Dec 2008 12:43:02 -0500
Subject: [Twisted-Python] twisted eat the memory
In-Reply-To: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
References: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
Message-ID: <3fce0ae70812150943saef4d0flcdadc93d3ed5fea6@mail.gmail.com>

What version of Python are you using? 2.4 and below have problems
releasing memory back to the OS. Since Twisted apps are normally long
running Python daemons they can be more prone to memory leaks. You
need to be aware of how objects are garbage collected in Python and
rework your code if necessary.

Twisted itself should not be the source of problem.

An interesting article on the subject:
http://evanjones.ca/python-memory.html

-Cary

On Mon, Dec 15, 2008 at 12:31 PM, Muaaz Hussain
<muaazhussain128 at gmail.com> wrote:
> I wrote web application on twisted and my application read from ulogd daemon
> and push the output to the client browser using AJAX  .also I have another
> application displaying ethernets traffic using AJAX.
> but after some minutes the twisted process in the server eat the memory and
> the OOM-killer of the linux will kill the twisted process.
> are there any solution to make the twisted release the memory .
>
> note: my ram is 256mb
>
> --
> Muaaz Osman Hussain
>
> IT Researcher
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From exarkun at divmod.com  Mon Dec 15 12:49:08 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 15 Dec 2008 12:49:08 -0500
Subject: [Twisted-Python] twisted eat the memory
In-Reply-To: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
Message-ID: <20081215174908.20272.59442993.divmod.quotient.21396@ohm>

On Mon, 15 Dec 2008 20:31:39 +0300, Muaaz Hussain <muaazhussain128 at gmail.com> wrote:
>I wrote web application on twisted and my application read from ulogd daemon
>and push the output to the client browser using AJAX  .also I have another
>application displaying ethernets traffic using AJAX.
>but after some minutes the twisted process in the server eat the memory and
>the OOM-killer of the linux will kill the twisted process.
>are there any solution to make the twisted release the memory .
>
>note: my ram is 256mb
>

This isn't a feature of Twisted, so there's no simple flag you can pass
or alternate API you can use to avoid it.  Perhaps you can share a minimal,
self-contained example program which produces this behavior and someone can
point out what the cause of the memory use is.  Make sure the example is
short (does not contain code unrelated to the high memory usage) and can be
run to produce the problem.

Jean-Paul



From andreas at kostyrka.org  Mon Dec 15 14:39:48 2008
From: andreas at kostyrka.org (Andreas Kostyrka)
Date: Mon, 15 Dec 2008 20:39:48 +0100
Subject: [Twisted-Python] twisted eat the memory
In-Reply-To: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
References: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
Message-ID: <20081215203948.5dbe967f@andi-lap>

Am Mon, 15 Dec 2008 20:31:39 +0300
schrieb "Muaaz Hussain" <muaazhussain128 at gmail.com>:

> I wrote web application on twisted and my application read from ulogd
> daemon and push the output to the client browser using AJAX  .also I
> have another application displaying ethernets traffic using AJAX.
> but after some minutes the twisted process in the server eat the
> memory and the OOM-killer of the linux will kill the twisted process.
> are there any solution to make the twisted release the memory .
> 
> note: my ram is 256mb
> 

Well, CPython uses a dual garbage collection policy (reference
counting, and cycle breaking GC), and there are at least some cases
where garbage can leak. (cycles with __del__ methods defined.)

But in a different way, that only helps you manage memory, but in the
end you as the developer need to decide which objects you still need
to forget about the object before Python can release the memory.

Another point is that under Unix, processes tend to keep memory they
have allocated to themselves, so if your process needs say 300MB at
start-up and releases 270MB you need to check if these really end up
available for the OS.

But as exarkun pointed out, that's a nontrivial problem, and without
reducing it to a small and runnable example that shows your problem,
the list won't be able to help you much. (If you have such general
python questions, you might consider posting also to tutor at python.org,
which tends to be slightly more considerate to newbies.)

Andreas
 



From aryeh at bigfoot.com  Tue Dec 16 11:29:33 2008
From: aryeh at bigfoot.com (Arye)
Date: Tue, 16 Dec 2008 17:29:33 +0100
Subject: [Twisted-Python] combining addCallback and callLater ?
Message-ID: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>

Dear list,

I would like to add a callback that delays the chain. In other words I would
like to combine:
defer.Deferred().addCallback
and reactor.callLater

The only solution I came up with was the code below.

There must be a more elegant way to do this.
Any ideas would be greatly appreciated,
All the best,

*************************begin
from twisted.internet import reactor, defer

def printResults(results, arg):
    print "In printResults results=", results
    print "In printResults arg=", arg
    if arg == 2:
        reactor.stop()


def fireLater(results, d2):
    print "In fireLater results=", results
    reactor.callLater(5, d2.callback, "firelater")

d1 = defer.Deferred()
d2 = defer.Deferred()
d2.addCallback( printResults, 1)
d2.addCallback( printResults, 2)


d1.addCallback(fireLater, d2)
d1.callback("fire")

reactor.run()
*************************end
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081216/0c0d7d22/attachment.htm 

From amauryfa at gmail.com  Tue Dec 16 12:09:08 2008
From: amauryfa at gmail.com (Amaury Forgeot d'Arc)
Date: Tue, 16 Dec 2008 18:09:08 +0100
Subject: [Twisted-Python] combining addCallback and callLater ?
In-Reply-To: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>
References: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>
Message-ID: <e27efe130812160909p10d45aa8o51550f497894dea3@mail.gmail.com>

Hi,

Arye wrote:
> I would like to add a callback that delays the chain. In other words I would
> like to combine:
> defer.Deferred().addCallback
> and reactor.callLater
>
> The only solution I came up with was the code below.
>
> There must be a more elegant way to do this.
> Any ideas would be greatly appreciated,
> All the best,
>
> *************************begin
> from twisted.internet import reactor, defer
>
> def printResults(results, arg):
>     print "In printResults results=", results
>     print "In printResults arg=", arg
>     if arg == 2:
>         reactor.stop()
>
>
> def fireLater(results, d2):
>     print "In fireLater results=", results
>     reactor.callLater(5, d2.callback, "firelater")
>
> d1 = defer.Deferred()
> d2 = defer.Deferred()
> d2.addCallback( printResults, 1)
> d2.addCallback( printResults, 2)
>
>
> d1.addCallback(fireLater, d2)
> d1.callback("fire")
>
> reactor.run()
> *************************end

I've already written this some times:

d1.addCallback(5, reactor.callLater, d2.callback, "firelater")

Hope this, helps,

-- 
Amaury Forgeot d'Arc



From dr.marc.byrd at gmail.com  Tue Dec 16 14:55:06 2008
From: dr.marc.byrd at gmail.com (Marc Byrd)
Date: Tue, 16 Dec 2008 11:55:06 -0800
Subject: [Twisted-Python] Syslog Listener UDP
In-Reply-To: <774f50bd0810050612g791d7d8dy8f00ba5f2c6baad4@mail.gmail.com>
References: <a33934630809281118y34e23dfdq769c5ea2ab8e9acd@mail.gmail.com>
	<774f50bd0810050612g791d7d8dy8f00ba5f2c6baad4@mail.gmail.com>
Message-ID: <a33934630812161155g1b388f56s5b575eefdd6cc9eb@mail.gmail.com>

Sorry for the late response.

This has (obviously) been a background, "wouldn't it be cool" type project.

Once I got remote logging over udp working w/ two machines w/ syslog-ng, the
tiwsted python part was easy:
from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor

class Echo(DatagramProtocol):

    def datagramReceived(self, data, (host, port)):
        print "received %r from %s:%d" % (data, host, port)
        self.transport.write(data, (host, port))

reactor.listenUDP(514, Echo())
reactor.run()

Part of my problem was that I was trying to use syslog on log-client and
syslog-ng on log-server; not sure I (yet) know of any reason why this
wouldn't work, but the point is, I got it working well enough to know that
the twisted stuff is working as expected.

So with syslog-ng on log-clients, all sending to a central log server over
udp, listening w/ twisted - the possibilities are endless!

Cheers,


Marc



On Sun, Oct 5, 2008 at 5:12 AM, HG <hackgou at gmail.com> wrote:

> I'm interested with this.
> any more progress?
> thanks
> HG
>
> On Mon, Sep 29, 2008 at 2:18 AM, Marc Byrd <dr.marc.byrd at gmail.com> wrote:
>
>> Hi,
>>
>> I would like to build a syslog(udp port 514) listener in twisted.  The
>> goal is to make it compatible with syslog and syslog-ng, which may be
>> configured on a "client" to send log entries (as they occur) via udp (fire
>> and forget) to a remote server (my twisted server).
>>
>> Is there already something out there that would do this or that would be a
>> good start?
>>
>> Thanks,
>>
>>
>> Marc
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081216/d9343343/attachment.htm 

From marcin at ascii-art.pl  Wed Dec 17 06:25:10 2008
From: marcin at ascii-art.pl (=?ISO-8859-2?Q?Marcin_Gli=F1ski?=)
Date: Wed, 17 Dec 2008 12:25:10 +0100
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
Message-ID: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>

Hello!

There's a problem I can't find an answer to. I'd like to design Xml
based protocol.
I've found XmlStream, read doc and found addObserver method. I wrote
simple code:

class XmlTest(xmlstream.XmlStream):
    # (...)
    def connectionMade(self):
        xmlstream.XmlStream.connectionMade(self)
        self.addObserver("/frame", self.frameHandler)
        # (...)

    # (...)

    def frameHandler(self, data):
        print "Wilma, I'm Home!"

When I send XML with frame element as a root:

<frame>
 <whatever/>
</frame>

FrameHandler isn't executed, but if I put frame element inside some
other root element:

<sheep>
 <frame>
  <whatever/>
 </frame>
</sheep>

Then my handler is activated. Why? First, I thought maybe my XPath
knowledge is wrong,
so I checked few tutorials[1] and they told me there's something wrong with
addObserver method. How to make it working?



~MG.
(Hi, I'm new here :)



From adelagon at gmail.com  Wed Dec 17 07:31:13 2008
From: adelagon at gmail.com (Alvin Delagon)
Date: Wed, 17 Dec 2008 20:31:13 +0800
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
In-Reply-To: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>
References: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>
Message-ID: <7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>

Hello Marcin,

XmlStream is an implementation of XMPP/Jabber protocol (which is widely used
for Instant Messaging). If you have time please read about this on
www.xmpp.org. The reason why /frame handler was not executed is because
XMPP/Jabber sessions starts and ends with streams like for example:

<*stream*:*stream* xmlns:*stream*="http://etherx.jabber.org/streams">
.
.
.
<message to='foo at jabber.org' from='bar at jabber.org>
   <body>Hello World!</body>
</message>
.
.
.
</stream:stream>

You might want to take a look at twisted XML-RPC libraries.

---
Alvin


On Wed, Dec 17, 2008 at 7:25 PM, Marcin Gli?ski <marcin at ascii-art.pl> wrote:

> Hello!
>
> There's a problem I can't find an answer to. I'd like to design Xml
> based protocol.
> I've found XmlStream, read doc and found addObserver method. I wrote
> simple code:
>
> class XmlTest(xmlstream.XmlStream):
>    # (...)
>    def connectionMade(self):
>        xmlstream.XmlStream.connectionMade(self)
>        self.addObserver("/frame", self.frameHandler)
>        # (...)
>
>    # (...)
>
>    def frameHandler(self, data):
>        print "Wilma, I'm Home!"
>
> When I send XML with frame element as a root:
>
> <frame>
>  <whatever/>
> </frame>
>
> FrameHandler isn't executed, but if I put frame element inside some
> other root element:
>
> <sheep>
>  <frame>
>  <whatever/>
>  </frame>
> </sheep>
>
> Then my handler is activated. Why? First, I thought maybe my XPath
> knowledge is wrong,
> so I checked few tutorials[1] and they told me there's something wrong with
> addObserver method. How to make it working?
>
>
>
> ~MG.
> (Hi, I'm new here :)
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
http://www.alvinatorsplayground.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081217/db92dd8a/attachment.htm 

From marcin at ascii-art.pl  Wed Dec 17 08:01:47 2008
From: marcin at ascii-art.pl (=?ISO-8859-2?Q?Marcin_Gli=F1ski?=)
Date: Wed, 17 Dec 2008 14:01:47 +0100
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
In-Reply-To: <7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>
References: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>
	<7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>
Message-ID: <6646dd390812170501t7cb0af20y4232770d506f9f79@mail.gmail.com>

2008/12/17 Alvin Delagon:

> XmlStream is an implementation of XMPP/Jabber protocol (which is widely used
> for Instant Messaging).

Which XmlStream? I've found two:

XMPP: twisted.words.protocols.jabber.xmlstream
X-ish: twisted.words.xish.xmlstream

I've been trying to use the second one. Are they the same?


> You might want to take a look at twisted XML-RPC libraries.

Sure, I will. Thanks :)



~MG.



From gabriel.rossetti at arimaz.com  Thu Dec 18 08:35:00 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Thu, 18 Dec 2008 14:35:00 +0100
Subject: [Twisted-Python] python properties in twisted don't work
Message-ID: <494A5184.2040509@arimaz.com>

Hello everyone!

I have a problem, if I try to use python property in a twisted program, 
it doesn't really work...the accessor works but as soon as I use the 
mutator, it no longer uses the property (and doesn't set the "real" 
variable. I tried an example without twisted, it works, and with the 
twisted example it doesn't... does anyone know what is going on? Thank you!

Gabriel

#-------------------------------------------------------------------------------------------------------
# This doesn't work, why????
#-------------------------------------------------------------------------------------------------------

from twisted.internet.protocol import Protocol, ClientFactory
from sys import stdout

class Echo(Protocol):

    def __init__(self):
        self.__x = None

    def __getx(self):
        return self.__x
   
    def __setx(self, value):
        if(value != 0):
            self.__x = value
           
    def __delx(self):
        del self.__x

    x = property(__getx, __setx, __delx, "the doc")

    def connectionMade(self):
        t = self.x
        assert t is None
        self.x = 4
        assert self.__x == 4
        t = self.x
        assert t == 4
        self.x = 0
        assert self.__x == 4
        t = self.x
        assert t == 4
       
    def dataReceived(self, data):
        stdout.write(data)


class EchoClientFactory(ClientFactory):
    def startedConnecting(self, connector):
        print 'Started to connect.'

    def buildProtocol(self, addr):
        print 'Connected.'
        return Echo()

    def clientConnectionLost(self, connector, reason):
        print 'Lost connection.  Reason:', reason

    def clientConnectionFailed(self, connector, reason):
        print 'Connection failed. Reason:', reason

if(__name__ == "__main__"):
   
    from twisted.internet import reactor
    reactor.connectTCP("localhost", 4444, EchoClientFactory())
    reactor.run()


#-------------------------------------------------------------------------------------------------------
# This works, as expected
#----------------------------------------------------------------------------------------------------
class C(object):
       
    def __init__(self):
        self._x = None
       
    def __getx(self):
        return self._x
       
    def __setx(self, value):
        if(value != 0):
            self._x = value
           
    def __delx(self):
        del self._x
       
    x = property(__getx, __setx, __delx, "The doc")


if(__name__ == "__main__"):
   
    c = C()
    t = c.x
    assert t is None
    c.x = 4
    assert c._x == 4
    t = c.x
    assert t == 4
    c.x = 0
    assert c._x == 4
    t = c.x
    assert t == 4





From tzury.by at gmail.com  Thu Dec 18 08:38:55 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Thu, 18 Dec 2008 15:38:55 +0200
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <2f5ea7490812180208y76043b9co56358eebdae48a6e@mail.gmail.com>
References: <2f5ea7490812180123wdfeb2f1k6ad493f1e632b9e9@mail.gmail.com>
	<2f5ea7490812180208y76043b9co56358eebdae48a6e@mail.gmail.com>
Message-ID: <2f5ea7490812180538l66c1048bj2ae82ffbdd01b3@mail.gmail.com>

Hi,
I am willing to deploy on my server an SSH daemon which I can control
what commands can be executed, and by who.
After playing with jailkit [link] I realised that implementing my own
SSH server will give me more power and scalability (especially
regarding of users, keys and accounts management).

Naturally I approached twisted knowing it will solve this problem as a
smart kiddo solves a simple safari puzzle.

Playing with samples found on the web and at Twisted docs, I realised
that twisted has everything I need for the task, but I am missing the
knowledge of how to glue it all together.

In fact, a command if not working on the first strike, works on the second try.

at http://gist.github.com/37446 I pasted the server.py code. which is
a modification of what I've found at:
http://twistedmatrix.com/projects/conch/documentation/examples/sshsimpleserver.py

for instance trying to run git over ssh yeilds error at first, and
when running again seems to be working.
below is the console output on the client side

#first attempt
tzury at regulus:~$ git clone
ssh://tzury at localhost:5022/home/tzury/devel/ice/snoip/freespeech
clone-repo7
Initialized empty Git repository in /home/tzury/clone-repo7/.git/
remote: Counting objects: 347, done.
remote: Compressing objects: 100% (232/232), done.
Receiving objects: 100% (347/347), 91.75 KiB, done.
remote: Total 347 (delta 234), reused 177 (delta 114)
fatal: The remote end hung up unexpectedly
Resolving deltas: 100% (234/234), done.
error: waitpid (async) failed
fatal: error in sideband demultiplexer

#second attempt
tzury at regulus:~$ git clone
ssh://tzury at localhost:5022/home/tzury/devel/ice/snoip/freespeech
clone-repo7
Initialized empty Git repository in /home/tzury/clone-repo7/.git/
remote: Counting objects: 347, done.
remote: Compressing objects: 100% (232/232), done.
Receiving objects: 100% (347/347), 91.75 KiB, done.
remote: Total 347 (delta 234), reused 177 (delta 114)
Resolving deltas: 100% (234/234), done.
tzury at regulus:~$



-- 
Tzury Bar Yochay



From exarkun at divmod.com  Thu Dec 18 08:59:30 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 18 Dec 2008 08:59:30 -0500
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <494A5184.2040509@arimaz.com>
Message-ID: <20081218135930.20272.982548839.divmod.quotient.22597@ohm>

On Thu, 18 Dec 2008 14:35:00 +0100, Gabriel Rossetti <gabriel.rossetti at arimaz.com> wrote:
>Hello everyone!
>
>I have a problem, if I try to use python property in a twisted program, it 
>doesn't really work...the accessor works but as soon as I use the mutator, 
>it no longer uses the property (and doesn't set the "real" variable. I tried 
>an example without twisted, it works, and with the twisted example it 
>doesn't... does anyone know what is going on? Thank you!

Property setters only work on new-style classes.  Many classes defined by
Twisted are classic, so they will not work with properties unless you make
your subclass new-style, which you can do by mixing in object.

Jean-Paul



From exarkun at divmod.com  Thu Dec 18 09:01:36 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 18 Dec 2008 09:01:36 -0500
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <2f5ea7490812180538l66c1048bj2ae82ffbdd01b3@mail.gmail.com>
Message-ID: <20081218140136.20272.811818444.divmod.quotient.22598@ohm>

On Thu, 18 Dec 2008 15:38:55 +0200, Tzury Bar Yochay <tzury.by at gmail.com> wrote:
>Hi,
>I am willing to deploy on my server an SSH daemon which I can control
>what commands can be executed, and by who.
>After playing with jailkit [link] I realised that implementing my own
>SSH server will give me more power and scalability (especially
>regarding of users, keys and accounts management).
>
>Naturally I approached twisted knowing it will solve this problem as a
>smart kiddo solves a simple safari puzzle.
>
>Playing with samples found on the web and at Twisted docs, I realised
>that twisted has everything I need for the task, but I am missing the
>knowledge of how to glue it all together.
>
>In fact, a command if not working on the first strike, works on the second try.

Can you have git be more verbose about what it's going?  If it is running
OpenSSH's ssh client, can you have it pass -v (verbose) a few times?  That
might provide more hints about what's going wrong.  You should also try
enabling Twisted logging in your SSH server to see if any useful information
is available there.

Jean-Paul



From drew.smathers at gmail.com  Thu Dec 18 09:04:44 2008
From: drew.smathers at gmail.com (Drew Smathers)
Date: Thu, 18 Dec 2008 09:04:44 -0500
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <494A5184.2040509@arimaz.com>
References: <494A5184.2040509@arimaz.com>
Message-ID: <368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>

Protocol is an old-style class - doesn't inherit from object - so
property won't work in that context.  This won't be a problem in
python 3 - old-style/new-style classes are consolidated.

-Drew

On Thu, Dec 18, 2008 at 8:35 AM, Gabriel Rossetti
<gabriel.rossetti at arimaz.com> wrote:
> Hello everyone!
>
> I have a problem, if I try to use python property in a twisted program, it
> doesn't really work...the accessor works but as soon as I use the mutator,
> it no longer uses the property (and doesn't set the "real" variable. I tried
> an example without twisted, it works, and with the twisted example it
> doesn't... does anyone know what is going on? Thank you!
>
> Gabriel
>
> #-------------------------------------------------------------------------------------------------------
> # This doesn't work, why????
> #-------------------------------------------------------------------------------------------------------
>
> from twisted.internet.protocol import Protocol, ClientFactory
> from sys import stdout
>
> class Echo(Protocol):
>
>   def __init__(self):
>       self.__x = None
>
>   def __getx(self):
>       return self.__x
>     def __setx(self, value):
>       if(value != 0):
>           self.__x = value
>             def __delx(self):
>       del self.__x
>
>   x = property(__getx, __setx, __delx, "the doc")
>
>   def connectionMade(self):
>       t = self.x
>       assert t is None
>       self.x = 4
>       assert self.__x == 4
>       t = self.x
>       assert t == 4
>       self.x = 0
>       assert self.__x == 4
>       t = self.x
>       assert t == 4
>         def dataReceived(self, data):
>       stdout.write(data)
>
>
> class EchoClientFactory(ClientFactory):
>   def startedConnecting(self, connector):
>       print 'Started to connect.'
>
>   def buildProtocol(self, addr):
>       print 'Connected.'
>       return Echo()
>
>   def clientConnectionLost(self, connector, reason):
>       print 'Lost connection.  Reason:', reason
>
>   def clientConnectionFailed(self, connector, reason):
>       print 'Connection failed. Reason:', reason
>
> if(__name__ == "__main__"):
>     from twisted.internet import reactor
>   reactor.connectTCP("localhost", 4444, EchoClientFactory())
>   reactor.run()
>
>
> #-------------------------------------------------------------------------------------------------------
> # This works, as expected
> #----------------------------------------------------------------------------------------------------
> class C(object):
>         def __init__(self):
>       self._x = None
>         def __getx(self):
>       return self._x
>         def __setx(self, value):
>       if(value != 0):
>           self._x = value
>             def __delx(self):
>       del self._x
>         x = property(__getx, __setx, __delx, "The doc")
>
>
> if(__name__ == "__main__"):
>     c = C()
>   t = c.x
>   assert t is None
>   c.x = 4
>   assert c._x == 4
>   t = c.x
>   assert t == 4
>   c.x = 0
>   assert c._x == 4
>   t = c.x
>   assert t == 4
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
\\\\\/\"/\\\\\\\\\\\
\\\\/ // //\/\\\\\\\
\\\/  \\// /\ \/\\\\
\\/ /\/ / /\/ /\ \\\
\/ / /\/ /\  /\\\ \\
/ /\\\  /\\\ \\\\\/\
\/\\\\\/\\\\\/\\\\\\
               d.p.s



From gabriel.rossetti at arimaz.com  Thu Dec 18 10:39:59 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Thu, 18 Dec 2008 16:39:59 +0100
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <20081218135930.20272.982548839.divmod.quotient.22597@ohm>
References: <20081218135930.20272.982548839.divmod.quotient.22597@ohm>
Message-ID: <494A6ECF.70000@arimaz.com>

Jean-Paul Calderone wrote:
> On Thu, 18 Dec 2008 14:35:00 +0100, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com> wrote:
>> Hello everyone!
>>
>> I have a problem, if I try to use python property in a twisted 
>> program, it doesn't really work...the accessor works but as soon as I 
>> use the mutator, it no longer uses the property (and doesn't set the 
>> "real" variable. I tried an example without twisted, it works, and 
>> with the twisted example it doesn't... does anyone know what is going 
>> on? Thank you!
>
> Property setters only work on new-style classes.  Many classes defined by
> Twisted are classic, so they will not work with properties unless you 
> make
> your subclass new-style, which you can do by mixing in object.
>
> Jean-Paul
Thank you, I wasn't aware of that, I'll add object when inheriting from 
any Twisted stuff then.

Gabriel



From gabriel.rossetti at arimaz.com  Thu Dec 18 10:49:38 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Thu, 18 Dec 2008 16:49:38 +0100
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
In-Reply-To: <6646dd390812170501t7cb0af20y4232770d506f9f79@mail.gmail.com>
References: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>	<7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>
	<6646dd390812170501t7cb0af20y4232770d506f9f79@mail.gmail.com>
Message-ID: <494A7112.1010007@arimaz.com>

Hello Marcin,

Marcin Gli?ski wrote:
> 2008/12/17 Alvin Delagon:
>
>   
>> XmlStream is an implementation of XMPP/Jabber protocol (which is widely used
>> for Instant Messaging).
>>     
>
> Which XmlStream? I've found two:
>
> XMPP: twisted.words.protocols.jabber.xmlstream
> X-ish: twisted.words.xish.xmlstream
>
> I've been trying to use the second one. Are they the same?
>   
use the second one, unless you are writing a Jabber client/server. The 
Xish one is more generic, I use it in my apps. Imagine that the XMPP 
session is like one giant XMPP msg/document, it's root element/node is 
<stream/>, a session must be opened by each party if it's bidirectional :

Client Server
| <stream> |
|----------------------------------------->|
| | open the session
| <stream> |
|<-----------------------------------------|
| |
| <msg>.....</msg> |
|----------------------------------------->|
| | exchange msgs (as many as you want)
| <msg>.....</msg> |
|<-----------------------------------------|
| |
| </stream> |
|----------------------------------------->|
| | close the session when done
| </stream> |
|<-----------------------------------------|
| |


I hope this helps,
Gabriel

>
>   
>> You might want to take a look at twisted XML-RPC libraries.
>>     
>
> Sure, I will. Thanks :)
>
>
>
> ~MG.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>   



From gabriel.rossetti at arimaz.com  Thu Dec 18 11:07:26 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Thu, 18 Dec 2008 17:07:26 +0100
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
In-Reply-To: <494A7112.1010007@arimaz.com>
References: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>	<7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>	<6646dd390812170501t7cb0af20y4232770d506f9f79@mail.gmail.com>
	<494A7112.1010007@arimaz.com>
Message-ID: <494A753E.1060508@arimaz.com>

Gabriel Rossetti wrote:
> Hello Marcin,
>
> Marcin Gli?ski wrote:
>> 2008/12/17 Alvin Delagon:
>>
>>  
>>> XmlStream is an implementation of XMPP/Jabber protocol (which is 
>>> widely used
>>> for Instant Messaging).
>>>     
>>
>> Which XmlStream? I've found two:
>>
>> XMPP: twisted.words.protocols.jabber.xmlstream
>> X-ish: twisted.words.xish.xmlstream
>>
>> I've been trying to use the second one. Are they the same?
>>   
> use the second one, unless you are writing a Jabber client/server. The 
> Xish one is more generic, I use it in my apps. Imagine that the XMPP 
> session is like one giant XMPP msg/document, it's root element/node is 
> <stream/>, a session must be opened by each party if it's bidirectional :
>
> Client Server
> | <stream> |
> |----------------------------------------->|
> | | open the session
> | <stream> |
> |<-----------------------------------------|
> | |
> | <msg>.....</msg> |
> |----------------------------------------->|
> | | exchange msgs (as many as you want)
> | <msg>.....</msg> |
> |<-----------------------------------------|
> | |
> | </stream> |
> |----------------------------------------->|
> | | close the session when done
> | </stream> |
> |<-----------------------------------------|
> | |
>
>
> I hope this helps,
> Gabriel
>

oups, the spaces got eaten up, those pipe ('|') symbols are supposed to 
be aligned on the right side....

>>
>>  
>>> You might want to take a look at twisted XML-RPC libraries.
>>>     
>>
>> Sure, I will. Thanks :)
>>
>>
>>
>> ~MG.
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>   
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From tzury.by at gmail.com  Thu Dec 18 11:55:12 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Thu, 18 Dec 2008 18:55:12 +0200
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <20081218140136.20272.811818444.divmod.quotient.22598@ohm>
References: <2f5ea7490812180538l66c1048bj2ae82ffbdd01b3@mail.gmail.com>
	<20081218140136.20272.811818444.divmod.quotient.22598@ohm>
Message-ID: <2f5ea7490812180855jb6488ud6ec50925a28d3cc@mail.gmail.com>

On Thu, Dec 18, 2008 at 4:01 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Thu, 18 Dec 2008 15:38:55 +0200, Tzury Bar Yochay <tzury.by at gmail.com>
> wrote:
>>
>> Hi,
>> I am willing to deploy on my server an SSH daemon which I can control
>> what commands can be executed, and by who.
>> After playing with jailkit [link] I realised that implementing my own
>> SSH server will give me more power and scalability (especially
>> regarding of users, keys and accounts management).
>>
>> Naturally I approached twisted knowing it will solve this problem as a
>> smart kiddo solves a simple safari puzzle.
>>
>> Playing with samples found on the web and at Twisted docs, I realised
>> that twisted has everything I need for the task, but I am missing the
>> knowledge of how to glue it all together.
>>
>> In fact, a command if not working on the first strike, works on the second
>> try.
>
> Can you have git be more verbose about what it's going?  If it is running
> OpenSSH's ssh client, can you have it pass -v (verbose) a few times?  That
> might provide more hints about what's going wrong.  You should also try
> enabling Twisted logging in your SSH server to see if any useful information
> is available there.
>
> Jean-Paul
>

Jean Paul, thanks for your suggestions, however, either -v or
--verbose yields an error: unknown switch `v'
regarding logs on the twisted side, I got this line at the top of the file:
log.startLogging(sys.stderr)
is there anything else I can do in order to expand the logging options.

anyway, once I changed the following:

    def execCommand(self, proto, cmd):
        command = ('git-shell', '-c', cmd)
        shell = '/usr/bin/git-shell'
        reactor.spawnProcess(proto, shell, command)
into:

    def execCommand(self, proto, cmd):
        command = ('git-shell', '-c', cmd)
        shell = '/usr/bin/git-shell'
        reactor.callFromThread(lambda: reactor.spawnProcess(proto,
shell, command))

Everything works fine. Seems like this separation did something good.



From exarkun at divmod.com  Thu Dec 18 12:08:28 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 18 Dec 2008 12:08:28 -0500
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <2f5ea7490812180855jb6488ud6ec50925a28d3cc@mail.gmail.com>
Message-ID: <20081218170828.20272.81478691.divmod.quotient.22625@ohm>

On Thu, 18 Dec 2008 18:55:12 +0200, Tzury Bar Yochay <tzury.by at gmail.com> wrote:
>On Thu, Dec 18, 2008 at 4:01 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
>> On Thu, 18 Dec 2008 15:38:55 +0200, Tzury Bar Yochay <tzury.by at gmail.com>
>> wrote:
>>>
>>> Hi,
>>> I am willing to deploy on my server an SSH daemon which I can control
>>> what commands can be executed, and by who.
>>> After playing with jailkit [link] I realised that implementing my own
>>> SSH server will give me more power and scalability (especially
>>> regarding of users, keys and accounts management).
>>>
>>> Naturally I approached twisted knowing it will solve this problem as a
>>> smart kiddo solves a simple safari puzzle.
>>>
>>> Playing with samples found on the web and at Twisted docs, I realised
>>> that twisted has everything I need for the task, but I am missing the
>>> knowledge of how to glue it all together.
>>>
>>> In fact, a command if not working on the first strike, works on the second
>>> try.
>>
>> Can you have git be more verbose about what it's going?  If it is running
>> OpenSSH's ssh client, can you have it pass -v (verbose) a few times?  That
>> might provide more hints about what's going wrong.  You should also try
>> enabling Twisted logging in your SSH server to see if any useful information
>> is available there.
>>
>> Jean-Paul
>>
>
>Jean Paul, thanks for your suggestions, however, either -v or
>--verbose yields an error: unknown switch `v'

I'm not familiar with git.  I meant for -v to be passed as an argument to
ssh.

>regarding logs on the twisted side, I got this line at the top of the file:
>log.startLogging(sys.stderr)
>is there anything else I can do in order to expand the logging options.

Ah, I overlooked that.  Once you've enabled it, it's basically as verbose
as it's going to get.  What do you see relating to SSH in the log file?
Conch is pretty verbose.

>
>anyway, once I changed the following:
>
>    def execCommand(self, proto, cmd):
>        command = ('git-shell', '-c', cmd)
>        shell = '/usr/bin/git-shell'
>        reactor.spawnProcess(proto, shell, command)
>into:
>
>    def execCommand(self, proto, cmd):
>        command = ('git-shell', '-c', cmd)
>        shell = '/usr/bin/git-shell'
>        reactor.callFromThread(lambda: reactor.spawnProcess(proto,
>shell, command))
>
>Everything works fine. Seems like this separation did something good.

Since execCommand is already only called in the reactor thread, this
isn't doing much - but it is slightly changing the timing of when
things happen.  That suggests the real problem may be a race between
different parts of your code.  It's not obvious what the race might be
between, from reading your code, though.

Jean-Paul



From tzury.by at gmail.com  Thu Dec 18 13:18:20 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Thu, 18 Dec 2008 20:18:20 +0200
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <20081218170828.20272.81478691.divmod.quotient.22625@ohm>
References: <2f5ea7490812180855jb6488ud6ec50925a28d3cc@mail.gmail.com>
	<20081218170828.20272.81478691.divmod.quotient.22625@ohm>
Message-ID: <2f5ea7490812181018x43930799g6b4c3c9d1724655e@mail.gmail.com>

> Since execCommand is already only called in the reactor thread, this
> isn't doing much - but it is slightly changing the timing of when
> things happen.  That suggests the real problem may be a race between
> different parts of your code.  It's not obvious what the race might be
> between, from reading your code, though.
>
> Jean-Paul

I might even go bit further and do something that some twisteders will
consider nasty,
and have another thread for command processing so to split between the racers.

I appreciate your comments and the time you spent to read my code and messages.

Thanks again,
  Tzury



From alecf at metaweb.com  Thu Dec 18 14:03:48 2008
From: alecf at metaweb.com (Alec Flett)
Date: Thu, 18 Dec 2008 11:03:48 -0800
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>
References: <494A5184.2040509@arimaz.com>
	<368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>
Message-ID: <C80F167C-DF92-467A-9C47-1DEDC50C72AB@metaweb.com>


On Dec 18, 2008, at 6:04 AM, Drew Smathers wrote:

> Protocol is an old-style class - doesn't inherit from object - so
> property won't work in that context.  This won't be a problem in
> python 3 - old-style/new-style classes are consolidated.
>

Is there any interest in adding 'object' to some of the core classes  
like Deferred, in a future release of Twisted? It would help with some  
debugging/logging (because there's better introspection)

As much as I'm looking forward to using Python 3, I can't imagine I'll  
be using it for any real projects that I have to deploy for at least 2  
years...

Alec


> -Drew
>
> On Thu, Dec 18, 2008 at 8:35 AM, Gabriel Rossetti
> <gabriel.rossetti at arimaz.com> wrote:
>> Hello everyone!
>>
>> I have a problem, if I try to use python property in a twisted  
>> program, it
>> doesn't really work...the accessor works but as soon as I use the  
>> mutator,
>> it no longer uses the property (and doesn't set the "real"  
>> variable. I tried
>> an example without twisted, it works, and with the twisted example it
>> doesn't... does anyone know what is going on? Thank you!
>>
>> Gabriel
>>
>> #-------------------------------------------------------------------------------------------------------
>> # This doesn't work, why????
>> #-------------------------------------------------------------------------------------------------------
>>
>> from twisted.internet.protocol import Protocol, ClientFactory
>> from sys import stdout
>>
>> class Echo(Protocol):
>>
>>  def __init__(self):
>>      self.__x = None
>>
>>  def __getx(self):
>>      return self.__x
>>    def __setx(self, value):
>>      if(value != 0):
>>          self.__x = value
>>            def __delx(self):
>>      del self.__x
>>
>>  x = property(__getx, __setx, __delx, "the doc")
>>
>>  def connectionMade(self):
>>      t = self.x
>>      assert t is None
>>      self.x = 4
>>      assert self.__x == 4
>>      t = self.x
>>      assert t == 4
>>      self.x = 0
>>      assert self.__x == 4
>>      t = self.x
>>      assert t == 4
>>        def dataReceived(self, data):
>>      stdout.write(data)
>>
>>
>> class EchoClientFactory(ClientFactory):
>>  def startedConnecting(self, connector):
>>      print 'Started to connect.'
>>
>>  def buildProtocol(self, addr):
>>      print 'Connected.'
>>      return Echo()
>>
>>  def clientConnectionLost(self, connector, reason):
>>      print 'Lost connection.  Reason:', reason
>>
>>  def clientConnectionFailed(self, connector, reason):
>>      print 'Connection failed. Reason:', reason
>>
>> if(__name__ == "__main__"):
>>    from twisted.internet import reactor
>>  reactor.connectTCP("localhost", 4444, EchoClientFactory())
>>  reactor.run()
>>
>>
>> #-------------------------------------------------------------------------------------------------------
>> # This works, as expected
>> #----------------------------------------------------------------------------------------------------
>> class C(object):
>>        def __init__(self):
>>      self._x = None
>>        def __getx(self):
>>      return self._x
>>        def __setx(self, value):
>>      if(value != 0):
>>          self._x = value
>>            def __delx(self):
>>      del self._x
>>        x = property(__getx, __setx, __delx, "The doc")
>>
>>
>> if(__name__ == "__main__"):
>>    c = C()
>>  t = c.x
>>  assert t is None
>>  c.x = 4
>>  assert c._x == 4
>>  t = c.x
>>  assert t == 4
>>  c.x = 0
>>  assert c._x == 4
>>  t = c.x
>>  assert t == 4
>>
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
>
>
> -- 
> \\\\\/\"/\\\\\\\\\\\
> \\\\/ // //\/\\\\\\\
> \\\/  \\// /\ \/\\\\
> \\/ /\/ / /\/ /\ \\\
> \/ / /\/ /\  /\\\ \\
> / /\\\  /\\\ \\\\\/\
> \/\\\\\/\\\\\/\\\\\\
>               d.p.s
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From mithrandi at mithrandi.net  Thu Dec 18 15:06:50 2008
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Thu, 18 Dec 2008 22:06:50 +0200
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <C80F167C-DF92-467A-9C47-1DEDC50C72AB@metaweb.com>
References: <494A5184.2040509@arimaz.com>
	<368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>
	<C80F167C-DF92-467A-9C47-1DEDC50C72AB@metaweb.com>
Message-ID: <20081218200650.GA353@mithrandi.net>

* Alec Flett <alecf at metaweb.com> [2008-12-18 11:03:48 -0800]:

>
> On Dec 18, 2008, at 6:04 AM, Drew Smathers wrote:
>
>> Protocol is an old-style class - doesn't inherit from object - so
>> property won't work in that context.  This won't be a problem in
>> python 3 - old-style/new-style classes are consolidated.
>>
>
> Is there any interest in adding 'object' to some of the core classes  
> like Deferred, in a future release of Twisted? It would help with some  
> debugging/logging (because there's better introspection)

The proble with doing this is that it is a backwards-incompatible change;
doing this in a way that would comply with Twisted's backwards
compatibility policy would be somewhat awkward:

http://twistedmatrix.com/trac/wiki/CompatibilityPolicy

What sort of better introspection are you talking about?
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20081218/62279a59/attachment.pgp 

From foom at fuhm.net  Thu Dec 18 17:36:14 2008
From: foom at fuhm.net (James Y Knight)
Date: Thu, 18 Dec 2008 17:36:14 -0500
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <20081218200650.GA353@mithrandi.net>
References: <494A5184.2040509@arimaz.com>
	<368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>
	<C80F167C-DF92-467A-9C47-1DEDC50C72AB@metaweb.com>
	<20081218200650.GA353@mithrandi.net>
Message-ID: <1F11034D-47D3-4A2F-B739-89B1D48B6AF1@fuhm.net>


On Dec 18, 2008, at 3:06 PM, Tristan Seligmann wrote:

> * Alec Flett <alecf at metaweb.com> [2008-12-18 11:03:48 -0800]:
>
>>
>> On Dec 18, 2008, at 6:04 AM, Drew Smathers wrote:
>>
>>> Protocol is an old-style class - doesn't inherit from object - so
>>> property won't work in that context.  This won't be a problem in
>>> python 3 - old-style/new-style classes are consolidated.
>>>
>>
>> Is there any interest in adding 'object' to some of the core classes
>> like Deferred, in a future release of Twisted? It would help with  
>> some
>> debugging/logging (because there's better introspection)
>
> The proble with doing this is that it is a backwards-incompatible  
> change;
> doing this in a way that would comply with Twisted's backwards
> compatibility policy would be somewhat awkward:
>
> http://twistedmatrix.com/trac/wiki/CompatibilityPolicy

The only way this could be done would be to do so in an "opt-in"  
fashion. E.g. something like:
import twisted
twisted.useNewStyleClasses(True)

But even that would be global for a given instantiation of the python  
interpreter which isn't really very good either if you need to mix new- 
style-expecting and old-style-expecting classes.

So it really doesn't esem worth it, given that people can mixin object  
themselves if they desire.

James



From huffman at tokyo.email.ne.jp  Thu Dec 18 20:44:49 2008
From: huffman at tokyo.email.ne.jp (Theron D. Huffman)
Date: Fri, 19 Dec 2008 10:44:49 +0900
Subject: [Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax
Message-ID: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>

I'm about to start programming a game in Python. The game will be a web-based board game with a social aspect, something like http://www.chesspark.com. I want the game to run in both browsers and as a desktop client. Therefore I'm wondering what python-based technologies I need. I know that Javascript/AJAX is necessary for the browser part so I have decided on the following:

1. Pyjamas -  (for the AJAX browser stuff)

2. Pyjamas-desktop - (for the desktop client)

3. Web2py (or djanjo, or django+pinax)  - for the website on which the game will run and for database access and social part - login, chat, members, profiles, game history, etc.)

4. Twisted - for the networking and chat functionality.

5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I don't know if Pygame is necessary for a board-type game.)

My understanding of the above technologies is still limited and I'm not sure if I need all of these because some functionality may be overlapped. e.g. I don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.

Can someone please give me some advice?

Kindest Regards,
Dan Huffman

www.WHITokyo.info  What's Happening In Tokyo podcast
www.Jindies.com  Bringing you the very best in music by Japanese independent artists!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081219/6d756fe6/attachment.htm 

From cary.hull at gmail.com  Thu Dec 18 20:57:54 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Thu, 18 Dec 2008 17:57:54 -0800
Subject: [Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax
In-Reply-To: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>
References: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>
Message-ID: <3fce0ae70812181757x8882d43lfa3d5f45ae463d6f@mail.gmail.com>

Have you looked at Nevow/Athena?
http://divmod.org/trac/wiki/DivmodNevow

-Cary

On Thu, Dec 18, 2008 at 5:44 PM, Theron D. Huffman
<huffman at tokyo.email.ne.jp> wrote:
> I'm about to start programming a game in Python. The game will be a
> web-based board game with a social aspect, something like
> http://www.chesspark.com. I want the game to run in both browsers and as a
> desktop client. Therefore I'm wondering what python-based technologies I
> need. I know that Javascript/AJAX is necessary for the browser part so I
> have decided on the following:
>
> 1. Pyjamas -  (for the AJAX browser stuff)
>
> 2. Pyjamas-desktop - (for the desktop client)
>
> 3. Web2py (or djanjo, or django+pinax)  - for the website on which the game
> will run and for database access and social part - login, chat, members,
> profiles, game history, etc.)
>
> 4. Twisted - for the networking and chat functionality.
>
> 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I
> don't know if Pygame is necessary for a board-type game.)
>
> My understanding of the above technologies is still limited and I'm not sure
> if I need all of these because some functionality may be overlapped. e.g. I
> don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
>
> Can someone please give me some advice?
>
> Kindest Regards,
> Dan Huffman
>
> www.WHITokyo.info  What's Happening In Tokyo podcast
> www.Jindies.com  Bringing you the very best in music by Japanese independent
> artists!
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From huffman at tokyo.email.ne.jp  Fri Dec 19 01:14:26 2008
From: huffman at tokyo.email.ne.jp (Theron D. Huffman)
Date: Fri, 19 Dec 2008 15:14:26 +0900
Subject: [Twisted-Python] Re: Pyjamas + web2py + twisted vs Django + Pinax
	(Cary Hull)
In-Reply-To: <E1LDUdL-0007mY-7o@cube.twistedmatrix.com>
References: <E1LDUdL-0007mY-7o@cube.twistedmatrix.com>
Message-ID: <6ABE70A3DF6D4A9AA8F6EA9A6E730561@Podcaster>

Thanks Cary,

Where would Nevow/Athena fit in my strategy? 1, 2, 3 , or 4?

Actually I have looked at Nevow/Athena and I'm very afraid of using it 
because there's only a few examples and a complete lack of documentation.

Dan

>
> Message: 7
> Date: Thu, 18 Dec 2008 17:57:54 -0800
> From: "Cary Hull" <cary.hull at gmail.com>
> Subject: Re: [Twisted-Python] Pyjamas + web2py + twisted vs Django +
> Pinax
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Message-ID:
> <3fce0ae70812181757x8882d43lfa3d5f45ae463d6f at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Have you looked at Nevow/Athena?
> http://divmod.org/trac/wiki/DivmodNevow
>
> -Cary
>
> On Thu, Dec 18, 2008 at 5:44 PM, Theron D. Huffman
> <huffman at tokyo.email.ne.jp> wrote:
>> I'm about to start programming a game in Python. The game will be a
>> web-based board game with a social aspect, something like
>> http://www.chesspark.com. I want the game to run in both browsers and as 
>> a
>> desktop client. Therefore I'm wondering what python-based technologies I
>> need. I know that Javascript/AJAX is necessary for the browser part so I
>> have decided on the following:
>>
>> 1. Pyjamas -  (for the AJAX browser stuff)
>>
>> 2. Pyjamas-desktop - (for the desktop client)
>>
>> 3. Web2py (or djanjo, or django+pinax)  - for the website on which the 
>> game
>> will run and for database access and social part - login, chat, members,
>> profiles, game history, etc.)
>>
>> 4. Twisted - for the networking and chat functionality.
>>
>> 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I
>> don't know if Pygame is necessary for a board-type game.)
>>
>> My understanding of the above technologies is still limited and I'm not 
>> sure
>> if I need all of these because some functionality may be overlapped. e.g. 
>> I
>> don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
>>
>> Can someone please give me some advice?
>>
>> Kindest Regards,
>> Dan Huffman
>>
>> www.WHITokyo.info  What's Happening In Tokyo podcast
>> www.Jindies.com  Bringing you the very best in music by Japanese 
>> independent
>> artists!
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From dripton at ripton.net  Fri Dec 19 02:47:37 2008
From: dripton at ripton.net (David Ripton)
Date: Thu, 18 Dec 2008 23:47:37 -0800
Subject: [Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax
In-Reply-To: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>
References: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>
Message-ID: <20081219074737.GA27406@vidar.dreamhost.com>

On 2008.12.19 10:44:49 +0900, Theron D. Huffman wrote:
> I'm about to start programming a game in Python. The game will be a web-based board game with a social aspect, something like http://www.chesspark.com. I want the game to run in both browsers and as a desktop client. Therefore I'm wondering what python-based technologies I need. I know that Javascript/AJAX is necessary for the browser part so I have decided on the following:
> 
> 1. Pyjamas -  (for the AJAX browser stuff)
> 
> 2. Pyjamas-desktop - (for the desktop client)
> 
> 3. Web2py (or djanjo, or django+pinax)  - for the website on which the game will run and for database access and social part - login, chat, members, profiles, game history, etc.)
> 
> 4. Twisted - for the networking and chat functionality.
> 
> 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I don't know if Pygame is necessary for a board-type game.)
> 
> My understanding of the above technologies is still limited and I'm not sure if I need all of these because some functionality may be overlapped. e.g. I don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
> 
> Can someone please give me some advice?

That's a fine laundry list of frameworks, but i believe getting all of
them to cooperate would be practically impossible.  (Note: a framework
is a library that's grown to the point where it thinks it owns your
whole program.  Getting multiple frameworks to play nicely together is
usually hard.  There are rare exceptions, like the beautiful integration
between Twisted and PyGTK, but they're rare.)

I know that Django and pygame and Twisted are useful, mature, documented
frameworks that actually get used in production by people other than
their authors.  I don't know about Pyjamas.

If putting 100% Python in one end and getting Ajax out the other is
really important to you, then you need Pyjamas to work.  (Or wait for
PyPy and its JavaScript backend to mature from experimental research
code to production-quality stuff.)  So my advice is to write a simple
tic-tac-toe game in Pyjamas, and find out.

-- 
David Ripton dripton at ripton.net



From tzury.by at gmail.com  Fri Dec 19 07:03:57 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Fri, 19 Dec 2008 14:03:57 +0200
Subject: [Twisted-Python] reactor.spawnProcess cause error fatal: The remote
	end hung up unexpectedly
Message-ID: <2f5ea7490812190403v7b8fe033p37000d9800497627@mail.gmail.com>

Hi,
I've posted about it yesterday and now after digging bit more, I am
more precise about the source of the errors I am receiving.

In short, I am willing to deploy on my server an SSH daemon which I can control
what commands can be executed, and by who.

I started with samples found on the web and at Twisted docs, and
continue from there.

I only tried to run git commands over SSH so far and the weird thing
is that it sometimes work, and sometimes not.

e.g. I type: 'git clone ssh://localhost:port/path/to/repo' I sometimes
get error, and sometimes not

at http://gist.github.com/37446 I pasted the server.py code. which is
a modification of what I've found at:
http://twistedmatrix.com/projects/conch/documentation/examples/sshsimpleserver.py

below is the console output on the client side

#first attempt
tzury at regulus:~$ git clone
ssh://tzury at localhost:5022/home/tzury/devel/ice/snoip/freespeech
clone-repo7
Initialized empty Git repository in /home/tzury/clone-repo7/.git/
remote: Counting objects: 347, done.
remote: Compressing objects: 100% (232/232), done.
Receiving objects: 100% (347/347), 91.75 KiB, done.
remote: Total 347 (delta 234), reused 177 (delta 114)
fatal: The remote end hung up unexpectedly
Resolving deltas: 100% (234/234), done.
error: waitpid (async) failed
fatal: error in sideband demultiplexer

#second attempt
tzury at regulus:~$ git clone
ssh://tzury at localhost:5022/home/tzury/devel/ice/snoip/freespeech
clone-repo7
Initialized empty Git repository in /home/tzury/clone-repo7/.git/
remote: Counting objects: 347, done.
remote: Compressing objects: 100% (232/232), done.
Receiving objects: 100% (347/347), 91.75 KiB, done.
remote: Total 347 (delta 234), reused 177 (delta 114)
Resolving deltas: 100% (234/234), done.
tzury at regulus:~$



--
Tzury Bar Yochay



-- 
Tzury Bar Yochay



From cary.hull at gmail.com  Fri Dec 19 11:04:32 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Fri, 19 Dec 2008 08:04:32 -0800
Subject: [Twisted-Python] Re: Pyjamas + web2py + twisted vs Django + Pinax
	(Cary Hull)
In-Reply-To: <6ABE70A3DF6D4A9AA8F6EA9A6E730561@Podcaster>
References: <E1LDUdL-0007mY-7o@cube.twistedmatrix.com>
	<6ABE70A3DF6D4A9AA8F6EA9A6E730561@Podcaster>
Message-ID: <3fce0ae70812190804u1aa6488aqc98754d23a9207bb@mail.gmail.com>

It would work for your 1, 3, and 4. There's a bit of documentation for both.
Athena is not a gui toolkit, however. It provides a nice bidirectional
rpc mechanism
between Nevow server and browser js.

Pyjamas desktop is just a wrapper to create a standalone packaging of
app resources with webkit.

I suppose that you don't want to get your hands dirty with js/dom.
It may be possible to hook the Pyjamas UI stuff to Athena, dunno.

Interesting article:
http://ejohn.org/blog/javascript-language-abstractions/

On Thu, Dec 18, 2008 at 10:14 PM, Theron D. Huffman
<huffman at tokyo.email.ne.jp> wrote:
> Thanks Cary,
>
> Where would Nevow/Athena fit in my strategy? 1, 2, 3 , or 4?
>
> Actually I have looked at Nevow/Athena and I'm very afraid of using it
> because there's only a few examples and a complete lack of documentation.
>
> Dan
>
>>
>> Message: 7
>> Date: Thu, 18 Dec 2008 17:57:54 -0800
>> From: "Cary Hull" <cary.hull at gmail.com>
>> Subject: Re: [Twisted-Python] Pyjamas + web2py + twisted vs Django +
>> Pinax
>> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
>> Message-ID:
>> <3fce0ae70812181757x8882d43lfa3d5f45ae463d6f at mail.gmail.com>
>> Content-Type: text/plain; charset=ISO-8859-1
>>
>> Have you looked at Nevow/Athena?
>> http://divmod.org/trac/wiki/DivmodNevow
>>
>> -Cary
>>
>> On Thu, Dec 18, 2008 at 5:44 PM, Theron D. Huffman
>> <huffman at tokyo.email.ne.jp> wrote:
>>>
>>> I'm about to start programming a game in Python. The game will be a
>>> web-based board game with a social aspect, something like
>>> http://www.chesspark.com. I want the game to run in both browsers and as
>>> a
>>> desktop client. Therefore I'm wondering what python-based technologies I
>>> need. I know that Javascript/AJAX is necessary for the browser part so I
>>> have decided on the following:
>>>
>>> 1. Pyjamas -  (for the AJAX browser stuff)
>>>
>>> 2. Pyjamas-desktop - (for the desktop client)
>>>
>>> 3. Web2py (or djanjo, or django+pinax)  - for the website on which the
>>> game
>>> will run and for database access and social part - login, chat, members,
>>> profiles, game history, etc.)
>>>
>>> 4. Twisted - for the networking and chat functionality.
>>>
>>> 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I
>>> don't know if Pygame is necessary for a board-type game.)
>>>
>>> My understanding of the above technologies is still limited and I'm not
>>> sure
>>> if I need all of these because some functionality may be overlapped. e.g.
>>> I
>>> don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
>>>
>>> Can someone please give me some advice?
>>>
>>> Kindest Regards,
>>> Dan Huffman
>>>
>>> www.WHITokyo.info  What's Happening In Tokyo podcast
>>> www.Jindies.com  Bringing you the very best in music by Japanese
>>> independent
>>> artists!
>>> _______________________________________________
>>> Twisted-Python mailing list
>>> Twisted-Python at twistedmatrix.com
>>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
01100011 01100001 01110010 01111001



From dripton at ripton.net  Fri Dec 19 14:38:32 2008
From: dripton at ripton.net (David Ripton)
Date: Fri, 19 Dec 2008 11:38:32 -0800
Subject: [Twisted-Python] Two thumbs up for inotify.py
Message-ID: <20081219193832.GA16950@vidar.dreamhost.com>

I just tried the latest inotify.py from dialtone's sandbox, and I like
it.  

My application is a little PyGTK / Cairo recording data scope (closed
source) that needs to read lots of little files and plot lots of data
points in realtime.

I have my own inotify/ctypes wrapper (at the time I wrote it I found two
Python inotify wrappers; one was GPL and the other didn't work for me)
which works okay in this application.  But it's a bit gross because my
call to see if there are any inotify events is blocking (with a very
short timeout), rather than truly event-based.

To try inotify.py, I Twistified my code (easy because it was already
event-driven PyGTK), then changed all the inotify calls to use the
sandbox module's API rather than mine.  The only thing I disliked about
the API was having to pass the callbacks are to the watch method, rather
than the watch method returning a Deferred that I could addCallback on,
but that's just different, not actually hard or confusing.

Anyway, it works and my code is a bit smaller and cleaner than it was
before and uses a tad less CPU.  I hope this ends up in a Twisted
release.  I see #972 in the tracker, but it's been untouched for a
long time.  Should I comment there?

Thanks.

-- 
David Ripton    dripton at ripton.net



From dr.marc.byrd at gmail.com  Fri Dec 19 14:38:35 2008
From: dr.marc.byrd at gmail.com (Marc Byrd)
Date: Fri, 19 Dec 2008 11:38:35 -0800
Subject: [Twisted-Python] Mysql proxy in twisted ?
Message-ID: <a33934630812191138g1dbc8c9g41d98c8b395d19ca@mail.gmail.com>

Hi,

I was thinking of building a mysql proxy in twisted, wonder if there is
already such a thing (not found on first coupla pages of google search), and
if not, thoughts about building one.

[BTW, I'm quite familiar with mysql-proxy - not thrilled w/ LUA
scripting...]

If anyone is interested in helping, I'm definitely thinking open source.

Thanks,


Marc
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081219/15da9a0f/attachment.htm 

From dialtone at gmail.com  Fri Dec 19 15:10:42 2008
From: dialtone at gmail.com (Valentino Volonghi)
Date: Fri, 19 Dec 2008 12:10:42 -0800
Subject: [Twisted-Python] Two thumbs up for inotify.py
In-Reply-To: <20081219193832.GA16950@vidar.dreamhost.com>
References: <20081219193832.GA16950@vidar.dreamhost.com>
Message-ID: <9B36E4D8-A998-4D1A-9D1F-F1FC3473BA29@gmail.com>


On Dec 19, 2008, at 11:38 AM, David Ripton wrote:

> To try inotify.py, I Twistified my code (easy because it was already
> event-driven PyGTK), then changed all the inotify calls to use the
> sandbox module's API rather than mine.  The only thing I disliked  
> about
> the API was having to pass the callbacks are to the watch method,  
> rather
> than the watch method returning a Deferred that I could addCallback  
> on,
> but that's just different, not actually hard or confusing.

That pisses me off too... The problem with the API you suggest is that  
it's
a one shot API and you should keep adding those callbacks and call
watch which is not doable here... I'm open to suggestions to change it  
even
with a custom Protocol class (Which probably would fit better in Twisted
maybe but that's more cumbersome than adding the callbacks IMHO).

> Anyway, it works and my code is a bit smaller and cleaner than it was
> before and uses a tad less CPU.  I hope this ends up in a Twisted
> release.  I see #972 in the tracker, but it's been untouched for a
> long time.  Should I comment there?


You probably should (and also add me in the CC list), then I'll take
care of the reviews that will come in, I should also find the time to
setup a twisted branch with ampoule inside.

-- 
Valentino Volonghi aka Dialtone
Now running MacOS X 10.5
Home Page: http://www.twisted.it
http://www.adroll.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081219/bddc3792/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20081219/bddc3792/attachment.pgp 

From joe at strout.net  Sat Dec 20 09:10:53 2008
From: joe at strout.net (Joe Strout)
Date: Sat, 20 Dec 2008 07:10:53 -0700
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
Message-ID: <494CFCED.9080701@strout.net>

I'm trying to make a simple AIM bot that, in addition to responding when 
I talk to it, can also send me a message on its own initiative.  My code 
is based on SkippyTalkBot [1], but I confess that I don't understand it 
very well, and though I've been crawling the Twisted documentation for a 
few days now, it's still rather mysterious to me.

So I'm at a loss as to how to add an "idle" function that will allow my 
bot to periodically see whether it has something new to say to the user. 
  My code looks like this:

class B(oscar.BOSConnection):
     capabilities = [oscar.CAP_CHAT]

...

     def receiveMessage(self, user, multiparts, flags):
	"respond to an incoming message from the user"
	# (by calling self.sendMessage)

...

class OA(oscar.OscarAuthenticator):
    BOSClass = B

protocol.ClientCreator(reactor, OA, SN, PASS, 
icq=icqMode).connectTCP(*hostport)
reactor.run()


Now, from trawling the docs, I guess that I want to call 
reactor.callWhenRunning... but then I'd like to pass in a bound method 
of my B class, so it can call sendMessage on myself.  But I'm stumped as 
to how my B class is even being instantiated, let alone how to get a 
reference to that instance.  And the callWhenRunning idea is only a wild 
guess and probably wrong.

I'm sure the answer is in the Twisted docs or examples somewhere, but I 
haven't been able to find it.  Will someone have pity and share a clue?

Thanks,
- Joe


[1] http://www.gilesgoatboy.org/python/skippy.html




From exarkun at divmod.com  Sat Dec 20 09:28:07 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 20 Dec 2008 09:28:07 -0500
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
In-Reply-To: <494CFCED.9080701@strout.net>
Message-ID: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>

On Sat, 20 Dec 2008 07:10:53 -0700, Joe Strout <joe at strout.net> wrote:
>I'm trying to make a simple AIM bot that, in addition to responding when I 
>talk to it, can also send me a message on its own initiative.  My code is 
>based on SkippyTalkBot [1], but I confess that I don't understand it very 
>well, and though I've been crawling the Twisted documentation for a few days 
>now, it's still rather mysterious to me.
>
>So I'm at a loss as to how to add an "idle" function that will allow my bot 
>to periodically see whether it has something new to say to the user.

While this sometimes makes sense, it's usually *not* the approach you want
to take.  You're describing a solution which is essentially polling.  And
polling is not as good as responding to events.  You *could* run a function
ten times a second that looks around for a message to send and sends it if
it finds one.  Or, whatever event occurs which creates those messages could
just send the message instead of putting it in a pile and waiting for your
poller to find it.

I can't tell you how to do this in detail, though, since I don't know what
causes you to have messages to send.

> [snip]
>
>Now, from trawling the docs, I guess that I want to call 
>reactor.callWhenRunning...

Probably not.  If you want to run a function later (and that's how polling
is generally implemented), you want reactor.callLater.  If you want to run
a function repeatedly at a fixed interval, twisted.internet.task.LoopingCall
will help.

>but then I'd like to pass in a bound method of my 
>B class, so it can call sendMessage on myself.  But I'm stumped as to how my 
>B class is even being instantiated, let alone how to get a reference to that 
>instance.  And the callWhenRunning idea is only a wild guess and probably 
>wrong.

You'll probably encounter the same problem with reactor.callLater as you
were encountering with reactor.callWhenRunning, though.  How do you get
a reference to the bound method to pass in?  That's simple - don't call
the reactor method until you *have* an instance.  You can call almost any
reactor method even *after* the reactor is started; you do not have to set
everything up before you call reactor.run.

You can read more about reactor.callLater in the scheduling howto:

 http://twistedmatrix.com/projects/core/documentation/howto/time.html

Jean-Paul



From joe at strout.net  Sat Dec 20 10:28:20 2008
From: joe at strout.net (Joe Strout)
Date: Sat, 20 Dec 2008 08:28:20 -0700
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
In-Reply-To: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>
References: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>
Message-ID: <494D0F14.3000105@strout.net>

Jean-Paul Calderone wrote:

>> So I'm at a loss as to how to add an "idle" function that will allow 
>> my bot to periodically see whether it has something new to say to the 
>> user.
> 
> While this sometimes makes sense, it's usually *not* the approach you want
> to take.  You're describing a solution which is essentially polling.  And
> polling is not as good as responding to events.  You *could* run a function
> ten times a second that looks around for a message to send and sends it if
> it finds one.  Or, whatever event occurs which creates those messages could
> just send the message instead of putting it in a pile and waiting for your
> poller to find it.

Well, the thing is that there will actually be a great many things that 
could cause it to need to send a message, such as the time, a change in 
the outside temperature, a certain change in the value of a stock fund, 
etc.  And the AIM interface isn't the only interface to this bot.  So I 
really do think I need a way to call a function once every few seconds.

Now, that does suggest an alternative approach, which is to ignore 
twisted's event/idle mechanisms and use something external to it.  But 
I'm also fairly newish to Python, so I'm not sure exactly how to do that 
either -- reactor.run() is a blocking call, so I supposed I'd have to 
use threads.  Then my "idler thread" could call the idle function, sleep 
for a few seconds, and repeat.

But if there's a simple way to do this within Twisted, I'd like to learn 
what that is
.
>> Now, from trawling the docs, I guess that I want to call 
>> reactor.callWhenRunning...
> 
> Probably not.  If you want to run a function later (and that's how polling
> is generally implemented), you want reactor.callLater.  If you want to run
> a function repeatedly at a fixed interval, 
> twisted.internet.task.LoopingCall will help.

Thanks, I'll look at these.

> You'll probably encounter the same problem with reactor.callLater as you
> were encountering with reactor.callWhenRunning, though.  How do you get
> a reference to the bound method to pass in?  That's simple - don't call
> the reactor method until you *have* an instance.  You can call almost any
> reactor method even *after* the reactor is started; you do not have to set
> everything up before you call reactor.run.

OK, so somewhere within my B class, maybe in initDone, set it up there? 
    That makes sense.

Thanks,
- Joe




From radix at twistedmatrix.com  Sat Dec 20 11:35:56 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 20 Dec 2008 11:35:56 -0500
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
In-Reply-To: <494D0F14.3000105@strout.net>
References: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>
	<494D0F14.3000105@strout.net>
Message-ID: <60ed19d40812200835v494b5ad3gd9a703ffe7cf1d0b@mail.gmail.com>

On Sat, Dec 20, 2008 at 10:28 AM, Joe Strout <joe at strout.net> wrote:
> Jean-Paul Calderone wrote:
>
>>> So I'm at a loss as to how to add an "idle" function that will allow my
>>> bot to periodically see whether it has something new to say to the user.
>>
>> While this sometimes makes sense, it's usually *not* the approach you want
>> to take.  You're describing a solution which is essentially polling.  And
>> polling is not as good as responding to events.  You *could* run a
>> function
>> ten times a second that looks around for a message to send and sends it if
>> it finds one.  Or, whatever event occurs which creates those messages
>> could
>> just send the message instead of putting it in a pile and waiting for your
>> poller to find it.
>
> Well, the thing is that there will actually be a great many things that
> could cause it to need to send a message, such as the time, a change in the
> outside temperature, a certain change in the value of a stock fund, etc.
>  And the AIM interface isn't the only interface to this bot.  So I really do
> think I need a way to call a function once every few seconds.

Just because you have a number of sources doesn't mean you
intrinsically can't use them in an efficient, event-oriented manner.
And you don't need a time-based call *just* because you have more than
one interface to the bot.

A timed poll may end up the easiest solution for you, but I want to
make sure you understand the way events work, because there may be a
much better solution. Let's go over your example event sources:

Time - Easy: your event source there is reactor.callLater itself.
Change in the temperature - How does your thermostat communicate this
information? A serial connection? a TCP socket? in any case, you can
probably hook up to that event source with Twisted directly.
Stock price - same question.

The point is that you can hook into these event sources with some code
that will immediately send the message out over your AIM (or IRC, or
whatever other) interface to the bot. That means communication will be
instantaneous *and* efficient.

-- 
Christopher Armstrong
http://radix.twistedmatrix.com/
http://planet-if.com/
http://canonical.com/



From joe at strout.net  Sat Dec 20 14:26:48 2008
From: joe at strout.net (Joe Strout)
Date: Sat, 20 Dec 2008 12:26:48 -0700
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
In-Reply-To: <60ed19d40812200835v494b5ad3gd9a703ffe7cf1d0b@mail.gmail.com>
References: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>	<494D0F14.3000105@strout.net>
	<60ed19d40812200835v494b5ad3gd9a703ffe7cf1d0b@mail.gmail.com>
Message-ID: <494D46F8.7070105@strout.net>

Christopher Armstrong wrote:

> Just because you have a number of sources doesn't mean you
> intrinsically can't use them in an efficient, event-oriented manner.

No, but when these "sources" as you call them are external data sources 
that I have to periodically check (have to -- there is no way to make 
these external contact my app when something changes), that is 
inherently a polling situation.

> And you don't need a time-based call *just* because you have more than
> one interface to the bot.

True; that just makes it easier.

> Change in the temperature - How does your thermostat communicate this
> information?

I'm accessing a web service.

> Stock price - same question.

Same answer.  These services give you an answer when you ask for them; 
they don't come to you when a value changes.

Anyway, I think I have the answer I need 
(twisted.internet.task.LoopingCall), and I thank you all for it.


Best,
- Joe




From manlio_perillo at libero.it  Sat Dec 20 16:37:16 2008
From: manlio_perillo at libero.it (Manlio Perillo)
Date: Sat, 20 Dec 2008 22:37:16 +0100
Subject: [Twisted-Python] Mysql proxy in twisted ?
In-Reply-To: <a33934630812191138g1dbc8c9g41d98c8b395d19ca@mail.gmail.com>
References: <a33934630812191138g1dbc8c9g41d98c8b395d19ca@mail.gmail.com>
Message-ID: <494D658C.5040401@libero.it>

Marc Byrd ha scritto:
> Hi,
> 
> I was thinking of building a mysql proxy in twisted, wonder if there is 
> already such a thing (not found on first coupla pages of google search), 
> and if not, thoughts about building one.
> 

After having written a PostgreSQL client in Twisted:
http://hg.mperillo.ath.cx/twisted/pglib/

I have tried to implement a MySQL client, but the MySQL protocol is 
*really* bad designed.

 > [...]


Regards  Manlio Perillo



From andrewfr_ice at yahoo.com  Sat Dec 20 17:13:01 2008
From: andrewfr_ice at yahoo.com (Andrew Francis)
Date: Sat, 20 Dec 2008 14:13:01 -0800 (PST)
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
Message-ID: <216266.16154.qm@web34205.mail.mud.yahoo.com>

Message: 6
Date: Sat, 20 Dec 2008 08:28:20 -0700
From: Joe Strout <joe at strout.net>
Subject: Re: [Twisted-Python] how to get an idle callback while
    running a    reactor?
To: Twisted general discussion <twisted-python at twistedmatrix.com>
Message-ID: <494D0F14.3000105 at strout.net>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi Joe:

>Well, the thing is that there will actually be a great many things that
>could cause it to need to send a message, such as the time, a change in
>the outside temperature, a certain change in the value of a stock fund,
>etc.  And the AIM interface isn't the only interface to this bot. 

I would argue all these things can be viewed external events - even time (imagine a clock source is calling your system every N time units). In turn, your programme reacts to the external events.  

At a more concrete level, you have to ask yourself questions like "is my programme a client, a server (or both)? That is, is my programme making connections? Or is it waiting for connections? This will affect how you structure and start-up your application. From I see SkippyTalkBot is a client.

>Now, that does suggest an alternative approach, which is to ignore
>twisted's event/idle mechanisms and use something external to it.  But
>I'm also fairly newish to Python, so I'm not sure exactly how to do that
>either -- reactor.run() is a blocking call, so I supposed I'd have to
>use threads.

Yes under the hood reactor.run() blocks. However the reactor is what effectively starts a Twisted application. I would argue that under most circumstances, you probably don't care that the reactor blocks because your application isn't doing anything until it receives an event from the reactor. As for threads. Off hand, I suspect you don't need threads .....

>But if there's a simple way to do this within Twisted, I'd like to learn
>what that is

Let us pretend your programme polls various network sources at regular intervals. So perhaps your code could look like:

if __name__ == "__main__":
   # it may be helpful to keep track of the task objects
   source['source-a] = task.LoopingCall(callback-for-stockTicker, ...)
   source['source-b] = task.loopingCall(callback-for-thermostat, ...)
   source['source-c] = task.loopingCall(callback-for-timer, ....)

   for source in sources:
       source.start(someInterval, True | False)
   reactor.run()

and each callback-for-X sets up the appropriate call to the remove source and its callback chain.

# assume we are using SOAP
def callback-for-stockTicker():
    ticker = soap.Proxy(....)
    ticker.callRemote(....).addCallback().addErrback()


Cheers,
Andrew










      



From exarkun at twistedmatrix.com  Sun Dec 21 00:05:10 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 21 Dec 2008 05:05:10 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1229835910.03.349833342@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081221/6ee6ff17/attachment.htm 

From glyph at divmod.com  Sun Dec 21 02:51:14 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Sun, 21 Dec 2008 07:51:14 -0000
Subject: [Twisted-Python] Weekly Bug Summary
In-Reply-To: 1229835910.03.349833342@twistedmatrix.com
References: 1229835910.03.349833342@twistedmatrix.com
Message-ID: <20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>


On 05:05 am, exarkun at twistedmatrix.com wrote:
>Bugs opened: 12    Bugs closed: 13  Total open bugs: 1055 (-1)
                                                           ^^^^

Every week I see this number is negative (even if only a little) I do a 
little victory dance.

I think we should have a party when we get to <1000 total open bugs. 
Anybody else interested?



From glyph at divmod.com  Sun Dec 21 03:20:32 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Sun, 21 Dec 2008 08:20:32 -0000
Subject: [Twisted-Python] What to do when a service fails to start, also, 
	deferred and startService
In-Reply-To: <18736.4217.759501.381840@jon.es>
References: <18734.54780.97710.644648@jon.es>
	<20081128140217.12555.360367893.divmod.xquotient.628@weber.divmod.com>
	<18736.4217.759501.381840@jon.es>
Message-ID: <20081221082032.12555.570369233.divmod.xquotient.2379@weber.divmod.com>


On 28 Nov, 03:38 pm, terry at jon.es wrote:
>Hi Glyph
>
>Thanks for the detailed reply.

No problem, sorry it took so long to get back to this; I definitely left 
the conversation halfway through.
>>>>>>"glyph" == glyph  <glyph at divmod.com> writes:
>glyph> On 27 Nov, 05:16 pm, terry at jon.es wrote:

>glyph> The key question here is: indicate to whom?  If you want to 
>indicate
>glyph> it to some other object, well, try:except: or addErrback and 
>call a
>glyph> method on that object.  Nothing magic about it.
>
>I have code written as a Twisted plugin. So I have a class implementing
>IServiceMaker and IPlugin, and I create an instance of that class which
>gets found when I invoke twistd from the command line.
>
>So in my case I want to indicate to twistd that the service that my 
>class
>creates a makeService method to create, but which I do not set in 
>motion,
>has failed to start and that twistd should exit, or do something other 
>than
>cheerfully tell me that there's been an Unhandled Error.

>Does that make more sense? Sorry, I should have said I was using 
>twistd.

Yes.  And I think that this is a good use-case for making IService a bit 
deeper than it is.  twistd (and, one day, other tools that might be able 
to start IService objects) potentially needs some more information so it 
can make a more intelligent high-level decision about what to do next.

My previous messages were basically saying "you can't do what you want 
with IService".  i.e. you can't write your own code to do something 
clever and somehow have dependencies and notifications to users of 
"twistd" fall out of that.  But that shouldn't be taken as an indication 
that twistd itself shouldn't be improved.

For reasons I brought up in previous messages, exiting is not always the 
right thing to do.  But in some cases (*none* of the services on offer 
were able to start up, for example) it might be.
>I'm not sure what should happen. I'm sitting at the command line, I've
>asked twistd to start something for me, there's clearly been a problem
>doing so (and this doesn't have to be baroque, maybe I just couldn't 
>listen
>on a specific port I wanted, or maybe my code somehow raised an 
>Exception),
>but I don't seem to have a mechanism for having twistd take any notice 
>at
>all.

Keep in mind that you may be sitting on the other end of a blackberry 
which needs to get an email when 'twistd' fails to start up after a 
server reboot - you're not necessarily at a command line.  One of the 
reasons that no mechanism has yet evolved for propagating interesting 
status messages about services is that there's no obvious channel for 
those messages to be communicated to.
>In the case of a service being started by twistd, it doesn't seem as 
>simple
>as you describe, but maybe that's my lack of understanding again.
>I can easily subclass IService, but something else is calling the 
>startService
>method of that subclass. And that thing, whatever it is, is not 
>expecting
>me to return a deferred. So if my startService has for some reason got 
>its
>hands on a deferred, it can't simply hand it back to its caller and 
>have
>something (twistd in my case) see that an error occurred.

>It does feel like I have to track down what this something else might
>be.

It's not that you've failed to understand something - you have correctly 
identified that there is nothing to understand :).  You need to go find 
that thing ("whatever it is" ;-)) in twistd that's invoking the very 
first call to IService.startService (and privilegedStartService as well) 
and propose a concrete way to make it smarter.

(I've elided your exploration of twisted code, but you're basically 
looking in the right direction.)
>So should I write my own twistd?

No way, man, it's open source!  Not writing your own is the whole point! 
Open a ticket, write a patch.  If you're not really sure what the patch 
should do, we can continue this discussion about reporting startup 
errors and service dependencies here.  This poorly-specified ticket 
indicates that other developers have had similar problems in the past: 
http://twistedmatrix.com/trac/ticket/1572
>All this doesn't seem to be a matter of
>simple subclassing. Plus, I can't just go in and start editing the
>top-level functions in twisted/application/app.py and
>twisted/scripts/_twistd_unix.py or code that imports app, etc.

Sure you can.  Then, you take the results of running 'svn diff' on the 
copy of Twisted where you did that, and... :)
>Sorry for so many questions - I really don't know if I'm missing 
>something
>simple here. I do enjoy digging into all this, and I appreciate your
>apparently limitless patience. I wish I knew it all better. Twisted is
>complex and it's a pretty good bet that anything you think of or run 
>into
>as a n00b has been thought of or encountered before, and that whatever 
>way
>you think of to solve it will probably be non-optimal, or plain wrong, 
>or
>in ignorance of a solution someone much more experienced has already
>implemented, or... etc.  Hence my many questions.

Unfortunately it's equally likely that it's come up a million times and 
a half dozen people know it's an unresolved issue but it's never been 
filed as a ticket and never been clearly framed as a specific problem 
rather than a vague architectural queasiness.  The value of a good 
ticket should not be underestimated.
>In fact I have something like a process pool running in one service and 
>I
>talk to it from another machine. I say "hey, process pool, start me up 
>the
>following service (a twistd service)" and I would then like to know if 
>that
>service started, and if not then why not. So having twistd fail or 
>report
>an error if it can't start a service would be useful.

Quite so.  But, this is a great example of how this is a use-case beyond 
twistd's current capabilities, but not out of the scope of its eventual 
ambition.  It isn't currently designed to manage processes on remote 
machines.  Maybe ampoule has something which does?  I don't know, that's 
a tricky area which requires a lot of thought beyond this one feature.
>glyph> Doing either of those things would definitely be wrong.  There's 
>no
>glyph> reason to sys.exit or reactor.stop if your application can't 
>start
>glyph> up, unless your management system specifically calls for such a
>glyph> thing.
>
>Maybe this is a case where it's (semi-)justified. At least if I called
>sys.exit the twistd process would go away, instead of sitting there 
>acting
>as though nothing's wrong :-) I can also, of course, try interacting 
>with
>the service I think I just started on the remote machine, and if I 
>can't
>then I can tell the original process pool to kill the twistd process. 
>But
>that seems a pretty roundabout alternative to just having twistd notice
>that something went awry when calling startService.

It may be worthwhile, before writing a patch, to devise your *own* 
error-reporting channel on top of twistd.  For example, a dedicated 
error-report-processing server listening on a dedicated port.  Then you 
can specify your own enhanced-IService interface that handles 
dependencies and deferreds and whatever else you need, and an adapter to 
hooks it up to twistd via IService but reports errors to your external 
error-reporting channel.  Once you're sure that design works, it should 
be straightforward to change the implementation of twistd to honor your 
expanded interface, and provide an alternate implementation of the 
error-reporting channel.
>glyph> In the future, even the Twisted plugin code might be starting 
>some
>glyph> things in addition to your application.  As I mentioned above, a
>glyph> good reason to do that is to perform diagnostics on failed 
>startups
>glyph> :).
>
>I assume you really mean "startups" and not "services". In which case, 
>I'm
>100% sure there's something funny here, but I can't figure it out. I'd 
>love
>to know, and I'm smiling broadly in any case. Too bad email loses so 
>much
>humor.....  we can always try though.

By "startups" I simply meant "attempts to start-up a service" i.e. calls 
to startService.  I'm sure there is a truckload of subtle and completely 
unintentional humor in there somewhere though.



From andrew-twisted at puzzling.org  Sun Dec 21 04:19:50 2008
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 21 Dec 2008 20:19:50 +1100
Subject: [Twisted-Python] Weekly Bug Summary
In-Reply-To: <20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>
References: <20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>
Message-ID: <20081221091950.GB32606@steerpike.home.puzzling.org>

glyph at divmod.com wrote:
>
> On 05:05 am, exarkun at twistedmatrix.com wrote:
>> Bugs opened: 12    Bugs closed: 13  Total open bugs: 1055 (-1)
>                                                           ^^^^
>
> Every week I see this number is negative (even if only a little) I do a  
> little victory dance.
>
> I think we should have a party when we get to <1000 total open bugs.  
> Anybody else interested?

File a ticket to have a party, so you don't forget ;)

-Andrew.




From lists at collab.nl  Sun Dec 21 12:53:38 2008
From: lists at collab.nl (Thijs Triemstra | Collab)
Date: Sun, 21 Dec 2008 17:53:38 +0000
Subject: [Twisted-Python] Weekly Bug Summary
In-Reply-To: <20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>
References: 1229835910.03.349833342@twistedmatrix.com
	<20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>
Message-ID: <35BD87CA-8439-48DB-B171-3B32943F5D4D@collab.nl>

On 21 Dec 2008, at 07:51, glyph at divmod.com wrote:
>
> On 05:05 am, exarkun at twistedmatrix.com wrote:
>> Bugs opened: 12    Bugs closed: 13  Total open bugs: 1055 (-1)
>                                                          ^^^^
>
> Every week I see this number is negative (even if only a little) I  
> do a little victory dance.
>
> I think we should have a party when we get to <1000 total open bugs.  
> Anybody else interested?

Definitely! I'm in London nowadays, and I guess most of you are in the  
US but always up for a party.  :)

Cheers,

Thijs

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081221/9931696e/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20081221/9931696e/attachment.pgp 

From fetbiz at gmail.com  Mon Dec 22 03:48:18 2008
From: fetbiz at gmail.com (biziap biziap)
Date: Mon, 22 Dec 2008 16:48:18 +0800
Subject: [Twisted-Python] How is happened?
Message-ID: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>

I am trying to migrate to web2. And find the "OldRequestAdapter".
What I did is callling:

## in a resource of web2
def render(self,web2_request):
    request = twisted.web2.compat.makeOldRequestAdapter(web2_request)



  File "c:\python25\Lib\site-packages\twisted\web2\compat.py", line 336, in
getSession
    cookiename = string.join(['TWISTED_SESSION'] + self.sitepath, "_")
AttributeError: 'OldRequestAdapter' object has no attribute 'sitepath'
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081222/f3e9fde5/attachment.htm 

From fetbiz at gmail.com  Mon Dec 22 03:50:14 2008
From: fetbiz at gmail.com (biziap biziap)
Date: Mon, 22 Dec 2008 16:50:14 +0800
Subject: [Twisted-Python] Re: How is happened?
In-Reply-To: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>
References: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>
Message-ID: <d067ddcf0812220050n176cdf38i467670dd240b9f7c@mail.gmail.com>

2008/12/22 biziap biziap <fetbiz at gmail.com>

> I am trying to migrate to web2. And find the "OldRequestAdapter".
> What I did is callling:
>
> ## in a resource of web2
> def render(self,web2_request):
>     request = twisted.web2.compat.makeOldRequestAdapter(web2_request)
>     ...
>
       request.getSession()

>
>  then the exception was thrown:
>
>   File "c:\python25\Lib\site-packages\twisted\web2\compat.py", line 336, in
> getSession
>     cookiename = string.join(['TWISTED_SESSION'] + self.sitepath, "_")
> AttributeError: 'OldRequestAdapter' object has no attribute 'sitepath'
>

Any hints are appericated.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081222/4dec3a7f/attachment.htm 

From p.mayers at imperial.ac.uk  Mon Dec 22 06:33:30 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 22 Dec 2008 11:33:30 +0000
Subject: [Twisted-Python] Re: How is happened?
In-Reply-To: <d067ddcf0812220050n176cdf38i467670dd240b9f7c@mail.gmail.com>
References: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>
	<d067ddcf0812220050n176cdf38i467670dd240b9f7c@mail.gmail.com>
Message-ID: <494F7B0A.4020800@imperial.ac.uk>

biziap biziap wrote:
> 
> 
> 2008/12/22 biziap biziap <fetbiz at gmail.com <mailto:fetbiz at gmail.com>>
> 
>     I am trying to migrate to web2. And find the "OldRequestAdapter".
>     What I did is callling:
>      
> 
> Any hints are appericated.
> 

  1. Ask on the twisted-web list
  2. Don't use web2: http://twistedmatrix.com/trac/wiki/TwistedWebPlan



From tzury.by at gmail.com  Mon Dec 22 08:45:56 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Mon, 22 Dec 2008 15:45:56 +0200
Subject: [Twisted-Python] 
	twisted.conch.ssh.session.SSHSession.request_subsystem
Message-ID: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>

Hi all,

I've managed to come up with a minimal sftp server implementation
which able to auth users using rsa_key

the code is available at: http://gist.github.com/37446

The point is that I am missing the knowledge needed in order to add
path control.
That is, controlling which path(s) a user can access.

at http://twisted.conch.ssh.session.SSHSession.html#request_subsystem
it appears to be undocumented

Would love to get some references, samples, etc.

Thanks in advance,
 Tzury



From glyph at divmod.com  Mon Dec 22 10:38:59 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Mon, 22 Dec 2008 15:38:59 -0000
Subject: [Twisted-Python]
	twisted.conch.ssh.session.SSHSession.request_subsystem
In-Reply-To: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
References: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
Message-ID: <20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>

On 01:45 pm, tzury.by at gmail.com wrote:
>the code is available at: http://gist.github.com/37446
>
>The point is that I am missing the knowledge needed in order to add
>path control.
>That is, controlling which path(s) a user can access.

UnixSSHRealm is a realm which returns SSH avatars that, like OpenSSH, 
can run arbitrary shell commands as the given UNIX user.

The way you control which paths a user can access in this scenario is by 
setting the filesystem permissions on those directories.  Sorry, but 
Twisted cannot magically change your UNIX filesystem so that arbitrary 
commands see a different view of it.

If you want to write an SSH application server that does *not* allow 
running UNIX commands, you are going to have to write a lot more code; 
in effect, emulating a shell (or denying access to one entirely, as 
described in http://cyli.livejournal.com/38382.html )
>at http://twisted.conch.ssh.session.SSHSession.html#request_subsystem
>it appears to be undocumented

This code could definitely be better documented, but I don't think your 
question is related to subsystems.  In order to see why, it would be 
helpful for you to understand http://www.ietf.org/rfc/rfc4254.txt 
section 6.5, "starting a shell or command", first.  (A subsystem is just 
a kind of command you can run.)



From drew.smathers at gmail.com  Mon Dec 22 12:27:55 2008
From: drew.smathers at gmail.com (Drew Smathers)
Date: Mon, 22 Dec 2008 12:27:55 -0500
Subject: [Twisted-Python] Re: How is happened?
In-Reply-To: <494F7B0A.4020800@imperial.ac.uk>
References: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>
	<d067ddcf0812220050n176cdf38i467670dd240b9f7c@mail.gmail.com>
	<494F7B0A.4020800@imperial.ac.uk>
Message-ID: <368574aa0812220927u78f795c7u7d2be1782af1156c@mail.gmail.com>

On Mon, Dec 22, 2008 at 6:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:
> biziap biziap wrote:
>>
>>
>> 2008/12/22 biziap biziap <fetbiz at gmail.com <mailto:fetbiz at gmail.com>>
>>
>>    I am trying to migrate to web2. And find the "OldRequestAdapter".
>>    What I did is callling:
>>
>> Any hints are appericated.
>>
>
>  1. Ask on the twisted-web list
>  2. Don't use web2: http://twistedmatrix.com/trac/wiki/TwistedWebPlan
>

<facetious>
I think at this point twisted.web2 should be renamed
twisted.web2pleasedontusethis.
</facetious>

-Drew



From tzury.by at gmail.com  Mon Dec 22 14:10:23 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Mon, 22 Dec 2008 21:10:23 +0200
Subject: [Twisted-Python]
	twisted.conch.ssh.session.SSHSession.request_subsystem
In-Reply-To: <20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>
References: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
	<20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>
Message-ID: <2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>

Glyph, thanks for your attention and time. I am afraid I was not clear
wit hmy question so please allow me to elaborate.

> The way you control which paths a user can access in this scenario is by
> setting the filesystem permissions on those directories.  Sorry, but Twisted
> cannot magically change your UNIX filesystem so that arbitrary commands see
> a different view of it.

I don't want to create a UNIX user per client. I want to design the
system in a way that all the clients will access using one single
'public' account.
In fact, each client is already pushing its files to it associated
'home' folder.
However, I want to be able to control it in case someone is hacking
with the system, so to ensure it cannot access any other paths but the
one which is associated with its rsa_key

I've investigated jailkit and gitosis and other approaches and was not
satisfied with the final result. That's the reason why I am not using
OpenSSH server and trying to make it possible with Twisted. I think it
will make a much more scalable and flexible system.
I strongly believe that others will find this project useful.

> If you want to write an SSH application server that does *not* allow running
> UNIX commands, you are going to have to write a lot more code; in effect,
> emulating a shell (or denying access to one entirely, as described in
> http://cyli.livejournal.com/38382.html )

I don't want to supply shell or any other interactive mode for a user.
This is all to be done at the client side 'automatically' using custom
sftp/ssh client

e.g. bzr branch sftp://user at server:port/allowed_path_only

> This code could definitely be better documented, but I don't think your
> question is related to subsystems.

when running the command mentioned above (bzr branch
sftp://user at server:port/allowed_path_only)  only
SSHSession.request_subsystem is called (neither request_shell nor
request_exec) - that's why I brought it up.



From tzury.by at gmail.com  Mon Dec 22 15:48:01 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Mon, 22 Dec 2008 22:48:01 +0200
Subject: [Twisted-Python]
	twisted.conch.ssh.session.SSHSession.request_subsystem
In-Reply-To: <2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>
References: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
	<20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>
	<2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>
Message-ID: <2f5ea7490812221248v5a446077le267a9625931bbbd@mail.gmail.com>

I managed to hack this by patching the _absPath method as follows:

# put in my main file

def absPath(self, path):
    # users is my own object which manages the users in the system
    profile = users.get(self.avatar.username)
    if profile:
        home = self.avatar.getHomeDir()
        abspath = os.path.abspath(os.path.join(home, path))
        if abspath.startswith(profile.home_path):
            return abspath


SFTPServerForUnixConchUser._absPath = absPath


Not elegant, but this is good enough for me to move on.



From glyph at divmod.com  Mon Dec 22 21:26:38 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 23 Dec 2008 02:26:38 -0000
Subject: [Twisted-Python]
	twisted.conch.ssh.session.SSHSession.request_subsystem
In-Reply-To: <2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>
References: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
	<20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>
	<2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>
Message-ID: <20081223022638.12555.2059177658.divmod.xquotient.2468@weber.divmod.com>

On 22 Dec, 07:10 pm, tzury.by at gmail.com wrote:
>Glyph, thanks for your attention and time. I am afraid I was not clear
>wit hmy question so please allow me to elaborate.

>>The way you control which paths a user can access in this scenario is 
>>by
>>setting the filesystem permissions on those directories.  Sorry, but 
>>Twisted
>>cannot magically change your UNIX filesystem so that arbitrary 
>>commands see
>>a different view of it.
>
>I don't want to create a UNIX user per client. I want to design the
>system in a way that all the clients will access using one single
>'public' account.

The key question is: do you just want an sftp server?  Or are you trying 
to write a real SSH server, that can run commands?
>e.g. bzr branch sftp://user at server:port/allowed_path_only

So, not "bzr+ssh://"?
>when running the command mentioned above (bzr branch
>sftp://user at server:port/allowed_path_only)  only
>SSHSession.request_subsystem is called (neither request_shell nor
>request_exec) - that's why I brought it up.

I believe "bzr+ssh://" will run request_exec instead.  (It will try to 
run 'bzr'.)



From samslists at gmail.com  Tue Dec 23 23:01:09 2008
From: samslists at gmail.com (Sam's Lists)
Date: Tue, 23 Dec 2008 20:01:09 -0800
Subject: [Twisted-Python] Compress/deflate support for getPage...
In-Reply-To: <20081209043453.12555.1842136836.divmod.xquotient.1812@weber.divmod.com>
References: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
	<15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
	<20081209043453.12555.1842136836.divmod.xquotient.1812@weber.divmod.com>
Message-ID: <558124520812232001i36e45c6btc7a0c4e32e08228f@mail.gmail.com>

I've checked out the expressive http version of the code mentioned in the
ticket, but  I still can't seem to figure out how to get access to the
response headers.

Aaron..do you have an example of how you used HTTPClientFactory?

Any suggestions about the best way to implement this using either the
official twisted branch or the expressive client branch would be helpful.
I've implemented similar functionality in the past around urllib2, but my
experience with Twisted is very limited.

I've been looking at the code for the past two hours.  I just can't figure
it out.  :(

Thanks!



On Mon, Dec 8, 2008 at 8:34 PM, <glyph at divmod.com> wrote:

>
> getPage has a number of deficiencies.  JP Calderone and Itamar Shtull-
> Trauring have been working on this ticket: <
> http://twistedmatrix.com/trac/ticket/886> which (among other things) adds
> support for response headers and the hooks with which one would implement
> deflate support.
>
>
> On 12:47 am, alecf at metaweb.com wrote:
>
>> Along similar lines, is there a better API than getPage() that allows you
>> to get headers, content-type, etc? The below could be easiliy implemented as
>> a callback if the callback knew what headers it got, so it knew whether or
>> not to deflate the body.
>>
>> Alec
>>
>> On Dec 8, 2008, at 4:00 PM, Sam's Lists wrote:
>>
>>> Is there any support for compress/deflate for webpages using the web
>>> client via getPage?
>>>
>>> If not, does anyone have a wrapper function before I make my own?
>>>
>>> Thanks
>>>
>>> _______________________________________________
>>> Twisted-Python mailing list
>>> Twisted-Python at twistedmatrix.com
>>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>>
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081223/cfc6d4d9/attachment.htm 

From apenon at gmail.com  Fri Dec 26 10:47:49 2008
From: apenon at gmail.com (Deniz Pecel)
Date: Fri, 26 Dec 2008 15:47:49 +0000
Subject: [Twisted-Python] ssh v1 support
Message-ID: <6a9316280812260747r12b0cafaq187a8e1311a23b09@mail.gmail.com>

Hi List
Does twisted support ssh v1?
thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081226/a14bce0e/attachment.htm 

From cary.hull at gmail.com  Fri Dec 26 11:17:21 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Fri, 26 Dec 2008 08:17:21 -0800
Subject: [Twisted-Python] ssh v1 support
In-Reply-To: <6a9316280812260747r12b0cafaq187a8e1311a23b09@mail.gmail.com>
References: <6a9316280812260747r12b0cafaq187a8e1311a23b09@mail.gmail.com>
Message-ID: <3fce0ae70812260817r463a8248i935375f304302072@mail.gmail.com>

Not out of the box. Conch is ssh2 only. However, you can attain ssh1
support by wrapping the binary (ssh) with a ProcessProtocol:

http://twistedmatrix.com/projects/core/documentation/howto/process.html

Before you start on your own implementation I would wait to see if
anyone has done this already and wouldn't mind sharing. :)

-Cary

On Fri, Dec 26, 2008 at 7:47 AM, Deniz Pecel <apenon at gmail.com> wrote:
> Hi List
> Does twisted support ssh v1?
> thanks
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From rhythm.mail at gmail.com  Sat Dec 27 08:21:29 2008
From: rhythm.mail at gmail.com (Lian Cheng)
Date: Sat, 27 Dec 2008 21:21:29 +0800
Subject: [Twisted-Python] A question about ITransport.write()
Message-ID: <gj5a53$mqj$1@ger.gmane.org>

Hi, all

As a Twisted newbie, I read the Twisted documentation, and found that:

   1. ITransport.write() doesn't return a deferred.
   2. IProtocol doesn't have a dataSent() callback or something alike.

Since ITransport.write() is a non-blocking call, how can I be informed 
when data sent by ITransport.write() is actually sent successfully?

Cheers
Cheng




From mail.sensenmann at googlemail.com  Sat Dec 27 13:08:18 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Sat, 27 Dec 2008 19:08:18 +0100
Subject: [Twisted-Python] Twisted and Urwid
Message-ID: <717b5780812271008m59aae955s3ba36c090ea078f2@mail.gmail.com>

Hi folks.

I've got a new question. After recongnising that the python bindings for
curses are not fully capable of displaying the unicode-chars I decided to
drop curses and shifted to urwid. Now I've got some basic questions in the
matter of urwid and twisted. As you may know I'm using a mvc-pattern and I
have not discovered a way to combine _and_ start urwid with twisted yet.
Maybe someone who already worked with urwid can give me a small hint.

Code:

http://codepad.org/0Hlvmp1b

class Input:
    def __init__(self,term):
        self.term = term
        self.size = self.term.get_cols_rows()
        self.input = urwid.Edit()
        self.filler = urwid.Filler(self.input)
        self.canvas = self.filler.render( self.size, focus=True )
        self.term.draw_screen(self.size,self.canvas)
        reactor.addReader(self)

    def fileno(self):
        return 0

    def logPrefix(self):
        return 'CursesClient'

    def doRead(self):
        keys = self.term.get_input_nonblocking()
        for key in keys:
            if key == 'window resize':
                self.size = self.term.get_cols_rows()
            elif key == 'enter':
                text = self.input.get_edit_text()
                controller.sendMsg('dev',text)
                self.input.set_edit_text('')
            else:
                self.filler.keypress(self.size, key)

term = urwid.raw_display.Screen()
term.run_wrapper(lambda: Input(term))



Traceback (most recent call last):
  File "./keckz.py", line 44, in <module>
    f.startKeckz(f.host, f.view)
  File "./keckz.py", line 38, in startKeckz
    controllerKeckz.Kekzcontroller(View).startConnection(host,23002)
  File "/home/arch/keckz/trunk/controllerKeckz.py", line 13, in __init__
    self.view = interface(self)
  File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in __init__
    self.term.run_wrapper(lambda: Input(self.term))
  File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line
212, in run_wrapper
    return fn()
  File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in <lambda>
    self.term.run_wrapper(lambda: Input(self.term))
  File "/home/arch/keckz/trunk/urwid_cli.py", line 55, in __init__
    self.term.draw_screen(self.size,self.canvas)
  File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line
579, in draw_screen
    assert self.palette.has_key(a), `a`
AssertionError: None
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081227/f183a48a/attachment.htm 

From exarkun at twistedmatrix.com  Sun Dec 28 00:05:10 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 28 Dec 2008 05:05:10 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1230440710.81.2068063256@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081228/afdaa398/attachment.htm 

From andrew-twisted at puzzling.org  Sun Dec 28 02:13:17 2008
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 28 Dec 2008 18:13:17 +1100
Subject: [Twisted-Python] A question about ITransport.write()
In-Reply-To: <gj5a53$mqj$1@ger.gmane.org>
References: <gj5a53$mqj$1@ger.gmane.org>
Message-ID: <20081228071317.GA24777@steerpike.home.puzzling.org>

Lian Cheng wrote:
> Hi, all
>
> As a Twisted newbie, I read the Twisted documentation, and found that:
>
>   1. ITransport.write() doesn't return a deferred.
>   2. IProtocol doesn't have a dataSent() callback or something alike.
>
> Since ITransport.write() is a non-blocking call, how can I be informed  
> when data sent by ITransport.write() is actually sent successfully?

It depends on what exactly you mean by "successfully".  Just because Twisted
has delivered the bytes to the OS for delivery (e.g. via the send(2)
syscall) doesn't mean they'll actually arrive at your intended destination.

So,

If you want to know if the bytes have arrived, get the remote side to send
back an explicit ACK of some sort.

If you want to know when the send buffer[1] isn't full anymore, so that you
can start working to fill it again, implement a pull producer
<http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4>
and call the transport's registerProducer method with it.

If you want something else, reply and tell us what :)

-Andrew.

[1] ?send buffer? is fairly loose terminology, but it'll do.




From rhythm.mail at gmail.com  Sun Dec 28 04:01:50 2008
From: rhythm.mail at gmail.com (Lian Cheng)
Date: Sun, 28 Dec 2008 17:01:50 +0800
Subject: [Twisted-Python] Re: A question about ITransport.write()
In-Reply-To: <20081228071317.GA24777@steerpike.home.puzzling.org>
References: <gj5a53$mqj$1@ger.gmane.org>
	<20081228071317.GA24777@steerpike.home.puzzling.org>
Message-ID: <gj7fad$1nh$1@ger.gmane.org>

Thanks Andrew!

Andrew Bennetts ??:
> Lian Cheng wrote:
>> Hi, all
>>
>> As a Twisted newbie, I read the Twisted documentation, and found that:
>>
>>   1. ITransport.write() doesn't return a deferred.
>>   2. IProtocol doesn't have a dataSent() callback or something alike.
>>
>> Since ITransport.write() is a non-blocking call, how can I be informed  
>> when data sent by ITransport.write() is actually sent successfully?
> 
> It depends on what exactly you mean by "successfully".  Just because Twisted
> has delivered the bytes to the OS for delivery (e.g. via the send(2)
> syscall) doesn't mean they'll actually arrive at your intended destination.
> 
> So,
> 
> If you want to know if the bytes have arrived, get the remote side to send
> back an explicit ACK of some sort.

I was actually confused by the words written in the documentation:

     If possible, make sure that it is all written. No data will ever be 
lost, although (obviously) the connection may be closed before it all 
gets through.

Seems here the documentation means that the connection may be closed due 
to some fatal errors such as network cable unplugged rather than calling 
ITransport.loseConnection().

> 
> If you want to know when the send buffer[1] isn't full anymore, so that you
> can start working to fill it again, implement a pull producer
> <http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4>
> and call the transport's registerProducer method with it.

Seems like what I'm looking for :-)

> 
> If you want something else, reply and tell us what :)

Thanks a lot again :-)

> 
> -Andrew.
> 
> [1] ?send buffer? is fairly loose terminology, but it'll do.

> Lian Cheng wrote:
>> Hi, all
>>
>> As a Twisted newbie, I read the Twisted documentation, and found that:
>>
>>   1. ITransport.write() doesn't return a deferred.
>>   2. IProtocol doesn't have a dataSent() callback or something alike.
>>
>> Since ITransport.write() is a non-blocking call, how can I be informed  
>> when data sent by ITransport.write() is actually sent successfully?
> 
> It depends on what exactly you mean by "successfully".  Just because Twisted
> has delivered the bytes to the OS for delivery (e.g. via the send(2)
> syscall) doesn't mean they'll actually arrive at your intended destination.
> 
> So,
> 
> If you want to know if the bytes have arrived, get the remote side to send
> back an explicit ACK of some sort.
> 
> If you want to know when the send buffer[1] isn't full anymore, so that you
> can start working to fill it again, implement a pull producer
> <http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4>
> and call the transport's registerProducer method with it.
> 
> If you want something else, reply and tell us what :)
> 
> -Andrew.
> 
> [1] ?send buffer? is fairly loose terminology, but it'll do.




From cary.hull at gmail.com  Sun Dec 28 04:13:52 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Sun, 28 Dec 2008 01:13:52 -0800
Subject: [Twisted-Python] Twisted and Urwid
In-Reply-To: <717b5780812271008m59aae955s3ba36c090ea078f2@mail.gmail.com>
References: <717b5780812271008m59aae955s3ba36c090ea078f2@mail.gmail.com>
Message-ID: <3fce0ae70812280113i1351fdc5x35f63ca1cec40ebf@mail.gmail.com>

Did you look at this?
http://excess.org/article/2008/09/urwid-gets-twisted-support/

Otherwise it looks like the error you are seeing there is due to not
setting up a palette.

-Cary

On Sat, Dec 27, 2008 at 10:08 AM, Christian Scharkus
<mail.sensenmann at googlemail.com> wrote:
> Hi folks.
>
> I've got a new question. After recongnising that the python bindings for
> curses are not fully capable of displaying the unicode-chars I decided to
> drop curses and shifted to urwid. Now I've got some basic questions in the
> matter of urwid and twisted. As you may know I'm using a mvc-pattern and I
> have not discovered a way to combine _and_ start urwid with twisted yet.
> Maybe someone who already worked with urwid can give me a small hint.
>
> Code:
>
> http://codepad.org/0Hlvmp1b
>
> class Input:
>     def __init__(self,term):
>
>         self.term = term
>         self.size = self.term.get_cols_rows()
>
>         self.input = urwid.Edit()
>
>         self.filler = urwid.Filler(self.input)
>
>         self.canvas = self.filler.render( self.size, focus=True )
>
>         self.term.draw_screen(self.size,self.canvas)
>
>         reactor.addReader(self)
>
>     def fileno(self):
>
>         return 0
>
>     def logPrefix(self):
>         return 'CursesClient'
>
>
>     def doRead(self):
>         keys = self.term.get_input_nonblocking()
>
>         for key in keys:
>             if key == 'window resize':
>
>                 self.size = self.term.get_cols_rows()
>
>             elif key == 'enter':
>                 text = self.input.get_edit_text()
>
>                 controller.sendMsg('dev',text)
>
>                 self.input.set_edit_text('')
>
>             else:
>                 self.filler.keypress(self.size, key)
>
>
> term = urwid.raw_display.Screen()
>
> term.run_wrapper(lambda: Input(term))
>
>
>
>
> Traceback (most recent call last):
>   File "./keckz.py", line 44, in <module>
>
>     f.startKeckz(f.host, f.view)
>
>   File "./keckz.py", line 38, in startKeckz
>
>     controllerKeckz.Kekzcontroller(View).startConnection(host,23002)
>
>   File "/home/arch/keckz/trunk/controllerKeckz.py", line 13, in __init__
>
>     self.view = interface(self)
>
>   File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in __init__
>
>     self.term.run_wrapper(lambda: Input(self.term))
>
>   File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line 212, in
> run_wrapper
>
>     return fn()
>   File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in <lambda>
>
>     self.term.run_wrapper(lambda: Input(self.term))
>
>   File "/home/arch/keckz/trunk/urwid_cli.py", line 55, in __init__
>
>     self.term.draw_screen(self.size,self.canvas)
>
>   File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line 579, in
> draw_screen
>
>     assert self.palette.has_key(a), `a`
>
> AssertionError: None
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From shawn at schurchcomputers.com  Sun Dec 28 05:05:32 2008
From: shawn at schurchcomputers.com (Shawn Church)
Date: Sun, 28 Dec 2008 02:05:32 -0800
Subject: [Twisted-Python] Question on logging.
Message-ID: <f4a7d4e0812280205qeaf4c44ubb8920a441af07e1@mail.gmail.com>

My problem is that PyAmf uses the standard Python logging module and twisted
uses it's own logging module.  I would like to have a single logging
mechanism that can be specified via twistd.  I would also like to have more
control of the output of the twisted log.  After googling and reading
Glyph's essay on the logging module (
http://twistedmatrix.com/trac/wiki/TwistedLogging) I have came up with two
solutions:

1) Simply configure the logging module with a logging.Handler subclass that
outputs to twisted.python.log.msg.  I can then add a custom LoggingObserver
to control the output.

2) I can use log.PythonLoggingObserver to redirect to the standard logging
module and use the standard logging formatting options and logging levels to
control output (taking into account the caveats pointed out by Glyph).

My questions are as follows:

1)  Are the above reasonable or am I missing something simpler?

2) When adding a LoggingObserver I am left with the LoggingObserver
initialized by twistd.  I can supress this with -l /dev/nul but it seems
better to eliminate it completely.  I guess I could just clear the
,observers property of the theLogPublisher singleton put that seems like an
implementation detail.  Again,  am I missing something?  Is there a way to
tell twistd to let me set up my logging manually?

Note,  I am using version 8.1.


Thanks,


Shawn Church
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081228/5996c3d0/attachment.htm 

From simply4it at gmail.com  Sun Dec 28 06:52:56 2008
From: simply4it at gmail.com (Simply for IT)
Date: Sun, 28 Dec 2008 11:52:56 +0000
Subject: [Twisted-Python] FTP LIST
Message-ID: <813b338a0812280352m18b6a1b5v7eb6d6b66a84b320@mail.gmail.com>

Hi Everyone,

I just have started to study twistedmatrix in my spare time couple of weeks
ago. I am satisfied with the books, but as they are very terse, and they are
not really FTP related, I could not figure out how the FTP is working.

I would like to be able to filter/modify the LIST(ing) process. Eg after
list(ing) the result should not list any .py files even if they are there.

I have tried to look after IFTPShell, but no success sofar. Here is a code
snipplet from the "official" testcases - or even from twisted.ftp)

    def requestAvatar(self, avatarId, mind, *interfaces):
         for iface in interfaces:
            if iface is ftp.IFTPShell:
                avatar = ftp.FTPShell(filepath.
FilePath(self.root))
                return ftp.IFTPShell, avatar, getattr(avatar, 'logout',
lambda: None)

Could anybody give me any advice, where to start, please?

Any help  would be appreciated.

Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081228/3f25cfc5/attachment.htm 

From mail.sensenmann at googlemail.com  Sun Dec 28 11:28:14 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Sun, 28 Dec 2008 17:28:14 +0100
Subject: [Twisted-Python] Twisted and Urwid
In-Reply-To: <3fce0ae70812280113i1351fdc5x35f63ca1cec40ebf@mail.gmail.com>
References: <717b5780812271008m59aae955s3ba36c090ea078f2@mail.gmail.com>
	<3fce0ae70812280113i1351fdc5x35f63ca1cec40ebf@mail.gmail.com>
Message-ID: <717b5780812280828q5f00257i1ac44ac7130d295e@mail.gmail.com>

Hi Cary.

I have seen it but I would prefer just to add my Input-Class as a Reader to
the reactor instead of using the twisted_main_loop. I have just the problem
that I have no idea how I make urwid start in the beginning.

2008/12/28 Cary Hull <cary.hull at gmail.com>

> Did you look at this?
> http://excess.org/article/2008/09/urwid-gets-twisted-support/
>
> Otherwise it looks like the error you are seeing there is due to not
> setting up a palette.
>
> -Cary
>
> On Sat, Dec 27, 2008 at 10:08 AM, Christian Scharkus
> <mail.sensenmann at googlemail.com> wrote:
> > Hi folks.
> >
> > I've got a new question. After recongnising that the python bindings for
> > curses are not fully capable of displaying the unicode-chars I decided to
> > drop curses and shifted to urwid. Now I've got some basic questions in
> the
> > matter of urwid and twisted. As you may know I'm using a mvc-pattern and
> I
> > have not discovered a way to combine _and_ start urwid with twisted yet.
> > Maybe someone who already worked with urwid can give me a small hint.
> >
> > Code:
> >
> > http://codepad.org/0Hlvmp1b
> >
> > class Input:
> >     def __init__(self,term):
> >
> >         self.term = term
> >         self.size = self.term.get_cols_rows()
> >
> >         self.input = urwid.Edit()
> >
> >         self.filler = urwid.Filler(self.input)
> >
> >         self.canvas = self.filler.render( self.size, focus=True )
> >
> >         self.term.draw_screen(self.size,self.canvas)
> >
> >         reactor.addReader(self)
> >
> >     def fileno(self):
> >
> >         return 0
> >
> >     def logPrefix(self):
> >         return 'CursesClient'
> >
> >
> >     def doRead(self):
> >         keys = self.term.get_input_nonblocking()
> >
> >         for key in keys:
> >             if key == 'window resize':
> >
> >                 self.size = self.term.get_cols_rows()
> >
> >             elif key == 'enter':
> >                 text = self.input.get_edit_text()
> >
> >                 controller.sendMsg('dev',text)
> >
> >                 self.input.set_edit_text('')
> >
> >             else:
> >                 self.filler.keypress(self.size, key)
> >
> >
> > term = urwid.raw_display.Screen()
> >
> > term.run_wrapper(lambda: Input(term))
> >
> >
> >
> >
> > Traceback (most recent call last):
> >   File "./keckz.py", line 44, in <module>
> >
> >     f.startKeckz(f.host, f.view)
> >
> >   File "./keckz.py", line 38, in startKeckz
> >
> >     controllerKeckz.Kekzcontroller(View).startConnection(host,23002)
> >
> >   File "/home/arch/keckz/trunk/controllerKeckz.py", line 13, in __init__
> >
> >     self.view = interface(self)
> >
> >   File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in __init__
> >
> >     self.term.run_wrapper(lambda: Input(self.term))
> >
> >   File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line 212,
> in
> > run_wrapper
> >
> >     return fn()
> >   File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in <lambda>
> >
> >     self.term.run_wrapper(lambda: Input(self.term))
> >
> >   File "/home/arch/keckz/trunk/urwid_cli.py", line 55, in __init__
> >
> >     self.term.draw_screen(self.size,self.canvas)
> >
> >   File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line 579,
> in
> > draw_screen
> >
> >     assert self.palette.has_key(a), `a`
> >
> > AssertionError: None
> >
> >
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
> >
>
>
>
> --
> 01100011 01100001 01110010 01111001
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081228/9ced747c/attachment.htm 

From exarkun at divmod.com  Sun Dec 28 13:35:09 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 28 Dec 2008 13:35:09 -0500
Subject: [Twisted-Python] Question on logging.
In-Reply-To: <f4a7d4e0812280205qeaf4c44ubb8920a441af07e1@mail.gmail.com>
Message-ID: <20081228183509.20272.1851526710.divmod.quotient.28299@ohm>

On Sun, 28 Dec 2008 02:05:32 -0800, Shawn Church <shawn at schurchcomputers.com> wrote:
>My problem is that PyAmf uses the standard Python logging module and twisted
>uses it's own logging module.  I would like to have a single logging
>mechanism that can be specified via twistd.  I would also like to have more
>control of the output of the twisted log.  After googling and reading
>Glyph's essay on the logging module (
>http://twistedmatrix.com/trac/wiki/TwistedLogging) I have came up with two
>solutions:
>
>1) Simply configure the logging module with a logging.Handler subclass that
>outputs to twisted.python.log.msg.  I can then add a custom LoggingObserver
>to control the output.
>
>2) I can use log.PythonLoggingObserver to redirect to the standard logging
>module and use the standard logging formatting options and logging levels to
>control output (taking into account the caveats pointed out by Glyph).
>
>My questions are as follows:
>
>1)  Are the above reasonable or am I missing something simpler?

Reasonable?  I'm not sure what you mean by that.  Are they correct?  Sure.

>
>2) When adding a LoggingObserver I am left with the LoggingObserver
>initialized by twistd.  I can supress this with -l /dev/nul but it seems
>better to eliminate it completely.  I guess I could just clear the
>,observers property of the theLogPublisher singleton put that seems like an
>implementation detail.  Again,  am I missing something?  Is there a way to
>tell twistd to let me set up my logging manually?

There's no way to tell twistd that in 8.1.  However, see <http://twistedmatrix.com/trac/ticket/638> and <http://twistedmatrix.com/trac/ticket/3534>

Jean-Paul



From exarkun at divmod.com  Sun Dec 28 13:38:48 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 28 Dec 2008 13:38:48 -0500
Subject: [Twisted-Python] FTP LIST
In-Reply-To: <813b338a0812280352m18b6a1b5v7eb6d6b66a84b320@mail.gmail.com>
Message-ID: <20081228183848.20272.776418200.divmod.quotient.28300@ohm>

On Sun, 28 Dec 2008 11:52:56 +0000, Simply for IT <simply4it at gmail.com> wrote:
>Hi Everyone,
>
>I just have started to study twistedmatrix in my spare time couple of weeks
>ago. I am satisfied with the books, but as they are very terse, and they are
>not really FTP related, I could not figure out how the FTP is working.
>
>I would like to be able to filter/modify the LIST(ing) process. Eg after
>list(ing) the result should not list any .py files even if they are there.

>I have tried to look after IFTPShell, but no success sofar. Here is a code
>snipplet from the "official" testcases - or even from twisted.ftp)
>

IFTPShell is the way you control the behavior of the FTP server.  To exclude
certain results from a directory listing, you would implement the `list?
method so that it has the necessary logic for performing that exclusion.

>    def requestAvatar(self, avatarId, mind, *interfaces):
>         for iface in interfaces:
>            if iface is ftp.IFTPShell:
>                avatar = ftp.FTPShell(filepath.
>FilePath(self.root))
>                return ftp.IFTPShell, avatar, getattr(avatar, 'logout',
>lambda: None)
>
>Could anybody give me any advice, where to start, please?

You found an implementation of a realm which supports IFTPShell.  If you
aren't familiar with realms, read the cred documentation:

  http://twistedmatrix.com/projects/core/documentation/howto/cred.html

The realm is important but pretty simple.  The avatar, the IFTPShell
implementation, is what really controls the behavior you're interested
in.

Jean-Paul



From exarkun at divmod.com  Sun Dec 28 13:42:32 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 28 Dec 2008 13:42:32 -0500
Subject: [Twisted-Python] Twisted and Urwid
In-Reply-To: <717b5780812280828q5f00257i1ac44ac7130d295e@mail.gmail.com>
Message-ID: <20081228184232.20272.1903765952.divmod.quotient.28303@ohm>

On Sun, 28 Dec 2008 17:28:14 +0100, Christian Scharkus <mail.sensenmann at googlemail.com> wrote:
>Hi Cary.
>
>I have seen it but I would prefer just to add my Input-Class as a Reader to
>the reactor instead of using the twisted_main_loop. I have just the problem
>that I have no idea how I make urwid start in the beginning.

Perhaps that question would be more appropriately put to the urwid
mailing list.

Jean-Paul



From mail.sensenmann at googlemail.com  Sun Dec 28 15:23:31 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Sun, 28 Dec 2008 21:23:31 +0100
Subject: [Twisted-Python] Twisted and Urwid
In-Reply-To: <20081228184232.20272.1903765952.divmod.quotient.28303@ohm>
References: <717b5780812280828q5f00257i1ac44ac7130d295e@mail.gmail.com>
	<20081228184232.20272.1903765952.divmod.quotient.28303@ohm>
Message-ID: <717b5780812281223q2485a78dr71ba1af2627ef5c1@mail.gmail.com>

It is already there. But why don't ask at the other projects mailing list
too?

2008/12/28 Jean-Paul Calderone <exarkun at divmod.com>

> On Sun, 28 Dec 2008 17:28:14 +0100, Christian Scharkus <
> mail.sensenmann at googlemail.com> wrote:
>
>> Hi Cary.
>>
>> I have seen it but I would prefer just to add my Input-Class as a Reader
>> to
>> the reactor instead of using the twisted_main_loop. I have just the
>> problem
>> that I have no idea how I make urwid start in the beginning.
>>
>
> Perhaps that question would be more appropriately put to the urwid
> mailing list.
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081228/7f21027a/attachment.htm 

From aryeh at bigfoot.com  Mon Dec 29 03:46:39 2008
From: aryeh at bigfoot.com (Arye)
Date: Mon, 29 Dec 2008 09:46:39 +0100
Subject: [Twisted-Python] Re: combining addCallback and callLater ?
In-Reply-To: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>
References: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>
Message-ID: <aaf543e90812290046ja0b794et1b0aaadf635944a9@mail.gmail.com>

Hello and thanks for your time.

Regards,


I've already written this some times:
>
> d1.addCallback(5, reactor.callLater, d2.callback, "firelater")
>
> Hope this, helps,
>
> --
> Amaury Forgeot d'Arc
>
>

On Tue, Dec 16, 2008 at 5:29 PM, Arye <aryeh at bigfoot.com> wrote:

> Dear list,
>
> I would like to add a callback that delays the chain. In other words I
> would like to combine:
> defer.Deferred().addCallback
> and reactor.callLater
>
> The only solution I came up with was the code below.
>
> There must be a more elegant way to do this.
> Any ideas would be greatly appreciated,
> All the best,
>
> *************************begin
> from twisted.internet import reactor, defer
>
> def printResults(results, arg):
>     print "In printResults results=", results
>     print "In printResults arg=", arg
>     if arg == 2:
>         reactor.stop()
>
>
> def fireLater(results, d2):
>     print "In fireLater results=", results
>     reactor.callLater(5, d2.callback, "firelater")
>
> d1 = defer.Deferred()
> d2 = defer.Deferred()
> d2.addCallback( printResults, 1)
> d2.addCallback( printResults, 2)
>
>
> d1.addCallback(fireLater, d2)
> d1.callback("fire")
>
> reactor.run()
> *************************end
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081229/9d998729/attachment.htm 

From simply4it at gmail.com  Tue Dec 30 15:55:11 2008
From: simply4it at gmail.com (Simply for IT)
Date: Tue, 30 Dec 2008 20:55:11 +0000
Subject: [Twisted-Python] FTP LIST
Message-ID: <813b338a0812301255y64f12cd7n6452c7dde283ebb7@mail.gmail.com>

<http://twistedmatrix.com/pipermail/twisted-python/2008-December/018932.html>

Hi Jean-Paul,

thank you for your reply.

I need to implement a new IFTPShell, right?

I have tried to create a new class (with a list method), which is
inherited from IFTPShell class itself, but I cannot get it accepted by
the realm I posted before.

Greg


>IFTPShell is the way you control the behavior of the FTP server.  To exclude
>certain results from a directory listing, you would implement the `list?
>method so that it has the necessary logic for performing that exclusion.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20081230/6f239930/attachment.htm 

From exarkun at divmod.com  Tue Dec 30 15:59:48 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 30 Dec 2008 15:59:48 -0500
Subject: [Twisted-Python] FTP LIST
In-Reply-To: <813b338a0812301255y64f12cd7n6452c7dde283ebb7@mail.gmail.com>
Message-ID: <20081230205948.20272.1950184686.divmod.quotient.29344@ohm>

On Tue, 30 Dec 2008 20:55:11 +0000, Simply for IT <simply4it at gmail.com> wrote:
><http://twistedmatrix.com/pipermail/twisted-python/2008-December/018932.html>
>
>Hi Jean-Paul,
>
>thank you for your reply.
>
>I need to implement a new IFTPShell, right?
>
>I have tried to create a new class (with a list method), which is
>inherited from IFTPShell class itself, but I cannot get it accepted by
>the realm I posted before.

IFTPShell is an interface.  You should not subclass it.  See
http://twistedmatrix.com/projects/core/documentation/howto/components.html
for a basic introduction to interfaces.

Jean-Paul



From darren at ontrenet.com  Wed Dec 31 09:37:26 2008
From: darren at ontrenet.com (Darren Govoni)
Date: Wed, 31 Dec 2008 09:37:26 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
Message-ID: <1230734246.16422.3.camel@nuraku>

Hi,
  I'm new to twisted and have a simple question. I want to run a
threaded server that monitors a remote service and spawns
queued/threaded tasks as it finds messages.

I'm having trouble understanding how to do this after a reactor is
running since the tasks are not set up before reactor.run(). I see
reactor.callLater(). But I want to spawn the task immediately.

I tried:

reactor.callLater(0,self.some_method,object)

but the method is not immediately invoked. It seems its not invoked at
all.

I want to create a high-performance threaded scheduler using twist. Any
tips?

thank you!
Darren




From exarkun at divmod.com  Wed Dec 31 10:17:41 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 31 Dec 2008 10:17:41 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <1230734246.16422.3.camel@nuraku>
Message-ID: <20081231151741.20272.393951892.divmod.quotient.29800@ohm>

On Wed, 31 Dec 2008 09:37:26 -0500, Darren Govoni <darren at ontrenet.com> wrote:
>Hi,
>  I'm new to twisted and have a simple question. I want to run a
>threaded server that monitors a remote service and spawns
>queued/threaded tasks as it finds messages.

Queued/threaded tasks?  That do what?

>
>I'm having trouble understanding how to do this after a reactor is
>running since the tasks are not set up before reactor.run(). I see
>reactor.callLater(). But I want to spawn the task immediately.

The way to do things after the reactor is running is the same as the way
to do things before the reactor is running.  Just do them.  There's no
difference.  If you're having trouble figuring out where to put the code
that does them, think about when you want the tasks done.  You said you
want to do things when you "find messages".  How do you find messages?

>
>I tried:
>
>reactor.callLater(0,self.some_method,object)
>
>but the method is not immediately invoked. It seems its not invoked at
>all.

This will call `self.some_method(object)? soon.  If the call is never
happening, then you've done something wrong.  Perhaps you didn't start
the reactor, or perhaps the signature of some_method is incompatible
with that invocation so that when the call was attempted, it just raised
a TypeError.  It's hard to say exactly what's wrong without seeing a
complete, self-contained, runnable example which demonstrates the
behavior.

>
>I want to create a high-performance threaded scheduler using twist. Any
>tips?

Think about ways to not use threads.  Anything you can do without threads
will be higher performance than the threaded equivalent.

Jean-Paul



From darren at ontrenet.com  Wed Dec 31 10:51:38 2008
From: darren at ontrenet.com (Darren Govoni)
Date: Wed, 31 Dec 2008 10:51:38 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <20081231151741.20272.393951892.divmod.quotient.29800@ohm>
References: <20081231151741.20272.393951892.divmod.quotient.29800@ohm>
Message-ID: <1230738698.16422.10.camel@nuraku>

Hi Jean-Paul,
  Thank you for those suggestions. I can post some simple code after I
get further. The psuedo code of what I want to do is like this:

every few seconds, check a message queue (I see how this is done):
   if there is a message, spawn a deferred so I don't block:
	# The deferred should immediately call a method in a separate
	# thread (wisted kind) to process the message
	# Allow for 10 or so deferreds to be processing messages
	# in parallel while the reactor continues to receive them
	# but block scheduling the deferred if the pool is maxed
	# out

Sorry if this is lacking in detail, i'm trying to test the idea in a
simple way with twisted first. If I set up a deferred before calling
reactor.run(), then of course, it runs, but after reactor.run() I have
to invoke reactor.callLater(...) so its a bit different, but what I'd
like is something like reactor.callNow(...) that doesn't block and
invokes the generator in a thread pool.

Thanks for any tips! Awesome package.

Darren

On Wed, 2008-12-31 at 10:17 -0500, Jean-Paul Calderone wrote:
> On Wed, 31 Dec 2008 09:37:26 -0500, Darren Govoni <darren at ontrenet.com> wrote:
> >Hi,
> >  I'm new to twisted and have a simple question. I want to run a
> >threaded server that monitors a remote service and spawns
> >queued/threaded tasks as it finds messages.
> 
> Queued/threaded tasks?  That do what?
> 
> >
> >I'm having trouble understanding how to do this after a reactor is
> >running since the tasks are not set up before reactor.run(). I see
> >reactor.callLater(). But I want to spawn the task immediately.
> 
> The way to do things after the reactor is running is the same as the way
> to do things before the reactor is running.  Just do them.  There's no
> difference.  If you're having trouble figuring out where to put the code
> that does them, think about when you want the tasks done.  You said you
> want to do things when you "find messages".  How do you find messages?
> 
> >
> >I tried:
> >
> >reactor.callLater(0,self.some_method,object)
> >
> >but the method is not immediately invoked. It seems its not invoked at
> >all.
> 
> This will call `self.some_method(object)? soon.  If the call is never
> happening, then you've done something wrong.  Perhaps you didn't start
> the reactor, or perhaps the signature of some_method is incompatible
> with that invocation so that when the call was attempted, it just raised
> a TypeError.  It's hard to say exactly what's wrong without seeing a
> complete, self-contained, runnable example which demonstrates the
> behavior.
> 
> >
> >I want to create a high-performance threaded scheduler using twist. Any
> >tips?
> 
> Think about ways to not use threads.  Anything you can do without threads
> will be higher performance than the threaded equivalent.
> 
> Jean-Paul
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From exarkun at divmod.com  Wed Dec 31 11:16:59 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 31 Dec 2008 11:16:59 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <1230738698.16422.10.camel@nuraku>
Message-ID: <20081231161659.20272.1130998283.divmod.quotient.29820@ohm>

On Wed, 31 Dec 2008 10:51:38 -0500, Darren Govoni <darren at ontrenet.com> wrote:
>Hi Jean-Paul,
>  Thank you for those suggestions. I can post some simple code after I
>get further. The psuedo code of what I want to do is like this:
>every few seconds, check a message queue (I see how this is done):
>   if there is a message, spawn a deferred so I don't block:
>	# The deferred should immediately call a method in a separate
>	# thread (wisted kind) to process the message
>	# Allow for 10 or so deferreds to be processing messages
>	# in parallel while the reactor continues to receive them
>	# but block scheduling the deferred if the pool is maxed
>	# out

A Deferred is just a convenient way to keep track of callbacks.  It's
not an active thing, so to "spawn" one doesn't make much sense.  Instead,
you spawn something else and use a Deferred to keep track of its result.

>
>Sorry if this is lacking in detail, i'm trying to test the idea in a
>simple way with twisted first. If I set up a deferred before calling
>reactor.run(), then of course, it runs, but after reactor.run() I have
>to invoke reactor.callLater(...) so its a bit different, but what I'd
>like is something like reactor.callNow(...) that doesn't block and
>invokes the generator in a thread pool.

You probably want twisted.internet.threads.deferToThreadPool (or the older
deferToThread).  From its docstring:

  Call the function C{f} using a thread from the given threadpool and return
  the result as a Deferred.

Jean-Paul



From darren at ontrenet.com  Wed Dec 31 15:08:25 2008
From: darren at ontrenet.com (Darren Govoni)
Date: Wed, 31 Dec 2008 15:08:25 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <20081231161659.20272.1130998283.divmod.quotient.29820@ohm>
References: <20081231161659.20272.1130998283.divmod.quotient.29820@ohm>
Message-ID: <1230754105.16422.40.camel@nuraku>

Hi,
  Thanks for that suggestion. It looks very close to what I need. I
tried doing it _after_ the reactor is run and it did not execute. Here
is a code snippet.

def convert_to_pdf(arg):
   print "converting..."

def notify_pdf:
   print "Yay! I'm done"

...
		d = threads.deferToThread(convert_to_pdf,offset)
		d.addCallback(notify_pdf)

All the examples for threads.deferToThread call reactor.run() after
configuring all the threads, but this isn't useful in my app.

If I call reactor.run() and _then_ try to deferToThread, it doesn't
work. I'm probably missing an argument or something.

Thanks for any tips. Much appreciated.

Darren

On Wed, 2008-12-31 at 11:16 -0500, Jean-Paul Calderone wrote:
> On Wed, 31 Dec 2008 10:51:38 -0500, Darren Govoni <darren at ontrenet.com> wrote:
> >Hi Jean-Paul,
> >  Thank you for those suggestions. I can post some simple code after I
> >get further. The psuedo code of what I want to do is like this:
> >every few seconds, check a message queue (I see how this is done):
> >   if there is a message, spawn a deferred so I don't block:
> >	# The deferred should immediately call a method in a separate
> >	# thread (wisted kind) to process the message
> >	# Allow for 10 or so deferreds to be processing messages
> >	# in parallel while the reactor continues to receive them
> >	# but block scheduling the deferred if the pool is maxed
> >	# out
> 
> A Deferred is just a convenient way to keep track of callbacks.  It's
> not an active thing, so to "spawn" one doesn't make much sense.  Instead,
> you spawn something else and use a Deferred to keep track of its result.
> 
> >
> >Sorry if this is lacking in detail, i'm trying to test the idea in a
> >simple way with twisted first. If I set up a deferred before calling
> >reactor.run(), then of course, it runs, but after reactor.run() I have
> >to invoke reactor.callLater(...) so its a bit different, but what I'd
> >like is something like reactor.callNow(...) that doesn't block and
> >invokes the generator in a thread pool.
> 
> You probably want twisted.internet.threads.deferToThreadPool (or the older
> deferToThread).  From its docstring:
> 
>   Call the function C{f} using a thread from the given threadpool and return
>   the result as a Deferred.
> 
> Jean-Paul
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From darren at ontrenet.com  Wed Dec 31 15:13:10 2008
From: darren at ontrenet.com (Darren Govoni)
Date: Wed, 31 Dec 2008 15:13:10 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <1230754105.16422.40.camel@nuraku>
References: <20081231161659.20272.1130998283.divmod.quotient.29820@ohm>
	<1230754105.16422.40.camel@nuraku>
Message-ID: <1230754390.16422.42.camel@nuraku>

It works now. Sorry for the extra post.

On Wed, 2008-12-31 at 15:08 -0500, Darren Govoni wrote:
> Hi,
>   Thanks for that suggestion. It looks very close to what I need. I
> tried doing it _after_ the reactor is run and it did not execute. Here
> is a code snippet.
> 
> def convert_to_pdf(arg):
>    print "converting..."
> 
> def notify_pdf:
>    print "Yay! I'm done"
> 
> ...
> 		d = threads.deferToThread(convert_to_pdf,offset)
> 		d.addCallback(notify_pdf)
> 
> All the examples for threads.deferToThread call reactor.run() after
> configuring all the threads, but this isn't useful in my app.
> 
> If I call reactor.run() and _then_ try to deferToThread, it doesn't
> work. I'm probably missing an argument or something.
> 
> Thanks for any tips. Much appreciated.
> 
> Darren
> 
> On Wed, 2008-12-31 at 11:16 -0500, Jean-Paul Calderone wrote:
> > On Wed, 31 Dec 2008 10:51:38 -0500, Darren Govoni <darren at ontrenet.com> wrote:
> > >Hi Jean-Paul,
> > >  Thank you for those suggestions. I can post some simple code after I
> > >get further. The psuedo code of what I want to do is like this:
> > >every few seconds, check a message queue (I see how this is done):
> > >   if there is a message, spawn a deferred so I don't block:
> > >	# The deferred should immediately call a method in a separate
> > >	# thread (wisted kind) to process the message
> > >	# Allow for 10 or so deferreds to be processing messages
> > >	# in parallel while the reactor continues to receive them
> > >	# but block scheduling the deferred if the pool is maxed
> > >	# out
> > 
> > A Deferred is just a convenient way to keep track of callbacks.  It's
> > not an active thing, so to "spawn" one doesn't make much sense.  Instead,
> > you spawn something else and use a Deferred to keep track of its result.
> > 
> > >
> > >Sorry if this is lacking in detail, i'm trying to test the idea in a
> > >simple way with twisted first. If I set up a deferred before calling
> > >reactor.run(), then of course, it runs, but after reactor.run() I have
> > >to invoke reactor.callLater(...) so its a bit different, but what I'd
> > >like is something like reactor.callNow(...) that doesn't block and
> > >invokes the generator in a thread pool.
> > 
> > You probably want twisted.internet.threads.deferToThreadPool (or the older
> > deferToThread).  From its docstring:
> > 
> >   Call the function C{f} using a thread from the given threadpool and return
> >   the result as a Deferred.
> > 
> > Jean-Paul
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From adigeaydin at gmail.com  Mon Dec  1 06:19:47 2008
From: adigeaydin at gmail.com (=?ISO-8859-9?Q?Ayd=FDn_=DEEN?=)
Date: Mon, 1 Dec 2008 15:19:47 +0200
Subject: [Twisted-Python] how to design protocol.
Message-ID: <2196d7e0812010519u56038c85q755044620e946e65@mail.gmail.com>

Let me explain my problem.. I am building an uploader application using
twisted. I am using "Protocol" in both side. What is the best way to
seperate data?
When i try to call "self.transport.write(data)"  it doesnt send data
immediately, it is sending with some other datas whic i send them later. Why
doesnt it send, what for is it waiting?

when i some information data I am sending  with '\n' (there is no other '\n'
in my data) to separate it in the client side but it is getting really
complicated. When i start to send file there is no problem, first send
fileSize then read everything and write in a file till fileSize.

I saw FileWrapper in the api but i couldnt find any tip that how it works,
is it for sending file, is it right way to my goal?

What about sending data like HTTP? What do you think about this way?
8 #bytes of data
11111111 #data
3 #bytes of data
111 #data
0 #finished sending data

I need your suggestions all about these.
(some links, documents, tips would be great)

Thanks..
-- 
Aydın ŞEN

         Ege Üniversitesi
Uluslararası Bilgisayar Enstitüsü
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081201/1e7ff89f/attachment.html>

From alessio.pace at gmail.com  Mon Dec  1 06:45:37 2008
From: alessio.pace at gmail.com (Alessio Pace)
Date: Mon, 1 Dec 2008 14:45:37 +0100
Subject: [Twisted-Python] Create a standalone Unix executable for a Twisted
	application?
Message-ID: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>

Hi,

I'm pretty new to Python and Twisted, and I would like to know if anyone
could share some experiences in creating a standalone Unix executable for a
Twisted application I'm building.

I would like in fact to distribute my application on some Unix machines
(onto which I cannot install anything)  which do *not* have Python and
Twisted (and not even GCC).

Thank you in advance for any suggestion.

Regards,
Alessio Pace.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081201/eaebe406/attachment.html>

From reza at getpeer.com  Mon Dec  1 06:52:04 2008
From: reza at getpeer.com (Reza Lotun)
Date: Mon, 1 Dec 2008 13:52:04 +0000
Subject: [Twisted-Python] Create a standalone Unix executable for a
	Twisted application?
In-Reply-To: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
References: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
Message-ID: <356e30830812010552o267de0ccn99b7e8c017a25eca@mail.gmail.com>

Hi Alessio,

I've found bbfreeze to work quite well for this:

http://pypi.python.org/pypi/bbfreeze/0.95.4

Cheers,
Reza

On Mon, Dec 1, 2008 at 1:45 PM, Alessio Pace <alessio.pace at gmail.com> wrote:

> Hi,
>
> I'm pretty new to Python and Twisted, and I would like to know if anyone
> could share some experiences in creating a standalone Unix executable for a
> Twisted application I'm building.
>
> I would like in fact to distribute my application on some Unix machines
> (onto which I cannot install anything)  which do *not* have Python and
> Twisted (and not even GCC).
>
> Thank you in advance for any suggestion.
>
> Regards,
> Alessio Pace.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


-- 
Reza Lotun
Senior Software Engineer
Peer Technologies Limited
reza at getpeer.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081201/252e8034/attachment.html>

From reza at getpeer.com  Mon Dec  1 06:52:38 2008
From: reza at getpeer.com (Reza Lotun)
Date: Mon, 1 Dec 2008 13:52:38 +0000
Subject: [Twisted-Python] Create a standalone Unix executable for a
	Twisted application?
In-Reply-To: <356e30830812010552o267de0ccn99b7e8c017a25eca@mail.gmail.com>
References: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
	<356e30830812010552o267de0ccn99b7e8c017a25eca@mail.gmail.com>
Message-ID: <356e30830812010552yb6c7af1m40e3a1058be24d97@mail.gmail.com>

Sorry, the latest version is

http://pypi.python.org/pypi/bbfreeze/0.96.5

On Mon, Dec 1, 2008 at 1:52 PM, Reza Lotun <reza at getpeer.com> wrote:

> Hi Alessio,
>
> I've found bbfreeze to work quite well for this:
>
> http://pypi.python.org/pypi/bbfreeze/0.95.4
>
> Cheers,
> Reza
>
> On Mon, Dec 1, 2008 at 1:45 PM, Alessio Pace <alessio.pace at gmail.com>wrote:
>
>> Hi,
>>
>> I'm pretty new to Python and Twisted, and I would like to know if anyone
>> could share some experiences in creating a standalone Unix executable for a
>> Twisted application I'm building.
>>
>> I would like in fact to distribute my application on some Unix machines
>> (onto which I cannot install anything)  which do *not* have Python and
>> Twisted (and not even GCC).
>>
>> Thank you in advance for any suggestion.
>>
>> Regards,
>> Alessio Pace.
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>>
>
>
> --
> Reza Lotun
> Senior Software Engineer
> Peer Technologies Limited
> reza at getpeer.com
>
>
>


-- 
Reza Lotun
Senior Software Engineer
Peer Technologies Limited
reza at getpeer.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081201/fe5028bb/attachment.html>

From exarkun at divmod.com  Mon Dec  1 06:56:17 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 1 Dec 2008 08:56:17 -0500
Subject: [Twisted-Python] how to design protocol.
In-Reply-To: <2196d7e0812010519u56038c85q755044620e946e65@mail.gmail.com>
Message-ID: <20081201135617.20272.1337678802.divmod.quotient.13952@ohm>

On Mon, 1 Dec 2008 15:19:47 +0200, Aydın ŞEN <adigeaydin at gmail.com> wrote:
>Let me explain my problem.. I am building an uploader application using
>twisted. I am using "Protocol" in both side. What is the best way to
>seperate data?
>When i try to call "self.transport.write(data)"  it doesnt send data
>immediately, it is sending with some other datas whic i send them later. Why
>doesnt it send, what for is it waiting?

http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#WhydoesittakealongtimefordataIsendwithtransport.writetoarriveattheothersideoftheconnection

>
>when i some information data I am sending  with '\n' (there is no other '\n'
>in my data) to separate it in the client side but it is getting really
>complicated. When i start to send file there is no problem, first send
>fileSize then read everything and write in a file till fileSize.

I'm not sure what problem you're describing.

>
>I saw FileWrapper in the api but i couldnt find any tip that how it works,
>is it for sending file, is it right way to my goal?

No.  FileWrapper probably isn't going to help you a lot.  It's possible that
twisted.protocols.basic.FileSender will.

>What about sending data like HTTP? What do you think about this way?
>8 #bytes of data
>11111111 #data
>3 #bytes of data
>111 #data
>0 #finished sending data

twisted.protocols.basic.NetstringReceiver (it can send too) might be useful.

>I need your suggestions all about these.
>(some links, documents, tips would be great)
>

Jean-Paul



From exarkun at divmod.com  Mon Dec  1 06:57:33 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 1 Dec 2008 08:57:33 -0500
Subject: [Twisted-Python] Create a standalone Unix executable for a
	Twisted application?
In-Reply-To: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
Message-ID: <20081201135734.20272.20577777.divmod.quotient.13953@ohm>

On Mon, 1 Dec 2008 14:45:37 +0100, Alessio Pace <alessio.pace at gmail.com> wrote:
>Hi,
>
>I'm pretty new to Python and Twisted, and I would like to know if anyone
>could share some experiences in creating a standalone Unix executable for a
>Twisted application I'm building.
>
>I would like in fact to distribute my application on some Unix machines
>(onto which I cannot install anything)  which do *not* have Python and
>Twisted (and not even GCC).
>
>Thank you in advance for any suggestion.

http://wiki.python.org/moin/Freeze might help.  I don't have any experiences
using it with Twisted to share, though.

Jean-Paul



From newptcai at gmail.com  Mon Dec  1 08:45:10 2008
From: newptcai at gmail.com (Peter Cai)
Date: Mon, 1 Dec 2008 23:45:10 +0800
Subject: [Twisted-Python] When would you considering split a server
	application to some physical instance with different logic function?
Message-ID: <befee6d80812010745r41da8efm8da141cd21898c@mail.gmail.com>

Hi all,

First, I am sorry because it's not a question related to twisted.
But since twisted is a networking programming framework,  you might be
interested.

Some of my colleagues have a view that a net work server should be split to
small parts with different functions,
either with processes communicating with socket, or with threads talking on
message queues.

Their points are these:

1.  Each part could it's own state-machine, thus we could split big
state-machines to decoupled small ones.

2.  It makes a pipe line that could handle some requests at the same time
without introducing lock problem of threading.
Just like how CPU use pipe line to improve performance.

3.  It resembles a micro-kernel system which is supposed to have better
availability.

As far as I know, some networking device manufactures use this model to
implement their routers or switches.
but I have never heard any examples besides that.
As twisted book says, most networking application use one of these 3 modes:

1. handle each connection in a separate operating system process, in which
case the operating system will take care
of letting other processes run while one is waiting;

2. handle each connection in a separate thread1 in which the threading
framework takes care of letting other threads
run while one is waiting; or

3. use non-blocking system calls to handle all connections in one thread.
(Like twisted or lib-event or just select)

After considering for a while,  I thought there are some faults in the
multiple parts model:

1. Writing code to handle message is much more tedious than just doing
function calls
2. It's not very easy to make a pipe line works fine.

OK, hope I made myself clear.  Since most of you who are reading this mail
list ,
are experienced networking programmers,  I think you might give some insight
comments.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081201/13fa4c90/attachment.html>

From alessio.pace at gmail.com  Mon Dec  1 10:34:28 2008
From: alessio.pace at gmail.com (Alessio Pace)
Date: Mon, 1 Dec 2008 18:34:28 +0100
Subject: [Twisted-Python] Create a standalone Unix executable for a
	Twisted application?
In-Reply-To: <20081201135734.20272.20577777.divmod.quotient.13953@ohm>
References: <84987d20812010545k1398e2b1o2c4cda40edd84f0b@mail.gmail.com>
	<20081201135734.20272.20577777.divmod.quotient.13953@ohm>
Message-ID: <84987d20812010934v58132651ie00af081769511e6@mail.gmail.com>

Hi all and thanks for the replies.  Apparenlty I managed to make the
standalone application with bbfreeze, I still have to tune a little bit how
it can pack in it also classes which are loaded dynamically, and which from
a static examination of the code are not found then...  I guess there will
be some sort of configuration to specify, but it's already something! :-)

Regards,
Alessio Pace.


On Mon, Dec 1, 2008 at 2:57 PM, Jean-Paul Calderone <exarkun at divmod.com>wrote:

> On Mon, 1 Dec 2008 14:45:37 +0100, Alessio Pace <alessio.pace at gmail.com>
> wrote:
>
>> Hi,
>>
>> I'm pretty new to Python and Twisted, and I would like to know if anyone
>> could share some experiences in creating a standalone Unix executable for
>> a
>> Twisted application I'm building.
>>
>> I would like in fact to distribute my application on some Unix machines
>> (onto which I cannot install anything)  which do *not* have Python and
>> Twisted (and not even GCC).
>>
>> Thank you in advance for any suggestion.
>>
>
> http://wiki.python.org/moin/Freeze might help.  I don't have any
> experiences
> using it with Twisted to share, though.
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081201/43fc3041/attachment.html>

From rboulle at free.fr  Mon Dec  1 15:10:05 2008
From: rboulle at free.fr (=?UTF-8?B?UsOpbWkgQm91bGxl?=)
Date: Mon, 01 Dec 2008 23:10:05 +0100
Subject: [Twisted-Python] /CTCP user VERSION with twisted ?
Message-ID: <493460BD.8090104@free.fr>

Hi,

I am starting using twisted with an IRC LogBot based on this ones :
http://twistedmatrix.com/projects/words/documentation/examples/ircLogBot.py
I customized it a little bit...

When a user logs in (on the chan), I would like to send him a /CTCP user 
VERSION, read the reply and send onto the chan the VERSION name of this 
user.

In the API, I found this :
http://python.net/crew/mwh/apidocs/twisted.words.protocols.irc.IRCClient.html#ctcpQuery_VERSION
But it seems to be for the bot itself...

How could I do that and let everbody knows on the chan if user is using 
Xchat, irssi, mirc... ;) ?

Thanks.
Rémi.



From maarten at treewalker.org  Mon Dec  1 16:22:13 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Tue, 2 Dec 2008 00:22:13 +0100
Subject: [Twisted-Python] When would you considering split a server
	application to some physical instance with different logic function?
In-Reply-To: <befee6d80812010745r41da8efm8da141cd21898c@mail.gmail.com>
References: <befee6d80812010745r41da8efm8da141cd21898c@mail.gmail.com>
Message-ID: <200812020022.13503.maarten@treewalker.org>

On Monday 01 December 2008, Peter Cai wrote:

> As far as I know, some networking device manufactures use this model to
> implement their routers or switches.
> but I have never heard any examples besides that.

The Postfix mail server uses an architecture of many small processes working 
together:
  http://www.postfix.org/OVERVIEW.html

One of the big motivations for this architecture is security: each process 
only needs to run with the minimum privileges it needs to do its work. Just 
because SMTP has to listen to port 25 does not mean the entire mail server 
has to run as root.

> As twisted book says, most networking application use one of these 3
> modes:
>
> 1. handle each connection in a separate operating system process, in
> which case the operating system will take care
> of letting other processes run while one is waiting;
>
> 2. handle each connection in a separate thread1 in which the threading
> framework takes care of letting other threads
> run while one is waiting; or
>
> 3. use non-blocking system calls to handle all connections in one thread.
> (Like twisted or lib-event or just select)

This describes how multiple connections can be handled (for example Apache 
has several different approaches for this), which is a different issue from 
spreading functionality over different processes (like Postfix does).

Where do you expect the bottleneck to be in your application? Does it have 
to serve a large number of clients? Does it have to send or receive large 
amounts of data? Does it have to do heavy computations? Does it have to get 
data to or from external servers like a DB server or a web service?

> After considering for a while,  I thought there are some faults in the
> multiple parts model:
>
> 1. Writing code to handle message is much more tedious than just doing
> function calls
> 2. It's not very easy to make a pipe line works fine.

It depends a lot on what you are trying to build and where and how you make 
the splits between differents parts of your application.

For example a function call is simple in the case there is only one thread 
and the called operation will not block. If it does block, you need to add a 
callback mechanism like Twisted's Deferred. Or if there are multiple 
threads, you have to be very careful about which functions you are allowed 
to call while your thread is holding one or more locks. So a function call 
is not so simple anymore when it's part of a complex application...

There are libraries that make communication over a pipe more friendly, such 
as Perspective Broker or Foolscap. This does not mean you can replace any 
arbitrary function call by a remote method call, but it does mean you can 
skip writing (de)serialization code again and again.

No matter which model you choose, dividing your application into 
communicating blocks is a good idea: it is absolutely necessary when using 
multiple processes, if avoids a lot of locking issues when using threads and 
it makes your application easier to test in all three models.

Bye,
		Maarten




From gabriel.rossetti at arimaz.com  Tue Dec  2 00:34:19 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 02 Dec 2008 08:34:19 +0100
Subject: [Twisted-Python] XMPP server connection question
Message-ID: <4934E4FB.1060605@arimaz.com>

Hello everyone,

I wrote an XMPP client and I have a question, when it tries to connect 
and the server is not listening, it doesn't send back an error and tries 
forever. I see that this function (twisted/names/srvconnect.py):

def _ebGotServers(self, failure):
        failure.trap(DNSNameError)

        # Some DNS servers reply with NXDOMAIN when in fact there are
        # just no SRV records for that domain. Act as if we just got an
        # empty response and use fallback.

        self.servers = []
        self.orderedServers = []

traps the exception so it never propagates to me, so I can't handle it. 
Any ideas? I using the XMPP client example as a base for my code.

Thank you,
Gabriel




From adigeaydin at gmail.com  Tue Dec  2 05:29:54 2008
From: adigeaydin at gmail.com (=?ISO-8859-9?Q?Ayd=FDn_=DEEN?=)
Date: Tue, 2 Dec 2008 14:29:54 +0200
Subject: [Twisted-Python] Twisted with PyQt
Message-ID: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>

Hi,
i am using qt4reactor with twisted. My app structure is below:

i have pyqt class

class MainWindow(Object):
    bla
    bla
    bla
    from twisted.internet import reactor
    reactor.connectTCP('192.168.1.100', 8000, ClientFactory_(self)) # i am
sending qt object to clientFactory

class ClientFactory_(ClientFactory):
    def __init__(self,ui):
        self.ui = ui
    def buildProtocol(self, addr):
         return Uploader(self.ui)
     bla
     bla

class Uploader(Protocol):
    def __init__(self,ui):
       self.ui = ui
    """ Some upload stuffs"""
    bla
    bla
    bla
    def updateProgressBar(self, newValue):
       self.ui.progressBar.setValue(newValue)

i am updating my progressBar from Upload class, but window is freezing when
i do it (only progressBar isnot, others are freezing when i upload file).
How can i solve this, how can i design it?

Thanks all..

-- 
Aydın ŞEN

         Ege Üniversitesi
Uluslararası Bilgisayar Enstitüsü
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081202/2312ec90/attachment.html>

From gabriel.rossetti at arimaz.com  Tue Dec  2 06:21:17 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 02 Dec 2008 14:21:17 +0100
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <4934E4FB.1060605@arimaz.com>
References: <4934E4FB.1060605@arimaz.com>
Message-ID: <4935364D.8060208@arimaz.com>

Gabriel Rossetti wrote:
> Hello everyone,
>
> I wrote an XMPP client and I have a question, when it tries to connect 
> and the server is not listening, it doesn't send back an error and 
> tries forever. I see that this function (twisted/names/srvconnect.py):
>
> def _ebGotServers(self, failure):
>        failure.trap(DNSNameError)
>
>        # Some DNS servers reply with NXDOMAIN when in fact there are
>        # just no SRV records for that domain. Act as if we just got an
>        # empty response and use fallback.
>
>        self.servers = []
>        self.orderedServers = []
>
> traps the exception so it never propagates to me, so I can't handle 
> it. Any ideas? I using the XMPP client example as a base for my code.
>
> Thank you,
> Gabriel
Ok, the code I showed has nothing to do with the problem I think, what I 
don't get is the client never returns an error if nobody's listening...

Best regards,
Gabriel



From reynold.lei at gmail.com  Tue Dec  2 06:38:18 2008
From: reynold.lei at gmail.com (lei ren)
Date: Tue, 2 Dec 2008 21:38:18 +0800
Subject: [Twisted-Python] how to get the user's input
Message-ID: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>

hello ,everybody:
   i am a new to use the twisted. i woul'd like to complete a WEBGAME with
it.but i have a problem for the twisted
i have complete the server ,and the simple client.but ,i want to the client
have more function. one is let the usr input some command to the server
but when i write the code ,i found it's hard ,if i want to get the user's
input with raw_input() in a while loop,but it will block to wait the user'
input
what can i do for this .use thread? of twisted have some more power feature
for the problem,,thank you every body

ps:the problem like a MUD game ,user can send the command to the server and
reveive the message from server .and the user can send command everytime
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081202/f282c413/attachment.html>

From Sven-Erik.Tiberg at ltu.se  Tue Dec  2 06:45:49 2008
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Tue, 2 Dec 2008 14:45:49 +0100
Subject: [Twisted-Python] www.lua.org with twisted.python
Message-ID: <668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>

Hi

Looking at lua as a possbile network protocol for distributed
simulations.
Anyone used www.lua.org in twisted.
Pro and Con?

/BG 
Sven-Erik Tiberg / ITS
Lulea Univ of Technology
Sweden



From maarten at treewalker.org  Tue Dec  2 06:47:58 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Tue, 2 Dec 2008 14:47:58 +0100
Subject: [Twisted-Python] how to get the user's input
In-Reply-To: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>
References: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>
Message-ID: <200812021447.58619.maarten@treewalker.org>

On Tuesday 02 December 2008, lei ren wrote:

> if i want to get the
> user's input with raw_input() in a while loop,but it will block to wait
> the user' input
> what can i do for this .use thread? of twisted have some more power
> feature for the problem,,thank you every body

Maybe you can put sys.stdin in non-blocking mode? I never tried it though.

Bye,
		Maarten




From christopher.zorn at gmail.com  Tue Dec  2 06:59:37 2008
From: christopher.zorn at gmail.com (Christopher Zorn)
Date: Tue, 2 Dec 2008 08:59:37 -0500
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <4935364D.8060208@arimaz.com>
References: <4934E4FB.1060605@arimaz.com> <4935364D.8060208@arimaz.com>
Message-ID: <149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>

On Tue, Dec 2, 2008 at 8:21 AM, Gabriel Rossetti <
gabriel.rossetti at arimaz.com> wrote:

> Gabriel Rossetti wrote:
>
>> Hello everyone,
>>
>> I wrote an XMPP client and I have a question, when it tries to connect and
>> the server is not listening, it doesn't send back an error and tries
>> forever. I see that this function (twisted/names/srvconnect.py):
>>
>> def _ebGotServers(self, failure):
>>       failure.trap(DNSNameError)
>>
>>       # Some DNS servers reply with NXDOMAIN when in fact there are
>>       # just no SRV records for that domain. Act as if we just got an
>>       # empty response and use fallback.
>>
>>       self.servers = []
>>       self.orderedServers = []
>>
>> traps the exception so it never propagates to me, so I can't handle it.
>> Any ideas? I using the XMPP client example as a base for my code.
>>
>> Thank you,
>> Gabriel
>>
> Ok, the code I showed has nothing to do with the problem I think, what I
> don't get is the client never returns an error if nobody's listening...
>

It may be better to show a log of what is happening.

It should show something like the following :

2008-12-02 08:57:01-0500 [-] reactor class:
twisted.internet.selectreactor.SelectReactor.
2008-12-02 08:57:01-0500 [-] Starting factory
<twisted.words.protocols.jabber.xmlstream.XmlStreamFactory object at
0xf6b490>
2008-12-02 08:57:02-0500 [-] /etc/resolv.conf changed, reparsing
2008-12-02 08:57:02-0500 [-] Resolver added ('192.168.2.1', 53) to server
list
2008-12-02 08:57:02-0500 [-] <class 'twisted.names.dns.DNSDatagramProtocol'>
starting on 31847
2008-12-02 08:57:02-0500 [-] Starting protocol
<twisted.names.dns.DNSDatagramProtocol object at 0xfb9a90>
2008-12-02 08:57:02-0500 [-] (Port 31847 Closed)
2008-12-02 08:57:02-0500 [-] Stopping protocol
<twisted.names.dns.DNSDatagramProtocol object at 0xfb9a90>
2008-12-02 08:57:02-0500 [-] <twisted.names.srvconnect.SRVConnector instance
at 0xa236c8> will retry in 2 seconds
2008-12-02 08:57:02-0500 [-] Stopping factory
<twisted.words.protocols.jabber.xmlstream.XmlStreamFactory object at
0xf6b490>

This will keep trying until you quit. You can set a limit on how many times
it retries.



>
> Best regards,
>
> Gabriel
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081202/db253d0d/attachment.html>

From exarkun at divmod.com  Tue Dec  2 07:10:02 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 2 Dec 2008 09:10:02 -0500
Subject: [Twisted-Python] Twisted with PyQt
In-Reply-To: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>
Message-ID: <20081202141003.20272.225735855.divmod.quotient.14520@ohm>

On Tue, 2 Dec 2008 14:29:54 +0200, Aydın ŞEN <adigeaydin at gmail.com> wrote:
>Hi,
>i am using qt4reactor with twisted. My app structure is below:
>
>i have pyqt class
>
> [snip]
>
>i am updating my progressBar from Upload class, but window is freezing when
>i do it (only progressBar isnot, others are freezing when i upload file).
>How can i solve this, how can i design it?

You've probably omitted too many details for anyone to know what is causing
the problem or make a suggestion about how to fix it.  Try posting a complete,
minimal example which demonstrates the problem so that others can reproduce it
themselves.

Jean-Paul



From exarkun at divmod.com  Tue Dec  2 07:11:01 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 2 Dec 2008 09:11:01 -0500
Subject: [Twisted-Python] how to get the user's input
In-Reply-To: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>
Message-ID: <20081202141101.20272.339042903.divmod.quotient.14522@ohm>

On Tue, 2 Dec 2008 21:38:18 +0800, lei ren <reynold.lei at gmail.com> wrote:
>hello ,everybody:
>   i am a new to use the twisted. i woul'd like to complete a WEBGAME with
>it.but i have a problem for the twisted
>i have complete the server ,and the simple client.but ,i want to the client
>have more function. one is let the usr input some command to the server
>but when i write the code ,i found it's hard ,if i want to get the user's
>input with raw_input() in a while loop,but it will block to wait the user'
>input
>what can i do for this .use thread? of twisted have some more power feature
>for the problem,,thank you every body
>
>ps:the problem like a MUD game ,user can send the command to the server and
>reveive the message from server .and the user can send command everytime
>

The way to read from stdin without blocking the reactor is to use
twisted.internet.stdio.StandardIO, a transport which lets a protocol
interact with standard in and standard out.

Jean-Paul



From exarkun at divmod.com  Tue Dec  2 07:11:39 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 2 Dec 2008 09:11:39 -0500
Subject: [Twisted-Python] www.lua.org with twisted.python
In-Reply-To: <668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
Message-ID: <20081202141139.20272.1376079508.divmod.quotient.14523@ohm>

On Tue, 2 Dec 2008 14:45:49 +0100, Sven-Erik Tiberg <sven-erik.tiberg at ltu.se> wrote:
>Hi
>
>Looking at lua as a possbile network protocol for distributed
>simulations.
>Anyone used www.lua.org in twisted.
>Pro and Con?

As far as I know, Lua isn't a network protocol, so your question doesn't
seem to make sense.  Can you be more specific?

Jean-Paul



From jarrod at vertigrated.com  Tue Dec  2 12:19:06 2008
From: jarrod at vertigrated.com (Jarrod Roberson)
Date: Tue, 2 Dec 2008 14:19:06 -0500
Subject: [Twisted-Python] www.lua.org with twisted.python
In-Reply-To: <668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
References: <AclUhEmFgVhhgCuaThqxk2YEoKLYsA==>
	<668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
Message-ID: <fa3d0c740812021119x523634f0h2065272aabbb1c9a@mail.gmail.com>

On Tue, Dec 2, 2008 at 8:45 AM, Sven-Erik Tiberg <Sven-Erik.Tiberg at ltu.se>wrote:

> Hi
>
> Looking at lua as a possbile network protocol for distributed
> simulations.
> Anyone used www.lua.org in twisted.
> Pro and Con?


lua is another scripting language, more aimed at embedding than python.
so what you are asking doesn't make much sense.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081202/9fd4d980/attachment.html>

From Sven-Erik.Tiberg at ltu.se  Tue Dec  2 13:27:44 2008
From: Sven-Erik.Tiberg at ltu.se (Sven-Erik Tiberg)
Date: Tue, 2 Dec 2008 21:27:44 +0100
Subject: [Twisted-Python] www.lua.org with twisted.python
References: <AclUhEmFgVhhgCuaThqxk2YEoKLYsA==><668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
	<fa3d0c740812021119x523634f0h2065272aabbb1c9a@mail.gmail.com>
Message-ID: <668D1B8AD729C94DB91D17EC19B8BB9104E84FD6@EMMA.personal.adp.ltu.se>

Hi.
 
I know it now, put a completly wrong question on this forum.
 
The reason are that I'm looking for a protocol to exchange states of objects in 3D worlds ( web3d.org ) and simulation applications so it can form f.ex. driver simulators, flight simulators a.s.o.
In searching for a protocol that connect X3D sceens together, I found some X3D browsers that used custom defined protocols that are not open to make it possible to add other applications than the X3D browsers from the same company.
That's why I installed 2 of this browsers and protocol brokers in my systems to try them out and "sniff" the protocol using wireshark.
Found a chapter in wireshark describing a viewer for lua and assumed it was a networkprotocol, but so wrong I was.
Back to square one, in finding a protocol. Though there are the outdated protocol DIS ( Distributed Interactive Protocol ) defined in the X3D spec. the development for a new spec of protocol needs a boost.
Why bring twisted in to this, well there are a need for two lewel of distributed simulation, one in the same computer ( innerloop ) for fast resonse on stimuli on the model like a emidietly responce to turning of steeringwheel and one slower responce but more complex model ( outer loop ) like the responce of the car on the turning wheel with respect of suspension dynamic, wheel dynamic a.s.o. That need to transfere states over the network.
The innerloop could use python libs to read USB-streams from Human Interface Devices and make some calculations to send states to teh X3D model using twisted and a protocol. The other use of f.ex. twisted could be to interface a simulation engine like pyODE and more python libs or modelica.org or...
 
Have to search on for a usefull protocol, maybee xml based.
 
Thanks for the responces on my Q.
Have also asked at lua dev. group and their responce are the same, a bit negative compared to what I had hoped.
 
/bg
Sven-Erik

________________________________

From: twisted-python-bounces at twistedmatrix.com on behalf of Jarrod Roberson
Sent: Tue 12/2/2008 8:19 PM
To: Twisted general discussion
Subject: Re: [Twisted-Python] www.lua.org with twisted.python




On Tue, Dec 2, 2008 at 8:45 AM, Sven-Erik Tiberg <Sven-Erik.Tiberg at ltu.se> wrote:


	Hi
	
	Looking at lua as a possbile network protocol for distributed
	simulations.
	Anyone used www.lua.org <http://www.lua.org/>  in twisted.
	Pro and Con?


lua is another scripting language, more aimed at embedding than python.
so what you are asking doesn't make much sense. 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: winmail.dat
Type: application/ms-tnef
Size: 6081 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20081202/efd97a52/attachment-0002.bin>

From jarrod at vertigrated.com  Tue Dec  2 14:10:33 2008
From: jarrod at vertigrated.com (Jarrod Roberson)
Date: Tue, 2 Dec 2008 16:10:33 -0500
Subject: [Twisted-Python] www.lua.org with twisted.python
In-Reply-To: <668D1B8AD729C94DB91D17EC19B8BB9104E84FD6@EMMA.personal.adp.ltu.se>
References: <668D1B8AD729C94DB91D17EC19B8BB910565C631@EMMA.personal.adp.ltu.se>
	<fa3d0c740812021119x523634f0h2065272aabbb1c9a@mail.gmail.com>
	<668D1B8AD729C94DB91D17EC19B8BB9104E84FD6@EMMA.personal.adp.ltu.se>
Message-ID: <fa3d0c740812021310x33a72da8t2218366956fa22e4@mail.gmail.com>

On Tue, Dec 2, 2008 at 3:27 PM, Sven-Erik Tiberg <Sven-Erik.Tiberg at ltu.se>wrote:

> Hi.
>
> I know it now, put a completly wrong question on this forum.
>
> The reason are that I'm looking for a protocol to exchange states of
> objects in 3D worlds ( web3d.org ) and simulation applications so it can
> form f.ex. driver simulators, flight simulators a.s.o.
> In searching for a protocol that connect X3D sceens together, I found some
> X3D browsers that used custom defined protocols that are not open to make it
> possible to add other applications than the X3D browsers from the same
> company.
> That's why I installed 2 of this browsers and protocol brokers in my
> systems to try them out and "sniff" the protocol using wireshark.
> Found a chapter in wireshark describing a viewer for lua and assumed it was
> a networkprotocol, but so wrong I was.
> Back to square one, in finding a protocol. Though there are the outdated
> protocol DIS ( Distributed Interactive Protocol ) defined in the X3D spec.
> the development for a new spec of protocol needs a boost.
> Why bring twisted in to this, well there are a need for two lewel of
> distributed simulation, one in the same computer ( innerloop ) for fast
> resonse on stimuli on the model like a emidietly responce to turning of
> steeringwheel and one slower responce but more complex model ( outer loop )
> like the responce of the car on the turning wheel with respect of suspension
> dynamic, wheel dynamic a.s.o. That need to transfere states over the
> network.
> The innerloop could use python libs to read USB-streams from Human
> Interface Devices and make some calculations to send states to teh X3D model
> using twisted and a protocol. The other use of f.ex. twisted could be to
> interface a simulation engine like pyODE and more python libs or
> modelica.org or...
>
> Have to search on for a usefull protocol, maybee xml based.


this is more of what you should be looking for http://www.opentnl.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081202/78d2e104/attachment.html>

From reynold.lei at gmail.com  Tue Dec  2 19:55:46 2008
From: reynold.lei at gmail.com (lei ren)
Date: Wed, 3 Dec 2008 10:55:46 +0800
Subject: [Twisted-Python] how to get the user's input
In-Reply-To: <20081202141101.20272.339042903.divmod.quotient.14522@ohm>
References: <f14fd8f20812020538h51e06b2cu58c100e49024e389@mail.gmail.com>
	<20081202141101.20272.339042903.divmod.quotient.14522@ohm>
Message-ID: <f14fd8f20812021855u7606879k918298a1fa12be2a@mail.gmail.com>

thanks jean-Pul.i can use commandline to intercat with server by the
StandardIO.
it's so easy with it

and there is a sample in Twisted NetWork Programming Essentials

wow

from twisted.internet import stdio, reactor, protocol
from twisted.protocols import basic
import re

class DataForwardingProtocol(protocol.Protocol):
    def _ _init_ _(self):
        self.output = None
        self.normalizeNewlines = False

    def dataReceived(self, data):
        if self.normalizeNewlines:
            data = re.sub(r"(\r\n|\n)", "\r\n", data)
        if self.output:
            self.output.write(data)

class StdioProxyProtocol(DataForwardingProtocol):
    def connectionMade(self):
        inputForwarder = DataForwardingProtocol( )
        inputForwarder.output = self.transport
        inputForwarder.normalizeNewlines = True
        stdioWrapper = stdio.StandardIO(inputForwarder)
        self.output = stdioWrapper
        print "Connected to server.  Press ctrl-C to close connection."

class StdioProxyFactory(protocol.ClientFactory):
    protocol = StdioProxyProtocol

    def clientConnectionLost(self, transport, reason):
        reactor.stop( )

    def clientConnectionFailed(self, transport, reason):
        print reason.getErrorMessage( )
        reactor.stop( )

if __name__ == '_ _main_ _':
    import sys
    if not len(sys.argv) == 3:
        print "Usage: %s host port" % _ _file_ _
        sys.exit(1)

    reactor.connectTCP(sys.argv[1], int(sys.argv[2]), StdioProxyFactory( ))

    reactor.run( )




On Tue, Dec 2, 2008 at 10:11 PM, Jean-Paul Calderone <exarkun at divmod.com>wrote:

> On Tue, 2 Dec 2008 21:38:18 +0800, lei ren <reynold.lei at gmail.com> wrote:
>
>> hello ,everybody:
>>  i am a new to use the twisted. i woul'd like to complete a WEBGAME with
>> it.but i have a problem for the twisted
>> i have complete the server ,and the simple client.but ,i want to the
>> client
>> have more function. one is let the usr input some command to the server
>> but when i write the code ,i found it's hard ,if i want to get the user's
>> input with raw_input() in a while loop,but it will block to wait the user'
>> input
>> what can i do for this .use thread? of twisted have some more power
>> feature
>> for the problem,,thank you every body
>>
>> ps:the problem like a MUD game ,user can send the command to the server
>> and
>> reveive the message from server .and the user can send command everytime
>>
>>
> The way to read from stdin without blocking the reactor is to use
> twisted.internet.stdio.StandardIO, a transport which lets a protocol
> interact with standard in and standard out.
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081203/c2397305/attachment.html>

From adigeaydin at gmail.com  Wed Dec  3 04:13:12 2008
From: adigeaydin at gmail.com (=?ISO-8859-9?Q?Ayd=FDn_=DEEN?=)
Date: Wed, 3 Dec 2008 13:13:12 +0200
Subject: [Twisted-Python] Twisted with PyQt
In-Reply-To: <20081202141003.20272.225735855.divmod.quotient.14520@ohm>
References: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>
	<20081202141003.20272.225735855.divmod.quotient.14520@ohm>
Message-ID: <2196d7e0812030313x4d469567lab8c845796209174@mail.gmail.com>

Hi,
Actuallly i solved my problem but i have another one. I am sending file in
while loop, as you said before it doesnt send data pyhshically, i am
updating my progressBar in while loop, so the progressBar is being updated
before data being sent..

Is there any signal that self.transport.write() creates when data "really"
sent? May be i can update my progressBar with that signal..

Thanks..

-adige-

2008/12/2 Jean-Paul Calderone <exarkun at divmod.com>

> On Tue, 2 Dec 2008 14:29:54 +0200, Aydın ŞEN <adigeaydin at gmail.com> wrote:
>
>> Hi,
>> i am using qt4reactor with twisted. My app structure is below:
>>
>> i have pyqt class
>>
>> [snip]
>>
>> i am updating my progressBar from Upload class, but window is freezing
>> when
>> i do it (only progressBar isnot, others are freezing when i upload file).
>> How can i solve this, how can i design it?
>>
>
> You've probably omitted too many details for anyone to know what is causing
> the problem or make a suggestion about how to fix it.  Try posting a
> complete,
> minimal example which demonstrates the problem so that others can reproduce
> it
> themselves.
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Aydın ŞEN

         Ege Üniversitesi
Uluslararası Bilgisayar Enstitüsü
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081203/f70e44c7/attachment.html>

From glyph at divmod.com  Wed Dec  3 07:05:11 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Wed, 03 Dec 2008 14:05:11 -0000
Subject: [Twisted-Python] Twisted with PyQt
In-Reply-To: <2196d7e0812030313x4d469567lab8c845796209174@mail.gmail.com>
References: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>
	<20081202141003.20272.225735855.divmod.quotient.14520@ohm>
	<2196d7e0812030313x4d469567lab8c845796209174@mail.gmail.com>
Message-ID: <20081203140511.12555.182819756.divmod.xquotient.653@weber.divmod.com>




On 11:13 am, adigeaydin at gmail.com wrote:
>Hi,
>Actuallly i solved my problem but i have another one. I am sending file 
>in
>while loop, as you said before it doesnt send data pyhshically, i am
>updating my progressBar in while loop, so the progressBar is being 
>updated
>before data being sent..
>
>Is there any signal that self.transport.write() creates when data 
>"really"
>sent? May be i can update my progressBar with that signal..

Sort of.  You shouldn't call transport.write() in a loop, you should 
register a producer for the transport and call transport.write when it's 
ready.  Documentation is here: 
http://twistedmatrix.com/projects/core/documentation/howto/producers.html



From adigeaydin at gmail.com  Wed Dec  3 09:18:17 2008
From: adigeaydin at gmail.com (=?ISO-8859-9?Q?Ayd=FDn_=DEEN?=)
Date: Wed, 3 Dec 2008 18:18:17 +0200
Subject: [Twisted-Python] Twisted with PyQt
In-Reply-To: <20081203140511.12555.182819756.divmod.xquotient.653@weber.divmod.com>
References: <2196d7e0812020429p13fe8596q23c69f0b56e8e08e@mail.gmail.com>
	<20081202141003.20272.225735855.divmod.quotient.14520@ohm>
	<2196d7e0812030313x4d469567lab8c845796209174@mail.gmail.com>
	<20081203140511.12555.182819756.divmod.xquotient.653@weber.divmod.com>
Message-ID: <2196d7e0812030818g2941bd3bud72a9484e147b710@mail.gmail.com>

Yes, the point is Producer, i solved my problem.

Thanks all.

-adige-

2008/12/3 <glyph at divmod.com>

>
>
>
> On 11:13 am, adigeaydin at gmail.com wrote:
>
>> Hi,
>> Actuallly i solved my problem but i have another one. I am sending file in
>> while loop, as you said before it doesnt send data pyhshically, i am
>> updating my progressBar in while loop, so the progressBar is being updated
>> before data being sent..
>>
>> Is there any signal that self.transport.write() creates when data "really"
>> sent? May be i can update my progressBar with that signal..
>>
>
> Sort of.  You shouldn't call transport.write() in a loop, you should
> register a producer for the transport and call transport.write when it's
> ready.  Documentation is here:
> http://twistedmatrix.com/projects/core/documentation/howto/producers.html
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
Aydın ŞEN

         Ege Üniversitesi
Uluslararası Bilgisayar Enstitüsü
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081203/0e48285e/attachment.html>

From sidharth.jain at gmail.com  Thu Dec  4 01:59:25 2008
From: sidharth.jain at gmail.com (Sidharth Jain)
Date: Thu, 4 Dec 2008 14:29:25 +0530
Subject: [Twisted-Python] monitoring net resources with twisted
Message-ID: <13a1329c0812040059w2fdff613h5a57e7ca837811ce@mail.gmail.com>

I want to track a set network resources like Linux servers,hosts for network
connectivity , and want to keep track of their activeness and possible
inactivity due to network outage or any other reason. The hosts/serves I'm
trying to monitor are regular Linux boxes with 2.6.x kernel. My personal
preference would be a dynamic background heart-beat process which could sit
on these servers/hosts and send periodic udp-packets to a master server to
signal host activity and inactivity.

As I'm quite new to twisted i would like to know if twisted provides any
functionality/libraries to do net monitoring.Any ideas using twisted to do
the same would be greatly appreciated.

Sid J
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081204/623e752d/attachment.html>

From maarten at treewalker.org  Thu Dec  4 04:34:35 2008
From: maarten at treewalker.org (Maarten ter Huurne)
Date: Thu, 4 Dec 2008 12:34:35 +0100
Subject: [Twisted-Python] monitoring net resources with twisted
In-Reply-To: <13a1329c0812040059w2fdff613h5a57e7ca837811ce@mail.gmail.com>
References: <13a1329c0812040059w2fdff613h5a57e7ca837811ce@mail.gmail.com>
Message-ID: <200812041234.35715.maarten@treewalker.org>

On Thursday 04 December 2008, Sidharth Jain wrote:
> I want to track a set network resources like Linux servers,hosts for
> network connectivity , and want to keep track of their activeness and
> possible inactivity due to network outage or any other reason. The
> hosts/serves I'm trying to monitor are regular Linux boxes with 2.6.x
> kernel. My personal preference would be a dynamic background heart-beat
> process which could sit on these servers/hosts and send periodic
> udp-packets to a master server to signal host activity and inactivity.

You could certainly write that with Twisted, but why not adopt an existing 
monitoring application like Nagios or Zenoss?

Bye,
		Maarten




From sidharth.jain at gmail.com  Thu Dec  4 07:57:43 2008
From: sidharth.jain at gmail.com (Sidharth Jain)
Date: Thu, 4 Dec 2008 20:27:43 +0530
Subject: [Twisted-Python] monitoring net resources with twisted
In-Reply-To: <200812041234.35715.maarten@treewalker.org>
References: <13a1329c0812040059w2fdff613h5a57e7ca837811ce@mail.gmail.com>
	<200812041234.35715.maarten@treewalker.org>
Message-ID: <13a1329c0812040657t4f5a2981p8305f22746231ad9@mail.gmail.com>

Marteen ,

I certainly don't want to reinvent the wheel by building anything similar to
nagios.

I want to build a small deployable framework without any web-interface or
gui , which doesn't use any web server and should run without any manual
intervention most of the time. It can also be regarded as an automation tool
which will act on data collected after monitoring different hosts at regular
intervals. Depending the state of the resource (host/server) task could be
dynamically assigned to each of the available resources.

I think i wrongly stated my objective earlier, i should be dynamic resource
allocation through net monitoring .

-Sid J


On Thu, Dec 4, 2008 at 5:04 PM, Maarten ter Huurne
<maarten at treewalker.org>wrote:

> On Thursday 04 December 2008, Sidharth Jain wrote:
> > I want to track a set network resources like Linux servers,hosts for
> > network connectivity , and want to keep track of their activeness and
> > possible inactivity due to network outage or any other reason. The
> > hosts/serves I'm trying to monitor are regular Linux boxes with 2.6.x
> > kernel. My personal preference would be a dynamic background heart-beat
> > process which could sit on these servers/hosts and send periodic
> > udp-packets to a master server to signal host activity and inactivity.
>
> You could certainly write that with Twisted, but why not adopt an existing
> monitoring application like Nagios or Zenoss?
>
> Bye,
>                Maarten
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081204/92fe4ded/attachment.html>

From thejayjay at gmail.com  Thu Dec  4 08:28:46 2008
From: thejayjay at gmail.com (James Joplin)
Date: Thu, 4 Dec 2008 10:28:46 -0500
Subject: [Twisted-Python] Strange downloadPage behavior with embedded Python
Message-ID: <d9b9b1220812040728t3683ca53m97642cbe9835366e@mail.gmail.com>

We have been using python embedded via the C API and have used Twisted for
various things.  We have come across some strange behavior and I cannot
figure out what is going on.


from twisted.internet import reactor
from twisted.web.client import downloadPage

...

def fetchRepo():
        global gameType, gameName, setupComplete, cp
        if (setupComplete):
                url = urlbase + "/" + gameType + "/" + gameName +
"/repo.ini"
                print "url is : " + url
                d = downloadPage(url, "C:\\svntest\\gamerepo.ini")
                d.addCallback(downloadSuccess)
                d.addErrback(downloadFailure)
                #cp.readfp(open("C:\\game-repo.ini"))
        else:
                print "urls not setup, throw errors etc."
...

This is an example of how we have been using downloadPage from
twisted.web.client.  I have no problems getting the example to work when I
make a simple app or write the code into the intrepeter.  But if I use it
inside my app I get the user timeout below.

Unhandled error in Deferred:
Traceback (most recent call last):
Failure: twisted.internet.error.TimeoutError: User timeout caused connection
failure.


Am I forgetting something trivial?  The reactor is running as we use PB for
database pooling.  Can I not call downloadPage after a reactor is setup and
connected?

James
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081204/1d187de7/attachment.html>

From exarkun at divmod.com  Thu Dec  4 08:43:01 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 4 Dec 2008 10:43:01 -0500
Subject: [Twisted-Python] Strange downloadPage behavior with embedded
	Python
In-Reply-To: <d9b9b1220812040728t3683ca53m97642cbe9835366e@mail.gmail.com>
Message-ID: <20081204154301.20272.2075983920.divmod.quotient.15626@ohm>

On Thu, 4 Dec 2008 10:28:46 -0500, James Joplin <thejayjay at gmail.com> wrote:
>We have been using python embedded via the C API and have used Twisted for
>various things.  We have come across some strange behavior and I cannot
>figure out what is going on.
>
>
>from twisted.internet import reactor
>from twisted.web.client import downloadPage
>
>...
>
>def fetchRepo():
>        global gameType, gameName, setupComplete, cp
>        if (setupComplete):
>                url = urlbase + "/" + gameType + "/" + gameName +
>"/repo.ini"
>                print "url is : " + url
>                d = downloadPage(url, "C:\\svntest\\gamerepo.ini")
>                d.addCallback(downloadSuccess)
>                d.addErrback(downloadFailure)
>                #cp.readfp(open("C:\\game-repo.ini"))
>        else:
>                print "urls not setup, throw errors etc."
>...
>
>This is an example of how we have been using downloadPage from
>twisted.web.client.  I have no problems getting the example to work when I
>make a simple app or write the code into the intrepeter.  But if I use it
>inside my app I get the user timeout below.
>
>Unhandled error in Deferred:
>Traceback (most recent call last):
>Failure: twisted.internet.error.TimeoutError: User timeout caused connection
>failure.
>
>
>Am I forgetting something trivial?  The reactor is running as we use PB for
>database pooling.  Can I not call downloadPage after a reactor is setup and
>connected?

Calling downloadPage after reactor.run is fine.  I'd take a look at DNS and
firewall settings for problems there.

Jean-Paul



From thejayjay at gmail.com  Thu Dec  4 10:20:45 2008
From: thejayjay at gmail.com (James Joplin)
Date: Thu, 4 Dec 2008 12:20:45 -0500
Subject: [Twisted-Python] Strange downloadPage behavior with embedded
	Python
In-Reply-To: <20081204154301.20272.2075983920.divmod.quotient.15626@ohm>
References: <d9b9b1220812040728t3683ca53m97642cbe9835366e@mail.gmail.com>
	<20081204154301.20272.2075983920.divmod.quotient.15626@ohm>
Message-ID: <d9b9b1220812040920ydf57a99hf664d540a1d63cc8@mail.gmail.com>

Wow, I feel like an idiot now!  I never thought to test that.  Thank you so
much!

Is there any reason DNS would work in a standalone python app and when I
embed the library via the C API dns stops working?  Is there a library I
should import to fix that?

James

On Thu, Dec 4, 2008 at 10:43 AM, Jean-Paul Calderone <exarkun at divmod.com>wrote:

> On Thu, 4 Dec 2008 10:28:46 -0500, James Joplin <thejayjay at gmail.com>
> wrote:
>
>> We have been using python embedded via the C API and have used Twisted for
>> various things.  We have come across some strange behavior and I cannot
>> figure out what is going on.
>>
>>
>> from twisted.internet import reactor
>> from twisted.web.client import downloadPage
>>
>> ...
>>
>> def fetchRepo():
>>       global gameType, gameName, setupComplete, cp
>>       if (setupComplete):
>>               url = urlbase + "/" + gameType + "/" + gameName +
>> "/repo.ini"
>>               print "url is : " + url
>>               d = downloadPage(url, "C:\\svntest\\gamerepo.ini")
>>               d.addCallback(downloadSuccess)
>>               d.addErrback(downloadFailure)
>>               #cp.readfp(open("C:\\game-repo.ini"))
>>       else:
>>               print "urls not setup, throw errors etc."
>> ...
>>
>> This is an example of how we have been using downloadPage from
>> twisted.web.client.  I have no problems getting the example to work when I
>> make a simple app or write the code into the intrepeter.  But if I use it
>> inside my app I get the user timeout below.
>>
>> Unhandled error in Deferred:
>> Traceback (most recent call last):
>> Failure: twisted.internet.error.TimeoutError: User timeout caused
>> connection
>> failure.
>>
>>
>> Am I forgetting something trivial?  The reactor is running as we use PB
>> for
>> database pooling.  Can I not call downloadPage after a reactor is setup
>> and
>> connected?
>>
>
> Calling downloadPage after reactor.run is fine.  I'd take a look at DNS and
> firewall settings for problems there.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081204/5e82db6a/attachment.html>

From muaazhussain128 at gmail.com  Fri Dec  5 01:46:22 2008
From: muaazhussain128 at gmail.com (Muaaz Hussain)
Date: Fri, 5 Dec 2008 11:46:22 +0300
Subject: [Twisted-Python] Re: Twisted-Python Digest, Vol 57, Issue 6
In-Reply-To: <E1L8HYa-0005lW-5r@cube.twistedmatrix.com>
References: <E1L8HYa-0005lW-5r@cube.twistedmatrix.com>
Message-ID: <1ac8ac10812050046o6b450f67wb7949c75f680dbe2@mail.gmail.com>

I'm  a beginner developer and I phase a problem in handling AJAX request by
the server .I wore server side program to read from ulogd  and diplay  ulogd
output  to the client browser using AJAX technology avialable in nevow
athena.
Also I wrote another one to display  tcpdump output .when  I render these
two applications together in the twisted web server .they work proberly and
I see the ulogd and tcpdump output in the client browser and AJAX work also
proberly to display updated output from the server.
  But I observed that when I open many browsers ,the server hang up because
the  load avarge of  the server  CPU  increasing  .the server print error
message "Athena transport duplicate message discarding... " after a few
minutes the OOM-killer of the linux kernel will kill the twisted porcess
because it consume large amount of time and memory.
is there any solution to this problem ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081205/8171c9a3/attachment.html>

From p.mayers at imperial.ac.uk  Fri Dec  5 03:42:47 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Fri, 05 Dec 2008 10:42:47 +0000
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
References: <4934E4FB.1060605@arimaz.com> <4935364D.8060208@arimaz.com>
	<149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
Message-ID: <493905A7.7030209@imperial.ac.uk>

Christopher Zorn wrote:
> 
> 
> On Tue, Dec 2, 2008 at 8:21 AM, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com <mailto:gabriel.rossetti at arimaz.com>> wrote:
> 
>     Gabriel Rossetti wrote:
> 
>         Hello everyone,
> 
>         I wrote an XMPP client and I have a question, when it tries to
>         connect and the server is not listening, it doesn't send back an
>         error and tries forever. I see that this function
>         (twisted/names/srvconnect.py):
> 
>         def _ebGotServers(self, failure):
>               failure.trap(DNSNameError)
> 
>               # Some DNS servers reply with NXDOMAIN when in fact there are
>               # just no SRV records for that domain. Act as if we just
>         got an
>               # empty response and use fallback.
> 
>               self.servers = []
>               self.orderedServers = []
> 
>         traps the exception so it never propagates to me, so I can't
>         handle it. Any ideas? I using the XMPP client example as a base
>         for my code.
> 
>         Thank you,
>         Gabriel
> 
>     Ok, the code I showed has nothing to do with the problem I think,
>     what I don't get is the client never returns an error if nobody's
>     listening...
> 
> 
> It may be better to show a log of what is happening.
> 

Yeah, the t.w.p.j.xmlstream.XmlStreamFactory inherits from 
ReconnectingClientFactory, which is IMHO wrong.

See also:

http://twistedmatrix.com/trac/ticket/3492



From gabriel.rossetti at arimaz.com  Fri Dec  5 04:22:06 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 05 Dec 2008 12:22:06 +0100
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
References: <4934E4FB.1060605@arimaz.com> <4935364D.8060208@arimaz.com>
	<149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
Message-ID: <49390EDE.7080206@arimaz.com>

Christopher Zorn wrote:
>
>
> On Tue, Dec 2, 2008 at 8:21 AM, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com <mailto:gabriel.rossetti at arimaz.com>> wrote:
>
>     Gabriel Rossetti wrote:
>
>         Hello everyone,
>
>         I wrote an XMPP client and I have a question, when it tries to
>         connect and the server is not listening, it doesn't send back
>         an error and tries forever. I see that this function
>         (twisted/names/srvconnect.py):
>
>         def _ebGotServers(self, failure):
>               failure.trap(DNSNameError)
>
>               # Some DNS servers reply with NXDOMAIN when in fact
>         there are
>               # just no SRV records for that domain. Act as if we just
>         got an
>               # empty response and use fallback.
>
>               self.servers = []
>               self.orderedServers = []
>
>         traps the exception so it never propagates to me, so I can't
>         handle it. Any ideas? I using the XMPP client example as a
>         base for my code.
>
>         Thank you,
>         Gabriel
>
>     Ok, the code I showed has nothing to do with the problem I think,
>     what I don't get is the client never returns an error if nobody's
>     listening...
>
>
> It may be better to show a log of what is happening.
>
> It should show something like the following :
>
> 2008-12-02 08:57:01-0500 [-] reactor class: 
> twisted.internet.selectreactor.SelectReactor.
> 2008-12-02 08:57:01-0500 [-] Starting factory 
> <twisted.words.protocols.jabber.xmlstream.XmlStreamFactory object at 
> 0xf6b490>
> 2008-12-02 08:57:02-0500 [-] /etc/resolv.conf changed, reparsing
> 2008-12-02 08:57:02-0500 [-] Resolver added ('192.168.2.1 
> <http://192.168.2.1>', 53) to server list
> 2008-12-02 08:57:02-0500 [-] <class 
> 'twisted.names.dns.DNSDatagramProtocol'> starting on 31847
> 2008-12-02 08:57:02-0500 [-] Starting protocol 
> <twisted.names.dns.DNSDatagramProtocol object at 0xfb9a90>
> 2008-12-02 08:57:02-0500 [-] (Port 31847 Closed)
> 2008-12-02 08:57:02-0500 [-] Stopping protocol 
> <twisted.names.dns.DNSDatagramProtocol object at 0xfb9a90>
> 2008-12-02 08:57:02-0500 [-] <twisted.names.srvconnect.SRVConnector 
> instance at 0xa236c8> will retry in 2 seconds
> 2008-12-02 08:57:02-0500 [-] Stopping factory 
> <twisted.words.protocols.jabber.xmlstream.XmlStreamFactory object at 
> 0xf6b490>
>
> This will keep trying until you quit. You can set a limit on how many 
> times it retries.
>
>  
>
>
>     Best regards,
>
>     Gabriel
>
>     ______________________
>
>
Ok, I finally created a class that wraps the client.XMPPClientFactory 
function and calls callbacks when the connection fails. Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081205/b1f5d978/attachment.html>

From gabriel.rossetti at arimaz.com  Fri Dec  5 04:23:08 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Fri, 05 Dec 2008 12:23:08 +0100
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <493905A7.7030209@imperial.ac.uk>
References: <4934E4FB.1060605@arimaz.com>
	<4935364D.8060208@arimaz.com>	<149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
	<493905A7.7030209@imperial.ac.uk>
Message-ID: <49390F1C.1010708@arimaz.com>

Phil Mayers wrote:
> Christopher Zorn wrote:
>>
>>
>> On Tue, Dec 2, 2008 at 8:21 AM, Gabriel Rossetti 
>> <gabriel.rossetti at arimaz.com <mailto:gabriel.rossetti at arimaz.com>> 
>> wrote:
>>
>>     Gabriel Rossetti wrote:
>>
>>         Hello everyone,
>>
>>         I wrote an XMPP client and I have a question, when it tries to
>>         connect and the server is not listening, it doesn't send back an
>>         error and tries forever. I see that this function
>>         (twisted/names/srvconnect.py):
>>
>>         def _ebGotServers(self, failure):
>>               failure.trap(DNSNameError)
>>
>>               # Some DNS servers reply with NXDOMAIN when in fact 
>> there are
>>               # just no SRV records for that domain. Act as if we just
>>         got an
>>               # empty response and use fallback.
>>
>>               self.servers = []
>>               self.orderedServers = []
>>
>>         traps the exception so it never propagates to me, so I can't
>>         handle it. Any ideas? I using the XMPP client example as a base
>>         for my code.
>>
>>         Thank you,
>>         Gabriel
>>
>>     Ok, the code I showed has nothing to do with the problem I think,
>>     what I don't get is the client never returns an error if nobody's
>>     listening...
>>
>>
>> It may be better to show a log of what is happening.
>>
>
> Yeah, the t.w.p.j.xmlstream.XmlStreamFactory inherits from 
> ReconnectingClientFactory, which is IMHO wrong.
>
> See also:
>
> http://twistedmatrix.com/trac/ticket/3492
>
Yes, so do I.



From twisted at ralphm.ik.nu  Fri Dec  5 04:23:42 2008
From: twisted at ralphm.ik.nu (Ralph Meijer)
Date: Fri, 05 Dec 2008 12:23:42 +0100
Subject: [Twisted-Python] XMPP server connection question
In-Reply-To: <493905A7.7030209@imperial.ac.uk>
References: <4934E4FB.1060605@arimaz.com>
	<4935364D.8060208@arimaz.com>	<149014b90812020559y6ece4376ld5dbc46df31a779a@mail.gmail.com>
	<493905A7.7030209@imperial.ac.uk>
Message-ID: <49390F3E.3030201@ralphm.ik.nu>

On 2008-12-05 11:42, Phil Mayers wrote:
> Christopher Zorn wrote:
>
> Yeah, the t.w.p.j.xmlstream.XmlStreamFactory inherits from 
> ReconnectingClientFactory, which is IMHO wrong.
> 
> See also:
> 
> http://twistedmatrix.com/trac/ticket/3492

Wrong? It was just a design choice for this particular factory, made 
more than five years ago. Since then, the code has been refactored in 
such a way that it is pretty straightforward to have a non-reconnecting 
XMPP client:

-----8<-----8<-----8<-----
from twisted.words.xish.xmlstream import BootstrapMixin
from twisted.internet import protocol

class NonReconnectingXmlStreamFactory(BootstrapMixin,
                                       protocol.ClientFactory):
     """
     XmlStream factory that connects at most once.

     @ivar authenticator: The authenticator to be associated with the
                          XmlStream once a connection has been
                          established.
     """

     def __init__(self, authenticator):
         xmlstream.BootstrapMixin.__init__(self)
         self.authenticator = authenticator

     def buildProtocol(self, addr):
         """
         Create an instance of XmlStream and associate the authenticator.
         """
         xs = self.protocol(authenticator)
         self.installBootstraps(xs)
         return xs
-----8<-----8<-----8<-----

You can then also override protocol.ClientFactory's
clientConnectionFailed and clientConnectionLost as desirable. You should
probably add bootstrap handlers for STREAM_AUTHD_EVENT,
INIT_FAILED_EVENT, STREAM_ERROR_EVENT somewhere.

I have a similar special client factory in Wokkel that fires a deferred
as soon as a connection was made and the stream is authenticated. See
wokkel.client.DeferredClientFactory.

ralphm




From dushik at gmail.com  Fri Dec  5 04:44:40 2008
From: dushik at gmail.com (Andrey Kravchuk)
Date: Fri, 5 Dec 2008 13:44:40 +0200
Subject: [Twisted-Python] OSCAR buddy list
Message-ID: <a6c8aa390812050344tec58c81n28503b0a6ed017ea@mail.gmail.com>

Hi.

I am trying to implement an ICQ service using twisted OSCAR protocol.

Everything works fine so far, but i can't find out how to handle the
buddy list there. I can't find anything on this topic neither in
documentation, nor in this list or the source code. Please advice, or
if this is not implemented yet, please tell me where to look so i
could make a patch.

The main problem is if i connect to ICQ service with twisted, the user
appears offline for other users. In order to see his status change I
need to "request authorization" and the service must "grant
authorization". There was a time not so long ago when it was not
required, you could just set "authorization not required" in account
profile and it worked fine, but now it doesn't. Newly added users
appear in my contact list always offline.



From alecf at metaweb.com  Fri Dec  5 13:47:36 2008
From: alecf at metaweb.com (Alec Flett)
Date: Fri, 5 Dec 2008 12:47:36 -0800
Subject: [Twisted-Python] one-shot reactor?
Message-ID: <26702188-2E6D-48BC-B6A6-6332925A5547@metaweb.com>

Hey folks -
So I'm trying what seems to be a fairly unusual use of Twisted, but  
I'm hoping that someone out there has tried the same thing as me and  
can offer some pointers. Bear with me as I explain how we're set up.  
The issues I'm having are at the end..

We're running Pylons as our appserver, but almost all of our internal  
requests from the appserver are actually retrieved over HTTP - i.e.  
database requests, LOBs, etc... we also have one or two other  
proprietary connections that would benefit from asynchronous TCP  
access.. For years I've heard people raving about twisted, and I hate  
threads, so I thought I'd give it a shot.

So here's how this is working, at least in my early prototypes: Pylons  
is a WSGI environment, which means it needs a real callstack for each  
request.

Each request is more or less its own single-threaded environment, and  
the thread is only making new requests to internal services, not  
listening on any ports. So really Twisted is a client here, not a  
server. For each HTTP request, I'm running a "private" twisted reactor  
that simply runs until it runs out of reads/writes/delayedCalls.  My  
theory is this: in a single-threaded environment that is not listening  
for new connections.

So what I've done is make twisted.internet.reactor into a threadlocal  
object with Paste's StackedObjectProxy.

So far I have this mostly working, but I've hit a few stumbling blocks  
along the way:

1) it would be nice if the standard twisted reactors had an API for  
running in a one-off client mode - something like a  
reactor.runUntilExhausted(). I did write a kind of scheduler that does  
this for me (more on that below)

2) it's vaguely annoying that reactors aren't restartable - it means I  
have to destroy any reactor that's left around from the last request.  
Not a huge deal, but I'd much rather just create a single reactor that  
lives the life of the thread, and be able to call .run() / .stop()  
over and over.

3) I've attached my scheduler below. I hook it up with  
reactor.callLater(0, stop_when_complete).

The problem I'm running into with this approach is that many APIs like  
getPage() set a 30 second timeout, and then cancel the timeout later  
when it successfully retrieves the page.

My scheduler picks up the fact that there is a 30-second timeout, but  
because HTTPClientProtocol cancels the timeout, my scheduler isn't  
aware of that, and has already scheduled itself for 30 seconds into  
the future, so it can't call reactor.stop(). So instead, I wake up at  
most every 0.1 seconds - but that kind of defeats the point of the  
reactor blocking on select()/poll() if I have to keep waking up!

Maybe there's a better approach? What I kind of want is a hook into  
the reactor's runUntilCurrent() so I just get notified right before  
the select()/poll(). I'm considering just subclassing the reactor to  
hook into this.. ?


def stop_when_complete(reactor, running=False):
     all_pending = (reactor.getReaders() +
                    reactor.getWriters() +
                    reactor.getDelayedCalls())

     # depending on the platform, the waker is probably in there, and
     # shouldn't count as a pending event
     if reactor.waker in all_pending:
         all_pending.remove(reactor.waker)

     # ok, are we done? if so, tell the reactor to stop after its next
     # iteration.
     if not all_pending:
         reactor.stop()
         return

     # if we got here, we need to basically wait again to see if
     # there's anything left. We get the timeout for the next event, so
     # that we don't wake any more than we would have (this is how
     # ReactorBase.mainLoop works)
     timeout = reactor.timeout()
     if timeout is None:
         timeout = 0.0
     print "Sleeping for no more than %s seconds" % min(timeout, 0.1)
     reactor.callLater(min(timeout, 0.1),
                       stop_when_complete, reactor, running=True)




From nico at teknico.net  Sat Dec  6 00:38:43 2008
From: nico at teknico.net (Nicola Larosa)
Date: Sat, 06 Dec 2008 08:38:43 +0100
Subject: [Twisted-Python] Re: A Python metaclass for Twisted allowing
	__init__ to return a Deferred
References: <18702.15428.547828.694260@jon.es>
	<18703.8010.379291.213184@jon.es>
	<20081103201709.6400.1212227518.divmod.xquotient.746@weber.divmod.com>
	<18703.46231.594938.56742@jon.es>
	<20081104111127.6400.342806414.divmod.xquotient.903@weber.divmod.com>
	<18704.28330.986594.539860@jon.es>
Message-ID: <200812060738.mB67ci0X032297@smtpi1.ngi.it>

Terry Jones wrote:
> BTW, I spent an interesting morning getting my head around *exactly* how
> inlineCallbacks does its thing... No summary of my thoughts could do it
> justice. I wonder how many people on the planet have been down that rabbit
> hole.

Not me, man, not me. I just use the bloody thing, and curse it when it
shortens tracebacks.


> I hope people don't mind my peanut gallery commentary. We're all in this
> together, after all. A little gallows humor occasionally seems in order.

Again, certainly not me. Go right ahead! ;-)

-- 
Nicola Larosa - http://www.tekNico.net/

The rhythm section responds to the orchestra in a way that makes it
significant for a jazz record [Epiphany]. Having a rhythm section
respond to the stimulus of the other players is what jazz is all about. 
 - Vince Mendoza, September 2007





From terry at jon.es  Sat Dec  6 01:06:36 2008
From: terry at jon.es (Terry Jones)
Date: Sat, 6 Dec 2008 09:06:36 +0100
Subject: [Twisted-Python] Re: A Python metaclass for Twisted allowing
	__init__ to return a Deferred
In-Reply-To: Your message at 08:38:43 on Saturday, 6 December 2008
References: <18702.15428.547828.694260@jon.es>
	<18703.8010.379291.213184@jon.es>
	<20081103201709.6400.1212227518.divmod.xquotient.746@weber.divmod.com>
	<18703.46231.594938.56742@jon.es>
	<20081104111127.6400.342806414.divmod.xquotient.903@weber.divmod.com>
	<18704.28330.986594.539860@jon.es>
	<200812060738.mB67ci0X032297@smtpi1.ngi.it>
Message-ID: <18746.12940.638819.228559@jon.es>

Hi Nicola!

>>>>> "Nicola" == Nicola Larosa <nico at teknico.net> writes:
Nicola> Terry Jones wrote:
>> BTW, I spent an interesting morning getting my head around *exactly* how
>> inlineCallbacks does its thing... No summary of my thoughts could do it
>> justice. I wonder how many people on the planet have been down that
>> rabbit hole.

Nicola> Not me, man, not me. I just use the bloody thing, and curse it when
Nicola> it shortens tracebacks.

I know exactly what you're talking about, and I hated that too. But I dug
into that and found out where the problem was: I didn't know Python well
enough :-)

I bet you're doing something like this:

@inlineCallbacks
def f():
    # Whatever
    try:
        # Your code here
    except Exception, e:
        # Do some cleaning up, maybe write to the log, maybe call another
        # function that uses inlineCallbacks
        raise e

or just

@inlineCallbacks
def f():
    # Whatever
    try:
        # Your code here
    except Exception:
        # Do some cleaning up, maybe write to the log, maybe call another
        # function that uses inlineCallbacks
        raise


The problem here is that you're not using the 3-argument form of raise. So
you're either dropping information (with the raise e) or pulling out the
last exception (with the no-arg raise).

Consider the latter case. Suppose your cleanup code calls another function
that uses inlineCallbacks. That function will eventually raise
StopIteration or raise via calling defer.returnValue. So by the time
control returns to your code, your raise (which implicitly uses
sys.exc_info()) raises the wrong exception! So you get e.g., a
StopIteration exception coming at you out of your inlineCallbacks function
and you curse the thing :-) This applies if your cleanup code calls any
iterator, or if you call something that try/except catches a KeyError, etc.

So just use

@inlineCallbacks
def f():
    # Whatever
    try:
        # Your code here
    except Exception:
        info = sys.exc_info()
        # Do some cleaning up, maybe write to the log, maybe call another
        # function that uses inlineCallbacks
        raise info[0], info[1], info[2]

and it just works. Try it :-) You cant do anything nice like raise *info
because Python's parser doesn't like that (AFAIR).

I nearly posted about this to the list, but I figured it might help if I
had more of a clue about Python itself, seeing as what I was doing was
nothing to do with Twisted.


>> I hope people don't mind my peanut gallery commentary. We're all in this
>> together, after all. A little gallows humor occasionally seems in order.
Nicola> Again, certainly not me. Go right ahead! ;-)

Don't encourage me...

Terry



From exarkun at twistedmatrix.com  Sat Dec  6 22:05:20 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 07 Dec 2008 05:05:20 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1228626320.88.1735343683@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081207/1a4082d5/attachment.html>

From gabriel.rossetti at arimaz.com  Mon Dec  8 02:27:41 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Mon, 08 Dec 2008 10:27:41 +0100
Subject: [Twisted-Python] Deferred question
Message-ID: <493CE88D.3070507@arimaz.com>

Hello everyone,

I have a question concerning defers, I have a service that needs to 
query IO until it answers. The IO can be disconnected, connected but 
off, connected and on; depending on the state I get different 
exceptions. I wrote something like :

def __requestId(self, _):
        d = self.callPlugin(PLUGIN_NAME)
        d.addCallback(self.__receivedAns)
        d.addErrback(self.__requestId)

The plugin makes the request in a thread and the deferred is returned 
and called when either an answer is received or am exception is raised 
(e.g. timeout, missing hardware, etc)

This seams to work well, except that when I let the system run for a 
long time without the hardware being present or off (several hours/days) 
the memory consumption goes way up. I don' t really know what is causing 
this, and I'm looking for possible reasons, so I was wondering if maybe 
this could be what is causing the problem. It's probably not that, 
because from what I understand it works like this :

   1. the first request is made
   2. there is a timeout or something that raises the exception
   3. the errback gets called
   4. it makes a new request
   5. the deferred gets garbage collected
   6. the new request follows the same path

Can anyone confirm that this is correct, or are my defers somehow 
staying alive and not being garbage collected?

Thank you,
Gabriel Rossetti



From samslists at gmail.com  Mon Dec  8 17:00:18 2008
From: samslists at gmail.com (Sam's Lists)
Date: Mon, 8 Dec 2008 16:00:18 -0800
Subject: [Twisted-Python] Compress/deflate support for getPage...
Message-ID: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>

Is there any support for compress/deflate for webpages using the web client
via getPage?

If not, does anyone have a wrapper function before I make my own?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081208/008dd1a0/attachment.html>

From alecf at metaweb.com  Mon Dec  8 17:47:50 2008
From: alecf at metaweb.com (Alec Flett)
Date: Mon, 8 Dec 2008 16:47:50 -0800
Subject: [Twisted-Python] Compress/deflate support for getPage...
In-Reply-To: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
References: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
Message-ID: <15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>

Along similar lines, is there a better API than getPage() that allows  
you to get headers, content-type, etc? The below could be easiliy  
implemented as a callback if the callback knew what headers it got, so  
it knew whether or not to deflate the body.

Alec

On Dec 8, 2008, at 4:00 PM, Sam's Lists wrote:

> Is there any support for compress/deflate for webpages using the web  
> client via getPage?
>
> If not, does anyone have a wrapper function before I make my own?
>
> Thanks
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From aaron.devore at gmail.com  Mon Dec  8 20:32:24 2008
From: aaron.devore at gmail.com (Aaron DeVore)
Date: Mon, 8 Dec 2008 19:32:24 -0800
Subject: [Twisted-Python] Compress/deflate support for getPage...
In-Reply-To: <15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
References: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
	<15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
Message-ID: <2ead2fb0812081932j7d1194fcy75464b856380e50@mail.gmail.com>

For a recent project I directly used HTTPClientFactory, the factory
that getPage is based on. That required a bit more effort than a
simple getPage(...).addCallback(func) but it wasn't terrible.

-Aaron

On Mon, Dec 8, 2008 at 4:47 PM, Alec Flett <alecf at metaweb.com> wrote:
> Along similar lines, is there a better API than getPage() that allows you to
> get headers, content-type, etc? The below could be easiliy implemented as a
> callback if the callback knew what headers it got, so it knew whether or not
> to deflate the body.
>
> Alec
>
> On Dec 8, 2008, at 4:00 PM, Sam's Lists wrote:
>
>> Is there any support for compress/deflate for webpages using the web
>> client via getPage?
>>
>> If not, does anyone have a wrapper function before I make my own?
>>
>> Thanks
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From glyph at divmod.com  Mon Dec  8 21:34:53 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 09 Dec 2008 04:34:53 -0000
Subject: [Twisted-Python] Compress/deflate support for getPage...
In-Reply-To: <15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
References: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
	<15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
Message-ID: <20081209043453.12555.1842136836.divmod.xquotient.1812@weber.divmod.com>


getPage has a number of deficiencies.  JP Calderone and Itamar Shtull- 
Trauring have been working on this ticket: 
<http://twistedmatrix.com/trac/ticket/886> which (among other things) 
adds support for response headers and the hooks with which one would 
implement deflate support.

On 12:47 am, alecf at metaweb.com wrote:
>Along similar lines, is there a better API than getPage() that allows 
>you to get headers, content-type, etc? The below could be easiliy 
>implemented as a callback if the callback knew what headers it got, so 
>it knew whether or not to deflate the body.
>
>Alec
>
>On Dec 8, 2008, at 4:00 PM, Sam's Lists wrote:
>>Is there any support for compress/deflate for webpages using the web 
>>client via getPage?
>>
>>If not, does anyone have a wrapper function before I make my own?
>>
>>Thanks
>>
>>_______________________________________________
>>Twisted-Python mailing list
>>Twisted-Python at twistedmatrix.com
>>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From alessio.pace at gmail.com  Tue Dec  9 01:55:35 2008
From: alessio.pace at gmail.com (Alessio Pace)
Date: Tue, 9 Dec 2008 09:55:35 +0100
Subject: [Twisted-Python] Running commands / collecting datas via SSH on
	many machines: Twisted vs plain old scripts ?
Message-ID: <84987d20812090055n3282b4e6t329f6d3937a28e72@mail.gmail.com>

Hi,

I have to run commands and (later in time) collect logs from many machines,
connecting through SSH.

I was _genuinely_ wondering what an SSH client written in Twisted could give
me more than executing plain old shell scripts in a for loop.

>From what I saw, given the fact that my run/collect commands remain still
shell commands (cp, tar, etc...), the only thing that may change is that
using Twisted I could have a better utilization of resources rather than a
simple shell for loop in which I iterate in order over all the machines on
which I have to issue commands.

Am I missing something? I would like to stress the fact that I'm asking this
as a very specific question for Twisted usage in the context of
running/retrieving results on remote machines (as indeed I already happily
use Twisted for running custom network protocols) and I would right to
choose a simple but effective solution for this case.

Thanks in advance,
Alessio Pace.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081209/5df51110/attachment.html>

From gabriel.rossetti at arimaz.com  Tue Dec  9 02:09:10 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 09 Dec 2008 10:09:10 +0100
Subject: [Twisted-Python] Deferred question
In-Reply-To: <493CE88D.3070507@arimaz.com>
References: <493CE88D.3070507@arimaz.com>
Message-ID: <493E35B6.7030509@arimaz.com>

Gabriel Rossetti wrote:
> Hello everyone,
>
> I have a question concerning defers, I have a service that needs to 
> query IO until it answers. The IO can be disconnected, connected but 
> off, connected and on; depending on the state I get different 
> exceptions. I wrote something like :
>
> def __requestId(self, _):
>        d = self.callPlugin(PLUGIN_NAME)
>        d.addCallback(self.__receivedAns)
>        d.addErrback(self.__requestId)
>
> The plugin makes the request in a thread and the deferred is returned 
> and called when either an answer is received or am exception is raised 
> (e.g. timeout, missing hardware, etc)
>
> This seams to work well, except that when I let the system run for a 
> long time without the hardware being present or off (several 
> hours/days) the memory consumption goes way up. I don' t really know 
> what is causing this, and I'm looking for possible reasons, so I was 
> wondering if maybe this could be what is causing the problem. It's 
> probably not that, because from what I understand it works like this :
>
>   1. the first request is made
>   2. there is a timeout or something that raises the exception
>   3. the errback gets called
>   4. it makes a new request
>   5. the deferred gets garbage collected
>   6. the new request follows the same path
>
> Can anyone confirm that this is correct, or are my defers somehow 
> staying alive and not being garbage collected?
>
> Thank you,
> Gabriel Rossetti
>
Forget it, I monkey-patched defer.Deferred to add __del__ to see if it 
was called, and it was, so they are getting destroyed...



From gabriel.rossetti at arimaz.com  Tue Dec  9 02:10:58 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 09 Dec 2008 10:10:58 +0100
Subject: [Twisted-Python] How to see the number of received msgs?
Message-ID: <493E3622.3070906@arimaz.com>

Hello eveyone,

is there a way to see how many msgs have been received and are waiting 
to be processed by a client?

Thank you,
Gabriel



From tarjei at nu.no  Tue Dec  9 06:06:01 2008
From: tarjei at nu.no (tarjei)
Date: Tue, 09 Dec 2008 14:06:01 +0100
Subject: [Twisted-Python] How to see the number of received msgs?
In-Reply-To: <493E3622.3070906@arimaz.com>
References: <493E3622.3070906@arimaz.com>
Message-ID: <493E6D39.5020504@nu.no>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Gabriel Rossetti wrote:
> Hello eveyone,
> 
> is there a way to see how many msgs have been received and are waiting
> to be processed by a client?
Hi, I think you need to be far more specific if you want an answer.
Which protocol is this for example?

regards,
Tarjei
> 
> Thank you,
> Gabriel
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD4DBQFJPm05YVRKCnSvzfIRAk3JAJ9IwpmXvQoOOo6OTvw6ch33n9McBgCWLm2W
I0CWa9Gt8AOCirc0IZoZSg==
=ezer
-----END PGP SIGNATURE-----



From gabriel.rossetti at arimaz.com  Tue Dec  9 09:12:32 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Tue, 09 Dec 2008 17:12:32 +0100
Subject: [Twisted-Python] How to see the number of received msgs?
In-Reply-To: <493E6D39.5020504@nu.no>
References: <493E3622.3070906@arimaz.com> <493E6D39.5020504@nu.no>
Message-ID: <493E98F0.4050000@arimaz.com>

tarjei wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Gabriel Rossetti wrote:
>   
>> Hello eveyone,
>>
>> is there a way to see how many msgs have been received and are waiting
>> to be processed by a client?
>>     
> Hi, I think you need to be far more specific if you want an answer.
> Which protocol is this for example?
>   
TCP, but I assuming that Twisted gets stuff from the OS's buffer and 
puts it in it's own buffer, this may not be the case though, if it's not 
then my question makes no sense.

Regards,
Gabriel
> regards,
> Tarjei
>   
>> Thank you,
>> Gabriel
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>     
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.6 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
>
> iD4DBQFJPm05YVRKCnSvzfIRAk3JAJ9IwpmXvQoOOo6OTvw6ch33n9McBgCWLm2W
> I0CWa9Gt8AOCirc0IZoZSg==
> =ezer
> -----END PGP SIGNATURE-----
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>   



From foom at fuhm.net  Tue Dec  9 10:10:45 2008
From: foom at fuhm.net (James Y Knight)
Date: Tue, 9 Dec 2008 12:10:45 -0500
Subject: [Twisted-Python] Deferred question
In-Reply-To: <493E35B6.7030509@arimaz.com>
References: <493CE88D.3070507@arimaz.com> <493E35B6.7030509@arimaz.com>
Message-ID: <A11A7114-B968-4404-8C36-E43A51E55F1B@fuhm.net>

On Dec 9, 2008, at 4:09 AM, Gabriel Rossetti wrote:
> Forget it, I monkey-patched defer.Deferred to add __del__ to see if  
> it was called, and it was, so they are getting destroyed...

BTW, that is not a good way to tell if objects are being deleted.  
Simply the act of adding a __del__ to an object can *cause* it to be  
not collected, due to the way python's GC works. Luckily that was not  
the case here. :) A better method to tell if objects are being  
collected is to create a list of weakrefs (with callbacks to print a  
message, say) to the objects.

James



From exarkun at divmod.com  Tue Dec  9 11:41:20 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 9 Dec 2008 13:41:20 -0500
Subject: [Twisted-Python] How to see the number of received msgs?
In-Reply-To: <493E98F0.4050000@arimaz.com>
Message-ID: <20081209184120.20272.949979324.divmod.quotient.18545@ohm>

On Tue, 09 Dec 2008 17:12:32 +0100, Gabriel Rossetti <gabriel.rossetti at arimaz.com> wrote:
>tarjei wrote:
>>-----BEGIN PGP SIGNED MESSAGE-----
>>Hash: SHA1
>>
>>Gabriel Rossetti wrote:
>>
>>>Hello eveyone,
>>>
>>>is there a way to see how many msgs have been received and are waiting
>>>to be processed by a client?
>>>
>>Hi, I think you need to be far more specific if you want an answer.
>>Which protocol is this for example?
>>
>TCP, but I assuming that Twisted gets stuff from the OS's buffer and puts it 
>in it's own buffer, this may not be the case though, if it's not then my 
>question makes no sense.

The TCP transport implementation in Twisted calls the protocol's dataReceived
method *immediately* with any bytes it receives.  In other words, received
data is never buffered.  So the answer to your question is that the number
is always zero.

Additionally, TCP has no notion of messages.  There's just a stream of bytes
from which arbitrarily short or long sequences of bytes may be read.

Jean-Paul



From phil at bubblehouse.org  Tue Dec  9 13:43:00 2008
From: phil at bubblehouse.org (Phil Christensen)
Date: Tue, 9 Dec 2008 15:43:00 -0500
Subject: [Twisted-Python] spawnProcess help needed
Message-ID: <8ACAACEC-AA5D-4BA1-B291-188D7D8F5F45@bubblehouse.org>

Hello All-

I'm running into an issue with a project I'm working on that involves  
coordinating a large number of external processes to encode audio into  
different formats, and do other bookkeeping.

I seem to be having a problem when I use spawnProcess to call the  
md5sum binary. The processes spawned seem to stick around forever,  
until I kill the server. This doesn't appear to happen with any other  
binary.

I start with the following abstract class:

     class DefaultProcessProtocol(protocol.ProcessProtocol):
         def __init__(self, preserveOut=True, preserveErr=True):
             self.deferred = defer.Deferred()
             self.debug = False
             self.preserveOut = preserveOut
             self.out = ''
             self.preserveErr = preserveErr
             self.err = ''

         def connectionMade(self):
             if(self.debug):
                 print '%s connection made' % self.__class__.__name__

         def outReceived(self, data):
             if(self.debug):
                 print '%s stdout: %s' % (self.__class__.__name__, data)
             if(self.preserveOut):
                 self.out += data

         def errReceived(self, data):
             if(self.debug):
                 print '%s stderr: %s' % (self.__class__.__name__, data)
             if(self.preserveErr):
                 self.err += data

         def processEnded(self, status):
             if(isinstance(status.value, error.ProcessDone)):
                 self.deferred.callback(self)
             else:
                 if(self.out):
                     print self.out
                 if(self.err):
                     print self.err
                 self.deferred.errback(status.value)

Then I made a subclass as follows:

     class MD5Checksum(DefaultProcessProtocol):
         @staticmethod
         def run(target, md5_path='/usr/bin/md5sum'):
             hasher = MD5Checksum(preserveOut=True)
             hasher.debug = True
             reactor.spawnProcess(hasher, md5_path, [md5_path, target])
             return hasher.deferred

         def get_checksum(self):
             filehash = self.out
             if(filehash.find('=') == -1):
                 filehash = [output.strip() for output in  
filehash.split(' ')][0]
             else:
                 filehash = [output.strip() for output in  
filehash.split('=')][1]
             return filehash

With the plan of executing it inside an inlineCallbacks-decorated  
function, like this:

         proto = yield process.MD5Checksum.run(filename)
         checksum = proto.get_checksum()

Everything is basically working, except for the fact that the md5sum  
processes never go away. It does seem that processEnded is being  
called, since that's what issues the callback on the deferred returned  
by run(), but the process sticks around, as a non-zombie, non-defunct  
process that still appears to be using small amounts of CPU time.

Also, once the checksum has been retrieved, killing the server doesn't  
cause any errors, unlike when a process is legitimately terminated by  
killing the server, which displays an error (since right now i'm not  
actually catching ProcessTerminated scenarios):

     2008-12-09 15:17:48-0500 [-] Unhandled error in Deferred:
     2008-12-09 15:17:48-0500 [-] Unhandled Error
         Traceback (most recent call last):
         Failure: twisted.internet.error.ProcessTerminated: A process  
has ended with a probable
     error condition: process ended by signal 2.

Any help in this matter would be appreciated...

-phil





From ms at cerenity.org  Tue Dec  9 15:06:36 2008
From: ms at cerenity.org (Michael)
Date: Tue, 9 Dec 2008 22:06:36 +0000
Subject: [Twisted-Python] PDF I thought may be of interest
Message-ID: <200812092206.37080.ms@cerenity.org>

Hi,


I came across this livejournal entry today:
   * http://four.livejournal.com/934085.html

Which has this link:
http://s3.amazonaws.com/four.livejournal/20081209/threads-hotos-2003.pdf

.. which is a paper by Rob von Behren, Jeremy Condit and Eric Brewer. I 
personally raised an eyebrow when I saw that because Eric Brewer was the CTO 
of Inktomi, who back the had a very highly scaleable network system called 
Traffic Server amongst other things (I worked at Inktomi between 2000 & 2002, 
which is why I recognised the name).

Traffic Server's architecture was in many respects reactor based, and in many 
respects it's architecture and twisted's architecture weren't *massively* 
different. OK, TS was written in C++, and twisted is python, but a reactor 
approach is still a reactor approach.

Specifically I found this part particularly surprising:

Abstract
    Event-based programming has been highly touted in recent years as the best
    way to write highly concurrent applications. Having worked on several of
    these systems, we now believe this approach to be a mistake. Specifically,
    we believe that threads can achieve all of the strengths of events,
    including support for high concurrency, low overhead, and a simple
    concurrency model.

The paper appears to be 5 years old already, so the impact of this paper
appears minimal, but I thought it may be of interest to others. (The reason it 
raised such a surprise for me is because it would be as surprising to me as 
it would be to read of any of the core twisted devs to suddenly come out in 
favour of a threading approach rather than non-threading!)

Looking slightly below the surface of things, it appears to be advocating 
something more like stackless's tasklets, rather than OS level threads (since 
it makes reference near the end to Erlang's threading model).

Either why, hopefully interesting :)

Regards,


Michael
-- 
http://yeoldeclue.com/blog




From glyph at divmod.com  Tue Dec  9 15:31:50 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 09 Dec 2008 22:31:50 -0000
Subject: [Twisted-Python] PDF I thought may be of interest
In-Reply-To: <200812092206.37080.ms@cerenity.org>
References: <200812092206.37080.ms@cerenity.org>
Message-ID: <20081209223150.12555.1951446483.divmod.xquotient.1902@weber.divmod.com>

On 10:06 pm, ms at cerenity.org wrote:
>Looking slightly below the surface of things, it appears to be 
>advocating
>something more like stackless's tasklets, rather than OS level threads 
>(since
>it makes reference near the end to Erlang's threading model).

Yes, and for this reason I found the paper to be somewhat disingenuous. 
It pops up every so often.

For one thing, it doesn't mention the extreme difficulty of writing 
correct threaded code that manages shared state.  There is a brief nod 
to this, where they say "Although static detection of race conditions is 
challenging"... then they go on to say maybe it's possible if you do 
some whole-program analysis, completely disregarding the unsuitability 
of whole-program analysis to long-lived, dynamic server systems 
(arguably the most popular choice for highly concurrent systems) which 
often require live, and therefore modular, updates.

Simplicity is Twisted's main advantage - obviously if we were 
performance-obsessed Python would be a poor choice for an implementation 
language, and all the paper really talks about is performance.  It's 
easier to write *correct* code in an event-driven model because 
everything that's happening is obvious once you understand what's going 
on.  I've often spotted concurrency problems in Twisted just in a code 
review.  In a threaded program, even if you're a threading expert, it's 
very very easy to miss subtle concurrency bugs.

For another, the paper arbitrarily redefines the word "threads" to mean 
"this cool thing that doesn't exist yet", rather than existing things 
that people call "threads".  It specifically mentions the deficiencies 
of current thread implementations and does not always point to specific 
improvements, let alone the challenge of popularizing and deploying 
those improvements.  The comparison to erlang's concurrency model is 
interesting, since they specifically avoid the term "threads" - erlang 
calls them "processes" to avoid exactly the confusion the authors are 
attempting to create.

So, in the fantasy world the authors have constructed, where threads are 
different than what we call "threads", they might be better than 
"events" for high-concurrency systems.  I'm probably even glad they 
chose the misleading, but controversial, title to draw attention to 
their work, because I think those ideas are interesting (if impractical) 
and I'm glad I read about them.



From exarkun at divmod.com  Tue Dec  9 15:41:53 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 9 Dec 2008 17:41:53 -0500
Subject: [Twisted-Python] spawnProcess help needed
In-Reply-To: <8ACAACEC-AA5D-4BA1-B291-188D7D8F5F45@bubblehouse.org>
Message-ID: <20081209224153.20272.1558664437.divmod.quotient.18653@ohm>

On Tue, 9 Dec 2008 15:43:00 -0500, Phil Christensen <phil at bubblehouse.org> wrote:
>Hello All-
>
>I'm running into an issue with a project I'm working on that involves 
>coordinating a large number of external processes to encode audio into 
>different formats, and do other bookkeeping.
>
>I seem to be having a problem when I use spawnProcess to call the  md5sum 
>binary. The processes spawned seem to stick around forever,  until I kill 
>the server. This doesn't appear to happen with any other  binary.
>
>I start with the following abstract class:
>
> [snip MD5Checksum ProcessProtocol]
>
>With the plan of executing it inside an inlineCallbacks-decorated  function, 
>like this:
>
>         proto = yield process.MD5Checksum.run(filename)
>         checksum = proto.get_checksum()
>
>Everything is basically working, except for the fact that the md5sum 
>processes never go away. It does seem that processEnded is being  called, 
>since that's what issues the callback on the deferred returned  by run(), 
>but the process sticks around, as a non-zombie, non-defunct  process that 
>still appears to be using small amounts of CPU time.

processEnded shouldn't be called until the child has exited and been
reaped.  This means that the md5sum process should not still exist in
any form if processEnded is being called.  So either the processes you're
seeing aren't associated with the ProcessProtocol instances you think, or
there's a pretty serious bug in Twisted. :)

A self-contained example of this behavior would be pretty handy.  You should
probably start by making sure processEnded is really being called for the
ProcessProtocol instances associated with the processes which aren't actually
exiting.

>
>Also, once the checksum has been retrieved, killing the server doesn't 
>cause any errors, unlike when a process is legitimately terminated by 
>killing the server, which displays an error (since right now i'm not 
>actually catching ProcessTerminated scenarios):
>
>     2008-12-09 15:17:48-0500 [-] Unhandled error in Deferred:
>     2008-12-09 15:17:48-0500 [-] Unhandled Error
>         Traceback (most recent call last):
>         Failure: twisted.internet.error.ProcessTerminated: A process  has 
>ended with a probable
>     error condition: process ended by signal 2.
>
>Any help in this matter would be appreciated...
>

Jean-Paul



From ian at ambientdivide.com  Tue Dec  9 16:27:00 2008
From: ian at ambientdivide.com (Ian Jones)
Date: Tue, 9 Dec 2008 15:27:00 -0800
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
Message-ID: <79190bba0812091527h6ce8090eld8a302f7c62e6553@mail.gmail.com>

I'm trying to create a taskbar app (in wxpython) to monitor job
progress on a render farm. I'd like the taskbar app to have an xmlrpc
server built in so that other applications can inform the taskbar app
additional jobs to monitor.

I found this recipe online which is a great example of the functionality I want:

http://code.activestate.com/recipes/298985/

However when I run the following

from xmlrpclib import *
s = ServerProxy('http://localhost:7080') # Get access to xmlrpc server
s.title('Hallo xmlrpc app')

I don't get a response (though the title in the window changes - so I
know it got it)

I do get this though:

Traceback (most recent call last):
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\protocols\basic.py",
line 239, in dataReceived
    return self.rawDataReceived(data)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\http.py",
line 1117, in rawDataReceived
    self.allContentReceived()
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\http.py",
line 1108, in allContentReceived
    req.requestReceived(command, path, version)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\http.py",
line 626, in requestReceived
    self.process()
--- <exception caught here> ---
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\server.py",
line 150, in process
    self.render(resrc)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\server.py",
line 157, in render
    body = resrc.render(self)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\resource.py",
line 189, in render
    return m(request)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 122, in render_POST
    function = self._getFunction(functionPath)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 170, in _getFunction
    handler = self.getSubHandler(prefix)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 107, in getSubHandler
    return self.subHandlers.get(prefix, None)
exceptions.AttributeError: 'MyXMLRPCApp' object has no attribute 'subHandlers'
Unhandled error in Deferred:
Traceback (most recent call last):
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\resource.py",
line 189, in render
    return m(request)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 126, in render_POST
    defer.maybeDeferred(function, *args).addErrback(
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\internet\defer.py",
line 195, in addCallback
    callbackKeywords=kw)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\internet\defer.py",
line 186, in addCallbacks
    self._runCallbacks()
--- <exception caught here> ---
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\internet\defer.py",
line 328, in _runCallbacks
    self.result = callback(self.result, *args, **kw)
  File "d:\toolkit\sww\win32\python\2.4\lib\site-packages\twisted-8.1.0-py2.4-win32.egg\twisted\web\xmlrpc.py",
line 144, in _cbRender
    allow_none=self.allowNone)
exceptions.AttributeError: 'MyXMLRPCApp' object has no attribute 'allowNone'

I'm assuming this is just a good example that is out of date. However
I'm not sure how to update it so that it works. Can someone help me
out?



From exarkun at divmod.com  Tue Dec  9 17:08:19 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 9 Dec 2008 19:08:19 -0500
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
In-Reply-To: <79190bba0812091527h6ce8090eld8a302f7c62e6553@mail.gmail.com>
Message-ID: <20081210000819.20272.1103441225.divmod.quotient.18694@ohm>

On Tue, 9 Dec 2008 15:27:00 -0800, Ian Jones <ian at ambientdivide.com> wrote:
>I'm trying to create a taskbar app (in wxpython) to monitor job
>progress on a render farm. I'd like the taskbar app to have an xmlrpc
>server built in so that other applications can inform the taskbar app
>additional jobs to monitor.
>
>I found this recipe online which is a great example of the functionality I want:
>
>http://code.activestate.com/recipes/298985/
>
>However when I run the following
>
> [snip]
>
>I'm assuming this is just a good example that is out of date. However
>I'm not sure how to update it so that it works. Can someone help me
>out?

It looks like the direct cause of the problem is that the XMLRPC subclass
in the example prevents XMLRPC.__init__ from being invoked.  It seems to
be doing this by subclassing both wx.App and XMLRPC.  There's probably
no good reason to subclass both of these, and in this case it's causing a
problem, as presumably wx.App has an __init__ which is getting in the way.

Jean-Paul



From alecf at metaweb.com  Tue Dec  9 17:41:50 2008
From: alecf at metaweb.com (Alec Flett)
Date: Tue, 9 Dec 2008 16:41:50 -0800
Subject: [Twisted-Python] lost tracebacks?
Message-ID: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>

So I am constantly "losing" my tracebacks when my defer's callbacks  
throw exceptions that aren't caught. When I get an uncaught exception  
(caught via twisted.log.addObserver()) I am basically storing the  
Failure instance and then later, when it's safe for me to do so,  
calling fail.raiseException() - but the Failure's 'tb' property is None.

I traced this down to the code in Deferred._runCallbacks() which does  
a try: / except: with::

     self.result = failure.Failure()

Seems like this code should say::

     exc_type, exc_value, exc_traceback = sys.exc_info()
     self.result = failure.Failure(exc_value, exc_type, exc_traceback)


I'm dealing with two issues:
1) trying to generically log stack traces that happen
2) provide sane stack traces to my team who is fairly new to twisted

I can see how this might possibly leak if the tracebacks are holding  
onto references to local variables or something, but maybe  
cleanFailure() fixes that? I don't know.

Alec



From glyph at divmod.com  Tue Dec  9 18:29:22 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Wed, 10 Dec 2008 01:29:22 -0000
Subject: [Twisted-Python] lost tracebacks?
In-Reply-To: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>
References: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>
Message-ID: <20081210012922.12555.1049608548.divmod.xquotient.1986@weber.divmod.com>

On 12:41 am, alecf at metaweb.com wrote:
>I traced this down to the code in Deferred._runCallbacks() which does 
>a try: / except: with::
>
>     self.result = failure.Failure()
>
>Seems like this code should say::
>
>     exc_type, exc_value, exc_traceback = sys.exc_info()
>     self.result = failure.Failure(exc_value, exc_type, exc_traceback)

Those are basically equivalent.  Observe:
>>>from twisted.python.failure import Failure
>>>try:
...  1/0
... except:
...  f = Failure()
...
>>>f.printTraceback()
Traceback (most recent call last):
--- <exception caught here> ---
  File "<stdin>", line 2, in <module>

exceptions.ZeroDivisionError: integer division or modulo by zero

Note how it remembers the line number in the traceback.  Your traceback 
must be getting lost for some other reason.



From gabriel.rossetti at arimaz.com  Wed Dec 10 00:27:17 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Wed, 10 Dec 2008 08:27:17 +0100
Subject: [Twisted-Python] How to see the number of received msgs?
In-Reply-To: <20081209184120.20272.949979324.divmod.quotient.18545@ohm>
References: <20081209184120.20272.949979324.divmod.quotient.18545@ohm>
Message-ID: <493F6F55.9010003@arimaz.com>

Jean-Paul Calderone wrote:
> On Tue, 09 Dec 2008 17:12:32 +0100, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com> wrote:
>> tarjei wrote:
>>> -----BEGIN PGP SIGNED MESSAGE-----
>>> Hash: SHA1
>>>
>>> Gabriel Rossetti wrote:
>>>
>>>> Hello eveyone,
>>>>
>>>> is there a way to see how many msgs have been received and are waiting
>>>> to be processed by a client?
>>>>
>>> Hi, I think you need to be far more specific if you want an answer.
>>> Which protocol is this for example?
>>>
>> TCP, but I assuming that Twisted gets stuff from the OS's buffer and 
>> puts it in it's own buffer, this may not be the case though, if it's 
>> not then my question makes no sense.
>
> The TCP transport implementation in Twisted calls the protocol's 
> dataReceived
> method *immediately* with any bytes it receives.  In other words, 
> received
> data is never buffered.  So the answer to your question is that the 
> number
> is always zero.
>
Ok, thank you.
> Additionally, TCP has no notion of messages.  There's just a stream of 
> bytes
> from which arbitrarily short or long sequences of bytes may be read.
>
yes, true.
> Jean-Paul





From gabriel.rossetti at arimaz.com  Wed Dec 10 00:28:22 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Wed, 10 Dec 2008 08:28:22 +0100
Subject: [Twisted-Python] Deferred question
In-Reply-To: <A11A7114-B968-4404-8C36-E43A51E55F1B@fuhm.net>
References: <493CE88D.3070507@arimaz.com> <493E35B6.7030509@arimaz.com>
	<A11A7114-B968-4404-8C36-E43A51E55F1B@fuhm.net>
Message-ID: <493F6F96.7000902@arimaz.com>

James Y Knight wrote:
> On Dec 9, 2008, at 4:09 AM, Gabriel Rossetti wrote:
>> Forget it, I monkey-patched defer.Deferred to add __del__ to see if 
>> it was called, and it was, so they are getting destroyed...
>
> BTW, that is not a good way to tell if objects are being deleted. 
> Simply the act of adding a __del__ to an object can *cause* it to be 
> not collected, due to the way python's GC works. Luckily that was not 
> the case here. :) A better method to tell if objects are being 
> collected is to create a list of weakrefs (with callbacks to print a 
> message, say) to the objects.
>
> James
>
Thank you for the tip James!

Gabriel



From phil at bubblehouse.org  Wed Dec 10 09:45:24 2008
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed, 10 Dec 2008 11:45:24 -0500
Subject: [Twisted-Python] spawnProcess help needed
In-Reply-To: <20081209224153.20272.1558664437.divmod.quotient.18653@ohm>
References: <20081209224153.20272.1558664437.divmod.quotient.18653@ohm>
Message-ID: <39F280F6-A810-4B22-AC2A-758D72DAE4AE@bubblehouse.org>

On Dec 9, 2008, at 5:41 PM, Jean-Paul Calderone wrote:
> On Tue, 9 Dec 2008 15:43:00 -0500, Phil Christensen <phil at bubblehouse.org 
> > wrote:
>> Everything is basically working, except for the fact that the  
>> md5sum processes never go away. It does seem that processEnded is  
>> being  called, since that's what issues the callback on the  
>> deferred returned  by run(), but the process sticks around, as a  
>> non-zombie, non-defunct  process that still appears to be using  
>> small amounts of CPU time.
>
> processEnded shouldn't be called until the child has exited and been
> reaped.  This means that the md5sum process should not still exist in
> any form if processEnded is being called.  So either the processes  
> you're
> seeing aren't associated with the ProcessProtocol instances you  
> think, or
> there's a pretty serious bug in Twisted. :)


Well,  it looks like I was wrong, and the processes do go away,  
although they take awhile. This isn't that surprising, since I'm  
seeing 10-15 md5 processes happening in parallel, and they're  
checksumming relatively large (~150MB) WAV files.

It ended up being all because of a dumb mistake. Thanks for the help,  
though.

-phil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081210/e406d174/attachment.html>

From ian at ambientdivide.com  Wed Dec 10 09:54:49 2008
From: ian at ambientdivide.com (Ian Jones)
Date: Wed, 10 Dec 2008 08:54:49 -0800
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
In-Reply-To: <20081210000819.20272.1103441225.divmod.quotient.18694@ohm>
References: <79190bba0812091527h6ce8090eld8a302f7c62e6553@mail.gmail.com>
	<20081210000819.20272.1103441225.divmod.quotient.18694@ohm>
Message-ID: <79190bba0812100854j1eaf559s8f67655e5bb8b884@mail.gmail.com>

"There's probably no good reason to subclass both of these"

I'm relatively new to python so sorry if this should be obvious - but
how else would I get the functionality of both classes if I did
subclass both of them?

Ian


On Tue, Dec 9, 2008 at 4:08 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Tue, 9 Dec 2008 15:27:00 -0800, Ian Jones <ian at ambientdivide.com> wrote:
>>
>> I'm trying to create a taskbar app (in wxpython) to monitor job
>> progress on a render farm. I'd like the taskbar app to have an xmlrpc
>> server built in so that other applications can inform the taskbar app
>> additional jobs to monitor.
>>
>> I found this recipe online which is a great example of the functionality I
>> want:
>>
>> http://code.activestate.com/recipes/298985/
>>
>> However when I run the following
>>
>> [snip]
>>
>> I'm assuming this is just a good example that is out of date. However
>> I'm not sure how to update it so that it works. Can someone help me
>> out?
>
> It looks like the direct cause of the problem is that the XMLRPC subclass
> in the example prevents XMLRPC.__init__ from being invoked.  It seems to
> be doing this by subclassing both wx.App and XMLRPC.  There's probably
> no good reason to subclass both of these, and in this case it's causing a
> problem, as presumably wx.App has an __init__ which is getting in the way.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From ian at ambientdivide.com  Wed Dec 10 09:55:36 2008
From: ian at ambientdivide.com (Ian Jones)
Date: Wed, 10 Dec 2008 08:55:36 -0800
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
In-Reply-To: <79190bba0812100854j1eaf559s8f67655e5bb8b884@mail.gmail.com>
References: <79190bba0812091527h6ce8090eld8a302f7c62e6553@mail.gmail.com>
	<20081210000819.20272.1103441225.divmod.quotient.18694@ohm>
	<79190bba0812100854j1eaf559s8f67655e5bb8b884@mail.gmail.com>
Message-ID: <79190bba0812100855v570c2416xbd4e3834be591007@mail.gmail.com>

didn't subclass both of them rather.


On Wed, Dec 10, 2008 at 8:54 AM, Ian Jones <ian at ambientdivide.com> wrote:
> "There's probably no good reason to subclass both of these"
>
> I'm relatively new to python so sorry if this should be obvious - but
> how else would I get the functionality of both classes if I did
> subclass both of them?
>
> Ian
>
>
> On Tue, Dec 9, 2008 at 4:08 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
>> On Tue, 9 Dec 2008 15:27:00 -0800, Ian Jones <ian at ambientdivide.com> wrote:
>>>
>>> I'm trying to create a taskbar app (in wxpython) to monitor job
>>> progress on a render farm. I'd like the taskbar app to have an xmlrpc
>>> server built in so that other applications can inform the taskbar app
>>> additional jobs to monitor.
>>>
>>> I found this recipe online which is a great example of the functionality I
>>> want:
>>>
>>> http://code.activestate.com/recipes/298985/
>>>
>>> However when I run the following
>>>
>>> [snip]
>>>
>>> I'm assuming this is just a good example that is out of date. However
>>> I'm not sure how to update it so that it works. Can someone help me
>>> out?
>>
>> It looks like the direct cause of the problem is that the XMLRPC subclass
>> in the example prevents XMLRPC.__init__ from being invoked.  It seems to
>> be doing this by subclassing both wx.App and XMLRPC.  There's probably
>> no good reason to subclass both of these, and in this case it's causing a
>> problem, as presumably wx.App has an __init__ which is getting in the way.
>>
>> Jean-Paul
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>



From exarkun at divmod.com  Wed Dec 10 10:04:06 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 10 Dec 2008 12:04:06 -0500
Subject: [Twisted-Python] wxpython and xmlrpc via twisted
In-Reply-To: <79190bba0812100854j1eaf559s8f67655e5bb8b884@mail.gmail.com>
Message-ID: <20081210170406.20272.457531719.divmod.quotient.19083@ohm>

On Wed, 10 Dec 2008 08:54:49 -0800, Ian Jones <ian at ambientdivide.com> wrote:
>"There's probably no good reason to subclass both of these"
>
>I'm relatively new to python so sorry if this should be obvious - but
>how else would I get the functionality of both classes if I did
>subclass both of them?

Create two classes and let instances of one keep references to an instance
of the other.  For example, in this case, you might have a wx.App subclass
with the OnInit method defined in the example and a different XMLRPC
subclass with a reference to instances of the first class.  Then, instead
of doing `self.frame.Close()´ or `self.frame.SetTitle(x)´, it would do
`self.appObj.frame.Close()´ or `self.appObj.frame.SetTitle(x)´.

Jean-Paul



From cary.hull at gmail.com  Wed Dec 10 10:27:49 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Wed, 10 Dec 2008 09:27:49 -0800
Subject: [Twisted-Python] spawnProcess help needed
In-Reply-To: <39F280F6-A810-4B22-AC2A-758D72DAE4AE@bubblehouse.org>
References: <20081209224153.20272.1558664437.divmod.quotient.18653@ohm>
	<39F280F6-A810-4B22-AC2A-758D72DAE4AE@bubblehouse.org>
Message-ID: <3fce0ae70812100927j1a6681e1w9d763eac095afc67@mail.gmail.com>

Just an fyi, you don't need to code your own process protocol for
programs like md5sum. Take a look at
twisted.internet.utils.getProcessOutput.

-Cary

On Wed, Dec 10, 2008 at 8:45 AM, Phil Christensen <phil at bubblehouse.org> wrote:
> On Dec 9, 2008, at 5:41 PM, Jean-Paul Calderone wrote:
>
> On Tue, 9 Dec 2008 15:43:00 -0500, Phil Christensen <phil at bubblehouse.org>
> wrote:
>
> Everything is basically working, except for the fact that the md5sum
> processes never go away. It does seem that processEnded is being  called,
> since that's what issues the callback on the deferred returned  by run(),
> but the process sticks around, as a non-zombie, non-defunct  process that
> still appears to be using small amounts of CPU time.
>
> processEnded shouldn't be called until the child has exited and been
> reaped.  This means that the md5sum process should not still exist in
> any form if processEnded is being called.  So either the processes you're
> seeing aren't associated with the ProcessProtocol instances you think, or
> there's a pretty serious bug in Twisted. :)
>
> Well,  it looks like I was wrong, and the processes do go away, although
> they take awhile. This isn't that surprising, since I'm seeing 10-15 md5
> processes happening in parallel, and they're checksumming relatively large
> (~150MB) WAV files.
> It ended up being all because of a dumb mistake. Thanks for the help,
> though.
> -phil
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From suchindra at gmail.com  Wed Dec 10 12:02:25 2008
From: suchindra at gmail.com (Suchindra Sandhu)
Date: Wed, 10 Dec 2008 14:02:25 -0500
Subject: [Twisted-Python] Running commands / collecting datas via SSH on
	many machines: Twisted vs plain old scripts ?
In-Reply-To: <84987d20812090055n3282b4e6t329f6d3937a28e72@mail.gmail.com>
References: <84987d20812090055n3282b4e6t329f6d3937a28e72@mail.gmail.com>
Message-ID: <b39d0d980812101102g743d610bue02ee045b7754a5e@mail.gmail.com>

Hi Alessio,

If you have many machines, then running commands via a shell script
for loop quickly gets un-weildly. Especially since some machines could
be slow in responding since they could be busy, faroff etc or it your
command itself takes a long time to complete.

Doing this in twisted will not only give you better resource
allocation, but it will also be easier to get timeouts and such
things. The twisted ssh implementation probably gives you other things
as well, but I am not aware of them.

Hope that helps.

--
/s

On Tue, Dec 9, 2008 at 3:55 AM, Alessio Pace <alessio.pace at gmail.com> wrote:
> Hi,
>
> I have to run commands and (later in time) collect logs from many machines,
> connecting through SSH.
>
> I was _genuinely_ wondering what an SSH client written in Twisted could give
> me more than executing plain old shell scripts in a for loop.
>
> From what I saw, given the fact that my run/collect commands remain still
> shell commands (cp, tar, etc...), the only thing that may change is that
> using Twisted I could have a better utilization of resources rather than a
> simple shell for loop in which I iterate in order over all the machines on
> which I have to issue commands.
>
> Am I missing something? I would like to stress the fact that I'm asking this
> as a very specific question for Twisted usage in the context of
> running/retrieving results on remote machines (as indeed I already happily
> use Twisted for running custom network protocols) and I would right to
> choose a simple but effective solution for this case.
>
> Thanks in advance,
> Alessio Pace.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



From alecf at metaweb.com  Wed Dec 10 13:42:06 2008
From: alecf at metaweb.com (Alec Flett)
Date: Wed, 10 Dec 2008 12:42:06 -0800
Subject: [Twisted-Python] lost tracebacks?
In-Reply-To: <20081210012922.12555.1049608548.divmod.xquotient.1986@weber.divmod.com>
References: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>
	<20081210012922.12555.1049608548.divmod.xquotient.1986@weber.divmod.com>
Message-ID: <C085A466-83DA-40B0-8C90-67264A98EEC0@metaweb.com>

Ah, I found the problem, for anyone else who runs into this...

I am collecting stacks using the logging system's addObserver() -  
trying to access the traceback from a garbage-collected deferred.  
Turns out when the deferred is garbage collected, the failure is  
pickled (to avoid leaks) and so it sets failure.tb to None.

By the time you get it in your log observer and store it for later,  
you can't re-raise the exception with the stack. but  
failure.getTraceback() gave me enough stack to at least debug.

I was hoping for a "real" traceback because Paste's EvalException  
middleware does a nice job debugging "live" stacks, but the 'verbose'  
stack is a pretty decent stand-in.

Alec

On Dec 9, 2008, at 5:29 PM, glyph at divmod.com wrote:

> On 12:41 am, alecf at metaweb.com wrote:
>> I traced this down to the code in Deferred._runCallbacks() which  
>> does a try: / except: with::
>>
>>    self.result = failure.Failure()
>>
>> Seems like this code should say::
>>
>>    exc_type, exc_value, exc_traceback = sys.exc_info()
>>    self.result = failure.Failure(exc_value, exc_type, exc_traceback)
>
> Those are basically equivalent.  Observe:
>>>> from twisted.python.failure import Failure
>>>> try:
> ...  1/0
> ... except:
> ...  f = Failure()
> ...
>>>> f.printTraceback()
> Traceback (most recent call last):
> --- <exception caught here> ---
> File "<stdin>", line 2, in <module>
>
> exceptions.ZeroDivisionError: integer division or modulo by zero
>
> Note how it remembers the line number in the traceback.  Your  
> traceback must be getting lost for some other reason.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From glyph at divmod.com  Wed Dec 10 15:08:52 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Wed, 10 Dec 2008 22:08:52 -0000
Subject: [Twisted-Python] lost tracebacks?
In-Reply-To: <C085A466-83DA-40B0-8C90-67264A98EEC0@metaweb.com>
References: <C10E7B19-E30F-4C61-A8BE-C2324D1379CC@metaweb.com>
	<20081210012922.12555.1049608548.divmod.xquotient.1986@weber.divmod.com>
	<C085A466-83DA-40B0-8C90-67264A98EEC0@metaweb.com>
Message-ID: <20081210220852.12555.1622226472.divmod.xquotient.1994@weber.divmod.com>


On 08:42 pm, alecf at metaweb.com wrote:
>I was hoping for a "real" traceback because Paste's EvalException 
>middleware does a nice job debugging "live" stacks, but the 'verbose' 
>stack is a pretty decent stand-in.

There's a good reason not to hang on to the "real" traceback.  Failures 
with verbose stacktraces can already take up a shocking amount of memory 
(as you can see on this ticket: 
<http://twistedmatrix.com/trac/ticket/2466>).  Actually keeping around 
*all* of the original stack frames means keeping a live reference to 
everything that was on the stack at the time the error happened, which 
can potentially be the entire world.



From exarkun at divmod.com  Wed Dec 10 16:00:57 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 10 Dec 2008 18:00:57 -0500
Subject: [Twisted-Python] lost tracebacks?
In-Reply-To: <20081210220852.12555.1622226472.divmod.xquotient.1994@weber.divmod.com>
Message-ID: <20081210230057.20272.1529721041.divmod.quotient.19207@ohm>

On Wed, 10 Dec 2008 22:08:52 -0000, glyph at divmod.com wrote:
>
>On 08:42 pm, alecf at metaweb.com wrote:
>>I was hoping for a "real" traceback because Paste's EvalException 
>>middleware does a nice job debugging "live" stacks, but the 'verbose' stack 
>>is a pretty decent stand-in.
>
>There's a good reason not to hang on to the "real" traceback.  Failures with 
>verbose stacktraces can already take up a shocking amount of memory (as you 
>can see on this ticket: <http://twistedmatrix.com/trac/ticket/2466>). 
>Actually keeping around *all* of the original stack frames means keeping a 
>live reference to everything that was on the stack at the time the error 
>happened, which can potentially be the entire world.
>

There's also Failure.getTracebackObject which returns something that is API
compatible with a real traceback object except that you can't use it with
`raise´.  I'm not sure if it's good enough for Paste's EvalException, though.

Jean-Paul



From mk.fraggod at gmail.com  Wed Dec 10 18:46:09 2008
From: mk.fraggod at gmail.com (Mike Kazantsev)
Date: Thu, 11 Dec 2008 06:46:09 +0500
Subject: [Twisted-Python] twisted reverse proxy for web filtering
In-Reply-To: <5acf0ea80811301954q6a3f6938o6d7d3d207b1f7719@mail.gmail.com>
References: <5acf0ea80811301954q6a3f6938o6d7d3d207b1f7719@mail.gmail.com>
Message-ID: <20081211064609.620e9fe8@gmail.com>

On Sun, 30 Nov 2008 21:54:17 -0600
"dave fowler" <davefowler at gmail.com> wrote:

> I'd like to use python and in my research I think a twisted reverse proxy is
> what I want.  I've done the examples for setting up a proxy, including one
> that counts the words on the pages you visit, but i cannot find anything on
> fetching the destination and re-directing.  I've been sifting through the
> many classes of the proxy examples and am pretty lost.  Does anyone have
> some example code for something like this?
> 
> Thanks
> 
> Dave

I use following code to add '/trac' child to nevow (twisted.web extension) page with https-only access, mangling 'Location' header of returned answer to prevent redirects to non-existing urls.
You can probably mangle request the same way before passing it to render method, overriding returned headers and/or data afterwards in client class.
I doubt it'll be the fastest solution out there, but it certainly should be quite flexible.




from urllib import quote as urlquote
from twisted.web.proxy import ReverseProxyResource, ProxyClient, ProxyClientFactory


redirect = '<html><head><title>302 Found</title><meta http-equiv="REFRESH" content="0; url=%s"><script>document.write("<style>a {color:#fff;visibility:hidden;}<style>");window.location="%s"</script></head><body><a href="%s">click here</a></body></html>'


class SokLeechFactory(ProxyClientFactory):
	protocol = SokLeech


class SokLeech(ProxyClient):
	def handleHeader(self, key, value):
		'''Wrapper method to mangle Location header to point to original host'''
		if key == 'Location': value = value.replace(self.father.received_headers['host'], self.father.origin)
		ProxyClient.handleHeader(self, key, value)


class SslLinker(ReverseProxyResource):
	'''Wrapper class to inject some mangling into proxy protocol'''
	proxyClientFactoryClass = SokLeechFactory
	def getChild(self, path, request):
		return self.__class__(self.host, self.port, self.path + '/' + urlquote(path, safe=""))
	def render(self, request):
		'''Wrapper method to store host from original request'''
		if not request.isSecure():
			secure_url = 'https://%s:%s%s'%(request.getRequestHostname(), cfg.web.pen.split(':',3)[1], request.uri)
			request.redirect(secure_url)
			request.finish()
			return redirect.replace('%s', secure_url)
		request.origin = request.getRequestHostname()
		ReverseProxyResource.render(self, request)


class Page(LivePage):
	...
	child_trac = SslLinker(self.cfg.trac.host, self.cfg.trac.port, '/svc/trac')
	...


-- 
Mike Kazantsev // fraggod.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20081211/8f5d6f31/attachment.sig>

From alessio.pace at gmail.com  Thu Dec 11 00:41:26 2008
From: alessio.pace at gmail.com (Alessio Pace)
Date: Thu, 11 Dec 2008 08:41:26 +0100
Subject: [Twisted-Python] Running commands / collecting datas via SSH on
	many machines: Twisted vs plain old scripts ?
In-Reply-To: <b39d0d980812101102g743d610bue02ee045b7754a5e@mail.gmail.com>
References: <84987d20812090055n3282b4e6t329f6d3937a28e72@mail.gmail.com>
	<b39d0d980812101102g743d610bue02ee045b7754a5e@mail.gmail.com>
Message-ID: <84987d20812102341n547419faia6071914dd59805f@mail.gmail.com>

On Wed, Dec 10, 2008 at 8:02 PM, Suchindra Sandhu <suchindra at gmail.com>wrote:

> Hi Alessio,
>
> If you have many machines, then running commands via a shell script
> for loop quickly gets un-weildly. Especially since some machines could
> be slow in responding since they could be busy, faroff etc or it your
> command itself takes a long time to complete.
>
> Doing this in twisted will not only give you better resource
> allocation, but it will also be easier to get timeouts and such
> things. The twisted ssh implementation probably gives you other things
> as well, but I am not aware of them.
>
> Hope that helps.


Hi,

yes this confirm my "feeling". The fact is that I don't know if in Twisted I
can easily do ssh proxying, as I use to do now configuring  my
.ssh/ssh_config file.. That's why for simplicity I fell back to plain
scripts calling ssh.

But I would like to switch to Twisted for the aforementioned reasons.

Thanks.
--
Alessio Pace



>
>
> --
> /s
>
> On Tue, Dec 9, 2008 at 3:55 AM, Alessio Pace <alessio.pace at gmail.com>
> wrote:
> > Hi,
> >
> > I have to run commands and (later in time) collect logs from many
> machines,
> > connecting through SSH.
> >
> > I was _genuinely_ wondering what an SSH client written in Twisted could
> give
> > me more than executing plain old shell scripts in a for loop.
> >
> > From what I saw, given the fact that my run/collect commands remain still
> > shell commands (cp, tar, etc...), the only thing that may change is that
> > using Twisted I could have a better utilization of resources rather than
> a
> > simple shell for loop in which I iterate in order over all the machines
> on
> > which I have to issue commands.
> >
> > Am I missing something? I would like to stress the fact that I'm asking
> this
> > as a very specific question for Twisted usage in the context of
> > running/retrieving results on remote machines (as indeed I already
> happily
> > use Twisted for running custom network protocols) and I would right to
> > choose a simple but effective solution for this case.
> >
> > Thanks in advance,
> > Alessio Pace.
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
> >
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081211/134007b6/attachment.html>

From andrewfr_ice at yahoo.com  Thu Dec 11 07:34:24 2008
From: andrewfr_ice at yahoo.com (Andrew Francis)
Date: Thu, 11 Dec 2008 06:34:24 -0800 (PST)
Subject: [Twisted-Python] Re: PDF I thought may be of interest
Message-ID: <159780.57371.qm@web34206.mail.mud.yahoo.com>

Hi Michael and Colleagues:

> .. which is a paper by Rob von Behren, Jeremy Condit and
> Eric Brewer.

As a part of writing "Adventures in Stackless Python/Twisted Integration," I have read "The Why Events are" paper as well as the Ousterhout "Why Threads Are A Bad Idea (for most purposes). 

The "Why Events" paper led me to the Adya et al, "Cooperative task management without manual stack management" and the original Lauer and Needham  "On the duality of operating system structures." I also visited the Schmitt papers on the Reactor pattern. 

>From what I recalled, I preferred the latter three papers because they provide a much better analytic framework for describing the issues. In particular, the Adya provides terminology.

I have two basic sets of take-aways from the paper survey

1) "Events are great papers" state that threads are bad because of A,B, and C. "Threads are great papers" state that events are bad because of X,Y, and Z. As a programmer using these systems, perhaps I should pay special attention to issues A,B,C,X,Y and Z whenever applicable (and by the way papers thanks for telling me C and Y were issues since I didn't know). 

Perhaps out of all this, we can come up with appropriate guidelines for lockless programming?

2) The "Duality" paper argues that messaging passing and procedural systems can be described in terms of each other (bi-simulation?). I found this to be a very powerful way to look at Stackless Python and Twisted's threading models. 

A simple example. 

At the time I presented "Adventures," to avoid deadlock, I ran a reactor protocol instance in its own Stackless thread. This bugged me. It turned out that by replacing channels with deferreds (and doing a little buffering), I could replace the extraneous tasklet. My way of looking at it was, after all, protocol instances/deferreds are just another way of doing continuations... Use them, don't replace them....
 
> Looking slightly below the surface of things, it appears to
> be advocating something more like stackless's tasklets, rather than
> OS level threads (since it makes reference near the end to Erlang's >threading model).

A quote from the paper:

"To evaluate the ability of threads to support high
concurrency, we designed and implemented a simple
(5000 line) user-level cooperative threading package for
Linux. Our thread package uses the coro coroutine
library [15] for minimalist context switching, and it
translates blocking I/O requests to asynchronous requests
internally."

> The paper appears to be 5 years old already, so the impact
> of this paper appears minimal, but I thought it may be of interest to
> others. (The reason it  raised such a surprise for me is because it >would be as surprising to me as it would be to read of any of the core >twisted devs to suddenly come out in  favour of a threading approach >rather than non-threading!)

"The Why Events" is essentially the approach I took in regards to Stackless and Twisted. Right now, I am analyzing Stackless's scheduling model to see if improvements can be made. I feel I have much to learn...

That said, I feel inline callbacks are a step in this direction. As Stackless/PyPy concepts get into mainstream Python, I can see Twisted following in this direction. Already one can see that with stuff like Christopher Armstrong's Corotwine. 

Again, I think the key to incorporate threads and keep to the spirit of Twisted, simplicity and safety, is to come up with some guidelines for lockless programming.

Cheers,
Andrew




      



From fetbiz at gmail.com  Fri Dec 12 17:46:07 2008
From: fetbiz at gmail.com (biziap biziap)
Date: Sat, 13 Dec 2008 08:46:07 +0800
Subject: [Twisted-Python] twisted.mail.relaymanager.MXCalculator.getMX in
	Win32 got problem
Message-ID: <d067ddcf0812121646l20664e7aq9a26d4b9162d25c1@mail.gmail.com>

The problem is that: the UDP listening ports increase rapidly and eventually
come to the end: too many open file in selector.
As many as the hosts you lookup, those UDP ports are still alive. It is very
different from running this script in Linux (gentoo 2.6).
In Linux, the listening UDP port keep only 1 instance no matter how many
lookups .
Try the script below:
------------------------------
from twisted.mail import relaymanager
from twisted.internet import reactor,defer

global MXC
MXC = relaymanager.MXCalculator()
def getMailExchange(host):
    global MXC
    def cbMX(mxRecord):
        print 'Got mxRecord: %s' % mxRecord.name
    return MXC.getMX(host).addCallback(cbMX)

def run():
    d = getMailExchange('gmail.com')
    def next(mxRecord):
        d = getMailExchange('yahoo.com')

    #d.addCallback(next)     ## uncomment the line to increase your UDP
listening ports as many as you want
reactor.callWhenRunning(run)
reactor.run()
--------------------------------------------------

Any hints?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081213/1e6e985e/attachment.html>

From manlio_perillo at libero.it  Sat Dec 13 03:54:05 2008
From: manlio_perillo at libero.it (Manlio Perillo)
Date: Sat, 13 Dec 2008 11:54:05 +0100
Subject: [Twisted-Python] PDF I thought may be of interest
In-Reply-To: <20081209223150.12555.1951446483.divmod.xquotient.1902@weber.divmod.com>
References: <200812092206.37080.ms@cerenity.org>
	<20081209223150.12555.1951446483.divmod.xquotient.1902@weber.divmod.com>
Message-ID: <4943944D.9050509@libero.it>

glyph at divmod.com ha scritto:
> On 10:06 pm, ms at cerenity.org wrote:
> [...]
> 
> For another, the paper arbitrarily redefines the word "threads" to mean 
> "this cool thing that doesn't exist yet", rather than existing things 
> that people call "threads".  It specifically mentions the deficiencies 
> of current thread implementations and does not always point to specific 
> improvements, let alone the challenge of popularizing and deploying 
> those improvements.  The comparison to erlang's concurrency model is 
> interesting, since they specifically avoid the term "threads" - erlang 
> calls them "processes" to avoid exactly the confusion the authors are 
> attempting to create.
> 

The reason Erlang calls them "processes" is because in Erlang each 
"thread of execution" share nothings with other "threads of execution".

Haskell, as an example, has "micro threads" support, and it calls them 
threads (or "Haskell threads"), since the state is shared (but the 
function that creates a new "thread" is called forkIO, with an 
additional function forkOS, that creates a thread bound to an OS thread).

Haskell also have nice synchronization support, MVar and Chan (with 
equivalent functions based on STM).
Something similar is found in Stackless Python.


As a final note, there is an interesting paper:
http://www.cis.upenn.edu/~lipeng/homepage/unify.html




Regards   Manlio Perillo



From mithrandi at mithrandi.net  Sat Dec 13 08:16:49 2008
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Sat, 13 Dec 2008 17:16:49 +0200
Subject: [Twisted-Python] PDF I thought may be of interest
In-Reply-To: <4943944D.9050509@libero.it>
References: <200812092206.37080.ms@cerenity.org>
	<20081209223150.12555.1951446483.divmod.xquotient.1902@weber.divmod.com>
	<4943944D.9050509@libero.it>
Message-ID: <20081213151649.GA31756@mithrandi.net>

* Manlio Perillo <manlio_perillo at libero.it> [2008-12-13 11:54:05 +0100]:

> glyph at divmod.com ha scritto:
>
>> For another, the paper arbitrarily redefines the word "threads" to mean 
>> "this cool thing that doesn't exist yet", rather than existing things  
>> that people call "threads".  It specifically mentions the deficiencies  
>> of current thread implementations and does not always point to specific 
>> improvements, let alone the challenge of popularizing and deploying  
>> those improvements.  The comparison to erlang's concurrency model is  
>> interesting, since they specifically avoid the term "threads" - erlang  
>> calls them "processes" to avoid exactly the confusion the authors are  
>> attempting to create.
>>
>
> The reason Erlang calls them "processes" is because in Erlang each  
> "thread of execution" share nothings with other "threads of execution".
>
> Haskell, as an example, has "micro threads" support, and it calls them  
> threads (or "Haskell threads"), since the state is shared (but the  
> function that creates a new "thread" is called forkIO, with an  
> additional function forkOS, that creates a thread bound to an OS thread).

There isn't any sharing of *mutable* state, though, unless you
explicitly share it, so this is a lot more similar to Erlang processes
than to Python threads.
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20081213/1e7d8835/attachment.sig>

From erik at erikwickstrom.com  Sat Dec 13 11:08:43 2008
From: erik at erikwickstrom.com (Erik Wickstrom)
Date: Sat, 13 Dec 2008 10:08:43 -0800
Subject: [Twisted-Python] Non-blocking http client?
Message-ID: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>

Hi all,

I have an application that is doing some web spidering.  Right now I'm
using urllib to retrieve the URLs, but it is painfully slow.  I was
wondering if it's feasible to swap out urllib with a twisted client
that uses deferds so I can process urls in a more "parallel" fashion?

I've done a bunch of Googleing, but I haven't come across anything
that I can use as a drop in replacement.   If you can point me in the
right direction I'd really appreciate it!

Thanks for your help!
Erik



From exarkun at divmod.com  Sat Dec 13 12:14:38 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 13 Dec 2008 14:14:38 -0500
Subject: [Twisted-Python] twisted.mail.relaymanager.MXCalculator.getMX
	in Win32 got problem
In-Reply-To: <d067ddcf0812121646l20664e7aq9a26d4b9162d25c1@mail.gmail.com>
Message-ID: <20081213191438.20272.1880981667.divmod.quotient.20565@ohm>

On Sat, 13 Dec 2008 08:46:07 +0800, biziap biziap <fetbiz at gmail.com> wrote:
>The problem is that: the UDP listening ports increase rapidly and eventually
>come to the end: too many open file in selector.
>As many as the hosts you lookup, those UDP ports are still alive. It is very
>different from running this script in Linux (gentoo 2.6).
>In Linux, the listening UDP port keep only 1 instance no matter how many
>lookups .
>Try the script below:

This may be due to <http://twistedmatrix.com/trac/ticket/970>.

Jean-Paul



From exarkun at divmod.com  Sat Dec 13 12:17:07 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 13 Dec 2008 14:17:07 -0500
Subject: [Twisted-Python] Non-blocking http client?
In-Reply-To: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
Message-ID: <20081213191707.20272.2096389468.divmod.quotient.20568@ohm>

On Sat, 13 Dec 2008 10:08:43 -0800, Erik Wickstrom <erik at erikwickstrom.com> wrote:
>Hi all,
>
>I have an application that is doing some web spidering.  Right now I'm
>using urllib to retrieve the URLs, but it is painfully slow.  I was
>wondering if it's feasible to swap out urllib with a twisted client
>that uses deferds so I can process urls in a more "parallel" fashion?
>
>I've done a bunch of Googleing, but I haven't come across anything
>that I can use as a drop in replacement.   If you can point me in the
>right direction I'd really appreciate it!

There is no drop-in replacement.  There is an HTTP client in Twisted,
`twisted.web.client´.  There is also a more featureful HTTP client in
development but not yet available in a release of Twisted.  You can
find an example of how to use the former in the Twisted Web examples,
<http://twistedmatrix.com/projects/web/documentation/examples/>, and
you can follow progress of the latter at <http://twistedmatrix.com/trac/ticket/886>.

Jean-Paul



From andreas at kostyrka.org  Sat Dec 13 17:21:51 2008
From: andreas at kostyrka.org (Andreas Kostyrka)
Date: Sun, 14 Dec 2008 01:21:51 +0100
Subject: [Twisted-Python] Non-blocking http client?
In-Reply-To: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
References: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
Message-ID: <20081214002151.GA32520@hell.kostyrka.org>

On Sat, Dec 13, 2008 at 10:08:43AM -0800, Erik Wickstrom wrote:
> Hi all,
> 
> I have an application that is doing some web spidering.  Right now I'm
> using urllib to retrieve the URLs, but it is painfully slow.  I was
> wondering if it's feasible to swap out urllib with a twisted client
> that uses deferds so I can process urls in a more "parallel" fashion?
> 
> I've done a bunch of Googleing, but I haven't come across anything
> that I can use as a drop in replacement.   If you can point me in the
> right direction I'd really appreciate it!

Well, twisted.web.client is your path to DoS fame. Actually, if you are intenting to use it for
spidering 3rd party websites, I'd recommend a small dispatcher object that limits the number of concurrent connections per target 
server.

Andreas

> 
> Thanks for your help!
> Erik
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From exarkun at twistedmatrix.com  Sat Dec 13 22:05:11 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 14 Dec 2008 05:05:11 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1229231111.29.537321988@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081214/e153942b/attachment.html>

From denis.bilenko at gmail.com  Sun Dec 14 10:58:58 2008
From: denis.bilenko at gmail.com (Denis Bilenko)
Date: Sun, 14 Dec 2008 23:58:58 +0600
Subject: [Twisted-Python] Non-blocking http client?
In-Reply-To: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
References: <3d381e170812131008m993e220jd586d63097d1b192@mail.gmail.com>
Message-ID: <95d6e98c0812140958r2669362bia9489b3032ef41b2@mail.gmail.com>

I've been working on eventlet-twisted integration and it includes a drop-in
replacements for standard Python modules (including urllib and httplib) that
do not block the reactor.

There was no release yet and there're no documentation written.
(You can find the documentation for the original eventlet here
http://wiki.secondlife.com/wiki/Eventlet,
however, not all of it is applicable. You can also read the
documentation of greenlet here
http://codespeak.net/py/dist/greenlet.html)

However, usage is very simple.
1. add this line before using any eventlet functions
from eventlet.twistedutil import join_reactor
2. import eventlet.green.urllib instead of urllib
3. Use eventlet.twistedutil.deferToGreenThread function to make
"blocking" functions
from eventlet.green.urllib return Deferred.

Here's an example on how to use eventlet.green.httplib and twisted's
LineReceiver
together to build a toy http proxy:

http://devel.ag-projects.com/~denis/cgi-bin/hgweb.cgi/file/097d879e0228/examples/twisted_http_proxy.py

To get the repository:

hg clone http://devel.ag-projects.com/~denis/cgi-bin/hgweb.cgi/eventlet_twisted

The only dependency is py.magic.greenlet from py library.
The code is only tested on python2.5 linux & macos so it probably won't work
on python2.4/windows but that will be fixed sometime in the future.

On Sun, Dec 14, 2008 at 12:08 AM, Erik Wickstrom <erik at erikwickstrom.com> wrote:
> Hi all,
>
> I have an application that is doing some web spidering.  Right now I'm
> using urllib to retrieve the URLs, but it is painfully slow.  I was
> wondering if it's feasible to swap out urllib with a twisted client
> that uses deferds so I can process urls in a more "parallel" fashion?
>
> I've done a bunch of Googleing, but I haven't come across anything
> that I can use as a drop in replacement.   If you can point me in the
> right direction I'd really appreciate it!
>
> Thanks for your help!
> Erik
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From mail.sensenmann at googlemail.com  Sun Dec 14 22:38:32 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Mon, 15 Dec 2008 06:38:32 +0100
Subject: [Twisted-Python] Twisted and MVC
Message-ID: <717b5780812142138m10f502ads371c0e3536f04085@mail.gmail.com>

Hi folks.

I want to build a MVC with the Model based on twisted with a custom
protocol. At the moment all my attemps terrible failed. So far the client
build a valid ssl-connection to the server and send the lines he is supposed
to send but don't recognise any incomming lines from the server. So I
decided to build the model from scratch again. The controller inits the
model-class (implementation of the custom chat-protocol) to be able to call
methods of the instance and send messages to the server. So how do I connect
the model to he server? In former implementations I were using the
Clientfactory but this didn't work very well.

Thanks for your help
Christian Scharkus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081215/4dea1b0d/attachment.html>

From dialtone at gmail.com  Sun Dec 14 23:28:24 2008
From: dialtone at gmail.com (Valentino Volonghi)
Date: Sun, 14 Dec 2008 22:28:24 -0800
Subject: [Twisted-Python] Twisted and MVC
In-Reply-To: <717b5780812142138m10f502ads371c0e3536f04085@mail.gmail.com>
References: <717b5780812142138m10f502ads371c0e3536f04085@mail.gmail.com>
Message-ID: <7955E850-873E-4E33-8552-C5249FC655AD@gmail.com>


On Dec 14, 2008, at 9:38 PM, Christian Scharkus wrote:

> methods of the instance and send messages to the server. So how do I  
> connect
> the model to he server? In former implementations I were using the
> Clientfactory but this didn't work very well.


<mode yoda>
Use the code Luke
</mode yoda>

Without showing the code it's hard to give an help. Anyway it's the
responsibility of the protocol to translate a line into a controller  
call,
and the controller should then consider calling something on the
model but again without the code it's pretty hard to guess which is
edge A5 and which is panel G3. :)

-- 
Valentino Volonghi aka Dialtone
Now running MacOS X 10.5
Home Page: http://www.twisted.it
http://www.adroll.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081214/90881f29/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20081214/90881f29/attachment.sig>

From mail.sensenmann at googlemail.com  Mon Dec 15 05:22:38 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Mon, 15 Dec 2008 13:22:38 +0100
Subject: [Twisted-Python] Twisted and MVC
In-Reply-To: <7955E850-873E-4E33-8552-C5249FC655AD@gmail.com>
References: <717b5780812142138m10f502ads371c0e3536f04085@mail.gmail.com>
	<7955E850-873E-4E33-8552-C5249FC655AD@gmail.com>
Message-ID: <717b5780812150422x134c6909t22b33542335a10dd@mail.gmail.com>

Well ... you're just right but the code is still closed atm so you have to
be happy with some snippets. I left out unimportant functions and replaced
names with representatives.

The main.py:

import controller

controller.controller().startConnection('127.0.0.1',23002)

The controller.py:

import model, view

class controller():
    def __init__(self):
        self.model = model.Client(self)
        self.view = view.view(self)

    def startConnection(self,server,port):
        self.model.startConnection(server,port)

    def gotConnection(self):
        print 'connection established'
        self.model.sendHandshake('some hash')

And finaly the model.py:

from twisted.internet import reactor, protocol, task, ssl
from twisted.protocols import basic

class Client(basic.LineOnlyReceiver, protocol.Factory):

    def __init__(self,controller):
        """Takes one argument: the instance of the controller Class."""
        self.controller=controller

    def startConnection(self,server,port):
        """Initiate the connection."""
        reactor.connectSSL(server, port, self, ssl.ClientContextFactory())
        reactor.run()

    def buildProtocol(self, addr):
        return self

    def connectionMade(self):
        self.controller.gotConnection()

    def sendHandshake(self,hash):
        """The Handshake has to be send first, after a ssl connection is
established"""
        self.sendLine('line to that the server respond with another line')

    def lineReceived(self,data):
        self.controller.foo(data)

2008/12/15 Valentino Volonghi <dialtone at gmail.com>

>
> On Dec 14, 2008, at 9:38 PM, Christian Scharkus wrote:
>
> methods of the instance and send messages to the server. So how do I
> connect
> the model to he server? In former implementations I were using the
> Clientfactory but this didn't work very well.
>
>
> <mode yoda>
> Use the code Luke
> </mode yoda>
>
> Without showing the code it's hard to give an help. Anyway it's the
> responsibility of the protocol to translate a line into a controller call,
> and the controller should then consider calling something on the
> model but again without the code it's pretty hard to guess which is
> edge A5 and which is panel G3. :)
>
> --
> Valentino Volonghi aka Dialtone
> Now running MacOS X 10.5
> Home Page: http://www.twisted.it
> http://www.adroll.com
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081215/cc06a111/attachment.html>

From py.adriano at gmail.com  Mon Dec 15 06:11:07 2008
From: py.adriano at gmail.com (Adriano Marques)
Date: Mon, 15 Dec 2008 14:11:07 +0100
Subject: [Twisted-Python] Re: Twisted FTP
In-Reply-To: <ab9df3750812141557v68076808o7c7df6764f79e882@mail.gmail.com>
References: <ab9df3750812141557v68076808o7c7df6764f79e882@mail.gmail.com>
Message-ID: <29ec21540812150511i408bdce6g9be06a1e81df5581@mail.gmail.com>

Hello Gergely,

> I just started to learn twisted. I tried to look after a working FTP example
> on the net for twisted, but unfortunately I could not really found any. This
> one seemed to be the most completed, but it says "Unknown error code" when I
> try to connect to it.

I'm sorry, but I don't have the chance of looking it further right
now, but I took a look at your code, and I say that instead of making
FTPServerFactory inherit from FtpFactory, you opted to instantiate it
inside a object inherited class. I never tried this approach, and that
may be the root of your problem. I'm redirecting you e-mail to twisted
mailing list, so people there can help you better. I advice you to
subscribe to that mailing list to get help (if you aren't subscribed
yet). You may also try the IRC channel for some help. Twisted folks
are very responsive and willing to help.

> In my opinion the code is fine. May I ask you to take a look on it please,
> and give me any suggestions, if you can see, why it is not working?
>
> I would really appreciate your help.


Kind Regards,

-- 
Adriano Monteiro Marques

http://adriano-marques.blogspot.com
http://www.umitproject.org
http://www.pythonbenelux.org

"Don't stay in bed, unless you can make money in bed." - George Burns
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftpServer.py
URL: </pipermail/twisted-python/attachments/20081215/f385d79b/attachment.ksh>

From muaazhussain128 at gmail.com  Mon Dec 15 10:31:39 2008
From: muaazhussain128 at gmail.com (Muaaz Hussain)
Date: Mon, 15 Dec 2008 20:31:39 +0300
Subject: [Twisted-Python] twisted eat the memory
Message-ID: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>

I wrote web application on twisted and my application read from ulogd daemon
and push the output to the client browser using AJAX  .also I have another
application displaying ethernets traffic using AJAX.
but after some minutes the twisted process in the server eat the memory and
the OOM-killer of the linux will kill the twisted process.
are there any solution to make the twisted release the memory .

note: my ram is 256mb

-- 
Muaaz Osman Hussain

IT Researcher
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081215/8b111dd7/attachment.html>

From cary.hull at gmail.com  Mon Dec 15 10:43:02 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Mon, 15 Dec 2008 12:43:02 -0500
Subject: [Twisted-Python] twisted eat the memory
In-Reply-To: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
References: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
Message-ID: <3fce0ae70812150943saef4d0flcdadc93d3ed5fea6@mail.gmail.com>

What version of Python are you using? 2.4 and below have problems
releasing memory back to the OS. Since Twisted apps are normally long
running Python daemons they can be more prone to memory leaks. You
need to be aware of how objects are garbage collected in Python and
rework your code if necessary.

Twisted itself should not be the source of problem.

An interesting article on the subject:
http://evanjones.ca/python-memory.html

-Cary

On Mon, Dec 15, 2008 at 12:31 PM, Muaaz Hussain
<muaazhussain128 at gmail.com> wrote:
> I wrote web application on twisted and my application read from ulogd daemon
> and push the output to the client browser using AJAX  .also I have another
> application displaying ethernets traffic using AJAX.
> but after some minutes the twisted process in the server eat the memory and
> the OOM-killer of the linux will kill the twisted process.
> are there any solution to make the twisted release the memory .
>
> note: my ram is 256mb
>
> --
> Muaaz Osman Hussain
>
> IT Researcher
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From exarkun at divmod.com  Mon Dec 15 10:49:08 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon, 15 Dec 2008 12:49:08 -0500
Subject: [Twisted-Python] twisted eat the memory
In-Reply-To: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
Message-ID: <20081215174908.20272.59442993.divmod.quotient.21396@ohm>

On Mon, 15 Dec 2008 20:31:39 +0300, Muaaz Hussain <muaazhussain128 at gmail.com> wrote:
>I wrote web application on twisted and my application read from ulogd daemon
>and push the output to the client browser using AJAX  .also I have another
>application displaying ethernets traffic using AJAX.
>but after some minutes the twisted process in the server eat the memory and
>the OOM-killer of the linux will kill the twisted process.
>are there any solution to make the twisted release the memory .
>
>note: my ram is 256mb
>

This isn't a feature of Twisted, so there's no simple flag you can pass
or alternate API you can use to avoid it.  Perhaps you can share a minimal,
self-contained example program which produces this behavior and someone can
point out what the cause of the memory use is.  Make sure the example is
short (does not contain code unrelated to the high memory usage) and can be
run to produce the problem.

Jean-Paul



From andreas at kostyrka.org  Mon Dec 15 12:39:48 2008
From: andreas at kostyrka.org (Andreas Kostyrka)
Date: Mon, 15 Dec 2008 20:39:48 +0100
Subject: [Twisted-Python] twisted eat the memory
In-Reply-To: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
References: <1ac8ac10812150931g2d56c860rc89499e7e757cbf5@mail.gmail.com>
Message-ID: <20081215203948.5dbe967f@andi-lap>

Am Mon, 15 Dec 2008 20:31:39 +0300
schrieb "Muaaz Hussain" <muaazhussain128 at gmail.com>:

> I wrote web application on twisted and my application read from ulogd
> daemon and push the output to the client browser using AJAX  .also I
> have another application displaying ethernets traffic using AJAX.
> but after some minutes the twisted process in the server eat the
> memory and the OOM-killer of the linux will kill the twisted process.
> are there any solution to make the twisted release the memory .
> 
> note: my ram is 256mb
> 

Well, CPython uses a dual garbage collection policy (reference
counting, and cycle breaking GC), and there are at least some cases
where garbage can leak. (cycles with __del__ methods defined.)

But in a different way, that only helps you manage memory, but in the
end you as the developer need to decide which objects you still need
to forget about the object before Python can release the memory.

Another point is that under Unix, processes tend to keep memory they
have allocated to themselves, so if your process needs say 300MB at
start-up and releases 270MB you need to check if these really end up
available for the OS.

But as exarkun pointed out, that's a nontrivial problem, and without
reducing it to a small and runnable example that shows your problem,
the list won't be able to help you much. (If you have such general
python questions, you might consider posting also to tutor at python.org,
which tends to be slightly more considerate to newbies.)

Andreas
 



From aryeh at bigfoot.com  Tue Dec 16 09:29:33 2008
From: aryeh at bigfoot.com (Arye)
Date: Tue, 16 Dec 2008 17:29:33 +0100
Subject: [Twisted-Python] combining addCallback and callLater ?
Message-ID: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>

Dear list,

I would like to add a callback that delays the chain. In other words I would
like to combine:
defer.Deferred().addCallback
and reactor.callLater

The only solution I came up with was the code below.

There must be a more elegant way to do this.
Any ideas would be greatly appreciated,
All the best,

*************************begin
from twisted.internet import reactor, defer

def printResults(results, arg):
    print "In printResults results=", results
    print "In printResults arg=", arg
    if arg == 2:
        reactor.stop()


def fireLater(results, d2):
    print "In fireLater results=", results
    reactor.callLater(5, d2.callback, "firelater")

d1 = defer.Deferred()
d2 = defer.Deferred()
d2.addCallback( printResults, 1)
d2.addCallback( printResults, 2)


d1.addCallback(fireLater, d2)
d1.callback("fire")

reactor.run()
*************************end
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081216/0c0d7d22/attachment.html>

From amauryfa at gmail.com  Tue Dec 16 10:09:08 2008
From: amauryfa at gmail.com (Amaury Forgeot d'Arc)
Date: Tue, 16 Dec 2008 18:09:08 +0100
Subject: [Twisted-Python] combining addCallback and callLater ?
In-Reply-To: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>
References: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>
Message-ID: <e27efe130812160909p10d45aa8o51550f497894dea3@mail.gmail.com>

Hi,

Arye wrote:
> I would like to add a callback that delays the chain. In other words I would
> like to combine:
> defer.Deferred().addCallback
> and reactor.callLater
>
> The only solution I came up with was the code below.
>
> There must be a more elegant way to do this.
> Any ideas would be greatly appreciated,
> All the best,
>
> *************************begin
> from twisted.internet import reactor, defer
>
> def printResults(results, arg):
>     print "In printResults results=", results
>     print "In printResults arg=", arg
>     if arg == 2:
>         reactor.stop()
>
>
> def fireLater(results, d2):
>     print "In fireLater results=", results
>     reactor.callLater(5, d2.callback, "firelater")
>
> d1 = defer.Deferred()
> d2 = defer.Deferred()
> d2.addCallback( printResults, 1)
> d2.addCallback( printResults, 2)
>
>
> d1.addCallback(fireLater, d2)
> d1.callback("fire")
>
> reactor.run()
> *************************end

I've already written this some times:

d1.addCallback(5, reactor.callLater, d2.callback, "firelater")

Hope this, helps,

-- 
Amaury Forgeot d'Arc



From dr.marc.byrd at gmail.com  Tue Dec 16 12:55:06 2008
From: dr.marc.byrd at gmail.com (Marc Byrd)
Date: Tue, 16 Dec 2008 11:55:06 -0800
Subject: [Twisted-Python] Syslog Listener UDP
In-Reply-To: <774f50bd0810050612g791d7d8dy8f00ba5f2c6baad4@mail.gmail.com>
References: <a33934630809281118y34e23dfdq769c5ea2ab8e9acd@mail.gmail.com>
	<774f50bd0810050612g791d7d8dy8f00ba5f2c6baad4@mail.gmail.com>
Message-ID: <a33934630812161155g1b388f56s5b575eefdd6cc9eb@mail.gmail.com>

Sorry for the late response.

This has (obviously) been a background, "wouldn't it be cool" type project.

Once I got remote logging over udp working w/ two machines w/ syslog-ng, the
tiwsted python part was easy:
from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor

class Echo(DatagramProtocol):

    def datagramReceived(self, data, (host, port)):
        print "received %r from %s:%d" % (data, host, port)
        self.transport.write(data, (host, port))

reactor.listenUDP(514, Echo())
reactor.run()

Part of my problem was that I was trying to use syslog on log-client and
syslog-ng on log-server; not sure I (yet) know of any reason why this
wouldn't work, but the point is, I got it working well enough to know that
the twisted stuff is working as expected.

So with syslog-ng on log-clients, all sending to a central log server over
udp, listening w/ twisted - the possibilities are endless!

Cheers,


Marc



On Sun, Oct 5, 2008 at 5:12 AM, HG <hackgou at gmail.com> wrote:

> I'm interested with this.
> any more progress?
> thanks
> HG
>
> On Mon, Sep 29, 2008 at 2:18 AM, Marc Byrd <dr.marc.byrd at gmail.com> wrote:
>
>> Hi,
>>
>> I would like to build a syslog(udp port 514) listener in twisted.  The
>> goal is to make it compatible with syslog and syslog-ng, which may be
>> configured on a "client" to send log entries (as they occur) via udp (fire
>> and forget) to a remote server (my twisted server).
>>
>> Is there already something out there that would do this or that would be a
>> good start?
>>
>> Thanks,
>>
>>
>> Marc
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081216/d9343343/attachment.html>

From marcin at ascii-art.pl  Wed Dec 17 04:25:10 2008
From: marcin at ascii-art.pl (=?ISO-8859-2?Q?Marcin_Gli=F1ski?=)
Date: Wed, 17 Dec 2008 12:25:10 +0100
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
Message-ID: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>

Hello!

There's a problem I can't find an answer to. I'd like to design Xml
based protocol.
I've found XmlStream, read doc and found addObserver method. I wrote
simple code:

class XmlTest(xmlstream.XmlStream):
    # (...)
    def connectionMade(self):
        xmlstream.XmlStream.connectionMade(self)
        self.addObserver("/frame", self.frameHandler)
        # (...)

    # (...)

    def frameHandler(self, data):
        print "Wilma, I'm Home!"

When I send XML with frame element as a root:

<frame>
 <whatever/>
</frame>

FrameHandler isn't executed, but if I put frame element inside some
other root element:

<sheep>
 <frame>
  <whatever/>
 </frame>
</sheep>

Then my handler is activated. Why? First, I thought maybe my XPath
knowledge is wrong,
so I checked few tutorials[1] and they told me there's something wrong with
addObserver method. How to make it working?



~MG.
(Hi, I'm new here :)



From adelagon at gmail.com  Wed Dec 17 05:31:13 2008
From: adelagon at gmail.com (Alvin Delagon)
Date: Wed, 17 Dec 2008 20:31:13 +0800
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
In-Reply-To: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>
References: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>
Message-ID: <7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>

Hello Marcin,

XmlStream is an implementation of XMPP/Jabber protocol (which is widely used
for Instant Messaging). If you have time please read about this on
www.xmpp.org. The reason why /frame handler was not executed is because
XMPP/Jabber sessions starts and ends with streams like for example:

<*stream*:*stream* xmlns:*stream*="http://etherx.jabber.org/streams">
.
.
.
<message to='foo at jabber.org' from='bar at jabber.org>
   <body>Hello World!</body>
</message>
.
.
.
</stream:stream>

You might want to take a look at twisted XML-RPC libraries.

---
Alvin


On Wed, Dec 17, 2008 at 7:25 PM, Marcin Gliński <marcin at ascii-art.pl> wrote:

> Hello!
>
> There's a problem I can't find an answer to. I'd like to design Xml
> based protocol.
> I've found XmlStream, read doc and found addObserver method. I wrote
> simple code:
>
> class XmlTest(xmlstream.XmlStream):
>    # (...)
>    def connectionMade(self):
>        xmlstream.XmlStream.connectionMade(self)
>        self.addObserver("/frame", self.frameHandler)
>        # (...)
>
>    # (...)
>
>    def frameHandler(self, data):
>        print "Wilma, I'm Home!"
>
> When I send XML with frame element as a root:
>
> <frame>
>  <whatever/>
> </frame>
>
> FrameHandler isn't executed, but if I put frame element inside some
> other root element:
>
> <sheep>
>  <frame>
>  <whatever/>
>  </frame>
> </sheep>
>
> Then my handler is activated. Why? First, I thought maybe my XPath
> knowledge is wrong,
> so I checked few tutorials[1] and they told me there's something wrong with
> addObserver method. How to make it working?
>
>
>
> ~MG.
> (Hi, I'm new here :)
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
http://www.alvinatorsplayground.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081217/db92dd8a/attachment.html>

From marcin at ascii-art.pl  Wed Dec 17 06:01:47 2008
From: marcin at ascii-art.pl (=?ISO-8859-2?Q?Marcin_Gli=F1ski?=)
Date: Wed, 17 Dec 2008 14:01:47 +0100
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
In-Reply-To: <7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>
References: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>
	<7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>
Message-ID: <6646dd390812170501t7cb0af20y4232770d506f9f79@mail.gmail.com>

2008/12/17 Alvin Delagon:

> XmlStream is an implementation of XMPP/Jabber protocol (which is widely used
> for Instant Messaging).

Which XmlStream? I've found two:

XMPP: twisted.words.protocols.jabber.xmlstream
X-ish: twisted.words.xish.xmlstream

I've been trying to use the second one. Are they the same?


> You might want to take a look at twisted XML-RPC libraries.

Sure, I will. Thanks :)



~MG.



From gabriel.rossetti at arimaz.com  Thu Dec 18 06:35:00 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Thu, 18 Dec 2008 14:35:00 +0100
Subject: [Twisted-Python] python properties in twisted don't work
Message-ID: <494A5184.2040509@arimaz.com>

Hello everyone!

I have a problem, if I try to use python property in a twisted program, 
it doesn't really work...the accessor works but as soon as I use the 
mutator, it no longer uses the property (and doesn't set the "real" 
variable. I tried an example without twisted, it works, and with the 
twisted example it doesn't... does anyone know what is going on? Thank you!

Gabriel

#-------------------------------------------------------------------------------------------------------
# This doesn't work, why????
#-------------------------------------------------------------------------------------------------------

from twisted.internet.protocol import Protocol, ClientFactory
from sys import stdout

class Echo(Protocol):

    def __init__(self):
        self.__x = None

    def __getx(self):
        return self.__x
   
    def __setx(self, value):
        if(value != 0):
            self.__x = value
           
    def __delx(self):
        del self.__x

    x = property(__getx, __setx, __delx, "the doc")

    def connectionMade(self):
        t = self.x
        assert t is None
        self.x = 4
        assert self.__x == 4
        t = self.x
        assert t == 4
        self.x = 0
        assert self.__x == 4
        t = self.x
        assert t == 4
       
    def dataReceived(self, data):
        stdout.write(data)


class EchoClientFactory(ClientFactory):
    def startedConnecting(self, connector):
        print 'Started to connect.'

    def buildProtocol(self, addr):
        print 'Connected.'
        return Echo()

    def clientConnectionLost(self, connector, reason):
        print 'Lost connection.  Reason:', reason

    def clientConnectionFailed(self, connector, reason):
        print 'Connection failed. Reason:', reason

if(__name__ == "__main__"):
   
    from twisted.internet import reactor
    reactor.connectTCP("localhost", 4444, EchoClientFactory())
    reactor.run()


#-------------------------------------------------------------------------------------------------------
# This works, as expected
#----------------------------------------------------------------------------------------------------
class C(object):
       
    def __init__(self):
        self._x = None
       
    def __getx(self):
        return self._x
       
    def __setx(self, value):
        if(value != 0):
            self._x = value
           
    def __delx(self):
        del self._x
       
    x = property(__getx, __setx, __delx, "The doc")


if(__name__ == "__main__"):
   
    c = C()
    t = c.x
    assert t is None
    c.x = 4
    assert c._x == 4
    t = c.x
    assert t == 4
    c.x = 0
    assert c._x == 4
    t = c.x
    assert t == 4





From tzury.by at gmail.com  Thu Dec 18 06:38:55 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Thu, 18 Dec 2008 15:38:55 +0200
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <2f5ea7490812180208y76043b9co56358eebdae48a6e@mail.gmail.com>
References: <2f5ea7490812180123wdfeb2f1k6ad493f1e632b9e9@mail.gmail.com>
	<2f5ea7490812180208y76043b9co56358eebdae48a6e@mail.gmail.com>
Message-ID: <2f5ea7490812180538l66c1048bj2ae82ffbdd01b3@mail.gmail.com>

Hi,
I am willing to deploy on my server an SSH daemon which I can control
what commands can be executed, and by who.
After playing with jailkit [link] I realised that implementing my own
SSH server will give me more power and scalability (especially
regarding of users, keys and accounts management).

Naturally I approached twisted knowing it will solve this problem as a
smart kiddo solves a simple safari puzzle.

Playing with samples found on the web and at Twisted docs, I realised
that twisted has everything I need for the task, but I am missing the
knowledge of how to glue it all together.

In fact, a command if not working on the first strike, works on the second try.

at http://gist.github.com/37446 I pasted the server.py code. which is
a modification of what I've found at:
http://twistedmatrix.com/projects/conch/documentation/examples/sshsimpleserver.py

for instance trying to run git over ssh yeilds error at first, and
when running again seems to be working.
below is the console output on the client side

#first attempt
tzury at regulus:~$ git clone
ssh://tzury at localhost:5022/home/tzury/devel/ice/snoip/freespeech
clone-repo7
Initialized empty Git repository in /home/tzury/clone-repo7/.git/
remote: Counting objects: 347, done.
remote: Compressing objects: 100% (232/232), done.
Receiving objects: 100% (347/347), 91.75 KiB, done.
remote: Total 347 (delta 234), reused 177 (delta 114)
fatal: The remote end hung up unexpectedly
Resolving deltas: 100% (234/234), done.
error: waitpid (async) failed
fatal: error in sideband demultiplexer

#second attempt
tzury at regulus:~$ git clone
ssh://tzury at localhost:5022/home/tzury/devel/ice/snoip/freespeech
clone-repo7
Initialized empty Git repository in /home/tzury/clone-repo7/.git/
remote: Counting objects: 347, done.
remote: Compressing objects: 100% (232/232), done.
Receiving objects: 100% (347/347), 91.75 KiB, done.
remote: Total 347 (delta 234), reused 177 (delta 114)
Resolving deltas: 100% (234/234), done.
tzury at regulus:~$



-- 
Tzury Bar Yochay



From exarkun at divmod.com  Thu Dec 18 06:59:30 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 18 Dec 2008 08:59:30 -0500
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <494A5184.2040509@arimaz.com>
Message-ID: <20081218135930.20272.982548839.divmod.quotient.22597@ohm>

On Thu, 18 Dec 2008 14:35:00 +0100, Gabriel Rossetti <gabriel.rossetti at arimaz.com> wrote:
>Hello everyone!
>
>I have a problem, if I try to use python property in a twisted program, it 
>doesn't really work...the accessor works but as soon as I use the mutator, 
>it no longer uses the property (and doesn't set the "real" variable. I tried 
>an example without twisted, it works, and with the twisted example it 
>doesn't... does anyone know what is going on? Thank you!

Property setters only work on new-style classes.  Many classes defined by
Twisted are classic, so they will not work with properties unless you make
your subclass new-style, which you can do by mixing in object.

Jean-Paul



From exarkun at divmod.com  Thu Dec 18 07:01:36 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 18 Dec 2008 09:01:36 -0500
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <2f5ea7490812180538l66c1048bj2ae82ffbdd01b3@mail.gmail.com>
Message-ID: <20081218140136.20272.811818444.divmod.quotient.22598@ohm>

On Thu, 18 Dec 2008 15:38:55 +0200, Tzury Bar Yochay <tzury.by at gmail.com> wrote:
>Hi,
>I am willing to deploy on my server an SSH daemon which I can control
>what commands can be executed, and by who.
>After playing with jailkit [link] I realised that implementing my own
>SSH server will give me more power and scalability (especially
>regarding of users, keys and accounts management).
>
>Naturally I approached twisted knowing it will solve this problem as a
>smart kiddo solves a simple safari puzzle.
>
>Playing with samples found on the web and at Twisted docs, I realised
>that twisted has everything I need for the task, but I am missing the
>knowledge of how to glue it all together.
>
>In fact, a command if not working on the first strike, works on the second try.

Can you have git be more verbose about what it's going?  If it is running
OpenSSH's ssh client, can you have it pass -v (verbose) a few times?  That
might provide more hints about what's going wrong.  You should also try
enabling Twisted logging in your SSH server to see if any useful information
is available there.

Jean-Paul



From drew.smathers at gmail.com  Thu Dec 18 07:04:44 2008
From: drew.smathers at gmail.com (Drew Smathers)
Date: Thu, 18 Dec 2008 09:04:44 -0500
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <494A5184.2040509@arimaz.com>
References: <494A5184.2040509@arimaz.com>
Message-ID: <368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>

Protocol is an old-style class - doesn't inherit from object - so
property won't work in that context.  This won't be a problem in
python 3 - old-style/new-style classes are consolidated.

-Drew

On Thu, Dec 18, 2008 at 8:35 AM, Gabriel Rossetti
<gabriel.rossetti at arimaz.com> wrote:
> Hello everyone!
>
> I have a problem, if I try to use python property in a twisted program, it
> doesn't really work...the accessor works but as soon as I use the mutator,
> it no longer uses the property (and doesn't set the "real" variable. I tried
> an example without twisted, it works, and with the twisted example it
> doesn't... does anyone know what is going on? Thank you!
>
> Gabriel
>
> #-------------------------------------------------------------------------------------------------------
> # This doesn't work, why????
> #-------------------------------------------------------------------------------------------------------
>
> from twisted.internet.protocol import Protocol, ClientFactory
> from sys import stdout
>
> class Echo(Protocol):
>
>   def __init__(self):
>       self.__x = None
>
>   def __getx(self):
>       return self.__x
>     def __setx(self, value):
>       if(value != 0):
>           self.__x = value
>             def __delx(self):
>       del self.__x
>
>   x = property(__getx, __setx, __delx, "the doc")
>
>   def connectionMade(self):
>       t = self.x
>       assert t is None
>       self.x = 4
>       assert self.__x == 4
>       t = self.x
>       assert t == 4
>       self.x = 0
>       assert self.__x == 4
>       t = self.x
>       assert t == 4
>         def dataReceived(self, data):
>       stdout.write(data)
>
>
> class EchoClientFactory(ClientFactory):
>   def startedConnecting(self, connector):
>       print 'Started to connect.'
>
>   def buildProtocol(self, addr):
>       print 'Connected.'
>       return Echo()
>
>   def clientConnectionLost(self, connector, reason):
>       print 'Lost connection.  Reason:', reason
>
>   def clientConnectionFailed(self, connector, reason):
>       print 'Connection failed. Reason:', reason
>
> if(__name__ == "__main__"):
>     from twisted.internet import reactor
>   reactor.connectTCP("localhost", 4444, EchoClientFactory())
>   reactor.run()
>
>
> #-------------------------------------------------------------------------------------------------------
> # This works, as expected
> #----------------------------------------------------------------------------------------------------
> class C(object):
>         def __init__(self):
>       self._x = None
>         def __getx(self):
>       return self._x
>         def __setx(self, value):
>       if(value != 0):
>           self._x = value
>             def __delx(self):
>       del self._x
>         x = property(__getx, __setx, __delx, "The doc")
>
>
> if(__name__ == "__main__"):
>     c = C()
>   t = c.x
>   assert t is None
>   c.x = 4
>   assert c._x == 4
>   t = c.x
>   assert t == 4
>   c.x = 0
>   assert c._x == 4
>   t = c.x
>   assert t == 4
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
\\\\\/\"/\\\\\\\\\\\
\\\\/ // //\/\\\\\\\
\\\/  \\// /\ \/\\\\
\\/ /\/ / /\/ /\ \\\
\/ / /\/ /\  /\\\ \\
/ /\\\  /\\\ \\\\\/\
\/\\\\\/\\\\\/\\\\\\
               d.p.s



From gabriel.rossetti at arimaz.com  Thu Dec 18 08:39:59 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Thu, 18 Dec 2008 16:39:59 +0100
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <20081218135930.20272.982548839.divmod.quotient.22597@ohm>
References: <20081218135930.20272.982548839.divmod.quotient.22597@ohm>
Message-ID: <494A6ECF.70000@arimaz.com>

Jean-Paul Calderone wrote:
> On Thu, 18 Dec 2008 14:35:00 +0100, Gabriel Rossetti 
> <gabriel.rossetti at arimaz.com> wrote:
>> Hello everyone!
>>
>> I have a problem, if I try to use python property in a twisted 
>> program, it doesn't really work...the accessor works but as soon as I 
>> use the mutator, it no longer uses the property (and doesn't set the 
>> "real" variable. I tried an example without twisted, it works, and 
>> with the twisted example it doesn't... does anyone know what is going 
>> on? Thank you!
>
> Property setters only work on new-style classes.  Many classes defined by
> Twisted are classic, so they will not work with properties unless you 
> make
> your subclass new-style, which you can do by mixing in object.
>
> Jean-Paul
Thank you, I wasn't aware of that, I'll add object when inheriting from 
any Twisted stuff then.

Gabriel



From gabriel.rossetti at arimaz.com  Thu Dec 18 08:49:38 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Thu, 18 Dec 2008 16:49:38 +0100
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
In-Reply-To: <6646dd390812170501t7cb0af20y4232770d506f9f79@mail.gmail.com>
References: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>	<7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>
	<6646dd390812170501t7cb0af20y4232770d506f9f79@mail.gmail.com>
Message-ID: <494A7112.1010007@arimaz.com>

Hello Marcin,

Marcin Gliński wrote:
> 2008/12/17 Alvin Delagon:
>
>   
>> XmlStream is an implementation of XMPP/Jabber protocol (which is widely used
>> for Instant Messaging).
>>     
>
> Which XmlStream? I've found two:
>
> XMPP: twisted.words.protocols.jabber.xmlstream
> X-ish: twisted.words.xish.xmlstream
>
> I've been trying to use the second one. Are they the same?
>   
use the second one, unless you are writing a Jabber client/server. The 
Xish one is more generic, I use it in my apps. Imagine that the XMPP 
session is like one giant XMPP msg/document, it's root element/node is 
<stream/>, a session must be opened by each party if it's bidirectional :

Client Server
| <stream> |
|----------------------------------------->|
| | open the session
| <stream> |
|<-----------------------------------------|
| |
| <msg>.....</msg> |
|----------------------------------------->|
| | exchange msgs (as many as you want)
| <msg>.....</msg> |
|<-----------------------------------------|
| |
| </stream> |
|----------------------------------------->|
| | close the session when done
| </stream> |
|<-----------------------------------------|
| |


I hope this helps,
Gabriel

>
>   
>> You might want to take a look at twisted XML-RPC libraries.
>>     
>
> Sure, I will. Thanks :)
>
>
>
> ~MG.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>   



From gabriel.rossetti at arimaz.com  Thu Dec 18 09:07:26 2008
From: gabriel.rossetti at arimaz.com (Gabriel Rossetti)
Date: Thu, 18 Dec 2008 17:07:26 +0100
Subject: [Twisted-Python] XmlStream and addObserver - root element's name?
In-Reply-To: <494A7112.1010007@arimaz.com>
References: <6646dd390812170325y45c9e418wcfe59ad3ea977f37@mail.gmail.com>	<7a01f6c00812170431u1110d4e6t5f142c9222d9398e@mail.gmail.com>	<6646dd390812170501t7cb0af20y4232770d506f9f79@mail.gmail.com>
	<494A7112.1010007@arimaz.com>
Message-ID: <494A753E.1060508@arimaz.com>

Gabriel Rossetti wrote:
> Hello Marcin,
>
> Marcin Gliński wrote:
>> 2008/12/17 Alvin Delagon:
>>
>>  
>>> XmlStream is an implementation of XMPP/Jabber protocol (which is 
>>> widely used
>>> for Instant Messaging).
>>>     
>>
>> Which XmlStream? I've found two:
>>
>> XMPP: twisted.words.protocols.jabber.xmlstream
>> X-ish: twisted.words.xish.xmlstream
>>
>> I've been trying to use the second one. Are they the same?
>>   
> use the second one, unless you are writing a Jabber client/server. The 
> Xish one is more generic, I use it in my apps. Imagine that the XMPP 
> session is like one giant XMPP msg/document, it's root element/node is 
> <stream/>, a session must be opened by each party if it's bidirectional :
>
> Client Server
> | <stream> |
> |----------------------------------------->|
> | | open the session
> | <stream> |
> |<-----------------------------------------|
> | |
> | <msg>.....</msg> |
> |----------------------------------------->|
> | | exchange msgs (as many as you want)
> | <msg>.....</msg> |
> |<-----------------------------------------|
> | |
> | </stream> |
> |----------------------------------------->|
> | | close the session when done
> | </stream> |
> |<-----------------------------------------|
> | |
>
>
> I hope this helps,
> Gabriel
>

oups, the spaces got eaten up, those pipe ('|') symbols are supposed to 
be aligned on the right side....

>>
>>  
>>> You might want to take a look at twisted XML-RPC libraries.
>>>     
>>
>> Sure, I will. Thanks :)
>>
>>
>>
>> ~MG.
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>   
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From tzury.by at gmail.com  Thu Dec 18 09:55:12 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Thu, 18 Dec 2008 18:55:12 +0200
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <20081218140136.20272.811818444.divmod.quotient.22598@ohm>
References: <2f5ea7490812180538l66c1048bj2ae82ffbdd01b3@mail.gmail.com>
	<20081218140136.20272.811818444.divmod.quotient.22598@ohm>
Message-ID: <2f5ea7490812180855jb6488ud6ec50925a28d3cc@mail.gmail.com>

On Thu, Dec 18, 2008 at 4:01 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
> On Thu, 18 Dec 2008 15:38:55 +0200, Tzury Bar Yochay <tzury.by at gmail.com>
> wrote:
>>
>> Hi,
>> I am willing to deploy on my server an SSH daemon which I can control
>> what commands can be executed, and by who.
>> After playing with jailkit [link] I realised that implementing my own
>> SSH server will give me more power and scalability (especially
>> regarding of users, keys and accounts management).
>>
>> Naturally I approached twisted knowing it will solve this problem as a
>> smart kiddo solves a simple safari puzzle.
>>
>> Playing with samples found on the web and at Twisted docs, I realised
>> that twisted has everything I need for the task, but I am missing the
>> knowledge of how to glue it all together.
>>
>> In fact, a command if not working on the first strike, works on the second
>> try.
>
> Can you have git be more verbose about what it's going?  If it is running
> OpenSSH's ssh client, can you have it pass -v (verbose) a few times?  That
> might provide more hints about what's going wrong.  You should also try
> enabling Twisted logging in your SSH server to see if any useful information
> is available there.
>
> Jean-Paul
>

Jean Paul, thanks for your suggestions, however, either -v or
--verbose yields an error: unknown switch `v'
regarding logs on the twisted side, I got this line at the top of the file:
log.startLogging(sys.stderr)
is there anything else I can do in order to expand the logging options.

anyway, once I changed the following:

    def execCommand(self, proto, cmd):
        command = ('git-shell', '-c', cmd)
        shell = '/usr/bin/git-shell'
        reactor.spawnProcess(proto, shell, command)
into:

    def execCommand(self, proto, cmd):
        command = ('git-shell', '-c', cmd)
        shell = '/usr/bin/git-shell'
        reactor.callFromThread(lambda: reactor.spawnProcess(proto,
shell, command))

Everything works fine. Seems like this separation did something good.



From exarkun at divmod.com  Thu Dec 18 10:08:28 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Thu, 18 Dec 2008 12:08:28 -0500
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <2f5ea7490812180855jb6488ud6ec50925a28d3cc@mail.gmail.com>
Message-ID: <20081218170828.20272.81478691.divmod.quotient.22625@ohm>

On Thu, 18 Dec 2008 18:55:12 +0200, Tzury Bar Yochay <tzury.by at gmail.com> wrote:
>On Thu, Dec 18, 2008 at 4:01 PM, Jean-Paul Calderone <exarkun at divmod.com> wrote:
>> On Thu, 18 Dec 2008 15:38:55 +0200, Tzury Bar Yochay <tzury.by at gmail.com>
>> wrote:
>>>
>>> Hi,
>>> I am willing to deploy on my server an SSH daemon which I can control
>>> what commands can be executed, and by who.
>>> After playing with jailkit [link] I realised that implementing my own
>>> SSH server will give me more power and scalability (especially
>>> regarding of users, keys and accounts management).
>>>
>>> Naturally I approached twisted knowing it will solve this problem as a
>>> smart kiddo solves a simple safari puzzle.
>>>
>>> Playing with samples found on the web and at Twisted docs, I realised
>>> that twisted has everything I need for the task, but I am missing the
>>> knowledge of how to glue it all together.
>>>
>>> In fact, a command if not working on the first strike, works on the second
>>> try.
>>
>> Can you have git be more verbose about what it's going?  If it is running
>> OpenSSH's ssh client, can you have it pass -v (verbose) a few times?  That
>> might provide more hints about what's going wrong.  You should also try
>> enabling Twisted logging in your SSH server to see if any useful information
>> is available there.
>>
>> Jean-Paul
>>
>
>Jean Paul, thanks for your suggestions, however, either -v or
>--verbose yields an error: unknown switch `v'

I'm not familiar with git.  I meant for -v to be passed as an argument to
ssh.

>regarding logs on the twisted side, I got this line at the top of the file:
>log.startLogging(sys.stderr)
>is there anything else I can do in order to expand the logging options.

Ah, I overlooked that.  Once you've enabled it, it's basically as verbose
as it's going to get.  What do you see relating to SSH in the log file?
Conch is pretty verbose.

>
>anyway, once I changed the following:
>
>    def execCommand(self, proto, cmd):
>        command = ('git-shell', '-c', cmd)
>        shell = '/usr/bin/git-shell'
>        reactor.spawnProcess(proto, shell, command)
>into:
>
>    def execCommand(self, proto, cmd):
>        command = ('git-shell', '-c', cmd)
>        shell = '/usr/bin/git-shell'
>        reactor.callFromThread(lambda: reactor.spawnProcess(proto,
>shell, command))
>
>Everything works fine. Seems like this separation did something good.

Since execCommand is already only called in the reactor thread, this
isn't doing much - but it is slightly changing the timing of when
things happen.  That suggests the real problem may be a race between
different parts of your code.  It's not obvious what the race might be
between, from reading your code, though.

Jean-Paul



From tzury.by at gmail.com  Thu Dec 18 11:18:20 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Thu, 18 Dec 2008 20:18:20 +0200
Subject: [Twisted-Python] SSH Server with commands filtering
In-Reply-To: <20081218170828.20272.81478691.divmod.quotient.22625@ohm>
References: <2f5ea7490812180855jb6488ud6ec50925a28d3cc@mail.gmail.com>
	<20081218170828.20272.81478691.divmod.quotient.22625@ohm>
Message-ID: <2f5ea7490812181018x43930799g6b4c3c9d1724655e@mail.gmail.com>

> Since execCommand is already only called in the reactor thread, this
> isn't doing much - but it is slightly changing the timing of when
> things happen.  That suggests the real problem may be a race between
> different parts of your code.  It's not obvious what the race might be
> between, from reading your code, though.
>
> Jean-Paul

I might even go bit further and do something that some twisteders will
consider nasty,
and have another thread for command processing so to split between the racers.

I appreciate your comments and the time you spent to read my code and messages.

Thanks again,
  Tzury



From alecf at metaweb.com  Thu Dec 18 12:03:48 2008
From: alecf at metaweb.com (Alec Flett)
Date: Thu, 18 Dec 2008 11:03:48 -0800
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>
References: <494A5184.2040509@arimaz.com>
	<368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>
Message-ID: <C80F167C-DF92-467A-9C47-1DEDC50C72AB@metaweb.com>


On Dec 18, 2008, at 6:04 AM, Drew Smathers wrote:

> Protocol is an old-style class - doesn't inherit from object - so
> property won't work in that context.  This won't be a problem in
> python 3 - old-style/new-style classes are consolidated.
>

Is there any interest in adding 'object' to some of the core classes  
like Deferred, in a future release of Twisted? It would help with some  
debugging/logging (because there's better introspection)

As much as I'm looking forward to using Python 3, I can't imagine I'll  
be using it for any real projects that I have to deploy for at least 2  
years...

Alec


> -Drew
>
> On Thu, Dec 18, 2008 at 8:35 AM, Gabriel Rossetti
> <gabriel.rossetti at arimaz.com> wrote:
>> Hello everyone!
>>
>> I have a problem, if I try to use python property in a twisted  
>> program, it
>> doesn't really work...the accessor works but as soon as I use the  
>> mutator,
>> it no longer uses the property (and doesn't set the "real"  
>> variable. I tried
>> an example without twisted, it works, and with the twisted example it
>> doesn't... does anyone know what is going on? Thank you!
>>
>> Gabriel
>>
>> #-------------------------------------------------------------------------------------------------------
>> # This doesn't work, why????
>> #-------------------------------------------------------------------------------------------------------
>>
>> from twisted.internet.protocol import Protocol, ClientFactory
>> from sys import stdout
>>
>> class Echo(Protocol):
>>
>>  def __init__(self):
>>      self.__x = None
>>
>>  def __getx(self):
>>      return self.__x
>>    def __setx(self, value):
>>      if(value != 0):
>>          self.__x = value
>>            def __delx(self):
>>      del self.__x
>>
>>  x = property(__getx, __setx, __delx, "the doc")
>>
>>  def connectionMade(self):
>>      t = self.x
>>      assert t is None
>>      self.x = 4
>>      assert self.__x == 4
>>      t = self.x
>>      assert t == 4
>>      self.x = 0
>>      assert self.__x == 4
>>      t = self.x
>>      assert t == 4
>>        def dataReceived(self, data):
>>      stdout.write(data)
>>
>>
>> class EchoClientFactory(ClientFactory):
>>  def startedConnecting(self, connector):
>>      print 'Started to connect.'
>>
>>  def buildProtocol(self, addr):
>>      print 'Connected.'
>>      return Echo()
>>
>>  def clientConnectionLost(self, connector, reason):
>>      print 'Lost connection.  Reason:', reason
>>
>>  def clientConnectionFailed(self, connector, reason):
>>      print 'Connection failed. Reason:', reason
>>
>> if(__name__ == "__main__"):
>>    from twisted.internet import reactor
>>  reactor.connectTCP("localhost", 4444, EchoClientFactory())
>>  reactor.run()
>>
>>
>> #-------------------------------------------------------------------------------------------------------
>> # This works, as expected
>> #----------------------------------------------------------------------------------------------------
>> class C(object):
>>        def __init__(self):
>>      self._x = None
>>        def __getx(self):
>>      return self._x
>>        def __setx(self, value):
>>      if(value != 0):
>>          self._x = value
>>            def __delx(self):
>>      del self._x
>>        x = property(__getx, __setx, __delx, "The doc")
>>
>>
>> if(__name__ == "__main__"):
>>    c = C()
>>  t = c.x
>>  assert t is None
>>  c.x = 4
>>  assert c._x == 4
>>  t = c.x
>>  assert t == 4
>>  c.x = 0
>>  assert c._x == 4
>>  t = c.x
>>  assert t == 4
>>
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
>
>
> -- 
> \\\\\/\"/\\\\\\\\\\\
> \\\\/ // //\/\\\\\\\
> \\\/  \\// /\ \/\\\\
> \\/ /\/ / /\/ /\ \\\
> \/ / /\/ /\  /\\\ \\
> / /\\\  /\\\ \\\\\/\
> \/\\\\\/\\\\\/\\\\\\
>               d.p.s
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From mithrandi at mithrandi.net  Thu Dec 18 13:06:50 2008
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Thu, 18 Dec 2008 22:06:50 +0200
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <C80F167C-DF92-467A-9C47-1DEDC50C72AB@metaweb.com>
References: <494A5184.2040509@arimaz.com>
	<368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>
	<C80F167C-DF92-467A-9C47-1DEDC50C72AB@metaweb.com>
Message-ID: <20081218200650.GA353@mithrandi.net>

* Alec Flett <alecf at metaweb.com> [2008-12-18 11:03:48 -0800]:

>
> On Dec 18, 2008, at 6:04 AM, Drew Smathers wrote:
>
>> Protocol is an old-style class - doesn't inherit from object - so
>> property won't work in that context.  This won't be a problem in
>> python 3 - old-style/new-style classes are consolidated.
>>
>
> Is there any interest in adding 'object' to some of the core classes  
> like Deferred, in a future release of Twisted? It would help with some  
> debugging/logging (because there's better introspection)

The proble with doing this is that it is a backwards-incompatible change;
doing this in a way that would comply with Twisted's backwards
compatibility policy would be somewhat awkward:

http://twistedmatrix.com/trac/wiki/CompatibilityPolicy

What sort of better introspection are you talking about?
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20081218/62279a59/attachment.sig>

From foom at fuhm.net  Thu Dec 18 15:36:14 2008
From: foom at fuhm.net (James Y Knight)
Date: Thu, 18 Dec 2008 17:36:14 -0500
Subject: [Twisted-Python] python properties in twisted don't work
In-Reply-To: <20081218200650.GA353@mithrandi.net>
References: <494A5184.2040509@arimaz.com>
	<368574aa0812180604g5104a0c9od377804441e7db36@mail.gmail.com>
	<C80F167C-DF92-467A-9C47-1DEDC50C72AB@metaweb.com>
	<20081218200650.GA353@mithrandi.net>
Message-ID: <1F11034D-47D3-4A2F-B739-89B1D48B6AF1@fuhm.net>


On Dec 18, 2008, at 3:06 PM, Tristan Seligmann wrote:

> * Alec Flett <alecf at metaweb.com> [2008-12-18 11:03:48 -0800]:
>
>>
>> On Dec 18, 2008, at 6:04 AM, Drew Smathers wrote:
>>
>>> Protocol is an old-style class - doesn't inherit from object - so
>>> property won't work in that context.  This won't be a problem in
>>> python 3 - old-style/new-style classes are consolidated.
>>>
>>
>> Is there any interest in adding 'object' to some of the core classes
>> like Deferred, in a future release of Twisted? It would help with  
>> some
>> debugging/logging (because there's better introspection)
>
> The proble with doing this is that it is a backwards-incompatible  
> change;
> doing this in a way that would comply with Twisted's backwards
> compatibility policy would be somewhat awkward:
>
> http://twistedmatrix.com/trac/wiki/CompatibilityPolicy

The only way this could be done would be to do so in an "opt-in"  
fashion. E.g. something like:
import twisted
twisted.useNewStyleClasses(True)

But even that would be global for a given instantiation of the python  
interpreter which isn't really very good either if you need to mix new- 
style-expecting and old-style-expecting classes.

So it really doesn't esem worth it, given that people can mixin object  
themselves if they desire.

James



From huffman at tokyo.email.ne.jp  Thu Dec 18 18:44:49 2008
From: huffman at tokyo.email.ne.jp (Theron D. Huffman)
Date: Fri, 19 Dec 2008 10:44:49 +0900
Subject: [Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax
Message-ID: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>

I'm about to start programming a game in Python. The game will be a web-based board game with a social aspect, something like http://www.chesspark.com. I want the game to run in both browsers and as a desktop client. Therefore I'm wondering what python-based technologies I need. I know that Javascript/AJAX is necessary for the browser part so I have decided on the following:

1. Pyjamas -  (for the AJAX browser stuff)

2. Pyjamas-desktop - (for the desktop client)

3. Web2py (or djanjo, or django+pinax)  - for the website on which the game will run and for database access and social part - login, chat, members, profiles, game history, etc.)

4. Twisted - for the networking and chat functionality.

5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I don't know if Pygame is necessary for a board-type game.)

My understanding of the above technologies is still limited and I'm not sure if I need all of these because some functionality may be overlapped. e.g. I don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.

Can someone please give me some advice?

Kindest Regards,
Dan Huffman

www.WHITokyo.info  What's Happening In Tokyo podcast
www.Jindies.com  Bringing you the very best in music by Japanese independent artists!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081219/6d756fe6/attachment.html>

From cary.hull at gmail.com  Thu Dec 18 18:57:54 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Thu, 18 Dec 2008 17:57:54 -0800
Subject: [Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax
In-Reply-To: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>
References: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>
Message-ID: <3fce0ae70812181757x8882d43lfa3d5f45ae463d6f@mail.gmail.com>

Have you looked at Nevow/Athena?
http://divmod.org/trac/wiki/DivmodNevow

-Cary

On Thu, Dec 18, 2008 at 5:44 PM, Theron D. Huffman
<huffman at tokyo.email.ne.jp> wrote:
> I'm about to start programming a game in Python. The game will be a
> web-based board game with a social aspect, something like
> http://www.chesspark.com. I want the game to run in both browsers and as a
> desktop client. Therefore I'm wondering what python-based technologies I
> need. I know that Javascript/AJAX is necessary for the browser part so I
> have decided on the following:
>
> 1. Pyjamas -  (for the AJAX browser stuff)
>
> 2. Pyjamas-desktop - (for the desktop client)
>
> 3. Web2py (or djanjo, or django+pinax)  - for the website on which the game
> will run and for database access and social part - login, chat, members,
> profiles, game history, etc.)
>
> 4. Twisted - for the networking and chat functionality.
>
> 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I
> don't know if Pygame is necessary for a board-type game.)
>
> My understanding of the above technologies is still limited and I'm not sure
> if I need all of these because some functionality may be overlapped. e.g. I
> don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
>
> Can someone please give me some advice?
>
> Kindest Regards,
> Dan Huffman
>
> www.WHITokyo.info  What's Happening In Tokyo podcast
> www.Jindies.com  Bringing you the very best in music by Japanese independent
> artists!
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From huffman at tokyo.email.ne.jp  Thu Dec 18 23:14:26 2008
From: huffman at tokyo.email.ne.jp (Theron D. Huffman)
Date: Fri, 19 Dec 2008 15:14:26 +0900
Subject: [Twisted-Python] Re: Pyjamas + web2py + twisted vs Django + Pinax
	(Cary Hull)
In-Reply-To: <E1LDUdL-0007mY-7o@cube.twistedmatrix.com>
References: <E1LDUdL-0007mY-7o@cube.twistedmatrix.com>
Message-ID: <6ABE70A3DF6D4A9AA8F6EA9A6E730561@Podcaster>

Thanks Cary,

Where would Nevow/Athena fit in my strategy? 1, 2, 3 , or 4?

Actually I have looked at Nevow/Athena and I'm very afraid of using it 
because there's only a few examples and a complete lack of documentation.

Dan

>
> Message: 7
> Date: Thu, 18 Dec 2008 17:57:54 -0800
> From: "Cary Hull" <cary.hull at gmail.com>
> Subject: Re: [Twisted-Python] Pyjamas + web2py + twisted vs Django +
> Pinax
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Message-ID:
> <3fce0ae70812181757x8882d43lfa3d5f45ae463d6f at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Have you looked at Nevow/Athena?
> http://divmod.org/trac/wiki/DivmodNevow
>
> -Cary
>
> On Thu, Dec 18, 2008 at 5:44 PM, Theron D. Huffman
> <huffman at tokyo.email.ne.jp> wrote:
>> I'm about to start programming a game in Python. The game will be a
>> web-based board game with a social aspect, something like
>> http://www.chesspark.com. I want the game to run in both browsers and as 
>> a
>> desktop client. Therefore I'm wondering what python-based technologies I
>> need. I know that Javascript/AJAX is necessary for the browser part so I
>> have decided on the following:
>>
>> 1. Pyjamas -  (for the AJAX browser stuff)
>>
>> 2. Pyjamas-desktop - (for the desktop client)
>>
>> 3. Web2py (or djanjo, or django+pinax)  - for the website on which the 
>> game
>> will run and for database access and social part - login, chat, members,
>> profiles, game history, etc.)
>>
>> 4. Twisted - for the networking and chat functionality.
>>
>> 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I
>> don't know if Pygame is necessary for a board-type game.)
>>
>> My understanding of the above technologies is still limited and I'm not 
>> sure
>> if I need all of these because some functionality may be overlapped. e.g. 
>> I
>> don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
>>
>> Can someone please give me some advice?
>>
>> Kindest Regards,
>> Dan Huffman
>>
>> www.WHITokyo.info  What's Happening In Tokyo podcast
>> www.Jindies.com  Bringing you the very best in music by Japanese 
>> independent
>> artists!
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From dripton at ripton.net  Fri Dec 19 00:47:37 2008
From: dripton at ripton.net (David Ripton)
Date: Thu, 18 Dec 2008 23:47:37 -0800
Subject: [Twisted-Python] Pyjamas + web2py + twisted vs Django + Pinax
In-Reply-To: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>
References: <65BAE9EEDADD409CA83C32F2E54A0CB9@Podcaster>
Message-ID: <20081219074737.GA27406@vidar.dreamhost.com>

On 2008.12.19 10:44:49 +0900, Theron D. Huffman wrote:
> I'm about to start programming a game in Python. The game will be a web-based board game with a social aspect, something like http://www.chesspark.com. I want the game to run in both browsers and as a desktop client. Therefore I'm wondering what python-based technologies I need. I know that Javascript/AJAX is necessary for the browser part so I have decided on the following:
> 
> 1. Pyjamas -  (for the AJAX browser stuff)
> 
> 2. Pyjamas-desktop - (for the desktop client)
> 
> 3. Web2py (or djanjo, or django+pinax)  - for the website on which the game will run and for database access and social part - login, chat, members, profiles, game history, etc.)
> 
> 4. Twisted - for the networking and chat functionality.
> 
> 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I don't know if Pygame is necessary for a board-type game.)
> 
> My understanding of the above technologies is still limited and I'm not sure if I need all of these because some functionality may be overlapped. e.g. I don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
> 
> Can someone please give me some advice?

That's a fine laundry list of frameworks, but i believe getting all of
them to cooperate would be practically impossible.  (Note: a framework
is a library that's grown to the point where it thinks it owns your
whole program.  Getting multiple frameworks to play nicely together is
usually hard.  There are rare exceptions, like the beautiful integration
between Twisted and PyGTK, but they're rare.)

I know that Django and pygame and Twisted are useful, mature, documented
frameworks that actually get used in production by people other than
their authors.  I don't know about Pyjamas.

If putting 100% Python in one end and getting Ajax out the other is
really important to you, then you need Pyjamas to work.  (Or wait for
PyPy and its JavaScript backend to mature from experimental research
code to production-quality stuff.)  So my advice is to write a simple
tic-tac-toe game in Pyjamas, and find out.

-- 
David Ripton dripton at ripton.net



From tzury.by at gmail.com  Fri Dec 19 05:03:57 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Fri, 19 Dec 2008 14:03:57 +0200
Subject: [Twisted-Python] reactor.spawnProcess cause error fatal: The remote
	end hung up unexpectedly
Message-ID: <2f5ea7490812190403v7b8fe033p37000d9800497627@mail.gmail.com>

Hi,
I've posted about it yesterday and now after digging bit more, I am
more precise about the source of the errors I am receiving.

In short, I am willing to deploy on my server an SSH daemon which I can control
what commands can be executed, and by who.

I started with samples found on the web and at Twisted docs, and
continue from there.

I only tried to run git commands over SSH so far and the weird thing
is that it sometimes work, and sometimes not.

e.g. I type: 'git clone ssh://localhost:port/path/to/repo' I sometimes
get error, and sometimes not

at http://gist.github.com/37446 I pasted the server.py code. which is
a modification of what I've found at:
http://twistedmatrix.com/projects/conch/documentation/examples/sshsimpleserver.py

below is the console output on the client side

#first attempt
tzury at regulus:~$ git clone
ssh://tzury at localhost:5022/home/tzury/devel/ice/snoip/freespeech
clone-repo7
Initialized empty Git repository in /home/tzury/clone-repo7/.git/
remote: Counting objects: 347, done.
remote: Compressing objects: 100% (232/232), done.
Receiving objects: 100% (347/347), 91.75 KiB, done.
remote: Total 347 (delta 234), reused 177 (delta 114)
fatal: The remote end hung up unexpectedly
Resolving deltas: 100% (234/234), done.
error: waitpid (async) failed
fatal: error in sideband demultiplexer

#second attempt
tzury at regulus:~$ git clone
ssh://tzury at localhost:5022/home/tzury/devel/ice/snoip/freespeech
clone-repo7
Initialized empty Git repository in /home/tzury/clone-repo7/.git/
remote: Counting objects: 347, done.
remote: Compressing objects: 100% (232/232), done.
Receiving objects: 100% (347/347), 91.75 KiB, done.
remote: Total 347 (delta 234), reused 177 (delta 114)
Resolving deltas: 100% (234/234), done.
tzury at regulus:~$



--
Tzury Bar Yochay



-- 
Tzury Bar Yochay



From cary.hull at gmail.com  Fri Dec 19 09:04:32 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Fri, 19 Dec 2008 08:04:32 -0800
Subject: [Twisted-Python] Re: Pyjamas + web2py + twisted vs Django + Pinax
	(Cary Hull)
In-Reply-To: <6ABE70A3DF6D4A9AA8F6EA9A6E730561@Podcaster>
References: <E1LDUdL-0007mY-7o@cube.twistedmatrix.com>
	<6ABE70A3DF6D4A9AA8F6EA9A6E730561@Podcaster>
Message-ID: <3fce0ae70812190804u1aa6488aqc98754d23a9207bb@mail.gmail.com>

It would work for your 1, 3, and 4. There's a bit of documentation for both.
Athena is not a gui toolkit, however. It provides a nice bidirectional
rpc mechanism
between Nevow server and browser js.

Pyjamas desktop is just a wrapper to create a standalone packaging of
app resources with webkit.

I suppose that you don't want to get your hands dirty with js/dom.
It may be possible to hook the Pyjamas UI stuff to Athena, dunno.

Interesting article:
http://ejohn.org/blog/javascript-language-abstractions/

On Thu, Dec 18, 2008 at 10:14 PM, Theron D. Huffman
<huffman at tokyo.email.ne.jp> wrote:
> Thanks Cary,
>
> Where would Nevow/Athena fit in my strategy? 1, 2, 3 , or 4?
>
> Actually I have looked at Nevow/Athena and I'm very afraid of using it
> because there's only a few examples and a complete lack of documentation.
>
> Dan
>
>>
>> Message: 7
>> Date: Thu, 18 Dec 2008 17:57:54 -0800
>> From: "Cary Hull" <cary.hull at gmail.com>
>> Subject: Re: [Twisted-Python] Pyjamas + web2py + twisted vs Django +
>> Pinax
>> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
>> Message-ID:
>> <3fce0ae70812181757x8882d43lfa3d5f45ae463d6f at mail.gmail.com>
>> Content-Type: text/plain; charset=ISO-8859-1
>>
>> Have you looked at Nevow/Athena?
>> http://divmod.org/trac/wiki/DivmodNevow
>>
>> -Cary
>>
>> On Thu, Dec 18, 2008 at 5:44 PM, Theron D. Huffman
>> <huffman at tokyo.email.ne.jp> wrote:
>>>
>>> I'm about to start programming a game in Python. The game will be a
>>> web-based board game with a social aspect, something like
>>> http://www.chesspark.com. I want the game to run in both browsers and as
>>> a
>>> desktop client. Therefore I'm wondering what python-based technologies I
>>> need. I know that Javascript/AJAX is necessary for the browser part so I
>>> have decided on the following:
>>>
>>> 1. Pyjamas -  (for the AJAX browser stuff)
>>>
>>> 2. Pyjamas-desktop - (for the desktop client)
>>>
>>> 3. Web2py (or djanjo, or django+pinax)  - for the website on which the
>>> game
>>> will run and for database access and social part - login, chat, members,
>>> profiles, game history, etc.)
>>>
>>> 4. Twisted - for the networking and chat functionality.
>>>
>>> 5. Pygame - for most of the game stuff, sprites, inages, etc. (Actually I
>>> don't know if Pygame is necessary for a board-type game.)
>>>
>>> My understanding of the above technologies is still limited and I'm not
>>> sure
>>> if I need all of these because some functionality may be overlapped. e.g.
>>> I
>>> don't know where Pyjamas leaves off and where web2py/danjo/pinax begins.
>>>
>>> Can someone please give me some advice?
>>>
>>> Kindest Regards,
>>> Dan Huffman
>>>
>>> www.WHITokyo.info  What's Happening In Tokyo podcast
>>> www.Jindies.com  Bringing you the very best in music by Japanese
>>> independent
>>> artists!
>>> _______________________________________________
>>> Twisted-Python mailing list
>>> Twisted-Python at twistedmatrix.com
>>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
01100011 01100001 01110010 01111001



From dripton at ripton.net  Fri Dec 19 12:38:32 2008
From: dripton at ripton.net (David Ripton)
Date: Fri, 19 Dec 2008 11:38:32 -0800
Subject: [Twisted-Python] Two thumbs up for inotify.py
Message-ID: <20081219193832.GA16950@vidar.dreamhost.com>

I just tried the latest inotify.py from dialtone's sandbox, and I like
it.  

My application is a little PyGTK / Cairo recording data scope (closed
source) that needs to read lots of little files and plot lots of data
points in realtime.

I have my own inotify/ctypes wrapper (at the time I wrote it I found two
Python inotify wrappers; one was GPL and the other didn't work for me)
which works okay in this application.  But it's a bit gross because my
call to see if there are any inotify events is blocking (with a very
short timeout), rather than truly event-based.

To try inotify.py, I Twistified my code (easy because it was already
event-driven PyGTK), then changed all the inotify calls to use the
sandbox module's API rather than mine.  The only thing I disliked about
the API was having to pass the callbacks are to the watch method, rather
than the watch method returning a Deferred that I could addCallback on,
but that's just different, not actually hard or confusing.

Anyway, it works and my code is a bit smaller and cleaner than it was
before and uses a tad less CPU.  I hope this ends up in a Twisted
release.  I see #972 in the tracker, but it's been untouched for a
long time.  Should I comment there?

Thanks.

-- 
David Ripton    dripton at ripton.net



From dr.marc.byrd at gmail.com  Fri Dec 19 12:38:35 2008
From: dr.marc.byrd at gmail.com (Marc Byrd)
Date: Fri, 19 Dec 2008 11:38:35 -0800
Subject: [Twisted-Python] Mysql proxy in twisted ?
Message-ID: <a33934630812191138g1dbc8c9g41d98c8b395d19ca@mail.gmail.com>

Hi,

I was thinking of building a mysql proxy in twisted, wonder if there is
already such a thing (not found on first coupla pages of google search), and
if not, thoughts about building one.

[BTW, I'm quite familiar with mysql-proxy - not thrilled w/ LUA
scripting...]

If anyone is interested in helping, I'm definitely thinking open source.

Thanks,


Marc
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081219/15da9a0f/attachment.html>

From dialtone at gmail.com  Fri Dec 19 13:10:42 2008
From: dialtone at gmail.com (Valentino Volonghi)
Date: Fri, 19 Dec 2008 12:10:42 -0800
Subject: [Twisted-Python] Two thumbs up for inotify.py
In-Reply-To: <20081219193832.GA16950@vidar.dreamhost.com>
References: <20081219193832.GA16950@vidar.dreamhost.com>
Message-ID: <9B36E4D8-A998-4D1A-9D1F-F1FC3473BA29@gmail.com>


On Dec 19, 2008, at 11:38 AM, David Ripton wrote:

> To try inotify.py, I Twistified my code (easy because it was already
> event-driven PyGTK), then changed all the inotify calls to use the
> sandbox module's API rather than mine.  The only thing I disliked  
> about
> the API was having to pass the callbacks are to the watch method,  
> rather
> than the watch method returning a Deferred that I could addCallback  
> on,
> but that's just different, not actually hard or confusing.

That pisses me off too... The problem with the API you suggest is that  
it's
a one shot API and you should keep adding those callbacks and call
watch which is not doable here... I'm open to suggestions to change it  
even
with a custom Protocol class (Which probably would fit better in Twisted
maybe but that's more cumbersome than adding the callbacks IMHO).

> Anyway, it works and my code is a bit smaller and cleaner than it was
> before and uses a tad less CPU.  I hope this ends up in a Twisted
> release.  I see #972 in the tracker, but it's been untouched for a
> long time.  Should I comment there?


You probably should (and also add me in the CC list), then I'll take
care of the reviews that will come in, I should also find the time to
setup a twisted branch with ampoule inside.

-- 
Valentino Volonghi aka Dialtone
Now running MacOS X 10.5
Home Page: http://www.twisted.it
http://www.adroll.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081219/bddc3792/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20081219/bddc3792/attachment.sig>

From joe at strout.net  Sat Dec 20 07:10:53 2008
From: joe at strout.net (Joe Strout)
Date: Sat, 20 Dec 2008 07:10:53 -0700
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
Message-ID: <494CFCED.9080701@strout.net>

I'm trying to make a simple AIM bot that, in addition to responding when 
I talk to it, can also send me a message on its own initiative.  My code 
is based on SkippyTalkBot [1], but I confess that I don't understand it 
very well, and though I've been crawling the Twisted documentation for a 
few days now, it's still rather mysterious to me.

So I'm at a loss as to how to add an "idle" function that will allow my 
bot to periodically see whether it has something new to say to the user. 
  My code looks like this:

class B(oscar.BOSConnection):
     capabilities = [oscar.CAP_CHAT]

...

     def receiveMessage(self, user, multiparts, flags):
	"respond to an incoming message from the user"
	# (by calling self.sendMessage)

...

class OA(oscar.OscarAuthenticator):
    BOSClass = B

protocol.ClientCreator(reactor, OA, SN, PASS, 
icq=icqMode).connectTCP(*hostport)
reactor.run()


Now, from trawling the docs, I guess that I want to call 
reactor.callWhenRunning... but then I'd like to pass in a bound method 
of my B class, so it can call sendMessage on myself.  But I'm stumped as 
to how my B class is even being instantiated, let alone how to get a 
reference to that instance.  And the callWhenRunning idea is only a wild 
guess and probably wrong.

I'm sure the answer is in the Twisted docs or examples somewhere, but I 
haven't been able to find it.  Will someone have pity and share a clue?

Thanks,
- Joe


[1] http://www.gilesgoatboy.org/python/skippy.html




From exarkun at divmod.com  Sat Dec 20 07:28:07 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat, 20 Dec 2008 09:28:07 -0500
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
In-Reply-To: <494CFCED.9080701@strout.net>
Message-ID: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>

On Sat, 20 Dec 2008 07:10:53 -0700, Joe Strout <joe at strout.net> wrote:
>I'm trying to make a simple AIM bot that, in addition to responding when I 
>talk to it, can also send me a message on its own initiative.  My code is 
>based on SkippyTalkBot [1], but I confess that I don't understand it very 
>well, and though I've been crawling the Twisted documentation for a few days 
>now, it's still rather mysterious to me.
>
>So I'm at a loss as to how to add an "idle" function that will allow my bot 
>to periodically see whether it has something new to say to the user.

While this sometimes makes sense, it's usually *not* the approach you want
to take.  You're describing a solution which is essentially polling.  And
polling is not as good as responding to events.  You *could* run a function
ten times a second that looks around for a message to send and sends it if
it finds one.  Or, whatever event occurs which creates those messages could
just send the message instead of putting it in a pile and waiting for your
poller to find it.

I can't tell you how to do this in detail, though, since I don't know what
causes you to have messages to send.

> [snip]
>
>Now, from trawling the docs, I guess that I want to call 
>reactor.callWhenRunning...

Probably not.  If you want to run a function later (and that's how polling
is generally implemented), you want reactor.callLater.  If you want to run
a function repeatedly at a fixed interval, twisted.internet.task.LoopingCall
will help.

>but then I'd like to pass in a bound method of my 
>B class, so it can call sendMessage on myself.  But I'm stumped as to how my 
>B class is even being instantiated, let alone how to get a reference to that 
>instance.  And the callWhenRunning idea is only a wild guess and probably 
>wrong.

You'll probably encounter the same problem with reactor.callLater as you
were encountering with reactor.callWhenRunning, though.  How do you get
a reference to the bound method to pass in?  That's simple - don't call
the reactor method until you *have* an instance.  You can call almost any
reactor method even *after* the reactor is started; you do not have to set
everything up before you call reactor.run.

You can read more about reactor.callLater in the scheduling howto:

 http://twistedmatrix.com/projects/core/documentation/howto/time.html

Jean-Paul



From joe at strout.net  Sat Dec 20 08:28:20 2008
From: joe at strout.net (Joe Strout)
Date: Sat, 20 Dec 2008 08:28:20 -0700
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
In-Reply-To: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>
References: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>
Message-ID: <494D0F14.3000105@strout.net>

Jean-Paul Calderone wrote:

>> So I'm at a loss as to how to add an "idle" function that will allow 
>> my bot to periodically see whether it has something new to say to the 
>> user.
> 
> While this sometimes makes sense, it's usually *not* the approach you want
> to take.  You're describing a solution which is essentially polling.  And
> polling is not as good as responding to events.  You *could* run a function
> ten times a second that looks around for a message to send and sends it if
> it finds one.  Or, whatever event occurs which creates those messages could
> just send the message instead of putting it in a pile and waiting for your
> poller to find it.

Well, the thing is that there will actually be a great many things that 
could cause it to need to send a message, such as the time, a change in 
the outside temperature, a certain change in the value of a stock fund, 
etc.  And the AIM interface isn't the only interface to this bot.  So I 
really do think I need a way to call a function once every few seconds.

Now, that does suggest an alternative approach, which is to ignore 
twisted's event/idle mechanisms and use something external to it.  But 
I'm also fairly newish to Python, so I'm not sure exactly how to do that 
either -- reactor.run() is a blocking call, so I supposed I'd have to 
use threads.  Then my "idler thread" could call the idle function, sleep 
for a few seconds, and repeat.

But if there's a simple way to do this within Twisted, I'd like to learn 
what that is
.
>> Now, from trawling the docs, I guess that I want to call 
>> reactor.callWhenRunning...
> 
> Probably not.  If you want to run a function later (and that's how polling
> is generally implemented), you want reactor.callLater.  If you want to run
> a function repeatedly at a fixed interval, 
> twisted.internet.task.LoopingCall will help.

Thanks, I'll look at these.

> You'll probably encounter the same problem with reactor.callLater as you
> were encountering with reactor.callWhenRunning, though.  How do you get
> a reference to the bound method to pass in?  That's simple - don't call
> the reactor method until you *have* an instance.  You can call almost any
> reactor method even *after* the reactor is started; you do not have to set
> everything up before you call reactor.run.

OK, so somewhere within my B class, maybe in initDone, set it up there? 
    That makes sense.

Thanks,
- Joe




From radix at twistedmatrix.com  Sat Dec 20 09:35:56 2008
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 20 Dec 2008 11:35:56 -0500
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
In-Reply-To: <494D0F14.3000105@strout.net>
References: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>
	<494D0F14.3000105@strout.net>
Message-ID: <60ed19d40812200835v494b5ad3gd9a703ffe7cf1d0b@mail.gmail.com>

On Sat, Dec 20, 2008 at 10:28 AM, Joe Strout <joe at strout.net> wrote:
> Jean-Paul Calderone wrote:
>
>>> So I'm at a loss as to how to add an "idle" function that will allow my
>>> bot to periodically see whether it has something new to say to the user.
>>
>> While this sometimes makes sense, it's usually *not* the approach you want
>> to take.  You're describing a solution which is essentially polling.  And
>> polling is not as good as responding to events.  You *could* run a
>> function
>> ten times a second that looks around for a message to send and sends it if
>> it finds one.  Or, whatever event occurs which creates those messages
>> could
>> just send the message instead of putting it in a pile and waiting for your
>> poller to find it.
>
> Well, the thing is that there will actually be a great many things that
> could cause it to need to send a message, such as the time, a change in the
> outside temperature, a certain change in the value of a stock fund, etc.
>  And the AIM interface isn't the only interface to this bot.  So I really do
> think I need a way to call a function once every few seconds.

Just because you have a number of sources doesn't mean you
intrinsically can't use them in an efficient, event-oriented manner.
And you don't need a time-based call *just* because you have more than
one interface to the bot.

A timed poll may end up the easiest solution for you, but I want to
make sure you understand the way events work, because there may be a
much better solution. Let's go over your example event sources:

Time - Easy: your event source there is reactor.callLater itself.
Change in the temperature - How does your thermostat communicate this
information? A serial connection? a TCP socket? in any case, you can
probably hook up to that event source with Twisted directly.
Stock price - same question.

The point is that you can hook into these event sources with some code
that will immediately send the message out over your AIM (or IRC, or
whatever other) interface to the bot. That means communication will be
instantaneous *and* efficient.

-- 
Christopher Armstrong
http://radix.twistedmatrix.com/
http://planet-if.com/
http://canonical.com/



From joe at strout.net  Sat Dec 20 12:26:48 2008
From: joe at strout.net (Joe Strout)
Date: Sat, 20 Dec 2008 12:26:48 -0700
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
In-Reply-To: <60ed19d40812200835v494b5ad3gd9a703ffe7cf1d0b@mail.gmail.com>
References: <20081220142807.20272.1526590108.divmod.quotient.24568@ohm>	<494D0F14.3000105@strout.net>
	<60ed19d40812200835v494b5ad3gd9a703ffe7cf1d0b@mail.gmail.com>
Message-ID: <494D46F8.7070105@strout.net>

Christopher Armstrong wrote:

> Just because you have a number of sources doesn't mean you
> intrinsically can't use them in an efficient, event-oriented manner.

No, but when these "sources" as you call them are external data sources 
that I have to periodically check (have to -- there is no way to make 
these external contact my app when something changes), that is 
inherently a polling situation.

> And you don't need a time-based call *just* because you have more than
> one interface to the bot.

True; that just makes it easier.

> Change in the temperature - How does your thermostat communicate this
> information?

I'm accessing a web service.

> Stock price - same question.

Same answer.  These services give you an answer when you ask for them; 
they don't come to you when a value changes.

Anyway, I think I have the answer I need 
(twisted.internet.task.LoopingCall), and I thank you all for it.


Best,
- Joe




From manlio_perillo at libero.it  Sat Dec 20 14:37:16 2008
From: manlio_perillo at libero.it (Manlio Perillo)
Date: Sat, 20 Dec 2008 22:37:16 +0100
Subject: [Twisted-Python] Mysql proxy in twisted ?
In-Reply-To: <a33934630812191138g1dbc8c9g41d98c8b395d19ca@mail.gmail.com>
References: <a33934630812191138g1dbc8c9g41d98c8b395d19ca@mail.gmail.com>
Message-ID: <494D658C.5040401@libero.it>

Marc Byrd ha scritto:
> Hi,
> 
> I was thinking of building a mysql proxy in twisted, wonder if there is 
> already such a thing (not found on first coupla pages of google search), 
> and if not, thoughts about building one.
> 

After having written a PostgreSQL client in Twisted:
http://hg.mperillo.ath.cx/twisted/pglib/

I have tried to implement a MySQL client, but the MySQL protocol is 
*really* bad designed.

 > [...]


Regards  Manlio Perillo



From andrewfr_ice at yahoo.com  Sat Dec 20 15:13:01 2008
From: andrewfr_ice at yahoo.com (Andrew Francis)
Date: Sat, 20 Dec 2008 14:13:01 -0800 (PST)
Subject: [Twisted-Python] how to get an idle callback while running a
	reactor?
Message-ID: <216266.16154.qm@web34205.mail.mud.yahoo.com>

Message: 6
Date: Sat, 20 Dec 2008 08:28:20 -0700
From: Joe Strout <joe at strout.net>
Subject: Re: [Twisted-Python] how to get an idle callback while
    running a    reactor?
To: Twisted general discussion <twisted-python at twistedmatrix.com>
Message-ID: <494D0F14.3000105 at strout.net>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi Joe:

>Well, the thing is that there will actually be a great many things that
>could cause it to need to send a message, such as the time, a change in
>the outside temperature, a certain change in the value of a stock fund,
>etc.  And the AIM interface isn't the only interface to this bot. 

I would argue all these things can be viewed external events - even time (imagine a clock source is calling your system every N time units). In turn, your programme reacts to the external events.  

At a more concrete level, you have to ask yourself questions like "is my programme a client, a server (or both)? That is, is my programme making connections? Or is it waiting for connections? This will affect how you structure and start-up your application. From I see SkippyTalkBot is a client.

>Now, that does suggest an alternative approach, which is to ignore
>twisted's event/idle mechanisms and use something external to it.  But
>I'm also fairly newish to Python, so I'm not sure exactly how to do that
>either -- reactor.run() is a blocking call, so I supposed I'd have to
>use threads.

Yes under the hood reactor.run() blocks. However the reactor is what effectively starts a Twisted application. I would argue that under most circumstances, you probably don't care that the reactor blocks because your application isn't doing anything until it receives an event from the reactor. As for threads. Off hand, I suspect you don't need threads .....

>But if there's a simple way to do this within Twisted, I'd like to learn
>what that is

Let us pretend your programme polls various network sources at regular intervals. So perhaps your code could look like:

if __name__ == "__main__":
   # it may be helpful to keep track of the task objects
   source['source-a] = task.LoopingCall(callback-for-stockTicker, ...)
   source['source-b] = task.loopingCall(callback-for-thermostat, ...)
   source['source-c] = task.loopingCall(callback-for-timer, ....)

   for source in sources:
       source.start(someInterval, True | False)
   reactor.run()

and each callback-for-X sets up the appropriate call to the remove source and its callback chain.

# assume we are using SOAP
def callback-for-stockTicker():
    ticker = soap.Proxy(....)
    ticker.callRemote(....).addCallback().addErrback()


Cheers,
Andrew










      



From exarkun at twistedmatrix.com  Sat Dec 20 22:05:10 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 21 Dec 2008 05:05:10 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1229835910.03.349833342@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081221/6ee6ff17/attachment.html>

From glyph at divmod.com  Sun Dec 21 00:51:14 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Sun, 21 Dec 2008 07:51:14 -0000
Subject: [Twisted-Python] Weekly Bug Summary
In-Reply-To: 1229835910.03.349833342@twistedmatrix.com
References: 1229835910.03.349833342@twistedmatrix.com
Message-ID: <20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>


On 05:05 am, exarkun at twistedmatrix.com wrote:
>Bugs opened: 12    Bugs closed: 13  Total open bugs: 1055 (-1)
                                                           ^^^^

Every week I see this number is negative (even if only a little) I do a 
little victory dance.

I think we should have a party when we get to <1000 total open bugs. 
Anybody else interested?



From glyph at divmod.com  Sun Dec 21 01:20:32 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Sun, 21 Dec 2008 08:20:32 -0000
Subject: [Twisted-Python] What to do when a service fails to start, also, 
	deferred and startService
In-Reply-To: <18736.4217.759501.381840@jon.es>
References: <18734.54780.97710.644648@jon.es>
	<20081128140217.12555.360367893.divmod.xquotient.628@weber.divmod.com>
	<18736.4217.759501.381840@jon.es>
Message-ID: <20081221082032.12555.570369233.divmod.xquotient.2379@weber.divmod.com>


On 28 Nov, 03:38 pm, terry at jon.es wrote:
>Hi Glyph
>
>Thanks for the detailed reply.

No problem, sorry it took so long to get back to this; I definitely left 
the conversation halfway through.
>>>>>>"glyph" == glyph  <glyph at divmod.com> writes:
>glyph> On 27 Nov, 05:16 pm, terry at jon.es wrote:

>glyph> The key question here is: indicate to whom?  If you want to 
>indicate
>glyph> it to some other object, well, try:except: or addErrback and 
>call a
>glyph> method on that object.  Nothing magic about it.
>
>I have code written as a Twisted plugin. So I have a class implementing
>IServiceMaker and IPlugin, and I create an instance of that class which
>gets found when I invoke twistd from the command line.
>
>So in my case I want to indicate to twistd that the service that my 
>class
>creates a makeService method to create, but which I do not set in 
>motion,
>has failed to start and that twistd should exit, or do something other 
>than
>cheerfully tell me that there's been an Unhandled Error.

>Does that make more sense? Sorry, I should have said I was using 
>twistd.

Yes.  And I think that this is a good use-case for making IService a bit 
deeper than it is.  twistd (and, one day, other tools that might be able 
to start IService objects) potentially needs some more information so it 
can make a more intelligent high-level decision about what to do next.

My previous messages were basically saying "you can't do what you want 
with IService".  i.e. you can't write your own code to do something 
clever and somehow have dependencies and notifications to users of 
"twistd" fall out of that.  But that shouldn't be taken as an indication 
that twistd itself shouldn't be improved.

For reasons I brought up in previous messages, exiting is not always the 
right thing to do.  But in some cases (*none* of the services on offer 
were able to start up, for example) it might be.
>I'm not sure what should happen. I'm sitting at the command line, I've
>asked twistd to start something for me, there's clearly been a problem
>doing so (and this doesn't have to be baroque, maybe I just couldn't 
>listen
>on a specific port I wanted, or maybe my code somehow raised an 
>Exception),
>but I don't seem to have a mechanism for having twistd take any notice 
>at
>all.

Keep in mind that you may be sitting on the other end of a blackberry 
which needs to get an email when 'twistd' fails to start up after a 
server reboot - you're not necessarily at a command line.  One of the 
reasons that no mechanism has yet evolved for propagating interesting 
status messages about services is that there's no obvious channel for 
those messages to be communicated to.
>In the case of a service being started by twistd, it doesn't seem as 
>simple
>as you describe, but maybe that's my lack of understanding again.
>I can easily subclass IService, but something else is calling the 
>startService
>method of that subclass. And that thing, whatever it is, is not 
>expecting
>me to return a deferred. So if my startService has for some reason got 
>its
>hands on a deferred, it can't simply hand it back to its caller and 
>have
>something (twistd in my case) see that an error occurred.

>It does feel like I have to track down what this something else might
>be.

It's not that you've failed to understand something - you have correctly 
identified that there is nothing to understand :).  You need to go find 
that thing ("whatever it is" ;-)) in twistd that's invoking the very 
first call to IService.startService (and privilegedStartService as well) 
and propose a concrete way to make it smarter.

(I've elided your exploration of twisted code, but you're basically 
looking in the right direction.)
>So should I write my own twistd?

No way, man, it's open source!  Not writing your own is the whole point! 
Open a ticket, write a patch.  If you're not really sure what the patch 
should do, we can continue this discussion about reporting startup 
errors and service dependencies here.  This poorly-specified ticket 
indicates that other developers have had similar problems in the past: 
http://twistedmatrix.com/trac/ticket/1572
>All this doesn't seem to be a matter of
>simple subclassing. Plus, I can't just go in and start editing the
>top-level functions in twisted/application/app.py and
>twisted/scripts/_twistd_unix.py or code that imports app, etc.

Sure you can.  Then, you take the results of running 'svn diff' on the 
copy of Twisted where you did that, and... :)
>Sorry for so many questions - I really don't know if I'm missing 
>something
>simple here. I do enjoy digging into all this, and I appreciate your
>apparently limitless patience. I wish I knew it all better. Twisted is
>complex and it's a pretty good bet that anything you think of or run 
>into
>as a n00b has been thought of or encountered before, and that whatever 
>way
>you think of to solve it will probably be non-optimal, or plain wrong, 
>or
>in ignorance of a solution someone much more experienced has already
>implemented, or... etc.  Hence my many questions.

Unfortunately it's equally likely that it's come up a million times and 
a half dozen people know it's an unresolved issue but it's never been 
filed as a ticket and never been clearly framed as a specific problem 
rather than a vague architectural queasiness.  The value of a good 
ticket should not be underestimated.
>In fact I have something like a process pool running in one service and 
>I
>talk to it from another machine. I say "hey, process pool, start me up 
>the
>following service (a twistd service)" and I would then like to know if 
>that
>service started, and if not then why not. So having twistd fail or 
>report
>an error if it can't start a service would be useful.

Quite so.  But, this is a great example of how this is a use-case beyond 
twistd's current capabilities, but not out of the scope of its eventual 
ambition.  It isn't currently designed to manage processes on remote 
machines.  Maybe ampoule has something which does?  I don't know, that's 
a tricky area which requires a lot of thought beyond this one feature.
>glyph> Doing either of those things would definitely be wrong.  There's 
>no
>glyph> reason to sys.exit or reactor.stop if your application can't 
>start
>glyph> up, unless your management system specifically calls for such a
>glyph> thing.
>
>Maybe this is a case where it's (semi-)justified. At least if I called
>sys.exit the twistd process would go away, instead of sitting there 
>acting
>as though nothing's wrong :-) I can also, of course, try interacting 
>with
>the service I think I just started on the remote machine, and if I 
>can't
>then I can tell the original process pool to kill the twistd process. 
>But
>that seems a pretty roundabout alternative to just having twistd notice
>that something went awry when calling startService.

It may be worthwhile, before writing a patch, to devise your *own* 
error-reporting channel on top of twistd.  For example, a dedicated 
error-report-processing server listening on a dedicated port.  Then you 
can specify your own enhanced-IService interface that handles 
dependencies and deferreds and whatever else you need, and an adapter to 
hooks it up to twistd via IService but reports errors to your external 
error-reporting channel.  Once you're sure that design works, it should 
be straightforward to change the implementation of twistd to honor your 
expanded interface, and provide an alternate implementation of the 
error-reporting channel.
>glyph> In the future, even the Twisted plugin code might be starting 
>some
>glyph> things in addition to your application.  As I mentioned above, a
>glyph> good reason to do that is to perform diagnostics on failed 
>startups
>glyph> :).
>
>I assume you really mean "startups" and not "services". In which case, 
>I'm
>100% sure there's something funny here, but I can't figure it out. I'd 
>love
>to know, and I'm smiling broadly in any case. Too bad email loses so 
>much
>humor.....  we can always try though.

By "startups" I simply meant "attempts to start-up a service" i.e. calls 
to startService.  I'm sure there is a truckload of subtle and completely 
unintentional humor in there somewhere though.



From andrew-twisted at puzzling.org  Sun Dec 21 02:19:50 2008
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 21 Dec 2008 20:19:50 +1100
Subject: [Twisted-Python] Weekly Bug Summary
In-Reply-To: <20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>
References: <20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>
Message-ID: <20081221091950.GB32606@steerpike.home.puzzling.org>

glyph at divmod.com wrote:
>
> On 05:05 am, exarkun at twistedmatrix.com wrote:
>> Bugs opened: 12    Bugs closed: 13  Total open bugs: 1055 (-1)
>                                                           ^^^^
>
> Every week I see this number is negative (even if only a little) I do a  
> little victory dance.
>
> I think we should have a party when we get to <1000 total open bugs.  
> Anybody else interested?

File a ticket to have a party, so you don't forget ;)

-Andrew.




From lists at collab.nl  Sun Dec 21 10:53:38 2008
From: lists at collab.nl (Thijs Triemstra | Collab)
Date: Sun, 21 Dec 2008 17:53:38 +0000
Subject: [Twisted-Python] Weekly Bug Summary
In-Reply-To: <20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>
References: 1229835910.03.349833342@twistedmatrix.com
	<20081221075114.12555.1952158314.divmod.xquotient.2327@weber.divmod.com>
Message-ID: <35BD87CA-8439-48DB-B171-3B32943F5D4D@collab.nl>

On 21 Dec 2008, at 07:51, glyph at divmod.com wrote:
>
> On 05:05 am, exarkun at twistedmatrix.com wrote:
>> Bugs opened: 12    Bugs closed: 13  Total open bugs: 1055 (-1)
>                                                          ^^^^
>
> Every week I see this number is negative (even if only a little) I  
> do a little victory dance.
>
> I think we should have a party when we get to <1000 total open bugs.  
> Anybody else interested?

Definitely! I'm in London nowadays, and I guess most of you are in the  
US but always up for a party.  :)

Cheers,

Thijs

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081221/9931696e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 194 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20081221/9931696e/attachment.sig>

From fetbiz at gmail.com  Mon Dec 22 01:48:18 2008
From: fetbiz at gmail.com (biziap biziap)
Date: Mon, 22 Dec 2008 16:48:18 +0800
Subject: [Twisted-Python] How is happened?
Message-ID: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>

I am trying to migrate to web2. And find the "OldRequestAdapter".
What I did is callling:

## in a resource of web2
def render(self,web2_request):
    request = twisted.web2.compat.makeOldRequestAdapter(web2_request)



  File "c:\python25\Lib\site-packages\twisted\web2\compat.py", line 336, in
getSession
    cookiename = string.join(['TWISTED_SESSION'] + self.sitepath, "_")
AttributeError: 'OldRequestAdapter' object has no attribute 'sitepath'
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081222/f3e9fde5/attachment.html>

From fetbiz at gmail.com  Mon Dec 22 01:50:14 2008
From: fetbiz at gmail.com (biziap biziap)
Date: Mon, 22 Dec 2008 16:50:14 +0800
Subject: [Twisted-Python] Re: How is happened?
In-Reply-To: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>
References: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>
Message-ID: <d067ddcf0812220050n176cdf38i467670dd240b9f7c@mail.gmail.com>

2008/12/22 biziap biziap <fetbiz at gmail.com>

> I am trying to migrate to web2. And find the "OldRequestAdapter".
> What I did is callling:
>
> ## in a resource of web2
> def render(self,web2_request):
>     request = twisted.web2.compat.makeOldRequestAdapter(web2_request)
>     ...
>
       request.getSession()

>
>  then the exception was thrown:
>
>   File "c:\python25\Lib\site-packages\twisted\web2\compat.py", line 336, in
> getSession
>     cookiename = string.join(['TWISTED_SESSION'] + self.sitepath, "_")
> AttributeError: 'OldRequestAdapter' object has no attribute 'sitepath'
>

Any hints are appericated.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081222/4dec3a7f/attachment.html>

From p.mayers at imperial.ac.uk  Mon Dec 22 04:33:30 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 22 Dec 2008 11:33:30 +0000
Subject: [Twisted-Python] Re: How is happened?
In-Reply-To: <d067ddcf0812220050n176cdf38i467670dd240b9f7c@mail.gmail.com>
References: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>
	<d067ddcf0812220050n176cdf38i467670dd240b9f7c@mail.gmail.com>
Message-ID: <494F7B0A.4020800@imperial.ac.uk>

biziap biziap wrote:
> 
> 
> 2008/12/22 biziap biziap <fetbiz at gmail.com <mailto:fetbiz at gmail.com>>
> 
>     I am trying to migrate to web2. And find the "OldRequestAdapter".
>     What I did is callling:
>      
> 
> Any hints are appericated.
> 

  1. Ask on the twisted-web list
  2. Don't use web2: http://twistedmatrix.com/trac/wiki/TwistedWebPlan



From tzury.by at gmail.com  Mon Dec 22 06:45:56 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Mon, 22 Dec 2008 15:45:56 +0200
Subject: [Twisted-Python] 
	twisted.conch.ssh.session.SSHSession.request_subsystem
Message-ID: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>

Hi all,

I've managed to come up with a minimal sftp server implementation
which able to auth users using rsa_key

the code is available at: http://gist.github.com/37446

The point is that I am missing the knowledge needed in order to add
path control.
That is, controlling which path(s) a user can access.

at http://twisted.conch.ssh.session.SSHSession.html#request_subsystem
it appears to be undocumented

Would love to get some references, samples, etc.

Thanks in advance,
 Tzury



From glyph at divmod.com  Mon Dec 22 08:38:59 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Mon, 22 Dec 2008 15:38:59 -0000
Subject: [Twisted-Python]
	twisted.conch.ssh.session.SSHSession.request_subsystem
In-Reply-To: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
References: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
Message-ID: <20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>

On 01:45 pm, tzury.by at gmail.com wrote:
>the code is available at: http://gist.github.com/37446
>
>The point is that I am missing the knowledge needed in order to add
>path control.
>That is, controlling which path(s) a user can access.

UnixSSHRealm is a realm which returns SSH avatars that, like OpenSSH, 
can run arbitrary shell commands as the given UNIX user.

The way you control which paths a user can access in this scenario is by 
setting the filesystem permissions on those directories.  Sorry, but 
Twisted cannot magically change your UNIX filesystem so that arbitrary 
commands see a different view of it.

If you want to write an SSH application server that does *not* allow 
running UNIX commands, you are going to have to write a lot more code; 
in effect, emulating a shell (or denying access to one entirely, as 
described in http://cyli.livejournal.com/38382.html )
>at http://twisted.conch.ssh.session.SSHSession.html#request_subsystem
>it appears to be undocumented

This code could definitely be better documented, but I don't think your 
question is related to subsystems.  In order to see why, it would be 
helpful for you to understand http://www.ietf.org/rfc/rfc4254.txt 
section 6.5, "starting a shell or command", first.  (A subsystem is just 
a kind of command you can run.)



From drew.smathers at gmail.com  Mon Dec 22 10:27:55 2008
From: drew.smathers at gmail.com (Drew Smathers)
Date: Mon, 22 Dec 2008 12:27:55 -0500
Subject: [Twisted-Python] Re: How is happened?
In-Reply-To: <494F7B0A.4020800@imperial.ac.uk>
References: <d067ddcf0812220048o7c590861p31ad7f36edd12e8e@mail.gmail.com>
	<d067ddcf0812220050n176cdf38i467670dd240b9f7c@mail.gmail.com>
	<494F7B0A.4020800@imperial.ac.uk>
Message-ID: <368574aa0812220927u78f795c7u7d2be1782af1156c@mail.gmail.com>

On Mon, Dec 22, 2008 at 6:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:
> biziap biziap wrote:
>>
>>
>> 2008/12/22 biziap biziap <fetbiz at gmail.com <mailto:fetbiz at gmail.com>>
>>
>>    I am trying to migrate to web2. And find the "OldRequestAdapter".
>>    What I did is callling:
>>
>> Any hints are appericated.
>>
>
>  1. Ask on the twisted-web list
>  2. Don't use web2: http://twistedmatrix.com/trac/wiki/TwistedWebPlan
>

<facetious>
I think at this point twisted.web2 should be renamed
twisted.web2pleasedontusethis.
</facetious>

-Drew



From tzury.by at gmail.com  Mon Dec 22 12:10:23 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Mon, 22 Dec 2008 21:10:23 +0200
Subject: [Twisted-Python]
	twisted.conch.ssh.session.SSHSession.request_subsystem
In-Reply-To: <20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>
References: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
	<20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>
Message-ID: <2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>

Glyph, thanks for your attention and time. I am afraid I was not clear
wit hmy question so please allow me to elaborate.

> The way you control which paths a user can access in this scenario is by
> setting the filesystem permissions on those directories.  Sorry, but Twisted
> cannot magically change your UNIX filesystem so that arbitrary commands see
> a different view of it.

I don't want to create a UNIX user per client. I want to design the
system in a way that all the clients will access using one single
'public' account.
In fact, each client is already pushing its files to it associated
'home' folder.
However, I want to be able to control it in case someone is hacking
with the system, so to ensure it cannot access any other paths but the
one which is associated with its rsa_key

I've investigated jailkit and gitosis and other approaches and was not
satisfied with the final result. That's the reason why I am not using
OpenSSH server and trying to make it possible with Twisted. I think it
will make a much more scalable and flexible system.
I strongly believe that others will find this project useful.

> If you want to write an SSH application server that does *not* allow running
> UNIX commands, you are going to have to write a lot more code; in effect,
> emulating a shell (or denying access to one entirely, as described in
> http://cyli.livejournal.com/38382.html )

I don't want to supply shell or any other interactive mode for a user.
This is all to be done at the client side 'automatically' using custom
sftp/ssh client

e.g. bzr branch sftp://user at server:port/allowed_path_only

> This code could definitely be better documented, but I don't think your
> question is related to subsystems.

when running the command mentioned above (bzr branch
sftp://user at server:port/allowed_path_only)  only
SSHSession.request_subsystem is called (neither request_shell nor
request_exec) - that's why I brought it up.



From tzury.by at gmail.com  Mon Dec 22 13:48:01 2008
From: tzury.by at gmail.com (Tzury Bar Yochay)
Date: Mon, 22 Dec 2008 22:48:01 +0200
Subject: [Twisted-Python]
	twisted.conch.ssh.session.SSHSession.request_subsystem
In-Reply-To: <2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>
References: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
	<20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>
	<2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>
Message-ID: <2f5ea7490812221248v5a446077le267a9625931bbbd@mail.gmail.com>

I managed to hack this by patching the _absPath method as follows:

# put in my main file

def absPath(self, path):
    # users is my own object which manages the users in the system
    profile = users.get(self.avatar.username)
    if profile:
        home = self.avatar.getHomeDir()
        abspath = os.path.abspath(os.path.join(home, path))
        if abspath.startswith(profile.home_path):
            return abspath


SFTPServerForUnixConchUser._absPath = absPath


Not elegant, but this is good enough for me to move on.



From glyph at divmod.com  Mon Dec 22 19:26:38 2008
From: glyph at divmod.com (glyph at divmod.com)
Date: Tue, 23 Dec 2008 02:26:38 -0000
Subject: [Twisted-Python]
	twisted.conch.ssh.session.SSHSession.request_subsystem
In-Reply-To: <2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>
References: <2f5ea7490812220545j7a26028ar68c1756d376bcca2@mail.gmail.com>
	<20081222153859.12555.1610646874.divmod.xquotient.2409@weber.divmod.com>
	<2f5ea7490812221110r467b5ebfyb4f2525a21147b86@mail.gmail.com>
Message-ID: <20081223022638.12555.2059177658.divmod.xquotient.2468@weber.divmod.com>

On 22 Dec, 07:10 pm, tzury.by at gmail.com wrote:
>Glyph, thanks for your attention and time. I am afraid I was not clear
>wit hmy question so please allow me to elaborate.

>>The way you control which paths a user can access in this scenario is 
>>by
>>setting the filesystem permissions on those directories.  Sorry, but 
>>Twisted
>>cannot magically change your UNIX filesystem so that arbitrary 
>>commands see
>>a different view of it.
>
>I don't want to create a UNIX user per client. I want to design the
>system in a way that all the clients will access using one single
>'public' account.

The key question is: do you just want an sftp server?  Or are you trying 
to write a real SSH server, that can run commands?
>e.g. bzr branch sftp://user at server:port/allowed_path_only

So, not "bzr+ssh://"?
>when running the command mentioned above (bzr branch
>sftp://user at server:port/allowed_path_only)  only
>SSHSession.request_subsystem is called (neither request_shell nor
>request_exec) - that's why I brought it up.

I believe "bzr+ssh://" will run request_exec instead.  (It will try to 
run 'bzr'.)



From samslists at gmail.com  Tue Dec 23 21:01:09 2008
From: samslists at gmail.com (Sam's Lists)
Date: Tue, 23 Dec 2008 20:01:09 -0800
Subject: [Twisted-Python] Compress/deflate support for getPage...
In-Reply-To: <20081209043453.12555.1842136836.divmod.xquotient.1812@weber.divmod.com>
References: <558124520812081600u135a426cw97daef749e18b6b8@mail.gmail.com>
	<15F3F135-BFCD-4446-B979-5E2F50E2DC04@metaweb.com>
	<20081209043453.12555.1842136836.divmod.xquotient.1812@weber.divmod.com>
Message-ID: <558124520812232001i36e45c6btc7a0c4e32e08228f@mail.gmail.com>

I've checked out the expressive http version of the code mentioned in the
ticket, but  I still can't seem to figure out how to get access to the
response headers.

Aaron..do you have an example of how you used HTTPClientFactory?

Any suggestions about the best way to implement this using either the
official twisted branch or the expressive client branch would be helpful.
I've implemented similar functionality in the past around urllib2, but my
experience with Twisted is very limited.

I've been looking at the code for the past two hours.  I just can't figure
it out.  :(

Thanks!



On Mon, Dec 8, 2008 at 8:34 PM, <glyph at divmod.com> wrote:

>
> getPage has a number of deficiencies.  JP Calderone and Itamar Shtull-
> Trauring have been working on this ticket: <
> http://twistedmatrix.com/trac/ticket/886> which (among other things) adds
> support for response headers and the hooks with which one would implement
> deflate support.
>
>
> On 12:47 am, alecf at metaweb.com wrote:
>
>> Along similar lines, is there a better API than getPage() that allows you
>> to get headers, content-type, etc? The below could be easiliy implemented as
>> a callback if the callback knew what headers it got, so it knew whether or
>> not to deflate the body.
>>
>> Alec
>>
>> On Dec 8, 2008, at 4:00 PM, Sam's Lists wrote:
>>
>>> Is there any support for compress/deflate for webpages using the web
>>> client via getPage?
>>>
>>> If not, does anyone have a wrapper function before I make my own?
>>>
>>> Thanks
>>>
>>> _______________________________________________
>>> Twisted-Python mailing list
>>> Twisted-Python at twistedmatrix.com
>>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>>
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081223/cfc6d4d9/attachment.html>

From apenon at gmail.com  Fri Dec 26 08:47:49 2008
From: apenon at gmail.com (Deniz Pecel)
Date: Fri, 26 Dec 2008 15:47:49 +0000
Subject: [Twisted-Python] ssh v1 support
Message-ID: <6a9316280812260747r12b0cafaq187a8e1311a23b09@mail.gmail.com>

Hi List
Does twisted support ssh v1?
thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081226/a14bce0e/attachment.html>

From cary.hull at gmail.com  Fri Dec 26 09:17:21 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Fri, 26 Dec 2008 08:17:21 -0800
Subject: [Twisted-Python] ssh v1 support
In-Reply-To: <6a9316280812260747r12b0cafaq187a8e1311a23b09@mail.gmail.com>
References: <6a9316280812260747r12b0cafaq187a8e1311a23b09@mail.gmail.com>
Message-ID: <3fce0ae70812260817r463a8248i935375f304302072@mail.gmail.com>

Not out of the box. Conch is ssh2 only. However, you can attain ssh1
support by wrapping the binary (ssh) with a ProcessProtocol:

http://twistedmatrix.com/projects/core/documentation/howto/process.html

Before you start on your own implementation I would wait to see if
anyone has done this already and wouldn't mind sharing. :)

-Cary

On Fri, Dec 26, 2008 at 7:47 AM, Deniz Pecel <apenon at gmail.com> wrote:
> Hi List
> Does twisted support ssh v1?
> thanks
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From rhythm.mail at gmail.com  Sat Dec 27 06:21:29 2008
From: rhythm.mail at gmail.com (Lian Cheng)
Date: Sat, 27 Dec 2008 21:21:29 +0800
Subject: [Twisted-Python] A question about ITransport.write()
Message-ID: <gj5a53$mqj$1@ger.gmane.org>

Hi, all

As a Twisted newbie, I read the Twisted documentation, and found that:

   1. ITransport.write() doesn't return a deferred.
   2. IProtocol doesn't have a dataSent() callback or something alike.

Since ITransport.write() is a non-blocking call, how can I be informed 
when data sent by ITransport.write() is actually sent successfully?

Cheers
Cheng




From mail.sensenmann at googlemail.com  Sat Dec 27 11:08:18 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Sat, 27 Dec 2008 19:08:18 +0100
Subject: [Twisted-Python] Twisted and Urwid
Message-ID: <717b5780812271008m59aae955s3ba36c090ea078f2@mail.gmail.com>

Hi folks.

I've got a new question. After recongnising that the python bindings for
curses are not fully capable of displaying the unicode-chars I decided to
drop curses and shifted to urwid. Now I've got some basic questions in the
matter of urwid and twisted. As you may know I'm using a mvc-pattern and I
have not discovered a way to combine _and_ start urwid with twisted yet.
Maybe someone who already worked with urwid can give me a small hint.

Code:

http://codepad.org/0Hlvmp1b

class Input:
    def __init__(self,term):
        self.term = term
        self.size = self.term.get_cols_rows()
        self.input = urwid.Edit()
        self.filler = urwid.Filler(self.input)
        self.canvas = self.filler.render( self.size, focus=True )
        self.term.draw_screen(self.size,self.canvas)
        reactor.addReader(self)

    def fileno(self):
        return 0

    def logPrefix(self):
        return 'CursesClient'

    def doRead(self):
        keys = self.term.get_input_nonblocking()
        for key in keys:
            if key == 'window resize':
                self.size = self.term.get_cols_rows()
            elif key == 'enter':
                text = self.input.get_edit_text()
                controller.sendMsg('dev',text)
                self.input.set_edit_text('')
            else:
                self.filler.keypress(self.size, key)

term = urwid.raw_display.Screen()
term.run_wrapper(lambda: Input(term))



Traceback (most recent call last):
  File "./keckz.py", line 44, in <module>
    f.startKeckz(f.host, f.view)
  File "./keckz.py", line 38, in startKeckz
    controllerKeckz.Kekzcontroller(View).startConnection(host,23002)
  File "/home/arch/keckz/trunk/controllerKeckz.py", line 13, in __init__
    self.view = interface(self)
  File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in __init__
    self.term.run_wrapper(lambda: Input(self.term))
  File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line
212, in run_wrapper
    return fn()
  File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in <lambda>
    self.term.run_wrapper(lambda: Input(self.term))
  File "/home/arch/keckz/trunk/urwid_cli.py", line 55, in __init__
    self.term.draw_screen(self.size,self.canvas)
  File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line
579, in draw_screen
    assert self.palette.has_key(a), `a`
AssertionError: None
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081227/f183a48a/attachment.html>

From exarkun at twistedmatrix.com  Sat Dec 27 22:05:10 2008
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 28 Dec 2008 05:05:10 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1230440710.81.2068063256@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081228/afdaa398/attachment.html>

From andrew-twisted at puzzling.org  Sun Dec 28 00:13:17 2008
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 28 Dec 2008 18:13:17 +1100
Subject: [Twisted-Python] A question about ITransport.write()
In-Reply-To: <gj5a53$mqj$1@ger.gmane.org>
References: <gj5a53$mqj$1@ger.gmane.org>
Message-ID: <20081228071317.GA24777@steerpike.home.puzzling.org>

Lian Cheng wrote:
> Hi, all
>
> As a Twisted newbie, I read the Twisted documentation, and found that:
>
>   1. ITransport.write() doesn't return a deferred.
>   2. IProtocol doesn't have a dataSent() callback or something alike.
>
> Since ITransport.write() is a non-blocking call, how can I be informed  
> when data sent by ITransport.write() is actually sent successfully?

It depends on what exactly you mean by "successfully".  Just because Twisted
has delivered the bytes to the OS for delivery (e.g. via the send(2)
syscall) doesn't mean they'll actually arrive at your intended destination.

So,

If you want to know if the bytes have arrived, get the remote side to send
back an explicit ACK of some sort.

If you want to know when the send buffer[1] isn't full anymore, so that you
can start working to fill it again, implement a pull producer
<http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4>
and call the transport's registerProducer method with it.

If you want something else, reply and tell us what :)

-Andrew.

[1] “send buffer” is fairly loose terminology, but it'll do.




From rhythm.mail at gmail.com  Sun Dec 28 02:01:50 2008
From: rhythm.mail at gmail.com (Lian Cheng)
Date: Sun, 28 Dec 2008 17:01:50 +0800
Subject: [Twisted-Python] Re: A question about ITransport.write()
In-Reply-To: <20081228071317.GA24777@steerpike.home.puzzling.org>
References: <gj5a53$mqj$1@ger.gmane.org>
	<20081228071317.GA24777@steerpike.home.puzzling.org>
Message-ID: <gj7fad$1nh$1@ger.gmane.org>

Thanks Andrew!

Andrew Bennetts 写道:
> Lian Cheng wrote:
>> Hi, all
>>
>> As a Twisted newbie, I read the Twisted documentation, and found that:
>>
>>   1. ITransport.write() doesn't return a deferred.
>>   2. IProtocol doesn't have a dataSent() callback or something alike.
>>
>> Since ITransport.write() is a non-blocking call, how can I be informed  
>> when data sent by ITransport.write() is actually sent successfully?
> 
> It depends on what exactly you mean by "successfully".  Just because Twisted
> has delivered the bytes to the OS for delivery (e.g. via the send(2)
> syscall) doesn't mean they'll actually arrive at your intended destination.
> 
> So,
> 
> If you want to know if the bytes have arrived, get the remote side to send
> back an explicit ACK of some sort.

I was actually confused by the words written in the documentation:

     If possible, make sure that it is all written. No data will ever be 
lost, although (obviously) the connection may be closed before it all 
gets through.

Seems here the documentation means that the connection may be closed due 
to some fatal errors such as network cable unplugged rather than calling 
ITransport.loseConnection().

> 
> If you want to know when the send buffer[1] isn't full anymore, so that you
> can start working to fill it again, implement a pull producer
> <http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4>
> and call the transport's registerProducer method with it.

Seems like what I'm looking for :-)

> 
> If you want something else, reply and tell us what :)

Thanks a lot again :-)

> 
> -Andrew.
> 
> [1] “send buffer” is fairly loose terminology, but it'll do.

> Lian Cheng wrote:
>> Hi, all
>>
>> As a Twisted newbie, I read the Twisted documentation, and found that:
>>
>>   1. ITransport.write() doesn't return a deferred.
>>   2. IProtocol doesn't have a dataSent() callback or something alike.
>>
>> Since ITransport.write() is a non-blocking call, how can I be informed  
>> when data sent by ITransport.write() is actually sent successfully?
> 
> It depends on what exactly you mean by "successfully".  Just because Twisted
> has delivered the bytes to the OS for delivery (e.g. via the send(2)
> syscall) doesn't mean they'll actually arrive at your intended destination.
> 
> So,
> 
> If you want to know if the bytes have arrived, get the remote side to send
> back an explicit ACK of some sort.
> 
> If you want to know when the send buffer[1] isn't full anymore, so that you
> can start working to fill it again, implement a pull producer
> <http://twistedmatrix.com/projects/core/documentation/howto/producers.html#auto4>
> and call the transport's registerProducer method with it.
> 
> If you want something else, reply and tell us what :)
> 
> -Andrew.
> 
> [1] “send buffer” is fairly loose terminology, but it'll do.




From cary.hull at gmail.com  Sun Dec 28 02:13:52 2008
From: cary.hull at gmail.com (Cary Hull)
Date: Sun, 28 Dec 2008 01:13:52 -0800
Subject: [Twisted-Python] Twisted and Urwid
In-Reply-To: <717b5780812271008m59aae955s3ba36c090ea078f2@mail.gmail.com>
References: <717b5780812271008m59aae955s3ba36c090ea078f2@mail.gmail.com>
Message-ID: <3fce0ae70812280113i1351fdc5x35f63ca1cec40ebf@mail.gmail.com>

Did you look at this?
http://excess.org/article/2008/09/urwid-gets-twisted-support/

Otherwise it looks like the error you are seeing there is due to not
setting up a palette.

-Cary

On Sat, Dec 27, 2008 at 10:08 AM, Christian Scharkus
<mail.sensenmann at googlemail.com> wrote:
> Hi folks.
>
> I've got a new question. After recongnising that the python bindings for
> curses are not fully capable of displaying the unicode-chars I decided to
> drop curses and shifted to urwid. Now I've got some basic questions in the
> matter of urwid and twisted. As you may know I'm using a mvc-pattern and I
> have not discovered a way to combine _and_ start urwid with twisted yet.
> Maybe someone who already worked with urwid can give me a small hint.
>
> Code:
>
> http://codepad.org/0Hlvmp1b
>
> class Input:
>     def __init__(self,term):
>
>         self.term = term
>         self.size = self.term.get_cols_rows()
>
>         self.input = urwid.Edit()
>
>         self.filler = urwid.Filler(self.input)
>
>         self.canvas = self.filler.render( self.size, focus=True )
>
>         self.term.draw_screen(self.size,self.canvas)
>
>         reactor.addReader(self)
>
>     def fileno(self):
>
>         return 0
>
>     def logPrefix(self):
>         return 'CursesClient'
>
>
>     def doRead(self):
>         keys = self.term.get_input_nonblocking()
>
>         for key in keys:
>             if key == 'window resize':
>
>                 self.size = self.term.get_cols_rows()
>
>             elif key == 'enter':
>                 text = self.input.get_edit_text()
>
>                 controller.sendMsg('dev',text)
>
>                 self.input.set_edit_text('')
>
>             else:
>                 self.filler.keypress(self.size, key)
>
>
> term = urwid.raw_display.Screen()
>
> term.run_wrapper(lambda: Input(term))
>
>
>
>
> Traceback (most recent call last):
>   File "./keckz.py", line 44, in <module>
>
>     f.startKeckz(f.host, f.view)
>
>   File "./keckz.py", line 38, in startKeckz
>
>     controllerKeckz.Kekzcontroller(View).startConnection(host,23002)
>
>   File "/home/arch/keckz/trunk/controllerKeckz.py", line 13, in __init__
>
>     self.view = interface(self)
>
>   File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in __init__
>
>     self.term.run_wrapper(lambda: Input(self.term))
>
>   File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line 212, in
> run_wrapper
>
>     return fn()
>   File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in <lambda>
>
>     self.term.run_wrapper(lambda: Input(self.term))
>
>   File "/home/arch/keckz/trunk/urwid_cli.py", line 55, in __init__
>
>     self.term.draw_screen(self.size,self.canvas)
>
>   File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line 579, in
> draw_screen
>
>     assert self.palette.has_key(a), `a`
>
> AssertionError: None
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>



-- 
01100011 01100001 01110010 01111001



From shawn at schurchcomputers.com  Sun Dec 28 03:05:32 2008
From: shawn at schurchcomputers.com (Shawn Church)
Date: Sun, 28 Dec 2008 02:05:32 -0800
Subject: [Twisted-Python] Question on logging.
Message-ID: <f4a7d4e0812280205qeaf4c44ubb8920a441af07e1@mail.gmail.com>

My problem is that PyAmf uses the standard Python logging module and twisted
uses it's own logging module.  I would like to have a single logging
mechanism that can be specified via twistd.  I would also like to have more
control of the output of the twisted log.  After googling and reading
Glyph's essay on the logging module (
http://twistedmatrix.com/trac/wiki/TwistedLogging) I have came up with two
solutions:

1) Simply configure the logging module with a logging.Handler subclass that
outputs to twisted.python.log.msg.  I can then add a custom LoggingObserver
to control the output.

2) I can use log.PythonLoggingObserver to redirect to the standard logging
module and use the standard logging formatting options and logging levels to
control output (taking into account the caveats pointed out by Glyph).

My questions are as follows:

1)  Are the above reasonable or am I missing something simpler?

2) When adding a LoggingObserver I am left with the LoggingObserver
initialized by twistd.  I can supress this with -l /dev/nul but it seems
better to eliminate it completely.  I guess I could just clear the
,observers property of the theLogPublisher singleton put that seems like an
implementation detail.  Again,  am I missing something?  Is there a way to
tell twistd to let me set up my logging manually?

Note,  I am using version 8.1.


Thanks,


Shawn Church
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081228/5996c3d0/attachment.html>

From simply4it at gmail.com  Sun Dec 28 04:52:56 2008
From: simply4it at gmail.com (Simply for IT)
Date: Sun, 28 Dec 2008 11:52:56 +0000
Subject: [Twisted-Python] FTP LIST
Message-ID: <813b338a0812280352m18b6a1b5v7eb6d6b66a84b320@mail.gmail.com>

Hi Everyone,

I just have started to study twistedmatrix in my spare time couple of weeks
ago. I am satisfied with the books, but as they are very terse, and they are
not really FTP related, I could not figure out how the FTP is working.

I would like to be able to filter/modify the LIST(ing) process. Eg after
list(ing) the result should not list any .py files even if they are there.

I have tried to look after IFTPShell, but no success sofar. Here is a code
snipplet from the "official" testcases - or even from twisted.ftp)

    def requestAvatar(self, avatarId, mind, *interfaces):
         for iface in interfaces:
            if iface is ftp.IFTPShell:
                avatar = ftp.FTPShell(filepath.
FilePath(self.root))
                return ftp.IFTPShell, avatar, getattr(avatar, 'logout',
lambda: None)

Could anybody give me any advice, where to start, please?

Any help  would be appreciated.

Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081228/3f25cfc5/attachment.html>

From mail.sensenmann at googlemail.com  Sun Dec 28 09:28:14 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Sun, 28 Dec 2008 17:28:14 +0100
Subject: [Twisted-Python] Twisted and Urwid
In-Reply-To: <3fce0ae70812280113i1351fdc5x35f63ca1cec40ebf@mail.gmail.com>
References: <717b5780812271008m59aae955s3ba36c090ea078f2@mail.gmail.com>
	<3fce0ae70812280113i1351fdc5x35f63ca1cec40ebf@mail.gmail.com>
Message-ID: <717b5780812280828q5f00257i1ac44ac7130d295e@mail.gmail.com>

Hi Cary.

I have seen it but I would prefer just to add my Input-Class as a Reader to
the reactor instead of using the twisted_main_loop. I have just the problem
that I have no idea how I make urwid start in the beginning.

2008/12/28 Cary Hull <cary.hull at gmail.com>

> Did you look at this?
> http://excess.org/article/2008/09/urwid-gets-twisted-support/
>
> Otherwise it looks like the error you are seeing there is due to not
> setting up a palette.
>
> -Cary
>
> On Sat, Dec 27, 2008 at 10:08 AM, Christian Scharkus
> <mail.sensenmann at googlemail.com> wrote:
> > Hi folks.
> >
> > I've got a new question. After recongnising that the python bindings for
> > curses are not fully capable of displaying the unicode-chars I decided to
> > drop curses and shifted to urwid. Now I've got some basic questions in
> the
> > matter of urwid and twisted. As you may know I'm using a mvc-pattern and
> I
> > have not discovered a way to combine _and_ start urwid with twisted yet.
> > Maybe someone who already worked with urwid can give me a small hint.
> >
> > Code:
> >
> > http://codepad.org/0Hlvmp1b
> >
> > class Input:
> >     def __init__(self,term):
> >
> >         self.term = term
> >         self.size = self.term.get_cols_rows()
> >
> >         self.input = urwid.Edit()
> >
> >         self.filler = urwid.Filler(self.input)
> >
> >         self.canvas = self.filler.render( self.size, focus=True )
> >
> >         self.term.draw_screen(self.size,self.canvas)
> >
> >         reactor.addReader(self)
> >
> >     def fileno(self):
> >
> >         return 0
> >
> >     def logPrefix(self):
> >         return 'CursesClient'
> >
> >
> >     def doRead(self):
> >         keys = self.term.get_input_nonblocking()
> >
> >         for key in keys:
> >             if key == 'window resize':
> >
> >                 self.size = self.term.get_cols_rows()
> >
> >             elif key == 'enter':
> >                 text = self.input.get_edit_text()
> >
> >                 controller.sendMsg('dev',text)
> >
> >                 self.input.set_edit_text('')
> >
> >             else:
> >                 self.filler.keypress(self.size, key)
> >
> >
> > term = urwid.raw_display.Screen()
> >
> > term.run_wrapper(lambda: Input(term))
> >
> >
> >
> >
> > Traceback (most recent call last):
> >   File "./keckz.py", line 44, in <module>
> >
> >     f.startKeckz(f.host, f.view)
> >
> >   File "./keckz.py", line 38, in startKeckz
> >
> >     controllerKeckz.Kekzcontroller(View).startConnection(host,23002)
> >
> >   File "/home/arch/keckz/trunk/controllerKeckz.py", line 13, in __init__
> >
> >     self.view = interface(self)
> >
> >   File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in __init__
> >
> >     self.term.run_wrapper(lambda: Input(self.term))
> >
> >   File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line 212,
> in
> > run_wrapper
> >
> >     return fn()
> >   File "/home/arch/keckz/trunk/urwid_cli.py", line 21, in <lambda>
> >
> >     self.term.run_wrapper(lambda: Input(self.term))
> >
> >   File "/home/arch/keckz/trunk/urwid_cli.py", line 55, in __init__
> >
> >     self.term.draw_screen(self.size,self.canvas)
> >
> >   File "/usr/lib/python2.6/site-packages/urwid/raw_display.py", line 579,
> in
> > draw_screen
> >
> >     assert self.palette.has_key(a), `a`
> >
> > AssertionError: None
> >
> >
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
> >
>
>
>
> --
> 01100011 01100001 01110010 01111001
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081228/9ced747c/attachment.html>

From exarkun at divmod.com  Sun Dec 28 11:35:09 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 28 Dec 2008 13:35:09 -0500
Subject: [Twisted-Python] Question on logging.
In-Reply-To: <f4a7d4e0812280205qeaf4c44ubb8920a441af07e1@mail.gmail.com>
Message-ID: <20081228183509.20272.1851526710.divmod.quotient.28299@ohm>

On Sun, 28 Dec 2008 02:05:32 -0800, Shawn Church <shawn at schurchcomputers.com> wrote:
>My problem is that PyAmf uses the standard Python logging module and twisted
>uses it's own logging module.  I would like to have a single logging
>mechanism that can be specified via twistd.  I would also like to have more
>control of the output of the twisted log.  After googling and reading
>Glyph's essay on the logging module (
>http://twistedmatrix.com/trac/wiki/TwistedLogging) I have came up with two
>solutions:
>
>1) Simply configure the logging module with a logging.Handler subclass that
>outputs to twisted.python.log.msg.  I can then add a custom LoggingObserver
>to control the output.
>
>2) I can use log.PythonLoggingObserver to redirect to the standard logging
>module and use the standard logging formatting options and logging levels to
>control output (taking into account the caveats pointed out by Glyph).
>
>My questions are as follows:
>
>1)  Are the above reasonable or am I missing something simpler?

Reasonable?  I'm not sure what you mean by that.  Are they correct?  Sure.

>
>2) When adding a LoggingObserver I am left with the LoggingObserver
>initialized by twistd.  I can supress this with -l /dev/nul but it seems
>better to eliminate it completely.  I guess I could just clear the
>,observers property of the theLogPublisher singleton put that seems like an
>implementation detail.  Again,  am I missing something?  Is there a way to
>tell twistd to let me set up my logging manually?

There's no way to tell twistd that in 8.1.  However, see <http://twistedmatrix.com/trac/ticket/638> and <http://twistedmatrix.com/trac/ticket/3534>

Jean-Paul



From exarkun at divmod.com  Sun Dec 28 11:38:48 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 28 Dec 2008 13:38:48 -0500
Subject: [Twisted-Python] FTP LIST
In-Reply-To: <813b338a0812280352m18b6a1b5v7eb6d6b66a84b320@mail.gmail.com>
Message-ID: <20081228183848.20272.776418200.divmod.quotient.28300@ohm>

On Sun, 28 Dec 2008 11:52:56 +0000, Simply for IT <simply4it at gmail.com> wrote:
>Hi Everyone,
>
>I just have started to study twistedmatrix in my spare time couple of weeks
>ago. I am satisfied with the books, but as they are very terse, and they are
>not really FTP related, I could not figure out how the FTP is working.
>
>I would like to be able to filter/modify the LIST(ing) process. Eg after
>list(ing) the result should not list any .py files even if they are there.

>I have tried to look after IFTPShell, but no success sofar. Here is a code
>snipplet from the "official" testcases - or even from twisted.ftp)
>

IFTPShell is the way you control the behavior of the FTP server.  To exclude
certain results from a directory listing, you would implement the `list´
method so that it has the necessary logic for performing that exclusion.

>    def requestAvatar(self, avatarId, mind, *interfaces):
>         for iface in interfaces:
>            if iface is ftp.IFTPShell:
>                avatar = ftp.FTPShell(filepath.
>FilePath(self.root))
>                return ftp.IFTPShell, avatar, getattr(avatar, 'logout',
>lambda: None)
>
>Could anybody give me any advice, where to start, please?

You found an implementation of a realm which supports IFTPShell.  If you
aren't familiar with realms, read the cred documentation:

  http://twistedmatrix.com/projects/core/documentation/howto/cred.html

The realm is important but pretty simple.  The avatar, the IFTPShell
implementation, is what really controls the behavior you're interested
in.

Jean-Paul



From exarkun at divmod.com  Sun Dec 28 11:42:32 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sun, 28 Dec 2008 13:42:32 -0500
Subject: [Twisted-Python] Twisted and Urwid
In-Reply-To: <717b5780812280828q5f00257i1ac44ac7130d295e@mail.gmail.com>
Message-ID: <20081228184232.20272.1903765952.divmod.quotient.28303@ohm>

On Sun, 28 Dec 2008 17:28:14 +0100, Christian Scharkus <mail.sensenmann at googlemail.com> wrote:
>Hi Cary.
>
>I have seen it but I would prefer just to add my Input-Class as a Reader to
>the reactor instead of using the twisted_main_loop. I have just the problem
>that I have no idea how I make urwid start in the beginning.

Perhaps that question would be more appropriately put to the urwid
mailing list.

Jean-Paul



From mail.sensenmann at googlemail.com  Sun Dec 28 13:23:31 2008
From: mail.sensenmann at googlemail.com (Christian Scharkus)
Date: Sun, 28 Dec 2008 21:23:31 +0100
Subject: [Twisted-Python] Twisted and Urwid
In-Reply-To: <20081228184232.20272.1903765952.divmod.quotient.28303@ohm>
References: <717b5780812280828q5f00257i1ac44ac7130d295e@mail.gmail.com>
	<20081228184232.20272.1903765952.divmod.quotient.28303@ohm>
Message-ID: <717b5780812281223q2485a78dr71ba1af2627ef5c1@mail.gmail.com>

It is already there. But why don't ask at the other projects mailing list
too?

2008/12/28 Jean-Paul Calderone <exarkun at divmod.com>

> On Sun, 28 Dec 2008 17:28:14 +0100, Christian Scharkus <
> mail.sensenmann at googlemail.com> wrote:
>
>> Hi Cary.
>>
>> I have seen it but I would prefer just to add my Input-Class as a Reader
>> to
>> the reactor instead of using the twisted_main_loop. I have just the
>> problem
>> that I have no idea how I make urwid start in the beginning.
>>
>
> Perhaps that question would be more appropriately put to the urwid
> mailing list.
>
> Jean-Paul
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081228/7f21027a/attachment.html>

From aryeh at bigfoot.com  Mon Dec 29 01:46:39 2008
From: aryeh at bigfoot.com (Arye)
Date: Mon, 29 Dec 2008 09:46:39 +0100
Subject: [Twisted-Python] Re: combining addCallback and callLater ?
In-Reply-To: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>
References: <aaf543e90812160829r4f3314bend2b4f5dafed60892@mail.gmail.com>
Message-ID: <aaf543e90812290046ja0b794et1b0aaadf635944a9@mail.gmail.com>

Hello and thanks for your time.

Regards,


I've already written this some times:
>
> d1.addCallback(5, reactor.callLater, d2.callback, "firelater")
>
> Hope this, helps,
>
> --
> Amaury Forgeot d'Arc
>
>

On Tue, Dec 16, 2008 at 5:29 PM, Arye <aryeh at bigfoot.com> wrote:

> Dear list,
>
> I would like to add a callback that delays the chain. In other words I
> would like to combine:
> defer.Deferred().addCallback
> and reactor.callLater
>
> The only solution I came up with was the code below.
>
> There must be a more elegant way to do this.
> Any ideas would be greatly appreciated,
> All the best,
>
> *************************begin
> from twisted.internet import reactor, defer
>
> def printResults(results, arg):
>     print "In printResults results=", results
>     print "In printResults arg=", arg
>     if arg == 2:
>         reactor.stop()
>
>
> def fireLater(results, d2):
>     print "In fireLater results=", results
>     reactor.callLater(5, d2.callback, "firelater")
>
> d1 = defer.Deferred()
> d2 = defer.Deferred()
> d2.addCallback( printResults, 1)
> d2.addCallback( printResults, 2)
>
>
> d1.addCallback(fireLater, d2)
> d1.callback("fire")
>
> reactor.run()
> *************************end
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081229/9d998729/attachment.html>

From simply4it at gmail.com  Tue Dec 30 13:55:11 2008
From: simply4it at gmail.com (Simply for IT)
Date: Tue, 30 Dec 2008 20:55:11 +0000
Subject: [Twisted-Python] FTP LIST
Message-ID: <813b338a0812301255y64f12cd7n6452c7dde283ebb7@mail.gmail.com>

<http://twistedmatrix.com/pipermail/twisted-python/2008-December/018932.html>

Hi Jean-Paul,

thank you for your reply.

I need to implement a new IFTPShell, right?

I have tried to create a new class (with a list method), which is
inherited from IFTPShell class itself, but I cannot get it accepted by
the realm I posted before.

Greg


>IFTPShell is the way you control the behavior of the FTP server.  To exclude
>certain results from a directory listing, you would implement the `list´
>method so that it has the necessary logic for performing that exclusion.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20081230/6f239930/attachment.html>

From exarkun at divmod.com  Tue Dec 30 13:59:48 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue, 30 Dec 2008 15:59:48 -0500
Subject: [Twisted-Python] FTP LIST
In-Reply-To: <813b338a0812301255y64f12cd7n6452c7dde283ebb7@mail.gmail.com>
Message-ID: <20081230205948.20272.1950184686.divmod.quotient.29344@ohm>

On Tue, 30 Dec 2008 20:55:11 +0000, Simply for IT <simply4it at gmail.com> wrote:
><http://twistedmatrix.com/pipermail/twisted-python/2008-December/018932.html>
>
>Hi Jean-Paul,
>
>thank you for your reply.
>
>I need to implement a new IFTPShell, right?
>
>I have tried to create a new class (with a list method), which is
>inherited from IFTPShell class itself, but I cannot get it accepted by
>the realm I posted before.

IFTPShell is an interface.  You should not subclass it.  See
http://twistedmatrix.com/projects/core/documentation/howto/components.html
for a basic introduction to interfaces.

Jean-Paul



From darren at ontrenet.com  Wed Dec 31 07:37:26 2008
From: darren at ontrenet.com (Darren Govoni)
Date: Wed, 31 Dec 2008 09:37:26 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
Message-ID: <1230734246.16422.3.camel@nuraku>

Hi,
  I'm new to twisted and have a simple question. I want to run a
threaded server that monitors a remote service and spawns
queued/threaded tasks as it finds messages.

I'm having trouble understanding how to do this after a reactor is
running since the tasks are not set up before reactor.run(). I see
reactor.callLater(). But I want to spawn the task immediately.

I tried:

reactor.callLater(0,self.some_method,object)

but the method is not immediately invoked. It seems its not invoked at
all.

I want to create a high-performance threaded scheduler using twist. Any
tips?

thank you!
Darren




From exarkun at divmod.com  Wed Dec 31 08:17:41 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 31 Dec 2008 10:17:41 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <1230734246.16422.3.camel@nuraku>
Message-ID: <20081231151741.20272.393951892.divmod.quotient.29800@ohm>

On Wed, 31 Dec 2008 09:37:26 -0500, Darren Govoni <darren at ontrenet.com> wrote:
>Hi,
>  I'm new to twisted and have a simple question. I want to run a
>threaded server that monitors a remote service and spawns
>queued/threaded tasks as it finds messages.

Queued/threaded tasks?  That do what?

>
>I'm having trouble understanding how to do this after a reactor is
>running since the tasks are not set up before reactor.run(). I see
>reactor.callLater(). But I want to spawn the task immediately.

The way to do things after the reactor is running is the same as the way
to do things before the reactor is running.  Just do them.  There's no
difference.  If you're having trouble figuring out where to put the code
that does them, think about when you want the tasks done.  You said you
want to do things when you "find messages".  How do you find messages?

>
>I tried:
>
>reactor.callLater(0,self.some_method,object)
>
>but the method is not immediately invoked. It seems its not invoked at
>all.

This will call `self.some_method(object)´ soon.  If the call is never
happening, then you've done something wrong.  Perhaps you didn't start
the reactor, or perhaps the signature of some_method is incompatible
with that invocation so that when the call was attempted, it just raised
a TypeError.  It's hard to say exactly what's wrong without seeing a
complete, self-contained, runnable example which demonstrates the
behavior.

>
>I want to create a high-performance threaded scheduler using twist. Any
>tips?

Think about ways to not use threads.  Anything you can do without threads
will be higher performance than the threaded equivalent.

Jean-Paul



From darren at ontrenet.com  Wed Dec 31 08:51:38 2008
From: darren at ontrenet.com (Darren Govoni)
Date: Wed, 31 Dec 2008 10:51:38 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <20081231151741.20272.393951892.divmod.quotient.29800@ohm>
References: <20081231151741.20272.393951892.divmod.quotient.29800@ohm>
Message-ID: <1230738698.16422.10.camel@nuraku>

Hi Jean-Paul,
  Thank you for those suggestions. I can post some simple code after I
get further. The psuedo code of what I want to do is like this:

every few seconds, check a message queue (I see how this is done):
   if there is a message, spawn a deferred so I don't block:
	# The deferred should immediately call a method in a separate
	# thread (wisted kind) to process the message
	# Allow for 10 or so deferreds to be processing messages
	# in parallel while the reactor continues to receive them
	# but block scheduling the deferred if the pool is maxed
	# out

Sorry if this is lacking in detail, i'm trying to test the idea in a
simple way with twisted first. If I set up a deferred before calling
reactor.run(), then of course, it runs, but after reactor.run() I have
to invoke reactor.callLater(...) so its a bit different, but what I'd
like is something like reactor.callNow(...) that doesn't block and
invokes the generator in a thread pool.

Thanks for any tips! Awesome package.

Darren

On Wed, 2008-12-31 at 10:17 -0500, Jean-Paul Calderone wrote:
> On Wed, 31 Dec 2008 09:37:26 -0500, Darren Govoni <darren at ontrenet.com> wrote:
> >Hi,
> >  I'm new to twisted and have a simple question. I want to run a
> >threaded server that monitors a remote service and spawns
> >queued/threaded tasks as it finds messages.
> 
> Queued/threaded tasks?  That do what?
> 
> >
> >I'm having trouble understanding how to do this after a reactor is
> >running since the tasks are not set up before reactor.run(). I see
> >reactor.callLater(). But I want to spawn the task immediately.
> 
> The way to do things after the reactor is running is the same as the way
> to do things before the reactor is running.  Just do them.  There's no
> difference.  If you're having trouble figuring out where to put the code
> that does them, think about when you want the tasks done.  You said you
> want to do things when you "find messages".  How do you find messages?
> 
> >
> >I tried:
> >
> >reactor.callLater(0,self.some_method,object)
> >
> >but the method is not immediately invoked. It seems its not invoked at
> >all.
> 
> This will call `self.some_method(object)´ soon.  If the call is never
> happening, then you've done something wrong.  Perhaps you didn't start
> the reactor, or perhaps the signature of some_method is incompatible
> with that invocation so that when the call was attempted, it just raised
> a TypeError.  It's hard to say exactly what's wrong without seeing a
> complete, self-contained, runnable example which demonstrates the
> behavior.
> 
> >
> >I want to create a high-performance threaded scheduler using twist. Any
> >tips?
> 
> Think about ways to not use threads.  Anything you can do without threads
> will be higher performance than the threaded equivalent.
> 
> Jean-Paul
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From exarkun at divmod.com  Wed Dec 31 09:16:59 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed, 31 Dec 2008 11:16:59 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <1230738698.16422.10.camel@nuraku>
Message-ID: <20081231161659.20272.1130998283.divmod.quotient.29820@ohm>

On Wed, 31 Dec 2008 10:51:38 -0500, Darren Govoni <darren at ontrenet.com> wrote:
>Hi Jean-Paul,
>  Thank you for those suggestions. I can post some simple code after I
>get further. The psuedo code of what I want to do is like this:
>every few seconds, check a message queue (I see how this is done):
>   if there is a message, spawn a deferred so I don't block:
>	# The deferred should immediately call a method in a separate
>	# thread (wisted kind) to process the message
>	# Allow for 10 or so deferreds to be processing messages
>	# in parallel while the reactor continues to receive them
>	# but block scheduling the deferred if the pool is maxed
>	# out

A Deferred is just a convenient way to keep track of callbacks.  It's
not an active thing, so to "spawn" one doesn't make much sense.  Instead,
you spawn something else and use a Deferred to keep track of its result.

>
>Sorry if this is lacking in detail, i'm trying to test the idea in a
>simple way with twisted first. If I set up a deferred before calling
>reactor.run(), then of course, it runs, but after reactor.run() I have
>to invoke reactor.callLater(...) so its a bit different, but what I'd
>like is something like reactor.callNow(...) that doesn't block and
>invokes the generator in a thread pool.

You probably want twisted.internet.threads.deferToThreadPool (or the older
deferToThread).  From its docstring:

  Call the function C{f} using a thread from the given threadpool and return
  the result as a Deferred.

Jean-Paul



From darren at ontrenet.com  Wed Dec 31 13:08:25 2008
From: darren at ontrenet.com (Darren Govoni)
Date: Wed, 31 Dec 2008 15:08:25 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <20081231161659.20272.1130998283.divmod.quotient.29820@ohm>
References: <20081231161659.20272.1130998283.divmod.quotient.29820@ohm>
Message-ID: <1230754105.16422.40.camel@nuraku>

Hi,
  Thanks for that suggestion. It looks very close to what I need. I
tried doing it _after_ the reactor is run and it did not execute. Here
is a code snippet.

def convert_to_pdf(arg):
   print "converting..."

def notify_pdf:
   print "Yay! I'm done"

...
		d = threads.deferToThread(convert_to_pdf,offset)
		d.addCallback(notify_pdf)

All the examples for threads.deferToThread call reactor.run() after
configuring all the threads, but this isn't useful in my app.

If I call reactor.run() and _then_ try to deferToThread, it doesn't
work. I'm probably missing an argument or something.

Thanks for any tips. Much appreciated.

Darren

On Wed, 2008-12-31 at 11:16 -0500, Jean-Paul Calderone wrote:
> On Wed, 31 Dec 2008 10:51:38 -0500, Darren Govoni <darren at ontrenet.com> wrote:
> >Hi Jean-Paul,
> >  Thank you for those suggestions. I can post some simple code after I
> >get further. The psuedo code of what I want to do is like this:
> >every few seconds, check a message queue (I see how this is done):
> >   if there is a message, spawn a deferred so I don't block:
> >	# The deferred should immediately call a method in a separate
> >	# thread (wisted kind) to process the message
> >	# Allow for 10 or so deferreds to be processing messages
> >	# in parallel while the reactor continues to receive them
> >	# but block scheduling the deferred if the pool is maxed
> >	# out
> 
> A Deferred is just a convenient way to keep track of callbacks.  It's
> not an active thing, so to "spawn" one doesn't make much sense.  Instead,
> you spawn something else and use a Deferred to keep track of its result.
> 
> >
> >Sorry if this is lacking in detail, i'm trying to test the idea in a
> >simple way with twisted first. If I set up a deferred before calling
> >reactor.run(), then of course, it runs, but after reactor.run() I have
> >to invoke reactor.callLater(...) so its a bit different, but what I'd
> >like is something like reactor.callNow(...) that doesn't block and
> >invokes the generator in a thread pool.
> 
> You probably want twisted.internet.threads.deferToThreadPool (or the older
> deferToThread).  From its docstring:
> 
>   Call the function C{f} using a thread from the given threadpool and return
>   the result as a Deferred.
> 
> Jean-Paul
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From darren at ontrenet.com  Wed Dec 31 13:13:10 2008
From: darren at ontrenet.com (Darren Govoni)
Date: Wed, 31 Dec 2008 15:13:10 -0500
Subject: [Twisted-Python] spawning tasks after reactor?
In-Reply-To: <1230754105.16422.40.camel@nuraku>
References: <20081231161659.20272.1130998283.divmod.quotient.29820@ohm>
	<1230754105.16422.40.camel@nuraku>
Message-ID: <1230754390.16422.42.camel@nuraku>

It works now. Sorry for the extra post.

On Wed, 2008-12-31 at 15:08 -0500, Darren Govoni wrote:
> Hi,
>   Thanks for that suggestion. It looks very close to what I need. I
> tried doing it _after_ the reactor is run and it did not execute. Here
> is a code snippet.
> 
> def convert_to_pdf(arg):
>    print "converting..."
> 
> def notify_pdf:
>    print "Yay! I'm done"
> 
> ...
> 		d = threads.deferToThread(convert_to_pdf,offset)
> 		d.addCallback(notify_pdf)
> 
> All the examples for threads.deferToThread call reactor.run() after
> configuring all the threads, but this isn't useful in my app.
> 
> If I call reactor.run() and _then_ try to deferToThread, it doesn't
> work. I'm probably missing an argument or something.
> 
> Thanks for any tips. Much appreciated.
> 
> Darren
> 
> On Wed, 2008-12-31 at 11:16 -0500, Jean-Paul Calderone wrote:
> > On Wed, 31 Dec 2008 10:51:38 -0500, Darren Govoni <darren at ontrenet.com> wrote:
> > >Hi Jean-Paul,
> > >  Thank you for those suggestions. I can post some simple code after I
> > >get further. The psuedo code of what I want to do is like this:
> > >every few seconds, check a message queue (I see how this is done):
> > >   if there is a message, spawn a deferred so I don't block:
> > >	# The deferred should immediately call a method in a separate
> > >	# thread (wisted kind) to process the message
> > >	# Allow for 10 or so deferreds to be processing messages
> > >	# in parallel while the reactor continues to receive them
> > >	# but block scheduling the deferred if the pool is maxed
> > >	# out
> > 
> > A Deferred is just a convenient way to keep track of callbacks.  It's
> > not an active thing, so to "spawn" one doesn't make much sense.  Instead,
> > you spawn something else and use a Deferred to keep track of its result.
> > 
> > >
> > >Sorry if this is lacking in detail, i'm trying to test the idea in a
> > >simple way with twisted first. If I set up a deferred before calling
> > >reactor.run(), then of course, it runs, but after reactor.run() I have
> > >to invoke reactor.callLater(...) so its a bit different, but what I'd
> > >like is something like reactor.callNow(...) that doesn't block and
> > >invokes the generator in a thread pool.
> > 
> > You probably want twisted.internet.threads.deferToThreadPool (or the older
> > deferToThread).  From its docstring:
> > 
> >   Call the function C{f} using a thread from the given threadpool and return
> >   the result as a Deferred.
> > 
> > Jean-Paul
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




