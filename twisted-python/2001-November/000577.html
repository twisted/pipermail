<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Win32 select in internet.main
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Win32%20select%20in%20internet.main&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000576.html">
   <LINK REL="Next"  HREF="000578.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Win32 select in internet.main</H1>
    <B>Itamar Shtull-Trauring</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Win32%20select%20in%20internet.main&In-Reply-To="
       TITLE="[Twisted-Python] Win32 select in internet.main">twisted at itamarst.org
       </A><BR>
    <I>Sun Nov 18 06:56:14 EST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="000576.html">[Twisted-Python] Process Producer, Request Consumer
</A></li>
        <LI>Next message: <A HREF="000578.html">[Twisted-Python] Possible patch to twisted.python.hook
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#577">[ date ]</a>
              <a href="thread.html#577">[ thread ]</a>
              <a href="subject.html#577">[ subject ]</a>
              <a href="author.html#577">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>HappyFool pointed out on IRC that the fix for empty read and write lists in 
select.select on windows is only done for iterate(), not run(). Perhaps the 
following patch should be used?

Index: twisted/internet/main.py
===================================================================
RCS file: /cvs/Twisted/twisted/internet/main.py,v
retrieving revision 1.42
diff -c -r1.42 main.py
*** twisted/internet/main.py	2001/10/30 23:55:39	1.42
--- twisted/internet/main.py	2001/11/18 11:54:58
***************
*** 440,454 ****
           del writes[writer]

   if platform.getType() == 'win32':
!     &quot;&quot;&quot;redefine iterate on WinXX to handle wierd error case when passing 
empty lists to select
       &quot;&quot;&quot;
!     def iterate():
!         for delayed in delayeds:
!             delayed.runUntilCurrent()
!         if (not reads) and (not writes):
!             pass
           else:
!             doSelect(0)

   class _Win32Waker(styles.Ephemeral):
       &quot;&quot;&quot;I am a workaround for the lack of pipes on win32.
--- 440,455 ----
           del writes[writer]

   if platform.getType() == 'win32':
!     &quot;&quot;&quot;redefine select on WinXX to handle wierd error case when passing 
empty lists to select
       &quot;&quot;&quot;
!     def _select(r, w, e, timeout=None, _realselect=select.select):
!         if (not r) and (not w):
!             return [], [], []
           else:
!             return _realselect(r, w, e, timeout)
!
!     select.select = _select
!

   class _Win32Waker(styles.Ephemeral):
       &quot;&quot;&quot;I am a workaround for the lack of pipes on win32.




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000576.html">[Twisted-Python] Process Producer, Request Consumer
</A></li>
	<LI>Next message: <A HREF="000578.html">[Twisted-Python] Possible patch to twisted.python.hook
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#577">[ date ]</a>
              <a href="thread.html#577">[ thread ]</a>
              <a href="subject.html#577">[ subject ]</a>
              <a href="author.html#577">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
