<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted Names - strange RuntimeError
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20Names%20-%20strange%20RuntimeError&In-Reply-To=%3C20110109121011.003937fb%40alnitak.communicationvalley.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="055768.html">
   <LINK REL="Next"  HREF="055770.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted Names - strange RuntimeError</H1>
    <B>Angelo Dell'Aera</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Twisted%20Names%20-%20strange%20RuntimeError&In-Reply-To=%3C20110109121011.003937fb%40alnitak.communicationvalley.it%3E"
       TITLE="[Twisted-Python] Twisted Names - strange RuntimeError">angelo.dellaera at gmail.com
       </A><BR>
    <I>Sun Jan  9 04:10:11 MST 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="055768.html">[Twisted-Python] Amazon AWS, Google app engine and Twisted
</A></li>
        <LI>Next message (by thread): <A HREF="055770.html">[Twisted-Python] Twisted Names - strange RuntimeError
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55769">[ date ]</a>
              <a href="thread.html#55769">[ thread ]</a>
              <a href="subject.html#55769">[ subject ]</a>
              <a href="author.html#55769">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi, 
while developing a code based on Twisted Names I'm finding myself catching 
RuntimeErrors like the one reported below. 


2011-01-09 10:32:13+0100 [twisted.names.dns.DNSDatagramProtocol (UDP)]
Unhandled Error Traceback (most recent call last):
  File &quot;/usr/lib64/python2.6/site-packages/twisted/python/log.py&quot;, line 84, in callWithLogger 
		return callWithContext({&quot;system&quot;: lp}, func, *args, **kw)
  File &quot;/usr/lib64/python2.6/site-packages/twisted/python/log.py&quot;, line 69, in callWithContext 
		return context.call({ILogContext: newCtx}, func, *args,**kw) 
  File &quot;/usr/lib64/python2.6/site-packages/twisted/python/context.py&quot;, line 59, in callWithContext 
		return self.currentContext().callWithContext(ctx, func, *args, **kw) 
  File &quot;/usr/lib64/python2.6/site-packages/twisted/python/context.py&quot;, line 37, in callWithContext 
	return func(*args,**kw) 
  --- &lt;exception caught here&gt; --- 
  File &quot;/usr/lib64/python2.6/site-packages/twisted/internet/epollreactor.py&quot;, line 220, in _doReadOrWrite 
	why = selectable.doWrite() 
  File &quot;/usr/lib64/python2.6/site-packages/twisted/internet/base.py&quot;, line 1083, in doWrite 
	raise RuntimeError, &quot;doWrite called on a %s&quot; % reflect.qual(self.__class__)
  exceptions.RuntimeError: doWrite called on a twisted.internet.udp.Port


The code which produces this error is really complex and is part of an 
intelligence data gathering framework I'm developing for the Honeynet 
Project (for those interested in details please take a look at my technical 
blog <A HREF="http://buffer.antifork.org/blog/category/tip/">http://buffer.antifork.org/blog/category/tip/</A> ). 

I realized that 
	. the RuntimeError is raised really rarely (I see one of such errors 
	  every 2-3 days and during this time frame millions of DNS requests
	  and replies are handled)
	. using different Twisted versions doesn't make the problem disappear
	  (the attached traceback refers to version 10.2.0) 
	. selecting a different reactor doesn't make the problem disappear

Unfortunately I have not a test code for reproducing the issue and sincerely
speaking I really don't know how to write it because this condition is so rarely
met that I'm not able to understand what leads to it.

I could be wrong but taking a look at twisted.internet.udp.Port I see it defines a
write method so I really do not understand the reason why the BasePort doWrite
method raises such error. 

Thanks for your attention and cheers, 

-- 

Angelo Dell'Aera 'buffer' 
Antifork Research, Inc.	  	<A HREF="http://buffer.antifork.org">http://buffer.antifork.org</A>
Metro Olografix



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="055768.html">[Twisted-Python] Amazon AWS, Google app engine and Twisted
</A></li>
	<LI>Next message (by thread): <A HREF="055770.html">[Twisted-Python] Twisted Names - strange RuntimeError
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55769">[ date ]</a>
              <a href="thread.html#55769">[ thread ]</a>
              <a href="subject.html#55769">[ subject ]</a>
              <a href="author.html#55769">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
