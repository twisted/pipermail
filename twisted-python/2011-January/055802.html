<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] client connecting to 2 servers	(nonsimultaneously)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20client%20connecting%20to%202%20servers%0A%09%28nonsimultaneously%29&In-Reply-To=%3CAANLkTi%3DZ1SQxBChZKOOyyLpaf8fhcp8RkWFJviYhPrMO%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="055801.html">
   <LINK REL="Next"  HREF="055803.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] client connecting to 2 servers	(nonsimultaneously)</H1>
    <B>Jason Rennie</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20client%20connecting%20to%202%20servers%0A%09%28nonsimultaneously%29&In-Reply-To=%3CAANLkTi%3DZ1SQxBChZKOOyyLpaf8fhcp8RkWFJviYhPrMO%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] client connecting to 2 servers	(nonsimultaneously)">jrennie at gmail.com
       </A><BR>
    <I>Wed Jan 12 11:45:47 MST 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="055801.html">[Twisted-Python] client connecting to 2 servers	(nonsimultaneously)
</A></li>
        <LI>Next message (by thread): <A HREF="055803.html">[Twisted-Python] client connecting to 2	servers	(nonsimultaneously)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55802">[ date ]</a>
              <a href="thread.html#55802">[ thread ]</a>
              <a href="subject.html#55802">[ subject ]</a>
              <a href="author.html#55802">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Jan 12, 2011 at 11:32 AM, Glyph Lefkowitz
&lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt;wrote:

&gt;<i> The reactor doesn't have a queue of tasks to be completed.  It has sets of
</I>&gt;<i> various event sources, which it executes in no particular order.
</I>&gt;<i>
</I>
&quot;queue of tasks&quot; was a guess on my part, but I looked through the
BaseReactor code and found something like that.  'course, I could easily be
reading the code wrong.  How would you describe threadCallQueue?  When I
said &quot;tasks&quot;, I meant something akin to &quot;calls&quot;.  That could be
confusing---did you interpret &quot;tasks&quot; differently?


&gt;<i> Scheduling a timed event with callLater(0,...) might do what you want,
</I>&gt;<i> though.
</I>&gt;<i>
</I>
Yes.  Thanks!  I see that the callFromThread documentation even recommends
using callLater for this behavior. (doh!)

<A HREF="http://twistedmatrix.com/documents/10.2.0/api/twisted.internet.interfaces.IReactorThreads.html#callFromThread">http://twistedmatrix.com/documents/10.2.0/api/twisted.internet.interfaces.IReactorThreads.html#callFromThread</A>

&gt;&gt;&gt;<i> from twisted.internet import reactor
</I>&gt;&gt;&gt;<i> def foo():
</I>...     print &quot;foo!&quot;
...
&gt;&gt;&gt;<i> def bar():
</I>...     reactor.callLater(0, foo)
...     print &quot;bar!&quot;
...
&gt;&gt;&gt;<i> reactor.callWhenRunning(bar)
</I>('startup', ('after', &lt;function bar at 0x2c84320&gt;, (), {}))
&gt;&gt;&gt;<i> reactor.run()
</I>bar!
foo!

Interesting that you can substitute callFromThread for callLater(0, ...) in
the above code and get the same behavior...

Sorry to prolong the tangent, but I'd like to better understand the
differences between callWhenRunning, callFromThread and callLater.  I think
reactor.wakeUp() is the one missing piece for me.  How exactly does it work?
 Reading the BaseReactor code... callFromThread adds the call to a queue,
then calls wakeUp.  IIUC, wakeUp simply runs

self.port.postEvent(0, KEY_WAKEUP, None)

Does this cause the reactor thread to jump to the front of the queue of
threads to be run by python/linux?  If there were no wakeUp in
callFromThread, would the call simply be delayed until the thread
round-robin got to the reactor thread?  Or, without wakeUp, is it possible
the callFromThread call would never be made?

Cheers,

Jason

-- 
Jason Rennie
Research Scientist, ITA Software
617-714-2645
<A HREF="http://www.itasoftware.com/">http://www.itasoftware.com/</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20110112/80cb849d/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="055801.html">[Twisted-Python] client connecting to 2 servers	(nonsimultaneously)
</A></li>
	<LI>Next message (by thread): <A HREF="055803.html">[Twisted-Python] client connecting to 2	servers	(nonsimultaneously)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55802">[ date ]</a>
              <a href="thread.html#55802">[ thread ]</a>
              <a href="subject.html#55802">[ subject ]</a>
              <a href="author.html#55802">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
