<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Names DNS Client too chatty
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Names%20DNS%20Client%20too%20chatty&In-Reply-To=AANLkTimD%3DwONP0u6Sz78V0M%2BDUqPtNd3t26Oxir%2BVGuZ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023409.html">
   <LINK REL="Next"  HREF="023423.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Names DNS Client too chatty</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Names%20DNS%20Client%20too%20chatty&In-Reply-To=AANLkTimD%3DwONP0u6Sz78V0M%2BDUqPtNd3t26Oxir%2BVGuZ%40mail.gmail.com"
       TITLE="[Twisted-Python] Names DNS Client too chatty">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Jan 25 00:01:04 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="023409.html">[Twisted-Python] Names DNS Client too chatty
</A></li>
        <LI>Next message: <A HREF="023423.html">[Twisted-Python] Names DNS Client too chatty
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23416">[ date ]</a>
              <a href="thread.html#23416">[ thread ]</a>
              <a href="subject.html#23416">[ subject ]</a>
              <a href="author.html#23416">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jan 24, 2011, at 1:18 PM, Jason J. W. Williams wrote:

&gt;<i> In my opinion this has been a problem for a very long time, and it
</I>&gt;<i> would be better to have a correction that fits the majority of cases
</I>&gt;<i> with a small code change now rather than wait for the perfect log
</I>&gt;<i> system. These changes don't preclude a better logger and way of
</I>&gt;<i> filtering these out in the future. self.noisy may be viewed as a hack,
</I>&gt;<i> but honestly it's worked well for me and it's easy to understand what
</I>&gt;<i> it does.
</I>&gt;<i> 
</I>&gt;<i> If the compromise is the 4021 patch (wrapping with &quot;if self.noisy&quot;),
</I>&gt;<i> with noisy defaulting to True, I think that's a good solution today
</I>&gt;<i> without precluding the perfect solution when someone wants to build
</I>&gt;<i> it.
</I>
While I agree with the general sentiment (incremental improvements that can be done now are pretty much always better than gigantic overhauls that have to be put off until later) the current logging system is already pretty much designed for this, we're just not using it right.  Trimming JP's message a bit to just the key part:

&gt;&gt;<i> This doesn't even have to mean changes to LogPublisher.  It could mean replacing:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  log.msg(&quot;%s starting on %s&quot;%(self.protocol.__class__,
</I>&gt;&gt;<i> self._realPortNumber))
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> with:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  log.msg(
</I>&gt;&gt;<i>     event_source=self,
</I>&gt;&gt;<i>     event_type=&quot;start&quot;,
</I>&gt;&gt;<i>     protocol=self.protocol,
</I>&gt;&gt;<i>     port_number=self._realPortNumber)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> (and documenting and testing).  It may well be nice to have LogPublisher be
</I>&gt;&gt;<i> able to dispatch these more efficiently, but that's just an optimization.
</I>

That is _literally_ all that needs to be done to preserve the functionality JP likes.  You don't have to change the implementation of log.msg: it already accepts **kw, specifically for this reason.  A message logged in this manner (with no &quot;message&quot; or &quot;format&quot; event key) will produce no text output in the log.  So the amount of work involved is really just writing one line of code.  Which JP already wrote, here.  It just needs a unit test and a review :).

I do wonder why he went with the PEP8-style underscore parameter names rather than Twisted-style intercapped names though :).

-glyph

P.S.: In the future, please reply inline, it's standard etiquette for this list.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20110125/3dd8ea31/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20110125/3dd8ea31/attachment.htm</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023409.html">[Twisted-Python] Names DNS Client too chatty
</A></li>
	<LI>Next message: <A HREF="023423.html">[Twisted-Python] Names DNS Client too chatty
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23416">[ date ]</a>
              <a href="thread.html#23416">[ thread ]</a>
              <a href="subject.html#23416">[ subject ]</a>
              <a href="author.html#23416">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
