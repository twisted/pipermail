<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Names DNS Client too chatty
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Names%20DNS%20Client%20too%20chatty&In-Reply-To=AANLkTins2URGbTbAV%3DJQZeYwW%3DBLJ8jwj28L0akkAfJL%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023407.html">
   <LINK REL="Next"  HREF="023409.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Names DNS Client too chatty</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Names%20DNS%20Client%20too%20chatty&In-Reply-To=AANLkTins2URGbTbAV%3DJQZeYwW%3DBLJ8jwj28L0akkAfJL%40mail.gmail.com"
       TITLE="[Twisted-Python] Names DNS Client too chatty">exarkun at twistedmatrix.com
       </A><BR>
    <I>Mon Jan 24 13:09:24 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="023407.html">[Twisted-Python] Names DNS Client too chatty
</A></li>
        <LI>Next message: <A HREF="023409.html">[Twisted-Python] Names DNS Client too chatty
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23408">[ date ]</a>
              <a href="thread.html#23408">[ thread ]</a>
              <a href="subject.html#23408">[ subject ]</a>
              <a href="author.html#23408">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 05:24 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jasonjwwilliams at gmail.com</A> wrote:
&gt;<i>If there's no objections the rest of today, I'll make sure the 4021
</I>&gt;<i>patch still applies and see what could be done as a test.
</I>
I think it would be sad to lose the port starting up log messages. 
Sure, they're a nuisance if you start and stop 50k ports per second. 
However, they're just what you want if you have a boring server that 
starts one or two ports in the entire lifetime of your application.

For clients, the common case is to start and stop many connectors over 
the lifetime of an application, so it sounds slightly more tolerable to 
disable these by default.  However, even for clients I've found these 
messages useful.  For example they've revealed bugs in buildbot's 
reconnection code.

So I doubt it's a pure win to disable these by default (just like it's 
not a pure win to have them enabled by default).

As long as someone's going to touch this code, it seems like it would be 
better to just implement structured logging.  This doesn't even have to 
mean changes to LogPublisher.  It could mean replacing:

  log.msg(&quot;%s starting on %s&quot;%(self.protocol.__class__, 
self._realPortNumber))

with:

  log.msg(
      event_source=self,
      event_type=&quot;start&quot;,
      protocol=self.protocol,
      port_number=self._realPortNumber)

(and documenting and testing).  It may well be nice to have LogPublisher 
be able to dispatch these more efficiently, but that's just an 
optimization.

This still has the effect of disabling the messages by default.  And 
(for now) it's even harder to turn them back on (you need a log observer 
that can report about these events, instead of just setting a flag). 
But it's better in the long run, right?

Jean-Paul
&gt;<i>-J
</I>&gt;<i>
</I>&gt;<i>On Mon, Jan 24, 2011 at 3:40 AM, Phil Mayers &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">p.mayers at imperial.ac.uk</A>&gt; 
</I>&gt;<i>wrote:
</I>&gt;&gt;<i>On 01/24/2011 02:43 AM, Glyph Lefkowitz wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Personally I'd say 'false'. &#160;This is technically a change in
</I>&gt;&gt;&gt;<i>behavior, but I don't think that we should make guarantees about
</I>&gt;&gt;&gt;<i>emitted log messages. &#160;Practically speaking, I've never seen any code
</I>&gt;&gt;&gt;<i>which would care about an unstructured log message. &#160;Anyone else
</I>&gt;&gt;&gt;<i>object to changing it?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I'm strongly in favour of setting noisy to False on all factory 
</I>&gt;&gt;<i>objects;
</I>&gt;&gt;<i>I find their logging tedious, and have a bunch of monkeypatch code in
</I>&gt;&gt;<i>most of my projects to import the modules and set the class variable, 
</I>&gt;&gt;<i>to
</I>&gt;&gt;<i>I don't have to subclass just to do that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>The structured logging proposal sounds interesting and I'm potentially
</I>&gt;&gt;<i>willing to give it a go. However, it seems like it would be a lot of
</I>&gt;&gt;<i>work and that it would be very likely to sit in Trac review limbo for 
</I>&gt;&gt;<i>a
</I>&gt;&gt;<i>while (getting ever-harder to merge the branch back in).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>(This is not intended as a criticism - merely an observation that even
</I>&gt;&gt;<i>tickets for simple problems with patches take a while to get reviewed,
</I>&gt;&gt;<i>as manpower is of course a precious and scarce resource)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Do you have any thoughts on how it could be broken down into smaller 
</I>&gt;&gt;<i>chunks?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Twisted-Python mailing list
</I>&gt;&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Twisted-Python mailing list
</I>&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023407.html">[Twisted-Python] Names DNS Client too chatty
</A></li>
	<LI>Next message: <A HREF="023409.html">[Twisted-Python] Names DNS Client too chatty
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23408">[ date ]</a>
              <a href="thread.html#23408">[ thread ]</a>
              <a href="subject.html#23408">[ subject ]</a>
              <a href="author.html#23408">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
