<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Question about SerialPort
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Question%20about%20SerialPort&In-Reply-To=%3CCEB2B268-90DA-4861-9B00-F792E4B10C0C%40fuhm.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="055847.html">
   <LINK REL="Next"  HREF="055851.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Question about SerialPort</H1>
    <B>James Y Knight</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Question%20about%20SerialPort&In-Reply-To=%3CCEB2B268-90DA-4861-9B00-F792E4B10C0C%40fuhm.net%3E"
       TITLE="[Twisted-Python] Question about SerialPort">foom at fuhm.net
       </A><BR>
    <I>Thu Jan 20 06:42:58 MST 2011</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="055847.html">[Twisted-Python] Question about SerialPort
</A></li>
        <LI>Next message (by thread): <A HREF="055851.html">[Twisted-Python] Question about SerialPort
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55848">[ date ]</a>
              <a href="thread.html#55848">[ thread ]</a>
              <a href="subject.html#55848">[ subject ]</a>
              <a href="author.html#55848">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jan 20, 2011, at 6:32 AM, Albert Brandl wrote:
&gt;<i> The main problem seems to be the specification of Modbus RTU. RTU
</I>&gt;<i> messages are separated by time gaps that are at least 3.5 characters
</I>&gt;<i> long. Unfortunately, this is the only reliable way for separating
</I>&gt;<i> messages - there is no length header or something similar. The
</I>&gt;<i> specification does define a trailing CRC, though.
</I>
I don't think you'll ever be able to do this reliably in Python. At 9600 baud, 3.5 characters is just about 275hz (9600/10/3.5). Linux schedules process at around 500hz. So, unless you use real-time scheduling, I think you have no guarantee that you'll be able to detect such a gap at all -- some other process may be running and you may completely miss it. And you can't reasonably use real-time scheduling in python...

On the other hand, are you sure you need this? <A HREF="http://www.libmodbus.org/">http://www.libmodbus.org/</A> seems to have code which figures out what length packets should be, and no code to detect a 3.5char delay between packets. That seems much more reliable.

It also doesn't seem to have any code to ensure a 3.5char between sent packets, which indicates to me that either it's totally brokem or else that not even the hardware end actually uses a 3.5char delay to determine packet boundaries...I'd guess the second, since even on an embedded CPU, it's much trickier to ensure the appropriate serial port timing than to simply count the correct number of bytes.

James



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="055847.html">[Twisted-Python] Question about SerialPort
</A></li>
	<LI>Next message (by thread): <A HREF="055851.html">[Twisted-Python] Question about SerialPort
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55848">[ date ]</a>
              <a href="thread.html#55848">[ thread ]</a>
              <a href="subject.html#55848">[ subject ]</a>
              <a href="author.html#55848">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
