<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] intermittent problem:	not	accepting	new	connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20intermittent%20problem%3A%0A%09not%09accepting%09new%09connections&In-Reply-To=%3C48C8F18E.8090807%40thiengineering.ch%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="050875.html">
   <LINK REL="Next"  HREF="050877.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] intermittent problem:	not	accepting	new	connections</H1>
    <B>Werner Thie</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20intermittent%20problem%3A%0A%09not%09accepting%09new%09connections&In-Reply-To=%3C48C8F18E.8090807%40thiengineering.ch%3E"
       TITLE="[Twisted-Python] intermittent problem:	not	accepting	new	connections">wthie at thiengineering.ch
       </A><BR>
    <I>Thu Sep 11 04:23:10 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="050875.html">[Twisted-Python] intermittent problem: not	accepting	new	connections
</A></li>
        <LI>Next message (by thread): <A HREF="050877.html">[Twisted-Python] intermittent problem: not accepting new	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50876">[ date ]</a>
              <a href="thread.html#50876">[ thread ]</a>
              <a href="subject.html#50876">[ subject ]</a>
              <a href="author.html#50876">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alec

just wondering...

How does netstat look like?

We ran into problems resource wise with the number of open connections 
aka file descriptors per process and observed similar problems to yours, 
also by switching to a new server.

How does ulimit -a compare between old and new machine?

HTH, Werner

Alec Matusis wrote:
&gt;&gt;<i> You could try running strace against the server while it's not
</I>&gt;&gt;<i> accepting
</I>&gt;&gt;<i> connections.  
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> It went into this regime again tonight, and I captured strace.
</I>&gt;<i> 
</I>&gt;<i> A few remarks first:
</I>&gt;<i> 
</I>&gt;<i> The outage was brief, it lasted about 3 min. It did not correspond to the peak number of connections.
</I>&gt;<i> The application has several protocols (like manhole and various control ports), that are listening on different ports.
</I>&gt;<i> When the server stopped accepting connections on the main port (where external internet clients connect), telnet connection to manhole and control ports are still possible.
</I>&gt;<i> Also, I think when it is in this bad state, it does accept some external connections, maybe 50%.
</I>&gt;<i> 
</I>&gt;<i> Anyway, here's the strace in the bad state:
</I>&gt;<i> 
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1474), sin_addr=inet_addr(&quot;83.153.87.198&quot;)}, [13980580626831507472]) = 491
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(40953), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [17987095445330984976]) = 491
</I>&gt;<i> --- SIGCHLD (Child exited) @ 0 (0) ---
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(50679), sin_addr=inet_addr(&quot;24.166.18.207&quot;)}, [17853676306370134032]) = 491
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(52873), sin_addr=inet_addr(&quot;67.87.61.193&quot;)}, [9929874236988456976]) = 493
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(54305), sin_addr=inet_addr(&quot;200.114.45.212&quot;)}, [2437573306904215568]) = 491
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2246), sin_addr=inet_addr(&quot;76.11.66.253&quot;)}, [14269655427913351184]) = 491
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(32824), sin_addr=inet_addr(&quot;75.62.105.81&quot;)}, [4071254071732862992]) = 491
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2262), sin_addr=inet_addr(&quot;76.11.66.253&quot;)}, [15422576932520198160]) = 491
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(3316), sin_addr=inet_addr(&quot;24.127.249.90&quot;)}, [17585430653564878864]) = 491
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(4466), sin_addr=inet_addr(&quot;72.241.229.233&quot;)}, [8219350803517800464]) = 491
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1651), sin_addr=inet_addr(&quot;67.82.141.97&quot;)}, [8288312172811911184]) = 491
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2669), sin_addr=inet_addr(&quot;24.94.231.135&quot;)}, [7857092508491186192]) = 398
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(50252), sin_addr=inet_addr(&quot;97.119.52.164&quot;)}, [5531546250907746320]) = 398
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2675), sin_addr=inet_addr(&quot;70.4.222.71&quot;)}, [8289438072718753808]) = 398
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(63671), sin_addr=inet_addr(&quot;69.22.255.174&quot;)}, [13256345511754989584]) = 491
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(54520), sin_addr=inet_addr(&quot;92.130.148.171&quot;)}, [17929956025058721808]) = 491
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(41056), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [6962565032504721424]) = 491
</I>&gt;<i> accept(13, 0x7fffc3d5ca30, [16])        = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(49296), sin_addr=inet_addr(&quot;66.214.238.42&quot;)}, [10430336745580003344]) = 161
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> --- SIGCHLD (Child exited) @ 0 (0) ---
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(41199), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [17266800979928416272]) = 161
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(49376), sin_addr=inet_addr(&quot;68.34.251.86&quot;)}, [16194944268614238224]) = 161
</I>&gt;<i> --- SIGCHLD (Child exited) @ 0 (0) ---
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(41497), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [1847038805765259280]) = 161
</I>&gt;<i> accept(13, 0x7fffc3d5ca30, [16])        = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> --- SIGCHLD (Child exited) @ 0 (0) ---
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(50013), sin_addr=inet_addr(&quot;71.241.76.86&quot;)}, [6756243874575810576]) = 161
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> --- SIGCHLD (Child exited) @ 0 (0) ---
</I>&gt;<i> --- SIGCHLD (Child exited) @ 0 (0) ---
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2594), sin_addr=inet_addr(&quot;24.27.123.223&quot;)}, [2452772955646590992]) = 161
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1690), sin_addr=inet_addr(&quot;67.242.75.46&quot;)}, [11098558340291100688]) = 276
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(41825), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [7035467051472781328]) = 276
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(41910), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [13160362544696655888]) = 276
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> here's the strace in the normal state:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(40442), sin_addr=inet_addr(&quot;74.140.139.210&quot;)}, [18058590089415491600]) = 2218
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(58477), sin_addr=inet_addr(&quot;99.194.115.132&quot;)}, [7918454053414109200]) = 431
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(50878), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [13746674921184952336]) = 356
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1154), sin_addr=inet_addr(&quot;190.37.68.45&quot;)}, [9368613133427408912]) = 356
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> --- SIGCHLD (Child exited) @ 0 (0) ---
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1212), sin_addr=inet_addr(&quot;125.60.240.211&quot;)}, [13547953587627229200]) = 356
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1158), sin_addr=inet_addr(&quot;190.37.68.45&quot;)}, [9656843509579120656]) = 2223
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(52008), sin_addr=inet_addr(&quot;24.189.205.204&quot;)}, [2939443190379315216]) = 2224
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(50808), sin_addr=inet_addr(&quot;72.155.68.155&quot;)}, [8702643338529996816]) = 2253
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2545), sin_addr=inet_addr(&quot;24.10.61.223&quot;)}, [17368413446520963088]) = 2263
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2547), sin_addr=inet_addr(&quot;24.10.61.223&quot;)}, [17512528634596818960]) = 356
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(52012), sin_addr=inet_addr(&quot;24.189.205.204&quot;)}, [3227673566531026960]) = 180
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(50809), sin_addr=inet_addr(&quot;72.155.68.155&quot;)}, [8774700932567924752]) = 2224
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1223), sin_addr=inet_addr(&quot;125.60.240.211&quot;)}, [14340587122044436496]) = 2253
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2462), sin_addr=inet_addr(&quot;206.74.170.35&quot;)}, [11387633141372944400]) = 2263
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2464), sin_addr=inet_addr(&quot;206.74.170.35&quot;)}, [11531748329448800272]) = 2263
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1645), sin_addr=inet_addr(&quot;61.145.215.253&quot;)}, [7855966608584343568]) = 2224
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(4172), sin_addr=inet_addr(&quot;68.188.149.222&quot;)}, [5480880755099828240]) = 1283
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(50931), sin_addr=inet_addr(&quot;70.129.57.218&quot;)}, [17565727405195132944]) = 1283
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(4173), sin_addr=inet_addr(&quot;68.188.149.222&quot;)}, [5552938349137756176]) = 2224
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1122), sin_addr=inet_addr(&quot;76.127.204.185&quot;)}, [7062770124213714960]) = 1283
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(51062), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [8558809625430851600]) = 2292
</I>&gt;<i> accept(13, 0x7fffc3d5ca30, [16])        = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1646), sin_addr=inet_addr(&quot;61.145.215.253&quot;)}, [7928024202622271504]) = 2292
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(50932), sin_addr=inet_addr(&quot;70.129.57.218&quot;)}, [17637784999233060880]) = 2310
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(4001), sin_addr=inet_addr(&quot;99.13.103.221&quot;)}, [11605494773346992144]) = 507
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(4004), sin_addr=inet_addr(&quot;99.13.103.221&quot;)}, [11821667555460775952]) = 507
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1131), sin_addr=inet_addr(&quot;76.127.204.185&quot;)}, [7711288470555066384]) = 1283
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2143), sin_addr=inet_addr(&quot;202.156.50.129&quot;)}, [6847723242006773776]) = 1894
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(2146), sin_addr=inet_addr(&quot;202.156.50.129&quot;)}, [7063896024120557584]) = 1894
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1779), sin_addr=inet_addr(&quot;222.165.66.136&quot;)}, [17511684209666686992]) = 1278
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(61674), sin_addr=inet_addr(&quot;99.230.169.52&quot;)}, [16929031007875629072]) = 1278
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(61679), sin_addr=inet_addr(&quot;99.230.169.52&quot;)}, [17289318978065268752]) = 1278
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1780), sin_addr=inet_addr(&quot;222.165.66.136&quot;)}, [17583741803704614928]) = 1913
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(52495), sin_addr=inet_addr(&quot;190.40.52.74&quot;)}, [1138566289384538128]) = 2310
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(51181), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [17133663315944275984]) = 2310
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(60995), sin_addr=inet_addr(&quot;88.105.44.33&quot;)}, [4894849853588242448]) = 2310
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(3636), sin_addr=inet_addr(&quot;71.64.15.79&quot;)}, [3750935548236136464]) = 2310
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(51273), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [5316499368700805136]) = 2334
</I>&gt;<i> accept(13, 0x7fffc3d5ca30, [16])        = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(52498), sin_addr=inet_addr(&quot;190.40.52.74&quot;)}, [1354739071498321936]) = 2334
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1440), sin_addr=inet_addr(&quot;24.21.117.196&quot;)}, [11530622429541957648]) = 2334
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(1442), sin_addr=inet_addr(&quot;24.21.117.196&quot;)}, [11674737617617813520]) = 2334
</I>&gt;<i> accept(9, {sa_family=AF_INET, sin_port=htons(60996), sin_addr=inet_addr(&quot;88.105.44.33&quot;)}, [4966907447626170384]) = 2336
</I>&gt;<i> accept(9, 0x7fffc3d5ca30, [16])         = -1 EAGAIN (Resource temporarily unavailable)
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(51345), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [10504646139431616528]) = 2337
</I>&gt;<i> accept(13, {sa_family=AF_INET, sin_port=htons(51348), sin_addr=inet_addr(&quot;10.18.2.10&quot;)}, [10720818921545400336]) = 2337
</I>&gt;<i> 
</I>&gt;<i> The only noticeable difference is the frequency of 
</I>&gt;<i> --- SIGCHLD (Child exited) @ 0 (0) ---
</I>&gt;<i> but it occurred in the normal state as well.
</I>&gt;<i> The server sends emails via child subprocesses, so I suspect Child exited may be due to that.
</I>&gt;<i> 
</I>&gt;<i> If that's the case, the strace output is identical, and I do not understand what's causing the problem at all.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-bounces at twistedmatrix.com</A> [mailto:twisted-python-
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">bounces at twistedmatrix.com</A>] On Behalf Of Jean-Paul Calderone
</I>&gt;&gt;<i> Sent: Wednesday, September 10, 2008 2:47 PM
</I>&gt;&gt;<i> To: Twisted general discussion
</I>&gt;&gt;<i> Subject: RE: [Twisted-Python] intermittent problem: not accepting new
</I>&gt;&gt;<i> connections
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, 10 Sep 2008 14:01:27 -0700, Alec Matusis &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">matusis at yahoo.com</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;&gt;<i> Do non-error log messages continue to appear in the Twisted log?
</I>&gt;&gt;<i> ie,
</I>&gt;&gt;&gt;&gt;<i> is
</I>&gt;&gt;&gt;&gt;<i> it clear that the logging system is still working, or could it have
</I>&gt;&gt;&gt;&gt;<i> failed
</I>&gt;&gt;&gt;&gt;<i> in some way, obscuring any exception reports?
</I>&gt;&gt;&gt;<i> Yes, I print the results of garbage collection every 10 min like this:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> print &quot;number of objects tracked by the garbage collector is:&quot;,
</I>&gt;&gt;<i> len(gc.get_objects())
</I>&gt;&gt;&gt;<i> and they appear in the main twisted log.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 2008/09/10 13:21 -0700 [-] number of objects tracked by the garbage
</I>&gt;&gt;<i> collector is: 860021
</I>&gt;&gt;&gt;<i> 2008/09/10 13:31 -0700 [-] number of objects tracked by the garbage
</I>&gt;&gt;<i> collector is: 864316
</I>&gt;&gt;&gt;&gt;<i> Any new unhandled errno values should definitely result in an
</I>&gt;&gt;<i> exception
</I>&gt;&gt;&gt;&gt;<i> being logged (notice that the `raise´ which follows the checks for
</I>&gt;&gt;&gt;&gt;<i> various errno values is inside a try/except which logs any
</I>&gt;&gt;<i> exception).
</I>&gt;&gt;&gt;<i> I noticed that raise too... Could it then be EWOULDBLOCK, EAGAIN or
</I>&gt;&gt;<i> EPERM?
</I>&gt;&gt;&gt;<i>                except socket.error, e:
</I>&gt;&gt;&gt;<i>                    if e.args[0] in (EWOULDBLOCK, EAGAIN):
</I>&gt;&gt;&gt;<i>                        self.numberAccepts = i
</I>&gt;&gt;&gt;<i>                        break
</I>&gt;&gt;&gt;<i>                    elif e.args[0] == EPERM:
</I>&gt;&gt;&gt;<i>                        # Netfilter on Linux may have rejected the
</I>&gt;&gt;&gt;<i>                        # connection, but we get told to try to
</I>&gt;&gt;<i> accept()
</I>&gt;&gt;&gt;<i>                        # anyway.
</I>&gt;&gt;&gt;<i>                        continue
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I am not sure how to debug this problem- I have another twisted server
</I>&gt;&gt;<i> of a different type on that machine, and while the problematic server
</I>&gt;&gt;<i> stops accepting connections, the second one works just fine, so this is
</I>&gt;&gt;<i> not a machine-wide issue.
</I>&gt;&gt;&gt;<i> What could it be?
</I>&gt;&gt;<i> You could try running strace against the server while it's not
</I>&gt;&gt;<i> accepting
</I>&gt;&gt;<i> connections.  You can limit the output to just accept calls, too:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    strace -p &lt;pid&gt; -etrace=accept
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Maybe this will show you that accept calls are happening but failing in
</I>&gt;&gt;<i> some way.  If it produces no output, you can widen it and see if you
</I>&gt;&gt;<i> can
</I>&gt;&gt;<i> tell what the server is doing if it isn't calling accept().
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Jean-Paul
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="050875.html">[Twisted-Python] intermittent problem: not	accepting	new	connections
</A></li>
	<LI>Next message (by thread): <A HREF="050877.html">[Twisted-Python] intermittent problem: not accepting new	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50876">[ date ]</a>
              <a href="thread.html#50876">[ thread ]</a>
              <a href="subject.html#50876">[ subject ]</a>
              <a href="author.html#50876">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
