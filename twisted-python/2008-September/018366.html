<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] intermittent problem: not	accepting	new	connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20intermittent%20problem%3A%20not%0A%09accepting%09new%09connections&In-Reply-To=048001c91391%243991ec60%24acb5c520%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018365.html">
   <LINK REL="Next"  HREF="018367.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] intermittent problem: not	accepting	new	connections</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20intermittent%20problem%3A%20not%0A%09accepting%09new%09connections&In-Reply-To=048001c91391%243991ec60%24acb5c520%24%40com"
       TITLE="[Twisted-Python] intermittent problem: not	accepting	new	connections">exarkun at divmod.com
       </A><BR>
    <I>Wed Sep 10 18:16:21 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="018365.html">[Twisted-Python] intermittent problem: not	accepting	new	connections
</A></li>
        <LI>Next message: <A HREF="018367.html">[Twisted-Python] intermittent problem: not	accepting	new	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18366">[ date ]</a>
              <a href="thread.html#18366">[ thread ]</a>
              <a href="subject.html#18366">[ subject ]</a>
              <a href="author.html#18366">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 10 Sep 2008 15:04:40 -0700, Alec Matusis &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">matusis at yahoo.com</A>&gt; wrote:
&gt;&gt;<i> You could try running strace against the server while it's not
</I>&gt;&gt;<i> accepting
</I>&gt;&gt;<i> connections.
</I>&gt;<i>
</I>&gt;<i>I have one short question before I try strace on live:
</I>&gt;<i>
</I>&gt;<i>I have been playing with strace this morning on my dev, and I observe that for every second connection, there are two accept calls, one is success and one is a failure:
</I>
I'm pretty sure this is a consequence of a heuristic optimization in the
accept loop.  When one connection is successfully accepted, a counter is
incremented.  Whenever it tries to accept connections, it will try up to
the number of times indicated by the current value of the counter.  When
it fails to get a new connection, it drops the counter to the number of
connections it did accept.  So in a lot of cases, it's flipping back and
forth between 1 and 2 attempts.

The point of this is that if you're receiving lots of connection attempts,
it'd be faster to accept many of them at once instead of only accepting one
each time around the reactor loop.  It's not clear the current implementation
is the best way to implement this optimization, but at least the code is very
old and hasn't changed in quite a while, so it's probably not actually causing
any problems.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018365.html">[Twisted-Python] intermittent problem: not	accepting	new	connections
</A></li>
	<LI>Next message: <A HREF="018367.html">[Twisted-Python] intermittent problem: not	accepting	new	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18366">[ date ]</a>
              <a href="thread.html#18366">[ thread ]</a>
              <a href="subject.html#18366">[ subject ]</a>
              <a href="author.html#18366">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
