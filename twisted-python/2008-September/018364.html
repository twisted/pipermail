<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] intermittent problem: not accepting	new	connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20intermittent%20problem%3A%20not%20accepting%0A%09new%09connections&In-Reply-To=045201c91388%2467f836d0%2437e8a470%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018363.html">
   <LINK REL="Next"  HREF="018365.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] intermittent problem: not accepting	new	connections</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20intermittent%20problem%3A%20not%20accepting%0A%09new%09connections&In-Reply-To=045201c91388%2467f836d0%2437e8a470%24%40com"
       TITLE="[Twisted-Python] intermittent problem: not accepting	new	connections">exarkun at divmod.com
       </A><BR>
    <I>Wed Sep 10 17:46:40 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="018363.html">[Twisted-Python] intermittent problem: not accepting	new	connections
</A></li>
        <LI>Next message: <A HREF="018365.html">[Twisted-Python] intermittent problem: not	accepting	new	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18364">[ date ]</a>
              <a href="thread.html#18364">[ thread ]</a>
              <a href="subject.html#18364">[ subject ]</a>
              <a href="author.html#18364">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 10 Sep 2008 14:01:27 -0700, Alec Matusis &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">matusis at yahoo.com</A>&gt; wrote:
&gt;&gt;<i> Do non-error log messages continue to appear in the Twisted log?  ie,
</I>&gt;&gt;<i> is
</I>&gt;&gt;<i> it clear that the logging system is still working, or could it have
</I>&gt;&gt;<i> failed
</I>&gt;&gt;<i> in some way, obscuring any exception reports?
</I>&gt;<i>
</I>&gt;<i>Yes, I print the results of garbage collection every 10 min like this:
</I>&gt;<i>
</I>&gt;<i>print &quot;number of objects tracked by the garbage collector is:&quot;, len(gc.get_objects())
</I>&gt;<i>
</I>&gt;<i>and they appear in the main twisted log.
</I>&gt;<i>
</I>&gt;<i>2008/09/10 13:21 -0700 [-] number of objects tracked by the garbage collector is: 860021
</I>&gt;<i>2008/09/10 13:31 -0700 [-] number of objects tracked by the garbage collector is: 864316
</I>&gt;<i>
</I>&gt;&gt;<i> Any new unhandled errno values should definitely result in an exception
</I>&gt;&gt;<i> being logged (notice that the `raise&#180; which follows the checks for
</I>&gt;&gt;<i> various errno values is inside a try/except which logs any exception).
</I>&gt;<i>
</I>&gt;<i>I noticed that raise too... Could it then be EWOULDBLOCK, EAGAIN or EPERM?
</I>&gt;<i>
</I>&gt;<i>                except socket.error, e:
</I>&gt;<i>                    if e.args[0] in (EWOULDBLOCK, EAGAIN):
</I>&gt;<i>                        self.numberAccepts = i
</I>&gt;<i>                        break
</I>&gt;<i>                    elif e.args[0] == EPERM:
</I>&gt;<i>                        # Netfilter on Linux may have rejected the
</I>&gt;<i>                        # connection, but we get told to try to accept()
</I>&gt;<i>                        # anyway.
</I>&gt;<i>                        continue
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I am not sure how to debug this problem- I have another twisted server of a different type on that machine, and while the problematic server stops accepting connections, the second one works just fine, so this is not a machine-wide issue.
</I>&gt;<i>What could it be?
</I>
You could try running strace against the server while it's not accepting
connections.  You can limit the output to just accept calls, too:

   strace -p &lt;pid&gt; -etrace=accept

Maybe this will show you that accept calls are happening but failing in
some way.  If it produces no output, you can widen it and see if you can
tell what the server is doing if it isn't calling accept().

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018363.html">[Twisted-Python] intermittent problem: not accepting	new	connections
</A></li>
	<LI>Next message: <A HREF="018365.html">[Twisted-Python] intermittent problem: not	accepting	new	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18364">[ date ]</a>
              <a href="thread.html#18364">[ thread ]</a>
              <a href="subject.html#18364">[ subject ]</a>
              <a href="author.html#18364">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
