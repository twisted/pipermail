<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Refactoring of trial - call for feature	requests and suggestions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Refactoring%20of%20trial%20-%20call%20for%20feature%0A%09requests%20and%20suggestions&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008004.html">
   <LINK REL="Next"  HREF="008008.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Refactoring of trial - call for feature	requests and suggestions</H1>
    <B>Brian Warner</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Refactoring%20of%20trial%20-%20call%20for%20feature%0A%09requests%20and%20suggestions&In-Reply-To="
       TITLE="[Twisted-Python] Refactoring of trial - call for feature	requests and suggestions">warner at lothar.com
       </A><BR>
    <I>Tue Jun 15 12:20:36 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="008004.html">[Twisted-Python] Refactoring of trial - call for feature	requests	and suggestions
</A></li>
        <LI>Next message: <A HREF="008008.html">[Twisted-Python] Refactoring of trial - call for feature	requests	and suggestions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8007">[ date ]</a>
              <a href="thread.html#8007">[ thread ]</a>
              <a href="subject.html#8007">[ subject ]</a>
              <a href="author.html#8007">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> What's the point of this, exactly? How would you assert things about the
</I>&gt;<i> result of the Deferred? I've been using the functions in twisted.trial.util
</I>&gt;<i> for a while to deal with Deferreds in my tests, and it seems rather nice.
</I>
I assume the Deferred that comes back from the test case would merely be
expected to fire the callback successfully, and the value passed to that
callback would be ignored. Any result-checking would be done in chained
callbacks that fired beforehand.

The Deferred would just be to tell trial that it should spin the reactor
until the test completes. Oh, a feature request: please spin the reactor
gently.. use iterate(0.01) instead of iterate(), to avoid spamming the CPU on
tests that are gated by reactor.callLater. Also there should be a built-in
timeout, or an easy way to set one (with a default timeout imposed if the
method returns a Deferred without first setting a timeout).


Re: reactor cleaning, I think it's important that the reactor be in exactly
the same state before and after the test, which is more complicated than the
current checks we have in place (it should include resetting the state of
various &quot;one-time&quot; initializations, like threads, since we've had a few
failed-to-initialize-something bugs that were masked by earlier tests
performing the missing initialization). For this, I think we need a
reactor.clean or .reset method.

I'm undecided about whether tests should be expected to clean up after
themselves (i.e. if a test is flunked when reactor.reset has something to do
afterwards). It may be easier all around to establish the convention that the
reactor will be cleaned by trial so that the test case doesn't have to.

 -Brian


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008004.html">[Twisted-Python] Refactoring of trial - call for feature	requests	and suggestions
</A></li>
	<LI>Next message: <A HREF="008008.html">[Twisted-Python] Refactoring of trial - call for feature	requests	and suggestions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8007">[ date ]</a>
              <a href="thread.html#8007">[ thread ]</a>
              <a href="subject.html#8007">[ subject ]</a>
              <a href="author.html#8007">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
