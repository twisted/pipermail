<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] SMTP client patch 
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20SMTP%20client%20patch%20&In-Reply-To=glyph%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003028.html">
   <LINK REL="Next"  HREF="003031.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] SMTP client patch </H1>
    <B>Anders Hammarquist</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20SMTP%20client%20patch%20&In-Reply-To=glyph%40twistedmatrix.com"
       TITLE="[Twisted-Python] SMTP client patch ">iko at cd.chalmers.se
       </A><BR>
    <I>Thu Feb 20 19:29:34 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="003028.html">[Twisted-Python] InstallSignalHandlers question
</A></li>
        <LI>Next message: <A HREF="003031.html">[Twisted-Python] SMTP client patch 
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3029">[ date ]</a>
              <a href="thread.html#3029">[ thread ]</a>
              <a href="subject.html#3029">[ subject ]</a>
              <a href="author.html#3029">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In a message of Thu, 20 Feb 2003 16:14:31 CST, Glyph Lefkowitz writes:
&gt;<i>I had a look at this patch with Itamar today.  We like where you're 
</I>&gt;<i>going, but here are a few issues:
</I>&gt;<i>
</I>&gt;<i>1. it's not backwards compatible.  DocmaServer uses its own sendEmail, 
</I>&gt;<i>which depends on the sentEmail callback's signature.
</I>
Yes, I know. The changes were needed to be able to get complete
status for the message delivery. With the old code there was no
way to find out what happend to failed recipient addresses. I
suppose I could add logic to try and detect an old-style sentEmail.

&gt;<i>I personally would like to see Twisted's sendEmail deprecated and 
</I>&gt;<i>replaced with an admonishment to use the 'email' module ;), so it would 
</I>&gt;<i>be nice if you could re-implement sendEmail in terms of your  MIME-less 
</I>&gt;<i>'sendmail' function.
</I>
As in using sendmail plus the email module? Sure, will do.

&gt;<i>2. Those change to LineReceiver made no sense to us.  Care to explain?
</I>
Somewhere in the docs I read that returning (as opposed to raising)
an exception will land you in Factory.clientConnectionFailed with
that exception (wrapped in a failure). However, LineReceiver didn't
propagate the returned exceptions up to Protocol, so it didn't work
without those changes. smtpConnectionFailed and smtpTransferFailed
uses this.

&gt;<i>3. What's up with the SMTP logger?  and logging every line in the 
</I>&gt;<i>client?  This is duplicated generic code, and should probably be 
</I>&gt;<i>refactored into someplace more appropriate, like twisted.python.log.
</I>
I agree that it may be useful elsewhere (though expect it's use
will be rather limited). The purpose keeping the log is for
generating bounce messages (i.e. as sendmail says:

... while talking to foo.bar.org.:
&gt;&gt;&gt;<i> RCPT To:&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">spam at foo.bar.org</A>&gt;
</I>&lt;&lt;&lt; 550 User unknown
&gt;&gt;&gt;<i> RCPT To:&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">eggs at foo.bar.org</A>&gt;
</I>&lt;&lt;&lt; 450 Insufficient disk space

). My first look at t.p.log suggested not using it, since it dealt
mostly with syslog()-like logging. I'll have another look to see
if it fits with those logging functions, else I'll just rename it
to something more generic and let it live in t.p.log.

/Anders




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003028.html">[Twisted-Python] InstallSignalHandlers question
</A></li>
	<LI>Next message: <A HREF="003031.html">[Twisted-Python] SMTP client patch 
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3029">[ date ]</a>
              <a href="thread.html#3029">[ thread ]</a>
              <a href="subject.html#3029">[ subject ]</a>
              <a href="author.html#3029">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
