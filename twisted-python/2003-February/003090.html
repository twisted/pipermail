<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted Resources / PathArgs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20Resources%20/%20PathArgs&In-Reply-To=20030226093859.GA19242%40doublegemini.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003081.html">
   <LINK REL="Next"  HREF="003095.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted Resources / PathArgs</H1>
    <B>Mario Ruggier</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20Resources%20/%20PathArgs&In-Reply-To=20030226093859.GA19242%40doublegemini.com"
       TITLE="[Twisted-Python] Twisted Resources / PathArgs">mario at ruggier.org
       </A><BR>
    <I>Wed Feb 26 17:36:33 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="003081.html">[Twisted-Python] Twisted Resources / PathArgs
</A></li>
        <LI>Next message: <A HREF="003095.html">[Twisted-Python] Twisted Resources / PathArgs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3090">[ date ]</a>
              <a href="thread.html#3090">[ thread ]</a>
              <a href="subject.html#3090">[ subject ]</a>
              <a href="author.html#3090">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Clark, these little examples and explanations are very helpful.

I have a question on the PathArgs Resource you propose. Assuming we use
the PathArgs class as you suggest, there will be an exception thrown 
when a
requested &quot;dynamic&quot; URL does not include any actual path args, e.g. the 
URL
<A HREF="http://host/name:value/dynamic/whatever">http://host/name:value/dynamic/whatever</A> does actually work as 
suggested, with
variable &quot;name&quot; being added to the pathargs dict. However, if we ask 
simply for
<A HREF="http://host/dynamic/whatever">http://host/dynamic/whatever</A> then an exception is thrown because we try 
to access
req.pathargs, that is not set in this case (PathArgs.getChild() is not 
called)

Or, to put it differently, how can we make sure that Request acquires 
the pathargs
attribute, so that all children do not have to check for existance? (To 
me this seems
similar to having a request.args being always defined, even if no args.)

I am re-including your code below, slightly modified, to make myself 
clear...

mario

##

from twisted.web.resource import Resource
from twisted.internet import reactor
from twisted.web.server import Site
from twisted.web.static import File

class PathArgs(Resource):
     def __init__(self):
         Resource.__init__(self)
     def getChild(self,path,request):
         if not(hasattr(request,'pathargs')):
             request.pathargs = {}
         pair = path.split(':')
         if 2 == len(pair):
             request.pathargs[pair[0]] = pair[1]
             return self
         return Resource.getChild(self,path,request)

class DynamicRequest(Resource):
     def isLeaf(self):
         return true
     def render(self, req):
         req.content_type = 'text/plain'
         if not(hasattr(req,'pathargs')): # can this check be avoided?
             req.pathargs = {}
         return &quot;uri: %s \npathargs: %s &quot; % ( req.uri, req.pathargs )

def run():
     root = PathArgs()
     root.putChild(&quot;dynamic&quot;, DynamicRequest())
     root.putChild(&quot;static&quot;,File(&quot;.&quot;))
     site = Site(root)
     reactor.listenTCP(8081,site)
     reactor.run()

run()

##



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003081.html">[Twisted-Python] Twisted Resources / PathArgs
</A></li>
	<LI>Next message: <A HREF="003095.html">[Twisted-Python] Twisted Resources / PathArgs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3090">[ date ]</a>
              <a href="thread.html#3090">[ thread ]</a>
              <a href="subject.html#3090">[ subject ]</a>
              <a href="author.html#3090">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
