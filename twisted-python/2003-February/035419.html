<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] win32guireactor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20win32guireactor&In-Reply-To=%3Cvfzmlwyn.fsf%40python.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] win32guireactor</H1>
    <B>Thomas Heller</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20win32guireactor&In-Reply-To=%3Cvfzmlwyn.fsf%40python.net%3E"
       TITLE="[Twisted-Python] win32guireactor">theller at python.net
       </A><BR>
    <I>Fri Feb 14 08:10:24 MST 2003</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35419">[ date ]</a>
              <a href="thread.html#35419">[ thread ]</a>
              <a href="subject.html#35419">[ subject ]</a>
              <a href="author.html#35419">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Here's my win32guireactor code, which at least for me, works better
than win32eventreactor in my application.

I have some problems in my app when using win32eventreactor:

If the app displays a message box, no callLater calls are done
(because a win32 messagebox has it's own event loop, and doIteration()
is not called during this time.  There are also other things that the
user can do which shows the same behaviour, dragging a scrollbar for
example.

The second problem is that win32eventreactor uses a lot a cpu time -
nearly 100% even on my brandnew 2GHz P4.  Looks much like polling behaviour
instead of event driven.

So I wrote my own reactor implementation, which passes all events
(those I've covered so far, reactor.callLater and network events)
through a win32 message loop.  Deferred's are not yet passed through
the loop, so there is still some polling to be done.

Looking at the comments at the top of the win32eventreactor code,
my win32guireactor module shouldn't have the problems mentioned there.

I post this module here asking for peer review and critical comments.

This module requires win32all and my ctypes module as well,
see the source for details.

Thanks,

Thomas

PS: I tried to run unittests with this and other reactors with
the command line 
  py22 bin\trial -p twisted.test.test_internet -r &lt;reactor&gt; -v
here are the results:

default reactor
  FAILED (failures=5, errors=18)

win32eventreactor
  twisted.test.test_ftp:FTPClientAndServerTests.testLongFileListings
  hangs forver.

win32guireactor
  twisted.test.test_ftp:FTPClientAndServerTests.testLongFileListings
  crashes with this traceback, and then also hangs forever.
twisted.test.test_ftp
  FTPClientAndServerTests
    testBadLogin ...
    testLongFileListings ... Traceback (most recent call last):
  File &quot;C:\sf\Twisted\twisted\internet\win32guireactor.py&quot;, line 85, in __wm_timerevent
    tple.func(*tple.args, **tple.kw)
  File &quot;C:\sf\Twisted\twisted\test\test_ftp.py&quot;, line 124, in errback
    except self.failureException, e:
AttributeError: FTPClientAndServerTests instance has no attribute 'failureException'

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: win32guireactor.py
URL: &lt;/pipermail/twisted-python/attachments/20030214/0b1567c2/attachment.ksh&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35419">[ date ]</a>
              <a href="thread.html#35419">[ thread ]</a>
              <a href="subject.html#35419">[ subject ]</a>
              <a href="author.html#35419">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
