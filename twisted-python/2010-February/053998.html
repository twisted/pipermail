<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Handling exceptions in twisted.internet.udp?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Handling%20exceptions%20in%20twisted.internet.udp%3F&In-Reply-To=%3C4B7039CF.2070601%40fsn.hu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="054199.html">
   <LINK REL="Next"  HREF="053999.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Handling exceptions in twisted.internet.udp?</H1>
    <B>Attila Nagy</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Handling%20exceptions%20in%20twisted.internet.udp%3F&In-Reply-To=%3C4B7039CF.2070601%40fsn.hu%3E"
       TITLE="[Twisted-Python] Handling exceptions in twisted.internet.udp?">bra at fsn.hu
       </A><BR>
    <I>Mon Feb  8 09:20:31 MST 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="054199.html">[Twisted-Python] Weekly Bug Summary
</A></li>
        <LI>Next message (by thread): <A HREF="053999.html">[Twisted-Python] Handling exceptions in twisted.internet.udp?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53998">[ date ]</a>
              <a href="thread.html#53998">[ thread ]</a>
              <a href="subject.html#53998">[ subject ]</a>
              <a href="author.html#53998">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I have a code, which opens persistent (connected, see: 
<A HREF="http://twistedmatrix.com/documents/current/core/howto/udp.html#auto2">http://twistedmatrix.com/documents/current/core/howto/udp.html#auto2</A>) 
UDP connections, and sends and receives data on them.

The problem is that occasionally I receive ICMP 13 (administratively 
prohibited) errors from the destinations, which triggers and exception 
and closes the UDP socket. I would like to keep that open, no matter 
what happens.
On FreeBSD the exception comes during writing into the socket with 
transport.write, so this is an easy one.
But on Linux it's a little bit harder, because there I get exception not 
during writing, but reading, which is handled here:
<A HREF="http://twistedmatrix.com/trac/browser/tags/releases/twisted-9.0.0/twisted/internet/udp.py#L113">http://twistedmatrix.com/trac/browser/tags/releases/twisted-9.0.0/twisted/internet/udp.py#L113</A>

The exception looks like this:
2010-02-08 12:09:15+0100 [-] reactor class: 
twisted.internet.selectreactor.SelectReactor.
2010-02-08 12:10:22+0100 [__builtin__.connectedUDP (UDP)] Unhandled Error
        Traceback (most recent call last):
          File 
&quot;/usr/lib64/python2.6/site-packages/Twisted-9.0.0_r27775-py2.6-linux-x86_64.egg/twisted/python/log.py&quot;, 
line 84, in callWithLogger
            return callWithContext({&quot;system&quot;: lp}, func, *args, **kw)
          File 
&quot;/usr/lib64/python2.6/site-packages/Twisted-9.0.0_r27775-py2.6-linux-x86_64.egg/twisted/python/log.py&quot;, 
line 69, in callWithContext
            return context.call({ILogContext: newCtx}, func, *args, **kw)
          File 
&quot;/usr/lib64/python2.6/site-packages/Twisted-9.0.0_r27775-py2.6-linux-x86_64.egg/twisted/python/context.py&quot;, 
line 59, in callWithContext
            return self.currentContext().callWithContext(ctx, func, 
*args, **kw)
          File 
&quot;/usr/lib64/python2.6/site-packages/Twisted-9.0.0_r27775-py2.6-linux-x86_64.egg/twisted/python/context.py&quot;, 
line 37, in callWithContext
            return func(*args,**kw)
        --- &lt;exception caught here&gt; ---
          File 
&quot;/usr/lib64/python2.6/site-packages/Twisted-9.0.0_r27775-py2.6-linux-x86_64.egg/twisted/internet/selectreactor.py&quot;, 
line 146, in _doReadOrWrite
            why = getattr(selectable, method)()
          File 
&quot;/usr/lib64/python2.6/site-packages/Twisted-9.0.0_r27775-py2.6-linux-x86_64.egg/twisted/internet/udp.py&quot;, 
line 109, in doRead
            data, addr = self.socket.recvfrom(self.maxPacketSize)
        socket.error: [Errno 113] No route to host

I wonder what is the preferred way of achieving that the socket will be 
write()-able and kept open regardless what ICMP or other sending or 
receiving error occurs?

Thanks,



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="054199.html">[Twisted-Python] Weekly Bug Summary
</A></li>
	<LI>Next message (by thread): <A HREF="053999.html">[Twisted-Python] Handling exceptions in twisted.internet.udp?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53998">[ date ]</a>
              <a href="thread.html#53998">[ thread ]</a>
              <a href="subject.html#53998">[ subject ]</a>
              <a href="author.html#53998">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
