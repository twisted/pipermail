<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Another newbie question... out of file	descriptors?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Another%20newbie%20question...%20out%20of%20file%0A%09descriptors%3F&In-Reply-To=4B876993.5060608%40noir.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021691.html">
   <LINK REL="Next"  HREF="021693.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Another newbie question... out of file	descriptors?</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Another%20newbie%20question...%20out%20of%20file%0A%09descriptors%3F&In-Reply-To=4B876993.5060608%40noir.com"
       TITLE="[Twisted-Python] Another newbie question... out of file	descriptors?">glyph at twistedmatrix.com
       </A><BR>
    <I>Fri Feb 26 02:58:33 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021691.html">[Twisted-Python] Another newbie question... out of	file	descriptors?
</A></li>
        <LI>Next message: <A HREF="021693.html">[Twisted-Python] double slash '//' problem in url - authentication	with guard.HTTPAuthSessionWrapper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21692">[ date ]</a>
              <a href="thread.html#21692">[ thread ]</a>
              <a href="subject.html#21692">[ subject ]</a>
              <a href="author.html#21692">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Feb 26, 2010, at 12:26 AM, K. Richard Pixley wrote:

&gt;<i> Is it a reasonable workaround, or are there any nonobvious downsides to using reactor.waker.connectionLost(None)  either...
</I>
Yes.  Lots.  This is an _extremely_ hazardous area of Twisted to be mucking around with, as it may appear to work until it completely locks up your process.

&gt;<i> a) immediately after instantiating my reactor, (assuming I don't need a waker), or...
</I>
You always need a waker.  Twisted uses threads internally for several things: the two that come to mind immediately are name resolution and signal handling.  If you remove the waker, you will get hangs and crashes.

&gt;<i> b) immediately before or after calling reactor.stop
</I>
You need to wait for the reactor to fully shut down (i.e. 'run' exits, not 'stop' has been called) since service cleanup may be asynchronous and need to do things like resolve DNS names and handle further signals during shutdown (especially SIGCHLD, as subprocesses will typically exit during shutdown).

&gt;<i> I guess I'm asking why that hasn't been included in reactor.stop already.
</I>
The implementation is tricky, and you have to audit all the internal state that the reactor keeps.  To make matters worse, the test coverage for this area of Twisted is worse than others, because it's old code that works well enough and therefore (A) was written before Twisted had strong quality requirements such as complete test coverage, and (B) since it works well enough, it hasn't been extensively modified and therefore hasn't had to be re-examined to improve its test coverage to 100%.

But please, contribute patches to fix it!  It isn't *that* hard, mostly it's just that we've had lots of other stuff to do.  (See the weekly emails from trac about how many open tickets there are!)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20100226/e09d855e/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20100226/e09d855e/attachment-0001.htm</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021691.html">[Twisted-Python] Another newbie question... out of	file	descriptors?
</A></li>
	<LI>Next message: <A HREF="021693.html">[Twisted-Python] double slash '//' problem in url - authentication	with guard.HTTPAuthSessionWrapper
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21692">[ date ]</a>
              <a href="thread.html#21692">[ thread ]</a>
              <a href="subject.html#21692">[ subject ]</a>
              <a href="author.html#21692">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
