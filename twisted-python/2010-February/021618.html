<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Need help for structured application	development
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Need%20help%20for%20structured%20application%0A%09development&In-Reply-To=4B7E1768.8030608%40densedata.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021605.html">
   <LINK REL="Next"  HREF="021584.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Need help for structured application	development</H1>
    <B>Einar S. Ids&#248;</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Need%20help%20for%20structured%20application%0A%09development&In-Reply-To=4B7E1768.8030608%40densedata.com"
       TITLE="[Twisted-Python] Need help for structured application	development">einar.twisted at norsk-esport.no
       </A><BR>
    <I>Sun Feb 21 06:56:38 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021605.html">[Twisted-Python] Need help for structured	application	development
</A></li>
        <LI>Next message: <A HREF="021584.html">[Twisted-Python] web page on doc...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21618">[ date ]</a>
              <a href="thread.html#21618">[ thread ]</a>
              <a href="subject.html#21618">[ subject ]</a>
              <a href="author.html#21618">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Feb 19, 2010 at 5:45 AM, Johann Borck
&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">johann.borck at densedata.com</A>&gt; wrote:
&gt;<i> I see. So if I get these requirements right you have 5-10 services with
</I>&gt;<i> 1-30 instances of each, with following properties relevant to the task
</I>&gt;<i> at hand:
</I>&gt;<i>
</I>&gt;<i> 1. those pollable by your existing program.
</I>&gt;<i> 2. those incompatible with your existing program.
</I>&gt;<i> 3. those that do not stream additional data.
</I>&gt;<i> 4. those that do stream additional data.
</I>&gt;<i>
</I>&gt;<i> since sets &#160;(1 and 2) and (3 and 4) are distinct, the combinations
</I>&gt;<i> (1,3),(1,4),(2,3),(2,4) are possible.
</I>&gt;<i>
</I>&gt;<i> (1,3) the easy one, obviously you just need an object that polls the
</I>&gt;<i> service using your program in intervals specific to the service.
</I>&gt;<i> (1,4) Question: will the data you're interested in be collected by your
</I>&gt;<i> existing program or by twisted? In the former case, it's basically the
</I>&gt;<i> same as (1,3), in the latter you'll have to implement a protocol.
</I>&gt;<i> (2,3) for these you'll need to implement a protocol class.
</I>&gt;<i> (2,4) here you'll have to implement one or two protocols, depending on
</I>&gt;<i> how the service is implemented.
</I>&gt;<i>
</I>&gt;<i> Is the above about correct? I think it would be a good idea to have an
</I>&gt;<i> object OB that keeps references to all objects that gather data from the
</I>&gt;<i> services, grouped by the type of service they're responsible for
</I>&gt;<i> (defaultdict(list or dict) comes to mind). And then you'll probably
</I>&gt;<i> either want factories that take care of handing newly created protocol
</I>&gt;<i> instances over to OB or some instances (one or two per service in sets
</I>&gt;<i> (2,3,4) ) of a multipurpose factory that can be initialized with the
</I>&gt;<i> respective protocol and the information how to pass the created protocol
</I>&gt;<i> over to OB, maybe &#160;just a simple method that is able to distinguish the
</I>&gt;<i> protocols by the interfaces they implement.
</I>&gt;<i>
</I>&gt;<i> One pitfall might be your polling program in case you're using
</I>&gt;<i> t.i.u.getProcessOutput. It (t.i.u...) provides an asynchronous
</I>&gt;<i> interface, so the worst that can happen is a stray process that doesn't
</I>&gt;<i> return, but you still might want to consider implementing a
</I>&gt;<i> ProcessProtocol
</I>&gt;<i> (<A HREF="http://twistedmatrix.com/documents/current/core/howto/process.html">http://twistedmatrix.com/documents/current/core/howto/process.html</A>)
</I>&gt;<i> with a reasonable timeout, to be able to kill the spawned process in
</I>&gt;<i> case it doesn't terminate. Thinking about it, it's the better solution
</I>&gt;<i> anyway, because process protocols are just another type of protocol in
</I>&gt;<i> twisted, and can be integrated consistently with the rest of your app.
</I>&gt;<i>
</I>&gt;<i> Another utility you might want is t.i.task.LoopingCall, for obvious
</I>&gt;<i> reasons. Given your requirements something along these lines would be my
</I>&gt;<i> approach, although I'd probably reimplement the polling thingy in
</I>&gt;<i> twisted if it's not too complex :)
</I>&gt;<i>
</I>&gt;<i> hope that makes sense,
</I>&gt;<i> Johann
</I>
Johann,

Thank you very much for your detailed response. It is greatly appreciated.

I think what you describe makes sense, and I hope I understand what
you mean and how I can implement it: I need to create a &quot;suberobject&quot;
OB which references all the poller-objects. I need to create one
object per detected server instance, which takes care of creating a
timed spawning of the external poller-process, and passing it along to
OB. For those servers that require streamlisteners, I really only need
one factory per server type, with the ablity to match streamed data
with polled data via the poller-object. Is this somewhat on the right
track?

I absolutely hate creating lots of code just to find that it was done
in the &quot;wrong&quot; way, structurally speaking, and that it requires a lot
of work to rewrite in the &quot;correct way&quot; to allow for further expansion
of the application. Your answers are very helpful in letting me avoid
spaghetti-code.

Cheers,
Einar

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021605.html">[Twisted-Python] Need help for structured	application	development
</A></li>
	<LI>Next message: <A HREF="021584.html">[Twisted-Python] web page on doc...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21618">[ date ]</a>
              <a href="thread.html#21618">[ thread ]</a>
              <a href="subject.html#21618">[ subject ]</a>
              <a href="author.html#21618">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
