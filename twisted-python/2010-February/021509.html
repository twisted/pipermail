<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Error handling for modules which use	twisted.enterprise.adbapi
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Error%20handling%20for%20modules%20which%20use%0A%09twisted.enterprise.adbapi&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021612.html">
   <LINK REL="Next"  HREF="021512.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Error handling for modules which use	twisted.enterprise.adbapi</H1>
    <B>Vishal Shetye</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Error%20handling%20for%20modules%20which%20use%0A%09twisted.enterprise.adbapi&In-Reply-To="
       TITLE="[Twisted-Python] Error handling for modules which use	twisted.enterprise.adbapi">vishalshetye at gmail.com
       </A><BR>
    <I>Wed Feb 10 12:28:51 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021612.html">[Twisted-Python] Streaming File Transfer Protocol?
</A></li>
        <LI>Next message: <A HREF="021512.html">[Twisted-Python] How can I send unique configuration data for	multiple connections through a factory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21509">[ date ]</a>
              <a href="thread.html#21509">[ thread ]</a>
              <a href="subject.html#21509">[ subject ]</a>
              <a href="author.html#21509">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I have an application that uses twisted.enterprise.adbapi for
accessing sqlite database.
Recently I had to replace sqlite3 shipped with python 2.5 with latest
version of pysqlite2. This was for taking advantage of newer fixes in
pysqlite2.
I thought it would be worthwhile to support both.

However, functions called using runInteraction have a code block as given below.
try:
    txn.execute(&#8220;update query&#8221;)
except sqlite3.IntegrityError:
    handleDuplicateValues()

or
an errback on the function runQuery/Interaction/Operation. They all
used twisted.python.failure.check/trap on some exception of the form
sqlite3.some_dbapi_exception.
Now, all such places need to import exceptions from pysqlite2 instead
of sqlite3.

However, to handle multiple dbapi modules one of which will be
configured for use by the user, I thought, I will have a global name
having reference of the current dbapi module being used. This will be
used by errbacks and except blocks.

Is there a better way of handling exceptions in such cases?

I came across <A HREF="http://svn.sqlalchemy.org/sqlalchemy/trunk/lib/sqlalchemy/exc.py.">http://svn.sqlalchemy.org/sqlalchemy/trunk/lib/sqlalchemy/exc.py.</A>
I think sqlalchemy wraps dbapi erros in DBAPIError exception.
I imagine doing something similar in twisted as,
try:
    txn.execute(&#8220;update query&#8221;)
except adbapi.IntegrityError:
    handleDuplicateValues()

I also came across
<A HREF="http://mail.python.org/pipermail/db-sig/2003-September/003686.html">http://mail.python.org/pipermail/db-sig/2003-September/003686.html</A>
which suggests exceptions raised by different modules for same type of
error may not be consistent, atleast with respect to the information
provided.

Any suggestions on this would be very helpful.

Just to note <A HREF="http://twistedsphinx.funsize.net/projects/core/howto/rdbms.html">http://twistedsphinx.funsize.net/projects/core/howto/rdbms.html</A>
does not have error handling related info.

-- 
vishal shetye

</PRE>











































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021612.html">[Twisted-Python] Streaming File Transfer Protocol?
</A></li>
	<LI>Next message: <A HREF="021512.html">[Twisted-Python] How can I send unique configuration data for	multiple connections through a factory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21509">[ date ]</a>
              <a href="thread.html#21509">[ thread ]</a>
              <a href="subject.html#21509">[ subject ]</a>
              <a href="author.html#21509">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
