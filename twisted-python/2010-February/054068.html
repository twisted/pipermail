<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Authenticating with md5 hashed passwords
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Authenticating%20with%20md5%20hashed%20passwords&In-Reply-To=%3C1266251530.12763.221.camel%40mundo%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="054067.html">
   <LINK REL="Next"  HREF="054069.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Authenticating with md5 hashed passwords</H1>
    <B>Ramiro Alba Queipo</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Authenticating%20with%20md5%20hashed%20passwords&In-Reply-To=%3C1266251530.12763.221.camel%40mundo%3E"
       TITLE="[Twisted-Python] Authenticating with md5 hashed passwords">raq at cttc.upc.edu
       </A><BR>
    <I>Mon Feb 15 09:32:10 MST 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="054067.html">[Twisted-Python] Authenticating with md5 hashed passwords
</A></li>
        <LI>Next message (by thread): <A HREF="054069.html">[Twisted-Python] Authenticating with md5 hashed passwords
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54068">[ date ]</a>
              <a href="thread.html#54068">[ thread ]</a>
              <a href="subject.html#54068">[ subject ]</a>
              <a href="author.html#54068">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jean-Paul:

On Mon, 2010-02-15 at 13:25 +0000, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A> wrote:
&gt;<i> &gt;&gt;What do you mean when you say you're using plain text passwords?
</I>&gt;<i> &gt;&gt;Authentication involves multiple parties handling the password in
</I>&gt;<i> &gt;&gt;multiple ways, and the &quot;plain text&quot;-ness of the password changes from
</I>&gt;<i> &gt;&gt;step to step.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;I mean that the the server authenticates the client using a NOT HASHED
</I>&gt;<i> &gt;password. In my case using a VARCHAR field in a PostgreSQL table
</I>&gt;<i> &gt;&gt; &gt;from hashlib import md5
</I>&gt;<i> &gt;&gt; &gt;md5Password = md5(password).hexdigest()
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> 
</I>&gt;<i> I'm confused here.  I don't see this code in your checker implementation 
</I>&gt;<i> in the attached code.  Is this code running someplace else?
</I>
No, of course you can not. This is only a little python script I use to
produce I hashed password that I can put in the VARCHAR field of my
PostgreSQL table. This way I can make 'pure-ftpd' authenticate using md5
hashed passwords, but for that reason I have to change pb.py code at
twisted, swaping '.digest()' with '.hexdigest()'.
That way it works but at the price of having to change original twisted
code, which is not the option I want to support.

&gt;<i> &gt;&gt; &gt;then it does not authenticate (I use
</I>&gt;<i> &gt;&gt; &gt;credentials.checkMD5Password(password) at the checker class)
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;Then after reading
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;twisted/spread/pb.py
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;I saw that everything is done in the functions:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;respond(challenge, password)
</I>&gt;<i> &gt;&gt; &gt;challenge()
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;and the methods
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;checkMD5Password(self, md5Password)
</I>&gt;<i> &gt;&gt; &gt;checkPassword(self, password)
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;at the
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;class _PortalAuthChallenger(Referenceable, _JellyableAvatarMixin)
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;By changing digest() with hexdigest(), it works.
</I>&gt;<i> 
</I>&gt;<i> Indeed.  `checkMD5Password` needs to be passed the MD5 digest of the 
</I>&gt;<i> password, not the hex encoded MD5 digest (despite being documented as 
</I>&gt;<i> taking the plaintext password itself).
</I>
Yes I can understand that. So if I could put ha md5 hashed password in
the database but using digest() instead of hexdigest() I could make the
server authenticate but using 'checkMD5Password()' method directly a the
checker, but as you have said this is going to be deprecated.

&gt;<i> &gt;
</I>&gt;<i> &gt;Yes I Know. You do that at the 'respond(challenge, password)' in
</I>&gt;<i> &gt;'pb.py', do you?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;Also, IUsernameMD5Password is about to be deprecated, along with the
</I>&gt;<i> &gt;&gt;checkMD5Password method of _PortalAuthChallenger.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;So, how should I do it in order not to be using deprecated code? I 
</I>&gt;<i> &gt;would
</I>&gt;<i> &gt;like to know some details so that I can have a better understanding of
</I>&gt;<i> &gt;how authentication is working.
</I>&gt;<i> 
</I>&gt;<i> If you have the plaintext password in the PB server, then you can just 
</I>&gt;<i> call `checkPassword` instead of `checkMD5Password` in 
</I>&gt;<i> DBCredentialsChecker._cbAuthenticate.
</I>
Yes. This is working with plaintext password in the PB server, but not
with md5 hashed passwords, right?

Regards

-- 
Ramiro Alba

Centre Tecnològic de Tranferència de Calor
<A HREF="http://www.cttc.upc.edu">http://www.cttc.upc.edu</A>


Escola Tècnica Superior d'Enginyeries
Industrial i Aeronàutica de Terrassa
Colom 11, E-08222, Terrassa, Barcelona, Spain
Tel: (+34) 93 739 86 46


-- 
Aquest missatge ha estat analitzat per MailScanner
a la cerca de virus i d'altres continguts perillosos,
i es considera que està net.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="054067.html">[Twisted-Python] Authenticating with md5 hashed passwords
</A></li>
	<LI>Next message (by thread): <A HREF="054069.html">[Twisted-Python] Authenticating with md5 hashed passwords
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54068">[ date ]</a>
              <a href="thread.html#54068">[ thread ]</a>
              <a href="subject.html#54068">[ subject ]</a>
              <a href="author.html#54068">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
