<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Sending a stream via Protocol?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Sending%20a%20stream%20via%20Protocol%3F&In-Reply-To=1265474562.2805.3.camel%40kratos">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021486.html">
   <LINK REL="Next"  HREF="021490.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Sending a stream via Protocol?</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Sending%20a%20stream%20via%20Protocol%3F&In-Reply-To=1265474562.2805.3.camel%40kratos"
       TITLE="[Twisted-Python] Sending a stream via Protocol?">exarkun at twistedmatrix.com
       </A><BR>
    <I>Sat Feb  6 12:13:28 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021486.html">[Twisted-Python] Sending a stream via Protocol?
</A></li>
        <LI>Next message: <A HREF="021490.html">[Twisted-Python] Sending a stream via Protocol?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21488">[ date ]</a>
              <a href="thread.html#21488">[ thread ]</a>
              <a href="subject.html#21488">[ subject ]</a>
              <a href="author.html#21488">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04:42 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">darren at ontrenet.com</A> wrote:
&gt;<i>Hi,
</I>&gt;<i>  I have a simple protocol listening on a port. I send it a text message
</I>&gt;<i>(a filename)
</I>&gt;<i>and the protocol tries to stream back the bytes of the file. Mostly,
</I>&gt;<i>this works
</I>&gt;<i>but in some cases, the receiving side receives less bytes than is
</I>&gt;<i>written by:
</I>&gt;<i>
</I>&gt;<i>self.transport.write(bytes)
</I>&gt;<i>
</I>&gt;<i>I read the API which says it can receive less than expected bytes or
</I>&gt;<i>messages. Why?
</I>
That's how TCP works.  Bytes you send with one call to write may be 
split into two or more chunks and delivered to the remote dataReceived 
separately, or bytes you send with two or more calls to write may be 
combined into fewer chunks and delivered to the remote dataReceived all 
as one string.
&gt;<i>
</I>&gt;<i>So how can I reliably send a sequences of bytes via &quot;dataReceived&quot; in 
</I>&gt;<i>my
</I>&gt;<i>protocol?
</I>
If you want &quot;framing&quot; - a byte format built on top of the basic 
functionality provided by TCP, allowing you to differentiate bytes 
belonging to different logical messages from each other - then you 
should take a look at some of the protocols in twisted.protocols.basic 
(NetstringReceiver, Int32StringReceiver, etc) or twisted.protocols.amp 
which expands on this idea to a much greater degree.

You can read a lot more about these ideas in this series of articles by 
Itamar Turner-Trauring:

  <A HREF="http://www.xml.com/pub/au/215">http://www.xml.com/pub/au/215</A>

Jean-Paul

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021486.html">[Twisted-Python] Sending a stream via Protocol?
</A></li>
	<LI>Next message: <A HREF="021490.html">[Twisted-Python] Sending a stream via Protocol?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21488">[ date ]</a>
              <a href="thread.html#21488">[ thread ]</a>
              <a href="subject.html#21488">[ subject ]</a>
              <a href="author.html#21488">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
