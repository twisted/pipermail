<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Using DeferredList,	on the remote method get parameter of None type?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Using%20DeferredList%2C%0A%09on%20the%20remote%20method%20get%20parameter%20of%20None%20type%3F&In-Reply-To=%3C2014030715423486591612%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="060576.html">
   <LINK REL="Next"  HREF="028116.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Using DeferredList,	on the remote method get parameter of None type?</H1>
    <B>yangyouxiu</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Using%20DeferredList%2C%0A%09on%20the%20remote%20method%20get%20parameter%20of%20None%20type%3F&In-Reply-To=%3C2014030715423486591612%40gmail.com%3E"
       TITLE="[Twisted-Python] Using DeferredList,	on the remote method get parameter of None type?">yangyouxiu at gmail.com
       </A><BR>
    <I>Fri Mar  7 00:42:38 MST 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="060576.html">[Twisted-Python] Using DeferredList, on the remote method get parameter of None type?
</A></li>
        <LI>Next message (by thread): <A HREF="028116.html">[Twisted-Python] t.w.client.Agent exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60583">[ date ]</a>
              <a href="thread.html#60583">[ thread ]</a>
              <a href="subject.html#60583">[ subject ]</a>
              <a href="author.html#60583">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Thank you very much.
I got it, I changed it to use  a defer object, not deferredlist

From: exarkun
Date: 2014-03-05 23:00
To: Twisted general discussion
Subject: Re: [Twisted-Python] Using DeferredList, on the remote method get parameter of None type?
On 02:35 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">yangyouxiu at gmail.com</A> wrote:
&gt;<i>
</I>&gt;<i>When developing server-client software, on the client i call the method 
</I>&gt;<i>getTrafficDate, but on the server end, i got nio is 
</I>&gt;<i>None(d2=d.addCallback(lambda object: 
</I>&gt;<i>object.callRemote(&quot;getNIOTrafficInfo&quot;, node, nio)))
</I>&gt;<i>,so, what's the key point?
</I>&gt;<i>
</I>&gt;<i>[snip]
</I>&gt;<i>        for interface in interfaces:
</I>&gt;<i>            nio= 
</I>&gt;<i>self.interfacenio_dict[node]['interfaceinfo'][interface]
</I>&gt;<i>            if nio is not None:
</I>&gt;<i>                if 'nio_tap' in nio or 'NIO_NF_tap' in nio:
</I>&gt;<i>                    d= globals.perspective.callRemote('getServerRoot')
</I>&gt;<i>                    d2=d.addCallback(
</I>&gt;<i>                        lambda object:
</I>&gt;<i>                            object.callRemote(&quot;getNIOTrafficInfo&quot;, node, 
</I>&gt;<i>nio))
</I>&gt;<i>[snip]
</I>
The value of `nio` varies for each iteration of the loop.  The value of 
`nio` isn't passed to the getNIOTrafficInfo remote method until the `d` 
Deferred fires - this will almost certainly be only after the loop 
finishes (since it depends on network traffic which will only happen 
after this method returns).

So all of the remote calls will be made with whatever value `nio` has on 
the last iteration of the loop.  This is just how scopes work in Python. 
Consider this simplified example:
&gt;&gt;&gt;<i>def foo():
</I>...     functions = []
...     for i in range(3):
...         functions.append(lambda: i)
...     for f in functions:
...         print f()
...
&gt;&gt;&gt;<i>foo()
</I>2
2
2
&gt;&gt;&gt;<i>
</I>
Jean-Paul

_______________________________________________
Twisted-Python mailing list
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20140307/99e1ac35/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="060576.html">[Twisted-Python] Using DeferredList, on the remote method get parameter of None type?
</A></li>
	<LI>Next message (by thread): <A HREF="028116.html">[Twisted-Python] t.w.client.Agent exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60583">[ date ]</a>
              <a href="thread.html#60583">[ thread ]</a>
              <a href="subject.html#60583">[ subject ]</a>
              <a href="author.html#60583">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
