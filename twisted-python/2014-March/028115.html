<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Using DeferredList, on the remote method get parameter of None type?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Using%20DeferredList%2C%0A%20on%20the%20remote%20method%20get%20parameter%20of%20None%20type%3F&In-Reply-To=%3C20140305150047.6218.1060392688.divmod.xquotient.232%40top%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028114.html">
   <LINK REL="Next"  HREF="028122.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Using DeferredList, on the remote method get parameter of None type?</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Using%20DeferredList%2C%0A%20on%20the%20remote%20method%20get%20parameter%20of%20None%20type%3F&In-Reply-To=%3C20140305150047.6218.1060392688.divmod.xquotient.232%40top%3E"
       TITLE="[Twisted-Python] Using DeferredList, on the remote method get parameter of None type?">exarkun at twistedmatrix.com
       </A><BR>
    <I>Wed Mar  5 08:00:47 MST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="028114.html">[Twisted-Python] Using DeferredList,	on the remote method get parameter of None type?
</A></li>
        <LI>Next message: <A HREF="028122.html">[Twisted-Python] Using DeferredList,	on the remote method get parameter of None type?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28115">[ date ]</a>
              <a href="thread.html#28115">[ thread ]</a>
              <a href="subject.html#28115">[ subject ]</a>
              <a href="author.html#28115">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02:35 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">yangyouxiu at gmail.com</A> wrote:
&gt;<i>
</I>&gt;<i>When developing server-client software, on the client i call the method 
</I>&gt;<i>getTrafficDate, but on the server end, i got nio is 
</I>&gt;<i>None(d2=d.addCallback(lambda object: 
</I>&gt;<i>object.callRemote(&quot;getNIOTrafficInfo&quot;, node, nio)))
</I>&gt;<i>,so, what's the key point?
</I>&gt;<i>
</I>&gt;<i>[snip]
</I>&gt;<i>        for interface in interfaces:
</I>&gt;<i>            nio= 
</I>&gt;<i>self.interfacenio_dict[node]['interfaceinfo'][interface]
</I>&gt;<i>            if nio is not None:
</I>&gt;<i>                if 'nio_tap' in nio or 'NIO_NF_tap' in nio:
</I>&gt;<i>                    d= globals.perspective.callRemote('getServerRoot')
</I>&gt;<i>                    d2=d.addCallback(
</I>&gt;<i>                        lambda object:
</I>&gt;<i>                            object.callRemote(&quot;getNIOTrafficInfo&quot;, node, 
</I>&gt;<i>nio))
</I>&gt;<i>[snip]
</I>
The value of `nio` varies for each iteration of the loop.  The value of 
`nio` isn't passed to the getNIOTrafficInfo remote method until the `d` 
Deferred fires - this will almost certainly be only after the loop 
finishes (since it depends on network traffic which will only happen 
after this method returns).

So all of the remote calls will be made with whatever value `nio` has on 
the last iteration of the loop.  This is just how scopes work in Python. 
Consider this simplified example:
&gt;&gt;&gt;<i>def foo():
</I>...     functions = []
...     for i in range(3):
...         functions.append(lambda: i)
...     for f in functions:
...         print f()
...
&gt;&gt;&gt;<i>foo()
</I>2
2
2
&gt;&gt;&gt;<i>
</I>
Jean-Paul

</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028114.html">[Twisted-Python] Using DeferredList,	on the remote method get parameter of None type?
</A></li>
	<LI>Next message: <A HREF="028122.html">[Twisted-Python] Using DeferredList,	on the remote method get parameter of None type?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28115">[ date ]</a>
              <a href="thread.html#28115">[ thread ]</a>
              <a href="subject.html#28115">[ subject ]</a>
              <a href="author.html#28115">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
