<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Send many large files with PB
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Send%20many%20large%20files%20with%20PB&In-Reply-To=%3C20060516.234112.131383979.warner%40lothar.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="045626.html">
   <LINK REL="Next"  HREF="045633.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Send many large files with PB</H1>
    <B>Brian Warner</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Send%20many%20large%20files%20with%20PB&In-Reply-To=%3C20060516.234112.131383979.warner%40lothar.com%3E"
       TITLE="[Twisted-Python] Send many large files with PB">warner at lothar.com
       </A><BR>
    <I>Wed May 17 00:41:12 MDT 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="045626.html">[Twisted-Python] Send many large files with PB
</A></li>
        <LI>Next message (by thread): <A HREF="045633.html">[Twisted-Python] Send many large files with PB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45627">[ date ]</a>
              <a href="thread.html#45627">[ thread ]</a>
              <a href="subject.html#45627">[ subject ]</a>
              <a href="author.html#45627">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Justin Mazzola Paluska &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jmp at MIT.EDU</A>&gt; writes:

&gt;<i> - Should I send the files from SRC to DEST one-by-one?
</I>
That's how I would do it. If you're talking about gigabyte-sized files, the
protocol overhead will be pretty minimal compared to the data being
transferred. You've got a couple of objects to keep track of for each file
being sent, but on the other hand it will be a lot easier to keep track of
how much progress you've made (and keep the user informed) that way.

&gt;<i> - Or, is it better to use something like tarfile module to create a
</I>&gt;<i>   stream of bytes that I stream to the other side and decode?
</I>
I would recommend this approach if you had a bunch of small files. You want
to run that 'tar cf - WHAT' child against a ProcessProtocol that reacted to
dataReceived(data) by doing a rref.callRemote(&quot;moreDataForYou&quot;, data). You'd
probably want to accumulate data into chunks of maybe 4k or so to increase
efficiency. At the far end, your remote_moreDataForYou() call would write
that data into the untarring ProcessProtocol. Take a look at
doc/core/howto/process.xhtml for details on ProcessProtocols and
reactor.spawnProcess.

&gt;<i> - Finally, should I be doing something completely different?
</I>&gt;<i>   Normally, outside of my application, I'd just use rsync, scp, or
</I>&gt;<i>   some such.
</I>
I'd certainly investigate this method if the most of the files you are
sending are already in place on the far end. The bandwidth savings are worth
the extra setup hassle.

Is there a way to get rsync to speak to stdout/stdin instead of using a TCP
socket? If so, you could spawnProcess('rsync') and proxy it to the far end
over PB as with 'tar' above. Or, you could have your PB-connection-wielding
process listen on a local TCP socket, then tell rsync to talk directly to
that port, then do a socket-level proxy over PB to the far system.

Also remember that scp (or rsync-over-ssh or tar|ssh, etc) will be doing
better authentication than PB, since PB is all in cleartext. Many
applications don't require confidentiality, but before you switch from ssh to
straight PB you should be aware of what exactly you're giving up.

&lt;shameless plug&gt;
But, if you use NewPB, you get the strong authentication and confidentiality
of ssh with all of the juicy RemoteReference model you've come to know and
love from PB, check out NewPB[1] today.
&lt;/shameless plug&gt;.


cheers,
 -Brian

[1]: <A HREF="http://twistedmatrix.com/trac/wiki/NewPB">http://twistedmatrix.com/trac/wiki/NewPB</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="045626.html">[Twisted-Python] Send many large files with PB
</A></li>
	<LI>Next message (by thread): <A HREF="045633.html">[Twisted-Python] Send many large files with PB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45627">[ date ]</a>
              <a href="thread.html#45627">[ thread ]</a>
              <a href="subject.html#45627">[ subject ]</a>
              <a href="author.html#45627">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
