<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] zope.interface changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20zope.interface%20changes&In-Reply-To=%3C445627DB.6070509%40zope.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="045551.html">
   <LINK REL="Next"  HREF="045529.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] zope.interface changes</H1>
    <B>Jim Fulton</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20zope.interface%20changes&In-Reply-To=%3C445627DB.6070509%40zope.com%3E"
       TITLE="[Twisted-Python] zope.interface changes">jim at zope.com
       </A><BR>
    <I>Mon May  1 09:23:07 MDT 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="045551.html">[Twisted-Python] Question on pamauth.py
</A></li>
        <LI>Next message (by thread): <A HREF="045529.html">[Twisted-Python] What is the meaning of &quot;threadable.whenThreaded is deprecated Use application-level logic instead&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45528">[ date ]</a>
              <a href="thread.html#45528">[ thread ]</a>
              <a href="subject.html#45528">[ subject ]</a>
              <a href="author.html#45528">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I hope this is the right list to post to.  Twisted-dev seems more aptly named, but
it doesn't seem to get a lot of traffic.

I've recently refactored the adapter-registration implementation in zope.interface.
There were a number of reasons for this, including performance and making it possible,
in the future, to implement a capability similar to Python's super builtin for calling
overridden adaptera.

The performance gains for the simple-adapter lookup used by Twisted was about 200%.
For Zope, the changes led to about a 15-30% performance improvement.

I expect the new interface version to be released in June.

While working on this, I discovered that Twisted was bypassing the public API to
try to determne of there was an adapter registered:

     for interfaceClass in interfaceClasses:
         factory = self.get(origInterface).selfImplied.get(interfaceClass, {}).get('')

where self is an adapter registry.  This is in python/components.py.

I've added an adapter-registry API specifically for Twisted's use:

     def registered(required, provided, name=u''):
         &quot;&quot;&quot;Return the component registered for the given interfaces and name

         Unlike the lookup method, this methods won't retrieve
         components registered for more specific required interfaces or
         less specific provided interfaces.

         If no component was registered exactly for the given
         interfaces and name, then None is returned.

         &quot;&quot;&quot;

I've also added a backward-compatibility hack:

     def get(self, _):
         class XXXTwistedFakeOut:
             selfImplied = {}
         return XXXTwistedFakeOut

This makes Zope's tests pass. Not sure about Twisted's.

Obviously, it would be good for Twisted to move to the new public API.
In the future, if you need a new API, please feel free to ask. :)

Jim

-- 
Jim Fulton           mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jim at zope.com</A>       Python Powered!
CTO                  (540) 361-1714            <A HREF="http://www.python.org">http://www.python.org</A>
Zope Corporation     <A HREF="http://www.zope.com">http://www.zope.com</A>       <A HREF="http://www.zope.org">http://www.zope.org</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="045551.html">[Twisted-Python] Question on pamauth.py
</A></li>
	<LI>Next message (by thread): <A HREF="045529.html">[Twisted-Python] What is the meaning of &quot;threadable.whenThreaded is deprecated Use application-level logic instead&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45528">[ date ]</a>
              <a href="thread.html#45528">[ thread ]</a>
              <a href="subject.html#45528">[ subject ]</a>
              <a href="author.html#45528">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
