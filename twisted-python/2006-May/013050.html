<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: [Xapian-discuss] Twisted + Xapian	WriteableDatabase leaves db_lock file on exit.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20%5BXapian-discuss%5D%20Twisted%20%2B%20Xapian%0A%09WriteableDatabase%20leaves%20db_lock%20file%20on%20exit.&In-Reply-To=20060503162226.GJ32166%40survex.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013049.html">
   <LINK REL="Next"  HREF="013058.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: [Xapian-discuss] Twisted + Xapian	WriteableDatabase leaves db_lock file on exit.</H1>
    <B>jarrod roberson</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20%5BXapian-discuss%5D%20Twisted%20%2B%20Xapian%0A%09WriteableDatabase%20leaves%20db_lock%20file%20on%20exit.&In-Reply-To=20060503162226.GJ32166%40survex.com"
       TITLE="[Twisted-Python] Re: [Xapian-discuss] Twisted + Xapian	WriteableDatabase leaves db_lock file on exit.">jarrod at vertigrated.com
       </A><BR>
    <I>Wed May  3 13:32:20 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="013049.html">[Twisted-Python] Re: [Xapian-discuss] Twisted + Xapian	WriteableDatabase leaves db_lock file on exit.
</A></li>
        <LI>Next message: <A HREF="013058.html">[Twisted-Python] No-op TimerService on Windows?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13050">[ date ]</a>
              <a href="thread.html#13050">[ thread ]</a>
              <a href="subject.html#13050">[ subject ]</a>
              <a href="author.html#13050">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/3/06, Olly Betts &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">olly at survex.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> It seems this has cropped up before - see Michael Salib's point &quot;2.&quot;
</I>&gt;<i> here:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://article.gmane.org/gmane.comp.search.xapian.general/1387">http://article.gmane.org/gmane.comp.search.xapian.general/1387</A>
</I>&gt;<i>
</I>&gt;<i> I've not yet implemented WritableDatabase::close() though.
</I>&gt;<i>
</I>&gt;<i> Incidentally, the stale lockfile on exit issue goes away if you use
</I>&gt;<i> flint instead of quartz, though the database lock will still be held
</I>&gt;<i> while the process keeps running which could still be a problem.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>     Olly
</I>&gt;<i>
</I>
thanks for the hint about using Flint instead.
I thought I was but I guess I didn't add it to my .profile

using Flint it starts and stops and doesn't cause any problems now.

a .close() method on WritableDatabase might be a good addition.
Just so you can force the db closed when you think it might not be being
de-referenced reliably.

It seems to be the same type of issue listed in that link you posted.
Twisted is probably holding on to the Service object
and that is holding on to the db object.

I KNOW I am not sharing db objects nor document objects since it is all
single threaded and all self contained in that one index method.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20060503/a18c8069/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20060503/a18c8069/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013049.html">[Twisted-Python] Re: [Xapian-discuss] Twisted + Xapian	WriteableDatabase leaves db_lock file on exit.
</A></li>
	<LI>Next message: <A HREF="013058.html">[Twisted-Python] No-op TimerService on Windows?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13050">[ date ]</a>
              <a href="thread.html#13050">[ thread ]</a>
              <a href="subject.html#13050">[ subject ]</a>
              <a href="author.html#13050">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
