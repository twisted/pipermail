<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Flow, generators, coroutines etc.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Flow%2C%20generators%2C%20coroutines%20etc.&In-Reply-To=44799A1A.3080204%40imperial.ac.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013237.html">
   <LINK REL="Next"  HREF="013238.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Flow, generators, coroutines etc.</H1>
    <B>Michael</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Flow%2C%20generators%2C%20coroutines%20etc.&In-Reply-To=44799A1A.3080204%40imperial.ac.uk"
       TITLE="[Twisted-Python] Flow, generators, coroutines etc.">ms at cerenity.org
       </A><BR>
    <I>Sun May 28 17:59:12 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="013237.html">[Twisted-Python] Flow, generators, coroutines etc.
</A></li>
        <LI>Next message: <A HREF="013238.html">[Twisted-Python] Flow, generators, coroutines etc.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13240">[ date ]</a>
              <a href="thread.html#13240">[ thread ]</a>
              <a href="subject.html#13240">[ subject ]</a>
              <a href="author.html#13240">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sunday 28 May 2006 13:39, Phil Mayers wrote:
...
&gt;<i> All that said, the BBC Kamaelia project uses a generator-based
</I>&gt;<i> consumer/producer pipeline as its underlying primitive, and seems to get
</I>&gt;<i> along fine with it. But a consumer/producer component is not the same as
</I>&gt;<i> a lightweight thread of course - broadly a c/p will only ever interact
</I>&gt;<i> with its input, local variables, output and library calls. A thread
</I>&gt;<i> might be expected to interact with other threads and shared data, from
</I>&gt;<i> whence all difficulty springs.
</I>
&lt;/delurk&gt;

[ Since someone else raised us, I'd like to say a couple of things, since I
  think one is related to the conversation in hand, and the other is relevant
  to a conversation started at Europython last year about our work feeding
  into Twisted in a good way (ie a way useful to people using Twisted). ]

Hopefully both points are useful.

Given we're now churning out systems at work with Kamaelia which are getting
/close/ to what I'd be happy with as production systems, so it //seems// to
be working out OK so far as you say. One thing that's less obvious about
the term consumer producer (even though its correct) is people tend to
think pipelines, and many systems don't tend to be (we've invented the
term graphlines instead, for want of a better name).

As part of getting to that stage - getting back to why I was replying - as
well as pure generators, we also properly support threaded components now
(albeit with a couple of caveats). The only difference between those and
standard components is the baseclass you inherit from and the fact your
main method doesn't have a yield statement in it. Threaded components are
also useful for forcing true system quiescence. This also gives a fairly
simple migration route for code for integration.

This also means bridging sync and async worlds is pretty trivial - for example
a crappy interactive web-tester application can look like this: (would be
nicer to use sys.argv...)

pipeline(
   ConsoleReader(),                 # This uses raw_input in a thread.
   TCPClient(&quot;www.google.com&quot;, 80), # Async and uses a selector component
                                    # running in another thread so the
                                    # system can be quiescent
   ConsoleEchoer(),                 # Normal Async
).run()

(The reason TCPClient fires up a selector component is because it expects to
be in a situation where lots of networking stuff is happening. If it's not the
CPU/memory load addition is minimal)

There's more useful examples than the above, but I quite like the above
because of simplicity. (The system we've got for dumping DVB-T transport
streams, and transcoding them is much more fun, but longer winded :)

On the second point...

I think it's worth mentioning that our goal of trying to make it possible
to integrate our code with twisted by Europython this year was woefully
optimistic (we've been spending time on optimisations instead, which will
probably actually simplify integrating with twisted). (Integrating as in
&quot;work well with&quot;, not as in &quot;viewed as a good idea by everyone involved
with twisted :)&quot; ) [[ Sorry Tommi, I know there were aspects you wanted to 
nick... :-( ]]

&lt;relurk&gt;

Best Regards,


Michael.
--
Michael Sparks, Senior Research Engineer, BBC Research, Technology Group
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">michael.sparks at rd.bbc.co.uk</A>, Kamaelia Project Lead, <A HREF="http://kamaelia.sf.net/">http://kamaelia.sf.net/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013237.html">[Twisted-Python] Flow, generators, coroutines etc.
</A></li>
	<LI>Next message: <A HREF="013238.html">[Twisted-Python] Flow, generators, coroutines etc.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13240">[ date ]</a>
              <a href="thread.html#13240">[ thread ]</a>
              <a href="subject.html#13240">[ subject ]</a>
              <a href="author.html#13240">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
