<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] deferToThread - supported alternative to the	(deprecated) setTimeout method
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20deferToThread%20-%20supported%20alternative%20to%20the%0A%09%28deprecated%29%20setTimeout%20method&In-Reply-To=bms672p6vgja66fon36m1i44cc7pfif1nq%404ax.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013224.html">
   <LINK REL="Next"  HREF="013231.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] deferToThread - supported alternative to the	(deprecated) setTimeout method</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20deferToThread%20-%20supported%20alternative%20to%20the%0A%09%28deprecated%29%20setTimeout%20method&In-Reply-To=bms672p6vgja66fon36m1i44cc7pfif1nq%404ax.com"
       TITLE="[Twisted-Python] deferToThread - supported alternative to the	(deprecated) setTimeout method">exarkun at divmod.com
       </A><BR>
    <I>Tue May 23 22:43:35 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="013224.html">[Twisted-Python] deferToThread - supported alternative to the	(deprecated) setTimeout method
</A></li>
        <LI>Next message: <A HREF="013231.html">[Twisted-Python] Re: deferToThread - supported alternative to the	(deprecated) setTimeout method
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13225">[ date ]</a>
              <a href="thread.html#13225">[ thread ]</a>
              <a href="subject.html#13225">[ subject ]</a>
              <a href="author.html#13225">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 23 May 2006 21:49:23 +0100, Paul Moore &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">pf_moore at yahoo.co.uk</A>&gt; wrote:
&gt;<i>I have a program where I think that what I want to use is
</I>&gt;<i>deferToThread and setTimeout. However, the setTimeout method is marked
</I>&gt;<i>as deprecated - but I can't find a good supported alternative. Can
</I>&gt;<i>anyone help?
</I>&gt;<i>
</I>&gt;<i>The situation I have is:
</I>&gt;<i>
</I>&gt;<i>I need to do a large-ish number (50-100) of blocking calls in
</I>&gt;<i>parallel, and collect the results or any errors. In itself, this seems
</I>&gt;<i>like a suitable use for deferToThread (defer each call, and collect
</I>&gt;<i>the results in the deferred callback/errback).
</I>&gt;<i>
</I>&gt;<i>The problem is that in rare cases, the blocking call can block
</I>&gt;<i>indefinitely. In this case, I need to make the call time out. However,
</I>&gt;<i>the underlying API offers no way to time out the call, so I have to do
</I>&gt;<i>this externally.
</I>&gt;<i>
</I>&gt;<i>A quick prototype seems to work OK, using setTimeout to force a
</I>&gt;<i>timeout on the deferred, but it generates deprecation warnings for the
</I>&gt;<i>setTimeout call.
</I>&gt;<i>
</I>&gt;<i>What should I be using to achieve this effect?
</I>
There's some code along these lines here:

<A HREF="http://twistedmatrix.com/trac/browser/trunk/twisted/internet/base.py#L201">http://twistedmatrix.com/trac/browser/trunk/twisted/internet/base.py#L201</A>

It might make a good example to work from.  Note that any call that
blocks indefinitely will hold on to a thread indefinitely, and thus
reduce your effective thread pool size by one.  If this happens
enough, you'll end up with no free threads in your threadpool, and
no other threaded tasks will ever be able to complete.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013224.html">[Twisted-Python] deferToThread - supported alternative to the	(deprecated) setTimeout method
</A></li>
	<LI>Next message: <A HREF="013231.html">[Twisted-Python] Re: deferToThread - supported alternative to the	(deprecated) setTimeout method
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13225">[ date ]</a>
              <a href="thread.html#13225">[ thread ]</a>
              <a href="subject.html#13225">[ subject ]</a>
              <a href="author.html#13225">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
