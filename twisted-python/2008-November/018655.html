<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] freeing the reactor to do other jobs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20freeing%20the%20reactor%20to%20do%20other%20jobs&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018654.html">
   <LINK REL="Next"  HREF="018656.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] freeing the reactor to do other jobs</H1>
    <B>Jeff Dyke</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20freeing%20the%20reactor%20to%20do%20other%20jobs&In-Reply-To="
       TITLE="[Twisted-Python] freeing the reactor to do other jobs">jeff.dyke at gmail.com
       </A><BR>
    <I>Fri Nov  7 08:29:50 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="018654.html">[Twisted-Python] making twisted provide good feedback (was Re:	Having reactor run at the main thread...)
</A></li>
        <LI>Next message: <A HREF="018656.html">[Twisted-Python] freeing the reactor to do other jobs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18655">[ date ]</a>
              <a href="thread.html#18655">[ thread ]</a>
              <a href="subject.html#18655">[ subject ]</a>
              <a href="author.html#18655">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using the XMLRPC server in twisted and a few methods call other,
sometimes long running, functions/methods.  I'm trying to get my brain
around how to free the reactor to respond to other requests while this
is happening.

A scenario.  A call is made to the server, which selects say 10K rows
from a db and needs to check each row against a table and if they do
not exist, insert them.

&quot;&quot;&quot; Oversimplified version of the process &quot;&quot;&quot;
def getData(self,user_id):
    rows = self.getUserData(user_id)
    for row in rows:
        if self.existsInQueue(row['some_id']):
            continue
        else:
             self.insertQueue(row)


I want the caller to wait on a result from this process, but I also
want the reactor to be able to handle other requests as they come in.
This function is not directly registered in the xmlrpc server with
xmlrpc_getData, but is called by that type of method after validation
that it is allowed to run in this context.

What i've seen when this has thousands of rows to process is that the
reactor is tied up and can not respond to requests until complete.
Which obviously leads to me believe that I'm not using twisted
correctly/to its potential.  I have read the deferred/asynchronous doc
pages...but am having a hard time getting my head around it and would
appreciate any advice.

When i don't specifically need the caller to get the final result,
i've been suing deferToThread, but feel in some of those instances i
could possibly write better code, rather then sending to a thread.

Thanks
jd


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018654.html">[Twisted-Python] making twisted provide good feedback (was Re:	Having reactor run at the main thread...)
</A></li>
	<LI>Next message: <A HREF="018656.html">[Twisted-Python] freeing the reactor to do other jobs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18655">[ date ]</a>
              <a href="thread.html#18655">[ thread ]</a>
              <a href="subject.html#18655">[ subject ]</a>
              <a href="author.html#18655">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
