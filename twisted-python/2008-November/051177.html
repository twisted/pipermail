<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Import TypeError
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Import%20TypeError&In-Reply-To=%3C20081109135230.20272.1887878769.divmod.quotient.1011%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="051174.html">
   <LINK REL="Next"  HREF="051178.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Import TypeError</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Import%20TypeError&In-Reply-To=%3C20081109135230.20272.1887878769.divmod.quotient.1011%40ohm%3E"
       TITLE="[Twisted-Python] Import TypeError">exarkun at divmod.com
       </A><BR>
    <I>Sun Nov  9 06:52:30 MST 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="051174.html">[Twisted-Python] Import TypeError
</A></li>
        <LI>Next message (by thread): <A HREF="051178.html">[Twisted-Python] Import TypeError
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51177">[ date ]</a>
              <a href="thread.html#51177">[ thread ]</a>
              <a href="subject.html#51177">[ subject ]</a>
              <a href="author.html#51177">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 8 Nov 2008 22:15:39 -0500, James Joplin &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">thejayjay at gmail.com</A>&gt; wrote:
&gt;<i>I've been doing some embedded python work and everything has been working
</I>&gt;<i>like a charm thusfar!  Twisted has saved us tons of work, hats off to the
</I>&gt;<i>development team.
</I>&gt;<i>
</I>&gt;<i>I have been having issues with shutting down twisted completely (I think).
</I>&gt;<i> Even upon executing Py_Finalize or Py_EndInterpreter as necessary upon
</I>&gt;<i>re-entering our browser plugin we hit an exception during twisted import.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Here is my traceback :
</I>&gt;<i>
</I>&gt;<i>Traceback (most recent call last):
</I>&gt;<i>  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
</I>&gt;<i>  File &quot;ourCode.py&quot;, line 8, in &lt;module&gt;
</I>&gt;<i>    from twisted.spread import pb
</I>&gt;<i>  File &quot;C:\Python25\lib\site-packages\twisted\spread\pb.py&quot;, line 69, in
</I>&gt;<i>&lt;module&gt;
</I>&gt;<i>    from zope.interface import implements, Interface
</I>&gt;<i>  File &quot;C:\Python25\lib\site-packages\zope\interface\__init__.py&quot;, line 58,
</I>&gt;<i>in &lt;module&gt;
</I>&gt;<i>    _wire()
</I>&gt;<i>  File &quot;C:\Python25\lib\site-packages\zope\interface\interface.py&quot;, line
</I>&gt;<i>809, in _wire
</I>&gt;<i>    classImplements(Attribute, IAttribute)
</I>&gt;<i>  File &quot;C:\Python25\lib\site-packages\zope\interface\declarations.py&quot;, line
</I>&gt;<i>461, in classImplements
</I>&gt;<i>    spec = implementedBy(cls)
</I>&gt;<i>  File &quot;C:\Python25\lib\site-packages\zope\interface\declarations.py&quot;, line
</I>&gt;<i>332, in implementedByFallback
</I>&gt;<i>    if isinstance(spec, Implements):
</I>&gt;<i>TypeError: 'NoneType' object is not callable
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Changing the order of imports hasn't seemed to matter, looks to me like
</I>&gt;<i>something in zope init blows up if it's already loaded.
</I>&gt;<i>
</I>&gt;<i>Is there a safe way to make sure the threads are dead?  To clean imports
</I>&gt;<i>out?  Anything?  I haven't been able to find much documentation to help me
</I>&gt;<i>overcome the problem and I CANNOT forcibly unload our app from browser
</I>&gt;<i>memory.
</I>
Does CPython even support what you're trying to do?  As I recall, while
the interpreter finalization APIs mostly clean things up, they do leak
some resources.  On top of that, application-level finalization semantics
in CPython (that is, what happens to the Python code) are very unfriendly
and not very well defined.  For example, as you see, the globals of every
module are all reset to None, so any code that uses globals will probably
break.

&gt;<i>
</I>&gt;<i>If the C++ code we are using for startup / shutdown let me know and I will
</I>&gt;<i>post it as well.
</I>&gt;<i>
</I>
I'm not sure, but I don't think the problem you're seeing actually has
anything in particular to do with Twisted or Zope Interface.  I think it's
due to CPython's initialization and finalization behavior.  Can you produce
a similar exception by importing some trivial stand-alone Python code that
uses globals in a similar way?

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="051174.html">[Twisted-Python] Import TypeError
</A></li>
	<LI>Next message (by thread): <A HREF="051178.html">[Twisted-Python] Import TypeError
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51177">[ date ]</a>
              <a href="thread.html#51177">[ thread ]</a>
              <a href="subject.html#51177">[ subject ]</a>
              <a href="author.html#51177">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
