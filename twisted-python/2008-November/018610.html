<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Persistent Queue with subscriber worker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Persistent%20Queue%20with%20subscriber%20worker&In-Reply-To=490EB8EE.7000409%40iavante.es">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018609.html">
   <LINK REL="Next"  HREF="018617.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Persistent Queue with subscriber worker</H1>
    <B>Esteve Fernandez</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Persistent%20Queue%20with%20subscriber%20worker&In-Reply-To=490EB8EE.7000409%40iavante.es"
       TITLE="[Twisted-Python] Persistent Queue with subscriber worker">esteve at sindominio.net
       </A><BR>
    <I>Mon Nov  3 07:32:50 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="018609.html">[Twisted-Python] Persistent Queue with subscriber worker
</A></li>
        <LI>Next message: <A HREF="018617.html">[Twisted-Python] Persistent Queue with subscriber worker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18610">[ date ]</a>
              <a href="thread.html#18610">[ thread ]</a>
              <a href="subject.html#18610">[ subject ]</a>
              <a href="author.html#18610">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Daniel

On Monday 03 November 2008 09:40:14 Daniel de la Cuesta wrote:
&gt;<i>  I want to develop a video conversion service. My idea is to offer a REST
</I>&gt;<i> api and save all the conversion request in a database to track the state of
</I>&gt;<i> each process (pending, doing, done, error, etc.)
</I>
Do you plan to expose this REST api using Twisted?

&gt;<i>  I want to use this database table as a persistent queue and a twisted
</I>&gt;<i> daemon that takes its task from this table. This daemon has to take the
</I>&gt;<i> task, update the state of the task and do the work.
</I>&gt;<i>
</I>&gt;<i>  How can I subscribe the twisted daemon to the database inserts?
</I>&gt;<i>
</I>&gt;<i>  Is the thread pool a good approach to this problem?
</I>&gt;<i>
</I>&gt;<i>  Do you know a more simple solution to this problem?
</I>
Well, I wouldn't use a database at all (except for logging purposes only 
maybe). Actually you're already using the proper terms (queue, subscriber, 
etc.), so I would use a message-driven architecture:

- A messaging broker, either using AMQP (RabbitMQ, Qpid and OpenAMQ) or Stomp 
(RabbitMQ, ActiveMQ)
- You have a subscriber (waiting for messages on a queue), which dispatches 
tasks from the queue
- The web application sends messages to the messaging broker, which will route 
them to the right subscriber

One of the advantages of this scenario is that you can add more subscribers at 
runtime if needed, which will distribute the load between several conversion 
servers.

You can choose either AMQP [1] or Stomp [2], each has its strengths and 
weaknesses.

Cheers.

1 - <A HREF="https://launchpad.net/txamqp">https://launchpad.net/txamqp</A> (disclaimer, I'm one of the developers)
2 - <A HREF="http://code.google.com/p/stomper/">http://code.google.com/p/stomper/</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018609.html">[Twisted-Python] Persistent Queue with subscriber worker
</A></li>
	<LI>Next message: <A HREF="018617.html">[Twisted-Python] Persistent Queue with subscriber worker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18610">[ date ]</a>
              <a href="thread.html#18610">[ thread ]</a>
              <a href="subject.html#18610">[ subject ]</a>
              <a href="author.html#18610">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
