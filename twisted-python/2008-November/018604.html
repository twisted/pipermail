<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] A Python metaclass for Twisted allowing	__init__ to return a Deferred
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20A%20Python%20metaclass%20for%20Twisted%20allowing%0A%09__init__%20to%20return%20a%20Deferred&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018603.html">
   <LINK REL="Next"  HREF="018608.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] A Python metaclass for Twisted allowing	__init__ to return a Deferred</H1>
    <B>Terry Jones</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20A%20Python%20metaclass%20for%20Twisted%20allowing%0A%09__init__%20to%20return%20a%20Deferred&In-Reply-To="
       TITLE="[Twisted-Python] A Python metaclass for Twisted allowing	__init__ to return a Deferred">terry at jon.es
       </A><BR>
    <I>Sun Nov  2 20:01:08 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="018603.html">[Twisted-Python] A Python metaclass for Twisted allowing	__init__ to return a Deferred
</A></li>
        <LI>Next message: <A HREF="018608.html">[Twisted-Python] A Python metaclass for Twisted allowing __init__	to return a Deferred
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18604">[ date ]</a>
              <a href="thread.html#18604">[ thread ]</a>
              <a href="subject.html#18604">[ subject ]</a>
              <a href="author.html#18604">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Tristan

&gt;&gt;&gt;&gt;&gt;<i> &quot;Tristan&quot; == Tristan Seligmann &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mithrandi at mithrandi.net</A>&gt; writes:
</I>Tristan&gt; You can, however, encapsulate it into a classmethod or free
Tristan&gt; function that you call to get an instance of MyClass. This is a
Tristan&gt; pattern often seen when there are various ways to build an
Tristan&gt; instance of some class; you'll have a very basic __init__, and
Tristan&gt; then a bunch of factory functions or classmethods that do more
Tristan&gt; complicated work before passing the results in to the class's
Tristan&gt; constructor.

OK, thanks.

It feels to me (please correct me if I'm wrong) that the main reason you'd
want to follow this pattern is because you can't deal with Deferreds in an
__init__ method.

If you weren't dealing with Deferreds, you could just pass args to __init__
and have it figure out what to do. While it might be simpler to do as you
describe, and have various external factories, it feels (to me anyway) like
you're taking behavior that's class-dependent and putting it outside the
class.

__init__ can't return a result, presumably because if it has something it
wants to remember, or give you access to, it can put it on self, provide
you with a method, etc.

But in the Twisted world, I think it makes sense that there is some
provision for what's essentially a two-phase __init__.  I quite like my
approach, because the programmer wanting to write &quot;normal&quot; Twisted code
will likely find it natural that __init__ could work with Deferreds,
including returning one. To me that feels very natural.

Having said that, I don't particularly like the fact that there's a
special-case metaclass creating my classes, even though I wrote the code
myself :-)

&gt;&gt;<i> BTW, I sometimes have the feeling that Deferreds are like how M$
</I>&gt;&gt;<i> characterizes the GPL. Viral. Once you call anything creating a Deferred,
</I>&gt;&gt;<i> you're hooked - whatcha gonna do with that Deferred boy? Take one sip of
</I>&gt;&gt;<i> the Deferred Kool Aid and the next thing you know you're on a drip.
</I>
Tristan&gt; Just wait until you start trying to combine iterators and deferreds ;)

Oh yeah... I tried that too :-)

  <A HREF="http://www.twistedmatrix.com/pipermail/twisted-python/2008-June/017984.html">http://www.twistedmatrix.com/pipermail/twisted-python/2008-June/017984.html</A>

Comments on that code very welcome too!

Terry


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018603.html">[Twisted-Python] A Python metaclass for Twisted allowing	__init__ to return a Deferred
</A></li>
	<LI>Next message: <A HREF="018608.html">[Twisted-Python] A Python metaclass for Twisted allowing __init__	to return a Deferred
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18604">[ date ]</a>
              <a href="thread.html#18604">[ thread ]</a>
              <a href="subject.html#18604">[ subject ]</a>
              <a href="author.html#18604">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
