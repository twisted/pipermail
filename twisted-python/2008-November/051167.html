<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] freeing the reactor to do other jobs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20freeing%20the%20reactor%20to%20do%20other%20jobs&In-Reply-To=%3C20081107140710.29191.172519003.divmod.quotient.51284%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="051164.html">
   <LINK REL="Next"  HREF="051165.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] freeing the reactor to do other jobs</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20freeing%20the%20reactor%20to%20do%20other%20jobs&In-Reply-To=%3C20081107140710.29191.172519003.divmod.quotient.51284%40ohm%3E"
       TITLE="[Twisted-Python] freeing the reactor to do other jobs">exarkun at divmod.com
       </A><BR>
    <I>Fri Nov  7 07:07:10 MST 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="051164.html">[Twisted-Python] freeing the reactor to do other jobs
</A></li>
        <LI>Next message (by thread): <A HREF="051165.html">[Twisted-Python] freeing the reactor to do other jobs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51167">[ date ]</a>
              <a href="thread.html#51167">[ thread ]</a>
              <a href="subject.html#51167">[ subject ]</a>
              <a href="author.html#51167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 7 Nov 2008 13:56:53 +0000, Reza Lotun &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">reza at getpeer.com</A>&gt; wrote:
&gt;<i>On Fri, Nov 7, 2008 at 1:29 PM, Jeff Dyke &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jeff.dyke at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> I want the caller to wait on a result from this process, but I also
</I>&gt;&gt;<i> want the reactor to be able to handle other requests as they come in.
</I>&gt;&gt;<i> This function is not directly registered in the xmlrpc server with
</I>&gt;&gt;<i> xmlrpc_getData, but is called by that type of method after validation
</I>&gt;&gt;<i> that it is allowed to run in this context.
</I>&gt;<i>
</I>&gt;<i>Hi Jeff,
</I>&gt;<i>
</I>&gt;<i>I'll let others tackle your specific twisted-database integration
</I>&gt;<i>problem, but here are a few general rules of them I've found useful
</I>&gt;<i>when working with twisted, sqlite and wx.
</I>&gt;<i>
</I>&gt;<i>- Any long-computations will block your app in general because of the
</I>&gt;<i>GIL. Threading won't solve this (unless you move the compute intensive
</I>&gt;<i>code into a C-module which explicitly releases the GIL, which can be
</I>&gt;<i>hairy). Investigate using reactor.spawnProcess to spawn external
</I>&gt;<i>processes to do any compute intensive stuff.
</I>
Long-running computations generally only block the thread they're
running in.  This shouldn't be surprising, since there's not really
any difference between a function that does a &quot;computation&quot; and a
function which is somehow just &quot;regular&quot; Python code and isn't a
&quot;computation&quot;.  You can find details of how threading works in
Python in the Python documentation, but briefly, after N bytecodes
are executed, the VM running in thread A releases the GIL (required
to execute bytecode) and any other thread has a chance to acquire it.
By default, N is 100 (enough to multiply about 30 numbers together).

It's only when you bring C into the picture that you have to think
about explicitly releasing the GIL to prevent one thread from blocking
all the rest.  As long as your program is all Python, all your threads
will basically play nicely together (an exception to this seems to be
time.sleep() on Windows sometimes, which many people find blocks all
threads inexplicably - but time.time is implemented in C, so this really
just proves the point :).

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="051164.html">[Twisted-Python] freeing the reactor to do other jobs
</A></li>
	<LI>Next message (by thread): <A HREF="051165.html">[Twisted-Python] freeing the reactor to do other jobs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51167">[ date ]</a>
              <a href="thread.html#51167">[ thread ]</a>
              <a href="subject.html#51167">[ subject ]</a>
              <a href="author.html#51167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
