<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Lore to Sphinx Conversion Progress Report 4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Lore%20to%20Sphinx%20Conversion%20Progress%20Report%204&In-Reply-To=4ACFD295-E621-47F4-B665-4EF9D2B7637F%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021383.html">
   <LINK REL="Next"  HREF="021356.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Lore to Sphinx Conversion Progress Report 4</H1>
    <B>Kevin Horn</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Lore%20to%20Sphinx%20Conversion%20Progress%20Report%204&In-Reply-To=4ACFD295-E621-47F4-B665-4EF9D2B7637F%40twistedmatrix.com"
       TITLE="[Twisted-Python] Lore to Sphinx Conversion Progress Report 4">kevin.horn at gmail.com
       </A><BR>
    <I>Thu Jan 21 11:55:14 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021383.html">[Twisted-Python] Lore to Sphinx Conversion Progress Report 4
</A></li>
        <LI>Next message: <A HREF="021356.html">[Twisted-Python] deferring result to PB a callRemote method
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21381">[ date ]</a>
              <a href="thread.html#21381">[ thread ]</a>
              <a href="subject.html#21381">[ subject ]</a>
              <a href="author.html#21381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Jan 20, 2010 at 9:57 PM, Glyph Lefkowitz &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt;wrote:

&gt;<i> On Jan 19, 2010, at 4:33 PM, Kevin Horn wrote:
</I>&gt;<i>
</I>&gt;<i> This time I think I'm gonna skip saying how I haven't gotten as much done
</I>&gt;<i> as I would like...oh darn.
</I>&gt;<i>
</I>&gt;<i> Anyways, time for another gripping installment...
</I>&gt;<i>
</I>&gt;<i> Progress:
</I>&gt;<i>   - tables are now handled (mostly) properly, thanks to Zeth at
</I>&gt;<i> <A HREF="http://commandline.org.uk/">http://commandline.org.uk/</A>
</I>&gt;<i>   - blockquote tags handled
</I>&gt;<i>   - much improved whitespace/indentation handling
</I>&gt;<i>   - some nicer styling thanks to Michael Thompson
</I>&gt;<i>   - I've managed to convert the docs for the 3 Divmod projects with Lore
</I>&gt;<i>     docs, though I've yet to put them up anywhere.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Yay!
</I>&gt;<i>
</I>&gt;<i>   - due to ReST's insistence on &quot;inline markup&quot; being surrounded by
</I>&gt;<i>     whitespace or certain special characters, there are a lot of places
</I>&gt;<i> where
</I>&gt;<i>     such inline markup gets jacked up, by not including whitespace in front
</I>&gt;<i> of
</I>&gt;<i>     it.  If I put whitespace in front of everything though, my indentation
</I>&gt;<i>     handling gets jacked up and about 400+ Sphinx build warning result.
</I>&gt;<i>     Not sure if I should spend the time to make whitespace handling really
</I>&gt;<i>     smart or if these should just be fixed manually post-conversion.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I don't really understand this problem.  What do you mean about making
</I>&gt;<i> whitespace handling really smart?  Isn't this the sort of detail that
</I>&gt;<i> docutils is supposed to handle for you?
</I>&gt;<i>
</I>&gt;<i>
</I>OK, lemme esplain...no, would take too long, lemme sum up.

In some of the Lore docs, you have stuff like:

    some&lt;em&gt;stuff&lt;/em&gt;

which naively translated to ReST looks like:

    some*stuff*

but since ReST wants whitespace and/or special characters surrounding
&quot;inline markup&quot;,  docutils/Sphinx doesn't recognize it properly as markup
and just sends it unmodified to the HTML (or whatever) output..

The obvious solution is to just surround all inline markup with spaces,
since we're mainly targeting HTML output at the moment and a few extra
spaces shouldn't hurt.  Which would look like this:

    some *stuff*

But this turns out to cause other problems, specifically in the case where
inline markup occurs on the beginning of a line, and the extra space jacks
up the indentation (which ReST considers significant).

So the whitespace handling I was referring to was the output of whitespace
from lore2sphinx.


&gt;<i>   - Themeing/styling: still mostly a TODO, though new styling looks a lot
</I>&gt;<i>     better than the default to my eyes.  I'm starting to think that
</I>&gt;<i>     eventually we might want to have 2 themes/styles...one to match the
</I>&gt;<i>     trac-based website, and one for bundled docs (docs tarballs, CHM files,
</I>&gt;<i> etc.)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That would certainly be nice, but is in no way required for the initial
</I>&gt;<i> migration.  Still, we should have a workable theme in order before we pull
</I>&gt;<i> the trigger :).
</I>&gt;<i>
</I>
Right, as I said &quot;eventually&quot;.


&gt;<i>
</I>&gt;<i>   - some of the Lore source files have nested &quot;inline markup&quot;, which ReST
</I>&gt;<i>     disallows.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Ugh.  So ReST *can't do this?*  That's pretty lame.
</I>&gt;<i>
</I>
It's a little bit lame, but I've found that it doesn't occur all that often
in practice.  Every markup language has it's limitations, and this is one I
can live with.


&gt;<i>       - just handle the outside level of nesting (what I'm doing now) and
</I>&gt;<i>         fix any problems manually post-conversion.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm assuming there are very few instances of this, so that sounds fine.
</I>&gt;<i>
</I>
That's pretty much my plan.


&gt;<i>
</I>&gt;<i>   - xhtml entities are not currently resolved...mostly because it makes
</I>&gt;<i>     the build take a LOOOONG time.  They can be though.  This shouldn't
</I>&gt;<i>     be a problem.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Are you resolving them by downloading all the DTDs or something?
</I>&gt;<i>
</I>
The lxml parser can download DTDs in order to resolve external entities, but
the way things are currently set up, it would end up doing this once for
each Lore source file, which ends up making my build process take much
longer.  Because I didn't want to deal with this during development, and
since there are only like 4 external entities in all of the Lore docs, I
turned this off and told lxml to ignore the errors. It may be that there is
a better way to do this (maybe cache the DTDs somehow), but I haven't really
bothered with it yet.  It's a simple matter to turn it back on when we're
ready, even if there isn't an easy/convenient way to avoid the repeated
downloads of the DTDs.


&gt;<i>
</I>&gt;<i>   - Foolscap 0.5 was released today, which made me wonder what they use for
</I>&gt;<i>
</I>&gt;<i>     docs...and it's Lore.  I brought this up on IRC, and it was suggested
</I>&gt;<i>     by many that Lore should stick around even after the conversion
</I>&gt;<i> according
</I>&gt;<i>     to the standard Twisted compatibility policy, to give anyone who still
</I>&gt;<i>     uses it time to migrate.  This sounds like a fine idea to me.
</I>&gt;<i>     Any thoughts?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Since nobody really uses lore's API, the same compatibility policy doesn't
</I>&gt;<i> really apply.  In lore's case, I would say that the policy should be that we
</I>&gt;<i> include it with X more releases just for packaging convenience, but stop
</I>&gt;<i> doing maintenance immediately.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>Fine with me.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20100121/12501b1e/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20100121/12501b1e/attachment.htm</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021383.html">[Twisted-Python] Lore to Sphinx Conversion Progress Report 4
</A></li>
	<LI>Next message: <A HREF="021356.html">[Twisted-Python] deferring result to PB a callRemote method
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21381">[ date ]</a>
              <a href="thread.html#21381">[ thread ]</a>
              <a href="subject.html#21381">[ subject ]</a>
              <a href="author.html#21381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
