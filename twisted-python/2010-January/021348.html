<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Timeout with pb callRemote
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Timeout%20with%20pb%20callRemote&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021353.html">
   <LINK REL="Next"  HREF="021349.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Timeout with pb callRemote</H1>
    <B>Allen Bierbaum</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Timeout%20with%20pb%20callRemote&In-Reply-To="
       TITLE="[Twisted-Python] Timeout with pb callRemote">abierbaum at gmail.com
       </A><BR>
    <I>Mon Jan 18 16:06:36 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021353.html">[Twisted-Python] deferring result to PB a callRemote method
</A></li>
        <LI>Next message: <A HREF="021349.html">[Twisted-Python] Timeout with pb callRemote
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21348">[ date ]</a>
              <a href="thread.html#21348">[ thread ]</a>
              <a href="subject.html#21348">[ subject ]</a>
              <a href="author.html#21348">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I just tracked down a bug in one of our servers that uses twisted PB.
The long and short of it was that the server made remote calls to
clients that connected in and in some cases those clients would fall
off the network (disconnected network cable, etc) but the server would
not detect this.

I tracked this down to TCP timeouts not telling twisted rapidly enough
that the clients were offline.  What I was going to use to solve this
was to put a timeout on the remoteCall() by calling setTimeout on the
deferred returned when making the call.  Then if the deferred does not
fire soon enough I could treat this as a dead client detection and
clean up it's resources.

The problem is that it looks like Deferred.setTimeout is deprecated.
(see: <A HREF="http://twistedmatrix.com/trac/browser/tags/releases/twisted-9.0.0/twisted/internet/defer.py#L350">http://twistedmatrix.com/trac/browser/tags/releases/twisted-9.0.0/twisted/internet/defer.py#L350</A>)

Is there some other suitable way to set a timeout on a remoteCall when using PB?

-Allen

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021353.html">[Twisted-Python] deferring result to PB a callRemote method
</A></li>
	<LI>Next message: <A HREF="021349.html">[Twisted-Python] Timeout with pb callRemote
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21348">[ date ]</a>
              <a href="thread.html#21348">[ thread ]</a>
              <a href="subject.html#21348">[ subject ]</a>
              <a href="author.html#21348">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
