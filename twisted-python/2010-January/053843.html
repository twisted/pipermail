<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Plain windows sockets and twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Plain%20windows%20sockets%20and%20twisted&In-Reply-To=%3C3db160681001171525t2105d051icc2539db8831ab3%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="053841.html">
   <LINK REL="Next"  HREF="053844.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Plain windows sockets and twisted</H1>
    <B>Daniel Griffin</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Plain%20windows%20sockets%20and%20twisted&In-Reply-To=%3C3db160681001171525t2105d051icc2539db8831ab3%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Plain windows sockets and twisted">dgriff1 at gmail.com
       </A><BR>
    <I>Sun Jan 17 16:25:35 MST 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="053841.html">[Twisted-Python] Accessing the request object from a different thread
</A></li>
        <LI>Next message (by thread): <A HREF="053844.html">[Twisted-Python] Plain windows sockets and twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53843">[ date ]</a>
              <a href="thread.html#53843">[ thread ]</a>
              <a href="subject.html#53843">[ subject ]</a>
              <a href="author.html#53843">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I am using twisted in a cross-platform manner. I have written both the
client and server. The client is twisted and the server uses python threads.
I am using the select reactor and plain old TCP connections. I encode my
messages to JSON to send them.

On Windows I get tons of un-clean connectionlost events, on Mac everything
works perfectly. I am using the same data set in each case.

If I use the threaded server on windows and the twisted client on mac then I
still get tons of errors. 99% of these times these errors happen after the
last dataReceived when the socket should be closed cleanly.

My threaded code is:
        try:
            (clientsocket, address) = serversocket.accept()
        except Exception, e:
            print &quot;Exception &quot;, e, clientsocket
        try:
            p = processrequest()
            p.set_socket(clientsocket)
            p.start()

and in processrequest
self.sock.send_all(my_json_message)
self.sock.close()

Is this the correct behavior for using plain sockets with twisted? Any
reason why this would be perfectly fine on OSX and not Windows? Sorry for
the long email.

Thank you very very much,
Dan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20100117/302b314b/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="053841.html">[Twisted-Python] Accessing the request object from a different thread
</A></li>
	<LI>Next message (by thread): <A HREF="053844.html">[Twisted-Python] Plain windows sockets and twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53843">[ date ]</a>
              <a href="thread.html#53843">[ thread ]</a>
              <a href="subject.html#53843">[ subject ]</a>
              <a href="author.html#53843">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
