<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Plain windows sockets and twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Plain%20windows%20sockets%20and%20twisted&In-Reply-To=%3C60CC8333-817A-41A2-8EB5-FA38CFFD4485%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="053846.html">
   <LINK REL="Next"  HREF="053848.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Plain windows sockets and twisted</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Plain%20windows%20sockets%20and%20twisted&In-Reply-To=%3C60CC8333-817A-41A2-8EB5-FA38CFFD4485%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Plain windows sockets and twisted">glyph at twistedmatrix.com
       </A><BR>
    <I>Sun Jan 17 22:55:53 MST 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="053846.html">[Twisted-Python] Plain windows sockets and twisted
</A></li>
        <LI>Next message (by thread): <A HREF="053848.html">[Twisted-Python] Plain windows sockets and twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53847">[ date ]</a>
              <a href="thread.html#53847">[ thread ]</a>
              <a href="subject.html#53847">[ subject ]</a>
              <a href="author.html#53847">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jan 17, 2010, at 10:45 PM, Daniel Griffin wrote:

&gt;<i> Here are two tiny apps. They run perfectly on OSX and error like this on windows:
</I>&gt;<i> 
</I>&gt;<i> Log conenction  [Failure instance: Traceback (failure with no frames): &lt;class 't
</I>&gt;<i> wisted.internet.error.ConnectionLost' Connection to the other side was lost in
</I>&gt;<i>  a non-clean fashion.
</I>&gt;<i> ] Log conenction  [Failure instance: Traceback (failure with no frames): &lt;class
</I>&gt;<i> 'twisted.internet.error.ConnectionLost' Connection to the other side was lost
</I>&gt;<i> in a non-clean fashion.
</I>
Ah.  This is very simple, and luckily has nothing to do with threads.

The simplest explanation is that these errors are showing up because you are printing them out :).  If you stop printing them out, they won't show up.

More specifically: You generally shouldn't worry about &quot;clean&quot; vs. &quot;non-clean&quot; connection shutdown.  There are lots of things that can cause &quot;clean&quot; shutdowns to still lose data, and there are many cases where a &quot;non-clean&quot; shutdown is actually fine.  Your application protocol should be framing messages such that you can tell which ones have been responded to.

That said, what's going on here is pretty simple.  A &quot;clean&quot; shutdown is, broadly speaking, when both ends of the TCP connection agree on where the stream of bytes begins and ends.  I send you some data, you read all of it, I shut down the connection, you shut down the connection.  If I send you some data, and you *don't* read all of it, then I shut the connection down, the result will be a &quot;non-clean&quot; shutdown, because there is still data outstanding when the connection dies.

In this case, you are calling recv(5) in your server, but your client is writing &quot;RESPOND&quot; to its transport.  As you can see,

   &gt;&gt;&gt; len(&quot;RESPOND&quot;)
   7

&quot;RESPOND&quot; is more than 5 bytes.

If you were using Twisted for your server, this wouldn't happen because Twisted always reads all the bytes that are available and delivers them to dataReceived.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="053846.html">[Twisted-Python] Plain windows sockets and twisted
</A></li>
	<LI>Next message (by thread): <A HREF="053848.html">[Twisted-Python] Plain windows sockets and twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53847">[ date ]</a>
              <a href="thread.html#53847">[ thread ]</a>
              <a href="subject.html#53847">[ subject ]</a>
              <a href="author.html#53847">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
