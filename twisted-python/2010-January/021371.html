<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] WSGI Question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20WSGI%20Question&In-Reply-To=d272f0691001201223p3f1f61d6rb7d090f87e8a7fd4%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021369.html">
   <LINK REL="Next"  HREF="021363.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] WSGI Question</H1>
    <B>Phil Christensen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20WSGI%20Question&In-Reply-To=d272f0691001201223p3f1f61d6rb7d090f87e8a7fd4%40mail.gmail.com"
       TITLE="[Twisted-Python] WSGI Question">phil at bubblehouse.org
       </A><BR>
    <I>Wed Jan 20 15:43:11 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021369.html">[Twisted-Python] WSGI Question
</A></li>
        <LI>Next message: <A HREF="021363.html">[Twisted-Python] WSGI Production ready
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21371">[ date ]</a>
              <a href="thread.html#21371">[ thread ]</a>
              <a href="subject.html#21371">[ subject ]</a>
              <a href="author.html#21371">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jan 20, 2010, at 3:23 PM, Alex Clemesha wrote:
&gt;<i> I really want to getting reloading going.  I already have a ticket here:
</I>&gt;<i> <A HREF="http://github.com/clemesha/hotdot/issues#issue/2">http://github.com/clemesha/hotdot/issues#issue/2</A>
</I>&gt;<i> that describes this issue, with a couple of notes.  Please add to this
</I>&gt;<i> ticket / post any patches if you getting anywhere with this.
</I>
I don't think it gets much better than Django's approach. Basically, the server code loads everything it needs to bootstrap, and then forks.

All the request handling and subsequent code execution takes place in the child process, so that when modules are loaded, they are only loaded into the child's memory space.

Then, before any request is processed, the child checks the originating files for all of the modules in sys.modules, and sees if any of them have a new modification date.

If so, the child process is killed, which is detected by the parent, which respawns the child. The respawned child has the state of the parent process (which hasn't loaded any external modules), so modules get freshly imported.

t.p.rebuild() is a big improvement over the stock reload() function, but in addition to requiring modules to be marked with the &quot;ALLOW_TWISTED_REBUILD&quot; flag, it suffers from the same issue that it's only able to reload modules that are in the current scope.

-phil
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021369.html">[Twisted-Python] WSGI Question
</A></li>
	<LI>Next message: <A HREF="021363.html">[Twisted-Python] WSGI Production ready
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21371">[ date ]</a>
              <a href="thread.html#21371">[ thread ]</a>
              <a href="subject.html#21371">[ subject ]</a>
              <a href="author.html#21371">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
