<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Advise for heavy concurrency
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Advise%20for%20heavy%20concurrency&In-Reply-To=%3C47513207.7070709%40libero.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   <LINK REL="Next"  HREF="048897.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Advise for heavy concurrency</H1>
    <B>Manlio Perillo</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Advise%20for%20heavy%20concurrency&In-Reply-To=%3C47513207.7070709%40libero.it%3E"
       TITLE="[Twisted-Python] Advise for heavy concurrency">manlio_perillo at libero.it
       </A><BR>
    <I>Sat Dec  1 03:05:59 MST 2007</I>
    <P><UL>
        
        <LI>Next message (by thread): <A HREF="048897.html">[Twisted-Python] Advise for heavy concurrency
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48896">[ date ]</a>
              <a href="thread.html#48896">[ thread ]</a>
              <a href="subject.html#48896">[ subject ]</a>
              <a href="author.html#48896">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alec Matusis ha scritto:
&gt;&gt;<i> What causes the CPU overload in such a case
</I>&gt;<i> 
</I>&gt;<i> It looks like the for loop that loops over connections to send the message 
</I>&gt;<i> is the main source of the load. The biggest problem is not the CPU however. 
</I>&gt;<i> When the process takes more than 70% of the CPU (as displayed by top), python seems to start 
</I>&gt;<i> skipping garbage collection, and the memory size of the process just keeps growing. We have no control over this.
</I>&gt;<i> 
</I>
You should break the loop into small parts.

If you send a message to a lot of clients, then Twisted needs to keep 
all the buffers in memory (since your loop is blocking the reactor and 
Twisted is unable to flush the buffers).

You see the memory growing because the Python interpreter will not 
release the memory to the operating system (however the memory should 
not grow indefinitely)


 &gt; [...]


Manlio Perillo


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message (by thread): <A HREF="048897.html">[Twisted-Python] Advise for heavy concurrency
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48896">[ date ]</a>
              <a href="thread.html#48896">[ thread ]</a>
              <a href="subject.html#48896">[ subject ]</a>
              <a href="author.html#48896">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
