<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: Advise for heavy concurrency
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Advise%20for%20heavy%20concurrency&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016413.html">
   <LINK REL="Next"  HREF="016406.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: Advise for heavy concurrency</H1>
    <B>Nicola Larosa</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Advise%20for%20heavy%20concurrency&In-Reply-To="
       TITLE="[Twisted-Python] Re: Advise for heavy concurrency">nico at teknico.net
       </A><BR>
    <I>Sun Dec  2 04:54:13 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="016413.html">[Twisted-Python] Advise for heavy concurrency
</A></li>
        <LI>Next message: <A HREF="016406.html">[Twisted-Python] Advise for heavy concurrency
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16402">[ date ]</a>
              <a href="thread.html#16402">[ thread ]</a>
              <a href="subject.html#16402">[ subject ]</a>
              <a href="author.html#16402">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Atilla wrote:
&gt;<i> When it comes to deferToThread - is that actually going to be of any
</I>&gt;<i> use? Do I get an advantage of running the &quot;send&quot; loop in a seperate
</I>&gt;<i> thread? What if, say, I never had to send more than 10-50 messages, so
</I>&gt;<i> the loop is relatively small - then I'd have to keep spawning threads
</I>&gt;<i> for no reason.
</I>
Exactly, no reason. Don't spawn threads, unless you have no other way.


&gt;<i> But - when it comes to large send queues, how can that be chopped in
</I>&gt;<i> an efficient manner? Chop it into equal pieces and schedule them with
</I>&gt;<i> small delay, one after the other?
</I>
Yes, and the delay can be very small. Send 50-100 messages at a time, then
run the next batch with a reactor.callLater(0.00000001, ...). That way the
reactor will be able to handle network events with low latency.

Or just use coiterate, as Manlio said:

<A HREF="http://twistedmatrix.com/documents/current/api/twisted.internet.task.html">http://twistedmatrix.com/documents/current/api/twisted.internet.task.html</A>

It works in 10ms batches: that's your latency. It also uses a 10us delay on
the callLater.


&gt;<i> Defer them to another thread?
</I>
Don't. Only use threads in Twisted if you have to call external, synchronous
libraries, like database clients.


-- 
Nicola Larosa - <A HREF="http://www.tekNico.net/">http://www.tekNico.net/</A>

Restricting yourself to the intersection of the two versions [Python 2.6
and 3.0] is very painful and limited. We're not introducing backwards
compatibility syntax in 3.0, because that would defeat the purpose
(we've had backwards compatibility forever in 2.x, and the whole point
of 3.0 is to clean up the mess). -- Guido van Rossum, July 2007




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016413.html">[Twisted-Python] Advise for heavy concurrency
</A></li>
	<LI>Next message: <A HREF="016406.html">[Twisted-Python] Advise for heavy concurrency
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16402">[ date ]</a>
              <a href="thread.html#16402">[ thread ]</a>
              <a href="subject.html#16402">[ subject ]</a>
              <a href="author.html#16402">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
