From andrew-twisted at puzzling.org  Tue Oct  1 01:41:07 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 1 Oct 2002 15:41:07 +1000
Subject: [Twisted-Python] Bugs in epydoc API docs.
Message-ID: <20021001054107.GC24410@ritsuko.xware.cx>

E.g.
http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.99.2/twisted.internet.protocol.Protocol.html

Note the bug starting at connectionLost's description; the HTML source
looks like this:

<a NAME="connectionLost"/>
<h3>connectionLost</h3>
<code><b>connectionLost(self, reason=<twisted.python.failure.Failure twisted.internet.error.Co...)</B></code><p>

Which is obviously not quite right... it leads to the rest of the page being bolded.

Also, in 0.99.2alpha3's docs (sorry, no link for you, just looking in the docs
in moshez's debian package), in twisted.internet.protocol.html, this line is
rendered without a hyperlink:

   Maintainer: U{Itamar Shtull-Trauring<mailto:twisted at itamarst.org>}

Is this a bug in epydoc, or Twisted's use of epydoc?

-Andrew.




From grolgh at online.no  Tue Oct  1 03:49:50 2002
From: grolgh at online.no (Benjamin Bruheim)
Date: Tue, 01 Oct 2002 09:49:50 +0200
Subject: [Twisted-Python] Re: [Twisted-commits] How do I serve PHP-files
 with twisted.web? Answered.
References: <E17w47M-00052h-00@pyramid.twistedmatrix.com> <20020930.160518.59650770.glyph@twistedmatrix.com>
Message-ID: <3D99539E.6050108@online.no>

Glyph Lefkowitz wrote:
>>How do I serve PHP-files with twisted.web? Answered.
> This answer appears to be unnecessarily complex and confusing, when the user
> could just do "mktap web --path . --allow-ignore-ext" and get the same effect.
> (You probably want --index index.php too.) Is there any particular reason you
> answered that way? :)

Because it has been asked at least three times. :) Perhaps it could be 
changed into "how do I create a resource that serves PHP-Files", because 
the "create webserver"-part is explained a lot better other places. But 
I just wanted a complete example where just one line could be changed.

And, to do this in updateApplication:
resource.processors[".php"] = twcgi.PHPScript
Would not be saved in the tap, which is why I solved it this way. After 
all, I think if you're developing this is the info you would be 
interested in.

\\ benjamin bruheim




From glyph at twistedmatrix.com  Tue Oct  1 04:21:39 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 01 Oct 2002 03:21:39 -0500 (CDT)
Subject: [Twisted-Python] Re: [Twisted-commits] How do I serve
 PHP-files with twisted.web? Answered.
In-Reply-To: <3D99539E.6050108@online.no>
References: <E17w47M-00052h-00@pyramid.twistedmatrix.com>
	<20020930.160518.59650770.glyph@twistedmatrix.com>
	<3D99539E.6050108@online.no>
Message-ID: <20021001.032139.08318550.glyph@twistedmatrix.com>

On Tue, 01 Oct 2002 09:49:50 +0200, Benjamin Bruheim <grolgh at online.no> wrote:
> Glyph Lefkowitz wrote:
> >>How do I serve PHP-files with twisted.web? Answered.
> > This answer appears to be unnecessarily complex and confusing, when the user
> > could just do "mktap web --path . --allow-ignore-ext" and get the same effect.
> > (You probably want --index index.php too.) Is there any particular reason you
> > answered that way? :)
> 
> Because it has been asked at least three times. :)

If the specific question is the one you're answering, then it's too complex an
answer.  If people actually want the answer you gave, then the question should
be changed :).

> Perhaps it could be changed into "how do I create a resource that serves
> PHP-Files", because the "create webserver"-part is explained a lot better
> other places.

Maybe it should be two FAQs, if indeed the second one is "frequently" asked
(which seems strange to me): "1. How do I create a webserver with Twisted Web
that serves PHP files?" and "2. How do I programatically create a webserver
resource like the one I get from 'mktap web'?"

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021001/3d1aa29f/attachment.pgp 

From m at moshez.org  Tue Oct  1 05:02:27 2002
From: m at moshez.org (Moshe Zadka)
Date: 1 Oct 2002 09:02:27 -0000
Subject: [Twisted-Python] Improvements to twisted.protocols.smtp
In-Reply-To: <200209301501.g8UF1a9u001275@fido.strakt.com>
References: <200209301501.g8UF1a9u001275@fido.strakt.com>
Message-ID: <20021001090227.2568.qmail@green.zadka.com>

I promised I'll detail my problems with the patch.
I'll try to check something in this weekend, maybe these problems.
 
> Index: twisted/protocols/basic.py

I'd hesitate to touch protocols.basic without a unit test for this
feature.

> Index: twisted/protocols/smtp.py

I have a general problem here: the REs are very complicated and undocumented.
Please use re.X and comment the RE

> -class User:
> +class User(Address):

I'd prefer containment rather than inclusion here.

> -    def __init__(self):
> +    def __init__(self, domain=None, timeout=600):
>          self.mode = COMMAND
>          self.__from = None
>          self.__helo = None
> -        self.__to = ()
> +        self.__to = []
> +        self.timeout = timeout
> +        if not domain:
> +            import socket
> +            domain = socket.getfqdn()
> +        self.host = domain

this is wrong. the domain name should be in the protocol factory, not
in the protocol

> +        self.timeoutID = reactor.callLater(self.timeout, self.timedout)

please allow a timeout of "None" to mean "no timeouts"

> +            del self.__messages
> +        self.sendCode(500, 'Line too long')

this seems like it wouldn't work. the client would send the rest of the long
line, which look like a beginning of a command

>      def do_MAIL(self, rest):
> -        from_ = rest[len("MAIL:<"):-len(">")]
> -        self.validateFrom(self.__helo, from_, self._fromValid,
> -                                              self._fromInvalid)
> +        if not self.__helo:
> +            self.sendCode(503,"Who are you? Say HELO first");

be liberal, at least in the framework. if a user wants to allow
nonusing of helo, he should be free to do this. you can enforce helo
in validateFrom

> -        self.__init__()
> +        self.__from = None
> +        self.__to = []
>          self.sendCode(250, 'I remember nothing.')
what about __messages?





From bruce at cubik.org  Tue Oct  1 05:44:37 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 01 Oct 2002 03:44:37 -0600
Subject: [Twisted-Python] Bugs in epydoc API docs.
References: <20021001054107.GC24410@ritsuko.xware.cx>
Message-ID: <3D996E85.8040107@cubik.org>

Andrew Bennetts wrote:
> E.g.
> http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.99.2/twisted.internet.protocol.Protocol.html
> 
> Note the bug starting at connectionLost's description; the HTML source
> looks like this:
> 
> <a NAME="connectionLost"/>
> <h3>connectionLost</h3>
> <code><b>connectionLost(self, reason=<twisted.python.failure.Failure twisted.internet.error.Co...)</B></code><p>
> 
> Which is obviously not quite right... it leads to the rest of the page being bolded.

I'll look into that later.

> Also, in 0.99.2alpha3's docs (sorry, no link for you, just looking in the docs
> in moshez's debian package), in twisted.internet.protocol.html, this line is
> rendered without a hyperlink:
> 
>    Maintainer: U{Itamar Shtull-Trauring<mailto:twisted at itamarst.org>}
> 
> Is this a bug in epydoc, or Twisted's use of epydoc?

This is probably because there were epydoc markup errors in that block, 
so it went and made all or part of the block into a pre-formatted thing. 
  Twisted still has many many warnings and errors from epydoc that need 
to be fixed to eliminate problems like that.

  - Bruce




From robert at vaccaperna.co.uk  Tue Oct  1 06:42:46 2002
From: robert at vaccaperna.co.uk (Robert Cowham)
Date: Tue, 1 Oct 2002 11:42:46 +0100
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <20021001102401.18511.59760.Mailman@pyramid.twistedmatrix.com>
Message-ID: <PJEEINAIADEEJBLOMLGIEEEJCLAA.robert@vaccaperna.co.uk>

Hi

I have a build problem on the above platform combination:

C:\Download\Twisted-0.99.3alpha2\Twisted-0.99.3alpha2>python setup.py
build_ext
running build_ext
The C reactor is unavailable on this system.
checking for rpc/pmap_clnt.h ...
conftest.c
conftest.c(1) : fatal error C1083: Cannot open include file:
'rpc/pmap_clnt.h':
No such file or directory
The C reactor is unavailable on this system.
skipping 'twisted.spread.cBanana' extension (up-to-date)
skipping 'twisted.spread.cBanana' extension (up-to-date)

Is there any workaround for this?

I have also tried 0.99.2 and it has same problem.

Thanks
Robert




From andrew-twisted at puzzling.org  Tue Oct  1 06:58:20 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 1 Oct 2002 20:58:20 +1000
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <PJEEINAIADEEJBLOMLGIEEEJCLAA.robert@vaccaperna.co.uk>
References: <20021001102401.18511.59760.Mailman@pyramid.twistedmatrix.com> <PJEEINAIADEEJBLOMLGIEEEJCLAA.robert@vaccaperna.co.uk>
Message-ID: <20021001105820.GA671@frobozz.local>

On Tue, Oct 01, 2002 at 11:42:46AM +0100, Robert Cowham wrote:
> Hi
> 
> I have a build problem on the above platform combination:
> 
> C:\Download\Twisted-0.99.3alpha2\Twisted-0.99.3alpha2>python setup.py
> build_ext
> running build_ext
> The C reactor is unavailable on this system.
> checking for rpc/pmap_clnt.h ...
> conftest.c
> conftest.c(1) : fatal error C1083: Cannot open include file:
> 'rpc/pmap_clnt.h':
> No such file or directory

That's telling you don't have Sun-RPC support, which is only used by
twisted.inetd to run rpc services.  Basically, on Windows you won't miss it.
Hell, most Twisted users wouldn't miss it either :)

> skipping 'twisted.spread.cBanana' extension (up-to-date)
> skipping 'twisted.spread.cBanana' extension (up-to-date)

This is probably the most valuable of the C extensions in terms of speed
gain, and it works fine on Windows, as you can see here :)

> The C reactor is unavailable on this system.

This is because the C reactor uses poll (rather than select), which isn't
provided by Windows' sockets API.

You'll be limited to using the pure python reactors instead, which work just
fine, but are marginally slower.

Basically, don't sweat about it :)

-Andrew.




From robert at vaccaperna.co.uk  Tue Oct  1 07:13:58 2002
From: robert at vaccaperna.co.uk (Robert Cowham)
Date: Tue, 1 Oct 2002 12:13:58 +0100
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <20021001105820.GA671@frobozz.local>
Message-ID: <PJEEINAIADEEJBLOMLGIEEEPCLAA.robert@vaccaperna.co.uk>

> You'll be limited to using the pure python reactors instead,
> which work just
> fine, but are marginally slower.
>
> Basically, don't sweat about it :)
>

Thanks for the prompt response.

I tried running the portforward tap and it didn't work, which is why I then
looked at any build errors and found the above.

It gives me the following:

C:\Download\Twisted_NoDocs-0.99.2\Twisted-0.99.2\bin>python twistd -f
portforwar
d.tap
01/10/2002 12:12 [-] Log opened.
01/10/2002 12:12 [-] twistd 0.99.2 (C:\Python22\python.exe 2.2.1) starting
up
01/10/2002 12:12 [-] license user: Nobody <>
01/10/2002 12:12 [-] organization: No Organization
01/10/2002 12:12 [-] reactor class: twisted.internet.default.SelectReactor
01/10/2002 12:12 [-] Loading portforward.tap...
01/10/2002 12:12 [-] Loaded.
01/10/2002 12:12 [*portforward*] twisted.protocols.portforward.ProxyFactory
star
ting on 1555
01/10/2002 12:12 [*portforward*] Starting factory
<twisted.protocols.portforward
.ProxyFactory instance at 0x009C35C8>
01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory]
C:\Download\Twiste
d_NoDocs-0.99.2\Twisted-0.99.2\twisted\protocols\portforward.py:47:
DeprecationW
arning: clientTCP is deprecated - use connectTCP instead.
01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory]
clientProtocol)
01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory] Starting
factory <
twisted.internet.base.BCFactory instance at 0x00A0D2F8>
01/10/2002 12:13 [ProxyServer,0,127.0.0.1] Traceback (most recent call
last):
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\app.py", line 573, in run
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]
main.run(installSignalHandlers=in
stallSignalHandlers)
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\main.py", line 101, in run
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     _getReactor().run()
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\default.py", line 221, in run
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     self.mainLoop()
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\default.py", line 232, in mainLoop
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     self.doIteration(t)
01/10/2002 12:13 [ProxyServer,0,127.0.0.1] --- <exception caught here> ---
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\default.py", line 503, in doSelect
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     why = getattr(selectable,
method)
()
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\tcp.py", line 103, in doRead
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     return
self.protocol.dataReceived
(data)
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\protocols\portforward.py", line 36, in
dataReceived
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     self.peer.write(data)
01/10/2002 12:13 [ProxyServer,0,127.0.0.1] exceptions.AttributeError:
BCFactory
instance has no attribute 'write'
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]
C:\Download\Twisted_NoDocs-0.99.2\Twi
sted-0.99.2\twisted\internet\base.py:392: DeprecationWarning:
connectionFailed i
s deprecated.  See new Client API
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]
self.protocol.connectionFailed()
01/10/2002 12:13 [ProxyServer,0,127.0.0.1] Stopping factory
<twisted.internet.ba
se.BCFactory instance at 0x00A0D2F8>
01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory] (Port 1555
Closed)

01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory] Stopping
factory <
twisted.protocols.portforward.ProxyFactory instance at 0x009C35C8>
01/10/2002 12:13 [*portforward*] Saving portforward application to
portforward-s
hutdown.tap...
01/10/2002 12:13 [*portforward*] Saved.
01/10/2002 12:13 [*portforward*] Main loop terminated.
01/10/2002 12:13 [-] Server Shut Down.

C:\Download\Twisted_NoDocs-0.99.2\Twisted-0.99.2\bin>

Robert




From andrew-twisted at puzzling.org  Tue Oct  1 07:50:36 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 1 Oct 2002 21:50:36 +1000
Subject: [Twisted-Python] PATCH: OS X and Twisted
Message-ID: <20021001115036.GB671@frobozz.local>

This patch is from a friend of mine running OS X... this still doesn't make
the C extensions build, but at least it freaks out less.  It's a patch to
distutils.

Apparently OS X doesn't have a <poll.h>, although Fink distributes one, but
that installs to a non-standard location.  Basically, it looks like OS X
support for the C modules will be messy.


--- unixccompiler.py.bak        Sun Sep  1 19:17:42 2002
+++ unixccompiler.py    Tue Oct  1 21:29:43 2002
@@ -98,6 +98,8 @@
         (_, macros, include_dirs) = \
             self._fix_compile_args(None, macros, include_dirs)
         pp_opts = gen_preprocess_options(macros, include_dirs)
+       if sys.platform == "darwin":
+               pp_opts += ["-traditional-cpp"]
         pp_args = self.preprocessor + pp_opts
         if output_file:
             pp_args.extend(['-o', output_file])
@@ -134,6 +136,8 @@
 
         # Figure out the options for the compiler command line.
         pp_opts = gen_preprocess_options(macros, include_dirs)
+       if sys.platform == "darwin":
+               pp_opts += ["-traditional-cpp"]
         cc_args = pp_opts + ['-c']
         if debug:
             cc_args[:0] = ['-g']


-Andrew.




From twisted at moshez.org  Tue Oct  1 08:32:19 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 1 Oct 2002 12:32:19 -0000
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <PJEEINAIADEEJBLOMLGIEEEPCLAA.robert@vaccaperna.co.uk>
References: <PJEEINAIADEEJBLOMLGIEEEPCLAA.robert@vaccaperna.co.uk>
Message-ID: <20021001123219.4845.qmail@green.zadka.com>

On Tue, 1 Oct 2002, "Robert Cowham" <robert at vaccaperna.co.uk> wrote:

> I tried running the portforward tap and it didn't work, which is why I then
> looked at any build errors and found the above.

portforwarder recovers pretty badly from failed connection.
The CVS version should work much better, or just wait for 0.99.3 release
candidates.





From robert at vaccaperna.co.uk  Tue Oct  1 09:07:11 2002
From: robert at vaccaperna.co.uk (Robert Cowham)
Date: Tue, 1 Oct 2002 14:07:11 +0100
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <20021001123219.4845.qmail@green.zadka.com>
Message-ID: <PJEEINAIADEEJBLOMLGIKEFFCLAA.robert@vaccaperna.co.uk>

Thanks

> -----Original Message-----
> From: twisted-python-admin at twistedmatrix.com
> [mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Moshe Zadka
> Sent: 01 October 2002 13:32
> To: twisted-python at twistedmatrix.com
> Subject: RE: [Twisted-Python] RE: Problem with build on winxp/VC6
> 
> 
> On Tue, 1 Oct 2002, "Robert Cowham" <robert at vaccaperna.co.uk> wrote:
> 
> > I tried running the portforward tap and it didn't work, which 
> is why I then
> > looked at any build errors and found the above.
> 
> portforwarder recovers pretty badly from failed connection.
> The CVS version should work much better, or just wait for 0.99.3 release
> candidates.
> 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 



From bruce at cubik.org  Tue Oct  1 09:20:52 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 01 Oct 2002 07:20:52 -0600
Subject: [Twisted-Python] Bugs in epydoc API docs.
References: <20021001054107.GC24410@ritsuko.xware.cx>
Message-ID: <3D99A134.90405@cubik.org>

Andrew Bennetts wrote:
> E.g.
> http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.99.2/twisted.internet.protocol.Protocol.html
> 
> Note the bug starting at connectionLost's description; the HTML source
> looks like this:
> 
> <a NAME="connectionLost"/>
> <h3>connectionLost</h3>
> <code><b>connectionLost(self, reason=<twisted.python.failure.Failure twisted.internet.error.Co...)</B></code><p>
> 
> Which is obviously not quite right... it leads to the rest of the page being bolded.

Well, that's really old epydoc output.

The </B> thing is no longer an issue.  The leading '<' after the reason= 
is still a problem though.  A patch to epydoc is welcome, otherwise, 
I'll keep it on my list of things to look at fixing.

  - Bruce




From bob at redivi.com  Tue Oct  1 08:16:49 2002
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 1 Oct 2002 08:16:49 -0400
Subject: [Twisted-Python] PATCH: OS X and Twisted
In-Reply-To: <20021001115036.GB671@frobozz.local>
Message-ID: <A9166FC5-D537-11D6-9AD3-0003938210D6@redivi.com>

On Tuesday, October 1, 2002, at 07:50 AM, Andrew Bennetts wrote:

> This patch is from a friend of mine running OS X... this still doesn't 
> make
> the C extensions build, but at least it freaks out less.  It's a patch 
> to
> distutils.
>
> Apparently OS X doesn't have a <poll.h>, although Fink distributes 
> one, but
> that installs to a non-standard location.  Basically, it looks like OS 
> X
> support for the C modules will be messy.

http://www.clapper.org/software/poll/ is what I use.. I don't have fink 
installed anymore.

-bob




From twisted at moshez.org  Tue Oct  1 14:07:17 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 1 Oct 2002 18:07:17 -0000
Subject: [Twisted-Python] clientTCP
Message-ID: <20021001180717.7560.qmail@green.zadka.com>

The following files still use clientTCP, and shouldn't:

./doc/examples/ftpclient.py
./doc/examples/qtdemo.py
./twisted/im/ircsupport.py
./twisted/im/tocsupport.py
./twisted/mail/relaymanager.py
./twisted/names/dns.py
./twisted/protocols/irc.py
./twisted/protocols/oscar.py
./twisted/protocols/socks.py
./twisted/protocols/toc.py
./twisted/spread/ui/tkutil.py





From iko at cd.chalmers.se  Tue Oct  1 19:05:26 2002
From: iko at cd.chalmers.se (Anders Hammarquist)
Date: Wed, 02 Oct 2002 01:05:26 +0200
Subject: [Twisted-Python] Improvements to twisted.protocols.smtp 
In-Reply-To: Message from Moshe Zadka <m@moshez.org> 
   of "01 Oct 2002 09:02:27 -0000." <20021001090227.2568.qmail@green.zadka.com> 
References: <200209301501.g8UF1a9u001275@fido.strakt.com> <20021001090227.2568.qmail@green.zadka.com> 
Message-ID: <200210012305.BAA29435@haddock.cd.chalmers.se>

In a message of 01 Oct 2002 09:02:27 -0000, Moshe Zadka writes:
>> Index: twisted/protocols/smtp.py
>
>I have a general problem here: the REs are very complicated and undocumen
>ted.
>Please use re.X and comment the RE

Ok, they can probably be improved as well. I'll look over them some more.

>> -class User:
>> +class User(Address):
>
>I'd prefer containment rather than inclusion here.

Any particular reason? I don't feel strongly either way...

>> +            del self.__messages
>> +        self.sendCode(500, 'Line too long')
>
>this seems like it wouldn't work. the client would send the rest of the
>long line, which look like a beginning of a command

You're right, of course. Setting raw mode and reading until we see
a newline should fix it. I guess the fact that sendmail gets this
wrong too is no excuse ;-)

>> +        if not self.__helo:
>> +            self.sendCode(503,"Who are you? Say HELO first");
>
>be liberal, at least in the framework. if a user wants to allow
>nonusing of helo, he should be free to do this. you can enforce helo
>in validateFrom

Right

>> -        self.__init__()
>> +        self.__from = None
>> +        self.__to = []
>>          self.sendCode(250, 'I remember nothing.')
>what about __messages?

It's only valid inside a DATA command, so it's not around to be
reset.

I'll integrate your thoughts and send a new patch in a few days.

/Anders

-- 
 -- Of course I'm crazy, but that doesn't mean I'm wrong.
Anders Hammarquist                                  | iko at cd.chalmers.se
Physics student, Chalmers University of Technology, | Hem: +46 31 88 48 50
G|teborg, Sweden.           RADIO: SM6XMM and N2JGL | Mob: +46 707 27 86 87



From twisted at moshez.org  Tue Oct  1 22:31:41 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 2 Oct 2002 02:31:41 -0000
Subject: [Twisted-Python] tkutil
Message-ID: <20021002023141.11996.qmail@green.zadka.com>

moshez at darjeeling:~/prog/src/twisted/cvs/Twisted$ find . -name "*.py"|xargs grep tkutil|grep -v gtkutil
moshez at darjeeling:~/prog/src/twisted/cvs/Twisted$ grep clientTCP twisted/spread/ui/tkutil.py
        reactor.clientTCP(host, port, b)

To sum up: an unused file using a deprecated API.
Anyone mind if I remove it?




From twisted at moshez.org  Wed Oct  2 11:09:18 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 2 Oct 2002 15:09:18 -0000
Subject: [Twisted-Python] oscar.py uses deprecated APIs
Message-ID: <20021002150918.20025.qmail@green.zadka.com>

oscar.py uses the following depercated APIs:

* clientTCP
* connectionFailed

Please fix those ASAP 



From twisted at moshez.org  Wed Oct  2 11:13:47 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 2 Oct 2002 15:13:47 -0000
Subject: [Twisted-Python] More Deprecations
Message-ID: <20021002151347.20121.qmail@green.zadka.com>

connectionFailed is obsolete.

./doc/examples/ircLogBot.py
./twisted/im/basesupport.py
./twisted/protocols/ftp.py
./twisted/protocols/oscar.py
./twisted/protocols/socks.py
./twisted/spread/pb.py



From twisted at moshez.org  Wed Oct  2 13:10:46 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 2 Oct 2002 17:10:46 -0000
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
Message-ID: <20021002171046.21565.qmail@green.zadka.com>

Here is a tentative suggested time line for releasing 1.0:

1. Wait for all deprecations to be fixed
2. Release 0.99.3rc1
3. Assuming no problems for 48 hours, release 0.99.3 from the same
   code base except ChangeLog, README, twisted/copyright.py and
   doc/howto/installing-twisted.html. In the last 3 only the version
   number should change.
4. Assuming no problems for a week, release 1.0rc1 from the same
   code base with the same exceptions as above.
5. Assuming no problems for 48 hours, release 1.0 from the same
   code base, with same exceptions as above.

Please comment.



From coop at coopweb.org  Wed Oct  2 18:40:52 2002
From: coop at coopweb.org (Gavin Cooper)
Date: Wed, 2 Oct 2002 17:40:52 -0500
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
In-Reply-To: <20021002171046.21565.qmail@green.zadka.com>
References: <20021002171046.21565.qmail@green.zadka.com>
Message-ID: <20021002224052.GA19040@europa.tranquility.net>

On Wed, Oct 02, 2002 at 05:10:46PM -0000, Moshe Zadka wrote:
> Here is a tentative suggested time line for releasing 1.0:
> 
> 1. Wait for all deprecations to be fixed
> 2. Release 0.99.3rc1
> 3. Assuming no problems for 48 hours, release 0.99.3 from the same
>    code base except ChangeLog, README, twisted/copyright.py and
>    doc/howto/installing-twisted.html. In the last 3 only the version
>    number should change.
> 4. Assuming no problems for a week, release 1.0rc1 from the same
>    code base with the same exceptions as above.
> 5. Assuming no problems for 48 hours, release 1.0 from the same
>    code base, with same exceptions as above.

6. ???
7. Profit!

skreech / Gavin Cooper



From dstone at trinity.unimelb.edu.au  Wed Oct  2 21:38:14 2002
From: dstone at trinity.unimelb.edu.au (Daniel Stone)
Date: Thu, 3 Oct 2002 11:38:14 +1000
Subject: [Twisted-Python] WebDAV support
Message-ID: <20021003013814.GA19762@trinity.unimelb.edu.au>

Hi all,
I'm currently working on MoulDAVia, a kick-arse WebDAV server.
Basically, instead of offering a simple shared area (a la Apache's
mod_dav), it will be configurable so you can define a shared area for
one location, login-based for another (chroot()s to your homedir, drops
privileges, based on LDAP, but it could be something else), etc, etc.

I originally started doing this with Twisted, but hit an obstacle. I
can't remember what it was, and spiv wrote twisted.inetd seemingly out
of spite (hi Andrew! :), so I'm going to start trying with Twisted
again.

Cheers!
:) d

-- 
Daniel Stone                                     <dstone at trinity.unimelb.edu.au>
Developer, Trinity College, University of Melbourne



From twisted at itamarst.org  Wed Oct  2 22:15:42 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 2 Oct 2002 22:15:42 -0400
Subject: [Twisted-Python] HTTP changes
Message-ID: <20021002221542.23f46085.twisted@itamarst.org>

I updated http to use a new method of parsing POST requests. This might cause breakage, but was necessary, and gives more functionaly (see http.Request.getArg) and will prevent massive memory usage on large file uploads.

As a result, Request.args will not be a dict in certain cases (POST requests). It does its best to emulate one, though, but some code may still break because of the transition.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From acapnotic at twistedmatrix.com  Thu Oct  3 05:13:10 2002
From: acapnotic at twistedmatrix.com (Kevin Turner)
Date: 03 Oct 2002 02:13:10 -0700
Subject: [Twisted-Python] plugins.tml and distutils
Message-ID: <1033636393.8384.23.camel@troglodyte.funhouse>

Ok, so to get my package's plugins.tml installed correctly, I had to put
this in my setup.py::

    from distutils.command.install_data import install_data
    class install_data_twisted(install_data):
        """make sure data files are installed in package.
        this is evil.
        copied from Twisted/setup.py.
        """
        def finalize_options(self):
            self.set_undefined_options('install',
                ('install_lib', 'install_dir')
            )
            install_data.finalize_options(self)

and add this argument to my setup() call:

    cmdclass={'install_data': install_data_twisted}

In summary, to distribute a package using Twisted, I had to cut 'n paste
a hack from a Twisted source file (not one you'll find in an
installation) that fools with underdocumented distutils features which I
don't understand...  and now it's in my code, so I have to deal with it
if its evilness breaks something/is broken.

Not fully having got the swing of distutils yet, I don't really know
what to do about it.  Can we at least have this install_data defined in
twisted.screwwithotherpackages.distutils module or something, so I can
import it instead of pasting it, thus allowing Twisted to maintain it
instead of me?

(ohyeah.  that's in addition to putting plugins.tml in MANIFEST.in *and*
the data_files list.)

Regards,

 - Kevin

-- 
The moon is waning crescent, 16.1% illuminated, 25.6 days old.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021003/71baa2a2/attachment.pgp 

From radix at twistedmatrix.com  Thu Oct  3 06:21:38 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 3 Oct 2002 12:21:38 +0200
Subject: [Twisted-Python] WebDAV support
In-Reply-To: <20021003013814.GA19762@trinity.unimelb.edu.au>
References: <20021003013814.GA19762@trinity.unimelb.edu.au>
Message-ID: <20021003102138.GB5613@toshi>

On Thu, Oct 03, 2002 at 11:38:14AM +1000, Daniel Stone wrote:
> Hi all,
> I'm currently working on MoulDAVia, a kick-arse WebDAV server.
> Basically, instead of offering a simple shared area (a la Apache's
> mod_dav), it will be configurable so you can define a shared area for
> one location, login-based for another (chroot()s to your homedir, drops
> privileges, based on LDAP, but it could be something else), etc, etc.
> 
> I originally started doing this with Twisted, but hit an obstacle. I
> can't remember what it was, and spiv wrote twisted.inetd seemingly out
> of spite (hi Andrew! :), so I'm going to start trying with Twisted
> again.

I'm pretty interested in WebDAV support for Twisted as well -- I'd like
to eventually support it in TamTam. Where can we discuss its design, &c?

Why did you need inetd support to facilitate a WebDAV server, though?




From andrew-twisted at puzzling.org  Thu Oct  3 06:35:26 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 3 Oct 2002 20:35:26 +1000
Subject: [Twisted-Python] WebDAV support
In-Reply-To: <20021003102138.GB5613@toshi>
References: <20021003013814.GA19762@trinity.unimelb.edu.au> <20021003102138.GB5613@toshi>
Message-ID: <20021003103526.GA935@frobozz.local>

On Thu, Oct 03, 2002 at 12:21:38PM +0200, Christopher Armstrong wrote:
> On Thu, Oct 03, 2002 at 11:38:14AM +1000, Daniel Stone wrote:
> > 
> > I originally started doing this with Twisted, but hit an obstacle. I
> > can't remember what it was, and spiv wrote twisted.inetd seemingly out
> > of spite (hi Andrew! :), so I'm going to start trying with Twisted
> > again.
> 
> I'm pretty interested in WebDAV support for Twisted as well -- I'd like
> to eventually support it in TamTam. Where can we discuss its design, &c?
> 
> Why did you need inetd support to facilitate a WebDAV server, though?

He's forking processes and chroot/setuid/setgid'ing them, I think.  Hence
the example of inetd, which demonstrates passing a socket to a child
process.

-Andrew.




From bruce at cubik.org  Thu Oct  3 11:02:53 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Thu, 03 Oct 2002 09:02:53 -0600
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
References: <20021002171046.21565.qmail@green.zadka.com>
Message-ID: <3D9C5C1D.4020705@cubik.org>

Moshe Zadka wrote:
> Here is a tentative suggested time line for releasing 1.0:
> 
> 1. Wait for all deprecations to be fixed

Should this also include fixing the stuff in doc/examples so that each 
one either works or is removed?  (things like the regserver use older 
versions of the twisted.enterprise.row functionality and won't work today.)

  - Bruce




From radix at twistedmatrix.com  Thu Oct  3 11:54:03 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 3 Oct 2002 17:54:03 +0200
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
In-Reply-To: <3D9C5C1D.4020705@cubik.org>
References: <20021002171046.21565.qmail@green.zadka.com> <3D9C5C1D.4020705@cubik.org>
Message-ID: <20021003155403.GB6056@toshi>

On Thu, Oct 03, 2002 at 09:02:53AM -0600, Bruce Mitchener wrote:
> Moshe Zadka wrote:
> >Here is a tentative suggested time line for releasing 1.0:
> >
> >1. Wait for all deprecations to be fixed
> 
> Should this also include fixing the stuff in doc/examples so that each 
> one either works or is removed?  (things like the regserver use older 
> versions of the twisted.enterprise.row functionality and won't work today.)

Yeah, definitely.




From m at moshez.org  Thu Oct  3 11:42:13 2002
From: m at moshez.org (Moshe Zadka)
Date: 3 Oct 2002 15:42:13 -0000
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
In-Reply-To: <3D9C5C1D.4020705@cubik.org>
References: <3D9C5C1D.4020705@cubik.org>, <20021002171046.21565.qmail@green.zadka.com>
Message-ID: <20021003154213.3564.qmail@green.zadka.com>

On Thu, 03 Oct 2002, Bruce Mitchener <bruce at cubik.org> wrote:

> Moshe Zadka wrote:
> > Here is a tentative suggested time line for releasing 1.0:
> > 
> > 1. Wait for all deprecations to be fixed
> 
> Should this also include fixing the stuff in doc/examples so that each 
> one either works or is removed?  (things like the regserver use older 
> versions of the twisted.enterprise.row functionality and won't work today.)

Definitely. If you have a list of non-working examples, please send it
to the list.



From dstone at kde.org  Thu Oct  3 21:31:40 2002
From: dstone at kde.org (Daniel Stone)
Date: Fri, 4 Oct 2002 11:31:40 +1000
Subject: [Twisted-Python] WebDAV support
In-Reply-To: <20021003103526.GA935@frobozz.local>
References: <20021003013814.GA19762@trinity.unimelb.edu.au> <20021003102138.GB5613@toshi> <20021003103526.GA935@frobozz.local>
Message-ID: <20021004013140.GD6609@trinity.unimelb.edu.au>

On Thu, Oct 03, 2002 at 08:35:26PM +1000, Brother Andrew Bennetts preached da werd, yo:
> On Thu, Oct 03, 2002 at 12:21:38PM +0200, Christopher Armstrong wrote:
> > On Thu, Oct 03, 2002 at 11:38:14AM +1000, Daniel Stone wrote:
> > > I originally started doing this with Twisted, but hit an obstacle. I
> > > can't remember what it was, and spiv wrote twisted.inetd seemingly out
> > > of spite (hi Andrew! :), so I'm going to start trying with Twisted
> > > again.
> > 
> > I'm pretty interested in WebDAV support for Twisted as well -- I'd like
> > to eventually support it in TamTam. Where can we discuss its design, &c?
> > 
> > Why did you need inetd support to facilitate a WebDAV server, though?
> 
> He's forking processes and chroot/setuid/setgid'ing them, I think.  Hence
> the example of inetd, which demonstrates passing a socket to a child
> process.

Right. MoulDAVia is actually a project of Trinity, who wanted WebDAV
home directories. Most solutions (e.g. Apache mod_dav) only support the
paradigm (sorry) of a single shared area - one that the web server's
user could write to. We had two options:
a) give www-data rw access to all home directories (BAD)
b) make Apache run as root

Both of these required silly tricks with .htaccess, so we decided to
write our own. MoulDAVia will eventually support configurable zones -
e.g. /homes/ is for homes, /shared/ is shared, etc, etc. Right now,
however, it requires you to authenticate against LDAP, and chroot()s,
setgid()s and setuid()s. Obviously, all of these, paired with the
necessary fork(), are rather expensive options, so configurability is
needed.

Cheers!
:) d

-- 
Daniel Stone 	     <daniel at raging.dropbear.id.au>             <dstone at kde.org>
Developer - http://kopete.kde.org, http://www.kde.org



From twisted at moshez.org  Fri Oct  4 03:25:47 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 4 Oct 2002 07:25:47 -0000
Subject: [Twisted-Python] 0.99.3rc1 Released
Message-ID: <20021004072547.13087.qmail@green.zadka.com>

Unfortunately, TwistedDoc-0.99.3rc1.tar.gz is somewhat defective, but
everything else is working. Please let the list know of any problems
with this release. As usual, if there are no problems within 24 hours,
we will release it as 0.99.3

Acting Release Manager,
Moshe Zadka




From andrew-twisted at puzzling.org  Fri Oct  4 03:26:51 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 4 Oct 2002 17:26:51 +1000
Subject: [Twisted-Python] usage.Options
Message-ID: <20021004072651.GC25843@ritsuko.xware.cx>

I'm looking at warner's manhole doc at
    http://www.lothar.com/tech/twisted/manhole.xhtml
(which is excellent, btw)

This code snippet struck me as silly:
    # add manhole with username and password
    from twisted.tap.manhole import Options, updateApplication
    o = Options()
    o.parseOptions(["--user", "boss", "--password", "sekrit"])
    updateApplication(app, o)

I'm tempted to wonder if this would be better (if it were implemented in
usage.Options, of course...):
    # add manhole with username and password
    from twisted.tap.manhole import Options, updateApplication
    updateApplication(app, Options(user='boss', password='sekrit'))

i.e. let usage.Options' __init__ take a **kwargs, and have it pass that
to parseOptions.  It seems to me that constructing and configuring an
Options instance at the same time is a natural thing to do.

Does this sound like a good idea?

-Andrew.




From m at moshez.org  Fri Oct  4 04:08:59 2002
From: m at moshez.org (Moshe Zadka)
Date: 4 Oct 2002 08:08:59 -0000
Subject: [Twisted-Python] usage.Options
In-Reply-To: <20021004072651.GC25843@ritsuko.xware.cx>
References: <20021004072651.GC25843@ritsuko.xware.cx>
Message-ID: <20021004080859.13338.qmail@green.zadka.com>

On Fri, 4 Oct 2002, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

>     o.parseOptions(["--user", "boss", "--password", "sekrit"])
...
>     updateApplication(app, Options(user='boss', password='sekrit'))

What if he wanted to use some yes/no option?

> i.e. let usage.Options' __init__ take a **kwargs, and have it pass that
> to parseOptions.  It seems to me that constructing and configuring an
> Options instance at the same time is a natural thing to do.
> 
> Does this sound like a good idea?

Personally, I don't like it.



From glyph at twistedmatrix.com  Fri Oct  4 06:00:18 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 04 Oct 2002 05:00:18 -0500 (CDT)
Subject: [Twisted-Python] usage.Options
In-Reply-To: <20021004072651.GC25843@ritsuko.xware.cx>
References: <20021004072651.GC25843@ritsuko.xware.cx>
Message-ID: <20021004.050018.112272996.glyph@twistedmatrix.com>

On Fri, 4 Oct 2002 17:26:51 +1000, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> let usage.Options' __init__ take a **kwargs, and have it pass that
> to parseOptions.  It seems to me that constructing and configuring an
> Options instance at the same time is a natural thing to do.
> 
> Does this sound like a good idea?

Some convenience mechanism might, but this one's broken.  If you want to come
up with one, remember that:

    * order matters (opt_ methods may require being run in order)
    * you can pass sub-commands
    * there are boolean options as well as keyword args
    * it would probably be nice to be able to use single-letter options too

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021004/f264c734/attachment.pgp 

From twisted at moshez.org  Fri Oct  4 08:24:28 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 4 Oct 2002 12:24:28 -0000
Subject: [Twisted-Python] usage.Options
In-Reply-To: <20021004.050018.112272996.glyph@twistedmatrix.com>
References: <20021004.050018.112272996.glyph@twistedmatrix.com>, <20021004072651.GC25843@ritsuko.xware.cx>
Message-ID: <20021004122428.15976.qmail@green.zadka.com>

On Fri, 04 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> Some convenience mechanism might, but this one's broken.  If you want to come
> up with one, remember that:
> 
>     * order matters (opt_ methods may require being run in order)
>     * you can pass sub-commands
>     * there are boolean options as well as keyword args
>     * it would probably be nice to be able to use single-letter options too

The only convenience mechanism I can imagine which would actually satisfy
all your criteria is a function which takes *args:

.updateOptionsArgs("--foo", "bar", "-r", "baz")
....
which is just a tiny bit better than to have to wrap it with [] as
warner was doing.



From typo at soniq.net  Fri Oct  4 10:28:35 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 16:28:35 +0200
Subject: [Twisted-Python] templatepath patch
Message-ID: <20021004142835.GA14324@soniq.net>

compiled templates shouldn't be dumped into cwd:

diff -u -r1.14 template.py
--- template.py 4 Oct 2002 11:38:57 -0000       1.14
+++ template.py 4 Oct 2002 14:27:28 -0000
@@ -245,7 +245,7 @@
         os.stat(compiledTemplatePath)[stat.ST_MTIME] < os.stat(templatePath)[stat.ST_MTIME]):
             compiledTemplate = minidom.parse(templatePath)
             from cPickle import dump
-            dump(compiledTemplate, open(compiledTemplateName, 'wb'), 1)
+            dump(compiledTemplate, open(compiledTemplatePath, 'wb'), 1)
 #            parent = templateRef.parentRef().getObject()
 #            parent.savePickleChild(compiledTemplateName, compiledTemplate)
         else:




From bruce at cubik.org  Fri Oct  4 11:25:39 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Fri, 04 Oct 2002 09:25:39 -0600
Subject: [Twisted-Python] templatepath patch
References: <20021004142835.GA14324@soniq.net>
Message-ID: <3D9DB2F3.8090001@cubik.org>

Paul Boehm wrote:
> compiled templates shouldn't be dumped into cwd:

Thanks!

I've checked this in, modified slightly to also correct the commented 
out code.

  - Bruce




From typo at soniq.net  Fri Oct  4 12:16:23 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 18:16:23 +0200
Subject: [Twisted-Python] twisted.web
Message-ID: <20021004161623.GA11237@soniq.net>

squished another bug:

adding a ? to any url ending with /, ended in a redirect to
//, on repetition to ///, and so on.

can anyone verify this doesn't break anything?

diff -u -r1.63 static.py
--- static.py   1 Oct 2002 17:28:46 -0000       1.63
+++ static.py   4 Oct 2002 16:15:32 -0000
@@ -59,10 +59,16 @@
         return self.data

 def addSlash(request):
-    return "http%s://%s%s/" % (
+    #log.msg("request.uri: %s", request.uri)
+    host = request.getHeader("host")
+    path = string.split(request.uri,'?')[0]
+    slashfree_path = string.split(path,'/')[1]
+
+    return "http%s://%s/%s" % (
         request.isSecure() and 's' or '',
-        request.getHeader("host"),
-        (string.split(request.uri,'?')[0]))
+        host,
+        slashfree_path
+    )

 def redirectTo(URL, request):
     request.redirect(URL)




From typo at soniq.net  Fri Oct  4 12:21:23 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 18:21:23 +0200
Subject: [Twisted-Python] twisted.web
In-Reply-To: <20021004161623.GA11237@soniq.net>
References: <20021004161623.GA11237@soniq.net>
Message-ID: <20021004162123.GA26033@soniq.net>

ah, and another problem with that redirect might
occur with woven Controller based index.rpy. 
i'm not sure how to fix that.

> +    #log.msg("request.uri: %s", request.uri)
forgot this line.



From typo at soniq.net  Fri Oct  4 12:52:57 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 18:52:57 +0200
Subject: [Twisted-Python] woven.widgets
Message-ID: <20021004165257.GA9936@soniq.net>

CheckBox can now be checked by truth in the model

and: is there a reason not to set self['value'] if
self.getData() returns a value that isn't true?

diff -u -r1.20 widgets.py
--- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
+++ widgets.py  4 Oct 2002 16:52:50 -0000
@@ -388,13 +388,17 @@

     def generateDOM(self, request, node):
         mVal = self.getData()
-        if mVal:
-            self['value'] = str(mVal)
+        self['value'] = str(mVal)
         return Widget.generateDOM(self, request, node)

 class CheckBox(Input):
     def initialize(self):
         self['type'] = 'checkbox'
+    def generateDOM(self, request, node):
+        node = Input.generateDOM(self, request, node)
+        if self.getData():
+            node.setAttribute('checked', "checked")
+        return node

 class RadioButton(Input):
     def initialize(self):




From typo at soniq.net  Fri Oct  4 12:58:20 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 18:58:20 +0200
Subject: [Twisted-Python] twisted.web
In-Reply-To: <20021004162123.GA26033@soniq.net>
References: <20021004161623.GA11237@soniq.net> <20021004162123.GA26033@soniq.net>
Message-ID: <20021004165820.GB9936@soniq.net>

On Fri, Oct 04, 2002 at 06:21:23PM +0200, Paul Boehm wrote:
> ah, and another problem with that redirect might
> occur with woven Controller based index.rpy. 
> i'm not sure how to fix that.

forget my last patch, this should work:

diff -u -r1.63 static.py
--- static.py   1 Oct 2002 17:28:46 -0000       1.63
+++ static.py   4 Oct 2002 16:58:34 -0000
@@ -253,10 +253,12 @@
             # If someone is looking for children with a PathReferenceContext,
             # the request won't have a prepath, and we shouldn't do this kind
             # of mangling anyway because it has already been done.
-            if hasattr(request, 'postpath') and not request.postpath and request.uri[-1] != '/':
+            if hasattr(request, 'postpath') and not request.postpath and \
+                        string.split(request.uri,'?')[0][-1] != '/':
                 return Redirect(request)
             if os.path.exists(childPath):
-                if hasattr(request, 'postpath') and not request.postpath and not self.getIndex(request):
+                if hasattr(request, 'postpath') and not request.postpath and \
+                                                not self.getIndex(request):
                     return widgets.WidgetPage(DirectoryListing(self.path))




From dp at twistedmatrix.com  Fri Oct  4 14:28:15 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 4 Oct 2002 11:28:15 -0700
Subject: [Twisted-Python] woven.widgets
In-Reply-To: <20021004165257.GA9936@soniq.net>
Message-ID: <0BCC27E6-D7C7-11D6-B511-00039376B1AE@twistedmatrix.com>

I think you may be able to set checked="1" or checked="0" instead of 
checked="checked"; I'm not sure though.

Also, I can't think of a reason why it wasn't setting self['value'] if 
self.getData() was not true.

Donovan

On Friday, October 4, 2002, at 09:52 AM, Paul Boehm wrote:

> CheckBox can now be checked by truth in the model
>
> and: is there a reason not to set self['value'] if
> self.getData() returns a value that isn't true?
>
> diff -u -r1.20 widgets.py
> --- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
> +++ widgets.py  4 Oct 2002 16:52:50 -0000
> @@ -388,13 +388,17 @@
>
>      def generateDOM(self, request, node):
>          mVal = self.getData()
> -        if mVal:
> -            self['value'] = str(mVal)
> +        self['value'] = str(mVal)
>          return Widget.generateDOM(self, request, node)
>
>  class CheckBox(Input):
>      def initialize(self):
>          self['type'] = 'checkbox'
> +    def generateDOM(self, request, node):
> +        node = Input.generateDOM(self, request, node)
> +        if self.getData():
> +            node.setAttribute('checked', "checked")
> +        return node
>
>  class RadioButton(Input):
>      def initialize(self):
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From typo at soniq.net  Fri Oct  4 14:28:49 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 20:28:49 +0200
Subject: [Twisted-Python] woven.widgets
In-Reply-To: <0BCC27E6-D7C7-11D6-B511-00039376B1AE@twistedmatrix.com>
References: <20021004165257.GA9936@soniq.net> <0BCC27E6-D7C7-11D6-B511-00039376B1AE@twistedmatrix.com>
Message-ID: <20021004182849.GA1564@soniq.net>

On Fri, Oct 04, 2002 at 11:28:15AM -0700, Donovan Preston wrote:
> I think you may be able to set checked="1" or checked="0" instead of 
> checked="checked"; I'm not sure though.

in the german selfhtml guide 'checked="checked"' was suggested as xhtml
conformant variant for the attributeless 'checked' html variant.

not sure either..



From sean at ninjaneering.com  Fri Oct  4 14:49:23 2002
From: sean at ninjaneering.com (Sean Riley)
Date: Fri, 4 Oct 2002 13:49:23 -0500
Subject: [Twisted-Python] containership for row objects and networked observation
Message-ID: <PGEKIMFOMBFCPBEILDBLEEAHCBAA.sean@ninjaneering.com>

ramblings about formalizing containment for rowObjects and networked
observation...  this paraphases some of my existing application code that
seems like it could be generalized.

if we know that childRow has a relationship to parentRow where
childRow.parent_id is an p_id of a parentRow, when a child is added to
parent with:

parentRow.addToContainer(childRow)

this could autmatically set the parent_id of the childRow to the p_id of the
parentRow and add the child to a list of children for the parent. This would
make the childRow dirty so that it will be updated to the database.

this assumes that RowObjects have a childRows list to add children to.

should this be part of Enterprise Row Objects, or some other part of
twisted? does it belong in twisted at all? imagine this with error
checking...


class Container:
	def __init__(self):
		self.container = []

	def addToContainer(self, obj):
		"""add an object to the container
		"""
		self.container.append(obj)

	def removeFromContainer(self, obj):
		"""remove an object from the container
		"""
		self.container.remove(obj)

	def getContainedOfType(self, classType):
		"""returns all contained objects of the specified type
		"""
		out = []
		for item in self.container:
		if isinstance(item, classType) or
			issubclass(item.__class__, classType):
			out.append(item)
		return out

I have a containment system that is similar to this but adds observation of
containership:

class ObservableContainer(Container):
	def __init__(self):
		Container.__init__(self)
		self.observers = []

	def addToContainer(self, obj):
		"""add an object to the container
		"""
		Container.addToContainer(self, obj)
		for o in self.observers:
			o.callRemote('addToContainer', obj)

	def removeFromContainer(self, obj):
		"""remove an object from the container
		"""
		Container.removeFromContainer(self, obj)
		for o in self.observers:
			o.callRemote('removeFromContainer', obj)

	def observe_addToContainer(self, obj):
		self.addToContainer(obj)

	def observe_removeFromContainer(self, obj):
		self.removeFromContainer(obj)


Then... making RowObjects observableContainers:

class RowObject(ObservableContainer):

	def addToContainer(self, row):
		"""assumes a rowObject is being added...
		"""
		## TODO: set the foreign key columns on
		##       the row being added
		ObservableContainer.addToContainer(row)

this is a powerful combination of observation and containment. it can be
extended with client side UI objects that are observers of the client-side
rowObjects so that changes can be propogated automatically across the
network and into the UI.

class ClientObject(ObservableContainer):
	def addToContainer(self, obj):
 		for o in self.observers:
			## Dirty UI observers
		Container.addToContiner(self, obj)

	def removeFromContainer(self, obj):
		for o in self.observers:
			## Dirty UI observers
		Container.removeFromContainer(self, obj)


so... when a child row is added to a parent row object on the server, the
observing client object is notified, and the observing UI element is dirtied
so that the UI can be redrawn with the new object being visible.
additionaly, the child row object has it's foreign key attributes updated
automatically and is ready to be updated to the database.

if you add the capability for RowObject derived classes to be pb.Cacheables
as well, changes other than containment then use a very similar mechanism:

class MyRoomClass(RowObject, pb.Cachable):

	def setColor(self, color):
		self.color = color
		for o in self.observers:
			o.callRemote("setColor", color)

class RemoteRoom(ClientObject):
	def observe_setColor(self, color):
		self.color = color
		for o in self.observers:
			### dirty UI observers

this starts become to a generalized application framework that could be
applied to many types of applications.. chat servers that contain chat
groups that contain chat members, virtual worlds with world areas that
contain buildings that contain chests that contain items...


i guess the question is.. is this type containment/observation type
functionality general enough (and useful enough) to be part of twisted?




From acapnotic at twistedmatrix.com  Fri Oct  4 19:15:03 2002
From: acapnotic at twistedmatrix.com (Kevin Turner)
Date: 04 Oct 2002 16:15:03 -0700
Subject: [Twisted-Python] ANN: CVSToys 0.9.6.
Message-ID: <1033773306.8384.51.camel@troglodyte.funhouse>

It's another release of everybody's favourite CVS accessory, CVSToys. 
Since the last time I announced to this list, I've added several more
files that were missing from earlier distributions, added a repository
installation tool called "freshcvs-setup", and traded in the
Linux-specific /proc-watching hacks I was using for some more portable
hacks I found in David Hampton's commit_prep script.  In addition to
Linux, this release has been tested on Darwin and FreeBSD.

For the download, links to CVSToys in action, and more information, see
the CVSToys home page:

http://twistedmatrix.com/users/acapnotic/wares/code/CVSToys/

Upgrade Note:

Those of you using earlier versions will have to add a line to
CVSROOT/commitinfo when you upgrade:
ALL loginfo --commitinfo

Share and Enjoy,

 - Kevin
(Acapnotic)

-- 
The moon is waning crescent, 4.9% illuminated, 27.4 days old.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021004/eb4a40c4/attachment.pgp 

From warner at lothar.com  Sat Oct  5 03:18:05 2002
From: warner at lothar.com (Brian Warner)
Date: Sat, 05 Oct 2002 00:18:05 -0700 (PDT)
Subject: [Twisted-Python] usage.Options
References: <20021004072651.GC25843@ritsuko.xware.cx>
Message-ID: <20021005.001805.57985419.warner@lothar.com>

> I'm looking at warner's manhole doc at
>     http://www.lothar.com/tech/twisted/manhole.xhtml
> (which is excellent, btw)

<blushes>. thanks. Check out the other docs-in-progress at
http://www.lothar.com/tech/twisted/ too, let me know what you think.

> I'm tempted to wonder if this would be better (if it were implemented in
> usage.Options, of course...):
>     # add manhole with username and password
>     from twisted.tap.manhole import Options, updateApplication
>     updateApplication(app, Options(user='boss', password='sekrit'))

I'm also not sure if this is a sufficiently common need to make shorter..
most of the time the Options come from sys.argv, after all. What I would find
handy, however, would be something to specifically make it easier to add a
manhole service into an application. Something that a beginner could use
without understanding anything further about PB. Something, say, like this:

Index: twisted/manhole/service.py
===================================================================
RCS file: /cvs/Twisted/twisted/manhole/service.py,v
retrieving revision 1.31
diff -u -r1.31 service.py
--- twisted/manhole/service.py	1 Sep 2002 09:07:11 -0000	1.31
+++ twisted/manhole/service.py	5 Oct 2002 07:05:33 -0000
@@ -344,3 +344,17 @@
                                             getattr(self.application,
                                                     'name', "???"))
         return s
+
+
+def addManhole(app, username, password, portno=None):
+    """Convenience method to add manhole service to an existing app. Returns
+    the manhole Service so you can get at its .namespace attribute."""
+    from twisted.cred import authorizer
+    auth = authorizer.DefaultAuthorizer(app)
+    svc = Service("twisted.manhole", serviceParent=app, authorizer=auth)
+    p = svc.createPerspective(username)
+    p.makeIdentity(password)
+    if portno == None:
+        portno = pb.portno
+    app.listenTCP(portno, pb.BrokerFactory(pb.AuthRoot(auth)))
+    return svc


That would allow the user to add a manhole service with a nice, clean
two-line addition (as opposed to my mean, ugly 4-line addition):

 from twisted.manhole.service import addManhole
 addManhole(app, "boss", "sekrit")

And then you can pre-fill the namespace with useful variables (like
theApplication, or your Services) like this:

 from twisted.manhole.service import addManhole
 n = addManhole(app, "boss", "sekrit").namespace
 n['app'] = app
 n['svc'] = my_svc
 n['help'] = " app: theApplication\n svc: my_svc\n"


One shortcoming of my patch is that the auth will probably steal pb.portno
from any existing PB services. If there are already PB services listening on
that port, the code should probably raise an exception and tell the user to
make it listen on a different one (rather than silently insert it's user/pass
into the user's Authorizer). I don't know how to check for that.. any ideas?

thanks,
 -Brian




From acapnotic at twistedmatrix.com  Sat Oct  5 07:31:37 2002
From: acapnotic at twistedmatrix.com (Kevin Turner)
Date: 05 Oct 2002 04:31:37 -0700
Subject: [Twisted-Python] usage.Options
In-Reply-To: <20021005.001805.57985419.warner@lothar.com>
References: <20021004072651.GC25843@ritsuko.xware.cx> 
	<20021005.001805.57985419.warner@lothar.com>
Message-ID: <1033817498.8380.84.camel@troglodyte.funhouse>

On Sat, 2002-10-05 at 00:18, Brian Warner wrote:
> One shortcoming of my patch is that the auth will probably steal pb.portno
> from any existing PB services. If there are already PB services listening on
> that port, the code should probably raise an exception and tell the user to
> make it listen on a different one (rather than silently insert it's user/pass
> into the user's Authorizer). I don't know how to check for that.. any ideas?

I had code very much like this in mktap once, to allow building in a
manhole to any .tap upon creation.  It did some check so that if a PB
server was already running, it would go ahead and add the manhole
service to that instead of trying to open a port.  Adding a user/pass to
the existing authorizer (which it did) may not be such a bad idea as you
seem to suggest, since you only give that new identity a key for the
"twisted.manhole" service and not the other(s).   (...but authorizers
are now per-Service, not per-ServiceCollection, so you can still have
your separate one if you wish, even if you put them on one port under
the same broker factory.)

However, that code was blown away sometime when I wasn't looking and I
was later urged to use "mktap --append foo.tap manhole" instead, which
still has the same port-clobbering problem as you ran in to.

Back to the question that started this thread, I do agree with you that
adding an "addManhole" interface is a much more reasonable thing to do
than changing the usage.Options interface.  I understand what you said
about the "from twisted.tap.manhole import Options, updateapplication"
being a quick and convenient solution, but it should be recognized that
it's a somewhat abusive hack.  Modules in the 'tap' package are for use
with mktap, and "usage" is a command-line processing utility, not a more
comprehensive configuration tool such as coil might be.

I hope that didn't sound unforgivably grouchy -- I'm up past my bedtime
and am due for a nap.

g'night,

 - kevin

-- 
The moon is waning crescent, 2.6% illuminated, 28.0 days old.





From typo at soniq.net  Sat Oct  5 08:48:22 2002
From: typo at soniq.net (Paul Boehm)
Date: Sat, 5 Oct 2002 14:48:22 +0200
Subject: [Twisted-Python] tap security problem
Message-ID: <20021005124822.GA5322@soniq.net>

tap uid/gid data allows privilege separation.

As uid/gid are part of the Application, a compromised application can write
a shutdown.tap with different uid/gids. in a typical setting the new
shutdown.tap will be read on the next startup, to enjoy persistence.

i think the seperation between config options that are handled by mktap,
and those handled by twistd needs to be refined.

  paul



From glyph at twistedmatrix.com  Sat Oct  5 14:53:05 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 05 Oct 2002 13:53:05 -0500 (CDT)
Subject: [Twisted-Python] tap security problem
In-Reply-To: <20021005124822.GA5322@soniq.net>
References: <20021005124822.GA5322@soniq.net>
Message-ID: <20021005.135305.55498724.glyph@twistedmatrix.com>


On Sat, 5 Oct 2002 14:48:22 +0200, Paul Boehm <typo at soniq.net> wrote:
> As uid/gid are part of the Application, a compromised application can write
> a shutdown.tap with different uid/gids.

Why, in a security-conscious environment, are you allowing the uid/gid that the
server is running as to even _read_ the .tap?  In any event, the .tap is
effectively an SUID binary, and should be writable only by root.

The whole notion of this automatic persistence is somewhat at odds with that of
security - .tap persistence is very explicitly designed to have no security
constraints whatsoever, but to be very convenient.  If you need both
persistence and security, then you have to design your persistence mechanism to
constrain what can be persisted.  Pickle effectively allows literal code to be
stored and executed.


-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021005/b441f6d6/attachment.pgp 

From warner at lothar.com  Sat Oct  5 17:36:20 2002
From: warner at lothar.com (Brian Warner)
Date: 05 Oct 2002 14:36:20 -0700
Subject: [Twisted-Python] usage.Options
In-Reply-To: <1033817498.8380.84.camel@troglodyte.funhouse>
References: <20021004072651.GC25843@ritsuko.xware.cx>
	<20021005.001805.57985419.warner@lothar.com>
	<1033817498.8380.84.camel@troglodyte.funhouse>
Message-ID: <877kgw8t63.fsf@luther.lothar.com>

> Adding a user/pass to the existing authorizer (which it did) may not be
> such a bad idea as you seem to suggest, since you only give that new
> identity a key for the "twisted.manhole" service and not the other(s).
> (...but authorizers are now per-Service, not per-ServiceCollection, so you
> can still have your separate one if you wish, even if you put them on one
> port under the same broker factory.)

Good point. I was worried about interaction with a user's custom Authorizer
subclass (which might do some funky db or ldap thing). But adding an auth for
just the manhole service would avoid that cleanly.

> it's a somewhat abusive hack.  Modules in the 'tap' package are for use
> with mktap, and "usage" is a command-line processing utility, not a more
> comprehensive configuration tool such as coil might be.

I agree completely. Manhole is such a great debugging aid (and a great
learning tool, as the beginning developer is trying to match up what they see
in the source code with the internal behavior of a live app) that I wanted a
simple non-confusing way to add one. So I think that addManhole might be a
reasonable addition.

I'll see if I can make a version that checks for an existing factory and adds
to it if necessary. That probably means addManhole() has to be the last one
added (because other services won't do the same thing), but that's easy
enough to add to the docs.

thanks,
 -Brian



From radix at twistedmatrix.com  Sat Oct  5 17:59:22 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 5 Oct 2002 23:59:22 +0200
Subject: [Twisted-Python] usage.Options
In-Reply-To: <877kgw8t63.fsf@luther.lothar.com>
References: <20021004072651.GC25843@ritsuko.xware.cx> <20021005.001805.57985419.warner@lothar.com> <1033817498.8380.84.camel@troglodyte.funhouse> <877kgw8t63.fsf@luther.lothar.com>
Message-ID: <20021005215921.GA466@toshi>

On Sat, Oct 05, 2002 at 02:36:20PM -0700, Brian Warner wrote:
> I agree completely. Manhole is such a great debugging aid (and a great
> learning tool, as the beginning developer is trying to match up what they see
> in the source code with the internal behavior of a live app) that I wanted a
> simple non-confusing way to add one. So I think that addManhole might be a
> reasonable addition.

Well, it should probably be generalized to an "add a new PB service to an
existing Application on a specified port with or without creating a
new Authorizer" function.




From itamar at itamarst.org  Sun Oct  6 13:51:32 2002
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 6 Oct 2002 13:51:32 -0400
Subject: [Twisted-Python] ANN: Twisted 0.99.3 - release candidate for Twisted 1.0 Developer Platform
Message-ID: <20021006135132.58377c00.itamar@itamarst.org>

The Twisted team is proud to announce Twisted 0.99.3, our release candidate for Twisted 1.0 Developer Platform.

For more information, visit http://www.twistedmatrix.com, join the list at
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python or visit us on #twisted at irc.freenode.net (also known as irc.openprojects.net).


What is Twisted?
================

Twisted is an event-based framework for internet applications.  It includes a
web server, a telnet server, a chat server, a news server, a generic client 
and server for remote object access, and APIs for creating new protocols and
services. Twisted supports integration of the Tk, GTK+, Qt or wxPython event
loop with its main event loop. The Win32 event loop is also supported, as is
basic support for running servers on top of Jython. Twisted works with
Python 2.1 and Python 2.2. Twisted even supports the CVS versions of Python, 
so it is ready for Python 2.3.

Twisted currently supports the following protocols, all implemented in pure
python, most of them as both servers and clients:
 
  - SSH
  - FTP
  - HTTP
  - NNTP
  - SOCKSv4 (server only)
  - SMTP
  - IRC
  - telnet
  - POP3
  - AOL's instant messaging TOC
  - OSCAR, used by AOL-IM as well as ICQ (client only)
  - DNS
  - MouseMan
  - finger
  - Echo, discard, chargen and friends
  - Twisted Perspective Broker, a remote object protocol
  - XML-RPC
 

What's new in 0.99.3
====================

- More fixes for HTTP

- Continued work on Woven web framework

- Got rid of remaining uses of deprecated APIs




From acapnotic at twistedmatrix.com  Mon Oct  7 01:30:55 2002
From: acapnotic at twistedmatrix.com (Kevin Turner)
Date: 06 Oct 2002 22:30:55 -0700
Subject: [Twisted-Python] pb.AuthServ and cred.service incongruity
Message-ID: <1033968656.888.37.camel@troglodyte.funhouse>

So there is a reason this authorizer-per-service thing has felt funny,
maybe why I felt like there was a pb.MultiService-for-AuthRoot piece
missing.  A conversation I had with Brian ran into this problem:

The short version:
construct pb.AuthRoot with Authorizer

that authorizer is used by pb.AuthRoot/pb.AuthServ to request
Identities.  pb.AuthChallenger/pb.IdentityWrapper obtain a Perspective
for a Service from that identity.

Perspective.getIdentityRequest uses the authorizer of the service
associated with that perspective.  Nothing in the framework encourages
the service authorizer to be the same as the AuthRoot authorizer.  So it
looks like perspective.getIdentityRequest could very possibly return an
identity out of a different authorizer than the one you logged in with. 
And a Service's authorizer attribute may have nothing at all with how
you obtain a perspective to that service.

 ?

-- 
The moon is new, 0.3% illuminated, 0.5 days old.





From iko at strakt.com  Mon Oct  7 09:18:27 2002
From: iko at strakt.com (Anders Hammarquist)
Date: Mon, 07 Oct 2002 15:18:27 +0200
Subject: [Twisted-Python] SMTP patch take 2
Message-ID: <200210071318.g97DIRG3001254@fido.strakt.com>

Hello,

Here is the promised revised SMTP patch. This adds a unit test for the
change in LineReceiver (the test can probably be improved upon, since
lineLengthExceeded is more of an exception), and a test to make sure
the '.' to finish mail data is on it's own line in SMTPClient. Plus
misc. cleanups. Comments are welcome as always.

/Anders

-------------- next part --------------
Index: twisted/protocols/basic.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/basic.py,v
retrieving revision 1.24
diff -u -u -r1.24 basic.py
--- twisted/protocols/basic.py	1 Oct 2002 15:09:25 -0000	1.24
+++ twisted/protocols/basic.py	7 Oct 2002 13:04:01 -0000
@@ -153,12 +153,15 @@
                 line, self.__buffer = self.__buffer.split(self.delimiter, 1)
             except ValueError:
                 if len(self.__buffer) > self.MAX_LENGTH:
-                    self.transport.loseConnection()
+                    line, self.__buffer = self.__buffer, ''
+                    self.lineLengthExceeded(line)
                     return
                 break
             else:
-                if len(line) > self.MAX_LENGTH:
-                    self.transport.loseConnection()
+                linelength = len(line)
+                if linelength > self.MAX_LENGTH:
+                    line, self.__buffer = self.__buffer, ''
+                    self.lineLengthExceeded(line)
                     return
                 self.lineReceived(line)
                 if self.transport.disconnecting:
@@ -200,6 +203,12 @@
         """Sends a line to the other end of the connection.
         """
         self.transport.write(line + self.delimiter)
+
+    def lineLengthExceeded(self, line):
+        """Called when the maximum line length has been reached.
+        Override if it needs to be dealt with in some special way.
+        """
+        self.transport.loseConnection()
 
 
 class Int32StringReceiver(protocol.Protocol):
Index: twisted/protocols/smtp.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/smtp.py,v
retrieving revision 1.24
diff -u -u -r1.24 smtp.py
--- twisted/protocols/smtp.py	2 Oct 2002 12:38:24 -0000	1.24
+++ twisted/protocols/smtp.py	7 Oct 2002 13:04:01 -0000
@@ -18,10 +18,10 @@
 """
 
 from twisted.protocols import basic
-from twisted.internet import protocol, defer
+from twisted.internet import protocol, defer, reactor
 from twisted.python import log
 
-import os, time, string, operator
+import os, time, string, operator, re
 
 class SMTPError(Exception):
     pass
@@ -49,20 +49,104 @@
         self.deferred.errback(arg)
         self.done = 1
 
+class AddressError(SMTPError):
+    "Parse error in address"
+    pass
+
+# Character classes for parsing addresses
+atom = r"-A-Za-z0-9!#$%&'*+/=?^_`{|}~"
+
+class Address:
+    """Parse and hold an RFC 2821 address.
+
+    Source routes are stipped and ignored, UUCP-style bang-paths
+    and %-style routing are not parsed.
+    """
+
+    tstring = re.compile(r'''( # A string of
+                          (?:"[^"]*" # quoted string
+			  |\\.i # backslash-escaped characted
+			  |[''' + string.replace(atom,'#',r'\#')
+                          + r'''] # atom character
+			  )+|.) # or any single character''',re.X)
+
+    def __init__(self, addr):
+        self.local = ''
+        self.domain = ''
+        self.addrstr = addr
+
+        # Tokenize
+        atl = filter(None,self.tstring.split(addr))
+
+        print atl
+
+        local = []
+        domain = []
+
+        while atl:
+            if atl[0] == '<':
+                if atl[-1] != '>':
+                    raise AddressError, "Unbalanced <>"
+                atl = atl[1:-1]
+            elif atl[0] == '@':
+                atl = atl[1:]
+                if not local:
+                    # Source route
+                    while atl and atl[0] != ':':
+                        # remove it
+                        atl = atl[1:]
+                    if not atl:
+                        raise AddressError, "Malformed source route"
+                    atl = atl[1:] # remove :
+                elif domain:
+                    raise AddressError, "Too many @"
+                else:
+                    # Now in domain
+                    domain = ['']
+            elif len(atl[0]) == 1 and atl[0] not in atom + '.':
+                raise AddressError, "Parse error at " + atl[0]
+            else:
+                if not domain:
+                    local.append(atl[0])
+                else:
+                    domain.append(atl[0])
+                atl = atl[1:]
+               
+        self.local = ''.join(local)
+        self.domain = ''.join(domain)
+
+    dequotebs = re.compile(r'\\(.)')
+    def dequote(self, addr):
+        "Remove RFC-2821 quotes from address"
+        res = []
+
+        atl = filter(None,self.tstring.split(addr))
+
+        for t in atl:
+            if t[0] == '"' and t[-1] == '"':
+                res.append(t[1:-1])
+            elif '\\' in t:
+                res.append(self.dequotebs.sub(r'\1',t))
+            else:
+                res.append(t)
+
+        return ''.join(res)
+
+    def __str__(self):
+        return '%s%s' % (self.local, self.domain and ("@" + self.domain) or "")
+
+    def __repr__(self):
+        return "%s.%s(%s)" % (self.__module__, self.__class__.__name__,
+                              repr(str(self)))
 
 class User:
 
     def __init__(self, destination, helo, protocol, orig):
-        try:
-            self.name, self.domain = string.split(destination, '@', 1)
-        except ValueError:
-            self.name = destination
-            self.domain = ''
+        self.dest = Address(destination)
         self.helo = helo
         self.protocol = protocol
         self.orig = orig
 
-
 class IMessage:
 
     def lineReceived(self, line):
@@ -83,23 +167,40 @@
 
 class SMTP(basic.LineReceiver):
 
-    def __init__(self):
+    def __init__(self, domain, timeout=600):
         self.mode = COMMAND
         self.__from = None
         self.__helo = None
-        self.__to = ()
+        self.__to = []
+        self.timeout = timeout
+        self.host = domain
+
+    def timedout(self):
+        self.sendCode(421, '%s Timeout. Try talking faster next time!' %
+                      self.host)
+        self.transport.loseConnection()
 
     def connectionMade(self):
-        self.sendCode(220, 'Spammers beware, your ass is on fire')
+        self.sendCode(220, '%s Spammers beware, your ass is on fire' %
+                      self.host)
+        if self.timeout:
+            self.timeoutID = reactor.callLater(self.timeout, self.timedout)
 
     def sendCode(self, code, message=''):
         "Send an SMTP code with a message."
         self.transport.write('%d %s\r\n' % (code, message))
 
     def lineReceived(self, line):
+        if self.timeout:
+            self.timeoutID.cancel()
+            self.timeoutID = reactor.callLater(self.timeout, self.timedout)
+
         if self.mode is DATA:
             return self.dataLineReceived(line)
-        command = string.split(line, None, 1)[0]
+        if line:
+            command = string.split(line, None, 1)[0]
+        else:
+            command = ''
         method = getattr(self, 'do_'+string.upper(command), None)
         if method is None:
             method = self.do_UNKNOWN
@@ -107,21 +208,65 @@
             line = line[len(command):]
         return method(string.strip(line))
 
+    def lineLengthExceeded(self, line):
+        if self.mode is DATA:
+            for message in self.__messages:
+                message.connectionLost()
+            self.mode = COMMAND
+            del self.__messages
+        self.sendCode(500, 'Line too long')
+
+    def rawDataReceived(self, data):
+        "Throw away rest of long line"
+        rest = string.split(data, '\r\n', 1)
+        if len(rest) == 2:
+            self.setLineMode(self.rest[1])
+
     def do_UNKNOWN(self, rest):
-        self.sendCode(502, 'Command not implemented')
+        self.sendCode(500, 'Command not implemented')
 
     def do_HELO(self, rest):
-        self.__helo = rest
-        self.sendCode(250, 'Nice to meet you')
+        peer = self.transport.getPeer()[1]
+        self.__helo = (rest, peer)
+        self.sendCode(250, '%s Hello %s, nice to meet you' % (self.host, peer))
 
     def do_QUIT(self, rest):
         self.sendCode(221, 'See you later')
         self.transport.loseConnection()
 
+    # A string of quoted strings, backslash-escaped character or
+    # atom characters + '@.,:'
+    qstring = r'("[^"]*"|\\.|[' + string.replace(atom,'#',r'\#') + r'@.,:])+'
+
+    mail_re = re.compile(r'''\s*FROM:\s*(?P<path><> # Empty <>
+                         |<''' + qstring + r'''> # <addr>
+			 |''' + qstring + r''' # addr
+			 )\s*(\s(?P<opts>.*))? # Optional WS + ESMTP options
+			 $''',re.I|re.X)
+    rcpt_re = re.compile(r'\s*TO:\s*(?P<path><' + qstring + r'''> # <addr>
+                         |''' + qstring + r''' # addr
+			 )\s*(\s(?P<opts>.*))? # Optional WS + ESMTP options
+			 $''',re.I|re.X)
+
     def do_MAIL(self, rest):
-        from_ = rest[len("MAIL:<"):-len(">")]
-        self.validateFrom(self.__helo, from_, self._fromValid,
-                                              self._fromInvalid)
+        if self.__from:
+            self.sendCode(503,"Only one sender per message, please")
+            return
+        # Clear old recipient list
+        self.__to = []
+        m = self.mail_re.match(rest)
+        if not m:
+            self.sendCode(501, "Syntax error")
+            return
+
+        try:
+            addr = Address(m.group('path'))
+        except AddressError, e:
+            self.sendCode(553, str(e))
+            return
+            
+        self.validateFrom(self.__helo, addr, self._fromValid,
+                          self._fromInvalid)
 
     def _fromValid(self, from_):
         self.__from = from_
@@ -131,12 +276,24 @@
         self.sendCode(550, 'No mail for you!')
 
     def do_RCPT(self, rest):
-        to = rest[len("TO:<"):-len(">")]
-        user = User(to, self.__helo, self, self.__from)
+        if not self.__from:
+            self.sendCode(503, "Must have sender before recpient")
+            return
+        m = self.rcpt_re.match(rest)
+        if not m:
+            self.sendCode(501, "Syntax error")
+            return
+
+        try:
+            user = User(m.group('path'), self.__helo, self, self.__from)
+        except AddressError, e:
+            self.sendCode(553, str(e))
+            return
+            
         self.validateTo(user, self._toValid, self._toInvalid)
 
     def _toValid(self, to):
-        self.__to = self.__to + (to,)
+        self.__to.append(to)
         self.sendCode(250, 'Address recognized')
 
     def _toInvalid(self, to):
@@ -144,22 +301,30 @@
 
     def do_DATA(self, rest):
         if self.__from is None or not self.__to:  
-            self.sendCode(550, 'Must have valid receiver and originator')
+            self.sendCode(503, 'Must have valid receiver and originator')
             return
         self.mode = DATA
         helo, origin, recipients = self.__helo, self.__from, self.__to
         self.__from = None
-        self.__to = ()
+        self.__to = []
         self.__messages = self.startMessage(recipients)
+        for message in self.__messages:
+            message.lineReceived(self.receivedHeader(helo, origin, recipients))
         self.sendCode(354, 'Continue')
 
     def connectionLost(self, reason):
+        # self.sendCode(421, 'Dropping connection.') # This does nothing...
+        # Ideally, if we (rather than the other side) lose the connection,
+        # we should be able to tell the other side that we are going away.
+        # RFC-2821 requires that we try.
         if self.mode is DATA:
             for message in self.__messages:
                 message.connectionLost()
+            del self.__messages
 
     def do_RSET(self, rest):
-        self.__init__()
+        self.__from = None
+        self.__to = []
         self.sendCode(250, 'I remember nothing.')
 
     def dataLineReceived(self, line):
@@ -177,6 +342,7 @@
                     deferred = message.eomReceived()
                     deferred.addCallback(ndeferred.callback)
                     deferred.addErrback(ndeferred.errback)
+                del self.__messages
                 return
             line = line[1:]
         for message in self.__messages:
@@ -189,7 +355,14 @@
         self.sendCode(550, 'Could not send e-mail')
 
     # overridable methods:
+    def receivedHeader(self, helo, origin, recipents):
+        return "Received: From %s ([%s]) by %s; %s" % (
+            helo[0], helo[1], self.host,
+            time.strftime("%a, %d %b %Y %H:%M:%S +0000", time.gmtime()))
+    
     def validateFrom(self, helo, origin, success, failure):
+        if not self.__helo:
+            self.sendCode(503,"Who are you? Say HELO first");
         success(origin)
 
     def validateTo(self, user, success, failure):
@@ -265,6 +438,7 @@
         
     def smtpCode_354_data(self, line):
         self.mailFile = self.getMailData()
+        self.lastsent = ''
         self.transport.registerProducer(self, 0)
 
     def smtpCode_250_afterData(self, line):
@@ -277,11 +451,18 @@
         chunk = self.mailFile.read(8192)
         if not chunk:
             self.transport.unregisterProducer()
-            self.sendLine('.')
+            if self.lastsent != '\n':
+                line = '\r\n.'
+            else:
+                line = '.'
+            self.sendLine(line)
             self.state = 'afterData'
+            return
 
         chunk = string.replace(chunk, "\n", "\r\n")
+        chunk = string.replace(chunk, "\r\n.", "\r\n..")
         self.transport.write(chunk)
+        self.lastsent = chunk[-1]
 
     def pauseProducing(self):
         pass
Index: twisted/test/test_protocols.py
===================================================================
RCS file: /cvs/Twisted/twisted/test/test_protocols.py,v
retrieving revision 1.17
diff -u -u -r1.17 test_protocols.py
--- twisted/test/test_protocols.py	23 Sep 2002 08:51:29 -0000	1.17
+++ twisted/test/test_protocols.py	7 Oct 2002 13:04:02 -0000
@@ -33,11 +33,13 @@
 class LineTester(basic.LineReceiver):
 
     delimiter = '\n'
+    MAX_LENGTH = 64
 
     def connectionMade(self):
         self.received = []
 
     def lineReceived(self, line):
+        print self.MAX_LENGTH, len(line)
         self.received.append(line)
         if line == '':
             self.setRawMode()
@@ -51,6 +53,10 @@
         if self.length == 0:
             self.setLineMode(rest)
 
+    def lineLengthExceeded(self, line):
+        if len(line) > self.MAX_LENGTH+1:
+            self.setLineMode(line[self.MAX_LENGTH+1:])
+
 class WireTestCase(unittest.TestCase):
 
     def testEcho(self):
@@ -103,13 +109,14 @@
 012345678len 0
 foo 5
 
+1234567890123456789012345678901234567890123456789012345678901234567890
 len 1
 
 a'''
 
     output = ['len 10', '0123456789', 'len 5', '1234\n',
               'len 20', 'foo 123', '0123456789\n012345678',
-              'len 0', 'foo 5', '', 'len 1', 'a']
+              'len 0', 'foo 5', '', '67890', 'len 1', 'a']
 
     def testBuffer(self):
         for packet_size in range(1, 10):
@@ -175,3 +182,6 @@
             r.dataReceived(s)
             if not r.brokenPeer:
                 raise AssertionError("connection wasn't closed on illegal netstring %s" % repr(s))
+
+if __name__ == '__main__':
+    unittest.main()
-------------- next part --------------
-- 
 -- Of course I'm crazy, but that doesn't mean I'm wrong.
Anders Hammarquist                                  | iko at strakt.com
AB Strakt                                           | Tel: +46 31 749 08 80
G|teborg, Sweden.           RADIO: SM6XMM and N2JGL | Fax: +46 31 749 08 81

From twisted at moshez.org  Mon Oct  7 09:25:44 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 7 Oct 2002 13:25:44 -0000
Subject: [Twisted-Python] Quixote/Twisted Integration
Message-ID: <20021007132544.23425.qmail@green.zadka.com>

Hi!

I've added a feature to the Twisted web server where it can use Quixote's
PTL. Here's a (completely overkill) example:

-------------- hello.rtl ---------------
from twisted.web.resource import Resource


class ExampleResource(Resource):

    template render(self, request):
        """\
<HTML>
    <HEAD><TITLE> Welcome To Twisted Python </title></head>

    <BODY>
    This is a demonstration of embedded template python in a webserver.
    </body>
</html>"""


resource = ExampleResource()
------------------------------------------

Then configure the web server with:

% ./bin/mktap web --path=`pwd` --processor=.rtl=twisted.web.script.ResourceTemplate --port=10999
% ./bin/twistd -f web.tap

And then http://localhost:10999/hello.rtl will show the expected output.

This uses some features only available from the Twisted CVS and was tested
with Quixote 0.5

Thanks.




From twisted at moshez.org  Mon Oct  7 09:42:46 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 7 Oct 2002 13:42:46 -0000
Subject: [Twisted-Python] SMTP patch take 2
In-Reply-To: <200210071318.g97DIRG3001254@fido.strakt.com>
References: <200210071318.g97DIRG3001254@fido.strakt.com>
Message-ID: <20021007134246.23521.qmail@green.zadka.com>

Here are some comments

On Mon, 07 Oct 2002 15:18:27 +0200, Anders Hammarquist <iko at strakt.com> wrote:

> -    def __init__(self):
> +    def __init__(self, domain, timeout=600):

This is wrong. .domain and .timeout should be attributes the protocol
gets from the factory, since they are a part of the persistenct configuration.

> +    # A string of quoted strings, backslash-escaped character or
> +    # atom characters + '@.,:'
> +    qstring = r'("[^"]*"|\\.|[' + string.replace(atom,'#',r'\#') + r'@.,:])+'

Oh, wow. Maybe have some unit tests for the correctness of the regular
expressions :)

> +    def receivedHeader(self, helo, origin, recipents):
> +        return "Received: From %s ([%s]) by %s; %s" % (
> +            helo[0], helo[1], self.host,
> +            time.strftime("%a, %d %b %Y %H:%M:%S +0000", time.gmtime()))
> +    
>      def validateFrom(self, helo, origin, success, failure):
> +        if not self.__helo:
> +            self.sendCode(503,"Who are you? Say HELO first");
               ...and fail... 
>          success(origin)



From radix at twistedmatrix.com  Mon Oct  7 10:24:38 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 7 Oct 2002 16:24:38 +0200
Subject: [Twisted-Python] Deferred getChild
Message-ID: <20021007142438.GA1936@toshi>

I've implemented the Deferred support for getChild. I'd like to get
glyph's approval of this before I check it in, and I'm sending it to
TPML for general commentary.

getChildForRequest is now recursive in the general non-Deferred case,
I'm not sure if anyone has issues with this. I think I might be able
to convert it to a while loop that only recurses (well, horizontally
recurses ;-)) in the Deferred-result case.

Index: server.py
===================================================================
RCS file: /cvs/Twisted/twisted/web/server.py,v
retrieving revision 1.81
diff -u -r1.81 server.py
--- server.py	5 Oct 2002 12:15:11 -0000	1.81
+++ server.py	7 Oct 2002 14:21:02 -0000
@@ -42,7 +42,7 @@
 
 # Twisted Imports
 from twisted.spread import pb, refpath
-from twisted.internet import reactor, protocol
+from twisted.internet import reactor, protocol, defer
 from twisted.protocols import http
 from twisted.python import log, reflect, roots, failure, components
 from twisted import copyright
@@ -146,12 +146,17 @@
         self.postpath = map(urllib.unquote, string.split(self.path[1:], '/'))
         try:
             resrc = self.site.getResourceFor(self)
-            self.render(resrc)
+            if isinstance(resrc, defer.Deferred):
+                resrc.addCallback(self.render)
+                resrc.addErrback(self.processingFailed)
+            else:
+                self.render(resrc)
         except:
             self.processingFailed(failure.Failure())
 
     def render(self, resrc):
         try:
+            print resrc
             body = resrc.render(self)
         except UnsupportedMethod, e:
             allowedMethods = e.allowedMethods
@@ -449,7 +454,7 @@
         # servers and disconnected sites.
         request.sitepath = copy.copy(request.prepath)
         request.acqpath = copy.copy(request.prepath)
-        return self.resource.getChildForRequest(request)
+        return self.resource.getChildForRequest(request=request)
 
 
 import html
Index: resource.py
===================================================================
RCS file: /cvs/Twisted/twisted/web/resource.py,v
retrieving revision 1.20
diff -u -r1.20 resource.py
--- resource.py	25 Sep 2002 08:40:36 -0000	1.20
+++ resource.py	7 Oct 2002 14:21:02 -0000
@@ -122,21 +122,31 @@
 
         return self.getChild(path, request)
 
-    def getChildForRequest(self, request):
+    def getChildForRequest(self, resrc=None, request=None):
         """(internal) Get a child of mine dependant on a particular request.
 
         This will be called on me as a top-level resource of a site in order to
         retrieve my appropriate child or grandchild to display.
         """
-        res = self
-        while request.postpath and not res.isLeaf:
+        assert request, "No, that's not _really_ an optional argument."
+        res = resrc or self
+        if request.postpath and not res.isLeaf:
             pathElement = request.postpath.pop(0)
+            print "doing", pathElement, "...",
             request.acqpath.append(pathElement)
             request.prepath.append(pathElement)
             res = res.getChildWithDefault(pathElement, request)
-        return res
+            print "and got", res
 
+            #conditional horizontal or vertical recursion!
+            if isinstance(res, defer.Deferred):
+                #the caller adds an errback, so i don't need to
+                return res.addCallback(self.getChildForRequest, request)
+            else:
+                return self.getChildForRequest(res, request)
+        return res
 
+        
     def putChild(self, path, child):
         """Register a child with me.
         """




From iko at cd.chalmers.se  Mon Oct  7 10:44:49 2002
From: iko at cd.chalmers.se (Anders Hammarquist)
Date: Mon, 07 Oct 2002 16:44:49 +0200
Subject: [Twisted-Python] SMTP patch take 2 
In-Reply-To: Message from Moshe Zadka <twisted@moshez.org> 
   of "07 Oct 2002 13:42:46 -0000." <20021007134246.23521.qmail@green.zadka.com> 
References: <200210071318.g97DIRG3001254@fido.strakt.com> <20021007134246.23521.qmail@green.zadka.com> 
Message-ID: <200210071444.QAA10877@haddock.cd.chalmers.se>

In a message of 07 Oct 2002 13:42:46 -0000, Moshe Zadka writes:
>> +    # A string of quoted strings, backslash-escaped character or
>> +    # atom characters + '@.,:'
>> +    qstring = r'("[^"]*"|\\.|[' + string.replace(atom,'#',r'\#') + r'@
>.,:])+'
>
>Oh, wow. Maybe have some unit tests for the correctness of the regular
>expressions :)

Actually, no. The unit test should be checking if the stuff gets parsed
correctly in Address(), do_MAIL() and do_RCPT(). I don't really care if
the regexps are right, as long as the results from where they are used
are right. Though hopefully that would indicate that the regexp is right
as well ;-)

I think it's time for an update of twisted.test.test_smtp.

/Anders

-- 
 -- Of course I'm crazy, but that doesn't mean I'm wrong.
Anders Hammarquist                                  | iko at cd.chalmers.se
Physics student, Chalmers University of Technology, | Hem: +46 31 88 48 50
G|teborg, Sweden.           RADIO: SM6XMM and N2JGL | Mob: +46 707 27 86 87



From dave at pythonapocrypha.com  Mon Oct  7 12:08:08 2002
From: dave at pythonapocrypha.com (dave at pythonapocrypha.com)
Date: Mon, 7 Oct 2002 09:08:08 -0700 (PDT)
Subject: [Twisted-Python] Twisted performance?
Message-ID: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>

Hello,

I'm new to the list and have started looking at Twisted as an alternative 
to our company's internal, home-grown solution. Twisted appears to have 
all the functionality I want (and more!), so the main decision point for 
me is performance. Is there a web page or document describing some 
performance characteristics of Twisted?

Requests per second is only mildly interesting to me - our application is
all about total throughput. It's essentially a custom HTTP server for
large files (few hundred megabytes), so I'm looking for total throughput
numbers for a few high-speed connections as well as for many slow (modem
or slow DSL) connections. For example, on a 800 MHz PIII with a SCSI drive
we can currently sustain around 300 Mbps total across 100 non-rate-limited
connections (pulling the data off the disk), and 300 Mbps total across
about 1000 or so 150 Kbps connections. On a faster CPU and no disk access
we occasionally hit a gigabit per second across 50 or so full-speed
connections, but my target is only about 250 Mbps per machine, assuming
the CPU is in the < 1 GHz range. One problem with our implementation is
that the performance curve drops off too quickly as number of concurrent
connections go up. I'd love to sustain 250 Mbps across 2000 or more
connections; for now we compensate by buying more CPU (which isn't too big 
of a problem).

Our current solution is a pure-Python one we built internally. Originally
we used asyncore/asynchat but it was (1) too slow and (2) too low level.
What we built fixed these problems, but the fact that we're the only users
of our library is a risk, and it's a shame to build it all ourselves if we
can get away with using like Twisted.

I'd love to hear comments and performance numbers, even if they're just
anectdotal. Additionally (or as an alternative), if anyone can point me to
some sample code I can run it against our internal performance tests - I'd
be interested in (1) an HTTP server that serves just from memory (i.e.  
returns a valid but large HTTP response of just random or junk data) and
(2) an HTTP server that just serves a file or two from disk. In both cases
the emphasis is on total throughput at varying numbers of concurrent 
connections.

Thanks,
Dave

P.S. Does Twisted support any sort of throughput throttling? (i.e. the 
ability to cap [average] throughput at a certain level)




From twisted at itamarst.org  Mon Oct  7 11:37:51 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 7 Oct 2002 11:37:51 -0400
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
Message-ID: <20021007113751.6c402c39.twisted@itamarst.org>

On Mon, 7 Oct 2002 09:08:08 -0700 (PDT)
dave at pythonapocrypha.com wrote:

> I'd love to hear comments and performance numbers, even if they're just
> anectdotal. 

Twisted sustained performance is not all that great, especially from disk, but then we haven't really tried to optimize it that much. On the other hand, on my laptop (866 crusoe) it can do 160Mbit from disk (100 concurrent connections over loopback, using ab), but then it's a pretty slow machine. On a decent machine it'd probably do much better, and there are clear paths towards optimization - certainly we'd love it if you ported your optimizations to Twisted.

> Additionally (or as an alternative), if anyone can point me to
> some sample code I can run it against our internal performance tests - I'd
> be interested in (1) an HTTP server that serves just from memory (i.e.  
> returns a valid but large HTTP response of just random or junk data) and
> (2) an HTTP server that just serves a file or two from disk. In both cases
> the emphasis is on total throughput at varying numbers of concurrent 
> connections.

1. $ cp largefile /var/www/
   $ mktap web --path=/var/www
   $ twistd -f web.tap
   $ ab -n 300 -c 20 http://localhost:8080/largefile

2. Run attached script and run benchmarks against it. Seems rather slow, actually, compared to (1).

> P.S. Does Twisted support any sort of throughput throttling? (i.e. the 
> ability to cap [average] throughput at a certain level)

No, but it could be added pretty easily to things that use producer/consumer, I think (e.g. serving files).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting
-------------- next part --------------
A non-text attachment was scrubbed...
Name: empty.py
Type: application/octet-stream
Size: 1060 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021007/d60a3118/attachment.obj 

From twisted at itamarst.org  Mon Oct  7 12:06:10 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 7 Oct 2002 12:06:10 -0400
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
Message-ID: <20021007120610.08030498.twisted@itamarst.org>

On Mon, 7 Oct 2002 09:08:08 -0700 (PDT)
dave at pythonapocrypha.com wrote:

> I'd love to hear comments and performance numbers, even if they're just
> anectdotal. 

Twisted sustained performance is not all that great, especially from disk, but then we haven't really tried to optimize it that much. On the other hand, on my laptop (866 crusoe) it can do 160Mbit from disk (100 concurrent connections over loopback, using ab), but then it's a pretty slow machine. On a decent machine it'd probably do much better, and there are clear paths towards optimization - certainly we'd love it if you ported your optimizations to Twisted.

> Additionally (or as an alternative), if anyone can point me to
> some sample code I can run it against our internal performance tests - I'd
> be interested in (1) an HTTP server that serves just from memory (i.e.  
> returns a valid but large HTTP response of just random or junk data) and
> (2) an HTTP server that just serves a file or two from disk. In both cases
> the emphasis is on total throughput at varying numbers of concurrent 
> connections.

1. $ cp largefile /var/www/
   $ mktap web --path=/var/www
   $ twistd -f web.tap
   $ ab -n 300 -c 20 http://localhost:8080/largefile

2. Run attached script and run benchmarks against it. Seems rather slow, actually, compared to (1).

> P.S. Does Twisted support any sort of throughput throttling? (i.e. the 
> ability to cap [average] throughput at a certain level)

No, but it could be added pretty easily to things that use producer/consumer, I think (e.g. serving files).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting
-------------- next part --------------
A non-text attachment was scrubbed...
Name: empty.py
Type: application/octet-stream
Size: 1060 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021007/81cad21b/attachment.obj 

From twisted at itamarst.org  Mon Oct  7 12:41:01 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 7 Oct 2002 12:41:01 -0400
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <20021007113751.6c402c39.twisted@itamarst.org>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
	<20021007113751.6c402c39.twisted@itamarst.org>
Message-ID: <20021007124101.2675e764.twisted@itamarst.org>

On Mon, 7 Oct 2002 11:37:51 -0400
Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> other hand, on my laptop (866 crusoe) it can do 160Mbit from disk

Or according to httperf, only 100Mbit.



From bruce at cubik.org  Mon Oct  7 13:06:07 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Mon, 07 Oct 2002 11:06:07 -0600
Subject: [Twisted-Python] Twisted performance?
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>	<20021007113751.6c402c39.twisted@itamarst.org> <20021007124101.2675e764.twisted@itamarst.org>
Message-ID: <3DA1BEFF.80501@cubik.org>

Itamar Shtull-Trauring wrote:
> On Mon, 7 Oct 2002 11:37:51 -0400
> Itamar Shtull-Trauring <twisted at itamarst.org> wrote:
> 
>>other hand, on my laptop (866 crusoe) it can do 160Mbit from disk
> 
> Or according to httperf, only 100Mbit.

Is that going over loopback or the NIC though?

  - Bruce




From twisted at itamarst.org  Mon Oct  7 13:02:04 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 7 Oct 2002 13:02:04 -0400
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <3DA1BEFF.80501@cubik.org>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
	<20021007113751.6c402c39.twisted@itamarst.org>
	<20021007124101.2675e764.twisted@itamarst.org>
	<3DA1BEFF.80501@cubik.org>
Message-ID: <20021007130204.6744ee3f.twisted@itamarst.org>

On Mon, 07 Oct 2002 11:06:07 -0600
Bruce Mitchener <bruce at cubik.org> wrote:

> Is that going over loopback or the NIC though?

loopback.



From jjn at kriln.com  Mon Oct  7 14:41:11 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Mon, 7 Oct 2002 18:41:11 +0000 (GMT)
Subject: [Twisted-Python] patch for protocols.telnet.Telnet
Message-ID: <20021007183722.W58399-100000@nosferatu.kriln.com>

There's a bug in the telnet protocol, which will only process one 'line'
per call to processChunk().  This is buggy, because if you send a large
amount of data to a connection, such as via copy/paste, it will only
process the first two lines of it, and you're stuck mashing the enter key
to get it to process the rest.

Patch makes it process all lines instead of just one.

Index: telnet.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/telnet.py,v
retrieving revision 1.16
diff -u -r1.16 telnet.py
--- telnet.py   15 Jul 2002 23:51:33 -0000      1.16
+++ telnet.py   7 Oct 2002 18:35:02 -0000
@@ -250,12 +250,16 @@
             idx = string.find(self.buffer, delim)
             if idx != -1:
                 break
-
-        if idx != -1:
+        while idx != -1:
             buf, self.buffer = self.buffer[:idx], self.buffer[idx+2:]
             self.processLine(buf)
             if self.mode == 'Done':
                 self.transport.loseConnection()
+
+            for delim in self.delimiters:
+                idx = string.find(self.buffer, delim)
+                if idx != -1:
+                    break

     def dataReceived(self, data):
         chunk = StringIO()





From mjstahl at mac.com  Tue Oct  8 00:16:51 2002
From: mjstahl at mac.com (MJ Stahl)
Date: Mon, 7 Oct 2002 23:16:51 -0500
Subject: [Twisted-Python] JSPB on mozdev.org
Message-ID: <C5827F1D-DA74-11D6-B26C-000393763438@mac.com>

I just wanted to let everyone know, the work that I have completed so 
far on JSPB (javascript implemenation of perspective broker) is 
currently up on

jspb.mozdev.org

Currently the files that I have included do not function, and in some 
instances are incomplete. I posted them because I need some guidance or 
potential help, and still can only see the damned pb trees, and not the 
pb forest.

banana.js is the most complete, and includes a test_banana.js for a 
test case... both ported directly from the python source.

Currently I am having trouble with the inclusion of other JS files 
through a JS or Mozilla way. I am also having difficulties with string 
input/output operations, not having the knowledge of anything of these 
operations that may be going on behind the twisted scene (ie, other 
included modules), or what is a good minimalist approach would be.

Thanks guys, and I just wanted to let you know what was going on.

-mjs 




From glyph at twistedmatrix.com  Tue Oct  8 03:04:24 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 08 Oct 2002 02:04:24 -0500 (CDT)
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
Message-ID: <20021008.020424.07435626.glyph@twistedmatrix.com>


Too much of the vision for Twisted lives in my head, because I'm concerned
about releasing unfinished visions and having lots of potentially contradictory
documents live in the repository.  So, I'm going to try now every once in a
while to vent some of these ideas that have been playing around inside my head.

This is my first attempt at doing this, so feel free to ask questions.

These are all features that I intend to implement personally, but if anyone
wants to contribute a patch for me to review, I'd love to see it.


1. Perspective Broker URLS
==========================

The current (huge constellation of) connection APIs that PB ships with are all
subtly broken in one way or another.  They all walk the line between "too
verbose" and "too limited".

In essence what PB needs is a mini-language for specifying these connection
conversations.  URLs provide a very useful basis for this sort of
mini-language.  I haven't worked out a lot of the details of this connection
scheme yet (otherwise I would have implemented it) but it should be pretty
straightforward extension of the ideas in HTTP URLs.

These URLs need to be able to represent transport mechanism (TCP? UNIX socket?
SSL? Weird firewall-tunneling stuff?) plus everything about the object that
you're trying to access (location? authentication information? authentication
format?)

The idea is that you pass in a string, you get a Deferred PB "endpoint", which
should be the object that you're really wanting to interact with.  Here are
some off-the-cuff examples:

    pb://pyramid/service#perspective

Log in to Pyramid, with the given service and perspective.  The part of the
login conversation which attempts to get the "child" object from the service
will prompt for interactive authentication.

    pb://pyramid/identity:password at service#perspective

Normal login/password to service/perspective pair.  Challenge-response
authentication implied.

    pb://pyramid/md5-cr$identity:password at service#perspective

Same thing, normal challenge-response explicitly selected.

    pb-ssh://pyramid/sshkey$identity at service#perspective

Public-key authentication mechanism, using the same identity name.  Connection
over SSH transport (sshkey auth only available this way).

    pb-ssl://pyramid/cert$identity at service#perspective

PB over SSL, using certificate auth.

    pb://pyramid/this/that/the-other/my-service#perspective

A service located within a tree of services.  Again the my-service bit of the
path will prompt for interactive authentication.

    pb://pyramid/user at sekrit/otheruser at double-sekrit/super-sekrit-service#perspective

Two objects in the path that require separate authentication.  An unusual, but
still possible situation.


2. Automatic XSS input scrubbing for Woven
==========================================

Form input that is intended to be used as HTML can be scanned for potentially
abusive input so that the web administration interface for a bulletin board
written using Twisted doesn't fall prey to the usual "cross site scripting"
vulnerabilities that plague feedback-capable web sites.

The problem formulation, generally, is that an attacker will place some
malicious javascript in a web form.  When some article is viewed by an admin,
that malicious javascript executes in their browser, taking advantage of the
fact that they have an admin cookie for that website in their browser.  It will
take advantage of a security flaw in the browser and perform administrative
tasks with their authority on the website without the admin's approval.

There are pretty much only a few ways they can do this, and I believe each one
has a simple solution.

    - <script /> tags

Don't allow script tags in input, ever.  Force input that uses tags into a DOM
tree before it is even made to be preview-able.  (DOM parsing can be relaxed,
but before the tree is output, it is converted to well-formed XML).

    - <a href="..." /> tags

Stick a little warning after any "off-site" link, and turn it into a redirect.
Any admin clicking on such a link will first be bounced through a URL which
revokes their admin cookie so the attacking site won't have the ability to call
back.

    - attributes on other HTML tags, such as onmouseover, that execute js
      expressions

Catalogue these and scrub them all off.

    - <img /> or <object /> tags that automatically download other items, which
      may be webpages containing javascript.

Again, don't allow these tags.  Or, have the server-side site download the
images and verify that they are PNGs (alternately also doing PIL stuff to
remove steganographic information, if you're _really_ paranoid).


3. widgets.Form-like Abstraction for Woven (and others) 
=======================================================

(This has been alternately called "form methods" or "actions".)  The idea is
that we have a meta-data format for publishing methods to have user interfaces,
which would most likely look like forms.  This metadata should be
platform-neutral and have a Woven front-end widget (controller?) that formats
it prettily, perhaps in conjunction with a template for the form itself.

This interface should also extend to other UIs.  Having a GTK interface would
be particularly useful for building GUI equivalents of tools like COIL, which
should be able to have a GUI hook into it as easily as a web page.

Additionally there should be some support for remote methods.  A PB reference
should be able to present at least a trivial version of this meta-data for its
objects.  That way you could present user-interfaces to arbitrary PB objects
(and, with a little magic, format those interfaces through a local web-proxy,
for total platform independence.  *OR* have a GTK client!)

This really sounds like black magic, but there is some precedent for it in
widgets.Form.  The general idea is that, for a method like:

  def formattedMath(op, a, b):
      result = op(a, b)
      return "%s %s %s = %s" % (a, op.__name__, b, result)

You'd present a list that looked like:

   import form
   [["op", form.Menu(["Multiply", operator.mul],
                     ["Add", operator.add],
                     ["Subtract", operator.sub],
                     ["Divide", operator.div])],
    ["a", form.Number()],
    ["b", form.Number()]]

That would provide a user-interface that could provide nice input constraints
for invoking that method.

The biggest problem I've hit so far with this idea is how to provide a
reasonable default appearance of various data-types while still allowing for
formattable customization in the template.  I've got some vague ideas of how to
fix this by allowing embedding of certain specifically-named elements in a
template and providing a default template that has all elements provided.

Even if I managed to get this right for the web, though, trying to avoid lock
in to the web's way of thinking about forms is very tricky!  I have yet to
seriously think about how GTK, PyUI, or Tkinter would work with this.  I have
spent a little while thinking about how a text-based virtual world interface in
twisted reality, though, and that should be pretty easy (building a machine
with dials, knobs, etc, and a big button for "submit").

4. Generalized Tree Structure for Twisted Applications
======================================================

I want to have it so that Twisted apps are easily navigable and arbitrarily
manipulable, almost like a virtual filesystem.  The most obvious application of
this is to make something like 'mktap --append' generally _work_ when you add
stuff to a .tap.

The current hierarchical nature of services is a step in this direction, though
it clearly doesn't go high enough.  Right now, mktap --append could be checking
for the existence of services, allowing you to add new services at given
'paths' inside the application without binding ports... though it isn't, and
this requires a fair amount of logical restructuring of the tap plugin
metaphor.

In keeping with the idea of URLs for PB, it would be nice if each object, as it
was inserted into this hierarchy, would get a notification that it was now
available at a new URL, or that it had been removed from a URL.
(availableAtURL) These URLs would include information about how it was
accessible from within the .tap (twisted://tcp/80) and how it was accessible to
the outside world (http://64.123.27.105/you/are/here/,
telnet://user at 64.123.27.105/obj).

Objects could much more reliably provide hyperlinks to themselves in this case,
and that would be a very neat feature.  In addition, the sysadmin's view of
Twisted would be greatly simplified.


5. Future directions for Words
==============================

I already explained this to some extent in Words's massive docstring update, so
I'll be brief.  Twisted words ought to be a distributed, consensus directory
service for chat groups, not a centralized (though hierarchical and
geographically dispersed) message relaying service like IRC.

Chat groups really ought to have a lot of metadata associated with them,
including a customizable summary homepage and an RSS feed.  Ideally once we're
sure that Woven is not terribly exploitable via the web (see idea 2), we can
allow users to upload templates directly.

Also, group membership should be persistent.  The ability to join the group as
a "regular" is an interesting function and I'm wondering how it can be done.
First-come-first-serve options for grabbing names seems like they'd encourage
squatting.  I think that by having a distributed naming system (where different
people call the "python" group different things, but python at twistedmatrix.com
will always get you to the one you're looking for) might circumvent squatting.

-------------------

Anyway, that's all for tonight.  I hope that this is useful to some of you out
there who are wondering what I'm thinking about such things :)

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021008/fe6cbb05/attachment.pgp 

From twisted at moshez.org  Tue Oct  8 03:20:47 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 8 Oct 2002 07:20:47 -0000
Subject: [Twisted-Python] the news tap
Message-ID: <20021008072047.1463.qmail@green.zadka.com>

I dislike *immensely* the news tap's usage of raw_input -- this is just
WRONG. This means that a future usage.Options which uses a GUI (which
is not that unlikely) would be reduced to asking questions on the console.

In all cases, the raw_input should have been parameters on the command line.
I would like to take this moement to remind you what taps are and are not:

* a tap plugin is not "the cannonical way to use a module"
* a tap plugin is a way to prgrogrammatically record useful ways to configure
  an Application

Thus, in my opinion, the current news tap should be split into

* A dbnews plugin, which asks for the db parameters
* A picklenews plugin, which asks for the file name
[A future hack: * A dirdbm plugin, which asks for a directory name]



From tv at twistedmatrix.com  Tue Oct  8 12:44:04 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Tue, 8 Oct 2002 19:44:04 +0300
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
Message-ID: <20021008164404.GA5790@ki.yok.utu.fi>

On Mon, Oct 07, 2002 at 09:08:08AM -0700, dave at pythonapocrypha.com wrote:
> Requests per second is only mildly interesting to me - our
> application is all about total throughput. It's essentially a custom
> HTTP server for large files (few hundred megabytes), so I'm looking
> for total throughput numbers for a few high-speed connections as
> well as for many slow (modem or slow DSL) connections. For example,
> on a 800 MHz PIII with a SCSI drive we can currently sustain around
> 300 Mbps total across 100 non-rate-limited connections (pulling the
> data off the disk), and 300 Mbps total across about 1000 or so 150
> Kbps connections. On a faster CPU and no disk access we occasionally
> hit a gigabit per second across 50 or so full-speed connections, but
> my target is only about 250 Mbps per machine, assuming the CPU is in
> the < 1 GHz range. One problem with our implementation is that the
> performance curve drops off too quickly as number of concurrent
> connections go up. I'd love to sustain 250 Mbps across 2000 or more
> connections; for now we compensate by buying more CPU (which isn't
> too big of a problem).

	Umm, you want recent 2.4 kernel, sendfile(2) and
	http://www.kegel.com/c10k.html.
	Maybe throw in an Intel e1000 with TCP segment offloading.

	But maybe that's just the kernel hacker in me.

-- 
:(){ :|:&};:



From tv at twistedmatrix.com  Tue Oct  8 13:08:14 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Tue, 8 Oct 2002 20:08:14 +0300
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021008.020424.07435626.glyph@twistedmatrix.com>
References: <20021008.020424.07435626.glyph@twistedmatrix.com>
Message-ID: <20021008170814.GB5790@ki.yok.utu.fi>

On Tue, Oct 08, 2002 at 02:04:24AM -0500, Glyph Lefkowitz wrote:
> 1. Perspective Broker URLS
> ==========================

> These URLs need to be able to represent transport mechanism (TCP? UNIX socket?
> SSL? Weird firewall-tunneling stuff?)

	"Talk to subprocess that runs this command to connect to the other end"
	("ssh remotehost pbserver", "ssh remotehost
	connect-stdinout-to-unix-socket /path/socket")

	And yes, I may want that even after Twisted has a fully working
	SSH implementation. For rex :)

>                                       plus everything about the object that
> you're trying to access (location? authentication information? authentication
> format?)

	I think you may want to look at SASL for ideas on
	authentication. It seems to be the standard way to add generic
	authentication support to a protocol these days.

> The idea is that you pass in a string, you get a Deferred PB "endpoint", which
> should be the object that you're really wanting to interact with.  Here are
> some off-the-cuff examples:
> 
>     pb://pyramid/service#perspective

	What part talks about TCP/UNIX/etc? service? Then it needs
	more structure to it.

>     pb://pyramid/identity:password at service#perspective

	Eww. Passwords in URLs is baaad. Because users like to enter
	URLs on command line.

	I'd much rather see an explicit "--password-file filename" and
	"--password-fd n".

> Public-key authentication mechanism, using the same identity name.  Connection
> over SSH transport (sshkey auth only available this way).
> 
>     pb-ssl://pyramid/cert$identity at service#perspective
> 
> PB over SSL, using certificate auth.
> 
>     pb://pyramid/this/that/the-other/my-service#perspective

	Hmm. Idea. Allow one to specify when the server is trusted.
	"Connect to server X if its public key has fingerprint F."
	http://www.fs.net/

> 2. Automatic XSS input scrubbing for Woven
> ==========================================
> 
> Form input that is intended to be used as HTML can be scanned for potentially
> abusive input so that the web administration interface for a bulletin board
> written using Twisted doesn't fall prey to the usual "cross site scripting"
> vulnerabilities that plague feedback-capable web sites.
> 
> The problem formulation, generally, is that an attacker will place some
> malicious javascript in a web form.  When some article is viewed by an admin,
> that malicious javascript executes in their browser, taking advantage of the
> fact that they have an admin cookie for that website in their browser.  It will
> take advantage of a security flaw in the browser and perform administrative
> tasks with their authority on the website without the admin's approval.
> 
> There are pretty much only a few ways they can do this, and I believe each one
> has a simple solution.
> 
>     - <script /> tags
> 
> Don't allow script tags in input, ever.  Force input that uses tags into a DOM
> tree before it is even made to be preview-able.  (DOM parsing can be relaxed,
> but before the tree is output, it is converted to well-formed XML).
> 
>     - <a href="..." /> tags
> 
> Stick a little warning after any "off-site" link, and turn it into a redirect.
> Any admin clicking on such a link will first be bounced through a URL which
> revokes their admin cookie so the attacking site won't have the ability to call
> back.
> 
>     - attributes on other HTML tags, such as onmouseover, that execute js
>       expressions
> 
> Catalogue these and scrub them all off.
> 
>     - <img /> or <object /> tags that automatically download other items, which
>       may be webpages containing javascript.
> 
> Again, don't allow these tags.  Or, have the server-side site download the
> images and verify that they are PNGs (alternately also doing PIL stuff to
> remove steganographic information, if you're _really_ paranoid).

	Your basic problem here is that you are trying to disallow
	things you know are not safe. That assumes you are omnipotent.
	While not contesting that, I still feel the only sane
	architecture is to catalogue known safe things, and only allow
	those. Something like a DTD/schema should do the job.

> Even if I managed to get this right for the web, though, trying to avoid lock
> in to the web's way of thinking about forms is very tricky!  I have yet to
> seriously think about how GTK, PyUI, or Tkinter would work with this.  I have
> spent a little while thinking about how a text-based virtual world interface in
> twisted reality, though, and that should be pretty easy (building a machine
> with dials, knobs, etc, and a big button for "submit").

	You may also be interested in the W3C work on XForms.

	IMHO, form-based GUIs suck horribly. A GUI is good only if
	it is interactive -- dynamic in some way. Most of the current
	GUIs only try to reach rich with forms that change
	dynamically.

	Have you ever used mc-foo fan? While certainly not the greatest
	GUI in the world, imagine you had to use it through forms.

> squatting.  I think that by having a distributed naming system (where different
> people call the "python" group different things, but python at twistedmatrix.com
> will always get you to the one you're looking for) might circumvent squatting.

	So user A will see python at python.org as "python", user B will see
	python at twistedmatrix.com as "python", and if those two ever have
	to be squashed to the same namespace, user A will see
	"python (python at python.org)" and "python at twistedmatrix.com"
	and user B will see "python at python.org" and "python
	(python at twistedmatrix.com)"?

	All is fine as long as the users don't talk about the channel
	names that much :)

	This problem may be easier to think of in terms of nicks than of
	channels; IIRC there was some chat system that under the hood
	identified users with user at host (unix user id / email, whatever),
	but allowed them to set their list of "preferred nicknames".
	User A would see user B with the first available preferred
	nickname from B's list, or as userB at hostB if none was
	available. And this was, IIRC, done fully in A's client; if B
	and C saw different people (were on different channels), they
	could see A with a different nickname.

-- 
:(){ :|:&};:



From dave at pythonapocrypha.com  Tue Oct  8 15:52:26 2002
From: dave at pythonapocrypha.com (Dave Brueck)
Date: Tue, 8 Oct 2002 12:52:26 -0700 (PDT)
Subject: [Twisted-Python] Twisted performance?
Message-ID: <Pine.LNX.4.44.0210081251480.28969-100000@ns0.tbye.com>

On Tue, 8 Oct 2002, Tommi Virtanen wrote:

> > the < 1 GHz range. One problem with our implementation is that the
> > performance curve drops off too quickly as number of concurrent
> > connections go up. I'd love to sustain 250 Mbps across 2000 or more
> > connections; for now we compensate by buying more CPU (which isn't
> > too big of a problem).
> 
> 	Umm, you want recent 2.4 kernel, sendfile(2) and
> 	http://www.kegel.com/c10k.html.

Been there, done that. But thanks for responding! :)

-Dave





From radix at twistedmatrix.com  Tue Oct  8 19:34:55 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 9 Oct 2002 01:34:55 +0200
Subject: [Twisted-Python] Re: [Twisted-commits] added docs
In-Reply-To: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com>
References: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com>
Message-ID: <20021008233455.GA472@toshi>

On Tue, Oct 08, 2002 at 04:12:01AM -0500, warner CVS wrote:
> Modified files:
> Twisted/ChangeLog 1.133 1.134
> 
> Log message:
> added docs


I'm freaking impressed. These are some damned good docs -- thanks
tons.



From andrew-twisted at puzzling.org  Tue Oct  8 19:49:25 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 9 Oct 2002 09:49:25 +1000
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021008170814.GB5790@ki.yok.utu.fi>
References: <20021008.020424.07435626.glyph@twistedmatrix.com> <20021008170814.GB5790@ki.yok.utu.fi>
Message-ID: <20021008234925.GA30177@ritsuko.xware.cx>

On Tue, Oct 08, 2002 at 08:08:14PM +0300, Tommi Virtanen wrote:
> On Tue, Oct 08, 2002 at 02:04:24AM -0500, Glyph Lefkowitz wrote:
> 
> > 2. Automatic XSS input scrubbing for Woven
> > ==========================================
[..snip..]
> >     - attributes on other HTML tags, such as onmouseover, that execute js
> >       expressions
> > 
> > Catalogue these and scrub them all off.
> > 
> >     - <img /> or <object /> tags that automatically download other
> >       items, which may be webpages containing javascript.
> > 
> > Again, don't allow these tags.  Or, have the server-side site download the
> > images and verify that they are PNGs (alternately also doing PIL stuff to
> > remove steganographic information, if you're _really_ paranoid).
> 
> 	Your basic problem here is that you are trying to disallow
> 	things you know are not safe. That assumes you are omnipotent.
> 	While not contesting that, I still feel the only sane
> 	architecture is to catalogue known safe things, and only allow
> 	those. Something like a DTD/schema should do the job.

Agreed.  You need a whitelist to do this 100%, not a blacklist.  New
browser versions invent new ways of injecting js into HTML, so a
blacklist can never hope to be complete.  BugTraq has seen this every
time a major new browser version is released.  Also be aware of nasty
tricks like "onmouse&x6f;ver" or however it is you can encode random
ascii (or unicode!) entities -- most browsers will still understand
that.  Your filter needs to as well.

I think there may be a fundamental flaw to filtering this with Woven.
Woven assumes correctly formed XML.  Browsers will still execute js on a
page that is HTML (or even HTML-ish!), even if it isn't XML.  That
already means there's probably tricks that lie outside the set of what
Woven can deal with -- though perhaps Woven can't generate them in the
first place?

If you intend to build XSS protection into Woven, I strongly recommend
you look through BugTraq's archives to get some idea of the wide variety
of techinques that can be involved -- in fact, I think they've started a
seperate mailing list for XSS now.

-Andrew.




From rc at ghostbitch.org  Tue Oct  8 19:44:52 2002
From: rc at ghostbitch.org (rc at ghostbitch.org)
Date: Tue, 8 Oct 2002 16:44:52 -0700
Subject: [Twisted-Python] Re: [Twisted-commits] added docs
In-Reply-To: <20021008233455.GA472@toshi>
References: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com> <20021008233455.GA472@toshi>
Message-ID: <20021008234452.GG24749@modey.miralink.com>

On Wed, Oct 09, 2002 at 01:34:55AM +0200, Christopher Armstrong wrote:
> On Tue, Oct 08, 2002 at 04:12:01AM -0500, warner CVS wrote:
> > Modified files:
> > Twisted/ChangeLog 1.133 1.134
> > 
> > Log message:
> > added docs
> 
> 
> I'm freaking impressed. These are some damned good docs -- thanks
> tons.
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

Well put.



From jml at mumak.net  Wed Oct  9 00:38:09 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Wed, 9 Oct 2002 15:38:09 +1100
Subject: [Twisted-Python] Woven feature suggestion - Error pages
Message-ID: <20021009043809.GB22798@mumak.net>

Unfortunately, I'm going to have to start on the wrong foot. Please bear
with me.

When writing JSPs (see, I told you), one of the useful things you can do
is specify an error page. If the JSP throws an exception, but fails to
catch it, the error page is displayed instead. Within the error page,
there is an implicit 'exception' variable that refers to the caught 
exception.

>From memory, it is also possible to configure different web pages for
different types of exceptions in the web.xml descriptor (which is
where application-wide settings are kept)

In the past, I've mainly used this feature to have an
appropriately-skinned, user friendly error message instead of a stack
trace. I haven't found it useful for much else.

Something similar within Woven would be nice. And there's probably
scope to improve on the way JSP does it and make it more useful.

jml



From andrew-twisted at puzzling.org  Wed Oct  9 01:35:26 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 9 Oct 2002 15:35:26 +1000
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021008.020424.07435626.glyph@twistedmatrix.com>
References: <20021008.020424.07435626.glyph@twistedmatrix.com> <20021008170814.GB5790@ki.yok.utu.fi>
Message-ID: <20021009053526.GB1130@ritsuko.xware.cx>

On Tue, Oct 08, 2002 at 02:04:24AM -0500, Glyph Lefkowitz wrote:

>     pb://pyramid/identity:password at service#perspective

I was discussing this with someone, and they pointed out that this is an
odd way of doing things.  In HTTP, you do:
    http://user at domain/path/
or even
    http://user:pass at domain/path/

Your reason is presumably because the username/password is determined by
the service, not the host -- but this is also the case for HTTP.  Some
paths may require authentication, some may require none.

I can see arguments both ways.  I'm not sure which way is better, but if
you are claiming similarity to existing URLs, you may wish to consider
this...

-Andrew.




From typo at soniq.net  Wed Oct  9 09:25:00 2002
From: typo at soniq.net (Paul Boehm)
Date: Wed, 9 Oct 2002 15:25:00 +0200
Subject: [Twisted-Python] web.static & woven.widgets patches
Message-ID: <20021009132500.GA29817@soniq.net>

hi,

the included patches haven't been applied to the repository yet.

there's no unittest for web Redirects, and the
the patch to static.py is a bugfix. while it probably isn't
the cleanest way to do these redirects, it's definitely better 
than the original code which breaks index.rpy query_string's,
and leads to urls like http://bla///////.

i too found no unittests for woven, and my patch allows to
check checkboxes via the model. this shouldn't break anything
either.

can anyone give me a statement regarding those patches?

diff -u -r1.63 static.py
--- static.py   1 Oct 2002 17:28:46 -0000       1.63
+++ static.py   4 Oct 2002 16:58:34 -0000
@@ -253,10 +253,12 @@
             # If someone is looking for children with a PathReferenceContext,
             # the request won't have a prepath, and we shouldn't do this kind
             # of mangling anyway because it has already been done.
-            if hasattr(request, 'postpath') and not request.postpath and request.uri[-1] != '/':
+            if hasattr(request, 'postpath') and not request.postpath and \
+                        string.split(request.uri,'?')[0][-1] != '/':
                 return Redirect(request)
             if os.path.exists(childPath):
-                if hasattr(request, 'postpath') and not request.postpath and not self.getIndex(request):
+                if hasattr(request, 'postpath') and not request.postpath and \
+                                                not self.getIndex(request):
                     return widgets.WidgetPage(DirectoryListing(self.path))


diff -u -r1.20 widgets.py
--- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
+++ widgets.py  4 Oct 2002 16:52:50 -0000
@@ -388,13 +388,17 @@

     def generateDOM(self, request, node):
         mVal = self.getData()
-        if mVal:
-            self['value'] = str(mVal)
+        self['value'] = str(mVal)
         return Widget.generateDOM(self, request, node)

 class CheckBox(Input):
     def initialize(self):
         self['type'] = 'checkbox'
+    def generateDOM(self, request, node):
+        node = Input.generateDOM(self, request, node)
+        if self.getData():
+            node.setAttribute('checked', "checked")
+        return node

 class RadioButton(Input):
     def initialize(self):




From typo at soniq.net  Wed Oct  9 10:32:43 2002
From: typo at soniq.net (Paul Boehm)
Date: Wed, 9 Oct 2002 16:32:43 +0200
Subject: [Twisted-Python] woven-bug: multiple nodes using the same model
Message-ID: <20021009143243.GA21447@soniq.net>

when a controller and a widget have the same model, this leads to
lots of weird inconsistencies.

i use this template:

        <form action="" name="addserver" model="listall" controller="addserver">
            Host:
            <input type="text" name="host" />
            Port:
            <input type="text" name="port" />
            <input type="submit" value="Add" />
        </form>

        <form action="">
            <span class="heading">All Servers:</span>
            <ul model="listall" view="List">
                <li id="emptyList">No Servers defined</li>
                <li id="listItem">
                    <span view="Text" model="0" />
                    <span view="Text" model="1" />
                    <span view="CheckBox" model="2" value="1" />
                    <span view="CheckBox" model="3" value="1" />
                </li>
            </ul>
            <input type="submit" />
        </form>

This results in two calls to widgets.List.generateDOM, which produces
inconsistencies. 

I'm not sure which code is at fault, but List at least produces a wrong 
_submodel_prefix. Because of this i modified List to reset the Attribute
on every call:

#            domhelpers.superAppendAttribute(newNode, '_submodel_prefix',
#                                            submodel)
            domhelpers.superSetAttribute(newNode, '_submodel_prefix',
                                            submodel)
            domhelpers.superAppendAttribute(newNode, '_submodel_prefix',
                                            str(itemNum))

This fixes the wrong _submodel_prefix, but the List view still lags behind
one added element per submit. after a normal reload all the data is displayed
correctly.

Also all listitems get displayed with the same value every time after
submitting.

when i reload with a failing Handler.check, i get the right values, though.

i'm trying to debug this right now, but some help from someone with a
better understanding of woven's internals would be really helpful.

  paul



From typo at soniq.net  Wed Oct  9 10:56:57 2002
From: typo at soniq.net (Paul Boehm)
Date: Wed, 9 Oct 2002 16:56:57 +0200
Subject: [Twisted-Python] woven-bug: multiple nodes using the same model
In-Reply-To: <20021009143243.GA21447@soniq.net>
References: <20021009143243.GA21447@soniq.net>
Message-ID: <20021009145657.GB21447@soniq.net>

ok,

this fixes at least the problem with List repeating the same
element all over (instead of listing all elements).
(patch made against my local tree, also contains added CheckBox
functionality).

i'm still working on the problem that the view lags behind the model.

diff -u -r1.20 widgets.py
--- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
+++ widgets.py  9 Oct 2002 14:55:54 -0000
@@ -270,7 +270,7 @@
         newNode = self.generateDOM(request, oldNode)
         mutator = template.NodeNodeMutator(newNode)
         mutator.d = request.d
-        mutator.generate(request, oldNode)
+        mutator.generate(request, newNode)
         self.node = newNode

     def __setitem__(self, item, value):
@@ -395,6 +395,11 @@
 class CheckBox(Input):
     def initialize(self):
         self['type'] = 'checkbox'
+    def generateDOM(self, request, node):
+        node = Input.generateDOM(self, request, node)
+        if self.getData():
+            node.setAttribute('checked', "checked")
+        return node

 class RadioButton(Input):
     def initialize(self):




From dp at twistedmatrix.com  Wed Oct  9 13:07:03 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 9 Oct 2002 10:07:03 -0700
Subject: [Twisted-Python] woven-bug: multiple nodes using the same model
In-Reply-To: <20021009143243.GA21447@soniq.net>
Message-ID: <880D7B05-DBA9-11D6-BF03-000393B3EC2C@twistedmatrix.com>

Hi,

Thanks for the bug report. I have known about this issue for a while; 
it's tricky otherwise I would have solved it by now. Here's the issue:

The Widget gets generated, and mutates the original Template node from 
the HTML template. However, it has rendered the old data.

The controller gets some input and updates the model with some new data.

The controller sends a notification to the model telling it it has 
changed, and the model forwards these notifications to all views that 
want it (Widgets)

The widget then gets re-generated, but the DOM node it works on isn't 
the same as it was in the template HTML, so funny things happen.

This is the same issue radix was seeing where a node would get a piece 
of text inserted into it multiple times.

I think the solution is for each widget to store a copy of the original 
template node, so it can operate on a fresh copy the second time; I'm 
testing this change right now. Maybe I'll even write some tests.

Donovan




From hbl at st-andrews.ac.uk  Wed Oct  9 05:06:16 2002
From: hbl at st-andrews.ac.uk (Hamish Lawson)
Date: Wed, 09 Oct 2002 10:06:16 +0100
Subject: [Twisted-Python] Quixote/Twisted Integration
Message-ID: <5.1.1.6.0.20021009100428.00b02ea0@spey.st-andrews.ac.uk>

Moshe Zadka wrote:

>I've added a feature to the Twisted web server where it can use Quixote's
>PTL.

While on matters Quixotic, what is the current state of play regarding 
using Quixote's object publishing with Twisted? Some issues were touched 
upon in the following posts. Is there now a working driver?

     http://mail.mems-exchange.org/pipermail/quixote-users/2002-June/000606.html

     http://twistedmatrix.com/pipermail/twisted-python/2002-June/001216.html


Hamish Lawson





From glyph at twistedmatrix.com  Wed Oct  9 14:19:57 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 09 Oct 2002 13:19:57 -0500 (CDT)
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021009053526.GB1130@ritsuko.xware.cx>
References: <20021008.020424.07435626.glyph@twistedmatrix.com>
	<20021008170814.GB5790@ki.yok.utu.fi>
	<20021009053526.GB1130@ritsuko.xware.cx>
Message-ID: <20021009.131957.07618741.glyph@twistedmatrix.com>


On Wed, 9 Oct 2002 15:35:26 +1000, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

> Your reason is presumably because the username/password is determined by the
> service, not the host -- but this is also the case for HTTP.  Some paths may
> require authentication, some may require none.

Not "*the* service", but "a service".  In HTTP, you authenticate with the
server, because some URLs may be in managed "realms".

In PB, some objects may require authentication to access.  This means that you
might have to authenticate multiple times in the same URL.  I know that my
suggestion for URLs violates the accepted "standard" in some ways, but that's
because PB doesn't consider "server" to be a useful level of abstraction.
Everything is about objects.

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021009/65cdc1ec/attachment.pgp 

From glyph at twistedmatrix.com  Wed Oct  9 14:44:14 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 09 Oct 2002 13:44:14 -0500 (CDT)
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021008170814.GB5790@ki.yok.utu.fi>
References: <20021008.020424.07435626.glyph@twistedmatrix.com>
	<20021008170814.GB5790@ki.yok.utu.fi>
Message-ID: <20021009.134414.07435605.glyph@twistedmatrix.com>

On Tue, 8 Oct 2002 20:08:14 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
> On Tue, Oct 08, 2002 at 02:04:24AM -0500, Glyph Lefkowitz wrote:

> > These URLs need to be able to represent transport mechanism (TCP? UNIX socket?
> > SSL? Weird firewall-tunneling stuff?)

> 	"Talk to subprocess that runs this command to connect to the other end"
> 	("ssh remotehost pbserver", "ssh remotehost
> 	connect-stdinout-to-unix-socket /path/socket")

> 	And yes, I may want that even after Twisted has a fully working
> 	SSH implementation. For rex :)

I don't quite get what you're talking about here.  You want the URLs to be
shell command-lines? :)

> 	I think you may want to look at SASL for ideas on
> 	authentication. It seems to be the standard way to add generic
> 	authentication support to a protocol these days.

>From what I can tell, it wouldn't work at all for PB.  From the RFC:

   In the case that a profile explicitly permits multiple successful SASL
   negotiations to occur, then in no case may multiple security layers be
   simultaneously in effect.  If a security layer is in effect and a subsequent
   SASL negotiation selects no security layer, the original security layer
   remains in effect.  If a security layer is in effect and a subsequent SASL
   negotiation selects a second security layer, then the second security layer
   replaces the first.

I understand that there are considerations where authentication is bound up in
link-layer security (public key crypto) but for most cases I'd like to keep
them separate so you can authenticate to multiple objects requiring different
authentication conversations in the same session.

> >     pb://pyramid/service#perspective

> 	What part talks about TCP/UNIX/etc? service? Then it needs more
> 	structure to it.

Same as with HTTP:
    pb://pyramid/service == pb-tcp://pyramid/service
    pb-ssl://pyramid/service
    pb-unix:/foo/bar://service

> >     pb://pyramid/identity:password at service#perspective

> 	Eww. Passwords in URLs is baaad. Because users like to enter URLs on
> 	command line.

> 	I'd much rather see an explicit "--password-file filename" and
> 	"--password-fd n".

Yes, and smart users will use that, for the most part.  Still, you need a way
to represent simple authentication as part of a URL.  Sometimes the URLs
themselves will be secret and the authentication information will be a swiss
number or something.  E does everything through exchange of URLs, and it's
pretty secure.

> > Public-key authentication mechanism, using the same identity name.  Connection
> > over SSH transport (sshkey auth only available this way).
> > 
> >     pb-ssl://pyramid/cert$identity at service#perspective
> > 
> > PB over SSL, using certificate auth.
> > 
> >     pb://pyramid/this/that/the-other/my-service#perspective

> 	Hmm. Idea. Allow one to specify when the server is trusted.  "Connect
> 	to server X if its public key has fingerprint F."  http://www.fs.net/

Any proposals for how to implement that?

> > [ ... ]

> >     - <img /> or <object /> tags that automatically download other items, which
> >       may be webpages containing javascript.
> > 
> > Again, don't allow these tags.  Or, have the server-side site download the
> > images and verify that they are PNGs (alternately also doing PIL stuff to
> > remove steganographic information, if you're _really_ paranoid).
> 
> 	Your basic problem here is that you are trying to disallow
> 	things you know are not safe. That assumes you are omnipotent.
                                                           ^

I assume you mean "omniscient".  If I were omnipotent, I would smite skript
kiddies with lightning from the sky, and forget about all this software-level
security :)

> 	While not contesting that, I still feel the only sane architecture is
> 	to catalogue known safe things, and only allow those. Something like a
> 	DTD/schema should do the job.

Okay, you have a point.  Still, it is useful to know which are potentially
problematic so that we can allow the usage of things like IMG with appropriate
warnings and links that remove session privileges first.

> > Even if I managed to get this right for the web, though, trying to avoid lock
> > in to the web's way of thinking about forms is very tricky!  I have yet to
> > seriously think about how GTK, PyUI, or Tkinter would work with this.  I have
> > spent a little while thinking about how a text-based virtual world interface in
> > twisted reality, though, and that should be pretty easy (building a machine
> > with dials, knobs, etc, and a big button for "submit").
> 
> 	IMHO, form-based GUIs suck horribly. A GUI is good only if
> 	it is interactive -- dynamic in some way. Most of the current
> 	GUIs only try to reach rich with forms that change
> 	dynamically.

> 	Have you ever used mc-foo fan? While certainly not the greatest GUI in
> 	the world, imagine you had to use it through forms.

Some GUIs simply don't work with forms.

On the other hand, there's a large class of GUI that does.  In fact some might
say that most of the GUIs in the world are form-based.  If forms couldn't
represent a large number of things that people want to do when interacting with
a computer, then the web would have died an early death.

> > squatting.  I think that by having a distributed naming system (where different
> > people call the "python" group different things, but python at twistedmatrix.com
> > will always get you to the one you're looking for) might circumvent squatting.

> 	So user A will see python at python.org as "python", user B will see
> 	python at twistedmatrix.com as "python", and if those two ever have to be
> 	squashed to the same namespace, user A will see "python
> 	(python at python.org)" and "python at twistedmatrix.com" and user B will see
> 	"python at python.org" and "python (python at twistedmatrix.com)"?

This is how e-mail naming works, isn't it?  User A is connecting to python.org,
user B is connecting to twistedmatrix.com.  The difference is that hosts may
provide either redirects for a certain name between each other, or relays for a
particular channel (a-la ry).

> 	This problem may be easier to think of in terms of nicks than of
> 	channels; IIRC there was some chat system that under the hood
> 	identified users with user at host (unix user id / email, whatever), but
> 	allowed them to set their list of "preferred nicknames".  User A would
> 	see user B with the first available preferred nickname from B's list,
> 	or as userB at hostB if none was available. And this was, IIRC, done fully
> 	in A's client; if B and C saw different people (were on different
> 	channels), they could see A with a different nickname.

This is an interesting idea, but it has the potential to be pretty confusing, I
think.  Tacking on an implicit domain name to channel/user names is a
convenience, but shifting around the displayed name is potentially even more
confusing.  (At least: as I understand it, I was thinking the user would type
"join python" and get a window that says "python at twistedmatrix.com"; what
you're suggesting is that the user types "join python at twistedmatrix.com" and
gets a window that says "Arglebargle!" because that is the python group's
preferred nickname? )

Thanks for the response.


-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |



From bruce at cubik.org  Wed Oct  9 15:21:19 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 09 Oct 2002 13:21:19 -0600
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
References: <20021008.020424.07435626.glyph@twistedmatrix.com>	<20021008170814.GB5790@ki.yok.utu.fi>	<20021009053526.GB1130@ritsuko.xware.cx> <20021009.131957.07618741.glyph@twistedmatrix.com>
Message-ID: <3DA481AF.6010208@cubik.org>

Glyph Lefkowitz wrote:
 > On Wed, 9 Oct 2002 15:35:26 +1000, Andrew Bennetts
 >   <andrew-twisted at puzzling.org> wrote:
 >>Your reason is presumably because the username/password is
 >>determined by the service, not the host -- but this is also
 >>the case for HTTP.  Some paths may require authentication,
 >>some may require none.
 >
 > Not "*the* service", but "a service".  In HTTP, you authenticate
 > with the server, because some URLs may be in managed "realms".
 >
 > In PB, some objects may require authentication to access.  This
 > means that you might have to authenticate multiple times in the
 > same URL.  I know that my suggestion for URLs violates the
 > accepted "standard" in some ways, but that's because PB doesn't
 > consider "server" to be a useful level of abstraction. Everything
 > is about objects.

So, have you looked at DNS Service Discovery at all and how that should 
fit in with PB?

    http://www.dns-sd.org/

  - Bruce




From bruce at cubik.org  Wed Oct  9 15:29:20 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 09 Oct 2002 13:29:20 -0600
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
References: <20021008.020424.07435626.glyph@twistedmatrix.com>	<20021008170814.GB5790@ki.yok.utu.fi> <20021009.134414.07435605.glyph@twistedmatrix.com>
Message-ID: <3DA48390.4080906@cubik.org>

Glyph Lefkowitz wrote:
> On Tue, 8 Oct 2002 20:08:14 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
>>	So user A will see python at python.org as "python", user B will see
>>	python at twistedmatrix.com as "python", and if those two ever have to be
>>	squashed to the same namespace, user A will see "python
>>	(python at python.org)" and "python at twistedmatrix.com" and user B will see
>>	"python at python.org" and "python (python at twistedmatrix.com)"?
> 
> 
> This is how e-mail naming works, isn't it?  User A is connecting to python.org,
> user B is connecting to twistedmatrix.com.  The difference is that hosts may
> provide either redirects for a certain name between each other, or relays for a
> particular channel (a-la ry).
> 
> 
>>	This problem may be easier to think of in terms of nicks than of
>>	channels; IIRC there was some chat system that under the hood
>>	identified users with user at host (unix user id / email, whatever), but
>>	allowed them to set their list of "preferred nicknames".  User A would
>>	see user B with the first available preferred nickname from B's list,
>>	or as userB at hostB if none was available. And this was, IIRC, done fully
>>	in A's client; if B and C saw different people (were on different
>>	channels), they could see A with a different nickname.
> 
> 
> This is an interesting idea, but it has the potential to be pretty confusing, I
> think.  Tacking on an implicit domain name to channel/user names is a
> convenience, but shifting around the displayed name is potentially even more
> confusing.  (At least: as I understand it, I was thinking the user would type
> "join python" and get a window that says "python at twistedmatrix.com"; what
> you're suggesting is that the user types "join python at twistedmatrix.com" and
> gets a window that says "Arglebargle!" because that is the python group's
> preferred nickname? )

To what extent should prior art and IETF work be looked at in these 
sorts of areas?

Some of the more readily obvious stuff in this area would be the IETF 
IMPP working group:

     http://www.ietf.org/html.charters/impp-charter.html

and things like Jabber, Zephyr, and so on.

  - Bruce




From bruce at cubik.org  Wed Oct  9 15:33:00 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 09 Oct 2002 13:33:00 -0600
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
References: <20021008.020424.07435626.glyph@twistedmatrix.com>	<20021008170814.GB5790@ki.yok.utu.fi> <20021009.134414.07435605.glyph@twistedmatrix.com> <3DA48390.4080906@cubik.org>
Message-ID: <3DA4846C.4000504@cubik.org>

Bruce Mitchener wrote:
> To what extent should prior art and IETF work be looked at in these 
> sorts of areas?
> 
> Some of the more readily obvious stuff in this area would be the IETF 
> IMPP working group:
> 
>     http://www.ietf.org/html.charters/impp-charter.html
> 
> and things like Jabber, Zephyr, and so on.

Ooops, I meant to include SIP in that list as well, and it probably has 
applicability to things that are going on with PB as well:

     http://www.ietf.org/html.charters/sip-charter.html

  - Bruce




From bruce at cubik.org  Wed Oct  9 19:14:57 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 09 Oct 2002 17:14:57 -0600
Subject: [Twisted-Python] web.static & woven.widgets patches
References: <20021009132500.GA29817@soniq.net>
Message-ID: <3DA4B871.4060405@cubik.org>

Hey Paul,

Paul Boehm wrote:
> i too found no unittests for woven, and my patch allows to
> check checkboxes via the model. this shouldn't break anything
> either.
> 
> can anyone give me a statement regarding those patches?

Sure, on this one I can. :)

> diff -u -r1.20 widgets.py
> --- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
> +++ widgets.py  4 Oct 2002 16:52:50 -0000
> @@ -388,13 +388,17 @@
> 
>      def generateDOM(self, request, node):
>          mVal = self.getData()
> -        if mVal:
> -            self['value'] = str(mVal)
> +        self['value'] = str(mVal)
>          return Widget.generateDOM(self, request, node)

That part is good and fixes a fairly ugly bug that I'd been seeing.

>  class CheckBox(Input):
>      def initialize(self):
>          self['type'] = 'checkbox'
> +    def generateDOM(self, request, node):
> +        node = Input.generateDOM(self, request, node)
> +        if self.getData():
> +            node.setAttribute('checked', "checked")
> +        return node

This part isn't good though ... any time the value="" is set with this, 
it'd be checked, when that isn't really the desired behavior.

For instance, in this random bit of a woven template (ignoring other 
random things that might be wrong with it):

     <table width="50%" model="products" view="List" class="summary"
        border="1" cellpadding="3" cellspacing="0">
         <tr class="listHeader">
             <th width="100%">Products</th>
             <th>Delete</th>
         </tr>
         <tr class="emptyList">
             <td align="center">*** None ***</td>
         </tr>
         <tr class="listItem">
             <td>&nbsp; &nbsp; &nbsp; <span view="ProductLink" /></td>
             <td align="center">
               <input view="CheckBox" controller="ProductDeleter"
                      model="productID" />
             </td>
         </tr>
         <tr class="listFooter">
             <td colspan="2" align="right"><input type='submit'
                 name='delproducts' value='Process deletions' /></td>
         </tr>
     </table>

that would produce a table with the right column being checkboxes .. but 
with all of them but the first one checked if the productID ranged from 
0-10.

  - Bruce




From warner at lothar.com  Wed Oct  9 20:27:13 2002
From: warner at lothar.com (Brian Warner)
Date: 09 Oct 2002 17:27:13 -0700
Subject: [Twisted-Python] PB URLs (was: Five Crazy Ideas to Start Your Week)
In-Reply-To: <20021009.134414.07435605.glyph@twistedmatrix.com>
References: <20021008.020424.07435626.glyph@twistedmatrix.com>
	<20021008170814.GB5790@ki.yok.utu.fi>
	<20021009.134414.07435605.glyph@twistedmatrix.com>
Message-ID: <87n0pnw332.fsf_-_@luther.lothar.com>

> > 	"Talk to subprocess that runs this command to connect to the other end"
> > 	("ssh remotehost pbserver", "ssh remotehost
> > 	connect-stdinout-to-unix-socket /path/socket")
> 
> I don't quite get what you're talking about here.  You want the URLs to be
> shell command-lines? :)

For what it's worth, the TRAMP emacs mode (a steroid-pumped descendent of
ange-ftp) offers something like this in its 'multi' specification (a stack of
access schemes to get to a file, like 1: telnet to a gateway machine, 2: ssh
from there to remote machine foo, 3: su to root, 4: access file). The syntax
is pretty painful, though, and you have to define the shell commands in
separate variables (indexed by keywords in the pathname).

> > 	I think you may want to look at SASL for ideas on
> > 	authentication. It seems to be the standard way to add generic
> > 	authentication support to a protocol these days.
> 
> From what I can tell, it wouldn't work at all for PB.  From the RFC:

True, SASL is one-encrypt/authenticate per TCP connection. It might make
sense to use it to protect the host-to-host link, and then let PB
authenticate users itself. I don't think it's sufficient to just use
encryption (and not authentication) on the wire.. you need the SASL
authentication layer to prevent a man-in-the-middle attack. Think of ssh's
host key here.

> Sometimes the URLs themselves will be secret and the authentication
> information will be a swiss number or something. E does everything through
> exchange of URLs, and it's pretty secure.

What's the E you refer to here?

> > 	Hmm. Idea. Allow one to specify when the server is trusted.  "Connect
> > 	to server X if its public key has fingerprint F."  http://www.fs.net/
> 
> Any proposals for how to implement that?

I looked at fs.net but wasn't able to follow most of it. The basic idea
seemed to be a URL that had both the DNS name of the server and a hash of the
server's public key. It's kind of like one of the IPv6 proposals to separate
addressing from routing: the name says how to get there, the fingerprint
tells you (after the fact) that you've reached the right spot. Makes the URLs
awfully big, though.

> Not "*the* service", but "a service".  In HTTP, you authenticate with the
> server, because some URLs may be in managed "realms".
> 
> In PB, some objects may require authentication to access. This means that
> you might have to authenticate multiple times in the same URL. I know that
> my suggestion for URLs violates the accepted "standard" in some ways, but
> that's because PB doesn't consider "server" to be a useful level of
> abstraction. Everything is about objects.

Right, so users ought to be scoped to a service? or perhaps an object
provided by a service. One potential problem: the current implementation
sends the username first, and expects to respond to a password challenge
second. Service and perspective come only after user/pass have been
validated. If user objects (Identities) are supposed to be children of the
service, the login process will probably have to change to accept a service
name first.

 -Brian



From warner at lothar.com  Wed Oct  9 20:33:29 2002
From: warner at lothar.com (Brian Warner)
Date: 09 Oct 2002 17:33:29 -0700
Subject: [Twisted-Python] Re: [Twisted-commits] added docs
In-Reply-To: <20021008234452.GG24749@modey.miralink.com>
References: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com>
	<20021008233455.GA472@toshi>
	<20021008234452.GG24749@modey.miralink.com>
Message-ID: <87it0bw2sm.fsf@luther.lothar.com>

> > I'm freaking impressed. These are some damned good docs -- thanks
> > tons.

Aw shucks. Thanks.. I'm glad you found them useful.

I'm going to try and edit them some more, make the twisted.cred examples a
bit more coherent.

Please let me know if you find ways in which they could be more helpful. I'm
trying to imagine a more "from the ground up" route to learning Twisted, and
intend to write more docs along that path. For me, the "writing servers" doc
was the best starting point, and my pb-tour doc was meant to follow that.

If you see something in twisted that you want to use but haven't figured out
how, let me know so I can add it to the list of stuff to look at.

thanks,
 -Brian



From warner at lothar.com  Wed Oct  9 20:36:42 2002
From: warner at lothar.com (Brian Warner)
Date: 09 Oct 2002 17:36:42 -0700
Subject: [Twisted-Python] jfi: twisted pygame :)
In-Reply-To: <20020927221812.GA12049@soniq.net>
References: <20020927221812.GA12049@soniq.net>
Message-ID: <87elazw2n9.fsf@luther.lothar.com>

Paul Boehm <typo at soniq.net> writes:
> took me longer to write this mail, than to convert a simple pygame
> based scrolling game to twisted + pygame. 

Cool! Could I persuade you to post a simple example of how you integrated the
event loops? I'm just starting to get into pygame; it would make multiplayer
stuff a lot easier if I could use twisted at the same time.

thanks,
 -Brian



From ericmangold at myrealbox.com  Wed Oct  9 21:24:18 2002
From: ericmangold at myrealbox.com (Eric Mangold)
Date: Wed, 09 Oct 2002 20:24:18 -0500
Subject: [Twisted-Python] Patch
Message-ID: <1034213058.c0c51500ericmangold@myrealbox.com>

Here's a tiny patch against doc/howto/listings/TwistedQuotes/pbquoteclient.py. Since 30 (the timeout) is not passed by keyword, it's taking the place of the 'client' kwarg.

-Eric Mangold (teratorn)


-------------- next part --------------
A non-text attachment was scrubbed...
Name: pbquoteclient.py.diff
Type: application/octet-stream
Size: 575 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021009/adb00c04/attachment.obj 

From typo at soniq.net  Wed Oct  9 21:35:45 2002
From: typo at soniq.net (Paul Boehm)
Date: Thu, 10 Oct 2002 03:35:45 +0200
Subject: [Twisted-Python] web.static & woven.widgets patches
In-Reply-To: <3DA4B871.4060405@cubik.org>
References: <20021009132500.GA29817@soniq.net> <3DA4B871.4060405@cubik.org>
Message-ID: <20021010013545.GA4157@soniq.net>

On Wed, Oct 09, 2002 at 05:14:57PM -0600, Bruce Mitchener wrote:
> that would produce a table with the right column being checkboxes .. but 
> with all of them but the first one checked if the productID ranged from 
> 0-10.

i think it's a weird idea to use the productid as a model for checkbox
checkedness... other suggestions?

  paul



From typo at soniq.net  Wed Oct  9 21:44:45 2002
From: typo at soniq.net (Paul Boehm)
Date: Thu, 10 Oct 2002 03:44:45 +0200
Subject: [Twisted-Python] tap security problem
In-Reply-To: <20021005.135305.55498724.glyph@twistedmatrix.com>
References: <20021005124822.GA5322@soniq.net> <20021005.135305.55498724.glyph@twistedmatrix.com>
Message-ID: <20021010014445.GB4157@soniq.net>

On Sat, Oct 05, 2002 at 01:53:05PM -0500, Glyph Lefkowitz wrote:
> On Sat, 5 Oct 2002 14:48:22 +0200, Paul Boehm <typo at soniq.net> wrote:
> > As uid/gid are part of the Application, a compromised application can write
> > a shutdown.tap with different uid/gids.
> 
> Why, in a security-conscious environment, are you allowing the uid/gid that the
> server is running as to even _read_ the .tap?  In any event, the .tap is
> effectively an SUID binary, and should be writable only by root.

why wouldn't i allow the uid/gid that the server is running at, to read the tap?
after all the the tap is nothing but a snapshot of the running application?

if twistd did setuid() etc. calls before loading the tap, this would yield
a definite improvement in security. e.g. chroot already is defined by twistd,
presumably because it too requires root privileges to be used.

> The whole notion of this automatic persistence is somewhat at odds with that of
> security - .tap persistence is very explicitly designed to have no security
> constraints whatsoever, but to be very convenient.  If you need both
> persistence and security, then you have to design your persistence mechanism to
> constrain what can be persisted.  Pickle effectively allows literal code to be
> stored and executed.

the persisted tap shouldn't allow me to do anything i couldn't do with a
hijacked application running at some uid. i don't see why i shouldn't be able
to load a tap and run it with less privileges.

as i see it, tap r/w access shouldn't be any different from application code access 
in terms of severity.

  paul



From typo at soniq.net  Wed Oct  9 21:48:41 2002
From: typo at soniq.net (Paul Boehm)
Date: Thu, 10 Oct 2002 03:48:41 +0200
Subject: [Twisted-Python] jfi: twisted pygame :)
In-Reply-To: <87elazw2n9.fsf@luther.lothar.com>
References: <20020927221812.GA12049@soniq.net> <87elazw2n9.fsf@luther.lothar.com>
Message-ID: <20021010014841.GA15896@soniq.net>

On Wed, Oct 09, 2002 at 05:36:42PM -0700, Brian Warner wrote:
> Cool! Could I persuade you to post a simple example of how you integrated the
> event loops? I'm just starting to get into pygame; it would make multiplayer
> stuff a lot easier if I could use twisted at the same time.

sure,
while it still needs lot of refining, this is a start:

# MyGame embedded in Twisted

from pygame import time
from twisted.internet import reactor

import mygame

class PygameTimer:
    def __init__(self, game):
        self.clock = time.Clock()
        self.game = game
        self.update()

    def update(self):
        self.clock.tick()
        self.ms = self.clock.get_rawtime()

        framespeed = (1.0/100.0) * 1000
        lastspeed = self.ms
        next = framespeed - lastspeed

        print "framespeed", framespeed, "ms", self.ms, "next", next, "fps", self.clock.get_fps()

        self.game.iterate()

        if self.game.want_quit:
            self.game.cleanup()
            reactor.stop()
        else:
            reactor.callLater(next/1000.0*2.0, self.update)


if __name__ == "__main__":
    pt = PygameTimer(mygame.Game())
    reactor.run()




From twisted at itamarst.org  Wed Oct  9 21:59:04 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 9 Oct 2002 21:59:04 -0400
Subject: [Twisted-Python] ANN: TwistedJava 0.6
Message-ID: <20021009215904.20f2f337.twisted@itamarst.org>

I've just released v0.6 of the Java implementation of Perspective Broker, Twisted's remote object protocol thingie.

Other than lots of clean up, refactors, and finally protocol compatability with Twisted's PB (albeit untested comptability :), it also features a policy that should allow you to use PB from Java transparently - i.e. makes calls to remote Java objects transparent. This was kindly contributed by Brandon Wiley - it's Straw, from his project Momoko (http://momoko.sourceforge.net/).

http://itamarst.org/software/twistedjava/

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From twisted at itamarst.org  Wed Oct  9 22:16:10 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 9 Oct 2002 22:16:10 -0400
Subject: [Twisted-Python] jfi: twisted pygame :)
In-Reply-To: <20021010014841.GA15896@soniq.net>
References: <20020927221812.GA12049@soniq.net>
	<87elazw2n9.fsf@luther.lothar.com>
	<20021010014841.GA15896@soniq.net>
Message-ID: <20021009221610.264cea60.twisted@itamarst.org>

On Thu, 10 Oct 2002 03:48:41 +0200
Paul Boehm <typo at soniq.net> wrote:

> > Cool! Could I persuade you to post a simple example of how you integrated the
> > event loops? I'm just starting to get into pygame; it would make multiplayer
> > stuff a lot easier if I could use twisted at the same time.
> 
> sure,
> while it still needs lot of refining, this is a start:

Do the refining and we can add it to twisted.internet.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From twisted at itamarst.org  Wed Oct  9 22:17:56 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 9 Oct 2002 22:17:56 -0400
Subject: [Twisted-Python] tap security problem
In-Reply-To: <20021010014445.GB4157@soniq.net>
References: <20021005124822.GA5322@soniq.net>
	<20021005.135305.55498724.glyph@twistedmatrix.com>
	<20021010014445.GB4157@soniq.net>
Message-ID: <20021009221756.321a27b6.twisted@itamarst.org>

On Thu, 10 Oct 2002 03:44:45 +0200
Paul Boehm <typo at soniq.net> wrote:

> as i see it, tap r/w access shouldn't be any different from application code access 
> in terms of severity.

Sure - allow reads but *NOT*!!! writes. Because if you let var-www write to python code that's going to be imported by a suid root app you're in a bad situation.

If your tap is run by root it should not be writable by non-root users.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andrew-twisted at puzzling.org  Thu Oct 10 02:17:42 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 10 Oct 2002 16:17:42 +1000
Subject: [Twisted-Python] Jelly and Components
Message-ID: <20021010061742.GA16641@ritsuko.xware.cx>

Instead of 
    class Foo(jelly.Jellyable):
        # etc

Shouldn't we be doing:
    class Foo:
        __implements__ = jelly.IJellyable
        # etc

or:
    class Foo:
        # etc
    
    components.registerAdapter(..., Foo, jelly.IJellyable)

?

This strikes me as being like copy_reg, but better :)

-Andrew.




From twisted at itamarst.org  Thu Oct 10 02:28:36 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 10 Oct 2002 02:28:36 -0400
Subject: [Twisted-Python] Jelly and Components
In-Reply-To: <20021010061742.GA16641@ritsuko.xware.cx>
References: <20021010061742.GA16641@ritsuko.xware.cx>
Message-ID: <20021010022836.150fed28.twisted@itamarst.org>

On Thu, 10 Oct 2002 16:17:42 +1000
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

>     class Foo:
>         # etc
>     
>     components.registerAdapter(..., Foo, jelly.IJellyable)

TwistedJava already does this, and booleans. For once I'm ahead :)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From hbl at st-andrews.ac.uk  Thu Oct 10 11:11:07 2002
From: hbl at st-andrews.ac.uk (Hamish Lawson)
Date: Thu, 10 Oct 2002 16:11:07 +0100
Subject: [Twisted-Python] Quixote/Twisted Integration
Message-ID: <5.1.1.6.0.20021010160932.00aa8398@spey.st-andrews.ac.uk>

Moshe Zadka wrote:

>I've added a feature to the Twisted web server where it can use Quixote's
>PTL.

While on matters Quixotic, what is the current state of play regarding 
using Quixote's object publishing with Twisted? Some issues were touched 
upon in the following posts. Does anyone know if there is there now a 
working driver to let Twisted call Quixote?

     http://mail.mems-exchange.org/pipermail/quixote-users/2002-June/000606.html

     http://twistedmatrix.com/pipermail/twisted-python/2002-June/001216.html


Hamish Lawson





From jbauer at rubic.com  Thu Oct 10 16:59:12 2002
From: jbauer at rubic.com (Jeff Bauer)
Date: Thu, 10 Oct 2002 15:59:12 -0500
Subject: [Twisted-Python] New web project
Message-ID: <3DA5EA20.10192495@rubic.com>

My first post to the TwistedMatrix list. ;-)

By way of introduction, I worked on Persistent CGI
for Bobo, Digital Creations' precursor to Zope.
I'm still using a modified version of Bobo/PCGI
under Apache for current applications and would like
to consider switching to Twisted.

Let me first say that I'm very impressed with the
Twisted framework.  Although I've not written any
servers yet, I was able to get a secure SSL web
service running soon after I downloaded the code.
(Someone please remind me to write a quick How-To.)

What follows is a description of how I'd like to use
Twisted.  A Use Case, as it were.  I'm specifically
solicting responses of the kind:

R1: "That's already a standard idiom in Twisted."

R2: "You can already do that in Twisted, but it
     may not be obvious.  Here's how: ..."

R3: "You *could* do that, but here's a better
    approach ..."

R4: "Twisted doesn't presently support that
    function, but here's what would be required
    to provide it ..."

---

Actors:  User, User-session, Facility

1. Each Facility would be handled by a single
   long running process (LRP).  Currently we
   handle each User-session in an LRP, which
   actually simplifies session management
   somewhat, but makes other things at the
   application level more complicated.

2. Users would access their facility via URLs
   of this kind:

   http[s]://facility1.site.com
   http[s]://facility2.site.com

   Twisted would dispatch this traffic to the
   appropriate Facility LRP, which is effectively
   a Twisted web server.  Each server (Facility) is 
   running on a different port.

3. Users would be authenticated in a manner
   similar to Apache's htpasswd mechanism,
   and a User-session is created.  Currently, 
   since all session work occurs under SSL, I have
   access to the REMOTE-USER environment variable.

4. I presently drop a Cookie in the User's browser
   representing the ID of the User-Session.  From
   reading Itamar's posting (Dec 17 2001), I gather
   that I should consider sessions rather than
   cookies.

Thanks in advance for any replies.

Jeff Bauer
Rubicon Research



From dp at twistedmatrix.com  Thu Oct 10 17:39:24 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Thu, 10 Oct 2002 14:39:24 -0700
Subject: [Twisted-Python] New web project
In-Reply-To: <3DA5EA20.10192495@rubic.com>
Message-ID: <BED6A678-DC98-11D6-B8B3-000393B3EC2C@twistedmatrix.com>

On Thursday, October 10, 2002, at 01:59 PM, Jeff Bauer wrote:

>
> Actors:  User, User-session, Facility
>
> 1. Each Facility would be handled by a single
>    long running process (LRP).  Currently we
>    handle each User-session in an LRP, which
>    actually simplifies session management
>    somewhat, but makes other things at the
>    application level more complicated.

One way to handle this would be to have Apache do a ProxyPass in a 
VirtualHost directive to Twisted instances running on different ports. 
I do this where I work, and it works very well.

A better way to do it is with twisted.web.vhost.NameVirtualHost. I have 
not used this, but it occurs to me I should, because looking at the 
code it really is very simple. However, since you also have the 
requirement that each Facility be it's own LRP, you may also need to 
learn about twisted.web.distrib if you go this route. I will defer to 
someone who knows more about vhost and distrib on this one.

<snip -- someone who knows more about distrib and authentication please 
reply>

>
> 4. I presently drop a Cookie in the User's browser
>    representing the ID of the User-Session.  From
>    reading Itamar's posting (Dec 17 2001), I gather
>    that I should consider sessions rather than
>    cookies.

Sessions are implemented behind the scenes as a cookie. Since it is 
very simple to request a session from the request object 
(request.getSession()), and it handles the cookies for you, I recommend 
doing that.

Hope this helps a little!

Donovan




From glyph at twistedmatrix.com  Thu Oct 10 18:11:49 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 10 Oct 2002 17:11:49 -0500 (CDT)
Subject: [Twisted-Python] Jelly and Components
In-Reply-To: <20021010061742.GA16641@ritsuko.xware.cx>
References: <20021010061742.GA16641@ritsuko.xware.cx>
Message-ID: <20021010.171149.41195716.glyph@twistedmatrix.com>

On Thu, 10 Oct 2002 16:17:42 +1000, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> Shouldn't we be doing:
>     class Foo:
>         __implements__ = jelly.IJellyable
>         # etc

Yes.  I was originally going to save this for next week's "five crazy things"
email :), but that's the plan.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021010/16fa0814/attachment.pgp 

From robert at vaccaperna.co.uk  Thu Oct 10 18:58:27 2002
From: robert at vaccaperna.co.uk (Robert Cowham)
Date: Thu, 10 Oct 2002 23:58:27 +0100
Subject: [Twisted-Python] RE: WebDAV Server
In-Reply-To: <20021010.171149.41195716.glyph@twistedmatrix.com>
Message-ID: <PJEEINAIADEEJBLOMLGIGEBHCMAA.robert@vaccaperna.co.uk>

A quick search of the archives turns up this topic occasionally, but without
any resolution....

Anyone working on support for this??

Robert




From dstone at kde.org  Thu Oct 10 21:01:00 2002
From: dstone at kde.org (Daniel Stone)
Date: Fri, 11 Oct 2002 11:01:00 +1000
Subject: [Twisted-Python] RE: WebDAV Server
In-Reply-To: <PJEEINAIADEEJBLOMLGIGEBHCMAA.robert@vaccaperna.co.uk>
References: <20021010.171149.41195716.glyph@twistedmatrix.com> <PJEEINAIADEEJBLOMLGIGEBHCMAA.robert@vaccaperna.co.uk>
Message-ID: <20021011010100.GB5303@trinity.unimelb.edu.au>

On Thu, Oct 10, 2002 at 11:58:27PM +0100, Brother Robert Cowham preached da werd, yo:
> A quick search of the archives turns up this topic occasionally, but without
> any resolution....
> 
> Anyone working on support for this??

Yes. :)

I'm working on MoulDAVia, which will be a flexible, extensible and cool
WebDAV server, with a Twisted frontend.

-- 
Daniel Stone 	     <daniel at raging.dropbear.id.au>             <dstone at kde.org>
Developer - http://kopete.kde.org, http://www.kde.org
Proof BitMover are community-focussed:
http://marc.theaimsgroup.com/?l=linux-kernel&m=103384262016750&w=2



From jml at mumak.net  Fri Oct 11 00:49:05 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Fri, 11 Oct 2002 15:49:05 +1100
Subject: [Twisted-Python] Re: [Twisted-commits] added docs
In-Reply-To: <87it0bw2sm.fsf@luther.lothar.com>
References: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com> <20021008233455.GA472@toshi> <20021008234452.GG24749@modey.miralink.com> <87it0bw2sm.fsf@luther.lothar.com>
Message-ID: <20021011044905.GB27254@mumak.net>

On Wed, Oct 09, 2002 at 05:33:29PM -0700, Brian Warner wrote:
> I'm trying to imagine a more "from the ground up" route to learning 
> Twisted, and intend to write more docs along that path. 
> 
> If you see something in twisted that you want to use but haven't figured out
> how, let me know so I can add it to the list of stuff to look at.
> 

I've got a few suggestions, but they are more brain-storming ideas than
well thought out requests...

I really wouldn't mind seeing some docs about twisted.python.
I think that something describing the common patterns in twisted would
help a lot with someone who was learning from the ground up.

It would also make some of the existing example code (and maybe Woven?)
clearer. (e.g. The plugins doc has code that uses __implements__)

Also, do there need to be any end-developer docs for coil?

While I'm making wishes, a guided tour of a single, mildly complex
twisted application would be really nice. 


cheers,
jml


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021011/34312516/attachment.pgp 

From sean at twistedmatrix.com  Sat Oct 12 21:30:27 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Sat, 12 Oct 2002 20:30:27 -0500
Subject: [Twisted-Python] traceback?
Message-ID: <HOEEKPCOKELHCNIJNMAGGEEHCHAA.sean@twistedmatrix.com>

hm.... this doesn't look good.. what does this mean?

Unhandled error in Deferred:
Traceback (most recent call last):
Eek!  <twisted.python.failure.Failure twisted.spread.pb.PBConnectionLost>
has no frames in traceback!
  File ".\twisted\internet\default.py", line 234, in mainLoop

  File ".\twisted\internet\default.py", line 521, in doSelect

  File "c:\ninja\Projects\Twisted\twisted\internet\tcp.py", line 142, in
connectionLost
    protocol.connectionLost(reason)
  File "c:\ninja\Projects\Twisted\twisted\spread\pb.py", line 543, in
connectionLost
    d.errback(failure.Failure(PBConnectionLost()))
--- <exception caught here> ---
twisted.spread.pb.PBConnectionLost:


----------------
"If he's so smart, then how come he's dead?", Homer Simspon
Sean Riley
sean at ninjaneering.com




From twisted at itamarst.org  Sat Oct 12 22:17:21 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 12 Oct 2002 22:17:21 -0400
Subject: [Twisted-Python] twisted.persisted.journal: a prevayler-inspired persistence system
Message-ID: <20021012221721.15133eeb.twisted@itamarst.org>

I've just checked in Journal, a persistence system inspired by Prevayler (http://www.prevayler.org for details). The idea is basically that all interactions with the system are done via serializable commands objects, which are logged *before* they execute. This allows us to keep down number of transactions in the system since in the worst case, the system can be restored by running the logged commands.

Additional benefits include being able to rerun sessions for testing performances, changing the internal data model is easy (just delete snapshot of system state and rerun all commands against new codebase), and so on.

This is an alternative to the immutable database model of keeping old versions of data - instead, we keep a log of all state changing commands (or even queries - useful for cases when you need to keep track of every read to the system).

The main difference from prevayler is flexibility - while I do support the "everything in memory" model, I also have code for using RDBMS for storage as well, using twisted.enterprise.row. In the future journal will support logging commands to a RDBMS as well, allowing you to easily gather statistics about everything that has ever been done to your system. The RDBMS code is untested.

Plugging the code into any persistence mechanism for snapshotting purposes should be possible, e.g. you could use ZODB as well. However some will be more suited than others - t.e.row is pretty good since it doesn't require a transaction for each command executed.

Example of using the system (with memory snapshotting and pickle based log):
http://www.twistedmatrix.com/users/jh.twistd/viewcvs/cgi/viewcvs.cgi/twisted/test/test_journal.py?rev=1.1&content-type=text/vnd.viewcvs-markup&cvsroot=Twisted

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andrew-twisted at puzzling.org  Sun Oct 13 00:08:37 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 13 Oct 2002 14:08:37 +1000
Subject: [Twisted-Python] OS X and setup.py
Message-ID: <20021013040837.GA857@frobozz.local>

This part of setup.py is breaking build_ext on OS X (which doesn't have
poll):

if os.name == "posix":
    setup_args['ext_modules'].append(
        Extension("twisted.internet.cReactor",
              glob('twisted/internet/cReactor/*.c'),
              define_macros=define_macros))
    
That's from the bottom of setup.py.  It completely ignores the
_detect_modules thing.  It reports "The C reactor is unavailable on this
system" -- then tries to build it anyway.  Disabling that code fragment
fixes the problem.

A comment suggests that code is needed to make sdist work... would someone
like to figure out how to make this work correctly?

-Andrew.




From andrew-twisted at puzzling.org  Sun Oct 13 00:10:48 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 13 Oct 2002 14:10:48 +1000
Subject: [Twisted-Python] OS X and setup.py
In-Reply-To: <20021013040837.GA857@frobozz.local>
References: <20021013040837.GA857@frobozz.local>
Message-ID: <20021013041048.GB857@frobozz.local>

On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
> This part of setup.py is breaking build_ext on OS X (which doesn't have
> poll):

My OS X informant also says:
<Screwtape> Better test it on another OS X system, too.
<Screwtape> This one might be a little damaged.
<Screwtape> (i.e. it has a manpage for poll(), but no header file)

-Andrew.




From glyph at twistedmatrix.com  Sun Oct 13 02:26:52 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 13 Oct 2002 01:26:52 -0500 (CDT)
Subject: [Twisted-Python] twisted.persisted.journal: a
 prevayler-inspired persistence system
In-Reply-To: <20021012221721.15133eeb.twisted@itamarst.org>
References: <20021012221721.15133eeb.twisted@itamarst.org>
Message-ID: <20021013.012652.78706997.glyph@twistedmatrix.com>


On Sat, 12 Oct 2002 22:17:21 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> I've just checked in Journal, a persistence system inspired by Prevayler
> (http://www.prevayler.org for details). The idea is basically that all
> interactions with the system are done via serializable commands objects,
> which are logged *before* they execute. This allows us to keep down number of
> transactions in the system since in the worst case, the system can be
> restored by running the logged commands.

Seems like it would be pretty easy to create persistently-loggable objects for
non-deterministic events (like the "time", and "random" modules) in Python.  In
order to do that you'd need to modify your implementation to provide a default
"Command" base class so that non-deterministic events could be logged
automatically as sub-events.  Any reason that you wouldn't want to do that?
(If you don't want to pollute client code with inheritance, the default
implementation could just have a reference to a delegate ICommmand
implementor.)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021013/e3c1ee49/attachment.pgp 

From twisted at itamarst.org  Sun Oct 13 02:44:05 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 13 Oct 2002 02:44:05 -0400
Subject: [Twisted-Python] twisted.persisted.journal: a prevayler-inspired persistence system
In-Reply-To: <20021013.012652.78706997.glyph@twistedmatrix.com>
References: <20021012221721.15133eeb.twisted@itamarst.org>
	<20021013.012652.78706997.glyph@twistedmatrix.com>
Message-ID: <20021013024405.5be04806.twisted@itamarst.org>

On Sun, 13 Oct 2002 01:26:52 -0500 (CDT)
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> Seems like it would be pretty easy to create persistently-loggable
> objects for non-deterministic events (like the "time", and "random"
> modules) in Python.  In order to do that you'd need to modify your
> implementation to provide a default"Command" base class so that
> non-deterministic events could be logged automatically as sub-events. 
> Any reason that you wouldn't want to do that?(If you don't want to
> pollute client code with inheritance, the default implementation could
> just have a reference to a delegate ICommmand implementor.)

Prevayler has something like that where you have Clock passed to
commands, IIRC. I probably should add some code so commands can get a
"fake" time, i.e. the time they were supposed to have been run. Not sure
that randomness is worth doing - if you are using it presumably any
outcome is equally valid, or alternatively if that's not that case you
can't really use journal anyway.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andy at reportlab.com  Sun Oct 13 04:02:13 2002
From: andy at reportlab.com (Andy Robinson)
Date: Sun, 13 Oct 2002 09:02:13 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021012221721.15133eeb.twisted@itamarst.org>
Message-ID: <LKENLBBMDHMKBECHIAIAGEHFCMAA.andy@reportlab.com>

Hi everyone,

Some tiny pointers on "first impressions" about the docs..
This is in no way intended as criticism - it would just be
nice to iron out any glitches in 'getting started' 
instructions before you get to Version 1.0. IMHO it's really 
important that the first 15 minutes after downloading something 
for the first time go really well; a lot of people won't look 
at the source if the examples don't run. 

First: I tried the windows installer, could not get twistd 
or coil working, tried the source version and figured it out. 
You have an 'admin' directory in the source distro, but these 
are not in the Windows distro.  Equivalents are in the 'scripts' 
directory. Once I added 

  if __name__=='__main__':
      run()

to the end of coil.py and twistd.py, the rest of the instructions
were fine.  I suggest adding the script handlers and
mentioning this in installing-twisted.html and
using-twistedweb.html.

Second: why not include the 'doc' directory or examples in
the Windows EXE?  I know you want to keep it small but at
least the basic HOWTO.  If not, have a 'doc' directory with 
a readme pointing at a separate download containing docco
and examples.

Third:  I think there needs to be a prominent paragraph
in the 'End-Users' and 'download' pages telling Windows
users what to do or what not to do differently.  I also suspect
there's a bunch of other Windows-specific things which might
make a page of information somewhere.  

 I have two staff whose minds are not yet twisted and 
who are as ignorant as me about networking; I can volunteer them
as "usability testers" if this helps.  


My dumb questions about Twisted itself will follow separately :-)

Andy Robinson
ReportLab




From twisted at moshez.org  Fri Oct 11 23:36:10 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 03:36:10 -0000
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAGEHFCMAA.andy@reportlab.com>
References: <LKENLBBMDHMKBECHIAIAGEHFCMAA.andy@reportlab.com>
Message-ID: <20021012033610.28948.qmail@green.zadka.com>

First let me begin by saying that the windows installer probably works pretty
badly because almost nobody uses it, so your comments are probably very valuable
to whomever does the windows installer (glyph?). Thus all my advice from
here onwards will pertain to the source distribution.

On Sun, 13 Oct 2002, "Andy Robinson" <andy at reportlab.com> wrote:

> First: I tried the windows installer, could not get twistd 
> or coil working, tried the source version and figured it out. 
> You have an 'admin' directory in the source distro

The admin/ directory contains stuff for the Twisted developers, not
for twisted users.
 
> , but these 
> are not in the Windows distro.  Equivalents are in the 'scripts' 
> directory. Once I added 
> 
>   if __name__=='__main__':
>       run()

This is bad :)
Check out the stuff in the bin/ directory.
In general, assume you you don't need to change stuff to get Twisted
to work :)

Until Twisted fixes its windows installer, please try (and recommend
to your co-workers to try) the source distribtion (yes, I realize that
installing-twisted.html says otherwise)



From andy at reportlab.com  Sun Oct 13 06:08:04 2002
From: andy at reportlab.com (Andy Robinson)
Date: Sun, 13 Oct 2002 11:08:04 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021012033610.28948.qmail@green.zadka.com>
Message-ID: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>

> > are not in the Windows distro.  Equivalents are in the 'scripts' 
> > directory. Once I added 
> > 
> >   if __name__=='__main__':
> >       run()
> 
> This is bad :)
> Check out the stuff in the bin/ directory.

I would have done if it was included in the Windows distro :-)
If you include it as is, it still will not work on Windows. If you
make them end in .py, then someone who ran the default Windows
Python installation would just be able to execute them, but
without an extension they will need to type 'python' in front.

I don't know enough about distutils to know if this can be
fixed post-install, but I expect to be learning over the next
2 months; we haven't even made a distutils setup.py for our
package yet.  And we will have exactly the same issues.

BTW I fully support separating the "kick off" script from
the functionality.  We're working a lot on things like McMillan
installers, so an app or distro can be shipped as one .pyz
file which works on all platforms.  Sysadmins in big companies
like one-file apps a lot!  This means putting scripts/docs/examples 
outside the code archive, exactly as you have done.  


> In general, assume you you don't need to change stuff to get Twisted
> to work :)

A noble goal for any product :-)
In general it works extremely well and the docco is excellent.


> Until Twisted fixes its windows installer, please try (and recommend
> to your co-workers to try) the source distribtion (yes, I realize that
> installing-twisted.html says otherwise)

Actually I will try to keep them slaving away on other stuff;
testers for installation routines are only useful once, or
maybe twice if they have really short memories :-)



Thanks,

Andy






From twisted at moshez.org  Sat Oct 12 01:12:20 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 05:12:20 -0000
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
References: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
Message-ID: <20021012051220.30157.qmail@green.zadka.com>

On Sun, 13 Oct 2002, "Andy Robinson" <andy at reportlab.com> wrote:

> I would have done if it was included in the Windows distro :-)

I refer you again to my opening comments: we need exactly this kind of
feedback. I've given you workarounds :)

> If you include it as is, it still will not work on Windows. If you
> make them end in .py, then someone who ran the default Windows
> Python installation would just be able to execute them, but
> without an extension they will need to type 'python' in front.

Yes, I know.
I'm sure someone will work on fixing it (I can't, as I have no access
to windows boxes).

> Actually I will try to keep them slaving away on other stuff;
> testers for installation routines are only useful once, or
> maybe twice if they have really short memories :-)

I misread you to think they were going to be testers for our Twisted
documentation stuff, my bad. Which brings me to my next point: any comments
about the documentation (especially hidden assumptions we make and/or documents
which you wanted and didn't find) would be greatly appreciated.



From twisted at moshez.org  Sat Oct 12 01:13:31 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 05:13:31 -0000
Subject: [Twisted-Python] Documentation
Message-ID: <20021012051331.30177.qmail@green.zadka.com>

Looking through http://twistedmatrix.com/documents/howto/book I've noticed
two things:
1. It contains references to chapters which seem redundant (Deferred examples?
   basic examples should be in the deferred howto and more complicated examples
   will be sprinkled through almost every other howto)
2. It does not link to current things which we do have (the single most used
   t.python feature is usage, which is howtoed, except for maybe log. However
   it is somewhat embarassing to spend a whole document to say 
   "use log.msg(*args), and it will be just like print except it goes to the
   logfile :)

So, basically, I think the sitution for documentation is, in fact, much
better than what .../book would lead us to believe. Would anyone volunteer
to rewrite "book" into something more realistic which is actually useful?
I'd volunteer myself, if the book maintainer gave me permission :)



From twisted at moshez.org  Sat Oct 12 01:58:41 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 05:58:41 -0000
Subject: [Twisted-Python] More About Documentation
Message-ID: <20021012055841.30686.qmail@green.zadka.com>

I have a new version of the book in http://twistedmatrix.com/users/moshez/book.xhtml.
Please let me know of any problems, I'm thinking of checking it in soon. 




From screwtape at froup.com  Sun Oct 13 10:42:33 2002
From: screwtape at froup.com (Tim Allen)
Date: Mon, 14 Oct 2002 00:42:33 +1000
Subject: [Twisted-Python] Patch for extra IRC events.
Message-ID: <0288BCD1-DEBA-11D6-88F9-003065D61A3E@froup.com>

Here's a patch that makes the IRC protocol notice a few more events, and 
also keeps a record of the MOTD in case we want to refer to it later.

All the advertised features seem to work on Slashnet.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: twisted-irc.diff
Type: application/octet-stream
Size: 5799 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021014/037c78f6/attachment.obj 

From tv at twistedmatrix.com  Sun Oct 13 13:29:40 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Sun, 13 Oct 2002 20:29:40 +0300
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021009.134414.07435605.glyph@twistedmatrix.com>
References: <20021008.020424.07435626.glyph@twistedmatrix.com> <20021008170814.GB5790@ki.yok.utu.fi> <20021009.134414.07435605.glyph@twistedmatrix.com>
Message-ID: <20021013172940.GA21867@ki.yok.utu.fi>

On Wed, Oct 09, 2002 at 01:44:14PM -0500, Glyph Lefkowitz wrote:
> > > These URLs need to be able to represent transport mechanism (TCP? UNIX socket?
> > > SSL? Weird firewall-tunneling stuff?)
> 
> > 	"Talk to subprocess that runs this command to connect to the other end"
> > 	("ssh remotehost pbserver", "ssh remotehost
> > 	connect-stdinout-to-unix-socket /path/socket")
> 
> > 	And yes, I may want that even after Twisted has a fully working
> > 	SSH implementation. For rex :)
> 
> I don't quite get what you're talking about here.  You want the URLs to be
> shell command-lines? :)

	Let's try with an example. My IMAP mail fetcher talks to my
	IMAP server by SSHing in and running a certain command.
	Now, s/IMAP/PB/, and I still want that to be easy. The only
	choices I see are splitting out the "connection establishment"
	from the software that talks PB
	(e.g. http://cr.yp.to/proto/ucspi.txt), or allow me to say
	"open connection there by running this command and talking to
	it".

> > >     pb://pyramid/identity:password at service#perspective
> > 	Eww. Passwords in URLs is baaad. Because users like to enter URLs on
> > 	command line.
> 
> > 	I'd much rather see an explicit "--password-file filename" and
> > 	"--password-fd n".
> 
> Yes, and smart users will use that, for the most part.  Still, you need a way
> to represent simple authentication as part of a URL.  Sometimes the URLs
> themselves will be secret and the authentication information will be a swiss
> number or something.  E does everything through exchange of URLs, and it's
> pretty secure.

	So, you need to specify "ask me this password with this mechanism",
	e.g. get the first password from fd 5 and second from fd 6. How
	does that fit in the URL, or does it?

> > > Public-key authentication mechanism, using the same identity name.  Connection
> > > over SSH transport (sshkey auth only available this way).
> > > 
> > >     pb-ssl://pyramid/cert$identity at service#perspective
> > > 
> > > PB over SSL, using certificate auth.
> > > 
> > >     pb://pyramid/this/that/the-other/my-service#perspective
> 
> > 	Hmm. Idea. Allow one to specify when the server is trusted.  "Connect
> > 	to server X if its public key has fingerprint F."  http://www.fs.net/
> 
> Any proposals for how to implement that?

	Similar to what SSH already does; stores the fingerprint in a file.
	Use the one given in the URL just like it would have been read from
	known_hosts. Same can apply for SSL, etc.

-- 
:(){ :|:&};:



From itamar at itamarst.org  Sun Oct 13 02:05:37 2002
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 13 Oct 2002 02:05:37 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] Added utility-method getProccessOutput to IReactorProcess, and implemented in default.PosixReactorBase.
In-Reply-To: <E180R2b-0000nA-00@pyramid.twistedmatrix.com>
References: <E180R2b-0000nA-00@pyramid.twistedmatrix.com>
Message-ID: <20021013020537.00c93241.itamar@itamarst.org>

On Sat, 12 Oct 2002 13:31:09 -0500
radix CVS <radix at twistedmatrix.com> wrote:


> Should this not be in the interface, and instead be in a utility
> module? I vote for interface by way of commit :-)

No, this should not be in the interface. Move it somewhere else.



From glyph at twistedmatrix.com  Sun Oct 13 16:49:55 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 13 Oct 2002 15:49:55 -0500 (CDT)
Subject: [Twisted-Python] More About Documentation
In-Reply-To: <20021012055841.30686.qmail@green.zadka.com>
References: <20021012055841.30686.qmail@green.zadka.com>
Message-ID: <20021013.154955.126758322.glyph@twistedmatrix.com>


On 12 Oct 2002 05:58:41 -0000, Moshe Zadka <twisted at moshez.org> wrote:
> I have a new version of the book in http://twistedmatrix.com/users/moshez/book.xhtml.
> Please let me know of any problems, I'm thinking of checking it in soon. 

Looks good to me: as I'm the book.html "maintainer" I guess that's as good as
you'll get :).  There are a few minor tweaks I may make once you check it in.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021013/e801a854/attachment.pgp 

From glyph at twistedmatrix.com  Sun Oct 13 17:11:04 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 13 Oct 2002 16:11:04 -0500 (CDT)
Subject: [Twisted-Python] twisted.persisted.journal: a
 prevayler-inspired persistence system
In-Reply-To: <20021013024405.5be04806.twisted@itamarst.org>
References: <20021012221721.15133eeb.twisted@itamarst.org>
	<20021013.012652.78706997.glyph@twistedmatrix.com>
	<20021013024405.5be04806.twisted@itamarst.org>
Message-ID: <20021013.161104.89043483.glyph@twistedmatrix.com>


On Sun, 13 Oct 2002 02:44:05 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> Prevayler has something like that where you have Clock passed to commands,
> IIRC. I probably should add some code so commands can get a "fake" time,
> i.e. the time they were supposed to have been run. Not sure that randomness
> is worth doing - if you are using it presumably any outcome is equally valid,
> or alternatively if that's not that case you can't really use journal anyway.

Not in the case of a game: certain events have "random" outcomes, weighted
randomness based on a die roll plus some skill modifiers and so forth.  You can
still use object prevalence to persist this information, but you need the die
rolls associated with a certain action to be the same the second time through.
(IIRC in the Prevayler model, you're supposed to use a deterministic hash
ordering method so that you don't accidentally have any code that depends on
the order of a dictionary's keys, either...)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021013/b3b7238c/attachment.pgp 

From glyph at twistedmatrix.com  Sun Oct 13 17:23:12 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 13 Oct 2002 16:23:12 -0500 (CDT)
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
References: <20021012033610.28948.qmail@green.zadka.com>
	<LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
Message-ID: <20021013.162312.111208639.glyph@twistedmatrix.com>


On Sun, 13 Oct 2002 11:08:04 +0100, "Andy Robinson" <andy at reportlab.com> wrote:
> > Check out the stuff in the bin/ directory.

> I would have done if it was included in the Windows distro :-) If you include
> it as is, it still will not work on Windows. If you make them end in .py,
> then someone who ran the default Windows Python installation would just be
> able to execute them, but without an extension they will need to type
> 'python' in front.

I don't understand Microsoft's "DOS Shell" scripting language too well, but I
think "execute" means something misleading in this context,
i.e. "double-click".  Since most of the Twisted main scripts don't have a GUI,
when you "run" them in the explorer, a black DOS box comes up and disappears.

Is there some way to make it so that these commands are accessible via the
user's %PATH% at a DOS prompt, regardless of distutils?  The only technique
I've found involves Cygwin and that was pretty nasty.

> I don't know enough about distutils to know if this can be fixed
> post-install, but I expect to be learning over the next 2 months; we haven't
> even made a distutils setup.py for our package yet.  And we will have exactly
> the same issues.

The real problem is that these tools don't have a GUI and that doesn't mesh
very well with the Windows way of being.  A simple GUI for running/making
TA[SPX] files with Tkinter has been on the "that would be nice" TODO list for
some time, but so few Twisted developers use Windows on a regular basis that it
never seems to get done...

FWIW I don't think it's possible to do run any post-installation code on win32
with distutils.  I haven't looked in depth for a while, but I haven't heard
news of this being fixed, either.

> BTW I fully support separating the "kick off" script from the functionality.
> We're working a lot on things like McMillan installers, so an app or distro
> can be shipped as one .pyz file which works on all platforms.  Sysadmins in
> big companies like one-file apps a lot!  This means putting
> scripts/docs/examples outside the code archive, exactly as you have done.

Yes.  I'm glad you see the utility in doing this.  I also strongly agree with
you that the Twisted experience needs to be positive within the first fifteen
minutes of the download, and it bothers me that the Windows installer is not in
very good shape.  (Have you tried the debian install though?  It's smooooth
^_^)

> > Until Twisted fixes its windows installer, please try (and recommend to
> > your co-workers to try) the source distribtion (yes, I realize that
> > installing-twisted.html says otherwise)

> Actually I will try to keep them slaving away on other stuff; testers for
> installation routines are only useful once, or maybe twice if they have
> really short memories :-)

Well, if your testers are sysadmins they tend to be irritated by the
installation problems a lot more often.  Trouble is that sysadmins rarely
install server frameworks on their own...

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021013/d9884ca3/attachment.pgp 

From andy at reportlab.com  Sun Oct 13 18:57:40 2002
From: andy at reportlab.com (Andy Robinson)
Date: Sun, 13 Oct 2002 23:57:40 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021013.162312.111208639.glyph@twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAGEHNCMAA.andy@reportlab.com>

I'll try to help with any windows issues I can...ReportLab
are starting to face exactly the same things with packaging
up our commercial products, except we have not really braved
distutils yet. I can see from your setup script that you
have :-)  Nobody on the SIG ever answered any of my questions
so I guess I can learn from you here too...

> I don't understand Microsoft's "DOS Shell" scripting language too
> well, but I
> think "execute" means something misleading in this context,
> i.e. "double-click".  Since most of the Twisted main scripts
> don't have a GUI,
> when you "run" them in the explorer, a black DOS box comes up and
> disappears.

Windows uses file extensions rather than marking scripts
executable, and things like "#!/usr/bin/env python" mean
nothing to it.

You can either type the command line in a DOS box, or double-click
it. If you double-click and a traceback occurs, you won't get to
read it.  It's pretty much understood that for things like web servers,
scripting languages and databases one has to use the DOS prompt
and there will be a bunch of commands to administer the server,
just like on Unix.  The DOS shell in Windows 2000 is very pleasant,
readline-ish, with auto-completion and a host of commands, and any Python
programmer will certainly be used to it.

> Is there some way to make it so that these commands are accessible via the
> user's %PATH% at a DOS prompt, regardless of distutils?  The only
> technique I've found involves Cygwin and that was pretty nasty.

Python is not on the path by default (but see 2 below). As I see it
you've got 3-4 choices on such scripts.
1. If the file has no extension, like your current scripts, you can
still execute it by doing
    python myscript
(assuming Python is on the path).  But it's not intuitive what to
do with a file that lacks an extension.

2. If the file ends in .py, then Windows knows it's a python script
as the .py extension was 'associated' with python.exe when Python
was installed.  You can then run by using its name:

C:\Python22\Lib\site-packages\twisted\scripts>mktap.py web --path
c:\\code\\www_reportlab_com
Saving web application to web.tap...
Saved.

Just like Unix - well, nearly.

3. If a file ends in .bat you can execute it and it's assumed to
have Windows' fairly poor batch language.  There is a horrible
hack to hide Python scripts in batch files, but it's REALLY
horrible.  You could also make a batch file call a Python script,
but it's unusual and pointless since you need the Python script
anyway.

4. If you're devilishly cunning you can make 'stub EXEs', using
a partial binary, and they can be assembled on Unix.  Our commercial
download has a 'bin' directory containing a tiny 'rml2pdf.exe' which
just imports and runs the content of rlextra/rml2pdf/rml2pdf.py(c).

The real problem, of course, is what distutils does now.  I don't
know if it has a post-install hook.  If it does, then you could
do
  if sys.platform == 'win32':
      for filename in os.listdir('bin'):
          os.rename(filename, filename + '.py')

If not, I wonder if you can do that when making the package?
This would instantly make sure that they were executable
and also obviously recognizable.

>
> FWIW I don't think it's possible to do run any post-installation
> code on win32
> with distutils.  I haven't looked in depth for a while, but I
> haven't heard
> news of this being fixed, either.
Doh, there goes that idea then.

> Yes.  I'm glad you see the utility in doing this.  I also
> strongly agree with
> you that the Twisted experience needs to be positive within the
> first fifteen
> minutes of the download, and it bothers me that the Windows
> installer is not in
> very good shape.  (Have you tried the debian install though?
> It's smooooth
> ^_^)

Unfortunately my various attempts to install Linux have all
failed horribly, usually with graphics drivers and after a lot more
than 15 minutes :-).  I still use Windows on my desktop.  We use
FreeBSD on our servers and Solaris at most customer sites, but only
'as servers'. My Linux knowledge is bound to be worse that yours of
Windows :-)

> Well, if your testers are sysadmins they tend to be irritated by the
> installation problems a lot more often.  Trouble is that sysadmins rarely
> install server frameworks on their own...

I have two "junior programmers" who will probably be ideal.
John knows Python, Dragan knows Java and a little Python, but they
(like me) are new to networking.  John is also our docco expert.
I suggest holding off until we "think it's sorted" and using
them for first impressions on the install process and examples.
You can only use each tester once for this kind of thing.

The other one, Robin becker, will no doubt ignore all docco, read the
source and maybe even any binaries, then discover something nasty
lurking in your innermost Windows event loops ;-)


Thanks,

Andy









From twisted at itamarst.org  Sun Oct 13 20:29:36 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 13 Oct 2002 20:29:36 -0400
Subject: [Twisted-Python] twisted.persisted.journal: a prevayler-inspired persistence system
In-Reply-To: <20021013.161104.89043483.glyph@twistedmatrix.com>
References: <20021012221721.15133eeb.twisted@itamarst.org>
	<20021013.012652.78706997.glyph@twistedmatrix.com>
	<20021013024405.5be04806.twisted@itamarst.org>
	<20021013.161104.89043483.glyph@twistedmatrix.com>
Message-ID: <20021013202936.75b83de6.twisted@itamarst.org>

On Sun, 13 Oct 2002 16:11:04 -0500 (CDT)
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> 
> On Sun, 13 Oct 2002 02:44:05 -0400, Itamar Shtull-Trauring
> <twisted at itamarst.org> wrote:
> 
> > Prevayler has something like that where you have Clock passed to
> > commands, IIRC. I probably should add some code so commands can get
> > a "fake" time, i.e. the time they were supposed to have been run.
> > Not sure that randomness is worth doing - if you are using it
> > presumably any outcome is equally valid, or alternatively if that's
> > not that case you can't really use journal anyway.
> 
> Not in the case of a game: certain events have "random" outcomes,
> weighted randomness based on a die roll plus some skill modifiers and
> so forth.  You can still use object prevalence to persist this
> information, but you need the die rolls associated with a certain
> action to be the same the second time through.

OK then:

class RollDice:
   def __init__(self):
       self.value = rollDice()

   def execute(self, service, startTime):
       service.foo(self.value)

In other words - do it in the command, not in the framework, because
frankly I have no way of knowing what random generator you use and so
on.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andy at reportlab.com  Sun Oct 13 20:29:51 2002
From: andy at reportlab.com (Andy Robinson)
Date: Mon, 14 Oct 2002 01:29:51 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021013.162312.111208639.glyph@twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>

> FWIW I don't think it's possible to do run any post-installation 
> code on win32 with distutils.  I haven't looked in depth for a while, 
> but I  haven't heard news of this being fixed, either.

Weird!  I didn't believe this so I subclasses and plugged in
a new install command which wrote some trace stuff to disk.
You're right; it executes at the time of bdist_wininst, not
when installing.  

I also downloaded and looked through py2exe, which he has 
continued to extend separately.  He says it can now install
Windows services, which is VERY relevant to you and us;
and this implies he at least knows how to do post-install
stuff.  BTW I think you're going to need a generic way to make 
any tap file into a service (which is really just a way
of starting it when the system starts).  So, I am
sure it's fixable, but will need upgrades/patches to
distutils.

I've emailed Thomas to ask where this stands and if we
can help..

- Andy











From andy at reportlab.com  Sun Oct 13 21:09:54 2002
From: andy at reportlab.com (Andy Robinson)
Date: Mon, 14 Oct 2002 02:09:54 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
Message-ID: <LKENLBBMDHMKBECHIAIAKEHPCMAA.andy@reportlab.com>

I really should be in bed, but I think I cracked it!

There is hope.  The bdist_wininst command in Python 2.2
does not include key changes added by Thomas Heller
added on Feb 20th (rev 1.29 in CVS).  I downloaded this one 
and overwrote my existing copy and found I could add an install 
script. What's more, print statements even show up in the final
GUI window, and you can make windows shortcuts.  

So, if you had a 'wininstall.py' script, you would do:

>python setup.py bdist_wininst --install-script wininstall.py

I needed to do some juggling to get around your auto-building
of scripts, but it builds distros with that script in
and runs them.  I made a right mess of setup.py tonight
but will try to redo this again 'cleanly' in a day or two.

HTH, 

Andy





From twisted at moshez.org  Mon Oct 14 08:08:07 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 14 Oct 2002 12:08:07 -0000
Subject: [Twisted-Python] Suggested Code Cleanup
Message-ID: <20021014120807.10794.qmail@green.zadka.com>

1. twisted/persisted/styles.py:42
2. twisted/internet/app.py:276
3. twisted/internet/app.py:341





From andrew-twisted at puzzling.org  Mon Oct 14 09:28:43 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 14 Oct 2002 23:28:43 +1000
Subject: [Twisted-Python] Test failure in with Python 2.2
Message-ID: <20021014132843.GA464@frobozz.local>

======================================================================
FAIL: testFileRebuild (twisted.test.test_rebuild.RebuildTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_rebuild.py", line 73, in testFileRebuild
    assert b.b() == 'c'
AssertionError
----------------------------------------------------------------------

I presume this is an issue with the special new-style class support...

-Andrew.




From twisted at itamarst.org  Mon Oct 14 10:20:50 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 14 Oct 2002 10:20:50 -0400
Subject: [Twisted-Python] Test failure in with Python 2.2
In-Reply-To: <20021014132843.GA464@frobozz.local>
References: <20021014132843.GA464@frobozz.local>
Message-ID: <20021014102050.72f7a047.twisted@itamarst.org>

On Mon, 14 Oct 2002 23:28:43 +1000
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

> ======================================================================
> FAIL: testFileRebuild (twisted.test.test_rebuild.RebuildTestCase)
> ----------------------------------------------------------------------

> I presume this is an issue with the special new-style class support...

This is a bug in Python 2.2.1 that is fixed in 2.2.2 (and Debian users
don't see it because 2.2.1 on Debian includes patches from 2.2.2).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andrew-twisted at puzzling.org  Mon Oct 14 10:30:42 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 15 Oct 2002 00:30:42 +1000
Subject: [Twisted-Python] Test failure in with Python 2.2
In-Reply-To: <20021014102050.72f7a047.twisted@itamarst.org>
References: <20021014132843.GA464@frobozz.local> <20021014102050.72f7a047.twisted@itamarst.org>
Message-ID: <20021014143041.GC464@frobozz.local>

On Mon, Oct 14, 2002 at 10:20:50AM -0400, Itamar Shtull-Trauring wrote:
> On Mon, 14 Oct 2002 23:28:43 +1000
> Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> 
> > ======================================================================
> > FAIL: testFileRebuild (twisted.test.test_rebuild.RebuildTestCase)
> > ----------------------------------------------------------------------
> 
> > I presume this is an issue with the special new-style class support...
> 
> This is a bug in Python 2.2.1 that is fixed in 2.2.2 (and Debian users
> don't see it because 2.2.1 on Debian includes patches from 2.2.2).

Hmm.  This is a debian unstable box, although I haven't upgraded python in a
while (damn 33.6k modem):

bash-2.05b$ dpkg -l python2.2 | grep ^ii
ii  python2.2      2.2.1-5        An interactive object-oriented scripting lan

A note should probably be made in the README/release notes that 2.2.2 is
required.

-Andrew.




From twisted at itamarst.org  Mon Oct 14 10:32:35 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 14 Oct 2002 10:32:35 -0400
Subject: [Twisted-Python] Test failure in with Python 2.2
In-Reply-To: <20021014143041.GC464@frobozz.local>
References: <20021014132843.GA464@frobozz.local>
	<20021014102050.72f7a047.twisted@itamarst.org>
	<20021014143041.GC464@frobozz.local>
Message-ID: <20021014103235.264f2100.twisted@itamarst.org>

On Tue, 15 Oct 2002 00:30:42 +1000
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

> bash-2.05b$ dpkg -l python2.2 | grep ^ii
> ii  python2.2      2.2.1-5        An interactive object-oriented
> scripting lan
> 
> A note should probably be made in the README/release notes that 2.2.2
> is required.

Well, I'm on 2.2.1-6 and I've never see the bug, and Jp saw it on
python.org 2.2.1 but not after upgrading to 2.2.2b1 (2.2.1-6 has 2 extra
months of bugfixes from Python CVS). We'll add a note after 2.2.2 is
released :)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From bruce at cubik.org  Mon Oct 14 11:16:10 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Mon, 14 Oct 2002 09:16:10 -0600
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
References: <E1816h5-0005Au-00@pyramid.twistedmatrix.com>
Message-ID: <3DAADFBA.1020803@cubik.org>

radix CVS wrote:
> 3) changed some addCallback/addErrback to addCallbacks

radix,

That change leads to problems if any errors happen within the callback 
since that won't cause renderFailure to be called.  Was there some 
particular reason that you did this since it is a change in semantics?

  - Bruce




From radix at twistedmatrix.com  Mon Oct 14 11:39:45 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 14 Oct 2002 17:39:45 +0200
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
In-Reply-To: <3DAADFBA.1020803@cubik.org>
References: <E1816h5-0005Au-00@pyramid.twistedmatrix.com> <3DAADFBA.1020803@cubik.org>
Message-ID: <20021014153945.GA13235@twistedmatrix.com>

On Mon, Oct 14, 2002 at 09:16:10AM -0600, Bruce Mitchener wrote:
> radix CVS wrote:
> >3) changed some addCallback/addErrback to addCallbacks
> 
> radix,
> 
> That change leads to problems if any errors happen within the callback 
> since that won't cause renderFailure to be called.  Was there some 
> particular reason that you did this since it is a change in semantics?

Sorry, I've brain-farted. I knew they were semantic changes, but
usually addCallbacks is recommended; I didn't realize that these
particular semantics were really needed in this case.




From bruce at cubik.org  Mon Oct 14 12:08:58 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Mon, 14 Oct 2002 10:08:58 -0600
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
References: <E1816h5-0005Au-00@pyramid.twistedmatrix.com> <3DAADFBA.1020803@cubik.org> <20021014153945.GA13235@twistedmatrix.com>
Message-ID: <3DAAEC1A.6020108@cubik.org>

Christopher Armstrong wrote:
> On Mon, Oct 14, 2002 at 09:16:10AM -0600, Bruce Mitchener wrote:
>>That change leads to problems if any errors happen within the callback 
>>since that won't cause renderFailure to be called.  Was there some 
>>particular reason that you did this since it is a change in semantics?
> 
> 
> Sorry, I've brain-farted. I knew they were semantic changes, but
> usually addCallbacks is recommended; I didn't realize that these
> particular semantics were really needed in this case.

No problem. Error handling in Woven is and has been a bit of a pain and 
a source of issues in the past where tracebacks were happening invisibly. :)

Thanks for reverting!

  - Bruce




From andrew-twisted at puzzling.org  Mon Oct 14 12:31:56 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 15 Oct 2002 02:31:56 +1000
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
In-Reply-To: <20021014153945.GA13235@twistedmatrix.com>
References: <E1816h5-0005Au-00@pyramid.twistedmatrix.com> <3DAADFBA.1020803@cubik.org> <20021014153945.GA13235@twistedmatrix.com>
Message-ID: <20021014163156.GE464@frobozz.local>

On Mon, Oct 14, 2002 at 05:39:45PM +0200, Christopher Armstrong wrote:
> > radix CVS wrote:
> > >3) changed some addCallback/addErrback to addCallbacks
> 
> Sorry, I've brain-farted. I knew they were semantic changes, but
> usually addCallbacks is recommended; I didn't realize that these
> particular semantics were really needed in this case.

This makes me wonder if most of the time you want to add a callback and an
errback, you want the errback to be able to catch the callbacks errors.

That is, maybe
    d.addCallbacks(cb, eb)
should be changed to be equivalent to 
    d.addCallback(cb).addErrback(eb)
and anyone requiring the current behaviour would have to do
    d.addErrback(eb).addCallback(cb)

Although now that I think of it, that last example isn't *quite* the same as
the current behaviour if eb returns a non-Failure...

I'm just thinking that the most commonly desired behaviour is to mirror
    try:
        cb()
    except:
        eb()

Hmm.  Perhaps a better solution is to add a kwarg to addCallbacks, so that
something like
    d.addCallbacks(cb, eb, errbackCatchesCallback=1)
would modify it to do what you want.  It'd be nice to think of a nicer name
for the kwarg though.

I guess it depends on what the most common use-case for adding callbacks &
errbacks is, and whether that is important enough to change the interface.
It's probably too late to do this with 1.0 so close :(

-Andrew.




From md9ms at mdstud.chalmers.se  Mon Oct 14 14:00:35 2002
From: md9ms at mdstud.chalmers.se (Martin =?ISO-8859-1?Q?Sj=F6gren?=)
Date: 14 Oct 2002 20:00:35 +0200
Subject: [Twisted-Python] Playing with twisted.web.woven
Message-ID: <1034618436.2291.5.camel@winterfell>

Well, I finally got some time to play with woven (or actually, I
should've been correcting assignments, but I'm sick and tired of it).

I must say: This is way cool! The more I fiddle with it, the more I'm
getting to say "good, now I can throw out *that* php hack too!"

I have a thing on my wishlist though. Heck, it might already be there
and I just don't know how to do it, but here's my scenario:

I have a view with a corresponding template. In that view, I want to
have a widget that in turn is created from a template, so I can reuse
that widget easily but still write it in html, since it's actually
mainly html. Can I do this already, and how? If not, would it be hard to
add it?

Thanks for the great package (and thanks to itamar, radix and bruce who
helped me get my example code to work!)


Cheers,
Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Detta =?ISO-8859-1?Q?=E4r?= en digitalt signerad
	meddelandedel
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021014/f048865d/attachment.pgp 

From m at moshez.org  Sat Oct 12 13:51:20 2002
From: m at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 17:51:20 -0000
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
References: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
Message-ID: <20021012175120.6505.qmail@green.zadka.com>

On Mon, 14 Oct 2002, "Andy Robinson" <andy at reportlab.com> wrote:

> I also downloaded and looked through py2exe, which he has 
> continued to extend separately.  He says it can now install
> Windows services, which is VERY relevant to you and us;
> and this implies he at least knows how to do post-install
> stuff.  BTW I think you're going to need a generic way to make 
> any tap file into a service (which is really just a way
> of starting it when the system starts). 

We knew we want this in IPC10 already --
'''
   Examples for integration opportunities are automatic creation of
   installer for "tap" files (for Red Hat Packager-based distributions,
   FreeBSD's package management system or Microsoft Windows(tm)
   installers)
'''

We do have a tap2deb mechanism, which does exactly that for Debian.
The problem is that nobody on the Twisted team really had time to delve
into services. As I see it, it would require a new script (twistw, maybe) --
most of twistd is about doing UNIXish stuff, and using it on Windows
is really an evil hack.



From theller at python.net  Mon Oct 14 05:33:20 2002
From: theller at python.net (Thomas Heller)
Date: Mon, 14 Oct 2002 11:33:20 +0200
Subject: [Twisted-Python] Re: First impressions of Windows downlod
References: <20021013.162312.111208639.glyph@twistedmatrix.com> <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
Message-ID: <aoe2vj$v3b$1@main.gmane.org>

"Andy Robinson" <andy at reportlab.com> wrote in message news:LKENLBBMDHMKBECHIAIAIEHOCMAA.andy at reportlab.com...
> > FWIW I don't think it's possible to do run any post-installation
> > code on win32 with distutils.  I haven't looked in depth for a while,
> > but I  haven't heard news of this being fixed, either.
>
> Weird!  I didn't believe this so I subclasses and plugged in
> a new install command which wrote some trace stuff to disk.
> You're right; it executes at the time of bdist_wininst, not
> when installing.
>
> I also downloaded and looked through py2exe, which he has
> continued to extend separately.  He says it can now install
> Windows services, which is VERY relevant to you and us;
> and this implies he at least knows how to do post-install
> stuff.  BTW I think you're going to need a generic way to make
> any tap file into a service (which is really just a way
> of starting it when the system starts).  So, I am
> sure it's fixable, but will need upgrades/patches to
> distutils.
>
> I've emailed Thomas to ask where this stands and if we
> can help..

I didn't see this message (which is surely my own fault,
because I was struggling the last few days or so trying out
different email and news clients).

Indeed I could use some help here. The CVS version seems to
be functional, but I'm not sure if I like the implementation.
I can post a description of how it works here later.

Thomas







From mwh at python.net  Mon Oct 14 07:12:51 2002
From: mwh at python.net (Michael Hudson)
Date: 14 Oct 2002 12:12:51 +0100
Subject: [Twisted-Python] Re: OS X and setup.py
References: <20021013040837.GA857@frobozz.local> <20021013041048.GB857@frobozz.local>
Message-ID: <lku1jp46ks.fsf@pc150.maths.bris.ac.uk>

Andrew Bennetts <andrew-twisted at puzzling.org> writes:

> On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
> > This part of setup.py is breaking build_ext on OS X (which doesn't have
> > poll):
> 
> My OS X informant also says:
> <Screwtape> Better test it on another OS X system, too.
> <Screwtape> This one might be a little damaged.
> <Screwtape> (i.e. it has a manpage for poll(), but no header file)

I think fink installs some kind of poll() emulation library, which can
cause confusion.

Cheers,
M.
(who just needs a nice aquafied emacs to ditch fink completely...)





From md9ms at mdstud.chalmers.se  Sun Oct 13 18:19:44 2002
From: md9ms at mdstud.chalmers.se (Martin =?ISO-8859-1?Q?Sj=F6gren?=)
Date: 14 Oct 2002 00:19:44 +0200
Subject: [Twisted-Python] Playing with twisted.web.woven
Message-ID: <1034547585.28424.6.camel@winterfell>

Well, I finally got some time to play with woven (or actually, I
should've been correcting assignments, but I'm sick and tired of it).

I must say: This is way cool! The more I fiddle with it, the more I'm
getting to say "good, now I can throw out *that* php hack too!"

I have a thing on my wishlist though. Heck, it might already be there
and I just don't know how to do it, but here's my scenario:

I have a view with a corresponding template. In that view, I want to
have a widget that in turn is created from a template, so I can reuse
that widget easily but still write it in html, since it's actually
mainly html. Can I do this already, and how? If not, would it be hard to
add it?

Thanks for the great package (and thanks to itamar, radix and bruce who
helped me get my example code to work!)


Cheers,
Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Detta =?ISO-8859-1?Q?=E4r?= en digitalt signerad
	meddelandedel
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021014/951fb027/attachment.pgp 

From glyph at twistedmatrix.com  Mon Oct 14 15:39:10 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 14 Oct 2002 14:39:10 -0500 (CDT)
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven
 Changes::
In-Reply-To: <20021014163156.GE464@frobozz.local>
References: <3DAADFBA.1020803@cubik.org>
	<20021014153945.GA13235@twistedmatrix.com>
	<20021014163156.GE464@frobozz.local>
Message-ID: <20021014.143910.74754385.glyph@twistedmatrix.com>


On Tue, 15 Oct 2002 02:31:56 +1000, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> This makes me wonder if most of the time you want to add a callback and an
> errback, you want the errback to be able to catch the callbacks errors.

I originally experimented with it that way, and I like it better the way it is.
For example, in the case of a remote method call, you use addCallbacks if you
want to handle the remote call by saying "Here is the result: ..." or "Remote
traceback: ..."  It's really misleading to have the "remote traceback" message
happen in the case where the traceback is really local.  Worse yet is to have a
situation where it's acceptable to swallow any remote error, but a local error
is unexpected.  Since the default behavior should be to print out a traceback
in the log, naive use of addCallbacks will do the right thing.

Of course, there are situations that go both ways, but I've encountered the
former more often than the latter.

I think the current implementation also wins because this change wouldn't be a
significant improvement, and it's better to keep the API more stable. (1.0
looming or not, stability should be the default unless the API in question is
very new, or there is a significant benefit to changing...)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021014/d08f2f25/attachment.pgp 

From glyph at twistedmatrix.com  Mon Oct 14 15:42:19 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 14 Oct 2002 14:42:19 -0500 (CDT)
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAKEHPCMAA.andy@reportlab.com>
References: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
	<LKENLBBMDHMKBECHIAIAKEHPCMAA.andy@reportlab.com>
Message-ID: <20021014.144219.26098220.glyph@twistedmatrix.com>


On Mon, 14 Oct 2002 02:09:54 +0100, "Andy Robinson" <andy at reportlab.com> wrote:
> >python setup.py bdist_wininst --install-script wininstall.py

Awesome!  Thanks for finding this out.  Can't wait to see your setup.py
patches! :)


-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021014/f5bb7768/attachment.pgp 

From glyph at twistedmatrix.com  Mon Oct 14 15:45:11 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 14 Oct 2002 14:45:11 -0500 (CDT)
Subject: [Twisted-Python] twisted.persisted.journal: a
 prevayler-inspired persistence system
In-Reply-To: <20021013202936.75b83de6.twisted@itamarst.org>
References: <20021013024405.5be04806.twisted@itamarst.org>
	<20021013.161104.89043483.glyph@twistedmatrix.com>
	<20021013202936.75b83de6.twisted@itamarst.org>
Message-ID: <20021014.144511.89040546.glyph@twistedmatrix.com>

On Sun, 13 Oct 2002 20:29:36 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:
> In other words - do it in the command, not in the framework, because
> frankly I have no way of knowing what random generator you use and so
> on.

You're right, of course.  It would be nice to have this supported by the
framework so that code _not_ designed to work with prevalence would still
function correctly, but there's a lot more to getting that to work than just
replacing the time and random modules. I/O is certainly a big one.

Your suggestion has a nice bonus, too.  It will actually make commands easier
to audit (and query, if you're using relational storage) since all the
information will be persistent as attributes rather than subtransactions.


-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021014/6033db49/attachment.pgp 

From andy at reportlab.com  Mon Oct 14 17:28:41 2002
From: andy at reportlab.com (Andy Robinson)
Date: Mon, 14 Oct 2002 22:28:41 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021014.144219.26098220.glyph@twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAEEIICMAA.andy@reportlab.com>

> Awesome!  Thanks for finding this out.  Can't wait to see your setup.py
> patches! :)

I'm really scared now.  Should have kept my mouth shut.
Actually, my cunning master plan is to make all the beginners
mistakes in your 'release 1.0', so by the time I have to do it for
my own products I'll know what to do :-)


thanks,

Andy



From bob at redivi.com  Mon Oct 14 17:58:32 2002
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 14 Oct 2002 17:58:32 -0400
Subject: [Twisted-Python] Re: OS X and setup.py
In-Reply-To: <lku1jp46ks.fsf@pc150.maths.bris.ac.uk>
Message-ID: <145AD0FA-DFC0-11D6-9A91-0003938210D6@redivi.com>

On Monday, October 14, 2002, at 07:12 AM, Michael Hudson wrote:

> Andrew Bennetts <andrew-twisted at puzzling.org> writes:
>
>> On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
>>> This part of setup.py is breaking build_ext on OS X (which doesn't 
>>> have
>>> poll):
>>
>> My OS X informant also says:
>> <Screwtape> Better test it on another OS X system, too.
>> <Screwtape> This one might be a little damaged.
>> <Screwtape> (i.e. it has a manpage for poll(), but no header file)
>
> I think fink installs some kind of poll() emulation library, which can
> cause confusion.
>

That's exactly correct.  OS X has never shipped with poll() or the 
associated manpages.  I believe the one they use is here:  
http://www.clapper.org/software/poll/

I use vim, so I don't need fink :)

-bob




From twisted at itamarst.org  Mon Oct 14 18:54:17 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 14 Oct 2002 18:54:17 -0400
Subject: [Twisted-Python] Notice to everyone who SUBMITTED PATCHS to Twisted
Message-ID: <20021014185417.6e40c295.twisted@itamarst.org>

If your patch has not been checked in, please add it to the bug tracker
at http://sourceforge.net/projects/twisted/.

Additionally, make sure you agree to doc/legal/whateverit's called, i.e.
making  sure glyph has copyright.

Lastly, bug whoever is listed as the module maintainer in the module
docstring about it.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From radix at twistedmatrix.com  Mon Oct 14 19:01:46 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 15 Oct 2002 01:01:46 +0200
Subject: [Twisted-Python] Patch for extra IRC events.
In-Reply-To: <0288BCD1-DEBA-11D6-88F9-003065D61A3E@froup.com>
References: <0288BCD1-DEBA-11D6-88F9-003065D61A3E@froup.com>
Message-ID: <20021014230146.GA18566@twistedmatrix.com>

On Mon, Oct 14, 2002 at 12:42:33AM +1000, Tim Allen wrote:
> Here's a patch that makes the IRC protocol notice a few more events, and 
> also keeps a record of the MOTD in case we want to refer to it later.
> 
> All the advertised features seem to work on Slashnet.
> 


Do you agree to give Glyph copyright (as itamar mentioned in his last
mail to the list)? I'll commit the patch if you do.




From andrew-twisted at puzzling.org  Mon Oct 14 20:09:20 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 15 Oct 2002 10:09:20 +1000
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
In-Reply-To: <20021014.143910.74754385.glyph@twistedmatrix.com>
References: <3DAADFBA.1020803@cubik.org> <20021014153945.GA13235@twistedmatrix.com> <20021014163156.GE464@frobozz.local> <20021014.143910.74754385.glyph@twistedmatrix.com>
Message-ID: <20021015000920.GA16784@ritsuko.xware.cx>

On Mon, Oct 14, 2002 at 02:39:10PM -0500, Glyph Lefkowitz wrote:
> 
> On Tue, 15 Oct 2002 02:31:56 +1000, Andrew Bennetts
> <andrew-twisted at puzzling.org> wrote:
> > This makes me wonder if most of the time you want to add a callback
> > and an errback, you want the errback to be able to catch the
> > callbacks errors.
> 
> I originally experimented with it that way, and I like it better the
> way it is.  For example, in the case of a remote method call, you use
> addCallbacks if you want to handle the remote call by saying "Here is
> the result: ..." or "Remote traceback: ..."  It's really misleading to
> have the "remote traceback" message happen in the case where the
> traceback is really local.  Worse yet is to have a situation where
> it's acceptable to swallow any remote error, but a local error is
> unexpected.  Since the default behavior should be to print out a
> traceback in the log, naive use of addCallbacks will do the right
> thing.

Good point.  I am convinced.

After all, a more accurate picture of my mini try/except in my last
email really should've been:
    try:
        res = call_that_may_take_some_time()
    except Failure, f:
        eb(f)
    else:
        cb(res)

-Andrew.




From andrew-twisted at puzzling.org  Tue Oct 15 05:43:56 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 15 Oct 2002 19:43:56 +1000
Subject: [Twisted-Python] Patch for extra IRC events.
In-Reply-To: <20021014230146.GA18566@twistedmatrix.com>
References: <0288BCD1-DEBA-11D6-88F9-003065D61A3E@froup.com> <20021014230146.GA18566@twistedmatrix.com>
Message-ID: <20021015094355.GA717@frobozz.local>

On Tue, Oct 15, 2002 at 01:01:46AM +0200, Christopher Armstrong wrote:
> On Mon, Oct 14, 2002 at 12:42:33AM +1000, Tim Allen wrote:
> > Here's a patch that makes the IRC protocol notice a few more events, and 
> > also keeps a record of the MOTD in case we want to refer to it later.
> > 
> > All the advertised features seem to work on Slashnet.
> 
> Do you agree to give Glyph copyright (as itamar mentioned in his last
> mail to the list)? I'll commit the patch if you do.

He does, so I've committed it.  See the checkin message for details :)

-Andrew.




From mwh at python.net  Tue Oct 15 05:12:23 2002
From: mwh at python.net (Michael Hudson)
Date: 15 Oct 2002 10:12:23 +0100
Subject: [Twisted-Python] Re: OS X and setup.py
References: <lku1jp46ks.fsf@pc150.maths.bris.ac.uk> <145AD0FA-DFC0-11D6-9A91-0003938210D6@redivi.com>
Message-ID: <lk8z103w20.fsf@pc150.maths.bris.ac.uk>

Bob Ippolito <bob at redivi.com> writes:

> On Monday, October 14, 2002, at 07:12 AM, Michael Hudson wrote:
> 
> > Andrew Bennetts <andrew-twisted at puzzling.org> writes:
> >
> >> On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
> >>> This part of setup.py is breaking build_ext on OS X (which doesn't
> >>> have
> >>> poll):
> >>
> >> My OS X informant also says:
> >> <Screwtape> Better test it on another OS X system, too.
> >> <Screwtape> This one might be a little damaged.
> >> <Screwtape> (i.e. it has a manpage for poll(), but no header file)
> >
> > I think fink installs some kind of poll() emulation library, which can
> > cause confusion.
> >
> 
> That's exactly correct.  OS X has never shipped with poll() or the
> associated manpages.  I believe the one they use is here:
> http://www.clapper.org/software/poll/

And, of course, the aggravating thing is that because it's only an
emulation you don't actually get any of the performance benefits of
using poll(), and in fact probably lose out through overheads.

> I use vim, so I don't need fink :)

I built Emacs from CVS yesterday, so now I can start de-finking my
machine :)

Cheers,
M.

-- 
  C++ is a siren song.  It *looks* like a HLL in which you ought to
  be able to write an application, but it really isn't.
                                       -- Alain Picard, comp.lang.lisp





From twisted at moshez.org  Tue Oct 15 08:10:23 2002
From: twisted at moshez.org (Moshe Zadka)
Date: Tue, 15 Oct 2002 07:10:23 -0500
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom [PATCH]
Message-ID: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>

This patch touches many places, so I wanted to run it by the list
first.

Thanks.

diff -ur -x CVS Twisted.clean/twisted/enterprise/reflector.py Twisted/twisted/enterprise/reflector.py
--- Twisted.clean/twisted/enterprise/reflector.py	Thu Oct 10 21:41:28 2002
+++ Twisted/twisted/enterprise/reflector.py	Tue Oct 15 07:06:14 2002
@@ -59,8 +59,8 @@
         # mainloop is not running.  I'm not sure what the correct behavior here
         # should be. --glyph
         
-        from twisted.internet import reactor
-        reactor.callLater(0, self._really_populate)
+        from twisted.internet import utils
+        utils.sched(self._really_populate)
 
     def _really_populate(self):
         """Implement me to populate schema information for the reflector.
diff -ur -x CVS Twisted.clean/twisted/internet/defer.py Twisted/twisted/internet/defer.py
--- Twisted.clean/twisted/internet/defer.py	Fri Sep 27 10:38:18 2002
+++ Twisted/twisted/internet/defer.py	Tue Oct 15 06:59:12 2002
@@ -40,10 +40,6 @@
     log.err(err)
     return err
 
-def _sched(m, r):
-    from twisted.internet import reactor
-    reactor.callLater(0, m, r)
-
 def succeed(result):
     d = Deferred()
     d.callback(result)
diff -ur -x CVS Twisted.clean/twisted/internet/udp.py Twisted/twisted/internet/udp.py
--- Twisted.clean/twisted/internet/udp.py	Mon Oct 14 13:30:09 2002
+++ Twisted/twisted/internet/udp.py	Tue Oct 15 06:59:35 2002
@@ -220,8 +220,8 @@
         """
         self.stopReading()
         if self.connected:
-            from twisted.internet import reactor
-            reactor.callLater(0, self.connectionLost)
+            from twisted.internet import utils
+            utils.sched(self.connectionLost)
 
     def connectionLost(self, reason=None):
         """Cleans up my socket.
diff -ur -x CVS Twisted.clean/twisted/internet/utils.py Twisted/twisted/internet/utils.py
--- Twisted.clean/twisted/internet/utils.py	Sun Oct 13 04:08:50 2002
+++ Twisted/twisted/internet/utils.py	Tue Oct 15 07:04:41 2002
@@ -70,3 +70,6 @@
 
 def getProcessValue(executable, args=(), env={}, path='.'):
     return callProtocolWithDeferred(_ValueGetter, executable, args, env, path)
+
+def sched(f, *args, **kw):
+    reactor.callLater(0, f, *args, **kw)
diff -ur -x CVS Twisted.clean/twisted/news/news.py Twisted/twisted/news/news.py
--- Twisted.clean/twisted/news/news.py	Thu Oct  3 09:40:32 2002
+++ Twisted/twisted/news/news.py	Tue Oct 15 07:00:42 2002
@@ -21,7 +21,7 @@
 """
 
 from twisted.protocols import nntp
-from twisted.internet import protocol, reactor
+from twisted.internet import protocol, reactor, utils
 
 import time
 
@@ -79,7 +79,7 @@
 
 
     def startFactory(self):
-        self._updateCall = reactor.callLater(0, self.syncWithRemotes)
+        self._updateCall = utils.sched(self.syncWithRemotes)
 
 
     def stopFactory(self):
diff -ur -x CVS Twisted.clean/twisted/protocols/ftp.py Twisted/twisted/protocols/ftp.py
--- Twisted.clean/twisted/protocols/ftp.py	Mon Oct 14 13:30:09 2002
+++ Twisted/twisted/protocols/ftp.py	Tue Oct 15 07:01:31 2002
@@ -71,7 +71,7 @@
 from math import floor
 
 # Twisted Imports
-from twisted.internet import abstract, reactor, protocol
+from twisted.internet import abstract, reactor, protocol, utils
 from twisted.internet.interfaces import IProducer
 from twisted.protocols import basic
 from twisted.internet.protocol import ClientFactory, ServerFactory, Protocol
@@ -146,7 +146,7 @@
 
     def stopProducing(self):
         self.request.unregisterProducer()
-        reactor.callLater(0, self.request.finish)
+        utils.sched(self.request.finish)
         self.request = None
 
 
diff -ur -x CVS Twisted.clean/twisted/test/test_ftp.py Twisted/twisted/test/test_ftp.py
--- Twisted.clean/twisted/test/test_ftp.py	Fri Sep  6 01:45:31 2002
+++ Twisted/twisted/test/test_ftp.py	Tue Oct 15 07:02:04 2002
@@ -16,7 +16,7 @@
 
 from pyunit import unittest
 from twisted.protocols import ftp, loopback
-from twisted.internet import reactor
+from twisted.internet import reactor, utils
 from twisted.internet.protocol import Protocol, FileWrapper, Factory, \
                                       ClientFactory
 
@@ -80,7 +80,7 @@
 
     def writeResponses(self, protocol, responses):
         for response in responses:
-            reactor.callLater(0, protocol.lineReceived, response)
+            utils.sched(protocol.lineReceived, response)
 
 
 class FTPServerTests(unittest.TestCase):
diff -ur -x CVS Twisted.clean/twisted/test/test_rebuild.py Twisted/twisted/test/test_rebuild.py
--- Twisted.clean/twisted/test/test_rebuild.py	Fri Sep 20 15:29:40 2002
+++ Twisted/twisted/test/test_rebuild.py	Mon Oct 14 08:00:37 2002
@@ -70,6 +70,7 @@
         else:
             b2 = myrebuilder.B()
             assert b2.b() == 'c'
+            print "MOSHE!!!!", b.b()
             assert b.b() == 'c'
         assert i.a() == 'd'
         assert a.a() == 'b'
diff -ur -x CVS Twisted.clean/twisted/web/static.py Twisted/twisted/web/static.py
--- Twisted.clean/twisted/web/static.py	Thu Oct 10 13:32:26 2002
+++ Twisted/twisted/web/static.py	Tue Oct 15 07:02:25 2002
@@ -196,8 +196,8 @@
     def upgradeToVersion5(self):
         if not isinstance(self.registry, Registry):
             self.registry = Registry()
-            from twisted.internet import reactor
-            reactor.callLater(0, _upgradeRegistry, self.registry)
+            from twisted.internet import utils
+            utils.sched(_upgradeRegistry, self.registry)
 
     def upgradeToVersion4(self):
         if not hasattr(self, 'registry'):
diff -ur -x CVS Twisted.clean/twisted/web/woven/template.py Twisted/twisted/web/woven/template.py
--- Twisted.clean/twisted/web/woven/template.py	Wed Oct  9 13:37:41 2002
+++ Twisted/twisted/web/woven/template.py	Tue Oct 15 07:02:49 2002
@@ -77,7 +77,7 @@
 
 from twisted.internet import defer
 from twisted.python import failure
-from twisted.internet import reactor, defer
+from twisted.internet import reactor, defer, utils
 from twisted.python import log
 
 from twisted.web.server import NOT_DONE_YET
@@ -195,7 +195,7 @@
                 raise AttributeError, "%s does not define self.templateFile to operate on" % self.__class__
             self.d = self.lookupTemplate(request)
         # Schedule processing of the document for later...
-        reactor.callLater(0, self.handleDocument, request, self.d)
+        utils.sched(0, self.handleDocument, request, self.d)
         #self.handleNode(request, self.d)
         #return str(self.d.toxml())
         




From bob at redivi.com  Tue Oct 15 08:28:08 2002
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 15 Oct 2002 08:28:08 -0400
Subject: [Twisted-Python] Re: OS X and setup.py
In-Reply-To: <lk8z103w20.fsf@pc150.maths.bris.ac.uk>
Message-ID: <8FC0249F-E039-11D6-9A91-0003938210D6@redivi.com>

On Tuesday, Oct 15, 2002, at 05:12 America/New_York, Michael Hudson 
wrote:

> Bob Ippolito <bob at redivi.com> writes:
>
>> On Monday, October 14, 2002, at 07:12 AM, Michael Hudson wrote:
>>
>>> Andrew Bennetts <andrew-twisted at puzzling.org> writes:
>>>
>>>> On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
>>>>> This part of setup.py is breaking build_ext on OS X (which doesn't
>>>>> have
>>>>> poll):
>>>>
>>>> My OS X informant also says:
>>>> <Screwtape> Better test it on another OS X system, too.
>>>> <Screwtape> This one might be a little damaged.
>>>> <Screwtape> (i.e. it has a manpage for poll(), but no header file)
>>>
>>> I think fink installs some kind of poll() emulation library, which 
>>> can
>>> cause confusion.
>>>
>>
>> That's exactly correct.  OS X has never shipped with poll() or the
>> associated manpages.  I believe the one they use is here:
>> http://www.clapper.org/software/poll/
>
> And, of course, the aggravating thing is that because it's only an
> emulation you don't actually get any of the performance benefits of
> using poll(), and in fact probably lose out through overheads.
>

Yes, but it's still probably not much slower than using select from 
python.. afaik, poll() is only used in twisted by creactor, which isn't 
really used at all.

>> I use vim, so I don't need fink :)
>
> I built Emacs from CVS yesterday, so now I can start de-finking my
> machine :)




From bruce at cubik.org  Tue Oct 15 09:33:12 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 15 Oct 2002 07:33:12 -0600
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom
 [PATCH]
References: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>
Message-ID: <3DAC1918.5050102@cubik.org>

Moshe Zadka wrote:
> This patch touches many places, so I wanted to run it by the list
> first.

I have no real opinion on whether or not something is wrong with the 
idea of a callLater(0, ...), but:

Could it be utils.schedule() or some other complete word rather than 
'sched'?

And the following part of your diff contains an obvious error:

> diff -ur -x CVS Twisted.clean/twisted/web/woven/template.py Twisted/twisted/web/woven/template.py
> --- Twisted.clean/twisted/web/woven/template.py	Wed Oct  9 13:37:41 2002
> +++ Twisted/twisted/web/woven/template.py	Tue Oct 15 07:02:49 2002
> @@ -77,7 +77,7 @@
>  
>  from twisted.internet import defer
>  from twisted.python import failure
> -from twisted.internet import reactor, defer
> +from twisted.internet import reactor, defer, utils
>  from twisted.python import log
>  
>  from twisted.web.server import NOT_DONE_YET
> @@ -195,7 +195,7 @@
>                  raise AttributeError, "%s does not define self.templateFile to operate on" % self.__class__
>              self.d = self.lookupTemplate(request)
>          # Schedule processing of the document for later...
> -        reactor.callLater(0, self.handleDocument, request, self.d)
> +        utils.sched(0, self.handleDocument, request, self.d)
>          #self.handleNode(request, self.d)
>          #return str(self.d.toxml())

  - Bruce




From sean at twistedmatrix.com  Tue Oct 15 11:55:44 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Tue, 15 Oct 2002 10:55:44 -0500
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <3DAC1918.5050102@cubik.org>
Message-ID: <PGEKIMFOMBFCPBEILDBLOECCCBAA.sean@twistedmatrix.com>

i agree. please call it something complete.

why move it to "utils."? it seems inconsistent to have reactor.callLater and
utils.schedule.. shouldn't they both be on the same module?

-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Bruce
Mitchener
Sent: Tuesday, October 15, 2002 8:33 AM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] reactor.callLater(0,) should not be an
idiom[PATCH]


Moshe Zadka wrote:
> This patch touches many places, so I wanted to run it by the list
> first.

I have no real opinion on whether or not something is wrong with the
idea of a callLater(0, ...), but:

Could it be utils.schedule() or some other complete word rather than
'sched'?

And the following part of your diff contains an obvious error:

> diff -ur -x CVS Twisted.clean/twisted/web/woven/template.py
Twisted/twisted/web/woven/template.py
> --- Twisted.clean/twisted/web/woven/template.py	Wed Oct  9 13:37:41 2002
> +++ Twisted/twisted/web/woven/template.py	Tue Oct 15 07:02:49 2002
> @@ -77,7 +77,7 @@
>
>  from twisted.internet import defer
>  from twisted.python import failure
> -from twisted.internet import reactor, defer
> +from twisted.internet import reactor, defer, utils
>  from twisted.python import log
>
>  from twisted.web.server import NOT_DONE_YET
> @@ -195,7 +195,7 @@
>                  raise AttributeError, "%s does not define
self.templateFile to operate on" % self.__class__
>              self.d = self.lookupTemplate(request)
>          # Schedule processing of the document for later...
> -        reactor.callLater(0, self.handleDocument, request, self.d)
> +        utils.sched(0, self.handleDocument, request, self.d)
>          #self.handleNode(request, self.d)
>          #return str(self.d.toxml())

  - Bruce


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From twisted at moshez.org  Tue Oct 15 14:19:15 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 15 Oct 2002 18:19:15 -0000
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <PGEKIMFOMBFCPBEILDBLOECCCBAA.sean@twistedmatrix.com>
References: <PGEKIMFOMBFCPBEILDBLOECCCBAA.sean@twistedmatrix.com>
Message-ID: <20021015181915.29562.qmail@green.zadka.com>

On Tue, 15 Oct 2002, "Sean Riley" <sean at twistedmatrix.com> wrote:

> why move it to "utils."? it seems inconsistent to have reactor.callLater and
> utils.schedule.. shouldn't they both be on the same module?

No. reactor is a "virtual" module.



From sean at twistedmatrix.com  Tue Oct 15 15:06:32 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Tue, 15 Oct 2002 14:06:32 -0500
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <20021015181915.29562.qmail@green.zadka.com>
Message-ID: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>

That doesn't answer my question. Shouldn't schedule() and callLater() appear
to the user to be called on the same module regardless of the underlying
implementation details?


-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Moshe Zadka
Sent: Tuesday, October 15, 2002 1:19 PM
To: twisted-python at twistedmatrix.com
Subject: RE: [Twisted-Python] reactor.callLater(0,) should not be an
idiom[PATCH]


On Tue, 15 Oct 2002, "Sean Riley" <sean at twistedmatrix.com> wrote:

> why move it to "utils."? it seems inconsistent to have reactor.callLater
and
> utils.schedule.. shouldn't they both be on the same module?

No. reactor is a "virtual" module.

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From twisted at itamarst.org  Tue Oct 15 15:07:41 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 15 Oct 2002 15:07:41 -0400
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>
References: <20021015181915.29562.qmail@green.zadka.com>
	<PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>
Message-ID: <20021015150741.623432d1.twisted@itamarst.org>

On Tue, 15 Oct 2002 14:06:32 -0500
"Sean Riley" <sean at twistedmatrix.com> wrote:

> That doesn't answer my question. Shouldn't schedule() and callLater()
> appear to the user to be called on the same module regardless of the
> underlying implementation details?

No. reactor is for core, low-level interfaces only. Anything that can be
built on top of these APIs should not be in the reactor.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From alexander.levy at tufts.edu  Tue Oct 15 14:49:00 2002
From: alexander.levy at tufts.edu (Alex Levy)
Date: Tue, 15 Oct 2002 14:49:00 -0400
Subject: [Twisted-Python] Batch file errors in Windows distribution (0.99.4)
Message-ID: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>

In the batch files installed by the Windows 0.99.4 package, the Python 
executable is referenced as C:\PROGRAM FILES\PYTHON2.2\PYTHON.EXE.  This 
causes two problems, one of which is easier to fix than the other.

1. Either PROGRAM FILES needs to become PROGRA~1, or the entire file name 
needs to be in quotes.
2. It looks like this path is hardcoded, since my version of Python isn't 
installed there.

Thought I'd mention it.  You may now resume discussing things that matter.

--
Alex Levy
WWW: http://mesozoic.geecs.org
Tel: 617.835.0778

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_





From m at moshez.org  Tue Oct 15 15:16:05 2002
From: m at moshez.org (Moshe Zadka)
Date: 15 Oct 2002 19:16:05 -0000
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>
References: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>
Message-ID: <20021015191605.30529.qmail@green.zadka.com>

On Tue, 15 Oct 2002, "Sean Riley" <sean at twistedmatrix.com> wrote:

> That doesn't answer my question. Shouldn't schedule() and callLater() appear
> to the user to be called on the same module regardless of the underlying
> implementation details?

That's not the correct question. The question is "is it possible?".
The answer is that it is not possible without doing really obscure
things. Thus, it shouldn't be done. If you'll recall, this was why
.utils got there in the first place (namely, the process stuff).

Also, could you possibly observe common netiquette and stop quoting
whole messages or putting your response before what you're responding
to? Thank you.



From glyph at twistedmatrix.com  Tue Oct 15 16:39:59 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 15 Oct 2002 15:39:59 -0500 (CDT)
Subject: [Twisted-Python] Batch file errors in Windows distribution
 (0.99.4)
In-Reply-To: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>
References: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>
Message-ID: <20021015.153959.56565984.glyph@twistedmatrix.com>


On Tue, 15 Oct 2002 14:49:00 -0400, Alex Levy <alexander.levy at tufts.edu> wrote:

> 1. Either PROGRAM FILES needs to become PROGRA~1, or the entire file name
> needs to be in quotes.

The filename needs to be in quotes. PROGRA~1 only works on ancient DOS
filesystems.

> 2. It looks like this path is hardcoded, since my version of Python isn't 
> installed there.

Hmm, that's weird.  It ought to be able to determine that from sys.argv[0],
right?  (Windows folks?)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021015/e7c292fe/attachment.pgp 

From andy at reportlab.com  Tue Oct 15 16:56:40 2002
From: andy at reportlab.com (Andy Robinson)
Date: Tue, 15 Oct 2002 21:56:40 +0100
Subject: [Twisted-Python] Batch file errors in Windows distribution (0.99.4)
In-Reply-To: <20021015.153959.56565984.glyph@twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAIEKGCMAA.andy@reportlab.com>

> Hmm, that's weird.  It ought to be able to determine that from 
> sys.argv[0],
No, use sys.executable just like on Unix.

I think he's right about Progra~1 working, but that
doesn't mean we have to use it :-)

Python 2.2.1 (#34, Apr  9 2002, 19:34:33) [MSC 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.argv[0]
''
>>> sys.executable
'c:\\python22\\python.exe'
>>>

- Andy Robinson



From twisted at itamarst.org  Tue Oct 15 17:02:25 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 15 Oct 2002 17:02:25 -0400
Subject: [Twisted-Python] Batch file errors in Windows distribution (0.99.4)
In-Reply-To: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>
References: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>
Message-ID: <20021015170225.5405f622.twisted@itamarst.org>

On Tue, 15 Oct 2002 14:49:00 -0400
Alex Levy <alexander.levy at tufts.edu> wrote:

> In the batch files installed by the Windows 0.99.4 package, the Python
> 
> executable is referenced as C:\PROGRAM FILES\PYTHON2.2\PYTHON.EXE. 
> This causes two problems, one of which is easier to fix than the
> other.

... sys.executable is suggested ...

The problem is that sys.executable is the Python on the system creating
the installer .exe, not the one where it's being installed. But the "run
script after install" Andy Robinson suggsted should allow this.

If I don't get a patch from Andy today I'm going to do my best to fix
the two issues with the Win32 installer (docs and .bat files) myself
tonight, so we can do 1.0rc1 tommorow.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andy at reportlab.com  Tue Oct 15 17:02:40 2002
From: andy at reportlab.com (Andy Robinson)
Date: Tue, 15 Oct 2002 22:02:40 +0100
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <20021015191605.30529.qmail@green.zadka.com>
Message-ID: <LKENLBBMDHMKBECHIAIACEKHCMAA.andy@reportlab.com>

> Also, could you possibly observe common netiquette and stop quoting
> whole messages or putting your response before what you're responding
> to? Thank you.

FYI Outlook makes you jump through hoops to reply 'the normal way'.
It's default is to preserve the whole message before what you
type.  It CAN be done, but not if your company enforces a
standard desktop configuration...

- Andy




From glyph at twistedmatrix.com  Tue Oct 15 18:46:18 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 15 Oct 2002 17:46:18 -0500 (CDT)
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom
 [PATCH]
In-Reply-To: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>
References: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>
Message-ID: <20021015.174618.74757373.glyph@twistedmatrix.com>


On Tue, 15 Oct 2002 07:10:23 -0500, Moshe Zadka <twisted at moshez.org> wrote:
> This patch touches many places, so I wanted to run it by the list
> first.

Why should this not be an idiom?

Neither utils.schedule(...) nor callLater(0,...) is particularly obviously
named unless you read the docstring, and utils.schedule adds a bunch of
getattr/python function call stuff to the cases where it's used for apparently
no reason.  Not to mention the fact that it provides a new way to write Twisted
code that is not backwards compatible with older versions of Twisted.  This
also does not add any functionality.

So, let's review, in order of importance.  This patch:

    * fixed no bugs
    * added no features
    * touched a lot of code
    * destabilized a core Twisted API (in a fowards-compatible but not
      backwards-compatible way) in that it implies callLater(0...) is
      deprecated
    * made a very basic and frequently-used idiom slightly less efficient

Most of all, it provides two ways of doing the exact same thing, and I
generally think that the TIMTOWTDI philosophy is awful.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021015/996d8f83/attachment.pgp 

From glyph at twistedmatrix.com  Tue Oct 15 19:12:23 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 15 Oct 2002 18:12:23 -0500 (CDT)
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom
 [PATCH]
In-Reply-To: <20021015.174618.74757373.glyph@twistedmatrix.com>
References: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>
	<20021015.174618.74757373.glyph@twistedmatrix.com>
Message-ID: <20021015.181223.78706653.glyph@twistedmatrix.com>

On Tue, 15 Oct 2002 17:46:18 -0500 (CDT), Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> So, let's review, in order of importance.  This patch:

Oh, I forgot to mention; the structure of the "utils" module also makes it
impossible to use multiple reactors with it.  I'd like to avoid inserting this
assumption into the codebase more than absolutely necessary.  utils.schedule is
particularly bad because it requires varargs and we can't insert an optional
'reactor' kwarg.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021015/588c0b4a/attachment.pgp 

From bruce at cubik.org  Wed Oct 16 01:32:45 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 15 Oct 2002 23:32:45 -0600
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
References: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com> <20021015191605.30529.qmail@green.zadka.com>
Message-ID: <3DACF9FD.5070806@cubik.org>

Hello Moshe,

Moshe Zadka wrote:
> On Tue, 15 Oct 2002, "Sean Riley" <sean at twistedmatrix.com> wrote:
>>That doesn't answer my question. Shouldn't schedule() and callLater() appear
>>to the user to be called on the same module regardless of the underlying
>>implementation details?
> 
> That's not the correct question. The question is "is it possible?".
> The answer is that it is not possible without doing really obscure
> things. Thus, it shouldn't be done. If you'll recall, this was why
> .utils got there in the first place (namely, the process stuff).

Having an obscure and less usable API with some parts of the API on one 
object and other parts on some other object (or maybe even multiple 
other objects) isn't something that creates a nice usable and easy to 
learn/use framework.  Implementation details needn't (and shouldn't) 
bleed through into the public interfaces in the sort of manner that you 
are suggesting.  If they do, then perhaps something larger is wrong.

> Also, could you possibly observe common netiquette and stop quoting
> whole messages or putting your response before what you're responding
> to? Thank you.

You might try lightening your tone on the list.  You might be (are 
supposedly from what people have told me when I've asked) a decent 
person in real life, but you come across on this list as being overly 
confrontational, rude, and abrupt.

If 1.0 is happening soon, I'd hope that people asking (reasonable!) 
questions like this would be treated with some courtesy and respect and 
actual answers rather than the 'No. reactor is a "virtual" module.' sort 
of answer that provides no useful information.  However good Twisted may 
be, the attitudes that we show on the list when dealing with any user 
can be enough to convince people that Twisted is good or that it is bad 
and to be avoided.  I certainly hope that the latter doesn't (continue 
to) happen.

Regards,

  - Bruce




From md9ms at mdstud.chalmers.se  Wed Oct 16 04:42:38 2002
From: md9ms at mdstud.chalmers.se (Martin =?ISO-8859-1?Q?Sj=F6gren?=)
Date: 16 Oct 2002 10:42:38 +0200
Subject: [Twisted-Python] Question about resources (and woven?)
Message-ID: <1034757758.1272.4.camel@winterfell>

I have an xhtml template that has

<textarea model="quote" view="EscapedText" name="quote" id="quote"
cols="60" rows="5"></textarea>
<input model="comment" view="Input" type="text" name="comment"
id="comment" size="30" value="" />
<input model="sentby" view="Input" type="text" name="name" id="name"
size="30" value="" />
<select model="languages" view="List" name="language" id="language">
    <option id="listItem" view="MyOption" />
</select>

This all lives in a submodel called 'editor'. When I submit this form, I
get the following request.args:

{'quote': ['this is a quote'], 'editor/sentby': ['my name'],
'editor/comment': ['this is a comment'], 'language': ['Swedish']}

My question is: Why the 'editor/' part in sentby and comment, but not
quote and language? Why is it using 'sentby' instead of 'name' (which is
the id and name settings of the input)?


Regards,
Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Detta =?ISO-8859-1?Q?=E4r?= en digitalt signerad
	meddelandedel
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021016/338a40a3/attachment.pgp 

From dp at twistedmatrix.com  Wed Oct 16 11:37:56 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 16 Oct 2002 08:37:56 -0700
Subject: [Twisted-Python] Question about resources (and woven?)
In-Reply-To: <1034757758.1272.4.camel@winterfell>
Message-ID: <3E347E47-E11D-11D6-B4DA-000393B3EC2C@twistedmatrix.com>

On Wednesday, October 16, 2002, at 01:42 AM, Martin Sj?gren wrote:
>
> This all lives in a submodel called 'editor'. When I submit this form, 
> I
> get the following request.args:
>
> {'quote': ['this is a quote'], 'editor/sentby': ['my name'],
> 'editor/comment': ['this is a comment'], 'language': ['Swedish']}
>
> My question is: Why the 'editor/' part in sentby and comment, but not
> quote and language?

Because sentby and comment have view="Input"; the Input widgets set the 
name attribute to the full path of the submodel. Since the other view 
widgets don't do this, it's not happening on those nodes.

>  Why is it using 'sentby' instead of 'name' (which is
> the id and name settings of the input)?

Because the model attribute is "sentby"...




From gilh at sympatico.ca  Wed Oct 16 14:33:01 2002
From: gilh at sympatico.ca (Gil Hauer)
Date: 16 Oct 2002 14:33:01 -0400
Subject: [Twisted-Python] twisted.web question
Message-ID: <1034793181.1935.35.camel@giantclam>

Hello,

I'd like one server to be able to host several web sites, hence:

Is it possible to use Twisted.web with virtual host functionality such
as that provided by Apache?


Thanks,
Gil
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021016/e19a2208/attachment.pgp 

From thomas.heller at ion-tof.com  Wed Oct 16 14:39:48 2002
From: thomas.heller at ion-tof.com (Thomas Heller)
Date: 16 Oct 2002 20:39:48 +0200
Subject: [Twisted-Python] Re: First impressions of Windows downlod
References: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com> <LKENLBBMDHMKBECHIAIAKEHPCMAA.andy@reportlab.com>
Message-ID: <d6qa8byj.fsf@ion-tof.com>

"Andy Robinson" <andy at reportlab.com> writes:

> I really should be in bed, but I think I cracked it!
> 
> There is hope.  The bdist_wininst command in Python 2.2
> does not include key changes added by Thomas Heller
> added on Feb 20th (rev 1.29 in CVS).  I downloaded this one 
> and overwrote my existing copy and found I could add an install 
> script. What's more, print statements even show up in the final
> GUI window, and you can make windows shortcuts.  
> 
> So, if you had a 'wininstall.py' script, you would do:
> 
> >python setup.py bdist_wininst --install-script wininstall.py
> 

I just checked in a new version of bdist_wininst with new features.
There's no documentation currently, but I posted an pre/post
install script for PythonCard to the pythoncard mailing list,
which can give you some hints.

You can use it on Python 2.2 and also on older versions to *build* the
installer, but you have to grab distutils from CVS.

Thomas





From twisted at itamarst.org  Wed Oct 16 20:09:01 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 16 Oct 2002 20:09:01 -0400
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <1034793181.1935.35.camel@giantclam>
References: <1034793181.1935.35.camel@giantclam>
Message-ID: <20021016200901.40961400.twisted@itamarst.org>

On 16 Oct 2002 14:33:01 -0400
Gil Hauer <gilh at sympatico.ca> wrote:

> Is it possible to use Twisted.web with virtual host functionality such
> as that provided by Apache?

Sure, look at twisted.web.vhost module.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From twisted at moshez.org  Thu Oct 17 01:24:40 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 17 Oct 2002 05:24:40 -0000
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <1034793181.1935.35.camel@giantclam>
References: <1034793181.1935.35.camel@giantclam>
Message-ID: <20021017052440.22779.qmail@green.zadka.com>

On 16 Oct 2002, Gil Hauer <gilh at sympatico.ca> wrote:

> I'd like one server to be able to host several web sites, hence:
> 
> Is it possible to use Twisted.web with virtual host functionality such
> as that provided by Apache?

Is it ever!
You can decide to go with one big process for all of them, a front server
and a seperate server for each virtual host (for example, for permission
reasons), and you can even mix-and-math between Apache and Twisted (for
example, put Apache in the front and have Twisted handle some subset of the
virtual host).  



From twisted at moshez.org  Thu Oct 17 05:22:17 2002
From: twisted at moshez.org (Moshe Zadka)
Date: Thu, 17 Oct 2002 04:22:17 -0500
Subject: [Twisted-Python] websetroot
Message-ID: <E1826rB-0000Hw-00@pyramid.twistedmatrix.com>

I don't want to check in a new utility without some discussion. Here is the
patch:

diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/ChangeLog Twisted/ChangeLog
--- Twisted.clean/ChangeLog	Tue Oct 15 07:04:57 2002
+++ Twisted/ChangeLog	Thu Oct 17 04:18:18 2002
@@ -1,3 +1,8 @@
+2002-10-17  Moshe Zadka <moshez at twistedmatrix.com>
+
+	* bin/websetroot twisted/scripts/websetroot.py: Added a program to set
+	the root of a web server after the tap exists
+
 2002-10-14  Moshe Zadka <moshez at twistedmatrix.com>
 
 	* twisted/web/vhost.py: add a virtual host monster to support twisted
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/bin/websetroot Twisted/bin/websetroot
--- Twisted.clean/bin/websetroot	Wed Dec 31 18:00:00 1969
+++ Twisted/bin/websetroot	Thu Oct 17 03:22:21 2002
@@ -0,0 +1,29 @@
+#!/usr/bin/env python
+
+# Twisted, the Framework of Your Internet
+# Copyright (C) 2001 Matthew W. Lefkowitz
+#
+# This library is free software; you can redistribute it and/or
+# modify it under the terms of version 2.1 of the GNU Lesser General Public
+# License as published by the Free Software Foundation.
+#
+# This library is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# Lesser General Public License for more details.
+#
+# You should have received a copy of the GNU Lesser General Public
+# License along with this library; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+
+### Twisted Preamble
+# This makes sure that users don't have to set up their environment
+# specially in order to run these programs from bin/.
+import sys, os, string
+if string.find(os.path.abspath(sys.argv[0]), os.sep+'Twisted') != -1:
+    sys.path.insert(0, os.path.normpath(os.path.join(os.path.abspath(sys.argv[0]), os.pardir, os.pardir)))
+sys.path.insert(0, os.curdir)
+### end of preamble
+
+from twisted.scripts.websetroot import run
+run()
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/doc/examples/index.html Twisted/doc/examples/index.html
--- Twisted.clean/doc/examples/index.html	Thu Oct 17 03:46:45 2002
+++ Twisted/doc/examples/index.html	Thu Oct 17 04:20:02 2002
@@ -87,6 +87,7 @@
         <li><a href="hello.rpy.py">hello.rpy.py</a></li>
         <li><a href="simple.rtl">simple.rtl</a></li>
 	<li><a href="courier.py">courier.py</a></li>
+	<li><a href="rootscript.py">rootscript.py</a></li>
     </ul>
     
     <h2>Obsolete?</h2>
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/doc/examples/rootscript.py Twisted/doc/examples/rootscript.py
--- Twisted.clean/doc/examples/rootscript.py	Wed Dec 31 18:00:00 1969
+++ Twisted/doc/examples/rootscript.py	Thu Oct 17 03:42:57 2002
@@ -0,0 +1,9 @@
+from twisted.web import vhost, static, script
+
+default = static.Data('text/html', '')
+default.putChild('vhost', vhost.VHostMonsterResource())
+resource = vhost.NameVirtualHost()
+resource.default = default
+file = static.File('static')
+file.processors = {'.rpy': script.ResourceScript}
+resource.addHost('twistedmatrix.com', file)
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/doc/man/index.html Twisted/doc/man/index.html
--- Twisted.clean/doc/man/index.html	Thu Oct  3 14:24:18 2002
+++ Twisted/doc/man/index.html	Thu Oct 17 04:17:34 2002
@@ -19,6 +19,7 @@
 <li><a href="tap2deb.html"> tap2deb</a></li>
 <li><a href="tapconvert.html">tapconvert</a></li>
 <li><a href="twistd.html">twistd</a></li>
+<li><a href="websetroot.html">websetroot</a></li>
 </ul>
 
 </body></html>
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/doc/man/websetroot.1 Twisted/doc/man/websetroot.1
--- Twisted.clean/doc/man/websetroot.1	Wed Dec 31 18:00:00 1969
+++ Twisted/doc/man/websetroot.1	Thu Oct 17 04:17:15 2002
@@ -0,0 +1,36 @@
+.TH WEBSETROOT "1" "July 2001" "" ""
+.SH NAME
+websetroot \- set the root of a Twisted web server
+.SH SYNOPSIS
+.B websetroot {-f \fItapfile\fR | -y \fIcodefile\fR | -x \fIXML\fR | -s \fIAOT\fR } {--pickle \fIpickle\fR | --script \fIscript\fR } [ -e ] [--port \fIport\fR]
+.B websetroot --help
+.SH DESCRIPTION
+.PP
+The \fB\--help\fR prints out a usage message to standard output.
+.TP \fB-e\fR, \fB--encrypted\fR
+The specified tap/aos/xml file is encrypted.
+.TP \fB-p\fR, \fB--port\fR <port>
+The port the web server is running on [default: 80]
+.TP \fB-f\fR, \fB--file\fR <file>
+read the given .tap file [default: twistd.tap]
+.TP \fB-y\fR, \fB--python\fR <file>
+read an application from within a Python file
+.TP \fB-x\fR, \fB--xml\fR <file>
+Read an application from a .tax file (Marmalade format).
+.TP \fB-s\fR, \fB--source\fR <file>
+Read an application from a .tas file (AOT format).
+.TP \fB--script\fR <file>
+Read the root resource from the given resource script file
+.TP \fB--pickle\fR <file>
+Read the root resource from the given resource pickle file
+.SH AUTHOR
+Written by Moshe Zadka, based on websetroot's help messages
+.SH "REPORTING BUGS"
+Report bugs to <twisted-python at twistedmatrix.com>.
+.SH COPYRIGHT
+Copyright \(co 2000 Matthew W. Lefkowitz
+.br
+This is free software; see the source for copying conditions.  There is NO
+warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
+.SH "SEE ALSO"
+mktap(1)
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/twisted/scripts/websetroot.py Twisted/twisted/scripts/websetroot.py
--- Twisted.clean/twisted/scripts/websetroot.py	Wed Dec 31 18:00:00 1969
+++ Twisted/twisted/scripts/websetroot.py	Thu Oct 17 03:33:35 2002
@@ -0,0 +1,75 @@
+# Twisted, the Framework of Your Internet
+# Copyright (C) 2001-2002 Matthew W. Lefkowitz
+# 
+# This library is free software; you can redistribute it and/or
+# modify it under the terms of version 2.1 of the GNU Lesser General Public
+# License as published by the Free Software Foundation.
+# 
+# This library is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# Lesser General Public License for more details.
+# 
+# You should have received a copy of the GNU Lesser General Public
+# License along with this library; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+# 
+from twisted.scripts import twistd
+from twisted.python import usage
+
+class Options(usage.Options):
+
+    optFlags = [
+                ['encrypted', 'e' ,
+                 "The specified tap/aos/xml file is encrypted."]
+               ]
+
+
+    optParameters = [
+                  ['port','p', 80,
+                   "The port the web server is running on"],
+                  ['file','f','twistd.tap',
+                   "read the given .tap file"],
+                  ['python','y', None,
+                   "read an application from within a Python file"],
+                  ['xml', 'x', None,
+                   "Read an application from a .tax file (Marmalade format)."],
+                  ['source', 's', None,
+                   "Read an application from a .tas file (AOT format)."],
+                    ]
+
+    def opt_script(self, scriptname):
+        d = {}
+        execfile(scriptname, d)
+        self['root'] = d['resource']
+
+    def opt_pickle(self, picklename):
+        self['root'] = cPickle.load(open(picklename))
+ 
+
+def getFactory(app, port):
+    for (num, fact, _, _) in app.tcpPorts:
+        if num == port:
+            return fact
+    raise LookupError('no such port')
+
+def main(config):
+    if config['encrypted']:
+        import getpass
+        passphrase = getpass.getpass('Passphrase: ')
+    else:
+        passphrase = None
+    application = twistd.loadApplication(config, passphrase)
+    site = getFactory(application, int(config['port']))
+    site.resource = config['root']
+    application.save()
+
+
+def run():
+    import sys
+    config = Options()
+    config.parseOptions()
+    try:
+        main(config)
+    except LookupError, err:
+        sys.exit(sys.argv[0]+": "+str(err))




From gilh at sympatico.ca  Thu Oct 17 09:50:32 2002
From: gilh at sympatico.ca (Gil Hauer)
Date: 17 Oct 2002 09:50:32 -0400
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <20021017052440.22779.qmail@green.zadka.com>
References: <1034793181.1935.35.camel@giantclam> 
	<20021017052440.22779.qmail@green.zadka.com>
Message-ID: <1034862633.1877.5.camel@giantclam>

Thanks to all for the information and the pointers!

Gil

On Thu, 2002-10-17 at 01:24, Moshe Zadka wrote:
> On 16 Oct 2002, Gil Hauer <gilh at sympatico.ca> wrote:
> 
> > I'd like one server to be able to host several web sites, hence:
> > 
> > Is it possible to use Twisted.web with virtual host functionality such
> > as that provided by Apache?
> 
> Is it ever!
> You can decide to go with one big process for all of them, a front server
> and a seperate server for each virtual host (for example, for permission
> reasons), and you can even mix-and-math between Apache and Twisted (for
> example, put Apache in the front and have Twisted handle some subset of the
> virtual host).  
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021017/87b6a9ab/attachment.pgp 

From john.abel at pa.press.net  Thu Oct 17 10:03:28 2002
From: john.abel at pa.press.net (John Abel)
Date: Thu, 17 Oct 2002 15:03:28 +0100
Subject: [Twisted-Python] Addition to twisted.python.logfile
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com>
Message-ID: <3DAEC330.4050207@pa.press.net>

Hi,

Please go gently with me, this is my first submitted "enhancement"! 
 I've made a small change to twisted.python.logfile, adding the option 
to gzip the log files, once they've been renamed (default is not to 
compress).

I couldn't find any info on submitting a change, so I've attached the 
output from a diff logfile.py logfileII.py

Hope you find it useful.

Regards

John

< import os, stat, glob, string
---
 > import os, stat, glob, string, gzip, fileinput, re
37d36
<
39c38
<     def __init__(self, name, directory, rotateLength=1000000):
---
 >     def __init__(self, name, directory, rotateLength=1000000, 
compressLog=0):
43a43,49
 >         if not compressLog in [0,1]:
 >             self.compressLog = 0
 >         else:
 >             self.compressLog = compressLog
 >         self.globFilePattern = ["%s.*", "%s.*.gz"]
 >         self.renameFilePattern = ["%s.%d","%s.%d.gz"]
 >         self.rePattern = [".*\.(\d)$",".*\.(\d)\.gz$"]
90c96
<         for name in glob.glob("%s.*" % self.path):
---
 >         for name in glob.glob(self.globFilePattern[self.compressLog] 
% self.path):
92,94c98,102
<                 counter = int(string.split(name, '.')[-1])
<                 if counter:
<                     result.append(counter)
---
 >                 reCounter = 
re.match(self.rePattern[self.compressLog],name)
 >                 if reCounter:
 >                     counter = int( reCounter.group(1) )
 >                     if counter:
 >                         result.append(counter)
111c119
<             os.rename("%s.%d" % (self.path, i), "%s.%d" % (self.path, 
i + 1))
---
 >             os.rename(self.renameFilePattern[self.compressLog] % 
(self.path, i), self.renameFilePattern[self.compressLog] % (self.path, i 
+ 1113a122,126






From twisted at moshez.org  Thu Oct 17 12:30:32 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 17 Oct 2002 16:30:32 -0000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <3DAEC330.4050207@pa.press.net>
References: <3DAEC330.4050207@pa.press.net>, <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com>
Message-ID: <20021017163032.30766.qmail@green.zadka.com>

On Thu, 17 Oct 2002, John Abel <john.abel at pa.press.net> wrote:

> Please go gently with me, this is my first submitted "enhancement"! 

Please submit patches as "unified diffs" (diff -u). Otherwise,
they are somewhat hard to read.



From twisted at itamarst.org  Thu Oct 17 15:35:53 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 17 Oct 2002 15:35:53 -0400
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <3DAEC330.4050207@pa.press.net>
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com>
	<3DAEC330.4050207@pa.press.net>
Message-ID: <20021017153553.275ae8ed.twisted@itamarst.org>

On Thu, 17 Oct 2002 15:03:28 +0100
John Abel <john.abel at pa.press.net> wrote:

> Please go gently with me, this is my first submitted "enhancement"! 
>  I've made a small change to twisted.python.logfile, adding the option
>  
> to gzip the log files, once they've been renamed (default is not to 
> compress).

It's a good idea - I've wanted to support that. Could you add detecting
if zlib isn't installed so it doesn't blow up?

Also you need to agree to give copyright to glyph or whatever the
current phrasing is (see doc/legal).

Here's a question for the list in general - wouldn't it better to do the
compression in a thread?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From z3p at twistedmatrix.com  Thu Oct 17 15:58:51 2002
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Thu, 17 Oct 2002 14:58:51 -0500
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021017153553.275ae8ed.twisted@itamarst.org>
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net> <20021017153553.275ae8ed.twisted@itamarst.org>
Message-ID: <20021017195851.GA29573@pyramid.twistedmatrix.com>

On Thu, Oct 17, 2002 at 03:35:53PM -0400, Itamar Shtull-Trauring wrote:
> Here's a question for the list in general - wouldn't it better to do the
> compression in a thread?

isn't compression fast enough that we can assume it doesn't block?
-p

-- 
       Paul Swartz
(o_    http://www.twistedmatrix.com/users/z3p.twistd/  _o)
//\    z3p at twistedmatrix.com                           /\\
V_/_   AIM: z3penguin                                 _\_V->

Democracy is the recurrent suspicion that more than half the people are right
more than half of the time.



From bruce at cubik.org  Thu Oct 17 16:09:58 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Thu, 17 Oct 2002 14:09:58 -0600
Subject: [Twisted-Python] Addition to twisted.python.logfile
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net> <20021017153553.275ae8ed.twisted@itamarst.org> <20021017195851.GA29573@pyramid.twistedmatrix.com>
Message-ID: <3DAF1916.50001@cubik.org>

Paul Swartz wrote:
> On Thu, Oct 17, 2002 at 03:35:53PM -0400, Itamar Shtull-Trauring wrote:
>>Here's a question for the list in general - wouldn't it better to do the
>>compression in a thread?
> 
> isn't compression fast enough that we can assume it doesn't block?

Not really.  For decent sized log files (well over a meg), it can take a 
noticeable time and with Twisted, that's too much time.  It shouldn't be 
an issue or that hard to do the compression in a thread anyway.

  - Bruce




From andy at reportlab.com  Thu Oct 17 16:39:33 2002
From: andy at reportlab.com (Andy Robinson)
Date: Thu, 17 Oct 2002 21:39:33 +0100
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021017195851.GA29573@pyramid.twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAAENGCMAA.andy@reportlab.com>

> isn't compression fast enough that we can assume it doesn't block?

What's a good guideline duration for a CPU-heavy job before one 
should consider threading?  0.01 sec? 0.1 sec? 1 sec?

totally-new-to-parallel-stuff-ly yours,

Andy 




From jjn at kriln.com  Thu Oct 17 16:52:55 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Thu, 17 Oct 2002 20:52:55 +0000 (GMT)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <LKENLBBMDHMKBECHIAIAAENGCMAA.andy@reportlab.com>
Message-ID: <20021017205224.P21120-100000@nosferatu.kriln.com>

On Thu, 17 Oct 2002, Andy Robinson wrote:

> What's a good guideline duration for a CPU-heavy job before one
> should consider threading?  0.01 sec? 0.1 sec? 1 sec?

Thread when it becomes a problem.  Don't thread unless you have to, or
know something will be a problem from past experience.




From ericmangold at myrealbox.com  Thu Oct 17 19:32:11 2002
From: ericmangold at myrealbox.com (Eric Mangold)
Date: Thu, 17 Oct 2002 16:32:11 -0700
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <3DAEC330.4050207@pa.press.net>
References: <3DAEC330.4050207@pa.press.net>, <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <20021017163032.30766.qmail@green.zadka.com>
Message-ID: <3DAF487B.6030408@myrealbox.com>

Moshe Zadka wrote:

>Please submit patches as "unified diffs" (diff -u).
>
Would anyone care to add this on 
http://twistedmatrix.com/developers/contributing ?

-Eric




From barry at python.org  Thu Oct 17 17:56:13 2002
From: barry at python.org (Barry A. Warsaw)
Date: Thu, 17 Oct 2002 17:56:13 -0400
Subject: [Twisted-Python] nntp protocol supports moderated newsgroups?
Message-ID: <15791.12797.768063.913733@gargle.gargle.HOWL>

Quick question regarding Twisted's nntp server.  Please CC me, as I am
not on this mailing list.

I need to do some testing of moderated newsgroup support in Mailman.
Does Twisted's nntp server support moderated newsgroups?  If not, I'll
look into hacking it in, but I wanted to make sure I'm not duplicating
existing work.

Thanks,
-Barry



From exarkun at twistedmatrix.com  Thu Oct 17 18:06:11 2002
From: exarkun at twistedmatrix.com (Jp Calderone)
Date: Thu, 17 Oct 2002 18:06:11 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>
Message-ID: <3DAF3453.4030306@twistedmatrix.com>

Barry A. Warsaw wrote:

>Quick question regarding Twisted's nntp server.  Please CC me, as I am
>not on this mailing list.
>
>I need to do some testing of moderated newsgroup support in Mailman.
>Does Twisted's nntp server support moderated newsgroups?  If not, I'll
>look into hacking it in, but I wanted to make sure I'm not duplicating
>existing work.
>
>Thanks,
>-Barry
>
  There's a "flags" field for this, but no support beyond that.  Should 
be pretty
easy to stick in the appropriate checks/changes for it.  Would be glad 
to see it
added :)

  Jp





From barry at python.org  Thu Oct 17 18:13:48 2002
From: barry at python.org (Barry A. Warsaw)
Date: Thu, 17 Oct 2002 18:13:48 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>
	<3DAF3453.4030306@twistedmatrix.com>
Message-ID: <15791.13852.867292.398473@gargle.gargle.HOWL>

>>>>> "JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:

    JC>   There's a "flags" field for this, but no support beyond
    JC> that.  Should be pretty easy to stick in the appropriate
    JC> checks/changes for it.  Would be glad to see it added :)

Cool, I'll take a look.  Any hints on where to start (file names)
would appreciated! :)

-Barry



From exarkun at twistedmatrix.com  Thu Oct 17 18:27:30 2002
From: exarkun at twistedmatrix.com (Jp Calderone)
Date: Thu, 17 Oct 2002 18:27:30 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>	<3DAF3453.4030306@twistedmatrix.com> <15791.13852.867292.398473@gargle.gargle.HOWL>
Message-ID: <3DAF3952.4050707@twistedmatrix.com>

Barry A. Warsaw wrote:

>>>>>>"JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:
>>>>>>            
>>>>>>
>
>    JC>   There's a "flags" field for this, but no support beyond
>    JC> that.  Should be pretty easy to stick in the appropriate
>    JC> checks/changes for it.  Would be glad to see it added :)
>
>Cool, I'll take a look.  Any hints on where to start (file names)
>would appreciated! :)
>
>-Barry
>  
>
 Hmm,  twisted/news/database.py should have all the stuff it needs 
already -
maybe makeGroupSQL() will need to be modified a bit so that
twisted/tap/news.py can tell it which groups should be moderated and which
shouldn't.  twisted/tap/news.py will probably have most of the action; 
it'll need
code to let the user specify moderated/unmoderated to mktap somehow, maybe
with another --groups parameter, or with some indicator in the groups file.

Maybe it's time twisted.news got a *real* configuration interface :) 
 I'll ponder
that a little (maybe something fun with woven), and if you(/anyone else) 
have
any ideas on this, I'd love to hear them.

  Jp






From twisted at itamarst.org  Thu Oct 17 21:16:14 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 17 Oct 2002 21:16:14 -0400
Subject: [Twisted-Python] 1.0.0rc2 is out - please test installation
Message-ID: <20021017211615.19be28af.twisted@itamarst.org>

We'd like everyone to chime in and say "yes, this installed on my
platform" so we can be assured that's working - please send them to
moshez at twistedmatrix.com/

In terms of code 1.0 == 0.99.4, so if you're looking for new
functionality you may as well stick to CVS until we do 1.0.1.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From jepler at unpythonic.net  Thu Oct 17 22:19:52 2002
From: jepler at unpythonic.net (Jeff Epler)
Date: Thu, 17 Oct 2002 21:19:52 -0500
Subject: [Twisted-Python] stop twitching unittest window
Message-ID: <20021017211950.A5043@unpythonic.net>

--- unittestgui.py.orig	Thu Oct 17 21:12:41 2002
+++ unittestgui.py	Thu Oct 17 21:13:31 2002
@@ -217,7 +217,7 @@
         # Status bar
         statusFrame = tk.Frame(self.top, relief=tk.SUNKEN, borderwidth=2)
         statusFrame.pack(anchor=tk.SW, fill=tk.X, side=tk.BOTTOM)
-        tk.Label(statusFrame, textvariable=self.statusVar).pack(side=tk.LEFT)
+        tk.Label(statusFrame, textvariable=self.statusVar, width=80, anchor="w").pack(side=tk.LEFT)
 
 	# Area to enter name of test to run
         leftFrame = tk.Frame(self.top, borderwidth=3)



From john.abel at pa.press.net  Fri Oct 18 07:29:08 2002
From: john.abel at pa.press.net (John Abel)
Date: Fri, 18 Oct 2002 12:29:08 +0100
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net>
Message-ID: <3DAFF084.1030600@pa.press.net>

Hi,

Enclosed is an updated logfile.py, with zlib detection - If zlib isn't
imported, compression is turned off.  Please feel to free to
include/tidy up as appropriate.  I've tested the example rotatelog
script with the new logfile.py, on a 10MB file, and it takes around 6-8
seconds to compress, on my laptop (P3-700, 256MB, Mandrake9, Python
2.2.2).

Regards

John

--- /usr/local/lib/python2.2/site-packages/twisted/python/logfile.py
2002-10-18 10:22:17.000000000 +0100
+++
/usr/local/lib/python2.2/site-packages/twisted/python/logfileII.py
2002-10-18 11:57:40.000000000 +0100
@@ -20,7 +20,14 @@
  """

  # System Imports
-import os, stat, glob, string
+import os, stat, glob, string, fileinput, re
+
+try:
+    import gzip
+except ImportError:
+    zlibInstalled = 0
+else:
+    zlibInstalled = 1

  # sibling imports

@@ -34,13 +41,21 @@
      """

      synchronized = ["write", "rotate"]
-

-    def __init__(self, name, directory, rotateLength=1000000):
+
+    def __init__(self, name, directory, rotateLength=1000000,
compressLog=0):
          self.directory = directory
          self.name = name
          self.path = os.path.join(directory, name)
          self.rotateLength = rotateLength
+        if not (compressLog in [0,1] or zlibInstalled):
+            self.compressLog = 0
+        else:
+            self.compressLog = compressLog
+
+        self.globFilePattern = ["%s.*", "%s.*.gz"]
+        self.renameFilePattern = ["%s.%d","%s.%d.gz"]
+        self.rePattern = [".*\.(\d)$",".*\.(\d)\.gz$"]
          self._openFile()

      def _openFile(self):
@@ -87,11 +102,13 @@
      def listLogs(self):
          """Return sorted list of integers - the old logs' identifiers."""
          result = []
-        for name in glob.glob("%s.*" % self.path):
+        for name in glob.glob(self.globFilePattern[self.compressLog] %
self.path):
              try:
-                counter = int(string.split(name, '.')[-1])
-                if counter:
-                    result.append(counter)
+                reCounter = re.match(self.rePattern[self.compressLog],name)
+                if reCounter:
+                    counter = int( reCounter.group(1) )
+                    if counter:
+                        result.append(counter)
              except ValueError:
                  pass
          result.sort()
@@ -108,9 +125,14 @@
          logs = self.listLogs()
          logs.reverse()
          for i in logs:
-            os.rename("%s.%d" % (self.path, i), "%s.%d" % (self.path, i
+ 1))
+            os.rename(self.renameFilePattern[self.compressLog] %
(self.path, i), self.renameFilePattern[self.compressLog] % (self.path, i
+ 1))
          self._file.close()
          os.rename(self.path, "%s.1" % self.path)
+        if self.compressLog:
+            gZippedFile = gzip.GzipFile("%s.1.gz" % self.path,'wb')
+            for LogLine in fileinput.input("%s.1" % self.path):
+                gZippedFile.write(LogLine)
+            gZippedFile.close()
          self._openFile()

      def getCurrentLog(self):
@@ -143,8 +165,6 @@
              line = self._file.readline()
              if not line:
                  break
-            result.append(line)
-        return result
-
      def close(self):
          self._file.close()
+





From twisted at moshez.org  Fri Oct 18 07:52:36 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 18 Oct 2002 11:52:36 -0000
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
In-Reply-To: <3DAFF084.1030600@pa.press.net>
References: <3DAFF084.1030600@pa.press.net>, <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net>
Message-ID: <20021018115236.11347.qmail@green.zadka.com>

On Fri, 18 Oct 2002, John Abel <john.abel at pa.press.net> wrote:
 
> Enclosed is an updated logfile.py, with zlib detection - If zlib isn't
> imported, compression is turned off.  Please feel to free to
> include/tidy up as appropriate.  I've tested the example rotatelog
> script with the new logfile.py, on a 10MB file, and it takes around 6-8
> seconds to compress, on my laptop (P3-700, 256MB, Mandrake9, Python
> 2.2.2).

A few comments

1. Please get your mailer to not word-wrap in patches.
2. In general, you should submit patches from inside the CVS working
   copy, not from the installed version
3. As I read your patch, this means that a Twisted server would be
   unresponsive for 6 seconds while it is compressing. This is, in general,
   unacceptable.
4. Perhaps it would be better to use the "gzip" program, via the process
   API. A simple way to hook into logfile.py so we could add a hook to
   utils.getProcessValue("/usr/bin/gzip", args=[old_name]) would seem simpler
   and possibly even more efficient.
5. Perhaps the correct thing to do is make Logfile subclassable enough so
   a compressing Logfile could be written as a subclass. 



From twisted at itamarst.org  Fri Oct 18 10:53:59 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 18 Oct 2002 10:53:59 -0400
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
In-Reply-To: <20021018115236.11347.qmail@green.zadka.com>
References: <3DAFF084.1030600@pa.press.net>
	<20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com>
	<3DAEC330.4050207@pa.press.net>
	<20021018115236.11347.qmail@green.zadka.com>
Message-ID: <20021018105359.5024e46f.twisted@itamarst.org>

On 18 Oct 2002 11:52:36 -0000
Moshe Zadka <twisted at moshez.org> wrote:

> 2. In general, you should submit patches from inside the CVS working
>    copy, not from the installed version

Yeah - but in this case it's fine.

> 3. As I read your patch, this means that a Twisted server would be
>    unresponsive for 6 seconds while it is compressing. This is, in
>    general, unacceptable.

Yes, we're going to have to use a thread for this - would you care to do
it John? If not I'll hang on to your patch and use it as a basis when I
get around to it.

> 4. Perhaps it would be better to use the "gzip" program, via the
> process
>    API. A simple way to hook into logfile.py so we could add a hook to
>    utils.getProcessValue("/usr/bin/gzip", args=[old_name]) would seem
>    simpler and possibly even more efficient.

And wouldn't work on Windows... The question is if we care about
compresssing logs on Windows. I think we should.

> 5. Perhaps the correct thing to do is make Logfile subclassable enough
> so
>    a compressing Logfile could be written as a subclass. 

I was thinking this at first, but in practice I don't see if there's
much point. What would it give us?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From iumarumo at eidosnet.co.uk  Fri Oct 18 11:59:31 2002
From: iumarumo at eidosnet.co.uk (Ibraheem Umaru-Mohammed)
Date: Fri, 18 Oct 2002 16:59:31 +0100
Subject: [Twisted-Python] Failed to run "im" out of the box...
Message-ID: <20021018155931.GA23928@micromuse.com>

Hi,

So, I downloaded Twisted 1.0.0rc2 - Release Candidate for UNIX.
Unpacked it, ran "python setup.py install".
Ran the "admin/runtests" tool, and 2 tests failed:

,---- [ admin/runtests ]
| Failure: testaNoPermission(twisted.test.test_logfile.LogFileTestCase)
| Failure: testFileRebuild(twisted.test.test_rebuild.RebuildTestCase)
`----

Assuming that 2/300 test failures were /still/ ok, I proceeded 
to attempt to run "im". This failed with the following, I have
also included a report of the packages installed and their current
versions:

		[--- begin report ---]
ibz at ignoramus:$ im
Traceback (most recent call last):
  File "/usr/bin/im", line 30, in ?
    im.run()
  File "./twisted/scripts/im.py", line 27, in run
    from twisted.im.gtkaccount import AccountManager
  File "./twisted/im/gtkaccount.py", line 21, in ?
    from twisted.im.gtkcommon import GLADE_FILE, SETTINGS_FILE, autoConnectMethods,\
  File "./twisted/im/gtkcommon.py", line 21, in ?
    from twisted.manhole.ui.pywidgets import isCursorOnFirstLine, isCursorOnLastLine
  File "./twisted/manhole/ui/pywidgets.py", line 9, in ?
    from twisted.spread.ui import gtkutil
  File "./twisted/spread/ui/gtkutil.py", line 62, in ?
    class GetString(gtk.GtkWindow):
AttributeError: 'module' object has no attribute 'GtkWindow'
ibz at ignoramus:$

ibz at ignoramus:$ rpm -qa | grep python
gnome-python2-canvas-1.99.11-8
rpm-python-4.1-1.06
pythonlib-1.23-1
libxml2-python-2.4.23-1
python-popt-0.8.8-7.x.2
python-2.2.1-17
orbit-python-1.99.0-4
python-optik-1.3-2
gnome-python2-gtkhtml2-1.99.11-8
gnome-python2-1.99.11-8
python-devel-2.2.1-17
pythonworks-test-1.2-20010328
rpm404-python-4.0.4-8x.27
python-xmlrpc-1.5.1-7.x.3
gnome-python2-bonobo-1.99.11-8
ibz at ignoramus:$

ibz at ignoramus:$ rpm -qa | grep gtk
gtkmm-devel-1.2.9-1.ximian.1
gtk2-2.0.6-8
rep-gtk-0.16.0.90-4
gtkglarea-1.2.2-13
libgtkhtml20-1.0.4-2.ximian.1
libgtkhtml19-0.16.1-ximian.1
gtk-themes-1.0.1-1.ximian.3
libgtkhtml16-0.13.0-ximian.1
libgtkhtml17-0.14.0-ximian.2
pygtk2-1.99.12-7
gtkmm-1.2.9-1.ximian.1
gtk-engines-0.12-ximian.10
libgtkhtml1.1-1-1.1.2-0.ximian.1
gnome-python2-gtkhtml2-1.99.11-8
usermode-gtk-1.63-1
gtk+10-1.0.6-10
gtk+-1.2.10-22
pygtk-0.6.9-3.ximian.6
pygtk-libglade-0.6.9-3.ximian.6
libgtkhtml18-0.15.0-ximian.2
gtkhtml2-2.0.1-2
gtkhtml-1.0.4-3
libgtkhtml15-0.12.0-ximian.6
pygtk2-libglade-1.99.12-7
gtk+-devel-1.2.10-22
gtkhtml-devel-1.0.4-3
ibz at ignoramus:$

ibz at ignoramus:$ python -V
Python 2.2.1
ibz at ignoramus:$
		[--- end report ---]

Platform Linux, Redhat 8.0.

Erm, can't think of anything else that might be of interest right now...
Let me know if you need any more information.

Kindest regards,

				--ibz.



From twisted at itamarst.org  Fri Oct 18 12:07:22 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 18 Oct 2002 12:07:22 -0400
Subject: [Twisted-Python] Failed to run "im" out of the box...
In-Reply-To: <20021018155931.GA23928@micromuse.com>
References: <20021018155931.GA23928@micromuse.com>
Message-ID: <20021018120722.08fb4042.twisted@itamarst.org>

On Fri, 18 Oct 2002 16:59:31 +0100
Ibraheem Umaru-Mohammed <iumarumo at eidosnet.co.uk> wrote:

> So, I downloaded Twisted 1.0.0rc2 - Release Candidate for UNIX.
> Unpacked it, ran "python setup.py install".
> Ran the "admin/runtests" tool, and 2 tests failed:
> 
> ,---- [ admin/runtests ]
> | Failure:
> | testaNoPermission(twisted.test.test_logfile.LogFileTestCase)
> | Failure: testFileRebuild(twisted.test.test_rebuild.RebuildTestCase)
> `----

I need to investigate the first, I've seen it happen sometimes too - I
suspect it's not serious (i.e. there's a good chance it always fails if
you run as root). As for the 2nd, upgrade to 2.2.2 and it'll go away.

The im issue is because, if I'm not mistake, the pygtk2 author gave it
the same name as original pygtk, even though it's different API.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andy at reportlab.com  Fri Oct 18 12:24:56 2002
From: andy at reportlab.com (Andy Robinson)
Date: Fri, 18 Oct 2002 17:24:56 +0100
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
In-Reply-To: <20021018105359.5024e46f.twisted@itamarst.org>
Message-ID: <PGECLPOBGNBNKHNAGIJHAEMFDOAA.andy@reportlab.com>

> And wouldn't work on Windows... The question is if we care about
> compresssing logs on Windows. I think we should.

On windows you cannot even assume a command line zip program.
You'd have to shell a script of your own:-)
The good news is that zlib is available by default in the
Windows distribution; everybody will have it.

- Andy

p.s. apologies for not getting back onto distutils this
week - hope to test it tonight.





From iumarumo at eidosnet.co.uk  Fri Oct 18 12:57:34 2002
From: iumarumo at eidosnet.co.uk (Ibraheem Umaru-Mohammed)
Date: Fri, 18 Oct 2002 17:57:34 +0100
Subject: [Twisted-Python] Failed to run "im" out of the box...
In-Reply-To: <20021018120722.08fb4042.twisted@itamarst.org>
References: <20021018155931.GA23928@micromuse.com> <20021018120722.08fb4042.twisted@itamarst.org>
Message-ID: <20021018165734.GA24433@micromuse.com>

* Itamar Shtull-Trauring <twisted at itamarst.org> [2002-10-18 17:18]:

> On Fri, 18 Oct 2002 16:59:31 +0100
> Ibraheem Umaru-Mohammed <iumarumo at eidosnet.co.uk> wrote:
> 
> > So, I downloaded Twisted 1.0.0rc2 - Release Candidate for UNIX.
> > Unpacked it, ran "python setup.py install".
> > Ran the "admin/runtests" tool, and 2 tests failed:
> > 
> > ,---- [ admin/runtests ]
> > | Failure:
> > | testaNoPermission(twisted.test.test_logfile.LogFileTestCase)
> > | Failure: testFileRebuild(twisted.test.test_rebuild.RebuildTestCase)
> > `----
> 
> I need to investigate the first, I've seen it happen sometimes too - I
> suspect it's not serious (i.e. there's a good chance it always fails if
> you run as root). As for the 2nd, upgrade to 2.2.2 and it'll go away.
> 

Itamar, 

Thanks for responding. 

Upgrading to 2.2.2 and running the tests as non-root user gets rid of 
both failures for me.

> The im issue is because, if I'm not mistake, the pygtk2 author gave it
> the same name as original pygtk, even though it's different API.
> 

Hmmmn. Nevermind then.

			--ibz.
-- 



From screwtape at froup.com  Sat Oct 19 03:08:34 2002
From: screwtape at froup.com (Tim Allen)
Date: Sat, 19 Oct 2002 17:08:34 +1000
Subject: [Twisted-Python] 1.0.0rc2 is out - please test installation
In-Reply-To: <20021017211615.19be28af.twisted@itamarst.org>
Message-ID: <94EB033C-E331-11D6-BEB5-003065D61A3E@froup.com>

On Friday, October 18, 2002, at 11:16 AM, Itamar Shtull-Trauring wrote:

> We'd like everyone to chime in and say "yes, this installed on my
> platform" so we can be assured that's working - please send them to
> moshez at twistedmatrix.com/

1.0.0.rc3 installs fine here on Mac OS X 10.1.5, but CVS Twisted fails 
miserably (it can't find sys/poll.h)




From twisted at moshez.org  Sat Oct 19 06:57:25 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 19 Oct 2002 10:57:25 -0000
Subject: [Twisted-Python] Book, Documentation and Other Horrors
Message-ID: <20021019105725.25599.qmail@green.zadka.com>

Well, in my obviously biased opinion the book is somewhat decent.
It's actually quite close to being a good guide to Twisted.
Here are the sections we are missing:

     * Web Applications
          + Authentication on the web (AKA using t.w.guard)
     * Interactive Applications
          + Connecting an instance direct to the 'net: simple examples
            with PB
          + Interchanging State: Jumping Into Jelly
          + Interfacing PB with a client-side toolkit (tkutils, gtkutils)
     * Extending Twisted
          + Writing a new reactor
          + Wrapping a new kind of select()able resource
          + Wrapping a new kind of crypto algorithm



From andrew-twisted at puzzling.org  Sat Oct 19 08:02:07 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 19 Oct 2002 22:02:07 +1000
Subject: [Twisted-Python] doc/howto/telnet.html obsolete?
Message-ID: <20021019120207.GB463@frobozz.local>

At a glance, it seems to me that doc/howto/manhole.html covers everything
interesting from doc/howto/telnet.html, and is more up-to-date with
idiomatic Twisted usage?  Should we retire telnet.html?

-Andrew.




From screwtape at froup.com  Sat Oct 19 09:09:11 2002
From: screwtape at froup.com (Tim Allen)
Date: Sat, 19 Oct 2002 23:09:11 +1000
Subject: [Twisted-Python] Twisted IM fixes
Message-ID: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>

Well, last week I submitted a patch to add some features to Twisted's 
IRC protocol, and I mentioned on #twisted that I wanted to write a bot 
framework for IRC. Glyph asked (nicely) that if I was going to write a 
bot framework, could I please write it for twisted.im, rather than 
writing it for IRC directly.

I'm not yet committed to writing a bot framework for anything, but I 
*have* been poking around in twisted.im. Firstly, I found two little 
buglets in the im code (patch attached). Secondly, it took me quite a 
while to figure out the exact minimum I needed to implement to use the 
twisted.im bits - all the example code uses GUI interfaces which 
complicate things more than necessary.

I was wondering - would there be any interest in me polishing up my 
minimalist twisted.im client so it could be added to twisted.im or 
doc/examples or such?

-------------- next part --------------
A non-text attachment was scrubbed...
Name: twisted-irc.diff
Type: application/octet-stream
Size: 1308 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/06689f1e/attachment.obj 

From john.abel at pa.press.net  Sat Oct 19 10:22:51 2002
From: john.abel at pa.press.net (John Abel)
Date: Sat, 19 Oct 2002 15:22:51 +0100
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
Message-ID: <3DB16ABB.5000203@pa.press.net>

If it's OK, I will have a go on making it use a thread?  I have also 
made some fixes to it.  I will sumbit these all in one update.

Regards

John




From screwtape at froup.com  Sat Oct 19 10:28:30 2002
From: screwtape at froup.com (Tim Allen)
Date: Sun, 20 Oct 2002 00:28:30 +1000
Subject: [Twisted-Python] Twisted IM fixes
In-Reply-To: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>
Message-ID: <0A69B82D-E36F-11D6-849A-003065D61A3E@froup.com>

On Saturday, October 19, 2002, at 11:09 PM, Tim Allen wrote:
> I'm not yet committed to writing a bot framework for anything, but I 
> *have* been poking around in twisted.im. Firstly, I found two little 
> buglets in the im code (patch attached).

Oops - yes, I hereby give copyright to Glyph (Matthew W. Lefkowitz).




From paul at paulbaranowski.org  Sat Oct 19 12:30:11 2002
From: paul at paulbaranowski.org (Paul Baranowski)
Date: Sat, 19 Oct 2002 12:30:11 -0400
Subject: [Twisted-Python] Installing 0.99.4 on Windows
In-Reply-To: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
Message-ID: <000b01c2778c$d58eaf60$2501a8c0@blackstar>

I ran into some snags installing version 0.99.4 on windows by following
the installation instructions given online.

Here's what I had to do.  Perhaps the instructions given below can be
used to modify the installation section on the web page.

- Run the Windows installer.

- Make sure python.exe is in your path, if not, add it (for me, it was 
"C:\Program Files\Python2.2.1")

- Add "<Path_to_Python_Directory>\Scripts" to your path.  (For me, it
was "C:\Program Files\Python2.2.1\Scripts".

- Modify the Scripts\mktap.bat file (and all the twisted .bat files) so
that it reads:
@echo off
if NOT "%_4ver%" == "" PYTHON.EXE -c "from twisted.scripts.mktap import
run; run()" %$
if     "%_4ver%" == "" PYTHON.EXE -c "from twisted.scripts.mktap import
run; run()" %*

(What I changed: I basically took out the "C:\Program
Files\Python2.2\Python.exe" and replaced it with "Python.exe" - since
python is in our path at this point, we don't need an absolute path to
it, and the absolute path will only cause problems with people who have
different directory names - for example, I have python2.2.1.)

Here's the full list of files that need to be changed:
coil.bat
im.bat
manhole.bat
mktap.bat
tap2deb.bat
tapconvert.bat
twistd.bat

- Note for cygwin users: you must add ".bat" to the command names given
in the documentation.  For example, if it tells you to run mktap, type
mktap.bat instead.


Paul Baranowski






From paul at paulbaranowski.org  Sat Oct 19 12:37:20 2002
From: paul at paulbaranowski.org (Paul Baranowski)
Date: Sat, 19 Oct 2002 12:37:20 -0400
Subject: [Twisted-Python] Archive of Mailing List?
In-Reply-To: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
Message-ID: <000c01c2778d$cf11cea0$2501a8c0@blackstar>

Is there a (searchable) archive of the mailing list on the mailman
server somewhere?  If not, perhaps one should be started.  It is, after
all, literally just a click of a button in mailman.

Paul Baranowski






From twisted at moshez.org  Sat Oct 19 12:38:10 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 19 Oct 2002 16:38:10 -0000
Subject: [Twisted-Python] Installing 0.99.4 on Windows
In-Reply-To: <000b01c2778c$d58eaf60$2501a8c0@blackstar>
References: <000b01c2778c$d58eaf60$2501a8c0@blackstar>
Message-ID: <20021019163810.28748.qmail@green.zadka.com>

On Sat, 19 Oct 2002, "Paul Baranowski" <paul at paulbaranowski.org> wrote:

> I ran into some snags installing version 0.99.4 on windows by following
> the installation instructions given online.

Did you try 1.0.0rc3?




From paul at paulbaranowski.org  Sat Oct 19 12:42:25 2002
From: paul at paulbaranowski.org (Paul Baranowski)
Date: Sat, 19 Oct 2002 12:42:25 -0400
Subject: [Twisted-Python] QOTD Plugin Example
In-Reply-To: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
Message-ID: <000d01c2778e$8536fcf0$2501a8c0@blackstar>

I have been trying to go through the sample QOTD plugin documentation,
and when I get to the point where it says:

**********************************
Now the QOTD server is ready to be instantiated! Let's start up a server
and get a quote from it.

% mktap qotd       
Saving qotd application to qotd.tap...
Saved.
% twistd -f qotd.tap 
% nc localhost 8007
An apple a day keeps the doctor away.
% kill `cat twistd.pid`
***********************************

I run "mktap qotd" in my TwistedQuotes directory and I get this:

Unknown command: qotd
Usage:    mktap [options] <command> [command options]
...

What am I missing?

Paul Baranowski






From twisted at moshez.org  Sat Oct 19 12:54:58 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 19 Oct 2002 16:54:58 -0000
Subject: [Twisted-Python] QOTD Plugin Example
In-Reply-To: <000d01c2778e$8536fcf0$2501a8c0@blackstar>
References: <000d01c2778e$8536fcf0$2501a8c0@blackstar>
Message-ID: <20021019165458.28831.qmail@green.zadka.com>

On Sat, 19 Oct 2002, "Paul Baranowski" <paul at paulbaranowski.org> wrote:

> I run "mktap qotd" in my TwistedQuotes directory and I get this:

Did you add the directory containing the TwistedQuotes directory
to your PYTHONPATH?

'''
make sure that your TwistedQuotes directory is a package on your python path.
'''

Please try to read the HOWTO carefully.



From dp at twistedmatrix.com  Sat Oct 19 13:10:09 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Sat, 19 Oct 2002 10:10:09 -0700
Subject: [Twisted-Python] Twisted IM fixes
In-Reply-To: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>
Message-ID: <9F74B322-E385-11D6-B285-00039376B1AE@twistedmatrix.com>

On Saturday, October 19, 2002, at 06:09 AM, Tim Allen wrote:
>
> I was wondering - would there be any interest in me polishing up my 
> minimalist twisted.im client so it could be added to twisted.im or 
> doc/examples or such?
>

Yes, I'd love to see a command-line t-im client.

Donovan




From twisted at itamarst.org  Sat Oct 19 15:08:00 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 19 Oct 2002 15:08:00 -0400
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
In-Reply-To: <3DB16ABB.5000203@pa.press.net>
References: <3DB16ABB.5000203@pa.press.net>
Message-ID: <20021019150800.3c562dee.twisted@itamarst.org>

On Sat, 19 Oct 2002 15:22:51 +0100
John Abel <john.abel at pa.press.net> wrote:

> If it's OK, I will have a go on making it use a thread?  I have also 
> made some fixes to it.  I will sumbit these all in one update.

That'd be wonderful - thanks!

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From exarkun at twistedmatrix.com  Sat Oct 19 15:28:29 2002
From: exarkun at twistedmatrix.com (Jp Calderone)
Date: Sat, 19 Oct 2002 15:28:29 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>	<3DAF3453.4030306@twistedmatrix.com>	<15791.13852.867292.398473@gargle.gargle.HOWL>	<3DAF3952.4050707@twistedmatrix.com> <15793.34455.512573.39157@gargle.gargle.HOWL>
Message-ID: <3DB1B25D.30409@twistedmatrix.com>

Barry A. Warsaw wrote:

>>>>>>"JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:
>>>>>>            
>>>>>>
>
>    JC>  Hmm, twisted/news/database.py should have all the stuff it
>    JC> needs already - maybe makeGroupSQL() will need to be modified
>    JC> a bit so that twisted/tap/news.py can tell it which groups
>    JC> should be moderated and which shouldn't.  twisted/tap/news.py
>    JC> will probably have most of the action; it'll need code to let
>    JC> the user specify moderated/unmoderated to mktap somehow, maybe
>    JC> with another --groups parameter, or with some indicator in the
>    JC> groups file.
>
>    JC> Maybe it's time twisted.news got a *real* configuration
>    JC> interface :) I'll ponder that a little (maybe something fun
>    JC> with woven), and if you(/anyone else) have any ideas on this,
>    JC> I'd love to hear them.
>
>I don't really, since I'm fairly green in my Twisted use.  I will note
>that the news stuff seems a little more difficult to use than when I
>last looked at it (Twisted 0.19 I think).  I'm using Twisted from cvs
>now, so it's possible this stuff is just in flux.
>  
>
  I wish I could say that is the case -- I've just been motivated to 
work on other
projects lately.  I agree that it has gotten more complex, and I don't 
like it.  I've
recently been pointed at twisted.persisted.dirdbm, and my current 
thinking is
that PickleStorage and NewsStorageAugmentation should go away in favor of
a DirDBMStorage.  PickleStorage was never meant as anything more than a
toy, and the SQL stuff doesn't seem to have yielded any performance 
benefits,
probably due to the complexity of some of the common queries it is 
performing.

>Specifically:
>
>- What is the --servers switch for?  I couldn't actually find where
>  that was used in tap/news.py but it seemed required, so I fed it
>  nonsense. 
>
The file given to --servers should contain a list of news servers to which
to connect and share messages with.  This hasn't yet been tested 
thoroughly --
I have surprising difficulty finding a news server that implemented 
enough of
the protocol to let this work.  I guess the "user facing" servers are kept
intentionally non-functional for some reason.

>
>- I understand why "mktap news" requires an extra argument now, but it
>  would be nice if either the pickle or sql command were defaulted.  I
>  don't think I needed to specify "mktap news pickle" last time.  Hmm,
>  maybe if --file is given you can default to pickle?
>
Yea, this is new too, since pickle was the only legal command in the 
past.  If I
go with the dirdbm stuff, I'll probably make it the default and let 
pickle or sql
be specified if someone wants something different (Or pickle and sql might
quietly disappear - the prospect of maintaining 3 different backends - 2 of
which are likely useless to nearly everybody - is a little unpleasant).

>
>- I noticed some bugs in the code, a few of which I fixed, but some I
>  didn't.  I ran the server w/ twistd -n and watched the output.  I
>  got mysterious log messages such as:
>
>[...]
>19/10/2002 11:54 [*news*] Starting factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
>19/10/2002 11:54 [*news*] Connection failed: [Failure instance: Traceback! exceptions.IOError, address not found
>19/10/2002 11:54 [*news*] ]
>19/10/2002 11:54 [*news*] Connection failed: [Failure instance: Traceback! exceptions.IOError, address not found
>19/10/2002 11:54 [*news*] ]
>19/10/2002 11:54 [*news*] Stopping factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
>19/10/2002 11:55 [*news*] Starting factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
>[...]
>
>  While these repeated as long as the server was running, they didn't
>  seem to affect its operation.
>  
>
I'm guessing these are due to whatever you put in your server list file.

>- In news/news.py, buildProtocol() is trying to pass self.remoteHosts
>  to the self.protocol() call, but self.protocol() -- which is really
>  the nntp.NNTPServer class, doesn't take two arguments.
>
Thanks for the fix.

>In any event, I hacked in moderated group support by adding a
>-m/--moderators flag, which takes a file containing a list of
>newsgroup/moderator address pairs.  When a message is POSTed to a
>group, the list of target newsgroups is checked against the
>moderators.  If there is any match, and the article has no Approved
>header, the article is not posted, but instead emailed to the
>moderators address.  The value of the Approved header is completely
>ignored -- it just has to be there.  I believe this is pretty close to
>how Usenet s/w handles moderators.
>  
>
Hmm.  How does a moderator then approve the message?  The interface
I had envisioned was something closer to mailman's scheme, though this
is certainly easier on the server side :)

>A couple of kludges that should be cleaned up:
>
>- What to do if the list of target newsgroups has more than one
>  moderated newsgroup in it?  Off hand, I'm not sure what Usenet does
>  in this case.
>
I believe the correct behavior would be to post the message to all 
un-moderated
groups and hold the message for approval from the moderators of each 
moderated
group, posting it to each held group when the appropriate moderator 
approves it.
One issue I see with this, though, is if someone is a moderator for 
multiple groups
that a single message is sent to.  I'm not sure if/how you could/would 
approve the
message for one group but reject it for another.  Maybe once I 
understand how the
email approval system works this will become clear.

>
>- We really need a few more config options, including the smtp host
>  and port to use to send out the moderator's email, and the envelope
>  sender address to use in that email.  Both are hard coded in my
>  hack.
>
Indeed.

>
>- Any un-Twisted coding offenses. :)
>  
>
The only one I see is the use of smtplib.  Its sendmail method will very 
likely
block, possibly for a long time, hanging the entire server.  Aside from 
just being
nasty, this opens up the possibility for DoS on servers, simply by 
repeatedly mailing
a moderated group.  I'm going out of town for a week this coming 
tuesday, and I
doubt I'll have time to figure out how twisted.protocols.smtp.SMTPClient 
works
before then, so I'm going to hold off on committing this.  If you want 
to figure that
out and send another patch, that'd be great, otherwise I'll just take 
care of it when
I get back.

>So, in the grand tradition of scratching my own itch, but just enough
>so I can sleep, here's the patch.
>
>Oh, BTW, for someone who was completely green to the code base,
>Twisted is very nicely written.  It wasn't difficult at all to drill
>down to where I needed to make the changes.  JP's hints helped a lot
>too.  Yay!
>  
>
  Glad to hear it :)  Thanks for the patch.

  Jp





From glyph at twistedmatrix.com  Sat Oct 19 15:45:59 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 19 Oct 2002 14:45:59 -0500 (CDT)
Subject: [Twisted-Python] Twisted IM fixes
In-Reply-To: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>
References: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>
Message-ID: <20021019.144559.89042554.glyph@twistedmatrix.com>

On Sat, 19 Oct 2002 23:09:11 +1000, Tim Allen <screwtape at froup.com> wrote:
> I was wondering - would there be any interest in me polishing up my 
> minimalist twisted.im client so it could be added to twisted.im or 
> doc/examples or such?

Is this a minimalist bot-style client or a minimalist text-mode client?  In any
case, yes!  Either would be highly useful :) (and thanks for sending the patch
as an attachment ^_^)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/1490c06b/attachment.pgp 

From ritterjoshua at msn.com  Fri Oct 18 09:10:10 2002
From: ritterjoshua at msn.com (Joshua Ritter)
Date: Fri, 18 Oct 2002 08:10:10 -0500
Subject: [Twisted-Python] Twisted and the Torque Game Engine
Message-ID: <000801c276a7$b0c9b3e0$0200000a@spunk>

Hooray!  Torque and Twisted taste great together!

Torque is the Tribes2 game engine available for license at www.garagegames.com 

It runs on Win32, Mac, and Linux and is quite robust... in fact, I have written a Python binding for it... and used this binding to hook up Twisted... 

Here is my post on their forum:

-------------------------------

I have used TGEPython (with small improvements) to hook up Twisted and Torque...  

Twisted is Python internet/distributed computing framework... it has support for many internet protocols and includes a very cool distributed object/RPC system... it also has an authorization (security) model and DB-API 2.0 database support... 

I am currently using Twisted for a Torque distributed content system (assets and database)... it will also be used in my server hierarchy: Master, World, Zone

I wrote a TorqueReactor for Twisted(quite trivial), the only time killer was running into a FPU precision problem... 

Enough of my yacking, check them out: www.twistedmatrix.com

-J

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20021018/53d5a748/attachment.htm 

From barry at python.org  Sat Oct 19 12:21:43 2002
From: barry at python.org (Barry A. Warsaw)
Date: Sat, 19 Oct 2002 12:21:43 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>
	<3DAF3453.4030306@twistedmatrix.com>
	<15791.13852.867292.398473@gargle.gargle.HOWL>
	<3DAF3952.4050707@twistedmatrix.com>
Message-ID: <15793.34455.512573.39157@gargle.gargle.HOWL>


>>>>> "JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:

    JC>  Hmm, twisted/news/database.py should have all the stuff it
    JC> needs already - maybe makeGroupSQL() will need to be modified
    JC> a bit so that twisted/tap/news.py can tell it which groups
    JC> should be moderated and which shouldn't.  twisted/tap/news.py
    JC> will probably have most of the action; it'll need code to let
    JC> the user specify moderated/unmoderated to mktap somehow, maybe
    JC> with another --groups parameter, or with some indicator in the
    JC> groups file.

    JC> Maybe it's time twisted.news got a *real* configuration
    JC> interface :) I'll ponder that a little (maybe something fun
    JC> with woven), and if you(/anyone else) have any ideas on this,
    JC> I'd love to hear them.

I don't really, since I'm fairly green in my Twisted use.  I will note
that the news stuff seems a little more difficult to use than when I
last looked at it (Twisted 0.19 I think).  I'm using Twisted from cvs
now, so it's possible this stuff is just in flux.

Specifically:

- What is the --servers switch for?  I couldn't actually find where
  that was used in tap/news.py but it seemed required, so I fed it
  nonsense. 

- I understand why "mktap news" requires an extra argument now, but it
  would be nice if either the pickle or sql command were defaulted.  I
  don't think I needed to specify "mktap news pickle" last time.  Hmm,
  maybe if --file is given you can default to pickle?

- I noticed some bugs in the code, a few of which I fixed, but some I
  didn't.  I ran the server w/ twistd -n and watched the output.  I
  got mysterious log messages such as:

[...]
19/10/2002 11:54 [*news*] Starting factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
19/10/2002 11:54 [*news*] Connection failed: [Failure instance: Traceback! exceptions.IOError, address not found
19/10/2002 11:54 [*news*] ]
19/10/2002 11:54 [*news*] Connection failed: [Failure instance: Traceback! exceptions.IOError, address not found
19/10/2002 11:54 [*news*] ]
19/10/2002 11:54 [*news*] Stopping factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
19/10/2002 11:55 [*news*] Starting factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
[...]

  While these repeated as long as the server was running, they didn't
  seem to affect its operation.

- In news/news.py, buildProtocol() is trying to pass self.remoteHosts
  to the self.protocol() call, but self.protocol() -- which is really
  the nntp.NNTPServer class, doesn't take two arguments.

In any event, I hacked in moderated group support by adding a
-m/--moderators flag, which takes a file containing a list of
newsgroup/moderator address pairs.  When a message is POSTed to a
group, the list of target newsgroups is checked against the
moderators.  If there is any match, and the article has no Approved
header, the article is not posted, but instead emailed to the
moderators address.  The value of the Approved header is completely
ignored -- it just has to be there.  I believe this is pretty close to
how Usenet s/w handles moderators.

A couple of kludges that should be cleaned up:

- What to do if the list of target newsgroups has more than one
  moderated newsgroup in it?  Off hand, I'm not sure what Usenet does
  in this case.

- We really need a few more config options, including the smtp host
  and port to use to send out the moderator's email, and the envelope
  sender address to use in that email.  Both are hard coded in my
  hack.

- Any un-Twisted coding offenses. :)

So, in the grand tradition of scratching my own itch, but just enough
so I can sleep, here's the patch.

Oh, BTW, for someone who was completely green to the code base,
Twisted is very nicely written.  It wasn't difficult at all to drill
down to where I needed to make the changes.  JP's hints helped a lot
too.  Yay!

Enjoy,
-Barry

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: twisted.txt
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/97b86b2c/attachment.txt 

From glyph at twistedmatrix.com  Sat Oct 19 15:50:20 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 19 Oct 2002 14:50:20 -0500 (CDT)
Subject: [Twisted-Python] Archive of Mailing List?
In-Reply-To: <000c01c2778d$cf11cea0$2501a8c0@blackstar>
References: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
	<000c01c2778d$cf11cea0$2501a8c0@blackstar>
Message-ID: <20021019.145020.123673598.glyph@twistedmatrix.com>


On Sat, 19 Oct 2002 12:37:20 -0400, "Paul Baranowski" <paul at paulbaranowski.org> wrote:
> Is there a (searchable) archive of the mailing list on the mailman
> server somewhere?  If not, perhaps one should be started.  It is, after
> all, literally just a click of a button in mailman.

There is an archive (twistedmatrix.com/pipermail) but it's not searchable.  Is
that really an option in mailman someplace?  I don't see it.  Google might be
able to help you, though :-)


-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/2cb773fe/attachment.pgp 

From glyph at twistedmatrix.com  Sat Oct 19 15:52:34 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 19 Oct 2002 14:52:34 -0500 (CDT)
Subject: [Twisted-Python] QOTD Plugin Example
In-Reply-To: <000d01c2778e$8536fcf0$2501a8c0@blackstar>
References: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
	<000d01c2778e$8536fcf0$2501a8c0@blackstar>
Message-ID: <20021019.145234.132758596.glyph@twistedmatrix.com>

On Sat, 19 Oct 2002 12:42:25 -0400, "Paul Baranowski" <paul at paulbaranowski.org> wrote:
> What am I missing?

Sorry, the wording of that is somewhat confusing.  If you have a file like
this:

/foo/bar/Twisted/doc/howto/listings/TwistedQuotes/__init__.py

then your PYTHONPATH should be set to this:

/foo/bar/Twisted/doc/howto/listings/

Otherwise, TwistedQuotes is an _entry_ in the Python Path, not a _package_ on
it.  I have yet to find a good clear example of this on python.org or a better
(and still standard) wording to use.  Suggestions are appreciated.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/6cbc1084/attachment.pgp 

From paul at paulbaranowski.org  Sat Oct 19 16:50:04 2002
From: paul at paulbaranowski.org (Paul Baranowski)
Date: Sat, 19 Oct 2002 16:50:04 -0400
Subject: [Twisted-Python] QOTD Plugin Example
In-Reply-To: <20021019165458.28831.qmail@green.zadka.com>
Message-ID: <003601c277b1$1aba02f0$2501a8c0@blackstar>

Ah, I guess this is the line that confused me:

"The path of least resistance is probably just to make a directory
inside your Twisted-X.X.X directory, which will already be in your
sys.path."

This isn't true (at least in the windows install).

However, there is a simple fix if you do do this (as I did):  put the
register() call in the plugins.tml file in the site-packages/twisted
directory like so:

register("Quote of the Day TAP Builder",
         "twisted.TwistedQuotes.quotetap",
         description="""
         Example of a TAP builder module.
         """,
         type="tap",
         tapname="qotd")

instead of in the TwistedQuotes directory. 

Once I did this, everything worked. :)  Yay!


> -----Original Message-----
> From: twisted-python-admin at twistedmatrix.com [mailto:twisted-python-
> admin at twistedmatrix.com] On Behalf Of Moshe Zadka
> Sent: Saturday, October 19, 2002 12:55 PM
> To: twisted-python at twistedmatrix.com
> Subject: Re: [Twisted-Python] QOTD Plugin Example
> 
> Did you add the directory containing the TwistedQuotes directory
> to your PYTHONPATH?
> 





From justin at gnubian.org  Sat Oct 19 19:21:32 2002
From: justin at gnubian.org (Justin Ryan)
Date: 19 Oct 2002 18:21:32 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
Message-ID: <1035069693.944.10.camel@qutang>

Hello..

I've been fumbling with twisted.enterprise.row a bit and seem to have
hit a brick wall.. 

I've got a database with the following info:

accounts
contacts

each account can have an arbitrary number of contacts, and any contact
can be connected to an arbitrary number of accounts..

To solve this problem, I've got a 'rel' table which keeps relationships
between account ids and contact ids, so if I want all of the contacts
for account x I simply pull all of the rows out of the 'rel' table whose
accountId is x, and then individually step through them and extract the
contacts with the corresponding accountIds..

I don't think there is a problem with the way I'm doing this, or a
better way to do this (though I'd be tickled if someone could point me a
better way), but in any case there does not seem to be an (obvious) way
to handle this with RowObjects..

Or, to put it better... the row tutorial does not cover this sort of
stuff :)

Thanks in advance for any help!

-Justin


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/c8918040/attachment.pgp 

From ericmangold at myrealbox.com  Sat Oct 19 22:51:51 2002
From: ericmangold at myrealbox.com (Eric Mangold)
Date: Sat, 19 Oct 2002 19:51:51 -0700
Subject: [Twisted-Python] 1.0.0rc3 test errors
Message-ID: <3DB21A47.6020208@myrealbox.com>

Attached are the 'build' and 'install' logs. The output of 'runtests' is 
below, with my comments at the end. This is on openbsd-3.1.

server% admin/runtests
reactor class: twisted.internet.default.SelectReactor
No module named _tkinter
Falling back to text mode.
...........................................................................................................EE................................................................E.............................................E..........................................EE.........................................
======================================================================
ERROR: testFailedRETR (twisted.test.test_ftp.FTPClientTests)
----------------------------------------------------------------------
======================================================================
ERROR: testFailedRETR (twisted.test.test_ftp.FTPClientTests)
----------------------------------------------------------------------
======================================================================
ERROR: testServer (twisted.test.test_names.ServerDNSTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_names.py", line 53, in testServer
    p.startListening()
  File "./twisted/internet/udp.py", line 184, in startListening
    skt.bind( (self.interface ,self.port) )
error: (48, 'Address already in use')
======================================================================
ERROR: testNormalTermination 
(twisted.test.test_process.PosixProcessTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_process.py", line 206, in testNormalTermination
    p.reason.trap(error.ProcessDone)
  File "./twisted/python/failure.py", line 230, in trap
    raise self
Failure: [Failure instance: Traceback! 
twisted.internet.error.ProcessTerminated, process ended with exit code 1
]
======================================================================
ERROR: testUserFail (twisted.test.test_tcp.ConnectorTestCase)
----------------------------------------------------------------------
======================================================================
ERROR: testUserFail (twisted.test.test_tcp.ConnectorTestCase)
----------------------------------------------------------------------
----------------------------------------------------------------------
Ran 303 tests in 83.449s

FAILED (errors=6)

I don't know about the others, but the ServerDNSTestCase seems really 
odd. According to
 the test source it's trying to listen on udp/2053. That port isn't in use:

server% netstat -a | grep LISTEN
tcp        0      0  *.3128                 *.*                    LISTEN
tcp        0      0  *.netbios-             *.*                    LISTEN
tcp        0      0  *.rsync                *.*                    LISTEN
tcp        0      0  *.ssh                  *.*                    LISTEN
tcp        0      0  *.ftp-prox             *.*                    LISTEN
tcp        0      0  *.swat                 *.*                    LISTEN
tcp        0      0  *.ftp                  *.*                    LISTEN
tcp        0      0  *.www                  *.*                    LISTEN
tcp        0      0  *.auth                 *.*                    LISTEN
tcp6       0      0  *.ssh                  *.*                    LISTEN

Let me know if you all need more info!

-Eric (teratorn)

-------------- next part --------------
A non-text attachment was scrubbed...
Name: setup_build.log.gz
Type: application/x-gzip
Size: 2916 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/d94aeefa/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: setup_install.log.gz
Type: application/x-gzip
Size: 7251 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/d94aeefa/attachment-0001.bin 

From barry at python.org  Sat Oct 19 18:12:01 2002
From: barry at python.org (Barry A. Warsaw)
Date: Sat, 19 Oct 2002 18:12:01 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>
	<3DAF3453.4030306@twistedmatrix.com>
	<15791.13852.867292.398473@gargle.gargle.HOWL>
	<3DAF3952.4050707@twistedmatrix.com>
	<15793.34455.512573.39157@gargle.gargle.HOWL>
	<3DB1B25D.30409@twistedmatrix.com>
Message-ID: <15793.55473.655906.182803@gargle.gargle.HOWL>

>>>>> "JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:

    JC>   I wish I could say that is the case -- I've just been
    JC> motivated to work on other projects lately.

I can sympathize!
    
    JC> I agree that it has gotten more complex, and I don't like it.
    JC> I've recently been pointed at twisted.persisted.dirdbm, and my
    JC> current thinking is that PickleStorage and
    JC> NewsStorageAugmentation should go away in favor of a
    JC> DirDBMStorage.  PickleStorage was never meant as anything more
    JC> than a toy, and the SQL stuff doesn't seem to have yielded any
    JC> performance benefits, probably due to the complexity of some
    JC> of the common queries it is performing.

PickleStorage was fine for my purpose, which wasn't to create a fully
functional peering news server, but to have something
protocol-complete enough to test Mailman's gatewaying functionality.

    JC> The file given to --servers should contain a list of news
    JC> servers to which to connect and share messages with.  This
    JC> hasn't yet been tested thoroughly -- I have surprising
    JC> difficulty finding a news server that implemented enough of
    JC> the protocol to let this work.  I guess the "user facing"
    JC> servers are kept intentionally non-functional for some reason.

Ah, cool.  I guess --servers should simply be optional then (as should
--moderators, but I wasn't sure how to do that).  I think there are
use cases beyond testing Mailman <wink> for having a news server that
isn't a peer of other servers.  E.g. an internal mailing list mirror.

    JC> Yea, this is new too, since pickle was the only legal command
    JC> in the past.  If I go with the dirdbm stuff, I'll probably
    JC> make it the default and let pickle or sql be specified if
    JC> someone wants something different (Or pickle and sql might
    JC> quietly disappear - the prospect of maintaining 3 different
    JC> backends - 2 of which are likely useless to nearly everybody -
    JC> is a little unpleasant).

Pickles were fine for me, but I can understand others may not be happy
with them.  Sql wasn't an option because I don't have an sql server
set up, and that would have been too high a barrier for me.

>  While these repeated as long as the server was running, they didn't
>  seem to affect its operation.

    JC> I'm guessing these are due to whatever you put in your server
    JC> list file.

Makes sense!

>In any event, I hacked in moderated group support by adding a
>-m/--moderators flag, which takes a file containing a list of
>newsgroup/moderator address pairs.  When a message is POSTed to a
>group, the list of target newsgroups is checked against the
>moderators.  If there is any match, and the article has no Approved
>header, the article is not posted, but instead emailed to the
>moderators address.  The value of the Approved header is completely
>ignored -- it just has to be there.  I believe this is pretty close to
>how Usenet s/w handles moderators.

    JC> Hmm.  How does a moderator then approve the message?  The
    JC> interface I had envisioned was something closer to mailman's
    JC> scheme, though this is certainly easier on the server side :)

I believe that the news server never really enters into the picture
for moderation.  All it cares about is that posts to moderated groups
have an Approved header -- it doesn't even care what the value of that
header is!  If the Approved header exists, it accepts the post.  If
not, it forwards it to the email address of the moderators.  That's
it.

Mailman's moderation support (only in cvs at the moment) works with
this protocol so that unmoderated messages are held for approval via
the normal admindb interface.  If the list owner -- who doubles as the
newsgroup moderator -- approves the message, Mailman re-posts it
including an Approved header, to its local news server.  The news
server will accept the posting now and everything proceeds as normal.

So the news server's behavior is only half the picture (but a critical
half!).

>- What to do if the list of target newsgroups has more than one
>  moderated newsgroup in it?  Off hand, I'm not sure what Usenet does
>  in this case.
>
    JC> I believe the correct behavior would be to post the message to
    JC> all un-moderated groups and hold the message for approval from
    JC> the moderators of each moderated group, posting it to each
    JC> held group when the appropriate moderator approves it.

Except the news server can't do this, because of the above.  I /think/
what actually happens in practice (some Usenet expert will have to
verify this) is that the news server doesn't post the message to any
newsgroup, but forwards it off to the moderators of the first
moderated newsgroup in the list.  Once they approve it and repost,
that's all the approval necessary.
    
>- Any un-Twisted coding offenses. :)

    JC> The only one I see is the use of smtplib.  Its sendmail method
    JC> will very likely block, possibly for a long time, hanging the
    JC> entire server.

Ah, I'm so used to Mailman's behavior, I hadn't tought about this.
Mailman always connects to a trusted, local MTA to do the final
delivery.  Usually this is some server on localhost:25.  Mailman never
connects to the actual recipient's remote mta.  I'd be happy enough if
Twisted made the same assumption, but OTOH since Twisted /does/ come
with an SMTPd, it can probably do better.
    
    JC> Aside from just being nasty, this opens up the
    JC> possibility for DoS on servers, simply by repeatedly mailing a
    JC> moderated group.  I'm going out of town for a week this coming
    JC> tuesday, and I doubt I'll have time to figure out how
    JC> twisted.protocols.smtp.SMTPClient works before then, so I'm
    JC> going to hold off on committing this.  If you want to figure
    JC> that out and send another patch, that'd be great, otherwise
    JC> I'll just take care of it when I get back.

I probably wont' get to it.  Twisted + my hacks was enough to debug
Mailman's new moderation support, and I'll have to leave it at that
for now.  I've got my hands full trying to get Mailman 2.1b4 out the
door this weekend!

  Glad to hear it :)  Thanks for the patch.

No problem, thanks again for your help.
-Barry



From gustav at morpheus.demon.co.uk  Sat Oct 19 18:36:15 2002
From: gustav at morpheus.demon.co.uk (Paul Moore)
Date: Sat, 19 Oct 2002 23:36:15 +0100
Subject: [Twisted-Python] Completely new to twisted - where to get some background?
Message-ID: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk>

I'm totally new to twisted - I downloaded it because I'd heard that it
could support being an NNTP server. But I can't get my head round the
documentation. I'm not even sure where to begin - am I a user, an
administrator, or what?

Basically, what I want to do is to set up an NNTP server which serves
out the contents of a series of mbox files as newsgroups. I'm guessing
that I need to code up some sort of "backend" code, which will fit
into the twisted structure somewhere. But I can't find enough from the
documentation to know where to start.

Can someone point me at some sort of "gentle introduction" to this
sort of task? (Or alternatively, let me know if twisted is *not* the
appropriate application for this!)

Thanks in advance,
Paul Moore

-- 
This signature intentionally left blank



From ericmangold at myrealbox.com  Sat Oct 19 22:44:02 2002
From: ericmangold at myrealbox.com (Eric Mangold)
Date: Sat, 19 Oct 2002 19:44:02 -0700
Subject: [Twisted-Python] 1.0.0rc3 test errors
Message-ID: <3DB21872.7090903@myrealbox.com>

Attached are the 'build' and 'install' logs. The output of 'runtests' is 
below, with my comments at the end. This is on openbsd-3.1.

server% admin/runtests
reactor class: twisted.internet.default.SelectReactor
No module named _tkinter
Falling back to text mode.
...........................................................................................................EE................................................................E.............................................E..........................................EE.........................................
======================================================================
ERROR: testFailedRETR (twisted.test.test_ftp.FTPClientTests)
----------------------------------------------------------------------
======================================================================
ERROR: testFailedRETR (twisted.test.test_ftp.FTPClientTests)
----------------------------------------------------------------------
======================================================================
ERROR: testServer (twisted.test.test_names.ServerDNSTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_names.py", line 53, in testServer
    p.startListening()
  File "./twisted/internet/udp.py", line 184, in startListening
    skt.bind( (self.interface ,self.port) )
error: (48, 'Address already in use')
======================================================================
ERROR: testNormalTermination 
(twisted.test.test_process.PosixProcessTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_process.py", line 206, in testNormalTermination
    p.reason.trap(error.ProcessDone)
  File "./twisted/python/failure.py", line 230, in trap
    raise self
Failure: [Failure instance: Traceback! 
twisted.internet.error.ProcessTerminated, process ended with exit code 1
]
======================================================================
ERROR: testUserFail (twisted.test.test_tcp.ConnectorTestCase)
----------------------------------------------------------------------
======================================================================
ERROR: testUserFail (twisted.test.test_tcp.ConnectorTestCase)
----------------------------------------------------------------------
----------------------------------------------------------------------
Ran 303 tests in 83.449s

FAILED (errors=6)

I don't know about the others, but the ServerDNSTestCase seems really 
odd. According to
 the test source it's trying to listen on udp/2053. That port isn't in use:

server% netstat -a | grep LISTEN
tcp        0      0  *.3128                 *.*                    LISTEN
tcp        0      0  *.netbios-             *.*                    LISTEN
tcp        0      0  *.rsync                *.*                    LISTEN
tcp        0      0  *.ssh                  *.*                    LISTEN
tcp        0      0  *.ftp-prox             *.*                    LISTEN
tcp        0      0  *.swat                 *.*                    LISTEN
tcp        0      0  *.ftp                  *.*                    LISTEN
tcp        0      0  *.www                  *.*                    LISTEN
tcp        0      0  *.auth                 *.*                    LISTEN
tcp6       0      0  *.ssh                  *.*                    LISTEN

Let me know if you all need more info!

-Eric (teratorn)

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: setup_build.log
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/f8cfe318/attachment.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: setup_install.log
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20021019/f8cfe318/attachment-0001.txt 

From screwtape at froup.com  Sun Oct 20 03:43:06 2002
From: screwtape at froup.com (Tim Allen)
Date: Sun, 20 Oct 2002 17:43:06 +1000
Subject: [Twisted-Python] Twisted IM fixes
In-Reply-To: <20021019.144559.89042554.glyph@twistedmatrix.com>
Message-ID: <926AA5AC-E3FF-11D6-97F9-003065D61A3E@froup.com>

On Sunday, October 20, 2002, at 05:45 AM, Glyph Lefkowitz wrote:

> On Sat, 19 Oct 2002 23:09:11 +1000, Tim Allen <screwtape at froup.com> 
> wrote:
>> I was wondering - would there be any interest in me polishing up my
>> minimalist twisted.im client so it could be added to twisted.im or
>> doc/examples or such?
>
> Is this a minimalist bot-style client or a minimalist text-mode client?

So far, minimalist as in 'just echos what people say to the screen'.

An actual text-mode client would be great, I'm just waiting for someone 
to write a reactor that integrates nicely with the event loop you get 
with 'import cmd'. :)

>   In any
> case, yes!  Either would be highly useful :) (and thanks for sending 
> the patch
> as an attachment ^_^)

No problem. :)

Screwtape,
...mmm, command-line.




From screwtape at froup.com  Sun Oct 20 07:37:47 2002
From: screwtape at froup.com (Tim Allen)
Date: Sun, 20 Oct 2002 21:37:47 +1000
Subject: [Twisted-Python] Minimalist twisted.im interface
Message-ID: <5B8B33CA-E420-11D6-97F9-003065D61A3E@froup.com>

OK, here's my first draft at a minimalist twisted.im interface. It 
doesn't let you manage accounts or even actually speak, but it should be 
enough to give anyone else who wants to write a twisted.im interface a 
decent idea about what they're required to do.

As I said, there's no account management - how do you add accounts? 
Well, I'm kind of ashamed of the implementation, but basically there's a 
file called twisted.im.accounts that contains a list of account objects. 
I'm open to suggestions for improvements, especially improvements that 
involve (a) simple code, and (b) a system I can configure with vi.

There's no (useful) changes to existing code, so I'm not including a 
diff. Rather, I'm just attaching the new files. There's three, and they 
all go in twisted.im:

o accounts.py: This is your basic turing-complete configuration file, 
including comments.
o minchat.py: Modelled after basechat.py and gtkchat.py, this is the 
actual useful code.
o minaccount.py: Modelled after baseaccount.py and gtkaccount.py, this 
loads up the accounts and tells them to log in.

If you want to try running it, you should probably point python at 
minchat.py (which uses minaccount, at the bottom).

Also, I've not yet fully acclimatised to the Twisted paradigm - tell me 
if I'm doing something stupid or non-twisted-like.

Oh, before I forget - if I want to turn this into a nice bot framework 
suitable for being checked into CVS, where should I put it? 
twisted.im.bot?

Screwtape,
...in case some crazy person wants to check this in verbatim, I hereby 
assign copyright to Glyph...

-------------- next part --------------
A non-text attachment was scrubbed...
Name: accounts.py
Type: application/octet-stream
Size: 1427 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/c3b1f667/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: minaccount.py
Type: application/octet-stream
Size: 1766 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/c3b1f667/attachment-0001.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: minchat.py
Type: application/octet-stream
Size: 3518 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/c3b1f667/attachment-0002.obj 

From twisted at moshez.org  Sun Oct 20 09:03:30 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 20 Oct 2002 13:03:30 -0000
Subject: [Twisted-Python] Twisted Documentation -- The Book
Message-ID: <20021020130330.7942.qmail@green.zadka.com>

Having worked a bit with the index.html's structure, I was intrigued to
see how an honest-to-god book from the same materials would look like.

If you are also intrigued, see
http://twistedmatrix.com/users/moshez/book.dvi.gz

Summary of the process:
1. Write latex.py (about half an hour, including debugging)
2. Use it to generate "section latexs" of all HTML files in question.
3. Manually process book.html to book.tex, \include'ing all relevant sections
4. Run latex

In case anyone is really interested, we can pretty easily do a postscript
book every release, or whenever else we're interesting. The XHTML parser
is a SUX-based one, extremely crude and yet quite easy to expand to more
HTML stuff.

Missing stuff from LaTeX processor:

1. IMG support (anyone remembers how to stuff .png's into a LaTeX file? Maybe
   I should process them to .eps files first? Bah)
2. Table support (shouldn't be hard, but promises to be annoying)



From exarkun at meson.dyndns.org  Sun Oct 20 14:24:18 2002
From: exarkun at meson.dyndns.org (Jp Calderone)
Date: Sun, 20 Oct 2002 14:24:18 -0400
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021013.162312.111208639.glyph@twistedmatrix.com>
References: <20021012033610.28948.qmail@green.zadka.com> <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com> <20021013.162312.111208639.glyph@twistedmatrix.com>
Message-ID: <20021020182418.GA6647@meson.dyndns.org>

On Sun, Oct 13, 2002 at 04:23:12PM -0500, Glyph Lefkowitz wrote:
> 
> The real problem is that these tools don't have a GUI and that doesn't mesh
> very well with the Windows way of being.  A simple GUI for running/making
> TA[SPX] files with Tkinter has been on the "that would be nice" TODO list for
> some time, but so few Twisted developers use Windows on a regular basis that it
> never seems to get done...

  This sounds like fun.  I assume the desired approach would auto-generate
something from the appropriate Options class?  I might look into this when
I get back (from Minnesota (next tuesday)).

    Jp

-- 
"Pascal is Pascal is Pascal is dog meat."
                -- M. Devine and P. Larson, Computer Science 340
--
 2:00pm up 152 days, 14:58, 3 users, load average: 0.16, 0.25, 0.22
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 237 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/6b3d1faa/attachment.pgp 

From kkennedy at abelard.kenzoid.com  Sun Oct 20 14:50:58 2002
From: kkennedy at abelard.kenzoid.com (Ken Kennedy)
Date: Sun, 20 Oct 2002 14:50:58 -0400
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <1035069693.944.10.camel@qutang>
References: <1035069693.944.10.camel@qutang>
Message-ID: <20021020185058.GA783@orcrist>

On Sat, Oct 19, 2002 at 06:21:32PM -0500, Justin Ryan wrote:
> Hello..
> 
> To solve this problem, I've got a 'rel' table which keeps relationships
> between account ids and contact ids, so if I want all of the contacts
> for account x I simply pull all of the rows out of the 'rel' table whose
> accountId is x, and then individually step through them and extract the
> contacts with the corresponding accountIds..
> 
> I don't think there is a problem with the way I'm doing this, or a
> better way to do this (though I'd be tickled if someone could point me a
> better way), but in any case there does not seem to be an (obvious) way
> to handle this with RowObjects..

It's a little unclear, but the "pull all of the rows out..and then
individually step through them" seems to suggest you're making two
queries to the db. If that's the case,then yeah, there's a better
way. If you know the accountID (from some previous query), just join
rel to contacts:

"select contact_info from contacts inner join rel on (rel.contactid =
contacts.contactid) where rel.accountid = whatever" 

If you only know account name info, use:

"select contact_info from 
       accounts inner join rel on (rel.accountid = accounts.accountid)
       inner join
       contacts on (contacts.contactid=rel.contactid)
       where account.accountname = 'whatever'
"

Either way, you should be getting back what you need in one
query. Does that make sense?

Ken






From tv at twistedmatrix.com  Sun Oct 20 14:59:52 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Sun, 20 Oct 2002 21:59:52 +0300
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <3DAF1916.50001@cubik.org>
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net> <20021017153553.275ae8ed.twisted@itamarst.org> <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org>
Message-ID: <20021020185952.GB23670@ki.yok.utu.fi>

On Thu, Oct 17, 2002 at 02:09:58PM -0600, Bruce Mitchener wrote:
> Not really.  For decent sized log files (well over a meg), it can take a 
> noticeable time and with Twisted, that's too much time.  It shouldn't be 
> an issue or that hard to do the compression in a thread anyway.

	EW! A compression of a file has _nothing_ shared with the
	main execution context. A thread is just _so_ much the
	wrong tool.

-- 
:(){ :|:&};:



From tv at twistedmatrix.com  Sun Oct 20 14:58:19 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Sun, 20 Oct 2002 21:58:19 +0300
Subject: [Twisted-Python] Limits of human perception
In-Reply-To: <LKENLBBMDHMKBECHIAIAAENGCMAA.andy@reportlab.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <LKENLBBMDHMKBECHIAIAAENGCMAA.andy@reportlab.com>
Message-ID: <20021020185819.GA23670@ki.yok.utu.fi>

On Thu, Oct 17, 2002 at 09:39:33PM +0100, Andy Robinson wrote:
> What's a good guideline duration for a CPU-heavy job before one 
> should consider threading?  0.01 sec? 0.1 sec? 1 sec?

	It's an old wisdom that a human perceives pauses
	of over 1/100 second in length.

	Though in a networked server you have multiple users,
	and even smaller pauses matter a lot if they come
	often (I'd say more than once an hour). Pauses of 1s
	in a network server are intolerable.

-- 
:(){ :|:&};:



From justin at gnubian.org  Sun Oct 20 15:44:33 2002
From: justin at gnubian.org (Justin Ryan)
Date: 20 Oct 2002 14:44:33 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <20021020185058.GA783@orcrist>
References: <1035069693.944.10.camel@qutang>  <20021020185058.GA783@orcrist>
Message-ID: <1035143074.872.5.camel@qutang>

On Sun, 2002-10-20 at 13:50, Ken Kennedy wrote:
> On Sat, Oct 19, 2002 at 06:21:32PM -0500, Justin Ryan wrote:
> > Hello..
> > 
> > To solve this problem, I've got a 'rel' table which keeps relationships
> > between account ids and contact ids, so if I want all of the contacts
> > for account x I simply pull all of the rows out of the 'rel' table whose
> > accountId is x, and then individually step through them and extract the
> > contacts with the corresponding accountIds..
> > 
> > I don't think there is a problem with the way I'm doing this, or a
> > better way to do this (though I'd be tickled if someone could point me a
> > better way), but in any case there does not seem to be an (obvious) way
> > to handle this with RowObjects..
> 
> It's a little unclear, but the "pull all of the rows out..and then
> individually step through them" seems to suggest you're making two
> queries to the db. If that's the case,then yeah, there's a better
> way. If you know the accountID (from some previous query), just join
> rel to contacts:
> 
> "select contact_info from contacts inner join rel on (rel.contactid =
> contacts.contactid) where rel.accountid = whatever" 
> 
> If you only know account name info, use:
> 
> "select contact_info from 
>        accounts inner join rel on (rel.accountid = accounts.accountid)
>        inner join
>        contacts on (contacts.contactid=rel.contactid)
>        where account.accountname = 'whatever'
> "
> 
> Either way, you should be getting back what you need in one
> query. Does that make sense?
> 

Certainly.., and it's not that far off from what I was doing.. except it
does seem a bit off in that no info is actually being pulled from the
account table - and if it were, it would be pulled multiple times (if i
want to pull the account name and account id, and then a list of
contacts).

the big important question here is ('scuse my german)... *drumroll*

how the fuck do I do this with twisted.enterprise.row? ;)

Unfortunately, the documentation for row seems pretty sketchy and shows
a direct parent-child relationship (room->furniture)..

it seems very unimportant what the underlying SQL does if row is
supposed to abstract it anyway..

any idears?

Thanks again!

-Justin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/6d081a4a/attachment.pgp 

From glyph at twistedmatrix.com  Sun Oct 20 15:51:26 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 20 Oct 2002 14:51:26 -0500 (CDT)
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021020182418.GA6647@meson.dyndns.org>
References: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
	<20021013.162312.111208639.glyph@twistedmatrix.com>
	<20021020182418.GA6647@meson.dyndns.org>
Message-ID: <20021020.145126.75426536.glyph@twistedmatrix.com>

On Sun, 20 Oct 2002 14:24:18 -0400, Jp Calderone <exarkun at meson.dyndns.org> wrote:
>   This sounds like fun.  I assume the desired approach would auto-generate
> something from the appropriate Options class?  I might look into this when
> I get back (from Minnesota (next tuesday)).

Yep, that's how I'd do it.  Something relatively lame-looking like wGetGUI
would be fine:

    http://www.jensroesner.de/wgetgui/



-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/4b27e633/attachment.pgp 

From glyph at twistedmatrix.com  Sun Oct 20 15:53:54 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 20 Oct 2002 14:53:54 -0500 (CDT)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021020185952.GB23670@ki.yok.utu.fi>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com>
	<3DAF1916.50001@cubik.org>
	<20021020185952.GB23670@ki.yok.utu.fi>
Message-ID: <20021020.145354.88473634.glyph@twistedmatrix.com>

On Sun, 20 Oct 2002 21:59:52 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
> 	EW! A compression of a file has _nothing_ shared with the
> 	main execution context. A thread is just _so_ much the
> 	wrong tool.

As with many potentially icky things in Twisted, this is for portability... I'd
rather have it done once in a thread than done twice: once in a thread (for
Windows/Java) and once in a Process (for UNIX).

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/daff7d1f/attachment.pgp 

From twisted at moshez.org  Sun Oct 20 16:12:07 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 20 Oct 2002 20:12:07 -0000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021020.145354.88473634.glyph@twistedmatrix.com>
References: <20021020.145354.88473634.glyph@twistedmatrix.com>, <20021017195851.GA29573@pyramid.twistedmatrix.com>
	<3DAF1916.50001@cubik.org>
	<20021020185952.GB23670@ki.yok.utu.fi>
Message-ID: <20021020201207.12429.qmail@green.zadka.com>

On Sun, 20 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> rather have it done once in a thread than done twice: once in a thread (for
> Windows/Java) and once in a Process (for UNIX).

I disagree. doing it in a process with gzip would work much better and
much saner on UNIX. I'd rather it be done twice, even if I have to do
the UNIX version myself.



From kkennedy at abelard.kenzoid.com  Sun Oct 20 16:27:52 2002
From: kkennedy at abelard.kenzoid.com (Ken Kennedy)
Date: Sun, 20 Oct 2002 16:27:52 -0400
Subject: [Twisted-Python] Connection Pools for websites...
Message-ID: <20021020202752.GB783@orcrist>

Hello all:

OK...it's time for me to start tossing out my stupid questions. *grin*

Even been lurking on the list, trying to grok Twistedness, and waiting
for things to get close to 1.0. I'm really looking forward to it.

My initial goal is to use Twisted for web serving, in the classic
"db-backed website" style. My main question is regarding database
connections. I've read the twisted.enterprise docs (though not all the
code comments yet), but I haven't seen what I'm looking for. If it's
obvious, I apologize...*grin*.

I understand the adbapi.ConnectionPool...but what I want is a way to
share that across multiple (for example) rpy files. Let's say I have a
VERY simple woven-based website. (Example follows:)

I'm using a plain twisted web server

mktap web --path ~/public_html
twistd -f web.tap

with my rpy files in the public_html directory. If I have two files

showStories.rpy

and

submitStories.rpy

I want both files to be able to connect to my db via a connection
pool...but a SHARED one.

So my "dbconn = StoryDatabase(dbpool)" would be using a common dbpool. 

Does this make sense...and if so, how can I do it?

Is this something I can/should be able to set with mktap, or configure
via coil? Or should I connect to another, long-running process via PB
to get database info?

I'm going to carefully review the enterprise code now, so maybe I can
answer my own question. Many thanks...

Ken
 



From jon at totient.demon.co.uk  Sun Oct 20 16:21:04 2002
From: jon at totient.demon.co.uk (Jon Dyte)
Date: Sun, 20 Oct 2002 21:21:04 +0100 (BST)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: twisted@moshez.org
References: <20021020.145354.88473634.glyph@twistedmatrix.com>
	<20021017195851.GA29573@pyramid.twistedmatrix.com>
	<3DAF1916.50001@cubik.org>
	<20021020185952.GB23670@ki.yok.utu.fi>
	<20021020201207.12429.qmail@green.zadka.com>
Message-ID: <15795.4144.491981.811198@erdos.totient.com>

Moshe Zadka wrote :-
> On Sun, 20 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> 
> > rather have it done once in a thread than done twice: once in a thread (for
> > Windows/Java) and once in a Process (for UNIX).
> 
> I disagree. doing it in a process with gzip would work much better and
> much saner on UNIX. I'd rather it be done twice, even if I have to do
> the UNIX version myself.
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

<unlurk-mode>
FWIW it's worth I agree as well.
</unlurk-mode>

Jon



From jjn at kriln.com  Sun Oct 20 17:13:38 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Sun, 20 Oct 2002 21:13:38 +0000 (GMT)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <15795.4144.491981.811198@erdos.totient.com>
Message-ID: <20021020211327.U33911-100000@nosferatu.kriln.com>

On Sun, 20 Oct 2002, Jon Dyte wrote:

> Moshe Zadka wrote :-
> > On Sun, 20 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> >
> > > rather have it done once in a thread than done twice: once in a thread (for
> > > Windows/Java) and once in a Process (for UNIX).
> >
> > I disagree. doing it in a process with gzip would work much better and
> > much saner on UNIX. I'd rather it be done twice, even if I have to do
> > the UNIX version myself.
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
> <unlurk-mode>
> FWIW it's worth I agree as well.
> </unlurk-mode>
>

As do I




From sean at twistedmatrix.com  Sun Oct 20 17:32:23 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Sun, 20 Oct 2002 16:32:23 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <1035143074.872.5.camel@qutang>
Message-ID: <HOEEKPCOKELHCNIJNMAGEEHDCHAA.sean@twistedmatrix.com>

well, i can think of two ways - but neither are particularly good.

You could create RowObject classes for each of the three tables - account,
contact, and rel  - and define foreign keys with the "rowForeignKey"
attributes between the tables.

Then use loadObjectsFrom to load objects from the rel table, and have those
"relRow" objects auto-load their children - which would be the rows from the
contacts table... This is not terribly efficient as it doesn't take
advantage of sql joins or set operations at all, but it should work.

For the second way, create a view on the rel and contacts tables:

create view account_contacts as
select rel.account_id, contact.contact_id, contact.name
from contact, rel
where rel.contact_id = contact.contact_id;

and create a rowObjectClass for the view. This would allow the rows to be
loaded, but updates and inserts could be a problem. Some databases cant do
updates or inserts to views... Others require rules or triggers to do it.


Dealing with many-to-many relationships like this is really outside of the
immediate scope of the current row code. Its a pretty common problem though,
so it is a logical place for the next extensions.  I'm not yet sure how to
make a good interface for this. I am reluctant to introduce more rowClass
attributes without some better validation or generation scheme - it is
already tedious and error-prone enough to type in all the columns, types and
relationships.

An SQL parser may be one way. If there was some way to generate
rowObjectClasses for queries dynamically, with functionality similar to the
way cursors work, that would be a generally useful solution....

Any thoughts on extending the Row API are welcome :)


-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Justin Ryan
Sent: Sunday, October 20, 2002 2:45 PM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] enterprise.row and two-way relationships


On Sun, 2002-10-20 at 13:50, Ken Kennedy wrote:
> On Sat, Oct 19, 2002 at 06:21:32PM -0500, Justin Ryan wrote:
> > Hello..
> >
> > To solve this problem, I've got a 'rel' table which keeps relationships
> > between account ids and contact ids, so if I want all of the contacts
> > for account x I simply pull all of the rows out of the 'rel' table whose
> > accountId is x, and then individually step through them and extract the
> > contacts with the corresponding accountIds..
> >
> > I don't think there is a problem with the way I'm doing this, or a
> > better way to do this (though I'd be tickled if someone could point me a
> > better way), but in any case there does not seem to be an (obvious) way
> > to handle this with RowObjects..
>
> It's a little unclear, but the "pull all of the rows out..and then
> individually step through them" seems to suggest you're making two
> queries to the db. If that's the case,then yeah, there's a better
> way. If you know the accountID (from some previous query), just join
> rel to contacts:
>
> "select contact_info from contacts inner join rel on (rel.contactid =
> contacts.contactid) where rel.accountid = whatever"
>
> If you only know account name info, use:
>
> "select contact_info from
>        accounts inner join rel on (rel.accountid = accounts.accountid)
>        inner join
>        contacts on (contacts.contactid=rel.contactid)
>        where account.accountname = 'whatever'
> "
>
> Either way, you should be getting back what you need in one
> query. Does that make sense?
>

Certainly.., and it's not that far off from what I was doing.. except it
does seem a bit off in that no info is actually being pulled from the
account table - and if it were, it would be pulled multiple times (if i
want to pull the account name and account id, and then a list of
contacts).

the big important question here is ('scuse my german)... *drumroll*

how the fuck do I do this with twisted.enterprise.row? ;)

Unfortunately, the documentation for row seems pretty sketchy and shows
a direct parent-child relationship (room->furniture)..

it seems very unimportant what the underlying SQL does if row is
supposed to abstract it anyway..

any idears?

Thanks again!

-Justin




From justin at gnubian.org  Sun Oct 20 17:31:51 2002
From: justin at gnubian.org (Justin Ryan)
Date: 20 Oct 2002 16:31:51 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <HOEEKPCOKELHCNIJNMAGEEHDCHAA.sean@twistedmatrix.com>
References: <HOEEKPCOKELHCNIJNMAGEEHDCHAA.sean@twistedmatrix.com>
Message-ID: <1035149512.872.16.camel@qutang>

On Sun, 2002-10-20 at 16:32, Sean Riley wrote:
> well, i can think of two ways - but neither are particularly good.

I was afraid of this :)

> You could create RowObject classes for each of the three tables - account,
> contact, and rel  - and define foreign keys with the "rowForeignKey"
> attributes between the tables.
> 
> Then use loadObjectsFrom to load objects from the rel table, and have those
> "relRow" objects auto-load their children - which would be the rows from the
> contacts table... This is not terribly efficient as it doesn't take
> advantage of sql joins or set operations at all, but it should work.

this had occurred to me but I hoped there would be a better way..
 
> For the second way, create a view on the rel and contacts tables:
> 
> create view account_contacts as
> select rel.account_id, contact.contact_id, contact.name
> from contact, rel
> where rel.contact_id = contact.contact_id;
> 
> and create a rowObjectClass for the view. This would allow the rows to be
> loaded, but updates and inserts could be a problem. Some databases cant do
> updates or inserts to views... Others require rules or triggers to do it.
> 

hrm.. do you know if postgres can?  I spose i could find out fairly
easily :)

seems this would still require two queries in order to grab the account
name as well as the contact info, but is still more efficient than
making account and contact children of rel..

> Dealing with many-to-many relationships like this is really outside of the
> immediate scope of the current row code. Its a pretty common problem though,
> so it is a logical place for the next extensions.  I'm not yet sure how to
> make a good interface for this. I am reluctant to introduce more rowClass
> attributes without some better validation or generation scheme - it is
> already tedious and error-prone enough to type in all the columns, types and
> relationships.
> 
> An SQL parser may be one way. If there was some way to generate
> rowObjectClasses for queries dynamically, with functionality similar to the
> way cursors work, that would be a generally useful solution....
> 
> Any thoughts on extending the Row API are welcome :)

I may just poke around in the code and see what idears I can come up
with :)

Thanks!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/b375b01d/attachment.pgp 

From kkennedy at abelard.kenzoid.com  Sun Oct 20 17:56:40 2002
From: kkennedy at abelard.kenzoid.com (Ken Kennedy)
Date: Sun, 20 Oct 2002 17:56:40 -0400
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <1035143074.872.5.camel@qutang>
References: <1035069693.944.10.camel@qutang> <20021020185058.GA783@orcrist> <1035143074.872.5.camel@qutang>
Message-ID: <20021020215640.GC783@orcrist>

On Sun, Oct 20, 2002 at 02:44:33PM -0500, Justin Ryan wrote:

> > Either way, you should be getting back what you need in one
> > query. Does that make sense?
> > 
> 
> Certainly.., and it's not that far off from what I was doing.. except it
> does seem a bit off in that no info is actually being pulled from the
> account table - and if it were, it would be pulled multiple times (if i
> want to pull the account name and account id, and then a list of
> contacts).
> 
> the big important question here is ('scuse my german)... *drumroll*
> 
> how the fuck do I do this with twisted.enterprise.row? ;)

Ah! Ok...now I'll show my lack of attention. I didn't pay attention to
the twisted.enterprise.ROW reference!

Well...the row stuff looks pretty wonky to me *grin*, but since I want
to understand it as well, we can figure it out together. 

Is the following a good minimalist schema for the objects?

account (
accountid integer,
name varchar(100),
)

contact (
contactid integer,
fname varchar(100),
lname varchar(100),
email varchar(100)
)

rel (
accountid integer,
contactid integer
)

If you've got better field names, just let me know. I just want to be
able to talk apples to apples...

Ken



From justin at gnubian.org  Sun Oct 20 18:49:37 2002
From: justin at gnubian.org (Justin Ryan)
Date: 20 Oct 2002 17:49:37 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <20021020215640.GC783@orcrist>
References: <1035069693.944.10.camel@qutang> <20021020185058.GA783@orcrist>
	<1035143074.872.5.camel@qutang>  <20021020215640.GC783@orcrist>
Message-ID: <1035154178.872.49.camel@qutang>

> Ah! Ok...now I'll show my lack of attention. I didn't pay attention to
> the twisted.enterprise.ROW reference!
> 
> Well...the row stuff looks pretty wonky to me *grin*, but since I want
> to understand it as well, we can figure it out together. 

admittedly, it does.. I'm embarrassed to admit that I'm currently using
a pretty lame db access method..

The Python Cookbook outlines a LazyDB class (aptly named at that) which
implemens Connection, Record and RecordSet objects (though I honestly
don't see why it couldn't be done with a list of Records).. 

As it is implemented, it doesn't seem feasible to subclass the Record
object, which means I can't implement objects for each of my tables..

> Is the following a good minimalist schema for the objects?
> 
> account (
> accountid integer,
> name varchar(100),
> )
> 
> contact (
> contactid integer,
> fname varchar(100),
> lname varchar(100),
> email varchar(100)
> )
> 
> rel (
> accountid integer,
> contactid integer
> )
> 
> If you've got better field names, just let me know. I just want to be
> able to talk apples to apples...

I've got a few more fields in the contact table, but we can work with id
and name..

If you check the other reply to my post, I tried the create view method
and it seems like it will work, but still makes for messy integration
with row, since i'll have to define three rows - one for accounts, one
for contacts, and one for the integrated view (although honestly, the
account table will rarely be accessed without the full view).

Thanks!

-Justin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/cd32b6ff/attachment.pgp 

From exarkun at meson.dyndns.org  Sun Oct 20 19:34:35 2002
From: exarkun at meson.dyndns.org (Jp Calderone)
Date: Sun, 20 Oct 2002 19:34:35 -0400
Subject: [Twisted-Python] Completely new to twisted - where to get some background?
In-Reply-To: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk>
Message-ID: <20021020233435.GA15094@meson.dyndns.org>

On Sat, Oct 19, 2002 at 11:36:15PM +0100, Paul Moore wrote:
> I'm totally new to twisted - I downloaded it because I'd heard that it
> could support being an NNTP server. But I can't get my head round the
> documentation. I'm not even sure where to begin - am I a user, an
> administrator, or what?
> 
> Basically, what I want to do is to set up an NNTP server which serves
> out the contents of a series of mbox files as newsgroups. I'm guessing
> that I need to code up some sort of "backend" code, which will fit
> into the twisted structure somewhere. But I can't find enough from the
> documentation to know where to start.

  From this, I'd say that you're probably going to be a developer, an
administrator, and a user. ;)

  The current NNTP code lets you use one of two different backends - a
pickle file or an RDBM (postgres is what was used to develop it).  To serve
news out of mbox files, you'll need to write another backend that implements
the NewsStorage interface (twisted.news.database.NewsStorage), then hand
this to either an NNTPServerFactory or a UsenetServerFactory (probably the
former).  It would be nice if 'mktap news' could handle this, but it can't
(yet), so you'll have to write a little more python to glue it all together. 
twisted.tap.news.updateApplication() is definitely something you'll want to
look at.  The Application Howto and the Server Howto are probably worth
going over:

  http://twistedmatrix.com/documents/howto/application
  http://twistedmatrix.com/documents/howto/servers

  You shouldn't need to write a Factory or a Protocol to do what you want,
but knowing how the pieces fit together will probably be beneficial.

  Depending if you try to make "queries" to the mbox synchronous or not, the
Deferred howto might be relevant as well:

  http://twistedmatrix.com/documents/howto/defer

  Twisted usually considers disk operations (and certainly memory
operations) fast enough to not worry about this, though, so doing what the
PickleStorage class does (defer.fail(), defer.succeed()) will probably work
for you.
> 
> Can someone point me at some sort of "gentle introduction" to this
> sort of task? (Or alternatively, let me know if twisted is *not* the
> appropriate application for this!)

  Twisted is definitely suited for this :)  I'm not aware of a document that
is directly relevant to what you want to do, because it's not too deeply
related to Twisted.  Hopefully what needs to be done will be clear after you
check out the code I mentioned above.  

  Jp

-- 
"One World, one Web, one Program." - Microsoft(R) promotional ad
"Ein Volk, ein Reich, ein Fuhrer." - Adolf Hitler
--
 7:00pm up 152 days, 19:58, 2 users, load average: 0.14, 0.09, 0.07
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/75b4afa5/attachment.pgp 

From abo at minkirri.apana.org.au  Sun Oct 20 20:13:05 2002
From: abo at minkirri.apana.org.au (Donovan Baarda)
Date: Mon, 21 Oct 2002 10:13:05 +1000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021020.145354.88473634.glyph@twistedmatrix.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com>
Message-ID: <20021021001305.GC13974@minkirri.apana.org.au>

On Sun, Oct 20, 2002 at 02:53:54PM -0500, Glyph Lefkowitz wrote:
> On Sun, 20 Oct 2002 21:59:52 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
> > 	EW! A compression of a file has _nothing_ shared with the
> > 	main execution context. A thread is just _so_ much the
> > 	wrong tool.
> 
> As with many potentially icky things in Twisted, this is for portability... I'd
> rather have it done once in a thread than done twice: once in a thread (for
> Windows/Java) and once in a Process (for UNIX).

Compression of a whole file might take too long for twisted to do in it's
event loop, but an incremental compression using the python zlib module
wouldn't... just compress a block at a time and use the twisted event loop.
This saves spawning a thread or process.


-- 
----------------------------------------------------------------------
ABO: finger abo at minkirri.apana.org.au for more info, including pgp key
----------------------------------------------------------------------



From jml at mumak.net  Sun Oct 20 21:14:00 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Mon, 21 Oct 2002 12:14:00 +1100
Subject: [Twisted-Python] Twisted 1.0.0rc3 on WinNT / Cygwin
Message-ID: <20021021011400.GA9377@mumak.net>


Hi,

I just tried to install Twisted 1.0.0rc3 on my box at work, using
Windows NT 4.0 and Cygwin. I wasn't very successful at all.

Some version info:
$ gcc -v
Reading specs from /usr/lib/gcc-lib/i686-pc-cygwin/2.95.3-5/specs
gcc version 2.95.3-5 (cygwin special)

$ python   
Python 2.1.1 (#2, Sep 26 2001, 09:32:53) 

The initial python setup.py install failed during build_ext, with the
following error message:

gcc -g -O2 -Wall -Wstrict-prototypes -DUSE_DL_IMPORT
-I/usr/include/python2.1 -c twisted/internet/cReactor/cReactor.c -o
build/temp.cygwin-1.3.3-i686-2.1/cReactor.o
twisted/internet/cReactor/cReactor.c: In function
`iterate_internal_finalize':
twisted/internet/cReactor/cReactor.c:696: warning: implicit declaration
of function `PyEval_ReleaseLock'
twisted/internet/cReactor/cReactor.c:715: warning: implicit declaration
of function `PyEval_AcquireLock'
twisted/internet/cReactor/cReactor.c: At top level:
twisted/internet/cReactor/cReactor.c:1238: initializer element is not
constant
twisted/internet/cReactor/cReactor.c:1238: (near initialization for
`cReactorType.ob_type')
error: command 'gcc' failed with exit status 1

cheers,
jml
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021021/2b47cd19/attachment.pgp 

From kkennedy at abelard.kenzoid.com  Sun Oct 20 21:08:17 2002
From: kkennedy at abelard.kenzoid.com (Ken Kennedy)
Date: Sun, 20 Oct 2002 21:08:17 -0400
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <1035154178.872.49.camel@qutang>
References: <1035069693.944.10.camel@qutang> <20021020185058.GA783@orcrist> <1035143074.872.5.camel@qutang> <20021020215640.GC783@orcrist> <1035154178.872.49.camel@qutang>
Message-ID: <20021021010817.GA437@orcrist>

On Sun, Oct 20, 2002 at 05:49:37PM -0500, Justin Ryan wrote:
> > Ah! Ok...now I'll show my lack of attention. I didn't pay attention to
> > the twisted.enterprise.ROW reference!
> > 
> > Well...the row stuff looks pretty wonky to me *grin*, but since I want
> > to understand it as well, we can figure it out together. 
> 
> admittedly, it does.. I'm embarrassed to admit that I'm currently using
> a pretty lame db access method..

As of now, I'm leaning towards using twisted.enterprise without
t.e.row...except purely for learning purposes. Just this simple
example of yours shows how quickly object <-> relational model
mappings can get tricky. But learning about it should be interesting
nevertheless. 

> > able to talk apples to apples...
> 
> I've got a few more fields in the contact table, but we can work with id
> and name..
> 
> If you check the other reply to my post, I tried the create view method
> and it seems like it will work,

Yeah...I read it. That was my thought as well...use a view to flatten
out two of the objects into one. I'm trying to think of tweaking that
might help simplify the situation there. Some databases have
functionality that might enable you to use one denormalized view and
rewrites on the db backend that would peform the updates properly
depending on the table. But that functionality would be in the
database, so it would be implementation-specific. 

 



From radix at twistedmatrix.com  Sun Oct 20 21:11:47 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 21 Oct 2002 03:11:47 +0200
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021001305.GC13974@minkirri.apana.org.au>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com> <20021021001305.GC13974@minkirri.apana.org.au>
Message-ID: <20021021011147.GB909@twistedmatrix.com>

On Mon, Oct 21, 2002 at 10:13:05AM +1000, Donovan Baarda wrote:
> On Sun, Oct 20, 2002 at 02:53:54PM -0500, Glyph Lefkowitz wrote:
> > On Sun, 20 Oct 2002 21:59:52 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
> > > 	EW! A compression of a file has _nothing_ shared with the
> > > 	main execution context. A thread is just _so_ much the
> > > 	wrong tool.
> > 
> > As with many potentially icky things in Twisted, this is for portability... I'd
> > rather have it done once in a thread than done twice: once in a thread (for
> > Windows/Java) and once in a Process (for UNIX).
> 
> Compression of a whole file might take too long for twisted to do in it's
> event loop, but an incremental compression using the python zlib module
> wouldn't... just compress a block at a time and use the twisted event loop.
> This saves spawning a thread or process.

Hey, I forgot zlib could do that. That's really cool (And I'd
recommend doing it that way, barring any issues with it (and "it's not
UNIXy" isn't an issue, afaic ;))).



From twisted at itamarst.org  Sun Oct 20 21:17:38 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 20 Oct 2002 21:17:38 -0400
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021011147.GB909@twistedmatrix.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com>
	<3DAF1916.50001@cubik.org>
	<20021020185952.GB23670@ki.yok.utu.fi>
	<20021020.145354.88473634.glyph@twistedmatrix.com>
	<20021021001305.GC13974@minkirri.apana.org.au>
	<20021021011147.GB909@twistedmatrix.com>
Message-ID: <20021020211738.7f0aa757.twisted@itamarst.org>

On Mon, 21 Oct 2002 03:11:47 +0200
Christopher Armstrong <radix at twistedmatrix.com> wrote:

> Hey, I forgot zlib could do that. That's really cool (And I'd
> recommend doing it that way, barring any issues with it (and "it's not
> UNIXy" isn't an issue, afaic ;))).

As I'm maintainer of this module, this is how'll it'll work - whoever
sends me a patch first gets it in. I prefer the threaded way,
personally.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From glyph at twistedmatrix.com  Sun Oct 20 22:01:51 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 20 Oct 2002 21:01:51 -0500 (CDT)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021020211738.7f0aa757.twisted@itamarst.org>
References: <20021021001305.GC13974@minkirri.apana.org.au>
	<20021021011147.GB909@twistedmatrix.com>
	<20021020211738.7f0aa757.twisted@itamarst.org>
Message-ID: <20021020.210151.95501231.glyph@twistedmatrix.com>


On Sun, 20 Oct 2002 21:17:38 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> I prefer the threaded way, personally.

I vastly prefer block-at-a-time compression, now that I've been reminded of it.
It sets a better precedent for other bits of Twisted that want to use
compression.  I imagine that the zlib module is more portable than the threads
module, overall.  Somebody please get a patch to itamar this way first... ;-)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021020/561958d7/attachment.pgp 

From jbauer at rubic.com  Sun Oct 20 21:53:55 2002
From: jbauer at rubic.com (Jeff Bauer)
Date: Sun, 20 Oct 2002 20:53:55 -0500
Subject: [Twisted-Python] Doc suggestion for post-installation
Message-ID: <3DB35E33.6BB55869@rubic.com>

I have a modest suggestion for the "Installing Twisted"
document, shamelessly borrowed from ZODB.

Upon installation, suggest that the user try running 
the following from the python interpreter:

  $ python
  >>> import twisted.copyright
  >>> print twisted.copyright.version
  1.0.0rc3

This would catch an obvious import error of leaving
twisted out of PYTHONPATH, or accidentally using an
older, previously installed version of Twisted.

If the line:

   __version__ = "1.0.0rc3" 

were placed in the base __init__.py file, the above
python commands could be shortened to:

  >>> import twisted
  >>> print twisted.__version__

Regards,

Jeff Bauer
Rubicon Research



From twisted at moshez.org  Mon Oct 21 04:07:56 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 21 Oct 2002 08:07:56 -0000
Subject: [Twisted-Python] Twisted 1.0.0rc3 on WinNT / Cygwin
In-Reply-To: <20021021011400.GA9377@mumak.net>
References: <20021021011400.GA9377@mumak.net>
Message-ID: <20021021080756.19352.qmail@green.zadka.com>

On Mon, 21 Oct 2002, jml at mumak.net (Jonathan M. Lange) wrote:

> gcc -g -O2 -Wall -Wstrict-prototypes -DUSE_DL_IMPORT
> -I/usr/include/python2.1 -c twisted/internet/cReactor/cReactor.c -o
> build/temp.cygwin-1.3.3-i686-2.1/cReactor.o
> twisted/internet/cReactor/cReactor.c: In function
> `iterate_internal_finalize':
> twisted/internet/cReactor/cReactor.c:696: warning: implicit declaration
> of function `PyEval_ReleaseLock'
> twisted/internet/cReactor/cReactor.c:715: warning: implicit declaration
> of function `PyEval_AcquireLock'
> twisted/internet/cReactor/cReactor.c: At top level:
> twisted/internet/cReactor/cReactor.c:1238: initializer element is not
> constant
> twisted/internet/cReactor/cReactor.c:1238: (near initialization for
> `cReactorType.ob_type')
> error: command 'gcc' failed with exit status 1

This is indeed a bug in Twisted: cReactorType is initialized with 
Py_HEADINIT(&PyTypeType) instead of being initilalized to NULL and being
set in some init routine. I suggest that in the mean time, we disable cReactor's
build on cygwin.



From twisted at moshez.org  Mon Oct 21 04:09:10 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 21 Oct 2002 08:09:10 -0000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021011147.GB909@twistedmatrix.com>
References: <20021021011147.GB909@twistedmatrix.com>, <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com> <20021021001305.GC13974@minkirri.apana.org.au>
Message-ID: <20021021080910.19374.qmail@green.zadka.com>

On Mon, 21 Oct 2002, Christopher Armstrong <radix at twistedmatrix.com> wrote:

> Hey, I forgot zlib could do that. That's really cool (And I'd
> recommend doing it that way, barring any issues with it (and "it's not
> UNIXy" isn't an issue, afaic ;))).

I fail to see why this is a good idea. The gzip method would work on UNIX
with much simpler code, and will be far more efficient.



From andrew-twisted at puzzling.org  Mon Oct 21 04:26:29 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 21 Oct 2002 18:26:29 +1000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021080910.19374.qmail@green.zadka.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com> <20021021001305.GC13974@minkirri.apana.org.au> <20021021080910.19374.qmail@green.zadka.com>
Message-ID: <20021021082629.GC21689@ritsuko.xware.cx>

On Mon, Oct 21, 2002 at 08:09:10AM -0000, Moshe Zadka wrote:
> On Mon, 21 Oct 2002, Christopher Armstrong <radix at twistedmatrix.com> wrote:
> 
> > Hey, I forgot zlib could do that. That's really cool (And I'd
> > recommend doing it that way, barring any issues with it (and "it's not
> > UNIXy" isn't an issue, afaic ;))).
> 
> I fail to see why this is a good idea. The gzip method would work on UNIX
> with much simpler code, and will be far more efficient.

Hmm.  Cygwin is available for Windows, which provides a gzip.exe you
could use.  So perhaps this approach is ok from a cross-platform
perspective, with the caveat that you may need to install a gzip
executable if your system doesn't already come with one -- and in fact
there's GzipFile or whatever in the standard python library, so we could
always fall back to that...

Just some random thoughts.

-Andrew.




From a.d.stribblehill at durham.ac.uk  Mon Oct 21 10:50:49 2002
From: a.d.stribblehill at durham.ac.uk (Andrew Stribblehill)
Date: Mon, 21 Oct 2002 15:50:49 +0100
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
In-Reply-To: <15793.34455.512573.39157@gargle.gargle.HOWL>
References: <15791.12797.768063.913733@gargle.gargle.HOWL> <3DAF3453.4030306@twistedmatrix.com> <15791.13852.867292.398473@gargle.gargle.HOWL> <3DAF3952.4050707@twistedmatrix.com> <15793.34455.512573.39157@gargle.gargle.HOWL>
Message-ID: <20021021145049.GE29549@womble.dur.ac.uk>

<snip>
> A couple of kludges that should be cleaned up:
> 
> - What to do if the list of target newsgroups has more than one
>   moderated newsgroup in it?  Off hand, I'm not sure what Usenet does
>   in this case.

inn sends it to the moderator of the first-mentioned moderated group.
The moderator vets it and posts it with the same Newsgroups: line, so
every group gets it even though it's just been moderated for one
group.

-- 
VIKING NORTH UTSIRE SOUTH UTSIRE
VARIABLE 3 OR 4 BECOMING EASTERLY 5 TO 7, PERHAPS GALE 8 IN VIKING
AND SOUTH UTSIRE LATER. SHOWERS THEN RAIN. GOOD BECOMING MODERATE



From justin at gnubian.org  Mon Oct 21 12:42:52 2002
From: justin at gnubian.org (Justin Ryan)
Date: 21 Oct 2002 11:42:52 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <20021021010817.GA437@orcrist>
References: <1035069693.944.10.camel@qutang> <20021020185058.GA783@orcrist>
	<1035143074.872.5.camel@qutang> <20021020215640.GC783@orcrist>
	<1035154178.872.49.camel@qutang>  <20021021010817.GA437@orcrist>
Message-ID: <1035218573.3545.11.camel@qutang>

> As of now, I'm leaning towards using twisted.enterprise without
> t.e.row...except purely for learning purposes. Just this simple
> example of yours shows how quickly object <-> relational model
> mappings can get tricky. But learning about it should be interesting
> nevertheless. 

Well, I'm supposed to be moving into a python dev position @ work soon
and they have actually got quite good object <-> relational mappings
working, but I don't have access to that code yet, and don't know if
i'll even be able to reuse it in my own projects..
 
> Yeah...I read it. That was my thought as well...use a view to flatten
> out two of the objects into one. I'm trying to think of tweaking that
> might help simplify the situation there. Some databases have
> functionality that might enable you to use one denormalized view and
> rewrites on the db backend that would peform the updates properly
> depending on the table. But that functionality would be in the
> database, so it would be implementation-specific. 

and once again, it requires three separate objects - an account, a
contact, and an account_view..

I think I'll poke around with t.enterprise a bit more and see if there's
hope for me there..

Cheers,

-J
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021021/2250cf55/attachment.pgp 

From lists at morpheus.demon.co.uk  Mon Oct 21 15:48:01 2002
From: lists at morpheus.demon.co.uk (Paul Moore)
Date: Mon, 21 Oct 2002 20:48:01 +0100
Subject: [Twisted-Python] Completely new to twisted - where to get some
 background?
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk> <20021020233435.GA15094@meson.dyndns.org>
Message-ID: <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk>

Jp Calderone <exarkun at meson.dyndns.org> writes:

>   From this, I'd say that you're probably going to be a developer, an
> administrator, and a user. ;)

I sort of thought that might be the case :-)

>   The current NNTP code lets you use one of two different backends - a
> pickle file or an RDBM (postgres is what was used to develop it).  To serve
> news out of mbox files, you'll need to write another backend that implements
> the NewsStorage interface (twisted.news.database.NewsStorage), then hand
> this to either an NNTPServerFactory or a UsenetServerFactory (probably the
> former).

Thanks! That pointer was enough to get me started, and I managed to
get a simple "dummy" backend (serving one static article in one group)
up and running in half an hour! It's extremely easy, once you get the
picture.


> It would be nice if 'mktap news' could handle this, but it can't
> (yet), so you'll have to write a little more python to glue it all
> together. twisted.tap.news.updateApplication() is definitely
> something you'll want to look at.

Haven't done this yet, at the moment I'm just starting the server
running directly, not botyhering with mktap/twistd. That's my next job
(as far as learning Twisted goes - writing the backend I really want
probably has to go in there somewhere too :-))

I can see a few possible approaches - the simpler one seems to be to
write a new type of application so that you do "mktap pfmnews". This
seems like an unpleasant hack, though...

Better would probably be to patch Twisted (and submit the patch,
obviously :-)) to allow the "news" application to be more configurable
as regards backend type. My feeling is that this is a reasonable and
not too hard way to go.

I wonder, however, if it is somehow possible to "subclass" the
existing news application type, to add my own backend into it without
needing to patch Twisted. That would seem the best solution,
ultimately. However, I'm not at all familiar with this part of Twisted
yet, so I could easily have missed something simple.

> The Application Howto and the Server Howto are probably worth going
> over:
>
>   http://twistedmatrix.com/documents/howto/application
>   http://twistedmatrix.com/documents/howto/servers
>
>   You shouldn't need to write a Factory or a Protocol to do what you want,
> but knowing how the pieces fit together will probably be beneficial.

It was indeed. Gave me a good place to start.

>   Depending if you try to make "queries" to the mbox synchronous or not, the
> Deferred howto might be relevant as well:
>
>   http://twistedmatrix.com/documents/howto/defer
>
>   Twisted usually considers disk operations (and certainly memory
> operations) fast enough to not worry about this, though, so doing what the
> PickleStorage class does (defer.fail(), defer.succeed()) will probably work
> for you.

So far, the simple approach is working, but I'll keep this in mind...

>   Twisted is definitely suited for this :)  I'm not aware of a document that
> is directly relevant to what you want to do, because it's not too deeply
> related to Twisted.  Hopefully what needs to be done will be clear after you
> check out the code I mentioned above.  

Indeed, it became a lot clearer, very fast. I was getting bogged down
in concepts (Perspective Broker, reactors...) which didn't seem
relevant to me (and weren't, as it happened). Maybe some sort of
documentation roadmap ("If you are trying to do XXX, then start with
documents YYY, ZZZ") would be useful. Your suggestions certainly got
me on the right track, starting from "I want to implement a server",
and "I want to implement a *news* server, specifically".

Thanks for the help,
Paul.

-- 
This signature intentionally left blank



From abo at minkirri.apana.org.au  Mon Oct 21 18:43:02 2002
From: abo at minkirri.apana.org.au (Donovan Baarda)
Date: Tue, 22 Oct 2002 08:43:02 +1000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021080910.19374.qmail@green.zadka.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com> <20021021001305.GC13974@minkirri.apana.org.au> <20021021080910.19374.qmail@green.zadka.com>
Message-ID: <20021021224302.GA15902@minkirri.apana.org.au>

On Mon, Oct 21, 2002 at 08:09:10AM -0000, Moshe Zadka wrote:
> On Mon, 21 Oct 2002, Christopher Armstrong <radix at twistedmatrix.com> wrote:
> 
> > Hey, I forgot zlib could do that. That's really cool (And I'd
> > recommend doing it that way, barring any issues with it (and "it's not
> > UNIXy" isn't an issue, afaic ;))).
> 
> I fail to see why this is a good idea. The gzip method would work on UNIX
> with much simpler code, and will be far more efficient.

Actually, I'm not sure that this is true. The guy developing rdiff-backup
was using the rdiff command in this way and found that the process-spawning
overhead was slowing things down heaps. By changing to using an rdiff python
module he got significant speedups.


-- 
----------------------------------------------------------------------
ABO: finger abo at minkirri.apana.org.au for more info, including pgp key
----------------------------------------------------------------------



From andrew-twisted at puzzling.org  Mon Oct 21 19:34:06 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 22 Oct 2002 09:34:06 +1000
Subject: [Twisted-Python] Completely new to twisted - where to get some background?
In-Reply-To: <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk> <20021020233435.GA15094@meson.dyndns.org> <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk>
Message-ID: <20021021233406.GA8461@ritsuko.xware.cx>

On Mon, Oct 21, 2002 at 08:48:01PM +0100, Paul Moore wrote:
> Jp Calderone <exarkun at meson.dyndns.org> writes:
> 
> >   Twisted is definitely suited for this :)  I'm not aware of a document that
> > is directly relevant to what you want to do, because it's not too deeply
> > related to Twisted.  Hopefully what needs to be done will be clear after you
> > check out the code I mentioned above.  
> 
> Indeed, it became a lot clearer, very fast. I was getting bogged down
> in concepts (Perspective Broker, reactors...) which didn't seem
> relevant to me (and weren't, as it happened). Maybe some sort of

The CVS version of Twisted now has a glossary in the docs -- the idea
being that you'd be able to say "Perspective Broker?  What the hell is
that?  <check glossary>... Oh, ok, that's something else, so I can
ignore that...".  I'd be interested to know if it really is useful for
you?

> documentation roadmap ("If you are trying to do XXX, then start with
> documents YYY, ZZZ") would be useful. Your suggestions certainly got
> me on the right track, starting from "I want to implement a server",
> and "I want to implement a *news* server, specifically".

Of course, then there's all the variations -- "I want to implement a
{mail,web,finger,etc} server" -- which is an awful lot of documentation.
If you'd like to help us by writing a the "I want to implement a news
server" doc, that would help alot :)

-Andrew.




From glyph at twistedmatrix.com  Tue Oct 22 00:52:19 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 21 Oct 2002 23:52:19 -0500 (CDT)
Subject: [Twisted-Python] ANN: Make A Little Framework In Your Soul
Message-ID: <20021021.235219.55512630.glyph@twistedmatrix.com>


BOSTON, MASSACHUSETTS (PSU) -- OCTOBER 21, 2002 -- Darkness shrouds the
horizon, and thunderclouds boom overhead.  Is this just normal northeastern
weather, or something else... something far more sinister?  A milestone release
-- Development Platform 1.0.0 -- of the Twisted Network Framework is available
today indicates a potential major surge in the Reality Distortion Field (RDF)
that surrounds it.

Glyph Lefkowitz, who claims to be in this region of the country to "visit his
girlfriend", has been using the internet to remain connected to the
loosely-connected internet development group known only as "Twisted Matrix
Labs".  Glyph had a few comments on the new release.

"With the 1.0.0 release, Twisted has reached an important milestone in its
maturity," he said from an undisclosed location.  "Twisted is an incredible
specimen of internet technology, as powerful as it is robust, all at once the
most beautiful and terrifying thing you have ever seen."  Further comments
dissolved bursts of static and incoherent babbling.

Other leading members of the Twisted team were equally pleased with the
project's progress.  Itamar Shtull-Trauring spoke highly of it, saying "GIMME
THE CASH OR THE GIRL GETS IT!".  After he recovered his wits and freed the
hostages, Mr. Shtull-Trauring's attorney relayed a revised analysis of
Twisted's progress: "Super-atomic-nanotechnology-now-with-extra-whammo
batteries included!".

More information and downloads are available at:

    http://www.twistedmatrix.com/

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021021/f41c4994/attachment.pgp 

From twisted at itamarst.org  Tue Oct 22 01:00:31 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 01:00:31 -0400
Subject: [Twisted-Python] ANN: Twisted 1.0
Message-ID: <20021022010031.2ebdb060.twisted@itamarst.org>

It has come to our attention that someone is impersonating Glyph and
posting false release announcements. Please ignore any such obvious
fakes.

The real press release for 1.0 is available from:
http://www.zoteca.com/Press/prtwisted10.pdf

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From bruce at cubik.org  Tue Oct 22 05:59:17 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 22 Oct 2002 03:59:17 -0600
Subject: [Twisted-Python] Twisted and the Torque Game Engine
References: <000801c276a7$b0c9b3e0$0200000a@spunk>
Message-ID: <3DB52175.8010102@cubik.org>

Joshua Ritter wrote:
> I wrote a TorqueReactor for Twisted(quite trivial), the only time killer 
> was running into a FPU precision problem...

Would you mind sharing the code that you used to fix that precision problem?

  - Bruce




From twisted at moshez.org  Tue Oct 22 09:18:08 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 22 Oct 2002 13:18:08 -0000
Subject: [Twisted-Python] New Documentation Stuff
Message-ID: <20021022131808.4282.qmail@green.zadka.com>

OK, so after a few more iteration, the Twisted book is starting to stop
looking like a first-grader fingerpainting excercise stuck with magnets to
the refrigerator and instead now has that sleek, polished and professional
look you'd expect from a sixth-grader. 

Enjoy: http://twistedmatrix.com/users/moshez/book.{ps.bz2,pdf}

As a side effect, generate-domdocs has acquired to ability to generate
table of contents. You will notice it in the documentation for the next
release (1.0.1). Also, the hand-coded ToCs from the pb-*.html stuff have
been mercilessly ripped out.

What's in store? I'm hoping my (or someone else) will add an ability to do
footnotes, so the hand-hacked footnote stuff can start going away. The
second thing to do is to add indexing support to generate-domdocs, and starting
to put in index stuff (this is hard work!). On my part, I will keep the 
LaTeX generation stuff up to date with the generate-domdocs stuff, so that
our users can choose both HTML and more paper oriented formats.



From david at lupercalia.net  Tue Oct 22 12:06:42 2002
From: david at lupercalia.net (David Merrill)
Date: Tue, 22 Oct 2002 11:06:42 -0500
Subject: [Twisted-Python] Lampadas, the LDP document management system
Message-ID: <200210221106.43573.david@lupercalia.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I'm the lead developer on Lampadas, a document management system being 
built for the LDP and the Gnome Documentation Project. And of course 
anybody else who wants to use it.

For the last month I've been working on persistent objects, but eventually 
realized I was better off looking for an existing library instead, which 
brought me to Twisted. Looking through your code, I am very impressed 
with your work. It's very good quality, very flexible, and also very much 
aligned with what I want and need for Lampadas. So I'm very seriously 
considering a port to Twisted. If I determine that Lampadas can be 
successfully implemented on a Twisted architecture, I will adopt it.

I could really use some help in decomposing Lampadas into a Twisted 
architecture and getting over the initial hurdles. I'd like for my 
initial evaluation of Twisted to have the best possible chance of 
success, and not to get bogged down because of my own ignorance. Is there 
any kind soul who is willing to discuss Lampadas' specific goals and its 
functionality, and how to best implement them in Twisted?

One system I know Lampadas will rely on extensively is the new 
enterprise.journal system, so I think I want to try implementing a 
journal-based service for Lampadas objects. Since journal is just getting 
off the ground, such a service would be a good test of journal's 
capabilities, and I'd be willing to help on journal development as well. 
Is there any interest in that?

- -- 
David C. Merrill                         http://www.lupercalia.net
Linux Documentation Project                   david at lupercalia.net
Lead Developer                                 http://www.tldp.org

How often it is that the angry man rages denial of what his inner self is
telling him.
	-- "The Collected Sayings of Muad'Dib" by the Princess Irulan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.0 (GNU/Linux)

iD8DBQE9tXeSWC4Sq/MWsY0RAvciAJ9IFqx8sRBpZTqu+Uidg6KRAfEk3ACfTi/w
Jr+F0gUylG3jH3g70p2r67Q=
=KYyN
-----END PGP SIGNATURE-----




From radix at twistedmatrix.com  Tue Oct 22 11:22:39 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 17:22:39 +0200
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <200210221106.43573.david@lupercalia.net>
References: <200210221106.43573.david@lupercalia.net>
Message-ID: <20021022152239.GE12550@twistedmatrix.com>

On Tue, Oct 22, 2002 at 11:06:42AM -0500, David Merrill wrote:
> I'm the lead developer on Lampadas, a document management system being 
> built for the LDP and the Gnome Documentation Project. And of course 
> anybody else who wants to use it.

Can you elaborate on what it does? "Document Management" doesn't
really scream "internet" at me, but you might say that a project I'm
working on (that's based on Twisted), TamTam, is somewhat aligned with
"document management". Also, generate-domdocs, the DOM-munging script
we use to generate documentation (based on XHTML content and
templates), also may be relevant (and it's getting better every month;
hopefully it'll be good enough to call it a separate project,
eventually).

I'm not promising to give a lot of help, but I'm interested, and just
coming out with it on the mailing list is probably the best strategy
for getting help. :)




From pobrien at orbtech.com  Tue Oct 22 11:29:18 2002
From: pobrien at orbtech.com (Patrick K. O'Brien)
Date: Tue, 22 Oct 2002 10:29:18 -0500
Subject: [Twisted-Python] ANN: Twisted 1.0
In-Reply-To: <20021022010031.2ebdb060.twisted@itamarst.org>
References: <20021022010031.2ebdb060.twisted@itamarst.org>
Message-ID: <200210221029.18570.pobrien@orbtech.com>

On Tuesday 22 October 2002 12:00 am, Itamar Shtull-Trauring wrote:
> The real press release for 1.0 is available from:
> http://www.zoteca.com/Press/prtwisted10.pdf

I tried to access the white paper mentioned in the press release, but was 
denied access to it:

http://www.zoteca.com/wp/zbefull.pdf

Is there a way to get to it?

-- 
Patrick K. O'Brien
Orbtech      http://www.orbtech.com/web/pobrien
-----------------------------------------------
"Your source for Python programming expertise."
-----------------------------------------------




From radix at twistedmatrix.com  Tue Oct 22 11:38:27 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 17:38:27 +0200
Subject: [Twisted-Python] Creating an SSH client programatically with Twisted?
In-Reply-To: <200210211856.g9LIulJ67077@cgi-works.com>
References: <200210211856.g9LIulJ67077@cgi-works.com>
Message-ID: <20021022153827.GG12550@twistedmatrix.com>

On Sun, Oct 20, 2002 at 07:02:34AM +1857, Max Schubert wrote:
>     I have looked at the documentation, the twisted.conch.ssh.* classes,
>     and the test_conch.py script and am still having a hard time figuring
>     out how to construct an SSH client using Twisted.
> 
>     Does anyone have pointers to examples or documentation that will help
>     me do this?

Check out the writing clients document at
http://twistedmatrix.com/documents/howto/clients. Conch is only a
server, and the implementation is pretty new, so there's not any
documents on what you're trying to do in particular. You'll have to
resort to really diving into the code.

If you have any specific questions, feel free to ask.




From david at lupercalia.net  Tue Oct 22 13:19:29 2002
From: david at lupercalia.net (David Merrill)
Date: Tue, 22 Oct 2002 12:19:29 -0500
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <20021022152239.GE12550@twistedmatrix.com>
References: <200210221106.43573.david@lupercalia.net> <20021022152239.GE12550@twistedmatrix.com>
Message-ID: <200210221219.30924.david@lupercalia.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Tuesday 22 October 2002 10:22, Christopher Armstrong wrote:
> On Tue, Oct 22, 2002 at 11:06:42AM -0500, David Merrill wrote:
> > I'm the lead developer on Lampadas, a document management system
> > being built for the LDP and the Gnome Documentation Project. And of
> > course anybody else who wants to use it.
>
> Can you elaborate on what it does? "Document Management" doesn't
> really scream "internet" at me, but you might say that a project I'm
> working on (that's based on Twisted), TamTam, is somewhat aligned with
> "document management". Also, generate-domdocs, the DOM-munging script
> we use to generate documentation (based on XHTML content and
> templates), also may be relevant (and it's getting better every month;
> hopefully it'll be good enough to call it a separate project,
> eventually).

Lampadas is designed for the LDP, so if you think about what is involved 
in publishing such a website, you'll get the idea. However, it aims to go 
beyond the current LDP, or why bother? Let me break it down a bit...

The LDP has nearly 700 documents. Some are in text, some in LinuxDoc SGML, 
some in DocBook SGML, some in DocBook XML. Lampadas has to let our staff 
manage them, publish them all in html and other downloadable formats, and 
also publish additional pages that make up our website. So essentially it 
is a documentation meta-data management system + a publishing system + a 
simple content management system.

Architecturally, it is a postgresql database with a documentation object 
layer and a web content object layer, then various clients built on the 
object layers. The website is such a client, as is the publisher. A 
mirroring client mirrors documents from other projects (GNU manuals, 
GNOME documentation, and the Jargon file are the initial targets.)

There's a bit more to it than that, and additional things are planned, but 
that's the core of it.

There's a demo running at http://www.lampadas.org. Performance is abysmal 
since it's now running on my partially implemented persistence system and 
is hitting the database waaaaay too often, but it generally works.

- -- 
David C. Merrill                         http://www.lupercalia.net
Linux Documentation Project                   david at lupercalia.net
Lead Developer                                 http://www.tldp.org

The most important bill in our whole code is that for the diffusion of
knowledge among the people.  No other sure foundation can be devised, for
the preservation of freedom and happiness.
	-- Thomas Jefferson
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.0 (GNU/Linux)

iD8DBQE9tYihWC4Sq/MWsY0RAjPfAJ4kqM8v+fhqtIT/E4bwLjjORRhJ4QCfVonA
YyvmDKCM1rWq7ZeicPPwQMU=
=D5Wy
-----END PGP SIGNATURE-----




From radix at twistedmatrix.com  Tue Oct 22 12:55:27 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 18:55:27 +0200
Subject: [Twisted-Python] Creating an SSH client programatically with Twisted?
In-Reply-To: <200210221608.g9MG8MJ07637@cgi-works.com>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
Message-ID: <20021022165527.GJ12550@twistedmatrix.com>

On Mon, Oct 21, 2002 at 04:14:04AM +1857, Max Schubert wrote:
> Hi,
> 
>     Thank you for the information and help.  Paul Swartz sent me an SSH
>     client he has written ...


I don't think Paul knows how to *stop* coding, zow!



From radix at twistedmatrix.com  Tue Oct 22 13:02:21 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 19:02:21 +0200
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <200210221219.30924.david@lupercalia.net>
References: <200210221106.43573.david@lupercalia.net> <20021022152239.GE12550@twistedmatrix.com> <200210221219.30924.david@lupercalia.net>
Message-ID: <20021022170221.GK12550@twistedmatrix.com>

On Tue, Oct 22, 2002 at 12:19:29PM -0500, David Merrill wrote:

> Lampadas is designed for the LDP, so if you think about what is involved 
> in publishing such a website, you'll get the idea. However, it aims to go 
> beyond the current LDP, or why bother? Let me break it down a bit...
> 
> The LDP has nearly 700 documents. Some are in text, some in LinuxDoc SGML, 
> some in DocBook SGML, some in DocBook XML. Lampadas has to let our staff 
> manage them, publish them all in html and other downloadable formats, and 
> also publish additional pages that make up our website. So essentially it 
> is a documentation meta-data management system + a publishing system + a 
> simple content management system.

Damn, this sounds like a perfect application for TamTam, too bad it's
not done yet :)

Oh well, I won't suggest that you wait for us to finish it :) but
perhaps in the future we can collaborate; I'll get in touch with you
when I think Tamtam is (nearly) robust enough to handle this use-case.

--
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From twisted at itamarst.org  Tue Oct 22 13:30:38 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 13:30:38 -0400
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <200210221106.43573.david@lupercalia.net>
References: <200210221106.43573.david@lupercalia.net>
Message-ID: <20021022133038.729047cf.twisted@itamarst.org>

On Tue, 22 Oct 2002 11:06:42 -0500
David Merrill <david at lupercalia.net> wrote:

> One system I know Lampadas will rely on extensively is the new 
> enterprise.journal system, so I think I want to try implementing a 
> journal-based service for Lampadas objects. Since journal is just
> getting off the ground, such a service would be a good test of
> journal's capabilities, and I'd be willing to help on journal
> development as well. Is there any interest in that?

Note that journal doesn't have to be RDBMS tied, it can work on in
memory objects only while still preserving durability ACID aspect. The
default RDBMS storage is tied to Twisted's row object/relational mapper,
but you can probably connect it to other object/relational mappers as
well.

I'd be very interested in people using it, and getting feedback and of
course code - look at the test code in latest CVS to see the newest
abstractions and utilities we came up with to make journal programming
easier.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From lists at morpheus.demon.co.uk  Tue Oct 22 13:49:09 2002
From: lists at morpheus.demon.co.uk (Paul Moore)
Date: Tue, 22 Oct 2002 18:49:09 +0100
Subject: [Twisted-Python] Some comments on twisted.news
Message-ID: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>

I just set up a basic demo new server using twisted. Some initial comments:

1. It took me almost no time to put together a basic dummy NNTP
   server. Just create the backend, put a mktap driver in, and it's
   working.

2. There seems to be a problem with the server class. It translates
   \r\n.. to \r\n. in the data the backend supplies - this should be
   the other way round (it should be *doubling* the dots, so that they
   don't look like the end of data marker to the client).

3. It would be nice if the server handled the translation to CRLF, so
   that backends could return data with lines separated by \n, and the
   server class would convert that to \r\n. After all, \n is the
   "normal" end of line character internal to Python code, and \r\n is
   a feature of the NNTP protocol, so the protocol driver should be
   responsible for the conversion (IMHO). Of course, this is a
   behaviour change, which could break existing backends, so maybe
   it's not practical to make this change.

4. The implementation of STAT requests the article from the
   backend. This could be inefficient if getting the message ID is
   cheap, but getting the full article is expensive for a particular
   backend (it will be for me). In my partly-implemented NNTP server
   written in "raw" Python (before I found Twisted) I had a backend
   method getArticle(..., head=1, body=1) which was used to implement
   all of HEAD, BODY, ARTICLE and STAT, just by setting different
   values for the head and body parameters (so the backend could check
   for the case where neither was required, and act accordingly).

(2) is obviously fairly trivial. I think I could implement (3) and
(4), if it would be useful. I could submit a patch, which would alter
the server code and the 2 existing backends (I couldn't test the
database backend, as I don't have a database to test with, but I could
test the pickle-based code). Would this be helpful? Are there likely
to be 3rd party nntp backends which would be broken by such a change?

Paul.

-- 
This signature intentionally left blank



From david at lupercalia.net  Tue Oct 22 15:04:46 2002
From: david at lupercalia.net (David Merrill)
Date: Tue, 22 Oct 2002 14:04:46 -0500
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <20021022133038.729047cf.twisted@itamarst.org>
References: <200210221106.43573.david@lupercalia.net> <20021022133038.729047cf.twisted@itamarst.org>
Message-ID: <200210221404.47231.david@lupercalia.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Tuesday 22 October 2002 12:30, Itamar Shtull-Trauring wrote:
> On Tue, 22 Oct 2002 11:06:42 -0500
>
> David Merrill <david at lupercalia.net> wrote:
> > One system I know Lampadas will rely on extensively is the new
> > enterprise.journal system, so I think I want to try implementing a
> > journal-based service for Lampadas objects. Since journal is just
> > getting off the ground, such a service would be a good test of
> > journal's capabilities, and I'd be willing to help on journal
> > development as well. Is there any interest in that?
>
> Note that journal doesn't have to be RDBMS tied, it can work on in
> memory objects only while still preserving durability ACID aspect. The
> default RDBMS storage is tied to Twisted's row object/relational
> mapper, but you can probably connect it to other object/relational
> mappers as well.

I just read the prevayler documentation and I've also scanned the journal 
code, so I have a pretty good idea how it's supposed to work in 
principle. I'll see if I can get something set up.

Do you have any sample client code anywhere that I can use as a model? 
Maybe you could add it to /doc/examples?

- -- 
David C. Merrill                         http://www.lupercalia.net
Linux Documentation Project                   david at lupercalia.net
Lead Developer                                 http://www.tldp.org

If you know the enemy and know yourself, you need not fear the result of
a hundred battles. If you know yourself but not the enemy, for every
victory gained you will also suffer a defeat. If you know neither the
enemy nor yourself, you will succumb in every battle.
	-- Sun Tzu, "The Art of War"
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.0 (GNU/Linux)

iD8DBQE9taFOWC4Sq/MWsY0RAll8AJ9aDu7LItHbt3/+9V2ds2Pmpr8xFQCeNYB3
telhNx3Ogmu9P93WipFEYAQ=
=ahSq
-----END PGP SIGNATURE-----




From twisted at itamarst.org  Tue Oct 22 14:12:32 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 14:12:32 -0400
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <200210221404.47231.david@lupercalia.net>
References: <200210221106.43573.david@lupercalia.net>
	<20021022133038.729047cf.twisted@itamarst.org>
	<200210221404.47231.david@lupercalia.net>
Message-ID: <20021022141232.4ee7eb8f.twisted@itamarst.org>

On Tue, 22 Oct 2002 14:04:46 -0500
David Merrill <david at lupercalia.net> wrote:

> Do you have any sample client code anywhere that I can use as a model?
> 
> Maybe you could add it to /doc/examples?

Look at twisted/test/test_journal.py - it's a pretty complete example of
modelling and then using a command-journalling system.

Eventually I will write docs - it's on my todo list.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From radix at twistedmatrix.com  Tue Oct 22 15:21:13 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 21:21:13 +0200
Subject: [Twisted-Python] Some comments on twisted.news
In-Reply-To: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
Message-ID: <20021022192113.GL12550@twistedmatrix.com>

On Tue, Oct 22, 2002 at 06:49:09PM +0100, Paul Moore wrote:
> (2) is obviously fairly trivial. I think I could implement (3) and
> (4), if it would be useful. I could submit a patch, which would alter
> the server code and the 2 existing backends (I couldn't test the
> database backend, as I don't have a database to test with, but I could
> test the pickle-based code). Would this be helpful? Are there likely
> to be 3rd party nntp backends which would be broken by such a change?

There certainly aren't any 3rd party backends yet, twisted.news is
still fairly new (and doesn't have any users, afaik, although some may
be lurking). I'd recommend implementing everything and waiting for
exarkun's approval (He may be a while, as he's visiting Minnesota
atm), but I really doubt he'll have any problems with it.

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From twisted at itamarst.org  Tue Oct 22 15:30:33 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 15:30:33 -0400
Subject: [Twisted-Python] HTML version of the press release
Message-ID: <20021022153033.33ea2cef.twisted@itamarst.org>

http://zoteca.com/Press/prtwisted10.html

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From radix at twistedmatrix.com  Tue Oct 22 15:36:36 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 21:36:36 +0200
Subject: [Twisted-Python] ANN: Twisted 1.0
In-Reply-To: <200210221029.18570.pobrien@orbtech.com>
References: <20021022010031.2ebdb060.twisted@itamarst.org> <200210221029.18570.pobrien@orbtech.com>
Message-ID: <20021022193636.GM12550@twistedmatrix.com>

On Tue, Oct 22, 2002 at 10:29:18AM -0500, Patrick K. O'Brien wrote:
> I tried to access the white paper mentioned in the press release, but was 
> denied access to it:
> 
> http://www.zoteca.com/wp/zbefull.pdf
> 
> Is there a way to get to it?

That's been fixed.

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From pobrien at orbtech.com  Tue Oct 22 15:53:03 2002
From: pobrien at orbtech.com (Patrick K. O'Brien)
Date: Tue, 22 Oct 2002 14:53:03 -0500
Subject: [Twisted-Python] ANN: Twisted 1.0
In-Reply-To: <20021022193636.GM12550@twistedmatrix.com>
References: <20021022010031.2ebdb060.twisted@itamarst.org> <200210221029.18570.pobrien@orbtech.com> <20021022193636.GM12550@twistedmatrix.com>
Message-ID: <200210221453.03924.pobrien@orbtech.com>

On Tuesday 22 October 2002 02:36 pm, Christopher Armstrong wrote:
> On Tue, Oct 22, 2002 at 10:29:18AM -0500, Patrick K. O'Brien wrote:
> > I tried to access the white paper mentioned in the press release, but was
> > denied access to it:
> >
> > http://www.zoteca.com/wp/zbefull.pdf
> >
> > Is there a way to get to it?
>
> That's been fixed.

Great. Thanks.

-- 
Patrick K. O'Brien
Orbtech      http://www.orbtech.com/web/pobrien
-----------------------------------------------
"Your source for Python programming expertise."
-----------------------------------------------




From developer at csrules.dyndns.org  Tue Oct 22 17:17:14 2002
From: developer at csrules.dyndns.org (developer at csrules.dyndns.org)
Date: Tue, 22 Oct 2002 16:17:14 -0500 (CDT)
Subject: [Twisted-Python] Some comments on twisted.mail
In-Reply-To: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
Message-ID: <10209.209.5.243.3.1035321434.squirrel@seraphine.csrules.dyndns.org>

Just wondering if anyone uses twisted.mail as a mail server?

saw ZOE http://guests.evectors.it/zoe lately and wondered what it would
take to implement something like that with a twisted framework...

-Just wondrin.







From ritterjoshua at msn.com  Tue Oct 22 11:03:04 2002
From: ritterjoshua at msn.com (Joshua Ritter)
Date: Tue, 22 Oct 2002 10:03:04 -0500
Subject: [Twisted-Python] dbcred and MySQL Incompatibility
Message-ID: <000501c279dc$1ffb3cc0$0200000a@spunk>

MySQL requires that a single SQL statement be sent to query ...
transactional or not... http://www.mysql.com/doc/en/mysql_query.html

dbcred is incompatible with MySQL due to it's batching of ; delimited SQL
statements.  There is also such functionality in
enterprise.row.StatementBatch

createSchema() ; createIdentity() ; and removeIdentity() fail under MySQL
currently... once the SQL statements are seperated; I have verified them
working.

-J







From itamar at itamarst.org  Tue Oct 22 12:05:55 2002
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 12:05:55 -0400
Subject: [Twisted-Python] ANN: Twisted 1.0
In-Reply-To: <200210221029.18570.pobrien@orbtech.com>
References: <20021022010031.2ebdb060.twisted@itamarst.org>
	<200210221029.18570.pobrien@orbtech.com>
Message-ID: <20021022120555.58b5c9eb.itamar@itamarst.org>

On Tue, 22 Oct 2002 10:29:18 -0500
"Patrick K. O'Brien" <pobrien at orbtech.com> wrote:

> I tried to access the white paper mentioned in the press release, but
> was denied access to it:
> 
> http://www.zoteca.com/wp/zbefull.pdf

I removed the password.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From gustav at morpheus.demon.co.uk  Tue Oct 22 14:11:31 2002
From: gustav at morpheus.demon.co.uk (Paul Moore)
Date: Tue, 22 Oct 2002 19:11:31 +0100
Subject: [Twisted-Python] Completely new to twisted - where to get some
 background?
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk> <20021020233435.GA15094@meson.dyndns.org>
 <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk>
 <20021021233406.GA8461@ritsuko.xware.cx>
Message-ID: <n2m-g.vg3upcmk.fsf@morpheus.demon.co.uk>

Andrew Bennetts <andrew-twisted at puzzling.org> writes:

> The CVS version of Twisted now has a glossary in the docs -- the idea
> being that you'd be able to say "Perspective Broker?  What the hell is
> that?  <check glossary>... Oh, ok, that's something else, so I can
> ignore that...".  I'd be interested to know if it really is useful for
> you?

I can't easily get at the CVS version, but I suspect something like
that would have been useful. I've just had a brief look at the book
Moshe has mentioned on the list, and that looks helpful, too.

It's one of those chicken and egg situations - once the arrangement
"clicks", it's hard to see why it seemed so complicated.

> Of course, then there's all the variations -- "I want to implement a
> {mail,web,finger,etc} server" -- which is an awful lot of documentation.

Yes. I nearly didn't mention specific server types, because that's
what causes the explosion of cases. And just saying "I want to write a
server", and not finding it obvious that you look at the "Writing
Servers" document is just plain dumb (I'm working on a decent excuse
for being this stupid :-))

> If you'd like to help us by writing a the "I want to implement a news
> server" doc, that would help alot :)

I'll do what I can. But I'm now not sure of the benefit. There isn't
so much a learning curve with Twisted as a speed bump - at first
glance, you're not sure what you're looking at, but suddenly you
wonder what the difficulty was, and then you're off!

I'll think about whether I'd have found a conspicuous "Start Here"
document any use, and if so, I'll have a go at writing it :-)

Paul.

-- 
This signature intentionally left blank



From z3p at twistedmatrix.com  Tue Oct 22 19:24:47 2002
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Tue, 22 Oct 2002 19:24:47 -0400
Subject: [Twisted-Python] Some comments on twisted.mail
In-Reply-To: <10209.209.5.243.3.1035321434.squirrel@seraphine.csrules.dyndns.org>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
Message-ID: <3DB5A5FF.6853.1341CA5@localhost>

On 22 Oct 2002 at 16:17, 
developer at csrules.dyndns.org wrote:

> Just wondering if anyone uses twisted.mail as a mail server?
> 
> saw ZOE http://guests.evectors.it/zoe lately and wondered what it would
> take to implement something like that with a twisted framework...
> 
> -Just wondrin.

Other people have had this idea after seeing ZOE.  
I don't know what the current status of t.mail is, 
but I doubt it would be hard to make it functional 
enough to use for that type of app.
-p

-- 
     Paul Swartz
(o_  http://twistedmatrix.com/users/z3p.twistd/
//\  z3p at twistedmatrix.com
V_/_ AIM: Z3Penguin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20021022/67b910c1/attachment.htm 

From z3p at twistedmatrix.com  Tue Oct 22 19:45:44 2002
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Tue, 22 Oct 2002 19:45:44 -0400
Subject: [Twisted-Python] Creating an SSH client programatically with Twisted? 
In-Reply-To: <200210221608.g9MG8MJ07637@cgi-works.com>
Message-ID: <3DB5AAE8.1831.147483D@localhost>

On 22 Oct 2002 at 12:14, Max Schubert wrote:

> Hi,
> 
>     Thank you for the information and help.  Paul Swartz sent me an SSH
>     client he has written and mentioned that he might be doing some more
>     client examples and documentation for the conch module at some point.
> 
> Max

As promised, I've attached a simple SSH client.  
It connects to a server, and runs three programs: 
true, false, and echo.  It tries to use a DSA 
public key in ~/.ssh/id_dsa[.pub] for 
authentication but falls back to asking for a 
password.  I'll be putting this in CVS soon, but 
you saw it here first :)
-p

-- 
     Paul Swartz
(o_  http://twistedmatrix.com/users/z3p.twistd/
//\  z3p at twistedmatrix.com
V_/_ AIM: Z3Penguin

-------------- next part --------------
The following section of this message contains a file attachment
prepared for transmission using the Internet MIME message format.
If you are using Pegasus Mail, or any another MIME-compliant system,
you should be able to save it or view it from within your mailer.
If you cannot, please ask your system administrator for assistance.

   ---- File information -----------
     File:  simple_ssh.py
     Date:  22 Oct 2002, 19:41
     Size:  2909 bytes.
     Type:  Text
-------------- next part --------------
A non-text attachment was scrubbed...
Name: simple_ssh.py
Type: application/octet-stream
Size: 2909 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021022/d3a78831/attachment.obj 

From developer at csrules.dyndns.org  Tue Oct 22 20:00:45 2002
From: developer at csrules.dyndns.org (developer at csrules.dyndns.org)
Date: Tue, 22 Oct 2002 19:00:45 -0500 (CDT)
Subject: [Twisted-Python] Components
In-Reply-To: <3DB5AAE8.1831.147483D@localhost>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
        <3DB5AAE8.1831.147483D@localhost>
Message-ID: <1840.192.168.2.20.1035331245.squirrel@seraphine.csrules.dyndns.org>

I'm new to twisted. So just jump up and slap me if necessary.
But i'm reading the new "book" (all hail moshez) and
reading about PB. Now micro$oft has alot of information
out there about writing component based appliations
whereby you expose your business object through COM.
Would PB be considered a competing technology for this?
Could i wrap my business objects with PB and expose them
this way?

-newbie...





From andrew-twisted at puzzling.org  Tue Oct 22 20:54:19 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 23 Oct 2002 10:54:19 +1000
Subject: [Twisted-Python] New Documentation Stuff
In-Reply-To: <20021022131808.4282.qmail@green.zadka.com>
References: <20021022131808.4282.qmail@green.zadka.com>
Message-ID: <20021023005419.GA29244@ritsuko.xware.cx>

On Tue, Oct 22, 2002 at 01:18:08PM -0000, Moshe Zadka wrote:
> 
> What's in store? I'm hoping my (or someone else) will add an ability
> to do footnotes, so the hand-hacked footnote stuff can start going

There's a reasonable chance I'll do that fairly soon, but I offer no
guarantees here :)

-Andrew.




From andrew-twisted at puzzling.org  Tue Oct 22 21:09:17 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 23 Oct 2002 11:09:17 +1000
Subject: [Twisted-Python] Completely new to twisted - where to get some background?
In-Reply-To: <n2m-g.vg3upcmk.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk> <20021020233435.GA15094@meson.dyndns.org> <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk> <20021021233406.GA8461@ritsuko.xware.cx> <n2m-g.vg3upcmk.fsf@morpheus.demon.co.uk>
Message-ID: <20021023010917.GB29244@ritsuko.xware.cx>

On Tue, Oct 22, 2002 at 07:11:31PM +0100, Paul Moore wrote:
> Andrew Bennetts <andrew-twisted at puzzling.org> writes:
> 
> > The CVS version of Twisted now has a glossary in the docs -- the idea
> > being that you'd be able to say "Perspective Broker?  What the hell is
> > that?  <check glossary>... Oh, ok, that's something else, so I can
> > ignore that...".  I'd be interested to know if it really is useful for
> > you?
> 
> I can't easily get at the CVS version, but I suspect something like
> that would have been useful. I've just had a brief look at the book
> Moshe has mentioned on the list, and that looks helpful, too.

The easiest way to get to the CVS docs is Moshe's book -- he generates
it from the CVS ones, so it includes the glossary :)

> It's one of those chicken and egg situations - once the arrangement
> "clicks", it's hard to see why it seemed so complicated.

Excellent :)

-Andrew.




From glyph at twistedmatrix.com  Tue Oct 22 21:31:40 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 22 Oct 2002 20:31:40 -0500 (CDT)
Subject: [Twisted-Python] dbcred and MySQL Incompatibility
In-Reply-To: <000501c279dc$1ffb3cc0$0200000a@spunk>
References: <000501c279dc$1ffb3cc0$0200000a@spunk>
Message-ID: <20021022.203140.21955151.glyph@twistedmatrix.com>

On Tue, 22 Oct 2002 10:03:04 -0500, "Joshua Ritter" <ritterjoshua at msn.com> wrote:
> createSchema() ; createIdentity() ; and removeIdentity() fail under MySQL
> currently... once the SQL statements are seperated; I have verified them
> working.

Can you perhaps write a patch which separates the statements or implements
StatementBatch so that it's MySQL friendly?  Thanks.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021022/6b0d7d40/attachment.pgp 

From glyph at twistedmatrix.com  Tue Oct 22 21:33:31 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 22 Oct 2002 20:33:31 -0500 (CDT)
Subject: [Twisted-Python] Creating an SSH client programatically with
 Twisted? 
In-Reply-To: <3DB5AAE8.1831.147483D@localhost>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
	<3DB5AAE8.1831.147483D@localhost>
Message-ID: <20021022.203331.26095706.glyph@twistedmatrix.com>

On Tue, 22 Oct 2002 19:45:44 -0400, "Paul Swartz" <z3p at twistedmatrix.com> wrote:
> As promised, I've attached a simple SSH client.  

WHAT ARE YOU, SOME KIND OF MACHINE!?!

:-)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021022/62ed56f1/attachment.pgp 

From glyph at twistedmatrix.com  Tue Oct 22 21:40:04 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 22 Oct 2002 20:40:04 -0500 (CDT)
Subject: [Twisted-Python] Components
In-Reply-To: <1840.192.168.2.20.1035331245.squirrel@seraphine.csrules.dyndns.org>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
	<3DB5AAE8.1831.147483D@localhost>
	<1840.192.168.2.20.1035331245.squirrel@seraphine.csrules.dyndns.org>
Message-ID: <20021022.204004.122593650.glyph@twistedmatrix.com>


On Tue, 22 Oct 2002 19:00:45 -0500 (CDT), <developer at csrules.dyndns.org> wrote:

> Could i wrap my business objects with PB and expose them [as with COM]?

Not quite.  Insofar as PB is a "competing technology", it is competing with
DCOM, not COM.  Think of it like this: COM:DCOM::Python:PB.  COM is an object
model; Python is an object model.  You can give your objects COM stubs or you
can give them Python wrappers.  Then, you can publish Python objects by
wrapping them with pb.Referenceable or doing the appropriate DCOM things.

However, as MSFT is no longer pushing DCOM, and instead focusing on SOAP, you
can see it as "competing" with that standard.

This metaphor is not perfect, but it should give you a better idea.  PB is
specifically for objects communicating over "long" distances, between
segregated "vats" of objects (c.f. http://www.erights.org/) and not to provide
function pointers between objects that live in the same address space.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021022/a6f144f0/attachment.pgp 

From developer at csrules.dyndns.org  Tue Oct 22 21:49:32 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Tue, 22 Oct 2002 20:49:32 -0500 (CDT)
Subject: [Twisted-Python] Components
In-Reply-To: <20021022.204004.122593650.glyph@twistedmatrix.com>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
        <3DB5AAE8.1831.147483D@localhost>
        <1840.192.168.2.20.1035331245.squirrel@seraphine.csrules.dyndns.org>
        <20021022.204004.122593650.glyph@twistedmatrix.com>
Message-ID: <2079.192.168.2.20.1035337772.squirrel@seraphine.csrules.dyndns.org>

I think actually that I tend to get terminology messed (as i'm not a
programmer by trade) and what you describe is what i meant.

Thanks!

I've been reviewing the mailing list archives. Specifically I've written
some "applications" based on zope. Basically some database stuff with zope
managing the views to the data. I'm encouraged to see (in the archives) that
there seems to be some interest in melding zope and twisted in some way.

-Darryl


> On Tue, 22 Oct 2002 19:00:45 -0500 (CDT), <developer at csrules.dyndns.org>
> wrote:
>
>> Could i wrap my business objects with PB and expose them [as with
>> COM]?
>
> Not quite.  Insofar as PB is a "competing technology", it is competing
> with DCOM, not COM.  Think of it like this: COM:DCOM::Python:PB.  COM is
> an object model; Python is an object model.  You can give your objects
> COM stubs or you can give them Python wrappers.  Then, you can publish
> Python objects by wrapping them with pb.Referenceable or doing the
> appropriate DCOM things.
>
> However, as MSFT is no longer pushing DCOM, and instead focusing on
> SOAP, you can see it as "competing" with that standard.
>
> This metaphor is not perfect, but it should give you a better idea.  PB
> is specifically for objects communicating over "long" distances, between
> segregated "vats" of objects (c.f. http://www.erights.org/) and not to
> provide function pointers between objects that live in the same address
> space.
>
> --
>  |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
>  |   < _/ >   |  Lead Developer,  the Twisted project  |
>  |  < ___/ >  |      http://www.twistedmatrix.com      |






From kkennedy at kenzoid.com  Wed Oct 23 00:34:42 2002
From: kkennedy at kenzoid.com (Ken Kennedy)
Date: Wed, 23 Oct 2002 00:34:42 -0400
Subject: [Twisted-Python] Error using mktap for ResourceTemplates
Message-ID: <20021023043441.GB11598@kenzoid.com>

I'm getting an error with both the 1.0.0-1 Debian package (congrats on
1.0, BTW!...and many, many thanks for the up-to-date debs.) and
current CVS when I try to use the mktap --processor flag suggested in
doc/howto/resource-templates.html

 mktap web --processor=.rtl=twisted.web.script.ResourceTemplate 
 
'NoneType' object has no attribute 'processors'
Usage: mktap web [options]...etc.

I'll look into it myself in the morning, but I wanted to see if anyone
else had noticed this. Quixote/Twisted interaction possibilities look
excellent to me!

-- 

Ken Kennedy	| http://www.kenzoid.com	| kenzoid at io.com



From twisted at moshez.org  Wed Oct 23 00:44:02 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 23 Oct 2002 04:44:02 -0000
Subject: [Twisted-Python] Error using mktap for ResourceTemplates
In-Reply-To: <20021023043441.GB11598@kenzoid.com>
References: <20021023043441.GB11598@kenzoid.com>
Message-ID: <20021023044402.14829.qmail@green.zadka.com>

On Wed, 23 Oct 2002 00:34:42 -0400, kkennedy at kenzoid.com (Ken Kennedy) wrote:
> I'm getting an error with both the 1.0.0-1 Debian package (congrats on
> 1.0, BTW!...and many, many thanks for the up-to-date debs.) and
> current CVS when I try to use the mktap --processor flag suggested in
> doc/howto/resource-templates.html
> 
>  mktap web --processor=.rtl=twisted.web.script.ResourceTemplate 

I do believe the man page tells you to supply a "--root" argument
before the --processor argument.



From twisted at moshez.org  Wed Oct 23 02:56:12 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 23 Oct 2002 06:56:12 -0000
Subject: [Twisted-Python] Documentation: Footnotes [Yay]
Message-ID: <20021023065612.16087.qmail@green.zadka.com>

So, we now have footnote support, and I fixed all documents[1][2] to take
advantage of it. Hopefully, this will make the next version of the book
even better than ever before.

Indexes are still not supported, but should be even easier to add.

[1]
Except pb-cred.html and pb-tour.html, which use footnotes for unfootnotish
stuff, and thus should be revamped by their author.

[2]
See! I told you we have footnote support



From ritterjoshua at msn.com  Wed Oct 23 01:14:04 2002
From: ritterjoshua at msn.com (Joshua Ritter)
Date: Wed, 23 Oct 2002 00:14:04 -0500
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
Message-ID: <000501c27a53$026ce380$0200000a@spunk>


First the stuff that makes sense:

---

Firebird doesn't like batched SQL statements in a single string any better
than MySQL does...

Also it doesn't like the Primary Key in dbcred's schema not being specified
as NOT NULL

In twisted_identities:

identity_name     varchar(64) NOT NULL PRIMARY KEY

In twisted_services:

service_name      varchar(64) NOT NULL PRIMARY KEY

---

Now for something weird...

Firebird chokes in CREATE TABLE twisted_identities on the password column...
by changing the name to identity_password it works?!?!?!?!?

-J








From dstone at kde.org  Wed Oct 23 03:05:12 2002
From: dstone at kde.org (Daniel Stone)
Date: Wed, 23 Oct 2002 17:05:12 +1000
Subject: [Twisted-Python] Documentation: Footnotes [Yay]
In-Reply-To: <20021023065612.16087.qmail@green.zadka.com>
References: <20021023065612.16087.qmail@green.zadka.com>
Message-ID: <20021023070512.GA24164@trinity.unimelb.edu.au>

On Wed, Oct 23, 2002 at 06:56:12AM -0000, Moshe Zadka scrawled:
> [1]
> Except pb-cred.html and pb-tour.html, which use footnotes for unfootnotish
> stuff, and thus should be revamped by their author.
> 
> [2]
> See! I told you we have footnote support

There are better formats[1]. Yours sucks.

-d

[1]: Like this. Newline, my arse.

-- 
Daniel Stone 	     <daniel at raging.dropbear.id.au>             <dstone at kde.org>
Developer - http://kopete.kde.org, http://www.kde.org
Proof BitMover are community-focussed:
http://marc.theaimsgroup.com/?l=linux-kernel&m=103384262016750&w=2
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021023/dfe0d574/attachment.pgp 

From bruce at cubik.org  Wed Oct 23 07:53:11 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 23 Oct 2002 05:53:11 -0600
Subject: [Twisted-Python] Error using mktap for ResourceTemplates
References: <20021023043441.GB11598@kenzoid.com> <20021023044402.14829.qmail@green.zadka.com>
Message-ID: <3DB68DA7.3000804@cubik.org>

Moshe Zadka wrote:
> On Wed, 23 Oct 2002 00:34:42 -0400, kkennedy at kenzoid.com (Ken Kennedy) wrote:
> 
>>I'm getting an error with both the 1.0.0-1 Debian package (congrats on
>>1.0, BTW!...and many, many thanks for the up-to-date debs.) and
>>current CVS when I try to use the mktap --processor flag suggested in
>>doc/howto/resource-templates.html
>>
>> mktap web --processor=.rtl=twisted.web.script.ResourceTemplate 
> 
> I do believe the man page tells you to supply a "--root" argument
> before the --processor argument.

It still shouldn't error.  I've filed a bug in the SF tracker for this.

Ken, thanks for reporting the bug!

  - Bruce




From glyph at twistedmatrix.com  Wed Oct 23 08:03:22 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 23 Oct 2002 07:03:22 -0500 (CDT)
Subject: [Twisted-Python] Error using mktap for ResourceTemplates
In-Reply-To: <3DB68DA7.3000804@cubik.org>
References: <20021023043441.GB11598@kenzoid.com>
	<20021023044402.14829.qmail@green.zadka.com>
	<3DB68DA7.3000804@cubik.org>
Message-ID: <20021023.070322.41191083.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 05:53:11 -0600, Bruce Mitchener <bruce at cubik.org> wrote:
> It still shouldn't error.  I've filed a bug in the SF tracker for this.

I just "fixed" this, using the existing idioms available used in mktap, but I
noticed 2 other problems while doing so.

 - currently the only idiom for reporting this sort of simple error is "print
   'foo'; sys.exit(2)".  This isn't really optimal, since we're hopefully going
   to be using twisted.tap through a non-commandline interface at some point,
   and the failure should be a formattable, self-contained exception.

 - the help message for almost every "tap" script is quite long, and so it's
   very easy to lose the default error reporting.  Perhaps it would be more
   useful in the common case to print exception/error information _after_ the
   help message, rather than before it, when there is a problem?

Thoughts?

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021023/d755d27a/attachment.pgp 

From glyph at twistedmatrix.com  Wed Oct 23 08:07:03 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 23 Oct 2002 07:07:03 -0500 (CDT)
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
In-Reply-To: <000501c27a53$026ce380$0200000a@spunk>
References: <000501c27a53$026ce380$0200000a@spunk>
Message-ID: <20021023.070703.112268121.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 00:14:04 -0500, "Joshua Ritter" <ritterjoshua at msn.com> wrote:
> Firebird chokes in CREATE TABLE twisted_identities on the password column...
> by changing the name to identity_password it works?!?!?!?!?

It's almost certainly wrong, but the first thing that occurs to me is:

    twistedidentities
    identitypassword
       ^   ^   ^   ^   ^
       4   8   12  16  18

twisted_identities has more than 16 alphanumeric characters in it, whereas
identity_password has exactly 16.  Is this a hard limit in firebird, by chance?
;-)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021023/fab489f5/attachment.pgp 

From john.abel at pa.press.net  Wed Oct 23 08:32:21 2002
From: john.abel at pa.press.net (John Abel)
Date: Wed, 23 Oct 2002 13:32:21 +0100
Subject: [Twisted-Python] Threading WIth Twisted
References: <20021023.070703.112268121.glyph@twistedmatrix.com>
Message-ID: <3DB696D5.2020103@pa.press.net>

Hi,

I am in the process of adding the option to compress logfiles, to 
twisted.python.logfile.  So that Twisted doesn't come to a standstill 
whilst compress a large file, I made the compress function run in a 
seperate thread.  However, if the file takes longer than a couple of 
seconds to compress, and rotate is called again, another thread is 
launched.  This thread, attempts to write to the same file as the 
initial thread.  I've had a look at the code, but I can't seem to find a 
provision within Twisted, to queue the threads.  Is there a way to do 
this, or, should I be looking at something else?

This only ever occurs, when the log rotation is set to occur very 
frequently, (i.e. every couple of seconds, or every 100 bytes), but I'd 
rather fix it, than impose limits on the frequency of log rotation.

Thanks

John




From twisted at itamarst.org  Wed Oct 23 10:21:54 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 23 Oct 2002 10:21:54 -0400
Subject: [Twisted-Python] Threading WIth Twisted
In-Reply-To: <3DB696D5.2020103@pa.press.net>
References: <20021023.070703.112268121.glyph@twistedmatrix.com>
	<3DB696D5.2020103@pa.press.net>
Message-ID: <20021023102154.6b4d3b9b.twisted@itamarst.org>

On Wed, 23 Oct 2002 13:32:21 +0100
John Abel <john.abel at pa.press.net> wrote:

> I am in the process of adding the option to compress logfiles, to 
> twisted.python.logfile.  So that Twisted doesn't come to a standstill 
> whilst compress a large file, I made the compress function run in a 
> seperate thread.  However, if the file takes longer than a couple of 
> seconds to compress, and rotate is called again, another thread is 
> launched.  This thread, attempts to write to the same file as the 
> initial thread.  I've had a look at the code, but I can't seem to find
> a provision within Twisted, to queue the threads.  Is there a way to
> do this, or, should I be looking at something else?

Set a flag "compressionInProgress".

If it is set, just remember you need to compress. When the thread
finishes it should call a callback (via reactor.callFromThread, or use
threads.deferToThread) and that callback will start up a new
compression.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From glyph at twistedmatrix.com  Wed Oct 23 10:25:01 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 23 Oct 2002 09:25:01 -0500 (CDT)
Subject: [Twisted-Python] Threading WIth Twisted
In-Reply-To: <3DB696D5.2020103@pa.press.net>
References: <20021023.070703.112268121.glyph@twistedmatrix.com>
	<3DB696D5.2020103@pa.press.net>
Message-ID: <20021023.092501.93026396.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 13:32:21 +0100, John Abel <john.abel at pa.press.net> wrote:

> So that Twisted doesn't come to a standstill whilst compress a large file, I
> made the compress function run in a seperate thread.

> This thread, attempts to write to the same file as the initial thread.

Why are two separate compression attempts writing to the same file?  Shouldn't
the file be named something along the lines of twistd.{1,2,3,4,...}.log.gz?

> I've had a look at the code, but I can't seem to find a provision within
> Twisted, to queue the threads.  Is there a way to do this, or, should I be
> looking at something else?

Yes, there is a way to do this.  Twisted provides utilities to have threads
interact with its mainloop, but it does not provide a full threading model:
that's Python's job.  Take a look at the "threading" and "Queue" modules in the
standard library.

> This only ever occurs, when the log rotation is set to occur very frequently,
> (i.e. every couple of seconds, or every 100 bytes), but I'd rather fix it,
> than impose limits on the frequency of log rotation.

Yeah, and it's because of problems like this that we try to steer clear of
threads in general in Twisted ;-).  Have you considered the block-at-a-time
approach that radix suggested?  That way you wouldn't need to run threads at
all...

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021023/dbcc504c/attachment.pgp 

From sean at twistedmatrix.com  Wed Oct 23 13:01:43 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Wed, 23 Oct 2002 12:01:43 -0500
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
In-Reply-To: <000501c27a53$026ce380$0200000a@spunk>
Message-ID: <HOEEKPCOKELHCNIJNMAGMEIJCHAA.sean@twistedmatrix.com>

that is odd.. I did do some tests with Firebird with enterprise and row, but
have since uninstalled it :(

I would guess that "password" is a key word in Firebird's SQL dialect. Maybe
we should change that column name to something less likely to cause that
kind of conflict.

-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Joshua
Ritter
Sent: Wednesday, October 23, 2002 12:14 AM
To: twisted-python at twistedmatrix.com
Subject: [Twisted-Python] dbcred and Firebird Incompatibility




First the stuff that makes sense:

---

Firebird doesn't like batched SQL statements in a single string any better
than MySQL does...

Also it doesn't like the Primary Key in dbcred's schema not being specified
as NOT NULL

In twisted_identities:

identity_name     varchar(64) NOT NULL PRIMARY KEY

In twisted_services:

service_name      varchar(64) NOT NULL PRIMARY KEY

---

Now for something weird...

Firebird chokes in CREATE TABLE twisted_identities on the password column...
by changing the name to identity_password it works?!?!?!?!?

-J






_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From developer at csrules.dyndns.org  Wed Oct 23 15:27:17 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Wed, 23 Oct 2002 14:27:17 -0500 (CDT)
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
In-Reply-To: <HOEEKPCOKELHCNIJNMAGMEIJCHAA.sean@twistedmatrix.com>
References: <000501c27a53$026ce380$0200000a@spunk>
        <HOEEKPCOKELHCNIJNMAGMEIJCHAA.sean@twistedmatrix.com>
Message-ID: <10923.209.5.243.3.1035401237.squirrel@seraphine.csrules.dyndns.org>

PASSWORD is a reserved word in interbase and by extension probably
firebird but not in SQL 92.

ref:
http://ibphoenix.com/main.nfs?a=ibphoenix&page=ibp_reserved

regards,
Darryl




> that is odd.. I did do some tests with Firebird with enterprise and row,
> but have since uninstalled it :(
>
> I would guess that "password" is a key word in Firebird's SQL dialect.
> Maybe we should change that column name to something less likely to
> cause that kind of conflict.
>
> -----Original Message-----
> From: twisted-python-admin at twistedmatrix.com
> [mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Joshua
> Ritter
> Sent: Wednesday, October 23, 2002 12:14 AM
> To: twisted-python at twistedmatrix.com
> Subject: [Twisted-Python] dbcred and Firebird Incompatibility
>
>
>
>
> First the stuff that makes sense:
>
> ---
>
> Firebird doesn't like batched SQL statements in a single string any
> better than MySQL does...
>
> Also it doesn't like the Primary Key in dbcred's schema not being
> specified as NOT NULL
>
> In twisted_identities:
>
> identity_name     varchar(64) NOT NULL PRIMARY KEY
>
> In twisted_services:
>
> service_name      varchar(64) NOT NULL PRIMARY KEY
>
> ---
>
> Now for something weird...
>
> Firebird chokes in CREATE TABLE twisted_identities on the password
> column... by changing the name to identity_password it works?!?!?!?!?
>
> -J
>
>
>
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python






From ritterjoshua at msn.com  Wed Oct 23 11:06:58 2002
From: ritterjoshua at msn.com (Joshua Ritter)
Date: Wed, 23 Oct 2002 10:06:58 -0500
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
Message-ID: <003101c27aa5$d57ae9f0$0200000a@spunk>

"password" and "user" are Firebird/Interbase keyword/variables... neither will work as a column name... for instance, you also can't have a column named "file", "default","starting", "length", etc etc etc.

This is pretty enough for me:

identity_name
identity_password

I wonder what other landmines await...

-J

----------------------------------------------------

>> Firebird chokes in CREATE TABLE twisted_identities on the password column...
>> by changing the name to identity_password it works?!?!?!?!?

>It's almost certainly wrong, but the first thing that occurs to me is:

>    twistedidentities
>    identitypassword
>       ^   ^   ^   ^   ^
>       4   8   12  16  18

>twisted_identities has more than 16 alphanumeric characters in it, whereas
>identity_password has exactly 16.  Is this a hard limit in firebird, by chance?
>;-)

>-- 
> |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
> |   < _/ >   |  Lead Developer,  the Twisted project  |
> |  < ___/ >  |      http://www.twistedmatrix.com      |


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20021023/e218e433/attachment.htm 

From mongo57a at comcast.net  Wed Oct 23 21:08:24 2002
From: mongo57a at comcast.net (andy surany)
Date: Wed, 23 Oct 2002 21:08:24 -0400
Subject: [Twisted-Python] Fw: [Tutor] Interfacing to the web
Message-ID: <00d401c27af9$db4e91c0$2502a8c0@emily.ewndsr01.nj.comcast.net>

Hi all!

It was suggested in Tutor that Twisted might be what I'm looking for (please
see the thread below). The best bet appears to be a proxy to which I can add
some intercept logic. Anybody done this with Twisted?

TIA

-Andy

-----Original Message-----
From: andy surany <mongo57a at comcast.net>
To: Magnus Lycka <magnus at thinkware.se>; tutor at python.org <tutor at python.org>
Date: Wednesday, October 23, 2002 5:44 PM
Subject: Re: [Tutor] Interfacing to the web


From the responses I have received, it sounds like a proxy is the best bet.
However, my application is meant to run on Linux, Windows, and Mac
platforms, so that may rule out some software (it looks like squid is for
linux only????, and privoxy does not allow code extensions).

So I will search for a good proxy. Anyone write a good one????? Or know of
one?(given the above caveats...).

TIA
-Andy


-----Original Message-----
From: Magnus Lycka <magnus at thinkware.se>
To: andy surany <mongo57a at comcast.net>; tutor at python.org <tutor at python.org>
Date: Wednesday, October 23, 2002 5:20 PM
Subject: Re: [Tutor] Interfacing to the web


At 13:03 2002-10-23 -0400, andy surany wrote:
>Hi All!
>
>Here is what I need to accomplish:
>
>     From a python program, I need to launch a browser. The user then uses
> the browser to interact with the web site. However, the python program
> must continually monitor the data from the web site to capture specific
> data elements.
>
>     Unfortunately, I can't point the program to the specific URL as there
> is a significant and secure (cookies, etc.) exchange that must occur in
> order to reach the page.

I see two reasonable ways to go about this.

One is to use a web proxy that acts as a man-in-the-middle.
I'm not aware of any python proxies though, but maybe it's
possible tobuild plugins for some proxies? Something along
the line of privoxy (www.privoxy.org) or squid
(www.squid-cache.org) might be useful??? See
http://www.squid-cache.org/related-software.html

Another option could be to build a custom web browser.
If you use wxPython, there is a HTML window component
that could be useful. If you are in MS Windows, you
could also plug into Internet Explorer or at least
use parts of it. See the wxPython demo.


--
Magnus Lyck?, Thinkware AB
?lvans v?g 99, SE-907 50 UME?
tel: 070-582 80 65, fax: 070-612 80 65
http://www.thinkware.se/  mailto:magnus at thinkware.se




_______________________________________________
Tutor maillist  -  Tutor at python.org
http://mail.python.org/mailman/listinfo/tutor





From twisted at itamarst.org  Wed Oct 23 20:44:32 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 23 Oct 2002 20:44:32 -0400
Subject: [Twisted-Python] UDP Support
Message-ID: <20021023204432.7976263c.twisted@itamarst.org>

I intend to totally refactor UDP tonight. Do I need to bother with
backwards compatability, or is nobody using it?

There's been a big "this is not a stable API" docstring on it for a
while...

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From joe at swelltech.com  Wed Oct 23 21:13:10 2002
From: joe at swelltech.com (Joe Cooper)
Date: Wed, 23 Oct 2002 20:13:10 -0500
Subject: [Twisted-Python] Fw: [Tutor] Interfacing to the web
References: <00d401c27af9$db4e91c0$2502a8c0@emily.ewndsr01.nj.comcast.net>
Message-ID: <3DB74926.5090805@swelltech.com>

Just to interject a correction to the below bit about Squid.  Windows is 
an officially supported platform, with at least two active maintainers.

Squid runs natively as a service on Windows NT when compiled with MS 
compilers and under Cygwin built with GCC.  The MinGW port is reportedly 
going well, though incomplete right now.  It has also been reported to 
compile (with effort) under Mac OS X.  It is also likely to become a 
supported platform if someone will step forward to take responsibility 
for keeping an eye on new versions to insure they build and run.  Squid 
also runs on most reasonably current Unices with GCC and GNU make, as 
well as most modern platforms with vendor-supplied compilers (though GNU 
make is probably still required in most cases).

andy surany wrote:
> Hi all!
> 
> It was suggested in Tutor that Twisted might be what I'm looking for (please
> see the thread below). The best bet appears to be a proxy to which I can add
> some intercept logic. Anybody done this with Twisted?
> 
> TIA
> 
> -Andy
> 
> -----Original Message-----
> From: andy surany <mongo57a at comcast.net>
> To: Magnus Lycka <magnus at thinkware.se>; tutor at python.org <tutor at python.org>
> Date: Wednesday, October 23, 2002 5:44 PM
> Subject: Re: [Tutor] Interfacing to the web
> 
> 
> From the responses I have received, it sounds like a proxy is the best bet.
> However, my application is meant to run on Linux, Windows, and Mac
> platforms, so that may rule out some software (it looks like squid is for
> linux only????, and privoxy does not allow code extensions).
> 
> So I will search for a good proxy. Anyone write a good one????? Or know of
> one?(given the above caveats...).


-- 
Joe Cooper <joe at swelltech.com>
Web caching appliances and support.
http://www.swelltech.com




From andrew-twisted at puzzling.org  Wed Oct 23 21:15:33 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 24 Oct 2002 11:15:33 +1000
Subject: [Twisted-Python] Freshmeat
Message-ID: <20021024011533.GD16479@ritsuko.xware.cx>

I note that the Twisted project info at Freshmeat is up-to-date with
respect to version numbers:
    http://freshmeat.net/projects/twisted/?topic_id=22%2C28%2C86%2C92%2C250

But it probably should have this bit updated:
    "Development Status :: 4 - Beta"

-Andrew.




From twisted at itamarst.org  Wed Oct 23 21:25:32 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 23 Oct 2002 21:25:32 -0400
Subject: [Twisted-Python] Fw: [Tutor] Interfacing to the web
In-Reply-To: <00d401c27af9$db4e91c0$2502a8c0@emily.ewndsr01.nj.comcast.net>
References: <00d401c27af9$db4e91c0$2502a8c0@emily.ewndsr01.nj.comcast.net>
Message-ID: <20021023212532.6a0114fd.twisted@itamarst.org>

On Wed, 23 Oct 2002 21:08:24 -0400
andy surany <mongo57a at comcast.net> wrote:

> It was suggested in Tutor that Twisted might be what I'm looking for
> (please see the thread below). The best bet appears to be a proxy to
> which I can add some intercept logic. Anybody done this with Twisted?

You could make a transparent proxy with Twisted, yes, since it has both
http client and server classes. There's a module twisted.web.proxy that
does that.

Might not work without some munging of the returned HTML, however.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From mongo57a at comcast.net  Wed Oct 23 23:11:26 2002
From: mongo57a at comcast.net (andy surany)
Date: Wed, 23 Oct 2002 23:11:26 -0400
Subject: [Twisted-Python] Fw: [Tutor] Interfacing to the web
Message-ID: <00ed01c27b0b$0aca9320$2502a8c0@emily.ewndsr01.nj.comcast.net>

Thanks. It looks like the basic building blocks are there - but I don't know
enough about how a proxy works to be able to make one (if I can avoid it).
All I really need to do is to be able to hook into the date stream, tagging
on one specific URL which I can then parse to get the data into my python
program. Unfortunately, I can't access the URL directly (cookies, etc.).

Or have i misunderstood twisted.web.proxy? The only docs I found were at
http://twistedmatrix.com/users/jh/teud/Twisted/twisted.web.proxy.html

Andy
-----Original Message-----
From: Itamar Shtull-Trauring <twisted at itamarst.org>
To: twisted-python at twistedmatrix.com <twisted-python at twistedmatrix.com>
Cc: mongo57a at comcast.net <mongo57a at comcast.net>
Date: Wednesday, October 23, 2002 9:29 PM
Subject: Re: [Twisted-Python] Fw: [Tutor] Interfacing to the web


>On Wed, 23 Oct 2002 21:08:24 -0400
>andy surany <mongo57a at comcast.net> wrote:
>
>> It was suggested in Tutor that Twisted might be what I'm looking for
>> (please see the thread below). The best bet appears to be a proxy to
>> which I can add some intercept logic. Anybody done this with Twisted?
>
>You could make a transparent proxy with Twisted, yes, since it has both
>http client and server classes. There's a module twisted.web.proxy that
>does that.
>
>Might not work without some munging of the returned HTML, however.
>
>--
>Itamar Shtull-Trauring    http://itamarst.org/
>Available for Python, Twisted, Zope and Java consulting
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From kkennedy at kenzoid.com  Wed Oct 23 22:30:55 2002
From: kkennedy at kenzoid.com (Ken Kennedy)
Date: Wed, 23 Oct 2002 22:30:55 -0400
Subject: [Twisted-Python] Logo usage at websites?
Message-ID: <20021024023054.GA7029@kenzoid.com>

Couldn't find any info at the site, CVS, or my saved list
msgs...is there an official logo that's available for use by
sites running Twisted? I'm poking about in the images dir at
twistedmatrix.com; images/TwistedLogo.png looks good, and it's only
2086 bytes. 

I'm looking forward to sticking a "Powered by Twisted" logo in my
footers...*grin*. 


-- 

Ken Kennedy	| http://www.kenzoid.com	| kenzoid at io.com



From glyph at twistedmatrix.com  Wed Oct 23 23:20:42 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 23 Oct 2002 22:20:42 -0500 (CDT)
Subject: [Twisted-Python] Logo usage at websites?
In-Reply-To: <20021024023054.GA7029@kenzoid.com>
References: <20021024023054.GA7029@kenzoid.com>
Message-ID: <20021023.222042.07645503.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 22:30:55 -0400, kkennedy at kenzoid.com (Ken Kennedy) wrote:

> I'm looking forward to sticking a "Powered by Twisted" logo in my
> footers...*grin*.

Maybe it would be more appropriate to have a logo that said "Twisted by Power",
with a little graphic of the Eye of Sauron staring out of our serpentine logo?
"Surely, you did not think that Guido could contend with the will of Internet.
There are none who can."

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021023/d044d90d/attachment.pgp 

From developer at csrules.dyndns.org  Wed Oct 23 23:30:18 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Wed, 23 Oct 2002 22:30:18 -0500 (CDT)
Subject: [Twisted-Python] Pynfo
In-Reply-To: <20021023.222042.07645503.glyph@twistedmatrix.com>
References: <20021024023054.GA7029@kenzoid.com>
        <20021023.222042.07645503.glyph@twistedmatrix.com>
Message-ID: <3086.192.168.2.20.1035430218.squirrel@seraphine.csrules.dyndns.org>

Dont really know where to broach this but:

I've been looking at the code for pynfo and there's some functionality
i'd like to wedge in there i.e. logging to a database (for example) but
i'd like to be able to do it without affecting the main code. Is there a
reasonable way to create an external plugin that could be inserted at
runtime?








From kkennedy at kenzoid.com  Thu Oct 24 00:03:06 2002
From: kkennedy at kenzoid.com (Ken Kennedy)
Date: Thu, 24 Oct 2002 00:03:06 -0400
Subject: [Twisted-Python] Logo usage at websites?
In-Reply-To: <20021023.222042.07645503.glyph@twistedmatrix.com>
References: <20021024023054.GA7029@kenzoid.com> <20021023.222042.07645503.glyph@twistedmatrix.com>
Message-ID: <20021024040306.GH7029@kenzoid.com>

On Wed, Oct 23, 2002 at 10:20:42PM -0500, Glyph Lefkowitz wrote:
> On Wed, 23 Oct 2002 22:30:55 -0400, kkennedy at kenzoid.com (Ken Kennedy) wrote:
> 
> > I'm looking forward to sticking a "Powered by Twisted" logo in my
> > footers...*grin*.
> 
> Maybe it would be more appropriate to have a logo that said "Twisted by Power",
> with a little graphic of the Eye of Sauron staring out of our serpentine logo?
> "Surely, you did not think that Guido could contend with the will of Internet.
> There are none who can."

That's cracking me up. I'm almost ready to whip out the GIMP and start
on it...

-- 

Ken Kennedy	| http://www.kenzoid.com	| kenzoid at io.com



From glyph at twistedmatrix.com  Thu Oct 24 10:08:26 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 24 Oct 2002 09:08:26 -0500 (CDT)
Subject: [Twisted-Python] UDP Support
In-Reply-To: <20021023204432.7976263c.twisted@itamarst.org>
References: <20021023204432.7976263c.twisted@itamarst.org>
Message-ID: <20021024.090826.93209099.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 20:44:32 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:
> I intend to totally refactor UDP tonight. Do I need to bother with
> backwards compatability, or is nobody using it?

The only code that I'm aware of anywhere that's using it is the DNS code, which
is probably just going to want a thin backwards-compatibility layer anyway.  I
don't think it's doing anything particularly idiomatic to UDP.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021024/a78bcbf3/attachment.pgp 

From developer at csrules.dyndns.org  Thu Oct 24 11:28:01 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Thu, 24 Oct 2002 10:28:01 -0500 (CDT)
Subject: [Twisted-Python] Freshmeat
In-Reply-To: <20021024011533.GD16479@ritsuko.xware.cx>
References: <20021024011533.GD16479@ritsuko.xware.cx>
Message-ID: <5881.209.5.243.3.1035473281.squirrel@seraphine.csrules.dyndns.org>

I dont' know how actively you guys update sourceforget but:

http://sourceforge.net/projects/twisted  <-- still has 0.99.2 as latest
file release.



> I note that the Twisted project info at Freshmeat is up-to-date with
> respect to version numbers:
>     http://freshmeat.net/projects/twisted/?topic_id=22%2C28%2C86%2C92%2C250
>
> But it probably should have this bit updated:
>     "Development Status :: 4 - Beta"
>
> -Andrew.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python






From twisted at moshez.org  Thu Oct 24 12:04:04 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 24 Oct 2002 16:04:04 -0000
Subject: [Twisted-Python] Freshmeat
In-Reply-To: <5881.209.5.243.3.1035473281.squirrel@seraphine.csrules.dyndns.org>
References: <5881.209.5.243.3.1035473281.squirrel@seraphine.csrules.dyndns.org>, <20021024011533.GD16479@ritsuko.xware.cx>
Message-ID: <20021024160404.6216.qmail@green.zadka.com>

On Thu, 24 Oct 2002, "Maniac -" <developer at csrules.dyndns.org> wrote:

> I dont' know how actively you guys update sourceforget but:
> 
> http://sourceforge.net/projects/twisted  <-- still has 0.99.2 as latest
> file release.

Look at twisted.sf.net
We stopped using the file release mechanism because it sucks



From developer at csrules.dyndns.org  Thu Oct 24 12:18:11 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Thu, 24 Oct 2002 11:18:11 -0500 (CDT)
Subject: [Twisted-Python] Freshmeat
In-Reply-To: <20021024160404.6216.qmail@green.zadka.com>
References: <20021024011533.GD16479@ritsuko.xware.cx>
        <20021024160404.6216.qmail@green.zadka.com>
Message-ID: <7480.209.5.243.3.1035476291.squirrel@seraphine.csrules.dyndns.org>

Oh, well if you pull up the 'project' page on SF looks like you guys
haven't released since 0.99.2

/me will keep his mouth shut

> On Thu, 24 Oct 2002, "Maniac -" <developer at csrules.dyndns.org> wrote:
>
>> I dont' know how actively you guys update sourceforget but:
>>
>> http://sourceforge.net/projects/twisted  <-- still has 0.99.2 as
>> latest file release.
>
> Look at twisted.sf.net
> We stopped using the file release mechanism because it sucks
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python






From twisted at moshez.org  Thu Oct 24 13:54:56 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 24 Oct 2002 17:54:56 -0000
Subject: [Twisted-Python] Freshmeat
In-Reply-To: <7480.209.5.243.3.1035476291.squirrel@seraphine.csrules.dyndns.org>
References: <7480.209.5.243.3.1035476291.squirrel@seraphine.csrules.dyndns.org>, <20021024011533.GD16479@ritsuko.xware.cx>
        <20021024160404.6216.qmail@green.zadka.com>
Message-ID: <20021024175456.7491.qmail@green.zadka.com>

On Thu, 24 Oct 2002, "Maniac -" <developer at csrules.dyndns.org> wrote:

> Oh, well if you pull up the 'project' page on SF looks like you guys
> haven't released since 0.99.2

You're right. Can one of the sf Twisted admins disable the file release
feature?



From andrew-twisted at puzzling.org  Thu Oct 24 20:44:16 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 25 Oct 2002 10:44:16 +1000
Subject: [Twisted-Python] Re: [Twisted-commits] If we use use non-standard packages, we make sure they are avilaable on pyr
In-Reply-To: <E184k7m-0004rj-00@pyramid.twistedmatrix.com>
References: <E184k7m-0004rj-00@pyramid.twistedmatrix.com>
Message-ID: <20021025004416.GA4208@ritsuko.xware.cx>

On Thu, Oct 24, 2002 at 10:42:18AM -0500, moshez CVS wrote:
> Modified files:
> Twisted/admin/book.tex 1.5 1.6
> 
> Log message:
> If we use use non-standard packages, we make sure they are avilaable on pyr

[..snip..]

> -\usepackage{times,mathptmx}
> +%\usepackage{times,mathptmx}

Installing the tetex-extra package should make this work... can that be
arranged?  Those packages are the magic necessary for making pdfs that
are readable in Win32 Acrobat.

-Andrew.




From radix at twistedmatrix.com  Thu Oct 24 21:34:02 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Fri, 25 Oct 2002 03:34:02 +0200
Subject: [Twisted-Python] Re: [Twisted-commits] If we use use non-standard packages, we make sure they are avilaable on pyr
In-Reply-To: <20021025004416.GA4208@ritsuko.xware.cx>
References: <E184k7m-0004rj-00@pyramid.twistedmatrix.com> <20021025004416.GA4208@ritsuko.xware.cx>
Message-ID: <20021025013402.GC631@twistedmatrix.com>

On Fri, Oct 25, 2002 at 10:44:16AM +1000, Andrew Bennetts wrote:
> Installing the tetex-extra package should make this work... 

Done.


-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From waterbug at beeblebrox.gsfc.nasa.gov  Thu Oct 24 23:57:19 2002
From: waterbug at beeblebrox.gsfc.nasa.gov (Steve Waterbury)
Date: Thu, 24 Oct 2002 23:57:19 -0400
Subject: [Twisted-Python] Glossary entry for Twisted Book
Message-ID: <3DB8C11F.64650678@beeblebrox.gsfc.nasa.gov>

Reading the entry for "PSU", I was reminded of a one of 
my favorite Marx Brothers lines, which might be appropriate 
here (I once included it in my position description ... it 
was definitely appropriate there ;^):

Sanity Clause:
    Everybody knows there's no Sanity Clause.  

Cheers,
-- Steve.



From carball at hush.com  Fri Oct 25 02:12:22 2002
From: carball at hush.com (carball at hush.com)
Date: Thu, 24 Oct 2002 23:12:22 -0700
Subject: [Twisted-Python] grokking Cacheable
Message-ID: <200210250612.g9P6CNfm082033@mailserver4.hushmail.com>

attempting to grok Cacheable here. .
was wondering if someone could show a quick example of its correct use?
-----------------------------
attached is what i have so far, just to test. .
i am getting this error when the observer is being serialized?
-----------------------------------------
24/10/2002 09:17 [Broker,0,127.0.0.1] twisted.spread.jelly.InsecureJelly: Class not allowed for instance: twisted.spread.flavors.RemoteCacheObserver <RemoteCacheObserver(<twisted.spread.pb.Broker instance at 0x83ab0f4>, <mon.net.rop.Cashew instance at 0x838b5a4>, <mon_server.rop_myApp.Persp instance at 0x83834d4>) at 138104980>
-------------------------------
i havent seen any example code in the list, docs, or examples dir
about this dark corner of the pb universe, so i thought i'd ask
------------
any elucidation is quite appreciated
thanks
car 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rop.py
Type: application/octet-stream
Size: 501 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021024/793e9220/attachment.obj 

From twisted at moshez.org  Fri Oct 25 04:02:51 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 25 Oct 2002 08:02:51 -0000
Subject: [Twisted-Python] Twisted: We Reinvent NIH
Message-ID: <20021025080251.15905.qmail@green.zadka.com>

Those of you dilligently watching the commits lists already know
this, but for those heretics among you who don't, let me sum up

-- After a death sentence pronouncement on PyFontify by python-dev, twisted
   has its own Python HTML colourer in twisted.python.htmlizer
-- The document generation system is now part of twisted, as twisted.lore.
   People who want to use it for documenting their own Python stuff are
   invited to.



From nbm at mithrandr.moria.org  Fri Oct 25 05:04:13 2002
From: nbm at mithrandr.moria.org (Neil Blakey-Milner)
Date: Fri, 25 Oct 2002 11:04:13 +0200
Subject: [Twisted-Python] DNSServerBoss.getAnswers with non-authoritative requests
Message-ID: <20021025090413.GC28466@mithrandr.moria.org>

Hi,

Since I've just guessed how the DNS Server stuff works in twisted, I may
be doing something stupid.

Example program:

from twisted.protocols import dns
from twisted.names.dns import DNSServerBoss, DNSServerFactory, SimpleDomain
from twisted.internet import reactor

a = DNSServerFactory()
s = SimpleDomain("example.net", "192.168.8.26")
a.boss.addDomain("example.net", s)
a.boss.createBothFactories()
a.boss.startListeningBoth(53)
reactor.run()


This works great for example.net:

(nbm at pike) /home/nbm> host example.net 127.0.0.1
Using domain server 127.0.0.1:
example.net has address 192.168.8.26
example.net mail is handled (pri=5) by example.net

This works non-great for other domains - it just sits there, slowly
timing out for each query made (due to 'search' or 'domain' in
resolv.conf).

Traceback makes it obvious where the problem is:

  File "/usr/local/lib/python2.2/site-packages/twisted/names/dns.py",
line 370, in getAnswers
    name = string.split(name, '.', 1)[1]
exceptions.IndexError: list index out of range

Ok, that's easy, and that's the first patch
(twisted.names.dns.py-noerror.patch).

Once applied, it still doesn't quite work:

(nbm at pike) /home/nbm> host example.org 127.0.0.1
Using domain server 127.0.0.1:
There is an entry for this host, but it doesn't have a Mail Exchanger record.

Second patch (no idea if this is what DNS is supposed to do) makes that
more like I expect it to return:

(nbm at pike) /home/nbm> host example.org 127.0.0.1
Using domain server 127.0.0.1:
Host not found.

I'll probably look into what is the correct response, but not soon.  I'm
not sure how the multiple-queries bit factors into it either.

Neil
-- 
Neil Blakey-Milner
nbm at mithrandr.moria.org
-------------- next part --------------
Index: dns.py
===================================================================
RCS file: /cvs/Twisted/twisted/names/dns.py,v
retrieving revision 1.37
diff -u -r1.37 dns.py
--- dns.py	2 Oct 2002 05:55:19 -0000	1.37
+++ dns.py	25 Oct 2002 08:43:15 -0000
@@ -367,7 +367,10 @@
                 continue # internet
             name = query.name.name
             while name and not self.domains.has_key(name):
-                name = string.split(name, '.', 1)[1]
+                try:
+                    name = string.split(name, '.', 1)[1]
+                except IndexError:
+                    name = None
             if not name:
                 continue
             self.domains[name].getAnswers(message, query.name.name, query.type)
-------------- next part --------------
Index: dns.py
===================================================================
RCS file: /cvs/Twisted/twisted/names/dns.py,v
retrieving revision 1.37
diff -u -r1.37 dns.py
--- dns.py	2 Oct 2002 05:55:19 -0000	1.37
+++ dns.py	25 Oct 2002 08:47:01 -0000
@@ -367,8 +367,12 @@
                 continue # internet
             name = query.name.name
             while name and not self.domains.has_key(name):
-                name = string.split(name, '.', 1)[1]
+                try:
+                    name = string.split(name, '.', 1)[1]
+                except IndexError:
+                    name = None
             if not name:
+                message.rCode = dns.ENAME
                 continue
             self.domains[name].getAnswers(message, query.name.name, query.type)
         protocol.writeMessage(message)

From jk at xylema.org  Fri Oct 25 09:13:20 2002
From: jk at xylema.org (John Kozak)
Date: Fri, 25 Oct 2002 14:13:20 +0100
Subject: [Twisted-Python] reactor installation
Message-ID: <15801.17264.372137.725109@gargle.gargle.HOWL>

I have a program which uses Qt and glues to Twisted via qtreactor.  As
of 1.0.0 (ish - worked with most of the 0.99s), it no longer
initialises, bleating that a reactor is already loaded.  The structure
of this program is mildly eccentric: as part of my "explore UIs in
Python" activity it was intended to have pluggable UIs in wx and Qt
(actual experience of wx dissuaded me of this), and so it perhaps
initialises the reactor rather later in the game than usual.  Is there
a way I can take control over, or at least debug, reactor init?






From twisted at itamarst.org  Fri Oct 25 09:47:59 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 25 Oct 2002 09:47:59 -0400
Subject: [Twisted-Python] reactor installation
In-Reply-To: <15801.17264.372137.725109@gargle.gargle.HOWL>
References: <15801.17264.372137.725109@gargle.gargle.HOWL>
Message-ID: <20021025094759.3445c1b3.twisted@itamarst.org>

On Fri, 25 Oct 2002 14:13:20 +0100
"John Kozak" <jk at xylema.org> wrote:

> I have a program which uses Qt and glues to Twisted via qtreactor.  As
> of 1.0.0 (ish - worked with most of the 0.99s), it no longer
> initialises, bleating that a reactor is already loaded.  The structure
> of this program is mildly eccentric: as part of my "explore UIs in
> Python" activity it was intended to have pluggable UIs in wx and Qt
> (actual experience of wx dissuaded me of this), and so it perhaps
> initialises the reactor rather later in the game than usual.  Is there
> a way I can take control over, or at least debug, reactor init?

Here's the rule - installing a reactor should always be the *first*
thing you do, and I do mean first. Importing other stuff before you
install the reactor can break your code.

wxPython support, as it does not install a new reactor, can be done at
any point, IIRC.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From sean at twistedmatrix.com  Fri Oct 25 11:06:50 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Fri, 25 Oct 2002 10:06:50 -0500
Subject: [Twisted-Python] grokking Cacheable
In-Reply-To: <200210250612.g9P6CNfm082033@mailserver4.hushmail.com>
Message-ID: <HOEEKPCOKELHCNIJNMAGAEJGCHAA.sean@twistedmatrix.com>

that particular error means that the server class 'mon.net.rop.Cashew' has
no registered copier on the client. You need to call pb.setCopierForClass on
the client like:

from twisted.spread import pb

class YourClientClass(pb.RemoteCache):
    pass

pb.setCopierForClass('mon.net.rop.Cashew', YourClientClass)

and instances of mon.net.rop.Cashew will be transformed into YourClientClass
when they arrive at the client. YourClientClass must be derived from
pb.RemoteCache.

This appears to be one the most common errors when programming with
Cacheables as it occurs not only when you forget to designate a copier, but
when an unexpected server object tried to get sent to the client because of
a reference of assignment you werent aware of. This is a good security
measure :)

-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of
carball at hush.com
Sent: Friday, October 25, 2002 1:12 AM
To: Twisted-Python at twistedmatrix.com
Subject: [Twisted-Python] grokking Cacheable


attempting to grok Cacheable here. .
was wondering if someone could show a quick example of its correct use?
-----------------------------
attached is what i have so far, just to test. .
i am getting this error when the observer is being serialized?
-----------------------------------------
24/10/2002 09:17 [Broker,0,127.0.0.1] twisted.spread.jelly.InsecureJelly:
Class not allowed for instance: twisted.spread.flavors.RemoteCacheObserver
<RemoteCacheObserver(<twisted.spread.pb.Broker instance at 0x83ab0f4>,
<mon.net.rop.Cashew instance at 0x838b5a4>, <mon_server.rop_myApp.Persp
instance at 0x83834d4>) at 138104980>
-------------------------------
i havent seen any example code in the list, docs, or examples dir
about this dark corner of the pb universe, so i thought i'd ask
------------
any elucidation is quite appreciated
thanks
car




From bruce at cubik.org  Fri Oct 25 11:16:08 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Fri, 25 Oct 2002 09:16:08 -0600
Subject: [Twisted-Python] grokking Cacheable
References: <HOEEKPCOKELHCNIJNMAGAEJGCHAA.sean@twistedmatrix.com>
Message-ID: <3DB96038.7010402@cubik.org>

Sean Riley wrote:
> This appears to be one the most common errors when programming with
> Cacheables as it occurs not only when you forget to designate a copier, but
> when an unexpected server object tried to get sent to the client because of
> a reference of assignment you werent aware of. This is a good security
> measure :)

That's why I tend to not use the default implementation of 
getStateToCacheAndObserveFor and now explicitly list out which 
attributes I want to transmit.  (Although in some cases, I'm also 
transforming the data into a different format for the client-side 
representation as well.)

  - Bruce




From gustav at morpheus.demon.co.uk  Wed Oct 23 17:11:15 2002
From: gustav at morpheus.demon.co.uk (Paul Moore)
Date: Wed, 23 Oct 2002 22:11:15 +0100
Subject: [Twisted-Python] Some comments on twisted.news
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk> <20021022192113.GL12550@twistedmatrix.com>
Message-ID: <n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> On Tue, Oct 22, 2002 at 06:49:09PM +0100, Paul Moore wrote:
>> (2) is obviously fairly trivial. I think I could implement (3) and
>> (4), if it would be useful. I could submit a patch, which would alter
>> the server code and the 2 existing backends (I couldn't test the
>> database backend, as I don't have a database to test with, but I could
>> test the pickle-based code). Would this be helpful? Are there likely
>> to be 3rd party nntp backends which would be broken by such a change?
>
> There certainly aren't any 3rd party backends yet, twisted.news is
> still fairly new (and doesn't have any users, afaik, although some may
> be lurking). I'd recommend implementing everything and waiting for
> exarkun's approval (He may be a while, as he's visiting Minnesota
> atm), but I really doubt he'll have any problems with it.

OK, I'll see what I can do. What's the best procedure for submitting a
patch? Can I post patches to this list?

Paul.

-- 
This signature intentionally left blank



From glyph at twistedmatrix.com  Fri Oct 25 17:35:55 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 25 Oct 2002 16:35:55 -0500 (CDT)
Subject: [Twisted-Python] grokking Cacheable
In-Reply-To: <3DB96038.7010402@cubik.org>
References: <HOEEKPCOKELHCNIJNMAGAEJGCHAA.sean@twistedmatrix.com>
	<3DB96038.7010402@cubik.org>
Message-ID: <20021025.163555.59467324.glyph@twistedmatrix.com>


On Fri, 25 Oct 2002 09:16:08 -0600, Bruce Mitchener <bruce at cubik.org> wrote:

> That's why I tend to not use the default implementation of
> getStateToCacheAndObserveFor and now explicitly list out which attributes I
> want to transmit.  (Although in some cases, I'm also transforming the data
> into a different format for the client-side representation as well.)

Just thought I'd chime in and explain why this is an especially good idea ;-).

For both Copyables and Cacheables, it's good to be nice and explicit about what
you want sent vs. what you don't; so not accepting the default is definitely a
good idea.  By transforming the data for client-side representation you not
only save potentially unnecessary space and prevent errors that result from
copying unknown types, you also make your application easier to interface to
from other programming languages, because it's obvious what that language
should expect in a copied structure from you.

In Cacheables this is even more true because you typically don't want to lose
the "observer" object, which is ignored by the default implementation.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021025/3b9721d4/attachment.pgp 

From itamar at itamarst.org  Fri Oct 25 21:33:31 2002
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 25 Oct 2002 21:33:31 -0400
Subject: [Twisted-Python] Some comments on twisted.news
In-Reply-To: <n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
	<20021022192113.GL12550@twistedmatrix.com>
	<n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>
Message-ID: <20021025213331.197dc906.itamar@itamarst.org>

On Wed, 23 Oct 2002 22:11:15 +0100
Paul Moore <gustav at morpheus.demon.co.uk> wrote:

> OK, I'll see what I can do. What's the best procedure for submitting a
> patch? Can I post patches to this list?

If it's big, http://sf.net/projects/twisted/ in the bug tracker.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From kkennedy at kenzoid.com  Sat Oct 26 01:03:55 2002
From: kkennedy at kenzoid.com (Ken Kennedy)
Date: Sat, 26 Oct 2002 01:03:55 -0400
Subject: [Twisted-Python] No shame...
Message-ID: <20021026050354.GI7029@kenzoid.com>

OK...I'm obviously not QUITE grokking something with Deferreds, and
I've spent FAR too long on something that's probably WAY too simple.

I've been trying to use a Deferred from an adbapi connection in a web
page display, and I'm just doing something wrong. I get the data, but
the page is already rendered. I know the query's working, b/c the
callback function writes to the log. At this point, I've given up and
used a blocking call just for example purposes.

Here's what's (shamefully) working now:

----BEGIN SCRIPT----

# Bloglist RTL file
#
# Provides a listing of recent blog posts 

# obviously, these aren't all being used now.
# I've been through 'em all during the day, though...
from twisted.web.resource import Resource
from twisted.enterprise import adbapi
from TwistedBlog.config import DSN
from TwistedBlog import blogger
from twisted.python import log
from twisted.web.server import NOT_DONE_YET
# the heck with it...
import pyPgSQL.PgSQL

class BlogResource(Resource):

      template render(self, request):
               print "DSN = %s" % (DSN,)
               conn = pyPgSQL.PgSQL.connect(DSN)
               cursor = conn.cursor()
               sql = """SELECT title, news_item_id FROM news_items
               ORDER BY release_date desc, news_item_id DESC
               LIMIT %s"""
               cursor.execute(sql, 8)
               recentList = cursor.fetchall()
               """
               <html>
               <head><title>Recent Entries</title></head>
               <body>
                <h1>Kenzoid's blog</h1>
                """
                for (title, id) in recentList:
                    '<a href="blog/%s">%s</a><br>' % (id,title)
                """
                </p>
                </body>
                </html>
                """ % vars()

resource = BlogResource()

----END SCRIPT----

Now, TwistedBlog.blogger.DatabaseBlogger OTOH uses an
adbapi.Augmentation.runQuery with the same SQL as above, returning a
Deferred. Once the callback runs, the resultlist is available there,
and I can write it (for example) to the log. So I know it's
working. Just not in sync with the rest of things.

So I realize the problems...but I'm
just-not-seeing-the-Deferred-way. Can someone give me a dumb-stupid
example, getting basically the same info as above into a webpage,
using adbapi rather than a blocking call? I find tantalizing mentions
of the use of Deferreds in various places, but I don't see any
easy examples. I like easy. *grin* For starters, anyway. 

As to format, I don't care. Use woven, Quixote PTL, Web Widgets,
direct writes, whatever floats your boat. I hope that once I see it and
play with it a tad, the lightbulb will turn on in my beany little
head. 

Thanks in advance...I'll take the ribbing, as long as I get some code
too! *grin*

-- 

Ken Kennedy	| http://www.kenzoid.com	| kenzoid at io.com



From twisted at moshez.org  Sat Oct 26 02:14:24 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 26 Oct 2002 06:14:24 -0000
Subject: Patches (was Re: [Twisted-Python] Some comments on twisted.news)
In-Reply-To: <n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>
References: <n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>, <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk> <20021022192113.GL12550@twistedmatrix.com>
Message-ID: <20021026061424.28499.qmail@green.zadka.com>

On Wed, 23 Oct 2002, Paul Moore <gustav at morpheus.demon.co.uk> wrote:

> OK, I'll see what I can do. What's the best procedure for submitting a
> patch? Can I post patches to this list?

Yes, you can.

>From the FAQ (in CVS):

I have a patch. How do I maximize the chances the Twisted developers will
include it?

   Use unified diff. Either use cvs diff -u or, better yet, make a clean
   checkout and use diff -urN between them. Make sure your patch applies
   cleanly. Then, send it to the mailing list inlined and without any
   word wrapping.



From ddimoti at mi2.hr  Sat Oct 26 14:35:53 2002
From: ddimoti at mi2.hr (Drazen Dimoti)
Date: Sat, 26 Oct 2002 20:35:53 +0200 (MEST)
Subject: [Twisted-Python] OpenLDAP mapping
Message-ID: <32848.192.168.0.190.1035657353.squirrel@services.mi2.hr>

Hi,

I have made a t.e like mapping for OpenLDAP client library. I have used the
old twisted LDAP while it was still in Twisted but there was no
documentation for it and I realy didn't have time to go over the code to
sort things out. I see there is no LDAP support in Twisted anymore so I made
this mapping.

I'm sending you a schema file, API mapping and an example for adding data to
LDAP server....

jimbo

-------------- next part --------------
A non-text attachment was scrubbed...
Name: ldapapi.py
Type: application/octet-stream
Size: 4466 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021026/a6e3553a/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ldaptest.py
Type: application/octet-stream
Size: 1818 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021026/a6e3553a/attachment-0001.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: example.ldif
Type: application/octet-stream
Size: 213 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021026/a6e3553a/attachment-0002.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: twisted.schema
Type: application/octet-stream
Size: 1070 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021026/a6e3553a/attachment-0003.obj 

From lordbrain at riseup.net  Sat Oct 26 14:34:37 2002
From: lordbrain at riseup.net (James Crayne)
Date: Sat, 26 Oct 2002 14:34:37 -0400
Subject: [Twisted-Python] Acronym Expansion in Documentation (WARNING: Newbie)
Message-ID: <1035657277.3dbae03d54d63@mail.riseup.net>

Hello, I am a (brand spankin' new)-bie, and the documentation contains 
something that i tripped over.

"The most prevalent kind of plug-in is the TAP (Twisted Application builder) type."

On the first read, I stumbled. On the second, i thought maybe it's a missprint and 
tried to guess at what was really meant.  The catch is that there is no capital P in 
this acronym expansion.  

Newbie think: "(Twisted Application _Pickle_ builder)?"  or "Why isnt it called 
TAB? or TAb?" ...

Then I joined #twisted on irc.freenode as LordBrain, here is a snippet:

<_moshez> yes
<LordBrain> ok
<_moshez> it's "Twisted APplication"
<LordBrain> ooooooh
<LordBrain> thanks
<spiv> _moshez: :)
<LordBrain> now it makes more sense
<spiv> _moshez: It is?  You should update the glossary then :)
<_moshez> spiv: I'm serious
<spiv> _moshez: I don't doubt it :)
<_moshez> spiv: well, sometimes it means Twisted Application Pickle
<spiv> _moshez: Right.  Actually, I'll update the glossary.
<LordBrain> but not in this case
<_moshez> spiv: mktap is "MaKe Twisted APplication"
<_moshez> while web.tap is "Web Twisted Application Pickle"

Non-newbies ascertain which is meant by context.

There are multiple places where this acronym is expanded in the Documentation. 
Consider changing all of them so that the second p in Application is capitalized 
(when/if appropriate). For example, the line that tripped me would read: "The 
most prevalent kind of plug-in is the TAP (Twisted APplication builder) type."

Thanks,
LordBrain

PS: CC reply if you wish me to see it, I am not on this list.




From andrew-twisted at puzzling.org  Sat Oct 26 20:46:40 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 27 Oct 2002 11:46:40 +1100
Subject: [Twisted-Python] OpenLDAP mapping
In-Reply-To: <32848.192.168.0.190.1035657353.squirrel@services.mi2.hr>
References: <32848.192.168.0.190.1035657353.squirrel@services.mi2.hr>
Message-ID: <20021027004640.GA489@frobozz.local>

On Sat, Oct 26, 2002 at 08:35:53PM +0200, Drazen Dimoti wrote:
> Hi,
> 
> I have made a t.e like mapping for OpenLDAP client library. I have used the
> old twisted LDAP while it was still in Twisted but there was no
> documentation for it and I realy didn't have time to go over the code to
> sort things out. I see there is no LDAP support in Twisted anymore so I made
> this mapping.

The LDAP support is now available as a seperate package:
    http://twistedmatrix.com/users/tv/ldaptor/

> I'm sending you a schema file, API mapping and an example for adding data to
> LDAP server....

Thanks!

-Andrew.




From justin at gnubian.org  Sat Oct 26 21:13:28 2002
From: justin at gnubian.org (Justin Ryan)
Date: 26 Oct 2002 20:13:28 -0500
Subject: [Twisted-Python] twisted/debian howto not avail?
Message-ID: <1035681209.28626.90.camel@qutang>

Heya all, when I visit [1] via the link on [2], I get:

-snip-

No Such Resource

File not found.

-snip-

Has the Debian/Twisted howto moved?  If so, the link should be updated..

[1] http://twistedmatrix.com/documents/howto/twisted-debian
[2] http://twistedmatrix.com/documents/admin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021026/edae731c/attachment.pgp 

From radix at twistedmatrix.com  Sun Oct 27 09:34:20 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 27 Oct 2002 15:34:20 +0100
Subject: [Twisted-Python] Acronym Expansion in Documentation (WARNING: Newbie)
In-Reply-To: <1035657277.3dbae03d54d63@mail.riseup.net>
References: <1035657277.3dbae03d54d63@mail.riseup.net>
Message-ID: <20021027143420.GA1335@twistedmatrix.com>

On Sat, Oct 26, 2002 at 02:34:37PM -0400, James Crayne wrote:
> Hello, I am a (brand spankin' new)-bie, and the documentation contains 
> something that i tripped over.
> 
> "The most prevalent kind of plug-in is the TAP (Twisted Application builder) type."
> 
> On the first read, I stumbled. On the second, i thought maybe it's a missprint and 
> tried to guess at what was really meant.  The catch is that there is no capital P in 
> this acronym expansion.  
> 
> Newbie think: "(Twisted Application _Pickle_ builder)?"  or "Why isnt it called 
> TAB? or TAb?" ...

Yeah, this has bothered me for a while; I'd personally like to rename
`mktap' to `mkapp', and save the acronym "tap" specifically for
"Twisted Application Pickle", but glyph doesn't seem to like that idea
:-)

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From mike.twisted at snitzer.net  Sun Oct 27 13:49:55 2002
From: mike.twisted at snitzer.net (Mike Snitzer)
Date: Sun, 27 Oct 2002 13:49:55 -0500
Subject: [Twisted-Python] mktap web --index patch
Message-ID: <20021027184955.GA6343@snitzer.net>

All,

It would appear that a twisted web server can't be easily configured
(via mktap web --index) to use both index.html _and_ index.php (or any
other combination) as directory indexes.

mktap2.1 web --help
...
  -i, --index=            Add the name of a file used to check for directory
                          indexes. [default: index, index.html]

SO.. I tried:
1) mktap2.1 web --path ~/public_html/ --index index.php 
and my php indexed directories work; but index.html indexed dirs do not

2) mktap2.1 web --path ~/public_html/ --index index.html,index.php
and get the mktap web usage

I've got to believe what I'm looking to do is something others would want
to be able to configure too.  However, the relevant twisted/tap/web.py
code will only allow the user to add a single directory index; pretty
strange limitation... 

Here's a patch to enable a user to specify multiple directory indexes to
the web server via mktap (i.e. like #2 above):

--- Twisted.orig/twisted/tap/web.py     Wed Oct 23 07:56:52 2002
+++ Twisted/twisted/tap/web.py  Sun Oct 27 13:35:34 2002
@@ -54,10 +54,11 @@
         self.opts['root'] = None
 
     def opt_index(self, indexName):
-        """Add the name of a file used to check for directory indexes.
+        """Add the name of a file(s) used to check for directory indexes.
         [default: index, index.html]
         """
-        self.opts['indexes'].append(indexName)
+        for index in string.split(indexName,','):
+            self.opts['indexes'].append(index)
 
     opt_i = opt_index







From radix at twistedmatrix.com  Sun Oct 27 14:58:32 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 27 Oct 2002 20:58:32 +0100
Subject: [Twisted-Python] mktap web --index patch
In-Reply-To: <20021027184955.GA6343@snitzer.net>
References: <20021027184955.GA6343@snitzer.net>
Message-ID: <20021027195832.GB1873@twistedmatrix.com>

On Sun, Oct 27, 2002 at 01:49:55PM -0500, Mike Snitzer wrote:
> SO.. I tried:
> 1) mktap2.1 web --path ~/public_html/ --index index.php 
> and my php indexed directories work; but index.html indexed dirs do not
> 
> 2) mktap2.1 web --path ~/public_html/ --index index.html,index.php
> and get the mktap web usage

mktap web --path ~/public_html/ -i index.html -i index.php -i ... 

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From mike.twisted at snitzer.net  Sun Oct 27 15:41:04 2002
From: mike.twisted at snitzer.net (Mike Snitzer)
Date: Sun, 27 Oct 2002 15:41:04 -0500
Subject: [Twisted-Python] Re: mktap web --index patch
In-Reply-To: <20021027195832.GB1873@twistedmatrix.com>
References: <20021027184955.GA6343@snitzer.net> <20021027195832.GB1873@twistedmatrix.com>
Message-ID: <20021027204104.GA7629@snitzer.net>

Christopher Armstrong (radix at twistedmatrix.com) said:

> mktap web --path ~/public_html/ -i index.html -i index.php -i ... 

Ah thanks, I didn't think to try stringing a bunch of -i's together.

On a completely unrelated note; I've created a "Powered by Twisted" icon
and attached it for all those interested (it's _very_ small (1.5K); and
I'm not sure if something similar already exists or not).

Mike
-------------- next part --------------
A non-text attachment was scrubbed...
Name: poweredby_twisted.png
Type: image/png
Size: 1548 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021027/2d0bc451/attachment.png 

From twisted_low at contact.com.my  Sun Oct 27 22:30:56 2002
From: twisted_low at contact.com.my (lals;dfjsd)
Date: Mon, 28 Oct 2002 11:30:56 +0800
Subject: [Twisted-Python] Quixote ???
Message-ID: <200210281130.AA18678018@contact.com.my>

Dear People,

can anyone tell me if quixote has been sucessfully been integrated into twisted matrix and can someone pls show me how get my box ( windows 98 ) with quixote working together with twisted matrix ??





From jonathan.lange at turnaroundsolutions.com  Mon Oct 28 03:55:44 2002
From: jonathan.lange at turnaroundsolutions.com (Jonathan Lange)
Date: Mon, 28 Oct 2002 19:55:44 +1100
Subject: [Twisted-Python] row howto patch
Message-ID: <8264704D39C2DC46A60DD84F34A818241C7D90@bab4.hobart.tas>

The row howto has a syntax error in the bit about rowForeignKeys. 
"[(tableName, [(columnName, columnType)], containerMethodName, autoLoad]"

I had a look at the source code, and the error appears to be a little deeper, in that there should be two lists of columns, one for parent columns, one for child columns.

Patch below, sorry if formatting is poor, I'm on Outlook web access.

jml


Index: doc/howto/row.html
===================================================================
RCS file: /cvs/Twisted/doc/howto/row.html,v
retrieving revision 1.17
diff -u -r1.17 row.html
--- doc/howto/row.html	27 Oct 2002 20:46:24 -0000	1.17
+++ doc/howto/row.html	28 Oct 2002 08:33:54 -0000
@@ -48,8 +48,8 @@
 
 <ul>
   <li>rowForeignKeys - list of foreign keys to other database tables
-  in the form: [(tableName, [(columnName, columnType)], containerMethodName,
-  autoLoad]</li>
+  in the form: [(tableName, [(childColumnName, childColumnType)], 
+  [(parentColumnName, parentColumnType)], containerMethodName, autoLoad]</li>
   <li>rowFactoryMethod - a method that creates instances of this
   class</li>
 </ul>




From twisted at itamarst.org  Mon Oct 28 10:50:32 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 28 Oct 2002 10:50:32 -0500
Subject: [Twisted-Python] row howto patch
In-Reply-To: <8264704D39C2DC46A60DD84F34A818241C7D90@bab4.hobart.tas>
References: <8264704D39C2DC46A60DD84F34A818241C7D90@bab4.hobart.tas>
Message-ID: <20021028105032.4e9722d4.twisted@itamarst.org>

On Mon, 28 Oct 2002 19:55:44 +1100
"Jonathan Lange" <jonathan.lange at turnaroundsolutions.com> wrote:

> +  in the form: [(tableName, [(childColumnName, childColumnType)], 
> +  [(parentColumnName, parentColumnType)], containerMethodName,
> autoLoad]</li>

Done.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From jonathan.lange at turnaroundsolutions.com  Mon Oct 28 06:09:01 2002
From: jonathan.lange at turnaroundsolutions.com (Jonathan Lange)
Date: Mon, 28 Oct 2002 22:09:01 +1100
Subject: [Twisted-Python] suggestion: t.enterprise.reflector populated errback
Message-ID: <8264704D39C2DC46A60DD84F34A818241C7D91@bab4.hobart.tas>

In twisted.enterprise.reflector, the Reflector constructor takes a populatedCallback argument. In SQLReflector, this is called after the reflector instance is successfully populated.

Surely, if it's possible to specify a callback, it should be possible to specify errback?

cheers,
jml



From jonathan.lange at turnaroundsolutions.com  Mon Oct 28 07:17:39 2002
From: jonathan.lange at turnaroundsolutions.com (Jonathan Lange)
Date: Mon, 28 Oct 2002 23:17:39 +1100
Subject: [Twisted-Python] Asynchronous unit tests
Message-ID: <8264704D39C2DC46A60DD84F34A818241C7D92@bab4.hobart.tas>


Attached is an asynchronous unit testing framework.

If you inherit from deferunittest.DeferredTestCase instead of inheriting from unittest.TestCase, then test methods can return a Deferred, which should be handled appropriately by the framework.

An example test suite is also attached.

Note that this required some modifications to the pyunit.unittest, in order to make things accessible to the subclass. A patch to the unittest.py currently in twisted cvs is attached.

I'm not feeling too sure about this whole thing, so feedback is highly appreciated.

cheers,
jml


-------------- next part --------------
A non-text attachment was scrubbed...
Name: unittest.py-patch
Type: application/octet-stream
Size: 6075 bytes
Desc: unittest.py-patch
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021028/80a81778/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: deferunittest.py
Type: application/octet-stream
Size: 3295 bytes
Desc: deferunittest.py
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021028/80a81778/attachment-0001.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_deferdemo.py
Type: application/octet-stream
Size: 3280 bytes
Desc: test_deferdemo.py
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021028/80a81778/attachment-0002.obj 

From glyph at twistedmatrix.com  Tue Oct 29 18:24:46 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 29 Oct 2002 17:24:46 -0600 (CST)
Subject: [Twisted-Python] crasher
Message-ID: <20021029.172446.68561627.glyph@twistedmatrix.com>


Okay, I've discovered a _very very_ odd bug in Twisted.  In trying to get this
stupid web/issues conduit thing working on Mac IE, I was trying all kinds of
crazy nonsense.  In particular there was one bit where I tried to make
issueconduit close the connection after the server sent each message, so it
would be immediately displayed, and then have the browser re-open the
connection after a second to retrieve any new messages.  (Mac IE doesn't allow
you to modify pages with Javascript that haven't been fully loaded for some
reason.) I did this using js timeouts and setting the src attribute on a hidden
iframe.

What happened next was not what I expected at all.  First, the server started
sending me the welcome message in a loop.  (This is probably just a bug in the
conduit code, nothing serious.)  However, when I entered something in the text
field and hit "enter", twistd _locked up hard_.  I couldn't even send it a
SIGTERM.  So I killed it and tried again a few times.  It would reliably lock
up after trying to send a message.  Best of all, this does not normally happen:
it is quite possible to interact with the server using the default js (with
some trivial changes); the only problem is that the updates won't show up until
the connection is finished.

The only thing I could think of that would be useful for debugging info is
strace, since it was wedged so hard and I didn't know where.  Here's what I
got:

    ...
    munmap(0x4001b000, 4096)                = 0
    close(9)                                = 0
    gettimeofday({1035895791, 342136}, NULL) = 0
    send(6, "HTTP/1.1 200 OK\r\nTransfer-encodi"..., 136, 0) = 136
    send(6, "c3\r\n&lt;IssueBot&gt; A SUPPORT R"..., 201, 0) = 201
    send(6, "0\r\n\r\n", 5, 0)              = 5
    gettimeofday({1035895791, 345729}, NULL) = 0
    gettimeofday({1035895791, 346897}, NULL) = 0
    write(1, "29/10/2002 06:49 [HTTPChannel,0,"..., 20529/10/2002 06:49 [HTTPChannel,0,64.123.27.109] 64.123.27.109 - - [29/Oct/2002:12:49:50 +0000] "<GET /issues.rpy/conduit?output=135 HTTP/1.1>" 200 195 "-" "Mozilla/4.0 (compatible; MSIE 5.14; Mac_PowerPC)"
    ) = 205
    brk(0x846d000)                          = 0x846d000
    old_mmap(NULL, 245760, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x4035b000
    brk(0x8433000)                          = 0x8433000
    mremap(0x4035b000, 245760, 245760, MREMAP_MAYMOVE) = 0x4035b000
    mremap(0x4035b000, 245760, 245760, MREMAP_MAYMOVE) = 0x4035b000
    mremap(0x4035b000, 245760, 245760, MREMAP_MAYMOVE) = 0x4035b000
    mremap(0x4035b000, 245760, 245760, MREMAP_MAYMOVE) = 0x4035b000
    ...

It then repeats "mremap" basically forever, and the various numbers there
increase very gradually.

So for some reason, Twisted is trying to allocate some huuuge chunk of memory.
Is there a way to get gdb to tell me where in python this is happening?

I am going out of my mind trying to figure out a way to debug this, so extra
eyes are helpful, but I don't think this bug can be found through normal
bughunting; you'd have to be pretty familiar with whatever code is causing the
problem.  I figure it might be either woven, twisted.protocols.http or
twisted.internet.

Help? :-)

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021029/e042314a/attachment.pgp 

From glyph at twistedmatrix.com  Tue Oct 29 18:28:59 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 29 Oct 2002 17:28:59 -0600 (CST)
Subject: [Twisted-Python] crasher
In-Reply-To: <20021029.172446.68561627.glyph@twistedmatrix.com>
References: <20021029.172446.68561627.glyph@twistedmatrix.com>
Message-ID: <20021029.172859.66181015.glyph@twistedmatrix.com>

On Tue, 29 Oct 2002 17:24:46 -0600 (CST), Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> Okay, I've discovered a _very very_ odd bug in Twisted.

I almost forgot: since the behavior is so hard to describe properly, a CVS tree
with the appropriate changes to it is present in ~glyph/Projects/Twisted on
pyramid.  The changed files are twisted/issues/ui/templates/conduit_msie.js,
twisted/issues/ui/issueconduit.py, and twisted/issues/ui/conduit.html.

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021029/d0bab3d1/attachment.pgp 

From andrew-twisted at puzzling.org  Tue Oct 29 18:50:57 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 30 Oct 2002 10:50:57 +1100
Subject: [Twisted-Python] crasher
In-Reply-To: <20021029.172446.68561627.glyph@twistedmatrix.com>
References: <20021029.172446.68561627.glyph@twistedmatrix.com>
Message-ID: <20021029235057.GB473@frobozz.local>

On Tue, Oct 29, 2002 at 05:24:46PM -0600, Glyph Lefkowitz wrote:
> 
> I am going out of my mind trying to figure out a way to debug this, so extra
> eyes are helpful, but I don't think this bug can be found through normal
> bughunting; you'd have to be pretty familiar with whatever code is causing the
> problem.  I figure it might be either woven, twisted.protocols.http or
> twisted.internet.
> 
> Help? :-)

Isn't there a hack you can do to sys.settracehook (or whatever it is) to
print each python function call entry & exit?  That would help narrow stuff
down.

I've also heard there's a gdb hack which lets it understand Python
tracebacks, so that it correctly displays them intermingled with the C
traceback when you issue a 'bt' command... but I can't seem to find it :(

Also, this url from google looks promising:
    http://groups.google.com/groups?q=gdb+python+traceback&hl=en&lr=&ie=UTF-8&safe=off&selm=14201.27231.1003.466027%40anthem.cnri.reston.va.us&rnum=4

Choice quote:
"""
First, get the pid of the running Python process.  Start up gdb on the
python executable and at the gdb prompt type "attach XXX" where XXX is
the pid.  Now, at the gdb prompt, type the following:

(gdb) call PyRun_SimpleString("import sys, traceback; sys.stderr=open('/tmp/tb','w',0); traceback.print_stack()")
"""

-Andrew.




From ASCHERBI at arinc.com  Tue Oct 29 19:00:27 2002
From: ASCHERBI at arinc.com (Scherbina, Alexander (ASCHERBI))
Date: Tue, 29 Oct 2002 19:00:27 -0500
Subject: [Twisted-Python] addWriter
Message-ID: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>

Hello Everyone!

I have a server that queues messages for clients.  The Queue object has a
callback from the ConnectionFactory, which deals with output formatting and
holds the Protocol object.  As soon as a client connects, the
ConnectionFactory peeks in the Queue for messages to be sent.  And if there
are any, it will send and dequeue and peek again until the Queue is
exhausted.   Once it's exhausted, the ConnectionFactory will be called
(using the callback) by the Queue when the next message is enqueued by the
Deliver module.

So far, this mechanism works well.  But one of its flaws is the partial
write situation.  If output buffer overflow occurred, I would like to
continue doing other things and get called back by the Reactor when the
socket is writable again.  Moreover, I would like to break the direct
association between the Queue and the ConnectionFactory.  

Instead, I would like to tie them through some kind of a notification
strategy (like in ACE), where my ConnectionFactory would be notifed by the
Reactor when the socket is writable, then the ConnectionFactory could peek,
send, dequeue and wait for the next notification.

I thought, addWriter/doWrite is what I need to use.  When I used them, my
ConnectionFactory's doWrite was never called after a client connected.

Is addWriter/doWrite approach correct?  Or am I going in a totally wrong
direction?  Please, help, if you can.

Thank you,
Alex Scherbina



From andrew-twisted at puzzling.org  Tue Oct 29 19:08:49 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 30 Oct 2002 11:08:49 +1100
Subject: [Twisted-Python] crasher
In-Reply-To: <20021029235057.GB473@frobozz.local>
References: <20021029.172446.68561627.glyph@twistedmatrix.com> <20021029235057.GB473@frobozz.local>
Message-ID: <20021030000849.GC473@frobozz.local>

On Wed, Oct 30, 2002 at 10:50:57AM +1100, Andrew Bennetts wrote:
> 
> I've also heard there's a gdb hack which lets it understand Python
> tracebacks, so that it correctly displays them intermingled with the C
> traceback when you issue a 'bt' command... but I can't seem to find it :(

Ok, I found where I saw this mentioned:
    http://mail.python.org/pipermail/python-dev/2002-July/027110.html

But I can't seem to find the patch he refers to.

There's also this, which apparently works, but slowly:
    http://mail.python.org/pipermail/python-dev/2001-June/015340.html

-Andrew.




From andrew-twisted at puzzling.org  Tue Oct 29 19:16:12 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 30 Oct 2002 11:16:12 +1100
Subject: [Twisted-Python] addWriter
In-Reply-To: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>
References: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>
Message-ID: <20021030001611.GD473@frobozz.local>

On Tue, Oct 29, 2002 at 07:00:27PM -0500, Scherbina, Alexander (ASCHERBI) wrote:
[..snip..]
> 
> So far, this mechanism works well.  But one of its flaws is the partial
> write situation.  If output buffer overflow occurred, I would like to
> continue doing other things and get called back by the Reactor when the
> socket is writable again.  Moreover, I would like to break the direct
> association between the Queue and the ConnectionFactory.  

Why are having problems with partial writes?  Your Protocol should simply call
self.transport.write(...), which will take care of all the hard work of
sending stuff at the appropriate times.  The Reactor will automatically wake
up the Transport when the socket is ready for writing, and the Transport
will automatically write anything that is waiting to be written.

> Is addWriter/doWrite approach correct?  Or am I going in a totally wrong
> direction?  Please, help, if you can.

It sounds to me like you're going in completely the wrong direction :)

Twisted does all of the hard work for you :)

The idea is you simply say "write this to this connection please" and
Twisted will do everything else... it'll handle partial writes, it'll handle
waiting until the socket is writeable.

Have you read the "Writing Clients" HOWTO?

-Andrew.




From exarkun at meson.dyndns.org  Tue Oct 29 19:16:50 2002
From: exarkun at meson.dyndns.org (Jp Calderone)
Date: Tue, 29 Oct 2002 19:16:50 -0500
Subject: [Twisted-Python] Pynfo (I'm back)
In-Reply-To: <3086.192.168.2.20.1035430218.squirrel@seraphine.csrules.dyndns.org>
References: <20021024023054.GA7029@kenzoid.com> <20021023.222042.07645503.glyph@twistedmatrix.com> <3086.192.168.2.20.1035430218.squirrel@seraphine.csrules.dyndns.org>
Message-ID: <20021030001650.GA28973@meson.dyndns.org>

On Wed, Oct 23, 2002 at 10:30:18PM -0500, Maniac - wrote:
> Dont really know where to broach this but:
> 
> I've been looking at the code for pynfo and there's some functionality
> i'd like to wedge in there i.e. logging to a database (for example) but
> i'd like to be able to do it without affecting the main code. Is there a
> reasonable way to create an external plugin that could be inserted at
> runtime?
> 

  (I don't know if you've already figured this out or not;  I'm posting
anyway on the off-chance you haven't and are still interested in using the
code-base, or someone else has taken an interest in the topic)

  I'm a little ashamed to say that Pynfo is a big, stinky hack.  There's no
kind of modularity, and only a half-hearted attempt at any kind of "plugin"
interface.  The freshmeat (non-functional) and google capabilities would be
the best example of how to go about this, but they're not done in such a way
as to allow you to not affect the main code with your desired additions. 

  Perhaps a good course of action would be for you to just hack what you
want into the main code and send me a patch, then I can try to refactor both
of our "plugins" into something that resembles an actual plugin interface.

  Jp

-- 
"One World, one Web, one Program." - Microsoft(R) promotional ad
"Ein Volk, ein Reich, ein Fuhrer." - Adolf Hitler
--
 7:00pm up 161 days, 20:59, 2 users, load average: 0.06, 0.06, 0.02
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021029/94d9de12/attachment.pgp 

From developer at csrules.dyndns.org  Tue Oct 29 21:38:17 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Tue, 29 Oct 2002 20:38:17 -0600 (CST)
Subject: [Twisted-Python] Pynfo (I'm back)
Message-ID: <2256.192.168.2.20.1035945497.squirrel@seraphine.csrules.dyndns.org>

I'm still interested in an IRC (or jabber) bot based
on the twisted framework. I dont want to mess with
an existing code base because of how bad a programmer I
am (hence the desire for plug-in functionality)

A common way seems to have plugins respond to IRC events
via handlers. How to do this?
/me shrugs

The one i'm using now is pybot.sourceforge.net

-M

> On Wed, Oct 23, 2002 at 10:30:18PM -0500, Maniac - wrote:
>> Dont really know where to broach this but:
>>
>> I've been looking at the code for pynfo and there's some
>> functionality i'd like to wedge in there i.e. logging to a database
>> (for example) but i'd like to be able to do it without affecting the
>> main code. Is there a reasonable way to create an external plugin
>> that could be inserted at runtime?
>>
>
>   (I don't know if you've already figured this out or not;  I'm
> posting
> anyway on the off-chance you haven't and are still interested in using
> the code-base, or someone else has taken an interest in the topic)
>
>   I'm a little ashamed to say that Pynfo is a big, stinky hack.
> There's
> no
> kind of modularity, and only a half-hearted attempt at any kind of
> "plugin" interface.  The freshmeat (non-functional) and google
> capabilities would be the best example of how to go about this, but
> they're not done in such a way as to allow you to not affect the main
> code with your desired additions.
>
>   Perhaps a good course of action would be for you to just hack what
> you
> want into the main code and send me a patch, then I can try to
> refactor both of our "plugins" into something that resembles an actual
> plugin interface.
>
>   Jp
>
> --
> "One World, one Web, one Program." - Microsoft(R) promotional ad "Ein
> Volk, ein Reich, ein Fuhrer." - Adolf Hitler
> --
>  7:00pm up 161 days, 20:59, 2 users, load average: 0.06, 0.06, 0.02






From glyph at twistedmatrix.com  Tue Oct 29 21:59:51 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 29 Oct 2002 20:59:51 -0600 (CST)
Subject: [Twisted-Python] addWriter
In-Reply-To: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>
References: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>
Message-ID: <20021029.205951.131915759.glyph@twistedmatrix.com>

On Tue, 29 Oct 2002 19:00:27 -0500, "Scherbina, Alexander (ASCHERBI)" <ASCHERBI at arinc.com> wrote:
> I thought, addWriter/doWrite is what I need to use.  When I used them, my
> ConnectionFactory's doWrite was never called after a client connected.
> 
> Is addWriter/doWrite approach correct?  Or am I going in a totally wrong
> direction?  Please, help, if you can.

Depending on your requirements, you should either be doing what spiv suggested
earlier (e.g. "nothing, just call transport.write") or you should be looking
into the producer/consumer API, which will allow you to produce streams of data
on demand.  Last I checked this wasn't terribly well documented, but it's
fairly straightforward and the code in twisted.web.static.FileTransfer is a
decent example.

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021029/4fd28707/attachment.pgp 

From screwtape at froup.com  Tue Oct 29 21:58:10 2002
From: screwtape at froup.com (screwtape at froup.com)
Date: Wed, 30 Oct 2002 13:58:10 +1100
Subject: [Twisted-Python] Pynfo (I'm back)
In-Reply-To: <20021030001650.GA28973@meson.dyndns.org>
References: <20021024023054.GA7029@kenzoid.com> <20021023.222042.07645503.glyph@twistedmatrix.com> <3086.192.168.2.20.1035430218.squirrel@seraphine.csrules.dyndns.org> <20021030001650.GA28973@meson.dyndns.org>
Message-ID: <20021030025810.GA4138@ferd2.thristian.org>

On Tue, Oct 29, 2002 at 07:16:50PM -0500, Jp Calderone wrote:
> On Wed, Oct 23, 2002 at 10:30:18PM -0500, Maniac - wrote:
> > Dont really know where to broach this but:
> > 
> > I've been looking at the code for pynfo and there's some functionality
> > i'd like to wedge in there i.e. logging to a database (for example) but
> > i'd like to be able to do it without affecting the main code. Is there a
> > reasonable way to create an external plugin that could be inserted at
> > runtime?
> 
>   (I don't know if you've already figured this out or not;  I'm posting
> anyway on the off-chance you haven't and are still interested in using the
> code-base, or someone else has taken an interest in the topic)

<snip>

Have *I* got *news* for *you*.

It just so happens that these last few weeks I've been working on a
module-based bot for twisted.im - and hence, and IRC bot. It's still
rather under development, but what *does* work now is dynamic loading
and unloading of plugins. :)

Current version is here:

	http://members.optusnet.com.au/thristian/twisted-bot.tar.gz

In the very near future, I hope to be changing the plugin API - I want
to be able to pass config information (likely a handle to the config
module) into each plugin, and possibly to send shutdown messages as
well.

Have a look, tell me what you like and don't like, tell me what you
want, and please - feel free to send patches. :)

-- 
 ___________ ____________________________
| Screwtape | Reply-To: munged on Usenet |________ ______ ____ __ _  _   _
|
| I M  R UNNi NG   OU T  Of FR 1DG3    MAGN TS
|



From twisted at itamarst.org  Wed Oct 30 00:59:11 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 30 Oct 2002 00:59:11 -0500
Subject: [Twisted-Python] New UDP API
Message-ID: <20021030005911.009553c6.twisted@itamarst.org>

I just checked in a refactored UDP API into CVS. Please take a look and
comment.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From twisted at itamarst.org  Wed Oct 30 01:23:09 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 30 Oct 2002 01:23:09 -0500
Subject: [Twisted-Python] New UDP API
In-Reply-To: <20021030005911.009553c6.twisted@itamarst.org>
References: <20021030005911.009553c6.twisted@itamarst.org>
Message-ID: <20021030012310.4ef419cb.twisted@itamarst.org>

On Wed, 30 Oct 2002 00:59:11 -0500
Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> I just checked in a refactored UDP API into CVS. Please take a look
> and comment.

And I guess some explanations are in order. I disabled twisted.names
test for the checkin, as it tests were failing. Commenting out tests
cause they break is a bad thing - DO NOT DO THIS AT HOME CHILDREN. I
only did it because names was inherently broken, as conformed by the
maintainer. And looks like I volunteered to do some fixing :/

Anyway, the new API:

Unconnected UDP ports
=====================
   port = reactor.listenUDP(port, protocol)

protocol is instance of DatagramProtocol, which unlike TCP protocols is
expected to be persistent. It will get start/stopProtocol called at the
appropriate time.

protocols' datagramReceived(data, (host, port)) method will be called
when they receive datagram, and the can self.transport.write(data,
(host, port)).


Connected UDP ports
===================
   port = reactor.connectUDP(remotehost, remoteport, protocol)

protocol is instance of ConnectedDatagramProtocol, which unlike TCP
protocols is expected to be persistent. It will get start/stopProtocol
called at the appropriate time.

protocols' datagramReceived(data) method will be called when they
receive datagram, and the can self.transport.write(data).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting
***> http://VoteNoWar.org -- vote/donate/volunteer <***



From gilh at sympatico.ca  Wed Oct 30 10:48:25 2002
From: gilh at sympatico.ca (Gil Hauer)
Date: 30 Oct 2002 10:48:25 -0500
Subject: [Twisted-Python] web site error
Message-ID: <1035992906.1778.4.camel@giantclam>

Hi,

I'm trying to navigate the site but many (almost all) of the pages show
an error page of the form:

web.Server Traceback
exceptions.IOError: [Errno 24] Too many open files:
'/var/www/WebSite/twistedmatrix.com/products/twisted'

... just thought you might like to know.

Gil
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021030/d8cc0ca3/attachment.pgp 

From radix at twistedmatrix.com  Tue Oct 29 11:10:11 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 29 Oct 2002 17:10:11 +0100
Subject: [Twisted-Python] web site error
In-Reply-To: <1035992906.1778.4.camel@giantclam>
References: <1035992906.1778.4.camel@giantclam>
Message-ID: <20021029161011.GB515@twistedmatrix.com>

On Wed, Oct 30, 2002 at 10:48:25AM -0500, Gil Hauer wrote:
> web.Server Traceback
> exceptions.IOError: [Errno 24] Too many open files:
> '/var/www/WebSite/twistedmatrix.com/products/twisted'
> 
> ... just thought you might like to know.

Fixed, for now. Glyph mentioned this bug last night, and now we see
the results of it ... The web server is leaking sockets. Anyone have a
clue?

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From gilh at sympatico.ca  Wed Oct 30 14:00:11 2002
From: gilh at sympatico.ca (Gil Hauer)
Date: 30 Oct 2002 14:00:11 -0500
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <20021017052440.22779.qmail@green.zadka.com>
References: <1034793181.1935.35.camel@giantclam> 
	<20021017052440.22779.qmail@green.zadka.com>
Message-ID: <1036004412.1778.22.camel@giantclam>

Hi again,

Can you send me a pointer to some documentation that describes how to
set up virtual host functionality?

Thanks,
Gil

On Thu, 2002-10-17 at 01:24, Moshe Zadka wrote:
> On 16 Oct 2002, Gil Hauer <gilh at sympatico.ca> wrote:
> 
> > I'd like one server to be able to host several web sites, hence:
> > 
> > Is it possible to use Twisted.web with virtual host functionality such
> > as that provided by Apache?
> 
> Is it ever!
> You can decide to go with one big process for all of them, a front server
> and a seperate server for each virtual host (for example, for permission
> reasons), and you can even mix-and-math between Apache and Twisted (for
> example, put Apache in the front and have Twisted handle some subset of the
> virtual host).  
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021030/e488eed9/attachment.pgp 

From abe at fettig.net  Wed Oct 30 17:57:19 2002
From: abe at fettig.net (Abe Fettig)
Date: 30 Oct 2002 17:57:19 -0500
Subject: [Twisted-Python] Hep, a Twisted project
Message-ID: <1036018639.692.74.camel@mingus>

Hi all,

I just released version 0.3 of Hep, my multiprotocol message server. 
The big change in this release is that Hep is now using Twisted for all
its networking stuff:  HTTP and XMLRPC clients, POP3, SMTP, and web
servers.

The Hep web page is:
http://www.fettig.net/projects/hep.

Thanks for the nice software!

Abe




From andrew-twisted at puzzling.org  Wed Oct 30 18:09:51 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 31 Oct 2002 10:09:51 +1100
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <1036004412.1778.22.camel@giantclam>
References: <1034793181.1935.35.camel@giantclam> <20021017052440.22779.qmail@green.zadka.com> <1036004412.1778.22.camel@giantclam>
Message-ID: <20021030230951.GA27768@ritsuko.xware.cx>

On Wed, Oct 30, 2002 at 02:00:11PM -0500, Gil Hauer wrote:
> Hi again,
> 
> Can you send me a pointer to some documentation that describes how to
> set up virtual host functionality?

This is documented in CVS Twisted.  If you can't access CVS, you can
find a ps/pdf version of the CVS docs here:
    http://twistedmatrix.com/users/moshez/book.ps.bz2
    http://twistedmatrix.com/users/moshez/book.pdf

Those links aren't "official" docs yet (we're still working on the
script that generates them, there's a couple of glitches), but they
should contain exactly the same content as the doc/howto/*.xhtml files
from CVS Twisted.

-Andrew.




From glyph at twistedmatrix.com  Wed Oct 30 18:34:50 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 30 Oct 2002 17:34:50 -0600 (CST)
Subject: [Twisted-Python] web site error
In-Reply-To: <20021029161011.GB515@twistedmatrix.com>
References: <1035992906.1778.4.camel@giantclam>
	<20021029161011.GB515@twistedmatrix.com>
Message-ID: <20021030.173450.63128778.glyph@twistedmatrix.com>


On Tue, 29 Oct 2002 17:10:11 +0100, Christopher Armstrong <radix at twistedmatrix.com> wrote:
> Fixed, for now. Glyph mentioned this bug last night, and now we see
> the results of it ... The web server is leaking sockets. Anyone have a
> clue?

Well, it's not really leaking them.  As far as I can tell, the other end of the
socket isn't closing the connection, so Twisted just keeps it open 'cause
there's no timeout.  If there were a timeout, that would mean that proxying
certain things through HTTP might break.  What I'm wondering is why _other_
webservers don't suffer from this problem.  Do they have a timeout?  Is there
something else happening in Twisted that I'm missing?  This is certainly a very
frustrating bug to test for.  (After all, it's possible that this is some
impossibly obscure errno that we're not accounting for, too...)

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021030/22f1b3f0/attachment.pgp 

From bruce at cubik.org  Wed Oct 30 18:47:53 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 30 Oct 2002 16:47:53 -0700
Subject: [Twisted-Python] web site error
References: <1035992906.1778.4.camel@giantclam>	<20021029161011.GB515@twistedmatrix.com> <20021030.173450.63128778.glyph@twistedmatrix.com>
Message-ID: <3DC06FA9.9040709@cubik.org>

Glyph Lefkowitz wrote:
> On Tue, 29 Oct 2002 17:10:11 +0100, Christopher Armstrong <radix at twistedmatrix.com> wrote:
> 
>>Fixed, for now. Glyph mentioned this bug last night, and now we see
>>the results of it ... The web server is leaking sockets. Anyone have a
>>clue?
> 
> Well, it's not really leaking them.  As far as I can tell, the other end of the
> socket isn't closing the connection, so Twisted just keeps it open 'cause
> there's no timeout.  If there were a timeout, that would mean that proxying
> certain things through HTTP might break.  What I'm wondering is why _other_
> webservers don't suffer from this problem.  Do they have a timeout?  Is there
> something else happening in Twisted that I'm missing?  This is certainly a very
> frustrating bug to test for.  (After all, it's possible that this is some
> impossibly obscure errno that we're not accounting for, too...)

For whatever little it is worth, I've had troubles like this in the past 
with our own homebrew webserver in our games at work.

There are some buggy web caches and other things out there that keep 
connections open.  We had implemented a connection timeout to work 
around the problem.

  - Bruce




From jjn at kriln.com  Wed Oct 30 18:54:46 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Wed, 30 Oct 2002 23:54:46 +0000 (GMT)
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030.173450.63128778.glyph@twistedmatrix.com>
Message-ID: <20021030235138.P6472-100000@nosferatu.kriln.com>

On Wed, 30 Oct 2002, Glyph Lefkowitz wrote:

> Well, it's not really leaking them.  As far as I can tell, the other end of the
> socket isn't closing the connection, so Twisted just keeps it open 'cause
> there's no timeout.  If there were a timeout, that would mean that proxying
> certain things through HTTP might break.  What I'm wondering is why _other_
> webservers don't suffer from this problem.  Do they have a timeout?  Is there
> something else happening in Twisted that I'm missing?  This is certainly a very
> frustrating bug to test for.  (After all, it's possible that this is some
> impossibly obscure errno that we're not accounting for, too...)

Generally, one would rarely want to have sockets that don't timeout.  To
have sockets without timeout opens a server up to easy DoS attacks.  I
can't imagine a time when you wouldn't want to time out sockets, even if
you're trying to tunnel something over HTTP.  If you pull out an ethernet
cable or a modem phone line, connections don't get closed either.  Any
assumption that connections will always close nicely is flawed.  Though,
maybe I'm misunderstanding what you mean by 'no timeout'

Personally, when I was running high volume web servers, we'd tune down the
keepalive timers to a fairly short interval to keep sockets from getting
tied up too long, to prevent resource availability issues that we were
seeing.

J




From jml at mumak.net  Wed Oct 30 19:33:01 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Thu, 31 Oct 2002 11:33:01 +1100
Subject: [Twisted-Python] reflector init
Message-ID: <20021031003301.GA357@ids.org.au>

The initialisers for reflectors seem to do some interesting stuff. The
SQLReflector in particular does some stuff that requires a callback.
(see twisted.enterprise.*reflector)

Shouldn't this be handled using a Deferred? It's extremely frustrating 
not being able to add an errback.

Suggestions include having a populatedDeferred as a member (rather than
populatedCallback), or moving the populate stuff into a separate method 
that returns a Deferred.

Thoughts?

jml



From jml at mumak.net  Wed Oct 30 20:05:46 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Thu, 31 Oct 2002 12:05:46 +1100
Subject: [Twisted-Python] reflector init
In-Reply-To: <20021031003301.GA357@ids.org.au>
References: <20021031003301.GA357@ids.org.au>
Message-ID: <20021031010546.GA1143@ids.org.au>

On Thu, Oct 31, 2002 at 11:33:01AM +1100, Jonathan M. Lange wrote:
> Suggestions include having a populatedDeferred as a member (rather than
> populatedCallback)

patches :)

Index: twisted/enterprise/reflector.py
===================================================================
RCS file: /cvs/Twisted/twisted/enterprise/reflector.py,v
retrieving revision 1.9
diff -u -r1.9 reflector.py
--- twisted/enterprise/reflector.py	16 Oct 2002 04:27:29 -0000	1.9
+++ twisted/enterprise/reflector.py	31 Oct 2002 00:57:59 -0000
@@ -20,6 +20,7 @@
 from twisted.enterprise import adbapi
 from twisted.enterprise.util import DBError, getKeyColumn, quote, _TableInfo, _TableRelationship
 from twisted.enterprise.row import RowObject
+from twisted.internet import defer
 
 class Reflector:
     """Base class for enterprise reflectors. This implements rowCacheing.
@@ -61,6 +62,7 @@
         
         from twisted.internet import reactor
         reactor.callLater(0, self._really_populate)
+        self.populatedDeferred = defer.Deferred()
 
     def _really_populate(self):
         """Implement me to populate schema information for the reflector.
Index: twisted/enterprise/sqlreflector.py
===================================================================
RCS file: /cvs/Twisted/twisted/enterprise/sqlreflector.py,v
retrieving revision 1.10
diff -u -r1.10 sqlreflector.py
--- twisted/enterprise/sqlreflector.py	14 Oct 2002 22:34:21 -0000	1.10
+++ twisted/enterprise/sqlreflector.py	31 Oct 2002 00:58:00 -0000
@@ -49,6 +49,7 @@
         defe = self.runInteraction(self._transPopulateSchema)
         if self.populatedCallback:
             defe.addCallbacks(self.populatedCallback)
+        defe.chainDeferred(self.populatedDeferred)
 
     def _transPopulateSchema(self, transaction):
         """Used to construct the row classes in a single interaction.




From glyph at twistedmatrix.com  Wed Oct 30 21:58:32 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 30 Oct 2002 20:58:32 -0600 (CST)
Subject: [Twisted-Python] web site error
In-Reply-To: <3DC06FA9.9040709@cubik.org>
References: <20021029161011.GB515@twistedmatrix.com>
	<20021030.173450.63128778.glyph@twistedmatrix.com>
	<3DC06FA9.9040709@cubik.org>
Message-ID: <20021030.205832.93023286.glyph@twistedmatrix.com>


On Wed, 30 Oct 2002 16:47:53 -0700, Bruce Mitchener <bruce at cubik.org> wrote:
> For whatever little it is worth, I've had troubles like this in the past 
> with our own homebrew webserver in our games at work.

> There are some buggy web caches and other things out there that keep 
> connections open.  We had implemented a connection timeout to work 
> around the problem.

Actually, this is really useful info for me.  It means that I can implement a
timeout with impunity and not worry that I'm doing bad things :).  Now just
have to write the code that determines if a connection has been idle...

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021030/c53be1a7/attachment.pgp 

From glyph at twistedmatrix.com  Wed Oct 30 22:06:19 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 30 Oct 2002 21:06:19 -0600 (CST)
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <1036018639.692.74.camel@mingus>
References: <1036018639.692.74.camel@mingus>
Message-ID: <20021030.210619.78707311.glyph@twistedmatrix.com>

On 30 Oct 2002 17:57:19 -0500, Abe Fettig <abe at fettig.net> wrote:
> I just released version 0.3 of Hep, my multiprotocol message server. 

Hey, this looks awesome!! :-D

Obviously with all the different protocol support in Twisted, I had hoped to
eventually implement something like this.  It looks like Hep is quite
application-level though (sending e-mail messages to a weblog, etc), so
hopefully there wouldn't be too much overlap (if I could ever get around to
actually implementing message-transport-abstraction stuff...).

If you've got any message-level abstractions you'd like supported at the
Twisted level (or better yet, patches to unify some of the protocols' approach
to messaging) I'd really like to hear about them.  Thanks for letting us know
about this project!

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021030/c2275813/attachment.pgp 

From glyph at twistedmatrix.com  Wed Oct 30 22:06:58 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 30 Oct 2002 21:06:58 -0600 (CST)
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030235138.P6472-100000@nosferatu.kriln.com>
References: <20021030.173450.63128778.glyph@twistedmatrix.com>
	<20021030235138.P6472-100000@nosferatu.kriln.com>
Message-ID: <20021030.210658.59655039.glyph@twistedmatrix.com>

On Wed, 30 Oct 2002 23:54:46 +0000 (GMT), Jeremy Noetzelman <jjn at kriln.com> wrote:
> Personally, when I was running high volume web servers, we'd tune down the
> keepalive timers to a fairly short interval to keep sockets from getting
> tied up too long, to prevent resource availability issues that we were
> seeing.

Just out of curiosity, how does one configure this timeout with apache?

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021030/6ae16c2d/attachment.pgp 

From twisted at moshez.org  Thu Oct 31 01:15:33 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 31 Oct 2002 06:15:33 -0000
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <1036018639.692.74.camel@mingus>
References: <1036018639.692.74.camel@mingus>
Message-ID: <20021031061533.8689.qmail@green.zadka.com>

On 30 Oct 2002, Abe Fettig <abe at fettig.net> wrote:

> I just released version 0.3 of Hep, my multiprotocol message server. 
> The big change in this release is that Hep is now using Twisted for all
> its networking stuff:  HTTP and XMLRPC clients, POP3, SMTP, and web
> servers.
> 
> The Hep web page is:
> http://www.fettig.net/projects/hep.

Can this be added to the "projects using twisted" page?

Thanks



From jjn at kriln.com  Thu Oct 31 01:23:04 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Thu, 31 Oct 2002 06:23:04 +0000 (GMT)
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030.210658.59655039.glyph@twistedmatrix.com>
Message-ID: <20021031062249.O21031-100000@nosferatu.kriln.com>

On Wed, 30 Oct 2002, Glyph Lefkowitz wrote:

> On Wed, 30 Oct 2002 23:54:46 +0000 (GMT), Jeremy Noetzelman <jjn at kriln.com> wrote:
> > Personally, when I was running high volume web servers, we'd tune down the
> > keepalive timers to a fairly short interval to keep sockets from getting
> > tied up too long, to prevent resource availability issues that we were
> > seeing.
>
> Just out of curiosity, how does one configure this timeout with apache?

No idea.  I did it at the OS level.




From m at moshez.org  Thu Oct 31 01:17:33 2002
From: m at moshez.org (Moshe Zadka)
Date: 31 Oct 2002 06:17:33 -0000
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030.173450.63128778.glyph@twistedmatrix.com>
References: <20021030.173450.63128778.glyph@twistedmatrix.com>, <1035992906.1778.4.camel@giantclam>
	<20021029161011.GB515@twistedmatrix.com>
Message-ID: <20021031061733.8711.qmail@green.zadka.com>

On Wed, 30 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> If there were a timeout, that would mean that proxying
> certain things through HTTP might break.  What I'm wondering is why _other_
> webservers don't suffer from this problem.  Do they have a timeout?

Every web server has a timeout, at least for "time which passes in which
nothing flows in either direction."



From typo at soniq.net  Thu Oct 31 09:48:17 2002
From: typo at soniq.net (Paul Boehm)
Date: Thu, 31 Oct 2002 15:48:17 +0100
Subject: [Twisted-Python] viewStack breakage
Message-ID: <20021031144817.GA3944@soniq.net>

hey, thanks for fixing the caching bug that quickly!

i think something else broke with your last few commits though:

this debug output is from getNodeView for a GET request, with no controllers
working. i have a wvfactory_DetailLink in sam.web.serverlist.View, which the
viewStack finds without problems:

31/10/2002 15:41 [*samclient*] [<twisted.web.woven.widgets.KeyedList instance at 0x83c17e4>, <twisted.web.woven.widgets.DefaultWidget instance at 0x83e6674>, <twisted.web.woven.widgets.DefaultWidget instance at 0x83e45ac>, <sam.web.serverlist.View instance at 0x83ae814>, <module 'twisted.web.woven.widgets' from '/home/paul/Twisted/twisted/web/woven/widgets.pyc'>]

now when i submit data to my controller, i get a different viewStack
exceptions.NotImplementedError: You specified view name DetailLink on a node, but no factory_DetailLink method was found in [<twisted.web.woven.widgets.DefaultWidget instance at 0x840963c>, <twisted.web.woven.widgets.KeyedList instance at 0x83db2bc>, <module 'twisted.web.woven.widgets' from '/home/paul/Twisted/twisted/web/woven/widgets.pyc'>].

without sam.web.serverlist.View.

the relevant xhtml snippet for this is:
        <ul model="root/inventory" view="KeyedList">
            <li id="emptyList">No Servers defined</li>
            <li id="keyedListItem">
                <a view="DetailLink" model="name">
                <span view="Text" model="name" /></a>
            </li>
        </ul>

root is a dictionary in my serverlist.Model, which has serverlist.View
registered as View.

inventory is a Dictionary like class, which has registered for a 
DictionaryModel Wrapper with components.

as inventory is only a virtual model, imho the parent's view should
propagate down to it's viewStack, which seems to work, unless a controller
updates inventory.

what's needed to fix this? do i need to make inventory and/or root 
a real model and register a view for it ?

  paul



From abe at fettig.net  Thu Oct 31 11:19:28 2002
From: abe at fettig.net (Abe Fettig)
Date: 31 Oct 2002 11:19:28 -0500
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <20021030.210619.78707311.glyph@twistedmatrix.com>
References: <1036018639.692.74.camel@mingus>
	 <20021030.210619.78707311.glyph@twistedmatrix.com>
Message-ID: <1036081167.1571.40.camel@mingus>

On Wed, 2002-10-30 at 22:06, Glyph Lefkowitz wrote:
> On 30 Oct 2002 17:57:19 -0500, Abe Fettig <abe at fettig.net> wrote:
> > I just released version 0.3 of Hep, my multiprotocol message server. 
> 
> Hey, this looks awesome!! :-D
> 
> Obviously with all the different protocol support in Twisted, I had hoped to
> eventually implement something like this.  It looks like Hep is quite
> application-level though (sending e-mail messages to a weblog, etc), so
> hopefully there wouldn't be too much overlap (if I could ever get around to
> actually implementing message-transport-abstraction stuff...).
> 
> If you've got any message-level abstractions you'd like supported at the
> Twisted level (or better yet, patches to unify some of the protocols' approach
> to messaging) I'd really like to hear about them.  Thanks for letting us know
> about this project!

At the moment I'm still in lurk mode, trying to get a feel for the
Twisted way of doing things.

I have been thinking about unified messaging. One of the next steps for
Hep is a unified protocol/address setup so it can transparently route
messages between different systems.  For example, I want Hep users to be
able to send mail to "bob at aim.hep" and have the message go to the AOL IM
account "bob".

There are a couple of servers I'd like to use that aren't available in
Twisted yet (to the best of my knowledge) - IMAP and WebDAV.  Is anyone
working on implementing these?  If so, I'd be happy to help.

-- 
Abe Fettig
abe at fettig.net
http://www.fettig.net/




From radix at twistedmatrix.com  Wed Oct 30 11:39:38 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 30 Oct 2002 17:39:38 +0100
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <20021031061533.8689.qmail@green.zadka.com>
References: <1036018639.692.74.camel@mingus> <20021031061533.8689.qmail@green.zadka.com>
Message-ID: <20021030163938.GA458@twistedmatrix.com>

On Thu, Oct 31, 2002 at 06:15:33AM -0000, Moshe Zadka wrote:
> On 30 Oct 2002, Abe Fettig <abe at fettig.net> wrote:
> > The Hep web page is:
> > http://www.fettig.net/projects/hep.
> 
> Can this be added to the "projects using twisted" page?

I've already taken the liberty.

http://twistedmatrix.com/products/success

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From dp at twistedmatrix.com  Thu Oct 31 11:44:56 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Thu, 31 Oct 2002 08:44:56 -0800
Subject: [Twisted-Python] viewStack breakage
In-Reply-To: <20021031144817.GA3944@soniq.net>
Message-ID: <1625EC21-ECF0-11D6-898A-000393B3EC2C@twistedmatrix.com>

If you look in the commit, you'll see a comment about this problem...

         # This works for simple cases, unfortunately this widget 
doesn't have
         # appropriate mvc stack -- it only has itself

I'm going to have to copy the stack each time I create a widget and 
store it in the widget so that later when a widget gets a modelChanged 
notification, the correct stuff is on the stack. Doing this will also 
help with Deferreds -- they'll run in to the same problem right now, 
when the deferred fires they won't have the proper things on the stack.

I might get to this today, but I might not.

Donovan

On Thursday, October 31, 2002, at 06:48 AM, Paul Boehm wrote:

> hey, thanks for fixing the caching bug that quickly!
>
> i think something else broke with your last few commits though:
>
> this debug output is from getNodeView for a GET request, with no 
> controllers
> working. i have a wvfactory_DetailLink in sam.web.serverlist.View, 
> which the
> viewStack finds without problems:
>
> 31/10/2002 15:41 [*samclient*] [<twisted.web.woven.widgets.KeyedList 
> instance at 0x83c17e4>, <twisted.web.woven.widgets.DefaultWidget 
> instance at 0x83e6674>, <twisted.web.woven.widgets.DefaultWidget 
> instance at 0x83e45ac>, <sam.web.serverlist.View instance at 
> 0x83ae814>, <module 'twisted.web.woven.widgets' from 
> '/home/paul/Twisted/twisted/web/woven/widgets.pyc'>]
>
> now when i submit data to my controller, i get a different viewStack
> exceptions.NotImplementedError: You specified view name DetailLink on 
> a node, but no factory_DetailLink method was found in 
> [<twisted.web.woven.widgets.DefaultWidget instance at 0x840963c>, 
> <twisted.web.woven.widgets.KeyedList instance at 0x83db2bc>, <module 
> 'twisted.web.woven.widgets' from 
> '/home/paul/Twisted/twisted/web/woven/widgets.pyc'>].
>
> without sam.web.serverlist.View.
>
> the relevant xhtml snippet for this is:
>         <ul model="root/inventory" view="KeyedList">
>             <li id="emptyList">No Servers defined</li>
>             <li id="keyedListItem">
>                 <a view="DetailLink" model="name">
>                 <span view="Text" model="name" /></a>
>             </li>
>         </ul>
>
> root is a dictionary in my serverlist.Model, which has serverlist.View
> registered as View.
>
> inventory is a Dictionary like class, which has registered for a
> DictionaryModel Wrapper with components.
>
> as inventory is only a virtual model, imho the parent's view should
> propagate down to it's viewStack, which seems to work, unless a 
> controller
> updates inventory.
>
> what's needed to fix this? do i need to make inventory and/or root
> a real model and register a view for it ?
>
>   paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From iko at strakt.com  Thu Oct 31 15:36:17 2002
From: iko at strakt.com (Anders Hammarquist)
Date: Thu, 31 Oct 2002 21:36:17 +0100
Subject: [Twisted-Python] SMTP
Message-ID: <200210312036.g9VKaH7O031180@fido.strakt.com>

SMTP server patch, take 3

This now includes a tested unit test.

Feedback is welcome, as always.

/Anders

-------------- next part --------------
Index: twisted/protocols/basic.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/basic.py,v
retrieving revision 1.25
diff -u -u -r1.25 basic.py
--- twisted/protocols/basic.py	18 Oct 2002 06:46:52 -0000	1.25
+++ twisted/protocols/basic.py	31 Oct 2002 20:25:03 -0000
@@ -153,12 +153,15 @@
                 line, self.__buffer = self.__buffer.split(self.delimiter, 1)
             except ValueError:
                 if len(self.__buffer) > self.MAX_LENGTH:
-                    self.transport.loseConnection()
+                    line, self.__buffer = self.__buffer, ''
+                    self.lineLengthExceeded(line)
                     return
                 break
             else:
-                if len(line) > self.MAX_LENGTH:
-                    self.transport.loseConnection()
+                linelength = len(line)
+                if linelength > self.MAX_LENGTH:
+                    line, self.__buffer = self.__buffer, ''
+                    self.lineLengthExceeded(line)
                     return
                 self.lineReceived(line)
                 if self.transport.disconnecting:
@@ -200,6 +203,12 @@
         """Sends a line to the other end of the connection.
         """
         self.transport.write(line + self.delimiter)
+
+    def lineLengthExceeded(self, line):
+        """Called when the maximum line length has been reached.
+        Override if it needs to be dealt with in some special way.
+        """
+        self.transport.loseConnection()
 
 
 class Int32StringReceiver(protocol.Protocol):
Index: twisted/protocols/smtp.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/smtp.py,v
retrieving revision 1.26
diff -u -u -r1.26 smtp.py
--- twisted/protocols/smtp.py	14 Oct 2002 13:21:06 -0000	1.26
+++ twisted/protocols/smtp.py	31 Oct 2002 20:25:04 -0000
@@ -18,10 +18,10 @@
 """
 
 from twisted.protocols import basic
-from twisted.internet import protocol, defer
+from twisted.internet import protocol, defer, reactor
 from twisted.python import log
 
-import os, time, string, operator
+import os, time, string, operator, re
 
 class SMTPError(Exception):
     pass
@@ -49,19 +49,110 @@
         self.deferred.errback(arg)
         self.done = 1
 
+class AddressError(SMTPError):
+    "Parse error in address"
+    pass
+
+# Character classes for parsing addresses
+atom = r"-A-Za-z0-9!#$%&'*+/=?^_`{|}~"
+
+class Address:
+    """Parse and hold an RFC 2821 address.
+
+    Source routes are stipped and ignored, UUCP-style bang-paths
+    and %-style routing are not parsed.
+    """
+
+    tstring = re.compile(r'''( # A string of
+                          (?:"[^"]*" # quoted string
+			  |\\.i # backslash-escaped characted
+			  |[''' + string.replace(atom,'#',r'\#')
+                          + r'''] # atom character
+			  )+|.) # or any single character''',re.X)
+
+    def __init__(self, addr):
+        self.local = ''
+        self.domain = ''
+        self.addrstr = addr
+
+        # Tokenize
+        atl = filter(None,self.tstring.split(addr))
+
+        local = []
+        domain = []
+
+        while atl:
+            if atl[0] == '<':
+                if atl[-1] != '>':
+                    raise AddressError, "Unbalanced <>"
+                atl = atl[1:-1]
+            elif atl[0] == '@':
+                atl = atl[1:]
+                if not local:
+                    # Source route
+                    while atl and atl[0] != ':':
+                        # remove it
+                        atl = atl[1:]
+                    if not atl:
+                        raise AddressError, "Malformed source route"
+                    atl = atl[1:] # remove :
+                elif domain:
+                    raise AddressError, "Too many @"
+                else:
+                    # Now in domain
+                    domain = ['']
+            elif len(atl[0]) == 1 and atl[0] not in atom + '.':
+                raise AddressError, "Parse error at " + atl[0]
+            else:
+                if not domain:
+                    local.append(atl[0])
+                else:
+                    domain.append(atl[0])
+                atl = atl[1:]
+               
+        self.local = ''.join(local)
+        self.domain = ''.join(domain)
+
+    dequotebs = re.compile(r'\\(.)')
+    def dequote(self,addr):
+        "Remove RFC-2821 quotes from address"
+        res = []
+
+        atl = filter(None,self.tstring.split(str(addr)))
+
+        for t in atl:
+            if t[0] == '"' and t[-1] == '"':
+                res.append(t[1:-1])
+            elif '\\' in t:
+                res.append(self.dequotebs.sub(r'\1',t))
+            else:
+                res.append(t)
+
+        return ''.join(res)
+
+    def __str__(self):
+        return '%s%s' % (self.local, self.domain and ("@" + self.domain) or "")
+
+    def __repr__(self):
+        return "%s.%s(%s)" % (self.__module__, self.__class__.__name__,
+                              repr(str(self)))
 
 class User:
 
     def __init__(self, destination, helo, protocol, orig):
-        try:
-            self.name, self.domain = string.split(destination, '@', 1)
-        except ValueError:
-            self.name = destination
-            self.domain = ''
+        self.dest = Address(destination)
         self.helo = helo
         self.protocol = protocol
         self.orig = orig
 
+    def __getstate__(self):
+        return { 'dest' : self.dest,
+                 'helo' : self.helo,
+                 'protocol' : None,
+                 'orig' : self.orig }
+
+    def __str__(self):
+        return str(self.dest)
 
 class IMessage:
 
@@ -87,19 +178,39 @@
         self.mode = COMMAND
         self.__from = None
         self.__helo = None
-        self.__to = ()
+        self.__to = []
+
+    def timedout(self):
+        self.sendCode(421, '%s Timeout. Try talking faster next time!' %
+                      self.host)
+        self.transport.loseConnection()
 
     def connectionMade(self):
-        self.sendCode(220, 'Spammers beware, your ass is on fire')
+        self.host = self.factory.domain
+        if hasattr(self.factory, 'timeout'):
+            self.timeout = self.factory.timeout
+        else:
+            self.timeout = 600
+        self.sendCode(220, '%s Spammers beware, your ass is on fire' %
+                      self.host)
+        if self.timeout:
+            self.timeoutID = reactor.callLater(self.timeout, self.timedout)
 
     def sendCode(self, code, message=''):
         "Send an SMTP code with a message."
         self.transport.write('%d %s\r\n' % (code, message))
 
     def lineReceived(self, line):
+        if self.timeout:
+            self.timeoutID.cancel()
+            self.timeoutID = reactor.callLater(self.timeout, self.timedout)
+
         if self.mode is DATA:
             return self.dataLineReceived(line)
-        command = string.split(line, None, 1)[0]
+        if line:
+            command = string.split(line, None, 1)[0]
+        else:
+            command = ''
         method = getattr(self, 'do_'+string.upper(command), None)
         if method is None:
             method = self.do_UNKNOWN
@@ -107,59 +218,128 @@
             line = line[len(command):]
         return method(string.strip(line))
 
+    def lineLengthExceeded(self, line):
+        if self.mode is DATA:
+            for message in self.__messages:
+                message.connectionLost()
+            self.mode = COMMAND
+            del self.__messages
+        self.sendCode(500, 'Line too long')
+
+    def rawDataReceived(self, data):
+        "Throw away rest of long line"
+        rest = string.split(data, '\r\n', 1)
+        if len(rest) == 2:
+            self.setLineMode(self.rest[1])
+
     def do_UNKNOWN(self, rest):
-        self.sendCode(502, 'Command not implemented')
+        self.sendCode(500, 'Command not implemented')
 
     def do_HELO(self, rest):
-        self.__helo = rest
-        self.sendCode(250, 'Nice to meet you')
+        peer = self.transport.getPeer()[1]
+        self.__helo = (rest, peer)
+        self.sendCode(250, '%s Hello %s, nice to meet you' % (self.host, peer))
 
     def do_QUIT(self, rest):
         self.sendCode(221, 'See you later')
         self.transport.loseConnection()
 
+    # A string of quoted strings, backslash-escaped character or
+    # atom characters + '@.,:'
+    qstring = r'("[^"]*"|\\.|[' + string.replace(atom,'#',r'\#') + r'@.,:])+'
+
+    mail_re = re.compile(r'''\s*FROM:\s*(?P<path><> # Empty <>
+                         |<''' + qstring + r'''> # <addr>
+			 |''' + qstring + r''' # addr
+			 )\s*(\s(?P<opts>.*))? # Optional WS + ESMTP options
+			 $''',re.I|re.X)
+    rcpt_re = re.compile(r'\s*TO:\s*(?P<path><' + qstring + r'''> # <addr>
+                         |''' + qstring + r''' # addr
+			 )\s*(\s(?P<opts>.*))? # Optional WS + ESMTP options
+			 $''',re.I|re.X)
+
     def do_MAIL(self, rest):
-        from_ = rest[len("MAIL:<"):-len(">")]
-        self.validateFrom(self.__helo, from_, self._fromValid,
-                                              self._fromInvalid)
+        if self.__from:
+            self.sendCode(503,"Only one sender per message, please")
+            return
+        # Clear old recipient list
+        self.__to = []
+        m = self.mail_re.match(rest)
+        if not m:
+            self.sendCode(501, "Syntax error")
+            return
 
-    def _fromValid(self, from_):
+        try:
+            addr = Address(m.group('path'))
+        except AddressError, e:
+            self.sendCode(553, str(e))
+            return
+            
+        self.validateFrom(self.__helo, addr, self._fromValid,
+                          self._fromInvalid)
+
+    def _fromValid(self, from_, code=250, msg='From address accepted'):
         self.__from = from_
-        self.sendCode(250, 'From address accepted')
+        self.sendCode(code, msg)
 
-    def _fromInvalid(self, from_):
-        self.sendCode(550, 'No mail for you!')
+    def _fromInvalid(self, from_, code=550, msg='No mail for you!'):
+        self.sendCode(code,msg)
 
     def do_RCPT(self, rest):
-        to = rest[len("TO:<"):-len(">")]
-        user = User(to, self.__helo, self, self.__from)
-        self.validateTo(user, self._toValid, self._toInvalid)
+        if not self.__from:
+            self.sendCode(503, "Must have sender before recipient")
+            return
+        m = self.rcpt_re.match(rest)
+        if not m:
+            self.sendCode(501, "Syntax error")
+            return
 
-    def _toValid(self, to):
-        self.__to = self.__to + (to,)
-        self.sendCode(250, 'Address recognized')
+        try:
+            user = User(m.group('path'), self.__helo, self, self.__from)
+        except AddressError, e:
+            self.sendCode(553, str(e))
+            return
+            
+        self.validateTo(user, self._toValid, self._toInvalid)
 
-    def _toInvalid(self, to):
-        self.sendCode(550, 'Cannot receive for specified address')
+    def _toValid(self, to, code=250, msg='Address recognized'):
+        self.__to.append(to)
+        self.sendCode(code, msg)
+
+    def _toInvalid(self, to, code=550,
+                   msg='Cannot receive for specified address'):
+        self.sendCode(code, msg)
 
     def do_DATA(self, rest):
         if self.__from is None or not self.__to:  
-            self.sendCode(550, 'Must have valid receiver and originator')
+            self.sendCode(503, 'Must have valid receiver and originator')
             return
         self.mode = DATA
         helo, origin, recipients = self.__helo, self.__from, self.__to
         self.__from = None
-        self.__to = ()
+        self.__to = []
         self.__messages = self.startMessage(recipients)
+        self.__inheader = self.__inbody = 0
+        for message in self.__messages:
+            message.lineReceived(self.receivedHeader(helo, origin, recipients))
         self.sendCode(354, 'Continue')
 
     def connectionLost(self, reason):
+        # self.sendCode(421, 'Dropping connection.') # This does nothing...
+        # Ideally, if we (rather than the other side) lose the connection,
+        # we should be able to tell the other side that we are going away.
+        # RFC-2821 requires that we try.
         if self.mode is DATA:
-            for message in self.__messages:
-                message.connectionLost()
+            try:
+                for message in self.__messages:
+                    message.connectionLost()
+                del self.__messages
+            except AttributeError:
+                pass
 
     def do_RSET(self, rest):
-        self.__init__()
+        self.__from = None
+        self.__to = []
         self.sendCode(250, 'I remember nothing.')
 
     def dataLineReceived(self, line):
@@ -177,8 +357,24 @@
                     deferred = message.eomReceived()
                     deferred.addCallback(ndeferred.callback)
                     deferred.addErrback(ndeferred.errback)
+                del self.__messages
                 return
             line = line[1:]
+
+        # Add a blank line between the generated Received:-header
+        # and the message body if the message comes in without any
+        # headers
+        if not self.__inheader and not self.__inbody:
+            if ':' in line:
+                self.__inheaders = 1
+            elif line:
+                for message in self.__messages:
+                    message.lineReceived('')
+                self.__inbody = 1
+
+        if not line:
+            self.__inbody = 1
+        
         for message in self.__messages:
             message.lineReceived(line)
 
@@ -188,8 +384,27 @@
     def _messageNotHandled(self, _):
         self.sendCode(550, 'Could not send e-mail')
 
+    def rfc822date(self):
+        timeinfo = time.localtime()
+        if timeinfo[8]:
+            # DST
+            tz = -time.altzone
+        else:
+            tz = -time.timezone
+            
+        return "%s %+2.2d%2.2d" % (
+            time.strftime("%a, %d %b %Y %H:%M:%S", timeinfo),
+            tz / 3600, (tz / 60) % 60)
+
     # overridable methods:
+    def receivedHeader(self, helo, origin, recipents):
+        return "Received: From %s ([%s]) by %s; %s" % (
+            helo[0], helo[1], self.host, self.rfc822date())
+    
     def validateFrom(self, helo, origin, success, failure):
+        if not helo:
+            failure(origin,503,"Who are you? Say HELO first");
+            return
         success(origin)
 
     def validateTo(self, user, success, failure):
@@ -265,6 +480,7 @@
         
     def smtpCode_354_data(self, line):
         self.mailFile = self.getMailData()
+        self.lastsent = ''
         self.transport.registerProducer(self, 0)
 
     def smtpCode_250_afterData(self, line):
@@ -277,11 +493,18 @@
         chunk = self.mailFile.read(8192)
         if not chunk:
             self.transport.unregisterProducer()
-            self.sendLine('.')
+            if self.lastsent != '\n':
+                line = '\r\n.'
+            else:
+                line = '.'
+            self.sendLine(line)
             self.state = 'afterData'
+            return
 
         chunk = string.replace(chunk, "\n", "\r\n")
+        chunk = string.replace(chunk, "\r\n.", "\r\n..")
         self.transport.write(chunk)
+        self.lastsent = chunk[-1]
 
     def pauseProducing(self):
         pass
Index: twisted/test/test_protocols.py
===================================================================
RCS file: /cvs/Twisted/twisted/test/test_protocols.py,v
retrieving revision 1.17
diff -u -u -r1.17 test_protocols.py
--- twisted/test/test_protocols.py	23 Sep 2002 08:51:29 -0000	1.17
+++ twisted/test/test_protocols.py	31 Oct 2002 20:25:04 -0000
@@ -33,11 +33,13 @@
 class LineTester(basic.LineReceiver):
 
     delimiter = '\n'
+    MAX_LENGTH = 64
 
     def connectionMade(self):
         self.received = []
 
     def lineReceived(self, line):
+        print self.MAX_LENGTH, len(line)
         self.received.append(line)
         if line == '':
             self.setRawMode()
@@ -51,6 +53,10 @@
         if self.length == 0:
             self.setLineMode(rest)
 
+    def lineLengthExceeded(self, line):
+        if len(line) > self.MAX_LENGTH+1:
+            self.setLineMode(line[self.MAX_LENGTH+1:])
+
 class WireTestCase(unittest.TestCase):
 
     def testEcho(self):
@@ -103,13 +109,14 @@
 012345678len 0
 foo 5
 
+1234567890123456789012345678901234567890123456789012345678901234567890
 len 1
 
 a'''
 
     output = ['len 10', '0123456789', 'len 5', '1234\n',
               'len 20', 'foo 123', '0123456789\n012345678',
-              'len 0', 'foo 5', '', 'len 1', 'a']
+              'len 0', 'foo 5', '', '67890', 'len 1', 'a']
 
     def testBuffer(self):
         for packet_size in range(1, 10):
@@ -175,3 +182,6 @@
             r.dataReceived(s)
             if not r.brokenPeer:
                 raise AssertionError("connection wasn't closed on illegal netstring %s" % repr(s))
+
+if __name__ == '__main__':
+    unittest.main()
Index: twisted/test/test_smtp.py
===================================================================
RCS file: /cvs/Twisted/twisted/test/test_smtp.py,v
retrieving revision 1.16
diff -u -u -r1.16 test_smtp.py
--- twisted/test/test_smtp.py	6 Sep 2002 09:09:42 -0000	1.16
+++ twisted/test/test_smtp.py	31 Oct 2002 20:25:04 -0000
@@ -26,7 +26,7 @@
 from twisted.protocols import loopback, smtp
 from twisted.internet import defer, protocol
 from twisted.test.test_protocols import StringIOWithoutClosing
-import string
+import string, re
 from cStringIO import StringIO
 
 class DummyMessage:
@@ -195,15 +195,17 @@
         self.buffer = []
 
     def lineReceived(self, line):
-        self.buffer.append(line)
+        # Throw away the generated Received: header
+        if not re.match('Received: From foo.com \(\[.*\]\) by foo.com;', line):
+            self.buffer.append(line)
 
     def eomReceived(self):
         message = string.join(self.buffer, '\n')+'\n'
-        helo, origin = self.users[0].helo, self.users[0].orig
+        helo, origin = self.users[0].helo[0], str(self.users[0].orig)
         recipients = []
         for user in self.users:
-            recipients.append(user.name+'@'+user.domain)
-        self.protocol.messages.append((helo, origin, recipients, message))
+            recipients.append(str(user))
+        self.protocol.message = (helo, origin, recipients, message)
         deferred = defer.Deferred()
         deferred.callback("saved")
         return deferred
@@ -212,51 +214,84 @@
 
     def connectionMade(self):
         smtp.SMTP.connectionMade(self)
-        self.messages = []
+        self.message = None
 
     def startMessage(self, users):
         return [DummySMTPMessage(self, users)]
 
-
 class AnotherSMTPTestCase(unittest.TestCase):
 
-    messages = [ ('foo.com', 'moshez at foo.com', ['moshez at bar.com'], '''\
+    messages = [ ('foo.com', 'moshez at foo.com', ['moshez at bar.com'],
+                  'moshez at foo.com', ['moshez at bar.com'], '''\
 From: Moshe
 To: Moshe
 
 Hi,
 how are you?
 '''),
-                 ('foo.com', 'tttt at rrr.com', ['uuu at ooo', 'yyy at eee'], '''\
+                 ('foo.com', 'tttt at rrr.com', ['uuu at ooo', 'yyy at eee'],
+                  'tttt at rrr.com', ['uuu at ooo', 'yyy at eee'], '''\
 Subject: pass
 
 ..rrrr..
-''')
+'''),
+                 ('foo.com', '@this, at is, at ignored:foo at bar.com',
+                  ['@ignore, at this, at too:bar at foo.com'],
+                  'foo at bar.com', ['bar at foo.com'], '''\
+Subject: apa
+To: foo
+
+123
+.
+456
+'''),
               ]
 
-    expected_output = '220 Spammers beware, your ass is on fire\015\012250 Nice to meet you\015\012250 From address accepted\015\012250 Address recognized\015\012354 Continue\015\012250 Delivery in progress\015\012250 From address accepted\015\012250 Address recognized\015\012250 Address recognized\015\012354 Continue\015\012250 Delivery in progress\015\012221 See you later\015\012'
-
-    input = 'HELO foo.com\r\n'
-    for _, from_, to_, message in messages:
-        input = input + 'MAIL FROM:<%s>\r\n' % from_
-        for item in to_:
-            input = input + 'RCPT TO:<%s>\r\n' % item
-        input = input + 'DATA\r\n'
-        for line in string.split(message, '\n')[:-1]:
-            if line[:1] == '.': line = '.' + line
-            input = input + line + '\r\n'
-        input = input + '.' + '\r\n'
-    input = input + 'QUIT\r\n'
+    testdata = [
+        ('', '220.*\r\n$', None, None),
+        ('HELO foo.com\r\n', '250.*\r\n$', None, None),
+        ('RSET\r\n', '250.*\r\n$', None, None),
+        ]
+    for helo_, from_, to_, realfrom, realto, msg in messages:
+        testdata.append(('MAIL FROM:<%s>\r\n' % from_, '250.*\r\n',
+                         None, None))
+        for rcpt in to_:
+            testdata.append(('RCPT TO:<%s>\r\n' % rcpt, '250.*\r\n',
+                             None, None))
+        testdata.append(('DATA\r\n','354.*\r\n',
+                         msg, ('250.*\r\n',
+                               (helo_, realfrom, realto, msg))))
+                                                       
 
     def testBuffer(self):
         output = StringIOWithoutClosing()
         a = DummySMTP()
-        a.makeConnection(protocol.FileWrapper(output))
-        a.dataReceived(self.input)
-        if a.messages != self.messages:
-            raise AssertionError(a.messages)
-        if output.getvalue() != self.expected_output:
-            raise AssertionError(`output.getvalue()`)
+        class fooFactory:
+            domain = 'foo.com'
 
+        a.factory = fooFactory()
+        a.makeConnection(protocol.FileWrapper(output))
+        for (send, expect, msg, msgexpect) in self.testdata:
+            if send:
+                a.dataReceived(send)
+            data = output.getvalue()
+            output.truncate(0)
+            if not re.match(expect, data):
+                raise AssertionError, (send, expect, data)
+            if data[:3] == '354':
+                for line in msg.splitlines():
+                    if line and line[0] == '.':
+                        line = '.' + line
+                    a.dataReceived(line + '\r\n')
+                a.dataReceived('.\r\n')
+                # Special case for DATA. Now we want a 250, and then
+                # we compare the messages
+                data = output.getvalue()
+                output.truncate()
+                resp, msgdata = msgexpect
+                if not re.match(resp, data):
+                    raise AssertionError, (resp, data)
+                if a.message != msgdata:
+                    raise AssertionError, (msgdata, a.message)
 
 testCases = [SMTPTestCase, SMTPClientTestCase, LoopbackSMTPTestCase, AnotherSMTPTestCase]

From liiwi at lonesom.pp.fi  Thu Oct 31 10:24:16 2002
From: liiwi at lonesom.pp.fi (Jaakko Niemi)
Date: Thu, 31 Oct 2002 17:24:16 +0200
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030.210658.59655039.glyph@twistedmatrix.com> (Glyph
 Lefkowitz's message of "Wed, 30 Oct 2002 21:06:58 -0600 (CST)")
References: <20021030.173450.63128778.glyph@twistedmatrix.com>
	<20021030235138.P6472-100000@nosferatu.kriln.com>
	<20021030.210658.59655039.glyph@twistedmatrix.com>
Message-ID: <87wunyein3.fsf@jumper.lonesom.pp.fi>

Glyph Lefkowitz <glyph at twistedmatrix.com> writes:

> On Wed, 30 Oct 2002 23:54:46 +0000 (GMT), Jeremy Noetzelman <jjn at kriln.com> wrote:
>> Personally, when I was running high volume web servers, we'd tune down the
>> keepalive timers to a fairly short interval to keep sockets from getting
>> tied up too long, to prevent resource availability issues that we were
>> seeing.
>
> Just out of curiosity, how does one configure this timeout with apache?

 Look at the Timeout and KeepAlive directives in httpd.conf or apache docs.
 Basically either timeout or max # of requests, and connection will be cut.

 As for 2.4 kernels, check Documentation/networking/ip-sysctl.txt and 
 tcp_keepalive_* there. Note: if you drop this to short value at tm.com,
 ssh users will hate you :)

                --j



From tool_man at spamcop.net  Thu Oct 31 11:00:04 2002
From: tool_man at spamcop.net (Tim Lavoie)
Date: Thu, 31 Oct 2002 10:00:04 -0600
Subject: [Twisted-Python] Twisted-Python digest, Vol 1 #487 - 14 msgs
In-Reply-To: <20021031061401.19966.3766.Mailman@pyramid.twistedmatrix.com>
References: <20021031061401.19966.3766.Mailman@pyramid.twistedmatrix.com>
Message-ID: <15809.21380.349785.273907@theasylum.dyndns.org>

>>>>> "glyph" == twisted-python-request  <twisted-python-request at twistedmatrix.com> writes:

 [re socket timeouts]

    glyph> <jjn at kriln.com> wrote:
    >> Personally, when I was running high volume web servers, we'd
    >> tune down the keepalive timers to a fairly short interval to
    >> keep sockets from getting tied up too long, to prevent resource
    >> availability issues that we were seeing.

    glyph> Just out of curiosity, how does one configure this timeout
    glyph> with apache?


Actually, there are a few timeout flags which can be set in Apache,
depending on how specific you want. TimeOut (300 sec default) is the
overall one which fails requests with nothing happening. There is also
DavMinTimeout (0), KeepAliveTimeout (15), and ProxyTimeout(300).

  Tim  (aka Spudnik)



From johnfabel at btinternet.com  Thu Oct 31 14:13:53 2002
From: johnfabel at btinternet.com (John Abel)
Date: Thu, 31 Oct 2002 19:13:53 -0000
Subject: [Twisted-Python] Proxy Server With Twisted
Message-ID: <006901c28132$655fcbc0$fd3f7ad5@hallows>

Hi,

I remember seeing something like this pass the list a while back, but I can't seem to find it.  I've been trying to write a simple proxy server for my two machines at home, using twisted.  I've tried using code I'd written for a simple NNTP server, as a base, but upon calling reactor.run(), I get "Proxy instance has no attribute 'doStart'".  I've tried using the app module, as a way of trying to run it, but haven't had much success there either.  Has anyone done this before?  Does anyone have any docs for doing this sort of thing?

Thanks

John
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20021031/4a582cf9/attachment.htm 

From alexander.levy at tufts.edu  Thu Oct 31 19:10:04 2002
From: alexander.levy at tufts.edu (Alex Levy)
Date: Thu, 31 Oct 2002 19:10:04 -0500
Subject: [Twisted-Python] 'model' attribute is showing up in processed HTML
Message-ID: <5.1.1.6.0.20021031190558.022e5e00@coral.tufts.edu>

The 'model' node attribute from my XHTML templates is showing up in the 
final HTML being spewed by twistd.  Is there a reason Twisted does 
this?  It's causing my pages to fail W3C validation.  This isn't happening 
with the 'view' attribute.

Example:

     <td class="sidebar" view="sidebar"></td>
     <td class="content">
         <div class="title" model="title"></div>
         <span model="content"/>
     </td>

...becomes:

     <td class="sidebar">{sidebar stuff...}</td>
     <td class="content">
         <div model="title" class="title">This is the title.</div>
         <span model="content">Content goes here.  w00t.</span>
     </td>

--
Alex Levy
WWW: http://mesozoic.geecs.org
Tel: 617.835.0778

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_





From dstone at kde.org  Thu Oct 31 21:55:28 2002
From: dstone at kde.org (Daniel Stone)
Date: Fri, 1 Nov 2002 13:55:28 +1100
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <1036081167.1571.40.camel@mingus>
References: <1036018639.692.74.camel@mingus> <20021030.210619.78707311.glyph@twistedmatrix.com> <1036081167.1571.40.camel@mingus>
Message-ID: <20021101025528.GA22758@trinity.unimelb.edu.au>

On Thu, Oct 31, 2002 at 11:19:28AM -0500, Abe Fettig scrawled:
> There are a couple of servers I'd like to use that aren't available in
> Twisted yet (to the best of my knowledge) - IMAP and WebDAV.  Is anyone
> working on implementing these?  If so, I'd be happy to help.

I am working on *a* WebDAV server which can make use of Twisted if one
desires, but Glyph is writing a WebDAV server for twisted, i.e. t.p.w.

-- 
Daniel Stone 	     <daniel at raging.dropbear.id.au>             <dstone at kde.org>
Developer - http://kopete.kde.org, http://www.kde.org
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20021101/5a6546d9/attachment.pgp 

From grolgh at online.no  Tue Oct  1 01:49:50 2002
From: grolgh at online.no (Benjamin Bruheim)
Date: Tue, 01 Oct 2002 09:49:50 +0200
Subject: [Twisted-Python] Re: [Twisted-commits] How do I serve PHP-files
 with twisted.web? Answered.
References: <E17w47M-00052h-00@pyramid.twistedmatrix.com> <20020930.160518.59650770.glyph@twistedmatrix.com>
Message-ID: <3D99539E.6050108@online.no>

Glyph Lefkowitz wrote:
>>How do I serve PHP-files with twisted.web? Answered.
> This answer appears to be unnecessarily complex and confusing, when the user
> could just do "mktap web --path . --allow-ignore-ext" and get the same effect.
> (You probably want --index index.php too.) Is there any particular reason you
> answered that way? :)

Because it has been asked at least three times. :) Perhaps it could be 
changed into "how do I create a resource that serves PHP-Files", because 
the "create webserver"-part is explained a lot better other places. But 
I just wanted a complete example where just one line could be changed.

And, to do this in updateApplication:
resource.processors[".php"] = twcgi.PHPScript
Would not be saved in the tap, which is why I solved it this way. After 
all, I think if you're developing this is the info you would be 
interested in.

\\ benjamin bruheim




From glyph at twistedmatrix.com  Tue Oct  1 02:21:39 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 01 Oct 2002 03:21:39 -0500 (CDT)
Subject: [Twisted-Python] Re: [Twisted-commits] How do I serve
 PHP-files with twisted.web? Answered.
In-Reply-To: <3D99539E.6050108@online.no>
References: <E17w47M-00052h-00@pyramid.twistedmatrix.com>
	<20020930.160518.59650770.glyph@twistedmatrix.com>
	<3D99539E.6050108@online.no>
Message-ID: <20021001.032139.08318550.glyph@twistedmatrix.com>

On Tue, 01 Oct 2002 09:49:50 +0200, Benjamin Bruheim <grolgh at online.no> wrote:
> Glyph Lefkowitz wrote:
> >>How do I serve PHP-files with twisted.web? Answered.
> > This answer appears to be unnecessarily complex and confusing, when the user
> > could just do "mktap web --path . --allow-ignore-ext" and get the same effect.
> > (You probably want --index index.php too.) Is there any particular reason you
> > answered that way? :)
> 
> Because it has been asked at least three times. :)

If the specific question is the one you're answering, then it's too complex an
answer.  If people actually want the answer you gave, then the question should
be changed :).

> Perhaps it could be changed into "how do I create a resource that serves
> PHP-Files", because the "create webserver"-part is explained a lot better
> other places.

Maybe it should be two FAQs, if indeed the second one is "frequently" asked
(which seems strange to me): "1. How do I create a webserver with Twisted Web
that serves PHP files?" and "2. How do I programatically create a webserver
resource like the one I get from 'mktap web'?"

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021001/3d1aa29f/attachment.sig>

From m at moshez.org  Tue Oct  1 03:02:27 2002
From: m at moshez.org (Moshe Zadka)
Date: 1 Oct 2002 09:02:27 -0000
Subject: [Twisted-Python] Improvements to twisted.protocols.smtp
In-Reply-To: <200209301501.g8UF1a9u001275@fido.strakt.com>
References: <200209301501.g8UF1a9u001275@fido.strakt.com>
Message-ID: <20021001090227.2568.qmail@green.zadka.com>

I promised I'll detail my problems with the patch.
I'll try to check something in this weekend, maybe these problems.
 
> Index: twisted/protocols/basic.py

I'd hesitate to touch protocols.basic without a unit test for this
feature.

> Index: twisted/protocols/smtp.py

I have a general problem here: the REs are very complicated and undocumented.
Please use re.X and comment the RE

> -class User:
> +class User(Address):

I'd prefer containment rather than inclusion here.

> -    def __init__(self):
> +    def __init__(self, domain=None, timeout=600):
>          self.mode = COMMAND
>          self.__from = None
>          self.__helo = None
> -        self.__to = ()
> +        self.__to = []
> +        self.timeout = timeout
> +        if not domain:
> +            import socket
> +            domain = socket.getfqdn()
> +        self.host = domain

this is wrong. the domain name should be in the protocol factory, not
in the protocol

> +        self.timeoutID = reactor.callLater(self.timeout, self.timedout)

please allow a timeout of "None" to mean "no timeouts"

> +            del self.__messages
> +        self.sendCode(500, 'Line too long')

this seems like it wouldn't work. the client would send the rest of the long
line, which look like a beginning of a command

>      def do_MAIL(self, rest):
> -        from_ = rest[len("MAIL:<"):-len(">")]
> -        self.validateFrom(self.__helo, from_, self._fromValid,
> -                                              self._fromInvalid)
> +        if not self.__helo:
> +            self.sendCode(503,"Who are you? Say HELO first");

be liberal, at least in the framework. if a user wants to allow
nonusing of helo, he should be free to do this. you can enforce helo
in validateFrom

> -        self.__init__()
> +        self.__from = None
> +        self.__to = []
>          self.sendCode(250, 'I remember nothing.')
what about __messages?





From bruce at cubik.org  Tue Oct  1 03:44:37 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 01 Oct 2002 03:44:37 -0600
Subject: [Twisted-Python] Bugs in epydoc API docs.
References: <20021001054107.GC24410@ritsuko.xware.cx>
Message-ID: <3D996E85.8040107@cubik.org>

Andrew Bennetts wrote:
> E.g.
> http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.99.2/twisted.internet.protocol.Protocol.html
> 
> Note the bug starting at connectionLost's description; the HTML source
> looks like this:
> 
> <a NAME="connectionLost"/>
> <h3>connectionLost</h3>
> <code><b>connectionLost(self, reason=<twisted.python.failure.Failure twisted.internet.error.Co...)</B></code><p>
> 
> Which is obviously not quite right... it leads to the rest of the page being bolded.

I'll look into that later.

> Also, in 0.99.2alpha3's docs (sorry, no link for you, just looking in the docs
> in moshez's debian package), in twisted.internet.protocol.html, this line is
> rendered without a hyperlink:
> 
>    Maintainer: U{Itamar Shtull-Trauring<mailto:twisted at itamarst.org>}
> 
> Is this a bug in epydoc, or Twisted's use of epydoc?

This is probably because there were epydoc markup errors in that block, 
so it went and made all or part of the block into a pre-formatted thing. 
  Twisted still has many many warnings and errors from epydoc that need 
to be fixed to eliminate problems like that.

  - Bruce




From robert at vaccaperna.co.uk  Tue Oct  1 04:42:46 2002
From: robert at vaccaperna.co.uk (Robert Cowham)
Date: Tue, 1 Oct 2002 11:42:46 +0100
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <20021001102401.18511.59760.Mailman@pyramid.twistedmatrix.com>
Message-ID: <PJEEINAIADEEJBLOMLGIEEEJCLAA.robert@vaccaperna.co.uk>

Hi

I have a build problem on the above platform combination:

C:\Download\Twisted-0.99.3alpha2\Twisted-0.99.3alpha2>python setup.py
build_ext
running build_ext
The C reactor is unavailable on this system.
checking for rpc/pmap_clnt.h ...
conftest.c
conftest.c(1) : fatal error C1083: Cannot open include file:
'rpc/pmap_clnt.h':
No such file or directory
The C reactor is unavailable on this system.
skipping 'twisted.spread.cBanana' extension (up-to-date)
skipping 'twisted.spread.cBanana' extension (up-to-date)

Is there any workaround for this?

I have also tried 0.99.2 and it has same problem.

Thanks
Robert




From andrew-twisted at puzzling.org  Tue Oct  1 04:58:20 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 1 Oct 2002 20:58:20 +1000
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <PJEEINAIADEEJBLOMLGIEEEJCLAA.robert@vaccaperna.co.uk>
References: <20021001102401.18511.59760.Mailman@pyramid.twistedmatrix.com> <PJEEINAIADEEJBLOMLGIEEEJCLAA.robert@vaccaperna.co.uk>
Message-ID: <20021001105820.GA671@frobozz.local>

On Tue, Oct 01, 2002 at 11:42:46AM +0100, Robert Cowham wrote:
> Hi
> 
> I have a build problem on the above platform combination:
> 
> C:\Download\Twisted-0.99.3alpha2\Twisted-0.99.3alpha2>python setup.py
> build_ext
> running build_ext
> The C reactor is unavailable on this system.
> checking for rpc/pmap_clnt.h ...
> conftest.c
> conftest.c(1) : fatal error C1083: Cannot open include file:
> 'rpc/pmap_clnt.h':
> No such file or directory

That's telling you don't have Sun-RPC support, which is only used by
twisted.inetd to run rpc services.  Basically, on Windows you won't miss it.
Hell, most Twisted users wouldn't miss it either :)

> skipping 'twisted.spread.cBanana' extension (up-to-date)
> skipping 'twisted.spread.cBanana' extension (up-to-date)

This is probably the most valuable of the C extensions in terms of speed
gain, and it works fine on Windows, as you can see here :)

> The C reactor is unavailable on this system.

This is because the C reactor uses poll (rather than select), which isn't
provided by Windows' sockets API.

You'll be limited to using the pure python reactors instead, which work just
fine, but are marginally slower.

Basically, don't sweat about it :)

-Andrew.




From robert at vaccaperna.co.uk  Tue Oct  1 05:13:58 2002
From: robert at vaccaperna.co.uk (Robert Cowham)
Date: Tue, 1 Oct 2002 12:13:58 +0100
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <20021001105820.GA671@frobozz.local>
Message-ID: <PJEEINAIADEEJBLOMLGIEEEPCLAA.robert@vaccaperna.co.uk>

> You'll be limited to using the pure python reactors instead,
> which work just
> fine, but are marginally slower.
>
> Basically, don't sweat about it :)
>

Thanks for the prompt response.

I tried running the portforward tap and it didn't work, which is why I then
looked at any build errors and found the above.

It gives me the following:

C:\Download\Twisted_NoDocs-0.99.2\Twisted-0.99.2\bin>python twistd -f
portforwar
d.tap
01/10/2002 12:12 [-] Log opened.
01/10/2002 12:12 [-] twistd 0.99.2 (C:\Python22\python.exe 2.2.1) starting
up
01/10/2002 12:12 [-] license user: Nobody <>
01/10/2002 12:12 [-] organization: No Organization
01/10/2002 12:12 [-] reactor class: twisted.internet.default.SelectReactor
01/10/2002 12:12 [-] Loading portforward.tap...
01/10/2002 12:12 [-] Loaded.
01/10/2002 12:12 [*portforward*] twisted.protocols.portforward.ProxyFactory
star
ting on 1555
01/10/2002 12:12 [*portforward*] Starting factory
<twisted.protocols.portforward
.ProxyFactory instance at 0x009C35C8>
01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory]
C:\Download\Twiste
d_NoDocs-0.99.2\Twisted-0.99.2\twisted\protocols\portforward.py:47:
DeprecationW
arning: clientTCP is deprecated - use connectTCP instead.
01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory]
clientProtocol)
01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory] Starting
factory <
twisted.internet.base.BCFactory instance at 0x00A0D2F8>
01/10/2002 12:13 [ProxyServer,0,127.0.0.1] Traceback (most recent call
last):
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\app.py", line 573, in run
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]
main.run(installSignalHandlers=in
stallSignalHandlers)
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\main.py", line 101, in run
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     _getReactor().run()
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\default.py", line 221, in run
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     self.mainLoop()
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\default.py", line 232, in mainLoop
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     self.doIteration(t)
01/10/2002 12:13 [ProxyServer,0,127.0.0.1] --- <exception caught here> ---
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\default.py", line 503, in doSelect
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     why = getattr(selectable,
method)
()
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\internet\tcp.py", line 103, in doRead
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     return
self.protocol.dataReceived
(data)
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]   File
"C:\Download\Twisted_NoDocs-0.
99.2\Twisted-0.99.2\twisted\protocols\portforward.py", line 36, in
dataReceived
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]     self.peer.write(data)
01/10/2002 12:13 [ProxyServer,0,127.0.0.1] exceptions.AttributeError:
BCFactory
instance has no attribute 'write'
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]
C:\Download\Twisted_NoDocs-0.99.2\Twi
sted-0.99.2\twisted\internet\base.py:392: DeprecationWarning:
connectionFailed i
s deprecated.  See new Client API
01/10/2002 12:13 [ProxyServer,0,127.0.0.1]
self.protocol.connectionFailed()
01/10/2002 12:13 [ProxyServer,0,127.0.0.1] Stopping factory
<twisted.internet.ba
se.BCFactory instance at 0x00A0D2F8>
01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory] (Port 1555
Closed)

01/10/2002 12:13 [twisted.protocols.portforward.ProxyFactory] Stopping
factory <
twisted.protocols.portforward.ProxyFactory instance at 0x009C35C8>
01/10/2002 12:13 [*portforward*] Saving portforward application to
portforward-s
hutdown.tap...
01/10/2002 12:13 [*portforward*] Saved.
01/10/2002 12:13 [*portforward*] Main loop terminated.
01/10/2002 12:13 [-] Server Shut Down.

C:\Download\Twisted_NoDocs-0.99.2\Twisted-0.99.2\bin>

Robert




From andrew-twisted at puzzling.org  Tue Oct  1 05:50:36 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 1 Oct 2002 21:50:36 +1000
Subject: [Twisted-Python] PATCH: OS X and Twisted
Message-ID: <20021001115036.GB671@frobozz.local>

This patch is from a friend of mine running OS X... this still doesn't make
the C extensions build, but at least it freaks out less.  It's a patch to
distutils.

Apparently OS X doesn't have a <poll.h>, although Fink distributes one, but
that installs to a non-standard location.  Basically, it looks like OS X
support for the C modules will be messy.


--- unixccompiler.py.bak        Sun Sep  1 19:17:42 2002
+++ unixccompiler.py    Tue Oct  1 21:29:43 2002
@@ -98,6 +98,8 @@
         (_, macros, include_dirs) = \
             self._fix_compile_args(None, macros, include_dirs)
         pp_opts = gen_preprocess_options(macros, include_dirs)
+       if sys.platform == "darwin":
+               pp_opts += ["-traditional-cpp"]
         pp_args = self.preprocessor + pp_opts
         if output_file:
             pp_args.extend(['-o', output_file])
@@ -134,6 +136,8 @@
 
         # Figure out the options for the compiler command line.
         pp_opts = gen_preprocess_options(macros, include_dirs)
+       if sys.platform == "darwin":
+               pp_opts += ["-traditional-cpp"]
         cc_args = pp_opts + ['-c']
         if debug:
             cc_args[:0] = ['-g']


-Andrew.




From twisted at moshez.org  Tue Oct  1 06:32:19 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 1 Oct 2002 12:32:19 -0000
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <PJEEINAIADEEJBLOMLGIEEEPCLAA.robert@vaccaperna.co.uk>
References: <PJEEINAIADEEJBLOMLGIEEEPCLAA.robert@vaccaperna.co.uk>
Message-ID: <20021001123219.4845.qmail@green.zadka.com>

On Tue, 1 Oct 2002, "Robert Cowham" <robert at vaccaperna.co.uk> wrote:

> I tried running the portforward tap and it didn't work, which is why I then
> looked at any build errors and found the above.

portforwarder recovers pretty badly from failed connection.
The CVS version should work much better, or just wait for 0.99.3 release
candidates.





From robert at vaccaperna.co.uk  Tue Oct  1 07:07:11 2002
From: robert at vaccaperna.co.uk (Robert Cowham)
Date: Tue, 1 Oct 2002 14:07:11 +0100
Subject: [Twisted-Python] RE: Problem with build on winxp/VC6
In-Reply-To: <20021001123219.4845.qmail@green.zadka.com>
Message-ID: <PJEEINAIADEEJBLOMLGIKEFFCLAA.robert@vaccaperna.co.uk>

Thanks

> -----Original Message-----
> From: twisted-python-admin at twistedmatrix.com
> [mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Moshe Zadka
> Sent: 01 October 2002 13:32
> To: twisted-python at twistedmatrix.com
> Subject: RE: [Twisted-Python] RE: Problem with build on winxp/VC6
> 
> 
> On Tue, 1 Oct 2002, "Robert Cowham" <robert at vaccaperna.co.uk> wrote:
> 
> > I tried running the portforward tap and it didn't work, which 
> is why I then
> > looked at any build errors and found the above.
> 
> portforwarder recovers pretty badly from failed connection.
> The CVS version should work much better, or just wait for 0.99.3 release
> candidates.
> 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 



From bruce at cubik.org  Tue Oct  1 07:20:52 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 01 Oct 2002 07:20:52 -0600
Subject: [Twisted-Python] Bugs in epydoc API docs.
References: <20021001054107.GC24410@ritsuko.xware.cx>
Message-ID: <3D99A134.90405@cubik.org>

Andrew Bennetts wrote:
> E.g.
> http://twistedmatrix.com/documents/TwistedDocs/Twisted-0.99.2/twisted.internet.protocol.Protocol.html
> 
> Note the bug starting at connectionLost's description; the HTML source
> looks like this:
> 
> <a NAME="connectionLost"/>
> <h3>connectionLost</h3>
> <code><b>connectionLost(self, reason=<twisted.python.failure.Failure twisted.internet.error.Co...)</B></code><p>
> 
> Which is obviously not quite right... it leads to the rest of the page being bolded.

Well, that's really old epydoc output.

The </B> thing is no longer an issue.  The leading '<' after the reason= 
is still a problem though.  A patch to epydoc is welcome, otherwise, 
I'll keep it on my list of things to look at fixing.

  - Bruce




From bob at redivi.com  Tue Oct  1 06:16:49 2002
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 1 Oct 2002 08:16:49 -0400
Subject: [Twisted-Python] PATCH: OS X and Twisted
In-Reply-To: <20021001115036.GB671@frobozz.local>
Message-ID: <A9166FC5-D537-11D6-9AD3-0003938210D6@redivi.com>

On Tuesday, October 1, 2002, at 07:50 AM, Andrew Bennetts wrote:

> This patch is from a friend of mine running OS X... this still doesn't 
> make
> the C extensions build, but at least it freaks out less.  It's a patch 
> to
> distutils.
>
> Apparently OS X doesn't have a <poll.h>, although Fink distributes 
> one, but
> that installs to a non-standard location.  Basically, it looks like OS 
> X
> support for the C modules will be messy.

http://www.clapper.org/software/poll/ is what I use.. I don't have fink 
installed anymore.

-bob




From twisted at moshez.org  Tue Oct  1 12:07:17 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 1 Oct 2002 18:07:17 -0000
Subject: [Twisted-Python] clientTCP
Message-ID: <20021001180717.7560.qmail@green.zadka.com>

The following files still use clientTCP, and shouldn't:

./doc/examples/ftpclient.py
./doc/examples/qtdemo.py
./twisted/im/ircsupport.py
./twisted/im/tocsupport.py
./twisted/mail/relaymanager.py
./twisted/names/dns.py
./twisted/protocols/irc.py
./twisted/protocols/oscar.py
./twisted/protocols/socks.py
./twisted/protocols/toc.py
./twisted/spread/ui/tkutil.py





From iko at cd.chalmers.se  Tue Oct  1 17:05:26 2002
From: iko at cd.chalmers.se (Anders Hammarquist)
Date: Wed, 02 Oct 2002 01:05:26 +0200
Subject: [Twisted-Python] Improvements to twisted.protocols.smtp 
In-Reply-To: Message from Moshe Zadka <m@moshez.org> 
   of "01 Oct 2002 09:02:27 -0000." <20021001090227.2568.qmail@green.zadka.com> 
References: <200209301501.g8UF1a9u001275@fido.strakt.com> <20021001090227.2568.qmail@green.zadka.com> 
Message-ID: <200210012305.BAA29435@haddock.cd.chalmers.se>

In a message of 01 Oct 2002 09:02:27 -0000, Moshe Zadka writes:
>> Index: twisted/protocols/smtp.py
>
>I have a general problem here: the REs are very complicated and undocumen
>ted.
>Please use re.X and comment the RE

Ok, they can probably be improved as well. I'll look over them some more.

>> -class User:
>> +class User(Address):
>
>I'd prefer containment rather than inclusion here.

Any particular reason? I don't feel strongly either way...

>> +            del self.__messages
>> +        self.sendCode(500, 'Line too long')
>
>this seems like it wouldn't work. the client would send the rest of the
>long line, which look like a beginning of a command

You're right, of course. Setting raw mode and reading until we see
a newline should fix it. I guess the fact that sendmail gets this
wrong too is no excuse ;-)

>> +        if not self.__helo:
>> +            self.sendCode(503,"Who are you? Say HELO first");
>
>be liberal, at least in the framework. if a user wants to allow
>nonusing of helo, he should be free to do this. you can enforce helo
>in validateFrom

Right

>> -        self.__init__()
>> +        self.__from = None
>> +        self.__to = []
>>          self.sendCode(250, 'I remember nothing.')
>what about __messages?

It's only valid inside a DATA command, so it's not around to be
reset.

I'll integrate your thoughts and send a new patch in a few days.

/Anders

-- 
 -- Of course I'm crazy, but that doesn't mean I'm wrong.
Anders Hammarquist                                  | iko at cd.chalmers.se
Physics student, Chalmers University of Technology, | Hem: +46 31 88 48 50
G|teborg, Sweden.           RADIO: SM6XMM and N2JGL | Mob: +46 707 27 86 87



From twisted at moshez.org  Tue Oct  1 20:31:41 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 2 Oct 2002 02:31:41 -0000
Subject: [Twisted-Python] tkutil
Message-ID: <20021002023141.11996.qmail@green.zadka.com>

moshez at darjeeling:~/prog/src/twisted/cvs/Twisted$ find . -name "*.py"|xargs grep tkutil|grep -v gtkutil
moshez at darjeeling:~/prog/src/twisted/cvs/Twisted$ grep clientTCP twisted/spread/ui/tkutil.py
        reactor.clientTCP(host, port, b)

To sum up: an unused file using a deprecated API.
Anyone mind if I remove it?




From twisted at moshez.org  Wed Oct  2 09:09:18 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 2 Oct 2002 15:09:18 -0000
Subject: [Twisted-Python] oscar.py uses deprecated APIs
Message-ID: <20021002150918.20025.qmail@green.zadka.com>

oscar.py uses the following depercated APIs:

* clientTCP
* connectionFailed

Please fix those ASAP 



From twisted at moshez.org  Wed Oct  2 09:13:47 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 2 Oct 2002 15:13:47 -0000
Subject: [Twisted-Python] More Deprecations
Message-ID: <20021002151347.20121.qmail@green.zadka.com>

connectionFailed is obsolete.

./doc/examples/ircLogBot.py
./twisted/im/basesupport.py
./twisted/protocols/ftp.py
./twisted/protocols/oscar.py
./twisted/protocols/socks.py
./twisted/spread/pb.py



From twisted at moshez.org  Wed Oct  2 11:10:46 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 2 Oct 2002 17:10:46 -0000
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
Message-ID: <20021002171046.21565.qmail@green.zadka.com>

Here is a tentative suggested time line for releasing 1.0:

1. Wait for all deprecations to be fixed
2. Release 0.99.3rc1
3. Assuming no problems for 48 hours, release 0.99.3 from the same
   code base except ChangeLog, README, twisted/copyright.py and
   doc/howto/installing-twisted.html. In the last 3 only the version
   number should change.
4. Assuming no problems for a week, release 1.0rc1 from the same
   code base with the same exceptions as above.
5. Assuming no problems for 48 hours, release 1.0 from the same
   code base, with same exceptions as above.

Please comment.



From coop at coopweb.org  Wed Oct  2 16:40:52 2002
From: coop at coopweb.org (Gavin Cooper)
Date: Wed, 2 Oct 2002 17:40:52 -0500
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
In-Reply-To: <20021002171046.21565.qmail@green.zadka.com>
References: <20021002171046.21565.qmail@green.zadka.com>
Message-ID: <20021002224052.GA19040@europa.tranquility.net>

On Wed, Oct 02, 2002 at 05:10:46PM -0000, Moshe Zadka wrote:
> Here is a tentative suggested time line for releasing 1.0:
> 
> 1. Wait for all deprecations to be fixed
> 2. Release 0.99.3rc1
> 3. Assuming no problems for 48 hours, release 0.99.3 from the same
>    code base except ChangeLog, README, twisted/copyright.py and
>    doc/howto/installing-twisted.html. In the last 3 only the version
>    number should change.
> 4. Assuming no problems for a week, release 1.0rc1 from the same
>    code base with the same exceptions as above.
> 5. Assuming no problems for 48 hours, release 1.0 from the same
>    code base, with same exceptions as above.

6. ???
7. Profit!

skreech / Gavin Cooper



From dstone at trinity.unimelb.edu.au  Wed Oct  2 19:38:14 2002
From: dstone at trinity.unimelb.edu.au (Daniel Stone)
Date: Thu, 3 Oct 2002 11:38:14 +1000
Subject: [Twisted-Python] WebDAV support
Message-ID: <20021003013814.GA19762@trinity.unimelb.edu.au>

Hi all,
I'm currently working on MoulDAVia, a kick-arse WebDAV server.
Basically, instead of offering a simple shared area (a la Apache's
mod_dav), it will be configurable so you can define a shared area for
one location, login-based for another (chroot()s to your homedir, drops
privileges, based on LDAP, but it could be something else), etc, etc.

I originally started doing this with Twisted, but hit an obstacle. I
can't remember what it was, and spiv wrote twisted.inetd seemingly out
of spite (hi Andrew! :), so I'm going to start trying with Twisted
again.

Cheers!
:) d

-- 
Daniel Stone                                     <dstone at trinity.unimelb.edu.au>
Developer, Trinity College, University of Melbourne



From twisted at itamarst.org  Wed Oct  2 20:15:42 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 2 Oct 2002 22:15:42 -0400
Subject: [Twisted-Python] HTTP changes
Message-ID: <20021002221542.23f46085.twisted@itamarst.org>

I updated http to use a new method of parsing POST requests. This might cause breakage, but was necessary, and gives more functionaly (see http.Request.getArg) and will prevent massive memory usage on large file uploads.

As a result, Request.args will not be a dict in certain cases (POST requests). It does its best to emulate one, though, but some code may still break because of the transition.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From acapnotic at twistedmatrix.com  Thu Oct  3 03:13:10 2002
From: acapnotic at twistedmatrix.com (Kevin Turner)
Date: 03 Oct 2002 02:13:10 -0700
Subject: [Twisted-Python] plugins.tml and distutils
Message-ID: <1033636393.8384.23.camel@troglodyte.funhouse>

Ok, so to get my package's plugins.tml installed correctly, I had to put
this in my setup.py::

    from distutils.command.install_data import install_data
    class install_data_twisted(install_data):
        """make sure data files are installed in package.
        this is evil.
        copied from Twisted/setup.py.
        """
        def finalize_options(self):
            self.set_undefined_options('install',
                ('install_lib', 'install_dir')
            )
            install_data.finalize_options(self)

and add this argument to my setup() call:

    cmdclass={'install_data': install_data_twisted}

In summary, to distribute a package using Twisted, I had to cut 'n paste
a hack from a Twisted source file (not one you'll find in an
installation) that fools with underdocumented distutils features which I
don't understand...  and now it's in my code, so I have to deal with it
if its evilness breaks something/is broken.

Not fully having got the swing of distutils yet, I don't really know
what to do about it.  Can we at least have this install_data defined in
twisted.screwwithotherpackages.distutils module or something, so I can
import it instead of pasting it, thus allowing Twisted to maintain it
instead of me?

(ohyeah.  that's in addition to putting plugins.tml in MANIFEST.in *and*
the data_files list.)

Regards,

 - Kevin

-- 
The moon is waning crescent, 16.1% illuminated, 25.6 days old.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021003/71baa2a2/attachment.sig>

From radix at twistedmatrix.com  Thu Oct  3 04:21:38 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 3 Oct 2002 12:21:38 +0200
Subject: [Twisted-Python] WebDAV support
In-Reply-To: <20021003013814.GA19762@trinity.unimelb.edu.au>
References: <20021003013814.GA19762@trinity.unimelb.edu.au>
Message-ID: <20021003102138.GB5613@toshi>

On Thu, Oct 03, 2002 at 11:38:14AM +1000, Daniel Stone wrote:
> Hi all,
> I'm currently working on MoulDAVia, a kick-arse WebDAV server.
> Basically, instead of offering a simple shared area (a la Apache's
> mod_dav), it will be configurable so you can define a shared area for
> one location, login-based for another (chroot()s to your homedir, drops
> privileges, based on LDAP, but it could be something else), etc, etc.
> 
> I originally started doing this with Twisted, but hit an obstacle. I
> can't remember what it was, and spiv wrote twisted.inetd seemingly out
> of spite (hi Andrew! :), so I'm going to start trying with Twisted
> again.

I'm pretty interested in WebDAV support for Twisted as well -- I'd like
to eventually support it in TamTam. Where can we discuss its design, &c?

Why did you need inetd support to facilitate a WebDAV server, though?




From andrew-twisted at puzzling.org  Thu Oct  3 04:35:26 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 3 Oct 2002 20:35:26 +1000
Subject: [Twisted-Python] WebDAV support
In-Reply-To: <20021003102138.GB5613@toshi>
References: <20021003013814.GA19762@trinity.unimelb.edu.au> <20021003102138.GB5613@toshi>
Message-ID: <20021003103526.GA935@frobozz.local>

On Thu, Oct 03, 2002 at 12:21:38PM +0200, Christopher Armstrong wrote:
> On Thu, Oct 03, 2002 at 11:38:14AM +1000, Daniel Stone wrote:
> > 
> > I originally started doing this with Twisted, but hit an obstacle. I
> > can't remember what it was, and spiv wrote twisted.inetd seemingly out
> > of spite (hi Andrew! :), so I'm going to start trying with Twisted
> > again.
> 
> I'm pretty interested in WebDAV support for Twisted as well -- I'd like
> to eventually support it in TamTam. Where can we discuss its design, &c?
> 
> Why did you need inetd support to facilitate a WebDAV server, though?

He's forking processes and chroot/setuid/setgid'ing them, I think.  Hence
the example of inetd, which demonstrates passing a socket to a child
process.

-Andrew.




From bruce at cubik.org  Thu Oct  3 09:02:53 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Thu, 03 Oct 2002 09:02:53 -0600
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
References: <20021002171046.21565.qmail@green.zadka.com>
Message-ID: <3D9C5C1D.4020705@cubik.org>

Moshe Zadka wrote:
> Here is a tentative suggested time line for releasing 1.0:
> 
> 1. Wait for all deprecations to be fixed

Should this also include fixing the stuff in doc/examples so that each 
one either works or is removed?  (things like the regserver use older 
versions of the twisted.enterprise.row functionality and won't work today.)

  - Bruce




From radix at twistedmatrix.com  Thu Oct  3 09:54:03 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 3 Oct 2002 17:54:03 +0200
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
In-Reply-To: <3D9C5C1D.4020705@cubik.org>
References: <20021002171046.21565.qmail@green.zadka.com> <3D9C5C1D.4020705@cubik.org>
Message-ID: <20021003155403.GB6056@toshi>

On Thu, Oct 03, 2002 at 09:02:53AM -0600, Bruce Mitchener wrote:
> Moshe Zadka wrote:
> >Here is a tentative suggested time line for releasing 1.0:
> >
> >1. Wait for all deprecations to be fixed
> 
> Should this also include fixing the stuff in doc/examples so that each 
> one either works or is removed?  (things like the regserver use older 
> versions of the twisted.enterprise.row functionality and won't work today.)

Yeah, definitely.




From m at moshez.org  Thu Oct  3 09:42:13 2002
From: m at moshez.org (Moshe Zadka)
Date: 3 Oct 2002 15:42:13 -0000
Subject: [Twisted-Python] 1.0 Time line [Suggested! Not official! No Quoting!]
In-Reply-To: <3D9C5C1D.4020705@cubik.org>
References: <3D9C5C1D.4020705@cubik.org>, <20021002171046.21565.qmail@green.zadka.com>
Message-ID: <20021003154213.3564.qmail@green.zadka.com>

On Thu, 03 Oct 2002, Bruce Mitchener <bruce at cubik.org> wrote:

> Moshe Zadka wrote:
> > Here is a tentative suggested time line for releasing 1.0:
> > 
> > 1. Wait for all deprecations to be fixed
> 
> Should this also include fixing the stuff in doc/examples so that each 
> one either works or is removed?  (things like the regserver use older 
> versions of the twisted.enterprise.row functionality and won't work today.)

Definitely. If you have a list of non-working examples, please send it
to the list.



From dstone at kde.org  Thu Oct  3 19:31:40 2002
From: dstone at kde.org (Daniel Stone)
Date: Fri, 4 Oct 2002 11:31:40 +1000
Subject: [Twisted-Python] WebDAV support
In-Reply-To: <20021003103526.GA935@frobozz.local>
References: <20021003013814.GA19762@trinity.unimelb.edu.au> <20021003102138.GB5613@toshi> <20021003103526.GA935@frobozz.local>
Message-ID: <20021004013140.GD6609@trinity.unimelb.edu.au>

On Thu, Oct 03, 2002 at 08:35:26PM +1000, Brother Andrew Bennetts preached da werd, yo:
> On Thu, Oct 03, 2002 at 12:21:38PM +0200, Christopher Armstrong wrote:
> > On Thu, Oct 03, 2002 at 11:38:14AM +1000, Daniel Stone wrote:
> > > I originally started doing this with Twisted, but hit an obstacle. I
> > > can't remember what it was, and spiv wrote twisted.inetd seemingly out
> > > of spite (hi Andrew! :), so I'm going to start trying with Twisted
> > > again.
> > 
> > I'm pretty interested in WebDAV support for Twisted as well -- I'd like
> > to eventually support it in TamTam. Where can we discuss its design, &c?
> > 
> > Why did you need inetd support to facilitate a WebDAV server, though?
> 
> He's forking processes and chroot/setuid/setgid'ing them, I think.  Hence
> the example of inetd, which demonstrates passing a socket to a child
> process.

Right. MoulDAVia is actually a project of Trinity, who wanted WebDAV
home directories. Most solutions (e.g. Apache mod_dav) only support the
paradigm (sorry) of a single shared area - one that the web server's
user could write to. We had two options:
a) give www-data rw access to all home directories (BAD)
b) make Apache run as root

Both of these required silly tricks with .htaccess, so we decided to
write our own. MoulDAVia will eventually support configurable zones -
e.g. /homes/ is for homes, /shared/ is shared, etc, etc. Right now,
however, it requires you to authenticate against LDAP, and chroot()s,
setgid()s and setuid()s. Obviously, all of these, paired with the
necessary fork(), are rather expensive options, so configurability is
needed.

Cheers!
:) d

-- 
Daniel Stone 	     <daniel at raging.dropbear.id.au>             <dstone at kde.org>
Developer - http://kopete.kde.org, http://www.kde.org



From twisted at moshez.org  Fri Oct  4 01:25:47 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 4 Oct 2002 07:25:47 -0000
Subject: [Twisted-Python] 0.99.3rc1 Released
Message-ID: <20021004072547.13087.qmail@green.zadka.com>

Unfortunately, TwistedDoc-0.99.3rc1.tar.gz is somewhat defective, but
everything else is working. Please let the list know of any problems
with this release. As usual, if there are no problems within 24 hours,
we will release it as 0.99.3

Acting Release Manager,
Moshe Zadka




From andrew-twisted at puzzling.org  Fri Oct  4 01:26:51 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 4 Oct 2002 17:26:51 +1000
Subject: [Twisted-Python] usage.Options
Message-ID: <20021004072651.GC25843@ritsuko.xware.cx>

I'm looking at warner's manhole doc at
    http://www.lothar.com/tech/twisted/manhole.xhtml
(which is excellent, btw)

This code snippet struck me as silly:
    # add manhole with username and password
    from twisted.tap.manhole import Options, updateApplication
    o = Options()
    o.parseOptions(["--user", "boss", "--password", "sekrit"])
    updateApplication(app, o)

I'm tempted to wonder if this would be better (if it were implemented in
usage.Options, of course...):
    # add manhole with username and password
    from twisted.tap.manhole import Options, updateApplication
    updateApplication(app, Options(user='boss', password='sekrit'))

i.e. let usage.Options' __init__ take a **kwargs, and have it pass that
to parseOptions.  It seems to me that constructing and configuring an
Options instance at the same time is a natural thing to do.

Does this sound like a good idea?

-Andrew.




From m at moshez.org  Fri Oct  4 02:08:59 2002
From: m at moshez.org (Moshe Zadka)
Date: 4 Oct 2002 08:08:59 -0000
Subject: [Twisted-Python] usage.Options
In-Reply-To: <20021004072651.GC25843@ritsuko.xware.cx>
References: <20021004072651.GC25843@ritsuko.xware.cx>
Message-ID: <20021004080859.13338.qmail@green.zadka.com>

On Fri, 4 Oct 2002, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

>     o.parseOptions(["--user", "boss", "--password", "sekrit"])
...
>     updateApplication(app, Options(user='boss', password='sekrit'))

What if he wanted to use some yes/no option?

> i.e. let usage.Options' __init__ take a **kwargs, and have it pass that
> to parseOptions.  It seems to me that constructing and configuring an
> Options instance at the same time is a natural thing to do.
> 
> Does this sound like a good idea?

Personally, I don't like it.



From glyph at twistedmatrix.com  Fri Oct  4 04:00:18 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 04 Oct 2002 05:00:18 -0500 (CDT)
Subject: [Twisted-Python] usage.Options
In-Reply-To: <20021004072651.GC25843@ritsuko.xware.cx>
References: <20021004072651.GC25843@ritsuko.xware.cx>
Message-ID: <20021004.050018.112272996.glyph@twistedmatrix.com>

On Fri, 4 Oct 2002 17:26:51 +1000, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> let usage.Options' __init__ take a **kwargs, and have it pass that
> to parseOptions.  It seems to me that constructing and configuring an
> Options instance at the same time is a natural thing to do.
> 
> Does this sound like a good idea?

Some convenience mechanism might, but this one's broken.  If you want to come
up with one, remember that:

    * order matters (opt_ methods may require being run in order)
    * you can pass sub-commands
    * there are boolean options as well as keyword args
    * it would probably be nice to be able to use single-letter options too

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021004/f264c734/attachment.sig>

From twisted at moshez.org  Fri Oct  4 06:24:28 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 4 Oct 2002 12:24:28 -0000
Subject: [Twisted-Python] usage.Options
In-Reply-To: <20021004.050018.112272996.glyph@twistedmatrix.com>
References: <20021004.050018.112272996.glyph@twistedmatrix.com>, <20021004072651.GC25843@ritsuko.xware.cx>
Message-ID: <20021004122428.15976.qmail@green.zadka.com>

On Fri, 04 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> Some convenience mechanism might, but this one's broken.  If you want to come
> up with one, remember that:
> 
>     * order matters (opt_ methods may require being run in order)
>     * you can pass sub-commands
>     * there are boolean options as well as keyword args
>     * it would probably be nice to be able to use single-letter options too

The only convenience mechanism I can imagine which would actually satisfy
all your criteria is a function which takes *args:

.updateOptionsArgs("--foo", "bar", "-r", "baz")
....
which is just a tiny bit better than to have to wrap it with [] as
warner was doing.



From typo at soniq.net  Fri Oct  4 08:28:35 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 16:28:35 +0200
Subject: [Twisted-Python] templatepath patch
Message-ID: <20021004142835.GA14324@soniq.net>

compiled templates shouldn't be dumped into cwd:

diff -u -r1.14 template.py
--- template.py 4 Oct 2002 11:38:57 -0000       1.14
+++ template.py 4 Oct 2002 14:27:28 -0000
@@ -245,7 +245,7 @@
         os.stat(compiledTemplatePath)[stat.ST_MTIME] < os.stat(templatePath)[stat.ST_MTIME]):
             compiledTemplate = minidom.parse(templatePath)
             from cPickle import dump
-            dump(compiledTemplate, open(compiledTemplateName, 'wb'), 1)
+            dump(compiledTemplate, open(compiledTemplatePath, 'wb'), 1)
 #            parent = templateRef.parentRef().getObject()
 #            parent.savePickleChild(compiledTemplateName, compiledTemplate)
         else:




From bruce at cubik.org  Fri Oct  4 09:25:39 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Fri, 04 Oct 2002 09:25:39 -0600
Subject: [Twisted-Python] templatepath patch
References: <20021004142835.GA14324@soniq.net>
Message-ID: <3D9DB2F3.8090001@cubik.org>

Paul Boehm wrote:
> compiled templates shouldn't be dumped into cwd:

Thanks!

I've checked this in, modified slightly to also correct the commented 
out code.

  - Bruce




From typo at soniq.net  Fri Oct  4 10:16:23 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 18:16:23 +0200
Subject: [Twisted-Python] twisted.web
Message-ID: <20021004161623.GA11237@soniq.net>

squished another bug:

adding a ? to any url ending with /, ended in a redirect to
//, on repetition to ///, and so on.

can anyone verify this doesn't break anything?

diff -u -r1.63 static.py
--- static.py   1 Oct 2002 17:28:46 -0000       1.63
+++ static.py   4 Oct 2002 16:15:32 -0000
@@ -59,10 +59,16 @@
         return self.data

 def addSlash(request):
-    return "http%s://%s%s/" % (
+    #log.msg("request.uri: %s", request.uri)
+    host = request.getHeader("host")
+    path = string.split(request.uri,'?')[0]
+    slashfree_path = string.split(path,'/')[1]
+
+    return "http%s://%s/%s" % (
         request.isSecure() and 's' or '',
-        request.getHeader("host"),
-        (string.split(request.uri,'?')[0]))
+        host,
+        slashfree_path
+    )

 def redirectTo(URL, request):
     request.redirect(URL)




From typo at soniq.net  Fri Oct  4 10:21:23 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 18:21:23 +0200
Subject: [Twisted-Python] twisted.web
In-Reply-To: <20021004161623.GA11237@soniq.net>
References: <20021004161623.GA11237@soniq.net>
Message-ID: <20021004162123.GA26033@soniq.net>

ah, and another problem with that redirect might
occur with woven Controller based index.rpy. 
i'm not sure how to fix that.

> +    #log.msg("request.uri: %s", request.uri)
forgot this line.



From typo at soniq.net  Fri Oct  4 10:52:57 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 18:52:57 +0200
Subject: [Twisted-Python] woven.widgets
Message-ID: <20021004165257.GA9936@soniq.net>

CheckBox can now be checked by truth in the model

and: is there a reason not to set self['value'] if
self.getData() returns a value that isn't true?

diff -u -r1.20 widgets.py
--- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
+++ widgets.py  4 Oct 2002 16:52:50 -0000
@@ -388,13 +388,17 @@

     def generateDOM(self, request, node):
         mVal = self.getData()
-        if mVal:
-            self['value'] = str(mVal)
+        self['value'] = str(mVal)
         return Widget.generateDOM(self, request, node)

 class CheckBox(Input):
     def initialize(self):
         self['type'] = 'checkbox'
+    def generateDOM(self, request, node):
+        node = Input.generateDOM(self, request, node)
+        if self.getData():
+            node.setAttribute('checked', "checked")
+        return node

 class RadioButton(Input):
     def initialize(self):




From typo at soniq.net  Fri Oct  4 10:58:20 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 18:58:20 +0200
Subject: [Twisted-Python] twisted.web
In-Reply-To: <20021004162123.GA26033@soniq.net>
References: <20021004161623.GA11237@soniq.net> <20021004162123.GA26033@soniq.net>
Message-ID: <20021004165820.GB9936@soniq.net>

On Fri, Oct 04, 2002 at 06:21:23PM +0200, Paul Boehm wrote:
> ah, and another problem with that redirect might
> occur with woven Controller based index.rpy. 
> i'm not sure how to fix that.

forget my last patch, this should work:

diff -u -r1.63 static.py
--- static.py   1 Oct 2002 17:28:46 -0000       1.63
+++ static.py   4 Oct 2002 16:58:34 -0000
@@ -253,10 +253,12 @@
             # If someone is looking for children with a PathReferenceContext,
             # the request won't have a prepath, and we shouldn't do this kind
             # of mangling anyway because it has already been done.
-            if hasattr(request, 'postpath') and not request.postpath and request.uri[-1] != '/':
+            if hasattr(request, 'postpath') and not request.postpath and \
+                        string.split(request.uri,'?')[0][-1] != '/':
                 return Redirect(request)
             if os.path.exists(childPath):
-                if hasattr(request, 'postpath') and not request.postpath and not self.getIndex(request):
+                if hasattr(request, 'postpath') and not request.postpath and \
+                                                not self.getIndex(request):
                     return widgets.WidgetPage(DirectoryListing(self.path))




From dp at twistedmatrix.com  Fri Oct  4 12:28:15 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 4 Oct 2002 11:28:15 -0700
Subject: [Twisted-Python] woven.widgets
In-Reply-To: <20021004165257.GA9936@soniq.net>
Message-ID: <0BCC27E6-D7C7-11D6-B511-00039376B1AE@twistedmatrix.com>

I think you may be able to set checked="1" or checked="0" instead of 
checked="checked"; I'm not sure though.

Also, I can't think of a reason why it wasn't setting self['value'] if 
self.getData() was not true.

Donovan

On Friday, October 4, 2002, at 09:52 AM, Paul Boehm wrote:

> CheckBox can now be checked by truth in the model
>
> and: is there a reason not to set self['value'] if
> self.getData() returns a value that isn't true?
>
> diff -u -r1.20 widgets.py
> --- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
> +++ widgets.py  4 Oct 2002 16:52:50 -0000
> @@ -388,13 +388,17 @@
>
>      def generateDOM(self, request, node):
>          mVal = self.getData()
> -        if mVal:
> -            self['value'] = str(mVal)
> +        self['value'] = str(mVal)
>          return Widget.generateDOM(self, request, node)
>
>  class CheckBox(Input):
>      def initialize(self):
>          self['type'] = 'checkbox'
> +    def generateDOM(self, request, node):
> +        node = Input.generateDOM(self, request, node)
> +        if self.getData():
> +            node.setAttribute('checked', "checked")
> +        return node
>
>  class RadioButton(Input):
>      def initialize(self):
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From typo at soniq.net  Fri Oct  4 12:28:49 2002
From: typo at soniq.net (Paul Boehm)
Date: Fri, 4 Oct 2002 20:28:49 +0200
Subject: [Twisted-Python] woven.widgets
In-Reply-To: <0BCC27E6-D7C7-11D6-B511-00039376B1AE@twistedmatrix.com>
References: <20021004165257.GA9936@soniq.net> <0BCC27E6-D7C7-11D6-B511-00039376B1AE@twistedmatrix.com>
Message-ID: <20021004182849.GA1564@soniq.net>

On Fri, Oct 04, 2002 at 11:28:15AM -0700, Donovan Preston wrote:
> I think you may be able to set checked="1" or checked="0" instead of 
> checked="checked"; I'm not sure though.

in the german selfhtml guide 'checked="checked"' was suggested as xhtml
conformant variant for the attributeless 'checked' html variant.

not sure either..



From sean at ninjaneering.com  Fri Oct  4 12:49:23 2002
From: sean at ninjaneering.com (Sean Riley)
Date: Fri, 4 Oct 2002 13:49:23 -0500
Subject: [Twisted-Python] containership for row objects and networked observation
Message-ID: <PGEKIMFOMBFCPBEILDBLEEAHCBAA.sean@ninjaneering.com>

ramblings about formalizing containment for rowObjects and networked
observation...  this paraphases some of my existing application code that
seems like it could be generalized.

if we know that childRow has a relationship to parentRow where
childRow.parent_id is an p_id of a parentRow, when a child is added to
parent with:

parentRow.addToContainer(childRow)

this could autmatically set the parent_id of the childRow to the p_id of the
parentRow and add the child to a list of children for the parent. This would
make the childRow dirty so that it will be updated to the database.

this assumes that RowObjects have a childRows list to add children to.

should this be part of Enterprise Row Objects, or some other part of
twisted? does it belong in twisted at all? imagine this with error
checking...


class Container:
	def __init__(self):
		self.container = []

	def addToContainer(self, obj):
		"""add an object to the container
		"""
		self.container.append(obj)

	def removeFromContainer(self, obj):
		"""remove an object from the container
		"""
		self.container.remove(obj)

	def getContainedOfType(self, classType):
		"""returns all contained objects of the specified type
		"""
		out = []
		for item in self.container:
		if isinstance(item, classType) or
			issubclass(item.__class__, classType):
			out.append(item)
		return out

I have a containment system that is similar to this but adds observation of
containership:

class ObservableContainer(Container):
	def __init__(self):
		Container.__init__(self)
		self.observers = []

	def addToContainer(self, obj):
		"""add an object to the container
		"""
		Container.addToContainer(self, obj)
		for o in self.observers:
			o.callRemote('addToContainer', obj)

	def removeFromContainer(self, obj):
		"""remove an object from the container
		"""
		Container.removeFromContainer(self, obj)
		for o in self.observers:
			o.callRemote('removeFromContainer', obj)

	def observe_addToContainer(self, obj):
		self.addToContainer(obj)

	def observe_removeFromContainer(self, obj):
		self.removeFromContainer(obj)


Then... making RowObjects observableContainers:

class RowObject(ObservableContainer):

	def addToContainer(self, row):
		"""assumes a rowObject is being added...
		"""
		## TODO: set the foreign key columns on
		##       the row being added
		ObservableContainer.addToContainer(row)

this is a powerful combination of observation and containment. it can be
extended with client side UI objects that are observers of the client-side
rowObjects so that changes can be propogated automatically across the
network and into the UI.

class ClientObject(ObservableContainer):
	def addToContainer(self, obj):
 		for o in self.observers:
			## Dirty UI observers
		Container.addToContiner(self, obj)

	def removeFromContainer(self, obj):
		for o in self.observers:
			## Dirty UI observers
		Container.removeFromContainer(self, obj)


so... when a child row is added to a parent row object on the server, the
observing client object is notified, and the observing UI element is dirtied
so that the UI can be redrawn with the new object being visible.
additionaly, the child row object has it's foreign key attributes updated
automatically and is ready to be updated to the database.

if you add the capability for RowObject derived classes to be pb.Cacheables
as well, changes other than containment then use a very similar mechanism:

class MyRoomClass(RowObject, pb.Cachable):

	def setColor(self, color):
		self.color = color
		for o in self.observers:
			o.callRemote("setColor", color)

class RemoteRoom(ClientObject):
	def observe_setColor(self, color):
		self.color = color
		for o in self.observers:
			### dirty UI observers

this starts become to a generalized application framework that could be
applied to many types of applications.. chat servers that contain chat
groups that contain chat members, virtual worlds with world areas that
contain buildings that contain chests that contain items...


i guess the question is.. is this type containment/observation type
functionality general enough (and useful enough) to be part of twisted?




From acapnotic at twistedmatrix.com  Fri Oct  4 17:15:03 2002
From: acapnotic at twistedmatrix.com (Kevin Turner)
Date: 04 Oct 2002 16:15:03 -0700
Subject: [Twisted-Python] ANN: CVSToys 0.9.6.
Message-ID: <1033773306.8384.51.camel@troglodyte.funhouse>

It's another release of everybody's favourite CVS accessory, CVSToys. 
Since the last time I announced to this list, I've added several more
files that were missing from earlier distributions, added a repository
installation tool called "freshcvs-setup", and traded in the
Linux-specific /proc-watching hacks I was using for some more portable
hacks I found in David Hampton's commit_prep script.  In addition to
Linux, this release has been tested on Darwin and FreeBSD.

For the download, links to CVSToys in action, and more information, see
the CVSToys home page:

http://twistedmatrix.com/users/acapnotic/wares/code/CVSToys/

Upgrade Note:

Those of you using earlier versions will have to add a line to
CVSROOT/commitinfo when you upgrade:
ALL loginfo --commitinfo

Share and Enjoy,

 - Kevin
(Acapnotic)

-- 
The moon is waning crescent, 4.9% illuminated, 27.4 days old.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021004/eb4a40c4/attachment.sig>

From warner at lothar.com  Sat Oct  5 01:18:05 2002
From: warner at lothar.com (Brian Warner)
Date: Sat, 05 Oct 2002 00:18:05 -0700 (PDT)
Subject: [Twisted-Python] usage.Options
References: <20021004072651.GC25843@ritsuko.xware.cx>
Message-ID: <20021005.001805.57985419.warner@lothar.com>

> I'm looking at warner's manhole doc at
>     http://www.lothar.com/tech/twisted/manhole.xhtml
> (which is excellent, btw)

<blushes>. thanks. Check out the other docs-in-progress at
http://www.lothar.com/tech/twisted/ too, let me know what you think.

> I'm tempted to wonder if this would be better (if it were implemented in
> usage.Options, of course...):
>     # add manhole with username and password
>     from twisted.tap.manhole import Options, updateApplication
>     updateApplication(app, Options(user='boss', password='sekrit'))

I'm also not sure if this is a sufficiently common need to make shorter..
most of the time the Options come from sys.argv, after all. What I would find
handy, however, would be something to specifically make it easier to add a
manhole service into an application. Something that a beginner could use
without understanding anything further about PB. Something, say, like this:

Index: twisted/manhole/service.py
===================================================================
RCS file: /cvs/Twisted/twisted/manhole/service.py,v
retrieving revision 1.31
diff -u -r1.31 service.py
--- twisted/manhole/service.py	1 Sep 2002 09:07:11 -0000	1.31
+++ twisted/manhole/service.py	5 Oct 2002 07:05:33 -0000
@@ -344,3 +344,17 @@
                                             getattr(self.application,
                                                     'name', "???"))
         return s
+
+
+def addManhole(app, username, password, portno=None):
+    """Convenience method to add manhole service to an existing app. Returns
+    the manhole Service so you can get at its .namespace attribute."""
+    from twisted.cred import authorizer
+    auth = authorizer.DefaultAuthorizer(app)
+    svc = Service("twisted.manhole", serviceParent=app, authorizer=auth)
+    p = svc.createPerspective(username)
+    p.makeIdentity(password)
+    if portno == None:
+        portno = pb.portno
+    app.listenTCP(portno, pb.BrokerFactory(pb.AuthRoot(auth)))
+    return svc


That would allow the user to add a manhole service with a nice, clean
two-line addition (as opposed to my mean, ugly 4-line addition):

 from twisted.manhole.service import addManhole
 addManhole(app, "boss", "sekrit")

And then you can pre-fill the namespace with useful variables (like
theApplication, or your Services) like this:

 from twisted.manhole.service import addManhole
 n = addManhole(app, "boss", "sekrit").namespace
 n['app'] = app
 n['svc'] = my_svc
 n['help'] = " app: theApplication\n svc: my_svc\n"


One shortcoming of my patch is that the auth will probably steal pb.portno
from any existing PB services. If there are already PB services listening on
that port, the code should probably raise an exception and tell the user to
make it listen on a different one (rather than silently insert it's user/pass
into the user's Authorizer). I don't know how to check for that.. any ideas?

thanks,
 -Brian




From acapnotic at twistedmatrix.com  Sat Oct  5 05:31:37 2002
From: acapnotic at twistedmatrix.com (Kevin Turner)
Date: 05 Oct 2002 04:31:37 -0700
Subject: [Twisted-Python] usage.Options
In-Reply-To: <20021005.001805.57985419.warner@lothar.com>
References: <20021004072651.GC25843@ritsuko.xware.cx> 
	<20021005.001805.57985419.warner@lothar.com>
Message-ID: <1033817498.8380.84.camel@troglodyte.funhouse>

On Sat, 2002-10-05 at 00:18, Brian Warner wrote:
> One shortcoming of my patch is that the auth will probably steal pb.portno
> from any existing PB services. If there are already PB services listening on
> that port, the code should probably raise an exception and tell the user to
> make it listen on a different one (rather than silently insert it's user/pass
> into the user's Authorizer). I don't know how to check for that.. any ideas?

I had code very much like this in mktap once, to allow building in a
manhole to any .tap upon creation.  It did some check so that if a PB
server was already running, it would go ahead and add the manhole
service to that instead of trying to open a port.  Adding a user/pass to
the existing authorizer (which it did) may not be such a bad idea as you
seem to suggest, since you only give that new identity a key for the
"twisted.manhole" service and not the other(s).   (...but authorizers
are now per-Service, not per-ServiceCollection, so you can still have
your separate one if you wish, even if you put them on one port under
the same broker factory.)

However, that code was blown away sometime when I wasn't looking and I
was later urged to use "mktap --append foo.tap manhole" instead, which
still has the same port-clobbering problem as you ran in to.

Back to the question that started this thread, I do agree with you that
adding an "addManhole" interface is a much more reasonable thing to do
than changing the usage.Options interface.  I understand what you said
about the "from twisted.tap.manhole import Options, updateapplication"
being a quick and convenient solution, but it should be recognized that
it's a somewhat abusive hack.  Modules in the 'tap' package are for use
with mktap, and "usage" is a command-line processing utility, not a more
comprehensive configuration tool such as coil might be.

I hope that didn't sound unforgivably grouchy -- I'm up past my bedtime
and am due for a nap.

g'night,

 - kevin

-- 
The moon is waning crescent, 2.6% illuminated, 28.0 days old.





From typo at soniq.net  Sat Oct  5 06:48:22 2002
From: typo at soniq.net (Paul Boehm)
Date: Sat, 5 Oct 2002 14:48:22 +0200
Subject: [Twisted-Python] tap security problem
Message-ID: <20021005124822.GA5322@soniq.net>

tap uid/gid data allows privilege separation.

As uid/gid are part of the Application, a compromised application can write
a shutdown.tap with different uid/gids. in a typical setting the new
shutdown.tap will be read on the next startup, to enjoy persistence.

i think the seperation between config options that are handled by mktap,
and those handled by twistd needs to be refined.

  paul



From glyph at twistedmatrix.com  Sat Oct  5 12:53:05 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 05 Oct 2002 13:53:05 -0500 (CDT)
Subject: [Twisted-Python] tap security problem
In-Reply-To: <20021005124822.GA5322@soniq.net>
References: <20021005124822.GA5322@soniq.net>
Message-ID: <20021005.135305.55498724.glyph@twistedmatrix.com>


On Sat, 5 Oct 2002 14:48:22 +0200, Paul Boehm <typo at soniq.net> wrote:
> As uid/gid are part of the Application, a compromised application can write
> a shutdown.tap with different uid/gids.

Why, in a security-conscious environment, are you allowing the uid/gid that the
server is running as to even _read_ the .tap?  In any event, the .tap is
effectively an SUID binary, and should be writable only by root.

The whole notion of this automatic persistence is somewhat at odds with that of
security - .tap persistence is very explicitly designed to have no security
constraints whatsoever, but to be very convenient.  If you need both
persistence and security, then you have to design your persistence mechanism to
constrain what can be persisted.  Pickle effectively allows literal code to be
stored and executed.


-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021005/b441f6d6/attachment.sig>

From warner at lothar.com  Sat Oct  5 15:36:20 2002
From: warner at lothar.com (Brian Warner)
Date: 05 Oct 2002 14:36:20 -0700
Subject: [Twisted-Python] usage.Options
In-Reply-To: <1033817498.8380.84.camel@troglodyte.funhouse>
References: <20021004072651.GC25843@ritsuko.xware.cx>
	<20021005.001805.57985419.warner@lothar.com>
	<1033817498.8380.84.camel@troglodyte.funhouse>
Message-ID: <877kgw8t63.fsf@luther.lothar.com>

> Adding a user/pass to the existing authorizer (which it did) may not be
> such a bad idea as you seem to suggest, since you only give that new
> identity a key for the "twisted.manhole" service and not the other(s).
> (...but authorizers are now per-Service, not per-ServiceCollection, so you
> can still have your separate one if you wish, even if you put them on one
> port under the same broker factory.)

Good point. I was worried about interaction with a user's custom Authorizer
subclass (which might do some funky db or ldap thing). But adding an auth for
just the manhole service would avoid that cleanly.

> it's a somewhat abusive hack.  Modules in the 'tap' package are for use
> with mktap, and "usage" is a command-line processing utility, not a more
> comprehensive configuration tool such as coil might be.

I agree completely. Manhole is such a great debugging aid (and a great
learning tool, as the beginning developer is trying to match up what they see
in the source code with the internal behavior of a live app) that I wanted a
simple non-confusing way to add one. So I think that addManhole might be a
reasonable addition.

I'll see if I can make a version that checks for an existing factory and adds
to it if necessary. That probably means addManhole() has to be the last one
added (because other services won't do the same thing), but that's easy
enough to add to the docs.

thanks,
 -Brian



From radix at twistedmatrix.com  Sat Oct  5 15:59:22 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sat, 5 Oct 2002 23:59:22 +0200
Subject: [Twisted-Python] usage.Options
In-Reply-To: <877kgw8t63.fsf@luther.lothar.com>
References: <20021004072651.GC25843@ritsuko.xware.cx> <20021005.001805.57985419.warner@lothar.com> <1033817498.8380.84.camel@troglodyte.funhouse> <877kgw8t63.fsf@luther.lothar.com>
Message-ID: <20021005215921.GA466@toshi>

On Sat, Oct 05, 2002 at 02:36:20PM -0700, Brian Warner wrote:
> I agree completely. Manhole is such a great debugging aid (and a great
> learning tool, as the beginning developer is trying to match up what they see
> in the source code with the internal behavior of a live app) that I wanted a
> simple non-confusing way to add one. So I think that addManhole might be a
> reasonable addition.

Well, it should probably be generalized to an "add a new PB service to an
existing Application on a specified port with or without creating a
new Authorizer" function.




From itamar at itamarst.org  Sun Oct  6 11:51:32 2002
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 6 Oct 2002 13:51:32 -0400
Subject: [Twisted-Python] ANN: Twisted 0.99.3 - release candidate for Twisted 1.0 Developer Platform
Message-ID: <20021006135132.58377c00.itamar@itamarst.org>

The Twisted team is proud to announce Twisted 0.99.3, our release candidate for Twisted 1.0 Developer Platform.

For more information, visit http://www.twistedmatrix.com, join the list at
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python or visit us on #twisted at irc.freenode.net (also known as irc.openprojects.net).


What is Twisted?
================

Twisted is an event-based framework for internet applications.  It includes a
web server, a telnet server, a chat server, a news server, a generic client 
and server for remote object access, and APIs for creating new protocols and
services. Twisted supports integration of the Tk, GTK+, Qt or wxPython event
loop with its main event loop. The Win32 event loop is also supported, as is
basic support for running servers on top of Jython. Twisted works with
Python 2.1 and Python 2.2. Twisted even supports the CVS versions of Python, 
so it is ready for Python 2.3.

Twisted currently supports the following protocols, all implemented in pure
python, most of them as both servers and clients:
 
  - SSH
  - FTP
  - HTTP
  - NNTP
  - SOCKSv4 (server only)
  - SMTP
  - IRC
  - telnet
  - POP3
  - AOL's instant messaging TOC
  - OSCAR, used by AOL-IM as well as ICQ (client only)
  - DNS
  - MouseMan
  - finger
  - Echo, discard, chargen and friends
  - Twisted Perspective Broker, a remote object protocol
  - XML-RPC
 

What's new in 0.99.3
====================

- More fixes for HTTP

- Continued work on Woven web framework

- Got rid of remaining uses of deprecated APIs




From acapnotic at twistedmatrix.com  Sun Oct  6 23:30:55 2002
From: acapnotic at twistedmatrix.com (Kevin Turner)
Date: 06 Oct 2002 22:30:55 -0700
Subject: [Twisted-Python] pb.AuthServ and cred.service incongruity
Message-ID: <1033968656.888.37.camel@troglodyte.funhouse>

So there is a reason this authorizer-per-service thing has felt funny,
maybe why I felt like there was a pb.MultiService-for-AuthRoot piece
missing.  A conversation I had with Brian ran into this problem:

The short version:
construct pb.AuthRoot with Authorizer

that authorizer is used by pb.AuthRoot/pb.AuthServ to request
Identities.  pb.AuthChallenger/pb.IdentityWrapper obtain a Perspective
for a Service from that identity.

Perspective.getIdentityRequest uses the authorizer of the service
associated with that perspective.  Nothing in the framework encourages
the service authorizer to be the same as the AuthRoot authorizer.  So it
looks like perspective.getIdentityRequest could very possibly return an
identity out of a different authorizer than the one you logged in with. 
And a Service's authorizer attribute may have nothing at all with how
you obtain a perspective to that service.

 ?

-- 
The moon is new, 0.3% illuminated, 0.5 days old.





From iko at strakt.com  Mon Oct  7 07:18:27 2002
From: iko at strakt.com (Anders Hammarquist)
Date: Mon, 07 Oct 2002 15:18:27 +0200
Subject: [Twisted-Python] SMTP patch take 2
Message-ID: <200210071318.g97DIRG3001254@fido.strakt.com>

Hello,

Here is the promised revised SMTP patch. This adds a unit test for the
change in LineReceiver (the test can probably be improved upon, since
lineLengthExceeded is more of an exception), and a test to make sure
the '.' to finish mail data is on it's own line in SMTPClient. Plus
misc. cleanups. Comments are welcome as always.

/Anders

-------------- next part --------------
Index: twisted/protocols/basic.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/basic.py,v
retrieving revision 1.24
diff -u -u -r1.24 basic.py
--- twisted/protocols/basic.py	1 Oct 2002 15:09:25 -0000	1.24
+++ twisted/protocols/basic.py	7 Oct 2002 13:04:01 -0000
@@ -153,12 +153,15 @@
                 line, self.__buffer = self.__buffer.split(self.delimiter, 1)
             except ValueError:
                 if len(self.__buffer) > self.MAX_LENGTH:
-                    self.transport.loseConnection()
+                    line, self.__buffer = self.__buffer, ''
+                    self.lineLengthExceeded(line)
                     return
                 break
             else:
-                if len(line) > self.MAX_LENGTH:
-                    self.transport.loseConnection()
+                linelength = len(line)
+                if linelength > self.MAX_LENGTH:
+                    line, self.__buffer = self.__buffer, ''
+                    self.lineLengthExceeded(line)
                     return
                 self.lineReceived(line)
                 if self.transport.disconnecting:
@@ -200,6 +203,12 @@
         """Sends a line to the other end of the connection.
         """
         self.transport.write(line + self.delimiter)
+
+    def lineLengthExceeded(self, line):
+        """Called when the maximum line length has been reached.
+        Override if it needs to be dealt with in some special way.
+        """
+        self.transport.loseConnection()
 
 
 class Int32StringReceiver(protocol.Protocol):
Index: twisted/protocols/smtp.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/smtp.py,v
retrieving revision 1.24
diff -u -u -r1.24 smtp.py
--- twisted/protocols/smtp.py	2 Oct 2002 12:38:24 -0000	1.24
+++ twisted/protocols/smtp.py	7 Oct 2002 13:04:01 -0000
@@ -18,10 +18,10 @@
 """
 
 from twisted.protocols import basic
-from twisted.internet import protocol, defer
+from twisted.internet import protocol, defer, reactor
 from twisted.python import log
 
-import os, time, string, operator
+import os, time, string, operator, re
 
 class SMTPError(Exception):
     pass
@@ -49,20 +49,104 @@
         self.deferred.errback(arg)
         self.done = 1
 
+class AddressError(SMTPError):
+    "Parse error in address"
+    pass
+
+# Character classes for parsing addresses
+atom = r"-A-Za-z0-9!#$%&'*+/=?^_`{|}~"
+
+class Address:
+    """Parse and hold an RFC 2821 address.
+
+    Source routes are stipped and ignored, UUCP-style bang-paths
+    and %-style routing are not parsed.
+    """
+
+    tstring = re.compile(r'''( # A string of
+                          (?:"[^"]*" # quoted string
+			  |\\.i # backslash-escaped characted
+			  |[''' + string.replace(atom,'#',r'\#')
+                          + r'''] # atom character
+			  )+|.) # or any single character''',re.X)
+
+    def __init__(self, addr):
+        self.local = ''
+        self.domain = ''
+        self.addrstr = addr
+
+        # Tokenize
+        atl = filter(None,self.tstring.split(addr))
+
+        print atl
+
+        local = []
+        domain = []
+
+        while atl:
+            if atl[0] == '<':
+                if atl[-1] != '>':
+                    raise AddressError, "Unbalanced <>"
+                atl = atl[1:-1]
+            elif atl[0] == '@':
+                atl = atl[1:]
+                if not local:
+                    # Source route
+                    while atl and atl[0] != ':':
+                        # remove it
+                        atl = atl[1:]
+                    if not atl:
+                        raise AddressError, "Malformed source route"
+                    atl = atl[1:] # remove :
+                elif domain:
+                    raise AddressError, "Too many @"
+                else:
+                    # Now in domain
+                    domain = ['']
+            elif len(atl[0]) == 1 and atl[0] not in atom + '.':
+                raise AddressError, "Parse error at " + atl[0]
+            else:
+                if not domain:
+                    local.append(atl[0])
+                else:
+                    domain.append(atl[0])
+                atl = atl[1:]
+               
+        self.local = ''.join(local)
+        self.domain = ''.join(domain)
+
+    dequotebs = re.compile(r'\\(.)')
+    def dequote(self, addr):
+        "Remove RFC-2821 quotes from address"
+        res = []
+
+        atl = filter(None,self.tstring.split(addr))
+
+        for t in atl:
+            if t[0] == '"' and t[-1] == '"':
+                res.append(t[1:-1])
+            elif '\\' in t:
+                res.append(self.dequotebs.sub(r'\1',t))
+            else:
+                res.append(t)
+
+        return ''.join(res)
+
+    def __str__(self):
+        return '%s%s' % (self.local, self.domain and ("@" + self.domain) or "")
+
+    def __repr__(self):
+        return "%s.%s(%s)" % (self.__module__, self.__class__.__name__,
+                              repr(str(self)))
 
 class User:
 
     def __init__(self, destination, helo, protocol, orig):
-        try:
-            self.name, self.domain = string.split(destination, '@', 1)
-        except ValueError:
-            self.name = destination
-            self.domain = ''
+        self.dest = Address(destination)
         self.helo = helo
         self.protocol = protocol
         self.orig = orig
 
-
 class IMessage:
 
     def lineReceived(self, line):
@@ -83,23 +167,40 @@
 
 class SMTP(basic.LineReceiver):
 
-    def __init__(self):
+    def __init__(self, domain, timeout=600):
         self.mode = COMMAND
         self.__from = None
         self.__helo = None
-        self.__to = ()
+        self.__to = []
+        self.timeout = timeout
+        self.host = domain
+
+    def timedout(self):
+        self.sendCode(421, '%s Timeout. Try talking faster next time!' %
+                      self.host)
+        self.transport.loseConnection()
 
     def connectionMade(self):
-        self.sendCode(220, 'Spammers beware, your ass is on fire')
+        self.sendCode(220, '%s Spammers beware, your ass is on fire' %
+                      self.host)
+        if self.timeout:
+            self.timeoutID = reactor.callLater(self.timeout, self.timedout)
 
     def sendCode(self, code, message=''):
         "Send an SMTP code with a message."
         self.transport.write('%d %s\r\n' % (code, message))
 
     def lineReceived(self, line):
+        if self.timeout:
+            self.timeoutID.cancel()
+            self.timeoutID = reactor.callLater(self.timeout, self.timedout)
+
         if self.mode is DATA:
             return self.dataLineReceived(line)
-        command = string.split(line, None, 1)[0]
+        if line:
+            command = string.split(line, None, 1)[0]
+        else:
+            command = ''
         method = getattr(self, 'do_'+string.upper(command), None)
         if method is None:
             method = self.do_UNKNOWN
@@ -107,21 +208,65 @@
             line = line[len(command):]
         return method(string.strip(line))
 
+    def lineLengthExceeded(self, line):
+        if self.mode is DATA:
+            for message in self.__messages:
+                message.connectionLost()
+            self.mode = COMMAND
+            del self.__messages
+        self.sendCode(500, 'Line too long')
+
+    def rawDataReceived(self, data):
+        "Throw away rest of long line"
+        rest = string.split(data, '\r\n', 1)
+        if len(rest) == 2:
+            self.setLineMode(self.rest[1])
+
     def do_UNKNOWN(self, rest):
-        self.sendCode(502, 'Command not implemented')
+        self.sendCode(500, 'Command not implemented')
 
     def do_HELO(self, rest):
-        self.__helo = rest
-        self.sendCode(250, 'Nice to meet you')
+        peer = self.transport.getPeer()[1]
+        self.__helo = (rest, peer)
+        self.sendCode(250, '%s Hello %s, nice to meet you' % (self.host, peer))
 
     def do_QUIT(self, rest):
         self.sendCode(221, 'See you later')
         self.transport.loseConnection()
 
+    # A string of quoted strings, backslash-escaped character or
+    # atom characters + '@.,:'
+    qstring = r'("[^"]*"|\\.|[' + string.replace(atom,'#',r'\#') + r'@.,:])+'
+
+    mail_re = re.compile(r'''\s*FROM:\s*(?P<path><> # Empty <>
+                         |<''' + qstring + r'''> # <addr>
+			 |''' + qstring + r''' # addr
+			 )\s*(\s(?P<opts>.*))? # Optional WS + ESMTP options
+			 $''',re.I|re.X)
+    rcpt_re = re.compile(r'\s*TO:\s*(?P<path><' + qstring + r'''> # <addr>
+                         |''' + qstring + r''' # addr
+			 )\s*(\s(?P<opts>.*))? # Optional WS + ESMTP options
+			 $''',re.I|re.X)
+
     def do_MAIL(self, rest):
-        from_ = rest[len("MAIL:<"):-len(">")]
-        self.validateFrom(self.__helo, from_, self._fromValid,
-                                              self._fromInvalid)
+        if self.__from:
+            self.sendCode(503,"Only one sender per message, please")
+            return
+        # Clear old recipient list
+        self.__to = []
+        m = self.mail_re.match(rest)
+        if not m:
+            self.sendCode(501, "Syntax error")
+            return
+
+        try:
+            addr = Address(m.group('path'))
+        except AddressError, e:
+            self.sendCode(553, str(e))
+            return
+            
+        self.validateFrom(self.__helo, addr, self._fromValid,
+                          self._fromInvalid)
 
     def _fromValid(self, from_):
         self.__from = from_
@@ -131,12 +276,24 @@
         self.sendCode(550, 'No mail for you!')
 
     def do_RCPT(self, rest):
-        to = rest[len("TO:<"):-len(">")]
-        user = User(to, self.__helo, self, self.__from)
+        if not self.__from:
+            self.sendCode(503, "Must have sender before recpient")
+            return
+        m = self.rcpt_re.match(rest)
+        if not m:
+            self.sendCode(501, "Syntax error")
+            return
+
+        try:
+            user = User(m.group('path'), self.__helo, self, self.__from)
+        except AddressError, e:
+            self.sendCode(553, str(e))
+            return
+            
         self.validateTo(user, self._toValid, self._toInvalid)
 
     def _toValid(self, to):
-        self.__to = self.__to + (to,)
+        self.__to.append(to)
         self.sendCode(250, 'Address recognized')
 
     def _toInvalid(self, to):
@@ -144,22 +301,30 @@
 
     def do_DATA(self, rest):
         if self.__from is None or not self.__to:  
-            self.sendCode(550, 'Must have valid receiver and originator')
+            self.sendCode(503, 'Must have valid receiver and originator')
             return
         self.mode = DATA
         helo, origin, recipients = self.__helo, self.__from, self.__to
         self.__from = None
-        self.__to = ()
+        self.__to = []
         self.__messages = self.startMessage(recipients)
+        for message in self.__messages:
+            message.lineReceived(self.receivedHeader(helo, origin, recipients))
         self.sendCode(354, 'Continue')
 
     def connectionLost(self, reason):
+        # self.sendCode(421, 'Dropping connection.') # This does nothing...
+        # Ideally, if we (rather than the other side) lose the connection,
+        # we should be able to tell the other side that we are going away.
+        # RFC-2821 requires that we try.
         if self.mode is DATA:
             for message in self.__messages:
                 message.connectionLost()
+            del self.__messages
 
     def do_RSET(self, rest):
-        self.__init__()
+        self.__from = None
+        self.__to = []
         self.sendCode(250, 'I remember nothing.')
 
     def dataLineReceived(self, line):
@@ -177,6 +342,7 @@
                     deferred = message.eomReceived()
                     deferred.addCallback(ndeferred.callback)
                     deferred.addErrback(ndeferred.errback)
+                del self.__messages
                 return
             line = line[1:]
         for message in self.__messages:
@@ -189,7 +355,14 @@
         self.sendCode(550, 'Could not send e-mail')
 
     # overridable methods:
+    def receivedHeader(self, helo, origin, recipents):
+        return "Received: From %s ([%s]) by %s; %s" % (
+            helo[0], helo[1], self.host,
+            time.strftime("%a, %d %b %Y %H:%M:%S +0000", time.gmtime()))
+    
     def validateFrom(self, helo, origin, success, failure):
+        if not self.__helo:
+            self.sendCode(503,"Who are you? Say HELO first");
         success(origin)
 
     def validateTo(self, user, success, failure):
@@ -265,6 +438,7 @@
         
     def smtpCode_354_data(self, line):
         self.mailFile = self.getMailData()
+        self.lastsent = ''
         self.transport.registerProducer(self, 0)
 
     def smtpCode_250_afterData(self, line):
@@ -277,11 +451,18 @@
         chunk = self.mailFile.read(8192)
         if not chunk:
             self.transport.unregisterProducer()
-            self.sendLine('.')
+            if self.lastsent != '\n':
+                line = '\r\n.'
+            else:
+                line = '.'
+            self.sendLine(line)
             self.state = 'afterData'
+            return
 
         chunk = string.replace(chunk, "\n", "\r\n")
+        chunk = string.replace(chunk, "\r\n.", "\r\n..")
         self.transport.write(chunk)
+        self.lastsent = chunk[-1]
 
     def pauseProducing(self):
         pass
Index: twisted/test/test_protocols.py
===================================================================
RCS file: /cvs/Twisted/twisted/test/test_protocols.py,v
retrieving revision 1.17
diff -u -u -r1.17 test_protocols.py
--- twisted/test/test_protocols.py	23 Sep 2002 08:51:29 -0000	1.17
+++ twisted/test/test_protocols.py	7 Oct 2002 13:04:02 -0000
@@ -33,11 +33,13 @@
 class LineTester(basic.LineReceiver):
 
     delimiter = '\n'
+    MAX_LENGTH = 64
 
     def connectionMade(self):
         self.received = []
 
     def lineReceived(self, line):
+        print self.MAX_LENGTH, len(line)
         self.received.append(line)
         if line == '':
             self.setRawMode()
@@ -51,6 +53,10 @@
         if self.length == 0:
             self.setLineMode(rest)
 
+    def lineLengthExceeded(self, line):
+        if len(line) > self.MAX_LENGTH+1:
+            self.setLineMode(line[self.MAX_LENGTH+1:])
+
 class WireTestCase(unittest.TestCase):
 
     def testEcho(self):
@@ -103,13 +109,14 @@
 012345678len 0
 foo 5
 
+1234567890123456789012345678901234567890123456789012345678901234567890
 len 1
 
 a'''
 
     output = ['len 10', '0123456789', 'len 5', '1234\n',
               'len 20', 'foo 123', '0123456789\n012345678',
-              'len 0', 'foo 5', '', 'len 1', 'a']
+              'len 0', 'foo 5', '', '67890', 'len 1', 'a']
 
     def testBuffer(self):
         for packet_size in range(1, 10):
@@ -175,3 +182,6 @@
             r.dataReceived(s)
             if not r.brokenPeer:
                 raise AssertionError("connection wasn't closed on illegal netstring %s" % repr(s))
+
+if __name__ == '__main__':
+    unittest.main()
-------------- next part --------------
-- 
 -- Of course I'm crazy, but that doesn't mean I'm wrong.
Anders Hammarquist                                  | iko at strakt.com
AB Strakt                                           | Tel: +46 31 749 08 80
G|teborg, Sweden.           RADIO: SM6XMM and N2JGL | Fax: +46 31 749 08 81

From twisted at moshez.org  Mon Oct  7 07:25:44 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 7 Oct 2002 13:25:44 -0000
Subject: [Twisted-Python] Quixote/Twisted Integration
Message-ID: <20021007132544.23425.qmail@green.zadka.com>

Hi!

I've added a feature to the Twisted web server where it can use Quixote's
PTL. Here's a (completely overkill) example:

-------------- hello.rtl ---------------
from twisted.web.resource import Resource


class ExampleResource(Resource):

    template render(self, request):
        """\
<HTML>
    <HEAD><TITLE> Welcome To Twisted Python </title></head>

    <BODY>
    This is a demonstration of embedded template python in a webserver.
    </body>
</html>"""


resource = ExampleResource()
------------------------------------------

Then configure the web server with:

% ./bin/mktap web --path=`pwd` --processor=.rtl=twisted.web.script.ResourceTemplate --port=10999
% ./bin/twistd -f web.tap

And then http://localhost:10999/hello.rtl will show the expected output.

This uses some features only available from the Twisted CVS and was tested
with Quixote 0.5

Thanks.




From twisted at moshez.org  Mon Oct  7 07:42:46 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 7 Oct 2002 13:42:46 -0000
Subject: [Twisted-Python] SMTP patch take 2
In-Reply-To: <200210071318.g97DIRG3001254@fido.strakt.com>
References: <200210071318.g97DIRG3001254@fido.strakt.com>
Message-ID: <20021007134246.23521.qmail@green.zadka.com>

Here are some comments

On Mon, 07 Oct 2002 15:18:27 +0200, Anders Hammarquist <iko at strakt.com> wrote:

> -    def __init__(self):
> +    def __init__(self, domain, timeout=600):

This is wrong. .domain and .timeout should be attributes the protocol
gets from the factory, since they are a part of the persistenct configuration.

> +    # A string of quoted strings, backslash-escaped character or
> +    # atom characters + '@.,:'
> +    qstring = r'("[^"]*"|\\.|[' + string.replace(atom,'#',r'\#') + r'@.,:])+'

Oh, wow. Maybe have some unit tests for the correctness of the regular
expressions :)

> +    def receivedHeader(self, helo, origin, recipents):
> +        return "Received: From %s ([%s]) by %s; %s" % (
> +            helo[0], helo[1], self.host,
> +            time.strftime("%a, %d %b %Y %H:%M:%S +0000", time.gmtime()))
> +    
>      def validateFrom(self, helo, origin, success, failure):
> +        if not self.__helo:
> +            self.sendCode(503,"Who are you? Say HELO first");
               ...and fail... 
>          success(origin)



From radix at twistedmatrix.com  Mon Oct  7 08:24:38 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 7 Oct 2002 16:24:38 +0200
Subject: [Twisted-Python] Deferred getChild
Message-ID: <20021007142438.GA1936@toshi>

I've implemented the Deferred support for getChild. I'd like to get
glyph's approval of this before I check it in, and I'm sending it to
TPML for general commentary.

getChildForRequest is now recursive in the general non-Deferred case,
I'm not sure if anyone has issues with this. I think I might be able
to convert it to a while loop that only recurses (well, horizontally
recurses ;-)) in the Deferred-result case.

Index: server.py
===================================================================
RCS file: /cvs/Twisted/twisted/web/server.py,v
retrieving revision 1.81
diff -u -r1.81 server.py
--- server.py	5 Oct 2002 12:15:11 -0000	1.81
+++ server.py	7 Oct 2002 14:21:02 -0000
@@ -42,7 +42,7 @@
 
 # Twisted Imports
 from twisted.spread import pb, refpath
-from twisted.internet import reactor, protocol
+from twisted.internet import reactor, protocol, defer
 from twisted.protocols import http
 from twisted.python import log, reflect, roots, failure, components
 from twisted import copyright
@@ -146,12 +146,17 @@
         self.postpath = map(urllib.unquote, string.split(self.path[1:], '/'))
         try:
             resrc = self.site.getResourceFor(self)
-            self.render(resrc)
+            if isinstance(resrc, defer.Deferred):
+                resrc.addCallback(self.render)
+                resrc.addErrback(self.processingFailed)
+            else:
+                self.render(resrc)
         except:
             self.processingFailed(failure.Failure())
 
     def render(self, resrc):
         try:
+            print resrc
             body = resrc.render(self)
         except UnsupportedMethod, e:
             allowedMethods = e.allowedMethods
@@ -449,7 +454,7 @@
         # servers and disconnected sites.
         request.sitepath = copy.copy(request.prepath)
         request.acqpath = copy.copy(request.prepath)
-        return self.resource.getChildForRequest(request)
+        return self.resource.getChildForRequest(request=request)
 
 
 import html
Index: resource.py
===================================================================
RCS file: /cvs/Twisted/twisted/web/resource.py,v
retrieving revision 1.20
diff -u -r1.20 resource.py
--- resource.py	25 Sep 2002 08:40:36 -0000	1.20
+++ resource.py	7 Oct 2002 14:21:02 -0000
@@ -122,21 +122,31 @@
 
         return self.getChild(path, request)
 
-    def getChildForRequest(self, request):
+    def getChildForRequest(self, resrc=None, request=None):
         """(internal) Get a child of mine dependant on a particular request.
 
         This will be called on me as a top-level resource of a site in order to
         retrieve my appropriate child or grandchild to display.
         """
-        res = self
-        while request.postpath and not res.isLeaf:
+        assert request, "No, that's not _really_ an optional argument."
+        res = resrc or self
+        if request.postpath and not res.isLeaf:
             pathElement = request.postpath.pop(0)
+            print "doing", pathElement, "...",
             request.acqpath.append(pathElement)
             request.prepath.append(pathElement)
             res = res.getChildWithDefault(pathElement, request)
-        return res
+            print "and got", res
 
+            #conditional horizontal or vertical recursion!
+            if isinstance(res, defer.Deferred):
+                #the caller adds an errback, so i don't need to
+                return res.addCallback(self.getChildForRequest, request)
+            else:
+                return self.getChildForRequest(res, request)
+        return res
 
+        
     def putChild(self, path, child):
         """Register a child with me.
         """




From iko at cd.chalmers.se  Mon Oct  7 08:44:49 2002
From: iko at cd.chalmers.se (Anders Hammarquist)
Date: Mon, 07 Oct 2002 16:44:49 +0200
Subject: [Twisted-Python] SMTP patch take 2 
In-Reply-To: Message from Moshe Zadka <twisted@moshez.org> 
   of "07 Oct 2002 13:42:46 -0000." <20021007134246.23521.qmail@green.zadka.com> 
References: <200210071318.g97DIRG3001254@fido.strakt.com> <20021007134246.23521.qmail@green.zadka.com> 
Message-ID: <200210071444.QAA10877@haddock.cd.chalmers.se>

In a message of 07 Oct 2002 13:42:46 -0000, Moshe Zadka writes:
>> +    # A string of quoted strings, backslash-escaped character or
>> +    # atom characters + '@.,:'
>> +    qstring = r'("[^"]*"|\\.|[' + string.replace(atom,'#',r'\#') + r'@
>.,:])+'
>
>Oh, wow. Maybe have some unit tests for the correctness of the regular
>expressions :)

Actually, no. The unit test should be checking if the stuff gets parsed
correctly in Address(), do_MAIL() and do_RCPT(). I don't really care if
the regexps are right, as long as the results from where they are used
are right. Though hopefully that would indicate that the regexp is right
as well ;-)

I think it's time for an update of twisted.test.test_smtp.

/Anders

-- 
 -- Of course I'm crazy, but that doesn't mean I'm wrong.
Anders Hammarquist                                  | iko at cd.chalmers.se
Physics student, Chalmers University of Technology, | Hem: +46 31 88 48 50
G|teborg, Sweden.           RADIO: SM6XMM and N2JGL | Mob: +46 707 27 86 87



From dave at pythonapocrypha.com  Mon Oct  7 10:08:08 2002
From: dave at pythonapocrypha.com (dave at pythonapocrypha.com)
Date: Mon, 7 Oct 2002 09:08:08 -0700 (PDT)
Subject: [Twisted-Python] Twisted performance?
Message-ID: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>

Hello,

I'm new to the list and have started looking at Twisted as an alternative 
to our company's internal, home-grown solution. Twisted appears to have 
all the functionality I want (and more!), so the main decision point for 
me is performance. Is there a web page or document describing some 
performance characteristics of Twisted?

Requests per second is only mildly interesting to me - our application is
all about total throughput. It's essentially a custom HTTP server for
large files (few hundred megabytes), so I'm looking for total throughput
numbers for a few high-speed connections as well as for many slow (modem
or slow DSL) connections. For example, on a 800 MHz PIII with a SCSI drive
we can currently sustain around 300 Mbps total across 100 non-rate-limited
connections (pulling the data off the disk), and 300 Mbps total across
about 1000 or so 150 Kbps connections. On a faster CPU and no disk access
we occasionally hit a gigabit per second across 50 or so full-speed
connections, but my target is only about 250 Mbps per machine, assuming
the CPU is in the < 1 GHz range. One problem with our implementation is
that the performance curve drops off too quickly as number of concurrent
connections go up. I'd love to sustain 250 Mbps across 2000 or more
connections; for now we compensate by buying more CPU (which isn't too big 
of a problem).

Our current solution is a pure-Python one we built internally. Originally
we used asyncore/asynchat but it was (1) too slow and (2) too low level.
What we built fixed these problems, but the fact that we're the only users
of our library is a risk, and it's a shame to build it all ourselves if we
can get away with using like Twisted.

I'd love to hear comments and performance numbers, even if they're just
anectdotal. Additionally (or as an alternative), if anyone can point me to
some sample code I can run it against our internal performance tests - I'd
be interested in (1) an HTTP server that serves just from memory (i.e.  
returns a valid but large HTTP response of just random or junk data) and
(2) an HTTP server that just serves a file or two from disk. In both cases
the emphasis is on total throughput at varying numbers of concurrent 
connections.

Thanks,
Dave

P.S. Does Twisted support any sort of throughput throttling? (i.e. the 
ability to cap [average] throughput at a certain level)




From twisted at itamarst.org  Mon Oct  7 09:37:51 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 7 Oct 2002 11:37:51 -0400
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
Message-ID: <20021007113751.6c402c39.twisted@itamarst.org>

On Mon, 7 Oct 2002 09:08:08 -0700 (PDT)
dave at pythonapocrypha.com wrote:

> I'd love to hear comments and performance numbers, even if they're just
> anectdotal. 

Twisted sustained performance is not all that great, especially from disk, but then we haven't really tried to optimize it that much. On the other hand, on my laptop (866 crusoe) it can do 160Mbit from disk (100 concurrent connections over loopback, using ab), but then it's a pretty slow machine. On a decent machine it'd probably do much better, and there are clear paths towards optimization - certainly we'd love it if you ported your optimizations to Twisted.

> Additionally (or as an alternative), if anyone can point me to
> some sample code I can run it against our internal performance tests - I'd
> be interested in (1) an HTTP server that serves just from memory (i.e.  
> returns a valid but large HTTP response of just random or junk data) and
> (2) an HTTP server that just serves a file or two from disk. In both cases
> the emphasis is on total throughput at varying numbers of concurrent 
> connections.

1. $ cp largefile /var/www/
   $ mktap web --path=/var/www
   $ twistd -f web.tap
   $ ab -n 300 -c 20 http://localhost:8080/largefile

2. Run attached script and run benchmarks against it. Seems rather slow, actually, compared to (1).

> P.S. Does Twisted support any sort of throughput throttling? (i.e. the 
> ability to cap [average] throughput at a certain level)

No, but it could be added pretty easily to things that use producer/consumer, I think (e.g. serving files).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting
-------------- next part --------------
A non-text attachment was scrubbed...
Name: empty.py
Type: application/octet-stream
Size: 1060 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021007/d60a3118/attachment-0002.obj>

From twisted at itamarst.org  Mon Oct  7 10:06:10 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 7 Oct 2002 12:06:10 -0400
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
Message-ID: <20021007120610.08030498.twisted@itamarst.org>

On Mon, 7 Oct 2002 09:08:08 -0700 (PDT)
dave at pythonapocrypha.com wrote:

> I'd love to hear comments and performance numbers, even if they're just
> anectdotal. 

Twisted sustained performance is not all that great, especially from disk, but then we haven't really tried to optimize it that much. On the other hand, on my laptop (866 crusoe) it can do 160Mbit from disk (100 concurrent connections over loopback, using ab), but then it's a pretty slow machine. On a decent machine it'd probably do much better, and there are clear paths towards optimization - certainly we'd love it if you ported your optimizations to Twisted.

> Additionally (or as an alternative), if anyone can point me to
> some sample code I can run it against our internal performance tests - I'd
> be interested in (1) an HTTP server that serves just from memory (i.e.  
> returns a valid but large HTTP response of just random or junk data) and
> (2) an HTTP server that just serves a file or two from disk. In both cases
> the emphasis is on total throughput at varying numbers of concurrent 
> connections.

1. $ cp largefile /var/www/
   $ mktap web --path=/var/www
   $ twistd -f web.tap
   $ ab -n 300 -c 20 http://localhost:8080/largefile

2. Run attached script and run benchmarks against it. Seems rather slow, actually, compared to (1).

> P.S. Does Twisted support any sort of throughput throttling? (i.e. the 
> ability to cap [average] throughput at a certain level)

No, but it could be added pretty easily to things that use producer/consumer, I think (e.g. serving files).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting
-------------- next part --------------
A non-text attachment was scrubbed...
Name: empty.py
Type: application/octet-stream
Size: 1060 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021007/81cad21b/attachment-0002.obj>

From twisted at itamarst.org  Mon Oct  7 10:41:01 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 7 Oct 2002 12:41:01 -0400
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <20021007113751.6c402c39.twisted@itamarst.org>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
	<20021007113751.6c402c39.twisted@itamarst.org>
Message-ID: <20021007124101.2675e764.twisted@itamarst.org>

On Mon, 7 Oct 2002 11:37:51 -0400
Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> other hand, on my laptop (866 crusoe) it can do 160Mbit from disk

Or according to httperf, only 100Mbit.



From bruce at cubik.org  Mon Oct  7 11:06:07 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Mon, 07 Oct 2002 11:06:07 -0600
Subject: [Twisted-Python] Twisted performance?
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>	<20021007113751.6c402c39.twisted@itamarst.org> <20021007124101.2675e764.twisted@itamarst.org>
Message-ID: <3DA1BEFF.80501@cubik.org>

Itamar Shtull-Trauring wrote:
> On Mon, 7 Oct 2002 11:37:51 -0400
> Itamar Shtull-Trauring <twisted at itamarst.org> wrote:
> 
>>other hand, on my laptop (866 crusoe) it can do 160Mbit from disk
> 
> Or according to httperf, only 100Mbit.

Is that going over loopback or the NIC though?

  - Bruce




From twisted at itamarst.org  Mon Oct  7 11:02:04 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 7 Oct 2002 13:02:04 -0400
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <3DA1BEFF.80501@cubik.org>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
	<20021007113751.6c402c39.twisted@itamarst.org>
	<20021007124101.2675e764.twisted@itamarst.org>
	<3DA1BEFF.80501@cubik.org>
Message-ID: <20021007130204.6744ee3f.twisted@itamarst.org>

On Mon, 07 Oct 2002 11:06:07 -0600
Bruce Mitchener <bruce at cubik.org> wrote:

> Is that going over loopback or the NIC though?

loopback.



From jjn at kriln.com  Mon Oct  7 12:41:11 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Mon, 7 Oct 2002 18:41:11 +0000 (GMT)
Subject: [Twisted-Python] patch for protocols.telnet.Telnet
Message-ID: <20021007183722.W58399-100000@nosferatu.kriln.com>

There's a bug in the telnet protocol, which will only process one 'line'
per call to processChunk().  This is buggy, because if you send a large
amount of data to a connection, such as via copy/paste, it will only
process the first two lines of it, and you're stuck mashing the enter key
to get it to process the rest.

Patch makes it process all lines instead of just one.

Index: telnet.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/telnet.py,v
retrieving revision 1.16
diff -u -r1.16 telnet.py
--- telnet.py   15 Jul 2002 23:51:33 -0000      1.16
+++ telnet.py   7 Oct 2002 18:35:02 -0000
@@ -250,12 +250,16 @@
             idx = string.find(self.buffer, delim)
             if idx != -1:
                 break
-
-        if idx != -1:
+        while idx != -1:
             buf, self.buffer = self.buffer[:idx], self.buffer[idx+2:]
             self.processLine(buf)
             if self.mode == 'Done':
                 self.transport.loseConnection()
+
+            for delim in self.delimiters:
+                idx = string.find(self.buffer, delim)
+                if idx != -1:
+                    break

     def dataReceived(self, data):
         chunk = StringIO()





From mjstahl at mac.com  Mon Oct  7 22:16:51 2002
From: mjstahl at mac.com (MJ Stahl)
Date: Mon, 7 Oct 2002 23:16:51 -0500
Subject: [Twisted-Python] JSPB on mozdev.org
Message-ID: <C5827F1D-DA74-11D6-B26C-000393763438@mac.com>

I just wanted to let everyone know, the work that I have completed so 
far on JSPB (javascript implemenation of perspective broker) is 
currently up on

jspb.mozdev.org

Currently the files that I have included do not function, and in some 
instances are incomplete. I posted them because I need some guidance or 
potential help, and still can only see the damned pb trees, and not the 
pb forest.

banana.js is the most complete, and includes a test_banana.js for a 
test case... both ported directly from the python source.

Currently I am having trouble with the inclusion of other JS files 
through a JS or Mozilla way. I am also having difficulties with string 
input/output operations, not having the knowledge of anything of these 
operations that may be going on behind the twisted scene (ie, other 
included modules), or what is a good minimalist approach would be.

Thanks guys, and I just wanted to let you know what was going on.

-mjs 




From glyph at twistedmatrix.com  Tue Oct  8 01:04:24 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 08 Oct 2002 02:04:24 -0500 (CDT)
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
Message-ID: <20021008.020424.07435626.glyph@twistedmatrix.com>


Too much of the vision for Twisted lives in my head, because I'm concerned
about releasing unfinished visions and having lots of potentially contradictory
documents live in the repository.  So, I'm going to try now every once in a
while to vent some of these ideas that have been playing around inside my head.

This is my first attempt at doing this, so feel free to ask questions.

These are all features that I intend to implement personally, but if anyone
wants to contribute a patch for me to review, I'd love to see it.


1. Perspective Broker URLS
==========================

The current (huge constellation of) connection APIs that PB ships with are all
subtly broken in one way or another.  They all walk the line between "too
verbose" and "too limited".

In essence what PB needs is a mini-language for specifying these connection
conversations.  URLs provide a very useful basis for this sort of
mini-language.  I haven't worked out a lot of the details of this connection
scheme yet (otherwise I would have implemented it) but it should be pretty
straightforward extension of the ideas in HTTP URLs.

These URLs need to be able to represent transport mechanism (TCP? UNIX socket?
SSL? Weird firewall-tunneling stuff?) plus everything about the object that
you're trying to access (location? authentication information? authentication
format?)

The idea is that you pass in a string, you get a Deferred PB "endpoint", which
should be the object that you're really wanting to interact with.  Here are
some off-the-cuff examples:

    pb://pyramid/service#perspective

Log in to Pyramid, with the given service and perspective.  The part of the
login conversation which attempts to get the "child" object from the service
will prompt for interactive authentication.

    pb://pyramid/identity:password at service#perspective

Normal login/password to service/perspective pair.  Challenge-response
authentication implied.

    pb://pyramid/md5-cr$identity:password at service#perspective

Same thing, normal challenge-response explicitly selected.

    pb-ssh://pyramid/sshkey$identity at service#perspective

Public-key authentication mechanism, using the same identity name.  Connection
over SSH transport (sshkey auth only available this way).

    pb-ssl://pyramid/cert$identity at service#perspective

PB over SSL, using certificate auth.

    pb://pyramid/this/that/the-other/my-service#perspective

A service located within a tree of services.  Again the my-service bit of the
path will prompt for interactive authentication.

    pb://pyramid/user at sekrit/otheruser at double-sekrit/super-sekrit-service#perspective

Two objects in the path that require separate authentication.  An unusual, but
still possible situation.


2. Automatic XSS input scrubbing for Woven
==========================================

Form input that is intended to be used as HTML can be scanned for potentially
abusive input so that the web administration interface for a bulletin board
written using Twisted doesn't fall prey to the usual "cross site scripting"
vulnerabilities that plague feedback-capable web sites.

The problem formulation, generally, is that an attacker will place some
malicious javascript in a web form.  When some article is viewed by an admin,
that malicious javascript executes in their browser, taking advantage of the
fact that they have an admin cookie for that website in their browser.  It will
take advantage of a security flaw in the browser and perform administrative
tasks with their authority on the website without the admin's approval.

There are pretty much only a few ways they can do this, and I believe each one
has a simple solution.

    - <script /> tags

Don't allow script tags in input, ever.  Force input that uses tags into a DOM
tree before it is even made to be preview-able.  (DOM parsing can be relaxed,
but before the tree is output, it is converted to well-formed XML).

    - <a href="..." /> tags

Stick a little warning after any "off-site" link, and turn it into a redirect.
Any admin clicking on such a link will first be bounced through a URL which
revokes their admin cookie so the attacking site won't have the ability to call
back.

    - attributes on other HTML tags, such as onmouseover, that execute js
      expressions

Catalogue these and scrub them all off.

    - <img /> or <object /> tags that automatically download other items, which
      may be webpages containing javascript.

Again, don't allow these tags.  Or, have the server-side site download the
images and verify that they are PNGs (alternately also doing PIL stuff to
remove steganographic information, if you're _really_ paranoid).


3. widgets.Form-like Abstraction for Woven (and others) 
=======================================================

(This has been alternately called "form methods" or "actions".)  The idea is
that we have a meta-data format for publishing methods to have user interfaces,
which would most likely look like forms.  This metadata should be
platform-neutral and have a Woven front-end widget (controller?) that formats
it prettily, perhaps in conjunction with a template for the form itself.

This interface should also extend to other UIs.  Having a GTK interface would
be particularly useful for building GUI equivalents of tools like COIL, which
should be able to have a GUI hook into it as easily as a web page.

Additionally there should be some support for remote methods.  A PB reference
should be able to present at least a trivial version of this meta-data for its
objects.  That way you could present user-interfaces to arbitrary PB objects
(and, with a little magic, format those interfaces through a local web-proxy,
for total platform independence.  *OR* have a GTK client!)

This really sounds like black magic, but there is some precedent for it in
widgets.Form.  The general idea is that, for a method like:

  def formattedMath(op, a, b):
      result = op(a, b)
      return "%s %s %s = %s" % (a, op.__name__, b, result)

You'd present a list that looked like:

   import form
   [["op", form.Menu(["Multiply", operator.mul],
                     ["Add", operator.add],
                     ["Subtract", operator.sub],
                     ["Divide", operator.div])],
    ["a", form.Number()],
    ["b", form.Number()]]

That would provide a user-interface that could provide nice input constraints
for invoking that method.

The biggest problem I've hit so far with this idea is how to provide a
reasonable default appearance of various data-types while still allowing for
formattable customization in the template.  I've got some vague ideas of how to
fix this by allowing embedding of certain specifically-named elements in a
template and providing a default template that has all elements provided.

Even if I managed to get this right for the web, though, trying to avoid lock
in to the web's way of thinking about forms is very tricky!  I have yet to
seriously think about how GTK, PyUI, or Tkinter would work with this.  I have
spent a little while thinking about how a text-based virtual world interface in
twisted reality, though, and that should be pretty easy (building a machine
with dials, knobs, etc, and a big button for "submit").

4. Generalized Tree Structure for Twisted Applications
======================================================

I want to have it so that Twisted apps are easily navigable and arbitrarily
manipulable, almost like a virtual filesystem.  The most obvious application of
this is to make something like 'mktap --append' generally _work_ when you add
stuff to a .tap.

The current hierarchical nature of services is a step in this direction, though
it clearly doesn't go high enough.  Right now, mktap --append could be checking
for the existence of services, allowing you to add new services at given
'paths' inside the application without binding ports... though it isn't, and
this requires a fair amount of logical restructuring of the tap plugin
metaphor.

In keeping with the idea of URLs for PB, it would be nice if each object, as it
was inserted into this hierarchy, would get a notification that it was now
available at a new URL, or that it had been removed from a URL.
(availableAtURL) These URLs would include information about how it was
accessible from within the .tap (twisted://tcp/80) and how it was accessible to
the outside world (http://64.123.27.105/you/are/here/,
telnet://user at 64.123.27.105/obj).

Objects could much more reliably provide hyperlinks to themselves in this case,
and that would be a very neat feature.  In addition, the sysadmin's view of
Twisted would be greatly simplified.


5. Future directions for Words
==============================

I already explained this to some extent in Words's massive docstring update, so
I'll be brief.  Twisted words ought to be a distributed, consensus directory
service for chat groups, not a centralized (though hierarchical and
geographically dispersed) message relaying service like IRC.

Chat groups really ought to have a lot of metadata associated with them,
including a customizable summary homepage and an RSS feed.  Ideally once we're
sure that Woven is not terribly exploitable via the web (see idea 2), we can
allow users to upload templates directly.

Also, group membership should be persistent.  The ability to join the group as
a "regular" is an interesting function and I'm wondering how it can be done.
First-come-first-serve options for grabbing names seems like they'd encourage
squatting.  I think that by having a distributed naming system (where different
people call the "python" group different things, but python at twistedmatrix.com
will always get you to the one you're looking for) might circumvent squatting.

-------------------

Anyway, that's all for tonight.  I hope that this is useful to some of you out
there who are wondering what I'm thinking about such things :)

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021008/fe6cbb05/attachment.sig>

From twisted at moshez.org  Tue Oct  8 01:20:47 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 8 Oct 2002 07:20:47 -0000
Subject: [Twisted-Python] the news tap
Message-ID: <20021008072047.1463.qmail@green.zadka.com>

I dislike *immensely* the news tap's usage of raw_input -- this is just
WRONG. This means that a future usage.Options which uses a GUI (which
is not that unlikely) would be reduced to asking questions on the console.

In all cases, the raw_input should have been parameters on the command line.
I would like to take this moement to remind you what taps are and are not:

* a tap plugin is not "the cannonical way to use a module"
* a tap plugin is a way to prgrogrammatically record useful ways to configure
  an Application

Thus, in my opinion, the current news tap should be split into

* A dbnews plugin, which asks for the db parameters
* A picklenews plugin, which asks for the file name
[A future hack: * A dirdbm plugin, which asks for a directory name]



From tv at twistedmatrix.com  Tue Oct  8 10:44:04 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Tue, 8 Oct 2002 19:44:04 +0300
Subject: [Twisted-Python] Twisted performance?
In-Reply-To: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
References: <Pine.LNX.4.44.0210070833140.26529-100000@ns0.tbye.com>
Message-ID: <20021008164404.GA5790@ki.yok.utu.fi>

On Mon, Oct 07, 2002 at 09:08:08AM -0700, dave at pythonapocrypha.com wrote:
> Requests per second is only mildly interesting to me - our
> application is all about total throughput. It's essentially a custom
> HTTP server for large files (few hundred megabytes), so I'm looking
> for total throughput numbers for a few high-speed connections as
> well as for many slow (modem or slow DSL) connections. For example,
> on a 800 MHz PIII with a SCSI drive we can currently sustain around
> 300 Mbps total across 100 non-rate-limited connections (pulling the
> data off the disk), and 300 Mbps total across about 1000 or so 150
> Kbps connections. On a faster CPU and no disk access we occasionally
> hit a gigabit per second across 50 or so full-speed connections, but
> my target is only about 250 Mbps per machine, assuming the CPU is in
> the < 1 GHz range. One problem with our implementation is that the
> performance curve drops off too quickly as number of concurrent
> connections go up. I'd love to sustain 250 Mbps across 2000 or more
> connections; for now we compensate by buying more CPU (which isn't
> too big of a problem).

	Umm, you want recent 2.4 kernel, sendfile(2) and
	http://www.kegel.com/c10k.html.
	Maybe throw in an Intel e1000 with TCP segment offloading.

	But maybe that's just the kernel hacker in me.

-- 
:(){ :|:&};:



From tv at twistedmatrix.com  Tue Oct  8 11:08:14 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Tue, 8 Oct 2002 20:08:14 +0300
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021008.020424.07435626.glyph@twistedmatrix.com>
References: <20021008.020424.07435626.glyph@twistedmatrix.com>
Message-ID: <20021008170814.GB5790@ki.yok.utu.fi>

On Tue, Oct 08, 2002 at 02:04:24AM -0500, Glyph Lefkowitz wrote:
> 1. Perspective Broker URLS
> ==========================

> These URLs need to be able to represent transport mechanism (TCP? UNIX socket?
> SSL? Weird firewall-tunneling stuff?)

	"Talk to subprocess that runs this command to connect to the other end"
	("ssh remotehost pbserver", "ssh remotehost
	connect-stdinout-to-unix-socket /path/socket")

	And yes, I may want that even after Twisted has a fully working
	SSH implementation. For rex :)

>                                       plus everything about the object that
> you're trying to access (location? authentication information? authentication
> format?)

	I think you may want to look at SASL for ideas on
	authentication. It seems to be the standard way to add generic
	authentication support to a protocol these days.

> The idea is that you pass in a string, you get a Deferred PB "endpoint", which
> should be the object that you're really wanting to interact with.  Here are
> some off-the-cuff examples:
> 
>     pb://pyramid/service#perspective

	What part talks about TCP/UNIX/etc? service? Then it needs
	more structure to it.

>     pb://pyramid/identity:password at service#perspective

	Eww. Passwords in URLs is baaad. Because users like to enter
	URLs on command line.

	I'd much rather see an explicit "--password-file filename" and
	"--password-fd n".

> Public-key authentication mechanism, using the same identity name.  Connection
> over SSH transport (sshkey auth only available this way).
> 
>     pb-ssl://pyramid/cert$identity at service#perspective
> 
> PB over SSL, using certificate auth.
> 
>     pb://pyramid/this/that/the-other/my-service#perspective

	Hmm. Idea. Allow one to specify when the server is trusted.
	"Connect to server X if its public key has fingerprint F."
	http://www.fs.net/

> 2. Automatic XSS input scrubbing for Woven
> ==========================================
> 
> Form input that is intended to be used as HTML can be scanned for potentially
> abusive input so that the web administration interface for a bulletin board
> written using Twisted doesn't fall prey to the usual "cross site scripting"
> vulnerabilities that plague feedback-capable web sites.
> 
> The problem formulation, generally, is that an attacker will place some
> malicious javascript in a web form.  When some article is viewed by an admin,
> that malicious javascript executes in their browser, taking advantage of the
> fact that they have an admin cookie for that website in their browser.  It will
> take advantage of a security flaw in the browser and perform administrative
> tasks with their authority on the website without the admin's approval.
> 
> There are pretty much only a few ways they can do this, and I believe each one
> has a simple solution.
> 
>     - <script /> tags
> 
> Don't allow script tags in input, ever.  Force input that uses tags into a DOM
> tree before it is even made to be preview-able.  (DOM parsing can be relaxed,
> but before the tree is output, it is converted to well-formed XML).
> 
>     - <a href="..." /> tags
> 
> Stick a little warning after any "off-site" link, and turn it into a redirect.
> Any admin clicking on such a link will first be bounced through a URL which
> revokes their admin cookie so the attacking site won't have the ability to call
> back.
> 
>     - attributes on other HTML tags, such as onmouseover, that execute js
>       expressions
> 
> Catalogue these and scrub them all off.
> 
>     - <img /> or <object /> tags that automatically download other items, which
>       may be webpages containing javascript.
> 
> Again, don't allow these tags.  Or, have the server-side site download the
> images and verify that they are PNGs (alternately also doing PIL stuff to
> remove steganographic information, if you're _really_ paranoid).

	Your basic problem here is that you are trying to disallow
	things you know are not safe. That assumes you are omnipotent.
	While not contesting that, I still feel the only sane
	architecture is to catalogue known safe things, and only allow
	those. Something like a DTD/schema should do the job.

> Even if I managed to get this right for the web, though, trying to avoid lock
> in to the web's way of thinking about forms is very tricky!  I have yet to
> seriously think about how GTK, PyUI, or Tkinter would work with this.  I have
> spent a little while thinking about how a text-based virtual world interface in
> twisted reality, though, and that should be pretty easy (building a machine
> with dials, knobs, etc, and a big button for "submit").

	You may also be interested in the W3C work on XForms.

	IMHO, form-based GUIs suck horribly. A GUI is good only if
	it is interactive -- dynamic in some way. Most of the current
	GUIs only try to reach rich with forms that change
	dynamically.

	Have you ever used mc-foo fan? While certainly not the greatest
	GUI in the world, imagine you had to use it through forms.

> squatting.  I think that by having a distributed naming system (where different
> people call the "python" group different things, but python at twistedmatrix.com
> will always get you to the one you're looking for) might circumvent squatting.

	So user A will see python at python.org as "python", user B will see
	python at twistedmatrix.com as "python", and if those two ever have
	to be squashed to the same namespace, user A will see
	"python (python at python.org)" and "python at twistedmatrix.com"
	and user B will see "python at python.org" and "python
	(python at twistedmatrix.com)"?

	All is fine as long as the users don't talk about the channel
	names that much :)

	This problem may be easier to think of in terms of nicks than of
	channels; IIRC there was some chat system that under the hood
	identified users with user at host (unix user id / email, whatever),
	but allowed them to set their list of "preferred nicknames".
	User A would see user B with the first available preferred
	nickname from B's list, or as userB at hostB if none was
	available. And this was, IIRC, done fully in A's client; if B
	and C saw different people (were on different channels), they
	could see A with a different nickname.

-- 
:(){ :|:&};:



From dave at pythonapocrypha.com  Tue Oct  8 13:52:26 2002
From: dave at pythonapocrypha.com (Dave Brueck)
Date: Tue, 8 Oct 2002 12:52:26 -0700 (PDT)
Subject: [Twisted-Python] Twisted performance?
Message-ID: <Pine.LNX.4.44.0210081251480.28969-100000@ns0.tbye.com>

On Tue, 8 Oct 2002, Tommi Virtanen wrote:

> > the < 1 GHz range. One problem with our implementation is that the
> > performance curve drops off too quickly as number of concurrent
> > connections go up. I'd love to sustain 250 Mbps across 2000 or more
> > connections; for now we compensate by buying more CPU (which isn't
> > too big of a problem).
> 
> 	Umm, you want recent 2.4 kernel, sendfile(2) and
> 	http://www.kegel.com/c10k.html.

Been there, done that. But thanks for responding! :)

-Dave





From radix at twistedmatrix.com  Tue Oct  8 17:34:55 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 9 Oct 2002 01:34:55 +0200
Subject: [Twisted-Python] Re: [Twisted-commits] added docs
In-Reply-To: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com>
References: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com>
Message-ID: <20021008233455.GA472@toshi>

On Tue, Oct 08, 2002 at 04:12:01AM -0500, warner CVS wrote:
> Modified files:
> Twisted/ChangeLog 1.133 1.134
> 
> Log message:
> added docs


I'm freaking impressed. These are some damned good docs -- thanks
tons.



From andrew-twisted at puzzling.org  Tue Oct  8 17:49:25 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 9 Oct 2002 09:49:25 +1000
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021008170814.GB5790@ki.yok.utu.fi>
References: <20021008.020424.07435626.glyph@twistedmatrix.com> <20021008170814.GB5790@ki.yok.utu.fi>
Message-ID: <20021008234925.GA30177@ritsuko.xware.cx>

On Tue, Oct 08, 2002 at 08:08:14PM +0300, Tommi Virtanen wrote:
> On Tue, Oct 08, 2002 at 02:04:24AM -0500, Glyph Lefkowitz wrote:
> 
> > 2. Automatic XSS input scrubbing for Woven
> > ==========================================
[..snip..]
> >     - attributes on other HTML tags, such as onmouseover, that execute js
> >       expressions
> > 
> > Catalogue these and scrub them all off.
> > 
> >     - <img /> or <object /> tags that automatically download other
> >       items, which may be webpages containing javascript.
> > 
> > Again, don't allow these tags.  Or, have the server-side site download the
> > images and verify that they are PNGs (alternately also doing PIL stuff to
> > remove steganographic information, if you're _really_ paranoid).
> 
> 	Your basic problem here is that you are trying to disallow
> 	things you know are not safe. That assumes you are omnipotent.
> 	While not contesting that, I still feel the only sane
> 	architecture is to catalogue known safe things, and only allow
> 	those. Something like a DTD/schema should do the job.

Agreed.  You need a whitelist to do this 100%, not a blacklist.  New
browser versions invent new ways of injecting js into HTML, so a
blacklist can never hope to be complete.  BugTraq has seen this every
time a major new browser version is released.  Also be aware of nasty
tricks like "onmouse&x6f;ver" or however it is you can encode random
ascii (or unicode!) entities -- most browsers will still understand
that.  Your filter needs to as well.

I think there may be a fundamental flaw to filtering this with Woven.
Woven assumes correctly formed XML.  Browsers will still execute js on a
page that is HTML (or even HTML-ish!), even if it isn't XML.  That
already means there's probably tricks that lie outside the set of what
Woven can deal with -- though perhaps Woven can't generate them in the
first place?

If you intend to build XSS protection into Woven, I strongly recommend
you look through BugTraq's archives to get some idea of the wide variety
of techinques that can be involved -- in fact, I think they've started a
seperate mailing list for XSS now.

-Andrew.




From rc at ghostbitch.org  Tue Oct  8 17:44:52 2002
From: rc at ghostbitch.org (rc at ghostbitch.org)
Date: Tue, 8 Oct 2002 16:44:52 -0700
Subject: [Twisted-Python] Re: [Twisted-commits] added docs
In-Reply-To: <20021008233455.GA472@toshi>
References: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com> <20021008233455.GA472@toshi>
Message-ID: <20021008234452.GG24749@modey.miralink.com>

On Wed, Oct 09, 2002 at 01:34:55AM +0200, Christopher Armstrong wrote:
> On Tue, Oct 08, 2002 at 04:12:01AM -0500, warner CVS wrote:
> > Modified files:
> > Twisted/ChangeLog 1.133 1.134
> > 
> > Log message:
> > added docs
> 
> 
> I'm freaking impressed. These are some damned good docs -- thanks
> tons.
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

Well put.



From jml at mumak.net  Tue Oct  8 22:38:09 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Wed, 9 Oct 2002 15:38:09 +1100
Subject: [Twisted-Python] Woven feature suggestion - Error pages
Message-ID: <20021009043809.GB22798@mumak.net>

Unfortunately, I'm going to have to start on the wrong foot. Please bear
with me.

When writing JSPs (see, I told you), one of the useful things you can do
is specify an error page. If the JSP throws an exception, but fails to
catch it, the error page is displayed instead. Within the error page,
there is an implicit 'exception' variable that refers to the caught 
exception.

>From memory, it is also possible to configure different web pages for
different types of exceptions in the web.xml descriptor (which is
where application-wide settings are kept)

In the past, I've mainly used this feature to have an
appropriately-skinned, user friendly error message instead of a stack
trace. I haven't found it useful for much else.

Something similar within Woven would be nice. And there's probably
scope to improve on the way JSP does it and make it more useful.

jml



From andrew-twisted at puzzling.org  Tue Oct  8 23:35:26 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 9 Oct 2002 15:35:26 +1000
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021008.020424.07435626.glyph@twistedmatrix.com>
References: <20021008.020424.07435626.glyph@twistedmatrix.com> <20021008170814.GB5790@ki.yok.utu.fi>
Message-ID: <20021009053526.GB1130@ritsuko.xware.cx>

On Tue, Oct 08, 2002 at 02:04:24AM -0500, Glyph Lefkowitz wrote:

>     pb://pyramid/identity:password at service#perspective

I was discussing this with someone, and they pointed out that this is an
odd way of doing things.  In HTTP, you do:
    http://user at domain/path/
or even
    http://user:pass at domain/path/

Your reason is presumably because the username/password is determined by
the service, not the host -- but this is also the case for HTTP.  Some
paths may require authentication, some may require none.

I can see arguments both ways.  I'm not sure which way is better, but if
you are claiming similarity to existing URLs, you may wish to consider
this...

-Andrew.




From typo at soniq.net  Wed Oct  9 07:25:00 2002
From: typo at soniq.net (Paul Boehm)
Date: Wed, 9 Oct 2002 15:25:00 +0200
Subject: [Twisted-Python] web.static & woven.widgets patches
Message-ID: <20021009132500.GA29817@soniq.net>

hi,

the included patches haven't been applied to the repository yet.

there's no unittest for web Redirects, and the
the patch to static.py is a bugfix. while it probably isn't
the cleanest way to do these redirects, it's definitely better 
than the original code which breaks index.rpy query_string's,
and leads to urls like http://bla///////.

i too found no unittests for woven, and my patch allows to
check checkboxes via the model. this shouldn't break anything
either.

can anyone give me a statement regarding those patches?

diff -u -r1.63 static.py
--- static.py   1 Oct 2002 17:28:46 -0000       1.63
+++ static.py   4 Oct 2002 16:58:34 -0000
@@ -253,10 +253,12 @@
             # If someone is looking for children with a PathReferenceContext,
             # the request won't have a prepath, and we shouldn't do this kind
             # of mangling anyway because it has already been done.
-            if hasattr(request, 'postpath') and not request.postpath and request.uri[-1] != '/':
+            if hasattr(request, 'postpath') and not request.postpath and \
+                        string.split(request.uri,'?')[0][-1] != '/':
                 return Redirect(request)
             if os.path.exists(childPath):
-                if hasattr(request, 'postpath') and not request.postpath and not self.getIndex(request):
+                if hasattr(request, 'postpath') and not request.postpath and \
+                                                not self.getIndex(request):
                     return widgets.WidgetPage(DirectoryListing(self.path))


diff -u -r1.20 widgets.py
--- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
+++ widgets.py  4 Oct 2002 16:52:50 -0000
@@ -388,13 +388,17 @@

     def generateDOM(self, request, node):
         mVal = self.getData()
-        if mVal:
-            self['value'] = str(mVal)
+        self['value'] = str(mVal)
         return Widget.generateDOM(self, request, node)

 class CheckBox(Input):
     def initialize(self):
         self['type'] = 'checkbox'
+    def generateDOM(self, request, node):
+        node = Input.generateDOM(self, request, node)
+        if self.getData():
+            node.setAttribute('checked', "checked")
+        return node

 class RadioButton(Input):
     def initialize(self):




From typo at soniq.net  Wed Oct  9 08:32:43 2002
From: typo at soniq.net (Paul Boehm)
Date: Wed, 9 Oct 2002 16:32:43 +0200
Subject: [Twisted-Python] woven-bug: multiple nodes using the same model
Message-ID: <20021009143243.GA21447@soniq.net>

when a controller and a widget have the same model, this leads to
lots of weird inconsistencies.

i use this template:

        <form action="" name="addserver" model="listall" controller="addserver">
            Host:
            <input type="text" name="host" />
            Port:
            <input type="text" name="port" />
            <input type="submit" value="Add" />
        </form>

        <form action="">
            <span class="heading">All Servers:</span>
            <ul model="listall" view="List">
                <li id="emptyList">No Servers defined</li>
                <li id="listItem">
                    <span view="Text" model="0" />
                    <span view="Text" model="1" />
                    <span view="CheckBox" model="2" value="1" />
                    <span view="CheckBox" model="3" value="1" />
                </li>
            </ul>
            <input type="submit" />
        </form>

This results in two calls to widgets.List.generateDOM, which produces
inconsistencies. 

I'm not sure which code is at fault, but List at least produces a wrong 
_submodel_prefix. Because of this i modified List to reset the Attribute
on every call:

#            domhelpers.superAppendAttribute(newNode, '_submodel_prefix',
#                                            submodel)
            domhelpers.superSetAttribute(newNode, '_submodel_prefix',
                                            submodel)
            domhelpers.superAppendAttribute(newNode, '_submodel_prefix',
                                            str(itemNum))

This fixes the wrong _submodel_prefix, but the List view still lags behind
one added element per submit. after a normal reload all the data is displayed
correctly.

Also all listitems get displayed with the same value every time after
submitting.

when i reload with a failing Handler.check, i get the right values, though.

i'm trying to debug this right now, but some help from someone with a
better understanding of woven's internals would be really helpful.

  paul



From typo at soniq.net  Wed Oct  9 08:56:57 2002
From: typo at soniq.net (Paul Boehm)
Date: Wed, 9 Oct 2002 16:56:57 +0200
Subject: [Twisted-Python] woven-bug: multiple nodes using the same model
In-Reply-To: <20021009143243.GA21447@soniq.net>
References: <20021009143243.GA21447@soniq.net>
Message-ID: <20021009145657.GB21447@soniq.net>

ok,

this fixes at least the problem with List repeating the same
element all over (instead of listing all elements).
(patch made against my local tree, also contains added CheckBox
functionality).

i'm still working on the problem that the view lags behind the model.

diff -u -r1.20 widgets.py
--- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
+++ widgets.py  9 Oct 2002 14:55:54 -0000
@@ -270,7 +270,7 @@
         newNode = self.generateDOM(request, oldNode)
         mutator = template.NodeNodeMutator(newNode)
         mutator.d = request.d
-        mutator.generate(request, oldNode)
+        mutator.generate(request, newNode)
         self.node = newNode

     def __setitem__(self, item, value):
@@ -395,6 +395,11 @@
 class CheckBox(Input):
     def initialize(self):
         self['type'] = 'checkbox'
+    def generateDOM(self, request, node):
+        node = Input.generateDOM(self, request, node)
+        if self.getData():
+            node.setAttribute('checked', "checked")
+        return node

 class RadioButton(Input):
     def initialize(self):




From dp at twistedmatrix.com  Wed Oct  9 11:07:03 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 9 Oct 2002 10:07:03 -0700
Subject: [Twisted-Python] woven-bug: multiple nodes using the same model
In-Reply-To: <20021009143243.GA21447@soniq.net>
Message-ID: <880D7B05-DBA9-11D6-BF03-000393B3EC2C@twistedmatrix.com>

Hi,

Thanks for the bug report. I have known about this issue for a while; 
it's tricky otherwise I would have solved it by now. Here's the issue:

The Widget gets generated, and mutates the original Template node from 
the HTML template. However, it has rendered the old data.

The controller gets some input and updates the model with some new data.

The controller sends a notification to the model telling it it has 
changed, and the model forwards these notifications to all views that 
want it (Widgets)

The widget then gets re-generated, but the DOM node it works on isn't 
the same as it was in the template HTML, so funny things happen.

This is the same issue radix was seeing where a node would get a piece 
of text inserted into it multiple times.

I think the solution is for each widget to store a copy of the original 
template node, so it can operate on a fresh copy the second time; I'm 
testing this change right now. Maybe I'll even write some tests.

Donovan




From hbl at st-andrews.ac.uk  Wed Oct  9 03:06:16 2002
From: hbl at st-andrews.ac.uk (Hamish Lawson)
Date: Wed, 09 Oct 2002 10:06:16 +0100
Subject: [Twisted-Python] Quixote/Twisted Integration
Message-ID: <5.1.1.6.0.20021009100428.00b02ea0@spey.st-andrews.ac.uk>

Moshe Zadka wrote:

>I've added a feature to the Twisted web server where it can use Quixote's
>PTL.

While on matters Quixotic, what is the current state of play regarding 
using Quixote's object publishing with Twisted? Some issues were touched 
upon in the following posts. Is there now a working driver?

     http://mail.mems-exchange.org/pipermail/quixote-users/2002-June/000606.html

     http://twistedmatrix.com/pipermail/twisted-python/2002-June/001216.html


Hamish Lawson





From glyph at twistedmatrix.com  Wed Oct  9 12:19:57 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 09 Oct 2002 13:19:57 -0500 (CDT)
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021009053526.GB1130@ritsuko.xware.cx>
References: <20021008.020424.07435626.glyph@twistedmatrix.com>
	<20021008170814.GB5790@ki.yok.utu.fi>
	<20021009053526.GB1130@ritsuko.xware.cx>
Message-ID: <20021009.131957.07618741.glyph@twistedmatrix.com>


On Wed, 9 Oct 2002 15:35:26 +1000, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

> Your reason is presumably because the username/password is determined by the
> service, not the host -- but this is also the case for HTTP.  Some paths may
> require authentication, some may require none.

Not "*the* service", but "a service".  In HTTP, you authenticate with the
server, because some URLs may be in managed "realms".

In PB, some objects may require authentication to access.  This means that you
might have to authenticate multiple times in the same URL.  I know that my
suggestion for URLs violates the accepted "standard" in some ways, but that's
because PB doesn't consider "server" to be a useful level of abstraction.
Everything is about objects.

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021009/65cdc1ec/attachment.sig>

From glyph at twistedmatrix.com  Wed Oct  9 12:44:14 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 09 Oct 2002 13:44:14 -0500 (CDT)
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021008170814.GB5790@ki.yok.utu.fi>
References: <20021008.020424.07435626.glyph@twistedmatrix.com>
	<20021008170814.GB5790@ki.yok.utu.fi>
Message-ID: <20021009.134414.07435605.glyph@twistedmatrix.com>

On Tue, 8 Oct 2002 20:08:14 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
> On Tue, Oct 08, 2002 at 02:04:24AM -0500, Glyph Lefkowitz wrote:

> > These URLs need to be able to represent transport mechanism (TCP? UNIX socket?
> > SSL? Weird firewall-tunneling stuff?)

> 	"Talk to subprocess that runs this command to connect to the other end"
> 	("ssh remotehost pbserver", "ssh remotehost
> 	connect-stdinout-to-unix-socket /path/socket")

> 	And yes, I may want that even after Twisted has a fully working
> 	SSH implementation. For rex :)

I don't quite get what you're talking about here.  You want the URLs to be
shell command-lines? :)

> 	I think you may want to look at SASL for ideas on
> 	authentication. It seems to be the standard way to add generic
> 	authentication support to a protocol these days.

>From what I can tell, it wouldn't work at all for PB.  From the RFC:

   In the case that a profile explicitly permits multiple successful SASL
   negotiations to occur, then in no case may multiple security layers be
   simultaneously in effect.  If a security layer is in effect and a subsequent
   SASL negotiation selects no security layer, the original security layer
   remains in effect.  If a security layer is in effect and a subsequent SASL
   negotiation selects a second security layer, then the second security layer
   replaces the first.

I understand that there are considerations where authentication is bound up in
link-layer security (public key crypto) but for most cases I'd like to keep
them separate so you can authenticate to multiple objects requiring different
authentication conversations in the same session.

> >     pb://pyramid/service#perspective

> 	What part talks about TCP/UNIX/etc? service? Then it needs more
> 	structure to it.

Same as with HTTP:
    pb://pyramid/service == pb-tcp://pyramid/service
    pb-ssl://pyramid/service
    pb-unix:/foo/bar://service

> >     pb://pyramid/identity:password at service#perspective

> 	Eww. Passwords in URLs is baaad. Because users like to enter URLs on
> 	command line.

> 	I'd much rather see an explicit "--password-file filename" and
> 	"--password-fd n".

Yes, and smart users will use that, for the most part.  Still, you need a way
to represent simple authentication as part of a URL.  Sometimes the URLs
themselves will be secret and the authentication information will be a swiss
number or something.  E does everything through exchange of URLs, and it's
pretty secure.

> > Public-key authentication mechanism, using the same identity name.  Connection
> > over SSH transport (sshkey auth only available this way).
> > 
> >     pb-ssl://pyramid/cert$identity at service#perspective
> > 
> > PB over SSL, using certificate auth.
> > 
> >     pb://pyramid/this/that/the-other/my-service#perspective

> 	Hmm. Idea. Allow one to specify when the server is trusted.  "Connect
> 	to server X if its public key has fingerprint F."  http://www.fs.net/

Any proposals for how to implement that?

> > [ ... ]

> >     - <img /> or <object /> tags that automatically download other items, which
> >       may be webpages containing javascript.
> > 
> > Again, don't allow these tags.  Or, have the server-side site download the
> > images and verify that they are PNGs (alternately also doing PIL stuff to
> > remove steganographic information, if you're _really_ paranoid).
> 
> 	Your basic problem here is that you are trying to disallow
> 	things you know are not safe. That assumes you are omnipotent.
                                                           ^

I assume you mean "omniscient".  If I were omnipotent, I would smite skript
kiddies with lightning from the sky, and forget about all this software-level
security :)

> 	While not contesting that, I still feel the only sane architecture is
> 	to catalogue known safe things, and only allow those. Something like a
> 	DTD/schema should do the job.

Okay, you have a point.  Still, it is useful to know which are potentially
problematic so that we can allow the usage of things like IMG with appropriate
warnings and links that remove session privileges first.

> > Even if I managed to get this right for the web, though, trying to avoid lock
> > in to the web's way of thinking about forms is very tricky!  I have yet to
> > seriously think about how GTK, PyUI, or Tkinter would work with this.  I have
> > spent a little while thinking about how a text-based virtual world interface in
> > twisted reality, though, and that should be pretty easy (building a machine
> > with dials, knobs, etc, and a big button for "submit").
> 
> 	IMHO, form-based GUIs suck horribly. A GUI is good only if
> 	it is interactive -- dynamic in some way. Most of the current
> 	GUIs only try to reach rich with forms that change
> 	dynamically.

> 	Have you ever used mc-foo fan? While certainly not the greatest GUI in
> 	the world, imagine you had to use it through forms.

Some GUIs simply don't work with forms.

On the other hand, there's a large class of GUI that does.  In fact some might
say that most of the GUIs in the world are form-based.  If forms couldn't
represent a large number of things that people want to do when interacting with
a computer, then the web would have died an early death.

> > squatting.  I think that by having a distributed naming system (where different
> > people call the "python" group different things, but python at twistedmatrix.com
> > will always get you to the one you're looking for) might circumvent squatting.

> 	So user A will see python at python.org as "python", user B will see
> 	python at twistedmatrix.com as "python", and if those two ever have to be
> 	squashed to the same namespace, user A will see "python
> 	(python at python.org)" and "python at twistedmatrix.com" and user B will see
> 	"python at python.org" and "python (python at twistedmatrix.com)"?

This is how e-mail naming works, isn't it?  User A is connecting to python.org,
user B is connecting to twistedmatrix.com.  The difference is that hosts may
provide either redirects for a certain name between each other, or relays for a
particular channel (a-la ry).

> 	This problem may be easier to think of in terms of nicks than of
> 	channels; IIRC there was some chat system that under the hood
> 	identified users with user at host (unix user id / email, whatever), but
> 	allowed them to set their list of "preferred nicknames".  User A would
> 	see user B with the first available preferred nickname from B's list,
> 	or as userB at hostB if none was available. And this was, IIRC, done fully
> 	in A's client; if B and C saw different people (were on different
> 	channels), they could see A with a different nickname.

This is an interesting idea, but it has the potential to be pretty confusing, I
think.  Tacking on an implicit domain name to channel/user names is a
convenience, but shifting around the displayed name is potentially even more
confusing.  (At least: as I understand it, I was thinking the user would type
"join python" and get a window that says "python at twistedmatrix.com"; what
you're suggesting is that the user types "join python at twistedmatrix.com" and
gets a window that says "Arglebargle!" because that is the python group's
preferred nickname? )

Thanks for the response.


-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |



From bruce at cubik.org  Wed Oct  9 13:21:19 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 09 Oct 2002 13:21:19 -0600
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
References: <20021008.020424.07435626.glyph@twistedmatrix.com>	<20021008170814.GB5790@ki.yok.utu.fi>	<20021009053526.GB1130@ritsuko.xware.cx> <20021009.131957.07618741.glyph@twistedmatrix.com>
Message-ID: <3DA481AF.6010208@cubik.org>

Glyph Lefkowitz wrote:
 > On Wed, 9 Oct 2002 15:35:26 +1000, Andrew Bennetts
 >   <andrew-twisted at puzzling.org> wrote:
 >>Your reason is presumably because the username/password is
 >>determined by the service, not the host -- but this is also
 >>the case for HTTP.  Some paths may require authentication,
 >>some may require none.
 >
 > Not "*the* service", but "a service".  In HTTP, you authenticate
 > with the server, because some URLs may be in managed "realms".
 >
 > In PB, some objects may require authentication to access.  This
 > means that you might have to authenticate multiple times in the
 > same URL.  I know that my suggestion for URLs violates the
 > accepted "standard" in some ways, but that's because PB doesn't
 > consider "server" to be a useful level of abstraction. Everything
 > is about objects.

So, have you looked at DNS Service Discovery at all and how that should 
fit in with PB?

    http://www.dns-sd.org/

  - Bruce




From bruce at cubik.org  Wed Oct  9 13:29:20 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 09 Oct 2002 13:29:20 -0600
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
References: <20021008.020424.07435626.glyph@twistedmatrix.com>	<20021008170814.GB5790@ki.yok.utu.fi> <20021009.134414.07435605.glyph@twistedmatrix.com>
Message-ID: <3DA48390.4080906@cubik.org>

Glyph Lefkowitz wrote:
> On Tue, 8 Oct 2002 20:08:14 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
>>	So user A will see python at python.org as "python", user B will see
>>	python at twistedmatrix.com as "python", and if those two ever have to be
>>	squashed to the same namespace, user A will see "python
>>	(python at python.org)" and "python at twistedmatrix.com" and user B will see
>>	"python at python.org" and "python (python at twistedmatrix.com)"?
> 
> 
> This is how e-mail naming works, isn't it?  User A is connecting to python.org,
> user B is connecting to twistedmatrix.com.  The difference is that hosts may
> provide either redirects for a certain name between each other, or relays for a
> particular channel (a-la ry).
> 
> 
>>	This problem may be easier to think of in terms of nicks than of
>>	channels; IIRC there was some chat system that under the hood
>>	identified users with user at host (unix user id / email, whatever), but
>>	allowed them to set their list of "preferred nicknames".  User A would
>>	see user B with the first available preferred nickname from B's list,
>>	or as userB at hostB if none was available. And this was, IIRC, done fully
>>	in A's client; if B and C saw different people (were on different
>>	channels), they could see A with a different nickname.
> 
> 
> This is an interesting idea, but it has the potential to be pretty confusing, I
> think.  Tacking on an implicit domain name to channel/user names is a
> convenience, but shifting around the displayed name is potentially even more
> confusing.  (At least: as I understand it, I was thinking the user would type
> "join python" and get a window that says "python at twistedmatrix.com"; what
> you're suggesting is that the user types "join python at twistedmatrix.com" and
> gets a window that says "Arglebargle!" because that is the python group's
> preferred nickname? )

To what extent should prior art and IETF work be looked at in these 
sorts of areas?

Some of the more readily obvious stuff in this area would be the IETF 
IMPP working group:

     http://www.ietf.org/html.charters/impp-charter.html

and things like Jabber, Zephyr, and so on.

  - Bruce




From bruce at cubik.org  Wed Oct  9 13:33:00 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 09 Oct 2002 13:33:00 -0600
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
References: <20021008.020424.07435626.glyph@twistedmatrix.com>	<20021008170814.GB5790@ki.yok.utu.fi> <20021009.134414.07435605.glyph@twistedmatrix.com> <3DA48390.4080906@cubik.org>
Message-ID: <3DA4846C.4000504@cubik.org>

Bruce Mitchener wrote:
> To what extent should prior art and IETF work be looked at in these 
> sorts of areas?
> 
> Some of the more readily obvious stuff in this area would be the IETF 
> IMPP working group:
> 
>     http://www.ietf.org/html.charters/impp-charter.html
> 
> and things like Jabber, Zephyr, and so on.

Ooops, I meant to include SIP in that list as well, and it probably has 
applicability to things that are going on with PB as well:

     http://www.ietf.org/html.charters/sip-charter.html

  - Bruce




From bruce at cubik.org  Wed Oct  9 17:14:57 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 09 Oct 2002 17:14:57 -0600
Subject: [Twisted-Python] web.static & woven.widgets patches
References: <20021009132500.GA29817@soniq.net>
Message-ID: <3DA4B871.4060405@cubik.org>

Hey Paul,

Paul Boehm wrote:
> i too found no unittests for woven, and my patch allows to
> check checkboxes via the model. this shouldn't break anything
> either.
> 
> can anyone give me a statement regarding those patches?

Sure, on this one I can. :)

> diff -u -r1.20 widgets.py
> --- widgets.py  3 Oct 2002 15:46:26 -0000       1.20
> +++ widgets.py  4 Oct 2002 16:52:50 -0000
> @@ -388,13 +388,17 @@
> 
>      def generateDOM(self, request, node):
>          mVal = self.getData()
> -        if mVal:
> -            self['value'] = str(mVal)
> +        self['value'] = str(mVal)
>          return Widget.generateDOM(self, request, node)

That part is good and fixes a fairly ugly bug that I'd been seeing.

>  class CheckBox(Input):
>      def initialize(self):
>          self['type'] = 'checkbox'
> +    def generateDOM(self, request, node):
> +        node = Input.generateDOM(self, request, node)
> +        if self.getData():
> +            node.setAttribute('checked', "checked")
> +        return node

This part isn't good though ... any time the value="" is set with this, 
it'd be checked, when that isn't really the desired behavior.

For instance, in this random bit of a woven template (ignoring other 
random things that might be wrong with it):

     <table width="50%" model="products" view="List" class="summary"
        border="1" cellpadding="3" cellspacing="0">
         <tr class="listHeader">
             <th width="100%">Products</th>
             <th>Delete</th>
         </tr>
         <tr class="emptyList">
             <td align="center">*** None ***</td>
         </tr>
         <tr class="listItem">
             <td>&nbsp; &nbsp; &nbsp; <span view="ProductLink" /></td>
             <td align="center">
               <input view="CheckBox" controller="ProductDeleter"
                      model="productID" />
             </td>
         </tr>
         <tr class="listFooter">
             <td colspan="2" align="right"><input type='submit'
                 name='delproducts' value='Process deletions' /></td>
         </tr>
     </table>

that would produce a table with the right column being checkboxes .. but 
with all of them but the first one checked if the productID ranged from 
0-10.

  - Bruce




From warner at lothar.com  Wed Oct  9 18:27:13 2002
From: warner at lothar.com (Brian Warner)
Date: 09 Oct 2002 17:27:13 -0700
Subject: [Twisted-Python] PB URLs (was: Five Crazy Ideas to Start Your Week)
In-Reply-To: <20021009.134414.07435605.glyph@twistedmatrix.com>
References: <20021008.020424.07435626.glyph@twistedmatrix.com>
	<20021008170814.GB5790@ki.yok.utu.fi>
	<20021009.134414.07435605.glyph@twistedmatrix.com>
Message-ID: <87n0pnw332.fsf_-_@luther.lothar.com>

> > 	"Talk to subprocess that runs this command to connect to the other end"
> > 	("ssh remotehost pbserver", "ssh remotehost
> > 	connect-stdinout-to-unix-socket /path/socket")
> 
> I don't quite get what you're talking about here.  You want the URLs to be
> shell command-lines? :)

For what it's worth, the TRAMP emacs mode (a steroid-pumped descendent of
ange-ftp) offers something like this in its 'multi' specification (a stack of
access schemes to get to a file, like 1: telnet to a gateway machine, 2: ssh
from there to remote machine foo, 3: su to root, 4: access file). The syntax
is pretty painful, though, and you have to define the shell commands in
separate variables (indexed by keywords in the pathname).

> > 	I think you may want to look at SASL for ideas on
> > 	authentication. It seems to be the standard way to add generic
> > 	authentication support to a protocol these days.
> 
> From what I can tell, it wouldn't work at all for PB.  From the RFC:

True, SASL is one-encrypt/authenticate per TCP connection. It might make
sense to use it to protect the host-to-host link, and then let PB
authenticate users itself. I don't think it's sufficient to just use
encryption (and not authentication) on the wire.. you need the SASL
authentication layer to prevent a man-in-the-middle attack. Think of ssh's
host key here.

> Sometimes the URLs themselves will be secret and the authentication
> information will be a swiss number or something. E does everything through
> exchange of URLs, and it's pretty secure.

What's the E you refer to here?

> > 	Hmm. Idea. Allow one to specify when the server is trusted.  "Connect
> > 	to server X if its public key has fingerprint F."  http://www.fs.net/
> 
> Any proposals for how to implement that?

I looked at fs.net but wasn't able to follow most of it. The basic idea
seemed to be a URL that had both the DNS name of the server and a hash of the
server's public key. It's kind of like one of the IPv6 proposals to separate
addressing from routing: the name says how to get there, the fingerprint
tells you (after the fact) that you've reached the right spot. Makes the URLs
awfully big, though.

> Not "*the* service", but "a service".  In HTTP, you authenticate with the
> server, because some URLs may be in managed "realms".
> 
> In PB, some objects may require authentication to access. This means that
> you might have to authenticate multiple times in the same URL. I know that
> my suggestion for URLs violates the accepted "standard" in some ways, but
> that's because PB doesn't consider "server" to be a useful level of
> abstraction. Everything is about objects.

Right, so users ought to be scoped to a service? or perhaps an object
provided by a service. One potential problem: the current implementation
sends the username first, and expects to respond to a password challenge
second. Service and perspective come only after user/pass have been
validated. If user objects (Identities) are supposed to be children of the
service, the login process will probably have to change to accept a service
name first.

 -Brian



From warner at lothar.com  Wed Oct  9 18:33:29 2002
From: warner at lothar.com (Brian Warner)
Date: 09 Oct 2002 17:33:29 -0700
Subject: [Twisted-Python] Re: [Twisted-commits] added docs
In-Reply-To: <20021008234452.GG24749@modey.miralink.com>
References: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com>
	<20021008233455.GA472@toshi>
	<20021008234452.GG24749@modey.miralink.com>
Message-ID: <87it0bw2sm.fsf@luther.lothar.com>

> > I'm freaking impressed. These are some damned good docs -- thanks
> > tons.

Aw shucks. Thanks.. I'm glad you found them useful.

I'm going to try and edit them some more, make the twisted.cred examples a
bit more coherent.

Please let me know if you find ways in which they could be more helpful. I'm
trying to imagine a more "from the ground up" route to learning Twisted, and
intend to write more docs along that path. For me, the "writing servers" doc
was the best starting point, and my pb-tour doc was meant to follow that.

If you see something in twisted that you want to use but haven't figured out
how, let me know so I can add it to the list of stuff to look at.

thanks,
 -Brian



From warner at lothar.com  Wed Oct  9 18:36:42 2002
From: warner at lothar.com (Brian Warner)
Date: 09 Oct 2002 17:36:42 -0700
Subject: [Twisted-Python] jfi: twisted pygame :)
In-Reply-To: <20020927221812.GA12049@soniq.net>
References: <20020927221812.GA12049@soniq.net>
Message-ID: <87elazw2n9.fsf@luther.lothar.com>

Paul Boehm <typo at soniq.net> writes:
> took me longer to write this mail, than to convert a simple pygame
> based scrolling game to twisted + pygame. 

Cool! Could I persuade you to post a simple example of how you integrated the
event loops? I'm just starting to get into pygame; it would make multiplayer
stuff a lot easier if I could use twisted at the same time.

thanks,
 -Brian



From ericmangold at myrealbox.com  Wed Oct  9 19:24:18 2002
From: ericmangold at myrealbox.com (Eric Mangold)
Date: Wed, 09 Oct 2002 20:24:18 -0500
Subject: [Twisted-Python] Patch
Message-ID: <1034213058.c0c51500ericmangold@myrealbox.com>

Here's a tiny patch against doc/howto/listings/TwistedQuotes/pbquoteclient.py. Since 30 (the timeout) is not passed by keyword, it's taking the place of the 'client' kwarg.

-Eric Mangold (teratorn)


-------------- next part --------------
A non-text attachment was scrubbed...
Name: pbquoteclient.py.diff
Type: application/octet-stream
Size: 575 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021009/adb00c04/attachment-0002.obj>

From typo at soniq.net  Wed Oct  9 19:35:45 2002
From: typo at soniq.net (Paul Boehm)
Date: Thu, 10 Oct 2002 03:35:45 +0200
Subject: [Twisted-Python] web.static & woven.widgets patches
In-Reply-To: <3DA4B871.4060405@cubik.org>
References: <20021009132500.GA29817@soniq.net> <3DA4B871.4060405@cubik.org>
Message-ID: <20021010013545.GA4157@soniq.net>

On Wed, Oct 09, 2002 at 05:14:57PM -0600, Bruce Mitchener wrote:
> that would produce a table with the right column being checkboxes .. but 
> with all of them but the first one checked if the productID ranged from 
> 0-10.

i think it's a weird idea to use the productid as a model for checkbox
checkedness... other suggestions?

  paul



From typo at soniq.net  Wed Oct  9 19:44:45 2002
From: typo at soniq.net (Paul Boehm)
Date: Thu, 10 Oct 2002 03:44:45 +0200
Subject: [Twisted-Python] tap security problem
In-Reply-To: <20021005.135305.55498724.glyph@twistedmatrix.com>
References: <20021005124822.GA5322@soniq.net> <20021005.135305.55498724.glyph@twistedmatrix.com>
Message-ID: <20021010014445.GB4157@soniq.net>

On Sat, Oct 05, 2002 at 01:53:05PM -0500, Glyph Lefkowitz wrote:
> On Sat, 5 Oct 2002 14:48:22 +0200, Paul Boehm <typo at soniq.net> wrote:
> > As uid/gid are part of the Application, a compromised application can write
> > a shutdown.tap with different uid/gids.
> 
> Why, in a security-conscious environment, are you allowing the uid/gid that the
> server is running as to even _read_ the .tap?  In any event, the .tap is
> effectively an SUID binary, and should be writable only by root.

why wouldn't i allow the uid/gid that the server is running at, to read the tap?
after all the the tap is nothing but a snapshot of the running application?

if twistd did setuid() etc. calls before loading the tap, this would yield
a definite improvement in security. e.g. chroot already is defined by twistd,
presumably because it too requires root privileges to be used.

> The whole notion of this automatic persistence is somewhat at odds with that of
> security - .tap persistence is very explicitly designed to have no security
> constraints whatsoever, but to be very convenient.  If you need both
> persistence and security, then you have to design your persistence mechanism to
> constrain what can be persisted.  Pickle effectively allows literal code to be
> stored and executed.

the persisted tap shouldn't allow me to do anything i couldn't do with a
hijacked application running at some uid. i don't see why i shouldn't be able
to load a tap and run it with less privileges.

as i see it, tap r/w access shouldn't be any different from application code access 
in terms of severity.

  paul



From typo at soniq.net  Wed Oct  9 19:48:41 2002
From: typo at soniq.net (Paul Boehm)
Date: Thu, 10 Oct 2002 03:48:41 +0200
Subject: [Twisted-Python] jfi: twisted pygame :)
In-Reply-To: <87elazw2n9.fsf@luther.lothar.com>
References: <20020927221812.GA12049@soniq.net> <87elazw2n9.fsf@luther.lothar.com>
Message-ID: <20021010014841.GA15896@soniq.net>

On Wed, Oct 09, 2002 at 05:36:42PM -0700, Brian Warner wrote:
> Cool! Could I persuade you to post a simple example of how you integrated the
> event loops? I'm just starting to get into pygame; it would make multiplayer
> stuff a lot easier if I could use twisted at the same time.

sure,
while it still needs lot of refining, this is a start:

# MyGame embedded in Twisted

from pygame import time
from twisted.internet import reactor

import mygame

class PygameTimer:
    def __init__(self, game):
        self.clock = time.Clock()
        self.game = game
        self.update()

    def update(self):
        self.clock.tick()
        self.ms = self.clock.get_rawtime()

        framespeed = (1.0/100.0) * 1000
        lastspeed = self.ms
        next = framespeed - lastspeed

        print "framespeed", framespeed, "ms", self.ms, "next", next, "fps", self.clock.get_fps()

        self.game.iterate()

        if self.game.want_quit:
            self.game.cleanup()
            reactor.stop()
        else:
            reactor.callLater(next/1000.0*2.0, self.update)


if __name__ == "__main__":
    pt = PygameTimer(mygame.Game())
    reactor.run()




From twisted at itamarst.org  Wed Oct  9 19:59:04 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 9 Oct 2002 21:59:04 -0400
Subject: [Twisted-Python] ANN: TwistedJava 0.6
Message-ID: <20021009215904.20f2f337.twisted@itamarst.org>

I've just released v0.6 of the Java implementation of Perspective Broker, Twisted's remote object protocol thingie.

Other than lots of clean up, refactors, and finally protocol compatability with Twisted's PB (albeit untested comptability :), it also features a policy that should allow you to use PB from Java transparently - i.e. makes calls to remote Java objects transparent. This was kindly contributed by Brandon Wiley - it's Straw, from his project Momoko (http://momoko.sourceforge.net/).

http://itamarst.org/software/twistedjava/

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From twisted at itamarst.org  Wed Oct  9 20:16:10 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 9 Oct 2002 22:16:10 -0400
Subject: [Twisted-Python] jfi: twisted pygame :)
In-Reply-To: <20021010014841.GA15896@soniq.net>
References: <20020927221812.GA12049@soniq.net>
	<87elazw2n9.fsf@luther.lothar.com>
	<20021010014841.GA15896@soniq.net>
Message-ID: <20021009221610.264cea60.twisted@itamarst.org>

On Thu, 10 Oct 2002 03:48:41 +0200
Paul Boehm <typo at soniq.net> wrote:

> > Cool! Could I persuade you to post a simple example of how you integrated the
> > event loops? I'm just starting to get into pygame; it would make multiplayer
> > stuff a lot easier if I could use twisted at the same time.
> 
> sure,
> while it still needs lot of refining, this is a start:

Do the refining and we can add it to twisted.internet.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From twisted at itamarst.org  Wed Oct  9 20:17:56 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 9 Oct 2002 22:17:56 -0400
Subject: [Twisted-Python] tap security problem
In-Reply-To: <20021010014445.GB4157@soniq.net>
References: <20021005124822.GA5322@soniq.net>
	<20021005.135305.55498724.glyph@twistedmatrix.com>
	<20021010014445.GB4157@soniq.net>
Message-ID: <20021009221756.321a27b6.twisted@itamarst.org>

On Thu, 10 Oct 2002 03:44:45 +0200
Paul Boehm <typo at soniq.net> wrote:

> as i see it, tap r/w access shouldn't be any different from application code access 
> in terms of severity.

Sure - allow reads but *NOT*!!! writes. Because if you let var-www write to python code that's going to be imported by a suid root app you're in a bad situation.

If your tap is run by root it should not be writable by non-root users.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andrew-twisted at puzzling.org  Thu Oct 10 00:17:42 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 10 Oct 2002 16:17:42 +1000
Subject: [Twisted-Python] Jelly and Components
Message-ID: <20021010061742.GA16641@ritsuko.xware.cx>

Instead of 
    class Foo(jelly.Jellyable):
        # etc

Shouldn't we be doing:
    class Foo:
        __implements__ = jelly.IJellyable
        # etc

or:
    class Foo:
        # etc
    
    components.registerAdapter(..., Foo, jelly.IJellyable)

?

This strikes me as being like copy_reg, but better :)

-Andrew.




From twisted at itamarst.org  Thu Oct 10 00:28:36 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 10 Oct 2002 02:28:36 -0400
Subject: [Twisted-Python] Jelly and Components
In-Reply-To: <20021010061742.GA16641@ritsuko.xware.cx>
References: <20021010061742.GA16641@ritsuko.xware.cx>
Message-ID: <20021010022836.150fed28.twisted@itamarst.org>

On Thu, 10 Oct 2002 16:17:42 +1000
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

>     class Foo:
>         # etc
>     
>     components.registerAdapter(..., Foo, jelly.IJellyable)

TwistedJava already does this, and booleans. For once I'm ahead :)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From hbl at st-andrews.ac.uk  Thu Oct 10 09:11:07 2002
From: hbl at st-andrews.ac.uk (Hamish Lawson)
Date: Thu, 10 Oct 2002 16:11:07 +0100
Subject: [Twisted-Python] Quixote/Twisted Integration
Message-ID: <5.1.1.6.0.20021010160932.00aa8398@spey.st-andrews.ac.uk>

Moshe Zadka wrote:

>I've added a feature to the Twisted web server where it can use Quixote's
>PTL.

While on matters Quixotic, what is the current state of play regarding 
using Quixote's object publishing with Twisted? Some issues were touched 
upon in the following posts. Does anyone know if there is there now a 
working driver to let Twisted call Quixote?

     http://mail.mems-exchange.org/pipermail/quixote-users/2002-June/000606.html

     http://twistedmatrix.com/pipermail/twisted-python/2002-June/001216.html


Hamish Lawson





From jbauer at rubic.com  Thu Oct 10 14:59:12 2002
From: jbauer at rubic.com (Jeff Bauer)
Date: Thu, 10 Oct 2002 15:59:12 -0500
Subject: [Twisted-Python] New web project
Message-ID: <3DA5EA20.10192495@rubic.com>

My first post to the TwistedMatrix list. ;-)

By way of introduction, I worked on Persistent CGI
for Bobo, Digital Creations' precursor to Zope.
I'm still using a modified version of Bobo/PCGI
under Apache for current applications and would like
to consider switching to Twisted.

Let me first say that I'm very impressed with the
Twisted framework.  Although I've not written any
servers yet, I was able to get a secure SSL web
service running soon after I downloaded the code.
(Someone please remind me to write a quick How-To.)

What follows is a description of how I'd like to use
Twisted.  A Use Case, as it were.  I'm specifically
solicting responses of the kind:

R1: "That's already a standard idiom in Twisted."

R2: "You can already do that in Twisted, but it
     may not be obvious.  Here's how: ..."

R3: "You *could* do that, but here's a better
    approach ..."

R4: "Twisted doesn't presently support that
    function, but here's what would be required
    to provide it ..."

---

Actors:  User, User-session, Facility

1. Each Facility would be handled by a single
   long running process (LRP).  Currently we
   handle each User-session in an LRP, which
   actually simplifies session management
   somewhat, but makes other things at the
   application level more complicated.

2. Users would access their facility via URLs
   of this kind:

   http[s]://facility1.site.com
   http[s]://facility2.site.com

   Twisted would dispatch this traffic to the
   appropriate Facility LRP, which is effectively
   a Twisted web server.  Each server (Facility) is 
   running on a different port.

3. Users would be authenticated in a manner
   similar to Apache's htpasswd mechanism,
   and a User-session is created.  Currently, 
   since all session work occurs under SSL, I have
   access to the REMOTE-USER environment variable.

4. I presently drop a Cookie in the User's browser
   representing the ID of the User-Session.  From
   reading Itamar's posting (Dec 17 2001), I gather
   that I should consider sessions rather than
   cookies.

Thanks in advance for any replies.

Jeff Bauer
Rubicon Research



From dp at twistedmatrix.com  Thu Oct 10 15:39:24 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Thu, 10 Oct 2002 14:39:24 -0700
Subject: [Twisted-Python] New web project
In-Reply-To: <3DA5EA20.10192495@rubic.com>
Message-ID: <BED6A678-DC98-11D6-B8B3-000393B3EC2C@twistedmatrix.com>

On Thursday, October 10, 2002, at 01:59 PM, Jeff Bauer wrote:

>
> Actors:  User, User-session, Facility
>
> 1. Each Facility would be handled by a single
>    long running process (LRP).  Currently we
>    handle each User-session in an LRP, which
>    actually simplifies session management
>    somewhat, but makes other things at the
>    application level more complicated.

One way to handle this would be to have Apache do a ProxyPass in a 
VirtualHost directive to Twisted instances running on different ports. 
I do this where I work, and it works very well.

A better way to do it is with twisted.web.vhost.NameVirtualHost. I have 
not used this, but it occurs to me I should, because looking at the 
code it really is very simple. However, since you also have the 
requirement that each Facility be it's own LRP, you may also need to 
learn about twisted.web.distrib if you go this route. I will defer to 
someone who knows more about vhost and distrib on this one.

<snip -- someone who knows more about distrib and authentication please 
reply>

>
> 4. I presently drop a Cookie in the User's browser
>    representing the ID of the User-Session.  From
>    reading Itamar's posting (Dec 17 2001), I gather
>    that I should consider sessions rather than
>    cookies.

Sessions are implemented behind the scenes as a cookie. Since it is 
very simple to request a session from the request object 
(request.getSession()), and it handles the cookies for you, I recommend 
doing that.

Hope this helps a little!

Donovan




From glyph at twistedmatrix.com  Thu Oct 10 16:11:49 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 10 Oct 2002 17:11:49 -0500 (CDT)
Subject: [Twisted-Python] Jelly and Components
In-Reply-To: <20021010061742.GA16641@ritsuko.xware.cx>
References: <20021010061742.GA16641@ritsuko.xware.cx>
Message-ID: <20021010.171149.41195716.glyph@twistedmatrix.com>

On Thu, 10 Oct 2002 16:17:42 +1000, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> Shouldn't we be doing:
>     class Foo:
>         __implements__ = jelly.IJellyable
>         # etc

Yes.  I was originally going to save this for next week's "five crazy things"
email :), but that's the plan.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021010/16fa0814/attachment.sig>

From robert at vaccaperna.co.uk  Thu Oct 10 16:58:27 2002
From: robert at vaccaperna.co.uk (Robert Cowham)
Date: Thu, 10 Oct 2002 23:58:27 +0100
Subject: [Twisted-Python] RE: WebDAV Server
In-Reply-To: <20021010.171149.41195716.glyph@twistedmatrix.com>
Message-ID: <PJEEINAIADEEJBLOMLGIGEBHCMAA.robert@vaccaperna.co.uk>

A quick search of the archives turns up this topic occasionally, but without
any resolution....

Anyone working on support for this??

Robert




From dstone at kde.org  Thu Oct 10 19:01:00 2002
From: dstone at kde.org (Daniel Stone)
Date: Fri, 11 Oct 2002 11:01:00 +1000
Subject: [Twisted-Python] RE: WebDAV Server
In-Reply-To: <PJEEINAIADEEJBLOMLGIGEBHCMAA.robert@vaccaperna.co.uk>
References: <20021010.171149.41195716.glyph@twistedmatrix.com> <PJEEINAIADEEJBLOMLGIGEBHCMAA.robert@vaccaperna.co.uk>
Message-ID: <20021011010100.GB5303@trinity.unimelb.edu.au>

On Thu, Oct 10, 2002 at 11:58:27PM +0100, Brother Robert Cowham preached da werd, yo:
> A quick search of the archives turns up this topic occasionally, but without
> any resolution....
> 
> Anyone working on support for this??

Yes. :)

I'm working on MoulDAVia, which will be a flexible, extensible and cool
WebDAV server, with a Twisted frontend.

-- 
Daniel Stone 	     <daniel at raging.dropbear.id.au>             <dstone at kde.org>
Developer - http://kopete.kde.org, http://www.kde.org
Proof BitMover are community-focussed:
http://marc.theaimsgroup.com/?l=linux-kernel&m=103384262016750&w=2



From jml at mumak.net  Thu Oct 10 22:49:05 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Fri, 11 Oct 2002 15:49:05 +1100
Subject: [Twisted-Python] Re: [Twisted-commits] added docs
In-Reply-To: <87it0bw2sm.fsf@luther.lothar.com>
References: <E17yqPJ-00089A-00@pyramid.twistedmatrix.com> <20021008233455.GA472@toshi> <20021008234452.GG24749@modey.miralink.com> <87it0bw2sm.fsf@luther.lothar.com>
Message-ID: <20021011044905.GB27254@mumak.net>

On Wed, Oct 09, 2002 at 05:33:29PM -0700, Brian Warner wrote:
> I'm trying to imagine a more "from the ground up" route to learning 
> Twisted, and intend to write more docs along that path. 
> 
> If you see something in twisted that you want to use but haven't figured out
> how, let me know so I can add it to the list of stuff to look at.
> 

I've got a few suggestions, but they are more brain-storming ideas than
well thought out requests...

I really wouldn't mind seeing some docs about twisted.python.
I think that something describing the common patterns in twisted would
help a lot with someone who was learning from the ground up.

It would also make some of the existing example code (and maybe Woven?)
clearer. (e.g. The plugins doc has code that uses __implements__)

Also, do there need to be any end-developer docs for coil?

While I'm making wishes, a guided tour of a single, mildly complex
twisted application would be really nice. 


cheers,
jml


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021011/34312516/attachment.sig>

From sean at twistedmatrix.com  Sat Oct 12 19:30:27 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Sat, 12 Oct 2002 20:30:27 -0500
Subject: [Twisted-Python] traceback?
Message-ID: <HOEEKPCOKELHCNIJNMAGGEEHCHAA.sean@twistedmatrix.com>

hm.... this doesn't look good.. what does this mean?

Unhandled error in Deferred:
Traceback (most recent call last):
Eek!  <twisted.python.failure.Failure twisted.spread.pb.PBConnectionLost>
has no frames in traceback!
  File ".\twisted\internet\default.py", line 234, in mainLoop

  File ".\twisted\internet\default.py", line 521, in doSelect

  File "c:\ninja\Projects\Twisted\twisted\internet\tcp.py", line 142, in
connectionLost
    protocol.connectionLost(reason)
  File "c:\ninja\Projects\Twisted\twisted\spread\pb.py", line 543, in
connectionLost
    d.errback(failure.Failure(PBConnectionLost()))
--- <exception caught here> ---
twisted.spread.pb.PBConnectionLost:


----------------
"If he's so smart, then how come he's dead?", Homer Simspon
Sean Riley
sean at ninjaneering.com




From twisted at itamarst.org  Sat Oct 12 20:17:21 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 12 Oct 2002 22:17:21 -0400
Subject: [Twisted-Python] twisted.persisted.journal: a prevayler-inspired persistence system
Message-ID: <20021012221721.15133eeb.twisted@itamarst.org>

I've just checked in Journal, a persistence system inspired by Prevayler (http://www.prevayler.org for details). The idea is basically that all interactions with the system are done via serializable commands objects, which are logged *before* they execute. This allows us to keep down number of transactions in the system since in the worst case, the system can be restored by running the logged commands.

Additional benefits include being able to rerun sessions for testing performances, changing the internal data model is easy (just delete snapshot of system state and rerun all commands against new codebase), and so on.

This is an alternative to the immutable database model of keeping old versions of data - instead, we keep a log of all state changing commands (or even queries - useful for cases when you need to keep track of every read to the system).

The main difference from prevayler is flexibility - while I do support the "everything in memory" model, I also have code for using RDBMS for storage as well, using twisted.enterprise.row. In the future journal will support logging commands to a RDBMS as well, allowing you to easily gather statistics about everything that has ever been done to your system. The RDBMS code is untested.

Plugging the code into any persistence mechanism for snapshotting purposes should be possible, e.g. you could use ZODB as well. However some will be more suited than others - t.e.row is pretty good since it doesn't require a transaction for each command executed.

Example of using the system (with memory snapshotting and pickle based log):
http://www.twistedmatrix.com/users/jh.twistd/viewcvs/cgi/viewcvs.cgi/twisted/test/test_journal.py?rev=1.1&content-type=text/vnd.viewcvs-markup&cvsroot=Twisted

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andrew-twisted at puzzling.org  Sat Oct 12 22:08:37 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 13 Oct 2002 14:08:37 +1000
Subject: [Twisted-Python] OS X and setup.py
Message-ID: <20021013040837.GA857@frobozz.local>

This part of setup.py is breaking build_ext on OS X (which doesn't have
poll):

if os.name == "posix":
    setup_args['ext_modules'].append(
        Extension("twisted.internet.cReactor",
              glob('twisted/internet/cReactor/*.c'),
              define_macros=define_macros))
    
That's from the bottom of setup.py.  It completely ignores the
_detect_modules thing.  It reports "The C reactor is unavailable on this
system" -- then tries to build it anyway.  Disabling that code fragment
fixes the problem.

A comment suggests that code is needed to make sdist work... would someone
like to figure out how to make this work correctly?

-Andrew.




From andrew-twisted at puzzling.org  Sat Oct 12 22:10:48 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 13 Oct 2002 14:10:48 +1000
Subject: [Twisted-Python] OS X and setup.py
In-Reply-To: <20021013040837.GA857@frobozz.local>
References: <20021013040837.GA857@frobozz.local>
Message-ID: <20021013041048.GB857@frobozz.local>

On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
> This part of setup.py is breaking build_ext on OS X (which doesn't have
> poll):

My OS X informant also says:
<Screwtape> Better test it on another OS X system, too.
<Screwtape> This one might be a little damaged.
<Screwtape> (i.e. it has a manpage for poll(), but no header file)

-Andrew.




From glyph at twistedmatrix.com  Sun Oct 13 00:26:52 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 13 Oct 2002 01:26:52 -0500 (CDT)
Subject: [Twisted-Python] twisted.persisted.journal: a
 prevayler-inspired persistence system
In-Reply-To: <20021012221721.15133eeb.twisted@itamarst.org>
References: <20021012221721.15133eeb.twisted@itamarst.org>
Message-ID: <20021013.012652.78706997.glyph@twistedmatrix.com>


On Sat, 12 Oct 2002 22:17:21 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> I've just checked in Journal, a persistence system inspired by Prevayler
> (http://www.prevayler.org for details). The idea is basically that all
> interactions with the system are done via serializable commands objects,
> which are logged *before* they execute. This allows us to keep down number of
> transactions in the system since in the worst case, the system can be
> restored by running the logged commands.

Seems like it would be pretty easy to create persistently-loggable objects for
non-deterministic events (like the "time", and "random" modules) in Python.  In
order to do that you'd need to modify your implementation to provide a default
"Command" base class so that non-deterministic events could be logged
automatically as sub-events.  Any reason that you wouldn't want to do that?
(If you don't want to pollute client code with inheritance, the default
implementation could just have a reference to a delegate ICommmand
implementor.)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021013/e3c1ee49/attachment.sig>

From twisted at itamarst.org  Sun Oct 13 00:44:05 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 13 Oct 2002 02:44:05 -0400
Subject: [Twisted-Python] twisted.persisted.journal: a prevayler-inspired persistence system
In-Reply-To: <20021013.012652.78706997.glyph@twistedmatrix.com>
References: <20021012221721.15133eeb.twisted@itamarst.org>
	<20021013.012652.78706997.glyph@twistedmatrix.com>
Message-ID: <20021013024405.5be04806.twisted@itamarst.org>

On Sun, 13 Oct 2002 01:26:52 -0500 (CDT)
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> Seems like it would be pretty easy to create persistently-loggable
> objects for non-deterministic events (like the "time", and "random"
> modules) in Python.  In order to do that you'd need to modify your
> implementation to provide a default"Command" base class so that
> non-deterministic events could be logged automatically as sub-events. 
> Any reason that you wouldn't want to do that?(If you don't want to
> pollute client code with inheritance, the default implementation could
> just have a reference to a delegate ICommmand implementor.)

Prevayler has something like that where you have Clock passed to
commands, IIRC. I probably should add some code so commands can get a
"fake" time, i.e. the time they were supposed to have been run. Not sure
that randomness is worth doing - if you are using it presumably any
outcome is equally valid, or alternatively if that's not that case you
can't really use journal anyway.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andy at reportlab.com  Sun Oct 13 02:02:13 2002
From: andy at reportlab.com (Andy Robinson)
Date: Sun, 13 Oct 2002 09:02:13 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021012221721.15133eeb.twisted@itamarst.org>
Message-ID: <LKENLBBMDHMKBECHIAIAGEHFCMAA.andy@reportlab.com>

Hi everyone,

Some tiny pointers on "first impressions" about the docs..
This is in no way intended as criticism - it would just be
nice to iron out any glitches in 'getting started' 
instructions before you get to Version 1.0. IMHO it's really 
important that the first 15 minutes after downloading something 
for the first time go really well; a lot of people won't look 
at the source if the examples don't run. 

First: I tried the windows installer, could not get twistd 
or coil working, tried the source version and figured it out. 
You have an 'admin' directory in the source distro, but these 
are not in the Windows distro.  Equivalents are in the 'scripts' 
directory. Once I added 

  if __name__=='__main__':
      run()

to the end of coil.py and twistd.py, the rest of the instructions
were fine.  I suggest adding the script handlers and
mentioning this in installing-twisted.html and
using-twistedweb.html.

Second: why not include the 'doc' directory or examples in
the Windows EXE?  I know you want to keep it small but at
least the basic HOWTO.  If not, have a 'doc' directory with 
a readme pointing at a separate download containing docco
and examples.

Third:  I think there needs to be a prominent paragraph
in the 'End-Users' and 'download' pages telling Windows
users what to do or what not to do differently.  I also suspect
there's a bunch of other Windows-specific things which might
make a page of information somewhere.  

 I have two staff whose minds are not yet twisted and 
who are as ignorant as me about networking; I can volunteer them
as "usability testers" if this helps.  


My dumb questions about Twisted itself will follow separately :-)

Andy Robinson
ReportLab




From twisted at moshez.org  Fri Oct 11 21:36:10 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 03:36:10 -0000
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAGEHFCMAA.andy@reportlab.com>
References: <LKENLBBMDHMKBECHIAIAGEHFCMAA.andy@reportlab.com>
Message-ID: <20021012033610.28948.qmail@green.zadka.com>

First let me begin by saying that the windows installer probably works pretty
badly because almost nobody uses it, so your comments are probably very valuable
to whomever does the windows installer (glyph?). Thus all my advice from
here onwards will pertain to the source distribution.

On Sun, 13 Oct 2002, "Andy Robinson" <andy at reportlab.com> wrote:

> First: I tried the windows installer, could not get twistd 
> or coil working, tried the source version and figured it out. 
> You have an 'admin' directory in the source distro

The admin/ directory contains stuff for the Twisted developers, not
for twisted users.
 
> , but these 
> are not in the Windows distro.  Equivalents are in the 'scripts' 
> directory. Once I added 
> 
>   if __name__=='__main__':
>       run()

This is bad :)
Check out the stuff in the bin/ directory.
In general, assume you you don't need to change stuff to get Twisted
to work :)

Until Twisted fixes its windows installer, please try (and recommend
to your co-workers to try) the source distribtion (yes, I realize that
installing-twisted.html says otherwise)



From andy at reportlab.com  Sun Oct 13 04:08:04 2002
From: andy at reportlab.com (Andy Robinson)
Date: Sun, 13 Oct 2002 11:08:04 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021012033610.28948.qmail@green.zadka.com>
Message-ID: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>

> > are not in the Windows distro.  Equivalents are in the 'scripts' 
> > directory. Once I added 
> > 
> >   if __name__=='__main__':
> >       run()
> 
> This is bad :)
> Check out the stuff in the bin/ directory.

I would have done if it was included in the Windows distro :-)
If you include it as is, it still will not work on Windows. If you
make them end in .py, then someone who ran the default Windows
Python installation would just be able to execute them, but
without an extension they will need to type 'python' in front.

I don't know enough about distutils to know if this can be
fixed post-install, but I expect to be learning over the next
2 months; we haven't even made a distutils setup.py for our
package yet.  And we will have exactly the same issues.

BTW I fully support separating the "kick off" script from
the functionality.  We're working a lot on things like McMillan
installers, so an app or distro can be shipped as one .pyz
file which works on all platforms.  Sysadmins in big companies
like one-file apps a lot!  This means putting scripts/docs/examples 
outside the code archive, exactly as you have done.  


> In general, assume you you don't need to change stuff to get Twisted
> to work :)

A noble goal for any product :-)
In general it works extremely well and the docco is excellent.


> Until Twisted fixes its windows installer, please try (and recommend
> to your co-workers to try) the source distribtion (yes, I realize that
> installing-twisted.html says otherwise)

Actually I will try to keep them slaving away on other stuff;
testers for installation routines are only useful once, or
maybe twice if they have really short memories :-)



Thanks,

Andy






From twisted at moshez.org  Fri Oct 11 23:12:20 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 05:12:20 -0000
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
References: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
Message-ID: <20021012051220.30157.qmail@green.zadka.com>

On Sun, 13 Oct 2002, "Andy Robinson" <andy at reportlab.com> wrote:

> I would have done if it was included in the Windows distro :-)

I refer you again to my opening comments: we need exactly this kind of
feedback. I've given you workarounds :)

> If you include it as is, it still will not work on Windows. If you
> make them end in .py, then someone who ran the default Windows
> Python installation would just be able to execute them, but
> without an extension they will need to type 'python' in front.

Yes, I know.
I'm sure someone will work on fixing it (I can't, as I have no access
to windows boxes).

> Actually I will try to keep them slaving away on other stuff;
> testers for installation routines are only useful once, or
> maybe twice if they have really short memories :-)

I misread you to think they were going to be testers for our Twisted
documentation stuff, my bad. Which brings me to my next point: any comments
about the documentation (especially hidden assumptions we make and/or documents
which you wanted and didn't find) would be greatly appreciated.



From twisted at moshez.org  Fri Oct 11 23:13:31 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 05:13:31 -0000
Subject: [Twisted-Python] Documentation
Message-ID: <20021012051331.30177.qmail@green.zadka.com>

Looking through http://twistedmatrix.com/documents/howto/book I've noticed
two things:
1. It contains references to chapters which seem redundant (Deferred examples?
   basic examples should be in the deferred howto and more complicated examples
   will be sprinkled through almost every other howto)
2. It does not link to current things which we do have (the single most used
   t.python feature is usage, which is howtoed, except for maybe log. However
   it is somewhat embarassing to spend a whole document to say 
   "use log.msg(*args), and it will be just like print except it goes to the
   logfile :)

So, basically, I think the sitution for documentation is, in fact, much
better than what .../book would lead us to believe. Would anyone volunteer
to rewrite "book" into something more realistic which is actually useful?
I'd volunteer myself, if the book maintainer gave me permission :)



From twisted at moshez.org  Fri Oct 11 23:58:41 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 05:58:41 -0000
Subject: [Twisted-Python] More About Documentation
Message-ID: <20021012055841.30686.qmail@green.zadka.com>

I have a new version of the book in http://twistedmatrix.com/users/moshez/book.xhtml.
Please let me know of any problems, I'm thinking of checking it in soon. 




From screwtape at froup.com  Sun Oct 13 08:42:33 2002
From: screwtape at froup.com (Tim Allen)
Date: Mon, 14 Oct 2002 00:42:33 +1000
Subject: [Twisted-Python] Patch for extra IRC events.
Message-ID: <0288BCD1-DEBA-11D6-88F9-003065D61A3E@froup.com>

Here's a patch that makes the IRC protocol notice a few more events, and 
also keeps a record of the MOTD in case we want to refer to it later.

All the advertised features seem to work on Slashnet.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: twisted-irc.diff
Type: application/octet-stream
Size: 5799 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021014/037c78f6/attachment-0002.obj>

From tv at twistedmatrix.com  Sun Oct 13 11:29:40 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Sun, 13 Oct 2002 20:29:40 +0300
Subject: [Twisted-Python] Five Crazy Ideas to Start Your Week
In-Reply-To: <20021009.134414.07435605.glyph@twistedmatrix.com>
References: <20021008.020424.07435626.glyph@twistedmatrix.com> <20021008170814.GB5790@ki.yok.utu.fi> <20021009.134414.07435605.glyph@twistedmatrix.com>
Message-ID: <20021013172940.GA21867@ki.yok.utu.fi>

On Wed, Oct 09, 2002 at 01:44:14PM -0500, Glyph Lefkowitz wrote:
> > > These URLs need to be able to represent transport mechanism (TCP? UNIX socket?
> > > SSL? Weird firewall-tunneling stuff?)
> 
> > 	"Talk to subprocess that runs this command to connect to the other end"
> > 	("ssh remotehost pbserver", "ssh remotehost
> > 	connect-stdinout-to-unix-socket /path/socket")
> 
> > 	And yes, I may want that even after Twisted has a fully working
> > 	SSH implementation. For rex :)
> 
> I don't quite get what you're talking about here.  You want the URLs to be
> shell command-lines? :)

	Let's try with an example. My IMAP mail fetcher talks to my
	IMAP server by SSHing in and running a certain command.
	Now, s/IMAP/PB/, and I still want that to be easy. The only
	choices I see are splitting out the "connection establishment"
	from the software that talks PB
	(e.g. http://cr.yp.to/proto/ucspi.txt), or allow me to say
	"open connection there by running this command and talking to
	it".

> > >     pb://pyramid/identity:password at service#perspective
> > 	Eww. Passwords in URLs is baaad. Because users like to enter URLs on
> > 	command line.
> 
> > 	I'd much rather see an explicit "--password-file filename" and
> > 	"--password-fd n".
> 
> Yes, and smart users will use that, for the most part.  Still, you need a way
> to represent simple authentication as part of a URL.  Sometimes the URLs
> themselves will be secret and the authentication information will be a swiss
> number or something.  E does everything through exchange of URLs, and it's
> pretty secure.

	So, you need to specify "ask me this password with this mechanism",
	e.g. get the first password from fd 5 and second from fd 6. How
	does that fit in the URL, or does it?

> > > Public-key authentication mechanism, using the same identity name.  Connection
> > > over SSH transport (sshkey auth only available this way).
> > > 
> > >     pb-ssl://pyramid/cert$identity at service#perspective
> > > 
> > > PB over SSL, using certificate auth.
> > > 
> > >     pb://pyramid/this/that/the-other/my-service#perspective
> 
> > 	Hmm. Idea. Allow one to specify when the server is trusted.  "Connect
> > 	to server X if its public key has fingerprint F."  http://www.fs.net/
> 
> Any proposals for how to implement that?

	Similar to what SSH already does; stores the fingerprint in a file.
	Use the one given in the URL just like it would have been read from
	known_hosts. Same can apply for SSL, etc.

-- 
:(){ :|:&};:



From itamar at itamarst.org  Sun Oct 13 00:05:37 2002
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 13 Oct 2002 02:05:37 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] Added utility-method getProccessOutput to IReactorProcess, and implemented in default.PosixReactorBase.
In-Reply-To: <E180R2b-0000nA-00@pyramid.twistedmatrix.com>
References: <E180R2b-0000nA-00@pyramid.twistedmatrix.com>
Message-ID: <20021013020537.00c93241.itamar@itamarst.org>

On Sat, 12 Oct 2002 13:31:09 -0500
radix CVS <radix at twistedmatrix.com> wrote:


> Should this not be in the interface, and instead be in a utility
> module? I vote for interface by way of commit :-)

No, this should not be in the interface. Move it somewhere else.



From glyph at twistedmatrix.com  Sun Oct 13 14:49:55 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 13 Oct 2002 15:49:55 -0500 (CDT)
Subject: [Twisted-Python] More About Documentation
In-Reply-To: <20021012055841.30686.qmail@green.zadka.com>
References: <20021012055841.30686.qmail@green.zadka.com>
Message-ID: <20021013.154955.126758322.glyph@twistedmatrix.com>


On 12 Oct 2002 05:58:41 -0000, Moshe Zadka <twisted at moshez.org> wrote:
> I have a new version of the book in http://twistedmatrix.com/users/moshez/book.xhtml.
> Please let me know of any problems, I'm thinking of checking it in soon. 

Looks good to me: as I'm the book.html "maintainer" I guess that's as good as
you'll get :).  There are a few minor tweaks I may make once you check it in.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021013/e801a854/attachment.sig>

From glyph at twistedmatrix.com  Sun Oct 13 15:11:04 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 13 Oct 2002 16:11:04 -0500 (CDT)
Subject: [Twisted-Python] twisted.persisted.journal: a
 prevayler-inspired persistence system
In-Reply-To: <20021013024405.5be04806.twisted@itamarst.org>
References: <20021012221721.15133eeb.twisted@itamarst.org>
	<20021013.012652.78706997.glyph@twistedmatrix.com>
	<20021013024405.5be04806.twisted@itamarst.org>
Message-ID: <20021013.161104.89043483.glyph@twistedmatrix.com>


On Sun, 13 Oct 2002 02:44:05 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> Prevayler has something like that where you have Clock passed to commands,
> IIRC. I probably should add some code so commands can get a "fake" time,
> i.e. the time they were supposed to have been run. Not sure that randomness
> is worth doing - if you are using it presumably any outcome is equally valid,
> or alternatively if that's not that case you can't really use journal anyway.

Not in the case of a game: certain events have "random" outcomes, weighted
randomness based on a die roll plus some skill modifiers and so forth.  You can
still use object prevalence to persist this information, but you need the die
rolls associated with a certain action to be the same the second time through.
(IIRC in the Prevayler model, you're supposed to use a deterministic hash
ordering method so that you don't accidentally have any code that depends on
the order of a dictionary's keys, either...)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021013/b3b7238c/attachment.sig>

From glyph at twistedmatrix.com  Sun Oct 13 15:23:12 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 13 Oct 2002 16:23:12 -0500 (CDT)
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
References: <20021012033610.28948.qmail@green.zadka.com>
	<LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
Message-ID: <20021013.162312.111208639.glyph@twistedmatrix.com>


On Sun, 13 Oct 2002 11:08:04 +0100, "Andy Robinson" <andy at reportlab.com> wrote:
> > Check out the stuff in the bin/ directory.

> I would have done if it was included in the Windows distro :-) If you include
> it as is, it still will not work on Windows. If you make them end in .py,
> then someone who ran the default Windows Python installation would just be
> able to execute them, but without an extension they will need to type
> 'python' in front.

I don't understand Microsoft's "DOS Shell" scripting language too well, but I
think "execute" means something misleading in this context,
i.e. "double-click".  Since most of the Twisted main scripts don't have a GUI,
when you "run" them in the explorer, a black DOS box comes up and disappears.

Is there some way to make it so that these commands are accessible via the
user's %PATH% at a DOS prompt, regardless of distutils?  The only technique
I've found involves Cygwin and that was pretty nasty.

> I don't know enough about distutils to know if this can be fixed
> post-install, but I expect to be learning over the next 2 months; we haven't
> even made a distutils setup.py for our package yet.  And we will have exactly
> the same issues.

The real problem is that these tools don't have a GUI and that doesn't mesh
very well with the Windows way of being.  A simple GUI for running/making
TA[SPX] files with Tkinter has been on the "that would be nice" TODO list for
some time, but so few Twisted developers use Windows on a regular basis that it
never seems to get done...

FWIW I don't think it's possible to do run any post-installation code on win32
with distutils.  I haven't looked in depth for a while, but I haven't heard
news of this being fixed, either.

> BTW I fully support separating the "kick off" script from the functionality.
> We're working a lot on things like McMillan installers, so an app or distro
> can be shipped as one .pyz file which works on all platforms.  Sysadmins in
> big companies like one-file apps a lot!  This means putting
> scripts/docs/examples outside the code archive, exactly as you have done.

Yes.  I'm glad you see the utility in doing this.  I also strongly agree with
you that the Twisted experience needs to be positive within the first fifteen
minutes of the download, and it bothers me that the Windows installer is not in
very good shape.  (Have you tried the debian install though?  It's smooooth
^_^)

> > Until Twisted fixes its windows installer, please try (and recommend to
> > your co-workers to try) the source distribtion (yes, I realize that
> > installing-twisted.html says otherwise)

> Actually I will try to keep them slaving away on other stuff; testers for
> installation routines are only useful once, or maybe twice if they have
> really short memories :-)

Well, if your testers are sysadmins they tend to be irritated by the
installation problems a lot more often.  Trouble is that sysadmins rarely
install server frameworks on their own...

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021013/d9884ca3/attachment.sig>

From andy at reportlab.com  Sun Oct 13 16:57:40 2002
From: andy at reportlab.com (Andy Robinson)
Date: Sun, 13 Oct 2002 23:57:40 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021013.162312.111208639.glyph@twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAGEHNCMAA.andy@reportlab.com>

I'll try to help with any windows issues I can...ReportLab
are starting to face exactly the same things with packaging
up our commercial products, except we have not really braved
distutils yet. I can see from your setup script that you
have :-)  Nobody on the SIG ever answered any of my questions
so I guess I can learn from you here too...

> I don't understand Microsoft's "DOS Shell" scripting language too
> well, but I
> think "execute" means something misleading in this context,
> i.e. "double-click".  Since most of the Twisted main scripts
> don't have a GUI,
> when you "run" them in the explorer, a black DOS box comes up and
> disappears.

Windows uses file extensions rather than marking scripts
executable, and things like "#!/usr/bin/env python" mean
nothing to it.

You can either type the command line in a DOS box, or double-click
it. If you double-click and a traceback occurs, you won't get to
read it.  It's pretty much understood that for things like web servers,
scripting languages and databases one has to use the DOS prompt
and there will be a bunch of commands to administer the server,
just like on Unix.  The DOS shell in Windows 2000 is very pleasant,
readline-ish, with auto-completion and a host of commands, and any Python
programmer will certainly be used to it.

> Is there some way to make it so that these commands are accessible via the
> user's %PATH% at a DOS prompt, regardless of distutils?  The only
> technique I've found involves Cygwin and that was pretty nasty.

Python is not on the path by default (but see 2 below). As I see it
you've got 3-4 choices on such scripts.
1. If the file has no extension, like your current scripts, you can
still execute it by doing
    python myscript
(assuming Python is on the path).  But it's not intuitive what to
do with a file that lacks an extension.

2. If the file ends in .py, then Windows knows it's a python script
as the .py extension was 'associated' with python.exe when Python
was installed.  You can then run by using its name:

C:\Python22\Lib\site-packages\twisted\scripts>mktap.py web --path
c:\\code\\www_reportlab_com
Saving web application to web.tap...
Saved.

Just like Unix - well, nearly.

3. If a file ends in .bat you can execute it and it's assumed to
have Windows' fairly poor batch language.  There is a horrible
hack to hide Python scripts in batch files, but it's REALLY
horrible.  You could also make a batch file call a Python script,
but it's unusual and pointless since you need the Python script
anyway.

4. If you're devilishly cunning you can make 'stub EXEs', using
a partial binary, and they can be assembled on Unix.  Our commercial
download has a 'bin' directory containing a tiny 'rml2pdf.exe' which
just imports and runs the content of rlextra/rml2pdf/rml2pdf.py(c).

The real problem, of course, is what distutils does now.  I don't
know if it has a post-install hook.  If it does, then you could
do
  if sys.platform == 'win32':
      for filename in os.listdir('bin'):
          os.rename(filename, filename + '.py')

If not, I wonder if you can do that when making the package?
This would instantly make sure that they were executable
and also obviously recognizable.

>
> FWIW I don't think it's possible to do run any post-installation
> code on win32
> with distutils.  I haven't looked in depth for a while, but I
> haven't heard
> news of this being fixed, either.
Doh, there goes that idea then.

> Yes.  I'm glad you see the utility in doing this.  I also
> strongly agree with
> you that the Twisted experience needs to be positive within the
> first fifteen
> minutes of the download, and it bothers me that the Windows
> installer is not in
> very good shape.  (Have you tried the debian install though?
> It's smooooth
> ^_^)

Unfortunately my various attempts to install Linux have all
failed horribly, usually with graphics drivers and after a lot more
than 15 minutes :-).  I still use Windows on my desktop.  We use
FreeBSD on our servers and Solaris at most customer sites, but only
'as servers'. My Linux knowledge is bound to be worse that yours of
Windows :-)

> Well, if your testers are sysadmins they tend to be irritated by the
> installation problems a lot more often.  Trouble is that sysadmins rarely
> install server frameworks on their own...

I have two "junior programmers" who will probably be ideal.
John knows Python, Dragan knows Java and a little Python, but they
(like me) are new to networking.  John is also our docco expert.
I suggest holding off until we "think it's sorted" and using
them for first impressions on the install process and examples.
You can only use each tester once for this kind of thing.

The other one, Robin becker, will no doubt ignore all docco, read the
source and maybe even any binaries, then discover something nasty
lurking in your innermost Windows event loops ;-)


Thanks,

Andy









From twisted at itamarst.org  Sun Oct 13 18:29:36 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 13 Oct 2002 20:29:36 -0400
Subject: [Twisted-Python] twisted.persisted.journal: a prevayler-inspired persistence system
In-Reply-To: <20021013.161104.89043483.glyph@twistedmatrix.com>
References: <20021012221721.15133eeb.twisted@itamarst.org>
	<20021013.012652.78706997.glyph@twistedmatrix.com>
	<20021013024405.5be04806.twisted@itamarst.org>
	<20021013.161104.89043483.glyph@twistedmatrix.com>
Message-ID: <20021013202936.75b83de6.twisted@itamarst.org>

On Sun, 13 Oct 2002 16:11:04 -0500 (CDT)
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> 
> On Sun, 13 Oct 2002 02:44:05 -0400, Itamar Shtull-Trauring
> <twisted at itamarst.org> wrote:
> 
> > Prevayler has something like that where you have Clock passed to
> > commands, IIRC. I probably should add some code so commands can get
> > a "fake" time, i.e. the time they were supposed to have been run.
> > Not sure that randomness is worth doing - if you are using it
> > presumably any outcome is equally valid, or alternatively if that's
> > not that case you can't really use journal anyway.
> 
> Not in the case of a game: certain events have "random" outcomes,
> weighted randomness based on a die roll plus some skill modifiers and
> so forth.  You can still use object prevalence to persist this
> information, but you need the die rolls associated with a certain
> action to be the same the second time through.

OK then:

class RollDice:
   def __init__(self):
       self.value = rollDice()

   def execute(self, service, startTime):
       service.foo(self.value)

In other words - do it in the command, not in the framework, because
frankly I have no way of knowing what random generator you use and so
on.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andy at reportlab.com  Sun Oct 13 18:29:51 2002
From: andy at reportlab.com (Andy Robinson)
Date: Mon, 14 Oct 2002 01:29:51 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021013.162312.111208639.glyph@twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>

> FWIW I don't think it's possible to do run any post-installation 
> code on win32 with distutils.  I haven't looked in depth for a while, 
> but I  haven't heard news of this being fixed, either.

Weird!  I didn't believe this so I subclasses and plugged in
a new install command which wrote some trace stuff to disk.
You're right; it executes at the time of bdist_wininst, not
when installing.  

I also downloaded and looked through py2exe, which he has 
continued to extend separately.  He says it can now install
Windows services, which is VERY relevant to you and us;
and this implies he at least knows how to do post-install
stuff.  BTW I think you're going to need a generic way to make 
any tap file into a service (which is really just a way
of starting it when the system starts).  So, I am
sure it's fixable, but will need upgrades/patches to
distutils.

I've emailed Thomas to ask where this stands and if we
can help..

- Andy











From andy at reportlab.com  Sun Oct 13 19:09:54 2002
From: andy at reportlab.com (Andy Robinson)
Date: Mon, 14 Oct 2002 02:09:54 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
Message-ID: <LKENLBBMDHMKBECHIAIAKEHPCMAA.andy@reportlab.com>

I really should be in bed, but I think I cracked it!

There is hope.  The bdist_wininst command in Python 2.2
does not include key changes added by Thomas Heller
added on Feb 20th (rev 1.29 in CVS).  I downloaded this one 
and overwrote my existing copy and found I could add an install 
script. What's more, print statements even show up in the final
GUI window, and you can make windows shortcuts.  

So, if you had a 'wininstall.py' script, you would do:

>python setup.py bdist_wininst --install-script wininstall.py

I needed to do some juggling to get around your auto-building
of scripts, but it builds distros with that script in
and runs them.  I made a right mess of setup.py tonight
but will try to redo this again 'cleanly' in a day or two.

HTH, 

Andy





From twisted at moshez.org  Mon Oct 14 06:08:07 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 14 Oct 2002 12:08:07 -0000
Subject: [Twisted-Python] Suggested Code Cleanup
Message-ID: <20021014120807.10794.qmail@green.zadka.com>

1. twisted/persisted/styles.py:42
2. twisted/internet/app.py:276
3. twisted/internet/app.py:341





From andrew-twisted at puzzling.org  Mon Oct 14 07:28:43 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 14 Oct 2002 23:28:43 +1000
Subject: [Twisted-Python] Test failure in with Python 2.2
Message-ID: <20021014132843.GA464@frobozz.local>

======================================================================
FAIL: testFileRebuild (twisted.test.test_rebuild.RebuildTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_rebuild.py", line 73, in testFileRebuild
    assert b.b() == 'c'
AssertionError
----------------------------------------------------------------------

I presume this is an issue with the special new-style class support...

-Andrew.




From twisted at itamarst.org  Mon Oct 14 08:20:50 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 14 Oct 2002 10:20:50 -0400
Subject: [Twisted-Python] Test failure in with Python 2.2
In-Reply-To: <20021014132843.GA464@frobozz.local>
References: <20021014132843.GA464@frobozz.local>
Message-ID: <20021014102050.72f7a047.twisted@itamarst.org>

On Mon, 14 Oct 2002 23:28:43 +1000
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

> ======================================================================
> FAIL: testFileRebuild (twisted.test.test_rebuild.RebuildTestCase)
> ----------------------------------------------------------------------

> I presume this is an issue with the special new-style class support...

This is a bug in Python 2.2.1 that is fixed in 2.2.2 (and Debian users
don't see it because 2.2.1 on Debian includes patches from 2.2.2).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andrew-twisted at puzzling.org  Mon Oct 14 08:30:42 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 15 Oct 2002 00:30:42 +1000
Subject: [Twisted-Python] Test failure in with Python 2.2
In-Reply-To: <20021014102050.72f7a047.twisted@itamarst.org>
References: <20021014132843.GA464@frobozz.local> <20021014102050.72f7a047.twisted@itamarst.org>
Message-ID: <20021014143041.GC464@frobozz.local>

On Mon, Oct 14, 2002 at 10:20:50AM -0400, Itamar Shtull-Trauring wrote:
> On Mon, 14 Oct 2002 23:28:43 +1000
> Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> 
> > ======================================================================
> > FAIL: testFileRebuild (twisted.test.test_rebuild.RebuildTestCase)
> > ----------------------------------------------------------------------
> 
> > I presume this is an issue with the special new-style class support...
> 
> This is a bug in Python 2.2.1 that is fixed in 2.2.2 (and Debian users
> don't see it because 2.2.1 on Debian includes patches from 2.2.2).

Hmm.  This is a debian unstable box, although I haven't upgraded python in a
while (damn 33.6k modem):

bash-2.05b$ dpkg -l python2.2 | grep ^ii
ii  python2.2      2.2.1-5        An interactive object-oriented scripting lan

A note should probably be made in the README/release notes that 2.2.2 is
required.

-Andrew.




From twisted at itamarst.org  Mon Oct 14 08:32:35 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 14 Oct 2002 10:32:35 -0400
Subject: [Twisted-Python] Test failure in with Python 2.2
In-Reply-To: <20021014143041.GC464@frobozz.local>
References: <20021014132843.GA464@frobozz.local>
	<20021014102050.72f7a047.twisted@itamarst.org>
	<20021014143041.GC464@frobozz.local>
Message-ID: <20021014103235.264f2100.twisted@itamarst.org>

On Tue, 15 Oct 2002 00:30:42 +1000
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

> bash-2.05b$ dpkg -l python2.2 | grep ^ii
> ii  python2.2      2.2.1-5        An interactive object-oriented
> scripting lan
> 
> A note should probably be made in the README/release notes that 2.2.2
> is required.

Well, I'm on 2.2.1-6 and I've never see the bug, and Jp saw it on
python.org 2.2.1 but not after upgrading to 2.2.2b1 (2.2.1-6 has 2 extra
months of bugfixes from Python CVS). We'll add a note after 2.2.2 is
released :)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From bruce at cubik.org  Mon Oct 14 09:16:10 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Mon, 14 Oct 2002 09:16:10 -0600
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
References: <E1816h5-0005Au-00@pyramid.twistedmatrix.com>
Message-ID: <3DAADFBA.1020803@cubik.org>

radix CVS wrote:
> 3) changed some addCallback/addErrback to addCallbacks

radix,

That change leads to problems if any errors happen within the callback 
since that won't cause renderFailure to be called.  Was there some 
particular reason that you did this since it is a change in semantics?

  - Bruce




From radix at twistedmatrix.com  Mon Oct 14 09:39:45 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 14 Oct 2002 17:39:45 +0200
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
In-Reply-To: <3DAADFBA.1020803@cubik.org>
References: <E1816h5-0005Au-00@pyramid.twistedmatrix.com> <3DAADFBA.1020803@cubik.org>
Message-ID: <20021014153945.GA13235@twistedmatrix.com>

On Mon, Oct 14, 2002 at 09:16:10AM -0600, Bruce Mitchener wrote:
> radix CVS wrote:
> >3) changed some addCallback/addErrback to addCallbacks
> 
> radix,
> 
> That change leads to problems if any errors happen within the callback 
> since that won't cause renderFailure to be called.  Was there some 
> particular reason that you did this since it is a change in semantics?

Sorry, I've brain-farted. I knew they were semantic changes, but
usually addCallbacks is recommended; I didn't realize that these
particular semantics were really needed in this case.




From bruce at cubik.org  Mon Oct 14 10:08:58 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Mon, 14 Oct 2002 10:08:58 -0600
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
References: <E1816h5-0005Au-00@pyramid.twistedmatrix.com> <3DAADFBA.1020803@cubik.org> <20021014153945.GA13235@twistedmatrix.com>
Message-ID: <3DAAEC1A.6020108@cubik.org>

Christopher Armstrong wrote:
> On Mon, Oct 14, 2002 at 09:16:10AM -0600, Bruce Mitchener wrote:
>>That change leads to problems if any errors happen within the callback 
>>since that won't cause renderFailure to be called.  Was there some 
>>particular reason that you did this since it is a change in semantics?
> 
> 
> Sorry, I've brain-farted. I knew they were semantic changes, but
> usually addCallbacks is recommended; I didn't realize that these
> particular semantics were really needed in this case.

No problem. Error handling in Woven is and has been a bit of a pain and 
a source of issues in the past where tracebacks were happening invisibly. :)

Thanks for reverting!

  - Bruce




From andrew-twisted at puzzling.org  Mon Oct 14 10:31:56 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 15 Oct 2002 02:31:56 +1000
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
In-Reply-To: <20021014153945.GA13235@twistedmatrix.com>
References: <E1816h5-0005Au-00@pyramid.twistedmatrix.com> <3DAADFBA.1020803@cubik.org> <20021014153945.GA13235@twistedmatrix.com>
Message-ID: <20021014163156.GE464@frobozz.local>

On Mon, Oct 14, 2002 at 05:39:45PM +0200, Christopher Armstrong wrote:
> > radix CVS wrote:
> > >3) changed some addCallback/addErrback to addCallbacks
> 
> Sorry, I've brain-farted. I knew they were semantic changes, but
> usually addCallbacks is recommended; I didn't realize that these
> particular semantics were really needed in this case.

This makes me wonder if most of the time you want to add a callback and an
errback, you want the errback to be able to catch the callbacks errors.

That is, maybe
    d.addCallbacks(cb, eb)
should be changed to be equivalent to 
    d.addCallback(cb).addErrback(eb)
and anyone requiring the current behaviour would have to do
    d.addErrback(eb).addCallback(cb)

Although now that I think of it, that last example isn't *quite* the same as
the current behaviour if eb returns a non-Failure...

I'm just thinking that the most commonly desired behaviour is to mirror
    try:
        cb()
    except:
        eb()

Hmm.  Perhaps a better solution is to add a kwarg to addCallbacks, so that
something like
    d.addCallbacks(cb, eb, errbackCatchesCallback=1)
would modify it to do what you want.  It'd be nice to think of a nicer name
for the kwarg though.

I guess it depends on what the most common use-case for adding callbacks &
errbacks is, and whether that is important enough to change the interface.
It's probably too late to do this with 1.0 so close :(

-Andrew.




From md9ms at mdstud.chalmers.se  Mon Oct 14 12:00:35 2002
From: md9ms at mdstud.chalmers.se (Martin =?ISO-8859-1?Q?Sj=F6gren?=)
Date: 14 Oct 2002 20:00:35 +0200
Subject: [Twisted-Python] Playing with twisted.web.woven
Message-ID: <1034618436.2291.5.camel@winterfell>

Well, I finally got some time to play with woven (or actually, I
should've been correcting assignments, but I'm sick and tired of it).

I must say: This is way cool! The more I fiddle with it, the more I'm
getting to say "good, now I can throw out *that* php hack too!"

I have a thing on my wishlist though. Heck, it might already be there
and I just don't know how to do it, but here's my scenario:

I have a view with a corresponding template. In that view, I want to
have a widget that in turn is created from a template, so I can reuse
that widget easily but still write it in html, since it's actually
mainly html. Can I do this already, and how? If not, would it be hard to
add it?

Thanks for the great package (and thanks to itamar, radix and bruce who
helped me get my example code to work!)


Cheers,
Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Detta r en digitalt signerad	meddelandedel
URL: </pipermail/twisted-python/attachments/20021014/f048865d/attachment.sig>

From m at moshez.org  Sat Oct 12 11:51:20 2002
From: m at moshez.org (Moshe Zadka)
Date: 12 Oct 2002 17:51:20 -0000
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
References: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
Message-ID: <20021012175120.6505.qmail@green.zadka.com>

On Mon, 14 Oct 2002, "Andy Robinson" <andy at reportlab.com> wrote:

> I also downloaded and looked through py2exe, which he has 
> continued to extend separately.  He says it can now install
> Windows services, which is VERY relevant to you and us;
> and this implies he at least knows how to do post-install
> stuff.  BTW I think you're going to need a generic way to make 
> any tap file into a service (which is really just a way
> of starting it when the system starts). 

We knew we want this in IPC10 already --
'''
   Examples for integration opportunities are automatic creation of
   installer for "tap" files (for Red Hat Packager-based distributions,
   FreeBSD's package management system or Microsoft Windows(tm)
   installers)
'''

We do have a tap2deb mechanism, which does exactly that for Debian.
The problem is that nobody on the Twisted team really had time to delve
into services. As I see it, it would require a new script (twistw, maybe) --
most of twistd is about doing UNIXish stuff, and using it on Windows
is really an evil hack.



From theller at python.net  Mon Oct 14 03:33:20 2002
From: theller at python.net (Thomas Heller)
Date: Mon, 14 Oct 2002 11:33:20 +0200
Subject: [Twisted-Python] Re: First impressions of Windows downlod
References: <20021013.162312.111208639.glyph@twistedmatrix.com> <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
Message-ID: <aoe2vj$v3b$1@main.gmane.org>

"Andy Robinson" <andy at reportlab.com> wrote in message news:LKENLBBMDHMKBECHIAIAIEHOCMAA.andy at reportlab.com...
> > FWIW I don't think it's possible to do run any post-installation
> > code on win32 with distutils.  I haven't looked in depth for a while,
> > but I  haven't heard news of this being fixed, either.
>
> Weird!  I didn't believe this so I subclasses and plugged in
> a new install command which wrote some trace stuff to disk.
> You're right; it executes at the time of bdist_wininst, not
> when installing.
>
> I also downloaded and looked through py2exe, which he has
> continued to extend separately.  He says it can now install
> Windows services, which is VERY relevant to you and us;
> and this implies he at least knows how to do post-install
> stuff.  BTW I think you're going to need a generic way to make
> any tap file into a service (which is really just a way
> of starting it when the system starts).  So, I am
> sure it's fixable, but will need upgrades/patches to
> distutils.
>
> I've emailed Thomas to ask where this stands and if we
> can help..

I didn't see this message (which is surely my own fault,
because I was struggling the last few days or so trying out
different email and news clients).

Indeed I could use some help here. The CVS version seems to
be functional, but I'm not sure if I like the implementation.
I can post a description of how it works here later.

Thomas







From mwh at python.net  Mon Oct 14 05:12:51 2002
From: mwh at python.net (Michael Hudson)
Date: 14 Oct 2002 12:12:51 +0100
Subject: [Twisted-Python] Re: OS X and setup.py
References: <20021013040837.GA857@frobozz.local> <20021013041048.GB857@frobozz.local>
Message-ID: <lku1jp46ks.fsf@pc150.maths.bris.ac.uk>

Andrew Bennetts <andrew-twisted at puzzling.org> writes:

> On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
> > This part of setup.py is breaking build_ext on OS X (which doesn't have
> > poll):
> 
> My OS X informant also says:
> <Screwtape> Better test it on another OS X system, too.
> <Screwtape> This one might be a little damaged.
> <Screwtape> (i.e. it has a manpage for poll(), but no header file)

I think fink installs some kind of poll() emulation library, which can
cause confusion.

Cheers,
M.
(who just needs a nice aquafied emacs to ditch fink completely...)





From md9ms at mdstud.chalmers.se  Sun Oct 13 16:19:44 2002
From: md9ms at mdstud.chalmers.se (Martin =?ISO-8859-1?Q?Sj=F6gren?=)
Date: 14 Oct 2002 00:19:44 +0200
Subject: [Twisted-Python] Playing with twisted.web.woven
Message-ID: <1034547585.28424.6.camel@winterfell>

Well, I finally got some time to play with woven (or actually, I
should've been correcting assignments, but I'm sick and tired of it).

I must say: This is way cool! The more I fiddle with it, the more I'm
getting to say "good, now I can throw out *that* php hack too!"

I have a thing on my wishlist though. Heck, it might already be there
and I just don't know how to do it, but here's my scenario:

I have a view with a corresponding template. In that view, I want to
have a widget that in turn is created from a template, so I can reuse
that widget easily but still write it in html, since it's actually
mainly html. Can I do this already, and how? If not, would it be hard to
add it?

Thanks for the great package (and thanks to itamar, radix and bruce who
helped me get my example code to work!)


Cheers,
Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Detta r en digitalt signerad	meddelandedel
URL: </pipermail/twisted-python/attachments/20021014/951fb027/attachment.sig>

From glyph at twistedmatrix.com  Mon Oct 14 13:39:10 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 14 Oct 2002 14:39:10 -0500 (CDT)
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven
 Changes::
In-Reply-To: <20021014163156.GE464@frobozz.local>
References: <3DAADFBA.1020803@cubik.org>
	<20021014153945.GA13235@twistedmatrix.com>
	<20021014163156.GE464@frobozz.local>
Message-ID: <20021014.143910.74754385.glyph@twistedmatrix.com>


On Tue, 15 Oct 2002 02:31:56 +1000, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> This makes me wonder if most of the time you want to add a callback and an
> errback, you want the errback to be able to catch the callbacks errors.

I originally experimented with it that way, and I like it better the way it is.
For example, in the case of a remote method call, you use addCallbacks if you
want to handle the remote call by saying "Here is the result: ..." or "Remote
traceback: ..."  It's really misleading to have the "remote traceback" message
happen in the case where the traceback is really local.  Worse yet is to have a
situation where it's acceptable to swallow any remote error, but a local error
is unexpected.  Since the default behavior should be to print out a traceback
in the log, naive use of addCallbacks will do the right thing.

Of course, there are situations that go both ways, but I've encountered the
former more often than the latter.

I think the current implementation also wins because this change wouldn't be a
significant improvement, and it's better to keep the API more stable. (1.0
looming or not, stability should be the default unless the API in question is
very new, or there is a significant benefit to changing...)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021014/d08f2f25/attachment.sig>

From glyph at twistedmatrix.com  Mon Oct 14 13:42:19 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 14 Oct 2002 14:42:19 -0500 (CDT)
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <LKENLBBMDHMKBECHIAIAKEHPCMAA.andy@reportlab.com>
References: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com>
	<LKENLBBMDHMKBECHIAIAKEHPCMAA.andy@reportlab.com>
Message-ID: <20021014.144219.26098220.glyph@twistedmatrix.com>


On Mon, 14 Oct 2002 02:09:54 +0100, "Andy Robinson" <andy at reportlab.com> wrote:
> >python setup.py bdist_wininst --install-script wininstall.py

Awesome!  Thanks for finding this out.  Can't wait to see your setup.py
patches! :)


-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021014/f5bb7768/attachment.sig>

From glyph at twistedmatrix.com  Mon Oct 14 13:45:11 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 14 Oct 2002 14:45:11 -0500 (CDT)
Subject: [Twisted-Python] twisted.persisted.journal: a
 prevayler-inspired persistence system
In-Reply-To: <20021013202936.75b83de6.twisted@itamarst.org>
References: <20021013024405.5be04806.twisted@itamarst.org>
	<20021013.161104.89043483.glyph@twistedmatrix.com>
	<20021013202936.75b83de6.twisted@itamarst.org>
Message-ID: <20021014.144511.89040546.glyph@twistedmatrix.com>

On Sun, 13 Oct 2002 20:29:36 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:
> In other words - do it in the command, not in the framework, because
> frankly I have no way of knowing what random generator you use and so
> on.

You're right, of course.  It would be nice to have this supported by the
framework so that code _not_ designed to work with prevalence would still
function correctly, but there's a lot more to getting that to work than just
replacing the time and random modules. I/O is certainly a big one.

Your suggestion has a nice bonus, too.  It will actually make commands easier
to audit (and query, if you're using relational storage) since all the
information will be persistent as attributes rather than subtransactions.


-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021014/6033db49/attachment.sig>

From andy at reportlab.com  Mon Oct 14 15:28:41 2002
From: andy at reportlab.com (Andy Robinson)
Date: Mon, 14 Oct 2002 22:28:41 +0100
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021014.144219.26098220.glyph@twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAEEIICMAA.andy@reportlab.com>

> Awesome!  Thanks for finding this out.  Can't wait to see your setup.py
> patches! :)

I'm really scared now.  Should have kept my mouth shut.
Actually, my cunning master plan is to make all the beginners
mistakes in your 'release 1.0', so by the time I have to do it for
my own products I'll know what to do :-)


thanks,

Andy



From bob at redivi.com  Mon Oct 14 15:58:32 2002
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 14 Oct 2002 17:58:32 -0400
Subject: [Twisted-Python] Re: OS X and setup.py
In-Reply-To: <lku1jp46ks.fsf@pc150.maths.bris.ac.uk>
Message-ID: <145AD0FA-DFC0-11D6-9A91-0003938210D6@redivi.com>

On Monday, October 14, 2002, at 07:12 AM, Michael Hudson wrote:

> Andrew Bennetts <andrew-twisted at puzzling.org> writes:
>
>> On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
>>> This part of setup.py is breaking build_ext on OS X (which doesn't 
>>> have
>>> poll):
>>
>> My OS X informant also says:
>> <Screwtape> Better test it on another OS X system, too.
>> <Screwtape> This one might be a little damaged.
>> <Screwtape> (i.e. it has a manpage for poll(), but no header file)
>
> I think fink installs some kind of poll() emulation library, which can
> cause confusion.
>

That's exactly correct.  OS X has never shipped with poll() or the 
associated manpages.  I believe the one they use is here:  
http://www.clapper.org/software/poll/

I use vim, so I don't need fink :)

-bob




From twisted at itamarst.org  Mon Oct 14 16:54:17 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 14 Oct 2002 18:54:17 -0400
Subject: [Twisted-Python] Notice to everyone who SUBMITTED PATCHS to Twisted
Message-ID: <20021014185417.6e40c295.twisted@itamarst.org>

If your patch has not been checked in, please add it to the bug tracker
at http://sourceforge.net/projects/twisted/.

Additionally, make sure you agree to doc/legal/whateverit's called, i.e.
making  sure glyph has copyright.

Lastly, bug whoever is listed as the module maintainer in the module
docstring about it.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From radix at twistedmatrix.com  Mon Oct 14 17:01:46 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 15 Oct 2002 01:01:46 +0200
Subject: [Twisted-Python] Patch for extra IRC events.
In-Reply-To: <0288BCD1-DEBA-11D6-88F9-003065D61A3E@froup.com>
References: <0288BCD1-DEBA-11D6-88F9-003065D61A3E@froup.com>
Message-ID: <20021014230146.GA18566@twistedmatrix.com>

On Mon, Oct 14, 2002 at 12:42:33AM +1000, Tim Allen wrote:
> Here's a patch that makes the IRC protocol notice a few more events, and 
> also keeps a record of the MOTD in case we want to refer to it later.
> 
> All the advertised features seem to work on Slashnet.
> 


Do you agree to give Glyph copyright (as itamar mentioned in his last
mail to the list)? I'll commit the patch if you do.




From andrew-twisted at puzzling.org  Mon Oct 14 18:09:20 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 15 Oct 2002 10:09:20 +1000
Subject: [Twisted-Python] Re: [Twisted-commits] Accumulated Woven Changes::
In-Reply-To: <20021014.143910.74754385.glyph@twistedmatrix.com>
References: <3DAADFBA.1020803@cubik.org> <20021014153945.GA13235@twistedmatrix.com> <20021014163156.GE464@frobozz.local> <20021014.143910.74754385.glyph@twistedmatrix.com>
Message-ID: <20021015000920.GA16784@ritsuko.xware.cx>

On Mon, Oct 14, 2002 at 02:39:10PM -0500, Glyph Lefkowitz wrote:
> 
> On Tue, 15 Oct 2002 02:31:56 +1000, Andrew Bennetts
> <andrew-twisted at puzzling.org> wrote:
> > This makes me wonder if most of the time you want to add a callback
> > and an errback, you want the errback to be able to catch the
> > callbacks errors.
> 
> I originally experimented with it that way, and I like it better the
> way it is.  For example, in the case of a remote method call, you use
> addCallbacks if you want to handle the remote call by saying "Here is
> the result: ..." or "Remote traceback: ..."  It's really misleading to
> have the "remote traceback" message happen in the case where the
> traceback is really local.  Worse yet is to have a situation where
> it's acceptable to swallow any remote error, but a local error is
> unexpected.  Since the default behavior should be to print out a
> traceback in the log, naive use of addCallbacks will do the right
> thing.

Good point.  I am convinced.

After all, a more accurate picture of my mini try/except in my last
email really should've been:
    try:
        res = call_that_may_take_some_time()
    except Failure, f:
        eb(f)
    else:
        cb(res)

-Andrew.




From andrew-twisted at puzzling.org  Tue Oct 15 03:43:56 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 15 Oct 2002 19:43:56 +1000
Subject: [Twisted-Python] Patch for extra IRC events.
In-Reply-To: <20021014230146.GA18566@twistedmatrix.com>
References: <0288BCD1-DEBA-11D6-88F9-003065D61A3E@froup.com> <20021014230146.GA18566@twistedmatrix.com>
Message-ID: <20021015094355.GA717@frobozz.local>

On Tue, Oct 15, 2002 at 01:01:46AM +0200, Christopher Armstrong wrote:
> On Mon, Oct 14, 2002 at 12:42:33AM +1000, Tim Allen wrote:
> > Here's a patch that makes the IRC protocol notice a few more events, and 
> > also keeps a record of the MOTD in case we want to refer to it later.
> > 
> > All the advertised features seem to work on Slashnet.
> 
> Do you agree to give Glyph copyright (as itamar mentioned in his last
> mail to the list)? I'll commit the patch if you do.

He does, so I've committed it.  See the checkin message for details :)

-Andrew.




From mwh at python.net  Tue Oct 15 03:12:23 2002
From: mwh at python.net (Michael Hudson)
Date: 15 Oct 2002 10:12:23 +0100
Subject: [Twisted-Python] Re: OS X and setup.py
References: <lku1jp46ks.fsf@pc150.maths.bris.ac.uk> <145AD0FA-DFC0-11D6-9A91-0003938210D6@redivi.com>
Message-ID: <lk8z103w20.fsf@pc150.maths.bris.ac.uk>

Bob Ippolito <bob at redivi.com> writes:

> On Monday, October 14, 2002, at 07:12 AM, Michael Hudson wrote:
> 
> > Andrew Bennetts <andrew-twisted at puzzling.org> writes:
> >
> >> On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
> >>> This part of setup.py is breaking build_ext on OS X (which doesn't
> >>> have
> >>> poll):
> >>
> >> My OS X informant also says:
> >> <Screwtape> Better test it on another OS X system, too.
> >> <Screwtape> This one might be a little damaged.
> >> <Screwtape> (i.e. it has a manpage for poll(), but no header file)
> >
> > I think fink installs some kind of poll() emulation library, which can
> > cause confusion.
> >
> 
> That's exactly correct.  OS X has never shipped with poll() or the
> associated manpages.  I believe the one they use is here:
> http://www.clapper.org/software/poll/

And, of course, the aggravating thing is that because it's only an
emulation you don't actually get any of the performance benefits of
using poll(), and in fact probably lose out through overheads.

> I use vim, so I don't need fink :)

I built Emacs from CVS yesterday, so now I can start de-finking my
machine :)

Cheers,
M.

-- 
  C++ is a siren song.  It *looks* like a HLL in which you ought to
  be able to write an application, but it really isn't.
                                       -- Alain Picard, comp.lang.lisp





From twisted at moshez.org  Tue Oct 15 06:10:23 2002
From: twisted at moshez.org (Moshe Zadka)
Date: Tue, 15 Oct 2002 07:10:23 -0500
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom [PATCH]
Message-ID: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>

This patch touches many places, so I wanted to run it by the list
first.

Thanks.

diff -ur -x CVS Twisted.clean/twisted/enterprise/reflector.py Twisted/twisted/enterprise/reflector.py
--- Twisted.clean/twisted/enterprise/reflector.py	Thu Oct 10 21:41:28 2002
+++ Twisted/twisted/enterprise/reflector.py	Tue Oct 15 07:06:14 2002
@@ -59,8 +59,8 @@
         # mainloop is not running.  I'm not sure what the correct behavior here
         # should be. --glyph
         
-        from twisted.internet import reactor
-        reactor.callLater(0, self._really_populate)
+        from twisted.internet import utils
+        utils.sched(self._really_populate)
 
     def _really_populate(self):
         """Implement me to populate schema information for the reflector.
diff -ur -x CVS Twisted.clean/twisted/internet/defer.py Twisted/twisted/internet/defer.py
--- Twisted.clean/twisted/internet/defer.py	Fri Sep 27 10:38:18 2002
+++ Twisted/twisted/internet/defer.py	Tue Oct 15 06:59:12 2002
@@ -40,10 +40,6 @@
     log.err(err)
     return err
 
-def _sched(m, r):
-    from twisted.internet import reactor
-    reactor.callLater(0, m, r)
-
 def succeed(result):
     d = Deferred()
     d.callback(result)
diff -ur -x CVS Twisted.clean/twisted/internet/udp.py Twisted/twisted/internet/udp.py
--- Twisted.clean/twisted/internet/udp.py	Mon Oct 14 13:30:09 2002
+++ Twisted/twisted/internet/udp.py	Tue Oct 15 06:59:35 2002
@@ -220,8 +220,8 @@
         """
         self.stopReading()
         if self.connected:
-            from twisted.internet import reactor
-            reactor.callLater(0, self.connectionLost)
+            from twisted.internet import utils
+            utils.sched(self.connectionLost)
 
     def connectionLost(self, reason=None):
         """Cleans up my socket.
diff -ur -x CVS Twisted.clean/twisted/internet/utils.py Twisted/twisted/internet/utils.py
--- Twisted.clean/twisted/internet/utils.py	Sun Oct 13 04:08:50 2002
+++ Twisted/twisted/internet/utils.py	Tue Oct 15 07:04:41 2002
@@ -70,3 +70,6 @@
 
 def getProcessValue(executable, args=(), env={}, path='.'):
     return callProtocolWithDeferred(_ValueGetter, executable, args, env, path)
+
+def sched(f, *args, **kw):
+    reactor.callLater(0, f, *args, **kw)
diff -ur -x CVS Twisted.clean/twisted/news/news.py Twisted/twisted/news/news.py
--- Twisted.clean/twisted/news/news.py	Thu Oct  3 09:40:32 2002
+++ Twisted/twisted/news/news.py	Tue Oct 15 07:00:42 2002
@@ -21,7 +21,7 @@
 """
 
 from twisted.protocols import nntp
-from twisted.internet import protocol, reactor
+from twisted.internet import protocol, reactor, utils
 
 import time
 
@@ -79,7 +79,7 @@
 
 
     def startFactory(self):
-        self._updateCall = reactor.callLater(0, self.syncWithRemotes)
+        self._updateCall = utils.sched(self.syncWithRemotes)
 
 
     def stopFactory(self):
diff -ur -x CVS Twisted.clean/twisted/protocols/ftp.py Twisted/twisted/protocols/ftp.py
--- Twisted.clean/twisted/protocols/ftp.py	Mon Oct 14 13:30:09 2002
+++ Twisted/twisted/protocols/ftp.py	Tue Oct 15 07:01:31 2002
@@ -71,7 +71,7 @@
 from math import floor
 
 # Twisted Imports
-from twisted.internet import abstract, reactor, protocol
+from twisted.internet import abstract, reactor, protocol, utils
 from twisted.internet.interfaces import IProducer
 from twisted.protocols import basic
 from twisted.internet.protocol import ClientFactory, ServerFactory, Protocol
@@ -146,7 +146,7 @@
 
     def stopProducing(self):
         self.request.unregisterProducer()
-        reactor.callLater(0, self.request.finish)
+        utils.sched(self.request.finish)
         self.request = None
 
 
diff -ur -x CVS Twisted.clean/twisted/test/test_ftp.py Twisted/twisted/test/test_ftp.py
--- Twisted.clean/twisted/test/test_ftp.py	Fri Sep  6 01:45:31 2002
+++ Twisted/twisted/test/test_ftp.py	Tue Oct 15 07:02:04 2002
@@ -16,7 +16,7 @@
 
 from pyunit import unittest
 from twisted.protocols import ftp, loopback
-from twisted.internet import reactor
+from twisted.internet import reactor, utils
 from twisted.internet.protocol import Protocol, FileWrapper, Factory, \
                                       ClientFactory
 
@@ -80,7 +80,7 @@
 
     def writeResponses(self, protocol, responses):
         for response in responses:
-            reactor.callLater(0, protocol.lineReceived, response)
+            utils.sched(protocol.lineReceived, response)
 
 
 class FTPServerTests(unittest.TestCase):
diff -ur -x CVS Twisted.clean/twisted/test/test_rebuild.py Twisted/twisted/test/test_rebuild.py
--- Twisted.clean/twisted/test/test_rebuild.py	Fri Sep 20 15:29:40 2002
+++ Twisted/twisted/test/test_rebuild.py	Mon Oct 14 08:00:37 2002
@@ -70,6 +70,7 @@
         else:
             b2 = myrebuilder.B()
             assert b2.b() == 'c'
+            print "MOSHE!!!!", b.b()
             assert b.b() == 'c'
         assert i.a() == 'd'
         assert a.a() == 'b'
diff -ur -x CVS Twisted.clean/twisted/web/static.py Twisted/twisted/web/static.py
--- Twisted.clean/twisted/web/static.py	Thu Oct 10 13:32:26 2002
+++ Twisted/twisted/web/static.py	Tue Oct 15 07:02:25 2002
@@ -196,8 +196,8 @@
     def upgradeToVersion5(self):
         if not isinstance(self.registry, Registry):
             self.registry = Registry()
-            from twisted.internet import reactor
-            reactor.callLater(0, _upgradeRegistry, self.registry)
+            from twisted.internet import utils
+            utils.sched(_upgradeRegistry, self.registry)
 
     def upgradeToVersion4(self):
         if not hasattr(self, 'registry'):
diff -ur -x CVS Twisted.clean/twisted/web/woven/template.py Twisted/twisted/web/woven/template.py
--- Twisted.clean/twisted/web/woven/template.py	Wed Oct  9 13:37:41 2002
+++ Twisted/twisted/web/woven/template.py	Tue Oct 15 07:02:49 2002
@@ -77,7 +77,7 @@
 
 from twisted.internet import defer
 from twisted.python import failure
-from twisted.internet import reactor, defer
+from twisted.internet import reactor, defer, utils
 from twisted.python import log
 
 from twisted.web.server import NOT_DONE_YET
@@ -195,7 +195,7 @@
                 raise AttributeError, "%s does not define self.templateFile to operate on" % self.__class__
             self.d = self.lookupTemplate(request)
         # Schedule processing of the document for later...
-        reactor.callLater(0, self.handleDocument, request, self.d)
+        utils.sched(0, self.handleDocument, request, self.d)
         #self.handleNode(request, self.d)
         #return str(self.d.toxml())
         




From bob at redivi.com  Tue Oct 15 06:28:08 2002
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 15 Oct 2002 08:28:08 -0400
Subject: [Twisted-Python] Re: OS X and setup.py
In-Reply-To: <lk8z103w20.fsf@pc150.maths.bris.ac.uk>
Message-ID: <8FC0249F-E039-11D6-9A91-0003938210D6@redivi.com>

On Tuesday, Oct 15, 2002, at 05:12 America/New_York, Michael Hudson 
wrote:

> Bob Ippolito <bob at redivi.com> writes:
>
>> On Monday, October 14, 2002, at 07:12 AM, Michael Hudson wrote:
>>
>>> Andrew Bennetts <andrew-twisted at puzzling.org> writes:
>>>
>>>> On Sun, Oct 13, 2002 at 02:08:37PM +1000, Andrew Bennetts wrote:
>>>>> This part of setup.py is breaking build_ext on OS X (which doesn't
>>>>> have
>>>>> poll):
>>>>
>>>> My OS X informant also says:
>>>> <Screwtape> Better test it on another OS X system, too.
>>>> <Screwtape> This one might be a little damaged.
>>>> <Screwtape> (i.e. it has a manpage for poll(), but no header file)
>>>
>>> I think fink installs some kind of poll() emulation library, which 
>>> can
>>> cause confusion.
>>>
>>
>> That's exactly correct.  OS X has never shipped with poll() or the
>> associated manpages.  I believe the one they use is here:
>> http://www.clapper.org/software/poll/
>
> And, of course, the aggravating thing is that because it's only an
> emulation you don't actually get any of the performance benefits of
> using poll(), and in fact probably lose out through overheads.
>

Yes, but it's still probably not much slower than using select from 
python.. afaik, poll() is only used in twisted by creactor, which isn't 
really used at all.

>> I use vim, so I don't need fink :)
>
> I built Emacs from CVS yesterday, so now I can start de-finking my
> machine :)




From bruce at cubik.org  Tue Oct 15 07:33:12 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 15 Oct 2002 07:33:12 -0600
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom
 [PATCH]
References: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>
Message-ID: <3DAC1918.5050102@cubik.org>

Moshe Zadka wrote:
> This patch touches many places, so I wanted to run it by the list
> first.

I have no real opinion on whether or not something is wrong with the 
idea of a callLater(0, ...), but:

Could it be utils.schedule() or some other complete word rather than 
'sched'?

And the following part of your diff contains an obvious error:

> diff -ur -x CVS Twisted.clean/twisted/web/woven/template.py Twisted/twisted/web/woven/template.py
> --- Twisted.clean/twisted/web/woven/template.py	Wed Oct  9 13:37:41 2002
> +++ Twisted/twisted/web/woven/template.py	Tue Oct 15 07:02:49 2002
> @@ -77,7 +77,7 @@
>  
>  from twisted.internet import defer
>  from twisted.python import failure
> -from twisted.internet import reactor, defer
> +from twisted.internet import reactor, defer, utils
>  from twisted.python import log
>  
>  from twisted.web.server import NOT_DONE_YET
> @@ -195,7 +195,7 @@
>                  raise AttributeError, "%s does not define self.templateFile to operate on" % self.__class__
>              self.d = self.lookupTemplate(request)
>          # Schedule processing of the document for later...
> -        reactor.callLater(0, self.handleDocument, request, self.d)
> +        utils.sched(0, self.handleDocument, request, self.d)
>          #self.handleNode(request, self.d)
>          #return str(self.d.toxml())

  - Bruce




From sean at twistedmatrix.com  Tue Oct 15 09:55:44 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Tue, 15 Oct 2002 10:55:44 -0500
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <3DAC1918.5050102@cubik.org>
Message-ID: <PGEKIMFOMBFCPBEILDBLOECCCBAA.sean@twistedmatrix.com>

i agree. please call it something complete.

why move it to "utils."? it seems inconsistent to have reactor.callLater and
utils.schedule.. shouldn't they both be on the same module?

-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Bruce
Mitchener
Sent: Tuesday, October 15, 2002 8:33 AM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] reactor.callLater(0,) should not be an
idiom[PATCH]


Moshe Zadka wrote:
> This patch touches many places, so I wanted to run it by the list
> first.

I have no real opinion on whether or not something is wrong with the
idea of a callLater(0, ...), but:

Could it be utils.schedule() or some other complete word rather than
'sched'?

And the following part of your diff contains an obvious error:

> diff -ur -x CVS Twisted.clean/twisted/web/woven/template.py
Twisted/twisted/web/woven/template.py
> --- Twisted.clean/twisted/web/woven/template.py	Wed Oct  9 13:37:41 2002
> +++ Twisted/twisted/web/woven/template.py	Tue Oct 15 07:02:49 2002
> @@ -77,7 +77,7 @@
>
>  from twisted.internet import defer
>  from twisted.python import failure
> -from twisted.internet import reactor, defer
> +from twisted.internet import reactor, defer, utils
>  from twisted.python import log
>
>  from twisted.web.server import NOT_DONE_YET
> @@ -195,7 +195,7 @@
>                  raise AttributeError, "%s does not define
self.templateFile to operate on" % self.__class__
>              self.d = self.lookupTemplate(request)
>          # Schedule processing of the document for later...
> -        reactor.callLater(0, self.handleDocument, request, self.d)
> +        utils.sched(0, self.handleDocument, request, self.d)
>          #self.handleNode(request, self.d)
>          #return str(self.d.toxml())

  - Bruce


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From twisted at moshez.org  Tue Oct 15 12:19:15 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 15 Oct 2002 18:19:15 -0000
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <PGEKIMFOMBFCPBEILDBLOECCCBAA.sean@twistedmatrix.com>
References: <PGEKIMFOMBFCPBEILDBLOECCCBAA.sean@twistedmatrix.com>
Message-ID: <20021015181915.29562.qmail@green.zadka.com>

On Tue, 15 Oct 2002, "Sean Riley" <sean at twistedmatrix.com> wrote:

> why move it to "utils."? it seems inconsistent to have reactor.callLater and
> utils.schedule.. shouldn't they both be on the same module?

No. reactor is a "virtual" module.



From sean at twistedmatrix.com  Tue Oct 15 13:06:32 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Tue, 15 Oct 2002 14:06:32 -0500
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <20021015181915.29562.qmail@green.zadka.com>
Message-ID: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>

That doesn't answer my question. Shouldn't schedule() and callLater() appear
to the user to be called on the same module regardless of the underlying
implementation details?


-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Moshe Zadka
Sent: Tuesday, October 15, 2002 1:19 PM
To: twisted-python at twistedmatrix.com
Subject: RE: [Twisted-Python] reactor.callLater(0,) should not be an
idiom[PATCH]


On Tue, 15 Oct 2002, "Sean Riley" <sean at twistedmatrix.com> wrote:

> why move it to "utils."? it seems inconsistent to have reactor.callLater
and
> utils.schedule.. shouldn't they both be on the same module?

No. reactor is a "virtual" module.

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From twisted at itamarst.org  Tue Oct 15 13:07:41 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 15 Oct 2002 15:07:41 -0400
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>
References: <20021015181915.29562.qmail@green.zadka.com>
	<PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>
Message-ID: <20021015150741.623432d1.twisted@itamarst.org>

On Tue, 15 Oct 2002 14:06:32 -0500
"Sean Riley" <sean at twistedmatrix.com> wrote:

> That doesn't answer my question. Shouldn't schedule() and callLater()
> appear to the user to be called on the same module regardless of the
> underlying implementation details?

No. reactor is for core, low-level interfaces only. Anything that can be
built on top of these APIs should not be in the reactor.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From alexander.levy at tufts.edu  Tue Oct 15 12:49:00 2002
From: alexander.levy at tufts.edu (Alex Levy)
Date: Tue, 15 Oct 2002 14:49:00 -0400
Subject: [Twisted-Python] Batch file errors in Windows distribution (0.99.4)
Message-ID: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>

In the batch files installed by the Windows 0.99.4 package, the Python 
executable is referenced as C:\PROGRAM FILES\PYTHON2.2\PYTHON.EXE.  This 
causes two problems, one of which is easier to fix than the other.

1. Either PROGRAM FILES needs to become PROGRA~1, or the entire file name 
needs to be in quotes.
2. It looks like this path is hardcoded, since my version of Python isn't 
installed there.

Thought I'd mention it.  You may now resume discussing things that matter.

--
Alex Levy
WWW: http://mesozoic.geecs.org
Tel: 617.835.0778

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_





From m at moshez.org  Tue Oct 15 13:16:05 2002
From: m at moshez.org (Moshe Zadka)
Date: 15 Oct 2002 19:16:05 -0000
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>
References: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com>
Message-ID: <20021015191605.30529.qmail@green.zadka.com>

On Tue, 15 Oct 2002, "Sean Riley" <sean at twistedmatrix.com> wrote:

> That doesn't answer my question. Shouldn't schedule() and callLater() appear
> to the user to be called on the same module regardless of the underlying
> implementation details?

That's not the correct question. The question is "is it possible?".
The answer is that it is not possible without doing really obscure
things. Thus, it shouldn't be done. If you'll recall, this was why
.utils got there in the first place (namely, the process stuff).

Also, could you possibly observe common netiquette and stop quoting
whole messages or putting your response before what you're responding
to? Thank you.



From glyph at twistedmatrix.com  Tue Oct 15 14:39:59 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 15 Oct 2002 15:39:59 -0500 (CDT)
Subject: [Twisted-Python] Batch file errors in Windows distribution
 (0.99.4)
In-Reply-To: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>
References: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>
Message-ID: <20021015.153959.56565984.glyph@twistedmatrix.com>


On Tue, 15 Oct 2002 14:49:00 -0400, Alex Levy <alexander.levy at tufts.edu> wrote:

> 1. Either PROGRAM FILES needs to become PROGRA~1, or the entire file name
> needs to be in quotes.

The filename needs to be in quotes. PROGRA~1 only works on ancient DOS
filesystems.

> 2. It looks like this path is hardcoded, since my version of Python isn't 
> installed there.

Hmm, that's weird.  It ought to be able to determine that from sys.argv[0],
right?  (Windows folks?)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021015/e7c292fe/attachment.sig>

From andy at reportlab.com  Tue Oct 15 14:56:40 2002
From: andy at reportlab.com (Andy Robinson)
Date: Tue, 15 Oct 2002 21:56:40 +0100
Subject: [Twisted-Python] Batch file errors in Windows distribution (0.99.4)
In-Reply-To: <20021015.153959.56565984.glyph@twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAIEKGCMAA.andy@reportlab.com>

> Hmm, that's weird.  It ought to be able to determine that from 
> sys.argv[0],
No, use sys.executable just like on Unix.

I think he's right about Progra~1 working, but that
doesn't mean we have to use it :-)

Python 2.2.1 (#34, Apr  9 2002, 19:34:33) [MSC 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.argv[0]
''
>>> sys.executable
'c:\\python22\\python.exe'
>>>

- Andy Robinson



From twisted at itamarst.org  Tue Oct 15 15:02:25 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 15 Oct 2002 17:02:25 -0400
Subject: [Twisted-Python] Batch file errors in Windows distribution (0.99.4)
In-Reply-To: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>
References: <5.1.1.6.0.20021015144612.00bb9258@coral.tufts.edu>
Message-ID: <20021015170225.5405f622.twisted@itamarst.org>

On Tue, 15 Oct 2002 14:49:00 -0400
Alex Levy <alexander.levy at tufts.edu> wrote:

> In the batch files installed by the Windows 0.99.4 package, the Python
> 
> executable is referenced as C:\PROGRAM FILES\PYTHON2.2\PYTHON.EXE. 
> This causes two problems, one of which is easier to fix than the
> other.

... sys.executable is suggested ...

The problem is that sys.executable is the Python on the system creating
the installer .exe, not the one where it's being installed. But the "run
script after install" Andy Robinson suggsted should allow this.

If I don't get a patch from Andy today I'm going to do my best to fix
the two issues with the Win32 installer (docs and .bat files) myself
tonight, so we can do 1.0rc1 tommorow.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andy at reportlab.com  Tue Oct 15 15:02:40 2002
From: andy at reportlab.com (Andy Robinson)
Date: Tue, 15 Oct 2002 22:02:40 +0100
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
In-Reply-To: <20021015191605.30529.qmail@green.zadka.com>
Message-ID: <LKENLBBMDHMKBECHIAIACEKHCMAA.andy@reportlab.com>

> Also, could you possibly observe common netiquette and stop quoting
> whole messages or putting your response before what you're responding
> to? Thank you.

FYI Outlook makes you jump through hoops to reply 'the normal way'.
It's default is to preserve the whole message before what you
type.  It CAN be done, but not if your company enforces a
standard desktop configuration...

- Andy




From glyph at twistedmatrix.com  Tue Oct 15 16:46:18 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 15 Oct 2002 17:46:18 -0500 (CDT)
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom
 [PATCH]
In-Reply-To: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>
References: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>
Message-ID: <20021015.174618.74757373.glyph@twistedmatrix.com>


On Tue, 15 Oct 2002 07:10:23 -0500, Moshe Zadka <twisted at moshez.org> wrote:
> This patch touches many places, so I wanted to run it by the list
> first.

Why should this not be an idiom?

Neither utils.schedule(...) nor callLater(0,...) is particularly obviously
named unless you read the docstring, and utils.schedule adds a bunch of
getattr/python function call stuff to the cases where it's used for apparently
no reason.  Not to mention the fact that it provides a new way to write Twisted
code that is not backwards compatible with older versions of Twisted.  This
also does not add any functionality.

So, let's review, in order of importance.  This patch:

    * fixed no bugs
    * added no features
    * touched a lot of code
    * destabilized a core Twisted API (in a fowards-compatible but not
      backwards-compatible way) in that it implies callLater(0...) is
      deprecated
    * made a very basic and frequently-used idiom slightly less efficient

Most of all, it provides two ways of doing the exact same thing, and I
generally think that the TIMTOWTDI philosophy is awful.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021015/996d8f83/attachment.sig>

From glyph at twistedmatrix.com  Tue Oct 15 17:12:23 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 15 Oct 2002 18:12:23 -0500 (CDT)
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom
 [PATCH]
In-Reply-To: <20021015.174618.74757373.glyph@twistedmatrix.com>
References: <E181QWl-0007pv-00@pyramid.twistedmatrix.com>
	<20021015.174618.74757373.glyph@twistedmatrix.com>
Message-ID: <20021015.181223.78706653.glyph@twistedmatrix.com>

On Tue, 15 Oct 2002 17:46:18 -0500 (CDT), Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> So, let's review, in order of importance.  This patch:

Oh, I forgot to mention; the structure of the "utils" module also makes it
impossible to use multiple reactors with it.  I'd like to avoid inserting this
assumption into the codebase more than absolutely necessary.  utils.schedule is
particularly bad because it requires varargs and we can't insert an optional
'reactor' kwarg.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021015/588c0b4a/attachment.sig>

From bruce at cubik.org  Tue Oct 15 23:32:45 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 15 Oct 2002 23:32:45 -0600
Subject: [Twisted-Python] reactor.callLater(0,) should not be an idiom[PATCH]
References: <PGEKIMFOMBFCPBEILDBLEECECBAA.sean@twistedmatrix.com> <20021015191605.30529.qmail@green.zadka.com>
Message-ID: <3DACF9FD.5070806@cubik.org>

Hello Moshe,

Moshe Zadka wrote:
> On Tue, 15 Oct 2002, "Sean Riley" <sean at twistedmatrix.com> wrote:
>>That doesn't answer my question. Shouldn't schedule() and callLater() appear
>>to the user to be called on the same module regardless of the underlying
>>implementation details?
> 
> That's not the correct question. The question is "is it possible?".
> The answer is that it is not possible without doing really obscure
> things. Thus, it shouldn't be done. If you'll recall, this was why
> .utils got there in the first place (namely, the process stuff).

Having an obscure and less usable API with some parts of the API on one 
object and other parts on some other object (or maybe even multiple 
other objects) isn't something that creates a nice usable and easy to 
learn/use framework.  Implementation details needn't (and shouldn't) 
bleed through into the public interfaces in the sort of manner that you 
are suggesting.  If they do, then perhaps something larger is wrong.

> Also, could you possibly observe common netiquette and stop quoting
> whole messages or putting your response before what you're responding
> to? Thank you.

You might try lightening your tone on the list.  You might be (are 
supposedly from what people have told me when I've asked) a decent 
person in real life, but you come across on this list as being overly 
confrontational, rude, and abrupt.

If 1.0 is happening soon, I'd hope that people asking (reasonable!) 
questions like this would be treated with some courtesy and respect and 
actual answers rather than the 'No. reactor is a "virtual" module.' sort 
of answer that provides no useful information.  However good Twisted may 
be, the attitudes that we show on the list when dealing with any user 
can be enough to convince people that Twisted is good or that it is bad 
and to be avoided.  I certainly hope that the latter doesn't (continue 
to) happen.

Regards,

  - Bruce




From md9ms at mdstud.chalmers.se  Wed Oct 16 02:42:38 2002
From: md9ms at mdstud.chalmers.se (Martin =?ISO-8859-1?Q?Sj=F6gren?=)
Date: 16 Oct 2002 10:42:38 +0200
Subject: [Twisted-Python] Question about resources (and woven?)
Message-ID: <1034757758.1272.4.camel@winterfell>

I have an xhtml template that has

<textarea model="quote" view="EscapedText" name="quote" id="quote"
cols="60" rows="5"></textarea>
<input model="comment" view="Input" type="text" name="comment"
id="comment" size="30" value="" />
<input model="sentby" view="Input" type="text" name="name" id="name"
size="30" value="" />
<select model="languages" view="List" name="language" id="language">
    <option id="listItem" view="MyOption" />
</select>

This all lives in a submodel called 'editor'. When I submit this form, I
get the following request.args:

{'quote': ['this is a quote'], 'editor/sentby': ['my name'],
'editor/comment': ['this is a comment'], 'language': ['Swedish']}

My question is: Why the 'editor/' part in sentby and comment, but not
quote and language? Why is it using 'sentby' instead of 'name' (which is
the id and name settings of the input)?


Regards,
Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Detta r en digitalt signerad	meddelandedel
URL: </pipermail/twisted-python/attachments/20021016/338a40a3/attachment.sig>

From dp at twistedmatrix.com  Wed Oct 16 09:37:56 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 16 Oct 2002 08:37:56 -0700
Subject: [Twisted-Python] Question about resources (and woven?)
In-Reply-To: <1034757758.1272.4.camel@winterfell>
Message-ID: <3E347E47-E11D-11D6-B4DA-000393B3EC2C@twistedmatrix.com>

On Wednesday, October 16, 2002, at 01:42 AM, Martin Sjgren wrote:
>
> This all lives in a submodel called 'editor'. When I submit this form, 
> I
> get the following request.args:
>
> {'quote': ['this is a quote'], 'editor/sentby': ['my name'],
> 'editor/comment': ['this is a comment'], 'language': ['Swedish']}
>
> My question is: Why the 'editor/' part in sentby and comment, but not
> quote and language?

Because sentby and comment have view="Input"; the Input widgets set the 
name attribute to the full path of the submodel. Since the other view 
widgets don't do this, it's not happening on those nodes.

>  Why is it using 'sentby' instead of 'name' (which is
> the id and name settings of the input)?

Because the model attribute is "sentby"...




From gilh at sympatico.ca  Wed Oct 16 12:33:01 2002
From: gilh at sympatico.ca (Gil Hauer)
Date: 16 Oct 2002 14:33:01 -0400
Subject: [Twisted-Python] twisted.web question
Message-ID: <1034793181.1935.35.camel@giantclam>

Hello,

I'd like one server to be able to host several web sites, hence:

Is it possible to use Twisted.web with virtual host functionality such
as that provided by Apache?


Thanks,
Gil
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021016/e19a2208/attachment.sig>

From thomas.heller at ion-tof.com  Wed Oct 16 12:39:48 2002
From: thomas.heller at ion-tof.com (Thomas Heller)
Date: 16 Oct 2002 20:39:48 +0200
Subject: [Twisted-Python] Re: First impressions of Windows downlod
References: <LKENLBBMDHMKBECHIAIAIEHOCMAA.andy@reportlab.com> <LKENLBBMDHMKBECHIAIAKEHPCMAA.andy@reportlab.com>
Message-ID: <d6qa8byj.fsf@ion-tof.com>

"Andy Robinson" <andy at reportlab.com> writes:

> I really should be in bed, but I think I cracked it!
> 
> There is hope.  The bdist_wininst command in Python 2.2
> does not include key changes added by Thomas Heller
> added on Feb 20th (rev 1.29 in CVS).  I downloaded this one 
> and overwrote my existing copy and found I could add an install 
> script. What's more, print statements even show up in the final
> GUI window, and you can make windows shortcuts.  
> 
> So, if you had a 'wininstall.py' script, you would do:
> 
> >python setup.py bdist_wininst --install-script wininstall.py
> 

I just checked in a new version of bdist_wininst with new features.
There's no documentation currently, but I posted an pre/post
install script for PythonCard to the pythoncard mailing list,
which can give you some hints.

You can use it on Python 2.2 and also on older versions to *build* the
installer, but you have to grab distutils from CVS.

Thomas





From twisted at itamarst.org  Wed Oct 16 18:09:01 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 16 Oct 2002 20:09:01 -0400
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <1034793181.1935.35.camel@giantclam>
References: <1034793181.1935.35.camel@giantclam>
Message-ID: <20021016200901.40961400.twisted@itamarst.org>

On 16 Oct 2002 14:33:01 -0400
Gil Hauer <gilh at sympatico.ca> wrote:

> Is it possible to use Twisted.web with virtual host functionality such
> as that provided by Apache?

Sure, look at twisted.web.vhost module.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From twisted at moshez.org  Wed Oct 16 23:24:40 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 17 Oct 2002 05:24:40 -0000
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <1034793181.1935.35.camel@giantclam>
References: <1034793181.1935.35.camel@giantclam>
Message-ID: <20021017052440.22779.qmail@green.zadka.com>

On 16 Oct 2002, Gil Hauer <gilh at sympatico.ca> wrote:

> I'd like one server to be able to host several web sites, hence:
> 
> Is it possible to use Twisted.web with virtual host functionality such
> as that provided by Apache?

Is it ever!
You can decide to go with one big process for all of them, a front server
and a seperate server for each virtual host (for example, for permission
reasons), and you can even mix-and-math between Apache and Twisted (for
example, put Apache in the front and have Twisted handle some subset of the
virtual host).  



From twisted at moshez.org  Thu Oct 17 03:22:17 2002
From: twisted at moshez.org (Moshe Zadka)
Date: Thu, 17 Oct 2002 04:22:17 -0500
Subject: [Twisted-Python] websetroot
Message-ID: <E1826rB-0000Hw-00@pyramid.twistedmatrix.com>

I don't want to check in a new utility without some discussion. Here is the
patch:

diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/ChangeLog Twisted/ChangeLog
--- Twisted.clean/ChangeLog	Tue Oct 15 07:04:57 2002
+++ Twisted/ChangeLog	Thu Oct 17 04:18:18 2002
@@ -1,3 +1,8 @@
+2002-10-17  Moshe Zadka <moshez at twistedmatrix.com>
+
+	* bin/websetroot twisted/scripts/websetroot.py: Added a program to set
+	the root of a web server after the tap exists
+
 2002-10-14  Moshe Zadka <moshez at twistedmatrix.com>
 
 	* twisted/web/vhost.py: add a virtual host monster to support twisted
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/bin/websetroot Twisted/bin/websetroot
--- Twisted.clean/bin/websetroot	Wed Dec 31 18:00:00 1969
+++ Twisted/bin/websetroot	Thu Oct 17 03:22:21 2002
@@ -0,0 +1,29 @@
+#!/usr/bin/env python
+
+# Twisted, the Framework of Your Internet
+# Copyright (C) 2001 Matthew W. Lefkowitz
+#
+# This library is free software; you can redistribute it and/or
+# modify it under the terms of version 2.1 of the GNU Lesser General Public
+# License as published by the Free Software Foundation.
+#
+# This library is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# Lesser General Public License for more details.
+#
+# You should have received a copy of the GNU Lesser General Public
+# License along with this library; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+
+### Twisted Preamble
+# This makes sure that users don't have to set up their environment
+# specially in order to run these programs from bin/.
+import sys, os, string
+if string.find(os.path.abspath(sys.argv[0]), os.sep+'Twisted') != -1:
+    sys.path.insert(0, os.path.normpath(os.path.join(os.path.abspath(sys.argv[0]), os.pardir, os.pardir)))
+sys.path.insert(0, os.curdir)
+### end of preamble
+
+from twisted.scripts.websetroot import run
+run()
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/doc/examples/index.html Twisted/doc/examples/index.html
--- Twisted.clean/doc/examples/index.html	Thu Oct 17 03:46:45 2002
+++ Twisted/doc/examples/index.html	Thu Oct 17 04:20:02 2002
@@ -87,6 +87,7 @@
         <li><a href="hello.rpy.py">hello.rpy.py</a></li>
         <li><a href="simple.rtl">simple.rtl</a></li>
 	<li><a href="courier.py">courier.py</a></li>
+	<li><a href="rootscript.py">rootscript.py</a></li>
     </ul>
     
     <h2>Obsolete?</h2>
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/doc/examples/rootscript.py Twisted/doc/examples/rootscript.py
--- Twisted.clean/doc/examples/rootscript.py	Wed Dec 31 18:00:00 1969
+++ Twisted/doc/examples/rootscript.py	Thu Oct 17 03:42:57 2002
@@ -0,0 +1,9 @@
+from twisted.web import vhost, static, script
+
+default = static.Data('text/html', '')
+default.putChild('vhost', vhost.VHostMonsterResource())
+resource = vhost.NameVirtualHost()
+resource.default = default
+file = static.File('static')
+file.processors = {'.rpy': script.ResourceScript}
+resource.addHost('twistedmatrix.com', file)
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/doc/man/index.html Twisted/doc/man/index.html
--- Twisted.clean/doc/man/index.html	Thu Oct  3 14:24:18 2002
+++ Twisted/doc/man/index.html	Thu Oct 17 04:17:34 2002
@@ -19,6 +19,7 @@
 <li><a href="tap2deb.html"> tap2deb</a></li>
 <li><a href="tapconvert.html">tapconvert</a></li>
 <li><a href="twistd.html">twistd</a></li>
+<li><a href="websetroot.html">websetroot</a></li>
 </ul>
 
 </body></html>
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/doc/man/websetroot.1 Twisted/doc/man/websetroot.1
--- Twisted.clean/doc/man/websetroot.1	Wed Dec 31 18:00:00 1969
+++ Twisted/doc/man/websetroot.1	Thu Oct 17 04:17:15 2002
@@ -0,0 +1,36 @@
+.TH WEBSETROOT "1" "July 2001" "" ""
+.SH NAME
+websetroot \- set the root of a Twisted web server
+.SH SYNOPSIS
+.B websetroot {-f \fItapfile\fR | -y \fIcodefile\fR | -x \fIXML\fR | -s \fIAOT\fR } {--pickle \fIpickle\fR | --script \fIscript\fR } [ -e ] [--port \fIport\fR]
+.B websetroot --help
+.SH DESCRIPTION
+.PP
+The \fB\--help\fR prints out a usage message to standard output.
+.TP \fB-e\fR, \fB--encrypted\fR
+The specified tap/aos/xml file is encrypted.
+.TP \fB-p\fR, \fB--port\fR <port>
+The port the web server is running on [default: 80]
+.TP \fB-f\fR, \fB--file\fR <file>
+read the given .tap file [default: twistd.tap]
+.TP \fB-y\fR, \fB--python\fR <file>
+read an application from within a Python file
+.TP \fB-x\fR, \fB--xml\fR <file>
+Read an application from a .tax file (Marmalade format).
+.TP \fB-s\fR, \fB--source\fR <file>
+Read an application from a .tas file (AOT format).
+.TP \fB--script\fR <file>
+Read the root resource from the given resource script file
+.TP \fB--pickle\fR <file>
+Read the root resource from the given resource pickle file
+.SH AUTHOR
+Written by Moshe Zadka, based on websetroot's help messages
+.SH "REPORTING BUGS"
+Report bugs to <twisted-python at twistedmatrix.com>.
+.SH COPYRIGHT
+Copyright \(co 2000 Matthew W. Lefkowitz
+.br
+This is free software; see the source for copying conditions.  There is NO
+warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
+.SH "SEE ALSO"
+mktap(1)
diff -urN -x *.pyc -x CVS -x static -x howto Twisted.clean/twisted/scripts/websetroot.py Twisted/twisted/scripts/websetroot.py
--- Twisted.clean/twisted/scripts/websetroot.py	Wed Dec 31 18:00:00 1969
+++ Twisted/twisted/scripts/websetroot.py	Thu Oct 17 03:33:35 2002
@@ -0,0 +1,75 @@
+# Twisted, the Framework of Your Internet
+# Copyright (C) 2001-2002 Matthew W. Lefkowitz
+# 
+# This library is free software; you can redistribute it and/or
+# modify it under the terms of version 2.1 of the GNU Lesser General Public
+# License as published by the Free Software Foundation.
+# 
+# This library is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# Lesser General Public License for more details.
+# 
+# You should have received a copy of the GNU Lesser General Public
+# License along with this library; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+# 
+from twisted.scripts import twistd
+from twisted.python import usage
+
+class Options(usage.Options):
+
+    optFlags = [
+                ['encrypted', 'e' ,
+                 "The specified tap/aos/xml file is encrypted."]
+               ]
+
+
+    optParameters = [
+                  ['port','p', 80,
+                   "The port the web server is running on"],
+                  ['file','f','twistd.tap',
+                   "read the given .tap file"],
+                  ['python','y', None,
+                   "read an application from within a Python file"],
+                  ['xml', 'x', None,
+                   "Read an application from a .tax file (Marmalade format)."],
+                  ['source', 's', None,
+                   "Read an application from a .tas file (AOT format)."],
+                    ]
+
+    def opt_script(self, scriptname):
+        d = {}
+        execfile(scriptname, d)
+        self['root'] = d['resource']
+
+    def opt_pickle(self, picklename):
+        self['root'] = cPickle.load(open(picklename))
+ 
+
+def getFactory(app, port):
+    for (num, fact, _, _) in app.tcpPorts:
+        if num == port:
+            return fact
+    raise LookupError('no such port')
+
+def main(config):
+    if config['encrypted']:
+        import getpass
+        passphrase = getpass.getpass('Passphrase: ')
+    else:
+        passphrase = None
+    application = twistd.loadApplication(config, passphrase)
+    site = getFactory(application, int(config['port']))
+    site.resource = config['root']
+    application.save()
+
+
+def run():
+    import sys
+    config = Options()
+    config.parseOptions()
+    try:
+        main(config)
+    except LookupError, err:
+        sys.exit(sys.argv[0]+": "+str(err))




From gilh at sympatico.ca  Thu Oct 17 07:50:32 2002
From: gilh at sympatico.ca (Gil Hauer)
Date: 17 Oct 2002 09:50:32 -0400
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <20021017052440.22779.qmail@green.zadka.com>
References: <1034793181.1935.35.camel@giantclam> 
	<20021017052440.22779.qmail@green.zadka.com>
Message-ID: <1034862633.1877.5.camel@giantclam>

Thanks to all for the information and the pointers!

Gil

On Thu, 2002-10-17 at 01:24, Moshe Zadka wrote:
> On 16 Oct 2002, Gil Hauer <gilh at sympatico.ca> wrote:
> 
> > I'd like one server to be able to host several web sites, hence:
> > 
> > Is it possible to use Twisted.web with virtual host functionality such
> > as that provided by Apache?
> 
> Is it ever!
> You can decide to go with one big process for all of them, a front server
> and a seperate server for each virtual host (for example, for permission
> reasons), and you can even mix-and-math between Apache and Twisted (for
> example, put Apache in the front and have Twisted handle some subset of the
> virtual host).  
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021017/87b6a9ab/attachment.sig>

From john.abel at pa.press.net  Thu Oct 17 08:03:28 2002
From: john.abel at pa.press.net (John Abel)
Date: Thu, 17 Oct 2002 15:03:28 +0100
Subject: [Twisted-Python] Addition to twisted.python.logfile
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com>
Message-ID: <3DAEC330.4050207@pa.press.net>

Hi,

Please go gently with me, this is my first submitted "enhancement"! 
 I've made a small change to twisted.python.logfile, adding the option 
to gzip the log files, once they've been renamed (default is not to 
compress).

I couldn't find any info on submitting a change, so I've attached the 
output from a diff logfile.py logfileII.py

Hope you find it useful.

Regards

John

< import os, stat, glob, string
---
 > import os, stat, glob, string, gzip, fileinput, re
37d36
<
39c38
<     def __init__(self, name, directory, rotateLength=1000000):
---
 >     def __init__(self, name, directory, rotateLength=1000000, 
compressLog=0):
43a43,49
 >         if not compressLog in [0,1]:
 >             self.compressLog = 0
 >         else:
 >             self.compressLog = compressLog
 >         self.globFilePattern = ["%s.*", "%s.*.gz"]
 >         self.renameFilePattern = ["%s.%d","%s.%d.gz"]
 >         self.rePattern = [".*\.(\d)$",".*\.(\d)\.gz$"]
90c96
<         for name in glob.glob("%s.*" % self.path):
---
 >         for name in glob.glob(self.globFilePattern[self.compressLog] 
% self.path):
92,94c98,102
<                 counter = int(string.split(name, '.')[-1])
<                 if counter:
<                     result.append(counter)
---
 >                 reCounter = 
re.match(self.rePattern[self.compressLog],name)
 >                 if reCounter:
 >                     counter = int( reCounter.group(1) )
 >                     if counter:
 >                         result.append(counter)
111c119
<             os.rename("%s.%d" % (self.path, i), "%s.%d" % (self.path, 
i + 1))
---
 >             os.rename(self.renameFilePattern[self.compressLog] % 
(self.path, i), self.renameFilePattern[self.compressLog] % (self.path, i 
+ 1113a122,126






From twisted at moshez.org  Thu Oct 17 10:30:32 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 17 Oct 2002 16:30:32 -0000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <3DAEC330.4050207@pa.press.net>
References: <3DAEC330.4050207@pa.press.net>, <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com>
Message-ID: <20021017163032.30766.qmail@green.zadka.com>

On Thu, 17 Oct 2002, John Abel <john.abel at pa.press.net> wrote:

> Please go gently with me, this is my first submitted "enhancement"! 

Please submit patches as "unified diffs" (diff -u). Otherwise,
they are somewhat hard to read.



From twisted at itamarst.org  Thu Oct 17 13:35:53 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 17 Oct 2002 15:35:53 -0400
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <3DAEC330.4050207@pa.press.net>
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com>
	<3DAEC330.4050207@pa.press.net>
Message-ID: <20021017153553.275ae8ed.twisted@itamarst.org>

On Thu, 17 Oct 2002 15:03:28 +0100
John Abel <john.abel at pa.press.net> wrote:

> Please go gently with me, this is my first submitted "enhancement"! 
>  I've made a small change to twisted.python.logfile, adding the option
>  
> to gzip the log files, once they've been renamed (default is not to 
> compress).

It's a good idea - I've wanted to support that. Could you add detecting
if zlib isn't installed so it doesn't blow up?

Also you need to agree to give copyright to glyph or whatever the
current phrasing is (see doc/legal).

Here's a question for the list in general - wouldn't it better to do the
compression in a thread?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From z3p at twistedmatrix.com  Thu Oct 17 13:58:51 2002
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Thu, 17 Oct 2002 14:58:51 -0500
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021017153553.275ae8ed.twisted@itamarst.org>
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net> <20021017153553.275ae8ed.twisted@itamarst.org>
Message-ID: <20021017195851.GA29573@pyramid.twistedmatrix.com>

On Thu, Oct 17, 2002 at 03:35:53PM -0400, Itamar Shtull-Trauring wrote:
> Here's a question for the list in general - wouldn't it better to do the
> compression in a thread?

isn't compression fast enough that we can assume it doesn't block?
-p

-- 
       Paul Swartz
(o_    http://www.twistedmatrix.com/users/z3p.twistd/  _o)
//\    z3p at twistedmatrix.com                           /\\
V_/_   AIM: z3penguin                                 _\_V->

Democracy is the recurrent suspicion that more than half the people are right
more than half of the time.



From bruce at cubik.org  Thu Oct 17 14:09:58 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Thu, 17 Oct 2002 14:09:58 -0600
Subject: [Twisted-Python] Addition to twisted.python.logfile
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net> <20021017153553.275ae8ed.twisted@itamarst.org> <20021017195851.GA29573@pyramid.twistedmatrix.com>
Message-ID: <3DAF1916.50001@cubik.org>

Paul Swartz wrote:
> On Thu, Oct 17, 2002 at 03:35:53PM -0400, Itamar Shtull-Trauring wrote:
>>Here's a question for the list in general - wouldn't it better to do the
>>compression in a thread?
> 
> isn't compression fast enough that we can assume it doesn't block?

Not really.  For decent sized log files (well over a meg), it can take a 
noticeable time and with Twisted, that's too much time.  It shouldn't be 
an issue or that hard to do the compression in a thread anyway.

  - Bruce




From andy at reportlab.com  Thu Oct 17 14:39:33 2002
From: andy at reportlab.com (Andy Robinson)
Date: Thu, 17 Oct 2002 21:39:33 +0100
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021017195851.GA29573@pyramid.twistedmatrix.com>
Message-ID: <LKENLBBMDHMKBECHIAIAAENGCMAA.andy@reportlab.com>

> isn't compression fast enough that we can assume it doesn't block?

What's a good guideline duration for a CPU-heavy job before one 
should consider threading?  0.01 sec? 0.1 sec? 1 sec?

totally-new-to-parallel-stuff-ly yours,

Andy 




From jjn at kriln.com  Thu Oct 17 14:52:55 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Thu, 17 Oct 2002 20:52:55 +0000 (GMT)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <LKENLBBMDHMKBECHIAIAAENGCMAA.andy@reportlab.com>
Message-ID: <20021017205224.P21120-100000@nosferatu.kriln.com>

On Thu, 17 Oct 2002, Andy Robinson wrote:

> What's a good guideline duration for a CPU-heavy job before one
> should consider threading?  0.01 sec? 0.1 sec? 1 sec?

Thread when it becomes a problem.  Don't thread unless you have to, or
know something will be a problem from past experience.




From ericmangold at myrealbox.com  Thu Oct 17 17:32:11 2002
From: ericmangold at myrealbox.com (Eric Mangold)
Date: Thu, 17 Oct 2002 16:32:11 -0700
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <3DAEC330.4050207@pa.press.net>
References: <3DAEC330.4050207@pa.press.net>, <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <20021017163032.30766.qmail@green.zadka.com>
Message-ID: <3DAF487B.6030408@myrealbox.com>

Moshe Zadka wrote:

>Please submit patches as "unified diffs" (diff -u).
>
Would anyone care to add this on 
http://twistedmatrix.com/developers/contributing ?

-Eric




From barry at python.org  Thu Oct 17 15:56:13 2002
From: barry at python.org (Barry A. Warsaw)
Date: Thu, 17 Oct 2002 17:56:13 -0400
Subject: [Twisted-Python] nntp protocol supports moderated newsgroups?
Message-ID: <15791.12797.768063.913733@gargle.gargle.HOWL>

Quick question regarding Twisted's nntp server.  Please CC me, as I am
not on this mailing list.

I need to do some testing of moderated newsgroup support in Mailman.
Does Twisted's nntp server support moderated newsgroups?  If not, I'll
look into hacking it in, but I wanted to make sure I'm not duplicating
existing work.

Thanks,
-Barry



From exarkun at twistedmatrix.com  Thu Oct 17 16:06:11 2002
From: exarkun at twistedmatrix.com (Jp Calderone)
Date: Thu, 17 Oct 2002 18:06:11 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>
Message-ID: <3DAF3453.4030306@twistedmatrix.com>

Barry A. Warsaw wrote:

>Quick question regarding Twisted's nntp server.  Please CC me, as I am
>not on this mailing list.
>
>I need to do some testing of moderated newsgroup support in Mailman.
>Does Twisted's nntp server support moderated newsgroups?  If not, I'll
>look into hacking it in, but I wanted to make sure I'm not duplicating
>existing work.
>
>Thanks,
>-Barry
>
  There's a "flags" field for this, but no support beyond that.  Should 
be pretty
easy to stick in the appropriate checks/changes for it.  Would be glad 
to see it
added :)

  Jp





From barry at python.org  Thu Oct 17 16:13:48 2002
From: barry at python.org (Barry A. Warsaw)
Date: Thu, 17 Oct 2002 18:13:48 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>
	<3DAF3453.4030306@twistedmatrix.com>
Message-ID: <15791.13852.867292.398473@gargle.gargle.HOWL>

>>>>> "JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:

    JC>   There's a "flags" field for this, but no support beyond
    JC> that.  Should be pretty easy to stick in the appropriate
    JC> checks/changes for it.  Would be glad to see it added :)

Cool, I'll take a look.  Any hints on where to start (file names)
would appreciated! :)

-Barry



From exarkun at twistedmatrix.com  Thu Oct 17 16:27:30 2002
From: exarkun at twistedmatrix.com (Jp Calderone)
Date: Thu, 17 Oct 2002 18:27:30 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>	<3DAF3453.4030306@twistedmatrix.com> <15791.13852.867292.398473@gargle.gargle.HOWL>
Message-ID: <3DAF3952.4050707@twistedmatrix.com>

Barry A. Warsaw wrote:

>>>>>>"JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:
>>>>>>            
>>>>>>
>
>    JC>   There's a "flags" field for this, but no support beyond
>    JC> that.  Should be pretty easy to stick in the appropriate
>    JC> checks/changes for it.  Would be glad to see it added :)
>
>Cool, I'll take a look.  Any hints on where to start (file names)
>would appreciated! :)
>
>-Barry
>  
>
 Hmm,  twisted/news/database.py should have all the stuff it needs 
already -
maybe makeGroupSQL() will need to be modified a bit so that
twisted/tap/news.py can tell it which groups should be moderated and which
shouldn't.  twisted/tap/news.py will probably have most of the action; 
it'll need
code to let the user specify moderated/unmoderated to mktap somehow, maybe
with another --groups parameter, or with some indicator in the groups file.

Maybe it's time twisted.news got a *real* configuration interface :) 
 I'll ponder
that a little (maybe something fun with woven), and if you(/anyone else) 
have
any ideas on this, I'd love to hear them.

  Jp






From twisted at itamarst.org  Thu Oct 17 19:16:14 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 17 Oct 2002 21:16:14 -0400
Subject: [Twisted-Python] 1.0.0rc2 is out - please test installation
Message-ID: <20021017211615.19be28af.twisted@itamarst.org>

We'd like everyone to chime in and say "yes, this installed on my
platform" so we can be assured that's working - please send them to
moshez at twistedmatrix.com/

In terms of code 1.0 == 0.99.4, so if you're looking for new
functionality you may as well stick to CVS until we do 1.0.1.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From jepler at unpythonic.net  Thu Oct 17 20:19:52 2002
From: jepler at unpythonic.net (Jeff Epler)
Date: Thu, 17 Oct 2002 21:19:52 -0500
Subject: [Twisted-Python] stop twitching unittest window
Message-ID: <20021017211950.A5043@unpythonic.net>

--- unittestgui.py.orig	Thu Oct 17 21:12:41 2002
+++ unittestgui.py	Thu Oct 17 21:13:31 2002
@@ -217,7 +217,7 @@
         # Status bar
         statusFrame = tk.Frame(self.top, relief=tk.SUNKEN, borderwidth=2)
         statusFrame.pack(anchor=tk.SW, fill=tk.X, side=tk.BOTTOM)
-        tk.Label(statusFrame, textvariable=self.statusVar).pack(side=tk.LEFT)
+        tk.Label(statusFrame, textvariable=self.statusVar, width=80, anchor="w").pack(side=tk.LEFT)
 
 	# Area to enter name of test to run
         leftFrame = tk.Frame(self.top, borderwidth=3)



From john.abel at pa.press.net  Fri Oct 18 05:29:08 2002
From: john.abel at pa.press.net (John Abel)
Date: Fri, 18 Oct 2002 12:29:08 +0100
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net>
Message-ID: <3DAFF084.1030600@pa.press.net>

Hi,

Enclosed is an updated logfile.py, with zlib detection - If zlib isn't
imported, compression is turned off.  Please feel to free to
include/tidy up as appropriate.  I've tested the example rotatelog
script with the new logfile.py, on a 10MB file, and it takes around 6-8
seconds to compress, on my laptop (P3-700, 256MB, Mandrake9, Python
2.2.2).

Regards

John

--- /usr/local/lib/python2.2/site-packages/twisted/python/logfile.py
2002-10-18 10:22:17.000000000 +0100
+++
/usr/local/lib/python2.2/site-packages/twisted/python/logfileII.py
2002-10-18 11:57:40.000000000 +0100
@@ -20,7 +20,14 @@
  """

  # System Imports
-import os, stat, glob, string
+import os, stat, glob, string, fileinput, re
+
+try:
+    import gzip
+except ImportError:
+    zlibInstalled = 0
+else:
+    zlibInstalled = 1

  # sibling imports

@@ -34,13 +41,21 @@
      """

      synchronized = ["write", "rotate"]
-

-    def __init__(self, name, directory, rotateLength=1000000):
+
+    def __init__(self, name, directory, rotateLength=1000000,
compressLog=0):
          self.directory = directory
          self.name = name
          self.path = os.path.join(directory, name)
          self.rotateLength = rotateLength
+        if not (compressLog in [0,1] or zlibInstalled):
+            self.compressLog = 0
+        else:
+            self.compressLog = compressLog
+
+        self.globFilePattern = ["%s.*", "%s.*.gz"]
+        self.renameFilePattern = ["%s.%d","%s.%d.gz"]
+        self.rePattern = [".*\.(\d)$",".*\.(\d)\.gz$"]
          self._openFile()

      def _openFile(self):
@@ -87,11 +102,13 @@
      def listLogs(self):
          """Return sorted list of integers - the old logs' identifiers."""
          result = []
-        for name in glob.glob("%s.*" % self.path):
+        for name in glob.glob(self.globFilePattern[self.compressLog] %
self.path):
              try:
-                counter = int(string.split(name, '.')[-1])
-                if counter:
-                    result.append(counter)
+                reCounter = re.match(self.rePattern[self.compressLog],name)
+                if reCounter:
+                    counter = int( reCounter.group(1) )
+                    if counter:
+                        result.append(counter)
              except ValueError:
                  pass
          result.sort()
@@ -108,9 +125,14 @@
          logs = self.listLogs()
          logs.reverse()
          for i in logs:
-            os.rename("%s.%d" % (self.path, i), "%s.%d" % (self.path, i
+ 1))
+            os.rename(self.renameFilePattern[self.compressLog] %
(self.path, i), self.renameFilePattern[self.compressLog] % (self.path, i
+ 1))
          self._file.close()
          os.rename(self.path, "%s.1" % self.path)
+        if self.compressLog:
+            gZippedFile = gzip.GzipFile("%s.1.gz" % self.path,'wb')
+            for LogLine in fileinput.input("%s.1" % self.path):
+                gZippedFile.write(LogLine)
+            gZippedFile.close()
          self._openFile()

      def getCurrentLog(self):
@@ -143,8 +165,6 @@
              line = self._file.readline()
              if not line:
                  break
-            result.append(line)
-        return result
-
      def close(self):
          self._file.close()
+





From twisted at moshez.org  Fri Oct 18 05:52:36 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 18 Oct 2002 11:52:36 -0000
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
In-Reply-To: <3DAFF084.1030600@pa.press.net>
References: <3DAFF084.1030600@pa.press.net>, <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net>
Message-ID: <20021018115236.11347.qmail@green.zadka.com>

On Fri, 18 Oct 2002, John Abel <john.abel at pa.press.net> wrote:
 
> Enclosed is an updated logfile.py, with zlib detection - If zlib isn't
> imported, compression is turned off.  Please feel to free to
> include/tidy up as appropriate.  I've tested the example rotatelog
> script with the new logfile.py, on a 10MB file, and it takes around 6-8
> seconds to compress, on my laptop (P3-700, 256MB, Mandrake9, Python
> 2.2.2).

A few comments

1. Please get your mailer to not word-wrap in patches.
2. In general, you should submit patches from inside the CVS working
   copy, not from the installed version
3. As I read your patch, this means that a Twisted server would be
   unresponsive for 6 seconds while it is compressing. This is, in general,
   unacceptable.
4. Perhaps it would be better to use the "gzip" program, via the process
   API. A simple way to hook into logfile.py so we could add a hook to
   utils.getProcessValue("/usr/bin/gzip", args=[old_name]) would seem simpler
   and possibly even more efficient.
5. Perhaps the correct thing to do is make Logfile subclassable enough so
   a compressing Logfile could be written as a subclass. 



From twisted at itamarst.org  Fri Oct 18 08:53:59 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 18 Oct 2002 10:53:59 -0400
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
In-Reply-To: <20021018115236.11347.qmail@green.zadka.com>
References: <3DAFF084.1030600@pa.press.net>
	<20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com>
	<3DAEC330.4050207@pa.press.net>
	<20021018115236.11347.qmail@green.zadka.com>
Message-ID: <20021018105359.5024e46f.twisted@itamarst.org>

On 18 Oct 2002 11:52:36 -0000
Moshe Zadka <twisted at moshez.org> wrote:

> 2. In general, you should submit patches from inside the CVS working
>    copy, not from the installed version

Yeah - but in this case it's fine.

> 3. As I read your patch, this means that a Twisted server would be
>    unresponsive for 6 seconds while it is compressing. This is, in
>    general, unacceptable.

Yes, we're going to have to use a thread for this - would you care to do
it John? If not I'll hang on to your patch and use it as a basis when I
get around to it.

> 4. Perhaps it would be better to use the "gzip" program, via the
> process
>    API. A simple way to hook into logfile.py so we could add a hook to
>    utils.getProcessValue("/usr/bin/gzip", args=[old_name]) would seem
>    simpler and possibly even more efficient.

And wouldn't work on Windows... The question is if we care about
compresssing logs on Windows. I think we should.

> 5. Perhaps the correct thing to do is make Logfile subclassable enough
> so
>    a compressing Logfile could be written as a subclass. 

I was thinking this at first, but in practice I don't see if there's
much point. What would it give us?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From iumarumo at eidosnet.co.uk  Fri Oct 18 09:59:31 2002
From: iumarumo at eidosnet.co.uk (Ibraheem Umaru-Mohammed)
Date: Fri, 18 Oct 2002 16:59:31 +0100
Subject: [Twisted-Python] Failed to run "im" out of the box...
Message-ID: <20021018155931.GA23928@micromuse.com>

Hi,

So, I downloaded Twisted 1.0.0rc2 - Release Candidate for UNIX.
Unpacked it, ran "python setup.py install".
Ran the "admin/runtests" tool, and 2 tests failed:

,---- [ admin/runtests ]
| Failure: testaNoPermission(twisted.test.test_logfile.LogFileTestCase)
| Failure: testFileRebuild(twisted.test.test_rebuild.RebuildTestCase)
`----

Assuming that 2/300 test failures were /still/ ok, I proceeded 
to attempt to run "im". This failed with the following, I have
also included a report of the packages installed and their current
versions:

		[--- begin report ---]
ibz at ignoramus:$ im
Traceback (most recent call last):
  File "/usr/bin/im", line 30, in ?
    im.run()
  File "./twisted/scripts/im.py", line 27, in run
    from twisted.im.gtkaccount import AccountManager
  File "./twisted/im/gtkaccount.py", line 21, in ?
    from twisted.im.gtkcommon import GLADE_FILE, SETTINGS_FILE, autoConnectMethods,\
  File "./twisted/im/gtkcommon.py", line 21, in ?
    from twisted.manhole.ui.pywidgets import isCursorOnFirstLine, isCursorOnLastLine
  File "./twisted/manhole/ui/pywidgets.py", line 9, in ?
    from twisted.spread.ui import gtkutil
  File "./twisted/spread/ui/gtkutil.py", line 62, in ?
    class GetString(gtk.GtkWindow):
AttributeError: 'module' object has no attribute 'GtkWindow'
ibz at ignoramus:$

ibz at ignoramus:$ rpm -qa | grep python
gnome-python2-canvas-1.99.11-8
rpm-python-4.1-1.06
pythonlib-1.23-1
libxml2-python-2.4.23-1
python-popt-0.8.8-7.x.2
python-2.2.1-17
orbit-python-1.99.0-4
python-optik-1.3-2
gnome-python2-gtkhtml2-1.99.11-8
gnome-python2-1.99.11-8
python-devel-2.2.1-17
pythonworks-test-1.2-20010328
rpm404-python-4.0.4-8x.27
python-xmlrpc-1.5.1-7.x.3
gnome-python2-bonobo-1.99.11-8
ibz at ignoramus:$

ibz at ignoramus:$ rpm -qa | grep gtk
gtkmm-devel-1.2.9-1.ximian.1
gtk2-2.0.6-8
rep-gtk-0.16.0.90-4
gtkglarea-1.2.2-13
libgtkhtml20-1.0.4-2.ximian.1
libgtkhtml19-0.16.1-ximian.1
gtk-themes-1.0.1-1.ximian.3
libgtkhtml16-0.13.0-ximian.1
libgtkhtml17-0.14.0-ximian.2
pygtk2-1.99.12-7
gtkmm-1.2.9-1.ximian.1
gtk-engines-0.12-ximian.10
libgtkhtml1.1-1-1.1.2-0.ximian.1
gnome-python2-gtkhtml2-1.99.11-8
usermode-gtk-1.63-1
gtk+10-1.0.6-10
gtk+-1.2.10-22
pygtk-0.6.9-3.ximian.6
pygtk-libglade-0.6.9-3.ximian.6
libgtkhtml18-0.15.0-ximian.2
gtkhtml2-2.0.1-2
gtkhtml-1.0.4-3
libgtkhtml15-0.12.0-ximian.6
pygtk2-libglade-1.99.12-7
gtk+-devel-1.2.10-22
gtkhtml-devel-1.0.4-3
ibz at ignoramus:$

ibz at ignoramus:$ python -V
Python 2.2.1
ibz at ignoramus:$
		[--- end report ---]

Platform Linux, Redhat 8.0.

Erm, can't think of anything else that might be of interest right now...
Let me know if you need any more information.

Kindest regards,

				--ibz.



From twisted at itamarst.org  Fri Oct 18 10:07:22 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 18 Oct 2002 12:07:22 -0400
Subject: [Twisted-Python] Failed to run "im" out of the box...
In-Reply-To: <20021018155931.GA23928@micromuse.com>
References: <20021018155931.GA23928@micromuse.com>
Message-ID: <20021018120722.08fb4042.twisted@itamarst.org>

On Fri, 18 Oct 2002 16:59:31 +0100
Ibraheem Umaru-Mohammed <iumarumo at eidosnet.co.uk> wrote:

> So, I downloaded Twisted 1.0.0rc2 - Release Candidate for UNIX.
> Unpacked it, ran "python setup.py install".
> Ran the "admin/runtests" tool, and 2 tests failed:
> 
> ,---- [ admin/runtests ]
> | Failure:
> | testaNoPermission(twisted.test.test_logfile.LogFileTestCase)
> | Failure: testFileRebuild(twisted.test.test_rebuild.RebuildTestCase)
> `----

I need to investigate the first, I've seen it happen sometimes too - I
suspect it's not serious (i.e. there's a good chance it always fails if
you run as root). As for the 2nd, upgrade to 2.2.2 and it'll go away.

The im issue is because, if I'm not mistake, the pygtk2 author gave it
the same name as original pygtk, even though it's different API.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From andy at reportlab.com  Fri Oct 18 10:24:56 2002
From: andy at reportlab.com (Andy Robinson)
Date: Fri, 18 Oct 2002 17:24:56 +0100
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
In-Reply-To: <20021018105359.5024e46f.twisted@itamarst.org>
Message-ID: <PGECLPOBGNBNKHNAGIJHAEMFDOAA.andy@reportlab.com>

> And wouldn't work on Windows... The question is if we care about
> compresssing logs on Windows. I think we should.

On windows you cannot even assume a command line zip program.
You'd have to shell a script of your own:-)
The good news is that zlib is available by default in the
Windows distribution; everybody will have it.

- Andy

p.s. apologies for not getting back onto distutils this
week - hope to test it tonight.





From iumarumo at eidosnet.co.uk  Fri Oct 18 10:57:34 2002
From: iumarumo at eidosnet.co.uk (Ibraheem Umaru-Mohammed)
Date: Fri, 18 Oct 2002 17:57:34 +0100
Subject: [Twisted-Python] Failed to run "im" out of the box...
In-Reply-To: <20021018120722.08fb4042.twisted@itamarst.org>
References: <20021018155931.GA23928@micromuse.com> <20021018120722.08fb4042.twisted@itamarst.org>
Message-ID: <20021018165734.GA24433@micromuse.com>

* Itamar Shtull-Trauring <twisted at itamarst.org> [2002-10-18 17:18]:

> On Fri, 18 Oct 2002 16:59:31 +0100
> Ibraheem Umaru-Mohammed <iumarumo at eidosnet.co.uk> wrote:
> 
> > So, I downloaded Twisted 1.0.0rc2 - Release Candidate for UNIX.
> > Unpacked it, ran "python setup.py install".
> > Ran the "admin/runtests" tool, and 2 tests failed:
> > 
> > ,---- [ admin/runtests ]
> > | Failure:
> > | testaNoPermission(twisted.test.test_logfile.LogFileTestCase)
> > | Failure: testFileRebuild(twisted.test.test_rebuild.RebuildTestCase)
> > `----
> 
> I need to investigate the first, I've seen it happen sometimes too - I
> suspect it's not serious (i.e. there's a good chance it always fails if
> you run as root). As for the 2nd, upgrade to 2.2.2 and it'll go away.
> 

Itamar, 

Thanks for responding. 

Upgrading to 2.2.2 and running the tests as non-root user gets rid of 
both failures for me.

> The im issue is because, if I'm not mistake, the pygtk2 author gave it
> the same name as original pygtk, even though it's different API.
> 

Hmmmn. Nevermind then.

			--ibz.
-- 



From screwtape at froup.com  Sat Oct 19 01:08:34 2002
From: screwtape at froup.com (Tim Allen)
Date: Sat, 19 Oct 2002 17:08:34 +1000
Subject: [Twisted-Python] 1.0.0rc2 is out - please test installation
In-Reply-To: <20021017211615.19be28af.twisted@itamarst.org>
Message-ID: <94EB033C-E331-11D6-BEB5-003065D61A3E@froup.com>

On Friday, October 18, 2002, at 11:16 AM, Itamar Shtull-Trauring wrote:

> We'd like everyone to chime in and say "yes, this installed on my
> platform" so we can be assured that's working - please send them to
> moshez at twistedmatrix.com/

1.0.0.rc3 installs fine here on Mac OS X 10.1.5, but CVS Twisted fails 
miserably (it can't find sys/poll.h)




From twisted at moshez.org  Sat Oct 19 04:57:25 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 19 Oct 2002 10:57:25 -0000
Subject: [Twisted-Python] Book, Documentation and Other Horrors
Message-ID: <20021019105725.25599.qmail@green.zadka.com>

Well, in my obviously biased opinion the book is somewhat decent.
It's actually quite close to being a good guide to Twisted.
Here are the sections we are missing:

     * Web Applications
          + Authentication on the web (AKA using t.w.guard)
     * Interactive Applications
          + Connecting an instance direct to the 'net: simple examples
            with PB
          + Interchanging State: Jumping Into Jelly
          + Interfacing PB with a client-side toolkit (tkutils, gtkutils)
     * Extending Twisted
          + Writing a new reactor
          + Wrapping a new kind of select()able resource
          + Wrapping a new kind of crypto algorithm



From andrew-twisted at puzzling.org  Sat Oct 19 06:02:07 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 19 Oct 2002 22:02:07 +1000
Subject: [Twisted-Python] doc/howto/telnet.html obsolete?
Message-ID: <20021019120207.GB463@frobozz.local>

At a glance, it seems to me that doc/howto/manhole.html covers everything
interesting from doc/howto/telnet.html, and is more up-to-date with
idiomatic Twisted usage?  Should we retire telnet.html?

-Andrew.




From screwtape at froup.com  Sat Oct 19 07:09:11 2002
From: screwtape at froup.com (Tim Allen)
Date: Sat, 19 Oct 2002 23:09:11 +1000
Subject: [Twisted-Python] Twisted IM fixes
Message-ID: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>

Well, last week I submitted a patch to add some features to Twisted's 
IRC protocol, and I mentioned on #twisted that I wanted to write a bot 
framework for IRC. Glyph asked (nicely) that if I was going to write a 
bot framework, could I please write it for twisted.im, rather than 
writing it for IRC directly.

I'm not yet committed to writing a bot framework for anything, but I 
*have* been poking around in twisted.im. Firstly, I found two little 
buglets in the im code (patch attached). Secondly, it took me quite a 
while to figure out the exact minimum I needed to implement to use the 
twisted.im bits - all the example code uses GUI interfaces which 
complicate things more than necessary.

I was wondering - would there be any interest in me polishing up my 
minimalist twisted.im client so it could be added to twisted.im or 
doc/examples or such?

-------------- next part --------------
A non-text attachment was scrubbed...
Name: twisted-irc.diff
Type: application/octet-stream
Size: 1308 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021019/06689f1e/attachment-0002.obj>

From john.abel at pa.press.net  Sat Oct 19 08:22:51 2002
From: john.abel at pa.press.net (John Abel)
Date: Sat, 19 Oct 2002 15:22:51 +0100
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
Message-ID: <3DB16ABB.5000203@pa.press.net>

If it's OK, I will have a go on making it use a thread?  I have also 
made some fixes to it.  I will sumbit these all in one update.

Regards

John




From screwtape at froup.com  Sat Oct 19 08:28:30 2002
From: screwtape at froup.com (Tim Allen)
Date: Sun, 20 Oct 2002 00:28:30 +1000
Subject: [Twisted-Python] Twisted IM fixes
In-Reply-To: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>
Message-ID: <0A69B82D-E36F-11D6-849A-003065D61A3E@froup.com>

On Saturday, October 19, 2002, at 11:09 PM, Tim Allen wrote:
> I'm not yet committed to writing a bot framework for anything, but I 
> *have* been poking around in twisted.im. Firstly, I found two little 
> buglets in the im code (patch attached).

Oops - yes, I hereby give copyright to Glyph (Matthew W. Lefkowitz).




From paul at paulbaranowski.org  Sat Oct 19 10:30:11 2002
From: paul at paulbaranowski.org (Paul Baranowski)
Date: Sat, 19 Oct 2002 12:30:11 -0400
Subject: [Twisted-Python] Installing 0.99.4 on Windows
In-Reply-To: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
Message-ID: <000b01c2778c$d58eaf60$2501a8c0@blackstar>

I ran into some snags installing version 0.99.4 on windows by following
the installation instructions given online.

Here's what I had to do.  Perhaps the instructions given below can be
used to modify the installation section on the web page.

- Run the Windows installer.

- Make sure python.exe is in your path, if not, add it (for me, it was 
"C:\Program Files\Python2.2.1")

- Add "<Path_to_Python_Directory>\Scripts" to your path.  (For me, it
was "C:\Program Files\Python2.2.1\Scripts".

- Modify the Scripts\mktap.bat file (and all the twisted .bat files) so
that it reads:
@echo off
if NOT "%_4ver%" == "" PYTHON.EXE -c "from twisted.scripts.mktap import
run; run()" %$
if     "%_4ver%" == "" PYTHON.EXE -c "from twisted.scripts.mktap import
run; run()" %*

(What I changed: I basically took out the "C:\Program
Files\Python2.2\Python.exe" and replaced it with "Python.exe" - since
python is in our path at this point, we don't need an absolute path to
it, and the absolute path will only cause problems with people who have
different directory names - for example, I have python2.2.1.)

Here's the full list of files that need to be changed:
coil.bat
im.bat
manhole.bat
mktap.bat
tap2deb.bat
tapconvert.bat
twistd.bat

- Note for cygwin users: you must add ".bat" to the command names given
in the documentation.  For example, if it tells you to run mktap, type
mktap.bat instead.


Paul Baranowski






From paul at paulbaranowski.org  Sat Oct 19 10:37:20 2002
From: paul at paulbaranowski.org (Paul Baranowski)
Date: Sat, 19 Oct 2002 12:37:20 -0400
Subject: [Twisted-Python] Archive of Mailing List?
In-Reply-To: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
Message-ID: <000c01c2778d$cf11cea0$2501a8c0@blackstar>

Is there a (searchable) archive of the mailing list on the mailman
server somewhere?  If not, perhaps one should be started.  It is, after
all, literally just a click of a button in mailman.

Paul Baranowski






From twisted at moshez.org  Sat Oct 19 10:38:10 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 19 Oct 2002 16:38:10 -0000
Subject: [Twisted-Python] Installing 0.99.4 on Windows
In-Reply-To: <000b01c2778c$d58eaf60$2501a8c0@blackstar>
References: <000b01c2778c$d58eaf60$2501a8c0@blackstar>
Message-ID: <20021019163810.28748.qmail@green.zadka.com>

On Sat, 19 Oct 2002, "Paul Baranowski" <paul at paulbaranowski.org> wrote:

> I ran into some snags installing version 0.99.4 on windows by following
> the installation instructions given online.

Did you try 1.0.0rc3?




From paul at paulbaranowski.org  Sat Oct 19 10:42:25 2002
From: paul at paulbaranowski.org (Paul Baranowski)
Date: Sat, 19 Oct 2002 12:42:25 -0400
Subject: [Twisted-Python] QOTD Plugin Example
In-Reply-To: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
Message-ID: <000d01c2778e$8536fcf0$2501a8c0@blackstar>

I have been trying to go through the sample QOTD plugin documentation,
and when I get to the point where it says:

**********************************
Now the QOTD server is ready to be instantiated! Let's start up a server
and get a quote from it.

% mktap qotd       
Saving qotd application to qotd.tap...
Saved.
% twistd -f qotd.tap 
% nc localhost 8007
An apple a day keeps the doctor away.
% kill `cat twistd.pid`
***********************************

I run "mktap qotd" in my TwistedQuotes directory and I get this:

Unknown command: qotd
Usage:    mktap [options] <command> [command options]
...

What am I missing?

Paul Baranowski






From twisted at moshez.org  Sat Oct 19 10:54:58 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 19 Oct 2002 16:54:58 -0000
Subject: [Twisted-Python] QOTD Plugin Example
In-Reply-To: <000d01c2778e$8536fcf0$2501a8c0@blackstar>
References: <000d01c2778e$8536fcf0$2501a8c0@blackstar>
Message-ID: <20021019165458.28831.qmail@green.zadka.com>

On Sat, 19 Oct 2002, "Paul Baranowski" <paul at paulbaranowski.org> wrote:

> I run "mktap qotd" in my TwistedQuotes directory and I get this:

Did you add the directory containing the TwistedQuotes directory
to your PYTHONPATH?

'''
make sure that your TwistedQuotes directory is a package on your python path.
'''

Please try to read the HOWTO carefully.



From dp at twistedmatrix.com  Sat Oct 19 11:10:09 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Sat, 19 Oct 2002 10:10:09 -0700
Subject: [Twisted-Python] Twisted IM fixes
In-Reply-To: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>
Message-ID: <9F74B322-E385-11D6-B285-00039376B1AE@twistedmatrix.com>

On Saturday, October 19, 2002, at 06:09 AM, Tim Allen wrote:
>
> I was wondering - would there be any interest in me polishing up my 
> minimalist twisted.im client so it could be added to twisted.im or 
> doc/examples or such?
>

Yes, I'd love to see a command-line t-im client.

Donovan




From twisted at itamarst.org  Sat Oct 19 13:08:00 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 19 Oct 2002 15:08:00 -0400
Subject: [Twisted-Python] Re: Addition to twisted.python.logfile
In-Reply-To: <3DB16ABB.5000203@pa.press.net>
References: <3DB16ABB.5000203@pa.press.net>
Message-ID: <20021019150800.3c562dee.twisted@itamarst.org>

On Sat, 19 Oct 2002 15:22:51 +0100
John Abel <john.abel at pa.press.net> wrote:

> If it's OK, I will have a go on making it use a thread?  I have also 
> made some fixes to it.  I will sumbit these all in one update.

That'd be wonderful - thanks!

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From exarkun at twistedmatrix.com  Sat Oct 19 13:28:29 2002
From: exarkun at twistedmatrix.com (Jp Calderone)
Date: Sat, 19 Oct 2002 15:28:29 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>	<3DAF3453.4030306@twistedmatrix.com>	<15791.13852.867292.398473@gargle.gargle.HOWL>	<3DAF3952.4050707@twistedmatrix.com> <15793.34455.512573.39157@gargle.gargle.HOWL>
Message-ID: <3DB1B25D.30409@twistedmatrix.com>

Barry A. Warsaw wrote:

>>>>>>"JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:
>>>>>>            
>>>>>>
>
>    JC>  Hmm, twisted/news/database.py should have all the stuff it
>    JC> needs already - maybe makeGroupSQL() will need to be modified
>    JC> a bit so that twisted/tap/news.py can tell it which groups
>    JC> should be moderated and which shouldn't.  twisted/tap/news.py
>    JC> will probably have most of the action; it'll need code to let
>    JC> the user specify moderated/unmoderated to mktap somehow, maybe
>    JC> with another --groups parameter, or with some indicator in the
>    JC> groups file.
>
>    JC> Maybe it's time twisted.news got a *real* configuration
>    JC> interface :) I'll ponder that a little (maybe something fun
>    JC> with woven), and if you(/anyone else) have any ideas on this,
>    JC> I'd love to hear them.
>
>I don't really, since I'm fairly green in my Twisted use.  I will note
>that the news stuff seems a little more difficult to use than when I
>last looked at it (Twisted 0.19 I think).  I'm using Twisted from cvs
>now, so it's possible this stuff is just in flux.
>  
>
  I wish I could say that is the case -- I've just been motivated to 
work on other
projects lately.  I agree that it has gotten more complex, and I don't 
like it.  I've
recently been pointed at twisted.persisted.dirdbm, and my current 
thinking is
that PickleStorage and NewsStorageAugmentation should go away in favor of
a DirDBMStorage.  PickleStorage was never meant as anything more than a
toy, and the SQL stuff doesn't seem to have yielded any performance 
benefits,
probably due to the complexity of some of the common queries it is 
performing.

>Specifically:
>
>- What is the --servers switch for?  I couldn't actually find where
>  that was used in tap/news.py but it seemed required, so I fed it
>  nonsense. 
>
The file given to --servers should contain a list of news servers to which
to connect and share messages with.  This hasn't yet been tested 
thoroughly --
I have surprising difficulty finding a news server that implemented 
enough of
the protocol to let this work.  I guess the "user facing" servers are kept
intentionally non-functional for some reason.

>
>- I understand why "mktap news" requires an extra argument now, but it
>  would be nice if either the pickle or sql command were defaulted.  I
>  don't think I needed to specify "mktap news pickle" last time.  Hmm,
>  maybe if --file is given you can default to pickle?
>
Yea, this is new too, since pickle was the only legal command in the 
past.  If I
go with the dirdbm stuff, I'll probably make it the default and let 
pickle or sql
be specified if someone wants something different (Or pickle and sql might
quietly disappear - the prospect of maintaining 3 different backends - 2 of
which are likely useless to nearly everybody - is a little unpleasant).

>
>- I noticed some bugs in the code, a few of which I fixed, but some I
>  didn't.  I ran the server w/ twistd -n and watched the output.  I
>  got mysterious log messages such as:
>
>[...]
>19/10/2002 11:54 [*news*] Starting factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
>19/10/2002 11:54 [*news*] Connection failed: [Failure instance: Traceback! exceptions.IOError, address not found
>19/10/2002 11:54 [*news*] ]
>19/10/2002 11:54 [*news*] Connection failed: [Failure instance: Traceback! exceptions.IOError, address not found
>19/10/2002 11:54 [*news*] ]
>19/10/2002 11:54 [*news*] Stopping factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
>19/10/2002 11:55 [*news*] Starting factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
>[...]
>
>  While these repeated as long as the server was running, they didn't
>  seem to affect its operation.
>  
>
I'm guessing these are due to whatever you put in your server list file.

>- In news/news.py, buildProtocol() is trying to pass self.remoteHosts
>  to the self.protocol() call, but self.protocol() -- which is really
>  the nntp.NNTPServer class, doesn't take two arguments.
>
Thanks for the fix.

>In any event, I hacked in moderated group support by adding a
>-m/--moderators flag, which takes a file containing a list of
>newsgroup/moderator address pairs.  When a message is POSTed to a
>group, the list of target newsgroups is checked against the
>moderators.  If there is any match, and the article has no Approved
>header, the article is not posted, but instead emailed to the
>moderators address.  The value of the Approved header is completely
>ignored -- it just has to be there.  I believe this is pretty close to
>how Usenet s/w handles moderators.
>  
>
Hmm.  How does a moderator then approve the message?  The interface
I had envisioned was something closer to mailman's scheme, though this
is certainly easier on the server side :)

>A couple of kludges that should be cleaned up:
>
>- What to do if the list of target newsgroups has more than one
>  moderated newsgroup in it?  Off hand, I'm not sure what Usenet does
>  in this case.
>
I believe the correct behavior would be to post the message to all 
un-moderated
groups and hold the message for approval from the moderators of each 
moderated
group, posting it to each held group when the appropriate moderator 
approves it.
One issue I see with this, though, is if someone is a moderator for 
multiple groups
that a single message is sent to.  I'm not sure if/how you could/would 
approve the
message for one group but reject it for another.  Maybe once I 
understand how the
email approval system works this will become clear.

>
>- We really need a few more config options, including the smtp host
>  and port to use to send out the moderator's email, and the envelope
>  sender address to use in that email.  Both are hard coded in my
>  hack.
>
Indeed.

>
>- Any un-Twisted coding offenses. :)
>  
>
The only one I see is the use of smtplib.  Its sendmail method will very 
likely
block, possibly for a long time, hanging the entire server.  Aside from 
just being
nasty, this opens up the possibility for DoS on servers, simply by 
repeatedly mailing
a moderated group.  I'm going out of town for a week this coming 
tuesday, and I
doubt I'll have time to figure out how twisted.protocols.smtp.SMTPClient 
works
before then, so I'm going to hold off on committing this.  If you want 
to figure that
out and send another patch, that'd be great, otherwise I'll just take 
care of it when
I get back.

>So, in the grand tradition of scratching my own itch, but just enough
>so I can sleep, here's the patch.
>
>Oh, BTW, for someone who was completely green to the code base,
>Twisted is very nicely written.  It wasn't difficult at all to drill
>down to where I needed to make the changes.  JP's hints helped a lot
>too.  Yay!
>  
>
  Glad to hear it :)  Thanks for the patch.

  Jp





From glyph at twistedmatrix.com  Sat Oct 19 13:45:59 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 19 Oct 2002 14:45:59 -0500 (CDT)
Subject: [Twisted-Python] Twisted IM fixes
In-Reply-To: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>
References: <F5A3B14D-E363-11D6-849A-003065D61A3E@froup.com>
Message-ID: <20021019.144559.89042554.glyph@twistedmatrix.com>

On Sat, 19 Oct 2002 23:09:11 +1000, Tim Allen <screwtape at froup.com> wrote:
> I was wondering - would there be any interest in me polishing up my 
> minimalist twisted.im client so it could be added to twisted.im or 
> doc/examples or such?

Is this a minimalist bot-style client or a minimalist text-mode client?  In any
case, yes!  Either would be highly useful :) (and thanks for sending the patch
as an attachment ^_^)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021019/1490c06b/attachment.sig>

From ritterjoshua at msn.com  Fri Oct 18 07:10:10 2002
From: ritterjoshua at msn.com (Joshua Ritter)
Date: Fri, 18 Oct 2002 08:10:10 -0500
Subject: [Twisted-Python] Twisted and the Torque Game Engine
Message-ID: <000801c276a7$b0c9b3e0$0200000a@spunk>

Hooray!  Torque and Twisted taste great together!

Torque is the Tribes2 game engine available for license at www.garagegames.com 

It runs on Win32, Mac, and Linux and is quite robust... in fact, I have written a Python binding for it... and used this binding to hook up Twisted... 

Here is my post on their forum:

-------------------------------

I have used TGEPython (with small improvements) to hook up Twisted and Torque...  

Twisted is Python internet/distributed computing framework... it has support for many internet protocols and includes a very cool distributed object/RPC system... it also has an authorization (security) model and DB-API 2.0 database support... 

I am currently using Twisted for a Torque distributed content system (assets and database)... it will also be used in my server hierarchy: Master, World, Zone

I wrote a TorqueReactor for Twisted(quite trivial), the only time killer was running into a FPU precision problem... 

Enough of my yacking, check them out: www.twistedmatrix.com

-J

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20021018/53d5a748/attachment.html>

From barry at python.org  Sat Oct 19 10:21:43 2002
From: barry at python.org (Barry A. Warsaw)
Date: Sat, 19 Oct 2002 12:21:43 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>
	<3DAF3453.4030306@twistedmatrix.com>
	<15791.13852.867292.398473@gargle.gargle.HOWL>
	<3DAF3952.4050707@twistedmatrix.com>
Message-ID: <15793.34455.512573.39157@gargle.gargle.HOWL>


>>>>> "JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:

    JC>  Hmm, twisted/news/database.py should have all the stuff it
    JC> needs already - maybe makeGroupSQL() will need to be modified
    JC> a bit so that twisted/tap/news.py can tell it which groups
    JC> should be moderated and which shouldn't.  twisted/tap/news.py
    JC> will probably have most of the action; it'll need code to let
    JC> the user specify moderated/unmoderated to mktap somehow, maybe
    JC> with another --groups parameter, or with some indicator in the
    JC> groups file.

    JC> Maybe it's time twisted.news got a *real* configuration
    JC> interface :) I'll ponder that a little (maybe something fun
    JC> with woven), and if you(/anyone else) have any ideas on this,
    JC> I'd love to hear them.

I don't really, since I'm fairly green in my Twisted use.  I will note
that the news stuff seems a little more difficult to use than when I
last looked at it (Twisted 0.19 I think).  I'm using Twisted from cvs
now, so it's possible this stuff is just in flux.

Specifically:

- What is the --servers switch for?  I couldn't actually find where
  that was used in tap/news.py but it seemed required, so I fed it
  nonsense. 

- I understand why "mktap news" requires an extra argument now, but it
  would be nice if either the pickle or sql command were defaulted.  I
  don't think I needed to specify "mktap news pickle" last time.  Hmm,
  maybe if --file is given you can default to pickle?

- I noticed some bugs in the code, a few of which I fixed, but some I
  didn't.  I ran the server w/ twistd -n and watched the output.  I
  got mysterious log messages such as:

[...]
19/10/2002 11:54 [*news*] Starting factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
19/10/2002 11:54 [*news*] Connection failed: [Failure instance: Traceback! exceptions.IOError, address not found
19/10/2002 11:54 [*news*] ]
19/10/2002 11:54 [*news*] Connection failed: [Failure instance: Traceback! exceptions.IOError, address not found
19/10/2002 11:54 [*news*] ]
19/10/2002 11:54 [*news*] Stopping factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
19/10/2002 11:55 [*news*] Starting factory <twisted.news.news.UsenetClientFactory instance at 0x82a52d4>
[...]

  While these repeated as long as the server was running, they didn't
  seem to affect its operation.

- In news/news.py, buildProtocol() is trying to pass self.remoteHosts
  to the self.protocol() call, but self.protocol() -- which is really
  the nntp.NNTPServer class, doesn't take two arguments.

In any event, I hacked in moderated group support by adding a
-m/--moderators flag, which takes a file containing a list of
newsgroup/moderator address pairs.  When a message is POSTed to a
group, the list of target newsgroups is checked against the
moderators.  If there is any match, and the article has no Approved
header, the article is not posted, but instead emailed to the
moderators address.  The value of the Approved header is completely
ignored -- it just has to be there.  I believe this is pretty close to
how Usenet s/w handles moderators.

A couple of kludges that should be cleaned up:

- What to do if the list of target newsgroups has more than one
  moderated newsgroup in it?  Off hand, I'm not sure what Usenet does
  in this case.

- We really need a few more config options, including the smtp host
  and port to use to send out the moderator's email, and the envelope
  sender address to use in that email.  Both are hard coded in my
  hack.

- Any un-Twisted coding offenses. :)

So, in the grand tradition of scratching my own itch, but just enough
so I can sleep, here's the patch.

Oh, BTW, for someone who was completely green to the code base,
Twisted is very nicely written.  It wasn't difficult at all to drill
down to where I needed to make the changes.  JP's hints helped a lot
too.  Yay!

Enjoy,
-Barry

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: twisted.txt
URL: </pipermail/twisted-python/attachments/20021019/97b86b2c/attachment-0002.txt>

From glyph at twistedmatrix.com  Sat Oct 19 13:50:20 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 19 Oct 2002 14:50:20 -0500 (CDT)
Subject: [Twisted-Python] Archive of Mailing List?
In-Reply-To: <000c01c2778d$cf11cea0$2501a8c0@blackstar>
References: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
	<000c01c2778d$cf11cea0$2501a8c0@blackstar>
Message-ID: <20021019.145020.123673598.glyph@twistedmatrix.com>


On Sat, 19 Oct 2002 12:37:20 -0400, "Paul Baranowski" <paul at paulbaranowski.org> wrote:
> Is there a (searchable) archive of the mailing list on the mailman
> server somewhere?  If not, perhaps one should be started.  It is, after
> all, literally just a click of a button in mailman.

There is an archive (twistedmatrix.com/pipermail) but it's not searchable.  Is
that really an option in mailman someplace?  I don't see it.  Google might be
able to help you, though :-)


-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021019/2cb773fe/attachment.sig>

From glyph at twistedmatrix.com  Sat Oct 19 13:52:34 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 19 Oct 2002 14:52:34 -0500 (CDT)
Subject: [Twisted-Python] QOTD Plugin Example
In-Reply-To: <000d01c2778e$8536fcf0$2501a8c0@blackstar>
References: <20021019113244.24825.67873.Mailman@pyramid.twistedmatrix.com>
	<000d01c2778e$8536fcf0$2501a8c0@blackstar>
Message-ID: <20021019.145234.132758596.glyph@twistedmatrix.com>

On Sat, 19 Oct 2002 12:42:25 -0400, "Paul Baranowski" <paul at paulbaranowski.org> wrote:
> What am I missing?

Sorry, the wording of that is somewhat confusing.  If you have a file like
this:

/foo/bar/Twisted/doc/howto/listings/TwistedQuotes/__init__.py

then your PYTHONPATH should be set to this:

/foo/bar/Twisted/doc/howto/listings/

Otherwise, TwistedQuotes is an _entry_ in the Python Path, not a _package_ on
it.  I have yet to find a good clear example of this on python.org or a better
(and still standard) wording to use.  Suggestions are appreciated.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021019/6cbc1084/attachment.sig>

From paul at paulbaranowski.org  Sat Oct 19 14:50:04 2002
From: paul at paulbaranowski.org (Paul Baranowski)
Date: Sat, 19 Oct 2002 16:50:04 -0400
Subject: [Twisted-Python] QOTD Plugin Example
In-Reply-To: <20021019165458.28831.qmail@green.zadka.com>
Message-ID: <003601c277b1$1aba02f0$2501a8c0@blackstar>

Ah, I guess this is the line that confused me:

"The path of least resistance is probably just to make a directory
inside your Twisted-X.X.X directory, which will already be in your
sys.path."

This isn't true (at least in the windows install).

However, there is a simple fix if you do do this (as I did):  put the
register() call in the plugins.tml file in the site-packages/twisted
directory like so:

register("Quote of the Day TAP Builder",
         "twisted.TwistedQuotes.quotetap",
         description="""
         Example of a TAP builder module.
         """,
         type="tap",
         tapname="qotd")

instead of in the TwistedQuotes directory. 

Once I did this, everything worked. :)  Yay!


> -----Original Message-----
> From: twisted-python-admin at twistedmatrix.com [mailto:twisted-python-
> admin at twistedmatrix.com] On Behalf Of Moshe Zadka
> Sent: Saturday, October 19, 2002 12:55 PM
> To: twisted-python at twistedmatrix.com
> Subject: Re: [Twisted-Python] QOTD Plugin Example
> 
> Did you add the directory containing the TwistedQuotes directory
> to your PYTHONPATH?
> 





From justin at gnubian.org  Sat Oct 19 17:21:32 2002
From: justin at gnubian.org (Justin Ryan)
Date: 19 Oct 2002 18:21:32 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
Message-ID: <1035069693.944.10.camel@qutang>

Hello..

I've been fumbling with twisted.enterprise.row a bit and seem to have
hit a brick wall.. 

I've got a database with the following info:

accounts
contacts

each account can have an arbitrary number of contacts, and any contact
can be connected to an arbitrary number of accounts..

To solve this problem, I've got a 'rel' table which keeps relationships
between account ids and contact ids, so if I want all of the contacts
for account x I simply pull all of the rows out of the 'rel' table whose
accountId is x, and then individually step through them and extract the
contacts with the corresponding accountIds..

I don't think there is a problem with the way I'm doing this, or a
better way to do this (though I'd be tickled if someone could point me a
better way), but in any case there does not seem to be an (obvious) way
to handle this with RowObjects..

Or, to put it better... the row tutorial does not cover this sort of
stuff :)

Thanks in advance for any help!

-Justin


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021019/c8918040/attachment.sig>

From ericmangold at myrealbox.com  Sat Oct 19 20:51:51 2002
From: ericmangold at myrealbox.com (Eric Mangold)
Date: Sat, 19 Oct 2002 19:51:51 -0700
Subject: [Twisted-Python] 1.0.0rc3 test errors
Message-ID: <3DB21A47.6020208@myrealbox.com>

Attached are the 'build' and 'install' logs. The output of 'runtests' is 
below, with my comments at the end. This is on openbsd-3.1.

server% admin/runtests
reactor class: twisted.internet.default.SelectReactor
No module named _tkinter
Falling back to text mode.
...........................................................................................................EE................................................................E.............................................E..........................................EE.........................................
======================================================================
ERROR: testFailedRETR (twisted.test.test_ftp.FTPClientTests)
----------------------------------------------------------------------
======================================================================
ERROR: testFailedRETR (twisted.test.test_ftp.FTPClientTests)
----------------------------------------------------------------------
======================================================================
ERROR: testServer (twisted.test.test_names.ServerDNSTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_names.py", line 53, in testServer
    p.startListening()
  File "./twisted/internet/udp.py", line 184, in startListening
    skt.bind( (self.interface ,self.port) )
error: (48, 'Address already in use')
======================================================================
ERROR: testNormalTermination 
(twisted.test.test_process.PosixProcessTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_process.py", line 206, in testNormalTermination
    p.reason.trap(error.ProcessDone)
  File "./twisted/python/failure.py", line 230, in trap
    raise self
Failure: [Failure instance: Traceback! 
twisted.internet.error.ProcessTerminated, process ended with exit code 1
]
======================================================================
ERROR: testUserFail (twisted.test.test_tcp.ConnectorTestCase)
----------------------------------------------------------------------
======================================================================
ERROR: testUserFail (twisted.test.test_tcp.ConnectorTestCase)
----------------------------------------------------------------------
----------------------------------------------------------------------
Ran 303 tests in 83.449s

FAILED (errors=6)

I don't know about the others, but the ServerDNSTestCase seems really 
odd. According to
 the test source it's trying to listen on udp/2053. That port isn't in use:

server% netstat -a | grep LISTEN
tcp        0      0  *.3128                 *.*                    LISTEN
tcp        0      0  *.netbios-             *.*                    LISTEN
tcp        0      0  *.rsync                *.*                    LISTEN
tcp        0      0  *.ssh                  *.*                    LISTEN
tcp        0      0  *.ftp-prox             *.*                    LISTEN
tcp        0      0  *.swat                 *.*                    LISTEN
tcp        0      0  *.ftp                  *.*                    LISTEN
tcp        0      0  *.www                  *.*                    LISTEN
tcp        0      0  *.auth                 *.*                    LISTEN
tcp6       0      0  *.ssh                  *.*                    LISTEN

Let me know if you all need more info!

-Eric (teratorn)

-------------- next part --------------
A non-text attachment was scrubbed...
Name: setup_build.log.gz
Type: application/x-gzip
Size: 2916 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021019/d94aeefa/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: setup_install.log.gz
Type: application/x-gzip
Size: 7251 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021019/d94aeefa/attachment-0005.bin>

From barry at python.org  Sat Oct 19 16:12:01 2002
From: barry at python.org (Barry A. Warsaw)
Date: Sat, 19 Oct 2002 18:12:01 -0400
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
References: <15791.12797.768063.913733@gargle.gargle.HOWL>
	<3DAF3453.4030306@twistedmatrix.com>
	<15791.13852.867292.398473@gargle.gargle.HOWL>
	<3DAF3952.4050707@twistedmatrix.com>
	<15793.34455.512573.39157@gargle.gargle.HOWL>
	<3DB1B25D.30409@twistedmatrix.com>
Message-ID: <15793.55473.655906.182803@gargle.gargle.HOWL>

>>>>> "JC" == Jp Calderone <exarkun at twistedmatrix.com> writes:

    JC>   I wish I could say that is the case -- I've just been
    JC> motivated to work on other projects lately.

I can sympathize!
    
    JC> I agree that it has gotten more complex, and I don't like it.
    JC> I've recently been pointed at twisted.persisted.dirdbm, and my
    JC> current thinking is that PickleStorage and
    JC> NewsStorageAugmentation should go away in favor of a
    JC> DirDBMStorage.  PickleStorage was never meant as anything more
    JC> than a toy, and the SQL stuff doesn't seem to have yielded any
    JC> performance benefits, probably due to the complexity of some
    JC> of the common queries it is performing.

PickleStorage was fine for my purpose, which wasn't to create a fully
functional peering news server, but to have something
protocol-complete enough to test Mailman's gatewaying functionality.

    JC> The file given to --servers should contain a list of news
    JC> servers to which to connect and share messages with.  This
    JC> hasn't yet been tested thoroughly -- I have surprising
    JC> difficulty finding a news server that implemented enough of
    JC> the protocol to let this work.  I guess the "user facing"
    JC> servers are kept intentionally non-functional for some reason.

Ah, cool.  I guess --servers should simply be optional then (as should
--moderators, but I wasn't sure how to do that).  I think there are
use cases beyond testing Mailman <wink> for having a news server that
isn't a peer of other servers.  E.g. an internal mailing list mirror.

    JC> Yea, this is new too, since pickle was the only legal command
    JC> in the past.  If I go with the dirdbm stuff, I'll probably
    JC> make it the default and let pickle or sql be specified if
    JC> someone wants something different (Or pickle and sql might
    JC> quietly disappear - the prospect of maintaining 3 different
    JC> backends - 2 of which are likely useless to nearly everybody -
    JC> is a little unpleasant).

Pickles were fine for me, but I can understand others may not be happy
with them.  Sql wasn't an option because I don't have an sql server
set up, and that would have been too high a barrier for me.

>  While these repeated as long as the server was running, they didn't
>  seem to affect its operation.

    JC> I'm guessing these are due to whatever you put in your server
    JC> list file.

Makes sense!

>In any event, I hacked in moderated group support by adding a
>-m/--moderators flag, which takes a file containing a list of
>newsgroup/moderator address pairs.  When a message is POSTed to a
>group, the list of target newsgroups is checked against the
>moderators.  If there is any match, and the article has no Approved
>header, the article is not posted, but instead emailed to the
>moderators address.  The value of the Approved header is completely
>ignored -- it just has to be there.  I believe this is pretty close to
>how Usenet s/w handles moderators.

    JC> Hmm.  How does a moderator then approve the message?  The
    JC> interface I had envisioned was something closer to mailman's
    JC> scheme, though this is certainly easier on the server side :)

I believe that the news server never really enters into the picture
for moderation.  All it cares about is that posts to moderated groups
have an Approved header -- it doesn't even care what the value of that
header is!  If the Approved header exists, it accepts the post.  If
not, it forwards it to the email address of the moderators.  That's
it.

Mailman's moderation support (only in cvs at the moment) works with
this protocol so that unmoderated messages are held for approval via
the normal admindb interface.  If the list owner -- who doubles as the
newsgroup moderator -- approves the message, Mailman re-posts it
including an Approved header, to its local news server.  The news
server will accept the posting now and everything proceeds as normal.

So the news server's behavior is only half the picture (but a critical
half!).

>- What to do if the list of target newsgroups has more than one
>  moderated newsgroup in it?  Off hand, I'm not sure what Usenet does
>  in this case.
>
    JC> I believe the correct behavior would be to post the message to
    JC> all un-moderated groups and hold the message for approval from
    JC> the moderators of each moderated group, posting it to each
    JC> held group when the appropriate moderator approves it.

Except the news server can't do this, because of the above.  I /think/
what actually happens in practice (some Usenet expert will have to
verify this) is that the news server doesn't post the message to any
newsgroup, but forwards it off to the moderators of the first
moderated newsgroup in the list.  Once they approve it and repost,
that's all the approval necessary.
    
>- Any un-Twisted coding offenses. :)

    JC> The only one I see is the use of smtplib.  Its sendmail method
    JC> will very likely block, possibly for a long time, hanging the
    JC> entire server.

Ah, I'm so used to Mailman's behavior, I hadn't tought about this.
Mailman always connects to a trusted, local MTA to do the final
delivery.  Usually this is some server on localhost:25.  Mailman never
connects to the actual recipient's remote mta.  I'd be happy enough if
Twisted made the same assumption, but OTOH since Twisted /does/ come
with an SMTPd, it can probably do better.
    
    JC> Aside from just being nasty, this opens up the
    JC> possibility for DoS on servers, simply by repeatedly mailing a
    JC> moderated group.  I'm going out of town for a week this coming
    JC> tuesday, and I doubt I'll have time to figure out how
    JC> twisted.protocols.smtp.SMTPClient works before then, so I'm
    JC> going to hold off on committing this.  If you want to figure
    JC> that out and send another patch, that'd be great, otherwise
    JC> I'll just take care of it when I get back.

I probably wont' get to it.  Twisted + my hacks was enough to debug
Mailman's new moderation support, and I'll have to leave it at that
for now.  I've got my hands full trying to get Mailman 2.1b4 out the
door this weekend!

  Glad to hear it :)  Thanks for the patch.

No problem, thanks again for your help.
-Barry



From gustav at morpheus.demon.co.uk  Sat Oct 19 16:36:15 2002
From: gustav at morpheus.demon.co.uk (Paul Moore)
Date: Sat, 19 Oct 2002 23:36:15 +0100
Subject: [Twisted-Python] Completely new to twisted - where to get some background?
Message-ID: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk>

I'm totally new to twisted - I downloaded it because I'd heard that it
could support being an NNTP server. But I can't get my head round the
documentation. I'm not even sure where to begin - am I a user, an
administrator, or what?

Basically, what I want to do is to set up an NNTP server which serves
out the contents of a series of mbox files as newsgroups. I'm guessing
that I need to code up some sort of "backend" code, which will fit
into the twisted structure somewhere. But I can't find enough from the
documentation to know where to start.

Can someone point me at some sort of "gentle introduction" to this
sort of task? (Or alternatively, let me know if twisted is *not* the
appropriate application for this!)

Thanks in advance,
Paul Moore

-- 
This signature intentionally left blank



From ericmangold at myrealbox.com  Sat Oct 19 20:44:02 2002
From: ericmangold at myrealbox.com (Eric Mangold)
Date: Sat, 19 Oct 2002 19:44:02 -0700
Subject: [Twisted-Python] 1.0.0rc3 test errors
Message-ID: <3DB21872.7090903@myrealbox.com>

Attached are the 'build' and 'install' logs. The output of 'runtests' is 
below, with my comments at the end. This is on openbsd-3.1.

server% admin/runtests
reactor class: twisted.internet.default.SelectReactor
No module named _tkinter
Falling back to text mode.
...........................................................................................................EE................................................................E.............................................E..........................................EE.........................................
======================================================================
ERROR: testFailedRETR (twisted.test.test_ftp.FTPClientTests)
----------------------------------------------------------------------
======================================================================
ERROR: testFailedRETR (twisted.test.test_ftp.FTPClientTests)
----------------------------------------------------------------------
======================================================================
ERROR: testServer (twisted.test.test_names.ServerDNSTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_names.py", line 53, in testServer
    p.startListening()
  File "./twisted/internet/udp.py", line 184, in startListening
    skt.bind( (self.interface ,self.port) )
error: (48, 'Address already in use')
======================================================================
ERROR: testNormalTermination 
(twisted.test.test_process.PosixProcessTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "./twisted/test/test_process.py", line 206, in testNormalTermination
    p.reason.trap(error.ProcessDone)
  File "./twisted/python/failure.py", line 230, in trap
    raise self
Failure: [Failure instance: Traceback! 
twisted.internet.error.ProcessTerminated, process ended with exit code 1
]
======================================================================
ERROR: testUserFail (twisted.test.test_tcp.ConnectorTestCase)
----------------------------------------------------------------------
======================================================================
ERROR: testUserFail (twisted.test.test_tcp.ConnectorTestCase)
----------------------------------------------------------------------
----------------------------------------------------------------------
Ran 303 tests in 83.449s

FAILED (errors=6)

I don't know about the others, but the ServerDNSTestCase seems really 
odd. According to
 the test source it's trying to listen on udp/2053. That port isn't in use:

server% netstat -a | grep LISTEN
tcp        0      0  *.3128                 *.*                    LISTEN
tcp        0      0  *.netbios-             *.*                    LISTEN
tcp        0      0  *.rsync                *.*                    LISTEN
tcp        0      0  *.ssh                  *.*                    LISTEN
tcp        0      0  *.ftp-prox             *.*                    LISTEN
tcp        0      0  *.swat                 *.*                    LISTEN
tcp        0      0  *.ftp                  *.*                    LISTEN
tcp        0      0  *.www                  *.*                    LISTEN
tcp        0      0  *.auth                 *.*                    LISTEN
tcp6       0      0  *.ssh                  *.*                    LISTEN

Let me know if you all need more info!

-Eric (teratorn)

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: setup_build.log
URL: </pipermail/twisted-python/attachments/20021019/f8cfe318/attachment.ksh>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: setup_install.log
URL: </pipermail/twisted-python/attachments/20021019/f8cfe318/attachment-0001.ksh>

From screwtape at froup.com  Sun Oct 20 01:43:06 2002
From: screwtape at froup.com (Tim Allen)
Date: Sun, 20 Oct 2002 17:43:06 +1000
Subject: [Twisted-Python] Twisted IM fixes
In-Reply-To: <20021019.144559.89042554.glyph@twistedmatrix.com>
Message-ID: <926AA5AC-E3FF-11D6-97F9-003065D61A3E@froup.com>

On Sunday, October 20, 2002, at 05:45 AM, Glyph Lefkowitz wrote:

> On Sat, 19 Oct 2002 23:09:11 +1000, Tim Allen <screwtape at froup.com> 
> wrote:
>> I was wondering - would there be any interest in me polishing up my
>> minimalist twisted.im client so it could be added to twisted.im or
>> doc/examples or such?
>
> Is this a minimalist bot-style client or a minimalist text-mode client?

So far, minimalist as in 'just echos what people say to the screen'.

An actual text-mode client would be great, I'm just waiting for someone 
to write a reactor that integrates nicely with the event loop you get 
with 'import cmd'. :)

>   In any
> case, yes!  Either would be highly useful :) (and thanks for sending 
> the patch
> as an attachment ^_^)

No problem. :)

Screwtape,
...mmm, command-line.




From screwtape at froup.com  Sun Oct 20 05:37:47 2002
From: screwtape at froup.com (Tim Allen)
Date: Sun, 20 Oct 2002 21:37:47 +1000
Subject: [Twisted-Python] Minimalist twisted.im interface
Message-ID: <5B8B33CA-E420-11D6-97F9-003065D61A3E@froup.com>

OK, here's my first draft at a minimalist twisted.im interface. It 
doesn't let you manage accounts or even actually speak, but it should be 
enough to give anyone else who wants to write a twisted.im interface a 
decent idea about what they're required to do.

As I said, there's no account management - how do you add accounts? 
Well, I'm kind of ashamed of the implementation, but basically there's a 
file called twisted.im.accounts that contains a list of account objects. 
I'm open to suggestions for improvements, especially improvements that 
involve (a) simple code, and (b) a system I can configure with vi.

There's no (useful) changes to existing code, so I'm not including a 
diff. Rather, I'm just attaching the new files. There's three, and they 
all go in twisted.im:

o accounts.py: This is your basic turing-complete configuration file, 
including comments.
o minchat.py: Modelled after basechat.py and gtkchat.py, this is the 
actual useful code.
o minaccount.py: Modelled after baseaccount.py and gtkaccount.py, this 
loads up the accounts and tells them to log in.

If you want to try running it, you should probably point python at 
minchat.py (which uses minaccount, at the bottom).

Also, I've not yet fully acclimatised to the Twisted paradigm - tell me 
if I'm doing something stupid or non-twisted-like.

Oh, before I forget - if I want to turn this into a nice bot framework 
suitable for being checked into CVS, where should I put it? 
twisted.im.bot?

Screwtape,
...in case some crazy person wants to check this in verbatim, I hereby 
assign copyright to Glyph...

-------------- next part --------------
A non-text attachment was scrubbed...
Name: accounts.py
Type: application/octet-stream
Size: 1427 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021020/c3b1f667/attachment-0006.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: minaccount.py
Type: application/octet-stream
Size: 1766 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021020/c3b1f667/attachment-0007.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: minchat.py
Type: application/octet-stream
Size: 3518 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021020/c3b1f667/attachment-0008.obj>

From twisted at moshez.org  Sun Oct 20 07:03:30 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 20 Oct 2002 13:03:30 -0000
Subject: [Twisted-Python] Twisted Documentation -- The Book
Message-ID: <20021020130330.7942.qmail@green.zadka.com>

Having worked a bit with the index.html's structure, I was intrigued to
see how an honest-to-god book from the same materials would look like.

If you are also intrigued, see
http://twistedmatrix.com/users/moshez/book.dvi.gz

Summary of the process:
1. Write latex.py (about half an hour, including debugging)
2. Use it to generate "section latexs" of all HTML files in question.
3. Manually process book.html to book.tex, \include'ing all relevant sections
4. Run latex

In case anyone is really interested, we can pretty easily do a postscript
book every release, or whenever else we're interesting. The XHTML parser
is a SUX-based one, extremely crude and yet quite easy to expand to more
HTML stuff.

Missing stuff from LaTeX processor:

1. IMG support (anyone remembers how to stuff .png's into a LaTeX file? Maybe
   I should process them to .eps files first? Bah)
2. Table support (shouldn't be hard, but promises to be annoying)



From exarkun at meson.dyndns.org  Sun Oct 20 12:24:18 2002
From: exarkun at meson.dyndns.org (Jp Calderone)
Date: Sun, 20 Oct 2002 14:24:18 -0400
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021013.162312.111208639.glyph@twistedmatrix.com>
References: <20021012033610.28948.qmail@green.zadka.com> <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com> <20021013.162312.111208639.glyph@twistedmatrix.com>
Message-ID: <20021020182418.GA6647@meson.dyndns.org>

On Sun, Oct 13, 2002 at 04:23:12PM -0500, Glyph Lefkowitz wrote:
> 
> The real problem is that these tools don't have a GUI and that doesn't mesh
> very well with the Windows way of being.  A simple GUI for running/making
> TA[SPX] files with Tkinter has been on the "that would be nice" TODO list for
> some time, but so few Twisted developers use Windows on a regular basis that it
> never seems to get done...

  This sounds like fun.  I assume the desired approach would auto-generate
something from the appropriate Options class?  I might look into this when
I get back (from Minnesota (next tuesday)).

    Jp

-- 
"Pascal is Pascal is Pascal is dog meat."
                -- M. Devine and P. Larson, Computer Science 340
--
 2:00pm up 152 days, 14:58, 3 users, load average: 0.16, 0.25, 0.22
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 237 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021020/6b3d1faa/attachment.sig>

From kkennedy at abelard.kenzoid.com  Sun Oct 20 12:50:58 2002
From: kkennedy at abelard.kenzoid.com (Ken Kennedy)
Date: Sun, 20 Oct 2002 14:50:58 -0400
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <1035069693.944.10.camel@qutang>
References: <1035069693.944.10.camel@qutang>
Message-ID: <20021020185058.GA783@orcrist>

On Sat, Oct 19, 2002 at 06:21:32PM -0500, Justin Ryan wrote:
> Hello..
> 
> To solve this problem, I've got a 'rel' table which keeps relationships
> between account ids and contact ids, so if I want all of the contacts
> for account x I simply pull all of the rows out of the 'rel' table whose
> accountId is x, and then individually step through them and extract the
> contacts with the corresponding accountIds..
> 
> I don't think there is a problem with the way I'm doing this, or a
> better way to do this (though I'd be tickled if someone could point me a
> better way), but in any case there does not seem to be an (obvious) way
> to handle this with RowObjects..

It's a little unclear, but the "pull all of the rows out..and then
individually step through them" seems to suggest you're making two
queries to the db. If that's the case,then yeah, there's a better
way. If you know the accountID (from some previous query), just join
rel to contacts:

"select contact_info from contacts inner join rel on (rel.contactid =
contacts.contactid) where rel.accountid = whatever" 

If you only know account name info, use:

"select contact_info from 
       accounts inner join rel on (rel.accountid = accounts.accountid)
       inner join
       contacts on (contacts.contactid=rel.contactid)
       where account.accountname = 'whatever'
"

Either way, you should be getting back what you need in one
query. Does that make sense?

Ken






From tv at twistedmatrix.com  Sun Oct 20 12:59:52 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Sun, 20 Oct 2002 21:59:52 +0300
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <3DAF1916.50001@cubik.org>
References: <20021017113234.5554.9837.Mailman@pyramid.twistedmatrix.com> <3DAEC330.4050207@pa.press.net> <20021017153553.275ae8ed.twisted@itamarst.org> <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org>
Message-ID: <20021020185952.GB23670@ki.yok.utu.fi>

On Thu, Oct 17, 2002 at 02:09:58PM -0600, Bruce Mitchener wrote:
> Not really.  For decent sized log files (well over a meg), it can take a 
> noticeable time and with Twisted, that's too much time.  It shouldn't be 
> an issue or that hard to do the compression in a thread anyway.

	EW! A compression of a file has _nothing_ shared with the
	main execution context. A thread is just _so_ much the
	wrong tool.

-- 
:(){ :|:&};:



From tv at twistedmatrix.com  Sun Oct 20 12:58:19 2002
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Sun, 20 Oct 2002 21:58:19 +0300
Subject: [Twisted-Python] Limits of human perception
In-Reply-To: <LKENLBBMDHMKBECHIAIAAENGCMAA.andy@reportlab.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <LKENLBBMDHMKBECHIAIAAENGCMAA.andy@reportlab.com>
Message-ID: <20021020185819.GA23670@ki.yok.utu.fi>

On Thu, Oct 17, 2002 at 09:39:33PM +0100, Andy Robinson wrote:
> What's a good guideline duration for a CPU-heavy job before one 
> should consider threading?  0.01 sec? 0.1 sec? 1 sec?

	It's an old wisdom that a human perceives pauses
	of over 1/100 second in length.

	Though in a networked server you have multiple users,
	and even smaller pauses matter a lot if they come
	often (I'd say more than once an hour). Pauses of 1s
	in a network server are intolerable.

-- 
:(){ :|:&};:



From justin at gnubian.org  Sun Oct 20 13:44:33 2002
From: justin at gnubian.org (Justin Ryan)
Date: 20 Oct 2002 14:44:33 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <20021020185058.GA783@orcrist>
References: <1035069693.944.10.camel@qutang>  <20021020185058.GA783@orcrist>
Message-ID: <1035143074.872.5.camel@qutang>

On Sun, 2002-10-20 at 13:50, Ken Kennedy wrote:
> On Sat, Oct 19, 2002 at 06:21:32PM -0500, Justin Ryan wrote:
> > Hello..
> > 
> > To solve this problem, I've got a 'rel' table which keeps relationships
> > between account ids and contact ids, so if I want all of the contacts
> > for account x I simply pull all of the rows out of the 'rel' table whose
> > accountId is x, and then individually step through them and extract the
> > contacts with the corresponding accountIds..
> > 
> > I don't think there is a problem with the way I'm doing this, or a
> > better way to do this (though I'd be tickled if someone could point me a
> > better way), but in any case there does not seem to be an (obvious) way
> > to handle this with RowObjects..
> 
> It's a little unclear, but the "pull all of the rows out..and then
> individually step through them" seems to suggest you're making two
> queries to the db. If that's the case,then yeah, there's a better
> way. If you know the accountID (from some previous query), just join
> rel to contacts:
> 
> "select contact_info from contacts inner join rel on (rel.contactid =
> contacts.contactid) where rel.accountid = whatever" 
> 
> If you only know account name info, use:
> 
> "select contact_info from 
>        accounts inner join rel on (rel.accountid = accounts.accountid)
>        inner join
>        contacts on (contacts.contactid=rel.contactid)
>        where account.accountname = 'whatever'
> "
> 
> Either way, you should be getting back what you need in one
> query. Does that make sense?
> 

Certainly.., and it's not that far off from what I was doing.. except it
does seem a bit off in that no info is actually being pulled from the
account table - and if it were, it would be pulled multiple times (if i
want to pull the account name and account id, and then a list of
contacts).

the big important question here is ('scuse my german)... *drumroll*

how the fuck do I do this with twisted.enterprise.row? ;)

Unfortunately, the documentation for row seems pretty sketchy and shows
a direct parent-child relationship (room->furniture)..

it seems very unimportant what the underlying SQL does if row is
supposed to abstract it anyway..

any idears?

Thanks again!

-Justin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021020/6d081a4a/attachment.sig>

From glyph at twistedmatrix.com  Sun Oct 20 13:51:26 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 20 Oct 2002 14:51:26 -0500 (CDT)
Subject: [Twisted-Python] First impressions of Windows downlod
In-Reply-To: <20021020182418.GA6647@meson.dyndns.org>
References: <LKENLBBMDHMKBECHIAIAGEHHCMAA.andy@reportlab.com>
	<20021013.162312.111208639.glyph@twistedmatrix.com>
	<20021020182418.GA6647@meson.dyndns.org>
Message-ID: <20021020.145126.75426536.glyph@twistedmatrix.com>

On Sun, 20 Oct 2002 14:24:18 -0400, Jp Calderone <exarkun at meson.dyndns.org> wrote:
>   This sounds like fun.  I assume the desired approach would auto-generate
> something from the appropriate Options class?  I might look into this when
> I get back (from Minnesota (next tuesday)).

Yep, that's how I'd do it.  Something relatively lame-looking like wGetGUI
would be fine:

    http://www.jensroesner.de/wgetgui/



-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021020/4b27e633/attachment.sig>

From glyph at twistedmatrix.com  Sun Oct 20 13:53:54 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 20 Oct 2002 14:53:54 -0500 (CDT)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021020185952.GB23670@ki.yok.utu.fi>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com>
	<3DAF1916.50001@cubik.org>
	<20021020185952.GB23670@ki.yok.utu.fi>
Message-ID: <20021020.145354.88473634.glyph@twistedmatrix.com>

On Sun, 20 Oct 2002 21:59:52 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
> 	EW! A compression of a file has _nothing_ shared with the
> 	main execution context. A thread is just _so_ much the
> 	wrong tool.

As with many potentially icky things in Twisted, this is for portability... I'd
rather have it done once in a thread than done twice: once in a thread (for
Windows/Java) and once in a Process (for UNIX).

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021020/daff7d1f/attachment.sig>

From twisted at moshez.org  Sun Oct 20 14:12:07 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 20 Oct 2002 20:12:07 -0000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021020.145354.88473634.glyph@twistedmatrix.com>
References: <20021020.145354.88473634.glyph@twistedmatrix.com>, <20021017195851.GA29573@pyramid.twistedmatrix.com>
	<3DAF1916.50001@cubik.org>
	<20021020185952.GB23670@ki.yok.utu.fi>
Message-ID: <20021020201207.12429.qmail@green.zadka.com>

On Sun, 20 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> rather have it done once in a thread than done twice: once in a thread (for
> Windows/Java) and once in a Process (for UNIX).

I disagree. doing it in a process with gzip would work much better and
much saner on UNIX. I'd rather it be done twice, even if I have to do
the UNIX version myself.



From kkennedy at abelard.kenzoid.com  Sun Oct 20 14:27:52 2002
From: kkennedy at abelard.kenzoid.com (Ken Kennedy)
Date: Sun, 20 Oct 2002 16:27:52 -0400
Subject: [Twisted-Python] Connection Pools for websites...
Message-ID: <20021020202752.GB783@orcrist>

Hello all:

OK...it's time for me to start tossing out my stupid questions. *grin*

Even been lurking on the list, trying to grok Twistedness, and waiting
for things to get close to 1.0. I'm really looking forward to it.

My initial goal is to use Twisted for web serving, in the classic
"db-backed website" style. My main question is regarding database
connections. I've read the twisted.enterprise docs (though not all the
code comments yet), but I haven't seen what I'm looking for. If it's
obvious, I apologize...*grin*.

I understand the adbapi.ConnectionPool...but what I want is a way to
share that across multiple (for example) rpy files. Let's say I have a
VERY simple woven-based website. (Example follows:)

I'm using a plain twisted web server

mktap web --path ~/public_html
twistd -f web.tap

with my rpy files in the public_html directory. If I have two files

showStories.rpy

and

submitStories.rpy

I want both files to be able to connect to my db via a connection
pool...but a SHARED one.

So my "dbconn = StoryDatabase(dbpool)" would be using a common dbpool. 

Does this make sense...and if so, how can I do it?

Is this something I can/should be able to set with mktap, or configure
via coil? Or should I connect to another, long-running process via PB
to get database info?

I'm going to carefully review the enterprise code now, so maybe I can
answer my own question. Many thanks...

Ken
 



From jon at totient.demon.co.uk  Sun Oct 20 14:21:04 2002
From: jon at totient.demon.co.uk (Jon Dyte)
Date: Sun, 20 Oct 2002 21:21:04 +0100 (BST)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: twisted@moshez.org
References: <20021020.145354.88473634.glyph@twistedmatrix.com>
	<20021017195851.GA29573@pyramid.twistedmatrix.com>
	<3DAF1916.50001@cubik.org>
	<20021020185952.GB23670@ki.yok.utu.fi>
	<20021020201207.12429.qmail@green.zadka.com>
Message-ID: <15795.4144.491981.811198@erdos.totient.com>

Moshe Zadka wrote :-
> On Sun, 20 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> 
> > rather have it done once in a thread than done twice: once in a thread (for
> > Windows/Java) and once in a Process (for UNIX).
> 
> I disagree. doing it in a process with gzip would work much better and
> much saner on UNIX. I'd rather it be done twice, even if I have to do
> the UNIX version myself.
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

<unlurk-mode>
FWIW it's worth I agree as well.
</unlurk-mode>

Jon



From jjn at kriln.com  Sun Oct 20 15:13:38 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Sun, 20 Oct 2002 21:13:38 +0000 (GMT)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <15795.4144.491981.811198@erdos.totient.com>
Message-ID: <20021020211327.U33911-100000@nosferatu.kriln.com>

On Sun, 20 Oct 2002, Jon Dyte wrote:

> Moshe Zadka wrote :-
> > On Sun, 20 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> >
> > > rather have it done once in a thread than done twice: once in a thread (for
> > > Windows/Java) and once in a Process (for UNIX).
> >
> > I disagree. doing it in a process with gzip would work much better and
> > much saner on UNIX. I'd rather it be done twice, even if I have to do
> > the UNIX version myself.
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
> <unlurk-mode>
> FWIW it's worth I agree as well.
> </unlurk-mode>
>

As do I




From sean at twistedmatrix.com  Sun Oct 20 15:32:23 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Sun, 20 Oct 2002 16:32:23 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <1035143074.872.5.camel@qutang>
Message-ID: <HOEEKPCOKELHCNIJNMAGEEHDCHAA.sean@twistedmatrix.com>

well, i can think of two ways - but neither are particularly good.

You could create RowObject classes for each of the three tables - account,
contact, and rel  - and define foreign keys with the "rowForeignKey"
attributes between the tables.

Then use loadObjectsFrom to load objects from the rel table, and have those
"relRow" objects auto-load their children - which would be the rows from the
contacts table... This is not terribly efficient as it doesn't take
advantage of sql joins or set operations at all, but it should work.

For the second way, create a view on the rel and contacts tables:

create view account_contacts as
select rel.account_id, contact.contact_id, contact.name
from contact, rel
where rel.contact_id = contact.contact_id;

and create a rowObjectClass for the view. This would allow the rows to be
loaded, but updates and inserts could be a problem. Some databases cant do
updates or inserts to views... Others require rules or triggers to do it.


Dealing with many-to-many relationships like this is really outside of the
immediate scope of the current row code. Its a pretty common problem though,
so it is a logical place for the next extensions.  I'm not yet sure how to
make a good interface for this. I am reluctant to introduce more rowClass
attributes without some better validation or generation scheme - it is
already tedious and error-prone enough to type in all the columns, types and
relationships.

An SQL parser may be one way. If there was some way to generate
rowObjectClasses for queries dynamically, with functionality similar to the
way cursors work, that would be a generally useful solution....

Any thoughts on extending the Row API are welcome :)


-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Justin Ryan
Sent: Sunday, October 20, 2002 2:45 PM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] enterprise.row and two-way relationships


On Sun, 2002-10-20 at 13:50, Ken Kennedy wrote:
> On Sat, Oct 19, 2002 at 06:21:32PM -0500, Justin Ryan wrote:
> > Hello..
> >
> > To solve this problem, I've got a 'rel' table which keeps relationships
> > between account ids and contact ids, so if I want all of the contacts
> > for account x I simply pull all of the rows out of the 'rel' table whose
> > accountId is x, and then individually step through them and extract the
> > contacts with the corresponding accountIds..
> >
> > I don't think there is a problem with the way I'm doing this, or a
> > better way to do this (though I'd be tickled if someone could point me a
> > better way), but in any case there does not seem to be an (obvious) way
> > to handle this with RowObjects..
>
> It's a little unclear, but the "pull all of the rows out..and then
> individually step through them" seems to suggest you're making two
> queries to the db. If that's the case,then yeah, there's a better
> way. If you know the accountID (from some previous query), just join
> rel to contacts:
>
> "select contact_info from contacts inner join rel on (rel.contactid =
> contacts.contactid) where rel.accountid = whatever"
>
> If you only know account name info, use:
>
> "select contact_info from
>        accounts inner join rel on (rel.accountid = accounts.accountid)
>        inner join
>        contacts on (contacts.contactid=rel.contactid)
>        where account.accountname = 'whatever'
> "
>
> Either way, you should be getting back what you need in one
> query. Does that make sense?
>

Certainly.., and it's not that far off from what I was doing.. except it
does seem a bit off in that no info is actually being pulled from the
account table - and if it were, it would be pulled multiple times (if i
want to pull the account name and account id, and then a list of
contacts).

the big important question here is ('scuse my german)... *drumroll*

how the fuck do I do this with twisted.enterprise.row? ;)

Unfortunately, the documentation for row seems pretty sketchy and shows
a direct parent-child relationship (room->furniture)..

it seems very unimportant what the underlying SQL does if row is
supposed to abstract it anyway..

any idears?

Thanks again!

-Justin




From justin at gnubian.org  Sun Oct 20 15:31:51 2002
From: justin at gnubian.org (Justin Ryan)
Date: 20 Oct 2002 16:31:51 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <HOEEKPCOKELHCNIJNMAGEEHDCHAA.sean@twistedmatrix.com>
References: <HOEEKPCOKELHCNIJNMAGEEHDCHAA.sean@twistedmatrix.com>
Message-ID: <1035149512.872.16.camel@qutang>

On Sun, 2002-10-20 at 16:32, Sean Riley wrote:
> well, i can think of two ways - but neither are particularly good.

I was afraid of this :)

> You could create RowObject classes for each of the three tables - account,
> contact, and rel  - and define foreign keys with the "rowForeignKey"
> attributes between the tables.
> 
> Then use loadObjectsFrom to load objects from the rel table, and have those
> "relRow" objects auto-load their children - which would be the rows from the
> contacts table... This is not terribly efficient as it doesn't take
> advantage of sql joins or set operations at all, but it should work.

this had occurred to me but I hoped there would be a better way..
 
> For the second way, create a view on the rel and contacts tables:
> 
> create view account_contacts as
> select rel.account_id, contact.contact_id, contact.name
> from contact, rel
> where rel.contact_id = contact.contact_id;
> 
> and create a rowObjectClass for the view. This would allow the rows to be
> loaded, but updates and inserts could be a problem. Some databases cant do
> updates or inserts to views... Others require rules or triggers to do it.
> 

hrm.. do you know if postgres can?  I spose i could find out fairly
easily :)

seems this would still require two queries in order to grab the account
name as well as the contact info, but is still more efficient than
making account and contact children of rel..

> Dealing with many-to-many relationships like this is really outside of the
> immediate scope of the current row code. Its a pretty common problem though,
> so it is a logical place for the next extensions.  I'm not yet sure how to
> make a good interface for this. I am reluctant to introduce more rowClass
> attributes without some better validation or generation scheme - it is
> already tedious and error-prone enough to type in all the columns, types and
> relationships.
> 
> An SQL parser may be one way. If there was some way to generate
> rowObjectClasses for queries dynamically, with functionality similar to the
> way cursors work, that would be a generally useful solution....
> 
> Any thoughts on extending the Row API are welcome :)

I may just poke around in the code and see what idears I can come up
with :)

Thanks!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021020/b375b01d/attachment.sig>

From kkennedy at abelard.kenzoid.com  Sun Oct 20 15:56:40 2002
From: kkennedy at abelard.kenzoid.com (Ken Kennedy)
Date: Sun, 20 Oct 2002 17:56:40 -0400
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <1035143074.872.5.camel@qutang>
References: <1035069693.944.10.camel@qutang> <20021020185058.GA783@orcrist> <1035143074.872.5.camel@qutang>
Message-ID: <20021020215640.GC783@orcrist>

On Sun, Oct 20, 2002 at 02:44:33PM -0500, Justin Ryan wrote:

> > Either way, you should be getting back what you need in one
> > query. Does that make sense?
> > 
> 
> Certainly.., and it's not that far off from what I was doing.. except it
> does seem a bit off in that no info is actually being pulled from the
> account table - and if it were, it would be pulled multiple times (if i
> want to pull the account name and account id, and then a list of
> contacts).
> 
> the big important question here is ('scuse my german)... *drumroll*
> 
> how the fuck do I do this with twisted.enterprise.row? ;)

Ah! Ok...now I'll show my lack of attention. I didn't pay attention to
the twisted.enterprise.ROW reference!

Well...the row stuff looks pretty wonky to me *grin*, but since I want
to understand it as well, we can figure it out together. 

Is the following a good minimalist schema for the objects?

account (
accountid integer,
name varchar(100),
)

contact (
contactid integer,
fname varchar(100),
lname varchar(100),
email varchar(100)
)

rel (
accountid integer,
contactid integer
)

If you've got better field names, just let me know. I just want to be
able to talk apples to apples...

Ken



From justin at gnubian.org  Sun Oct 20 16:49:37 2002
From: justin at gnubian.org (Justin Ryan)
Date: 20 Oct 2002 17:49:37 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <20021020215640.GC783@orcrist>
References: <1035069693.944.10.camel@qutang> <20021020185058.GA783@orcrist>
	<1035143074.872.5.camel@qutang>  <20021020215640.GC783@orcrist>
Message-ID: <1035154178.872.49.camel@qutang>

> Ah! Ok...now I'll show my lack of attention. I didn't pay attention to
> the twisted.enterprise.ROW reference!
> 
> Well...the row stuff looks pretty wonky to me *grin*, but since I want
> to understand it as well, we can figure it out together. 

admittedly, it does.. I'm embarrassed to admit that I'm currently using
a pretty lame db access method..

The Python Cookbook outlines a LazyDB class (aptly named at that) which
implemens Connection, Record and RecordSet objects (though I honestly
don't see why it couldn't be done with a list of Records).. 

As it is implemented, it doesn't seem feasible to subclass the Record
object, which means I can't implement objects for each of my tables..

> Is the following a good minimalist schema for the objects?
> 
> account (
> accountid integer,
> name varchar(100),
> )
> 
> contact (
> contactid integer,
> fname varchar(100),
> lname varchar(100),
> email varchar(100)
> )
> 
> rel (
> accountid integer,
> contactid integer
> )
> 
> If you've got better field names, just let me know. I just want to be
> able to talk apples to apples...

I've got a few more fields in the contact table, but we can work with id
and name..

If you check the other reply to my post, I tried the create view method
and it seems like it will work, but still makes for messy integration
with row, since i'll have to define three rows - one for accounts, one
for contacts, and one for the integrated view (although honestly, the
account table will rarely be accessed without the full view).

Thanks!

-Justin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021020/cd32b6ff/attachment.sig>

From exarkun at meson.dyndns.org  Sun Oct 20 17:34:35 2002
From: exarkun at meson.dyndns.org (Jp Calderone)
Date: Sun, 20 Oct 2002 19:34:35 -0400
Subject: [Twisted-Python] Completely new to twisted - where to get some background?
In-Reply-To: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk>
Message-ID: <20021020233435.GA15094@meson.dyndns.org>

On Sat, Oct 19, 2002 at 11:36:15PM +0100, Paul Moore wrote:
> I'm totally new to twisted - I downloaded it because I'd heard that it
> could support being an NNTP server. But I can't get my head round the
> documentation. I'm not even sure where to begin - am I a user, an
> administrator, or what?
> 
> Basically, what I want to do is to set up an NNTP server which serves
> out the contents of a series of mbox files as newsgroups. I'm guessing
> that I need to code up some sort of "backend" code, which will fit
> into the twisted structure somewhere. But I can't find enough from the
> documentation to know where to start.

  From this, I'd say that you're probably going to be a developer, an
administrator, and a user. ;)

  The current NNTP code lets you use one of two different backends - a
pickle file or an RDBM (postgres is what was used to develop it).  To serve
news out of mbox files, you'll need to write another backend that implements
the NewsStorage interface (twisted.news.database.NewsStorage), then hand
this to either an NNTPServerFactory or a UsenetServerFactory (probably the
former).  It would be nice if 'mktap news' could handle this, but it can't
(yet), so you'll have to write a little more python to glue it all together. 
twisted.tap.news.updateApplication() is definitely something you'll want to
look at.  The Application Howto and the Server Howto are probably worth
going over:

  http://twistedmatrix.com/documents/howto/application
  http://twistedmatrix.com/documents/howto/servers

  You shouldn't need to write a Factory or a Protocol to do what you want,
but knowing how the pieces fit together will probably be beneficial.

  Depending if you try to make "queries" to the mbox synchronous or not, the
Deferred howto might be relevant as well:

  http://twistedmatrix.com/documents/howto/defer

  Twisted usually considers disk operations (and certainly memory
operations) fast enough to not worry about this, though, so doing what the
PickleStorage class does (defer.fail(), defer.succeed()) will probably work
for you.
> 
> Can someone point me at some sort of "gentle introduction" to this
> sort of task? (Or alternatively, let me know if twisted is *not* the
> appropriate application for this!)

  Twisted is definitely suited for this :)  I'm not aware of a document that
is directly relevant to what you want to do, because it's not too deeply
related to Twisted.  Hopefully what needs to be done will be clear after you
check out the code I mentioned above.  

  Jp

-- 
"One World, one Web, one Program." - Microsoft(R) promotional ad
"Ein Volk, ein Reich, ein Fuhrer." - Adolf Hitler
--
 7:00pm up 152 days, 19:58, 2 users, load average: 0.14, 0.09, 0.07
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021020/75b4afa5/attachment.sig>

From abo at minkirri.apana.org.au  Sun Oct 20 18:13:05 2002
From: abo at minkirri.apana.org.au (Donovan Baarda)
Date: Mon, 21 Oct 2002 10:13:05 +1000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021020.145354.88473634.glyph@twistedmatrix.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com>
Message-ID: <20021021001305.GC13974@minkirri.apana.org.au>

On Sun, Oct 20, 2002 at 02:53:54PM -0500, Glyph Lefkowitz wrote:
> On Sun, 20 Oct 2002 21:59:52 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
> > 	EW! A compression of a file has _nothing_ shared with the
> > 	main execution context. A thread is just _so_ much the
> > 	wrong tool.
> 
> As with many potentially icky things in Twisted, this is for portability... I'd
> rather have it done once in a thread than done twice: once in a thread (for
> Windows/Java) and once in a Process (for UNIX).

Compression of a whole file might take too long for twisted to do in it's
event loop, but an incremental compression using the python zlib module
wouldn't... just compress a block at a time and use the twisted event loop.
This saves spawning a thread or process.


-- 
----------------------------------------------------------------------
ABO: finger abo at minkirri.apana.org.au for more info, including pgp key
----------------------------------------------------------------------



From jml at mumak.net  Sun Oct 20 19:14:00 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Mon, 21 Oct 2002 12:14:00 +1100
Subject: [Twisted-Python] Twisted 1.0.0rc3 on WinNT / Cygwin
Message-ID: <20021021011400.GA9377@mumak.net>


Hi,

I just tried to install Twisted 1.0.0rc3 on my box at work, using
Windows NT 4.0 and Cygwin. I wasn't very successful at all.

Some version info:
$ gcc -v
Reading specs from /usr/lib/gcc-lib/i686-pc-cygwin/2.95.3-5/specs
gcc version 2.95.3-5 (cygwin special)

$ python   
Python 2.1.1 (#2, Sep 26 2001, 09:32:53) 

The initial python setup.py install failed during build_ext, with the
following error message:

gcc -g -O2 -Wall -Wstrict-prototypes -DUSE_DL_IMPORT
-I/usr/include/python2.1 -c twisted/internet/cReactor/cReactor.c -o
build/temp.cygwin-1.3.3-i686-2.1/cReactor.o
twisted/internet/cReactor/cReactor.c: In function
`iterate_internal_finalize':
twisted/internet/cReactor/cReactor.c:696: warning: implicit declaration
of function `PyEval_ReleaseLock'
twisted/internet/cReactor/cReactor.c:715: warning: implicit declaration
of function `PyEval_AcquireLock'
twisted/internet/cReactor/cReactor.c: At top level:
twisted/internet/cReactor/cReactor.c:1238: initializer element is not
constant
twisted/internet/cReactor/cReactor.c:1238: (near initialization for
`cReactorType.ob_type')
error: command 'gcc' failed with exit status 1

cheers,
jml
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021021/2b47cd19/attachment.sig>

From kkennedy at abelard.kenzoid.com  Sun Oct 20 19:08:17 2002
From: kkennedy at abelard.kenzoid.com (Ken Kennedy)
Date: Sun, 20 Oct 2002 21:08:17 -0400
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <1035154178.872.49.camel@qutang>
References: <1035069693.944.10.camel@qutang> <20021020185058.GA783@orcrist> <1035143074.872.5.camel@qutang> <20021020215640.GC783@orcrist> <1035154178.872.49.camel@qutang>
Message-ID: <20021021010817.GA437@orcrist>

On Sun, Oct 20, 2002 at 05:49:37PM -0500, Justin Ryan wrote:
> > Ah! Ok...now I'll show my lack of attention. I didn't pay attention to
> > the twisted.enterprise.ROW reference!
> > 
> > Well...the row stuff looks pretty wonky to me *grin*, but since I want
> > to understand it as well, we can figure it out together. 
> 
> admittedly, it does.. I'm embarrassed to admit that I'm currently using
> a pretty lame db access method..

As of now, I'm leaning towards using twisted.enterprise without
t.e.row...except purely for learning purposes. Just this simple
example of yours shows how quickly object <-> relational model
mappings can get tricky. But learning about it should be interesting
nevertheless. 

> > able to talk apples to apples...
> 
> I've got a few more fields in the contact table, but we can work with id
> and name..
> 
> If you check the other reply to my post, I tried the create view method
> and it seems like it will work,

Yeah...I read it. That was my thought as well...use a view to flatten
out two of the objects into one. I'm trying to think of tweaking that
might help simplify the situation there. Some databases have
functionality that might enable you to use one denormalized view and
rewrites on the db backend that would peform the updates properly
depending on the table. But that functionality would be in the
database, so it would be implementation-specific. 

 



From radix at twistedmatrix.com  Sun Oct 20 19:11:47 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 21 Oct 2002 03:11:47 +0200
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021001305.GC13974@minkirri.apana.org.au>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com> <20021021001305.GC13974@minkirri.apana.org.au>
Message-ID: <20021021011147.GB909@twistedmatrix.com>

On Mon, Oct 21, 2002 at 10:13:05AM +1000, Donovan Baarda wrote:
> On Sun, Oct 20, 2002 at 02:53:54PM -0500, Glyph Lefkowitz wrote:
> > On Sun, 20 Oct 2002 21:59:52 +0300, Tommi Virtanen <tv at twistedmatrix.com> wrote:
> > > 	EW! A compression of a file has _nothing_ shared with the
> > > 	main execution context. A thread is just _so_ much the
> > > 	wrong tool.
> > 
> > As with many potentially icky things in Twisted, this is for portability... I'd
> > rather have it done once in a thread than done twice: once in a thread (for
> > Windows/Java) and once in a Process (for UNIX).
> 
> Compression of a whole file might take too long for twisted to do in it's
> event loop, but an incremental compression using the python zlib module
> wouldn't... just compress a block at a time and use the twisted event loop.
> This saves spawning a thread or process.

Hey, I forgot zlib could do that. That's really cool (And I'd
recommend doing it that way, barring any issues with it (and "it's not
UNIXy" isn't an issue, afaic ;))).



From twisted at itamarst.org  Sun Oct 20 19:17:38 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 20 Oct 2002 21:17:38 -0400
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021011147.GB909@twistedmatrix.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com>
	<3DAF1916.50001@cubik.org>
	<20021020185952.GB23670@ki.yok.utu.fi>
	<20021020.145354.88473634.glyph@twistedmatrix.com>
	<20021021001305.GC13974@minkirri.apana.org.au>
	<20021021011147.GB909@twistedmatrix.com>
Message-ID: <20021020211738.7f0aa757.twisted@itamarst.org>

On Mon, 21 Oct 2002 03:11:47 +0200
Christopher Armstrong <radix at twistedmatrix.com> wrote:

> Hey, I forgot zlib could do that. That's really cool (And I'd
> recommend doing it that way, barring any issues with it (and "it's not
> UNIXy" isn't an issue, afaic ;))).

As I'm maintainer of this module, this is how'll it'll work - whoever
sends me a patch first gets it in. I prefer the threaded way,
personally.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From glyph at twistedmatrix.com  Sun Oct 20 20:01:51 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 20 Oct 2002 21:01:51 -0500 (CDT)
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021020211738.7f0aa757.twisted@itamarst.org>
References: <20021021001305.GC13974@minkirri.apana.org.au>
	<20021021011147.GB909@twistedmatrix.com>
	<20021020211738.7f0aa757.twisted@itamarst.org>
Message-ID: <20021020.210151.95501231.glyph@twistedmatrix.com>


On Sun, 20 Oct 2002 21:17:38 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> I prefer the threaded way, personally.

I vastly prefer block-at-a-time compression, now that I've been reminded of it.
It sets a better precedent for other bits of Twisted that want to use
compression.  I imagine that the zlib module is more portable than the threads
module, overall.  Somebody please get a patch to itamar this way first... ;-)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021020/561958d7/attachment.sig>

From jbauer at rubic.com  Sun Oct 20 19:53:55 2002
From: jbauer at rubic.com (Jeff Bauer)
Date: Sun, 20 Oct 2002 20:53:55 -0500
Subject: [Twisted-Python] Doc suggestion for post-installation
Message-ID: <3DB35E33.6BB55869@rubic.com>

I have a modest suggestion for the "Installing Twisted"
document, shamelessly borrowed from ZODB.

Upon installation, suggest that the user try running 
the following from the python interpreter:

  $ python
  >>> import twisted.copyright
  >>> print twisted.copyright.version
  1.0.0rc3

This would catch an obvious import error of leaving
twisted out of PYTHONPATH, or accidentally using an
older, previously installed version of Twisted.

If the line:

   __version__ = "1.0.0rc3" 

were placed in the base __init__.py file, the above
python commands could be shortened to:

  >>> import twisted
  >>> print twisted.__version__

Regards,

Jeff Bauer
Rubicon Research



From twisted at moshez.org  Mon Oct 21 02:07:56 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 21 Oct 2002 08:07:56 -0000
Subject: [Twisted-Python] Twisted 1.0.0rc3 on WinNT / Cygwin
In-Reply-To: <20021021011400.GA9377@mumak.net>
References: <20021021011400.GA9377@mumak.net>
Message-ID: <20021021080756.19352.qmail@green.zadka.com>

On Mon, 21 Oct 2002, jml at mumak.net (Jonathan M. Lange) wrote:

> gcc -g -O2 -Wall -Wstrict-prototypes -DUSE_DL_IMPORT
> -I/usr/include/python2.1 -c twisted/internet/cReactor/cReactor.c -o
> build/temp.cygwin-1.3.3-i686-2.1/cReactor.o
> twisted/internet/cReactor/cReactor.c: In function
> `iterate_internal_finalize':
> twisted/internet/cReactor/cReactor.c:696: warning: implicit declaration
> of function `PyEval_ReleaseLock'
> twisted/internet/cReactor/cReactor.c:715: warning: implicit declaration
> of function `PyEval_AcquireLock'
> twisted/internet/cReactor/cReactor.c: At top level:
> twisted/internet/cReactor/cReactor.c:1238: initializer element is not
> constant
> twisted/internet/cReactor/cReactor.c:1238: (near initialization for
> `cReactorType.ob_type')
> error: command 'gcc' failed with exit status 1

This is indeed a bug in Twisted: cReactorType is initialized with 
Py_HEADINIT(&PyTypeType) instead of being initilalized to NULL and being
set in some init routine. I suggest that in the mean time, we disable cReactor's
build on cygwin.



From twisted at moshez.org  Mon Oct 21 02:09:10 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 21 Oct 2002 08:09:10 -0000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021011147.GB909@twistedmatrix.com>
References: <20021021011147.GB909@twistedmatrix.com>, <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com> <20021021001305.GC13974@minkirri.apana.org.au>
Message-ID: <20021021080910.19374.qmail@green.zadka.com>

On Mon, 21 Oct 2002, Christopher Armstrong <radix at twistedmatrix.com> wrote:

> Hey, I forgot zlib could do that. That's really cool (And I'd
> recommend doing it that way, barring any issues with it (and "it's not
> UNIXy" isn't an issue, afaic ;))).

I fail to see why this is a good idea. The gzip method would work on UNIX
with much simpler code, and will be far more efficient.



From andrew-twisted at puzzling.org  Mon Oct 21 02:26:29 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 21 Oct 2002 18:26:29 +1000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021080910.19374.qmail@green.zadka.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com> <20021021001305.GC13974@minkirri.apana.org.au> <20021021080910.19374.qmail@green.zadka.com>
Message-ID: <20021021082629.GC21689@ritsuko.xware.cx>

On Mon, Oct 21, 2002 at 08:09:10AM -0000, Moshe Zadka wrote:
> On Mon, 21 Oct 2002, Christopher Armstrong <radix at twistedmatrix.com> wrote:
> 
> > Hey, I forgot zlib could do that. That's really cool (And I'd
> > recommend doing it that way, barring any issues with it (and "it's not
> > UNIXy" isn't an issue, afaic ;))).
> 
> I fail to see why this is a good idea. The gzip method would work on UNIX
> with much simpler code, and will be far more efficient.

Hmm.  Cygwin is available for Windows, which provides a gzip.exe you
could use.  So perhaps this approach is ok from a cross-platform
perspective, with the caveat that you may need to install a gzip
executable if your system doesn't already come with one -- and in fact
there's GzipFile or whatever in the standard python library, so we could
always fall back to that...

Just some random thoughts.

-Andrew.




From a.d.stribblehill at durham.ac.uk  Mon Oct 21 08:50:49 2002
From: a.d.stribblehill at durham.ac.uk (Andrew Stribblehill)
Date: Mon, 21 Oct 2002 15:50:49 +0100
Subject: [Twisted-Python] Re: nntp protocol supports moderated newsgroups?
In-Reply-To: <15793.34455.512573.39157@gargle.gargle.HOWL>
References: <15791.12797.768063.913733@gargle.gargle.HOWL> <3DAF3453.4030306@twistedmatrix.com> <15791.13852.867292.398473@gargle.gargle.HOWL> <3DAF3952.4050707@twistedmatrix.com> <15793.34455.512573.39157@gargle.gargle.HOWL>
Message-ID: <20021021145049.GE29549@womble.dur.ac.uk>

<snip>
> A couple of kludges that should be cleaned up:
> 
> - What to do if the list of target newsgroups has more than one
>   moderated newsgroup in it?  Off hand, I'm not sure what Usenet does
>   in this case.

inn sends it to the moderator of the first-mentioned moderated group.
The moderator vets it and posts it with the same Newsgroups: line, so
every group gets it even though it's just been moderated for one
group.

-- 
VIKING NORTH UTSIRE SOUTH UTSIRE
VARIABLE 3 OR 4 BECOMING EASTERLY 5 TO 7, PERHAPS GALE 8 IN VIKING
AND SOUTH UTSIRE LATER. SHOWERS THEN RAIN. GOOD BECOMING MODERATE



From justin at gnubian.org  Mon Oct 21 10:42:52 2002
From: justin at gnubian.org (Justin Ryan)
Date: 21 Oct 2002 11:42:52 -0500
Subject: [Twisted-Python] enterprise.row and two-way relationships
In-Reply-To: <20021021010817.GA437@orcrist>
References: <1035069693.944.10.camel@qutang> <20021020185058.GA783@orcrist>
	<1035143074.872.5.camel@qutang> <20021020215640.GC783@orcrist>
	<1035154178.872.49.camel@qutang>  <20021021010817.GA437@orcrist>
Message-ID: <1035218573.3545.11.camel@qutang>

> As of now, I'm leaning towards using twisted.enterprise without
> t.e.row...except purely for learning purposes. Just this simple
> example of yours shows how quickly object <-> relational model
> mappings can get tricky. But learning about it should be interesting
> nevertheless. 

Well, I'm supposed to be moving into a python dev position @ work soon
and they have actually got quite good object <-> relational mappings
working, but I don't have access to that code yet, and don't know if
i'll even be able to reuse it in my own projects..
 
> Yeah...I read it. That was my thought as well...use a view to flatten
> out two of the objects into one. I'm trying to think of tweaking that
> might help simplify the situation there. Some databases have
> functionality that might enable you to use one denormalized view and
> rewrites on the db backend that would peform the updates properly
> depending on the table. But that functionality would be in the
> database, so it would be implementation-specific. 

and once again, it requires three separate objects - an account, a
contact, and an account_view..

I think I'll poke around with t.enterprise a bit more and see if there's
hope for me there..

Cheers,

-J
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021021/2250cf55/attachment.sig>

From pythondork at cgi-works.com  Mon Oct 21 12:54:42 2002
From: pythondork at cgi-works.com (Max Schubert)
Date: Mon, 21 Oct 2002 15:02:34 +50579034
Subject: [Twisted-Python] Creating an SSH client programatically with Twisted?
Message-ID: <200210211856.g9LIulJ67077@cgi-works.com>

Hi,

    I have been searching for a library to let me do SSH in python ...
    and came across Twisted ... I also found pyssh, but it doesn't
    support SSH sessions, just single command execution.

    I have looked at the documentation, the twisted.conch.ssh.* classes,
    and the test_conch.py script and am still having a hard time figuring
    out how to construct an SSH client using Twisted.

    Does anyone have pointers to examples or documentation that will help
    me do this?

    Thank you very much in advance for any help you can offer .. and thanks
    to the developers for creating an all-python SSH implementation!

Max



From lists at morpheus.demon.co.uk  Mon Oct 21 13:48:01 2002
From: lists at morpheus.demon.co.uk (Paul Moore)
Date: Mon, 21 Oct 2002 20:48:01 +0100
Subject: [Twisted-Python] Completely new to twisted - where to get some
 background?
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk> <20021020233435.GA15094@meson.dyndns.org>
Message-ID: <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk>

Jp Calderone <exarkun at meson.dyndns.org> writes:

>   From this, I'd say that you're probably going to be a developer, an
> administrator, and a user. ;)

I sort of thought that might be the case :-)

>   The current NNTP code lets you use one of two different backends - a
> pickle file or an RDBM (postgres is what was used to develop it).  To serve
> news out of mbox files, you'll need to write another backend that implements
> the NewsStorage interface (twisted.news.database.NewsStorage), then hand
> this to either an NNTPServerFactory or a UsenetServerFactory (probably the
> former).

Thanks! That pointer was enough to get me started, and I managed to
get a simple "dummy" backend (serving one static article in one group)
up and running in half an hour! It's extremely easy, once you get the
picture.


> It would be nice if 'mktap news' could handle this, but it can't
> (yet), so you'll have to write a little more python to glue it all
> together. twisted.tap.news.updateApplication() is definitely
> something you'll want to look at.

Haven't done this yet, at the moment I'm just starting the server
running directly, not botyhering with mktap/twistd. That's my next job
(as far as learning Twisted goes - writing the backend I really want
probably has to go in there somewhere too :-))

I can see a few possible approaches - the simpler one seems to be to
write a new type of application so that you do "mktap pfmnews". This
seems like an unpleasant hack, though...

Better would probably be to patch Twisted (and submit the patch,
obviously :-)) to allow the "news" application to be more configurable
as regards backend type. My feeling is that this is a reasonable and
not too hard way to go.

I wonder, however, if it is somehow possible to "subclass" the
existing news application type, to add my own backend into it without
needing to patch Twisted. That would seem the best solution,
ultimately. However, I'm not at all familiar with this part of Twisted
yet, so I could easily have missed something simple.

> The Application Howto and the Server Howto are probably worth going
> over:
>
>   http://twistedmatrix.com/documents/howto/application
>   http://twistedmatrix.com/documents/howto/servers
>
>   You shouldn't need to write a Factory or a Protocol to do what you want,
> but knowing how the pieces fit together will probably be beneficial.

It was indeed. Gave me a good place to start.

>   Depending if you try to make "queries" to the mbox synchronous or not, the
> Deferred howto might be relevant as well:
>
>   http://twistedmatrix.com/documents/howto/defer
>
>   Twisted usually considers disk operations (and certainly memory
> operations) fast enough to not worry about this, though, so doing what the
> PickleStorage class does (defer.fail(), defer.succeed()) will probably work
> for you.

So far, the simple approach is working, but I'll keep this in mind...

>   Twisted is definitely suited for this :)  I'm not aware of a document that
> is directly relevant to what you want to do, because it's not too deeply
> related to Twisted.  Hopefully what needs to be done will be clear after you
> check out the code I mentioned above.  

Indeed, it became a lot clearer, very fast. I was getting bogged down
in concepts (Perspective Broker, reactors...) which didn't seem
relevant to me (and weren't, as it happened). Maybe some sort of
documentation roadmap ("If you are trying to do XXX, then start with
documents YYY, ZZZ") would be useful. Your suggestions certainly got
me on the right track, starting from "I want to implement a server",
and "I want to implement a *news* server, specifically".

Thanks for the help,
Paul.

-- 
This signature intentionally left blank



From abo at minkirri.apana.org.au  Mon Oct 21 16:43:02 2002
From: abo at minkirri.apana.org.au (Donovan Baarda)
Date: Tue, 22 Oct 2002 08:43:02 +1000
Subject: [Twisted-Python] Addition to twisted.python.logfile
In-Reply-To: <20021021080910.19374.qmail@green.zadka.com>
References: <20021017195851.GA29573@pyramid.twistedmatrix.com> <3DAF1916.50001@cubik.org> <20021020185952.GB23670@ki.yok.utu.fi> <20021020.145354.88473634.glyph@twistedmatrix.com> <20021021001305.GC13974@minkirri.apana.org.au> <20021021080910.19374.qmail@green.zadka.com>
Message-ID: <20021021224302.GA15902@minkirri.apana.org.au>

On Mon, Oct 21, 2002 at 08:09:10AM -0000, Moshe Zadka wrote:
> On Mon, 21 Oct 2002, Christopher Armstrong <radix at twistedmatrix.com> wrote:
> 
> > Hey, I forgot zlib could do that. That's really cool (And I'd
> > recommend doing it that way, barring any issues with it (and "it's not
> > UNIXy" isn't an issue, afaic ;))).
> 
> I fail to see why this is a good idea. The gzip method would work on UNIX
> with much simpler code, and will be far more efficient.

Actually, I'm not sure that this is true. The guy developing rdiff-backup
was using the rdiff command in this way and found that the process-spawning
overhead was slowing things down heaps. By changing to using an rdiff python
module he got significant speedups.


-- 
----------------------------------------------------------------------
ABO: finger abo at minkirri.apana.org.au for more info, including pgp key
----------------------------------------------------------------------



From andrew-twisted at puzzling.org  Mon Oct 21 17:34:06 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 22 Oct 2002 09:34:06 +1000
Subject: [Twisted-Python] Completely new to twisted - where to get some background?
In-Reply-To: <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk> <20021020233435.GA15094@meson.dyndns.org> <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk>
Message-ID: <20021021233406.GA8461@ritsuko.xware.cx>

On Mon, Oct 21, 2002 at 08:48:01PM +0100, Paul Moore wrote:
> Jp Calderone <exarkun at meson.dyndns.org> writes:
> 
> >   Twisted is definitely suited for this :)  I'm not aware of a document that
> > is directly relevant to what you want to do, because it's not too deeply
> > related to Twisted.  Hopefully what needs to be done will be clear after you
> > check out the code I mentioned above.  
> 
> Indeed, it became a lot clearer, very fast. I was getting bogged down
> in concepts (Perspective Broker, reactors...) which didn't seem
> relevant to me (and weren't, as it happened). Maybe some sort of

The CVS version of Twisted now has a glossary in the docs -- the idea
being that you'd be able to say "Perspective Broker?  What the hell is
that?  <check glossary>... Oh, ok, that's something else, so I can
ignore that...".  I'd be interested to know if it really is useful for
you?

> documentation roadmap ("If you are trying to do XXX, then start with
> documents YYY, ZZZ") would be useful. Your suggestions certainly got
> me on the right track, starting from "I want to implement a server",
> and "I want to implement a *news* server, specifically".

Of course, then there's all the variations -- "I want to implement a
{mail,web,finger,etc} server" -- which is an awful lot of documentation.
If you'd like to help us by writing a the "I want to implement a news
server" doc, that would help alot :)

-Andrew.




From glyph at twistedmatrix.com  Mon Oct 21 22:52:19 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 21 Oct 2002 23:52:19 -0500 (CDT)
Subject: [Twisted-Python] ANN: Make A Little Framework In Your Soul
Message-ID: <20021021.235219.55512630.glyph@twistedmatrix.com>


BOSTON, MASSACHUSETTS (PSU) -- OCTOBER 21, 2002 -- Darkness shrouds the
horizon, and thunderclouds boom overhead.  Is this just normal northeastern
weather, or something else... something far more sinister?  A milestone release
-- Development Platform 1.0.0 -- of the Twisted Network Framework is available
today indicates a potential major surge in the Reality Distortion Field (RDF)
that surrounds it.

Glyph Lefkowitz, who claims to be in this region of the country to "visit his
girlfriend", has been using the internet to remain connected to the
loosely-connected internet development group known only as "Twisted Matrix
Labs".  Glyph had a few comments on the new release.

"With the 1.0.0 release, Twisted has reached an important milestone in its
maturity," he said from an undisclosed location.  "Twisted is an incredible
specimen of internet technology, as powerful as it is robust, all at once the
most beautiful and terrifying thing you have ever seen."  Further comments
dissolved bursts of static and incoherent babbling.

Other leading members of the Twisted team were equally pleased with the
project's progress.  Itamar Shtull-Trauring spoke highly of it, saying "GIMME
THE CASH OR THE GIRL GETS IT!".  After he recovered his wits and freed the
hostages, Mr. Shtull-Trauring's attorney relayed a revised analysis of
Twisted's progress: "Super-atomic-nanotechnology-now-with-extra-whammo
batteries included!".

More information and downloads are available at:

    http://www.twistedmatrix.com/

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021021/f41c4994/attachment.sig>

From twisted at itamarst.org  Mon Oct 21 23:00:31 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 01:00:31 -0400
Subject: [Twisted-Python] ANN: Twisted 1.0
Message-ID: <20021022010031.2ebdb060.twisted@itamarst.org>

It has come to our attention that someone is impersonating Glyph and
posting false release announcements. Please ignore any such obvious
fakes.

The real press release for 1.0 is available from:
http://www.zoteca.com/Press/prtwisted10.pdf

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From bruce at cubik.org  Tue Oct 22 03:59:17 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Tue, 22 Oct 2002 03:59:17 -0600
Subject: [Twisted-Python] Twisted and the Torque Game Engine
References: <000801c276a7$b0c9b3e0$0200000a@spunk>
Message-ID: <3DB52175.8010102@cubik.org>

Joshua Ritter wrote:
> I wrote a TorqueReactor for Twisted(quite trivial), the only time killer 
> was running into a FPU precision problem...

Would you mind sharing the code that you used to fix that precision problem?

  - Bruce




From twisted at moshez.org  Tue Oct 22 07:18:08 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 22 Oct 2002 13:18:08 -0000
Subject: [Twisted-Python] New Documentation Stuff
Message-ID: <20021022131808.4282.qmail@green.zadka.com>

OK, so after a few more iteration, the Twisted book is starting to stop
looking like a first-grader fingerpainting excercise stuck with magnets to
the refrigerator and instead now has that sleek, polished and professional
look you'd expect from a sixth-grader. 

Enjoy: http://twistedmatrix.com/users/moshez/book.{ps.bz2,pdf}

As a side effect, generate-domdocs has acquired to ability to generate
table of contents. You will notice it in the documentation for the next
release (1.0.1). Also, the hand-coded ToCs from the pb-*.html stuff have
been mercilessly ripped out.

What's in store? I'm hoping my (or someone else) will add an ability to do
footnotes, so the hand-hacked footnote stuff can start going away. The
second thing to do is to add indexing support to generate-domdocs, and starting
to put in index stuff (this is hard work!). On my part, I will keep the 
LaTeX generation stuff up to date with the generate-domdocs stuff, so that
our users can choose both HTML and more paper oriented formats.



From david at lupercalia.net  Tue Oct 22 10:06:42 2002
From: david at lupercalia.net (David Merrill)
Date: Tue, 22 Oct 2002 11:06:42 -0500
Subject: [Twisted-Python] Lampadas, the LDP document management system
Message-ID: <200210221106.43573.david@lupercalia.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I'm the lead developer on Lampadas, a document management system being 
built for the LDP and the Gnome Documentation Project. And of course 
anybody else who wants to use it.

For the last month I've been working on persistent objects, but eventually 
realized I was better off looking for an existing library instead, which 
brought me to Twisted. Looking through your code, I am very impressed 
with your work. It's very good quality, very flexible, and also very much 
aligned with what I want and need for Lampadas. So I'm very seriously 
considering a port to Twisted. If I determine that Lampadas can be 
successfully implemented on a Twisted architecture, I will adopt it.

I could really use some help in decomposing Lampadas into a Twisted 
architecture and getting over the initial hurdles. I'd like for my 
initial evaluation of Twisted to have the best possible chance of 
success, and not to get bogged down because of my own ignorance. Is there 
any kind soul who is willing to discuss Lampadas' specific goals and its 
functionality, and how to best implement them in Twisted?

One system I know Lampadas will rely on extensively is the new 
enterprise.journal system, so I think I want to try implementing a 
journal-based service for Lampadas objects. Since journal is just getting 
off the ground, such a service would be a good test of journal's 
capabilities, and I'd be willing to help on journal development as well. 
Is there any interest in that?

- -- 
David C. Merrill                         http://www.lupercalia.net
Linux Documentation Project                   david at lupercalia.net
Lead Developer                                 http://www.tldp.org

How often it is that the angry man rages denial of what his inner self is
telling him.
	-- "The Collected Sayings of Muad'Dib" by the Princess Irulan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.0 (GNU/Linux)

iD8DBQE9tXeSWC4Sq/MWsY0RAvciAJ9IFqx8sRBpZTqu+Uidg6KRAfEk3ACfTi/w
Jr+F0gUylG3jH3g70p2r67Q=
=KYyN
-----END PGP SIGNATURE-----




From radix at twistedmatrix.com  Tue Oct 22 09:22:39 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 17:22:39 +0200
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <200210221106.43573.david@lupercalia.net>
References: <200210221106.43573.david@lupercalia.net>
Message-ID: <20021022152239.GE12550@twistedmatrix.com>

On Tue, Oct 22, 2002 at 11:06:42AM -0500, David Merrill wrote:
> I'm the lead developer on Lampadas, a document management system being 
> built for the LDP and the Gnome Documentation Project. And of course 
> anybody else who wants to use it.

Can you elaborate on what it does? "Document Management" doesn't
really scream "internet" at me, but you might say that a project I'm
working on (that's based on Twisted), TamTam, is somewhat aligned with
"document management". Also, generate-domdocs, the DOM-munging script
we use to generate documentation (based on XHTML content and
templates), also may be relevant (and it's getting better every month;
hopefully it'll be good enough to call it a separate project,
eventually).

I'm not promising to give a lot of help, but I'm interested, and just
coming out with it on the mailing list is probably the best strategy
for getting help. :)




From pobrien at orbtech.com  Tue Oct 22 09:29:18 2002
From: pobrien at orbtech.com (Patrick K. O'Brien)
Date: Tue, 22 Oct 2002 10:29:18 -0500
Subject: [Twisted-Python] ANN: Twisted 1.0
In-Reply-To: <20021022010031.2ebdb060.twisted@itamarst.org>
References: <20021022010031.2ebdb060.twisted@itamarst.org>
Message-ID: <200210221029.18570.pobrien@orbtech.com>

On Tuesday 22 October 2002 12:00 am, Itamar Shtull-Trauring wrote:
> The real press release for 1.0 is available from:
> http://www.zoteca.com/Press/prtwisted10.pdf

I tried to access the white paper mentioned in the press release, but was 
denied access to it:

http://www.zoteca.com/wp/zbefull.pdf

Is there a way to get to it?

-- 
Patrick K. O'Brien
Orbtech      http://www.orbtech.com/web/pobrien
-----------------------------------------------
"Your source for Python programming expertise."
-----------------------------------------------




From radix at twistedmatrix.com  Tue Oct 22 09:38:27 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 17:38:27 +0200
Subject: [Twisted-Python] Creating an SSH client programatically with Twisted?
In-Reply-To: <200210211856.g9LIulJ67077@cgi-works.com>
References: <200210211856.g9LIulJ67077@cgi-works.com>
Message-ID: <20021022153827.GG12550@twistedmatrix.com>

On Sun, Oct 20, 2002 at 07:02:34AM +1857, Max Schubert wrote:
>     I have looked at the documentation, the twisted.conch.ssh.* classes,
>     and the test_conch.py script and am still having a hard time figuring
>     out how to construct an SSH client using Twisted.
> 
>     Does anyone have pointers to examples or documentation that will help
>     me do this?

Check out the writing clients document at
http://twistedmatrix.com/documents/howto/clients. Conch is only a
server, and the implementation is pretty new, so there's not any
documents on what you're trying to do in particular. You'll have to
resort to really diving into the code.

If you have any specific questions, feel free to ask.




From pythondork at cgi-works.com  Tue Oct 22 10:06:41 2002
From: pythondork at cgi-works.com (Max Schubert)
Date: Tue, 22 Oct 2002 12:14:04 +50579034
Subject: [Twisted-Python] Creating an SSH client programatically with Twisted? 
Message-ID: <200210221608.g9MG8MJ07637@cgi-works.com>

Hi,

    Thank you for the information and help.  Paul Swartz sent me an SSH
    client he has written and mentioned that he might be doing some more
    client examples and documentation for the conch module at some point.

Max

On Tue, 22 Oct 2002 17:38:27 +0200, Christopher Armstrong wrote:
> On Sun, Oct 20, 2002 at 07:02:34AM +1857, Max Schubert wrote:
> >     I have looked at the documentation, the twisted.conch.ssh.* classes,
> >     and the test_conch.py script and am still having a hard time figuring
> >     out how to construct an SSH client using Twisted.
> > 
> >     Does anyone have pointers to examples or documentation that will help
> >     me do this?
> 
> Check out the writing clients document at
> http://twistedmatrix.com/documents/howto/clients. Conch is only a
> server, and the implementation is pretty new, so there's not any
> documents on what you're trying to do in particular. You'll have to
> resort to really diving into the code.
> 
> If you have any specific questions, feel free to ask.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From david at lupercalia.net  Tue Oct 22 11:19:29 2002
From: david at lupercalia.net (David Merrill)
Date: Tue, 22 Oct 2002 12:19:29 -0500
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <20021022152239.GE12550@twistedmatrix.com>
References: <200210221106.43573.david@lupercalia.net> <20021022152239.GE12550@twistedmatrix.com>
Message-ID: <200210221219.30924.david@lupercalia.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Tuesday 22 October 2002 10:22, Christopher Armstrong wrote:
> On Tue, Oct 22, 2002 at 11:06:42AM -0500, David Merrill wrote:
> > I'm the lead developer on Lampadas, a document management system
> > being built for the LDP and the Gnome Documentation Project. And of
> > course anybody else who wants to use it.
>
> Can you elaborate on what it does? "Document Management" doesn't
> really scream "internet" at me, but you might say that a project I'm
> working on (that's based on Twisted), TamTam, is somewhat aligned with
> "document management". Also, generate-domdocs, the DOM-munging script
> we use to generate documentation (based on XHTML content and
> templates), also may be relevant (and it's getting better every month;
> hopefully it'll be good enough to call it a separate project,
> eventually).

Lampadas is designed for the LDP, so if you think about what is involved 
in publishing such a website, you'll get the idea. However, it aims to go 
beyond the current LDP, or why bother? Let me break it down a bit...

The LDP has nearly 700 documents. Some are in text, some in LinuxDoc SGML, 
some in DocBook SGML, some in DocBook XML. Lampadas has to let our staff 
manage them, publish them all in html and other downloadable formats, and 
also publish additional pages that make up our website. So essentially it 
is a documentation meta-data management system + a publishing system + a 
simple content management system.

Architecturally, it is a postgresql database with a documentation object 
layer and a web content object layer, then various clients built on the 
object layers. The website is such a client, as is the publisher. A 
mirroring client mirrors documents from other projects (GNU manuals, 
GNOME documentation, and the Jargon file are the initial targets.)

There's a bit more to it than that, and additional things are planned, but 
that's the core of it.

There's a demo running at http://www.lampadas.org. Performance is abysmal 
since it's now running on my partially implemented persistence system and 
is hitting the database waaaaay too often, but it generally works.

- -- 
David C. Merrill                         http://www.lupercalia.net
Linux Documentation Project                   david at lupercalia.net
Lead Developer                                 http://www.tldp.org

The most important bill in our whole code is that for the diffusion of
knowledge among the people.  No other sure foundation can be devised, for
the preservation of freedom and happiness.
	-- Thomas Jefferson
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.0 (GNU/Linux)

iD8DBQE9tYihWC4Sq/MWsY0RAjPfAJ4kqM8v+fhqtIT/E4bwLjjORRhJ4QCfVonA
YyvmDKCM1rWq7ZeicPPwQMU=
=D5Wy
-----END PGP SIGNATURE-----




From radix at twistedmatrix.com  Tue Oct 22 10:55:27 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 18:55:27 +0200
Subject: [Twisted-Python] Creating an SSH client programatically with Twisted?
In-Reply-To: <200210221608.g9MG8MJ07637@cgi-works.com>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
Message-ID: <20021022165527.GJ12550@twistedmatrix.com>

On Mon, Oct 21, 2002 at 04:14:04AM +1857, Max Schubert wrote:
> Hi,
> 
>     Thank you for the information and help.  Paul Swartz sent me an SSH
>     client he has written ...


I don't think Paul knows how to *stop* coding, zow!



From radix at twistedmatrix.com  Tue Oct 22 11:02:21 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 19:02:21 +0200
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <200210221219.30924.david@lupercalia.net>
References: <200210221106.43573.david@lupercalia.net> <20021022152239.GE12550@twistedmatrix.com> <200210221219.30924.david@lupercalia.net>
Message-ID: <20021022170221.GK12550@twistedmatrix.com>

On Tue, Oct 22, 2002 at 12:19:29PM -0500, David Merrill wrote:

> Lampadas is designed for the LDP, so if you think about what is involved 
> in publishing such a website, you'll get the idea. However, it aims to go 
> beyond the current LDP, or why bother? Let me break it down a bit...
> 
> The LDP has nearly 700 documents. Some are in text, some in LinuxDoc SGML, 
> some in DocBook SGML, some in DocBook XML. Lampadas has to let our staff 
> manage them, publish them all in html and other downloadable formats, and 
> also publish additional pages that make up our website. So essentially it 
> is a documentation meta-data management system + a publishing system + a 
> simple content management system.

Damn, this sounds like a perfect application for TamTam, too bad it's
not done yet :)

Oh well, I won't suggest that you wait for us to finish it :) but
perhaps in the future we can collaborate; I'll get in touch with you
when I think Tamtam is (nearly) robust enough to handle this use-case.

--
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From twisted at itamarst.org  Tue Oct 22 11:30:38 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 13:30:38 -0400
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <200210221106.43573.david@lupercalia.net>
References: <200210221106.43573.david@lupercalia.net>
Message-ID: <20021022133038.729047cf.twisted@itamarst.org>

On Tue, 22 Oct 2002 11:06:42 -0500
David Merrill <david at lupercalia.net> wrote:

> One system I know Lampadas will rely on extensively is the new 
> enterprise.journal system, so I think I want to try implementing a 
> journal-based service for Lampadas objects. Since journal is just
> getting off the ground, such a service would be a good test of
> journal's capabilities, and I'd be willing to help on journal
> development as well. Is there any interest in that?

Note that journal doesn't have to be RDBMS tied, it can work on in
memory objects only while still preserving durability ACID aspect. The
default RDBMS storage is tied to Twisted's row object/relational mapper,
but you can probably connect it to other object/relational mappers as
well.

I'd be very interested in people using it, and getting feedback and of
course code - look at the test code in latest CVS to see the newest
abstractions and utilities we came up with to make journal programming
easier.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From lists at morpheus.demon.co.uk  Tue Oct 22 11:49:09 2002
From: lists at morpheus.demon.co.uk (Paul Moore)
Date: Tue, 22 Oct 2002 18:49:09 +0100
Subject: [Twisted-Python] Some comments on twisted.news
Message-ID: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>

I just set up a basic demo new server using twisted. Some initial comments:

1. It took me almost no time to put together a basic dummy NNTP
   server. Just create the backend, put a mktap driver in, and it's
   working.

2. There seems to be a problem with the server class. It translates
   \r\n.. to \r\n. in the data the backend supplies - this should be
   the other way round (it should be *doubling* the dots, so that they
   don't look like the end of data marker to the client).

3. It would be nice if the server handled the translation to CRLF, so
   that backends could return data with lines separated by \n, and the
   server class would convert that to \r\n. After all, \n is the
   "normal" end of line character internal to Python code, and \r\n is
   a feature of the NNTP protocol, so the protocol driver should be
   responsible for the conversion (IMHO). Of course, this is a
   behaviour change, which could break existing backends, so maybe
   it's not practical to make this change.

4. The implementation of STAT requests the article from the
   backend. This could be inefficient if getting the message ID is
   cheap, but getting the full article is expensive for a particular
   backend (it will be for me). In my partly-implemented NNTP server
   written in "raw" Python (before I found Twisted) I had a backend
   method getArticle(..., head=1, body=1) which was used to implement
   all of HEAD, BODY, ARTICLE and STAT, just by setting different
   values for the head and body parameters (so the backend could check
   for the case where neither was required, and act accordingly).

(2) is obviously fairly trivial. I think I could implement (3) and
(4), if it would be useful. I could submit a patch, which would alter
the server code and the 2 existing backends (I couldn't test the
database backend, as I don't have a database to test with, but I could
test the pickle-based code). Would this be helpful? Are there likely
to be 3rd party nntp backends which would be broken by such a change?

Paul.

-- 
This signature intentionally left blank



From david at lupercalia.net  Tue Oct 22 13:04:46 2002
From: david at lupercalia.net (David Merrill)
Date: Tue, 22 Oct 2002 14:04:46 -0500
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <20021022133038.729047cf.twisted@itamarst.org>
References: <200210221106.43573.david@lupercalia.net> <20021022133038.729047cf.twisted@itamarst.org>
Message-ID: <200210221404.47231.david@lupercalia.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Tuesday 22 October 2002 12:30, Itamar Shtull-Trauring wrote:
> On Tue, 22 Oct 2002 11:06:42 -0500
>
> David Merrill <david at lupercalia.net> wrote:
> > One system I know Lampadas will rely on extensively is the new
> > enterprise.journal system, so I think I want to try implementing a
> > journal-based service for Lampadas objects. Since journal is just
> > getting off the ground, such a service would be a good test of
> > journal's capabilities, and I'd be willing to help on journal
> > development as well. Is there any interest in that?
>
> Note that journal doesn't have to be RDBMS tied, it can work on in
> memory objects only while still preserving durability ACID aspect. The
> default RDBMS storage is tied to Twisted's row object/relational
> mapper, but you can probably connect it to other object/relational
> mappers as well.

I just read the prevayler documentation and I've also scanned the journal 
code, so I have a pretty good idea how it's supposed to work in 
principle. I'll see if I can get something set up.

Do you have any sample client code anywhere that I can use as a model? 
Maybe you could add it to /doc/examples?

- -- 
David C. Merrill                         http://www.lupercalia.net
Linux Documentation Project                   david at lupercalia.net
Lead Developer                                 http://www.tldp.org

If you know the enemy and know yourself, you need not fear the result of
a hundred battles. If you know yourself but not the enemy, for every
victory gained you will also suffer a defeat. If you know neither the
enemy nor yourself, you will succumb in every battle.
	-- Sun Tzu, "The Art of War"
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.0 (GNU/Linux)

iD8DBQE9taFOWC4Sq/MWsY0RAll8AJ9aDu7LItHbt3/+9V2ds2Pmpr8xFQCeNYB3
telhNx3Ogmu9P93WipFEYAQ=
=ahSq
-----END PGP SIGNATURE-----




From twisted at itamarst.org  Tue Oct 22 12:12:32 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 14:12:32 -0400
Subject: [Twisted-Python] Lampadas, the LDP document management system
In-Reply-To: <200210221404.47231.david@lupercalia.net>
References: <200210221106.43573.david@lupercalia.net>
	<20021022133038.729047cf.twisted@itamarst.org>
	<200210221404.47231.david@lupercalia.net>
Message-ID: <20021022141232.4ee7eb8f.twisted@itamarst.org>

On Tue, 22 Oct 2002 14:04:46 -0500
David Merrill <david at lupercalia.net> wrote:

> Do you have any sample client code anywhere that I can use as a model?
> 
> Maybe you could add it to /doc/examples?

Look at twisted/test/test_journal.py - it's a pretty complete example of
modelling and then using a command-journalling system.

Eventually I will write docs - it's on my todo list.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From radix at twistedmatrix.com  Tue Oct 22 13:21:13 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 21:21:13 +0200
Subject: [Twisted-Python] Some comments on twisted.news
In-Reply-To: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
Message-ID: <20021022192113.GL12550@twistedmatrix.com>

On Tue, Oct 22, 2002 at 06:49:09PM +0100, Paul Moore wrote:
> (2) is obviously fairly trivial. I think I could implement (3) and
> (4), if it would be useful. I could submit a patch, which would alter
> the server code and the 2 existing backends (I couldn't test the
> database backend, as I don't have a database to test with, but I could
> test the pickle-based code). Would this be helpful? Are there likely
> to be 3rd party nntp backends which would be broken by such a change?

There certainly aren't any 3rd party backends yet, twisted.news is
still fairly new (and doesn't have any users, afaik, although some may
be lurking). I'd recommend implementing everything and waiting for
exarkun's approval (He may be a while, as he's visiting Minnesota
atm), but I really doubt he'll have any problems with it.

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From twisted at itamarst.org  Tue Oct 22 13:30:33 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 15:30:33 -0400
Subject: [Twisted-Python] HTML version of the press release
Message-ID: <20021022153033.33ea2cef.twisted@itamarst.org>

http://zoteca.com/Press/prtwisted10.html

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From radix at twistedmatrix.com  Tue Oct 22 13:36:36 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 22 Oct 2002 21:36:36 +0200
Subject: [Twisted-Python] ANN: Twisted 1.0
In-Reply-To: <200210221029.18570.pobrien@orbtech.com>
References: <20021022010031.2ebdb060.twisted@itamarst.org> <200210221029.18570.pobrien@orbtech.com>
Message-ID: <20021022193636.GM12550@twistedmatrix.com>

On Tue, Oct 22, 2002 at 10:29:18AM -0500, Patrick K. O'Brien wrote:
> I tried to access the white paper mentioned in the press release, but was 
> denied access to it:
> 
> http://www.zoteca.com/wp/zbefull.pdf
> 
> Is there a way to get to it?

That's been fixed.

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From pobrien at orbtech.com  Tue Oct 22 13:53:03 2002
From: pobrien at orbtech.com (Patrick K. O'Brien)
Date: Tue, 22 Oct 2002 14:53:03 -0500
Subject: [Twisted-Python] ANN: Twisted 1.0
In-Reply-To: <20021022193636.GM12550@twistedmatrix.com>
References: <20021022010031.2ebdb060.twisted@itamarst.org> <200210221029.18570.pobrien@orbtech.com> <20021022193636.GM12550@twistedmatrix.com>
Message-ID: <200210221453.03924.pobrien@orbtech.com>

On Tuesday 22 October 2002 02:36 pm, Christopher Armstrong wrote:
> On Tue, Oct 22, 2002 at 10:29:18AM -0500, Patrick K. O'Brien wrote:
> > I tried to access the white paper mentioned in the press release, but was
> > denied access to it:
> >
> > http://www.zoteca.com/wp/zbefull.pdf
> >
> > Is there a way to get to it?
>
> That's been fixed.

Great. Thanks.

-- 
Patrick K. O'Brien
Orbtech      http://www.orbtech.com/web/pobrien
-----------------------------------------------
"Your source for Python programming expertise."
-----------------------------------------------




From developer at csrules.dyndns.org  Tue Oct 22 15:17:14 2002
From: developer at csrules.dyndns.org (developer at csrules.dyndns.org)
Date: Tue, 22 Oct 2002 16:17:14 -0500 (CDT)
Subject: [Twisted-Python] Some comments on twisted.mail
In-Reply-To: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
Message-ID: <10209.209.5.243.3.1035321434.squirrel@seraphine.csrules.dyndns.org>

Just wondering if anyone uses twisted.mail as a mail server?

saw ZOE http://guests.evectors.it/zoe lately and wondered what it would
take to implement something like that with a twisted framework...

-Just wondrin.







From ritterjoshua at msn.com  Tue Oct 22 09:03:04 2002
From: ritterjoshua at msn.com (Joshua Ritter)
Date: Tue, 22 Oct 2002 10:03:04 -0500
Subject: [Twisted-Python] dbcred and MySQL Incompatibility
Message-ID: <000501c279dc$1ffb3cc0$0200000a@spunk>

MySQL requires that a single SQL statement be sent to query ...
transactional or not... http://www.mysql.com/doc/en/mysql_query.html

dbcred is incompatible with MySQL due to it's batching of ; delimited SQL
statements.  There is also such functionality in
enterprise.row.StatementBatch

createSchema() ; createIdentity() ; and removeIdentity() fail under MySQL
currently... once the SQL statements are seperated; I have verified them
working.

-J







From itamar at itamarst.org  Tue Oct 22 10:05:55 2002
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 22 Oct 2002 12:05:55 -0400
Subject: [Twisted-Python] ANN: Twisted 1.0
In-Reply-To: <200210221029.18570.pobrien@orbtech.com>
References: <20021022010031.2ebdb060.twisted@itamarst.org>
	<200210221029.18570.pobrien@orbtech.com>
Message-ID: <20021022120555.58b5c9eb.itamar@itamarst.org>

On Tue, 22 Oct 2002 10:29:18 -0500
"Patrick K. O'Brien" <pobrien at orbtech.com> wrote:

> I tried to access the white paper mentioned in the press release, but
> was denied access to it:
> 
> http://www.zoteca.com/wp/zbefull.pdf

I removed the password.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From gustav at morpheus.demon.co.uk  Tue Oct 22 12:11:31 2002
From: gustav at morpheus.demon.co.uk (Paul Moore)
Date: Tue, 22 Oct 2002 19:11:31 +0100
Subject: [Twisted-Python] Completely new to twisted - where to get some
 background?
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk> <20021020233435.GA15094@meson.dyndns.org>
 <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk>
 <20021021233406.GA8461@ritsuko.xware.cx>
Message-ID: <n2m-g.vg3upcmk.fsf@morpheus.demon.co.uk>

Andrew Bennetts <andrew-twisted at puzzling.org> writes:

> The CVS version of Twisted now has a glossary in the docs -- the idea
> being that you'd be able to say "Perspective Broker?  What the hell is
> that?  <check glossary>... Oh, ok, that's something else, so I can
> ignore that...".  I'd be interested to know if it really is useful for
> you?

I can't easily get at the CVS version, but I suspect something like
that would have been useful. I've just had a brief look at the book
Moshe has mentioned on the list, and that looks helpful, too.

It's one of those chicken and egg situations - once the arrangement
"clicks", it's hard to see why it seemed so complicated.

> Of course, then there's all the variations -- "I want to implement a
> {mail,web,finger,etc} server" -- which is an awful lot of documentation.

Yes. I nearly didn't mention specific server types, because that's
what causes the explosion of cases. And just saying "I want to write a
server", and not finding it obvious that you look at the "Writing
Servers" document is just plain dumb (I'm working on a decent excuse
for being this stupid :-))

> If you'd like to help us by writing a the "I want to implement a news
> server" doc, that would help alot :)

I'll do what I can. But I'm now not sure of the benefit. There isn't
so much a learning curve with Twisted as a speed bump - at first
glance, you're not sure what you're looking at, but suddenly you
wonder what the difficulty was, and then you're off!

I'll think about whether I'd have found a conspicuous "Start Here"
document any use, and if so, I'll have a go at writing it :-)

Paul.

-- 
This signature intentionally left blank



From z3p at twistedmatrix.com  Tue Oct 22 17:24:47 2002
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Tue, 22 Oct 2002 19:24:47 -0400
Subject: [Twisted-Python] Some comments on twisted.mail
In-Reply-To: <10209.209.5.243.3.1035321434.squirrel@seraphine.csrules.dyndns.org>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
Message-ID: <3DB5A5FF.6853.1341CA5@localhost>

On 22 Oct 2002 at 16:17, 
developer at csrules.dyndns.org wrote:

> Just wondering if anyone uses twisted.mail as a mail server?
> 
> saw ZOE http://guests.evectors.it/zoe lately and wondered what it would
> take to implement something like that with a twisted framework...
> 
> -Just wondrin.

Other people have had this idea after seeing ZOE.  
I don't know what the current status of t.mail is, 
but I doubt it would be hard to make it functional 
enough to use for that type of app.
-p

-- 
     Paul Swartz
(o_  http://twistedmatrix.com/users/z3p.twistd/
//\  z3p at twistedmatrix.com
V_/_ AIM: Z3Penguin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20021022/67b910c1/attachment.html>

From z3p at twistedmatrix.com  Tue Oct 22 17:45:44 2002
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Tue, 22 Oct 2002 19:45:44 -0400
Subject: [Twisted-Python] Creating an SSH client programatically with Twisted? 
In-Reply-To: <200210221608.g9MG8MJ07637@cgi-works.com>
Message-ID: <3DB5AAE8.1831.147483D@localhost>

On 22 Oct 2002 at 12:14, Max Schubert wrote:

> Hi,
> 
>     Thank you for the information and help.  Paul Swartz sent me an SSH
>     client he has written and mentioned that he might be doing some more
>     client examples and documentation for the conch module at some point.
> 
> Max

As promised, I've attached a simple SSH client.  
It connects to a server, and runs three programs: 
true, false, and echo.  It tries to use a DSA 
public key in ~/.ssh/id_dsa[.pub] for 
authentication but falls back to asking for a 
password.  I'll be putting this in CVS soon, but 
you saw it here first :)
-p

-- 
     Paul Swartz
(o_  http://twistedmatrix.com/users/z3p.twistd/
//\  z3p at twistedmatrix.com
V_/_ AIM: Z3Penguin

-------------- next part --------------
The following section of this message contains a file attachment
prepared for transmission using the Internet MIME message format.
If you are using Pegasus Mail, or any another MIME-compliant system,
you should be able to save it or view it from within your mailer.
If you cannot, please ask your system administrator for assistance.

   ---- File information -----------
     File:  simple_ssh.py
     Date:  22 Oct 2002, 19:41
     Size:  2909 bytes.
     Type:  Text
-------------- next part --------------
A non-text attachment was scrubbed...
Name: simple_ssh.py
Type: application/octet-stream
Size: 2909 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021022/d3a78831/attachment-0002.obj>

From developer at csrules.dyndns.org  Tue Oct 22 18:00:45 2002
From: developer at csrules.dyndns.org (developer at csrules.dyndns.org)
Date: Tue, 22 Oct 2002 19:00:45 -0500 (CDT)
Subject: [Twisted-Python] Components
In-Reply-To: <3DB5AAE8.1831.147483D@localhost>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
        <3DB5AAE8.1831.147483D@localhost>
Message-ID: <1840.192.168.2.20.1035331245.squirrel@seraphine.csrules.dyndns.org>

I'm new to twisted. So just jump up and slap me if necessary.
But i'm reading the new "book" (all hail moshez) and
reading about PB. Now micro$oft has alot of information
out there about writing component based appliations
whereby you expose your business object through COM.
Would PB be considered a competing technology for this?
Could i wrap my business objects with PB and expose them
this way?

-newbie...





From andrew-twisted at puzzling.org  Tue Oct 22 18:54:19 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 23 Oct 2002 10:54:19 +1000
Subject: [Twisted-Python] New Documentation Stuff
In-Reply-To: <20021022131808.4282.qmail@green.zadka.com>
References: <20021022131808.4282.qmail@green.zadka.com>
Message-ID: <20021023005419.GA29244@ritsuko.xware.cx>

On Tue, Oct 22, 2002 at 01:18:08PM -0000, Moshe Zadka wrote:
> 
> What's in store? I'm hoping my (or someone else) will add an ability
> to do footnotes, so the hand-hacked footnote stuff can start going

There's a reasonable chance I'll do that fairly soon, but I offer no
guarantees here :)

-Andrew.




From andrew-twisted at puzzling.org  Tue Oct 22 19:09:17 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 23 Oct 2002 11:09:17 +1000
Subject: [Twisted-Python] Completely new to twisted - where to get some background?
In-Reply-To: <n2m-g.vg3upcmk.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98ucazk.fsf@morpheus.demon.co.uk> <20021020233435.GA15094@meson.dyndns.org> <n2m-g.lm4ra80e.fsf@morpheus.demon.co.uk> <20021021233406.GA8461@ritsuko.xware.cx> <n2m-g.vg3upcmk.fsf@morpheus.demon.co.uk>
Message-ID: <20021023010917.GB29244@ritsuko.xware.cx>

On Tue, Oct 22, 2002 at 07:11:31PM +0100, Paul Moore wrote:
> Andrew Bennetts <andrew-twisted at puzzling.org> writes:
> 
> > The CVS version of Twisted now has a glossary in the docs -- the idea
> > being that you'd be able to say "Perspective Broker?  What the hell is
> > that?  <check glossary>... Oh, ok, that's something else, so I can
> > ignore that...".  I'd be interested to know if it really is useful for
> > you?
> 
> I can't easily get at the CVS version, but I suspect something like
> that would have been useful. I've just had a brief look at the book
> Moshe has mentioned on the list, and that looks helpful, too.

The easiest way to get to the CVS docs is Moshe's book -- he generates
it from the CVS ones, so it includes the glossary :)

> It's one of those chicken and egg situations - once the arrangement
> "clicks", it's hard to see why it seemed so complicated.

Excellent :)

-Andrew.




From glyph at twistedmatrix.com  Tue Oct 22 19:31:40 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 22 Oct 2002 20:31:40 -0500 (CDT)
Subject: [Twisted-Python] dbcred and MySQL Incompatibility
In-Reply-To: <000501c279dc$1ffb3cc0$0200000a@spunk>
References: <000501c279dc$1ffb3cc0$0200000a@spunk>
Message-ID: <20021022.203140.21955151.glyph@twistedmatrix.com>

On Tue, 22 Oct 2002 10:03:04 -0500, "Joshua Ritter" <ritterjoshua at msn.com> wrote:
> createSchema() ; createIdentity() ; and removeIdentity() fail under MySQL
> currently... once the SQL statements are seperated; I have verified them
> working.

Can you perhaps write a patch which separates the statements or implements
StatementBatch so that it's MySQL friendly?  Thanks.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021022/6b0d7d40/attachment.sig>

From glyph at twistedmatrix.com  Tue Oct 22 19:33:31 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 22 Oct 2002 20:33:31 -0500 (CDT)
Subject: [Twisted-Python] Creating an SSH client programatically with
 Twisted? 
In-Reply-To: <3DB5AAE8.1831.147483D@localhost>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
	<3DB5AAE8.1831.147483D@localhost>
Message-ID: <20021022.203331.26095706.glyph@twistedmatrix.com>

On Tue, 22 Oct 2002 19:45:44 -0400, "Paul Swartz" <z3p at twistedmatrix.com> wrote:
> As promised, I've attached a simple SSH client.  

WHAT ARE YOU, SOME KIND OF MACHINE!?!

:-)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021022/62ed56f1/attachment.sig>

From glyph at twistedmatrix.com  Tue Oct 22 19:40:04 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 22 Oct 2002 20:40:04 -0500 (CDT)
Subject: [Twisted-Python] Components
In-Reply-To: <1840.192.168.2.20.1035331245.squirrel@seraphine.csrules.dyndns.org>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
	<3DB5AAE8.1831.147483D@localhost>
	<1840.192.168.2.20.1035331245.squirrel@seraphine.csrules.dyndns.org>
Message-ID: <20021022.204004.122593650.glyph@twistedmatrix.com>


On Tue, 22 Oct 2002 19:00:45 -0500 (CDT), <developer at csrules.dyndns.org> wrote:

> Could i wrap my business objects with PB and expose them [as with COM]?

Not quite.  Insofar as PB is a "competing technology", it is competing with
DCOM, not COM.  Think of it like this: COM:DCOM::Python:PB.  COM is an object
model; Python is an object model.  You can give your objects COM stubs or you
can give them Python wrappers.  Then, you can publish Python objects by
wrapping them with pb.Referenceable or doing the appropriate DCOM things.

However, as MSFT is no longer pushing DCOM, and instead focusing on SOAP, you
can see it as "competing" with that standard.

This metaphor is not perfect, but it should give you a better idea.  PB is
specifically for objects communicating over "long" distances, between
segregated "vats" of objects (c.f. http://www.erights.org/) and not to provide
function pointers between objects that live in the same address space.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021022/a6f144f0/attachment.sig>

From developer at csrules.dyndns.org  Tue Oct 22 19:49:32 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Tue, 22 Oct 2002 20:49:32 -0500 (CDT)
Subject: [Twisted-Python] Components
In-Reply-To: <20021022.204004.122593650.glyph@twistedmatrix.com>
References: <200210221608.g9MG8MJ07637@cgi-works.com>
        <3DB5AAE8.1831.147483D@localhost>
        <1840.192.168.2.20.1035331245.squirrel@seraphine.csrules.dyndns.org>
        <20021022.204004.122593650.glyph@twistedmatrix.com>
Message-ID: <2079.192.168.2.20.1035337772.squirrel@seraphine.csrules.dyndns.org>

I think actually that I tend to get terminology messed (as i'm not a
programmer by trade) and what you describe is what i meant.

Thanks!

I've been reviewing the mailing list archives. Specifically I've written
some "applications" based on zope. Basically some database stuff with zope
managing the views to the data. I'm encouraged to see (in the archives) that
there seems to be some interest in melding zope and twisted in some way.

-Darryl


> On Tue, 22 Oct 2002 19:00:45 -0500 (CDT), <developer at csrules.dyndns.org>
> wrote:
>
>> Could i wrap my business objects with PB and expose them [as with
>> COM]?
>
> Not quite.  Insofar as PB is a "competing technology", it is competing
> with DCOM, not COM.  Think of it like this: COM:DCOM::Python:PB.  COM is
> an object model; Python is an object model.  You can give your objects
> COM stubs or you can give them Python wrappers.  Then, you can publish
> Python objects by wrapping them with pb.Referenceable or doing the
> appropriate DCOM things.
>
> However, as MSFT is no longer pushing DCOM, and instead focusing on
> SOAP, you can see it as "competing" with that standard.
>
> This metaphor is not perfect, but it should give you a better idea.  PB
> is specifically for objects communicating over "long" distances, between
> segregated "vats" of objects (c.f. http://www.erights.org/) and not to
> provide function pointers between objects that live in the same address
> space.
>
> --
>  |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
>  |   < _/ >   |  Lead Developer,  the Twisted project  |
>  |  < ___/ >  |      http://www.twistedmatrix.com      |






From kkennedy at kenzoid.com  Tue Oct 22 22:34:42 2002
From: kkennedy at kenzoid.com (Ken Kennedy)
Date: Wed, 23 Oct 2002 00:34:42 -0400
Subject: [Twisted-Python] Error using mktap for ResourceTemplates
Message-ID: <20021023043441.GB11598@kenzoid.com>

I'm getting an error with both the 1.0.0-1 Debian package (congrats on
1.0, BTW!...and many, many thanks for the up-to-date debs.) and
current CVS when I try to use the mktap --processor flag suggested in
doc/howto/resource-templates.html

 mktap web --processor=.rtl=twisted.web.script.ResourceTemplate 
 
'NoneType' object has no attribute 'processors'
Usage: mktap web [options]...etc.

I'll look into it myself in the morning, but I wanted to see if anyone
else had noticed this. Quixote/Twisted interaction possibilities look
excellent to me!

-- 

Ken Kennedy	| http://www.kenzoid.com	| kenzoid at io.com



From twisted at moshez.org  Tue Oct 22 22:44:02 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 23 Oct 2002 04:44:02 -0000
Subject: [Twisted-Python] Error using mktap for ResourceTemplates
In-Reply-To: <20021023043441.GB11598@kenzoid.com>
References: <20021023043441.GB11598@kenzoid.com>
Message-ID: <20021023044402.14829.qmail@green.zadka.com>

On Wed, 23 Oct 2002 00:34:42 -0400, kkennedy at kenzoid.com (Ken Kennedy) wrote:
> I'm getting an error with both the 1.0.0-1 Debian package (congrats on
> 1.0, BTW!...and many, many thanks for the up-to-date debs.) and
> current CVS when I try to use the mktap --processor flag suggested in
> doc/howto/resource-templates.html
> 
>  mktap web --processor=.rtl=twisted.web.script.ResourceTemplate 

I do believe the man page tells you to supply a "--root" argument
before the --processor argument.



From twisted at moshez.org  Wed Oct 23 00:56:12 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 23 Oct 2002 06:56:12 -0000
Subject: [Twisted-Python] Documentation: Footnotes [Yay]
Message-ID: <20021023065612.16087.qmail@green.zadka.com>

So, we now have footnote support, and I fixed all documents[1][2] to take
advantage of it. Hopefully, this will make the next version of the book
even better than ever before.

Indexes are still not supported, but should be even easier to add.

[1]
Except pb-cred.html and pb-tour.html, which use footnotes for unfootnotish
stuff, and thus should be revamped by their author.

[2]
See! I told you we have footnote support



From ritterjoshua at msn.com  Tue Oct 22 23:14:04 2002
From: ritterjoshua at msn.com (Joshua Ritter)
Date: Wed, 23 Oct 2002 00:14:04 -0500
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
Message-ID: <000501c27a53$026ce380$0200000a@spunk>


First the stuff that makes sense:

---

Firebird doesn't like batched SQL statements in a single string any better
than MySQL does...

Also it doesn't like the Primary Key in dbcred's schema not being specified
as NOT NULL

In twisted_identities:

identity_name     varchar(64) NOT NULL PRIMARY KEY

In twisted_services:

service_name      varchar(64) NOT NULL PRIMARY KEY

---

Now for something weird...

Firebird chokes in CREATE TABLE twisted_identities on the password column...
by changing the name to identity_password it works?!?!?!?!?

-J








From dstone at kde.org  Wed Oct 23 01:05:12 2002
From: dstone at kde.org (Daniel Stone)
Date: Wed, 23 Oct 2002 17:05:12 +1000
Subject: [Twisted-Python] Documentation: Footnotes [Yay]
In-Reply-To: <20021023065612.16087.qmail@green.zadka.com>
References: <20021023065612.16087.qmail@green.zadka.com>
Message-ID: <20021023070512.GA24164@trinity.unimelb.edu.au>

On Wed, Oct 23, 2002 at 06:56:12AM -0000, Moshe Zadka scrawled:
> [1]
> Except pb-cred.html and pb-tour.html, which use footnotes for unfootnotish
> stuff, and thus should be revamped by their author.
> 
> [2]
> See! I told you we have footnote support

There are better formats[1]. Yours sucks.

-d

[1]: Like this. Newline, my arse.

-- 
Daniel Stone 	     <daniel at raging.dropbear.id.au>             <dstone at kde.org>
Developer - http://kopete.kde.org, http://www.kde.org
Proof BitMover are community-focussed:
http://marc.theaimsgroup.com/?l=linux-kernel&m=103384262016750&w=2
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021023/dfe0d574/attachment.sig>

From bruce at cubik.org  Wed Oct 23 05:53:11 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 23 Oct 2002 05:53:11 -0600
Subject: [Twisted-Python] Error using mktap for ResourceTemplates
References: <20021023043441.GB11598@kenzoid.com> <20021023044402.14829.qmail@green.zadka.com>
Message-ID: <3DB68DA7.3000804@cubik.org>

Moshe Zadka wrote:
> On Wed, 23 Oct 2002 00:34:42 -0400, kkennedy at kenzoid.com (Ken Kennedy) wrote:
> 
>>I'm getting an error with both the 1.0.0-1 Debian package (congrats on
>>1.0, BTW!...and many, many thanks for the up-to-date debs.) and
>>current CVS when I try to use the mktap --processor flag suggested in
>>doc/howto/resource-templates.html
>>
>> mktap web --processor=.rtl=twisted.web.script.ResourceTemplate 
> 
> I do believe the man page tells you to supply a "--root" argument
> before the --processor argument.

It still shouldn't error.  I've filed a bug in the SF tracker for this.

Ken, thanks for reporting the bug!

  - Bruce




From glyph at twistedmatrix.com  Wed Oct 23 06:03:22 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 23 Oct 2002 07:03:22 -0500 (CDT)
Subject: [Twisted-Python] Error using mktap for ResourceTemplates
In-Reply-To: <3DB68DA7.3000804@cubik.org>
References: <20021023043441.GB11598@kenzoid.com>
	<20021023044402.14829.qmail@green.zadka.com>
	<3DB68DA7.3000804@cubik.org>
Message-ID: <20021023.070322.41191083.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 05:53:11 -0600, Bruce Mitchener <bruce at cubik.org> wrote:
> It still shouldn't error.  I've filed a bug in the SF tracker for this.

I just "fixed" this, using the existing idioms available used in mktap, but I
noticed 2 other problems while doing so.

 - currently the only idiom for reporting this sort of simple error is "print
   'foo'; sys.exit(2)".  This isn't really optimal, since we're hopefully going
   to be using twisted.tap through a non-commandline interface at some point,
   and the failure should be a formattable, self-contained exception.

 - the help message for almost every "tap" script is quite long, and so it's
   very easy to lose the default error reporting.  Perhaps it would be more
   useful in the common case to print exception/error information _after_ the
   help message, rather than before it, when there is a problem?

Thoughts?

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021023/d755d27a/attachment.sig>

From glyph at twistedmatrix.com  Wed Oct 23 06:07:03 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 23 Oct 2002 07:07:03 -0500 (CDT)
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
In-Reply-To: <000501c27a53$026ce380$0200000a@spunk>
References: <000501c27a53$026ce380$0200000a@spunk>
Message-ID: <20021023.070703.112268121.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 00:14:04 -0500, "Joshua Ritter" <ritterjoshua at msn.com> wrote:
> Firebird chokes in CREATE TABLE twisted_identities on the password column...
> by changing the name to identity_password it works?!?!?!?!?

It's almost certainly wrong, but the first thing that occurs to me is:

    twistedidentities
    identitypassword
       ^   ^   ^   ^   ^
       4   8   12  16  18

twisted_identities has more than 16 alphanumeric characters in it, whereas
identity_password has exactly 16.  Is this a hard limit in firebird, by chance?
;-)

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021023/fab489f5/attachment.sig>

From john.abel at pa.press.net  Wed Oct 23 06:32:21 2002
From: john.abel at pa.press.net (John Abel)
Date: Wed, 23 Oct 2002 13:32:21 +0100
Subject: [Twisted-Python] Threading WIth Twisted
References: <20021023.070703.112268121.glyph@twistedmatrix.com>
Message-ID: <3DB696D5.2020103@pa.press.net>

Hi,

I am in the process of adding the option to compress logfiles, to 
twisted.python.logfile.  So that Twisted doesn't come to a standstill 
whilst compress a large file, I made the compress function run in a 
seperate thread.  However, if the file takes longer than a couple of 
seconds to compress, and rotate is called again, another thread is 
launched.  This thread, attempts to write to the same file as the 
initial thread.  I've had a look at the code, but I can't seem to find a 
provision within Twisted, to queue the threads.  Is there a way to do 
this, or, should I be looking at something else?

This only ever occurs, when the log rotation is set to occur very 
frequently, (i.e. every couple of seconds, or every 100 bytes), but I'd 
rather fix it, than impose limits on the frequency of log rotation.

Thanks

John




From twisted at itamarst.org  Wed Oct 23 08:21:54 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 23 Oct 2002 10:21:54 -0400
Subject: [Twisted-Python] Threading WIth Twisted
In-Reply-To: <3DB696D5.2020103@pa.press.net>
References: <20021023.070703.112268121.glyph@twistedmatrix.com>
	<3DB696D5.2020103@pa.press.net>
Message-ID: <20021023102154.6b4d3b9b.twisted@itamarst.org>

On Wed, 23 Oct 2002 13:32:21 +0100
John Abel <john.abel at pa.press.net> wrote:

> I am in the process of adding the option to compress logfiles, to 
> twisted.python.logfile.  So that Twisted doesn't come to a standstill 
> whilst compress a large file, I made the compress function run in a 
> seperate thread.  However, if the file takes longer than a couple of 
> seconds to compress, and rotate is called again, another thread is 
> launched.  This thread, attempts to write to the same file as the 
> initial thread.  I've had a look at the code, but I can't seem to find
> a provision within Twisted, to queue the threads.  Is there a way to
> do this, or, should I be looking at something else?

Set a flag "compressionInProgress".

If it is set, just remember you need to compress. When the thread
finishes it should call a callback (via reactor.callFromThread, or use
threads.deferToThread) and that callback will start up a new
compression.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From glyph at twistedmatrix.com  Wed Oct 23 08:25:01 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 23 Oct 2002 09:25:01 -0500 (CDT)
Subject: [Twisted-Python] Threading WIth Twisted
In-Reply-To: <3DB696D5.2020103@pa.press.net>
References: <20021023.070703.112268121.glyph@twistedmatrix.com>
	<3DB696D5.2020103@pa.press.net>
Message-ID: <20021023.092501.93026396.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 13:32:21 +0100, John Abel <john.abel at pa.press.net> wrote:

> So that Twisted doesn't come to a standstill whilst compress a large file, I
> made the compress function run in a seperate thread.

> This thread, attempts to write to the same file as the initial thread.

Why are two separate compression attempts writing to the same file?  Shouldn't
the file be named something along the lines of twistd.{1,2,3,4,...}.log.gz?

> I've had a look at the code, but I can't seem to find a provision within
> Twisted, to queue the threads.  Is there a way to do this, or, should I be
> looking at something else?

Yes, there is a way to do this.  Twisted provides utilities to have threads
interact with its mainloop, but it does not provide a full threading model:
that's Python's job.  Take a look at the "threading" and "Queue" modules in the
standard library.

> This only ever occurs, when the log rotation is set to occur very frequently,
> (i.e. every couple of seconds, or every 100 bytes), but I'd rather fix it,
> than impose limits on the frequency of log rotation.

Yeah, and it's because of problems like this that we try to steer clear of
threads in general in Twisted ;-).  Have you considered the block-at-a-time
approach that radix suggested?  That way you wouldn't need to run threads at
all...

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021023/dbcc504c/attachment.sig>

From sean at twistedmatrix.com  Wed Oct 23 11:01:43 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Wed, 23 Oct 2002 12:01:43 -0500
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
In-Reply-To: <000501c27a53$026ce380$0200000a@spunk>
Message-ID: <HOEEKPCOKELHCNIJNMAGMEIJCHAA.sean@twistedmatrix.com>

that is odd.. I did do some tests with Firebird with enterprise and row, but
have since uninstalled it :(

I would guess that "password" is a key word in Firebird's SQL dialect. Maybe
we should change that column name to something less likely to cause that
kind of conflict.

-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Joshua
Ritter
Sent: Wednesday, October 23, 2002 12:14 AM
To: twisted-python at twistedmatrix.com
Subject: [Twisted-Python] dbcred and Firebird Incompatibility




First the stuff that makes sense:

---

Firebird doesn't like batched SQL statements in a single string any better
than MySQL does...

Also it doesn't like the Primary Key in dbcred's schema not being specified
as NOT NULL

In twisted_identities:

identity_name     varchar(64) NOT NULL PRIMARY KEY

In twisted_services:

service_name      varchar(64) NOT NULL PRIMARY KEY

---

Now for something weird...

Firebird chokes in CREATE TABLE twisted_identities on the password column...
by changing the name to identity_password it works?!?!?!?!?

-J






_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From developer at csrules.dyndns.org  Wed Oct 23 13:27:17 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Wed, 23 Oct 2002 14:27:17 -0500 (CDT)
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
In-Reply-To: <HOEEKPCOKELHCNIJNMAGMEIJCHAA.sean@twistedmatrix.com>
References: <000501c27a53$026ce380$0200000a@spunk>
        <HOEEKPCOKELHCNIJNMAGMEIJCHAA.sean@twistedmatrix.com>
Message-ID: <10923.209.5.243.3.1035401237.squirrel@seraphine.csrules.dyndns.org>

PASSWORD is a reserved word in interbase and by extension probably
firebird but not in SQL 92.

ref:
http://ibphoenix.com/main.nfs?a=ibphoenix&page=ibp_reserved

regards,
Darryl




> that is odd.. I did do some tests with Firebird with enterprise and row,
> but have since uninstalled it :(
>
> I would guess that "password" is a key word in Firebird's SQL dialect.
> Maybe we should change that column name to something less likely to
> cause that kind of conflict.
>
> -----Original Message-----
> From: twisted-python-admin at twistedmatrix.com
> [mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of Joshua
> Ritter
> Sent: Wednesday, October 23, 2002 12:14 AM
> To: twisted-python at twistedmatrix.com
> Subject: [Twisted-Python] dbcred and Firebird Incompatibility
>
>
>
>
> First the stuff that makes sense:
>
> ---
>
> Firebird doesn't like batched SQL statements in a single string any
> better than MySQL does...
>
> Also it doesn't like the Primary Key in dbcred's schema not being
> specified as NOT NULL
>
> In twisted_identities:
>
> identity_name     varchar(64) NOT NULL PRIMARY KEY
>
> In twisted_services:
>
> service_name      varchar(64) NOT NULL PRIMARY KEY
>
> ---
>
> Now for something weird...
>
> Firebird chokes in CREATE TABLE twisted_identities on the password
> column... by changing the name to identity_password it works?!?!?!?!?
>
> -J
>
>
>
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python






From ritterjoshua at msn.com  Wed Oct 23 09:06:58 2002
From: ritterjoshua at msn.com (Joshua Ritter)
Date: Wed, 23 Oct 2002 10:06:58 -0500
Subject: [Twisted-Python] dbcred and Firebird Incompatibility
Message-ID: <003101c27aa5$d57ae9f0$0200000a@spunk>

"password" and "user" are Firebird/Interbase keyword/variables... neither will work as a column name... for instance, you also can't have a column named "file", "default","starting", "length", etc etc etc.

This is pretty enough for me:

identity_name
identity_password

I wonder what other landmines await...

-J

----------------------------------------------------

>> Firebird chokes in CREATE TABLE twisted_identities on the password column...
>> by changing the name to identity_password it works?!?!?!?!?

>It's almost certainly wrong, but the first thing that occurs to me is:

>    twistedidentities
>    identitypassword
>       ^   ^   ^   ^   ^
>       4   8   12  16  18

>twisted_identities has more than 16 alphanumeric characters in it, whereas
>identity_password has exactly 16.  Is this a hard limit in firebird, by chance?
>;-)

>-- 
> |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
> |   < _/ >   |  Lead Developer,  the Twisted project  |
> |  < ___/ >  |      http://www.twistedmatrix.com      |


-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20021023/e218e433/attachment.html>

From mongo57a at comcast.net  Wed Oct 23 19:08:24 2002
From: mongo57a at comcast.net (andy surany)
Date: Wed, 23 Oct 2002 21:08:24 -0400
Subject: [Twisted-Python] Fw: [Tutor] Interfacing to the web
Message-ID: <00d401c27af9$db4e91c0$2502a8c0@emily.ewndsr01.nj.comcast.net>

Hi all!

It was suggested in Tutor that Twisted might be what I'm looking for (please
see the thread below). The best bet appears to be a proxy to which I can add
some intercept logic. Anybody done this with Twisted?

TIA

-Andy

-----Original Message-----
From: andy surany <mongo57a at comcast.net>
To: Magnus Lycka <magnus at thinkware.se>; tutor at python.org <tutor at python.org>
Date: Wednesday, October 23, 2002 5:44 PM
Subject: Re: [Tutor] Interfacing to the web


From the responses I have received, it sounds like a proxy is the best bet.
However, my application is meant to run on Linux, Windows, and Mac
platforms, so that may rule out some software (it looks like squid is for
linux only????, and privoxy does not allow code extensions).

So I will search for a good proxy. Anyone write a good one????? Or know of
one?(given the above caveats...).

TIA
-Andy


-----Original Message-----
From: Magnus Lycka <magnus at thinkware.se>
To: andy surany <mongo57a at comcast.net>; tutor at python.org <tutor at python.org>
Date: Wednesday, October 23, 2002 5:20 PM
Subject: Re: [Tutor] Interfacing to the web


At 13:03 2002-10-23 -0400, andy surany wrote:
>Hi All!
>
>Here is what I need to accomplish:
>
>     From a python program, I need to launch a browser. The user then uses
> the browser to interact with the web site. However, the python program
> must continually monitor the data from the web site to capture specific
> data elements.
>
>     Unfortunately, I can't point the program to the specific URL as there
> is a significant and secure (cookies, etc.) exchange that must occur in
> order to reach the page.

I see two reasonable ways to go about this.

One is to use a web proxy that acts as a man-in-the-middle.
I'm not aware of any python proxies though, but maybe it's
possible tobuild plugins for some proxies? Something along
the line of privoxy (www.privoxy.org) or squid
(www.squid-cache.org) might be useful??? See
http://www.squid-cache.org/related-software.html

Another option could be to build a custom web browser.
If you use wxPython, there is a HTML window component
that could be useful. If you are in MS Windows, you
could also plug into Internet Explorer or at least
use parts of it. See the wxPython demo.


--
Magnus Lyck, Thinkware AB
lvans vg 99, SE-907 50 UME
tel: 070-582 80 65, fax: 070-612 80 65
http://www.thinkware.se/  mailto:magnus at thinkware.se




_______________________________________________
Tutor maillist  -  Tutor at python.org
http://mail.python.org/mailman/listinfo/tutor





From twisted at itamarst.org  Wed Oct 23 18:44:32 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 23 Oct 2002 20:44:32 -0400
Subject: [Twisted-Python] UDP Support
Message-ID: <20021023204432.7976263c.twisted@itamarst.org>

I intend to totally refactor UDP tonight. Do I need to bother with
backwards compatability, or is nobody using it?

There's been a big "this is not a stable API" docstring on it for a
while...

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From joe at swelltech.com  Wed Oct 23 19:13:10 2002
From: joe at swelltech.com (Joe Cooper)
Date: Wed, 23 Oct 2002 20:13:10 -0500
Subject: [Twisted-Python] Fw: [Tutor] Interfacing to the web
References: <00d401c27af9$db4e91c0$2502a8c0@emily.ewndsr01.nj.comcast.net>
Message-ID: <3DB74926.5090805@swelltech.com>

Just to interject a correction to the below bit about Squid.  Windows is 
an officially supported platform, with at least two active maintainers.

Squid runs natively as a service on Windows NT when compiled with MS 
compilers and under Cygwin built with GCC.  The MinGW port is reportedly 
going well, though incomplete right now.  It has also been reported to 
compile (with effort) under Mac OS X.  It is also likely to become a 
supported platform if someone will step forward to take responsibility 
for keeping an eye on new versions to insure they build and run.  Squid 
also runs on most reasonably current Unices with GCC and GNU make, as 
well as most modern platforms with vendor-supplied compilers (though GNU 
make is probably still required in most cases).

andy surany wrote:
> Hi all!
> 
> It was suggested in Tutor that Twisted might be what I'm looking for (please
> see the thread below). The best bet appears to be a proxy to which I can add
> some intercept logic. Anybody done this with Twisted?
> 
> TIA
> 
> -Andy
> 
> -----Original Message-----
> From: andy surany <mongo57a at comcast.net>
> To: Magnus Lycka <magnus at thinkware.se>; tutor at python.org <tutor at python.org>
> Date: Wednesday, October 23, 2002 5:44 PM
> Subject: Re: [Tutor] Interfacing to the web
> 
> 
> From the responses I have received, it sounds like a proxy is the best bet.
> However, my application is meant to run on Linux, Windows, and Mac
> platforms, so that may rule out some software (it looks like squid is for
> linux only????, and privoxy does not allow code extensions).
> 
> So I will search for a good proxy. Anyone write a good one????? Or know of
> one?(given the above caveats...).


-- 
Joe Cooper <joe at swelltech.com>
Web caching appliances and support.
http://www.swelltech.com




From andrew-twisted at puzzling.org  Wed Oct 23 19:15:33 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 24 Oct 2002 11:15:33 +1000
Subject: [Twisted-Python] Freshmeat
Message-ID: <20021024011533.GD16479@ritsuko.xware.cx>

I note that the Twisted project info at Freshmeat is up-to-date with
respect to version numbers:
    http://freshmeat.net/projects/twisted/?topic_id=22%2C28%2C86%2C92%2C250

But it probably should have this bit updated:
    "Development Status :: 4 - Beta"

-Andrew.




From twisted at itamarst.org  Wed Oct 23 19:25:32 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 23 Oct 2002 21:25:32 -0400
Subject: [Twisted-Python] Fw: [Tutor] Interfacing to the web
In-Reply-To: <00d401c27af9$db4e91c0$2502a8c0@emily.ewndsr01.nj.comcast.net>
References: <00d401c27af9$db4e91c0$2502a8c0@emily.ewndsr01.nj.comcast.net>
Message-ID: <20021023212532.6a0114fd.twisted@itamarst.org>

On Wed, 23 Oct 2002 21:08:24 -0400
andy surany <mongo57a at comcast.net> wrote:

> It was suggested in Tutor that Twisted might be what I'm looking for
> (please see the thread below). The best bet appears to be a proxy to
> which I can add some intercept logic. Anybody done this with Twisted?

You could make a transparent proxy with Twisted, yes, since it has both
http client and server classes. There's a module twisted.web.proxy that
does that.

Might not work without some munging of the returned HTML, however.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From mongo57a at comcast.net  Wed Oct 23 21:11:26 2002
From: mongo57a at comcast.net (andy surany)
Date: Wed, 23 Oct 2002 23:11:26 -0400
Subject: [Twisted-Python] Fw: [Tutor] Interfacing to the web
Message-ID: <00ed01c27b0b$0aca9320$2502a8c0@emily.ewndsr01.nj.comcast.net>

Thanks. It looks like the basic building blocks are there - but I don't know
enough about how a proxy works to be able to make one (if I can avoid it).
All I really need to do is to be able to hook into the date stream, tagging
on one specific URL which I can then parse to get the data into my python
program. Unfortunately, I can't access the URL directly (cookies, etc.).

Or have i misunderstood twisted.web.proxy? The only docs I found were at
http://twistedmatrix.com/users/jh/teud/Twisted/twisted.web.proxy.html

Andy
-----Original Message-----
From: Itamar Shtull-Trauring <twisted at itamarst.org>
To: twisted-python at twistedmatrix.com <twisted-python at twistedmatrix.com>
Cc: mongo57a at comcast.net <mongo57a at comcast.net>
Date: Wednesday, October 23, 2002 9:29 PM
Subject: Re: [Twisted-Python] Fw: [Tutor] Interfacing to the web


>On Wed, 23 Oct 2002 21:08:24 -0400
>andy surany <mongo57a at comcast.net> wrote:
>
>> It was suggested in Tutor that Twisted might be what I'm looking for
>> (please see the thread below). The best bet appears to be a proxy to
>> which I can add some intercept logic. Anybody done this with Twisted?
>
>You could make a transparent proxy with Twisted, yes, since it has both
>http client and server classes. There's a module twisted.web.proxy that
>does that.
>
>Might not work without some munging of the returned HTML, however.
>
>--
>Itamar Shtull-Trauring    http://itamarst.org/
>Available for Python, Twisted, Zope and Java consulting
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From kkennedy at kenzoid.com  Wed Oct 23 20:30:55 2002
From: kkennedy at kenzoid.com (Ken Kennedy)
Date: Wed, 23 Oct 2002 22:30:55 -0400
Subject: [Twisted-Python] Logo usage at websites?
Message-ID: <20021024023054.GA7029@kenzoid.com>

Couldn't find any info at the site, CVS, or my saved list
msgs...is there an official logo that's available for use by
sites running Twisted? I'm poking about in the images dir at
twistedmatrix.com; images/TwistedLogo.png looks good, and it's only
2086 bytes. 

I'm looking forward to sticking a "Powered by Twisted" logo in my
footers...*grin*. 


-- 

Ken Kennedy	| http://www.kenzoid.com	| kenzoid at io.com



From glyph at twistedmatrix.com  Wed Oct 23 21:20:42 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 23 Oct 2002 22:20:42 -0500 (CDT)
Subject: [Twisted-Python] Logo usage at websites?
In-Reply-To: <20021024023054.GA7029@kenzoid.com>
References: <20021024023054.GA7029@kenzoid.com>
Message-ID: <20021023.222042.07645503.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 22:30:55 -0400, kkennedy at kenzoid.com (Ken Kennedy) wrote:

> I'm looking forward to sticking a "Powered by Twisted" logo in my
> footers...*grin*.

Maybe it would be more appropriate to have a logo that said "Twisted by Power",
with a little graphic of the Eye of Sauron staring out of our serpentine logo?
"Surely, you did not think that Guido could contend with the will of Internet.
There are none who can."

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021023/d044d90d/attachment.sig>

From developer at csrules.dyndns.org  Wed Oct 23 21:30:18 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Wed, 23 Oct 2002 22:30:18 -0500 (CDT)
Subject: [Twisted-Python] Pynfo
In-Reply-To: <20021023.222042.07645503.glyph@twistedmatrix.com>
References: <20021024023054.GA7029@kenzoid.com>
        <20021023.222042.07645503.glyph@twistedmatrix.com>
Message-ID: <3086.192.168.2.20.1035430218.squirrel@seraphine.csrules.dyndns.org>

Dont really know where to broach this but:

I've been looking at the code for pynfo and there's some functionality
i'd like to wedge in there i.e. logging to a database (for example) but
i'd like to be able to do it without affecting the main code. Is there a
reasonable way to create an external plugin that could be inserted at
runtime?








From kkennedy at kenzoid.com  Wed Oct 23 22:03:06 2002
From: kkennedy at kenzoid.com (Ken Kennedy)
Date: Thu, 24 Oct 2002 00:03:06 -0400
Subject: [Twisted-Python] Logo usage at websites?
In-Reply-To: <20021023.222042.07645503.glyph@twistedmatrix.com>
References: <20021024023054.GA7029@kenzoid.com> <20021023.222042.07645503.glyph@twistedmatrix.com>
Message-ID: <20021024040306.GH7029@kenzoid.com>

On Wed, Oct 23, 2002 at 10:20:42PM -0500, Glyph Lefkowitz wrote:
> On Wed, 23 Oct 2002 22:30:55 -0400, kkennedy at kenzoid.com (Ken Kennedy) wrote:
> 
> > I'm looking forward to sticking a "Powered by Twisted" logo in my
> > footers...*grin*.
> 
> Maybe it would be more appropriate to have a logo that said "Twisted by Power",
> with a little graphic of the Eye of Sauron staring out of our serpentine logo?
> "Surely, you did not think that Guido could contend with the will of Internet.
> There are none who can."

That's cracking me up. I'm almost ready to whip out the GIMP and start
on it...

-- 

Ken Kennedy	| http://www.kenzoid.com	| kenzoid at io.com



From glyph at twistedmatrix.com  Thu Oct 24 08:08:26 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 24 Oct 2002 09:08:26 -0500 (CDT)
Subject: [Twisted-Python] UDP Support
In-Reply-To: <20021023204432.7976263c.twisted@itamarst.org>
References: <20021023204432.7976263c.twisted@itamarst.org>
Message-ID: <20021024.090826.93209099.glyph@twistedmatrix.com>

On Wed, 23 Oct 2002 20:44:32 -0400, Itamar Shtull-Trauring <twisted at itamarst.org> wrote:
> I intend to totally refactor UDP tonight. Do I need to bother with
> backwards compatability, or is nobody using it?

The only code that I'm aware of anywhere that's using it is the DNS code, which
is probably just going to want a thin backwards-compatibility layer anyway.  I
don't think it's doing anything particularly idiomatic to UDP.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021024/a78bcbf3/attachment.sig>

From developer at csrules.dyndns.org  Thu Oct 24 09:28:01 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Thu, 24 Oct 2002 10:28:01 -0500 (CDT)
Subject: [Twisted-Python] Freshmeat
In-Reply-To: <20021024011533.GD16479@ritsuko.xware.cx>
References: <20021024011533.GD16479@ritsuko.xware.cx>
Message-ID: <5881.209.5.243.3.1035473281.squirrel@seraphine.csrules.dyndns.org>

I dont' know how actively you guys update sourceforget but:

http://sourceforge.net/projects/twisted  <-- still has 0.99.2 as latest
file release.



> I note that the Twisted project info at Freshmeat is up-to-date with
> respect to version numbers:
>     http://freshmeat.net/projects/twisted/?topic_id=22%2C28%2C86%2C92%2C250
>
> But it probably should have this bit updated:
>     "Development Status :: 4 - Beta"
>
> -Andrew.
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python






From twisted at moshez.org  Thu Oct 24 10:04:04 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 24 Oct 2002 16:04:04 -0000
Subject: [Twisted-Python] Freshmeat
In-Reply-To: <5881.209.5.243.3.1035473281.squirrel@seraphine.csrules.dyndns.org>
References: <5881.209.5.243.3.1035473281.squirrel@seraphine.csrules.dyndns.org>, <20021024011533.GD16479@ritsuko.xware.cx>
Message-ID: <20021024160404.6216.qmail@green.zadka.com>

On Thu, 24 Oct 2002, "Maniac -" <developer at csrules.dyndns.org> wrote:

> I dont' know how actively you guys update sourceforget but:
> 
> http://sourceforge.net/projects/twisted  <-- still has 0.99.2 as latest
> file release.

Look at twisted.sf.net
We stopped using the file release mechanism because it sucks



From developer at csrules.dyndns.org  Thu Oct 24 10:18:11 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Thu, 24 Oct 2002 11:18:11 -0500 (CDT)
Subject: [Twisted-Python] Freshmeat
In-Reply-To: <20021024160404.6216.qmail@green.zadka.com>
References: <20021024011533.GD16479@ritsuko.xware.cx>
        <20021024160404.6216.qmail@green.zadka.com>
Message-ID: <7480.209.5.243.3.1035476291.squirrel@seraphine.csrules.dyndns.org>

Oh, well if you pull up the 'project' page on SF looks like you guys
haven't released since 0.99.2

/me will keep his mouth shut

> On Thu, 24 Oct 2002, "Maniac -" <developer at csrules.dyndns.org> wrote:
>
>> I dont' know how actively you guys update sourceforget but:
>>
>> http://sourceforge.net/projects/twisted  <-- still has 0.99.2 as
>> latest file release.
>
> Look at twisted.sf.net
> We stopped using the file release mechanism because it sucks
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python






From twisted at moshez.org  Thu Oct 24 11:54:56 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 24 Oct 2002 17:54:56 -0000
Subject: [Twisted-Python] Freshmeat
In-Reply-To: <7480.209.5.243.3.1035476291.squirrel@seraphine.csrules.dyndns.org>
References: <7480.209.5.243.3.1035476291.squirrel@seraphine.csrules.dyndns.org>, <20021024011533.GD16479@ritsuko.xware.cx>
        <20021024160404.6216.qmail@green.zadka.com>
Message-ID: <20021024175456.7491.qmail@green.zadka.com>

On Thu, 24 Oct 2002, "Maniac -" <developer at csrules.dyndns.org> wrote:

> Oh, well if you pull up the 'project' page on SF looks like you guys
> haven't released since 0.99.2

You're right. Can one of the sf Twisted admins disable the file release
feature?



From andrew-twisted at puzzling.org  Thu Oct 24 18:44:16 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 25 Oct 2002 10:44:16 +1000
Subject: [Twisted-Python] Re: [Twisted-commits] If we use use non-standard packages, we make sure they are avilaable on pyr
In-Reply-To: <E184k7m-0004rj-00@pyramid.twistedmatrix.com>
References: <E184k7m-0004rj-00@pyramid.twistedmatrix.com>
Message-ID: <20021025004416.GA4208@ritsuko.xware.cx>

On Thu, Oct 24, 2002 at 10:42:18AM -0500, moshez CVS wrote:
> Modified files:
> Twisted/admin/book.tex 1.5 1.6
> 
> Log message:
> If we use use non-standard packages, we make sure they are avilaable on pyr

[..snip..]

> -\usepackage{times,mathptmx}
> +%\usepackage{times,mathptmx}

Installing the tetex-extra package should make this work... can that be
arranged?  Those packages are the magic necessary for making pdfs that
are readable in Win32 Acrobat.

-Andrew.




From radix at twistedmatrix.com  Thu Oct 24 19:34:02 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Fri, 25 Oct 2002 03:34:02 +0200
Subject: [Twisted-Python] Re: [Twisted-commits] If we use use non-standard packages, we make sure they are avilaable on pyr
In-Reply-To: <20021025004416.GA4208@ritsuko.xware.cx>
References: <E184k7m-0004rj-00@pyramid.twistedmatrix.com> <20021025004416.GA4208@ritsuko.xware.cx>
Message-ID: <20021025013402.GC631@twistedmatrix.com>

On Fri, Oct 25, 2002 at 10:44:16AM +1000, Andrew Bennetts wrote:
> Installing the tetex-extra package should make this work... 

Done.


-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From waterbug at beeblebrox.gsfc.nasa.gov  Thu Oct 24 21:57:19 2002
From: waterbug at beeblebrox.gsfc.nasa.gov (Steve Waterbury)
Date: Thu, 24 Oct 2002 23:57:19 -0400
Subject: [Twisted-Python] Glossary entry for Twisted Book
Message-ID: <3DB8C11F.64650678@beeblebrox.gsfc.nasa.gov>

Reading the entry for "PSU", I was reminded of a one of 
my favorite Marx Brothers lines, which might be appropriate 
here (I once included it in my position description ... it 
was definitely appropriate there ;^):

Sanity Clause:
    Everybody knows there's no Sanity Clause.  

Cheers,
-- Steve.



From carball at hush.com  Fri Oct 25 00:12:22 2002
From: carball at hush.com (carball at hush.com)
Date: Thu, 24 Oct 2002 23:12:22 -0700
Subject: [Twisted-Python] grokking Cacheable
Message-ID: <200210250612.g9P6CNfm082033@mailserver4.hushmail.com>

attempting to grok Cacheable here. .
was wondering if someone could show a quick example of its correct use?
-----------------------------
attached is what i have so far, just to test. .
i am getting this error when the observer is being serialized?
-----------------------------------------
24/10/2002 09:17 [Broker,0,127.0.0.1] twisted.spread.jelly.InsecureJelly: Class not allowed for instance: twisted.spread.flavors.RemoteCacheObserver <RemoteCacheObserver(<twisted.spread.pb.Broker instance at 0x83ab0f4>, <mon.net.rop.Cashew instance at 0x838b5a4>, <mon_server.rop_myApp.Persp instance at 0x83834d4>) at 138104980>
-------------------------------
i havent seen any example code in the list, docs, or examples dir
about this dark corner of the pb universe, so i thought i'd ask
------------
any elucidation is quite appreciated
thanks
car 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rop.py
Type: application/octet-stream
Size: 501 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021024/793e9220/attachment-0002.obj>

From twisted at moshez.org  Fri Oct 25 02:02:51 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 25 Oct 2002 08:02:51 -0000
Subject: [Twisted-Python] Twisted: We Reinvent NIH
Message-ID: <20021025080251.15905.qmail@green.zadka.com>

Those of you dilligently watching the commits lists already know
this, but for those heretics among you who don't, let me sum up

-- After a death sentence pronouncement on PyFontify by python-dev, twisted
   has its own Python HTML colourer in twisted.python.htmlizer
-- The document generation system is now part of twisted, as twisted.lore.
   People who want to use it for documenting their own Python stuff are
   invited to.



From nbm at mithrandr.moria.org  Fri Oct 25 03:04:13 2002
From: nbm at mithrandr.moria.org (Neil Blakey-Milner)
Date: Fri, 25 Oct 2002 11:04:13 +0200
Subject: [Twisted-Python] DNSServerBoss.getAnswers with non-authoritative requests
Message-ID: <20021025090413.GC28466@mithrandr.moria.org>

Hi,

Since I've just guessed how the DNS Server stuff works in twisted, I may
be doing something stupid.

Example program:

from twisted.protocols import dns
from twisted.names.dns import DNSServerBoss, DNSServerFactory, SimpleDomain
from twisted.internet import reactor

a = DNSServerFactory()
s = SimpleDomain("example.net", "192.168.8.26")
a.boss.addDomain("example.net", s)
a.boss.createBothFactories()
a.boss.startListeningBoth(53)
reactor.run()


This works great for example.net:

(nbm at pike) /home/nbm> host example.net 127.0.0.1
Using domain server 127.0.0.1:
example.net has address 192.168.8.26
example.net mail is handled (pri=5) by example.net

This works non-great for other domains - it just sits there, slowly
timing out for each query made (due to 'search' or 'domain' in
resolv.conf).

Traceback makes it obvious where the problem is:

  File "/usr/local/lib/python2.2/site-packages/twisted/names/dns.py",
line 370, in getAnswers
    name = string.split(name, '.', 1)[1]
exceptions.IndexError: list index out of range

Ok, that's easy, and that's the first patch
(twisted.names.dns.py-noerror.patch).

Once applied, it still doesn't quite work:

(nbm at pike) /home/nbm> host example.org 127.0.0.1
Using domain server 127.0.0.1:
There is an entry for this host, but it doesn't have a Mail Exchanger record.

Second patch (no idea if this is what DNS is supposed to do) makes that
more like I expect it to return:

(nbm at pike) /home/nbm> host example.org 127.0.0.1
Using domain server 127.0.0.1:
Host not found.

I'll probably look into what is the correct response, but not soon.  I'm
not sure how the multiple-queries bit factors into it either.

Neil
-- 
Neil Blakey-Milner
nbm at mithrandr.moria.org
-------------- next part --------------
Index: dns.py
===================================================================
RCS file: /cvs/Twisted/twisted/names/dns.py,v
retrieving revision 1.37
diff -u -r1.37 dns.py
--- dns.py	2 Oct 2002 05:55:19 -0000	1.37
+++ dns.py	25 Oct 2002 08:43:15 -0000
@@ -367,7 +367,10 @@
                 continue # internet
             name = query.name.name
             while name and not self.domains.has_key(name):
-                name = string.split(name, '.', 1)[1]
+                try:
+                    name = string.split(name, '.', 1)[1]
+                except IndexError:
+                    name = None
             if not name:
                 continue
             self.domains[name].getAnswers(message, query.name.name, query.type)
-------------- next part --------------
Index: dns.py
===================================================================
RCS file: /cvs/Twisted/twisted/names/dns.py,v
retrieving revision 1.37
diff -u -r1.37 dns.py
--- dns.py	2 Oct 2002 05:55:19 -0000	1.37
+++ dns.py	25 Oct 2002 08:47:01 -0000
@@ -367,8 +367,12 @@
                 continue # internet
             name = query.name.name
             while name and not self.domains.has_key(name):
-                name = string.split(name, '.', 1)[1]
+                try:
+                    name = string.split(name, '.', 1)[1]
+                except IndexError:
+                    name = None
             if not name:
+                message.rCode = dns.ENAME
                 continue
             self.domains[name].getAnswers(message, query.name.name, query.type)
         protocol.writeMessage(message)

From jk at xylema.org  Fri Oct 25 07:13:20 2002
From: jk at xylema.org (John Kozak)
Date: Fri, 25 Oct 2002 14:13:20 +0100
Subject: [Twisted-Python] reactor installation
Message-ID: <15801.17264.372137.725109@gargle.gargle.HOWL>

I have a program which uses Qt and glues to Twisted via qtreactor.  As
of 1.0.0 (ish - worked with most of the 0.99s), it no longer
initialises, bleating that a reactor is already loaded.  The structure
of this program is mildly eccentric: as part of my "explore UIs in
Python" activity it was intended to have pluggable UIs in wx and Qt
(actual experience of wx dissuaded me of this), and so it perhaps
initialises the reactor rather later in the game than usual.  Is there
a way I can take control over, or at least debug, reactor init?






From twisted at itamarst.org  Fri Oct 25 07:47:59 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 25 Oct 2002 09:47:59 -0400
Subject: [Twisted-Python] reactor installation
In-Reply-To: <15801.17264.372137.725109@gargle.gargle.HOWL>
References: <15801.17264.372137.725109@gargle.gargle.HOWL>
Message-ID: <20021025094759.3445c1b3.twisted@itamarst.org>

On Fri, 25 Oct 2002 14:13:20 +0100
"John Kozak" <jk at xylema.org> wrote:

> I have a program which uses Qt and glues to Twisted via qtreactor.  As
> of 1.0.0 (ish - worked with most of the 0.99s), it no longer
> initialises, bleating that a reactor is already loaded.  The structure
> of this program is mildly eccentric: as part of my "explore UIs in
> Python" activity it was intended to have pluggable UIs in wx and Qt
> (actual experience of wx dissuaded me of this), and so it perhaps
> initialises the reactor rather later in the game than usual.  Is there
> a way I can take control over, or at least debug, reactor init?

Here's the rule - installing a reactor should always be the *first*
thing you do, and I do mean first. Importing other stuff before you
install the reactor can break your code.

wxPython support, as it does not install a new reactor, can be done at
any point, IIRC.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From sean at twistedmatrix.com  Fri Oct 25 09:06:50 2002
From: sean at twistedmatrix.com (Sean Riley)
Date: Fri, 25 Oct 2002 10:06:50 -0500
Subject: [Twisted-Python] grokking Cacheable
In-Reply-To: <200210250612.g9P6CNfm082033@mailserver4.hushmail.com>
Message-ID: <HOEEKPCOKELHCNIJNMAGAEJGCHAA.sean@twistedmatrix.com>

that particular error means that the server class 'mon.net.rop.Cashew' has
no registered copier on the client. You need to call pb.setCopierForClass on
the client like:

from twisted.spread import pb

class YourClientClass(pb.RemoteCache):
    pass

pb.setCopierForClass('mon.net.rop.Cashew', YourClientClass)

and instances of mon.net.rop.Cashew will be transformed into YourClientClass
when they arrive at the client. YourClientClass must be derived from
pb.RemoteCache.

This appears to be one the most common errors when programming with
Cacheables as it occurs not only when you forget to designate a copier, but
when an unexpected server object tried to get sent to the client because of
a reference of assignment you werent aware of. This is a good security
measure :)

-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com]On Behalf Of
carball at hush.com
Sent: Friday, October 25, 2002 1:12 AM
To: Twisted-Python at twistedmatrix.com
Subject: [Twisted-Python] grokking Cacheable


attempting to grok Cacheable here. .
was wondering if someone could show a quick example of its correct use?
-----------------------------
attached is what i have so far, just to test. .
i am getting this error when the observer is being serialized?
-----------------------------------------
24/10/2002 09:17 [Broker,0,127.0.0.1] twisted.spread.jelly.InsecureJelly:
Class not allowed for instance: twisted.spread.flavors.RemoteCacheObserver
<RemoteCacheObserver(<twisted.spread.pb.Broker instance at 0x83ab0f4>,
<mon.net.rop.Cashew instance at 0x838b5a4>, <mon_server.rop_myApp.Persp
instance at 0x83834d4>) at 138104980>
-------------------------------
i havent seen any example code in the list, docs, or examples dir
about this dark corner of the pb universe, so i thought i'd ask
------------
any elucidation is quite appreciated
thanks
car




From bruce at cubik.org  Fri Oct 25 09:16:08 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Fri, 25 Oct 2002 09:16:08 -0600
Subject: [Twisted-Python] grokking Cacheable
References: <HOEEKPCOKELHCNIJNMAGAEJGCHAA.sean@twistedmatrix.com>
Message-ID: <3DB96038.7010402@cubik.org>

Sean Riley wrote:
> This appears to be one the most common errors when programming with
> Cacheables as it occurs not only when you forget to designate a copier, but
> when an unexpected server object tried to get sent to the client because of
> a reference of assignment you werent aware of. This is a good security
> measure :)

That's why I tend to not use the default implementation of 
getStateToCacheAndObserveFor and now explicitly list out which 
attributes I want to transmit.  (Although in some cases, I'm also 
transforming the data into a different format for the client-side 
representation as well.)

  - Bruce




From gustav at morpheus.demon.co.uk  Wed Oct 23 15:11:15 2002
From: gustav at morpheus.demon.co.uk (Paul Moore)
Date: Wed, 23 Oct 2002 22:11:15 +0100
Subject: [Twisted-Python] Some comments on twisted.news
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk> <20021022192113.GL12550@twistedmatrix.com>
Message-ID: <n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> On Tue, Oct 22, 2002 at 06:49:09PM +0100, Paul Moore wrote:
>> (2) is obviously fairly trivial. I think I could implement (3) and
>> (4), if it would be useful. I could submit a patch, which would alter
>> the server code and the 2 existing backends (I couldn't test the
>> database backend, as I don't have a database to test with, but I could
>> test the pickle-based code). Would this be helpful? Are there likely
>> to be 3rd party nntp backends which would be broken by such a change?
>
> There certainly aren't any 3rd party backends yet, twisted.news is
> still fairly new (and doesn't have any users, afaik, although some may
> be lurking). I'd recommend implementing everything and waiting for
> exarkun's approval (He may be a while, as he's visiting Minnesota
> atm), but I really doubt he'll have any problems with it.

OK, I'll see what I can do. What's the best procedure for submitting a
patch? Can I post patches to this list?

Paul.

-- 
This signature intentionally left blank



From glyph at twistedmatrix.com  Fri Oct 25 15:35:55 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 25 Oct 2002 16:35:55 -0500 (CDT)
Subject: [Twisted-Python] grokking Cacheable
In-Reply-To: <3DB96038.7010402@cubik.org>
References: <HOEEKPCOKELHCNIJNMAGAEJGCHAA.sean@twistedmatrix.com>
	<3DB96038.7010402@cubik.org>
Message-ID: <20021025.163555.59467324.glyph@twistedmatrix.com>


On Fri, 25 Oct 2002 09:16:08 -0600, Bruce Mitchener <bruce at cubik.org> wrote:

> That's why I tend to not use the default implementation of
> getStateToCacheAndObserveFor and now explicitly list out which attributes I
> want to transmit.  (Although in some cases, I'm also transforming the data
> into a different format for the client-side representation as well.)

Just thought I'd chime in and explain why this is an especially good idea ;-).

For both Copyables and Cacheables, it's good to be nice and explicit about what
you want sent vs. what you don't; so not accepting the default is definitely a
good idea.  By transforming the data for client-side representation you not
only save potentially unnecessary space and prevent errors that result from
copying unknown types, you also make your application easier to interface to
from other programming languages, because it's obvious what that language
should expect in a copied structure from you.

In Cacheables this is even more true because you typically don't want to lose
the "observer" object, which is ignored by the default implementation.

-- 
 |    <`'>    |  Glyph Lefkowitz: Travelling Sorcerer  |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021025/3b9721d4/attachment.sig>

From itamar at itamarst.org  Fri Oct 25 19:33:31 2002
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 25 Oct 2002 21:33:31 -0400
Subject: [Twisted-Python] Some comments on twisted.news
In-Reply-To: <n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
	<20021022192113.GL12550@twistedmatrix.com>
	<n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>
Message-ID: <20021025213331.197dc906.itamar@itamarst.org>

On Wed, 23 Oct 2002 22:11:15 +0100
Paul Moore <gustav at morpheus.demon.co.uk> wrote:

> OK, I'll see what I can do. What's the best procedure for submitting a
> patch? Can I post patches to this list?

If it's big, http://sf.net/projects/twisted/ in the bug tracker.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From kkennedy at kenzoid.com  Fri Oct 25 23:03:55 2002
From: kkennedy at kenzoid.com (Ken Kennedy)
Date: Sat, 26 Oct 2002 01:03:55 -0400
Subject: [Twisted-Python] No shame...
Message-ID: <20021026050354.GI7029@kenzoid.com>

OK...I'm obviously not QUITE grokking something with Deferreds, and
I've spent FAR too long on something that's probably WAY too simple.

I've been trying to use a Deferred from an adbapi connection in a web
page display, and I'm just doing something wrong. I get the data, but
the page is already rendered. I know the query's working, b/c the
callback function writes to the log. At this point, I've given up and
used a blocking call just for example purposes.

Here's what's (shamefully) working now:

----BEGIN SCRIPT----

# Bloglist RTL file
#
# Provides a listing of recent blog posts 

# obviously, these aren't all being used now.
# I've been through 'em all during the day, though...
from twisted.web.resource import Resource
from twisted.enterprise import adbapi
from TwistedBlog.config import DSN
from TwistedBlog import blogger
from twisted.python import log
from twisted.web.server import NOT_DONE_YET
# the heck with it...
import pyPgSQL.PgSQL

class BlogResource(Resource):

      template render(self, request):
               print "DSN = %s" % (DSN,)
               conn = pyPgSQL.PgSQL.connect(DSN)
               cursor = conn.cursor()
               sql = """SELECT title, news_item_id FROM news_items
               ORDER BY release_date desc, news_item_id DESC
               LIMIT %s"""
               cursor.execute(sql, 8)
               recentList = cursor.fetchall()
               """
               <html>
               <head><title>Recent Entries</title></head>
               <body>
                <h1>Kenzoid's blog</h1>
                """
                for (title, id) in recentList:
                    '<a href="blog/%s">%s</a><br>' % (id,title)
                """
                </p>
                </body>
                </html>
                """ % vars()

resource = BlogResource()

----END SCRIPT----

Now, TwistedBlog.blogger.DatabaseBlogger OTOH uses an
adbapi.Augmentation.runQuery with the same SQL as above, returning a
Deferred. Once the callback runs, the resultlist is available there,
and I can write it (for example) to the log. So I know it's
working. Just not in sync with the rest of things.

So I realize the problems...but I'm
just-not-seeing-the-Deferred-way. Can someone give me a dumb-stupid
example, getting basically the same info as above into a webpage,
using adbapi rather than a blocking call? I find tantalizing mentions
of the use of Deferreds in various places, but I don't see any
easy examples. I like easy. *grin* For starters, anyway. 

As to format, I don't care. Use woven, Quixote PTL, Web Widgets,
direct writes, whatever floats your boat. I hope that once I see it and
play with it a tad, the lightbulb will turn on in my beany little
head. 

Thanks in advance...I'll take the ribbing, as long as I get some code
too! *grin*

-- 

Ken Kennedy	| http://www.kenzoid.com	| kenzoid at io.com



From twisted at moshez.org  Sat Oct 26 00:14:24 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 26 Oct 2002 06:14:24 -0000
Subject: Patches (was Re: [Twisted-Python] Some comments on twisted.news)
In-Reply-To: <n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>
References: <n2m-g.znt4j1xo.fsf@morpheus.demon.co.uk>, <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk> <20021022192113.GL12550@twistedmatrix.com>
Message-ID: <20021026061424.28499.qmail@green.zadka.com>

On Wed, 23 Oct 2002, Paul Moore <gustav at morpheus.demon.co.uk> wrote:

> OK, I'll see what I can do. What's the best procedure for submitting a
> patch? Can I post patches to this list?

Yes, you can.

>From the FAQ (in CVS):

I have a patch. How do I maximize the chances the Twisted developers will
include it?

   Use unified diff. Either use cvs diff -u or, better yet, make a clean
   checkout and use diff -urN between them. Make sure your patch applies
   cleanly. Then, send it to the mailing list inlined and without any
   word wrapping.



From ddimoti at mi2.hr  Sat Oct 26 12:35:53 2002
From: ddimoti at mi2.hr (Drazen Dimoti)
Date: Sat, 26 Oct 2002 20:35:53 +0200 (MEST)
Subject: [Twisted-Python] OpenLDAP mapping
Message-ID: <32848.192.168.0.190.1035657353.squirrel@services.mi2.hr>

Hi,

I have made a t.e like mapping for OpenLDAP client library. I have used the
old twisted LDAP while it was still in Twisted but there was no
documentation for it and I realy didn't have time to go over the code to
sort things out. I see there is no LDAP support in Twisted anymore so I made
this mapping.

I'm sending you a schema file, API mapping and an example for adding data to
LDAP server....

jimbo

-------------- next part --------------
A non-text attachment was scrubbed...
Name: ldapapi.py
Type: application/octet-stream
Size: 4467 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021026/a6e3553a/attachment-0008.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ldaptest.py
Type: application/octet-stream
Size: 1819 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021026/a6e3553a/attachment-0009.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: example.ldif
Type: application/octet-stream
Size: 214 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021026/a6e3553a/attachment-0010.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: twisted.schema
Type: application/octet-stream
Size: 1070 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021026/a6e3553a/attachment-0011.obj>

From lordbrain at riseup.net  Sat Oct 26 12:34:37 2002
From: lordbrain at riseup.net (James Crayne)
Date: Sat, 26 Oct 2002 14:34:37 -0400
Subject: [Twisted-Python] Acronym Expansion in Documentation (WARNING: Newbie)
Message-ID: <1035657277.3dbae03d54d63@mail.riseup.net>

Hello, I am a (brand spankin' new)-bie, and the documentation contains 
something that i tripped over.

"The most prevalent kind of plug-in is the TAP (Twisted Application builder) type."

On the first read, I stumbled. On the second, i thought maybe it's a missprint and 
tried to guess at what was really meant.  The catch is that there is no capital P in 
this acronym expansion.  

Newbie think: "(Twisted Application _Pickle_ builder)?"  or "Why isnt it called 
TAB? or TAb?" ...

Then I joined #twisted on irc.freenode as LordBrain, here is a snippet:

<_moshez> yes
<LordBrain> ok
<_moshez> it's "Twisted APplication"
<LordBrain> ooooooh
<LordBrain> thanks
<spiv> _moshez: :)
<LordBrain> now it makes more sense
<spiv> _moshez: It is?  You should update the glossary then :)
<_moshez> spiv: I'm serious
<spiv> _moshez: I don't doubt it :)
<_moshez> spiv: well, sometimes it means Twisted Application Pickle
<spiv> _moshez: Right.  Actually, I'll update the glossary.
<LordBrain> but not in this case
<_moshez> spiv: mktap is "MaKe Twisted APplication"
<_moshez> while web.tap is "Web Twisted Application Pickle"

Non-newbies ascertain which is meant by context.

There are multiple places where this acronym is expanded in the Documentation. 
Consider changing all of them so that the second p in Application is capitalized 
(when/if appropriate). For example, the line that tripped me would read: "The 
most prevalent kind of plug-in is the TAP (Twisted APplication builder) type."

Thanks,
LordBrain

PS: CC reply if you wish me to see it, I am not on this list.




From andrew-twisted at puzzling.org  Sat Oct 26 18:46:40 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 27 Oct 2002 11:46:40 +1100
Subject: [Twisted-Python] OpenLDAP mapping
In-Reply-To: <32848.192.168.0.190.1035657353.squirrel@services.mi2.hr>
References: <32848.192.168.0.190.1035657353.squirrel@services.mi2.hr>
Message-ID: <20021027004640.GA489@frobozz.local>

On Sat, Oct 26, 2002 at 08:35:53PM +0200, Drazen Dimoti wrote:
> Hi,
> 
> I have made a t.e like mapping for OpenLDAP client library. I have used the
> old twisted LDAP while it was still in Twisted but there was no
> documentation for it and I realy didn't have time to go over the code to
> sort things out. I see there is no LDAP support in Twisted anymore so I made
> this mapping.

The LDAP support is now available as a seperate package:
    http://twistedmatrix.com/users/tv/ldaptor/

> I'm sending you a schema file, API mapping and an example for adding data to
> LDAP server....

Thanks!

-Andrew.




From justin at gnubian.org  Sat Oct 26 19:13:28 2002
From: justin at gnubian.org (Justin Ryan)
Date: 26 Oct 2002 20:13:28 -0500
Subject: [Twisted-Python] twisted/debian howto not avail?
Message-ID: <1035681209.28626.90.camel@qutang>

Heya all, when I visit [1] via the link on [2], I get:

-snip-

No Such Resource

File not found.

-snip-

Has the Debian/Twisted howto moved?  If so, the link should be updated..

[1] http://twistedmatrix.com/documents/howto/twisted-debian
[2] http://twistedmatrix.com/documents/admin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021026/edae731c/attachment.sig>

From radix at twistedmatrix.com  Sun Oct 27 07:34:20 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 27 Oct 2002 15:34:20 +0100
Subject: [Twisted-Python] Acronym Expansion in Documentation (WARNING: Newbie)
In-Reply-To: <1035657277.3dbae03d54d63@mail.riseup.net>
References: <1035657277.3dbae03d54d63@mail.riseup.net>
Message-ID: <20021027143420.GA1335@twistedmatrix.com>

On Sat, Oct 26, 2002 at 02:34:37PM -0400, James Crayne wrote:
> Hello, I am a (brand spankin' new)-bie, and the documentation contains 
> something that i tripped over.
> 
> "The most prevalent kind of plug-in is the TAP (Twisted Application builder) type."
> 
> On the first read, I stumbled. On the second, i thought maybe it's a missprint and 
> tried to guess at what was really meant.  The catch is that there is no capital P in 
> this acronym expansion.  
> 
> Newbie think: "(Twisted Application _Pickle_ builder)?"  or "Why isnt it called 
> TAB? or TAb?" ...

Yeah, this has bothered me for a while; I'd personally like to rename
`mktap' to `mkapp', and save the acronym "tap" specifically for
"Twisted Application Pickle", but glyph doesn't seem to like that idea
:-)

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From mike.twisted at snitzer.net  Sun Oct 27 11:49:55 2002
From: mike.twisted at snitzer.net (Mike Snitzer)
Date: Sun, 27 Oct 2002 13:49:55 -0500
Subject: [Twisted-Python] mktap web --index patch
Message-ID: <20021027184955.GA6343@snitzer.net>

All,

It would appear that a twisted web server can't be easily configured
(via mktap web --index) to use both index.html _and_ index.php (or any
other combination) as directory indexes.

mktap2.1 web --help
...
  -i, --index=            Add the name of a file used to check for directory
                          indexes. [default: index, index.html]

SO.. I tried:
1) mktap2.1 web --path ~/public_html/ --index index.php 
and my php indexed directories work; but index.html indexed dirs do not

2) mktap2.1 web --path ~/public_html/ --index index.html,index.php
and get the mktap web usage

I've got to believe what I'm looking to do is something others would want
to be able to configure too.  However, the relevant twisted/tap/web.py
code will only allow the user to add a single directory index; pretty
strange limitation... 

Here's a patch to enable a user to specify multiple directory indexes to
the web server via mktap (i.e. like #2 above):

--- Twisted.orig/twisted/tap/web.py     Wed Oct 23 07:56:52 2002
+++ Twisted/twisted/tap/web.py  Sun Oct 27 13:35:34 2002
@@ -54,10 +54,11 @@
         self.opts['root'] = None
 
     def opt_index(self, indexName):
-        """Add the name of a file used to check for directory indexes.
+        """Add the name of a file(s) used to check for directory indexes.
         [default: index, index.html]
         """
-        self.opts['indexes'].append(indexName)
+        for index in string.split(indexName,','):
+            self.opts['indexes'].append(index)
 
     opt_i = opt_index







From radix at twistedmatrix.com  Sun Oct 27 12:58:32 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 27 Oct 2002 20:58:32 +0100
Subject: [Twisted-Python] mktap web --index patch
In-Reply-To: <20021027184955.GA6343@snitzer.net>
References: <20021027184955.GA6343@snitzer.net>
Message-ID: <20021027195832.GB1873@twistedmatrix.com>

On Sun, Oct 27, 2002 at 01:49:55PM -0500, Mike Snitzer wrote:
> SO.. I tried:
> 1) mktap2.1 web --path ~/public_html/ --index index.php 
> and my php indexed directories work; but index.html indexed dirs do not
> 
> 2) mktap2.1 web --path ~/public_html/ --index index.html,index.php
> and get the mktap web usage

mktap web --path ~/public_html/ -i index.html -i index.php -i ... 

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From mike.twisted at snitzer.net  Sun Oct 27 13:41:04 2002
From: mike.twisted at snitzer.net (Mike Snitzer)
Date: Sun, 27 Oct 2002 15:41:04 -0500
Subject: [Twisted-Python] Re: mktap web --index patch
In-Reply-To: <20021027195832.GB1873@twistedmatrix.com>
References: <20021027184955.GA6343@snitzer.net> <20021027195832.GB1873@twistedmatrix.com>
Message-ID: <20021027204104.GA7629@snitzer.net>

Christopher Armstrong (radix at twistedmatrix.com) said:

> mktap web --path ~/public_html/ -i index.html -i index.php -i ... 

Ah thanks, I didn't think to try stringing a bunch of -i's together.

On a completely unrelated note; I've created a "Powered by Twisted" icon
and attached it for all those interested (it's _very_ small (1.5K); and
I'm not sure if something similar already exists or not).

Mike
-------------- next part --------------
A non-text attachment was scrubbed...
Name: poweredby_twisted.png
Type: image/png
Size: 1548 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021027/2d0bc451/attachment-0002.png>

From twisted_low at contact.com.my  Sun Oct 27 20:30:56 2002
From: twisted_low at contact.com.my (lals;dfjsd)
Date: Mon, 28 Oct 2002 11:30:56 +0800
Subject: [Twisted-Python] Quixote ???
Message-ID: <200210281130.AA18678018@contact.com.my>

Dear People,

can anyone tell me if quixote has been sucessfully been integrated into twisted matrix and can someone pls show me how get my box ( windows 98 ) with quixote working together with twisted matrix ??





From jonathan.lange at turnaroundsolutions.com  Mon Oct 28 01:55:44 2002
From: jonathan.lange at turnaroundsolutions.com (Jonathan Lange)
Date: Mon, 28 Oct 2002 19:55:44 +1100
Subject: [Twisted-Python] row howto patch
Message-ID: <8264704D39C2DC46A60DD84F34A818241C7D90@bab4.hobart.tas>

The row howto has a syntax error in the bit about rowForeignKeys. 
"[(tableName, [(columnName, columnType)], containerMethodName, autoLoad]"

I had a look at the source code, and the error appears to be a little deeper, in that there should be two lists of columns, one for parent columns, one for child columns.

Patch below, sorry if formatting is poor, I'm on Outlook web access.

jml


Index: doc/howto/row.html
===================================================================
RCS file: /cvs/Twisted/doc/howto/row.html,v
retrieving revision 1.17
diff -u -r1.17 row.html
--- doc/howto/row.html	27 Oct 2002 20:46:24 -0000	1.17
+++ doc/howto/row.html	28 Oct 2002 08:33:54 -0000
@@ -48,8 +48,8 @@
 
 <ul>
   <li>rowForeignKeys - list of foreign keys to other database tables
-  in the form: [(tableName, [(columnName, columnType)], containerMethodName,
-  autoLoad]</li>
+  in the form: [(tableName, [(childColumnName, childColumnType)], 
+  [(parentColumnName, parentColumnType)], containerMethodName, autoLoad]</li>
   <li>rowFactoryMethod - a method that creates instances of this
   class</li>
 </ul>




From twisted at itamarst.org  Mon Oct 28 08:50:32 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 28 Oct 2002 10:50:32 -0500
Subject: [Twisted-Python] row howto patch
In-Reply-To: <8264704D39C2DC46A60DD84F34A818241C7D90@bab4.hobart.tas>
References: <8264704D39C2DC46A60DD84F34A818241C7D90@bab4.hobart.tas>
Message-ID: <20021028105032.4e9722d4.twisted@itamarst.org>

On Mon, 28 Oct 2002 19:55:44 +1100
"Jonathan Lange" <jonathan.lange at turnaroundsolutions.com> wrote:

> +  in the form: [(tableName, [(childColumnName, childColumnType)], 
> +  [(parentColumnName, parentColumnType)], containerMethodName,
> autoLoad]</li>

Done.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From jonathan.lange at turnaroundsolutions.com  Mon Oct 28 04:09:01 2002
From: jonathan.lange at turnaroundsolutions.com (Jonathan Lange)
Date: Mon, 28 Oct 2002 22:09:01 +1100
Subject: [Twisted-Python] suggestion: t.enterprise.reflector populated errback
Message-ID: <8264704D39C2DC46A60DD84F34A818241C7D91@bab4.hobart.tas>

In twisted.enterprise.reflector, the Reflector constructor takes a populatedCallback argument. In SQLReflector, this is called after the reflector instance is successfully populated.

Surely, if it's possible to specify a callback, it should be possible to specify errback?

cheers,
jml



From jonathan.lange at turnaroundsolutions.com  Mon Oct 28 05:17:39 2002
From: jonathan.lange at turnaroundsolutions.com (Jonathan Lange)
Date: Mon, 28 Oct 2002 23:17:39 +1100
Subject: [Twisted-Python] Asynchronous unit tests
Message-ID: <8264704D39C2DC46A60DD84F34A818241C7D92@bab4.hobart.tas>


Attached is an asynchronous unit testing framework.

If you inherit from deferunittest.DeferredTestCase instead of inheriting from unittest.TestCase, then test methods can return a Deferred, which should be handled appropriately by the framework.

An example test suite is also attached.

Note that this required some modifications to the pyunit.unittest, in order to make things accessible to the subclass. A patch to the unittest.py currently in twisted cvs is attached.

I'm not feeling too sure about this whole thing, so feedback is highly appreciated.

cheers,
jml


-------------- next part --------------
A non-text attachment was scrubbed...
Name: unittest.py-patch
Type: application/octet-stream
Size: 6075 bytes
Desc: unittest.py-patch
URL: </pipermail/twisted-python/attachments/20021028/80a81778/attachment-0006.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: deferunittest.py
Type: application/octet-stream
Size: 3295 bytes
Desc: deferunittest.py
URL: </pipermail/twisted-python/attachments/20021028/80a81778/attachment-0007.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_deferdemo.py
Type: application/octet-stream
Size: 3280 bytes
Desc: test_deferdemo.py
URL: </pipermail/twisted-python/attachments/20021028/80a81778/attachment-0008.obj>

From glyph at twistedmatrix.com  Tue Oct 29 16:24:46 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 29 Oct 2002 17:24:46 -0600 (CST)
Subject: [Twisted-Python] crasher
Message-ID: <20021029.172446.68561627.glyph@twistedmatrix.com>


Okay, I've discovered a _very very_ odd bug in Twisted.  In trying to get this
stupid web/issues conduit thing working on Mac IE, I was trying all kinds of
crazy nonsense.  In particular there was one bit where I tried to make
issueconduit close the connection after the server sent each message, so it
would be immediately displayed, and then have the browser re-open the
connection after a second to retrieve any new messages.  (Mac IE doesn't allow
you to modify pages with Javascript that haven't been fully loaded for some
reason.) I did this using js timeouts and setting the src attribute on a hidden
iframe.

What happened next was not what I expected at all.  First, the server started
sending me the welcome message in a loop.  (This is probably just a bug in the
conduit code, nothing serious.)  However, when I entered something in the text
field and hit "enter", twistd _locked up hard_.  I couldn't even send it a
SIGTERM.  So I killed it and tried again a few times.  It would reliably lock
up after trying to send a message.  Best of all, this does not normally happen:
it is quite possible to interact with the server using the default js (with
some trivial changes); the only problem is that the updates won't show up until
the connection is finished.

The only thing I could think of that would be useful for debugging info is
strace, since it was wedged so hard and I didn't know where.  Here's what I
got:

    ...
    munmap(0x4001b000, 4096)                = 0
    close(9)                                = 0
    gettimeofday({1035895791, 342136}, NULL) = 0
    send(6, "HTTP/1.1 200 OK\r\nTransfer-encodi"..., 136, 0) = 136
    send(6, "c3\r\n&lt;IssueBot&gt; A SUPPORT R"..., 201, 0) = 201
    send(6, "0\r\n\r\n", 5, 0)              = 5
    gettimeofday({1035895791, 345729}, NULL) = 0
    gettimeofday({1035895791, 346897}, NULL) = 0
    write(1, "29/10/2002 06:49 [HTTPChannel,0,"..., 20529/10/2002 06:49 [HTTPChannel,0,64.123.27.109] 64.123.27.109 - - [29/Oct/2002:12:49:50 +0000] "<GET /issues.rpy/conduit?output=135 HTTP/1.1>" 200 195 "-" "Mozilla/4.0 (compatible; MSIE 5.14; Mac_PowerPC)"
    ) = 205
    brk(0x846d000)                          = 0x846d000
    old_mmap(NULL, 245760, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x4035b000
    brk(0x8433000)                          = 0x8433000
    mremap(0x4035b000, 245760, 245760, MREMAP_MAYMOVE) = 0x4035b000
    mremap(0x4035b000, 245760, 245760, MREMAP_MAYMOVE) = 0x4035b000
    mremap(0x4035b000, 245760, 245760, MREMAP_MAYMOVE) = 0x4035b000
    mremap(0x4035b000, 245760, 245760, MREMAP_MAYMOVE) = 0x4035b000
    ...

It then repeats "mremap" basically forever, and the various numbers there
increase very gradually.

So for some reason, Twisted is trying to allocate some huuuge chunk of memory.
Is there a way to get gdb to tell me where in python this is happening?

I am going out of my mind trying to figure out a way to debug this, so extra
eyes are helpful, but I don't think this bug can be found through normal
bughunting; you'd have to be pretty familiar with whatever code is causing the
problem.  I figure it might be either woven, twisted.protocols.http or
twisted.internet.

Help? :-)

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021029/e042314a/attachment.sig>

From glyph at twistedmatrix.com  Tue Oct 29 16:28:59 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 29 Oct 2002 17:28:59 -0600 (CST)
Subject: [Twisted-Python] crasher
In-Reply-To: <20021029.172446.68561627.glyph@twistedmatrix.com>
References: <20021029.172446.68561627.glyph@twistedmatrix.com>
Message-ID: <20021029.172859.66181015.glyph@twistedmatrix.com>

On Tue, 29 Oct 2002 17:24:46 -0600 (CST), Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> Okay, I've discovered a _very very_ odd bug in Twisted.

I almost forgot: since the behavior is so hard to describe properly, a CVS tree
with the appropriate changes to it is present in ~glyph/Projects/Twisted on
pyramid.  The changed files are twisted/issues/ui/templates/conduit_msie.js,
twisted/issues/ui/issueconduit.py, and twisted/issues/ui/conduit.html.

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021029/d0bab3d1/attachment.sig>

From andrew-twisted at puzzling.org  Tue Oct 29 16:50:57 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 30 Oct 2002 10:50:57 +1100
Subject: [Twisted-Python] crasher
In-Reply-To: <20021029.172446.68561627.glyph@twistedmatrix.com>
References: <20021029.172446.68561627.glyph@twistedmatrix.com>
Message-ID: <20021029235057.GB473@frobozz.local>

On Tue, Oct 29, 2002 at 05:24:46PM -0600, Glyph Lefkowitz wrote:
> 
> I am going out of my mind trying to figure out a way to debug this, so extra
> eyes are helpful, but I don't think this bug can be found through normal
> bughunting; you'd have to be pretty familiar with whatever code is causing the
> problem.  I figure it might be either woven, twisted.protocols.http or
> twisted.internet.
> 
> Help? :-)

Isn't there a hack you can do to sys.settracehook (or whatever it is) to
print each python function call entry & exit?  That would help narrow stuff
down.

I've also heard there's a gdb hack which lets it understand Python
tracebacks, so that it correctly displays them intermingled with the C
traceback when you issue a 'bt' command... but I can't seem to find it :(

Also, this url from google looks promising:
    http://groups.google.com/groups?q=gdb+python+traceback&hl=en&lr=&ie=UTF-8&safe=off&selm=14201.27231.1003.466027%40anthem.cnri.reston.va.us&rnum=4

Choice quote:
"""
First, get the pid of the running Python process.  Start up gdb on the
python executable and at the gdb prompt type "attach XXX" where XXX is
the pid.  Now, at the gdb prompt, type the following:

(gdb) call PyRun_SimpleString("import sys, traceback; sys.stderr=open('/tmp/tb','w',0); traceback.print_stack()")
"""

-Andrew.




From ASCHERBI at arinc.com  Tue Oct 29 17:00:27 2002
From: ASCHERBI at arinc.com (Scherbina, Alexander (ASCHERBI))
Date: Tue, 29 Oct 2002 19:00:27 -0500
Subject: [Twisted-Python] addWriter
Message-ID: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>

Hello Everyone!

I have a server that queues messages for clients.  The Queue object has a
callback from the ConnectionFactory, which deals with output formatting and
holds the Protocol object.  As soon as a client connects, the
ConnectionFactory peeks in the Queue for messages to be sent.  And if there
are any, it will send and dequeue and peek again until the Queue is
exhausted.   Once it's exhausted, the ConnectionFactory will be called
(using the callback) by the Queue when the next message is enqueued by the
Deliver module.

So far, this mechanism works well.  But one of its flaws is the partial
write situation.  If output buffer overflow occurred, I would like to
continue doing other things and get called back by the Reactor when the
socket is writable again.  Moreover, I would like to break the direct
association between the Queue and the ConnectionFactory.  

Instead, I would like to tie them through some kind of a notification
strategy (like in ACE), where my ConnectionFactory would be notifed by the
Reactor when the socket is writable, then the ConnectionFactory could peek,
send, dequeue and wait for the next notification.

I thought, addWriter/doWrite is what I need to use.  When I used them, my
ConnectionFactory's doWrite was never called after a client connected.

Is addWriter/doWrite approach correct?  Or am I going in a totally wrong
direction?  Please, help, if you can.

Thank you,
Alex Scherbina



From andrew-twisted at puzzling.org  Tue Oct 29 17:08:49 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 30 Oct 2002 11:08:49 +1100
Subject: [Twisted-Python] crasher
In-Reply-To: <20021029235057.GB473@frobozz.local>
References: <20021029.172446.68561627.glyph@twistedmatrix.com> <20021029235057.GB473@frobozz.local>
Message-ID: <20021030000849.GC473@frobozz.local>

On Wed, Oct 30, 2002 at 10:50:57AM +1100, Andrew Bennetts wrote:
> 
> I've also heard there's a gdb hack which lets it understand Python
> tracebacks, so that it correctly displays them intermingled with the C
> traceback when you issue a 'bt' command... but I can't seem to find it :(

Ok, I found where I saw this mentioned:
    http://mail.python.org/pipermail/python-dev/2002-July/027110.html

But I can't seem to find the patch he refers to.

There's also this, which apparently works, but slowly:
    http://mail.python.org/pipermail/python-dev/2001-June/015340.html

-Andrew.




From andrew-twisted at puzzling.org  Tue Oct 29 17:16:12 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 30 Oct 2002 11:16:12 +1100
Subject: [Twisted-Python] addWriter
In-Reply-To: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>
References: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>
Message-ID: <20021030001611.GD473@frobozz.local>

On Tue, Oct 29, 2002 at 07:00:27PM -0500, Scherbina, Alexander (ASCHERBI) wrote:
[..snip..]
> 
> So far, this mechanism works well.  But one of its flaws is the partial
> write situation.  If output buffer overflow occurred, I would like to
> continue doing other things and get called back by the Reactor when the
> socket is writable again.  Moreover, I would like to break the direct
> association between the Queue and the ConnectionFactory.  

Why are having problems with partial writes?  Your Protocol should simply call
self.transport.write(...), which will take care of all the hard work of
sending stuff at the appropriate times.  The Reactor will automatically wake
up the Transport when the socket is ready for writing, and the Transport
will automatically write anything that is waiting to be written.

> Is addWriter/doWrite approach correct?  Or am I going in a totally wrong
> direction?  Please, help, if you can.

It sounds to me like you're going in completely the wrong direction :)

Twisted does all of the hard work for you :)

The idea is you simply say "write this to this connection please" and
Twisted will do everything else... it'll handle partial writes, it'll handle
waiting until the socket is writeable.

Have you read the "Writing Clients" HOWTO?

-Andrew.




From exarkun at meson.dyndns.org  Tue Oct 29 17:16:50 2002
From: exarkun at meson.dyndns.org (Jp Calderone)
Date: Tue, 29 Oct 2002 19:16:50 -0500
Subject: [Twisted-Python] Pynfo (I'm back)
In-Reply-To: <3086.192.168.2.20.1035430218.squirrel@seraphine.csrules.dyndns.org>
References: <20021024023054.GA7029@kenzoid.com> <20021023.222042.07645503.glyph@twistedmatrix.com> <3086.192.168.2.20.1035430218.squirrel@seraphine.csrules.dyndns.org>
Message-ID: <20021030001650.GA28973@meson.dyndns.org>

On Wed, Oct 23, 2002 at 10:30:18PM -0500, Maniac - wrote:
> Dont really know where to broach this but:
> 
> I've been looking at the code for pynfo and there's some functionality
> i'd like to wedge in there i.e. logging to a database (for example) but
> i'd like to be able to do it without affecting the main code. Is there a
> reasonable way to create an external plugin that could be inserted at
> runtime?
> 

  (I don't know if you've already figured this out or not;  I'm posting
anyway on the off-chance you haven't and are still interested in using the
code-base, or someone else has taken an interest in the topic)

  I'm a little ashamed to say that Pynfo is a big, stinky hack.  There's no
kind of modularity, and only a half-hearted attempt at any kind of "plugin"
interface.  The freshmeat (non-functional) and google capabilities would be
the best example of how to go about this, but they're not done in such a way
as to allow you to not affect the main code with your desired additions. 

  Perhaps a good course of action would be for you to just hack what you
want into the main code and send me a patch, then I can try to refactor both
of our "plugins" into something that resembles an actual plugin interface.

  Jp

-- 
"One World, one Web, one Program." - Microsoft(R) promotional ad
"Ein Volk, ein Reich, ein Fuhrer." - Adolf Hitler
--
 7:00pm up 161 days, 20:59, 2 users, load average: 0.06, 0.06, 0.02
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021029/94d9de12/attachment.sig>

From developer at csrules.dyndns.org  Tue Oct 29 19:38:17 2002
From: developer at csrules.dyndns.org (Maniac -)
Date: Tue, 29 Oct 2002 20:38:17 -0600 (CST)
Subject: [Twisted-Python] Pynfo (I'm back)
Message-ID: <2256.192.168.2.20.1035945497.squirrel@seraphine.csrules.dyndns.org>

I'm still interested in an IRC (or jabber) bot based
on the twisted framework. I dont want to mess with
an existing code base because of how bad a programmer I
am (hence the desire for plug-in functionality)

A common way seems to have plugins respond to IRC events
via handlers. How to do this?
/me shrugs

The one i'm using now is pybot.sourceforge.net

-M

> On Wed, Oct 23, 2002 at 10:30:18PM -0500, Maniac - wrote:
>> Dont really know where to broach this but:
>>
>> I've been looking at the code for pynfo and there's some
>> functionality i'd like to wedge in there i.e. logging to a database
>> (for example) but i'd like to be able to do it without affecting the
>> main code. Is there a reasonable way to create an external plugin
>> that could be inserted at runtime?
>>
>
>   (I don't know if you've already figured this out or not;  I'm
> posting
> anyway on the off-chance you haven't and are still interested in using
> the code-base, or someone else has taken an interest in the topic)
>
>   I'm a little ashamed to say that Pynfo is a big, stinky hack.
> There's
> no
> kind of modularity, and only a half-hearted attempt at any kind of
> "plugin" interface.  The freshmeat (non-functional) and google
> capabilities would be the best example of how to go about this, but
> they're not done in such a way as to allow you to not affect the main
> code with your desired additions.
>
>   Perhaps a good course of action would be for you to just hack what
> you
> want into the main code and send me a patch, then I can try to
> refactor both of our "plugins" into something that resembles an actual
> plugin interface.
>
>   Jp
>
> --
> "One World, one Web, one Program." - Microsoft(R) promotional ad "Ein
> Volk, ein Reich, ein Fuhrer." - Adolf Hitler
> --
>  7:00pm up 161 days, 20:59, 2 users, load average: 0.06, 0.06, 0.02






From glyph at twistedmatrix.com  Tue Oct 29 19:59:51 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 29 Oct 2002 20:59:51 -0600 (CST)
Subject: [Twisted-Python] addWriter
In-Reply-To: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>
References: <09328AED5429D311A3000008C7911B1011253705@exanpmb1.arinc.com>
Message-ID: <20021029.205951.131915759.glyph@twistedmatrix.com>

On Tue, 29 Oct 2002 19:00:27 -0500, "Scherbina, Alexander (ASCHERBI)" <ASCHERBI at arinc.com> wrote:
> I thought, addWriter/doWrite is what I need to use.  When I used them, my
> ConnectionFactory's doWrite was never called after a client connected.
> 
> Is addWriter/doWrite approach correct?  Or am I going in a totally wrong
> direction?  Please, help, if you can.

Depending on your requirements, you should either be doing what spiv suggested
earlier (e.g. "nothing, just call transport.write") or you should be looking
into the producer/consumer API, which will allow you to produce streams of data
on demand.  Last I checked this wasn't terribly well documented, but it's
fairly straightforward and the code in twisted.web.static.FileTransfer is a
decent example.

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021029/4fd28707/attachment.sig>

From screwtape at froup.com  Tue Oct 29 19:58:10 2002
From: screwtape at froup.com (screwtape at froup.com)
Date: Wed, 30 Oct 2002 13:58:10 +1100
Subject: [Twisted-Python] Pynfo (I'm back)
In-Reply-To: <20021030001650.GA28973@meson.dyndns.org>
References: <20021024023054.GA7029@kenzoid.com> <20021023.222042.07645503.glyph@twistedmatrix.com> <3086.192.168.2.20.1035430218.squirrel@seraphine.csrules.dyndns.org> <20021030001650.GA28973@meson.dyndns.org>
Message-ID: <20021030025810.GA4138@ferd2.thristian.org>

On Tue, Oct 29, 2002 at 07:16:50PM -0500, Jp Calderone wrote:
> On Wed, Oct 23, 2002 at 10:30:18PM -0500, Maniac - wrote:
> > Dont really know where to broach this but:
> > 
> > I've been looking at the code for pynfo and there's some functionality
> > i'd like to wedge in there i.e. logging to a database (for example) but
> > i'd like to be able to do it without affecting the main code. Is there a
> > reasonable way to create an external plugin that could be inserted at
> > runtime?
> 
>   (I don't know if you've already figured this out or not;  I'm posting
> anyway on the off-chance you haven't and are still interested in using the
> code-base, or someone else has taken an interest in the topic)

<snip>

Have *I* got *news* for *you*.

It just so happens that these last few weeks I've been working on a
module-based bot for twisted.im - and hence, and IRC bot. It's still
rather under development, but what *does* work now is dynamic loading
and unloading of plugins. :)

Current version is here:

	http://members.optusnet.com.au/thristian/twisted-bot.tar.gz

In the very near future, I hope to be changing the plugin API - I want
to be able to pass config information (likely a handle to the config
module) into each plugin, and possibly to send shutdown messages as
well.

Have a look, tell me what you like and don't like, tell me what you
want, and please - feel free to send patches. :)

-- 
 ___________ ____________________________
| Screwtape | Reply-To: munged on Usenet |________ ______ ____ __ _  _   _
|
| I M  R UNNi NG   OU T  Of FR 1DG3    MAGN TS
|



From twisted at itamarst.org  Tue Oct 29 22:59:11 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 30 Oct 2002 00:59:11 -0500
Subject: [Twisted-Python] New UDP API
Message-ID: <20021030005911.009553c6.twisted@itamarst.org>

I just checked in a refactored UDP API into CVS. Please take a look and
comment.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting



From twisted at itamarst.org  Tue Oct 29 23:23:09 2002
From: twisted at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 30 Oct 2002 01:23:09 -0500
Subject: [Twisted-Python] New UDP API
In-Reply-To: <20021030005911.009553c6.twisted@itamarst.org>
References: <20021030005911.009553c6.twisted@itamarst.org>
Message-ID: <20021030012310.4ef419cb.twisted@itamarst.org>

On Wed, 30 Oct 2002 00:59:11 -0500
Itamar Shtull-Trauring <twisted at itamarst.org> wrote:

> I just checked in a refactored UDP API into CVS. Please take a look
> and comment.

And I guess some explanations are in order. I disabled twisted.names
test for the checkin, as it tests were failing. Commenting out tests
cause they break is a bad thing - DO NOT DO THIS AT HOME CHILDREN. I
only did it because names was inherently broken, as conformed by the
maintainer. And looks like I volunteered to do some fixing :/

Anyway, the new API:

Unconnected UDP ports
=====================
   port = reactor.listenUDP(port, protocol)

protocol is instance of DatagramProtocol, which unlike TCP protocols is
expected to be persistent. It will get start/stopProtocol called at the
appropriate time.

protocols' datagramReceived(data, (host, port)) method will be called
when they receive datagram, and the can self.transport.write(data,
(host, port)).


Connected UDP ports
===================
   port = reactor.connectUDP(remotehost, remoteport, protocol)

protocol is instance of ConnectedDatagramProtocol, which unlike TCP
protocols is expected to be persistent. It will get start/stopProtocol
called at the appropriate time.

protocols' datagramReceived(data) method will be called when they
receive datagram, and the can self.transport.write(data).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python, Twisted, Zope and Java consulting
***> http://VoteNoWar.org -- vote/donate/volunteer <***



From gilh at sympatico.ca  Wed Oct 30 08:48:25 2002
From: gilh at sympatico.ca (Gil Hauer)
Date: 30 Oct 2002 10:48:25 -0500
Subject: [Twisted-Python] web site error
Message-ID: <1035992906.1778.4.camel@giantclam>

Hi,

I'm trying to navigate the site but many (almost all) of the pages show
an error page of the form:

web.Server Traceback
exceptions.IOError: [Errno 24] Too many open files:
'/var/www/WebSite/twistedmatrix.com/products/twisted'

... just thought you might like to know.

Gil
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021030/d8cc0ca3/attachment.sig>

From radix at twistedmatrix.com  Tue Oct 29 09:10:11 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 29 Oct 2002 17:10:11 +0100
Subject: [Twisted-Python] web site error
In-Reply-To: <1035992906.1778.4.camel@giantclam>
References: <1035992906.1778.4.camel@giantclam>
Message-ID: <20021029161011.GB515@twistedmatrix.com>

On Wed, Oct 30, 2002 at 10:48:25AM -0500, Gil Hauer wrote:
> web.Server Traceback
> exceptions.IOError: [Errno 24] Too many open files:
> '/var/www/WebSite/twistedmatrix.com/products/twisted'
> 
> ... just thought you might like to know.

Fixed, for now. Glyph mentioned this bug last night, and now we see
the results of it ... The web server is leaking sockets. Anyone have a
clue?

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From gilh at sympatico.ca  Wed Oct 30 12:00:11 2002
From: gilh at sympatico.ca (Gil Hauer)
Date: 30 Oct 2002 14:00:11 -0500
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <20021017052440.22779.qmail@green.zadka.com>
References: <1034793181.1935.35.camel@giantclam> 
	<20021017052440.22779.qmail@green.zadka.com>
Message-ID: <1036004412.1778.22.camel@giantclam>

Hi again,

Can you send me a pointer to some documentation that describes how to
set up virtual host functionality?

Thanks,
Gil

On Thu, 2002-10-17 at 01:24, Moshe Zadka wrote:
> On 16 Oct 2002, Gil Hauer <gilh at sympatico.ca> wrote:
> 
> > I'd like one server to be able to host several web sites, hence:
> > 
> > Is it possible to use Twisted.web with virtual host functionality such
> > as that provided by Apache?
> 
> Is it ever!
> You can decide to go with one big process for all of them, a front server
> and a seperate server for each virtual host (for example, for permission
> reasons), and you can even mix-and-math between Apache and Twisted (for
> example, put Apache in the front and have Twisted handle some subset of the
> virtual host).  
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 232 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20021030/e488eed9/attachment.sig>

From abe at fettig.net  Wed Oct 30 15:57:19 2002
From: abe at fettig.net (Abe Fettig)
Date: 30 Oct 2002 17:57:19 -0500
Subject: [Twisted-Python] Hep, a Twisted project
Message-ID: <1036018639.692.74.camel@mingus>

Hi all,

I just released version 0.3 of Hep, my multiprotocol message server. 
The big change in this release is that Hep is now using Twisted for all
its networking stuff:  HTTP and XMLRPC clients, POP3, SMTP, and web
servers.

The Hep web page is:
http://www.fettig.net/projects/hep.

Thanks for the nice software!

Abe




From andrew-twisted at puzzling.org  Wed Oct 30 16:09:51 2002
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 31 Oct 2002 10:09:51 +1100
Subject: [Twisted-Python] twisted.web question
In-Reply-To: <1036004412.1778.22.camel@giantclam>
References: <1034793181.1935.35.camel@giantclam> <20021017052440.22779.qmail@green.zadka.com> <1036004412.1778.22.camel@giantclam>
Message-ID: <20021030230951.GA27768@ritsuko.xware.cx>

On Wed, Oct 30, 2002 at 02:00:11PM -0500, Gil Hauer wrote:
> Hi again,
> 
> Can you send me a pointer to some documentation that describes how to
> set up virtual host functionality?

This is documented in CVS Twisted.  If you can't access CVS, you can
find a ps/pdf version of the CVS docs here:
    http://twistedmatrix.com/users/moshez/book.ps.bz2
    http://twistedmatrix.com/users/moshez/book.pdf

Those links aren't "official" docs yet (we're still working on the
script that generates them, there's a couple of glitches), but they
should contain exactly the same content as the doc/howto/*.xhtml files
from CVS Twisted.

-Andrew.




From glyph at twistedmatrix.com  Wed Oct 30 16:34:50 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 30 Oct 2002 17:34:50 -0600 (CST)
Subject: [Twisted-Python] web site error
In-Reply-To: <20021029161011.GB515@twistedmatrix.com>
References: <1035992906.1778.4.camel@giantclam>
	<20021029161011.GB515@twistedmatrix.com>
Message-ID: <20021030.173450.63128778.glyph@twistedmatrix.com>


On Tue, 29 Oct 2002 17:10:11 +0100, Christopher Armstrong <radix at twistedmatrix.com> wrote:
> Fixed, for now. Glyph mentioned this bug last night, and now we see
> the results of it ... The web server is leaking sockets. Anyone have a
> clue?

Well, it's not really leaking them.  As far as I can tell, the other end of the
socket isn't closing the connection, so Twisted just keeps it open 'cause
there's no timeout.  If there were a timeout, that would mean that proxying
certain things through HTTP might break.  What I'm wondering is why _other_
webservers don't suffer from this problem.  Do they have a timeout?  Is there
something else happening in Twisted that I'm missing?  This is certainly a very
frustrating bug to test for.  (After all, it's possible that this is some
impossibly obscure errno that we're not accounting for, too...)

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021030/22f1b3f0/attachment.sig>

From bruce at cubik.org  Wed Oct 30 16:47:53 2002
From: bruce at cubik.org (Bruce Mitchener)
Date: Wed, 30 Oct 2002 16:47:53 -0700
Subject: [Twisted-Python] web site error
References: <1035992906.1778.4.camel@giantclam>	<20021029161011.GB515@twistedmatrix.com> <20021030.173450.63128778.glyph@twistedmatrix.com>
Message-ID: <3DC06FA9.9040709@cubik.org>

Glyph Lefkowitz wrote:
> On Tue, 29 Oct 2002 17:10:11 +0100, Christopher Armstrong <radix at twistedmatrix.com> wrote:
> 
>>Fixed, for now. Glyph mentioned this bug last night, and now we see
>>the results of it ... The web server is leaking sockets. Anyone have a
>>clue?
> 
> Well, it's not really leaking them.  As far as I can tell, the other end of the
> socket isn't closing the connection, so Twisted just keeps it open 'cause
> there's no timeout.  If there were a timeout, that would mean that proxying
> certain things through HTTP might break.  What I'm wondering is why _other_
> webservers don't suffer from this problem.  Do they have a timeout?  Is there
> something else happening in Twisted that I'm missing?  This is certainly a very
> frustrating bug to test for.  (After all, it's possible that this is some
> impossibly obscure errno that we're not accounting for, too...)

For whatever little it is worth, I've had troubles like this in the past 
with our own homebrew webserver in our games at work.

There are some buggy web caches and other things out there that keep 
connections open.  We had implemented a connection timeout to work 
around the problem.

  - Bruce




From jjn at kriln.com  Wed Oct 30 16:54:46 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Wed, 30 Oct 2002 23:54:46 +0000 (GMT)
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030.173450.63128778.glyph@twistedmatrix.com>
Message-ID: <20021030235138.P6472-100000@nosferatu.kriln.com>

On Wed, 30 Oct 2002, Glyph Lefkowitz wrote:

> Well, it's not really leaking them.  As far as I can tell, the other end of the
> socket isn't closing the connection, so Twisted just keeps it open 'cause
> there's no timeout.  If there were a timeout, that would mean that proxying
> certain things through HTTP might break.  What I'm wondering is why _other_
> webservers don't suffer from this problem.  Do they have a timeout?  Is there
> something else happening in Twisted that I'm missing?  This is certainly a very
> frustrating bug to test for.  (After all, it's possible that this is some
> impossibly obscure errno that we're not accounting for, too...)

Generally, one would rarely want to have sockets that don't timeout.  To
have sockets without timeout opens a server up to easy DoS attacks.  I
can't imagine a time when you wouldn't want to time out sockets, even if
you're trying to tunnel something over HTTP.  If you pull out an ethernet
cable or a modem phone line, connections don't get closed either.  Any
assumption that connections will always close nicely is flawed.  Though,
maybe I'm misunderstanding what you mean by 'no timeout'

Personally, when I was running high volume web servers, we'd tune down the
keepalive timers to a fairly short interval to keep sockets from getting
tied up too long, to prevent resource availability issues that we were
seeing.

J




From jml at mumak.net  Wed Oct 30 17:33:01 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Thu, 31 Oct 2002 11:33:01 +1100
Subject: [Twisted-Python] reflector init
Message-ID: <20021031003301.GA357@ids.org.au>

The initialisers for reflectors seem to do some interesting stuff. The
SQLReflector in particular does some stuff that requires a callback.
(see twisted.enterprise.*reflector)

Shouldn't this be handled using a Deferred? It's extremely frustrating 
not being able to add an errback.

Suggestions include having a populatedDeferred as a member (rather than
populatedCallback), or moving the populate stuff into a separate method 
that returns a Deferred.

Thoughts?

jml



From jml at mumak.net  Wed Oct 30 18:05:46 2002
From: jml at mumak.net (Jonathan M. Lange)
Date: Thu, 31 Oct 2002 12:05:46 +1100
Subject: [Twisted-Python] reflector init
In-Reply-To: <20021031003301.GA357@ids.org.au>
References: <20021031003301.GA357@ids.org.au>
Message-ID: <20021031010546.GA1143@ids.org.au>

On Thu, Oct 31, 2002 at 11:33:01AM +1100, Jonathan M. Lange wrote:
> Suggestions include having a populatedDeferred as a member (rather than
> populatedCallback)

patches :)

Index: twisted/enterprise/reflector.py
===================================================================
RCS file: /cvs/Twisted/twisted/enterprise/reflector.py,v
retrieving revision 1.9
diff -u -r1.9 reflector.py
--- twisted/enterprise/reflector.py	16 Oct 2002 04:27:29 -0000	1.9
+++ twisted/enterprise/reflector.py	31 Oct 2002 00:57:59 -0000
@@ -20,6 +20,7 @@
 from twisted.enterprise import adbapi
 from twisted.enterprise.util import DBError, getKeyColumn, quote, _TableInfo, _TableRelationship
 from twisted.enterprise.row import RowObject
+from twisted.internet import defer
 
 class Reflector:
     """Base class for enterprise reflectors. This implements rowCacheing.
@@ -61,6 +62,7 @@
         
         from twisted.internet import reactor
         reactor.callLater(0, self._really_populate)
+        self.populatedDeferred = defer.Deferred()
 
     def _really_populate(self):
         """Implement me to populate schema information for the reflector.
Index: twisted/enterprise/sqlreflector.py
===================================================================
RCS file: /cvs/Twisted/twisted/enterprise/sqlreflector.py,v
retrieving revision 1.10
diff -u -r1.10 sqlreflector.py
--- twisted/enterprise/sqlreflector.py	14 Oct 2002 22:34:21 -0000	1.10
+++ twisted/enterprise/sqlreflector.py	31 Oct 2002 00:58:00 -0000
@@ -49,6 +49,7 @@
         defe = self.runInteraction(self._transPopulateSchema)
         if self.populatedCallback:
             defe.addCallbacks(self.populatedCallback)
+        defe.chainDeferred(self.populatedDeferred)
 
     def _transPopulateSchema(self, transaction):
         """Used to construct the row classes in a single interaction.




From glyph at twistedmatrix.com  Wed Oct 30 19:58:32 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 30 Oct 2002 20:58:32 -0600 (CST)
Subject: [Twisted-Python] web site error
In-Reply-To: <3DC06FA9.9040709@cubik.org>
References: <20021029161011.GB515@twistedmatrix.com>
	<20021030.173450.63128778.glyph@twistedmatrix.com>
	<3DC06FA9.9040709@cubik.org>
Message-ID: <20021030.205832.93023286.glyph@twistedmatrix.com>


On Wed, 30 Oct 2002 16:47:53 -0700, Bruce Mitchener <bruce at cubik.org> wrote:
> For whatever little it is worth, I've had troubles like this in the past 
> with our own homebrew webserver in our games at work.

> There are some buggy web caches and other things out there that keep 
> connections open.  We had implemented a connection timeout to work 
> around the problem.

Actually, this is really useful info for me.  It means that I can implement a
timeout with impunity and not worry that I'm doing bad things :).  Now just
have to write the code that determines if a connection has been idle...

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021030/c53be1a7/attachment.sig>

From glyph at twistedmatrix.com  Wed Oct 30 20:06:19 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 30 Oct 2002 21:06:19 -0600 (CST)
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <1036018639.692.74.camel@mingus>
References: <1036018639.692.74.camel@mingus>
Message-ID: <20021030.210619.78707311.glyph@twistedmatrix.com>

On 30 Oct 2002 17:57:19 -0500, Abe Fettig <abe at fettig.net> wrote:
> I just released version 0.3 of Hep, my multiprotocol message server. 

Hey, this looks awesome!! :-D

Obviously with all the different protocol support in Twisted, I had hoped to
eventually implement something like this.  It looks like Hep is quite
application-level though (sending e-mail messages to a weblog, etc), so
hopefully there wouldn't be too much overlap (if I could ever get around to
actually implementing message-transport-abstraction stuff...).

If you've got any message-level abstractions you'd like supported at the
Twisted level (or better yet, patches to unify some of the protocols' approach
to messaging) I'd really like to hear about them.  Thanks for letting us know
about this project!

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021030/c2275813/attachment.sig>

From glyph at twistedmatrix.com  Wed Oct 30 20:06:58 2002
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 30 Oct 2002 21:06:58 -0600 (CST)
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030235138.P6472-100000@nosferatu.kriln.com>
References: <20021030.173450.63128778.glyph@twistedmatrix.com>
	<20021030235138.P6472-100000@nosferatu.kriln.com>
Message-ID: <20021030.210658.59655039.glyph@twistedmatrix.com>

On Wed, 30 Oct 2002 23:54:46 +0000 (GMT), Jeremy Noetzelman <jjn at kriln.com> wrote:
> Personally, when I was running high volume web servers, we'd tune down the
> keepalive timers to a fairly short interval to keep sockets from getting
> tied up too long, to prevent resource availability issues that we were
> seeing.

Just out of curiosity, how does one configure this timeout with apache?

-- 
 |    <`'>    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   < _/ >   |  Lead Developer,  the Twisted project  |
 |  < ___/ >  |      http://www.twistedmatrix.com      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021030/6ae16c2d/attachment.sig>

From twisted at moshez.org  Wed Oct 30 23:15:33 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 31 Oct 2002 06:15:33 -0000
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <1036018639.692.74.camel@mingus>
References: <1036018639.692.74.camel@mingus>
Message-ID: <20021031061533.8689.qmail@green.zadka.com>

On 30 Oct 2002, Abe Fettig <abe at fettig.net> wrote:

> I just released version 0.3 of Hep, my multiprotocol message server. 
> The big change in this release is that Hep is now using Twisted for all
> its networking stuff:  HTTP and XMLRPC clients, POP3, SMTP, and web
> servers.
> 
> The Hep web page is:
> http://www.fettig.net/projects/hep.

Can this be added to the "projects using twisted" page?

Thanks



From jjn at kriln.com  Wed Oct 30 23:23:04 2002
From: jjn at kriln.com (Jeremy Noetzelman)
Date: Thu, 31 Oct 2002 06:23:04 +0000 (GMT)
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030.210658.59655039.glyph@twistedmatrix.com>
Message-ID: <20021031062249.O21031-100000@nosferatu.kriln.com>

On Wed, 30 Oct 2002, Glyph Lefkowitz wrote:

> On Wed, 30 Oct 2002 23:54:46 +0000 (GMT), Jeremy Noetzelman <jjn at kriln.com> wrote:
> > Personally, when I was running high volume web servers, we'd tune down the
> > keepalive timers to a fairly short interval to keep sockets from getting
> > tied up too long, to prevent resource availability issues that we were
> > seeing.
>
> Just out of curiosity, how does one configure this timeout with apache?

No idea.  I did it at the OS level.




From m at moshez.org  Wed Oct 30 23:17:33 2002
From: m at moshez.org (Moshe Zadka)
Date: 31 Oct 2002 06:17:33 -0000
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030.173450.63128778.glyph@twistedmatrix.com>
References: <20021030.173450.63128778.glyph@twistedmatrix.com>, <1035992906.1778.4.camel@giantclam>
	<20021029161011.GB515@twistedmatrix.com>
Message-ID: <20021031061733.8711.qmail@green.zadka.com>

On Wed, 30 Oct 2002, Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> If there were a timeout, that would mean that proxying
> certain things through HTTP might break.  What I'm wondering is why _other_
> webservers don't suffer from this problem.  Do they have a timeout?

Every web server has a timeout, at least for "time which passes in which
nothing flows in either direction."



From typo at soniq.net  Thu Oct 31 07:48:17 2002
From: typo at soniq.net (Paul Boehm)
Date: Thu, 31 Oct 2002 15:48:17 +0100
Subject: [Twisted-Python] viewStack breakage
Message-ID: <20021031144817.GA3944@soniq.net>

hey, thanks for fixing the caching bug that quickly!

i think something else broke with your last few commits though:

this debug output is from getNodeView for a GET request, with no controllers
working. i have a wvfactory_DetailLink in sam.web.serverlist.View, which the
viewStack finds without problems:

31/10/2002 15:41 [*samclient*] [<twisted.web.woven.widgets.KeyedList instance at 0x83c17e4>, <twisted.web.woven.widgets.DefaultWidget instance at 0x83e6674>, <twisted.web.woven.widgets.DefaultWidget instance at 0x83e45ac>, <sam.web.serverlist.View instance at 0x83ae814>, <module 'twisted.web.woven.widgets' from '/home/paul/Twisted/twisted/web/woven/widgets.pyc'>]

now when i submit data to my controller, i get a different viewStack
exceptions.NotImplementedError: You specified view name DetailLink on a node, but no factory_DetailLink method was found in [<twisted.web.woven.widgets.DefaultWidget instance at 0x840963c>, <twisted.web.woven.widgets.KeyedList instance at 0x83db2bc>, <module 'twisted.web.woven.widgets' from '/home/paul/Twisted/twisted/web/woven/widgets.pyc'>].

without sam.web.serverlist.View.

the relevant xhtml snippet for this is:
        <ul model="root/inventory" view="KeyedList">
            <li id="emptyList">No Servers defined</li>
            <li id="keyedListItem">
                <a view="DetailLink" model="name">
                <span view="Text" model="name" /></a>
            </li>
        </ul>

root is a dictionary in my serverlist.Model, which has serverlist.View
registered as View.

inventory is a Dictionary like class, which has registered for a 
DictionaryModel Wrapper with components.

as inventory is only a virtual model, imho the parent's view should
propagate down to it's viewStack, which seems to work, unless a controller
updates inventory.

what's needed to fix this? do i need to make inventory and/or root 
a real model and register a view for it ?

  paul



From abe at fettig.net  Thu Oct 31 09:19:28 2002
From: abe at fettig.net (Abe Fettig)
Date: 31 Oct 2002 11:19:28 -0500
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <20021030.210619.78707311.glyph@twistedmatrix.com>
References: <1036018639.692.74.camel@mingus>
	 <20021030.210619.78707311.glyph@twistedmatrix.com>
Message-ID: <1036081167.1571.40.camel@mingus>

On Wed, 2002-10-30 at 22:06, Glyph Lefkowitz wrote:
> On 30 Oct 2002 17:57:19 -0500, Abe Fettig <abe at fettig.net> wrote:
> > I just released version 0.3 of Hep, my multiprotocol message server. 
> 
> Hey, this looks awesome!! :-D
> 
> Obviously with all the different protocol support in Twisted, I had hoped to
> eventually implement something like this.  It looks like Hep is quite
> application-level though (sending e-mail messages to a weblog, etc), so
> hopefully there wouldn't be too much overlap (if I could ever get around to
> actually implementing message-transport-abstraction stuff...).
> 
> If you've got any message-level abstractions you'd like supported at the
> Twisted level (or better yet, patches to unify some of the protocols' approach
> to messaging) I'd really like to hear about them.  Thanks for letting us know
> about this project!

At the moment I'm still in lurk mode, trying to get a feel for the
Twisted way of doing things.

I have been thinking about unified messaging. One of the next steps for
Hep is a unified protocol/address setup so it can transparently route
messages between different systems.  For example, I want Hep users to be
able to send mail to "bob at aim.hep" and have the message go to the AOL IM
account "bob".

There are a couple of servers I'd like to use that aren't available in
Twisted yet (to the best of my knowledge) - IMAP and WebDAV.  Is anyone
working on implementing these?  If so, I'd be happy to help.

-- 
Abe Fettig
abe at fettig.net
http://www.fettig.net/




From radix at twistedmatrix.com  Wed Oct 30 09:39:38 2002
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 30 Oct 2002 17:39:38 +0100
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <20021031061533.8689.qmail@green.zadka.com>
References: <1036018639.692.74.camel@mingus> <20021031061533.8689.qmail@green.zadka.com>
Message-ID: <20021030163938.GA458@twistedmatrix.com>

On Thu, Oct 31, 2002 at 06:15:33AM -0000, Moshe Zadka wrote:
> On 30 Oct 2002, Abe Fettig <abe at fettig.net> wrote:
> > The Hep web page is:
> > http://www.fettig.net/projects/hep.
> 
> Can this be added to the "projects using twisted" page?

I've already taken the liberty.

http://twistedmatrix.com/products/success

-- 
			Christopher Armstrong
		    << radix at twistedmatrix.com >>
	     http://twistedmatrix.com/users/radix.twistd/



From dp at twistedmatrix.com  Thu Oct 31 09:44:56 2002
From: dp at twistedmatrix.com (Donovan Preston)
Date: Thu, 31 Oct 2002 08:44:56 -0800
Subject: [Twisted-Python] viewStack breakage
In-Reply-To: <20021031144817.GA3944@soniq.net>
Message-ID: <1625EC21-ECF0-11D6-898A-000393B3EC2C@twistedmatrix.com>

If you look in the commit, you'll see a comment about this problem...

         # This works for simple cases, unfortunately this widget 
doesn't have
         # appropriate mvc stack -- it only has itself

I'm going to have to copy the stack each time I create a widget and 
store it in the widget so that later when a widget gets a modelChanged 
notification, the correct stuff is on the stack. Doing this will also 
help with Deferreds -- they'll run in to the same problem right now, 
when the deferred fires they won't have the proper things on the stack.

I might get to this today, but I might not.

Donovan

On Thursday, October 31, 2002, at 06:48 AM, Paul Boehm wrote:

> hey, thanks for fixing the caching bug that quickly!
>
> i think something else broke with your last few commits though:
>
> this debug output is from getNodeView for a GET request, with no 
> controllers
> working. i have a wvfactory_DetailLink in sam.web.serverlist.View, 
> which the
> viewStack finds without problems:
>
> 31/10/2002 15:41 [*samclient*] [<twisted.web.woven.widgets.KeyedList 
> instance at 0x83c17e4>, <twisted.web.woven.widgets.DefaultWidget 
> instance at 0x83e6674>, <twisted.web.woven.widgets.DefaultWidget 
> instance at 0x83e45ac>, <sam.web.serverlist.View instance at 
> 0x83ae814>, <module 'twisted.web.woven.widgets' from 
> '/home/paul/Twisted/twisted/web/woven/widgets.pyc'>]
>
> now when i submit data to my controller, i get a different viewStack
> exceptions.NotImplementedError: You specified view name DetailLink on 
> a node, but no factory_DetailLink method was found in 
> [<twisted.web.woven.widgets.DefaultWidget instance at 0x840963c>, 
> <twisted.web.woven.widgets.KeyedList instance at 0x83db2bc>, <module 
> 'twisted.web.woven.widgets' from 
> '/home/paul/Twisted/twisted/web/woven/widgets.pyc'>].
>
> without sam.web.serverlist.View.
>
> the relevant xhtml snippet for this is:
>         <ul model="root/inventory" view="KeyedList">
>             <li id="emptyList">No Servers defined</li>
>             <li id="keyedListItem">
>                 <a view="DetailLink" model="name">
>                 <span view="Text" model="name" /></a>
>             </li>
>         </ul>
>
> root is a dictionary in my serverlist.Model, which has serverlist.View
> registered as View.
>
> inventory is a Dictionary like class, which has registered for a
> DictionaryModel Wrapper with components.
>
> as inventory is only a virtual model, imho the parent's view should
> propagate down to it's viewStack, which seems to work, unless a 
> controller
> updates inventory.
>
> what's needed to fix this? do i need to make inventory and/or root
> a real model and register a view for it ?
>
>   paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From iko at strakt.com  Thu Oct 31 13:36:17 2002
From: iko at strakt.com (Anders Hammarquist)
Date: Thu, 31 Oct 2002 21:36:17 +0100
Subject: [Twisted-Python] SMTP
Message-ID: <200210312036.g9VKaH7O031180@fido.strakt.com>

SMTP server patch, take 3

This now includes a tested unit test.

Feedback is welcome, as always.

/Anders

-------------- next part --------------
Index: twisted/protocols/basic.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/basic.py,v
retrieving revision 1.25
diff -u -u -r1.25 basic.py
--- twisted/protocols/basic.py	18 Oct 2002 06:46:52 -0000	1.25
+++ twisted/protocols/basic.py	31 Oct 2002 20:25:03 -0000
@@ -153,12 +153,15 @@
                 line, self.__buffer = self.__buffer.split(self.delimiter, 1)
             except ValueError:
                 if len(self.__buffer) > self.MAX_LENGTH:
-                    self.transport.loseConnection()
+                    line, self.__buffer = self.__buffer, ''
+                    self.lineLengthExceeded(line)
                     return
                 break
             else:
-                if len(line) > self.MAX_LENGTH:
-                    self.transport.loseConnection()
+                linelength = len(line)
+                if linelength > self.MAX_LENGTH:
+                    line, self.__buffer = self.__buffer, ''
+                    self.lineLengthExceeded(line)
                     return
                 self.lineReceived(line)
                 if self.transport.disconnecting:
@@ -200,6 +203,12 @@
         """Sends a line to the other end of the connection.
         """
         self.transport.write(line + self.delimiter)
+
+    def lineLengthExceeded(self, line):
+        """Called when the maximum line length has been reached.
+        Override if it needs to be dealt with in some special way.
+        """
+        self.transport.loseConnection()
 
 
 class Int32StringReceiver(protocol.Protocol):
Index: twisted/protocols/smtp.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/smtp.py,v
retrieving revision 1.26
diff -u -u -r1.26 smtp.py
--- twisted/protocols/smtp.py	14 Oct 2002 13:21:06 -0000	1.26
+++ twisted/protocols/smtp.py	31 Oct 2002 20:25:04 -0000
@@ -18,10 +18,10 @@
 """
 
 from twisted.protocols import basic
-from twisted.internet import protocol, defer
+from twisted.internet import protocol, defer, reactor
 from twisted.python import log
 
-import os, time, string, operator
+import os, time, string, operator, re
 
 class SMTPError(Exception):
     pass
@@ -49,19 +49,110 @@
         self.deferred.errback(arg)
         self.done = 1
 
+class AddressError(SMTPError):
+    "Parse error in address"
+    pass
+
+# Character classes for parsing addresses
+atom = r"-A-Za-z0-9!#$%&'*+/=?^_`{|}~"
+
+class Address:
+    """Parse and hold an RFC 2821 address.
+
+    Source routes are stipped and ignored, UUCP-style bang-paths
+    and %-style routing are not parsed.
+    """
+
+    tstring = re.compile(r'''( # A string of
+                          (?:"[^"]*" # quoted string
+			  |\\.i # backslash-escaped characted
+			  |[''' + string.replace(atom,'#',r'\#')
+                          + r'''] # atom character
+			  )+|.) # or any single character''',re.X)
+
+    def __init__(self, addr):
+        self.local = ''
+        self.domain = ''
+        self.addrstr = addr
+
+        # Tokenize
+        atl = filter(None,self.tstring.split(addr))
+
+        local = []
+        domain = []
+
+        while atl:
+            if atl[0] == '<':
+                if atl[-1] != '>':
+                    raise AddressError, "Unbalanced <>"
+                atl = atl[1:-1]
+            elif atl[0] == '@':
+                atl = atl[1:]
+                if not local:
+                    # Source route
+                    while atl and atl[0] != ':':
+                        # remove it
+                        atl = atl[1:]
+                    if not atl:
+                        raise AddressError, "Malformed source route"
+                    atl = atl[1:] # remove :
+                elif domain:
+                    raise AddressError, "Too many @"
+                else:
+                    # Now in domain
+                    domain = ['']
+            elif len(atl[0]) == 1 and atl[0] not in atom + '.':
+                raise AddressError, "Parse error at " + atl[0]
+            else:
+                if not domain:
+                    local.append(atl[0])
+                else:
+                    domain.append(atl[0])
+                atl = atl[1:]
+               
+        self.local = ''.join(local)
+        self.domain = ''.join(domain)
+
+    dequotebs = re.compile(r'\\(.)')
+    def dequote(self,addr):
+        "Remove RFC-2821 quotes from address"
+        res = []
+
+        atl = filter(None,self.tstring.split(str(addr)))
+
+        for t in atl:
+            if t[0] == '"' and t[-1] == '"':
+                res.append(t[1:-1])
+            elif '\\' in t:
+                res.append(self.dequotebs.sub(r'\1',t))
+            else:
+                res.append(t)
+
+        return ''.join(res)
+
+    def __str__(self):
+        return '%s%s' % (self.local, self.domain and ("@" + self.domain) or "")
+
+    def __repr__(self):
+        return "%s.%s(%s)" % (self.__module__, self.__class__.__name__,
+                              repr(str(self)))
 
 class User:
 
     def __init__(self, destination, helo, protocol, orig):
-        try:
-            self.name, self.domain = string.split(destination, '@', 1)
-        except ValueError:
-            self.name = destination
-            self.domain = ''
+        self.dest = Address(destination)
         self.helo = helo
         self.protocol = protocol
         self.orig = orig
 
+    def __getstate__(self):
+        return { 'dest' : self.dest,
+                 'helo' : self.helo,
+                 'protocol' : None,
+                 'orig' : self.orig }
+
+    def __str__(self):
+        return str(self.dest)
 
 class IMessage:
 
@@ -87,19 +178,39 @@
         self.mode = COMMAND
         self.__from = None
         self.__helo = None
-        self.__to = ()
+        self.__to = []
+
+    def timedout(self):
+        self.sendCode(421, '%s Timeout. Try talking faster next time!' %
+                      self.host)
+        self.transport.loseConnection()
 
     def connectionMade(self):
-        self.sendCode(220, 'Spammers beware, your ass is on fire')
+        self.host = self.factory.domain
+        if hasattr(self.factory, 'timeout'):
+            self.timeout = self.factory.timeout
+        else:
+            self.timeout = 600
+        self.sendCode(220, '%s Spammers beware, your ass is on fire' %
+                      self.host)
+        if self.timeout:
+            self.timeoutID = reactor.callLater(self.timeout, self.timedout)
 
     def sendCode(self, code, message=''):
         "Send an SMTP code with a message."
         self.transport.write('%d %s\r\n' % (code, message))
 
     def lineReceived(self, line):
+        if self.timeout:
+            self.timeoutID.cancel()
+            self.timeoutID = reactor.callLater(self.timeout, self.timedout)
+
         if self.mode is DATA:
             return self.dataLineReceived(line)
-        command = string.split(line, None, 1)[0]
+        if line:
+            command = string.split(line, None, 1)[0]
+        else:
+            command = ''
         method = getattr(self, 'do_'+string.upper(command), None)
         if method is None:
             method = self.do_UNKNOWN
@@ -107,59 +218,128 @@
             line = line[len(command):]
         return method(string.strip(line))
 
+    def lineLengthExceeded(self, line):
+        if self.mode is DATA:
+            for message in self.__messages:
+                message.connectionLost()
+            self.mode = COMMAND
+            del self.__messages
+        self.sendCode(500, 'Line too long')
+
+    def rawDataReceived(self, data):
+        "Throw away rest of long line"
+        rest = string.split(data, '\r\n', 1)
+        if len(rest) == 2:
+            self.setLineMode(self.rest[1])
+
     def do_UNKNOWN(self, rest):
-        self.sendCode(502, 'Command not implemented')
+        self.sendCode(500, 'Command not implemented')
 
     def do_HELO(self, rest):
-        self.__helo = rest
-        self.sendCode(250, 'Nice to meet you')
+        peer = self.transport.getPeer()[1]
+        self.__helo = (rest, peer)
+        self.sendCode(250, '%s Hello %s, nice to meet you' % (self.host, peer))
 
     def do_QUIT(self, rest):
         self.sendCode(221, 'See you later')
         self.transport.loseConnection()
 
+    # A string of quoted strings, backslash-escaped character or
+    # atom characters + '@.,:'
+    qstring = r'("[^"]*"|\\.|[' + string.replace(atom,'#',r'\#') + r'@.,:])+'
+
+    mail_re = re.compile(r'''\s*FROM:\s*(?P<path><> # Empty <>
+                         |<''' + qstring + r'''> # <addr>
+			 |''' + qstring + r''' # addr
+			 )\s*(\s(?P<opts>.*))? # Optional WS + ESMTP options
+			 $''',re.I|re.X)
+    rcpt_re = re.compile(r'\s*TO:\s*(?P<path><' + qstring + r'''> # <addr>
+                         |''' + qstring + r''' # addr
+			 )\s*(\s(?P<opts>.*))? # Optional WS + ESMTP options
+			 $''',re.I|re.X)
+
     def do_MAIL(self, rest):
-        from_ = rest[len("MAIL:<"):-len(">")]
-        self.validateFrom(self.__helo, from_, self._fromValid,
-                                              self._fromInvalid)
+        if self.__from:
+            self.sendCode(503,"Only one sender per message, please")
+            return
+        # Clear old recipient list
+        self.__to = []
+        m = self.mail_re.match(rest)
+        if not m:
+            self.sendCode(501, "Syntax error")
+            return
 
-    def _fromValid(self, from_):
+        try:
+            addr = Address(m.group('path'))
+        except AddressError, e:
+            self.sendCode(553, str(e))
+            return
+            
+        self.validateFrom(self.__helo, addr, self._fromValid,
+                          self._fromInvalid)
+
+    def _fromValid(self, from_, code=250, msg='From address accepted'):
         self.__from = from_
-        self.sendCode(250, 'From address accepted')
+        self.sendCode(code, msg)
 
-    def _fromInvalid(self, from_):
-        self.sendCode(550, 'No mail for you!')
+    def _fromInvalid(self, from_, code=550, msg='No mail for you!'):
+        self.sendCode(code,msg)
 
     def do_RCPT(self, rest):
-        to = rest[len("TO:<"):-len(">")]
-        user = User(to, self.__helo, self, self.__from)
-        self.validateTo(user, self._toValid, self._toInvalid)
+        if not self.__from:
+            self.sendCode(503, "Must have sender before recipient")
+            return
+        m = self.rcpt_re.match(rest)
+        if not m:
+            self.sendCode(501, "Syntax error")
+            return
 
-    def _toValid(self, to):
-        self.__to = self.__to + (to,)
-        self.sendCode(250, 'Address recognized')
+        try:
+            user = User(m.group('path'), self.__helo, self, self.__from)
+        except AddressError, e:
+            self.sendCode(553, str(e))
+            return
+            
+        self.validateTo(user, self._toValid, self._toInvalid)
 
-    def _toInvalid(self, to):
-        self.sendCode(550, 'Cannot receive for specified address')
+    def _toValid(self, to, code=250, msg='Address recognized'):
+        self.__to.append(to)
+        self.sendCode(code, msg)
+
+    def _toInvalid(self, to, code=550,
+                   msg='Cannot receive for specified address'):
+        self.sendCode(code, msg)
 
     def do_DATA(self, rest):
         if self.__from is None or not self.__to:  
-            self.sendCode(550, 'Must have valid receiver and originator')
+            self.sendCode(503, 'Must have valid receiver and originator')
             return
         self.mode = DATA
         helo, origin, recipients = self.__helo, self.__from, self.__to
         self.__from = None
-        self.__to = ()
+        self.__to = []
         self.__messages = self.startMessage(recipients)
+        self.__inheader = self.__inbody = 0
+        for message in self.__messages:
+            message.lineReceived(self.receivedHeader(helo, origin, recipients))
         self.sendCode(354, 'Continue')
 
     def connectionLost(self, reason):
+        # self.sendCode(421, 'Dropping connection.') # This does nothing...
+        # Ideally, if we (rather than the other side) lose the connection,
+        # we should be able to tell the other side that we are going away.
+        # RFC-2821 requires that we try.
         if self.mode is DATA:
-            for message in self.__messages:
-                message.connectionLost()
+            try:
+                for message in self.__messages:
+                    message.connectionLost()
+                del self.__messages
+            except AttributeError:
+                pass
 
     def do_RSET(self, rest):
-        self.__init__()
+        self.__from = None
+        self.__to = []
         self.sendCode(250, 'I remember nothing.')
 
     def dataLineReceived(self, line):
@@ -177,8 +357,24 @@
                     deferred = message.eomReceived()
                     deferred.addCallback(ndeferred.callback)
                     deferred.addErrback(ndeferred.errback)
+                del self.__messages
                 return
             line = line[1:]
+
+        # Add a blank line between the generated Received:-header
+        # and the message body if the message comes in without any
+        # headers
+        if not self.__inheader and not self.__inbody:
+            if ':' in line:
+                self.__inheaders = 1
+            elif line:
+                for message in self.__messages:
+                    message.lineReceived('')
+                self.__inbody = 1
+
+        if not line:
+            self.__inbody = 1
+        
         for message in self.__messages:
             message.lineReceived(line)
 
@@ -188,8 +384,27 @@
     def _messageNotHandled(self, _):
         self.sendCode(550, 'Could not send e-mail')
 
+    def rfc822date(self):
+        timeinfo = time.localtime()
+        if timeinfo[8]:
+            # DST
+            tz = -time.altzone
+        else:
+            tz = -time.timezone
+            
+        return "%s %+2.2d%2.2d" % (
+            time.strftime("%a, %d %b %Y %H:%M:%S", timeinfo),
+            tz / 3600, (tz / 60) % 60)
+
     # overridable methods:
+    def receivedHeader(self, helo, origin, recipents):
+        return "Received: From %s ([%s]) by %s; %s" % (
+            helo[0], helo[1], self.host, self.rfc822date())
+    
     def validateFrom(self, helo, origin, success, failure):
+        if not helo:
+            failure(origin,503,"Who are you? Say HELO first");
+            return
         success(origin)
 
     def validateTo(self, user, success, failure):
@@ -265,6 +480,7 @@
         
     def smtpCode_354_data(self, line):
         self.mailFile = self.getMailData()
+        self.lastsent = ''
         self.transport.registerProducer(self, 0)
 
     def smtpCode_250_afterData(self, line):
@@ -277,11 +493,18 @@
         chunk = self.mailFile.read(8192)
         if not chunk:
             self.transport.unregisterProducer()
-            self.sendLine('.')
+            if self.lastsent != '\n':
+                line = '\r\n.'
+            else:
+                line = '.'
+            self.sendLine(line)
             self.state = 'afterData'
+            return
 
         chunk = string.replace(chunk, "\n", "\r\n")
+        chunk = string.replace(chunk, "\r\n.", "\r\n..")
         self.transport.write(chunk)
+        self.lastsent = chunk[-1]
 
     def pauseProducing(self):
         pass
Index: twisted/test/test_protocols.py
===================================================================
RCS file: /cvs/Twisted/twisted/test/test_protocols.py,v
retrieving revision 1.17
diff -u -u -r1.17 test_protocols.py
--- twisted/test/test_protocols.py	23 Sep 2002 08:51:29 -0000	1.17
+++ twisted/test/test_protocols.py	31 Oct 2002 20:25:04 -0000
@@ -33,11 +33,13 @@
 class LineTester(basic.LineReceiver):
 
     delimiter = '\n'
+    MAX_LENGTH = 64
 
     def connectionMade(self):
         self.received = []
 
     def lineReceived(self, line):
+        print self.MAX_LENGTH, len(line)
         self.received.append(line)
         if line == '':
             self.setRawMode()
@@ -51,6 +53,10 @@
         if self.length == 0:
             self.setLineMode(rest)
 
+    def lineLengthExceeded(self, line):
+        if len(line) > self.MAX_LENGTH+1:
+            self.setLineMode(line[self.MAX_LENGTH+1:])
+
 class WireTestCase(unittest.TestCase):
 
     def testEcho(self):
@@ -103,13 +109,14 @@
 012345678len 0
 foo 5
 
+1234567890123456789012345678901234567890123456789012345678901234567890
 len 1
 
 a'''
 
     output = ['len 10', '0123456789', 'len 5', '1234\n',
               'len 20', 'foo 123', '0123456789\n012345678',
-              'len 0', 'foo 5', '', 'len 1', 'a']
+              'len 0', 'foo 5', '', '67890', 'len 1', 'a']
 
     def testBuffer(self):
         for packet_size in range(1, 10):
@@ -175,3 +182,6 @@
             r.dataReceived(s)
             if not r.brokenPeer:
                 raise AssertionError("connection wasn't closed on illegal netstring %s" % repr(s))
+
+if __name__ == '__main__':
+    unittest.main()
Index: twisted/test/test_smtp.py
===================================================================
RCS file: /cvs/Twisted/twisted/test/test_smtp.py,v
retrieving revision 1.16
diff -u -u -r1.16 test_smtp.py
--- twisted/test/test_smtp.py	6 Sep 2002 09:09:42 -0000	1.16
+++ twisted/test/test_smtp.py	31 Oct 2002 20:25:04 -0000
@@ -26,7 +26,7 @@
 from twisted.protocols import loopback, smtp
 from twisted.internet import defer, protocol
 from twisted.test.test_protocols import StringIOWithoutClosing
-import string
+import string, re
 from cStringIO import StringIO
 
 class DummyMessage:
@@ -195,15 +195,17 @@
         self.buffer = []
 
     def lineReceived(self, line):
-        self.buffer.append(line)
+        # Throw away the generated Received: header
+        if not re.match('Received: From foo.com \(\[.*\]\) by foo.com;', line):
+            self.buffer.append(line)
 
     def eomReceived(self):
         message = string.join(self.buffer, '\n')+'\n'
-        helo, origin = self.users[0].helo, self.users[0].orig
+        helo, origin = self.users[0].helo[0], str(self.users[0].orig)
         recipients = []
         for user in self.users:
-            recipients.append(user.name+'@'+user.domain)
-        self.protocol.messages.append((helo, origin, recipients, message))
+            recipients.append(str(user))
+        self.protocol.message = (helo, origin, recipients, message)
         deferred = defer.Deferred()
         deferred.callback("saved")
         return deferred
@@ -212,51 +214,84 @@
 
     def connectionMade(self):
         smtp.SMTP.connectionMade(self)
-        self.messages = []
+        self.message = None
 
     def startMessage(self, users):
         return [DummySMTPMessage(self, users)]
 
-
 class AnotherSMTPTestCase(unittest.TestCase):
 
-    messages = [ ('foo.com', 'moshez at foo.com', ['moshez at bar.com'], '''\
+    messages = [ ('foo.com', 'moshez at foo.com', ['moshez at bar.com'],
+                  'moshez at foo.com', ['moshez at bar.com'], '''\
 From: Moshe
 To: Moshe
 
 Hi,
 how are you?
 '''),
-                 ('foo.com', 'tttt at rrr.com', ['uuu at ooo', 'yyy at eee'], '''\
+                 ('foo.com', 'tttt at rrr.com', ['uuu at ooo', 'yyy at eee'],
+                  'tttt at rrr.com', ['uuu at ooo', 'yyy at eee'], '''\
 Subject: pass
 
 ..rrrr..
-''')
+'''),
+                 ('foo.com', '@this, at is, at ignored:foo at bar.com',
+                  ['@ignore, at this, at too:bar at foo.com'],
+                  'foo at bar.com', ['bar at foo.com'], '''\
+Subject: apa
+To: foo
+
+123
+.
+456
+'''),
               ]
 
-    expected_output = '220 Spammers beware, your ass is on fire\015\012250 Nice to meet you\015\012250 From address accepted\015\012250 Address recognized\015\012354 Continue\015\012250 Delivery in progress\015\012250 From address accepted\015\012250 Address recognized\015\012250 Address recognized\015\012354 Continue\015\012250 Delivery in progress\015\012221 See you later\015\012'
-
-    input = 'HELO foo.com\r\n'
-    for _, from_, to_, message in messages:
-        input = input + 'MAIL FROM:<%s>\r\n' % from_
-        for item in to_:
-            input = input + 'RCPT TO:<%s>\r\n' % item
-        input = input + 'DATA\r\n'
-        for line in string.split(message, '\n')[:-1]:
-            if line[:1] == '.': line = '.' + line
-            input = input + line + '\r\n'
-        input = input + '.' + '\r\n'
-    input = input + 'QUIT\r\n'
+    testdata = [
+        ('', '220.*\r\n$', None, None),
+        ('HELO foo.com\r\n', '250.*\r\n$', None, None),
+        ('RSET\r\n', '250.*\r\n$', None, None),
+        ]
+    for helo_, from_, to_, realfrom, realto, msg in messages:
+        testdata.append(('MAIL FROM:<%s>\r\n' % from_, '250.*\r\n',
+                         None, None))
+        for rcpt in to_:
+            testdata.append(('RCPT TO:<%s>\r\n' % rcpt, '250.*\r\n',
+                             None, None))
+        testdata.append(('DATA\r\n','354.*\r\n',
+                         msg, ('250.*\r\n',
+                               (helo_, realfrom, realto, msg))))
+                                                       
 
     def testBuffer(self):
         output = StringIOWithoutClosing()
         a = DummySMTP()
-        a.makeConnection(protocol.FileWrapper(output))
-        a.dataReceived(self.input)
-        if a.messages != self.messages:
-            raise AssertionError(a.messages)
-        if output.getvalue() != self.expected_output:
-            raise AssertionError(`output.getvalue()`)
+        class fooFactory:
+            domain = 'foo.com'
 
+        a.factory = fooFactory()
+        a.makeConnection(protocol.FileWrapper(output))
+        for (send, expect, msg, msgexpect) in self.testdata:
+            if send:
+                a.dataReceived(send)
+            data = output.getvalue()
+            output.truncate(0)
+            if not re.match(expect, data):
+                raise AssertionError, (send, expect, data)
+            if data[:3] == '354':
+                for line in msg.splitlines():
+                    if line and line[0] == '.':
+                        line = '.' + line
+                    a.dataReceived(line + '\r\n')
+                a.dataReceived('.\r\n')
+                # Special case for DATA. Now we want a 250, and then
+                # we compare the messages
+                data = output.getvalue()
+                output.truncate()
+                resp, msgdata = msgexpect
+                if not re.match(resp, data):
+                    raise AssertionError, (resp, data)
+                if a.message != msgdata:
+                    raise AssertionError, (msgdata, a.message)
 
 testCases = [SMTPTestCase, SMTPClientTestCase, LoopbackSMTPTestCase, AnotherSMTPTestCase]

From liiwi at lonesom.pp.fi  Thu Oct 31 08:24:16 2002
From: liiwi at lonesom.pp.fi (Jaakko Niemi)
Date: Thu, 31 Oct 2002 17:24:16 +0200
Subject: [Twisted-Python] web site error
In-Reply-To: <20021030.210658.59655039.glyph@twistedmatrix.com> (Glyph
 Lefkowitz's message of "Wed, 30 Oct 2002 21:06:58 -0600 (CST)")
References: <20021030.173450.63128778.glyph@twistedmatrix.com>
	<20021030235138.P6472-100000@nosferatu.kriln.com>
	<20021030.210658.59655039.glyph@twistedmatrix.com>
Message-ID: <87wunyein3.fsf@jumper.lonesom.pp.fi>

Glyph Lefkowitz <glyph at twistedmatrix.com> writes:

> On Wed, 30 Oct 2002 23:54:46 +0000 (GMT), Jeremy Noetzelman <jjn at kriln.com> wrote:
>> Personally, when I was running high volume web servers, we'd tune down the
>> keepalive timers to a fairly short interval to keep sockets from getting
>> tied up too long, to prevent resource availability issues that we were
>> seeing.
>
> Just out of curiosity, how does one configure this timeout with apache?

 Look at the Timeout and KeepAlive directives in httpd.conf or apache docs.
 Basically either timeout or max # of requests, and connection will be cut.

 As for 2.4 kernels, check Documentation/networking/ip-sysctl.txt and 
 tcp_keepalive_* there. Note: if you drop this to short value at tm.com,
 ssh users will hate you :)

                --j



From tool_man at spamcop.net  Thu Oct 31 09:00:04 2002
From: tool_man at spamcop.net (Tim Lavoie)
Date: Thu, 31 Oct 2002 10:00:04 -0600
Subject: [Twisted-Python] Twisted-Python digest, Vol 1 #487 - 14 msgs
In-Reply-To: <20021031061401.19966.3766.Mailman@pyramid.twistedmatrix.com>
References: <20021031061401.19966.3766.Mailman@pyramid.twistedmatrix.com>
Message-ID: <15809.21380.349785.273907@theasylum.dyndns.org>

>>>>> "glyph" == twisted-python-request  <twisted-python-request at twistedmatrix.com> writes:

 [re socket timeouts]

    glyph> <jjn at kriln.com> wrote:
    >> Personally, when I was running high volume web servers, we'd
    >> tune down the keepalive timers to a fairly short interval to
    >> keep sockets from getting tied up too long, to prevent resource
    >> availability issues that we were seeing.

    glyph> Just out of curiosity, how does one configure this timeout
    glyph> with apache?


Actually, there are a few timeout flags which can be set in Apache,
depending on how specific you want. TimeOut (300 sec default) is the
overall one which fails requests with nothing happening. There is also
DavMinTimeout (0), KeepAliveTimeout (15), and ProxyTimeout(300).

  Tim  (aka Spudnik)



From johnfabel at btinternet.com  Thu Oct 31 12:13:53 2002
From: johnfabel at btinternet.com (John Abel)
Date: Thu, 31 Oct 2002 19:13:53 -0000
Subject: [Twisted-Python] Proxy Server With Twisted
Message-ID: <006901c28132$655fcbc0$fd3f7ad5@hallows>

Hi,

I remember seeing something like this pass the list a while back, but I can't seem to find it.  I've been trying to write a simple proxy server for my two machines at home, using twisted.  I've tried using code I'd written for a simple NNTP server, as a base, but upon calling reactor.run(), I get "Proxy instance has no attribute 'doStart'".  I've tried using the app module, as a way of trying to run it, but haven't had much success there either.  Has anyone done this before?  Does anyone have any docs for doing this sort of thing?

Thanks

John
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20021031/4a582cf9/attachment.html>

From mongo57a at comcast.net  Thu Oct 31 22:03:38 2002
From: mongo57a at comcast.net (andy surany)
Date: Fri, 01 Nov 2002 00:03:38 -0500
Subject: [Twisted-Python] Proxy Server With Twisted
Message-ID: <003901c28164$0a21dfa0$2502a8c0@emily.ewndsr01.nj.comcast.net>

Hi John,

I had a "proxy" thread in this group - but I was not familiar enough with proxys to make it work. However, if you go to the Tutor list you will find a series of threads on this subject. Look for a proxy (or 2) that was contributed by Lloyd Kvam (about a week ago).

HTH

Regards,
Andy
  -----Original Message-----
  From: John Abel <
  To: Twisted-Python at twistedmatrix.com <Twisted-Python at twistedmatrix.com>
  Date: Thursday, October 31, 2002 11:31 PM
  Subject: [Twisted-Python] Proxy Server With Twisted


  Hi,

  I remember seeing something like this pass the list a while back, but I can't seem to find it.  I've been trying to write a simple proxy server for my two machines at home, using twisted.  I've tried using code I'd written for a simple NNTP server, as a base, but upon calling reactor.run(), I get "Proxy instance has no attribute 'doStart'".  I've tried using the app module, as a way of trying to run it, but haven't had much success there either.  Has anyone done this before?  Does anyone have any docs for doing this sort of thing?

  Thanks

  John
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20021101/dec391ad/attachment.html>

From exarkun at meson.dyndns.org  Thu Oct 31 22:07:13 2002
From: exarkun at meson.dyndns.org (Jp Calderone)
Date: Fri, 1 Nov 2002 00:07:13 -0500
Subject: [Twisted-Python] Sending email asynchronously
Message-ID: <20021101050713.GA20397@meson.dyndns.org>

  Just a heads up: I've just stuck in twisted.protocols.smtp.sendEmail(); it
is based very heavily on some code itamar sent me and can handle attachments
as well as plain ol' email.  I imagine there are some things wrong with it,
but this is something I've found lacking in Twisted for a long time, so I
had to add it, even broken :)  Suggestions on the what the One True Way it
should work are welcome (but it does what I want it to now, so don't expect
me to improve it without input ;).

  Jp

-- 
If the automobile had followed the same development as the computer, a 
Rolls-Royce would today cost $100, get a million miles per per gallon,
and explode once a year killing everyone inside.
                -- Robert Cringely, InfoWorld
--
 12:00am up 164 days, 1:59, 5 users, load average: 0.12, 0.13, 0.10
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021101/80d7b564/attachment.sig>

From alexander.levy at tufts.edu  Thu Oct 31 17:10:04 2002
From: alexander.levy at tufts.edu (Alex Levy)
Date: Thu, 31 Oct 2002 19:10:04 -0500
Subject: [Twisted-Python] 'model' attribute is showing up in processed HTML
Message-ID: <5.1.1.6.0.20021031190558.022e5e00@coral.tufts.edu>

The 'model' node attribute from my XHTML templates is showing up in the 
final HTML being spewed by twistd.  Is there a reason Twisted does 
this?  It's causing my pages to fail W3C validation.  This isn't happening 
with the 'view' attribute.

Example:

     <td class="sidebar" view="sidebar"></td>
     <td class="content">
         <div class="title" model="title"></div>
         <span model="content"/>
     </td>

...becomes:

     <td class="sidebar">{sidebar stuff...}</td>
     <td class="content">
         <div model="title" class="title">This is the title.</div>
         <span model="content">Content goes here.  w00t.</span>
     </td>

--
Alex Levy
WWW: http://mesozoic.geecs.org
Tel: 617.835.0778

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_





From dstone at kde.org  Thu Oct 31 19:55:28 2002
From: dstone at kde.org (Daniel Stone)
Date: Fri, 1 Nov 2002 13:55:28 +1100
Subject: [Twisted-Python] Hep, a Twisted project
In-Reply-To: <1036081167.1571.40.camel@mingus>
References: <1036018639.692.74.camel@mingus> <20021030.210619.78707311.glyph@twistedmatrix.com> <1036081167.1571.40.camel@mingus>
Message-ID: <20021101025528.GA22758@trinity.unimelb.edu.au>

On Thu, Oct 31, 2002 at 11:19:28AM -0500, Abe Fettig scrawled:
> There are a couple of servers I'd like to use that aren't available in
> Twisted yet (to the best of my knowledge) - IMAP and WebDAV.  Is anyone
> working on implementing these?  If so, I'd be happy to help.

I am working on *a* WebDAV server which can make use of Twisted if one
desires, but Glyph is writing a WebDAV server for twisted, i.e. t.p.w.

-- 
Daniel Stone 	     <daniel at raging.dropbear.id.au>             <dstone at kde.org>
Developer - http://kopete.kde.org, http://www.kde.org
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021101/5a6546d9/attachment.sig>

From exarkun at meson.dyndns.org  Thu Oct 31 23:01:45 2002
From: exarkun at meson.dyndns.org (Jp Calderone)
Date: Fri, 1 Nov 2002 01:01:45 -0500
Subject: [Twisted-Python] Some comments on twisted.news
In-Reply-To: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
References: <n2m-g.y98qpdnu.fsf@morpheus.demon.co.uk>
Message-ID: <20021101060145.GA20898@meson.dyndns.org>

On Tue, Oct 22, 2002 at 06:49:09PM +0100, Paul Moore wrote:
> I just set up a basic demo new server using twisted. Some initial comments:
> 
> 1. It took me almost no time to put together a basic dummy NNTP
>    server. Just create the backend, put a mktap driver in, and it's
>    working.

  Glad to hear it :)

> 
> 2. There seems to be a problem with the server class. It translates
>    \r\n.. to \r\n. in the data the backend supplies - this should be
>    the other way round (it should be *doubling* the dots, so that they
>    don't look like the end of data marker to the client).
> 

  Oops, thanks for the report.

> 3. It would be nice if the server handled the translation to CRLF, so
>    that backends could return data with lines separated by \n, and the
>    server class would convert that to \r\n. After all, \n is the
>    "normal" end of line character internal to Python code, and \r\n is
>    a feature of the NNTP protocol, so the protocol driver should be
>    responsible for the conversion (IMHO). Of course, this is a
>    behaviour change, which could break existing backends, so maybe
>    it's not practical to make this change.

  I agree that \n would probably be preferable, this was just sloppyness on
my part in the initial implementation.  I think it could be changed in such
a way so as not to break existing code, but allow new code to use \n
(similar to how LineReceiver works), and I think this would be a good thing
to do.

> 
> 4. The implementation of STAT requests the article from the
>    backend. This could be inefficient if getting the message ID is
>    cheap, but getting the full article is expensive for a particular
>    backend (it will be for me). In my partly-implemented NNTP server
>    written in "raw" Python (before I found Twisted) I had a backend
>    method getArticle(..., head=1, body=1) which was used to implement
>    all of HEAD, BODY, ARTICLE and STAT, just by setting different
>    values for the head and body parameters (so the backend could check
>    for the case where neither was required, and act accordingly).

  Hmmm.  I have an {indeterminant}-term goal of creating a better backend
interface.  If this isn't a pressing concern for you now, I'd rather put it
off until that happened (though I'd have no problem if you sent a patch that
made the necessary changes).

> 
> (2) is obviously fairly trivial. I think I could implement (3) and
> (4), if it would be useful. I could submit a patch, which would alter
> the server code and the 2 existing backends (I couldn't test the
> database backend, as I don't have a database to test with, but I could
> test the pickle-based code). Would this be helpful? Are there likely
> to be 3rd party nntp backends which would be broken by such a change?

  I've been away a while, so maybe you've already gone ahead and done some
of this?  If not, I might have a crack at it myself.  I'll wait to hear
what, if anything, you've done thus far though.

  Jp

-- 
If the automobile had followed the same development as the computer, a 
Rolls-Royce would today cost $100, get a million miles per per gallon,
and explode once a year killing everyone inside.
                -- Robert Cringely, InfoWorld
--
 12:00am up 164 days, 1:59, 5 users, load average: 0.12, 0.13, 0.10
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20021101/4a60eeea/attachment.sig>

From twisted at moshez.org  Thu Oct 31 23:05:59 2002
From: twisted at moshez.org (Moshe Zadka)
Date: 1 Nov 2002 06:05:59 -0000
Subject: [Twisted-Python] SMTP
In-Reply-To: <200210312036.g9VKaH7O031180@fido.strakt.com>
References: <200210312036.g9VKaH7O031180@fido.strakt.com>
Message-ID: <20021101060559.24216.qmail@green.zadka.com>

On Thu, 31 Oct 2002, Anders Hammarquist <iko at strakt.com> wrote:

> Feedback is welcome, as always.

I couldn't apply it.
Can you update and generate a patch against latest CVS?
Thanks.



