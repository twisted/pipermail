<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] passing data in callbacks or errbacks of deferreds
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20passing%20data%20in%20callbacks%20or%20errbacks%20of%20deferreds&In-Reply-To=20031206034305.GD1500%40frobozz">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006687.html">
   <LINK REL="Next"  HREF="006690.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] passing data in callbacks or errbacks of deferreds</H1>
    <B>rahul at reno.cis.upenn.edu</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20passing%20data%20in%20callbacks%20or%20errbacks%20of%20deferreds&In-Reply-To=20031206034305.GD1500%40frobozz"
       TITLE="[Twisted-Python] passing data in callbacks or errbacks of deferreds">rahul at reno.cis.upenn.edu
       </A><BR>
    <I>Fri Dec  5 23:36:04 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006687.html">[Twisted-Python] passing data in callbacks or errbacks of deferreds
</A></li>
        <LI>Next message: <A HREF="006690.html">[Twisted-Python] Help with child Resources
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6688">[ date ]</a>
              <a href="thread.html#6688">[ thread ]</a>
              <a href="subject.html#6688">[ subject ]</a>
              <a href="author.html#6688">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrew,
Thanks! For some reason I missed it completely in the defer document. Someone
run me over with a large truck!

The program I am writing is a general astronomy data analysis pipeline system,
with a workflow similar to BPELWS, but way simpler, and multiprotocol.
Twisted just makes that very easy. The exact reason for http based xmlrpc
is that some of the peers on this pipeline have very poor networking
(our telescopes being at 9500 ft in Taiwan's central mountains..), and thats
why I need to be able to back off on messages and persist messages if necessary.

My current program mixes twisted and threads, mostly because I havent grokked
twisted zen yet. But I intend to, ofcourse, and the next task will
be protocolozing stack access so that new additions to the stack can be treated
as events. 

Thanks for helping me along..and also big thanks to the author of &quot;Twisted From Scratch&quot;
Rahul
On Sat, Dec 06, 2003 at 02:43:05PM +1100, Andrew Bennetts wrote:
&gt;<i> On Fri, Dec 05, 2003 at 10:28:56PM -0500, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rahul at reno.cis.upenn.edu</A> wrote:
</I>&gt;<i> &gt; Hi Folks,
</I>&gt;<i> &gt; I have the following need. My program acts as a xmlrpc client using
</I>&gt;<i> &gt; the Proxy class, peeking at the top of a stack to find its payload. It gets
</I>&gt;<i> &gt; the payload by peeking and then sends it out on the network. What I want
</I>&gt;<i> &gt; to do, if the send was successful, is to pop the stack, and if not successful,
</I>&gt;<i> &gt; to resend the payload. Since callback and errback only tahe the succesful
</I>&gt;<i> &gt; response(message) or failure instance respectively as an argument, how do
</I>&gt;<i> &gt; I do this, as I am not able to access the stack inside these functions,
</I>&gt;<i> &gt; (I cant use a module global, as each program has multiple stack instances,
</I>&gt;<i> &gt; and i need to pass a particular one).
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Am i missing something?
</I>&gt;<i> 
</I>&gt;<i> I think what you are looking for is:
</I>&gt;<i> 
</I>&gt;<i>      d.addCallback(cb, extraArg1, extraArg2)  # etc
</I>&gt;<i> 
</I>&gt;<i> which will be called as
</I>&gt;<i> 
</I>&gt;<i>      cb(result, extraArg1, extraArg2)
</I>&gt;<i> 
</I>&gt;<i> E.g.:
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt;&gt; from twisted.internet.defer import Deferred
</I>&gt;<i> &gt;&gt;&gt; d = Deferred()
</I>&gt;<i> &gt;&gt;&gt; def cb(result, foo):
</I>&gt;<i> ...     print result * 2, foo
</I>&gt;<i> ... 
</I>&gt;<i> &gt;&gt;&gt; d.addCallback(cb, 'Hey!')
</I>&gt;<i> &lt;Deferred at 0x401e5a6c&gt;
</I>&gt;<i> &gt;&gt;&gt; d.callback(5)
</I>&gt;<i> 10 Hey!
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Glancing at <A HREF="http://twistedmatrix.com/documents/howto/defer,">http://twistedmatrix.com/documents/howto/defer,</A> it does mention
</I>&gt;<i>  this in passing, but it doesn't give any examples or make it clear.  If you
</I>&gt;<i>  read the section on &quot;Basic Callback Functions&quot;
</I>&gt;<i>  (<A HREF="http://twistedmatrix.com/documents/howto/defer#auto9">http://twistedmatrix.com/documents/howto/defer#auto9</A>) carefully, and you
</I>&gt;<i>  know what you're looking for, it does describe this feature.]
</I>&gt;<i> 
</I>&gt;<i> -Andrew.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006687.html">[Twisted-Python] passing data in callbacks or errbacks of deferreds
</A></li>
	<LI>Next message: <A HREF="006690.html">[Twisted-Python] Help with child Resources
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6688">[ date ]</a>
              <a href="thread.html#6688">[ thread ]</a>
              <a href="subject.html#6688">[ subject ]</a>
              <a href="author.html#6688">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
