<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] AMP with a long-lived connection - results and deferred?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20AMP%20with%20a%20long-lived%20connection%20-%20results%20and%0A%20deferred%3F&In-Reply-To=%3C5631AB6C.3010002%40ripton.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="062306.html">
   <LINK REL="Next"  HREF="062310.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] AMP with a long-lived connection - results and deferred?</H1>
    <B>David Ripton</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20AMP%20with%20a%20long-lived%20connection%20-%20results%20and%0A%20deferred%3F&In-Reply-To=%3C5631AB6C.3010002%40ripton.net%3E"
       TITLE="[Twisted-Python] AMP with a long-lived connection - results and deferred?">dripton at ripton.net
       </A><BR>
    <I>Wed Oct 28 23:15:24 MDT 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="062306.html">[Twisted-Python] AMP with a long-lived connection - results and	deferred?
</A></li>
        <LI>Next message (by thread): <A HREF="062310.html">[Twisted-Python] AMP with a long-lived connection - results and	deferred?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62309">[ date ]</a>
              <a href="thread.html#62309">[ thread ]</a>
              <a href="subject.html#62309">[ subject ]</a>
              <a href="author.html#62309">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/28/2015 02:24 AM, Oon-Ee Ng wrote:
&gt;<i> Working off the example ampserver.py and ampclient.py examples, I
</I>&gt;<i> wanted to build a client which maintains a single connection while
</I>&gt;<i> allowing the passing of messages back and forth. However I'm stuck at
</I>&gt;<i> one of the most basic steps, getting back the result (without
</I>&gt;<i> 'completing' the connection).
</I>&gt;<i> 
</I>&gt;<i> The ampclient.py example simply connects, does a callRemote on the
</I>&gt;<i> resulting protocol, and adds callbacks to extract the result from a
</I>&gt;<i> dictionary and print it. The deferred being used in this case is
</I>&gt;<i> produced by connectProtocol.
</I>&gt;<i> 
</I>&gt;<i> I'm trying to write a client (inheriting from amp.AMP) which is
</I>&gt;<i> embedded in a kivy GUI, something which is quite possible using the
</I>&gt;<i> _threadedselect reactor.
</I>&gt;<i> 
</I>&gt;<i> On connection, I use the connectionMade method to save the 'self' (in
</I>&gt;<i> this case, the client inheriting from amp.AMP) in my kivy app. I can
</I>&gt;<i> then call a function which does a callRemote on this saved client,
</I>&gt;<i> which indeed triggers the server appropriately.
</I>&gt;<i> 
</I>&gt;<i> The callRemote returns a deferred (from reading docs online, a remote
</I>&gt;<i> reference). I can't figure out what to do with it, specifically in
</I>&gt;<i> terms of getting the result ('total', when calling Sum from
</I>&gt;<i> ampserver.py).
</I>&gt;<i> 
</I>&gt;<i> Assistance much appreciated.
</I>
Basically, callRemote returns a deferred, that you can add callbacks and
errbacks to, which will be called when the remote call succeeds or
fails.  On success, the callback will receive an argument equal to the
return value of the remote callable that you called.  On failure, the
errback will receive an error argument.

I have an old GUI (PyGTK, not Kivy) chat over AMP example at
<A HREF="https://github.com/dripton/ampchat">https://github.com/dripton/ampchat</A> that might help you.  (Though I think
all of my commands return boring responses.)

-- 
David Ripton    <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dripton at ripton.net</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="062306.html">[Twisted-Python] AMP with a long-lived connection - results and	deferred?
</A></li>
	<LI>Next message (by thread): <A HREF="062310.html">[Twisted-Python] AMP with a long-lived connection - results and	deferred?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62309">[ date ]</a>
              <a href="thread.html#62309">[ thread ]</a>
              <a href="subject.html#62309">[ subject ]</a>
              <a href="author.html#62309">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
