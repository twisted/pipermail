<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] log config depending on nodaemon option
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20log%20config%20depending%20on%20nodaemon%20option&In-Reply-To=%3C7FCD7B2A-AF5C-4CA9-B4A7-CF37E3C3058D%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029846.html">
   <LINK REL="Next"  HREF="029852.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] log config depending on nodaemon option</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20log%20config%20depending%20on%20nodaemon%20option&In-Reply-To=%3C7FCD7B2A-AF5C-4CA9-B4A7-CF37E3C3058D%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] log config depending on nodaemon option">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Oct 28 22:45:12 MDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="029846.html">[Twisted-Python] log config depending on nodaemon option
</A></li>
        <LI>Next message: <A HREF="029852.html">[Twisted-Python] log config depending on nodaemon option
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29847">[ date ]</a>
              <a href="thread.html#29847">[ thread ]</a>
              <a href="subject.html#29847">[ subject ]</a>
              <a href="author.html#29847">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Oct 28, 2015, at 4:10 AM, Markus Wanner &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">markus at bluegap.ch</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I'm trying to configure logging of my application depending on whether
</I>&gt;<i> or not the -y (--nodaemon) option of twistd is given. Actually very
</I>&gt;<i> similar to the default behavior, I would just like to switch to daily
</I>&gt;<i> log files. But it seems the application created has no access to the
</I>&gt;<i> config (used by underlying twistd and the ApplicationRunner).
</I>&gt;<i> 
</I>&gt;<i> What's the best way to switch to daily log files using twistd?
</I>

You have 3 options, pretty much:

Submit a patch to Twisted that adds this option to twistd itself.  This is probably the most reasonable option, since you're asking for twistd to have a feature that it doesn't currently.  This is a great time to be submitting patches, too - we have two recipients of the Twisted fellowship right now available to do review work for the SFC, I have work time allotted to Twisted reviewing, and the review queue &lt;<A HREF="https://twistedmatrix.com/trac/report/25">https://twistedmatrix.com/trac/report/25</A>&gt; is consistently shorter than it's been in a long time.  So you are likely to get a quick response.
Use the `-n&#180; option and run `twistd&#180; under a supervisor like systemd, consuming, writing, and rotating its logs without daemonizing, and handle log management outside of `twistd&#180;.  This is probably the long-term direction that operations with Twisted will ultimately take, as you can see in some of the pontificating on &lt;<A HREF="https://twistedmatrix.com/trac/ticket/5705">https://twistedmatrix.com/trac/ticket/5705</A> &lt;<A HREF="https://twistedmatrix.com/trac/ticket/5705">https://twistedmatrix.com/trac/ticket/5705</A>&gt;&gt;.
Grovel around in unsupported global state like `sys.argv&#180; in your twistd plugin, and use private attributes to just change the structure of the objects internally.  I don't think this is a great idea and I probably won't help you with it ;).

The reason that state like this is not readily accessible to a twistd plugin is intentional, although we have long been paying the cost of making it difficult to configure without really realizing the benefit from this architecture, which is service composability.  For example, something like, &quot;twistd -n web --path http + words --irc-port=6667 + mail --maildirdbmdomain=example.com=/tmp/example.com + auth <A HREF="ldap://corporate-active-directory">ldap://corporate-active-directory</A>&quot; to give you IRC and web and mail all backed by the same authentication database.  If this is the case then no one plugin can really assert control over how logging is configured, so we have been trying to avoid doing a whole lot in the area of making it possible for your plugin to control the twistd environment it's started in.

If you really want to control every aspect of your deployment from your own code, you can always just import `twisted.scripts.twistd&#180; and build your own ServerOptions object that contains exactly what deployment options you want to use.

I hope this is helpful.  Thanks for using Twisted!

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20151028/36a2d99c/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20151028/36a2d99c/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029846.html">[Twisted-Python] log config depending on nodaemon option
</A></li>
	<LI>Next message: <A HREF="029852.html">[Twisted-Python] log config depending on nodaemon option
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29847">[ date ]</a>
              <a href="thread.html#29847">[ thread ]</a>
              <a href="subject.html#29847">[ subject ]</a>
              <a href="author.html#29847">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
