<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to handle arguments with undocumented	types and argument deprecation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20handle%20arguments%20with%20undocumented%0A%09types%20and%20argument%20deprecation&In-Reply-To=%3C4A1135ED-F4B1-458A-98A6-E908BE95EC4C%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029826.html">
   <LINK REL="Next"  HREF="029827.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to handle arguments with undocumented	types and argument deprecation</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20How%20to%20handle%20arguments%20with%20undocumented%0A%09types%20and%20argument%20deprecation&In-Reply-To=%3C4A1135ED-F4B1-458A-98A6-E908BE95EC4C%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] How to handle arguments with undocumented	types and argument deprecation">glyph at twistedmatrix.com
       </A><BR>
    <I>Sun Oct 25 20:30:57 MDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="029826.html">[Twisted-Python] How to handle arguments with undocumented types	and argument deprecation
</A></li>
        <LI>Next message: <A HREF="029827.html">[Twisted-Python] How to design REST API with Twisted?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29834">[ date ]</a>
              <a href="thread.html#29834">[ thread ]</a>
              <a href="subject.html#29834">[ subject ]</a>
              <a href="author.html#29834">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Oct 25, 2015, at 1:34 AM, Adi Roiban &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">adi at roiban.ro</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Is there a way to deprecate a single argument from a method/function?
</I>

Sometimes.

The idea with a deprecation is that you can remove something, emit a warning if it's used, then eventually remove it entirely, and get an error if it's used.  The trick with deprecating parameters is what happens when you get to &quot;remove it entirely&quot;.

One of the features I'm looking forward to in Py3 is &quot;keyword-only parameters&quot;.  If we had those then deprecating a parameter (as long as it's not part of a formal interface) would be easier.  As it is, there's a problem where you can have a function like this:

def foo(a, broken=None, c=None):
    ...

If you want to deprecate &quot;broken&quot;, you have to ensure that callers who call 'foo' will get a deprecation warning if they pass 'broken' at all, to ensure that callers who do, for example:

foo(a, None, &quot;something valid&quot;)

get a deprecation warning during the deprecation period.  Further, after the deprecation period, you need to get an error if you &quot;pass broken&quot;, which doesn't exist any more.  Of course if you've removed it from the function signature, it will give you an error to pass it by keyword, but if you pass it positionally:

foo(a, &quot;something valid for broken&quot;)

if you've skipped the deprecation period, the spirit of the policy is that you should get an exception here.  Normally this happens as a natural effect of the removal.  But in this case, if you've changed the signature of 'foo' to be

def foo(a, c=None):
    ...

then you have a problem where code that skips the deprecation period might appear to work and break in unpredictable ways later.  So when deprecating a parameter you have to be more careful than when deprecating a whole method or class.

Except, oops: addCookie() is part of a formal interface, IRequest.  Which means that if external users of Twisted are implementing IRequest, then they may keep accepting / requiring max_age in its old format.

So specifically in the case of max_age, I think we should just retrofit the code to handle str/int/long on py3, to reduce breakage.  At some point, we know we need a new, better IRequest, and we should ensure maxAge is better-specified on that interface.

-glyph


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20151025/b14c0ca8/attachment-0001.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20151025/b14c0ca8/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029826.html">[Twisted-Python] How to handle arguments with undocumented types	and argument deprecation
</A></li>
	<LI>Next message: <A HREF="029827.html">[Twisted-Python] How to design REST API with Twisted?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29834">[ date ]</a>
              <a href="thread.html#29834">[ thread ]</a>
              <a href="subject.html#29834">[ subject ]</a>
              <a href="author.html#29834">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
