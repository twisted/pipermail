<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.internet.protocol.Protocol.connected	flag purpose
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.internet.protocol.Protocol.connected%0A%09flag%20purpose&In-Reply-To=%3CAE84D680-AAF2-4FFD-B8D9-9A88AD47B4D2%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030702.html">
   <LINK REL="Next"  HREF="030703.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.internet.protocol.Protocol.connected	flag purpose</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.internet.protocol.Protocol.connected%0A%09flag%20purpose&In-Reply-To=%3CAE84D680-AAF2-4FFD-B8D9-9A88AD47B4D2%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] twisted.internet.protocol.Protocol.connected	flag purpose">glyph at twistedmatrix.com
       </A><BR>
    <I>Thu Aug 11 14:35:14 MDT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="030702.html">[Twisted-Python] twisted.internet.protocol.Protocol.connected flag	purpose
</A></li>
        <LI>Next message: <A HREF="030703.html">[Twisted-Python] reading multipart/form-data headers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30705">[ date ]</a>
              <a href="thread.html#30705">[ thread ]</a>
              <a href="subject.html#30705">[ subject ]</a>
              <a href="author.html#30705">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Aug 11, 2016, at 7:21 AM, Adi Roiban &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">adi at roiban.ro</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Looking at the code in trunk [1] I can see that
</I>&gt;<i> t.internet.protocol.Protocol will update the 'connected' attribute
</I>&gt;<i> upon makeConnection but will not update it on connectionLost
</I>&gt;<i> 
</I>&gt;<i> Is this the intended design?
</I>
I'm sure someone intended it at some point!  But it seems like an extraneous wart.  (This state can be detected by the presence of the 'transport' attribute, so it doesn't tell us anything interesting.)

&gt;<i> Is this design documented somewhere ?
</I>
Doubtful.

&gt;<i> I have check the narrative docs [2] and api-docs[3] but this attribute
</I>&gt;<i> is not documented.
</I>&gt;<i> 
</I>&gt;<i> What is the purpose of t.internet.protocol.Protocol.connected ?
</I>
Many things that date back this far are simple accidents of implementation.  Protocol is, after all, from the very first versions of Twisted, before we even had TDD in place.  So, unfortunately, as you're discovering, sometimes there are random little bits of maybe-useful-but-ultimately-broken functionality hanging around in uninspected parts of the codebase.

In all likelihood, whoever was implementing makeConnection (me probably, or maybe Itamar or Moshe) thought &quot;hrm, maybe I'd like to know if the protocol is connected?&quot;, stuck the attribute on there, but then forgot that they'd had that idea by the time they got to connectionLost.

That said, I don't think we should bother removing this particular wart here.  If we deprecate the attribute, we deprecate the use of the attribute 'connected' on any subclass of Protocol, which may be quite valid.  Given that it's also an old-style class, it would add non-trivial overhead to attribute access too; it would generally be a big mess.

Instead, if you want to get rid of this, we should add a new way of writing Protocol objects, which is to use a new class decorator that fills out the methods on IProtocol with no-op implementations, rather than using inheritance.  This new decorator, which resolves a bunch other problems with using inheritance, could drop accidental details like this one (if there are others; or just this one :)).

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20160811/2e94a20a/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20160811/2e94a20a/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030702.html">[Twisted-Python] twisted.internet.protocol.Protocol.connected flag	purpose
</A></li>
	<LI>Next message: <A HREF="030703.html">[Twisted-Python] reading multipart/form-data headers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30705">[ date ]</a>
              <a href="thread.html#30705">[ thread ]</a>
              <a href="subject.html#30705">[ subject ]</a>
              <a href="author.html#30705">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
