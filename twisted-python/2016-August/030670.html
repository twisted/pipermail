<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] [Twisted] #7598: Port twisted.spread.pb to	Python3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%5BTwisted%5D%20%237598%3A%20Port%20twisted.spread.pb%20to%0A%09Python3&In-Reply-To=%3CD2853C5D-56AA-467E-A5AF-FAB40FED1B1D%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030669.html">
   <LINK REL="Next"  HREF="030704.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] [Twisted] #7598: Port twisted.spread.pb to	Python3</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%5BTwisted%5D%20%237598%3A%20Port%20twisted.spread.pb%20to%0A%09Python3&In-Reply-To=%3CD2853C5D-56AA-467E-A5AF-FAB40FED1B1D%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] [Twisted] #7598: Port twisted.spread.pb to	Python3">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Aug  2 14:55:42 MDT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="030669.html">[Twisted-Python] [Twisted] #7598: Port twisted.spread.pb to	Python3
</A></li>
        <LI>Next message: <A HREF="030704.html">[Twisted-Python] [Twisted] #7598: Port twisted.spread.pb to	Python3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30670">[ date ]</a>
              <a href="thread.html#30670">[ thread ]</a>
              <a href="subject.html#30670">[ subject ]</a>
              <a href="author.html#30670">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Aug 2, 2016, at 4:38 AM, Wolfgang Rohdewald &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">wolfgang.kde at rohdewald.de</A> &lt;mailto:<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">wolfgang.kde at rohdewald.de</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Am Dienstag, 2. August 2016, 03:39:58 CEST schrieb Glyph Lefkowitz:
</I>&gt;&gt;<i>  Probably we should up-convert from bytes automatically in the places
</I>&gt;&gt;<i> where we know python will be using the values as identifiers, including
</I>&gt;&gt;<i> callRemote and the keys in a __dict__.
</I>&gt;<i> 
</I>&gt;<i> Attached is some grep for my port showing where I had co convert.
</I>&gt;<i> 
</I>&gt;<i> grep -ri -e '\(network\|native\)'
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> This is unfortunately very tricky to know though, if we support
</I>&gt;&gt;<i> serializing both bytes and strings :-\.
</I>&gt;<i> 
</I>&gt;<i> Why? The wire protocol does not change. PY3 bytes are already
</I>&gt;<i> compatible, and PY3 strings are serialized as unicode objects.
</I>
The protocol does change though.  ['foo'] in jelly means &quot;bytes&quot;.  ['unicode', 'foo'] means &quot;text&quot;.  You can fix some problems with this; obviously if you see a ['dictionary', [['unicode', 'foo'], ['unicode', 'bar']]] come in over the wire, and then get sent to setCopyableState, we can translate 'foo' back to a native 'str' in the python 2 implementation.  But what to do with 'bar'?  It will remain text.  If you extend that, and consider that your application code might have a value floating around in a variable which later gets used for a key in **kwargs or something, there's no way we can know as we're deserializing that you're going to do that, so your application is going to need to account for it manually.

Ultimately that's not a bug we can fix, so we won't.  But it's still unfortunate.

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20160802/84739989/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20160802/84739989/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030669.html">[Twisted-Python] [Twisted] #7598: Port twisted.spread.pb to	Python3
</A></li>
	<LI>Next message: <A HREF="030704.html">[Twisted-Python] [Twisted] #7598: Port twisted.spread.pb to	Python3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30670">[ date ]</a>
              <a href="thread.html#30670">[ thread ]</a>
              <a href="subject.html#30670">[ subject ]</a>
              <a href="author.html#30670">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
