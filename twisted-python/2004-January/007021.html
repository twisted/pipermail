<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Running twisted tap file as NT service
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Running%20twisted%20tap%20file%20as%20NT%20service&In-Reply-To=49199579A2BB32438A7572AF3DBB2FB538D518%40uscimplm001.net.plm.eds.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007020.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Running twisted tap file as NT service</H1>
    <B>Cory Dodt</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Running%20twisted%20tap%20file%20as%20NT%20service&In-Reply-To=49199579A2BB32438A7572AF3DBB2FB538D518%40uscimplm001.net.plm.eds.com"
       TITLE="[Twisted-Python] Running twisted tap file as NT service">corydodt at twistedmatrix.com
       </A><BR>
    <I>Fri Jan 30 12:41:59 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="007020.html">[Twisted-Python] Running twisted tap file as NT service
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7021">[ date ]</a>
              <a href="thread.html#7021">[ thread ]</a>
              <a href="subject.html#7021">[ subject ]</a>
              <a href="author.html#7021">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Tap2ntsvc creates a package structured like the following:

+-----------------------------------------------+
|<i>   inno setup installer                        |
</I>|<i>      +--------------------------------+       |
</I>|<i>      |     py2exe'd executable        |       |
</I>|<i>      |        +-----------------+     |       |
</I>|<i>      |        |  your app  code |     |       |
</I>|<i>      |        +-----------------+     |       |
</I>|<i>      |                                |       |
</I>|<i>      +--------------------------------+       |
</I>|<i>                                               |
</I>+-----------------------------------------------+

The py2exe'd executable is dynamically linked with pythonxx.dll, which is in
your directory.  (It's just a stub attached to a zip file; the stub runs
python on the zipped modules.  You can actually open it with winzip etc.)

The output, that -setup.exe, can be run on the machine where you want the
service, and it will (by default) place the py2exe stuff and whatever data
files you added to gridnode.fms in C:\program files\gridnode.  It will also
install the service as the first operation.

If you remembered all your includes when you built, all you need is the setup
executable and you have a fully functioning service.  Start it with &quot;net start
gridnode&quot; from the command line or Start&gt;Settings&gt;ControlPanel&gt;Services&gt;select
gridnode and click start, or just reboot.

Be sure to check the event logs when you do; it sometimes takes several
attempts before you collect all the modules py2exe didn't find on its own.

(Incidentally, psloglist is the best way to do this from the command line:
<A HREF="http://www.sysinternals.com/ntw2k/freeware/psloglist.shtml.">http://www.sysinternals.com/ntw2k/freeware/psloglist.shtml.</A>)

C




Schneider, Michael wrote:

|<i> Thanks for the guide.
</I>|<i>
</I>|<i> I am able to create a ntservice .exe, attached is the command that
</I>|<i> I used, and the output.
</I>|<i>
</I>|<i> My application is in the gridnode package, and it depends on twisted
</I>|<i> and standard python.
</I>|<i>
</I>|<i>
</I>|<i> Really Stupid question time. I have very little expericence with
</I>|<i> deploying windows services.
</I>|<i>
</I>|<i> What do I do next to install this?
</I>|<i> Since you leverage py2exe, does python need to be installed on the
</I>|<i> machines (I am rolling this out to several hundred machines, and
</I>|<i> python is not installed on those machine at this time)?
</I>|<i>
</I>|<i>
</I>|<i>
</I>|<i> Thank you very much for your work on this tool!!!!!!!!!!!!!!
</I>|<i>
</I>|<i> Mike
</I>|<i> ------------------- Command and Command Output
</I>|<i>
</I>|<i> D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen&gt;python tap2ntsvc
</I>- --name=&quot;gridnoded&quot; --display_name=gridnoded --disp
|<i> lay_name=&quot;Grid Node Service&quot; --type=pickle --include=gridnode
</I>d:\grid\gridnoded.tap
|<i>
</I>|<i>
</I>|<i>
</I>|<i> C:\Python23\Lib\site-packages\py2exe\build_exe.py:992: DeprecationWarning:
</I>Non-ASCII character '\xa9' in file C:\Python2
|<i> 3\Lib\site-packages\py2exe\resources\VersionInfo.py on line 226, but no
</I>encoding declared; see <A HREF="http://www.python.org/pep">http://www.python.org/pep</A>
|<i> s/pep-0263.html for details
</I>|<i>   from resources.VersionInfo import VS_VERSIONINFO, RT_VERSION, \
</I>|<i> C:\Python23\Lib\site-packages\py2exe\resources\VersionInfo.py:70:
</I>FutureWarning: hex/oct constants &gt; sys.maxint will ret
|<i> urn positive values in Python 2.4 and up
</I>|<i>   dwSignature = 0xFEEF04BD
</I>|<i> warning: py2exe: could not parse version number ''
</I>|<i>   No VersionInfo will be created
</I>|<i> warning: py2exe:
</I>*************************************************************************
|<i> warning: py2exe: * The following modules were not found:
</I>|<i> warning: py2exe: *   Carbon.Folder
</I>|<i> warning: py2exe: *   Carbon.Folders
</I>|<i> warning: py2exe: *   Crypto.Cipher
</I>|<i> warning: py2exe: *   OpenSSL
</I>|<i> warning: py2exe: *   SOCKS
</I>|<i> warning: py2exe: *   _ssl
</I>|<i> warning: py2exe: *   _xmlplus
</I>|<i> warning: py2exe: *   _xmlrpclib
</I>|<i> warning: py2exe: *   fcntl
</I>|<i> warning: py2exe: *   grp
</I>|<i> warning: py2exe: *   ic
</I>|<i> warning: py2exe: *   jarray
</I>|<i> warning: py2exe: *   java.io.IOException
</I>|<i> warning: py2exe: *   java.io.InterruptedIOException
</I>|<i> warning: py2exe: *   java.net
</I>|<i> warning: py2exe: *   readline
</I>|<i> warning: py2exe: *   rourl2path
</I>|<i> warning: py2exe: *   sgi
</I>|<i> warning: py2exe: *   sgmlop
</I>|<i> warning: py2exe:
</I>*************************************************************************
|<i> Built File dist\gridnodedsvc\gridnodedsvc.exe
</I>|<i> Created gridnoded.fms
</I>|<i> Inno Setup 4 Command-Line Compiler
</I>|<i> Copyright (C) 1998-2003 Jordan Russell. All rights reserved.
</I>|<i> Portions by Martijn Laan
</I>|<i>
</I>|<i> Compiler engine version: Inno Setup 4.0.9
</I>|<i>
</I>|<i> Reading [Setup] section, line 18
</I>|<i> Reading [Setup] section, line 19
</I>|<i> Reading [Setup] section, line 20
</I>|<i> Reading [Setup] section, line 21
</I>|<i> Reading [Setup] section, line 22
</I>|<i> Reading [Setup] section, line 23
</I>|<i> Reading file (WizardImage)
</I>|<i>    File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNIMAGE.BMP
</I>|<i> Reading file (WizardSmallImage)
</I>|<i>    File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNSMALLIMAGE.BMP
</I>|<i> Reading [LangOptions] and [Messages] sections
</I>|<i>    File: C:\Python23\Lib\site-packages\inno\program\DEFAULT.ISL
</I>|<i>    Messages in script file
</I>|<i> Reading [Code] section
</I>|<i> Reading [Dirs] section, line 16
</I>|<i> Reading [Icons] section, line 25
</I>|<i> Reading [Run] section, line 27
</I>|<i> Reading [Run] section, line 28
</I>|<i> Reading [UninstallRun] section, line 30
</I>|<i> Reading [UninstallRun] section, line 31
</I>|<i>    Reading version info: C:\Python23\Lib\site-packages\inno\program\UNINST.E32
</I>|<i> Reading [Files] section, line 2
</I>|<i> Reading [Files] section, line 3
</I>|<i> Reading [Files] section, line 4
</I>|<i> Reading [Files] section, line 5
</I>|<i> Reading [Files] section, line 6
</I>|<i> Reading [Files] section, line 7
</I>|<i> Reading [Files] section, line 8
</I>|<i> Reading [Files] section, line 9
</I>|<i> Reading [Files] section, line 10
</I>|<i> Reading [Files] section, line 11
</I>|<i> Reading [Files] section, line 12
</I>|<i> Reading [Files] section, line 13
</I>|<i> Reading [Files] section, line 14
</I>|<i> Creating setup files
</I>|<i>    Compressing: C:\Python23\Lib\site-packages\inno\program\UNINST.E32
</I>(51.9.0.0)
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnoded.tap
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnodedsvc.exe
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\parser.pyd
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\pyexpat.pyd
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\python23.dll
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\PyWinTypes23.dll
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\select.pyd
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32api.pyd
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32process.pyd
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32service.pyd
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_socket.pyd
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_sre.pyd
|<i>    Compressing:
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_winreg.pyd
|<i>
</I>|<i>
</I>|<i> Successful compile (1.402 sec). Resulting Setup program filename is:
</I>|<i>
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnoded-1.0-setup.exe
|<i>
</I>|<i> Output written to
</I>D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnodedsvc\gridnoded-setup-1.0.exe
|<i>
</I>|<i> tap2ntsvc: 0 warnings.
</I>|<i>
</I>|<i> D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen&gt;
</I>|<i> D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen&gt;
</I>|<i> D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen&gt;
</I>|<i> D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen&gt;
</I>|<i>
</I>|<i>
</I>|<i> _______________________________________________
</I>|<i> Twisted-Python mailing list
</I>|<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>|<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - <A HREF="http://enigmail.mozdev.org">http://enigmail.mozdev.org</A>

iD8DBQFAGpdn3A5SrXAiHQcRAhuSAJ9JS/gkYInzBsZN0I8+BA036pjUVQCfUV7t
p+PZrwMiupJXt2sd2xZgl8s=
=hzVT
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007020.html">[Twisted-Python] Running twisted tap file as NT service
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7021">[ date ]</a>
              <a href="thread.html#7021">[ thread ]</a>
              <a href="subject.html#7021">[ subject ]</a>
              <a href="author.html#7021">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
