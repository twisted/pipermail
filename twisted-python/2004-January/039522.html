<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Running twisted tap file as NT service
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Running%20twisted%20tap%20file%20as%20NT%20service&In-Reply-To=%3C4017DF38.9080201%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="039517.html">
   <LINK REL="Next"  HREF="039528.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Running twisted tap file as NT service</H1>
    <B>Cory Dodt</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Running%20twisted%20tap%20file%20as%20NT%20service&In-Reply-To=%3C4017DF38.9080201%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Running twisted tap file as NT service">corydodt at twistedmatrix.com
       </A><BR>
    <I>Wed Jan 28 09:11:36 MST 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="039517.html">[Twisted-Python] Running twisted tap file as NT service
</A></li>
        <LI>Next message (by thread): <A HREF="039528.html">[Twisted-Python] Running twisted tap file as NT service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39522">[ date ]</a>
              <a href="thread.html#39522">[ thread ]</a>
              <a href="subject.html#39522">[ subject ]</a>
              <a href="author.html#39522">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Thanks for trying it out.

Can you provide more details on how you ran tap2ntsvc from the command line?
The exact command line, environment (especially PYTHONPATH), working
directory, what shell (whether cygwin or windows)...

I am able to run it by ...

Start &gt; Run... &gt; &quot;cmd&quot;
C:\winnt\system32&gt;cd %twisted%\sandbox\moonfallen
C:\...\Twisted-HEAD\sandbox\moonfallen&gt;python tap2ntsvc --help
&lt;&lt;&lt; output here &gt;&gt;&gt;

C





Schneider, Michael wrote:

|<i> I am tring to convert a twisted .tap file (gridnoded.tap) to a service
</I>|<i> for windows 2000 and XP.
</I>|<i>
</I>|<i> I installed the required python packages:
</I>|<i>         - inno
</I>|<i>         - win32 extensions
</I>|<i>
</I>|<i>
</I>|<i>
</I>|<i> What I have done:
</I>|<i>     created .tap file
</I>|<i>     run with twistd  (checks out ok)
</I>|<i>
</I>|<i>
</I>|<i>
</I>|<i> When I run tap2ntsvc --help,  I get no output (error or help message).
</I>|<i>
</I>|<i> what else do I have to do to get this going?
</I>|<i>
</I>|<i> Thanks for your efforts with tap2ntsvc,
</I>|<i>
</I>|<i> Mike
</I>|<i> ------------------------------------------------------------------------------
</I>|<i>
</I>|<i> I've finished the initial work on tap2ntsvc.  This script does the
</I>|<i> tedious work of creating an installer around your Twisted service.  A
</I>|<i> quick howto:
</I>|<i>
</I>|<i> 1. Create a tap or tac file for your application, using the method you
</I>|<i> normally use.  **Test with twistd to make sure that you can start the
</I>|<i> app from the command line, _before_ you wrap a service around it.**
</I>|<i>
</I>|<i> 2. Acquire and install the prerequisites of tap2ntsvc.  It depends on
</I>|<i> software outside of Twisted, specifically:
</I>|<i> win32all @ <A HREF="http://starship.python.net/crew/mhammond/win32/Downloads.html">http://starship.python.net/crew/mhammond/win32/Downloads.html</A>
</I>|<i> Innoconda @ <A HREF="http://twistedmatrix.com/~moonfallen/innoconda.html">http://twistedmatrix.com/~moonfallen/innoconda.html</A>
</I>|<i>
</I>|<i> 3. Run tap2ntsvc from the command line.  (*This is not yet integrated
</I>|<i> with the &quot;Twisted Command Prompt&quot; available on MSWindows with the
</I>|<i> official Twisted installer, but it will be when the script becomes an
</I>|<i> official part of Twisted.) Use --help to get the command line options.
</I>|<i> To start with, all you need to provide is the name of your tap or tac file.
</I>|<i> |/ python .../Twisted/sandbox/moonfallen/tap2ntsvc myapp.tac
</I>|<i> /This will build an installable package using Innoconda.
</I>|<i>
</I>|<i> 4. Install the package.  It will be in myappsvc/myapp-...-setup.exe.
</I>|<i>
</I>|<i> 5. Start the service; it will fail, but you'll find out what modules you
</I>|<i> need to add.
</I>|<i> |/ net start myapp
</I>|<i> /**It's ok if this doesn't work.**
</I>|<i>
</I>|<i> 6. Check the Application event log to find out what modules failed to
</I>|<i> import; you will be re-running py2exe after you add the missing modules.
</I>|<i>
</I>|<i> 7. Either: (a) re-run tap2ntsvc with the -i option or (b) add your
</I>|<i> modules to myappsvc/setup.cfg on the &quot;includes=&quot; line.  If you choose to
</I>|<i> do the latter, read myappsvc/README.txt to find out how to recompile
</I>|<i> just the parts you need.
</I>|<i>
</I>|<i> 8. Redo steps 3 through 7 until you no longer get ImportErrors in the
</I>|<i> Application log.
</I>|<i>
</I>|<i> 9. Some applications need data files.  If you need data files in your
</I>|<i> application, consult myappsvc/README.txt and edit myappsvc/myapp.fms.
</I>|<i> myapp.fms uses a special command language to make adding data files as
</I>|<i> intuitive as possible.  You can put files in c:\Program Files\myapp or
</I>|<i> any subdirectory thereof, so make sure your application code can find
</I>|<i> data files there.
</I>|<i>
</I>|<i> When you're done, you should be able to 'net start myapp' successfully.
</I>|<i> ~   When you want to rebuild it in the future, just keep these files in
</I>|<i> your version control:
</I>|<i> ~  myappsvc/do_inno_script.py
</I>|<i> ~           do_inno.py
</I>|<i> ~           setup.cfg
</I>|<i> ~           setup.py
</I>|<i> ~           myapp.fms
</I>|<i>
</I>|<i> Caveats, bugs, TODO:
</I>|<i> - - you must be able to start your application in py2exe.  Things most
</I>|<i> likely to not work are finding important data files based on the value
</I>|<i> of __file__ in some module.
</I>|<i> - - if you install the same service multiple times without uninstalling it
</I>|<i> in between installs, then start it, then uninstall it, it will crash on
</I>|<i> uninstall.  Just be sure to uninstall it in between installs while
</I>|<i> you're experimenting.
</I>|<i> - - I want to make the module finder more foolproof, saving several of the
</I>|<i> steps above.  This is a non-trivial problem, however.
</I>|<i> - - Really, it needs a frontend.  And I hate Tk.  Can I put a Gtk app into
</I>|<i> ~ Twisted proper? :-)
</I>|<i>
</I>|<i>
</I>|<i> The future:
</I>|<i> I want to move tap2ntsvc out of sandbox and into main Twisted.  I want
</I>|<i> people to read this email over and try it before I do so, in case there
</I>|<i> are important concerns I need to address.  We need to give some thought
</I>|<i> to what to do about the 2 significant dependencies.  Should this block
</I>|<i> tap2ntsvc from being in Twisted proper?  Is there a policy for this sort
</I>|<i> of thing?
</I>|<i>
</I>|<i>
</I>|<i> ----------------------------------------------------------------
</I>|<i> Michael Schneider
</I>|<i> Senior Software Engineering Consultant
</I>|<i> UGS PLM Solutions - an EDS Company
</I>|<i>
</I>|<i> &quot;The Greatest Performance Improvement Is the transitioning from a
</I>|<i> non-working state to the working state&quot;
</I>|<i>
</I>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - <A HREF="http://enigmail.mozdev.org">http://enigmail.mozdev.org</A>

iD8DBQFAF9843A5SrXAiHQcRAjdzAJ9ugdK22esEoT4y7l0pone57oLY4wCfcexP
kmexXNkM3uV5iLXeWDUveI0=
=MqSP
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="039517.html">[Twisted-Python] Running twisted tap file as NT service
</A></li>
	<LI>Next message (by thread): <A HREF="039528.html">[Twisted-Python] Running twisted tap file as NT service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39522">[ date ]</a>
              <a href="thread.html#39522">[ thread ]</a>
              <a href="subject.html#39522">[ subject ]</a>
              <a href="author.html#39522">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
