<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Simulating time for reactor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Simulating%20time%20for%20reactor&In-Reply-To=%3Cuy8sdysrc.fsf%40fitlinxx.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="039487.html">
   <LINK REL="Next"  HREF="039489.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Simulating time for reactor</H1>
    <B>David Bolen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Simulating%20time%20for%20reactor&In-Reply-To=%3Cuy8sdysrc.fsf%40fitlinxx.com%3E"
       TITLE="[Twisted-Python] Simulating time for reactor">db3l at fitlinxx.com
       </A><BR>
    <I>Mon Jan 12 10:35:35 MST 2004</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="039487.html">[Twisted-Python] Suggested t.f.ftp patch for Windows users
</A></li>
        <LI>Next message (by thread): <A HREF="039489.html">[Twisted-Python] Re: Simulating time for reactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39488">[ date ]</a>
              <a href="thread.html#39488">[ thread ]</a>
              <a href="subject.html#39488">[ subject ]</a>
              <a href="author.html#39488">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I was wondering if the subject of being able to override the concept
of &quot;time&quot; for the Twisted reactor has come up before?

In the context of testing code that depends on reactor delayed events
(e.g., such as callLater), up to this point we've been controlling the
test by having the test override the timers used in the callLater
call, and then controlling the point at which the reactor &quot;cranks&quot;
(via iterate) so that we can control when the timer would or wouldn't
fire with respect to other events under test.

While this works well, it does mean that we aren't testing with actual
time values in the objects under test, thus our tests aren't enforcing
a particular time value in the design.  But I don't want the tests to
have to wait for the real time values (which can be lengthy) during
their normal execution.

For our own objects that manage events based on time delays, we have
those objects centralize their access to time through a single method,
which we can override in a mock version of that object for testing -
and thus the test has explicit control on the notion of &quot;time&quot; when it
executes.  It seems to me that something similar might be useful as a
standard part of the reactor.

For example, if IReactorCore included a now() or time() method which
was the only way it grabbed system time, then tests could mock up a
reactor to be installed at the start of a test and just override that
one method to control time.  From looking at base.py in the Twisted
distribution for example, it only appears that a few uses of
time.time() would have to be tweaked.

Anyway, I was curious if this has come up before, and if so, how else
have people tested reactor based code that has lengthy timers involved?

-- David




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="039487.html">[Twisted-Python] Suggested t.f.ftp patch for Windows users
</A></li>
	<LI>Next message (by thread): <A HREF="039489.html">[Twisted-Python] Re: Simulating time for reactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39488">[ date ]</a>
              <a href="thread.html#39488">[ thread ]</a>
              <a href="subject.html#39488">[ subject ]</a>
              <a href="author.html#39488">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
