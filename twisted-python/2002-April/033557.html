<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] mutexes in twisted.enterprise?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20mutexes%20in%20twisted.enterprise%3F&In-Reply-To=%3C309B2201-5362-11D6-B58C-0003938210D6%40redivi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="033555.html">
   <LINK REL="Next"  HREF="033558.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] mutexes in twisted.enterprise?</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20mutexes%20in%20twisted.enterprise%3F&In-Reply-To=%3C309B2201-5362-11D6-B58C-0003938210D6%40redivi.com%3E"
       TITLE="[Twisted-Python] mutexes in twisted.enterprise?">bob at redivi.com
       </A><BR>
    <I>Fri Apr 19 00:53:44 MDT 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="033555.html">[Twisted-Python] mutexes in twisted.enterprise?
</A></li>
        <LI>Next message (by thread): <A HREF="033558.html">[Twisted-Python] mutexes in twisted.enterprise?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33557">[ date ]</a>
              <a href="thread.html#33557">[ thread ]</a>
              <a href="subject.html#33557">[ subject ]</a>
              <a href="author.html#33557">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It's not the order of the rows, it's the order in which the database 
*processes* those rows.  I'm not doing inserts, I'm calling user defined 
functions that do a pretty complex set of updates and inserts on 
multiple tables depending on the new data and existing data.  It really 
needs to process them in the order that they are received.

It's not that the order of every row is significant, the rows represent 
certain events.  Such as remove or add.  There's a big difference 
between add and then remove versus remove and then add.. it's very much 
not commutative, like matrix multiplication.  The order has meaning.  
Each row does have a timestamp, but there isn't a way to say &quot;process 
this once you're sure you're not going to receive another row with an 
earlier timestamp than yourself&quot; and it's not easy to insert rows out of 
order because you need to know exactly what the preceding row(s) 
accomplished, roll it all back, do your thing, and then commit them 
again.

If I can make sure that the rows are processed in the order that they 
are received, I don't have to worry about the consistency.

On Thursday, April 18, 2002, at 10:50 PM, Sean Riley wrote:

&gt;<i> well, knowing nothing about your application... relying on the order of 
</I>&gt;<i> rows
</I>&gt;<i> in a relational database table is generally a bad practice - this order 
</I>&gt;<i> is
</I>&gt;<i> really arbitrary and in some cases could actually change (depending on 
</I>&gt;<i> the
</I>&gt;<i> db you are using - clustered indices as primary keys for example). If 
</I>&gt;<i> you
</I>&gt;<i> want sequence information, I'd recommend you embed it in your rows - 
</I>&gt;<i> don't
</I>&gt;<i> rely on the order of the rows in the table.
</I>&gt;<i>
</I>&gt;<i> anyway.. you can perform syncronous operations through a
</I>&gt;<i> twisted.enterprise.ConnectionPool by creating your own Transaction 
</I>&gt;<i> objects
</I>&gt;<i> and passing them to ConnectionPool::_runIteraction(). Maybe a queue 
</I>&gt;<i> with a
</I>&gt;<i> single db thread that you use syncronously?
</I>&gt;<i>
</I>&gt;<i> twisted.enterprise needs more docs... especially the Row interface, but 
</I>&gt;<i> it
</I>&gt;<i> is good to hear that someone else is using it.
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>
</I>&gt;<i> [mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python-admin at twistedmatrix.com</A>]On Behalf Of Bob Ippolito
</I>&gt;<i> Sent: Thursday, April 18, 2002 8:14 PM
</I>&gt;<i> To: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">twisted-python at twistedmatrix.com</A>
</I>&gt;<i> Subject: Re: [Twisted-Python] mutexes in twisted.enterprise?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Well see the thing is that yes, the db supports transactions [postgres],
</I>&gt;<i> but I need to make sure the db processes requests in the order that
</I>&gt;<i> they're received over the wire, not whenever that particular db
</I>&gt;<i> connection gets around to it.
</I>&gt;<i>
</I>&gt;<i> I don't think I'm currently having issues w/ it right now, but I'm just
</I>&gt;<i> concerned that potentially it could be a problem someday.
</I>&gt;<i>
</I>&gt;<i> On Thursday, April 18, 2002, at 09:04 PM, Andrew Bennetts wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Thu, Apr 18, 2002 at 08:49:41PM -0400, Bob Ippolito wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm doing some twisted.enterprise crap and I was wondering if it was
</I>&gt;&gt;&gt;<i> safe to use thread mutexes to make sure that only one interaction goes
</I>&gt;&gt;&gt;<i> at a time?  I have some queries that shouldn't run in parallel under
</I>&gt;&gt;&gt;<i> certain conditions and I believe forcing it w/ mutexes would be the
</I>&gt;&gt;&gt;<i> safest and easiest solution... but I haven't looked much into what's
</I>&gt;&gt;&gt;<i> going on under the hood and I'm wondering if it'll do Very Bad Things?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Interactions all run inside a db transaction, I think (someone please
</I>&gt;&gt;<i> correct me if I'm wrong).  So if your DB supports transactions, then 
</I>&gt;&gt;<i> you
</I>&gt;&gt;<i> should be fine already.  I'm presuming that by &quot;interaction&quot; you mean
</I>&gt;&gt;<i> twisted.enterprise.adbapi.Augmentation.runInteraction?
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm using Twisted 0.15.2, I believe.. I don't want to upgrade at the
</I>&gt;&gt;&gt;<i> moment because it's in testing for a few weeks.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So already we have legacy systems to support :)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm not aware of any significant changes to twisted.enterprise since
</I>&gt;&gt;<i> 0.15.2.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Andrew.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Twisted-Python mailing list
</I>&gt;&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="033555.html">[Twisted-Python] mutexes in twisted.enterprise?
</A></li>
	<LI>Next message (by thread): <A HREF="033558.html">[Twisted-Python] mutexes in twisted.enterprise?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33557">[ date ]</a>
              <a href="thread.html#33557">[ thread ]</a>
              <a href="subject.html#33557">[ subject ]</a>
              <a href="author.html#33557">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
