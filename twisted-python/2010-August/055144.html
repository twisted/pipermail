<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Configuring Twisted logging via plugins
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Configuring%20Twisted%20logging%20via%20plugins&In-Reply-To=%3C5966E51D-CCB9-4E42-BDAE-93BFB311DF96%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="055142.html">
   <LINK REL="Next"  HREF="055143.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Configuring Twisted logging via plugins</H1>
    <B>Valeriy Zamarayev</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Configuring%20Twisted%20logging%20via%20plugins&In-Reply-To=%3C5966E51D-CCB9-4E42-BDAE-93BFB311DF96%40gmail.com%3E"
       TITLE="[Twisted-Python] Configuring Twisted logging via plugins">valeriy.zamarayev at gmail.com
       </A><BR>
    <I>Thu Aug  5 13:06:11 MDT 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="055142.html">[Twisted-Python] Configuring Twisted logging via plugins
</A></li>
        <LI>Next message (by thread): <A HREF="055143.html">[Twisted-Python] Get trial to use the docstring?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55144">[ date ]</a>
              <a href="thread.html#55144">[ thread ]</a>
              <a href="subject.html#55144">[ subject ]</a>
              <a href="author.html#55144">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Aug 5, 2010, at 20:25, Glyph Lefkowitz wrote:

&gt;<i> On Aug 5, 2010, at 12:44 AM, Valeriy Zamarayev wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> See the code:  <A HREF="http://gist.github.com/505926">http://gist.github.com/505926</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This works for me. I don't know if a better and less dangerous way to
</I>&gt;&gt;<i> achieve the same exists. Maybe there is one?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This actually looks pretty ingenious to me!  It uses public APIs...  
</I>&gt;<i> mostly.  I'd have to think pretty hard about whether this particular  
</I>&gt;<i> interface is actually supported, of course, since you're depending  
</I>&gt;<i> on extra stuff from your service parent which hypothetically may not  
</I>&gt;<i> actually be there.
</I>
The hack is based on a few assumptions:
  1. the service parent for a plugin is the application.
  2. setServiceParent will be called soon after plugin configuration.

I don't know how stable and safe these assumptions are, just hope that
by the time something changes, there will be an official way :)


&gt;<i> If you're looking for aesthetic advice, it would be a bit nicer to  
</I>&gt;<i> use something like proxyForInterface and wrap the underlying  
</I>&gt;<i> service, rather than setting an attribute on it and clobbering its  
</I>&gt;<i> setServiceParent method.
</I>
Oh, yes. I'll change this, thanks.

&gt;<i>
</I>&gt;<i> Also... you could write a twistd plugin that could be used directly,  
</I>&gt;<i> instead of code that needs to be adapted / re-written for each  
</I>&gt;<i> different twistd plugin.  Your code can scan the IServiceMaker  
</I>&gt;<i> plugin registry just as well as twistd itself can.
</I>&gt;<i>
</I>&gt;<i> So you could have
</I>&gt;<i>
</I>&gt;<i>   twistd my-custom-logger --my-log-option-1 --my-log-option-2 web -- 
</I>&gt;<i> path ~/public_html
</I>&gt;<i>
</I>&gt;<i> and have the my-custom-logger plugin delegate to all twistd  
</I>&gt;<i> subcommands.
</I>&gt;<i>
</I>&gt;<i> That's a pattern which should remain useful even after #638 is fixed.
</I>&gt;<i>
</I>&gt;<i> Code to do this properly is left as an exercise for the reader, of  
</I>&gt;<i> course :).
</I>&gt;<i>
</I>
Nice idea. I actually though about writing a single .tac which could  
configure
logging and then find and start whatever plugin is given in the  
command line.
But then I found that a .tac isn't even necessary.

Given what Jean-Paul says about option parsing, it is not that  
straigtforward.
I don't need (yet) to configure logging of standard or third party  
plugins,
only my own.

So if the goal is just to reuse the code and not do the same with  
every plugin,
it's easy to use a template-method technique, and reuse the hack code  
across all
the plugins (The example in the gist is a bit artificial).

Regards,
Valeriy



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="055142.html">[Twisted-Python] Configuring Twisted logging via plugins
</A></li>
	<LI>Next message (by thread): <A HREF="055143.html">[Twisted-Python] Get trial to use the docstring?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55144">[ date ]</a>
              <a href="thread.html#55144">[ thread ]</a>
              <a href="subject.html#55144">[ subject ]</a>
              <a href="author.html#55144">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
