<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Running a twisted server as a WinNT service
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Running%20a%20twisted%20server%20as%20a%20WinNT%20service&In-Reply-To=1008132560.3358.9.camel%40zelda">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000650.html">
   <LINK REL="Next"  HREF="000656.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Running a twisted server as a WinNT service</H1>
    <B>Andrew Bennetts</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Running%20a%20twisted%20server%20as%20a%20WinNT%20service&In-Reply-To=1008132560.3358.9.camel%40zelda"
       TITLE="[Twisted-Python] Running a twisted server as a WinNT service">andrew-twisted at puzzling.org
       </A><BR>
    <I>Wed Dec 12 02:54:30 EST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="000650.html">[Twisted-Python] Running a twisted server as a WinNT service
</A></li>
        <LI>Next message: <A HREF="000656.html">[Twisted-Python] Running a twisted server as a WinNT service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#655">[ date ]</a>
              <a href="thread.html#655">[ thread ]</a>
              <a href="subject.html#655">[ subject ]</a>
              <a href="author.html#655">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Dec 11, 2001 at 10:49:20PM -0600, Glyph Lefkowitz wrote:
&gt;<i> On Sun, 2001-12-09 at 20:46, Andrew Bennetts wrote:
</I>&gt;<i> &gt; I wonder if there is a more integrated way to do this, though?
</I>&gt;<i> 
</I>&gt;<i> Well, the &quot;integrated&quot; way to do it would probably to be something
</I>&gt;<i> similar to moshe's 'tap2deb' -- a Twisted service would probably be a
</I>&gt;<i> .tap or .tac file which got loaded, similar to the way twistd does, and
</I>&gt;<i> used the 'startLogging' call to open a log file and start writing to
</I>&gt;<i> it.  A good default would be the doc/examples/coil.tac currently in CVS
</I>&gt;<i> (and in the coopweb.org &quot;breakfast builds&quot;).
</I>
Hmm.  I'm not sure how this would work... Python supports WinNT services
by providing a special executable &quot;PythonService.exe&quot;, which runs the
script on your behalf, and passes things like &quot;Stop&quot; messages to your
SvcStop method.  The HandleCommandLine bit at the end of that script I
gave is a conveniece thing to wrap up installation and removal of
services -- typical usage of a script is:

    myservice.py install        # installs the service

    myservice.py start          # starts the service, this can also be
                                # done via the control panel

    myservice.py remove         # removes the service from the system

Services are just processes that can be automatically started on boot,
and can be stopped and started.  My point here is that whatever twisted
does, it will need to do it inside of a class with SvcDoRun, etc, that
needs to be registered as a service.

Apologies if I've just told you what you already know...

&gt;<i> Does win32 have a standardized logging mechanism?  Twisted can log to
</I>&gt;<i> any file-like object, so if we could put log messages wherever winnt
</I>&gt;<i> expects to find them that would be good ;-)  (I vaguely recall something
</I>&gt;<i> called the &quot;Event Log&quot;?)
</I>
It does, but it's more for logging &quot;events&quot; than individual messages,
i.e. each line of the current log file should *not* be an entry in the
NT event log, unless you're okay with spamming the log ;)

Typically, programs will only report unusual events in the Event Log,
e.g. &quot;could not replicate filesystem&quot;, &quot;the service 'blah' could not be
started&quot;, etc.  There is a notion of severity, though.  Basically, I'm
not sure that the NT Event Log is going to properly fit the way Twisted
logs, especially seeing as services failing already gets logged
automatically, and PythonService.exe sees to it that the traceback is
included.

I'm not sure of any better standard places though.  I believe IIS
typically logs to %SYSTEMROOT%\Logs\W3SVC\yyyymmdd.log (SYSTEMROOT is an
environment variable that typically is set to C:\WINNT). Perhaps a
similar scheme would be appropriate for Twisted?

If you are interested in the Event Log route, just Google for &quot;python
event log&quot;, or read the relevant chapter of the _Programming Python on
Win32_ book.

-Andrew.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000650.html">[Twisted-Python] Running a twisted server as a WinNT service
</A></li>
	<LI>Next message: <A HREF="000656.html">[Twisted-Python] Running a twisted server as a WinNT service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#655">[ date ]</a>
              <a href="thread.html#655">[ thread ]</a>
              <a href="subject.html#655">[ subject ]</a>
              <a href="author.html#655">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
