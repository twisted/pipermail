<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Passport, my ideas about an LDAP backend
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Passport%2C%20my%20ideas%20about%20an%20LDAP%20backend&In-Reply-To=87u1u8if8g.fsf%40ki.yok.utu.fi">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000673.html">
   <LINK REL="Next"  HREF="000676.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Passport, my ideas about an LDAP backend</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Passport%2C%20my%20ideas%20about%20an%20LDAP%20backend&In-Reply-To=87u1u8if8g.fsf%40ki.yok.utu.fi"
       TITLE="[Twisted-Python] Passport, my ideas about an LDAP backend">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Dec 31 10:19:48 EST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="000673.html">[Twisted-Python] Passport, my ideas about an LDAP backend
</A></li>
        <LI>Next message: <A HREF="000676.html">[Twisted-Python] Passport, my ideas about an LDAP backend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#675">[ date ]</a>
              <a href="thread.html#675">[ thread ]</a>
              <a href="subject.html#675">[ subject ]</a>
              <a href="author.html#675">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 2001-12-30 at 15:13, Tommi Virtanen wrote:
&gt;<i> 
</I>&gt;<i> Here's a sketch of how I imagine an LDAP backend to passport will
</I>&gt;<i> work:
</I>&gt;<i> 
</I>&gt;<i> LDAP is a logically simple (implementation horrible:) TCP protocol
</I>&gt;<i> with messages passing in both directions. User authentication is one
</I>&gt;<i> possible message type, and the server replies with either success or
</I>&gt;<i> an error message.
</I>&gt;<i> 
</I>&gt;<i> For just searching and browsing, you can bind anonymously. Most
</I>&gt;<i> servers allow read-only access by default.
</I>&gt;<i> 
</I>&gt;<i> But for any kind of modification, we need to bind.
</I>&gt;<i> 
</I>&gt;<i> So far, this seems pretty much like with databases. However, here's
</I>&gt;<i> the big catch: the normal way to use databases is to have one userid
</I>&gt;<i> and password per application, and perhaps store actual userids and
</I>&gt;<i> passwords within a table in the database. The normal way to use LDAP
</I>&gt;<i> is to bind _as the user who is doing the operation_.
</I>&gt;<i> 
</I>&gt;<i> Here is a list of requirements I can think, that need to be fulfilled
</I>&gt;<i> in order for me to be able to use passport. Some of these may be very
</I>&gt;<i> trivial, or taken for granted by now -- I'm just making sure they are
</I>&gt;<i> seen.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Requirement #1: Passport needs to be async.
</I>&gt;<i> 
</I>&gt;<i> In order to be able to use LDAP as the backend for passport-like user
</I>&gt;<i> verification, the backend needs to be able to talk to a possibly slow
</I>&gt;<i> server.
</I>
There are other, perhaps obvious, reasons why this needs to be so. 
Identities are already async and I'm working on making Perspectives
async right now.  I'll check in something by tomorrow at the latest.

&gt;<i> Requirement #2: Passport must be able to store data in the
</I>&gt;<i> Perspective during authentication.
</I>
&gt;<i> However, if the application wants to use LDAP for more than just user
</I>&gt;<i> authentication, things get a bit worse. We could just store the
</I>&gt;<i> password we saw the user enter, and later bind to the LDAP server as
</I>&gt;<i> this user. However, I dislike storing plain-text passwords in virtual
</I>&gt;<i> memory.
</I>
I'm not sure what you're talking about here -- it sounds like you're
using &quot;authentication&quot; to mean two different things.  First, what is
*the* Perspective?  An Identity (presumably Identities are stored in
LDAP) has multiple Perspectives.

&gt;<i> Requirement #3: Passport must be able to ask users to reauthenticate.
</I>&gt;<i> 
</I>&gt;<i> A better way is to remember that we already did bind (authenticate) to
</I>&gt;<i> the LDAP server as that user. Just reserve that connection for that
</I>&gt;<i> user alone. As long as the connection is alive, we can keep on talking
</I>&gt;<i> to the LDAP server.
</I>&gt;<i> 
</I>&gt;<i> Now, programs can be restarted, TCP connections can die, and servers
</I>&gt;<i> can utilize idle timeouts, maximum time limits, or limit maximum
</I>&gt;<i> number of operations per connection. The TCP connection can die any
</I>&gt;<i> moment. As we didn't store the user password, we need to ask it again
</I>&gt;<i> when we see the connection has closed and the user tries an operation
</I>&gt;<i> that requires talking to the LDAP server. This requires &quot;invalidating&quot;
</I>&gt;<i> the users previous authentication.
</I>
OK.  So it sounds like you want any interaction with a perspective or
identity to be able to potentially raise an exception that says &quot;you
need to offer credentials for this Identity again&quot;.  Frameworks (e.g.
web.guard, pb.AuthRoot) will need to handle this sensibly.

It's a reasonable requirement, but it may be domain-specific to your
LDAP interaction stuff.  I know that I have at least one system where
authentication is persistent within a server once it's been accomplished
(interaction with the authentication database stops after the user's
been verified).

-- 
______      you are in a maze of twisted little applications, all
|<i>   |_\     remarkably consistent.
</I>|<i>     |          -- glyph lefkowitz, glyph @ twisted matrix . com
</I>|<i>_____|             <A HREF="http://www.twistedmatrix.com/">http://www.twistedmatrix.com/</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000673.html">[Twisted-Python] Passport, my ideas about an LDAP backend
</A></li>
	<LI>Next message: <A HREF="000676.html">[Twisted-Python] Passport, my ideas about an LDAP backend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#675">[ date ]</a>
              <a href="thread.html#675">[ thread ]</a>
              <a href="subject.html#675">[ subject ]</a>
              <a href="author.html#675">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
