From tv at tv.debian.net  Wed Oct  1 02:43:33 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Wed, 01 Oct 2003 09:43:33 +0300
Subject: [Twisted-Python] Serving web content over SSL
In-Reply-To: <007401c3879c$33654a70$0401a8c0@razor>
References: <007401c3879c$33654a70$0401a8c0@razor>
Message-ID: <3F7A7795.8010301@tv.debian.net>

Thomas Weholt wrote:
> Can anybody provide a working, simple example of a SSL-capable web-server
> using Twisted ?
> Any hints or clues regarding installation of openssl or other required
> library is also interesting.

twisted-web

deb http://twistedmatrix.com/~moshez/apt/ ./

cvs -d :ext:cvs.twistedmatrix.com:/cvs co TwistedWebDeb

Put this in /etc/twisted-web/local.d/20ssl

from twisted.internet import reactor, ssl
from twisted.web import static, server

port = 443

ctx  = ssl.DefaultOpenSSLContextFactory(
	'/etc/twisted-web/ssl/private/privkey.pem',
         '/etc/twisted-web/ssl/cert.pem')
application.listenSSL(port, site, ctx)

Of course, you'll need to create the SSL key with openssl.




From radix at twistedmatrix.com  Wed Oct  1 03:52:05 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 1 Oct 2003 03:52:05 -0400
Subject: [Twisted-Python] sorry for that spam [was: Some stupid spam subject]
In-Reply-To: <b8i4$6329$$r743302-1$7s4f2k-blt@kbgby1bumer>
References: <b8i4$6329$$r743302-1$7s4f2k-blt@kbgby1bumer>
Message-ID: <20031001075205.GG1515@radii>

On Tue, Sep 30, 2003 at 08:39:25PM -0200, jv5Hivfj6183j4 at aonehotwebdeals.com wrote:

I'm sorry, I inadvertently let this message through the moderation
queue. I was trying to approve Tv's post (Please subscribe, btw,
Tommi), and I must've approved the wrong post. I just wanted to make
sure nobody thought that this is one of those annoying lists that
allows spammers to post :)

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From itamar at itamarst.org  Wed Oct  1 12:24:16 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 1 Oct 2003 12:24:16 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] Implement ReconnectingPBClientFactory, please
 review
In-Reply-To: <E1A4bFu-0008Iq-00@wolfwood>
References: <E1A4bFu-0008Iq-00@wolfwood>
Message-ID: <20031001122416.516adb6b.itamar@itamarst.org>

On Wed, 01 Oct 2003 01:18:38 -0600
warner CVS <warner at wolfwood.twistedmatrix.com> wrote:

> Modified files:
> Twisted/sandbox/warner/test_pb.py None 1.1
> Twisted/sandbox/warner/pb.py None 1.1
> 
> Log message:
> Implement ReconnectingPBClientFactory, please review

You can override failedToGetPerspective to get the error but because
it's a callback on a Deferred and returns the error it will always cause
error to get logged, which is not necessarily what you want. Maybe it
shouldn't return anything.

Or... hm. If you don't override it you do want the error logged. OK.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From mesozoic at polynode.com  Wed Oct  1 15:30:30 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 01 Oct 2003 15:30:30 -0400
Subject: [Twisted-Python] Serving web content over SSL
In-Reply-To: <3F7A7795.8010301@tv.debian.net>
References: <007401c3879c$33654a70$0401a8c0@razor>
	 <3F7A7795.8010301@tv.debian.net>
Message-ID: <1065036629.6266.23.camel@hyla>

On Wed, 2003-10-01 at 02:43, Tommi Virtanen wrote:
> twisted-web

While we're on the topic, I mentioned in IRC this morning that
twisted-web is now failing to load because it's running twistd with the
--quiet flag, which was one of several removed in the twistd refactor.

I asked whether I should post this to the tracker (meaning twistd needs
to support --quiet) or whether Moshe would just fix twisted-web. I got
no definitive answer. Maybe I'll get one here.

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031001/a22c96d7/attachment.pgp 

From greg at digitalinfo.net  Wed Oct  1 17:20:17 2003
From: greg at digitalinfo.net (Greg)
Date: Wed, 1 Oct 2003 17:20:17 -0400
Subject: [Twisted-Python] smtp.SMTP help
Message-ID: <200310011720.17355.greg@digitalinfo.net>

Working on an SMTP filter (consisting of an SMTP server that receives 
messages, some code that mangles them, then and SMTP client that forwards 
them along). The first step is to get a functioning SMTP server working, and 
I'm having some trouble with SMTPFactory / SMTP. I've overloaded the validate 
methods in an attempt accept emails to and from any domain, but I can't 
figure out how to hook in a class that implements IMessageDelivery:

-----------------------------------------------------------
class MySMTPFactory(SMTPFactory):
	def buildProtocol(self, addr):
		self.protocol = MySMTPProtocol
		return SMTPFactory.buildProtocol(self, addr)

class MySMTPProtocol(SMTP):
		
	def validateFrom(self, helo, origin):
		return origin
		
	def validateTo(self, user):
		d = defer.Deferred()
		reactor.callLater(0, self.fakeSucceed())
		return d
		
	def fakeSucceed(self):
		return MyIMessage
			
class MyIMessage:
	__implements__ = (smtp.IMessageDelivery)
	
	def __init__(self):
		print "MyIMessage.__init__ got called...."
	
	def validateTo(self, user):
		print "MyIMessage.validateTo got called..."
		return user

	def validateFrom(self, helo, origin):
		print "MyIMessage.validateFrom got called..."
		return origin

	def receivedHeader(self, helo, origin, recipients):
		print "MyIMessage.receivedHeader got called..."
		return None
-----------------------------------------------------------

I gleaned most of this from looking at the testing code. The SMTP server 
reports "503 Must have valid receiver and originator" after the client issues 
the DATA command, and none of the methods in MyIMessage (except for __INIT__) 
ever get called. Any tips as to what I'm doing wrong? Thanks. 




From iko at cd.chalmers.se  Wed Oct  1 19:47:17 2003
From: iko at cd.chalmers.se (Anders Hammarquist)
Date: Thu, 02 Oct 2003 01:47:17 +0200
Subject: [Twisted-Python] smtp.SMTP help 
In-Reply-To: <200310011720.17355.greg@digitalinfo.net> 
References: <200310011720.17355.greg@digitalinfo.net> 
Message-ID: <200310012347.h91NlHW04812@haddock.cd.chalmers.se>

Hi Greg!

In a message of Wed, 01 Oct 2003 17:20:17 EDT, Greg writes:
>Working on an SMTP filter (consisting of an SMTP server that receives 
>messages, some code that mangles them, then and SMTP client that forwards 
>them along). The first step is to get a functioning SMTP server working, and 
>I'm having some trouble with SMTPFactory / SMTP. I've overloaded the validate 
>methods in an attempt accept emails to and from any domain, but I can't 
>figure out how to hook in a class that implements IMessageDelivery:

There are several problems with your code, but to my eye it looks like
confusion between several methods of using the SMTP class. Until recently,
the IMessageDelivery method didn't exists, and you needed to override
SMTP to implement validateTo and validateFrom. Now, you can instead pass
an IMessageDelivery to SMTP, either directly or using the authenticator
(and if you do, you shouldn't need to subclass SMTP - and if your twisted
is recent enough, you have to use the IMessageDelivery method).

You do need to make your own factory though, since the one that's there
doesn't deal with IMessageDelivery()s yet. Something like

class MySMTPFactory(SMTPFactory):
	def buildProtocol(self, addr):
		p = self.protocol(MyMessageDelivery())
		p.factory = self
		p.portal = self.portal
		p.host = self.domain
		return p

>class MySMTPProtocol(SMTP):
[...]
>	def validateTo(self, user):
>		d = defer.Deferred()
>		reactor.callLater(0, self.fakeSucceed())
>		return d

You don't need this code, but I still want to point out that it doesn't
do anything useful, and is overcomplicated. 

First, validateTo may return an IMessage or a deferred returning an
IMessage, so you don't need the deferred, you can just return you
IMessage directly. Secondly the deferred is never called, so it will
never return, and thus your SMTP server stops here.

reactor.callLater() just calls another function asynchrously and discards
the result. If you want to pass back a result from a callLater, you need
to pass along the deferred and call it in the function you callLater()ed.

>class MyIMessage:
>	__implements__ = (smtp.IMessageDelivery)

You seem to have mixed up IMessage and IMessageDelivery. You need both.
Your IMessageDelivery.validateTo() should return an IMessage (or a deferred
returning an IMessage).

HTH
/Anders

-- 
 -- Of course I'm crazy, but that doesn't mean I'm wrong.
Anders Hammarquist                                  | iko at cd.chalmers.se
Physics student, Chalmers University of Technology, | Hem: +46 31 88 48 50
G|teborg, Sweden.           RADIO: SM6XMM and N2JGL | Mob: +46 707 27 86 87



From slt5v at cc.usu.edu  Wed Oct  1 22:24:35 2003
From: slt5v at cc.usu.edu (Travis B. Hartwell)
Date: Wed, 01 Oct 2003 20:24:35 -0600
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
Message-ID: <87zngkwf4s.fsf@lutya.travishartwell.net>

Hey all,

In my recent efforts to update the Beyond code base to use recent,
preferred, and non-deprecated Twisted developments such as new cred, I
have encountered a few problems in updating the unit tests to match my
changes.  The unit tests as they stood before my changes used the old
pyunit module.  After successfully converting the tests on the old
code base to use twisted.trial (and fixing a probable bug in the
process that pyunit didn't expose), I attempted to get them to work
with my changes.  That's where the problems started happening.  From
my experience and looking through the unit tests written for Twisted,
I have come up with the following questions.  As a background, the
client and server that I am testing in Beyond is implemented using PB.

1.  Does proper testing necessitate or at least include actually
    communicating over a port for the client and server?  I see this
    is done for the PB tests and several others, but not for many.
    
2.  Closely related, what is the proper way to connect the client and
    server?  When I made changes, the t.test.test_pb.IOPump that the
    tests were using didn't seem to work.  According to spiv, this may
    not be the preferred connecting method to use anymore.
    
3.  From that, if I use the twisted.protocols.loopback module, how do
    I set up callbacks for events such as logging in?  As I am using
    it now, it appears that things just hang and nothing is ever
    completed.  For example, in one of my tests, I have this code,
    with self.p being my portal and self.c being an instance of my PB
    client:

        accum = []
        factory = pb.PBClientFactory()
        deferred = factory.login(UsernamePassword("guest", "guest"), client=self.c)
        deferred.addCallbacks(accum.append, self.errorReceived)
        loopback.loopbackTCP(self.p, self.c)

    It just sits there, not advancing beyond the loopbackTCP call.
    
4.  Regardless of the method used, what is the proper way to have the
    reactor keep going until there are no more events?  I need
    something analogous to test_pb.IOPump.pump() or flush(), if IOPump
    is not to be used.

    trial.unittest.TestCase.runReactor()?
    
5.  When is the proper time to use unittest.deferredResult?  I see it
    used in some cases, yet in other cases regular callbacks and
    errbacks are used.

6.  Realted to that, when I added callbacks and errbacks, they didn't
    seem to get executed.  Yet looking at test_newcred.py, on line 89
    for example, they are added and then immediately the result is
    checked.  Does this work because I am listening on a port?  Or was
    my doing this not working originally because the client and server
    were not connected?  Later in the same file deferredResult is used.
    I'm not understanding what the expected behavior is then.

7.  Is it preferred to use unittest.TestCase.assertEqual to the plain
    assert?  I see both used in various places in the Twisted tests.


I hope these questions make sense.  I felt the mailing list was a
better forum for this than IRC because I had detailed questions.
Also, would it be appropriate for general cases of answers to these
questions (especially ones like #5 and #7) to be added to the "Unit
Tests in Twisted" howto?  I would be willing to put those appropriate
into there after someone answers my questions. :)

Thanks a million,
and slowly learning,

Travis



From radix at twistedmatrix.com  Wed Oct  1 22:44:05 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 1 Oct 2003 22:44:05 -0400
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
In-Reply-To: <87zngkwf4s.fsf@lutya.travishartwell.net>
References: <87zngkwf4s.fsf@lutya.travishartwell.net>
Message-ID: <20031002024405.GK1515@radii>

On Wed, Oct 01, 2003 at 08:24:35PM -0600, Travis B. Hartwell wrote:
> 1.  Does proper testing necessitate or at least include actually
>     communicating over a port for the client and server?  I see this
>     is done for the PB tests and several others, but not for many.

Well, this is actually usually the easiest way to test your code;
otherwise, you need to deal with crap like fake transports, etc. If
you do test over the network, make sure you listen on a local-only
interface (i.e., '127.0.0.1') and use a portno of 0. e.g.:

        self.port = reactor.listenTCP(0, self.svr, interface="127.0.0.1")
        self.portno = self.port.getHost()[-1]

> 2.  Closely related, what is the proper way to connect the client and
>     server?  When I made changes, the t.test.test_pb.IOPump that the
>     tests were using didn't seem to work.  According to spiv, this may
>     not be the preferred connecting method to use anymore.

Well, if you do what I said above, then you just need to use regular
connectTCP(self.portno, fac).

> 3.  [moot question deleted]
>
> 4.  Regardless of the method used, what is the proper way to have the
>     reactor keep going until there are no more events?  I need
>     something analogous to test_pb.IOPump.pump() or flush(), if IOPump
>     is not to be used.
> 
>     trial.unittest.TestCase.runReactor()?

Well, you don't really need "until there are no more events" --
usually, you just run the reactor until some state is reached, e.g.:

        while not l:
            reactor.iterate()

assuming that something triggered by running the reactor will
eventually make `l' True (e.g., if l started as an empty list, by
appending something to it). runReactor is only useful for
timing-related tests.

> 5.  When is the proper time to use unittest.deferredResult?  I see it
>     used in some cases, yet in other cases regular callbacks and
>     errbacks are used.

Well, any time you just want to get the result of a Deferred and don't
want to add a callback, you can use deferredResult. Some people
writing tests that use callbacks might not have known about
deferredResult, or don't like it, or needed to take advantage of
callback chaining, or whatever.

> 6.  Realted to that, when I added callbacks and errbacks, they didn't
>     seem to get executed.  Yet looking at test_newcred.py, on line 89
>     for example, they are added and then immediately the result is
>     checked.  Does this work because I am listening on a port?  Or was
>     my doing this not working originally because the client and server
>     were not connected?  Later in the same file deferredResult is used.
>     I'm not understanding what the expected behavior is then.

Well, it's probably because you're not running the reactor properly,
or something. I can't say more without seeing the code :)

> 7.  Is it preferred to use unittest.TestCase.assertEqual to the plain
>     assert?  I see both used in various places in the Twisted tests.

Well, when you use the self.assert* methods, trial marks the tests as
"Failures", rather than "Errors", which occur when any other exception
is raised from the test. Not a really big difference. Also, assert
statements don't get run when python -O is used.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From andrew-twisted at puzzling.org  Wed Oct  1 22:53:14 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 2 Oct 2003 12:53:14 +1000
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
In-Reply-To: <20031002024405.GK1515@radii>
References: <87zngkwf4s.fsf@lutya.travishartwell.net> <20031002024405.GK1515@radii>
Message-ID: <20031002025314.GA14211@frobozz>

On Wed, Oct 01, 2003 at 10:44:05PM -0400, Christopher Armstrong wrote:
> On Wed, Oct 01, 2003 at 08:24:35PM -0600, Travis B. Hartwell wrote:
> > 1.  Does proper testing necessitate or at least include actually
> >     communicating over a port for the client and server?  I see this
> >     is done for the PB tests and several others, but not for many.
> 
> Well, this is actually usually the easiest way to test your code;
> otherwise, you need to deal with crap like fake transports, etc. If

It's a shame that fake transports are harder to use; we should be able to do
better than that.  twisted.protocols.loopback is a good start, though...

> you do test over the network, make sure you listen on a local-only
> interface (i.e., '127.0.0.1') and use a portno of 0. e.g.:
> 
>         self.port = reactor.listenTCP(0, self.svr, interface="127.0.0.1")
>         self.portno = self.port.getHost()[-1]

This bothers me a little; the details of TCP connections are generally
irrelevant to what the test method is trying to test (and TCP, hopefully, is
getting fully tested in test_tcp).  It'd be nice if this wasn't required.

-Andrew.




From slt5v at cc.usu.edu  Wed Oct  1 23:30:19 2003
From: slt5v at cc.usu.edu (Travis B. Hartwell)
Date: Wed, 01 Oct 2003 21:30:19 -0600
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted
 Applications
In-Reply-To: <20031002024405.GK1515@radii> (Christopher Armstrong's message
 of "Wed, 01 Oct 2003 22:44:05 -0400")
References: <87zngkwf4s.fsf@lutya.travishartwell.net>
	<20031002024405.GK1515@radii>
Message-ID: <87vfr8wc38.fsf@lutya.travishartwell.net>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> On Wed, Oct 01, 2003 at 08:24:35PM -0600, Travis B. Hartwell wrote:
>> 1.  Does proper testing necessitate or at least include actually
>>     communicating over a port for the client and server?  I see this
>>     is done for the PB tests and several others, but not for many.
>
> Well, this is actually usually the easiest way to test your code;
> otherwise, you need to deal with crap like fake transports, etc. If
> you do test over the network, make sure you listen on a local-only
> interface (i.e., '127.0.0.1') and use a portno of 0. e.g.:
>
>         self.port = reactor.listenTCP(0, self.svr, interface="127.0.0.1")
>         self.portno = self.port.getHost()[-1]
>
>> 2.  Closely related, what is the proper way to connect the client and
>>     server?  When I made changes, the t.test.test_pb.IOPump that the
>>     tests were using didn't seem to work.  According to spiv, this may
>>     not be the preferred connecting method to use anymore.
>
> Well, if you do what I said above, then you just need to use regular
> connectTCP(self.portno, fac).
>

The combination of this answer and the above worked just great.
Thanks!

>> 3.  [moot question deleted]
>>
>> 4.  Regardless of the method used, what is the proper way to have the
>>     reactor keep going until there are no more events?  I need
>>     something analogous to test_pb.IOPump.pump() or flush(), if IOPump
>>     is not to be used.
>> 
>>     trial.unittest.TestCase.runReactor()?
>
> Well, you don't really need "until there are no more events" --
> usually, you just run the reactor until some state is reached, e.g.:
>
>         while not l:
>             reactor.iterate()

This worked great for some cases.  Sort of.  It doesn't quite
approximate what pump does so I'm a bit at a loss.  I have cases where
I don't know what condition to test, or what I am testing might be the
only condition.  For example:

    def testCacheObjectToClient(self): 
        myObj = SimObject(id=12345)
        self.rlm.addSimObject(myObj)
        myPresence = self.rlm.presences[1]
        myPresence.addObjectToClientSim(myObj)
        # Crank
        assert self.c.localCache[12345], 'Object not received!'

The # Crank comment is where self.pump.flush() was located before.  If
I look based on if there is something in localCache, I would keep
looping if the object was not received.  This is the very thing I am
testing, so when it should fail it would just sit there endlessly
instead of failing.  So what else could I try?

--

Thanks for the answers to the rest of my questions.  I am slowly
getting this.

Travis



From exarkun at intarweb.us  Wed Oct  1 23:38:10 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 1 Oct 2003 23:38:10 -0400
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
In-Reply-To: <20031002025314.GA14211@frobozz>
References: <87zngkwf4s.fsf@lutya.travishartwell.net> <20031002024405.GK1515@radii> <20031002025314.GA14211@frobozz>
Message-ID: <20031002033810.GA1739@intarweb.us>

On Thu, Oct 02, 2003 at 12:53:14PM +1000, Andrew Bennetts wrote:
> On Wed, Oct 01, 2003 at 10:44:05PM -0400, Christopher Armstrong wrote:
> 
> [snip]
> 
> > you do test over the network, make sure you listen on a local-only
> > interface (i.e., '127.0.0.1') and use a portno of 0. e.g.:
> > 
> >         self.port = reactor.listenTCP(0, self.svr, interface="127.0.0.1")
> >         self.portno = self.port.getHost()[-1]
> 
> This bothers me a little; the details of TCP connections are generally
> irrelevant to what the test method is trying to test (and TCP, hopefully, is
> getting fully tested in test_tcp).  It'd be nice if this wasn't required.
> 

  I agree.  Only a few of the tests you write should actually go over the
network -- note that loopback.loopback() and the rest of the fake transport
bit fall into this category!).  The bulk of your functionality should be
testable in isolation of the network code.  If it's not, consider trying to
rewrite it so it is.  This will lead to simpler, more reliable tests as well
as simpler and more modular code.

  Jp

-- 
"The problem is, of course, that not only is economics bankrupt but it has
 always been nothing more than politics in disguise ... economics is a form
 of brain damage."  -- Hazel Henderson
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031001/3e857d6a/attachment.pgp 

From glyph at twistedmatrix.com  Thu Oct  2 00:29:34 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 02 Oct 2003 00:29:34 -0400
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
In-Reply-To: <20031002033810.GA1739@intarweb.us>
References: <87zngkwf4s.fsf@lutya.travishartwell.net> <20031002024405.GK1515@radii> <20031002025314.GA14211@frobozz> <20031002033810.GA1739@intarweb.us>
Message-ID: <3F7BA9AE.6040605@twistedmatrix.com>

Jp Calderone wrote:
> Only a few of the tests you write should actually go over the
> network -- note that loopback.loopback() and the rest of the fake transport
> bit fall into this category!).  The bulk of your functionality should be
> testable in isolation of the network code.  If it's not, consider trying to
> rewrite it so it is.  This will lead to simpler, more reliable tests as well
> as simpler and more modular code.

The ideal situation in this case would be to have a briefer answer like 
"Use trial.prototest" or something.  While I appreciate the "Unit" 
aspect of unit tests (test only what you're testing) it's still good to 
actually exercise a little network code under the covers, since the OS 
can do difficult-to-replicate-and-test things in different environments.

I can't think of an easy way to do this, but there should be a 
'listenTest' utility function which can listen over TCP or SSL, or over 
a loopback connection that doesn't consume OS resources, based on a 
switch to the trial commandline.  That way we can exercise both 
interactions of the higher levels with the lower levels and the higher 
levels in effective isolation.

It occurs to me that a test reactor package would be useful for more 
than that - testReactor.run() could monitor the event loop for state 
changes - if no data is sent or received in a given iteration, then you 
know that the reactor is going to hang and you can raise a test failure 
to that effect rather than consuming CPU and hiding the traceback.

(Am I making sense here?)




From rudy.schockaert at pandora.be  Thu Oct  2 01:18:51 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Thu, 02 Oct 2003 07:18:51 +0200
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <200310012347.h91NlHW04812@haddock.cd.chalmers.se>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se>
Message-ID: <3F7BB53B.8000805@pandora.be>

Hi,

I have been struggling with SMTP also. I noticed that there is a lot 
changing in that part lately, that's why I was still patient and was 
just waiting to see some doc pop up on the new way to use SMTP.

Could someone send a small example of  how to use the news SMTP module? 
Mayby an impementation of what Greg is trying to do would be nice.

TIA,

Rudy




From itamar at itamarst.org  Thu Oct  2 01:26:09 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 2 Oct 2003 01:26:09 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <3F7BB53B.8000805@pandora.be>
References: <200310011720.17355.greg@digitalinfo.net>
	<200310012347.h91NlHW04812@haddock.cd.chalmers.se>
	<3F7BB53B.8000805@pandora.be>
Message-ID: <20031002012609.5edafcac.itamar@itamarst.org>

On Thu, 02 Oct 2003 07:18:51 +0200
Rudy Schockaert <rudy.schockaert at pandora.be> wrote:

> I have been struggling with SMTP also. I noticed that there is a lot 
> changing in that part lately, that's why I was still patient and was 
> just waiting to see some doc pop up on the new way to use SMTP.
> 
> Could someone send a small example of  how to use the news SMTP
> module? Mayby an impementation of what Greg is trying to do would be
> nice.

IIRC it was quite trivial. Make a class MyDelivery implementing
IMessageDelivery, and then

class MySMTP(smtp.ESMTP):
    delivery = MyDelivery()

factory = protocol.ServerFactory()
factory.protocol = MySMTP
reactor.listenTCP(25, factory)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From rudy.schockaert at pandora.be  Thu Oct  2 01:55:29 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Thu, 02 Oct 2003 07:55:29 +0200
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <20031002012609.5edafcac.itamar@itamarst.org>
References: <200310011720.17355.greg@digitalinfo.net>	<200310012347.h91NlHW04812@haddock.cd.chalmers.se>	<3F7BB53B.8000805@pandora.be> <20031002012609.5edafcac.itamar@itamarst.org>
Message-ID: <3F7BBDD1.4050801@pandora.be>

Itamar Shtull-Trauring wrote:

>On Thu, 02 Oct 2003 07:18:51 +0200
>Rudy Schockaert <rudy.schockaert at pandora.be> wrote:
>
>  
>
>>I have been struggling with SMTP also. I noticed that there is a lot 
>>changing in that part lately, that's why I was still patient and was 
>>just waiting to see some doc pop up on the new way to use SMTP.
>>
>>Could someone send a small example of  how to use the news SMTP
>>module? Mayby an impementation of what Greg is trying to do would be
>>nice.
>>    
>>
>
>IIRC it was quite trivial. Make a class MyDelivery implementing
>IMessageDelivery, and then
>
>class MySMTP(smtp.ESMTP):
>    delivery = MyDelivery()
>
>factory = protocol.ServerFactory()
>factory.protocol = MySMTP
>reactor.listenTCP(25, factory)
>
>  
>
Thanks,

This is trivival indeed. Now, let's see how I can change behaviour 
dependant on where the message comes from (e.g. Intranet or Internet) or 
who sent it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/f489eea9/attachment.htm 

From oisin at enginesofcreation.ie  Thu Oct  2 07:57:02 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Thu, 02 Oct 2003 12:57:02 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <87zngkwf4s.fsf@lutya.travishartwell.net>
References: <87zngkwf4s.fsf@lutya.travishartwell.net>
Message-ID: <3F7C128E.1060708@enginesofcreation.ie>

Hi,

In my current project I'm using python's ftplib to transfer
files. This is proving very slow and I need to improve this.

I looked at Twisted's protocol.ftp.FTPClient some time ago
and there seemed to be no support for uploading files. After
trawling through the comp.lang.python news group I saw
that this had changed in 1.0.4(?), so I decided to try FTPClient
again.

I've attached a modified version of the ftpclient.py example
I'm using. When I run this I login my ftp server ok, do the pwd
ok & then proceed to the storeFile and nothing seems to
happen. When I look at the ftp server I find an empty file
with the correct name however the store operation never
seems to finish.

I confess I really don't know how to handle the two deferred
object that get returned by storeFile. I just add callback/
errorback for each, this could be the problem.

Can anyone enlighten me as to what I'm doing wrong. I would
really like to use proper async behavior for doing the uploads,
instead of using threads + ftplib.


Thanks,

om


P.S. my system: osx, python 2.2.3, twisted 1.0.7.

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftpclient.py
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/eb616a9c/attachment.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: myfile.txt
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/eb616a9c/attachment-0001.txt 

From justinjohnson at fastmail.fm  Thu Oct  2 10:30:39 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 02 Oct 2003 08:30:39 -0600
Subject: [Twisted-Python] Adapter troubles - Copying Quotient's DivmodSession
Message-ID: <20031002143039.784EB3D96E@www.fastmail.fm>

Hi,

I've created a class called RatControlSession similar to DivmodSession in
Quotient.  I define IRatControlSession and RatControlSession, and I
register RatControlSession as an adapter from twisted.web.server.Session
to IRatControlSession.  However, when I try to do something like...

    prefs = webinterfaces.IRatControlSession(request.getSession())

I get the following error.  This is a cut-n-paste from what appears in
the browser.

-----
C:\svn\RatControl\ratcontrol\web\pages.py, line 14 in wmfactory_action
12  def wmfactory_action(self, request):
13    #prefs = request.getSession(webinterfaces.IRatControlSession)
14    prefs = webinterfaces.IRatControlSession(request.getSession())
15    #prefs = request.getSession()
Locals
self    
ratcontrol.web.pages.MenuPage instance @ 0xc2e760
<ratcontrol.web.pages.MenuPage instance at 0x00C2E760>
request 
twisted.web.server.Request instance @ 0xb9d1e8 <GET / HTTP/1.1>
Globals
webinterfaces   <module 'ratcontrol.web.webinterfaces' from
'C:\svn\RatControl\ratcontrol\web\webinterfaces.pyc'>
C:\Python23\Lib\site-packages\twisted\python\components.py, line 77 in
__call__
75
76    if adapter is _Nothing:
77      raise CannotAdapt("%s cannot be adapted to %s." %
78               (adaptable, self))
Locals
adaptable       
twisted.web.server.Session instance @ 0xbea710
<twisted.web.server.Session instance at 0x00BEA710>
adapter <class twisted.python.components._Nothing at 0x008EEED0>
self    <class 'ratcontrol.web.webinterfaces.IRatControlSession'>
Globals
_Nothing        <class twisted.python.components._Nothing at 0x008EEED0>
CannotAdapt     <class twisted.python.components.CannotAdapt at
0x008EEF30>

twisted.python.components.CannotAdapt: <twisted.web.server.Session
instance at 0x00BEA710> cannot be adapted to <class
'ratcontrol.web.webinterfaces.IRatControlSession'>.
-----

I'm not sure what I'm doing wrong here.  I looked through components.py
but still don't see what the problem is.

I've attached webinterfaces.py and session.py, setup similar to
quotient's respective files.  Also attached is pages.py which defines
wmfactory_action on MenuPage where I try to create an IRatControlSession
from request.getSession().

Any help you can provide is greatly appreciated.

Thanks.
-Justin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pages.py
Type: application/unknown
Size: 2722 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/18185caf/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: session.py
Type: application/unknown
Size: 2428 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/18185caf/attachment-0001.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: webinterfaces.py
Type: application/unknown
Size: 2776 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/18185caf/attachment-0002.bin 

From foom at fuhm.net  Thu Oct  2 11:36:06 2003
From: foom at fuhm.net (James Y Knight)
Date: Thu, 2 Oct 2003 11:36:06 -0400
Subject: [Twisted-Python] Woven Model extreme pain
Message-ID: <239F5AE2-F4EE-11D7-B097-000A95A50FB2@fuhm.net>

Okay, so I'm having a few issues with Models.
I have code that looks like follows (request.dbpool does in fact exist 
in my code):

class DatabaseJunk(model.Model):
	def getData(self, request):
		return request.dbpool.runQuery("""select * from stuff""")

class Page(page.Page):
	templateFile = "main.html"
	isLeaf = 1
	wmfactory_db(self, request):
		return DatabaseJunk()

and, when i request in main.html the model be rendered like:
<span view="Text" model="/db" />
it gets apparently stuck in an infinite loop. getData keeps getting 
called over and over. What am I doing wrong? If I return a Deferred 
from wmfactory_db, it works fine, but not if I return one from getData.

My first thought was, maybe I should be using the "getter=" attr to the 
initializer instead of overriding getData (and thus using a cache), but 
when I tried that,  my code was never called at all. It seems that the 
cache is set to be initially valid, so the getter is never called!

Argh!

And this is on top of my problems yesterday where I was trying to 
return a Deferred from getSubmodel which excercises a code path that 
never gets called otherwise which looks like it should handle the case 
of a Deferred being returned but apparently has never been tested. I 
was apparently supposed to override submodelFactory() instead of 
getSubmodel, despite the fact that that isn't documented anywhere.

Argh!

James




From foom at fuhm.net  Thu Oct  2 13:42:52 2003
From: foom at fuhm.net (James Y Knight)
Date: Thu, 2 Oct 2003 13:42:52 -0400
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <239F5AE2-F4EE-11D7-B097-000A95A50FB2@fuhm.net>
Message-ID: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>

More ARRRRRRRRRRGGGGGGGH.

Returning a Deferred from submodelFactory doesn't seem to work 
*either*, if you then want to get a submodel of that.
E.g simplified:
	def result1(self, d):
		d.callback((1,3,4,5))
	
	def wmfactory_foo(self, request):
		d = defer.Deferred()
		reactor.callLater(1000000, self.result1, d)
		return d

If you then ask for a model="foo/0", twisted claims there is no such 
model, immediately. so it's not even trying to deal with the deferred. 
arrrrgh.

Is none of this tested? I can't believe I'm only person who wants to do 
this?

This is really making me want to give up. It seems nice but nothing 
works!

James




From glyph at twistedmatrix.com  Thu Oct  2 14:32:12 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 02 Oct 2003 14:32:12 -0400
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <3F7C128E.1060708@enginesofcreation.ie>
References: <87zngkwf4s.fsf@lutya.travishartwell.net> <3F7C128E.1060708@enginesofcreation.ie>
Message-ID: <3F7C6F2C.2010802@twistedmatrix.com>

Oisin Mulvihill wrote:
> I confess I really don't know how to handle the two deferred
> object that get returned by storeFile. I just add callback/
> errorback for each, this could be the problem.

If you want to wait for both, use twisted.internet.defer.DeferredList.

> Can anyone enlighten me as to what I'm doing wrong. I would
> really like to use proper async behavior for doing the uploads,
> instead of using threads + ftplib.

The FTP implementation in Twisted is sub-optimal (although that's mostly 
the server).  If you don't get any satisfactory responses I recommend 
assigning a bug to spiv in the tracker :).




From b.polen at comcast.net  Thu Oct  2 17:29:16 2003
From: b.polen at comcast.net (Benjamin Polen)
Date: Thu, 2 Oct 2003 17:29:16 -0400
Subject: [Twisted-Python] Can twisted serve java applets
Message-ID: <008801c3892c$3bcdb850$6400a8c0@shark.com>

Can twisted serve java applets, including those which use swing or awt?
Thanks
Ben
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/165313ea/attachment.htm 

From b.polen at comcast.net  Thu Oct  2 18:16:47 2003
From: b.polen at comcast.net (Benjamin Polen)
Date: Thu, 2 Oct 2003 18:16:47 -0400
Subject: [Twisted-Python] Can I use twisted http server to serve java applets
Message-ID: <000201c38932$df370180$6400a8c0@shark.com>

I want to find out if it is possible to use twisted http server to serve
java applets to IE and Netscape.
Some of the applets I wish to use will contain the awt and swing java
libraries.  Is twisted http server 
of doing this?
I appreciate any helpful responses,
Ben
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/75313c5e/attachment.htm 

From bob at redivi.com  Thu Oct  2 18:39:05 2003
From: bob at redivi.com (Bob Ippolito)
Date: Thu, 2 Oct 2003 18:39:05 -0400
Subject: [Twisted-Python] Can I use twisted http server to serve java applets
In-Reply-To: <000201c38932$df370180$6400a8c0@shark.com>
Message-ID: <3ACC1B39-F529-11D7-AEF6-000A95686CD8@redivi.com>


On Thursday, Oct 2, 2003, at 18:16 America/New_York, Benjamin Polen 
wrote:

> I want to find out if it is possible to use twisted http server to 
> serve java applets to IE and Netscape.
> Some of the applets I wish to use will contain the awt and swing java 
> libraries. ?Is twisted http server
> of doing this?

I don't see any reason why not, from the web server's perspective an 
applet and whatever class libraries are just files.  Unless I'm missing 
something here?

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: text/enriched
Size: 685 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031002/71f5cb50/attachment.bin 

From syver at inout.no  Fri Oct  3 04:32:00 2003
From: syver at inout.no (Syver Enstad)
Date: 03 Oct 2003 10:32:00 +0200
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
Message-ID: <uad8iu3gf.fsf@inout.no>

James Y Knight <foom at fuhm.net> writes:

> More ARRRRRRRRRRGGGGGGGH.
> 
> Returning a Deferred from submodelFactory doesn't seem to work
> *either*, if you then want to get a submodel of that.
> E.g simplified:
> 	def result1(self, d):
> 		d.callback((1,3,4,5))
> 	
> 	def wmfactory_foo(self, request):
> 		d = defer.Deferred()
> 		reactor.callLater(1000000, self.result1, d)
> 		return d
> 
> If you then ask for a model="foo/0", twisted claims there is no such
> model, immediately. so it's not even trying to deal with the
> deferred. arrrrgh.
> 
> Is none of this tested? I can't believe I'm only person who wants to
> do this?
> 
> This is really making me want to give up. It seems nice but nothing
> works!

I've also been down this road James. You can't tunnel through
deferreds in the submodel path, and you have to specify a view for the
deferred system to work.


Examples: 

All examples are just written from memory and are completely untested.

<span model="foo/0"></span> 
won't work because tunneling through the deferred is not supported

<span model="foo">
  <span model="0" view="Text"></span>
</span>
won't work because the default view, DefaultWidget doesn't support deferreds

<span model="foo" view="Widget">
  <span model="0" view="Text"></span>
</span>

should work because the Widget handles the deferred model and
postpones processing of child nodes until the deferred result is
ready.

All views that are derived from Widget (and doesn't override the
deferred handling in generate) should work:

<span model="foo" view="Text"></span>

or:

<span model="foo" view="List">
  <span pattern="listItem"></span>
</span>





From syver at inout.no  Fri Oct  3 04:47:41 2003
From: syver at inout.no (Syver Enstad)
Date: 03 Oct 2003 10:47:41 +0200
Subject: [Twisted-Python] woven authentications and connections.
Message-ID: <u4qyqu2qa.fsf@inout.no>

I am in the process of implementing authentication for an intranet
application using woven. I will be storing the login information in
the session. On each request I will connect to the database and pass
the connection to the page handling the request. How do I know when
the request is finished so that I can close the connection?





From oisin at enginesofcreation.ie  Fri Oct  3 06:18:28 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Fri, 03 Oct 2003 11:18:28 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
Message-ID: <3F7D4CF4.2050807@enginesofcreation.ie>

Hi,

Glyph Lefkowitz wrote:

> Oisin Mulvihill wrote:
>
>> I confess I really don't know how to handle the two deferred
>> object that get returned by storeFile. I just add callback/
>> errorback for each, this could be the problem.
>
>
> If you want to wait for both, use twisted.internet.defer.DeferredList.
>
Why are there two deferred objects returned by storeFile? The documentation
says:

storeFile (self ,path ):

    Store a file at the given path.

    This method issues the 'STOR' FTP command.

    Returns:

    A tuple of two Deferreds:
        
    * Deferred IFinishableConsumer . You must call the finish method on the
        IFinishableConsumer when the file is completely transferred.

    * Deferred list of  control-connection responses.

This really doesn't help me much. I get the impression that storeFile
isn't sending the contents of file, because its waiting for me to stream
the file contents somehow. Maybe via IFinishableConsumer?

In my current program, using ftplib, I do the following to upload a file:

    :
    ftp.storbinary('STOR %s' % (filename), fp)
    :

This has the filename and a file descriptor passed to it. Is something 
like this
needed with storeFile?

Please can someone give me an answer to this, as looking at the code for
twisted.protocols.ftp isn't helping much either. This function seems to be
a mystery to me and I want to understand how to use it properly.

Thanks,

om


>> Can anyone enlighten me as to what I'm doing wrong. I would
>> really like to use proper async behavior for doing the uploads,
>> instead of using threads + ftplib.
>
>
> The FTP implementation in Twisted is sub-optimal (although that's 
> mostly the server).  If you don't get any satisfactory responses I 
> recommend assigning a bug to spiv in the tracker :).
>

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540






From greg at digitalinfo.net  Fri Oct  3 07:45:00 2003
From: greg at digitalinfo.net (Greg)
Date: Fri, 03 Oct 2003 07:45:00 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <200310012347.h91NlHW04812@haddock.cd.chalmers.se>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se>
Message-ID: <3F7D613C.5020609@digitalinfo.net>

Thanks! In order to help others like me who were struggling with this, 
here's the working code. Please let me know if I did anything 
egregiously stupid here.

#!/usr/bin/env python
# Simple SMTP server shell

from twisted.internet import reactor, protocol, defer
from twisted.protocols import smtp

class MyMessage:
    __implements__ = (smtp.IMessage)
       
    def __init__(self):
        self.msg = []

    def lineReceived(self, line):
        self.msg.append(line)

    def eomReceived(self):
        # Handle message here
        for line in self.msg:
            print line
        self.msg = []
        return defer.succeed('<Whatever>')
   
class MyMessageDelivery:
    __implements__ = (smtp.IMessageDelivery)
   
    def validateFrom(self, helo, origin):
        return origin
       
    def validateTo(self, user):
        return MyMessage
       
    def receivedHeader(self, helo, origin, recipients):
        return None

class MySMTPFactory(smtp.SMTPFactory):
    def buildProtocol(self, addr):
        p = self.protocol(MyMessageDelivery())
        p.factory = self
        p.portal = self.portal
        p.host = "somedomain.com"
        return p   
       
factory = MySMTPFactory()
factory.protocol = smtp.SMTP
reactor.listenTCP(25, factory)
reactor.run()

Anders Hammarquist wrote:

>Hi Greg!
>
>In a message of Wed, 01 Oct 2003 17:20:17 EDT, Greg writes:
>  
>
>>Working on an SMTP filter (consisting of an SMTP server that receives 
>>messages, some code that mangles them, then and SMTP client that forwards 
>>them along). The first step is to get a functioning SMTP server working, and 
>>I'm having some trouble with SMTPFactory / SMTP. I've overloaded the validate 
>>methods in an attempt accept emails to and from any domain, but I can't 
>>figure out how to hook in a class that implements IMessageDelivery:
>>    
>>
>
>There are several problems with your code, but to my eye it looks like
>confusion between several methods of using the SMTP class. Until recently,
>the IMessageDelivery method didn't exists, and you needed to override
>SMTP to implement validateTo and validateFrom. Now, you can instead pass
>an IMessageDelivery to SMTP, either directly or using the authenticator
>(and if you do, you shouldn't need to subclass SMTP - and if your twisted
>is recent enough, you have to use the IMessageDelivery method).
>
>You do need to make your own factory though, since the one that's there
>doesn't deal with IMessageDelivery()s yet. Something like
>
>class MySMTPFactory(SMTPFactory):
>	def buildProtocol(self, addr):
>		p = self.protocol(MyMessageDelivery())
>		p.factory = self
>		p.portal = self.portal
>		p.host = self.domain
>		return p
>
>  
>
>>class MySMTPProtocol(SMTP):
>>    
>>
>[...]
>  
>
>>	def validateTo(self, user):
>>		d = defer.Deferred()
>>		reactor.callLater(0, self.fakeSucceed())
>>		return d
>>    
>>
>
>You don't need this code, but I still want to point out that it doesn't
>do anything useful, and is overcomplicated. 
>
>First, validateTo may return an IMessage or a deferred returning an
>IMessage, so you don't need the deferred, you can just return you
>IMessage directly. Secondly the deferred is never called, so it will
>never return, and thus your SMTP server stops here.
>
>reactor.callLater() just calls another function asynchrously and discards
>the result. If you want to pass back a result from a callLater, you need
>to pass along the deferred and call it in the function you callLater()ed.
>
>  
>
>>class MyIMessage:
>>	__implements__ = (smtp.IMessageDelivery)
>>    
>>
>
>You seem to have mixed up IMessage and IMessageDelivery. You need both.
>Your IMessageDelivery.validateTo() should return an IMessage (or a deferred
>returning an IMessage).
>
>HTH
>/Anders
>
>  
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031003/e009dbaa/attachment.htm 

From dp at twistedmatrix.com  Fri Oct  3 12:15:07 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 3 Oct 2003 12:15:07 -0400
Subject: [Twisted-Python] Adapter troubles - Copying Quotient's DivmodSession
In-Reply-To: <20031002143039.784EB3D96E@www.fastmail.fm>
References: <20031002143039.784EB3D96E@www.fastmail.fm>
Message-ID: <C108B4E6-F5BC-11D7-87C4-000A95864FC4@twistedmatrix.com>

On Oct 2, 2003, at 10:30 AM, Justin Johnson wrote:

> Hi,
>
> I've created a class called RatControlSession similar to DivmodSession 
> in
> Quotient.  I define IRatControlSession and RatControlSession, and I
> register RatControlSession as an adapter from 
> twisted.web.server.Session
> to IRatControlSession.  However, when I try to do something like...
>
>     prefs = webinterfaces.IRatControlSession(request.getSession())
>
> I get the following error.  This is a cut-n-paste from what appears in
> the browser.

<snip exception>

> I'm not sure what I'm doing wrong here.  I looked through components.py
> but still don't see what the problem is.
>
> I've attached webinterfaces.py and session.py, setup similar to
> quotient's respective files.  Also attached is pages.py which defines
> wmfactory_action on MenuPage where I try to create an 
> IRatControlSession
> from request.getSession().

 From looking at the files, it looks like session is not getting 
imported anywhere. You would think it wouldn't be a problem since you 
are not directly using any of the objects in the module, but unless you 
import a module, the code at the top level of that module does not get 
executed. Thus the registerAdapter calls are never happening, and when 
you go to request an adapter none is registered. Try putting "import 
session" at the top of your pages file.

This is a major problem with using components and twisted -- where to 
register the adapters. Of course, the implementation of components as 
pioneered by Zope 3 uses a non-python file to register adapters (a zcml 
file, a form of XML) and twisted should have something similar 
(preferably not xml) but currently does not.

dp




From exarkun at intarweb.us  Fri Oct  3 12:43:50 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 3 Oct 2003 12:43:50 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <3F7D613C.5020609@digitalinfo.net>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se> <3F7D613C.5020609@digitalinfo.net>
Message-ID: <20031003164350.GA6738@intarweb.us>

On Fri, Oct 03, 2003 at 07:45:00AM -0400, Greg wrote:
> Thanks! In order to help others like me who were struggling with this, 
> here's the working code. Please let me know if I did anything 
> egregiously stupid here.
> 
> #!/usr/bin/env python
> # Simple SMTP server shell
> 
> from twisted.internet import reactor, protocol, defer
> from twisted.protocols import smtp
> 
> class MyMessage:
>    __implements__ = (smtp.IMessage)
>       
>    def __init__(self):
>        self.msg = []
> 
>    def lineReceived(self, line):
>        self.msg.append(line)
> 
>    def eomReceived(self):
>        # Handle message here
>        for line in self.msg:
>            print line
>        self.msg = []
>        return defer.succeed('<Whatever>')
>   
> class MyMessageDelivery:
>    __implements__ = (smtp.IMessageDelivery)
>   
>    def validateFrom(self, helo, origin):
>        return origin
>       
>    def validateTo(self, user):
>        return MyMessage

  You need to return an *instance* here.  You probably also want to
associate the user with the instance, too, since you won't be told again who
you're delivering for.  Changing MyMessage.__init__ to take a user argument
and returning "MyMessage(user)" might be a good way to go.

  The validateTo and validateFrom methods are your chance to refuse this
message.  "helo" and "origin" identify the source of the message.  "user"
identifies the destination.  If any of them are not to your liking, you
should raise smtp.SMTPBadRcpt or smtp.SMTPBadSender.

>       
>    def receivedHeader(self, helo, origin, recipients):
>        return None
> 
> class MySMTPFactory(smtp.SMTPFactory):
>    def buildProtocol(self, addr):
>        p = self.protocol(MyMessageDelivery())
>        p.factory = self
>        p.portal = self.portal
>        p.host = "somedomain.com"
>        return p   
>       
> factory = MySMTPFactory()
> factory.protocol = smtp.SMTP
> reactor.listenTCP(25, factory)
> reactor.run()
> 

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031003/7af48339/attachment.pgp 

From dp at twistedmatrix.com  Fri Oct  3 12:49:27 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 3 Oct 2003 12:49:27 -0400
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <uad8iu3gf.fsf@inout.no>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net> <uad8iu3gf.fsf@inout.no>
Message-ID: <8CE9032D-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>

On Oct 3, 2003, at 4:32 AM, Syver Enstad wrote:

> James Y Knight <foom at fuhm.net> writes:
>
>> More ARRRRRRRRRRGGGGGGGH.

<snip>

I apologize. Woven's Deferred support is only very lightly tested 
because every application I have built in Woven has not been very 
deferred-heavy, and when I have had to use Deferreds I am able to use 
them because I wrote the code.

Writing code which handles Deferreds in every conceivable situation is 
very difficult because it makes the code more verbose and less linear. 
This is mostly due to Python's lack of a block syntax, and there's not 
a lot we can do about it. Woven supports deferreds by checking for 
Deferred results from two woven APIs:

Widget.generate

Controller.handle

If a Deferred is returned from either of these functions, Woven will 
not recurse into the DOM branch which the Widget or Controller was 
handling until the Deferred has fired. Woven will continue rendering 
the rest of the page, and when it gets to the end, if there are 
outstanding Deferreds, it will not send the page to the browser until 
these Deferred tasks have completed.

When a Deferred fires, Woven will then recurse into the DOM branch 
related to the Deferred. If a DOM node below that one contains a 
directive which produces a Widget or Controller which returns a 
Deferred, the process will be repeated.

This is basically how Woven's Deferred support works.

The first thing Widget.generate does is call Model.getData. If 
Model.getData returns a Deferred, it will add a callback to it which 
continues the Widget rendering process when the Deferred has fired.

This is why the layout described below by Syver is required. There is 
no support for Deferreds in lookupSubmodel (the code which parses 
model="foo/bar")

Also, the IModel interface was designed about a year and a half ago, at 
the very beginning of DOMTemplate and WebMVC development. It turned out 
to be a fairly cumbersome API to use (one which only existed because of 
python's lack of the concept of a handle) and after Glyph wrote 
submodelFactory and MethodModel, I have mostly relied on using that.

> I've also been down this road James. You can't tunnel through
> deferreds in the submodel path, and you have to specify a view for the
> deferred system to work.
>
>
> Examples:

<snip>

All of these examples and explanations seem correct. The fact that such 
an elaborate dance is required I would consider a bug, but 
unfortunately I don't have a lot of time for core woven development 
right now.

Woven was developed over the course of a year, in my spare time, while 
I had a day job.

Now that woven is stable enough for me to use, I have slowed 
development on it because it enables me to get my paying work done, and 
a lot of the quirks in the API don't bother me because I know enough to 
avoid them.

While I believe the core ideas behind Woven are very good, a lot of the 
implementation details are more complicated than they should be (as you 
have noticed). I would very much like to do a ground-up rewrite which 
would simplify the way things work greatly while still supporting the 
best ideas from the current Woven and as much backwards-compatibility 
as is feasible.

I don't have the time to do a ground-up rewrite right now and still get 
paid to do my regular, day job.

Since woven is now good enough to develop very large, complicated web 
applications with, other people have started showing far more interest 
in it. Unfortunately, not everyone has the experience with the internal 
details of Woven to know what to try and what to avoid. Probably the 
best way to proceed in the short term is to come up with some sort of 
"Best practices" documentation which describes how best to get your 
work done with Woven while avoiding pain.

dp




From dp at twistedmatrix.com  Fri Oct  3 12:52:39 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 3 Oct 2003 12:52:39 -0400
Subject: [Twisted-Python] woven authentications and connections.
In-Reply-To: <u4qyqu2qa.fsf@inout.no>
References: <u4qyqu2qa.fsf@inout.no>
Message-ID: <FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>

On Oct 3, 2003, at 4:47 AM, Syver Enstad wrote:

>
> I am in the process of implementing authentication for an intranet
> application using woven. I will be storing the login information in
> the session. On each request I will connect to the database and pass
> the connection to the page handling the request. How do I know when
> the request is finished so that I can close the connection?

Overriding Page.pageRenderComplete should be what you want.

dp




From exarkun at intarweb.us  Fri Oct  3 12:59:23 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 3 Oct 2003 12:59:23 -0400
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <3F7D4CF4.2050807@enginesofcreation.ie>
References: <3F7D4CF4.2050807@enginesofcreation.ie>
Message-ID: <20031003165923.GB6738@intarweb.us>

On Fri, Oct 03, 2003 at 11:18:28AM +0100, Oisin Mulvihill wrote:
> Hi,
> 
> [snip]
> Why are there two deferred objects returned by storeFile? The documentation
> says:
> 
> storeFile (self ,path ):
> 
>    Store a file at the given path.
> 
>    This method issues the 'STOR' FTP command.
> 
>    Returns:
> 
>    A tuple of two Deferreds:
>        
>    * Deferred IFinishableConsumer . You must call the finish method on the
>        IFinishableConsumer when the file is completely transferred.
> 
>    * Deferred list of  control-connection responses.
> 
> This really doesn't help me much. I get the impression that storeFile
> isn't sending the contents of file, because its waiting for me to stream
> the file contents somehow. Maybe via IFinishableConsumer?

  Correct, I believe.  It looks like you can use FileSender (from t.p.basic)
if you're just sending something off disk (or from any file object, really)
here.

> 
> In my current program, using ftplib, I do the following to upload a file:
> 
>    :
>    ftp.storbinary('STOR %s' % (filename), fp)
>    :
> 
> This has the filename and a file descriptor passed to it. Is something
> like this needed with storeFile?
> 
> Please can someone give me an answer to this, as looking at the code for
> twisted.protocols.ftp isn't helping much either. This function seems to be
> a mystery to me and I want to understand how to use it properly.
> 

  Try...

    from twisted.protocols.basic import FileSender

    def sendfile(consumer, fileObj):
        s = FileSender()
        return s.beginFileTransfer(fileObj, consumer
            ).addCallback(lambda _: consumer.finish()
            )

    dC, dL = p.storeFile("path")
    dC.addCallback(sendfile, fileObj)

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031003/34d2abe8/attachment.pgp 

From greg at digitalinfo.net  Fri Oct  3 13:27:47 2003
From: greg at digitalinfo.net (Greg)
Date: Fri, 03 Oct 2003 13:27:47 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <20031003164350.GA6738@intarweb.us>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se> <3F7D613C.5020609@digitalinfo.net> <20031003164350.GA6738@intarweb.us>
Message-ID: <3F7DB193.2090605@digitalinfo.net>

Actually, I tried returning an instance (i.e. "return MyMessage()" ) 
here on my first shot at this, but I got:

File "/usr/lib/python2.2/site-packages/twisted/protocols/smtp.py", line 
672, i
n do_DATA
    self.__messages = [f() for (u, f) in recipients]
exceptions.AttributeError: MyMessage instance has no __call__ method

FYI I'm using Twisted 1.07.

Jp Calderone wrote:

>>   def validateTo(self, user):
>>       return MyMessage
>>    
>>
>
>  You need to return an *instance* here.  You probably also want to
>associate the user with the instance, too, since you won't be told again who
>you're delivering for.  Changing MyMessage.__init__ to take a user argument
>and returning "MyMessage(user)" might be a good way to go.
>
>  The validateTo and validateFrom methods are your chance to refuse this
>message.  "helo" and "origin" identify the source of the message.  "user"
>identifies the destination.  If any of them are not to your liking, you
>should raise smtp.SMTPBadRcpt or smtp.SMTPBadSender.
>  
>




From exarkun at intarweb.us  Fri Oct  3 22:04:03 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 3 Oct 2003 22:04:03 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <3F7DB193.2090605@digitalinfo.net>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se> <3F7D613C.5020609@digitalinfo.net> <20031003164350.GA6738@intarweb.us> <3F7DB193.2090605@digitalinfo.net>
Message-ID: <20031004020403.GA9642@intarweb.us>

On Fri, Oct 03, 2003 at 01:27:47PM -0400, Greg wrote:
> Actually, I tried returning an instance (i.e. "return MyMessage()" ) 
> here on my first shot at this, but I got:
> 
> File "/usr/lib/python2.2/site-packages/twisted/protocols/smtp.py", line 
> 672, i
> n do_DATA
>    self.__messages = [f() for (u, f) in recipients]
> exceptions.AttributeError: MyMessage instance has no __call__ method

  Woops, sorry.  It needs to be a *callable* that returns an instance.  So
the class is fine, if you don't need to associate the user with it,
otherwise "lambda: MyMessage(user)" is probably the way to go.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031003/f38ec3df/attachment.pgp 

From grib at billgribble.com  Fri Oct  3 08:26:56 2003
From: grib at billgribble.com (Bill Gribble)
Date: Fri, 03 Oct 2003 07:26:56 -0500
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <uad8iu3gf.fsf@inout.no>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
	 <uad8iu3gf.fsf@inout.no>
Message-ID: <1065184016.29252.15.camel@serrano>

On Fri, 2003-10-03 at 03:32, Syver Enstad wrote:
> <span model="foo" view="Widget">
>   <span model="0" view="Text"></span>
> </span>
> 
> should work because the Widget handles the deferred model and
> postpones processing of child nodes until the deferred result is
> ready.

Could you elaborate on this a little?  I want to do this too (defer
rendering in Woven) and I use Widget subclasses everywhere.   At what
point is it OK to produce a Deferred?  

The only method I override in my Widget subclasses is setUp.   In my
top-level Page subclass I have a single wvfactory_ method for a special
View I use, and a getDynamicChild to fetch children (in this case, all
the children are dynamic).

Are you suggesting that I return a Deferred instead of a View from the
wvfactory_ method?  Or that I return a Deferred from the getDynamicChild
method?  Or what? 

Thanks,
b.g.







From greg at digitalinfo.net  Sat Oct  4 15:54:42 2003
From: greg at digitalinfo.net (Greg)
Date: Sat, 4 Oct 2003 15:54:42 -0400
Subject: [Twisted-Python] shut down only half the connection?
Message-ID: <200310041554.42486.greg@digitalinfo.net>

Using internet.protocol Protocol, is it is possible to close only the writing 
half of a connection, like would be done with "shutdown(1)" using the Python 
Socket module? transport.loseConnection() seems to close down the connection 
alltogether, at which point Protocol.dataReceived() never gets called. 
Thanks. 




From itamar at itamarst.org  Sat Oct  4 16:01:16 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 4 Oct 2003 16:01:16 -0400
Subject: [Twisted-Python] shut down only half the connection?
In-Reply-To: <200310041554.42486.greg@digitalinfo.net>
References: <200310041554.42486.greg@digitalinfo.net>
Message-ID: <20031004160116.10ba556f.itamar@itamarst.org>

On Sat, 4 Oct 2003 15:54:42 -0400
Greg <greg at digitalinfo.net> wrote:

> Using internet.protocol Protocol, is it is possible to close only the
> writing half of a connection, like would be done with "shutdown(1)"
> using the Python Socket module? transport.loseConnection() seems to
> close down the connection alltogether, at which point
> Protocol.dataReceived() never gets called. Thanks. 

It is not possible at the moment. There's an issue in the bug tracker
about this, eventually it will be supported.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Sat Oct  4 19:13:48 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 4 Oct 2003 19:13:48 -0400
Subject: [Twisted-Python] shut down only half the connection?
In-Reply-To: <200310041554.42486.greg@digitalinfo.net>
References: <200310041554.42486.greg@digitalinfo.net>
Message-ID: <20031004231348.GA13683@intarweb.us>

On Sat, Oct 04, 2003 at 03:54:42PM -0400, Greg wrote:
> Using internet.protocol Protocol, is it is possible to close only the writing 
> half of a connection, like would be done with "shutdown(1)" using the Python 
> Socket module? transport.loseConnection() seems to close down the connection 
> alltogether, at which point Protocol.dataReceived() never gets called. 
> Thanks. 
> 

  Out of curiousity, what's your use case?

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031004/b30f77ab/attachment.pgp 

From greg at digitalinfo.net  Sun Oct  5 07:04:58 2003
From: greg at digitalinfo.net (Greg)
Date: Sun, 5 Oct 2003 07:04:58 -0400
Subject: [Twisted-Python] shut down only half the connection?
In-Reply-To: <20031004231348.GA13683@intarweb.us>
References: <200310041554.42486.greg@digitalinfo.net> <20031004231348.GA13683@intarweb.us>
Message-ID: <200310050704.58847.greg@digitalinfo.net>

Talking to Spamassassin's spamd. The way the client specifies that it is done 
sending a message to the daemon is by closing the connection for writing.  
(see http://www.spamassassin.org/full/2.5x/dist/spamd/README.spamd for 
protocol details).

In this case I was able to easily work around the issue by adding an "End Of 
Message" command to spamd (gotta love open source).

> On Sat, Oct 04, 2003 at 03:54:42PM -0400, Greg wrote:
> > Using internet.protocol Protocol, is it is possible to close only the
> > writing half of a connection, like would be done with "shutdown(1)" using
> > the Python Socket module? transport.loseConnection() seems to close down
> > the connection alltogether, at which point Protocol.dataReceived() never
> > gets called. Thanks.
>
>   Out of curiousity, what's your use case?
>
>   Jp




From mporter at despammed.com  Sun Oct  5 15:46:51 2003
From: mporter at despammed.com (Michael Porter)
Date: Sun, 5 Oct 2003 20:46:51 +0100
Subject: [Twisted-Python] Twisted powered network jukebox
Message-ID: <004a01c38b79$6ccbdff0$0201a8c0@dan>

Hi,

I've just uploaded the first public version of mpJuke, a network jukebox
I've been working on. If you're interested take a look at the website:

    http://www.mpweb.dsl.pipex.com/

Its written in Python using Twisted, wxPython and pySQLite. In theory it
should be cross-platform but I have only tested it on Windows 2000 so far.
It's released under the GPL.

Windows users can download the binary installer which contains a frozen
version created with Anthony Tuininga's cx_Freeze utility. This should run
without any further requirements.

Users on other platforms will need to download the source code and ensure
they have the other dependencies available. Then run "mpjukegui.py" to start
up the server or "mpjukegui.py catalogue" to start the "Catalogue Creator".

Let me know what you think.

Thanks,

Michael Porter.






From bob at redivi.com  Sun Oct  5 16:34:54 2003
From: bob at redivi.com (Bob Ippolito)
Date: Sun, 5 Oct 2003 16:34:54 -0400
Subject: [Twisted-Python] Twisted powered network jukebox
In-Reply-To: <004a01c38b79$6ccbdff0$0201a8c0@dan>
Message-ID: <606FEAB8-F773-11D7-AAA7-000A95686CD8@redivi.com>

On Sunday, Oct 5, 2003, at 15:46 America/New_York, Michael Porter wrote:

> Hi,
>
> I've just uploaded the first public version of mpJuke, a network 
> jukebox
> I've been working on. If you're interested take a look at the website:
>
>     http://www.mpweb.dsl.pipex.com/
>
> Its written in Python using Twisted, wxPython and pySQLite. In theory 
> it
> should be cross-platform but I have only tested it on Windows 2000 so 
> far.
> It's released under the GPL.
>
> Windows users can download the binary installer which contains a frozen
> version created with Anthony Tuininga's cx_Freeze utility. This should 
> run
> without any further requirements.
>
> Users on other platforms will need to download the source code and 
> ensure
> they have the other dependencies available. Then run "mpjukegui.py" to 
> start
> up the server or "mpjukegui.py catalogue" to start the "Catalogue 
> Creator".

Very cool.  I'll probably port this to OS X sometime in the near 
future.  Also, I have some almost-complete code lying dormant that does 
iTunes music sharing (server and client) that might be useful for this 
project.

-bob




From syver at inout.no  Mon Oct  6 04:07:25 2003
From: syver at inout.no (Syver Enstad)
Date: 06 Oct 2003 10:07:25 +0200
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <1065184016.29252.15.camel@serrano>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
	<uad8iu3gf.fsf@inout.no> <1065184016.29252.15.camel@serrano>
Message-ID: <u7k3in60y.fsf@inout.no>

Bill Gribble <grib at billgribble.com> writes:

> On Fri, 2003-10-03 at 03:32, Syver Enstad wrote:
> > <span model="foo" view="Widget">
> >   <span model="0" view="Text"></span>
> > </span>
> > 
> > should work because the Widget handles the deferred model and
> > postpones processing of child nodes until the deferred result is
> > ready.
> 
> Could you elaborate on this a little?  I want to do this too (defer
> rendering in Woven) and I use Widget subclasses everywhere.   At what
> point is it OK to produce a Deferred?  

As the return value from a wmfactory_method and as Donovan mentions
that implies also as the return value from getData but I haven't done
that explicitly.

Example:

...MyPage...
def wmfactory_myList(self, request):
    deferred = defer.Deferred()
    reactor.callLater(2, deferred.callback, [1, 2, 3])
    return deferred

<span model="myList" view="Widget">
  <span model="0" view="Text"></span>
  <span model="1" view="Text"></span>
  <span model="2" view="Text"></span>
</span>

Or with a List widget

<span model="myList" view="List">
  <span pattern="listItem" view="Text"></span>
</span>



> The only method I override in my Widget subclasses is setUp.   In my
> top-level Page subclass I have a single wvfactory_ method for a special
> View I use, and a getDynamicChild to fetch children (in this case, all
> the children are dynamic).

Then I think you will be home free, because you don't override
generate.

> Are you suggesting that I return a Deferred instead of a View from the
> wvfactory_ method?  Or that I return a Deferred from the getDynamicChild
> method?  Or what? 

None of the above, what I tried to explain was that Widget.generate
handles deferred models. I don't think there is any support for
deferred page's or views, just models. This means that if you need
deferreds you have to use a model for that. This makes sense because
you should not put data in your view classes, because then they are
not views anymore.




From syver at inout.no  Mon Oct  6 04:17:36 2003
From: syver at inout.no (Syver Enstad)
Date: 06 Oct 2003 10:17:36 +0200
Subject: [Twisted-Python] woven authentications and connections.
In-Reply-To: <FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>
References: <u4qyqu2qa.fsf@inout.no>
	<FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>
Message-ID: <u3ce6n5jz.fsf@inout.no>

Donovan Preston <dp at twistedmatrix.com> writes:

> On Oct 3, 2003, at 4:47 AM, Syver Enstad wrote:
> 
> >
> > I am in the process of implementing authentication for an intranet
> > application using woven. I will be storing the login information in
> > the session. On each request I will connect to the database and pass
> > the connection to the page handling the request. How do I know when
> > the request is finished so that I can close the connection?
> 
> Overriding Page.pageRenderComplete should be what you want.

Thanks, I found another way by calling request.notifyFinished which
returns a deferred, I then add a callback to that deferred and it
seems to work fine. *The following is not a rethorical question, I am
just curious.* In what way is overriding Controller.pageRenderComplete
superior to my solution?




From golux at comcast.net  Mon Oct  6 04:27:29 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Mon, 06 Oct 2003 04:27:29 -0400
Subject: [Twisted-Python] Still "totally, totally broken" ?
Message-ID: <3F812771.6070703@comcast.net>

Just curious -- this is line 436 et seq. in the CVS version of
t.i.defer.gatherResults ...

     if fireOnOneErrback:
         raise "This function was previously totally, totally broken.  Please fix your code to 
behave as documented."

Anyone know if this is still the case?

- Steve.




From rudy.schockaert at pandora.be  Mon Oct  6 07:03:38 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Mon, 06 Oct 2003 13:03:38 +0200
Subject: [Twisted-Python] Twisted.Names question
Message-ID: <3F814C0A.8090704@pandora.be>

How can I return a referral to another server when I cannot resolve the 
query myself?

My setup would be as follows:
I have a Twisted Names master server and a  number of Twisted Names 
slave servers.
The master server is only to be used by the DNS clients when the slave 
server is not available.
The Twisted Names servers can only answer very specific queries. All 
other responses have to come from the Internet.

My idea is to configure the clients as follows:

Primary DNS server: Twisted Names Slave
Secondary DNS server: Twisted Names Master
Tertiary DNS server: Internet DNS server

I have to configure the Twisted Names Master as secondary for 
resilience, but the client should only call him when the the Twisted 
Names Slave doesn't respond and not when it doesn't have the answer.

Rudy






From grib at billgribble.com  Mon Oct  6 09:06:43 2003
From: grib at billgribble.com (Bill Gribble)
Date: Mon, 06 Oct 2003 08:06:43 -0500
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <u7k3in60y.fsf@inout.no>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
	 <uad8iu3gf.fsf@inout.no> <1065184016.29252.15.camel@serrano>
	 <u7k3in60y.fsf@inout.no>
Message-ID: <1065445603.20880.7.camel@serrano>

On Mon, 2003-10-06 at 03:07, Syver Enstad wrote:
> As the return value from a wmfactory_method and as Donovan mentions
> that implies also as the return value from getData but I haven't done
> that explicitly.

Thanks.  It's actually in the Woven HOWTO that you can return a Deferred
from a model getData, and that's what I ended up doing.  It works great.

b.g.
 




From syver at inout.no  Mon Oct  6 09:43:10 2003
From: syver at inout.no (Syver Enstad)
Date: 06 Oct 2003 15:43:10 +0200
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
Message-ID: <ud6dalbwx.fsf@inout.no>

As I was saying on the list I am making a login system with woven, and
the way to autheticate the user is by doing a pb call. 

So I thought one way to do it would be to:

Have a root page that displays a login form, on postback make a
pb.IdentityConnector and call requestService to obtain a reference or
onErrback report back to the user that the login attempt failed.

I have tried two approaches...

Put the login in the wchild or
getDynamicChild methods on the login page:

This seems okay because it is easy to redirect to the login page if
the login fails, but it seems to have no support for deferreds and I
don't know if the user is correctly logged in or not until I get a
callback on the deferred returned from pb.

Put the login on the only place I know that accepts deferreds, in the
a wmfactory_ method on the login page:

I get the deferred result okay but I don't know how to do a redirect
from there.

Should I use a plain Resource rather than a woven page for this kind
of problem?





From radix at twistedmatrix.com  Mon Oct  6 09:55:53 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 6 Oct 2003 09:55:53 -0400
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <ud6dalbwx.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no>
Message-ID: <20031006135553.GA1103@radii>

On Mon, Oct 06, 2003 at 03:43:10PM +0200, Syver Enstad wrote:
> As I was saying on the list I am making a login system with woven, and
> the way to autheticate the user is by doing a pb call. 

Sounds like you need to be using twisted.web.woven.guard, and use it
with a CredentialsChecker (that you write) that does the PB
communication. You can see how to do this by reading
twisted/cred/checkers.py, it is simple.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From grib at billgribble.com  Mon Oct  6 10:02:11 2003
From: grib at billgribble.com (Bill Gribble)
Date: Mon, 06 Oct 2003 09:02:11 -0500
Subject: [Twisted-Python] Woven subpage handling redirect deferred,
	Help!?!
In-Reply-To: <ud6dalbwx.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no>
Message-ID: <1065448930.20878.15.camel@serrano>

On Mon, 2003-10-06 at 08:43, Syver Enstad wrote:
> Should I use a plain Resource rather than a woven page for this kind
> of problem?

I'm not using PB for auth (homebrew using the app's SQL db) but I think
the general approach could be the same. 

I have a separate Resource that is the top-level entry point of the
app.  Its getChild method checks that the proper credentials are
associated with the Session and if not redirects to the login page.  The
handlers on the login page are responsible for setting up the
credentials in the Session. 

This works well for me.  The "gatekeeper" Resource is like 20 lines of
code and keeps the page logic from having to know about the
authentication scheme. 

b.g.





From itamar at itamarst.org  Mon Oct  6 10:37:33 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 10:37:33 -0400
Subject: [Twisted-Python] Woven subpage handling redirect deferred,
 Help!?!
In-Reply-To: <ud6dalbwx.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no>
Message-ID: <20031006103733.1603e90d.itamar@itamarst.org>

On 06 Oct 2003 15:43:10 +0200
Syver Enstad <syver at inout.no> wrote:

> Have a root page that displays a login form, on postback make a
> pb.IdentityConnector and call requestService to obtain a reference or
> onErrback report back to the user that the login attempt failed.

Note that identities are deprecated. PB now uses the
checker/credential/portal cred system. Hopefully docs will be in next
release.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Mon Oct  6 10:38:54 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 10:38:54 -0400
Subject: [Twisted-Python] Still "totally, totally broken" ?
In-Reply-To: <3F812771.6070703@comcast.net>
References: <3F812771.6070703@comcast.net>
Message-ID: <20031006103854.1d97cccd.itamar@itamarst.org>

On Mon, 06 Oct 2003 04:27:29 -0400
"Stephen C. Waterbury" <golux at comcast.net> wrote:

> Just curious -- this is line 436 et seq. in the CVS version of
> t.i.defer.gatherResults ...
> 
>      if fireOnOneErrback:
>          raise "This function was previously totally, totally broken. 
>          Please fix your code to 
> behave as documented."

That should probably say "don't use fireOnOneErrback with
gatherResults".

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From dp at twistedmatrix.com  Mon Oct  6 10:36:32 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 6 Oct 2003 10:36:32 -0400
Subject: [Twisted-Python] woven authentications and connections.
In-Reply-To: <u3ce6n5jz.fsf@inout.no>
References: <u4qyqu2qa.fsf@inout.no> <FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com> <u3ce6n5jz.fsf@inout.no>
Message-ID: <7AEE77A0-F80A-11D7-AA48-000A95864FC4@twistedmatrix.com>

On Oct 6, 2003, at 4:17 AM, Syver Enstad wrote:

> Donovan Preston <dp at twistedmatrix.com> writes:
>
>> On Oct 3, 2003, at 4:47 AM, Syver Enstad wrote:
>>
>>>
>>> I am in the process of implementing authentication for an intranet
>>> application using woven. I will be storing the login information in
>>> the session. On each request I will connect to the database and pass
>>> the connection to the page handling the request. How do I know when
>>> the request is finished so that I can close the connection?
>>
>> Overriding Page.pageRenderComplete should be what you want.
>
> Thanks, I found another way by calling request.notifyFinished which
> returns a deferred, I then add a callback to that deferred and it
> seems to work fine. *The following is not a rethorical question, I am
> just curious.* In what way is overriding Controller.pageRenderComplete
> superior to my solution?

It's not. Your solution is superior. :-) Thanks for pointing it out.

dp




From mporter at despammed.com  Mon Oct  6 15:44:02 2003
From: mporter at despammed.com (Michael Porter)
Date: Mon, 6 Oct 2003 20:44:02 +0100
Subject: [Twisted-Python] Twisted powered network jukebox
References: <606FEAB8-F773-11D7-AAA7-000A95686CD8@redivi.com>
Message-ID: <003101c38c42$32335160$0201a8c0@dan>

----- Original Message -----
From: "Bob Ippolito" <bob at redivi.com>
To: <twisted-python at twistedmatrix.com>
Sent: Sunday, October 05, 2003 9:34 PM
Subject: Re: [Twisted-Python] Twisted powered network jukebox


>
> On Sunday, Oct 5, 2003, at 15:46 America/New_York, Michael Porter wrote:
>
> > Hi,
> >
> > I've just uploaded the first public version of mpJuke, a network
> > jukebox
> > I've been working on. If you're interested take a look at the website:
> >
> >     http://www.mpweb.dsl.pipex.com/
> >
> > Its written in Python using Twisted, wxPython and pySQLite. In theory
> > it
> > should be cross-platform but I have only tested it on Windows 2000 so
> > far.
> > It's released under the GPL.
> >
> > Windows users can download the binary installer which contains a frozen
> > version created with Anthony Tuininga's cx_Freeze utility. This should
> > run
> > without any further requirements.
> >
> > Users on other platforms will need to download the source code and
> > ensure
> > they have the other dependencies available. Then run "mpjukegui.py" to
> > start
> > up the server or "mpjukegui.py catalogue" to start the "Catalogue
> > Creator".
>
> Very cool.  I'll probably port this to OS X sometime in the near
> future.  Also, I have some almost-complete code lying dormant that does
> iTunes music sharing (server and client) that might be useful for this
> project.
>
> -bob
>

Glad you like it. OS X version would be good and I guess should be
relatively easy to port assuming the packages it requires are available.

Mike.




From smurf at smurf.noris.de  Mon Oct  6 16:11:42 2003
From: smurf at smurf.noris.de (Matthias Urlichs)
Date: Mon, 06 Oct 2003 22:11:42 +0200
Subject: [Twisted-Python] callFromThread with return
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no> <20030918102904.GA13575@frobozz>
Message-ID: <pan.2003.10.06.20.11.41.343421@smurf.noris.de>

Hi, Andrew Bennetts wrote:

>          But how does the                          .
>      Main Thread pass a result                     .
>        to Worker Thread and                        .
>        resume its execution?                       ?

Just put it in a Queue and wait on it in the thread. Standard Python.

-- 
Matthias Urlichs   |   {M:U} IT Design @ m-u-it.de   |  smurf at smurf.noris.de
Disclaimer: The quote was selected randomly. Really. | http://smurf.noris.de
 - -
The Second Commandment of Frisbee: The higher the quality of a catch or the
comment it receives, the greater the probability of a crummy throw. (Good
catch = bad throw.)
					-- Dan Roddick




From bob at redivi.com  Mon Oct  6 16:15:15 2003
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 6 Oct 2003 16:15:15 -0400
Subject: [Twisted-Python] Twisted powered network jukebox
In-Reply-To: <003101c38c42$32335160$0201a8c0@dan>
Message-ID: <CC6F75D6-F839-11D7-AAA7-000A95686CD8@redivi.com>

On Monday, Oct 6, 2003, at 15:44 America/New_York, Michael Porter wrote:

> ----- Original Message -----
> From: "Bob Ippolito" <bob at redivi.com>
> To: <twisted-python at twistedmatrix.com>
> Sent: Sunday, October 05, 2003 9:34 PM
> Subject: Re: [Twisted-Python] Twisted powered network jukebox
>
>> On Sunday, Oct 5, 2003, at 15:46 America/New_York, Michael Porter 
>> wrote:
>>
>>> I've just uploaded the first public version of mpJuke, a network
>>> jukebox
>>> I've been working on. If you're interested take a look at the 
>>> website:
>>>
>>>     http://www.mpweb.dsl.pipex.com/
>>
>> Very cool.  I'll probably port this to OS X sometime in the near
>> future.  Also, I have some almost-complete code lying dormant that 
>> does
>> iTunes music sharing (server and client) that might be useful for this
>> project.
>
> Glad you like it. OS X version would be good and I guess should be
> relatively easy to port assuming the packages it requires are 
> available.

The packages are all available.  I'd probably end up wanting to rewrite 
the GUI in PyObjC/Cocoa because wxPython is slow and a bit buggy, and 
more likely than not I'd also want to factor out the ResourcePackage 
thing and use the native OS X way of doing it (bundles with localizable 
resources) instead.. ResourcePackage is probably only used in the GUI 
layer anyways, right?

-bob




From ted at powersdk.com  Mon Oct  6 15:20:59 2003
From: ted at powersdk.com (Ted Patrick)
Date: Mon, 6 Oct 2003 15:20:59 -0400
Subject: [Twisted-Python] Web server persistance
Message-ID: <000601c38c3e$fa5ee590$6401a8c0@ISLAND>

I have a project using Twisted as an http server. 

What is the best way to persistent server data across server start/stop? 

Example:
While the server is running, a user will add virtual directories via a .rpy
application as follows:

root.putChild(name, path)

Ideally modifications to the server configuration would persist across
server start/stop. I would also like a generic format to store data related
to a particular leaf of an application as follows:

//url  http://mytwisted/dog/cat/document.txt
//data pertaining to this url could be added at
root.dog.cat.document.txt = 33

This data would also be persistent.

Thanks in advance.

Theodore E. Patrick
PowerSDK - Code for a distributed world
http://www.powersdk.com
 




From anders at bruun-olsen.net  Mon Oct  6 17:04:22 2003
From: anders at bruun-olsen.net (Anders Bruun Olsen)
Date: Mon, 6 Oct 2003 23:04:22 +0200
Subject: [Twisted-Python] SSH client bad packet length
Message-ID: <20031006210433.GB28465@elmer.skumleren.net>

Hi,

I am trying to learn a bit of Twisted in order to make an app that will
use SSH for running commands on remote hosts. I have followed the SSH
howto on the homepage where I have changed it to accept any fingerprint
and have put my own private and public keys in instead of the ones from
the example and have it connecting to a server of mine that accepts
passwordless key-auth. Lastly I have enabled logging to stdout (it might
be an idea to add to the howto which module to import to get the log
object!).

When it connects this is the output I get:

drzero at ernest pyssh-stuff $ ./sshsimpleclient.py
2003/10/06 22:31 CEST [-] Log opened.
2003/10/06 22:31 CEST [-] Starting factory <twisted.internet.protocol.ClientFactory instance at 0x8323b0c>
2003/10/06 22:31 CEST [ClientTransport,client] kex alg, key alg: diffie-hellman-group-exchange-sha1 ssh-rsa
2003/10/06 22:31 CEST [ClientTransport,client] client->server: aes256-ctr hmac-sha1 none
2003/10/06 22:31 CEST [ClientTransport,client] server->client: aes256-ctr hmac-sha1 none
2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
        reason: bad packet length 415956278
2003/10/06 22:31 CEST [ClientTransport,client] connection lost
2003/10/06 22:31 CEST [ClientTransport,client] Stopping factory <twisted.internet.protocol.ClientFactory instance at 0x8323b0c>
2003/10/06 22:32 CEST [-] Main loop terminated.


Note that the packet length changes..

Is it a problem in my code (which is basically the howto code) or a
problem with my server (Gentoo w/ OpenSSH 3.7.1p2) or something else?

-- 
Anders
-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GCS/O d--@ s:+ a-- C++ UL+++$ P++ L+++ E- W+ N(+) o K? w O-- M- V
PS+ PE@ Y+ PGP+ t 5 X R+ tv+ b++ DI+++ D+ G e- h !r y?
------END GEEK CODE BLOCK------
PGPKey: http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x8BFECB41



From z3p at twistedmatrix.com  Mon Oct  6 17:13:40 2003
From: z3p at twistedmatrix.com (Paul Swartz)
Date: 06 Oct 2003 17:13:40 -0400
Subject: [Twisted-Python] SSH client bad packet length
In-Reply-To: <20031006210433.GB28465@elmer.skumleren.net>
References: <20031006210433.GB28465@elmer.skumleren.net>
Message-ID: <1065474821.770.4.camel@petra>

On Mon, 2003-10-06 at 17:04, Anders Bruun Olsen wrote:
> Hi,
> 
> I am trying to learn a bit of Twisted in order to make an app that will
> use SSH for running commands on remote hosts. I have followed the SSH
> howto on the homepage where I have changed it to accept any fingerprint
> and have put my own private and public keys in instead of the ones from
> the example and have it connecting to a server of mine that accepts
> passwordless key-auth. Lastly I have enabled logging to stdout (it might
> be an idea to add to the howto which module to import to get the log
> object!).
> 
> When it connects this is the output I get:
> 
> drzero at ernest pyssh-stuff $ ./sshsimpleclient.py
> 2003/10/06 22:31 CEST [-] Log opened.
> 2003/10/06 22:31 CEST [-] Starting factory <twisted.internet.protocol.ClientFactory instance at 0x8323b0c>
> 2003/10/06 22:31 CEST [ClientTransport,client] kex alg, key alg: diffie-hellman-group-exchange-sha1 ssh-rsa
> 2003/10/06 22:31 CEST [ClientTransport,client] client->server: aes256-ctr hmac-sha1 none
> 2003/10/06 22:31 CEST [ClientTransport,client] server->client: aes256-ctr hmac-sha1 none
> 2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
>         reason: bad packet length 415956278
> 2003/10/06 22:31 CEST [ClientTransport,client] connection lost
> 2003/10/06 22:31 CEST [ClientTransport,client] Stopping factory <twisted.internet.protocol.ClientFactory instance at 0x8323b0c>
> 2003/10/06 22:32 CEST [-] Main loop terminated.

What that error means is that there was an error with one of the
packets.  Whether it's an error w/ your code or not I can't tell w/out
seeing the code.

-p
-- 
      Paul Swartz
(o_   z3p at twistedmatrix dot com
//\   http://www.twistedmatrix.com/users/z3p.twistd/
V_/_  AIM: Z3Penguin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031006/9b23a3cd/attachment.pgp 

From anders at bruun-olsen.net  Mon Oct  6 17:23:13 2003
From: anders at bruun-olsen.net (Anders Bruun Olsen)
Date: Mon, 6 Oct 2003 23:23:13 +0200
Subject: [Twisted-Python] SSH client bad packet length
In-Reply-To: <1065474821.770.4.camel@petra>
References: <20031006210433.GB28465@elmer.skumleren.net> <1065474821.770.4.camel@petra>
Message-ID: <20031006212313.GC28465@elmer.skumleren.net>

On Mon, Oct 06, 2003 at 05:13:40PM -0400, Paul Swartz wrote:
> > 2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
> >         reason: bad packet length 415956278
> What that error means is that there was an error with one of the
> packets.  Whether it's an error w/ your code or not I can't tell w/out
> seeing the code.

#!/usr/bin/env python

from twisted.conch import error
from twisted.conch.ssh import transport
from twisted.internet import defer

class ClientTransport(transport.SSHClientTransport):

        def verifyHostKey(self, pubKey, fingerprint):
                return defer.succeed(1)

        def connectionSecure(self):
                self.requestService(ClientUserAuth('user',ClientConnection()))


from twisted.conch.ssh import keys, userauth

publicKey = 'ssh-dss
AAAAB3NzaC1kc3MAAAEBAPUkX9Opu89vLxyMxkssKeGUmfabGRrmiuLplkN34HcScnjf/7H/QDshdcRx4+f8GhJo4yH8DAE0/zVAWZK9aMI5LpjSpr9gR2Vyq5df7vnldJljxlGMnT5W79bloP69Fo3Hjf44dTNATxfFMmwHCwMxj1oDkEn78ANyDa5xjoszT54ucm0bPExiPDQ6sz84FEDdKIrrwi8w+rEN5ReBrUPAq9zXHZjt3AOqiaDXbZsRzh6x+XhX7Wg3EkOUfTEhZ1u6baBH0DLg7jiSnURPUwyYoW5qEB0CypjAhl+EaaASvmGcXAl1JSifp0CQ8MedvCb46dGn10McrDVJvFhRxo0AAAAVAOhkyFrn2qzxUk9XmJVc75DKd9Q/AAABACeR0+IjK7SOmBeNzqnLrp5FY1MhO8KwfLpZaHbQPwo6tPR3DBRCBH3oyhxFGpLxWvHsP2LoxmJbqTaTq4T+svuIjICXtlDVOSLd0o6U4A3aDXsoN2gv04RKEkmxrocnY6dYZisHeavP5S10Ediung23ZxOzsBdPEtRDthxOya4QXlqtjIEqAk702qmZGEYCgSRPOQ5Pwm0S7kD8yOn0XQUEY/WjlbZPiM9QUXlroltLnnSeECvFLePsyEVTrvdr8Bne9NxcMW+YZBroKtLOzgH6PLKn4lB8IGOlg+U1qOlkzjDaAMeNL2Hs8vwYVXIcmm3j5JQ5ZYtx2aRHkIUTY3kAAAEBAJxRVoGskwVDnzukLKRxjuFBSpyNr/Iwp0tPvQIyASPsLh5alHRe/2AMTojKdVJkmCjPCEdL4rlzugLkcv6OPzevH5tCtvyU1X2531h51MtIs8jFF7dGPosdt0+hD1O3fA0bXBO4REw0GcMuo/wV9Flx/FZYIkgvqVGalfH5evU0Hj8wQlZaMrW+HcMUrdLBezdMob4qFTK0TQQ8R0KWwYT++ULOGahzY3HwR8GVYYMMGUtRZY96vYkMpLJkSpHobBh2biVb2DuccPqIzCkJWaVdfl8zj5pi07mojvhLXzfWTkZv+nCzZ6DPoW+dMXqg5OE6e8l00gDefFAi8cj5aKc=
drzero at ernest.local'

privateKey = """-----BEGIN DSA PRIVATE KEY-----
Key was censored for privacy reasons
-----END DSA PRIVATE KEY-----"""

class ClientUserAuth(userauth.SSHUserAuthClient):

        def getPassword(self, prompt = None):
                return 
                # this says we won't do password authentication

        def getPublicKey(self):
                return keys.getPublicKeyString(data = publicKey)

        def getPrivateKey(self):
                return defer.succeed(keys.getPrivateKeyObject(data = privateKey))


from twisted.conch.ssh import connection

class ClientConnection(connection.SSHConnection):

        def serviceStarted(self):
                self.openChannel(CatChannel(conn = self))


from twisted.conch.ssh import channel, common

class CatChannel(channel.SSHChannel):

        name = 'session'

        def channelOpen(self, data):
                d = self.conn.sendRequest(self, 'exec', common.NS('cat'), wantReply = 1)
                d.addCallback(self._cbSendRequest)
                self.catData = ''

        def _cbSendRequest(self, ignored):
                self.write('This data will be echoed back to us by "cat."\r\n')
                self.conn.sendEOF(self)
                self.loseConnection()

        def dataReceived(self, data):
                self.catData += data

        def closed(self):
                print 'We got this from "cat":', self.catData
                reactor.stop()


from twisted.internet import protocol, reactor
from twisted.python import log
import sys

def main():
        log.startLogging(sys.stdout, setStdout=0)
        factory = protocol.ClientFactory()
        factory.protocol = ClientTransport
        reactor.connectTCP('eduardo.local', 22, factory)
        reactor.run()

if __name__ == "__main__":
        main()


-- 
Anders
-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GCS/O d--@ s:+ a-- C++ UL+++$ P++ L+++ E- W+ N(+) o K? w O-- M- V
PS+ PE@ Y+ PGP+ t 5 X R+ tv+ b++ DI+++ D+ G e- h !r y?
------END GEEK CODE BLOCK------
PGPKey: http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x8BFECB41



From z3p at twistedmatrix.com  Mon Oct  6 18:56:46 2003
From: z3p at twistedmatrix.com (Paul Swartz)
Date: 06 Oct 2003 18:56:46 -0400
Subject: [Twisted-Python] SSH client bad packet length
In-Reply-To: <20031006212313.GC28465@elmer.skumleren.net>
References: <20031006210433.GB28465@elmer.skumleren.net>
	<1065474821.770.4.camel@petra>  <20031006212313.GC28465@elmer.skumleren.net>
Message-ID: <1065481007.787.0.camel@petra>

On Mon, 2003-10-06 at 17:23, Anders Bruun Olsen wrote:
> On Mon, Oct 06, 2003 at 05:13:40PM -0400, Paul Swartz wrote:
> > > 2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
> > >         reason: bad packet length 415956278
> > What that error means is that there was an error with one of the
> > packets.  Whether it's an error w/ your code or not I can't tell w/out
> > seeing the code.
> 
> code clipped

can you file a bugtracker request for this?  it seems the problem is
that Conch and OpenSSH handle *-ctr encryption modes differently.

-p
-- 
      Paul Swartz
(o_   z3p at twistedmatrix dot com
//\   http://www.twistedmatrix.com/users/z3p.twistd/
V_/_  AIM: Z3Penguin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031006/9cad1f6b/attachment.pgp 

From rdrb at 123.cl  Mon Oct  6 19:29:55 2003
From: rdrb at 123.cl (=?iso-8859-1?Q?Rita_D=EDaz_y/o_Rodrigo_Benenson?=)
Date: Mon, 06 Oct 2003 19:29:55 -0400
Subject: [Twisted-Python] Woven unicode
References: <20031006212402.12482.43539.Mailman@pyramid.twistedmatrix.com>
Message-ID: <003001c38c61$c46dc370$4b30fea9@laboratorio>

Hi!

I'm working on the final phases of a Open Source software for collaborative
text edition in real time (LeoN) (alpha or beta release will be anounced in
this list too). The code is develloped using python + twisted (PB and
Woven).

One of the features is that the actual contents of the text nodes can be
seen via web.
My problem is that I cannot show accent in woven. I have tryed different
things but non seems to work.

Please help !

Actually I have a simple data model interface that has a method that return
some text

 def wmfactory_text(self, request):
    return self.original.get_text()

So for test purpose I had changed the method by

 def wmfactory_text(self, request):
    return u"el?"

What I have to do to get the string looking good on the web browser?

I have tryed using a meta tag to indicate iso-8859-1 coding and replaced
u"el?" by u"el?".encode("iso-8859-1"); but that does not work too.

I have a presentation in two days more and this is the only ugly point.

Thanks in advance.

RodrigoB.





From bob at redivi.com  Mon Oct  6 19:42:42 2003
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 6 Oct 2003 19:42:42 -0400
Subject: [Twisted-Python] Woven unicode
In-Reply-To: <003001c38c61$c46dc370$4b30fea9@laboratorio>
Message-ID: <C790D5E0-F856-11D7-AAA7-000A95686CD8@redivi.com>

On Monday, Oct 6, 2003, at 19:29 America/New_York, Rita D?az y/o 
Rodrigo Benenson wrote:

>  def wmfactory_text(self, request):
>     return u"el?"
>
> What I have to do to get the string looking good on the web browser?
>
> I have tryed using a meta tag to indicate iso-8859-1 coding and 
> replaced
> u"el?" by u"el?".encode("iso-8859-1"); but that does not work too.

u"el?".encode('ascii', 'xmlcharrefreplace')

It's not the most elegant solution in the world, but it should work.

-bob



From itamar at itamarst.org  Mon Oct  6 20:07:42 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 20:07:42 -0400
Subject: [Twisted-Python] Woven unicode
In-Reply-To: <003001c38c61$c46dc370$4b30fea9@laboratorio>
References: <20031006212402.12482.43539.Mailman@pyramid.twistedmatrix.com>
	<003001c38c61$c46dc370$4b30fea9@laboratorio>
Message-ID: <20031006200742.369707f4.itamar@itamarst.org>

On Mon, 06 Oct 2003 19:29:55 -0400
Rita D?az y/o Rodrigo Benenson <rdrb at 123.cl> wrote:

>  def wmfactory_text(self, request):
>     return u"el?"

(This is not legal Python unless you're using 2.3 and have specifically
said your source code is iso-8859-1. It can break on other people's
computers if they have other default encodings than yours. \u escapes
will always work, of course. Not related to your problem though.)

Make sure you specify the encoding in your HTML document! I'm pretty
sure that microdom (and thus woven) are semi-hardcoded to UTF8, so try
saying that in your html page, and just returning unicode.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From alexander.winston at comcast.net  Mon Oct  6 21:17:09 2003
From: alexander.winston at comcast.net (Alexander Winston)
Date: Mon, 06 Oct 2003 21:17:09 -0400
Subject: [Twisted-Python] Woven unicode
In-Reply-To: <20031006200742.369707f4.itamar@itamarst.org>
References: <20031006212402.12482.43539.Mailman@pyramid.twistedmatrix.com>
	 <003001c38c61$c46dc370$4b30fea9@laboratorio>
	 <20031006200742.369707f4.itamar@itamarst.org>
Message-ID: <1065489428.25647.4.camel@drop>

On Mon, 2003-10-06 at 20:07, Itamar Shtull-Trauring wrote:
> On Mon, 06 Oct 2003 19:29:55 -0400
> Rita D?az y/o Rodrigo Benenson <rdrb at 123.cl> wrote:
> 
> >  def wmfactory_text(self, request):
> >     return u"el?"
> 
> (This is not legal Python unless you're using 2.3 and have specifically
> said your source code is iso-8859-1. It can break on other people's
> computers if they have other default encodings than yours. \u escapes
> will always work, of course. Not related to your problem though.)
> 
> Make sure you specify the encoding in your HTML document! I'm pretty
> sure that microdom (and thus woven) are semi-hardcoded to UTF8, so try
> saying that in your html page, and just returning unicode.

Part of the problem is that the XML declaration that Woven (possibly
Microdom?) spits out does not include the encoding.




From andrew-twisted at puzzling.org  Mon Oct  6 22:23:18 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 7 Oct 2003 12:23:18 +1000
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <pan.2003.10.06.20.11.41.343421@smurf.noris.de>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no> <20030918102904.GA13575@frobozz> <pan.2003.10.06.20.11.41.343421@smurf.noris.de>
Message-ID: <20031007022318.GC4818@frobozz>

On Mon, Oct 06, 2003 at 10:11:42PM +0200, Matthias Urlichs wrote:
> Hi, Andrew Bennetts wrote:
> 
> >          But how does the                          .
> >      Main Thread pass a result                     .
> >        to Worker Thread and                        .
> >        resume its execution?                       ?
> 
> Just put it in a Queue and wait on it in the thread. Standard Python.

It seems cleaner to me for a worker thread to say:
    result = blockingCallFromThread(func, arg1, arg2, ...)

Than:
    q = Queue.Queue()
    reactor.callFromThread(func, q, arg1, arg2)
    result = q.get()

Especially seeing as the latter requires cluttering 'func' with details of
how to get the result back (i.e. a call to q.put), when the solution I
proposed in my previous email would make it transparent.

-Andrew.




From itamar at itamarst.org  Mon Oct  6 22:30:06 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 22:30:06 -0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <20031007022318.GC4818@frobozz>
References: <3F682235.5000106@iplus.ru>
	<20030917085000.2a9120e9.itamar@itamarst.org>
	<3F688D21.3080905@iplus.ru>
	<upthysa3o.fsf@inout.no>
	<20030918102904.GA13575@frobozz>
	<pan.2003.10.06.20.11.41.343421@smurf.noris.de>
	<20031007022318.GC4818@frobozz>
Message-ID: <20031006223006.4bbf2a32.itamar@itamarst.org>

On Tue, 7 Oct 2003 12:23:18 +1000
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

>     q = Queue.Queue()
>     reactor.callFromThread(func, q, arg1, arg2)
>     result = q.get()
> 
> Especially seeing as the latter requires cluttering 'func' with
> details of how to get the result back (i.e. a call to q.put), when the
> solution I proposed in my previous email would make it transparent.

t.i,threads should indeed have a utility function that does this for
you. It would need to turn Failures into exceptions and deal
transparently with Deferreds, of course.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Mon Oct  6 22:39:00 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 7 Oct 2003 12:39:00 +1000
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <20031006223006.4bbf2a32.itamar@itamarst.org>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no> <20030918102904.GA13575@frobozz> <pan.2003.10.06.20.11.41.343421@smurf.noris.de> <20031007022318.GC4818@frobozz> <20031006223006.4bbf2a32.itamar@itamarst.org>
Message-ID: <20031007023900.GD4818@frobozz>

On Mon, Oct 06, 2003 at 10:30:06PM -0400, Itamar Shtull-Trauring wrote:
> 
> t.i,threads should indeed have a utility function that does this for
> you. It would need to turn Failures into exceptions and deal
> transparently with Deferreds, of course.

I posted something like this to this thread earlier:

-----
import threading, sys
from twisted.internet import reactor

def blockingCallFromThread(func):
    e = threading.Event()
    l = []
    def wrapped_func():
        try:
            l.append(func)
        except:
            l.append(sys.exc_info())
            l.append(0)
        else:
            l.append(1)
        e.set()
    reactor.callFromThread(wrapped_func)
    e.wait()
    result, ok = l
    if ok:
        return result
    else:
        # Whee!  Cross-thread exceptions!
        raise result[0], result[1], result[2]
----

It doesn't deal with Failures or Deferreds, but it does everything else.
Oh, and it's not tested.  If I had already written test cases, I probably
would've checked it in by now ;)

(And I'm sure there's a better name for it than 'blockingCallFromThread'...)

-Andrew.




From dp at twistedmatrix.com  Mon Oct  6 22:50:18 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 6 Oct 2003 22:50:18 -0400
Subject: [Twisted-Python] Woven unicode
In-Reply-To: <003001c38c61$c46dc370$4b30fea9@laboratorio>
References: <20031006212402.12482.43539.Mailman@pyramid.twistedmatrix.com> <003001c38c61$c46dc370$4b30fea9@laboratorio>
Message-ID: <FC492ADA-F870-11D7-AF9E-000A95864FC4@twistedmatrix.com>

On Oct 6, 2003, at 7:29 PM, Rita D?az y/o Rodrigo Benenson wrote:

>
> I have tryed using a meta tag to indicate iso-8859-1 coding and 
> replaced
> u"el?" by u"el?".encode("iso-8859-1"); but that does not work too.

I just happen to be working on this at the moment so you may be in 
luck. The technique that worked for me was to encode the unicode string 
as utf8:

u"el?".encode("utf8")

Then override render in your Page subclass, so you can set the 
Content-type header:

class MyPage(page.Page):
	def render(self, request):
		request.setHeader("Content-type", "text/html; charset=utf8")
		return page.Page.render(self, request)

It worked for me, anyway. Hope it works for you!

dp




From glyph at twistedmatrix.com  Mon Oct  6 23:05:11 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 06 Oct 2003 23:05:11 -0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <20031007023900.GD4818@frobozz>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no> <20030918102904.GA13575@frobozz> <pan.2003.10.06.20.11.41.343421@smurf.noris.de> <20031007022318.GC4818@frobozz> <20031006223006.4bbf2a32.itamar@itamarst.org> <20031007023900.GD4818@frobozz>
Message-ID: <3F822D67.4090907@twistedmatrix.com>

Andrew, can you add a bug to the tracker for this, and assign it to 
someone? :)  It would also be good if it did handle Deferreds, but I'm a 
little sketchy on where the callback would go (I mean, you're in a 
thread because you're blocking already, right?  but deferreds are to 
avoid blocking, so does that mean the callback runs in a thread or in 
the main loop?)




From maoy at cis.upenn.edu  Mon Oct  6 23:12:21 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Mon, 6 Oct 2003 23:12:21 -0400 (EDT)
Subject: [Twisted-Python] producer/resuming issue?
In-Reply-To: <FC492ADA-F870-11D7-AF9E-000A95864FC4@twistedmatrix.com>
Message-ID: <Pine.LNX.4.44.0310062258390.547-100000@klondike.cis.upenn.edu>

I sometimes encounter the problem that when a connection (producer) has
been lost, the consumer still try to call resumeProducing() to the
producer, so that a non-valid fileno is added to the select loop, and 
generate endless error messages. 

I'm almost sure that this is b/c I didn't do unregisterProducer() at the 
correct time. Even though, I feel like endless error messages are not very 
pleasant. Could anyone help to fix this? My temp solution is that 
I modified the abstract.py and tcp.py to set a flag indicate whether the 
fileno is deleted or not, and won't let resumeProducing to add a invalid 
reader into the reactor. Any better suggestions?

To play with this bug, you may want to modify socks.py, add these into 
SOCKSv4Outgoing.connectionMade()

        self.socks.transport.registerProducer(self.transport, 0)
        self.transport.registerProducer(self.socks.transport, 0)
 
Yun






From itamar at itamarst.org  Mon Oct  6 23:26:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 23:26:51 -0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <3F822D67.4090907@twistedmatrix.com>
References: <3F682235.5000106@iplus.ru>
	<20030917085000.2a9120e9.itamar@itamarst.org>
	<3F688D21.3080905@iplus.ru>
	<upthysa3o.fsf@inout.no>
	<20030918102904.GA13575@frobozz>
	<pan.2003.10.06.20.11.41.343421@smurf.noris.de>
	<20031007022318.GC4818@frobozz>
	<20031006223006.4bbf2a32.itamar@itamarst.org>
	<20031007023900.GD4818@frobozz>
	<3F822D67.4090907@twistedmatrix.com>
Message-ID: <20031006232651.6f5402b6.itamar@itamarst.org>

On Mon, 06 Oct 2003 23:05:11 -0400
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> Andrew, can you add a bug to the tracker for this, and assign it to 
> someone? :)  It would also be good if it did handle Deferreds, but I'm
> a little sketchy on where the callback would go (I mean, you're in a 
> thread because you're blocking already, right?  but deferreds are to 
> avoid blocking, so does that mean the callback runs in a thread or in 
> the main loop?)

The callbacks all run the main thread, but the last one adds the result
to a object that feeds it to the waiting thread. That is, the thread
blocks until the Deferred has a result.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From syver at inout.no  Tue Oct  7 04:23:45 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Oct 2003 10:23:45 +0200
Subject: [Twisted-Python] woven authentications and connections.
In-Reply-To: <7AEE77A0-F80A-11D7-AA48-000A95864FC4@twistedmatrix.com>
References: <u4qyqu2qa.fsf@inout.no>
	<FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>
	<u3ce6n5jz.fsf@inout.no>
	<7AEE77A0-F80A-11D7-AA48-000A95864FC4@twistedmatrix.com>
Message-ID: <u8ynxlalp.fsf@inout.no>

Donovan Preston <dp at twistedmatrix.com> writes:

> On Oct 6, 2003, at 4:17 AM, Syver Enstad wrote:
> 
> > Donovan Preston <dp at twistedmatrix.com> writes:
> >
> >> On Oct 3, 2003, at 4:47 AM, Syver Enstad wrote:
> >>
> >>>
> >>> I am in the process of implementing authentication for an intranet
> >>> application using woven. I will be storing the login information in
> >>> the session. On each request I will connect to the database and pass
> >>> the connection to the page handling the request. How do I know when
> >>> the request is finished so that I can close the connection?
> >>
> >> Overriding Page.pageRenderComplete should be what you want.
> >
> > Thanks, I found another way by calling request.notifyFinished which
> > returns a deferred, I then add a callback to that deferred and it
> > seems to work fine. *The following is not a rethorical question, I am
> > just curious.* In what way is overriding Controller.pageRenderComplete
> > superior to my solution?
> 
> It's not. Your solution is superior. :-) Thanks for pointing it out.

Ok, so even better would be for the page to add pageRenderComplete
callback by calling request.notifyFinished? And then overriding
pageRenderComplete is the superior solution again?




From anders at bruun-olsen.net  Tue Oct  7 04:21:24 2003
From: anders at bruun-olsen.net (Anders Bruun Olsen)
Date: Tue, 7 Oct 2003 10:21:24 +0200
Subject: [Twisted-Python] SSH client bad packet length
In-Reply-To: <1065481007.787.0.camel@petra>
References: <20031006210433.GB28465@elmer.skumleren.net> <1065474821.770.4.camel@petra> <20031006212313.GC28465@elmer.skumleren.net> <1065481007.787.0.camel@petra>
Message-ID: <20031007082124.GD28465@elmer.skumleren.net>

On Mon, Oct 06, 2003 at 06:56:46PM -0400, Paul Swartz wrote:
> > code clipped
> can you file a bugtracker request for this?  it seems the problem is
> that Conch and OpenSSH handle *-ctr encryption modes differently.

Done.

-- 
Anders
-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GCS/O d--@ s:+ a-- C++ UL+++$ P++ L+++ E- W+ N(+) o K? w O-- M- V
PS+ PE@ Y+ PGP+ t 5 X R+ tv+ b++ DI+++ D+ G e- h !r y?
------END GEEK CODE BLOCK------
PGPKey: http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x8BFECB41



From syver at inout.no  Tue Oct  7 04:29:03 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Oct 2003 10:29:03 +0200
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <20031006135553.GA1103@radii>
References: <ud6dalbwx.fsf@inout.no> <20031006135553.GA1103@radii>
Message-ID: <u3ce5lacw.fsf@inout.no>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> On Mon, Oct 06, 2003 at 03:43:10PM +0200, Syver Enstad wrote:
> > As I was saying on the list I am making a login system with woven, and
> > the way to autheticate the user is by doing a pb call. 
> 
> Sounds like you need to be using twisted.web.woven.guard, and use it
> with a CredentialsChecker (that you write) that does the PB
> communication. You can see how to do this by reading
> twisted/cred/checkers.py, it is simple.

Does this work with 1.0.6. I am using the old cred system
and I have no immediate plans to upgrade it.

 




From syver at inout.no  Tue Oct  7 04:32:42 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Oct 2003 10:32:42 +0200
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <1065448930.20878.15.camel@serrano>
References: <ud6dalbwx.fsf@inout.no> <1065448930.20878.15.camel@serrano>
Message-ID: <uy8vxjvmd.fsf@inout.no>

Bill Gribble <grib at billgribble.com> writes:

> On Mon, 2003-10-06 at 08:43, Syver Enstad wrote:
> > Should I use a plain Resource rather than a woven page for this kind
> > of problem?
> 
> I'm not using PB for auth (homebrew using the app's SQL db) but I think
> the general approach could be the same. 
> 
> I have a separate Resource that is the top-level entry point of the
> app.  Its getChild method checks that the proper credentials are
> associated with the Session and if not redirects to the login page.  The
> handlers on the login page are responsible for setting up the
> credentials in the Session. 
> 
> This works well for me.  The "gatekeeper" Resource is like 20 lines of
> code and keeps the page logic from having to know about the
> authentication scheme. 

This sounds like what I was thinking about. I am curious about how you
solve the actual login on the login page, my take would be that you'd
need to use a plain Resource or at least override render on a page to
be able to redirect after you have logged in to the database, no?





From alienoid at is.lg.ua  Tue Oct  7 04:46:45 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Tue, 07 Oct 2003 11:46:45 +0300
Subject: [Twisted-Python] pb.Referenceable: wxPython client crash and server exceptions
Message-ID: <3F827D75.70803@is.lg.ua>

Hello.

I have wxPython clients (twisted on windows XP) and twisted ssl 
server(RH linux 8.0).

Clients connect to server and passes their pb.Referenceable. Server 
every minute calls clients remote methods.
After 8-9 hours of continuous work client crashes(it's compiled into 
windows .exe with py2exe) and in my twistd.log i see such lines:

2003/10/07 05:46 EEST [Broker,2,192.168.100.254] Unhandled error in 
Deferred:
2003/10/07 05:46 EEST [Broker,2,192.168.100.254] Traceback from remote 
host -- Traceback (most recent call last):
           File "twisted\spread\banana.pyc", line 320, in dataReceived

           File "twisted\spread\banana.pyc", line 93, in 
callExpressionReceived

           File "twisted\spread\pb.pyc", line 511, in expressionReceived

           File "twisted\spread\pb.pyc", line 822, in proto_message

         --- <exception caught here> ---
           File "twisted\spread\pb.pyc", line 836, in _recvMessage

           File "twisted\spread\flavors.pyc", line 118, in 
remoteMessageReceived

           File "<string>", line 55, in remote_checkpoint

         exceptions.IOError: [Errno 9] Bad file descriptor




My client code excerpt:

class Client(pb.Referenceable):
     def remote_checkpoint(self):
         print "client"


class MyFrame(wxFrame, TaskBarApp):
     ...

     def gotObject(self, object):
         self.server = object
         object.notifyOnDisconnect(self.disconnected)
         d = object.callRemote("connect", self.conf.getUsername(),
                             self.conf.getPassword(),
                             self.conf.getIP(),
                             self.conf.getNetmask(),
                             self.conf.getMAC(),
                             Client())
         d.addCallbacks(self.connected, self.gotError)

     def OnConnect(self, event=None):
         bf = pb.PBClientFactory()
         from twisted.internet import ssl
         contextFactory = ssl.ClientContextFactory()
         reactor.connectSSL(SERVER_IP, SERVER_PORT, bf, contextFactory, 30)
         d = bf.getRootObject()

         d.addCallbacks(self.gotObject, self.gotError)


class MyApp(wxApp):
     def OnInit(self):
         wxInitAllImageHandlers()
         self.frame = MyFrame(NULL, -1, lang.appLabel)
         self.frame.Show(true)
         self.SetTopWindow(self.frame)
         return true

app = MyApp(0)
wxsupport.install(app)
if app.frame.isAutoconnected():
     app.frame.OnConnect()
#on Windows platfom we need to run with installSignalHandlers=0
if wxPlatform == '__WXMSW__':
     reactor.run(installSignalHandlers=0)
else:
     reactor.run()


Can you suggest something?
Your help is very appreciated.
Thanks in advance.

P.S. Twisted1.0.7

Best regards,
Ruslan




From justinjohnson at fastmail.fm  Tue Oct  7 08:15:22 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 07 Oct 2003 06:15:22 -0600
Subject: [Twisted-Python] Adapter troubles - Copying Quotient's DivmodSession
In-Reply-To: <C108B4E6-F5BC-11D7-87C4-000A95864FC4@twistedmatrix.com>
References: <20031002143039.784EB3D96E@www.fastmail.fm> <C108B4E6-F5BC-11D7-87C4-000A95864FC4@twistedmatrix.com>
Message-ID: <20031007121523.075FA3C3EF@www.fastmail.fm>

It works now.  Thanks much!

On Fri, 3 Oct 2003 12:15:07 -0400, "Donovan Preston"
<dp at twistedmatrix.com> said:
> 
> On Oct 2, 2003, at 10:30 AM, Justin Johnson wrote:
> 
> > Hi,
> >
> > I've created a class called RatControlSession similar to DivmodSession 
> > in
> > Quotient.  I define IRatControlSession and RatControlSession, and I
> > register RatControlSession as an adapter from 
> > twisted.web.server.Session
> > to IRatControlSession.  However, when I try to do something like...
> >
> >     prefs = webinterfaces.IRatControlSession(request.getSession())
> >
> > I get the following error.  This is a cut-n-paste from what appears in
> > the browser.
> 
> <snip exception>
> 
> > I'm not sure what I'm doing wrong here.  I looked through components.py
> > but still don't see what the problem is.
> >
> > I've attached webinterfaces.py and session.py, setup similar to
> > quotient's respective files.  Also attached is pages.py which defines
> > wmfactory_action on MenuPage where I try to create an 
> > IRatControlSession
> > from request.getSession().
> 
>  From looking at the files, it looks like session is not getting 
> imported anywhere. You would think it wouldn't be a problem since you 
> are not directly using any of the objects in the module, but unless you 
> import a module, the code at the top level of that module does not get 
> executed. Thus the registerAdapter calls are never happening, and when 
> you go to request an adapter none is registered. Try putting "import 
> session" at the top of your pages file.
> 
> This is a major problem with using components and twisted -- where to 
> register the adapters. Of course, the implementation of components as 
> pioneered by Zope 3 uses a non-python file to register adapters (a zcml 
> file, a form of XML) and twisted should have something similar 
> (preferably not xml) but currently does not.
> 
> dp
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From oisin at enginesofcreation.ie  Tue Oct  7 08:20:06 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Tue, 07 Oct 2003 13:20:06 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <20031003165923.GB6738@intarweb.us>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031003165923.GB6738@intarweb.us>
Message-ID: <3F82AF76.3000300@enginesofcreation.ie>

Jp Calderone wrote:

>On Fri, Oct 03, 2003 at 11:18:28AM +0100, Oisin Mulvihill wrote:
>  
>
>>Hi,
>>
>>[snip]
>>Why are there two deferred objects returned by storeFile? The documentation
>>says:
>>
>>storeFile (self ,path ):
>>
>>   Store a file at the given path.
>>
>>   This method issues the 'STOR' FTP command.
>>
>>   Returns:
>>
>>   A tuple of two Deferreds:
>>       
>>   * Deferred IFinishableConsumer . You must call the finish method on the
>>       IFinishableConsumer when the file is completely transferred.
>>
>>   * Deferred list of  control-connection responses.
>>
>>This really doesn't help me much. I get the impression that storeFile
>>isn't sending the contents of file, because its waiting for me to stream
>>the file contents somehow. Maybe via IFinishableConsumer?
>>    
>>
>
>  Correct, I believe.  It looks like you can use FileSender (from t.p.basic)
>if you're just sending something off disk (or from any file object, really)
>here.
>
>  
>
>>In my current program, using ftplib, I do the following to upload a file:
>>
>>   :
>>   ftp.storbinary('STOR %s' % (filename), fp)
>>   :
>>
>>This has the filename and a file descriptor passed to it. Is something
>>like this needed with storeFile?
>>
>>Please can someone give me an answer to this, as looking at the code for
>>twisted.protocols.ftp isn't helping much either. This function seems to be
>>a mystery to me and I want to understand how to use it properly.
>>
>>    
>>
>
>  Try...
>
>    from twisted.protocols.basic import FileSender
>
>    def sendfile(consumer, fileObj):
>        s = FileSender()
>        return s.beginFileTransfer(fileObj, consumer
>            ).addCallback(lambda _: consumer.finish()
>            )
>
>    dC, dL = p.storeFile("path")
>    dC.addCallback(sendfile, fileObj)
>
>  Jp
>  
>
Thanks for replying. I've tried what you've suggested, however I'm
still getting the code "waiting" when the transfer is supposed to happen.
The follow is the code I added based on your suggestion (attached
is the complete source):

<snip>
:
:

def sendfile(consumer, fileObj):
    """
    """
    print "2.1 consumer, fileObject -", consumer, fileObj
    s = FileSender()
    print "2.2"
    d = s.beginFileTransfer(fileObj, consumer)
    print "2.3"
    d.addCallback(lambda _: consumer.finish())
    print "2.4"
    return d


def connectionMade(ftpClient):
    """
    """
    try:
        print "1.0"
        my_file = StringIO("Hello! Did this get sent to the remote side?")
        print "1.1"
        my_filename = 'myfile.txt'   
        print "1.2"
        ftpClient.pwd().addCallbacks(success, fail)
        print "1.3"
        dC, dL = ftpClient.storeFile(my_filename)
        print "1.4"
        dC.addCallback(sendfile, my_file)
        print "1.5"
        dL.addCallbacks(success, fail)
        print "1.6"
       
    except:
        print "Exception -", sys.exc_value
        reactor.stop()

:
:
</snip>

When I run this I get as far as the line:

    d = s.beginFileTransfer(fileObj, consumer)

This is where it now seems to be hanginig. The file transfer doesn't appear
to be happening. I noticed from the docs on beginFileTransfer(), that
it takes 3 args: file object, consumer & transform function. I tried 
adding a
transform function to see it gets called with the data, read from the file,
however this never occured.

I'm not really sure where to go from here. Any suggestions?

Thanks,

om

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftpclient.py
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031007/f4b57d5c/attachment.txt 

From justinjohnson at fastmail.fm  Tue Oct  7 09:49:44 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 07 Oct 2003 07:49:44 -0600
Subject: [Twisted-Python] PB and Woven authentication
Message-ID: <20031007134944.EF10D3DC4F@www.fastmail.fm>

I know there have been other posts on this topic, but I wasn't sure how
up-to-date they are.

I currently have a PB server that I connect to via the command line.  It
allows me to do tasks on wintel servers I manage.  I'm now trying to
create a web interface to that service using woven.

Below is what I'm currently doing for authentication.

First of all, am I doing things right below?  Any corrections or
suggestions for improvement?

Once that is correct, how do I hook this up to woven?  I was trying to
look through the Quotient code to figure it out, but there is so much
other stuff in there I'm having a hard time keeping it all straight.

Thanks much.
-Justin


***** SERVER SIDE *****
----
class RatControlRealm:
    def __init__(self):
        self.p = RatControlPerspective("admin")
                                                                                
    def requestAvatar(self, avatarId, mind, interface):
        assert interface == pb.IPerspective
        assert mind == "BRAINS!"
        self.p.loggedIn = 1
        return pb.IPerspective, self.p, self.p.logout
                                                                                

from twisted.cred import portal, checkers, credentials
realm = RatControlRealm()
portal = portal.Portal(realm)
checker = checkers.InMemoryUsernamePasswordDatabaseDontUse()
checker.addUser(config.adminUser, config.adminPassword)
portal.registerChecker(checker)
                                                                                
factory = pb.PBServerFactory(portal)
reactor.listenTCP(config.portNumber, factory)
reactor.run()
--------

***** CLIENT SIDE *****
-----
    def connectToServer(self, server):
        def _cbSuccess(perspective):
            return perspective
        def _cbFailure(failure):
            print "Failed to connect to '%s'." % server
            return failure
        factory = pb.PBClientFactory()
        reactor.connectTCP(server, config.portNumber, factory)
        d = factory.login(credentials.UsernamePassword(config.adminUser,
        config.adminPassword), "BRAINS!")
        d.addCallbacks(_cbSuccess, _cbFailure)
        return d
------



From itamar at itamarst.org  Tue Oct  7 10:49:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 7 Oct 2003 10:49:20 -0400
Subject: [Twisted-Python] PB and Woven authentication
In-Reply-To: <20031007134944.EF10D3DC4F@www.fastmail.fm>
References: <20031007134944.EF10D3DC4F@www.fastmail.fm>
Message-ID: <20031007104920.72315306.itamar@itamarst.org>

On Tue, 07 Oct 2003 07:49:44 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> First of all, am I doing things right below?  Any corrections or
> suggestions for improvement?

s/"BRAINS"/None/, since you aren't actually using it.

> Once that is correct, how do I hook this up to woven?  I was trying to
> look through the Quotient code to figure it out, but there is so much
> other stuff in there I'm having a hard time keeping it all straight.

Use twisted.web.woven.guard (.simpleguard is a good example). You realm
will be asked for IResource instead of IPerspective when authenticating
web clients.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Tue Oct  7 11:00:57 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 7 Oct 2003 11:00:57 -0400
Subject: [Twisted-Python] pb.Referenceable: wxPython client crash and
 server exceptions
In-Reply-To: <3F827D75.70803@is.lg.ua>
References: <3F827D75.70803@is.lg.ua>
Message-ID: <20031007110057.06063f3f.itamar@itamarst.org>

On Tue, 07 Oct 2003 11:46:45 +0300
Ruslan Spivak <alienoid at is.lg.ua> wrote:

> I have wxPython clients (twisted on windows XP) and twisted ssl 
> server(RH linux 8.0).

Using pyOpenSSL 0.5.1 I hope? 0.4 is kinda broken.

As for the bug - what does your code do in line 55 in remote_checkpoint?

--
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Tue Oct  7 11:10:23 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 7 Oct 2003 11:10:23 -0400
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <3F82AF76.3000300@enginesofcreation.ie>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031003165923.GB6738@intarweb.us> <3F82AF76.3000300@enginesofcreation.ie>
Message-ID: <20031007151023.GA30866@intarweb.us>

On Tue, Oct 07, 2003 at 01:20:06PM +0100, Oisin Mulvihill wrote:
> Jp Calderone wrote:
> 
> [snip]
> 
> When I run this I get as far as the line:
> 
>    d = s.beginFileTransfer(fileObj, consumer)
> 
> This is where it now seems to be hanginig. The file transfer doesn't
> appear to be happening. I noticed from the docs on beginFileTransfer(),
> that it takes 3 args: file object, consumer & transform function. I tried
> adding a transform function to see it gets called with the data, read from
> the file, however this never occured.

  This suggests to me that the data connection is never actually being made.

  Try adding errbacks to all these deferreds and seeing if any of those are
being called.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031007/7432c6bd/attachment.pgp 

From oisin at enginesofcreation.ie  Tue Oct  7 13:36:28 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Tue, 07 Oct 2003 18:36:28 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <20031007151023.GA30866@intarweb.us>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031003165923.GB6738@intarweb.us> <3F82AF76.3000300@enginesofcreation.ie> <20031007151023.GA30866@intarweb.us>
Message-ID: <3F82F99C.1080106@enginesofcreation.ie>

Jp Calderone wrote:

>On Tue, Oct 07, 2003 at 01:20:06PM +0100, Oisin Mulvihill wrote:
>  
>
>>Jp Calderone wrote:
>>
>>[snip]
>>
>>When I run this I get as far as the line:
>>
>>   d = s.beginFileTransfer(fileObj, consumer)
>>
>>This is where it now seems to be hanginig. The file transfer doesn't
>>appear to be happening. I noticed from the docs on beginFileTransfer(),
>>that it takes 3 args: file object, consumer & transform function. I tried
>>adding a transform function to see it gets called with the data, read from
>>the file, however this never occured.
>>    
>>
>
>  This suggests to me that the data connection is never actually being made.
>
>  Try adding errbacks to all these deferreds and seeing if any of those are
>being called.
>
>  Jp
>
>  
>
I'll look into it further, but as far as I can tell the connection is
being made. An empty file does get created on the server side.
I've I killed the ftp server and the errbacks get called, informing
me of the connection loss. Would this indicate then that maybe
the file sender isn't doing its job? I'll look into this as well. Any
further suggestions would be welcome,

Thanks,

om

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540






From oisin at enginesofcreation.ie  Tue Oct  7 13:46:31 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Tue, 07 Oct 2003 18:46:31 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <20031007151023.GA30866@intarweb.us>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031003165923.GB6738@intarweb.us> <3F82AF76.3000300@enginesofcreation.ie> <20031007151023.GA30866@intarweb.us>
Message-ID: <3F82FBF7.9060104@enginesofcreation.ie>

Jp Calderone wrote:

>On Tue, Oct 07, 2003 at 01:20:06PM +0100, Oisin Mulvihill wrote:
>  
>
>>Jp Calderone wrote:
>>
>>[snip]
>>
>>When I run this I get as far as the line:
>>
>>   d = s.beginFileTransfer(fileObj, consumer)
>>
>>This is where it now seems to be hanginig. The file transfer doesn't
>>appear to be happening. I noticed from the docs on beginFileTransfer(),
>>that it takes 3 args: file object, consumer & transform function. I tried
>>adding a transform function to see it gets called with the data, read from
>>the file, however this never occured.
>>    
>>
>
>  This suggests to me that the data connection is never actually being made.
>
>  Try adding errbacks to all these deferreds and seeing if any of those are
>being called.
> 
>  Jp
>
>  
>
I forgot to mention I've tried this on my linux system
with python 2.2.3 and twisted 1.0.7, with no success.

om

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540






From glyph at twistedmatrix.com  Tue Oct  7 14:53:22 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 07 Oct 2003 14:53:22 -0400
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <u3ce5lacw.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no> <20031006135553.GA1103@radii> <u3ce5lacw.fsf@inout.no>
Message-ID: <3F830BA2.6080505@twistedmatrix.com>

Syver Enstad wrote:

> Does this work with 1.0.6. I am using the old cred system
> and I have no immediate plans to upgrade it.

No.  Old cred was a disaster and it's a really good thing it's getting 
replaced.  You can look at the woven.guard that came with 1.0.6, but 
please don't bother the list with questions about it - it's hard enough 
to support the current code without that confusion.




From mporter at despammed.com  Tue Oct  7 16:47:52 2003
From: mporter at despammed.com (Michael Porter)
Date: Tue, 7 Oct 2003 21:47:52 +0100
Subject: [Twisted-Python] Twisted powered network jukebox
References: <CC6F75D6-F839-11D7-AAA7-000A95686CD8@redivi.com>
Message-ID: <004401c38d14$48622600$0201a8c0@dan>

----- Original Message -----
From: "Bob Ippolito" <bob at redivi.com>
To: <twisted-python at twistedmatrix.com>
Sent: Monday, October 06, 2003 9:15 PM
Subject: [despammed] Re: [Twisted-Python] Twisted powered network jukebox


>
> On Monday, Oct 6, 2003, at 15:44 America/New_York, Michael Porter wrote:
>
> > ----- Original Message -----
> > From: "Bob Ippolito" <bob at redivi.com>
> > To: <twisted-python at twistedmatrix.com>
> > Sent: Sunday, October 05, 2003 9:34 PM
> > Subject: Re: [Twisted-Python] Twisted powered network jukebox
> >
> >> On Sunday, Oct 5, 2003, at 15:46 America/New_York, Michael Porter
> >> wrote:
> >>
> >>> I've just uploaded the first public version of mpJuke, a network
> >>> jukebox
> >>> I've been working on. If you're interested take a look at the
> >>> website:
> >>>
> >>>     http://www.mpweb.dsl.pipex.com/
> >>
> >> Very cool.  I'll probably port this to OS X sometime in the near
> >> future.  Also, I have some almost-complete code lying dormant that
> >> does
> >> iTunes music sharing (server and client) that might be useful for this
> >> project.
> >
> > Glad you like it. OS X version would be good and I guess should be
> > relatively easy to port assuming the packages it requires are
> > available.
>
> The packages are all available.  I'd probably end up wanting to rewrite
> the GUI in PyObjC/Cocoa because wxPython is slow and a bit buggy, and
> more likely than not I'd also want to factor out the ResourcePackage
> thing and use the native OS X way of doing it (bundles with localizable
> resources) instead.. ResourcePackage is probably only used in the GUI
> layer anyways, right?
>
> -bob
>
ResourcePackage is really just a development tool which automatically
converts resources into Python source files. It makes things simpler if the
application is going to be frozen because you don't have to worry about file
paths. I use it to convert the web icons, CSS file etc.

Mike.





From alienoid at is.lg.ua  Tue Oct  7 19:58:56 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Wed, 08 Oct 2003 02:58:56 +0300
Subject: [Twisted-Python] pb.Referenceable: wxPython client crash
 and server exceptions
Message-ID: <3F835340.6050701@is.lg.ua>

>> I have wxPython clients (twisted on windows XP) and twisted ssl 
>> server(RH linux 8.0).


> Using pyOpenSSL 0.5.1 I hope? 0.4 is kinda broken.
Both client and server use 0.5.1

> As for the bug - what does your code do in line 55 in remote_checkpoint?
server calls client's remote method 'remote_checkpoint' just to check if client's remote reference still valid(if it's invalid i need to do some stuff on server side), so on client i have just empty method(so from server side it's like a ping - to check if client is alive)

--
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting






From andrew-twisted at puzzling.org  Tue Oct  7 22:00:28 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 8 Oct 2003 12:00:28 +1000
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <3F7D4CF4.2050807@enginesofcreation.ie>
References: <3F7D4CF4.2050807@enginesofcreation.ie>
Message-ID: <20031008020028.GA8353@frobozz>

On Fri, Oct 03, 2003 at 11:18:28AM +0100, Oisin Mulvihill wrote:
> 
> Why are there two deferred objects returned by storeFile? The documentation
> says:

Try looking at twisted/test/test_ftp.py, line 251 (the testStor method of
FTPClientAndServerTests).  Hopefully that should help fill in the blanks.

-Andrew.




From stuart.hungerford at anu.edu.au  Wed Oct  8 01:33:41 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Wed, 08 Oct 2003 15:33:41 +1000
Subject: [Twisted-Python] Woven page instances deferring to each other...
Message-ID: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au>

Hi all,

I have a Twisted web application that uses Woven to generate
various HTML pages.  The application knows about a bunch of
"error" states which have one Woven page instance per state:


class error_state_1(twisted.web.woven.page.Page):
     isLeaf = 1
     templateFile = ...

     # usual wmfactory_ and wvupdate_ methods


class error_state_2(twisted.web.woven.page.Page):
     isLeaf = 1
     templateFile = ...

     # usual wmfactory_ and wvupdate_ methods


class error_state_3(twisted.web.woven.page.Page):
     isLeaf = 1
     templateFile = ...

     # usual wmfactory_ and wvupdate_ methods


In another Woven page the application can detect these
"error" states and I would like to optionally "defer" the HTML
generation to the existing error pages:


class application_page(twisted.web.woven.page.Page):
     isLeaf = 1
     templateFile = ...

     # methods

     def wvupdate_content(self, request, node, data):
         if error_state_1:
             # defer to error_state_1 page
         elif error_state_2:
             # defer to error_state_2 page
         ...
         else:
             # situation normal, generate content XHTML


In practice there are a number of application pages and they
may all need to detect and report the "error" conditions.

So, my question is what's the best way to do this kind of thing
in Woven?  I seem to recall something about expanding a Woven
"macro" page being discussed on the list, but I'm still grepping
for that.

Any advice much appreciated,



Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From mary-twisted at puzzling.org  Wed Oct  8 01:55:03 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed, 8 Oct 2003 15:55:03 +1000
Subject: [Twisted-Python] Woven page instances deferring to each other...
In-Reply-To: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au>
References: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au>
Message-ID: <20031008055503.GS12404@titus>

On Wed, Oct 08, 2003, Stuart Hungerford wrote:
> In another Woven page the application can detect these
> "error" states and I would like to optionally "defer" the HTML
> generation to the existing error pages:

I *think* here you mean "I'd like totally different HTML generated if
there is an error state", rather than "my check for the error returns a
Deferred object". Let me know if I'm wrong.

Since Deferred objects are a key part of Twisted, "defer" is probably
not the best choice of verb unless you mean "defer using a Deferred
object". (It's like talking to mathematicians about "clumps" of "things"
which is a pain, because they've overloaded the words "class", "set",
"group" and "category" among others.)

> So, my question is what's the best way to do this kind of thing
> in Woven?  I seem to recall something about expanding a Woven
> "macro" page being discussed on the list, but I'm still grepping
> for that.

Assuming you meant "I'd like totally different HTML generated if
there is an error state" you probably do want macros or something like
them. The best documentation I've seen on this is here:
http://twistedmatrix.com/pipermail/twisted-python/2003-June/004662.html

-Mary



From mary-twisted at puzzling.org  Wed Oct  8 02:02:12 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed, 8 Oct 2003 16:02:12 +1000
Subject: [Twisted-Python] Woven page instances deferring to each other...
In-Reply-To: <20031008055503.GS12404@titus>
References: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au> <20031008055503.GS12404@titus>
Message-ID: <20031008060212.GU12404@titus>

On Wed, Oct 08, 2003, Mary Gardiner wrote:
> Assuming you meant "I'd like totally different HTML generated if
> there is an error state" you probably do want macros or something like
> them. The best documentation I've seen on this is here:
> http://twistedmatrix.com/pipermail/twisted-python/2003-June/004662.html

Followup...

A nicer solution may be to have the parent Page (by this I mean
http://example.com/bob/ is a parent and http://example.com/bob/result/
is a child -- parents in the URL structure) do the check and return an
object of a different Page class, something like:

class MyParentPage(page.Page):

    def getDynamicChild(self, name, request):

        if error_condition_1:
            return ErrorPage1()
        elif error_condition_2:
            return ErrorPage2()
        else:
            return NormalChildPage()

If there's any way you can determine if the error has happened before
the child page starts rendering, then I suspect it would be nicer to do
the error check at child creation time, rather than when the child
renders.

You can then use macros for something like their normal function: which
is defining the bits of pages that look mostly the same across lots of
pages (navigation bars and the like).

-Mary



From dp at twistedmatrix.com  Wed Oct  8 02:21:48 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 8 Oct 2003 02:21:48 -0400
Subject: [Twisted-Python] Woven page instances deferring to each other...
In-Reply-To: <20031008060212.GU12404@titus>
References: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au> <20031008055503.GS12404@titus> <20031008060212.GU12404@titus>
Message-ID: <B2A1A6F3-F957-11D7-9FC4-000A95864FC4@twistedmatrix.com>

On Oct 8, 2003, at 2:02 AM, Mary Gardiner wrote:

> If there's any way you can determine if the error has happened before
> the child page starts rendering, then I suspect it would be nicer to do
> the error check at child creation time, rather than when the child
> renders.

Since woven renders the entire page before it calls request.write, any 
portion of the view rendering code which detects an error is able to 
call request.redirect (because we can still set headers since we 
haven't written any of the body yet). Just thought I'd chuck that out 
there, it may be totally irrelevant.

dp




From mary-twisted at puzzling.org  Wed Oct  8 02:30:03 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed, 8 Oct 2003 16:30:03 +1000
Subject: [Twisted-Python] Woven page instances deferring to each other...
In-Reply-To: <B2A1A6F3-F957-11D7-9FC4-000A95864FC4@twistedmatrix.com>
References: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au> <20031008055503.GS12404@titus> <20031008060212.GU12404@titus> <B2A1A6F3-F957-11D7-9FC4-000A95864FC4@twistedmatrix.com>
Message-ID: <20031008063003.GV12404@titus>

On Wed, Oct 08, 2003, Donovan Preston wrote:
> Since woven renders the entire page before it calls request.write, any 
> portion of the view rendering code which detects an error is able to 
> call request.redirect (because we can still set headers since we 
> haven't written any of the body yet). Just thought I'd chuck that out 
> there, it may be totally irrelevant.

It's not, it reduces my second post to a stylistic choice, I think.

-Mary



From mesozoic at polynode.com  Wed Oct  8 04:25:32 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 08 Oct 2003 04:25:32 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
Message-ID: <1065601532.1583.175.camel@hyla>

I am using distrib.ResourceSubscription and ResourcePublisher to link a
user-run web server with Moshe's twisted-web. I've noticed something
very odd going on; my twistd process will progressively hog memory and
CPU time to the point that the entire server slows down. Here is a
snippet of what's happening:

2003/10/03 19:00 EDT [HTTPChannel,14,206.231.13.11] Starting factory
<twisted.spread.pb.PBClientFactory instance at 0x84bafbc>
2003/10/03 19:00 EDT [Broker,client] connected to publisher

And then, days later...

2003/10/08 04:12 EDT [Broker,client] Stopping factory
<twisted.spread.pb.PBClientFactory instance at 0x84bafbc>
2003/10/08 04:12 EDT [Broker,client] could not connect to distributed
web service: connection dropped

I imagine this means that all the PBClientFactory instances are sitting
around, doing nothing, and clogging my meager 64MB of RAM. Here is the
code I'm using to do this:

--- snip /www/mesozoic.geecs.org/siteroot.rpy ---
subscription = ResourceSubscription('unix', '/home/mesozoic/.pb-web')
resource.putChild('cogito', subscription)
--- snip ---

--- snip /home/mesozoic/pb-web.tpy ---
file = static.File('./pb-web')
site = server.Site(file)
application.listenUNIX(
   '/home/mesozoic/.pb-web',
   pb.BrokerFactory(distrib.ResourcePublisher(site)))
--- snip ---

Could all these PBClientFactory instances be popping up because my
ResourceSubscription is in an .rpy instead of in the twisted-web config
files? Or is this an internal bug that shouldn't be happening? Or do I
need to share more information?

I can't deal with having to restart twisted-web every few days... help?

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031008/d715b78e/attachment.pgp 

From radix at twistedmatrix.com  Wed Oct  8 04:38:48 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 8 Oct 2003 04:38:48 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
In-Reply-To: <1065601532.1583.175.camel@hyla>
References: <1065601532.1583.175.camel@hyla>
Message-ID: <20031008083848.GD1103@radii>

On Wed, Oct 08, 2003 at 04:25:32AM -0400, Alex Levy wrote:
> I am using distrib.ResourceSubscription and ResourcePublisher to link a
> user-run web server with Moshe's twisted-web. I've noticed something
> very odd going on; my twistd process will progressively hog memory and
> CPU time to the point that the entire server slows down. Here is a
> snippet of what's happening:

I think I know what's happening. Do a "netstat |grep twistd-web-pb".

If you have lots of connections to the same .twistd-web-pb, this is
because of a bug that was recently introduced to web.distrib, when
Jerub refactored it to use Woven. It stopped caching connections to
the personal web servers. :-( I fixed this in CVS yesterday. I will
try to get another alpha out soon.

Unfortunately, I think this bug made it into 1.0.7 :-(, although I'm
not sure.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From syver at inout.no  Wed Oct  8 05:01:51 2003
From: syver at inout.no (Syver Enstad)
Date: 08 Oct 2003 11:01:51 +0200
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <3F830BA2.6080505@twistedmatrix.com>
References: <ud6dalbwx.fsf@inout.no> <20031006135553.GA1103@radii>
	<u3ce5lacw.fsf@inout.no> <3F830BA2.6080505@twistedmatrix.com>
Message-ID: <uk77gdrwg.fsf@inout.no>

Glyph Lefkowitz <glyph at twistedmatrix.com> writes:

> Syver Enstad wrote:
> 
> > Does this work with 1.0.6. I am using the old cred system
> > and I have no immediate plans to upgrade it.
> 
> No.  Old cred was a disaster and it's a really good thing it's getting
> replaced.  

Is there an upgrade path for applications that use the old cred
system? What has to change in an application that usess old cred to
use the new cred?







From wiedeman at gmx.net  Wed Oct  8 04:40:10 2003
From: wiedeman at gmx.net (Christoph Wiedemann)
Date: Wed, 8 Oct 2003 10:40:10 +0200 (MEST)
Subject: [Twisted-Python] hardcoded SIZE_LIMIT
Message-ID: <3747.1065602410@www48.gmx.net>

Hello,

i'm trying to use PB for remote procedure calls in the context of numeric
computations. So far things work really well (Twisted is a real cool piece of
software!), but now i'm trapped by twisted.spread.banana.SIZE_LIMIT. I need to
send pretty much data over the network (~512 MB) and tried out to set the
SIZE_LIMIT to 640 MB. Hmm, still getting the "String too long exception", cause
the 640 kB are hardcoded in cBanana.c. Any chances to make the limit
configurable ?

Regards,
Christoph




From mesozoic at polynode.com  Wed Oct  8 05:11:27 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 08 Oct 2003 05:11:27 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
In-Reply-To: <20031008083848.GD1103@radii>
References: <1065601532.1583.175.camel@hyla>  <20031008083848.GD1103@radii>
Message-ID: <1065604286.1583.180.camel@hyla>

On Wed, 2003-10-08 at 04:38, Christopher Armstrong wrote:
> I think I know what's happening. Do a "netstat |grep twistd-web-pb".

This is indeed what's happening. Until the next alpha comes out, I'll
simply patch my local copy.

Thanks :]

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031008/74fa50d6/attachment.pgp 

From mesozoic at polynode.com  Wed Oct  8 05:17:56 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 08 Oct 2003 05:17:56 -0400
Subject: [Twisted-Python] hardcoded SIZE_LIMIT
In-Reply-To: <3747.1065602410@www48.gmx.net>
References: <3747.1065602410@www48.gmx.net>
Message-ID: <1065604676.1589.188.camel@hyla>

On Wed, 2003-10-08 at 04:40, Christoph Wiedemann wrote:
> i'm trying to use PB for remote procedure calls in the context of numeric
> computations. So far things work really well (Twisted is a real cool piece of
> software!), but now i'm trapped by twisted.spread.banana.SIZE_LIMIT. I need to
> send pretty much data over the network (~512 MB) and tried out to set the
> SIZE_LIMIT to 640 MB. Hmm, still getting the "String too long exception", cause
> the 640 kB are hardcoded in cBanana.c. Any chances to make the limit
> configurable ?

I encountered the same problem; my solution was simply to split strings
into multiple pieces and combine them at the receiving end. (I also used
the gzip module to compress them.) I did all this in getStateToCopy and
setCopyableState, which are documented here:
<http://twistedmatrix.com/documents/howto/pb-copyable#auto6>

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031008/ba404588/attachment.pgp 

From mesozoic at polynode.com  Wed Oct  8 05:27:34 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 08 Oct 2003 05:27:34 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
In-Reply-To: <20031008083848.GD1103@radii>
References: <1065601532.1583.175.camel@hyla>  <20031008083848.GD1103@radii>
Message-ID: <1065605254.1586.194.camel@hyla>

On Wed, 2003-10-08 at 04:38, Christopher Armstrong wrote:
> I think I know what's happening. Do a "netstat |grep twistd-web-pb".

On Wed, 2003-10-08 at 05:11, Alex Levy wrote: 
> This is indeed what's happening.

I spoke too soon. It looks like the bug you mentioned occurs in
UserDirectory; I'm not using that. I'm simply using ResourceSubscription
and ResourcePublisher. Should I _not_ be doing this? Or is there another
solution to the problem?

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031008/1196f25a/attachment.pgp 

From radix at twistedmatrix.com  Wed Oct  8 05:59:03 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 8 Oct 2003 05:59:03 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
In-Reply-To: <1065605254.1586.194.camel@hyla>
References: <1065601532.1583.175.camel@hyla> <20031008083848.GD1103@radii> <1065605254.1586.194.camel@hyla>
Message-ID: <20031008095903.GF1103@radii>

On Wed, Oct 08, 2003 at 05:27:34AM -0400, Alex Levy wrote:
> On Wed, 2003-10-08 at 04:38, Christopher Armstrong wrote:
> > I think I know what's happening. Do a "netstat |grep twistd-web-pb".
> 
> On Wed, 2003-10-08 at 05:11, Alex Levy wrote: 
> > This is indeed what's happening.
> 
> I spoke too soon. It looks like the bug you mentioned occurs in
> UserDirectory; I'm not using that. I'm simply using ResourceSubscription
> and ResourcePublisher. Should I _not_ be doing this? Or is there another
> solution to the problem?

Well... You might be using it in a bad way. Are you creating a new
ResourceSubscription for every request? If you are, you need to
persist them, probably by using 

  r.putChild('name', resourceSubscription) 

where `r' is already a persistent resource.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From exarkun at intarweb.us  Wed Oct  8 10:46:21 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 8 Oct 2003 10:46:21 -0400
Subject: [Twisted-Python] hardcoded SIZE_LIMIT
In-Reply-To: <3747.1065602410@www48.gmx.net>
References: <3747.1065602410@www48.gmx.net>
Message-ID: <20031008144621.GA18389@intarweb.us>

On Wed, Oct 08, 2003 at 10:40:10AM +0200, Christoph Wiedemann wrote:
> Hello,
> 
> i'm trying to use PB for remote procedure calls in the context of numeric
> computations. So far things work really well (Twisted is a real cool piece of
> software!), but now i'm trapped by twisted.spread.banana.SIZE_LIMIT. I need to
> send pretty much data over the network (~512 MB) and tried out to set the
> SIZE_LIMIT to 640 MB. Hmm, still getting the "String too long exception", cause
> the 640 kB are hardcoded in cBanana.c. Any chances to make the limit
> configurable ?
> 

  Check out twisted.spread.util.StringPager -- it uses the Producer/Consumer
pattern to send the string a piece at a time.  This will reduce memory usage
and probably increase network performance, since smaller chunks are being
serialized and transmitted only once the network is ready for them.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031008/42b0a2ed/attachment.pgp 

From exarkun at twistedmatrix.com  Wed Oct  8 10:59:19 2003
From: exarkun at twistedmatrix.com (Jp Calderone)
Date: Wed, 8 Oct 2003 10:59:19 -0400
Subject: [Twisted-Python] Re: Twisted.Names question
In-Reply-To: <3F81BEAF.1060500@pandora.be>
References: <3F814C0A.8090704@pandora.be> <20031006135854.GA12361@intarweb.us> <3F81BEAF.1060500@pandora.be>
Message-ID: <20031008145919.GA18421@intarweb.us>

On Mon, Oct 06, 2003 at 09:12:47PM +0200, Rudy Schockaert wrote:
> [snip]
>
> I think it may help when I explain the problem.
>
 > There are a number of rather large organisations that each have their 
> own connection to the Internet. Besides this they are also connected to 
> a private WAN.
>
> The WAN provider wants to offer a kind of secure mail, in the sense that 
> email between these organisations is not routed over the Internet but 
> over the WAN. All traffic over the WAN is IPSec, thus secure.
> Reconfiguring all mail relay servers of all those organisations is an 
> impossible task and certainly not maintainable.
> The zone definitions for each of the organisations must remain 
> unchanged, other organisations must recieve the normal Internet address 
> as result on a MX query.
>
> The plan is to have a Twisted.Names server with only two caches and no 
> authorative zones or forwarders. The first cache will be preloaded with 
> MX records and A records that route the mail over the WAN. There will be 
> nothing in CacheResolver.cancel() so these entries are never removed. 
> When the records are served, they will be put in the last cache and stay 
> there for as long as the TTL dictates. This way I can override DNS 
> records without creating an authorative zone.
>
> Each organisation would have such a Twisted. Names server on 'the way 
> out'. The preloaded cache would then be synchronised with a centrally 
> managed Master Twisted.server.
> 
> Now, I proposed to have Twisted.Names forward queries it cannot resolv 
> itself  to the internet, but that seems unacceptable. They want that all 
> other queries are directly resolved by Internet DNS servers. They also 
> want the Master Twisted.Names server to act as a backup in case the 
> slave of the company is down or so. But on the other hand they don't 
> want all queries first sent to both Twisted.Names servers and only then 
> to the Internet. So they proposed to return referrals for each record 
> that is not in Twisted.Names.
> 

  This sounds like a complex problem, and I am by no means an expert,
however, I'll take a stab...

  Returning NS records of the authority for unhandled names is something
t.names doesn't support.  It should not be difficult to add, though.  This
would probably be done by creating a new kind of Resolver, once that just
looked up and return NS records, regardless of query type, and putting it at
the back of the resolver chain.

  Aside from implementing this, everything else for the scenario you
describe is probably already supported, the trick is just configuring all
the pieces properly.

  So, you probably want just two resolvers in a ResolverChain, in a server
running on the internal interface of each of these networks (I'm not sure if
this would be the WAN network, or a private network for each participating
organisation).  The first resolver would be your preloaded CacheResolver,
the second would be the new NS resolver described above.  Arguably the NS
resolver should be present in t.names for it to be a proper nameserver
anyway... but that is a different discussion :)

  I'm not sure I've said anything insightful, but I hope it helps.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031008/77f3f416/attachment.pgp 

From itamar at itamarst.org  Wed Oct  8 12:09:50 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 12:09:50 -0400
Subject: [Twisted-Python] Woven subpage handling redirect deferred,
 Help!?!
In-Reply-To: <uk77gdrwg.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no>
	<20031006135553.GA1103@radii>
	<u3ce5lacw.fsf@inout.no>
	<3F830BA2.6080505@twistedmatrix.com>
	<uk77gdrwg.fsf@inout.no>
Message-ID: <20031008120950.6ad210bb.itamar@itamarst.org>

On 08 Oct 2003 11:01:51 +0200
Syver Enstad <syver at inout.no> wrote:

> Is there an upgrade path for applications that use the old cred
> system? What has to change in an application that usess old cred to
> use the new cred?

Not really. On the other hand I've ported some code and it was quite
easy.

The change is to get rid of perspectives/identities/authorizers/services
are authentication building blocks, since they don't make sense at all.

Instead you have:
1. avatar - business logic for specific user (in PB these are
perspectives, in pop3 these are mailboxes, etc..)
2. realm - stores avatars and perhaps general business logic (kinda like
services in old cred.)
3. credentials - a username/password, public key, something
4. credential checker - where authentication actually happens
5. portal - glues credential checkers and realms together.

So for example in pop3, you create a realm that serves mailbox avatars
based on an avatar id. You wrap this realm in a portal, and add a
credential checker that authenticates username/passwords against
/etc/passwd, and register this portal with the pop3 protocol.

When someone logins, the pop3 protocol creates a credential object,
hands it to the portal, and asks for IMailbox. Portal passes credentials
to credential checker, gets back avatar id, passes avatar id to realm,
gets mailbox, returns it to user.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Wed Oct  8 12:16:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 12:16:15 -0400
Subject: [Twisted-Python] pb.Referenceable: wxPython client crash and
 server exceptions
In-Reply-To: <3F827D75.70803@is.lg.ua>
References: <3F827D75.70803@is.lg.ua>
Message-ID: <20031008121615.310c0ce7.itamar@itamarst.org>

On Tue, 07 Oct 2003 11:46:45 +0300
Ruslan Spivak <alienoid at is.lg.ua> wrote:

> Clients connect to server and passes their pb.Referenceable. Server 
> every minute calls clients remote methods.
> After 8-9 hours of continuous work client crashes(it's compiled into 
> windows .exe with py2exe) and in my twistd.log i see such lines:

Add the tracebacks from server side (there may be one or two) to the bug
tracker. With only this traceback I really have no idea :( Hopefully
there is more info on the server's logs.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From justinjohnson at fastmail.fm  Wed Oct  8 13:52:30 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 08 Oct 2003 11:52:30 -0600
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <20031008120950.6ad210bb.itamar@itamarst.org>
References: <ud6dalbwx.fsf@inout.no>
 	<20031006135553.GA1103@radii>
 	<u3ce5lacw.fsf@inout.no>
 	<3F830BA2.6080505@twistedmatrix.com>
 	<uk77gdrwg.fsf@inout.no> <20031008120950.6ad210bb.itamar@itamarst.org>
Message-ID: <20031008175230.A9B6F39AB3@www.fastmail.fm>

Are you saying Avatars should be used instead of Perspectives?  I have a
PB service with a bunch of perspective_* methods.  I'm now trying to add
a web interface that has certain levels of privileges associated with the
logins.  Currently it would just be and Admin role and a normal User
role.  Do perspectives not fit into this anymore?



On Wed, 8 Oct 2003 12:09:50 -0400, "Itamar Shtull-Trauring"
<itamar at itamarst.org> said:
> On 08 Oct 2003 11:01:51 +0200
> Syver Enstad <syver at inout.no> wrote:
> 
> > Is there an upgrade path for applications that use the old cred
> > system? What has to change in an application that usess old cred to
> > use the new cred?
> 
> Not really. On the other hand I've ported some code and it was quite
> easy.
> 
> The change is to get rid of perspectives/identities/authorizers/services
> are authentication building blocks, since they don't make sense at all.
> 
> Instead you have:
> 1. avatar - business logic for specific user (in PB these are
> perspectives, in pop3 these are mailboxes, etc..)
> 2. realm - stores avatars and perhaps general business logic (kinda like
> services in old cred.)
> 3. credentials - a username/password, public key, something
> 4. credential checker - where authentication actually happens
> 5. portal - glues credential checkers and realms together.
> 
> So for example in pop3, you create a realm that serves mailbox avatars
> based on an avatar id. You wrap this realm in a portal, and add a
> credential checker that authenticates username/passwords against
> /etc/passwd, and register this portal with the pop3 protocol.
> 
> When someone logins, the pop3 protocol creates a credential object,
> hands it to the portal, and asks for IMailbox. Portal passes credentials
> to credential checker, gets back avatar id, passes avatar id to realm,
> gets mailbox, returns it to user.
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From itamar at itamarst.org  Wed Oct  8 14:46:42 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 14:46:42 -0400
Subject: [Twisted-Python] Cred and perspectives
In-Reply-To: <20031008175230.A9B6F39AB3@www.fastmail.fm>
References: <ud6dalbwx.fsf@inout.no>
	<20031006135553.GA1103@radii>
	<u3ce5lacw.fsf@inout.no>
	<3F830BA2.6080505@twistedmatrix.com>
	<uk77gdrwg.fsf@inout.no>
	<20031008120950.6ad210bb.itamar@itamarst.org>
	<20031008175230.A9B6F39AB3@www.fastmail.fm>
Message-ID: <20031008144642.3e6b99a4.itamar@itamarst.org>

On Wed, 08 Oct 2003 11:52:30 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> Are you saying Avatars should be used instead of Perspectives?  I have
> a PB service with a bunch of perspective_* methods.  I'm now trying to
> add a web interface that has certain levels of privileges associated
> with the logins.  Currently it would just be and Admin role and a
> normal User role.  Do perspectives not fit into this anymore?

For non-PB protocols, there are no longer perspectives (for pop3 the
avatar is a mailbox, there is no perspective). For PB, the avatar is a
perspective (typically a subclass of pb.Perspective).

Priviliges and roles are no longer cred's responsibility (the whole
"lets map x perspectives to an identity and stuff"). Write your own
system on top of it if you need to.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From miguel at yorku.ca  Wed Oct  8 14:58:10 2003
From: miguel at yorku.ca (Miguel Marques)
Date: Wed, 08 Oct 2003 14:58:10 -0400 (EDT)
Subject: [Twisted-Python] SSL client certificate verification...
Message-ID: <20031008.145810.122273519.miguel@yorku.ca>

Greetings...

I have a twisted application based on XMLRPC which uses SSL.  I need to
validate client certificates and then somehow retrieve the CN from the
peer certificate from the xmlrpc_* routines.  I've figured out so far
how to do certificate validation and that works fine. 

I'm having a bit of difficulty figuring out how to get the CN.  I'm
trying to get it from the twisted.web.server.Request passed to the
render method of xmlrpc.XMLRPC.  I suspect somewhere in there is the
OpenSSL Connection object I can call get_peer_certificate() on.
But I'm not sure where...
Any pointers in the right direction would be greatly appreciated.
TIA...

							Miguel

C. Miguel Marques, Development Services, Computing and Network Services, York University
e-mail: miguel at yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830




From uwe at oss4u.com  Wed Oct  8 15:29:05 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 8 Oct 2003 12:29:05 -0700
Subject: [Twisted-Python] hardcoded SIZE_LIMIT
In-Reply-To: <3747.1065602410@www48.gmx.net>
References: <3747.1065602410@www48.gmx.net>
Message-ID: <200310081229.05858.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


I asked the same thing a while back.
Actually from the way Twisted is designed it's a good thing to have the size 
limited. If you transfer large files in a return 
like in

x=file(large_file)
return x.read()

you might end up with a pretty sluggish twisted, specially in a heavy multi 
user environment. I switched to use the pager, which allows twisted to 
transfer the file at it's own pace, and allows you to put in a preogress 
dialog pretty easily since there is a callback on the chunks transmitted.
Go the extra mile to understand the pager - it's worth it in the long run.


On Wednesday 08 October 2003 01:40 am, Christoph Wiedemann wrote:
> Hello,
>
> i'm trying to use PB for remote procedure calls in the context of numeric
> computations. So far things work really well (Twisted is a real cool piece
> of software!), but now i'm trapped by twisted.spread.banana.SIZE_LIMIT. I
> need to send pretty much data over the network (~512 MB) and tried out to
> set the SIZE_LIMIT to 640 MB. Hmm, still getting the "String too long
> exception", cause the 640 kB are hardcoded in cBanana.c. Any chances to
> make the limit configurable ?
>
> Regards,
> Christoph
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

- -- 
	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/hGWBjqGXBvRToM4RAroSAKCGbcgQgbnMBCaZ8nRhussM+5zHnQCfQBCt
HqInqRFNkOGmxeRWWpkN3OY=
=wKyI
-----END PGP SIGNATURE-----




From itamar at itamarst.org  Wed Oct  8 15:49:42 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 15:49:42 -0400
Subject: [Twisted-Python] SSL client certificate verification...
In-Reply-To: <20031008.145810.122273519.miguel@yorku.ca>
References: <20031008.145810.122273519.miguel@yorku.ca>
Message-ID: <20031008154942.6c4264f0.itamar@itamarst.org>

On Wed, 08 Oct 2003 14:58:10 -0400 (EDT)
Miguel Marques <miguel at yorku.ca> wrote:

> I'm having a bit of difficulty figuring out how to get the CN.  I'm
> trying to get it from the twisted.web.server.Request passed to the
> render method of xmlrpc.XMLRPC.  I suspect somewhere in there is the
> OpenSSL Connection object I can call get_peer_certificate() on.
> But I'm not sure where...
> Any pointers in the right direction would be greatly appreciated.
> TIA...

request.channel.transport.getPeerCertificate() I think, except this
won't work for pipelining clients at the moment. Arguably auth should be
done when the client connects - you can do this with custom
ContextFactory that creates Contexts that do verification callback.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From miguel at yorku.ca  Wed Oct  8 16:59:37 2003
From: miguel at yorku.ca (Miguel Marques)
Date: Wed, 08 Oct 2003 16:59:37 -0400 (EDT)
Subject: [Twisted-Python] SSL client certificate verification...
In-Reply-To: <20031008154942.6c4264f0.itamar@itamarst.org>
References: <20031008.145810.122273519.miguel@yorku.ca>
	<20031008154942.6c4264f0.itamar@itamarst.org>
Message-ID: <20031008.165937.88655788.miguel@yorku.ca>

Greetings...
On Wed, 8 Oct 2003 15:49:42 -0400, Itamar Shtull-Trauring <itamar at itamarst.org> wrote:
> On Wed, 08 Oct 2003 14:58:10 -0400 (EDT)
> Miguel Marques <miguel at yorku.ca> wrote:
> 
> > I'm having a bit of difficulty figuring out how to get the CN.  I'm
> > trying to get it from the twisted.web.server.Request passed to the
> > render method of xmlrpc.XMLRPC.  I suspect somewhere in there is the
> > OpenSSL Connection object I can call get_peer_certificate() on.
> > But I'm not sure where...
> > Any pointers in the right direction would be greatly appreciated.
> > TIA...
> 
> request.channel.transport.getPeerCertificate() I think, except this
Thanks, request.channel.transport.socket.get_peer_certificate() did
the trick and things seem to work...

> won't work for pipelining clients at the moment. Arguably auth
> should be done when the client connects - you can do this with custom
> ContextFactory that creates Contexts that do verification callback.

Agreed,  except in this case each xmlrpc procedure has a list of CN's
allowed to call it, so I can only check the CN of the connection's
certificate against that, when I know which xmlrpc procedure they are
trying to call...  (I do use a custom ContextFactory to cause the
client certificate to be checked against my CA)

I've just started using Twisted and I'm not sure what you mean by
'won't work for pipelining clients'?
Could you explain?
Thanks!

							Miguel

C. Miguel Marques, Development Services, Computing and Network Services, York University
e-mail: miguel at yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830



From itamar at itamarst.org  Wed Oct  8 17:41:03 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 17:41:03 -0400
Subject: [Twisted-Python] SSL client certificate verification...
In-Reply-To: <20031008.165937.88655788.miguel@yorku.ca>
References: <20031008.145810.122273519.miguel@yorku.ca>
	<20031008154942.6c4264f0.itamar@itamarst.org>
	<20031008.165937.88655788.miguel@yorku.ca>
Message-ID: <20031008174103.2c4215d3.itamar@itamarst.org>

On Wed, 08 Oct 2003 16:59:37 -0400 (EDT)
Miguel Marques <miguel at yorku.ca> wrote:

> I've just started using Twisted and I'm not sure what you mean by
> 'won't work for pipelining clients'?
> Could you explain?
> Thanks!

Um. Actually never mind, this should work fine regardless. (For the
record pipelining means sending a series of requests without waiting for
responses in between.)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From alex at veresk.ru  Wed Oct  8 19:48:03 2003
From: alex at veresk.ru (Alexander Zhukov)
Date: Thu, 9 Oct 2003 03:48:03 +0400
Subject: [Twisted-Python] Web server persistance
In-Reply-To: <000601c38c3e$fa5ee590$6401a8c0@ISLAND>
References: <000601c38c3e$fa5ee590$6401a8c0@ISLAND>
Message-ID: <200310090348.04025.alex@veresk.ru>

? ????????? ?? 6 ??????? 2003 23:20 Ted Patrick ???????(a):
> I have a project using Twisted as an http server.
>
> What is the best way to persistent server data across server start/stop?
>
> Example:
> While the server is running, a user will add virtual directories via a .rpy
> application as follows:
>
> root.putChild(name, path)
>
> Ideally modifications to the server configuration would persist across
> server start/stop. I would also like a generic format to store data related
> to a particular leaf of an application as follows:
>
> //url  http://mytwisted/dog/cat/document.txt
> //data pertaining to this url could be added at
> root.dog.cat.document.txt = 33
>
> This data would also be persistent.
>

The simplest way is to use registry. There are some examples in 
http://www.twistedmatrix.com/documents/howto/using-twistedweb

Or you can use Cog - an object database written in python if you need advanced 
persistence options. http://www.itamarst.org/software/cog/
For an example you can have a look at StikiWiki code 
http://mithrandr.moria.org/code/stikiwiki/




From stuart.hungerford at anu.edu.au  Wed Oct  8 20:52:38 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Thu, 09 Oct 2003 10:52:38 +1000
Subject: [Twisted-Python] Woven page instances deferring to each
  other...
In-Reply-To: <20031008100002.21436.65621.Mailman@pyramid.twistedmatrix.c
 om>
References: <20031008100002.21436.65621.Mailman@pyramid.twistedmatrix.com>
Message-ID: <6.0.0.22.0.20031009104127.01ecb2a8@anusf.anu.edu.au>

Quoth twisted-python-request at twistedmatrix.com:

 >On Wed, Oct 08, 2003, Stuart Hungerford wrote:
 >> In another Woven page the application can detect these
 >> "error" states and I would like to optionally "defer" the HTML
 >> generation to the existing error pages:
 >
 >I *think* here you mean "I'd like totally different HTML generated if
 >there is an error state", rather than "my check for the error returns a
 >Deferred object". Let me know if I'm wrong.

    Quite right -- I did mean "totally different HTML", it was a poor
    choice of terms after too little thought ;-)

 >Assuming you meant "I'd like totally different HTML generated if
 >there is an error state" you probably do want macros or something like
 >them. The best documentation I've seen on this is here:
 >http://twistedmatrix.com/pipermail/twisted-python/2003-June/004662.html

    Thanks -- I'll check that out.

 >Followup...
 >
 >A nicer solution may be to have the parent Page (by this I mean
 >http://example.com/bob/ is a parent and http://example.com/bob/result/
 >is a child -- parents in the URL structure) do the check and return an
 >object of a different Page class, something like:
 >
 >class MyParentPage(page.Page):
 >
 >    def getDynamicChild(self, name, request):
 >
 >        if error_condition_1:
 >            return ErrorPage1()
 >        elif error_condition_2:
 >            return ErrorPage2()
 >        else:
 >            return NormalChildPage()
 >
 >If there's any way you can determine if the error has happened before
 >the child page starts rendering, then I suspect it would be nicer to do
 >the error check at child creation time, rather than when the child
 >renders.

    I can see the sense in this approach, but it does have the effect
    pushing implementation of business rules from the wvupdate_foo()
    functions into creation time checks.  Although, that may be a good
    thing, I haven't really got a feel yet for what constitutes "good"
    Twisted or Woven idioms.

 >[...]
 >Since woven renders the entire page before it calls request.write, any
 >portion of the view rendering code which detects an error is able to
 >call request.redirect (because we can still set headers since we
 >haven't written any of the body yet). Just thought I'd chuck that out
 >there, it may be totally irrelevant.

    This could also be very useful, as Mary points out, it gives us a
    choice of where the application logic can be based.

    Many thanks to all for the help!


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From snesbitt at cobaltgroup.com  Wed Oct  8 22:21:02 2003
From: snesbitt at cobaltgroup.com (Nesbitt, Steve)
Date: Wed, 8 Oct 2003 19:21:02 -0700 
Subject: [Twisted-Python] newbie: groking flows
Message-ID: <25160AB2660F8B449892B0EB9C29C165CE5612@ex-sea-is2.cobaltgroup.com>

All:

I'm trying to grok flows in general and how to mix cooperative and blocking
flows in particular. I've been reviewing the documentation and have a better
understanding, but something is still eluding me. I'm hoping someone can
help me out with either some pseudocode (or a real world example)

Here's my design problem:
When I start the server, I generate a series of lookup table objects (called
"registries") by parsing through a series of XML files. XML-RPC requests
come in requesting information and these registries are then used to help
fulfill the request. Periodically, albeit infrequently, one of the original
source XML files may change and an XML-RPC call will request that the
registries be updated/regenerated. During the regeneration process, which
can take multiple seconds, all lookup and additional regeneration requests
should block until completion of the regeneration. Once completed, blocked
requests should resume.

Based on my reading I think this is what should do:
1) Periodically during a lookup call a flow.Cooperate event to allow other
lookup events from other requests to be handled.

2) To avoid a regeneration event in the midst of a lookup, I should make
sure that a flow.Cooperate event is *not* issued at any time during a
critical part of the lookup process ( In other words one can consider the
code executed between two flow.Cooperate statements as a transaction)

3) When I start a regeneration event I should wrap the regeneration method
in a flow.Block controller.


So here are some specific questions:
1) Is my basic understanding correct? In particular am I guaranteed correct
behavior using the above outline?

2) Am I correct in believing that wrapping a method in flow.Block actually
executes the method? That is, the statement flow.Block( foo( bar ) )
   executes foo.bar immediately?

3) How do I access the results of flow.Block( foo( bar ) )? In particular
how do I see the return result or any exceptions tr\hrown by foo?

4) Am I correct in believing that while flow.Block( foo(bar) ) is executing
any incoming requests will be prevented from executing?

5) Is it possible to defer a blocking method? This covers the scenario where
two regeneration events occur within the same time frame.


Thanks in advance for the help and sorry for the length of the post. I'll be
glad to write thisx up as a how to if that would be helpful.


Thanks in advance for the help.

-steve

Stephen Nesbitt
Senior Configuration Management Engineer
The Cobalt Group
snesbitt at cobaltgroup.com






This e-mail transmission contains information intended only for the use of
the recipient(s) named above. Further, it contains information that may be
privileged and confidential. If you are not the intended recipient, you are
hereby notified that any dissemination, distribution, or copying of this
message (including any attachments) is strictly prohibited. If you have
received this e-mail in error, please notify the sender by reply e-mail and
then delete this message from your mail system. Thank you for your
compliance.



From justinjohnson at fastmail.fm  Thu Oct  9 13:10:30 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 09 Oct 2003 11:10:30 -0600
Subject: [Twisted-Python] guard.UsernamePasswordWrapper errback
Message-ID: <20031009171030.BA398133C0@www.fastmail.fm>

I got a woven login page working by copying
Twisted/sandbox/glyph/dynademo where guard.UsernamePasswordWrapper is
used.  In the dynademo example, if the password is entered incorrectly,
an error page displays as documented in the doc strings for
UsernamePasswordWrapper.  The problem is that it displays the error on a
new page.  I'd like to capture the error in an existing html file.  So I
added the errback argument as follows:

r = guard.SessionWrapper(guard.UsernamePasswordWrapper(p,
callback=dumbRedirect, errback=dumbRedirect))

This redirects me back to the main page.  Is there some sort of view or
model available signaling that an error occurred, which I could put in my
main page?  Something like:

<div view="login_error"/>

Is there a better way to do this?

Thanks.
-Justin



From cce at clarkevans.com  Thu Oct  9 15:14:30 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Thu, 9 Oct 2003 19:14:30 +0000
Subject: [Twisted-Python] newbie: groking flows
In-Reply-To: <25160AB2660F8B449892B0EB9C29C165CE5612@ex-sea-is2.cobaltgroup.com>
References: <25160AB2660F8B449892B0EB9C29C165CE5612@ex-sea-is2.cobaltgroup.com>
Message-ID: <20031009191430.GA91506@clarkevans.com>

On Wed, Oct 08, 2003 at 07:21:02PM -0700, Nesbitt, Steve wrote:
| During the regeneration process, which
| can take multiple seconds, all lookup and additional regeneration requests
| should block until completion of the regeneration. Once completed, blocked
| requests should resume.
| 
| Based on my reading I think this is what should do:
| 1) Periodically during a lookup call a flow.Cooperate event to allow other
| lookup events from other requests to be handled.

Right.

| 2) To avoid a regeneration event in the midst of a lookup, I should make
| sure that a flow.Cooperate event is *not* issued at any time during a
| critical part of the lookup process ( In other words one can consider the
| code executed between two flow.Cooperate statements as a transaction)

Right.

| 3) When I start a regeneration event I should wrap the regeneration method
| in a flow.Block controller.

flow.Block is primarly there for testing; I should remove it from
the public interface.  Basically, it does just that, it blocks
*everything* -- which is, of course, not what you want.

You should instead use flow.Deferred( <generator> ) to create
your data flows, when you run flow.Deferred it:

  1. schedules your generator to be run using reactor.callLater(0, ...)
     so, flow.Deferred returns almost immediately and does not run
     your code till the current code finishes running;

  2. for each time you return flow.Cooperate, it reschedules your
     generator to be executed later, ie, reactor.callLater(0, ...)

  3. after your generator finishes, the deferred that was created
     by flow.Deferred runs its callbacks; you should probably install
     an error handler here, ie  flow.Deferred(<generator)>.addErrback(...)

I hope this helps.

...

| 1) Is my basic understanding correct? In particular am I guaranteed correct
| behavior using the above outline?

You are close; s/flow.Block/flow.Deferred/

| 2) Am I correct in believing that wrapping a method in flow.Block actually
| executes the method? That is, the statement flow.Block( foo( bar ) )
|    executes foo.bar immediately?

Not immediately, but close enough (it is put on the reactor's queue
to be executed shortly)

| 3) How do I access the results of flow.Block( foo( bar ) )? In particular
| how do I see the return result or any exceptions tr\hrown by foo?

def good(results):
    print "good", results
def bad(failure):
    print "bad", failure

d = flow.Deferred()
d.addCallback(good)
d.addErrback(bad)


...

If you _really_ want to use flow.Block, then flow.Block executes
the function immediately and returns a list containing the results.

| 4) Am I correct in believing that while flow.Block( foo(bar) ) is executing
| any incoming requests will be prevented from executing?

For flow.Block, yes.  For flow.Deferred, no.

| 5) Is it possible to defer a blocking method? This covers the scenario where
| two regeneration events occur within the same time frame.

Yes, use flow.Deferred  

To handle your case where there is a "regeneration" happening,
suppose you have a object 'gList' which gets regenerated periodically.
Your generator could do...

   def gen():
       while gList.generating():
           yield flow.Cooperate()
       # access the gList that is not generating

Best,

Clark 



From syver-en at online.no  Thu Oct  9 18:01:17 2003
From: syver-en at online.no (Syver Enstad)
Date: 10 Oct 2003 00:01:17 +0200
Subject: [Twisted-Python] resource navigation
Message-ID: <usmm2rryq.fsf@online.no>

Let's say I have a hierarchy of resources like this:

grandparent
  parent1
  parent2
     child1
     child2
        grandchild

Is there an easy way to know at runtime what url goes to let's say
parent2? I am interested primarily because I am interested in having
as self contained page classes as possible and hardcoding links to
parent2 in grandchilds view template seems brittle.

Woven seems to be strangely symetric regarding models and pages. An
example is getChild / getSubmodel and on top of that wchild_ /
wmfactory_. The woven model framwork supports asking parents of a
model if a submodel name can't be found, it might be interesting to
have something similar for resources so that one can have link's on a
child page that will be resolved by the parent.


-- 

Vennlig hilsen 

Syver Enstad




From justinjohnson at fastmail.fm  Fri Oct 10 09:37:04 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 10 Oct 2003 07:37:04 -0600
Subject: [Twisted-Python] woven dynamic table cell updating
Message-ID: <20031010133704.DFD953E3B7@www.fastmail.fm>

I have some code (attached ui.py) that creates a table displaying results
of running tasks.  The rows are tasks and the columns are step numbers in
that task.  I use this table when I make a bunch of requests into PB
servers running on multiple machines.  As those tasks move forward, the
PB server calls back into the client (which has a perspective_* method)
to update the status of that task/step.  An 'I' appears for 'in
progress', 'S' for 'success', and 'F' for 'failure'.  If there are
failures, I display the details once the entire table is populated and
all tasks are complete.

      | 1 | 2 | 3 | 4 | 5 | status
--------------------------------------
task1 | S | S | S | S | S | success
--------------------------------------
task2 | S | S | I | I | I | in progress
--------------------------------------
task3 | S | S | I | I | I | in progress
--------------------------------------
task4 | S | S | I | I | I | in progress
--------------------------------------
task5 | I | I | I | I | I | in progress
--------------------------------------

In the console based version each time the PB server task calls back into
the client to update the status, it also requests that the client
redisplay the screen.  So the screen redraws quite often.  Does anyone
know how I could do something similar with woven?  My thought was that
this will require LivePage, but I'm not sure.  Anyone have any
thoughts/suggestions?  I've attached (in widgets.py) my first attempt at
porting the results table to woven.

Thank you.
-Justin

P.S.

To run the attached file, you'll need to get the following modules.

WConio: http://newcenturycomputers.net/projects/wconio.html

    Windows Console I/O
    1.5 or later.

anycons: http://newcenturycomputers.net/projects/anycons.html

    Simple Universal Console I/O
    1.1 or later.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ui.py
Type: application/unknown
Size: 4438 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031010/82e653e7/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: widgets.py
Type: application/unknown
Size: 4040 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031010/82e653e7/attachment-0001.bin 

From dp at twistedmatrix.com  Fri Oct 10 11:56:02 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 10 Oct 2003 11:56:02 -0400
Subject: [Twisted-Python] resource navigation
In-Reply-To: <usmm2rryq.fsf@online.no>
References: <usmm2rryq.fsf@online.no>
Message-ID: <3FC01D1A-FB3A-11D7-A3F0-000A95864FC4@twistedmatrix.com>

On Oct 9, 2003, at 6:01 PM, Syver Enstad wrote:

>
> Let's say I have a hierarchy of resources like this:
>
> grandparent
>   parent1
>   parent2
>      child1
>      child2
>         grandchild
>
> Is there an easy way to know at runtime what url goes to let's say
> parent2? I am interested primarily because I am interested in having
> as self contained page classes as possible and hardcoding links to
> parent2 in grandchilds view template seems brittle.

Indeed. I have been experimenting with techniques for making all the 
Resource subclasses in a resource tree ignorant of each other for a 
while. One useful technique, if your path segments have meaningful 
names, is to simply use request.prepath to build a view of links 
leading to the current object (or "breadcrumbs"):

def wvupdate_breadcrumbs(self, request, widget, data):
	l = lmx(widget)
	fullpath = '/' # let us assume our application is installed at the 
root of the webserver
	for pathsegment in request.prepath:
		fullpath += pathsegment + '/'
		l.a(href= fullpath).text(pathsegment)

But this is only useful for rendering immediate ancestors, and also the 
only text you can put in the anchor tag is the actual pathsegment which 
shows up in the URL.

> Woven seems to be strangely symetric regarding models and pages. An
> example is getChild / getSubmodel and on top of that wchild_ /
> wmfactory_. The woven model framwork supports asking parents of a
> model if a submodel name can't be found, it might be interesting to
> have something similar for resources so that one can have link's on a
> child page that will be resolved by the parent.

Woven models keep track of the parents they were looked up from using 
IModel wrappers, but Resources, being a significantly older API, do 
not. As I mentioned above, I have been experimenting with techniques in 
this area recently, and one of the ideas I have come up with is in 
Quotient. (Note that while the code is in Quotient, nothing actually 
uses it yet.)

To use this technique, you have to control getChild (or you could 
rewrite getChildForRequest -- but that's an exercise for the reader). 
The idea is to gather a list of all the objects that had a getChild 
called on them for a given request. Here's the trick:

class IObjectCrumbs(components.Interface):
     """An interface on the request which keeps track of the list
     objects that were involved in the url traversal process
     for this request.
     """

components.registerAdapter(lambda _: [], server.Request, IObjectCrumbs)

class MyPageSubclass(page.LivePage):
     def getChild(self, name, request):
         rv = page.LivePage.getChild(self, name, request) # substitute 
Page if you aren't using LivePage
         if name != '' or request.prepath == ['']:
             IObjectCrumbs(request).append(rv)
         return rv

Once you have installed this getChild on all of the Resource objects 
involved in your application's Resource tree, you can then at any point 
in the render process get an IObjectCrumbs adapter on the request to 
get the list of actual instances which correspond with the path 
segments in request.prepath. What you do with them is then up to you; 
the most obvious things that come to mind are asking the instances to 
render a nicely formatted anchor instead of using the pathsegment text 
in the breadcrumbs example above, and introspecting the instances to 
see which child names they are capable of rendering (which you will 
have to do in a fairly application-specific manner; because of 
getChild, it isn't possible to write a general solution which lists all 
valid child names for a given resource).

I'm still trying to find the best solution to this problem in Quotient, 
and it would be really great if we could get it to the point where we 
could provide a Widget which anyone could drop into any Page anywhere 
in the Resource tree, and it would render a nice tree of links the user 
can use to navigate, but we're probably quite a ways off from actually 
being able to do that in a sane manner.

dp




From justinjohnson at fastmail.fm  Fri Oct 10 12:08:34 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 10 Oct 2003 10:08:34 -0600
Subject: [Twisted-Python] woven dynamic table cell updating (w/ LivePage)
In-Reply-To: <20031010133704.DFD953E3B7@www.fastmail.fm>
References: <20031010133704.DFD953E3B7@www.fastmail.fm>
Message-ID: <20031010160834.9DA1E3DDE4@www.fastmail.fm>

I decided to use images to display the status, and then have a server
side event send javascript to the page to change the src attribute of the
images.

I got the table displaying properly, and setup the following event
handler so that when I click a specific link, the server sends javascript
to the page to change the image src:

class MyEventHandler(input.Anything):
    def initialize(self):
        self.view.addEventHandler("onclick", self.onClick)
    
    def onClick(self, request, widget):
        currentPage = request.getSession(interfaces.IWovenLivePage)
         
        script = """
        document.images.task1_step1.src = "/images/S.gif" 
        """
        currentPage.sendScript(script)
        print self, "CLICKED!!!"

I verified that the image has a name attribute set to task1_step1.  When
I click, the javascript is sent, but I get the following javascript
error:

Error: 'document.images.task1_step1 is null or not an object

I tried using document.images[0].src instead, and got a similar error:

Error: 'document.images.0' is null or not an object

Do I have to do something goofy to reference things with javascript when
it is sent using LivePage?

Thanks again for answering my numerous questions.
-Justin


On Fri, 10 Oct 2003 07:37:04 -0600, "Justin Johnson"
<justinjohnson at fastmail.fm> said:
> I have some code (attached ui.py) that creates a table displaying results
> of running tasks.  The rows are tasks and the columns are step numbers in
> that task.  I use this table when I make a bunch of requests into PB
> servers running on multiple machines.  As those tasks move forward, the
> PB server calls back into the client (which has a perspective_* method)
> to update the status of that task/step.  An 'I' appears for 'in
> progress', 'S' for 'success', and 'F' for 'failure'.  If there are
> failures, I display the details once the entire table is populated and
> all tasks are complete.
> 
>       | 1 | 2 | 3 | 4 | 5 | status
> --------------------------------------
> task1 | S | S | S | S | S | success
> --------------------------------------
> task2 | S | S | I | I | I | in progress
> --------------------------------------
> task3 | S | S | I | I | I | in progress
> --------------------------------------
> task4 | S | S | I | I | I | in progress
> --------------------------------------
> task5 | I | I | I | I | I | in progress
> --------------------------------------
> 
> In the console based version each time the PB server task calls back into
> the client to update the status, it also requests that the client
> redisplay the screen.  So the screen redraws quite often.  Does anyone
> know how I could do something similar with woven?  My thought was that
> this will require LivePage, but I'm not sure.  Anyone have any
> thoughts/suggestions?  I've attached (in widgets.py) my first attempt at
> porting the results table to woven.
> 
> Thank you.
> -Justin
> 
> P.S.
> 
> To run the attached file, you'll need to get the following modules.
> 
> WConio: http://newcenturycomputers.net/projects/wconio.html
> 
>     Windows Console I/O
>     1.5 or later.
> 
> anycons: http://newcenturycomputers.net/projects/anycons.html
> 
>     Simple Universal Console I/O
>     1.1 or later.



From dp at twistedmatrix.com  Fri Oct 10 12:19:10 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 10 Oct 2003 12:19:10 -0400
Subject: [Twisted-Python] woven dynamic table cell updating (w/ LivePage)
In-Reply-To: <20031010160834.9DA1E3DDE4@www.fastmail.fm>
References: <20031010133704.DFD953E3B7@www.fastmail.fm> <20031010160834.9DA1E3DDE4@www.fastmail.fm>
Message-ID: <7AD39831-FB3D-11D7-A3F0-000A95864FC4@twistedmatrix.com>

On Oct 10, 2003, at 12:08 PM, Justin Johnson wrote:

> Do I have to do something goofy to reference things with javascript 
> when
> it is sent using LivePage?

'document' in the context of a clientToServer event is the IFrame in 
which the event was sent to the server. So I believe the correct way to 
reference things would be through parent.document.

dp




From justinjohnson at fastmail.fm  Fri Oct 10 12:29:08 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 10 Oct 2003 10:29:08 -0600
Subject: [Twisted-Python] woven dynamic table cell updating (w/ LivePage)
In-Reply-To: <7AD39831-FB3D-11D7-A3F0-000A95864FC4@twistedmatrix.com>
References: <20031010133704.DFD953E3B7@www.fastmail.fm> <20031010160834.9DA1E3DDE4@www.fastmail.fm> <7AD39831-FB3D-11D7-A3F0-000A95864FC4@twistedmatrix.com>
Message-ID: <20031010162908.2EDC13E40E@www.fastmail.fm>

Great!  It works now.  Thank you much.

On Fri, 10 Oct 2003 12:19:10 -0400, "Donovan Preston"
<dp at twistedmatrix.com> said:
> 
> On Oct 10, 2003, at 12:08 PM, Justin Johnson wrote:
> 
> > Do I have to do something goofy to reference things with javascript 
> > when
> > it is sent using LivePage?
> 
> 'document' in the context of a clientToServer event is the IFrame in 
> which the event was sent to the server. So I believe the correct way to 
> reference things would be through parent.document.
> 
> dp
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From justinjohnson at fastmail.fm  Fri Oct 10 16:18:45 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 10 Oct 2003 14:18:45 -0600
Subject: [Twisted-Python] woven dynamic table cell updating (w/ LivePage)
In-Reply-To: <20031010162908.2EDC13E40E@www.fastmail.fm>
References: <20031010133704.DFD953E3B7@www.fastmail.fm> <20031010160834.9DA1E3DDE4@www.fastmail.fm> <7AD39831-FB3D-11D7-A3F0-000A95864FC4@twistedmatrix.com> <20031010162908.2EDC13E40E@www.fastmail.fm>
Message-ID: <20031010201845.925763D4AD@www.fastmail.fm>

Another question related to this.

Each cell in the table gets its image name from dict[task][step], where
task corresponds to a row and step corresponds to a column.  So if
dict[task][status] = 'S', then I send the javascript to the browser to
change the img src to be "/images/S.gif" for that cell.

Is there any way to add an event handler or some such thing to the model
(that being the dict) so that everytime a new status is entered, the
javascript gets sent to the browser and the correct image is displayed?

I saw the notify method, but didn't see any examples of it in action.

Thanks.
-Justin


On Fri, 10 Oct 2003 10:29:08 -0600, "Justin Johnson"
<justinjohnson at fastmail.fm> said:
> Great!  It works now.  Thank you much.
> 
> On Fri, 10 Oct 2003 12:19:10 -0400, "Donovan Preston"
> <dp at twistedmatrix.com> said:
> > 
> > On Oct 10, 2003, at 12:08 PM, Justin Johnson wrote:
> > 
> > > Do I have to do something goofy to reference things with javascript 
> > > when
> > > it is sent using LivePage?
> > 
> > 'document' in the context of a clientToServer event is the IFrame in 
> > which the event was sent to the server. So I believe the correct way to 
> > reference things would be through parent.document.
> > 
> > dp
> > 
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From alienoid at is.lg.ua  Sun Oct 12 16:18:59 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Sun, 12 Oct 2003 23:18:59 +0300
Subject: [Twisted-Python] disabling/resuming connections
Message-ID: <3F89B733.7000408@is.lg.ua>

Hello.

Is it possible programmatically tell my server to stop accept 
connections from remote clients and then enable it programmatically when 
i need?

I use PB based server.

Thanks in advance.

Best regards,
Ruslan




From exarkun at intarweb.us  Sun Oct 12 16:33:05 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 12 Oct 2003 16:33:05 -0400
Subject: [Twisted-Python] disabling/resuming connections
In-Reply-To: <3F89B733.7000408@is.lg.ua>
References: <3F89B733.7000408@is.lg.ua>
Message-ID: <20031012203305.GA25395@intarweb.us>

On Sun, Oct 12, 2003 at 11:18:59PM +0300, Ruslan Spivak wrote:
> Hello.
> 
> Is it possible programmatically tell my server to stop accept 
> connections from remote clients and then enable it programmatically when 
> i need?
> 
> I use PB based server.
> 

  If you are using PBServerFactory, it is easy --


    f = PBServerFactory(...)
    port = reactor.listenTCP(..., f)
    ...
    port.stopListening()
    ...
    port.startListening()
    ...


  If you're using the old PB API, I'm not sure how you'd do it.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031012/4f97f3bf/attachment.pgp 

From syver-en at online.no  Sun Oct 12 16:52:18 2003
From: syver-en at online.no (Syver Enstad)
Date: 12 Oct 2003 22:52:18 +0200
Subject: [Twisted-Python] Rendering woven pages offline.
Message-ID: <uekxi2n7h.fsf@online.no>

I need to send a mail containing a woven page. Is it easy to setup
rendering the page offline rather than to an HTTP request?

-- 

Vennlig hilsen 

Syver Enstad




From dp at twistedmatrix.com  Sun Oct 12 18:53:35 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Sun, 12 Oct 2003 18:53:35 -0400
Subject: [Twisted-Python] Rendering woven pages offline.
In-Reply-To: <uekxi2n7h.fsf@online.no>
References: <uekxi2n7h.fsf@online.no>
Message-ID: <E9219B7B-FD06-11D7-BA74-000A95864FC4@twistedmatrix.com>

On Oct 12, 2003, at 4:52 PM, Syver Enstad wrote:

>
> I need to send a mail containing a woven page. Is it easy to setup
> rendering the page offline rather than to an HTTP request?

Yep, pretty easy. Just pass in a fake request to render, and capture 
the string passed to request.write. There is an example of doing this 
in test_woven. If you need more help, lemme know.

dp




From itamar at itamarst.org  Mon Oct 13 01:02:34 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 13 Oct 2003 01:02:34 -0400
Subject: [Twisted-Python] Status of 1.1 release
Message-ID: <20031013010234.054e4358.itamar@itamarst.org>

1. PB docs are half done, radix is working on them.
2. Cred docs are mostly done, I will finish them.
3. Application docs are done, by moshez (though some extra explanations
won't hurt).

Remaining issues:
1. Services use in static registry (deleting code mainly)
2. Update manhole (and manhole and telnet howtos)
3. What to do with words
4. Document guard

Things I'd like to have:
1. Mac OS X reactor (hello bob!)
2. Updater haifux tutorial

There are issues in the bug tracker for all of these.

I am hoping to have 1.1 out by the end of the week, if we can continue
this momentum, but this is a lot more likely if more people pitch in.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From wilk-ml at flibuste.net  Mon Oct 13 17:21:38 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Mon, 13 Oct 2003 23:21:38 +0200
Subject: [Twisted-Python] jabber
Message-ID: <87ad84hlzx.fsf@blakie.riol#flibuste.net>

Hi,

Is there any example of using jabber ?

I would like just to make a litle jabber client...

Thanks

-- 
William Dod? - http://flibuste.net



From bob at redivi.com  Mon Oct 13 18:25:39 2003
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 13 Oct 2003 18:25:39 -0400
Subject: [Twisted-Python] Twisted's cfreactor + PyObjC = Asynchronous Networking on OS X
Message-ID: <2C8A3280-FDCC-11D7-81D1-000A95686CD8@redivi.com>

For those of you who don't watch Twisted CVS, cfreactor is officially 
out of the sandbox.  cfreactor is the CoreFoundation integration 
reactor for Twisted ( http://www.twistedmatrix.com/ ), which means that 
you can now seamlessly integrate Cocoa and Twisted (without digging 
around in my sandbox, that is).

If you're running OS X and you'd like to play with cfreactor, check out 
the latest CVS and do a python setup.py install (so that it can build 
twisted/internet/cfsupport.so -- ignore the warnings, they are expected 
for Pyrex modules).  There are two examples provided in 
doc/examples/Cocoa.  You will need PyObjC 1.0 (though it may work with 
earlier betas, you should upgrade if you haven't yet) and MacPython 2.3 
(not tested with Panther yet, but should work).  The next release 
version of Twisted, which is expected very shortly, will include this 
new reactor and updated documentation.  When it is released, it will 
also be available from my Package Manager repository ( 
http://undefined.org/python/pimp/ ).
	
	SimpleWebClient - Pretty much a straight port of 
doc/examples/qtdemo.py, a very simple app that downloads HTML and puts 
it in a text box.
	WebServicesTool - A Twisted port of b.bum's XML-RPC demo (which is 
included with PyObjC).  For fun, compare how much simpler the Twisted 
version is (since it doesn't need to deal with threads), and how much 
more responsive it feels.

To run either demo, use the buildapp.py script provided in the same 
folder as the application:
	python buildapp.py build

And then:
	open build/ApplicationName.app

Note that when using cfreactor you should *always* call reactor.run() 
while the NSRunLoop is in action (best place to put it is probably in 
your NSApplication delegate's applicationDidFinishLaunching_ method).  
If you're using threads, make sure to only call into Twisted from the 
main runLoop (which is where you have to do your drawing anyways).  And 
of course, you should cfreactor.install() before importing any other 
Twisted modules (see the "Choosing a Reactor and GUI Toolkit 
Integration" HOWTO for more information).

-bob




From dizzyd at jabber.org  Mon Oct 13 18:53:40 2003
From: dizzyd at jabber.org (Dave Smith)
Date: Mon, 13 Oct 2003 16:53:40 -0600
Subject: [Twisted-Python] jabber
In-Reply-To: <87ad84hlzx.fsf@blakie.riol#flibuste.net>
References: <87ad84hlzx.fsf@blakie.riol#flibuste.net>
Message-ID: <16C59931-FDD0-11D7-9CE7-00039386381C@jabber.org>

On Oct 13, 2003, at 3:21 PM, William Dode wrote:

> Hi,
>
> Is there any example of using jabber ?
>
> I would like just to make a litle jabber client...

I haven't yet had a chance to focus on the client aspect of Jabber 
support in twisted, but it is on my todo list for the next few days. 
I'll post when the support is in CVS, along with a basic example. :)

D.




From golux at comcast.net  Mon Oct 13 21:44:20 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Mon, 13 Oct 2003 21:44:20 -0400
Subject: [Twisted-Python] PB/wx example pbwxthingy
Message-ID: <3F8B54F4.50607@comcast.net>

Twisted Gurus,

For the 1.1 release, you might want to consider replacing the
old "wxdemo" example, which is pretty lame, with the really
cool wx-and-PB example posted to the list by Axel Busch on
Sept 20.  It works great and is an impressive example of
both PB and the application of Uwe Schroeder's recipe that
enables the use of the reactor within a wxPython app without
causing menus and modal dialogs to hang:

http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/181780

(There's also a nice docstring about the use of this in
pbwxthingy/client.py)

I've replaced the example's references to "Transport" (which
had nothing to do with network transports but was rather a
logistical application object) with "Thingy" so as to make the
example possibly less confusing in the context of the twisted
examples directory, and I've added a very brief README that
gives the basic procedure for running the example -- see attached.

Cheers,
Steve.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pbwxthingy.tar.gz
Type: application/x-tar
Size: 11836 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031013/f66236ba/attachment.tar 

From andrew-twisted at puzzling.org  Mon Oct 13 22:14:38 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 14 Oct 2003 12:14:38 +1000
Subject: [Twisted-Python] Status of 1.1 release
In-Reply-To: <20031013010234.054e4358.itamar@itamarst.org>
References: <20031013010234.054e4358.itamar@itamarst.org>
Message-ID: <20031014021438.GB7341@frobozz>

On Mon, Oct 13, 2003 at 01:02:34AM -0400, Itamar Shtull-Trauring wrote:
> 
> Remaining issues:
> 1. Services use in static registry (deleting code mainly)
> 2. Update manhole (and manhole and telnet howtos)
> 3. What to do with words
> 4. Document guard

5. Intermittent buildbot failures for full-2.3 and freebsd buildslaves,
   e.g.:
       http://twistedmatrix.com/buildbot/full-2.3/events/486/summary
       http://twistedmatrix.com/buildbot/freebsd/events/422/summary

-Andrew.




From jonathan at embassynetworks.com  Tue Oct 14 05:05:17 2003
From: jonathan at embassynetworks.com (Jonathan Simms)
Date: Tue, 14 Oct 2003 05:05:17 -0400
Subject: [Twisted-Python] Woven Tutorial alpha is up for review
Message-ID: <20031014090517.GA23599@willie-the-pimp>

Hello all,

I've put together a tutorial on using Woven that is geared towards new
users, and I'm making it available for your edification (and critique).
I'm still working on it, but I'd say it's about 85% complete. You can
view it at:

http://www.embassynetworks.com/woven-tut/toc.xhtml


As of this moment, the program is not in a downloadable state 
(as I've got to re-arrange my source tree), but as soon as it is, I'll
make it available. 



Thanks, and enjoy!

 -Jonathan Simms (slyphon)


---
"Outside of the dog, a book is man's best friend,
Inside of the dog it's too dark to read."

                    -Groucho Marx


Jonathan Simms
jonathan at embassynetworks dot com




From wilk-ml at flibuste.net  Tue Oct 14 05:17:09 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Tue, 14 Oct 2003 11:17:09 +0200
Subject: [Twisted-Python] jabber
In-Reply-To: <16C59931-FDD0-11D7-9CE7-00039386381C@jabber.org> (Dave Smith's
 message of "Mon, 13 Oct 2003 16:53:40 -0600")
References: <87ad84hlzx.fsf@blakie.riol#flibuste.net>
	<16C59931-FDD0-11D7-9CE7-00039386381C@jabber.org>
Message-ID: <877k38mb56.fsf@blakie.riol#flibuste.net>

Dave Smith <dizzyd at jabber.org> writes:

> On Oct 13, 2003, at 3:21 PM, William Dode wrote:
>
>> Hi,
>>
>> Is there any example of using jabber ?
>>
>> I would like just to make a litle jabber client...
>
> I haven't yet had a chance to focus on the client aspect of Jabber
> support in twisted, but it is on my todo list for the next few
> days. I'll post when the support is in CVS, along with a basic
> example. :)

thanks in advance, i'll test it...

-- 
William Dod? - http://flibuste.net



From syver at inout.no  Tue Oct 14 08:31:27 2003
From: syver at inout.no (Syver Enstad)
Date: 14 Oct 2003 14:31:27 +0200
Subject: [Twisted-Python] Twisted file upload
Message-ID: <u8ynoq9uo.fsf@inout.no>

If there is a better way to get the filename of a posted file than the
code below, please tell me:

        """ this is a workaround because
        twisted web doesn't make the filename accessible
        on a form with enctype='multipart/form-data'
        
        """

        savedPosition = request.content.tell()
        try:
            request.content.seek(0)
            request.content.readline()
            match = re.search(r'filename="([^"]+)"',
                              request.content.readline())
            if match:
                return match.group(1)
            else:
                return None
        finally:
            request.content.seek(savedPosition)





From brian_l at mac.com  Mon Oct 13 23:24:13 2003
From: brian_l at mac.com (Brian Lenihan)
Date: Mon, 13 Oct 2003 20:24:13 -0700
Subject: [Twisted-Python] Re: [Pythonmac-SIG] Twisted's cfreactor + PyObjC = Asynchronous	Networking on OS X
In-Reply-To: <2C8A3280-FDCC-11D7-81D1-000A95686CD8@redivi.com>
References: <2C8A3280-FDCC-11D7-81D1-000A95686CD8@redivi.com>
Message-ID: <E26B1460-FDF5-11D7-A248-000A95841920@mac.com>

On Oct 13, 2003, at 3:25 PM, Bob Ippolito wrote:

> For those of you who don't watch Twisted CVS, cfreactor is officially 
> out of the sandbox.  cfreactor is the CoreFoundation integration 
> reactor for Twisted ( http://www.twistedmatrix.com/ ), which means 
> that you can now seamlessly integrate Cocoa and Twisted (without 
> digging around in my sandbox, that is).

This is really nice.  And the demos really are much more responsive.  
Nice work.




From justinjohnson at fastmail.fm  Tue Oct 14 09:49:11 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 14 Oct 2003 07:49:11 -0600
Subject: [Twisted-Python] woven and a web server in my plugin?
Message-ID: <20031014134911.CAB0B3EA8E@www.fastmail.fm>

I have a woven app I'm working on.  I used to use 'mktap web' to have
twisted serve the app, but I also need to start a PB server, so I created
a plugin.  The problem I'm having now is that I don't get the built-in
functionality of the web server, like serving out things like a
stylesheet in /templates/style.css, or images in /images.

Is there anyway to have my own plugin which adds the same functionality
as the web server so I don't have to write code to handle all of that?

What is the recommended way to handle this?

I've attached tap.py and login.py, 2 files that kinda show what I'm doing
now.  The code is mostly copied and modifed from Quotient.

Thanks.
-Justin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tap.py
Type: application/unknown
Size: 2584 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031014/a063c021/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: login.py
Type: application/unknown
Size: 2495 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031014/a063c021/attachment-0001.bin 

From andrew-twisted at puzzling.org  Tue Oct 14 10:01:16 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 15 Oct 2003 00:01:16 +1000
Subject: [Twisted-Python] woven and a web server in my plugin?
In-Reply-To: <20031014134911.CAB0B3EA8E@www.fastmail.fm>
References: <20031014134911.CAB0B3EA8E@www.fastmail.fm>
Message-ID: <20031014140116.GC11090@frobozz>

On Tue, Oct 14, 2003 at 07:49:11AM -0600, Justin Johnson wrote:
> I have a woven app I'm working on.  I used to use 'mktap web' to have
> twisted serve the app, but I also need to start a PB server, so I created
> a plugin.  The problem I'm having now is that I don't get the built-in
> functionality of the web server, like serving out things like a
> stylesheet in /templates/style.css, or images in /images.
> 
> Is there anyway to have my own plugin which adds the same functionality
> as the web server so I don't have to write code to handle all of that?
> 
> What is the recommended way to handle this?

I'd call twisted.tap.web.makeService (or updateApplication, if you're not
using CVS...) -- that's what 'mktap web' does, after all :)

-Andrew.




From radix at twistedmatrix.com  Tue Oct 14 09:11:15 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 14 Oct 2003 09:11:15 -0400
Subject: [Twisted-Python] woven and a web server in my plugin?
In-Reply-To: <20031014134911.CAB0B3EA8E@www.fastmail.fm>
References: <20031014134911.CAB0B3EA8E@www.fastmail.fm>
Message-ID: <20031014131115.GA1615@twistedmatrix.com>

On Tue, Oct 14, 2003 at 07:49:11AM -0600, Justin Johnson wrote:
> I have a woven app I'm working on.  I used to use 'mktap web' to have
> twisted serve the app, but I also need to start a PB server, so I created
> a plugin.  The problem I'm having now is that I don't get the built-in
> functionality of the web server, like serving out things like a
> stylesheet in /templates/style.css, or images in /images.
> 
> Is there anyway to have my own plugin which adds the same functionality
> as the web server so I don't have to write code to handle all of that?

you want twisted.web.static.File, that's what a --path webserver uses.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From lupien_v_31 at hotmail.com  Tue Oct 14 10:22:53 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Tue, 14 Oct 2003 14:22:53 +0000
Subject: [Twisted-Python] Dynamic form with twisted
Message-ID: <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>

I really need help.

I want to make a form dynamically. I don't want to use FormProcess and I do 
not understand very well how it works.  If someone have documentation on 
forms (not the one on twisted matrix), it will be appreciated.

Vicky

_________________________________________________________________
MSN Messenger : discutez en direct avec vos amis !  
http://messenger.fr.msn.ca/




From glyph at twistedmatrix.com  Tue Oct 14 11:15:44 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 14 Oct 2003 11:15:44 -0400
Subject: [Twisted-Python] Dynamic form with twisted
In-Reply-To: <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>
References: <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>
Message-ID: <3F8C1320.8090408@twistedmatrix.com>

vicky lupien wrote:

> I want to make a form dynamically. I don't want to use FormProcess and I 
> do not understand very well how it works.  If someone have documentation 
> on forms (not the one on twisted matrix), it will be appreciated.

Twisted's layers are relatively well-factored internally.  If you don't 
like our dynamic form generation tools - and believe me, I know there 
are good reasons not to like them - you can still use the web server. 
You can easily write a form processor which uses request.args (a 
dictionary of HTTP form arguments) as input and produces HTML via 
request.write.

Your question seems a little vague, though: if you are looking for 
documentation on forms in general, consider a resource like

	http://www.ku.edu/~acs/docs/other/forms-intro.shtml

rather than this list.




From justinjohnson at fastmail.fm  Tue Oct 14 11:21:51 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 14 Oct 2003 09:21:51 -0600
Subject: [Twisted-Python] woven and a web server in my plugin?
In-Reply-To: <20031014131115.GA1615@twistedmatrix.com>
References: <20031014134911.CAB0B3EA8E@www.fastmail.fm> <20031014131115.GA1615@twistedmatrix.com>
Message-ID: <20031014152151.B4DE83D417@www.fastmail.fm>

This looks like what I need.  Thanks.

On Tue, 14 Oct 2003 09:11:15 -0400, "Christopher Armstrong"
<radix at twistedmatrix.com> said:
> On Tue, Oct 14, 2003 at 07:49:11AM -0600, Justin Johnson wrote:
> > I have a woven app I'm working on.  I used to use 'mktap web' to have
> > twisted serve the app, but I also need to start a PB server, so I created
> > a plugin.  The problem I'm having now is that I don't get the built-in
> > functionality of the web server, like serving out things like a
> > stylesheet in /templates/style.css, or images in /images.
> > 
> > Is there anyway to have my own plugin which adds the same functionality
> > as the web server so I don't have to write code to handle all of that?
> 
> you want twisted.web.static.File, that's what a --path webserver uses.
> 
> 
> -- 
>  Twisted | Christopher Armstrong: International Man of Twistery
>   Radix  |          Release Manager,  Twisted Project
> ---------+     http://twistedmatrix.com/users/radix.twistd/
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From itamar at itamarst.org  Tue Oct 14 12:16:33 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 14 Oct 2003 12:16:33 -0400
Subject: [Twisted-Python] Twisted file upload
In-Reply-To: <u8ynoq9uo.fsf@inout.no>
References: <u8ynoq9uo.fsf@inout.no>
Message-ID: <20031014121633.518f092b.itamar@itamarst.org>

On 14 Oct 2003 14:31:27 +0200
Syver Enstad <syver at inout.no> wrote:

> If there is a better way to get the filename of a posted file than the
> code below, please tell me:

Using some sort of MIME parsing code or some of the code in the cgi
module might be better. Long term solution involves total rewrite of
file upload support.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From lupien_v_31 at hotmail.com  Tue Oct 14 13:51:23 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Tue, 14 Oct 2003 17:51:23 +0000
Subject: [Twisted-Python] Dynamic form with twisted
Message-ID: <BAY1-F34HfqR77bieLY000098ad@hotmail.com>

Twisted's layers are relatively well-factored internally.  If you don't like 
our dynamic form generation tools - and believe me, I know there are good 
reasons not to like them - you can still use the web server. You can easily 
write a form processor which uses request.args (a dictionary of HTTP form 
arguments) as input and produces HTML via request.write.

Your question seems a little vague, though: if you are looking for 
documentation on forms in general, consider a resource like

	http://www.ku.edu/~acs/docs/other/forms-intro.shtml

rather than this list.

I'd love to use the generation tools  in twisted but I don't understant it 
and it's not well documented.
_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

_________________________________________________________________
MSN Search, le moteur de recherche qui pense comme vous !  
http://fr.ca.search.msn.com/




From lupien_v_31 at hotmail.com  Tue Oct 14 16:29:10 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Tue, 14 Oct 2003 20:29:10 +0000
Subject: [Twisted-Python] td() in form
Message-ID: <BAY1-F150Dd3OJXsNQp00000777@hotmail.com>

I want to add an attribute to the node td.  The name of the attribute is 
class, so it cause an error of syntax.

Here's a part of my code:

l = lmx(self)
l.td().text(name)


I' m suppose to write l.td(class='label').text(name) but I can't.  Is there 
a way to do this?

Vicky

_________________________________________________________________
MSN Search, le moteur de recherche qui pense comme vous !  
http://fr.ca.search.msn.com/




From itamar at itamarst.org  Tue Oct 14 16:44:28 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 14 Oct 2003 16:44:28 -0400
Subject: [Twisted-Python] td() in form
In-Reply-To: <BAY1-F150Dd3OJXsNQp00000777@hotmail.com>
References: <BAY1-F150Dd3OJXsNQp00000777@hotmail.com>
Message-ID: <20031014164428.39190f64.itamar@itamarst.org>

On Tue, 14 Oct 2003 20:29:10 +0000
"vicky lupien" <lupien_v_31 at hotmail.com> wrote:

> I' m suppose to write l.td(class='label').text(name) but I can't.  Is
> there a way to do this?

t = l.td()
t["class"] = "label"
t.text(name)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Tue Oct 14 17:04:53 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 14 Oct 2003 17:04:53 -0400
Subject: [Twisted-Python] td() in form
In-Reply-To: <20031014164428.39190f64.itamar@itamarst.org>
Message-ID: <0EE8D048-FE8A-11D7-8F46-000A95686CD8@redivi.com>

On Tuesday, Oct 14, 2003, at 16:44 America/New_York, Itamar 
Shtull-Trauring wrote:

> On Tue, 14 Oct 2003 20:29:10 +0000
> "vicky lupien" <lupien_v_31 at hotmail.com> wrote:
>
>> I' m suppose to write l.td(class='label').text(name) but I can't.  Is
>> there a way to do this?
>
> t = l.td()
> t["class"] = "label"
> t.text(name)

There's no underscore hack for Python's reserved words in lmx?

-bob




From stephen at thorne.id.au  Tue Oct 14 18:00:24 2003
From: stephen at thorne.id.au (Stephen Thorne)
Date: Wed, 15 Oct 2003 08:00:24 +1000
Subject: [Twisted-Python] td() in form
In-Reply-To: <0EE8D048-FE8A-11D7-8F46-000A95686CD8@redivi.com>
References: <0EE8D048-FE8A-11D7-8F46-000A95686CD8@redivi.com>
Message-ID: <3F8C71F8.8010608@thorne.id.au>

Bob Ippolito wrote:

> On Tuesday, Oct 14, 2003, at 16:44 America/New_York, Itamar 
> Shtull-Trauring wrote:
>
>> On Tue, 14 Oct 2003 20:29:10 +0000
>> "vicky lupien" <lupien_v_31 at hotmail.com> wrote:
>>
>>> I' m suppose to write l.td(class='label').text(name) but I can't.  Is
>>> there a way to do this?
>>
>>
>> t = l.td()
>> t["class"] = "label"
>> t.text(name)
>
>
> There's no underscore hack for Python's reserved words in lmx?
>
> -bob

There is the underscore hack too
l = lmx()
l.td(_class='label').text(name)
will work as well.

You can prefix an _ to any kwarg, so you can also have td(_import=''), 
td(_if='blah'), etc.

Regards,
Stephen Thorne




From itamar at itamarst.org  Tue Oct 14 23:24:07 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 14 Oct 2003 23:24:07 -0400
Subject: [Twisted-Python] Status of 1.1 release
In-Reply-To: <20031013010234.054e4358.itamar@itamarst.org>
References: <20031013010234.054e4358.itamar@itamarst.org>
Message-ID: <20031014232407.2267bc74.itamar@itamarst.org>

On Mon, 13 Oct 2003 01:02:34 -0400
Itamar Shtull-Trauring <itamar at itamarst.org> wrote:

> 2. Cred docs are mostly done, I will finish them.

Done.

> 1. Services use in static registry (deleting code mainly)

Done.

> 1. Mac OS X reactor (hello bob!)

Done.

As for the issues you raised, Andrew - add them to the tracker please.
Patches are even better ;)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From foom at fuhm.net  Wed Oct 15 01:21:30 2003
From: foom at fuhm.net (James Y Knight)
Date: Wed, 15 Oct 2003 01:21:30 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven models
Message-ID: <6ED10A50-FECF-11D7-B477-000A95A50FB2@fuhm.net>

I took dtuple.py (a wrapper that makes database results look like both 
a tuple and a dictionary simultaneously, which I found on the web) and 
wrapped it as a woven model, so you can use your database results and 
get submodels with both integer keys and column-name keys. It seems 
like it's probably useful to a bunch of people, so I'm making it 
available.

Currently living at:
http://www.ai.mit.edu/people/jknight/dtuple.py

Usage:
dbtupleize(curs, *args, **kw):
   Use this function as the argument to adbapi.runInteraction.

   E.g.:
   return dbpool.runInteraction(dbtupleize, "select * from table")

   It returns a DatabaseList of DatabaseTuples.

   A DatabaseList is just like a normal list execpt it has a getKeys()
   method.

   A DatabaseTuple is both a tuple and dictionary. If used as a tuple,
   it is ordered in the same order as the enclosing DatabaseList's
   getKeys() method.


   One use case is with a template like so:
       <table model="users" view="List">
	<tr pattern="listHeader" view="List" model="keys">
	  <th pattern="listItem" view="Text" model="."></th>
	</tr>
	<tr pattern="listItem" view="List" model=".">
	  <td pattern="listItem" view="Text" model="."></td>
	</tr>
     </table>

    and a model like:
       wmfactory_users(self, request):
         return dbpool.runInteraction(dbtupleize, "select * from users")

   Another is a template like:
        Userid: <span model="curuser/userid" view="Text" /><br>
        Email: <span model="curuser/email" view="Text" /><br>

    with a model like:
      wmfactory_curuser(self, request):
        return dbpool.runInteraction(dbtupleize, "select * from users 
where userid=%(self.curuserid)s", {'curuserid':self.curuserid})


As you can see from the comments in the file, it is doing a bit of 
excessive wrapping (wrapping a model around a dbtuple around the actual 
results), but since IMO woven models need a rewrite anyways, I'm not 
too concerned about integrating them more tightly into things at the 
moment, now that this works the way it is.

James




From golux at comcast.net  Wed Oct 15 01:50:49 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Wed, 15 Oct 2003 01:50:49 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven
 models
In-Reply-To: <6ED10A50-FECF-11D7-B477-000A95A50FB2@fuhm.net>
References: <6ED10A50-FECF-11D7-B477-000A95A50FB2@fuhm.net>
Message-ID: <3F8CE039.9090709@comcast.net>

James Y Knight wrote:
> I took dtuple.py (a wrapper that makes database results look like both a 
> tuple and a dictionary simultaneously, which I found on the web)  ...

PgResultSet already does that.
E.g.:

 >>> from pyPgSQL import PgSQL
 >>> conn = PgSQL.connect(database='pgerdb')
 >>> curs = conn.cursor()
 >>> curs.execute('select * from id_context')
 >>> res = curs.fetchall()
 >>> len(res)
6
 >>> res[0]
[None, 'IdContext', None, 'PGER', 0, 'PGER', '', '', 'admin', 'PGER', 'admin', 'PGER', <DateTime 
object for '2003-10-02 13:36:55.29' at 40429fa8>, 'admin', 'PGER', <DateTime object for '2003-10-02 
13:36:55.29' at 40443090>, 'admin', 'PGER', 'admin', 'PGER', <DateTime object for '2003-10-02 
13:36:55.29' at 404430c8>, 'admin', 'PGER', <DateTime object for '2003-10-02 13:36:55.29' at 
40443100>, None]
 >>> for k in res[0].keys():
...     print '%s : %s' % (k, res[0][k])
...
pgef_oid : None
pgef_class : IdContext
id : None
id_context : PGER
pgef_security_mask : 0
name : PGER
short_description :
long_description :
pger_owner : admin
pger_owner_context : PGER
pger_creator : admin
pger_creator_context : PGER
pger_create_datetime : 2003-10-02 13:36:55.29
pger_modifier : admin
pger_modifier_context : PGER
pger_mod_datetime : 2003-10-02 13:36:55.29
owner : admin
owner_context : PGER
creator : admin
creator_context : PGER
create_datetime : 2003-10-02 13:36:55.29
modifier : admin
modifier_context : PGER
mod_datetime : 2003-10-02 13:36:55.29
ext_name : None
 >>>




From anthony at interlink.com.au  Wed Oct 15 02:16:36 2003
From: anthony at interlink.com.au (Anthony Baxter)
Date: Wed, 15 Oct 2003 16:16:36 +1000
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven models 
In-Reply-To: <3F8CE039.9090709@comcast.net> 
Message-ID: <200310150616.h9F6Ga5b001387@localhost.localdomain>


You might also want to look at Kevin Jacob's db_row class - it has a C and
Python implementation.

http://opensource.theopalgroup.com/

-- 
Anthony Baxter     <anthony at interlink.com.au>   
It's never too late to have a happy childhood.




From syver at inout.no  Wed Oct 15 04:25:19 2003
From: syver at inout.no (Syver Enstad)
Date: 15 Oct 2003 10:25:19 +0200
Subject: [Twisted-Python] Twisted file upload
In-Reply-To: <20031014121633.518f092b.itamar@itamarst.org>
References: <u8ynoq9uo.fsf@inout.no>
	<20031014121633.518f092b.itamar@itamarst.org>
Message-ID: <un0c2vrf4.fsf@inout.no>

Itamar Shtull-Trauring <itamar at itamarst.org> writes:

> On 14 Oct 2003 14:31:27 +0200
> Syver Enstad <syver at inout.no> wrote:
> 
> > If there is a better way to get the filename of a posted file than the
> > code below, please tell me:
> 
> Using some sort of MIME parsing code or some of the code in the cgi
> module might be better. Long term solution involves total rewrite of
> file upload support.

Fine, I just wanted to know if I had missed something obvious in
twisted's support for file upload.






From 2002 at weholt.org  Wed Oct 15 05:46:00 2003
From: 2002 at weholt.org (Thomas Weholt)
Date: Wed, 15 Oct 2003 11:46:00 +0200
Subject: [Twisted-Python] Twisted file upload
References: <u8ynoq9uo.fsf@inout.no><20031014121633.518f092b.itamar@itamarst.org> <un0c2vrf4.fsf@inout.no>
Message-ID: <01c601c39301$254f4bf0$0401a8c0@razor>

If anybody can elaborate on this, provide a simple, twisted-friendly way of
parsing uploaded files, preferrably in a form with other fields as well,
that would be great.

Been messing around with something similar to this myself, and I have to
upload mainly binary files, which in my case returned just crappy, mangled
data.

Best regards and thanks in advance,
Thomas

----- Original Message -----
From: "Syver Enstad" <syver at inout.no>
To: <twisted-python at twistedmatrix.com>
Sent: Wednesday, October 15, 2003 10:25 AM
Subject: Re: [Twisted-Python] Twisted file upload


> Itamar Shtull-Trauring <itamar at itamarst.org> writes:
>
> > On 14 Oct 2003 14:31:27 +0200
> > Syver Enstad <syver at inout.no> wrote:
> >
> > > If there is a better way to get the filename of a posted file than the
> > > code below, please tell me:
> >
> > Using some sort of MIME parsing code or some of the code in the cgi
> > module might be better. Long term solution involves total rewrite of
> > file upload support.
>
> Fine, I just wanted to know if I had missed something obvious in
> twisted's support for file upload.
>
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>




From lupien_v_31 at hotmail.com  Wed Oct 15 09:17:07 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Wed, 15 Oct 2003 13:17:07 +0000
Subject: [Twisted-Python] td() in form
Message-ID: <BAY1-F39s7nlT2NqFJ3000035ed@hotmail.com>

Bob Ippolito wrote:

>On Tuesday, Oct 14, 2003, at 16:44 America/New_York, Itamar Shtull-Trauring 
>wrote:
>
>>On Tue, 14 Oct 2003 20:29:10 +0000
>>"vicky lupien" <lupien_v_31 at hotmail.com> wrote:
>>
>>>I' m suppose to write l.td(class='label').text(name) but I can't.  Is
>>>there a way to do this?
>>
>>
>>t = l.td()
>>t["class"] = "label"
>>t.text(name)
>
>
>There's no underscore hack for Python's reserved words in lmx?
>
>-bob

There is the underscore hack too
l = lmx()
l.td(_class='label').text(name)
will work as well.

You can prefix an _ to any kwarg, so you can also have td(_import=''), 
td(_if='blah'), etc.

Regards,
Stephen Thorne

Thx everyone, it's all right now

_________________________________________________________________
MSN Search, le moteur de recherche qui pense comme vous !  
http://fr.ca.search.msn.com/




From lupien_v_31 at hotmail.com  Wed Oct 15 09:19:28 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Wed, 15 Oct 2003 13:19:28 +0000
Subject: [Twisted-Python] form and submit
Message-ID: <BAY1-F40OWGMhLPBLYd00012b78@hotmail.com>

I have a form with a submit button.  I want to send my data from the form in 
a web page to an other web page.  Also, I want to check if the data is 
correct.

I'm new to twisted, so I need some help

Vicky

_________________________________________________________________
MSN Messenger : discutez en direct avec vos amis !  
http://messenger.fr.msn.ca/




From foom at fuhm.net  Wed Oct 15 11:36:03 2003
From: foom at fuhm.net (James Y Knight)
Date: Wed, 15 Oct 2003 11:36:03 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven models
In-Reply-To: <3F8CE039.9090709@comcast.net>
Message-ID: <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>

On Wednesday, October 15, 2003, at 01:50 AM, Stephen C. Waterbury wrote:

> James Y Knight wrote:
>> I took dtuple.py (a wrapper that makes database results look like 
>> both a tuple and a dictionary simultaneously, which I found on the 
>> web)  ...
>
> PgResultSet already does that.
> E.g.:
>
> >>> from pyPgSQL import PgSQL
> >>> conn = PgSQL.connect(database='pgerdb')

Well I guess I chose the wrong postgres python implementation then, 
since I know Psycopg doesn't do that. Good thing the python DB 
interface is standardized! ;) But okay -- if you're using PgSQL, you 
can then just use the woven model wrapper part pretty easily without 
the DatabaseTuple, TupleDescriptor classes.

James




From golux at comcast.net  Wed Oct 15 12:33:47 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Wed, 15 Oct 2003 12:33:47 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven
 models
In-Reply-To: <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>
References: <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>
Message-ID: <3F8D76EB.3040307@comcast.net>

James Y Knight wrote:

> Well I guess I chose the wrong postgres python implementation then, 
> since I know Psycopg doesn't do that. Good thing the python DB interface 
> is standardized! ;) ...

heh ... the great thing about standards is that
there are so many to choose from.  ;)

Steve.




From nico at tekNico.net  Wed Oct 15 12:58:31 2003
From: nico at tekNico.net (Nicola Larosa)
Date: Wed, 15 Oct 2003 18:58:31 +0200
Subject: [Twisted-Python] Re: DB dictionary/tuple result wrapper for woven models
In-Reply-To: <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>
References: <3F8CE039.9090709@comcast.net> <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>
Message-ID: <3F8D7CB7.8020300@tekNico.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Well I guess I chose the wrong postgres python implementation then,
> since I know Psycopg doesn't do that. Good thing the python DB interface
> is standardized! ;)

You can do the same with MySQL-python, using a DictCursor instead of a
vanilla Cursor.


- --
"Whether you believe you can or believe you can't,
either way you're right." -- Henry Ford

Nicola Larosa - nico at tekNico.net


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (GNU/Linux)

iD8DBQE/jXy2Xv0hgDImBm4RAr3aAJ4949HdDPGE4RkeduvsJNT918kx4QCgtg6Q
tJPeAdE0SO+cockjNnCNeW8=
=5osK
-----END PGP SIGNATURE-----




From nico at tekNico.net  Wed Oct 15 13:00:44 2003
From: nico at tekNico.net (Nicola Larosa)
Date: Wed, 15 Oct 2003 19:00:44 +0200
Subject: [Twisted-Python] Re: Status of 1.1 release
In-Reply-To: <20031014021438.GB7341@frobozz>
References: <20031013010234.054e4358.itamar@itamarst.org> <20031014021438.GB7341@frobozz>
Message-ID: <3F8D7D3C.10902@tekNico.net>

>> Remaining issues:
>> 1. Services use in static registry (deleting code mainly)
>> 2. Update manhole (and manhole and telnet howtos)
>> 3. What to do with words
>> 4. Document guard

> 5. Intermittent buildbot failures for full-2.3 and freebsd buildslaves,
>    e.g.:
>        http://twistedmatrix.com/buildbot/full-2.3/events/486/summary
>        http://twistedmatrix.com/buildbot/freebsd/events/422/summary

What about

6. Documenting Woven Form

? :^)


-- 
"Whether you believe you can or believe you can't,
either way you're right." -- Henry Ford

Nicola Larosa - nico at tekNico.net





From vlupien at drummonddesigns.com  Wed Oct 15 13:38:38 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Wed, 15 Oct 2003 13:38:38 -0400
Subject: [Twisted-Python] form and submit
Message-ID: <000101c39343$2abeb8e0$687ba8c0@martin>

I really need help.  I have a form in a web page and I want to transfert
the data to an another web page.  I'd like to be able to validate the
input before sending my data to the other page.
 
I'm using web.woven.form.  I build my form dynamically (lmx) not with
formprocess.  
 
Thx for your help
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031015/82765455/attachment.htm 

From dp at twistedmatrix.com  Wed Oct 15 13:40:49 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 15 Oct 2003 13:40:49 -0400
Subject: [Twisted-Python] Re: Status of 1.1 release
In-Reply-To: <3F8D7D3C.10902@tekNico.net>
References: <20031013010234.054e4358.itamar@itamarst.org> <20031014021438.GB7341@frobozz> <3F8D7D3C.10902@tekNico.net>
Message-ID: <B732660A-FF36-11D7-8C38-000A95864FC4@twistedmatrix.com>

On Oct 15, 2003, at 1:00 PM, Nicola Larosa wrote:

>>> Remaining issues:
>>> 1. Services use in static registry (deleting code mainly)
>>> 2. Update manhole (and manhole and telnet howtos)
>>> 3. What to do with words
>>> 4. Document guard
>
>> 5. Intermittent buildbot failures for full-2.3 and freebsd 
>> buildslaves,
>>    e.g.:
>>        http://twistedmatrix.com/buildbot/full-2.3/events/486/summary
>>        http://twistedmatrix.com/buildbot/freebsd/events/422/summary
>
> What about
>
> 6. Documenting Woven Form
>
> ? :^)

Documenting it would mean semi-freezing the interface, and since the 
interface is just slush and has already changed (in quotient.formless 
and quotient.web.webform), I don't think it's a great idea. One thing 
people need to understand about woven is that it is still in heavy 
development -- although development has slowed lately because it has 
become stable enough to use, there are still large refactorings I plan 
on undertaking which will vastly simplify the way woven works. While I 
will attempt to preserve backwards compatibility because I have a large 
codebase that needs it, I reserve the right to change interfaces 
because they are completely broken -- I think it'll be better in the 
long run to have well-designed interfaces than to have backwards 
compatibility with broken ones.

The best way to learn about woven is to try to use it, and to ask 
questions on #twisted.

dp




From foom at fuhm.net  Wed Oct 15 14:41:58 2003
From: foom at fuhm.net (James Y Knight)
Date: Wed, 15 Oct 2003 14:41:58 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven models
In-Reply-To: <3F8D76EB.3040307@comcast.net>
Message-ID: <42065F2F-FF3F-11D7-B477-000A95A50FB2@fuhm.net>

On Wednesday, October 15, 2003, at 12:33 PM, Stephen C. Waterbury wrote:

> James Y Knight wrote:
>
>> Well I guess I chose the wrong postgres python implementation then, 
>> since I know Psycopg doesn't do that. Good thing the python DB 
>> interface is standardized! ;) ...
>
> heh ... the great thing about standards is that
> there are so many to choose from.  ;)

Unfortunately there's only one very-poorly-specified standard here. And 
that's not so great.

James




From vlupien at drummonddesigns.com  Wed Oct 15 15:14:53 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Wed, 15 Oct 2003 15:14:53 -0400
Subject: [Twisted-Python] formprocess + display
Message-ID: <000801c39350$9d0c1f70$687ba8c0@martin>

I've made a form with FormProcess and methodSignature.  I want to know
if I can add some attributes to td for my html page or anything like
that.   
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031015/70987c05/attachment.htm 

From mesozoic at polynode.com  Wed Oct 15 17:45:29 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 15 Oct 2003 17:45:29 -0400
Subject: [Twisted-Python] Problem with MovableType, XMLRPC, and CGI
Message-ID: <1066254329.953.119.camel@hyla>

I was trying to access the MovableType XML-RPC server (which uses Perl's
SOAP::Lite module), and kept getting Interal Server Errors. The problem,
as it turned out, was that the headers were separated from the response
by '\n\r\n', which wasn't recognized.

Is this a bug in Twisted, or in SOAP::Lite? I'm reluctant to add it to
the bug tracker without knowing whether this is actually a problem for
the Twisted team.

Below is the dirty nasty quick-fix I used:

--- twcgi.py.orig	Wed Oct 15 17:37:09 2003
+++ twcgi.py	Wed Oct 15 17:44:25 2003
@@ -208,7 +208,7 @@
         if self.handling_headers:
             text = self.headertext + output
             headerEnds = []
-            for delimiter in '\n\n','\r\n\r\n','\r\r':
+            for delimiter in '\n\n','\r\n\r\n','\r\r', '\n\r\n':
                 headerend = string.find(text,delimiter)
                 if headerend != -1:
                     headerEnds.append((headerend, delimiter))


-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031015/d785c683/attachment.pgp 

From stuart.hungerford at anu.edu.au  Thu Oct 16 00:52:36 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Thu, 16 Oct 2003 14:52:36 +1000
Subject: [Twisted-Python] Best way to modify <meta> tags in Woven...
Message-ID: <6.0.0.22.0.20031016144923.01ecac20@anusf.anu.edu.au>

Hi all,

I have a Woven-based web application that needs to modify the
<meta> tags of the generated HTML from the application (i.e.
the attribute values of the meta tags).

What's the best way to approach this in Woven?   I'd guess
I could find the <head> element in Woven then use the lmx DOM
functions to insert a new <meta> element?

Any advice much appreciated.


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From mary-twisted at puzzling.org  Thu Oct 16 04:03:50 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Thu, 16 Oct 2003 18:03:50 +1000
Subject: [Twisted-Python] Best way to modify <meta> tags in Woven...
In-Reply-To: <6.0.0.22.0.20031016144923.01ecac20@anusf.anu.edu.au>
References: <6.0.0.22.0.20031016144923.01ecac20@anusf.anu.edu.au>
Message-ID: <20031016080350.GD11624@titus>

On Thu, Oct 16, 2003, Stuart Hungerford wrote:
> Hi all,
> 
> I have a Woven-based web application that needs to modify the
> <meta> tags of the generated HTML from the application (i.e.
> the attribute values of the meta tags).
> 
> What's the best way to approach this in Woven?   I'd guess
> I could find the <head> element in Woven then use the lmx DOM
> functions to insert a new <meta> element?
> 
> Any advice much appreciated.

Apologies if I'm misunderstanding the architecture, but can you simply
have a template that looks like this?

''''
<html>

<head>

<meta model="MetaModel" view="AttributeAdder/>

</head>
'''

etc etc...

And then the relevant Page subclass has a wmfactory_MetaModel method and
a wvfactory_AttributeAdder method which returns some kind of Widget.  In
the setUp method of the Widget, you can manipulate the node. This saves
you from having to search down from the head -- you *know* that the node
argument to the Widget's setUp method is the "meta" node.

Of course this requires that you know how to generate the meta tag's
attribute at the time of the generation of the HTML, and you said you
wanted to "modify the <meta> tags of the generated HTML" -- does this
mean you don't know what the <meta> tags will look like until *after*
the page has been generated?

-Mary



From mesozoic at polynode.com  Thu Oct 16 04:29:42 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Thu, 16 Oct 2003 04:29:42 -0400
Subject: [Twisted-Python] PB, t.web tracebacks with Debian 1.1.0alpha
Message-ID: <1066292982.5731.69.camel@hyla>

Moshez pointed out that the problem I'm having, originally listed here
<http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue345>, is
not a bug, but a feature. I'm posting my code; could someone explain
what I'm doing wrong?

In an .rpy, I have:

--- snip ---
resource = MyResource()
resource.putChild(ResourceSubscription('unix', '/home/mesozoic/.mt'))
cache()
--- snip ---

In a separate server, I have:

--- snip ---
file = static.File('./site')
site = server.Site(file)
application = app.Application('movabletype')
application.listenUNIX(
    '/home/mesozoic/.mt',
    pb.BrokerFactory(distrib.ResourcePublisher(site)))
--- snip ---

Advice is warmly welcomed.

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031016/43e870ad/attachment.pgp 

From syver at inout.no  Thu Oct 16 05:37:13 2003
From: syver at inout.no (Syver Enstad)
Date: 16 Oct 2003 11:37:13 +0200
Subject: [Twisted-Python] Twisted file upload
In-Reply-To: <01c601c39301$254f4bf0$0401a8c0@razor>
References: <u8ynoq9uo.fsf@inout.no>
	<20031014121633.518f092b.itamar@itamarst.org> <un0c2vrf4.fsf@inout.no>
	<01c601c39301$254f4bf0$0401a8c0@razor>
Message-ID: <un0c1ttfa.fsf@inout.no>

"Thomas Weholt" <2002 at weholt.org> writes:

> If anybody can elaborate on this, provide a simple, twisted-friendly way of
> parsing uploaded files, preferrably in a form with other fields as well,
> that would be great.
> 
> Been messing around with something similar to this myself, and I have to
> upload mainly binary files, which in my case returned just crappy, mangled
> data.

The support works out of the box for me as long as I use the correct
enctype on the form. I just use request.args to get the data, it's the
filename that I have a problem with.

    <form enctype="multipart/form-data" action="./" method="POST">
    <input name="myFile" type="file" />
    <input type="submit" value="Upload file" />
    </form>

When I get the POST I just use:

outputStream = open(filename, 'wb')
outputStream.write(request.args['myFile'])
outputStream.close()

I find filename by doing the stuff outlined in the beginning of this thread.



 




From justinjohnson at fastmail.fm  Thu Oct 16 08:35:27 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 16 Oct 2003 06:35:27 -0600
Subject: [Twisted-Python] CVSToys and IRC
Message-ID: <20031016123527.984D93ED72@www.fastmail.fm>

Would someone mind helping me get CVSToys setup to send to an IRC
channel?  I'm not quite sure what to do based on what the doc says.

----------
Many of you are downloading this package to have commit notifications
delivered to you on IRC.  To do this, make sure you have a PBService
in your freshCfg, and then make seperate cvswords application; do
`mktap cvswords --help` for a list of all options.  The --cvs-user and
--cvs-pass options must match the user/pass pair for the PBService.
Start the new application with `twistd -f cvswords.tap`.
-----------

From
http://twistedmatrix.com/users/acapnotic/wares/code/CVSToys/config.txt...

----

PBService
PB service to provide notification to remote agents.

Usage: PBService(serviceName='cvstoys.notify', userpass=None)
Initialize a service.

The global variables pbPortNo and pbAuthorizer are also relevant.

@param serviceName: The name of the PB service.  If you make
more than one service, each must have a unique name.

@param userpass: If a (username, password) tuple is supplied
here, an account will be created for it.

----

So it seems I need to create a words tap and a cvswords tap, and add a
PBService to the freshCfg file?  I'm not quite sure where I specify the
IRC channel in all this.  mktap words --help doesn't seem to have any
channel option.

Thanks.
-Justin



From vlupien at drummonddesigns.com  Thu Oct 16 09:16:03 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 16 Oct 2003 09:16:03 -0400
Subject: [Twisted-Python] templateAttributes for form
In-Reply-To: <000801c39350$9d0c1f70$687ba8c0@martin>
Message-ID: <000001c393e7$a6f1d1a0$687ba8c0@martin>

What is the utility of templateAttributes in the every input_ fonction
(input_text, ...) that is in form.py in the class FormFillerWidget.  I
want to add some attributes to the node but I don't know how.
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031016/ee3b5a07/attachment.htm 

From itamar at itamarst.org  Thu Oct 16 10:50:37 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 16 Oct 2003 10:50:37 -0400
Subject: [Twisted-Python] PB, t.web tracebacks with Debian 1.1.0alpha
In-Reply-To: <1066292982.5731.69.camel@hyla>
References: <1066292982.5731.69.camel@hyla>
Message-ID: <20031016105037.6335e45d.itamar@itamarst.org>

On Thu, 16 Oct 2003 04:29:42 -0400
Alex Levy <mesozoic at polynode.com> wrote:

> http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue345

Code in RPYs is run each time the page is viewed. Thus, your resource
publisher is registering two producers on a transport, which is not
valid behaviour - it's supposed to unregister first.

Solutions:
1. have the line "cache()" on first line of RPY - this will prevent it
from reexecuting on each hit.
2. don't use RPYs.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 16 10:53:19 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 16 Oct 2003 10:53:19 -0400
Subject: [Twisted-Python] Problem with MovableType, XMLRPC, and CGI
In-Reply-To: <1066254329.953.119.camel@hyla>
References: <1066254329.953.119.camel@hyla>
Message-ID: <20031016105319.61552b02.itamar@itamarst.org>

On Wed, 15 Oct 2003 17:45:29 -0400
Alex Levy <mesozoic at polynode.com> wrote:

> I was trying to access the MovableType XML-RPC server (which uses
> Perl's SOAP::Lite module), and kept getting Interal Server Errors. The
> problem, as it turned out, was that the headers were separated from
> the response by '\n\r\n', which wasn't recognized.

Hmmm. Unless \n is a valid character in a HTTP header, sounds like a bug
in SOAP::Lite. Hit the RFC and see what it says.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 16 12:41:18 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 16 Oct 2003 12:41:18 -0400
Subject: [Twisted-Python] PB, t.web tracebacks with Debian 1.1.0alpha
In-Reply-To: <20031016105037.6335e45d.itamar@itamarst.org>
References: <1066292982.5731.69.camel@hyla>
	<20031016105037.6335e45d.itamar@itamarst.org>
Message-ID: <20031016124118.30e3f2ee.itamar@itamarst.org>

On Thu, 16 Oct 2003 10:50:37 -0400
Itamar Shtull-Trauring <itamar at itamarst.org> wrote:

> Solutions:
> 1. have the line "cache()" on first line of RPY - this will prevent it
> from reexecuting on each hit.
> 2. don't use RPYs.

Actually I may be totally wrong about this.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Thu Oct 16 13:29:03 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 16 Oct 2003 13:29:03 -0400
Subject: [Twisted-Python] CVSToys and IRC
In-Reply-To: <20031016123527.984D93ED72@www.fastmail.fm>
References: <20031016123527.984D93ED72@www.fastmail.fm>
Message-ID: <20031016172903.GA9694@intarweb.us>

On Thu, Oct 16, 2003 at 06:35:27AM -0600, Justin Johnson wrote:
> Would someone mind helping me get CVSToys setup to send to an IRC
> channel?  I'm not quite sure what to do based on what the doc says.
> 

From my freshCfg:

pbPortNumber = 9292
pb = ConfigurationSet([
    ('/cvs', '^frontier', None,
        PBService(userpass=("<username>", "<password>"))),
    ])

/cvs is my $CVSROOT; frontier is the name of the module I want to see
information about; <username> and <password> are obvious.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031016/aafe1c37/attachment.pgp 

From twisted at zadka.site.co.il  Thu Oct 16 13:36:35 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 16 Oct 2003 17:36:35 -0000
Subject: [Twisted-Python] PB, t.web tracebacks with Debian 1.1.0alpha
In-Reply-To: <1066292982.5731.69.camel@hyla>
References: <1066292982.5731.69.camel@hyla>
Message-ID: <20031016173635.7662.qmail@green.zadka.com>

On Thu, 16 Oct 2003, Alex Levy <mesozoic at polynode.com> wrote:

> Moshez pointed out that the problem I'm having, originally listed here
> <http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue345>, is
> not a bug, but a feature. I'm posting my code; could someone explain
> what I'm doing wrong?

Well, apparently there was a bug in the CGI code. I'm guessing m-t works
with CGI?

In any case, you should move the server to new application:

from twisted.application import service, strports
> file = static.File('./site')
> site = server.Site(file)
> application = app.Application('movabletype')
application = service.Application('movabletype')
s = strports.service('unix:/home/mesozoic/.mt',
                     pb.PBServerFactory(distrib.ResourcePublisher(site)))
s.setServiceParent(application)



From justinjohnson at fastmail.fm  Thu Oct 16 14:00:52 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 16 Oct 2003 12:00:52 -0600
Subject: [Twisted-Python] CVSToys and IRC
In-Reply-To: <20031016172903.GA9694@intarweb.us>
References: <20031016123527.984D93ED72@www.fastmail.fm> <20031016172903.GA9694@intarweb.us>
Message-ID: <20031016180052.CCCB63D3BC@www.fastmail.fm>

Do I need to have another service running though?  Where do I tell it the
IRC channel to send to?

Thanks.
-Justin

On Thu, 16 Oct 2003 13:29:03 -0400, "Jp Calderone" <exarkun at intarweb.us>
said:
> On Thu, Oct 16, 2003 at 06:35:27AM -0600, Justin Johnson wrote:
> > Would someone mind helping me get CVSToys setup to send to an IRC
> > channel?  I'm not quite sure what to do based on what the doc says.
> > 
> 
> From my freshCfg:
> 
> pbPortNumber = 9292
> pb = ConfigurationSet([
>     ('/cvs', '^frontier', None,
>         PBService(userpass=("<username>", "<password>"))),
>     ])
> 
> /cvs is my $CVSROOT; frontier is the name of the module I want to see
> information about; <username> and <password> are obvious.
> 
>   Jp



From glyph at twistedmatrix.com  Fri Oct 17 01:14:57 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 17 Oct 2003 01:14:57 -0400
Subject: [Twisted-Python] Re: Status of 1.1 release
In-Reply-To: <B732660A-FF36-11D7-8C38-000A95864FC4@twistedmatrix.com>
References: <20031013010234.054e4358.itamar@itamarst.org> <20031014021438.GB7341@frobozz> <3F8D7D3C.10902@tekNico.net> <B732660A-FF36-11D7-8C38-000A95864FC4@twistedmatrix.com>
Message-ID: <3F8F7AD1.8020202@twistedmatrix.com>

Donovan Preston wrote:

> Documenting [form] would mean semi-freezing the interface, and since the 
> interface is just slush and has already changed (in quotient.formless 
> and quotient.web.webform), I don't think it's a great idea. One thing 
> people need to understand about woven is that it is still in heavy 
> development -- although development has slowed lately because it has 
> become stable enough to use, there are still large refactorings I plan 
> on undertaking which will vastly simplify the way woven works. While I 
> will attempt to preserve backwards compatibility because I have a large 
> codebase that needs it, I reserve the right to change interfaces because 
> they are completely broken -- I think it'll be better in the long run to 
> have well-designed interfaces than to have backwards compatibility with 
> broken ones.
> 
> The best way to learn about woven is to try to use it, and to ask 
> questions on #twisted.

I have added some notes to other aspects of the Twisted documentation to 
try to bridge this communication gap.  Any document where the thing 
being documented is under heavy development should clearly and loudly 
say that.

I mention this because I agree with Donovan's point here, but sometimes 
writing documentation for code can be as enlightening a process as 
writing test-cases for it; possibly revealing ways to produce 
backwards-compatible refactorings without endangering correctness.  I 
don't want to discourage anyone from doing that.  If you do it, though, 
understand that you may have to maintain the document forward to a new 
interface when it changes.





From ted at powersdk.com  Fri Oct 17 16:37:23 2003
From: ted at powersdk.com (Ted Patrick)
Date: Fri, 17 Oct 2003 16:37:23 -0400
Subject: [Twisted-Python] Chat server
Message-ID: <000401c394ee$7a94b840$6401a8c0@ISLAND>

Using twisted as a socket server, how would you pass a message to all
attached clients. Like the echo example but broadcast the message to all
attached clients.

Thanks,

Ted




From rdrb at 123.cl  Fri Oct 17 18:28:23 2003
From: rdrb at 123.cl (RITA Y/O RODRIGO DIAZ Y/O BENENSON)
Date: Fri, 17 Oct 2003 22:28:23 +0000 (GMT)
Subject: [Twisted-Python] Khashmir log crash
Message-ID: <2d81682d8156.2d81562d8168@noborrar.co.cl>

Hi!

I'm working in a research project
about new usages for the computers
networks. Actually I would like to
start some prototype services over
Distributed Hash Tables. The python
implementation of kademlia named
"khasmir" (presented at the
twistedmatrix homepage) seems to be
the perfect choice for the fast
devellopment of the first prototypes.

Unfortanutelly running the demo I got:


[rodrigob at localhost khashmir]$ python
khashmir.py 5
Building 5 peer table.
Traceback (most recent call last):
  File
"/usr/local/lib/python2.3/site-packages/twisted/internet/app.py",
line 862, in run
    log.callWithLogger(self,
reactor.run,
installSignalHandlers=installSignalHandlers)
--- <exception caught here> ---
  File
"/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
line 65, in callWithLogger
    callWithContext({"system": lp},
func, *args, **kw)
  File
"/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
line 52, in callWithContext
    return context.call({ILogContext:
newCtx}, func, *args, **kw)
  File
"/usr/local/lib/python2.3/site-packages/twisted/python/context.py",
line 53, in callWithContext
    return
self.currentContext().callWithContext(ctx,
func, *args, **kw)
  File
"/usr/local/lib/python2.3/site-packages/twisted/python/context.py",
line 32, in callWithContext
    return func(*args,**kw)
  File
"/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
line 121, in run
   
self.startRunning(installSignalHandlers=installSignalHandlers)
  File
"/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
line 115, in startRunning
    self._handleSignals()
  File
"/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
line 87, in _handleSignals
    signal.signal(signal.SIGINT,
self.sigInt)
exceptions.ValueError: signal only
works in main thread

Python 2.3.2, Twisted 1.0.7, RH8.


Does anyone know how to fix this ? I
this due to changes in Twisted ?
Have someone already used khashmir ?



Thanks.
RodrigoB.




From bob at redivi.com  Fri Oct 17 18:41:04 2003
From: bob at redivi.com (Bob Ippolito)
Date: Fri, 17 Oct 2003 18:41:04 -0400
Subject: [Twisted-Python] Chat server
In-Reply-To: <000401c394ee$7a94b840$6401a8c0@ISLAND>
Message-ID: <FDD94AC2-00F2-11D8-9C26-000A95686CD8@redivi.com>

On Friday, Oct 17, 2003, at 16:37 America/New_York, Ted Patrick wrote:

> Using twisted as a socket server, how would you pass a message to all
> attached clients. Like the echo example but broadcast the message to 
> all
> attached clients.

You need to have a dictionary connected clients somewhere, the best 
place would probably be the factory instance.  When a client connects, 
add them to the dictionary, when they disconnect remove them from the 
dictionary.  Then just add a method to your class that sends a message 
to every client that the factory knows about.

-bob




From itamar at itamarst.org  Fri Oct 17 22:36:53 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 17 Oct 2003 22:36:53 -0400
Subject: [Twisted-Python] Khashmir log crash
In-Reply-To: <2d81682d8156.2d81562d8168@noborrar.co.cl>
References: <2d81682d8156.2d81562d8168@noborrar.co.cl>
Message-ID: <20031017223653.441b31e9.itamar@itamarst.org>

On Fri, 17 Oct 2003 22:28:23 +0000 (GMT)
RITA Y/O RODRIGO DIAZ Y/O BENENSON <rdrb at 123.cl> wrote:

> Unfortanutelly running the demo I got:

You need to change the code so it does
"reactor.run(installSignalHandlers=0)" instead of "reactor.run()".

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From Dave at centralmanclc.com  Sun Oct 19 11:44:39 2003
From: Dave at centralmanclc.com (Dave Thorne)
Date: Sun, 19 Oct 2003 16:44:39 +0100
Subject: [Twisted-Python] conroller.Controller.handle() returning a Deferred
Message-ID: <03Oct19.163755bst.119047@harry.trinity.manchester.sch.uk>

I've been attempting to use the IRC channel to ask this question, but to no
avail. Maybe I'm not using the IRC client correctly, who knows.

However, I have a problem in a woven application whereby my Controller
object has a handle() method that returns a deferred (from an adbapi query)
on which I have set a callback to do something with the query data.

I assumed that my set callback would be executed before the callback that is
(presumably) set by woven to deal with the deferred's completion. Indeed,
with some print statements as debug tools I see that my callback really is
being executed, but as soon as the "checkMatch" callback returns the page
stalls.

It is no doubt an easy problem to fix, but any help would be greatly
appreciated! I've placed the code for the controller below...

Cheers,

Dave



My Code:
========

class PreferencesController(controller.Controller):

   def handle(self, request):
      <snip>
      theApp = app.theApplication

      def checkMatch(results):
         #Do Stuff
         #Return: nothing, None, results?

      uname = "myusername"
      query = "SELECT * FROM people WHERE username = '%s'" % (uname)
      return theApp.dbpool.runQuery(query).addCallback(checkMatch)

========



From bob at redivi.com  Sun Oct 19 12:49:51 2003
From: bob at redivi.com (Bob Ippolito)
Date: Sun, 19 Oct 2003 12:49:51 -0400
Subject: [Twisted-Python] Reactor interface for system configuration and events?
Message-ID: <422E7F7C-0254-11D8-B59D-000A95686CD8@redivi.com>

I've just wrapped the SystemConfiguration interface from Darwin (part 
of the configd project, which is open source under APSL).  Basically it 
lets you query a Whole Lot Of Settings.  It also lets you get 
notification when these settings change.  A lot of this is applicable 
to Twisted applications:
	Power management settings (computer on battery or AC, probably low 
power notification, computer went to sleep, computer woke up, etc.)
	User settings (login, logout)
	Proxy settings (http, https, ftp, ftp prefers PASV, socks, gopher, etc)
	Network settings (device went up, device went down, 802.11 SSID, 
device changed address, etc.)
	Reachability (given current networking settings, is it possible to 
reach a host by name or sock_addr)

Surely some or all of this is applicable to Win32 and Linux.  Anyone 
knowledgeable about this sort of API on those platforms?  We should 
develop an interface to deal with this stuff.

-bob




From rdrb at 123.cl  Sun Oct 19 17:43:16 2003
From: rdrb at 123.cl (=?iso-8859-1?Q?Rita_D=EDaz_y/o_Rodrigo_Benenson?=)
Date: Sun, 19 Oct 2003 18:43:16 -0300
Subject: [Twisted-Python] MetaInterface call error
References: <20031018104221.11841.88662.Mailman@pyramid.twistedmatrix.com>
Message-ID: <000601c3968a$064f4f20$4b30fea9@laboratorio>

Hi!,

the log crash problem was solved as indicated (thanks !), just had to fix
the calls to thread.start_new_thread(reactor.run, ()).
I'm still working to get Khashmir passing the unit tests (again, I suppose).
After some grumble grumbling I discovered the following funny situation
(copied from another screen):


>>> import airhook
>>> a = airhook.AirhookConnection
>>> a
<class 'airhook.AirhookConnection'>
>>> b = a()
TypeError: __call__() takes at least 2 arguments (1 given)

Why __call__? __init__ should be called !

AirhookConnection is defined as:

class AirHookConnection(protocol.ConnectedDatagramProtocol,
interfaces.IUDPConnectedTransport):
   def __init__(self):
      blablblah

Then, in a inspired moment I discovered:
>>> type(a)
<class 'twisted.python.components.MetaInterface'>

Could someone explain to me what it means, and how should I interpret the
"__call__" problem in this context ?
Do I have to register the interface ? or something like that ? Thanks.

RodrigoB.

PS: I had readed that PB wanted to be able to run over AirHook, Khashmir has
an AirHook protocol implementation...





From exarkun at intarweb.us  Sun Oct 19 17:49:53 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 19 Oct 2003 17:49:53 -0400
Subject: [Twisted-Python] MetaInterface call error
In-Reply-To: <000601c3968a$064f4f20$4b30fea9@laboratorio>
References: <20031018104221.11841.88662.Mailman@pyramid.twistedmatrix.com> <000601c3968a$064f4f20$4b30fea9@laboratorio>
Message-ID: <20031019214953.GA19535@intarweb.us>

On Sun, Oct 19, 2003 at 06:43:16PM -0300, Rita D?az y/o Rodrigo Benenson wrote:
> Hi!,
> 
> the log crash problem was solved as indicated (thanks !), just had to fix
> the calls to thread.start_new_thread(reactor.run, ()).
> I'm still working to get Khashmir passing the unit tests (again, I suppose).
> After some grumble grumbling I discovered the following funny situation
> (copied from another screen):
> 
> 
> >>> import airhook
> >>> a = airhook.AirhookConnection
> >>> a
> <class 'airhook.AirhookConnection'>
> >>> b = a()
> TypeError: __call__() takes at least 2 arguments (1 given)
> 
> Why __call__? __init__ should be called !
> 
> AirhookConnection is defined as:
> 
> class AirHookConnection(protocol.ConnectedDatagramProtocol,
> interfaces.IUDPConnectedTransport):
>    def __init__(self):
>       blablblah

  This seems to be an error.  AirHookConnection should not inherit from
IUDPConnectedTransport.  It may have worked with a previous version of
Twisted, but doing this was never supported, and won't work with any
reasonably recent release of Twisted.  Simply removing it from the base
class list should resolve the issue.  If you want to be clean about it, add
this line to the body of the AirHookConnection class definition:

    __implements__ = (interfaces.IUDPConnectedTransport,)

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031019/627e539c/attachment.pgp 

From radix at twistedmatrix.com  Sun Oct 19 17:50:41 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 19 Oct 2003 17:50:41 -0400
Subject: [Twisted-Python] MetaInterface call error
In-Reply-To: <000601c3968a$064f4f20$4b30fea9@laboratorio>
References: <20031018104221.11841.88662.Mailman@pyramid.twistedmatrix.com> <000601c3968a$064f4f20$4b30fea9@laboratorio>
Message-ID: <20031019215041.GE832@radii>

On Sun, Oct 19, 2003 at 06:43:16PM -0300, Rita D?az y/o Rodrigo Benenson wrote:
> AirhookConnection is defined as:
> 
> class AirHookConnection(protocol.ConnectedDatagramProtocol,
> interfaces.IUDPConnectedTransport):

Uhmm... This is totally wrong. Interfaces aren't meant to be
subclassed in implementations. I don't know why the Khashmir author
did that.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From rdrb at 123.cl  Sun Oct 19 18:09:33 2003
From: rdrb at 123.cl (=?iso-8859-1?Q?Rita_D=EDaz_y/o_Rodrigo_Benenson?=)
Date: Sun, 19 Oct 2003 19:09:33 -0300
Subject: [Twisted-Python] Re: MetaInterface call error
Message-ID: <000b01c3968d$aef78cc0$4b30fea9@laboratorio>

Thanks ! Airhook now pass the unit test ! (and there is only one error in
the khashmir unit test).
But as you all know unit test only detect errors, and gives no information
about the existence of more bugs.
Thanks for a so fast response (real time mail support, wow...)
RodrigoB.




From stuart.hungerford at anu.edu.au  Mon Oct 20 00:35:32 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Mon, 20 Oct 2003 14:35:32 +1000
Subject: [Twisted-Python] Rendering Woven pages from non-Woven resources?
Message-ID: <6.0.0.22.0.20031020141949.01e35220@anusf.anu.edu.au>

Hi all,

I have a twisted web application that was created without the
benefit of Woven, where HTML is generated in subclasses of
Resource in the class' render() method.  This is my "old"
application.

I also have a "new" application where most HTML is generated
via subclasses of the Woven page class using various factory
methods etc.

I'd like to standardize both applications to use the Page
subclasses from the "new" application and the HTML they
generate.

So ideally I'd have:


        class new_page(twisted.web.woven.page.Page):
            isLeaf = 1
            templateFile = 'new.xhtml'

            def wmfactory_something(self, request)
                # etc


        # ...

        class old_resource(twisted.web.resource.Resource):
            isLeaf = 1
            def render(self, request):
                # get new_page() rendered from here


To make that last commented bit work, do I need to override
a new render() method for new_page that duplicates the
factory methods etc?  Or can I get the same effect another way?

Any advice much appreciated,


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From dp at twistedmatrix.com  Mon Oct 20 00:50:25 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 20 Oct 2003 00:50:25 -0400
Subject: [Twisted-Python] Rendering Woven pages from non-Woven resources?
In-Reply-To: <6.0.0.22.0.20031020141949.01e35220@anusf.anu.edu.au>
References: <6.0.0.22.0.20031020141949.01e35220@anusf.anu.edu.au>
Message-ID: <EB4ACAFD-02B8-11D8-8B58-000A95864FC4@twistedmatrix.com>

On Oct 20, 2003, at 12:35 AM, Stuart Hungerford wrote:
>

<snip>

>        class old_resource(twisted.web.resource.Resource):
>            isLeaf = 1
>            def render(self, request):
>                # get new_page() rendered from here

		return new_page().render(request)

Tada! :-)

dp




From likwoka at yahoo.com  Mon Oct 20 11:36:21 2003
From: likwoka at yahoo.com (Alex Li)
Date: Mon, 20 Oct 2003 08:36:21 -0700 (PDT)
Subject: [Twisted-Python] Use apache compatible log format from mktap/twistd?
Message-ID: <20031020153621.34509.qmail@web13901.mail.yahoo.com>

Hi all,

Is there a way to generate the twistd log (for webserver) in the Apache
format from mktap/twistd?  I want the Apache format because my log
analsyzer can understand it.

Thanks in advance,
Alex

__________________________________
Do you Yahoo!?
The New Yahoo! Shopping - with improved product search
http://shopping.yahoo.com



From fog at initd.org  Mon Oct 20 11:42:42 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Mon, 20 Oct 2003 17:42:42 +0200
Subject: [Twisted-Python] woven bug?
Message-ID: <1066664561.1144.79.camel@localhost>

hi,

i have a problem with woven loosing a <div> tag where, IMHO, it should
not. note the big IMHO, i still don't know woven that well. right now I
have a template that simply does:

    <div view="menu" />

and my Page subclass has a method for that view;

    def wvfactory_menu(self, request, node, model):
        return page.Page(templateFile="menu.xhtml",
                         templateDirectory=self.templateDirectory)

if the menu.xhtml file has the following structure:

<div id="menu">
  ...
</div>

the <div id="menu"> tag gets lost. the external div is correctly
replaced and has an id like "woven_id_xxxxxxxxxx" but the innermost div
(the one with id "menu") is not there anymore. right now i've found a
dirty hack:

<div id="menu">
<div id="menu">
  ...
</div>
</div>

but, obviously, i don't like at all. is that a woven bug or a
misinterpretation of how the node replacement works? is the outer tag of
a (sub)page always removed? and why?

ciao,
federico

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
  Nessuno dice che non si possa sognare in dettaglio, essere realistici
   e magari realizzarlo pure, il sogno.                        -- <dani>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio =?ISO-8859-1?Q?=E8?= firmata
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031020/d742c290/attachment.pgp 

From itamar at itamarst.org  Mon Oct 20 12:04:46 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 20 Oct 2003 12:04:46 -0400
Subject: [Twisted-Python] Use apache compatible log format from
 mktap/twistd?
In-Reply-To: <20031020153621.34509.qmail@web13901.mail.yahoo.com>
References: <20031020153621.34509.qmail@web13901.mail.yahoo.com>
Message-ID: <20031020120446.54e063d3.itamar@itamarst.org>

On Mon, 20 Oct 2003 08:36:21 -0700 (PDT)
Alex Li <likwoka at yahoo.com> wrote:

> Is there a way to generate the twistd log (for webserver) in the
> Apache format from mktap/twistd?  I want the Apache format because my
> log analsyzer can understand it.

mktap web ...youroptions... --logfile=/path//for/web.log

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From twisted-10152003 at atlas.lcs.mit.edu  Mon Oct 20 12:12:44 2003
From: twisted-10152003 at atlas.lcs.mit.edu (twisted-10152003 at atlas.lcs.mit.edu)
Date: Mon, 20 Oct 2003 12:12:44 -0400
Subject: [Twisted-Python] Ethernet frames
Message-ID: <20031020161244.GA8657@mit.edu>

I am very new to the twisted framework so maybe there is a completely
obvious answer to this question that is eluding me in the
documentation...

Can I use twisted to read and write ethernet frames? How do I listen
and write packets on a particular interface?  

Thanks,
Steve





From mesozoic at polynode.com  Mon Oct 20 12:29:45 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Mon, 20 Oct 2003 12:29:45 -0400
Subject: [Twisted-Python] woven bug?
In-Reply-To: <1066664561.1144.79.camel@localhost>
References: <1066664561.1144.79.camel@localhost>
Message-ID: <1066667385.9515.3.camel@hyla>

On Mon, 2003-10-20 at 11:42, Federico Di Gregorio wrote:
> <div view="menu" />

First off, you shouldn't do this. Since div is a block element,
according to XHTML specs it should be <div view="menu"></div>. But
that's not at issue here.

The top node of a template is not processed the same way its child nodes
are; in the past Donovan has tried to implement this, and [from what I
recall] it simply generated more problems than it was worth. The
solution is to have all your templates look like this:

<div><div id="menu">
 ...
</div></div>

As long as you're not applying any CSS style information to _all_ divs
(which you shouldn't be), this will not interfere with the presentation
of your pages.

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031020/3320fcea/attachment.pgp 

From fog at initd.org  Mon Oct 20 12:42:38 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Mon, 20 Oct 2003 18:42:38 +0200
Subject: [Twisted-Python] woven bug?
In-Reply-To: <1066667385.9515.3.camel@hyla>
References: <1066664561.1144.79.camel@localhost>
	 <1066667385.9515.3.camel@hyla>
Message-ID: <1066668157.1147.98.camel@localhost>

Il lun, 2003-10-20 alle 18:29, Alex Levy ha scritto:
> On Mon, 2003-10-20 at 11:42, Federico Di Gregorio wrote:
> > <div view="menu" />
> 
> First off, you shouldn't do this. Since div is a block element,
> according to XHTML specs it should be <div view="menu"></div>. But
> that's not at issue here.

hey, i was not aware of a difference between "<tag/>" and "<tag></tag>".
i always tought the first was just a contraction for the second. i'll go
re-read the xml specs. thank you very much. 

> The top node of a template is not processed the same way its child nodes
> are; in the past Donovan has tried to implement this, and [from what I
> recall] it simply generated more problems than it was worth. The
> solution is to have all your templates look like this:

so it is a feature. thank you very much for the clarification.

federico

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
                              Viviamo in un mondo reale, Ciccio. -- Lucy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio =?ISO-8859-1?Q?=E8?= firmata
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031020/906231e8/attachment.pgp 

From nbm at mithrandr.moria.org  Mon Oct 20 13:25:14 2003
From: nbm at mithrandr.moria.org (Neil Blakey-Milner)
Date: Mon, 20 Oct 2003 19:25:14 +0200
Subject: [Twisted-Python] Ethernet frames
In-Reply-To: <20031020161244.GA8657@mit.edu>
References: <20031020161244.GA8657@mit.edu>
Message-ID: <20031020172514.GA28277@mithrandr.moria.org>

On Mon 2003-10-20 (12:12), twisted-10152003 at atlas.lcs.mit.edu wrote:
> I am very new to the twisted framework so maybe there is a completely
> obvious answer to this question that is eluding me in the
> documentation...
> 
> Can I use twisted to read and write ethernet frames? How do I listen
> and write packets on a particular interface?  

I've used pylibpcap and http://mithrandr.moria.org/files/tipcap.py to
read ethernet frames.  pylibnet will be able to send them.  Someone else
on the list will mention the one Twisted library that provides an
alternative ("pair"?).

Neil
-- 
Neil Blakey-Milner
nbm at mithrandr.moria.org



From ccollier at viawest.net  Mon Oct 20 13:35:24 2003
From: ccollier at viawest.net (ccollier at viawest.net)
Date: Mon, 20 Oct 2003 11:35:24 -0600 (MDT)
Subject: [Twisted-Python] Ethernet frames
In-Reply-To: <20031020172514.GA28277@mithrandr.moria.org>
Message-ID: <Pine.LNX.4.44.0310201134420.17024-100000@radar.atomicservers.com>

While it's not Twisted based, you might find this useful:

http://www.cartel-securite.fr/pbiondi/scapy.html

You can manipulate packets with it, but I'm not sure about ethernet 
frames.

c


On Mon, 20 Oct 2003, Neil Blakey-Milner wrote:

> On Mon 2003-10-20 (12:12), twisted-10152003 at atlas.lcs.mit.edu wrote:
> > I am very new to the twisted framework so maybe there is a completely
> > obvious answer to this question that is eluding me in the
> > documentation...
> > 
> > Can I use twisted to read and write ethernet frames? How do I listen
> > and write packets on a particular interface?  
> 
> I've used pylibpcap and http://mithrandr.moria.org/files/tipcap.py to
> read ethernet frames.  pylibnet will be able to send them.  Someone else
> on the list will mention the one Twisted library that provides an
> alternative ("pair"?).
> 
> Neil
> 




From vlupien at drummonddesigns.com  Mon Oct 20 15:12:10 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Mon, 20 Oct 2003 15:12:10 -0400
Subject: [Twisted-Python] get data from a form
Message-ID: <000001c3973e$101f7750$687ba8c0@martin>

I have a form in one of my page and I want to get the data from this
form in an other web page.  I think I can use the model but I don't know
how to tranfer it to the second page.
 
vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031020/4668dd80/attachment.htm 

From dp at twistedmatrix.com  Mon Oct 20 15:20:19 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 20 Oct 2003 15:20:19 -0400
Subject: [Twisted-Python] woven bug?
In-Reply-To: <1066668157.1147.98.camel@localhost>
References: <1066664561.1144.79.camel@localhost> <1066667385.9515.3.camel@hyla> <1066668157.1147.98.camel@localhost>
Message-ID: <716E9CFC-0332-11D8-9517-000A95864FC4@twistedmatrix.com>

On Oct 20, 2003, at 12:42 PM, Federico Di Gregorio wrote:

> so it is a feature. thank you very much for the clarification.

I wouldn't call it a "feature" as much as a "the workaround is simple 
enough to explain, and the proper fix is difficult enough to implement, 
that I don't have time to do it properly"...

Thanks Alex for explaining the situation here.

dp




From foom at fuhm.net  Mon Oct 20 16:07:30 2003
From: foom at fuhm.net (James Y Knight)
Date: Mon, 20 Oct 2003 16:07:30 -0400
Subject: [Twisted-Python] woven bug?
In-Reply-To: <1066668157.1147.98.camel@localhost>
Message-ID: <0905582C-0339-11D8-8551-000A95A50FB2@fuhm.net>

On Monday, October 20, 2003, at 12:42 PM, Federico Di Gregorio wrote:

> hey, i was not aware of a difference between "<tag/>" and 
> "<tag></tag>".
> i always tought the first was just a contraction for the second. i'll 
> go
> re-read the xml specs. thank you very much.

It is, *if* you're talking to an XML parser. The issue is that XHTML is 
supposed to be backwards compatible with HTML4 parsers. They will 
interpret the <tag /> notation to mean the same thing as <tag>. Thus, 
using a block level element like div with that notation means an HTML4 
parser will think it never gets closed and will cause rendering errors.

James




From fog at initd.org  Mon Oct 20 17:17:11 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Mon, 20 Oct 2003 23:17:11 +0200
Subject: [Twisted-Python] woven bug?
In-Reply-To: <0905582C-0339-11D8-8551-000A95A50FB2@fuhm.net>
References: <0905582C-0339-11D8-8551-000A95A50FB2@fuhm.net>
Message-ID: <1066684631.1274.5.camel@localhost>

Il lun, 2003-10-20 alle 22:07, James Y Knight ha scritto:
> On Monday, October 20, 2003, at 12:42 PM, Federico Di Gregorio wrote:
> 
> > hey, i was not aware of a difference between "<tag/>" and 
> > "<tag></tag>".
> > i always tought the first was just a contraction for the second. i'll 
> > go
> > re-read the xml specs. thank you very much.
> 
> It is, *if* you're talking to an XML parser. The issue is that XHTML is 
> supposed to be backwards compatible with HTML4 parsers. They will 
> interpret the <tag /> notation to mean the same thing as <tag>. Thus, 
> using a block level element like div with that notation means an HTML4 
> parser will think it never gets closed and will cause rendering errors.

doh! you're right. knowing that the tag would be replaced by woven with
something meaningful i did not even looked at the problem from this
perspective. i suppose woven parse it as plain XML to build the dom
tree.

thank you very much, digging all that from the sources (as i did with
other pieces of twisted) would have been very long. :)

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
   Lasciate che i furetti vengano a me. -- Maria Luisa Benedetta Panzani
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio =?ISO-8859-1?Q?=E8?= firmata
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031020/911832d1/attachment.pgp 

From golux at comcast.net  Mon Oct 20 23:24:07 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Mon, 20 Oct 2003 23:24:07 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] Add a note about the subtleties of addDeferred
In-Reply-To: <E1ABg5l-0001nB-00@wolfwood>
References: <E1ABg5l-0001nB-00@wolfwood>
Message-ID: <3F94A6D7.1070409@comcast.net>

moshez CVS wrote:

> +<p>Note that adding deferreds to a <code>DeferredList</code> that has
> +been filled already will lead to unpredictable behavior. Only add
> +deferreds to a list that you know has not been filled yet (you can
> +check the <code>.called</code> attribute.</p>

Hm ... in that case, is there some reason not to say "called"
instead of "filled" here?

Steve.




From duke99 at email.ro  Tue Oct 21 07:32:32 2003
From: duke99 at email.ro (soso)
Date: Tue, 21 Oct 2003 14:32:32 +0300
Subject: [Twisted-Python] Deffered question
Message-ID: <200310211132.h9LBWWo16697@zerg.codec.ro>

Hi all, 

I need to implement a command based protocol, that is a client sends a command
to the server and waits for the response. Since the response computation might
be time consuming I have to choose between 2 solutions:
- use Twisted deffereds
- or write my own implementation, a TCP based threaded server. I'm not worried
about scaling since it will not be used by more than 10 clients at a time.

And the question is, how are deffereds actually implemented? My guess is that
there are some worker threads, besides the main thread. Or?

I actually started implementing my own server, Twisted seems too huge. But I may
change my mind, I'm new to both Python and Twisted.

Thanks


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From andrew-twisted at puzzling.org  Tue Oct 21 08:54:01 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 21 Oct 2003 22:54:01 +1000
Subject: [Twisted-Python] Deffered question
In-Reply-To: <200310211132.h9LBWWo16697@zerg.codec.ro>
References: <200310211132.h9LBWWo16697@zerg.codec.ro>
Message-ID: <20031021125401.GF28665@frobozz>

On Tue, Oct 21, 2003 at 02:32:32PM +0300, soso wrote:
> Hi all, 
> 
> I need to implement a command based protocol, that is a client sends a command
> to the server and waits for the response. Since the response computation might
> be time consuming I have to choose between 2 solutions:
> - use Twisted deffereds
> - or write my own implementation, a TCP based threaded server. I'm not worried
> about scaling since it will not be used by more than 10 clients at a time.
> 
> And the question is, how are deffereds actually implemented? My guess is that
> there are some worker threads, besides the main thread. Or?

Deferreds aren't magical at all; the implementation doesn't involve threads,
or anything behind the scenes at all.  By themselves, they don't magically
turn synchronous (i.e. blocking) code into asynchronous (i.e. non-blocking)
code.

They're simply a very convenient abstraction around the concept of a
"deferred result" that eases management of callbacks that operate on that
result.

See also:
    http://twistedmatrix.com/pipermail/twisted-python/2003-June/004333.html

> I actually started implementing my own server, Twisted seems too huge. But I may
> change my mind, I'm new to both Python and Twisted.

Twisted is huge, but then so is the Python standard library.  Twisted is
great for writing servers in.  The upcoming 1.1 release contains a tutorial
that should hopefully make understanding what you need to do to write a
server easier; you can preview the CVS version of it at:
    http://twistedmatrix.com/users/warner/doc-latest/howto/tutorial.html
(That's currently an 800kB page!)

Can you elaborate more on what the "response computation" involves?  If you
can, we can probably sketch out some code that does what you need.

Here's an example off the top of my head, though, that will hopefully help
you a little (warning, barely tested code):

----
from twisted.protocols import basic
from twisted.python import log
from twisted.internet import reactor, threads
from twisted.internet.protocol import ServerFactory

def square(n):
    return n*n

class SquaringProtocol(basic.LineReceiver):
    """A protocol that receives a number, squares it and sends back the
    result.
    
    This drops the connections after one request-response cycle,
    HTTP/1.0-style. 
    """
    
    def lineReceived(self, line):
        try:
            number = int(line)
        except ValueError:
            self.sendLine("%r is not a number" % line)
            return
        
        deferred = threads.deferToThread(square, number)
        # Convert the result to a string
        deferred.addCallback(str)
        # Send it
        deferred.addCallback(self.sendLine)
        # Write any errors to the log file
        deferred.addErrback(log.err)
        # Drop the connection
        deferred.addBoth(lambda x: self.transport.loseConnection())


class RepeatingSquaringProtocol(basic.LineReceiver):
    """A protocol that receives numbers, squares them, and sends back the
    results.
    
    This allows multiple requests to be made on a single connection, without
    waiting for responses.  The requests will queue up on the server, and be
    returned (in the order they were requested) as they are processed.  It
    is up to the client to disconnect.
    """
    
    def connectionMade(self):
        self.busy = 0
        self.queue = []
        
    def lineReceived(self, line):
        try:
            number = int(line)
        except ValueError:
            self.sendLine("%r is not a number" % line)
            return
        
        self.queueRequest(number)
    
    def queueRequest(self, number):
        if self.busy:
            self.queue.append(number)
        else:
            self.processRequest(number)

    def processRequest(self, number):
        deferred = threads.deferToThread(square, number)
        deferred.addCallback(str)
        deferred.addCallback(self.requestDone)
        deferred.addErrback(log.err)

    def requestDone(self, result):
        self.sendLine(result)
        if self.queue:
            number = self.queue.pop(0)
            self.processRequest(number)
        else:
            self.busy = 0
        

if __name__ == '__main__':
    from twisted.python import log
    import sys
    log.startLogging(sys.stdout)
    factory = ServerFactory()
    factory.protocol = SquaringProtocol
    reactor.listenTCP(9001, factory)
    factory = ServerFactory()
    factory.protocol = RepeatingSquaringProtocol
    reactor.listenTCP(9002, factory)
    reactor.run()

----

This example has two slightly different versions of a simple protocol that
squares numbers.  I'm pretending that squaring a number is a slow
calculation that is best run in a worker thread -- imagine your computation
where I'm using 'square'.

Hopefully it gives you an idea of how easy this sort of thing is in Twisted.

-Andrew.




From duke99 at email.ro  Tue Oct 21 09:38:30 2003
From: duke99 at email.ro (soso)
Date: Tue, 21 Oct 2003 16:38:30 +0300
Subject: [Twisted-Python] Deffered question
Message-ID: <200310211338.h9LDcVA22573@zerg.codec.ro>

Hello Andrew, 

Thanks a lot for your detailed answer. The examples you gave made things more
clear now.

> Twisted is huge, but then so is the Python standard library.  Twisted is
> great for writing servers in.  The upcoming 1.1 release contains a tutorial
> that should hopefully make understanding what you need to do to write a
> server easier; you can preview the CVS version of it at:
>     http://twistedmatrix.com/users/warner/doc-latest/howto/tutorial.html
> (That's currently an 800kB page!)

That's great! The documentation is compatible with version 1.0.7?

> Can you elaborate more on what the "response computation" involves?  If you
> can, we can probably sketch out some code that does what you need.

Well, basically I want to write a SNMP management system. The server will query
one or more SNMP servers, receive traps, and save all results in a database. A
client can connect to the server and ask for statistics, or query a SNMP server
(through the application server); both this kind of requests may be time-consuming.
So after seeing your examples, I think that this time consuming server
operations (database, and SNMP queries) should be deffered to a pool of worker
threads.

Ok, now a problem that I heard of is Twisted interaction with wxPython. I did
not test it, but if you or anyone else can confirm that it can work ok it would
be nice. I would like to be able to send commands to server from a modal dialog
and receive back the response. Is it possible?

Thanks,
soso



______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From matteo.giacomazzi at libero.it  Tue Oct 21 09:59:57 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Tue, 21 Oct 2003 15:59:57 +0200
Subject: [Twisted-Python] Deffered question
In-Reply-To: <200310211132.h9LBWWo16697@zerg.codec.ro>
References: <200310211132.h9LBWWo16697@zerg.codec.ro>
Message-ID: <1493025718.20031021155957@libero.it>

Hi,

> I need to implement a command based protocol, that is a client sends
> a  command  to  the  server  and  waits  for the response. Since the
> response  computation  might  be  time  consuming  I  have to choose
> between 2 solutions:
> - use Twisted deffereds
> - or  write my own implementation, a TCP based threaded server. I'm
> not  worried about scaling since it will not be used by more than 10
> clients at a time.

I'm facing a problem like this.

I  used  to  have  a multithreaded server (fully written using Python)
that  accepted  commands  via  a  TCP  or  UNIX  socket, elaborate the
response  (tipically  querying  some remote servers via HTTP) and then
returned the response: one query, one thread.

This  server  runs  since  2001, I updated it, upgraded and refactored
some parts, but it's still kinda "heavy" to manage.
So, I realized that multithred is not _always_ the solution.

In  my case, the server was running (with a web server and a DB server
too) on a dual Xeon architecture. So, at most, two threads are running
on  the  same time but there are more chances that only one of them is
running while the other CPU is used by the web server or the DB.

That's the solution I'm building:
- there are different _processes_, one for every kind of remote server
I have to query;
- _processes_ may run on different (hardware) servers;
- processes  communicate via a  "message passing process" I wrote with
Twisted;

So:  one  process  accepts commands via TCP or UNIX socket, it quickly
parses  the  command and sends a message to the right ``server''; this
``server''  process  the command, does-whatever-it-needs and then send
the response to the first process that, in turn, quickly translates it
in a ``line oriented'' way and returns to the caller.

All  the servers are single-thread: that's because I need only to call
a  remote  host  and  to compute very very simple operations. Maybe in
your case threads would help - but how many threads?

I  would be interested in hearing opinion about this architecture from
Twisted experts.

Kindest regards,
 Matteo




From busch at transporeon.com  Tue Oct 21 10:25:26 2003
From: busch at transporeon.com (Axel Busch)
Date: Tue, 21 Oct 2003 16:25:26 +0200
Subject: AW: [Twisted-Python] Deffered question
In-Reply-To: <200310211338.h9LDcVA22573@zerg.codec.ro>
Message-ID: <004e01c397df$2c902050$4600a8c0@atlas>

> Ok, now a problem that I heard of is Twisted interaction with wxPython. I
did
> not test it, but if you or anyone else can confirm that it can work ok it
would
> be nice. I would like to be able to send commands to server from a modal
dialog
> and receive back the response. Is it possible?

Yep. I posted some examples several weeks ago, and Stephen was 
so nice as to test and refine them. 
He posted them on 2003-10-14 under the subject 
  "[Twisted-Python] PB/wx example pbwxthingy".
Just contact me if you need any help.

Regards, Axel




From duke99 at email.ro  Tue Oct 21 13:56:28 2003
From: duke99 at email.ro (soso)
Date: Tue, 21 Oct 2003 20:56:28 +0300
Subject: AW: [Twisted-Python] Deffered question
Message-ID: <200310211756.h9LHuSx07857@zerg.codec.ro>

Hello Axel,

Thanks for your help. I found the message by browsing the list archive but I
can't get the source code which is attached. I tried to manually decode it from
base64 but I didn't succeed. 
Do you, or others, have the source code archive?

Thanks in advance,
soso


> Yep. I posted some examples several weeks ago, and Stephen was 
> so nice as to test and refine them. 
> He posted them on 2003-10-14 under the subject 
>   "[Twisted-Python] PB/wx example pbwxthingy".
> Just contact me if you need any help.
> 
> Regards, Axel


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From busch at transporeon.com  Tue Oct 21 14:15:59 2003
From: busch at transporeon.com (Axel Busch)
Date: Tue, 21 Oct 2003 20:15:59 +0200
Subject: AW: AW: [Twisted-Python] Deffered question
In-Reply-To: <200310211756.h9LHuSx07857@zerg.codec.ro>
Message-ID: <005a01c397ff$60e215f0$4600a8c0@atlas>

hm, I had no problems with the archive. 
I extracted it, zipped it, and put it to 
https://www.transporeon.org/twisted/ for you to
download.

Greetings -xl

> -----Urspr?ngliche Nachricht-----
> Von: twisted-python-admin at twistedmatrix.com 
> [mailto:twisted-python-admin at twistedmatrix.com] Im Auftrag von soso
> Gesendet: Dienstag, 21. Oktober 2003 19:56
> An: twisted-python at twistedmatrix.com
> Betreff: Re: AW: [Twisted-Python] Deffered question
> 
> 
> Hello Axel,
> 
> Thanks for your help. I found the message by browsing the 
> list archive but I
> can't get the source code which is attached. I tried to 
> manually decode it from
> base64 but I didn't succeed. 
> Do you, or others, have the source code archive?
> 
> Thanks in advance,
> soso
> 
> 
> > Yep. I posted some examples several weeks ago, and Stephen was 
> > so nice as to test and refine them. 
> > He posted them on 2003-10-14 under the subject 
> >   "[Twisted-Python] PB/wx example pbwxthingy".
> > Just contact me if you need any help.
> > 
> > Regards, Axel
> 
> 
> ______________________________________________________________________
> Do you want a free e-mail for life ? Get it at http://www.email.ro/
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From duke99 at email.ro  Tue Oct 21 14:32:42 2003
From: duke99 at email.ro (soso)
Date: Tue, 21 Oct 2003 21:32:42 +0300
Subject: AW: [Twisted-Python] Deffered question
Message-ID: <200310211832.h9LIWgR16747@zerg.codec.ro>

Hi,

Thanks a lot for sending the archive Axel and Matteo!

soso

> hm, I had no problems with the archive. 
> I extracted it, zipped it, and put it to 
> https://www.transporeon.org/twisted/ for you to
> download.
> 


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From busch at transporeon.com  Tue Oct 21 14:35:44 2003
From: busch at transporeon.com (Axel Busch)
Date: Tue, 21 Oct 2003 20:35:44 +0200
Subject: [Twisted-Python] Reactor interface for system configuration and events?
In-Reply-To: <422E7F7C-0254-11D8-B59D-000A95686CD8@redivi.com>
Message-ID: <005b01c39802$233e0710$4600a8c0@atlas>

Hi Bob,

> I've just wrapped the SystemConfiguration interface from Darwin 
> (part of the configd project, which is open source under APSL).  
-snip-
> Surely some or all of this is applicable to Win32 and Linux.  Anyone 
> knowledgeable about this sort of API on those platforms?  We should 
> develop an interface to deal with this stuff.

coool. I'm very interested in the reactor interface you proposed. 
Maybe I can help with win32. 

But tell me, I thought twisted is pure python, so how are we 
going to integrate this for win32? The win32all extension does 
not provide the means to do it. 
I could write a .pyd module with c++ and boost. Would this help? 

Some things we would have to think of: For most of the stuff there 
is some difference between 95/98/ME, NT4/2000 and XP/2003. Some 
things will even not be available for 95/98/ME, like some Battery 
states etc. 
Most information should be available through Windows Messages 
like WM_USERCHANGED, WM_DEVICECHANGE etc., so polling is not 
required. Unfortunately 95/98/ME does not broadcast WM_DEVICECHANGE  
for all required device events. 
Well, just some thoughts, I didn't have time to try anything yet.

Regards, -xl





From vlupien at drummonddesigns.com  Tue Oct 21 15:08:14 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Tue, 21 Oct 2003 15:08:14 -0400
Subject: [Twisted-Python] Form with formprocessor
Message-ID: <000001c39806$add26b60$687ba8c0@vicky>

I have a form and I'm using formprocessor for validation.  I want to get
the original form if there's an error and an other page in case of
everything is alright.
I tried to call formprocessor with callback=self and errback=self but it
cause a strange error.
 
Please someone help me, I'm really tired not to be able to use a form.
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031021/92ec1d3a/attachment.htm 

From bob at redivi.com  Tue Oct 21 15:22:35 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 21 Oct 2003 15:22:35 -0400
Subject: [Twisted-Python] Reactor interface for system configuration and events?
In-Reply-To: <005b01c39802$233e0710$4600a8c0@atlas>
Message-ID: <ECB844B1-03FB-11D8-A87E-000A95686CD8@redivi.com>

On Tuesday, Oct 21, 2003, at 14:35 America/New_York, Axel Busch wrote:

>> I've just wrapped the SystemConfiguration interface from Darwin
>> (part of the configd project, which is open source under APSL).
> -snip-
>> Surely some or all of this is applicable to Win32 and Linux.  Anyone
>> knowledgeable about this sort of API on those platforms?  We should
>> develop an interface to deal with this stuff.
>
> coool. I'm very interested in the reactor interface you proposed.
> Maybe I can help with win32.
>
> But tell me, I thought twisted is pure python, so how are we
> going to integrate this for win32? The win32all extension does
> not provide the means to do it.
> I could write a .pyd module with c++ and boost. Would this help?

Yes, we'd need to write an extension or depend on ctypes to do this for 
win32 if win32all can't do it.  Twisted is not "pure python", but it 
will work without any C extension modules.

> Some things we would have to think of: For most of the stuff there
> is some difference between 95/98/ME, NT4/2000 and XP/2003. Some
> things will even not be available for 95/98/ME, like some Battery
> states etc.
> Most information should be available through Windows Messages
> like WM_USERCHANGED, WM_DEVICECHANGE etc., so polling is not
> required. Unfortunately 95/98/ME does not broadcast WM_DEVICECHANGE
> for all required device events.
> Well, just some thoughts, I didn't have time to try anything yet.

Well if it's not available, it won't work.. perhaps we'd have to divide 
it up into multiple interfaces, and have some sort of gestalt mechanism 
where you can ask if the reactor can provide the service on the 
particular platform it's currently running on.

-bob




From exarkun at intarweb.us  Tue Oct 21 18:40:29 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 21 Oct 2003 18:40:29 -0400
Subject: [Twisted-Python] Form with formprocessor
In-Reply-To: <000001c39806$add26b60$687ba8c0@vicky>
References: <000001c39806$add26b60$687ba8c0@vicky>
Message-ID: <20031021224029.GA28312@intarweb.us>

On Tue, Oct 21, 2003 at 03:08:14PM -0400, vicky lupien wrote:
> I have a form and I'm using formprocessor for validation.  I want to get
> the original form if there's an error and an other page in case of
> everything is alright.
> I tried to call formprocessor with callback=self and errback=self but it
> cause a strange error.
>  
> Please someone help me, I'm really tired not to be able to use a form.
>  

  Vicky, looking over your posting history it seems like you don't have much
luck getting answers to your questions.  I don't know anything about form
processing with twisted.web, so I can't answer your questions directly,
however maybe I can help in another way.

  First, if you include a very short program that tries to do what you want
to accomplish, but fails in a predictable way, people will be able to run
it, see what went wrong, and possibly suggest fixes.  This is much easier
for people than trying to guess exactly what you're doing, and exactly how
it's failing.

  Second, if you include the traceback you get when you attempt something,
along with a few lines of context surrounding the line that causes the
problem, people familiar with the part of Twisted you are working with might
be able to guess the problem right off.  This isn't as good as including a
minimal example (as described in the previous paragraph), but it is
sometimes enough to get what help you need.

  Third, a more general description of what you're trying to accomplish
is often useful.  With this information, people can get a sense of why
you're doing what you're doing, and with an understanding of your goal,
suggest courses of actions (including dropping whatever your current
approach is and starting from a direction you might not have considered).

  Last, in case you aren't aware of it, many Twisted developers are also
active on IRC (irc.freenode.net) in #twisted.  If you're still unable to get
help on the mailing list, logging on there and poking people might be a way
to make progress.  Sometimes there are communication problems that are hard
to resolve via email but are easily worked out in a more interactive medium.

  Hope this helps,

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031021/9ede8bdb/attachment.pgp 

From matteo.giacomazzi at libero.it  Wed Oct 22 03:41:13 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Wed, 22 Oct 2003 09:41:13 +0200
Subject: [Twisted-Python] HTTP Client - HOW TO?
Message-ID: <1674168296.20031022094113@libero.it>

Hi all,

  I'm  writing  a  software  that needs to query some remote hosts via
  HTTP  (sometimes using GET method, sometimes using POST method): the
  problem is I cannot figure out how I should use the HTTPClient class
  or the QueryProtocol class... any hint somewhere?
  I'm not able to find anything useful in the API docs.

  Any help will be greatly appreciated!

  Many thanks in advance.

Regards,
 Matteo




From andrew-twisted at puzzling.org  Wed Oct 22 04:10:41 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 22 Oct 2003 18:10:41 +1000
Subject: [Twisted-Python] HTTP Client - HOW TO?
In-Reply-To: <1674168296.20031022094113@libero.it>
References: <1674168296.20031022094113@libero.it>
Message-ID: <20031022081041.GD21523@frobozz>

On Wed, Oct 22, 2003 at 09:41:13AM +0200, Matteo Giacomazzi wrote:
> Hi all,
> 
>   I'm  writing  a  software  that needs to query some remote hosts via
>   HTTP  (sometimes using GET method, sometimes using POST method): the
>   problem is I cannot figure out how I should use the HTTPClient class
>   or the QueryProtocol class... any hint somewhere?
>   I'm not able to find anything useful in the API docs.
> 
>   Any help will be greatly appreciated!

It's hardly a proper how-to, but hopefully this will help:

    http://twistedmatrix.com/documents/examples/getpage.py

-Andrew.




From matteo.giacomazzi at libero.it  Wed Oct 22 04:43:49 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Wed, 22 Oct 2003 10:43:49 +0200
Subject: [Twisted-Python] HTTP Client - HOW TO?
In-Reply-To: <20031022081041.GD21523@frobozz>
References: <1674168296.20031022094113@libero.it>
 <20031022081041.GD21523@frobozz>
Message-ID: <1197924484.20031022104349@libero.it>

Hi Andrew,

>>   Any help will be greatly appreciated!

> It's hardly a proper how-to, but hopefully this will help:

>     http://twistedmatrix.com/documents/examples/getpage.py

Thanks!
I  was  looking  at  the  twisted/web/client.py  as  per suggestion of
Moshez,  via  IRC,  and  in  fact  I'm  going  to  understand  how the
HTTPClient class works.

Looking  at the code of getPage, it seems that I can pass a parameter,
called  `postdata',  and  it will use the content of that parameter to
send the POST payload - am I right?

Many thanks!

Regards,
 Matteo




From matteo.giacomazzi at libero.it  Wed Oct 22 06:40:23 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Wed, 22 Oct 2003 12:40:23 +0200
Subject: [Twisted-Python] Timeouts
Message-ID: <5814917750.20031022124023@libero.it>

Hi all,

  I'm  doing  some  tests  with  twisted.web.client  and it is working
  pretty fine!

  I've  just  a  doubt: the function getPage accepts a parameter named
  `timeout'  (well,  it  takes it as a **kwarg and pass it along up to
  the factory).
  BTW,  this  is  the  timeout  in  seconds: if the remote host didn't
  return a response within that time, the errback is called.

  Now  the  question:  what  happens  if the remote IP address doesn't
  respond at all (host unreachable)?
  I'm testing it and it seems that the timeout never occours!
  Does it mean that the whole thread is blocked?
  The socket.connect method is blocking?

  Many thanks in advance!

Regards
 Matteo




From justinjohnson at fastmail.fm  Wed Oct 22 14:24:42 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 22 Oct 2003 12:24:42 -0600
Subject: [Twisted-Python] twistd and win32 service
Message-ID: <20031022182442.26FA93D802@www.fastmail.fm>

Is it possible to have twistd run a .tap but do so within a windows
service?

The general consensus on the mailing list archives seems to be that I'd
need to setup my code to not require twistd but just run standalone. 
However, since I'm running on windows I'd like to have twistd handle
loading the win32eventreactor for me so I don't have to worry about
import orders and all that.

Thanks.
-Justin



From itamar at itamarst.org  Wed Oct 22 14:50:10 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 22 Oct 2003 14:50:10 -0400
Subject: [Twisted-Python] twistd and win32 service
In-Reply-To: <20031022182442.26FA93D802@www.fastmail.fm>
References: <20031022182442.26FA93D802@www.fastmail.fm>
Message-ID: <20031022145010.12e64a54.itamar@itamarst.org>

On Wed, 22 Oct 2003 12:24:42 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> The general consensus on the mailing list archives seems to be that
> I'd need to setup my code to not require twistd but just run
> standalone. 

Uh. *Maybe* that's the consensus, but it's not actually correct. You can
have a tap or tac run as a NT service.

Lets say you have  a script "server.py" that is runnable with "twistd
-y", you can do (and similar code will work for TAPs):

import sys, os
import win32serviceutil, win32service


class MyService(win32serviceutil.ServiceFramework):
    """NT Service."""
    
    _svc_name_ = "MyService"
    _svc_display_name_ = "MyService server"

    def SvcDoRun(self):
        import server
        f = open(os.path.join(server.rootPath, "cyberhigh.log"), 'a')
        from twisted.python.log import startLogging
        from twisted.application.app import startApplication
        from twisted.internet import reactor        
        startLogging(f)
        startApplication(server.application, 0)
        reactor.run()
    
    def SvcStop(self):
        self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
        from twisted.internet import reactor
        reactor.stop()


if __name__ == '__main__':
    win32serviceutil.HandleCommandLine(MyService)


-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From scosol at yahoo.com  Wed Oct 22 15:56:37 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Wed, 22 Oct 2003 12:56:37 -0700 (PDT)
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031022145010.12e64a54.itamar@itamarst.org>
Message-ID: <20031022195637.10110.qmail@web13902.mail.yahoo.com>

So- my needs are simple- all I need to do is accept a
web request containing some POST data, query my DB,
then return a result.

I think I've wrapped my head around the individual
components needed here, but I simply don't know how I
*should* be doing it.

I know I need twisted.enterprise.adbapi talking to my
db, and then twisted.web handling the incoming
requests, but from there it gets a little fuzzy.

What should go in my .rpy?
I remember somewhere in the docs it saying that the
.rpy should only be a few lines.
Is this just speaking about making it import my code
instead of actually containing my code?
(I'm still thinking in PERL/CGI style where I would
just make the .rpy the app itself)

Should I be using woven? (I think not- I have no heavy
presentation needs)

And then- why am I "supposed" to use twisted.app?
I don't need app-level persistance, and this is on
dedicated machines where I can just background the
process in the startup scripts- so daemonization is
not needed? Am I missing something in that?

Ugh- I guess I'm just asking for best-practices for
the scenario above... thanks :)

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From duke99 at email.ro  Wed Oct 22 16:28:31 2003
From: duke99 at email.ro (soso)
Date: Wed, 22 Oct 2003 23:28:31 +0300
Subject: [Twisted-Python] Weird thread count
Message-ID: <200310222028.h9MKSVH11490@zerg.codec.ro>

Hello all, 

The following client code creates 3 threads on startup, even if there is no
server to connect to. And I have no clue why. I'm running on Win2k and that's
what taskmanager says. Any ideas?

<<<<<<<<<<<<<<<<<<<<<<
from twisted.internet.protocol import Protocol, ClientFactory
from twisted.internet import reactor

class CommProtocol(Protocol):
    
    def connectionMade(self):
        print 'Connected'
        self.transport.write("Hello there...")
        
    def connectionLost(self, reason):
        print 'Connection lost: ', reason
        
    def dataReceived(self, data):
        print 'Data received: ', str(data)
        
class CommFactory(ClientFactory):
    
    protocol = CommProtocol
    
    def clientConnectionFailed(self, connector, reason):
        print "Failed to connect: ", reason
        
host = 'localhost'
port = 8000

reactor.connectTCP(host, port, CommFactory())
reactor.run()
>>>>>>>>>>>>>>>>>>>>>>>>>


Thanks,
soso

______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From duke99 at email.ro  Wed Oct 22 16:29:38 2003
From: duke99 at email.ro (soso)
Date: Wed, 22 Oct 2003 23:29:38 +0300
Subject: [Twisted-Python] Weird thread count
Message-ID: <200310222029.h9MKTcY17720@zerg.codec.ro>

Hello all, 

The following client code creates 3 threads on startup, even if there is no 
server to connect to. And I have no clue why. I'm running on Win2k and that's 
what taskmanager says. Any ideas?

<<<<<<<<<<<<<<<<<<<<<<
from twisted.internet.protocol import Protocol, ClientFactory
from twisted.internet import reactor

class CommProtocol(Protocol):
    
    def connectionMade(self):
        print 'Connected'
        self.transport.write("Hello there...")
        
    def connectionLost(self, reason):
        print 'Connection lost: ', reason
        
    def dataReceived(self, data):
        print 'Data received: ', str(data)
        
class CommFactory(ClientFactory):
    
    protocol = CommProtocol
    
    def clientConnectionFailed(self, connector, reason):
        print "Failed to connect: ", reason
        
host = 'localhost'
port = 8000

reactor.connectTCP(host, port, CommFactory())
reactor.run()
>>>>>>>>>>>>>>>>>>>>>>>>>


Thanks,
soso



______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From duke99 at email.ro  Wed Oct 22 16:29:45 2003
From: duke99 at email.ro (soso)
Date: Wed, 22 Oct 2003 23:29:45 +0300
Subject: [Twisted-Python] Weird thread count
Message-ID: <200310222029.h9MKTjR18417@zerg.codec.ro>

Hello all, 

The following client code creates 3 threads on startup, even if there is no 
server to connect to. And I have no clue why. I'm running on Win2k and that's 
what taskmanager says. Any ideas?

<<<<<<<<<<<<<<<<<<<<<<
from twisted.internet.protocol import Protocol, ClientFactory
from twisted.internet import reactor

class CommProtocol(Protocol):
    
    def connectionMade(self):
        print 'Connected'
        self.transport.write("Hello there...")
        
    def connectionLost(self, reason):
        print 'Connection lost: ', reason
        
    def dataReceived(self, data):
        print 'Data received: ', str(data)
        
class CommFactory(ClientFactory):
    
    protocol = CommProtocol
    
    def clientConnectionFailed(self, connector, reason):
        print "Failed to connect: ", reason
        
host = 'localhost'
port = 8000

reactor.connectTCP(host, port, CommFactory())
reactor.run()
>>>>>>>>>>>>>>>>>>>>>>>>>


Thanks,
soso



______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From itamar at itamarst.org  Wed Oct 22 16:44:39 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 22 Oct 2003 16:44:39 -0400
Subject: [Twisted-Python] Weird thread count
In-Reply-To: <200310222028.h9MKSVH11490@zerg.codec.ro>
References: <200310222028.h9MKSVH11490@zerg.codec.ro>
Message-ID: <20031022164439.343fcbfe.itamar@itamarst.org>

On Wed, 22 Oct 2003 23:28:31 +0300
soso <duke99 at email.ro> wrote:

> The following client code creates 3 threads on startup, even if there
> is no server to connect to. And I have no clue why. I'm running on
> Win2k and that's what taskmanager says. Any ideas?

Presumably those are internal Python threads. Try running just Python
and see how many threads there are.

Also note that Twisted doesn't use threads for networking), so number of
networking connections is irrelevant.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From cce at clarkevans.com  Wed Oct 22 17:02:49 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Wed, 22 Oct 2003 14:02:49 -0700
Subject: [Twisted-Python] Weird thread count
In-Reply-To: <20031022164439.343fcbfe.itamar@itamarst.org>
References: <200310222028.h9MKSVH11490@zerg.codec.ro> <20031022164439.343fcbfe.itamar@itamarst.org>
Message-ID: <20031022210249.GC27474@clarkevans.com>

soso,

  You can also compile Python without threads... ;)

Clark

On Wed, Oct 22, 2003 at 04:44:39PM -0400, Itamar Shtull-Trauring wrote:
| On Wed, 22 Oct 2003 23:28:31 +0300
| soso <duke99 at email.ro> wrote:
| 
| > The following client code creates 3 threads on startup, even if there
| > is no server to connect to. And I have no clue why. I'm running on
| > Win2k and that's what taskmanager says. Any ideas?
| 
| Presumably those are internal Python threads. Try running just Python
| and see how many threads there are.
| 
| Also note that Twisted doesn't use threads for networking), so number of
| networking connections is irrelevant.
| 
| -- 
| Itamar Shtull-Trauring    http://itamarst.org/
| Available for Python & Twisted consulting
| 
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From duke99 at email.ro  Wed Oct 22 17:19:15 2003
From: duke99 at email.ro (soso)
Date: Thu, 23 Oct 2003 00:19:15 +0300
Subject: [Twisted-Python] Weird thread count
Message-ID: <200310222119.h9MLJGa09856@zerg.codec.ro>

Yep, that's why I thought is weird. 
Anyway, I double-checked. I restarted the computer and checked with Spy++ too.
Still 3 threads...

Also, if you remove the "reactor.connectTCP..." line it behaves ok, only 1 thread.

> On Wed, 22 Oct 2003 23:28:31 +0300
> soso <duke99 at email.ro> wrote:
> 
> > The following client code creates 3 threads on startup, even if there
> > is no server to connect to. And I have no clue why. I'm running on
> > Win2k and that's what taskmanager says. Any ideas?
> 
> Presumably those are internal Python threads. Try running just Python
> and see how many threads there are.
> 
> Also note that Twisted doesn't use threads for networking), so number of
> networking connections is irrelevant.
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 





______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From bob at redivi.com  Wed Oct 22 17:45:19 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 22 Oct 2003 17:45:19 -0400
Subject: [Twisted-Python] Weird thread count
In-Reply-To: <200310222119.h9MLJGa09856@zerg.codec.ro>
References: <200310222119.h9MLJGa09856@zerg.codec.ro>
Message-ID: <07A83862-04D9-11D8-A1F1-000A95686CD8@redivi.com>

On Oct 22, 2003, at 5:19 PM, soso wrote:

> Yep, that's why I thought is weird.
> Anyway, I double-checked. I restarted the computer and checked with 
> Spy++ too.
> Still 3 threads...
>
> Also, if you remove the "reactor.connectTCP..." line it behaves ok, 
> only 1 thread.
>
>> On Wed, 22 Oct 2003 23:28:31 +0300
>> soso <duke99 at email.ro> wrote:
>>
>>> The following client code creates 3 threads on startup, even if there
>>> is no server to connect to. And I have no clue why. I'm running on
>>> Win2k and that's what taskmanager says. Any ideas?
>>
>> Presumably those are internal Python threads. Try running just Python
>> and see how many threads there are.
>>
>> Also note that Twisted doesn't use threads for networking), so number 
>> of
>> networking connections is irrelevant.

Windows may use threads in its implementation of select(), or something.

Why does it matter, anyways?  Twisted doesn't explicitly create any 
threads unless you ask it to.

-bob




From maoy at cis.upenn.edu  Wed Oct 22 22:37:51 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 22 Oct 2003 22:37:51 -0400 (EDT)
Subject: [Twisted-Python] new cred related examples?
In-Reply-To: <20031022210249.GC27474@clarkevans.com>
Message-ID: <Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>

Hi,

  Do we have any cred related examples? like how to do authentication, 
encryption, etc? Thank you!


Yun






From andrew-twisted at puzzling.org  Wed Oct 22 23:02:35 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 23 Oct 2003 13:02:35 +1000
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031022195637.10110.qmail@web13902.mail.yahoo.com>
References: <20031022145010.12e64a54.itamar@itamarst.org> <20031022195637.10110.qmail@web13902.mail.yahoo.com>
Message-ID: <20031023030235.GA24973@frobozz>

On Wed, Oct 22, 2003 at 12:56:37PM -0700, Nathan Seven wrote:
> 
> I know I need twisted.enterprise.adbapi talking to my
> db, and then twisted.web handling the incoming
> requests, but from there it gets a little fuzzy.

(Just to confuse you even more, you don't *need* adbapi; you can ignore it
and do DB work in your own threads if that's more convenient.  adbapi is
probably what you want, though :)

> What should go in my .rpy?
> I remember somewhere in the docs it saying that the
> .rpy should only be a few lines.
> Is this just speaking about making it import my code
> instead of actually containing my code?

Yep, that's right.

> (I'm still thinking in PERL/CGI style where I would
> just make the .rpy the app itself)

Yeah, don't do that :)

> Should I be using woven? (I think not- I have no heavy
> presentation needs)

I think you're probably right here, too.  It's pretty easy to just write
your own Twisted Web resources, if all you need is simple stuff.

> And then- why am I "supposed" to use twisted.app?
> I don't need app-level persistance, and this is on
> dedicated machines where I can just background the
> process in the startup scripts- so daemonization is
> not needed? Am I missing something in that?

I'll let someone who actually knows something about the new app stuff answer
this :)

-Andrew.




From glyph at twistedmatrix.com  Wed Oct 22 23:03:34 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 22 Oct 2003 23:03:34 -0400
Subject: [Twisted-Python] new cred related examples?
In-Reply-To: <Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>
References: <Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>
Message-ID: <3F974506.3060009@twistedmatrix.com>

Yun Mao wrote:
> Hi,
> 
>   Do we have any cred related examples? like how to do authentication, 
> encryption, etc? Thank you!

You might want to check out Quotient CVS (www.divmod.org): we just 
implemented an authentication database and realm.

But, uh, encryption?  cred is an authentication framework.  You'd have 
to do encryption in your protocol...?




From itamar at itamarst.org  Wed Oct 22 23:17:49 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 22 Oct 2003 23:17:49 -0400
Subject: [Twisted-Python] new cred related examples?
In-Reply-To: <Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>
References: <20031022210249.GC27474@clarkevans.com>
	<Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>
Message-ID: <20031022231749.74895e9f.itamar@itamarst.org>

On Wed, 22 Oct 2003 22:37:51 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

>   Do we have any cred related examples? like how to do authentication,
>   
> encryption, etc? Thank you!

1.1 has documentation (ETA in 2 days, you can get rc2 if you want). Or,
CVS docs are available at
http://twistedmatrix.com/users/warner/doc-latest/howto/cred.html

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From tv at tv.debian.net  Mon Oct 20 13:59:54 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Mon, 20 Oct 2003 20:59:54 +0300
Subject: [Twisted-Python] Ethernet frames
In-Reply-To: <20031020161244.GA8657@mit.edu>
References: <20031020161244.GA8657@mit.edu>
Message-ID: <3F94229A.5040307@tv.debian.net>

twisted-10152003 at atlas.lcs.mit.edu wrote:
> Can I use twisted to read and write ethernet frames? How do I listen
> and write packets on a particular interface?  

Well, there's doc/examples/pairudp.py, which uses twisted.pair to 
read/write packets on TUN/TAP virtual interfaces.

In twisted.protocols, you will see ethernet, ip and rawup modules,
helping you to parse raw packets.

The same thing can be hooked into e.g. pcap, or directly to raw sockets, 
and packet sockets. That part hasn't been written yet, but should be 
relatively straightforward.




From duke99 at email.ro  Mon Oct 20 15:22:34 2003
From: duke99 at email.ro (soso)
Date: Mon, 20 Oct 2003 22:22:34 +0300
Subject: [Twisted-Python] Deffered question
Message-ID: <200310201922.h9KJMYo05280@zerg.codec.ro>

Hi all, 

I need to implement a command based protocol, that is a client sends a command
to the server and waits for the response. Since the response computation might
be time consuming I have to choose between 2 solutions:
- use Twisted deffereds
- or write my own implementation, a TCP based threaded server. I'm not worried
about scaling since it will not be used by more than 10 clients at a time.

And the question is, how are deffereds actually implemented? My guess is that
there are some worker threads, besides the main thread. Or?

I actually started implementing my own server, Twisted seems too huge. But I may
change my mind, I'm new to both Python and Twisted.

Thanks


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From m at zadka.site.co.il  Thu Oct 23 01:44:54 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 23 Oct 2003 05:44:54 -0000
Subject: [Twisted-Python] twistd and win32 service
In-Reply-To: <20031022145010.12e64a54.itamar@itamarst.org>
References: <20031022145010.12e64a54.itamar@itamarst.org>, <20031022182442.26FA93D802@www.fastmail.fm>
Message-ID: <20031023054454.14113.qmail@green.zadka.com>

On Wed, 22 Oct 2003, Itamar Shtull-Trauring <itamar at itamarst.org> wrote:

> Uh. *Maybe* that's the consensus, but it's not actually correct. You can
> have a tap or tac run as a NT service.
> 
> Lets say you have  a script "server.py" that is runnable with "twistd
> -y", you can do (and similar code will work for TAPs):
<snip>

Any hope of integrating that code into twistw?

-- 
Moshe Zadka -- http://moshez.org/
Buffy: I don't like you hanging out with someone that... short.
Riley: Yeah, a lot of young people nowadays are experimenting with shortness.
Agile Programming Language -- http://www.python.org/



From m at zadka.site.co.il  Thu Oct 23 02:50:21 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 23 Oct 2003 06:50:21 -0000
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031023030235.GA24973@frobozz>
References: <20031023030235.GA24973@frobozz>, <20031022145010.12e64a54.itamar@itamarst.org> <20031022195637.10110.qmail@web13902.mail.yahoo.com>
Message-ID: <20031023065021.15062.qmail@green.zadka.com>

On Wed, Oct 22, 2003 at 12:56:37PM -0700, Nathan Seven wrote:
 
> > And then- why am I "supposed" to use twisted.app?
> > I don't need app-level persistance, and this is on
> > dedicated machines where I can just background the
> > process in the startup scripts- so daemonization is
> > not needed? Am I missing something in that?

On Thu, 23 Oct 2003, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
 
> I'll let someone who actually knows something about the new app stuff answer
> this :)

Well, I guess that means me :) 

First things first: you don't *need* app. Writing a Python script which
ends with .run() is a perfectly fine way to run Twisted. As long as you
can afford to modify it whenever you want profiling information. And
as long as you are willing to modify it whenever you want a log file.
And as long as you are sure backgrounding is a good enough approximation
for you. And as long as you don't need pid files. But at some point,
you are likely to want those things. twisted.application is a way to
*separate configuration from deployment*. It represents a layer of indirection
between your code (so-called business logic) and between the running, with
all the traditional costs and benefits of such indirection.

I strongly suggest reading the tutorial [in CVS] -- it starts out using
reactor.run(), and eventually progresses to use application. I think the
most important thing, for me, here is the core realization: your code
should (probably) know very little about whether it is being used with
an application or just a reactor.run(). Even when using Services, you
can easily have your script do something like:

s.startService()
reactor.run()
s.stopService()



From v6kk1hg02 at sneakemail.com  Thu Oct 23 05:03:18 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 23 Oct 2003 09:03:18 -0000
Subject: [Twisted-Python] Compile failure in 1.1.0rc1 Windows
Message-ID: <14312-02880@sneakemail.com>

Windows 2000, MSVC6sp5, the full Microsoft SDK is also installed (free from MS website in case you didn't know), as well as MASM for that matter.  Necessary Microsoft INCLUDE and PATH environment variables OK, and as per standard.  All TM prerequisites like SSL etc are installed correctly.  Then tried a simple setup.py install command.

The failure is a missing include file referenced from portmap.c.

#include <rpc/rpc.h>
#include <rpc/pmap_clnt.h>

Some clues.  On Windows, there *is* a VC6 and MSSDK header called rpc.h.  However it does not live in a folder called rpc.  And there is *no* header called pmap_clnt.h.  The last part of the output is shown below.

I'm sorry if this is the wrong list, only trying to help out with the rc1 release.

Mark

===================================
C:\Microsoft Visual Studio\VC98\BIN\cl.exe /c /nologo /Ox /MD /W3 /GX /DNDEBUG -
DWIN32=1 -IC:\Python\include -IC:\Python\PC /Tctwisted/spread/cBanana.c /Fobuild
\temp.win32-2.3\Release\twisted/spread/cBanana.obj
cBanana.c
twisted/spread/cBanana.c(350) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(360) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(371) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(375) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(384) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(387) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(461) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(470) : warning C4305: '=' : truncation from 'const int
' to 'char '
C:\Microsoft Visual Studio\VC98\BIN\link.exe /DLL /nologo /INCREMENTAL:NO /LIBPA
TH:C:\Python\libs /LIBPATH:C:\Python\PCBuild /EXPORT:initcBanana build\temp.win3
2-2.3\Release\twisted/spread/cBanana.obj /OUT:build\lib.win32-2.3\twisted\spread
\cBanana.pyd /IMPLIB:build\temp.win32-2.3\Release\twisted/spread\cBanana.lib
   Creating library build\temp.win32-2.3\Release\twisted/spread\cBanana.lib and
object build\temp.win32-2.3\Release\twisted/spread\cBanana.exp
building 'twisted.runner.portmap' extension
creating build\temp.win32-2.3\Release\twisted\runner
C:\Microsoft Visual Studio\VC98\BIN\cl.exe /c /nologo /Ox /MD /W3 /GX /DNDEBUG -
DWIN32=1 -IC:\Python\include -IC:\Python\PC /Tctwisted/runner/portmap.c /Fobuild
\temp.win32-2.3\Release\twisted/runner/portmap.obj
portmap.c
twisted/runner/portmap.c(23) : fatal error C1083: Cannot open include file: 'rpc
/rpc.h': No such file or directory
error: command '"C:\Microsoft Visual Studio\VC98\BIN\cl.exe"' failed with exit s
tatus 2



From vlupien at drummonddesigns.com  Thu Oct 23 10:02:27 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 23 Oct 2003 10:02:27 -0400
Subject: [Twisted-Python] application maker for twisted_1.1.0rc
Message-ID: <000001c3996e$4b231af0$687ba8c0@vicky>

My OS is win2k.  I installed twisted-1.1.0rc but I don't understand how
application maker works.  
 
I want to start a web application on port 8585.  Is there someone who
can explain me how it works.
 
The previous version was easy to use with the option "launch" but now
it's "create".  I'm really mix up.
 
Vicky
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031023/2698a5c8/attachment.htm 

From itamar at itamarst.org  Thu Oct 23 10:25:39 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 23 Oct 2003 10:25:39 -0400
Subject: [Twisted-Python] application maker for twisted_1.1.0rc
In-Reply-To: <000001c3996e$4b231af0$687ba8c0@vicky>
References: <000001c3996e$4b231af0$687ba8c0@vicky>
Message-ID: <20031023102539.1cd926ba.itamar@itamarst.org>

On Thu, 23 Oct 2003 10:02:27 -0400
"vicky lupien" <vlupien at drummonddesigns.com> wrote:

> My OS is win2k.  I installed twisted-1.1.0rc but I don't understand
> how application maker works.  
>  
> I want to start a web application on port 8585.  Is there someone who
> can explain me how it works.
>  
> The previous version was easy to use with the option "launch" but now
> it's "create".  I'm really mix up.

Hm, that may've been tktwistd, which was removed in this release but
will be back at some point.

There are still command line tools, however, so you can do:

c:\python22\scripts\twistd.py -f web.tap

in a DOS window.

Or, don't use TAPs, and make your script runnable directly (i.e., use
reactor.run()). The using twisted.web howto has examples.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 23 10:29:11 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 23 Oct 2003 10:29:11 -0400
Subject: [Twisted-Python] Compile failure in 1.1.0rc1 Windows
In-Reply-To: <14312-02880@sneakemail.com>
References: <14312-02880@sneakemail.com>
Message-ID: <20031023102911.2fae3716.itamar@itamarst.org>

On 23 Oct 2003 09:03:18 -0000
"Mark Evans" <v6kk1hg02 at sneakemail.com> wrote:

> Windows 2000, MSVC6sp5, the full Microsoft SDK is also installed (free
> from MS website in case you didn't know), as well as MASM for that
> matter.  Necessary Microsoft INCLUDE and PATH environment variables
> OK, and as per standard.  All TM prerequisites like SSL etc are
> installed correctly.  Then tried a simple setup.py install command.

Errors display, yes, but in latest versions of Twisted it just means
these specific C modules won't build. They are all optional. In other
words, just ignore it.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 23 10:31:11 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 23 Oct 2003 10:31:11 -0400
Subject: [Twisted-Python] twistd and win32 service
In-Reply-To: <20031023054454.14113.qmail@green.zadka.com>
References: <20031022145010.12e64a54.itamar@itamarst.org>
	<20031022182442.26FA93D802@www.fastmail.fm>
	<20031023054454.14113.qmail@green.zadka.com>
Message-ID: <20031023103111.3e9344eb.itamar@itamarst.org>

On 23 Oct 2003 05:44:54 -0000
Moshe Zadka <m at zadka.site.co.il> wrote:

> Any hope of integrating that code into twistw?

Sure, but, "it's not that simple." That's not how you run the service -
once you've written that script you run it with "--install" and then
"start", something like that. So it'd take a little fiddling with
command-line args and figuring out the internals of the service
registration to figure out how to make genericv script. 

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 23 10:33:03 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 23 Oct 2003 10:33:03 -0400
Subject: [Twisted-Python] Deffered question
In-Reply-To: <200310201922.h9KJMYo05280@zerg.codec.ro>
References: <200310201922.h9KJMYo05280@zerg.codec.ro>
Message-ID: <20031023103303.1f287e42.itamar@itamarst.org>

On Mon, 20 Oct 2003 22:22:34 +0300
soso <duke99 at email.ro> wrote:

> I need to implement a command based protocol, that is a client sends
> a command to the server and waits for the response. Since the
> response computation might be time consuming I have to choose
> between 2 solutions: - use Twisted deffereds - or write my own
> implementation, a TCP based threaded server. I'm not worried about
> scaling since it will not be used by more than 10 clients at a time.

Deferreds don't solve this problem. They just make doing callbacks
easier.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From maoy at cis.upenn.edu  Thu Oct 23 10:59:07 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 23 Oct 2003 10:59:07 -0400 (EDT)
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031023102539.1cd926ba.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>

Hi, suppose I have a software with GPL license, written in Python and used 
twisted. I want to distribute the software to a couple of people for test, 
and usually they don't have twisted installed. Is it leagal for me to make 
a package with twisted in?  ( a little stupid question ;) It's a little 
hard for me to let them install separately because I slightly modified 
twisted source.

Another concern is that twisted is becoming larger and larger. I actually 
only use very little of them (mainly in twisted.internet and 
twisted.python). Is there an easy way to make a small package? Thanks!


Yun





From bob at redivi.com  Thu Oct 23 12:11:54 2003
From: bob at redivi.com (Bob Ippolito)
Date: Thu, 23 Oct 2003 12:11:54 -0400
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>
References: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>
Message-ID: <9E56A510-0573-11D8-9B7B-000A95686CD8@redivi.com>

On Oct 23, 2003, at 10:59 AM, Yun Mao wrote:

> Hi, suppose I have a software with GPL license, written in Python and 
> used
> twisted. I want to distribute the software to a couple of people for 
> test,
> and usually they don't have twisted installed. Is it leagal for me to 
> make
> a package with twisted in?  ( a little stupid question ;) It's a little
> hard for me to let them install separately because I slightly modified
> twisted source.

What did you modify?  Chances are, it might be something we would like 
to support in future versions of Twisted or it may be a case where 
there is another way that does not require modification of Twisted that 
we could recommend to you.

> Another concern is that twisted is becoming larger and larger. I 
> actually
> only use very little of them (mainly in twisted.internet and
> twisted.python). Is there an easy way to make a small package? Thanks!

It's theoretically possible, but it's neither easy nor supported.  
Twisted is only about 4 megs uncompressed, so it's likely to be far 
smaller than that through gzip or bzip2.
 >>> import os, stat, operator
 >>> size = reduce(operator.add, [os.stat(f.strip())[stat.ST_SIZE] for f 
in os.popen('find . -name "*.py"')])
 >>> print size / (2.**20)
4.06226062775

-bob




From twisted at zadka.site.co.il  Thu Oct 23 12:27:53 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 23 Oct 2003 16:27:53 -0000
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>
References: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>
Message-ID: <20031023162753.2572.qmail@green.zadka.com>

On Thu, 23 Oct 2003, Yun Mao <maoy at cis.upenn.edu> wrote:

> Hi, suppose I have a software with GPL license, written in Python and used 
> twisted. I want to distribute the software to a couple of people for test, 
> and usually they don't have twisted installed. Is it leagal for me to make 
> a package with twisted in? 

For legal questions, it's best to ask a lawyer. My non-lawyer advice is
"yes", but IANAL.

> hard for me to let them install separately because I slightly modified 
> twisted source.

That's bad. It's not a terribly good practice. If you have useful patches,
it's probably better to send them to us so we can integrate them. Better
for us, since we have a better Twisted, and better for you, since you
don't have to maintain and forward-port your changes. In some cases,
you might be fixing something that doesn't need fixing -- and then we'll
be able to show you a better way. Better for us, because we have a better
feeling of what needs more documentation, and better for you, since your
code is better.

> Another concern is that twisted is becoming larger and larger. I actually 
> only use very little of them (mainly in twisted.internet and 
> twisted.python). Is there an easy way to make a small package? Thanks!

One easy thing to do is to base your distribution on the NoDocs packages.
Much of the size of Twisted is there. I'm not a big fan of "small
distributions" since that requires more support for strange configurations
from the developers. Is <1MB of bzipped sources really that much? If
you want something really deployable, you'll have to include Python
anyway, and that would dwarf the size of Twisted.



From bob at redivi.com  Thu Oct 23 13:10:06 2003
From: bob at redivi.com (Bob Ippolito)
Date: Thu, 23 Oct 2003 13:10:06 -0400
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031023162753.2572.qmail@green.zadka.com>
References: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu> <20031023162753.2572.qmail@green.zadka.com>
Message-ID: <BFE0C6D3-057B-11D8-9B7B-000A95686CD8@redivi.com>

On Oct 23, 2003, at 12:27 PM, Moshe Zadka wrote:

> On Thu, 23 Oct 2003, Yun Mao <maoy at cis.upenn.edu> wrote:
>
>> Another concern is that twisted is becoming larger and larger. I 
>> actually
>> only use very little of them (mainly in twisted.internet and
>> twisted.python). Is there an easy way to make a small package? Thanks!
>
> One easy thing to do is to base your distribution on the NoDocs 
> packages.
> Much of the size of Twisted is there. I'm not a big fan of "small
> distributions" since that requires more support for strange 
> configurations
> from the developers. Is <1MB of bzipped sources really that much? If
> you want something really deployable, you'll have to include Python
> anyway, and that would dwarf the size of Twisted.

Also, FYI, when deploying on Mac OS X using bundlebuilder.py (comes 
with Mac versions of Python 2.3), you have quite a few options:

       --semi-standalone		includes any used modules/extensions
       --standalone			includes Python and any used modules/extensions
       -x, --exclude=MODULE	exclude module (with --(semi-)standalone)
       -i, --include=MODULE		include module (with --(semi-)standalone)
       --package=PACKAGE		include a whole package (with 
--(semi-)standalone)
       --strip					strip binaries (remove debug info)

Any included modules are put in a zip file, using the zip import 
feature.. so the deployed size of a full Twisted installation would be 
pretty small, especially if you weren't using much of it.  
bundlebuilder attempts to detect all the modules that you are actually 
using, but it does this without executing code or importing modules so 
it's not perfect (hence the exclude and include options).  I haven't 
used py2exe or freeze before, but they may or may not have some of 
these features.  It's possible to create a self-contained, relocatable, 
easily deployable (no install process, just download + double click) OS 
X application bundle that works on any OS X 10.2+ installation (maybe 
even 10.1 if using --standalone) using this tool.

-bob




From vlupien at drummonddesigns.com  Thu Oct 23 13:50:27 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 23 Oct 2003 13:50:27 -0400
Subject: [Twisted-Python] question about setSubmodel in web.woven.model
Message-ID: <000001c3998e$252bf770$687ba8c0@vicky>

I took a look in the class Model in the module model and I found one
difference.  A part of the code is gone in the function setSubmodel.
 
Original code:
 
def setSubmodel(self, request=None, name=None, value=None):
        """
        Set a submodel on this model. If getSubmodel or lookupSubmodel
        ever return a Deferred, I ought to set this in a place that
        lookupSubmodel/getSubmodel know about, so they can use it as a
        cache.
        """
        if value is None:
            warnings.warn("Warning! setSubmodel should now take the
request as the first argument")
            value = name
            name = request
            request = None
 
        if self.submodelCheck(request, name):
            if self.submodels.has_key(name):
                del self.submodels[name]
            setattr(self, name, value)
 
and here's the new code:
 
def setSubmodel(self, request=None, name=None, value=None):
        """
        Set a submodel on this model. If getSubmodel or lookupSubmodel
        ever return a Deferred, I ought to set this in a place that
        lookupSubmodel/getSubmodel know about, so they can use it as a
        cache.
        """
 
        if self.submodelCheck(request, name):
            if self.submodels.has_key(name):
                del self.submodels[name]
            setattr(self, name, value)
 
Now I tried to run my application and I got this error :
exceptions.TypeError: cannot concatenate 'str' and 'NoneType' objects
When I add the missing part of code, everything is alright.  I look in
my own code and I'd never call the function setSubmodel, so I wanna
know if the error is somewhere else in the twisted code.
 
Vicky
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031023/eb38ef4c/attachment.htm 

From corydodt at twistedmatrix.com  Thu Oct 23 15:02:59 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Thu, 23 Oct 2003 12:02:59 -0700
Subject: [Twisted-Python] twistd and win32 service
In-Reply-To: <20031023103111.3e9344eb.itamar@itamarst.org>
References: <20031022145010.12e64a54.itamar@itamarst.org>	<20031022182442.26FA93D802@www.fastmail.fm>	<20031023054454.14113.qmail@green.zadka.com> <20031023103111.3e9344eb.itamar@itamarst.org>
Message-ID: <3F9825E3.3030400@twistedmatrix.com>

How about something like tap2exe?  The exe it outputs is an installer that 
installs the tap and also installs (and optionally starts) the service.

C


Itamar Shtull-Trauring wrote:

> On 23 Oct 2003 05:44:54 -0000
> Moshe Zadka <m at zadka.site.co.il> wrote:
> 
> 
>>Any hope of integrating that code into twistw?
> 
> 
> Sure, but, "it's not that simple." That's not how you run the service -
> once you've written that script you run it with "--install" and then
> "start", something like that. So it'd take a little fiddling with
> command-line args and figuring out the internals of the service
> registration to figure out how to make genericv script. 
> 





From scosol at yahoo.com  Thu Oct 23 15:18:50 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Thu, 23 Oct 2003 12:18:50 -0700 (PDT)
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031023030235.GA24973@frobozz>
Message-ID: <20031023191850.44980.qmail@web13904.mail.yahoo.com>

--- Andrew Bennetts <andrew-twisted at puzzling.org>
wrote:
> 
> (Just to confuse you even more, you don't *need*
> adbapi; you can ignore it
> and do DB work in your own threads if that's more
> convenient.  adbapi is
> probably what you want, though :)

Yes, I'll absolutely need the connection-pool
functionality.
...
Alright- I think it's become clearer to me now-

I need to create my main app, that connects itself to
my db, and runs a web server-
Then my request handling code simply needs to gather
the client data, call the sql function and deferr-
then on callback I just spit the data back to the
client.

All of my business logic is going to be in the DB's
stored procedures- so with this sort of setup the app
side of things is infinitly scalable :)

Thank's for your help-



=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From scosol at yahoo.com  Thu Oct 23 15:28:44 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Thu, 23 Oct 2003 12:28:44 -0700 (PDT)
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031023065021.15062.qmail@green.zadka.com>
Message-ID: <20031023192844.76133.qmail@web13901.mail.yahoo.com>

--- Moshe Zadka <m at zadka.site.co.il> wrote:
> 
> > > And then- why am I "supposed" to use
> twisted.app?
>
> twisted.application is a way to
> *separate configuration from deployment*. It
> represents a layer of indirection
> between your code (so-called business logic) and
> between the running, with
> all the traditional costs and benefits of such
> indirection.

Hmmm- yes I suppose for ease of transportation to
other systems/OSes it makes sense-

> I strongly suggest reading the tutorial [in CVS] --
> it starts out using
> reactor.run(), and eventually progresses to use
> application.

Hmmm- so there are updated docs in CVS?
I'll check them out-

Speaking of- just as commentary from someone totally
new to twisted-
There's a lot of documentation on the site- almost all
of my questions have been answered by looking through
it.
But- I must say that it is really lacking in
organization- there are very important points in
certain spots that seem like they are just anecdotally
added to the previous paragraph.  Many times I have
wanted to refer back to some document so find some
point, and I have been entirely unable to find the
right one.
(like when I was deciphering exactly what the rpy
files were supposed to be used for)
There are no less than 4 seperate places where rpys
are discussed- and only by reading *all 4* of them do
you understand.
Anyway- most of you are probably all aware of that,
but just thought I'd mention it (as someone coming in
fresh) :)

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From nieder at mail.ru  Thu Oct 23 18:59:10 2003
From: nieder at mail.ru (Ricardo Niederberger Cabral)
Date: Thu, 23 Oct 2003 22:59:10 +0000
Subject: [Twisted-Python] importing twisted modules from my source tree
Message-ID: <20031023225910.GA4797@localhost>

(talking about Twisted 1.0.8alpha3)

I'd like to ship my application source code with some twisted modules
(mostly spread.pb and dependencies), but i'm facing some strange
problems, which i guess are due to some magic done on files like
twisted/internet/reactor.py:

del sys.modules['twisted.internet.reactor']

Anyway, I placed the entire twisted dir inside my 'net' package, so
other modules can import twisted from there. (later, i'd remove
twisted modules i don't need). 

Since some twisted modules import other twisted modules out of it's
package, i had to hardcode something like 

sys.path.append('/home/rnc/prj/imgseek-net/isnLib/net/') 

before any twisted related stuff is imported.

But i get the following error when running my app (which eventually imports
imgClient, who by it's turn eventually imports reactor from twisted.internet):

Traceback (most recent call last):
  File "./isnLib/net/imgClient.py", line 68, in connect
    reactor.connectTCP(self.addr, self.port, factory)
AttributeError: 'module' object has no attribute 'connectTCP'

I've noticed that if I run "python isnLib/net/imgClient.py" on a
command line, reactor is imported correctly (and then becomes a bound
method of twisted.internet.default.SelectReactor).

(If necessary, my code is at
http://cvs.sf.net/viewcvs.py/imgseek/imgseek-net2/isnLib/net/#dirlist)

One solution would be asking the user to install the full Twisted
package, but i really don't want that as I don't need things like
Woven, Lore, etc.

Any ideas ?

Best regards,
-- 
rnc <nieder|at|mail.ru>



From glyph at twistedmatrix.com  Thu Oct 23 22:41:06 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 23 Oct 2003 22:41:06 -0400
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031023192844.76133.qmail@web13901.mail.yahoo.com>
References: <20031023192844.76133.qmail@web13901.mail.yahoo.com>
Message-ID: <3F989142.40808@twistedmatrix.com>

Nathan Seven wrote:

> But- I must say that it is really lacking in
> organization- there are very important points in
> certain spots that seem like they are just anecdotally
> added to the previous paragraph.

We don't currently have a documentation editor, although we're aware of 
the problem and have been looking for one for a long time.  Want to 
volunteer? :)




From mary-twisted at puzzling.org  Thu Oct 23 22:46:26 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Fri, 24 Oct 2003 12:46:26 +1000
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <3F989142.40808@twistedmatrix.com>
References: <20031023192844.76133.qmail@web13901.mail.yahoo.com> <3F989142.40808@twistedmatrix.com>
Message-ID: <20031024024626.GJ4897@titus>

On Thu, Oct 23, 2003, Glyph Lefkowitz wrote:
> Nathan Seven wrote:
> 
> >But- I must say that it is really lacking in organization- there are
> >very important points in certain spots that seem like they are just
> >anecdotally added to the previous paragraph.
> 
> We don't currently have a documentation editor, although we're aware
> of the problem and have been looking for one for a long time.  Want to
> volunteer? :)

I am not the original poster but... I would be interested in
doing/helping with this.

But, not for the next four weeks.

-Mary



From maoy at cis.upenn.edu  Thu Oct 23 22:47:31 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 23 Oct 2003 22:47:31 -0400 (EDT)
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031023162753.2572.qmail@green.zadka.com>
Message-ID: <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>

> That's bad. It's not a terribly good practice. If you have useful patches,
> it's probably better to send them to us so we can integrate them. Better
> for us, since we have a better Twisted, and better for you, since you
> don't have to maintain and forward-port your changes. In some cases,

What I did is add a bind to interface support to the connectTCP method.  
Do you feel it's useful?

For example, 
reactor.connectTCP ( self.remotehost, self.remoteport, 
                            sfactory, self.timeout, None, self.interface)
where self.interface='eth1'

This only works on Linux..

> you might be fixing something that doesn't need fixing -- and then we'll
> be able to show you a better way. Better for us, because we have a better
> feeling of what needs more documentation, and better for you, since your
> code is better.





From andrew-twisted at puzzling.org  Thu Oct 23 22:53:35 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 24 Oct 2003 12:53:35 +1000
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>
References: <20031023162753.2572.qmail@green.zadka.com> <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>
Message-ID: <20031024025335.GB28713@frobozz>

On Thu, Oct 23, 2003 at 10:47:31PM -0400, Yun Mao wrote:
> 
> What I did is add a bind to interface support to the connectTCP method.  
> Do you feel it's useful?
> 
> For example, 
> reactor.connectTCP ( self.remotehost, self.remoteport, 
>                             sfactory, self.timeout, None, self.interface)
> where self.interface='eth1'
> 
> This only works on Linux..

There's already a bindAddress optional argument that you could possibly use
for this (and it's cross-platform)... I'm guessing there's some reason why
you need to bind the local side by device rather than by IP address?

-Andrew.




From maoy at cis.upenn.edu  Thu Oct 23 23:24:58 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 23 Oct 2003 23:24:58 -0400 (EDT)
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031024025335.GB28713@frobozz>
Message-ID: <Pine.LNX.4.44.0310232302520.18105-100000@klondike.cis.upenn.edu>

> 
> There's already a bindAddress optional argument that you could possibly use
> for this (and it's cross-platform)... I'm guessing there's some reason why
> you need to bind the local side by device rather than by IP address?
> 
> -Andrew.
> 

Because I can't get it working. This looks different from the TCP server
side. My senario is that I have both ethernet (eth0) and 802.11(eth1)  
available, and I want one TCP connection use eth0 and the other one use
eth1. binding IP addresses for the two connections doesn't work for me..
Even it'll work, getting the IP for the specific interface is still a
little troublesome..

Yun






From mesozoic at polynode.com  Thu Oct 23 23:32:50 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Thu, 23 Oct 2003 23:32:50 -0400
Subject: [Twisted-Python] question about setSubmodel in web.woven.model
In-Reply-To: <000001c3998e$252bf770$687ba8c0@vicky>
References: <000001c3998e$252bf770$687ba8c0@vicky>
Message-ID: <1066966370.9516.630.camel@hyla>

On Thu, 2003-10-23 at 13:50, vicky lupien wrote:
> I took a look in the class Model in the module model and I found one
> difference.  A part of the code is gone in the function setSubmodel.

> Now I tried to run my application and I got this error : 
> exceptions.TypeError: cannot concatenate 'str' and 'NoneType' objects

This is strange, though it can likely be explained by someone more
familiar with Woven's underpinnings (Donovan?).

However, I feel I should repeat some of what JP said earlier:

If you include A) some example code that you're using, B) the traceback
you get when you hit the exception, or C) a general description of what
you're trying to do, you are more likely to get poignant advice.

In general, for problems like this, I always try IRC first (#twisted in
irc.freenode.net). If nobody there can help, then I post to the list.
There is often someone available who can help you figure out what's
going wrong.

Please post some sample code and a traceback, and it will be much easier
to determine where this error is happening (and why).
 
-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031023/06f3e8b5/attachment.pgp 

From andrew-twisted at puzzling.org  Thu Oct 23 23:52:46 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 24 Oct 2003 13:52:46 +1000
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310232302520.18105-100000@klondike.cis.upenn.edu>
References: <20031024025335.GB28713@frobozz> <Pine.LNX.4.44.0310232302520.18105-100000@klondike.cis.upenn.edu>
Message-ID: <20031024035246.GD28713@frobozz>

On Thu, Oct 23, 2003 at 11:24:58PM -0400, Yun Mao wrote:
> > 
> > There's already a bindAddress optional argument that you could possibly use
> > for this (and it's cross-platform)... I'm guessing there's some reason why
> > you need to bind the local side by device rather than by IP address?
> > 
> > -Andrew.
> > 
> 
> Because I can't get it working. This looks different from the TCP server
> side. My senario is that I have both ethernet (eth0) and 802.11(eth1)  
> available, and I want one TCP connection use eth0 and the other one use
> eth1. binding IP addresses for the two connections doesn't work for me..

*Please* submit a bug report!  We can't know that things don't work for
people if they don't tell us :)

http://twistedmatrix.com/bugs/

> Even it'll work, getting the IP for the specific interface is still a
> little troublesome..

Yeah, I suspected as much.  There are definitely times when it's more
convenient to work in terms of devices than in terms of IP addresses,
depending on the problem you are trying to solve.  Could submit this to the
issue tracker as a feature request?

Thanks!

-Andrew.




From maoy at cis.upenn.edu  Fri Oct 24 00:47:13 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Fri, 24 Oct 2003 00:47:13 -0400 (EDT)
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031024035246.GD28713@frobozz>
Message-ID: <Pine.LNX.4.44.0310240044390.20381-100000@klondike.cis.upenn.edu>

On Fri, 24 Oct 2003, Andrew Bennetts wrote:

> *Please* submit a bug report!  We can't know that things don't work for
> people if they don't tell us :)
I didn't submit b/c I'm still not sure it's a bug or my fault or the 
system default behavior, and I don't have time recently to make it 
clear.. :)

Yun





From exarkun at intarweb.us  Fri Oct 24 01:05:32 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 24 Oct 2003 01:05:32 -0400
Subject: [Twisted-Python] importing twisted modules from my source tree
In-Reply-To: <20031023225910.GA4797@localhost>
References: <20031023225910.GA4797@localhost>
Message-ID: <20031024050532.GA3013@intarweb.us>

On Thu, Oct 23, 2003 at 10:59:10PM +0000, Ricardo Niederberger Cabral wrote:
> 
> But i get the following error when running my app (which eventually
> imports imgClient, who by it's turn eventually imports reactor from
> twisted.internet):
> 
> Traceback (most recent call last):
>   File "./isnLib/net/imgClient.py", line 68, in connect
>     reactor.connectTCP(self.addr, self.port, factory)
> AttributeError: 'module' object has no attribute 'connectTCP'

  How is your app launched?  (I checked out the CVS, but couldn't find the
main entry point, so I couldn't reproduce the above exception).

> 
> I've noticed that if I run "python isnLib/net/imgClient.py" on a
> command line, reactor is imported correctly (and then becomes a bound
> method of twisted.internet.default.SelectReactor).
> 

  Indeed, this worked for me as well.

  A possibly unrelated point:

  Your "failsafe" code in imgServer.py is definitely not helpful.  Let the
user configure their own environment (I, for example, do not have
/usr/local/lib/python2.1).  Aside from adding random, possibly non-existent
paths to sys.path, adding site-packages from *different versions* of Python
will only cause you misery (to answer a question from the comments in the
code, the preferred way to include packages in a user's home directory is to
use sitecustomize.py to add those directories, or to set up PYTHONPATH
properly).

  If the import fails, I'd recommend just letting it fail, and including a
section in your README for people not familiar with Python on how to remedy
this problem.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031024/b838ad89/attachment.pgp 

From scosol at yahoo.com  Fri Oct 24 02:24:14 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Thu, 23 Oct 2003 23:24:14 -0700 (PDT)
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <3F989142.40808@twistedmatrix.com>
Message-ID: <20031024062414.95522.qmail@web13904.mail.yahoo.com>

--- Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> Nathan Seven wrote:
> 
> > But- I must say that it is really lacking in
> > organization- there are very important points in
> > certain spots that seem like they are just
> anecdotally
> > added to the previous paragraph.
> 
> We don't currently have a documentation editor,
> although we're aware of 
> the problem and have been looking for one for a long
> time.  Want to 
> volunteer? :)

I'd be happy to assist wen the time is right, but I
don't think I'm in the proper position to do so right
now, knowing very little about twisted.
As for now, I've contributed in my own way (bought a
tshirt)- and with that, I must give respect to the
logo's designer-
It's one of the best logo's I've ever seen :)

But yeah- once I'm familiar enough with twisted to
make sense of everythign, it should be short business
sorting out the documentation, and adding to it where
it's lacking :)

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From m at zadka.site.co.il  Fri Oct 24 03:20:22 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 24 Oct 2003 07:20:22 -0000
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>
References: <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>
Message-ID: <20031024072022.23178.qmail@green.zadka.com>

On Thu, 23 Oct 2003, Yun Mao <maoy at cis.upenn.edu> wrote:

> For example, 
> reactor.connectTCP ( self.remotehost, self.remoteport, 
>                             sfactory, self.timeout, None, self.interface)
> where self.interface='eth1'
> 
> This only works on Linux..

This is exactly the kind of thing beter done with connectWith, and
exactly why we added the connectWith escape-mechanism. You can implement
IConnector, for example, by inheriting from tcp.Connector, overriding
_makeTransport to call your subclass of Client which will override
the constructor to make custom bindings. That might take a few more
lines, on the order of 15 or so, but in return you can use standard
Twisted and you can use other reactors.

connectWith and listenWith are indeed poorly documented. I have opened
issue 367 to handle their documentation, and I hope I'll be able to work
on it soon. Please feel free to send your current diffs-vs-CVS-Twisted
to the issue, it will give me a concrete example to work with.



From nieder at mail.ru  Fri Oct 24 02:47:36 2003
From: nieder at mail.ru (Ricardo Niederberger Cabral)
Date: Fri, 24 Oct 2003 06:47:36 +0000
Subject: [Twisted-Python] importing twisted modules from my source tree
In-Reply-To: <20031024050532.GA3013@intarweb.us>
References: <20031023225910.GA4797@localhost> <20031024050532.GA3013@intarweb.us>
Message-ID: <20031024064736.GA7053@localhost>

* Jp Calderone <exarkun at intarweb.us> [2003-10-24 03:14]:
> On Thu, Oct 23, 2003 at 10:59:10PM +0000, Ricardo Niederberger Cabral wrote:
> > 
> > But i get the following error when running my app (which eventually
> > imports imgClient, who by it's turn eventually imports reactor from
> > twisted.internet):
> > 
> > Traceback (most recent call last):
> >   File "./isnLib/net/imgClient.py", line 68, in connect
> >     reactor.connectTCP(self.addr, self.port, factory)
> > AttributeError: 'module' object has no attribute 'connectTCP'
> 
>   How is your app launched?  (I checked out the CVS, but couldn't find the
> main entry point, so I couldn't reproduce the above exception).
> 

You can run a server with "./imgSeekNet -s" from the root folder, but
you'd first need to do a "python setup.py build" and then copy
build/lib-foo/isnLib/img/_imgdb.so to isnLib/img/). And building it
requires wxWindows dev stuff.

Thanks and best regards,
-- 
rnc <nieder|at|mail.ru>



From golux at comcast.net  Fri Oct 24 13:29:43 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Fri, 24 Oct 2003 13:29:43 -0400
Subject: [Twisted-Python] importing twisted modules from my source tree
In-Reply-To: <20031024064736.GA7053@localhost>
References: <20031023225910.GA4797@localhost> <20031024050532.GA3013@intarweb.us> <20031024064736.GA7053@localhost>
Message-ID: <3F996187.9050007@comcast.net>

Ricardo Niederberger Cabral wrote:

> You can run a server with "./imgSeekNet -s" from the root folder, but
> you'd first need to do a "python setup.py build" and then copy
> build/lib-foo/isnLib/img/_imgdb.so to isnLib/img/). And building it
> requires wxWindows dev stuff.

Interesting that you have wxWindows (via wxPython, I assume)
dependencies in your server.  I've taken pains to keep the
code that's common to our server and its wxPython client
free of wx dependencies.  Do you have a combined client/server,
or an admin interface built into your server?

Just curious.

- Steve.




From maoy at cis.upenn.edu  Fri Oct 24 16:38:00 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Fri, 24 Oct 2003 16:38:00 -0400 (EDT)
Subject: [Twisted-Python] minimal python version?
In-Reply-To: <3F996187.9050007@comcast.net>
Message-ID: <Pine.LNX.4.44.0310241636260.25386-100000@klondike.cis.upenn.edu>

Hi, what's the minimal python version for correctly make twisted run? 
I'm pretty happy that 2.2.3 is working, is 2.2.1 supported?

Yun





From nieder at mail.ru  Fri Oct 24 15:14:49 2003
From: nieder at mail.ru (Ricardo Niederberger Cabral)
Date: Fri, 24 Oct 2003 19:14:49 +0000
Subject: [Twisted-Python] importing twisted modules from my source tree
In-Reply-To: <3F996187.9050007@comcast.net>
References: <20031023225910.GA4797@localhost> <20031024050532.GA3013@intarweb.us> <20031024064736.GA7053@localhost> <3F996187.9050007@comcast.net>
Message-ID: <20031024191449.GA9455@localhost>

* Stephen C. Waterbury <golux at comcast.net> [2003-10-24 15:49]:
> Ricardo Niederberger Cabral wrote:
> 
> >You can run a server with "./imgSeekNet -s" from the root folder, but
> >you'd first need to do a "python setup.py build" and then copy
> >build/lib-foo/isnLib/img/_imgdb.so to isnLib/img/). And building it
> >requires wxWindows dev stuff.
> 
> Interesting that you have wxWindows (via wxPython, I assume)
> dependencies in your server.  I've taken pains to keep the
> code that's common to our server and its wxPython client
> free of wx dependencies.  Do you have a combined client/server,
> or an admin interface built into your server?

It's a combined client/server. The server subsystem always runs
(doesn't need wxPython), and the wxPython GUI which calls a client
subsystem can be optionally started. (when that happens, a call to
twisted.internet.wxsupport.install is made)

In my case I also use wxWindows c++ libs for reading some image
formats on the image processing and database extension module.

Best regards,
-- 
rnc <nieder|at|mail.ru>



From radix at twistedmatrix.com  Fri Oct 24 17:51:37 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Fri, 24 Oct 2003 17:51:37 -0400
Subject: [Twisted-Python] minimal python version?
In-Reply-To: <Pine.LNX.4.44.0310241636260.25386-100000@klondike.cis.upenn.edu>
References: <3F996187.9050007@comcast.net> <Pine.LNX.4.44.0310241636260.25386-100000@klondike.cis.upenn.edu>
Message-ID: <20031024215137.GC832@radii>

On Fri, Oct 24, 2003 at 04:38:00PM -0400, Yun Mao wrote:
> Hi, what's the minimal python version for correctly make twisted run? 
> I'm pretty happy that 2.2.3 is working, is 2.2.1 supported?

2.2.0 (I'll update the README - it just says "2.2" right now)

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From pje at telecommunity.com  Sat Oct 25 10:07:42 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Sat, 25 Oct 2003 10:07:42 -0400
Subject: [Twisted-Python] Odd behavior in IRC logbot
Message-ID: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>

I've been using a slightly modified version of the IRC logging bot example 
to log traffic on #peak.  I've noticed, however, that it occasionally seems 
to hang, and has to be manually restarted.  As a workaround, I've set up a 
cronjob to kill and restart it daily, but that seems like a kludge.

Does anybody know why this happens?  Is there some kind of reconnect 
timeout such that it'll give up on reconnecting if the server it's trying 
to connect to is down?  I've noticed that the hang behavior seems to be 
correlated with global announcements about shutting down the IRC netwrok.




From andrew-twisted at puzzling.org  Sat Oct 25 12:21:38 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 26 Oct 2003 03:21:38 +1100
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
References: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
Message-ID: <20031025162138.GB32552@frobozz>

On Sat, Oct 25, 2003 at 10:07:42AM -0400, Phillip J. Eby wrote:
> I've been using a slightly modified version of the IRC logging bot example 
> to log traffic on #peak.  I've noticed, however, that it occasionally seems 
> to hang, and has to be manually restarted.  As a workaround, I've set up a 
> cronjob to kill and restart it daily, but that seems like a kludge.
> 
> Does anybody know why this happens?  Is there some kind of reconnect 
> timeout such that it'll give up on reconnecting if the server it's trying 
> to connect to is down?  I've noticed that the hang behavior seems to be 
> correlated with global announcements about shutting down the IRC netwrok.

The ClientFactory subclass in doc/examples/ircLogBot.py is very simple:
    ...
    def clientConnectionLost(self, connector, reason):
        """If we get disconnected, reconnect to server."""
        connector.connect()

    def clientConnectionFailed(self, connector, reason):
        print "connection failed:", reason
        reactor.stop()
    ...

Perhaps clientConnectionFailed is being triggered, instead of
clientConnectionLost (which has no delay at all, as you can see)?  (The docs
don't clearly say this, but ccF is called when there was no connection
established, and ccL is called when a connection was made and then
disconnected).

(I'm presuming your slightly modified version hasn't changed the
LogBotFactory...)

-Andrew.




From maoy at cis.upenn.edu  Sat Oct 25 12:45:22 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Sat, 25 Oct 2003 12:45:22 -0400 (EDT)
Subject: [Twisted-Python] minimal python version?
In-Reply-To: <20031024215137.GC832@radii>
Message-ID: <Pine.LNX.4.44.0310251243440.25766-100000@klondike.cis.upenn.edu>

This may not be true..

$ python localsocks.py 
Traceback (most recent call last):
  File "localsocks.py", line 191, in ?
    main()
  File "localsocks.py", line 176, in main
    config = Options()
  File "twisted/python/usage.py", line 134, in __init__
    (longOpt, shortOpt, docs, settings, synonyms, dispatch) = c()
  File "twisted/python/usage.py", line 349, in _gather_handlers
    dispatch[prettyName] = new.instancemethod(fn, self, self.__class__)
TypeError: instancemethod() argument 3 must be class, not type

$ python
Python 2.2 (#1, Apr 12 2002, 15:29:57)
[GCC 2.96 20000731 (Red Hat Linux 7.2 2.96-109)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>>


I don't have this trouble when I use python 2.2.3.

Yun


On Fri, 24 Oct 2003, Christopher Armstrong wrote:

> On Fri, Oct 24, 2003 at 04:38:00PM -0400, Yun Mao wrote:
> > Hi, what's the minimal python version for correctly make twisted run? 
> > I'm pretty happy that 2.2.3 is working, is 2.2.1 supported?
> 
> 2.2.0 (I'll update the README - it just says "2.2" right now)
> 
> 




From andrew-twisted at puzzling.org  Sat Oct 25 12:57:29 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 26 Oct 2003 03:57:29 +1100
Subject: [Twisted-Python] minimal python version?
In-Reply-To: <Pine.LNX.4.44.0310251243440.25766-100000@klondike.cis.upenn.edu>
References: <20031024215137.GC832@radii> <Pine.LNX.4.44.0310251243440.25766-100000@klondike.cis.upenn.edu>
Message-ID: <20031025165729.GC32552@frobozz>

[please don't top-post!]

On Sat, Oct 25, 2003 at 12:45:22PM -0400, Yun Mao wrote:
> This may not be true..
> 
> $ python localsocks.py 
> Traceback (most recent call last):
>   File "localsocks.py", line 191, in ?
>     main()
>   File "localsocks.py", line 176, in main
>     config = Options()
>   File "twisted/python/usage.py", line 134, in __init__
>     (longOpt, shortOpt, docs, settings, synonyms, dispatch) = c()
>   File "twisted/python/usage.py", line 349, in _gather_handlers
>     dispatch[prettyName] = new.instancemethod(fn, self, self.__class__)
> TypeError: instancemethod() argument 3 must be class, not type
> 
> $ python
> Python 2.2 (#1, Apr 12 2002, 15:29:57)
> [GCC 2.96 20000731 (Red Hat Linux 7.2 2.96-109)] on linux2
> Type "help", "copyright", "credits" or "license" for more information.
> >>>
> 
> 
> I don't have this trouble when I use python 2.2.3.

Hmm... unless something has changed recently, our OS-X buildslave uses
2.2.0, and the tests are passing just fine on it:
    http://twistedmatrix.com/buildbot/

In fact, I recall a change to that exact line recently, and sure enough,
it's different in CVS -- I think if you try 1.1.0rc2 (which I believe will
be identical to 1.1.0 final), you'll find that bug is fixed.  If not, or if
you find any other problems, please file bug reports :)

-Andrew.




From pje at telecommunity.com  Sat Oct 25 13:44:02 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Sat, 25 Oct 2003 13:44:02 -0400
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <20031025162138.GB32552@frobozz>
References: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
 <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
Message-ID: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>

At 03:21 AM 10/26/03 +1100, Andrew Bennetts wrote:
>On Sat, Oct 25, 2003 at 10:07:42AM -0400, Phillip J. Eby wrote:
>
>     def clientConnectionFailed(self, connector, reason):
>         print "connection failed:", reason
>         reactor.stop()
>     ...
>
>Perhaps clientConnectionFailed is being triggered, instead of
>clientConnectionLost (which has no delay at all, as you can see)?  (The docs
>don't clearly say this, but ccF is called when there was no connection
>established, and ccL is called when a connection was made and then
>disconnected).

But shouldn't reactor.stop() cause the process to exit, rather than 
hang?  I'm running the logbot under daemontools, so if it exited, it should 
be restarted.  But that's not what I'm seeing.  Instead, the process just 
goes idle.




From bob at redivi.com  Sat Oct 25 15:37:47 2003
From: bob at redivi.com (Bob Ippolito)
Date: Sat, 25 Oct 2003 15:37:47 -0400
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
References: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com> <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com> <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
Message-ID: <B64BDA09-0722-11D8-9DA8-000A95686CD8@redivi.com>

On Oct 25, 2003, at 1:44 PM, Phillip J. Eby wrote:

> At 03:21 AM 10/26/03 +1100, Andrew Bennetts wrote:
>> On Sat, Oct 25, 2003 at 10:07:42AM -0400, Phillip J. Eby wrote:
>>
>>     def clientConnectionFailed(self, connector, reason):
>>         print "connection failed:", reason
>>         reactor.stop()
>>     ...
>>
>> Perhaps clientConnectionFailed is being triggered, instead of
>> clientConnectionLost (which has no delay at all, as you can see)?  
>> (The docs
>> don't clearly say this, but ccF is called when there was no connection
>> established, and ccL is called when a connection was made and then
>> disconnected).
>
> But shouldn't reactor.stop() cause the process to exit, rather than 
> hang?  I'm running the logbot under daemontools, so if it exited, it 
> should be restarted.  But that's not what I'm seeing.  Instead, the 
> process just goes idle.

I've seen reactor.stop() hang if there's threads happening.

-bob




From lists at webcrunchers.com  Sat Oct 25 17:28:31 2003
From: lists at webcrunchers.com (John D.)
Date: Sat, 25 Oct 2003 14:28:31 -0700
Subject: [Twisted-Python] Newbee needs help.
Message-ID: <v03110716bbc09a0ba21d@[192.168.0.3]>

I've downloaded Twisted Python,  and have spent considerable time trying to figure it out.   

Has anyone,  or is anyone planning to write up a tutorial?

In particular,  I want to know how to process web forms page elements using the
twisted web server code,   or some examples on how to do it.   

I suspect there might be tools already present that can do this,  and in normal Python,  there is the "cgi" module,  but not sure how I can use that module,  or even if it's possible to process forms page elements using this module,   or does it use some completely different approach?

Is there anyone out in the Twisted Python mailing list who's done this,  and would they care to share a few "bread crumbs" with someone who just hasn't "got it" yet?

If such a tutorial exists,  what's the URL?

John





From lafou at wanadoo.fr  Sun Oct 26 06:38:29 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sun, 26 Oct 2003 12:38:29 +0100
Subject: [Twisted-Python] Newbee needs help.
In-Reply-To: <v03110716bbc09a0ba21d@[192.168.0.3]>
References: <v03110716bbc09a0ba21d@[192.168.0.3]>
Message-ID: <1067168308.4901.1.camel@pcmarie>

On Sat, 2003-10-25 at 23:28, John D. wrote:
> I've downloaded Twisted Python,  and have spent considerable time trying to figure it out.   
> 
> Has anyone,  or is anyone planning to write up a tutorial?


www.twistedmatrix.com/howto

> In particular,  I want to know how to process web forms page elements using the
> twisted web server code,   or some examples on how to do it.   
> 
> I suspect there might be tools already present that can do this,  and in normal Python,  there is the "cgi" module,  but not sure how I can use that module,  or even if it's possible to process forms page elements using this module,   or does it use some completely different approach?
> 
> Is there anyone out in the Twisted Python mailing list who's done this,  and would they care to share a few "bread crumbs" with someone who just hasn't "got it" yet?
> 
> If such a tutorial exists,  what's the URL?

Btw, you should check twisted 1.1.0 RC2 DOC (in download section).




From matt at pollenation.net  Sun Oct 26 07:27:59 2003
From: matt at pollenation.net (Matt Goodall)
Date: Sun, 26 Oct 2003 12:27:59 +0000
Subject: [Twisted-Python] Newbee needs help.
In-Reply-To: <1067168308.4901.1.camel@pcmarie>
References: <v03110716bbc09a0ba21d@[192.168.0.3]> <1067168308.4901.1.camel@pcmarie>
Message-ID: <3F9BBDCF.8010807@pollenation.net>

Philippe Lafoucri?re wrote:

>On Sat, 2003-10-25 at 23:28, John D. wrote:
>  
>
>>I've downloaded Twisted Python,  and have spent considerable time trying to figure it out.   
>>
>>Has anyone,  or is anyone planning to write up a tutorial?
>>    
>>
>
>
>www.twistedmatrix.com/howto
>  
>
http://twistedmatrix.com/documents/howto/ is the correct URL. There is a 
tutorial and a number of documents about Twisted's web supprort listed.

- Matt

-- 
Matt Goodall, Pollenation Internet Ltd
w: http://www.pollenation.net
e: matt at pollenation.net





From lafou at wanadoo.fr  Sun Oct 26 16:28:23 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sun, 26 Oct 2003 22:28:23 +0100
Subject: [Twisted-Python] Release notes
Message-ID: <1067203702.4876.5.camel@pcmarie>

Congratulations for the new 1.1.0, but the release notes are still
pointing to 1.0.7 notes.





From lafou at wanadoo.fr  Sun Oct 26 16:38:22 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sun, 26 Oct 2003 22:38:22 +0100
Subject: [Twisted-Python] Directory Listing fonts
Message-ID: <1067204300.4901.11.camel@pcmarie>

Hi,


I just discovered the new Twisted Web Directory listing look. It looks
better, but why the fonts are so huge ? I mean, the <h1>Directory
listing for ...</h1> could have been a <h2>...</h2> ?

thx :)




From alexander.winston at comcast.net  Sun Oct 26 17:12:42 2003
From: alexander.winston at comcast.net (Alexander Winston)
Date: Sun, 26 Oct 2003 17:12:42 -0500
Subject: [Twisted-Python] Directory Listing fonts
In-Reply-To: <1067204300.4901.11.camel@pcmarie>
References: <1067204300.4901.11.camel@pcmarie>
Message-ID: <1067206362.22662.15.camel@drop>

On Sun, 2003-10-26 at 16:38, Philippe Lafoucri?re wrote:
> I just discovered the new Twisted Web Directory listing look. It looks
> better, but why the fonts are so huge ? I mean, the <h1>Directory
> listing for ...</h1> could have been a <h2>...</h2> ?

The element <h1> is for top-level headings, so its use here is
justified. Modifying XHTML elements simply for display's sake should not
be done, for that is the job of Cascading Style Sheets.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031026/1f3bd4ed/attachment.pgp 

From scosol at yahoo.com  Sun Oct 26 17:49:01 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Sun, 26 Oct 2003 14:49:01 -0800 (PST)
Subject: [Twisted-Python] Release notes
In-Reply-To: <1067203702.4876.5.camel@pcmarie>
Message-ID: <20031026224901.63836.qmail@web13902.mail.yahoo.com>

Right-

And yes, theres a nice tutorial in the 1.10 docs :)

--- Philippe Lafoucri?re <lafou at wanadoo.fr> wrote:
> Congratulations for the new 1.1.0, but the release
> notes are still
> pointing to 1.0.7 notes.
> 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
>
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From likwoka at yahoo.com  Sun Oct 26 18:14:43 2003
From: likwoka at yahoo.com (Alex Li)
Date: Sun, 26 Oct 2003 15:14:43 -0800 (PST)
Subject: [Twisted-Python] questions on twisted web server
Message-ID: <20031026231443.20521.qmail@web13901.mail.yahoo.com>

Hi all,

1) I would like to rotate the logs for the web server.  How should I do that?
I have read the rotatinglog.py example, but I don't know how to intergrate that
into the web server script below...

2) How to turn off directory listing?  Am I doing the right way below?

3) I would like to use https for certain directories, but not the whole site.
How do I do that (probably with 2 server.Site instances... I need more clues)?
For example, if a user access the site through
http://localhost/secure, then he should be redirected to
https://localhost/secure

#--------------------------------------------------------------------------
from twisted.application import internet, service
from twisted.web import static, server, util, error
from OpenSSL import SSL

class ServerContextFactory:
    '''Loads a certificate from the file 'server.pem'.'''
    def getContext(self):
        ctx = SSL.Context(SSL.SSLv23_METHOD)
        ctx.use_certificate_file('/home/www/snakeoil-rsa.crt')
        ctx.use_privatekey_file('/home/www/snakeoil-rsa.key')
        return ctx


root = static.File('/home/www/production')
root.ignoreExt('.html')

# turn off directory listing
root.putChild('', error.ForbiddenResource())

site = server.Site(root, logPath='/home/www/access.log')
application = service.Application('web', uid=33, gid=33) #www-data
serviceCollection = service.IServiceCollection(application)

internet.TCPServer(82, site).setServiceParent(serviceCollection)
internet.SSLServer(443, site, ServerContextFactory()
                   ).setServiceParent(serviceCollection)


Thanks in advance,
Alex

__________________________________
Do you Yahoo!?
Exclusive Video Premiere - Britney Spears
http://launch.yahoo.com/promos/britneyspears/



From itamar at itamarst.org  Mon Oct 27 01:43:17 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 27 Oct 2003 01:43:17 -0500
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
References: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
	<5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
	<5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
Message-ID: <20031027014317.7b58a1e9.itamar@itamarst.org>

On Sat, 25 Oct 2003 13:44:02 -0400
"Phillip J. Eby" <pje at telecommunity.com> wrote:

> But shouldn't reactor.stop() cause the process to exit, rather than 
> hang?  I'm running the logbot under daemontools, so if it exited, it
> should be restarted.  But that's not what I'm seeing.  Instead, the
> process just goes idle.

Nothing in the logs?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From kunger at intersight.com  Mon Oct 27 02:05:38 2003
From: kunger at intersight.com (Kevin Unger)
Date: Sun, 26 Oct 2003 23:05:38 -0800
Subject: [Twisted-Python] Picture_Pile broken?
Message-ID: <001101c39c58$ba6c4a20$0201a8c0@telecaster>

Hello Twisted Folk,

I just downloaded 1.1.0rc2 for Windows.  The link from the woven howto to
the source listings for the 'Picture_Pile' tutorial is broken.  The link (at
the bottom of the page) needs to have '.html' apended to the href.

I found the listings (only a single and broken link to the file
directory-listing4.html exists), and downloaded the files necessary to run
the first part of the tutorial:

          directory-listing.html
          image-display.html
          picturepile.py

      I try to start it using:

          python %TWISTED_HOME%\scripts\twistw.py -noy picturepile.py

      And all I get is an immediate return to the command prompt, no console
messages, and no server running.  I ran this just fine using the previous
twisted release, 1.0.7.

      Any clue?

      -k




From radix at twistedmatrix.com  Mon Oct 27 04:10:22 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 27 Oct 2003 04:10:22 -0500
Subject: [Twisted-Python] Picture_Pile broken?
In-Reply-To: <001101c39c58$ba6c4a20$0201a8c0@telecaster>
References: <001101c39c58$ba6c4a20$0201a8c0@telecaster>
Message-ID: <20031027091022.GB608@radii>

On Sun, Oct 26, 2003 at 11:05:38PM -0800, Kevin Unger wrote:
> 
> Hello Twisted Folk,
> 
> I just downloaded 1.1.0rc2 for Windows.  The link from the woven howto to
> the source listings for the 'Picture_Pile' tutorial is broken.  The link (at
> the bottom of the page) needs to have '.html' apended to the href.

I created a new issue for this:

http://www.twistedmatrix.com/bugs/issue370

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From andrew-twisted at puzzling.org  Mon Oct 27 06:32:19 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 27 Oct 2003 22:32:19 +1100
Subject: [Twisted-Python] Picture_Pile broken?
In-Reply-To: <20031027091022.GB608@radii>
References: <001101c39c58$ba6c4a20$0201a8c0@telecaster> <20031027091022.GB608@radii>
Message-ID: <20031027113219.GA21986@frobozz>

On Mon, Oct 27, 2003 at 04:10:22AM -0500, Christopher Armstrong wrote:
> On Sun, Oct 26, 2003 at 11:05:38PM -0800, Kevin Unger wrote:
> > 
> > Hello Twisted Folk,
> > 
> > I just downloaded 1.1.0rc2 for Windows.  The link from the woven howto to
> > the source listings for the 'Picture_Pile' tutorial is broken.  The link (at
> > the bottom of the page) needs to have '.html' apended to the href.
> 
> I created a new issue for this:
> 
> http://www.twistedmatrix.com/bugs/issue370

It's now fixed.

Kevin, thanks for the bug report! :)

-Andrew.




From lafou at wanadoo.fr  Mon Oct 27 06:36:45 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Mon, 27 Oct 2003 12:36:45 +0100
Subject: [Twisted-Python] Directory Listing fonts
In-Reply-To: <1067206362.22662.15.camel@drop>
References: <1067204300.4901.11.camel@pcmarie>
	 <1067206362.22662.15.camel@drop>
Message-ID: <1067254605.4870.3.camel@pcmarie>

> The element <h1> is for top-level headings, so its use here is
> justified. Modifying XHTML elements simply for display's sake should not
> be done, for that is the job of Cascading Style Sheets.

You're totally right. So, what about changing the css ?




From pje at telecommunity.com  Mon Oct 27 09:15:13 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Mon, 27 Oct 2003 09:15:13 -0500
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <20031027014317.7b58a1e9.itamar@itamarst.org>
References: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
 <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
 <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
 <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
Message-ID: <5.1.0.14.0.20031027091418.02de4190@mail.telecommunity.com>

At 01:43 AM 10/27/03 -0500, Itamar Shtull-Trauring wrote:
>On Sat, 25 Oct 2003 13:44:02 -0400
>"Phillip J. Eby" <pje at telecommunity.com> wrote:
>
> > But shouldn't reactor.stop() cause the process to exit, rather than
> > hang?  I'm running the logbot under daemontools, so if it exited, it
> > should be restarted.  But that's not what I'm seeing.  Instead, the
> > process just goes idle.
>
>Nothing in the logs?

Um, what logs?




From vlupien at drummonddesigns.com  Mon Oct 27 09:17:08 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Mon, 27 Oct 2003 09:17:08 -0500
Subject: [Twisted-Python] authentification from a database
Message-ID: <000101c39c95$08eb89e0$687ba8c0@vicky>

I have a program that needs authentification from a database.  For now,
it's working fine but I'm using
checkers.InMemoryUsernamePasswordDatabaseDontUse(test="test") (I want
many users not only "test").   
 
Here's my code:
 
class RootPage(pages.BasePage):
    templateFile = "main.html"
    
    def initialize(self, dbpool=None):
        self.dbpool = dbpool
 
    def wchild_login(self, request):
        a=request.getComponent(simpleguard.Authenticated)
        if not request.getComponent(simpleguard.Authenticated):
            return InfiniChild(login.LoginPage())
        return Authenticated()
 
class Authenticated(page.Page):
    isLeaf = 1
    template='''<html><h1>Hello <span model="name"/>!</h1></html>'''
 
    def wmfactory_name(self, request):
        return request.getComponent(simpleguard.Authenticated).name
    
class IRedirectAfterLogin(components.Interface):
    """The URLPath to which we will redirect after successful login.
    """
 
class Here(resource.Resource):
    def render(self, request):
        existing =
request.getSession().getComponent(IRedirectAfterLogin, None)
        if existing is not None:
            request.redirect(str(existing))
            request.getSession().setComponent(IRedirectAfterLogin, None)
            return "<html></html>"
        else:
            return util.redirectTo('.', request)
        
def callback(model):
    return Here()
 
class FullURLRequest:
    def __init__(self, request):
        self.request = request
 
    def prePathURL(self):
        r = self.request
        prepath = r.prepath
        r.prepath = r.prepath + r.postpath
        rv = r.prePathURL()
        r.prepath = prepath
        return rv
    
class InfiniChild(resource.Resource):
    def __init__(self, r):
        resource.Resource.__init__(self)
        self.r = r
 
    def getChild(self, name, request):
        return self
 
    def render(self, request):
        request.getSession().setComponent(
            IRedirectAfterLogin,
            urlpath.URLPath.fromRequest(FullURLRequest(request))
            )
        return self.r.render(request)
    
def createResource():
    dbpool = database.DataBase().getConnection()
    return simpleguard.guardResource(
        RootPage(dbpool=dbpool),
 
[checkers.InMemoryUsernamePasswordDatabaseDontUse(vicky="lupien")],
        callback=callback)    
 
 
 
#In an other module:
 
class LoginPage(pages.BasePage):
    templateFile = "login.html"
    
    def initialize(self):
        self.title = "Login"
   
    def wmfactory_title(self, request):
        return self.title
            
    def wchild_index(self, request):
        return self
    
    def wvupdate_loginform(self, request, widget, model):
        root = request.getRootURL()
        if root is None:
            root=request.prePathURL()
        url = urlpath.URLPath.fromString(root)
        lmx(widget.node).form(
            action=str(url.sibling(guard.INIT_PERSPECTIVE)),
            model="form")
 
    def wmfactory_form(self, request):
        return guard.newLoginSignature.method(None)
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031027/dbc4bd92/attachment.htm 

From itamar at itamarst.org  Mon Oct 27 09:29:29 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 27 Oct 2003 09:29:29 -0500
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <5.1.0.14.0.20031027091418.02de4190@mail.telecommunity.com>
References: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
	<5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
	<5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
	<5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
	<5.1.0.14.0.20031027091418.02de4190@mail.telecommunity.com>
Message-ID: <20031027092929.282f6cf4.itamar@itamarst.org>

On Mon, 27 Oct 2003 09:15:13 -0500
"Phillip J. Eby" <pje at telecommunity.com> wrote:

> Um, what logs?

Hm. I suppose you ought to enable logging, yes. Do:

from twisted.python import log
log.startLogging(open("irc.log", "a"))

somewhere in the file (e.g. in the __main__-only section).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Mon Oct 27 11:00:47 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Mon, 27 Oct 2003 11:00:47 -0500
Subject: [Twisted-Python] authentification from a database
In-Reply-To: <000101c39c95$08eb89e0$687ba8c0@vicky>
References: <000101c39c95$08eb89e0$687ba8c0@vicky>
Message-ID: <20031027160047.GA11812@intarweb.us>

On Mon, Oct 27, 2003 at 09:17:08AM -0500, vicky lupien wrote:
> I have a program that needs authentification from a database.  For now,
> it's working fine but I'm using
> checkers.InMemoryUsernamePasswordDatabaseDontUse(test="test") (I want
> many users not only "test").   

  Use a different checker, such as FilePasswordDB.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031027/91a4a4e9/attachment.pgp 

From itamar at itamarst.org  Mon Oct 27 12:13:44 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 27 Oct 2003 12:13:44 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
Message-ID: <20031027121344.31daf5e9.itamar@itamarst.org>

What's New in 1.1.0
===================

- twisted.application, an updated deployment and configuration library.

- Mac OS X GUI event loop integration (requires PyObjC).

- New howtos, including a tutorial, and more web framework docs. 

- The documentation is now better organized, up-to-date with the latest
APIs, and in some areas much more extensive.

- Removed a number of broken, unmaintained and unused packages and
modules.

- Bug fixes and feature enhancements.



From lafou at wanadoo.fr  Mon Oct 27 12:56:04 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Mon, 27 Oct 2003 18:56:04 +0100
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
	internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <1067277364.4870.0.camel@pcmarie>

Great work guys ! twisted is the python/network killer app

On Mon, 2003-10-27 at 18:13, Itamar Shtull-Trauring wrote:
> What's New in 1.1.0
> ===================
> 
> - twisted.application, an updated deployment and configuration library.
> 
> - Mac OS X GUI event loop integration (requires PyObjC).
> 
> - New howtos, including a tutorial, and more web framework docs. 
> 
> - The documentation is now better organized, up-to-date with the latest
> APIs, and in some areas much more extensive.
> 
> - Removed a number of broken, unmaintained and unused packages and
> modules.
> 
> - Bug fixes and feature enhancements.
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From duke99 at email.ro  Mon Oct 27 13:57:21 2003
From: duke99 at email.ro (soso)
Date: Mon, 27 Oct 2003 20:57:21 +0200
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
Message-ID: <200310271857.h9RIvL429365@zerg.codec.ro>

Thanks for the great work!

But I can't find the windows installer. Or there isn't a windows installer for 1.1?

soso


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From matteo.giacomazzi at libero.it  Mon Oct 27 14:36:21 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Mon, 27 Oct 2003 20:36:21 +0100
Subject: [Twisted-Python] Post data
Message-ID: <7119444031.20031027203621@libero.it>

Hi all,

  I need to query a remote HTTP server using POST method.
  To achieve this, I use the t.w.c.getPage function.
  In  order  to  post  some  data, I pass to that function the keyword
  postdata  bound  to  an urllib.urlencode()-d dictionary but it seems
  that such data is not sent at all.

  What is wrong?
  Here  is  a  minimal  example:  the url is a PHP scripts that simply
  dumps  the  content  of  the  $_POST  variable,  but  it is an empty
  array...

  Any help would be greatly appreciated!

#=============================================
from twisted.web.client import getPage
from twisted.internet import reactor
import urllib

def printData(data):
    print data
    reactor.stop()

payload = urllib.urlencode({'test':'the test'})
url = 'http://www.hotelsprovider.com/~matteo'
d = getPage(url, postdata=payload, timeout=5)
d.addCallback(printData)
reactor.run()
#=============================================
  
  Many thanks in advance!
  

Kind regards
 Matteo




From matteo.giacomazzi at libero.it  Mon Oct 27 14:47:13 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Mon, 27 Oct 2003 20:47:13 +0100
Subject: [Twisted-Python] Re: Post data
In-Reply-To: <7119444031.20031027203621@libero.it>
References: <7119444031.20031027203621@libero.it>
Message-ID: <18520096296.20031027204713@libero.it>

UPDATE:  I  forgot  to  use  the  method='POST'  keyword param, but no
results yet...

#==========================================================
from twisted.web.client import getPage
from twisted.internet import reactor
import urllib

def printData(data):
    print data
    reactor.stop()

payload = urllib.urlencode({'test':'the test'})
url = 'http://www.hotelsprovider.com/~matteo'
d = getPage(url, method='POST', postdata=payload, timeout=5)
d.addCallback(printData)
reactor.run()
#==========================================================

Many thanks in advance!
  

Kind regards
 Matteo




From Martin.Moellenbeck at t-online.de  Mon Oct 27 15:28:17 2003
From: Martin.Moellenbeck at t-online.de (=?ISO-8859-1?Q?Martin_M=F6llenbeck?=)
Date: Mon, 27 Oct 2003 21:28:17 +0100
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <3F9D7FE1.4060204@t-online.de>

very cool framework and you all have made a very good work.

regards Martin

Itamar Shtull-Trauring wrote:

>What's New in 1.1.0
>===================
>
>- twisted.application, an updated deployment and configuration library.
>
>- Mac OS X GUI event loop integration (requires PyObjC).
>
>- New howtos, including a tutorial, and more web framework docs. 
>
>- The documentation is now better organized, up-to-date with the latest
>APIs, and in some areas much more extensive.
>
>- Removed a number of broken, unmaintained and unused packages and
>modules.
>
>- Bug fixes and feature enhancements.
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>  
>





From abe at fettig.net  Mon Oct 27 16:46:36 2003
From: abe at fettig.net (Abe Fettig)
Date: Mon, 27 Oct 2003 16:46:36 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <3F9D923C.70701@fettig.net>

Looks like a great release... and it even has updated woven docs! 
Thanks for all the work you guys have put into Twisted!

Abe

Itamar Shtull-Trauring wrote:
> What's New in 1.1.0





From developer at csrules.dyndns.org  Mon Oct 27 17:08:30 2003
From: developer at csrules.dyndns.org (darryl)
Date: Mon, 27 Oct 2003 16:08:30 -0600 (CST)
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <3F9D923C.70701@fettig.net>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
        <3F9D923C.70701@fettig.net>
Message-ID: <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>


> Looks like a great release... and it even has updated woven docs!

The question is, does anyone want to focus on learing woven with NEW woven
in the works?

-darryl





From glyph at twistedmatrix.com  Mon Oct 27 17:13:35 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 27 Oct 2003 17:13:35 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>
References: <20031027121344.31daf5e9.itamar@itamarst.org>        <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>
Message-ID: <3F9D988F.2060703@twistedmatrix.com>

darryl wrote:

>>Looks like a great release... and it even has updated woven docs!

> The question is, does anyone want to focus on learing woven with NEW woven
> in the works?

An unfortunate last-minute change of direction, but worth it considering 
how vastly improved the new code is.

It's no longer a part of Twisted, however.  Check out Quotient CVS - 
www.divmod.org




From developer at csrules.dyndns.org  Mon Oct 27 17:23:26 2003
From: developer at csrules.dyndns.org (darryl)
Date: Mon, 27 Oct 2003 16:23:26 -0600 (CST)
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <3F9D988F.2060703@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
        <3F9D923C.70701@fettig.net>
        <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>
        <3F9D988F.2060703@twistedmatrix.com>
Message-ID: <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca>

>> The question is, does anyone want to focus on learing woven with NEW
>> woven in the works?
>
> An unfortunate last-minute change of direction, but worth it considering
>  how vastly improved the new code is.
>
> It's no longer a part of Twisted, however.  Check out Quotient CVS -
> www.divmod.org

May i ask why it's not part of twisted?
And if that's the case will Woven be maintained?

-Darryl





From dp at twistedmatrix.com  Mon Oct 27 17:56:08 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 27 Oct 2003 17:56:08 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca>
References: <20031027121344.31daf5e9.itamar@itamarst.org> <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com> <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca>
Message-ID: <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 27, 2003, at 5:23 PM, darryl wrote:

>
>>> The question is, does anyone want to focus on learing woven with NEW
>>> woven in the works?

Woven is certainly very usable in it's current state -- if you want to 
do simple-to-moderate things quickly, it can be very useful. However, 
it's complexity made it difficult to do some of the more ambitious 
things we are trying to do, such as semi-transparent form handling, and 
serverToClient events. But there are a few people who have built (and 
deployed) fairly complex woven applications. The fact that nevow exists 
doesn't detract from that.

nevow was originally a research project -- a weekend's worth of hacking 
whose benefits turned out to be so great that we decided to focus on 
bringing it up to a usable state for Quotient as soon as possible. And 
that's where it is now.

Most of the woven concepts -- template and code abstraction using a 
DOM, reusable partial page renderers (Widgets in old woven, renderer 
callables in nevow), all of the concepts needed to know to use 
twisted.web -- carry over to nevow. The only thing that's really 
changed in nevow is a few names, and the code is VASTLY simplified, 
well tested, and thus far easier to understand, design semantics for, 
and change.

>> An unfortunate last-minute change of direction, but worth it 
>> considering
>>  how vastly improved the new code is.
>>
>> It's no longer a part of Twisted, however.  Check out Quotient CVS -
>> www.divmod.org
>
> May i ask why it's not part of twisted?
> And if that's the case will Woven be maintained?

nevow will be moved into twisted after a period of 
stabilization/development in Quotient. Since twisted is a large project 
with many external developers using it, and quotient is a smaller 
project that is mostly a small core team of development, we felt it 
made sense to keep it out of twisted proper until the development had 
stabilized. Since nevow has the benefit of being a complete rewrite of 
all the *best* parts of woven, and none of the bad, stabilization has 
been remarkably quick. So expect to see nevow in twisted fairly soon.

In the meantime, woven will continue to be maintained with bugfixes, 
and nevow is fully usable outside of quotient -- even to the point of 
being fully usable without twisted.web (as a cgi, or in zope or 
webware, for example). I should also mention that there will probably 
be a compatibility layer for nevow to render old-style Woven classes 
sometime in the future. It is amazingly simple to add rendering 
functionality to it since it uses components to render the dom (which 
is really just a list of any python objects)

If you are doing any new development, I highly encourage you to take a 
look at nevow, if for no other reason than you can have a hand in 
shaping it's development. I would very much appreciate feedback about 
it, especially now, since the code is very, very short and readable.

dp




From fog at initd.org  Mon Oct 27 18:07:32 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Tue, 28 Oct 2003 00:07:32 +0100
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
	internet
In-Reply-To: <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
	 <3F9D923C.70701@fettig.net>
	 <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>
	 <3F9D988F.2060703@twistedmatrix.com>
	 <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca>
	 <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>
Message-ID: <1067296052.1197.29.camel@localhost>

Il lun, 2003-10-27 alle 23:56, Donovan Preston ha scritto:
> On Oct 27, 2003, at 5:23 PM, darryl wrote:
> 
> >
> >>> The question is, does anyone want to focus on learing woven with NEW
> >>> woven in the works?
> 
> Woven is certainly very usable in it's current state -- if you want to 

after using it in a real life project i disagree. woven has lots of
problems that surface when you switch from "simple examples" to
"moderate real-life use cases". i was about to write a lenghty mail
about that shortcomings (like control not updating the model and needing
a "name" attribute in the node even it they don't use it, etc.) but then
two people told me about nevow in irc. looking at it right now.

> nevow was originally a research project -- a weekend's worth of hacking 
> whose benefits turned out to be so great that we decided to focus on 
> bringing it up to a usable state for Quotient as soon as possible. And 
> that's where it is now.

"we", "we". maybe i talked with you in irc.

> Most of the woven concepts -- template and code abstraction using a 
> DOM, reusable partial page renderers (Widgets in old woven, renderer 
> callables in nevow), all of the concepts needed to know to use 
> twisted.web -- carry over to nevow. The only thing that's really 
> changed in nevow is a few names, and the code is VASTLY simplified, 
> well tested, and thus far easier to understand, design semantics for, 
> and change.

KUDOS! :)

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
             Quis custodiet ipsos custodes? -- Juvenal, Satires, VI, 347
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio =?ISO-8859-1?Q?=E8?= firmata
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031028/83d7855a/attachment.pgp 

From maoy at cis.upenn.edu  Mon Oct 27 18:09:49 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Mon, 27 Oct 2003 18:09:49 -0500 (EST)
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0310271809290.17111-100000@klondike.cis.upenn.edu>

I really like the tutorial. Great work!

Yun


On Mon, 27 Oct 2003, Itamar Shtull-Trauring wrote:

> What's New in 1.1.0
> ===================
> 
> - twisted.application, an updated deployment and configuration library.
> 
> - Mac OS X GUI event loop integration (requires PyObjC).
> 
> - New howtos, including a tutorial, and more web framework docs. 
> 
> - The documentation is now better organized, up-to-date with the latest
> APIs, and in some areas much more extensive.
> 
> - Removed a number of broken, unmaintained and unused packages and
> modules.
> 
> - Bug fixes and feature enhancements.
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From matthew.s.hegedus at lmco.com  Mon Oct 27 15:02:23 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Mon, 27 Oct 2003 14:02:23 -0600
Subject: [Twisted-Python] Problem using LivePage/javascripts/event handlers
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F2@EMSS07M12.us.lmco.com>

I'm a relative noob to Twisted and Woven, but I'm trying to use them to
serve some dynamic web content without success. There's two spots that I am
most interested in:

When I include <span view="webConduitGlue" /> in my xhtml file, the browser
will spin its wheels forever. A big empty box is displayed at the bottom of
the browser window and the browser status displays Transferring data from
<myIP:port> ... . This behavior is consistent on Mozilla (I'm on Red Hat
Linux OS) and on the latest Netscape (7.1). I checked to make sure
javascript options were turned on in Netscape. Here is the Code:

Xhtml file:

<html>
    <head>
        <title>generic</title>
    </head>
    <body>
        <table model="listdata" view="listdatatable"></table>
        <span view="webConduitGlue" />
    </body>
</html>

Key Python/Twisted code:

class Epage(page.LivePage):
     ...
     def initialize(...):
         self.someListData = [['a', 'b', 'c'],
                                        ['d', 'e', 'f'],
                                        ['g', 'h', 'I']]

     def wmfactory_listdata(self, request):
         return self.someListData

     def wvupdate_listdatatable(self, request, node, listdata):
         l = lmx(node)
         d = l.div()
         t = d.table(border='0', cellspacing='2')
         t.tr(bgcolor='eeeeee')
         for arow in listdata:
             t.tr()
             for entry in arow:
                 t.td().text(entry)
             t.td().form().input(type='button', value='REMOVE',
view='rmExercise')

    def wvupdate_rmExercise(controller.Controller):
        def initialize(self):
            self.view.addEventHandler("onclick", self.onClick)
            self.view.addEventHandler("onmouseover", self.onMouseOver)

        def onClick(self, request, widget):
            print self, "CLICKED!"

        def onMouseOver(self, request, widget, argument):
            print self, "MOUSE OVER!", argument

The browser will draw me a table with buttons, but these events don't seem
to get processed. So that brings me to the second trouble spot I am
interested in. For those who know, am I embedding buttons in my table in an
acceptable manner? Am I trying to handle events correctly? If the xhtml
webConduitGlue was working would my event handling work? Please feel free to
criticize any part of this code. Thanks,

Matthew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031027/ac125458/attachment.htm 

From mmoellenbeck at plus.de  Mon Oct 27 19:00:27 2003
From: mmoellenbeck at plus.de (mmoellenbeck at plus.de)
Date: Tue, 28 Oct 2003 01:00:27 +0100
Subject: [Twisted-Python] Martin Moellenbeck/PLUS/MHM/TUG/DE ist =?iso-8859-1?Q?au=DFer_Haus=2E?=
Message-ID: <OF09F48F40.82FAE4CF-ONC1256DCD.00000AE1-C1256DCD.00000AE1@uz.tengelmann.de>

Ich werde ab  27.10.2003 nicht im B?ro sein. Ich kehre zur?ck am
09.11.2003.

Ich werde Ihre Nachricht nach meiner R?ckkehr beantworten.

In dringenden F?llen richten Sie sich bitte an Herrn Kimpenhaus oder Herrn
Albring.




From matthew.s.hegedus at lmco.com  Mon Oct 27 16:40:19 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Mon, 27 Oct 2003 15:40:19 -0600
Subject: [Twisted-Python] Problems with LivePage
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F3@EMSS07M12.us.lmco.com>

I incorrectly retyped code. Please forgive. Here is a better look...

Xhtml file:

<html>
    <head>
        <title>generic</title>
    </head>
    <body>
        <table model="listdata" view="listdatatable"></table>
        <span view="webConduitGlue" />
    </body>
</html>

Key Python/Twisted code:

class Epage(page.LivePage):
     ...
     def initialize(...):
         self.someListData = [['a', 'b', 'c'],
                                        ['d', 'e', 'f'],
                                        ['g', 'h', 'I']]

     def wmfactory_listdata(self, request):
         return self.someListData

     def wvupdate_listdatatable(self, request, node, listdata):
         l = lmx(node)
         d = l.div()
         t = d.table(border='0', cellspacing='2')
         t.tr(bgcolor='eeeeee')
         for arow in listdata:
             t.tr()
             for entry in arow:
                 t.td().text(entry)
             t.td().form().input(type='button', value='REMOVE',
view='rmExercise')

    def wvupdate_rmExercise():
        return RmExerciseEventHandler(self)

class RmExerciseEventHandler(controller.Controller)
        def initialize(self):
            self.view.addEventHandler("onclick", self.onClick)
            self.view.addEventHandler("onmouseover", self.onMouseOver)

        def onClick(self, request, widget):
            print self, "CLICKED!"

        def onMouseOver(self, request, widget, argument):
            print self, "MOUSE OVER!", argument

As a recap, I was having trouble with my browser handling <span
view="webConduitGlue" /> in my xhtml file, and I was having trouble
processing events when I click on buttons embedded inside of a table (or
just buttons in general). Anyone see anything wrong? Sorry for the extra
email traffic and inbox congestion.

Matthew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031027/e448307e/attachment.htm 

From scosol at yahoo.com  Mon Oct 27 20:05:15 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Mon, 27 Oct 2003 17:05:15 -0800 (PST)
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <Pine.LNX.4.44.0310271809290.17111-100000@klondike.cis.upenn.edu>
Message-ID: <20031028010515.3304.qmail@web13902.mail.yahoo.com>

I second that-

If you recall, I was the guy asking about simple DB
access/web-app stuff.

Just thought I'd let you all know that I've decided to
go with Twisted as part of a new fully HA financials
and banking system.
While I'm not *totally* confident in Twisted's
maturity for something like this, my needs are small
enough that any obvious problems should pop up rather
quickly. (and to be frank, it can be quickly and
easily replaced with PERL if need be)

So- assuming things go as planned, you will in the
near future have some very-heavy-iron Twisted users :)

Cheers- 

--- Yun Mao <maoy at cis.upenn.edu> wrote:
> I really like the tutorial. Great work!
> 
> Yun
> 
> 
> On Mon, 27 Oct 2003, Itamar Shtull-Trauring wrote:
> 
> > What's New in 1.1.0
> > ===================
> > 
> > - twisted.application, an updated deployment and
> configuration library.
> > 
> > - Mac OS X GUI event loop integration (requires
> PyObjC).
> > 
> > - New howtos, including a tutorial, and more web
> framework docs. 
> > 
> > - The documentation is now better organized,
> up-to-date with the latest
> > APIs, and in some areas much more extensive.
> > 
> > - Removed a number of broken, unmaintained and
> unused packages and
> > modules.
> > 
> > - Bug fixes and feature enhancements.
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> >
>
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
>
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From abe at fettig.net  Mon Oct 27 21:17:16 2003
From: abe at fettig.net (Abe Fettig)
Date: Mon, 27 Oct 2003 21:17:16 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <3F9D988F.2060703@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org>        <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com>
Message-ID: <3F9DD1AC.6000602@fettig.net>

Glyph Lefkowitz wrote:
> darryl wrote:

>> The question is, does anyone want to focus on learing woven with NEW 
>> woven
>> in the works?
> 
> An unfortunate last-minute change of direction, but worth it considering 
> how vastly improved the new code is.
> 
> It's no longer a part of Twisted, however.  Check out Quotient CVS - 
> www.divmod.org

Whoah!  Hold on a second.  Do you mean that _Woven_ is no longer part of 
Twisted, or that nevow/New Woven is longer part of Twisted?  Assuming 
that Woven will continue as part of Twisted, will it still be 
maintained?  Or is Woven dead as far as future improvements go?

I made the choice to buy into Woven a while back [1] and I'm just 
wrapping up a complete port of Hep's web interface to Woven, so it would 
be disappointing to find out that using Woven is no longer the Twisted 
Way, or that most of the developer energy is now going to be focused 
somewhere else.  Can you give me a better idea of the relationship 
between Woven and nevow, and a general idea of where both of them are 
headed?  I'd like to be able to make an educated decision about whether 
it's worth it to continue to invest my time working with Woven.

Thanks,
Abe

[1] http://twistedmatrix.com/pipermail/twisted-python/2003-June/004480.html




From stuart.hungerford at anu.edu.au  Mon Oct 27 22:02:59 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Tue, 28 Oct 2003 14:02:59 +1100
Subject: [Twisted-Python] Integrating simpleguard with existing Woven pages...
Message-ID: <6.0.0.22.0.20031028125753.01e1ff08@anusf.anu.edu.au>

Hi all,

I have a twisted.web based application that renders a number
of HTML pages via a set of Woven classes (inheriting from
twisted.web.woven.page.Page).

I need to add a simple username/password authentication to
some, but not all of these pages.  With the correct username
and password you can view the page, without them you can't view
it.

I understand that for this very simple level of authentication
that simpleguard is probably more appropriate than a full cred
based approach?

The examples simpleguardex.py and simpleguardex2.py rely on
using the render() method of resource subclasses to respond
to authentication issues, but I was looking for an example
of adding simpleguard to Woven pages with existing models,
views, templates etc.

Can anyone offer an example of this Woven/simpleguard use?






Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From radix at twistedmatrix.com  Mon Oct 27 21:32:19 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 27 Oct 2003 21:32:19 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <3F9DD1AC.6000602@fettig.net>
References: <20031027121344.31daf5e9.itamar@itamarst.org> <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com> <3F9DD1AC.6000602@fettig.net>
Message-ID: <20031028023219.GA8062@twistedmatrix.com>

On Mon, Oct 27, 2003 at 09:17:16PM -0500, Abe Fettig wrote:
> Glyph Lefkowitz wrote:
> >It's no longer a part of Twisted, however.  Check out Quotient CVS - 
> >www.divmod.org
> 
> Whoah!  Hold on a second.  Do you mean that _Woven_ is no longer part of 
> Twisted, or that nevow/New Woven is longer part of Twisted?  Assuming 
> that Woven will continue as part of Twisted, will it still be 
> maintained?  Or is Woven dead as far as future improvements go?

See Donovan's response.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From jeethur at sancharnet.in  Mon Oct 27 23:59:04 2003
From: jeethur at sancharnet.in (Jeethu Rao)
Date: Tue, 28 Oct 2003 10:29:04 +0530
Subject: [Twisted-Python] ANN: Twisted 1.1.0,
 the framework of *your* internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <000e01c39d10$374df7c0$7090013d@thilakraj>

Thanks for the excellent documentation on Cred.
I promise to ask fewer questions from now on ;)

Jeethu Rao

> -----Original Message-----
> From: twisted-python-admin at twistedmatrix.com
> [mailto:twisted-python-admin at twistedmatrix.com] On Behalf Of 
> Itamar Shtull-Trauring
> Sent: Monday, October 27, 2003 10:44 PM
> To: twisted-python at twistedmatrix.com
> Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework 
> of *your* internet
> 
> 
> What's New in 1.1.0
> ===================
[Snip]




From nico at tekNico.net  Tue Oct 28 01:41:55 2003
From: nico at tekNico.net (Nicola Larosa)
Date: Tue, 28 Oct 2003 07:41:55 +0100
Subject: [Twisted-Python] Re: ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org> <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com> <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca> <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>
Message-ID: <3F9E0FB3.60700@tekNico.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> If you are doing any new development, I highly encourage you to take a
> look at nevow, if for no other reason than you can have a hand in
> shaping it's development. I would very much appreciate feedback about
> it, especially now, since the code is very, very short and readable.

Will do. A little doc would help starting up, though. :^)


- --
"I worry about my child and the Internet all the time, even though she's
too young to have logged on yet. Here's what I worry about. I worry that
10 or 15 years from now, she will come to me and say 'Daddy, where were
you when they took freedom of the press away from the Internet?'"
 -- Mike Godwin, Electronic Frontier Foundation

Nicola Larosa - nico at tekNico.net


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (GNU/Linux)

iD8DBQE/ng+yXv0hgDImBm4RAsu1AJ9mZ8p6EaTfSWegKZacWba30bNPBQCeIS7F
/pGTQsfPkj0aw7zENmr8KzU=
=8rSk
-----END PGP SIGNATURE-----




From matteo.giacomazzi at libero.it  Tue Oct 28 03:42:13 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Tue, 28 Oct 2003 09:42:13 +0100
Subject: [Twisted-Python] Re: Post data
In-Reply-To: <18520096296.20031027204713@libero.it>
References: <7119444031.20031027203621@libero.it>
 <18520096296.20031027204713@libero.it>
Message-ID: <74053078.20031028094213@libero.it>

Hi all,

> UPDATE:  I  forgot  to  use  the method='POST' keyword param, but no
> results yet...

...and  I  finally  found  the  problem:  I have to insert the correct
'Content-type'  header in order to let PHP (and maybe ASP too) see the
POST data as a dictionary of keys and values.

Kind regards
 Matteo




From andrew-twisted at puzzling.org  Tue Oct 28 04:57:44 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 28 Oct 2003 20:57:44 +1100
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <20031028010515.3304.qmail@web13902.mail.yahoo.com>
References: <Pine.LNX.4.44.0310271809290.17111-100000@klondike.cis.upenn.edu> <20031028010515.3304.qmail@web13902.mail.yahoo.com>
Message-ID: <20031028095744.GA1069@frobozz>

On Mon, Oct 27, 2003 at 05:05:15PM -0800, Nathan Seven wrote:
> 
> So- assuming things go as planned, you will in the
> near future have some very-heavy-iron Twisted users :)

If things do go well, we'd love for you to add to our collection of success
stories:
    http://twistedmatrix.com/services/success

:)

-Andrew.




From v6kk1hg02 at sneakemail.com  Mon Oct 27 10:06:24 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 27 Oct 2003 15:06:24 -0000
Subject: [Twisted-Python] Re: Compile failure in 1.1.0rc1 Windows
Message-ID: <9628-70170@sneakemail.com>



> Errors display, yes, but in latest versions of Twisted it just means
> these specific C modules won't build. They are all optional. In other
> words, just ignore it.

Well, that's not a good answer (but thanks for it anyway!).
I mean the errors don't just display, they stop the entire
distutils process - it halts right at the error, and installation
does not complete.  So that is a BUG, clean and simple.

Anyway to the main point - why is this custom header being
used; or if it is not custom, why is it used in a custom
location?  All you need to do is fix that, and it would
work fine.  Someone needs to look at his header directory
structure and compare it against the standard one(s).  It's
just a config issue, and a simple one to fix.

I'd also like to plug Digital Mars C++, which is very compatible
with Microsoft Visual C++ (e.g. makefiles and such) but FREE and
superior from every angle -   http://www.DigitalMars.com
(No, I am not using it in this thread at all, just MSVC6sp5.)

If it were up to me, all of Python and all Python projects would
use DMC for Windows ports.  DMC used to be Symantec C++, now
in private (and better) hands - the original author's.  Blazing
fast speed, highly optimized output, advanced C++ features,
awesome technical support.  Blows MS tools out of the sky.
Shame that open source projects haven't caught on yet.  Oh yes,
it works with the MS Windows SDK, and handles inline assembly.

Thanks again for the wonderful TM lib,

Mark



From v6kk1hg02 at sneakemail.com  Mon Oct 27 12:41:10 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 27 Oct 2003 17:41:10 -0000
Subject: [Twisted-Python] Telnet Client as Line Receiver?
Message-ID: <25325-94083@sneakemail.com>


I need advice on telnet.  What is the current recommended best
practice for writing a telnet client?

According to the documentation on Class LineReceiver, it is
"A protocol that receives lines and/or raw data, depending on mode."

This statement pretty much covers telnet, which is basically
line-oriented terminal stuff (actually older than the internet itself).
Yet the current 1.1.0 telnet code seems weirdly scattered across TM:

* There is no class relationship to LineReceiver.
* There exists a telnet server class ("Shell") but no symmetric
  telnet client class exists anywhere.  Other TM protocols offer both.
* Some of the telnet code is stuck in the (deprecated?) manhole modules.

For testing only I got the Shell subclass working, but my real need is
a telnet client that can talk to embedded devices over Ethernet.

Advice? Should I multiply inherit from LineReceiver and Telnet?
Should I subclass Shell and pervert its server functionality into
client functionality?

Since I have to do this work anyway, I would be willing to help with
any necessary changes to the Twisted library.  Tell me what needs doing,
and I will do it, to the extent that it overlaps with my work requirements.
The telnet code looks like it's in transition or maybe stale.

Mark
Telnet spec reference,
http://mars.netanya.ac.il/~unesco/cdrom/booklet/HTML/NETWORKING/node300.html



From v6kk1hg02 at sneakemail.com  Mon Oct 27 15:41:11 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 27 Oct 2003 20:41:11 -0000
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
Message-ID: <15594-31581@sneakemail.com>

More curiosity:

* What is the preferred mechanism for local echo
of characters on the client side?  Presumably
TM has hooks for such things, with all its event
handling capabilities.

* The Shell class lives in telnet.py and the Telnet
superclass lives in a file with the same name.
I suggest a file name change here, maybe telnet_shell.py.

* The factoring between Telnet class and Shell doesn't
seem clean, on initial impression.  Telnet is already
halfway towards a server-only functionality, all of
which should be factored into Shell.  The Telnet protocol
class should be agnostic between server and client
usage.



From gerritvd at decillion.net  Tue Oct 28 05:56:06 2003
From: gerritvd at decillion.net (Gerrit van Dyk)
Date: Tue, 28 Oct 2003 12:56:06 +0200
Subject: [Twisted-Python] Twisted and Zope
Message-ID: <bnlhoj$4gc$1@sea.gmane.org>

Hi all,

I am trying to integrate Twisted and Zope. I saw a project on Sourceforge
called twistedzope, but for some reason I cannot get anonymous cvs access
to this product. Can somebody email the product to me (where can I find it
except through anonymous cvs access), or am I wasting my time in looking at
this.

Regards
Gerrit van Dyk




From radix at twistedmatrix.com  Tue Oct 28 06:30:50 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 28 Oct 2003 06:30:50 -0500
Subject: [Twisted-Python] Twisted and Zope
In-Reply-To: <bnlhoj$4gc$1@sea.gmane.org>
References: <bnlhoj$4gc$1@sea.gmane.org>
Message-ID: <20031028113050.GA868@radii>

On Tue, Oct 28, 2003 at 12:56:06PM +0200, Gerrit van Dyk wrote:
> Hi all,
> 
> I am trying to integrate Twisted and Zope. I saw a project on Sourceforge
> called twistedzope, but for some reason I cannot get anonymous cvs access
> to this product. Can somebody email the product to me (where can I find it
> except through anonymous cvs access), or am I wasting my time in looking at
> this.

You're wasting your time::

file releases: This Project Has Not Released Any Files

CVS: CVS Repository ( 0 commits, 0 adds )

And, their web site @ twistedzope.sf.net: nothing

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From radix at twistedmatrix.com  Tue Oct 28 06:34:47 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 28 Oct 2003 06:34:47 -0500
Subject: [Twisted-Python] Telnet Client as Line Receiver?
In-Reply-To: <25325-94083@sneakemail.com>
References: <25325-94083@sneakemail.com>
Message-ID: <20031028113447.GB868@radii>

On Mon, Oct 27, 2003 at 05:41:10PM -0000, Mark Evans wrote:
> Advice? Should I multiply inherit from LineReceiver and Telnet?
> Should I subclass Shell and pervert its server functionality into
> client functionality?

There is no Telnet client protocol implementation. What I recommend
doing is refactoring the "Telnet" server protocol into a superclass
(or some other usable unit of code) that can be used by both server
and client implementations; modifying Telnet class to use it, and
implementing a new Telnet client class.

> Since I have to do this work anyway, I would be willing to help with
> any necessary changes to the Twisted library.  Tell me what needs doing,
> and I will do it, to the extent that it overlaps with my work requirements.
> The telnet code looks like it's in transition or maybe stale.

Great! Thanks. Just submit any patches to the bug tracker at
http://twistedmatrix.com/bugs/

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From radix at twistedmatrix.com  Tue Oct 28 06:40:02 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 28 Oct 2003 06:40:02 -0500
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
In-Reply-To: <15594-31581@sneakemail.com>
References: <15594-31581@sneakemail.com>
Message-ID: <20031028114002.GC868@radii>

On Mon, Oct 27, 2003 at 08:41:11PM -0000, Mark Evans wrote:
> More curiosity:
> 
> * What is the preferred mechanism for local echo
> of characters on the client side?  Presumably
> TM has hooks for such things, with all its event
> handling capabilities.

No, there is no special support for echoing characters back. This is a
user-interface issue, and doesn't have anything to do with the
(non-existent) TelnetClient client protocol implementation.

> * The Shell class lives in telnet.py and the Telnet
> superclass lives in a file with the same name.
> I suggest a file name change here, maybe telnet_shell.py.

Yes, but Python has namespaces, unlike C, or whatever else you may be
used to. t.manhole.telnet is not t.protocols.telnet.

> * The factoring between Telnet class and Shell doesn't
> seem clean, on initial impression.  Telnet is already
> halfway towards a server-only functionality, all of
> which should be factored into Shell.  The Telnet protocol
> class should be agnostic between server and client
> usage.

No. Shell (in twisted.manhole.telnet) should not be where the server
implementation of the telnet protocol lives. Shell is for a remote
Python shell, not a general purpose Telnet server protocol
implementation.

twisted.protocols.telnet.Telnet should remain as the server
implementation of the Telnet protocol, and t.p.telnet.TelnetClient
should be added, using recommendations I pointed out in my other post.

Hope that helps!

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From justinjohnson at fastmail.fm  Tue Oct 28 09:13:42 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 28 Oct 2003 08:13:42 -0600
Subject: [Twisted-Python] Minor web site problem
Message-ID: <20031028141342.220149768@www.fastmail.fm>

When I click on the Twisted logo to go to the downloads section, and then
click on the logo at the top of the page to get back to the main page,
I'm sent to http://twistedmatrix.com// and get the error "No Such
Resource" when running Mozilla, or just the default "Page cannot be
found" page that IE displays if using IE.

This happens on pretty much any page when you click the logo to get back
to /.

Minor problem, but it would make the web site seem more professional if
that didn't happen.  :-)

Thanks.
-Justin



From abe at fettig.net  Tue Oct 28 09:16:39 2003
From: abe at fettig.net (Abe Fettig)
Date: Tue, 28 Oct 2003 09:16:39 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <20031028023219.GA8062@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org> <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com> <3F9DD1AC.6000602@fettig.net> <20031028023219.GA8062@twistedmatrix.com>
Message-ID: <3F9E7A47.8050207@fettig.net>

Christopher Armstrong wrote:

> See Donovan's response.

Thanks, that was what I was looking for.  For some reason I didn't see 
the bottom half of his message the first time.

Abe




From vlupien at drummonddesigns.com  Tue Oct 28 09:28:52 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Tue, 28 Oct 2003 09:28:52 -0500
Subject: [Twisted-Python] Deferred problem
Message-ID: <000001c39d5f$cf9d43b0$687ba8c0@vicky>

I'm trying to construct a new class for authentification by a database.
I used the class FilePasswordDB in checkers to build my own class
DatabaseAuthentification.  
I think my logic is alright but I get an Deferred error.  
I tested my query in an other page and I know that's working fine.  
The problem is that I don't know how I can make my program wait for the
result of my query (the query is very short).  
I tried to use defer.succeed but it doesn't seem to work.
 
Here's my code that I'm working on:
 
class DatabaseIdentification:
    
    __implements__ = (ICredentialsChecker,)
 
    def __init__(self, dbpool):
        self.dbpool = dbpool
        self.credentialInterfaces = (credentials.IUsernamePassword,)
 
    def _cbPasswordMatch(self, matched, username):
        if matched:
            return username
        else:
            return failure.Failure(error.UnauthorizedLogin())
 
    def getUser(self, username):
        sql = """SELECT * FROM users WHERE name='%s'""" %username
        results = self.dbpool.runQuery(sql)   ## the deferred result
        if results is not None:
            return results[0], results[1]
        raise KeyError(username)
 
    # same code as FilePasswordDB
    def requestAvatarId(self, c):
        try:
            u, p = self.getUser(c.username)
        except KeyError:
            return failure.Failure(error.UnauthorizedLogin())
        else:
            if components.implements(c,
credentials.IUsernameHashedPassword):
                h = self.hash(c.username, c.password, p)
                if h == p:
                    return u
                return failure.Failure(error.UnauthorizedLogin())
            else:
                return defer.maybeDeferred(c.checkPassword, p
                    ).addCallback(self._cbPasswordMatch, u)
            return failure.Failure(error.UnauthorizedLogin())
        
 
and here's the function where a call DatabaseAuthentification:
 
def createResource():
    dbpool = database.DataBase().getConnection()
    return simpleguard.guardResource(
        RootPage(dbpool=dbpool),
        #[checkers.DatabaseIdentification(sibpath(__file__,
"passwords.txt"))],
        [checkers.DatabaseIdentification(dbpool=dbpool)],
        callback=callback)    
 
THE ERROR I GET:
 
C:\PROGRA~1\Python22\lib\site-packages\twisted\cred\checkers.py, line
237 in getUser
235    results = self.dbpool.runQuery(sql)
236    if results is not None:
237      return results[0], results[1]
238    raise KeyError(username)
Locals 

username
Vicky

self
<twisted.cred.checkers.DatabaseIdentification instance at 0x007C4AA0>

results
<Deferred at 0xfe6af0>

sql
'"SELECT * FROM users WHERE name='vicky'
exceptions.AttributeError: Deferred instance has no attribute
'__getitem__'
 
I've been working for a long time on this problem, help would be really
appreciate,
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031028/8ae3d287/attachment.htm 

From itamar at itamarst.org  Tue Oct 28 10:26:05 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 28 Oct 2003 10:26:05 -0500
Subject: [Twisted-Python] Re: Compile failure in 1.1.0rc1 Windows
In-Reply-To: <9628-70170@sneakemail.com>
References: <9628-70170@sneakemail.com>
Message-ID: <20031028102605.3ab82f34.itamar@itamarst.org>

On 27 Oct 2003 15:06:24 -0000
"Mark Evans" <v6kk1hg02 at sneakemail.com> wrote:

> I'd also like to plug Digital Mars C++, which is very compatible
> with Microsoft Visual C++ (e.g. makefiles and such) but FREE and
> superior from every angle -   http://www.DigitalMars.com
> (No, I am not using it in this thread at all, just MSVC6sp5.)

I'm pretty sure the official exe gets built with mingw. Dunno how it is
feature-wise, but it has the important distinction of being open source.

Additionally, distutils would need DM C++ support, which I'm not sure it
has (feel free to add a feature request on the python SF tracker).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From matthew.s.hegedus at lmco.com  Tue Oct 28 10:41:38 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Tue, 28 Oct 2003 09:41:38 -0600
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*	internet
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>

Forgive me, I'm a little confused. I've had some trouble trying to implement
a seemingly simple web server using Woven, so the mention of this "nevow"
peaked my curiosity. On www.divmod.org I check out Quotient and it appears
to be nothing but an email app.

Here's what I've got and what I'm trying to accomplish:

  I've already created a twisted server app and client app. The client can
connect to the server, pass client   
  info to the server for management, query the server for all of the info
that it is managing, and the client can 
  manipulate this info(modify some attributes, delete info). 

  Now I want to create a web interface to this server, so that anybody can
access the server's info through a  
  browser. I want the users to have the same capabilities that the twisted
client app provides. For GUI I want 
  text input fields, tables, buttons inside and outside of tables, and maybe
a chunk of browser space devoted to 
  chat.

  With Woven I can create tables and buttons just fine, but input handling
is baffling me, and I'm suspicious of  
  webConduitGlue which is supposedly necessary for JavaScript to work and
may or may not be related to my input 
  troubles.

Is Twisted and/or Woven and/or Nevow a good technology for tackling this
sort of problem? Or is should I be looking at other technologies (JAVA
applets, JSP, servlets, CGI, ASP)? I'm lacking direction for the moment and
my confidence in Twisted is shaky(or is it just my understanding of
Twisted?). I welcome and appreciate any thoughts from this Twisted
community. Thanks,

Matthew



-----Original Message-----
From: Donovan Preston [mailto:dp at twistedmatrix.com] 
Sent: Monday, October 27, 2003 4:56 PM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
internet



On Oct 27, 2003, at 5:23 PM, darryl wrote:

>
>>> The question is, does anyone want to focus on learing woven with NEW 
>>> woven in the works?

Woven is certainly very usable in it's current state -- if you want to 
do simple-to-moderate things quickly, it can be very useful. However, 
it's complexity made it difficult to do some of the more ambitious 
things we are trying to do, such as semi-transparent form handling, and 
serverToClient events. But there are a few people who have built (and 
deployed) fairly complex woven applications. The fact that nevow exists 
doesn't detract from that.

nevow was originally a research project -- a weekend's worth of hacking 
whose benefits turned out to be so great that we decided to focus on 
bringing it up to a usable state for Quotient as soon as possible. And 
that's where it is now.

Most of the woven concepts -- template and code abstraction using a 
DOM, reusable partial page renderers (Widgets in old woven, renderer 
callables in nevow), all of the concepts needed to know to use 
twisted.web -- carry over to nevow. The only thing that's really 
changed in nevow is a few names, and the code is VASTLY simplified, 
well tested, and thus far easier to understand, design semantics for, 
and change.

>> An unfortunate last-minute change of direction, but worth it
>> considering
>>  how vastly improved the new code is.
>>
>> It's no longer a part of Twisted, however.  Check out Quotient CVS - 
>> www.divmod.org
>
> May i ask why it's not part of twisted?
> And if that's the case will Woven be maintained?

nevow will be moved into twisted after a period of 
stabilization/development in Quotient. Since twisted is a large project 
with many external developers using it, and quotient is a smaller 
project that is mostly a small core team of development, we felt it 
made sense to keep it out of twisted proper until the development had 
stabilized. Since nevow has the benefit of being a complete rewrite of 
all the *best* parts of woven, and none of the bad, stabilization has 
been remarkably quick. So expect to see nevow in twisted fairly soon.

In the meantime, woven will continue to be maintained with bugfixes, 
and nevow is fully usable outside of quotient -- even to the point of 
being fully usable without twisted.web (as a cgi, or in zope or 
webware, for example). I should also mention that there will probably 
be a compatibility layer for nevow to render old-style Woven classes 
sometime in the future. It is amazingly simple to add rendering 
functionality to it since it uses components to render the dom (which 
is really just a list of any python objects)

If you are doing any new development, I highly encourage you to take a 
look at nevow, if for no other reason than you can have a hand in 
shaping it's development. I would very much appreciate feedback about 
it, especially now, since the code is very, very short and readable.

dp


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From dp at twistedmatrix.com  Tue Oct 28 11:07:06 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Tue, 28 Oct 2003 11:07:06 -0500
Subject: [Twisted-Python] Deferred problem
In-Reply-To: <000001c39d5f$cf9d43b0$687ba8c0@vicky>
References: <000001c39d5f$cf9d43b0$687ba8c0@vicky>
Message-ID: <C6EC5006-0960-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 28, 2003, at 9:28 AM, vicky lupien wrote:

> ??? def getUser(self, username):
> ??????? sql = """SELECT * FROM users WHERE name='%s'""" %username
> ??????? results = self.dbpool.runQuery(sql)?? ## the deferred result
> ??????? if results is not None:
> ??????????? return results[0], results[1]
> ??????? raise KeyError(username)

The Deferred is a promise that some data will be available eventually. 
You cannot
immediately access the result as you try to do here. What you want to 
do is return the
deferred from here after adding a callback which checks to see if there 
was a match
in the database and returns a Failure (analogous to raising an 
exception) if not. If the
authentication succeeded, the callback should return the id of the 
authenticated user.


def requestAvatarId(self, creds):
	## Start the database query; it will not be done until later.
	theDeferred = self.dbpool.runQuery(
		"select * from users where name='%s'" % username
	)

	## Define a callback which will check the results from the database
	## when they are ready and return either the id of the user who has
	## logged in or a failure indicating login failure.
	def checkAuth(result):
		if result is None:
			return failure.Failure(UnauthorizedLogin(c.username))

		u, p = result
		if components.implements(creds, credentials.IUsernameHashedPassword):
			h = self.hash(creds.username, creds.password, p)
			if h == p:
				return u
		return failure.Failure(UnauthorizedLogin(c.username)

	## Add the callback to the Deferred and return it; when the database
	## result is ready, the callback will fire and provide either a Failure
	## or a logged in user id to the framework code which has called
	## requestAvatarId.
	return theDeferred.addCallback(
		checkAuth
	)




From itamar at itamarst.org  Tue Oct 28 12:53:36 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 28 Oct 2003 12:53:36 -0500
Subject: [Twisted-Python] Handling forms in woven
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>
Message-ID: <20031028125336.531fc215.itamar@itamarst.org>

On Tue, 28 Oct 2003 09:41:38 -0600
"Hegedus, Matthew S" <matthew.s.hegedus at lmco.com> wrote:

>   With Woven I can create tables and buttons just fine, but input
>   handling
> is baffling me, and I'm suspicious of  
>   webConduitGlue which is supposedly necessary for JavaScript to work
>   and
> may or may not be related to my input 
>   troubles.

webConduitGlue is for livepage. You don't need livepage to handle forms.
Nor do you need controllers.

The way to handle forms in woven is the same as in twisted.web proper -
override the render method on your Resource subclass (e.g. your Page
subclass) and look at request.args.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Tue Oct 28 14:37:05 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 28 Oct 2003 14:37:05 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>
Message-ID: <3F9EC561.4020906@twistedmatrix.com>

Hegedus, Matthew S wrote:
> Forgive me, I'm a little confused. I've had some trouble trying to implement
> a seemingly simple web server using Woven, so the mention of this "nevow"
> peaked my curiosity. On www.divmod.org I check out Quotient and it appears
> to be nothing but an email app.

In that sense, Twisted appears to be nothing but a select loop :).




From bob at redivi.com  Tue Oct 28 15:00:56 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 28 Oct 2003 15:00:56 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <3F9EC561.4020906@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com> <3F9EC561.4020906@twistedmatrix.com>
Message-ID: <71590F86-0981-11D8-8B4B-000A95686CD8@redivi.com>

On Oct 28, 2003, at 2:37 PM, Glyph Lefkowitz wrote:

>
> Hegedus, Matthew S wrote:
>> Forgive me, I'm a little confused. I've had some trouble trying to 
>> implement
>> a seemingly simple web server using Woven, so the mention of this 
>> "nevow"
>> peaked my curiosity. On www.divmod.org I check out Quotient and it 
>> appears
>> to be nothing but an email app.
>
> In that sense, Twisted appears to be nothing but a select loop :).

Or.. not, in the case of some reactors :)

-bob




From vlupien at drummonddesigns.com  Tue Oct 28 15:36:06 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Tue, 28 Oct 2003 15:36:06 -0500
Subject: [Twisted-Python] Authentication (cred.checkers) by a database (was deferred problem)
In-Reply-To: <C6EC5006-0960-11D8-9397-000A95864FC4@twistedmatrix.com>
Message-ID: <000001c39d93$1cf70550$687ba8c0@vicky>

Thanks to Donavan.

I tried your code, I've made a little modification and everything is
working now.  


The problem was that no chechers was from a database.  I've change the
exemple of simplyguarded to work with this new checkers.  It works
exactly like FilePasswordDB except that the data are in a database
instead of in a file.  

I would be please to give the exemple if someone need it.  You only have
to tell me and I will send it to you.

Vicky Lupien
vlupien at drummonddesigns.com




From v6kk1hg02 at sneakemail.com  Tue Oct 28 09:55:25 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 28 Oct 2003 14:55:25 -0000
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
Message-ID: <16099-04201@sneakemail.com>

Christopher Armstrong,

Thanks a million for those answers.  It sounds like we were
thinking along the same lines.  However I did not see an
answer to the subject question:  do you think that a telnet
client should be a subclass of LineReceiver?

I'm still getting my head around the architecture of TM so
forgive the ignorance, but it looks like an outstanding
system.  I've written tons of communications protocols and
apps, this is the sort of stuff I dream about.

As for Python namespaces - yeah, but it's still confusing
to have two files with the same name open in an editor!
The text editor (UltraEdit) doesn't know about Python
namespaces!

As for local echo - there is no user interface here, it's
a console app (daemon actually, I might try it as an NT
service).  So we are talking stdin/stdout sort of thinking.
The reason for the question about local echo is not that
I can't do it one way or another, but I want to do it in
a way that is compatible and elegant in TM.  LineReceiver
may have something to do with that.

Your answers do help, thanks!  If nothing else they confirm
my impressions about the telnet support.  Fortunately my
telnet needs aren't exhaustive, very little of the protocol
is necessary for us.

Mark



From sam at psychlaw.com.au  Tue Oct 28 23:53:51 2003
From: sam at psychlaw.com.au (Sam Jordan)
Date: Wed, 29 Oct 2003 14:53:51 +1000
Subject: [Twisted-Python] MSN refactor
Message-ID: <20031029045351.GA3804@twistedmatrix.com>

Hi,

As of October 15 Microsoft has stopped supporting clients wishing
to connect to the MSN chat service using a protocol version which
is less than MSNP8.

The current supported version in Twisted is MSNP7 and while most
of the protocol is still the same, it will (obviously) not work.

However, any current or potential users of the twisted msn client
support should not despair, I am currently right in the middle of
exams for the next two weeks but afterwards I will try to get
the client support up to at least MSNP8 and possibly features of
MSNP9, this is of course if glyph is ok with this; I am not a
lawyer and thus have no idea about the relevant legal ramifications
of providing support for this 'proprietary' protocol. Logically I
would assume that any legal problems would result from _using_ the
service as opposed to just providing support for it, but, as stated
I have no legal basis for this assumption and given recent legal
debacles in the U.S. I am hesitant in even holding such an opinion.

So, asside from any "please do not put me in jail" signs from glyph
I will try and address the refactoring as soon as time allows with
(hopefully) as little change to the interface as possible, although
it _is_ clearly marked as unstable.

I just thought I should let everyone know incase people were
having issues with it not working.

Cheers,

Sam Jordan



From corydodt at twistedmatrix.com  Tue Oct 28 17:34:28 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Tue, 28 Oct 2003 14:34:28 -0800
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <200310271857.h9RIvL429365@zerg.codec.ro>
References: <200310271857.h9RIvL429365@zerg.codec.ro>
Message-ID: <3F9EEEF4.3060205@twistedmatrix.com>

Winstaller is available online now.

Keep in mind that Windows builds are done after the initial release, and may 
lag by up to a week.

Enjoy.

C

soso wrote:

> Thanks for the great work!
> 
> But I can't find the windows installer. Or there isn't a windows installer for 1.1?
> 
> soso
> 
> 
> ______________________________________________________________________
> Do you want a free e-mail for life ? Get it at http://www.email.ro/
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python





From phil at bubblehouse.org  Tue Oct 28 17:38:03 2003
From: phil at bubblehouse.org (phil at bubblehouse.org)
Date: Tue, 28 Oct 2003 17:38:03 -0500 (EST)
Subject: [Twisted-Python] twisted.web and MySQLdb
Message-ID: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>

so i probably should have subscribed to this list months (years?) ago, but
only now am i getting up to speed on the twisted craziness...

anyways, i'm toying with twisted.web, and i'm working on making a web
application. i'm also using the TAP interfaces to take care of run-time
options, etc....

I'm using MySQLdb to interface with my sql server, but i'm not really sure
what to do with my connection object once it's created. i want to put it
somewhere that will be easy to access for the rest of the modules, but
obviously i don't want it to be persisted when the TAP is saved....

i guess a lot of my problem is that i'm still trying to figure out some of
the structure when working with the framework...

i want to use the command-line options to specify a user/passwd for the
database. i guess this means i want to create my connection instance in
the updateApplication method, since it has a options reference, but i
don't know how to make it so the connection object isn't persisted, but
created new each time the server is started....

any help would be appreciated....

-phil



From scosol at yahoo.com  Tue Oct 28 18:10:19 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 28 Oct 2003 15:10:19 -0800 (PST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>
Message-ID: <20031028231019.82955.qmail@web13905.mail.yahoo.com>

--- phil at bubblehouse.org wrote:
> 
> I'm using MySQLdb to interface with my sql server,
> but i'm not really sure
> what to do with my connection object once it's
> created. i want to put it
> somewhere that will be easy to access for the rest
> of the modules, but
> obviously i don't want it to be persisted when the
> TAP is saved....
.

Hmmm- well I'm just getting started here as well- but
yeah, I don't remember any mentioned way of
selectively removing state information for objects.
I don't like the whole state-saving stuff at all- I'm
doing atomic DB stuff, so my "state" above all is
maintained on the DB itself.
The Twisted clients are just basically dumb
transaction handlers.

> but i
> don't know how to make it so the connection object
> isn't persisted, but
> created new each time the server is started...

Hmmm- would a simple solution be to simply
re-initialize the connection(s) upon any restart?
(can a restart even be detected with .app?)

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From dp at twistedmatrix.com  Tue Oct 28 18:26:44 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Tue, 28 Oct 2003 18:26:44 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
References: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
Message-ID: <319D999E-099E-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 28, 2003, at 6:10 PM, Nathan Seven wrote:

> --- phil at bubblehouse.org wrote:
>>
>> I'm using MySQLdb to interface with my sql server,
>> but i'm not really sure
>> what to do with my connection object once it's
>> created. i want to put it
>> somewhere that will be easy to access for the rest
>> of the modules, but
>> obviously i don't want it to be persisted when the
>> TAP is saved....
> .
>
> Hmmm- well I'm just getting started here as well- but
> yeah, I don't remember any mentioned way of
> selectively removing state information for objects.
> I don't like the whole state-saving stuff at all- I'm
> doing atomic DB stuff, so my "state" above all is
> maintained on the DB itself.
> The Twisted clients are just basically dumb
> transaction handlers.

This is the way you should be doing it -- the only state in
the tap should be configuration information about
what services live on what ports, what directory
the web server looks at, etc.

>> but i
>> don't know how to make it so the connection object
>> isn't persisted, but
>> created new each time the server is started...
>
> Hmmm- would a simple solution be to simply
> re-initialize the connection(s) upon any restart?
> (can a restart even be detected with .app?)

Since the tap is just a pickle, the easiest way to
prevent certain objects from getting persisted is to
implement a __getstate__ and __setstate__ for
your class. See the python documentation for
information.

dp




From itamar at itamarst.org  Tue Oct 28 18:29:58 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 28 Oct 2003 18:29:58 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
References: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>
	<20031028231019.82955.qmail@web13905.mail.yahoo.com>
Message-ID: <20031028182958.167cd4c1.itamar@itamarst.org>

On Tue, 28 Oct 2003 15:10:19 -0800 (PST)
Nathan Seven <scosol at yahoo.com> wrote:

> Hmmm- would a simple solution be to simply
> re-initialize the connection(s) upon any restart?
> (can a restart even be detected with .app?)

Services get startService and stopService called on startup/shutdown of
the application. See
http://twistedmatrix.com/documents/howto/application and
twisted.application.service.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From matthew.s.hegedus at lmco.com  Tue Oct 28 19:13:04 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Tue, 28 Oct 2003 18:13:04 -0600
Subject: [Twisted-Python] Serving web pages: Using frames, and re-rendering one frame's con	tent from a separate frame, and colors
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F5@EMSS07M12.us.lmco.com>

I have set up a top level xhtml template that has multiple frames for other
xhtml templates. In one of these frames I have a button, and when it is
clicked I want to update some data and then display this data in another
frame. 

I have coded a FrameClass(page.Page) which will in turn instantiate other
Page subclasses that are responsible for rendering each frame's
corresponding xhtml file. All of my attempts end up rendering the "foreign"
frames xhtml inside of the current frame in which the button was pressed.
Hopefully I haven't made this too confusing. Any ideas?

And about colors... I use lmx to help create some xhtml but when I do
something like this...

   lmxnode = lmx(node)
   d = lmxnode.div()
   t = d.table()
   t.tr(bgcolor="eeeeee")

... trying to set the table row's background color to a light grey (hex
value "eeeeee") has no effect. If I explicity type something of the sort
into a static xhtml file, the color is correctly displayed. Anyone know
what's going on?

By the way, thanks for the previous help on handling input - I was messing
up the html form tag.

Matthew



From matt at pollenation.net  Tue Oct 28 19:37:51 2003
From: matt at pollenation.net (Matt Goodall)
Date: Wed, 29 Oct 2003 00:37:51 +0000
Subject: [Twisted-Python] MSN refactor
In-Reply-To: <20031029045351.GA3804@twistedmatrix.com>
References: <20031029045351.GA3804@twistedmatrix.com>
Message-ID: <3F9F0BDF.5050802@pollenation.net>

Sam Jordan wrote:

>I am not a
>lawyer and thus have no idea about the relevant legal ramifications
>of providing support for this 'proprietary' protocol. Logically I
>would assume that any legal problems would result from _using_ the
>service as opposed to just providing support for it, but, as stated
>I have no legal basis for this assumption and given recent legal
>debacles in the U.S. I am hesitant in even holding such an opinion.
>
Talk to the gaim developers, they may be able to tell you more about the 
legal side of this ... assuming they looked into it.

Cheers, Matt

-- 
Matt Goodall, Pollenation Internet Ltd
w: http://www.pollenation.net
e: matt at pollenation.net
t: +44 (0)113 2252500





From andrew-twisted at puzzling.org  Tue Oct 28 19:39:18 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 29 Oct 2003 11:39:18 +1100
Subject: [Twisted-Python] Re: Compile failure in 1.1.0rc1 Windows
In-Reply-To: <9628-70170@sneakemail.com>
References: <9628-70170@sneakemail.com>
Message-ID: <20031029003918.GA3030@frobozz>

On Mon, Oct 27, 2003 at 03:06:24PM -0000, Mark Evans wrote:
> 
> Anyway to the main point - why is this custom header being
> used; or if it is not custom, why is it used in a custom
> location?  All you need to do is fix that, and it would
> work fine.  Someone needs to look at his header directory
> structure and compare it against the standard one(s).  It's
> just a config issue, and a simple one to fix.

It's not a "custom header", as far as I know.  portmap.c simply wraps a
couple of simple functions (pmap_set and pmap_unset) to allow
twisted.runner.inetd to support Sun-RPC services, in addition to the usual
TCP and UDP services.

I'm reasonably sure that Windows doesn't have Sun-RPC support, so that
module not compiling is expected behaviour.  If that's stopping setup.py
from completing, then that sounds like a bug, and a bug report added to
http://twistedmatrix.com/bugs would be appreciated :)

-Andrew.




From stuart.hungerford at anu.edu.au  Tue Oct 28 20:12:18 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Wed, 29 Oct 2003 12:12:18 +1100
Subject: [Twisted-Python] Handling forms in woven
In-Reply-To: <20031028232701.26785.14176.Mailman@pyramid.twistedmatrix.c
 om>
References: <20031028232701.26785.14176.Mailman@pyramid.twistedmatrix.com>
Message-ID: <6.0.0.22.0.20031029120458.01e1f788@anusf.anu.edu.au>

Quoth Itamar:

 >webConduitGlue is for livepage. You don't need livepage to handle forms.
 >Nor do you need controllers.
 >
 >The way to handle forms in woven is the same as in twisted.web proper -
 >override the render method on your Resource subclass (e.g. your Page
 >subclass) and look at request.args.

   This issue of when a Woven Page subclass has a render() method is
   one that seems to come up quite often in my use of Twisted web.

   If a Woven Page has a bunch of model factory and view update methods
   etc, how/when are they run if the page also has a render() method?

   Should the subclass' render() method always call the superclass'
   render() method?

   A good example is with simpleguard'ed pages which seem to need a
   render() method for the simpleguard check/fail tests but may also
   have a bunch of model and view methods for generating the HTML.

   Any advice much appreciated,


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From andrew-twisted at puzzling.org  Tue Oct 28 20:37:47 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 29 Oct 2003 12:37:47 +1100
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
In-Reply-To: <16099-04201@sneakemail.com>
References: <16099-04201@sneakemail.com>
Message-ID: <20031029013746.GB3030@frobozz>

On Tue, Oct 28, 2003 at 02:55:25PM -0000, Mark Evans wrote:
> 
> As for local echo - there is no user interface here, it's
> a console app (daemon actually, I might try it as an NT
> service).  So we are talking stdin/stdout sort of thinking.
> The reason for the question about local echo is not that
> I can't do it one way or another, but I want to do it in
> a way that is compatible and elegant in TM.  LineReceiver
> may have something to do with that.

No, the telnet client protocol has nothing to do with local echo.  A
TelnetClient instance would be responsible for sending and receiving data
over the socket, and local echo would be handled by whatever is responsible
for sending and receiving data over stdout/stdin.

So, whatever is talking to your stdin/stdout (probably a protocol instance
passed to twisted.internet.stdio.StandardIO) would have a reference to the
TelnetClient instance, so when the stdio's protocol's dataReceived is
called, it would check, say, self.telnetclient.localEcho, and call
self.transport.write if true.  

So the telnet client is responsible for letting whatever is using it know
that localEcho is or isn't set; but the actual echoing is done elsewhere.
Perhaps this is what you meant :)

-Andrew.




From itamar at itamarst.org  Tue Oct 28 21:04:24 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 28 Oct 2003 21:04:24 -0500
Subject: [Twisted-Python] Handling forms in woven
In-Reply-To: <6.0.0.22.0.20031029120458.01e1f788@anusf.anu.edu.au>
References: <20031028232701.26785.14176.Mailman@pyramid.twistedmatrix.com>
	<6.0.0.22.0.20031029120458.01e1f788@anusf.anu.edu.au>
Message-ID: <20031028210424.5d2fa22a.itamar@itamarst.org>

On Wed, 29 Oct 2003 12:12:18 +1100
Stuart Hungerford <stuart.hungerford at anu.edu.au> wrote:

>    Should the subclass' render() method always call the superclass'
>    render() method?

Yes. Or redirect somewhere useful.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From foom at fuhm.net  Tue Oct 28 22:06:59 2003
From: foom at fuhm.net (James Y Knight)
Date: Tue, 28 Oct 2003 22:06:59 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
References: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
Message-ID: <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>

On Oct 28, 2003, at 6:10 PM, Nathan Seven wrote:

> --- phil at bubblehouse.org wrote:
>>
>> I'm using MySQLdb to interface with my sql server,
>> but i'm not really sure
>> what to do with my connection object once it's
>> created. i want to put it
>> somewhere that will be easy to access for the rest
>> of the modules, but
>> obviously i don't want it to be persisted when the
>> TAP is saved....
> .
>
> Hmmm- well I'm just getting started here as well- but
> yeah, I don't remember any mentioned way of
> selectively removing state information for objects.
> I don't like the whole state-saving stuff at all- I'm
> doing atomic DB stuff, so my "state" above all is
> maintained on the DB itself.
> The Twisted clients are just basically dumb
> transaction handlers.

You should just not use the whole pickled app/saving state thing. Then 
you don't have to worry about this stuff at all. In addition the next 
person who comes along and wants to debug something will thank you 
profusely when he doesn't have to sit there and ponder "gee, I wonder 
what parameters the last person gave to mktap, cause I really would 
like to startup a second copy of that app on another port. (or from a 
different directory, with a new file type handler, whatever)...".

I recommend configuring your webserver with python code and starting it 
with twistd -y. Perhaps not ideal but certainly better than the whole 
tap mess.

All IMO, of course.

James




From butchland at yahoo.com  Tue Oct 28 22:33:12 2003
From: butchland at yahoo.com (Butch Landingin)
Date: Tue, 28 Oct 2003 19:33:12 -0800 (PST)
Subject: [Twisted-Python] Twisted and Zope
In-Reply-To: <20031028114356.30952.55874.Mailman@pyramid.twistedmatrix.com>
Message-ID: <20031029033312.50955.qmail@web80605.mail.yahoo.com>

--- On  Tue, 28 Oct 2003 12:56:06 +0200, Gerrit van Dyk <gerritvd at decillion.net>wrote:
> 
> Hi all,
> 
> I am trying to integrate Twisted and Zope. I saw a project on Sourceforge
> called twistedzope, but for some reason I cannot get anonymous cvs access
> to this product. Can somebody email the product to me (where can I find it
> except through anonymous cvs access), or am I wasting my time in looking at
> this.

Hi Gerrit, 

I created the project and I'm in the process of preparing its initial release which I plan
to do sometime next week (barring any major hitches). I also plan to upload my local
CVS repository shortly after that to the SF cvs.

Currently,  the module already allows you to run the zope3 http server over  twisted's
reactor framework. I'm currently working on the zope3 ftp server which  I plan to
finish before releasing the package.  I also wrote a minimal TAP plug-in that can configure and
run 
the zope3 http server  using mktap and twistd..

Some other stuff  that I'm playing around with:  configuring  twisted wire protocol 
servers (e.g. daytime, echo) using the Zope3 ZConfig configuration package.

If you're interested, you could serve as my sanity checking guinea pig :^) -- meaning I send
a release candidate to you and you can try to follow the instructions and see if  it runs
on your system.

Regards,

Butch Landingin


__________________________________
Do you Yahoo!?
Exclusive Video Premiere - Britney Spears
http://launch.yahoo.com/promos/britneyspears/



From scosol at yahoo.com  Tue Oct 28 22:34:22 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 28 Oct 2003 19:34:22 -0800 (PST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <20031029033422.32190.qmail@web13903.mail.yahoo.com>

--- James Y Knight <foom at fuhm.net> wrote:
> 
> You should just not use the whole pickled app/saving
> state thing. Then 
> you don't have to worry about this stuff at all. In
> addition the next 
> person who comes along and wants to debug something
> will thank you 
> profusely when he doesn't have to sit there and
> ponder "gee, I wonder 
> what parameters the last person gave to mktap, cause
> I really would 
> like to startup a second copy of that app on another
> port. (or from a 
> different directory, with a new file type handler,
> whatever)...".
> 
> I recommend configuring your webserver with python
> code and starting it 
> with twistd -y. Perhaps not ideal but certainly
> better than the whole 
> tap mess.

Right right- I'm not using it at all- but the other
guy seemed to have some requirement for it.
Tho- for logging and such I may use .app but just run
with the -no_save option.

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From dp at twistedmatrix.com  Tue Oct 28 22:48:37 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Tue, 28 Oct 2003 22:48:37 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>
References: <20031028231019.82955.qmail@web13905.mail.yahoo.com> <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <C7461021-09C2-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 28, 2003, at 10:06 PM, James Y Knight wrote:

> You should just not use the whole pickled app/saving state thing. Then 
> you don't have to worry about this stuff at all. In addition the next 
> person who comes along and wants to debug something will thank you 
> profusely when he doesn't have to sit there and ponder "gee, I wonder 
> what parameters the last person gave to mktap, cause I really would 
> like to startup a second copy of that app on another port. (or from a 
> different directory, with a new file type handler, whatever)...".
>
> I recommend configuring your webserver with python code and starting 
> it with twistd -y. Perhaps not ideal but certainly better than the 
> whole tap mess.

Now that freeform is done in quotient and passing existing object 
references to formless methods is next up on the plate (and the 
implementation is far cleaner than the old quotient 
formless/configure/webform) we can get started on writing COIL sometime 
in the near future so you can configure pickled application instances 
in the tap using a nice web ui. Having a good configuration interface 
which allows you to load the serialized application, reconfigure it, 
and serialize it back out to disk has always been an integral part of 
the tap idea that has never actually been implemented properly yet.

The "I wonder what parameters were used" idea is pretty interesting, 
though. It would be trivial to serialize the command-line options that 
were given to each invocation of mktap along with everything else so at 
the very least we could show you which command line options were used 
to build the application in the first place.

dp




From lafou at wanadoo.fr  Wed Oct 29 01:52:22 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Wed, 29 Oct 2003 07:52:22 +0100
Subject: [Twisted-Python] Martin Moellenbeck/PLUS/MHM/TUG/DE ist
	=?ISO-8859-1?Q?au=DFer?= Haus.
In-Reply-To: <OF09F48F40.82FAE4CF-ONC1256DCD.00000AE1-C1256DCD.00000AE1@uz.tengelmann.de>
References: 
	 <OF09F48F40.82FAE4CF-ONC1256DCD.00000AE1-C1256DCD.00000AE1@uz.tengelmann.de>
Message-ID: <1067410341.4879.0.camel@pcmarie>

Please post in english .......! :(

On Tue, 2003-10-28 at 01:00, mmoellenbeck at plus.de wrote:
> Ich werde ab  27.10.2003 nicht im B?ro sein. Ich kehre zur?ck am
> 09.11.2003.
> 
> Ich werde Ihre Nachricht nach meiner R?ckkehr beantworten.
> 
> In dringenden F?llen richten Sie sich bitte an Herrn Kimpenhaus oder Herrn
> Albring.





From radix at twistedmatrix.com  Wed Oct 29 01:58:37 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 29 Oct 2003 01:58:37 -0500
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
In-Reply-To: <16099-04201@sneakemail.com>
References: <16099-04201@sneakemail.com>
Message-ID: <20031029065837.GD8062@twistedmatrix.com>

On Tue, Oct 28, 2003 at 02:55:25PM -0000, Mark Evans wrote:

> do you think that a telnet client should be a subclass of
> LineReceiver?

Hmm.. Well, I think it should probably expose a line-based interface,
but you may have to implement it yourself without
LineReceiver. "Prompts" are ubiquitous in telnet-based services, so
you're going to have to handle that case. You can never tell when a
prompt will be received, so using LineReceiver at all is
futile. Perhaps there could be two event-methods, lineReceived and
promptReceived, where promptReceived is called when input has been
received that matches a user-defined "prompt pattern", and no data has
been received for N.n seconds after that input was received?

I recommend just implementing it however you need it to be implemented
and posting a patch to the bug tracker. Someone (perhaps me) will take
a look at it.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From m at zadka.site.co.il  Wed Oct 29 01:28:17 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 29 Oct 2003 06:28:17 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>
References: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>
Message-ID: <20031029062817.23143.qmail@green.zadka.com>

I won't reply to your question here, I'm sure someone more competent
than me can do so.
I will take a minute to note that for some reason, the instinct of
web developers has been to immediately write applications in the
LAMP model. While twisted.web is a perfectly good substitute for
A, and can indeed be used this way, it is much more capable.

LAMP -- Linux Apache MySQL PHP [each of those has variants]

Linux (and most other things in the "L" place, such as FreeBSD) has
an incredibly fast fork() operation. This leads people to write their
web code with the process-per-page model. Apache optimizes this by
preforking, making such code actually scalable enough to deliver good
response times. However, suddenly there is a problem: since different
processes are likely to deal with the same user, memory becomes fragile.
It is unsafe to put things in memory: processes switch users, get born
and die too often. In Linux, and most other Unices, file locking has
been a thorny issue. So instead of putting data in files, where the
subtle semantics of locking and concurrency should be dealt with,
data tends to end up in the database. That means *all* data. Sessions.
Temporary "show this message when the user finished his redirect loop".
Etc. etc. Once all the data is in MySQL, which is the easiest database to
set up, it becomes natural for the average page to be a "glorified select".
PHP was designed for this exact scenario: take a select table and spruce
it up with HTML.

Unfortunately, what LAMP deals to is exactly to this: inevitably, all
pages are just spruced up select-tables. This makes programming somewhat
unnatural unless you're programming a database viewer.

With twisted.web, you don't have these problems. It is easy to keep data
in files, because locking is not an issue. It is easy to cache data in memory
because everything is served from a single process. If you need to attach
state to a user's session, you can just keep an object in the session.
This means programming twisted.web should be a lot more like writing
a GUI application, and a lot less like writing select-with-HTML.
You should probably reconsider whether you really want MySQL. It adds
complexity to your application, and the gain is usually small. Putting
persistent data in files, and using liberal caching schemes, also plays
on the core advantage of Linux (and similar) -- it uses the incredibly
optimized caching algorithms.



From m at zadka.site.co.il  Wed Oct 29 01:46:27 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 29 Oct 2003 06:46:27 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <C7461021-09C2-11D8-9397-000A95864FC4@twistedmatrix.com>
References: <C7461021-09C2-11D8-9397-000A95864FC4@twistedmatrix.com>, <20031028231019.82955.qmail@web13905.mail.yahoo.com> <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <20031029064627.23375.qmail@green.zadka.com>

On Tue, 28 Oct 2003, Donovan Preston <dp at twistedmatrix.com> wrote:

> The "I wonder what parameters were used" idea is pretty interesting, 
> though. It would be trivial to serialize the command-line options that 
> were given to each invocation of mktap along with everything else so at 
> the very least we could show you which command line options were used 
> to build the application in the first place.

Well, you'd have to consider what to do about mktap --append.
Assuming you just want a "history of command line", it would be
a 10-minute hack to mktap, which is based on a service:

class MktapArgs(service.Service):
    def __init__(self):
        self.setName("mktap")
        self.history = []
    def run(self):
        self.history.append(sys.argv)

def document(application):
    try:
        s = service.IServiceCollection(application).getServiceByName("mktap")
    except KeyError
        s = MktapArgs()
        s.setServiceParent(application)
    s.run()

And just add a call to document(application) in twisted/scripts/mktap.py, five
lines into addToApplication.



From scosol at yahoo.com  Wed Oct 29 02:34:37 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 28 Oct 2003 23:34:37 -0800 (PST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029062817.23143.qmail@green.zadka.com>
Message-ID: <20031029073437.52308.qmail@web13908.mail.yahoo.com>

--- Moshe Zadka <m at zadka.site.co.il> wrote:
>
> In Linux, and most other Unices,
> file locking has
> been a thorny issue. So instead of putting data in
> files, where the
> subtle semantics of locking and concurrency should
> be dealt with,
> data tends to end up in the database. That means
> *all* data. Sessions.
> Temporary "show this message when the user finished
> his redirect loop".

Hmmmm I would qualify that- I dont think the
filesystem is the place to be handling dynamic data. 
Databases were created *specifically* for this
purpose.  Sure, storing all your static blobs in your
database is a really quick way to grind shit to a
halt, but locking and concurrency?
If you're doing things properly, and your http server
is just serving static objects, then these are
non-issues.

> Etc. etc. Once all the data is in MySQL, which is
> the easiest database to
> set up, it becomes natural for the average page to
> be a "glorified select".
> PHP was designed for this exact scenario: take a
> select table and spruce
> it up with HTML.

Yeah- through my line of work I deal with a *lot* of
different infrastructures.  Everything from "Joe's BBQ
Sauce Garage" to Amazon.  Literally the only
organization I can think of that can keep anything
coherent with MySQL is Livejournal- and then I believe
only because Brad seems to be a cache-god with
memcached and such.

Speaking of- I know we're kinda tied to Python, but
what are the thoughts about using any of the OS's
provided event-driven polls? (epoll,kqueue) 
I'm guessing these are essentially untouchable without
Python mods.

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From illumen at yahoo.com  Wed Oct 29 02:50:56 2003
From: illumen at yahoo.com (Rene Dudfield)
Date: Wed, 29 Oct 2003 17:50:56 +1000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029062817.23143.qmail@green.zadka.com>
References: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2> <20031029062817.23143.qmail@green.zadka.com>
Message-ID: <3F9F7160.10105@yahoo.com>

Moshe Zadka wrote:

>I won't reply to your question here, I'm sure someone more competent
>than me can do so.
>I will take a minute to note that for some reason, the instinct of
>web developers has been to immediately write applications in the
>LAMP model. While twisted.web is a perfectly good substitute for
>A, and can indeed be used this way, it is much more capable.
>
>LAMP -- Linux Apache MySQL PHP [each of those has variants]
>
>Linux (and most other things in the "L" place, such as FreeBSD) has
>an incredibly fast fork() operation. This leads people to write their
>web code with the process-per-page model. Apache optimizes this by
>preforking, making such code actually scalable enough to deliver good
>response times. However, suddenly there is a problem: since different
>processes are likely to deal with the same user, memory becomes fragile.
>It is unsafe to put things in memory: processes switch users, get born
>and die too often. In Linux, and most other Unices, file locking has
>been a thorny issue. So instead of putting data in files, where the
>subtle semantics of locking and concurrency should be dealt with,
>data tends to end up in the database. That means *all* data. Sessions.
>Temporary "show this message when the user finished his redirect loop".
>Etc. etc. Once all the data is in MySQL, which is the easiest database to
>set up, it becomes natural for the average page to be a "glorified select".
>PHP was designed for this exact scenario: take a select table and spruce
>it up with HTML.
>
>Unfortunately, what LAMP deals to is exactly to this: inevitably, all
>pages are just spruced up select-tables. This makes programming somewhat
>unnatural unless you're programming a database viewer.
>
>With twisted.web, you don't have these problems. It is easy to keep data
>in files, because locking is not an issue. It is easy to cache data in memory
>because everything is served from a single process. If you need to attach
>state to a user's session, you can just keep an object in the session.
>This means programming twisted.web should be a lot more like writing
>a GUI application, and a lot less like writing select-with-HTML.
>You should probably reconsider whether you really want MySQL. It adds
>complexity to your application, and the gain is usually small. Putting
>persistent data in files, and using liberal caching schemes, also plays
>on the core advantage of Linux (and similar) -- it uses the incredibly
>optimized caching algorithms.
>
>
>  
>
RANDOM NOTES ON THIS TOPIC:

Single process has problems too:
- if something blocks or stalls down comes your whole app.  This can 
happen in multi proccess too of course.
- you don't use the operating systems privileges.  You invent your own 
which is often broken and needs to be rewritten a few times.

Of course both of these can happen with your LAMP too.  If the db goes 
down or whatever.  But I guess multiprocess is more resiliant.

Some people find select statements easier.  Often you can do something 
in a line or two which is cumbersum in python.

Berkley db databases are nice to use.  They are quite optimized, and can 
emulate python dictionaries quite nicely.  Then there is zopedb which is 
an option.

Another feature databases have over files is transactions(comming soon 
to a FS near you!).  Making sure stuff is written to files reliably is 
quite difficult.

Databases are accessable from database viewers!  This is handy since 
random python object viewers are not so good :)  You can access 
databases easily from other languages, whereas python objects are harder 
to do.  I guess jelly/xmlrpc/soap helps here if you want to use those.

Databases also handle large volumes of data efficiently(or try to).  
Keeping everything in files is fine as long as you lay it out nicely and 
you have plenty of time to optimize each new query.  However the 
advantages/disadvantages of dbs are discussed to death all over the 
place, and I have nothing new to add.

Be nice to be able to use python objects as memory mapped files.  I 
guess it may be possible.  It has been done with numeric arrays, and 
with c++ objects.  This can be faster than reading files in linux too.

A lot of web pages can be cached into static files which improves 
performance by a lot.  Chucking squid, or apache as proxy in front of 
your normal webserver(s) can be a large help if you are careful.


Have fun!




From stenis at stenhard.net  Wed Oct 29 03:06:49 2003
From: stenis at stenhard.net (=?iso-8859-1?Q?Martin_Stenh=E5rd?=)
Date: Wed, 29 Oct 2003 09:06:49 +0100
Subject: [Twisted-Python] =?iso-8859-1?Q?RE:_=5BTwisted-Python=5D_Martin_Moellenbeck/PLUS/MHM/TUG/D?=
 =?iso-8859-1?Q?E_istau=DFer_Haus.?=
In-Reply-To: <1067410341.4879.0.camel@pcmarie>
Message-ID: <E1AElMN-00049X-00@pyramid.twistedmatrix.com>

He is out office :)

/Stenis

-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com] On Behalf Of Philippe
Lafoucri?re
Sent: den 29 oktober 2003 07:52
To: Twisted
Subject: Re: [Twisted-Python] Martin Moellenbeck/PLUS/MHM/TUG/DE istau?er
Haus.

Please post in english .......! :(

On Tue, 2003-10-28 at 01:00, mmoellenbeck at plus.de wrote:
> Ich werde ab  27.10.2003 nicht im B?ro sein. Ich kehre zur?ck am
> 09.11.2003.
> 
> Ich werde Ihre Nachricht nach meiner R?ckkehr beantworten.
> 
> In dringenden F?llen richten Sie sich bitte an Herrn Kimpenhaus oder Herrn
> Albring.



_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From andrew-twisted at puzzling.org  Wed Oct 29 03:57:58 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 29 Oct 2003 19:57:58 +1100
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
References: <20031029062817.23143.qmail@green.zadka.com> <20031029073437.52308.qmail@web13908.mail.yahoo.com>
Message-ID: <20031029085758.GC3030@frobozz>

On Tue, Oct 28, 2003 at 11:34:37PM -0800, Nathan Seven wrote:
> 
> Speaking of- I know we're kinda tied to Python, but
> what are the thoughts about using any of the OS's
> provided event-driven polls? (epoll,kqueue) 
> I'm guessing these are essentially untouchable without
> Python mods.

There's a kqueue reactor already -- see twisted/internet/kqreactor.py (yes,
it does rely up on an extension module).  I'm not sure how complete it is,
it's not tested by the buildbot.

epoll shouldn't be too hard to do with pretty much the same approach.
Patches accepted :)

-Andrew.




From twisted at zadka.site.co.il  Wed Oct 29 07:25:26 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 29 Oct 2003 12:25:26 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
References: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
Message-ID: <20031029122526.5873.qmail@green.zadka.com>

On Tue, 28 Oct 2003, Nathan Seven <scosol at yahoo.com> wrote:

> Hmmmm I would qualify that- I dont think the
> filesystem is the place to be handling dynamic data. 

Why? It has been used for dynamic data for ages.
What makes a database better for that?

> Databases were created *specifically* for this
> purpose.

We have always been at war with euroasia.

> locking and concurrency?

Are not an issue when using twisted.web idiomatically.

> Yeah- through my line of work I deal with a *lot* of
> different infrastructures.  Everything from "Joe's BBQ
> Sauce Garage" to Amazon.

I'm willing to bet that they all run on systems which contain
filesystems :)

> Speaking of- I know we're kinda tied to Python, but
> what are the thoughts about using any of the OS's
> provided event-driven polls? (epoll,kqueue) 

We have a kqueue proof of concept, but it's fairly buggy.
Fixes from people who run FreeBSD would be more than welcome!
Twisted uses the reactor as an abstract inteface especially so you
could use any event-driver you want. We tie into select, poll, gtk2
and Mac OS's CF stuff. More reactor implementations would be welcome,
and it is fairly easy to run the test suite with a new reactor
if you want to see how buggy it is.

Modules like ctypes and frameworks like pyrex are easily used to
write interfaces to all kinds of OS-specific stuff.



From ecn at metaslash.com  Wed Oct 29 07:49:47 2003
From: ecn at metaslash.com (Eric C. Newton)
Date: Wed, 29 Oct 2003 07:49:47 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029085758.GC3030@frobozz>
References: <20031029062817.23143.qmail@green.zadka.com> <20031029073437.52308.qmail@web13908.mail.yahoo.com> <20031029085758.GC3030@frobozz>
Message-ID: <20031029124947.GA5294@localhost.localdomain>

I looked into this for a few hours.  I had to build a server that
needed to regularly maintain 20K+ connections.  Of course, I prototyped
it in python first.

It takes a long time just to create and accept 20K+ connections 
in Python.  Epoll wasn't going to help that much.

In the end I wrote it in C++ using ACE.  Since ACE supports poll()
and epoll() event loops, I experimented with both.  I was surprised
that the poll() interface performed nearly as well as epoll() for my
tests.

BTW, if you are going to play around with large numbers of connections,
and you are using Linux, drop the kernel per-connection buffer sizes.

-Eric

On Wed, Oct 29, 2003 at 07:57:58PM +1100, Andrew Bennetts wrote:
> On Tue, Oct 28, 2003 at 11:34:37PM -0800, Nathan Seven wrote:
> > 
> > Speaking of- I know we're kinda tied to Python, but
> > what are the thoughts about using any of the OS's
> > provided event-driven polls? (epoll,kqueue) 
> > I'm guessing these are essentially untouchable without
> > Python mods.
> 
> There's a kqueue reactor already -- see twisted/internet/kqreactor.py (yes,
> it does rely up on an extension module).  I'm not sure how complete it is,
> it's not tested by the buildbot.
> 
> epoll shouldn't be too hard to do with pretty much the same approach.
> Patches accepted :)
> 
> -Andrew.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From glyph at twistedmatrix.com  Wed Oct 29 09:18:15 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 29 Oct 2003 09:18:15 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029124947.GA5294@localhost.localdomain>
References: <20031029062817.23143.qmail@green.zadka.com> <20031029073437.52308.qmail@web13908.mail.yahoo.com> <20031029085758.GC3030@frobozz> <20031029124947.GA5294@localhost.localdomain>
Message-ID: <3F9FCC27.4080301@twistedmatrix.com>

Eric C. Newton wrote:
> I looked into this for a few hours.  I had to build a server that
> needed to regularly maintain 20K+ connections.  Of course, I prototyped
> it in python first.
> 
> It takes a long time just to create and accept 20K+ connections 
> in Python.  Epoll wasn't going to help that much.

Can you qualify "long time"?  And what's the bottleneck?  At the scale 
of 100K or so function calls, Python isn't egregiously slow, certainly 
not slow enough to not be able to outrun TCP connection setup...?




From glyph at twistedmatrix.com  Wed Oct 29 09:43:36 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 29 Oct 2003 09:43:36 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
References: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
Message-ID: <3F9FD218.8060001@twistedmatrix.com>

Nathan Seven wrote:

> Hmmmm I would qualify that- I dont think the
> filesystem is the place to be handling dynamic data. 

The filesystem is a fine place.

For example, in the Prevayler persistence model, you just write logfiles 
to disk, and synchronize your state at a checkpoint.  For highly dynamic 
applications, especially ones which require failover, (You can re-play 
the transaction log live, after all) this works quite well.

> Databases were created *specifically* for this
> purpose.

I think that databases were specifically designed to store accounting 
information, actually.

> Sure, storing all your static blobs in your
> database is a really quick way to grind shit to a
> halt, but locking and concurrency?
> If you're doing things properly, and your http server
> is just serving static objects, then these are
> non-issues.

Databases can be amazingly slow, especially if you have a lot of updates 
to do.  (Even a very fast database can be made slow by I/O bottlenecks 
if you are trying to make it remote for scalability reasons.)  This has 
an easy solution: you can cache everything!  Of course, then you need to 
be able to easily access the cache from all of the machines, because it 
may have been updated.  Now you have problems with coherency.  Then you 
need to lock the cache, because it could have been updated, and then you 
need to read from it.

Pretty soon you're talking to your caching server as if it were a 
database.  This is _great_ if you are Livejournal:

> Yeah- through my line of work I deal with a *lot* of
> different infrastructures.  Everything from "Joe's BBQ
> Sauce Garage" to Amazon.  Literally the only
> organization I can think of that can keep anything
> coherent with MySQL is Livejournal- and then I believe
> only because Brad seems to be a cache-god with
> memcached and such.

because then you don't have to worry about computation, mutable data, 
etc - you're basically just storing data and then spitting it back out, 
and you don't care if the timestamps are a little off.

This is the important point about LAMP and Twisted:

There are applications which can connect to HTTP which are not blogs.

If you are writing a multiplayer game which wants to support lots of 
concurrent users, you can't afford to spawn a thread and do a database 
request every time a player picks something up.  (Python is quite slow 
enough already, thanks.)  You can't just use a cache because the data 
changes _all the time_, and you have to care about it from everywhere 
that you care about your data.  Working with your objects directly in 
memory is close to the only option.

If you're writing a real-time financial data system, you do want to use 
a database, but you want to very carefully control your access to it. 
Certainly, you don't want to equate 'web hit' with 'database query', as 
the LAMP model is wont to do.

Or maybe you're writing an application that has to operate as a 
client-side proxy, and you don't have the leisure of a DBA at every 
desk, so you can't require that an RDBMS gets set up with each 
installation.  This might require some hackish workarounds with the 
filesystem that you'd rather not do, but nevertheless, it's better than 
having the user editing pg_hba.conf themselves.





From golux at comcast.net  Tue Oct 28 11:00:45 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Tue, 28 Oct 2003 11:00:45 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FD218.8060001@twistedmatrix.com>
References: <20031029073437.52308.qmail@web13908.mail.yahoo.com> <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <3F9E92AD.3000708@comcast.net>

Glyph Lefkowitz wrote:

>> Databases were created *specifically* for this
>> purpose.
> 
> I think that databases were specifically designed to store accounting 
> information, actually.

Maybe in the 60's they were, but they have much more
power now than they did in those days.  (Codd and Date
would give you a more elaborate answer ... ;)

But the optimal choice for any given application
usually depends on a multitude of details, so these
generalizations have limited usefulness.

IOW, this is mainly a techno-religious discussion.  ;)

Cheers,
Steve.




From illumen at yahoo.com  Wed Oct 29 11:35:20 2003
From: illumen at yahoo.com (Rene Dudfield)
Date: Thu, 30 Oct 2003 02:35:20 +1000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FD218.8060001@twistedmatrix.com>
References: <20031029073437.52308.qmail@web13908.mail.yahoo.com> <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <3F9FEC48.7020403@yahoo.com>

Hello,

adding more random thoughts below on LAMP sucking, and spitting.


Glyph Lefkowitz wrote:

> Nathan Seven wrote:
>
>> Hmmmm I would qualify that- I dont think the
>> filesystem is the place to be handling dynamic data. 
>
>
> The filesystem is a fine place.
>
> For example, in the Prevayler persistence model, you just write 
> logfiles to disk, and synchronize your state at a checkpoint.  For 
> highly dynamic applications, especially ones which require failover, 
> (You can re-play the transaction log live, after all) this works quite 
> well.
>
>> Databases were created *specifically* for this
>> purpose.
>
>
> I think that databases were specifically designed to store accounting 
> information, actually.
>
>> Sure, storing all your static blobs in your
>> database is a really quick way to grind shit to a
>> halt, but locking and concurrency?
>> If you're doing things properly, and your http server
>> is just serving static objects, then these are
>> non-issues.
>
>
> Databases can be amazingly slow, especially if you have a lot of 
> updates to do.  (Even a very fast database can be made slow by I/O 
> bottlenecks if you are trying to make it remote for scalability 
> reasons.)  This has an easy solution: you can cache everything!  Of 
> course, then you need to be able to easily access the cache from all 
> of the machines, because it may have been updated.  Now you have 
> problems with coherency.  Then you need to lock the cache, because it 
> could have been updated, and then you need to read from it.
>
> Pretty soon you're talking to your caching server as if it were a 
> database.  This is _great_ if you are Livejournal:
>
>> Yeah- through my line of work I deal with a *lot* of
>> different infrastructures.  Everything from "Joe's BBQ
>> Sauce Garage" to Amazon.  Literally the only
>> organization I can think of that can keep anything
>> coherent with MySQL is Livejournal- and then I believe
>> only because Brad seems to be a cache-god with
>> memcached and such.
>
>
> because then you don't have to worry about computation, mutable data, 
> etc - you're basically just storing data and then spitting it back 
> out, and you don't care if the timestamps are a little off.
>
> This is the important point about LAMP and Twisted:
>
> There are applications which can connect to HTTP which are not blogs.
>
> If you are writing a multiplayer game which wants to support lots of 
> concurrent users, you can't afford to spawn a thread and do a database 
> request every time a player picks something up.  

New versions of linux have very quick threads.  Also different apps have 
different speeds for threads.  Small programs (say less than 100 
kilobytes) which are entirely static are lots faster than multi megabyte 
processes which dynamically load things.  Threads and processes also can 
easily use multiple cpus. 

Of course there are other reasons people don't like threads.

http for games?  If your game is sensitive to latency and you can help 
it, avoid http for games.  Http gives you much more latency than a db.  
So does a centralised server for that matter.  In a two player game you 
can half your latency by talking directly to each other.  Assuming you 
both aren't behind a non configurable firewall, or a proxy server.  http 
is good as a backup protocol though.  Because some fascists don't allow 
anything but access to the internet except through a proxy.  Or maybe 
you are playing a game in a web browser :)

Note that some dbs have async interfaces(eg postgres).  So you wouldn't 
need a thread.


btw, anyone know if sendfile is in (or going to be in python soon)?
http://mail.python.org/pipermail/python-dev/2002-March/021498.html

> (Python is quite slow enough already, thanks.)  You can't just use a 
> cache because the data changes _all the time_, and you have to care 
> about it from everywhere that you care about your data.  Working with 
> your objects directly in memory is close to the only option.

What about berkley dbs?  I think bsddb3 was 3-4 times slower than a 
python dict in general.  They are very quick, and you don't need to lock 
them.  You can use transactions.  Locking can kill performance.

Quickness depends on memory, and data sets really.  These are 
approximate speedinesses of python dictionary like things for different 
data sizes and memory:
say 700MB of memory:

200 MB key value data - python dicts, kjDicts, berklydb3 on disk db.
400 MB key value data - kjDicts(as python dicts use more memory and 
begin swapping), berkley db3-4 on disk, python dicts.
 > 2 gigs of key value data - berkley db3-4 on disk, kjDicts(the kjdict 
starts swapping before here), python dicts.

Of course deleting large python dicts is *really* slow.  I used to kill 
my python processes with kill -9 so that I didn't have to wait for the 
reference counting garbage collecting beast to do lots of free()s on the 
dicts memory.  kjDicts and bsddb dbs were faster for deleting.

Some people do use RDBMS for large online games.  Check out 
gamasutra.com for some articles.  Seems they have lots of fun 
performance problems.

Compressing the hash would be nice.  Maybe memory mapped files on a 
compressed file system would be quick for this ;) 

Distributed hashes would also be nice!  Any good distruted hashes for 
python?

I think memory is one of the first things that kill apache 
performance(when using preforking).  Especially when it has massive php 
compiled in!  You can get big speed boosts by using different apache 
configs for different request types(even on the same machine).  Eg set 
one up for static files(eg images), and one for your bloated php.

>
> If you're writing a real-time financial data system, you do want to 
> use a database, but you want to very carefully control your access to 
> it. Certainly, you don't want to equate 'web hit' with 'database 
> query', as the LAMP model is wont to do.
>
> Or maybe you're writing an application that has to operate as a 
> client-side proxy, and you don't have the leisure of a DBA at every 
> desk, so you can't require that an RDBMS gets set up with each 
> installation.  This might require some hackish workarounds with the 
> filesystem that you'd rather not do, but nevertheless, it's better 
> than having the user editing pg_hba.conf themselves.
>
SQLlite and berkley db are good for easy to bundle dbs.

One good thing about LAMP though is that lots of servers have it 
installed, and it can be quite cheap to use as a platform.

As you say, not everything is a blog.  There are too many different 
factors for a one size fits all 'this way is best' solution.  Besides 
everyone knows twisted rules ;)


Have fun!




From ecn at metaslash.com  Wed Oct 29 11:42:52 2003
From: ecn at metaslash.com (ecn at metaslash.com)
Date: Wed, 29 Oct 2003 11:42:52 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
Message-ID: <200310291642.h9TGgqkY005791@localhost.localdomain>

 > Can you qualify "long time"?  And what's the bottleneck?  At the scale 
 > of 100K or so function calls, Python isn't egregiously slow, certainly 
 > not slow enough to not be able to outrun TCP connection setup...?

Hmm, maybe a minute?  I forget exactly.  It was like 4x slower than C++.
(I'm running Linux 2.6test1 with dual AMD Athlon MP/2000's).

I posted a bug in the poll reactor some time ago.  I was testing
an epoll() subclass I had written at the time.

To test the server, I had written a C++ program to connect, 
asynchronously, over the loopback device.  I had to insert a 
pause in the connector to avoid connection failures.  Mind you,
I had to create several "fake" networks in order to have enough
ports for all those simultaneous connections.  This was an absurd
number of connections (10K, 20K, 40K, etc).

The default TCP connection timeout on Linux is ... what? like 61 
seconds or something? That was the number I was hitting.

Everything ran well, up to about 8-10K.  Then it would fall behind,
and then I was at the mercy of TCP retries.

This customer was particularly performance oriented, so I didn't think
that python was going to fly with them, anyhow.  But it is so much
simpler to code/debug/test, I wanted to see how well it would perform.

I tweaked the acceptor to just accept all the connections it could, 
and that was too slow.  It didn't even get into the event loop.  

I also tweaked ACE to accept connections faster, too.  It's 
just a tough problem.

-Eric




From scosol at yahoo.com  Wed Oct 29 11:48:54 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Wed, 29 Oct 2003 08:48:54 -0800 (PST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <20031029164854.21001.qmail@web13905.mail.yahoo.com>

--- Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> Nathan Seven wrote:
> 
> > Databases were created *specifically* for this
> > purpose.
> 
> I think that databases were specifically designed to
> store accounting 
> information, actually.

Exactly, handling and tracking dynamic data :)

> If you are writing a multiplayer game which wants to
> support lots of 
> concurrent users, you can't afford to spawn a thread
> and do a database 
> request every time a player picks something up. 
> (Python is quite slow 
> enough already, thanks.)  You can't just use a cache
> because the data 
> changes _all the time_, and you have to care about
> it from everywhere 
> that you care about your data.  Working with your
> objects directly in 
> memory is close to the only option.

I dunno- I guess I just disagree- a multiplayer game
is a perfect example of something that absolutely
requires atomic transactions.  "Buy an item->add item
to inventory->deduct $ from player" etc. That
transaction either needs to totally complete, or not
complete at all.  So now you need to build some sort
of transaction manager on top of your in-memory
objects.  Oh and then you probably want some way to
ensure that these in-memory objects dont get lost in
the case of abnormal shutdown- right?
Well- haven't you just built a couple features of any
(real) database?

> If you're writing a real-time financial data system,
> you do want to use 
> a database, but you want to very carefully control
> your access to it. 
> Certainly, you don't want to equate 'web hit' with
> 'database query', as 
> the LAMP model is wont to do.

Yes hahah- I think my overall point is just that the
seperation is key.

> Or maybe you're writing an application that has to
> operate as a 
> client-side proxy, and you don't have the leisure of
> a DBA at every 
> desk, so you can't require that an RDBMS gets set up
> with each 
> installation.  This might require some hackish
> workarounds with the 
> filesystem that you'd rather not do, but
> nevertheless, it's better than 
> having the user editing pg_hba.conf themselves.

Sure- though that specifically is the reason for
embeddable databases.

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From dp at twistedmatrix.com  Wed Oct 29 12:01:36 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 29 Oct 2003 12:01:36 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029164854.21001.qmail@web13905.mail.yahoo.com>
References: <20031029164854.21001.qmail@web13905.mail.yahoo.com>
Message-ID: <8E696247-0A31-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 29, 2003, at 11:48 AM, Nathan Seven wrote:

> I dunno- I guess I just disagree- a multiplayer game
> is a perfect example of something that absolutely
> requires atomic transactions.

But not SQL -- that's the whole point.

dp




From illumen at yahoo.com  Wed Oct 29 12:33:14 2003
From: illumen at yahoo.com (Rene Dudfield)
Date: Thu, 30 Oct 2003 03:33:14 +1000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <200310291642.h9TGgqkY005791@localhost.localdomain>
References: <200310291642.h9TGgqkY005791@localhost.localdomain>
Message-ID: <3F9FF9DA.3070204@yahoo.com>

ecn at metaslash.com wrote:

> > Can you qualify "long time"?  And what's the bottleneck?  At the scale 
> > of 100K or so function calls, Python isn't egregiously slow, certainly 
> > not slow enough to not be able to outrun TCP connection setup...?
>
>Hmm, maybe a minute?  I forget exactly.  It was like 4x slower than C++.
>(I'm running Linux 2.6test1 with dual AMD Athlon MP/2000's).
>  
>

Probably be quite a bit quicker with psyco.  Psyco is generally quite a 
bit quicker for looping things like this. 

Is there no batch interface for creating connections?  Something where 
you pass it an array of your required connections, then let it fly.  
Batching apis are good for things like this where function call, and 
function setup are so large.





From matthew.s.hegedus at lmco.com  Wed Oct 29 12:44:39 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Wed, 29 Oct 2003 11:44:39 -0600
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use style sheets
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F6@EMSS07M12.us.lmco.com>

If I may I'd like to request that future doc updates include more info on
microdom.lmx.

Is there a special way to have lmx generate xhtml with a specific style
class?

More specifically, if I have...

     <style type="text/css">
         tr.mySpecialTableRowStyleClass {color: white; background-color:
black}
     </style>

...in a xhtml template header, then how would I let a 'tr' lmx node know
that I want my custom style?

I tried t.tr['class'] = "mySpecialTableRowStyleClass" but then I got bitched
at with an "object does not support item assignment". Thanks,

Matthew



From dp at twistedmatrix.com  Wed Oct 29 12:59:45 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 29 Oct 2003 12:59:45 -0500
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use style sheets
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24F6@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F6@EMSS07M12.us.lmco.com>
Message-ID: <AE38EA93-0A39-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 29, 2003, at 12:44 PM, Hegedus, Matthew S wrote:

> I tried t.tr['class'] = "mySpecialTableRowStyleClass" but then I got 
> bitched
> at with an "object does not support item assignment". Thanks,

t.tr(_class="mySpecialTableRowStyleClass")

Since class is a python keyword, the special case of having a leading 
underscore is used.

dp




From bob at redivi.com  Wed Oct 29 13:13:44 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 29 Oct 2003 13:13:44 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FF9DA.3070204@yahoo.com>
References: <200310291642.h9TGgqkY005791@localhost.localdomain> <3F9FF9DA.3070204@yahoo.com>
Message-ID: <A1D3A192-0A3B-11D8-B11C-000A95686CD8@redivi.com>

On Oct 29, 2003, at 12:33 PM, Rene Dudfield wrote:

> ecn at metaslash.com wrote:
>
>> > Can you qualify "long time"?  And what's the bottleneck?  At the 
>> scale > of 100K or so function calls, Python isn't egregiously slow, 
>> certainly > not slow enough to not be able to outrun TCP connection 
>> setup...?
>>
>> Hmm, maybe a minute?  I forget exactly.  It was like 4x slower than 
>> C++.
>> (I'm running Linux 2.6test1 with dual AMD Athlon MP/2000's).
>>
>
> Probably be quite a bit quicker with psyco.  Psyco is generally quite 
> a bit quicker for looping things like this.
> Is there no batch interface for creating connections?  Something where 
> you pass it an array of your required connections, then let it fly.  
> Batching apis are good for things like this where function call, and 
> function setup are so large.

In any case, a benchmark that opens a whole bunch of sockets and does 
nothing with them is pretty retarded.  I'm actually pretty impressed 
that Python was only 4x slower at this kind of task, it has a whole lot 
of overhead (without psyco) for tight loops like that.

-bob




From twisted at goldenspud.com  Wed Oct 29 13:29:20 2003
From: twisted at goldenspud.com (Matthew Scott)
Date: Wed, 29 Oct 2003 12:29:20 -0600
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use style sheets
In-Reply-To: <AE38EA93-0A39-11D8-9397-000A95864FC4@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F6@EMSS07M12.us.lmco.com> <AE38EA93-0A39-11D8-9397-000A95864FC4@twistedmatrix.com>
Message-ID: <200310291229.20334.twisted@goldenspud.com>

On Wednesday 29 October 2003 11:59 am, Donovan Preston wrote:
> On Oct 29, 2003, at 12:44 PM, Hegedus, Matthew S wrote:
> > I tried t.tr['class'] = "mySpecialTableRowStyleClass" but then I got
> > bitched
> > at with an "object does not support item assignment". Thanks,
>
> t.tr(_class="mySpecialTableRowStyleClass")
>
> Since class is a python keyword, the special case of having a leading
> underscore is used.

I ran into this recently too :)

Just an extra note, the leading underscore is not required when setting the 
class attribute of an existing node:

node = t.tr()
node['class'] = 'mySpecialTableRowStyleClass'

-- 
Matthew Scott
http://goldenspud.com/




From phil at bubblehouse.org  Wed Oct 29 16:08:32 2003
From: phil at bubblehouse.org (phil at bubblehouse.org)
Date: Wed, 29 Oct 2003 16:08:32 -0500 (EST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
References: <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
Message-ID: <1615.65.246.170.211.1067461712.squirrel@192.168.0.2>

well, my only use of the db object directly is for actually updating the
table. my particular implementation would have far more views than
updates, so i was going to cache the common data, or possibly pre-render
html...

wouldn't you say that these performance issues are as much of a
consequence of poor design as much as the choice to use SQL? obviously db
calls are expensive...but some of the benefits of a portable datasource
are worthwhile. as nice as it would be to live in a world where pickle was
a common data format, we're not there yet...


> Date: 29 Oct 2003 06:28:17 -0000
> From: Moshe Zadka <m at zadka.site.co.il>
> Subject: Re: [Twisted-Python] twisted.web and MySQLdb
> To: twisted-python at twistedmatrix.com
> Reply-To: twisted-python at twistedmatrix.com
>
> I won't reply to your question here, I'm sure someone more competent
> than me can do so.
> I will take a minute to note that for some reason, the instinct of
> web developers has been to immediately write applications in the
> LAMP model. While twisted.web is a perfectly good substitute for
> A, and can indeed be used this way, it is much more capable.
>
> LAMP -- Linux Apache MySQL PHP [each of those has variants]
>
> Linux (and most other things in the "L" place, such as FreeBSD) has
> an incredibly fast fork() operation. This leads people to write their
> web code with the process-per-page model. Apache optimizes this by
> preforking, making such code actually scalable enough to deliver good
> response times. However, suddenly there is a problem: since different
> processes are likely to deal with the same user, memory becomes fragile.
> It is unsafe to put things in memory: processes switch users, get born
> and die too often. In Linux, and most other Unices, file locking has
> been a thorny issue. So instead of putting data in files, where the
> subtle semantics of locking and concurrency should be dealt with,
> data tends to end up in the database. That means *all* data. Sessions.
> Temporary "show this message when the user finished his redirect loop".
> Etc. etc. Once all the data is in MySQL, which is the easiest database to
> set up, it becomes natural for the average page to be a "glorified
> select".
> PHP was designed for this exact scenario: take a select table and spruce
> it up with HTML.
>
> Unfortunately, what LAMP deals to is exactly to this: inevitably, all
> pages are just spruced up select-tables. This makes programming somewhat
> unnatural unless you're programming a database viewer.
>
> With twisted.web, you don't have these problems. It is easy to keep data
> in files, because locking is not an issue. It is easy to cache data in
> memory
> because everything is served from a single process. If you need to attach
> state to a user's session, you can just keep an object in the session.
> This means programming twisted.web should be a lot more like writing
> a GUI application, and a lot less like writing select-with-HTML.
> You should probably reconsider whether you really want MySQL. It adds
> complexity to your application, and the gain is usually small. Putting
> persistent data in files, and using liberal caching schemes, also plays
> on the core advantage of Linux (and similar) -- it uses the incredibly
> optimized caching algorithms.




From phil at bubblehouse.org  Wed Oct 29 16:08:33 2003
From: phil at bubblehouse.org (phil at bubblehouse.org)
Date: Wed, 29 Oct 2003 16:08:33 -0500 (EST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
References: <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
Message-ID: <1616.65.246.170.211.1067461713.squirrel@192.168.0.2>

well, my only use of the db object directly is for actually updating the
table. my particular implementation would have far more views than
updates, so i was going to cache the common data, or possibly pre-render
html...

wouldn't you say that these performance issues are as much of a
consequence of poor design as much as the choice to use SQL? obviously db
calls are expensive...but some of the benefits of a portable datasource
are worthwhile. as nice as it would be to live in a world where pickle was
a common data format, we're not there yet...


> Date: 29 Oct 2003 06:28:17 -0000
> From: Moshe Zadka <m at zadka.site.co.il>
> Subject: Re: [Twisted-Python] twisted.web and MySQLdb
> To: twisted-python at twistedmatrix.com
> Reply-To: twisted-python at twistedmatrix.com
>
> I won't reply to your question here, I'm sure someone more competent
> than me can do so.
> I will take a minute to note that for some reason, the instinct of
> web developers has been to immediately write applications in the
> LAMP model. While twisted.web is a perfectly good substitute for
> A, and can indeed be used this way, it is much more capable.
>
> LAMP -- Linux Apache MySQL PHP [each of those has variants]
>
> Linux (and most other things in the "L" place, such as FreeBSD) has
> an incredibly fast fork() operation. This leads people to write their
> web code with the process-per-page model. Apache optimizes this by
> preforking, making such code actually scalable enough to deliver good
> response times. However, suddenly there is a problem: since different
> processes are likely to deal with the same user, memory becomes fragile.
> It is unsafe to put things in memory: processes switch users, get born
> and die too often. In Linux, and most other Unices, file locking has
> been a thorny issue. So instead of putting data in files, where the
> subtle semantics of locking and concurrency should be dealt with,
> data tends to end up in the database. That means *all* data. Sessions.
> Temporary "show this message when the user finished his redirect loop".
> Etc. etc. Once all the data is in MySQL, which is the easiest database to
> set up, it becomes natural for the average page to be a "glorified
> select".
> PHP was designed for this exact scenario: take a select table and spruce
> it up with HTML.
>
> Unfortunately, what LAMP deals to is exactly to this: inevitably, all
> pages are just spruced up select-tables. This makes programming somewhat
> unnatural unless you're programming a database viewer.
>
> With twisted.web, you don't have these problems. It is easy to keep data
> in files, because locking is not an issue. It is easy to cache data in
> memory
> because everything is served from a single process. If you need to attach
> state to a user's session, you can just keep an object in the session.
> This means programming twisted.web should be a lot more like writing
> a GUI application, and a lot less like writing select-with-HTML.
> You should probably reconsider whether you really want MySQL. It adds
> complexity to your application, and the gain is usually small. Putting
> persistent data in files, and using liberal caching schemes, also plays
> on the core advantage of Linux (and similar) -- it uses the incredibly
> optimized caching algorithms.




From matthew.s.hegedus at lmco.com  Wed Oct 29 18:37:05 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Wed, 29 Oct 2003 17:37:05 -0600
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use	style sheets
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F8@EMSS07M12.us.lmco.com>

Setting color through microdom.lmx just doesn't seem to be working for me. I
can view the source of the web page xhtml generated (browser right-click,
view source), and everything looks good, but I just don't see the browser
actually rendering page features in the color I specified. All of the lmx
generated xhtml is literally rendered black and white. I am using style
sheets. Do I need to do some sort of rerender trick?

<UPDATE before I send this out: It appears NONE of the style sheet stuff has
any effect on the look of the web page when implemented using microdom.lmx.>

To clarify, I receive no errors and from the looks of things the xhtml code
generated by lmx seems legit. Here is the key snippets of code(hopefully
formatting will remain intact):

XHTML template:

<html>
   <head>
      <style type="text/css">
         table.exerciseTableClass {border: 0; cellspacing: 2;}
         table.exerciseTableClass tr.tableHeadingClass {color: white;
background-color: darkslateblue;}
      </style>
   </head>
   <body>
      <h1 ~some stuff~></h1>
      <table model="amodel"
             view="aview">
      </table>
   </body>
</html>
   
Python code:

...
   def wvupdate_aview(sel, request, node, data):
       lmxnode = lmx(node)
       d = lmxnode.div()

       #These next two lines don't seem to do anything in terms of style.
       #It's as if I just made a plain-old table, and a couple of plain-old
rows
       t = d.table(_class='exerciseTableClass')    
       t.tr(_class='tableHeadingClass')

       t.td().text(data.label1)
       t.td().text(data.label2)
       ...

Have any of you run into similar troubles, and if so what did it take to fix
the problem? Thank you,

Matthew

-----Original Message-----
From: Matthew Scott [mailto:twisted at goldenspud.com] 
Sent: Wednesday, October 29, 2003 12:29 PM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] Woven, using microdom.lmx, and trying to use
style sheets


On Wednesday 29 October 2003 11:59 am, Donovan Preston wrote:
> On Oct 29, 2003, at 12:44 PM, Hegedus, Matthew S wrote:
> > I tried t.tr['class'] = "mySpecialTableRowStyleClass" but then I got 
> > bitched at with an "object does not support item assignment". 
> > Thanks,
>
> t.tr(_class="mySpecialTableRowStyleClass")
>
> Since class is a python keyword, the special case of having a leading 
> underscore is used.

I ran into this recently too :)

Just an extra note, the leading underscore is not required when setting the 
class attribute of an existing node:

node = t.tr()
node['class'] = 'mySpecialTableRowStyleClass'

-- 
Matthew Scott
http://goldenspud.com/


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From andrew-twisted at puzzling.org  Wed Oct 29 19:11:32 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 30 Oct 2003 11:11:32 +1100
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <200310291642.h9TGgqkY005791@localhost.localdomain>
References: <200310291642.h9TGgqkY005791@localhost.localdomain>
Message-ID: <20031030001132.GA5731@frobozz>

On Wed, Oct 29, 2003 at 11:42:52AM -0500, ecn at metaslash.com wrote:
> 
> I posted a bug in the poll reactor some time ago.  I was testing
> an epoll() subclass I had written at the time.

Did it get fixed?  If not, please add it to http://twistedmatrix.com/bugs so
that it isn't forgotten in the archives of the list somewhere...

-Andrew.




From ecn at metaslash.com  Wed Oct 29 19:46:24 2003
From: ecn at metaslash.com (Eric C. Newton)
Date: Wed, 29 Oct 2003 19:46:24 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031030001132.GA5731@frobozz>
References: <200310291642.h9TGgqkY005791@localhost.localdomain> <20031030001132.GA5731@frobozz>
Message-ID: <20031030004624.GA7101@localhost.localdomain>

On Thu, Oct 30, 2003 at 11:11:32AM +1100, Andrew Bennetts wrote:
> On Wed, Oct 29, 2003 at 11:42:52AM -0500, ecn at metaslash.com wrote:
> > 
> > I posted a bug in the poll reactor some time ago.  I was testing
> > an epoll() subclass I had written at the time.
> 
> Did it get fixed?  If not, please add it to http://twistedmatrix.com/bugs so
> that it isn't forgotten in the archives of the list somewhere...

Yes, it has been fixed.  Thanks.

-Eric



From dp at twistedmatrix.com  Wed Oct 29 22:11:05 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 29 Oct 2003 22:11:05 -0500
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use	style sheets
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24F8@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F8@EMSS07M12.us.lmco.com>
Message-ID: <B329BF1D-0A86-11D8-87A1-000A95864FC4@twistedmatrix.com>

On Oct 29, 2003, at 6:37 PM, Hegedus, Matthew S wrote:

>        t = d.table(_class='exerciseTableClass')
>        t.tr(_class='tableHeadingClass')
>
>        t.td().text(data.label1)
>        t.td().text(data.label2)

Your table is borken. It will render like this

<table class="excerciseTableClass">
	<tr class="tableHeadingClass" />
	<td>whatever label 1 was</td>
	<td>whatever label 2 was</td>
</table>

Notice you're not actually putting the td nodes inside the row. You 
want your code to save the return value from the call to tr (the tr 
node) and put the tds inside that:

t = d.table(_class="exerciseTableClass")
tr = t.tr(_class="tableHeadingClass")

tr.td().text(data.label1)
tr.td().text(data.label2)

dp




From stuart.hungerford at anu.edu.au  Wed Oct 29 23:52:32 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Thu, 30 Oct 2003 15:52:32 +1100
Subject: [Twisted-Python] request getUser()/getPassword() in Woven and resources...
Message-ID: <6.0.0.22.0.20031030154614.01e1f788@anusf.anu.edu.au>

Hi all,

I've had a twisted web application running for a while that
uses request.getUser() and request.getPassword() in a
resource subclass render() method to make the web browser
prompt for a username/password.

I've been refactoring this application to use Woven page
subclasses and the same request.getFoo() calls now
return empty strings rather than None, and no prompting
from the browser is done.

Is there some gotcha in using request.getUser() and
request.getPassword() from Woven page subclasses?


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From twisted at zadka.site.co.il  Thu Oct 30 01:45:19 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 30 Oct 2003 06:45:19 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FEC48.7020403@yahoo.com>
References: <3F9FEC48.7020403@yahoo.com>, <20031029073437.52308.qmail@web13908.mail.yahoo.com> <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <20031030064519.22248.qmail@green.zadka.com>

On Thu, 30 Oct 2003, Rene Dudfield <illumen at yahoo.com> wrote:

> Threads and processes also can easily use multiple cpus. 

This is a common objection, so I thought I will point out the fallacy
here: common multiple CPU are on the order of 4, maybe 8, CPUs. Rarely
do we get to 64-land, and only for extremely high-end servers. Common
web servers are expected to deal with 100s of requests concurrently,
and that's the *low-end* stuff. High-end means tens of thousands of
requests concurrently. This means (number of requests)>>(number of CPUs).
Since you want, for high-performance, for threads (or processes) to
get tied to a CPU, the optimal number of runnable processes is
#CPUS-1 (this is so the "odd task" will get the free CPU instead
of displacing one of the long-running tasks). So, if you really want
to use your SMP hardware, the best thing is to set up several servers,
one per CPU (minus 1). Twisted can do it, the worst case you'll need
to hack up a ten-minute custom IListener and use listenWith, if you
don't have more efficient round-robin schemes. If those really need
to talk to each other, they can use mmap with the right flags to
communicate. There is almost never a reason to use threads here.
(The optimal thing would be to divide along URL boundaries, if you
have a smart enough reverse-proxy, so that the different servers have
as little need to communicate as possible).



From twisted at zadka.site.co.il  Thu Oct 30 01:45:19 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 30 Oct 2003 06:45:19 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FEC48.7020403@yahoo.com>
References: <3F9FEC48.7020403@yahoo.com>, <20031029073437.52308.qmail@web13908.mail.yahoo.com> <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <20031030064519.22248.qmail@green.zadka.com>

On Thu, 30 Oct 2003, Rene Dudfield <illumen at yahoo.com> wrote:

> Threads and processes also can easily use multiple cpus. 

This is a common objection, so I thought I will point out the fallacy
here: common multiple CPU are on the order of 4, maybe 8, CPUs. Rarely
do we get to 64-land, and only for extremely high-end servers. Common
web servers are expected to deal with 100s of requests concurrently,
and that's the *low-end* stuff. High-end means tens of thousands of
requests concurrently. This means (number of requests)>>(number of CPUs).
Since you want, for high-performance, for threads (or processes) to
get tied to a CPU, the optimal number of runnable processes is
#CPUS-1 (this is so the "odd task" will get the free CPU instead
of displacing one of the long-running tasks). So, if you really want
to use your SMP hardware, the best thing is to set up several servers,
one per CPU (minus 1). Twisted can do it, the worst case you'll need
to hack up a ten-minute custom IListener and use listenWith, if you
don't have more efficient round-robin schemes. If those really need
to talk to each other, they can use mmap with the right flags to
communicate. There is almost never a reason to use threads here.
(The optimal thing would be to divide along URL boundaries, if you
have a smart enough reverse-proxy, so that the different servers have
as little need to communicate as possible).



From twisted at zadka.site.co.il  Thu Oct 30 02:00:00 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 30 Oct 2003 07:00:00 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <1616.65.246.170.211.1067461713.squirrel@192.168.0.2>
References: <1616.65.246.170.211.1067461713.squirrel@192.168.0.2>, <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
Message-ID: <20031030070000.22447.qmail@green.zadka.com>

On Wed, 29 Oct 2003, phil at bubblehouse.org wrote:

> well, my only use of the db object directly is for actually updating the
> table. my particular implementation would have far more views than
> updates, so i was going to cache the common data, or possibly pre-render
> html...

At the point where you're caching stuff yourself, it should be obvious
that you're writing a database...so why not admit it to yourself
and just finish writing it? :)
Just cache everything in-memory, and write to files in a fail-safe way
(UNIX, luckily, has enough useful primitives for that like writing
to a tempfile, then renaming when you're done). This will let you
use the operating system's mechanisms for LRU, which is probably
more or less the right thing to do in a web application (LRU anticipates
stuff like slashdotting, for example :)
Twisted even has stuff to do such filesystem-transactions for you:
twisted.persisted.dirdbm and twisted.python.filepath.FilePath.setContent

> as nice as it would be to live in a world where pickle was
> a common data format, we're not there yet...

Pickle is just as much a common file format as MySQL's internal
format. That is to say, there's just one way to access it, but
you can program object viewers easily. In any case, there's no
need to write pickles to the files. You can, for example, have
each row be a list of netstrings in a file -- Twisted also has
code to decode and encode netstrings.



From max at ucmg.com.ua  Thu Oct 30 03:26:28 2003
From: max at ucmg.com.ua (Max Ischenko)
Date: Thu, 30 Oct 2003 10:26:28 +0200
Subject: [Twisted-Python] migration from IIS to Twisted
Message-ID: <3FA0CB34.20902@ucmg.com.ua>

Hi,

I have a really big ASP/IIS-based system which I'm trying to (partially) 
rewrite and evolve with python.

I've already wrote some useful code in using Cheetah/WebKit and now I'm 
thinking about the best way to integrate it back into the legacy system.

As my python code depends on WebKit very little and Cheetah is a 
standalone processor that could probably be plugged into Twisted easily 
I'm evaluating the possibility to switch to Twisted.

There is nothing wrong with Webware/WebKit -- it is a great platform, 
but I'd like to make use of some Twisted components, like 
twisted.enterprise.row or twisted.cred.

If I'm to switch to Twisted what could you suggest for IIS-Twisted 
integration?

I'm currently thinking about simple Response.Redirect('...') from .asp 
to twisted.web. But I'd also like to share data and session's state 
between the two. For example, to match  twisted.web.server.Session with 
  IIS session. Dunno how this could be done though.

More promising (may be) but surely more complex way would be to write 
some kind of IIS-Twisted adapter that uses COM to talk to VB and 
twisted.spread to talk to Twisted.




From tv at tv.debian.net  Wed Oct 29 11:58:38 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Wed, 29 Oct 2003 18:58:38 +0200
Subject: [Twisted-Python] Integrating simpleguard with existing Woven
 pages...
In-Reply-To: <6.0.0.22.0.20031028125753.01e1ff08@anusf.anu.edu.au>
References: <6.0.0.22.0.20031028125753.01e1ff08@anusf.anu.edu.au>
Message-ID: <3F9FF1BE.2080009@tv.debian.net>

Stuart Hungerford wrote:
> I need to add a simple username/password authentication to
> some, but not all of these pages.  With the correct username
> and password you can view the page, without them you can't view
> it.

Sounds like sandbox/tv/simplyguarded/ from CVS.




From v6kk1hg02 at sneakemail.com  Wed Oct 29 17:26:42 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 29 Oct 2003 22:26:42 -0000
Subject: [Twisted-Python] Dual Reactor Script
Message-ID: <14662-78995@sneakemail.com>


This question pertains to the use of dual reactors in a
single Python script.  The script runs on Windows 2000 and
has the nature of a daemon which translates between two
protocols on either side of it.

Side A = Telnet protocol ("raw" type)
    over TCP transport to embedded device
    ASCII data
Side B = Custom binary protocol (bits, bytes)
    over UDP transport
    binary data

Now the Twisted Matrix samples I've examined all do this
in their main entry:

   reactor.listenTransport(port, protocolFactory)
   reactor.run()

However I have TWO transports and TWO protocols.  So the
question is how to properly configure the reactor(s) in my
script.  Any advice, in particular?  How should such a
daemon be structured properly in TM?  Threads?  Two
scripts?  Please advise.  I'm sure there's a simple way
but always like to cover my bases with the gurus.  Probably
I need only one reactor, configured in a particular way to
handle two protocols and transports.

Thanks!
Mark



From dddgomes at yahoo.com.br  Wed Oct 29 20:02:08 2003
From: dddgomes at yahoo.com.br (=?iso-8859-1?q?Daniel=20Gomes?=)
Date: Wed, 29 Oct 2003 22:02:08 -0300 (ART)
Subject: [Twisted-Python] HTTP Server - UDP
Message-ID: <20031030010208.78264.qmail@web21310.mail.yahoo.com>

Thomas Weholt,

Hello! My name is Daniel Gomes and I am a Computer
engineering studend in Brazil.  I am researching about
a UDP HTTP Server and and I read that you have done
one.
I was wondering if you could tell me where to find
some information about this or even let me see you
server (if you dont mind).

Best Regards,

Daniel Gomes
dddgomes at yahoo.com.br

Recife - PE - Brasil

Yahoo! Mail - o melhor webmail do Brasil
http://mail.yahoo.com.br



From radix at twistedmatrix.com  Thu Oct 30 07:27:23 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 30 Oct 2003 07:27:23 -0500
Subject: [Twisted-Python] Dual Reactor Script
In-Reply-To: <14662-78995@sneakemail.com>
References: <14662-78995@sneakemail.com>
Message-ID: <20031030122723.GA15670@twistedmatrix.com>

On Wed, Oct 29, 2003 at 10:26:42PM -0000, Mark Evans wrote:
> Now the Twisted Matrix samples I've examined all do this
> in their main entry:
> 
>    reactor.listenTransport(port, protocolFactory)
>    reactor.run()
> 
> However I have TWO transports and TWO protocols.  So the

Just call reactor.listenFoo twice. No threads, or any garbage like
that. The reactor can handle an arbitrary[1] number of listeners and
connections.

[1]: Some reactors, like win32eventreactor (which *isn't* used by
default, on Windows: SelectReactor is), have arbitrary limits. I think
you can only have 64 connections in that one, or something like that.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From syver at inout.no  Thu Oct 30 15:20:11 2003
From: syver at inout.no (Syver Enstad)
Date: 30 Oct 2003 21:20:11 +0100
Subject: [Twisted-Python] Woven and deferreds in controllers.
Message-ID: <uad7iwk90.fsf@inout.no>

I've heard on this list that it is possible to use deferreds in
controllers. Let's say I have a page class that needs to load a
deferred object before any of it's wmfactory_ methods make any
sense. What I have done previously is to store the deferred and chain
new deferreds on every wmfactory method and return them instead of a
real value. If deferred in controlers work the way I hope I could load
the actual domain object from the deferred and store it in my page
class before any of the wmfactory methods are called which would be
nice.

So my question is how do I use a controller for this (if it is
possible). Btw. I've yet to upgrade to 1.1 because the application is
still using the old cred system.







From radix at twistedmatrix.com  Thu Oct 30 15:43:40 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 30 Oct 2003 15:43:40 -0500
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <uad7iwk90.fsf@inout.no>
References: <uad7iwk90.fsf@inout.no>
Message-ID: <20031030204340.GD15670@twistedmatrix.com>

On Thu, Oct 30, 2003 at 09:20:11PM +0100, Syver Enstad wrote:
> Btw. I've yet to upgrade to 1.1 because the application is
> still using the old cred system.

Old cred isn't gone! It's just deprecated. Please upgrade, you
shouldn't have problems with backwards compatibility. If you do,
please tell us :)

Sorry for not answering your actual question, I can't.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From keson at post.pl  Thu Oct 30 16:58:08 2003
From: keson at post.pl (marcin andrzejewski)
Date: Thu, 30 Oct 2003 22:58:08 +0100
Subject: [Twisted-Python] win32 twisted 1.1.0 import error
Message-ID: <1849086578.20031030225808@post.pl>

hi,
i am quite new to twisted and have one lame question.
why importing modules from directory of .rpy file doesn't work in
twisted 1.1.0 for win32? it works perfectly fine in 1.0.7..

--?
regards,
marcin andrzejewski?????
mailto:keson at post.pl




From matthew.s.hegedus at lmco.com  Thu Oct 30 19:48:07 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Thu, 30 Oct 2003 18:48:07 -0600
Subject: [Twisted-Python] Woven, using microdom.lmx, and HTTP requests
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24FA@EMSS07M12.us.lmco.com>

Well it's almost the weekend and this is my work email, so I must kick off a
few questions before I leave. Let me start off by thanking you all again for
being so helpful. I recognize you are busy people, so for taking time to
help me and others, I salute you ;).

Up to this point I've coded up a Twisted test program that has a global list
of lists:

  ex: [['a','b','c'],['d','e','f'],['g','h','i'], ...]

I generate dynamic xhtml, creating a form(method='get') containing a table
for my list data. Each sublist is a row of this table, and at the end of
each row (also a part of the table) is a 'REMOVE' button.

  Microdom.lmx code for 'REMOVE' button: 
      tr.td().input(type='submit', \
                    name=str(buttonID), \
                    value="REMOVE", \
                    view='rmExercise', \
                    model='listData')

... The corresponding view code for the buttons:

      def wvupdate_rmExercise(self, request, node, listData):
          print request.args
          print request.args.keys()
          if ~pseudocode~ request.args.keys()[0] is valid ~psuedocode~:
              del listData[int(request.args.keys()[0])]
              request.args.clear()

The page with the table gets served up and looks ok, but strange things
happen (unexpected HTTP events) when I hit the browser's reload button. I
can get into situations where hitting reload will generate three input
submit events as if I clicked my remove button three times. This events lead
to the deletion of a few sublists. What in the world could be going on?

Another question: When the input buttons view is called, list data is
modified, but the page does not get re-rendered. Is adding the line...

      self.render(request)

...the correct way to handle this issue?

And another question: I am browsing the pages on the same machine that I'm
serving them from. It seems that sometimes reloading the page in the browser
takes a while (more than 10 seconds in some cases). Is there some reason for
this?

Thanks again,
Matthew



From andrew-twisted at puzzling.org  Thu Oct 30 20:16:58 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 31 Oct 2003 12:16:58 +1100
Subject: [Twisted-Python] Dual Reactor Script
In-Reply-To: <20031030122723.GA15670@twistedmatrix.com>
References: <14662-78995@sneakemail.com> <20031030122723.GA15670@twistedmatrix.com>
Message-ID: <20031031011658.GA9027@frobozz>

On Thu, Oct 30, 2003 at 07:27:23AM -0500, Christopher Armstrong wrote:
> 
> [1]: Some reactors, like win32eventreactor (which *isn't* used by
> default, on Windows: SelectReactor is), have arbitrary limits. I think
> you can only have 64 connections in that one, or something like that.

But on Windows, select is limited to 64 sockets as well (I suspect it simply
calls WaitForMultipleObjects under the hood...).  You need to use threads or
IO Completion Ports to overcome this limit.

-Andrew.




From foom at fuhm.net  Thu Oct 30 20:41:57 2003
From: foom at fuhm.net (James Y Knight)
Date: Thu, 30 Oct 2003 20:41:57 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] THE EXTENSION IS .C!  IT IS NOT A C++ FILE!
In-Reply-To: <E1AFM4c-0007Hw-00@wolfwood>
References: <E1AFM4c-0007Hw-00@wolfwood>
Message-ID: <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>

What compiler doesn't support C99 comments yet?

James

On Oct 30, 2003, at 6:19 PM, exarkun CVS wrote:

> Modified files:
> Twisted/twisted/protocols/_c_urlarg.c 1.7 1.8
>
> Log message:
> THE EXTENSION IS .C!  IT IS NOT A C++ FILE!




From itamar at itamarst.org  Thu Oct 30 20:43:42 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 30 Oct 2003 20:43:42 -0500
Subject: [Twisted-Python] Dual Reactor Script
In-Reply-To: <20031031011658.GA9027@frobozz>
References: <14662-78995@sneakemail.com>
	<20031030122723.GA15670@twistedmatrix.com>
	<20031031011658.GA9027@frobozz>
Message-ID: <20031030204342.0177517c.itamar@itamarst.org>

On Fri, 31 Oct 2003 12:16:58 +1100
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

> But on Windows, select is limited to 64 sockets as well (I suspect it
> simply

By *default*, but Python changes this to 512, so it's not an issue. WFMO
can't be changed though.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Thu Oct 30 20:55:43 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 31 Oct 2003 12:55:43 +1100
Subject: [Twisted-Python] Dual Reactor Script
In-Reply-To: <20031030204342.0177517c.itamar@itamarst.org>
References: <14662-78995@sneakemail.com> <20031030122723.GA15670@twistedmatrix.com> <20031031011658.GA9027@frobozz> <20031030204342.0177517c.itamar@itamarst.org>
Message-ID: <20031031015543.GB9027@frobozz>

On Thu, Oct 30, 2003 at 08:43:42PM -0500, Itamar Shtull-Trauring wrote:
> On Fri, 31 Oct 2003 12:16:58 +1100
> Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> 
> > But on Windows, select is limited to 64 sockets as well (I suspect it
> > simply
> 
> By *default*, but Python changes this to 512, so it's not an issue. WFMO
> can't be changed though.

Oh, I didn't know that.  That's handy :)

-Andrew.




From kunger at intersight.com  Fri Oct 31 00:21:02 2003
From: kunger at intersight.com (Kevin Unger)
Date: Thu, 30 Oct 2003 21:21:02 -0800
Subject: [Twisted-Python] A little newbie help, please?
In-Reply-To: <20031028095744.GA1069@frobozz>
Message-ID: <05232295-0B62-11D8-B5F5-003065B25CAA@intersight.com>

I'm getting this error message in my woven app:

	Node had a mode=imageSizeList attribute, but hte submodel was not
	found in [<twisted.web.woven.model.StringModel instance at 0x730030:
	wrapped data: /Users/kunger/........blah>]

My template looks like this:

         <span model="imageSizeList" view="List">
             <tr bgcolor="#FFFFF" align="center" pattern="listItem">
                 <td model="0" view="Text"></td>
                 <td model="1" view="Text"></td>
                 <td model="3" view="Text"></td>
             </tr>
         </span>

My Page subclass that renders this template has a model factory:

     def wmfactory_imageSizeList(self, request):

This never gets executed, but the page is being instanced and obviously 
the template is being traversed.

This page has a parent page that follows the same pattern -- similar 
kind of list in the template and model factory, and that page works 
fine.  That page retuns this page like so:

     def wchild_image_sizes(self, request):
         return ImageSizeConfigurator(self.root)

Why isn't my model factory being called?

Thank muchly in advance,

-k




From kunger at intersight.com  Fri Oct 31 00:33:13 2003
From: kunger at intersight.com (Kevin Unger)
Date: Thu, 30 Oct 2003 21:33:13 -0800
Subject: Nevermind-->Re: [Twisted-Python] A little newbie help, please?
In-Reply-To: <05232295-0B62-11D8-B5F5-003065B25CAA@intersight.com>
Message-ID: <B8723F1B-0B63-11D8-954F-003065B25CAA@intersight.com>

I figured it out -- I constructed my page using a non-keyword arg which 
was interpreted by woven as the model, I guess.  Used a keyword ag and 
it be wokring.

-k


On Thursday, October 30, 2003, at 09:21 PM, Kevin Unger wrote:

> I'm getting this error message in my woven app:
>
> 	Node had a mode=imageSizeList attribute, but hte submodel was not
> 	found in [<twisted.web.woven.model.StringModel instance at 0x730030:
> 	wrapped data: /Users/kunger/........blah>]
>
> My template looks like this:
>
>         <span model="imageSizeList" view="List">
>             <tr bgcolor="#FFFFF" align="center" pattern="listItem">
>                 <td model="0" view="Text"></td>
>                 <td model="1" view="Text"></td>
>                 <td model="3" view="Text"></td>
>             </tr>
>         </span>
>
> My Page subclass that renders this template has a model factory:
>
>     def wmfactory_imageSizeList(self, request):
>
> This never gets executed, but the page is being instanced and 
> obviously the template is being traversed.
>
> This page has a parent page that follows the same pattern -- similar 
> kind of list in the template and model factory, and that page works 
> fine.  That page retuns this page like so:
>
>     def wchild_image_sizes(self, request):
>         return ImageSizeConfigurator(self.root)
>
> Why isn't my model factory being called?
>
> Thank muchly in advance,
>
> -k
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>




From syver at inout.no  Fri Oct 31 04:17:06 2003
From: syver at inout.no (Syver Enstad)
Date: 31 Oct 2003 10:17:06 +0100
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <20031030204340.GD15670@twistedmatrix.com>
References: <uad7iwk90.fsf@inout.no>
	<20031030204340.GD15670@twistedmatrix.com>
Message-ID: <uvfq5vka5.fsf@inout.no>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> On Thu, Oct 30, 2003 at 09:20:11PM +0100, Syver Enstad wrote:
> > Btw. I've yet to upgrade to 1.1 because the application is
> > still using the old cred system.
> 
> Old cred isn't gone! It's just deprecated. Please upgrade, you
> shouldn't have problems with backwards compatibility. If you do,
> please tell us :)

Ok, that is cool. Do I have to use Python 2.3 to use the latest Twisted?

 




From syver at inout.no  Fri Oct 31 04:19:34 2003
From: syver at inout.no (Syver Enstad)
Date: 31 Oct 2003 10:19:34 +0100
Subject: Nevermind-->Re: [Twisted-Python] A little newbie help, please?
In-Reply-To: <B8723F1B-0B63-11D8-954F-003065B25CAA@intersight.com>
References: <B8723F1B-0B63-11D8-954F-003065B25CAA@intersight.com>
Message-ID: <ur80tvk61.fsf@inout.no>

Kevin Unger <kunger at intersight.com> writes:

> I figured it out -- I constructed my page using a non-keyword arg
> which was interpreted by woven as the model, I guess.  Used a keyword
> ag and it be wokring.

That's correct the first non keyword arg to Page __init__ is
interpreted as the model, it it is not present the Page is it's own
model.

 




From syver at inout.no  Fri Oct 31 05:47:27 2003
From: syver at inout.no (Syver Enstad)
Date: 31 Oct 2003 11:47:27 +0100
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <uvfq5vka5.fsf@inout.no>
References: <uad7iwk90.fsf@inout.no>
	<20031030204340.GD15670@twistedmatrix.com> <uvfq5vka5.fsf@inout.no>
Message-ID: <u3cd9vg3k.fsf@inout.no>

Syver Enstad <syver at inout.no> writes:

> Christopher Armstrong <radix at twistedmatrix.com> writes:
> 
> > On Thu, Oct 30, 2003 at 09:20:11PM +0100, Syver Enstad wrote:
> > > Btw. I've yet to upgrade to 1.1 because the application is
> > > still using the old cred system.
> > 
> > Old cred isn't gone! It's just deprecated. Please upgrade, you
> > shouldn't have problems with backwards compatibility. If you do,
> > please tell us :)
> 
> Ok, that is cool. Do I have to use Python 2.3 to use the latest Twisted?

By the way I found that the handling of deferreds from
Controller.handle in View was totally broken in Twisted 1.0.6. Does
anybody know if this is fixed in 1.1? 

 




From andrew-twisted at puzzling.org  Fri Oct 31 06:46:54 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 31 Oct 2003 22:46:54 +1100
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <uvfq5vka5.fsf@inout.no>
References: <uad7iwk90.fsf@inout.no> <20031030204340.GD15670@twistedmatrix.com> <uvfq5vka5.fsf@inout.no>
Message-ID: <20031031114653.GB1069@frobozz>

On Fri, Oct 31, 2003 at 10:17:06AM +0100, Syver Enstad wrote:
> Christopher Armstrong <radix at twistedmatrix.com> writes:
> 
> > On Thu, Oct 30, 2003 at 09:20:11PM +0100, Syver Enstad wrote:
> > > Btw. I've yet to upgrade to 1.1 because the application is
> > > still using the old cred system.
> > 
> > Old cred isn't gone! It's just deprecated. Please upgrade, you
> > shouldn't have problems with backwards compatibility. If you do,
> > please tell us :)
> 
> Ok, that is cool. Do I have to use Python 2.3 to use the latest Twisted?

The README has the answer:
    "Twisted works with all Python 2.2 and 2.3 versions."

(Although I can't see anywhere on the website that says this)

-Andrew.




From justinjohnson at fastmail.fm  Fri Oct 31 09:31:30 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 31 Oct 2003 08:31:30 -0600
Subject: [Twisted-Python] More about twistd and win32 service
Message-ID: <20031031143130.84DE2D35C@server1.messagingengine.com>

Itamar and others,

Sorry for the delayed reply and thank you for your constant help.  I
setup my NT service as you described, importing the win32eventreactor and
installing it.  The service starts up fine, but when I stop the service I
get the following in the logs.  The "15:08 ... Unexpected..." entry only
gets dumped in the log when stopping the service.

I'm not sure how I'd go about debugging this more since I can't get
anymore output than what's dumped to the log.  Any ideas?  I've attached
winsvc.py and a couple other files it is dependent on.

Thanks again.
-Justin


2003/10/30 15:07 Eastern Standard Time [-] Log opened.
2003/10/30 15:07 Eastern Standard Time [-]
twisted.spread.pb.PBServerFactory starting on 8787
2003/10/30 15:07 Eastern Standard Time [-] Starting factory
<twisted.spread.pb.PBServerFactory instance at 0x00DF8D28>
2003/10/30 15:08 Eastern Standard Time [-] Unexpected error in main loop.
2003/10/30 15:08 Eastern Standard Time [-] Traceback (most recent call
last):
	  File "E:\Python22\Lib\site-packages\win32\lib\win32serviceutil.py", line 635, in SvcRun
	    self.SvcDoRun()
	  File "E:\ccase\python\winsvc.py", line 24, in SvcDoRun
	    reactor.run()
	  File "E:\Python22\Lib\site-packages\twisted\internet\default.py", line 122, in run
	    self.mainLoop()
	--- <exception caught here> ---
	  File "E:\Python22\Lib\site-packages\twisted\internet\default.py", line 133, in mainLoop
	    self.doIteration(t)
	  File "E:\Python22\Lib\site-packages\twisted\internet\win32eventreactor.py", line 180, in doWaitForMultipleEvents
	    fd, action = events[handles[val - WAIT_OBJECT_0]]
	exceptions.KeyError: <PyHANDLE:224>


----- Original message -----
From: "Itamar Shtull-Trauring" <itamar at itamarst.org>
To: twisted-python at twistedmatrix.com
Date: Wed, 22 Oct 2003 14:50:10 -0400
Subject: Re: [Twisted-Python] twistd and win32 service

On Wed, 22 Oct 2003 12:24:42 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> The general consensus on the mailing list archives seems to be that
> I'd need to setup my code to not require twistd but just run
> standalone. 

Uh. *Maybe* that's the consensus, but it's not actually correct. You can
have a tap or tac run as a NT service.

Lets say you have  a script "server.py" that is runnable with "twistd
-y", you can do (and similar code will work for TAPs):

import sys, os
import win32serviceutil, win32service


class MyService(win32serviceutil.ServiceFramework):
    """NT Service."""
    
    _svc_name_ = "MyService"
    _svc_display_name_ = "MyService server"

    def SvcDoRun(self):
        import server
        f = open(os.path.join(server.rootPath, "cyberhigh.log"), 'a')
        from twisted.python.log import startLogging
        from twisted.application.app import startApplication
        from twisted.internet import reactor        
        startLogging(f)
        startApplication(server.application, 0)
        reactor.run()
    
    def SvcStop(self):
        self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
        from twisted.internet import reactor
        reactor.stop()


if __name__ == '__main__':
    win32serviceutil.HandleCommandLine(MyService)


-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: winsvc.py
Type: application/unknown
Size: 991 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031031/80f81b48/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tap.py
Type: application/unknown
Size: 3240 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031031/80f81b48/attachment-0001.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: server.py
Type: application/unknown
Size: 351 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031031/80f81b48/attachment-0002.bin 

From vlupien at drummonddesigns.com  Fri Oct 31 09:52:25 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Fri, 31 Oct 2003 09:52:25 -0500
Subject: [Twisted-Python] change submodel in a form
Message-ID: <000001c39fbe$997944d0$687ba8c0@vicky>

I have a web base application.  I want to change the data in the model
so that it will be update in the form when a post my form.
 
Here's my code:
 
from twisted.web.server import Site
from twisted.internet import reactor
from twisted.web.woven.page import Page
from twisted.web.woven.form import FormProcessor
from twisted.python import formmethod as fm
from twisted.web.woven import input, controller
from twisted.web import domhelpers
 
class FormPage(Page):
 
    template = '''<html>
    <head><title>a form page</title>
    </head>
    <body bgcolor="c0c0c0">
    <!--<div model="args" view="Text"/>-->
    <br/><br/>
    <form action="post" method="post" enctype="multipart/form-data">
    <table border="0">
    <tr>
    <td align="right" valign="top">Argument #1:</td>
    <td valign="top"><input type="text" name="arg1" value="" size="60"
controller="int" />
    <div class="formDescription">Hooray it is an argument.
    </div></td>
    </tr>
    <tr>
    <td align="right" valign="top">Integer Field.: *</td>
    <td valign="top"><input type="text" name="arg2" value=""/>
    <div class="formDescription">
    </div></td>
    </tr>
    <tr>
    <td align="right" valign="top">TEXT PLS:</td>
    <td valign="top"><textarea wrap="virtual" rows="10" cols="60"
name="arg5">HERE IS THE DEFAULT OMG!@#!.</textarea>
    <div class="formDescription">it is some text
    </div></td>
    </tr>
    </table><input type="submit" />
    </form>
    </body>
    </html>
    '''
 
    def __init__(self):
        Page.__init__(self)
      
    def checkName(self, request, name):
        if name is None:
            return None
        return True
 
    #def commitName(self, request, name=""):
    #    print self.model
        
    def wvupdate_arg1(self, request, widget, model):
        pass
 
    def wmfactory_arg1(self, request):
        return request.args.get('arg1')
    
    def wcfactory_int(self, request, node, model):
        self.submodel = self.model.getSubmodel(request, "arg1")
        return input.InputHandler(
            model,
            name = "arg1",
            check = self.checkName,
            submodel = self.submodel)
            #commit = self.commitName
            
    def wchild_post(self, request):
        return self
 
reactor.listenTCP(8585, Site(FormPage()))
reactor.run()
 
 
Here's the error I get:
 
 
exceptions.TypeError: process() keywords must be strings
 
 
I know that the error comes from controller but I don't know how to
correct it.
Maybe the error is because I'm not very familiar with form.
Thx in advance,
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20031031/a8eb7bef/attachment.htm 

From exarkun at intarweb.us  Fri Oct 31 10:04:36 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 31 Oct 2003 10:04:36 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] THE EXTENSION IS .C!  IT IS NOT A C++ FILE!
In-Reply-To: <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>
References: <E1AFM4c-0007Hw-00@wolfwood> <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <20031031150436.GA29923@intarweb.us>

On Thu, Oct 30, 2003 at 08:41:57PM -0500, James Y Knight wrote:
> What compiler doesn't support C99 comments yet?
> 
> James

  Solaris' cc.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031031/0dbe2c07/attachment.pgp 

From itamar at itamarst.org  Fri Oct 31 10:36:02 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 31 Oct 2003 10:36:02 -0500
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <u3cd9vg3k.fsf@inout.no>
References: <uad7iwk90.fsf@inout.no>
	<20031030204340.GD15670@twistedmatrix.com>
	<uvfq5vka5.fsf@inout.no>
	<u3cd9vg3k.fsf@inout.no>
Message-ID: <20031031103602.011b777f.itamar@itamarst.org>

On 31 Oct 2003 11:47:27 +0100
Syver Enstad <syver at inout.no> wrote:

> By the way I found that the handling of deferreds from
> Controller.handle in View was totally broken in Twisted 1.0.6. Does
> anybody know if this is fixed in 1.1? 

Personally I would just avoid using controllers, they're not good for
much as far as I can tell.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Oct 31 10:38:17 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 31 Oct 2003 10:38:17 -0500
Subject: [Twisted-Python] More about twistd and win32 service
In-Reply-To: <20031031143130.84DE2D35C@server1.messagingengine.com>
References: <20031031143130.84DE2D35C@server1.messagingengine.com>
Message-ID: <20031031103817.413d8ddc.itamar@itamarst.org>

On Fri, 31 Oct 2003 08:31:30 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> Sorry for the delayed reply and thank you for your constant help.  I
> setup my NT service as you described, importing the win32eventreactor
> and installing it.  The service starts up fine, but when I stop the
> service I get the following in the logs.  The "15:08 ...
> Unexpected..." entry only gets dumped in the log when stopping the
> service.

Looks like a bug in the win32event reactor - add it to the tracker?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From fog at initd.org  Fri Oct 31 11:01:29 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Fri, 31 Oct 2003 17:01:29 +0100
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <20031031103602.011b777f.itamar@itamarst.org>
References: <uad7iwk90.fsf@inout.no>
	 <20031030204340.GD15670@twistedmatrix.com> <uvfq5vka5.fsf@inout.no>
	 <u3cd9vg3k.fsf@inout.no>  <20031031103602.011b777f.itamar@itamarst.org>
Message-ID: <1067616088.1231.320.camel@localhost>

Il ven, 2003-10-31 alle 16:36, Itamar Shtull-Trauring ha scritto:
> On 31 Oct 2003 11:47:27 +0100
> Syver Enstad <syver at inout.no> wrote:
> 
> > By the way I found that the handling of deferreds from
> > Controller.handle in View was totally broken in Twisted 1.0.6. Does
> > anybody know if this is fixed in 1.1? 
> 
> Personally I would just avoid using controllers, they're not good for
> much as far as I can tell.

they would be very usefull in theory. they could be used to change the
model after reloading a form. imagine a form with action="" that reload
itself until all controller constraints are satisfied and then redirect
to the next page. unfortunately controllers _don't_ update the model
(bug?) does nevow use controllers the right way or does it provide an
alternative to them?

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
          The reverse side also has a reverse side.  -- Japanese proverb
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio =?ISO-8859-1?Q?=E8?= firmata
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20031031/ae784e2e/attachment.pgp 

From justinjohnson at fastmail.fm  Fri Oct 31 11:23:28 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 31 Oct 2003 10:23:28 -0600
Subject: [Twisted-Python] More about twistd and win32 service
In-Reply-To: <20031031103817.413d8ddc.itamar@itamarst.org>
References: <20031031143130.84DE2D35C@server1.messagingengine.com> <20031031103817.413d8ddc.itamar@itamarst.org>
Message-ID: <20031031162328.C239E3E7A7@server1.messagingengine.com>

Submitted Issue 379 as a bug.

On Fri, 31 Oct 2003 10:38:17 -0500, "Itamar Shtull-Trauring"
<itamar at itamarst.org> said:
> On Fri, 31 Oct 2003 08:31:30 -0600
> "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> 
> > Sorry for the delayed reply and thank you for your constant help.  I
> > setup my NT service as you described, importing the win32eventreactor
> > and installing it.  The service starts up fine, but when I stop the
> > service I get the following in the logs.  The "15:08 ...
> > Unexpected..." entry only gets dumped in the log when stopping the
> > service.
> 
> Looks like a bug in the win32event reactor - add it to the tracker?
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From jon at totient.demon.co.uk  Fri Oct 31 16:05:15 2003
From: jon at totient.demon.co.uk (Jon Dyte)
Date: Fri, 31 Oct 2003 21:05:15 +0000
Subject: [Twisted-Python] Re: [Twisted-commits] THE EXTENSION IS .C!  IT IS NOT A C++ FILE!
In-Reply-To: <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>
References: <E1AFM4c-0007Hw-00@wolfwood> <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <200310312105.15162.jon@totient.demon.co.uk>

Specifically this one, on Solaris.

/tmp> cc -V
cc: WorkShop Compilers 4.2 30 Oct 1996 C 4.2

no chance of C99 there.

Jon


On Friday 31 Oct 2003 1:41 am, James Y Knight wrote:
> What compiler doesn't support C99 comments yet?
>
> James
>
> On Oct 30, 2003, at 6:19 PM, exarkun CVS wrote:
> > Modified files:
> > Twisted/twisted/protocols/_c_urlarg.c 1.7 1.8
> >
> > Log message:
> > THE EXTENSION IS .C!  IT IS NOT A C++ FILE!
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From glyph at twistedmatrix.com  Fri Oct 31 17:17:44 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 31 Oct 2003 17:17:44 -0500
Subject: [Twisted-Python] migration from IIS to Twisted
In-Reply-To: <3FA0CB34.20902@ucmg.com.ua>
References: <3FA0CB34.20902@ucmg.com.ua>
Message-ID: <3FA2DF88.9010506@twistedmatrix.com>

Hi, Max.

Max Ischenko wrote:

> I have a really big ASP/IIS-based system which I'm trying to (partially) 
> rewrite and evolve with python.

Congratulations :).

> As my python code depends on WebKit very little and Cheetah is a 
> standalone processor that could probably be plugged into Twisted easily 
> I'm evaluating the possibility to switch to Twisted.

There are lots of good reasons to do this, but it doesn't seem like 
Twisted would do very much for you.  The main feature which is the 
make-or-break point for Twisted is usually multiple protocol support.

> There is nothing wrong with Webware/WebKit -- it is a great platform, 
> but I'd like to make use of some Twisted components, like 
> twisted.enterprise.row or twisted.cred.

Personally, I've only used t.e.row once - the Twisted team tends to 
avoid databases, in general, and while the support for them is there, 
you'll find it will be more idiomatic in frameworks without Twisted's 
concern for an asynchronous event loop.

Twisted.cred is a very useful framework, but it doesn't really *do* 
anything, per se; it's a set of interfaces to specify the interactions 
between a set of the same domain objects and a potentially large number 
of client protocols.  Its HTTP component is currently 
twisted.web.woven.guard (which is likely to be refactored in the near 
future because it is too complex for the task it performs...).  The real 
meat of the work going into cred at the moment is for protocols like PB 
and SIP.  Integrating it with Cheetah is likely to be more trouble than 
it's worth at the moment considering the fairly small number of 
available credential checker back-ends right now.

> If I'm to switch to Twisted what could you suggest for IIS-Twisted 
> integration?

Reverse-proxying is probably best, unless you need some kind of tighter 
coupling between the servers.

> I'm currently thinking about simple Response.Redirect('...') from .asp 
> to twisted.web.

That can also work.

> But I'd also like to share data and session's state 
> between the two. For example, to match  twisted.web.server.Session with 
>  IIS session. Dunno how this could be done though.

Your best bet would be to hack something with a cookie passed between 
the servers, again, by using reverse proxying.

> More promising (may be) but surely more complex way would be to write 
> some kind of IIS-Twisted adapter that uses COM to talk to VB and 
> twisted.spread to talk to Twisted.

That sounds kind of cool, and it would certainly work if you can get it 
up and running.  Good luck with it.

but-don't-get-any-on-me-l'y y'rs,

	-glyph




From glyph at twistedmatrix.com  Fri Oct 31 17:48:19 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 31 Oct 2003 17:48:19 -0500
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <1067616088.1231.320.camel@localhost>
References: <uad7iwk90.fsf@inout.no>	 <20031030204340.GD15670@twistedmatrix.com> <uvfq5vka5.fsf@inout.no>	 <u3cd9vg3k.fsf@inout.no>  <20031031103602.011b777f.itamar@itamarst.org> <1067616088.1231.320.camel@localhost>
Message-ID: <3FA2E6B3.6020903@twistedmatrix.com>

Federico Di Gregorio wrote:

> they would be very usefull in theory. they could be used to change the
> model after reloading a form. imagine a form with action="" that reload
> itself until all controller constraints are satisfied and then redirect
> to the next page. unfortunately controllers _don't_ update the model
> (bug?) does nevow use controllers the right way or does it provide an
> alternative to them?

Nevow is not MVC (model/view/controller) it is "DR" (data/renderer). 
Data is analagous to the Model, but it doesn't have the whole observer 
framework attached to it.  One big advantage is that you can have normal 
Python objects -- lists, dicts, etc -- as data without any intermediate 
wrappers.  It seems that most use-cases for observing model updates can 
be satisfied somewhere else (except for LivePage, which we are still 
working on).  Renderer is analagous to the view, but far simpler; it 
uses a functional, rather than object-oriented approach to the template, 
which seems to work better for laying out pages.

Really, Twisted Web provides everything you need for the "controller" 
aspects of your code.  Override 'render' and handle request.args before 
drawing your "view" (woven or not) and you can do any HTTP-level logic 
before even getting into page templating considerations.




From tv at tv.debian.net  Wed Oct  1 00:43:33 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Wed, 01 Oct 2003 09:43:33 +0300
Subject: [Twisted-Python] Serving web content over SSL
In-Reply-To: <007401c3879c$33654a70$0401a8c0@razor>
References: <007401c3879c$33654a70$0401a8c0@razor>
Message-ID: <3F7A7795.8010301@tv.debian.net>

Thomas Weholt wrote:
> Can anybody provide a working, simple example of a SSL-capable web-server
> using Twisted ?
> Any hints or clues regarding installation of openssl or other required
> library is also interesting.

twisted-web

deb http://twistedmatrix.com/~moshez/apt/ ./

cvs -d :ext:cvs.twistedmatrix.com:/cvs co TwistedWebDeb

Put this in /etc/twisted-web/local.d/20ssl

from twisted.internet import reactor, ssl
from twisted.web import static, server

port = 443

ctx  = ssl.DefaultOpenSSLContextFactory(
	'/etc/twisted-web/ssl/private/privkey.pem',
         '/etc/twisted-web/ssl/cert.pem')
application.listenSSL(port, site, ctx)

Of course, you'll need to create the SSL key with openssl.




From radix at twistedmatrix.com  Wed Oct  1 01:52:05 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 1 Oct 2003 03:52:05 -0400
Subject: [Twisted-Python] sorry for that spam [was: Some stupid spam subject]
In-Reply-To: <b8i4$6329$$r743302-1$7s4f2k-blt@kbgby1bumer>
References: <b8i4$6329$$r743302-1$7s4f2k-blt@kbgby1bumer>
Message-ID: <20031001075205.GG1515@radii>

On Tue, Sep 30, 2003 at 08:39:25PM -0200, jv5Hivfj6183j4 at aonehotwebdeals.com wrote:

I'm sorry, I inadvertently let this message through the moderation
queue. I was trying to approve Tv's post (Please subscribe, btw,
Tommi), and I must've approved the wrong post. I just wanted to make
sure nobody thought that this is one of those annoying lists that
allows spammers to post :)

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From itamar at itamarst.org  Wed Oct  1 10:24:16 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 1 Oct 2003 12:24:16 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] Implement ReconnectingPBClientFactory, please
 review
In-Reply-To: <E1A4bFu-0008Iq-00@wolfwood>
References: <E1A4bFu-0008Iq-00@wolfwood>
Message-ID: <20031001122416.516adb6b.itamar@itamarst.org>

On Wed, 01 Oct 2003 01:18:38 -0600
warner CVS <warner at wolfwood.twistedmatrix.com> wrote:

> Modified files:
> Twisted/sandbox/warner/test_pb.py None 1.1
> Twisted/sandbox/warner/pb.py None 1.1
> 
> Log message:
> Implement ReconnectingPBClientFactory, please review

You can override failedToGetPerspective to get the error but because
it's a callback on a Deferred and returns the error it will always cause
error to get logged, which is not necessarily what you want. Maybe it
shouldn't return anything.

Or... hm. If you don't override it you do want the error logged. OK.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From mesozoic at polynode.com  Wed Oct  1 13:30:30 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 01 Oct 2003 15:30:30 -0400
Subject: [Twisted-Python] Serving web content over SSL
In-Reply-To: <3F7A7795.8010301@tv.debian.net>
References: <007401c3879c$33654a70$0401a8c0@razor>
	 <3F7A7795.8010301@tv.debian.net>
Message-ID: <1065036629.6266.23.camel@hyla>

On Wed, 2003-10-01 at 02:43, Tommi Virtanen wrote:
> twisted-web

While we're on the topic, I mentioned in IRC this morning that
twisted-web is now failing to load because it's running twistd with the
--quiet flag, which was one of several removed in the twistd refactor.

I asked whether I should post this to the tracker (meaning twistd needs
to support --quiet) or whether Moshe would just fix twisted-web. I got
no definitive answer. Maybe I'll get one here.

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031001/a22c96d7/attachment.sig>

From greg at digitalinfo.net  Wed Oct  1 15:20:17 2003
From: greg at digitalinfo.net (Greg)
Date: Wed, 1 Oct 2003 17:20:17 -0400
Subject: [Twisted-Python] smtp.SMTP help
Message-ID: <200310011720.17355.greg@digitalinfo.net>

Working on an SMTP filter (consisting of an SMTP server that receives 
messages, some code that mangles them, then and SMTP client that forwards 
them along). The first step is to get a functioning SMTP server working, and 
I'm having some trouble with SMTPFactory / SMTP. I've overloaded the validate 
methods in an attempt accept emails to and from any domain, but I can't 
figure out how to hook in a class that implements IMessageDelivery:

-----------------------------------------------------------
class MySMTPFactory(SMTPFactory):
	def buildProtocol(self, addr):
		self.protocol = MySMTPProtocol
		return SMTPFactory.buildProtocol(self, addr)

class MySMTPProtocol(SMTP):
		
	def validateFrom(self, helo, origin):
		return origin
		
	def validateTo(self, user):
		d = defer.Deferred()
		reactor.callLater(0, self.fakeSucceed())
		return d
		
	def fakeSucceed(self):
		return MyIMessage
			
class MyIMessage:
	__implements__ = (smtp.IMessageDelivery)
	
	def __init__(self):
		print "MyIMessage.__init__ got called...."
	
	def validateTo(self, user):
		print "MyIMessage.validateTo got called..."
		return user

	def validateFrom(self, helo, origin):
		print "MyIMessage.validateFrom got called..."
		return origin

	def receivedHeader(self, helo, origin, recipients):
		print "MyIMessage.receivedHeader got called..."
		return None
-----------------------------------------------------------

I gleaned most of this from looking at the testing code. The SMTP server 
reports "503 Must have valid receiver and originator" after the client issues 
the DATA command, and none of the methods in MyIMessage (except for __INIT__) 
ever get called. Any tips as to what I'm doing wrong? Thanks. 




From iko at cd.chalmers.se  Wed Oct  1 17:47:17 2003
From: iko at cd.chalmers.se (Anders Hammarquist)
Date: Thu, 02 Oct 2003 01:47:17 +0200
Subject: [Twisted-Python] smtp.SMTP help 
In-Reply-To: <200310011720.17355.greg@digitalinfo.net> 
References: <200310011720.17355.greg@digitalinfo.net> 
Message-ID: <200310012347.h91NlHW04812@haddock.cd.chalmers.se>

Hi Greg!

In a message of Wed, 01 Oct 2003 17:20:17 EDT, Greg writes:
>Working on an SMTP filter (consisting of an SMTP server that receives 
>messages, some code that mangles them, then and SMTP client that forwards 
>them along). The first step is to get a functioning SMTP server working, and 
>I'm having some trouble with SMTPFactory / SMTP. I've overloaded the validate 
>methods in an attempt accept emails to and from any domain, but I can't 
>figure out how to hook in a class that implements IMessageDelivery:

There are several problems with your code, but to my eye it looks like
confusion between several methods of using the SMTP class. Until recently,
the IMessageDelivery method didn't exists, and you needed to override
SMTP to implement validateTo and validateFrom. Now, you can instead pass
an IMessageDelivery to SMTP, either directly or using the authenticator
(and if you do, you shouldn't need to subclass SMTP - and if your twisted
is recent enough, you have to use the IMessageDelivery method).

You do need to make your own factory though, since the one that's there
doesn't deal with IMessageDelivery()s yet. Something like

class MySMTPFactory(SMTPFactory):
	def buildProtocol(self, addr):
		p = self.protocol(MyMessageDelivery())
		p.factory = self
		p.portal = self.portal
		p.host = self.domain
		return p

>class MySMTPProtocol(SMTP):
[...]
>	def validateTo(self, user):
>		d = defer.Deferred()
>		reactor.callLater(0, self.fakeSucceed())
>		return d

You don't need this code, but I still want to point out that it doesn't
do anything useful, and is overcomplicated. 

First, validateTo may return an IMessage or a deferred returning an
IMessage, so you don't need the deferred, you can just return you
IMessage directly. Secondly the deferred is never called, so it will
never return, and thus your SMTP server stops here.

reactor.callLater() just calls another function asynchrously and discards
the result. If you want to pass back a result from a callLater, you need
to pass along the deferred and call it in the function you callLater()ed.

>class MyIMessage:
>	__implements__ = (smtp.IMessageDelivery)

You seem to have mixed up IMessage and IMessageDelivery. You need both.
Your IMessageDelivery.validateTo() should return an IMessage (or a deferred
returning an IMessage).

HTH
/Anders

-- 
 -- Of course I'm crazy, but that doesn't mean I'm wrong.
Anders Hammarquist                                  | iko at cd.chalmers.se
Physics student, Chalmers University of Technology, | Hem: +46 31 88 48 50
G|teborg, Sweden.           RADIO: SM6XMM and N2JGL | Mob: +46 707 27 86 87



From slt5v at cc.usu.edu  Wed Oct  1 20:24:35 2003
From: slt5v at cc.usu.edu (Travis B. Hartwell)
Date: Wed, 01 Oct 2003 20:24:35 -0600
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
Message-ID: <87zngkwf4s.fsf@lutya.travishartwell.net>

Hey all,

In my recent efforts to update the Beyond code base to use recent,
preferred, and non-deprecated Twisted developments such as new cred, I
have encountered a few problems in updating the unit tests to match my
changes.  The unit tests as they stood before my changes used the old
pyunit module.  After successfully converting the tests on the old
code base to use twisted.trial (and fixing a probable bug in the
process that pyunit didn't expose), I attempted to get them to work
with my changes.  That's where the problems started happening.  From
my experience and looking through the unit tests written for Twisted,
I have come up with the following questions.  As a background, the
client and server that I am testing in Beyond is implemented using PB.

1.  Does proper testing necessitate or at least include actually
    communicating over a port for the client and server?  I see this
    is done for the PB tests and several others, but not for many.
    
2.  Closely related, what is the proper way to connect the client and
    server?  When I made changes, the t.test.test_pb.IOPump that the
    tests were using didn't seem to work.  According to spiv, this may
    not be the preferred connecting method to use anymore.
    
3.  From that, if I use the twisted.protocols.loopback module, how do
    I set up callbacks for events such as logging in?  As I am using
    it now, it appears that things just hang and nothing is ever
    completed.  For example, in one of my tests, I have this code,
    with self.p being my portal and self.c being an instance of my PB
    client:

        accum = []
        factory = pb.PBClientFactory()
        deferred = factory.login(UsernamePassword("guest", "guest"), client=self.c)
        deferred.addCallbacks(accum.append, self.errorReceived)
        loopback.loopbackTCP(self.p, self.c)

    It just sits there, not advancing beyond the loopbackTCP call.
    
4.  Regardless of the method used, what is the proper way to have the
    reactor keep going until there are no more events?  I need
    something analogous to test_pb.IOPump.pump() or flush(), if IOPump
    is not to be used.

    trial.unittest.TestCase.runReactor()?
    
5.  When is the proper time to use unittest.deferredResult?  I see it
    used in some cases, yet in other cases regular callbacks and
    errbacks are used.

6.  Realted to that, when I added callbacks and errbacks, they didn't
    seem to get executed.  Yet looking at test_newcred.py, on line 89
    for example, they are added and then immediately the result is
    checked.  Does this work because I am listening on a port?  Or was
    my doing this not working originally because the client and server
    were not connected?  Later in the same file deferredResult is used.
    I'm not understanding what the expected behavior is then.

7.  Is it preferred to use unittest.TestCase.assertEqual to the plain
    assert?  I see both used in various places in the Twisted tests.


I hope these questions make sense.  I felt the mailing list was a
better forum for this than IRC because I had detailed questions.
Also, would it be appropriate for general cases of answers to these
questions (especially ones like #5 and #7) to be added to the "Unit
Tests in Twisted" howto?  I would be willing to put those appropriate
into there after someone answers my questions. :)

Thanks a million,
and slowly learning,

Travis



From radix at twistedmatrix.com  Wed Oct  1 20:44:05 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 1 Oct 2003 22:44:05 -0400
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
In-Reply-To: <87zngkwf4s.fsf@lutya.travishartwell.net>
References: <87zngkwf4s.fsf@lutya.travishartwell.net>
Message-ID: <20031002024405.GK1515@radii>

On Wed, Oct 01, 2003 at 08:24:35PM -0600, Travis B. Hartwell wrote:
> 1.  Does proper testing necessitate or at least include actually
>     communicating over a port for the client and server?  I see this
>     is done for the PB tests and several others, but not for many.

Well, this is actually usually the easiest way to test your code;
otherwise, you need to deal with crap like fake transports, etc. If
you do test over the network, make sure you listen on a local-only
interface (i.e., '127.0.0.1') and use a portno of 0. e.g.:

        self.port = reactor.listenTCP(0, self.svr, interface="127.0.0.1")
        self.portno = self.port.getHost()[-1]

> 2.  Closely related, what is the proper way to connect the client and
>     server?  When I made changes, the t.test.test_pb.IOPump that the
>     tests were using didn't seem to work.  According to spiv, this may
>     not be the preferred connecting method to use anymore.

Well, if you do what I said above, then you just need to use regular
connectTCP(self.portno, fac).

> 3.  [moot question deleted]
>
> 4.  Regardless of the method used, what is the proper way to have the
>     reactor keep going until there are no more events?  I need
>     something analogous to test_pb.IOPump.pump() or flush(), if IOPump
>     is not to be used.
> 
>     trial.unittest.TestCase.runReactor()?

Well, you don't really need "until there are no more events" --
usually, you just run the reactor until some state is reached, e.g.:

        while not l:
            reactor.iterate()

assuming that something triggered by running the reactor will
eventually make `l' True (e.g., if l started as an empty list, by
appending something to it). runReactor is only useful for
timing-related tests.

> 5.  When is the proper time to use unittest.deferredResult?  I see it
>     used in some cases, yet in other cases regular callbacks and
>     errbacks are used.

Well, any time you just want to get the result of a Deferred and don't
want to add a callback, you can use deferredResult. Some people
writing tests that use callbacks might not have known about
deferredResult, or don't like it, or needed to take advantage of
callback chaining, or whatever.

> 6.  Realted to that, when I added callbacks and errbacks, they didn't
>     seem to get executed.  Yet looking at test_newcred.py, on line 89
>     for example, they are added and then immediately the result is
>     checked.  Does this work because I am listening on a port?  Or was
>     my doing this not working originally because the client and server
>     were not connected?  Later in the same file deferredResult is used.
>     I'm not understanding what the expected behavior is then.

Well, it's probably because you're not running the reactor properly,
or something. I can't say more without seeing the code :)

> 7.  Is it preferred to use unittest.TestCase.assertEqual to the plain
>     assert?  I see both used in various places in the Twisted tests.

Well, when you use the self.assert* methods, trial marks the tests as
"Failures", rather than "Errors", which occur when any other exception
is raised from the test. Not a really big difference. Also, assert
statements don't get run when python -O is used.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From andrew-twisted at puzzling.org  Wed Oct  1 20:53:14 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 2 Oct 2003 12:53:14 +1000
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
In-Reply-To: <20031002024405.GK1515@radii>
References: <87zngkwf4s.fsf@lutya.travishartwell.net> <20031002024405.GK1515@radii>
Message-ID: <20031002025314.GA14211@frobozz>

On Wed, Oct 01, 2003 at 10:44:05PM -0400, Christopher Armstrong wrote:
> On Wed, Oct 01, 2003 at 08:24:35PM -0600, Travis B. Hartwell wrote:
> > 1.  Does proper testing necessitate or at least include actually
> >     communicating over a port for the client and server?  I see this
> >     is done for the PB tests and several others, but not for many.
> 
> Well, this is actually usually the easiest way to test your code;
> otherwise, you need to deal with crap like fake transports, etc. If

It's a shame that fake transports are harder to use; we should be able to do
better than that.  twisted.protocols.loopback is a good start, though...

> you do test over the network, make sure you listen on a local-only
> interface (i.e., '127.0.0.1') and use a portno of 0. e.g.:
> 
>         self.port = reactor.listenTCP(0, self.svr, interface="127.0.0.1")
>         self.portno = self.port.getHost()[-1]

This bothers me a little; the details of TCP connections are generally
irrelevant to what the test method is trying to test (and TCP, hopefully, is
getting fully tested in test_tcp).  It'd be nice if this wasn't required.

-Andrew.




From slt5v at cc.usu.edu  Wed Oct  1 21:30:19 2003
From: slt5v at cc.usu.edu (Travis B. Hartwell)
Date: Wed, 01 Oct 2003 21:30:19 -0600
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted
 Applications
In-Reply-To: <20031002024405.GK1515@radii> (Christopher Armstrong's message
 of "Wed, 01 Oct 2003 22:44:05 -0400")
References: <87zngkwf4s.fsf@lutya.travishartwell.net>
	<20031002024405.GK1515@radii>
Message-ID: <87vfr8wc38.fsf@lutya.travishartwell.net>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> On Wed, Oct 01, 2003 at 08:24:35PM -0600, Travis B. Hartwell wrote:
>> 1.  Does proper testing necessitate or at least include actually
>>     communicating over a port for the client and server?  I see this
>>     is done for the PB tests and several others, but not for many.
>
> Well, this is actually usually the easiest way to test your code;
> otherwise, you need to deal with crap like fake transports, etc. If
> you do test over the network, make sure you listen on a local-only
> interface (i.e., '127.0.0.1') and use a portno of 0. e.g.:
>
>         self.port = reactor.listenTCP(0, self.svr, interface="127.0.0.1")
>         self.portno = self.port.getHost()[-1]
>
>> 2.  Closely related, what is the proper way to connect the client and
>>     server?  When I made changes, the t.test.test_pb.IOPump that the
>>     tests were using didn't seem to work.  According to spiv, this may
>>     not be the preferred connecting method to use anymore.
>
> Well, if you do what I said above, then you just need to use regular
> connectTCP(self.portno, fac).
>

The combination of this answer and the above worked just great.
Thanks!

>> 3.  [moot question deleted]
>>
>> 4.  Regardless of the method used, what is the proper way to have the
>>     reactor keep going until there are no more events?  I need
>>     something analogous to test_pb.IOPump.pump() or flush(), if IOPump
>>     is not to be used.
>> 
>>     trial.unittest.TestCase.runReactor()?
>
> Well, you don't really need "until there are no more events" --
> usually, you just run the reactor until some state is reached, e.g.:
>
>         while not l:
>             reactor.iterate()

This worked great for some cases.  Sort of.  It doesn't quite
approximate what pump does so I'm a bit at a loss.  I have cases where
I don't know what condition to test, or what I am testing might be the
only condition.  For example:

    def testCacheObjectToClient(self): 
        myObj = SimObject(id=12345)
        self.rlm.addSimObject(myObj)
        myPresence = self.rlm.presences[1]
        myPresence.addObjectToClientSim(myObj)
        # Crank
        assert self.c.localCache[12345], 'Object not received!'

The # Crank comment is where self.pump.flush() was located before.  If
I look based on if there is something in localCache, I would keep
looping if the object was not received.  This is the very thing I am
testing, so when it should fail it would just sit there endlessly
instead of failing.  So what else could I try?

--

Thanks for the answers to the rest of my questions.  I am slowly
getting this.

Travis



From exarkun at intarweb.us  Wed Oct  1 21:38:10 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 1 Oct 2003 23:38:10 -0400
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
In-Reply-To: <20031002025314.GA14211@frobozz>
References: <87zngkwf4s.fsf@lutya.travishartwell.net> <20031002024405.GK1515@radii> <20031002025314.GA14211@frobozz>
Message-ID: <20031002033810.GA1739@intarweb.us>

On Thu, Oct 02, 2003 at 12:53:14PM +1000, Andrew Bennetts wrote:
> On Wed, Oct 01, 2003 at 10:44:05PM -0400, Christopher Armstrong wrote:
> 
> [snip]
> 
> > you do test over the network, make sure you listen on a local-only
> > interface (i.e., '127.0.0.1') and use a portno of 0. e.g.:
> > 
> >         self.port = reactor.listenTCP(0, self.svr, interface="127.0.0.1")
> >         self.portno = self.port.getHost()[-1]
> 
> This bothers me a little; the details of TCP connections are generally
> irrelevant to what the test method is trying to test (and TCP, hopefully, is
> getting fully tested in test_tcp).  It'd be nice if this wasn't required.
> 

  I agree.  Only a few of the tests you write should actually go over the
network -- note that loopback.loopback() and the rest of the fake transport
bit fall into this category!).  The bulk of your functionality should be
testable in isolation of the network code.  If it's not, consider trying to
rewrite it so it is.  This will lead to simpler, more reliable tests as well
as simpler and more modular code.

  Jp

-- 
"The problem is, of course, that not only is economics bankrupt but it has
 always been nothing more than politics in disguise ... economics is a form
 of brain damage."  -- Hazel Henderson
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031001/3e857d6a/attachment.sig>

From glyph at twistedmatrix.com  Wed Oct  1 22:29:34 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 02 Oct 2003 00:29:34 -0400
Subject: [Twisted-Python] Writing unit tests with Trial for Twisted Applications
In-Reply-To: <20031002033810.GA1739@intarweb.us>
References: <87zngkwf4s.fsf@lutya.travishartwell.net> <20031002024405.GK1515@radii> <20031002025314.GA14211@frobozz> <20031002033810.GA1739@intarweb.us>
Message-ID: <3F7BA9AE.6040605@twistedmatrix.com>

Jp Calderone wrote:
> Only a few of the tests you write should actually go over the
> network -- note that loopback.loopback() and the rest of the fake transport
> bit fall into this category!).  The bulk of your functionality should be
> testable in isolation of the network code.  If it's not, consider trying to
> rewrite it so it is.  This will lead to simpler, more reliable tests as well
> as simpler and more modular code.

The ideal situation in this case would be to have a briefer answer like 
"Use trial.prototest" or something.  While I appreciate the "Unit" 
aspect of unit tests (test only what you're testing) it's still good to 
actually exercise a little network code under the covers, since the OS 
can do difficult-to-replicate-and-test things in different environments.

I can't think of an easy way to do this, but there should be a 
'listenTest' utility function which can listen over TCP or SSL, or over 
a loopback connection that doesn't consume OS resources, based on a 
switch to the trial commandline.  That way we can exercise both 
interactions of the higher levels with the lower levels and the higher 
levels in effective isolation.

It occurs to me that a test reactor package would be useful for more 
than that - testReactor.run() could monitor the event loop for state 
changes - if no data is sent or received in a given iteration, then you 
know that the reactor is going to hang and you can raise a test failure 
to that effect rather than consuming CPU and hiding the traceback.

(Am I making sense here?)




From rudy.schockaert at pandora.be  Wed Oct  1 23:18:51 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Thu, 02 Oct 2003 07:18:51 +0200
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <200310012347.h91NlHW04812@haddock.cd.chalmers.se>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se>
Message-ID: <3F7BB53B.8000805@pandora.be>

Hi,

I have been struggling with SMTP also. I noticed that there is a lot 
changing in that part lately, that's why I was still patient and was 
just waiting to see some doc pop up on the new way to use SMTP.

Could someone send a small example of  how to use the news SMTP module? 
Mayby an impementation of what Greg is trying to do would be nice.

TIA,

Rudy




From itamar at itamarst.org  Wed Oct  1 23:26:09 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 2 Oct 2003 01:26:09 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <3F7BB53B.8000805@pandora.be>
References: <200310011720.17355.greg@digitalinfo.net>
	<200310012347.h91NlHW04812@haddock.cd.chalmers.se>
	<3F7BB53B.8000805@pandora.be>
Message-ID: <20031002012609.5edafcac.itamar@itamarst.org>

On Thu, 02 Oct 2003 07:18:51 +0200
Rudy Schockaert <rudy.schockaert at pandora.be> wrote:

> I have been struggling with SMTP also. I noticed that there is a lot 
> changing in that part lately, that's why I was still patient and was 
> just waiting to see some doc pop up on the new way to use SMTP.
> 
> Could someone send a small example of  how to use the news SMTP
> module? Mayby an impementation of what Greg is trying to do would be
> nice.

IIRC it was quite trivial. Make a class MyDelivery implementing
IMessageDelivery, and then

class MySMTP(smtp.ESMTP):
    delivery = MyDelivery()

factory = protocol.ServerFactory()
factory.protocol = MySMTP
reactor.listenTCP(25, factory)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From rudy.schockaert at pandora.be  Wed Oct  1 23:55:29 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Thu, 02 Oct 2003 07:55:29 +0200
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <20031002012609.5edafcac.itamar@itamarst.org>
References: <200310011720.17355.greg@digitalinfo.net>	<200310012347.h91NlHW04812@haddock.cd.chalmers.se>	<3F7BB53B.8000805@pandora.be> <20031002012609.5edafcac.itamar@itamarst.org>
Message-ID: <3F7BBDD1.4050801@pandora.be>

Itamar Shtull-Trauring wrote:

>On Thu, 02 Oct 2003 07:18:51 +0200
>Rudy Schockaert <rudy.schockaert at pandora.be> wrote:
>
>  
>
>>I have been struggling with SMTP also. I noticed that there is a lot 
>>changing in that part lately, that's why I was still patient and was 
>>just waiting to see some doc pop up on the new way to use SMTP.
>>
>>Could someone send a small example of  how to use the news SMTP
>>module? Mayby an impementation of what Greg is trying to do would be
>>nice.
>>    
>>
>
>IIRC it was quite trivial. Make a class MyDelivery implementing
>IMessageDelivery, and then
>
>class MySMTP(smtp.ESMTP):
>    delivery = MyDelivery()
>
>factory = protocol.ServerFactory()
>factory.protocol = MySMTP
>reactor.listenTCP(25, factory)
>
>  
>
Thanks,

This is trivival indeed. Now, let's see how I can change behaviour 
dependant on where the message comes from (e.g. Intranet or Internet) or 
who sent it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031002/f489eea9/attachment.html>

From oisin at enginesofcreation.ie  Thu Oct  2 05:57:02 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Thu, 02 Oct 2003 12:57:02 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <87zngkwf4s.fsf@lutya.travishartwell.net>
References: <87zngkwf4s.fsf@lutya.travishartwell.net>
Message-ID: <3F7C128E.1060708@enginesofcreation.ie>

Hi,

In my current project I'm using python's ftplib to transfer
files. This is proving very slow and I need to improve this.

I looked at Twisted's protocol.ftp.FTPClient some time ago
and there seemed to be no support for uploading files. After
trawling through the comp.lang.python news group I saw
that this had changed in 1.0.4(?), so I decided to try FTPClient
again.

I've attached a modified version of the ftpclient.py example
I'm using. When I run this I login my ftp server ok, do the pwd
ok & then proceed to the storeFile and nothing seems to
happen. When I look at the ftp server I find an empty file
with the correct name however the store operation never
seems to finish.

I confess I really don't know how to handle the two deferred
object that get returned by storeFile. I just add callback/
errorback for each, this could be the problem.

Can anyone enlighten me as to what I'm doing wrong. I would
really like to use proper async behavior for doing the uploads,
instead of using threads + ftplib.


Thanks,

om


P.S. my system: osx, python 2.2.3, twisted 1.0.7.

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftpclient.py
URL: </pipermail/twisted-python/attachments/20031002/eb616a9c/attachment.ksh>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: myfile.txt
URL: </pipermail/twisted-python/attachments/20031002/eb616a9c/attachment-0004.txt>

From justinjohnson at fastmail.fm  Thu Oct  2 08:30:39 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 02 Oct 2003 08:30:39 -0600
Subject: [Twisted-Python] Adapter troubles - Copying Quotient's DivmodSession
Message-ID: <20031002143039.784EB3D96E@www.fastmail.fm>

Hi,

I've created a class called RatControlSession similar to DivmodSession in
Quotient.  I define IRatControlSession and RatControlSession, and I
register RatControlSession as an adapter from twisted.web.server.Session
to IRatControlSession.  However, when I try to do something like...

    prefs = webinterfaces.IRatControlSession(request.getSession())

I get the following error.  This is a cut-n-paste from what appears in
the browser.

-----
C:\svn\RatControl\ratcontrol\web\pages.py, line 14 in wmfactory_action
12  def wmfactory_action(self, request):
13    #prefs = request.getSession(webinterfaces.IRatControlSession)
14    prefs = webinterfaces.IRatControlSession(request.getSession())
15    #prefs = request.getSession()
Locals
self    
ratcontrol.web.pages.MenuPage instance @ 0xc2e760
<ratcontrol.web.pages.MenuPage instance at 0x00C2E760>
request 
twisted.web.server.Request instance @ 0xb9d1e8 <GET / HTTP/1.1>
Globals
webinterfaces   <module 'ratcontrol.web.webinterfaces' from
'C:\svn\RatControl\ratcontrol\web\webinterfaces.pyc'>
C:\Python23\Lib\site-packages\twisted\python\components.py, line 77 in
__call__
75
76    if adapter is _Nothing:
77      raise CannotAdapt("%s cannot be adapted to %s." %
78               (adaptable, self))
Locals
adaptable       
twisted.web.server.Session instance @ 0xbea710
<twisted.web.server.Session instance at 0x00BEA710>
adapter <class twisted.python.components._Nothing at 0x008EEED0>
self    <class 'ratcontrol.web.webinterfaces.IRatControlSession'>
Globals
_Nothing        <class twisted.python.components._Nothing at 0x008EEED0>
CannotAdapt     <class twisted.python.components.CannotAdapt at
0x008EEF30>

twisted.python.components.CannotAdapt: <twisted.web.server.Session
instance at 0x00BEA710> cannot be adapted to <class
'ratcontrol.web.webinterfaces.IRatControlSession'>.
-----

I'm not sure what I'm doing wrong here.  I looked through components.py
but still don't see what the problem is.

I've attached webinterfaces.py and session.py, setup similar to
quotient's respective files.  Also attached is pages.py which defines
wmfactory_action on MenuPage where I try to create an IRatControlSession
from request.getSession().

Any help you can provide is greatly appreciated.

Thanks.
-Justin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pages.py
Type: application/unknown
Size: 2722 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031002/18185caf/attachment-0006.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: session.py
Type: application/unknown
Size: 2428 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031002/18185caf/attachment-0007.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: webinterfaces.py
Type: application/unknown
Size: 2776 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031002/18185caf/attachment-0008.bin>

From foom at fuhm.net  Thu Oct  2 09:36:06 2003
From: foom at fuhm.net (James Y Knight)
Date: Thu, 2 Oct 2003 11:36:06 -0400
Subject: [Twisted-Python] Woven Model extreme pain
Message-ID: <239F5AE2-F4EE-11D7-B097-000A95A50FB2@fuhm.net>

Okay, so I'm having a few issues with Models.
I have code that looks like follows (request.dbpool does in fact exist 
in my code):

class DatabaseJunk(model.Model):
	def getData(self, request):
		return request.dbpool.runQuery("""select * from stuff""")

class Page(page.Page):
	templateFile = "main.html"
	isLeaf = 1
	wmfactory_db(self, request):
		return DatabaseJunk()

and, when i request in main.html the model be rendered like:
<span view="Text" model="/db" />
it gets apparently stuck in an infinite loop. getData keeps getting 
called over and over. What am I doing wrong? If I return a Deferred 
from wmfactory_db, it works fine, but not if I return one from getData.

My first thought was, maybe I should be using the "getter=" attr to the 
initializer instead of overriding getData (and thus using a cache), but 
when I tried that,  my code was never called at all. It seems that the 
cache is set to be initially valid, so the getter is never called!

Argh!

And this is on top of my problems yesterday where I was trying to 
return a Deferred from getSubmodel which excercises a code path that 
never gets called otherwise which looks like it should handle the case 
of a Deferred being returned but apparently has never been tested. I 
was apparently supposed to override submodelFactory() instead of 
getSubmodel, despite the fact that that isn't documented anywhere.

Argh!

James




From foom at fuhm.net  Thu Oct  2 11:42:52 2003
From: foom at fuhm.net (James Y Knight)
Date: Thu, 2 Oct 2003 13:42:52 -0400
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <239F5AE2-F4EE-11D7-B097-000A95A50FB2@fuhm.net>
Message-ID: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>

More ARRRRRRRRRRGGGGGGGH.

Returning a Deferred from submodelFactory doesn't seem to work 
*either*, if you then want to get a submodel of that.
E.g simplified:
	def result1(self, d):
		d.callback((1,3,4,5))
	
	def wmfactory_foo(self, request):
		d = defer.Deferred()
		reactor.callLater(1000000, self.result1, d)
		return d

If you then ask for a model="foo/0", twisted claims there is no such 
model, immediately. so it's not even trying to deal with the deferred. 
arrrrgh.

Is none of this tested? I can't believe I'm only person who wants to do 
this?

This is really making me want to give up. It seems nice but nothing 
works!

James




From glyph at twistedmatrix.com  Thu Oct  2 12:32:12 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 02 Oct 2003 14:32:12 -0400
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <3F7C128E.1060708@enginesofcreation.ie>
References: <87zngkwf4s.fsf@lutya.travishartwell.net> <3F7C128E.1060708@enginesofcreation.ie>
Message-ID: <3F7C6F2C.2010802@twistedmatrix.com>

Oisin Mulvihill wrote:
> I confess I really don't know how to handle the two deferred
> object that get returned by storeFile. I just add callback/
> errorback for each, this could be the problem.

If you want to wait for both, use twisted.internet.defer.DeferredList.

> Can anyone enlighten me as to what I'm doing wrong. I would
> really like to use proper async behavior for doing the uploads,
> instead of using threads + ftplib.

The FTP implementation in Twisted is sub-optimal (although that's mostly 
the server).  If you don't get any satisfactory responses I recommend 
assigning a bug to spiv in the tracker :).




From b.polen at comcast.net  Thu Oct  2 15:29:16 2003
From: b.polen at comcast.net (Benjamin Polen)
Date: Thu, 2 Oct 2003 17:29:16 -0400
Subject: [Twisted-Python] Can twisted serve java applets
Message-ID: <008801c3892c$3bcdb850$6400a8c0@shark.com>

Can twisted serve java applets, including those which use swing or awt?
Thanks
Ben
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031002/165313ea/attachment.html>

From b.polen at comcast.net  Thu Oct  2 16:16:47 2003
From: b.polen at comcast.net (Benjamin Polen)
Date: Thu, 2 Oct 2003 18:16:47 -0400
Subject: [Twisted-Python] Can I use twisted http server to serve java applets
Message-ID: <000201c38932$df370180$6400a8c0@shark.com>

I want to find out if it is possible to use twisted http server to serve
java applets to IE and Netscape.
Some of the applets I wish to use will contain the awt and swing java
libraries.  Is twisted http server 
of doing this?
I appreciate any helpful responses,
Ben
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031002/75313c5e/attachment.html>

From bob at redivi.com  Thu Oct  2 16:39:05 2003
From: bob at redivi.com (Bob Ippolito)
Date: Thu, 2 Oct 2003 18:39:05 -0400
Subject: [Twisted-Python] Can I use twisted http server to serve java applets
In-Reply-To: <000201c38932$df370180$6400a8c0@shark.com>
Message-ID: <3ACC1B39-F529-11D7-AEF6-000A95686CD8@redivi.com>


On Thursday, Oct 2, 2003, at 18:16 America/New_York, Benjamin Polen 
wrote:

> I want to find out if it is possible to use twisted http server to 
> serve java applets to IE and Netscape.
> Some of the applets I wish to use will contain the awt and swing java 
> libraries.  Is twisted http server
> of doing this?

I don't see any reason why not, from the web server's perspective an 
applet and whatever class libraries are just files.  Unless I'm missing 
something here?

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: text/enriched
Size: 685 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031002/71f5cb50/attachment-0002.bin>

From syver at inout.no  Fri Oct  3 02:32:00 2003
From: syver at inout.no (Syver Enstad)
Date: 03 Oct 2003 10:32:00 +0200
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
Message-ID: <uad8iu3gf.fsf@inout.no>

James Y Knight <foom at fuhm.net> writes:

> More ARRRRRRRRRRGGGGGGGH.
> 
> Returning a Deferred from submodelFactory doesn't seem to work
> *either*, if you then want to get a submodel of that.
> E.g simplified:
> 	def result1(self, d):
> 		d.callback((1,3,4,5))
> 	
> 	def wmfactory_foo(self, request):
> 		d = defer.Deferred()
> 		reactor.callLater(1000000, self.result1, d)
> 		return d
> 
> If you then ask for a model="foo/0", twisted claims there is no such
> model, immediately. so it's not even trying to deal with the
> deferred. arrrrgh.
> 
> Is none of this tested? I can't believe I'm only person who wants to
> do this?
> 
> This is really making me want to give up. It seems nice but nothing
> works!

I've also been down this road James. You can't tunnel through
deferreds in the submodel path, and you have to specify a view for the
deferred system to work.


Examples: 

All examples are just written from memory and are completely untested.

<span model="foo/0"></span> 
won't work because tunneling through the deferred is not supported

<span model="foo">
  <span model="0" view="Text"></span>
</span>
won't work because the default view, DefaultWidget doesn't support deferreds

<span model="foo" view="Widget">
  <span model="0" view="Text"></span>
</span>

should work because the Widget handles the deferred model and
postpones processing of child nodes until the deferred result is
ready.

All views that are derived from Widget (and doesn't override the
deferred handling in generate) should work:

<span model="foo" view="Text"></span>

or:

<span model="foo" view="List">
  <span pattern="listItem"></span>
</span>





From syver at inout.no  Fri Oct  3 02:47:41 2003
From: syver at inout.no (Syver Enstad)
Date: 03 Oct 2003 10:47:41 +0200
Subject: [Twisted-Python] woven authentications and connections.
Message-ID: <u4qyqu2qa.fsf@inout.no>

I am in the process of implementing authentication for an intranet
application using woven. I will be storing the login information in
the session. On each request I will connect to the database and pass
the connection to the page handling the request. How do I know when
the request is finished so that I can close the connection?





From oisin at enginesofcreation.ie  Fri Oct  3 04:18:28 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Fri, 03 Oct 2003 11:18:28 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
Message-ID: <3F7D4CF4.2050807@enginesofcreation.ie>

Hi,

Glyph Lefkowitz wrote:

> Oisin Mulvihill wrote:
>
>> I confess I really don't know how to handle the two deferred
>> object that get returned by storeFile. I just add callback/
>> errorback for each, this could be the problem.
>
>
> If you want to wait for both, use twisted.internet.defer.DeferredList.
>
Why are there two deferred objects returned by storeFile? The documentation
says:

storeFile (self ,path ):

    Store a file at the given path.

    This method issues the 'STOR' FTP command.

    Returns:

    A tuple of two Deferreds:
        
    * Deferred IFinishableConsumer . You must call the finish method on the
        IFinishableConsumer when the file is completely transferred.

    * Deferred list of  control-connection responses.

This really doesn't help me much. I get the impression that storeFile
isn't sending the contents of file, because its waiting for me to stream
the file contents somehow. Maybe via IFinishableConsumer?

In my current program, using ftplib, I do the following to upload a file:

    :
    ftp.storbinary('STOR %s' % (filename), fp)
    :

This has the filename and a file descriptor passed to it. Is something 
like this
needed with storeFile?

Please can someone give me an answer to this, as looking at the code for
twisted.protocols.ftp isn't helping much either. This function seems to be
a mystery to me and I want to understand how to use it properly.

Thanks,

om


>> Can anyone enlighten me as to what I'm doing wrong. I would
>> really like to use proper async behavior for doing the uploads,
>> instead of using threads + ftplib.
>
>
> The FTP implementation in Twisted is sub-optimal (although that's 
> mostly the server).  If you don't get any satisfactory responses I 
> recommend assigning a bug to spiv in the tracker :).
>

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540






From greg at digitalinfo.net  Fri Oct  3 05:45:00 2003
From: greg at digitalinfo.net (Greg)
Date: Fri, 03 Oct 2003 07:45:00 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <200310012347.h91NlHW04812@haddock.cd.chalmers.se>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se>
Message-ID: <3F7D613C.5020609@digitalinfo.net>

Thanks! In order to help others like me who were struggling with this, 
here's the working code. Please let me know if I did anything 
egregiously stupid here.

#!/usr/bin/env python
# Simple SMTP server shell

from twisted.internet import reactor, protocol, defer
from twisted.protocols import smtp

class MyMessage:
    __implements__ = (smtp.IMessage)
       
    def __init__(self):
        self.msg = []

    def lineReceived(self, line):
        self.msg.append(line)

    def eomReceived(self):
        # Handle message here
        for line in self.msg:
            print line
        self.msg = []
        return defer.succeed('<Whatever>')
   
class MyMessageDelivery:
    __implements__ = (smtp.IMessageDelivery)
   
    def validateFrom(self, helo, origin):
        return origin
       
    def validateTo(self, user):
        return MyMessage
       
    def receivedHeader(self, helo, origin, recipients):
        return None

class MySMTPFactory(smtp.SMTPFactory):
    def buildProtocol(self, addr):
        p = self.protocol(MyMessageDelivery())
        p.factory = self
        p.portal = self.portal
        p.host = "somedomain.com"
        return p   
       
factory = MySMTPFactory()
factory.protocol = smtp.SMTP
reactor.listenTCP(25, factory)
reactor.run()

Anders Hammarquist wrote:

>Hi Greg!
>
>In a message of Wed, 01 Oct 2003 17:20:17 EDT, Greg writes:
>  
>
>>Working on an SMTP filter (consisting of an SMTP server that receives 
>>messages, some code that mangles them, then and SMTP client that forwards 
>>them along). The first step is to get a functioning SMTP server working, and 
>>I'm having some trouble with SMTPFactory / SMTP. I've overloaded the validate 
>>methods in an attempt accept emails to and from any domain, but I can't 
>>figure out how to hook in a class that implements IMessageDelivery:
>>    
>>
>
>There are several problems with your code, but to my eye it looks like
>confusion between several methods of using the SMTP class. Until recently,
>the IMessageDelivery method didn't exists, and you needed to override
>SMTP to implement validateTo and validateFrom. Now, you can instead pass
>an IMessageDelivery to SMTP, either directly or using the authenticator
>(and if you do, you shouldn't need to subclass SMTP - and if your twisted
>is recent enough, you have to use the IMessageDelivery method).
>
>You do need to make your own factory though, since the one that's there
>doesn't deal with IMessageDelivery()s yet. Something like
>
>class MySMTPFactory(SMTPFactory):
>	def buildProtocol(self, addr):
>		p = self.protocol(MyMessageDelivery())
>		p.factory = self
>		p.portal = self.portal
>		p.host = self.domain
>		return p
>
>  
>
>>class MySMTPProtocol(SMTP):
>>    
>>
>[...]
>  
>
>>	def validateTo(self, user):
>>		d = defer.Deferred()
>>		reactor.callLater(0, self.fakeSucceed())
>>		return d
>>    
>>
>
>You don't need this code, but I still want to point out that it doesn't
>do anything useful, and is overcomplicated. 
>
>First, validateTo may return an IMessage or a deferred returning an
>IMessage, so you don't need the deferred, you can just return you
>IMessage directly. Secondly the deferred is never called, so it will
>never return, and thus your SMTP server stops here.
>
>reactor.callLater() just calls another function asynchrously and discards
>the result. If you want to pass back a result from a callLater, you need
>to pass along the deferred and call it in the function you callLater()ed.
>
>  
>
>>class MyIMessage:
>>	__implements__ = (smtp.IMessageDelivery)
>>    
>>
>
>You seem to have mixed up IMessage and IMessageDelivery. You need both.
>Your IMessageDelivery.validateTo() should return an IMessage (or a deferred
>returning an IMessage).
>
>HTH
>/Anders
>
>  
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031003/e009dbaa/attachment.html>

From dp at twistedmatrix.com  Fri Oct  3 10:15:07 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 3 Oct 2003 12:15:07 -0400
Subject: [Twisted-Python] Adapter troubles - Copying Quotient's DivmodSession
In-Reply-To: <20031002143039.784EB3D96E@www.fastmail.fm>
References: <20031002143039.784EB3D96E@www.fastmail.fm>
Message-ID: <C108B4E6-F5BC-11D7-87C4-000A95864FC4@twistedmatrix.com>

On Oct 2, 2003, at 10:30 AM, Justin Johnson wrote:

> Hi,
>
> I've created a class called RatControlSession similar to DivmodSession 
> in
> Quotient.  I define IRatControlSession and RatControlSession, and I
> register RatControlSession as an adapter from 
> twisted.web.server.Session
> to IRatControlSession.  However, when I try to do something like...
>
>     prefs = webinterfaces.IRatControlSession(request.getSession())
>
> I get the following error.  This is a cut-n-paste from what appears in
> the browser.

<snip exception>

> I'm not sure what I'm doing wrong here.  I looked through components.py
> but still don't see what the problem is.
>
> I've attached webinterfaces.py and session.py, setup similar to
> quotient's respective files.  Also attached is pages.py which defines
> wmfactory_action on MenuPage where I try to create an 
> IRatControlSession
> from request.getSession().

 From looking at the files, it looks like session is not getting 
imported anywhere. You would think it wouldn't be a problem since you 
are not directly using any of the objects in the module, but unless you 
import a module, the code at the top level of that module does not get 
executed. Thus the registerAdapter calls are never happening, and when 
you go to request an adapter none is registered. Try putting "import 
session" at the top of your pages file.

This is a major problem with using components and twisted -- where to 
register the adapters. Of course, the implementation of components as 
pioneered by Zope 3 uses a non-python file to register adapters (a zcml 
file, a form of XML) and twisted should have something similar 
(preferably not xml) but currently does not.

dp




From exarkun at intarweb.us  Fri Oct  3 10:43:50 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 3 Oct 2003 12:43:50 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <3F7D613C.5020609@digitalinfo.net>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se> <3F7D613C.5020609@digitalinfo.net>
Message-ID: <20031003164350.GA6738@intarweb.us>

On Fri, Oct 03, 2003 at 07:45:00AM -0400, Greg wrote:
> Thanks! In order to help others like me who were struggling with this, 
> here's the working code. Please let me know if I did anything 
> egregiously stupid here.
> 
> #!/usr/bin/env python
> # Simple SMTP server shell
> 
> from twisted.internet import reactor, protocol, defer
> from twisted.protocols import smtp
> 
> class MyMessage:
>    __implements__ = (smtp.IMessage)
>       
>    def __init__(self):
>        self.msg = []
> 
>    def lineReceived(self, line):
>        self.msg.append(line)
> 
>    def eomReceived(self):
>        # Handle message here
>        for line in self.msg:
>            print line
>        self.msg = []
>        return defer.succeed('<Whatever>')
>   
> class MyMessageDelivery:
>    __implements__ = (smtp.IMessageDelivery)
>   
>    def validateFrom(self, helo, origin):
>        return origin
>       
>    def validateTo(self, user):
>        return MyMessage

  You need to return an *instance* here.  You probably also want to
associate the user with the instance, too, since you won't be told again who
you're delivering for.  Changing MyMessage.__init__ to take a user argument
and returning "MyMessage(user)" might be a good way to go.

  The validateTo and validateFrom methods are your chance to refuse this
message.  "helo" and "origin" identify the source of the message.  "user"
identifies the destination.  If any of them are not to your liking, you
should raise smtp.SMTPBadRcpt or smtp.SMTPBadSender.

>       
>    def receivedHeader(self, helo, origin, recipients):
>        return None
> 
> class MySMTPFactory(smtp.SMTPFactory):
>    def buildProtocol(self, addr):
>        p = self.protocol(MyMessageDelivery())
>        p.factory = self
>        p.portal = self.portal
>        p.host = "somedomain.com"
>        return p   
>       
> factory = MySMTPFactory()
> factory.protocol = smtp.SMTP
> reactor.listenTCP(25, factory)
> reactor.run()
> 

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031003/7af48339/attachment.sig>

From dp at twistedmatrix.com  Fri Oct  3 10:49:27 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 3 Oct 2003 12:49:27 -0400
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <uad8iu3gf.fsf@inout.no>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net> <uad8iu3gf.fsf@inout.no>
Message-ID: <8CE9032D-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>

On Oct 3, 2003, at 4:32 AM, Syver Enstad wrote:

> James Y Knight <foom at fuhm.net> writes:
>
>> More ARRRRRRRRRRGGGGGGGH.

<snip>

I apologize. Woven's Deferred support is only very lightly tested 
because every application I have built in Woven has not been very 
deferred-heavy, and when I have had to use Deferreds I am able to use 
them because I wrote the code.

Writing code which handles Deferreds in every conceivable situation is 
very difficult because it makes the code more verbose and less linear. 
This is mostly due to Python's lack of a block syntax, and there's not 
a lot we can do about it. Woven supports deferreds by checking for 
Deferred results from two woven APIs:

Widget.generate

Controller.handle

If a Deferred is returned from either of these functions, Woven will 
not recurse into the DOM branch which the Widget or Controller was 
handling until the Deferred has fired. Woven will continue rendering 
the rest of the page, and when it gets to the end, if there are 
outstanding Deferreds, it will not send the page to the browser until 
these Deferred tasks have completed.

When a Deferred fires, Woven will then recurse into the DOM branch 
related to the Deferred. If a DOM node below that one contains a 
directive which produces a Widget or Controller which returns a 
Deferred, the process will be repeated.

This is basically how Woven's Deferred support works.

The first thing Widget.generate does is call Model.getData. If 
Model.getData returns a Deferred, it will add a callback to it which 
continues the Widget rendering process when the Deferred has fired.

This is why the layout described below by Syver is required. There is 
no support for Deferreds in lookupSubmodel (the code which parses 
model="foo/bar")

Also, the IModel interface was designed about a year and a half ago, at 
the very beginning of DOMTemplate and WebMVC development. It turned out 
to be a fairly cumbersome API to use (one which only existed because of 
python's lack of the concept of a handle) and after Glyph wrote 
submodelFactory and MethodModel, I have mostly relied on using that.

> I've also been down this road James. You can't tunnel through
> deferreds in the submodel path, and you have to specify a view for the
> deferred system to work.
>
>
> Examples:

<snip>

All of these examples and explanations seem correct. The fact that such 
an elaborate dance is required I would consider a bug, but 
unfortunately I don't have a lot of time for core woven development 
right now.

Woven was developed over the course of a year, in my spare time, while 
I had a day job.

Now that woven is stable enough for me to use, I have slowed 
development on it because it enables me to get my paying work done, and 
a lot of the quirks in the API don't bother me because I know enough to 
avoid them.

While I believe the core ideas behind Woven are very good, a lot of the 
implementation details are more complicated than they should be (as you 
have noticed). I would very much like to do a ground-up rewrite which 
would simplify the way things work greatly while still supporting the 
best ideas from the current Woven and as much backwards-compatibility 
as is feasible.

I don't have the time to do a ground-up rewrite right now and still get 
paid to do my regular, day job.

Since woven is now good enough to develop very large, complicated web 
applications with, other people have started showing far more interest 
in it. Unfortunately, not everyone has the experience with the internal 
details of Woven to know what to try and what to avoid. Probably the 
best way to proceed in the short term is to come up with some sort of 
"Best practices" documentation which describes how best to get your 
work done with Woven while avoiding pain.

dp




From dp at twistedmatrix.com  Fri Oct  3 10:52:39 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 3 Oct 2003 12:52:39 -0400
Subject: [Twisted-Python] woven authentications and connections.
In-Reply-To: <u4qyqu2qa.fsf@inout.no>
References: <u4qyqu2qa.fsf@inout.no>
Message-ID: <FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>

On Oct 3, 2003, at 4:47 AM, Syver Enstad wrote:

>
> I am in the process of implementing authentication for an intranet
> application using woven. I will be storing the login information in
> the session. On each request I will connect to the database and pass
> the connection to the page handling the request. How do I know when
> the request is finished so that I can close the connection?

Overriding Page.pageRenderComplete should be what you want.

dp




From exarkun at intarweb.us  Fri Oct  3 10:59:23 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 3 Oct 2003 12:59:23 -0400
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <3F7D4CF4.2050807@enginesofcreation.ie>
References: <3F7D4CF4.2050807@enginesofcreation.ie>
Message-ID: <20031003165923.GB6738@intarweb.us>

On Fri, Oct 03, 2003 at 11:18:28AM +0100, Oisin Mulvihill wrote:
> Hi,
> 
> [snip]
> Why are there two deferred objects returned by storeFile? The documentation
> says:
> 
> storeFile (self ,path ):
> 
>    Store a file at the given path.
> 
>    This method issues the 'STOR' FTP command.
> 
>    Returns:
> 
>    A tuple of two Deferreds:
>        
>    * Deferred IFinishableConsumer . You must call the finish method on the
>        IFinishableConsumer when the file is completely transferred.
> 
>    * Deferred list of  control-connection responses.
> 
> This really doesn't help me much. I get the impression that storeFile
> isn't sending the contents of file, because its waiting for me to stream
> the file contents somehow. Maybe via IFinishableConsumer?

  Correct, I believe.  It looks like you can use FileSender (from t.p.basic)
if you're just sending something off disk (or from any file object, really)
here.

> 
> In my current program, using ftplib, I do the following to upload a file:
> 
>    :
>    ftp.storbinary('STOR %s' % (filename), fp)
>    :
> 
> This has the filename and a file descriptor passed to it. Is something
> like this needed with storeFile?
> 
> Please can someone give me an answer to this, as looking at the code for
> twisted.protocols.ftp isn't helping much either. This function seems to be
> a mystery to me and I want to understand how to use it properly.
> 

  Try...

    from twisted.protocols.basic import FileSender

    def sendfile(consumer, fileObj):
        s = FileSender()
        return s.beginFileTransfer(fileObj, consumer
            ).addCallback(lambda _: consumer.finish()
            )

    dC, dL = p.storeFile("path")
    dC.addCallback(sendfile, fileObj)

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031003/34d2abe8/attachment.sig>

From greg at digitalinfo.net  Fri Oct  3 11:27:47 2003
From: greg at digitalinfo.net (Greg)
Date: Fri, 03 Oct 2003 13:27:47 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <20031003164350.GA6738@intarweb.us>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se> <3F7D613C.5020609@digitalinfo.net> <20031003164350.GA6738@intarweb.us>
Message-ID: <3F7DB193.2090605@digitalinfo.net>

Actually, I tried returning an instance (i.e. "return MyMessage()" ) 
here on my first shot at this, but I got:

File "/usr/lib/python2.2/site-packages/twisted/protocols/smtp.py", line 
672, i
n do_DATA
    self.__messages = [f() for (u, f) in recipients]
exceptions.AttributeError: MyMessage instance has no __call__ method

FYI I'm using Twisted 1.07.

Jp Calderone wrote:

>>   def validateTo(self, user):
>>       return MyMessage
>>    
>>
>
>  You need to return an *instance* here.  You probably also want to
>associate the user with the instance, too, since you won't be told again who
>you're delivering for.  Changing MyMessage.__init__ to take a user argument
>and returning "MyMessage(user)" might be a good way to go.
>
>  The validateTo and validateFrom methods are your chance to refuse this
>message.  "helo" and "origin" identify the source of the message.  "user"
>identifies the destination.  If any of them are not to your liking, you
>should raise smtp.SMTPBadRcpt or smtp.SMTPBadSender.
>  
>




From exarkun at intarweb.us  Fri Oct  3 20:04:03 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 3 Oct 2003 22:04:03 -0400
Subject: [Twisted-Python] smtp.SMTP help
In-Reply-To: <3F7DB193.2090605@digitalinfo.net>
References: <200310011720.17355.greg@digitalinfo.net> <200310012347.h91NlHW04812@haddock.cd.chalmers.se> <3F7D613C.5020609@digitalinfo.net> <20031003164350.GA6738@intarweb.us> <3F7DB193.2090605@digitalinfo.net>
Message-ID: <20031004020403.GA9642@intarweb.us>

On Fri, Oct 03, 2003 at 01:27:47PM -0400, Greg wrote:
> Actually, I tried returning an instance (i.e. "return MyMessage()" ) 
> here on my first shot at this, but I got:
> 
> File "/usr/lib/python2.2/site-packages/twisted/protocols/smtp.py", line 
> 672, i
> n do_DATA
>    self.__messages = [f() for (u, f) in recipients]
> exceptions.AttributeError: MyMessage instance has no __call__ method

  Woops, sorry.  It needs to be a *callable* that returns an instance.  So
the class is fine, if you don't need to associate the user with it,
otherwise "lambda: MyMessage(user)" is probably the way to go.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031003/f38ec3df/attachment.sig>

From grib at billgribble.com  Fri Oct  3 06:26:56 2003
From: grib at billgribble.com (Bill Gribble)
Date: Fri, 03 Oct 2003 07:26:56 -0500
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <uad8iu3gf.fsf@inout.no>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
	 <uad8iu3gf.fsf@inout.no>
Message-ID: <1065184016.29252.15.camel@serrano>

On Fri, 2003-10-03 at 03:32, Syver Enstad wrote:
> <span model="foo" view="Widget">
>   <span model="0" view="Text"></span>
> </span>
> 
> should work because the Widget handles the deferred model and
> postpones processing of child nodes until the deferred result is
> ready.

Could you elaborate on this a little?  I want to do this too (defer
rendering in Woven) and I use Widget subclasses everywhere.   At what
point is it OK to produce a Deferred?  

The only method I override in my Widget subclasses is setUp.   In my
top-level Page subclass I have a single wvfactory_ method for a special
View I use, and a getDynamicChild to fetch children (in this case, all
the children are dynamic).

Are you suggesting that I return a Deferred instead of a View from the
wvfactory_ method?  Or that I return a Deferred from the getDynamicChild
method?  Or what? 

Thanks,
b.g.







From greg at digitalinfo.net  Sat Oct  4 13:54:42 2003
From: greg at digitalinfo.net (Greg)
Date: Sat, 4 Oct 2003 15:54:42 -0400
Subject: [Twisted-Python] shut down only half the connection?
Message-ID: <200310041554.42486.greg@digitalinfo.net>

Using internet.protocol Protocol, is it is possible to close only the writing 
half of a connection, like would be done with "shutdown(1)" using the Python 
Socket module? transport.loseConnection() seems to close down the connection 
alltogether, at which point Protocol.dataReceived() never gets called. 
Thanks. 




From itamar at itamarst.org  Sat Oct  4 14:01:16 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 4 Oct 2003 16:01:16 -0400
Subject: [Twisted-Python] shut down only half the connection?
In-Reply-To: <200310041554.42486.greg@digitalinfo.net>
References: <200310041554.42486.greg@digitalinfo.net>
Message-ID: <20031004160116.10ba556f.itamar@itamarst.org>

On Sat, 4 Oct 2003 15:54:42 -0400
Greg <greg at digitalinfo.net> wrote:

> Using internet.protocol Protocol, is it is possible to close only the
> writing half of a connection, like would be done with "shutdown(1)"
> using the Python Socket module? transport.loseConnection() seems to
> close down the connection alltogether, at which point
> Protocol.dataReceived() never gets called. Thanks. 

It is not possible at the moment. There's an issue in the bug tracker
about this, eventually it will be supported.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Sat Oct  4 17:13:48 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 4 Oct 2003 19:13:48 -0400
Subject: [Twisted-Python] shut down only half the connection?
In-Reply-To: <200310041554.42486.greg@digitalinfo.net>
References: <200310041554.42486.greg@digitalinfo.net>
Message-ID: <20031004231348.GA13683@intarweb.us>

On Sat, Oct 04, 2003 at 03:54:42PM -0400, Greg wrote:
> Using internet.protocol Protocol, is it is possible to close only the writing 
> half of a connection, like would be done with "shutdown(1)" using the Python 
> Socket module? transport.loseConnection() seems to close down the connection 
> alltogether, at which point Protocol.dataReceived() never gets called. 
> Thanks. 
> 

  Out of curiousity, what's your use case?

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031004/b30f77ab/attachment.sig>

From greg at digitalinfo.net  Sun Oct  5 05:04:58 2003
From: greg at digitalinfo.net (Greg)
Date: Sun, 5 Oct 2003 07:04:58 -0400
Subject: [Twisted-Python] shut down only half the connection?
In-Reply-To: <20031004231348.GA13683@intarweb.us>
References: <200310041554.42486.greg@digitalinfo.net> <20031004231348.GA13683@intarweb.us>
Message-ID: <200310050704.58847.greg@digitalinfo.net>

Talking to Spamassassin's spamd. The way the client specifies that it is done 
sending a message to the daemon is by closing the connection for writing.  
(see http://www.spamassassin.org/full/2.5x/dist/spamd/README.spamd for 
protocol details).

In this case I was able to easily work around the issue by adding an "End Of 
Message" command to spamd (gotta love open source).

> On Sat, Oct 04, 2003 at 03:54:42PM -0400, Greg wrote:
> > Using internet.protocol Protocol, is it is possible to close only the
> > writing half of a connection, like would be done with "shutdown(1)" using
> > the Python Socket module? transport.loseConnection() seems to close down
> > the connection alltogether, at which point Protocol.dataReceived() never
> > gets called. Thanks.
>
>   Out of curiousity, what's your use case?
>
>   Jp




From mporter at despammed.com  Sun Oct  5 13:46:51 2003
From: mporter at despammed.com (Michael Porter)
Date: Sun, 5 Oct 2003 20:46:51 +0100
Subject: [Twisted-Python] Twisted powered network jukebox
Message-ID: <004a01c38b79$6ccbdff0$0201a8c0@dan>

Hi,

I've just uploaded the first public version of mpJuke, a network jukebox
I've been working on. If you're interested take a look at the website:

    http://www.mpweb.dsl.pipex.com/

Its written in Python using Twisted, wxPython and pySQLite. In theory it
should be cross-platform but I have only tested it on Windows 2000 so far.
It's released under the GPL.

Windows users can download the binary installer which contains a frozen
version created with Anthony Tuininga's cx_Freeze utility. This should run
without any further requirements.

Users on other platforms will need to download the source code and ensure
they have the other dependencies available. Then run "mpjukegui.py" to start
up the server or "mpjukegui.py catalogue" to start the "Catalogue Creator".

Let me know what you think.

Thanks,

Michael Porter.






From bob at redivi.com  Sun Oct  5 14:34:54 2003
From: bob at redivi.com (Bob Ippolito)
Date: Sun, 5 Oct 2003 16:34:54 -0400
Subject: [Twisted-Python] Twisted powered network jukebox
In-Reply-To: <004a01c38b79$6ccbdff0$0201a8c0@dan>
Message-ID: <606FEAB8-F773-11D7-AAA7-000A95686CD8@redivi.com>

On Sunday, Oct 5, 2003, at 15:46 America/New_York, Michael Porter wrote:

> Hi,
>
> I've just uploaded the first public version of mpJuke, a network 
> jukebox
> I've been working on. If you're interested take a look at the website:
>
>     http://www.mpweb.dsl.pipex.com/
>
> Its written in Python using Twisted, wxPython and pySQLite. In theory 
> it
> should be cross-platform but I have only tested it on Windows 2000 so 
> far.
> It's released under the GPL.
>
> Windows users can download the binary installer which contains a frozen
> version created with Anthony Tuininga's cx_Freeze utility. This should 
> run
> without any further requirements.
>
> Users on other platforms will need to download the source code and 
> ensure
> they have the other dependencies available. Then run "mpjukegui.py" to 
> start
> up the server or "mpjukegui.py catalogue" to start the "Catalogue 
> Creator".

Very cool.  I'll probably port this to OS X sometime in the near 
future.  Also, I have some almost-complete code lying dormant that does 
iTunes music sharing (server and client) that might be useful for this 
project.

-bob




From syver at inout.no  Mon Oct  6 02:07:25 2003
From: syver at inout.no (Syver Enstad)
Date: 06 Oct 2003 10:07:25 +0200
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <1065184016.29252.15.camel@serrano>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
	<uad8iu3gf.fsf@inout.no> <1065184016.29252.15.camel@serrano>
Message-ID: <u7k3in60y.fsf@inout.no>

Bill Gribble <grib at billgribble.com> writes:

> On Fri, 2003-10-03 at 03:32, Syver Enstad wrote:
> > <span model="foo" view="Widget">
> >   <span model="0" view="Text"></span>
> > </span>
> > 
> > should work because the Widget handles the deferred model and
> > postpones processing of child nodes until the deferred result is
> > ready.
> 
> Could you elaborate on this a little?  I want to do this too (defer
> rendering in Woven) and I use Widget subclasses everywhere.   At what
> point is it OK to produce a Deferred?  

As the return value from a wmfactory_method and as Donovan mentions
that implies also as the return value from getData but I haven't done
that explicitly.

Example:

...MyPage...
def wmfactory_myList(self, request):
    deferred = defer.Deferred()
    reactor.callLater(2, deferred.callback, [1, 2, 3])
    return deferred

<span model="myList" view="Widget">
  <span model="0" view="Text"></span>
  <span model="1" view="Text"></span>
  <span model="2" view="Text"></span>
</span>

Or with a List widget

<span model="myList" view="List">
  <span pattern="listItem" view="Text"></span>
</span>



> The only method I override in my Widget subclasses is setUp.   In my
> top-level Page subclass I have a single wvfactory_ method for a special
> View I use, and a getDynamicChild to fetch children (in this case, all
> the children are dynamic).

Then I think you will be home free, because you don't override
generate.

> Are you suggesting that I return a Deferred instead of a View from the
> wvfactory_ method?  Or that I return a Deferred from the getDynamicChild
> method?  Or what? 

None of the above, what I tried to explain was that Widget.generate
handles deferred models. I don't think there is any support for
deferred page's or views, just models. This means that if you need
deferreds you have to use a model for that. This makes sense because
you should not put data in your view classes, because then they are
not views anymore.




From syver at inout.no  Mon Oct  6 02:17:36 2003
From: syver at inout.no (Syver Enstad)
Date: 06 Oct 2003 10:17:36 +0200
Subject: [Twisted-Python] woven authentications and connections.
In-Reply-To: <FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>
References: <u4qyqu2qa.fsf@inout.no>
	<FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>
Message-ID: <u3ce6n5jz.fsf@inout.no>

Donovan Preston <dp at twistedmatrix.com> writes:

> On Oct 3, 2003, at 4:47 AM, Syver Enstad wrote:
> 
> >
> > I am in the process of implementing authentication for an intranet
> > application using woven. I will be storing the login information in
> > the session. On each request I will connect to the database and pass
> > the connection to the page handling the request. How do I know when
> > the request is finished so that I can close the connection?
> 
> Overriding Page.pageRenderComplete should be what you want.

Thanks, I found another way by calling request.notifyFinished which
returns a deferred, I then add a callback to that deferred and it
seems to work fine. *The following is not a rethorical question, I am
just curious.* In what way is overriding Controller.pageRenderComplete
superior to my solution?




From golux at comcast.net  Mon Oct  6 02:27:29 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Mon, 06 Oct 2003 04:27:29 -0400
Subject: [Twisted-Python] Still "totally, totally broken" ?
Message-ID: <3F812771.6070703@comcast.net>

Just curious -- this is line 436 et seq. in the CVS version of
t.i.defer.gatherResults ...

     if fireOnOneErrback:
         raise "This function was previously totally, totally broken.  Please fix your code to 
behave as documented."

Anyone know if this is still the case?

- Steve.




From rudy.schockaert at pandora.be  Mon Oct  6 05:03:38 2003
From: rudy.schockaert at pandora.be (Rudy Schockaert)
Date: Mon, 06 Oct 2003 13:03:38 +0200
Subject: [Twisted-Python] Twisted.Names question
Message-ID: <3F814C0A.8090704@pandora.be>

How can I return a referral to another server when I cannot resolve the 
query myself?

My setup would be as follows:
I have a Twisted Names master server and a  number of Twisted Names 
slave servers.
The master server is only to be used by the DNS clients when the slave 
server is not available.
The Twisted Names servers can only answer very specific queries. All 
other responses have to come from the Internet.

My idea is to configure the clients as follows:

Primary DNS server: Twisted Names Slave
Secondary DNS server: Twisted Names Master
Tertiary DNS server: Internet DNS server

I have to configure the Twisted Names Master as secondary for 
resilience, but the client should only call him when the the Twisted 
Names Slave doesn't respond and not when it doesn't have the answer.

Rudy






From grib at billgribble.com  Mon Oct  6 07:06:43 2003
From: grib at billgribble.com (Bill Gribble)
Date: Mon, 06 Oct 2003 08:06:43 -0500
Subject: [Twisted-Python] Woven Model extreme pain
In-Reply-To: <u7k3in60y.fsf@inout.no>
References: <D93CC0D7-F4FF-11D7-8EB8-000A95A50FB2@fuhm.net>
	 <uad8iu3gf.fsf@inout.no> <1065184016.29252.15.camel@serrano>
	 <u7k3in60y.fsf@inout.no>
Message-ID: <1065445603.20880.7.camel@serrano>

On Mon, 2003-10-06 at 03:07, Syver Enstad wrote:
> As the return value from a wmfactory_method and as Donovan mentions
> that implies also as the return value from getData but I haven't done
> that explicitly.

Thanks.  It's actually in the Woven HOWTO that you can return a Deferred
from a model getData, and that's what I ended up doing.  It works great.

b.g.
 




From syver at inout.no  Mon Oct  6 07:43:10 2003
From: syver at inout.no (Syver Enstad)
Date: 06 Oct 2003 15:43:10 +0200
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
Message-ID: <ud6dalbwx.fsf@inout.no>

As I was saying on the list I am making a login system with woven, and
the way to autheticate the user is by doing a pb call. 

So I thought one way to do it would be to:

Have a root page that displays a login form, on postback make a
pb.IdentityConnector and call requestService to obtain a reference or
onErrback report back to the user that the login attempt failed.

I have tried two approaches...

Put the login in the wchild or
getDynamicChild methods on the login page:

This seems okay because it is easy to redirect to the login page if
the login fails, but it seems to have no support for deferreds and I
don't know if the user is correctly logged in or not until I get a
callback on the deferred returned from pb.

Put the login on the only place I know that accepts deferreds, in the
a wmfactory_ method on the login page:

I get the deferred result okay but I don't know how to do a redirect
from there.

Should I use a plain Resource rather than a woven page for this kind
of problem?





From radix at twistedmatrix.com  Mon Oct  6 07:55:53 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 6 Oct 2003 09:55:53 -0400
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <ud6dalbwx.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no>
Message-ID: <20031006135553.GA1103@radii>

On Mon, Oct 06, 2003 at 03:43:10PM +0200, Syver Enstad wrote:
> As I was saying on the list I am making a login system with woven, and
> the way to autheticate the user is by doing a pb call. 

Sounds like you need to be using twisted.web.woven.guard, and use it
with a CredentialsChecker (that you write) that does the PB
communication. You can see how to do this by reading
twisted/cred/checkers.py, it is simple.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From grib at billgribble.com  Mon Oct  6 08:02:11 2003
From: grib at billgribble.com (Bill Gribble)
Date: Mon, 06 Oct 2003 09:02:11 -0500
Subject: [Twisted-Python] Woven subpage handling redirect deferred,
	Help!?!
In-Reply-To: <ud6dalbwx.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no>
Message-ID: <1065448930.20878.15.camel@serrano>

On Mon, 2003-10-06 at 08:43, Syver Enstad wrote:
> Should I use a plain Resource rather than a woven page for this kind
> of problem?

I'm not using PB for auth (homebrew using the app's SQL db) but I think
the general approach could be the same. 

I have a separate Resource that is the top-level entry point of the
app.  Its getChild method checks that the proper credentials are
associated with the Session and if not redirects to the login page.  The
handlers on the login page are responsible for setting up the
credentials in the Session. 

This works well for me.  The "gatekeeper" Resource is like 20 lines of
code and keeps the page logic from having to know about the
authentication scheme. 

b.g.





From itamar at itamarst.org  Mon Oct  6 08:37:33 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 10:37:33 -0400
Subject: [Twisted-Python] Woven subpage handling redirect deferred,
 Help!?!
In-Reply-To: <ud6dalbwx.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no>
Message-ID: <20031006103733.1603e90d.itamar@itamarst.org>

On 06 Oct 2003 15:43:10 +0200
Syver Enstad <syver at inout.no> wrote:

> Have a root page that displays a login form, on postback make a
> pb.IdentityConnector and call requestService to obtain a reference or
> onErrback report back to the user that the login attempt failed.

Note that identities are deprecated. PB now uses the
checker/credential/portal cred system. Hopefully docs will be in next
release.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Mon Oct  6 08:38:54 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 10:38:54 -0400
Subject: [Twisted-Python] Still "totally, totally broken" ?
In-Reply-To: <3F812771.6070703@comcast.net>
References: <3F812771.6070703@comcast.net>
Message-ID: <20031006103854.1d97cccd.itamar@itamarst.org>

On Mon, 06 Oct 2003 04:27:29 -0400
"Stephen C. Waterbury" <golux at comcast.net> wrote:

> Just curious -- this is line 436 et seq. in the CVS version of
> t.i.defer.gatherResults ...
> 
>      if fireOnOneErrback:
>          raise "This function was previously totally, totally broken. 
>          Please fix your code to 
> behave as documented."

That should probably say "don't use fireOnOneErrback with
gatherResults".

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From dp at twistedmatrix.com  Mon Oct  6 08:36:32 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 6 Oct 2003 10:36:32 -0400
Subject: [Twisted-Python] woven authentications and connections.
In-Reply-To: <u3ce6n5jz.fsf@inout.no>
References: <u4qyqu2qa.fsf@inout.no> <FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com> <u3ce6n5jz.fsf@inout.no>
Message-ID: <7AEE77A0-F80A-11D7-AA48-000A95864FC4@twistedmatrix.com>

On Oct 6, 2003, at 4:17 AM, Syver Enstad wrote:

> Donovan Preston <dp at twistedmatrix.com> writes:
>
>> On Oct 3, 2003, at 4:47 AM, Syver Enstad wrote:
>>
>>>
>>> I am in the process of implementing authentication for an intranet
>>> application using woven. I will be storing the login information in
>>> the session. On each request I will connect to the database and pass
>>> the connection to the page handling the request. How do I know when
>>> the request is finished so that I can close the connection?
>>
>> Overriding Page.pageRenderComplete should be what you want.
>
> Thanks, I found another way by calling request.notifyFinished which
> returns a deferred, I then add a callback to that deferred and it
> seems to work fine. *The following is not a rethorical question, I am
> just curious.* In what way is overriding Controller.pageRenderComplete
> superior to my solution?

It's not. Your solution is superior. :-) Thanks for pointing it out.

dp




From mporter at despammed.com  Mon Oct  6 13:44:02 2003
From: mporter at despammed.com (Michael Porter)
Date: Mon, 6 Oct 2003 20:44:02 +0100
Subject: [Twisted-Python] Twisted powered network jukebox
References: <606FEAB8-F773-11D7-AAA7-000A95686CD8@redivi.com>
Message-ID: <003101c38c42$32335160$0201a8c0@dan>

----- Original Message -----
From: "Bob Ippolito" <bob at redivi.com>
To: <twisted-python at twistedmatrix.com>
Sent: Sunday, October 05, 2003 9:34 PM
Subject: Re: [Twisted-Python] Twisted powered network jukebox


>
> On Sunday, Oct 5, 2003, at 15:46 America/New_York, Michael Porter wrote:
>
> > Hi,
> >
> > I've just uploaded the first public version of mpJuke, a network
> > jukebox
> > I've been working on. If you're interested take a look at the website:
> >
> >     http://www.mpweb.dsl.pipex.com/
> >
> > Its written in Python using Twisted, wxPython and pySQLite. In theory
> > it
> > should be cross-platform but I have only tested it on Windows 2000 so
> > far.
> > It's released under the GPL.
> >
> > Windows users can download the binary installer which contains a frozen
> > version created with Anthony Tuininga's cx_Freeze utility. This should
> > run
> > without any further requirements.
> >
> > Users on other platforms will need to download the source code and
> > ensure
> > they have the other dependencies available. Then run "mpjukegui.py" to
> > start
> > up the server or "mpjukegui.py catalogue" to start the "Catalogue
> > Creator".
>
> Very cool.  I'll probably port this to OS X sometime in the near
> future.  Also, I have some almost-complete code lying dormant that does
> iTunes music sharing (server and client) that might be useful for this
> project.
>
> -bob
>

Glad you like it. OS X version would be good and I guess should be
relatively easy to port assuming the packages it requires are available.

Mike.




From smurf at smurf.noris.de  Mon Oct  6 14:11:42 2003
From: smurf at smurf.noris.de (Matthias Urlichs)
Date: Mon, 06 Oct 2003 22:11:42 +0200
Subject: [Twisted-Python] callFromThread with return
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no> <20030918102904.GA13575@frobozz>
Message-ID: <pan.2003.10.06.20.11.41.343421@smurf.noris.de>

Hi, Andrew Bennetts wrote:

>          But how does the                          .
>      Main Thread pass a result                     .
>        to Worker Thread and                        .
>        resume its execution?                       ?

Just put it in a Queue and wait on it in the thread. Standard Python.

-- 
Matthias Urlichs   |   {M:U} IT Design @ m-u-it.de   |  smurf at smurf.noris.de
Disclaimer: The quote was selected randomly. Really. | http://smurf.noris.de
 - -
The Second Commandment of Frisbee: The higher the quality of a catch or the
comment it receives, the greater the probability of a crummy throw. (Good
catch = bad throw.)
					-- Dan Roddick




From bob at redivi.com  Mon Oct  6 14:15:15 2003
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 6 Oct 2003 16:15:15 -0400
Subject: [Twisted-Python] Twisted powered network jukebox
In-Reply-To: <003101c38c42$32335160$0201a8c0@dan>
Message-ID: <CC6F75D6-F839-11D7-AAA7-000A95686CD8@redivi.com>

On Monday, Oct 6, 2003, at 15:44 America/New_York, Michael Porter wrote:

> ----- Original Message -----
> From: "Bob Ippolito" <bob at redivi.com>
> To: <twisted-python at twistedmatrix.com>
> Sent: Sunday, October 05, 2003 9:34 PM
> Subject: Re: [Twisted-Python] Twisted powered network jukebox
>
>> On Sunday, Oct 5, 2003, at 15:46 America/New_York, Michael Porter 
>> wrote:
>>
>>> I've just uploaded the first public version of mpJuke, a network
>>> jukebox
>>> I've been working on. If you're interested take a look at the 
>>> website:
>>>
>>>     http://www.mpweb.dsl.pipex.com/
>>
>> Very cool.  I'll probably port this to OS X sometime in the near
>> future.  Also, I have some almost-complete code lying dormant that 
>> does
>> iTunes music sharing (server and client) that might be useful for this
>> project.
>
> Glad you like it. OS X version would be good and I guess should be
> relatively easy to port assuming the packages it requires are 
> available.

The packages are all available.  I'd probably end up wanting to rewrite 
the GUI in PyObjC/Cocoa because wxPython is slow and a bit buggy, and 
more likely than not I'd also want to factor out the ResourcePackage 
thing and use the native OS X way of doing it (bundles with localizable 
resources) instead.. ResourcePackage is probably only used in the GUI 
layer anyways, right?

-bob




From ted at powersdk.com  Mon Oct  6 13:20:59 2003
From: ted at powersdk.com (Ted Patrick)
Date: Mon, 6 Oct 2003 15:20:59 -0400
Subject: [Twisted-Python] Web server persistance
Message-ID: <000601c38c3e$fa5ee590$6401a8c0@ISLAND>

I have a project using Twisted as an http server. 

What is the best way to persistent server data across server start/stop? 

Example:
While the server is running, a user will add virtual directories via a .rpy
application as follows:

root.putChild(name, path)

Ideally modifications to the server configuration would persist across
server start/stop. I would also like a generic format to store data related
to a particular leaf of an application as follows:

//url  http://mytwisted/dog/cat/document.txt
//data pertaining to this url could be added at
root.dog.cat.document.txt = 33

This data would also be persistent.

Thanks in advance.

Theodore E. Patrick
PowerSDK - Code for a distributed world
http://www.powersdk.com
 




From anders at bruun-olsen.net  Mon Oct  6 15:04:22 2003
From: anders at bruun-olsen.net (Anders Bruun Olsen)
Date: Mon, 6 Oct 2003 23:04:22 +0200
Subject: [Twisted-Python] SSH client bad packet length
Message-ID: <20031006210433.GB28465@elmer.skumleren.net>

Hi,

I am trying to learn a bit of Twisted in order to make an app that will
use SSH for running commands on remote hosts. I have followed the SSH
howto on the homepage where I have changed it to accept any fingerprint
and have put my own private and public keys in instead of the ones from
the example and have it connecting to a server of mine that accepts
passwordless key-auth. Lastly I have enabled logging to stdout (it might
be an idea to add to the howto which module to import to get the log
object!).

When it connects this is the output I get:

drzero at ernest pyssh-stuff $ ./sshsimpleclient.py
2003/10/06 22:31 CEST [-] Log opened.
2003/10/06 22:31 CEST [-] Starting factory <twisted.internet.protocol.ClientFactory instance at 0x8323b0c>
2003/10/06 22:31 CEST [ClientTransport,client] kex alg, key alg: diffie-hellman-group-exchange-sha1 ssh-rsa
2003/10/06 22:31 CEST [ClientTransport,client] client->server: aes256-ctr hmac-sha1 none
2003/10/06 22:31 CEST [ClientTransport,client] server->client: aes256-ctr hmac-sha1 none
2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
        reason: bad packet length 415956278
2003/10/06 22:31 CEST [ClientTransport,client] connection lost
2003/10/06 22:31 CEST [ClientTransport,client] Stopping factory <twisted.internet.protocol.ClientFactory instance at 0x8323b0c>
2003/10/06 22:32 CEST [-] Main loop terminated.


Note that the packet length changes..

Is it a problem in my code (which is basically the howto code) or a
problem with my server (Gentoo w/ OpenSSH 3.7.1p2) or something else?

-- 
Anders
-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GCS/O d--@ s:+ a-- C++ UL+++$ P++ L+++ E- W+ N(+) o K? w O-- M- V
PS+ PE@ Y+ PGP+ t 5 X R+ tv+ b++ DI+++ D+ G e- h !r y?
------END GEEK CODE BLOCK------
PGPKey: http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x8BFECB41



From z3p at twistedmatrix.com  Mon Oct  6 15:13:40 2003
From: z3p at twistedmatrix.com (Paul Swartz)
Date: 06 Oct 2003 17:13:40 -0400
Subject: [Twisted-Python] SSH client bad packet length
In-Reply-To: <20031006210433.GB28465@elmer.skumleren.net>
References: <20031006210433.GB28465@elmer.skumleren.net>
Message-ID: <1065474821.770.4.camel@petra>

On Mon, 2003-10-06 at 17:04, Anders Bruun Olsen wrote:
> Hi,
> 
> I am trying to learn a bit of Twisted in order to make an app that will
> use SSH for running commands on remote hosts. I have followed the SSH
> howto on the homepage where I have changed it to accept any fingerprint
> and have put my own private and public keys in instead of the ones from
> the example and have it connecting to a server of mine that accepts
> passwordless key-auth. Lastly I have enabled logging to stdout (it might
> be an idea to add to the howto which module to import to get the log
> object!).
> 
> When it connects this is the output I get:
> 
> drzero at ernest pyssh-stuff $ ./sshsimpleclient.py
> 2003/10/06 22:31 CEST [-] Log opened.
> 2003/10/06 22:31 CEST [-] Starting factory <twisted.internet.protocol.ClientFactory instance at 0x8323b0c>
> 2003/10/06 22:31 CEST [ClientTransport,client] kex alg, key alg: diffie-hellman-group-exchange-sha1 ssh-rsa
> 2003/10/06 22:31 CEST [ClientTransport,client] client->server: aes256-ctr hmac-sha1 none
> 2003/10/06 22:31 CEST [ClientTransport,client] server->client: aes256-ctr hmac-sha1 none
> 2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
>         reason: bad packet length 415956278
> 2003/10/06 22:31 CEST [ClientTransport,client] connection lost
> 2003/10/06 22:31 CEST [ClientTransport,client] Stopping factory <twisted.internet.protocol.ClientFactory instance at 0x8323b0c>
> 2003/10/06 22:32 CEST [-] Main loop terminated.

What that error means is that there was an error with one of the
packets.  Whether it's an error w/ your code or not I can't tell w/out
seeing the code.

-p
-- 
      Paul Swartz
(o_   z3p at twistedmatrix dot com
//\   http://www.twistedmatrix.com/users/z3p.twistd/
V_/_  AIM: Z3Penguin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031006/9b23a3cd/attachment.sig>

From anders at bruun-olsen.net  Mon Oct  6 15:23:13 2003
From: anders at bruun-olsen.net (Anders Bruun Olsen)
Date: Mon, 6 Oct 2003 23:23:13 +0200
Subject: [Twisted-Python] SSH client bad packet length
In-Reply-To: <1065474821.770.4.camel@petra>
References: <20031006210433.GB28465@elmer.skumleren.net> <1065474821.770.4.camel@petra>
Message-ID: <20031006212313.GC28465@elmer.skumleren.net>

On Mon, Oct 06, 2003 at 05:13:40PM -0400, Paul Swartz wrote:
> > 2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
> >         reason: bad packet length 415956278
> What that error means is that there was an error with one of the
> packets.  Whether it's an error w/ your code or not I can't tell w/out
> seeing the code.

#!/usr/bin/env python

from twisted.conch import error
from twisted.conch.ssh import transport
from twisted.internet import defer

class ClientTransport(transport.SSHClientTransport):

        def verifyHostKey(self, pubKey, fingerprint):
                return defer.succeed(1)

        def connectionSecure(self):
                self.requestService(ClientUserAuth('user',ClientConnection()))


from twisted.conch.ssh import keys, userauth

publicKey = 'ssh-dss
AAAAB3NzaC1kc3MAAAEBAPUkX9Opu89vLxyMxkssKeGUmfabGRrmiuLplkN34HcScnjf/7H/QDshdcRx4+f8GhJo4yH8DAE0/zVAWZK9aMI5LpjSpr9gR2Vyq5df7vnldJljxlGMnT5W79bloP69Fo3Hjf44dTNATxfFMmwHCwMxj1oDkEn78ANyDa5xjoszT54ucm0bPExiPDQ6sz84FEDdKIrrwi8w+rEN5ReBrUPAq9zXHZjt3AOqiaDXbZsRzh6x+XhX7Wg3EkOUfTEhZ1u6baBH0DLg7jiSnURPUwyYoW5qEB0CypjAhl+EaaASvmGcXAl1JSifp0CQ8MedvCb46dGn10McrDVJvFhRxo0AAAAVAOhkyFrn2qzxUk9XmJVc75DKd9Q/AAABACeR0+IjK7SOmBeNzqnLrp5FY1MhO8KwfLpZaHbQPwo6tPR3DBRCBH3oyhxFGpLxWvHsP2LoxmJbqTaTq4T+svuIjICXtlDVOSLd0o6U4A3aDXsoN2gv04RKEkmxrocnY6dYZisHeavP5S10Ediung23ZxOzsBdPEtRDthxOya4QXlqtjIEqAk702qmZGEYCgSRPOQ5Pwm0S7kD8yOn0XQUEY/WjlbZPiM9QUXlroltLnnSeECvFLePsyEVTrvdr8Bne9NxcMW+YZBroKtLOzgH6PLKn4lB8IGOlg+U1qOlkzjDaAMeNL2Hs8vwYVXIcmm3j5JQ5ZYtx2aRHkIUTY3kAAAEBAJxRVoGskwVDnzukLKRxjuFBSpyNr/Iwp0tPvQIyASPsLh5alHRe/2AMTojKdVJkmCjPCEdL4rlzugLkcv6OPzevH5tCtvyU1X2531h51MtIs8jFF7dGPosdt0+hD1O3fA0bXBO4REw0GcMuo/wV9Flx/FZYIkgvqVGalfH5evU0Hj8wQlZaMrW+HcMUrdLBezdMob4qFTK0TQQ8R0KWwYT++ULOGahzY3HwR8GVYYMMGUtRZY96vYkMpLJkSpHobBh2biVb2DuccPqIzCkJWaVdfl8zj5pi07mojvhLXzfWTkZv+nCzZ6DPoW+dMXqg5OE6e8l00gDefFAi8cj5aKc=
drzero at ernest.local'

privateKey = """-----BEGIN DSA PRIVATE KEY-----
Key was censored for privacy reasons
-----END DSA PRIVATE KEY-----"""

class ClientUserAuth(userauth.SSHUserAuthClient):

        def getPassword(self, prompt = None):
                return 
                # this says we won't do password authentication

        def getPublicKey(self):
                return keys.getPublicKeyString(data = publicKey)

        def getPrivateKey(self):
                return defer.succeed(keys.getPrivateKeyObject(data = privateKey))


from twisted.conch.ssh import connection

class ClientConnection(connection.SSHConnection):

        def serviceStarted(self):
                self.openChannel(CatChannel(conn = self))


from twisted.conch.ssh import channel, common

class CatChannel(channel.SSHChannel):

        name = 'session'

        def channelOpen(self, data):
                d = self.conn.sendRequest(self, 'exec', common.NS('cat'), wantReply = 1)
                d.addCallback(self._cbSendRequest)
                self.catData = ''

        def _cbSendRequest(self, ignored):
                self.write('This data will be echoed back to us by "cat."\r\n')
                self.conn.sendEOF(self)
                self.loseConnection()

        def dataReceived(self, data):
                self.catData += data

        def closed(self):
                print 'We got this from "cat":', self.catData
                reactor.stop()


from twisted.internet import protocol, reactor
from twisted.python import log
import sys

def main():
        log.startLogging(sys.stdout, setStdout=0)
        factory = protocol.ClientFactory()
        factory.protocol = ClientTransport
        reactor.connectTCP('eduardo.local', 22, factory)
        reactor.run()

if __name__ == "__main__":
        main()


-- 
Anders
-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GCS/O d--@ s:+ a-- C++ UL+++$ P++ L+++ E- W+ N(+) o K? w O-- M- V
PS+ PE@ Y+ PGP+ t 5 X R+ tv+ b++ DI+++ D+ G e- h !r y?
------END GEEK CODE BLOCK------
PGPKey: http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x8BFECB41



From z3p at twistedmatrix.com  Mon Oct  6 16:56:46 2003
From: z3p at twistedmatrix.com (Paul Swartz)
Date: 06 Oct 2003 18:56:46 -0400
Subject: [Twisted-Python] SSH client bad packet length
In-Reply-To: <20031006212313.GC28465@elmer.skumleren.net>
References: <20031006210433.GB28465@elmer.skumleren.net>
	<1065474821.770.4.camel@petra>  <20031006212313.GC28465@elmer.skumleren.net>
Message-ID: <1065481007.787.0.camel@petra>

On Mon, 2003-10-06 at 17:23, Anders Bruun Olsen wrote:
> On Mon, Oct 06, 2003 at 05:13:40PM -0400, Paul Swartz wrote:
> > > 2003/10/06 22:31 CEST [ClientTransport,client] Disconnecting with error, code 2
> > >         reason: bad packet length 415956278
> > What that error means is that there was an error with one of the
> > packets.  Whether it's an error w/ your code or not I can't tell w/out
> > seeing the code.
> 
> code clipped

can you file a bugtracker request for this?  it seems the problem is
that Conch and OpenSSH handle *-ctr encryption modes differently.

-p
-- 
      Paul Swartz
(o_   z3p at twistedmatrix dot com
//\   http://www.twistedmatrix.com/users/z3p.twistd/
V_/_  AIM: Z3Penguin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031006/9cad1f6b/attachment.sig>

From rdrb at 123.cl  Mon Oct  6 17:29:55 2003
From: rdrb at 123.cl (=?iso-8859-1?Q?Rita_D=EDaz_y/o_Rodrigo_Benenson?=)
Date: Mon, 06 Oct 2003 19:29:55 -0400
Subject: [Twisted-Python] Woven unicode
References: <20031006212402.12482.43539.Mailman@pyramid.twistedmatrix.com>
Message-ID: <003001c38c61$c46dc370$4b30fea9@laboratorio>

Hi!

I'm working on the final phases of a Open Source software for collaborative
text edition in real time (LeoN) (alpha or beta release will be anounced in
this list too). The code is develloped using python + twisted (PB and
Woven).

One of the features is that the actual contents of the text nodes can be
seen via web.
My problem is that I cannot show accent in woven. I have tryed different
things but non seems to work.

Please help !

Actually I have a simple data model interface that has a method that return
some text

 def wmfactory_text(self, request):
    return self.original.get_text()

So for test purpose I had changed the method by

 def wmfactory_text(self, request):
    return u"eló"

What I have to do to get the string looking good on the web browser?

I have tryed using a meta tag to indicate iso-8859-1 coding and replaced
u"eló" by u"eló".encode("iso-8859-1"); but that does not work too.

I have a presentation in two days more and this is the only ugly point.

Thanks in advance.

RodrigoB.





From bob at redivi.com  Mon Oct  6 17:42:42 2003
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 6 Oct 2003 19:42:42 -0400
Subject: [Twisted-Python] Woven unicode
In-Reply-To: <003001c38c61$c46dc370$4b30fea9@laboratorio>
Message-ID: <C790D5E0-F856-11D7-AAA7-000A95686CD8@redivi.com>

On Monday, Oct 6, 2003, at 19:29 America/New_York, Rita Díaz y/o 
Rodrigo Benenson wrote:

>  def wmfactory_text(self, request):
>     return u"eló"
>
> What I have to do to get the string looking good on the web browser?
>
> I have tryed using a meta tag to indicate iso-8859-1 coding and 
> replaced
> u"eló" by u"eló".encode("iso-8859-1"); but that does not work too.

u"eló".encode('ascii', 'xmlcharrefreplace')

It's not the most elegant solution in the world, but it should work.

-bob



From itamar at itamarst.org  Mon Oct  6 18:07:42 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 20:07:42 -0400
Subject: [Twisted-Python] Woven unicode
In-Reply-To: <003001c38c61$c46dc370$4b30fea9@laboratorio>
References: <20031006212402.12482.43539.Mailman@pyramid.twistedmatrix.com>
	<003001c38c61$c46dc370$4b30fea9@laboratorio>
Message-ID: <20031006200742.369707f4.itamar@itamarst.org>

On Mon, 06 Oct 2003 19:29:55 -0400
Rita Díaz y/o Rodrigo Benenson <rdrb at 123.cl> wrote:

>  def wmfactory_text(self, request):
>     return u"eló"

(This is not legal Python unless you're using 2.3 and have specifically
said your source code is iso-8859-1. It can break on other people's
computers if they have other default encodings than yours. \u escapes
will always work, of course. Not related to your problem though.)

Make sure you specify the encoding in your HTML document! I'm pretty
sure that microdom (and thus woven) are semi-hardcoded to UTF8, so try
saying that in your html page, and just returning unicode.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From alexander.winston at comcast.net  Mon Oct  6 19:17:09 2003
From: alexander.winston at comcast.net (Alexander Winston)
Date: Mon, 06 Oct 2003 21:17:09 -0400
Subject: [Twisted-Python] Woven unicode
In-Reply-To: <20031006200742.369707f4.itamar@itamarst.org>
References: <20031006212402.12482.43539.Mailman@pyramid.twistedmatrix.com>
	 <003001c38c61$c46dc370$4b30fea9@laboratorio>
	 <20031006200742.369707f4.itamar@itamarst.org>
Message-ID: <1065489428.25647.4.camel@drop>

On Mon, 2003-10-06 at 20:07, Itamar Shtull-Trauring wrote:
> On Mon, 06 Oct 2003 19:29:55 -0400
> Rita Díaz y/o Rodrigo Benenson <rdrb at 123.cl> wrote:
> 
> >  def wmfactory_text(self, request):
> >     return u"eló"
> 
> (This is not legal Python unless you're using 2.3 and have specifically
> said your source code is iso-8859-1. It can break on other people's
> computers if they have other default encodings than yours. \u escapes
> will always work, of course. Not related to your problem though.)
> 
> Make sure you specify the encoding in your HTML document! I'm pretty
> sure that microdom (and thus woven) are semi-hardcoded to UTF8, so try
> saying that in your html page, and just returning unicode.

Part of the problem is that the XML declaration that Woven (possibly
Microdom?) spits out does not include the encoding.




From andrew-twisted at puzzling.org  Mon Oct  6 20:23:18 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 7 Oct 2003 12:23:18 +1000
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <pan.2003.10.06.20.11.41.343421@smurf.noris.de>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no> <20030918102904.GA13575@frobozz> <pan.2003.10.06.20.11.41.343421@smurf.noris.de>
Message-ID: <20031007022318.GC4818@frobozz>

On Mon, Oct 06, 2003 at 10:11:42PM +0200, Matthias Urlichs wrote:
> Hi, Andrew Bennetts wrote:
> 
> >          But how does the                          .
> >      Main Thread pass a result                     .
> >        to Worker Thread and                        .
> >        resume its execution?                       ?
> 
> Just put it in a Queue and wait on it in the thread. Standard Python.

It seems cleaner to me for a worker thread to say:
    result = blockingCallFromThread(func, arg1, arg2, ...)

Than:
    q = Queue.Queue()
    reactor.callFromThread(func, q, arg1, arg2)
    result = q.get()

Especially seeing as the latter requires cluttering 'func' with details of
how to get the result back (i.e. a call to q.put), when the solution I
proposed in my previous email would make it transparent.

-Andrew.




From itamar at itamarst.org  Mon Oct  6 20:30:06 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 22:30:06 -0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <20031007022318.GC4818@frobozz>
References: <3F682235.5000106@iplus.ru>
	<20030917085000.2a9120e9.itamar@itamarst.org>
	<3F688D21.3080905@iplus.ru>
	<upthysa3o.fsf@inout.no>
	<20030918102904.GA13575@frobozz>
	<pan.2003.10.06.20.11.41.343421@smurf.noris.de>
	<20031007022318.GC4818@frobozz>
Message-ID: <20031006223006.4bbf2a32.itamar@itamarst.org>

On Tue, 7 Oct 2003 12:23:18 +1000
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

>     q = Queue.Queue()
>     reactor.callFromThread(func, q, arg1, arg2)
>     result = q.get()
> 
> Especially seeing as the latter requires cluttering 'func' with
> details of how to get the result back (i.e. a call to q.put), when the
> solution I proposed in my previous email would make it transparent.

t.i,threads should indeed have a utility function that does this for
you. It would need to turn Failures into exceptions and deal
transparently with Deferreds, of course.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Mon Oct  6 20:39:00 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 7 Oct 2003 12:39:00 +1000
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <20031006223006.4bbf2a32.itamar@itamarst.org>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no> <20030918102904.GA13575@frobozz> <pan.2003.10.06.20.11.41.343421@smurf.noris.de> <20031007022318.GC4818@frobozz> <20031006223006.4bbf2a32.itamar@itamarst.org>
Message-ID: <20031007023900.GD4818@frobozz>

On Mon, Oct 06, 2003 at 10:30:06PM -0400, Itamar Shtull-Trauring wrote:
> 
> t.i,threads should indeed have a utility function that does this for
> you. It would need to turn Failures into exceptions and deal
> transparently with Deferreds, of course.

I posted something like this to this thread earlier:

-----
import threading, sys
from twisted.internet import reactor

def blockingCallFromThread(func):
    e = threading.Event()
    l = []
    def wrapped_func():
        try:
            l.append(func)
        except:
            l.append(sys.exc_info())
            l.append(0)
        else:
            l.append(1)
        e.set()
    reactor.callFromThread(wrapped_func)
    e.wait()
    result, ok = l
    if ok:
        return result
    else:
        # Whee!  Cross-thread exceptions!
        raise result[0], result[1], result[2]
----

It doesn't deal with Failures or Deferreds, but it does everything else.
Oh, and it's not tested.  If I had already written test cases, I probably
would've checked it in by now ;)

(And I'm sure there's a better name for it than 'blockingCallFromThread'...)

-Andrew.




From dp at twistedmatrix.com  Mon Oct  6 20:50:18 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 6 Oct 2003 22:50:18 -0400
Subject: [Twisted-Python] Woven unicode
In-Reply-To: <003001c38c61$c46dc370$4b30fea9@laboratorio>
References: <20031006212402.12482.43539.Mailman@pyramid.twistedmatrix.com> <003001c38c61$c46dc370$4b30fea9@laboratorio>
Message-ID: <FC492ADA-F870-11D7-AF9E-000A95864FC4@twistedmatrix.com>

On Oct 6, 2003, at 7:29 PM, Rita Díaz y/o Rodrigo Benenson wrote:

>
> I have tryed using a meta tag to indicate iso-8859-1 coding and 
> replaced
> u"eló" by u"eló".encode("iso-8859-1"); but that does not work too.

I just happen to be working on this at the moment so you may be in 
luck. The technique that worked for me was to encode the unicode string 
as utf8:

u"eló".encode("utf8")

Then override render in your Page subclass, so you can set the 
Content-type header:

class MyPage(page.Page):
	def render(self, request):
		request.setHeader("Content-type", "text/html; charset=utf8")
		return page.Page.render(self, request)

It worked for me, anyway. Hope it works for you!

dp




From glyph at twistedmatrix.com  Mon Oct  6 21:05:11 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 06 Oct 2003 23:05:11 -0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <20031007023900.GD4818@frobozz>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no> <20030918102904.GA13575@frobozz> <pan.2003.10.06.20.11.41.343421@smurf.noris.de> <20031007022318.GC4818@frobozz> <20031006223006.4bbf2a32.itamar@itamarst.org> <20031007023900.GD4818@frobozz>
Message-ID: <3F822D67.4090907@twistedmatrix.com>

Andrew, can you add a bug to the tracker for this, and assign it to 
someone? :)  It would also be good if it did handle Deferreds, but I'm a 
little sketchy on where the callback would go (I mean, you're in a 
thread because you're blocking already, right?  but deferreds are to 
avoid blocking, so does that mean the callback runs in a thread or in 
the main loop?)




From maoy at cis.upenn.edu  Mon Oct  6 21:12:21 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Mon, 6 Oct 2003 23:12:21 -0400 (EDT)
Subject: [Twisted-Python] producer/resuming issue?
In-Reply-To: <FC492ADA-F870-11D7-AF9E-000A95864FC4@twistedmatrix.com>
Message-ID: <Pine.LNX.4.44.0310062258390.547-100000@klondike.cis.upenn.edu>

I sometimes encounter the problem that when a connection (producer) has
been lost, the consumer still try to call resumeProducing() to the
producer, so that a non-valid fileno is added to the select loop, and 
generate endless error messages. 

I'm almost sure that this is b/c I didn't do unregisterProducer() at the 
correct time. Even though, I feel like endless error messages are not very 
pleasant. Could anyone help to fix this? My temp solution is that 
I modified the abstract.py and tcp.py to set a flag indicate whether the 
fileno is deleted or not, and won't let resumeProducing to add a invalid 
reader into the reactor. Any better suggestions?

To play with this bug, you may want to modify socks.py, add these into 
SOCKSv4Outgoing.connectionMade()

        self.socks.transport.registerProducer(self.transport, 0)
        self.transport.registerProducer(self.socks.transport, 0)
 
Yun






From itamar at itamarst.org  Mon Oct  6 21:26:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 6 Oct 2003 23:26:51 -0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <3F822D67.4090907@twistedmatrix.com>
References: <3F682235.5000106@iplus.ru>
	<20030917085000.2a9120e9.itamar@itamarst.org>
	<3F688D21.3080905@iplus.ru>
	<upthysa3o.fsf@inout.no>
	<20030918102904.GA13575@frobozz>
	<pan.2003.10.06.20.11.41.343421@smurf.noris.de>
	<20031007022318.GC4818@frobozz>
	<20031006223006.4bbf2a32.itamar@itamarst.org>
	<20031007023900.GD4818@frobozz>
	<3F822D67.4090907@twistedmatrix.com>
Message-ID: <20031006232651.6f5402b6.itamar@itamarst.org>

On Mon, 06 Oct 2003 23:05:11 -0400
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> Andrew, can you add a bug to the tracker for this, and assign it to 
> someone? :)  It would also be good if it did handle Deferreds, but I'm
> a little sketchy on where the callback would go (I mean, you're in a 
> thread because you're blocking already, right?  but deferreds are to 
> avoid blocking, so does that mean the callback runs in a thread or in 
> the main loop?)

The callbacks all run the main thread, but the last one adds the result
to a object that feeds it to the waiting thread. That is, the thread
blocks until the Deferred has a result.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From syver at inout.no  Tue Oct  7 02:23:45 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Oct 2003 10:23:45 +0200
Subject: [Twisted-Python] woven authentications and connections.
In-Reply-To: <7AEE77A0-F80A-11D7-AA48-000A95864FC4@twistedmatrix.com>
References: <u4qyqu2qa.fsf@inout.no>
	<FFC97CF0-F5C1-11D7-87C4-000A95864FC4@twistedmatrix.com>
	<u3ce6n5jz.fsf@inout.no>
	<7AEE77A0-F80A-11D7-AA48-000A95864FC4@twistedmatrix.com>
Message-ID: <u8ynxlalp.fsf@inout.no>

Donovan Preston <dp at twistedmatrix.com> writes:

> On Oct 6, 2003, at 4:17 AM, Syver Enstad wrote:
> 
> > Donovan Preston <dp at twistedmatrix.com> writes:
> >
> >> On Oct 3, 2003, at 4:47 AM, Syver Enstad wrote:
> >>
> >>>
> >>> I am in the process of implementing authentication for an intranet
> >>> application using woven. I will be storing the login information in
> >>> the session. On each request I will connect to the database and pass
> >>> the connection to the page handling the request. How do I know when
> >>> the request is finished so that I can close the connection?
> >>
> >> Overriding Page.pageRenderComplete should be what you want.
> >
> > Thanks, I found another way by calling request.notifyFinished which
> > returns a deferred, I then add a callback to that deferred and it
> > seems to work fine. *The following is not a rethorical question, I am
> > just curious.* In what way is overriding Controller.pageRenderComplete
> > superior to my solution?
> 
> It's not. Your solution is superior. :-) Thanks for pointing it out.

Ok, so even better would be for the page to add pageRenderComplete
callback by calling request.notifyFinished? And then overriding
pageRenderComplete is the superior solution again?




From anders at bruun-olsen.net  Tue Oct  7 02:21:24 2003
From: anders at bruun-olsen.net (Anders Bruun Olsen)
Date: Tue, 7 Oct 2003 10:21:24 +0200
Subject: [Twisted-Python] SSH client bad packet length
In-Reply-To: <1065481007.787.0.camel@petra>
References: <20031006210433.GB28465@elmer.skumleren.net> <1065474821.770.4.camel@petra> <20031006212313.GC28465@elmer.skumleren.net> <1065481007.787.0.camel@petra>
Message-ID: <20031007082124.GD28465@elmer.skumleren.net>

On Mon, Oct 06, 2003 at 06:56:46PM -0400, Paul Swartz wrote:
> > code clipped
> can you file a bugtracker request for this?  it seems the problem is
> that Conch and OpenSSH handle *-ctr encryption modes differently.

Done.

-- 
Anders
-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GCS/O d--@ s:+ a-- C++ UL+++$ P++ L+++ E- W+ N(+) o K? w O-- M- V
PS+ PE@ Y+ PGP+ t 5 X R+ tv+ b++ DI+++ D+ G e- h !r y?
------END GEEK CODE BLOCK------
PGPKey: http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x8BFECB41



From syver at inout.no  Tue Oct  7 02:29:03 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Oct 2003 10:29:03 +0200
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <20031006135553.GA1103@radii>
References: <ud6dalbwx.fsf@inout.no> <20031006135553.GA1103@radii>
Message-ID: <u3ce5lacw.fsf@inout.no>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> On Mon, Oct 06, 2003 at 03:43:10PM +0200, Syver Enstad wrote:
> > As I was saying on the list I am making a login system with woven, and
> > the way to autheticate the user is by doing a pb call. 
> 
> Sounds like you need to be using twisted.web.woven.guard, and use it
> with a CredentialsChecker (that you write) that does the PB
> communication. You can see how to do this by reading
> twisted/cred/checkers.py, it is simple.

Does this work with 1.0.6. I am using the old cred system
and I have no immediate plans to upgrade it.

 




From syver at inout.no  Tue Oct  7 02:32:42 2003
From: syver at inout.no (Syver Enstad)
Date: 07 Oct 2003 10:32:42 +0200
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <1065448930.20878.15.camel@serrano>
References: <ud6dalbwx.fsf@inout.no> <1065448930.20878.15.camel@serrano>
Message-ID: <uy8vxjvmd.fsf@inout.no>

Bill Gribble <grib at billgribble.com> writes:

> On Mon, 2003-10-06 at 08:43, Syver Enstad wrote:
> > Should I use a plain Resource rather than a woven page for this kind
> > of problem?
> 
> I'm not using PB for auth (homebrew using the app's SQL db) but I think
> the general approach could be the same. 
> 
> I have a separate Resource that is the top-level entry point of the
> app.  Its getChild method checks that the proper credentials are
> associated with the Session and if not redirects to the login page.  The
> handlers on the login page are responsible for setting up the
> credentials in the Session. 
> 
> This works well for me.  The "gatekeeper" Resource is like 20 lines of
> code and keeps the page logic from having to know about the
> authentication scheme. 

This sounds like what I was thinking about. I am curious about how you
solve the actual login on the login page, my take would be that you'd
need to use a plain Resource or at least override render on a page to
be able to redirect after you have logged in to the database, no?





From alienoid at is.lg.ua  Tue Oct  7 02:46:45 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Tue, 07 Oct 2003 11:46:45 +0300
Subject: [Twisted-Python] pb.Referenceable: wxPython client crash and server exceptions
Message-ID: <3F827D75.70803@is.lg.ua>

Hello.

I have wxPython clients (twisted on windows XP) and twisted ssl 
server(RH linux 8.0).

Clients connect to server and passes their pb.Referenceable. Server 
every minute calls clients remote methods.
After 8-9 hours of continuous work client crashes(it's compiled into 
windows .exe with py2exe) and in my twistd.log i see such lines:

2003/10/07 05:46 EEST [Broker,2,192.168.100.254] Unhandled error in 
Deferred:
2003/10/07 05:46 EEST [Broker,2,192.168.100.254] Traceback from remote 
host -- Traceback (most recent call last):
           File "twisted\spread\banana.pyc", line 320, in dataReceived

           File "twisted\spread\banana.pyc", line 93, in 
callExpressionReceived

           File "twisted\spread\pb.pyc", line 511, in expressionReceived

           File "twisted\spread\pb.pyc", line 822, in proto_message

         --- <exception caught here> ---
           File "twisted\spread\pb.pyc", line 836, in _recvMessage

           File "twisted\spread\flavors.pyc", line 118, in 
remoteMessageReceived

           File "<string>", line 55, in remote_checkpoint

         exceptions.IOError: [Errno 9] Bad file descriptor




My client code excerpt:

class Client(pb.Referenceable):
     def remote_checkpoint(self):
         print "client"


class MyFrame(wxFrame, TaskBarApp):
     ...

     def gotObject(self, object):
         self.server = object
         object.notifyOnDisconnect(self.disconnected)
         d = object.callRemote("connect", self.conf.getUsername(),
                             self.conf.getPassword(),
                             self.conf.getIP(),
                             self.conf.getNetmask(),
                             self.conf.getMAC(),
                             Client())
         d.addCallbacks(self.connected, self.gotError)

     def OnConnect(self, event=None):
         bf = pb.PBClientFactory()
         from twisted.internet import ssl
         contextFactory = ssl.ClientContextFactory()
         reactor.connectSSL(SERVER_IP, SERVER_PORT, bf, contextFactory, 30)
         d = bf.getRootObject()

         d.addCallbacks(self.gotObject, self.gotError)


class MyApp(wxApp):
     def OnInit(self):
         wxInitAllImageHandlers()
         self.frame = MyFrame(NULL, -1, lang.appLabel)
         self.frame.Show(true)
         self.SetTopWindow(self.frame)
         return true

app = MyApp(0)
wxsupport.install(app)
if app.frame.isAutoconnected():
     app.frame.OnConnect()
#on Windows platfom we need to run with installSignalHandlers=0
if wxPlatform == '__WXMSW__':
     reactor.run(installSignalHandlers=0)
else:
     reactor.run()


Can you suggest something?
Your help is very appreciated.
Thanks in advance.

P.S. Twisted1.0.7

Best regards,
Ruslan




From justinjohnson at fastmail.fm  Tue Oct  7 06:15:22 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 07 Oct 2003 06:15:22 -0600
Subject: [Twisted-Python] Adapter troubles - Copying Quotient's DivmodSession
In-Reply-To: <C108B4E6-F5BC-11D7-87C4-000A95864FC4@twistedmatrix.com>
References: <20031002143039.784EB3D96E@www.fastmail.fm> <C108B4E6-F5BC-11D7-87C4-000A95864FC4@twistedmatrix.com>
Message-ID: <20031007121523.075FA3C3EF@www.fastmail.fm>

It works now.  Thanks much!

On Fri, 3 Oct 2003 12:15:07 -0400, "Donovan Preston"
<dp at twistedmatrix.com> said:
> 
> On Oct 2, 2003, at 10:30 AM, Justin Johnson wrote:
> 
> > Hi,
> >
> > I've created a class called RatControlSession similar to DivmodSession 
> > in
> > Quotient.  I define IRatControlSession and RatControlSession, and I
> > register RatControlSession as an adapter from 
> > twisted.web.server.Session
> > to IRatControlSession.  However, when I try to do something like...
> >
> >     prefs = webinterfaces.IRatControlSession(request.getSession())
> >
> > I get the following error.  This is a cut-n-paste from what appears in
> > the browser.
> 
> <snip exception>
> 
> > I'm not sure what I'm doing wrong here.  I looked through components.py
> > but still don't see what the problem is.
> >
> > I've attached webinterfaces.py and session.py, setup similar to
> > quotient's respective files.  Also attached is pages.py which defines
> > wmfactory_action on MenuPage where I try to create an 
> > IRatControlSession
> > from request.getSession().
> 
>  From looking at the files, it looks like session is not getting 
> imported anywhere. You would think it wouldn't be a problem since you 
> are not directly using any of the objects in the module, but unless you 
> import a module, the code at the top level of that module does not get 
> executed. Thus the registerAdapter calls are never happening, and when 
> you go to request an adapter none is registered. Try putting "import 
> session" at the top of your pages file.
> 
> This is a major problem with using components and twisted -- where to 
> register the adapters. Of course, the implementation of components as 
> pioneered by Zope 3 uses a non-python file to register adapters (a zcml 
> file, a form of XML) and twisted should have something similar 
> (preferably not xml) but currently does not.
> 
> dp
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From oisin at enginesofcreation.ie  Tue Oct  7 06:20:06 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Tue, 07 Oct 2003 13:20:06 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <20031003165923.GB6738@intarweb.us>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031003165923.GB6738@intarweb.us>
Message-ID: <3F82AF76.3000300@enginesofcreation.ie>

Jp Calderone wrote:

>On Fri, Oct 03, 2003 at 11:18:28AM +0100, Oisin Mulvihill wrote:
>  
>
>>Hi,
>>
>>[snip]
>>Why are there two deferred objects returned by storeFile? The documentation
>>says:
>>
>>storeFile (self ,path ):
>>
>>   Store a file at the given path.
>>
>>   This method issues the 'STOR' FTP command.
>>
>>   Returns:
>>
>>   A tuple of two Deferreds:
>>       
>>   * Deferred IFinishableConsumer . You must call the finish method on the
>>       IFinishableConsumer when the file is completely transferred.
>>
>>   * Deferred list of  control-connection responses.
>>
>>This really doesn't help me much. I get the impression that storeFile
>>isn't sending the contents of file, because its waiting for me to stream
>>the file contents somehow. Maybe via IFinishableConsumer?
>>    
>>
>
>  Correct, I believe.  It looks like you can use FileSender (from t.p.basic)
>if you're just sending something off disk (or from any file object, really)
>here.
>
>  
>
>>In my current program, using ftplib, I do the following to upload a file:
>>
>>   :
>>   ftp.storbinary('STOR %s' % (filename), fp)
>>   :
>>
>>This has the filename and a file descriptor passed to it. Is something
>>like this needed with storeFile?
>>
>>Please can someone give me an answer to this, as looking at the code for
>>twisted.protocols.ftp isn't helping much either. This function seems to be
>>a mystery to me and I want to understand how to use it properly.
>>
>>    
>>
>
>  Try...
>
>    from twisted.protocols.basic import FileSender
>
>    def sendfile(consumer, fileObj):
>        s = FileSender()
>        return s.beginFileTransfer(fileObj, consumer
>            ).addCallback(lambda _: consumer.finish()
>            )
>
>    dC, dL = p.storeFile("path")
>    dC.addCallback(sendfile, fileObj)
>
>  Jp
>  
>
Thanks for replying. I've tried what you've suggested, however I'm
still getting the code "waiting" when the transfer is supposed to happen.
The follow is the code I added based on your suggestion (attached
is the complete source):

<snip>
:
:

def sendfile(consumer, fileObj):
    """
    """
    print "2.1 consumer, fileObject -", consumer, fileObj
    s = FileSender()
    print "2.2"
    d = s.beginFileTransfer(fileObj, consumer)
    print "2.3"
    d.addCallback(lambda _: consumer.finish())
    print "2.4"
    return d


def connectionMade(ftpClient):
    """
    """
    try:
        print "1.0"
        my_file = StringIO("Hello! Did this get sent to the remote side?")
        print "1.1"
        my_filename = 'myfile.txt'   
        print "1.2"
        ftpClient.pwd().addCallbacks(success, fail)
        print "1.3"
        dC, dL = ftpClient.storeFile(my_filename)
        print "1.4"
        dC.addCallback(sendfile, my_file)
        print "1.5"
        dL.addCallbacks(success, fail)
        print "1.6"
       
    except:
        print "Exception -", sys.exc_value
        reactor.stop()

:
:
</snip>

When I run this I get as far as the line:

    d = s.beginFileTransfer(fileObj, consumer)

This is where it now seems to be hanginig. The file transfer doesn't appear
to be happening. I noticed from the docs on beginFileTransfer(), that
it takes 3 args: file object, consumer & transform function. I tried 
adding a
transform function to see it gets called with the data, read from the file,
however this never occured.

I'm not really sure where to go from here. Any suggestions?

Thanks,

om

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftpclient.py
URL: </pipermail/twisted-python/attachments/20031007/f4b57d5c/attachment.ksh>

From justinjohnson at fastmail.fm  Tue Oct  7 07:49:44 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 07 Oct 2003 07:49:44 -0600
Subject: [Twisted-Python] PB and Woven authentication
Message-ID: <20031007134944.EF10D3DC4F@www.fastmail.fm>

I know there have been other posts on this topic, but I wasn't sure how
up-to-date they are.

I currently have a PB server that I connect to via the command line.  It
allows me to do tasks on wintel servers I manage.  I'm now trying to
create a web interface to that service using woven.

Below is what I'm currently doing for authentication.

First of all, am I doing things right below?  Any corrections or
suggestions for improvement?

Once that is correct, how do I hook this up to woven?  I was trying to
look through the Quotient code to figure it out, but there is so much
other stuff in there I'm having a hard time keeping it all straight.

Thanks much.
-Justin


***** SERVER SIDE *****
----
class RatControlRealm:
    def __init__(self):
        self.p = RatControlPerspective("admin")
                                                                                
    def requestAvatar(self, avatarId, mind, interface):
        assert interface == pb.IPerspective
        assert mind == "BRAINS!"
        self.p.loggedIn = 1
        return pb.IPerspective, self.p, self.p.logout
                                                                                

from twisted.cred import portal, checkers, credentials
realm = RatControlRealm()
portal = portal.Portal(realm)
checker = checkers.InMemoryUsernamePasswordDatabaseDontUse()
checker.addUser(config.adminUser, config.adminPassword)
portal.registerChecker(checker)
                                                                                
factory = pb.PBServerFactory(portal)
reactor.listenTCP(config.portNumber, factory)
reactor.run()
--------

***** CLIENT SIDE *****
-----
    def connectToServer(self, server):
        def _cbSuccess(perspective):
            return perspective
        def _cbFailure(failure):
            print "Failed to connect to '%s'." % server
            return failure
        factory = pb.PBClientFactory()
        reactor.connectTCP(server, config.portNumber, factory)
        d = factory.login(credentials.UsernamePassword(config.adminUser,
        config.adminPassword), "BRAINS!")
        d.addCallbacks(_cbSuccess, _cbFailure)
        return d
------



From itamar at itamarst.org  Tue Oct  7 08:49:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 7 Oct 2003 10:49:20 -0400
Subject: [Twisted-Python] PB and Woven authentication
In-Reply-To: <20031007134944.EF10D3DC4F@www.fastmail.fm>
References: <20031007134944.EF10D3DC4F@www.fastmail.fm>
Message-ID: <20031007104920.72315306.itamar@itamarst.org>

On Tue, 07 Oct 2003 07:49:44 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> First of all, am I doing things right below?  Any corrections or
> suggestions for improvement?

s/"BRAINS"/None/, since you aren't actually using it.

> Once that is correct, how do I hook this up to woven?  I was trying to
> look through the Quotient code to figure it out, but there is so much
> other stuff in there I'm having a hard time keeping it all straight.

Use twisted.web.woven.guard (.simpleguard is a good example). You realm
will be asked for IResource instead of IPerspective when authenticating
web clients.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Tue Oct  7 09:00:57 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 7 Oct 2003 11:00:57 -0400
Subject: [Twisted-Python] pb.Referenceable: wxPython client crash and
 server exceptions
In-Reply-To: <3F827D75.70803@is.lg.ua>
References: <3F827D75.70803@is.lg.ua>
Message-ID: <20031007110057.06063f3f.itamar@itamarst.org>

On Tue, 07 Oct 2003 11:46:45 +0300
Ruslan Spivak <alienoid at is.lg.ua> wrote:

> I have wxPython clients (twisted on windows XP) and twisted ssl 
> server(RH linux 8.0).

Using pyOpenSSL 0.5.1 I hope? 0.4 is kinda broken.

As for the bug - what does your code do in line 55 in remote_checkpoint?

--
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Tue Oct  7 09:10:23 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 7 Oct 2003 11:10:23 -0400
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <3F82AF76.3000300@enginesofcreation.ie>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031003165923.GB6738@intarweb.us> <3F82AF76.3000300@enginesofcreation.ie>
Message-ID: <20031007151023.GA30866@intarweb.us>

On Tue, Oct 07, 2003 at 01:20:06PM +0100, Oisin Mulvihill wrote:
> Jp Calderone wrote:
> 
> [snip]
> 
> When I run this I get as far as the line:
> 
>    d = s.beginFileTransfer(fileObj, consumer)
> 
> This is where it now seems to be hanginig. The file transfer doesn't
> appear to be happening. I noticed from the docs on beginFileTransfer(),
> that it takes 3 args: file object, consumer & transform function. I tried
> adding a transform function to see it gets called with the data, read from
> the file, however this never occured.

  This suggests to me that the data connection is never actually being made.

  Try adding errbacks to all these deferreds and seeing if any of those are
being called.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031007/7432c6bd/attachment.sig>

From oisin at enginesofcreation.ie  Tue Oct  7 11:36:28 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Tue, 07 Oct 2003 18:36:28 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <20031007151023.GA30866@intarweb.us>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031003165923.GB6738@intarweb.us> <3F82AF76.3000300@enginesofcreation.ie> <20031007151023.GA30866@intarweb.us>
Message-ID: <3F82F99C.1080106@enginesofcreation.ie>

Jp Calderone wrote:

>On Tue, Oct 07, 2003 at 01:20:06PM +0100, Oisin Mulvihill wrote:
>  
>
>>Jp Calderone wrote:
>>
>>[snip]
>>
>>When I run this I get as far as the line:
>>
>>   d = s.beginFileTransfer(fileObj, consumer)
>>
>>This is where it now seems to be hanginig. The file transfer doesn't
>>appear to be happening. I noticed from the docs on beginFileTransfer(),
>>that it takes 3 args: file object, consumer & transform function. I tried
>>adding a transform function to see it gets called with the data, read from
>>the file, however this never occured.
>>    
>>
>
>  This suggests to me that the data connection is never actually being made.
>
>  Try adding errbacks to all these deferreds and seeing if any of those are
>being called.
>
>  Jp
>
>  
>
I'll look into it further, but as far as I can tell the connection is
being made. An empty file does get created on the server side.
I've I killed the ftp server and the errbacks get called, informing
me of the connection loss. Would this indicate then that maybe
the file sender isn't doing its job? I'll look into this as well. Any
further suggestions would be welcome,

Thanks,

om

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540






From oisin at enginesofcreation.ie  Tue Oct  7 11:46:31 2003
From: oisin at enginesofcreation.ie (Oisin Mulvihill)
Date: Tue, 07 Oct 2003 18:46:31 +0100
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <20031007151023.GA30866@intarweb.us>
References: <3F7D4CF4.2050807@enginesofcreation.ie> <20031003165923.GB6738@intarweb.us> <3F82AF76.3000300@enginesofcreation.ie> <20031007151023.GA30866@intarweb.us>
Message-ID: <3F82FBF7.9060104@enginesofcreation.ie>

Jp Calderone wrote:

>On Tue, Oct 07, 2003 at 01:20:06PM +0100, Oisin Mulvihill wrote:
>  
>
>>Jp Calderone wrote:
>>
>>[snip]
>>
>>When I run this I get as far as the line:
>>
>>   d = s.beginFileTransfer(fileObj, consumer)
>>
>>This is where it now seems to be hanginig. The file transfer doesn't
>>appear to be happening. I noticed from the docs on beginFileTransfer(),
>>that it takes 3 args: file object, consumer & transform function. I tried
>>adding a transform function to see it gets called with the data, read from
>>the file, however this never occured.
>>    
>>
>
>  This suggests to me that the data connection is never actually being made.
>
>  Try adding errbacks to all these deferreds and seeing if any of those are
>being called.
> 
>  Jp
>
>  
>
I forgot to mention I've tried this on my linux system
with python 2.2.3 and twisted 1.0.7, with no success.

om

-- 
Oisin Mulvihill
Engines Of Creation

Email: oisin at enginesofcreation.ie
Work: +353 1 6791602
Mobile: +353 868191540






From glyph at twistedmatrix.com  Tue Oct  7 12:53:22 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 07 Oct 2003 14:53:22 -0400
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <u3ce5lacw.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no> <20031006135553.GA1103@radii> <u3ce5lacw.fsf@inout.no>
Message-ID: <3F830BA2.6080505@twistedmatrix.com>

Syver Enstad wrote:

> Does this work with 1.0.6. I am using the old cred system
> and I have no immediate plans to upgrade it.

No.  Old cred was a disaster and it's a really good thing it's getting 
replaced.  You can look at the woven.guard that came with 1.0.6, but 
please don't bother the list with questions about it - it's hard enough 
to support the current code without that confusion.




From mporter at despammed.com  Tue Oct  7 14:47:52 2003
From: mporter at despammed.com (Michael Porter)
Date: Tue, 7 Oct 2003 21:47:52 +0100
Subject: [Twisted-Python] Twisted powered network jukebox
References: <CC6F75D6-F839-11D7-AAA7-000A95686CD8@redivi.com>
Message-ID: <004401c38d14$48622600$0201a8c0@dan>

----- Original Message -----
From: "Bob Ippolito" <bob at redivi.com>
To: <twisted-python at twistedmatrix.com>
Sent: Monday, October 06, 2003 9:15 PM
Subject: [despammed] Re: [Twisted-Python] Twisted powered network jukebox


>
> On Monday, Oct 6, 2003, at 15:44 America/New_York, Michael Porter wrote:
>
> > ----- Original Message -----
> > From: "Bob Ippolito" <bob at redivi.com>
> > To: <twisted-python at twistedmatrix.com>
> > Sent: Sunday, October 05, 2003 9:34 PM
> > Subject: Re: [Twisted-Python] Twisted powered network jukebox
> >
> >> On Sunday, Oct 5, 2003, at 15:46 America/New_York, Michael Porter
> >> wrote:
> >>
> >>> I've just uploaded the first public version of mpJuke, a network
> >>> jukebox
> >>> I've been working on. If you're interested take a look at the
> >>> website:
> >>>
> >>>     http://www.mpweb.dsl.pipex.com/
> >>
> >> Very cool.  I'll probably port this to OS X sometime in the near
> >> future.  Also, I have some almost-complete code lying dormant that
> >> does
> >> iTunes music sharing (server and client) that might be useful for this
> >> project.
> >
> > Glad you like it. OS X version would be good and I guess should be
> > relatively easy to port assuming the packages it requires are
> > available.
>
> The packages are all available.  I'd probably end up wanting to rewrite
> the GUI in PyObjC/Cocoa because wxPython is slow and a bit buggy, and
> more likely than not I'd also want to factor out the ResourcePackage
> thing and use the native OS X way of doing it (bundles with localizable
> resources) instead.. ResourcePackage is probably only used in the GUI
> layer anyways, right?
>
> -bob
>
ResourcePackage is really just a development tool which automatically
converts resources into Python source files. It makes things simpler if the
application is going to be frozen because you don't have to worry about file
paths. I use it to convert the web icons, CSS file etc.

Mike.





From alienoid at is.lg.ua  Tue Oct  7 17:58:56 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Wed, 08 Oct 2003 02:58:56 +0300
Subject: [Twisted-Python] pb.Referenceable: wxPython client crash
 and server exceptions
Message-ID: <3F835340.6050701@is.lg.ua>

>> I have wxPython clients (twisted on windows XP) and twisted ssl 
>> server(RH linux 8.0).


> Using pyOpenSSL 0.5.1 I hope? 0.4 is kinda broken.
Both client and server use 0.5.1

> As for the bug - what does your code do in line 55 in remote_checkpoint?
server calls client's remote method 'remote_checkpoint' just to check if client's remote reference still valid(if it's invalid i need to do some stuff on server side), so on client i have just empty method(so from server side it's like a ping - to check if client is alive)

--
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting






From andrew-twisted at puzzling.org  Tue Oct  7 20:00:28 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 8 Oct 2003 12:00:28 +1000
Subject: [Twisted-Python] FTPClient storeFile help.
In-Reply-To: <3F7D4CF4.2050807@enginesofcreation.ie>
References: <3F7D4CF4.2050807@enginesofcreation.ie>
Message-ID: <20031008020028.GA8353@frobozz>

On Fri, Oct 03, 2003 at 11:18:28AM +0100, Oisin Mulvihill wrote:
> 
> Why are there two deferred objects returned by storeFile? The documentation
> says:

Try looking at twisted/test/test_ftp.py, line 251 (the testStor method of
FTPClientAndServerTests).  Hopefully that should help fill in the blanks.

-Andrew.




From stuart.hungerford at anu.edu.au  Tue Oct  7 23:33:41 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Wed, 08 Oct 2003 15:33:41 +1000
Subject: [Twisted-Python] Woven page instances deferring to each other...
Message-ID: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au>

Hi all,

I have a Twisted web application that uses Woven to generate
various HTML pages.  The application knows about a bunch of
"error" states which have one Woven page instance per state:


class error_state_1(twisted.web.woven.page.Page):
     isLeaf = 1
     templateFile = ...

     # usual wmfactory_ and wvupdate_ methods


class error_state_2(twisted.web.woven.page.Page):
     isLeaf = 1
     templateFile = ...

     # usual wmfactory_ and wvupdate_ methods


class error_state_3(twisted.web.woven.page.Page):
     isLeaf = 1
     templateFile = ...

     # usual wmfactory_ and wvupdate_ methods


In another Woven page the application can detect these
"error" states and I would like to optionally "defer" the HTML
generation to the existing error pages:


class application_page(twisted.web.woven.page.Page):
     isLeaf = 1
     templateFile = ...

     # methods

     def wvupdate_content(self, request, node, data):
         if error_state_1:
             # defer to error_state_1 page
         elif error_state_2:
             # defer to error_state_2 page
         ...
         else:
             # situation normal, generate content XHTML


In practice there are a number of application pages and they
may all need to detect and report the "error" conditions.

So, my question is what's the best way to do this kind of thing
in Woven?  I seem to recall something about expanding a Woven
"macro" page being discussed on the list, but I'm still grepping
for that.

Any advice much appreciated,



Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From mary-twisted at puzzling.org  Tue Oct  7 23:55:03 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed, 8 Oct 2003 15:55:03 +1000
Subject: [Twisted-Python] Woven page instances deferring to each other...
In-Reply-To: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au>
References: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au>
Message-ID: <20031008055503.GS12404@titus>

On Wed, Oct 08, 2003, Stuart Hungerford wrote:
> In another Woven page the application can detect these
> "error" states and I would like to optionally "defer" the HTML
> generation to the existing error pages:

I *think* here you mean "I'd like totally different HTML generated if
there is an error state", rather than "my check for the error returns a
Deferred object". Let me know if I'm wrong.

Since Deferred objects are a key part of Twisted, "defer" is probably
not the best choice of verb unless you mean "defer using a Deferred
object". (It's like talking to mathematicians about "clumps" of "things"
which is a pain, because they've overloaded the words "class", "set",
"group" and "category" among others.)

> So, my question is what's the best way to do this kind of thing
> in Woven?  I seem to recall something about expanding a Woven
> "macro" page being discussed on the list, but I'm still grepping
> for that.

Assuming you meant "I'd like totally different HTML generated if
there is an error state" you probably do want macros or something like
them. The best documentation I've seen on this is here:
http://twistedmatrix.com/pipermail/twisted-python/2003-June/004662.html

-Mary



From mary-twisted at puzzling.org  Wed Oct  8 00:02:12 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed, 8 Oct 2003 16:02:12 +1000
Subject: [Twisted-Python] Woven page instances deferring to each other...
In-Reply-To: <20031008055503.GS12404@titus>
References: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au> <20031008055503.GS12404@titus>
Message-ID: <20031008060212.GU12404@titus>

On Wed, Oct 08, 2003, Mary Gardiner wrote:
> Assuming you meant "I'd like totally different HTML generated if
> there is an error state" you probably do want macros or something like
> them. The best documentation I've seen on this is here:
> http://twistedmatrix.com/pipermail/twisted-python/2003-June/004662.html

Followup...

A nicer solution may be to have the parent Page (by this I mean
http://example.com/bob/ is a parent and http://example.com/bob/result/
is a child -- parents in the URL structure) do the check and return an
object of a different Page class, something like:

class MyParentPage(page.Page):

    def getDynamicChild(self, name, request):

        if error_condition_1:
            return ErrorPage1()
        elif error_condition_2:
            return ErrorPage2()
        else:
            return NormalChildPage()

If there's any way you can determine if the error has happened before
the child page starts rendering, then I suspect it would be nicer to do
the error check at child creation time, rather than when the child
renders.

You can then use macros for something like their normal function: which
is defining the bits of pages that look mostly the same across lots of
pages (navigation bars and the like).

-Mary



From dp at twistedmatrix.com  Wed Oct  8 00:21:48 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 8 Oct 2003 02:21:48 -0400
Subject: [Twisted-Python] Woven page instances deferring to each other...
In-Reply-To: <20031008060212.GU12404@titus>
References: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au> <20031008055503.GS12404@titus> <20031008060212.GU12404@titus>
Message-ID: <B2A1A6F3-F957-11D7-9FC4-000A95864FC4@twistedmatrix.com>

On Oct 8, 2003, at 2:02 AM, Mary Gardiner wrote:

> If there's any way you can determine if the error has happened before
> the child page starts rendering, then I suspect it would be nicer to do
> the error check at child creation time, rather than when the child
> renders.

Since woven renders the entire page before it calls request.write, any 
portion of the view rendering code which detects an error is able to 
call request.redirect (because we can still set headers since we 
haven't written any of the body yet). Just thought I'd chuck that out 
there, it may be totally irrelevant.

dp




From mary-twisted at puzzling.org  Wed Oct  8 00:30:03 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed, 8 Oct 2003 16:30:03 +1000
Subject: [Twisted-Python] Woven page instances deferring to each other...
In-Reply-To: <B2A1A6F3-F957-11D7-9FC4-000A95864FC4@twistedmatrix.com>
References: <6.0.0.22.0.20031008151036.01eb4b90@anusf.anu.edu.au> <20031008055503.GS12404@titus> <20031008060212.GU12404@titus> <B2A1A6F3-F957-11D7-9FC4-000A95864FC4@twistedmatrix.com>
Message-ID: <20031008063003.GV12404@titus>

On Wed, Oct 08, 2003, Donovan Preston wrote:
> Since woven renders the entire page before it calls request.write, any 
> portion of the view rendering code which detects an error is able to 
> call request.redirect (because we can still set headers since we 
> haven't written any of the body yet). Just thought I'd chuck that out 
> there, it may be totally irrelevant.

It's not, it reduces my second post to a stylistic choice, I think.

-Mary



From mesozoic at polynode.com  Wed Oct  8 02:25:32 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 08 Oct 2003 04:25:32 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
Message-ID: <1065601532.1583.175.camel@hyla>

I am using distrib.ResourceSubscription and ResourcePublisher to link a
user-run web server with Moshe's twisted-web. I've noticed something
very odd going on; my twistd process will progressively hog memory and
CPU time to the point that the entire server slows down. Here is a
snippet of what's happening:

2003/10/03 19:00 EDT [HTTPChannel,14,206.231.13.11] Starting factory
<twisted.spread.pb.PBClientFactory instance at 0x84bafbc>
2003/10/03 19:00 EDT [Broker,client] connected to publisher

And then, days later...

2003/10/08 04:12 EDT [Broker,client] Stopping factory
<twisted.spread.pb.PBClientFactory instance at 0x84bafbc>
2003/10/08 04:12 EDT [Broker,client] could not connect to distributed
web service: connection dropped

I imagine this means that all the PBClientFactory instances are sitting
around, doing nothing, and clogging my meager 64MB of RAM. Here is the
code I'm using to do this:

--- snip /www/mesozoic.geecs.org/siteroot.rpy ---
subscription = ResourceSubscription('unix', '/home/mesozoic/.pb-web')
resource.putChild('cogito', subscription)
--- snip ---

--- snip /home/mesozoic/pb-web.tpy ---
file = static.File('./pb-web')
site = server.Site(file)
application.listenUNIX(
   '/home/mesozoic/.pb-web',
   pb.BrokerFactory(distrib.ResourcePublisher(site)))
--- snip ---

Could all these PBClientFactory instances be popping up because my
ResourceSubscription is in an .rpy instead of in the twisted-web config
files? Or is this an internal bug that shouldn't be happening? Or do I
need to share more information?

I can't deal with having to restart twisted-web every few days... help?

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031008/d715b78e/attachment.sig>

From radix at twistedmatrix.com  Wed Oct  8 02:38:48 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 8 Oct 2003 04:38:48 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
In-Reply-To: <1065601532.1583.175.camel@hyla>
References: <1065601532.1583.175.camel@hyla>
Message-ID: <20031008083848.GD1103@radii>

On Wed, Oct 08, 2003 at 04:25:32AM -0400, Alex Levy wrote:
> I am using distrib.ResourceSubscription and ResourcePublisher to link a
> user-run web server with Moshe's twisted-web. I've noticed something
> very odd going on; my twistd process will progressively hog memory and
> CPU time to the point that the entire server slows down. Here is a
> snippet of what's happening:

I think I know what's happening. Do a "netstat |grep twistd-web-pb".

If you have lots of connections to the same .twistd-web-pb, this is
because of a bug that was recently introduced to web.distrib, when
Jerub refactored it to use Woven. It stopped caching connections to
the personal web servers. :-( I fixed this in CVS yesterday. I will
try to get another alpha out soon.

Unfortunately, I think this bug made it into 1.0.7 :-(, although I'm
not sure.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From syver at inout.no  Wed Oct  8 03:01:51 2003
From: syver at inout.no (Syver Enstad)
Date: 08 Oct 2003 11:01:51 +0200
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <3F830BA2.6080505@twistedmatrix.com>
References: <ud6dalbwx.fsf@inout.no> <20031006135553.GA1103@radii>
	<u3ce5lacw.fsf@inout.no> <3F830BA2.6080505@twistedmatrix.com>
Message-ID: <uk77gdrwg.fsf@inout.no>

Glyph Lefkowitz <glyph at twistedmatrix.com> writes:

> Syver Enstad wrote:
> 
> > Does this work with 1.0.6. I am using the old cred system
> > and I have no immediate plans to upgrade it.
> 
> No.  Old cred was a disaster and it's a really good thing it's getting
> replaced.  

Is there an upgrade path for applications that use the old cred
system? What has to change in an application that usess old cred to
use the new cred?







From wiedeman at gmx.net  Wed Oct  8 02:40:10 2003
From: wiedeman at gmx.net (Christoph Wiedemann)
Date: Wed, 8 Oct 2003 10:40:10 +0200 (MEST)
Subject: [Twisted-Python] hardcoded SIZE_LIMIT
Message-ID: <3747.1065602410@www48.gmx.net>

Hello,

i'm trying to use PB for remote procedure calls in the context of numeric
computations. So far things work really well (Twisted is a real cool piece of
software!), but now i'm trapped by twisted.spread.banana.SIZE_LIMIT. I need to
send pretty much data over the network (~512 MB) and tried out to set the
SIZE_LIMIT to 640 MB. Hmm, still getting the "String too long exception", cause
the 640 kB are hardcoded in cBanana.c. Any chances to make the limit
configurable ?

Regards,
Christoph




From mesozoic at polynode.com  Wed Oct  8 03:11:27 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 08 Oct 2003 05:11:27 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
In-Reply-To: <20031008083848.GD1103@radii>
References: <1065601532.1583.175.camel@hyla>  <20031008083848.GD1103@radii>
Message-ID: <1065604286.1583.180.camel@hyla>

On Wed, 2003-10-08 at 04:38, Christopher Armstrong wrote:
> I think I know what's happening. Do a "netstat |grep twistd-web-pb".

This is indeed what's happening. Until the next alpha comes out, I'll
simply patch my local copy.

Thanks :]

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031008/74fa50d6/attachment.sig>

From mesozoic at polynode.com  Wed Oct  8 03:17:56 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 08 Oct 2003 05:17:56 -0400
Subject: [Twisted-Python] hardcoded SIZE_LIMIT
In-Reply-To: <3747.1065602410@www48.gmx.net>
References: <3747.1065602410@www48.gmx.net>
Message-ID: <1065604676.1589.188.camel@hyla>

On Wed, 2003-10-08 at 04:40, Christoph Wiedemann wrote:
> i'm trying to use PB for remote procedure calls in the context of numeric
> computations. So far things work really well (Twisted is a real cool piece of
> software!), but now i'm trapped by twisted.spread.banana.SIZE_LIMIT. I need to
> send pretty much data over the network (~512 MB) and tried out to set the
> SIZE_LIMIT to 640 MB. Hmm, still getting the "String too long exception", cause
> the 640 kB are hardcoded in cBanana.c. Any chances to make the limit
> configurable ?

I encountered the same problem; my solution was simply to split strings
into multiple pieces and combine them at the receiving end. (I also used
the gzip module to compress them.) I did all this in getStateToCopy and
setCopyableState, which are documented here:
<http://twistedmatrix.com/documents/howto/pb-copyable#auto6>

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031008/ba404588/attachment.sig>

From mesozoic at polynode.com  Wed Oct  8 03:27:34 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 08 Oct 2003 05:27:34 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
In-Reply-To: <20031008083848.GD1103@radii>
References: <1065601532.1583.175.camel@hyla>  <20031008083848.GD1103@radii>
Message-ID: <1065605254.1586.194.camel@hyla>

On Wed, 2003-10-08 at 04:38, Christopher Armstrong wrote:
> I think I know what's happening. Do a "netstat |grep twistd-web-pb".

On Wed, 2003-10-08 at 05:11, Alex Levy wrote: 
> This is indeed what's happening.

I spoke too soon. It looks like the bug you mentioned occurs in
UserDirectory; I'm not using that. I'm simply using ResourceSubscription
and ResourcePublisher. Should I _not_ be doing this? Or is there another
solution to the problem?

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031008/1196f25a/attachment.sig>

From radix at twistedmatrix.com  Wed Oct  8 03:59:03 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 8 Oct 2003 05:59:03 -0400
Subject: [Twisted-Python] Leaking memory with twisted-web
In-Reply-To: <1065605254.1586.194.camel@hyla>
References: <1065601532.1583.175.camel@hyla> <20031008083848.GD1103@radii> <1065605254.1586.194.camel@hyla>
Message-ID: <20031008095903.GF1103@radii>

On Wed, Oct 08, 2003 at 05:27:34AM -0400, Alex Levy wrote:
> On Wed, 2003-10-08 at 04:38, Christopher Armstrong wrote:
> > I think I know what's happening. Do a "netstat |grep twistd-web-pb".
> 
> On Wed, 2003-10-08 at 05:11, Alex Levy wrote: 
> > This is indeed what's happening.
> 
> I spoke too soon. It looks like the bug you mentioned occurs in
> UserDirectory; I'm not using that. I'm simply using ResourceSubscription
> and ResourcePublisher. Should I _not_ be doing this? Or is there another
> solution to the problem?

Well... You might be using it in a bad way. Are you creating a new
ResourceSubscription for every request? If you are, you need to
persist them, probably by using 

  r.putChild('name', resourceSubscription) 

where `r' is already a persistent resource.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From exarkun at intarweb.us  Wed Oct  8 08:46:21 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 8 Oct 2003 10:46:21 -0400
Subject: [Twisted-Python] hardcoded SIZE_LIMIT
In-Reply-To: <3747.1065602410@www48.gmx.net>
References: <3747.1065602410@www48.gmx.net>
Message-ID: <20031008144621.GA18389@intarweb.us>

On Wed, Oct 08, 2003 at 10:40:10AM +0200, Christoph Wiedemann wrote:
> Hello,
> 
> i'm trying to use PB for remote procedure calls in the context of numeric
> computations. So far things work really well (Twisted is a real cool piece of
> software!), but now i'm trapped by twisted.spread.banana.SIZE_LIMIT. I need to
> send pretty much data over the network (~512 MB) and tried out to set the
> SIZE_LIMIT to 640 MB. Hmm, still getting the "String too long exception", cause
> the 640 kB are hardcoded in cBanana.c. Any chances to make the limit
> configurable ?
> 

  Check out twisted.spread.util.StringPager -- it uses the Producer/Consumer
pattern to send the string a piece at a time.  This will reduce memory usage
and probably increase network performance, since smaller chunks are being
serialized and transmitted only once the network is ready for them.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031008/42b0a2ed/attachment.sig>

From exarkun at twistedmatrix.com  Wed Oct  8 08:59:19 2003
From: exarkun at twistedmatrix.com (Jp Calderone)
Date: Wed, 8 Oct 2003 10:59:19 -0400
Subject: [Twisted-Python] Re: Twisted.Names question
In-Reply-To: <3F81BEAF.1060500@pandora.be>
References: <3F814C0A.8090704@pandora.be> <20031006135854.GA12361@intarweb.us> <3F81BEAF.1060500@pandora.be>
Message-ID: <20031008145919.GA18421@intarweb.us>

On Mon, Oct 06, 2003 at 09:12:47PM +0200, Rudy Schockaert wrote:
> [snip]
>
> I think it may help when I explain the problem.
>
 > There are a number of rather large organisations that each have their 
> own connection to the Internet. Besides this they are also connected to 
> a private WAN.
>
> The WAN provider wants to offer a kind of secure mail, in the sense that 
> email between these organisations is not routed over the Internet but 
> over the WAN. All traffic over the WAN is IPSec, thus secure.
> Reconfiguring all mail relay servers of all those organisations is an 
> impossible task and certainly not maintainable.
> The zone definitions for each of the organisations must remain 
> unchanged, other organisations must recieve the normal Internet address 
> as result on a MX query.
>
> The plan is to have a Twisted.Names server with only two caches and no 
> authorative zones or forwarders. The first cache will be preloaded with 
> MX records and A records that route the mail over the WAN. There will be 
> nothing in CacheResolver.cancel() so these entries are never removed. 
> When the records are served, they will be put in the last cache and stay 
> there for as long as the TTL dictates. This way I can override DNS 
> records without creating an authorative zone.
>
> Each organisation would have such a Twisted. Names server on 'the way 
> out'. The preloaded cache would then be synchronised with a centrally 
> managed Master Twisted.server.
> 
> Now, I proposed to have Twisted.Names forward queries it cannot resolv 
> itself  to the internet, but that seems unacceptable. They want that all 
> other queries are directly resolved by Internet DNS servers. They also 
> want the Master Twisted.Names server to act as a backup in case the 
> slave of the company is down or so. But on the other hand they don't 
> want all queries first sent to both Twisted.Names servers and only then 
> to the Internet. So they proposed to return referrals for each record 
> that is not in Twisted.Names.
> 

  This sounds like a complex problem, and I am by no means an expert,
however, I'll take a stab...

  Returning NS records of the authority for unhandled names is something
t.names doesn't support.  It should not be difficult to add, though.  This
would probably be done by creating a new kind of Resolver, once that just
looked up and return NS records, regardless of query type, and putting it at
the back of the resolver chain.

  Aside from implementing this, everything else for the scenario you
describe is probably already supported, the trick is just configuring all
the pieces properly.

  So, you probably want just two resolvers in a ResolverChain, in a server
running on the internal interface of each of these networks (I'm not sure if
this would be the WAN network, or a private network for each participating
organisation).  The first resolver would be your preloaded CacheResolver,
the second would be the new NS resolver described above.  Arguably the NS
resolver should be present in t.names for it to be a proper nameserver
anyway... but that is a different discussion :)

  I'm not sure I've said anything insightful, but I hope it helps.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031008/77f3f416/attachment.sig>

From itamar at itamarst.org  Wed Oct  8 10:09:50 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 12:09:50 -0400
Subject: [Twisted-Python] Woven subpage handling redirect deferred,
 Help!?!
In-Reply-To: <uk77gdrwg.fsf@inout.no>
References: <ud6dalbwx.fsf@inout.no>
	<20031006135553.GA1103@radii>
	<u3ce5lacw.fsf@inout.no>
	<3F830BA2.6080505@twistedmatrix.com>
	<uk77gdrwg.fsf@inout.no>
Message-ID: <20031008120950.6ad210bb.itamar@itamarst.org>

On 08 Oct 2003 11:01:51 +0200
Syver Enstad <syver at inout.no> wrote:

> Is there an upgrade path for applications that use the old cred
> system? What has to change in an application that usess old cred to
> use the new cred?

Not really. On the other hand I've ported some code and it was quite
easy.

The change is to get rid of perspectives/identities/authorizers/services
are authentication building blocks, since they don't make sense at all.

Instead you have:
1. avatar - business logic for specific user (in PB these are
perspectives, in pop3 these are mailboxes, etc..)
2. realm - stores avatars and perhaps general business logic (kinda like
services in old cred.)
3. credentials - a username/password, public key, something
4. credential checker - where authentication actually happens
5. portal - glues credential checkers and realms together.

So for example in pop3, you create a realm that serves mailbox avatars
based on an avatar id. You wrap this realm in a portal, and add a
credential checker that authenticates username/passwords against
/etc/passwd, and register this portal with the pop3 protocol.

When someone logins, the pop3 protocol creates a credential object,
hands it to the portal, and asks for IMailbox. Portal passes credentials
to credential checker, gets back avatar id, passes avatar id to realm,
gets mailbox, returns it to user.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Wed Oct  8 10:16:15 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 12:16:15 -0400
Subject: [Twisted-Python] pb.Referenceable: wxPython client crash and
 server exceptions
In-Reply-To: <3F827D75.70803@is.lg.ua>
References: <3F827D75.70803@is.lg.ua>
Message-ID: <20031008121615.310c0ce7.itamar@itamarst.org>

On Tue, 07 Oct 2003 11:46:45 +0300
Ruslan Spivak <alienoid at is.lg.ua> wrote:

> Clients connect to server and passes their pb.Referenceable. Server 
> every minute calls clients remote methods.
> After 8-9 hours of continuous work client crashes(it's compiled into 
> windows .exe with py2exe) and in my twistd.log i see such lines:

Add the tracebacks from server side (there may be one or two) to the bug
tracker. With only this traceback I really have no idea :( Hopefully
there is more info on the server's logs.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From justinjohnson at fastmail.fm  Wed Oct  8 11:52:30 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 08 Oct 2003 11:52:30 -0600
Subject: [Twisted-Python] Woven subpage handling redirect deferred, Help!?!
In-Reply-To: <20031008120950.6ad210bb.itamar@itamarst.org>
References: <ud6dalbwx.fsf@inout.no>
 	<20031006135553.GA1103@radii>
 	<u3ce5lacw.fsf@inout.no>
 	<3F830BA2.6080505@twistedmatrix.com>
 	<uk77gdrwg.fsf@inout.no> <20031008120950.6ad210bb.itamar@itamarst.org>
Message-ID: <20031008175230.A9B6F39AB3@www.fastmail.fm>

Are you saying Avatars should be used instead of Perspectives?  I have a
PB service with a bunch of perspective_* methods.  I'm now trying to add
a web interface that has certain levels of privileges associated with the
logins.  Currently it would just be and Admin role and a normal User
role.  Do perspectives not fit into this anymore?



On Wed, 8 Oct 2003 12:09:50 -0400, "Itamar Shtull-Trauring"
<itamar at itamarst.org> said:
> On 08 Oct 2003 11:01:51 +0200
> Syver Enstad <syver at inout.no> wrote:
> 
> > Is there an upgrade path for applications that use the old cred
> > system? What has to change in an application that usess old cred to
> > use the new cred?
> 
> Not really. On the other hand I've ported some code and it was quite
> easy.
> 
> The change is to get rid of perspectives/identities/authorizers/services
> are authentication building blocks, since they don't make sense at all.
> 
> Instead you have:
> 1. avatar - business logic for specific user (in PB these are
> perspectives, in pop3 these are mailboxes, etc..)
> 2. realm - stores avatars and perhaps general business logic (kinda like
> services in old cred.)
> 3. credentials - a username/password, public key, something
> 4. credential checker - where authentication actually happens
> 5. portal - glues credential checkers and realms together.
> 
> So for example in pop3, you create a realm that serves mailbox avatars
> based on an avatar id. You wrap this realm in a portal, and add a
> credential checker that authenticates username/passwords against
> /etc/passwd, and register this portal with the pop3 protocol.
> 
> When someone logins, the pop3 protocol creates a credential object,
> hands it to the portal, and asks for IMailbox. Portal passes credentials
> to credential checker, gets back avatar id, passes avatar id to realm,
> gets mailbox, returns it to user.
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From itamar at itamarst.org  Wed Oct  8 12:46:42 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 14:46:42 -0400
Subject: [Twisted-Python] Cred and perspectives
In-Reply-To: <20031008175230.A9B6F39AB3@www.fastmail.fm>
References: <ud6dalbwx.fsf@inout.no>
	<20031006135553.GA1103@radii>
	<u3ce5lacw.fsf@inout.no>
	<3F830BA2.6080505@twistedmatrix.com>
	<uk77gdrwg.fsf@inout.no>
	<20031008120950.6ad210bb.itamar@itamarst.org>
	<20031008175230.A9B6F39AB3@www.fastmail.fm>
Message-ID: <20031008144642.3e6b99a4.itamar@itamarst.org>

On Wed, 08 Oct 2003 11:52:30 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> Are you saying Avatars should be used instead of Perspectives?  I have
> a PB service with a bunch of perspective_* methods.  I'm now trying to
> add a web interface that has certain levels of privileges associated
> with the logins.  Currently it would just be and Admin role and a
> normal User role.  Do perspectives not fit into this anymore?

For non-PB protocols, there are no longer perspectives (for pop3 the
avatar is a mailbox, there is no perspective). For PB, the avatar is a
perspective (typically a subclass of pb.Perspective).

Priviliges and roles are no longer cred's responsibility (the whole
"lets map x perspectives to an identity and stuff"). Write your own
system on top of it if you need to.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From miguel at yorku.ca  Wed Oct  8 12:58:10 2003
From: miguel at yorku.ca (Miguel Marques)
Date: Wed, 08 Oct 2003 14:58:10 -0400 (EDT)
Subject: [Twisted-Python] SSL client certificate verification...
Message-ID: <20031008.145810.122273519.miguel@yorku.ca>

Greetings...

I have a twisted application based on XMLRPC which uses SSL.  I need to
validate client certificates and then somehow retrieve the CN from the
peer certificate from the xmlrpc_* routines.  I've figured out so far
how to do certificate validation and that works fine. 

I'm having a bit of difficulty figuring out how to get the CN.  I'm
trying to get it from the twisted.web.server.Request passed to the
render method of xmlrpc.XMLRPC.  I suspect somewhere in there is the
OpenSSL Connection object I can call get_peer_certificate() on.
But I'm not sure where...
Any pointers in the right direction would be greatly appreciated.
TIA...

							Miguel

C. Miguel Marques, Development Services, Computing and Network Services, York University
e-mail: miguel at yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830




From uwe at oss4u.com  Wed Oct  8 13:29:05 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Wed, 8 Oct 2003 12:29:05 -0700
Subject: [Twisted-Python] hardcoded SIZE_LIMIT
In-Reply-To: <3747.1065602410@www48.gmx.net>
References: <3747.1065602410@www48.gmx.net>
Message-ID: <200310081229.05858.uwe@oss4u.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


I asked the same thing a while back.
Actually from the way Twisted is designed it's a good thing to have the size 
limited. If you transfer large files in a return 
like in

x=file(large_file)
return x.read()

you might end up with a pretty sluggish twisted, specially in a heavy multi 
user environment. I switched to use the pager, which allows twisted to 
transfer the file at it's own pace, and allows you to put in a preogress 
dialog pretty easily since there is a callback on the chunks transmitted.
Go the extra mile to understand the pager - it's worth it in the long run.


On Wednesday 08 October 2003 01:40 am, Christoph Wiedemann wrote:
> Hello,
>
> i'm trying to use PB for remote procedure calls in the context of numeric
> computations. So far things work really well (Twisted is a real cool piece
> of software!), but now i'm trapped by twisted.spread.banana.SIZE_LIMIT. I
> need to send pretty much data over the network (~512 MB) and tried out to
> set the SIZE_LIMIT to 640 MB. Hmm, still getting the "String too long
> exception", cause the 640 kB are hardcoded in cBanana.c. Any chances to
> make the limit configurable ?
>
> Regards,
> Christoph
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

- -- 
	UC

- --
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE/hGWBjqGXBvRToM4RAroSAKCGbcgQgbnMBCaZ8nRhussM+5zHnQCfQBCt
HqInqRFNkOGmxeRWWpkN3OY=
=wKyI
-----END PGP SIGNATURE-----




From itamar at itamarst.org  Wed Oct  8 13:49:42 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 15:49:42 -0400
Subject: [Twisted-Python] SSL client certificate verification...
In-Reply-To: <20031008.145810.122273519.miguel@yorku.ca>
References: <20031008.145810.122273519.miguel@yorku.ca>
Message-ID: <20031008154942.6c4264f0.itamar@itamarst.org>

On Wed, 08 Oct 2003 14:58:10 -0400 (EDT)
Miguel Marques <miguel at yorku.ca> wrote:

> I'm having a bit of difficulty figuring out how to get the CN.  I'm
> trying to get it from the twisted.web.server.Request passed to the
> render method of xmlrpc.XMLRPC.  I suspect somewhere in there is the
> OpenSSL Connection object I can call get_peer_certificate() on.
> But I'm not sure where...
> Any pointers in the right direction would be greatly appreciated.
> TIA...

request.channel.transport.getPeerCertificate() I think, except this
won't work for pipelining clients at the moment. Arguably auth should be
done when the client connects - you can do this with custom
ContextFactory that creates Contexts that do verification callback.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From miguel at yorku.ca  Wed Oct  8 14:59:37 2003
From: miguel at yorku.ca (Miguel Marques)
Date: Wed, 08 Oct 2003 16:59:37 -0400 (EDT)
Subject: [Twisted-Python] SSL client certificate verification...
In-Reply-To: <20031008154942.6c4264f0.itamar@itamarst.org>
References: <20031008.145810.122273519.miguel@yorku.ca>
	<20031008154942.6c4264f0.itamar@itamarst.org>
Message-ID: <20031008.165937.88655788.miguel@yorku.ca>

Greetings...
On Wed, 8 Oct 2003 15:49:42 -0400, Itamar Shtull-Trauring <itamar at itamarst.org> wrote:
> On Wed, 08 Oct 2003 14:58:10 -0400 (EDT)
> Miguel Marques <miguel at yorku.ca> wrote:
> 
> > I'm having a bit of difficulty figuring out how to get the CN.  I'm
> > trying to get it from the twisted.web.server.Request passed to the
> > render method of xmlrpc.XMLRPC.  I suspect somewhere in there is the
> > OpenSSL Connection object I can call get_peer_certificate() on.
> > But I'm not sure where...
> > Any pointers in the right direction would be greatly appreciated.
> > TIA...
> 
> request.channel.transport.getPeerCertificate() I think, except this
Thanks, request.channel.transport.socket.get_peer_certificate() did
the trick and things seem to work...

> won't work for pipelining clients at the moment. Arguably auth
> should be done when the client connects - you can do this with custom
> ContextFactory that creates Contexts that do verification callback.

Agreed,  except in this case each xmlrpc procedure has a list of CN's
allowed to call it, so I can only check the CN of the connection's
certificate against that, when I know which xmlrpc procedure they are
trying to call...  (I do use a custom ContextFactory to cause the
client certificate to be checked against my CA)

I've just started using Twisted and I'm not sure what you mean by
'won't work for pipelining clients'?
Could you explain?
Thanks!

							Miguel

C. Miguel Marques, Development Services, Computing and Network Services, York University
e-mail: miguel at yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830



From itamar at itamarst.org  Wed Oct  8 15:41:03 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 8 Oct 2003 17:41:03 -0400
Subject: [Twisted-Python] SSL client certificate verification...
In-Reply-To: <20031008.165937.88655788.miguel@yorku.ca>
References: <20031008.145810.122273519.miguel@yorku.ca>
	<20031008154942.6c4264f0.itamar@itamarst.org>
	<20031008.165937.88655788.miguel@yorku.ca>
Message-ID: <20031008174103.2c4215d3.itamar@itamarst.org>

On Wed, 08 Oct 2003 16:59:37 -0400 (EDT)
Miguel Marques <miguel at yorku.ca> wrote:

> I've just started using Twisted and I'm not sure what you mean by
> 'won't work for pipelining clients'?
> Could you explain?
> Thanks!

Um. Actually never mind, this should work fine regardless. (For the
record pipelining means sending a series of requests without waiting for
responses in between.)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From alex at veresk.ru  Wed Oct  8 17:48:03 2003
From: alex at veresk.ru (Alexander Zhukov)
Date: Thu, 9 Oct 2003 03:48:03 +0400
Subject: [Twisted-Python] Web server persistance
In-Reply-To: <000601c38c3e$fa5ee590$6401a8c0@ISLAND>
References: <000601c38c3e$fa5ee590$6401a8c0@ISLAND>
Message-ID: <200310090348.04025.alex@veresk.ru>

В сообщении от 6 Октябрь 2003 23:20 Ted Patrick написал(a):
> I have a project using Twisted as an http server.
>
> What is the best way to persistent server data across server start/stop?
>
> Example:
> While the server is running, a user will add virtual directories via a .rpy
> application as follows:
>
> root.putChild(name, path)
>
> Ideally modifications to the server configuration would persist across
> server start/stop. I would also like a generic format to store data related
> to a particular leaf of an application as follows:
>
> //url  http://mytwisted/dog/cat/document.txt
> //data pertaining to this url could be added at
> root.dog.cat.document.txt = 33
>
> This data would also be persistent.
>

The simplest way is to use registry. There are some examples in 
http://www.twistedmatrix.com/documents/howto/using-twistedweb

Or you can use Cog - an object database written in python if you need advanced 
persistence options. http://www.itamarst.org/software/cog/
For an example you can have a look at StikiWiki code 
http://mithrandr.moria.org/code/stikiwiki/




From stuart.hungerford at anu.edu.au  Wed Oct  8 18:52:38 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Thu, 09 Oct 2003 10:52:38 +1000
Subject: [Twisted-Python] Woven page instances deferring to each
  other...
In-Reply-To: <20031008100002.21436.65621.Mailman@pyramid.twistedmatrix.c
 om>
References: <20031008100002.21436.65621.Mailman@pyramid.twistedmatrix.com>
Message-ID: <6.0.0.22.0.20031009104127.01ecb2a8@anusf.anu.edu.au>

Quoth twisted-python-request at twistedmatrix.com:

 >On Wed, Oct 08, 2003, Stuart Hungerford wrote:
 >> In another Woven page the application can detect these
 >> "error" states and I would like to optionally "defer" the HTML
 >> generation to the existing error pages:
 >
 >I *think* here you mean "I'd like totally different HTML generated if
 >there is an error state", rather than "my check for the error returns a
 >Deferred object". Let me know if I'm wrong.

    Quite right -- I did mean "totally different HTML", it was a poor
    choice of terms after too little thought ;-)

 >Assuming you meant "I'd like totally different HTML generated if
 >there is an error state" you probably do want macros or something like
 >them. The best documentation I've seen on this is here:
 >http://twistedmatrix.com/pipermail/twisted-python/2003-June/004662.html

    Thanks -- I'll check that out.

 >Followup...
 >
 >A nicer solution may be to have the parent Page (by this I mean
 >http://example.com/bob/ is a parent and http://example.com/bob/result/
 >is a child -- parents in the URL structure) do the check and return an
 >object of a different Page class, something like:
 >
 >class MyParentPage(page.Page):
 >
 >    def getDynamicChild(self, name, request):
 >
 >        if error_condition_1:
 >            return ErrorPage1()
 >        elif error_condition_2:
 >            return ErrorPage2()
 >        else:
 >            return NormalChildPage()
 >
 >If there's any way you can determine if the error has happened before
 >the child page starts rendering, then I suspect it would be nicer to do
 >the error check at child creation time, rather than when the child
 >renders.

    I can see the sense in this approach, but it does have the effect
    pushing implementation of business rules from the wvupdate_foo()
    functions into creation time checks.  Although, that may be a good
    thing, I haven't really got a feel yet for what constitutes "good"
    Twisted or Woven idioms.

 >[...]
 >Since woven renders the entire page before it calls request.write, any
 >portion of the view rendering code which detects an error is able to
 >call request.redirect (because we can still set headers since we
 >haven't written any of the body yet). Just thought I'd chuck that out
 >there, it may be totally irrelevant.

    This could also be very useful, as Mary points out, it gives us a
    choice of where the application logic can be based.

    Many thanks to all for the help!


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From snesbitt at cobaltgroup.com  Wed Oct  8 20:21:02 2003
From: snesbitt at cobaltgroup.com (Nesbitt, Steve)
Date: Wed, 8 Oct 2003 19:21:02 -0700 
Subject: [Twisted-Python] newbie: groking flows
Message-ID: <25160AB2660F8B449892B0EB9C29C165CE5612@ex-sea-is2.cobaltgroup.com>

All:

I'm trying to grok flows in general and how to mix cooperative and blocking
flows in particular. I've been reviewing the documentation and have a better
understanding, but something is still eluding me. I'm hoping someone can
help me out with either some pseudocode (or a real world example)

Here's my design problem:
When I start the server, I generate a series of lookup table objects (called
"registries") by parsing through a series of XML files. XML-RPC requests
come in requesting information and these registries are then used to help
fulfill the request. Periodically, albeit infrequently, one of the original
source XML files may change and an XML-RPC call will request that the
registries be updated/regenerated. During the regeneration process, which
can take multiple seconds, all lookup and additional regeneration requests
should block until completion of the regeneration. Once completed, blocked
requests should resume.

Based on my reading I think this is what should do:
1) Periodically during a lookup call a flow.Cooperate event to allow other
lookup events from other requests to be handled.

2) To avoid a regeneration event in the midst of a lookup, I should make
sure that a flow.Cooperate event is *not* issued at any time during a
critical part of the lookup process ( In other words one can consider the
code executed between two flow.Cooperate statements as a transaction)

3) When I start a regeneration event I should wrap the regeneration method
in a flow.Block controller.


So here are some specific questions:
1) Is my basic understanding correct? In particular am I guaranteed correct
behavior using the above outline?

2) Am I correct in believing that wrapping a method in flow.Block actually
executes the method? That is, the statement flow.Block( foo( bar ) )
   executes foo.bar immediately?

3) How do I access the results of flow.Block( foo( bar ) )? In particular
how do I see the return result or any exceptions tr\hrown by foo?

4) Am I correct in believing that while flow.Block( foo(bar) ) is executing
any incoming requests will be prevented from executing?

5) Is it possible to defer a blocking method? This covers the scenario where
two regeneration events occur within the same time frame.


Thanks in advance for the help and sorry for the length of the post. I'll be
glad to write thisx up as a how to if that would be helpful.


Thanks in advance for the help.

-steve

Stephen Nesbitt
Senior Configuration Management Engineer
The Cobalt Group
snesbitt at cobaltgroup.com






This e-mail transmission contains information intended only for the use of
the recipient(s) named above. Further, it contains information that may be
privileged and confidential. If you are not the intended recipient, you are
hereby notified that any dissemination, distribution, or copying of this
message (including any attachments) is strictly prohibited. If you have
received this e-mail in error, please notify the sender by reply e-mail and
then delete this message from your mail system. Thank you for your
compliance.



From justinjohnson at fastmail.fm  Thu Oct  9 11:10:30 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 09 Oct 2003 11:10:30 -0600
Subject: [Twisted-Python] guard.UsernamePasswordWrapper errback
Message-ID: <20031009171030.BA398133C0@www.fastmail.fm>

I got a woven login page working by copying
Twisted/sandbox/glyph/dynademo where guard.UsernamePasswordWrapper is
used.  In the dynademo example, if the password is entered incorrectly,
an error page displays as documented in the doc strings for
UsernamePasswordWrapper.  The problem is that it displays the error on a
new page.  I'd like to capture the error in an existing html file.  So I
added the errback argument as follows:

r = guard.SessionWrapper(guard.UsernamePasswordWrapper(p,
callback=dumbRedirect, errback=dumbRedirect))

This redirects me back to the main page.  Is there some sort of view or
model available signaling that an error occurred, which I could put in my
main page?  Something like:

<div view="login_error"/>

Is there a better way to do this?

Thanks.
-Justin



From cce at clarkevans.com  Thu Oct  9 13:14:30 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Thu, 9 Oct 2003 19:14:30 +0000
Subject: [Twisted-Python] newbie: groking flows
In-Reply-To: <25160AB2660F8B449892B0EB9C29C165CE5612@ex-sea-is2.cobaltgroup.com>
References: <25160AB2660F8B449892B0EB9C29C165CE5612@ex-sea-is2.cobaltgroup.com>
Message-ID: <20031009191430.GA91506@clarkevans.com>

On Wed, Oct 08, 2003 at 07:21:02PM -0700, Nesbitt, Steve wrote:
| During the regeneration process, which
| can take multiple seconds, all lookup and additional regeneration requests
| should block until completion of the regeneration. Once completed, blocked
| requests should resume.
| 
| Based on my reading I think this is what should do:
| 1) Periodically during a lookup call a flow.Cooperate event to allow other
| lookup events from other requests to be handled.

Right.

| 2) To avoid a regeneration event in the midst of a lookup, I should make
| sure that a flow.Cooperate event is *not* issued at any time during a
| critical part of the lookup process ( In other words one can consider the
| code executed between two flow.Cooperate statements as a transaction)

Right.

| 3) When I start a regeneration event I should wrap the regeneration method
| in a flow.Block controller.

flow.Block is primarly there for testing; I should remove it from
the public interface.  Basically, it does just that, it blocks
*everything* -- which is, of course, not what you want.

You should instead use flow.Deferred( <generator> ) to create
your data flows, when you run flow.Deferred it:

  1. schedules your generator to be run using reactor.callLater(0, ...)
     so, flow.Deferred returns almost immediately and does not run
     your code till the current code finishes running;

  2. for each time you return flow.Cooperate, it reschedules your
     generator to be executed later, ie, reactor.callLater(0, ...)

  3. after your generator finishes, the deferred that was created
     by flow.Deferred runs its callbacks; you should probably install
     an error handler here, ie  flow.Deferred(<generator)>.addErrback(...)

I hope this helps.

...

| 1) Is my basic understanding correct? In particular am I guaranteed correct
| behavior using the above outline?

You are close; s/flow.Block/flow.Deferred/

| 2) Am I correct in believing that wrapping a method in flow.Block actually
| executes the method? That is, the statement flow.Block( foo( bar ) )
|    executes foo.bar immediately?

Not immediately, but close enough (it is put on the reactor's queue
to be executed shortly)

| 3) How do I access the results of flow.Block( foo( bar ) )? In particular
| how do I see the return result or any exceptions tr\hrown by foo?

def good(results):
    print "good", results
def bad(failure):
    print "bad", failure

d = flow.Deferred()
d.addCallback(good)
d.addErrback(bad)


...

If you _really_ want to use flow.Block, then flow.Block executes
the function immediately and returns a list containing the results.

| 4) Am I correct in believing that while flow.Block( foo(bar) ) is executing
| any incoming requests will be prevented from executing?

For flow.Block, yes.  For flow.Deferred, no.

| 5) Is it possible to defer a blocking method? This covers the scenario where
| two regeneration events occur within the same time frame.

Yes, use flow.Deferred  

To handle your case where there is a "regeneration" happening,
suppose you have a object 'gList' which gets regenerated periodically.
Your generator could do...

   def gen():
       while gList.generating():
           yield flow.Cooperate()
       # access the gList that is not generating

Best,

Clark 



From syver-en at online.no  Thu Oct  9 16:01:17 2003
From: syver-en at online.no (Syver Enstad)
Date: 10 Oct 2003 00:01:17 +0200
Subject: [Twisted-Python] resource navigation
Message-ID: <usmm2rryq.fsf@online.no>

Let's say I have a hierarchy of resources like this:

grandparent
  parent1
  parent2
     child1
     child2
        grandchild

Is there an easy way to know at runtime what url goes to let's say
parent2? I am interested primarily because I am interested in having
as self contained page classes as possible and hardcoding links to
parent2 in grandchilds view template seems brittle.

Woven seems to be strangely symetric regarding models and pages. An
example is getChild / getSubmodel and on top of that wchild_ /
wmfactory_. The woven model framwork supports asking parents of a
model if a submodel name can't be found, it might be interesting to
have something similar for resources so that one can have link's on a
child page that will be resolved by the parent.


-- 

Vennlig hilsen 

Syver Enstad




From justinjohnson at fastmail.fm  Fri Oct 10 07:37:04 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 10 Oct 2003 07:37:04 -0600
Subject: [Twisted-Python] woven dynamic table cell updating
Message-ID: <20031010133704.DFD953E3B7@www.fastmail.fm>

I have some code (attached ui.py) that creates a table displaying results
of running tasks.  The rows are tasks and the columns are step numbers in
that task.  I use this table when I make a bunch of requests into PB
servers running on multiple machines.  As those tasks move forward, the
PB server calls back into the client (which has a perspective_* method)
to update the status of that task/step.  An 'I' appears for 'in
progress', 'S' for 'success', and 'F' for 'failure'.  If there are
failures, I display the details once the entire table is populated and
all tasks are complete.

      | 1 | 2 | 3 | 4 | 5 | status
--------------------------------------
task1 | S | S | S | S | S | success
--------------------------------------
task2 | S | S | I | I | I | in progress
--------------------------------------
task3 | S | S | I | I | I | in progress
--------------------------------------
task4 | S | S | I | I | I | in progress
--------------------------------------
task5 | I | I | I | I | I | in progress
--------------------------------------

In the console based version each time the PB server task calls back into
the client to update the status, it also requests that the client
redisplay the screen.  So the screen redraws quite often.  Does anyone
know how I could do something similar with woven?  My thought was that
this will require LivePage, but I'm not sure.  Anyone have any
thoughts/suggestions?  I've attached (in widgets.py) my first attempt at
porting the results table to woven.

Thank you.
-Justin

P.S.

To run the attached file, you'll need to get the following modules.

WConio: http://newcenturycomputers.net/projects/wconio.html

    Windows Console I/O
    1.5 or later.

anycons: http://newcenturycomputers.net/projects/anycons.html

    Simple Universal Console I/O
    1.1 or later.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ui.py
Type: application/unknown
Size: 4438 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031010/82e653e7/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: widgets.py
Type: application/unknown
Size: 4040 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031010/82e653e7/attachment-0005.bin>

From dp at twistedmatrix.com  Fri Oct 10 09:56:02 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 10 Oct 2003 11:56:02 -0400
Subject: [Twisted-Python] resource navigation
In-Reply-To: <usmm2rryq.fsf@online.no>
References: <usmm2rryq.fsf@online.no>
Message-ID: <3FC01D1A-FB3A-11D7-A3F0-000A95864FC4@twistedmatrix.com>

On Oct 9, 2003, at 6:01 PM, Syver Enstad wrote:

>
> Let's say I have a hierarchy of resources like this:
>
> grandparent
>   parent1
>   parent2
>      child1
>      child2
>         grandchild
>
> Is there an easy way to know at runtime what url goes to let's say
> parent2? I am interested primarily because I am interested in having
> as self contained page classes as possible and hardcoding links to
> parent2 in grandchilds view template seems brittle.

Indeed. I have been experimenting with techniques for making all the 
Resource subclasses in a resource tree ignorant of each other for a 
while. One useful technique, if your path segments have meaningful 
names, is to simply use request.prepath to build a view of links 
leading to the current object (or "breadcrumbs"):

def wvupdate_breadcrumbs(self, request, widget, data):
	l = lmx(widget)
	fullpath = '/' # let us assume our application is installed at the 
root of the webserver
	for pathsegment in request.prepath:
		fullpath += pathsegment + '/'
		l.a(href= fullpath).text(pathsegment)

But this is only useful for rendering immediate ancestors, and also the 
only text you can put in the anchor tag is the actual pathsegment which 
shows up in the URL.

> Woven seems to be strangely symetric regarding models and pages. An
> example is getChild / getSubmodel and on top of that wchild_ /
> wmfactory_. The woven model framwork supports asking parents of a
> model if a submodel name can't be found, it might be interesting to
> have something similar for resources so that one can have link's on a
> child page that will be resolved by the parent.

Woven models keep track of the parents they were looked up from using 
IModel wrappers, but Resources, being a significantly older API, do 
not. As I mentioned above, I have been experimenting with techniques in 
this area recently, and one of the ideas I have come up with is in 
Quotient. (Note that while the code is in Quotient, nothing actually 
uses it yet.)

To use this technique, you have to control getChild (or you could 
rewrite getChildForRequest -- but that's an exercise for the reader). 
The idea is to gather a list of all the objects that had a getChild 
called on them for a given request. Here's the trick:

class IObjectCrumbs(components.Interface):
     """An interface on the request which keeps track of the list
     objects that were involved in the url traversal process
     for this request.
     """

components.registerAdapter(lambda _: [], server.Request, IObjectCrumbs)

class MyPageSubclass(page.LivePage):
     def getChild(self, name, request):
         rv = page.LivePage.getChild(self, name, request) # substitute 
Page if you aren't using LivePage
         if name != '' or request.prepath == ['']:
             IObjectCrumbs(request).append(rv)
         return rv

Once you have installed this getChild on all of the Resource objects 
involved in your application's Resource tree, you can then at any point 
in the render process get an IObjectCrumbs adapter on the request to 
get the list of actual instances which correspond with the path 
segments in request.prepath. What you do with them is then up to you; 
the most obvious things that come to mind are asking the instances to 
render a nicely formatted anchor instead of using the pathsegment text 
in the breadcrumbs example above, and introspecting the instances to 
see which child names they are capable of rendering (which you will 
have to do in a fairly application-specific manner; because of 
getChild, it isn't possible to write a general solution which lists all 
valid child names for a given resource).

I'm still trying to find the best solution to this problem in Quotient, 
and it would be really great if we could get it to the point where we 
could provide a Widget which anyone could drop into any Page anywhere 
in the Resource tree, and it would render a nice tree of links the user 
can use to navigate, but we're probably quite a ways off from actually 
being able to do that in a sane manner.

dp




From justinjohnson at fastmail.fm  Fri Oct 10 10:08:34 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 10 Oct 2003 10:08:34 -0600
Subject: [Twisted-Python] woven dynamic table cell updating (w/ LivePage)
In-Reply-To: <20031010133704.DFD953E3B7@www.fastmail.fm>
References: <20031010133704.DFD953E3B7@www.fastmail.fm>
Message-ID: <20031010160834.9DA1E3DDE4@www.fastmail.fm>

I decided to use images to display the status, and then have a server
side event send javascript to the page to change the src attribute of the
images.

I got the table displaying properly, and setup the following event
handler so that when I click a specific link, the server sends javascript
to the page to change the image src:

class MyEventHandler(input.Anything):
    def initialize(self):
        self.view.addEventHandler("onclick", self.onClick)
    
    def onClick(self, request, widget):
        currentPage = request.getSession(interfaces.IWovenLivePage)
         
        script = """
        document.images.task1_step1.src = "/images/S.gif" 
        """
        currentPage.sendScript(script)
        print self, "CLICKED!!!"

I verified that the image has a name attribute set to task1_step1.  When
I click, the javascript is sent, but I get the following javascript
error:

Error: 'document.images.task1_step1 is null or not an object

I tried using document.images[0].src instead, and got a similar error:

Error: 'document.images.0' is null or not an object

Do I have to do something goofy to reference things with javascript when
it is sent using LivePage?

Thanks again for answering my numerous questions.
-Justin


On Fri, 10 Oct 2003 07:37:04 -0600, "Justin Johnson"
<justinjohnson at fastmail.fm> said:
> I have some code (attached ui.py) that creates a table displaying results
> of running tasks.  The rows are tasks and the columns are step numbers in
> that task.  I use this table when I make a bunch of requests into PB
> servers running on multiple machines.  As those tasks move forward, the
> PB server calls back into the client (which has a perspective_* method)
> to update the status of that task/step.  An 'I' appears for 'in
> progress', 'S' for 'success', and 'F' for 'failure'.  If there are
> failures, I display the details once the entire table is populated and
> all tasks are complete.
> 
>       | 1 | 2 | 3 | 4 | 5 | status
> --------------------------------------
> task1 | S | S | S | S | S | success
> --------------------------------------
> task2 | S | S | I | I | I | in progress
> --------------------------------------
> task3 | S | S | I | I | I | in progress
> --------------------------------------
> task4 | S | S | I | I | I | in progress
> --------------------------------------
> task5 | I | I | I | I | I | in progress
> --------------------------------------
> 
> In the console based version each time the PB server task calls back into
> the client to update the status, it also requests that the client
> redisplay the screen.  So the screen redraws quite often.  Does anyone
> know how I could do something similar with woven?  My thought was that
> this will require LivePage, but I'm not sure.  Anyone have any
> thoughts/suggestions?  I've attached (in widgets.py) my first attempt at
> porting the results table to woven.
> 
> Thank you.
> -Justin
> 
> P.S.
> 
> To run the attached file, you'll need to get the following modules.
> 
> WConio: http://newcenturycomputers.net/projects/wconio.html
> 
>     Windows Console I/O
>     1.5 or later.
> 
> anycons: http://newcenturycomputers.net/projects/anycons.html
> 
>     Simple Universal Console I/O
>     1.1 or later.



From dp at twistedmatrix.com  Fri Oct 10 10:19:10 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Fri, 10 Oct 2003 12:19:10 -0400
Subject: [Twisted-Python] woven dynamic table cell updating (w/ LivePage)
In-Reply-To: <20031010160834.9DA1E3DDE4@www.fastmail.fm>
References: <20031010133704.DFD953E3B7@www.fastmail.fm> <20031010160834.9DA1E3DDE4@www.fastmail.fm>
Message-ID: <7AD39831-FB3D-11D7-A3F0-000A95864FC4@twistedmatrix.com>

On Oct 10, 2003, at 12:08 PM, Justin Johnson wrote:

> Do I have to do something goofy to reference things with javascript 
> when
> it is sent using LivePage?

'document' in the context of a clientToServer event is the IFrame in 
which the event was sent to the server. So I believe the correct way to 
reference things would be through parent.document.

dp




From justinjohnson at fastmail.fm  Fri Oct 10 10:29:08 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 10 Oct 2003 10:29:08 -0600
Subject: [Twisted-Python] woven dynamic table cell updating (w/ LivePage)
In-Reply-To: <7AD39831-FB3D-11D7-A3F0-000A95864FC4@twistedmatrix.com>
References: <20031010133704.DFD953E3B7@www.fastmail.fm> <20031010160834.9DA1E3DDE4@www.fastmail.fm> <7AD39831-FB3D-11D7-A3F0-000A95864FC4@twistedmatrix.com>
Message-ID: <20031010162908.2EDC13E40E@www.fastmail.fm>

Great!  It works now.  Thank you much.

On Fri, 10 Oct 2003 12:19:10 -0400, "Donovan Preston"
<dp at twistedmatrix.com> said:
> 
> On Oct 10, 2003, at 12:08 PM, Justin Johnson wrote:
> 
> > Do I have to do something goofy to reference things with javascript 
> > when
> > it is sent using LivePage?
> 
> 'document' in the context of a clientToServer event is the IFrame in 
> which the event was sent to the server. So I believe the correct way to 
> reference things would be through parent.document.
> 
> dp
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From justinjohnson at fastmail.fm  Fri Oct 10 14:18:45 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 10 Oct 2003 14:18:45 -0600
Subject: [Twisted-Python] woven dynamic table cell updating (w/ LivePage)
In-Reply-To: <20031010162908.2EDC13E40E@www.fastmail.fm>
References: <20031010133704.DFD953E3B7@www.fastmail.fm> <20031010160834.9DA1E3DDE4@www.fastmail.fm> <7AD39831-FB3D-11D7-A3F0-000A95864FC4@twistedmatrix.com> <20031010162908.2EDC13E40E@www.fastmail.fm>
Message-ID: <20031010201845.925763D4AD@www.fastmail.fm>

Another question related to this.

Each cell in the table gets its image name from dict[task][step], where
task corresponds to a row and step corresponds to a column.  So if
dict[task][status] = 'S', then I send the javascript to the browser to
change the img src to be "/images/S.gif" for that cell.

Is there any way to add an event handler or some such thing to the model
(that being the dict) so that everytime a new status is entered, the
javascript gets sent to the browser and the correct image is displayed?

I saw the notify method, but didn't see any examples of it in action.

Thanks.
-Justin


On Fri, 10 Oct 2003 10:29:08 -0600, "Justin Johnson"
<justinjohnson at fastmail.fm> said:
> Great!  It works now.  Thank you much.
> 
> On Fri, 10 Oct 2003 12:19:10 -0400, "Donovan Preston"
> <dp at twistedmatrix.com> said:
> > 
> > On Oct 10, 2003, at 12:08 PM, Justin Johnson wrote:
> > 
> > > Do I have to do something goofy to reference things with javascript 
> > > when
> > > it is sent using LivePage?
> > 
> > 'document' in the context of a clientToServer event is the IFrame in 
> > which the event was sent to the server. So I believe the correct way to 
> > reference things would be through parent.document.
> > 
> > dp
> > 
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From alienoid at is.lg.ua  Sun Oct 12 14:18:59 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Sun, 12 Oct 2003 23:18:59 +0300
Subject: [Twisted-Python] disabling/resuming connections
Message-ID: <3F89B733.7000408@is.lg.ua>

Hello.

Is it possible programmatically tell my server to stop accept 
connections from remote clients and then enable it programmatically when 
i need?

I use PB based server.

Thanks in advance.

Best regards,
Ruslan




From exarkun at intarweb.us  Sun Oct 12 14:33:05 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 12 Oct 2003 16:33:05 -0400
Subject: [Twisted-Python] disabling/resuming connections
In-Reply-To: <3F89B733.7000408@is.lg.ua>
References: <3F89B733.7000408@is.lg.ua>
Message-ID: <20031012203305.GA25395@intarweb.us>

On Sun, Oct 12, 2003 at 11:18:59PM +0300, Ruslan Spivak wrote:
> Hello.
> 
> Is it possible programmatically tell my server to stop accept 
> connections from remote clients and then enable it programmatically when 
> i need?
> 
> I use PB based server.
> 

  If you are using PBServerFactory, it is easy --


    f = PBServerFactory(...)
    port = reactor.listenTCP(..., f)
    ...
    port.stopListening()
    ...
    port.startListening()
    ...


  If you're using the old PB API, I'm not sure how you'd do it.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031012/4f97f3bf/attachment.sig>

From syver-en at online.no  Sun Oct 12 14:52:18 2003
From: syver-en at online.no (Syver Enstad)
Date: 12 Oct 2003 22:52:18 +0200
Subject: [Twisted-Python] Rendering woven pages offline.
Message-ID: <uekxi2n7h.fsf@online.no>

I need to send a mail containing a woven page. Is it easy to setup
rendering the page offline rather than to an HTTP request?

-- 

Vennlig hilsen 

Syver Enstad




From dp at twistedmatrix.com  Sun Oct 12 16:53:35 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Sun, 12 Oct 2003 18:53:35 -0400
Subject: [Twisted-Python] Rendering woven pages offline.
In-Reply-To: <uekxi2n7h.fsf@online.no>
References: <uekxi2n7h.fsf@online.no>
Message-ID: <E9219B7B-FD06-11D7-BA74-000A95864FC4@twistedmatrix.com>

On Oct 12, 2003, at 4:52 PM, Syver Enstad wrote:

>
> I need to send a mail containing a woven page. Is it easy to setup
> rendering the page offline rather than to an HTTP request?

Yep, pretty easy. Just pass in a fake request to render, and capture 
the string passed to request.write. There is an example of doing this 
in test_woven. If you need more help, lemme know.

dp




From itamar at itamarst.org  Sun Oct 12 23:02:34 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 13 Oct 2003 01:02:34 -0400
Subject: [Twisted-Python] Status of 1.1 release
Message-ID: <20031013010234.054e4358.itamar@itamarst.org>

1. PB docs are half done, radix is working on them.
2. Cred docs are mostly done, I will finish them.
3. Application docs are done, by moshez (though some extra explanations
won't hurt).

Remaining issues:
1. Services use in static registry (deleting code mainly)
2. Update manhole (and manhole and telnet howtos)
3. What to do with words
4. Document guard

Things I'd like to have:
1. Mac OS X reactor (hello bob!)
2. Updater haifux tutorial

There are issues in the bug tracker for all of these.

I am hoping to have 1.1 out by the end of the week, if we can continue
this momentum, but this is a lot more likely if more people pitch in.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From wilk-ml at flibuste.net  Mon Oct 13 15:21:38 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Mon, 13 Oct 2003 23:21:38 +0200
Subject: [Twisted-Python] jabber
Message-ID: <87ad84hlzx.fsf@blakie.riol#flibuste.net>

Hi,

Is there any example of using jabber ?

I would like just to make a litle jabber client...

Thanks

-- 
William Dodé - http://flibuste.net



From bob at redivi.com  Mon Oct 13 16:25:39 2003
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 13 Oct 2003 18:25:39 -0400
Subject: [Twisted-Python] Twisted's cfreactor + PyObjC = Asynchronous Networking on OS X
Message-ID: <2C8A3280-FDCC-11D7-81D1-000A95686CD8@redivi.com>

For those of you who don't watch Twisted CVS, cfreactor is officially 
out of the sandbox.  cfreactor is the CoreFoundation integration 
reactor for Twisted ( http://www.twistedmatrix.com/ ), which means that 
you can now seamlessly integrate Cocoa and Twisted (without digging 
around in my sandbox, that is).

If you're running OS X and you'd like to play with cfreactor, check out 
the latest CVS and do a python setup.py install (so that it can build 
twisted/internet/cfsupport.so -- ignore the warnings, they are expected 
for Pyrex modules).  There are two examples provided in 
doc/examples/Cocoa.  You will need PyObjC 1.0 (though it may work with 
earlier betas, you should upgrade if you haven't yet) and MacPython 2.3 
(not tested with Panther yet, but should work).  The next release 
version of Twisted, which is expected very shortly, will include this 
new reactor and updated documentation.  When it is released, it will 
also be available from my Package Manager repository ( 
http://undefined.org/python/pimp/ ).
	
	SimpleWebClient - Pretty much a straight port of 
doc/examples/qtdemo.py, a very simple app that downloads HTML and puts 
it in a text box.
	WebServicesTool - A Twisted port of b.bum's XML-RPC demo (which is 
included with PyObjC).  For fun, compare how much simpler the Twisted 
version is (since it doesn't need to deal with threads), and how much 
more responsive it feels.

To run either demo, use the buildapp.py script provided in the same 
folder as the application:
	python buildapp.py build

And then:
	open build/ApplicationName.app

Note that when using cfreactor you should *always* call reactor.run() 
while the NSRunLoop is in action (best place to put it is probably in 
your NSApplication delegate's applicationDidFinishLaunching_ method).  
If you're using threads, make sure to only call into Twisted from the 
main runLoop (which is where you have to do your drawing anyways).  And 
of course, you should cfreactor.install() before importing any other 
Twisted modules (see the "Choosing a Reactor and GUI Toolkit 
Integration" HOWTO for more information).

-bob




From dizzyd at jabber.org  Mon Oct 13 16:53:40 2003
From: dizzyd at jabber.org (Dave Smith)
Date: Mon, 13 Oct 2003 16:53:40 -0600
Subject: [Twisted-Python] jabber
In-Reply-To: <87ad84hlzx.fsf@blakie.riol#flibuste.net>
References: <87ad84hlzx.fsf@blakie.riol#flibuste.net>
Message-ID: <16C59931-FDD0-11D7-9CE7-00039386381C@jabber.org>

On Oct 13, 2003, at 3:21 PM, William Dode wrote:

> Hi,
>
> Is there any example of using jabber ?
>
> I would like just to make a litle jabber client...

I haven't yet had a chance to focus on the client aspect of Jabber 
support in twisted, but it is on my todo list for the next few days. 
I'll post when the support is in CVS, along with a basic example. :)

D.




From golux at comcast.net  Mon Oct 13 19:44:20 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Mon, 13 Oct 2003 21:44:20 -0400
Subject: [Twisted-Python] PB/wx example pbwxthingy
Message-ID: <3F8B54F4.50607@comcast.net>

Twisted Gurus,

For the 1.1 release, you might want to consider replacing the
old "wxdemo" example, which is pretty lame, with the really
cool wx-and-PB example posted to the list by Axel Busch on
Sept 20.  It works great and is an impressive example of
both PB and the application of Uwe Schroeder's recipe that
enables the use of the reactor within a wxPython app without
causing menus and modal dialogs to hang:

http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/181780

(There's also a nice docstring about the use of this in
pbwxthingy/client.py)

I've replaced the example's references to "Transport" (which
had nothing to do with network transports but was rather a
logistical application object) with "Thingy" so as to make the
example possibly less confusing in the context of the twisted
examples directory, and I've added a very brief README that
gives the basic procedure for running the example -- see attached.

Cheers,
Steve.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pbwxthingy.tar.gz
Type: application/x-tar
Size: 11836 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031013/f66236ba/attachment-0002.tar>

From andrew-twisted at puzzling.org  Mon Oct 13 20:14:38 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 14 Oct 2003 12:14:38 +1000
Subject: [Twisted-Python] Status of 1.1 release
In-Reply-To: <20031013010234.054e4358.itamar@itamarst.org>
References: <20031013010234.054e4358.itamar@itamarst.org>
Message-ID: <20031014021438.GB7341@frobozz>

On Mon, Oct 13, 2003 at 01:02:34AM -0400, Itamar Shtull-Trauring wrote:
> 
> Remaining issues:
> 1. Services use in static registry (deleting code mainly)
> 2. Update manhole (and manhole and telnet howtos)
> 3. What to do with words
> 4. Document guard

5. Intermittent buildbot failures for full-2.3 and freebsd buildslaves,
   e.g.:
       http://twistedmatrix.com/buildbot/full-2.3/events/486/summary
       http://twistedmatrix.com/buildbot/freebsd/events/422/summary

-Andrew.




From jonathan at embassynetworks.com  Tue Oct 14 03:05:17 2003
From: jonathan at embassynetworks.com (Jonathan Simms)
Date: Tue, 14 Oct 2003 05:05:17 -0400
Subject: [Twisted-Python] Woven Tutorial alpha is up for review
Message-ID: <20031014090517.GA23599@willie-the-pimp>

Hello all,

I've put together a tutorial on using Woven that is geared towards new
users, and I'm making it available for your edification (and critique).
I'm still working on it, but I'd say it's about 85% complete. You can
view it at:

http://www.embassynetworks.com/woven-tut/toc.xhtml


As of this moment, the program is not in a downloadable state 
(as I've got to re-arrange my source tree), but as soon as it is, I'll
make it available. 



Thanks, and enjoy!

 -Jonathan Simms (slyphon)


---
"Outside of the dog, a book is man's best friend,
Inside of the dog it's too dark to read."

                    -Groucho Marx


Jonathan Simms
jonathan at embassynetworks dot com




From wilk-ml at flibuste.net  Tue Oct 14 03:17:09 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Tue, 14 Oct 2003 11:17:09 +0200
Subject: [Twisted-Python] jabber
In-Reply-To: <16C59931-FDD0-11D7-9CE7-00039386381C@jabber.org> (Dave Smith's
 message of "Mon, 13 Oct 2003 16:53:40 -0600")
References: <87ad84hlzx.fsf@blakie.riol#flibuste.net>
	<16C59931-FDD0-11D7-9CE7-00039386381C@jabber.org>
Message-ID: <877k38mb56.fsf@blakie.riol#flibuste.net>

Dave Smith <dizzyd at jabber.org> writes:

> On Oct 13, 2003, at 3:21 PM, William Dode wrote:
>
>> Hi,
>>
>> Is there any example of using jabber ?
>>
>> I would like just to make a litle jabber client...
>
> I haven't yet had a chance to focus on the client aspect of Jabber
> support in twisted, but it is on my todo list for the next few
> days. I'll post when the support is in CVS, along with a basic
> example. :)

thanks in advance, i'll test it...

-- 
William Dodé - http://flibuste.net



From syver at inout.no  Tue Oct 14 06:31:27 2003
From: syver at inout.no (Syver Enstad)
Date: 14 Oct 2003 14:31:27 +0200
Subject: [Twisted-Python] Twisted file upload
Message-ID: <u8ynoq9uo.fsf@inout.no>

If there is a better way to get the filename of a posted file than the
code below, please tell me:

        """ this is a workaround because
        twisted web doesn't make the filename accessible
        on a form with enctype='multipart/form-data'
        
        """

        savedPosition = request.content.tell()
        try:
            request.content.seek(0)
            request.content.readline()
            match = re.search(r'filename="([^"]+)"',
                              request.content.readline())
            if match:
                return match.group(1)
            else:
                return None
        finally:
            request.content.seek(savedPosition)





From brian_l at mac.com  Mon Oct 13 21:24:13 2003
From: brian_l at mac.com (Brian Lenihan)
Date: Mon, 13 Oct 2003 20:24:13 -0700
Subject: [Twisted-Python] Re: [Pythonmac-SIG] Twisted's cfreactor + PyObjC = Asynchronous	Networking on OS X
In-Reply-To: <2C8A3280-FDCC-11D7-81D1-000A95686CD8@redivi.com>
References: <2C8A3280-FDCC-11D7-81D1-000A95686CD8@redivi.com>
Message-ID: <E26B1460-FDF5-11D7-A248-000A95841920@mac.com>

On Oct 13, 2003, at 3:25 PM, Bob Ippolito wrote:

> For those of you who don't watch Twisted CVS, cfreactor is officially 
> out of the sandbox.  cfreactor is the CoreFoundation integration 
> reactor for Twisted ( http://www.twistedmatrix.com/ ), which means 
> that you can now seamlessly integrate Cocoa and Twisted (without 
> digging around in my sandbox, that is).

This is really nice.  And the demos really are much more responsive.  
Nice work.




From justinjohnson at fastmail.fm  Tue Oct 14 07:49:11 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 14 Oct 2003 07:49:11 -0600
Subject: [Twisted-Python] woven and a web server in my plugin?
Message-ID: <20031014134911.CAB0B3EA8E@www.fastmail.fm>

I have a woven app I'm working on.  I used to use 'mktap web' to have
twisted serve the app, but I also need to start a PB server, so I created
a plugin.  The problem I'm having now is that I don't get the built-in
functionality of the web server, like serving out things like a
stylesheet in /templates/style.css, or images in /images.

Is there anyway to have my own plugin which adds the same functionality
as the web server so I don't have to write code to handle all of that?

What is the recommended way to handle this?

I've attached tap.py and login.py, 2 files that kinda show what I'm doing
now.  The code is mostly copied and modifed from Quotient.

Thanks.
-Justin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tap.py
Type: application/unknown
Size: 2584 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031014/a063c021/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: login.py
Type: application/unknown
Size: 2495 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031014/a063c021/attachment-0005.bin>

From andrew-twisted at puzzling.org  Tue Oct 14 08:01:16 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 15 Oct 2003 00:01:16 +1000
Subject: [Twisted-Python] woven and a web server in my plugin?
In-Reply-To: <20031014134911.CAB0B3EA8E@www.fastmail.fm>
References: <20031014134911.CAB0B3EA8E@www.fastmail.fm>
Message-ID: <20031014140116.GC11090@frobozz>

On Tue, Oct 14, 2003 at 07:49:11AM -0600, Justin Johnson wrote:
> I have a woven app I'm working on.  I used to use 'mktap web' to have
> twisted serve the app, but I also need to start a PB server, so I created
> a plugin.  The problem I'm having now is that I don't get the built-in
> functionality of the web server, like serving out things like a
> stylesheet in /templates/style.css, or images in /images.
> 
> Is there anyway to have my own plugin which adds the same functionality
> as the web server so I don't have to write code to handle all of that?
> 
> What is the recommended way to handle this?

I'd call twisted.tap.web.makeService (or updateApplication, if you're not
using CVS...) -- that's what 'mktap web' does, after all :)

-Andrew.




From radix at twistedmatrix.com  Tue Oct 14 07:11:15 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 14 Oct 2003 09:11:15 -0400
Subject: [Twisted-Python] woven and a web server in my plugin?
In-Reply-To: <20031014134911.CAB0B3EA8E@www.fastmail.fm>
References: <20031014134911.CAB0B3EA8E@www.fastmail.fm>
Message-ID: <20031014131115.GA1615@twistedmatrix.com>

On Tue, Oct 14, 2003 at 07:49:11AM -0600, Justin Johnson wrote:
> I have a woven app I'm working on.  I used to use 'mktap web' to have
> twisted serve the app, but I also need to start a PB server, so I created
> a plugin.  The problem I'm having now is that I don't get the built-in
> functionality of the web server, like serving out things like a
> stylesheet in /templates/style.css, or images in /images.
> 
> Is there anyway to have my own plugin which adds the same functionality
> as the web server so I don't have to write code to handle all of that?

you want twisted.web.static.File, that's what a --path webserver uses.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From lupien_v_31 at hotmail.com  Tue Oct 14 08:22:53 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Tue, 14 Oct 2003 14:22:53 +0000
Subject: [Twisted-Python] Dynamic form with twisted
Message-ID: <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>

I really need help.

I want to make a form dynamically. I don't want to use FormProcess and I do 
not understand very well how it works.  If someone have documentation on 
forms (not the one on twisted matrix), it will be appreciated.

Vicky

_________________________________________________________________
MSN Messenger : discutez en direct avec vos amis !  
http://messenger.fr.msn.ca/




From glyph at twistedmatrix.com  Tue Oct 14 09:15:44 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 14 Oct 2003 11:15:44 -0400
Subject: [Twisted-Python] Dynamic form with twisted
In-Reply-To: <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>
References: <BAY1-F76EVmkWFBXZGY0000f44c@hotmail.com>
Message-ID: <3F8C1320.8090408@twistedmatrix.com>

vicky lupien wrote:

> I want to make a form dynamically. I don't want to use FormProcess and I 
> do not understand very well how it works.  If someone have documentation 
> on forms (not the one on twisted matrix), it will be appreciated.

Twisted's layers are relatively well-factored internally.  If you don't 
like our dynamic form generation tools - and believe me, I know there 
are good reasons not to like them - you can still use the web server. 
You can easily write a form processor which uses request.args (a 
dictionary of HTTP form arguments) as input and produces HTML via 
request.write.

Your question seems a little vague, though: if you are looking for 
documentation on forms in general, consider a resource like

	http://www.ku.edu/~acs/docs/other/forms-intro.shtml

rather than this list.




From justinjohnson at fastmail.fm  Tue Oct 14 09:21:51 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 14 Oct 2003 09:21:51 -0600
Subject: [Twisted-Python] woven and a web server in my plugin?
In-Reply-To: <20031014131115.GA1615@twistedmatrix.com>
References: <20031014134911.CAB0B3EA8E@www.fastmail.fm> <20031014131115.GA1615@twistedmatrix.com>
Message-ID: <20031014152151.B4DE83D417@www.fastmail.fm>

This looks like what I need.  Thanks.

On Tue, 14 Oct 2003 09:11:15 -0400, "Christopher Armstrong"
<radix at twistedmatrix.com> said:
> On Tue, Oct 14, 2003 at 07:49:11AM -0600, Justin Johnson wrote:
> > I have a woven app I'm working on.  I used to use 'mktap web' to have
> > twisted serve the app, but I also need to start a PB server, so I created
> > a plugin.  The problem I'm having now is that I don't get the built-in
> > functionality of the web server, like serving out things like a
> > stylesheet in /templates/style.css, or images in /images.
> > 
> > Is there anyway to have my own plugin which adds the same functionality
> > as the web server so I don't have to write code to handle all of that?
> 
> you want twisted.web.static.File, that's what a --path webserver uses.
> 
> 
> -- 
>  Twisted | Christopher Armstrong: International Man of Twistery
>   Radix  |          Release Manager,  Twisted Project
> ---------+     http://twistedmatrix.com/users/radix.twistd/
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From itamar at itamarst.org  Tue Oct 14 10:16:33 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 14 Oct 2003 12:16:33 -0400
Subject: [Twisted-Python] Twisted file upload
In-Reply-To: <u8ynoq9uo.fsf@inout.no>
References: <u8ynoq9uo.fsf@inout.no>
Message-ID: <20031014121633.518f092b.itamar@itamarst.org>

On 14 Oct 2003 14:31:27 +0200
Syver Enstad <syver at inout.no> wrote:

> If there is a better way to get the filename of a posted file than the
> code below, please tell me:

Using some sort of MIME parsing code or some of the code in the cgi
module might be better. Long term solution involves total rewrite of
file upload support.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From lupien_v_31 at hotmail.com  Tue Oct 14 11:51:23 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Tue, 14 Oct 2003 17:51:23 +0000
Subject: [Twisted-Python] Dynamic form with twisted
Message-ID: <BAY1-F34HfqR77bieLY000098ad@hotmail.com>

Twisted's layers are relatively well-factored internally.  If you don't like 
our dynamic form generation tools - and believe me, I know there are good 
reasons not to like them - you can still use the web server. You can easily 
write a form processor which uses request.args (a dictionary of HTTP form 
arguments) as input and produces HTML via request.write.

Your question seems a little vague, though: if you are looking for 
documentation on forms in general, consider a resource like

	http://www.ku.edu/~acs/docs/other/forms-intro.shtml

rather than this list.

I'd love to use the generation tools  in twisted but I don't understant it 
and it's not well documented.
_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

_________________________________________________________________
MSN Search, le moteur de recherche qui pense comme vous !  
http://fr.ca.search.msn.com/




From lupien_v_31 at hotmail.com  Tue Oct 14 14:29:10 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Tue, 14 Oct 2003 20:29:10 +0000
Subject: [Twisted-Python] td() in form
Message-ID: <BAY1-F150Dd3OJXsNQp00000777@hotmail.com>

I want to add an attribute to the node td.  The name of the attribute is 
class, so it cause an error of syntax.

Here's a part of my code:

l = lmx(self)
l.td().text(name)


I' m suppose to write l.td(class='label').text(name) but I can't.  Is there 
a way to do this?

Vicky

_________________________________________________________________
MSN Search, le moteur de recherche qui pense comme vous !  
http://fr.ca.search.msn.com/




From itamar at itamarst.org  Tue Oct 14 14:44:28 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 14 Oct 2003 16:44:28 -0400
Subject: [Twisted-Python] td() in form
In-Reply-To: <BAY1-F150Dd3OJXsNQp00000777@hotmail.com>
References: <BAY1-F150Dd3OJXsNQp00000777@hotmail.com>
Message-ID: <20031014164428.39190f64.itamar@itamarst.org>

On Tue, 14 Oct 2003 20:29:10 +0000
"vicky lupien" <lupien_v_31 at hotmail.com> wrote:

> I' m suppose to write l.td(class='label').text(name) but I can't.  Is
> there a way to do this?

t = l.td()
t["class"] = "label"
t.text(name)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Tue Oct 14 15:04:53 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 14 Oct 2003 17:04:53 -0400
Subject: [Twisted-Python] td() in form
In-Reply-To: <20031014164428.39190f64.itamar@itamarst.org>
Message-ID: <0EE8D048-FE8A-11D7-8F46-000A95686CD8@redivi.com>

On Tuesday, Oct 14, 2003, at 16:44 America/New_York, Itamar 
Shtull-Trauring wrote:

> On Tue, 14 Oct 2003 20:29:10 +0000
> "vicky lupien" <lupien_v_31 at hotmail.com> wrote:
>
>> I' m suppose to write l.td(class='label').text(name) but I can't.  Is
>> there a way to do this?
>
> t = l.td()
> t["class"] = "label"
> t.text(name)

There's no underscore hack for Python's reserved words in lmx?

-bob




From stephen at thorne.id.au  Tue Oct 14 16:00:24 2003
From: stephen at thorne.id.au (Stephen Thorne)
Date: Wed, 15 Oct 2003 08:00:24 +1000
Subject: [Twisted-Python] td() in form
In-Reply-To: <0EE8D048-FE8A-11D7-8F46-000A95686CD8@redivi.com>
References: <0EE8D048-FE8A-11D7-8F46-000A95686CD8@redivi.com>
Message-ID: <3F8C71F8.8010608@thorne.id.au>

Bob Ippolito wrote:

> On Tuesday, Oct 14, 2003, at 16:44 America/New_York, Itamar 
> Shtull-Trauring wrote:
>
>> On Tue, 14 Oct 2003 20:29:10 +0000
>> "vicky lupien" <lupien_v_31 at hotmail.com> wrote:
>>
>>> I' m suppose to write l.td(class='label').text(name) but I can't.  Is
>>> there a way to do this?
>>
>>
>> t = l.td()
>> t["class"] = "label"
>> t.text(name)
>
>
> There's no underscore hack for Python's reserved words in lmx?
>
> -bob

There is the underscore hack too
l = lmx()
l.td(_class='label').text(name)
will work as well.

You can prefix an _ to any kwarg, so you can also have td(_import=''), 
td(_if='blah'), etc.

Regards,
Stephen Thorne




From itamar at itamarst.org  Tue Oct 14 21:24:07 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 14 Oct 2003 23:24:07 -0400
Subject: [Twisted-Python] Status of 1.1 release
In-Reply-To: <20031013010234.054e4358.itamar@itamarst.org>
References: <20031013010234.054e4358.itamar@itamarst.org>
Message-ID: <20031014232407.2267bc74.itamar@itamarst.org>

On Mon, 13 Oct 2003 01:02:34 -0400
Itamar Shtull-Trauring <itamar at itamarst.org> wrote:

> 2. Cred docs are mostly done, I will finish them.

Done.

> 1. Services use in static registry (deleting code mainly)

Done.

> 1. Mac OS X reactor (hello bob!)

Done.

As for the issues you raised, Andrew - add them to the tracker please.
Patches are even better ;)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From foom at fuhm.net  Tue Oct 14 23:21:30 2003
From: foom at fuhm.net (James Y Knight)
Date: Wed, 15 Oct 2003 01:21:30 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven models
Message-ID: <6ED10A50-FECF-11D7-B477-000A95A50FB2@fuhm.net>

I took dtuple.py (a wrapper that makes database results look like both 
a tuple and a dictionary simultaneously, which I found on the web) and 
wrapped it as a woven model, so you can use your database results and 
get submodels with both integer keys and column-name keys. It seems 
like it's probably useful to a bunch of people, so I'm making it 
available.

Currently living at:
http://www.ai.mit.edu/people/jknight/dtuple.py

Usage:
dbtupleize(curs, *args, **kw):
   Use this function as the argument to adbapi.runInteraction.

   E.g.:
   return dbpool.runInteraction(dbtupleize, "select * from table")

   It returns a DatabaseList of DatabaseTuples.

   A DatabaseList is just like a normal list execpt it has a getKeys()
   method.

   A DatabaseTuple is both a tuple and dictionary. If used as a tuple,
   it is ordered in the same order as the enclosing DatabaseList's
   getKeys() method.


   One use case is with a template like so:
       <table model="users" view="List">
	<tr pattern="listHeader" view="List" model="keys">
	  <th pattern="listItem" view="Text" model="."></th>
	</tr>
	<tr pattern="listItem" view="List" model=".">
	  <td pattern="listItem" view="Text" model="."></td>
	</tr>
     </table>

    and a model like:
       wmfactory_users(self, request):
         return dbpool.runInteraction(dbtupleize, "select * from users")

   Another is a template like:
        Userid: <span model="curuser/userid" view="Text" /><br>
        Email: <span model="curuser/email" view="Text" /><br>

    with a model like:
      wmfactory_curuser(self, request):
        return dbpool.runInteraction(dbtupleize, "select * from users 
where userid=%(self.curuserid)s", {'curuserid':self.curuserid})


As you can see from the comments in the file, it is doing a bit of 
excessive wrapping (wrapping a model around a dbtuple around the actual 
results), but since IMO woven models need a rewrite anyways, I'm not 
too concerned about integrating them more tightly into things at the 
moment, now that this works the way it is.

James




From golux at comcast.net  Tue Oct 14 23:50:49 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Wed, 15 Oct 2003 01:50:49 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven
 models
In-Reply-To: <6ED10A50-FECF-11D7-B477-000A95A50FB2@fuhm.net>
References: <6ED10A50-FECF-11D7-B477-000A95A50FB2@fuhm.net>
Message-ID: <3F8CE039.9090709@comcast.net>

James Y Knight wrote:
> I took dtuple.py (a wrapper that makes database results look like both a 
> tuple and a dictionary simultaneously, which I found on the web)  ...

PgResultSet already does that.
E.g.:

 >>> from pyPgSQL import PgSQL
 >>> conn = PgSQL.connect(database='pgerdb')
 >>> curs = conn.cursor()
 >>> curs.execute('select * from id_context')
 >>> res = curs.fetchall()
 >>> len(res)
6
 >>> res[0]
[None, 'IdContext', None, 'PGER', 0, 'PGER', '', '', 'admin', 'PGER', 'admin', 'PGER', <DateTime 
object for '2003-10-02 13:36:55.29' at 40429fa8>, 'admin', 'PGER', <DateTime object for '2003-10-02 
13:36:55.29' at 40443090>, 'admin', 'PGER', 'admin', 'PGER', <DateTime object for '2003-10-02 
13:36:55.29' at 404430c8>, 'admin', 'PGER', <DateTime object for '2003-10-02 13:36:55.29' at 
40443100>, None]
 >>> for k in res[0].keys():
...     print '%s : %s' % (k, res[0][k])
...
pgef_oid : None
pgef_class : IdContext
id : None
id_context : PGER
pgef_security_mask : 0
name : PGER
short_description :
long_description :
pger_owner : admin
pger_owner_context : PGER
pger_creator : admin
pger_creator_context : PGER
pger_create_datetime : 2003-10-02 13:36:55.29
pger_modifier : admin
pger_modifier_context : PGER
pger_mod_datetime : 2003-10-02 13:36:55.29
owner : admin
owner_context : PGER
creator : admin
creator_context : PGER
create_datetime : 2003-10-02 13:36:55.29
modifier : admin
modifier_context : PGER
mod_datetime : 2003-10-02 13:36:55.29
ext_name : None
 >>>




From anthony at interlink.com.au  Wed Oct 15 00:16:36 2003
From: anthony at interlink.com.au (Anthony Baxter)
Date: Wed, 15 Oct 2003 16:16:36 +1000
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven models 
In-Reply-To: <3F8CE039.9090709@comcast.net> 
Message-ID: <200310150616.h9F6Ga5b001387@localhost.localdomain>


You might also want to look at Kevin Jacob's db_row class - it has a C and
Python implementation.

http://opensource.theopalgroup.com/

-- 
Anthony Baxter     <anthony at interlink.com.au>   
It's never too late to have a happy childhood.




From syver at inout.no  Wed Oct 15 02:25:19 2003
From: syver at inout.no (Syver Enstad)
Date: 15 Oct 2003 10:25:19 +0200
Subject: [Twisted-Python] Twisted file upload
In-Reply-To: <20031014121633.518f092b.itamar@itamarst.org>
References: <u8ynoq9uo.fsf@inout.no>
	<20031014121633.518f092b.itamar@itamarst.org>
Message-ID: <un0c2vrf4.fsf@inout.no>

Itamar Shtull-Trauring <itamar at itamarst.org> writes:

> On 14 Oct 2003 14:31:27 +0200
> Syver Enstad <syver at inout.no> wrote:
> 
> > If there is a better way to get the filename of a posted file than the
> > code below, please tell me:
> 
> Using some sort of MIME parsing code or some of the code in the cgi
> module might be better. Long term solution involves total rewrite of
> file upload support.

Fine, I just wanted to know if I had missed something obvious in
twisted's support for file upload.






From 2002 at weholt.org  Wed Oct 15 03:46:00 2003
From: 2002 at weholt.org (Thomas Weholt)
Date: Wed, 15 Oct 2003 11:46:00 +0200
Subject: [Twisted-Python] Twisted file upload
References: <u8ynoq9uo.fsf@inout.no><20031014121633.518f092b.itamar@itamarst.org> <un0c2vrf4.fsf@inout.no>
Message-ID: <01c601c39301$254f4bf0$0401a8c0@razor>

If anybody can elaborate on this, provide a simple, twisted-friendly way of
parsing uploaded files, preferrably in a form with other fields as well,
that would be great.

Been messing around with something similar to this myself, and I have to
upload mainly binary files, which in my case returned just crappy, mangled
data.

Best regards and thanks in advance,
Thomas

----- Original Message -----
From: "Syver Enstad" <syver at inout.no>
To: <twisted-python at twistedmatrix.com>
Sent: Wednesday, October 15, 2003 10:25 AM
Subject: Re: [Twisted-Python] Twisted file upload


> Itamar Shtull-Trauring <itamar at itamarst.org> writes:
>
> > On 14 Oct 2003 14:31:27 +0200
> > Syver Enstad <syver at inout.no> wrote:
> >
> > > If there is a better way to get the filename of a posted file than the
> > > code below, please tell me:
> >
> > Using some sort of MIME parsing code or some of the code in the cgi
> > module might be better. Long term solution involves total rewrite of
> > file upload support.
>
> Fine, I just wanted to know if I had missed something obvious in
> twisted's support for file upload.
>
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>




From lupien_v_31 at hotmail.com  Wed Oct 15 07:17:07 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Wed, 15 Oct 2003 13:17:07 +0000
Subject: [Twisted-Python] td() in form
Message-ID: <BAY1-F39s7nlT2NqFJ3000035ed@hotmail.com>

Bob Ippolito wrote:

>On Tuesday, Oct 14, 2003, at 16:44 America/New_York, Itamar Shtull-Trauring 
>wrote:
>
>>On Tue, 14 Oct 2003 20:29:10 +0000
>>"vicky lupien" <lupien_v_31 at hotmail.com> wrote:
>>
>>>I' m suppose to write l.td(class='label').text(name) but I can't.  Is
>>>there a way to do this?
>>
>>
>>t = l.td()
>>t["class"] = "label"
>>t.text(name)
>
>
>There's no underscore hack for Python's reserved words in lmx?
>
>-bob

There is the underscore hack too
l = lmx()
l.td(_class='label').text(name)
will work as well.

You can prefix an _ to any kwarg, so you can also have td(_import=''), 
td(_if='blah'), etc.

Regards,
Stephen Thorne

Thx everyone, it's all right now

_________________________________________________________________
MSN Search, le moteur de recherche qui pense comme vous !  
http://fr.ca.search.msn.com/




From lupien_v_31 at hotmail.com  Wed Oct 15 07:19:28 2003
From: lupien_v_31 at hotmail.com (vicky lupien)
Date: Wed, 15 Oct 2003 13:19:28 +0000
Subject: [Twisted-Python] form and submit
Message-ID: <BAY1-F40OWGMhLPBLYd00012b78@hotmail.com>

I have a form with a submit button.  I want to send my data from the form in 
a web page to an other web page.  Also, I want to check if the data is 
correct.

I'm new to twisted, so I need some help

Vicky

_________________________________________________________________
MSN Messenger : discutez en direct avec vos amis !  
http://messenger.fr.msn.ca/




From foom at fuhm.net  Wed Oct 15 09:36:03 2003
From: foom at fuhm.net (James Y Knight)
Date: Wed, 15 Oct 2003 11:36:03 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven models
In-Reply-To: <3F8CE039.9090709@comcast.net>
Message-ID: <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>

On Wednesday, October 15, 2003, at 01:50 AM, Stephen C. Waterbury wrote:

> James Y Knight wrote:
>> I took dtuple.py (a wrapper that makes database results look like 
>> both a tuple and a dictionary simultaneously, which I found on the 
>> web)  ...
>
> PgResultSet already does that.
> E.g.:
>
> >>> from pyPgSQL import PgSQL
> >>> conn = PgSQL.connect(database='pgerdb')

Well I guess I chose the wrong postgres python implementation then, 
since I know Psycopg doesn't do that. Good thing the python DB 
interface is standardized! ;) But okay -- if you're using PgSQL, you 
can then just use the woven model wrapper part pretty easily without 
the DatabaseTuple, TupleDescriptor classes.

James




From golux at comcast.net  Wed Oct 15 10:33:47 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Wed, 15 Oct 2003 12:33:47 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven
 models
In-Reply-To: <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>
References: <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>
Message-ID: <3F8D76EB.3040307@comcast.net>

James Y Knight wrote:

> Well I guess I chose the wrong postgres python implementation then, 
> since I know Psycopg doesn't do that. Good thing the python DB interface 
> is standardized! ;) ...

heh ... the great thing about standards is that
there are so many to choose from.  ;)

Steve.




From nico at tekNico.net  Wed Oct 15 10:58:31 2003
From: nico at tekNico.net (Nicola Larosa)
Date: Wed, 15 Oct 2003 18:58:31 +0200
Subject: [Twisted-Python] Re: DB dictionary/tuple result wrapper for woven models
In-Reply-To: <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>
References: <3F8CE039.9090709@comcast.net> <4925CFB0-FF25-11D7-B477-000A95A50FB2@fuhm.net>
Message-ID: <3F8D7CB7.8020300@tekNico.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Well I guess I chose the wrong postgres python implementation then,
> since I know Psycopg doesn't do that. Good thing the python DB interface
> is standardized! ;)

You can do the same with MySQL-python, using a DictCursor instead of a
vanilla Cursor.


- --
"Whether you believe you can or believe you can't,
either way you're right." -- Henry Ford

Nicola Larosa - nico at tekNico.net


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (GNU/Linux)

iD8DBQE/jXy2Xv0hgDImBm4RAr3aAJ4949HdDPGE4RkeduvsJNT918kx4QCgtg6Q
tJPeAdE0SO+cockjNnCNeW8=
=5osK
-----END PGP SIGNATURE-----




From nico at tekNico.net  Wed Oct 15 11:00:44 2003
From: nico at tekNico.net (Nicola Larosa)
Date: Wed, 15 Oct 2003 19:00:44 +0200
Subject: [Twisted-Python] Re: Status of 1.1 release
In-Reply-To: <20031014021438.GB7341@frobozz>
References: <20031013010234.054e4358.itamar@itamarst.org> <20031014021438.GB7341@frobozz>
Message-ID: <3F8D7D3C.10902@tekNico.net>

>> Remaining issues:
>> 1. Services use in static registry (deleting code mainly)
>> 2. Update manhole (and manhole and telnet howtos)
>> 3. What to do with words
>> 4. Document guard

> 5. Intermittent buildbot failures for full-2.3 and freebsd buildslaves,
>    e.g.:
>        http://twistedmatrix.com/buildbot/full-2.3/events/486/summary
>        http://twistedmatrix.com/buildbot/freebsd/events/422/summary

What about

6. Documenting Woven Form

? :^)


-- 
"Whether you believe you can or believe you can't,
either way you're right." -- Henry Ford

Nicola Larosa - nico at tekNico.net





From vlupien at drummonddesigns.com  Wed Oct 15 11:38:38 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Wed, 15 Oct 2003 13:38:38 -0400
Subject: [Twisted-Python] form and submit
Message-ID: <000101c39343$2abeb8e0$687ba8c0@martin>

I really need help.  I have a form in a web page and I want to transfert
the data to an another web page.  I'd like to be able to validate the
input before sending my data to the other page.
 
I'm using web.woven.form.  I build my form dynamically (lmx) not with
formprocess.  
 
Thx for your help
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031015/82765455/attachment.html>

From dp at twistedmatrix.com  Wed Oct 15 11:40:49 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 15 Oct 2003 13:40:49 -0400
Subject: [Twisted-Python] Re: Status of 1.1 release
In-Reply-To: <3F8D7D3C.10902@tekNico.net>
References: <20031013010234.054e4358.itamar@itamarst.org> <20031014021438.GB7341@frobozz> <3F8D7D3C.10902@tekNico.net>
Message-ID: <B732660A-FF36-11D7-8C38-000A95864FC4@twistedmatrix.com>

On Oct 15, 2003, at 1:00 PM, Nicola Larosa wrote:

>>> Remaining issues:
>>> 1. Services use in static registry (deleting code mainly)
>>> 2. Update manhole (and manhole and telnet howtos)
>>> 3. What to do with words
>>> 4. Document guard
>
>> 5. Intermittent buildbot failures for full-2.3 and freebsd 
>> buildslaves,
>>    e.g.:
>>        http://twistedmatrix.com/buildbot/full-2.3/events/486/summary
>>        http://twistedmatrix.com/buildbot/freebsd/events/422/summary
>
> What about
>
> 6. Documenting Woven Form
>
> ? :^)

Documenting it would mean semi-freezing the interface, and since the 
interface is just slush and has already changed (in quotient.formless 
and quotient.web.webform), I don't think it's a great idea. One thing 
people need to understand about woven is that it is still in heavy 
development -- although development has slowed lately because it has 
become stable enough to use, there are still large refactorings I plan 
on undertaking which will vastly simplify the way woven works. While I 
will attempt to preserve backwards compatibility because I have a large 
codebase that needs it, I reserve the right to change interfaces 
because they are completely broken -- I think it'll be better in the 
long run to have well-designed interfaces than to have backwards 
compatibility with broken ones.

The best way to learn about woven is to try to use it, and to ask 
questions on #twisted.

dp




From foom at fuhm.net  Wed Oct 15 12:41:58 2003
From: foom at fuhm.net (James Y Knight)
Date: Wed, 15 Oct 2003 14:41:58 -0400
Subject: [Twisted-Python] DB dictionary/tuple result wrapper for woven models
In-Reply-To: <3F8D76EB.3040307@comcast.net>
Message-ID: <42065F2F-FF3F-11D7-B477-000A95A50FB2@fuhm.net>

On Wednesday, October 15, 2003, at 12:33 PM, Stephen C. Waterbury wrote:

> James Y Knight wrote:
>
>> Well I guess I chose the wrong postgres python implementation then, 
>> since I know Psycopg doesn't do that. Good thing the python DB 
>> interface is standardized! ;) ...
>
> heh ... the great thing about standards is that
> there are so many to choose from.  ;)

Unfortunately there's only one very-poorly-specified standard here. And 
that's not so great.

James




From vlupien at drummonddesigns.com  Wed Oct 15 13:14:53 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Wed, 15 Oct 2003 15:14:53 -0400
Subject: [Twisted-Python] formprocess + display
Message-ID: <000801c39350$9d0c1f70$687ba8c0@martin>

I've made a form with FormProcess and methodSignature.  I want to know
if I can add some attributes to td for my html page or anything like
that.   
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031015/70987c05/attachment.html>

From mesozoic at polynode.com  Wed Oct 15 15:45:29 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Wed, 15 Oct 2003 17:45:29 -0400
Subject: [Twisted-Python] Problem with MovableType, XMLRPC, and CGI
Message-ID: <1066254329.953.119.camel@hyla>

I was trying to access the MovableType XML-RPC server (which uses Perl's
SOAP::Lite module), and kept getting Interal Server Errors. The problem,
as it turned out, was that the headers were separated from the response
by '\n\r\n', which wasn't recognized.

Is this a bug in Twisted, or in SOAP::Lite? I'm reluctant to add it to
the bug tracker without knowing whether this is actually a problem for
the Twisted team.

Below is the dirty nasty quick-fix I used:

--- twcgi.py.orig	Wed Oct 15 17:37:09 2003
+++ twcgi.py	Wed Oct 15 17:44:25 2003
@@ -208,7 +208,7 @@
         if self.handling_headers:
             text = self.headertext + output
             headerEnds = []
-            for delimiter in '\n\n','\r\n\r\n','\r\r':
+            for delimiter in '\n\n','\r\n\r\n','\r\r', '\n\r\n':
                 headerend = string.find(text,delimiter)
                 if headerend != -1:
                     headerEnds.append((headerend, delimiter))


-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031015/d785c683/attachment.sig>

From stuart.hungerford at anu.edu.au  Wed Oct 15 22:52:36 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Thu, 16 Oct 2003 14:52:36 +1000
Subject: [Twisted-Python] Best way to modify <meta> tags in Woven...
Message-ID: <6.0.0.22.0.20031016144923.01ecac20@anusf.anu.edu.au>

Hi all,

I have a Woven-based web application that needs to modify the
<meta> tags of the generated HTML from the application (i.e.
the attribute values of the meta tags).

What's the best way to approach this in Woven?   I'd guess
I could find the <head> element in Woven then use the lmx DOM
functions to insert a new <meta> element?

Any advice much appreciated.


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From mary-twisted at puzzling.org  Thu Oct 16 02:03:50 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Thu, 16 Oct 2003 18:03:50 +1000
Subject: [Twisted-Python] Best way to modify <meta> tags in Woven...
In-Reply-To: <6.0.0.22.0.20031016144923.01ecac20@anusf.anu.edu.au>
References: <6.0.0.22.0.20031016144923.01ecac20@anusf.anu.edu.au>
Message-ID: <20031016080350.GD11624@titus>

On Thu, Oct 16, 2003, Stuart Hungerford wrote:
> Hi all,
> 
> I have a Woven-based web application that needs to modify the
> <meta> tags of the generated HTML from the application (i.e.
> the attribute values of the meta tags).
> 
> What's the best way to approach this in Woven?   I'd guess
> I could find the <head> element in Woven then use the lmx DOM
> functions to insert a new <meta> element?
> 
> Any advice much appreciated.

Apologies if I'm misunderstanding the architecture, but can you simply
have a template that looks like this?

''''
<html>

<head>

<meta model="MetaModel" view="AttributeAdder/>

</head>
'''

etc etc...

And then the relevant Page subclass has a wmfactory_MetaModel method and
a wvfactory_AttributeAdder method which returns some kind of Widget.  In
the setUp method of the Widget, you can manipulate the node. This saves
you from having to search down from the head -- you *know* that the node
argument to the Widget's setUp method is the "meta" node.

Of course this requires that you know how to generate the meta tag's
attribute at the time of the generation of the HTML, and you said you
wanted to "modify the <meta> tags of the generated HTML" -- does this
mean you don't know what the <meta> tags will look like until *after*
the page has been generated?

-Mary



From mesozoic at polynode.com  Thu Oct 16 02:29:42 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Thu, 16 Oct 2003 04:29:42 -0400
Subject: [Twisted-Python] PB, t.web tracebacks with Debian 1.1.0alpha
Message-ID: <1066292982.5731.69.camel@hyla>

Moshez pointed out that the problem I'm having, originally listed here
<http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue345>, is
not a bug, but a feature. I'm posting my code; could someone explain
what I'm doing wrong?

In an .rpy, I have:

--- snip ---
resource = MyResource()
resource.putChild(ResourceSubscription('unix', '/home/mesozoic/.mt'))
cache()
--- snip ---

In a separate server, I have:

--- snip ---
file = static.File('./site')
site = server.Site(file)
application = app.Application('movabletype')
application.listenUNIX(
    '/home/mesozoic/.mt',
    pb.BrokerFactory(distrib.ResourcePublisher(site)))
--- snip ---

Advice is warmly welcomed.

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031016/43e870ad/attachment.sig>

From syver at inout.no  Thu Oct 16 03:37:13 2003
From: syver at inout.no (Syver Enstad)
Date: 16 Oct 2003 11:37:13 +0200
Subject: [Twisted-Python] Twisted file upload
In-Reply-To: <01c601c39301$254f4bf0$0401a8c0@razor>
References: <u8ynoq9uo.fsf@inout.no>
	<20031014121633.518f092b.itamar@itamarst.org> <un0c2vrf4.fsf@inout.no>
	<01c601c39301$254f4bf0$0401a8c0@razor>
Message-ID: <un0c1ttfa.fsf@inout.no>

"Thomas Weholt" <2002 at weholt.org> writes:

> If anybody can elaborate on this, provide a simple, twisted-friendly way of
> parsing uploaded files, preferrably in a form with other fields as well,
> that would be great.
> 
> Been messing around with something similar to this myself, and I have to
> upload mainly binary files, which in my case returned just crappy, mangled
> data.

The support works out of the box for me as long as I use the correct
enctype on the form. I just use request.args to get the data, it's the
filename that I have a problem with.

    <form enctype="multipart/form-data" action="./" method="POST">
    <input name="myFile" type="file" />
    <input type="submit" value="Upload file" />
    </form>

When I get the POST I just use:

outputStream = open(filename, 'wb')
outputStream.write(request.args['myFile'])
outputStream.close()

I find filename by doing the stuff outlined in the beginning of this thread.



 




From justinjohnson at fastmail.fm  Thu Oct 16 06:35:27 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 16 Oct 2003 06:35:27 -0600
Subject: [Twisted-Python] CVSToys and IRC
Message-ID: <20031016123527.984D93ED72@www.fastmail.fm>

Would someone mind helping me get CVSToys setup to send to an IRC
channel?  I'm not quite sure what to do based on what the doc says.

----------
Many of you are downloading this package to have commit notifications
delivered to you on IRC.  To do this, make sure you have a PBService
in your freshCfg, and then make seperate cvswords application; do
`mktap cvswords --help` for a list of all options.  The --cvs-user and
--cvs-pass options must match the user/pass pair for the PBService.
Start the new application with `twistd -f cvswords.tap`.
-----------

From
http://twistedmatrix.com/users/acapnotic/wares/code/CVSToys/config.txt...

----

PBService
PB service to provide notification to remote agents.

Usage: PBService(serviceName='cvstoys.notify', userpass=None)
Initialize a service.

The global variables pbPortNo and pbAuthorizer are also relevant.

@param serviceName: The name of the PB service.  If you make
more than one service, each must have a unique name.

@param userpass: If a (username, password) tuple is supplied
here, an account will be created for it.

----

So it seems I need to create a words tap and a cvswords tap, and add a
PBService to the freshCfg file?  I'm not quite sure where I specify the
IRC channel in all this.  mktap words --help doesn't seem to have any
channel option.

Thanks.
-Justin



From vlupien at drummonddesigns.com  Thu Oct 16 07:16:03 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 16 Oct 2003 09:16:03 -0400
Subject: [Twisted-Python] templateAttributes for form
In-Reply-To: <000801c39350$9d0c1f70$687ba8c0@martin>
Message-ID: <000001c393e7$a6f1d1a0$687ba8c0@martin>

What is the utility of templateAttributes in the every input_ fonction
(input_text, ...) that is in form.py in the class FormFillerWidget.  I
want to add some attributes to the node but I don't know how.
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031016/ee3b5a07/attachment.html>

From itamar at itamarst.org  Thu Oct 16 08:50:37 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 16 Oct 2003 10:50:37 -0400
Subject: [Twisted-Python] PB, t.web tracebacks with Debian 1.1.0alpha
In-Reply-To: <1066292982.5731.69.camel@hyla>
References: <1066292982.5731.69.camel@hyla>
Message-ID: <20031016105037.6335e45d.itamar@itamarst.org>

On Thu, 16 Oct 2003 04:29:42 -0400
Alex Levy <mesozoic at polynode.com> wrote:

> http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue345

Code in RPYs is run each time the page is viewed. Thus, your resource
publisher is registering two producers on a transport, which is not
valid behaviour - it's supposed to unregister first.

Solutions:
1. have the line "cache()" on first line of RPY - this will prevent it
from reexecuting on each hit.
2. don't use RPYs.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 16 08:53:19 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 16 Oct 2003 10:53:19 -0400
Subject: [Twisted-Python] Problem with MovableType, XMLRPC, and CGI
In-Reply-To: <1066254329.953.119.camel@hyla>
References: <1066254329.953.119.camel@hyla>
Message-ID: <20031016105319.61552b02.itamar@itamarst.org>

On Wed, 15 Oct 2003 17:45:29 -0400
Alex Levy <mesozoic at polynode.com> wrote:

> I was trying to access the MovableType XML-RPC server (which uses
> Perl's SOAP::Lite module), and kept getting Interal Server Errors. The
> problem, as it turned out, was that the headers were separated from
> the response by '\n\r\n', which wasn't recognized.

Hmmm. Unless \n is a valid character in a HTTP header, sounds like a bug
in SOAP::Lite. Hit the RFC and see what it says.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 16 10:41:18 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 16 Oct 2003 12:41:18 -0400
Subject: [Twisted-Python] PB, t.web tracebacks with Debian 1.1.0alpha
In-Reply-To: <20031016105037.6335e45d.itamar@itamarst.org>
References: <1066292982.5731.69.camel@hyla>
	<20031016105037.6335e45d.itamar@itamarst.org>
Message-ID: <20031016124118.30e3f2ee.itamar@itamarst.org>

On Thu, 16 Oct 2003 10:50:37 -0400
Itamar Shtull-Trauring <itamar at itamarst.org> wrote:

> Solutions:
> 1. have the line "cache()" on first line of RPY - this will prevent it
> from reexecuting on each hit.
> 2. don't use RPYs.

Actually I may be totally wrong about this.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Thu Oct 16 11:29:03 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 16 Oct 2003 13:29:03 -0400
Subject: [Twisted-Python] CVSToys and IRC
In-Reply-To: <20031016123527.984D93ED72@www.fastmail.fm>
References: <20031016123527.984D93ED72@www.fastmail.fm>
Message-ID: <20031016172903.GA9694@intarweb.us>

On Thu, Oct 16, 2003 at 06:35:27AM -0600, Justin Johnson wrote:
> Would someone mind helping me get CVSToys setup to send to an IRC
> channel?  I'm not quite sure what to do based on what the doc says.
> 

From my freshCfg:

pbPortNumber = 9292
pb = ConfigurationSet([
    ('/cvs', '^frontier', None,
        PBService(userpass=("<username>", "<password>"))),
    ])

/cvs is my $CVSROOT; frontier is the name of the module I want to see
information about; <username> and <password> are obvious.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031016/aafe1c37/attachment.sig>

From twisted at zadka.site.co.il  Thu Oct 16 11:36:35 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 16 Oct 2003 17:36:35 -0000
Subject: [Twisted-Python] PB, t.web tracebacks with Debian 1.1.0alpha
In-Reply-To: <1066292982.5731.69.camel@hyla>
References: <1066292982.5731.69.camel@hyla>
Message-ID: <20031016173635.7662.qmail@green.zadka.com>

On Thu, 16 Oct 2003, Alex Levy <mesozoic at polynode.com> wrote:

> Moshez pointed out that the problem I'm having, originally listed here
> <http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue345>, is
> not a bug, but a feature. I'm posting my code; could someone explain
> what I'm doing wrong?

Well, apparently there was a bug in the CGI code. I'm guessing m-t works
with CGI?

In any case, you should move the server to new application:

from twisted.application import service, strports
> file = static.File('./site')
> site = server.Site(file)
> application = app.Application('movabletype')
application = service.Application('movabletype')
s = strports.service('unix:/home/mesozoic/.mt',
                     pb.PBServerFactory(distrib.ResourcePublisher(site)))
s.setServiceParent(application)



From justinjohnson at fastmail.fm  Thu Oct 16 12:00:52 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Thu, 16 Oct 2003 12:00:52 -0600
Subject: [Twisted-Python] CVSToys and IRC
In-Reply-To: <20031016172903.GA9694@intarweb.us>
References: <20031016123527.984D93ED72@www.fastmail.fm> <20031016172903.GA9694@intarweb.us>
Message-ID: <20031016180052.CCCB63D3BC@www.fastmail.fm>

Do I need to have another service running though?  Where do I tell it the
IRC channel to send to?

Thanks.
-Justin

On Thu, 16 Oct 2003 13:29:03 -0400, "Jp Calderone" <exarkun at intarweb.us>
said:
> On Thu, Oct 16, 2003 at 06:35:27AM -0600, Justin Johnson wrote:
> > Would someone mind helping me get CVSToys setup to send to an IRC
> > channel?  I'm not quite sure what to do based on what the doc says.
> > 
> 
> From my freshCfg:
> 
> pbPortNumber = 9292
> pb = ConfigurationSet([
>     ('/cvs', '^frontier', None,
>         PBService(userpass=("<username>", "<password>"))),
>     ])
> 
> /cvs is my $CVSROOT; frontier is the name of the module I want to see
> information about; <username> and <password> are obvious.
> 
>   Jp



From glyph at twistedmatrix.com  Thu Oct 16 23:14:57 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 17 Oct 2003 01:14:57 -0400
Subject: [Twisted-Python] Re: Status of 1.1 release
In-Reply-To: <B732660A-FF36-11D7-8C38-000A95864FC4@twistedmatrix.com>
References: <20031013010234.054e4358.itamar@itamarst.org> <20031014021438.GB7341@frobozz> <3F8D7D3C.10902@tekNico.net> <B732660A-FF36-11D7-8C38-000A95864FC4@twistedmatrix.com>
Message-ID: <3F8F7AD1.8020202@twistedmatrix.com>

Donovan Preston wrote:

> Documenting [form] would mean semi-freezing the interface, and since the 
> interface is just slush and has already changed (in quotient.formless 
> and quotient.web.webform), I don't think it's a great idea. One thing 
> people need to understand about woven is that it is still in heavy 
> development -- although development has slowed lately because it has 
> become stable enough to use, there are still large refactorings I plan 
> on undertaking which will vastly simplify the way woven works. While I 
> will attempt to preserve backwards compatibility because I have a large 
> codebase that needs it, I reserve the right to change interfaces because 
> they are completely broken -- I think it'll be better in the long run to 
> have well-designed interfaces than to have backwards compatibility with 
> broken ones.
> 
> The best way to learn about woven is to try to use it, and to ask 
> questions on #twisted.

I have added some notes to other aspects of the Twisted documentation to 
try to bridge this communication gap.  Any document where the thing 
being documented is under heavy development should clearly and loudly 
say that.

I mention this because I agree with Donovan's point here, but sometimes 
writing documentation for code can be as enlightening a process as 
writing test-cases for it; possibly revealing ways to produce 
backwards-compatible refactorings without endangering correctness.  I 
don't want to discourage anyone from doing that.  If you do it, though, 
understand that you may have to maintain the document forward to a new 
interface when it changes.





From ted at powersdk.com  Fri Oct 17 14:37:23 2003
From: ted at powersdk.com (Ted Patrick)
Date: Fri, 17 Oct 2003 16:37:23 -0400
Subject: [Twisted-Python] Chat server
Message-ID: <000401c394ee$7a94b840$6401a8c0@ISLAND>

Using twisted as a socket server, how would you pass a message to all
attached clients. Like the echo example but broadcast the message to all
attached clients.

Thanks,

Ted




From rdrb at 123.cl  Fri Oct 17 16:28:23 2003
From: rdrb at 123.cl (RITA Y/O RODRIGO DIAZ Y/O BENENSON)
Date: Fri, 17 Oct 2003 22:28:23 +0000 (GMT)
Subject: [Twisted-Python] Khashmir log crash
Message-ID: <2d81682d8156.2d81562d8168@noborrar.co.cl>

Hi!

I'm working in a research project
about new usages for the computers
networks. Actually I would like to
start some prototype services over
Distributed Hash Tables. The python
implementation of kademlia named
"khasmir" (presented at the
twistedmatrix homepage) seems to be
the perfect choice for the fast
devellopment of the first prototypes.

Unfortanutelly running the demo I got:


[rodrigob at localhost khashmir]$ python
khashmir.py 5
Building 5 peer table.
Traceback (most recent call last):
  File
"/usr/local/lib/python2.3/site-packages/twisted/internet/app.py",
line 862, in run
    log.callWithLogger(self,
reactor.run,
installSignalHandlers=installSignalHandlers)
--- <exception caught here> ---
  File
"/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
line 65, in callWithLogger
    callWithContext({"system": lp},
func, *args, **kw)
  File
"/usr/local/lib/python2.3/site-packages/twisted/python/log.py",
line 52, in callWithContext
    return context.call({ILogContext:
newCtx}, func, *args, **kw)
  File
"/usr/local/lib/python2.3/site-packages/twisted/python/context.py",
line 53, in callWithContext
    return
self.currentContext().callWithContext(ctx,
func, *args, **kw)
  File
"/usr/local/lib/python2.3/site-packages/twisted/python/context.py",
line 32, in callWithContext
    return func(*args,**kw)
  File
"/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
line 121, in run
   
self.startRunning(installSignalHandlers=installSignalHandlers)
  File
"/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
line 115, in startRunning
    self._handleSignals()
  File
"/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
line 87, in _handleSignals
    signal.signal(signal.SIGINT,
self.sigInt)
exceptions.ValueError: signal only
works in main thread

Python 2.3.2, Twisted 1.0.7, RH8.


Does anyone know how to fix this ? I
this due to changes in Twisted ?
Have someone already used khashmir ?



Thanks.
RodrigoB.




From bob at redivi.com  Fri Oct 17 16:41:04 2003
From: bob at redivi.com (Bob Ippolito)
Date: Fri, 17 Oct 2003 18:41:04 -0400
Subject: [Twisted-Python] Chat server
In-Reply-To: <000401c394ee$7a94b840$6401a8c0@ISLAND>
Message-ID: <FDD94AC2-00F2-11D8-9C26-000A95686CD8@redivi.com>

On Friday, Oct 17, 2003, at 16:37 America/New_York, Ted Patrick wrote:

> Using twisted as a socket server, how would you pass a message to all
> attached clients. Like the echo example but broadcast the message to 
> all
> attached clients.

You need to have a dictionary connected clients somewhere, the best 
place would probably be the factory instance.  When a client connects, 
add them to the dictionary, when they disconnect remove them from the 
dictionary.  Then just add a method to your class that sends a message 
to every client that the factory knows about.

-bob




From itamar at itamarst.org  Fri Oct 17 20:36:53 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 17 Oct 2003 22:36:53 -0400
Subject: [Twisted-Python] Khashmir log crash
In-Reply-To: <2d81682d8156.2d81562d8168@noborrar.co.cl>
References: <2d81682d8156.2d81562d8168@noborrar.co.cl>
Message-ID: <20031017223653.441b31e9.itamar@itamarst.org>

On Fri, 17 Oct 2003 22:28:23 +0000 (GMT)
RITA Y/O RODRIGO DIAZ Y/O BENENSON <rdrb at 123.cl> wrote:

> Unfortanutelly running the demo I got:

You need to change the code so it does
"reactor.run(installSignalHandlers=0)" instead of "reactor.run()".

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From Dave at centralmanclc.com  Sun Oct 19 09:44:39 2003
From: Dave at centralmanclc.com (Dave Thorne)
Date: Sun, 19 Oct 2003 16:44:39 +0100
Subject: [Twisted-Python] conroller.Controller.handle() returning a Deferred
Message-ID: <03Oct19.163755bst.119047@harry.trinity.manchester.sch.uk>

I've been attempting to use the IRC channel to ask this question, but to no
avail. Maybe I'm not using the IRC client correctly, who knows.

However, I have a problem in a woven application whereby my Controller
object has a handle() method that returns a deferred (from an adbapi query)
on which I have set a callback to do something with the query data.

I assumed that my set callback would be executed before the callback that is
(presumably) set by woven to deal with the deferred's completion. Indeed,
with some print statements as debug tools I see that my callback really is
being executed, but as soon as the "checkMatch" callback returns the page
stalls.

It is no doubt an easy problem to fix, but any help would be greatly
appreciated! I've placed the code for the controller below...

Cheers,

Dave



My Code:
========

class PreferencesController(controller.Controller):

   def handle(self, request):
      <snip>
      theApp = app.theApplication

      def checkMatch(results):
         #Do Stuff
         #Return: nothing, None, results?

      uname = "myusername"
      query = "SELECT * FROM people WHERE username = '%s'" % (uname)
      return theApp.dbpool.runQuery(query).addCallback(checkMatch)

========



From bob at redivi.com  Sun Oct 19 10:49:51 2003
From: bob at redivi.com (Bob Ippolito)
Date: Sun, 19 Oct 2003 12:49:51 -0400
Subject: [Twisted-Python] Reactor interface for system configuration and events?
Message-ID: <422E7F7C-0254-11D8-B59D-000A95686CD8@redivi.com>

I've just wrapped the SystemConfiguration interface from Darwin (part 
of the configd project, which is open source under APSL).  Basically it 
lets you query a Whole Lot Of Settings.  It also lets you get 
notification when these settings change.  A lot of this is applicable 
to Twisted applications:
	Power management settings (computer on battery or AC, probably low 
power notification, computer went to sleep, computer woke up, etc.)
	User settings (login, logout)
	Proxy settings (http, https, ftp, ftp prefers PASV, socks, gopher, etc)
	Network settings (device went up, device went down, 802.11 SSID, 
device changed address, etc.)
	Reachability (given current networking settings, is it possible to 
reach a host by name or sock_addr)

Surely some or all of this is applicable to Win32 and Linux.  Anyone 
knowledgeable about this sort of API on those platforms?  We should 
develop an interface to deal with this stuff.

-bob




From rdrb at 123.cl  Sun Oct 19 15:43:16 2003
From: rdrb at 123.cl (=?iso-8859-1?Q?Rita_D=EDaz_y/o_Rodrigo_Benenson?=)
Date: Sun, 19 Oct 2003 18:43:16 -0300
Subject: [Twisted-Python] MetaInterface call error
References: <20031018104221.11841.88662.Mailman@pyramid.twistedmatrix.com>
Message-ID: <000601c3968a$064f4f20$4b30fea9@laboratorio>

Hi!,

the log crash problem was solved as indicated (thanks !), just had to fix
the calls to thread.start_new_thread(reactor.run, ()).
I'm still working to get Khashmir passing the unit tests (again, I suppose).
After some grumble grumbling I discovered the following funny situation
(copied from another screen):


>>> import airhook
>>> a = airhook.AirhookConnection
>>> a
<class 'airhook.AirhookConnection'>
>>> b = a()
TypeError: __call__() takes at least 2 arguments (1 given)

Why __call__? __init__ should be called !

AirhookConnection is defined as:

class AirHookConnection(protocol.ConnectedDatagramProtocol,
interfaces.IUDPConnectedTransport):
   def __init__(self):
      blablblah

Then, in a inspired moment I discovered:
>>> type(a)
<class 'twisted.python.components.MetaInterface'>

Could someone explain to me what it means, and how should I interpret the
"__call__" problem in this context ?
Do I have to register the interface ? or something like that ? Thanks.

RodrigoB.

PS: I had readed that PB wanted to be able to run over AirHook, Khashmir has
an AirHook protocol implementation...





From exarkun at intarweb.us  Sun Oct 19 15:49:53 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 19 Oct 2003 17:49:53 -0400
Subject: [Twisted-Python] MetaInterface call error
In-Reply-To: <000601c3968a$064f4f20$4b30fea9@laboratorio>
References: <20031018104221.11841.88662.Mailman@pyramid.twistedmatrix.com> <000601c3968a$064f4f20$4b30fea9@laboratorio>
Message-ID: <20031019214953.GA19535@intarweb.us>

On Sun, Oct 19, 2003 at 06:43:16PM -0300, Rita D?az y/o Rodrigo Benenson wrote:
> Hi!,
> 
> the log crash problem was solved as indicated (thanks !), just had to fix
> the calls to thread.start_new_thread(reactor.run, ()).
> I'm still working to get Khashmir passing the unit tests (again, I suppose).
> After some grumble grumbling I discovered the following funny situation
> (copied from another screen):
> 
> 
> >>> import airhook
> >>> a = airhook.AirhookConnection
> >>> a
> <class 'airhook.AirhookConnection'>
> >>> b = a()
> TypeError: __call__() takes at least 2 arguments (1 given)
> 
> Why __call__? __init__ should be called !
> 
> AirhookConnection is defined as:
> 
> class AirHookConnection(protocol.ConnectedDatagramProtocol,
> interfaces.IUDPConnectedTransport):
>    def __init__(self):
>       blablblah

  This seems to be an error.  AirHookConnection should not inherit from
IUDPConnectedTransport.  It may have worked with a previous version of
Twisted, but doing this was never supported, and won't work with any
reasonably recent release of Twisted.  Simply removing it from the base
class list should resolve the issue.  If you want to be clean about it, add
this line to the body of the AirHookConnection class definition:

    __implements__ = (interfaces.IUDPConnectedTransport,)

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031019/627e539c/attachment.sig>

From radix at twistedmatrix.com  Sun Oct 19 15:50:41 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Sun, 19 Oct 2003 17:50:41 -0400
Subject: [Twisted-Python] MetaInterface call error
In-Reply-To: <000601c3968a$064f4f20$4b30fea9@laboratorio>
References: <20031018104221.11841.88662.Mailman@pyramid.twistedmatrix.com> <000601c3968a$064f4f20$4b30fea9@laboratorio>
Message-ID: <20031019215041.GE832@radii>

On Sun, Oct 19, 2003 at 06:43:16PM -0300, Rita D?az y/o Rodrigo Benenson wrote:
> AirhookConnection is defined as:
> 
> class AirHookConnection(protocol.ConnectedDatagramProtocol,
> interfaces.IUDPConnectedTransport):

Uhmm... This is totally wrong. Interfaces aren't meant to be
subclassed in implementations. I don't know why the Khashmir author
did that.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From rdrb at 123.cl  Sun Oct 19 16:09:33 2003
From: rdrb at 123.cl (=?iso-8859-1?Q?Rita_D=EDaz_y/o_Rodrigo_Benenson?=)
Date: Sun, 19 Oct 2003 19:09:33 -0300
Subject: [Twisted-Python] Re: MetaInterface call error
Message-ID: <000b01c3968d$aef78cc0$4b30fea9@laboratorio>

Thanks ! Airhook now pass the unit test ! (and there is only one error in
the khashmir unit test).
But as you all know unit test only detect errors, and gives no information
about the existence of more bugs.
Thanks for a so fast response (real time mail support, wow...)
RodrigoB.




From stuart.hungerford at anu.edu.au  Sun Oct 19 22:35:32 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Mon, 20 Oct 2003 14:35:32 +1000
Subject: [Twisted-Python] Rendering Woven pages from non-Woven resources?
Message-ID: <6.0.0.22.0.20031020141949.01e35220@anusf.anu.edu.au>

Hi all,

I have a twisted web application that was created without the
benefit of Woven, where HTML is generated in subclasses of
Resource in the class' render() method.  This is my "old"
application.

I also have a "new" application where most HTML is generated
via subclasses of the Woven page class using various factory
methods etc.

I'd like to standardize both applications to use the Page
subclasses from the "new" application and the HTML they
generate.

So ideally I'd have:


        class new_page(twisted.web.woven.page.Page):
            isLeaf = 1
            templateFile = 'new.xhtml'

            def wmfactory_something(self, request)
                # etc


        # ...

        class old_resource(twisted.web.resource.Resource):
            isLeaf = 1
            def render(self, request):
                # get new_page() rendered from here


To make that last commented bit work, do I need to override
a new render() method for new_page that duplicates the
factory methods etc?  Or can I get the same effect another way?

Any advice much appreciated,


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From dp at twistedmatrix.com  Sun Oct 19 22:50:25 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 20 Oct 2003 00:50:25 -0400
Subject: [Twisted-Python] Rendering Woven pages from non-Woven resources?
In-Reply-To: <6.0.0.22.0.20031020141949.01e35220@anusf.anu.edu.au>
References: <6.0.0.22.0.20031020141949.01e35220@anusf.anu.edu.au>
Message-ID: <EB4ACAFD-02B8-11D8-8B58-000A95864FC4@twistedmatrix.com>

On Oct 20, 2003, at 12:35 AM, Stuart Hungerford wrote:
>

<snip>

>        class old_resource(twisted.web.resource.Resource):
>            isLeaf = 1
>            def render(self, request):
>                # get new_page() rendered from here

		return new_page().render(request)

Tada! :-)

dp




From likwoka at yahoo.com  Mon Oct 20 09:36:21 2003
From: likwoka at yahoo.com (Alex Li)
Date: Mon, 20 Oct 2003 08:36:21 -0700 (PDT)
Subject: [Twisted-Python] Use apache compatible log format from mktap/twistd?
Message-ID: <20031020153621.34509.qmail@web13901.mail.yahoo.com>

Hi all,

Is there a way to generate the twistd log (for webserver) in the Apache
format from mktap/twistd?  I want the Apache format because my log
analsyzer can understand it.

Thanks in advance,
Alex

__________________________________
Do you Yahoo!?
The New Yahoo! Shopping - with improved product search
http://shopping.yahoo.com



From fog at initd.org  Mon Oct 20 09:42:42 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Mon, 20 Oct 2003 17:42:42 +0200
Subject: [Twisted-Python] woven bug?
Message-ID: <1066664561.1144.79.camel@localhost>

hi,

i have a problem with woven loosing a <div> tag where, IMHO, it should
not. note the big IMHO, i still don't know woven that well. right now I
have a template that simply does:

    <div view="menu" />

and my Page subclass has a method for that view;

    def wvfactory_menu(self, request, node, model):
        return page.Page(templateFile="menu.xhtml",
                         templateDirectory=self.templateDirectory)

if the menu.xhtml file has the following structure:

<div id="menu">
  ...
</div>

the <div id="menu"> tag gets lost. the external div is correctly
replaced and has an id like "woven_id_xxxxxxxxxx" but the innermost div
(the one with id "menu") is not there anymore. right now i've found a
dirty hack:

<div id="menu">
<div id="menu">
  ...
</div>
</div>

but, obviously, i don't like at all. is that a woven bug or a
misinterpretation of how the node replacement works? is the outer tag of
a (sub)page always removed? and why?

ciao,
federico

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
  Nessuno dice che non si possa sognare in dettaglio, essere realistici
   e magari realizzarlo pure, il sogno.                        -- <dani>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio è firmata
URL: </pipermail/twisted-python/attachments/20031020/d742c290/attachment.sig>

From itamar at itamarst.org  Mon Oct 20 10:04:46 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 20 Oct 2003 12:04:46 -0400
Subject: [Twisted-Python] Use apache compatible log format from
 mktap/twistd?
In-Reply-To: <20031020153621.34509.qmail@web13901.mail.yahoo.com>
References: <20031020153621.34509.qmail@web13901.mail.yahoo.com>
Message-ID: <20031020120446.54e063d3.itamar@itamarst.org>

On Mon, 20 Oct 2003 08:36:21 -0700 (PDT)
Alex Li <likwoka at yahoo.com> wrote:

> Is there a way to generate the twistd log (for webserver) in the
> Apache format from mktap/twistd?  I want the Apache format because my
> log analsyzer can understand it.

mktap web ...youroptions... --logfile=/path//for/web.log

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From twisted-10152003 at atlas.lcs.mit.edu  Mon Oct 20 10:12:44 2003
From: twisted-10152003 at atlas.lcs.mit.edu (twisted-10152003 at atlas.lcs.mit.edu)
Date: Mon, 20 Oct 2003 12:12:44 -0400
Subject: [Twisted-Python] Ethernet frames
Message-ID: <20031020161244.GA8657@mit.edu>

I am very new to the twisted framework so maybe there is a completely
obvious answer to this question that is eluding me in the
documentation...

Can I use twisted to read and write ethernet frames? How do I listen
and write packets on a particular interface?  

Thanks,
Steve





From mesozoic at polynode.com  Mon Oct 20 10:29:45 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Mon, 20 Oct 2003 12:29:45 -0400
Subject: [Twisted-Python] woven bug?
In-Reply-To: <1066664561.1144.79.camel@localhost>
References: <1066664561.1144.79.camel@localhost>
Message-ID: <1066667385.9515.3.camel@hyla>

On Mon, 2003-10-20 at 11:42, Federico Di Gregorio wrote:
> <div view="menu" />

First off, you shouldn't do this. Since div is a block element,
according to XHTML specs it should be <div view="menu"></div>. But
that's not at issue here.

The top node of a template is not processed the same way its child nodes
are; in the past Donovan has tried to implement this, and [from what I
recall] it simply generated more problems than it was worth. The
solution is to have all your templates look like this:

<div><div id="menu">
 ...
</div></div>

As long as you're not applying any CSS style information to _all_ divs
(which you shouldn't be), this will not interfere with the presentation
of your pages.

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031020/3320fcea/attachment.sig>

From fog at initd.org  Mon Oct 20 10:42:38 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Mon, 20 Oct 2003 18:42:38 +0200
Subject: [Twisted-Python] woven bug?
In-Reply-To: <1066667385.9515.3.camel@hyla>
References: <1066664561.1144.79.camel@localhost>
	 <1066667385.9515.3.camel@hyla>
Message-ID: <1066668157.1147.98.camel@localhost>

Il lun, 2003-10-20 alle 18:29, Alex Levy ha scritto:
> On Mon, 2003-10-20 at 11:42, Federico Di Gregorio wrote:
> > <div view="menu" />
> 
> First off, you shouldn't do this. Since div is a block element,
> according to XHTML specs it should be <div view="menu"></div>. But
> that's not at issue here.

hey, i was not aware of a difference between "<tag/>" and "<tag></tag>".
i always tought the first was just a contraction for the second. i'll go
re-read the xml specs. thank you very much. 

> The top node of a template is not processed the same way its child nodes
> are; in the past Donovan has tried to implement this, and [from what I
> recall] it simply generated more problems than it was worth. The
> solution is to have all your templates look like this:

so it is a feature. thank you very much for the clarification.

federico

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
                              Viviamo in un mondo reale, Ciccio. -- Lucy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio è firmata
URL: </pipermail/twisted-python/attachments/20031020/906231e8/attachment.sig>

From nbm at mithrandr.moria.org  Mon Oct 20 11:25:14 2003
From: nbm at mithrandr.moria.org (Neil Blakey-Milner)
Date: Mon, 20 Oct 2003 19:25:14 +0200
Subject: [Twisted-Python] Ethernet frames
In-Reply-To: <20031020161244.GA8657@mit.edu>
References: <20031020161244.GA8657@mit.edu>
Message-ID: <20031020172514.GA28277@mithrandr.moria.org>

On Mon 2003-10-20 (12:12), twisted-10152003 at atlas.lcs.mit.edu wrote:
> I am very new to the twisted framework so maybe there is a completely
> obvious answer to this question that is eluding me in the
> documentation...
> 
> Can I use twisted to read and write ethernet frames? How do I listen
> and write packets on a particular interface?  

I've used pylibpcap and http://mithrandr.moria.org/files/tipcap.py to
read ethernet frames.  pylibnet will be able to send them.  Someone else
on the list will mention the one Twisted library that provides an
alternative ("pair"?).

Neil
-- 
Neil Blakey-Milner
nbm at mithrandr.moria.org



From ccollier at viawest.net  Mon Oct 20 11:35:24 2003
From: ccollier at viawest.net (ccollier at viawest.net)
Date: Mon, 20 Oct 2003 11:35:24 -0600 (MDT)
Subject: [Twisted-Python] Ethernet frames
In-Reply-To: <20031020172514.GA28277@mithrandr.moria.org>
Message-ID: <Pine.LNX.4.44.0310201134420.17024-100000@radar.atomicservers.com>

While it's not Twisted based, you might find this useful:

http://www.cartel-securite.fr/pbiondi/scapy.html

You can manipulate packets with it, but I'm not sure about ethernet 
frames.

c


On Mon, 20 Oct 2003, Neil Blakey-Milner wrote:

> On Mon 2003-10-20 (12:12), twisted-10152003 at atlas.lcs.mit.edu wrote:
> > I am very new to the twisted framework so maybe there is a completely
> > obvious answer to this question that is eluding me in the
> > documentation...
> > 
> > Can I use twisted to read and write ethernet frames? How do I listen
> > and write packets on a particular interface?  
> 
> I've used pylibpcap and http://mithrandr.moria.org/files/tipcap.py to
> read ethernet frames.  pylibnet will be able to send them.  Someone else
> on the list will mention the one Twisted library that provides an
> alternative ("pair"?).
> 
> Neil
> 




From vlupien at drummonddesigns.com  Mon Oct 20 13:12:10 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Mon, 20 Oct 2003 15:12:10 -0400
Subject: [Twisted-Python] get data from a form
Message-ID: <000001c3973e$101f7750$687ba8c0@martin>

I have a form in one of my page and I want to get the data from this
form in an other web page.  I think I can use the model but I don't know
how to tranfer it to the second page.
 
vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031020/4668dd80/attachment.html>

From dp at twistedmatrix.com  Mon Oct 20 13:20:19 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 20 Oct 2003 15:20:19 -0400
Subject: [Twisted-Python] woven bug?
In-Reply-To: <1066668157.1147.98.camel@localhost>
References: <1066664561.1144.79.camel@localhost> <1066667385.9515.3.camel@hyla> <1066668157.1147.98.camel@localhost>
Message-ID: <716E9CFC-0332-11D8-9517-000A95864FC4@twistedmatrix.com>

On Oct 20, 2003, at 12:42 PM, Federico Di Gregorio wrote:

> so it is a feature. thank you very much for the clarification.

I wouldn't call it a "feature" as much as a "the workaround is simple 
enough to explain, and the proper fix is difficult enough to implement, 
that I don't have time to do it properly"...

Thanks Alex for explaining the situation here.

dp




From foom at fuhm.net  Mon Oct 20 14:07:30 2003
From: foom at fuhm.net (James Y Knight)
Date: Mon, 20 Oct 2003 16:07:30 -0400
Subject: [Twisted-Python] woven bug?
In-Reply-To: <1066668157.1147.98.camel@localhost>
Message-ID: <0905582C-0339-11D8-8551-000A95A50FB2@fuhm.net>

On Monday, October 20, 2003, at 12:42 PM, Federico Di Gregorio wrote:

> hey, i was not aware of a difference between "<tag/>" and 
> "<tag></tag>".
> i always tought the first was just a contraction for the second. i'll 
> go
> re-read the xml specs. thank you very much.

It is, *if* you're talking to an XML parser. The issue is that XHTML is 
supposed to be backwards compatible with HTML4 parsers. They will 
interpret the <tag /> notation to mean the same thing as <tag>. Thus, 
using a block level element like div with that notation means an HTML4 
parser will think it never gets closed and will cause rendering errors.

James




From fog at initd.org  Mon Oct 20 15:17:11 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Mon, 20 Oct 2003 23:17:11 +0200
Subject: [Twisted-Python] woven bug?
In-Reply-To: <0905582C-0339-11D8-8551-000A95A50FB2@fuhm.net>
References: <0905582C-0339-11D8-8551-000A95A50FB2@fuhm.net>
Message-ID: <1066684631.1274.5.camel@localhost>

Il lun, 2003-10-20 alle 22:07, James Y Knight ha scritto:
> On Monday, October 20, 2003, at 12:42 PM, Federico Di Gregorio wrote:
> 
> > hey, i was not aware of a difference between "<tag/>" and 
> > "<tag></tag>".
> > i always tought the first was just a contraction for the second. i'll 
> > go
> > re-read the xml specs. thank you very much.
> 
> It is, *if* you're talking to an XML parser. The issue is that XHTML is 
> supposed to be backwards compatible with HTML4 parsers. They will 
> interpret the <tag /> notation to mean the same thing as <tag>. Thus, 
> using a block level element like div with that notation means an HTML4 
> parser will think it never gets closed and will cause rendering errors.

doh! you're right. knowing that the tag would be replaced by woven with
something meaningful i did not even looked at the problem from this
perspective. i suppose woven parse it as plain XML to build the dom
tree.

thank you very much, digging all that from the sources (as i did with
other pieces of twisted) would have been very long. :)

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
   Lasciate che i furetti vengano a me. -- Maria Luisa Benedetta Panzani
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio è firmata
URL: </pipermail/twisted-python/attachments/20031020/911832d1/attachment.sig>

From golux at comcast.net  Mon Oct 20 21:24:07 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Mon, 20 Oct 2003 23:24:07 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] Add a note about the subtleties of addDeferred
In-Reply-To: <E1ABg5l-0001nB-00@wolfwood>
References: <E1ABg5l-0001nB-00@wolfwood>
Message-ID: <3F94A6D7.1070409@comcast.net>

moshez CVS wrote:

> +<p>Note that adding deferreds to a <code>DeferredList</code> that has
> +been filled already will lead to unpredictable behavior. Only add
> +deferreds to a list that you know has not been filled yet (you can
> +check the <code>.called</code> attribute.</p>

Hm ... in that case, is there some reason not to say "called"
instead of "filled" here?

Steve.




From duke99 at email.ro  Tue Oct 21 05:32:32 2003
From: duke99 at email.ro (soso)
Date: Tue, 21 Oct 2003 14:32:32 +0300
Subject: [Twisted-Python] Deffered question
Message-ID: <200310211132.h9LBWWo16697@zerg.codec.ro>

Hi all, 

I need to implement a command based protocol, that is a client sends a command
to the server and waits for the response. Since the response computation might
be time consuming I have to choose between 2 solutions:
- use Twisted deffereds
- or write my own implementation, a TCP based threaded server. I'm not worried
about scaling since it will not be used by more than 10 clients at a time.

And the question is, how are deffereds actually implemented? My guess is that
there are some worker threads, besides the main thread. Or?

I actually started implementing my own server, Twisted seems too huge. But I may
change my mind, I'm new to both Python and Twisted.

Thanks


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From andrew-twisted at puzzling.org  Tue Oct 21 06:54:01 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 21 Oct 2003 22:54:01 +1000
Subject: [Twisted-Python] Deffered question
In-Reply-To: <200310211132.h9LBWWo16697@zerg.codec.ro>
References: <200310211132.h9LBWWo16697@zerg.codec.ro>
Message-ID: <20031021125401.GF28665@frobozz>

On Tue, Oct 21, 2003 at 02:32:32PM +0300, soso wrote:
> Hi all, 
> 
> I need to implement a command based protocol, that is a client sends a command
> to the server and waits for the response. Since the response computation might
> be time consuming I have to choose between 2 solutions:
> - use Twisted deffereds
> - or write my own implementation, a TCP based threaded server. I'm not worried
> about scaling since it will not be used by more than 10 clients at a time.
> 
> And the question is, how are deffereds actually implemented? My guess is that
> there are some worker threads, besides the main thread. Or?

Deferreds aren't magical at all; the implementation doesn't involve threads,
or anything behind the scenes at all.  By themselves, they don't magically
turn synchronous (i.e. blocking) code into asynchronous (i.e. non-blocking)
code.

They're simply a very convenient abstraction around the concept of a
"deferred result" that eases management of callbacks that operate on that
result.

See also:
    http://twistedmatrix.com/pipermail/twisted-python/2003-June/004333.html

> I actually started implementing my own server, Twisted seems too huge. But I may
> change my mind, I'm new to both Python and Twisted.

Twisted is huge, but then so is the Python standard library.  Twisted is
great for writing servers in.  The upcoming 1.1 release contains a tutorial
that should hopefully make understanding what you need to do to write a
server easier; you can preview the CVS version of it at:
    http://twistedmatrix.com/users/warner/doc-latest/howto/tutorial.html
(That's currently an 800kB page!)

Can you elaborate more on what the "response computation" involves?  If you
can, we can probably sketch out some code that does what you need.

Here's an example off the top of my head, though, that will hopefully help
you a little (warning, barely tested code):

----
from twisted.protocols import basic
from twisted.python import log
from twisted.internet import reactor, threads
from twisted.internet.protocol import ServerFactory

def square(n):
    return n*n

class SquaringProtocol(basic.LineReceiver):
    """A protocol that receives a number, squares it and sends back the
    result.
    
    This drops the connections after one request-response cycle,
    HTTP/1.0-style. 
    """
    
    def lineReceived(self, line):
        try:
            number = int(line)
        except ValueError:
            self.sendLine("%r is not a number" % line)
            return
        
        deferred = threads.deferToThread(square, number)
        # Convert the result to a string
        deferred.addCallback(str)
        # Send it
        deferred.addCallback(self.sendLine)
        # Write any errors to the log file
        deferred.addErrback(log.err)
        # Drop the connection
        deferred.addBoth(lambda x: self.transport.loseConnection())


class RepeatingSquaringProtocol(basic.LineReceiver):
    """A protocol that receives numbers, squares them, and sends back the
    results.
    
    This allows multiple requests to be made on a single connection, without
    waiting for responses.  The requests will queue up on the server, and be
    returned (in the order they were requested) as they are processed.  It
    is up to the client to disconnect.
    """
    
    def connectionMade(self):
        self.busy = 0
        self.queue = []
        
    def lineReceived(self, line):
        try:
            number = int(line)
        except ValueError:
            self.sendLine("%r is not a number" % line)
            return
        
        self.queueRequest(number)
    
    def queueRequest(self, number):
        if self.busy:
            self.queue.append(number)
        else:
            self.processRequest(number)

    def processRequest(self, number):
        deferred = threads.deferToThread(square, number)
        deferred.addCallback(str)
        deferred.addCallback(self.requestDone)
        deferred.addErrback(log.err)

    def requestDone(self, result):
        self.sendLine(result)
        if self.queue:
            number = self.queue.pop(0)
            self.processRequest(number)
        else:
            self.busy = 0
        

if __name__ == '__main__':
    from twisted.python import log
    import sys
    log.startLogging(sys.stdout)
    factory = ServerFactory()
    factory.protocol = SquaringProtocol
    reactor.listenTCP(9001, factory)
    factory = ServerFactory()
    factory.protocol = RepeatingSquaringProtocol
    reactor.listenTCP(9002, factory)
    reactor.run()

----

This example has two slightly different versions of a simple protocol that
squares numbers.  I'm pretending that squaring a number is a slow
calculation that is best run in a worker thread -- imagine your computation
where I'm using 'square'.

Hopefully it gives you an idea of how easy this sort of thing is in Twisted.

-Andrew.




From duke99 at email.ro  Tue Oct 21 07:38:30 2003
From: duke99 at email.ro (soso)
Date: Tue, 21 Oct 2003 16:38:30 +0300
Subject: [Twisted-Python] Deffered question
Message-ID: <200310211338.h9LDcVA22573@zerg.codec.ro>

Hello Andrew, 

Thanks a lot for your detailed answer. The examples you gave made things more
clear now.

> Twisted is huge, but then so is the Python standard library.  Twisted is
> great for writing servers in.  The upcoming 1.1 release contains a tutorial
> that should hopefully make understanding what you need to do to write a
> server easier; you can preview the CVS version of it at:
>     http://twistedmatrix.com/users/warner/doc-latest/howto/tutorial.html
> (That's currently an 800kB page!)

That's great! The documentation is compatible with version 1.0.7?

> Can you elaborate more on what the "response computation" involves?  If you
> can, we can probably sketch out some code that does what you need.

Well, basically I want to write a SNMP management system. The server will query
one or more SNMP servers, receive traps, and save all results in a database. A
client can connect to the server and ask for statistics, or query a SNMP server
(through the application server); both this kind of requests may be time-consuming.
So after seeing your examples, I think that this time consuming server
operations (database, and SNMP queries) should be deffered to a pool of worker
threads.

Ok, now a problem that I heard of is Twisted interaction with wxPython. I did
not test it, but if you or anyone else can confirm that it can work ok it would
be nice. I would like to be able to send commands to server from a modal dialog
and receive back the response. Is it possible?

Thanks,
soso



______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From matteo.giacomazzi at libero.it  Tue Oct 21 07:59:57 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Tue, 21 Oct 2003 15:59:57 +0200
Subject: [Twisted-Python] Deffered question
In-Reply-To: <200310211132.h9LBWWo16697@zerg.codec.ro>
References: <200310211132.h9LBWWo16697@zerg.codec.ro>
Message-ID: <1493025718.20031021155957@libero.it>

Hi,

> I need to implement a command based protocol, that is a client sends
> a  command  to  the  server  and  waits  for the response. Since the
> response  computation  might  be  time  consuming  I  have to choose
> between 2 solutions:
> - use Twisted deffereds
> - or  write my own implementation, a TCP based threaded server. I'm
> not  worried about scaling since it will not be used by more than 10
> clients at a time.

I'm facing a problem like this.

I  used  to  have  a multithreaded server (fully written using Python)
that  accepted  commands  via  a  TCP  or  UNIX  socket, elaborate the
response  (tipically  querying  some remote servers via HTTP) and then
returned the response: one query, one thread.

This  server  runs  since  2001, I updated it, upgraded and refactored
some parts, but it's still kinda "heavy" to manage.
So, I realized that multithred is not _always_ the solution.

In  my case, the server was running (with a web server and a DB server
too) on a dual Xeon architecture. So, at most, two threads are running
on  the  same time but there are more chances that only one of them is
running while the other CPU is used by the web server or the DB.

That's the solution I'm building:
- there are different _processes_, one for every kind of remote server
I have to query;
- _processes_ may run on different (hardware) servers;
- processes  communicate via a  "message passing process" I wrote with
Twisted;

So:  one  process  accepts commands via TCP or UNIX socket, it quickly
parses  the  command and sends a message to the right ``server''; this
``server''  process  the command, does-whatever-it-needs and then send
the response to the first process that, in turn, quickly translates it
in a ``line oriented'' way and returns to the caller.

All  the servers are single-thread: that's because I need only to call
a  remote  host  and  to compute very very simple operations. Maybe in
your case threads would help - but how many threads?

I  would be interested in hearing opinion about this architecture from
Twisted experts.

Kindest regards,
 Matteo




From busch at transporeon.com  Tue Oct 21 08:25:26 2003
From: busch at transporeon.com (Axel Busch)
Date: Tue, 21 Oct 2003 16:25:26 +0200
Subject: AW: [Twisted-Python] Deffered question
In-Reply-To: <200310211338.h9LDcVA22573@zerg.codec.ro>
Message-ID: <004e01c397df$2c902050$4600a8c0@atlas>

> Ok, now a problem that I heard of is Twisted interaction with wxPython. I
did
> not test it, but if you or anyone else can confirm that it can work ok it
would
> be nice. I would like to be able to send commands to server from a modal
dialog
> and receive back the response. Is it possible?

Yep. I posted some examples several weeks ago, and Stephen was 
so nice as to test and refine them. 
He posted them on 2003-10-14 under the subject 
  "[Twisted-Python] PB/wx example pbwxthingy".
Just contact me if you need any help.

Regards, Axel




From duke99 at email.ro  Tue Oct 21 11:56:28 2003
From: duke99 at email.ro (soso)
Date: Tue, 21 Oct 2003 20:56:28 +0300
Subject: AW: [Twisted-Python] Deffered question
Message-ID: <200310211756.h9LHuSx07857@zerg.codec.ro>

Hello Axel,

Thanks for your help. I found the message by browsing the list archive but I
can't get the source code which is attached. I tried to manually decode it from
base64 but I didn't succeed. 
Do you, or others, have the source code archive?

Thanks in advance,
soso


> Yep. I posted some examples several weeks ago, and Stephen was 
> so nice as to test and refine them. 
> He posted them on 2003-10-14 under the subject 
>   "[Twisted-Python] PB/wx example pbwxthingy".
> Just contact me if you need any help.
> 
> Regards, Axel


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From busch at transporeon.com  Tue Oct 21 12:15:59 2003
From: busch at transporeon.com (Axel Busch)
Date: Tue, 21 Oct 2003 20:15:59 +0200
Subject: AW: AW: [Twisted-Python] Deffered question
In-Reply-To: <200310211756.h9LHuSx07857@zerg.codec.ro>
Message-ID: <005a01c397ff$60e215f0$4600a8c0@atlas>

hm, I had no problems with the archive. 
I extracted it, zipped it, and put it to 
https://www.transporeon.org/twisted/ for you to
download.

Greetings -xl

> -----Ursprüngliche Nachricht-----
> Von: twisted-python-admin at twistedmatrix.com 
> [mailto:twisted-python-admin at twistedmatrix.com] Im Auftrag von soso
> Gesendet: Dienstag, 21. Oktober 2003 19:56
> An: twisted-python at twistedmatrix.com
> Betreff: Re: AW: [Twisted-Python] Deffered question
> 
> 
> Hello Axel,
> 
> Thanks for your help. I found the message by browsing the 
> list archive but I
> can't get the source code which is attached. I tried to 
> manually decode it from
> base64 but I didn't succeed. 
> Do you, or others, have the source code archive?
> 
> Thanks in advance,
> soso
> 
> 
> > Yep. I posted some examples several weeks ago, and Stephen was 
> > so nice as to test and refine them. 
> > He posted them on 2003-10-14 under the subject 
> >   "[Twisted-Python] PB/wx example pbwxthingy".
> > Just contact me if you need any help.
> > 
> > Regards, Axel
> 
> 
> ______________________________________________________________________
> Do you want a free e-mail for life ? Get it at http://www.email.ro/
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From duke99 at email.ro  Tue Oct 21 12:32:42 2003
From: duke99 at email.ro (soso)
Date: Tue, 21 Oct 2003 21:32:42 +0300
Subject: AW: [Twisted-Python] Deffered question
Message-ID: <200310211832.h9LIWgR16747@zerg.codec.ro>

Hi,

Thanks a lot for sending the archive Axel and Matteo!

soso

> hm, I had no problems with the archive. 
> I extracted it, zipped it, and put it to 
> https://www.transporeon.org/twisted/ for you to
> download.
> 


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From busch at transporeon.com  Tue Oct 21 12:35:44 2003
From: busch at transporeon.com (Axel Busch)
Date: Tue, 21 Oct 2003 20:35:44 +0200
Subject: [Twisted-Python] Reactor interface for system configuration and events?
In-Reply-To: <422E7F7C-0254-11D8-B59D-000A95686CD8@redivi.com>
Message-ID: <005b01c39802$233e0710$4600a8c0@atlas>

Hi Bob,

> I've just wrapped the SystemConfiguration interface from Darwin 
> (part of the configd project, which is open source under APSL).  
-snip-
> Surely some or all of this is applicable to Win32 and Linux.  Anyone 
> knowledgeable about this sort of API on those platforms?  We should 
> develop an interface to deal with this stuff.

coool. I'm very interested in the reactor interface you proposed. 
Maybe I can help with win32. 

But tell me, I thought twisted is pure python, so how are we 
going to integrate this for win32? The win32all extension does 
not provide the means to do it. 
I could write a .pyd module with c++ and boost. Would this help? 

Some things we would have to think of: For most of the stuff there 
is some difference between 95/98/ME, NT4/2000 and XP/2003. Some 
things will even not be available for 95/98/ME, like some Battery 
states etc. 
Most information should be available through Windows Messages 
like WM_USERCHANGED, WM_DEVICECHANGE etc., so polling is not 
required. Unfortunately 95/98/ME does not broadcast WM_DEVICECHANGE  
for all required device events. 
Well, just some thoughts, I didn't have time to try anything yet.

Regards, -xl





From vlupien at drummonddesigns.com  Tue Oct 21 13:08:14 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Tue, 21 Oct 2003 15:08:14 -0400
Subject: [Twisted-Python] Form with formprocessor
Message-ID: <000001c39806$add26b60$687ba8c0@vicky>

I have a form and I'm using formprocessor for validation.  I want to get
the original form if there's an error and an other page in case of
everything is alright.
I tried to call formprocessor with callback=self and errback=self but it
cause a strange error.
 
Please someone help me, I'm really tired not to be able to use a form.
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031021/92ec1d3a/attachment.html>

From bob at redivi.com  Tue Oct 21 13:22:35 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 21 Oct 2003 15:22:35 -0400
Subject: [Twisted-Python] Reactor interface for system configuration and events?
In-Reply-To: <005b01c39802$233e0710$4600a8c0@atlas>
Message-ID: <ECB844B1-03FB-11D8-A87E-000A95686CD8@redivi.com>

On Tuesday, Oct 21, 2003, at 14:35 America/New_York, Axel Busch wrote:

>> I've just wrapped the SystemConfiguration interface from Darwin
>> (part of the configd project, which is open source under APSL).
> -snip-
>> Surely some or all of this is applicable to Win32 and Linux.  Anyone
>> knowledgeable about this sort of API on those platforms?  We should
>> develop an interface to deal with this stuff.
>
> coool. I'm very interested in the reactor interface you proposed.
> Maybe I can help with win32.
>
> But tell me, I thought twisted is pure python, so how are we
> going to integrate this for win32? The win32all extension does
> not provide the means to do it.
> I could write a .pyd module with c++ and boost. Would this help?

Yes, we'd need to write an extension or depend on ctypes to do this for 
win32 if win32all can't do it.  Twisted is not "pure python", but it 
will work without any C extension modules.

> Some things we would have to think of: For most of the stuff there
> is some difference between 95/98/ME, NT4/2000 and XP/2003. Some
> things will even not be available for 95/98/ME, like some Battery
> states etc.
> Most information should be available through Windows Messages
> like WM_USERCHANGED, WM_DEVICECHANGE etc., so polling is not
> required. Unfortunately 95/98/ME does not broadcast WM_DEVICECHANGE
> for all required device events.
> Well, just some thoughts, I didn't have time to try anything yet.

Well if it's not available, it won't work.. perhaps we'd have to divide 
it up into multiple interfaces, and have some sort of gestalt mechanism 
where you can ask if the reactor can provide the service on the 
particular platform it's currently running on.

-bob




From exarkun at intarweb.us  Tue Oct 21 16:40:29 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 21 Oct 2003 18:40:29 -0400
Subject: [Twisted-Python] Form with formprocessor
In-Reply-To: <000001c39806$add26b60$687ba8c0@vicky>
References: <000001c39806$add26b60$687ba8c0@vicky>
Message-ID: <20031021224029.GA28312@intarweb.us>

On Tue, Oct 21, 2003 at 03:08:14PM -0400, vicky lupien wrote:
> I have a form and I'm using formprocessor for validation.  I want to get
> the original form if there's an error and an other page in case of
> everything is alright.
> I tried to call formprocessor with callback=self and errback=self but it
> cause a strange error.
>  
> Please someone help me, I'm really tired not to be able to use a form.
>  

  Vicky, looking over your posting history it seems like you don't have much
luck getting answers to your questions.  I don't know anything about form
processing with twisted.web, so I can't answer your questions directly,
however maybe I can help in another way.

  First, if you include a very short program that tries to do what you want
to accomplish, but fails in a predictable way, people will be able to run
it, see what went wrong, and possibly suggest fixes.  This is much easier
for people than trying to guess exactly what you're doing, and exactly how
it's failing.

  Second, if you include the traceback you get when you attempt something,
along with a few lines of context surrounding the line that causes the
problem, people familiar with the part of Twisted you are working with might
be able to guess the problem right off.  This isn't as good as including a
minimal example (as described in the previous paragraph), but it is
sometimes enough to get what help you need.

  Third, a more general description of what you're trying to accomplish
is often useful.  With this information, people can get a sense of why
you're doing what you're doing, and with an understanding of your goal,
suggest courses of actions (including dropping whatever your current
approach is and starting from a direction you might not have considered).

  Last, in case you aren't aware of it, many Twisted developers are also
active on IRC (irc.freenode.net) in #twisted.  If you're still unable to get
help on the mailing list, logging on there and poking people might be a way
to make progress.  Sometimes there are communication problems that are hard
to resolve via email but are easily worked out in a more interactive medium.

  Hope this helps,

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031021/9ede8bdb/attachment.sig>

From matteo.giacomazzi at libero.it  Wed Oct 22 01:41:13 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Wed, 22 Oct 2003 09:41:13 +0200
Subject: [Twisted-Python] HTTP Client - HOW TO?
Message-ID: <1674168296.20031022094113@libero.it>

Hi all,

  I'm  writing  a  software  that needs to query some remote hosts via
  HTTP  (sometimes using GET method, sometimes using POST method): the
  problem is I cannot figure out how I should use the HTTPClient class
  or the QueryProtocol class... any hint somewhere?
  I'm not able to find anything useful in the API docs.

  Any help will be greatly appreciated!

  Many thanks in advance.

Regards,
 Matteo




From andrew-twisted at puzzling.org  Wed Oct 22 02:10:41 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 22 Oct 2003 18:10:41 +1000
Subject: [Twisted-Python] HTTP Client - HOW TO?
In-Reply-To: <1674168296.20031022094113@libero.it>
References: <1674168296.20031022094113@libero.it>
Message-ID: <20031022081041.GD21523@frobozz>

On Wed, Oct 22, 2003 at 09:41:13AM +0200, Matteo Giacomazzi wrote:
> Hi all,
> 
>   I'm  writing  a  software  that needs to query some remote hosts via
>   HTTP  (sometimes using GET method, sometimes using POST method): the
>   problem is I cannot figure out how I should use the HTTPClient class
>   or the QueryProtocol class... any hint somewhere?
>   I'm not able to find anything useful in the API docs.
> 
>   Any help will be greatly appreciated!

It's hardly a proper how-to, but hopefully this will help:

    http://twistedmatrix.com/documents/examples/getpage.py

-Andrew.




From matteo.giacomazzi at libero.it  Wed Oct 22 02:43:49 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Wed, 22 Oct 2003 10:43:49 +0200
Subject: [Twisted-Python] HTTP Client - HOW TO?
In-Reply-To: <20031022081041.GD21523@frobozz>
References: <1674168296.20031022094113@libero.it>
 <20031022081041.GD21523@frobozz>
Message-ID: <1197924484.20031022104349@libero.it>

Hi Andrew,

>>   Any help will be greatly appreciated!

> It's hardly a proper how-to, but hopefully this will help:

>     http://twistedmatrix.com/documents/examples/getpage.py

Thanks!
I  was  looking  at  the  twisted/web/client.py  as  per suggestion of
Moshez,  via  IRC,  and  in  fact  I'm  going  to  understand  how the
HTTPClient class works.

Looking  at the code of getPage, it seems that I can pass a parameter,
called  `postdata',  and  it will use the content of that parameter to
send the POST payload - am I right?

Many thanks!

Regards,
 Matteo




From matteo.giacomazzi at libero.it  Wed Oct 22 04:40:23 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Wed, 22 Oct 2003 12:40:23 +0200
Subject: [Twisted-Python] Timeouts
Message-ID: <5814917750.20031022124023@libero.it>

Hi all,

  I'm  doing  some  tests  with  twisted.web.client  and it is working
  pretty fine!

  I've  just  a  doubt: the function getPage accepts a parameter named
  `timeout'  (well,  it  takes it as a **kwarg and pass it along up to
  the factory).
  BTW,  this  is  the  timeout  in  seconds: if the remote host didn't
  return a response within that time, the errback is called.

  Now  the  question:  what  happens  if the remote IP address doesn't
  respond at all (host unreachable)?
  I'm testing it and it seems that the timeout never occours!
  Does it mean that the whole thread is blocked?
  The socket.connect method is blocking?

  Many thanks in advance!

Regards
 Matteo




From justinjohnson at fastmail.fm  Wed Oct 22 12:24:42 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 22 Oct 2003 12:24:42 -0600
Subject: [Twisted-Python] twistd and win32 service
Message-ID: <20031022182442.26FA93D802@www.fastmail.fm>

Is it possible to have twistd run a .tap but do so within a windows
service?

The general consensus on the mailing list archives seems to be that I'd
need to setup my code to not require twistd but just run standalone. 
However, since I'm running on windows I'd like to have twistd handle
loading the win32eventreactor for me so I don't have to worry about
import orders and all that.

Thanks.
-Justin



From itamar at itamarst.org  Wed Oct 22 12:50:10 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 22 Oct 2003 14:50:10 -0400
Subject: [Twisted-Python] twistd and win32 service
In-Reply-To: <20031022182442.26FA93D802@www.fastmail.fm>
References: <20031022182442.26FA93D802@www.fastmail.fm>
Message-ID: <20031022145010.12e64a54.itamar@itamarst.org>

On Wed, 22 Oct 2003 12:24:42 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> The general consensus on the mailing list archives seems to be that
> I'd need to setup my code to not require twistd but just run
> standalone. 

Uh. *Maybe* that's the consensus, but it's not actually correct. You can
have a tap or tac run as a NT service.

Lets say you have  a script "server.py" that is runnable with "twistd
-y", you can do (and similar code will work for TAPs):

import sys, os
import win32serviceutil, win32service


class MyService(win32serviceutil.ServiceFramework):
    """NT Service."""
    
    _svc_name_ = "MyService"
    _svc_display_name_ = "MyService server"

    def SvcDoRun(self):
        import server
        f = open(os.path.join(server.rootPath, "cyberhigh.log"), 'a')
        from twisted.python.log import startLogging
        from twisted.application.app import startApplication
        from twisted.internet import reactor        
        startLogging(f)
        startApplication(server.application, 0)
        reactor.run()
    
    def SvcStop(self):
        self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
        from twisted.internet import reactor
        reactor.stop()


if __name__ == '__main__':
    win32serviceutil.HandleCommandLine(MyService)


-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From scosol at yahoo.com  Wed Oct 22 13:56:37 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Wed, 22 Oct 2003 12:56:37 -0700 (PDT)
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031022145010.12e64a54.itamar@itamarst.org>
Message-ID: <20031022195637.10110.qmail@web13902.mail.yahoo.com>

So- my needs are simple- all I need to do is accept a
web request containing some POST data, query my DB,
then return a result.

I think I've wrapped my head around the individual
components needed here, but I simply don't know how I
*should* be doing it.

I know I need twisted.enterprise.adbapi talking to my
db, and then twisted.web handling the incoming
requests, but from there it gets a little fuzzy.

What should go in my .rpy?
I remember somewhere in the docs it saying that the
.rpy should only be a few lines.
Is this just speaking about making it import my code
instead of actually containing my code?
(I'm still thinking in PERL/CGI style where I would
just make the .rpy the app itself)

Should I be using woven? (I think not- I have no heavy
presentation needs)

And then- why am I "supposed" to use twisted.app?
I don't need app-level persistance, and this is on
dedicated machines where I can just background the
process in the startup scripts- so daemonization is
not needed? Am I missing something in that?

Ugh- I guess I'm just asking for best-practices for
the scenario above... thanks :)

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From duke99 at email.ro  Wed Oct 22 14:28:31 2003
From: duke99 at email.ro (soso)
Date: Wed, 22 Oct 2003 23:28:31 +0300
Subject: [Twisted-Python] Weird thread count
Message-ID: <200310222028.h9MKSVH11490@zerg.codec.ro>

Hello all, 

The following client code creates 3 threads on startup, even if there is no
server to connect to. And I have no clue why. I'm running on Win2k and that's
what taskmanager says. Any ideas?

<<<<<<<<<<<<<<<<<<<<<<
from twisted.internet.protocol import Protocol, ClientFactory
from twisted.internet import reactor

class CommProtocol(Protocol):
    
    def connectionMade(self):
        print 'Connected'
        self.transport.write("Hello there...")
        
    def connectionLost(self, reason):
        print 'Connection lost: ', reason
        
    def dataReceived(self, data):
        print 'Data received: ', str(data)
        
class CommFactory(ClientFactory):
    
    protocol = CommProtocol
    
    def clientConnectionFailed(self, connector, reason):
        print "Failed to connect: ", reason
        
host = 'localhost'
port = 8000

reactor.connectTCP(host, port, CommFactory())
reactor.run()
>>>>>>>>>>>>>>>>>>>>>>>>>


Thanks,
soso

______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From duke99 at email.ro  Wed Oct 22 14:29:38 2003
From: duke99 at email.ro (soso)
Date: Wed, 22 Oct 2003 23:29:38 +0300
Subject: [Twisted-Python] Weird thread count
Message-ID: <200310222029.h9MKTcY17720@zerg.codec.ro>

Hello all, 

The following client code creates 3 threads on startup, even if there is no 
server to connect to. And I have no clue why. I'm running on Win2k and that's 
what taskmanager says. Any ideas?

<<<<<<<<<<<<<<<<<<<<<<
from twisted.internet.protocol import Protocol, ClientFactory
from twisted.internet import reactor

class CommProtocol(Protocol):
    
    def connectionMade(self):
        print 'Connected'
        self.transport.write("Hello there...")
        
    def connectionLost(self, reason):
        print 'Connection lost: ', reason
        
    def dataReceived(self, data):
        print 'Data received: ', str(data)
        
class CommFactory(ClientFactory):
    
    protocol = CommProtocol
    
    def clientConnectionFailed(self, connector, reason):
        print "Failed to connect: ", reason
        
host = 'localhost'
port = 8000

reactor.connectTCP(host, port, CommFactory())
reactor.run()
>>>>>>>>>>>>>>>>>>>>>>>>>


Thanks,
soso



______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From duke99 at email.ro  Wed Oct 22 14:29:45 2003
From: duke99 at email.ro (soso)
Date: Wed, 22 Oct 2003 23:29:45 +0300
Subject: [Twisted-Python] Weird thread count
Message-ID: <200310222029.h9MKTjR18417@zerg.codec.ro>

Hello all, 

The following client code creates 3 threads on startup, even if there is no 
server to connect to. And I have no clue why. I'm running on Win2k and that's 
what taskmanager says. Any ideas?

<<<<<<<<<<<<<<<<<<<<<<
from twisted.internet.protocol import Protocol, ClientFactory
from twisted.internet import reactor

class CommProtocol(Protocol):
    
    def connectionMade(self):
        print 'Connected'
        self.transport.write("Hello there...")
        
    def connectionLost(self, reason):
        print 'Connection lost: ', reason
        
    def dataReceived(self, data):
        print 'Data received: ', str(data)
        
class CommFactory(ClientFactory):
    
    protocol = CommProtocol
    
    def clientConnectionFailed(self, connector, reason):
        print "Failed to connect: ", reason
        
host = 'localhost'
port = 8000

reactor.connectTCP(host, port, CommFactory())
reactor.run()
>>>>>>>>>>>>>>>>>>>>>>>>>


Thanks,
soso



______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From itamar at itamarst.org  Wed Oct 22 14:44:39 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 22 Oct 2003 16:44:39 -0400
Subject: [Twisted-Python] Weird thread count
In-Reply-To: <200310222028.h9MKSVH11490@zerg.codec.ro>
References: <200310222028.h9MKSVH11490@zerg.codec.ro>
Message-ID: <20031022164439.343fcbfe.itamar@itamarst.org>

On Wed, 22 Oct 2003 23:28:31 +0300
soso <duke99 at email.ro> wrote:

> The following client code creates 3 threads on startup, even if there
> is no server to connect to. And I have no clue why. I'm running on
> Win2k and that's what taskmanager says. Any ideas?

Presumably those are internal Python threads. Try running just Python
and see how many threads there are.

Also note that Twisted doesn't use threads for networking), so number of
networking connections is irrelevant.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From cce at clarkevans.com  Wed Oct 22 15:02:49 2003
From: cce at clarkevans.com (Clark C. Evans)
Date: Wed, 22 Oct 2003 14:02:49 -0700
Subject: [Twisted-Python] Weird thread count
In-Reply-To: <20031022164439.343fcbfe.itamar@itamarst.org>
References: <200310222028.h9MKSVH11490@zerg.codec.ro> <20031022164439.343fcbfe.itamar@itamarst.org>
Message-ID: <20031022210249.GC27474@clarkevans.com>

soso,

  You can also compile Python without threads... ;)

Clark

On Wed, Oct 22, 2003 at 04:44:39PM -0400, Itamar Shtull-Trauring wrote:
| On Wed, 22 Oct 2003 23:28:31 +0300
| soso <duke99 at email.ro> wrote:
| 
| > The following client code creates 3 threads on startup, even if there
| > is no server to connect to. And I have no clue why. I'm running on
| > Win2k and that's what taskmanager says. Any ideas?
| 
| Presumably those are internal Python threads. Try running just Python
| and see how many threads there are.
| 
| Also note that Twisted doesn't use threads for networking), so number of
| networking connections is irrelevant.
| 
| -- 
| Itamar Shtull-Trauring    http://itamarst.org/
| Available for Python & Twisted consulting
| 
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From duke99 at email.ro  Wed Oct 22 15:19:15 2003
From: duke99 at email.ro (soso)
Date: Thu, 23 Oct 2003 00:19:15 +0300
Subject: [Twisted-Python] Weird thread count
Message-ID: <200310222119.h9MLJGa09856@zerg.codec.ro>

Yep, that's why I thought is weird. 
Anyway, I double-checked. I restarted the computer and checked with Spy++ too.
Still 3 threads...

Also, if you remove the "reactor.connectTCP..." line it behaves ok, only 1 thread.

> On Wed, 22 Oct 2003 23:28:31 +0300
> soso <duke99 at email.ro> wrote:
> 
> > The following client code creates 3 threads on startup, even if there
> > is no server to connect to. And I have no clue why. I'm running on
> > Win2k and that's what taskmanager says. Any ideas?
> 
> Presumably those are internal Python threads. Try running just Python
> and see how many threads there are.
> 
> Also note that Twisted doesn't use threads for networking), so number of
> networking connections is irrelevant.
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 





______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From bob at redivi.com  Wed Oct 22 15:45:19 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 22 Oct 2003 17:45:19 -0400
Subject: [Twisted-Python] Weird thread count
In-Reply-To: <200310222119.h9MLJGa09856@zerg.codec.ro>
References: <200310222119.h9MLJGa09856@zerg.codec.ro>
Message-ID: <07A83862-04D9-11D8-A1F1-000A95686CD8@redivi.com>

On Oct 22, 2003, at 5:19 PM, soso wrote:

> Yep, that's why I thought is weird.
> Anyway, I double-checked. I restarted the computer and checked with 
> Spy++ too.
> Still 3 threads...
>
> Also, if you remove the "reactor.connectTCP..." line it behaves ok, 
> only 1 thread.
>
>> On Wed, 22 Oct 2003 23:28:31 +0300
>> soso <duke99 at email.ro> wrote:
>>
>>> The following client code creates 3 threads on startup, even if there
>>> is no server to connect to. And I have no clue why. I'm running on
>>> Win2k and that's what taskmanager says. Any ideas?
>>
>> Presumably those are internal Python threads. Try running just Python
>> and see how many threads there are.
>>
>> Also note that Twisted doesn't use threads for networking), so number 
>> of
>> networking connections is irrelevant.

Windows may use threads in its implementation of select(), or something.

Why does it matter, anyways?  Twisted doesn't explicitly create any 
threads unless you ask it to.

-bob




From maoy at cis.upenn.edu  Wed Oct 22 20:37:51 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 22 Oct 2003 22:37:51 -0400 (EDT)
Subject: [Twisted-Python] new cred related examples?
In-Reply-To: <20031022210249.GC27474@clarkevans.com>
Message-ID: <Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>

Hi,

  Do we have any cred related examples? like how to do authentication, 
encryption, etc? Thank you!


Yun






From andrew-twisted at puzzling.org  Wed Oct 22 21:02:35 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 23 Oct 2003 13:02:35 +1000
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031022195637.10110.qmail@web13902.mail.yahoo.com>
References: <20031022145010.12e64a54.itamar@itamarst.org> <20031022195637.10110.qmail@web13902.mail.yahoo.com>
Message-ID: <20031023030235.GA24973@frobozz>

On Wed, Oct 22, 2003 at 12:56:37PM -0700, Nathan Seven wrote:
> 
> I know I need twisted.enterprise.adbapi talking to my
> db, and then twisted.web handling the incoming
> requests, but from there it gets a little fuzzy.

(Just to confuse you even more, you don't *need* adbapi; you can ignore it
and do DB work in your own threads if that's more convenient.  adbapi is
probably what you want, though :)

> What should go in my .rpy?
> I remember somewhere in the docs it saying that the
> .rpy should only be a few lines.
> Is this just speaking about making it import my code
> instead of actually containing my code?

Yep, that's right.

> (I'm still thinking in PERL/CGI style where I would
> just make the .rpy the app itself)

Yeah, don't do that :)

> Should I be using woven? (I think not- I have no heavy
> presentation needs)

I think you're probably right here, too.  It's pretty easy to just write
your own Twisted Web resources, if all you need is simple stuff.

> And then- why am I "supposed" to use twisted.app?
> I don't need app-level persistance, and this is on
> dedicated machines where I can just background the
> process in the startup scripts- so daemonization is
> not needed? Am I missing something in that?

I'll let someone who actually knows something about the new app stuff answer
this :)

-Andrew.




From glyph at twistedmatrix.com  Wed Oct 22 21:03:34 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 22 Oct 2003 23:03:34 -0400
Subject: [Twisted-Python] new cred related examples?
In-Reply-To: <Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>
References: <Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>
Message-ID: <3F974506.3060009@twistedmatrix.com>

Yun Mao wrote:
> Hi,
> 
>   Do we have any cred related examples? like how to do authentication, 
> encryption, etc? Thank you!

You might want to check out Quotient CVS (www.divmod.org): we just 
implemented an authentication database and realm.

But, uh, encryption?  cred is an authentication framework.  You'd have 
to do encryption in your protocol...?




From itamar at itamarst.org  Wed Oct 22 21:17:49 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 22 Oct 2003 23:17:49 -0400
Subject: [Twisted-Python] new cred related examples?
In-Reply-To: <Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>
References: <20031022210249.GC27474@clarkevans.com>
	<Pine.LNX.4.44.0310222233540.11139-100000@klondike.cis.upenn.edu>
Message-ID: <20031022231749.74895e9f.itamar@itamarst.org>

On Wed, 22 Oct 2003 22:37:51 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

>   Do we have any cred related examples? like how to do authentication,
>   
> encryption, etc? Thank you!

1.1 has documentation (ETA in 2 days, you can get rc2 if you want). Or,
CVS docs are available at
http://twistedmatrix.com/users/warner/doc-latest/howto/cred.html

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From tv at tv.debian.net  Mon Oct 20 11:59:54 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Mon, 20 Oct 2003 20:59:54 +0300
Subject: [Twisted-Python] Ethernet frames
In-Reply-To: <20031020161244.GA8657@mit.edu>
References: <20031020161244.GA8657@mit.edu>
Message-ID: <3F94229A.5040307@tv.debian.net>

twisted-10152003 at atlas.lcs.mit.edu wrote:
> Can I use twisted to read and write ethernet frames? How do I listen
> and write packets on a particular interface?  

Well, there's doc/examples/pairudp.py, which uses twisted.pair to 
read/write packets on TUN/TAP virtual interfaces.

In twisted.protocols, you will see ethernet, ip and rawup modules,
helping you to parse raw packets.

The same thing can be hooked into e.g. pcap, or directly to raw sockets, 
and packet sockets. That part hasn't been written yet, but should be 
relatively straightforward.




From duke99 at email.ro  Mon Oct 20 13:22:34 2003
From: duke99 at email.ro (soso)
Date: Mon, 20 Oct 2003 22:22:34 +0300
Subject: [Twisted-Python] Deffered question
Message-ID: <200310201922.h9KJMYo05280@zerg.codec.ro>

Hi all, 

I need to implement a command based protocol, that is a client sends a command
to the server and waits for the response. Since the response computation might
be time consuming I have to choose between 2 solutions:
- use Twisted deffereds
- or write my own implementation, a TCP based threaded server. I'm not worried
about scaling since it will not be used by more than 10 clients at a time.

And the question is, how are deffereds actually implemented? My guess is that
there are some worker threads, besides the main thread. Or?

I actually started implementing my own server, Twisted seems too huge. But I may
change my mind, I'm new to both Python and Twisted.

Thanks


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From m at zadka.site.co.il  Wed Oct 22 23:44:54 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 23 Oct 2003 05:44:54 -0000
Subject: [Twisted-Python] twistd and win32 service
In-Reply-To: <20031022145010.12e64a54.itamar@itamarst.org>
References: <20031022145010.12e64a54.itamar@itamarst.org>, <20031022182442.26FA93D802@www.fastmail.fm>
Message-ID: <20031023054454.14113.qmail@green.zadka.com>

On Wed, 22 Oct 2003, Itamar Shtull-Trauring <itamar at itamarst.org> wrote:

> Uh. *Maybe* that's the consensus, but it's not actually correct. You can
> have a tap or tac run as a NT service.
> 
> Lets say you have  a script "server.py" that is runnable with "twistd
> -y", you can do (and similar code will work for TAPs):
<snip>

Any hope of integrating that code into twistw?

-- 
Moshe Zadka -- http://moshez.org/
Buffy: I don't like you hanging out with someone that... short.
Riley: Yeah, a lot of young people nowadays are experimenting with shortness.
Agile Programming Language -- http://www.python.org/



From m at zadka.site.co.il  Thu Oct 23 00:50:21 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 23 Oct 2003 06:50:21 -0000
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031023030235.GA24973@frobozz>
References: <20031023030235.GA24973@frobozz>, <20031022145010.12e64a54.itamar@itamarst.org> <20031022195637.10110.qmail@web13902.mail.yahoo.com>
Message-ID: <20031023065021.15062.qmail@green.zadka.com>

On Wed, Oct 22, 2003 at 12:56:37PM -0700, Nathan Seven wrote:
 
> > And then- why am I "supposed" to use twisted.app?
> > I don't need app-level persistance, and this is on
> > dedicated machines where I can just background the
> > process in the startup scripts- so daemonization is
> > not needed? Am I missing something in that?

On Thu, 23 Oct 2003, Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
 
> I'll let someone who actually knows something about the new app stuff answer
> this :)

Well, I guess that means me :) 

First things first: you don't *need* app. Writing a Python script which
ends with .run() is a perfectly fine way to run Twisted. As long as you
can afford to modify it whenever you want profiling information. And
as long as you are willing to modify it whenever you want a log file.
And as long as you are sure backgrounding is a good enough approximation
for you. And as long as you don't need pid files. But at some point,
you are likely to want those things. twisted.application is a way to
*separate configuration from deployment*. It represents a layer of indirection
between your code (so-called business logic) and between the running, with
all the traditional costs and benefits of such indirection.

I strongly suggest reading the tutorial [in CVS] -- it starts out using
reactor.run(), and eventually progresses to use application. I think the
most important thing, for me, here is the core realization: your code
should (probably) know very little about whether it is being used with
an application or just a reactor.run(). Even when using Services, you
can easily have your script do something like:

s.startService()
reactor.run()
s.stopService()



From v6kk1hg02 at sneakemail.com  Thu Oct 23 03:03:18 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 23 Oct 2003 09:03:18 -0000
Subject: [Twisted-Python] Compile failure in 1.1.0rc1 Windows
Message-ID: <14312-02880@sneakemail.com>

Windows 2000, MSVC6sp5, the full Microsoft SDK is also installed (free from MS website in case you didn't know), as well as MASM for that matter.  Necessary Microsoft INCLUDE and PATH environment variables OK, and as per standard.  All TM prerequisites like SSL etc are installed correctly.  Then tried a simple setup.py install command.

The failure is a missing include file referenced from portmap.c.

#include <rpc/rpc.h>
#include <rpc/pmap_clnt.h>

Some clues.  On Windows, there *is* a VC6 and MSSDK header called rpc.h.  However it does not live in a folder called rpc.  And there is *no* header called pmap_clnt.h.  The last part of the output is shown below.

I'm sorry if this is the wrong list, only trying to help out with the rc1 release.

Mark

===================================
C:\Microsoft Visual Studio\VC98\BIN\cl.exe /c /nologo /Ox /MD /W3 /GX /DNDEBUG -
DWIN32=1 -IC:\Python\include -IC:\Python\PC /Tctwisted/spread/cBanana.c /Fobuild
\temp.win32-2.3\Release\twisted/spread/cBanana.obj
cBanana.c
twisted/spread/cBanana.c(350) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(360) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(371) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(375) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(384) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(387) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(461) : warning C4305: '=' : truncation from 'const int
' to 'char '
twisted/spread/cBanana.c(470) : warning C4305: '=' : truncation from 'const int
' to 'char '
C:\Microsoft Visual Studio\VC98\BIN\link.exe /DLL /nologo /INCREMENTAL:NO /LIBPA
TH:C:\Python\libs /LIBPATH:C:\Python\PCBuild /EXPORT:initcBanana build\temp.win3
2-2.3\Release\twisted/spread/cBanana.obj /OUT:build\lib.win32-2.3\twisted\spread
\cBanana.pyd /IMPLIB:build\temp.win32-2.3\Release\twisted/spread\cBanana.lib
   Creating library build\temp.win32-2.3\Release\twisted/spread\cBanana.lib and
object build\temp.win32-2.3\Release\twisted/spread\cBanana.exp
building 'twisted.runner.portmap' extension
creating build\temp.win32-2.3\Release\twisted\runner
C:\Microsoft Visual Studio\VC98\BIN\cl.exe /c /nologo /Ox /MD /W3 /GX /DNDEBUG -
DWIN32=1 -IC:\Python\include -IC:\Python\PC /Tctwisted/runner/portmap.c /Fobuild
\temp.win32-2.3\Release\twisted/runner/portmap.obj
portmap.c
twisted/runner/portmap.c(23) : fatal error C1083: Cannot open include file: 'rpc
/rpc.h': No such file or directory
error: command '"C:\Microsoft Visual Studio\VC98\BIN\cl.exe"' failed with exit s
tatus 2



From vlupien at drummonddesigns.com  Thu Oct 23 08:02:27 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 23 Oct 2003 10:02:27 -0400
Subject: [Twisted-Python] application maker for twisted_1.1.0rc
Message-ID: <000001c3996e$4b231af0$687ba8c0@vicky>

My OS is win2k.  I installed twisted-1.1.0rc but I don't understand how
application maker works.  
 
I want to start a web application on port 8585.  Is there someone who
can explain me how it works.
 
The previous version was easy to use with the option "launch" but now
it's "create".  I'm really mix up.
 
Vicky
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031023/2698a5c8/attachment.html>

From itamar at itamarst.org  Thu Oct 23 08:25:39 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 23 Oct 2003 10:25:39 -0400
Subject: [Twisted-Python] application maker for twisted_1.1.0rc
In-Reply-To: <000001c3996e$4b231af0$687ba8c0@vicky>
References: <000001c3996e$4b231af0$687ba8c0@vicky>
Message-ID: <20031023102539.1cd926ba.itamar@itamarst.org>

On Thu, 23 Oct 2003 10:02:27 -0400
"vicky lupien" <vlupien at drummonddesigns.com> wrote:

> My OS is win2k.  I installed twisted-1.1.0rc but I don't understand
> how application maker works.  
>  
> I want to start a web application on port 8585.  Is there someone who
> can explain me how it works.
>  
> The previous version was easy to use with the option "launch" but now
> it's "create".  I'm really mix up.

Hm, that may've been tktwistd, which was removed in this release but
will be back at some point.

There are still command line tools, however, so you can do:

c:\python22\scripts\twistd.py -f web.tap

in a DOS window.

Or, don't use TAPs, and make your script runnable directly (i.e., use
reactor.run()). The using twisted.web howto has examples.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 23 08:29:11 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 23 Oct 2003 10:29:11 -0400
Subject: [Twisted-Python] Compile failure in 1.1.0rc1 Windows
In-Reply-To: <14312-02880@sneakemail.com>
References: <14312-02880@sneakemail.com>
Message-ID: <20031023102911.2fae3716.itamar@itamarst.org>

On 23 Oct 2003 09:03:18 -0000
"Mark Evans" <v6kk1hg02 at sneakemail.com> wrote:

> Windows 2000, MSVC6sp5, the full Microsoft SDK is also installed (free
> from MS website in case you didn't know), as well as MASM for that
> matter.  Necessary Microsoft INCLUDE and PATH environment variables
> OK, and as per standard.  All TM prerequisites like SSL etc are
> installed correctly.  Then tried a simple setup.py install command.

Errors display, yes, but in latest versions of Twisted it just means
these specific C modules won't build. They are all optional. In other
words, just ignore it.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 23 08:31:11 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 23 Oct 2003 10:31:11 -0400
Subject: [Twisted-Python] twistd and win32 service
In-Reply-To: <20031023054454.14113.qmail@green.zadka.com>
References: <20031022145010.12e64a54.itamar@itamarst.org>
	<20031022182442.26FA93D802@www.fastmail.fm>
	<20031023054454.14113.qmail@green.zadka.com>
Message-ID: <20031023103111.3e9344eb.itamar@itamarst.org>

On 23 Oct 2003 05:44:54 -0000
Moshe Zadka <m at zadka.site.co.il> wrote:

> Any hope of integrating that code into twistw?

Sure, but, "it's not that simple." That's not how you run the service -
once you've written that script you run it with "--install" and then
"start", something like that. So it'd take a little fiddling with
command-line args and figuring out the internals of the service
registration to figure out how to make genericv script. 

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Thu Oct 23 08:33:03 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 23 Oct 2003 10:33:03 -0400
Subject: [Twisted-Python] Deffered question
In-Reply-To: <200310201922.h9KJMYo05280@zerg.codec.ro>
References: <200310201922.h9KJMYo05280@zerg.codec.ro>
Message-ID: <20031023103303.1f287e42.itamar@itamarst.org>

On Mon, 20 Oct 2003 22:22:34 +0300
soso <duke99 at email.ro> wrote:

> I need to implement a command based protocol, that is a client sends
> a command to the server and waits for the response. Since the
> response computation might be time consuming I have to choose
> between 2 solutions: - use Twisted deffereds - or write my own
> implementation, a TCP based threaded server. I'm not worried about
> scaling since it will not be used by more than 10 clients at a time.

Deferreds don't solve this problem. They just make doing callbacks
easier.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From maoy at cis.upenn.edu  Thu Oct 23 08:59:07 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 23 Oct 2003 10:59:07 -0400 (EDT)
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031023102539.1cd926ba.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>

Hi, suppose I have a software with GPL license, written in Python and used 
twisted. I want to distribute the software to a couple of people for test, 
and usually they don't have twisted installed. Is it leagal for me to make 
a package with twisted in?  ( a little stupid question ;) It's a little 
hard for me to let them install separately because I slightly modified 
twisted source.

Another concern is that twisted is becoming larger and larger. I actually 
only use very little of them (mainly in twisted.internet and 
twisted.python). Is there an easy way to make a small package? Thanks!


Yun





From bob at redivi.com  Thu Oct 23 10:11:54 2003
From: bob at redivi.com (Bob Ippolito)
Date: Thu, 23 Oct 2003 12:11:54 -0400
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>
References: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>
Message-ID: <9E56A510-0573-11D8-9B7B-000A95686CD8@redivi.com>

On Oct 23, 2003, at 10:59 AM, Yun Mao wrote:

> Hi, suppose I have a software with GPL license, written in Python and 
> used
> twisted. I want to distribute the software to a couple of people for 
> test,
> and usually they don't have twisted installed. Is it leagal for me to 
> make
> a package with twisted in?  ( a little stupid question ;) It's a little
> hard for me to let them install separately because I slightly modified
> twisted source.

What did you modify?  Chances are, it might be something we would like 
to support in future versions of Twisted or it may be a case where 
there is another way that does not require modification of Twisted that 
we could recommend to you.

> Another concern is that twisted is becoming larger and larger. I 
> actually
> only use very little of them (mainly in twisted.internet and
> twisted.python). Is there an easy way to make a small package? Thanks!

It's theoretically possible, but it's neither easy nor supported.  
Twisted is only about 4 megs uncompressed, so it's likely to be far 
smaller than that through gzip or bzip2.
 >>> import os, stat, operator
 >>> size = reduce(operator.add, [os.stat(f.strip())[stat.ST_SIZE] for f 
in os.popen('find . -name "*.py"')])
 >>> print size / (2.**20)
4.06226062775

-bob




From twisted at zadka.site.co.il  Thu Oct 23 10:27:53 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 23 Oct 2003 16:27:53 -0000
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>
References: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu>
Message-ID: <20031023162753.2572.qmail@green.zadka.com>

On Thu, 23 Oct 2003, Yun Mao <maoy at cis.upenn.edu> wrote:

> Hi, suppose I have a software with GPL license, written in Python and used 
> twisted. I want to distribute the software to a couple of people for test, 
> and usually they don't have twisted installed. Is it leagal for me to make 
> a package with twisted in? 

For legal questions, it's best to ask a lawyer. My non-lawyer advice is
"yes", but IANAL.

> hard for me to let them install separately because I slightly modified 
> twisted source.

That's bad. It's not a terribly good practice. If you have useful patches,
it's probably better to send them to us so we can integrate them. Better
for us, since we have a better Twisted, and better for you, since you
don't have to maintain and forward-port your changes. In some cases,
you might be fixing something that doesn't need fixing -- and then we'll
be able to show you a better way. Better for us, because we have a better
feeling of what needs more documentation, and better for you, since your
code is better.

> Another concern is that twisted is becoming larger and larger. I actually 
> only use very little of them (mainly in twisted.internet and 
> twisted.python). Is there an easy way to make a small package? Thanks!

One easy thing to do is to base your distribution on the NoDocs packages.
Much of the size of Twisted is there. I'm not a big fan of "small
distributions" since that requires more support for strange configurations
from the developers. Is <1MB of bzipped sources really that much? If
you want something really deployable, you'll have to include Python
anyway, and that would dwarf the size of Twisted.



From bob at redivi.com  Thu Oct 23 11:10:06 2003
From: bob at redivi.com (Bob Ippolito)
Date: Thu, 23 Oct 2003 13:10:06 -0400
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031023162753.2572.qmail@green.zadka.com>
References: <Pine.LNX.4.44.0310231052590.11139-100000@klondike.cis.upenn.edu> <20031023162753.2572.qmail@green.zadka.com>
Message-ID: <BFE0C6D3-057B-11D8-9B7B-000A95686CD8@redivi.com>

On Oct 23, 2003, at 12:27 PM, Moshe Zadka wrote:

> On Thu, 23 Oct 2003, Yun Mao <maoy at cis.upenn.edu> wrote:
>
>> Another concern is that twisted is becoming larger and larger. I 
>> actually
>> only use very little of them (mainly in twisted.internet and
>> twisted.python). Is there an easy way to make a small package? Thanks!
>
> One easy thing to do is to base your distribution on the NoDocs 
> packages.
> Much of the size of Twisted is there. I'm not a big fan of "small
> distributions" since that requires more support for strange 
> configurations
> from the developers. Is <1MB of bzipped sources really that much? If
> you want something really deployable, you'll have to include Python
> anyway, and that would dwarf the size of Twisted.

Also, FYI, when deploying on Mac OS X using bundlebuilder.py (comes 
with Mac versions of Python 2.3), you have quite a few options:

       --semi-standalone		includes any used modules/extensions
       --standalone			includes Python and any used modules/extensions
       -x, --exclude=MODULE	exclude module (with --(semi-)standalone)
       -i, --include=MODULE		include module (with --(semi-)standalone)
       --package=PACKAGE		include a whole package (with 
--(semi-)standalone)
       --strip					strip binaries (remove debug info)

Any included modules are put in a zip file, using the zip import 
feature.. so the deployed size of a full Twisted installation would be 
pretty small, especially if you weren't using much of it.  
bundlebuilder attempts to detect all the modules that you are actually 
using, but it does this without executing code or importing modules so 
it's not perfect (hence the exclude and include options).  I haven't 
used py2exe or freeze before, but they may or may not have some of 
these features.  It's possible to create a self-contained, relocatable, 
easily deployable (no install process, just download + double click) OS 
X application bundle that works on any OS X 10.2+ installation (maybe 
even 10.1 if using --standalone) using this tool.

-bob




From vlupien at drummonddesigns.com  Thu Oct 23 11:50:27 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Thu, 23 Oct 2003 13:50:27 -0400
Subject: [Twisted-Python] question about setSubmodel in web.woven.model
Message-ID: <000001c3998e$252bf770$687ba8c0@vicky>

I took a look in the class Model in the module model and I found one
difference.  A part of the code is gone in the function setSubmodel.
 
Original code:
 
def setSubmodel(self, request=None, name=None, value=None):
        """
        Set a submodel on this model. If getSubmodel or lookupSubmodel
        ever return a Deferred, I ought to set this in a place that
        lookupSubmodel/getSubmodel know about, so they can use it as a
        cache.
        """
        if value is None:
            warnings.warn("Warning! setSubmodel should now take the
request as the first argument")
            value = name
            name = request
            request = None
 
        if self.submodelCheck(request, name):
            if self.submodels.has_key(name):
                del self.submodels[name]
            setattr(self, name, value)
 
and here's the new code:
 
def setSubmodel(self, request=None, name=None, value=None):
        """
        Set a submodel on this model. If getSubmodel or lookupSubmodel
        ever return a Deferred, I ought to set this in a place that
        lookupSubmodel/getSubmodel know about, so they can use it as a
        cache.
        """
 
        if self.submodelCheck(request, name):
            if self.submodels.has_key(name):
                del self.submodels[name]
            setattr(self, name, value)
 
Now I tried to run my application and I got this error :
exceptions.TypeError: cannot concatenate 'str' and 'NoneType' objects
When I add the missing part of code, everything is alright.  I look in
my own code and I'd never call the function setSubmodel, so I wanna
know if the error is somewhere else in the twisted code.
 
Vicky
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031023/eb38ef4c/attachment.html>

From corydodt at twistedmatrix.com  Thu Oct 23 13:02:59 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Thu, 23 Oct 2003 12:02:59 -0700
Subject: [Twisted-Python] twistd and win32 service
In-Reply-To: <20031023103111.3e9344eb.itamar@itamarst.org>
References: <20031022145010.12e64a54.itamar@itamarst.org>	<20031022182442.26FA93D802@www.fastmail.fm>	<20031023054454.14113.qmail@green.zadka.com> <20031023103111.3e9344eb.itamar@itamarst.org>
Message-ID: <3F9825E3.3030400@twistedmatrix.com>

How about something like tap2exe?  The exe it outputs is an installer that 
installs the tap and also installs (and optionally starts) the service.

C


Itamar Shtull-Trauring wrote:

> On 23 Oct 2003 05:44:54 -0000
> Moshe Zadka <m at zadka.site.co.il> wrote:
> 
> 
>>Any hope of integrating that code into twistw?
> 
> 
> Sure, but, "it's not that simple." That's not how you run the service -
> once you've written that script you run it with "--install" and then
> "start", something like that. So it'd take a little fiddling with
> command-line args and figuring out the internals of the service
> registration to figure out how to make genericv script. 
> 





From scosol at yahoo.com  Thu Oct 23 13:18:50 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Thu, 23 Oct 2003 12:18:50 -0700 (PDT)
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031023030235.GA24973@frobozz>
Message-ID: <20031023191850.44980.qmail@web13904.mail.yahoo.com>

--- Andrew Bennetts <andrew-twisted at puzzling.org>
wrote:
> 
> (Just to confuse you even more, you don't *need*
> adbapi; you can ignore it
> and do DB work in your own threads if that's more
> convenient.  adbapi is
> probably what you want, though :)

Yes, I'll absolutely need the connection-pool
functionality.
...
Alright- I think it's become clearer to me now-

I need to create my main app, that connects itself to
my db, and runs a web server-
Then my request handling code simply needs to gather
the client data, call the sql function and deferr-
then on callback I just spit the data back to the
client.

All of my business logic is going to be in the DB's
stored procedures- so with this sort of setup the app
side of things is infinitly scalable :)

Thank's for your help-



=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From scosol at yahoo.com  Thu Oct 23 13:28:44 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Thu, 23 Oct 2003 12:28:44 -0700 (PDT)
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031023065021.15062.qmail@green.zadka.com>
Message-ID: <20031023192844.76133.qmail@web13901.mail.yahoo.com>

--- Moshe Zadka <m at zadka.site.co.il> wrote:
> 
> > > And then- why am I "supposed" to use
> twisted.app?
>
> twisted.application is a way to
> *separate configuration from deployment*. It
> represents a layer of indirection
> between your code (so-called business logic) and
> between the running, with
> all the traditional costs and benefits of such
> indirection.

Hmmm- yes I suppose for ease of transportation to
other systems/OSes it makes sense-

> I strongly suggest reading the tutorial [in CVS] --
> it starts out using
> reactor.run(), and eventually progresses to use
> application.

Hmmm- so there are updated docs in CVS?
I'll check them out-

Speaking of- just as commentary from someone totally
new to twisted-
There's a lot of documentation on the site- almost all
of my questions have been answered by looking through
it.
But- I must say that it is really lacking in
organization- there are very important points in
certain spots that seem like they are just anecdotally
added to the previous paragraph.  Many times I have
wanted to refer back to some document so find some
point, and I have been entirely unable to find the
right one.
(like when I was deciphering exactly what the rpy
files were supposed to be used for)
There are no less than 4 seperate places where rpys
are discussed- and only by reading *all 4* of them do
you understand.
Anyway- most of you are probably all aware of that,
but just thought I'd mention it (as someone coming in
fresh) :)

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From nieder at mail.ru  Thu Oct 23 16:59:10 2003
From: nieder at mail.ru (Ricardo Niederberger Cabral)
Date: Thu, 23 Oct 2003 22:59:10 +0000
Subject: [Twisted-Python] importing twisted modules from my source tree
Message-ID: <20031023225910.GA4797@localhost>

(talking about Twisted 1.0.8alpha3)

I'd like to ship my application source code with some twisted modules
(mostly spread.pb and dependencies), but i'm facing some strange
problems, which i guess are due to some magic done on files like
twisted/internet/reactor.py:

del sys.modules['twisted.internet.reactor']

Anyway, I placed the entire twisted dir inside my 'net' package, so
other modules can import twisted from there. (later, i'd remove
twisted modules i don't need). 

Since some twisted modules import other twisted modules out of it's
package, i had to hardcode something like 

sys.path.append('/home/rnc/prj/imgseek-net/isnLib/net/') 

before any twisted related stuff is imported.

But i get the following error when running my app (which eventually imports
imgClient, who by it's turn eventually imports reactor from twisted.internet):

Traceback (most recent call last):
  File "./isnLib/net/imgClient.py", line 68, in connect
    reactor.connectTCP(self.addr, self.port, factory)
AttributeError: 'module' object has no attribute 'connectTCP'

I've noticed that if I run "python isnLib/net/imgClient.py" on a
command line, reactor is imported correctly (and then becomes a bound
method of twisted.internet.default.SelectReactor).

(If necessary, my code is at
http://cvs.sf.net/viewcvs.py/imgseek/imgseek-net2/isnLib/net/#dirlist)

One solution would be asking the user to install the full Twisted
package, but i really don't want that as I don't need things like
Woven, Lore, etc.

Any ideas ?

Best regards,
-- 
rnc <nieder|at|mail.ru>



From glyph at twistedmatrix.com  Thu Oct 23 20:41:06 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 23 Oct 2003 22:41:06 -0400
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <20031023192844.76133.qmail@web13901.mail.yahoo.com>
References: <20031023192844.76133.qmail@web13901.mail.yahoo.com>
Message-ID: <3F989142.40808@twistedmatrix.com>

Nathan Seven wrote:

> But- I must say that it is really lacking in
> organization- there are very important points in
> certain spots that seem like they are just anecdotally
> added to the previous paragraph.

We don't currently have a documentation editor, although we're aware of 
the problem and have been looking for one for a long time.  Want to 
volunteer? :)




From mary-twisted at puzzling.org  Thu Oct 23 20:46:26 2003
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Fri, 24 Oct 2003 12:46:26 +1000
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <3F989142.40808@twistedmatrix.com>
References: <20031023192844.76133.qmail@web13901.mail.yahoo.com> <3F989142.40808@twistedmatrix.com>
Message-ID: <20031024024626.GJ4897@titus>

On Thu, Oct 23, 2003, Glyph Lefkowitz wrote:
> Nathan Seven wrote:
> 
> >But- I must say that it is really lacking in organization- there are
> >very important points in certain spots that seem like they are just
> >anecdotally added to the previous paragraph.
> 
> We don't currently have a documentation editor, although we're aware
> of the problem and have been looking for one for a long time.  Want to
> volunteer? :)

I am not the original poster but... I would be interested in
doing/helping with this.

But, not for the next four weeks.

-Mary



From maoy at cis.upenn.edu  Thu Oct 23 20:47:31 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 23 Oct 2003 22:47:31 -0400 (EDT)
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031023162753.2572.qmail@green.zadka.com>
Message-ID: <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>

> That's bad. It's not a terribly good practice. If you have useful patches,
> it's probably better to send them to us so we can integrate them. Better
> for us, since we have a better Twisted, and better for you, since you
> don't have to maintain and forward-port your changes. In some cases,

What I did is add a bind to interface support to the connectTCP method.  
Do you feel it's useful?

For example, 
reactor.connectTCP ( self.remotehost, self.remoteport, 
                            sfactory, self.timeout, None, self.interface)
where self.interface='eth1'

This only works on Linux..

> you might be fixing something that doesn't need fixing -- and then we'll
> be able to show you a better way. Better for us, because we have a better
> feeling of what needs more documentation, and better for you, since your
> code is better.





From andrew-twisted at puzzling.org  Thu Oct 23 20:53:35 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 24 Oct 2003 12:53:35 +1000
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>
References: <20031023162753.2572.qmail@green.zadka.com> <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>
Message-ID: <20031024025335.GB28713@frobozz>

On Thu, Oct 23, 2003 at 10:47:31PM -0400, Yun Mao wrote:
> 
> What I did is add a bind to interface support to the connectTCP method.  
> Do you feel it's useful?
> 
> For example, 
> reactor.connectTCP ( self.remotehost, self.remoteport, 
>                             sfactory, self.timeout, None, self.interface)
> where self.interface='eth1'
> 
> This only works on Linux..

There's already a bindAddress optional argument that you could possibly use
for this (and it's cross-platform)... I'm guessing there's some reason why
you need to bind the local side by device rather than by IP address?

-Andrew.




From maoy at cis.upenn.edu  Thu Oct 23 21:24:58 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Thu, 23 Oct 2003 23:24:58 -0400 (EDT)
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031024025335.GB28713@frobozz>
Message-ID: <Pine.LNX.4.44.0310232302520.18105-100000@klondike.cis.upenn.edu>

> 
> There's already a bindAddress optional argument that you could possibly use
> for this (and it's cross-platform)... I'm guessing there's some reason why
> you need to bind the local side by device rather than by IP address?
> 
> -Andrew.
> 

Because I can't get it working. This looks different from the TCP server
side. My senario is that I have both ethernet (eth0) and 802.11(eth1)  
available, and I want one TCP connection use eth0 and the other one use
eth1. binding IP addresses for the two connections doesn't work for me..
Even it'll work, getting the IP for the specific interface is still a
little troublesome..

Yun






From mesozoic at polynode.com  Thu Oct 23 21:32:50 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Thu, 23 Oct 2003 23:32:50 -0400
Subject: [Twisted-Python] question about setSubmodel in web.woven.model
In-Reply-To: <000001c3998e$252bf770$687ba8c0@vicky>
References: <000001c3998e$252bf770$687ba8c0@vicky>
Message-ID: <1066966370.9516.630.camel@hyla>

On Thu, 2003-10-23 at 13:50, vicky lupien wrote:
> I took a look in the class Model in the module model and I found one
> difference.  A part of the code is gone in the function setSubmodel.

> Now I tried to run my application and I got this error : 
> exceptions.TypeError: cannot concatenate 'str' and 'NoneType' objects

This is strange, though it can likely be explained by someone more
familiar with Woven's underpinnings (Donovan?).

However, I feel I should repeat some of what JP said earlier:

If you include A) some example code that you're using, B) the traceback
you get when you hit the exception, or C) a general description of what
you're trying to do, you are more likely to get poignant advice.

In general, for problems like this, I always try IRC first (#twisted in
irc.freenode.net). If nobody there can help, then I post to the list.
There is often someone available who can help you figure out what's
going wrong.

Please post some sample code and a traceback, and it will be much easier
to determine where this error is happening (and why).
 
-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031023/06f3e8b5/attachment.sig>

From andrew-twisted at puzzling.org  Thu Oct 23 21:52:46 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 24 Oct 2003 13:52:46 +1000
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310232302520.18105-100000@klondike.cis.upenn.edu>
References: <20031024025335.GB28713@frobozz> <Pine.LNX.4.44.0310232302520.18105-100000@klondike.cis.upenn.edu>
Message-ID: <20031024035246.GD28713@frobozz>

On Thu, Oct 23, 2003 at 11:24:58PM -0400, Yun Mao wrote:
> > 
> > There's already a bindAddress optional argument that you could possibly use
> > for this (and it's cross-platform)... I'm guessing there's some reason why
> > you need to bind the local side by device rather than by IP address?
> > 
> > -Andrew.
> > 
> 
> Because I can't get it working. This looks different from the TCP server
> side. My senario is that I have both ethernet (eth0) and 802.11(eth1)  
> available, and I want one TCP connection use eth0 and the other one use
> eth1. binding IP addresses for the two connections doesn't work for me..

*Please* submit a bug report!  We can't know that things don't work for
people if they don't tell us :)

http://twistedmatrix.com/bugs/

> Even it'll work, getting the IP for the specific interface is still a
> little troublesome..

Yeah, I suspected as much.  There are definitely times when it's more
convenient to work in terms of devices than in terms of IP addresses,
depending on the problem you are trying to solve.  Could submit this to the
issue tracker as a feature request?

Thanks!

-Andrew.




From maoy at cis.upenn.edu  Thu Oct 23 22:47:13 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Fri, 24 Oct 2003 00:47:13 -0400 (EDT)
Subject: [Twisted-Python] delivering application
In-Reply-To: <20031024035246.GD28713@frobozz>
Message-ID: <Pine.LNX.4.44.0310240044390.20381-100000@klondike.cis.upenn.edu>

On Fri, 24 Oct 2003, Andrew Bennetts wrote:

> *Please* submit a bug report!  We can't know that things don't work for
> people if they don't tell us :)
I didn't submit b/c I'm still not sure it's a bug or my fault or the 
system default behavior, and I don't have time recently to make it 
clear.. :)

Yun





From exarkun at intarweb.us  Thu Oct 23 23:05:32 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 24 Oct 2003 01:05:32 -0400
Subject: [Twisted-Python] importing twisted modules from my source tree
In-Reply-To: <20031023225910.GA4797@localhost>
References: <20031023225910.GA4797@localhost>
Message-ID: <20031024050532.GA3013@intarweb.us>

On Thu, Oct 23, 2003 at 10:59:10PM +0000, Ricardo Niederberger Cabral wrote:
> 
> But i get the following error when running my app (which eventually
> imports imgClient, who by it's turn eventually imports reactor from
> twisted.internet):
> 
> Traceback (most recent call last):
>   File "./isnLib/net/imgClient.py", line 68, in connect
>     reactor.connectTCP(self.addr, self.port, factory)
> AttributeError: 'module' object has no attribute 'connectTCP'

  How is your app launched?  (I checked out the CVS, but couldn't find the
main entry point, so I couldn't reproduce the above exception).

> 
> I've noticed that if I run "python isnLib/net/imgClient.py" on a
> command line, reactor is imported correctly (and then becomes a bound
> method of twisted.internet.default.SelectReactor).
> 

  Indeed, this worked for me as well.

  A possibly unrelated point:

  Your "failsafe" code in imgServer.py is definitely not helpful.  Let the
user configure their own environment (I, for example, do not have
/usr/local/lib/python2.1).  Aside from adding random, possibly non-existent
paths to sys.path, adding site-packages from *different versions* of Python
will only cause you misery (to answer a question from the comments in the
code, the preferred way to include packages in a user's home directory is to
use sitecustomize.py to add those directories, or to set up PYTHONPATH
properly).

  If the import fails, I'd recommend just letting it fail, and including a
section in your README for people not familiar with Python on how to remedy
this problem.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031024/b838ad89/attachment.sig>

From scosol at yahoo.com  Fri Oct 24 00:24:14 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Thu, 23 Oct 2003 23:24:14 -0700 (PDT)
Subject: [Twisted-Python] High Level Implementation Question
In-Reply-To: <3F989142.40808@twistedmatrix.com>
Message-ID: <20031024062414.95522.qmail@web13904.mail.yahoo.com>

--- Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> Nathan Seven wrote:
> 
> > But- I must say that it is really lacking in
> > organization- there are very important points in
> > certain spots that seem like they are just
> anecdotally
> > added to the previous paragraph.
> 
> We don't currently have a documentation editor,
> although we're aware of 
> the problem and have been looking for one for a long
> time.  Want to 
> volunteer? :)

I'd be happy to assist wen the time is right, but I
don't think I'm in the proper position to do so right
now, knowing very little about twisted.
As for now, I've contributed in my own way (bought a
tshirt)- and with that, I must give respect to the
logo's designer-
It's one of the best logo's I've ever seen :)

But yeah- once I'm familiar enough with twisted to
make sense of everythign, it should be short business
sorting out the documentation, and adding to it where
it's lacking :)

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From m at zadka.site.co.il  Fri Oct 24 01:20:22 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 24 Oct 2003 07:20:22 -0000
Subject: [Twisted-Python] delivering application
In-Reply-To: <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>
References: <Pine.LNX.4.44.0310232244230.18105-100000@klondike.cis.upenn.edu>
Message-ID: <20031024072022.23178.qmail@green.zadka.com>

On Thu, 23 Oct 2003, Yun Mao <maoy at cis.upenn.edu> wrote:

> For example, 
> reactor.connectTCP ( self.remotehost, self.remoteport, 
>                             sfactory, self.timeout, None, self.interface)
> where self.interface='eth1'
> 
> This only works on Linux..

This is exactly the kind of thing beter done with connectWith, and
exactly why we added the connectWith escape-mechanism. You can implement
IConnector, for example, by inheriting from tcp.Connector, overriding
_makeTransport to call your subclass of Client which will override
the constructor to make custom bindings. That might take a few more
lines, on the order of 15 or so, but in return you can use standard
Twisted and you can use other reactors.

connectWith and listenWith are indeed poorly documented. I have opened
issue 367 to handle their documentation, and I hope I'll be able to work
on it soon. Please feel free to send your current diffs-vs-CVS-Twisted
to the issue, it will give me a concrete example to work with.



From nieder at mail.ru  Fri Oct 24 00:47:36 2003
From: nieder at mail.ru (Ricardo Niederberger Cabral)
Date: Fri, 24 Oct 2003 06:47:36 +0000
Subject: [Twisted-Python] importing twisted modules from my source tree
In-Reply-To: <20031024050532.GA3013@intarweb.us>
References: <20031023225910.GA4797@localhost> <20031024050532.GA3013@intarweb.us>
Message-ID: <20031024064736.GA7053@localhost>

* Jp Calderone <exarkun at intarweb.us> [2003-10-24 03:14]:
> On Thu, Oct 23, 2003 at 10:59:10PM +0000, Ricardo Niederberger Cabral wrote:
> > 
> > But i get the following error when running my app (which eventually
> > imports imgClient, who by it's turn eventually imports reactor from
> > twisted.internet):
> > 
> > Traceback (most recent call last):
> >   File "./isnLib/net/imgClient.py", line 68, in connect
> >     reactor.connectTCP(self.addr, self.port, factory)
> > AttributeError: 'module' object has no attribute 'connectTCP'
> 
>   How is your app launched?  (I checked out the CVS, but couldn't find the
> main entry point, so I couldn't reproduce the above exception).
> 

You can run a server with "./imgSeekNet -s" from the root folder, but
you'd first need to do a "python setup.py build" and then copy
build/lib-foo/isnLib/img/_imgdb.so to isnLib/img/). And building it
requires wxWindows dev stuff.

Thanks and best regards,
-- 
rnc <nieder|at|mail.ru>



From golux at comcast.net  Fri Oct 24 11:29:43 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Fri, 24 Oct 2003 13:29:43 -0400
Subject: [Twisted-Python] importing twisted modules from my source tree
In-Reply-To: <20031024064736.GA7053@localhost>
References: <20031023225910.GA4797@localhost> <20031024050532.GA3013@intarweb.us> <20031024064736.GA7053@localhost>
Message-ID: <3F996187.9050007@comcast.net>

Ricardo Niederberger Cabral wrote:

> You can run a server with "./imgSeekNet -s" from the root folder, but
> you'd first need to do a "python setup.py build" and then copy
> build/lib-foo/isnLib/img/_imgdb.so to isnLib/img/). And building it
> requires wxWindows dev stuff.

Interesting that you have wxWindows (via wxPython, I assume)
dependencies in your server.  I've taken pains to keep the
code that's common to our server and its wxPython client
free of wx dependencies.  Do you have a combined client/server,
or an admin interface built into your server?

Just curious.

- Steve.




From maoy at cis.upenn.edu  Fri Oct 24 14:38:00 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Fri, 24 Oct 2003 16:38:00 -0400 (EDT)
Subject: [Twisted-Python] minimal python version?
In-Reply-To: <3F996187.9050007@comcast.net>
Message-ID: <Pine.LNX.4.44.0310241636260.25386-100000@klondike.cis.upenn.edu>

Hi, what's the minimal python version for correctly make twisted run? 
I'm pretty happy that 2.2.3 is working, is 2.2.1 supported?

Yun





From nieder at mail.ru  Fri Oct 24 13:14:49 2003
From: nieder at mail.ru (Ricardo Niederberger Cabral)
Date: Fri, 24 Oct 2003 19:14:49 +0000
Subject: [Twisted-Python] importing twisted modules from my source tree
In-Reply-To: <3F996187.9050007@comcast.net>
References: <20031023225910.GA4797@localhost> <20031024050532.GA3013@intarweb.us> <20031024064736.GA7053@localhost> <3F996187.9050007@comcast.net>
Message-ID: <20031024191449.GA9455@localhost>

* Stephen C. Waterbury <golux at comcast.net> [2003-10-24 15:49]:
> Ricardo Niederberger Cabral wrote:
> 
> >You can run a server with "./imgSeekNet -s" from the root folder, but
> >you'd first need to do a "python setup.py build" and then copy
> >build/lib-foo/isnLib/img/_imgdb.so to isnLib/img/). And building it
> >requires wxWindows dev stuff.
> 
> Interesting that you have wxWindows (via wxPython, I assume)
> dependencies in your server.  I've taken pains to keep the
> code that's common to our server and its wxPython client
> free of wx dependencies.  Do you have a combined client/server,
> or an admin interface built into your server?

It's a combined client/server. The server subsystem always runs
(doesn't need wxPython), and the wxPython GUI which calls a client
subsystem can be optionally started. (when that happens, a call to
twisted.internet.wxsupport.install is made)

In my case I also use wxWindows c++ libs for reading some image
formats on the image processing and database extension module.

Best regards,
-- 
rnc <nieder|at|mail.ru>



From radix at twistedmatrix.com  Fri Oct 24 15:51:37 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Fri, 24 Oct 2003 17:51:37 -0400
Subject: [Twisted-Python] minimal python version?
In-Reply-To: <Pine.LNX.4.44.0310241636260.25386-100000@klondike.cis.upenn.edu>
References: <3F996187.9050007@comcast.net> <Pine.LNX.4.44.0310241636260.25386-100000@klondike.cis.upenn.edu>
Message-ID: <20031024215137.GC832@radii>

On Fri, Oct 24, 2003 at 04:38:00PM -0400, Yun Mao wrote:
> Hi, what's the minimal python version for correctly make twisted run? 
> I'm pretty happy that 2.2.3 is working, is 2.2.1 supported?

2.2.0 (I'll update the README - it just says "2.2" right now)

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From pje at telecommunity.com  Sat Oct 25 08:07:42 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Sat, 25 Oct 2003 10:07:42 -0400
Subject: [Twisted-Python] Odd behavior in IRC logbot
Message-ID: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>

I've been using a slightly modified version of the IRC logging bot example 
to log traffic on #peak.  I've noticed, however, that it occasionally seems 
to hang, and has to be manually restarted.  As a workaround, I've set up a 
cronjob to kill and restart it daily, but that seems like a kludge.

Does anybody know why this happens?  Is there some kind of reconnect 
timeout such that it'll give up on reconnecting if the server it's trying 
to connect to is down?  I've noticed that the hang behavior seems to be 
correlated with global announcements about shutting down the IRC netwrok.




From andrew-twisted at puzzling.org  Sat Oct 25 10:21:38 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 26 Oct 2003 03:21:38 +1100
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
References: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
Message-ID: <20031025162138.GB32552@frobozz>

On Sat, Oct 25, 2003 at 10:07:42AM -0400, Phillip J. Eby wrote:
> I've been using a slightly modified version of the IRC logging bot example 
> to log traffic on #peak.  I've noticed, however, that it occasionally seems 
> to hang, and has to be manually restarted.  As a workaround, I've set up a 
> cronjob to kill and restart it daily, but that seems like a kludge.
> 
> Does anybody know why this happens?  Is there some kind of reconnect 
> timeout such that it'll give up on reconnecting if the server it's trying 
> to connect to is down?  I've noticed that the hang behavior seems to be 
> correlated with global announcements about shutting down the IRC netwrok.

The ClientFactory subclass in doc/examples/ircLogBot.py is very simple:
    ...
    def clientConnectionLost(self, connector, reason):
        """If we get disconnected, reconnect to server."""
        connector.connect()

    def clientConnectionFailed(self, connector, reason):
        print "connection failed:", reason
        reactor.stop()
    ...

Perhaps clientConnectionFailed is being triggered, instead of
clientConnectionLost (which has no delay at all, as you can see)?  (The docs
don't clearly say this, but ccF is called when there was no connection
established, and ccL is called when a connection was made and then
disconnected).

(I'm presuming your slightly modified version hasn't changed the
LogBotFactory...)

-Andrew.




From maoy at cis.upenn.edu  Sat Oct 25 10:45:22 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Sat, 25 Oct 2003 12:45:22 -0400 (EDT)
Subject: [Twisted-Python] minimal python version?
In-Reply-To: <20031024215137.GC832@radii>
Message-ID: <Pine.LNX.4.44.0310251243440.25766-100000@klondike.cis.upenn.edu>

This may not be true..

$ python localsocks.py 
Traceback (most recent call last):
  File "localsocks.py", line 191, in ?
    main()
  File "localsocks.py", line 176, in main
    config = Options()
  File "twisted/python/usage.py", line 134, in __init__
    (longOpt, shortOpt, docs, settings, synonyms, dispatch) = c()
  File "twisted/python/usage.py", line 349, in _gather_handlers
    dispatch[prettyName] = new.instancemethod(fn, self, self.__class__)
TypeError: instancemethod() argument 3 must be class, not type

$ python
Python 2.2 (#1, Apr 12 2002, 15:29:57)
[GCC 2.96 20000731 (Red Hat Linux 7.2 2.96-109)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>>


I don't have this trouble when I use python 2.2.3.

Yun


On Fri, 24 Oct 2003, Christopher Armstrong wrote:

> On Fri, Oct 24, 2003 at 04:38:00PM -0400, Yun Mao wrote:
> > Hi, what's the minimal python version for correctly make twisted run? 
> > I'm pretty happy that 2.2.3 is working, is 2.2.1 supported?
> 
> 2.2.0 (I'll update the README - it just says "2.2" right now)
> 
> 




From andrew-twisted at puzzling.org  Sat Oct 25 10:57:29 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 26 Oct 2003 03:57:29 +1100
Subject: [Twisted-Python] minimal python version?
In-Reply-To: <Pine.LNX.4.44.0310251243440.25766-100000@klondike.cis.upenn.edu>
References: <20031024215137.GC832@radii> <Pine.LNX.4.44.0310251243440.25766-100000@klondike.cis.upenn.edu>
Message-ID: <20031025165729.GC32552@frobozz>

[please don't top-post!]

On Sat, Oct 25, 2003 at 12:45:22PM -0400, Yun Mao wrote:
> This may not be true..
> 
> $ python localsocks.py 
> Traceback (most recent call last):
>   File "localsocks.py", line 191, in ?
>     main()
>   File "localsocks.py", line 176, in main
>     config = Options()
>   File "twisted/python/usage.py", line 134, in __init__
>     (longOpt, shortOpt, docs, settings, synonyms, dispatch) = c()
>   File "twisted/python/usage.py", line 349, in _gather_handlers
>     dispatch[prettyName] = new.instancemethod(fn, self, self.__class__)
> TypeError: instancemethod() argument 3 must be class, not type
> 
> $ python
> Python 2.2 (#1, Apr 12 2002, 15:29:57)
> [GCC 2.96 20000731 (Red Hat Linux 7.2 2.96-109)] on linux2
> Type "help", "copyright", "credits" or "license" for more information.
> >>>
> 
> 
> I don't have this trouble when I use python 2.2.3.

Hmm... unless something has changed recently, our OS-X buildslave uses
2.2.0, and the tests are passing just fine on it:
    http://twistedmatrix.com/buildbot/

In fact, I recall a change to that exact line recently, and sure enough,
it's different in CVS -- I think if you try 1.1.0rc2 (which I believe will
be identical to 1.1.0 final), you'll find that bug is fixed.  If not, or if
you find any other problems, please file bug reports :)

-Andrew.




From pje at telecommunity.com  Sat Oct 25 11:44:02 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Sat, 25 Oct 2003 13:44:02 -0400
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <20031025162138.GB32552@frobozz>
References: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
 <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
Message-ID: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>

At 03:21 AM 10/26/03 +1100, Andrew Bennetts wrote:
>On Sat, Oct 25, 2003 at 10:07:42AM -0400, Phillip J. Eby wrote:
>
>     def clientConnectionFailed(self, connector, reason):
>         print "connection failed:", reason
>         reactor.stop()
>     ...
>
>Perhaps clientConnectionFailed is being triggered, instead of
>clientConnectionLost (which has no delay at all, as you can see)?  (The docs
>don't clearly say this, but ccF is called when there was no connection
>established, and ccL is called when a connection was made and then
>disconnected).

But shouldn't reactor.stop() cause the process to exit, rather than 
hang?  I'm running the logbot under daemontools, so if it exited, it should 
be restarted.  But that's not what I'm seeing.  Instead, the process just 
goes idle.




From bob at redivi.com  Sat Oct 25 13:37:47 2003
From: bob at redivi.com (Bob Ippolito)
Date: Sat, 25 Oct 2003 15:37:47 -0400
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
References: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com> <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com> <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
Message-ID: <B64BDA09-0722-11D8-9DA8-000A95686CD8@redivi.com>

On Oct 25, 2003, at 1:44 PM, Phillip J. Eby wrote:

> At 03:21 AM 10/26/03 +1100, Andrew Bennetts wrote:
>> On Sat, Oct 25, 2003 at 10:07:42AM -0400, Phillip J. Eby wrote:
>>
>>     def clientConnectionFailed(self, connector, reason):
>>         print "connection failed:", reason
>>         reactor.stop()
>>     ...
>>
>> Perhaps clientConnectionFailed is being triggered, instead of
>> clientConnectionLost (which has no delay at all, as you can see)?  
>> (The docs
>> don't clearly say this, but ccF is called when there was no connection
>> established, and ccL is called when a connection was made and then
>> disconnected).
>
> But shouldn't reactor.stop() cause the process to exit, rather than 
> hang?  I'm running the logbot under daemontools, so if it exited, it 
> should be restarted.  But that's not what I'm seeing.  Instead, the 
> process just goes idle.

I've seen reactor.stop() hang if there's threads happening.

-bob




From lists at webcrunchers.com  Sat Oct 25 15:28:31 2003
From: lists at webcrunchers.com (John D.)
Date: Sat, 25 Oct 2003 14:28:31 -0700
Subject: [Twisted-Python] Newbee needs help.
Message-ID: <v03110716bbc09a0ba21d@[192.168.0.3]>

I've downloaded Twisted Python,  and have spent considerable time trying to figure it out.   

Has anyone,  or is anyone planning to write up a tutorial?

In particular,  I want to know how to process web forms page elements using the
twisted web server code,   or some examples on how to do it.   

I suspect there might be tools already present that can do this,  and in normal Python,  there is the "cgi" module,  but not sure how I can use that module,  or even if it's possible to process forms page elements using this module,   or does it use some completely different approach?

Is there anyone out in the Twisted Python mailing list who's done this,  and would they care to share a few "bread crumbs" with someone who just hasn't "got it" yet?

If such a tutorial exists,  what's the URL?

John





From lafou at wanadoo.fr  Sun Oct 26 04:38:29 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sun, 26 Oct 2003 12:38:29 +0100
Subject: [Twisted-Python] Newbee needs help.
In-Reply-To: <v03110716bbc09a0ba21d@[192.168.0.3]>
References: <v03110716bbc09a0ba21d@[192.168.0.3]>
Message-ID: <1067168308.4901.1.camel@pcmarie>

On Sat, 2003-10-25 at 23:28, John D. wrote:
> I've downloaded Twisted Python,  and have spent considerable time trying to figure it out.   
> 
> Has anyone,  or is anyone planning to write up a tutorial?


www.twistedmatrix.com/howto

> In particular,  I want to know how to process web forms page elements using the
> twisted web server code,   or some examples on how to do it.   
> 
> I suspect there might be tools already present that can do this,  and in normal Python,  there is the "cgi" module,  but not sure how I can use that module,  or even if it's possible to process forms page elements using this module,   or does it use some completely different approach?
> 
> Is there anyone out in the Twisted Python mailing list who's done this,  and would they care to share a few "bread crumbs" with someone who just hasn't "got it" yet?
> 
> If such a tutorial exists,  what's the URL?

Btw, you should check twisted 1.1.0 RC2 DOC (in download section).




From matt at pollenation.net  Sun Oct 26 05:27:59 2003
From: matt at pollenation.net (Matt Goodall)
Date: Sun, 26 Oct 2003 12:27:59 +0000
Subject: [Twisted-Python] Newbee needs help.
In-Reply-To: <1067168308.4901.1.camel@pcmarie>
References: <v03110716bbc09a0ba21d@[192.168.0.3]> <1067168308.4901.1.camel@pcmarie>
Message-ID: <3F9BBDCF.8010807@pollenation.net>

Philippe Lafoucrière wrote:

>On Sat, 2003-10-25 at 23:28, John D. wrote:
>  
>
>>I've downloaded Twisted Python,  and have spent considerable time trying to figure it out.   
>>
>>Has anyone,  or is anyone planning to write up a tutorial?
>>    
>>
>
>
>www.twistedmatrix.com/howto
>  
>
http://twistedmatrix.com/documents/howto/ is the correct URL. There is a 
tutorial and a number of documents about Twisted's web supprort listed.

- Matt

-- 
Matt Goodall, Pollenation Internet Ltd
w: http://www.pollenation.net
e: matt at pollenation.net





From lafou at wanadoo.fr  Sun Oct 26 14:28:23 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sun, 26 Oct 2003 22:28:23 +0100
Subject: [Twisted-Python] Release notes
Message-ID: <1067203702.4876.5.camel@pcmarie>

Congratulations for the new 1.1.0, but the release notes are still
pointing to 1.0.7 notes.





From lafou at wanadoo.fr  Sun Oct 26 14:38:22 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Sun, 26 Oct 2003 22:38:22 +0100
Subject: [Twisted-Python] Directory Listing fonts
Message-ID: <1067204300.4901.11.camel@pcmarie>

Hi,


I just discovered the new Twisted Web Directory listing look. It looks
better, but why the fonts are so huge ? I mean, the <h1>Directory
listing for ...</h1> could have been a <h2>...</h2> ?

thx :)




From alexander.winston at comcast.net  Sun Oct 26 15:12:42 2003
From: alexander.winston at comcast.net (Alexander Winston)
Date: Sun, 26 Oct 2003 17:12:42 -0500
Subject: [Twisted-Python] Directory Listing fonts
In-Reply-To: <1067204300.4901.11.camel@pcmarie>
References: <1067204300.4901.11.camel@pcmarie>
Message-ID: <1067206362.22662.15.camel@drop>

On Sun, 2003-10-26 at 16:38, Philippe Lafoucrière wrote:
> I just discovered the new Twisted Web Directory listing look. It looks
> better, but why the fonts are so huge ? I mean, the <h1>Directory
> listing for ...</h1> could have been a <h2>...</h2> ?

The element <h1> is for top-level headings, so its use here is
justified. Modifying XHTML elements simply for display's sake should not
be done, for that is the job of Cascading Style Sheets.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20031026/1f3bd4ed/attachment.sig>

From scosol at yahoo.com  Sun Oct 26 15:49:01 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Sun, 26 Oct 2003 14:49:01 -0800 (PST)
Subject: [Twisted-Python] Release notes
In-Reply-To: <1067203702.4876.5.camel@pcmarie>
Message-ID: <20031026224901.63836.qmail@web13902.mail.yahoo.com>

Right-

And yes, theres a nice tutorial in the 1.10 docs :)

--- Philippe Lafoucri�re <lafou at wanadoo.fr> wrote:
> Congratulations for the new 1.1.0, but the release
> notes are still
> pointing to 1.0.7 notes.
> 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
>
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From likwoka at yahoo.com  Sun Oct 26 16:14:43 2003
From: likwoka at yahoo.com (Alex Li)
Date: Sun, 26 Oct 2003 15:14:43 -0800 (PST)
Subject: [Twisted-Python] questions on twisted web server
Message-ID: <20031026231443.20521.qmail@web13901.mail.yahoo.com>

Hi all,

1) I would like to rotate the logs for the web server.  How should I do that?
I have read the rotatinglog.py example, but I don't know how to intergrate that
into the web server script below...

2) How to turn off directory listing?  Am I doing the right way below?

3) I would like to use https for certain directories, but not the whole site.
How do I do that (probably with 2 server.Site instances... I need more clues)?
For example, if a user access the site through
http://localhost/secure, then he should be redirected to
https://localhost/secure

#--------------------------------------------------------------------------
from twisted.application import internet, service
from twisted.web import static, server, util, error
from OpenSSL import SSL

class ServerContextFactory:
    '''Loads a certificate from the file 'server.pem'.'''
    def getContext(self):
        ctx = SSL.Context(SSL.SSLv23_METHOD)
        ctx.use_certificate_file('/home/www/snakeoil-rsa.crt')
        ctx.use_privatekey_file('/home/www/snakeoil-rsa.key')
        return ctx


root = static.File('/home/www/production')
root.ignoreExt('.html')

# turn off directory listing
root.putChild('', error.ForbiddenResource())

site = server.Site(root, logPath='/home/www/access.log')
application = service.Application('web', uid=33, gid=33) #www-data
serviceCollection = service.IServiceCollection(application)

internet.TCPServer(82, site).setServiceParent(serviceCollection)
internet.SSLServer(443, site, ServerContextFactory()
                   ).setServiceParent(serviceCollection)


Thanks in advance,
Alex

__________________________________
Do you Yahoo!?
Exclusive Video Premiere - Britney Spears
http://launch.yahoo.com/promos/britneyspears/



From itamar at itamarst.org  Sun Oct 26 23:43:17 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 27 Oct 2003 01:43:17 -0500
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
References: <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
	<5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
	<5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
Message-ID: <20031027014317.7b58a1e9.itamar@itamarst.org>

On Sat, 25 Oct 2003 13:44:02 -0400
"Phillip J. Eby" <pje at telecommunity.com> wrote:

> But shouldn't reactor.stop() cause the process to exit, rather than 
> hang?  I'm running the logbot under daemontools, so if it exited, it
> should be restarted.  But that's not what I'm seeing.  Instead, the
> process just goes idle.

Nothing in the logs?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From kunger at intersight.com  Mon Oct 27 00:05:38 2003
From: kunger at intersight.com (Kevin Unger)
Date: Sun, 26 Oct 2003 23:05:38 -0800
Subject: [Twisted-Python] Picture_Pile broken?
Message-ID: <001101c39c58$ba6c4a20$0201a8c0@telecaster>

Hello Twisted Folk,

I just downloaded 1.1.0rc2 for Windows.  The link from the woven howto to
the source listings for the 'Picture_Pile' tutorial is broken.  The link (at
the bottom of the page) needs to have '.html' apended to the href.

I found the listings (only a single and broken link to the file
directory-listing4.html exists), and downloaded the files necessary to run
the first part of the tutorial:

          directory-listing.html
          image-display.html
          picturepile.py

      I try to start it using:

          python %TWISTED_HOME%\scripts\twistw.py -noy picturepile.py

      And all I get is an immediate return to the command prompt, no console
messages, and no server running.  I ran this just fine using the previous
twisted release, 1.0.7.

      Any clue?

      -k




From radix at twistedmatrix.com  Mon Oct 27 02:10:22 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 27 Oct 2003 04:10:22 -0500
Subject: [Twisted-Python] Picture_Pile broken?
In-Reply-To: <001101c39c58$ba6c4a20$0201a8c0@telecaster>
References: <001101c39c58$ba6c4a20$0201a8c0@telecaster>
Message-ID: <20031027091022.GB608@radii>

On Sun, Oct 26, 2003 at 11:05:38PM -0800, Kevin Unger wrote:
> 
> Hello Twisted Folk,
> 
> I just downloaded 1.1.0rc2 for Windows.  The link from the woven howto to
> the source listings for the 'Picture_Pile' tutorial is broken.  The link (at
> the bottom of the page) needs to have '.html' apended to the href.

I created a new issue for this:

http://www.twistedmatrix.com/bugs/issue370

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From andrew-twisted at puzzling.org  Mon Oct 27 04:32:19 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 27 Oct 2003 22:32:19 +1100
Subject: [Twisted-Python] Picture_Pile broken?
In-Reply-To: <20031027091022.GB608@radii>
References: <001101c39c58$ba6c4a20$0201a8c0@telecaster> <20031027091022.GB608@radii>
Message-ID: <20031027113219.GA21986@frobozz>

On Mon, Oct 27, 2003 at 04:10:22AM -0500, Christopher Armstrong wrote:
> On Sun, Oct 26, 2003 at 11:05:38PM -0800, Kevin Unger wrote:
> > 
> > Hello Twisted Folk,
> > 
> > I just downloaded 1.1.0rc2 for Windows.  The link from the woven howto to
> > the source listings for the 'Picture_Pile' tutorial is broken.  The link (at
> > the bottom of the page) needs to have '.html' apended to the href.
> 
> I created a new issue for this:
> 
> http://www.twistedmatrix.com/bugs/issue370

It's now fixed.

Kevin, thanks for the bug report! :)

-Andrew.




From lafou at wanadoo.fr  Mon Oct 27 04:36:45 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Mon, 27 Oct 2003 12:36:45 +0100
Subject: [Twisted-Python] Directory Listing fonts
In-Reply-To: <1067206362.22662.15.camel@drop>
References: <1067204300.4901.11.camel@pcmarie>
	 <1067206362.22662.15.camel@drop>
Message-ID: <1067254605.4870.3.camel@pcmarie>

> The element <h1> is for top-level headings, so its use here is
> justified. Modifying XHTML elements simply for display's sake should not
> be done, for that is the job of Cascading Style Sheets.

You're totally right. So, what about changing the css ?




From pje at telecommunity.com  Mon Oct 27 07:15:13 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Mon, 27 Oct 2003 09:15:13 -0500
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <20031027014317.7b58a1e9.itamar@itamarst.org>
References: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
 <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
 <5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
 <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
Message-ID: <5.1.0.14.0.20031027091418.02de4190@mail.telecommunity.com>

At 01:43 AM 10/27/03 -0500, Itamar Shtull-Trauring wrote:
>On Sat, 25 Oct 2003 13:44:02 -0400
>"Phillip J. Eby" <pje at telecommunity.com> wrote:
>
> > But shouldn't reactor.stop() cause the process to exit, rather than
> > hang?  I'm running the logbot under daemontools, so if it exited, it
> > should be restarted.  But that's not what I'm seeing.  Instead, the
> > process just goes idle.
>
>Nothing in the logs?

Um, what logs?




From vlupien at drummonddesigns.com  Mon Oct 27 07:17:08 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Mon, 27 Oct 2003 09:17:08 -0500
Subject: [Twisted-Python] authentification from a database
Message-ID: <000101c39c95$08eb89e0$687ba8c0@vicky>

I have a program that needs authentification from a database.  For now,
it's working fine but I'm using
checkers.InMemoryUsernamePasswordDatabaseDontUse(test="test") (I want
many users not only "test").   
 
Here's my code:
 
class RootPage(pages.BasePage):
    templateFile = "main.html"
    
    def initialize(self, dbpool=None):
        self.dbpool = dbpool
 
    def wchild_login(self, request):
        a=request.getComponent(simpleguard.Authenticated)
        if not request.getComponent(simpleguard.Authenticated):
            return InfiniChild(login.LoginPage())
        return Authenticated()
 
class Authenticated(page.Page):
    isLeaf = 1
    template='''<html><h1>Hello <span model="name"/>!</h1></html>'''
 
    def wmfactory_name(self, request):
        return request.getComponent(simpleguard.Authenticated).name
    
class IRedirectAfterLogin(components.Interface):
    """The URLPath to which we will redirect after successful login.
    """
 
class Here(resource.Resource):
    def render(self, request):
        existing =
request.getSession().getComponent(IRedirectAfterLogin, None)
        if existing is not None:
            request.redirect(str(existing))
            request.getSession().setComponent(IRedirectAfterLogin, None)
            return "<html></html>"
        else:
            return util.redirectTo('.', request)
        
def callback(model):
    return Here()
 
class FullURLRequest:
    def __init__(self, request):
        self.request = request
 
    def prePathURL(self):
        r = self.request
        prepath = r.prepath
        r.prepath = r.prepath + r.postpath
        rv = r.prePathURL()
        r.prepath = prepath
        return rv
    
class InfiniChild(resource.Resource):
    def __init__(self, r):
        resource.Resource.__init__(self)
        self.r = r
 
    def getChild(self, name, request):
        return self
 
    def render(self, request):
        request.getSession().setComponent(
            IRedirectAfterLogin,
            urlpath.URLPath.fromRequest(FullURLRequest(request))
            )
        return self.r.render(request)
    
def createResource():
    dbpool = database.DataBase().getConnection()
    return simpleguard.guardResource(
        RootPage(dbpool=dbpool),
 
[checkers.InMemoryUsernamePasswordDatabaseDontUse(vicky="lupien")],
        callback=callback)    
 
 
 
#In an other module:
 
class LoginPage(pages.BasePage):
    templateFile = "login.html"
    
    def initialize(self):
        self.title = "Login"
   
    def wmfactory_title(self, request):
        return self.title
            
    def wchild_index(self, request):
        return self
    
    def wvupdate_loginform(self, request, widget, model):
        root = request.getRootURL()
        if root is None:
            root=request.prePathURL()
        url = urlpath.URLPath.fromString(root)
        lmx(widget.node).form(
            action=str(url.sibling(guard.INIT_PERSPECTIVE)),
            model="form")
 
    def wmfactory_form(self, request):
        return guard.newLoginSignature.method(None)
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031027/dbc4bd92/attachment.html>

From itamar at itamarst.org  Mon Oct 27 07:29:29 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 27 Oct 2003 09:29:29 -0500
Subject: [Twisted-Python] Odd behavior in IRC logbot
In-Reply-To: <5.1.0.14.0.20031027091418.02de4190@mail.telecommunity.com>
References: <5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
	<5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
	<5.1.0.14.0.20031025100503.01f31ae0@mail.telecommunity.com>
	<5.1.0.14.0.20031025134218.03d36270@mail.telecommunity.com>
	<5.1.0.14.0.20031027091418.02de4190@mail.telecommunity.com>
Message-ID: <20031027092929.282f6cf4.itamar@itamarst.org>

On Mon, 27 Oct 2003 09:15:13 -0500
"Phillip J. Eby" <pje at telecommunity.com> wrote:

> Um, what logs?

Hm. I suppose you ought to enable logging, yes. Do:

from twisted.python import log
log.startLogging(open("irc.log", "a"))

somewhere in the file (e.g. in the __main__-only section).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Mon Oct 27 09:00:47 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Mon, 27 Oct 2003 11:00:47 -0500
Subject: [Twisted-Python] authentification from a database
In-Reply-To: <000101c39c95$08eb89e0$687ba8c0@vicky>
References: <000101c39c95$08eb89e0$687ba8c0@vicky>
Message-ID: <20031027160047.GA11812@intarweb.us>

On Mon, Oct 27, 2003 at 09:17:08AM -0500, vicky lupien wrote:
> I have a program that needs authentification from a database.  For now,
> it's working fine but I'm using
> checkers.InMemoryUsernamePasswordDatabaseDontUse(test="test") (I want
> many users not only "test").   

  Use a different checker, such as FilePasswordDB.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031027/91a4a4e9/attachment.sig>

From itamar at itamarst.org  Mon Oct 27 10:13:44 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 27 Oct 2003 12:13:44 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
Message-ID: <20031027121344.31daf5e9.itamar@itamarst.org>

What's New in 1.1.0
===================

- twisted.application, an updated deployment and configuration library.

- Mac OS X GUI event loop integration (requires PyObjC).

- New howtos, including a tutorial, and more web framework docs. 

- The documentation is now better organized, up-to-date with the latest
APIs, and in some areas much more extensive.

- Removed a number of broken, unmaintained and unused packages and
modules.

- Bug fixes and feature enhancements.



From lafou at wanadoo.fr  Mon Oct 27 10:56:04 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Mon, 27 Oct 2003 18:56:04 +0100
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
	internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <1067277364.4870.0.camel@pcmarie>

Great work guys ! twisted is the python/network killer app

On Mon, 2003-10-27 at 18:13, Itamar Shtull-Trauring wrote:
> What's New in 1.1.0
> ===================
> 
> - twisted.application, an updated deployment and configuration library.
> 
> - Mac OS X GUI event loop integration (requires PyObjC).
> 
> - New howtos, including a tutorial, and more web framework docs. 
> 
> - The documentation is now better organized, up-to-date with the latest
> APIs, and in some areas much more extensive.
> 
> - Removed a number of broken, unmaintained and unused packages and
> modules.
> 
> - Bug fixes and feature enhancements.
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From duke99 at email.ro  Mon Oct 27 11:57:21 2003
From: duke99 at email.ro (soso)
Date: Mon, 27 Oct 2003 20:57:21 +0200
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
Message-ID: <200310271857.h9RIvL429365@zerg.codec.ro>

Thanks for the great work!

But I can't find the windows installer. Or there isn't a windows installer for 1.1?

soso


______________________________________________________________________
Do you want a free e-mail for life ? Get it at http://www.email.ro/




From matteo.giacomazzi at libero.it  Mon Oct 27 12:36:21 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Mon, 27 Oct 2003 20:36:21 +0100
Subject: [Twisted-Python] Post data
Message-ID: <7119444031.20031027203621@libero.it>

Hi all,

  I need to query a remote HTTP server using POST method.
  To achieve this, I use the t.w.c.getPage function.
  In  order  to  post  some  data, I pass to that function the keyword
  postdata  bound  to  an urllib.urlencode()-d dictionary but it seems
  that such data is not sent at all.

  What is wrong?
  Here  is  a  minimal  example:  the url is a PHP scripts that simply
  dumps  the  content  of  the  $_POST  variable,  but  it is an empty
  array...

  Any help would be greatly appreciated!

#=============================================
from twisted.web.client import getPage
from twisted.internet import reactor
import urllib

def printData(data):
    print data
    reactor.stop()

payload = urllib.urlencode({'test':'the test'})
url = 'http://www.hotelsprovider.com/~matteo'
d = getPage(url, postdata=payload, timeout=5)
d.addCallback(printData)
reactor.run()
#=============================================
  
  Many thanks in advance!
  

Kind regards
 Matteo




From matteo.giacomazzi at libero.it  Mon Oct 27 12:47:13 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Mon, 27 Oct 2003 20:47:13 +0100
Subject: [Twisted-Python] Re: Post data
In-Reply-To: <7119444031.20031027203621@libero.it>
References: <7119444031.20031027203621@libero.it>
Message-ID: <18520096296.20031027204713@libero.it>

UPDATE:  I  forgot  to  use  the  method='POST'  keyword param, but no
results yet...

#==========================================================
from twisted.web.client import getPage
from twisted.internet import reactor
import urllib

def printData(data):
    print data
    reactor.stop()

payload = urllib.urlencode({'test':'the test'})
url = 'http://www.hotelsprovider.com/~matteo'
d = getPage(url, method='POST', postdata=payload, timeout=5)
d.addCallback(printData)
reactor.run()
#==========================================================

Many thanks in advance!
  

Kind regards
 Matteo




From Martin.Moellenbeck at t-online.de  Mon Oct 27 13:28:17 2003
From: Martin.Moellenbeck at t-online.de (=?ISO-8859-1?Q?Martin_M=F6llenbeck?=)
Date: Mon, 27 Oct 2003 21:28:17 +0100
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <3F9D7FE1.4060204@t-online.de>

very cool framework and you all have made a very good work.

regards Martin

Itamar Shtull-Trauring wrote:

>What's New in 1.1.0
>===================
>
>- twisted.application, an updated deployment and configuration library.
>
>- Mac OS X GUI event loop integration (requires PyObjC).
>
>- New howtos, including a tutorial, and more web framework docs. 
>
>- The documentation is now better organized, up-to-date with the latest
>APIs, and in some areas much more extensive.
>
>- Removed a number of broken, unmaintained and unused packages and
>modules.
>
>- Bug fixes and feature enhancements.
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>  
>





From abe at fettig.net  Mon Oct 27 14:46:36 2003
From: abe at fettig.net (Abe Fettig)
Date: Mon, 27 Oct 2003 16:46:36 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <3F9D923C.70701@fettig.net>

Looks like a great release... and it even has updated woven docs! 
Thanks for all the work you guys have put into Twisted!

Abe

Itamar Shtull-Trauring wrote:
> What's New in 1.1.0





From developer at csrules.dyndns.org  Mon Oct 27 15:08:30 2003
From: developer at csrules.dyndns.org (darryl)
Date: Mon, 27 Oct 2003 16:08:30 -0600 (CST)
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <3F9D923C.70701@fettig.net>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
        <3F9D923C.70701@fettig.net>
Message-ID: <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>


> Looks like a great release... and it even has updated woven docs!

The question is, does anyone want to focus on learing woven with NEW woven
in the works?

-darryl





From glyph at twistedmatrix.com  Mon Oct 27 15:13:35 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Mon, 27 Oct 2003 17:13:35 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>
References: <20031027121344.31daf5e9.itamar@itamarst.org>        <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>
Message-ID: <3F9D988F.2060703@twistedmatrix.com>

darryl wrote:

>>Looks like a great release... and it even has updated woven docs!

> The question is, does anyone want to focus on learing woven with NEW woven
> in the works?

An unfortunate last-minute change of direction, but worth it considering 
how vastly improved the new code is.

It's no longer a part of Twisted, however.  Check out Quotient CVS - 
www.divmod.org




From developer at csrules.dyndns.org  Mon Oct 27 15:23:26 2003
From: developer at csrules.dyndns.org (darryl)
Date: Mon, 27 Oct 2003 16:23:26 -0600 (CST)
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <3F9D988F.2060703@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
        <3F9D923C.70701@fettig.net>
        <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>
        <3F9D988F.2060703@twistedmatrix.com>
Message-ID: <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca>

>> The question is, does anyone want to focus on learing woven with NEW
>> woven in the works?
>
> An unfortunate last-minute change of direction, but worth it considering
>  how vastly improved the new code is.
>
> It's no longer a part of Twisted, however.  Check out Quotient CVS -
> www.divmod.org

May i ask why it's not part of twisted?
And if that's the case will Woven be maintained?

-Darryl





From dp at twistedmatrix.com  Mon Oct 27 15:56:08 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Mon, 27 Oct 2003 17:56:08 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca>
References: <20031027121344.31daf5e9.itamar@itamarst.org> <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com> <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca>
Message-ID: <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 27, 2003, at 5:23 PM, darryl wrote:

>
>>> The question is, does anyone want to focus on learing woven with NEW
>>> woven in the works?

Woven is certainly very usable in it's current state -- if you want to 
do simple-to-moderate things quickly, it can be very useful. However, 
it's complexity made it difficult to do some of the more ambitious 
things we are trying to do, such as semi-transparent form handling, and 
serverToClient events. But there are a few people who have built (and 
deployed) fairly complex woven applications. The fact that nevow exists 
doesn't detract from that.

nevow was originally a research project -- a weekend's worth of hacking 
whose benefits turned out to be so great that we decided to focus on 
bringing it up to a usable state for Quotient as soon as possible. And 
that's where it is now.

Most of the woven concepts -- template and code abstraction using a 
DOM, reusable partial page renderers (Widgets in old woven, renderer 
callables in nevow), all of the concepts needed to know to use 
twisted.web -- carry over to nevow. The only thing that's really 
changed in nevow is a few names, and the code is VASTLY simplified, 
well tested, and thus far easier to understand, design semantics for, 
and change.

>> An unfortunate last-minute change of direction, but worth it 
>> considering
>>  how vastly improved the new code is.
>>
>> It's no longer a part of Twisted, however.  Check out Quotient CVS -
>> www.divmod.org
>
> May i ask why it's not part of twisted?
> And if that's the case will Woven be maintained?

nevow will be moved into twisted after a period of 
stabilization/development in Quotient. Since twisted is a large project 
with many external developers using it, and quotient is a smaller 
project that is mostly a small core team of development, we felt it 
made sense to keep it out of twisted proper until the development had 
stabilized. Since nevow has the benefit of being a complete rewrite of 
all the *best* parts of woven, and none of the bad, stabilization has 
been remarkably quick. So expect to see nevow in twisted fairly soon.

In the meantime, woven will continue to be maintained with bugfixes, 
and nevow is fully usable outside of quotient -- even to the point of 
being fully usable without twisted.web (as a cgi, or in zope or 
webware, for example). I should also mention that there will probably 
be a compatibility layer for nevow to render old-style Woven classes 
sometime in the future. It is amazingly simple to add rendering 
functionality to it since it uses components to render the dom (which 
is really just a list of any python objects)

If you are doing any new development, I highly encourage you to take a 
look at nevow, if for no other reason than you can have a hand in 
shaping it's development. I would very much appreciate feedback about 
it, especially now, since the code is very, very short and readable.

dp




From fog at initd.org  Mon Oct 27 16:07:32 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Tue, 28 Oct 2003 00:07:32 +0100
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
	internet
In-Reply-To: <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org>
	 <3F9D923C.70701@fettig.net>
	 <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca>
	 <3F9D988F.2060703@twistedmatrix.com>
	 <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca>
	 <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>
Message-ID: <1067296052.1197.29.camel@localhost>

Il lun, 2003-10-27 alle 23:56, Donovan Preston ha scritto:
> On Oct 27, 2003, at 5:23 PM, darryl wrote:
> 
> >
> >>> The question is, does anyone want to focus on learing woven with NEW
> >>> woven in the works?
> 
> Woven is certainly very usable in it's current state -- if you want to 

after using it in a real life project i disagree. woven has lots of
problems that surface when you switch from "simple examples" to
"moderate real-life use cases". i was about to write a lenghty mail
about that shortcomings (like control not updating the model and needing
a "name" attribute in the node even it they don't use it, etc.) but then
two people told me about nevow in irc. looking at it right now.

> nevow was originally a research project -- a weekend's worth of hacking 
> whose benefits turned out to be so great that we decided to focus on 
> bringing it up to a usable state for Quotient as soon as possible. And 
> that's where it is now.

"we", "we". maybe i talked with you in irc.

> Most of the woven concepts -- template and code abstraction using a 
> DOM, reusable partial page renderers (Widgets in old woven, renderer 
> callables in nevow), all of the concepts needed to know to use 
> twisted.web -- carry over to nevow. The only thing that's really 
> changed in nevow is a few names, and the code is VASTLY simplified, 
> well tested, and thus far easier to understand, design semantics for, 
> and change.

KUDOS! :)

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
             Quis custodiet ipsos custodes? -- Juvenal, Satires, VI, 347
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio è firmata
URL: </pipermail/twisted-python/attachments/20031028/83d7855a/attachment.sig>

From maoy at cis.upenn.edu  Mon Oct 27 16:09:49 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Mon, 27 Oct 2003 18:09:49 -0500 (EST)
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0310271809290.17111-100000@klondike.cis.upenn.edu>

I really like the tutorial. Great work!

Yun


On Mon, 27 Oct 2003, Itamar Shtull-Trauring wrote:

> What's New in 1.1.0
> ===================
> 
> - twisted.application, an updated deployment and configuration library.
> 
> - Mac OS X GUI event loop integration (requires PyObjC).
> 
> - New howtos, including a tutorial, and more web framework docs. 
> 
> - The documentation is now better organized, up-to-date with the latest
> APIs, and in some areas much more extensive.
> 
> - Removed a number of broken, unmaintained and unused packages and
> modules.
> 
> - Bug fixes and feature enhancements.
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 




From matthew.s.hegedus at lmco.com  Mon Oct 27 13:02:23 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Mon, 27 Oct 2003 14:02:23 -0600
Subject: [Twisted-Python] Problem using LivePage/javascripts/event handlers
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F2@EMSS07M12.us.lmco.com>

I'm a relative noob to Twisted and Woven, but I'm trying to use them to
serve some dynamic web content without success. There's two spots that I am
most interested in:

When I include <span view="webConduitGlue" /> in my xhtml file, the browser
will spin its wheels forever. A big empty box is displayed at the bottom of
the browser window and the browser status displays Transferring data from
<myIP:port> ... . This behavior is consistent on Mozilla (I'm on Red Hat
Linux OS) and on the latest Netscape (7.1). I checked to make sure
javascript options were turned on in Netscape. Here is the Code:

Xhtml file:

<html>
    <head>
        <title>generic</title>
    </head>
    <body>
        <table model="listdata" view="listdatatable"></table>
        <span view="webConduitGlue" />
    </body>
</html>

Key Python/Twisted code:

class Epage(page.LivePage):
     ...
     def initialize(...):
         self.someListData = [['a', 'b', 'c'],
                                        ['d', 'e', 'f'],
                                        ['g', 'h', 'I']]

     def wmfactory_listdata(self, request):
         return self.someListData

     def wvupdate_listdatatable(self, request, node, listdata):
         l = lmx(node)
         d = l.div()
         t = d.table(border='0', cellspacing='2')
         t.tr(bgcolor='eeeeee')
         for arow in listdata:
             t.tr()
             for entry in arow:
                 t.td().text(entry)
             t.td().form().input(type='button', value='REMOVE',
view='rmExercise')

    def wvupdate_rmExercise(controller.Controller):
        def initialize(self):
            self.view.addEventHandler("onclick", self.onClick)
            self.view.addEventHandler("onmouseover", self.onMouseOver)

        def onClick(self, request, widget):
            print self, "CLICKED!"

        def onMouseOver(self, request, widget, argument):
            print self, "MOUSE OVER!", argument

The browser will draw me a table with buttons, but these events don't seem
to get processed. So that brings me to the second trouble spot I am
interested in. For those who know, am I embedding buttons in my table in an
acceptable manner? Am I trying to handle events correctly? If the xhtml
webConduitGlue was working would my event handling work? Please feel free to
criticize any part of this code. Thanks,

Matthew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031027/ac125458/attachment.html>

From mmoellenbeck at plus.de  Mon Oct 27 17:00:27 2003
From: mmoellenbeck at plus.de (mmoellenbeck at plus.de)
Date: Tue, 28 Oct 2003 01:00:27 +0100
Subject: [Twisted-Python] Martin Moellenbeck/PLUS/MHM/TUG/DE ist =?iso-8859-1?Q?au=DFer_Haus=2E?=
Message-ID: <OF09F48F40.82FAE4CF-ONC1256DCD.00000AE1-C1256DCD.00000AE1@uz.tengelmann.de>

Ich werde ab  27.10.2003 nicht im Büro sein. Ich kehre zurück am
09.11.2003.

Ich werde Ihre Nachricht nach meiner Rückkehr beantworten.

In dringenden Fällen richten Sie sich bitte an Herrn Kimpenhaus oder Herrn
Albring.




From matthew.s.hegedus at lmco.com  Mon Oct 27 14:40:19 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Mon, 27 Oct 2003 15:40:19 -0600
Subject: [Twisted-Python] Problems with LivePage
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F3@EMSS07M12.us.lmco.com>

I incorrectly retyped code. Please forgive. Here is a better look...

Xhtml file:

<html>
    <head>
        <title>generic</title>
    </head>
    <body>
        <table model="listdata" view="listdatatable"></table>
        <span view="webConduitGlue" />
    </body>
</html>

Key Python/Twisted code:

class Epage(page.LivePage):
     ...
     def initialize(...):
         self.someListData = [['a', 'b', 'c'],
                                        ['d', 'e', 'f'],
                                        ['g', 'h', 'I']]

     def wmfactory_listdata(self, request):
         return self.someListData

     def wvupdate_listdatatable(self, request, node, listdata):
         l = lmx(node)
         d = l.div()
         t = d.table(border='0', cellspacing='2')
         t.tr(bgcolor='eeeeee')
         for arow in listdata:
             t.tr()
             for entry in arow:
                 t.td().text(entry)
             t.td().form().input(type='button', value='REMOVE',
view='rmExercise')

    def wvupdate_rmExercise():
        return RmExerciseEventHandler(self)

class RmExerciseEventHandler(controller.Controller)
        def initialize(self):
            self.view.addEventHandler("onclick", self.onClick)
            self.view.addEventHandler("onmouseover", self.onMouseOver)

        def onClick(self, request, widget):
            print self, "CLICKED!"

        def onMouseOver(self, request, widget, argument):
            print self, "MOUSE OVER!", argument

As a recap, I was having trouble with my browser handling <span
view="webConduitGlue" /> in my xhtml file, and I was having trouble
processing events when I click on buttons embedded inside of a table (or
just buttons in general). Anyone see anything wrong? Sorry for the extra
email traffic and inbox congestion.

Matthew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031027/e448307e/attachment.html>

From scosol at yahoo.com  Mon Oct 27 18:05:15 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Mon, 27 Oct 2003 17:05:15 -0800 (PST)
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <Pine.LNX.4.44.0310271809290.17111-100000@klondike.cis.upenn.edu>
Message-ID: <20031028010515.3304.qmail@web13902.mail.yahoo.com>

I second that-

If you recall, I was the guy asking about simple DB
access/web-app stuff.

Just thought I'd let you all know that I've decided to
go with Twisted as part of a new fully HA financials
and banking system.
While I'm not *totally* confident in Twisted's
maturity for something like this, my needs are small
enough that any obvious problems should pop up rather
quickly. (and to be frank, it can be quickly and
easily replaced with PERL if need be)

So- assuming things go as planned, you will in the
near future have some very-heavy-iron Twisted users :)

Cheers- 

--- Yun Mao <maoy at cis.upenn.edu> wrote:
> I really like the tutorial. Great work!
> 
> Yun
> 
> 
> On Mon, 27 Oct 2003, Itamar Shtull-Trauring wrote:
> 
> > What's New in 1.1.0
> > ===================
> > 
> > - twisted.application, an updated deployment and
> configuration library.
> > 
> > - Mac OS X GUI event loop integration (requires
> PyObjC).
> > 
> > - New howtos, including a tutorial, and more web
> framework docs. 
> > 
> > - The documentation is now better organized,
> up-to-date with the latest
> > APIs, and in some areas much more extensive.
> > 
> > - Removed a number of broken, unmaintained and
> unused packages and
> > modules.
> > 
> > - Bug fixes and feature enhancements.
> > 
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> >
>
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> > 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
>
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From abe at fettig.net  Mon Oct 27 19:17:16 2003
From: abe at fettig.net (Abe Fettig)
Date: Mon, 27 Oct 2003 21:17:16 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <3F9D988F.2060703@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org>        <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com>
Message-ID: <3F9DD1AC.6000602@fettig.net>

Glyph Lefkowitz wrote:
> darryl wrote:

>> The question is, does anyone want to focus on learing woven with NEW 
>> woven
>> in the works?
> 
> An unfortunate last-minute change of direction, but worth it considering 
> how vastly improved the new code is.
> 
> It's no longer a part of Twisted, however.  Check out Quotient CVS - 
> www.divmod.org

Whoah!  Hold on a second.  Do you mean that _Woven_ is no longer part of 
Twisted, or that nevow/New Woven is longer part of Twisted?  Assuming 
that Woven will continue as part of Twisted, will it still be 
maintained?  Or is Woven dead as far as future improvements go?

I made the choice to buy into Woven a while back [1] and I'm just 
wrapping up a complete port of Hep's web interface to Woven, so it would 
be disappointing to find out that using Woven is no longer the Twisted 
Way, or that most of the developer energy is now going to be focused 
somewhere else.  Can you give me a better idea of the relationship 
between Woven and nevow, and a general idea of where both of them are 
headed?  I'd like to be able to make an educated decision about whether 
it's worth it to continue to invest my time working with Woven.

Thanks,
Abe

[1] http://twistedmatrix.com/pipermail/twisted-python/2003-June/004480.html




From stuart.hungerford at anu.edu.au  Mon Oct 27 20:02:59 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Tue, 28 Oct 2003 14:02:59 +1100
Subject: [Twisted-Python] Integrating simpleguard with existing Woven pages...
Message-ID: <6.0.0.22.0.20031028125753.01e1ff08@anusf.anu.edu.au>

Hi all,

I have a twisted.web based application that renders a number
of HTML pages via a set of Woven classes (inheriting from
twisted.web.woven.page.Page).

I need to add a simple username/password authentication to
some, but not all of these pages.  With the correct username
and password you can view the page, without them you can't view
it.

I understand that for this very simple level of authentication
that simpleguard is probably more appropriate than a full cred
based approach?

The examples simpleguardex.py and simpleguardex2.py rely on
using the render() method of resource subclasses to respond
to authentication issues, but I was looking for an example
of adding simpleguard to Woven pages with existing models,
views, templates etc.

Can anyone offer an example of this Woven/simpleguard use?






Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From radix at twistedmatrix.com  Mon Oct 27 19:32:19 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 27 Oct 2003 21:32:19 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <3F9DD1AC.6000602@fettig.net>
References: <20031027121344.31daf5e9.itamar@itamarst.org> <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com> <3F9DD1AC.6000602@fettig.net>
Message-ID: <20031028023219.GA8062@twistedmatrix.com>

On Mon, Oct 27, 2003 at 09:17:16PM -0500, Abe Fettig wrote:
> Glyph Lefkowitz wrote:
> >It's no longer a part of Twisted, however.  Check out Quotient CVS - 
> >www.divmod.org
> 
> Whoah!  Hold on a second.  Do you mean that _Woven_ is no longer part of 
> Twisted, or that nevow/New Woven is longer part of Twisted?  Assuming 
> that Woven will continue as part of Twisted, will it still be 
> maintained?  Or is Woven dead as far as future improvements go?

See Donovan's response.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From jeethur at sancharnet.in  Mon Oct 27 21:59:04 2003
From: jeethur at sancharnet.in (Jeethu Rao)
Date: Tue, 28 Oct 2003 10:29:04 +0530
Subject: [Twisted-Python] ANN: Twisted 1.1.0,
 the framework of *your* internet
In-Reply-To: <20031027121344.31daf5e9.itamar@itamarst.org>
Message-ID: <000e01c39d10$374df7c0$7090013d@thilakraj>

Thanks for the excellent documentation on Cred.
I promise to ask fewer questions from now on ;)

Jeethu Rao

> -----Original Message-----
> From: twisted-python-admin at twistedmatrix.com
> [mailto:twisted-python-admin at twistedmatrix.com] On Behalf Of 
> Itamar Shtull-Trauring
> Sent: Monday, October 27, 2003 10:44 PM
> To: twisted-python at twistedmatrix.com
> Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework 
> of *your* internet
> 
> 
> What's New in 1.1.0
> ===================
[Snip]




From nico at tekNico.net  Mon Oct 27 23:41:55 2003
From: nico at tekNico.net (Nicola Larosa)
Date: Tue, 28 Oct 2003 07:41:55 +0100
Subject: [Twisted-Python] Re: ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org> <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com> <18148.209.5.247.105.1067293406.squirrel@home.vandorp.ca> <C058520A-08D0-11D8-9397-000A95864FC4@twistedmatrix.com>
Message-ID: <3F9E0FB3.60700@tekNico.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> If you are doing any new development, I highly encourage you to take a
> look at nevow, if for no other reason than you can have a hand in
> shaping it's development. I would very much appreciate feedback about
> it, especially now, since the code is very, very short and readable.

Will do. A little doc would help starting up, though. :^)


- --
"I worry about my child and the Internet all the time, even though she's
too young to have logged on yet. Here's what I worry about. I worry that
10 or 15 years from now, she will come to me and say 'Daddy, where were
you when they took freedom of the press away from the Internet?'"
 -- Mike Godwin, Electronic Frontier Foundation

Nicola Larosa - nico at tekNico.net


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (GNU/Linux)

iD8DBQE/ng+yXv0hgDImBm4RAsu1AJ9mZ8p6EaTfSWegKZacWba30bNPBQCeIS7F
/pGTQsfPkj0aw7zENmr8KzU=
=8rSk
-----END PGP SIGNATURE-----




From matteo.giacomazzi at libero.it  Tue Oct 28 01:42:13 2003
From: matteo.giacomazzi at libero.it (Matteo Giacomazzi)
Date: Tue, 28 Oct 2003 09:42:13 +0100
Subject: [Twisted-Python] Re: Post data
In-Reply-To: <18520096296.20031027204713@libero.it>
References: <7119444031.20031027203621@libero.it>
 <18520096296.20031027204713@libero.it>
Message-ID: <74053078.20031028094213@libero.it>

Hi all,

> UPDATE:  I  forgot  to  use  the method='POST' keyword param, but no
> results yet...

...and  I  finally  found  the  problem:  I have to insert the correct
'Content-type'  header in order to let PHP (and maybe ASP too) see the
POST data as a dictionary of keys and values.

Kind regards
 Matteo




From andrew-twisted at puzzling.org  Tue Oct 28 02:57:44 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 28 Oct 2003 20:57:44 +1100
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <20031028010515.3304.qmail@web13902.mail.yahoo.com>
References: <Pine.LNX.4.44.0310271809290.17111-100000@klondike.cis.upenn.edu> <20031028010515.3304.qmail@web13902.mail.yahoo.com>
Message-ID: <20031028095744.GA1069@frobozz>

On Mon, Oct 27, 2003 at 05:05:15PM -0800, Nathan Seven wrote:
> 
> So- assuming things go as planned, you will in the
> near future have some very-heavy-iron Twisted users :)

If things do go well, we'd love for you to add to our collection of success
stories:
    http://twistedmatrix.com/services/success

:)

-Andrew.




From v6kk1hg02 at sneakemail.com  Mon Oct 27 08:06:24 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 27 Oct 2003 15:06:24 -0000
Subject: [Twisted-Python] Re: Compile failure in 1.1.0rc1 Windows
Message-ID: <9628-70170@sneakemail.com>



> Errors display, yes, but in latest versions of Twisted it just means
> these specific C modules won't build. They are all optional. In other
> words, just ignore it.

Well, that's not a good answer (but thanks for it anyway!).
I mean the errors don't just display, they stop the entire
distutils process - it halts right at the error, and installation
does not complete.  So that is a BUG, clean and simple.

Anyway to the main point - why is this custom header being
used; or if it is not custom, why is it used in a custom
location?  All you need to do is fix that, and it would
work fine.  Someone needs to look at his header directory
structure and compare it against the standard one(s).  It's
just a config issue, and a simple one to fix.

I'd also like to plug Digital Mars C++, which is very compatible
with Microsoft Visual C++ (e.g. makefiles and such) but FREE and
superior from every angle -   http://www.DigitalMars.com
(No, I am not using it in this thread at all, just MSVC6sp5.)

If it were up to me, all of Python and all Python projects would
use DMC for Windows ports.  DMC used to be Symantec C++, now
in private (and better) hands - the original author's.  Blazing
fast speed, highly optimized output, advanced C++ features,
awesome technical support.  Blows MS tools out of the sky.
Shame that open source projects haven't caught on yet.  Oh yes,
it works with the MS Windows SDK, and handles inline assembly.

Thanks again for the wonderful TM lib,

Mark



From v6kk1hg02 at sneakemail.com  Mon Oct 27 10:41:10 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 27 Oct 2003 17:41:10 -0000
Subject: [Twisted-Python] Telnet Client as Line Receiver?
Message-ID: <25325-94083@sneakemail.com>


I need advice on telnet.  What is the current recommended best
practice for writing a telnet client?

According to the documentation on Class LineReceiver, it is
"A protocol that receives lines and/or raw data, depending on mode."

This statement pretty much covers telnet, which is basically
line-oriented terminal stuff (actually older than the internet itself).
Yet the current 1.1.0 telnet code seems weirdly scattered across TM:

* There is no class relationship to LineReceiver.
* There exists a telnet server class ("Shell") but no symmetric
  telnet client class exists anywhere.  Other TM protocols offer both.
* Some of the telnet code is stuck in the (deprecated?) manhole modules.

For testing only I got the Shell subclass working, but my real need is
a telnet client that can talk to embedded devices over Ethernet.

Advice? Should I multiply inherit from LineReceiver and Telnet?
Should I subclass Shell and pervert its server functionality into
client functionality?

Since I have to do this work anyway, I would be willing to help with
any necessary changes to the Twisted library.  Tell me what needs doing,
and I will do it, to the extent that it overlaps with my work requirements.
The telnet code looks like it's in transition or maybe stale.

Mark
Telnet spec reference,
http://mars.netanya.ac.il/~unesco/cdrom/booklet/HTML/NETWORKING/node300.html



From v6kk1hg02 at sneakemail.com  Mon Oct 27 13:41:11 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 27 Oct 2003 20:41:11 -0000
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
Message-ID: <15594-31581@sneakemail.com>

More curiosity:

* What is the preferred mechanism for local echo
of characters on the client side?  Presumably
TM has hooks for such things, with all its event
handling capabilities.

* The Shell class lives in telnet.py and the Telnet
superclass lives in a file with the same name.
I suggest a file name change here, maybe telnet_shell.py.

* The factoring between Telnet class and Shell doesn't
seem clean, on initial impression.  Telnet is already
halfway towards a server-only functionality, all of
which should be factored into Shell.  The Telnet protocol
class should be agnostic between server and client
usage.



From gerritvd at decillion.net  Tue Oct 28 03:56:06 2003
From: gerritvd at decillion.net (Gerrit van Dyk)
Date: Tue, 28 Oct 2003 12:56:06 +0200
Subject: [Twisted-Python] Twisted and Zope
Message-ID: <bnlhoj$4gc$1@sea.gmane.org>

Hi all,

I am trying to integrate Twisted and Zope. I saw a project on Sourceforge
called twistedzope, but for some reason I cannot get anonymous cvs access
to this product. Can somebody email the product to me (where can I find it
except through anonymous cvs access), or am I wasting my time in looking at
this.

Regards
Gerrit van Dyk




From radix at twistedmatrix.com  Tue Oct 28 04:30:50 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 28 Oct 2003 06:30:50 -0500
Subject: [Twisted-Python] Twisted and Zope
In-Reply-To: <bnlhoj$4gc$1@sea.gmane.org>
References: <bnlhoj$4gc$1@sea.gmane.org>
Message-ID: <20031028113050.GA868@radii>

On Tue, Oct 28, 2003 at 12:56:06PM +0200, Gerrit van Dyk wrote:
> Hi all,
> 
> I am trying to integrate Twisted and Zope. I saw a project on Sourceforge
> called twistedzope, but for some reason I cannot get anonymous cvs access
> to this product. Can somebody email the product to me (where can I find it
> except through anonymous cvs access), or am I wasting my time in looking at
> this.

You're wasting your time::

file releases: This Project Has Not Released Any Files

CVS: CVS Repository ( 0 commits, 0 adds )

And, their web site @ twistedzope.sf.net: nothing

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From radix at twistedmatrix.com  Tue Oct 28 04:34:47 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 28 Oct 2003 06:34:47 -0500
Subject: [Twisted-Python] Telnet Client as Line Receiver?
In-Reply-To: <25325-94083@sneakemail.com>
References: <25325-94083@sneakemail.com>
Message-ID: <20031028113447.GB868@radii>

On Mon, Oct 27, 2003 at 05:41:10PM -0000, Mark Evans wrote:
> Advice? Should I multiply inherit from LineReceiver and Telnet?
> Should I subclass Shell and pervert its server functionality into
> client functionality?

There is no Telnet client protocol implementation. What I recommend
doing is refactoring the "Telnet" server protocol into a superclass
(or some other usable unit of code) that can be used by both server
and client implementations; modifying Telnet class to use it, and
implementing a new Telnet client class.

> Since I have to do this work anyway, I would be willing to help with
> any necessary changes to the Twisted library.  Tell me what needs doing,
> and I will do it, to the extent that it overlaps with my work requirements.
> The telnet code looks like it's in transition or maybe stale.

Great! Thanks. Just submit any patches to the bug tracker at
http://twistedmatrix.com/bugs/

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From radix at twistedmatrix.com  Tue Oct 28 04:40:02 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 28 Oct 2003 06:40:02 -0500
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
In-Reply-To: <15594-31581@sneakemail.com>
References: <15594-31581@sneakemail.com>
Message-ID: <20031028114002.GC868@radii>

On Mon, Oct 27, 2003 at 08:41:11PM -0000, Mark Evans wrote:
> More curiosity:
> 
> * What is the preferred mechanism for local echo
> of characters on the client side?  Presumably
> TM has hooks for such things, with all its event
> handling capabilities.

No, there is no special support for echoing characters back. This is a
user-interface issue, and doesn't have anything to do with the
(non-existent) TelnetClient client protocol implementation.

> * The Shell class lives in telnet.py and the Telnet
> superclass lives in a file with the same name.
> I suggest a file name change here, maybe telnet_shell.py.

Yes, but Python has namespaces, unlike C, or whatever else you may be
used to. t.manhole.telnet is not t.protocols.telnet.

> * The factoring between Telnet class and Shell doesn't
> seem clean, on initial impression.  Telnet is already
> halfway towards a server-only functionality, all of
> which should be factored into Shell.  The Telnet protocol
> class should be agnostic between server and client
> usage.

No. Shell (in twisted.manhole.telnet) should not be where the server
implementation of the telnet protocol lives. Shell is for a remote
Python shell, not a general purpose Telnet server protocol
implementation.

twisted.protocols.telnet.Telnet should remain as the server
implementation of the Telnet protocol, and t.p.telnet.TelnetClient
should be added, using recommendations I pointed out in my other post.

Hope that helps!

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+            http://radix.twistedmatrix.com



From justinjohnson at fastmail.fm  Tue Oct 28 07:13:42 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Tue, 28 Oct 2003 08:13:42 -0600
Subject: [Twisted-Python] Minor web site problem
Message-ID: <20031028141342.220149768@www.fastmail.fm>

When I click on the Twisted logo to go to the downloads section, and then
click on the logo at the top of the page to get back to the main page,
I'm sent to http://twistedmatrix.com// and get the error "No Such
Resource" when running Mozilla, or just the default "Page cannot be
found" page that IE displays if using IE.

This happens on pretty much any page when you click the logo to get back
to /.

Minor problem, but it would make the web site seem more professional if
that didn't happen.  :-)

Thanks.
-Justin



From abe at fettig.net  Tue Oct 28 07:16:39 2003
From: abe at fettig.net (Abe Fettig)
Date: Tue, 28 Oct 2003 09:16:39 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <20031028023219.GA8062@twistedmatrix.com>
References: <20031027121344.31daf5e9.itamar@itamarst.org> <3F9D923C.70701@fettig.net> <18104.209.5.247.105.1067292510.squirrel@home.vandorp.ca> <3F9D988F.2060703@twistedmatrix.com> <3F9DD1AC.6000602@fettig.net> <20031028023219.GA8062@twistedmatrix.com>
Message-ID: <3F9E7A47.8050207@fettig.net>

Christopher Armstrong wrote:

> See Donovan's response.

Thanks, that was what I was looking for.  For some reason I didn't see 
the bottom half of his message the first time.

Abe




From vlupien at drummonddesigns.com  Tue Oct 28 07:28:52 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Tue, 28 Oct 2003 09:28:52 -0500
Subject: [Twisted-Python] Deferred problem
Message-ID: <000001c39d5f$cf9d43b0$687ba8c0@vicky>

I'm trying to construct a new class for authentification by a database.
I used the class FilePasswordDB in checkers to build my own class
DatabaseAuthentification.  
I think my logic is alright but I get an Deferred error.  
I tested my query in an other page and I know that's working fine.  
The problem is that I don't know how I can make my program wait for the
result of my query (the query is very short).  
I tried to use defer.succeed but it doesn't seem to work.
 
Here's my code that I'm working on:
 
class DatabaseIdentification:
    
    __implements__ = (ICredentialsChecker,)
 
    def __init__(self, dbpool):
        self.dbpool = dbpool
        self.credentialInterfaces = (credentials.IUsernamePassword,)
 
    def _cbPasswordMatch(self, matched, username):
        if matched:
            return username
        else:
            return failure.Failure(error.UnauthorizedLogin())
 
    def getUser(self, username):
        sql = """SELECT * FROM users WHERE name='%s'""" %username
        results = self.dbpool.runQuery(sql)   ## the deferred result
        if results is not None:
            return results[0], results[1]
        raise KeyError(username)
 
    # same code as FilePasswordDB
    def requestAvatarId(self, c):
        try:
            u, p = self.getUser(c.username)
        except KeyError:
            return failure.Failure(error.UnauthorizedLogin())
        else:
            if components.implements(c,
credentials.IUsernameHashedPassword):
                h = self.hash(c.username, c.password, p)
                if h == p:
                    return u
                return failure.Failure(error.UnauthorizedLogin())
            else:
                return defer.maybeDeferred(c.checkPassword, p
                    ).addCallback(self._cbPasswordMatch, u)
            return failure.Failure(error.UnauthorizedLogin())
        
 
and here's the function where a call DatabaseAuthentification:
 
def createResource():
    dbpool = database.DataBase().getConnection()
    return simpleguard.guardResource(
        RootPage(dbpool=dbpool),
        #[checkers.DatabaseIdentification(sibpath(__file__,
"passwords.txt"))],
        [checkers.DatabaseIdentification(dbpool=dbpool)],
        callback=callback)    
 
THE ERROR I GET:
 
C:\PROGRA~1\Python22\lib\site-packages\twisted\cred\checkers.py, line
237 in getUser
235    results = self.dbpool.runQuery(sql)
236    if results is not None:
237      return results[0], results[1]
238    raise KeyError(username)
Locals 

username
Vicky

self
<twisted.cred.checkers.DatabaseIdentification instance at 0x007C4AA0>

results
<Deferred at 0xfe6af0>

sql
'"SELECT * FROM users WHERE name='vicky'
exceptions.AttributeError: Deferred instance has no attribute
'__getitem__'
 
I've been working for a long time on this problem, help would be really
appreciate,
 
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031028/8ae3d287/attachment.html>

From itamar at itamarst.org  Tue Oct 28 08:26:05 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 28 Oct 2003 10:26:05 -0500
Subject: [Twisted-Python] Re: Compile failure in 1.1.0rc1 Windows
In-Reply-To: <9628-70170@sneakemail.com>
References: <9628-70170@sneakemail.com>
Message-ID: <20031028102605.3ab82f34.itamar@itamarst.org>

On 27 Oct 2003 15:06:24 -0000
"Mark Evans" <v6kk1hg02 at sneakemail.com> wrote:

> I'd also like to plug Digital Mars C++, which is very compatible
> with Microsoft Visual C++ (e.g. makefiles and such) but FREE and
> superior from every angle -   http://www.DigitalMars.com
> (No, I am not using it in this thread at all, just MSVC6sp5.)

I'm pretty sure the official exe gets built with mingw. Dunno how it is
feature-wise, but it has the important distinction of being open source.

Additionally, distutils would need DM C++ support, which I'm not sure it
has (feel free to add a feature request on the python SF tracker).

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From matthew.s.hegedus at lmco.com  Tue Oct 28 08:41:38 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Tue, 28 Oct 2003 09:41:38 -0600
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*	internet
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>

Forgive me, I'm a little confused. I've had some trouble trying to implement
a seemingly simple web server using Woven, so the mention of this "nevow"
peaked my curiosity. On www.divmod.org I check out Quotient and it appears
to be nothing but an email app.

Here's what I've got and what I'm trying to accomplish:

  I've already created a twisted server app and client app. The client can
connect to the server, pass client   
  info to the server for management, query the server for all of the info
that it is managing, and the client can 
  manipulate this info(modify some attributes, delete info). 

  Now I want to create a web interface to this server, so that anybody can
access the server's info through a  
  browser. I want the users to have the same capabilities that the twisted
client app provides. For GUI I want 
  text input fields, tables, buttons inside and outside of tables, and maybe
a chunk of browser space devoted to 
  chat.

  With Woven I can create tables and buttons just fine, but input handling
is baffling me, and I'm suspicious of  
  webConduitGlue which is supposedly necessary for JavaScript to work and
may or may not be related to my input 
  troubles.

Is Twisted and/or Woven and/or Nevow a good technology for tackling this
sort of problem? Or is should I be looking at other technologies (JAVA
applets, JSP, servlets, CGI, ASP)? I'm lacking direction for the moment and
my confidence in Twisted is shaky(or is it just my understanding of
Twisted?). I welcome and appreciate any thoughts from this Twisted
community. Thanks,

Matthew



-----Original Message-----
From: Donovan Preston [mailto:dp at twistedmatrix.com] 
Sent: Monday, October 27, 2003 4:56 PM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
internet



On Oct 27, 2003, at 5:23 PM, darryl wrote:

>
>>> The question is, does anyone want to focus on learing woven with NEW 
>>> woven in the works?

Woven is certainly very usable in it's current state -- if you want to 
do simple-to-moderate things quickly, it can be very useful. However, 
it's complexity made it difficult to do some of the more ambitious 
things we are trying to do, such as semi-transparent form handling, and 
serverToClient events. But there are a few people who have built (and 
deployed) fairly complex woven applications. The fact that nevow exists 
doesn't detract from that.

nevow was originally a research project -- a weekend's worth of hacking 
whose benefits turned out to be so great that we decided to focus on 
bringing it up to a usable state for Quotient as soon as possible. And 
that's where it is now.

Most of the woven concepts -- template and code abstraction using a 
DOM, reusable partial page renderers (Widgets in old woven, renderer 
callables in nevow), all of the concepts needed to know to use 
twisted.web -- carry over to nevow. The only thing that's really 
changed in nevow is a few names, and the code is VASTLY simplified, 
well tested, and thus far easier to understand, design semantics for, 
and change.

>> An unfortunate last-minute change of direction, but worth it
>> considering
>>  how vastly improved the new code is.
>>
>> It's no longer a part of Twisted, however.  Check out Quotient CVS - 
>> www.divmod.org
>
> May i ask why it's not part of twisted?
> And if that's the case will Woven be maintained?

nevow will be moved into twisted after a period of 
stabilization/development in Quotient. Since twisted is a large project 
with many external developers using it, and quotient is a smaller 
project that is mostly a small core team of development, we felt it 
made sense to keep it out of twisted proper until the development had 
stabilized. Since nevow has the benefit of being a complete rewrite of 
all the *best* parts of woven, and none of the bad, stabilization has 
been remarkably quick. So expect to see nevow in twisted fairly soon.

In the meantime, woven will continue to be maintained with bugfixes, 
and nevow is fully usable outside of quotient -- even to the point of 
being fully usable without twisted.web (as a cgi, or in zope or 
webware, for example). I should also mention that there will probably 
be a compatibility layer for nevow to render old-style Woven classes 
sometime in the future. It is amazingly simple to add rendering 
functionality to it since it uses components to render the dom (which 
is really just a list of any python objects)

If you are doing any new development, I highly encourage you to take a 
look at nevow, if for no other reason than you can have a hand in 
shaping it's development. I would very much appreciate feedback about 
it, especially now, since the code is very, very short and readable.

dp


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From dp at twistedmatrix.com  Tue Oct 28 09:07:06 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Tue, 28 Oct 2003 11:07:06 -0500
Subject: [Twisted-Python] Deferred problem
In-Reply-To: <000001c39d5f$cf9d43b0$687ba8c0@vicky>
References: <000001c39d5f$cf9d43b0$687ba8c0@vicky>
Message-ID: <C6EC5006-0960-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 28, 2003, at 9:28 AM, vicky lupien wrote:

>     def getUser(self, username):
>         sql = """SELECT * FROM users WHERE name='%s'""" %username
>         results = self.dbpool.runQuery(sql)   ## the deferred result
>         if results is not None:
>             return results[0], results[1]
>         raise KeyError(username)

The Deferred is a promise that some data will be available eventually. 
You cannot
immediately access the result as you try to do here. What you want to 
do is return the
deferred from here after adding a callback which checks to see if there 
was a match
in the database and returns a Failure (analogous to raising an 
exception) if not. If the
authentication succeeded, the callback should return the id of the 
authenticated user.


def requestAvatarId(self, creds):
	## Start the database query; it will not be done until later.
	theDeferred = self.dbpool.runQuery(
		"select * from users where name='%s'" % username
	)

	## Define a callback which will check the results from the database
	## when they are ready and return either the id of the user who has
	## logged in or a failure indicating login failure.
	def checkAuth(result):
		if result is None:
			return failure.Failure(UnauthorizedLogin(c.username))

		u, p = result
		if components.implements(creds, credentials.IUsernameHashedPassword):
			h = self.hash(creds.username, creds.password, p)
			if h == p:
				return u
		return failure.Failure(UnauthorizedLogin(c.username)

	## Add the callback to the Deferred and return it; when the database
	## result is ready, the callback will fire and provide either a Failure
	## or a logged in user id to the framework code which has called
	## requestAvatarId.
	return theDeferred.addCallback(
		checkAuth
	)




From itamar at itamarst.org  Tue Oct 28 10:53:36 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 28 Oct 2003 12:53:36 -0500
Subject: [Twisted-Python] Handling forms in woven
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>
Message-ID: <20031028125336.531fc215.itamar@itamarst.org>

On Tue, 28 Oct 2003 09:41:38 -0600
"Hegedus, Matthew S" <matthew.s.hegedus at lmco.com> wrote:

>   With Woven I can create tables and buttons just fine, but input
>   handling
> is baffling me, and I'm suspicious of  
>   webConduitGlue which is supposedly necessary for JavaScript to work
>   and
> may or may not be related to my input 
>   troubles.

webConduitGlue is for livepage. You don't need livepage to handle forms.
Nor do you need controllers.

The way to handle forms in woven is the same as in twisted.web proper -
override the render method on your Resource subclass (e.g. your Page
subclass) and look at request.args.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Tue Oct 28 12:37:05 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 28 Oct 2003 14:37:05 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com>
Message-ID: <3F9EC561.4020906@twistedmatrix.com>

Hegedus, Matthew S wrote:
> Forgive me, I'm a little confused. I've had some trouble trying to implement
> a seemingly simple web server using Woven, so the mention of this "nevow"
> peaked my curiosity. On www.divmod.org I check out Quotient and it appears
> to be nothing but an email app.

In that sense, Twisted appears to be nothing but a select loop :).




From bob at redivi.com  Tue Oct 28 13:00:56 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 28 Oct 2003 15:00:56 -0500
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your* internet
In-Reply-To: <3F9EC561.4020906@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F4@EMSS07M12.us.lmco.com> <3F9EC561.4020906@twistedmatrix.com>
Message-ID: <71590F86-0981-11D8-8B4B-000A95686CD8@redivi.com>

On Oct 28, 2003, at 2:37 PM, Glyph Lefkowitz wrote:

>
> Hegedus, Matthew S wrote:
>> Forgive me, I'm a little confused. I've had some trouble trying to 
>> implement
>> a seemingly simple web server using Woven, so the mention of this 
>> "nevow"
>> peaked my curiosity. On www.divmod.org I check out Quotient and it 
>> appears
>> to be nothing but an email app.
>
> In that sense, Twisted appears to be nothing but a select loop :).

Or.. not, in the case of some reactors :)

-bob




From vlupien at drummonddesigns.com  Tue Oct 28 13:36:06 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Tue, 28 Oct 2003 15:36:06 -0500
Subject: [Twisted-Python] Authentication (cred.checkers) by a database (was deferred problem)
In-Reply-To: <C6EC5006-0960-11D8-9397-000A95864FC4@twistedmatrix.com>
Message-ID: <000001c39d93$1cf70550$687ba8c0@vicky>

Thanks to Donavan.

I tried your code, I've made a little modification and everything is
working now.  


The problem was that no chechers was from a database.  I've change the
exemple of simplyguarded to work with this new checkers.  It works
exactly like FilePasswordDB except that the data are in a database
instead of in a file.  

I would be please to give the exemple if someone need it.  You only have
to tell me and I will send it to you.

Vicky Lupien
vlupien at drummonddesigns.com




From v6kk1hg02 at sneakemail.com  Tue Oct 28 07:55:25 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 28 Oct 2003 14:55:25 -0000
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
Message-ID: <16099-04201@sneakemail.com>

Christopher Armstrong,

Thanks a million for those answers.  It sounds like we were
thinking along the same lines.  However I did not see an
answer to the subject question:  do you think that a telnet
client should be a subclass of LineReceiver?

I'm still getting my head around the architecture of TM so
forgive the ignorance, but it looks like an outstanding
system.  I've written tons of communications protocols and
apps, this is the sort of stuff I dream about.

As for Python namespaces - yeah, but it's still confusing
to have two files with the same name open in an editor!
The text editor (UltraEdit) doesn't know about Python
namespaces!

As for local echo - there is no user interface here, it's
a console app (daemon actually, I might try it as an NT
service).  So we are talking stdin/stdout sort of thinking.
The reason for the question about local echo is not that
I can't do it one way or another, but I want to do it in
a way that is compatible and elegant in TM.  LineReceiver
may have something to do with that.

Your answers do help, thanks!  If nothing else they confirm
my impressions about the telnet support.  Fortunately my
telnet needs aren't exhaustive, very little of the protocol
is necessary for us.

Mark



From sam at psychlaw.com.au  Tue Oct 28 21:53:51 2003
From: sam at psychlaw.com.au (Sam Jordan)
Date: Wed, 29 Oct 2003 14:53:51 +1000
Subject: [Twisted-Python] MSN refactor
Message-ID: <20031029045351.GA3804@twistedmatrix.com>

Hi,

As of October 15 Microsoft has stopped supporting clients wishing
to connect to the MSN chat service using a protocol version which
is less than MSNP8.

The current supported version in Twisted is MSNP7 and while most
of the protocol is still the same, it will (obviously) not work.

However, any current or potential users of the twisted msn client
support should not despair, I am currently right in the middle of
exams for the next two weeks but afterwards I will try to get
the client support up to at least MSNP8 and possibly features of
MSNP9, this is of course if glyph is ok with this; I am not a
lawyer and thus have no idea about the relevant legal ramifications
of providing support for this 'proprietary' protocol. Logically I
would assume that any legal problems would result from _using_ the
service as opposed to just providing support for it, but, as stated
I have no legal basis for this assumption and given recent legal
debacles in the U.S. I am hesitant in even holding such an opinion.

So, asside from any "please do not put me in jail" signs from glyph
I will try and address the refactoring as soon as time allows with
(hopefully) as little change to the interface as possible, although
it _is_ clearly marked as unstable.

I just thought I should let everyone know incase people were
having issues with it not working.

Cheers,

Sam Jordan



From corydodt at twistedmatrix.com  Tue Oct 28 15:34:28 2003
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Tue, 28 Oct 2003 14:34:28 -0800
Subject: [Twisted-Python] ANN: Twisted 1.1.0, the framework of *your*
 internet
In-Reply-To: <200310271857.h9RIvL429365@zerg.codec.ro>
References: <200310271857.h9RIvL429365@zerg.codec.ro>
Message-ID: <3F9EEEF4.3060205@twistedmatrix.com>

Winstaller is available online now.

Keep in mind that Windows builds are done after the initial release, and may 
lag by up to a week.

Enjoy.

C

soso wrote:

> Thanks for the great work!
> 
> But I can't find the windows installer. Or there isn't a windows installer for 1.1?
> 
> soso
> 
> 
> ______________________________________________________________________
> Do you want a free e-mail for life ? Get it at http://www.email.ro/
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python





From phil at bubblehouse.org  Tue Oct 28 15:38:03 2003
From: phil at bubblehouse.org (phil at bubblehouse.org)
Date: Tue, 28 Oct 2003 17:38:03 -0500 (EST)
Subject: [Twisted-Python] twisted.web and MySQLdb
Message-ID: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>

so i probably should have subscribed to this list months (years?) ago, but
only now am i getting up to speed on the twisted craziness...

anyways, i'm toying with twisted.web, and i'm working on making a web
application. i'm also using the TAP interfaces to take care of run-time
options, etc....

I'm using MySQLdb to interface with my sql server, but i'm not really sure
what to do with my connection object once it's created. i want to put it
somewhere that will be easy to access for the rest of the modules, but
obviously i don't want it to be persisted when the TAP is saved....

i guess a lot of my problem is that i'm still trying to figure out some of
the structure when working with the framework...

i want to use the command-line options to specify a user/passwd for the
database. i guess this means i want to create my connection instance in
the updateApplication method, since it has a options reference, but i
don't know how to make it so the connection object isn't persisted, but
created new each time the server is started....

any help would be appreciated....

-phil



From scosol at yahoo.com  Tue Oct 28 16:10:19 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 28 Oct 2003 15:10:19 -0800 (PST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>
Message-ID: <20031028231019.82955.qmail@web13905.mail.yahoo.com>

--- phil at bubblehouse.org wrote:
> 
> I'm using MySQLdb to interface with my sql server,
> but i'm not really sure
> what to do with my connection object once it's
> created. i want to put it
> somewhere that will be easy to access for the rest
> of the modules, but
> obviously i don't want it to be persisted when the
> TAP is saved....
.

Hmmm- well I'm just getting started here as well- but
yeah, I don't remember any mentioned way of
selectively removing state information for objects.
I don't like the whole state-saving stuff at all- I'm
doing atomic DB stuff, so my "state" above all is
maintained on the DB itself.
The Twisted clients are just basically dumb
transaction handlers.

> but i
> don't know how to make it so the connection object
> isn't persisted, but
> created new each time the server is started...

Hmmm- would a simple solution be to simply
re-initialize the connection(s) upon any restart?
(can a restart even be detected with .app?)

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From dp at twistedmatrix.com  Tue Oct 28 16:26:44 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Tue, 28 Oct 2003 18:26:44 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
References: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
Message-ID: <319D999E-099E-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 28, 2003, at 6:10 PM, Nathan Seven wrote:

> --- phil at bubblehouse.org wrote:
>>
>> I'm using MySQLdb to interface with my sql server,
>> but i'm not really sure
>> what to do with my connection object once it's
>> created. i want to put it
>> somewhere that will be easy to access for the rest
>> of the modules, but
>> obviously i don't want it to be persisted when the
>> TAP is saved....
> .
>
> Hmmm- well I'm just getting started here as well- but
> yeah, I don't remember any mentioned way of
> selectively removing state information for objects.
> I don't like the whole state-saving stuff at all- I'm
> doing atomic DB stuff, so my "state" above all is
> maintained on the DB itself.
> The Twisted clients are just basically dumb
> transaction handlers.

This is the way you should be doing it -- the only state in
the tap should be configuration information about
what services live on what ports, what directory
the web server looks at, etc.

>> but i
>> don't know how to make it so the connection object
>> isn't persisted, but
>> created new each time the server is started...
>
> Hmmm- would a simple solution be to simply
> re-initialize the connection(s) upon any restart?
> (can a restart even be detected with .app?)

Since the tap is just a pickle, the easiest way to
prevent certain objects from getting persisted is to
implement a __getstate__ and __setstate__ for
your class. See the python documentation for
information.

dp




From itamar at itamarst.org  Tue Oct 28 16:29:58 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 28 Oct 2003 18:29:58 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
References: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>
	<20031028231019.82955.qmail@web13905.mail.yahoo.com>
Message-ID: <20031028182958.167cd4c1.itamar@itamarst.org>

On Tue, 28 Oct 2003 15:10:19 -0800 (PST)
Nathan Seven <scosol at yahoo.com> wrote:

> Hmmm- would a simple solution be to simply
> re-initialize the connection(s) upon any restart?
> (can a restart even be detected with .app?)

Services get startService and stopService called on startup/shutdown of
the application. See
http://twistedmatrix.com/documents/howto/application and
twisted.application.service.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From matthew.s.hegedus at lmco.com  Tue Oct 28 17:13:04 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Tue, 28 Oct 2003 18:13:04 -0600
Subject: [Twisted-Python] Serving web pages: Using frames, and re-rendering one frame's con	tent from a separate frame, and colors
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F5@EMSS07M12.us.lmco.com>

I have set up a top level xhtml template that has multiple frames for other
xhtml templates. In one of these frames I have a button, and when it is
clicked I want to update some data and then display this data in another
frame. 

I have coded a FrameClass(page.Page) which will in turn instantiate other
Page subclasses that are responsible for rendering each frame's
corresponding xhtml file. All of my attempts end up rendering the "foreign"
frames xhtml inside of the current frame in which the button was pressed.
Hopefully I haven't made this too confusing. Any ideas?

And about colors... I use lmx to help create some xhtml but when I do
something like this...

   lmxnode = lmx(node)
   d = lmxnode.div()
   t = d.table()
   t.tr(bgcolor="eeeeee")

... trying to set the table row's background color to a light grey (hex
value "eeeeee") has no effect. If I explicity type something of the sort
into a static xhtml file, the color is correctly displayed. Anyone know
what's going on?

By the way, thanks for the previous help on handling input - I was messing
up the html form tag.

Matthew



From matt at pollenation.net  Tue Oct 28 17:37:51 2003
From: matt at pollenation.net (Matt Goodall)
Date: Wed, 29 Oct 2003 00:37:51 +0000
Subject: [Twisted-Python] MSN refactor
In-Reply-To: <20031029045351.GA3804@twistedmatrix.com>
References: <20031029045351.GA3804@twistedmatrix.com>
Message-ID: <3F9F0BDF.5050802@pollenation.net>

Sam Jordan wrote:

>I am not a
>lawyer and thus have no idea about the relevant legal ramifications
>of providing support for this 'proprietary' protocol. Logically I
>would assume that any legal problems would result from _using_ the
>service as opposed to just providing support for it, but, as stated
>I have no legal basis for this assumption and given recent legal
>debacles in the U.S. I am hesitant in even holding such an opinion.
>
Talk to the gaim developers, they may be able to tell you more about the 
legal side of this ... assuming they looked into it.

Cheers, Matt

-- 
Matt Goodall, Pollenation Internet Ltd
w: http://www.pollenation.net
e: matt at pollenation.net
t: +44 (0)113 2252500





From andrew-twisted at puzzling.org  Tue Oct 28 17:39:18 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 29 Oct 2003 11:39:18 +1100
Subject: [Twisted-Python] Re: Compile failure in 1.1.0rc1 Windows
In-Reply-To: <9628-70170@sneakemail.com>
References: <9628-70170@sneakemail.com>
Message-ID: <20031029003918.GA3030@frobozz>

On Mon, Oct 27, 2003 at 03:06:24PM -0000, Mark Evans wrote:
> 
> Anyway to the main point - why is this custom header being
> used; or if it is not custom, why is it used in a custom
> location?  All you need to do is fix that, and it would
> work fine.  Someone needs to look at his header directory
> structure and compare it against the standard one(s).  It's
> just a config issue, and a simple one to fix.

It's not a "custom header", as far as I know.  portmap.c simply wraps a
couple of simple functions (pmap_set and pmap_unset) to allow
twisted.runner.inetd to support Sun-RPC services, in addition to the usual
TCP and UDP services.

I'm reasonably sure that Windows doesn't have Sun-RPC support, so that
module not compiling is expected behaviour.  If that's stopping setup.py
from completing, then that sounds like a bug, and a bug report added to
http://twistedmatrix.com/bugs would be appreciated :)

-Andrew.




From stuart.hungerford at anu.edu.au  Tue Oct 28 18:12:18 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Wed, 29 Oct 2003 12:12:18 +1100
Subject: [Twisted-Python] Handling forms in woven
In-Reply-To: <20031028232701.26785.14176.Mailman@pyramid.twistedmatrix.c
 om>
References: <20031028232701.26785.14176.Mailman@pyramid.twistedmatrix.com>
Message-ID: <6.0.0.22.0.20031029120458.01e1f788@anusf.anu.edu.au>

Quoth Itamar:

 >webConduitGlue is for livepage. You don't need livepage to handle forms.
 >Nor do you need controllers.
 >
 >The way to handle forms in woven is the same as in twisted.web proper -
 >override the render method on your Resource subclass (e.g. your Page
 >subclass) and look at request.args.

   This issue of when a Woven Page subclass has a render() method is
   one that seems to come up quite often in my use of Twisted web.

   If a Woven Page has a bunch of model factory and view update methods
   etc, how/when are they run if the page also has a render() method?

   Should the subclass' render() method always call the superclass'
   render() method?

   A good example is with simpleguard'ed pages which seem to need a
   render() method for the simpleguard check/fail tests but may also
   have a bunch of model and view methods for generating the HTML.

   Any advice much appreciated,


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From andrew-twisted at puzzling.org  Tue Oct 28 18:37:47 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 29 Oct 2003 12:37:47 +1100
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
In-Reply-To: <16099-04201@sneakemail.com>
References: <16099-04201@sneakemail.com>
Message-ID: <20031029013746.GB3030@frobozz>

On Tue, Oct 28, 2003 at 02:55:25PM -0000, Mark Evans wrote:
> 
> As for local echo - there is no user interface here, it's
> a console app (daemon actually, I might try it as an NT
> service).  So we are talking stdin/stdout sort of thinking.
> The reason for the question about local echo is not that
> I can't do it one way or another, but I want to do it in
> a way that is compatible and elegant in TM.  LineReceiver
> may have something to do with that.

No, the telnet client protocol has nothing to do with local echo.  A
TelnetClient instance would be responsible for sending and receiving data
over the socket, and local echo would be handled by whatever is responsible
for sending and receiving data over stdout/stdin.

So, whatever is talking to your stdin/stdout (probably a protocol instance
passed to twisted.internet.stdio.StandardIO) would have a reference to the
TelnetClient instance, so when the stdio's protocol's dataReceived is
called, it would check, say, self.telnetclient.localEcho, and call
self.transport.write if true.  

So the telnet client is responsible for letting whatever is using it know
that localEcho is or isn't set; but the actual echoing is done elsewhere.
Perhaps this is what you meant :)

-Andrew.




From itamar at itamarst.org  Tue Oct 28 19:04:24 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 28 Oct 2003 21:04:24 -0500
Subject: [Twisted-Python] Handling forms in woven
In-Reply-To: <6.0.0.22.0.20031029120458.01e1f788@anusf.anu.edu.au>
References: <20031028232701.26785.14176.Mailman@pyramid.twistedmatrix.com>
	<6.0.0.22.0.20031029120458.01e1f788@anusf.anu.edu.au>
Message-ID: <20031028210424.5d2fa22a.itamar@itamarst.org>

On Wed, 29 Oct 2003 12:12:18 +1100
Stuart Hungerford <stuart.hungerford at anu.edu.au> wrote:

>    Should the subclass' render() method always call the superclass'
>    render() method?

Yes. Or redirect somewhere useful.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From foom at fuhm.net  Tue Oct 28 20:06:59 2003
From: foom at fuhm.net (James Y Knight)
Date: Tue, 28 Oct 2003 22:06:59 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
References: <20031028231019.82955.qmail@web13905.mail.yahoo.com>
Message-ID: <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>

On Oct 28, 2003, at 6:10 PM, Nathan Seven wrote:

> --- phil at bubblehouse.org wrote:
>>
>> I'm using MySQLdb to interface with my sql server,
>> but i'm not really sure
>> what to do with my connection object once it's
>> created. i want to put it
>> somewhere that will be easy to access for the rest
>> of the modules, but
>> obviously i don't want it to be persisted when the
>> TAP is saved....
> .
>
> Hmmm- well I'm just getting started here as well- but
> yeah, I don't remember any mentioned way of
> selectively removing state information for objects.
> I don't like the whole state-saving stuff at all- I'm
> doing atomic DB stuff, so my "state" above all is
> maintained on the DB itself.
> The Twisted clients are just basically dumb
> transaction handlers.

You should just not use the whole pickled app/saving state thing. Then 
you don't have to worry about this stuff at all. In addition the next 
person who comes along and wants to debug something will thank you 
profusely when he doesn't have to sit there and ponder "gee, I wonder 
what parameters the last person gave to mktap, cause I really would 
like to startup a second copy of that app on another port. (or from a 
different directory, with a new file type handler, whatever)...".

I recommend configuring your webserver with python code and starting it 
with twistd -y. Perhaps not ideal but certainly better than the whole 
tap mess.

All IMO, of course.

James




From butchland at yahoo.com  Tue Oct 28 20:33:12 2003
From: butchland at yahoo.com (Butch Landingin)
Date: Tue, 28 Oct 2003 19:33:12 -0800 (PST)
Subject: [Twisted-Python] Twisted and Zope
In-Reply-To: <20031028114356.30952.55874.Mailman@pyramid.twistedmatrix.com>
Message-ID: <20031029033312.50955.qmail@web80605.mail.yahoo.com>

--- On  Tue, 28 Oct 2003 12:56:06 +0200, Gerrit van Dyk <gerritvd at decillion.net>wrote:
> 
> Hi all,
> 
> I am trying to integrate Twisted and Zope. I saw a project on Sourceforge
> called twistedzope, but for some reason I cannot get anonymous cvs access
> to this product. Can somebody email the product to me (where can I find it
> except through anonymous cvs access), or am I wasting my time in looking at
> this.

Hi Gerrit, 

I created the project and I'm in the process of preparing its initial release which I plan
to do sometime next week (barring any major hitches). I also plan to upload my local
CVS repository shortly after that to the SF cvs.

Currently,  the module already allows you to run the zope3 http server over  twisted's
reactor framework. I'm currently working on the zope3 ftp server which  I plan to
finish before releasing the package.  I also wrote a minimal TAP plug-in that can configure and
run 
the zope3 http server  using mktap and twistd..

Some other stuff  that I'm playing around with:  configuring  twisted wire protocol 
servers (e.g. daytime, echo) using the Zope3 ZConfig configuration package.

If you're interested, you could serve as my sanity checking guinea pig :^) -- meaning I send
a release candidate to you and you can try to follow the instructions and see if  it runs
on your system.

Regards,

Butch Landingin


__________________________________
Do you Yahoo!?
Exclusive Video Premiere - Britney Spears
http://launch.yahoo.com/promos/britneyspears/



From scosol at yahoo.com  Tue Oct 28 20:34:22 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 28 Oct 2003 19:34:22 -0800 (PST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <20031029033422.32190.qmail@web13903.mail.yahoo.com>

--- James Y Knight <foom at fuhm.net> wrote:
> 
> You should just not use the whole pickled app/saving
> state thing. Then 
> you don't have to worry about this stuff at all. In
> addition the next 
> person who comes along and wants to debug something
> will thank you 
> profusely when he doesn't have to sit there and
> ponder "gee, I wonder 
> what parameters the last person gave to mktap, cause
> I really would 
> like to startup a second copy of that app on another
> port. (or from a 
> different directory, with a new file type handler,
> whatever)...".
> 
> I recommend configuring your webserver with python
> code and starting it 
> with twistd -y. Perhaps not ideal but certainly
> better than the whole 
> tap mess.

Right right- I'm not using it at all- but the other
guy seemed to have some requirement for it.
Tho- for logging and such I may use .app but just run
with the -no_save option.

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From dp at twistedmatrix.com  Tue Oct 28 20:48:37 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Tue, 28 Oct 2003 22:48:37 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>
References: <20031028231019.82955.qmail@web13905.mail.yahoo.com> <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <C7461021-09C2-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 28, 2003, at 10:06 PM, James Y Knight wrote:

> You should just not use the whole pickled app/saving state thing. Then 
> you don't have to worry about this stuff at all. In addition the next 
> person who comes along and wants to debug something will thank you 
> profusely when he doesn't have to sit there and ponder "gee, I wonder 
> what parameters the last person gave to mktap, cause I really would 
> like to startup a second copy of that app on another port. (or from a 
> different directory, with a new file type handler, whatever)...".
>
> I recommend configuring your webserver with python code and starting 
> it with twistd -y. Perhaps not ideal but certainly better than the 
> whole tap mess.

Now that freeform is done in quotient and passing existing object 
references to formless methods is next up on the plate (and the 
implementation is far cleaner than the old quotient 
formless/configure/webform) we can get started on writing COIL sometime 
in the near future so you can configure pickled application instances 
in the tap using a nice web ui. Having a good configuration interface 
which allows you to load the serialized application, reconfigure it, 
and serialize it back out to disk has always been an integral part of 
the tap idea that has never actually been implemented properly yet.

The "I wonder what parameters were used" idea is pretty interesting, 
though. It would be trivial to serialize the command-line options that 
were given to each invocation of mktap along with everything else so at 
the very least we could show you which command line options were used 
to build the application in the first place.

dp




From lafou at wanadoo.fr  Tue Oct 28 23:52:22 2003
From: lafou at wanadoo.fr (Philippe =?ISO-8859-1?Q?Lafoucri=E8re?=)
Date: Wed, 29 Oct 2003 07:52:22 +0100
Subject: [Twisted-Python] Martin Moellenbeck/PLUS/MHM/TUG/DE ist
	=?ISO-8859-1?Q?au=DFer?= Haus.
In-Reply-To: <OF09F48F40.82FAE4CF-ONC1256DCD.00000AE1-C1256DCD.00000AE1@uz.tengelmann.de>
References: 	 <OF09F48F40.82FAE4CF-ONC1256DCD.00000AE1-C1256DCD.00000AE1@uz.tengelmann.de>
Message-ID: <1067410341.4879.0.camel@pcmarie>

Please post in english .......! :(

On Tue, 2003-10-28 at 01:00, mmoellenbeck at plus.de wrote:
> Ich werde ab  27.10.2003 nicht im Büro sein. Ich kehre zurück am
> 09.11.2003.
> 
> Ich werde Ihre Nachricht nach meiner Rückkehr beantworten.
> 
> In dringenden Fällen richten Sie sich bitte an Herrn Kimpenhaus oder Herrn
> Albring.





From radix at twistedmatrix.com  Tue Oct 28 23:58:37 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Wed, 29 Oct 2003 01:58:37 -0500
Subject: [Twisted-Python] Re: Telnet Client as Line Receiver?
In-Reply-To: <16099-04201@sneakemail.com>
References: <16099-04201@sneakemail.com>
Message-ID: <20031029065837.GD8062@twistedmatrix.com>

On Tue, Oct 28, 2003 at 02:55:25PM -0000, Mark Evans wrote:

> do you think that a telnet client should be a subclass of
> LineReceiver?

Hmm.. Well, I think it should probably expose a line-based interface,
but you may have to implement it yourself without
LineReceiver. "Prompts" are ubiquitous in telnet-based services, so
you're going to have to handle that case. You can never tell when a
prompt will be received, so using LineReceiver at all is
futile. Perhaps there could be two event-methods, lineReceived and
promptReceived, where promptReceived is called when input has been
received that matches a user-defined "prompt pattern", and no data has
been received for N.n seconds after that input was received?

I recommend just implementing it however you need it to be implemented
and posting a patch to the bug tracker. Someone (perhaps me) will take
a look at it.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From m at zadka.site.co.il  Tue Oct 28 23:28:17 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 29 Oct 2003 06:28:17 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>
References: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2>
Message-ID: <20031029062817.23143.qmail@green.zadka.com>

I won't reply to your question here, I'm sure someone more competent
than me can do so.
I will take a minute to note that for some reason, the instinct of
web developers has been to immediately write applications in the
LAMP model. While twisted.web is a perfectly good substitute for
A, and can indeed be used this way, it is much more capable.

LAMP -- Linux Apache MySQL PHP [each of those has variants]

Linux (and most other things in the "L" place, such as FreeBSD) has
an incredibly fast fork() operation. This leads people to write their
web code with the process-per-page model. Apache optimizes this by
preforking, making such code actually scalable enough to deliver good
response times. However, suddenly there is a problem: since different
processes are likely to deal with the same user, memory becomes fragile.
It is unsafe to put things in memory: processes switch users, get born
and die too often. In Linux, and most other Unices, file locking has
been a thorny issue. So instead of putting data in files, where the
subtle semantics of locking and concurrency should be dealt with,
data tends to end up in the database. That means *all* data. Sessions.
Temporary "show this message when the user finished his redirect loop".
Etc. etc. Once all the data is in MySQL, which is the easiest database to
set up, it becomes natural for the average page to be a "glorified select".
PHP was designed for this exact scenario: take a select table and spruce
it up with HTML.

Unfortunately, what LAMP deals to is exactly to this: inevitably, all
pages are just spruced up select-tables. This makes programming somewhat
unnatural unless you're programming a database viewer.

With twisted.web, you don't have these problems. It is easy to keep data
in files, because locking is not an issue. It is easy to cache data in memory
because everything is served from a single process. If you need to attach
state to a user's session, you can just keep an object in the session.
This means programming twisted.web should be a lot more like writing
a GUI application, and a lot less like writing select-with-HTML.
You should probably reconsider whether you really want MySQL. It adds
complexity to your application, and the gain is usually small. Putting
persistent data in files, and using liberal caching schemes, also plays
on the core advantage of Linux (and similar) -- it uses the incredibly
optimized caching algorithms.



From m at zadka.site.co.il  Tue Oct 28 23:46:27 2003
From: m at zadka.site.co.il (Moshe Zadka)
Date: 29 Oct 2003 06:46:27 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <C7461021-09C2-11D8-9397-000A95864FC4@twistedmatrix.com>
References: <C7461021-09C2-11D8-9397-000A95864FC4@twistedmatrix.com>, <20031028231019.82955.qmail@web13905.mail.yahoo.com> <F6007FF0-09BC-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <20031029064627.23375.qmail@green.zadka.com>

On Tue, 28 Oct 2003, Donovan Preston <dp at twistedmatrix.com> wrote:

> The "I wonder what parameters were used" idea is pretty interesting, 
> though. It would be trivial to serialize the command-line options that 
> were given to each invocation of mktap along with everything else so at 
> the very least we could show you which command line options were used 
> to build the application in the first place.

Well, you'd have to consider what to do about mktap --append.
Assuming you just want a "history of command line", it would be
a 10-minute hack to mktap, which is based on a service:

class MktapArgs(service.Service):
    def __init__(self):
        self.setName("mktap")
        self.history = []
    def run(self):
        self.history.append(sys.argv)

def document(application):
    try:
        s = service.IServiceCollection(application).getServiceByName("mktap")
    except KeyError
        s = MktapArgs()
        s.setServiceParent(application)
    s.run()

And just add a call to document(application) in twisted/scripts/mktap.py, five
lines into addToApplication.



From scosol at yahoo.com  Wed Oct 29 00:34:37 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Tue, 28 Oct 2003 23:34:37 -0800 (PST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029062817.23143.qmail@green.zadka.com>
Message-ID: <20031029073437.52308.qmail@web13908.mail.yahoo.com>

--- Moshe Zadka <m at zadka.site.co.il> wrote:
>
> In Linux, and most other Unices,
> file locking has
> been a thorny issue. So instead of putting data in
> files, where the
> subtle semantics of locking and concurrency should
> be dealt with,
> data tends to end up in the database. That means
> *all* data. Sessions.
> Temporary "show this message when the user finished
> his redirect loop".

Hmmmm I would qualify that- I dont think the
filesystem is the place to be handling dynamic data. 
Databases were created *specifically* for this
purpose.  Sure, storing all your static blobs in your
database is a really quick way to grind shit to a
halt, but locking and concurrency?
If you're doing things properly, and your http server
is just serving static objects, then these are
non-issues.

> Etc. etc. Once all the data is in MySQL, which is
> the easiest database to
> set up, it becomes natural for the average page to
> be a "glorified select".
> PHP was designed for this exact scenario: take a
> select table and spruce
> it up with HTML.

Yeah- through my line of work I deal with a *lot* of
different infrastructures.  Everything from "Joe's BBQ
Sauce Garage" to Amazon.  Literally the only
organization I can think of that can keep anything
coherent with MySQL is Livejournal- and then I believe
only because Brad seems to be a cache-god with
memcached and such.

Speaking of- I know we're kinda tied to Python, but
what are the thoughts about using any of the OS's
provided event-driven polls? (epoll,kqueue) 
I'm guessing these are essentially untouchable without
Python mods.

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From illumen at yahoo.com  Wed Oct 29 00:50:56 2003
From: illumen at yahoo.com (Rene Dudfield)
Date: Wed, 29 Oct 2003 17:50:56 +1000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029062817.23143.qmail@green.zadka.com>
References: <2048.65.246.170.211.1067380683.squirrel@192.168.0.2> <20031029062817.23143.qmail@green.zadka.com>
Message-ID: <3F9F7160.10105@yahoo.com>

Moshe Zadka wrote:

>I won't reply to your question here, I'm sure someone more competent
>than me can do so.
>I will take a minute to note that for some reason, the instinct of
>web developers has been to immediately write applications in the
>LAMP model. While twisted.web is a perfectly good substitute for
>A, and can indeed be used this way, it is much more capable.
>
>LAMP -- Linux Apache MySQL PHP [each of those has variants]
>
>Linux (and most other things in the "L" place, such as FreeBSD) has
>an incredibly fast fork() operation. This leads people to write their
>web code with the process-per-page model. Apache optimizes this by
>preforking, making such code actually scalable enough to deliver good
>response times. However, suddenly there is a problem: since different
>processes are likely to deal with the same user, memory becomes fragile.
>It is unsafe to put things in memory: processes switch users, get born
>and die too often. In Linux, and most other Unices, file locking has
>been a thorny issue. So instead of putting data in files, where the
>subtle semantics of locking and concurrency should be dealt with,
>data tends to end up in the database. That means *all* data. Sessions.
>Temporary "show this message when the user finished his redirect loop".
>Etc. etc. Once all the data is in MySQL, which is the easiest database to
>set up, it becomes natural for the average page to be a "glorified select".
>PHP was designed for this exact scenario: take a select table and spruce
>it up with HTML.
>
>Unfortunately, what LAMP deals to is exactly to this: inevitably, all
>pages are just spruced up select-tables. This makes programming somewhat
>unnatural unless you're programming a database viewer.
>
>With twisted.web, you don't have these problems. It is easy to keep data
>in files, because locking is not an issue. It is easy to cache data in memory
>because everything is served from a single process. If you need to attach
>state to a user's session, you can just keep an object in the session.
>This means programming twisted.web should be a lot more like writing
>a GUI application, and a lot less like writing select-with-HTML.
>You should probably reconsider whether you really want MySQL. It adds
>complexity to your application, and the gain is usually small. Putting
>persistent data in files, and using liberal caching schemes, also plays
>on the core advantage of Linux (and similar) -- it uses the incredibly
>optimized caching algorithms.
>
>
>  
>
RANDOM NOTES ON THIS TOPIC:

Single process has problems too:
- if something blocks or stalls down comes your whole app.  This can 
happen in multi proccess too of course.
- you don't use the operating systems privileges.  You invent your own 
which is often broken and needs to be rewritten a few times.

Of course both of these can happen with your LAMP too.  If the db goes 
down or whatever.  But I guess multiprocess is more resiliant.

Some people find select statements easier.  Often you can do something 
in a line or two which is cumbersum in python.

Berkley db databases are nice to use.  They are quite optimized, and can 
emulate python dictionaries quite nicely.  Then there is zopedb which is 
an option.

Another feature databases have over files is transactions(comming soon 
to a FS near you!).  Making sure stuff is written to files reliably is 
quite difficult.

Databases are accessable from database viewers!  This is handy since 
random python object viewers are not so good :)  You can access 
databases easily from other languages, whereas python objects are harder 
to do.  I guess jelly/xmlrpc/soap helps here if you want to use those.

Databases also handle large volumes of data efficiently(or try to).  
Keeping everything in files is fine as long as you lay it out nicely and 
you have plenty of time to optimize each new query.  However the 
advantages/disadvantages of dbs are discussed to death all over the 
place, and I have nothing new to add.

Be nice to be able to use python objects as memory mapped files.  I 
guess it may be possible.  It has been done with numeric arrays, and 
with c++ objects.  This can be faster than reading files in linux too.

A lot of web pages can be cached into static files which improves 
performance by a lot.  Chucking squid, or apache as proxy in front of 
your normal webserver(s) can be a large help if you are careful.


Have fun!




From stenis at stenhard.net  Wed Oct 29 01:06:49 2003
From: stenis at stenhard.net (=?iso-8859-1?Q?Martin_Stenh=E5rd?=)
Date: Wed, 29 Oct 2003 09:06:49 +0100
Subject: [Twisted-Python] =?iso-8859-1?Q?RE:_=5BTwisted-Python=5D_Martin_Moellenbeck/PLUS/MHM/TUG/D?=
 =?iso-8859-1?Q?E_istau=DFer_Haus.?=
In-Reply-To: <1067410341.4879.0.camel@pcmarie>
Message-ID: <E1AElMN-00049X-00@pyramid.twistedmatrix.com>

He is out office :)

/Stenis

-----Original Message-----
From: twisted-python-admin at twistedmatrix.com
[mailto:twisted-python-admin at twistedmatrix.com] On Behalf Of Philippe
Lafoucrière
Sent: den 29 oktober 2003 07:52
To: Twisted
Subject: Re: [Twisted-Python] Martin Moellenbeck/PLUS/MHM/TUG/DE istaußer
Haus.

Please post in english .......! :(

On Tue, 2003-10-28 at 01:00, mmoellenbeck at plus.de wrote:
> Ich werde ab  27.10.2003 nicht im Büro sein. Ich kehre zurück am
> 09.11.2003.
> 
> Ich werde Ihre Nachricht nach meiner Rückkehr beantworten.
> 
> In dringenden Fällen richten Sie sich bitte an Herrn Kimpenhaus oder Herrn
> Albring.



_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From andrew-twisted at puzzling.org  Wed Oct 29 01:57:58 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 29 Oct 2003 19:57:58 +1100
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
References: <20031029062817.23143.qmail@green.zadka.com> <20031029073437.52308.qmail@web13908.mail.yahoo.com>
Message-ID: <20031029085758.GC3030@frobozz>

On Tue, Oct 28, 2003 at 11:34:37PM -0800, Nathan Seven wrote:
> 
> Speaking of- I know we're kinda tied to Python, but
> what are the thoughts about using any of the OS's
> provided event-driven polls? (epoll,kqueue) 
> I'm guessing these are essentially untouchable without
> Python mods.

There's a kqueue reactor already -- see twisted/internet/kqreactor.py (yes,
it does rely up on an extension module).  I'm not sure how complete it is,
it's not tested by the buildbot.

epoll shouldn't be too hard to do with pretty much the same approach.
Patches accepted :)

-Andrew.




From twisted at zadka.site.co.il  Wed Oct 29 05:25:26 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 29 Oct 2003 12:25:26 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
References: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
Message-ID: <20031029122526.5873.qmail@green.zadka.com>

On Tue, 28 Oct 2003, Nathan Seven <scosol at yahoo.com> wrote:

> Hmmmm I would qualify that- I dont think the
> filesystem is the place to be handling dynamic data. 

Why? It has been used for dynamic data for ages.
What makes a database better for that?

> Databases were created *specifically* for this
> purpose.

We have always been at war with euroasia.

> locking and concurrency?

Are not an issue when using twisted.web idiomatically.

> Yeah- through my line of work I deal with a *lot* of
> different infrastructures.  Everything from "Joe's BBQ
> Sauce Garage" to Amazon.

I'm willing to bet that they all run on systems which contain
filesystems :)

> Speaking of- I know we're kinda tied to Python, but
> what are the thoughts about using any of the OS's
> provided event-driven polls? (epoll,kqueue) 

We have a kqueue proof of concept, but it's fairly buggy.
Fixes from people who run FreeBSD would be more than welcome!
Twisted uses the reactor as an abstract inteface especially so you
could use any event-driver you want. We tie into select, poll, gtk2
and Mac OS's CF stuff. More reactor implementations would be welcome,
and it is fairly easy to run the test suite with a new reactor
if you want to see how buggy it is.

Modules like ctypes and frameworks like pyrex are easily used to
write interfaces to all kinds of OS-specific stuff.



From ecn at metaslash.com  Wed Oct 29 05:49:47 2003
From: ecn at metaslash.com (Eric C. Newton)
Date: Wed, 29 Oct 2003 07:49:47 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029085758.GC3030@frobozz>
References: <20031029062817.23143.qmail@green.zadka.com> <20031029073437.52308.qmail@web13908.mail.yahoo.com> <20031029085758.GC3030@frobozz>
Message-ID: <20031029124947.GA5294@localhost.localdomain>

I looked into this for a few hours.  I had to build a server that
needed to regularly maintain 20K+ connections.  Of course, I prototyped
it in python first.

It takes a long time just to create and accept 20K+ connections 
in Python.  Epoll wasn't going to help that much.

In the end I wrote it in C++ using ACE.  Since ACE supports poll()
and epoll() event loops, I experimented with both.  I was surprised
that the poll() interface performed nearly as well as epoll() for my
tests.

BTW, if you are going to play around with large numbers of connections,
and you are using Linux, drop the kernel per-connection buffer sizes.

-Eric

On Wed, Oct 29, 2003 at 07:57:58PM +1100, Andrew Bennetts wrote:
> On Tue, Oct 28, 2003 at 11:34:37PM -0800, Nathan Seven wrote:
> > 
> > Speaking of- I know we're kinda tied to Python, but
> > what are the thoughts about using any of the OS's
> > provided event-driven polls? (epoll,kqueue) 
> > I'm guessing these are essentially untouchable without
> > Python mods.
> 
> There's a kqueue reactor already -- see twisted/internet/kqreactor.py (yes,
> it does rely up on an extension module).  I'm not sure how complete it is,
> it's not tested by the buildbot.
> 
> epoll shouldn't be too hard to do with pretty much the same approach.
> Patches accepted :)
> 
> -Andrew.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From glyph at twistedmatrix.com  Wed Oct 29 07:18:15 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 29 Oct 2003 09:18:15 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029124947.GA5294@localhost.localdomain>
References: <20031029062817.23143.qmail@green.zadka.com> <20031029073437.52308.qmail@web13908.mail.yahoo.com> <20031029085758.GC3030@frobozz> <20031029124947.GA5294@localhost.localdomain>
Message-ID: <3F9FCC27.4080301@twistedmatrix.com>

Eric C. Newton wrote:
> I looked into this for a few hours.  I had to build a server that
> needed to regularly maintain 20K+ connections.  Of course, I prototyped
> it in python first.
> 
> It takes a long time just to create and accept 20K+ connections 
> in Python.  Epoll wasn't going to help that much.

Can you qualify "long time"?  And what's the bottleneck?  At the scale 
of 100K or so function calls, Python isn't egregiously slow, certainly 
not slow enough to not be able to outrun TCP connection setup...?




From glyph at twistedmatrix.com  Wed Oct 29 07:43:36 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 29 Oct 2003 09:43:36 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
References: <20031029073437.52308.qmail@web13908.mail.yahoo.com>
Message-ID: <3F9FD218.8060001@twistedmatrix.com>

Nathan Seven wrote:

> Hmmmm I would qualify that- I dont think the
> filesystem is the place to be handling dynamic data. 

The filesystem is a fine place.

For example, in the Prevayler persistence model, you just write logfiles 
to disk, and synchronize your state at a checkpoint.  For highly dynamic 
applications, especially ones which require failover, (You can re-play 
the transaction log live, after all) this works quite well.

> Databases were created *specifically* for this
> purpose.

I think that databases were specifically designed to store accounting 
information, actually.

> Sure, storing all your static blobs in your
> database is a really quick way to grind shit to a
> halt, but locking and concurrency?
> If you're doing things properly, and your http server
> is just serving static objects, then these are
> non-issues.

Databases can be amazingly slow, especially if you have a lot of updates 
to do.  (Even a very fast database can be made slow by I/O bottlenecks 
if you are trying to make it remote for scalability reasons.)  This has 
an easy solution: you can cache everything!  Of course, then you need to 
be able to easily access the cache from all of the machines, because it 
may have been updated.  Now you have problems with coherency.  Then you 
need to lock the cache, because it could have been updated, and then you 
need to read from it.

Pretty soon you're talking to your caching server as if it were a 
database.  This is _great_ if you are Livejournal:

> Yeah- through my line of work I deal with a *lot* of
> different infrastructures.  Everything from "Joe's BBQ
> Sauce Garage" to Amazon.  Literally the only
> organization I can think of that can keep anything
> coherent with MySQL is Livejournal- and then I believe
> only because Brad seems to be a cache-god with
> memcached and such.

because then you don't have to worry about computation, mutable data, 
etc - you're basically just storing data and then spitting it back out, 
and you don't care if the timestamps are a little off.

This is the important point about LAMP and Twisted:

There are applications which can connect to HTTP which are not blogs.

If you are writing a multiplayer game which wants to support lots of 
concurrent users, you can't afford to spawn a thread and do a database 
request every time a player picks something up.  (Python is quite slow 
enough already, thanks.)  You can't just use a cache because the data 
changes _all the time_, and you have to care about it from everywhere 
that you care about your data.  Working with your objects directly in 
memory is close to the only option.

If you're writing a real-time financial data system, you do want to use 
a database, but you want to very carefully control your access to it. 
Certainly, you don't want to equate 'web hit' with 'database query', as 
the LAMP model is wont to do.

Or maybe you're writing an application that has to operate as a 
client-side proxy, and you don't have the leisure of a DBA at every 
desk, so you can't require that an RDBMS gets set up with each 
installation.  This might require some hackish workarounds with the 
filesystem that you'd rather not do, but nevertheless, it's better than 
having the user editing pg_hba.conf themselves.





From golux at comcast.net  Tue Oct 28 09:00:45 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Tue, 28 Oct 2003 11:00:45 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FD218.8060001@twistedmatrix.com>
References: <20031029073437.52308.qmail@web13908.mail.yahoo.com> <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <3F9E92AD.3000708@comcast.net>

Glyph Lefkowitz wrote:

>> Databases were created *specifically* for this
>> purpose.
> 
> I think that databases were specifically designed to store accounting 
> information, actually.

Maybe in the 60's they were, but they have much more
power now than they did in those days.  (Codd and Date
would give you a more elaborate answer ... ;)

But the optimal choice for any given application
usually depends on a multitude of details, so these
generalizations have limited usefulness.

IOW, this is mainly a techno-religious discussion.  ;)

Cheers,
Steve.




From illumen at yahoo.com  Wed Oct 29 09:35:20 2003
From: illumen at yahoo.com (Rene Dudfield)
Date: Thu, 30 Oct 2003 02:35:20 +1000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FD218.8060001@twistedmatrix.com>
References: <20031029073437.52308.qmail@web13908.mail.yahoo.com> <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <3F9FEC48.7020403@yahoo.com>

Hello,

adding more random thoughts below on LAMP sucking, and spitting.


Glyph Lefkowitz wrote:

> Nathan Seven wrote:
>
>> Hmmmm I would qualify that- I dont think the
>> filesystem is the place to be handling dynamic data. 
>
>
> The filesystem is a fine place.
>
> For example, in the Prevayler persistence model, you just write 
> logfiles to disk, and synchronize your state at a checkpoint.  For 
> highly dynamic applications, especially ones which require failover, 
> (You can re-play the transaction log live, after all) this works quite 
> well.
>
>> Databases were created *specifically* for this
>> purpose.
>
>
> I think that databases were specifically designed to store accounting 
> information, actually.
>
>> Sure, storing all your static blobs in your
>> database is a really quick way to grind shit to a
>> halt, but locking and concurrency?
>> If you're doing things properly, and your http server
>> is just serving static objects, then these are
>> non-issues.
>
>
> Databases can be amazingly slow, especially if you have a lot of 
> updates to do.  (Even a very fast database can be made slow by I/O 
> bottlenecks if you are trying to make it remote for scalability 
> reasons.)  This has an easy solution: you can cache everything!  Of 
> course, then you need to be able to easily access the cache from all 
> of the machines, because it may have been updated.  Now you have 
> problems with coherency.  Then you need to lock the cache, because it 
> could have been updated, and then you need to read from it.
>
> Pretty soon you're talking to your caching server as if it were a 
> database.  This is _great_ if you are Livejournal:
>
>> Yeah- through my line of work I deal with a *lot* of
>> different infrastructures.  Everything from "Joe's BBQ
>> Sauce Garage" to Amazon.  Literally the only
>> organization I can think of that can keep anything
>> coherent with MySQL is Livejournal- and then I believe
>> only because Brad seems to be a cache-god with
>> memcached and such.
>
>
> because then you don't have to worry about computation, mutable data, 
> etc - you're basically just storing data and then spitting it back 
> out, and you don't care if the timestamps are a little off.
>
> This is the important point about LAMP and Twisted:
>
> There are applications which can connect to HTTP which are not blogs.
>
> If you are writing a multiplayer game which wants to support lots of 
> concurrent users, you can't afford to spawn a thread and do a database 
> request every time a player picks something up.  

New versions of linux have very quick threads.  Also different apps have 
different speeds for threads.  Small programs (say less than 100 
kilobytes) which are entirely static are lots faster than multi megabyte 
processes which dynamically load things.  Threads and processes also can 
easily use multiple cpus. 

Of course there are other reasons people don't like threads.

http for games?  If your game is sensitive to latency and you can help 
it, avoid http for games.  Http gives you much more latency than a db.  
So does a centralised server for that matter.  In a two player game you 
can half your latency by talking directly to each other.  Assuming you 
both aren't behind a non configurable firewall, or a proxy server.  http 
is good as a backup protocol though.  Because some fascists don't allow 
anything but access to the internet except through a proxy.  Or maybe 
you are playing a game in a web browser :)

Note that some dbs have async interfaces(eg postgres).  So you wouldn't 
need a thread.


btw, anyone know if sendfile is in (or going to be in python soon)?
http://mail.python.org/pipermail/python-dev/2002-March/021498.html

> (Python is quite slow enough already, thanks.)  You can't just use a 
> cache because the data changes _all the time_, and you have to care 
> about it from everywhere that you care about your data.  Working with 
> your objects directly in memory is close to the only option.

What about berkley dbs?  I think bsddb3 was 3-4 times slower than a 
python dict in general.  They are very quick, and you don't need to lock 
them.  You can use transactions.  Locking can kill performance.

Quickness depends on memory, and data sets really.  These are 
approximate speedinesses of python dictionary like things for different 
data sizes and memory:
say 700MB of memory:

200 MB key value data - python dicts, kjDicts, berklydb3 on disk db.
400 MB key value data - kjDicts(as python dicts use more memory and 
begin swapping), berkley db3-4 on disk, python dicts.
 > 2 gigs of key value data - berkley db3-4 on disk, kjDicts(the kjdict 
starts swapping before here), python dicts.

Of course deleting large python dicts is *really* slow.  I used to kill 
my python processes with kill -9 so that I didn't have to wait for the 
reference counting garbage collecting beast to do lots of free()s on the 
dicts memory.  kjDicts and bsddb dbs were faster for deleting.

Some people do use RDBMS for large online games.  Check out 
gamasutra.com for some articles.  Seems they have lots of fun 
performance problems.

Compressing the hash would be nice.  Maybe memory mapped files on a 
compressed file system would be quick for this ;) 

Distributed hashes would also be nice!  Any good distruted hashes for 
python?

I think memory is one of the first things that kill apache 
performance(when using preforking).  Especially when it has massive php 
compiled in!  You can get big speed boosts by using different apache 
configs for different request types(even on the same machine).  Eg set 
one up for static files(eg images), and one for your bloated php.

>
> If you're writing a real-time financial data system, you do want to 
> use a database, but you want to very carefully control your access to 
> it. Certainly, you don't want to equate 'web hit' with 'database 
> query', as the LAMP model is wont to do.
>
> Or maybe you're writing an application that has to operate as a 
> client-side proxy, and you don't have the leisure of a DBA at every 
> desk, so you can't require that an RDBMS gets set up with each 
> installation.  This might require some hackish workarounds with the 
> filesystem that you'd rather not do, but nevertheless, it's better 
> than having the user editing pg_hba.conf themselves.
>
SQLlite and berkley db are good for easy to bundle dbs.

One good thing about LAMP though is that lots of servers have it 
installed, and it can be quite cheap to use as a platform.

As you say, not everything is a blog.  There are too many different 
factors for a one size fits all 'this way is best' solution.  Besides 
everyone knows twisted rules ;)


Have fun!




From ecn at metaslash.com  Wed Oct 29 09:42:52 2003
From: ecn at metaslash.com (ecn at metaslash.com)
Date: Wed, 29 Oct 2003 11:42:52 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
Message-ID: <200310291642.h9TGgqkY005791@localhost.localdomain>

 > Can you qualify "long time"?  And what's the bottleneck?  At the scale 
 > of 100K or so function calls, Python isn't egregiously slow, certainly 
 > not slow enough to not be able to outrun TCP connection setup...?

Hmm, maybe a minute?  I forget exactly.  It was like 4x slower than C++.
(I'm running Linux 2.6test1 with dual AMD Athlon MP/2000's).

I posted a bug in the poll reactor some time ago.  I was testing
an epoll() subclass I had written at the time.

To test the server, I had written a C++ program to connect, 
asynchronously, over the loopback device.  I had to insert a 
pause in the connector to avoid connection failures.  Mind you,
I had to create several "fake" networks in order to have enough
ports for all those simultaneous connections.  This was an absurd
number of connections (10K, 20K, 40K, etc).

The default TCP connection timeout on Linux is ... what? like 61 
seconds or something? That was the number I was hitting.

Everything ran well, up to about 8-10K.  Then it would fall behind,
and then I was at the mercy of TCP retries.

This customer was particularly performance oriented, so I didn't think
that python was going to fly with them, anyhow.  But it is so much
simpler to code/debug/test, I wanted to see how well it would perform.

I tweaked the acceptor to just accept all the connections it could, 
and that was too slow.  It didn't even get into the event loop.  

I also tweaked ACE to accept connections faster, too.  It's 
just a tough problem.

-Eric




From scosol at yahoo.com  Wed Oct 29 09:48:54 2003
From: scosol at yahoo.com (Nathan Seven)
Date: Wed, 29 Oct 2003 08:48:54 -0800 (PST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <20031029164854.21001.qmail@web13905.mail.yahoo.com>

--- Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:
> Nathan Seven wrote:
> 
> > Databases were created *specifically* for this
> > purpose.
> 
> I think that databases were specifically designed to
> store accounting 
> information, actually.

Exactly, handling and tracking dynamic data :)

> If you are writing a multiplayer game which wants to
> support lots of 
> concurrent users, you can't afford to spawn a thread
> and do a database 
> request every time a player picks something up. 
> (Python is quite slow 
> enough already, thanks.)  You can't just use a cache
> because the data 
> changes _all the time_, and you have to care about
> it from everywhere 
> that you care about your data.  Working with your
> objects directly in 
> memory is close to the only option.

I dunno- I guess I just disagree- a multiplayer game
is a perfect example of something that absolutely
requires atomic transactions.  "Buy an item->add item
to inventory->deduct $ from player" etc. That
transaction either needs to totally complete, or not
complete at all.  So now you need to build some sort
of transaction manager on top of your in-memory
objects.  Oh and then you probably want some way to
ensure that these in-memory objects dont get lost in
the case of abnormal shutdown- right?
Well- haven't you just built a couple features of any
(real) database?

> If you're writing a real-time financial data system,
> you do want to use 
> a database, but you want to very carefully control
> your access to it. 
> Certainly, you don't want to equate 'web hit' with
> 'database query', as 
> the LAMP model is wont to do.

Yes hahah- I think my overall point is just that the
seperation is key.

> Or maybe you're writing an application that has to
> operate as a 
> client-side proxy, and you don't have the leisure of
> a DBA at every 
> desk, so you can't require that an RDBMS gets set up
> with each 
> installation.  This might require some hackish
> workarounds with the 
> filesystem that you'd rather not do, but
> nevertheless, it's better than 
> having the user editing pg_hba.conf themselves.

Sure- though that specifically is the reason for
embeddable databases.

=====
--
live- http://www.thedenofsin.org/
to- AIM: IMFDUP
_born to violate._



From dp at twistedmatrix.com  Wed Oct 29 10:01:36 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 29 Oct 2003 12:01:36 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029164854.21001.qmail@web13905.mail.yahoo.com>
References: <20031029164854.21001.qmail@web13905.mail.yahoo.com>
Message-ID: <8E696247-0A31-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 29, 2003, at 11:48 AM, Nathan Seven wrote:

> I dunno- I guess I just disagree- a multiplayer game
> is a perfect example of something that absolutely
> requires atomic transactions.

But not SQL -- that's the whole point.

dp




From illumen at yahoo.com  Wed Oct 29 10:33:14 2003
From: illumen at yahoo.com (Rene Dudfield)
Date: Thu, 30 Oct 2003 03:33:14 +1000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <200310291642.h9TGgqkY005791@localhost.localdomain>
References: <200310291642.h9TGgqkY005791@localhost.localdomain>
Message-ID: <3F9FF9DA.3070204@yahoo.com>

ecn at metaslash.com wrote:

> > Can you qualify "long time"?  And what's the bottleneck?  At the scale 
> > of 100K or so function calls, Python isn't egregiously slow, certainly 
> > not slow enough to not be able to outrun TCP connection setup...?
>
>Hmm, maybe a minute?  I forget exactly.  It was like 4x slower than C++.
>(I'm running Linux 2.6test1 with dual AMD Athlon MP/2000's).
>  
>

Probably be quite a bit quicker with psyco.  Psyco is generally quite a 
bit quicker for looping things like this. 

Is there no batch interface for creating connections?  Something where 
you pass it an array of your required connections, then let it fly.  
Batching apis are good for things like this where function call, and 
function setup are so large.





From matthew.s.hegedus at lmco.com  Wed Oct 29 10:44:39 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Wed, 29 Oct 2003 11:44:39 -0600
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use style sheets
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F6@EMSS07M12.us.lmco.com>

If I may I'd like to request that future doc updates include more info on
microdom.lmx.

Is there a special way to have lmx generate xhtml with a specific style
class?

More specifically, if I have...

     <style type="text/css">
         tr.mySpecialTableRowStyleClass {color: white; background-color:
black}
     </style>

...in a xhtml template header, then how would I let a 'tr' lmx node know
that I want my custom style?

I tried t.tr['class'] = "mySpecialTableRowStyleClass" but then I got bitched
at with an "object does not support item assignment". Thanks,

Matthew



From dp at twistedmatrix.com  Wed Oct 29 10:59:45 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 29 Oct 2003 12:59:45 -0500
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use style sheets
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24F6@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F6@EMSS07M12.us.lmco.com>
Message-ID: <AE38EA93-0A39-11D8-9397-000A95864FC4@twistedmatrix.com>

On Oct 29, 2003, at 12:44 PM, Hegedus, Matthew S wrote:

> I tried t.tr['class'] = "mySpecialTableRowStyleClass" but then I got 
> bitched
> at with an "object does not support item assignment". Thanks,

t.tr(_class="mySpecialTableRowStyleClass")

Since class is a python keyword, the special case of having a leading 
underscore is used.

dp




From bob at redivi.com  Wed Oct 29 11:13:44 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 29 Oct 2003 13:13:44 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FF9DA.3070204@yahoo.com>
References: <200310291642.h9TGgqkY005791@localhost.localdomain> <3F9FF9DA.3070204@yahoo.com>
Message-ID: <A1D3A192-0A3B-11D8-B11C-000A95686CD8@redivi.com>

On Oct 29, 2003, at 12:33 PM, Rene Dudfield wrote:

> ecn at metaslash.com wrote:
>
>> > Can you qualify "long time"?  And what's the bottleneck?  At the 
>> scale > of 100K or so function calls, Python isn't egregiously slow, 
>> certainly > not slow enough to not be able to outrun TCP connection 
>> setup...?
>>
>> Hmm, maybe a minute?  I forget exactly.  It was like 4x slower than 
>> C++.
>> (I'm running Linux 2.6test1 with dual AMD Athlon MP/2000's).
>>
>
> Probably be quite a bit quicker with psyco.  Psyco is generally quite 
> a bit quicker for looping things like this.
> Is there no batch interface for creating connections?  Something where 
> you pass it an array of your required connections, then let it fly.  
> Batching apis are good for things like this where function call, and 
> function setup are so large.

In any case, a benchmark that opens a whole bunch of sockets and does 
nothing with them is pretty retarded.  I'm actually pretty impressed 
that Python was only 4x slower at this kind of task, it has a whole lot 
of overhead (without psyco) for tight loops like that.

-bob




From twisted at goldenspud.com  Wed Oct 29 11:29:20 2003
From: twisted at goldenspud.com (Matthew Scott)
Date: Wed, 29 Oct 2003 12:29:20 -0600
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use style sheets
In-Reply-To: <AE38EA93-0A39-11D8-9397-000A95864FC4@twistedmatrix.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F6@EMSS07M12.us.lmco.com> <AE38EA93-0A39-11D8-9397-000A95864FC4@twistedmatrix.com>
Message-ID: <200310291229.20334.twisted@goldenspud.com>

On Wednesday 29 October 2003 11:59 am, Donovan Preston wrote:
> On Oct 29, 2003, at 12:44 PM, Hegedus, Matthew S wrote:
> > I tried t.tr['class'] = "mySpecialTableRowStyleClass" but then I got
> > bitched
> > at with an "object does not support item assignment". Thanks,
>
> t.tr(_class="mySpecialTableRowStyleClass")
>
> Since class is a python keyword, the special case of having a leading
> underscore is used.

I ran into this recently too :)

Just an extra note, the leading underscore is not required when setting the 
class attribute of an existing node:

node = t.tr()
node['class'] = 'mySpecialTableRowStyleClass'

-- 
Matthew Scott
http://goldenspud.com/




From phil at bubblehouse.org  Wed Oct 29 14:08:32 2003
From: phil at bubblehouse.org (phil at bubblehouse.org)
Date: Wed, 29 Oct 2003 16:08:32 -0500 (EST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
References: <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
Message-ID: <1615.65.246.170.211.1067461712.squirrel@192.168.0.2>

well, my only use of the db object directly is for actually updating the
table. my particular implementation would have far more views than
updates, so i was going to cache the common data, or possibly pre-render
html...

wouldn't you say that these performance issues are as much of a
consequence of poor design as much as the choice to use SQL? obviously db
calls are expensive...but some of the benefits of a portable datasource
are worthwhile. as nice as it would be to live in a world where pickle was
a common data format, we're not there yet...


> Date: 29 Oct 2003 06:28:17 -0000
> From: Moshe Zadka <m at zadka.site.co.il>
> Subject: Re: [Twisted-Python] twisted.web and MySQLdb
> To: twisted-python at twistedmatrix.com
> Reply-To: twisted-python at twistedmatrix.com
>
> I won't reply to your question here, I'm sure someone more competent
> than me can do so.
> I will take a minute to note that for some reason, the instinct of
> web developers has been to immediately write applications in the
> LAMP model. While twisted.web is a perfectly good substitute for
> A, and can indeed be used this way, it is much more capable.
>
> LAMP -- Linux Apache MySQL PHP [each of those has variants]
>
> Linux (and most other things in the "L" place, such as FreeBSD) has
> an incredibly fast fork() operation. This leads people to write their
> web code with the process-per-page model. Apache optimizes this by
> preforking, making such code actually scalable enough to deliver good
> response times. However, suddenly there is a problem: since different
> processes are likely to deal with the same user, memory becomes fragile.
> It is unsafe to put things in memory: processes switch users, get born
> and die too often. In Linux, and most other Unices, file locking has
> been a thorny issue. So instead of putting data in files, where the
> subtle semantics of locking and concurrency should be dealt with,
> data tends to end up in the database. That means *all* data. Sessions.
> Temporary "show this message when the user finished his redirect loop".
> Etc. etc. Once all the data is in MySQL, which is the easiest database to
> set up, it becomes natural for the average page to be a "glorified
> select".
> PHP was designed for this exact scenario: take a select table and spruce
> it up with HTML.
>
> Unfortunately, what LAMP deals to is exactly to this: inevitably, all
> pages are just spruced up select-tables. This makes programming somewhat
> unnatural unless you're programming a database viewer.
>
> With twisted.web, you don't have these problems. It is easy to keep data
> in files, because locking is not an issue. It is easy to cache data in
> memory
> because everything is served from a single process. If you need to attach
> state to a user's session, you can just keep an object in the session.
> This means programming twisted.web should be a lot more like writing
> a GUI application, and a lot less like writing select-with-HTML.
> You should probably reconsider whether you really want MySQL. It adds
> complexity to your application, and the gain is usually small. Putting
> persistent data in files, and using liberal caching schemes, also plays
> on the core advantage of Linux (and similar) -- it uses the incredibly
> optimized caching algorithms.




From phil at bubblehouse.org  Wed Oct 29 14:08:33 2003
From: phil at bubblehouse.org (phil at bubblehouse.org)
Date: Wed, 29 Oct 2003 16:08:33 -0500 (EST)
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
References: <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
Message-ID: <1616.65.246.170.211.1067461713.squirrel@192.168.0.2>

well, my only use of the db object directly is for actually updating the
table. my particular implementation would have far more views than
updates, so i was going to cache the common data, or possibly pre-render
html...

wouldn't you say that these performance issues are as much of a
consequence of poor design as much as the choice to use SQL? obviously db
calls are expensive...but some of the benefits of a portable datasource
are worthwhile. as nice as it would be to live in a world where pickle was
a common data format, we're not there yet...


> Date: 29 Oct 2003 06:28:17 -0000
> From: Moshe Zadka <m at zadka.site.co.il>
> Subject: Re: [Twisted-Python] twisted.web and MySQLdb
> To: twisted-python at twistedmatrix.com
> Reply-To: twisted-python at twistedmatrix.com
>
> I won't reply to your question here, I'm sure someone more competent
> than me can do so.
> I will take a minute to note that for some reason, the instinct of
> web developers has been to immediately write applications in the
> LAMP model. While twisted.web is a perfectly good substitute for
> A, and can indeed be used this way, it is much more capable.
>
> LAMP -- Linux Apache MySQL PHP [each of those has variants]
>
> Linux (and most other things in the "L" place, such as FreeBSD) has
> an incredibly fast fork() operation. This leads people to write their
> web code with the process-per-page model. Apache optimizes this by
> preforking, making such code actually scalable enough to deliver good
> response times. However, suddenly there is a problem: since different
> processes are likely to deal with the same user, memory becomes fragile.
> It is unsafe to put things in memory: processes switch users, get born
> and die too often. In Linux, and most other Unices, file locking has
> been a thorny issue. So instead of putting data in files, where the
> subtle semantics of locking and concurrency should be dealt with,
> data tends to end up in the database. That means *all* data. Sessions.
> Temporary "show this message when the user finished his redirect loop".
> Etc. etc. Once all the data is in MySQL, which is the easiest database to
> set up, it becomes natural for the average page to be a "glorified
> select".
> PHP was designed for this exact scenario: take a select table and spruce
> it up with HTML.
>
> Unfortunately, what LAMP deals to is exactly to this: inevitably, all
> pages are just spruced up select-tables. This makes programming somewhat
> unnatural unless you're programming a database viewer.
>
> With twisted.web, you don't have these problems. It is easy to keep data
> in files, because locking is not an issue. It is easy to cache data in
> memory
> because everything is served from a single process. If you need to attach
> state to a user's session, you can just keep an object in the session.
> This means programming twisted.web should be a lot more like writing
> a GUI application, and a lot less like writing select-with-HTML.
> You should probably reconsider whether you really want MySQL. It adds
> complexity to your application, and the gain is usually small. Putting
> persistent data in files, and using liberal caching schemes, also plays
> on the core advantage of Linux (and similar) -- it uses the incredibly
> optimized caching algorithms.




From matthew.s.hegedus at lmco.com  Wed Oct 29 16:37:05 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Wed, 29 Oct 2003 17:37:05 -0600
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use	style sheets
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24F8@EMSS07M12.us.lmco.com>

Setting color through microdom.lmx just doesn't seem to be working for me. I
can view the source of the web page xhtml generated (browser right-click,
view source), and everything looks good, but I just don't see the browser
actually rendering page features in the color I specified. All of the lmx
generated xhtml is literally rendered black and white. I am using style
sheets. Do I need to do some sort of rerender trick?

<UPDATE before I send this out: It appears NONE of the style sheet stuff has
any effect on the look of the web page when implemented using microdom.lmx.>

To clarify, I receive no errors and from the looks of things the xhtml code
generated by lmx seems legit. Here is the key snippets of code(hopefully
formatting will remain intact):

XHTML template:

<html>
   <head>
      <style type="text/css">
         table.exerciseTableClass {border: 0; cellspacing: 2;}
         table.exerciseTableClass tr.tableHeadingClass {color: white;
background-color: darkslateblue;}
      </style>
   </head>
   <body>
      <h1 ~some stuff~></h1>
      <table model="amodel"
             view="aview">
      </table>
   </body>
</html>
   
Python code:

...
   def wvupdate_aview(sel, request, node, data):
       lmxnode = lmx(node)
       d = lmxnode.div()

       #These next two lines don't seem to do anything in terms of style.
       #It's as if I just made a plain-old table, and a couple of plain-old
rows
       t = d.table(_class='exerciseTableClass')    
       t.tr(_class='tableHeadingClass')

       t.td().text(data.label1)
       t.td().text(data.label2)
       ...

Have any of you run into similar troubles, and if so what did it take to fix
the problem? Thank you,

Matthew

-----Original Message-----
From: Matthew Scott [mailto:twisted at goldenspud.com] 
Sent: Wednesday, October 29, 2003 12:29 PM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] Woven, using microdom.lmx, and trying to use
style sheets


On Wednesday 29 October 2003 11:59 am, Donovan Preston wrote:
> On Oct 29, 2003, at 12:44 PM, Hegedus, Matthew S wrote:
> > I tried t.tr['class'] = "mySpecialTableRowStyleClass" but then I got 
> > bitched at with an "object does not support item assignment". 
> > Thanks,
>
> t.tr(_class="mySpecialTableRowStyleClass")
>
> Since class is a python keyword, the special case of having a leading 
> underscore is used.

I ran into this recently too :)

Just an extra note, the leading underscore is not required when setting the 
class attribute of an existing node:

node = t.tr()
node['class'] = 'mySpecialTableRowStyleClass'

-- 
Matthew Scott
http://goldenspud.com/


_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From andrew-twisted at puzzling.org  Wed Oct 29 17:11:32 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 30 Oct 2003 11:11:32 +1100
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <200310291642.h9TGgqkY005791@localhost.localdomain>
References: <200310291642.h9TGgqkY005791@localhost.localdomain>
Message-ID: <20031030001132.GA5731@frobozz>

On Wed, Oct 29, 2003 at 11:42:52AM -0500, ecn at metaslash.com wrote:
> 
> I posted a bug in the poll reactor some time ago.  I was testing
> an epoll() subclass I had written at the time.

Did it get fixed?  If not, please add it to http://twistedmatrix.com/bugs so
that it isn't forgotten in the archives of the list somewhere...

-Andrew.




From ecn at metaslash.com  Wed Oct 29 17:46:24 2003
From: ecn at metaslash.com (Eric C. Newton)
Date: Wed, 29 Oct 2003 19:46:24 -0500
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <20031030001132.GA5731@frobozz>
References: <200310291642.h9TGgqkY005791@localhost.localdomain> <20031030001132.GA5731@frobozz>
Message-ID: <20031030004624.GA7101@localhost.localdomain>

On Thu, Oct 30, 2003 at 11:11:32AM +1100, Andrew Bennetts wrote:
> On Wed, Oct 29, 2003 at 11:42:52AM -0500, ecn at metaslash.com wrote:
> > 
> > I posted a bug in the poll reactor some time ago.  I was testing
> > an epoll() subclass I had written at the time.
> 
> Did it get fixed?  If not, please add it to http://twistedmatrix.com/bugs so
> that it isn't forgotten in the archives of the list somewhere...

Yes, it has been fixed.  Thanks.

-Eric



From dp at twistedmatrix.com  Wed Oct 29 20:11:05 2003
From: dp at twistedmatrix.com (Donovan Preston)
Date: Wed, 29 Oct 2003 22:11:05 -0500
Subject: [Twisted-Python] Woven, using microdom.lmx, and trying to use	style sheets
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D24F8@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D24F8@EMSS07M12.us.lmco.com>
Message-ID: <B329BF1D-0A86-11D8-87A1-000A95864FC4@twistedmatrix.com>

On Oct 29, 2003, at 6:37 PM, Hegedus, Matthew S wrote:

>        t = d.table(_class='exerciseTableClass')
>        t.tr(_class='tableHeadingClass')
>
>        t.td().text(data.label1)
>        t.td().text(data.label2)

Your table is borken. It will render like this

<table class="excerciseTableClass">
	<tr class="tableHeadingClass" />
	<td>whatever label 1 was</td>
	<td>whatever label 2 was</td>
</table>

Notice you're not actually putting the td nodes inside the row. You 
want your code to save the return value from the call to tr (the tr 
node) and put the tds inside that:

t = d.table(_class="exerciseTableClass")
tr = t.tr(_class="tableHeadingClass")

tr.td().text(data.label1)
tr.td().text(data.label2)

dp




From stuart.hungerford at anu.edu.au  Wed Oct 29 21:52:32 2003
From: stuart.hungerford at anu.edu.au (Stuart Hungerford)
Date: Thu, 30 Oct 2003 15:52:32 +1100
Subject: [Twisted-Python] request getUser()/getPassword() in Woven and resources...
Message-ID: <6.0.0.22.0.20031030154614.01e1f788@anusf.anu.edu.au>

Hi all,

I've had a twisted web application running for a while that
uses request.getUser() and request.getPassword() in a
resource subclass render() method to make the web browser
prompt for a username/password.

I've been refactoring this application to use Woven page
subclasses and the same request.getFoo() calls now
return empty strings rather than None, and no prompting
from the browser is done.

Is there some gotcha in using request.getUser() and
request.getPassword() from Woven page subclasses?


Cheers,

Stu

--
:: Stuart Hungerford (stuart.hungerford at anu.edu.au)
:: ANU Internet Futures Group




From twisted at zadka.site.co.il  Wed Oct 29 23:45:19 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 30 Oct 2003 06:45:19 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FEC48.7020403@yahoo.com>
References: <3F9FEC48.7020403@yahoo.com>, <20031029073437.52308.qmail@web13908.mail.yahoo.com> <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <20031030064519.22248.qmail@green.zadka.com>

On Thu, 30 Oct 2003, Rene Dudfield <illumen at yahoo.com> wrote:

> Threads and processes also can easily use multiple cpus. 

This is a common objection, so I thought I will point out the fallacy
here: common multiple CPU are on the order of 4, maybe 8, CPUs. Rarely
do we get to 64-land, and only for extremely high-end servers. Common
web servers are expected to deal with 100s of requests concurrently,
and that's the *low-end* stuff. High-end means tens of thousands of
requests concurrently. This means (number of requests)>>(number of CPUs).
Since you want, for high-performance, for threads (or processes) to
get tied to a CPU, the optimal number of runnable processes is
#CPUS-1 (this is so the "odd task" will get the free CPU instead
of displacing one of the long-running tasks). So, if you really want
to use your SMP hardware, the best thing is to set up several servers,
one per CPU (minus 1). Twisted can do it, the worst case you'll need
to hack up a ten-minute custom IListener and use listenWith, if you
don't have more efficient round-robin schemes. If those really need
to talk to each other, they can use mmap with the right flags to
communicate. There is almost never a reason to use threads here.
(The optimal thing would be to divide along URL boundaries, if you
have a smart enough reverse-proxy, so that the different servers have
as little need to communicate as possible).



From twisted at zadka.site.co.il  Wed Oct 29 23:45:19 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 30 Oct 2003 06:45:19 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <3F9FEC48.7020403@yahoo.com>
References: <3F9FEC48.7020403@yahoo.com>, <20031029073437.52308.qmail@web13908.mail.yahoo.com> <3F9FD218.8060001@twistedmatrix.com>
Message-ID: <20031030064519.22248.qmail@green.zadka.com>

On Thu, 30 Oct 2003, Rene Dudfield <illumen at yahoo.com> wrote:

> Threads and processes also can easily use multiple cpus. 

This is a common objection, so I thought I will point out the fallacy
here: common multiple CPU are on the order of 4, maybe 8, CPUs. Rarely
do we get to 64-land, and only for extremely high-end servers. Common
web servers are expected to deal with 100s of requests concurrently,
and that's the *low-end* stuff. High-end means tens of thousands of
requests concurrently. This means (number of requests)>>(number of CPUs).
Since you want, for high-performance, for threads (or processes) to
get tied to a CPU, the optimal number of runnable processes is
#CPUS-1 (this is so the "odd task" will get the free CPU instead
of displacing one of the long-running tasks). So, if you really want
to use your SMP hardware, the best thing is to set up several servers,
one per CPU (minus 1). Twisted can do it, the worst case you'll need
to hack up a ten-minute custom IListener and use listenWith, if you
don't have more efficient round-robin schemes. If those really need
to talk to each other, they can use mmap with the right flags to
communicate. There is almost never a reason to use threads here.
(The optimal thing would be to divide along URL boundaries, if you
have a smart enough reverse-proxy, so that the different servers have
as little need to communicate as possible).



From twisted at zadka.site.co.il  Thu Oct 30 00:00:00 2003
From: twisted at zadka.site.co.il (Moshe Zadka)
Date: 30 Oct 2003 07:00:00 -0000
Subject: [Twisted-Python] twisted.web and MySQLdb
In-Reply-To: <1616.65.246.170.211.1067461713.squirrel@192.168.0.2>
References: <1616.65.246.170.211.1067461713.squirrel@192.168.0.2>, <20031029070602.10605.70553.Mailman@pyramid.twistedmatrix.com>
Message-ID: <20031030070000.22447.qmail@green.zadka.com>

On Wed, 29 Oct 2003, phil at bubblehouse.org wrote:

> well, my only use of the db object directly is for actually updating the
> table. my particular implementation would have far more views than
> updates, so i was going to cache the common data, or possibly pre-render
> html...

At the point where you're caching stuff yourself, it should be obvious
that you're writing a database...so why not admit it to yourself
and just finish writing it? :)
Just cache everything in-memory, and write to files in a fail-safe way
(UNIX, luckily, has enough useful primitives for that like writing
to a tempfile, then renaming when you're done). This will let you
use the operating system's mechanisms for LRU, which is probably
more or less the right thing to do in a web application (LRU anticipates
stuff like slashdotting, for example :)
Twisted even has stuff to do such filesystem-transactions for you:
twisted.persisted.dirdbm and twisted.python.filepath.FilePath.setContent

> as nice as it would be to live in a world where pickle was
> a common data format, we're not there yet...

Pickle is just as much a common file format as MySQL's internal
format. That is to say, there's just one way to access it, but
you can program object viewers easily. In any case, there's no
need to write pickles to the files. You can, for example, have
each row be a list of netstrings in a file -- Twisted also has
code to decode and encode netstrings.



From max at ucmg.com.ua  Thu Oct 30 01:26:28 2003
From: max at ucmg.com.ua (Max Ischenko)
Date: Thu, 30 Oct 2003 10:26:28 +0200
Subject: [Twisted-Python] migration from IIS to Twisted
Message-ID: <3FA0CB34.20902@ucmg.com.ua>

Hi,

I have a really big ASP/IIS-based system which I'm trying to (partially) 
rewrite and evolve with python.

I've already wrote some useful code in using Cheetah/WebKit and now I'm 
thinking about the best way to integrate it back into the legacy system.

As my python code depends on WebKit very little and Cheetah is a 
standalone processor that could probably be plugged into Twisted easily 
I'm evaluating the possibility to switch to Twisted.

There is nothing wrong with Webware/WebKit -- it is a great platform, 
but I'd like to make use of some Twisted components, like 
twisted.enterprise.row or twisted.cred.

If I'm to switch to Twisted what could you suggest for IIS-Twisted 
integration?

I'm currently thinking about simple Response.Redirect('...') from .asp 
to twisted.web. But I'd also like to share data and session's state 
between the two. For example, to match  twisted.web.server.Session with 
  IIS session. Dunno how this could be done though.

More promising (may be) but surely more complex way would be to write 
some kind of IIS-Twisted adapter that uses COM to talk to VB and 
twisted.spread to talk to Twisted.




From tv at tv.debian.net  Wed Oct 29 09:58:38 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Wed, 29 Oct 2003 18:58:38 +0200
Subject: [Twisted-Python] Integrating simpleguard with existing Woven
 pages...
In-Reply-To: <6.0.0.22.0.20031028125753.01e1ff08@anusf.anu.edu.au>
References: <6.0.0.22.0.20031028125753.01e1ff08@anusf.anu.edu.au>
Message-ID: <3F9FF1BE.2080009@tv.debian.net>

Stuart Hungerford wrote:
> I need to add a simple username/password authentication to
> some, but not all of these pages.  With the correct username
> and password you can view the page, without them you can't view
> it.

Sounds like sandbox/tv/simplyguarded/ from CVS.




From v6kk1hg02 at sneakemail.com  Wed Oct 29 15:26:42 2003
From: v6kk1hg02 at sneakemail.com (Mark Evans)
Date: 29 Oct 2003 22:26:42 -0000
Subject: [Twisted-Python] Dual Reactor Script
Message-ID: <14662-78995@sneakemail.com>


This question pertains to the use of dual reactors in a
single Python script.  The script runs on Windows 2000 and
has the nature of a daemon which translates between two
protocols on either side of it.

Side A = Telnet protocol ("raw" type)
    over TCP transport to embedded device
    ASCII data
Side B = Custom binary protocol (bits, bytes)
    over UDP transport
    binary data

Now the Twisted Matrix samples I've examined all do this
in their main entry:

   reactor.listenTransport(port, protocolFactory)
   reactor.run()

However I have TWO transports and TWO protocols.  So the
question is how to properly configure the reactor(s) in my
script.  Any advice, in particular?  How should such a
daemon be structured properly in TM?  Threads?  Two
scripts?  Please advise.  I'm sure there's a simple way
but always like to cover my bases with the gurus.  Probably
I need only one reactor, configured in a particular way to
handle two protocols and transports.

Thanks!
Mark



From dddgomes at yahoo.com.br  Wed Oct 29 18:02:08 2003
From: dddgomes at yahoo.com.br (=?iso-8859-1?q?Daniel=20Gomes?=)
Date: Wed, 29 Oct 2003 22:02:08 -0300 (ART)
Subject: [Twisted-Python] HTTP Server - UDP
Message-ID: <20031030010208.78264.qmail@web21310.mail.yahoo.com>

Thomas Weholt,

Hello! My name is Daniel Gomes and I am a Computer
engineering studend in Brazil.  I am researching about
a UDP HTTP Server and and I read that you have done
one.
I was wondering if you could tell me where to find
some information about this or even let me see you
server (if you dont mind).

Best Regards,

Daniel Gomes
dddgomes at yahoo.com.br

Recife - PE - Brasil

Yahoo! Mail - o melhor webmail do Brasil
http://mail.yahoo.com.br



From radix at twistedmatrix.com  Thu Oct 30 05:27:23 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 30 Oct 2003 07:27:23 -0500
Subject: [Twisted-Python] Dual Reactor Script
In-Reply-To: <14662-78995@sneakemail.com>
References: <14662-78995@sneakemail.com>
Message-ID: <20031030122723.GA15670@twistedmatrix.com>

On Wed, Oct 29, 2003 at 10:26:42PM -0000, Mark Evans wrote:
> Now the Twisted Matrix samples I've examined all do this
> in their main entry:
> 
>    reactor.listenTransport(port, protocolFactory)
>    reactor.run()
> 
> However I have TWO transports and TWO protocols.  So the

Just call reactor.listenFoo twice. No threads, or any garbage like
that. The reactor can handle an arbitrary[1] number of listeners and
connections.

[1]: Some reactors, like win32eventreactor (which *isn't* used by
default, on Windows: SelectReactor is), have arbitrary limits. I think
you can only have 64 connections in that one, or something like that.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From syver at inout.no  Thu Oct 30 13:20:11 2003
From: syver at inout.no (Syver Enstad)
Date: 30 Oct 2003 21:20:11 +0100
Subject: [Twisted-Python] Woven and deferreds in controllers.
Message-ID: <uad7iwk90.fsf@inout.no>

I've heard on this list that it is possible to use deferreds in
controllers. Let's say I have a page class that needs to load a
deferred object before any of it's wmfactory_ methods make any
sense. What I have done previously is to store the deferred and chain
new deferreds on every wmfactory method and return them instead of a
real value. If deferred in controlers work the way I hope I could load
the actual domain object from the deferred and store it in my page
class before any of the wmfactory methods are called which would be
nice.

So my question is how do I use a controller for this (if it is
possible). Btw. I've yet to upgrade to 1.1 because the application is
still using the old cred system.







From radix at twistedmatrix.com  Thu Oct 30 13:43:40 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Thu, 30 Oct 2003 15:43:40 -0500
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <uad7iwk90.fsf@inout.no>
References: <uad7iwk90.fsf@inout.no>
Message-ID: <20031030204340.GD15670@twistedmatrix.com>

On Thu, Oct 30, 2003 at 09:20:11PM +0100, Syver Enstad wrote:
> Btw. I've yet to upgrade to 1.1 because the application is
> still using the old cred system.

Old cred isn't gone! It's just deprecated. Please upgrade, you
shouldn't have problems with backwards compatibility. If you do,
please tell us :)

Sorry for not answering your actual question, I can't.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From keson at post.pl  Thu Oct 30 14:58:08 2003
From: keson at post.pl (marcin andrzejewski)
Date: Thu, 30 Oct 2003 22:58:08 +0100
Subject: [Twisted-Python] win32 twisted 1.1.0 import error
Message-ID: <1849086578.20031030225808@post.pl>

hi,
i am quite new to twisted and have one lame question.
why importing modules from directory of .rpy file doesn't work in
twisted 1.1.0 for win32? it works perfectly fine in 1.0.7..

-- 
regards,
marcin andrzejewski     
mailto:keson at post.pl




From matthew.s.hegedus at lmco.com  Thu Oct 30 17:48:07 2003
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Thu, 30 Oct 2003 18:48:07 -0600
Subject: [Twisted-Python] Woven, using microdom.lmx, and HTTP requests
Message-ID: <401C60E417B68B48B14B53D845FF596A8D24FA@EMSS07M12.us.lmco.com>

Well it's almost the weekend and this is my work email, so I must kick off a
few questions before I leave. Let me start off by thanking you all again for
being so helpful. I recognize you are busy people, so for taking time to
help me and others, I salute you ;).

Up to this point I've coded up a Twisted test program that has a global list
of lists:

  ex: [['a','b','c'],['d','e','f'],['g','h','i'], ...]

I generate dynamic xhtml, creating a form(method='get') containing a table
for my list data. Each sublist is a row of this table, and at the end of
each row (also a part of the table) is a 'REMOVE' button.

  Microdom.lmx code for 'REMOVE' button: 
      tr.td().input(type='submit', \
                    name=str(buttonID), \
                    value="REMOVE", \
                    view='rmExercise', \
                    model='listData')

... The corresponding view code for the buttons:

      def wvupdate_rmExercise(self, request, node, listData):
          print request.args
          print request.args.keys()
          if ~pseudocode~ request.args.keys()[0] is valid ~psuedocode~:
              del listData[int(request.args.keys()[0])]
              request.args.clear()

The page with the table gets served up and looks ok, but strange things
happen (unexpected HTTP events) when I hit the browser's reload button. I
can get into situations where hitting reload will generate three input
submit events as if I clicked my remove button three times. This events lead
to the deletion of a few sublists. What in the world could be going on?

Another question: When the input buttons view is called, list data is
modified, but the page does not get re-rendered. Is adding the line...

      self.render(request)

...the correct way to handle this issue?

And another question: I am browsing the pages on the same machine that I'm
serving them from. It seems that sometimes reloading the page in the browser
takes a while (more than 10 seconds in some cases). Is there some reason for
this?

Thanks again,
Matthew



From andrew-twisted at puzzling.org  Thu Oct 30 18:16:58 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 31 Oct 2003 12:16:58 +1100
Subject: [Twisted-Python] Dual Reactor Script
In-Reply-To: <20031030122723.GA15670@twistedmatrix.com>
References: <14662-78995@sneakemail.com> <20031030122723.GA15670@twistedmatrix.com>
Message-ID: <20031031011658.GA9027@frobozz>

On Thu, Oct 30, 2003 at 07:27:23AM -0500, Christopher Armstrong wrote:
> 
> [1]: Some reactors, like win32eventreactor (which *isn't* used by
> default, on Windows: SelectReactor is), have arbitrary limits. I think
> you can only have 64 connections in that one, or something like that.

But on Windows, select is limited to 64 sockets as well (I suspect it simply
calls WaitForMultipleObjects under the hood...).  You need to use threads or
IO Completion Ports to overcome this limit.

-Andrew.




From foom at fuhm.net  Thu Oct 30 18:41:57 2003
From: foom at fuhm.net (James Y Knight)
Date: Thu, 30 Oct 2003 20:41:57 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] THE EXTENSION IS .C!  IT IS NOT A C++ FILE!
In-Reply-To: <E1AFM4c-0007Hw-00@wolfwood>
References: <E1AFM4c-0007Hw-00@wolfwood>
Message-ID: <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>

What compiler doesn't support C99 comments yet?

James

On Oct 30, 2003, at 6:19 PM, exarkun CVS wrote:

> Modified files:
> Twisted/twisted/protocols/_c_urlarg.c 1.7 1.8
>
> Log message:
> THE EXTENSION IS .C!  IT IS NOT A C++ FILE!




From itamar at itamarst.org  Thu Oct 30 18:43:42 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 30 Oct 2003 20:43:42 -0500
Subject: [Twisted-Python] Dual Reactor Script
In-Reply-To: <20031031011658.GA9027@frobozz>
References: <14662-78995@sneakemail.com>
	<20031030122723.GA15670@twistedmatrix.com>
	<20031031011658.GA9027@frobozz>
Message-ID: <20031030204342.0177517c.itamar@itamarst.org>

On Fri, 31 Oct 2003 12:16:58 +1100
Andrew Bennetts <andrew-twisted at puzzling.org> wrote:

> But on Windows, select is limited to 64 sockets as well (I suspect it
> simply

By *default*, but Python changes this to 512, so it's not an issue. WFMO
can't be changed though.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Thu Oct 30 18:55:43 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 31 Oct 2003 12:55:43 +1100
Subject: [Twisted-Python] Dual Reactor Script
In-Reply-To: <20031030204342.0177517c.itamar@itamarst.org>
References: <14662-78995@sneakemail.com> <20031030122723.GA15670@twistedmatrix.com> <20031031011658.GA9027@frobozz> <20031030204342.0177517c.itamar@itamarst.org>
Message-ID: <20031031015543.GB9027@frobozz>

On Thu, Oct 30, 2003 at 08:43:42PM -0500, Itamar Shtull-Trauring wrote:
> On Fri, 31 Oct 2003 12:16:58 +1100
> Andrew Bennetts <andrew-twisted at puzzling.org> wrote:
> 
> > But on Windows, select is limited to 64 sockets as well (I suspect it
> > simply
> 
> By *default*, but Python changes this to 512, so it's not an issue. WFMO
> can't be changed though.

Oh, I didn't know that.  That's handy :)

-Andrew.




From kunger at intersight.com  Thu Oct 30 22:21:02 2003
From: kunger at intersight.com (Kevin Unger)
Date: Thu, 30 Oct 2003 21:21:02 -0800
Subject: [Twisted-Python] A little newbie help, please?
In-Reply-To: <20031028095744.GA1069@frobozz>
Message-ID: <05232295-0B62-11D8-B5F5-003065B25CAA@intersight.com>

I'm getting this error message in my woven app:

	Node had a mode=imageSizeList attribute, but hte submodel was not
	found in [<twisted.web.woven.model.StringModel instance at 0x730030:
	wrapped data: /Users/kunger/........blah>]

My template looks like this:

         <span model="imageSizeList" view="List">
             <tr bgcolor="#FFFFF" align="center" pattern="listItem">
                 <td model="0" view="Text"></td>
                 <td model="1" view="Text"></td>
                 <td model="3" view="Text"></td>
             </tr>
         </span>

My Page subclass that renders this template has a model factory:

     def wmfactory_imageSizeList(self, request):

This never gets executed, but the page is being instanced and obviously 
the template is being traversed.

This page has a parent page that follows the same pattern -- similar 
kind of list in the template and model factory, and that page works 
fine.  That page retuns this page like so:

     def wchild_image_sizes(self, request):
         return ImageSizeConfigurator(self.root)

Why isn't my model factory being called?

Thank muchly in advance,

-k




From kunger at intersight.com  Thu Oct 30 22:33:13 2003
From: kunger at intersight.com (Kevin Unger)
Date: Thu, 30 Oct 2003 21:33:13 -0800
Subject: Nevermind-->Re: [Twisted-Python] A little newbie help, please?
In-Reply-To: <05232295-0B62-11D8-B5F5-003065B25CAA@intersight.com>
Message-ID: <B8723F1B-0B63-11D8-954F-003065B25CAA@intersight.com>

I figured it out -- I constructed my page using a non-keyword arg which 
was interpreted by woven as the model, I guess.  Used a keyword ag and 
it be wokring.

-k


On Thursday, October 30, 2003, at 09:21 PM, Kevin Unger wrote:

> I'm getting this error message in my woven app:
>
> 	Node had a mode=imageSizeList attribute, but hte submodel was not
> 	found in [<twisted.web.woven.model.StringModel instance at 0x730030:
> 	wrapped data: /Users/kunger/........blah>]
>
> My template looks like this:
>
>         <span model="imageSizeList" view="List">
>             <tr bgcolor="#FFFFF" align="center" pattern="listItem">
>                 <td model="0" view="Text"></td>
>                 <td model="1" view="Text"></td>
>                 <td model="3" view="Text"></td>
>             </tr>
>         </span>
>
> My Page subclass that renders this template has a model factory:
>
>     def wmfactory_imageSizeList(self, request):
>
> This never gets executed, but the page is being instanced and 
> obviously the template is being traversed.
>
> This page has a parent page that follows the same pattern -- similar 
> kind of list in the template and model factory, and that page works 
> fine.  That page retuns this page like so:
>
>     def wchild_image_sizes(self, request):
>         return ImageSizeConfigurator(self.root)
>
> Why isn't my model factory being called?
>
> Thank muchly in advance,
>
> -k
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>




From syver at inout.no  Fri Oct 31 02:17:06 2003
From: syver at inout.no (Syver Enstad)
Date: 31 Oct 2003 10:17:06 +0100
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <20031030204340.GD15670@twistedmatrix.com>
References: <uad7iwk90.fsf@inout.no>
	<20031030204340.GD15670@twistedmatrix.com>
Message-ID: <uvfq5vka5.fsf@inout.no>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> On Thu, Oct 30, 2003 at 09:20:11PM +0100, Syver Enstad wrote:
> > Btw. I've yet to upgrade to 1.1 because the application is
> > still using the old cred system.
> 
> Old cred isn't gone! It's just deprecated. Please upgrade, you
> shouldn't have problems with backwards compatibility. If you do,
> please tell us :)

Ok, that is cool. Do I have to use Python 2.3 to use the latest Twisted?

 




From syver at inout.no  Fri Oct 31 02:19:34 2003
From: syver at inout.no (Syver Enstad)
Date: 31 Oct 2003 10:19:34 +0100
Subject: Nevermind-->Re: [Twisted-Python] A little newbie help, please?
In-Reply-To: <B8723F1B-0B63-11D8-954F-003065B25CAA@intersight.com>
References: <B8723F1B-0B63-11D8-954F-003065B25CAA@intersight.com>
Message-ID: <ur80tvk61.fsf@inout.no>

Kevin Unger <kunger at intersight.com> writes:

> I figured it out -- I constructed my page using a non-keyword arg
> which was interpreted by woven as the model, I guess.  Used a keyword
> ag and it be wokring.

That's correct the first non keyword arg to Page __init__ is
interpreted as the model, it it is not present the Page is it's own
model.

 




From syver at inout.no  Fri Oct 31 03:47:27 2003
From: syver at inout.no (Syver Enstad)
Date: 31 Oct 2003 11:47:27 +0100
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <uvfq5vka5.fsf@inout.no>
References: <uad7iwk90.fsf@inout.no>
	<20031030204340.GD15670@twistedmatrix.com> <uvfq5vka5.fsf@inout.no>
Message-ID: <u3cd9vg3k.fsf@inout.no>

Syver Enstad <syver at inout.no> writes:

> Christopher Armstrong <radix at twistedmatrix.com> writes:
> 
> > On Thu, Oct 30, 2003 at 09:20:11PM +0100, Syver Enstad wrote:
> > > Btw. I've yet to upgrade to 1.1 because the application is
> > > still using the old cred system.
> > 
> > Old cred isn't gone! It's just deprecated. Please upgrade, you
> > shouldn't have problems with backwards compatibility. If you do,
> > please tell us :)
> 
> Ok, that is cool. Do I have to use Python 2.3 to use the latest Twisted?

By the way I found that the handling of deferreds from
Controller.handle in View was totally broken in Twisted 1.0.6. Does
anybody know if this is fixed in 1.1? 

 




From andrew-twisted at puzzling.org  Fri Oct 31 04:46:54 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 31 Oct 2003 22:46:54 +1100
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <uvfq5vka5.fsf@inout.no>
References: <uad7iwk90.fsf@inout.no> <20031030204340.GD15670@twistedmatrix.com> <uvfq5vka5.fsf@inout.no>
Message-ID: <20031031114653.GB1069@frobozz>

On Fri, Oct 31, 2003 at 10:17:06AM +0100, Syver Enstad wrote:
> Christopher Armstrong <radix at twistedmatrix.com> writes:
> 
> > On Thu, Oct 30, 2003 at 09:20:11PM +0100, Syver Enstad wrote:
> > > Btw. I've yet to upgrade to 1.1 because the application is
> > > still using the old cred system.
> > 
> > Old cred isn't gone! It's just deprecated. Please upgrade, you
> > shouldn't have problems with backwards compatibility. If you do,
> > please tell us :)
> 
> Ok, that is cool. Do I have to use Python 2.3 to use the latest Twisted?

The README has the answer:
    "Twisted works with all Python 2.2 and 2.3 versions."

(Although I can't see anywhere on the website that says this)

-Andrew.




From justinjohnson at fastmail.fm  Fri Oct 31 07:31:30 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 31 Oct 2003 08:31:30 -0600
Subject: [Twisted-Python] More about twistd and win32 service
Message-ID: <20031031143130.84DE2D35C@server1.messagingengine.com>

Itamar and others,

Sorry for the delayed reply and thank you for your constant help.  I
setup my NT service as you described, importing the win32eventreactor and
installing it.  The service starts up fine, but when I stop the service I
get the following in the logs.  The "15:08 ... Unexpected..." entry only
gets dumped in the log when stopping the service.

I'm not sure how I'd go about debugging this more since I can't get
anymore output than what's dumped to the log.  Any ideas?  I've attached
winsvc.py and a couple other files it is dependent on.

Thanks again.
-Justin


2003/10/30 15:07 Eastern Standard Time [-] Log opened.
2003/10/30 15:07 Eastern Standard Time [-]
twisted.spread.pb.PBServerFactory starting on 8787
2003/10/30 15:07 Eastern Standard Time [-] Starting factory
<twisted.spread.pb.PBServerFactory instance at 0x00DF8D28>
2003/10/30 15:08 Eastern Standard Time [-] Unexpected error in main loop.
2003/10/30 15:08 Eastern Standard Time [-] Traceback (most recent call
last):
	  File "E:\Python22\Lib\site-packages\win32\lib\win32serviceutil.py", line 635, in SvcRun
	    self.SvcDoRun()
	  File "E:\ccase\python\winsvc.py", line 24, in SvcDoRun
	    reactor.run()
	  File "E:\Python22\Lib\site-packages\twisted\internet\default.py", line 122, in run
	    self.mainLoop()
	--- <exception caught here> ---
	  File "E:\Python22\Lib\site-packages\twisted\internet\default.py", line 133, in mainLoop
	    self.doIteration(t)
	  File "E:\Python22\Lib\site-packages\twisted\internet\win32eventreactor.py", line 180, in doWaitForMultipleEvents
	    fd, action = events[handles[val - WAIT_OBJECT_0]]
	exceptions.KeyError: <PyHANDLE:224>


----- Original message -----
From: "Itamar Shtull-Trauring" <itamar at itamarst.org>
To: twisted-python at twistedmatrix.com
Date: Wed, 22 Oct 2003 14:50:10 -0400
Subject: Re: [Twisted-Python] twistd and win32 service

On Wed, 22 Oct 2003 12:24:42 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> The general consensus on the mailing list archives seems to be that
> I'd need to setup my code to not require twistd but just run
> standalone. 

Uh. *Maybe* that's the consensus, but it's not actually correct. You can
have a tap or tac run as a NT service.

Lets say you have  a script "server.py" that is runnable with "twistd
-y", you can do (and similar code will work for TAPs):

import sys, os
import win32serviceutil, win32service


class MyService(win32serviceutil.ServiceFramework):
    """NT Service."""
    
    _svc_name_ = "MyService"
    _svc_display_name_ = "MyService server"

    def SvcDoRun(self):
        import server
        f = open(os.path.join(server.rootPath, "cyberhigh.log"), 'a')
        from twisted.python.log import startLogging
        from twisted.application.app import startApplication
        from twisted.internet import reactor        
        startLogging(f)
        startApplication(server.application, 0)
        reactor.run()
    
    def SvcStop(self):
        self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
        from twisted.internet import reactor
        reactor.stop()


if __name__ == '__main__':
    win32serviceutil.HandleCommandLine(MyService)


-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: winsvc.py
Type: application/unknown
Size: 991 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031031/80f81b48/attachment-0006.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tap.py
Type: application/unknown
Size: 3240 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031031/80f81b48/attachment-0007.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: server.py
Type: application/unknown
Size: 351 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20031031/80f81b48/attachment-0008.bin>

From vlupien at drummonddesigns.com  Fri Oct 31 07:52:25 2003
From: vlupien at drummonddesigns.com (vicky lupien)
Date: Fri, 31 Oct 2003 09:52:25 -0500
Subject: [Twisted-Python] change submodel in a form
Message-ID: <000001c39fbe$997944d0$687ba8c0@vicky>

I have a web base application.  I want to change the data in the model
so that it will be update in the form when a post my form.
 
Here's my code:
 
from twisted.web.server import Site
from twisted.internet import reactor
from twisted.web.woven.page import Page
from twisted.web.woven.form import FormProcessor
from twisted.python import formmethod as fm
from twisted.web.woven import input, controller
from twisted.web import domhelpers
 
class FormPage(Page):
 
    template = '''<html>
    <head><title>a form page</title>
    </head>
    <body bgcolor="c0c0c0">
    <!--<div model="args" view="Text"/>-->
    <br/><br/>
    <form action="post" method="post" enctype="multipart/form-data">
    <table border="0">
    <tr>
    <td align="right" valign="top">Argument #1:</td>
    <td valign="top"><input type="text" name="arg1" value="" size="60"
controller="int" />
    <div class="formDescription">Hooray it is an argument.
    </div></td>
    </tr>
    <tr>
    <td align="right" valign="top">Integer Field.: *</td>
    <td valign="top"><input type="text" name="arg2" value=""/>
    <div class="formDescription">
    </div></td>
    </tr>
    <tr>
    <td align="right" valign="top">TEXT PLS:</td>
    <td valign="top"><textarea wrap="virtual" rows="10" cols="60"
name="arg5">HERE IS THE DEFAULT OMG!@#!.</textarea>
    <div class="formDescription">it is some text
    </div></td>
    </tr>
    </table><input type="submit" />
    </form>
    </body>
    </html>
    '''
 
    def __init__(self):
        Page.__init__(self)
      
    def checkName(self, request, name):
        if name is None:
            return None
        return True
 
    #def commitName(self, request, name=""):
    #    print self.model
        
    def wvupdate_arg1(self, request, widget, model):
        pass
 
    def wmfactory_arg1(self, request):
        return request.args.get('arg1')
    
    def wcfactory_int(self, request, node, model):
        self.submodel = self.model.getSubmodel(request, "arg1")
        return input.InputHandler(
            model,
            name = "arg1",
            check = self.checkName,
            submodel = self.submodel)
            #commit = self.commitName
            
    def wchild_post(self, request):
        return self
 
reactor.listenTCP(8585, Site(FormPage()))
reactor.run()
 
 
Here's the error I get:
 
 
exceptions.TypeError: process() keywords must be strings
 
 
I know that the error comes from controller but I don't know how to
correct it.
Maybe the error is because I'm not very familiar with form.
Thx in advance,
Vicky
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20031031/a8eb7bef/attachment.html>

From exarkun at intarweb.us  Fri Oct 31 08:04:36 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 31 Oct 2003 10:04:36 -0500
Subject: [Twisted-Python] Re: [Twisted-commits] THE EXTENSION IS .C!  IT IS NOT A C++ FILE!
In-Reply-To: <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>
References: <E1AFM4c-0007Hw-00@wolfwood> <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <20031031150436.GA29923@intarweb.us>

On Thu, Oct 30, 2003 at 08:41:57PM -0500, James Y Knight wrote:
> What compiler doesn't support C99 comments yet?
> 
> James

  Solaris' cc.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20031031/0dbe2c07/attachment.sig>

From itamar at itamarst.org  Fri Oct 31 08:36:02 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 31 Oct 2003 10:36:02 -0500
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <u3cd9vg3k.fsf@inout.no>
References: <uad7iwk90.fsf@inout.no>
	<20031030204340.GD15670@twistedmatrix.com>
	<uvfq5vka5.fsf@inout.no>
	<u3cd9vg3k.fsf@inout.no>
Message-ID: <20031031103602.011b777f.itamar@itamarst.org>

On 31 Oct 2003 11:47:27 +0100
Syver Enstad <syver at inout.no> wrote:

> By the way I found that the handling of deferreds from
> Controller.handle in View was totally broken in Twisted 1.0.6. Does
> anybody know if this is fixed in 1.1? 

Personally I would just avoid using controllers, they're not good for
much as far as I can tell.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Oct 31 08:38:17 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 31 Oct 2003 10:38:17 -0500
Subject: [Twisted-Python] More about twistd and win32 service
In-Reply-To: <20031031143130.84DE2D35C@server1.messagingengine.com>
References: <20031031143130.84DE2D35C@server1.messagingengine.com>
Message-ID: <20031031103817.413d8ddc.itamar@itamarst.org>

On Fri, 31 Oct 2003 08:31:30 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> Sorry for the delayed reply and thank you for your constant help.  I
> setup my NT service as you described, importing the win32eventreactor
> and installing it.  The service starts up fine, but when I stop the
> service I get the following in the logs.  The "15:08 ...
> Unexpected..." entry only gets dumped in the log when stopping the
> service.

Looks like a bug in the win32event reactor - add it to the tracker?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From fog at initd.org  Fri Oct 31 09:01:29 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Fri, 31 Oct 2003 17:01:29 +0100
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <20031031103602.011b777f.itamar@itamarst.org>
References: <uad7iwk90.fsf@inout.no>
	 <20031030204340.GD15670@twistedmatrix.com> <uvfq5vka5.fsf@inout.no>
	 <u3cd9vg3k.fsf@inout.no>  <20031031103602.011b777f.itamar@itamarst.org>
Message-ID: <1067616088.1231.320.camel@localhost>

Il ven, 2003-10-31 alle 16:36, Itamar Shtull-Trauring ha scritto:
> On 31 Oct 2003 11:47:27 +0100
> Syver Enstad <syver at inout.no> wrote:
> 
> > By the way I found that the handling of deferreds from
> > Controller.handle in View was totally broken in Twisted 1.0.6. Does
> > anybody know if this is fixed in 1.1? 
> 
> Personally I would just avoid using controllers, they're not good for
> much as far as I can tell.

they would be very usefull in theory. they could be used to change the
model after reloading a form. imagine a form with action="" that reload
itself until all controller constraints are satisfied and then redirect
to the next page. unfortunately controllers _don't_ update the model
(bug?) does nevow use controllers the right way or does it provide an
alternative to them?

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
          The reverse side also has a reverse side.  -- Japanese proverb
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio è firmata
URL: </pipermail/twisted-python/attachments/20031031/ae784e2e/attachment.sig>

From justinjohnson at fastmail.fm  Fri Oct 31 09:23:28 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 31 Oct 2003 10:23:28 -0600
Subject: [Twisted-Python] More about twistd and win32 service
In-Reply-To: <20031031103817.413d8ddc.itamar@itamarst.org>
References: <20031031143130.84DE2D35C@server1.messagingengine.com> <20031031103817.413d8ddc.itamar@itamarst.org>
Message-ID: <20031031162328.C239E3E7A7@server1.messagingengine.com>

Submitted Issue 379 as a bug.

On Fri, 31 Oct 2003 10:38:17 -0500, "Itamar Shtull-Trauring"
<itamar at itamarst.org> said:
> On Fri, 31 Oct 2003 08:31:30 -0600
> "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> 
> > Sorry for the delayed reply and thank you for your constant help.  I
> > setup my NT service as you described, importing the win32eventreactor
> > and installing it.  The service starts up fine, but when I stop the
> > service I get the following in the logs.  The "15:08 ...
> > Unexpected..." entry only gets dumped in the log when stopping the
> > service.
> 
> Looks like a bug in the win32event reactor - add it to the tracker?
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From jon at totient.demon.co.uk  Fri Oct 31 14:05:15 2003
From: jon at totient.demon.co.uk (Jon Dyte)
Date: Fri, 31 Oct 2003 21:05:15 +0000
Subject: [Twisted-Python] Re: [Twisted-commits] THE EXTENSION IS .C!  IT IS NOT A C++ FILE!
In-Reply-To: <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>
References: <E1AFM4c-0007Hw-00@wolfwood> <69DEB85D-0B43-11D8-A86B-000A95A50FB2@fuhm.net>
Message-ID: <200310312105.15162.jon@totient.demon.co.uk>

Specifically this one, on Solaris.

/tmp> cc -V
cc: WorkShop Compilers 4.2 30 Oct 1996 C 4.2

no chance of C99 there.

Jon


On Friday 31 Oct 2003 1:41 am, James Y Knight wrote:
> What compiler doesn't support C99 comments yet?
>
> James
>
> On Oct 30, 2003, at 6:19 PM, exarkun CVS wrote:
> > Modified files:
> > Twisted/twisted/protocols/_c_urlarg.c 1.7 1.8
> >
> > Log message:
> > THE EXTENSION IS .C!  IT IS NOT A C++ FILE!
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From glyph at twistedmatrix.com  Fri Oct 31 15:17:44 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 31 Oct 2003 17:17:44 -0500
Subject: [Twisted-Python] migration from IIS to Twisted
In-Reply-To: <3FA0CB34.20902@ucmg.com.ua>
References: <3FA0CB34.20902@ucmg.com.ua>
Message-ID: <3FA2DF88.9010506@twistedmatrix.com>

Hi, Max.

Max Ischenko wrote:

> I have a really big ASP/IIS-based system which I'm trying to (partially) 
> rewrite and evolve with python.

Congratulations :).

> As my python code depends on WebKit very little and Cheetah is a 
> standalone processor that could probably be plugged into Twisted easily 
> I'm evaluating the possibility to switch to Twisted.

There are lots of good reasons to do this, but it doesn't seem like 
Twisted would do very much for you.  The main feature which is the 
make-or-break point for Twisted is usually multiple protocol support.

> There is nothing wrong with Webware/WebKit -- it is a great platform, 
> but I'd like to make use of some Twisted components, like 
> twisted.enterprise.row or twisted.cred.

Personally, I've only used t.e.row once - the Twisted team tends to 
avoid databases, in general, and while the support for them is there, 
you'll find it will be more idiomatic in frameworks without Twisted's 
concern for an asynchronous event loop.

Twisted.cred is a very useful framework, but it doesn't really *do* 
anything, per se; it's a set of interfaces to specify the interactions 
between a set of the same domain objects and a potentially large number 
of client protocols.  Its HTTP component is currently 
twisted.web.woven.guard (which is likely to be refactored in the near 
future because it is too complex for the task it performs...).  The real 
meat of the work going into cred at the moment is for protocols like PB 
and SIP.  Integrating it with Cheetah is likely to be more trouble than 
it's worth at the moment considering the fairly small number of 
available credential checker back-ends right now.

> If I'm to switch to Twisted what could you suggest for IIS-Twisted 
> integration?

Reverse-proxying is probably best, unless you need some kind of tighter 
coupling between the servers.

> I'm currently thinking about simple Response.Redirect('...') from .asp 
> to twisted.web.

That can also work.

> But I'd also like to share data and session's state 
> between the two. For example, to match  twisted.web.server.Session with 
>  IIS session. Dunno how this could be done though.

Your best bet would be to hack something with a cookie passed between 
the servers, again, by using reverse proxying.

> More promising (may be) but surely more complex way would be to write 
> some kind of IIS-Twisted adapter that uses COM to talk to VB and 
> twisted.spread to talk to Twisted.

That sounds kind of cool, and it would certainly work if you can get it 
up and running.  Good luck with it.

but-don't-get-any-on-me-l'y y'rs,

	-glyph




From glyph at twistedmatrix.com  Fri Oct 31 15:48:19 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 31 Oct 2003 17:48:19 -0500
Subject: [Twisted-Python] Woven and deferreds in controllers.
In-Reply-To: <1067616088.1231.320.camel@localhost>
References: <uad7iwk90.fsf@inout.no>	 <20031030204340.GD15670@twistedmatrix.com> <uvfq5vka5.fsf@inout.no>	 <u3cd9vg3k.fsf@inout.no>  <20031031103602.011b777f.itamar@itamarst.org> <1067616088.1231.320.camel@localhost>
Message-ID: <3FA2E6B3.6020903@twistedmatrix.com>

Federico Di Gregorio wrote:

> they would be very usefull in theory. they could be used to change the
> model after reloading a form. imagine a form with action="" that reload
> itself until all controller constraints are satisfied and then redirect
> to the next page. unfortunately controllers _don't_ update the model
> (bug?) does nevow use controllers the right way or does it provide an
> alternative to them?

Nevow is not MVC (model/view/controller) it is "DR" (data/renderer). 
Data is analagous to the Model, but it doesn't have the whole observer 
framework attached to it.  One big advantage is that you can have normal 
Python objects -- lists, dicts, etc -- as data without any intermediate 
wrappers.  It seems that most use-cases for observing model updates can 
be satisfied somewhere else (except for LivePage, which we are still 
working on).  Renderer is analagous to the view, but far simpler; it 
uses a functional, rather than object-oriented approach to the template, 
which seems to work better for laying out pages.

Really, Twisted Web provides everything you need for the "controller" 
aspects of your code.  Override 'render' and handle request.args before 
drawing your "view" (woven or not) and you can do any HTTP-level logic 
before even getting into page templating considerations.




