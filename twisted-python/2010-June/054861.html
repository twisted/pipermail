<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] deferred as a Protocol class attribute, Protocol as class attribute 	of a Factory ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20deferred%20as%20a%20Protocol%20class%20attribute%2C%0A%20Protocol%20as%20class%20attribute%20%09of%20a%20Factory%20...&In-Reply-To=%3C4C194CC4.90000%40partiallystapled.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="054860.html">
   <LINK REL="Next"  HREF="054865.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] deferred as a Protocol class attribute, Protocol as class attribute 	of a Factory ...</H1>
    <B>Michael Tharp</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20deferred%20as%20a%20Protocol%20class%20attribute%2C%0A%20Protocol%20as%20class%20attribute%20%09of%20a%20Factory%20...&In-Reply-To=%3C4C194CC4.90000%40partiallystapled.com%3E"
       TITLE="[Twisted-Python] deferred as a Protocol class attribute, Protocol as class attribute 	of a Factory ...">gxti at partiallystapled.com
       </A><BR>
    <I>Wed Jun 16 16:14:28 MDT 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="054860.html">[Twisted-Python] deferred as a Protocol class attribute,	Protocol as class attribute 	of a Factory ...
</A></li>
        <LI>Next message (by thread): <A HREF="054865.html">[Twisted-Python] Start with QTReactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54861">[ date ]</a>
              <a href="thread.html#54861">[ thread ]</a>
              <a href="subject.html#54861">[ subject ]</a>
              <a href="author.html#54861">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/16/2010 12:50 PM, Jean Daniel wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> Reading the SMTP client tutorial[1], I do not see the impact of the
</I>&gt;<i> factory having a protocol defined as a class attribute. Especially
</I>&gt;<i> when here is a big fat warning [2] that I should actually understand
</I>&gt;<i> the inplications. My guess is that in this first case the protocol
</I>&gt;<i> methods do not need access to the protocol instance, maybe it is a
</I>&gt;<i> clear indication that the protocol is stateless, and there is a gain
</I>&gt;<i> ressource-wise since there is no instance created and maintained. But
</I>&gt;<i> I am not sure.
</I>
This isn't storing a protocol instance, just the protocol class. It then 
instantiates that class in the buildProtocol() method. This is a common 
pattern that lets you override settings easily by subclassing.

&gt;<i> Almost the same question: in the imapclient example [3], there is a
</I>&gt;<i> LineReceiver subclass hooked to stdio. The lineReceived callback willl
</I>&gt;<i> fire a callback added to an _class attribute_ deferred filled with a
</I>&gt;<i> user function. I think this design prevents two instances of the
</I>&gt;<i> LineReceiver subclass which would race on the class attribute
</I>&gt;<i> deferred.
</I>
This is also not storing an instance in a class variable. It simply has 
a 'default' value of None, which is overridden at the instance level in 
SimpleIMAP4ClientFactory.buildProtocol().

Instance variables always override class variables. Additionally, 
declaring a class variable has no effect on subsequent instance 
assignments (unless it's an attribute descriptor, but twisted doesn't 
use those). If all your initial instance values are immutable (like 
None) you can forgo having an __init__ method at all and simply declare 
them at the class level as was done here.


To answer your question in a hypothetical sense, no it would not make 
sense to store either of those things in a class variable.

-- m. tharp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="054860.html">[Twisted-Python] deferred as a Protocol class attribute,	Protocol as class attribute 	of a Factory ...
</A></li>
	<LI>Next message (by thread): <A HREF="054865.html">[Twisted-Python] Start with QTReactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54861">[ date ]</a>
              <a href="thread.html#54861">[ thread ]</a>
              <a href="subject.html#54861">[ subject ]</a>
              <a href="author.html#54861">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
