<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] getting all results from DeferredList
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20getting%20all%20results%20from%20DeferredList&In-Reply-To=%3C20100630184259.1937.1347394048.divmod.xquotient.567%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="054963.html">
   <LINK REL="Next"  HREF="054966.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] getting all results from DeferredList</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20getting%20all%20results%20from%20DeferredList&In-Reply-To=%3C20100630184259.1937.1347394048.divmod.xquotient.567%40localhost.localdomain%3E"
       TITLE="[Twisted-Python] getting all results from DeferredList">exarkun at twistedmatrix.com
       </A><BR>
    <I>Wed Jun 30 12:42:59 MDT 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="054963.html">[Twisted-Python] getting all results from DeferredList
</A></li>
        <LI>Next message (by thread): <A HREF="054966.html">[Twisted-Python] getting all results from DeferredList
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54965">[ date ]</a>
              <a href="thread.html#54965">[ thread ]</a>
              <a href="subject.html#54965">[ subject ]</a>
              <a href="author.html#54965">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02:41 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">petshmidt at googlemail.com</A> wrote:
&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>I'm trying to process results from several Deferreds (d1, d2) with
</I>&gt;<i>DeferredList, merging it into one list and sending back to client.
</I>
You might like twisted.internet.defer.gatherResults.
&gt;<i>
</I>&gt;<i>While merging works, the client has no results. What is the way to do
</I>&gt;<i>tasks (db queries in my case) in parallel and then merge results?
</I>
I don't think I understand this part of the question.
&gt;<i>BTW, are nested runInteraction ok?
</I>
Not really.  Twisted APIs are almost all required to be invoked in the 
reactor thread.  Nested runInteraction calls would mean calling 
runInteraction in some other thread, and that's not allowed.

Jean-Paul
&gt;<i>Thanks for help!
</I>&gt;<i>Pet
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>class Test:
</I>&gt;<i>    def __init__(self, cursor):
</I>&gt;<i>        self.cursor = cursor
</I>&gt;<i>
</I>&gt;<i>    def test(db, params):
</I>&gt;<i>        if params.get('query'):
</I>&gt;<i>            params['q'] = self.someFunc3(db, params)
</I>&gt;<i>
</I>&gt;<i>        def processResults(results, out):
</I>&gt;<i>            #merge results into one
</I>&gt;<i>            for _, r in results:
</I>&gt;<i>                out.extend(r)
</I>&gt;<i>            return out
</I>&gt;<i>
</I>&gt;<i>        out = []
</I>&gt;<i>        d1 = self.cursor.runInteraction(self.someFunc, params)
</I>&gt;<i>        d2 = self.cursor.runInteraction(self.someFunc2, params)
</I>&gt;<i>        d = DeferredList([d1,d2])
</I>&gt;<i>        d.addCallback(processResults, out)
</I>&gt;<i>        d.addErrback(log.err)
</I>&gt;<i>        return d
</I>&gt;<i>
</I>&gt;<i>class XMLRPCProtokoll(xmlrpc.XMLRPC):
</I>&gt;<i>    def __init__(self):
</I>&gt;<i>        self.db = adbapi.ConnectionPool()
</I>&gt;<i>        xmlrpc.XMLRPC.__init__(self, True)
</I>&gt;<i>
</I>&gt;<i>    def xmlrpc_test(self, param):
</I>&gt;<i>        t = Test(self.db)
</I>&gt;<i>        return self.db.runInteraction(t.test, param)
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Twisted-Python mailing list
</I>&gt;<i><A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="054963.html">[Twisted-Python] getting all results from DeferredList
</A></li>
	<LI>Next message (by thread): <A HREF="054966.html">[Twisted-Python] getting all results from DeferredList
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54965">[ date ]</a>
              <a href="thread.html#54965">[ thread ]</a>
              <a href="subject.html#54965">[ subject ]</a>
              <a href="author.html#54965">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
