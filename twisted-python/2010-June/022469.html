<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] getting all results from DeferredList
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20getting%20all%20results%20from%20DeferredList&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022466.html">
   <LINK REL="Next"  HREF="022471.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] getting all results from DeferredList</H1>
    <B>Pet</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20getting%20all%20results%20from%20DeferredList&In-Reply-To="
       TITLE="[Twisted-Python] getting all results from DeferredList">petshmidt at googlemail.com
       </A><BR>
    <I>Wed Jun 30 10:41:38 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="022466.html">[Twisted-Python] [Twisted] #3977: Reintegrate qt4reactor into	twisted
</A></li>
        <LI>Next message: <A HREF="022471.html">[Twisted-Python] getting all results from DeferredList
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22469">[ date ]</a>
              <a href="thread.html#22469">[ thread ]</a>
              <a href="subject.html#22469">[ subject ]</a>
              <a href="author.html#22469">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I'm trying to process results from several Deferreds (d1, d2) with
DeferredList, merging it into one list and sending back to client.
While merging works, the client has no results. What is the way to do
tasks (db queries in my case) in parallel and then merge results?

BTW, are nested runInteraction ok?

Thanks for help!
Pet


class Test:
    def __init__(self, cursor):
        self.cursor = cursor

    def test(db, params):
        if params.get('query'):
            params['q'] = self.someFunc3(db, params)

        def processResults(results, out):
            #merge results into one
            for _, r in results:
                out.extend(r)
            return out

        out = []
        d1 = self.cursor.runInteraction(self.someFunc, params)
        d2 = self.cursor.runInteraction(self.someFunc2, params)
        d = DeferredList([d1,d2])
        d.addCallback(processResults, out)
        d.addErrback(log.err)
        return d

class XMLRPCProtokoll(xmlrpc.XMLRPC):
    def __init__(self):
        self.db = adbapi.ConnectionPool()
        xmlrpc.XMLRPC.__init__(self, True)

    def xmlrpc_test(self, param):
        t = Test(self.db)
        return self.db.runInteraction(t.test, param)

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022466.html">[Twisted-Python] [Twisted] #3977: Reintegrate qt4reactor into	twisted
</A></li>
	<LI>Next message: <A HREF="022471.html">[Twisted-Python] getting all results from DeferredList
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22469">[ date ]</a>
              <a href="thread.html#22469">[ thread ]</a>
              <a href="subject.html#22469">[ subject ]</a>
              <a href="author.html#22469">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
