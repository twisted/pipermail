<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] NetstringReceiver
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20NetstringReceiver&In-Reply-To=20100329111100.GA4063%40weiermayer.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021917.html">
   <LINK REL="Next"  HREF="021902.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] NetstringReceiver</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20NetstringReceiver&In-Reply-To=20100329111100.GA4063%40weiermayer.com"
       TITLE="[Twisted-Python] NetstringReceiver">exarkun at twistedmatrix.com
       </A><BR>
    <I>Mon Mar 29 11:04:33 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021917.html">[Twisted-Python] NetstringReceiver
</A></li>
        <LI>Next message: <A HREF="021902.html">[Twisted-Python] Twisted-Python Digest, Vol 72, Issue 35
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21921">[ date ]</a>
              <a href="thread.html#21921">[ thread ]</a>
              <a href="subject.html#21921">[ subject ]</a>
              <a href="author.html#21921">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11:11 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">albert.brandl at weiermayer.com</A> wrote:
&gt;<i>On Fri, Mar 26, 2010 at 12:08:02PM -0000, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A> 
</I>&gt;<i>wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>So, are you sure this is testing what you think it's testing?
</I>&gt;<i>
</I>&gt;<i>Yes. This test was already there, and it failed in unexpected ways, so 
</I>&gt;<i>I
</I>&gt;<i>had to look at it quite closely. I'm not too happy about it, since it
</I>&gt;<i>tests several things at once (illegal strings, bytewise delivery), but 
</I>&gt;<i>I
</I>&gt;<i>decided to leave it there for now, just to make sure that I don't miss
</I>&gt;<i>some test case with the new unit tests.
</I>&gt;<i>
</I>&gt;<i>As Andrew pointed out, this unittest assumes that dataReceived is still
</I>&gt;<i>(somewhat) functional after the detection of an invalid netstring. This
</I>&gt;<i>does not make much sense IMO, and it complicates the code. I'd prefer
</I>&gt;<i>to raise an exception and adapt the unittest accordingly.
</I>
I see.  A good first step (separate from fixing any of the 
implementation of NetstringReceiver) might be to clean up the tests, 
then, so that each only exercises one case, and so that only the desired 
behavior is tested (for example, tests for the behavior you're talking 
about, of receiving invalid bytes after the connection has been closed, 
could be removed).
&gt;<i>But I still don't know which exception would be best. There is a
</I>&gt;<i>ConnectionLost exception, which is raised in
</I>&gt;<i>twisted.protocols.amp.BinaryBoxProtocol when the transport is None.
</I>&gt;<i>Other options are ConnectionClosed and ConnectionDone (both are not
</I>&gt;<i>raised directly anywhere), or a new one. Maybe ConnectionLost is the
</I>&gt;<i>most appropriate one.
</I>
Feel free to introduce new exception types.  Unfortunately I don't 
remember what change you're actually proposing to make to 
NetstringReceiver anymore, so I won't try to suggest any names.

Jean-Paul

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021917.html">[Twisted-Python] NetstringReceiver
</A></li>
	<LI>Next message: <A HREF="021902.html">[Twisted-Python] Twisted-Python Digest, Vol 72, Issue 35
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21921">[ date ]</a>
              <a href="thread.html#21921">[ thread ]</a>
              <a href="subject.html#21921">[ subject ]</a>
              <a href="author.html#21921">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
