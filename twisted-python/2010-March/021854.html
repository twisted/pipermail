<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] My twisted application could not start after reboot be cause of &quot;twistd.pid&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20My%20twisted%20application%20could%20not%20start%20after%0A%20reboot%20be%20cause%20of%20%22twistd.pid%22&In-Reply-To=befee6d81003160007m14902010ra2bfc3eb436bd59c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021853.html">
   <LINK REL="Next"  HREF="021855.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] My twisted application could not start after reboot be cause of &quot;twistd.pid&quot;</H1>
    <B>Tim Allen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20My%20twisted%20application%20could%20not%20start%20after%0A%20reboot%20be%20cause%20of%20%22twistd.pid%22&In-Reply-To=befee6d81003160007m14902010ra2bfc3eb436bd59c%40mail.gmail.com"
       TITLE="[Twisted-Python] My twisted application could not start after reboot be cause of &quot;twistd.pid&quot;">tim at commsecure.com.au
       </A><BR>
    <I>Tue Mar 16 03:27:40 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021853.html">[Twisted-Python] My twisted application could not start after	reboot be cause of &quot;twistd.pid&quot;
</A></li>
        <LI>Next message: <A HREF="021855.html">[Twisted-Python] My twisted application could not start	after	reboot be cause of &quot;twistd.pid&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21854">[ date ]</a>
              <a href="thread.html#21854">[ thread ]</a>
              <a href="subject.html#21854">[ subject ]</a>
              <a href="author.html#21854">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/16/2010 06:07 PM, Peter Cai wrote:
&gt;<i> I think an init.d script could resolve this problem.
</I>&gt;<i> But I am curious about why &quot;turning off power without shutdown twisted
</I>&gt;<i> server before&quot; could cause such a problem.
</I>&gt;<i>
</I>&gt;<i> Is it a bug or it has some more fundamental reason?
</I>
When twistd starts up, it creates a .pid file as a signal that it's 
running. If you try and start it a second time, it notices that the .pid 
file exists, and refuses to run a second time. When twistd is shut down 
cleanly, it removes the .pid file so that it can be run again.

Unfortunately, this means that if twistd is shutdown *uncleanly* (by a 
power failure, or SIGKILL, or some other means), the .pid file must be 
removed before twistd will start again.

This isn't really a bug in twistd as such; almost all Unix daemons use 
the same fundamental system. Try running &quot;ls /var/run/*.pid&quot; on a Linux 
system, for example.

It's possible to add refinements to the basic .pid system, to make it 
more resistant to this kind of problem (off the top of my head, checking 
that the named PID exists, that it's a process of the right kind, 
checking for stale .pid files with exclusive file locks), but all of 
them require more code to implement, reduce portability, and still have 
corner-cases that would require an admin to manually delete the .pid 
file anyway.

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021853.html">[Twisted-Python] My twisted application could not start after	reboot be cause of &quot;twistd.pid&quot;
</A></li>
	<LI>Next message: <A HREF="021855.html">[Twisted-Python] My twisted application could not start	after	reboot be cause of &quot;twistd.pid&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21854">[ date ]</a>
              <a href="thread.html#21854">[ thread ]</a>
              <a href="subject.html#21854">[ subject ]</a>
              <a href="author.html#21854">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
