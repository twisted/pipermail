<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] NetstringReceiver
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20NetstringReceiver&In-Reply-To=%3C20100329111100.GA4063%40weiermayer.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="054413.html">
   <LINK REL="Next"  HREF="054419.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] NetstringReceiver</H1>
    <B>Albert Brandl</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20NetstringReceiver&In-Reply-To=%3C20100329111100.GA4063%40weiermayer.com%3E"
       TITLE="[Twisted-Python] NetstringReceiver">albert.brandl at weiermayer.com
       </A><BR>
    <I>Mon Mar 29 05:11:00 MDT 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="054413.html">[Twisted-Python] NetstringReceiver
</A></li>
        <LI>Next message (by thread): <A HREF="054419.html">[Twisted-Python] NetstringReceiver
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54415">[ date ]</a>
              <a href="thread.html#54415">[ thread ]</a>
              <a href="subject.html#54415">[ subject ]</a>
              <a href="author.html#54415">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Mar 26, 2010 at 12:08:02PM -0000, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A> wrote:
&gt;<i> 
</I>&gt;<i> So, are you sure this is testing what you think it's testing?
</I>
Yes. This test was already there, and it failed in unexpected ways, so I 
had to look at it quite closely. I'm not too happy about it, since it 
tests several things at once (illegal strings, bytewise delivery), but I 
decided to leave it there for now, just to make sure that I don't miss
some test case with the new unit tests.

As Andrew pointed out, this unittest assumes that dataReceived is still
(somewhat) functional after the detection of an invalid netstring. This
does not make much sense IMO, and it complicates the code. I'd prefer
to raise an exception and adapt the unittest accordingly. 

But I still don't know which exception would be best. There is a 
ConnectionLost exception, which is raised in 
twisted.protocols.amp.BinaryBoxProtocol when the transport is None. 
Other options are ConnectionClosed and ConnectionDone (both are not
raised directly anywhere), or a new one. Maybe ConnectionLost is the
most appropriate one.

Best regards,

Albert

-- 
DI Albert Brandl
Weiermayer Solutions GmbH | <A HREF="http://www.weiermayer.com">http://www.weiermayer.com</A>
4813 Altmünster | Abteistraße 12 | Austria 
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="054413.html">[Twisted-Python] NetstringReceiver
</A></li>
	<LI>Next message (by thread): <A HREF="054419.html">[Twisted-Python] NetstringReceiver
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54415">[ date ]</a>
              <a href="thread.html#54415">[ thread ]</a>
              <a href="subject.html#54415">[ subject ]</a>
              <a href="author.html#54415">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
