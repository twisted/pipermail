<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] [Twisted] #4378: Error handling in	NetstringReceiver broken
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20%5BTwisted%5D%20%234378%3A%20Error%20handling%20in%0A%09NetstringReceiver%20broken&In-Reply-To=057.e6e75afbc77c07499193b1e6757489f1%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021930.html">
   <LINK REL="Next"  HREF="021932.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] [Twisted] #4378: Error handling in	NetstringReceiver broken</H1>
    <B>Albert Brandl</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20%5BTwisted%5D%20%234378%3A%20Error%20handling%20in%0A%09NetstringReceiver%20broken&In-Reply-To=057.e6e75afbc77c07499193b1e6757489f1%40twistedmatrix.com"
       TITLE="[Twisted-Python] [Twisted] #4378: Error handling in	NetstringReceiver broken">albert.brandl at weiermayer.com
       </A><BR>
    <I>Tue Mar 30 12:14:18 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="021930.html">[Twisted-Python] twisted vs wsgi
</A></li>
        <LI>Next message: <A HREF="021932.html">[Twisted-Python] Anyone working on a Twisted txRiak?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21931">[ date ]</a>
              <a href="thread.html#21931">[ thread ]</a>
              <a href="subject.html#21931">[ subject ]</a>
              <a href="author.html#21931">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Mar 30, 2010 at 12:27:54PM -0000, Twisted wrote:
&gt;<i>  1. I'm pretty sure this patch, in its current form, will break in the
</I>&gt;<i>  (still supported) Python 2.4, since it uses the 2.5 generator feature
</I>&gt;<i>  where you pass in data.
</I>
Yep - I'll fix this.

&gt;<i>  2. Why not initialize the parser in the Protocol's __init__? Less code in
</I>&gt;<i>  a frequently called path.
</I>
Good idea, since there's no need anymore to check in every call of dataReceived.

&gt;<i>  3. ``stringReceived`` in docstring violates coding standard, should be a
</I>&gt;<i>  L{} or C{} or something, I forget which. So does received_string variable
</I>&gt;<i>  name.
</I>
Oops - this looks like ReST markup :-(.

&gt;<i>  4. In dataReceived, when would we expect to get StopIteration to be
</I>&gt;<i>  raised? Quick read of the generator doesn't show anywhere it actually
</I>&gt;<i>  returns, it seems to be in infinite loop.
</I>
When the generator is left by raising an exception, it will raise a StopIteration
the next time someone sends data. But this is irrelevant now, since Python 2.4
does not support sending data to a generator.

&gt;<i>  5. Using long() is unnecessary, you can just use int().
</I>
Ok.

&gt;<i>  6. Hooray for more and better tests! I am uncomfortable about use of
</I>&gt;<i>  transport.disconnecting, but we've already gone down the path of using it
</I>&gt;<i>  elsewhere, and not sure what else you could do, so it's probably fine.
</I>
I might introduce a new exception (see discussion on the mailing list) - this
would allow to get rid of the check for transport.disconnecting.

&gt;<i>  7. In test_receiveTwoNetstrings(self), perhaps the second string should be
</I>&gt;<i>  different than the first, e.g. &quot;a&quot; and &quot;woo&quot;, to catch theoretical bugs
</I>&gt;<i>  where parser repeatedly spits out first thing it parsed.
</I>
Good idea.

Thanks &amp; best regards,

Albert
-- 
DI Albert Brandl
Weiermayer Solutions GmbH | <A HREF="http://www.weiermayer.com">http://www.weiermayer.com</A>
4813 Altm&#252;nster | Abteistra&#223;e 12 | Austria
Fon: +43(0)720 70 30 14 | Fax: +43 (0) 7612 88081

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021930.html">[Twisted-Python] twisted vs wsgi
</A></li>
	<LI>Next message: <A HREF="021932.html">[Twisted-Python] Anyone working on a Twisted txRiak?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21931">[ date ]</a>
              <a href="thread.html#21931">[ thread ]</a>
              <a href="subject.html#21931">[ subject ]</a>
              <a href="author.html#21931">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
