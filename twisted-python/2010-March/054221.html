<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Does the default session expiry work?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Does%20the%20default%20session%20expiry%20work%3F&In-Reply-To=%3C0016e6480da6a3a04c0480d58337%40google.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="054225.html">
   <LINK REL="Next"  HREF="054222.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Does the default session expiry work?</H1>
    <B>markscottwright at gmail.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Does%20the%20default%20session%20expiry%20work%3F&In-Reply-To=%3C0016e6480da6a3a04c0480d58337%40google.com%3E"
       TITLE="[Twisted-Python] Does the default session expiry work?">markscottwright at gmail.com
       </A><BR>
    <I>Tue Mar  2 11:27:11 MST 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="054225.html">[Twisted-Python] PyCon 2010 sprint report
</A></li>
        <LI>Next message (by thread): <A HREF="054222.html">[Twisted-Python] Does the default session expiry work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54221">[ date ]</a>
              <a href="thread.html#54221">[ thread ]</a>
              <a href="subject.html#54221">[ subject ]</a>
              <a href="author.html#54221">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using twisted 8.2 and (after reading glyph's latest &quot;Twisted in 60  
seconds&quot; entry), I've realized that my sessions never expire. I never added  
any session expiration code, but I thought that the default code expires  
after 15 minutes.

In the below example, I modified twisted\web\server to make  
Session.sessionTimeout be 30 seconds (I also put a print statement in  
Session's ctor, as the log shows), then did two GETs separated by more than  
30 seconds. As the log shows, it looks like the exact same session uid is  
being returned. I would expect it to be deleted by Session.expire, since  
time - lastModifiedTime &gt; 30. Am I missing something?

import sys
from twisted.web import server, static
from twisted.web.resource import Resource
from twisted.web.server import Session, NOT_DONE_YET
from twisted.internet import reactor, ssl
from twisted.python import log

class TestSessionResource(Resource):
isLeaf = True
def render_GET(self, request):
session = request.getSession()
print session.sessionTimeout
print session.uid
print session
return &quot;&lt;html&gt;&lt;body&gt;&lt;p&gt;Session Test&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;

root = TestSessionResource()
reactor.listenTCP(9000, server.Site(root))
log.startLogging(sys.stdout)
reactor.run()

2010-03-02 12:16:49-0600 [-] Log opened.
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] making a new session!!!
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
&lt;twisted.web.server.Session instance at 0x01042AD0&gt;
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:16:51 +0000] &quot;GET / HTTP/1.1&quot; 200 45 &quot;-&quot; &quot;Mozilla/5.0  
(Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5 (KHTML, like Gecko)  
Chrome/4.0.249.89 Safari/532.5&quot;

2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1]  
&lt;twisted.web.server.Session instance at 0x01042AD0&gt;
2010-03-02 12:16:52-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:16:51 +0000] &quot;GET /favicon.ico HTTP/1.1&quot; 200  
45 &quot;-&quot; &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5  
(KHTML, like Gecko) Chrome/4.0.249.89 Safari/532.5&quot;
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
&lt;twisted.web.server.Session instance at 0x01042AD0&gt;
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:17:44 +0000] &quot;GET / HTTP/1.1&quot; 200 45 &quot;-&quot; &quot;Mozilla/5.0  
(Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5 (KHTML, like Gecko)  
Chrome/4.0.249.89 Safari/532.5&quot;

2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 30
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
338e4aa450f671b2f0115513737e643b
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1]  
&lt;twisted.web.server.Session instance at 0x01042AD0&gt;
2010-03-02 12:17:45-0600 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -  
[02/Mar/2010:18:17:44 +0000] &quot;GET /favicon.ico HTTP/1.1&quot; 200  
45 &quot;-&quot; &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.5  
(KHTML, like Gecko) Chrome/4.0.249.89 Safari/532.5&quot;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20100302/66497098/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="054225.html">[Twisted-Python] PyCon 2010 sprint report
</A></li>
	<LI>Next message (by thread): <A HREF="054222.html">[Twisted-Python] Does the default session expiry work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#54221">[ date ]</a>
              <a href="thread.html#54221">[ thread ]</a>
              <a href="subject.html#54221">[ subject ]</a>
              <a href="author.html#54221">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
