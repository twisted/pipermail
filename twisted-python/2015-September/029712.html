<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Converting str to bytes in Py3 port
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Converting%20str%20to%20bytes%20in%20Py3%20port&In-Reply-To=%3CCAFycZ9fkkV3nRmE9D7wOXu6oik04GKuGwAH5pW41rMGK5rjHOg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="062198.html">
   <LINK REL="Next"  HREF="062201.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Converting str to bytes in Py3 port</H1>
    <B>Adi Roiban</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Converting%20str%20to%20bytes%20in%20Py3%20port&In-Reply-To=%3CCAFycZ9fkkV3nRmE9D7wOXu6oik04GKuGwAH5pW41rMGK5rjHOg%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Converting str to bytes in Py3 port">adi at roiban.ro
       </A><BR>
    <I>Wed Sep  2 04:38:52 MDT 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="062198.html">[Twisted-Python] HAProxy and twisted TCP/IP support
</A></li>
        <LI>Next message (by thread): <A HREF="062201.html">[Twisted-Python] Converting str to bytes in Py3 port
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29712">[ date ]</a>
              <a href="thread.html#29712">[ thread ]</a>
              <a href="subject.html#29712">[ subject ]</a>
              <a href="author.html#29712">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

While reviewing the latest patch related to porting Twisted to py3 I
saw that many values which were supposed to hold just text were ported
as bytes.

The argument for this conversion was that Twisted is a low level
framework and that other high level framworks like Treq or Klein
should implement the required code so that end user can just use text.

For example the HTTP response messages are not bytes, even if the RFC
specified that they should only contain text with a single encoding.

I have little experience with twisted.web, so maybe there are many
users of twisted.web which use binary data for response messages or
maybe there is a good use case for putting random bytes in the HTTP
response message.

-------

If for twisted.web there are Treq or Klein to implement the user
friendly interfaces, I don't know what can be used for twisted.conch

In the ticket for porting twisted.conch.ssh.key to py3 [1] the name of
the ssh key algorithms like 'ssh-rsa' or 'ssh-dsa', encryption
algorithm names like AES-128-CBC and ssh key components like p, q, y,
x, n, e are now all bytes.

Do you think that this is ok?
Why allow or encourage people to use random bytes for fields which
should contain human readable text?

For HTTP response line and response headers I think that all values
should be text and encoded in ISO-8859-1.

RFC 4819 [2] only talks about using US-ASCII for all names used in the
SSH public key subsystem.
Why use bytes to represent these names?

RFC 4716 specifies that header tags must be US-ASCII while header
value UTF-8 ... while all IANA names are US-ASCII.... and names in the
private namespace (<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">name at domain</A>) should also be US-ASCII.

As a reviewer I don't know that is the degin/architecture choose by
Twisted and how to review such changes.

As a developer I prefer to have as much text as possible so that I can
do text manipulation operation on these values and directly include
them in logs or error messages.

I assume that all the people involved in writing the RFC had a good
reason to require those fields to be text rather than any bytes.

Thanks for your feedback!

[1] <A HREF="https://github.com/twisted/twisted/compare/trunk...conch-ssh-keys-py3-7998">https://github.com/twisted/twisted/compare/trunk...conch-ssh-keys-py3-7998</A>
[2] <A HREF="https://www.ietf.org/rfc/rfc4819.txt">https://www.ietf.org/rfc/rfc4819.txt</A>
-- 
Adi Roiban

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="062198.html">[Twisted-Python] HAProxy and twisted TCP/IP support
</A></li>
	<LI>Next message (by thread): <A HREF="062201.html">[Twisted-Python] Converting str to bytes in Py3 port
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29712">[ date ]</a>
              <a href="thread.html#29712">[ thread ]</a>
              <a href="subject.html#29712">[ subject ]</a>
              <a href="author.html#29712">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
