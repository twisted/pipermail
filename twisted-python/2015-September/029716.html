<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.mail.imap4.IMAP4Client.fetchMessage always	throws exception
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.mail.imap4.IMAP4Client.fetchMessage%20always%0A%09throws%20exception&In-Reply-To=%3C1c9557cc.9170.14f93b4527b.Coremail.snailcoder%40163.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="062215.html">
   <LINK REL="Next"  HREF="029717.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.mail.imap4.IMAP4Client.fetchMessage always	throws exception</H1>
    <B>Wang Yan</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.mail.imap4.IMAP4Client.fetchMessage%20always%0A%09throws%20exception&In-Reply-To=%3C1c9557cc.9170.14f93b4527b.Coremail.snailcoder%40163.com%3E"
       TITLE="[Twisted-Python] twisted.mail.imap4.IMAP4Client.fetchMessage always	throws exception">snailcoder at 163.com
       </A><BR>
    <I>Thu Sep  3 08:55:12 MDT 2015</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="062215.html">[Twisted-Python] understanding IConsumer
</A></li>
        <LI>Next message (by thread): <A HREF="029717.html">[Twisted-Python] Twisted 15.4.0 Release Announcement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29716">[ date ]</a>
              <a href="thread.html#29716">[ thread ]</a>
              <a href="subject.html#29716">[ subject ]</a>
              <a href="author.html#29716">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I've installed Twisted 15.3.0 on Ubuntu 14.04LTS. Excellent work but there's one problem bothering me for a long time: twisted.mail.imap4.IMAP4Client.fetchMessage always throws exception and the exception occured at random, e.g. somtimes the exception occured when the program read the 120th mail, sometimes it occured at the 150th or 200th mail. The traceback of the exception is as follows:

Unhandled Error
Traceback (most recent call last):
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/python/log.py&quot;, line 101, in callWithLogger
    return callWithContext({&quot;system&quot;: lp}, func, *args, **kw)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/python/log.py&quot;, line 84, in callWithContext
    return context.call({ILogContext: newCtx}, func, *args, **kw)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/python/context.py&quot;, line 118, in callWithContext
    return self.currentContext().callWithContext(ctx, func, *args, **kw)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/python/context.py&quot;, line 81, in callWithContext
    return func(*args,**kw)
--- &lt;exception caught here&gt; ---
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/internet/posixbase.py&quot;, line 597, in _doReadOrWrite
    why = selectable.doRead()
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/internet/tcp.py&quot;, line 209, in doRead
    return self._dataReceived(data)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/internet/tcp.py&quot;, line 215, in _dataReceived
    rval = self.protocol.dataReceived(data)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/protocols/basic.py&quot;, line 571, in dataReceived
    why = self.lineReceived(line)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/mail/imap4.py&quot;, line 2356, in lineReceived
    self._regularDispatch(line)
  File &quot;/usr/local/lib/python2.7/dist-packages/Twisted-15.3.0-py2.7-linux-i686.egg/twisted/mail/imap4.py&quot;, line 2383, in _regularDispatch
    tag, rest = parts
exceptions.ValueError: need more than 1 value to unpack

My code is as simple as possible and the exception is thrown by the following codes:

dlist = []
for msg in messages:    # use message number, not UID
    d = self.fetchMessage(msg, uid=False)
    d.addCallback(cbGetAttachment)
    dlist.append(d)
dl = defer.DeferredList(dlist)
return dl.addCallback(cbLogout)

Is there anybody know about this issue?


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20150903/8a09845b/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20150903/8a09845b/attachment.html</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="062215.html">[Twisted-Python] understanding IConsumer
</A></li>
	<LI>Next message (by thread): <A HREF="029717.html">[Twisted-Python] Twisted 15.4.0 Release Announcement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29716">[ date ]</a>
              <a href="thread.html#29716">[ thread ]</a>
              <a href="subject.html#29716">[ subject ]</a>
              <a href="author.html#29716">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
