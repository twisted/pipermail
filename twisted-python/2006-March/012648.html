<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Degrading under load
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Degrading%20under%20load&In-Reply-To=1141896657.0%40gershon">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012647.html">
   <LINK REL="Next"  HREF="012649.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Degrading under load</H1>
    <B>Yitzchak Gale</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Degrading%20under%20load&In-Reply-To=1141896657.0%40gershon"
       TITLE="[Twisted-Python] Degrading under load">gale at sefer.org
       </A><BR>
    <I>Thu Mar  9 16:13:21 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="012647.html">[Twisted-Python] DB-Transaction spanning several calls
</A></li>
        <LI>Next message: <A HREF="012649.html">[Twisted-Python] Degrading under load
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12648">[ date ]</a>
              <a href="thread.html#12648">[ thread ]</a>
              <a href="subject.html#12648">[ subject ]</a>
              <a href="author.html#12648">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry, I guess my question wasn't clear enough.

The most important things I need to know are:

When running listenTCP, how often does twisted
accept pending connections on the port? Is it only
when the previous connection is finished
processing, or every time the event loop gets
control, or something in between?

And when twisted does accept pending connections,
does it accept ALL of them and queue them all for
processing, or just one at a time?

Thanks,
Yitz

My original post:
&gt;<i> I need to set up a TCP service (on a linux box)
</I>&gt;<i> that will get something like a few hunderd connections
</I>&gt;<i> per minute at peak load. For each connection, I do
</I>&gt;<i> some XML processing, and possibly send a query
</I>&gt;<i> to another nearby machine and get a respone.
</I>&gt;<i>
</I>&gt;<i> Seems to me that twisted should be able to handle that.
</I>&gt;<i>
</I>&gt;<i> But what happens when I get the occasional burst
</I>&gt;<i> of connections, lets say tens of connections within
</I>&gt;<i> one second? What I need is:
</I>&gt;<i>
</I>&gt;<i> o Every client gets a socket connection promptly, so
</I>&gt;<i>  no danger of TCP timeout.
</I>&gt;<i> o Under medium load, clients will have to wait a
</I>&gt;<i>  bit longer for the response.
</I>&gt;<i> o Under heavy load, some clients will get a &quot;busy&quot;
</I>&gt;<i>  response (defined in the protocol I am implementing)
</I>&gt;<i>  and immediate socket close.
</I>&gt;<i>
</I>&gt;<i> What is the best way to do that in twisted? I envision
</I>&gt;<i> one of the following architectures:
</I>&gt;<i>
</I>&gt;<i> A. Just use twisted in the usual way. Watch twisted's
</I>&gt;<i> event queue for heavy load.
</I>&gt;<i>
</I>&gt;<i> B. Two processes: one to dish out connections and one
</I>&gt;<i> to queue requests and process them.
</I>&gt;<i>
</I>&gt;<i> C. Three processes: one to dish out connections, one
</I>&gt;<i> to queue requests and watch for load, and one to
</I>&gt;<i> process the requests.
</I>&gt;<i>
</I>&gt;<i> Which of these do I need to use to get the desired
</I>&gt;<i> effect under load? Or is there some better way?
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012647.html">[Twisted-Python] DB-Transaction spanning several calls
</A></li>
	<LI>Next message: <A HREF="012649.html">[Twisted-Python] Degrading under load
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12648">[ date ]</a>
              <a href="thread.html#12648">[ thread ]</a>
              <a href="subject.html#12648">[ subject ]</a>
              <a href="author.html#12648">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
