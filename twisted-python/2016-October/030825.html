<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Is there a recommended way for a Service to	request Application stop?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Is%20there%20a%20recommended%20way%20for%20a%20Service%20to%0A%09request%20Application%20stop%3F&In-Reply-To=%3C8C06C92C-D12A-421B-846A-00ED9C69F675%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030824.html">
   <LINK REL="Next"  HREF="030827.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Is there a recommended way for a Service to	request Application stop?</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Is%20there%20a%20recommended%20way%20for%20a%20Service%20to%0A%09request%20Application%20stop%3F&In-Reply-To=%3C8C06C92C-D12A-421B-846A-00ED9C69F675%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Is there a recommended way for a Service to	request Application stop?">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Oct 10 18:02:54 MDT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="030824.html">[Twisted-Python] Is there a recommended way for a Service to request Application stop?
</A></li>
        <LI>Next message: <A HREF="030827.html">[Twisted-Python] Is there a recommended way for a Service to request Application stop?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30825">[ date ]</a>
              <a href="thread.html#30825">[ thread ]</a>
              <a href="subject.html#30825">[ subject ]</a>
              <a href="author.html#30825">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Oct 10, 2016, at 4:38 PM, Daniel Sutcliffe &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dansut at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Generically, can I somehow bubble up events through the Service
</I>&gt;<i> hierarchy, or should I communicate with external objects to the
</I>&gt;<i> hierarchy that can bubble down actions from higher up?
</I>

Following the &lt;<A HREF="https://en.wikipedia.org/wiki/Single_responsibility_principle">https://en.wikipedia.org/wiki/Single_responsibility_principle</A> &lt;<A HREF="https://en.wikipedia.org/wiki/Single_responsibility_principle">https://en.wikipedia.org/wiki/Single_responsibility_principle</A>&gt;&gt;, the service hierarchy's job is just to make sure everything gets started up and shut down together.

It sounds to me like you have a pretty well-defined hierarchy which seems like it fits into the service hierarchy because it's roughly parallel in terms of which objects participate; however, you have very application-specific semantics for this parallel hierarchy.  For example, it's pretty unusual to have a super-service reconfigure a subordinate service in order to recover from an error condition, in my experience, unless you're talking about stuff like erlang supervision hierarchies, but that requires runtime support like the code being recovered running in a subprocess that doesn't share state.

It often feels like abstractions are expensive so you should have as few of them as possible; but, in reality, *simple* abstractions are cheap, and what makes abstraction expensive is when you overload them.  Make a new, simple abstraction that contains exactly the semantics you just described, and use composition to point at the appropriate point in the MultiService hierarchy.  When it's time to &quot;stop&quot; a service, do setServiceParent(None); when it's time to &quot;start&quot; it, do setServiceParent(appropriateServiceParent).  This should take care of keeping your services in the appropriate state.

BTW, if you have stateful long-running services that have to self-modify based on changing circumstances, you might want to also check out <A HREF="https://github.com/glyph/automat">https://github.com/glyph/automat</A> &lt;<A HREF="https://github.com/glyph/automat">https://github.com/glyph/automat</A>&gt; to see if it can help you ensure that everything's in a consistent state.

Good luck!

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20161010/3e694983/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20161010/3e694983/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030824.html">[Twisted-Python] Is there a recommended way for a Service to request Application stop?
</A></li>
	<LI>Next message: <A HREF="030827.html">[Twisted-Python] Is there a recommended way for a Service to request Application stop?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30825">[ date ]</a>
              <a href="thread.html#30825">[ thread ]</a>
              <a href="subject.html#30825">[ subject ]</a>
              <a href="author.html#30825">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
