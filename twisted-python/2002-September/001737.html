<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] FAILED (failures=1, errors=1164)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20FAILED%20%28failures%3D1%2C%20errors%3D1164%29&In-Reply-To=20020925041921.GD3657%40ritsuko.xware.cx">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001735.html">
   <LINK REL="Next"  HREF="001738.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] FAILED (failures=1, errors=1164)</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20FAILED%20%28failures%3D1%2C%20errors%3D1164%29&In-Reply-To=20020925041921.GD3657%40ritsuko.xware.cx"
       TITLE="[Twisted-Python] FAILED (failures=1, errors=1164)">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Sep 25 03:46:52 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001735.html">[Twisted-Python] FAILED (failures=1, errors=1164)
</A></li>
        <LI>Next message: <A HREF="001738.html">[Twisted-Python] 0.99.2rc3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1737">[ date ]</a>
              <a href="thread.html#1737">[ thread ]</a>
              <a href="subject.html#1737">[ subject ]</a>
              <a href="author.html#1737">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 25 Sep 2002 14:19:21 +1000, Andrew Bennetts &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">andrew-twisaed at puzzling.org</A>&gt; wrote:
&gt;<i> Running:
</I>&gt;<i>   PYTHONPATH=. python admin/runtests -t poll
</I>
Woah.  We should have different-reactor unit test running in the coding
standard too, apparently :-(.

&gt;<i>   FAILED (failures=1, errors=1164)
</I>
&gt;<i> Now, considering that we don't have that many tests, something is *really*
</I>&gt;<i> screwy.
</I>
There are some hacks in the pyunit shipped with Twisted to make it interpret
each failed deferred as a separate error.  This means some tests can produce
quite a few more errors than you might expect :-).

&gt;<i> The vast bulk are:
</I>&gt;<i> ======================================================================
</I>&gt;<i> ERROR: testPBFailures (twisted.test.test_pbfailure.PBFailureTest)
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> (yes, with no traceback)
</I>
Yeah, this happens with Failures that are instantiated rather than raised.  I
guess there should be a debug mode where _all_ failures save their stack, that
the unit tests use...

&gt;<i> Anyone know what's going on here?  I'm running debian testing/unstable.
</I>
This is fixed now.  There is still one error in the pollreactor unit tests,
but that has something to do with UDP, and seems tricky enough that I'm keeping
my nose out of it for now.

What was happening was that the poll reactor was assuming that obj.fileno()
would always return a valid descriptor.  Since this has never been the case,
and one of the failure cases that causes the remove-descriptor code to get run
(and fileno() to get called) is that fileno() raises an exception, things
didn't work.  Obviously there was some circularity there, and you'd get a
double-traceback and a corrupted reactor, leaving sockets in it which would
raise these same exceptions every time .iterate() was run.  Hence the very
large number of errors.

The code that's in there now is a bit slow in the failure case I described, but
it works.  At some point we should probably have a cleaner solution to this
problem in general.

-- 
 |    &lt;`'&gt;    |  Glyph Lefkowitz: Traveling Sorcerer   |
 |   &lt; _/ &gt;   |  Lead Developer,  the Twisted project  |
 |  &lt; ___/ &gt;  |      <A HREF="http://www.twistedmatrix.com">http://www.twistedmatrix.com</A>      |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20020925/03107eaa/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-python/attachments/20020925/03107eaa/attachment.pgp</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001735.html">[Twisted-Python] FAILED (failures=1, errors=1164)
</A></li>
	<LI>Next message: <A HREF="001738.html">[Twisted-Python] 0.99.2rc3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1737">[ date ]</a>
              <a href="thread.html#1737">[ thread ]</a>
              <a href="subject.html#1737">[ subject ]</a>
              <a href="author.html#1737">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
