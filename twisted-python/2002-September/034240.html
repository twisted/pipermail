<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] breaking distrib.ResourceSubscription
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20breaking%20distrib.ResourceSubscription&In-Reply-To=%3C1032905503.14645.294.camel%40troglodyte.funhouse%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="034239.html">
   <LINK REL="Next"  HREF="034241.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] breaking distrib.ResourceSubscription</H1>
    <B>Kevin Turner</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20breaking%20distrib.ResourceSubscription&In-Reply-To=%3C1032905503.14645.294.camel%40troglodyte.funhouse%3E"
       TITLE="[Twisted-Python] breaking distrib.ResourceSubscription">acapnotic at twistedmatrix.com
       </A><BR>
    <I>Tue Sep 24 16:11:41 MDT 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="034239.html">[Twisted-Python] Release Process
</A></li>
        <LI>Next message (by thread): <A HREF="034241.html">[Twisted-Python] breaking distrib.ResourceSubscription
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34240">[ date ]</a>
              <a href="thread.html#34240">[ thread ]</a>
              <a href="subject.html#34240">[ subject ]</a>
              <a href="author.html#34240">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2002-09-24 at 06:57, Glyph Lefkowitz wrote:
[...]
&gt;<i> ResourcePublisher instance has no attribute 'remote_wasModifiedSince'
</I>
I'm surprised that this is in the logs much, since it should only happen
for distributed servers that set a Last-Modified header.  Are personal
servers serving that many static files?  I would have thought that would
be handled by ~/public_html.

[...]
&gt;<i> I thought that I'd mentioned this over IRC before, but let me stress it: I
</I>&gt;<i> think that twisted.web.server is implementing *WAAAAY* too much of HTTP right
</I>&gt;<i> now. 
</I>
Interesting position.  I know you're not a fan of complete support for a
protocol when you believe the protocol itself is broken, and I'll admit
that nobody actually uses ETags, but I would hardly say that
Last-Modified and HEAD are obscure or unnecessary.

&gt;<i> First of all, this is killing performance -- you have a minimum of 4 or 5
</I>&gt;<i> PB server/client interactions now for each conditional request instead of 2.
</I>&gt;<i> Those method calls are not cheap.
</I>
Recognized.  Although I thought I only increased the count by one, not
two or three?

Also take into consideration that these calls only happen for the
*conditional* requests.  Resources that don't supply ETag or
Last-Modified cache validation headers will probably never be bothered
with them.  And if the condition fails, callRemote(&quot;request&quot;) never
happens, nor does all the work that goes with it.  So overall,
estimating its impact on performance isn't as simple as grep --count
callRemote.


&gt;<i> Second, this is exploding the complexity of
</I>&gt;<i> the webserver: its goal should be to get to the endpoint resource *as simply as
</I>&gt;<i> possible* and then invoke endpoint behavior on that resource.  If clever
</I>&gt;<i> header-parsing things need to happen, then we need to make a lower-level
</I>&gt;<i> 'request' method and make *it* clever, not do request processing before the
</I>&gt;<i> request is dispatched.
</I>
This I agree with.  I knew something was wrong when I had three remote
methods in ResourcePublisher all independently doing getResourceFor.  It
would be more symmetric if Request.process was invoked on the distri --

ggrngh.  What is Request.process anyway.  Is it just supposed to do
site.getResourceFor and pass itself off?  Yes.  All the rest of the junk
in there is stuff I added (though the HEAD/supportedMethods stuff was
quite some time ago) with the possible exception of the
util.Unauthorized block.  And it's probably all logic that belongs in
web..Resource rather than Request.

(which is just re-iterating what you've been telling me.)

So how do we fix it?  You're suggesting that Request.process call
Resource.request, which contains most of the stuff currently in
Request.process, and Resource.request calls Resource.render if it's not
a conditional request?

&gt;<i> Third, and not least, this has broken backwards compatibility (albeit in a
</I>&gt;<i> mostly-harmless way) at a time when we should be focusing the most on backwards
</I>&gt;<i> compatibility. 
</I>
Sounds like we need an inter-version test harness.  Runs peer1 under
version X and peer2 on Y, or starts server on version X, pickles it, and
re-starts under Y, etc.

&gt;<i> I'm sending this to you directly instead of the list because I've had enough
</I>&gt;<i> political headaches recently and I didn't want you to think that I'm publicly
</I>&gt;<i> lambasting you :).  I appreciate the effort that went into this feature
</I>&gt;<i> implementation, even if it was misguided.
</I>
God help us if we can't critique the codebase in the developer's forum.
I appreciate the feedback; I *told* you that I didn't think my changes
had been tested &quot;a lot&quot;.

&gt;<i> If you think some of this
</I>&gt;<i> information is useful or that my views on twisted.web's architecture are not
</I>&gt;<i> very clear (or require public discussion), feel free to edit and re-post.
</I>
Cheers,

 - Acap

-- 
The moon is waning gibbous, 91.9% illuminated, 17.5 days old.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: &lt;/pipermail/twisted-python/attachments/20020924/2ed35414/attachment.sig&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="034239.html">[Twisted-Python] Release Process
</A></li>
	<LI>Next message (by thread): <A HREF="034241.html">[Twisted-Python] breaking distrib.ResourceSubscription
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34240">[ date ]</a>
              <a href="thread.html#34240">[ thread ]</a>
              <a href="subject.html#34240">[ subject ]</a>
              <a href="author.html#34240">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
