<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] relationships in t.e.row
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20relationships%20in%20t.e.row&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001597.html">
   <LINK REL="Next"  HREF="001601.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] relationships in t.e.row</H1>
    <B>Sean Riley</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20relationships%20in%20t.e.row&In-Reply-To="
       TITLE="[Twisted-Python] relationships in t.e.row">sean at twistedmatrix.com
       </A><BR>
    <I>Sat Sep  7 17:35:12 EDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001597.html">[Twisted-Python] container elements in domtemplate
</A></li>
        <LI>Next message: <A HREF="001601.html">[Twisted-Python] relationships in t.e.row
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1599">[ date ]</a>
              <a href="thread.html#1599">[ thread ]</a>
              <a href="subject.html#1599">[ subject ]</a>
              <a href="author.html#1599">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>a natural extension of twisted.enterprise.row is to add support for
relationships between tables.

anyone got any good examples of tools or apps that do this well?

Some initial thoughts..

Currently, the reflector is initialized with the &quot;stubs&quot; structure that
consists of:

	stubClass, tablename, keycolumns

for each (database table / row class). This information could be extended to
include some relationship data in the form of foreign keys. This foreign key
data would allow relationships between tables in the database to be mirrored
into the reflector.

For example, in the existing row example code the stubs structure is:

stubs = [ (RoomRow, &quot;testrooms&quot;, [(&quot;roomId&quot;,&quot;int4&quot;)]) ]

If there was another table &quot;furniture&quot; and a foreign key in that table that
connects it to the room table, then that could be specified when
initializing the reflector:

stubs = [
  (RoomRow,      &quot;testrooms&quot;, [(&quot;roomId&quot;,&quot;int4&quot;)]), [] ),
  (FurnitureRow, &quot;furniture&quot;, [(&quot;furnId&quot;,&quot;int4&quot;)]), [(&quot;roomId&quot;, &quot;int4&quot;,
&quot;rooms&quot;, &quot;roomId&quot;)] )]

where the forth element in each entry is a foreign key of :
	(local_column_name,
	 column_type,
	 foreign_table_name,
	 foreign_column_name)

(could specify the foreign class also, but the reflector should already know
which class corresponds to the foreign table.)

This foreign key data would then be used when loading row objects from the
database. Any time a &quot;RoomRow&quot; object is loaded, it would load all of the
FurnitureRows for that room.  Although the foreign key data is specified for
the child table (furniture) it is when objects of the parent table
(testrooms) are loaded that the significant work happens.

Allowing an option for child rows to be loaded when loading a row is
probably a good idea.

This probably requires some changes to t.e.row to work. Currently the
optional &quot;factoryMethod&quot; is passed into Reflector::loadObjectsFrom. The
factoryMethod will need to be available for children classes also, so it
probably should be added to the stubs structure.

The &quot;data&quot; passed to loadObjectsFrom is also an issue, maybe the data passed
into the highest level loadObjectsFrom is passed down to children, or the
parent Row instance that the rows are being loaded for is passed as the
data...? Maybe loadObjectsFrom takes a parent object every time it is
called - this may even be required.

The relationship between rows once they are loaded is another issue. Where
are children row objects put once they are loaded? In the above example,
maybe the RoomRow object has a list member variable called &quot;furniture&quot; or
&quot;children&quot; added to it and the FurnitureRow objects are put in that list?
This becomes a type of containment system with a heirarchy of containers...

So, loading row objects is doable. I'm not sure of all the implications for
other SQL operations. Assuming that all changes to the database are going
through the row interface makes things easier, but it requires more
thought... A good goal is to be able to operate on these row objects in
memory and have the changes propagate into the database in  controllable
way.



----------------
&quot;If he's so smart, then how come he's dead?&quot;, Homer Simspon
Sean Riley
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sean at ninjaneering.com</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001597.html">[Twisted-Python] container elements in domtemplate
</A></li>
	<LI>Next message: <A HREF="001601.html">[Twisted-Python] relationships in t.e.row
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1599">[ date ]</a>
              <a href="thread.html#1599">[ thread ]</a>
              <a href="subject.html#1599">[ subject ]</a>
              <a href="author.html#1599">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
