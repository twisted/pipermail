<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] thoughts on a reactor feature
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20thoughts%20on%20a%20reactor%20feature&In-Reply-To=%3C3D8F635E.6090506%40cubik.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="034214.html">
   <LINK REL="Next"  HREF="034224.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] thoughts on a reactor feature</H1>
    <B>Bruce Mitchener</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20thoughts%20on%20a%20reactor%20feature&In-Reply-To=%3C3D8F635E.6090506%40cubik.org%3E"
       TITLE="[Twisted-Python] thoughts on a reactor feature">bruce at cubik.org
       </A><BR>
    <I>Mon Sep 23 12:54:22 MDT 2002</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="034214.html">[Twisted-Python] Exceptions across connections
</A></li>
        <LI>Next message (by thread): <A HREF="034224.html">[Twisted-Python] thoughts on a reactor feature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34222">[ date ]</a>
              <a href="thread.html#34222">[ thread ]</a>
              <a href="subject.html#34222">[ subject ]</a>
              <a href="author.html#34222">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey all,

When working with Twisted, an important thing is to make sure that the 
reactor is running often enough and that tasks are not starving the 
reactor.  (This is obvious.)

I think it'd be nice if the reactor supported some interface for 
discovering, diagnosing and debugging long running tasks.  This could be 
done in a few different ways.

One would be have an interface to POSIX clocks and track the amount of 
time spent between calls out of reactor.run() and report anything that 
takes over a specified threshold of time to execute.

Another is to implement some sort of stack trace sampling where you 
periodically take a stack trace when a utility program is running and 
you've noted periods of long latency.

I know how to do that sort of thing in C or C++, but not in Python.  Is 
it possible? Efficient enough to actually do?  Would it need some native 
code for high enough resolution clocks?

Much of this would also provide the support needed for something like a 
top-for-reactor as well or to be able to print out all currently queued 
activities.

Information about what each thread in the thread pools are doing would 
be useful as well.  This would match the sort of functionality that DBs 
provide to diagnose their behaviors and what they're currently doing 
with each thread.

For some information on POSIX clocks, see this:

<A HREF="http://www.opengroup.org/onlinepubs/007904975/functions/clock_settime.html">http://www.opengroup.org/onlinepubs/007904975/functions/clock_settime.html</A>

The _POSIX_CPUTIME and _POSIX_THREAD_CPUTIME extensions are particularly 
useful for this sort of thing.  This would (obviously) have to have 
platform dependencies.  The information on the Linux glibc compliance 
with the various POSIX options can be found at:

<A HREF="http://people.redhat.com/drepper/posix-option-groups.html">http://people.redhat.com/drepper/posix-option-groups.html</A>

So, for Linux people, this should all work.  Other platforms would 
either need to have similar support for the specifications, an alternate 
API with an interested implementor, or would need to just not offer the 
additional capability.

Thoughts? Better or simpler ways to do this?

  - Bruce



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="034214.html">[Twisted-Python] Exceptions across connections
</A></li>
	<LI>Next message (by thread): <A HREF="034224.html">[Twisted-Python] thoughts on a reactor feature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34222">[ date ]</a>
              <a href="thread.html#34222">[ thread ]</a>
              <a href="subject.html#34222">[ subject ]</a>
              <a href="author.html#34222">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
