<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Asynchronous gzipped content decompression: best	approach
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Asynchronous%20gzipped%20content%20decompression%3A%20best%0A%09approach&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022617.html">
   <LINK REL="Next"  HREF="022621.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Asynchronous gzipped content decompression: best	approach</H1>
    <B>Michele -</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Asynchronous%20gzipped%20content%20decompression%3A%20best%0A%09approach&In-Reply-To="
       TITLE="[Twisted-Python] Asynchronous gzipped content decompression: best	approach">isahn74 at gmail.com
       </A><BR>
    <I>Fri Jul 30 06:28:01 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="022617.html">[Twisted-Python] Is that behavior of t.i.stdio.StandardIO	known?
</A></li>
        <LI>Next message: <A HREF="022621.html">[Twisted-Python] Asynchronous gzipped content decompression: best approach
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22618">[ date ]</a>
              <a href="thread.html#22618">[ thread ]</a>
              <a href="subject.html#22618">[ subject ]</a>
              <a href="author.html#22618">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I have written a small utility function to replace
&quot;twisted.web.client.getPage&quot;, to be able to read the response header.

I have to say that the ever improving documentation made it quite easy for
me to do it using the new twisted.web.client.Agent, so well done to all!

Since my wrapper works quite well, I decided to add gzip response support,
as it's another feature lacking from the original getPage. Again, it was
quite simple and it looks it works quite well, in proof of concept scenario.

Then it came my dilemma. What I'm doing now is a synchronous decompression
as shown below:

compressedstream = StringIO.StringIO(inzip)
gzipper = gzip.GzipFile(fileobj=compressedstream)
_data = gzipper.read()
return _data

This works quite well, but I wanted to add support for arbitrary large
compressed responses, and I wanted to ask your opinion on the best approach
for this:

-a separate thread? it has it's limit, as it's not scaling well at all, but,
in the possible scenario of a getPage usege shouldn't be a big issue (i.e.
not many concurrent calls)

-a Producer/consumer? That sounded like the modern twisted way of doing it,
but I didn't manage to be able to implement it properly, as I could create a
proper &quot;consumer&quot; class by looking to the example in the documentation...

-twisted.python.zipstream.DeflatedZipFileEntry?
I found this and seemed a potential way of doing it, with may be the use
of inline generators?
But then, I thought, is it a too  complex approach for a simple  problem?

I guess that decompressing data in twisted should be a fairly common task,
but I have not found a sample that looked like the &quot;best&quot; way for doing it,
so... here is this email

Thanks for you help, and I'll be happy to post the final code for future
reference if anyone is interested

Michele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20100730/c2442106/attachment.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20100730/c2442106/attachment.htm</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022617.html">[Twisted-Python] Is that behavior of t.i.stdio.StandardIO	known?
</A></li>
	<LI>Next message: <A HREF="022621.html">[Twisted-Python] Asynchronous gzipped content decompression: best approach
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22618">[ date ]</a>
              <a href="thread.html#22618">[ thread ]</a>
              <a href="subject.html#22618">[ subject ]</a>
              <a href="author.html#22618">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
