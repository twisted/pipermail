<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted HTTP client supporting failover for multiple A records?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20HTTP%20client%20supporting%20failover%20for%0A%20multiple%20A%20records%3F&In-Reply-To=AANLkTilVYiI9BLZpz4UWLvLkok-8D5XppYhhuXNVgqMN%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022569.html">
   <LINK REL="Next"  HREF="022571.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted HTTP client supporting failover for multiple A records?</H1>
    <B>Itamar Turner-Trauring</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%20HTTP%20client%20supporting%20failover%20for%0A%20multiple%20A%20records%3F&In-Reply-To=AANLkTilVYiI9BLZpz4UWLvLkok-8D5XppYhhuXNVgqMN%40mail.gmail.com"
       TITLE="[Twisted-Python] Twisted HTTP client supporting failover for multiple A records?">itamar at itamarst.org
       </A><BR>
    <I>Thu Jul 15 08:06:00 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="022569.html">[Twisted-Python] Twisted HTTP client supporting failover for multiple A records?
</A></li>
        <LI>Next message: <A HREF="022571.html">[Twisted-Python] Twisted HTTP client supporting failover for multiple A records?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22570">[ date ]</a>
              <a href="thread.html#22570">[ thread ]</a>
              <a href="subject.html#22570">[ subject ]</a>
              <a href="author.html#22570">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 2010-07-15 at 10:46 +0100, Reza Lotun wrote:

&gt;<i> As for connecting to hosts that resolve to multiple A records - I
</I>&gt;<i> presume as a means of load balancing via DNS round robin - I'm not
</I>&gt;<i> quite sure this is natively supported in Twisted. I believe since all
</I>&gt;<i> TCP connections are mediated via connectTCP hostnames are ultimately
</I>&gt;<i> resolved via socket.gethostbyname. I think you really want the support
</I>&gt;<i> provided by socket.gethostbyname_ex
</I>&gt;<i> (<A HREF="http://docs.python.org/library/socket.html#socket.gethostbyname_ex">http://docs.python.org/library/socket.html#socket.gethostbyname_ex</A>).
</I>&gt;<i> 
</I>&gt;<i> It's a good question though. I'm sure a core dev will come along and
</I>&gt;<i> give a proper answer soon ;-)
</I>
Gar. I should read better. Twisted uses a threadpool of gethostname by
default, but you can plug in your own resolver (e.g. you can use
twisted.names):

<A HREF="http://twistedmatrix.com/documents/10.1.0/api/twisted.internet.interfaces.IReactorPluggableResolver.html#installResolver">http://twistedmatrix.com/documents/10.1.0/api/twisted.internet.interfaces.IReactorPluggableResolver.html#installResolver</A>

The question is whether the client code re-resolves on each re-connect,
and whether the current lookup interface is sufficient for this use
case.

Alas, I'm pretty sure the answer is no.

You could however always just do the DNS lookup yourself, passing
resulting correct IP to connectTCP, just make sure you don't block (e.g.
by using deferToThread to call gethostbyname_ex).


</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022569.html">[Twisted-Python] Twisted HTTP client supporting failover for multiple A records?
</A></li>
	<LI>Next message: <A HREF="022571.html">[Twisted-Python] Twisted HTTP client supporting failover for multiple A records?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22570">[ date ]</a>
              <a href="thread.html#22570">[ thread ]</a>
              <a href="subject.html#22570">[ subject ]</a>
              <a href="author.html#22570">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
