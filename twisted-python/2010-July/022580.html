<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Deferred instance has no attribute	'__getitem__' ??????
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Deferred%20instance%20has%20no%20attribute%0A%09%27__getitem__%27%20%3F%3F%3F%3F%3F%3F&In-Reply-To=AANLkTim8AwX-GfRPzrVr42eO-KriFl3eXtNceB2i7eCZ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022578.html">
   <LINK REL="Next"  HREF="022582.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Deferred instance has no attribute	'__getitem__' ??????</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Deferred%20instance%20has%20no%20attribute%0A%09%27__getitem__%27%20%3F%3F%3F%3F%3F%3F&In-Reply-To=AANLkTim8AwX-GfRPzrVr42eO-KriFl3eXtNceB2i7eCZ%40mail.gmail.com"
       TITLE="[Twisted-Python] Deferred instance has no attribute	'__getitem__' ??????">glyph at twistedmatrix.com
       </A><BR>
    <I>Thu Jul 15 23:38:44 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="022578.html">[Twisted-Python] Deferred instance has no attribute	'__getitem__' ??????
</A></li>
        <LI>Next message: <A HREF="022582.html">[Twisted-Python] Deferred instance has no attribute	'__getitem__' ??????
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22580">[ date ]</a>
              <a href="thread.html#22580">[ thread ]</a>
              <a href="subject.html#22580">[ subject ]</a>
              <a href="author.html#22580">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jul 15, 2010, at 4:32 PM, Ken MacDonald wrote:

&gt;<i>     @defer.inlineCallbacks
</I>&gt;<i>     def round_val(id, value, rule):
</I>&gt;<i>         &quot;&quot;&quot;
</I>&gt;<i>         Return first element of round_value_and_percent
</I>&gt;<i>         &quot;&quot;&quot;
</I>&gt;<i>         defer.returnValue(round_value_and_percent(id, value, 0, rule)[0])
</I>
&gt;<i> When I do:
</I>&gt;<i> result = yield round_val(1, 2, 3)
</I>&gt;<i> 
</I>&gt;<i> I get this: Deferred instance has no attribute '__getitem__'
</I>&gt;<i> 
</I>&gt;<i> Clues appreciated!
</I>

@inlineCallbacks must decorate only generator functions.

Since 'yield' doesn't appear anywhere in the body of round_val (or, for that matter, round_per) this code will break in other ways.  Allen Short's suggestion will fix your code because it added a 'yield', but you need to be aware of this issue in case there are other such functions in the future that don't actually handle any Deferreds.

Also, inlineCallbacks adds some overhead, and really should only be used when the resulting code is easier to read.  Personally, I think a simpler definition of round_val would be simply

    def round_val(id, value, rule):
        &quot;&quot;&quot;
        Return first element of round_value_and_percent
        &quot;&quot;&quot;
        return round_value_and_percent(id, value, 0, rule).addCallback(
            lambda valueAndPercent: valueAndPercent[0]
        )

no @inlineCallbacks required.


</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022578.html">[Twisted-Python] Deferred instance has no attribute	'__getitem__' ??????
</A></li>
	<LI>Next message: <A HREF="022582.html">[Twisted-Python] Deferred instance has no attribute	'__getitem__' ??????
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22580">[ date ]</a>
              <a href="thread.html#22580">[ thread ]</a>
              <a href="subject.html#22580">[ subject ]</a>
              <a href="author.html#22580">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
