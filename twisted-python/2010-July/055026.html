<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Lore to Sphinx Conversion Progress Report 6
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Lore%20to%20Sphinx%20Conversion%20Progress%20Report%206&In-Reply-To=%3CAANLkTilgY095g4mp7DVseYM-eEnnMBFNrxyiiZ0j0YPz%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="055023.html">
   <LINK REL="Next"  HREF="055029.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Lore to Sphinx Conversion Progress Report 6</H1>
    <B>Kevin Horn</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Lore%20to%20Sphinx%20Conversion%20Progress%20Report%206&In-Reply-To=%3CAANLkTilgY095g4mp7DVseYM-eEnnMBFNrxyiiZ0j0YPz%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Lore to Sphinx Conversion Progress Report 6">kevin.horn at gmail.com
       </A><BR>
    <I>Sat Jul 10 14:17:03 MDT 2010</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="055023.html">[Twisted-Python] Lore to Sphinx Conversion Progress Report 6
</A></li>
        <LI>Next message (by thread): <A HREF="055029.html">[Twisted-Python] Lore to Sphinx Conversion Progress Report 6
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55026">[ date ]</a>
              <a href="thread.html#55026">[ thread ]</a>
              <a href="subject.html#55026">[ subject ]</a>
              <a href="author.html#55026">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Jul 10, 2010 at 2:40 AM, Tim Allen &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">screwtape at froup.com</A>&gt; wrote:

&gt;<i> On Sat, Jul 10, 2010 at 02:58:40AM -0000, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A> wrote:
</I>&gt;<i> &gt; At last I've got a buildbot set up generating the sphinx docs.  The
</I>&gt;<i> &gt; build results can be seen here:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   <A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; (or with a different revision number for different revisions; the
</I>&gt;<i> &gt; containing directory is browseable).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It would be great if everyone could go look around and report any
</I>&gt;<i> &gt; problems you see.
</I>&gt;<i>
</I>&gt;<i>     - In the Documentation Table Of Contents page, &quot;Historical
</I>&gt;<i>      Documents&quot; is listed between &quot;Twisted Core&quot; and &quot;Twisted Lore&quot;
</I>&gt;<i>      (presumably because of alphabetical order) but this seems
</I>&gt;<i>      a strange place for it. Could it be moved to the bottom, or an
</I>&gt;<i>      appendix, or something?
</I>&gt;<i>
</I>
They're in alphabetical order.  The TOC page is generated dynamically by
looking at the file structure of the docs and that's the order file-globbing
lists them in.  We can fix this manually post-conversion.


&gt;<i>    - The bottom of every page has a &quot;Download in other formats: Plain
</I>&gt;<i>      Text&quot; link that doesn't work; presumably scooped up from the Trac
</I>&gt;<i>      templates. It should be removed (the Sphinx &quot;Show Source&quot; link is
</I>&gt;<i>      in the right-hand sidebar anyway).
</I>&gt;<i>
</I>
Yeah, this is a flaw in the trac theme.  Looks like I forgot to remove it.


&gt;<i>    - When the breadcrumb navigation at the top of the page gets too
</I>&gt;<i>      long[1], it wraps to a second line, which looks kind of odd
</I>&gt;<i>      because the nice gradient background image loops. Changing the CSS
</I>&gt;<i>      background colour to be the same as the bottom of the gradient
</I>&gt;<i>      image would probably help.
</I>&gt;<i>    - Firefox's Error Console reports:
</I>&gt;<i>        - a bogus &quot;%&quot; on line 56 of twistedtrac.css,
</I>&gt;<i>        - bogus // comments on lines 559, 577, 588, 598 of trac.css (CSS
</I>&gt;<i>          only allows /* winged comments */)
</I>&gt;<i>    - Chromium's error console reports:
</I>&gt;<i>        - A 404 error for &quot;/trac/chrome/common/js/jquery.js&quot;
</I>&gt;<i>        - A 404 error for &quot;/trac/chrome/common/js/trac.js&quot;
</I>&gt;<i>        - A 404 error for &quot;/trac/chrome/common/js/search.js&quot;
</I>&gt;<i>        - A 404 error for &quot;/builds/sphinx-html-15615/_static/dots.gif&quot;
</I>&gt;<i>
</I>
Ah! This explains why the search quit working.  Not sure why these files are
missing,  Probably something to do with the custom theme.


&gt;<i>    - The Twisted.Conch tutorial[1] has a number of things surrounded
</I>&gt;<i>      with double-backticks like &quot;``Deferred``&quot; or
</I>&gt;<i>      &quot;``ClientTransport``&quot;. I'm not sure if that's deliberate or if
</I>&gt;<i>      it's markup gone horribly wrong.
</I>&gt;<i>
</I>
This is probably due to missing spaces before/after the markup in the rst
source.  One of those things that will need to be fixed manually.  I spent a
lot of time trying to fix this in lore2sphinx and when you fix it in one
place, it breaks somewhere else.  Right now the automated conversion is
about as good as it is likely to get with a sane amount of effort.


&gt;<i>    - On the same page, the text &quot;:api:`
</I>&gt;<i>      twisted.internet.interface.Transport
</I>&gt;<i>      &lt; twisted.internet.interface.Transport&gt;`&quot; appears, which also
</I>&gt;<i>      looks wrong.
</I>&gt;<i>
</I>
DItto.


&gt;<i>    - The Conch code examples (as linked from the code examples page[2])
</I>&gt;<i>      are sent with a Python mime-type (which Firefox tries to download)
</I>&gt;<i>      while the .tac files are sent as text/html; this may be an
</I>&gt;<i>      artifact of the docs being hosted on the buildbot machine rather
</I>&gt;<i>      than Sphinx, but I think it would be nice if by default they were
</I>&gt;<i>      displayed in the browser, syntax-highlighted, with an option to
</I>&gt;<i>      download the original files (much like Trac does).
</I>&gt;<i>
</I>
This is a web server configuration thing.  The files are actually .py and
.tac files (and probably need to remain so, if we ever want to get automated
example code tests going).

Maybe we can do some web server magic to get them nicely displayed in the
browser, but I see that as a secondary issue for the moment.  Anyone should
feel free to give a shout if they disagree, though.


&gt;<i>    - The Twisted Split FAQ[3] has more visible markup:
</I>&gt;<i>      &quot;twisted.protocols:superscript::ref:`[1]
</I>&gt;<i>      &lt;core-upgrades-2.0-split-protocols&gt; `&quot;. The footnote target is
</I>&gt;<i>      kind of messed up, too.
</I>&gt;<i>
</I>
Another spacing issue.


&gt;<i>    - The Twisted Split FAQ[3] has a heading &quot;Why are arr the packages
</I>&gt;<i>      still named twisted.*subproject*?&quot;, but it's not obvious whether
</I>&gt;<i>      the author was trying to use italics (in which case it's
</I>&gt;<i>      a lore2sphinx bug) or globbing (in which case it's not).
</I>&gt;<i>
</I>
Pretty sure it was supposed to be italics.  Spacing again.  There are ways
to make this display properly, but it'll need to be done manually.

Also, this is pretty outdated stuff...we might consider just removing some
of this.  Or perhaps moving some of it into a more obvious place.


&gt;<i>    - The Twisted Zope Interfaces FAQ[4] has inline Python source
</I>&gt;<i>      examples that don't appear to be marked up properly (although this
</I>&gt;<i>      is possibly a problem with the original Lore source). The answer
</I>&gt;<i>      to question &quot;How can I update my own code?&quot; is one example.
</I>&gt;<i>
</I>
The code bits are marked up this way because of the attributes used on the
elements in the Lore source.  We can change it easily


&gt;<i>    - The Banana Protocol Specifications[5], under the heading
</I>&gt;<i>      &quot;Examples&quot; mentions &quot;the type bytes are marked in bold&quot; but
</I>&gt;<i>      actually they're surrounded by double-asterisks.
</I>&gt;<i>
</I>
Double asterisks are the markup for bold in rst.  Another spacing and/or
nested inline markup issue.


&gt;<i>    - The Twisted Coding Standard[6], mentions &quot;the complete test
</I>&gt;<i>      suite in <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">trunk at HEAD</A>&quot; - and &quot;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">trunk at HEAD</A>&quot; is converted into
</I>&gt;<i>      a mailto: link.
</I>&gt;<i>
</I>
Huh.  I guess that's Sphinx trying to be helpful.  Good catch.  That'll
definitely need fixing.


&gt;<i>    - Links followed by punctuation seem to leave a space between the
</I>&gt;<i>      link text and the punctuation. See &quot;test-driven .&quot; and &quot;Test
</I>&gt;<i>      Standard .&quot; in the Twisted Coding Standard[6], but I've observed
</I>&gt;<i>      the same problem on multiple pages.
</I>&gt;<i>
</I>
This is the spacing issue again, but in reverse.  It's relatively easy for
lore2sphinx to detect links and add a space at the end, so that's what it
does.  There's ways to get around this and get rid of the space by escaping
it, but it rapidly get mind-boggling, so this is another thing that will
need manual fixing.


&gt;<i>    - The Twisted Coding Standard[6] mentions &quot;If you modify, or write
</I>&gt;<i>      a new, HOWTO, please read the Lore documentation to learn how to
</I>&gt;<i>      format the docs&quot;; if there's not already a follow-up ticket for
</I>&gt;<i>      the lore-sphinx conversion titled &quot;Remove references to Lore from
</I>&gt;<i>      Twisted's non-Lore-related documentation&quot;, there should be, and
</I>&gt;<i>      this should be in it.
</I>&gt;<i>
</I>
There isn't, but there will be.  See the transition plan here:
<A HREF="http://twistedsphinx.funsize.net/transition_plan.html">http://twistedsphinx.funsize.net/transition_plan.html</A>


&gt;<i>    - The Twisted Coding Standard[6], under the heading &quot;Modules&quot; says
</I>&gt;<i>      &quot;Use this template:&quot; and then
</I>&gt;<i>      &quot;../listings/new_module_template.py&quot;.. and *then* includes the
</I>&gt;<i>      content of said template inline. Presumably it should either link
</I>&gt;<i>      to it or include it, but not both.
</I>&gt;<i>
</I>
It actually is including an external file there (i.e. the contents are not
in the rst source, but in the
&quot;../listings/new_module_template.py&quot; file.  What looks like a link there is
actually a sort of heading to
let the reader see where it's coming from.  I think this can probably be
made clearer with some theme/css changes.


&gt;<i>    - The HTML Documentation Standard for Twisted[7] has more visible
</I>&gt;<i>      markup: in the list of allowable markup, most tags are rendered
</I>&gt;<i>      properly except for &quot;``&lt;tr&gt;``&quot;.
</I>&gt;<i>
</I>
Missing space after preceding comma.  Another manual fix.


&gt;<i>    - It seems that the HTML Documentation Standard for Twisted[7] is
</I>&gt;<i>      actually &quot;how to write Lore documentation&quot;, despite the name.
</I>&gt;<i>      Maybe this file should be scheduled for the post-transition purge,
</I>&gt;<i>      or at least moved to the Lore documentation.
</I>&gt;<i>
</I>
It pretty much is &quot;how to write Lore documentation&quot;.  I think it should
probably be moved into the Lore docs, and replaced with the
(yet to be written, but again see the transition plan) planned Twisted
Documentation Guide.


&gt;<i>    - Working from Twisted's Subversion Repository[8] has visible markup
</I>&gt;<i>      that looks like an attempt to link &quot;the Subversion homepage&quot; under
</I>&gt;<i>      the heading &quot;Checkout&quot;.
</I>&gt;<i>
</I>
Missing preceding space again.


&gt;<i>    - Under the heading &quot;Alternate tree names&quot;, the document uses
</I>&gt;<i>      RIGHT DOUBLE QUOTATION MARK instead of LEFT DOUBLE QUOTATION MARK
</I>&gt;<i>      in 'directory other than”Twisted” .' Looks like a problem in the
</I>&gt;<i>      original markup. Also note the space between the LEFT DOUBLE
</I>&gt;<i>      QUOTATION MARK and the punctuation.
</I>&gt;<i>
</I>
The missing preceding space actually is what's causing the quotes to be
wrong.


&gt;<i>    - The same document has more broken links under the &quot;Combinator&quot;
</I>&gt;<i>      heading.
</I>&gt;<i>
</I>
Missing preceding spaces again.


&gt;<i>    - The same document has broken markup under &quot;Running tests&quot;:
</I>&gt;<i>      &quot;``twisted/protocols/imap4.py``&quot; and later
</I>&gt;<i>      &quot;``twisted.mail.test.test_imap``&quot;.
</I>&gt;<i>    - The same document has broken markup under &quot;Building docs&quot;:
</I>&gt;<i>      &quot;``doc/development/policy/svn-dev.xhtml`` ,&quot; (also trailing space
</I>&gt;<i>      before punctuation) and
</I>&gt;<i>      &quot;``doc/development/policy/svn-dev.html`` :&quot; (again).
</I>&gt;<i>    - The same document has a broken link under &quot;Committing and
</I>&gt;<i>      Post-commit Hooks&quot;, attempting to link the text
</I>&gt;<i>      &quot;trac-post-commit-hook&quot;.
</I>&gt;<i>    - The same document has broken markup under &quot;Emacs&quot;:
</I>&gt;<i>      &quot;``emacs/twisted-dev.el``&quot;.
</I>&gt;<i>    - The same document has a broken link under &quot;Building Debian
</I>&gt;<i>      packages&quot;, attempting to link th text &quot;stdeb&quot;.
</I>&gt;<i>
</I>
All bad spacing issues.


&gt;<i>
</I>&gt;<i> That's probably enough feedback to be getting on with; most of the
</I>&gt;<i> problems appear to be from normalising &quot;\n&quot; in Lore docs to &quot;&quot; instead
</I>&gt;<i> of &quot; &quot;, and also from adding whitespace after things. It is generally
</I>&gt;<i> looking pretty great, though!
</I>&gt;<i>
</I>
Yeah, that's pretty much it.  As I said above though, if you &quot;fix&quot; it one
place, it breaks in another, so I tried to balance things in such a way that
the least broken markup appears in the output.

Almost all of the remaining problems will need to be fixed manually.


&gt;<i>
</I>&gt;<i> Some extra thoughts:
</I>&gt;<i>    - The ReviewingDocumentation wiki page has a section called &quot;Editing
</I>&gt;<i>      man pages&quot; that describes how to turn the nicely-formatted
</I>&gt;<i>      manpages into Lore input files. Would it be possible to do that as
</I>&gt;<i>      part of the lore2sphinx run, have the manpages included in the
</I>&gt;<i>      Sphinx documentation, and from then on generate the manpages from
</I>&gt;<i>      the .rst files instead of the other way around?
</I>&gt;<i>
</I>
Sphinx does have a man page builder now, but I don't think it existed when I
was writing lore2sphinx, so I haven't really considered this.

So you're suggesting convert the man pages to Lore format -&gt; use lore2sphinx
to convert the resulting Lore docs to rst -&gt; build as part of the Sphinx
process, yes?

I think this is a worthwhile idea, but I'd prefer to leave it until after
the main docs are converted (i.e. under a separate ticket).  lore2sphinx can
be used on just the man files later on if need be, though it would take a
little mucking around.


&gt;<i>
</I>&gt;<i> [1]: &lt;<A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/</A>
</I>&gt;<i>    conch/howto/conch_client.html&gt;
</I>&gt;<i> [2]: &lt;<A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/</A>
</I>&gt;<i>    conch/examples/index.html&gt;
</I>&gt;<i> [3]: &lt;<A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/</A>
</I>&gt;<i>    core/upgrades/2.0/split.html&gt;
</I>&gt;<i> [4]: &lt;<A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/</A>
</I>&gt;<i>    core/upgrades/2.0/components.html&gt;
</I>&gt;<i> [5]: &lt;<A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/</A>
</I>&gt;<i>    core/specifications/banana.html&gt;
</I>&gt;<i> [6]: &lt;<A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/</A>
</I>&gt;<i>    core/development/policy/coding-standard.html&gt;
</I>&gt;<i> [7]: &lt;<A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/</A>
</I>&gt;<i>    core/development/policy/doc-standard.html&gt;
</I>&gt;<i> [8]: &lt;<A HREF="http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/">http://buildbot.twistedmatrix.com/builds/sphinx-html-15615/projects/</A>
</I>&gt;<i>    core/development/policy/svn-dev.html&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>Thanks for the fantastic (and nicely detailed) feedback, Tim!

Please take a look at the transition plan.  In a few days (maybe sooner), I
should have the base docs in a branch, and the &quot;chunk tickets&quot; referenced in
the transition plan created.  This is pretty much _exactly_ what I'd like to
see in those &quot;chunk tickets&quot;.  Hopefully you haven't already burned up your
brain staring at markup issues. :) We could really use this kind of help
throughout the process.

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20100710/19c735a6/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="055023.html">[Twisted-Python] Lore to Sphinx Conversion Progress Report 6
</A></li>
	<LI>Next message (by thread): <A HREF="055029.html">[Twisted-Python] Lore to Sphinx Conversion Progress Report 6
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55026">[ date ]</a>
              <a href="thread.html#55026">[ thread ]</a>
              <a href="subject.html#55026">[ subject ]</a>
              <a href="author.html#55026">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
