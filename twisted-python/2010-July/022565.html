<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] What is the minimum effort solution to	make	inetd-managed twisted-based application?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20What%20is%20the%20minimum%20effort%20solution%20to%0A%09make%09inetd-managed%20twisted-based%20application%3F&In-Reply-To=20100714023146.2312.1322622072.divmod.xquotient.16%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022559.html">
   <LINK REL="Next"  HREF="022576.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] What is the minimum effort solution to	make	inetd-managed twisted-based application?</H1>
    <B>Alexey</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20What%20is%20the%20minimum%20effort%20solution%20to%0A%09make%09inetd-managed%20twisted-based%20application%3F&In-Reply-To=20100714023146.2312.1322622072.divmod.xquotient.16%40localhost.localdomain"
       TITLE="[Twisted-Python] What is the minimum effort solution to	make	inetd-managed twisted-based application?">twisted-web at udmvt.ru
       </A><BR>
    <I>Wed Jul 14 12:00:00 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="022559.html">[Twisted-Python] What is the minimum effort solution to	make	inetd-managed twisted-based application?
</A></li>
        <LI>Next message: <A HREF="022576.html">[Twisted-Python] What is the minimum effort solution to	make	inetd-managed twisted-based application?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22565">[ date ]</a>
              <a href="thread.html#22565">[ thread ]</a>
              <a href="subject.html#22565">[ subject ]</a>
              <a href="author.html#22565">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Jul 14, 2010 at 02:31:46AM -0000, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A> wrote:
&gt;<i> I'll answer whatever questions I can. :)
</I>
Oh, I have some questions...
I asked some questions in the form of suggestions, well, don't take them seriously,
I only ask, not really propose anything. However I'm ready to hear you
about what I'm wrong with.

Here, what I have discovered so far:
There are transport factories in twisted, not defined as such, but really they are,
like tcp.Port and tcp.Connector.

They interface with protocol factories. That interface is asymmetric between
server protocol factory and client protocol factory. Well, the implementation
of client's side protocol factory and server's side should differ, but why should interfaces?
That is okay, while you only have different and asymmetric transport factories
the ones for client transports and the others for server transports.
But is there really something in created and connected transport,
that makes it server's or client's ? I guess nothing, except protocol instance attached.

Q: Why should protocol factory interface &quot;bother&quot; about client/server dichotomy?
For example, why should I be limited to only using PBClientFactory with connectXXX()
variants of transport factories?
Why should I do not want (under some crazy circumstances) to use reverse-connects
and run PBServerFactory with connectXXX()?
Well, maybe not PB, but what about other protocols?
Should it work? Well, I suppose, it would break if you try now, but is
is supposed to be that asymmetric?

And after all, there is absolute symmetry in UDP-based transports.

Q: Consider socketpair() variant - a pair of completely symmetric mutually
connected sockets.
Should I provide transport factory for use with server protocol factories
and another transport factory for use with client protocol factories?

That idea sounds stupid to me, there can be no difference in the implementation,
except in the interfaces to protocol factories.

I see there are some code, that can be moved from tcp.Port and tcp.Connector
to some common base class of an abstract transport factory. That class could
interfere with protocol factory without knowing whether it is server or client.
Protocol factory already knows about it's own asymmetry.

I do identify the events, that protocol factory receives from transport factory as these,
please correct me if I'm wrong:

global (factory-context) events:
- start factory                         doStart
- entering transport creation phase     startedConnecting       &lt;server: when bind&amp;listen succeeds why does anybody
                                                                 not invoke something like startedListenig ?&gt;
- stop factory                          doStop

per transport connection events:
- on transport creation                 &lt;none exists?why?&gt;      &lt;after connect() or listen() returns result, at this point
                                                                 we may decide to prevent further transport instantiation,
                                                                 especially if we are server-side protocol factory&gt;
- transport creation failed             clientConnectionFailed  &lt;server: direct analogy - accept() may return an error,
                                                                 but that event not exists for server. why?&gt;
- transport created succesfully         buildProtocol           &lt;a request to build a protocol instance implies, that
                                                                 transport instance have been succesfully created. or not?&gt;
- build protocol                        buildProtocol           
- after transport and protocol creation clientConnectionMade    &lt;in t.s.pb.PBXXXXFactory, event sent by protocol instance,
                                                                 name not defined in any Interface, why not?&gt;
- transport closed                      clientConnectionLost    &lt;why not define this for server too to be consistent?&gt;

They are not client/servers asymmetric as I see them, but have asymmetric names in twisted
and sometimes when server variants exists, they have no fixed names defined in Interface classes :(

What is the difference between doStart and startedConnecting (together with imaginary startedListening)?

And who is responsible for sending which events? That is not defined in documentation.

What do you think about these names:
doStart()
transportFactoryStarted()
onBeforeTransportCreate()
connectionFailed()
buildProtocol()
connectionMade()
connectionLost()
doStop()
Well, I understand, you will veto them arguing by lot of code using old names,
but I am interested to know will they break the abstraction of protocol factory?

Can please anyone explain the asymmetry of the interfaces of protocol factories
and tell how can it be useful for me.

Thanks for your time.

Alexey.

-- 
&#1089; &#1091;&#1074;&#1072;&#1078;&#1077;&#1085;&#1080;&#1077;&#1084;,
&#1040;&#1083;&#1077;&#1082;&#1089;&#1077;&#1081; &#1064;&#1087;&#1072;&#1075;&#1080;&#1085;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081; &#1072;&#1076;&#1084;&#1080;&#1085;&#1080;&#1089;&#1090;&#1088;&#1072;&#1090;&#1086;&#1088;
&#1094;&#1077;&#1093;&#1072; &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1095;&#1080; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1090;&#1077;&#1093;&#1085;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1075;&#1086; &#1094;&#1077;&#1085;&#1090;&#1088;&#1072; &#1090;&#1077;&#1083;&#1077;&#1082;&#1086;&#1084;&#1084;&#1091;&#1085;&#1080;&#1082;&#1072;&#1094;&#1080;&#1081;
&#1054;&#1040;&#1054; &quot;&#1042;&#1086;&#1083;&#1075;&#1072;&#1058;&#1077;&#1083;&#1077;&#1082;&#1086;&#1084;&quot; 
&#1092;&#1080;&#1083;&#1080;&#1072;&#1083; &#1074; &#1059;&#1076;&#1084;&#1091;&#1088;&#1090;&#1089;&#1082;&#1086;&#1081; &#1088;&#1077;&#1089;&#1087;&#1091;&#1073;&#1083;&#1080;&#1082;&#1077;.

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022559.html">[Twisted-Python] What is the minimum effort solution to	make	inetd-managed twisted-based application?
</A></li>
	<LI>Next message: <A HREF="022576.html">[Twisted-Python] What is the minimum effort solution to	make	inetd-managed twisted-based application?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22565">[ date ]</a>
              <a href="thread.html#22565">[ thread ]</a>
              <a href="subject.html#22565">[ subject ]</a>
              <a href="author.html#22565">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
