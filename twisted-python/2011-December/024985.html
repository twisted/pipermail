<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Telnet negotiation with Twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Telnet%20negotiation%20with%20Twisted&In-Reply-To=CAE18iQUvtH-yKBx48kkLBv8rivAaQgd2zjjpdEL3%2BxA4fLHV_w%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024984.html">
   <LINK REL="Next"  HREF="024986.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Telnet negotiation with Twisted</H1>
    <B>Lee Orsino</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Telnet%20negotiation%20with%20Twisted&In-Reply-To=CAE18iQUvtH-yKBx48kkLBv8rivAaQgd2zjjpdEL3%2BxA4fLHV_w%40mail.gmail.com"
       TITLE="[Twisted-Python] Telnet negotiation with Twisted">lmorsino at gmail.com
       </A><BR>
    <I>Thu Dec  1 20:00:28 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="024984.html">[Twisted-Python] Telnet negotiation with Twisted
</A></li>
        <LI>Next message: <A HREF="024986.html">[Twisted-Python] Telnet negotiation with Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24985">[ date ]</a>
              <a href="thread.html#24985">[ thread ]</a>
              <a href="subject.html#24985">[ subject ]</a>
              <a href="author.html#24985">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Patrick! Thanks for the suggestion. After I call self.will(LINEMODE), I
get

Failure: twisted.conch.telnet.OptionRefused:
twisted.conch.telnet.OptionRefused:
'&quot;'

So I know at least something is happening. I guess this just became a
Telnet question instead of a twisted question. But I still don't understand
how enableRemote and requestNegotiation are supposed to be used with this.
Anyway, this happens in PuTTY as well as the Windows telnet client. Below
is the code, if it helps, as simple as I could get it. Maybe there is
something obvious that I need to do:



from twisted.internet.protocol import Protocol, Factory
from twisted.conch.telnet import TelnetTransport, TelnetProtocol,
ITelnetProtocol
from twisted.internet import reactor
import sys

class EchoTransport(TelnetTransport):
def __init__(self, protocolFactory=None, *a, **kw):
TelnetTransport.__init__(self)
if protocolFactory is not None:
self.protocolFactory = protocolFactory
self.protocolArgs = a
self.protocolKwArgs = kw

def connectionMade(self):
TelnetTransport.connectionMade(self)
print (&quot;connection made&quot;)

def connectionLost(self, reason):
print (&quot;connection lost&quot;)
reactor.stop()
 def applicationDataReceived(self, bytes):
TelnetTransport.applicationDataReceived(self, bytes)
bytes = bytes.strip()
 if (bytes == 'b'):
self.will(chr(34)) # Error here
 if (bytes == 'x'):
self.transport.write(&quot;goodbye&quot;)
TelnetTransport.loseConnection(self)

def main():
    f = Factory()
    f.protocol = lambda: EchoTransport(TelnetProtocol)
    reactor.listenTCP(8023, f)
    reactor.run()


if __name__ == '__main__':
    main()
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20111201/fd4caade/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-python/attachments/20111201/fd4caade/attachment-0001.htm</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024984.html">[Twisted-Python] Telnet negotiation with Twisted
</A></li>
	<LI>Next message: <A HREF="024986.html">[Twisted-Python] Telnet negotiation with Twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24985">[ date ]</a>
              <a href="thread.html#24985">[ thread ]</a>
              <a href="subject.html#24985">[ subject ]</a>
              <a href="author.html#24985">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
