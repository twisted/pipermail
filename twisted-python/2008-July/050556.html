<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] cred realm with __init__ methods under twistd
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20cred%20realm%20with%20__init__%20methods%20under%20twistd&In-Reply-To=%3C20080707230816.GA2639%40kallisti.us%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="018047.html">
   <LINK REL="Next"  HREF="050557.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] cred realm with __init__ methods under twistd</H1>
    <B>Ross Vandegrift</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20cred%20realm%20with%20__init__%20methods%20under%20twistd&In-Reply-To=%3C20080707230816.GA2639%40kallisti.us%3E"
       TITLE="[Twisted-Python] cred realm with __init__ methods under twistd">ross at kallisti.us
       </A><BR>
    <I>Mon Jul  7 17:08:16 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="018047.html">[Twisted-Python] [SIP]
</A></li>
        <LI>Next message (by thread): <A HREF="050557.html">[Twisted-Python] cred realm with __init__ methods under twistd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50556">[ date ]</a>
              <a href="thread.html#50556">[ thread ]</a>
              <a href="subject.html#50556">[ subject ]</a>
              <a href="author.html#50556">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everyone,

I'm working on a twisted application that uses cred and pb.  I'm
having a bit of trouble getting my realm working as I want.

In my .tac file, I have this:

p = portal.Portal(CNDRealm())
c = checkers.InMemoryUsernamePasswordDatabaseDontUse(user=&quot;passwd&quot;)
p.registerChecker(c)
application = service.Application(&quot;receiver&quot;)
service = service.IServiceCollection(application)
factory = pb.PBServerFactory(p)
internet.TCPServer(8800, factory).setServiceParent(service)


My realm, CNDRealm, looks like this:

from globals import devs, queues, conditions, devices
class CNDRealm(object):
    implements(portal.IRealm)
    def __init__(self):
        for i in devs:
            queues[i] = list()
            conditions[i] = threading.Condition()
            devices[i] = CNDDevice(i[0], socket.gethostbyname(i[0]), i[1], queues[i], conditions[i])
        log.msg(&quot;Initialized devices: &quot; % devices)

    def requestAvatar(self, aid, min, *interfaces):
        log.msg(&quot;Avatar requested: %s&quot; % aid)
        if pb.IPerspective not in interfaces:
            raise NotImplementedError
        return pb.IPerspective, CNDSubmitter(aid), lambda: None
    


However, I never get the log message from the __init__ method.  I know
that it's not being run because those dictionaries are never populated
with the data my app needs to be in there.


1) What's going on?  I'm pretty surprised to find that an object's
__init__ doesn't seem to be getting called!

2) Is there some better place in a twistd app to put general start-up
initialization kinds of things?

-- 
Ross Vandegrift
<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">ross at kallisti.us</A>

&quot;The good Christian should beware of mathematicians, and all those who
make empty prophecies. The danger already exists that the mathematicians
have made a covenant with the devil to darken the spirit and to confine
man in the bonds of Hell.&quot;
	--St. Augustine, De Genesi ad Litteram, Book II, xviii, 37


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="018047.html">[Twisted-Python] [SIP]
</A></li>
	<LI>Next message (by thread): <A HREF="050557.html">[Twisted-Python] cred realm with __init__ methods under twistd
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#50556">[ date ]</a>
              <a href="thread.html#50556">[ thread ]</a>
              <a href="subject.html#50556">[ subject ]</a>
              <a href="author.html#50556">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
