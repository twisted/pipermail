<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] symlink support in filepath.FilePath
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20symlink%20support%20in%20filepath.FilePath&In-Reply-To=20080324181546.6859.222156131.divmod.quotient.22453%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017172.html">
   <LINK REL="Next"  HREF="017175.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] symlink support in filepath.FilePath</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20symlink%20support%20in%20filepath.FilePath&In-Reply-To=20080324181546.6859.222156131.divmod.quotient.22453%40ohm"
       TITLE="[Twisted-Python] symlink support in filepath.FilePath">exarkun at divmod.com
       </A><BR>
    <I>Mon Mar 24 14:30:18 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="017172.html">[Twisted-Python] symlink support in filepath.FilePath
</A></li>
        <LI>Next message: <A HREF="017175.html">[Twisted-Python] symlink support in filepath.FilePath
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17174">[ date ]</a>
              <a href="thread.html#17174">[ thread ]</a>
              <a href="subject.html#17174">[ subject ]</a>
              <a href="author.html#17174">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 24 Mar 2008 13:15:46 -0500, Ying Li &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">cyli at alum.mit.edu</A>&gt; wrote:
&gt;&gt;&gt;<i>Should I just implement my own subclass of FilePath that handles symlinks 
</I>&gt;&gt;&gt;<i>and not try to change FilePath?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>It'd be great to have anything that's generally useful incorporated into
</I>&gt;&gt;<i>Twisted.  It might make sense to have a FilePath subclass for a while to
</I>&gt;&gt;<i>see what is an isn't useful for your SFTP server - or you might be happy
</I>&gt;&gt;<i>enough to briefly have a local copy of Twisted with your modifications
</I>&gt;&gt;<i>and only submit them once you're happy with them.
</I>&gt;<i>
</I>&gt;<i>Well, I did write one, and that's when I was told to start submitting my 
</I>&gt;<i>changes into FilePath.  :)
</I>
Aha. :)

&gt;<i>Basically I need to be able to handle symlinks as links - hence the restat.
</I>
So are you looking for something like this?

    fp = FilePath(...)
    fp.restat(lstat=True)
    fp.getModificationTime() # link's modification time

I'm not sure about that.  Aside from the freaky action at a distance, it
probably is prone to failures when certain FilePath methods internally
decide to restat, thus replacing the link data with data about the target.

The cop-out API would be one like this:

    fp = FilePath(...)
    fp.lstat().st_mtime # link's modification time

I can't think of anything strictly better at the moment, though.  What does
usage in your application suggest is a good approach?

&gt;<i>
</I>&gt;<i>There are other things I need, such as an openWithFlags method (basically, 
</I>&gt;<i>the ISFPTServer interface specifies that I need to be able to open a file 
</I>&gt;<i>with a bunch of flags (read, write, append, create, truncate, exclusive), 
</I>&gt;<i>and I'd like to simply pass that through to a method.  I've tried to come up 
</I>&gt;<i>with a fairly elaborate mapping of said flags onto (r, w, r+, w+, etc.), but 
</I>&gt;<i>there are some things (like the exclusive flag) I don't know what to do 
</I>&gt;<i>with.
</I>
It seems like FilePath.open has some issues currently.  It would be a good
thing if it had an API which allowed explicit, precise control over how the
open happened.

&gt;<i>
</I>&gt;<i>I'm not sure if this would be useful in FilePath.
</I>&gt;<i>Another thing I need is to be able to change permissions.  My applications 
</I>&gt;<i>ignores requests to change ownership and such, but being able to change 
</I>&gt;<i>permissions I think would be good.  And I know that FilePath.copyTo and 
</I>&gt;<i>FilePath.moveTo right now do not preserve permissions or ownership - I'm not 
</I>&gt;<i>sure if this is desired behavior, but if it isn't, then FilePath needs some 
</I>&gt;<i>mechanism for changing the attributes of a file or directory.  But then we 
</I>&gt;<i>get into platform problems, and FilePath may get overly complicated.
</I>&gt;<i>
</I>
FilePath.chmod would be a great addition.  `copyTo&#180; and `moveTo&#180; should try
to preserve permission (at least optionally).  I'm not sure if this would
have scary consequences (handling failures, for example, complicates the
matter), but at least the idea is nice.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017172.html">[Twisted-Python] symlink support in filepath.FilePath
</A></li>
	<LI>Next message: <A HREF="017175.html">[Twisted-Python] symlink support in filepath.FilePath
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17174">[ date ]</a>
              <a href="thread.html#17174">[ thread ]</a>
              <a href="subject.html#17174">[ subject ]</a>
              <a href="author.html#17174">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
