<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] win 32 reactor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20win%2032%20reactor&In-Reply-To=47F11119.3040501%40evotex.ch">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017257.html">
   <LINK REL="Next"  HREF="017253.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] win 32 reactor</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20win%2032%20reactor&In-Reply-To=47F11119.3040501%40evotex.ch"
       TITLE="[Twisted-Python] win 32 reactor">exarkun at divmod.com
       </A><BR>
    <I>Mon Mar 31 12:55:42 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="017257.html">[Twisted-Python] win 32 reactor
</A></li>
        <LI>Next message: <A HREF="017253.html">[Twisted-Python] Is psycopg or pygresql better with	twisted.enterprise?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17255">[ date ]</a>
              <a href="thread.html#17255">[ thread ]</a>
              <a href="subject.html#17255">[ subject ]</a>
              <a href="author.html#17255">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 31 Mar 2008 18:28:09 +0200, Gabriel Rossetti &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mailing_lists at evotex.ch</A>&gt; wrote:
&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>I need to use PyHook, a win32 lib allowing global input monitoring (mouse, 
</I>&gt;<i>keyboard, etc). It uses the PyWin32 extentions, in particular win32com's 
</I>&gt;<i>PumpMessages() function. This is an event loop defined like so :
</I>&gt;<i>
</I>&gt;<i>// @pymethod |pythoncom|PumpMessages|Pumps all messages for the current 
</I>&gt;<i>thread until a WM_QUIT message.
</I>&gt;<i>static PyObject *pythoncom_PumpMessages(PyObject *self, PyObject *args)
</I>&gt;<i>{
</I>&gt;<i>    MSG msg;
</I>&gt;<i>    int rc;
</I>&gt;<i>    Py_BEGIN_ALLOW_THREADS
</I>&gt;<i>    while ((rc=GetMessage(&amp;msg, 0, 0, 0))==1) {
</I>&gt;<i>        TranslateMessage(&amp;msg); // needed?
</I>&gt;<i>        DispatchMessage(&amp;msg);
</I>&gt;<i>    }
</I>&gt;<i>    Py_END_ALLOW_THREADS
</I>&gt;<i>    if (rc==-1)
</I>&gt;<i>        return PyWin_SetAPIError(&quot;GetMessage&quot;);
</I>&gt;<i>    Py_INCREF(Py_None);
</I>&gt;<i>    return Py_None;
</I>&gt;<i>}
</I>&gt;<i>
</I>&gt;<i>my question is ho can I make this work with twisted? Is there a way to use 
</I>&gt;<i>the supplied win32 reactors (there are three I think) or do I have to write 
</I>&gt;<i>one myself? Could someone please point me in the right direction?
</I>
The three reactors you're probably referring to are selectreactor, win32er,
and IOCP reactor.  Of these, only the latter two do anything particular to
Windows (the first just uses select(2), which Windows sort of has).

win32er is basically a loop around MsgWaitForMultipleObjects.  IOCP reactor
is basically a loop around GetQueuedCompletionStatus.  One way to look at
your question is to consider how GetMessage/TranslateMessage/DispatchMessage
interact with MWFMO and GQCS.  This is basically a Windows API question, so
I can't answer it, since I know very little about Windows APIs.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017257.html">[Twisted-Python] win 32 reactor
</A></li>
	<LI>Next message: <A HREF="017253.html">[Twisted-Python] Is psycopg or pygresql better with	twisted.enterprise?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17255">[ date ]</a>
              <a href="thread.html#17255">[ thread ]</a>
              <a href="subject.html#17255">[ subject ]</a>
              <a href="author.html#17255">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
