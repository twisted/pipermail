<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] symlink support in filepath.FilePath
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20symlink%20support%20in%20filepath.FilePath&In-Reply-To=%3C20080324205845.21558.1364408822.divmod.xquotient.8789%40joule.divmod.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="049683.html">
   <LINK REL="Next"  HREF="049689.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] symlink support in filepath.FilePath</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20symlink%20support%20in%20filepath.FilePath&In-Reply-To=%3C20080324205845.21558.1364408822.divmod.xquotient.8789%40joule.divmod.com%3E"
       TITLE="[Twisted-Python] symlink support in filepath.FilePath">glyph at divmod.com
       </A><BR>
    <I>Mon Mar 24 14:58:45 MDT 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="049683.html">[Twisted-Python] symlink support in filepath.FilePath
</A></li>
        <LI>Next message (by thread): <A HREF="049689.html">[Twisted-Python] Re: Twisted-Python Digest, Vol 48, Issue 41
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49686">[ date ]</a>
              <a href="thread.html#49686">[ thread ]</a>
              <a href="subject.html#49686">[ subject ]</a>
              <a href="author.html#49686">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 06:30 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at divmod.com</A> wrote:
&gt;<i>On Mon, 24 Mar 2008 13:15:46 -0500, Ying Li &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">cyli at alum.mit.edu</A>&gt; wrote:
</I>
&gt;<i>So are you looking for something like this?
</I>&gt;<i>
</I>&gt;<i>    fp = FilePath(...)
</I>&gt;<i>    fp.restat(lstat=True)
</I>&gt;<i>    fp.getModificationTime() # link's modification time
</I>&gt;<i>
</I>&gt;<i>I'm not sure about that.  Aside from the freaky action at a distance, 
</I>&gt;<i>it
</I>&gt;<i>probably is prone to failures when certain FilePath methods internally
</I>&gt;<i>decide to restat, thus replacing the link data with data about the 
</I>&gt;<i>target.
</I>&gt;<i>
</I>&gt;<i>The cop-out API would be one like this:
</I>&gt;<i>
</I>&gt;<i>    fp = FilePath(...)
</I>&gt;<i>    fp.lstat().st_mtime # link's modification time
</I>&gt;<i>
</I>&gt;<i>I can't think of anything strictly better at the moment, though.  What 
</I>&gt;<i>does
</I>&gt;<i>usage in your application suggest is a good approach?
</I>
I am not working on this application, but I have some ideas of my own...

It occurs to me that isfile and isdir both use cached stat results, but 
islink re-lstat()s each time.  This could of course give a potentially 
inconsistent view of the filesystem without restat()'ing.

Without regard to backwards compatibility, I would probably suggest that 
we do something like this:

    fp = FilePath(...)
    fp.getModificationTime() # link time
    fp.followLink().getModificationTime() # destination time (even if 
dest is a link!)

This would allow finer-grained control of what exactly you were asking 
for.  (It would also work more nicely by default with broken symlinks.) 
However, keeping compatibility in mind (given that this is easily API- 
compatible,  but behavior would change very slightly and ostensibly be 
less buggy, I'm not sure whether to do this or not):

    fp = FilePath(...)
    fp.getModificationTime() # destination time
    fp.asLink().getModificationTime() # link time
    fp.asLink().followLink() #... etc

This is basically the same as your cop-out example, except we don't 
introduce yet another interface for other filepath implementations to 
emulate.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="049683.html">[Twisted-Python] symlink support in filepath.FilePath
</A></li>
	<LI>Next message (by thread): <A HREF="049689.html">[Twisted-Python] Re: Twisted-Python Digest, Vol 48, Issue 41
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49686">[ date ]</a>
              <a href="thread.html#49686">[ thread ]</a>
              <a href="subject.html#49686">[ subject ]</a>
              <a href="author.html#49686">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
