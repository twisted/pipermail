<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted plugins
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted%20plugins&In-Reply-To=%3C20080303135242.6859.4124078.divmod.quotient.15107%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="049440.html">
   <LINK REL="Next"  HREF="049444.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted plugins</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted%20plugins&In-Reply-To=%3C20080303135242.6859.4124078.divmod.quotient.15107%40ohm%3E"
       TITLE="[Twisted-Python] twisted plugins">exarkun at divmod.com
       </A><BR>
    <I>Mon Mar  3 06:52:42 MST 2008</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="049440.html">[Twisted-Python] twisted plugins
</A></li>
        <LI>Next message (by thread): <A HREF="049444.html">[Twisted-Python] twisted plugins
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49441">[ date ]</a>
              <a href="thread.html#49441">[ thread ]</a>
              <a href="subject.html#49441">[ subject ]</a>
              <a href="author.html#49441">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, 03 Mar 2008 14:44:12 +0100, Gabriel Rossetti &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">mailing_lists at evotex.ch</A>&gt; wrote:
&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>I tried creating some test plugins using the plugin howto on the twisted 
</I>&gt;<i>website. I did as shown, I added the plugins dir to the PYTHONPATH and 
</I>&gt;<i>tested it. The problem is I get nothing back when calling 
</I>&gt;<i>getPlugins(IMyInterface).  Here is some code :
</I>&gt;<i>
</I>&gt;<i>----------------------------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>    from zope.interface import Interface
</I>&gt;<i>
</I>&gt;<i>    class IHelloWorld(Interface):
</I>&gt;<i>        &quot;&quot;&quot;
</I>&gt;<i>        A simple test plugin that displays &quot;Hello world&quot;
</I>&gt;<i>        &quot;&quot;&quot;
</I>&gt;<i>              def display():
</I>&gt;<i>            &quot;&quot;&quot;
</I>&gt;<i>            Displays on stdout &quot;Hello world&quot; in a language chosen by the
</I>&gt;<i>    programmer
</I>&gt;<i>            &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i>----------------------------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>    from twisted.plugin import IPlugin
</I>&gt;<i>    from zope.interface import implements
</I>&gt;<i>    from interfaces import ihelloworld
</I>&gt;<i>
</I>&gt;<i>    class EnglishHelloWorld(object):
</I>&gt;<i>              implements(IPlugin, ihelloworld.IHelloWorld)
</I>&gt;<i>
</I>&gt;<i>        def display(self):
</I>&gt;<i>            &quot;&quot;&quot;
</I>&gt;<i>            Displays on stdout &quot;Hello world&quot; in English
</I>&gt;<i>            &quot;&quot;&quot;
</I>&gt;<i>            print &quot;Hello world!&quot;
</I>&gt;<i>
</I>&gt;<i>----------------------------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>    from twisted.plugin import getPlugins
</I>&gt;<i>    from twisted.plugin import IPlugin
</I>&gt;<i>    from interfaces import ihelloworld
</I>&gt;<i>
</I>&gt;<i>    def displayHelloWorld():
</I>&gt;<i>              for h in getPlugins(ihelloworld.IHelloWorld):
</I>&gt;<i>            h().display()
</I>&gt;<i>              if(__name__ == &quot;__main__&quot;):
</I>&gt;<i>        displayHelloWorld()
</I>&gt;<i>
</I>&gt;<i>----------------------------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>I tried running in debug mode to see what happens, but I don't get it, in 
</I>&gt;<i>the getPlugins() code, it does this :
</I>&gt;<i>
</I>&gt;<i>    allDropins = getCache(package)
</I>&gt;<i>
</I>&gt;<i>and in this dict I see my plugins, but their inner &quot;plugin&quot; member is an 
</I>&gt;<i>empty list. I looked at the code of some of the examples, they used 
</I>&gt;<i>&quot;classProvides()&quot; and not &quot;implements()&quot;, so I tried that :
</I>&gt;<i>
</I>&gt;<i>----------------------------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>    from twisted.plugin import IPlugin
</I>&gt;<i>    from zope.interface import implements
</I>&gt;<i>    from zope.interface import classProvides
</I>&gt;<i>    from interfaces import ihelloworld
</I>&gt;<i>
</I>&gt;<i>    class EnglishHelloWorld(object):
</I>&gt;<i>              classProvides(IPlugin, ihelloworld.IHelloWorld)
</I>&gt;<i>
</I>&gt;<i>        def display(self):
</I>&gt;<i>            &quot;&quot;&quot;
</I>&gt;<i>            Displays on stdout &quot;Hello world&quot; in English
</I>&gt;<i>            &quot;&quot;&quot;
</I>&gt;<i>            print &quot;Hello world!&quot;
</I>&gt;<i>
</I>&gt;<i>----------------------------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>which works, is the doc out of sync with the current code or did I do 
</I>&gt;<i>something wrong? Another question, it's not really very practical to have to 
</I>&gt;<i>iterate all the plugins and I guess test to see which one is which, is there 
</I>&gt;<i>a better way of doing it?
</I>
Using classProvides can be correct, although it's not quite in your example
code because EnglishHelloWorld must be instantiated in order to use it, and
that isn't reflected in your IHelloWorld interface.  You could make display
a static or class method.  Or you continue using implements and instantiate
EnglishHelloWorld, binding a name to the result (as the documentation shows
with steelPlate/brassPlate).

In the example, when the plugin system finds objects, it finds steelPlate
and brassPlate, not SimpleMaterial.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="049440.html">[Twisted-Python] twisted plugins
</A></li>
	<LI>Next message (by thread): <A HREF="049444.html">[Twisted-Python] twisted plugins
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49441">[ date ]</a>
              <a href="thread.html#49441">[ thread ]</a>
              <a href="subject.html#49441">[ subject ]</a>
              <a href="author.html#49441">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
