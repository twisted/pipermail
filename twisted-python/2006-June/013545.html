<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Creating a proxy between a flash client and	xmlBlaster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Creating%20a%20proxy%20between%20a%20flash%20client%20and%0A%09xmlBlaster&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013551.html">
   <LINK REL="Next"  HREF="013548.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Creating a proxy between a flash client and	xmlBlaster</H1>
    <B>Richard Strong</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Creating%20a%20proxy%20between%20a%20flash%20client%20and%0A%09xmlBlaster&In-Reply-To="
       TITLE="[Twisted-Python] Creating a proxy between a flash client and	xmlBlaster">sidius at ucla.edu
       </A><BR>
    <I>Wed Jun 28 14:22:06 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="013551.html">[Twisted-Python] Twisted - tutorial links
</A></li>
        <LI>Next message: <A HREF="013548.html">[Twisted-Python] Compressing PB communication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13545">[ date ]</a>
              <a href="thread.html#13545">[ thread ]</a>
              <a href="subject.html#13545">[ subject ]</a>
              <a href="author.html#13545">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I am attempting to build a proxy between xmlBlaster and a Flash client 
using an XmlSocket on the client side.
My cludge was going to be the twisted library. Essentially I want to 
have the update function of xmlBlaster
call basic.LineReceiver.sendLine(...) and the lineReceived function of 
twisted to call self.msgPublish.
I have a through line working from the Flash client to xmlBlaster, but 
cannot get a message from
xmlBlaster to Flash (even after a Flash client has successfully logged 
in.). Any help would be
divine.  Here is a copy of the source code for the server that has been 
created:

from const import *
import sys
import os
import time
import signal
import threading
sys.path.insert(0, CLIENTPATH)
import bistBlast
from twisted.protocols import basic
from twisted.internet import reactor, protocol
from twisted.internet.protocol import Protocol

class Proxy(bistBlast.bistBlast,basic.LineReceiver, threading.Thread):
   delimiter = '\0'
   def __init__(self):
             print 
&quot;init======================================================&gt;&quot;
       #bistBlast.bistBlast.__init__(self, 8009)

                     def update(self, sessionId, key, content, qos):
       print &quot;&quot;&quot;__recieved message__ &quot;&quot;&quot;
           print &quot;__key__&quot;, key
           print &quot;__content__\n&quot;, content.data
           print &quot;__qos__&quot;, qos
       #print &quot;&quot;
       self.sendLine('&lt;MESSAGE USER=&quot;John&quot; TEXT=&quot;Hello, my name is 
John!&quot; /&gt;')
       #self.message('&lt;MESSAGE USER=&quot;John&quot; TEXT=&quot;Hello, my name is 
John!&quot; /&gt;')
       #self.sendLine(key)
       return &quot;&quot;      
   def lineReceived(self,line):
 
       if line == &quot;&lt;policy-file-request/&gt;&quot;:
           print &quot;\t sending policy file&quot;
           self.sendLine(&quot;&lt;?xml 
version=\&quot;1.0\&quot;?&gt;&lt;cross-domain-policy&gt;&lt;allow-access-from domain=\&quot;*\&quot; 
to-ports=\&quot;8007\&quot; /&gt;&lt;/cross-domain-policy&gt;&quot;)
           #bistBlast.bistBlast.__init__(self, 8009)
           #self.msgSubscribe(&quot;test&quot;)
       else:
                     print &quot;LINE RECEIVED&quot;
           try:
               bistBlast.bistBlast.__init__(self, 8009)
               self.msgSubscribe(&quot;test&quot;)
           except:
               print &quot;already connected&quot;
           self.msgPublish(&quot;&lt;key oid='test' /&gt;&quot;, &quot;&lt;what /&gt;&quot;)
           self.sendLine('&lt;MESSAGE USER=&quot;John&quot; TEXT=&quot;Hello, my name is 
John!&quot; /&gt;')

   def sendLine(self, msg):
       print &quot;Sending Message&quot;
       basic.LineReceiver.sendLine(self, msg)
       print &quot;Sent Message&quot;
         def message(self, msg):
       self.transport.write(msg + '\n' + delimiter)
       print msg + '\n'
      # Main
if __name__ == '__main__':

   ProxyFactory = protocol.ServerFactory()
   ProxyFactory.protocol = Proxy
   reactor.listenTCP(8007, ProxyFactory)
   reactor.run()


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013551.html">[Twisted-Python] Twisted - tutorial links
</A></li>
	<LI>Next message: <A HREF="013548.html">[Twisted-Python] Compressing PB communication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13545">[ date ]</a>
              <a href="thread.html#13545">[ thread ]</a>
              <a href="subject.html#13545">[ subject ]</a>
              <a href="author.html#13545">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
