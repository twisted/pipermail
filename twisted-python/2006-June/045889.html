<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] twisted.plugin question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.plugin%20question&In-Reply-To=%3C17553.30758.121742.323787%40terry.jones.tc%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="045888.html">
   <LINK REL="Next"  HREF="045891.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] twisted.plugin question</H1>
    <B>Terry Jones</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20twisted.plugin%20question&In-Reply-To=%3C17553.30758.121742.323787%40terry.jones.tc%3E"
       TITLE="[Twisted-Python] twisted.plugin question">terry at jon.es
       </A><BR>
    <I>Thu Jun 15 09:09:26 MDT 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="045888.html">[Twisted-Python] Intercepting shutdown ?
</A></li>
        <LI>Next message (by thread): <A HREF="045891.html">[Twisted-Python] twisted.plugin question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45889">[ date ]</a>
              <a href="thread.html#45889">[ thread ]</a>
              <a href="subject.html#45889">[ subject ]</a>
              <a href="author.html#45889">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Is the Twisted plugin system described here

  <A HREF="http://twistedmatrix.com/projects/core/documentation/howto/plugin.html">http://twistedmatrix.com/projects/core/documentation/howto/plugin.html</A>

still supported / functional?

I tried implementing the example on that page and couldn't make it
work.  Below is my simplified code from that example, in two files.

BTW, the code on that page in the section Extending an Existing Program is
missing a 'from zope.interface import implements'. Also, the assumption
that code is in a file called imatsim.py, and the curious 'from matsim
import imatsim' could be explained. I guess the later is just a harmless
anachronism?

Regards,
Terry


# -------------------
# Begin plugin.py:
import sys
from zope.interface import Interface
from twisted.plugin import getPlugins

sys.path[:0] = ['./twisted/plugins']

class IMaterial(Interface):
    def yieldStress(temperature):
        &quot;&quot;&quot; &quot;&quot;&quot;
def displayMaterial(m):
    print 'A material with yield stress %s at 500 K' % (m.yieldStress(500),)

def displayAllKnownMaterials():
    for material in getPlugins(IMaterial):
        displayMaterial(material)

if __name__ == '__main__':
    displayAllKnownMaterials()
# End plugin.py:


# -------------------
# Begin ./twisted/plugins/materials.py:
from twisted.plugin import IPlugin
from plugin import IMaterial
from zope.interface import implements

class SimpleMaterial(object):
    implements(IPlugin, IMaterial)

    def __init__(self, yieldStressFactor):
        self._yieldStressFactor = yieldStressFactor

    def yieldStress(self, temperature):
        return self._yieldStressFactory * temperature

steelPlate = SimpleMaterial(2)
brassPlate = SimpleMaterial(1)
# End ./twisted/plugins/materials.py:



When I run plugin.py, I get the error:

$ python plugin.py
Traceback (most recent call last):
  File &quot;plugin.py&quot;, line 18, in ?
    displayAllKnownMaterials()
  File &quot;plugin.py&quot;, line 14, in displayAllKnownMaterials
    for material in getPlugins(IMaterial):
  File &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/twisted/plugin.py&quot;, line 210, in getPlugins
    allDropins = getCache(package)
  File &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/twisted/plugin.py&quot;, line 176, in getCache
    newCacheData = pickle.dumps(cache, 2)
cPickle.PicklingError: Can't pickle &lt;InterfaceClass plugin.IMaterial&gt;: attribute lookup plugin.IMaterial failed


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="045888.html">[Twisted-Python] Intercepting shutdown ?
</A></li>
	<LI>Next message (by thread): <A HREF="045891.html">[Twisted-Python] twisted.plugin question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45889">[ date ]</a>
              <a href="thread.html#45889">[ thread ]</a>
              <a href="subject.html#45889">[ subject ]</a>
              <a href="author.html#45889">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
