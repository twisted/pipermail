<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] [andrea at cpushare.com: Re: error after launching	cpushare client]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20%5Bandrea%40cpushare.com%3A%20Re%3A%20error%20after%20launching%0A%09cpushare%20client%5D&In-Reply-To=20050803205508.GT7606%40g5.random">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011080.html">
   <LINK REL="Next"  HREF="011082.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] [andrea at cpushare.com: Re: error after launching	cpushare client]</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20%5Bandrea%40cpushare.com%3A%20Re%3A%20error%20after%20launching%0A%09cpushare%20client%5D&In-Reply-To=20050803205508.GT7606%40g5.random"
       TITLE="[Twisted-Python] [andrea at cpushare.com: Re: error after launching	cpushare client]">tv at twistedmatrix.com
       </A><BR>
    <I>Thu Aug  4 01:47:39 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="011080.html">[Twisted-Python] [andrea at cpushare.com: Re: error after launching	cpushare client]
</A></li>
        <LI>Next message: <A HREF="011082.html">[Twisted-Python] [andrea at cpushare.com: Re: error after launching	cpushare client]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11081">[ date ]</a>
              <a href="thread.html#11081">[ thread ]</a>
              <a href="subject.html#11081">[ subject ]</a>
              <a href="author.html#11081">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrea Arcangeli wrote:
&gt;<i> Ok but then do you have an idea where the 139 comes from? I'd like to
</I>&gt;<i> understand what's going on, to me that 139 number comes out of the blue.
</I>
139 == 128 + 11.

One way to set up the numbering is that exit codes are 0..127, signals
etc. have hight bit set.

Naturally, all real access should go through the macros WIFEXITED etc,
but that's how the number ranges are classically set up.

&gt;&gt;<i>Actual .status values are unportable, thus transferring them raw over
</I>&gt;&gt;<i>the network is not a good idea.
</I>&gt;<i> 
</I>&gt;<i> status should be the same that waitpid returns, from the docs:
</I>&gt;<i> 
</I>&gt;<i> &quot;return a tuple containing its pid and exit status indication: a 16-bit
</I>&gt;<i> number, whose low byte is the signal number that killed the process, and
</I>&gt;<i> whose high byte is the exit status (if the signal number is zero); the
</I>&gt;<i> high bit of the low byte is set if a core file was produced.
</I>&gt;<i> Availability: Unix.&quot;
</I>
I think you are reading about os.wait and twisted is using
os.waitpid. Otherwise, the document is lying to you. The status _may_ be
laid out like that on _some_ platform, but unless python does some
readjustment, the only portable way to access it is WIFEXITED and
friends.

cat &gt;crash.c &lt;&lt;EOF
int main(void) {
  /* comment out the next line if you want a normal exit */
  *(char*)0 = 42;
  return 34;
}
EOF
cat &gt;run.py &lt;&lt;EOF
#!/usr/bin/python
import os

pid = os.fork()
if pid:
    # parent
    pid, status = os.waitpid(pid, 0)
    print pid, status
    if os.WIFEXITED(status):
        print 'exited', os.WEXITSTATUS(status)
    elif os.WIFSIGNALED(status):
        print 'signaled', os.WTERMSIG(status)
        print 'coredump', os.WCOREDUMP(status)
    elif os.WIFSTOPPED(status):
        print 'stopped', os.WSTOPSIG(status)
    elif os.WIFCONTINUED(status):
        print 'continued'
    else:
        print 'unknown'
else:
    # child
    os.execv('./a.out', ['a.out'])
    raise RuntimeError, &quot;exec failed&quot;
EOF
chmod a+x run.py
gcc -Wall crash.c
./run.py

&gt;<i> Now I will ask to use exitCode but still I'd like to understand how
</I>&gt;<i> status is connected with exitCode.
</I>
exitCode and signal are decoded from status.

&gt;<i> BTW, I was using exitCode already, but I thought it would be set only if
</I>&gt;<i> a signal wasn't delivered. Infact I wrote code like this:
</I>
Exactly. If a process exits due to a signal, there is no exit code in
the sense of calling _exit(2).


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011080.html">[Twisted-Python] [andrea at cpushare.com: Re: error after launching	cpushare client]
</A></li>
	<LI>Next message: <A HREF="011082.html">[Twisted-Python] [andrea at cpushare.com: Re: error after launching	cpushare client]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11081">[ date ]</a>
              <a href="thread.html#11081">[ thread ]</a>
              <a href="subject.html#11081">[ subject ]</a>
              <a href="author.html#11081">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
