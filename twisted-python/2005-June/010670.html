<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] -shutdown taps
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20-shutdown%20taps&In-Reply-To=200506081048.28903.ian%40ianduggan.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010668.html">
   <LINK REL="Next"  HREF="010754.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] -shutdown taps</H1>
    <B>Michael Twomey</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20-shutdown%20taps&In-Reply-To=200506081048.28903.ian%40ianduggan.net"
       TITLE="[Twisted-Python] -shutdown taps">micktwomey at gmail.com
       </A><BR>
    <I>Thu Jun  9 18:56:27 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010668.html">[Twisted-Python] -shutdown taps
</A></li>
        <LI>Next message: <A HREF="010754.html">[Twisted-Python] -shutdown taps
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10670">[ date ]</a>
              <a href="thread.html#10670">[ thread ]</a>
              <a href="subject.html#10670">[ subject ]</a>
              <a href="author.html#10670">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

The biggest thing which will kill the data is running the original tap
again, not the -shutdown one. Running the original tap will overwrite
the old shutdown one with a fresh instance. Since this can happen
easily (e.g. at critical oh-my-god-the-server-is-broken moments), you
really can't rely on the data being there. It's good for caching or
anything you don't mind losing, but you have to use conditional logic
in your startup script to figure out which tap to start with.

After experimenting with it and losing my data repeatedly I just wrote
the data I was interested in to a pickle. Since you have the
stopService hook in services, you can whack the persistence stuff in
there.

cheers,
  mick

On 6/8/05, Ian Duggan &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">ian at ianduggan.net</A>&gt; wrote:
&gt;<i> Yeah? My daemon keeps a small amount of state for &quot;in process&quot; requests
</I>&gt;<i> related to long running background processes. I was hoping to have the daemon
</I>&gt;<i> save the hash it was using, and restart the processes where they were when it
</I>&gt;<i> restarted.
</I>&gt;<i> 
</I>&gt;<i> What about this method makes it fragile? I guess that's what I was hoping to
</I>&gt;<i> code into a more robust state. It's a cool feature, IMHO, to have automagical
</I>&gt;<i> daemon persistence.
</I>&gt;<i> 
</I>&gt;<i> --Ian
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010668.html">[Twisted-Python] -shutdown taps
</A></li>
	<LI>Next message: <A HREF="010754.html">[Twisted-Python] -shutdown taps
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10670">[ date ]</a>
              <a href="thread.html#10670">[ thread ]</a>
              <a href="subject.html#10670">[ subject ]</a>
              <a href="author.html#10670">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
