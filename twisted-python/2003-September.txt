From justinjohnson at fastmail.fm  Fri Sep 12 17:55:46 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 12 Sep 2003 15:55:46 -0600
Subject: [Twisted-Python] Technical Difficulties
In-Reply-To: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
References: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
Message-ID: <20030912215546.C49243B80E@www.fastmail.fm>

[justinj at chewie cvs]$ cvs -d:pserver:anon at twistedmatrix.com:/cvs login
Logging in to :pserver:anon at twistedmatrix.com:2401/cvs
CVS password:
Fatal error, aborting.
anon: no such user
[justinj at chewie cvs]$


I assume this is because the server isn't quite up and working yet since
the move...


On Fri, 2 Jan 2004 18:30:25 -0600, "Glyph Lefkowitz"
<glyph at twistedmatrix.com> said:
> 
> Twistedmatrix.com is about to experience some significant technical 
> difficulties.  As I am moving to Boston and the domain is hosted on my 
> personal DSL, it will have nowhere to be for a little while.
> 
> Sometime after midnight CST tonight, I will be taking the machine down 
> for a full backup in case there are problems in transit.  After that, I 
> will be removing the hard drive and putting it in a box to mail 
> somewhere in Maryland.  If it gets there, it will not be my fault if 
> service is resumed within the week.
> 
> If and when service _is_ resumed, we all owe a very big thank you to 
> Divmod, who is graciously offering to host the machine in more-or-less 
> its current form.
> 
> Just to be clear: this means that the website, email, buildbot, CVS, 
> wiki, and DNS services will _all_ be down.  If you have a personal 
> webserver on pyramid it will also be down.  I have already redirected 
> our primary DNS so that the rest of the system administration team 
> should be able to make sure that we do not lose email.
> 
> I am sorry if this is the first notification you have recieved of this 
> impending shutdown, but things have been fairly hectic over here.
> 
> Thank you.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From itamar at itamarst.org  Fri Sep 12 18:05:22 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 18:05:22 -0400
Subject: [Twisted-Python] New CVS server
In-Reply-To: <20030912215546.C49243B80E@www.fastmail.fm>
References: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
	<20030912215546.C49243B80E@www.fastmail.fm>
Message-ID: <20030912180522.63bdb355.itamar@itamarst.org>

CVS is now on cvs.twistedmatrix.com/cvs, please update your checkouts
(I'm told cvsutils  has a cvschroot).



From alienoid at is.lg.ua  Fri Sep 12 06:58:58 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Fri, 12 Sep 2003 13:58:58 +0300
Subject: [Twisted-Python] pb.Referenceable and disconnection question
Message-ID: <3F61A6F2.10409@is.lg.ua>

Hello.

Can anybody help me with the following?
I have server an lot of clients, when they connect(SSL) they pass their 
pb.Referenceable to server. Server every 2 minutes calls clients' remote 
method checkpoint(). The problem arises when i disconnect network cable 
from client side(WinXP) or from server side(linux redhat9.0) - with 
disconnected cable, server makes remoteRef.callRemote("checkpoint") and 
i don't get pb.DeadReferenceError exception(no exceptions at all, it 
prints that it's ok). Only after 15-18 minutes i see on server 
exceptions that connection was lost.

Your help is very, very appreciated.
Thanks in advance.

P.S. Client side(i use notifyOnDisconnect method) detects losing of 
connection after 3-5 seconds, but server side...
I use twisted 1.0.7rc1

Best regars,
Ruslan




From ccom at gmx.net  Thu Sep  4 02:18:37 2003
From: ccom at gmx.net (stephan)
Date: Wed, 3 Sep 2003 23:18:37 -0700
Subject: [Twisted-Python] executing .rpy in a thread
Message-ID: <000001c372ac$60dd40c0$0501000a@tp2>


Say I want to execute blocking code in a .rpy file. Can't I just execute
all the code in a separate thread? I've found the following code to
execute a function in a thread. How could I add a callback to that
thread so I could get back the whole html page back from that
"notthreadSafe" function and return it to the client (web browser)?


from twisted.internet import reactor
from twisted.python import threadable
threadable.init(1)

def notThreadSafe(x):
     """do something that isn't thread-safe"""
     # ...

def threadSafeScheduler():
    """Run in thread-safe manner."""
    reactor.callFromThread(notThreadSafe, 3) # will run
'notThreadSafe(3)'
                                             # in the event loop



_stephan




From dkuhlman at cutter.rexx.com  Thu Sep  4 19:33:02 2003
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Thu, 4 Sep 2003 16:33:02 -0700
Subject: [Twisted-Python] Examples and patterns for Twisted
Message-ID: <20030904163302.A16152@cutter.rexx.com>


I've written a document that provides and explains a number of
patterns and examples for Twisted Web applications.

I'm hoping that it might be of help to beginning Twisted
developers.  I also wrote it to try to learn more about Twisted and
also to straight out my own head.

I'd like to post it at my Web site.  But, before I make it public
or announce it, it'd be helped by reviews from Twisted experts. 
Any comments and suggestions would be appreciated.

You can find it at:

   http://www.rexx.com/~dkuhlman/twisted_patterns.html

(I've placed it at my Web site, but have not yet made it visible on
my main page.)

Thanks in advance for criticism and suggestions.

Dave

-- 
Dave Kuhlman
dkuhlman at rexx.com
http://www.rexx.com/~dkuhlman



From maoy at cis.upenn.edu  Tue Sep  9 22:22:53 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Tue, 9 Sep 2003 22:22:53 -0400 (EDT)
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
Message-ID: <Pine.LNX.4.44.0309092220190.1254-100000@forty-thieves.cis.upenn.edu>

Hi, I noticed that as a TCP client, the loseConnection() is inherited, and
without a reason argument. Why this is different from the TCPServer, where
a default reason argument is ConnectionDone?  Given such info, how to let
a TCP client protocol in connectionLost() detect it's due to a network
failure or a active close connection?

Thanks!!

Yun





From ccom at gmx.net  Thu Sep  4 00:09:21 2003
From: ccom at gmx.net (stephan)
Date: Wed, 3 Sep 2003 21:09:21 -0700
Subject: [Twisted-Python] What is  blocking code?
Message-ID: <000001c3729a$526d7120$0501000a@tp2>

When I started coding I though I will just add the deferred calls where
necessary later. Now it seems to me like I have to change the whole
architecture of my app. 

I am running twisted as a Web-server to serve .rpy files. In these files
I create quite complex html pages. In that process I also access a
database. So when I tried to adapt to the adbapi I encountered proplems
because:
     Starting from the .rpy file I call a method, which calls a method,
     ..., which calls a method, which eventually calls a method that
     queries the database. 

->So where does my blocking code start? Is it just the last method that
  queries the db or is it the first one of the chain?

->Is there a way to make my db call deferred without reversing the whole
  method chain?

->Why don't I just make all the code in the .rpy deferred?


Help very much appreciated.

_stephan





From syver at inout.no  Tue Sep  2 03:13:14 2003
From: syver at inout.no (Syver Enstad)
Date: 02 Sep 2003 09:13:14 +0200
Subject: [Twisted-Python] Technical Difficulties
In-Reply-To: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
References: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
Message-ID: <uk78r64tx.fsf@inout.no>

Wow, the sending date on this mail says: 

Date: Fri, 2 Jan 2004 18:30:25 -0600

Glyph, have you borrowed Guido's timemachine?





From lwright at mac.com  Mon Sep  8 02:25:55 2003
From: lwright at mac.com (Linden Wright)
Date: Mon, 8 Sep 2003 02:25:55 -0400
Subject: [Twisted-Python] Magical Disappearing Transport
Message-ID: <4D46DFA6-E1C5-11D7-9127-00039303E40A@mac.com>

Hi -
I have a client factory and protocol written for TCP connections, and 
whenever I try to transport.write(), it tells me that the transport == 
None. The only time that I can successfully transport.write() is in my 
protocol's connectionMade method. My protocol inherits from 
protocol.Protocol, my factory inherits from protocol.ClientFactory, and 
otherwise, my code pretty much follows the examples.
What causes the transport to be set to None?
I feel like I'm missing something very basic, and I'm new to twisted, 
so I probably am. =)
Thanks,
Linden




From konrad at wam.umd.edu  Sat Sep  6 13:07:09 2003
From: konrad at wam.umd.edu (Konrad Rokicki)
Date: Sat, 6 Sep 2003 13:07:09 -0400 (EDT)
Subject: [Twisted-Python] calling unix commands
Message-ID: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>

Hey everyone,
I'm having a problem calling a unix comand from inside a twisted program..
I do
	os.popen(cmd).readlines()
and I sporadically get:
	IOError: [Errno 4] Interrupted system call

Sounds like it might be an async problem.. is there a preferred way to do
this in twisted?

Thanks,
Konrad




From alienoid at is.lg.ua  Fri Sep  5 05:20:20 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Fri, 05 Sep 2003 12:20:20 +0300
Subject: [Twisted-Python] notifyOnDisconnect
Message-ID: <3F585554.8010600@is.lg.ua>

Hello.

I have server and a lot of clients, that connects to server and pass 
their pb.Referenceable. Every 2 minutes server calls clients' remote 
method. I store clients' references on server in a list of dictionaries 
- [{'remoteRef' : ref, 'ip' : '192.168.1.2', 'mac' : '...'}, ....] I 
call notifyOnDisconnect on clients' remoteRef. In callback i need to 
close client's firewall. How can i pass 'ip', 'mac' from dictionary to 
callback if notifyOnDisconnect passes only one parameter(this instance) 
to callback method. Help, please

Thanks in advance
Best regards,
Ruslan




From itamar at itamarst.org  Fri Sep 12 22:13:40 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:13:40 -0400
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <Pine.LNX.4.44.0309092220190.1254-100000@forty-thieves.cis.upenn.edu>
References: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
	<Pine.LNX.4.44.0309092220190.1254-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030912221340.746b352c.itamar@itamarst.org>

On Tue, 9 Sep 2003 22:22:53 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Hi, I noticed that as a TCP client, the loseConnection() is inherited,
> and without a reason argument. Why this is different from the
> TCPServer, where a default reason argument is ConnectionDone?  Given
> such info, how to let a TCP client protocol in connectionLost() detect
> it's due to a network failure or a active close connection?

It's there for a different reason, and the client connection will in
fact get the reason it was disconnected. Hopefully there is even a test
for this.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 22:15:30 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:15:30 -0400
Subject: [Twisted-Python] Magical Disappearing Transport
In-Reply-To: <4D46DFA6-E1C5-11D7-9127-00039303E40A@mac.com>
References: <4D46DFA6-E1C5-11D7-9127-00039303E40A@mac.com>
Message-ID: <20030912221530.1b26c9c5.itamar@itamarst.org>

On Mon, 8 Sep 2003 02:25:55 -0400
Linden Wright <lwright at mac.com> wrote:


> I have a client factory and protocol written for TCP connections, and 
> whenever I try to transport.write(), it tells me that the transport ==
> 
> None. The only time that I can successfully transport.write() is in my
> 
> protocol's connectionMade method. My protocol inherits from 
> protocol.Protocol, my factory inherits from protocol.ClientFactory,
> and otherwise, my code pretty much follows the examples.

You are probably trying to call it in __init__, when obviously it can't
exist since the transport hasn't had time to be connected to the
protocol yet. You should only call it in connectionMade, dataReceived
and any methods they call.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 22:16:17 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:16:17 -0400
Subject: [Twisted-Python] calling unix commands
In-Reply-To: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>
References: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>
Message-ID: <20030912221617.20bbdb37.itamar@itamarst.org>

On Sat, 6 Sep 2003 13:07:09 -0400 (EDT)
Konrad Rokicki <konrad at wam.umd.edu> wrote:

> Hey everyone,
> I'm having a problem calling a unix comand from inside a twisted
> program.. I do
> 	os.popen(cmd).readlines()
> and I sporadically get:
> 	IOError: [Errno 4] Interrupted system call
> 
> Sounds like it might be an async problem.. is there a preferred way to
> do this in twisted?

reactor.spawnProcess. I'm pretty sure we have a HOWTO on this.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Fri Sep 12 22:20:02 2003
From: bob at redivi.com (Bob Ippolito)
Date: Fri, 12 Sep 2003 22:20:02 -0400
Subject: [Twisted-Python] calling unix commands
In-Reply-To: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>
Message-ID: <C838E4DA-E590-11D7-B303-000A95686CD8@redivi.com>

On Saturday, Sep 6, 2003, at 13:07 America/New_York, Konrad Rokicki 
wrote:

> Hey everyone,
> I'm having a problem calling a unix comand from inside a twisted 
> program..
> I do
> 	os.popen(cmd).readlines()
> and I sporadically get:
> 	IOError: [Errno 4] Interrupted system call
>
> Sounds like it might be an async problem.. is there a preferred way to 
> do
> this in twisted?

use twisted.internet.process

or the convenience function:
twisted.internet.getProcessOutput(executable, args=(), env={}, 
path='.', reactor=reactor):

see: http://www.twistedmatrix.com/documents/howto/process

-bob




From itamar at itamarst.org  Fri Sep 12 22:17:56 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:17:56 -0400
Subject: [Twisted-Python] notifyOnDisconnect
In-Reply-To: <3F585554.8010600@is.lg.ua>
References: <3F585554.8010600@is.lg.ua>
Message-ID: <20030912221756.5755d644.itamar@itamarst.org>

On Fri, 05 Sep 2003 12:20:20 +0300
Ruslan Spivak <alienoid at is.lg.ua> wrote:

> I have server and a lot of clients, that connects to server and pass 
> their pb.Referenceable. Every 2 minutes server calls clients' remote 
> method. I store clients' references on server in a list of
> dictionaries - [{'remoteRef' : ref, 'ip' : '192.168.1.2', 'mac' :
> '...'}, ....] I call notifyOnDisconnect on clients' remoteRef. In
> callback i need to close client's firewall. How can i pass 'ip', 'mac'
> from dictionary to callback if notifyOnDisconnect passes only one
> parameter(this instance) to callback method. Help, please

notifyOnDisconnect(lambda x: x.disconnected({'remoteRef' : ref, 'ip' :
'192.168.1.2', 'mac' : '...'})

or maybe

notifyOnDisconnect(lambda: x.disconnected({'remoteRef' : ref, 'ip' :
'192.168.1.2', 'mac' : '...'})

depending on the required signature. Use a lambda, anyway.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 22:20:41 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:20:41 -0400
Subject: [Twisted-Python] What is  blocking code?
In-Reply-To: <000001c3729a$526d7120$0501000a@tp2>
References: <000001c3729a$526d7120$0501000a@tp2>
Message-ID: <20030912222041.3ab0a741.itamar@itamarst.org>

On Wed, 3 Sep 2003 21:09:21 -0700
"stephan" <ccom at gmx.net> wrote:

> When I started coding I though I will just add the deferred calls
> where necessary later. Now it seems to me like I have to change the
> whole architecture of my app. 

Yes, event driven networking is that way. However, if you use woven,
Deferreds will probably be handled transparently for you, making code a
lot easier to write. Also you should note RPYs are intended for
deployment of web applications, and not as a way of structuring code for
your site.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 22:21:58 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:21:58 -0400
Subject: [Twisted-Python] calling unix commands
In-Reply-To: <C838E4DA-E590-11D7-B303-000A95686CD8@redivi.com>
References: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>
	<C838E4DA-E590-11D7-B303-000A95686CD8@redivi.com>
Message-ID: <20030912222158.1376dcfe.itamar@itamarst.org>

> use twisted.internet.process

Please don't use this directly, use reactor.spawnProcess instead.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Fri Sep 12 22:53:22 2003
From: bob at redivi.com (Bob Ippolito)
Date: Fri, 12 Sep 2003 22:53:22 -0400
Subject: [Twisted-Python] calling unix commands
In-Reply-To: <20030912222158.1376dcfe.itamar@itamarst.org>
Message-ID: <7047445C-E595-11D7-B303-000A95686CD8@redivi.com>

On Friday, Sep 12, 2003, at 22:21 America/New_York, Itamar 
Shtull-Trauring wrote:

>> use twisted.internet.process
>
> Please don't use this directly, use reactor.spawnProcess instead.

I meant twisted.internet.protocol.ProcessProtocol

I should've just said "read the howto" because then I couldn't be any 
more wrong than the howto, and it wouldn't be my fault :)

-bob




From maoy at cis.upenn.edu  Fri Sep 12 22:57:40 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Fri, 12 Sep 2003 22:57:40 -0400 (EDT)
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <20030912221340.746b352c.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>


On Fri, 12 Sep 2003, Itamar Shtull-Trauring wrote:

> On Tue, 9 Sep 2003 22:22:53 -0400 (EDT)
> Yun Mao <maoy at cis.upenn.edu> wrote:
> 
> > Hi, I noticed that as a TCP client, the loseConnection() is inherited,
> > and without a reason argument. Why this is different from the
> > TCPServer, where a default reason argument is ConnectionDone?  Given
> > such info, how to let a TCP client protocol in connectionLost() detect
> > it's due to a network failure or a active close connection?
> 
> It's there for a different reason, and the client connection will in
> fact get the reason it was disconnected. Hopefully there is even a test
> for this.
> 
> 

Could you tell me how to get the disconnected reason for client? In the 
clientfactory.clientConnectionLost, I always get connectionLost..

Thanks.

Yun





From itamar at itamarst.org  Fri Sep 12 23:26:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 23:26:20 -0400
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
References: <20030912221340.746b352c.itamar@itamarst.org>
	<Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030912232620.3b44e96d.itamar@itamarst.org>

On Fri, 12 Sep 2003 22:57:40 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Could you tell me how to get the disconnected reason for client? In
> the clientfactory.clientConnectionLost, I always get connectionLost..

Even for clean disconnects? What OS?

Also, why do you care?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 23:29:13 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 23:29:13 -0400
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
References: <20030912221340.746b352c.itamar@itamarst.org>
	<Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030912232913.705ab74b.itamar@itamarst.org>

On Fri, 12 Sep 2003 22:57:40 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Could you tell me how to get the disconnected reason for client? In
> the clientfactory.clientConnectionLost, I always get connectionLost..

I wrote a test, and it seems it might be a bug. I will investigate.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Fri Sep 12 23:51:59 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 13 Sep 2003 13:51:59 +1000
Subject: [Twisted-Python] executing .rpy in a thread
In-Reply-To: <000001c372ac$60dd40c0$0501000a@tp2>
References: <000001c372ac$60dd40c0$0501000a@tp2>
Message-ID: <20030913035159.GA3503@frobozz>

On Wed, Sep 03, 2003 at 11:18:37PM -0700, stephan wrote:
> 
> 
> Say I want to execute blocking code in a .rpy file. Can't I just execute
> all the code in a separate thread? I've found the following code to
> execute a function in a thread. How could I add a callback to that
> thread so I could get back the whole html page back from that
> "notthreadSafe" function and return it to the client (web browser)?

The easiest way to run code in a thread and get the result back is with
twisted.internet.threads.deferToThread.  Your Resource's render method would
need to return NOT_DONE_YET, and you'd need to add callbacks to the Deferred
from deferToThread that call request.write(...) and request.finish().

-Andrew.




From itamar at itamarst.org  Fri Sep 12 23:55:45 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 23:55:45 -0400
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
References: <20030912221340.746b352c.itamar@itamarst.org>
	<Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030912235545.69ffa51c.itamar@itamarst.org>

On Fri, 12 Sep 2003 22:57:40 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Could you tell me how to get the disconnected reason for client? In
> the clientfactory.clientConnectionLost, I always get connectionLost..

Fixed in CVS. Thanks for the bug report.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 23:58:25 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 23:58:25 -0400
Subject: [Twisted-Python] Who runs FreeBSD and Mac OS X buildbots?
Message-ID: <20030912235825.16e9a658.itamar@itamarst.org>

Warner has coded new bandwidth saving version of buildbot. Please don't
switch to new CVS server until you've upgraded to using it.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Sat Sep 13 00:01:02 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 13 Sep 2003 00:01:02 -0400
Subject: [Twisted-Python] A big thank you to Divmod and Tummy
Message-ID: <20030913000102.476b7fd1.itamar@itamarst.org>

1. Tummy.com has donated CVS hosting on their wonderful virtual hosting
setup (hosting.tummy.com). You should try them out, they are a great
company.

2. Divmod (www.divmod.com) have donated rack space, bandwidth etc. for
our main server's new home. You should all try out Quotient and send
them patches and bug reports.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Sat Sep 13 00:06:43 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 13 Sep 2003 00:06:43 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
Message-ID: <20030913000643.22428e8a.itamar@itamarst.org>

Mary Gardiner, for hosting our mail

Chris Armstrong, who did lots of work on the move

Jean-Paul Calderone, assembling and bringing server to hosting

Glyph Lefkowitz, buying us a new server

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From radix at twistedmatrix.com  Sat Sep 13 00:48:31 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 00:48:31 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <20030913000643.22428e8a.itamar@itamarst.org>
References: <20030913000643.22428e8a.itamar@itamarst.org>
Message-ID: <20030913044831.GF23784@pyramid.twistedmatrix.com>

On Sat, Sep 13, 2003 at 12:06:43AM -0400, Itamar Shtull-Trauring wrote:
> Mary Gardiner, for hosting our mail
> 
> Chris Armstrong, who did lots of work on the move
> 
> Jean-Paul Calderone, assembling and bringing server to hosting
> 
> Glyph Lefkowitz, buying us a new server

Also, Thanks to Divmod (divmod.org) for paying for the hosting at Coloco
(www.coloco.com).

Tummy is also giving us free hosting on one of their virtual servers for CVS. 
http://tummy.com/. Thanks!

BTW, if anybody needs access to the new CVS server, just say so and I'll
add a user for you and move your authorized_keys from pyramid to wolfwood
(the new server).

-- 
                                Chris Armstrong
                         << radix at twistedmatrix.com >>
                http://twistedmatrix.com/users/radix.twistd/



From radix at twistedmatrix.com  Sat Sep 13 01:30:09 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 01:30:09 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <20030913044831.GF23784@pyramid.twistedmatrix.com>
References: <20030913000643.22428e8a.itamar@itamarst.org> <20030913044831.GF23784@pyramid.twistedmatrix.com>
Message-ID: <20030913053009.GH23784@pyramid.twistedmatrix.com>

On Sat, Sep 13, 2003 at 12:48:31AM -0400, Chris Armstrong wrote:
> Also, Thanks to Divmod (divmod.org) for paying for the hosting at Coloco
> (www.coloco.com).
> 
> Tummy is also giving us free hosting on one of their virtual servers for CVS. 
> http://tummy.com/. Thanks!

Duh, I didn't see itamar's first post about Divmod and Tummy. :P

> BTW, if anybody needs access to the new CVS server, just say so and I'll
> add a user for you and move your authorized_keys from pyramid to wolfwood
> (the new server).

-- 
                                Chris Armstrong
                         << radix at twistedmatrix.com >>
                http://twistedmatrix.com/users/radix.twistd/



From paul.rudin at ntlworld.com  Sat Sep 13 05:57:05 2003
From: paul.rudin at ntlworld.com (Paul Rudin)
Date: 13 Sep 2003 10:57:05 +0100
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <20030913044831.GF23784@pyramid.twistedmatrix.com>
References: <20030913000643.22428e8a.itamar@itamarst.org>
	<20030913044831.GF23784@pyramid.twistedmatrix.com>
Message-ID: <m3r82ldn9q.fsf@ntlworld.com>

Chris Armstrong <radix at twistedmatrix.com> writes:

> 
> BTW, if anybody needs access to the new CVS server, just say so and I'll
> add a user for you and move your authorized_keys from pyramid to wolfwood
> (the new server).

The web pages need to be updated with the new cvs server details.



From radix at twistedmatrix.com  Sat Sep 13 06:26:07 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 06:26:07 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <m3r82ldn9q.fsf@ntlworld.com>
References: <20030913000643.22428e8a.itamar@itamarst.org> <20030913044831.GF23784@pyramid.twistedmatrix.com> <m3r82ldn9q.fsf@ntlworld.com>
Message-ID: <20030913102607.GB18003@pyramid.twistedmatrix.com>

On Sat, Sep 13, 2003 at 10:57:05AM +0100, Paul Rudin wrote:
> Chris Armstrong <radix at twistedmatrix.com> writes:
> > BTW, if anybody needs access to the new CVS server, just say so and I'll
> > add a user for you and move your authorized_keys from pyramid to wolfwood
> > (the new server).
> 
> The web pages need to be updated with the new cvs server details.

It does? http://twistedmatrix.com/developers/cvs has been updated. Did you
notice other places that need to be updated?

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From mario at ruggier.org  Sat Sep 13 07:35:41 2003
From: mario at ruggier.org (Mario Ruggier)
Date: Sat, 13 Sep 2003 13:35:41 +0200
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <20030913102607.GB18003@pyramid.twistedmatrix.com>
Message-ID: <67B748DD-E5DE-11D7-94A0-000393756786@ruggier.org>

> On Sat, Sep 13, 2003 at 10:57:05AM +0100, Paul Rudin wrote:
>> Chris Armstrong <radix at twistedmatrix.com> writes:
>>> BTW, if anybody needs access to the new CVS server, just say so and 
>>> I'll
>>> add a user for you and move your authorized_keys from pyramid to 
>>> wolfwood
>>> (the new server).
>>
>> The web pages need to be updated with the new cvs server details.
>
> It does? http://twistedmatrix.com/developers/cvs has been updated. Did 
> you
> notice other places that need to be updated?

on this page, and apparently all other pages that include the
smaller linked logo at page-top-centre, that link has a
double trailing slash that gives an error...

mario




From radix at twistedmatrix.com  Sat Sep 13 07:41:27 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 07:41:27 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <67B748DD-E5DE-11D7-94A0-000393756786@ruggier.org>
References: <20030913102607.GB18003@pyramid.twistedmatrix.com> <67B748DD-E5DE-11D7-94A0-000393756786@ruggier.org>
Message-ID: <20030913114127.GA29772@pyramid.twistedmatrix.com>

On Sat, Sep 13, 2003 at 01:35:41PM +0200, Mario Ruggier wrote:
> >On Sat, Sep 13, 2003 at 10:57:05AM +0100, Paul Rudin wrote:
> on this page, and apparently all other pages that include the
> smaller linked logo at page-top-centre, that link has a
> double trailing slash that gives an error...

Huh, I thought that was fixed a long time ago. It's a problem with how
twisted.lore munges links... There's an href="/" in the template, and lore
automatically generates "../" for subpages, but I think that should only
happen for relative links. I guess I'll post a bug to the bug tracker.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From uwe at oss4u.com  Sat Sep 13 13:27:57 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Sat, 13 Sep 2003 10:27:57 -0700
Subject: [Twisted-Python] Suspending a result
Message-ID: <200309131027.57789.uwe@oss4u.com>

Hi,

maybe I'm sitting on my brains here, but anyways:
I have a (possibly) blocking function. The core work of it is handled in a 
separate thread, so the blocking is not a problem for Twisted.
However - I need to get rid of the deferred callbacks. So basically what I'm 
trying to do is to have a class/method that wraps the blocking code WITHOUT 
returning a deferred. Instead I'd like to "suspend" the return, certainly 
without blocking twisted. So here is some "pseudocode" to clarify what I want 
to do:

# the blocking function itself
def possibly_blocking(params):
	do something blocking

Normally I would call this by
	result=possibly_blocking("Blah")

which may or may not block due to what's inside the function.
In 99% of the time it will return a result quite quickly, so no blocking.
BUT what if. So I want to make the
result=xxx
call "wait" for the result, without a deferred coming back. So I'd have to 
wrap that up somehow, so that the call seems to be waiting, but in what is 
called returning the result is delayed. 
I think one might be able to accomplish this with some kind of class that 
wraps the call and checks for the resultset once in a while, and when the 
result is there it returns the result.

It's pretty similar to the way GUI's handle modal dialogs. The original modal 
dialog call will never return, until the dialog is closed, however the rest 
of the gui doesn't block, since internally scheduling still goes on.
So can one wrap a "call / deferred / result" chain and block the caller, 
without blocking twisted completely ?

Any help would be appreciated.
(BTW: I don't want to use deferreds as the original resultset, since that 
would mean having to write tremendous state machines just to retain the order 
of the results depending on each other)

	UC

--
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417




From uwe at oss4u.com  Sat Sep 13 13:58:57 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Sat, 13 Sep 2003 10:58:57 -0700
Subject: [Twisted-Python] (UPDATE) Suspending a result
In-Reply-To: <200309131027.57789.uwe@oss4u.com>
References: <200309131027.57789.uwe@oss4u.com>
Message-ID: <200309131058.57796.uwe@oss4u.com>

I forgot to mention: This is on the server side only. So both caller and 
called are on one peer. The caller itself is called by another peer (and 
returns a defered to the remote side)

On Saturday 13 September 2003 10:27 am, Uwe C. Schroeder wrote:
> Hi,
>
> maybe I'm sitting on my brains here, but anyways:
> I have a (possibly) blocking function. The core work of it is handled in a
> separate thread, so the blocking is not a problem for Twisted.
> However - I need to get rid of the deferred callbacks. So basically what
> I'm trying to do is to have a class/method that wraps the blocking code
> WITHOUT returning a deferred. Instead I'd like to "suspend" the return,
> certainly without blocking twisted. So here is some "pseudocode" to clarify
> what I want to do:
>
> # the blocking function itself
> def possibly_blocking(params):
> 	do something blocking
>
> Normally I would call this by
> 	result=possibly_blocking("Blah")
>
> which may or may not block due to what's inside the function.
> In 99% of the time it will return a result quite quickly, so no blocking.
> BUT what if. So I want to make the
> result=xxx
> call "wait" for the result, without a deferred coming back. So I'd have to
> wrap that up somehow, so that the call seems to be waiting, but in what is
> called returning the result is delayed.
> I think one might be able to accomplish this with some kind of class that
> wraps the call and checks for the resultset once in a while, and when the
> result is there it returns the result.
>
> It's pretty similar to the way GUI's handle modal dialogs. The original
> modal dialog call will never return, until the dialog is closed, however
> the rest of the gui doesn't block, since internally scheduling still goes
> on. So can one wrap a "call / deferred / result" chain and block the
> caller, without blocking twisted completely ?
>
> Any help would be appreciated.
> (BTW: I don't want to use deferreds as the original resultset, since that
> would mean having to write tremendous state machines just to retain the
> order of the results depending on each other)
>
> 	UC
>
> --
> Open Source Solutions 4U, LLC	2570 Fleetwood Drive
> Phone:  +1 650 872 2425		San Bruno, CA 94066
> Cell:   +1 650 302 2405		United States
> Fax:    +1 650 872 2417
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-- 
	UC

--
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417




From dkuhlman at cutter.rexx.com  Sat Sep 13 14:04:19 2003
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Sat, 13 Sep 2003 11:04:19 -0700
Subject: [Twisted-Python] Examples and patterns for Twisted
In-Reply-To: <20030904163302.A16152@cutter.rexx.com>; from dkuhlman@cutter.rexx.com on Thu, Sep 04, 2003 at 04:33:02PM -0700
References: <20030904163302.A16152@cutter.rexx.com>
Message-ID: <20030913110419.A74517@cutter.rexx.com>

On Thu, Sep 04, 2003 at 04:33:02PM -0700, Dave Kuhlman wrote:
> 
> I've written a document that provides and explains a number of
> patterns and examples for Twisted Web applications.

A bit of an update:

I posted the original message a while ago during the Twisted Matrix
move.  In the meantime, Andrew Bennetts has given me some good
comments and suggestions.  So, I'll be doing a fairly serious
update.  Therefore, you may want to wait a bit for a revision
before doing a review.  Give me three or four days.

Dave

> 
> I'm hoping that it might be of help to beginning Twisted
> developers.  I also wrote it to try to learn more about Twisted and
> also to straight out my own head.
> 
> I'd like to post it at my Web site.  But, before I make it public
> or announce it, it'd be helped by reviews from Twisted experts. 
> Any comments and suggestions would be appreciated.
> 
> You can find it at:
> 
>    http://www.rexx.com/~dkuhlman/twisted_patterns.html
> 
> (I've placed it at my Web site, but have not yet made it visible on
> my main page.)
> 
> Thanks in advance for criticism and suggestions.

-- 
Dave Kuhlman
dkuhlman at rexx.com
http://www.rexx.com/~dkuhlman



From itamar at itamarst.org  Sat Sep 13 21:38:22 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 13 Sep 2003 21:38:22 -0400
Subject: [Twisted-Python] Please add changelog entry for all resolved issues in bug tracker
Message-ID: <20030913213822.146d3d1b.itamar@itamarst.org>

This will make sure changelog is more up to date and allow people
reading changelog to refer to issue tracker.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From radix at twistedmatrix.com  Sat Sep 13 21:44:22 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 21:44:22 -0400
Subject: [Twisted-Python] Potential fix for vhost+distrib (issue125)
Message-ID: <20030914014422.GB29772@pyramid.twistedmatrix.com>

Can everyone who cares about vhosts with distrib (Alex Levy, Thomas
Raschbacher) update to latest CVS and try putting a ResourceSubscription
behind a vhost?

I've tested twistedmatrix.com's setup with this fix, and it works (i.e.,
UserDirectories, static.Files, CGIs, etc).


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From glyph at twistedmatrix.com  Sun Sep 14 01:09:58 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 14 Sep 2003 01:09:58 -0400
Subject: [Twisted-Python] Please add changelog entry for all resolved
 issues in bug tracker
In-Reply-To: <20030913213822.146d3d1b.itamar@itamarst.org>
References: <20030913213822.146d3d1b.itamar@itamarst.org>
Message-ID: <3F63F826.5060905@twistedmatrix.com>

Itamar Shtull-Trauring wrote:
> This will make sure changelog is more up to date and allow people
> reading changelog to refer to issue tracker.

Personally I've been trying to adopt a debian-esque way of closing bugs 
by adding it to CVS commit messages - adding a '(Closes xxx)' to any CVS 
commit message that closes an issue.

The changelog has been so ill-used that I don't think many people pay 
attention any more.




From itamar at itamarst.org  Sun Sep 14 01:22:26 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 14 Sep 2003 01:22:26 -0400
Subject: [Twisted-Python] Please add changelog entry for all resolved
 issues in bug tracker
In-Reply-To: <3F63F826.5060905@twistedmatrix.com>
References: <20030913213822.146d3d1b.itamar@itamarst.org>
	<3F63F826.5060905@twistedmatrix.com>
Message-ID: <20030914012226.0486f498.itamar@itamarst.org>

On Sun, 14 Sep 2003 01:09:58 -0400
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> Personally I've been trying to adopt a debian-esque way of closing
> bugs by adding it to CVS commit messages - adding a '(Closes xxx)' to
> any CVS commit message that closes an issue.
> 
> The changelog has been so ill-used that I don't think many people pay 
> attention any more.

That too - but the changelog is how I do release notes, and it's not
*that* bad. But yes, issues in commit messages are probably a good idea
too.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Sun Sep 14 01:43:30 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 14 Sep 2003 15:43:30 +1000
Subject: [Twisted-Python] Re: Web server with Python
In-Reply-To: <6o24mvcmksid33t4s9b8cbsrnctl5n2o6m@4ax.com>
References: <tnr1mvgnt45urvu6n4q6dso3eto73hfr1m@4ax.com> <sx68b.29387$Hb.450091@news4.e.nsc.no> <bjr3ea$m5rr9$1@ID-139865.news.uni-berlin.de> <gvs2mvcgmji0s536475c14oa5tm7cigk13@4ax.com> <mailman.1063352060.32640.python-list@python.org> <6o24mvcmksid33t4s9b8cbsrnctl5n2o6m@4ax.com>
Message-ID: <20030914054330.GA899@frobozz>

[CC'ing the Twisted mailing list]

On Fri, Sep 12, 2003 at 08:05:59PM +0200, Patrick Useldinger wrote:
> On Fri, 12 Sep 2003 17:33:34 +1000, Andrew Bennetts
> <andrew-pythonlist at puzzling.org> wrote:
> 
> >> Does Twisted work well with Python 2.3?
> >
> >Yes, current versions support 2.3 without any problems.
> 
> Version 1.0.6 refuses to install, though, complaining it requires Python
> 2.2.

Eek!  Does 1.0.7 (just released) work any better?  Also, what platform are
you using, and are you installing from the source .tar.gz or something else?

-Andrew.




From foom at fuhm.net  Sun Sep 14 06:22:27 2003
From: foom at fuhm.net (James Y. Knight)
Date: Sun, 14 Sep 2003 06:22:27 -0400
Subject: [Twisted-Python] Patch to allow deferreds to be returned from resource.render
Message-ID: <56DC7FB4-E69D-11D7-8255-003065F305CC@fuhm.net>

Ooh lets try sending this mail one more time. Apparently the combined 
suckage of three different programs made my last mail not get through:
1) Apple Mail sucks and doesn't quote the "Full Name" automatically, so 
I end up with a non-RFC-conforming From: with a "." outside of quotes 
or the email address.
2) Exim sucks and doesn't fix it (OTOH, Sendmail does fix it, which is 
why i've never seen this problem before!)
3) Mailman sucks as well, and gets completely confused by this slightly 
non-conformant address format, and thinks my email address is 
"jamesy.knight".

Anyways, on to the original message:
===

This patch lets you return a deferred from resource.render (the obvious 
thing to do) and have it work. As opposed to the current method where 
you need to return NOT_DONE_YET and restructure all your code to call 
request.write(...). That should still work too, though. I'd stick this 
on the bug tracker but I forgot my password. (anyone able to reset for 
me? :)

James

--- server.py~  Mon Jul 21 00:09:52 2003
+++ server.py   Tue Sep  9 15:02:09 2003
@@ -160,56 +160,8 @@
          except:
              self.processingFailed(failure.Failure())

-
-    def render(self, resrc):
-        try:
-            body = resrc.render(self)
-        except UnsupportedMethod, e:
-            allowedMethods = e.allowedMethods
-            if (self.method == "HEAD") and ("GET" in allowedMethods):
-                # We must support HEAD (RFC 2616, 5.1.1).  If the
-                # resource doesn't, fake it by giving the resource
-                # a 'GET' request and then return only the headers,
-                # not the body.
-                log.msg("Using GET to fake a HEAD request for %s" %
-                        (resrc,))
-                self.method = "GET"
-                body = resrc.render(self)
-
-                if body is NOT_DONE_YET:
-                    log.msg("Tried to fake a HEAD request for %s, but "
-                            "it got away from me." % resrc)
-                    # Oh well, I guess we won't include the content 
length.
-                else:
-                    self.setHeader('content-length', str(len(body)))
-
-                self.write('')
-                self.finish()
-                return
-
-            if self.method in (supportedMethods):
-                # We MUST include an Allow header
-                # (RFC 2616, 10.4.6 and 14.7)
-                self.setHeader('Allow', allowedMethods)
-                s = ('''Your browser approached me (at %(URI)s) with'''
-                     ''' the method "%(method)s".  I only allow'''
-                     ''' the method%(plural)s %(allowed) here.''' % {
-                    'URI': self.uri,
-                    'method': self.method,
-                    'plural': ((len(allowedMethods) > 1) and 's') or 
'',
-                    'allowed': string.join(allowedMethods, ', ')
-                    })
-                epage = error.ErrorPage(http.NOT_ALLOWED,
-                                        "Method Not Allowed", s)
-                body = epage.render(self)
-            else:
-                epage = error.ErrorPage(http.NOT_IMPLEMENTED, "Huh?",
-                                        """I don't know how to treat 
a"""
-                                        """ %s request."""
-                                        % (self.method))
-                body = epage.render(self)
-        # end except UnsupportedMethod
-
+    def _cbRender(self, body, resrc):
+
          if body == NOT_DONE_YET:
              return
          if type(body) is not types.StringType:
@@ -232,6 +184,58 @@
              self.setHeader('content-length', str(len(body)))
              self.write(body)
          self.finish()
+
+    def _ebRender(self, failure, resrc):
+        failure.trap(UnsupportedMethod)
+        e = failure.value
+        allowedMethods = e.allowedMethods
+        if (self.method == "HEAD") and ("GET" in allowedMethods):
+            # We must support HEAD (RFC 2616, 5.1.1).  If the
+            # resource doesn't, fake it by giving the resource
+            # a 'GET' request and then return only the headers,
+            # not the body.
+            log.msg("Using GET to fake a HEAD request for %s" %
+                    (resrc,))
+            self.method = "GET"
+            body = resrc.render(self)
+
+            if body is NOT_DONE_YET:
+                log.msg("Tried to fake a HEAD request for %s, but "
+                        "it got away from me." % resrc)
+                # Oh well, I guess we won't include the content length.
+            else:
+                self.setHeader('content-length', str(len(body)))
+
+            self.write('')
+            self.finish()
+            return
+
+        if self.method in (supportedMethods):
+            # We MUST include an Allow header
+            # (RFC 2616, 10.4.6 and 14.7)
+            self.setHeader('Allow', allowedMethods)
+            s = ('''Your browser approached me (at %(URI)s) with'''
+                 ''' the method "%(method)s".  I only allow'''
+                 ''' the method%(plural)s %(allowed) here.''' % {
+                'URI': self.uri,
+                'method': self.method,
+                'plural': ((len(allowedMethods) > 1) and 's') or '',
+                'allowed': string.join(allowedMethods, ', ')
+                })
+            epage = error.ErrorPage(http.NOT_ALLOWED,
+                                    "Method Not Allowed", s)
+            body = epage.render(self)
+        else:
+            epage = error.ErrorPage(http.NOT_IMPLEMENTED, "Huh?",
+                                    """I don't know how to treat a"""
+                                    """ %s request."""
+                                    % (self.method))
+            body = epage.render(self)
+
+    def render(self, resrc):
+        defer.maybeDeferred(resrc.render, 
self).addErrback(self._ebRender, resrc).addCallback(self._cbRender, 
resrc).addErrback(self.processingFailed)
+
+

      def processingFailed(self, reason):
          log.err(reason)




From itamar at itamarst.org  Sun Sep 14 12:06:29 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 14 Sep 2003 12:06:29 -0400
Subject: [Twisted-Python] Patch to allow deferreds to be returned from
 resource.render
In-Reply-To: <56DC7FB4-E69D-11D7-8255-003065F305CC@fuhm.net>
References: <56DC7FB4-E69D-11D7-8255-003065F305CC@fuhm.net>
Message-ID: <20030914120629.46c15f9a.itamar@itamarst.org>

Thanks for writing this - add it to the issue tracker please so we don't
lose it?



From andrew-twisted at puzzling.org  Sun Sep 14 20:25:58 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 15 Sep 2003 10:25:58 +1000
Subject: [Twisted-Python] Patch to allow deferreds to be returned from resource.render
In-Reply-To: <20030914120629.46c15f9a.itamar@itamarst.org>
References: <56DC7FB4-E69D-11D7-8255-003065F305CC@fuhm.net> <20030914120629.46c15f9a.itamar@itamarst.org>
Message-ID: <20030915002558.GA1990@frobozz>

On Sun, Sep 14, 2003 at 12:06:29PM -0400, Itamar Shtull-Trauring wrote:
> Thanks for writing this - add it to the issue tracker please so we don't
> lose it?

Uh, he said:
[...]
> >                                                         I'd stick this
> > on the bug tracker but I forgot my password. (anyone able to reset for
> > me? :)

-Andrew.




From mesozoic at polynode.com  Mon Sep 15 02:13:55 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Mon, 15 Sep 2003 02:13:55 -0400
Subject: [Twisted-Python] Potential fix for vhost+distrib (issue125)
In-Reply-To: <20030914014422.GB29772@pyramid.twistedmatrix.com>
References: <20030914014422.GB29772@pyramid.twistedmatrix.com>
Message-ID: <1063606434.766.7.camel@hyla>

On Sat, 2003-09-13 at 21:44, Chris Armstrong wrote:
> Can everyone who cares about vhosts with distrib (Alex Levy, Thomas
> Raschbacher) update to latest CVS and try putting a ResourceSubscription
> behind a vhost?
> 
> I've tested twistedmatrix.com's setup with this fix, and it works (i.e.,
> UserDirectories, static.Files, CGIs, etc).

I've tried this out with my setup, and it works. Thanks. :)

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030915/952d625b/attachment.pgp 

From Richard.Townsend at edl.uk.eds.com  Mon Sep 15 04:50:39 2003
From: Richard.Townsend at edl.uk.eds.com (Richard.Townsend at edl.uk.eds.com)
Date: Mon, 15 Sep 2003 09:50:39 +0100
Subject: [Twisted-Python] Server errors using Twisted with Python 2.3
Message-ID: <76ADB8C376C3D31193F50008C7E6D3B2F3E178@EWHKA005>

Since installing Python 2.3 on HP-UX11i, I keep getting 'Resource
temporarily unavailable' errors in server applications.

E.g. using ../doc/examples/simpleserv.py & ../doc/examples/simpleclient.py:

"richardt" capulet:doc/examples > python simpleserv.py 
Traceback (most recent call last):
  File "/opt/python/lib/python2.3/site-packages/twisted/python/log.py", line
65, in callWithLogger
    callWithContext({"system": lp}, func, *args, **kw)
  File "/opt/python/lib/python2.3/site-packages/twisted/python/log.py", line
52, in callWithContext
    return context.call({ILogContext: newCtx}, func, *args, **kw)
  File "/opt/python/lib/python2.3/site-packages/twisted/python/context.py",
line 32, in callWithContext
    return func(*args,**kw)
  File
"/opt/python/lib/python2.3/site-packages/twisted/internet/default.py", line
510, in _doReadOrWrite
    why = getattr(selectable, method)()
--- <exception caught here> ---
  File "/opt/python/lib/python2.3/site-packages/twisted/internet/tcp.py",
line 595, in doRead
    skt, addr = self.socket.accept()
  File "/opt/python/lib/python2.3/socket.py", line 167, in accept
    sock, addr = self._sock.accept()
socket.error: (11, 'Resource temporarily unavailable')


"richardt" capulet:doc/examples > python simpleclient.py
Server said: hello, world!
connection lost
Connection lost - goodbye!


The transaction appears to work, but the log file is filling up with these
errors. This happens with Twisted 1.0.6 and 1.0.7.

It doesn't happen when using Python 2.2

Can anyone advise how to fix this problem?

regards,
Richard Townsend
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20030915/2e1e6033/attachment.htm 

From SKuzminski at fairisaac.com  Mon Sep 15 10:18:44 2003
From: SKuzminski at fairisaac.com (Kuzminski, Stefan R)
Date: Mon, 15 Sep 2003 07:18:44 -0700
Subject: [Twisted-Python] stack trace
Message-ID: <7646464ACC9B5347A4A5C57729D74A550369BD5D@srfmsg100.corp.fairisaac.com>

Hi,

 

I'm using twisted to build a process management tool.  I have a TCP
server that runs reactor.spawnProcess(), it runs the process, but then
generates this stack trace.  I'm at a bit of a loss as to how to resolve
this..  Is there perhaps another approach I should try?  I need to
manage long running processes on remote boxes.

 

Thanks, 

Stefan

 

 

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/twisted/python/context.py",
line 32, i\

n callWithContext

    return func(*args,**kw)

  File
"/usr/lib/python2.3/site-packages/twisted/internet/pollreactor.py",
line\

 173, in _doReadOrWrite

    selectable.connectionLost(f)

  File "/usr/lib/python2.3/site-packages/twisted/internet/process.py",
line 431\

, in connectionLost

    self.maybeCallProcessEnded()

  File "/usr/lib/python2.3/site-packages/twisted/internet/process.py",
line 394\

, in maybeCallProcessEnded

    self.reapProcess()

--- <exception caught here> ---

  File "/usr/lib/python2.3/site-packages/twisted/internet/process.py",
line 301\

, in reapProcess

    pid, status = os.waitpid(self.pid, os.WNOHANG)

exceptions.OSError: [Errno 10] No child processes

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20030915/d45d7e70/attachment.htm 

From itamar at itamarst.org  Mon Sep 15 11:32:53 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 15 Sep 2003 11:32:53 -0400
Subject: [Twisted-Python] Server errors using Twisted with Python 2.3
In-Reply-To: <76ADB8C376C3D31193F50008C7E6D3B2F3E178@EWHKA005>
References: <76ADB8C376C3D31193F50008C7E6D3B2F3E178@EWHKA005>
Message-ID: <20030915113253.3c17e4cb.itamar@itamarst.org>

On Mon, 15 Sep 2003 09:50:39 +0100
Richard.Townsend at edl.uk.eds.com wrote:

> Since installing Python 2.3 on HP-UX11i, I keep getting 'Resource
> temporarily unavailable' errors in server applications.

Add a bug report in the issue tracker (twistedmatrix.com/bugs) and
assign it to me and I'll fix it soon.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From gsuneethav at hotmail.com  Mon Sep 15 14:17:44 2003
From: gsuneethav at hotmail.com (suneetha velicheti)
Date: Mon, 15 Sep 2003 11:17:44 -0700
Subject: [Twisted-Python] How to save the content(string) of a DOM node into a file?
Message-ID: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>

Hi,
   I wanted to save the content of a DOM node into a file and want my 
browser to prompt me with "save as" window. I already set the browser 
preferences. Right now the content of the node is just displaying in the 
browser window. Instead of that I want to promt the user to save that 
content into a file with "save as" option window. Are there any DOM helper 
methods to do this?

Thanks for the help,
Suneetha.

_________________________________________________________________
Try MSN Messenger 6.0 with integrated webcam functionality! 
http://www.msnmessenger-download.com/tracking/reach_webcam




From daniel at hawton.org  Mon Sep 15 17:58:46 2003
From: daniel at hawton.org (Daniel Hawton)
Date: Mon, 15 Sep 2003 14:58:46 -0700
Subject: [Twisted-Python] Good example of Network+Tkinter use
In-Reply-To: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
References: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
Message-ID: <3F663616.4030001@hawton.org>

I am trying to write a client for IRC that handles its own network data 
parsing, but has multiple Tkinter Dialogs.  I was wondering if there was 
a decent example of this, or something similar, and where it would be. 
Tutorials work too except I learn better by examples of implementation 
for some reason.

Thanks in advance,
Daniel




From radix at twistedmatrix.com  Mon Sep 15 20:41:12 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Mon, 15 Sep 2003 20:41:12 -0400
Subject: [Twisted-Python] How to save the content(string) of a DOM node into a file?
In-Reply-To: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
References: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
Message-ID: <20030916004112.GB2795@pyramid.twistedmatrix.com>

On Mon, Sep 15, 2003 at 11:17:44AM -0700, suneetha velicheti wrote:
> Hi,
>   I wanted to save the content of a DOM node into a file and want my 
> browser to prompt me with "save as" window. I already set the browser 
> preferences. Right now the content of the node is just displaying in the 
> browser window. Instead of that I want to promt the user to save that 
> content into a file with "save as" option window. Are there any DOM helper 
> methods to do this?

see the "write[pretty]xml" method.
-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From bob at redivi.com  Mon Sep 15 21:15:00 2003
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 15 Sep 2003 21:15:00 -0400
Subject: [Twisted-Python] How to save the content(string) of a DOM node into a file?
In-Reply-To: <20030916004112.GB2795@pyramid.twistedmatrix.com>
Message-ID: <31B2BC5C-E7E3-11D7-8876-000A95686CD8@redivi.com>

On Monday, Sep 15, 2003, at 20:41 America/New_York, Chris Armstrong 
wrote:

> On Mon, Sep 15, 2003 at 11:17:44AM -0700, suneetha velicheti wrote:
>> Hi,
>>   I wanted to save the content of a DOM node into a file and want my
>> browser to prompt me with "save as" window. I already set the browser
>> preferences. Right now the content of the node is just displaying in 
>> the
>> browser window. Instead of that I want to promt the user to save that
>> content into a file with "save as" option window. Are there any DOM 
>> helper
>> methods to do this?
>
> see the "write[pretty]xml" method.

I think he's talking about rigging the Content-Type header so that the 
browser thinks it doesn't know how to display the content, and will 
prompt the user to save the document.  It really has nothing to do with 
DOM at all.

Try:
	request.setHeader('content-type', 'application/octet-stream')

In your render method.

-bob




From andrew-twisted at puzzling.org  Mon Sep 15 21:17:56 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 16 Sep 2003 11:17:56 +1000
Subject: [Twisted-Python] How to save the content(string) of a DOM node into a file?
In-Reply-To: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
References: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
Message-ID: <20030916011756.GA4093@frobozz>

On Mon, Sep 15, 2003 at 11:17:44AM -0700, suneetha velicheti wrote:
> Hi,
>   I wanted to save the content of a DOM node into a file and want my 
> browser to prompt me with "save as" window. I already set the browser 
> preferences. Right now the content of the node is just displaying in the 
> browser window. Instead of that I want to promt the user to save that 
> content into a file with "save as" option window. Are there any DOM helper 
> methods to do this?

So you're serving XML from a Twisted web server?  I think you want to call
"request.setHeader('content-type', 'application/octet-stream')", or
something like that.  That should convince the browser to save it rather
than display it (this applies to pretty much anything you could serve, not
just XML).

There's also a Content-Disposition header that is supposed to do this, but
I've never been able to figure out how to make it work reliably across
different browsers.

-Andrew.




From itamar at itamarst.org  Mon Sep 15 23:24:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 15 Sep 2003 23:24:20 -0400
Subject: [Twisted-Python] Release notes for 1.0.7
Message-ID: <20030915232420.56ca0b7e.itamar@itamarst.org>

Please email me anything I missed so I can fix before I email c.l.p and
c.l.p.a

What's New in 1.0.7
===================

- Client Jabber support.

- twisted.xish, an XML package supporting a DOM-like API and a
  XPATH-like API.

- Woven web templating toolkit is now much faster, and no longer
  supports the interim APIs it had during development.

- Security tightening in the web server, especially on Windows.

- XML-RPC server is now easier to extend, and can publish the XML-RPC
  introspection API as an option.

- Working minimum and maximum sizes for database connection pools.

- New connection API for Perspective Broker, allowing easy SSL
  support, reconnection, etc..

- Better lenient HTML parsing in microdom.

- Many improvements to mail protocols (SMTP, POP3, IMAP).

- Continued switch to updated cred unified authentication backend
  in the various protocols supported by Twisted.

- SOAP support now requires SOAPpy 0.10.1 or later.

- mailmail, a replacement for the common usage of command-line 
  /usr/sbin/sendmail.

- Bug fixes, documentation improvements, more tests.



From andrew-twisted at puzzling.org  Tue Sep 16 02:38:50 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 16 Sep 2003 16:38:50 +1000
Subject: [Twisted-Python] Anti-Verisign DNS Filter.
Message-ID: <20030916063850.GE4093@frobozz>

Robert Thomson, a workmate of mine, wrote this hack to filter DNS responses
to thwart Verisign's stupid wildcard on root-level domains.  It's simple but
does the job.  Enjoy.

--- snip ---
#!/usr/bin/python
#
# Run this as root with the command
#   twistd -y anti-verisign-dns.py

from twisted.internet import app, defer
from twisted.protocols import dns
from twisted.names import client, server

roots = [
('198.41.0.4',53), ('128.9.0.107',53), ('192.33.4.12',53), ('128.8.10.90',53),
('192.203.230.10',53), ('192.5.5.241',53), ('192.112.36.4',53),
('128.63.2.53',53), ('192.36.148.17',53), ('192.58.128.30',53),
('193.0.14.129',53), ('198.32.64.12',53), ('202.12.27.33',53), ]

#roots = [('202.129.64.42',53)]   # just use my ISP's DNS

VERISIGN='@^n\x0b' # 64.94.110.11

class AntiVerisignResolver(client.Resolver):
    def filterAnswers(self, message):
        if message.trunc:
            return self.queryTCP(message.queries).addCallback(self.filterAnswers)
        else:
            for i in range(len(message.answers)):
                x = message.answers[i]
                if x.type==1 and x.payload and x.payload.address==VERISIGN:
                    message.answers[i] = None
            return (filter(lambda x:x,message.answers),
                    message.authority,
                    message.additional)

verbosity = 0
resolver = AntiVerisignResolver(servers=roots)
f = server.DNSServerFactory(clients=[resolver], verbose=verbosity)
p = dns.DNSDatagramProtocol(f)
f.noisy = p.noisy = verbosity

application = app.Application('Non caching anti-verisign domain name resolver')
application.listenUDP(53, p)
application.listenTCP(53, f)
--- snip ---

-Andrew.




From stephen at thorne.id.au  Mon Sep 15 21:17:15 2003
From: stephen at thorne.id.au (Stephen Thorne.)
Date: Tue, 16 Sep 2003 11:17:15 +1000
Subject: [Twisted-Python] Small woven application example
Message-ID: <200309161117.15176.stephen@thorne.id.au>

Hi.

I did some hacking with twisted.web and woven, just to try and teach myself 
how to go about writing a web application using twisted, bearing in mind I 
write php in my day job, this was a little hard.

http://thorne.ath.cx:3000/~stephen/wikiexample.xhtml
is the result of my efforts, and you can see it running at 
http://thorne.ath.cx:8081/MainPage/

I've got there the original code I started with (using Resource and a fairly 
phpish methodology) and what I finished with.

In my little venture back into the realm of twisted, I see the following 
lacking in the documentation:

 * The varied Views and Widgets are poorly documented, I found myself 
inventing what was needed, then going into Twisted/twisted/web/woven/ and 
reading widgets.py and view.py - and discovering that they already existed.

 * There is very little mapping between "This is how you would do it in a 
silly framework" -> "This is how twisted makes it cleaner and easier"

 * The pitfalls.
	* e.g. For submitting forms and the implicit header "Location:" redirects 
which obliterate your post values. (When you have <form action="/Foo/bar">, 
but you'll get redirected to "/Foo/bar/")
	* the interface to the factories should be written down on a piece of card 
and stuck to the monitor. Swapping 'request' and 'model' doesn't help things.

As such, I intend to go through all the views and widgets, and write a small 
example piece of code, showing what each of them does, and what 
inputs/outputs they take. I also intend to take some php idioms and show a 
mapping from them to twisted.

Fortuantely, I've got loads of experience with lore (I recently used it to 
typeset a 90+ page tutorial for a camp I'm leading on in 2 weeks, 
http://thorne.ath.cx:3000/lwdoc/index.xhtml if you're interested)

Please send replies CC: stephen at thorne.id.au as I'm not currently subscribed 
to the list.

Regards,
Stephen Thorne




From itamar at itamarst.org  Tue Sep 16 14:25:06 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 16 Sep 2003 14:25:06 -0400
Subject: [Twisted-Python] Perspective Broker in 1.0.7
Message-ID: <20030916142506.15f0f875.itamar@itamarst.org>

If you are using PB code, you will start getting deprecation warnings
when you upgrade to 1.0.7. This is due to switching to:

1. A new connection API that doesn't suck.
2. New cred support.

#1 is documented in the 1.0.7 Howtos. #2 isn't.

You can however see examples of how to do #2 in CVS, specifically these
two files:

http://cvs.twistedmatrix.com/cvs/doc/examples/pbecho.py?rev=1.9&content-type=text/vnd.viewcvs-markup
http://cvs.twistedmatrix.com/cvs/doc/examples/pbechoclient.py?rev=1.10&content-type=text/vnd.viewcvs-markup

and compare them to doc/examples/pbecho(client).py in 1.0.7 or older CVS
versions.

Some of Twisted's internal code doesn't use this new API either. By 1.1
all docs, examples and code in Twisted will have switched to the new
API. The old API will of course continue to be supported for some time,
but it is recommended you switch as the new API is much cleaner and
better designed.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From ccom at gmx.net  Tue Sep 16 14:38:14 2003
From: ccom at gmx.net (Jerome Jushima)
Date: Tue, 16 Sep 2003 20:38:14 +0200 (MEST)
Subject: [Twisted-Python] Re : executing .rpy in a thread
Message-ID: <7173.1063737494@www59.gmx.net>

With the help of your hint I have come up with the following code. For
simplicity's sake I don't use .rpys here since it shouldn't change the approach.
What happens when I run this code and open the servers root in a webbrowser is
that I get a page saying "NOT_DONE_YET." Also when I get rid of the
quotation marks in the return statement it does not seem to work. Python just tells
me that it does not know NOT_DONE_YET.

I am also not coherent in my head of how to pass the request variable to my
doLongPageGeneration function.

Is it correct how I  registered the callbacks?

Thanks to all the twisted gurus,  _stephan

---------------------------------------------------start

 from twisted.web import server, resource, static, script
 from twisted.internet import reactor
 from twisted.internet import threads

def doLongPageGeneration():
     return "<html><b>H</b>ello, <b>W</b>orld!</html>"

class Simple(resource.Resource):
     isLeaf = True
     def render(self, request):
         d = threads.deferToThread(doLongPageGeneration)
         d.addCallback(request.write)
         d.addCallback(request.finish)
         return "NOT_DONE_YET"


site = server.Site(Simple())
reactor.listenTCP(8080, site)

reactor.run()

------------------------------------------------------end

> The easiest way to run code in a thread and get the result back is with 
> twisted.internet.threads.deferToThread.  Your Resource's render method 
> would need to return NOT_DONE_YET, and you'd need to add callbacks to 
> the Deferred from deferToThread that call request.write(...) and 
> request.finish().

>> Say I want to execute blocking code in a .rpy file. Can't I just 
>> execute all the code in a separate thread? I've found the following 
>> code to execute a function in a thread. How could I add a callback to 
>> that thread so I could get back the whole html page back from that 
>> "notthreadSafe" function and return it to the client
>> (web browser)?


-- 
+++ GMX - die erste Adresse f?r Mail, Message, More! +++

Getestet von Stiftung Warentest: GMX FreeMail (GUT), GMX ProMail (GUT)
(Heft 9/03 - 23 e-mail-Tarife: 6 gut, 12 befriedigend, 5 ausreichend)

Jetzt selbst kostenlos testen: http://www.gmx.net




From mesozoic at polynode.com  Tue Sep 16 14:55:56 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Tue, 16 Sep 2003 14:55:56 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <7173.1063737494@www59.gmx.net>
References: <7173.1063737494@www59.gmx.net>
Message-ID: <1063738556.774.9.camel@hyla>

On Tue, 2003-09-16 at 14:38, Jerome Jushima wrote:
> class Simple(resource.Resource):
>      isLeaf = True
>      def render(self, request):
>          d = threads.deferToThread(doLongPageGeneration)
>          d.addCallback(request.write)
>          d.addCallback(request.finish)
>          return "NOT_DONE_YET"

Should be:
        return server.NOT_DONE_YET

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030916/9b4b2c04/attachment.pgp 

From itamar at itamarst.org  Tue Sep 16 15:10:26 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 16 Sep 2003 15:10:26 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <7173.1063737494@www59.gmx.net>
References: <7173.1063737494@www59.gmx.net>
Message-ID: <20030916151026.209df2d3.itamar@itamarst.org>

On Tue, 16 Sep 2003 20:38:14 +0200 (MEST)
"Jerome Jushima" <ccom at gmx.net> wrote:

>          d.addCallback(request.finish)

Should be d.addCallback(lambda _: request.finish()) since it takes no
arguments.
However, this approach in general is wrong. Using Woven is probably a
better way of dealing with this, since it handles Deferreds
transparently.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Tue Sep 16 15:10:56 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 16 Sep 2003 15:10:56 -0400
Subject: [Twisted-Python] Perspective Broker in 1.0.7
In-Reply-To: <20030916142506.15f0f875.itamar@itamarst.org>
References: <20030916142506.15f0f875.itamar@itamarst.org>
Message-ID: <20030916151056.35f4ac14.itamar@itamarst.org>

Also see sandbox/jml/pb-go*.py.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Tue Sep 16 15:20:34 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 16 Sep 2003 15:20:34 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <7173.1063737494@www59.gmx.net>
Message-ID: <D86C6D06-E87A-11D7-A81E-000A95686CD8@redivi.com>

On Tuesday, Sep 16, 2003, at 14:38 America/New_York, Jerome Jushima 
wrote:

> With the help of your hint I have come up with the following code. For
> simplicity's sake I don't use .rpys here since it shouldn't change the 
> approach.
> What happens when I run this code and open the servers root in a 
> webbrowser is
> that I get a page saying "NOT_DONE_YET." Also when I get rid of the
> quotation marks in the return statement it does not seem to work. 
> Python just tells
> me that it does not know NOT_DONE_YET.

This is how you want to do it, there should be no surprises with this 
approach (it handles failures, logs to stdout):

from twisted.web import server, resource, static, script
from twisted.internet import reactor, threads
from twisted.python import log
import sys

def doLongPageGeneration(request):
     # you *could* inspect the request object if you needed to from here
     # but I wouldn't *change* it from this thread!
     return "<html><b>H</b>ello, <b>W</b>orld! - Your user agent is 
%s</html>" % request.getHeader('user-agent')

def writeRequestAndFinish(data, request):
     request.write(data)
     request.finish()

class Simple(resource.Resource):
     isLeaf = True
     def render(self, request):
         threads.deferToThread(doLongPageGeneration, 
request).addCallback(writeRequestAndFinish, 
request).addErrback(request.processingFailed)
         return server.NOT_DONE_YET

site = server.Site(Simple())
reactor.listenTCP(8080, site)
# I'm not sure if this is strictly necessary, but it seems like a good 
idea.
reactor.initThreads()
log.startLogging(sys.stdout)
reactor.run()




From bob at redivi.com  Tue Sep 16 15:50:45 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 16 Sep 2003 15:50:45 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <20030916151026.209df2d3.itamar@itamarst.org>
Message-ID: <1002DE77-E87F-11D7-A81E-000A95686CD8@redivi.com>

On Tuesday, Sep 16, 2003, at 15:10 America/New_York, Itamar 
Shtull-Trauring wrote:

> On Tue, 16 Sep 2003 20:38:14 +0200 (MEST)
> "Jerome Jushima" <ccom at gmx.net> wrote:
>
>>          d.addCallback(request.finish)
>
> Should be d.addCallback(lambda _: request.finish()) since it takes no
> arguments.
> However, this approach in general is wrong. Using Woven is probably a
> better way of dealing with this, since it handles Deferreds
> transparently.

It's definitely not wrong to go without Woven in a lot of cases, such 
as non-XML output, but I provided a Pretty Good Example of how to do 
what he asked in my previous message in this thread.

-bob




From foom at fuhm.net  Tue Sep 16 16:28:38 2003
From: foom at fuhm.net (James Y Knight)
Date: Tue, 16 Sep 2003 16:28:38 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <20030916151026.209df2d3.itamar@itamarst.org>
Message-ID: <5AADD54A-E884-11D7-9A7C-003065F305CC@fuhm.net>

On Tuesday, September 16, 2003, at 03:10  PM, Itamar Shtull-Trauring 
wrote:

> Should be d.addCallback(lambda _: request.finish()) since it takes no
> arguments.
> However, this approach in general is wrong. Using Woven is probably a
> better way of dealing with this, since it handles Deferreds
> transparently.

What you *really* want to do is apply the patch I posted earlier that 
makes render handle deferreds properly, and then do:

---cut---
from twisted.web import server, resource, static, script
from twisted.internet import reactor
from twisted.internet import threads

def doLongPageGeneration():
      return "<html><b>H</b>ello, <b>W</b>orld!</html>"

class Simple(resource.Resource):
      isLeaf = True
      def render(self, request):
          return threads.deferToThread(doLongPageGeneration)

site = server.Site(Simple())
reactor.listenTCP(8080, site)

reactor.run()
---cut---

James




From egor at iplus.ru  Wed Sep 17 04:58:29 2003
From: egor at iplus.ru (Egor Cheshkov)
Date: Wed, 17 Sep 2003 12:58:29 +0400
Subject: [Twisted-Python] callFromThread with return
Message-ID: <3F682235.5000106@iplus.ru>

Hello! Suppose I run task in worker thread (e.g. database transaction) 
and I need to do some IO (PB call) and get the result from it during 
transaction. Since I run not in reactor's thread it's ok to block and 
wait for the result. I know that there is callFromThread but it never 
return any result. Is it possible to implement something like 
callFromThread that can block, wait for result and return it?

Thanks in advance,
Egor.





From itamar at itamarst.org  Wed Sep 17 08:50:00 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 17 Sep 2003 08:50:00 -0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <3F682235.5000106@iplus.ru>
References: <3F682235.5000106@iplus.ru>
Message-ID: <20030917085000.2a9120e9.itamar@itamarst.org>

On Wed, 17 Sep 2003 12:58:29 +0400
Egor Cheshkov <egor at iplus.ru> wrote:

> Hello! Suppose I run task in worker thread (e.g. database transaction)
> 
> and I need to do some IO (PB call) and get the result from it during 
> transaction. Since I run not in reactor's thread it's ok to block and 
> wait for the result. I know that there is callFromThread but it never 
> return any result. Is it possible to implement something like 
> callFromThread that can block, wait for result and return it?

As documented in the threading howto, you can use
twisted.internet.threads.deferToThread.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From egor at iplus.ru  Wed Sep 17 12:34:41 2003
From: egor at iplus.ru (Egor Cheshkov)
Date: Wed, 17 Sep 2003 20:34:41 +0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <20030917085000.2a9120e9.itamar@itamarst.org>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org>
Message-ID: <3F688D21.3080905@iplus.ru>

Itamar Shtull-Trauring ?????:

>On Wed, 17 Sep 2003 12:58:29 +0400
>Egor Cheshkov <egor at iplus.ru> wrote:
>
>  
>
>>Hello! Suppose I run task in worker thread (e.g. database transaction)
>>
>>and I need to do some IO (PB call) and get the result from it during 
>>transaction. Since I run not in reactor's thread it's ok to block and 
>>wait for the result. I know that there is callFromThread but it never 
>>return any result. Is it possible to implement something like 
>>callFromThread that can block, wait for result and return it?
>>    
>>
>
>As documented in the threading howto, you can use
>twisted.internet.threads.deferToThread.
>
If I understand right, I should use deferToThread to shedule long 
running task from main thread (that running event loop), i need 
different thing. I need to shedule a method to be run in the main event 
loop from another thread. It is the thing that callFromThread does, but 
callFromThread does not return anything. I need to get result from such 
call. Is it possible?

Egor.








From justinjohnson at fastmail.fm  Wed Sep 17 13:31:02 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 17 Sep 2003 11:31:02 -0600
Subject: [Twisted-Python] Quotient Problems
Message-ID: <20030917173102.AB8333BFFE@www.fastmail.fm>

I'm not sure if Quotient questions should go to this list...?

I installed the latest Quotient from CVS, including all its dependencies
and Twisted itself from CVS.  I got it installed on my RH9 Linux box and
am running an instance of Quotient.

I added an IMAP grabber, successfully I think, and now when I go to the
Home page it says...

Recent Items
Nothing is new under the sun.
Current Status
myaddress at my.domain@myimap.host.com
Initializing...

(Note, I changed the address and host names above for this email.)  It
always says initializing whenever I return to this page.  What does this
mean?  How do I get to my inbox?

Thanks.
-Justin



From itamar at itamarst.org  Wed Sep 17 14:16:33 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 17 Sep 2003 14:16:33 -0400
Subject: [Twisted-Python] Quotient Problems
In-Reply-To: <20030917173102.AB8333BFFE@www.fastmail.fm>
References: <20030917173102.AB8333BFFE@www.fastmail.fm>
Message-ID: <20030917141633.7fd1b490.itamar@itamarst.org>

On Wed, 17 Sep 2003 11:31:02 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> I'm not sure if Quotient questions should go to this list...?

They should not - see
http://www.divmod.net/users/roundup.twistd/quotient/ for issue tracker,
http://divmod.net/users/mailman.twistd/listinfo/divmod-dev is the list.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From rprice at collegenet.com  Wed Sep 17 20:16:46 2003
From: rprice at collegenet.com (Ray Price)
Date: 17 Sep 2003 17:16:46 -0700
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <D86C6D06-E87A-11D7-A81E-000A95686CD8@redivi.com>
References: <D86C6D06-E87A-11D7-A81E-000A95686CD8@redivi.com>
Message-ID: <1063844206.4669.530.camel@hotpepper.unival.com>

How would I create a .tap file to execute the example below?

Ray 



On Tue, 2003-09-16 at 12:20, Bob Ippolito wrote:
> On Tuesday, Sep 16, 2003, at 14:38 America/New_York, Jerome Jushima 
> wrote:
> 
> > With the help of your hint I have come up with the following code. For
> > simplicity's sake I don't use .rpys here since it shouldn't change the 
> > approach.
> > What happens when I run this code and open the servers root in a 
> > webbrowser is
> > that I get a page saying "NOT_DONE_YET." Also when I get rid of the
> > quotation marks in the return statement it does not seem to work. 
> > Python just tells
> > me that it does not know NOT_DONE_YET.
> 
> This is how you want to do it, there should be no surprises with this 
> approach (it handles failures, logs to stdout):
> 
> from twisted.web import server, resource, static, script
> from twisted.internet import reactor, threads
> from twisted.python import log
> import sys
> 
> def doLongPageGeneration(request):
>      # you *could* inspect the request object if you needed to from here
>      # but I wouldn't *change* it from this thread!
>      return "<html><b>H</b>ello, <b>W</b>orld! - Your user agent is 
> %s</html>" % request.getHeader('user-agent')
> 
> def writeRequestAndFinish(data, request):
>      request.write(data)
>      request.finish()
> 
> class Simple(resource.Resource):
>      isLeaf = True
>      def render(self, request):
>          threads.deferToThread(doLongPageGeneration, 
> request).addCallback(writeRequestAndFinish, 
> request).addErrback(request.processingFailed)
>          return server.NOT_DONE_YET
> 
> site = server.Site(Simple())
> reactor.listenTCP(8080, site)
> # I'm not sure if this is strictly necessary, but it seems like a good 
> idea.
> reactor.initThreads()
> log.startLogging(sys.stdout)
> reactor.run()
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python





From andrew-twisted at puzzling.org  Wed Sep 17 21:17:12 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 18 Sep 2003 11:17:12 +1000
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <1063844206.4669.530.camel@hotpepper.unival.com>
References: <D86C6D06-E87A-11D7-A81E-000A95686CD8@redivi.com> <1063844206.4669.530.camel@hotpepper.unival.com>
Message-ID: <20030918011712.GB11240@frobozz>

On Wed, Sep 17, 2003 at 05:16:46PM -0700, Ray Price wrote:
> How would I create a .tap file to execute the example below?
> 
> On Tue, 2003-09-16 at 12:20, Bob Ippolito wrote:
[...]
> > reactor.run()

It calls reactor.run, so you can't use twistd on this file.  Just run it
directly, it's an ordinary Python script.

-Andrew.




From kevin.m.turner at pobox.com  Thu Sep 18 03:18:45 2003
From: kevin.m.turner at pobox.com (Kevin Turner)
Date: Thu, 18 Sep 2003 00:18:45 -0700
Subject: [Twisted-Python] ANN: CVSToys 1.0.9 (for Twisted 1.0.7)
Message-ID: <1063869524.11160.27.camel@troglodyte.funhouse>

Greetings,

It is my pleasure to inform you that CVSToys 1.0.9 has been released. 
That means you can finally get rid of all those DeprecationWarnings
which fill your screen every time you commit, if you've upgraded your
Twisted version past 1.0.6.

Things are changing in PBService -- in particular, there may no longer
be more than one Service (or a Service and a Manhole) on a single port. 
This may break things for some of you, but it also may have the pleasant
side-effect of it may fixing that long-standing bug with freshcvs
crapping out if it fails to grab the default pb port on start-up.  

Unfortunately I can't guarantee that .tap files with PBServices or
manholes in them will still work, you may have to re-mktap them.  And
you can expect more changes around PBService when Twisted 1.0.8 comes
out, as we migrate to newcred.

(Just tuning in?  CVSToys contains Fresh CVS, a CVS commit monitoring
daemon which can deliver commit messages over a variety of protocols
(e-mail, chat, web, etc.) and automate other tasks, such as back-up or
auto-check-out.)

You can find CVSToys at http://purl.net/net/CVSToys
A big thanks to Divmod (www.divmod.com) for sponsoring our web hosting,
and tummy.com for the CVS server.

Share and enjoy,

 - Kevin

-- 
The moon is last quarter, 57.4% illuminated, 21.4 days old.



From syver at inout.no  Thu Sep 18 05:46:03 2003
From: syver at inout.no (Syver Enstad)
Date: 18 Sep 2003 11:46:03 +0200
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <3F688D21.3080905@iplus.ru>
References: <3F682235.5000106@iplus.ru>
	<20030917085000.2a9120e9.itamar@itamarst.org>
	<3F688D21.3080905@iplus.ru>
Message-ID: <upthysa3o.fsf@inout.no>

Egor Cheshkov <egor at iplus.ru> writes:

> Itamar Shtull-Trauring ?????:
> 
> >On Wed, 17 Sep 2003 12:58:29 +0400
> >Egor Cheshkov <egor at iplus.ru> wrote:
> >
> >
> >>Hello! Suppose I run task in worker thread (e.g. database transaction)
> >>
> >> and I need to do some IO (PB call) and get the result from it
> >> during transaction. Since I run not in reactor's thread it's ok to
> >> block and wait for the result. I know that there is callFromThread
> >> but it never return any result. Is it possible to implement
> >> something like callFromThread that can block, wait for result and
> >> return it?
> >>
> >
> >As documented in the threading howto, you can use
> >twisted.internet.threads.deferToThread.
> >
> If I understand right, I should use deferToThread to shedule long
> running task from main thread (that running event loop), i need
> different thing. I need to shedule a method to be run in the main
> event loop from another thread. It is the thing that callFromThread
> does, but callFromThread does not return anything. I need to get
> result from such call. Is it possible?

Can't you pass yourself and have the method that you pass to
callFromThread callback on a method on yourself with the results?

 




From andrew-twisted at puzzling.org  Thu Sep 18 06:29:04 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 18 Sep 2003 20:29:04 +1000
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <upthysa3o.fsf@inout.no>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no>
Message-ID: <20030918102904.GA13575@frobozz>

On Thu, Sep 18, 2003 at 11:46:03AM +0200, Syver Enstad wrote:
> Egor Cheshkov <egor at iplus.ru> writes:
> 
> > If I understand right, I should use deferToThread to shedule long
> > running task from main thread (that running event loop), i need
> > different thing. I need to shedule a method to be run in the main
> > event loop from another thread. It is the thing that callFromThread
> > does, but callFromThread does not return anything. I need to get
> > result from such call. Is it possible?
> 
> Can't you pass yourself and have the method that you pass to
> callFromThread callback on a method on yourself with the results?

But that won't run the callback in the worker thread.

Here's the situation in dodgy ascii art:

           Main Thread                      
      (Twisted reactor, etc)
                |
                v
                |
                \
                |\
                | ->----------------------callInThread starts
                v                        Worker Thread running
                |                            worker_function()
                |                                  |
                |                                  v
                |                                  |
                |                                  /
                |                                 /.
          callFromThread------------------------<- .
      causes other_func() to                       . 
         run in Main Thread                        .
                |                                  .
                v                                  .
                |                          Worker Thread waits
                |                         for other_func result
                |                                  .
                |                                  .
         But how does the                          .
     Main Thread pass a result                     .
       to Worker Thread and                        .
       resume its execution?                       ?

There needs to be a wrapper function around callFromThread that blocks the
worker thread on a threading.Event or similar, and then causes the Event to
be fired when the function finishes, and returns the result.

Or, in untested code:

-----
import threading, sys
from twisted.internet import reactor

def blockingCallFromThread(func):
    e = threading.Event()
    l = []
    def wrapped_func():
        try:
            l.append(func)
        except:
            l.append(sys.exc_info())
            l.append(0)
        else:
            l.append(1)
        e.set()
    reactor.callFromThread(wrapped_func)
    e.wait()
    result, ok = l
    if ok:
        return result
    else:
        # Whee!  Cross-thread exceptions!
        raise result[0], result[1], result[2]
----

This is utterly untested.  It probably should be tested and added to
twisted.internet.util or t.i.threads, though.

-Andrew.




From snesbitt at cobaltgroup.com  Thu Sep 18 12:47:40 2003
From: snesbitt at cobaltgroup.com (Nesbitt, Steve)
Date: Thu, 18 Sep 2003 09:47:40 -0700
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
Message-ID: <25160AB2660F8B449892B0EB9C29C1650B5777@ex-sea-is2.cobaltgroup.com>

All:

Newbie alert!

I would like to implement an XML-RPC server as a plugin (using the QuoteD
how-to as an example) and can't figure out how to do so. In particular I
don't understand how to create the protocol created as part of the factory.

Can anyone provide some clues/code?

Thanks!

-steve

Steve Nesbitt
Senior Configuration Manager
The Cobalt Group
snesbitt at cobaltgroup.com





This e-mail transmission contains information intended only for the use of
the recipient(s) named above. Further, it contains information that may be
privileged and confidential. If you are not the intended recipient, you are
hereby notified that any dissemination, distribution, or copying of this
message (including any attachments) is strictly prohibited. If you have
received this e-mail in error, please notify the sender by reply e-mail and
then delete this message from your mail system. Thank you for your
compliance.



From itamar at itamarst.org  Thu Sep 18 13:10:11 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 18 Sep 2003 13:10:11 -0400
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
In-Reply-To: <25160AB2660F8B449892B0EB9C29C1650B5777@ex-sea-is2.cobaltgroup.com>
References: <25160AB2660F8B449892B0EB9C29C1650B5777@ex-sea-is2.cobaltgroup.com>
Message-ID: <20030918131011.1ab283f0.itamar@itamarst.org>

On Thu, 18 Sep 2003 09:47:40 -0700
"Nesbitt, Steve" <snesbitt at cobaltgroup.com> wrote:

> I would like to implement an XML-RPC server as a plugin (using the
> QuoteD how-to as an example) and can't figure out how to do so. In
> particular I don't understand how to create the protocol created as
> part of the factory.

Protocols are created by the factory when the port you are listening
gets an incoming connection - the factory's buildProtocol is called and
the resulting protocol is connected to the transport for the new
connection.

In any case, Twisted already has a nice XML-RPC server framework,
documented at http://twistedmatrix.com/documents/howto/xmlrpc - it
should support anything you might want to do with a XML-RPC server.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From snesbitt at cobaltgroup.com  Thu Sep 18 13:27:12 2003
From: snesbitt at cobaltgroup.com (Nesbitt, Steve)
Date: Thu, 18 Sep 2003 10:27:12 -0700
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
Message-ID: <25160AB2660F8B449892B0EB9C29C1650B5778@ex-sea-is2.cobaltgroup.com>

Thanks Itamar.

I've been reviewing the howto and have that working.

My next step, however, was to turn that example into an actual plugin
following the QuoteD plugin example which has three parts:
- quoters.py => contains business logic
- quoteproto.py => contains the protocol definition
- quotetap.py => application interface/wrapper

My problem is coming up with the xmlrpc equivalent of quoteproto.py which
looks like this:


from twisted.internet.protocol import Factory, Protocol
from twisted.internet.app import Application

class QOTD(Protocol):

    def connectionMade(self):
        self.transport.write(self.factory.quoter.getQuote()+'\r\n')
        self.transport.loseConnection()

class QOTDFactory(Factory):

    protocol = QOTD

    def __init__(self, quoter):
        self.quoter = quoter




What I can't figure out what this should look like for an xmlrpc server. It
appears (to me at least) that a fundamental function of the factory method
is to set the protocol. But I don't know what this should be for xml-rpc and
since twisted appears to do the right thing already, I don't really want to
rewrite the connectionMade, etc. methods.

I suppose the core issue is that in order to create a plugin I need to call:
app.listenTCP(port, factory) and I don't know what factory object to pass or
how to get it.

Thanks,

-steve

Steve Nesbitt
Senior Configuration Manager
The Cobalt Group
snesbitt at cobaltgroup.com

-----Original Message-----
From: Itamar Shtull-Trauring [mailto:itamar at itamarst.org]
Sent: Thursday, September 18, 2003 10:10 AM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] Newbie:XMLRPC Server as plugin?


On Thu, 18 Sep 2003 09:47:40 -0700
"Nesbitt, Steve" <snesbitt at cobaltgroup.com> wrote:

> I would like to implement an XML-RPC server as a plugin (using the
> QuoteD how-to as an example) and can't figure out how to do so. In
> particular I don't understand how to create the protocol created as
> part of the factory.

Protocols are created by the factory when the port you are listening
gets an incoming connection - the factory's buildProtocol is called and
the resulting protocol is connected to the transport for the new
connection.

In any case, Twisted already has a nice XML-RPC server framework,
documented at http://twistedmatrix.com/documents/howto/xmlrpc - it
should support anything you might want to do with a XML-RPC server.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python





This e-mail transmission contains information intended only for the use of
the recipient(s) named above. Further, it contains information that may be
privileged and confidential. If you are not the intended recipient, you are
hereby notified that any dissemination, distribution, or copying of this
message (including any attachments) is strictly prohibited. If you have
received this e-mail in error, please notify the sender by reply e-mail and
then delete this message from your mail system. Thank you for your
compliance.



From itamar at itamarst.org  Thu Sep 18 13:56:36 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 18 Sep 2003 13:56:36 -0400
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
In-Reply-To: <25160AB2660F8B449892B0EB9C29C1650B5778@ex-sea-is2.cobaltgroup.com>
References: <25160AB2660F8B449892B0EB9C29C1650B5778@ex-sea-is2.cobaltgroup.com>
Message-ID: <20030918135636.3bd3fb4d.itamar@itamarst.org>

On Thu, 18 Sep 2003 10:27:12 -0700
"Nesbitt, Steve" <snesbitt at cobaltgroup.com> wrote:

> What I can't figure out what this should look like for an xmlrpc
> server. It appears (to me at least) that a fundamental function of the
> factory method is to set the protocol. But I don't know what this
> should be for xml-rpc and since twisted appears to do the right thing
> already, I don't really want to rewrite the connectionMade, etc.
> methods.

You don't need to implement a factory or protocol, since the framework
already implements them for you. You just need to subclass XMLRPC and
run it as shown. You could of course have a generic business logic
object that the XML-RPC interface acts as an interface to.

Writing factories and protocols is only necessary if you are
implementing a new protocol. HTTP is already implemented for you, so you
need not bother :)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From daniel at hawton.org  Thu Sep 18 18:51:53 2003
From: daniel at hawton.org (Daniel Hawton)
Date: Thu, 18 Sep 2003 15:51:53 -0700
Subject: [Twisted-Python] Easy GTK+Twisted+Networking Tutorial
Message-ID: <3F6A3709.2030008@hawton.org>

I am still learning GTK, and I want to write an application that shows 
information based on data received in a Socket.  I was told Twisted 
helps with this, and am looking for an example/simple tutorial that 
could explain how to use Twisted, instead of having to use Threads.

Thanks,
Daniel




From dnfesp at hotmail.com  Thu Sep 18 21:23:47 2003
From: dnfesp at hotmail.com (Daniel Fernndez)
Date: Fri, 19 Sep 2003 01:23:47 +0000
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
Message-ID: <BAY2-F558aszmeeUwMJ0000f7fe@hotmail.com>

Sorry, I'm newbie too..

I got confused also the first time, then I realized that what I wanted was 
just a server not a protocol (in my case a SOAP one). But then I found the 
way things are explained is running your server as a regular python script, 
but that prevents you from taking advantage from the facilities given by 
running your service like e.g. twistd -f myserver.tap. So I realized that 
what I really need is an Application so I can have a tap file. Everything 
seems easy but then while following the examples (the last one in Creating 
XML-RPC Servers and Clients - modified to get a tap file) I get an 
unexpected error. I'm using Twisted 1.0.7 with SOAPpy 0.10.2 and python 2.3 
on windows 2000

the code is a bit modified, I removed the quoters logic and changed the last 
line from:
application.run(save=0)    --------->   application.save("start")
in order to get a tap file

<code>
from twisted.web import soap, xmlrpc, resource, server

class XMLRPCQuoter(xmlrpc.XMLRPC):
    def xmlrpc_quote(self):
        return 'Hola'

class SOAPQuoter(soap.SOAPPublisher):
    def soap_quote(self):
        return 'Hola'

def main():
    from twisted.internet.app import Application
    app = Application("xmlrpc")
    root = resource.Resource()
    root.putChild('RPC2', XMLRPCQuoter())
    root.putChild('SOAP', SOAPQuoter())
    app.listenTCP(7080, server.Site(root))
    return app

application = main()

if __name__ == '__main__':
    application.save("start")
</code>

I can't find what is going wrong here, this is the log I'm getting when I 
try to run xmlrpc-start.tap

D:\Python23\Lib\site-packages>twistd -f xmlrpc-start.tap
2003/09/18 20:08 Hora de verano de M?xico [-] Log opened.
2003/09/18 20:08 Hora de verano de M?xico [-] twistd 1.0.7 
(D:\PYTHON23\python.e
xe 2.3.0) starting up
2003/09/18 20:08 Hora de verano de M?xico [-] reactor class: 
twisted.internet.de
fault.SelectReactor
2003/09/18 20:08 Hora de verano de M?xico [-] Loading xmlrpc-start.tap...
2003/09/18 20:08 Hora de verano de M?xico [-] Warning!  Loading from 
__main__: X
MLRPCQuoter
2003/09/18 20:08 Hora de verano de M?xico [-] Traceback (most recent call 
last):

2003/09/18 20:08 Hora de verano de M?xico [-]   File 
"D:\PYTHON23\Lib\site-packa
ges\twisted\scripts\twistd.py", line 317, in runApp
2003/09/18 20:08 Hora de verano de M?xico [-]     application = 
loadApplication(
config, passphrase)
2003/09/18 20:08 Hora de verano de M?xico [-]   File 
"D:\PYTHON23\Lib\site-packa
ges\twisted\scripts\twistd.py", line 210, in loadApplication
2003/09/18 20:08 Hora de verano de M?xico [-]     return decode(filename, 
data)
2003/09/18 20:08 Hora de verano de M?xico [-]   File 
"D:\PYTHON23\Lib\site-packa
ges\twisted\scripts\twistd.py", line 188, in decode
2003/09/18 20:08 Hora de verano de M?xico [-]     application = 
pickle.loads(dat
a)
2003/09/18 20:08 Hora de verano de M?xico [-] AttributeError: ('Ephemeral 
instan
ce has no __call__ method', <twisted.persisted.styles.Ephemeral instance at 
0x00
FEB580>, ())
2003/09/18 20:08 Hora de verano de M?xico [-] Failed to load application: 
('Ephe
meral instance has no __call__ method', <twisted.persisted.styles.Ephemeral 
inst
ance at 0x00FEB580>, ())
2003/09/18 20:08 Hora de verano de M?xico [-] Traceback (most recent call 
last):

          File "D:\PYTHON23\scripts\twistd.py", line 32, in ?
            run()
          File "D:\PYTHON23\Lib\site-packages\twisted\scripts\twistd.py", 
line 4
48, in run
            runApp(config)
        --- <exception caught here> ---
          File "D:\PYTHON23\Lib\site-packages\twisted\scripts\twistd.py", 
line 3
17, in runApp
            application = loadApplication(config, passphrase)
          File "D:\PYTHON23\Lib\site-packages\twisted\scripts\twistd.py", 
line 2
10, in loadApplication
            return decode(filename, data)
          File "D:\PYTHON23\Lib\site-packages\twisted\scripts\twistd.py", 
line 1
88, in decode
            application = pickle.loads(data)
        exceptions.AttributeError: ('Ephemeral instance has no __call__ 
method',
<twisted.persisted.styles.Ephemeral instance at 0x00FEB580>, ())


Failed to load application: ('Ephemeral instance has no __call__ method', 
<twist
ed.persisted.styles.Ephemeral instance at 0x00FEB580>, ())
2003/09/18 20:08 Hora de verano de M?xico [-]


after that it just return to the prompt.



any help would be really appreciated.

thanks

_________________________________________________________________
Protect your PC - get McAfee.com VirusScan Online 
http://clinic.mcafee.com/clinic/ibuy/campaign.asp?cid=3963




From teratorn at world-net.net  Fri Sep 19 04:34:50 2003
From: teratorn at world-net.net (Eric Mangold)
Date: Fri, 19 Sep 2003 03:34:50 -0500
Subject: [Twisted-Python] Patch to shoutcast protocol
Message-ID: <200309190334.50135.teratorn@world-net.net>

Here is a patch to shoutcast.py. This makes it not crash when the server 
doesn't provide MP3 metadata. It also allows the user to request metadata or 
not.

-Eric

P.S. The diff came out weird, but it works as it should :)



-------------- next part --------------
A non-text attachment was scrubbed...
Name: shoutcast.py.diff
Type: text/x-diff
Size: 2607 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030919/4ffaa92e/attachment.diff 

From uwe at oss4u.com  Fri Sep 19 05:30:26 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Fri, 19 Sep 2003 02:30:26 -0700
Subject: [Twisted-Python] Off topic question
Message-ID: <200309190230.26272.uwe@oss4u.com>

Hi,

this is off topic, but I thought it is the best place to ask.
I've written a program for the insurance business. It's based on a twisted pb 
server and wxPython clients. My customer possibly needs to extend the 
software pretty soon and I think I will be "outgunned" by that demand.
Therefor I look for someone who possibly (but not necessarily) has a 
background in insurance and is adept programming python using twisted and 
wxPython. I know this is not the place for a job offer, nonetheless this is 
the the place where the skilled people gather.
It's not determined if this expansion will happen, but I want to stay ahead. 
So if anyone has spare time for a project and could need some cash, get in 
touch with me. Payment is negotiable. To put the cards on the table, you'd 
have to surrender the copyright, so we'd need to adjust the payment 
accordingly.
Anyone interested ? Drop me a mail.

PS: I give a sh... about "computer science degree needed". All I need is 
someone who can do the job - and if you learned it at home on your C64, are a 
groceries salesperson and can do the job, that's fine with me :-) 

Thanks

	UC

--
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417




From justinjohnson at fastmail.fm  Fri Sep 19 07:42:08 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 19 Sep 2003 05:42:08 -0600
Subject: [Twisted-Python] UDP Factories
Message-ID: <20030919114208.3086E3C45C@www.fastmail.fm>

I have a UDP protocol that subclasses DatagramProtocol.  It is working
fine, but I decided I wanted a protocol factory so I can keep track of
the list of clients.  I added the following class, which doesn't nothing
currently...

class MyProtoFactory(Factory):
    protocol = MyProto
                                                                                
And then changed my reactor.listenUDP line to...

    reactor.listenUDP(config.SERVER_PORT, MyProtoFactory())


[justinj at chewie travis]$ ./udpserver.py
Traceback (most recent call last):
  File "./udpserver.py", line 166, in ?
    reactor.listenUDP(config.SERVER_PORT, MyProtoFactory())
  File
  "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
  line 180, in listenUDP
    p = udp.Port(port, protocol, interface, maxPacketSize, self)
  File "/usr/local/lib/python2.3/site-packages/twisted/internet/udp.py",
  line 66, in __init__
    assert isinstance(proto, protocol.DatagramProtocol)
AssertionError


Any idea what I'm doing wrong?  The examples showed a UDP factory, but I
don't quite see how this would work.

Thanks.
-Justin



From itamar at itamarst.org  Fri Sep 19 11:03:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 11:03:20 -0400
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919114208.3086E3C45C@www.fastmail.fm>
References: <20030919114208.3086E3C45C@www.fastmail.fm>
Message-ID: <20030919110320.7840bec7.itamar@itamarst.org>

On Fri, 19 Sep 2003 05:42:08 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> I have a UDP protocol that subclasses DatagramProtocol.  It is working
> fine, but I decided I wanted a protocol factory so I can keep track of
> the list of clients.  I added the following class, which doesn't
> nothing currently...

You will notice the docs say nothing about factories. This is because
listenUDP does not accept factories :) If you want to keep track of
clients you will have to do it yourself by dispatching based on the
host/port of a received datagram.

Why are you using UDP, by the way?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 19 11:06:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 11:06:51 -0400
Subject: [Twisted-Python] Patch to shoutcast protocol
In-Reply-To: <200309190334.50135.teratorn@world-net.net>
References: <200309190334.50135.teratorn@world-net.net>
Message-ID: <20030919110651.65b197d2.itamar@itamarst.org>

On Fri, 19 Sep 2003 03:34:50 -0500
Eric Mangold <teratorn at world-net.net> wrote:

> Here is a patch to shoutcast.py. This makes it not crash when the
> server doesn't provide MP3 metadata. It also allows the user to
> request metadata or not.

Add the patch to the issue tracker (twistedmatrix.com/issues) and assign
it to me and I will look at it sometime soon.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 19 12:42:31 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 12:42:31 -0400
Subject: [Twisted-Python] Getting to 1.1 -- calling all CVS committers
Message-ID: <20030919124231.4be3f088.itamar@itamarst.org>

Thanks to Moshe, twisted.application has landed. In order to reach 1.1,
there's a few things we need to do:

1. Better new cred docs.
2. Update PB docs to talk about new cred.
3. Update application docs.
4. Update all examples and listings to use PB new cred and new app.
5. Update all taps to use new app.
6. Update manhole, words, distrib etc. to use new cred.

By 1.1, we should have no mention or usage of the old APIs in our docs,
examples and code. This is going to take some work, so please pitch in
and help.

If you don't have CVS, patches to any of the above are welcome!

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Fri Sep 19 17:50:26 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 19 Sep 2003 17:50:26 -0400
Subject: [Twisted-Python] Application refactor
Message-ID: <20030919215026.GA903@intarweb.us>

  Services are severely broken with the new code.  twisted.mail is
completely non-functional.

  Jp

-- 
"Pascal is Pascal is Pascal is dog meat."
                -- M. Devine and P. Larson, Computer Science 340
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030919/42aa084d/attachment.pgp 

From justinjohnson at fastmail.fm  Fri Sep 19 18:18:32 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 19 Sep 2003 16:18:32 -0600
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919110320.7840bec7.itamar@itamarst.org>
References: <20030919114208.3086E3C45C@www.fastmail.fm> <20030919110320.7840bec7.itamar@itamarst.org>
Message-ID: <20030919221832.714673C4B4@www.fastmail.fm>

Yeah I sent this email out real quick without looking at the doc.  Sorry.

I'm using UDP because the device I'm coding for uses UDP.  Twisted sure
saved me a ton of time.

Out of curiosity, why doesn't listenUDP accept Factories?

On Fri, 19 Sep 2003 11:03:20 -0400, "Itamar Shtull-Trauring"
<itamar at itamarst.org> said:
> On Fri, 19 Sep 2003 05:42:08 -0600
> "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> 
> > I have a UDP protocol that subclasses DatagramProtocol.  It is working
> > fine, but I decided I wanted a protocol factory so I can keep track of
> > the list of clients.  I added the following class, which doesn't
> > nothing currently...
> 
> You will notice the docs say nothing about factories. This is because
> listenUDP does not accept factories :) If you want to keep track of
> clients you will have to do it yourself by dispatching based on the
> host/port of a received datagram.
> 
> Why are you using UDP, by the way?
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From exarkun at intarweb.us  Fri Sep 19 18:00:11 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 19 Sep 2003 18:00:11 -0400
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919114208.3086E3C45C@www.fastmail.fm>
References: <20030919114208.3086E3C45C@www.fastmail.fm>
Message-ID: <20030919220011.GB927@intarweb.us>

On Fri, Sep 19, 2003 at 05:42:08AM -0600, Justin Johnson wrote:
> I have a UDP protocol that subclasses DatagramProtocol.  It is working
> fine, but I decided I wanted a protocol factory so I can keep track of
> the list of clients.  I added the following class, which doesn't nothing
> currently...
> 
> class MyProtoFactory(Factory):
>     protocol = MyProto

  Factories aren't to be used with DatagramProtocols, since a single
DatagramProtocol instance manages all traffic to and from the ports you
designate.

  If you want to share state between different DatagramProtocol instances,
give them a reference to a common object manually (not a factory, but
perhaps a service), or reconsider and use a single instance to talk to all
your clients.  Nothing prevents you from listening on multiple ports with
the same instance.

  Jp

-- 
"Pascal is Pascal is Pascal is dog meat."
                -- M. Devine and P. Larson, Computer Science 340
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030919/e5985302/attachment.pgp 

From krosenjack at hotmail.com  Fri Sep 19 18:40:43 2003
From: krosenjack at hotmail.com (Kevin Rosenjack)
Date: Fri, 19 Sep 2003 15:40:43 -0700
Subject: [Twisted-Python] UDP Factories
Message-ID: <Sea1-F75qqKgWRjfXr600010842@hotmail.com>

Your not coding for a UPnP device by any chance, are you?


>From: "Justin Johnson" <justinjohnson at fastmail.fm>
>Reply-To: twisted-python at twistedmatrix.com
>To: "Twisted-Python" <twisted-python at twistedmatrix.com>
>Subject: Re: [Twisted-Python] UDP Factories
>Date: Fri, 19 Sep 2003 16:18:32 -0600
>
>Yeah I sent this email out real quick without looking at the doc.  Sorry.
>
>I'm using UDP because the device I'm coding for uses UDP.  Twisted sure
>saved me a ton of time.
>
>Out of curiosity, why doesn't listenUDP accept Factories?
>
>On Fri, 19 Sep 2003 11:03:20 -0400, "Itamar Shtull-Trauring"
><itamar at itamarst.org> said:
> > On Fri, 19 Sep 2003 05:42:08 -0600
> > "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> >
> > > I have a UDP protocol that subclasses DatagramProtocol.  It is working
> > > fine, but I decided I wanted a protocol factory so I can keep track of
> > > the list of clients.  I added the following class, which doesn't
> > > nothing currently...
> >
> > You will notice the docs say nothing about factories. This is because
> > listenUDP does not accept factories :) If you want to keep track of
> > clients you will have to do it yourself by dispatching based on the
> > host/port of a received datagram.
> >
> > Why are you using UDP, by the way?
> >
> > --
> > Itamar Shtull-Trauring    http://itamarst.org/
> > Available for Python & Twisted consulting
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

_________________________________________________________________
Get 10MB of e-mail storage! Sign up for Hotmail Extra Storage.  
http://join.msn.com/?PAGE=features/es




From itamar at itamarst.org  Fri Sep 19 22:21:21 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 22:21:21 -0400
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919221832.714673C4B4@www.fastmail.fm>
References: <20030919114208.3086E3C45C@www.fastmail.fm>
	<20030919110320.7840bec7.itamar@itamarst.org>
	<20030919221832.714673C4B4@www.fastmail.fm>
Message-ID: <20030919222121.2690a18c.itamar@itamarst.org>

On Fri, 19 Sep 2003 16:18:32 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> Yeah I sent this email out real quick without looking at the doc. 
> Sorry.
> 
> I'm using UDP because the device I'm coding for uses UDP.  Twisted
> sure saved me a ton of time.
> 
> Out of curiosity, why doesn't listenUDP accept Factories?

This would, to be a general purpose thing, need to create a protocol per
datagram. This would be... inefficient. In TCP you have a protocol per
connection. In UDP there are no connections. You might build one on top
of UDP, in which case you would have a protocol-ish object you dispatch
to, but how you determine this object and its lifecycle would be
something you would have to determine.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 19 22:22:33 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 22:22:33 -0400
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919220011.GB927@intarweb.us>
References: <20030919114208.3086E3C45C@www.fastmail.fm>
	<20030919220011.GB927@intarweb.us>
Message-ID: <20030919222233.03ef1635.itamar@itamarst.org>

On Fri, 19 Sep 2003 18:00:11 -0400
Jp Calderone <exarkun at intarweb.us> wrote:

>   If you want to share state between different DatagramProtocol
>   instances,
> give them a reference to a common object manually (not a factory, but
> perhaps a service), or reconsider and use a single instance to talk to
> all your clients.  Nothing prevents you from listening on multiple
> ports with the same instance.

Not really, there's a self.transport, so you can only connect a
datagramprotocol to a single port.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 19 22:25:12 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 22:25:12 -0400
Subject: [Twisted-Python] Application refactor
In-Reply-To: <20030919215026.GA903@intarweb.us>
References: <20030919215026.GA903@intarweb.us>
Message-ID: <20030919222512.68b831b3.itamar@itamarst.org>

On Fri, 19 Sep 2003 17:50:26 -0400
Jp Calderone <exarkun at intarweb.us> wrote:

>   Services are severely broken with the new code.  twisted.mail is
> completely non-functional.

Some lack of backwards compatability is to be expected (I had to fix
twistd --debug). It is not *acceptable*, however, to leave it that way -
we need to get it fixed. Try to debug it yourself if you can, but
beating up moshez with symptoms is also acceptable ;)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From ccom at gmx.net  Fri Sep 19 22:32:57 2003
From: ccom at gmx.net (ccom at gmx.net)
Date: Sat, 20 Sep 2003 04:32:57 +0200 (MEST)
Subject: [Twisted-Python] Re : executing .rpy in a thread
Message-ID: <23035.1064025177@www48.gmx.net>

It is tempting to use Jamse's patch because the code does get more elegant.
On the other hand the suggestion to develope pivotal to twisted makes a lot
of sense too. I Hope this patch will become part of twisted soon. 

Thanks to bob for showing me the "conventional" way of doing it. I just
tested  his code and it works on my setup too.

_stephan

-- 
+++ GMX - die erste Adresse f?r Mail, Message, More! +++

Getestet von Stiftung Warentest: GMX FreeMail (GUT), GMX ProMail (GUT)
(Heft 9/03 - 23 e-mail-Tarife: 6 gut, 12 befriedigend, 5 ausreichend)

Jetzt selbst kostenlos testen: http://www.gmx.net




From itamar at itamarst.org  Fri Sep 19 23:21:30 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 23:21:30 -0400
Subject: [Twisted-Python] Application refactor
In-Reply-To: <20030919215026.GA903@intarweb.us>
References: <20030919215026.GA903@intarweb.us>
Message-ID: <20030919232130.70ea3b23.itamar@itamarst.org>

On Fri, 19 Sep 2003 17:50:26 -0400
Jp Calderone <exarkun at intarweb.us> wrote:

>   Services are severely broken with the new code.  twisted.mail is
> completely non-functional.

Fixed in CVS. Everyone, please try existing TAPs and code with CVS
Twisted and report any problems with the new application code in the
issue tracker.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Sat Sep 20 00:48:38 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 20 Sep 2003 00:48:38 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <23035.1064025177@www48.gmx.net>
References: <23035.1064025177@www48.gmx.net>
Message-ID: <3F6BDC26.3070104@twistedmatrix.com>

ccom at gmx.net wrote:
>  I Hope this patch will become part of twisted soon.

It seems that we should apply it.  Does it play nicely with distrib and 
not break compatibility?  If so, I'm +1




From wilk-ml at flibuste.net  Sat Sep 20 07:36:20 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Sat, 20 Sep 2003 13:36:20 +0200
Subject: [Twisted-Python] send somes mails
Message-ID: <87n0czn13f.fsf@flibuste.net>

Hi,

Is it a good way to call smtp.sendmail() for sending a lot of mails
(it's for a scrabble game, not spam !) It will connect and deconect for
each mail isn't it ?

thanks

-- 
William Dod? - http://flibuste.net



From gaiacrtn at free.fr  Sat Sep 20 11:45:46 2003
From: gaiacrtn at free.fr (Baptiste Lepilleur)
Date: Sat, 20 Sep 2003 17:45:46 +0200
Subject: [Twisted-Python] Examples using PBServerFactory ?
Message-ID: <021201c37f8e$427cbae0$4dbfc2d4@gaia>

    Is there some examples of using the PBServerFactory ? When running
examples from Perspective Broker how to
(http://twistedmatrix.com/documents/howto/pb-usage#auto2) I get a deprecated
warning concerning pb.BrokerFactory usage.

    Since I'm new to twisted, I'd rather get thing right from the start

    Thanks,
    Baptiste.




From itamar at itamarst.org  Sat Sep 20 12:20:56 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 20 Sep 2003 12:20:56 -0400
Subject: [Twisted-Python] Examples using PBServerFactory ?
In-Reply-To: <021201c37f8e$427cbae0$4dbfc2d4@gaia>
References: <021201c37f8e$427cbae0$4dbfc2d4@gaia>
Message-ID: <20030920122056.1591c7fc.itamar@itamarst.org>

On Sat, 20 Sep 2003 17:45:46 +0200
"Baptiste Lepilleur" <gaiacrtn at free.fr> wrote:

>     Is there some examples of using the PBServerFactory ? When running
> examples from Perspective Broker how to
> (http://twistedmatrix.com/documents/howto/pb-usage#auto2) I get a
> deprecated warning concerning pb.BrokerFactory usage.

sandbox/jml/pb-go*.py in the tarball and doc/examples/pbecho*.py in CVS.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From gaiacrtn at free.fr  Sat Sep 20 13:52:39 2003
From: gaiacrtn at free.fr (Baptiste Lepilleur)
Date: Sat, 20 Sep 2003 19:52:39 +0200
Subject: [Twisted-Python] Examples using PBServerFactory ?
References: <021201c37f8e$427cbae0$4dbfc2d4@gaia> <20030920122056.1591c7fc.itamar@itamarst.org>
Message-ID: <022701c37f9f$fd06e140$4dbfc2d4@gaia>

Thanks, this works like a charm.

Baptiste.

----- Original Message ----- 
From: "Itamar Shtull-Trauring" <itamar at itamarst.org>
To: <twisted-python at twistedmatrix.com>
Sent: Saturday, September 20, 2003 6:20 PM
Subject: Re: [Twisted-Python] Examples using PBServerFactory ?


> On Sat, 20 Sep 2003 17:45:46 +0200
> "Baptiste Lepilleur" <gaiacrtn at free.fr> wrote:
> 
> >     Is there some examples of using the PBServerFactory ? When running
> > examples from Perspective Broker how to
> > (http://twistedmatrix.com/documents/howto/pb-usage#auto2) I get a
> > deprecated warning concerning pb.BrokerFactory usage.
> 
> sandbox/jml/pb-go*.py in the tarball and doc/examples/pbecho*.py in CVS.
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting




From busch at transporeon.com  Sat Sep 20 13:59:51 2003
From: busch at transporeon.com (Axel Busch)
Date: Sat, 20 Sep 2003 19:59:51 +0200
Subject: AW: [Twisted-Python] Examples using PBServerFactory ?
In-Reply-To: <021201c37f8e$427cbae0$4dbfc2d4@gaia>
Message-ID: <000c01c37fa0$fd80fdd0$4600a8c0@atlas>

hi Baptiste, 

I'm also new to python and twisted, but maybe I have something 
that will help you getting started. 
Attached are two examples, both use twisted and wxPython 
(because I need a GUI for the client.) 

pbVerySimple: 
basically what you will find in the sandbox, but with some 
comments from Glyph which I found in the mailing list regarding 
"Realm" and "Avatar" and the like. 

pbSimple: 
here I felt more adventurous. Several Clients will have the same 
perspective, which will give them a view, which is a wrapper for 
a collection of server-objects. 
Clients subscribe for a list of those objects (called "Transports", 
because I'm working in eLogistics) and when one client changes 
a Transport the others will get an update. 
Take care, propably I did lots of stuff wrong there, and of course 
the security model is not for productive use. ;) 
Maybe the more experienced guys on this list will help us with 
advice. 
When you start client.py you have to give it a user name ("bob" or 
"nici") as an argument. 

My setting: winXP, python2.3, wxPython2.4.1.2, Twisted-1.0.7rc1 

Regards, 

Axel 


> -----Urspr?ngliche Nachricht-----
> Von: twisted-python-admin at twistedmatrix.com 
> [mailto:twisted-python-admin at twistedmatrix.com] Im Auftrag 
> von Baptiste Lepilleur
> Gesendet: Samstag, 20. September 2003 17:46
> An: twisted-python at twistedmatrix.com
> Betreff: [Twisted-Python] Examples using PBServerFactory ?
> 
> 
>     Is there some examples of using the PBServerFactory ? When running
> examples from Perspective Broker how to
> (http://twistedmatrix.com/documents/howto/pb-usage#auto2) I 
> get a deprecated
> warning concerning pb.BrokerFactory usage.
> 
>     Since I'm new to twisted, I'd rather get thing right from 
> the start
> 
>     Thanks,
>     Baptiste.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pbSimple.zip
Type: application/x-zip-compressed
Size: 4632 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030920/4e5e97eb/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pbVerySimple.zip
Type: application/x-zip-compressed
Size: 5206 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030920/4e5e97eb/attachment-0001.bin 

From golux at comcast.net  Sat Sep 20 10:52:25 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Sat, 20 Sep 2003 10:52:25 -0400
Subject: AW: [Twisted-Python] Examples using PBServerFactory ?
In-Reply-To: <000c01c37fa0$fd80fdd0$4600a8c0@atlas>
References: <000c01c37fa0$fd80fdd0$4600a8c0@atlas>
Message-ID: <3F6C69A9.3030107@comcast.net>

Axel Busch wrote:

>Attached are two examples, both use twisted and wxPython 
>(because I need a GUI for the client.) 
>

Awesome, Axel!  Both examples work perfectly.
(But note that the names of the zip files are reversed.) 
These will be quite useful to us, since we are also
developing a wxPython client that interacts with
a Twisted server app.

Thanks!
- Steve.





From busch at transporeon.com  Sat Sep 20 15:56:27 2003
From: busch at transporeon.com (Axel Busch)
Date: Sat, 20 Sep 2003 21:56:27 +0200
Subject: AW: AW: [Twisted-Python] Examples using PBServerFactory ?
In-Reply-To: <3F6C69A9.3030107@comcast.net>
Message-ID: <002301c37fb1$471c45c0$4600a8c0@atlas>

Hi Steve,

> Awesome, Axel!  Both examples work perfectly.
Thanks. *blush*. But better wait for the comments of 
Itamar etc. I'm not sure if I got their Ideas of how 
to use all this perspective and view stuff right. 

> (But note that the names of the zip files are reversed.) 
Ups, hehe. *sorry* 

> These will be quite useful to us, since we are also
> developing a wxPython client that interacts with
> a Twisted server app.
> 
> Thanks!

You're welcome. I'm currently still playing around, 
but looks like we will use python/wx/twisted for our 
next projects (currently all c++/mfc/soap). 
Now I'm experimenting with a persistent storage for the 
server-objects, and when that is settled satisfactorily 
we will switch to python/twisted. Things look really great, 
I fell in love with python and twisted ;).
It's just _so_ much more fun.

so long, Axel 





From justinjohnson at fastmail.fm  Sat Sep 20 22:48:47 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Sat, 20 Sep 2003 20:48:47 -0600
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <Sea1-F75qqKgWRjfXr600010842@hotmail.com>
References: <Sea1-F75qqKgWRjfXr600010842@hotmail.com>
Message-ID: <20030921024847.2E2793C06A@www.fastmail.fm>

No.  See www.slimp3.com.

On Fri, 19 Sep 2003 15:40:43 -0700, "Kevin Rosenjack"
<krosenjack at hotmail.com> said:
> Your not coding for a UPnP device by any chance, are you?
> 
> 
> >From: "Justin Johnson" <justinjohnson at fastmail.fm>
> >Reply-To: twisted-python at twistedmatrix.com
> >To: "Twisted-Python" <twisted-python at twistedmatrix.com>
> >Subject: Re: [Twisted-Python] UDP Factories
> >Date: Fri, 19 Sep 2003 16:18:32 -0600
> >
> >Yeah I sent this email out real quick without looking at the doc.  Sorry.
> >
> >I'm using UDP because the device I'm coding for uses UDP.  Twisted sure
> >saved me a ton of time.
> >
> >Out of curiosity, why doesn't listenUDP accept Factories?
> >
> >On Fri, 19 Sep 2003 11:03:20 -0400, "Itamar Shtull-Trauring"
> ><itamar at itamarst.org> said:
> > > On Fri, 19 Sep 2003 05:42:08 -0600
> > > "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> > >
> > > > I have a UDP protocol that subclasses DatagramProtocol.  It is working
> > > > fine, but I decided I wanted a protocol factory so I can keep track of
> > > > the list of clients.  I added the following class, which doesn't
> > > > nothing currently...
> > >
> > > You will notice the docs say nothing about factories. This is because
> > > listenUDP does not accept factories :) If you want to keep track of
> > > clients you will have to do it yourself by dispatching based on the
> > > host/port of a received datagram.
> > >
> > > Why are you using UDP, by the way?
> > >
> > > --
> > > Itamar Shtull-Trauring    http://itamarst.org/
> > > Available for Python & Twisted consulting
> > >
> > > _______________________________________________
> > > Twisted-Python mailing list
> > > Twisted-Python at twistedmatrix.com
> > > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
> >_______________________________________________
> >Twisted-Python mailing list
> >Twisted-Python at twistedmatrix.com
> >http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> _________________________________________________________________
> Get 10MB of e-mail storage! Sign up for Hotmail Extra Storage.  
> http://join.msn.com/?PAGE=features/es
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From justinjohnson at fastmail.fm  Sat Sep 20 23:04:01 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Sat, 20 Sep 2003 21:04:01 -0600
Subject: [Twisted-Python] UDP Factories
In-Reply-To: ARRAY(0x9de7690)
References: ARRAY(0x9de77c8)
Message-ID: <20030921030401.368743BD22@www.fastmail.fm>

Thanks for the help.  This makes sense to me now.

-Justin

On Fri, 19 Sep 2003 22:21:21 -0400, "Itamar Shtull-Trauring"
<itamar at itamarst.org> said:
> On Fri, 19 Sep 2003 16:18:32 -0600
> "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> 
> > Yeah I sent this email out real quick without looking at the doc. 
> > Sorry.
> > 
> > I'm using UDP because the device I'm coding for uses UDP.  Twisted
> > sure saved me a ton of time.
> > 
> > Out of curiosity, why doesn't listenUDP accept Factories?
> 
> This would, to be a general purpose thing, need to create a protocol per
> datagram. This would be... inefficient. In TCP you have a protocol per
> connection. In UDP there are no connections. You might build one on top
> of UDP, in which case you would have a protocol-ish object you dispatch
> to, but how you determine this object and its lifecycle would be
> something you would have to determine.
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From exarkun at intarweb.us  Sat Sep 20 17:12:19 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 20 Sep 2003 17:12:19 -0400
Subject: [Twisted-Python] send somes mails
In-Reply-To: <87n0czn13f.fsf@flibuste.net>
References: <87n0czn13f.fsf@flibuste.net>
Message-ID: <20030920211219.GA11570@intarweb.us>

On Sat, Sep 20, 2003 at 01:36:20PM +0200, William Dode wrote:
> Hi,
> 
> Is it a good way to call smtp.sendmail() for sending a lot of mails
> (it's for a scrabble game, not spam !) It will connect and deconect for
> each mail isn't it ?

  twisted.protocols.smtp.sendmail() is better

  Jp

-- 
http://catandgirl.com/view.cgi?44
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030920/b61efd04/attachment.pgp 

From teratorn at world-net.net  Sun Sep 21 04:03:37 2003
From: teratorn at world-net.net (Eric Mangold)
Date: Sun, 21 Sep 2003 03:03:37 -0500
Subject: [Twisted-Python] formatting a CopiedFailure for GUI display
Message-ID: <200309210303.37179.teratorn@world-net.net>

Hi folks,

When dealing with normal Failure instances, a simple str(aFailure.value) will 
produce an acceptably short error message.  However, a CopiedFailure's value 
attr is "".  str(aCopiedFailure) is the whole giant traceback, unsuitable for 
a gui message box.

Are there any alternatives?

-Eric






From wilk-ml at flibuste.net  Sun Sep 21 04:24:31 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Sun, 21 Sep 2003 10:24:31 +0200
Subject: [Twisted-Python] send somes mails
In-Reply-To: <20030920211219.GA11570@intarweb.us> (Jp Calderone's message of
 "Sat, 20 Sep 2003 17:12:19 -0400")
References: <87n0czn13f.fsf@flibuste.net> <20030920211219.GA11570@intarweb.us>
Message-ID: <877k42sg5c.fsf@flibuste.net>

Jp Calderone <exarkun at intarweb.us> writes:

> On Sat, Sep 20, 2003 at 01:36:20PM +0200, William Dode wrote:
>> Hi,
>> 
>> Is it a good way to call smtp.sendmail() for sending a lot of mails
>> (it's for a scrabble game, not spam !) It will connect and deconect for
>> each mail isn't it ?
>
>   twisted.protocols.smtp.sendmail() is better

It's what i use. But it's very slow and it call each time
reactor.connect...

-- 
William Dod? - http://flibuste.net



From radix at twistedmatrix.com  Sun Sep 21 08:11:54 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sun, 21 Sep 2003 08:11:54 -0400
Subject: [Twisted-Python] formatting a CopiedFailure for GUI display
In-Reply-To: <200309210303.37179.teratorn@world-net.net>
References: <200309210303.37179.teratorn@world-net.net>
Message-ID: <20030921121154.GA12159@pyramid.twistedmatrix.com>

On Sun, Sep 21, 2003 at 03:03:37AM -0500, Eric Mangold wrote:
> When dealing with normal Failure instances, a simple str(aFailure.value) will 
> produce an acceptably short error message.  However, a CopiedFailure's value 
> attr is "".  str(aCopiedFailure) is the whole giant traceback, unsuitable for 
> a gui message box.

CopiedFailure probably doesn't have that information available separately.
It's written such that in the serialization side, it just sends the string
traceback rather than all the frames, etc, but I must've missed sending the
actual exception message separately. You can report a bug on the tracker and
assign it to me, but I encourage you to try to patch it, as I've been
swamped lately :)


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From exarkun at intarweb.us  Sun Sep 21 12:34:49 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 21 Sep 2003 12:34:49 -0400
Subject: [Twisted-Python] send somes mails
In-Reply-To: <877k42sg5c.fsf@flibuste.net>
References: <87n0czn13f.fsf@flibuste.net> <20030920211219.GA11570@intarweb.us> <877k42sg5c.fsf@flibuste.net>
Message-ID: <20030921163449.GA13769@intarweb.us>

On Sun, Sep 21, 2003 at 10:24:31AM +0200, William Dode wrote:
> Jp Calderone <exarkun at intarweb.us> writes:
> 
> > On Sat, Sep 20, 2003 at 01:36:20PM +0200, William Dode wrote:
> >> Hi,
> >> 
> >> Is it a good way to call smtp.sendmail() for sending a lot of mails
> >> (it's for a scrabble game, not spam !) It will connect and deconect for
> >> each mail isn't it ?
> >
> >   twisted.protocols.smtp.sendmail() is better
> 
> It's what i use. But it's very slow and it call each time
> reactor.connect...
> 

  Unless you are sending all the mail to users on a single host or you have
a smarthost which will relay your mail, you must make multiple connections.

  Of course, if you're sending to a smart host, it just means that that
server will have to go out and make connections to multiple hosts... So
you're not saving any work, you're just pushing it onto someone else.

  Jp

-- 
Seduced, shaggy Samson snored.
She scissored short.  Sorely shorn,
Soon shackled slave, Samson sighed,
Silently scheming,
Sightlessly seeking
Some savage, spectacular suicide.
                -- Stanislaw Lem, "Cyberiad"
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030921/be932d0c/attachment.pgp 

From wilk-ml at flibuste.net  Sun Sep 21 14:02:26 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Sun, 21 Sep 2003 20:02:26 +0200
Subject: [Twisted-Python] send somes mails
In-Reply-To: <20030921163449.GA13769@intarweb.us> (Jp Calderone's message of
 "Sun, 21 Sep 2003 12:34:49 -0400")
References: <87n0czn13f.fsf@flibuste.net> <20030920211219.GA11570@intarweb.us>
	<877k42sg5c.fsf@flibuste.net> <20030921163449.GA13769@intarweb.us>
Message-ID: <87vfrmrpe5.fsf@flibuste.net>

Jp Calderone <exarkun at intarweb.us> writes:

> On Sun, Sep 21, 2003 at 10:24:31AM +0200, William Dode wrote:
>> Jp Calderone <exarkun at intarweb.us> writes:
>> 
>> > On Sat, Sep 20, 2003 at 01:36:20PM +0200, William Dode wrote:
>> >> Hi,
>> >> 
>> >> Is it a good way to call smtp.sendmail() for sending a lot of mails
>> >> (it's for a scrabble game, not spam !) It will connect and deconect for
>> >> each mail isn't it ?
>> >
>> >   twisted.protocols.smtp.sendmail() is better
>> 
>> It's what i use. But it's very slow and it call each time
>> reactor.connect...
>> 
>
>   Unless you are sending all the mail to users on a single host or you have
> a smarthost which will relay your mail, you must make multiple connections.
>
>   Of course, if you're sending to a smart host, it just means that that
> server will have to go out and make connections to multiple hosts... So
> you're not saving any work, you're just pushing it onto someone else.

I'm very egoist, i want only to save the work of my programme and let all
the problems to the smarthost ;-). Because i don't want to deal with
queues and others things like that...

My goal is to send the mails to the smarthost the most quickly i
can. It's why i thought i could keep one connection open with the
smarthost.

-- 
William Dod? - http://flibuste.net



From gaiacrtn at free.fr  Mon Sep 22 02:59:48 2003
From: gaiacrtn at free.fr (Baptiste Lepilleur)
Date: Mon, 22 Sep 2003 08:59:48 +0200
Subject: [Twisted-Python] Examples using PBServerFactory ?
References: <000c01c37fa0$fd80fdd0$4600a8c0@atlas>
Message-ID: <00e801c380d7$1ef4a7a0$90b6c2d4@gaia>

Thanks, this will prove useful. Though, I won't be using wxPython for the
interface (I'll probably plug-in a web server). But it's interesting to see
how it's done.

Baptiste.

----- Original Message ----- 
From: "Axel Busch" <busch at transporeon.com>
To: <twisted-python at twistedmatrix.com>
Cc: <gaiacrtn at free.fr>
Sent: Saturday, September 20, 2003 7:59 PM
Subject: AW: [Twisted-Python] Examples using PBServerFactory ?


hi Baptiste,

I'm also new to python and twisted, but maybe I have something
that will help you getting started.
Attached are two examples, both use twisted and wxPython
(because I need a GUI for the client.)

pbVerySimple:
basically what you will find in the sandbox, but with some
comments from Glyph which I found in the mailing list regarding
"Realm" and "Avatar" and the like.

pbSimple:
here I felt more adventurous. Several Clients will have the same
perspective, which will give them a view, which is a wrapper for
a collection of server-objects.
Clients subscribe for a list of those objects (called "Transports",
because I'm working in eLogistics) and when one client changes
a Transport the others will get an update.
Take care, propably I did lots of stuff wrong there, and of course
the security model is not for productive use. ;)
Maybe the more experienced guys on this list will help us with
advice.
When you start client.py you have to give it a user name ("bob" or
"nici") as an argument.

My setting: winXP, python2.3, wxPython2.4.1.2, Twisted-1.0.7rc1

Regards,

Axel


> -----Urspr?ngliche Nachricht-----
> Von: twisted-python-admin at twistedmatrix.com
> [mailto:twisted-python-admin at twistedmatrix.com] Im Auftrag
> von Baptiste Lepilleur
> Gesendet: Samstag, 20. September 2003 17:46
> An: twisted-python at twistedmatrix.com
> Betreff: [Twisted-Python] Examples using PBServerFactory ?
>
>
>     Is there some examples of using the PBServerFactory ? When running
> examples from Perspective Broker how to
> (http://twistedmatrix.com/documents/howto/pb-usage#auto2) I
> get a deprecated
> warning concerning pb.BrokerFactory usage.
>
>     Since I'm new to twisted, I'd rather get thing right from
> the start
>
>     Thanks,
>     Baptiste.




From dkuhlman at cutter.rexx.com  Mon Sep 22 17:00:33 2003
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Mon, 22 Sep 2003 14:00:33 -0700
Subject: [Twisted-Python] Doc on Twisted examples and patterns
In-Reply-To: <20030919124231.4be3f088.itamar@itamarst.org>; from itamar@itamarst.org on Fri, Sep 19, 2003 at 12:42:31PM -0400
References: <20030919124231.4be3f088.itamar@itamarst.org>
Message-ID: <20030922140033.A39429@cutter.rexx.com>

I've updated my document containing Twisted examples and patterns. 
Thanks much to Andrew Bennetts for his suggestions and critique.

You can find the document at:

    http://www.rexx.com/~dkuhlman/twisted_patterns.html

Any suggestions will be appreciated.

Dave

-- 
Dave Kuhlman
dkuhlman at rexx.com
http://www.rexx.com/~dkuhlman



From suneetha at sonic.net  Mon Sep 22 18:49:55 2003
From: suneetha at sonic.net (suneetha at sonic.net)
Date: Mon, 22 Sep 2003 15:49:55 -0700 (PDT)
Subject: [Twisted-Python] how to generate another html page?
Message-ID: <34251.131.243.2.52.1064270995.squirrel@ssl.sonic.net>

Hi,
   When I click on an image, I would like to generate a web form on the
fly, in a desired location. I tried with both Page and DOMTemplate
classes. Could anyone please give me an idea on what attributes to be
defined for what html tags and what class a resource file should use? I
think I misunderstand something in between here. I know how to generate
the web form, only problem is how to integrate this with twisted,
woven.

Thanks
Suneetha.






From edahl at mindspring.com  Mon Sep 22 11:13:09 2003
From: edahl at mindspring.com (Erik A.Dahl)
Date: Mon, 22 Sep 2003 11:13:09 -0400
Subject: [Twisted-Python] twisted and python 2.1.3
Message-ID: <468B01D5-ED0F-11D7-84B1-000393811146@mindspring.com>

I'm using twisted and some other python libraries (zope) and would like 
to use them together.  Of course zope is still back in the 2.1.3 days 
of python.  If I were to deal with defining True and False where needed 
would there be other compatibility issues with 2.1.3 and twisted?

-EAD




From matti.jagula at proekspert.ee  Mon Sep 22 16:58:55 2003
From: matti.jagula at proekspert.ee (Matti Jagula)
Date: Mon, 22 Sep 2003 23:58:55 +0300
Subject: [Twisted-Python] Twisted scalability question
Message-ID: <200309222358.55540.matti.jagula@proekspert.ee>

Hi,

I've got a task to write a DHCP server for a local cable operator and I'm 
considering different frameworks to write it in. I've looked at Twisted a 
couple of times and thought I'd do some little experimenting to see how well 
it behaves with the current task at hand.

The DHCP server needs to do some database interaction to support the business 
logic. So to model the problem I wrote two simple QOTD servers for UDP 
protocol, using a postresql backend for quotes. 

One server is written using a Twisted DatagramProtocol and uses Deferreds for 
database query using adbapi. The other is a dead-simple single-threaded 
block-and-wait UDP socket server with a single database connection that just 
reads from the udp socket, queries the database and writes the result back.

So far so good. I wanted to see how well these servers scale with a lot of 
requests. First I tried making just a lot of sequential requests from a 
single-threaded client, but that showed that the Twisted version was slower 
by a factor of ~4. 

After a little consideration I thought that Twisted must be better for a lot 
of concurrent requests, because of the threaded database access. Twisted 
should be able to accept more than one client at a time and keep all the 
database connections (5 by default, i guess) busy. So I forked 20 clients off 
using a simple bash script with a for loop. The result was that the Twisted 
is still slower, by the same factor of 4.

The "top" shows that while the Twisted server is running, the 5 postgresql 
connections are mostly in "idle" state (they change the name of the process 
to show it). However, while the single threaded server is running, the only 
active pgsql connection is mostly in its "select" state.

So, after the rather lengthy introduction, I'd like to know what am I doing 
wrong? How can I show the better scalability of Twisted platform?

-- 
  Matti Jagula




From pje at telecommunity.com  Tue Sep 23 11:58:14 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Tue, 23 Sep 2003 11:58:14 -0400
Subject: [Twisted-Python] Twisted scalability question
In-Reply-To: <200309222358.55540.matti.jagula@proekspert.ee>
Message-ID: <5.1.0.14.0.20030923111304.0274aec0@mail.telecommunity.com>

At 11:58 PM 9/22/03 +0300, Matti Jagula wrote:

>So, after the rather lengthy introduction, I'd like to know what am I doing
>wrong? How can I show the better scalability of Twisted platform?

This is just a guess, but you probably aren't doing anything complicated 
enough to benefit.  :)

Seriously, if all you're doing is sending a single datagram in response to 
a simple DB query, framework overhead will continue to dominate your 
processing time.  Think about the two programs: both perform the query and 
send the datagram.  But the non-Twisted program *does nothing else*.  So, 
what you're seeing is that the per-invocation framework overhead for the 
Twisted version is about 3x what's required for just the db query and 
datagram send.  For something so simple, that actually sounds pretty 
reasonable!

What Twisted (and the "reactor" pattern in general) excels at is 
multiplexing *concurrent and ongoing* I/O operations.  However, your 
application has *no* ongoing I/O!  In general, Twisted scales well because 
it lets you do other things while you're waiting for I/O.  With TCP 
streams, you may have to wait before you write data, because the receiver 
may be slow.  Likewise, if you're receiving data, the sender may be 
slow.  While it's waiting, Twisted can let you do something else, like send 
or receive data from someone else that's ready at that moment, or do some 
actual computation.

However, in your setup, the *only* I/O that you ever wait for is the 
database!  You're receiving a single UDP packet (that you don't "wait" 
for), and sending a UDP packet (that you don't need to wait to 
send!).  Even if you made it take 10 times longer for the DB query to run, 
you'd *still* be able to send that data out as soon as you receive it.

In short, the problem you're solving is so darn simple that there's no way 
using Twisted can really improve on it, except in terms of issues like 
keeping your DB connection open.  There's simply nothing here for Twisted 
to multiplex!




From itamar at itamarst.org  Tue Sep 23 12:30:06 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 23 Sep 2003 12:30:06 -0400
Subject: [Twisted-Python] twisted and python 2.1.3
In-Reply-To: <468B01D5-ED0F-11D7-84B1-000393811146@mindspring.com>
References: <468B01D5-ED0F-11D7-84B1-000393811146@mindspring.com>
Message-ID: <20030923123006.16835370.itamar@itamarst.org>

On Mon, 22 Sep 2003 11:13:09 -0400
Erik A.Dahl <edahl at mindspring.com> wrote:

> I'm using twisted and some other python libraries (zope) and would
> like to use them together.  Of course zope is still back in the 2.1.3
> days of python.  If I were to deal with defining True and False where
> needed would there be other compatibility issues with 2.1.3 and
> twisted?

Yes, we are using other 2.2 features as well. So, either :

1. switch to older version of Twisted (1.0.4 had 2.1 support).
2. upgrade Zope to use 2.2 (current versions while not officially
supported do run decently on 2.2 - ask around).
3. Wait for Zope 2.7 which runs on python 2.2 IIRC. 
4. Run Twisted and Zope in different processes and communicate via
XML-RPC or something like that.

Personally I'd try for #4 in most cases.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From maoy at cis.upenn.edu  Wed Sep 24 00:08:48 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 00:08:48 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <20030923123006.16835370.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0309232307470.20897-100000@forty-thieves.cis.upenn.edu>

I tried to use twisted python to write a proxy following the given 
socksv4 example. 

The problem i discovered is that: when i try to forward two connections, 
their capacities may not match. 

In a blocking implementation, 
           data = source.read(); dest.write(data);

In a non-blocking implementation, what socksv4 did is something like:

   def dataReceived(data):
	otherConn.transport.write(data)

However, if source is a much faster link than dest, would there be a 
problem? write always return even it should block so that read always 
happens, and the buffer of source tcp connection will never get full, to 
let tcp start flow control?

Thanks.

Yun




From bob at redivi.com  Wed Sep 24 00:47:39 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 24 Sep 2003 00:47:39 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309232307470.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <39B38394-EE4A-11D7-A788-000A95686CD8@redivi.com>

On Wednesday, Sep 24, 2003, at 00:08 America/New_York, Yun Mao wrote:

> I tried to use twisted python to write a proxy following the given
> socksv4 example.
>
> The problem i discovered is that: when i try to forward two 
> connections,
> their capacities may not match.
>
> In a blocking implementation,
>            data = source.read(); dest.write(data);
>
> In a non-blocking implementation, what socksv4 did is something like:
>
>    def dataReceived(data):
> 	otherConn.transport.write(data)
>
> However, if source is a much faster link than dest, would there be a
> problem? write always return even it should block so that read always
> happens, and the buffer of source tcp connection will never get full, 
> to
> let tcp start flow control?

With that code, you are right.  Twisted will buffer everything for 
dest.. so you won't lose any packets, but you might start using a lot 
of memory and source may think that dest has a faster connection than 
dest actually does.

The twisted.internet.policies module can throttle transports, however I 
don't think that any of them can actually determine how fast dest is 
actually consuming the data.  That would require introspecting the 
underlying transport's buffer and I don't believe the transport 
interface has any way of doing that.

You could break the rules and assume that there is a dataBuffer 
attribute (from twisted.internet.abstract.FileDescriptor) which would 
most likely work, until you try and use it on a transport that is not a 
FileDescriptor (wrapped by another policy, is a loopback for testing, 
using a custom reactor, etc.).

In any case, yes, it's possible to solve this problem, but you will 
have to write your own throttling policy which must bend the interface 
rules in its implementation.

I would suggest writing the throttling policy code, and then posting 
your code with a description of your use case to 
http://twistedmatrix.com/bugs/ so there can be a discussion about how 
to best change Twisted's interfaces around a bit so that this kind of 
throttling policy can be implemented in a future release of Twisted 
without digging into objects beyond their declared interfaces.

I could be mistaken, though.  I'm not an expert on twisted.internet, 
but I poked around it a bit when writing my own reactor.

-bob




From andrew-twisted at puzzling.org  Wed Sep 24 01:07:01 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 24 Sep 2003 15:07:01 +1000
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309232307470.20897-100000@forty-thieves.cis.upenn.edu>
References: <20030923123006.16835370.itamar@itamarst.org> <Pine.LNX.4.44.0309232307470.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030924050701.GA9443@frobozz>

On Wed, Sep 24, 2003 at 12:08:48AM -0400, Yun Mao wrote:
> 
> In a non-blocking implementation, what socksv4 did is something like:
> 
>    def dataReceived(data):
> 	otherConn.transport.write(data)
> 
> However, if source is a much faster link than dest, would there be a 
> problem? write always return even it should block so that read always 
> happens, and the buffer of source tcp connection will never get full, to 
> let tcp start flow control?

Twisted will merrily buffer as much data as necessary if the connection
isn't ready for writing.  Unless you are talking about very large amounts of
data, I doubt this would be a serious problem.  I'm guessing here though;
real benchmarks are welcome :)

Still, if it is a problem -- or you're just sufficiently concerned to care
about it anyway :) -- you could use producers and consumers to effectively
throttle the upstream connection (the producer) when the downstream
connection's (the consumer) buffers are full.  Probably something like
twisted.protocols.pcp.ProducerConsumerProxy would help here.

-Andrew.




From maoy at cis.upenn.edu  Wed Sep 24 01:16:06 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 01:16:06 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <39B38394-EE4A-11D7-A788-000A95686CD8@redivi.com>
Message-ID: <Pine.LNX.4.44.0309240053590.20897-100000@forty-thieves.cis.upenn.edu>

Is it true that the only way to see the success of write() is to check the 
FileDescriptor.dataBuffer? 

I'm thinking that suppose there is one way to check this, and I can
somehow add a callback function to the success of each write(), then I can
simply call source.stopReading() after write() and startReading() when I
get callback.

Yun


On Wed, 24 Sep 2003, Bob Ippolito wrote:

> On Wednesday, Sep 24, 2003, at 00:08 America/New_York, Yun Mao wrote:
> 
> > I tried to use twisted python to write a proxy following the given
> > socksv4 example.
> >
> > The problem i discovered is that: when i try to forward two 
> > connections,
> > their capacities may not match.
> >
> > In a blocking implementation,
> >            data = source.read(); dest.write(data);
> >
> > In a non-blocking implementation, what socksv4 did is something like:
> >
> >    def dataReceived(data):
> > 	otherConn.transport.write(data)
> >
> > However, if source is a much faster link than dest, would there be a
> > problem? write always return even it should block so that read always
> > happens, and the buffer of source tcp connection will never get full, 
> > to
> > let tcp start flow control?
> 
> With that code, you are right.  Twisted will buffer everything for 
> dest.. so you won't lose any packets, but you might start using a lot 
> of memory and source may think that dest has a faster connection than 
> dest actually does.
> 
> The twisted.internet.policies module can throttle transports, however I 
> don't think that any of them can actually determine how fast dest is 
> actually consuming the data.  That would require introspecting the 
> underlying transport's buffer and I don't believe the transport 
> interface has any way of doing that.
> 
> You could break the rules and assume that there is a dataBuffer 
> attribute (from twisted.internet.abstract.FileDescriptor) which would 
> most likely work, until you try and use it on a transport that is not a 
> FileDescriptor (wrapped by another policy, is a loopback for testing, 
> using a custom reactor, etc.).
> 
> In any case, yes, it's possible to solve this problem, but you will 
> have to write your own throttling policy which must bend the interface 
> rules in its implementation.
> 
> I would suggest writing the throttling policy code, and then posting 
> your code with a description of your use case to 
> http://twistedmatrix.com/bugs/ so there can be a discussion about how 
> to best change Twisted's interfaces around a bit so that this kind of 
> throttling policy can be implemented in a future release of Twisted 
> without digging into objects beyond their declared interfaces.
> 
> I could be mistaken, though.  I'm not an expert on twisted.internet, 
> but I poked around it a bit when writing my own reactor.
> 
> -bob
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 

-- 
Yun Mao
Ph.D Student, University of Pennsylvania
http://www.cis.upenn.edu/~maoy/





From andrew-twisted at puzzling.org  Wed Sep 24 01:45:40 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 24 Sep 2003 15:45:40 +1000
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309240053590.20897-100000@forty-thieves.cis.upenn.edu>
References: <39B38394-EE4A-11D7-A788-000A95686CD8@redivi.com> <Pine.LNX.4.44.0309240053590.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030924054540.GB9443@frobozz>

On Wed, Sep 24, 2003 at 01:16:06AM -0400, Yun Mao wrote:
> Is it true that the only way to see the success of write() is to check the 
> FileDescriptor.dataBuffer? 

There's another way -- if a FileDescriptor is consumer of a producer, it
will call the producer's pauseProducing when its buffer grows too large
(look at the abstract.FileDescriptor.write source).

> I'm thinking that suppose there is one way to check this, and I can
> somehow add a callback function to the success of each write(), then I can
> simply call source.stopReading() after write() and startReading() when I
> get callback.

You really don't want to do this manually -- you're just going to reinvent
Twisted's producers/consumers infrastructure.  See my other reply.

-Andrew.




From bob at redivi.com  Wed Sep 24 02:19:39 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 24 Sep 2003 02:19:39 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309240053590.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <13BD1B30-EE57-11D7-A788-000A95686CD8@redivi.com>

You won't be able to register a callback to it.. on second thought, you 
may be able to proxy writeSomeData and look at the result to see how 
much data got written, but I think that the reactor may have the actual 
FileDescriptor registered so you'd have to do some more trickery.

On Wednesday, Sep 24, 2003, at 01:16 America/New_York, Yun Mao wrote:

> Is it true that the only way to see the success of write() is to check 
> the
> FileDescriptor.dataBuffer?
>
> I'm thinking that suppose there is one way to check this, and I can
> somehow add a callback function to the success of each write(), then I 
> can
> simply call source.stopReading() after write() and startReading() when 
> I
> get callback.
>
> Yun
>
>
> On Wed, 24 Sep 2003, Bob Ippolito wrote:
>
>> On Wednesday, Sep 24, 2003, at 00:08 America/New_York, Yun Mao wrote:
>>
>>> I tried to use twisted python to write a proxy following the given
>>> socksv4 example.
>>>
>>> The problem i discovered is that: when i try to forward two
>>> connections,
>>> their capacities may not match.
>>>
>>> In a blocking implementation,
>>>            data = source.read(); dest.write(data);
>>>
>>> In a non-blocking implementation, what socksv4 did is something like:
>>>
>>>    def dataReceived(data):
>>> 	otherConn.transport.write(data)
>>>
>>> However, if source is a much faster link than dest, would there be a
>>> problem? write always return even it should block so that read always
>>> happens, and the buffer of source tcp connection will never get full,
>>> to
>>> let tcp start flow control?
>>
>> With that code, you are right.  Twisted will buffer everything for
>> dest.. so you won't lose any packets, but you might start using a lot
>> of memory and source may think that dest has a faster connection than
>> dest actually does.
>>
>> The twisted.internet.policies module can throttle transports, however 
>> I
>> don't think that any of them can actually determine how fast dest is
>> actually consuming the data.  That would require introspecting the
>> underlying transport's buffer and I don't believe the transport
>> interface has any way of doing that.
>>
>> You could break the rules and assume that there is a dataBuffer
>> attribute (from twisted.internet.abstract.FileDescriptor) which would
>> most likely work, until you try and use it on a transport that is not 
>> a
>> FileDescriptor (wrapped by another policy, is a loopback for testing,
>> using a custom reactor, etc.).
>>
>> In any case, yes, it's possible to solve this problem, but you will
>> have to write your own throttling policy which must bend the interface
>> rules in its implementation.
>>
>> I would suggest writing the throttling policy code, and then posting
>> your code with a description of your use case to
>> http://twistedmatrix.com/bugs/ so there can be a discussion about how
>> to best change Twisted's interfaces around a bit so that this kind of
>> throttling policy can be implemented in a future release of Twisted
>> without digging into objects beyond their declared interfaces.
>>
>> I could be mistaken, though.  I'm not an expert on twisted.internet,
>> but I poked around it a bit when writing my own reactor.
>>
>> -bob
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
> -- 
> Yun Mao
> Ph.D Student, University of Pennsylvania
> http://www.cis.upenn.edu/~maoy/
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From matt at sprout.org  Wed Sep 24 12:08:42 2003
From: matt at sprout.org (Matt Boersma)
Date: Wed, 24 Sep 2003 10:08:42 -0600
Subject: [Twisted-Python] 1.0.7 Windows installer bug?
Message-ID: <20030924100842.A28206@sprout.org>

Hello twisters:

I've been developing a PB application on Debian Linux, and it
has gone quite well.  But a coworker wants to test things on
Windows.  <sigh>

I've done nothing intentionally platform-specific, so I don't
think there will be any problems here.  I went to install the
1.0.7 binary release on my Win2K test box to verify this, but
after nearly completing the install, it errors out with:

Unable to execute file: ACK\pythonw.exe
CreateProcess failed; code 2.
The system cannot find the file specified
 
Where is it getting "ACK" from?  I have a standard binary
install of python2.3 from www.python.org on Win2K SP3, and
PYTHONHOME is set to "C:\Python2.3".

Any clues would be much appreciated.

Matt
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030924/e7ac6188/attachment.pgp 

From corydodt at yahoo.com  Wed Sep 24 12:50:31 2003
From: corydodt at yahoo.com (Cory Dodt)
Date: Wed, 24 Sep 2003 09:50:31 -0700
Subject: [Twisted-Python] 1.0.7 Windows installer bug?
In-Reply-To: <20030924100842.A28206@sprout.org>
References: <20030924100842.A28206@sprout.org>
Message-ID: <3F71CB57.2050402@yahoo.com>

"ACK" is the emergency value I inserted in case it can't find the 
following registry key:

HKLM\Software\Python\PythonCore\2.3\InstallPath\<default>

Please open an issue in the tracker for this: 
http://twistedmatrix.com/bugs .  If you can describe there how you 
installed Python that might give me a hint for solving it.  I haven't 
been able to reproduce this bug on any of my systems but you're the 
second person who has reported it.

---

As a temporary measure, installing Twisted without the Windows installer 
isn't terrible; get the source and follow the instructions here:
http://cvs.twistedmatrix.com/cvs/win32/README.win32?rev=1.5&content-type=text/vnd.viewcvs-markup

C


Matt Boersma wrote:

>Hello twisters:
>
>I've been developing a PB application on Debian Linux, and it
>has gone quite well.  But a coworker wants to test things on
>Windows.  <sigh>
>
>I've done nothing intentionally platform-specific, so I don't
>think there will be any problems here.  I went to install the
>1.0.7 binary release on my Win2K test box to verify this, but
>after nearly completing the install, it errors out with:
>
>Unable to execute file: ACK\pythonw.exe
>CreateProcess failed; code 2.
>The system cannot find the file specified
> 
>Where is it getting "ACK" from?  I have a standard binary
>install of python2.3 from www.python.org on Win2K SP3, and
>PYTHONHOME is set to "C:\Python2.3".
>
>Any clues would be much appreciated.
>
>Matt
>  
>





From maoy at cis.upenn.edu  Wed Sep 24 13:35:32 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 13:35:32 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <20030924054540.GB9443@frobozz>
Message-ID: <Pine.LNX.4.44.0309241334420.8799-100000@forty-thieves.cis.upenn.edu>

Is there any doc/example about producer/consumer? What is that streaming 
argument for?

Thanks.

-Y

On Wed, 24 Sep 2003, Andrew Bennetts wrote:

> On Wed, Sep 24, 2003 at 01:16:06AM -0400, Yun Mao wrote:
> > Is it true that the only way to see the success of write() is to check the 
> > FileDescriptor.dataBuffer? 
> 
> There's another way -- if a FileDescriptor is consumer of a producer, it
> will call the producer's pauseProducing when its buffer grows too large
> (look at the abstract.FileDescriptor.write source).
> 
> > I'm thinking that suppose there is one way to check this, and I can
> > somehow add a callback function to the success of each write(), then I can
> > simply call source.stopReading() after write() and startReading() when I
> > get callback.
> 
> You really don't want to do this manually -- you're just going to reinvent
> Twisted's producers/consumers infrastructure.  See my other reply.
> 
> -Andrew.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 





From matt at sprout.org  Wed Sep 24 13:37:42 2003
From: matt at sprout.org (Matt Boersma)
Date: Wed, 24 Sep 2003 11:37:42 -0600
Subject: [Twisted-Python] 1.0.7 Windows installer bug? Solved.
Message-ID: <20030924113742.A11168@sprout.org>

Thanks Cory.  I believe I've found the issue, and I filed it
with the issue tracker.

In the Windows python 2.3 installer, you can choose either an
"admin" or "non-admin" install, the stated difference being 
that the core python DLLs go either in %WINDIR%\System32 or
in the %PYTHONHOME% directory.  (I don't know if this is a
new option in Python 2.3--we jumped straight from 2.1 to 2.3.)
Another difference is apparently that the Python registry keys
go into the HKEY_CURRENT_USER hive instead of the HKLM one.
Creating the (Default) REG_SZ key for InstallPath in the
HKLM hive works around the problem.

Matt
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030924/f06a0b61/attachment.pgp 

From itamar at itamarst.org  Wed Sep 24 13:41:50 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 24 Sep 2003 13:41:50 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309241334420.8799-100000@forty-thieves.cis.upenn.edu>
References: <20030924054540.GB9443@frobozz>
	<Pine.LNX.4.44.0309241334420.8799-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030924134150.4320ce91.itamar@itamarst.org>

On Wed, 24 Sep 2003 13:35:32 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Is there any doc/example about producer/consumer? What is that
> streaming argument for?

Streaming means push, non-streaming means pull. The only real docs
available is 
http://itamarst.org/writings/OSCON03/twisted_internet-108.html

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From theller at python.net  Wed Sep 24 15:20:05 2003
From: theller at python.net (Thomas Heller)
Date: Wed, 24 Sep 2003 21:20:05 +0200
Subject: [Twisted-Python] Re: 1.0.7 Windows installer bug?
References: <20030924100842.A28206@sprout.org> <3F71CB57.2050402@yahoo.com>
Message-ID: <oexaf0yi.fsf@python.net>

Cory Dodt <corydodt at yahoo.com> writes:

> "ACK" is the emergency value I inserted in case it can't find the
> following registry key:
>
> HKLM\Software\Python\PythonCore\2.3\InstallPath\<default>
>
> Please open an issue in the tracker for this:
> http://twistedmatrix.com/bugs .  If you can describe there how you
> installed Python that might give me a hint for solving it.  I haven't
> been able to reproduce this bug on any of my systems but you're the
> second person who has reported it.

As Matt Boersma already discovered, a non-admin install doesn't write
*this* registry key. That's what you get for not using bdist_wininst
anymore to create the installer ;-) As the author, I'm interested why?

Thomas




From suneetha at sonic.net  Wed Sep 24 17:07:26 2003
From: suneetha at sonic.net (suneetha at sonic.net)
Date: Wed, 24 Sep 2003 14:07:26 -0700 (PDT)
Subject: [Twisted-Python] node with html content
Message-ID: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>

Hi,
   request.d.createTextNode(data) creates a text node and display the data
in the browser. I wanted to return a node in generate() method, that
display a web form instead of displaying the text. I created the node
with html content(string). Since I used createTextNode method, it is
displaying the html source instead of form. Is there any other method
that creates this kind of Node? If not how do I slove this?

Thank you,
Sunita.





From maoy at cis.upenn.edu  Wed Sep 24 17:20:16 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 17:20:16 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <20030924050701.GA9443@frobozz>
Message-ID: <Pine.LNX.4.44.0309240127270.20897-100000@forty-thieves.cis.upenn.edu>

OK. Here are some numbers:

First, I tried the bandwidth to download kernel from kernel.org: around 
150K/s reported from wget.

Then,

I wrote a little program to use twisted.protocols.socks:

application = Application("socks4 proxy")
application.listenTCP(1080, socks.SOCKSv4Factory("/tmp/socks.log"))

if '__main__' == __name__:
    application.run()

I start the program on my own machine, port 1080. 

After that I use a "sockify" program (tsocks) to use the "127.0.0.1:1080"  
proxy to download.  wget told me the speed is 4.10K/s Ideally, a proxy on 
localhost should bring almost 0 overhead, right? 

I also observe 100% cpu usage. A faster CPU may get better results. But,
still, what is going on here?

I modified socks.py and tried the producer idea, but it doesn't work.  
Maybe because the wrong usage?

Somebody can help me out? Thanks a lot!



> Twisted will merrily buffer as much data as necessary if the connection
> isn't ready for writing.  Unless you are talking about very large amounts of
> data, I doubt this would be a serious problem.  I'm guessing here though;
> real benchmarks are welcome :)
> 
> Still, if it is a problem -- or you're just sufficiently concerned to care
> about it anyway :) -- you could use producers and consumers to effectively
> throttle the upstream connection (the producer) when the downstream
> connection's (the consumer) buffers are full.  Probably something like
> twisted.protocols.pcp.ProducerConsumerProxy would help here.
> 
> -Andrew.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 

-- 
Yun Mao
Ph.D Student, University of Pennsylvania
http://www.cis.upenn.edu/~maoy/






From glyph at twistedmatrix.com  Wed Sep 24 17:34:26 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Sep 2003 17:34:26 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309240127270.20897-100000@forty-thieves.cis.upenn.edu>
References: <Pine.LNX.4.44.0309240127270.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <3F720DE2.1010104@twistedmatrix.com>

Yun Mao wrote:

> Somebody can help me out? Thanks a lot!

Wow!  These are some really bad numbers.  I don't know what to say 
except it looks like you're using things correctly.  Can you run this 
under the Python profiler and attach the output to an issue in the 
bugtracker?

The most likely answer is just that the SOCKS proxy has seen no 
optimization and is doing something silly like accidentally creating a 
huge number of string copies for no reason.




From stephen at thorne.id.au  Wed Sep 24 17:44:54 2003
From: stephen at thorne.id.au (Stephen Thorne)
Date: Thu, 25 Sep 2003 07:44:54 +1000
Subject: [Twisted-Python] node with html content
In-Reply-To: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>
References: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>
Message-ID: <3F721056.3080401@thorne.id.au>

suneetha at sonic.net wrote:

>Hi,
>   request.d.createTextNode(data) creates a text node and display the data
>in the browser. I wanted to return a node in generate() method, that
>display a web form instead of displaying the text. I created the node
>with html content(string). Since I used createTextNode method, it is
>displaying the html source instead of form. Is there any other method
>that creates this kind of Node? If not how do I slove this?
>  
>
Looking at twisted.web.woven.widgets.Text - if you want to return a node 
that contains 'Raw' text (i.e. text that doesn't need to be escaped - as 
in your case where you want to return form elements) you use

from twisted.web import domhelpers
textNode = domhelpers.RawText(data)
node.appendChild(textNode)

Does that answer your question.

I also highly recommend you have a good look at 'woven', and probably in 
your case specifically 'lmx'.

Regards,
Stephen Thorne






From stephen at thorne.id.au  Wed Sep 24 17:44:54 2003
From: stephen at thorne.id.au (Stephen Thorne)
Date: Thu, 25 Sep 2003 07:44:54 +1000
Subject: [Twisted-Python] node with html content
In-Reply-To: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>
References: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>
Message-ID: <3F721056.3080401@thorne.id.au>

suneetha at sonic.net wrote:

>Hi,
>   request.d.createTextNode(data) creates a text node and display the data
>in the browser. I wanted to return a node in generate() method, that
>display a web form instead of displaying the text. I created the node
>with html content(string). Since I used createTextNode method, it is
>displaying the html source instead of form. Is there any other method
>that creates this kind of Node? If not how do I slove this?
>  
>
Looking at twisted.web.woven.widgets.Text - if you want to return a node 
that contains 'Raw' text (i.e. text that doesn't need to be escaped - as 
in your case where you want to return form elements) you use

from twisted.web import domhelpers
textNode = domhelpers.RawText(data)
node.appendChild(textNode)

Does that answer your question.

I also highly recommend you have a good look at 'woven', and probably in 
your case specifically 'lmx'.

Regards,
Stephen Thorne






From maoy at cis.upenn.edu  Wed Sep 24 17:56:21 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 17:56:21 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <3F720DE2.1010104@twistedmatrix.com>
Message-ID: <Pine.LNX.4.44.0309241755170.10234-100000@forty-thieves.cis.upenn.edu>

I've put the profiling result to

http://www.twistedmatrix.com/users/roundup.twistd/twisted/file87/bugreport.txt

Forgot to mention the env: gentoo, python 2.2.3, twisted 1.0.7

Yun

On Wed, 24 Sep 2003, Glyph Lefkowitz wrote:

> 
> Wow!  These are some really bad numbers.  I don't know what to say 
> except it looks like you're using things correctly.  Can you run this 
> under the Python profiler and attach the output to an issue in the 
> bugtracker?
> 
> The most likely answer is just that the SOCKS proxy has seen no 
> optimization and is doing something silly like accidentally creating a 
> huge number of string copies for no reason.




From maoy at cis.upenn.edu  Wed Sep 24 17:59:28 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 17:59:28 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309241755170.10234-100000@forty-thieves.cis.upenn.edu>
Message-ID: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu>

It looks like the log function in line 141 is doing the silly thing. I 
disabled the log and it works fine now. :)

Yun

On Wed, 24 Sep 2003, Yun Mao wrote:

> 
> I've put the profiling result to
> 
> http://www.twistedmatrix.com/users/roundup.twistd/twisted/file87/bugreport.txt
> 
> Forgot to mention the env: gentoo, python 2.2.3, twisted 1.0.7
> 
> Yun




From bob at redivi.com  Wed Sep 24 18:30:06 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 24 Sep 2003 18:30:06 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu>
Message-ID: <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>

yay for profiling :)

oh wow that's definitely going to be slow:
             f.write(string.join(map(lambda x:'%02X'%ord(x),p),' ')+' ')

It's just that one line of code killing all your performance :)  That  
little loop could (probably) be done MUCH more efficiently by using  
something like:
map('%02X'.__mod__, struct.unpack('B' * len(data), data))

instead of doing it 16 at a time with lambda and ord.

Just out of curiosity, how does your performance and CPU utilization  
look now, without logging on?  I don't hear much about Twisted and  
performance.. Maybe it's not bad enough to complain about, or perhaps  
nobody has deployed twisted apps that see excessive load, but I haven't  
heard much either way.

-bob

On Wednesday, Sep 24, 2003, at 17:59 America/New_York, Yun Mao wrote:

> It looks like the log function in line 141 is doing the silly thing. I
> disabled the log and it works fine now. :)
>
> On Wed, 24 Sep 2003, Yun Mao wrote:
>
>>
>> I've put the profiling result to
>>
>> http://www.twistedmatrix.com/users/roundup.twistd/twisted/file87/ 
>> bugreport.txt
>>
>> Forgot to mention the env: gentoo, python 2.2.3, twisted 1.0.7




From maoy at cis.upenn.edu  Wed Sep 24 20:07:19 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 20:07:19 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
Message-ID: <Pine.LNX.4.44.0309242003280.10234-100000@forty-thieves.cis.upenn.edu>

On Wed, 24 Sep 2003, Bob Ippolito wrote:

> look now, without logging on?  I don't hear much about Twisted and  
> performance.. Maybe it's not bad enough to complain about, or perhaps  
> nobody has deployed twisted apps that see excessive load, but I haven't  
> heard much either way.
> 
> -bob
> 

The two download speed have no major difference now. The CPU load varies 
from 2% to 10% from me watching top.

You may here from performance report (or complain) from me in the near 
future. :)

-y





From itamar at itamarst.org  Wed Sep 24 20:11:11 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 24 Sep 2003 20:11:11 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
References: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu>
	<A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
Message-ID: <20030924201111.56a18d39.itamar@itamarst.org>

On Wed, 24 Sep 2003 18:30:06 -0400
Bob Ippolito <bob at redivi.com> wrote:

> look now, without logging on?  I don't hear much about Twisted and  
> performance.. Maybe it's not bad enough to complain about, or perhaps 
> 
> nobody has deployed twisted apps that see excessive load, but I
> haven't  heard much either way.

Strakt were having some performance issues when sending large amounts of
data, but JP's buffer() changes (went in in version 1.0.5? 6?) solved
them.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Thu Sep 25 00:10:56 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 25 Sep 2003 14:10:56 +1000
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
References: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu> <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
Message-ID: <20030925041056.GG13554@frobozz>

On Wed, Sep 24, 2003 at 06:30:06PM -0400, Bob Ippolito wrote:
> yay for profiling :)
> 
> oh wow that's definitely going to be slow:
>             f.write(string.join(map(lambda x:'%02X'%ord(x),p),' ')+' ')
> 
> It's just that one line of code killing all your performance :)  That  
> little loop could (probably) be done MUCH more efficiently by using  
> something like:
> map('%02X'.__mod__, struct.unpack('B' * len(data), data))
> 
> instead of doing it 16 at a time with lambda and ord.

Probably just "data.encode('hex')" would be fine?

-Andrew.




From exarkun at intarweb.us  Thu Sep 25 00:46:16 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 25 Sep 2003 00:46:16 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <20030925041056.GG13554@frobozz>
References: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu> <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com> <20030925041056.GG13554@frobozz>
Message-ID: <20030925044616.GA20253@intarweb.us>

On Thu, Sep 25, 2003 at 02:10:56PM +1000, Andrew Bennetts wrote:
> On Wed, Sep 24, 2003 at 06:30:06PM -0400, Bob Ippolito wrote:
> > yay for profiling :)
> > 
> > oh wow that's definitely going to be slow:
> >             f.write(string.join(map(lambda x:'%02X'%ord(x),p),' ')+' ')
> > 
> > It's just that one line of code killing all your performance :)  That  
> > little loop could (probably) be done MUCH more efficiently by using  
> > something like:
> > map('%02X'.__mod__, struct.unpack('B' * len(data), data))
> > 
> > instead of doing it 16 at a time with lambda and ord.
> 
> Probably just "data.encode('hex')" would be fine?
> 

  Especially since str.__mod__ is a pretty recent development (ie, not in
2.2).

  Or one could ask why exactly the data needs to be hex encoded at all...

  Jp

-- 
"Pascal is Pascal is Pascal is dog meat."
                -- M. Devine and P. Larson, Computer Science 340
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030925/885d5bcb/attachment.pgp 

From miguel at yorku.ca  Thu Sep 25 12:06:07 2003
From: miguel at yorku.ca (Miguel Marques)
Date: Thu, 25 Sep 2003 12:06:07 -0400 (EDT)
Subject: [Twisted-Python] twisted.python.log usage...
Message-ID: <20030925.120607.85406867.miguel@yorku.ca>

Greetings...

I've just started using twisted and I have a question about logging.
I have a server which uses twisted.python.log.  I open a file and then
call log.startLogging with it.  I then start a number of worker threads and
then instantiate an Application and run it.   All log.msg from the
main program have the server name I passed when I instantiaed the Application.
When I call log.msg from the threads the name is just [-].
I know I can call msg with system='servername' everytime but I thought
that I could have the lass that implements the running worker threads
inherit from Logger and override logPrefix but that doesn't seem to work.
I obviously (or so I think) need to insert system='servername' in the ILogContext
for each of my threads but it isn't all that clear to me how to do that.
I'm confused (and I don't even have an opulent toilet ;-) )
TIA for any help...

							Miguel

C. Miguel Marques, Development Services, Computing and Network Services, York University
e-mail: miguel at yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830



From tim.stebbing at nunatak.com.au  Thu Sep 25 18:15:40 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri, 26 Sep 2003 08:15:40 +1000 (EST)
Subject: [Twisted-Python] a little pattern prototype ?
Message-ID: <33046.144.139.77.34.1064528140.squirrel@www.deepdesign.com.au>

This is just a very basic and incomplete prototype of a framework/pattern
based on twisted.web.resource. Id be interested in peoples comments on
the concept as a whole.

Okay, The idea is that you create many components 'facets' which return
a particular chunk of html that will be displayed inside an absolutly
positioned <div>. These facets will be able to communicate with each other
via the concept of 'broadcasters' and 'observers'. What this means is that
a facet can register its wish to be notified of a particular event, or a
facet can broadcast an event to all other facets.

Facets are combined into single html pages (prisms), which will manage
placing facet content in divs. A single facet can appear on mny prisms.

A special type of facet that Im yet to implement is called the 'request
facet'. This will have no render output, but will manage post, get values
by broadcasting them to other facets. This could also handle any events,
ie livePage.

This might be a stupid idea, thats why Im posting it now while Im
prototyping it so I can get suggestions/flames. Its just something that
I thought up at work the other day and thought might be interesting to try.

-tjs

See attached tarball.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: crystals.tgz
Type: application/x-gzip
Size: 4451 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030926/5605116c/attachment.bin 

From glyph at twistedmatrix.com  Thu Sep 25 19:40:12 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 25 Sep 2003 19:40:12 -0400
Subject: [Twisted-Python] a little pattern prototype ?
In-Reply-To: <33046.144.139.77.34.1064528140.squirrel@www.deepdesign.com.au>
References: <33046.144.139.77.34.1064528140.squirrel@www.deepdesign.com.au>
Message-ID: <3F737CDC.70905@twistedmatrix.com>

Timothy Stebbing wrote:

> Facets are combined into single html pages (prisms), which will manage
> placing facet content in divs. A single facet can appear on mny prisms.

Tim,

When I suggested "prism" as a metaphor, it was seriously the first word 
that came into my mind, and I intended it as a joke.  However, the 
pattern you've described sounds both elegant and accurately described by 
this metaphor.  I was laughing the whole time I read it :).

I don't entirely understand what you've done, but I have two quick thoughts:

	- Have you considered using Woven?  Event-broadcasting and updating 
facets in real time could be achieved with LivePage.  Also, since your 
output is HTML, woven could help with encapsulating the divs separately 
while guaranteeing that generation errors on one area of the page will 
not affect another.

	- What are your use cases?  e.g. what kind of a site benefits from 
using Crystals, and what doesn't?




From tim.stebbing at nunatak.com.au  Thu Sep 25 20:05:17 2003
From: tim.stebbing at nunatak.com.au (Tim Stebbing)
Date: Fri, 26 Sep 2003 10:05:17 +1000
Subject: [Twisted-Python] a little pattern prototype ?
In-Reply-To: <3F737CDC.70905@twistedmatrix.com>
References: <33046.144.139.77.34.1064528140.squirrel@www.deepdesign.com.au> <3F737CDC.70905@twistedmatrix.com>
Message-ID: <3F7382BD.4030602@nunatak.com.au>

Glyph Lefkowitz wrote:
> Timothy Stebbing wrote:
> 
>> Facets are combined into single html pages (prisms), which will manage
>> placing facet content in divs. A single facet can appear on mny prisms.
> 
> 
> Tim,
> 
> When I suggested "prism" as a metaphor, it was seriously the first word 
> that came into my mind, and I intended it as a joke.  However, the 
> pattern you've described sounds both elegant and accurately described by 
> this metaphor.  I was laughing the whole time I read it :).
> 
> I don't entirely understand what you've done, but I have two quick 
> thoughts:
> 
>     - Have you considered using Woven?  Event-broadcasting and updating 
> facets in real time could be achieved with LivePage.  Also, since your 
> output is HTML, woven could help with encapsulating the divs separately 
> while guaranteeing that generation errors on one area of the page will 
> not affect another.
>

The initial prototype I posted only took a few hours because I used 
resources rather than woven (which is great but is more time-consuming 
when I just wanted to get html on the screen to test an idea)

If people are interested in this pattern I would definitely write it 
either on top of, or extending woven.

>     - What are your use cases?  e.g. what kind of a site benefits from 
> using Crystals, and what doesn't?

It had no use-cases when I started, I just wanted to test an idea.

However, I could see the 'crystals' pattern being of major benefit in a 
site that is highly modular, such as a groupware application/portal 
where individual modules are often written totally separately and turned 
on/off with user prefs.

The site could have an API of broadcasters/observers, its own internal 
event system or whatever (a broadcasting reactor?). A module developer 
would only need to write a few facets and perhaps a prism to access the 
sites events and to get their info on the screen, in whatever way the 
site wants modules to be displayed.

-tjs





From typo at soniq.net  Fri Sep 26 04:56:07 2003
From: typo at soniq.net (Paul Boehm)
Date: Fri, 26 Sep 2003 10:56:07 +0200
Subject: [Twisted-Python] twisted.python.log usage...
In-Reply-To: <20030925.120607.85406867.miguel@yorku.ca>
References: <20030925.120607.85406867.miguel@yorku.ca>
Message-ID: <20030926085607.GD23023@soniq.net>

On Thu, Sep 25, 2003 at 12:06:07PM -0400, Miguel Marques wrote:
> I know I can call msg with system='servername' everytime but I thought
> that I could have the lass that implements the running worker threads
> inherit from Logger and override logPrefix but that doesn't seem to work.
> I obviously (or so I think) need to insert system='servername' in the ILogContext
> for each of my threads but it isn't all that clear to me how to do that.
> I'm confused (and I don't even have an opulent toilet ;-) )
> TIA for any help...

the way i presume it is supposed to be done, is to use
log.callWithLogger(), which automagically sets up a new context, until
the called method returns.

but logging contexts are at best sparingly used within twisted itself,
and i think the concept either needs rethinking, or at least should be
_used_ in twisted mainline, where it makes sense.

imho Protocols should be their own Loggers by default, because right now
the msg's i write from a protocol appear with the factory's context,
which can be confusing and misleading.

also i think it's a problem with logging, that protocols/factories by
default are not very verbose when a new client has connected.. (has
anything changed since i last looked? do they log anything at all?)

  paul



From typo at soniq.net  Fri Sep 26 04:56:22 2003
From: typo at soniq.net (Paul Boehm)
Date: Fri, 26 Sep 2003 10:56:22 +0200
Subject: [Twisted-Python] please remove sibling,parents etc. from plugins.tml
Message-ID: <20030926085622.GE23023@soniq.net>

they're still in plugins.tml in cvs



From alienoid at is.lg.ua  Fri Sep 26 10:08:58 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Fri, 26 Sep 2003 17:08:58 +0300
Subject: [Twisted-Python] adbapi question
Message-ID: <3F74487A.8030309@is.lg.ua>

Hello.


from twisted.enterprise import adbapi
from twisted.internet import reactor
from twisted.spread import pb

DB_HOST = "localhost"
DB_USER = "root"
DB_PASSWD = "xxx"
DB_NAME = "account"

class DBException(pb.Error): pass

dbpool = adbapi.ConnectionPool("MySQLdb", host=DB_HOST, user=DB_USER, 
passwd=DB_PASSWD, db=DB_NAME)

# Database checking
def getClientsDBParams(username):
     _sql = """
     SELECT username, password, ip, netmask, mac FROM bunkernet_clients
         WHERE username='%s'
     """ % username
     return dbpool.runQuery(_sql)

def dbClientSucceeded(self, l):
     if l:
         print l
     else:
         print "no records"
         raise DBException("No records")


def dbClientFailed():
     print "Failed!"
     reactor.stop()

getClientsDBParams('alienoid').addCallbacks(dbClientSucceeded, 
dbClientFailed)
reactor.run()


The problem here is that when dbClientSucceeded is executed and i get 
"no records" - i don't get exception. Only when i press Ctrl + C on 
server i get those DBException. This code will be executed when remote 
client connects to server and i want those DBException be passed to 
remote client but i can't get it, can get it only with Ctrl + C

Your help is very appreciated.
Thanks in advance.

Best regards,
Ruslan




From exarkun at intarweb.us  Fri Sep 26 10:41:28 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 26 Sep 2003 10:41:28 -0400
Subject: [Twisted-Python] adbapi question
In-Reply-To: <3F74487A.8030309@is.lg.ua>
References: <3F74487A.8030309@is.lg.ua>
Message-ID: <20030926144128.GA3751@intarweb.us>

On Fri, Sep 26, 2003 at 05:08:58PM +0300, Ruslan Spivak wrote:
> [snip]
> 
> 
> def dbClientFailed():
>     print "Failed!"
>     reactor.stop()
> 
> getClientsDBParams('alienoid').addCallbacks(dbClientSucceeded, 
> dbClientFailed)
> reactor.run()
> 
> 
> The problem here is that when dbClientSucceeded is executed and i get 
> "no records" - i don't get exception. Only when i press Ctrl + C on 
> server i get those DBException. This code will be executed when remote 
> client connects to server and i want those DBException be passed to 
> remote client but i can't get it, can get it only with Ctrl + C
> 
> Your help is very appreciated.
> Thanks in advance.

  Errbacks receive a single argument, the failure that caused them to be
caused.  Unfortunately, if you define your errback to take no arguments (as
you have), that error becomes a failure, which would pass on to the next
errback if it were registered, or, as in your code, would be silenced if
there are no more errbacks.

  Redefine dbClientFailed to take an argument and you should see the
behavior you expect.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030926/231548a7/attachment.pgp 

From golux at comcast.net  Thu Sep 25 22:55:01 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Thu, 25 Sep 2003 22:55:01 -0400
Subject: [Twisted-Python] twisted.news adbapi backend
Message-ID: <3F73AA85.3090004@comcast.net>

I'm guessing this has never been used (at least with
pyPgSQL, anyway), since it has a function listRequest
defined thusly:

def listRequest(self):
         # COALESCE may not be totally portable
         # it is shorthand for
         # CASE WHEN (first parameter) IS NOT NULL then (first 
parameter) ELSE (second parameter) END
         sql = """
             SELECT groups.name,
                 COALESCE(MAX(postings.article_index), 0),
                 COALESCE(MIN(postings.article_index), 0),
                 groups.flags
             FROM groups LEFT OUTER JOIN postings
             ON postings.group_id = groups.group_id
             GROUP BY groups.name, groups.flags
             ORDER BY groups.name
         """
         return self.runQuery(sql)

... but PostgreSQL doesn't implement a COALESCE command.

And my next guess would be that it's never been tested,
either.  Correct?

If so, maybe it should be either be fixed or jettisoned,
or at least relegated to the sandbox.

- Steve.




From exarkun at intarweb.us  Fri Sep 26 19:10:09 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 26 Sep 2003 19:10:09 -0400
Subject: [Twisted-Python] twisted.news adbapi backend
In-Reply-To: <3F73AA85.3090004@comcast.net>
References: <3F73AA85.3090004@comcast.net>
Message-ID: <20030926231009.GA4416@intarweb.us>

On Thu, Sep 25, 2003 at 10:55:01PM -0400, Stephen C. Waterbury wrote:
> I'm guessing this has never been used (at least with
> pyPgSQL, anyway), since it has a function listRequest
> defined thusly:

> 
> [snip]
> 
> ... but PostgreSQL doesn't implement a COALESCE command.
> 

  Indeed.  I developed it while I was still using MySQL.

  I was surprised to read that PostgreSQL doesn't implement COALESCE, so I
checked the docs.  They claim it has been supported since 6.5.  Are you
running an expecially old version? :)

> 
> And my next guess would be that it's never been tested,
> either.  Correct?

  Probably not.  I certainly haven't, and the unit test coverage for this
backend is non-existent.  I was tempted to remove it a long time ago, but
decided to leave it in in case anyone wanted to build on top of it.

  It's probably not great database code.  Deprecating it now and removing it
in a while sounds like a good idea.

  Jp

-- 
Python/C/Linux/Smalltalk/Java
Genetic Algorithms, Genetic Programming, Neural Networks
Networking, asynchronous applications, legacy maintenance
See my complete resume at http://intarweb.us:8080/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030926/3527c810/attachment.pgp 

From golux at comcast.net  Fri Sep 26 09:36:46 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Fri, 26 Sep 2003 09:36:46 -0400
Subject: [Twisted-Python] adbapi transaction stuff (was Re: twisted.news adbapi backend)
In-Reply-To: <20030926231009.GA4416@intarweb.us>
References: <3F73AA85.3090004@comcast.net> <20030926231009.GA4416@intarweb.us>
Message-ID: <3F7440EE.3020209@comcast.net>

Hi Jp,

Jp Calderone wrote:
> On Thu, Sep 25, 2003 at 10:55:01PM -0400, Stephen C. Waterbury wrote:

>>... but PostgreSQL doesn't implement a COALESCE command.
>>
>   I was surprised to read that PostgreSQL doesn't implement COALESCE, so I
> checked the docs.  They claim it has been supported since 6.5.  Are you
> running an expecially old version? :)

Hm ... you mean I should actually check to see if it works
before assuming it's not there?  Doh!  I was going by the
fact that the psql \h didn't have anything on it, but
you're absolutely right -- it's there and works as
advertised.  (I guess \h only documents the big, top-level
commands -- not functions/expressions.)

>   It's probably not great database code.  Deprecating it now and removing it
> in a while sounds like a good idea.

I don't think it looks bad, really ... just seemed like
it had never been used.

Actually, the only reason I was looking at it was that it
was the only example I could find of code that used the adbapi
runInteraction() and transaction stuff, so it looked like
it might be useful to me at first, but I couldn't figure
out how to get a Transaction to do a "SET CONSTRAINTS
ALL DEFERRED", which I need for my transactions.
(I did it in the transaction.execute(), but it didn't
seem to have any effect, so I wasn't sure if it really
applied ... I assume they are supposed to, for a
given runInteraction scope, right?)

Anyway, I went ahead and made a "transaction builder" that
puts together a whole SQL transaction statement that I can
give to runOperation, and that seems to work just fine --
which might actually be easier and faster anyway, since it
lets PostgreSQL do its own optimization things, etc.

Still, the adbapi transaction stuff is intriguing,
so let me know if I'm missing something there -- e.g.,
if you know how to use it to do an SQL transaction with
deferred constraints.  What I was hoping it did was
incrementally execute stuff and just commit when the
runInteraction call ended.

Cheers,
Steve.




From fog at initd.org  Sat Sep 27 06:07:15 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Sat, 27 Sep 2003 12:07:15 +0200
Subject: [Twisted-Python] adbapi transaction stuff (was Re:
	twisted.news adbapi backend)
In-Reply-To: <3F7440EE.3020209@comcast.net>
References: <3F73AA85.3090004@comcast.net>
	 <20030926231009.GA4416@intarweb.us>  <3F7440EE.3020209@comcast.net>
Message-ID: <1064657235.6280.2.camel@localhost>

Il ven, 2003-09-26 alle 15:36, Stephen C. Waterbury ha scritto:
[snip]
> Anyway, I went ahead and made a "transaction builder" that
> puts together a whole SQL transaction statement that I can
> give to runOperation, and that seems to work just fine --
> which might actually be easier and faster anyway, since it
> lets PostgreSQL do its own optimization things, etc.

you may be interested in

    http://cvs.initd.org/cgi-bin/viewcvs.cgi/wabba/

glade binding of data coming from a database:

    http://cvs.initd.org/cgi-bin/viewcvs.cgi/pox/

and an example of usage:

     http://cvs.initd.org/cgi-bin/viewcvs.cgi/wilma/

(official release in the near future...)

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
  Gli avvoltoi cinesi si nutrono di arte, ma possono anche mangiare
   i `domani'.                                        -- Haruki Murakami
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio =?ISO-8859-1?Q?=E8?= firmata
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030927/e9857f14/attachment.pgp 

From foom at fuhm.net  Sat Sep 27 13:23:13 2003
From: foom at fuhm.net (James Y Knight)
Date: Sat, 27 Sep 2003 13:23:13 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] crud
In-Reply-To: <E1A3GL0-0006VH-00@wolfwood>
Message-ID: <460D361C-F10F-11D7-B097-000A95A50FB2@fuhm.net>

On Saturday, September 27, 2003, at 10:46 AM, exarkun CVS wrote:
> ViewCVS links:
> http://twistedmatrix.com/users/jh.twistd/viewcvs/cgi/viewcvs.cgi/ 
> sandbox/exarkun/ 
> crud.py.diff?r1=text&tr1=1.1&r2=text&tr2=1.2&cvsroot=Twisted

None of the links in the cvs commit mails work, probably as they don't  
point to cvs.twistedmatrix.org.

James




From paul at soniq.net  Sat Sep 27 18:17:00 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 00:17:00 +0200
Subject: [Twisted-Python] clean up app.getApplication
Message-ID: <20030927221700.GA1541@soniq.net>

i was doing something else, couldn't quite understand the code at first
(where does the listcomp begin, where does it end?), so here's a more
explicit version:

Index: app.py
===================================================================
RCS file: /cvs/Twisted/twisted/application/app.py,v
retrieving revision 1.3
diff -u -r1.3 app.py
--- app.py  21 Sep 2003 01:07:23 -0000  1.3
+++ app.py  27 Sep 2003 22:16:16 -0000
@@ -81,9 +81,14 @@
         return None
 
 def getApplication(config, passphrase):
-    s = [(config[t], t)
-           for t in ['python', 'xml', 'source', 'file'] if config[t]][0]
-    filename, style = s[0], {'file':'pickle'}.get(s[1],s[1])
+    for t in ['python', 'xml', 'source', 'file', 'tapdir', None]:
+        style = t
+        filename = config[style]
+        if filename:
+            break
+    if style == 'file':
+        style = 'pickle'
+
     try:
         log.msg("Loading %s..." % filename)
         application = service.loadApplication(filename, style, passphrase)




From exarkun at intarweb.us  Sat Sep 27 18:37:23 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 27 Sep 2003 18:37:23 -0400
Subject: [Twisted-Python] clean up app.getApplication
In-Reply-To: <20030927221700.GA1541@soniq.net>
References: <20030927221700.GA1541@soniq.net>
Message-ID: <20030927223723.GA17517@intarweb.us>

On Sun, Sep 28, 2003 at 12:17:00AM +0200, Paul Boehm wrote:
> i was doing something else, couldn't quite understand the code at first
> (where does the listcomp begin, where does it end?), so here's a more
> explicit version:

  That original version was pretty icky, yea.

  Thangs for posting this here (though someone may tell you it belongs on
the bug tracker at http://www.twistedmatrix.com/bugs/, which it probably
does), because it reminded me of something we should be able to get rid of
now.

  "python" style is indicated by the string "python".
  "xml" style is indicated by the string "xml".
  "source" style is indicated by the string "source".
  "pickle" style is indicated by the string "file".

  Now, let's play a game that everyone who's watched Seasame Street should
know -- Which of these things is not like the others?

  Is there any reason *not* to fix this now?

  Jp

> [snip]
> +    for t in ['python', 'xml', 'source', 'file', 'tapdir', None]:
> +        style = t
> +        filename = config[style]
> +        if filename:
> +            break
> +    if style == 'file':
> +        style = 'pickle'
> +
> [snip]

-- 
Examinations are formidable even to the best prepared, for
even the greatest fool may ask more than the wisest man can answer.
                -- C.C. Colton
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030927/7ff0a1f1/attachment.pgp 

From paul at soniq.net  Sat Sep 27 18:58:04 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 00:58:04 +0200
Subject: modularize strport parsers Re: [Twisted-Python] clean up app.getApplication
In-Reply-To: <20030927223723.GA17517@intarweb.us>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us>
Message-ID: <20030927225804.GA1671@soniq.net>

On Sat, Sep 27, 2003 at 06:37:23PM -0400, Jp Calderone wrote:
>   Thangs for posting this here (though someone may tell you it belongs on
> the bug tracker at http://www.twistedmatrix.com/bugs/, which it probably
> does)

ugh.. using webinterfaces without a mouse is horror.. so i'll do it
again and submit another patch here:

Index: strports.py
===================================================================
RCS file: /cvs/Twisted/twisted/application/strports.py,v
retrieving revision 1.1
diff -u -r1.1 strports.py
--- strports.py 26 Sep 2003 22:44:48 -0000  1.1
+++ strports.py 27 Sep 2003 22:56:19 -0000
@@ -46,12 +46,21 @@
 """
 from __future__ import generators
 
+_types = {}
+
+def registerType(name, helper):
+    global _types
+    _types[name] = helper
+    print _types
+
 def _parseTCP(factory, port, interface="", backlog=5):
     return (int(port), factory), {'interface': interface,
                                   'backlog': int(backlog)}
+registerType("tcp", _parseTCP)
 
 def _parseUNIX(factory, address, mode='666', backlog=5):
     return (address, factory), {'mode': int(mode, 8), 'backlog': int(backlog)}
+registerType("unix", _parseUNIX)
 
 def _parseSSL(factory, port, privateKey="server.pem", certKey=None,
               sslmethod=None, interface='', backlog=5):
@@ -64,10 +73,7 @@
     cf = ssl.DefaultOpenSSLContextFactory(privateKey, certKey, **kw)
     return ((int(port), factory, cf),
             {'interface': interface, 'backlog': int(backlog)})
-
-_funcs = {"tcp": _parseTCP,
-          "unix": _parseUNIX,
-          "ssl": _parseSSL}
+registerType("ssl", _parseSSL)
 
 _OP, _STRING = range(2)
 def _tokenize(description):
@@ -149,7 +155,7 @@
     args, kw = _parse(description)
     if not args or (len(args)==1 and not kw):
         args[0:0] = [default or 'tcp']
-    return (args[0].upper(),)+_funcs[args[0]](factory, *args[1:], **kw)
+    return (args[0].upper(),)+_types[args[0]](factory, *args[1:], **kw)
 
 def service(description, factory, default=None):
     """Return the service corresponding to a description




From mertz at gnosis.cx  Fri Sep 26 21:50:08 2003
From: mertz at gnosis.cx (David Mertz)
Date: Fri, 26 Sep 2003 21:50:08 -0400
Subject: [Twisted-Python] Book on Twisted?
Message-ID: <QzOd/kKkXEzQ092yn@gnosis.cx>                       

Twisties:

I reckon most of you saw my series of articles on Twisted over at IBM
developerWorks.  Heck, a small thread on this list even criticized some
of my examples :-).

Anyway, in response to my articles, a publisher approached me; and
basically asked me to write a book on Twisted for them (the note was a
little less straightforward than this, but that's the jist).

FWIW, I do not want to write a book on Twisted--at least not by myself.
However, I -do- think that having a good book--one that was helpful and
approachable to beginners--would be really nice to have on my shelf.  So
the idea picques my interst somewhat.

There are several things readers of this missive might do with the
information.  If someone else just has the notion of writing a book
themselves, I am very happy to put you in touch with my publishing
contact.  I cannot state one way or another whether this would be the
best publisher for such a book, but at least there's an incling of
interst there.  On the other hand, if someone is kinda intersted in
writing a book but unsure about the writing process, I might be
interested or willing to have a role in such a process.  Maybe
contributing author, active editor, tech reviewer, or something else;
obviously, if I have a role, I'll have an interest, but I don't know
what the details might be.

Yours, David...

--
Keeping medicines from the bloodstreams of the sick; food from the bellies
of the hungry; books from the hands of the uneducated; technology from the
underdeveloped; and putting advocates of freedom in prisons.  Intellectual
property is to the 21st century what the slave trade was to the 16th.



From paul at soniq.net  Sat Sep 27 22:58:00 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 04:58:00 +0200
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches to strport parsers
In-Reply-To: <20030927225804.GA1671@soniq.net>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us> <20030927225804.GA1671@soniq.net>
Message-ID: <20030928025800.GA9204@soniq.net>

On Sun, Sep 28, 2003 at 12:58:04AM +0200, Paul Boehm wrote:
> ugh.. using webinterfaces without a mouse is horror.. so i'll do it
> again and submit another patch here:

i've updated the patch (see end of mail)
all trial tests pass
sample code why i need the patch included

also, i want to ask the list if everyone is okay with me getting cvs access
to create and maintain twisted.proxy, a generic proxy, currently capable of
transparent proxying using netfilter, pseudotransparent proxying using a
shared lib (seperate c code required), and web.proxy, which i'll update or
rewrite soon.

and a rfc:
in the sample code below, i find the way i handle listening in a service
instead of the application, a lot more natural. 

if i stopService() at runtime, i expect the ports of that service to go down
at the same time. 

anything speaking against implementing the neccesary code in application.Service?
my expectation is that after the app refactor, noone will want to listen
directly in application anymore, so we could even start deprecating the old
interface.

sample code / usecase:
-----------------------------------
# twisted imports
from twisted.application import strports
from twisted.application.service import Service

# sibling imports
from proxy.interfaces import *
from proxy import adapters

flavors = {
         'any': IProxyFactory, # a proxy, any proxy!
         'transparent': ITransProxyFactory, # a transparent proxy
         'http': IHTTPProxyFactory, # a proxy speaking HTTP
        }

def parsePROXY(type, service, port, subproto="any", transport="tcp"):
    adapter = flavors[subproto]
    return(transport.upper(), (int(port), adapter(service)), {})

strports.registerTransport("proxy", parsePROXY)

class ProxyService(Service):
    """I am a service that starts proxies, and stores shared policy for them."""

    __implements__ = IProxyService

    def __init__(self, name, parent, *portspecs):
        self.portstrs = []
        self.listeners = []

        self.setName(name)
        self.setServiceParent(parent)

        for pspec in portspecs:
            self.listen(pspec)

    def listen(self, description):
        self.portstrs.append(description)

    def doListen(self, description):
        transport = strports.listen(description, self)
        self.listeners.append(transport)

    def startService(self):
        Service.startService(self)
        for description in self.portstrs:
            self.doListen(description)

    def stopService(self):
        Service.stopService(self)
        for port in self.listeners:
            port.loseConnection()
            self.listeners.remove(port)
-----------------------------------
patch:

Index: strports.py
===================================================================
RCS file: /cvs/Twisted/twisted/application/strports.py,v
retrieving revision 1.1
diff -u -r1.1 strports.py
--- strports.py 26 Sep 2003 22:44:48 -0000  1.1
+++ strports.py 28 Sep 2003 02:50:51 -0000
@@ -46,14 +46,22 @@
 """
 from __future__ import generators
 
-def _parseTCP(factory, port, interface="", backlog=5):
-    return (int(port), factory), {'interface': interface,
+_transportHelpers = {}
+
+def registerTransport(name, helper):
+    global _transportHelpers
+    _transportHelpers[name] = helper
+
+def _parseTCP(type, factory, port, interface="", backlog=5):
+    return type, (int(port), factory), {'interface': interface,
                                   'backlog': int(backlog)}
+registerTransport("tcp", _parseTCP)
 
-def _parseUNIX(factory, address, mode='666', backlog=5):
-    return (address, factory), {'mode': int(mode, 8), 'backlog': int(backlog)}
+def _parseUNIX(type, factory, address, mode='666', backlog=5):
+    return type, (address, factory), {'mode': int(mode, 8), 'backlog': int(backlog)}
+registerTransport("unix", _parseUNIX)
 
-def _parseSSL(factory, port, privateKey="server.pem", certKey=None,
+def _parseSSL(type, factory, port, privateKey="server.pem", certKey=None,
               sslmethod=None, interface='', backlog=5):
     from twisted.internet import ssl
     if certKey is None:
@@ -62,12 +70,9 @@
     if sslmethod is not None:
         kw['sslmethod'] = getattr(ssl.SSL, sslmethod)
     cf = ssl.DefaultOpenSSLContextFactory(privateKey, certKey, **kw)
-    return ((int(port), factory, cf),
+    return (type, (int(port), factory, cf),
             {'interface': interface, 'backlog': int(backlog)})
-
-_funcs = {"tcp": _parseTCP,
-          "unix": _parseUNIX,
-          "ssl": _parseSSL}
+registerTransport("ssl", _parseSSL)
 
 _OP, _STRING = range(2)
 def _tokenize(description):
@@ -104,7 +109,7 @@
     add(sofar)
     return args, kw 
 
-def parse(description, factory, default=None):
+def parse(description, factory, default='tcp'):
     """Parse a description of a reliable virtual circuit server
 
     @type description: C{str}
@@ -148,8 +153,10 @@
     """
     args, kw = _parse(description)
     if not args or (len(args)==1 and not kw):
-        args[0:0] = [default or 'tcp']
-    return (args[0].upper(),)+_funcs[args[0]](factory, *args[1:], **kw)
+        type = default
+    else:
+        type = args.pop(0)
+    return _transportHelpers[type](type.upper(), factory, *args, **kw)
 
 def service(description, factory, default=None):
     """Return the service corresponding to a description
@@ -185,4 +192,4 @@
     name, args, kw = parse(description, factory, default)
     return getattr(reactor, 'listen'+name)(*args, **kw)
 
-__all__ = ['parse', 'service', 'listen']
+__all__ = ['registerTransport', 'parse', 'service', 'listen']




From shawn at zetet.com  Sat Sep 27 23:10:22 2003
From: shawn at zetet.com (Shawn O'Connor)
Date: Sat, 27 Sep 2003 20:10:22 -0700
Subject: [Twisted-Python] from Scratch: Evolution of Finger (Moshe's Haifux talk)
Message-ID: <20030928031022.16895.qmail@mail.metastructure.net>

I've put a prospective howto version of Moshe's Haifux talk,
Twisted from Scratch: Evolution of Finger online at
http://zetet.com/twisted/finger 

Most of the code has been cleaned up, though I still
haven't tested SSL or the last few configuration examples. 

After any comments, suggestions, and another pass, I'll
submit the diffs for jml's version at
http://cvs.twistedmatrix.com/cvs/sandbox/jml/haifux-howto/
There is also an earlier version at
http://twistedmatrix.com/~moshez/haifux.html 


shawn  @
zetet  .  com 




From andrew-twisted at puzzling.org  Sat Sep 27 23:19:28 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 28 Sep 2003 13:19:28 +1000
Subject: [Twisted-Python] from Scratch: Evolution of Finger (Moshe's Haifux talk)
In-Reply-To: <20030928031022.16895.qmail@mail.metastructure.net>
References: <20030928031022.16895.qmail@mail.metastructure.net>
Message-ID: <20030928031928.GC21156@frobozz>

On Sat, Sep 27, 2003 at 08:10:22PM -0700, Shawn O'Connor wrote:
> 
> I've put a prospective howto version of Moshe's Haifux talk,
> Twisted from Scratch: Evolution of Finger online at
> http://zetet.com/twisted/finger 

Where can I find the the Lore source that generated that page?

-Andrew.




From paul at soniq.net  Sat Sep 27 23:24:26 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 05:24:26 +0200
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches to strport parsers
In-Reply-To: <20030928025800.GA9204@soniq.net>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us> <20030927225804.GA1671@soniq.net> <20030928025800.GA9204@soniq.net>
Message-ID: <20030928032426.GA10143@soniq.net>

On Sun, Sep 28, 2003 at 04:58:00AM +0200, Paul Boehm wrote:
> anything speaking against implementing the neccesary code in application.Service?
> my expectation is that after the app refactor, noone will want to listen
> directly in application anymore, so we could even start deprecating the old
> interface.

itamar already pointed out to me that service() does exactly what i
want. thanks!

  paul



From itamar at itamarst.org  Sat Sep 27 23:37:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 27 Sep 2003 23:37:51 -0400
Subject: [Twisted-Python] from Scratch: Evolution of Finger (Moshe's
 Haifux talk)
In-Reply-To: <20030928031022.16895.qmail@mail.metastructure.net>
References: <20030928031022.16895.qmail@mail.metastructure.net>
Message-ID: <20030927233751.36a3cc43.itamar@itamarst.org>

On Sat, 27 Sep 2003 20:10:22 -0700
"Shawn O'Connor" <shawn at zetet.com> wrote:

> After any comments, suggestions, and another pass, I'll
> submit the diffs for jml's version at
> http://cvs.twistedmatrix.com/cvs/sandbox/jml/haifux-howto/
> There is also an earlier version at
> http://twistedmatrix.com/~moshez/haifux.html 

Cool! It'd be great to have this for the next release.

One (major) issue - it covers old PB and application APIs. This is also
true of docs in CVS which we are in the process of updating :( Check out
the new pb examples in CVS and the plugins howto in CVS for examples of
the new API.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Sat Sep 27 23:41:10 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 27 Sep 2003 23:41:10 -0400
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches
 to strport parsers
In-Reply-To: <20030928025800.GA9204@soniq.net>
References: <20030927221700.GA1541@soniq.net>
	<20030927223723.GA17517@intarweb.us>
	<20030927225804.GA1671@soniq.net>
	<20030928025800.GA9204@soniq.net>
Message-ID: <20030927234110.7c04a220.itamar@itamarst.org>

On Sun, 28 Sep 2003 04:58:00 +0200
Paul Boehm <paul at soniq.net> wrote:

> also, i want to ask the list if everyone is okay with me getting cvs
> access to create and maintain twisted.proxy, a generic proxy,
> currently capable of transparent proxying using netfilter,
> pseudotransparent proxying using a shared lib (seperate c code
> required), and web.proxy, which i'll update or rewrite soon.

Personally I'd prefer not having this in Twisted itself. Not sure why
though :P

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From shawn at zetet.com  Sun Sep 28 01:30:05 2003
From: shawn at zetet.com (Shawn O'Connor)
Date: Sat, 27 Sep 2003 22:30:05 -0700
Subject: [Twisted-Python] Re: from Scratch: Evolution of Finger (Moshe's Haifux talk)
In-Reply-To: <20030928031928.GC21156@frobozz> 
References: <20030928031022.16895.qmail@mail.metastructure.net>
            <20030928031928.GC21156@frobozz>
Message-ID: <20030928053005.1081.qmail@mail.metastructure.net>

>> I've put a prospective howto version of Moshe's Haifux talk,
>> Twisted from Scratch: Evolution of Finger online at
>> http://zetet.com/twisted/finger 
> 
> Where can I find the the Lore source that generated that page?

http://zetet.com/twisted/finger/tour.html 

shawn  @
zetet  .  com 




From glyph at twistedmatrix.com  Sun Sep 28 02:30:01 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 28 Sep 2003 02:30:01 -0400
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches
 to strport parsers
In-Reply-To: <20030927234110.7c04a220.itamar@itamarst.org>
References: <20030927221700.GA1541@soniq.net>	<20030927223723.GA17517@intarweb.us>	<20030927225804.GA1671@soniq.net>	<20030928025800.GA9204@soniq.net> <20030927234110.7c04a220.itamar@itamarst.org>
Message-ID: <3F767FE9.7090802@twistedmatrix.com>

Itamar Shtull-Trauring wrote:
> On Sun, 28 Sep 2003 04:58:00 +0200
> Paul Boehm <paul at soniq.net> wrote:
> 
> 
>>also, i want to ask the list if everyone is okay with me getting cvs
>>access to create and maintain twisted.proxy, a generic proxy,
>>currently capable of transparent proxying using netfilter,
>>pseudotransparent proxying using a shared lib (seperate c code
>>required), and web.proxy, which i'll update or rewrite soon.
> 
> 
> Personally I'd prefer not having this in Twisted itself. Not sure why
> though :P
> 

"separate C code required"?

That seems reason enough to exclude it for me.  What about forwarding is 
computationally intense enough to *require* C code?  Especially separate 
C code?




From paul at soniq.net  Sun Sep 28 02:59:15 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 08:59:15 +0200
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches to strport parsers
In-Reply-To: <3F767FE9.7090802@twistedmatrix.com>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us> <20030927225804.GA1671@soniq.net> <20030928025800.GA9204@soniq.net> <20030927234110.7c04a220.itamar@itamarst.org> <3F767FE9.7090802@twistedmatrix.com>
Message-ID: <20030928065915.GA13876@soniq.net>

On Sun, Sep 28, 2003 at 02:30:01AM -0400, Glyph Lefkowitz wrote:
> >Personally I'd prefer not having this in Twisted itself. Not sure why
> >though :P
> >
> 
> "separate C code required"?
> 
> That seems reason enough to exclude it for me.  What about forwarding is 
> computationally intense enough to *require* C code?  Especially separate 
> C code?

huh? you really didn't bother to read what i wrote in irc.

there's not a single line of c code in proxy, no mention of c code,
and no requirement for c code.

yes, i've written a shared library interface to one protocol..
and i'm not even going to publish that..

annoyed,
  paul



From glyph at twistedmatrix.com  Sun Sep 28 03:22:30 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 28 Sep 2003 03:22:30 -0400
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches
 to strport parsers
In-Reply-To: <20030928065915.GA13876@soniq.net>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us> <20030927225804.GA1671@soniq.net> <20030928025800.GA9204@soniq.net> <20030927234110.7c04a220.itamar@itamarst.org> <3F767FE9.7090802@twistedmatrix.com> <20030928065915.GA13876@soniq.net>
Message-ID: <3F768C36.7040803@twistedmatrix.com>

Paul Boehm wrote:

> huh? you really didn't bother to read what i wrote in irc.

Nope.  If you want responses on the mailing list, write to the mailing 
list :)

> there's not a single line of c code in proxy, no mention of c code,
> and no requirement for c code.

Ahem -

> ... twisted.proxy [is] a generic proxy, currently capable of
> ... pseudotransparent proxying using a shared lib (seperate c code
 > required) ...

That seems to be a mention of both c code and a requirement for c code. 
  I haven't seen anything either on IRC or here to indicate how this 
seperate, required C code is neither required nor C :)

> yes, i've written a shared library interface to one protocol..
> and i'm not even going to publish that..

I understand that this comment may not apply in this situation, but I'd 
like to be clear: the reason I responded as I did is that I don't like 
the idea of adding plugin interfaces to Twisted specifically to 
introduce a dependency on so that unpublished, proprietary, or even 
separate modules are required.  Sometimes that's unavoidable (support 
for proprietary platforms requires proprietary code) but unless there is 
an overriding concern it's undesireable.




From martin at tactilis.co.uk  Sun Sep 28 04:46:01 2003
From: martin at tactilis.co.uk (Martin Armstrong)
Date: Sun, 28 Sep 2003 09:46:01 +0100
Subject: [Twisted-Python] from Scratch: Evolution of Finger (Moshe's Haifux talk)
In-Reply-To: <20030928031022.16895.qmail@mail.metastructure.net>
References: <20030928031022.16895.qmail@mail.metastructure.net>
Message-ID: <U1CRSzbJ$pd$Ewdm@tactilis.demon.co.uk>

In article <20030928031022.16895.qmail at mail.metastructure.net>, Shawn 
O'Connor <shawn at zetet.com> writes

>I've put a prospective howto version of Moshe's Haifux talk,
>Twisted from Scratch: Evolution of Finger online at
>http://zetet.com/twisted/finger

>After any comments, suggestions

Perhaps you could remove the word 'not' from this section:

     "Refuse Connections

     ... It will not consume (almost) no CPU resources."

-- 
Martin Armstrong                        martin @ tactilis.co.uk



From ccom at gmx.net  Sun Sep 28 05:09:05 2003
From: ccom at gmx.net (ccom at gmx.net)
Date: Sun, 28 Sep 2003 11:09:05 +0200 (MEST)
Subject: [Twisted-Python] serving dynamic on root and still serve static somehow
Message-ID: <22678.1064740145@www48.gmx.net>

The general question propably is: How can I  serve my main web app on root
but still be able to serve flat files such as images and style sheets.

Say I want to run a webserver that provides a dynamic page on
"http://domain.com/" and a static file tree on "http://domain.com/static/". With the code I
have currently it always processes the dynamic page and never reaches the
"static" child:


class Dynamic(resource.Resource):
    isLeaf = True    
    return "mock dynamic page"
 
root = Container()
root.putChild('static', static.File('.'))
site = server.Site(root) 

reactor.listenTCP(8080, site)
reactor.run()


Help very much appreciated,

_stephan

-- 
NEU F?R ALLE - GMX MediaCenter - f?r Fotos, Musik, Dateien...
Fotoalbum, File Sharing, MMS, Multimedia-Gru?, GMX FotoService

Jetzt kostenlos anmelden unter http://www.gmx.net

+++ GMX - die erste Adresse f?r Mail, Message, More! +++




From screwtape at froup.com  Sun Sep 28 07:24:22 2003
From: screwtape at froup.com (screwtape at froup.com)
Date: Sun, 28 Sep 2003 21:24:22 +1000
Subject: [Twisted-Python] serving dynamic on root and still serve static somehow
In-Reply-To: <22678.1064740145@www48.gmx.net>
References: <22678.1064740145@www48.gmx.net>
Message-ID: <20030928112422.GA17713@ferd2.thristian.org>

On Sun, Sep 28, 2003 at 11:09:05AM +0200, ccom at gmx.net wrote:
> 
> The general question propably is: How can I  serve my main web app on root
> but still be able to serve flat files such as images and style sheets.

<snip>

>     isLeaf = True    

That's the line that's causing your grief.

If you set isLeaf on any resource, twisted.web won't look at its
children.

-- 
 ___________ ___________________________________
| Screwtape | http://livejournal.com/~thristian |______ _____ ___ __ _  _   _
|
| "Strange, Enya-like New Age music poured from a cactus." -- Jon Katz
|



From jml at mumak.net  Sun Sep 28 08:20:52 2003
From: jml at mumak.net (Jonathan Lange)
Date: Sun, 28 Sep 2003 22:20:52 +1000
Subject: [Twisted-Python] Re: from Scratch: Evolution of Finger (Moshe's Haifux talk)
In-Reply-To: <20030928053005.1081.qmail@mail.metastructure.net>; from shawn@zetet.com on Sun, Sep 28, 2003 at 15:30:05 +1000
References: <20030928031022.16895.qmail@mail.metastructure.net> <20030928031928.GC21156@frobozz> <20030928053005.1081.qmail@mail.metastructure.net>
Message-ID: <20030928122052.GA749@sting>

On 09/28/03 15:30:05, Shawn O'Connor wrote:
>>> I've put a prospective howto version of Moshe's Haifux talk,
>>> Twisted from Scratch: Evolution of Finger online at
>>> http://zetet.com/twisted/finger
>> 
>> Where can I find the the Lore source that generated that page?
> 
> http://zetet.com/twisted/finger/tour.html

Suggestion. Moshe's workshop and the derived howto are both huge. It  
might be worth splitting the single lore file into a multi-part howto.

cheers,
jml

PS. Thanks for doing this, btw. I have been too busy w/ uni to  
contribute to Twisted :(
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030928/2bd680df/attachment.pgp 

From itamar at itamarst.org  Sun Sep 28 19:50:21 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 28 Sep 2003 19:50:21 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] InMemoryUsernamePasswordDatabaseDontUse
 didn't raise the error properly when the password was wrong
In-Reply-To: <E1A3lDb-0007B4-00@wolfwood>
References: <E1A3lDb-0007B4-00@wolfwood>
Message-ID: <20030928195021.64302e8e.itamar@itamarst.org>

On Sun, 28 Sep 2003 17:44:47 -0600
teratorn CVS <teratorn at wolfwood.twistedmatrix.com> wrote:

> -            return failure.Failure(error.UnauthorizedLogin())
> +            raise error.UnauthorizedLogin()
>  

Uh. Why does one work and not the other? That looks like a bug in
Deferred to me. Aren't returned Failures supposed to be the same as
raised exceptions in callbacks?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Sun Sep 28 20:04:45 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 28 Sep 2003 20:04:45 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] InMemoryUsernamePasswordDatabaseDontUse
 didn't raise the error properly when the password was wrong
In-Reply-To: <20030928195021.64302e8e.itamar@itamarst.org>
References: <E1A3lDb-0007B4-00@wolfwood> <20030928195021.64302e8e.itamar@itamarst.org>
Message-ID: <3F77771D.6040702@twistedmatrix.com>

Itamar Shtull-Trauring wrote:
> On Sun, 28 Sep 2003 17:44:47 -0600
> teratorn CVS <teratorn at wolfwood.twistedmatrix.com> wrote:
> 
> 
>>-            return failure.Failure(error.UnauthorizedLogin())
>>+            raise error.UnauthorizedLogin()
>> 
> 
> 
> Uh. Why does one work and not the other? That looks like a bug in
> Deferred to me. Aren't returned Failures supposed to be the same as
> raised exceptions in callbacks?
> 

Considering that the two are equivalent, the former style is preferred 
in situations like this, since it does not create Python traceback info 
(which is _noticeably_ slower than not doing it).




From exarkun at intarweb.us  Sun Sep 28 20:31:16 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 28 Sep 2003 20:31:16 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] InMemoryUsernamePasswordDatabaseDontUse didn't raise the error properly when the password was wrong
In-Reply-To: <3F77771D.6040702@twistedmatrix.com>
References: <E1A3lDb-0007B4-00@wolfwood> <20030928195021.64302e8e.itamar@itamarst.org> <3F77771D.6040702@twistedmatrix.com>
Message-ID: <20030929003116.GA28533@intarweb.us>

On Sun, Sep 28, 2003 at 08:04:45PM -0400, Glyph Lefkowitz wrote:
> Itamar Shtull-Trauring wrote:
> >On Sun, 28 Sep 2003 17:44:47 -0600
> >teratorn CVS <teratorn at wolfwood.twistedmatrix.com> wrote:
> >
> >
> >>-            return failure.Failure(error.UnauthorizedLogin())
> >>+            raise error.UnauthorizedLogin()
> >>
> >
> >
> >Uh. Why does one work and not the other? That looks like a bug in
> >Deferred to me. Aren't returned Failures supposed to be the same as
> >raised exceptions in callbacks?
> >
> 
> Considering that the two are equivalent, the former style is preferred 
> in situations like this, since it does not create Python traceback info 
> (which is _noticeably_ slower than not doing it).
> 

  ... and then gets send to the PB client, producing a full traceback on the
client side, instead of just a one-line exception string.

  In this case, that means the client is able to discern between invalid
usernames and invalid passwords, which would be a serious problem, if we
were talking about anything other than InMemoryUsernamePassword-
DatabaseDontUse.  As it is, I think InMemoryUsernamePasswordDatabaseDontUse
should intentionally reveal even more information about why the login failed
(making it more useful for debugging and less useful for production), and
the difference between returning a Failure constructed from an exception and
raising an exception in a callback be spelled out explicitly somewhere.  Who
knows when the difference will be forgotten and something unintentionally
revealed, as it was in InMemoryUsernamePasswordDatabaseDontUse?

  Jp

-- 
#!/bin/bash
( LIST=(~/.sigs/*.sig)
  cat ${LIST[$(($RANDOM % ${#LIST[*]}))]}
  echo -- $'\n' `uptime | sed -e 's/.*m//'` ) > ~/.signature
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030928/c19d56b7/attachment.pgp 

From itamar at itamarst.org  Sun Sep 28 20:46:23 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 28 Sep 2003 20:46:23 -0400
Subject: [Twisted-Python] Re: [Twisted-commits]
 InMemoryUsernamePasswordDatabaseDontUse didn't raise the error properly
 when the password was wrong
In-Reply-To: <20030929003116.GA28533@intarweb.us>
References: <E1A3lDb-0007B4-00@wolfwood>
	<20030928195021.64302e8e.itamar@itamarst.org>
	<3F77771D.6040702@twistedmatrix.com>
	<20030929003116.GA28533@intarweb.us>
Message-ID: <20030928204623.0f7b71b2.itamar@itamarst.org>

On Sun, 28 Sep 2003 20:31:16 -0400
Jp Calderone <exarkun at intarweb.us> wrote:

>   In this case, that means the client is able to discern between
>   invalid
> usernames and invalid passwords, which would be a serious problem, if
> we were talking about anything other than InMemoryUsernamePassword-
> DatabaseDontUse.  As it is, I think
> InMemoryUsernamePasswordDatabaseDontUse should intentionally reveal
> even more information about why the login failed(making it more useful
> for debugging and less useful for production), and the difference
> between returning a Failure constructed from an exception and raising
> an exception in a callback be spelled out explicitly somewhere.  Who
> knows when the difference will be forgotten and something
> unintentionally revealed, as it was in
> InMemoryUsernamePasswordDatabaseDontUse?

I don't think PB failures should sent *ANY* traceback info. In fact, I
can't figure out how to prevent that from happening even on a case by
case basis.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From greg at digitalinfo.net  Sun Sep 28 21:30:33 2003
From: greg at digitalinfo.net (Greg)
Date: Sun, 28 Sep 2003 21:30:33 -0400
Subject: [Twisted-Python] using ClientFactory from within a server
Message-ID: <200309282130.33961.greg@digitalinfo.net>

I am having trouble using ClientFactory to communicate from within a server. 
Specifically, I can't figure out the proper way to exit from the client 
process. 

Included is some example code illustrating the problem I am having. It is the 
simple echo server example, but when someone sends some text to the server, I 
am trying to talk to an SMTP server to send an email. This is just an example 
(there are probably better ways to fire off an email), but you get the idea. 
The client code never "exits" and if I try to use reactor.stop() it causes a 
traceback. 

So how do I properly exit from this client code, or (being new to twisted) am 
I going about this in the entirely wrong way? Thanks.


#!/usr/bin/env python

from twisted.internet import reactor
from twisted.internet.protocol import Protocol, ClientFactory, ServerFactory
import sys

class Echo(Protocol):
	"""This is just about the simplest possible protocol"""
	
	def dataReceived(self, data):
		"As soon as any data is received, write it back."
		self.transport.write(data)
		factory2 = MySMTPClientFactory()
		host = 'localhost'
		port = 25
		reactor.connectTCP(host, port, factory2)
		reactor.run()

		print "Returned from sending email"
		# ^ Never gets to this point
		
class MySMTP(Protocol):
	def dataReceived(self, data):
			sys.stdout.write('Server said: ' + data)
			if data[:3] == "220":
				self.transport.write("helo foo.com\n")
				self.stage = 1
			if data[:3] == "250":
				if self.stage == 1:
					self.transport.write("MAIL FROM:<greg at foo.com>\n")
					self.stage = 2
				elif self.stage == 2:
					self.transport.write("RCPT TO:<greg at foo.com>\n")
					self.stage = 3
				elif self.stage == 3:
					self.transport.write("DATA\n")
					self.stage = 4
				elif self.stage == 4:
					self.transport.write("QUIT\n")
					self.transport.loseConnection()
					#reactor.stop()
					# ^ This causes a traceback
					
			if data[:3] == "354":
				# Ready to send actual email
				self.transport.write("This is a test email\n.\n")
				

class MySMTPClientFactory(ClientFactory):
	def startedConnection(self, connector):
		print 'Started to connect.'
	
	def buildProtocol(self, addr):
		print 'Connected.'
		return MySMTP()
	
	def clientConnectionLost(self, connector, reason):
		print 'Lost connection.  Reason:', reason
		#reactor.stop()
		# ^ Causes a traceback here too
		
	def clientConnectionFailed(self, connector, reason):
		print 'Connection failed. Reason:', reason

def main():
	"""This runs the protocol on port 8000"""
	factory = ServerFactory()
	factory.protocol = Echo
	reactor.listenTCP(8000,factory)
	reactor.run()

# this only runs if the module was *not* imported
if __name__ == '__main__':
	main()




From exarkun at intarweb.us  Sun Sep 28 23:23:08 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 28 Sep 2003 23:23:08 -0400
Subject: [Twisted-Python] using ClientFactory from within a server
In-Reply-To: <200309282130.33961.greg@digitalinfo.net>
References: <200309282130.33961.greg@digitalinfo.net>
Message-ID: <20030929032307.GB28533@intarweb.us>

On Sun, Sep 28, 2003 at 09:30:33PM -0400, Greg wrote:
> I am having trouble using ClientFactory to communicate from within a server. 
> Specifically, I can't figure out the proper way to exit from the client 
> process. 
> 
> Included is some example code illustrating the problem I am having. It is the 
> simple echo server example, but when someone sends some text to the server, I 
> am trying to talk to an SMTP server to send an email. This is just an example 
> (there are probably better ways to fire off an email), but you get the idea. 
> The client code never "exits" and if I try to use reactor.stop() it causes a 
> traceback. 

  reactor.run() enters the twisted mainloop.  reactor.stop() causes the
mainloop to terminate in the near future.  You cannot nest calls to the
mainloop (nor do you need to do so).

> 
> So how do I properly exit from this client code, or (being new to twisted) am 
> I going about this in the entirely wrong way? Thanks.
> 
> 
> #!/usr/bin/env python
> 
> from twisted.internet import reactor
> from twisted.internet.protocol import Protocol, ClientFactory, ServerFactory
> import sys
> 
> class Echo(Protocol):
> 	"""This is just about the simplest possible protocol"""
> 	
> 	def dataReceived(self, data):
> 		"As soon as any data is received, write it back."
> 		self.transport.write(data)
> 		factory2 = MySMTPClientFactory()
> 		host = 'localhost'
> 		port = 25
> 		reactor.connectTCP(host, port, factory2)
> 		reactor.run()

  Remove the above call to "reactor.run() and see what happens.

> 
> 		print "Returned from sending email"
> 		# ^ Never gets to this point
> 		
> class MySMTP(Protocol):
> [snip]
> 				

  I don't understand why you aren't using twisted.protocols.smtp.

> [snip]

  Jp

-- 
http://catandgirl.com/view.cgi?44
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030928/0421287f/attachment.pgp 

From pradu at pradu.it  Mon Sep 29 06:03:30 2003
From: pradu at pradu.it (Alessandro Praduroux)
Date: Mon, 29 Sep 2003 12:03:30 +0200
Subject: [Twisted-Python] cut and paste is evil :)
Message-ID: <200309291203.30548.pradu@pradu.it>

in version 1.37 of formmethod.py has been added a constructor to the String 
class, to add a min/max lenght check for the string. That's a cool idea, but 
the implementation destroyed the behaviour of all derived classes :).

def __init__(self, name, default=None, shortDesc=None,
                  longDesc=None, hints=None, allowNone=1, min=0, max=None):
         Argument.__init__(self, name, default=None, shortDesc=None,
                           longDesc=None, hints=None, allowNone=1)
         self.min = min
         self.max = max

you can see that in calling the Argument.__init__ constructor, all values are 
reset to None.

issued to the bugtracker, with simple patch.
http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue296


-- 
Linux webmaster & sysadmin
pradu at pradu.it




From greg at digitalinfo.net  Mon Sep 29 08:07:57 2003
From: greg at digitalinfo.net (Greg)
Date: Mon, 29 Sep 2003 08:07:57 -0400
Subject: [Twisted-Python] using ClientFactory from within a server
In-Reply-To: <20030929032307.GB28533@intarweb.us>
References: <200309282130.33961.greg@digitalinfo.net> <20030929032307.GB28533@intarweb.us>
Message-ID: <3F78209D.50105@digitalinfo.net>

>>		reactor.connectTCP(host, port, factory2)
>>		reactor.run()
>>    
>>
>
>  Remove the above call to "reactor.run() and see what happens.
>
>  
>
>>		print "Returned from sending email"
>>		# ^ Never gets to this point
>>    
>>
Thanks. Now I am getting closer. But a strange (to me) thing happens. 
When I connect to the Echo server and send it a string, it does 
correctly run the MySMTP code. But it does not return and execute the 
'print "Returned from sending email"' statement until I connect to the 
Echo server again and send another string. Any idea why this is 
happening? Is there a way to disconnect factory2 from the reactor after 
I have sent the "QUIT" string (or when 
MySMTPClientFactory.clientConnectionLost() gets called)?

>>		
>>class MySMTP(Protocol):
>>[snip]
>>				
>>    
>>
>
>  I don't understand why you aren't using twisted.protocols.smtp.
>  
>
The use of SMTP is just an example. In reality I'm talking a different 
protocol, but I wanted to use a common protocol like SMTP in my example 
so that someone on the list could easily test my code.




From ac at strakt.com  Mon Sep 29 08:28:45 2003
From: ac at strakt.com (Anders =?ISO-8859-1?Q?Chrigstr=F6m?=)
Date: 29 Sep 2003 14:28:45 +0200
Subject: [Twisted-Python] Some threadpool patches
Message-ID: <1064838525.12001.21.camel@ashera.strakt.com>

Hi,

Here are two patches regarding the threadpool.

The first is to python/threadpool.py and firstly fixes the problem with
the threadpool not being safe to it's own threads and secondly to ensure
that enough threads get started. I'm not convinced that the way the
threads are started is the best way, but it gets the job done.

The second patch removes knowledge of the threadpool internals from
internet/base.py

/Anders

-- 
Anders Chrigstr?m <ac at strakt.com>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: threadpool.patch
Type: text/x-patch
Size: 5706 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030929/3c718da4/attachment.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: base.patch
Type: text/x-patch
Size: 855 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030929/3c718da4/attachment-0001.bin 

From itamar at itamarst.org  Mon Sep 29 09:59:55 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 29 Sep 2003 09:59:55 -0400
Subject: [Twisted-Python] Some threadpool patches
In-Reply-To: <1064838525.12001.21.camel@ashera.strakt.com>
References: <1064838525.12001.21.camel@ashera.strakt.com>
Message-ID: <20030929095955.6341b50a.itamar@itamarst.org>

On 29 Sep 2003 14:28:45 +0200
Anders Chrigstr?m <ac at strakt.com> wrote:

> Here are two patches regarding the threadpool.

Thanks! Could you add those to twistedmatrix.com/bugs/? Feel free to
assign them to me.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From ac at strakt.com  Mon Sep 29 10:28:39 2003
From: ac at strakt.com (Anders =?ISO-8859-1?Q?Chrigstr=F6m?=)
Date: 29 Sep 2003 16:28:39 +0200
Subject: [Twisted-Python] Some threadpool patches
In-Reply-To: <20030929095955.6341b50a.itamar@itamarst.org>
References: <1064838525.12001.21.camel@ashera.strakt.com>
	 <20030929095955.6341b50a.itamar@itamarst.org>
Message-ID: <1064845719.12000.32.camel@ashera.strakt.com>

On Mon, 2003-09-29 at 15:59, Itamar Shtull-Trauring wrote:
> On 29 Sep 2003 14:28:45 +0200
> Anders Chrigstr?m <ac at strakt.com> wrote:
> 
> > Here are two patches regarding the threadpool.
> 
> Thanks! Could you add those to twistedmatrix.com/bugs/? Feel free to
> assign them to me.

Done!
You will find them as Issue297 and Issue298.

Best regards,
/Anders

-- 
Anders Chrigstr?m <ac at strakt.com>




From ccom at gmx.net  Mon Sep 29 13:24:15 2003
From: ccom at gmx.net (ccom at gmx.net)
Date: Mon, 29 Sep 2003 19:24:15 +0200 (MEST)
Subject: [Twisted-Python] Re: serving dynamic on root and still serve static somehow
Message-ID: <31814.1064856255@www53.gmx.net>

Yeah, I noticed that when I set isLeaf = False in my root node my child
nodes will get processed. At the same time my root will then serve a 404-No Such
Resource, though.  Serving static files on root and dynamic ones as child
nodes was easy but how do I do it the other way round--dynamic on root and
static files on a child node?


>> The general question propably is: How can I  serve my main web app on
>> root but still be able to serve flat files such as images and style
sheets.
 
><snip>
 
>>     isLeaf = True    
 
>That's the line that's causing your grief.
 
>If you set isLeaf on any resource, twisted.web won't look at its
>children.


_stephan

-- 
NEU F?R ALLE - GMX MediaCenter - f?r Fotos, Musik, Dateien...
Fotoalbum, File Sharing, MMS, Multimedia-Gru?, GMX FotoService

Jetzt kostenlos anmelden unter http://www.gmx.net

+++ GMX - die erste Adresse f?r Mail, Message, More! +++




From radix at twistedmatrix.com  Mon Sep 29 14:46:14 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 29 Sep 2003 14:46:14 -0400
Subject: [Twisted-Python] Re: serving dynamic on root and still serve static somehow
In-Reply-To: <31814.1064856255@www53.gmx.net>
References: <31814.1064856255@www53.gmx.net>
Message-ID: <20030929184614.GA1515@radii>

On Mon, Sep 29, 2003 at 07:24:15PM +0200, ccom at gmx.net wrote:
> 
> Yeah, I noticed that when I set isLeaf = False in my root node my
> child nodes will get processed. At the same time my root will then
> serve a 404-No Such Resource, though.

With isLeaf=False, the root resource will _never_ have its render()
method called. That is because the request for the root resource is
always '/', not ''. (i.e., "GET / HTTP/1.1", not "GET  HTTP/1.1")

'/'.split('/') == [''], which means that getChild('', request) will be
called. Therefore, your root resource must respond to 
getChild('', request).


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From warner at lothar.com  Mon Sep 29 15:10:52 2003
From: warner at lothar.com (Brian Warner)
Date: Mon, 29 Sep 2003 12:10:52 -0700 (PDT)
Subject: [Twisted-Python] qtreactor needs help
Message-ID: <20030929.121052.59474489.warner@lothar.com>

The qtreactor test has been failing for several weeks: something in the
Application testcase either hangs or goes into an infinite loop. This was
slowing down the buildbot quite a bit (it waits 20 minutes before killing off
a stuck child process, but there are cases where sub-children are not killed,
and for this case the 100% CPU usage persisted after the test suite was
terminated, slowing everything else on the system down).

I've removed the qtreactor test case from the 'reactors' build until we can
resolve the problem.

Would someone who knows QT try './bin/trial -v -r qtreactor twisted.test' and
see where it hangs? And fix the problem? :)

Let me know when it's behaving again and I'll add it back to the buildbot.

thanks,
 -Brian



From exarkun at intarweb.us  Mon Sep 29 15:12:17 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Mon, 29 Sep 2003 15:12:17 -0400
Subject: [Twisted-Python] Test coverage of Twisted
Message-ID: <20030929191217.GA6617@intarweb.us>

  Tv pointed out a code coverage tool this morning.  I thought I'd share
some results it generated.

  For twisted.internet:

Name                Stmts   Exec  Cover
---------------------------------------
gladereactor          118      0     0%
gtk2reactor           139      0     0%
gtkreactor            125      0     0%
javareactor           268      0     0%
kqreactor              90      0     0%
pollreactor           107      0     0%
pyuisupport            16      0     0%
qtreactor             131      0     0%
task                    8      0     0%
tksupport              29      0     0%
win32eventreactor     266      0     0%
wxsupport              22      0     0%
stdio                  58     18    31%
utils                 144     55    38%
app                   559    275    49%
main                   86     50    58%
threads                27     16    59%
interfaces            328    200    60%
process               415    271    65%
unix                  184    134    72%
default               336    244    72%
reactor                 9      7    77%
base                  384    304    79%
fdesc                  26     22    84%
tcp                   451    387    85%
udp                   208    178    85%
abstract              131    115    87%
protocol              275    242    88%
ssl                    89     79    88%
defer                 212    192    90%
error                 154    144    93%
---------------------------------------
TOTAL                5396   2934    54%


  For twisted.protocols:

Name          Stmts   Exec  Cover
---------------------------------
socks           116      0     0%
finger           30      0     0%
portforward      41      0     0%
shoutcast        76      0     0%
oscar           836    167    19%
dict            285     97    34%
telnet          155     66    42%
msn             994    454    45%
nntp            638    302    47%
irc            1080    528    48%
toc            1043    547    52%
htb             115     74    64%
pop3            446    294    65%
smtp            918    626    68%
policies        275    190    69%
xmlstream        91     66    72%
raw              15     11    73%
ftp             712    552    77%
imap4          2742   2132    77%
postfix          76     59    77%
sux             402    312    77%
sip             674    541    80%
wire             50     41    82%
basic           236    197    83%
http            649    554    85%
dns             688    602    87%
ethernet         31     29    93%
pcp             121    117    96%
loopback         94     92    97%
ip               34     34   100%
rawudp           25     25   100%
---------------------------------
TOTAL         13689   8710    63%


  For twisted.python:

Name            Stmts   Exec  Cover
-----------------------------------
dispatch           15      0     0%
domhelpers          4      0     0%
dxprofile          29      0     0%
mutablestring       3      0     0%
mvc                10      0     0%
plugin            174      0     0%
register           28      0     0%
shortcut           29      0     0%
syslog             27      0     0%
win32              15      0     0%
dir                26      2     7%
otp               152     34    22%
htmlizer           50     12    24%
compat             62     17    27%
runtime            36     15    41%
finalize           30     16    53%
text              137     73    53%
observable        249    151    60%
threadable        188    114    60%
reflect           371    224    60%
threadpool        120     78    65%
util              354    249    70%
urlpath            77     56    72%
roots             107     78    72%
rebuild           194    148    76%
zipstream         176    139    78%
log               239    192    80%
logfile           162    134    82%
filepath          161    135    83%
failure           191    167    87%
usage             289    254    87%
formmethod        217    198    91%
components        213    196    92%
hook               70     65    92%
context            43     42    97%
timeoutqueue       24     24   100%
-----------------------------------
TOTAL            4273   2814    65%


  More detailed information is available -- if anyone wants to take on
improving the test coverage, send me a note and I'll send you the relevant
files.  Also, the data file used to generate the output is attached to this
message (decompress before using), and the tool for manipulating it in
useful ways is at

    http://www.garethrees.org/2001/12/04/python-coverage/coverage.py

  so you can also generate the results independently.

  Jp

-- 
http://catandgirl.com/view.cgi?44
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030929/6fc235e4/attachment.pgp 

From exarkun at intarweb.us  Mon Sep 29 15:58:23 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Mon, 29 Sep 2003 15:58:23 -0400
Subject: [Twisted-Python] Test coverage of Twisted
In-Reply-To: <20030929191217.GA6617@intarweb.us>
References: <20030929191217.GA6617@intarweb.us>
Message-ID: <20030929195823.GA7289@intarweb.us>

  Okay.  It's actually attached to this message.

  Jp

-- 
"The problem is, of course, that not only is economics bankrupt but it has
 always been nothing more than politics in disguise ... economics is a form
 of brain damage."  -- Hazel Henderson
-------------- next part --------------
A non-text attachment was scrubbed...
Name: coverage.bz2
Type: application/octet-stream
Size: 38337 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030929/18f4caa7/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030929/18f4caa7/attachment.pgp 

From paul at soniq.net  Tue Sep 30 07:28:21 2003
From: paul at soniq.net (Paul Boehm)
Date: Tue, 30 Sep 2003 13:28:21 +0200
Subject: [Twisted-Python] [twisted.roundup@twistedmatrix.com: [issue291] app.getApplication cleanup]
Message-ID: <20030930112821.GA11791@soniq.net>

okay, and now someone explain to me what should motivate me to keep
sending in patches? strports patches will be rejected too, moshez told
me, so i'll have to fork that too.. 

and i had fixes for that loseConnection stuff months ago, i don't
remember if i submitted them, because even back then i knew from
experience that you won apply my patches, but i probably did.

you realize that you are unwilling to apply any of my patches, even when
minor, and when i'm trying really hard to get them in?

it would be really easier to maintain a patch dir, and just fix my own
cvs checkout locally.

i'll submit my proxy patches, integrating well into cvs-current, this
week, as arranged on irc, and you judge if my code is unbearable or if
it actually makes sense. i see this as an last attempt to communicate
with you guys..

bitter,
  paul

----- Forwarded message from Moshe Zadka <twisted.roundup at twistedmatrix.com> -----

Subject: [issue291] app.getApplication cleanup
To: paul at soniq.net
From: Moshe Zadka <twisted.roundup at twistedmatrix.com>
Reply-To: Twisted issue tracker <twisted.roundup at twistedmatrix.com>
Date: Tue, 30 Sep 2003 05:40:22 +0000


Moshe Zadka <moshez at twistedmatrix.com> added the comment:

I'm going to reject it -- this code works, and is clear 
enough. Do you have any good reason, other than clean-up, 
for this patch?


----------
status: unread -> chatting
__________________________________________________________________
Twisted issue tracker <twisted.roundup at twistedmatrix.com>
http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue291
__________________________________________________________________

----- End forwarded message -----




From andrew-twisted at puzzling.org  Tue Sep 30 10:21:35 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 1 Oct 2003 00:21:35 +1000
Subject: [Twisted-Python] [twisted.roundup@twistedmatrix.com: [issue291] app.getApplication cleanup]
In-Reply-To: <20030930112821.GA11791@soniq.net>
References: <20030930112821.GA11791@soniq.net>
Message-ID: <20030930142135.GG21156@frobozz>

On Tue, Sep 30, 2003 at 01:28:21PM +0200, Paul Boehm wrote:
> okay, and now someone explain to me what should motivate me to keep
> sending in patches? strports patches will be rejected too, moshez told
> me, so i'll have to fork that too.. 

Moshe is the maintainer of that particular section of code; it would take a
lot to convince other developers to override his judgement on those issues.
Certainly, a cosmetic patch such as this particular one (which merely
rearranged code, even if it does seems clearer) isn't something to get
particularly bothered about either way.

Also, here's what moshez said regarding strports patches (according to my
IRC log):
    <moshez> patches to make "strports more general" will be rejected until
    I see a use case. we tried to come up with a use case and didn't have
    success

Your paraphrase above ("strports patches will be rejected too, moshez told
me") implied something quite different to what he actually said (please
correct me if he said otherwise and I didn't see it!).  He requires use
cases to justify adding more features -- presumably if you want to add a
feature, you will have a reason, so I don't see this as being particularly
onerous :)

> and i had fixes for that loseConnection stuff months ago, i don't
> remember if i submitted them, because even back then i knew from
> experience that you won apply my patches, but i probably did.

I've searched the issue tracker and the mailing list, and can't find what
you're referring to.  Please post it to the issue tracker, so that we can
ignore it properly ;)

Seriously, it looks like you haven't sent that patch to us, so please do.

> you realize that you are unwilling to apply any of my patches, even when
> minor, and when i'm trying really hard to get them in?

I know some people feel that cosmetic patches that merely change code to
look prettier are more risk than they're worth; e.g. when True and False was
added to Python, Guido discouraged people from going through and making the
obvious cosmetic changes in the standard library because of the risk of
introducing bugs.  If a maintainer feels that the cost of applying and
encouraging cosmetic patches outweighs the small (and ultimately subjective)
benefit they give, then they will reject them.

I'm not sure of Moshe's specific reasons for this rejection, beyond what he
wrote in the issue tracker:
    "I'm going to reject it -- this code works, and is clear enough."
But judging from that, his point of view is similar to what I just
described.  He didn't see that patch as offering a substantial enough
improvement over the existing code to be worthwhile.  

Extrapolating from this one minor patch to "you are unwilling to apply any
of my patches" seems a little premature.  Are there others from you that
have been rejected that I don't know about?

> i'll submit my proxy patches, integrating well into cvs-current, this
> week, as arranged on irc, and you judge if my code is unbearable or if
> it actually makes sense. i see this as an last attempt to communicate
> with you guys..

I'm listening, and I believe the other developers are too.  Some of us are
unnecessarily abrasive at times (yes Moshe I mean you), and I regret that.
I look forward to seeing your proxy patches and discussing them with you.

Thanks for your efforts so far (even though they have gone unrewarded)!

Regards,

-Andrew.




From itamar at itamarst.org  Tue Sep 30 12:13:12 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 30 Sep 2003 12:13:12 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] Port to strports
In-Reply-To: <E1A4GKl-0007tB-00@wolfwood>
References: <E1A4GKl-0007tB-00@wolfwood>
Message-ID: <20030930121312.725af4dd.itamar@itamarst.org>

On Tue, 30 Sep 2003 02:58:15 -0600
moshez CVS <moshez at wolfwood.twistedmatrix.com> wrote:

> Modified files:
> Twisted/twisted/tap/conch.py 1.6 1.7
> 
> Log message:
> Port to strports

I'd be happier if docstrings noted the use of strports so mktap users
will know they can do insane stuff like run SSH over SSL ;)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Tue Sep 30 12:17:57 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 30 Sep 2003 12:17:57 -0400
Subject: [Twisted-Python] [twisted.roundup@twistedmatrix.com: [issue291]
 app.getApplication cleanup]
In-Reply-To: <20030930112821.GA11791@soniq.net>
References: <20030930112821.GA11791@soniq.net>
Message-ID: <20030930121757.2c2de5d0.itamar@itamarst.org>

I had the same conversation with moshe about making strports more
general, and like he said, we couldn't find any uses cases. To emphasize
the point, *I* couldn't find any, and I was asking for these changes. So
we decided not to bother changing it until we do.

If you do have a use case, then I'm sure extending it won't be a
problem, and moshez was quite willing to change the code for that case.
But we're all working on this in our spare time, it's not our job, so in
order for us to do extra work there has to be a reason. YAGNI is a valid
argument.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From fog at initd.org  Tue Sep 30 12:27:43 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Tue, 30 Sep 2003 18:27:43 +0200
Subject: [Twisted-Python] deferred folies
Message-ID: <1064939263.1380.4.camel@localhost>

hi *,

lately i did some dirty Deferred tricks and i just want to know if there
is a better way to do what i did. the situation is as follows:

a server exposes through pb a "session" object. the client can call on
that object "execute" (any number of times) and then "abort" or "end" to
end the session. the session is created by calling "new_session" on the
remote perspective (after authentication, etc.)

now, for a simple get session/execute/end sequence i don't want to write
n+1 callbacks (one that waits for new_session and call execute, next one
that wait on execute and call next, etc.) so here is what I did (inside
a mixin class used in the client):

def session(self):
    return self.server.callRemote("new_session")

def execute(self, trans, *args, **kwargs)
    cb = kwargs.get('callback', None)
    if self._session:
        dfr = self.server.callRemote(trans, *args)
        if cb:
            dfr.chainDeferred(cb)
        return dfr
    else:
        dfr = self.session()
        cb = Deferred()
        dfr.addCallback(self._execute_got_session, trans, cb, *args)
        return cb

def _execute_got_session(self, session, trans, cb, *args):
    self._session = session
    return self.execute(trans, *args, callback=cb)

that is, from the client the user can just do:

d = self.execute("set-foo", 42)
d.addCallback(...)

and in the callback call .execute again (and be sure to be in the same
session) or call end or abort to terminate the session.

clear? mm..

what i want to know is if the "cb" trick and chainDeferred call are a
dirty hack or if that's the way they are supposed to be used and if
there is a better way to do what i do.

ciao,
federico

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
   Lasciate che i furetti vengano a me. -- Maria Luisa Benedetta Panzani
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio =?ISO-8859-1?Q?=E8?= firmata
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030930/3a2d8722/attachment.pgp 

From glyph at twistedmatrix.com  Tue Sep 30 13:31:54 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 30 Sep 2003 13:31:54 -0400
Subject: [Twisted-Python] [twisted.roundup@twistedmatrix.com: [issue291]
 app.getApplication cleanup]
In-Reply-To: <20030930112821.GA11791@soniq.net>
References: <20030930112821.GA11791@soniq.net>
Message-ID: <3F79BE0A.5010606@twistedmatrix.com>

Paul Boehm wrote:
> okay, and now someone explain to me what should motivate me to keep
> sending in patches? strports patches will be rejected too, moshez told
> me, so i'll have to fork that too.. 

I don't know.  What motivated you to send patches in the first place?

> and i had fixes for that loseConnection stuff months ago, i don't
> remember if i submitted them, because even back then i knew from
> experience that you won apply my patches, but i probably did.

As Andrew pointed out, there is nothing on the list or tracker. 
Certainly you'd learn from experience that if you don't submit patches, 
we won't apply them.

> i'll submit my proxy patches, integrating well into cvs-current, this
> week, as arranged on irc, and you judge if my code is unbearable or if
> it actually makes sense. i see this as an last attempt to communicate
> with you guys..

You may want to consider trying a little harder before giving up.  You
make this sound like a last resort after you've spent a long, hard time
explaining yourself and lobbying for an important patch.  However, this
is a trivial patch, "cleanup" which isn't required unless you happen to
find for loops substantially easier to read than list comprehensions (or
longer functions easier to read than shorter ones).

Looking at issue 291, the conversation goes:

Moshe:
> I'm going to reject it -- this code works, and is clear 
> enough. Do you have any good reason, other than clean-up, 
> for this patch?

Paul:
>> no
>> besides i've joined the dark circle now and understand the code anyway,
>> lets keep those pesty newbies away from the secrets of the inner circle!

This doesn't look like a lot of hard arguing to get bitter over.  Moshe
asked you for reasons and you didn't give him any.

There is good reason not to accept patches which simply shuffle things
around.  Every change has a cost.  Every change is a small bit of
functionality which will be subtly different between versions.  We are
striving to create as few of these as possible, and any long-time
Twisted user can still tell you that we create a LOT.  Any bug report
involving the code in question will automatically get longer, because
instead of dealing with the only released version, the developer will
always have to ask "Is this with 1.1.1 or 1.1.2?"

So, if you want "cleanup" changes to be accepted, you are automatically
fighting an uphill battle, and for good reason.

If you really feel that aesthetic changes like this are important, your
best bet is to include some useful modification to the current file -
preferably with a strong use-case attached in the tracker or in
docstrings, as well as tests - and it is very unlikely that we will
reject patches on the grounds that they contain additional cosmetic
changes, especially if those changes are related to the fix or
enhancement.  I'd still prefer you avoid this kind of change, but
working, useful code is always a good bargaining chip.

Also, just in terms of priorities: if readability is your goal your
energies would best be directed elsewhere.  May I humbly suggest that
you examine other parts of Twisted, such as twisted/spread/jelly.py,
twisted/protocols/imap4.py, or this lovely snippet	 from
twisted/protocols/dns.py:

>         byte3 = (( ( self.answer & 1 ) << 7 )
>                  | ((self.opCode & 0xf ) << 3 )
>                  | ((self.auth & 1 ) << 2 )
>                  | ((self.trunc & 1 ) << 1 )
>                  | ( self.recDes & 1 ) )
>         byte4 = ( ( (self.recAv & 1 ) << 7 )
>                   | (self.rCode & 0xf ) )

As far as readability goes, you can do a lot worse in Twisted than any
of the code in twisted/application.

> i see this as an last attempt to communicate with you guys..

> bitter,
>   paul

Sit back, take a deep breath, and relax.  We have no prejudice against 
you or your patches.  Each one will be evaluated in turn.  If the 
maintainer disagrees with you, or even if not, you may still be expected 
to give coherent and complete examples of why the patches are important 
enough to justify their cost as changes, but we turn down relatively few 
patches overall.

If you're having trouble communicating, keep the discussions to public, 
archived forums like this mailing list or the particular issue in 
question, so that others might help you argue your case.  Unless you 
know another person's style of communication well, IRC can be an 
exercise in frustration, and the Twisted developers' style includes many 
subtle hints about tone of voice which are not immediately obvious to 
those outside the group.




From glyph at twistedmatrix.com  Tue Sep 30 13:34:15 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 30 Sep 2003 13:34:15 -0400
Subject: [Twisted-Python] more on IRC frustration
Message-ID: <3F79BE97.50105@twistedmatrix.com>

Mentioning IRC frustrations in my message to paul reminded me of something.

There is one stylistic hint in particular I'd like to point out, because 
it causes the most misunderstanding, and it seems as though it may be 
particular to our peculiar IRC subculture.  If you're in #twisted and 
somebody says something like this:

<usr> Hi there!  I am a user with a proble integrating widgets and 
frobules, and there seems to be a problem with version 2.5-X of Twisted.
<dev> i guess you are just an idiot then!  haha idiot

Though I seriously doubt such a straightforwardly hostile exchange would 
occur, watch the punctuation in the #twisted regular's phrase.  If it 
follows the pattern

<dev> sentence with no punctuation! additional sentence

it is most likely intended as sarcasm, whereas if it is phrased with 
mroe conventional grammar and punctuation,

<dev> I guess you're just an idiot, then.  Heh.  Idiot.

Then you should really be offended :-).  Other cues of sarcasm include 
use of the word "r" (for "are"), "si" (for "is"), and "teh" (for "the") 
  We rarely make those typos unintentionally.




From ccom at gmx.net  Tue Sep 30 13:40:38 2003
From: ccom at gmx.net (ccom at gmx.net)
Date: Tue, 30 Sep 2003 19:40:38 +0200 (MEST)
Subject: [Twisted-Python] Re: serving dynamic on root and still serve static somehow
Message-ID: <3213.1064943638@www30.gmx.net>

> With isLeaf=False, the root resource will _never_ have its 
> render() method called. That is because the request for 
> the root resource is always '/', not ''. 
> (i.e., "GET / HTTP/1.1", not "GET  HTTP/1.1")
 
> '/'.split('/') == [''], which means that getChild('', request) will
> be called. Therefore, your root resource must respond to 
> getChild('', request).


This is so tricky. Your suggestion does not work because I want to pass a
parameter for the dynamic page which I read out with request.postpath[0].

You know what would solve my problem really quickly: If I would know how to
call a child manually (or not even a child but the static.File('.')
resource). I have come up with the following code but it does throw me a " does not
return a string" error:

class Container(resource.Resource):
    isLeaf = True
    
    def render(self, request):        
        if request.postpath[0] == 'static':
            return self.getChild('static', request)
        else:
            return doContainer(request)

root = Container()
root.putChild('static', static.File('.'))
site = server.Site(root) 

reactor.listenTCP(8080, site)
reactor.run()



_stephan

-- 
NEU F?R ALLE - GMX MediaCenter - f?r Fotos, Musik, Dateien...
Fotoalbum, File Sharing, MMS, Multimedia-Gru?, GMX FotoService

Jetzt kostenlos anmelden unter http://www.gmx.net

+++ GMX - die erste Adresse f?r Mail, Message, More! +++




From radix at twistedmatrix.com  Tue Sep 30 14:45:06 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 30 Sep 2003 14:45:06 -0400
Subject: [Twisted-Python] deferred folies
In-Reply-To: <1064939263.1380.4.camel@localhost>
References: <1064939263.1380.4.camel@localhost>
Message-ID: <20030930184506.GE1515@radii>

On Tue, Sep 30, 2003 at 06:27:43PM +0200, Federico Di Gregorio wrote:
> now, for a simple get session/execute/end sequence i don't want to write
> n+1 callbacks (one that waits for new_session and call execute, next one
> that wait on execute and call next, etc.) so here is what I did (inside
> a mixin class used in the client):

If you _really_ want to try avoiding all the callbacks, I think your
hack is the wrong way to do it. Use something like twisted.flow's
Deferred support: this way, you "yield" when you wait for a Deferred
to fire, and then you will be able to get the result synchronously
once your function is returned. There's probably an example somewhere
in the flow docstrings or examples.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From tv at tv.debian.net  Tue Sep 30 08:39:34 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Tue, 30 Sep 2003 15:39:34 +0300
Subject: [Twisted-Python] secsh, please compare with conch
Message-ID: <3F797986.4000306@tv.debian.net>

Hi. I hate duplicated effort (that has not real reason to be 
duplicated), and noticed this:

http://www.lag.net/~robey/secsh/

secsh is a module for python 2.3 that implements the SSH2 protocol for 
secure (encrypted and authenticated) connections to remote machines. 
unlike SSL (aka TLS), SSH2 protocol does not require heirarchical 
certificates signed by a powerful central authority. you may know SSH2 
as the protocol that replaced telnet and rsh for secure access to remote 
shells, but the protocol also includes the ability to open arbitrary 
channels to remote services across the encrypted tunnel (this is how 
sftp works, for example).

the module works by taking a socket-like object that you pass in, 
negotiating with the remote server, authenticating (using a password or 
a given private key), and opening flow-controled "channels" to the 
server, which are returned as socket-like objects. you are responsible 
for verifying that the server's host key is the one you expected to see, 
and you have control over which kinds of encryption or hashing you 
prefer (if you care), but all of the heavy lifting is done by the secsh 
module.

it is written entirely in python (no C or platform-dependent code) and 
is released under the GNU LGPL (lesser GPL).



Could the conch guy please email the author of secsh and see whether 
they could unite their efforts? Please? Thank you.




From fog at initd.org  Tue Sep 30 14:52:06 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Tue, 30 Sep 2003 20:52:06 +0200
Subject: [Twisted-Python] deferred folies
In-Reply-To: <20030930184506.GE1515@radii>
References: <1064939263.1380.4.camel@localhost>
	 <20030930184506.GE1515@radii>
Message-ID: <1064947925.1373.51.camel@localhost>

Il mar, 2003-09-30 alle 20:45, Christopher Armstrong ha scritto:
> On Tue, Sep 30, 2003 at 06:27:43PM +0200, Federico Di Gregorio wrote:
> > now, for a simple get session/execute/end sequence i don't want to write
> > n+1 callbacks (one that waits for new_session and call execute, next one
> > that wait on execute and call next, etc.) so here is what I did (inside
> > a mixin class used in the client):
> 
> If you _really_ want to try avoiding all the callbacks, I think your
> hack is the wrong way to do it. Use something like twisted.flow's

no, i don't want to avoid all the callbacks. i just don't want to write
three one-line callbacks for a simple call.

> Deferred support: this way, you "yield" when you wait for a Deferred
> to fire, and then you will be able to get the result synchronously
> once your function is returned. There's probably an example somewhere
> in the flow docstrings or examples.

but i'll look into flow anyway. :)

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
                              Viviamo in un mondo reale, Ciccio. -- Lucy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio =?ISO-8859-1?Q?=E8?= firmata
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030930/197740f4/attachment.pgp 

From bob at redivi.com  Tue Sep 30 15:05:23 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 30 Sep 2003 15:05:23 -0400
Subject: [Twisted-Python] secsh, please compare with conch
In-Reply-To: <3F797986.4000306@tv.debian.net>
Message-ID: <0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>

On Tuesday, Sep 30, 2003, at 08:39 America/New_York, Tommi Virtanen 
wrote:

> Hi. I hate duplicated effort (that has not real reason to be 
> duplicated), and noticed this:
>
> http://www.lag.net/~robey/secsh/
>
> secsh is a module for python 2.3 that implements the SSH2 protocol for 
> secure (encrypted and authenticated) connections to remote machines. 
> unlike SSL (aka TLS), SSH2 protocol does not require heirarchical 
> certificates signed by a powerful central authority. you may know SSH2 
> as the protocol that replaced telnet and rsh for secure access to 
> remote shells, but the protocol also includes the ability to open 
> arbitrary channels to remote services across the encrypted tunnel 
> (this is how sftp works, for example).
>
> the module works by taking a socket-like object that you pass in, 
> negotiating with the remote server, authenticating (using a password 
> or a given private key), and opening flow-controled "channels" to the 
> server, which are returned as socket-like objects. you are responsible 
> for verifying that the server's host key is the one you expected to 
> see, and you have control over which kinds of encryption or hashing 
> you prefer (if you care), but all of the heavy lifting is done by the 
> secsh module.
>
> it is written entirely in python (no C or platform-dependent code) and 
> is released under the GNU LGPL (lesser GPL).
>
> Could the conch guy please email the author of secsh and see whether 
> they could unite their efforts? Please? Thank you.

I emailed the secsh guy to make sure he was aware of conch, but I 
received no reply.

-bob




From greg at digitalinfo.net  Tue Sep 30 15:07:37 2003
From: greg at digitalinfo.net (Greg)
Date: Tue, 30 Sep 2003 15:07:37 -0400
Subject: [Twisted-Python] using ClientFactory from within a server
In-Reply-To: <3F78209D.50105@digitalinfo.net>
References: <200309282130.33961.greg@digitalinfo.net> <20030929032307.GB28533@intarweb.us> <3F78209D.50105@digitalinfo.net>
Message-ID: <3F79D479.7080807@digitalinfo.net>

Greg wrote:

>>>         reactor.connectTCP(host, port, factory2)
>>>         reactor.run()   
>>
>>
>>  Remove the above call to "reactor.run() and see what happens.
>>
>>>         print "Returned from sending email"
>>>         # ^ Never gets to this point
>>>   
>>
> Thanks. Now I am getting closer. But a strange (to me) thing happens. 
> When I connect to the Echo server and send it a string, it does 
> correctly run the MySMTP code. But it does not return and execute the 
> 'print "Returned from sending email"' statement until I connect to the 
> Echo server again and send another string. Any idea why this is 
> happening? Is there a way to disconnect factory2 from the reactor 
> after I have sent the "QUIT" string (or when 
> MySMTPClientFactory.clientConnectionLost() gets called)?

Never mind, I suck. I finally noticed that it was of course immediately 
returning from the reactor.connectTCP() and immediately printing 
"Returned from sending email", then getting around to actually running 
the MySMTPClientFactory stuff. I guess I have to learn about using 
deferreds. Thanks again for your previous help.




From z3p at twistedmatrix.com  Tue Sep 30 15:36:27 2003
From: z3p at twistedmatrix.com (Paul Swartz)
Date: 30 Sep 2003 15:36:27 -0400
Subject: [Twisted-Python] secsh, please compare with conch
In-Reply-To: <0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>
References: <0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>
Message-ID: <1064950588.777.5.camel@petra>

On Tue, 2003-09-30 at 15:05, Bob Ippolito wrote:
> > Could the conch guy please email the author of secsh and see whether 
> > they could unite their efforts? Please? Thank you.
> 
> I emailed the secsh guy to make sure he was aware of conch, but I 
> received no reply.

I'm gonna have a look at it in the next couple of days, but Bob, let me
know if you hear anything from him.

-p
-- 
      Paul Swartz
(o_   z3p at twistedmatrix dot com
//\   http://www.twistedmatrix.com/users/z3p.twistd/
V_/_  AIM: Z3Penguin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20030930/41013ab1/attachment.pgp 

From itamar at itamarst.org  Tue Sep 30 16:17:27 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 30 Sep 2003 16:17:27 -0400
Subject: [Twisted-Python] secsh, please compare with conch
In-Reply-To: <0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>
References: <3F797986.4000306@tv.debian.net>
	<0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>
Message-ID: <20030930161727.45aa8465.itamar@itamarst.org>

On Tue, 30 Sep 2003 15:05:23 -0400
Bob Ippolito <bob at redivi.com> wrote:

> I emailed the secsh guy to make sure he was aware of conch, but I 
> received no reply.

I also emailed him, and again, no answer.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From 2002 at weholt.org  Tue Sep 30 17:45:43 2003
From: 2002 at weholt.org (Thomas Weholt)
Date: Tue, 30 Sep 2003 23:45:43 +0200
Subject: [Twisted-Python] Serving web content over SSL
Message-ID: <007401c3879c$33654a70$0401a8c0@razor>

Can anybody provide a working, simple example of a SSL-capable web-server
using Twisted ?
Any hints or clues regarding installation of openssl or other required
library is also interesting.

Thanks in advance,
Thomas




From andrew-twisted at puzzling.org  Tue Sep 30 20:54:38 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 1 Oct 2003 10:54:38 +1000
Subject: [Twisted-Python] more on IRC frustration
In-Reply-To: <3F79BE97.50105@twistedmatrix.com>
References: <3F79BE97.50105@twistedmatrix.com>
Message-ID: <20031001005438.GA10482@frobozz>

On Tue, Sep 30, 2003 at 01:34:15PM -0400, Glyph Lefkowitz wrote:
> Mentioning IRC frustrations in my message to paul reminded me of something.
> 
> There is one stylistic hint in particular I'd like to point out, because 
> it causes the most misunderstanding, and it seems as though it may be 
> particular to our peculiar IRC subculture.  If you're in #twisted and 
> somebody says something like this:

That's all pretty obscure.  Honestly, if we're going to require people to
understand #twisted's in-jokes to be able to participate usefully, then I'd
rather we discouraged use of #twisted for giving advice and discussing code
with non-devs.  Being apparently rude to Twisted newbies is no better than
being really rude to them, in terms of damage done to Twisted's reputation,
and the reputation of its development team.

How is a #twisted newbie going to know to read this?  How are they going to
know who the regulars are?  If they get pissed off, are they really going to
feel better about being told "you just don't get our sense of humour?"

I'd like to offer a stylistic hint -- but for the development team.  If you
don't have something positive to say to a newbie, even if they seem to be
clueless, please please please consider not saying anything to them.  Let a
more sympathetic or tactful person respond instead.

We really should be trying to remove barriers to participation, not
fortifying the existing ones.  It saddens me to think that we're driving
away potential contributors because we arbitrarily require them to be
thick-skinned, regardless of their technical abilities.

-Andrew.




From jv5Hivfj6183j4 at aonehotwebdeals.com  Tue Sep 30 18:39:25 2003
From: jv5Hivfj6183j4 at aonehotwebdeals.com (jv5Hivfj6183j4 at aonehotwebdeals.com)
Date: Tue, 30 Sep 2003 20:39:25 -0200
Subject: [Twisted-Python] Individual Health Insurance Free Quotes nzpdfm exn
Message-ID: <b8i4$6329$$r743302-1$7s4f2k-blt@kbgby1bumer>

<html>
<head>
</head>
<body>
<p><font size="2" face="Arial, Helvetica, sans-serif">Over 20 Million American Families are Without Health Insurance,<br>
Are You and Your Family One of Them</font></p>
<p><font size="2" face="Arial, Helvetica, sans-serif">We Offer the Newest, Most
    Complete Quote<br>
  Service on the Internet, So Don&#8217;t Wait Any Longer</font></p>
<p><font size="2" face="Arial, Helvetica, sans-serif"><br>
  <a href="http://www152.bestspotsontheinternet.com/hinsurance/ad/text1_click">Get Your Insurance Quote Today</a>!<br>
  <font size="1">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
  If you do not wish to receive these offers in the future,<br>
  <a href="http://www152.bestspotsontheinternet.com/hinsurance/ad/text1_remove">Click Here</a> to remove yourself now<br>
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</font><br>
</font></p>
<p><br>
&nbsp;</p>
</body>
</html>tevdj  vxrh y 
c  qka i

From justinjohnson at fastmail.fm  Fri Sep 12 15:55:46 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 12 Sep 2003 15:55:46 -0600
Subject: [Twisted-Python] Technical Difficulties
In-Reply-To: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
References: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
Message-ID: <20030912215546.C49243B80E@www.fastmail.fm>

[justinj at chewie cvs]$ cvs -d:pserver:anon at twistedmatrix.com:/cvs login
Logging in to :pserver:anon at twistedmatrix.com:2401/cvs
CVS password:
Fatal error, aborting.
anon: no such user
[justinj at chewie cvs]$


I assume this is because the server isn't quite up and working yet since
the move...


On Fri, 2 Jan 2004 18:30:25 -0600, "Glyph Lefkowitz"
<glyph at twistedmatrix.com> said:
> 
> Twistedmatrix.com is about to experience some significant technical 
> difficulties.  As I am moving to Boston and the domain is hosted on my 
> personal DSL, it will have nowhere to be for a little while.
> 
> Sometime after midnight CST tonight, I will be taking the machine down 
> for a full backup in case there are problems in transit.  After that, I 
> will be removing the hard drive and putting it in a box to mail 
> somewhere in Maryland.  If it gets there, it will not be my fault if 
> service is resumed within the week.
> 
> If and when service _is_ resumed, we all owe a very big thank you to 
> Divmod, who is graciously offering to host the machine in more-or-less 
> its current form.
> 
> Just to be clear: this means that the website, email, buildbot, CVS, 
> wiki, and DNS services will _all_ be down.  If you have a personal 
> webserver on pyramid it will also be down.  I have already redirected 
> our primary DNS so that the rest of the system administration team 
> should be able to make sure that we do not lose email.
> 
> I am sorry if this is the first notification you have recieved of this 
> impending shutdown, but things have been fairly hectic over here.
> 
> Thank you.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From itamar at itamarst.org  Fri Sep 12 16:05:22 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 18:05:22 -0400
Subject: [Twisted-Python] New CVS server
In-Reply-To: <20030912215546.C49243B80E@www.fastmail.fm>
References: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
	<20030912215546.C49243B80E@www.fastmail.fm>
Message-ID: <20030912180522.63bdb355.itamar@itamarst.org>

CVS is now on cvs.twistedmatrix.com/cvs, please update your checkouts
(I'm told cvsutils  has a cvschroot).



From alienoid at is.lg.ua  Fri Sep 12 04:58:58 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Fri, 12 Sep 2003 13:58:58 +0300
Subject: [Twisted-Python] pb.Referenceable and disconnection question
Message-ID: <3F61A6F2.10409@is.lg.ua>

Hello.

Can anybody help me with the following?
I have server an lot of clients, when they connect(SSL) they pass their 
pb.Referenceable to server. Server every 2 minutes calls clients' remote 
method checkpoint(). The problem arises when i disconnect network cable 
from client side(WinXP) or from server side(linux redhat9.0) - with 
disconnected cable, server makes remoteRef.callRemote("checkpoint") and 
i don't get pb.DeadReferenceError exception(no exceptions at all, it 
prints that it's ok). Only after 15-18 minutes i see on server 
exceptions that connection was lost.

Your help is very, very appreciated.
Thanks in advance.

P.S. Client side(i use notifyOnDisconnect method) detects losing of 
connection after 3-5 seconds, but server side...
I use twisted 1.0.7rc1

Best regars,
Ruslan




From ccom at gmx.net  Thu Sep  4 00:18:37 2003
From: ccom at gmx.net (stephan)
Date: Wed, 3 Sep 2003 23:18:37 -0700
Subject: [Twisted-Python] executing .rpy in a thread
Message-ID: <000001c372ac$60dd40c0$0501000a@tp2>


Say I want to execute blocking code in a .rpy file. Can't I just execute
all the code in a separate thread? I've found the following code to
execute a function in a thread. How could I add a callback to that
thread so I could get back the whole html page back from that
"notthreadSafe" function and return it to the client (web browser)?


from twisted.internet import reactor
from twisted.python import threadable
threadable.init(1)

def notThreadSafe(x):
     """do something that isn't thread-safe"""
     # ...

def threadSafeScheduler():
    """Run in thread-safe manner."""
    reactor.callFromThread(notThreadSafe, 3) # will run
'notThreadSafe(3)'
                                             # in the event loop



_stephan




From dkuhlman at cutter.rexx.com  Thu Sep  4 17:33:02 2003
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Thu, 4 Sep 2003 16:33:02 -0700
Subject: [Twisted-Python] Examples and patterns for Twisted
Message-ID: <20030904163302.A16152@cutter.rexx.com>


I've written a document that provides and explains a number of
patterns and examples for Twisted Web applications.

I'm hoping that it might be of help to beginning Twisted
developers.  I also wrote it to try to learn more about Twisted and
also to straight out my own head.

I'd like to post it at my Web site.  But, before I make it public
or announce it, it'd be helped by reviews from Twisted experts. 
Any comments and suggestions would be appreciated.

You can find it at:

   http://www.rexx.com/~dkuhlman/twisted_patterns.html

(I've placed it at my Web site, but have not yet made it visible on
my main page.)

Thanks in advance for criticism and suggestions.

Dave

-- 
Dave Kuhlman
dkuhlman at rexx.com
http://www.rexx.com/~dkuhlman



From maoy at cis.upenn.edu  Tue Sep  9 20:22:53 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Tue, 9 Sep 2003 22:22:53 -0400 (EDT)
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
Message-ID: <Pine.LNX.4.44.0309092220190.1254-100000@forty-thieves.cis.upenn.edu>

Hi, I noticed that as a TCP client, the loseConnection() is inherited, and
without a reason argument. Why this is different from the TCPServer, where
a default reason argument is ConnectionDone?  Given such info, how to let
a TCP client protocol in connectionLost() detect it's due to a network
failure or a active close connection?

Thanks!!

Yun





From ccom at gmx.net  Wed Sep  3 22:09:21 2003
From: ccom at gmx.net (stephan)
Date: Wed, 3 Sep 2003 21:09:21 -0700
Subject: [Twisted-Python] What is  blocking code?
Message-ID: <000001c3729a$526d7120$0501000a@tp2>

When I started coding I though I will just add the deferred calls where
necessary later. Now it seems to me like I have to change the whole
architecture of my app. 

I am running twisted as a Web-server to serve .rpy files. In these files
I create quite complex html pages. In that process I also access a
database. So when I tried to adapt to the adbapi I encountered proplems
because:
     Starting from the .rpy file I call a method, which calls a method,
     ..., which calls a method, which eventually calls a method that
     queries the database. 

->So where does my blocking code start? Is it just the last method that
  queries the db or is it the first one of the chain?

->Is there a way to make my db call deferred without reversing the whole
  method chain?

->Why don't I just make all the code in the .rpy deferred?


Help very much appreciated.

_stephan





From syver at inout.no  Tue Sep  2 01:13:14 2003
From: syver at inout.no (Syver Enstad)
Date: 02 Sep 2003 09:13:14 +0200
Subject: [Twisted-Python] Technical Difficulties
In-Reply-To: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
References: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
Message-ID: <uk78r64tx.fsf@inout.no>

Wow, the sending date on this mail says: 

Date: Fri, 2 Jan 2004 18:30:25 -0600

Glyph, have you borrowed Guido's timemachine?





From lwright at mac.com  Mon Sep  8 00:25:55 2003
From: lwright at mac.com (Linden Wright)
Date: Mon, 8 Sep 2003 02:25:55 -0400
Subject: [Twisted-Python] Magical Disappearing Transport
Message-ID: <4D46DFA6-E1C5-11D7-9127-00039303E40A@mac.com>

Hi -
I have a client factory and protocol written for TCP connections, and 
whenever I try to transport.write(), it tells me that the transport == 
None. The only time that I can successfully transport.write() is in my 
protocol's connectionMade method. My protocol inherits from 
protocol.Protocol, my factory inherits from protocol.ClientFactory, and 
otherwise, my code pretty much follows the examples.
What causes the transport to be set to None?
I feel like I'm missing something very basic, and I'm new to twisted, 
so I probably am. =)
Thanks,
Linden




From konrad at wam.umd.edu  Sat Sep  6 11:07:09 2003
From: konrad at wam.umd.edu (Konrad Rokicki)
Date: Sat, 6 Sep 2003 13:07:09 -0400 (EDT)
Subject: [Twisted-Python] calling unix commands
Message-ID: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>

Hey everyone,
I'm having a problem calling a unix comand from inside a twisted program..
I do
	os.popen(cmd).readlines()
and I sporadically get:
	IOError: [Errno 4] Interrupted system call

Sounds like it might be an async problem.. is there a preferred way to do
this in twisted?

Thanks,
Konrad




From alienoid at is.lg.ua  Fri Sep  5 03:20:20 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Fri, 05 Sep 2003 12:20:20 +0300
Subject: [Twisted-Python] notifyOnDisconnect
Message-ID: <3F585554.8010600@is.lg.ua>

Hello.

I have server and a lot of clients, that connects to server and pass 
their pb.Referenceable. Every 2 minutes server calls clients' remote 
method. I store clients' references on server in a list of dictionaries 
- [{'remoteRef' : ref, 'ip' : '192.168.1.2', 'mac' : '...'}, ....] I 
call notifyOnDisconnect on clients' remoteRef. In callback i need to 
close client's firewall. How can i pass 'ip', 'mac' from dictionary to 
callback if notifyOnDisconnect passes only one parameter(this instance) 
to callback method. Help, please

Thanks in advance
Best regards,
Ruslan




From itamar at itamarst.org  Fri Sep 12 20:13:40 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:13:40 -0400
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <Pine.LNX.4.44.0309092220190.1254-100000@forty-thieves.cis.upenn.edu>
References: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>
	<Pine.LNX.4.44.0309092220190.1254-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030912221340.746b352c.itamar@itamarst.org>

On Tue, 9 Sep 2003 22:22:53 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Hi, I noticed that as a TCP client, the loseConnection() is inherited,
> and without a reason argument. Why this is different from the
> TCPServer, where a default reason argument is ConnectionDone?  Given
> such info, how to let a TCP client protocol in connectionLost() detect
> it's due to a network failure or a active close connection?

It's there for a different reason, and the client connection will in
fact get the reason it was disconnected. Hopefully there is even a test
for this.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 20:15:30 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:15:30 -0400
Subject: [Twisted-Python] Magical Disappearing Transport
In-Reply-To: <4D46DFA6-E1C5-11D7-9127-00039303E40A@mac.com>
References: <4D46DFA6-E1C5-11D7-9127-00039303E40A@mac.com>
Message-ID: <20030912221530.1b26c9c5.itamar@itamarst.org>

On Mon, 8 Sep 2003 02:25:55 -0400
Linden Wright <lwright at mac.com> wrote:


> I have a client factory and protocol written for TCP connections, and 
> whenever I try to transport.write(), it tells me that the transport ==
> 
> None. The only time that I can successfully transport.write() is in my
> 
> protocol's connectionMade method. My protocol inherits from 
> protocol.Protocol, my factory inherits from protocol.ClientFactory,
> and otherwise, my code pretty much follows the examples.

You are probably trying to call it in __init__, when obviously it can't
exist since the transport hasn't had time to be connected to the
protocol yet. You should only call it in connectionMade, dataReceived
and any methods they call.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 20:16:17 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:16:17 -0400
Subject: [Twisted-Python] calling unix commands
In-Reply-To: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>
References: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>
Message-ID: <20030912221617.20bbdb37.itamar@itamarst.org>

On Sat, 6 Sep 2003 13:07:09 -0400 (EDT)
Konrad Rokicki <konrad at wam.umd.edu> wrote:

> Hey everyone,
> I'm having a problem calling a unix comand from inside a twisted
> program.. I do
> 	os.popen(cmd).readlines()
> and I sporadically get:
> 	IOError: [Errno 4] Interrupted system call
> 
> Sounds like it might be an async problem.. is there a preferred way to
> do this in twisted?

reactor.spawnProcess. I'm pretty sure we have a HOWTO on this.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Fri Sep 12 20:20:02 2003
From: bob at redivi.com (Bob Ippolito)
Date: Fri, 12 Sep 2003 22:20:02 -0400
Subject: [Twisted-Python] calling unix commands
In-Reply-To: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>
Message-ID: <C838E4DA-E590-11D7-B303-000A95686CD8@redivi.com>

On Saturday, Sep 6, 2003, at 13:07 America/New_York, Konrad Rokicki 
wrote:

> Hey everyone,
> I'm having a problem calling a unix comand from inside a twisted 
> program..
> I do
> 	os.popen(cmd).readlines()
> and I sporadically get:
> 	IOError: [Errno 4] Interrupted system call
>
> Sounds like it might be an async problem.. is there a preferred way to 
> do
> this in twisted?

use twisted.internet.process

or the convenience function:
twisted.internet.getProcessOutput(executable, args=(), env={}, 
path='.', reactor=reactor):

see: http://www.twistedmatrix.com/documents/howto/process

-bob




From itamar at itamarst.org  Fri Sep 12 20:17:56 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:17:56 -0400
Subject: [Twisted-Python] notifyOnDisconnect
In-Reply-To: <3F585554.8010600@is.lg.ua>
References: <3F585554.8010600@is.lg.ua>
Message-ID: <20030912221756.5755d644.itamar@itamarst.org>

On Fri, 05 Sep 2003 12:20:20 +0300
Ruslan Spivak <alienoid at is.lg.ua> wrote:

> I have server and a lot of clients, that connects to server and pass 
> their pb.Referenceable. Every 2 minutes server calls clients' remote 
> method. I store clients' references on server in a list of
> dictionaries - [{'remoteRef' : ref, 'ip' : '192.168.1.2', 'mac' :
> '...'}, ....] I call notifyOnDisconnect on clients' remoteRef. In
> callback i need to close client's firewall. How can i pass 'ip', 'mac'
> from dictionary to callback if notifyOnDisconnect passes only one
> parameter(this instance) to callback method. Help, please

notifyOnDisconnect(lambda x: x.disconnected({'remoteRef' : ref, 'ip' :
'192.168.1.2', 'mac' : '...'})

or maybe

notifyOnDisconnect(lambda: x.disconnected({'remoteRef' : ref, 'ip' :
'192.168.1.2', 'mac' : '...'})

depending on the required signature. Use a lambda, anyway.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 20:20:41 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:20:41 -0400
Subject: [Twisted-Python] What is  blocking code?
In-Reply-To: <000001c3729a$526d7120$0501000a@tp2>
References: <000001c3729a$526d7120$0501000a@tp2>
Message-ID: <20030912222041.3ab0a741.itamar@itamarst.org>

On Wed, 3 Sep 2003 21:09:21 -0700
"stephan" <ccom at gmx.net> wrote:

> When I started coding I though I will just add the deferred calls
> where necessary later. Now it seems to me like I have to change the
> whole architecture of my app. 

Yes, event driven networking is that way. However, if you use woven,
Deferreds will probably be handled transparently for you, making code a
lot easier to write. Also you should note RPYs are intended for
deployment of web applications, and not as a way of structuring code for
your site.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 20:21:58 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 22:21:58 -0400
Subject: [Twisted-Python] calling unix commands
In-Reply-To: <C838E4DA-E590-11D7-B303-000A95686CD8@redivi.com>
References: <Pine.SOL.4.44.0309061303200.2271-100000@rac2.wam.umd.edu>
	<C838E4DA-E590-11D7-B303-000A95686CD8@redivi.com>
Message-ID: <20030912222158.1376dcfe.itamar@itamarst.org>

> use twisted.internet.process

Please don't use this directly, use reactor.spawnProcess instead.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Fri Sep 12 20:53:22 2003
From: bob at redivi.com (Bob Ippolito)
Date: Fri, 12 Sep 2003 22:53:22 -0400
Subject: [Twisted-Python] calling unix commands
In-Reply-To: <20030912222158.1376dcfe.itamar@itamarst.org>
Message-ID: <7047445C-E595-11D7-B303-000A95686CD8@redivi.com>

On Friday, Sep 12, 2003, at 22:21 America/New_York, Itamar 
Shtull-Trauring wrote:

>> use twisted.internet.process
>
> Please don't use this directly, use reactor.spawnProcess instead.

I meant twisted.internet.protocol.ProcessProtocol

I should've just said "read the howto" because then I couldn't be any 
more wrong than the howto, and it wouldn't be my fault :)

-bob




From maoy at cis.upenn.edu  Fri Sep 12 20:57:40 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Fri, 12 Sep 2003 22:57:40 -0400 (EDT)
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <20030912221340.746b352c.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>


On Fri, 12 Sep 2003, Itamar Shtull-Trauring wrote:

> On Tue, 9 Sep 2003 22:22:53 -0400 (EDT)
> Yun Mao <maoy at cis.upenn.edu> wrote:
> 
> > Hi, I noticed that as a TCP client, the loseConnection() is inherited,
> > and without a reason argument. Why this is different from the
> > TCPServer, where a default reason argument is ConnectionDone?  Given
> > such info, how to let a TCP client protocol in connectionLost() detect
> > it's due to a network failure or a active close connection?
> 
> It's there for a different reason, and the client connection will in
> fact get the reason it was disconnected. Hopefully there is even a test
> for this.
> 
> 

Could you tell me how to get the disconnected reason for client? In the 
clientfactory.clientConnectionLost, I always get connectionLost..

Thanks.

Yun





From itamar at itamarst.org  Fri Sep 12 21:26:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 23:26:20 -0400
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
References: <20030912221340.746b352c.itamar@itamarst.org>
	<Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030912232620.3b44e96d.itamar@itamarst.org>

On Fri, 12 Sep 2003 22:57:40 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Could you tell me how to get the disconnected reason for client? In
> the clientfactory.clientConnectionLost, I always get connectionLost..

Even for clean disconnects? What OS?

Also, why do you care?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 21:29:13 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 23:29:13 -0400
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
References: <20030912221340.746b352c.itamar@itamarst.org>
	<Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030912232913.705ab74b.itamar@itamarst.org>

On Fri, 12 Sep 2003 22:57:40 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Could you tell me how to get the disconnected reason for client? In
> the clientfactory.clientConnectionLost, I always get connectionLost..

I wrote a test, and it seems it might be a bug. I will investigate.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Fri Sep 12 21:51:59 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 13 Sep 2003 13:51:59 +1000
Subject: [Twisted-Python] executing .rpy in a thread
In-Reply-To: <000001c372ac$60dd40c0$0501000a@tp2>
References: <000001c372ac$60dd40c0$0501000a@tp2>
Message-ID: <20030913035159.GA3503@frobozz>

On Wed, Sep 03, 2003 at 11:18:37PM -0700, stephan wrote:
> 
> 
> Say I want to execute blocking code in a .rpy file. Can't I just execute
> all the code in a separate thread? I've found the following code to
> execute a function in a thread. How could I add a callback to that
> thread so I could get back the whole html page back from that
> "notthreadSafe" function and return it to the client (web browser)?

The easiest way to run code in a thread and get the result back is with
twisted.internet.threads.deferToThread.  Your Resource's render method would
need to return NOT_DONE_YET, and you'd need to add callbacks to the Deferred
from deferToThread that call request.write(...) and request.finish().

-Andrew.




From itamar at itamarst.org  Fri Sep 12 21:55:45 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 23:55:45 -0400
Subject: [Twisted-Python] loseConnection() in BaseClient
In-Reply-To: <Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
References: <20030912221340.746b352c.itamar@itamarst.org>
	<Pine.LNX.4.44.0309122252000.12477-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030912235545.69ffa51c.itamar@itamarst.org>

On Fri, 12 Sep 2003 22:57:40 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Could you tell me how to get the disconnected reason for client? In
> the clientfactory.clientConnectionLost, I always get connectionLost..

Fixed in CVS. Thanks for the bug report.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 21:58:25 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 12 Sep 2003 23:58:25 -0400
Subject: [Twisted-Python] Who runs FreeBSD and Mac OS X buildbots?
Message-ID: <20030912235825.16e9a658.itamar@itamarst.org>

Warner has coded new bandwidth saving version of buildbot. Please don't
switch to new CVS server until you've upgraded to using it.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 22:01:02 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 13 Sep 2003 00:01:02 -0400
Subject: [Twisted-Python] A big thank you to Divmod and Tummy
Message-ID: <20030913000102.476b7fd1.itamar@itamarst.org>

1. Tummy.com has donated CVS hosting on their wonderful virtual hosting
setup (hosting.tummy.com). You should try them out, they are a great
company.

2. Divmod (www.divmod.com) have donated rack space, bandwidth etc. for
our main server's new home. You should all try out Quotient and send
them patches and bug reports.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 12 22:06:43 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 13 Sep 2003 00:06:43 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
Message-ID: <20030913000643.22428e8a.itamar@itamarst.org>

Mary Gardiner, for hosting our mail

Chris Armstrong, who did lots of work on the move

Jean-Paul Calderone, assembling and bringing server to hosting

Glyph Lefkowitz, buying us a new server

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From radix at twistedmatrix.com  Fri Sep 12 22:48:31 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 00:48:31 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <20030913000643.22428e8a.itamar@itamarst.org>
References: <20030913000643.22428e8a.itamar@itamarst.org>
Message-ID: <20030913044831.GF23784@pyramid.twistedmatrix.com>

On Sat, Sep 13, 2003 at 12:06:43AM -0400, Itamar Shtull-Trauring wrote:
> Mary Gardiner, for hosting our mail
> 
> Chris Armstrong, who did lots of work on the move
> 
> Jean-Paul Calderone, assembling and bringing server to hosting
> 
> Glyph Lefkowitz, buying us a new server

Also, Thanks to Divmod (divmod.org) for paying for the hosting at Coloco
(www.coloco.com).

Tummy is also giving us free hosting on one of their virtual servers for CVS. 
http://tummy.com/. Thanks!

BTW, if anybody needs access to the new CVS server, just say so and I'll
add a user for you and move your authorized_keys from pyramid to wolfwood
(the new server).

-- 
                                Chris Armstrong
                         << radix at twistedmatrix.com >>
                http://twistedmatrix.com/users/radix.twistd/



From radix at twistedmatrix.com  Fri Sep 12 23:30:09 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 01:30:09 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <20030913044831.GF23784@pyramid.twistedmatrix.com>
References: <20030913000643.22428e8a.itamar@itamarst.org> <20030913044831.GF23784@pyramid.twistedmatrix.com>
Message-ID: <20030913053009.GH23784@pyramid.twistedmatrix.com>

On Sat, Sep 13, 2003 at 12:48:31AM -0400, Chris Armstrong wrote:
> Also, Thanks to Divmod (divmod.org) for paying for the hosting at Coloco
> (www.coloco.com).
> 
> Tummy is also giving us free hosting on one of their virtual servers for CVS. 
> http://tummy.com/. Thanks!

Duh, I didn't see itamar's first post about Divmod and Tummy. :P

> BTW, if anybody needs access to the new CVS server, just say so and I'll
> add a user for you and move your authorized_keys from pyramid to wolfwood
> (the new server).

-- 
                                Chris Armstrong
                         << radix at twistedmatrix.com >>
                http://twistedmatrix.com/users/radix.twistd/



From paul.rudin at ntlworld.com  Sat Sep 13 03:57:05 2003
From: paul.rudin at ntlworld.com (Paul Rudin)
Date: 13 Sep 2003 10:57:05 +0100
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <20030913044831.GF23784@pyramid.twistedmatrix.com>
References: <20030913000643.22428e8a.itamar@itamarst.org>
	<20030913044831.GF23784@pyramid.twistedmatrix.com>
Message-ID: <m3r82ldn9q.fsf@ntlworld.com>

Chris Armstrong <radix at twistedmatrix.com> writes:

> 
> BTW, if anybody needs access to the new CVS server, just say so and I'll
> add a user for you and move your authorized_keys from pyramid to wolfwood
> (the new server).

The web pages need to be updated with the new cvs server details.



From radix at twistedmatrix.com  Sat Sep 13 04:26:07 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 06:26:07 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <m3r82ldn9q.fsf@ntlworld.com>
References: <20030913000643.22428e8a.itamar@itamarst.org> <20030913044831.GF23784@pyramid.twistedmatrix.com> <m3r82ldn9q.fsf@ntlworld.com>
Message-ID: <20030913102607.GB18003@pyramid.twistedmatrix.com>

On Sat, Sep 13, 2003 at 10:57:05AM +0100, Paul Rudin wrote:
> Chris Armstrong <radix at twistedmatrix.com> writes:
> > BTW, if anybody needs access to the new CVS server, just say so and I'll
> > add a user for you and move your authorized_keys from pyramid to wolfwood
> > (the new server).
> 
> The web pages need to be updated with the new cvs server details.

It does? http://twistedmatrix.com/developers/cvs has been updated. Did you
notice other places that need to be updated?

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From mario at ruggier.org  Sat Sep 13 05:35:41 2003
From: mario at ruggier.org (Mario Ruggier)
Date: Sat, 13 Sep 2003 13:35:41 +0200
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <20030913102607.GB18003@pyramid.twistedmatrix.com>
Message-ID: <67B748DD-E5DE-11D7-94A0-000393756786@ruggier.org>

> On Sat, Sep 13, 2003 at 10:57:05AM +0100, Paul Rudin wrote:
>> Chris Armstrong <radix at twistedmatrix.com> writes:
>>> BTW, if anybody needs access to the new CVS server, just say so and 
>>> I'll
>>> add a user for you and move your authorized_keys from pyramid to 
>>> wolfwood
>>> (the new server).
>>
>> The web pages need to be updated with the new cvs server details.
>
> It does? http://twistedmatrix.com/developers/cvs has been updated. Did 
> you
> notice other places that need to be updated?

on this page, and apparently all other pages that include the
smaller linked logo at page-top-centre, that link has a
double trailing slash that gives an error...

mario




From radix at twistedmatrix.com  Sat Sep 13 05:41:27 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 07:41:27 -0400
Subject: [Twisted-Python] and thanks to radix, hypatia, exarkun and glyph
In-Reply-To: <67B748DD-E5DE-11D7-94A0-000393756786@ruggier.org>
References: <20030913102607.GB18003@pyramid.twistedmatrix.com> <67B748DD-E5DE-11D7-94A0-000393756786@ruggier.org>
Message-ID: <20030913114127.GA29772@pyramid.twistedmatrix.com>

On Sat, Sep 13, 2003 at 01:35:41PM +0200, Mario Ruggier wrote:
> >On Sat, Sep 13, 2003 at 10:57:05AM +0100, Paul Rudin wrote:
> on this page, and apparently all other pages that include the
> smaller linked logo at page-top-centre, that link has a
> double trailing slash that gives an error...

Huh, I thought that was fixed a long time ago. It's a problem with how
twisted.lore munges links... There's an href="/" in the template, and lore
automatically generates "../" for subpages, but I think that should only
happen for relative links. I guess I'll post a bug to the bug tracker.


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From uwe at oss4u.com  Sat Sep 13 11:27:57 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Sat, 13 Sep 2003 10:27:57 -0700
Subject: [Twisted-Python] Suspending a result
Message-ID: <200309131027.57789.uwe@oss4u.com>

Hi,

maybe I'm sitting on my brains here, but anyways:
I have a (possibly) blocking function. The core work of it is handled in a 
separate thread, so the blocking is not a problem for Twisted.
However - I need to get rid of the deferred callbacks. So basically what I'm 
trying to do is to have a class/method that wraps the blocking code WITHOUT 
returning a deferred. Instead I'd like to "suspend" the return, certainly 
without blocking twisted. So here is some "pseudocode" to clarify what I want 
to do:

# the blocking function itself
def possibly_blocking(params):
	do something blocking

Normally I would call this by
	result=possibly_blocking("Blah")

which may or may not block due to what's inside the function.
In 99% of the time it will return a result quite quickly, so no blocking.
BUT what if. So I want to make the
result=xxx
call "wait" for the result, without a deferred coming back. So I'd have to 
wrap that up somehow, so that the call seems to be waiting, but in what is 
called returning the result is delayed. 
I think one might be able to accomplish this with some kind of class that 
wraps the call and checks for the resultset once in a while, and when the 
result is there it returns the result.

It's pretty similar to the way GUI's handle modal dialogs. The original modal 
dialog call will never return, until the dialog is closed, however the rest 
of the gui doesn't block, since internally scheduling still goes on.
So can one wrap a "call / deferred / result" chain and block the caller, 
without blocking twisted completely ?

Any help would be appreciated.
(BTW: I don't want to use deferreds as the original resultset, since that 
would mean having to write tremendous state machines just to retain the order 
of the results depending on each other)

	UC

--
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417




From uwe at oss4u.com  Sat Sep 13 11:58:57 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Sat, 13 Sep 2003 10:58:57 -0700
Subject: [Twisted-Python] (UPDATE) Suspending a result
In-Reply-To: <200309131027.57789.uwe@oss4u.com>
References: <200309131027.57789.uwe@oss4u.com>
Message-ID: <200309131058.57796.uwe@oss4u.com>

I forgot to mention: This is on the server side only. So both caller and 
called are on one peer. The caller itself is called by another peer (and 
returns a defered to the remote side)

On Saturday 13 September 2003 10:27 am, Uwe C. Schroeder wrote:
> Hi,
>
> maybe I'm sitting on my brains here, but anyways:
> I have a (possibly) blocking function. The core work of it is handled in a
> separate thread, so the blocking is not a problem for Twisted.
> However - I need to get rid of the deferred callbacks. So basically what
> I'm trying to do is to have a class/method that wraps the blocking code
> WITHOUT returning a deferred. Instead I'd like to "suspend" the return,
> certainly without blocking twisted. So here is some "pseudocode" to clarify
> what I want to do:
>
> # the blocking function itself
> def possibly_blocking(params):
> 	do something blocking
>
> Normally I would call this by
> 	result=possibly_blocking("Blah")
>
> which may or may not block due to what's inside the function.
> In 99% of the time it will return a result quite quickly, so no blocking.
> BUT what if. So I want to make the
> result=xxx
> call "wait" for the result, without a deferred coming back. So I'd have to
> wrap that up somehow, so that the call seems to be waiting, but in what is
> called returning the result is delayed.
> I think one might be able to accomplish this with some kind of class that
> wraps the call and checks for the resultset once in a while, and when the
> result is there it returns the result.
>
> It's pretty similar to the way GUI's handle modal dialogs. The original
> modal dialog call will never return, until the dialog is closed, however
> the rest of the gui doesn't block, since internally scheduling still goes
> on. So can one wrap a "call / deferred / result" chain and block the
> caller, without blocking twisted completely ?
>
> Any help would be appreciated.
> (BTW: I don't want to use deferreds as the original resultset, since that
> would mean having to write tremendous state machines just to retain the
> order of the results depending on each other)
>
> 	UC
>
> --
> Open Source Solutions 4U, LLC	2570 Fleetwood Drive
> Phone:  +1 650 872 2425		San Bruno, CA 94066
> Cell:   +1 650 302 2405		United States
> Fax:    +1 650 872 2417
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-- 
	UC

--
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417




From dkuhlman at cutter.rexx.com  Sat Sep 13 12:04:19 2003
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Sat, 13 Sep 2003 11:04:19 -0700
Subject: [Twisted-Python] Examples and patterns for Twisted
In-Reply-To: <20030904163302.A16152@cutter.rexx.com>; from dkuhlman@cutter.rexx.com on Thu, Sep 04, 2003 at 04:33:02PM -0700
References: <20030904163302.A16152@cutter.rexx.com>
Message-ID: <20030913110419.A74517@cutter.rexx.com>

On Thu, Sep 04, 2003 at 04:33:02PM -0700, Dave Kuhlman wrote:
> 
> I've written a document that provides and explains a number of
> patterns and examples for Twisted Web applications.

A bit of an update:

I posted the original message a while ago during the Twisted Matrix
move.  In the meantime, Andrew Bennetts has given me some good
comments and suggestions.  So, I'll be doing a fairly serious
update.  Therefore, you may want to wait a bit for a revision
before doing a review.  Give me three or four days.

Dave

> 
> I'm hoping that it might be of help to beginning Twisted
> developers.  I also wrote it to try to learn more about Twisted and
> also to straight out my own head.
> 
> I'd like to post it at my Web site.  But, before I make it public
> or announce it, it'd be helped by reviews from Twisted experts. 
> Any comments and suggestions would be appreciated.
> 
> You can find it at:
> 
>    http://www.rexx.com/~dkuhlman/twisted_patterns.html
> 
> (I've placed it at my Web site, but have not yet made it visible on
> my main page.)
> 
> Thanks in advance for criticism and suggestions.

-- 
Dave Kuhlman
dkuhlman at rexx.com
http://www.rexx.com/~dkuhlman



From itamar at itamarst.org  Sat Sep 13 19:38:22 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 13 Sep 2003 21:38:22 -0400
Subject: [Twisted-Python] Please add changelog entry for all resolved issues in bug tracker
Message-ID: <20030913213822.146d3d1b.itamar@itamarst.org>

This will make sure changelog is more up to date and allow people
reading changelog to refer to issue tracker.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From radix at twistedmatrix.com  Sat Sep 13 19:44:22 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sat, 13 Sep 2003 21:44:22 -0400
Subject: [Twisted-Python] Potential fix for vhost+distrib (issue125)
Message-ID: <20030914014422.GB29772@pyramid.twistedmatrix.com>

Can everyone who cares about vhosts with distrib (Alex Levy, Thomas
Raschbacher) update to latest CVS and try putting a ResourceSubscription
behind a vhost?

I've tested twistedmatrix.com's setup with this fix, and it works (i.e.,
UserDirectories, static.Files, CGIs, etc).


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From glyph at twistedmatrix.com  Sat Sep 13 23:09:58 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 14 Sep 2003 01:09:58 -0400
Subject: [Twisted-Python] Please add changelog entry for all resolved
 issues in bug tracker
In-Reply-To: <20030913213822.146d3d1b.itamar@itamarst.org>
References: <20030913213822.146d3d1b.itamar@itamarst.org>
Message-ID: <3F63F826.5060905@twistedmatrix.com>

Itamar Shtull-Trauring wrote:
> This will make sure changelog is more up to date and allow people
> reading changelog to refer to issue tracker.

Personally I've been trying to adopt a debian-esque way of closing bugs 
by adding it to CVS commit messages - adding a '(Closes xxx)' to any CVS 
commit message that closes an issue.

The changelog has been so ill-used that I don't think many people pay 
attention any more.




From itamar at itamarst.org  Sat Sep 13 23:22:26 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 14 Sep 2003 01:22:26 -0400
Subject: [Twisted-Python] Please add changelog entry for all resolved
 issues in bug tracker
In-Reply-To: <3F63F826.5060905@twistedmatrix.com>
References: <20030913213822.146d3d1b.itamar@itamarst.org>
	<3F63F826.5060905@twistedmatrix.com>
Message-ID: <20030914012226.0486f498.itamar@itamarst.org>

On Sun, 14 Sep 2003 01:09:58 -0400
Glyph Lefkowitz <glyph at twistedmatrix.com> wrote:

> Personally I've been trying to adopt a debian-esque way of closing
> bugs by adding it to CVS commit messages - adding a '(Closes xxx)' to
> any CVS commit message that closes an issue.
> 
> The changelog has been so ill-used that I don't think many people pay 
> attention any more.

That too - but the changelog is how I do release notes, and it's not
*that* bad. But yes, issues in commit messages are probably a good idea
too.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Sat Sep 13 23:43:30 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 14 Sep 2003 15:43:30 +1000
Subject: [Twisted-Python] Re: Web server with Python
In-Reply-To: <6o24mvcmksid33t4s9b8cbsrnctl5n2o6m@4ax.com>
References: <tnr1mvgnt45urvu6n4q6dso3eto73hfr1m@4ax.com> <sx68b.29387$Hb.450091@news4.e.nsc.no> <bjr3ea$m5rr9$1@ID-139865.news.uni-berlin.de> <gvs2mvcgmji0s536475c14oa5tm7cigk13@4ax.com> <mailman.1063352060.32640.python-list@python.org> <6o24mvcmksid33t4s9b8cbsrnctl5n2o6m@4ax.com>
Message-ID: <20030914054330.GA899@frobozz>

[CC'ing the Twisted mailing list]

On Fri, Sep 12, 2003 at 08:05:59PM +0200, Patrick Useldinger wrote:
> On Fri, 12 Sep 2003 17:33:34 +1000, Andrew Bennetts
> <andrew-pythonlist at puzzling.org> wrote:
> 
> >> Does Twisted work well with Python 2.3?
> >
> >Yes, current versions support 2.3 without any problems.
> 
> Version 1.0.6 refuses to install, though, complaining it requires Python
> 2.2.

Eek!  Does 1.0.7 (just released) work any better?  Also, what platform are
you using, and are you installing from the source .tar.gz or something else?

-Andrew.




From foom at fuhm.net  Sun Sep 14 04:22:27 2003
From: foom at fuhm.net (James Y. Knight)
Date: Sun, 14 Sep 2003 06:22:27 -0400
Subject: [Twisted-Python] Patch to allow deferreds to be returned from resource.render
Message-ID: <56DC7FB4-E69D-11D7-8255-003065F305CC@fuhm.net>

Ooh lets try sending this mail one more time. Apparently the combined 
suckage of three different programs made my last mail not get through:
1) Apple Mail sucks and doesn't quote the "Full Name" automatically, so 
I end up with a non-RFC-conforming From: with a "." outside of quotes 
or the email address.
2) Exim sucks and doesn't fix it (OTOH, Sendmail does fix it, which is 
why i've never seen this problem before!)
3) Mailman sucks as well, and gets completely confused by this slightly 
non-conformant address format, and thinks my email address is 
"jamesy.knight".

Anyways, on to the original message:
===

This patch lets you return a deferred from resource.render (the obvious 
thing to do) and have it work. As opposed to the current method where 
you need to return NOT_DONE_YET and restructure all your code to call 
request.write(...). That should still work too, though. I'd stick this 
on the bug tracker but I forgot my password. (anyone able to reset for 
me? :)

James

--- server.py~  Mon Jul 21 00:09:52 2003
+++ server.py   Tue Sep  9 15:02:09 2003
@@ -160,56 +160,8 @@
          except:
              self.processingFailed(failure.Failure())

-
-    def render(self, resrc):
-        try:
-            body = resrc.render(self)
-        except UnsupportedMethod, e:
-            allowedMethods = e.allowedMethods
-            if (self.method == "HEAD") and ("GET" in allowedMethods):
-                # We must support HEAD (RFC 2616, 5.1.1).  If the
-                # resource doesn't, fake it by giving the resource
-                # a 'GET' request and then return only the headers,
-                # not the body.
-                log.msg("Using GET to fake a HEAD request for %s" %
-                        (resrc,))
-                self.method = "GET"
-                body = resrc.render(self)
-
-                if body is NOT_DONE_YET:
-                    log.msg("Tried to fake a HEAD request for %s, but "
-                            "it got away from me." % resrc)
-                    # Oh well, I guess we won't include the content 
length.
-                else:
-                    self.setHeader('content-length', str(len(body)))
-
-                self.write('')
-                self.finish()
-                return
-
-            if self.method in (supportedMethods):
-                # We MUST include an Allow header
-                # (RFC 2616, 10.4.6 and 14.7)
-                self.setHeader('Allow', allowedMethods)
-                s = ('''Your browser approached me (at %(URI)s) with'''
-                     ''' the method "%(method)s".  I only allow'''
-                     ''' the method%(plural)s %(allowed) here.''' % {
-                    'URI': self.uri,
-                    'method': self.method,
-                    'plural': ((len(allowedMethods) > 1) and 's') or 
'',
-                    'allowed': string.join(allowedMethods, ', ')
-                    })
-                epage = error.ErrorPage(http.NOT_ALLOWED,
-                                        "Method Not Allowed", s)
-                body = epage.render(self)
-            else:
-                epage = error.ErrorPage(http.NOT_IMPLEMENTED, "Huh?",
-                                        """I don't know how to treat 
a"""
-                                        """ %s request."""
-                                        % (self.method))
-                body = epage.render(self)
-        # end except UnsupportedMethod
-
+    def _cbRender(self, body, resrc):
+
          if body == NOT_DONE_YET:
              return
          if type(body) is not types.StringType:
@@ -232,6 +184,58 @@
              self.setHeader('content-length', str(len(body)))
              self.write(body)
          self.finish()
+
+    def _ebRender(self, failure, resrc):
+        failure.trap(UnsupportedMethod)
+        e = failure.value
+        allowedMethods = e.allowedMethods
+        if (self.method == "HEAD") and ("GET" in allowedMethods):
+            # We must support HEAD (RFC 2616, 5.1.1).  If the
+            # resource doesn't, fake it by giving the resource
+            # a 'GET' request and then return only the headers,
+            # not the body.
+            log.msg("Using GET to fake a HEAD request for %s" %
+                    (resrc,))
+            self.method = "GET"
+            body = resrc.render(self)
+
+            if body is NOT_DONE_YET:
+                log.msg("Tried to fake a HEAD request for %s, but "
+                        "it got away from me." % resrc)
+                # Oh well, I guess we won't include the content length.
+            else:
+                self.setHeader('content-length', str(len(body)))
+
+            self.write('')
+            self.finish()
+            return
+
+        if self.method in (supportedMethods):
+            # We MUST include an Allow header
+            # (RFC 2616, 10.4.6 and 14.7)
+            self.setHeader('Allow', allowedMethods)
+            s = ('''Your browser approached me (at %(URI)s) with'''
+                 ''' the method "%(method)s".  I only allow'''
+                 ''' the method%(plural)s %(allowed) here.''' % {
+                'URI': self.uri,
+                'method': self.method,
+                'plural': ((len(allowedMethods) > 1) and 's') or '',
+                'allowed': string.join(allowedMethods, ', ')
+                })
+            epage = error.ErrorPage(http.NOT_ALLOWED,
+                                    "Method Not Allowed", s)
+            body = epage.render(self)
+        else:
+            epage = error.ErrorPage(http.NOT_IMPLEMENTED, "Huh?",
+                                    """I don't know how to treat a"""
+                                    """ %s request."""
+                                    % (self.method))
+            body = epage.render(self)
+
+    def render(self, resrc):
+        defer.maybeDeferred(resrc.render, 
self).addErrback(self._ebRender, resrc).addCallback(self._cbRender, 
resrc).addErrback(self.processingFailed)
+
+

      def processingFailed(self, reason):
          log.err(reason)




From itamar at itamarst.org  Sun Sep 14 10:06:29 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 14 Sep 2003 12:06:29 -0400
Subject: [Twisted-Python] Patch to allow deferreds to be returned from
 resource.render
In-Reply-To: <56DC7FB4-E69D-11D7-8255-003065F305CC@fuhm.net>
References: <56DC7FB4-E69D-11D7-8255-003065F305CC@fuhm.net>
Message-ID: <20030914120629.46c15f9a.itamar@itamarst.org>

Thanks for writing this - add it to the issue tracker please so we don't
lose it?



From andrew-twisted at puzzling.org  Sun Sep 14 18:25:58 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 15 Sep 2003 10:25:58 +1000
Subject: [Twisted-Python] Patch to allow deferreds to be returned from resource.render
In-Reply-To: <20030914120629.46c15f9a.itamar@itamarst.org>
References: <56DC7FB4-E69D-11D7-8255-003065F305CC@fuhm.net> <20030914120629.46c15f9a.itamar@itamarst.org>
Message-ID: <20030915002558.GA1990@frobozz>

On Sun, Sep 14, 2003 at 12:06:29PM -0400, Itamar Shtull-Trauring wrote:
> Thanks for writing this - add it to the issue tracker please so we don't
> lose it?

Uh, he said:
[...]
> >                                                         I'd stick this
> > on the bug tracker but I forgot my password. (anyone able to reset for
> > me? :)

-Andrew.




From mesozoic at polynode.com  Mon Sep 15 00:13:55 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Mon, 15 Sep 2003 02:13:55 -0400
Subject: [Twisted-Python] Potential fix for vhost+distrib (issue125)
In-Reply-To: <20030914014422.GB29772@pyramid.twistedmatrix.com>
References: <20030914014422.GB29772@pyramid.twistedmatrix.com>
Message-ID: <1063606434.766.7.camel@hyla>

On Sat, 2003-09-13 at 21:44, Chris Armstrong wrote:
> Can everyone who cares about vhosts with distrib (Alex Levy, Thomas
> Raschbacher) update to latest CVS and try putting a ResourceSubscription
> behind a vhost?
> 
> I've tested twistedmatrix.com's setup with this fix, and it works (i.e.,
> UserDirectories, static.Files, CGIs, etc).

I've tried this out with my setup, and it works. Thanks. :)

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20030915/952d625b/attachment.sig>

From Richard.Townsend at edl.uk.eds.com  Mon Sep 15 02:50:39 2003
From: Richard.Townsend at edl.uk.eds.com (Richard.Townsend at edl.uk.eds.com)
Date: Mon, 15 Sep 2003 09:50:39 +0100
Subject: [Twisted-Python] Server errors using Twisted with Python 2.3
Message-ID: <76ADB8C376C3D31193F50008C7E6D3B2F3E178@EWHKA005>

Since installing Python 2.3 on HP-UX11i, I keep getting 'Resource
temporarily unavailable' errors in server applications.

E.g. using ../doc/examples/simpleserv.py & ../doc/examples/simpleclient.py:

"richardt" capulet:doc/examples > python simpleserv.py 
Traceback (most recent call last):
  File "/opt/python/lib/python2.3/site-packages/twisted/python/log.py", line
65, in callWithLogger
    callWithContext({"system": lp}, func, *args, **kw)
  File "/opt/python/lib/python2.3/site-packages/twisted/python/log.py", line
52, in callWithContext
    return context.call({ILogContext: newCtx}, func, *args, **kw)
  File "/opt/python/lib/python2.3/site-packages/twisted/python/context.py",
line 32, in callWithContext
    return func(*args,**kw)
  File
"/opt/python/lib/python2.3/site-packages/twisted/internet/default.py", line
510, in _doReadOrWrite
    why = getattr(selectable, method)()
--- <exception caught here> ---
  File "/opt/python/lib/python2.3/site-packages/twisted/internet/tcp.py",
line 595, in doRead
    skt, addr = self.socket.accept()
  File "/opt/python/lib/python2.3/socket.py", line 167, in accept
    sock, addr = self._sock.accept()
socket.error: (11, 'Resource temporarily unavailable')


"richardt" capulet:doc/examples > python simpleclient.py
Server said: hello, world!
connection lost
Connection lost - goodbye!


The transaction appears to work, but the log file is filling up with these
errors. This happens with Twisted 1.0.6 and 1.0.7.

It doesn't happen when using Python 2.2

Can anyone advise how to fix this problem?

regards,
Richard Townsend
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20030915/2e1e6033/attachment.html>

From SKuzminski at fairisaac.com  Mon Sep 15 08:18:44 2003
From: SKuzminski at fairisaac.com (Kuzminski, Stefan R)
Date: Mon, 15 Sep 2003 07:18:44 -0700
Subject: [Twisted-Python] stack trace
Message-ID: <7646464ACC9B5347A4A5C57729D74A550369BD5D@srfmsg100.corp.fairisaac.com>

Hi,

 

I'm using twisted to build a process management tool.  I have a TCP
server that runs reactor.spawnProcess(), it runs the process, but then
generates this stack trace.  I'm at a bit of a loss as to how to resolve
this..  Is there perhaps another approach I should try?  I need to
manage long running processes on remote boxes.

 

Thanks, 

Stefan

 

 

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/twisted/python/context.py",
line 32, i\

n callWithContext

    return func(*args,**kw)

  File
"/usr/lib/python2.3/site-packages/twisted/internet/pollreactor.py",
line\

 173, in _doReadOrWrite

    selectable.connectionLost(f)

  File "/usr/lib/python2.3/site-packages/twisted/internet/process.py",
line 431\

, in connectionLost

    self.maybeCallProcessEnded()

  File "/usr/lib/python2.3/site-packages/twisted/internet/process.py",
line 394\

, in maybeCallProcessEnded

    self.reapProcess()

--- <exception caught here> ---

  File "/usr/lib/python2.3/site-packages/twisted/internet/process.py",
line 301\

, in reapProcess

    pid, status = os.waitpid(self.pid, os.WNOHANG)

exceptions.OSError: [Errno 10] No child processes

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20030915/d45d7e70/attachment.html>

From itamar at itamarst.org  Mon Sep 15 09:32:53 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 15 Sep 2003 11:32:53 -0400
Subject: [Twisted-Python] Server errors using Twisted with Python 2.3
In-Reply-To: <76ADB8C376C3D31193F50008C7E6D3B2F3E178@EWHKA005>
References: <76ADB8C376C3D31193F50008C7E6D3B2F3E178@EWHKA005>
Message-ID: <20030915113253.3c17e4cb.itamar@itamarst.org>

On Mon, 15 Sep 2003 09:50:39 +0100
Richard.Townsend at edl.uk.eds.com wrote:

> Since installing Python 2.3 on HP-UX11i, I keep getting 'Resource
> temporarily unavailable' errors in server applications.

Add a bug report in the issue tracker (twistedmatrix.com/bugs) and
assign it to me and I'll fix it soon.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From gsuneethav at hotmail.com  Mon Sep 15 12:17:44 2003
From: gsuneethav at hotmail.com (suneetha velicheti)
Date: Mon, 15 Sep 2003 11:17:44 -0700
Subject: [Twisted-Python] How to save the content(string) of a DOM node into a file?
Message-ID: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>

Hi,
   I wanted to save the content of a DOM node into a file and want my 
browser to prompt me with "save as" window. I already set the browser 
preferences. Right now the content of the node is just displaying in the 
browser window. Instead of that I want to promt the user to save that 
content into a file with "save as" option window. Are there any DOM helper 
methods to do this?

Thanks for the help,
Suneetha.

_________________________________________________________________
Try MSN Messenger 6.0 with integrated webcam functionality! 
http://www.msnmessenger-download.com/tracking/reach_webcam




From daniel at hawton.org  Mon Sep 15 15:58:46 2003
From: daniel at hawton.org (Daniel Hawton)
Date: Mon, 15 Sep 2003 14:58:46 -0700
Subject: [Twisted-Python] Good example of Network+Tkinter use
In-Reply-To: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
References: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
Message-ID: <3F663616.4030001@hawton.org>

I am trying to write a client for IRC that handles its own network data 
parsing, but has multiple Tkinter Dialogs.  I was wondering if there was 
a decent example of this, or something similar, and where it would be. 
Tutorials work too except I learn better by examples of implementation 
for some reason.

Thanks in advance,
Daniel




From radix at twistedmatrix.com  Mon Sep 15 18:41:12 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Mon, 15 Sep 2003 20:41:12 -0400
Subject: [Twisted-Python] How to save the content(string) of a DOM node into a file?
In-Reply-To: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
References: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
Message-ID: <20030916004112.GB2795@pyramid.twistedmatrix.com>

On Mon, Sep 15, 2003 at 11:17:44AM -0700, suneetha velicheti wrote:
> Hi,
>   I wanted to save the content of a DOM node into a file and want my 
> browser to prompt me with "save as" window. I already set the browser 
> preferences. Right now the content of the node is just displaying in the 
> browser window. Instead of that I want to promt the user to save that 
> content into a file with "save as" option window. Are there any DOM helper 
> methods to do this?

see the "write[pretty]xml" method.
-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From bob at redivi.com  Mon Sep 15 19:15:00 2003
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 15 Sep 2003 21:15:00 -0400
Subject: [Twisted-Python] How to save the content(string) of a DOM node into a file?
In-Reply-To: <20030916004112.GB2795@pyramid.twistedmatrix.com>
Message-ID: <31B2BC5C-E7E3-11D7-8876-000A95686CD8@redivi.com>

On Monday, Sep 15, 2003, at 20:41 America/New_York, Chris Armstrong 
wrote:

> On Mon, Sep 15, 2003 at 11:17:44AM -0700, suneetha velicheti wrote:
>> Hi,
>>   I wanted to save the content of a DOM node into a file and want my
>> browser to prompt me with "save as" window. I already set the browser
>> preferences. Right now the content of the node is just displaying in 
>> the
>> browser window. Instead of that I want to promt the user to save that
>> content into a file with "save as" option window. Are there any DOM 
>> helper
>> methods to do this?
>
> see the "write[pretty]xml" method.

I think he's talking about rigging the Content-Type header so that the 
browser thinks it doesn't know how to display the content, and will 
prompt the user to save the document.  It really has nothing to do with 
DOM at all.

Try:
	request.setHeader('content-type', 'application/octet-stream')

In your render method.

-bob




From andrew-twisted at puzzling.org  Mon Sep 15 19:17:56 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 16 Sep 2003 11:17:56 +1000
Subject: [Twisted-Python] How to save the content(string) of a DOM node into a file?
In-Reply-To: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
References: <Law10-F89IW7lJDoWuZ000124b8@hotmail.com>
Message-ID: <20030916011756.GA4093@frobozz>

On Mon, Sep 15, 2003 at 11:17:44AM -0700, suneetha velicheti wrote:
> Hi,
>   I wanted to save the content of a DOM node into a file and want my 
> browser to prompt me with "save as" window. I already set the browser 
> preferences. Right now the content of the node is just displaying in the 
> browser window. Instead of that I want to promt the user to save that 
> content into a file with "save as" option window. Are there any DOM helper 
> methods to do this?

So you're serving XML from a Twisted web server?  I think you want to call
"request.setHeader('content-type', 'application/octet-stream')", or
something like that.  That should convince the browser to save it rather
than display it (this applies to pretty much anything you could serve, not
just XML).

There's also a Content-Disposition header that is supposed to do this, but
I've never been able to figure out how to make it work reliably across
different browsers.

-Andrew.




From itamar at itamarst.org  Mon Sep 15 21:24:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 15 Sep 2003 23:24:20 -0400
Subject: [Twisted-Python] Release notes for 1.0.7
Message-ID: <20030915232420.56ca0b7e.itamar@itamarst.org>

Please email me anything I missed so I can fix before I email c.l.p and
c.l.p.a

What's New in 1.0.7
===================

- Client Jabber support.

- twisted.xish, an XML package supporting a DOM-like API and a
  XPATH-like API.

- Woven web templating toolkit is now much faster, and no longer
  supports the interim APIs it had during development.

- Security tightening in the web server, especially on Windows.

- XML-RPC server is now easier to extend, and can publish the XML-RPC
  introspection API as an option.

- Working minimum and maximum sizes for database connection pools.

- New connection API for Perspective Broker, allowing easy SSL
  support, reconnection, etc..

- Better lenient HTML parsing in microdom.

- Many improvements to mail protocols (SMTP, POP3, IMAP).

- Continued switch to updated cred unified authentication backend
  in the various protocols supported by Twisted.

- SOAP support now requires SOAPpy 0.10.1 or later.

- mailmail, a replacement for the common usage of command-line 
  /usr/sbin/sendmail.

- Bug fixes, documentation improvements, more tests.



From andrew-twisted at puzzling.org  Tue Sep 16 00:38:50 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 16 Sep 2003 16:38:50 +1000
Subject: [Twisted-Python] Anti-Verisign DNS Filter.
Message-ID: <20030916063850.GE4093@frobozz>

Robert Thomson, a workmate of mine, wrote this hack to filter DNS responses
to thwart Verisign's stupid wildcard on root-level domains.  It's simple but
does the job.  Enjoy.

--- snip ---
#!/usr/bin/python
#
# Run this as root with the command
#   twistd -y anti-verisign-dns.py

from twisted.internet import app, defer
from twisted.protocols import dns
from twisted.names import client, server

roots = [
('198.41.0.4',53), ('128.9.0.107',53), ('192.33.4.12',53), ('128.8.10.90',53),
('192.203.230.10',53), ('192.5.5.241',53), ('192.112.36.4',53),
('128.63.2.53',53), ('192.36.148.17',53), ('192.58.128.30',53),
('193.0.14.129',53), ('198.32.64.12',53), ('202.12.27.33',53), ]

#roots = [('202.129.64.42',53)]   # just use my ISP's DNS

VERISIGN='@^n\x0b' # 64.94.110.11

class AntiVerisignResolver(client.Resolver):
    def filterAnswers(self, message):
        if message.trunc:
            return self.queryTCP(message.queries).addCallback(self.filterAnswers)
        else:
            for i in range(len(message.answers)):
                x = message.answers[i]
                if x.type==1 and x.payload and x.payload.address==VERISIGN:
                    message.answers[i] = None
            return (filter(lambda x:x,message.answers),
                    message.authority,
                    message.additional)

verbosity = 0
resolver = AntiVerisignResolver(servers=roots)
f = server.DNSServerFactory(clients=[resolver], verbose=verbosity)
p = dns.DNSDatagramProtocol(f)
f.noisy = p.noisy = verbosity

application = app.Application('Non caching anti-verisign domain name resolver')
application.listenUDP(53, p)
application.listenTCP(53, f)
--- snip ---

-Andrew.




From stephen at thorne.id.au  Mon Sep 15 19:17:15 2003
From: stephen at thorne.id.au (Stephen Thorne.)
Date: Tue, 16 Sep 2003 11:17:15 +1000
Subject: [Twisted-Python] Small woven application example
Message-ID: <200309161117.15176.stephen@thorne.id.au>

Hi.

I did some hacking with twisted.web and woven, just to try and teach myself 
how to go about writing a web application using twisted, bearing in mind I 
write php in my day job, this was a little hard.

http://thorne.ath.cx:3000/~stephen/wikiexample.xhtml
is the result of my efforts, and you can see it running at 
http://thorne.ath.cx:8081/MainPage/

I've got there the original code I started with (using Resource and a fairly 
phpish methodology) and what I finished with.

In my little venture back into the realm of twisted, I see the following 
lacking in the documentation:

 * The varied Views and Widgets are poorly documented, I found myself 
inventing what was needed, then going into Twisted/twisted/web/woven/ and 
reading widgets.py and view.py - and discovering that they already existed.

 * There is very little mapping between "This is how you would do it in a 
silly framework" -> "This is how twisted makes it cleaner and easier"

 * The pitfalls.
	* e.g. For submitting forms and the implicit header "Location:" redirects 
which obliterate your post values. (When you have <form action="/Foo/bar">, 
but you'll get redirected to "/Foo/bar/")
	* the interface to the factories should be written down on a piece of card 
and stuck to the monitor. Swapping 'request' and 'model' doesn't help things.

As such, I intend to go through all the views and widgets, and write a small 
example piece of code, showing what each of them does, and what 
inputs/outputs they take. I also intend to take some php idioms and show a 
mapping from them to twisted.

Fortuantely, I've got loads of experience with lore (I recently used it to 
typeset a 90+ page tutorial for a camp I'm leading on in 2 weeks, 
http://thorne.ath.cx:3000/lwdoc/index.xhtml if you're interested)

Please send replies CC: stephen at thorne.id.au as I'm not currently subscribed 
to the list.

Regards,
Stephen Thorne




From itamar at itamarst.org  Tue Sep 16 12:25:06 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 16 Sep 2003 14:25:06 -0400
Subject: [Twisted-Python] Perspective Broker in 1.0.7
Message-ID: <20030916142506.15f0f875.itamar@itamarst.org>

If you are using PB code, you will start getting deprecation warnings
when you upgrade to 1.0.7. This is due to switching to:

1. A new connection API that doesn't suck.
2. New cred support.

#1 is documented in the 1.0.7 Howtos. #2 isn't.

You can however see examples of how to do #2 in CVS, specifically these
two files:

http://cvs.twistedmatrix.com/cvs/doc/examples/pbecho.py?rev=1.9&content-type=text/vnd.viewcvs-markup
http://cvs.twistedmatrix.com/cvs/doc/examples/pbechoclient.py?rev=1.10&content-type=text/vnd.viewcvs-markup

and compare them to doc/examples/pbecho(client).py in 1.0.7 or older CVS
versions.

Some of Twisted's internal code doesn't use this new API either. By 1.1
all docs, examples and code in Twisted will have switched to the new
API. The old API will of course continue to be supported for some time,
but it is recommended you switch as the new API is much cleaner and
better designed.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From ccom at gmx.net  Tue Sep 16 12:38:14 2003
From: ccom at gmx.net (Jerome Jushima)
Date: Tue, 16 Sep 2003 20:38:14 +0200 (MEST)
Subject: [Twisted-Python] Re : executing .rpy in a thread
Message-ID: <7173.1063737494@www59.gmx.net>

With the help of your hint I have come up with the following code. For
simplicity's sake I don't use .rpys here since it shouldn't change the approach.
What happens when I run this code and open the servers root in a webbrowser is
that I get a page saying "NOT_DONE_YET." Also when I get rid of the
quotation marks in the return statement it does not seem to work. Python just tells
me that it does not know NOT_DONE_YET.

I am also not coherent in my head of how to pass the request variable to my
doLongPageGeneration function.

Is it correct how I  registered the callbacks?

Thanks to all the twisted gurus,  _stephan

---------------------------------------------------start

 from twisted.web import server, resource, static, script
 from twisted.internet import reactor
 from twisted.internet import threads

def doLongPageGeneration():
     return "<html><b>H</b>ello, <b>W</b>orld!</html>"

class Simple(resource.Resource):
     isLeaf = True
     def render(self, request):
         d = threads.deferToThread(doLongPageGeneration)
         d.addCallback(request.write)
         d.addCallback(request.finish)
         return "NOT_DONE_YET"


site = server.Site(Simple())
reactor.listenTCP(8080, site)

reactor.run()

------------------------------------------------------end

> The easiest way to run code in a thread and get the result back is with 
> twisted.internet.threads.deferToThread.  Your Resource's render method 
> would need to return NOT_DONE_YET, and you'd need to add callbacks to 
> the Deferred from deferToThread that call request.write(...) and 
> request.finish().

>> Say I want to execute blocking code in a .rpy file. Can't I just 
>> execute all the code in a separate thread? I've found the following 
>> code to execute a function in a thread. How could I add a callback to 
>> that thread so I could get back the whole html page back from that 
>> "notthreadSafe" function and return it to the client
>> (web browser)?


-- 
+++ GMX - die erste Adresse fr Mail, Message, More! +++

Getestet von Stiftung Warentest: GMX FreeMail (GUT), GMX ProMail (GUT)
(Heft 9/03 - 23 e-mail-Tarife: 6 gut, 12 befriedigend, 5 ausreichend)

Jetzt selbst kostenlos testen: http://www.gmx.net




From mesozoic at polynode.com  Tue Sep 16 12:55:56 2003
From: mesozoic at polynode.com (Alex Levy)
Date: Tue, 16 Sep 2003 14:55:56 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <7173.1063737494@www59.gmx.net>
References: <7173.1063737494@www59.gmx.net>
Message-ID: <1063738556.774.9.camel@hyla>

On Tue, 2003-09-16 at 14:38, Jerome Jushima wrote:
> class Simple(resource.Resource):
>      isLeaf = True
>      def render(self, request):
>          d = threads.deferToThread(doLongPageGeneration)
>          d.addCallback(request.write)
>          d.addCallback(request.finish)
>          return "NOT_DONE_YET"

Should be:
        return server.NOT_DONE_YET

-- 
Alex Levy
WWW: http://mesozoic.geecs.org

"Never let your sense of morals prevent you from doing what is right."
-- Salvor Hardin, Isaac Asimov's _Foundation_

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20030916/9b4b2c04/attachment.sig>

From itamar at itamarst.org  Tue Sep 16 13:10:26 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 16 Sep 2003 15:10:26 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <7173.1063737494@www59.gmx.net>
References: <7173.1063737494@www59.gmx.net>
Message-ID: <20030916151026.209df2d3.itamar@itamarst.org>

On Tue, 16 Sep 2003 20:38:14 +0200 (MEST)
"Jerome Jushima" <ccom at gmx.net> wrote:

>          d.addCallback(request.finish)

Should be d.addCallback(lambda _: request.finish()) since it takes no
arguments.
However, this approach in general is wrong. Using Woven is probably a
better way of dealing with this, since it handles Deferreds
transparently.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Tue Sep 16 13:10:56 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 16 Sep 2003 15:10:56 -0400
Subject: [Twisted-Python] Perspective Broker in 1.0.7
In-Reply-To: <20030916142506.15f0f875.itamar@itamarst.org>
References: <20030916142506.15f0f875.itamar@itamarst.org>
Message-ID: <20030916151056.35f4ac14.itamar@itamarst.org>

Also see sandbox/jml/pb-go*.py.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From bob at redivi.com  Tue Sep 16 13:20:34 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 16 Sep 2003 15:20:34 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <7173.1063737494@www59.gmx.net>
Message-ID: <D86C6D06-E87A-11D7-A81E-000A95686CD8@redivi.com>

On Tuesday, Sep 16, 2003, at 14:38 America/New_York, Jerome Jushima 
wrote:

> With the help of your hint I have come up with the following code. For
> simplicity's sake I don't use .rpys here since it shouldn't change the 
> approach.
> What happens when I run this code and open the servers root in a 
> webbrowser is
> that I get a page saying "NOT_DONE_YET." Also when I get rid of the
> quotation marks in the return statement it does not seem to work. 
> Python just tells
> me that it does not know NOT_DONE_YET.

This is how you want to do it, there should be no surprises with this 
approach (it handles failures, logs to stdout):

from twisted.web import server, resource, static, script
from twisted.internet import reactor, threads
from twisted.python import log
import sys

def doLongPageGeneration(request):
     # you *could* inspect the request object if you needed to from here
     # but I wouldn't *change* it from this thread!
     return "<html><b>H</b>ello, <b>W</b>orld! - Your user agent is 
%s</html>" % request.getHeader('user-agent')

def writeRequestAndFinish(data, request):
     request.write(data)
     request.finish()

class Simple(resource.Resource):
     isLeaf = True
     def render(self, request):
         threads.deferToThread(doLongPageGeneration, 
request).addCallback(writeRequestAndFinish, 
request).addErrback(request.processingFailed)
         return server.NOT_DONE_YET

site = server.Site(Simple())
reactor.listenTCP(8080, site)
# I'm not sure if this is strictly necessary, but it seems like a good 
idea.
reactor.initThreads()
log.startLogging(sys.stdout)
reactor.run()




From bob at redivi.com  Tue Sep 16 13:50:45 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 16 Sep 2003 15:50:45 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <20030916151026.209df2d3.itamar@itamarst.org>
Message-ID: <1002DE77-E87F-11D7-A81E-000A95686CD8@redivi.com>

On Tuesday, Sep 16, 2003, at 15:10 America/New_York, Itamar 
Shtull-Trauring wrote:

> On Tue, 16 Sep 2003 20:38:14 +0200 (MEST)
> "Jerome Jushima" <ccom at gmx.net> wrote:
>
>>          d.addCallback(request.finish)
>
> Should be d.addCallback(lambda _: request.finish()) since it takes no
> arguments.
> However, this approach in general is wrong. Using Woven is probably a
> better way of dealing with this, since it handles Deferreds
> transparently.

It's definitely not wrong to go without Woven in a lot of cases, such 
as non-XML output, but I provided a Pretty Good Example of how to do 
what he asked in my previous message in this thread.

-bob




From foom at fuhm.net  Tue Sep 16 14:28:38 2003
From: foom at fuhm.net (James Y Knight)
Date: Tue, 16 Sep 2003 16:28:38 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <20030916151026.209df2d3.itamar@itamarst.org>
Message-ID: <5AADD54A-E884-11D7-9A7C-003065F305CC@fuhm.net>

On Tuesday, September 16, 2003, at 03:10  PM, Itamar Shtull-Trauring 
wrote:

> Should be d.addCallback(lambda _: request.finish()) since it takes no
> arguments.
> However, this approach in general is wrong. Using Woven is probably a
> better way of dealing with this, since it handles Deferreds
> transparently.

What you *really* want to do is apply the patch I posted earlier that 
makes render handle deferreds properly, and then do:

---cut---
from twisted.web import server, resource, static, script
from twisted.internet import reactor
from twisted.internet import threads

def doLongPageGeneration():
      return "<html><b>H</b>ello, <b>W</b>orld!</html>"

class Simple(resource.Resource):
      isLeaf = True
      def render(self, request):
          return threads.deferToThread(doLongPageGeneration)

site = server.Site(Simple())
reactor.listenTCP(8080, site)

reactor.run()
---cut---

James




From egor at iplus.ru  Wed Sep 17 02:58:29 2003
From: egor at iplus.ru (Egor Cheshkov)
Date: Wed, 17 Sep 2003 12:58:29 +0400
Subject: [Twisted-Python] callFromThread with return
Message-ID: <3F682235.5000106@iplus.ru>

Hello! Suppose I run task in worker thread (e.g. database transaction) 
and I need to do some IO (PB call) and get the result from it during 
transaction. Since I run not in reactor's thread it's ok to block and 
wait for the result. I know that there is callFromThread but it never 
return any result. Is it possible to implement something like 
callFromThread that can block, wait for result and return it?

Thanks in advance,
Egor.





From itamar at itamarst.org  Wed Sep 17 06:50:00 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 17 Sep 2003 08:50:00 -0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <3F682235.5000106@iplus.ru>
References: <3F682235.5000106@iplus.ru>
Message-ID: <20030917085000.2a9120e9.itamar@itamarst.org>

On Wed, 17 Sep 2003 12:58:29 +0400
Egor Cheshkov <egor at iplus.ru> wrote:

> Hello! Suppose I run task in worker thread (e.g. database transaction)
> 
> and I need to do some IO (PB call) and get the result from it during 
> transaction. Since I run not in reactor's thread it's ok to block and 
> wait for the result. I know that there is callFromThread but it never 
> return any result. Is it possible to implement something like 
> callFromThread that can block, wait for result and return it?

As documented in the threading howto, you can use
twisted.internet.threads.deferToThread.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From egor at iplus.ru  Wed Sep 17 10:34:41 2003
From: egor at iplus.ru (Egor Cheshkov)
Date: Wed, 17 Sep 2003 20:34:41 +0400
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <20030917085000.2a9120e9.itamar@itamarst.org>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org>
Message-ID: <3F688D21.3080905@iplus.ru>

Itamar Shtull-Trauring ?????:

>On Wed, 17 Sep 2003 12:58:29 +0400
>Egor Cheshkov <egor at iplus.ru> wrote:
>
>  
>
>>Hello! Suppose I run task in worker thread (e.g. database transaction)
>>
>>and I need to do some IO (PB call) and get the result from it during 
>>transaction. Since I run not in reactor's thread it's ok to block and 
>>wait for the result. I know that there is callFromThread but it never 
>>return any result. Is it possible to implement something like 
>>callFromThread that can block, wait for result and return it?
>>    
>>
>
>As documented in the threading howto, you can use
>twisted.internet.threads.deferToThread.
>
If I understand right, I should use deferToThread to shedule long 
running task from main thread (that running event loop), i need 
different thing. I need to shedule a method to be run in the main event 
loop from another thread. It is the thing that callFromThread does, but 
callFromThread does not return anything. I need to get result from such 
call. Is it possible?

Egor.








From justinjohnson at fastmail.fm  Wed Sep 17 11:31:02 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 17 Sep 2003 11:31:02 -0600
Subject: [Twisted-Python] Quotient Problems
Message-ID: <20030917173102.AB8333BFFE@www.fastmail.fm>

I'm not sure if Quotient questions should go to this list...?

I installed the latest Quotient from CVS, including all its dependencies
and Twisted itself from CVS.  I got it installed on my RH9 Linux box and
am running an instance of Quotient.

I added an IMAP grabber, successfully I think, and now when I go to the
Home page it says...

Recent Items
Nothing is new under the sun.
Current Status
myaddress at my.domain@myimap.host.com
Initializing...

(Note, I changed the address and host names above for this email.)  It
always says initializing whenever I return to this page.  What does this
mean?  How do I get to my inbox?

Thanks.
-Justin



From itamar at itamarst.org  Wed Sep 17 12:16:33 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 17 Sep 2003 14:16:33 -0400
Subject: [Twisted-Python] Quotient Problems
In-Reply-To: <20030917173102.AB8333BFFE@www.fastmail.fm>
References: <20030917173102.AB8333BFFE@www.fastmail.fm>
Message-ID: <20030917141633.7fd1b490.itamar@itamarst.org>

On Wed, 17 Sep 2003 11:31:02 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> I'm not sure if Quotient questions should go to this list...?

They should not - see
http://www.divmod.net/users/roundup.twistd/quotient/ for issue tracker,
http://divmod.net/users/mailman.twistd/listinfo/divmod-dev is the list.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From rprice at collegenet.com  Wed Sep 17 18:16:46 2003
From: rprice at collegenet.com (Ray Price)
Date: 17 Sep 2003 17:16:46 -0700
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <D86C6D06-E87A-11D7-A81E-000A95686CD8@redivi.com>
References: <D86C6D06-E87A-11D7-A81E-000A95686CD8@redivi.com>
Message-ID: <1063844206.4669.530.camel@hotpepper.unival.com>

How would I create a .tap file to execute the example below?

Ray 



On Tue, 2003-09-16 at 12:20, Bob Ippolito wrote:
> On Tuesday, Sep 16, 2003, at 14:38 America/New_York, Jerome Jushima 
> wrote:
> 
> > With the help of your hint I have come up with the following code. For
> > simplicity's sake I don't use .rpys here since it shouldn't change the 
> > approach.
> > What happens when I run this code and open the servers root in a 
> > webbrowser is
> > that I get a page saying "NOT_DONE_YET." Also when I get rid of the
> > quotation marks in the return statement it does not seem to work. 
> > Python just tells
> > me that it does not know NOT_DONE_YET.
> 
> This is how you want to do it, there should be no surprises with this 
> approach (it handles failures, logs to stdout):
> 
> from twisted.web import server, resource, static, script
> from twisted.internet import reactor, threads
> from twisted.python import log
> import sys
> 
> def doLongPageGeneration(request):
>      # you *could* inspect the request object if you needed to from here
>      # but I wouldn't *change* it from this thread!
>      return "<html><b>H</b>ello, <b>W</b>orld! - Your user agent is 
> %s</html>" % request.getHeader('user-agent')
> 
> def writeRequestAndFinish(data, request):
>      request.write(data)
>      request.finish()
> 
> class Simple(resource.Resource):
>      isLeaf = True
>      def render(self, request):
>          threads.deferToThread(doLongPageGeneration, 
> request).addCallback(writeRequestAndFinish, 
> request).addErrback(request.processingFailed)
>          return server.NOT_DONE_YET
> 
> site = server.Site(Simple())
> reactor.listenTCP(8080, site)
> # I'm not sure if this is strictly necessary, but it seems like a good 
> idea.
> reactor.initThreads()
> log.startLogging(sys.stdout)
> reactor.run()
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python





From andrew-twisted at puzzling.org  Wed Sep 17 19:17:12 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 18 Sep 2003 11:17:12 +1000
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <1063844206.4669.530.camel@hotpepper.unival.com>
References: <D86C6D06-E87A-11D7-A81E-000A95686CD8@redivi.com> <1063844206.4669.530.camel@hotpepper.unival.com>
Message-ID: <20030918011712.GB11240@frobozz>

On Wed, Sep 17, 2003 at 05:16:46PM -0700, Ray Price wrote:
> How would I create a .tap file to execute the example below?
> 
> On Tue, 2003-09-16 at 12:20, Bob Ippolito wrote:
[...]
> > reactor.run()

It calls reactor.run, so you can't use twistd on this file.  Just run it
directly, it's an ordinary Python script.

-Andrew.




From kevin.m.turner at pobox.com  Thu Sep 18 01:18:45 2003
From: kevin.m.turner at pobox.com (Kevin Turner)
Date: Thu, 18 Sep 2003 00:18:45 -0700
Subject: [Twisted-Python] ANN: CVSToys 1.0.9 (for Twisted 1.0.7)
Message-ID: <1063869524.11160.27.camel@troglodyte.funhouse>

Greetings,

It is my pleasure to inform you that CVSToys 1.0.9 has been released. 
That means you can finally get rid of all those DeprecationWarnings
which fill your screen every time you commit, if you've upgraded your
Twisted version past 1.0.6.

Things are changing in PBService -- in particular, there may no longer
be more than one Service (or a Service and a Manhole) on a single port. 
This may break things for some of you, but it also may have the pleasant
side-effect of it may fixing that long-standing bug with freshcvs
crapping out if it fails to grab the default pb port on start-up.  

Unfortunately I can't guarantee that .tap files with PBServices or
manholes in them will still work, you may have to re-mktap them.  And
you can expect more changes around PBService when Twisted 1.0.8 comes
out, as we migrate to newcred.

(Just tuning in?  CVSToys contains Fresh CVS, a CVS commit monitoring
daemon which can deliver commit messages over a variety of protocols
(e-mail, chat, web, etc.) and automate other tasks, such as back-up or
auto-check-out.)

You can find CVSToys at http://purl.net/net/CVSToys
A big thanks to Divmod (www.divmod.com) for sponsoring our web hosting,
and tummy.com for the CVS server.

Share and enjoy,

 - Kevin

-- 
The moon is last quarter, 57.4% illuminated, 21.4 days old.



From syver at inout.no  Thu Sep 18 03:46:03 2003
From: syver at inout.no (Syver Enstad)
Date: 18 Sep 2003 11:46:03 +0200
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <3F688D21.3080905@iplus.ru>
References: <3F682235.5000106@iplus.ru>
	<20030917085000.2a9120e9.itamar@itamarst.org>
	<3F688D21.3080905@iplus.ru>
Message-ID: <upthysa3o.fsf@inout.no>

Egor Cheshkov <egor at iplus.ru> writes:

> Itamar Shtull-Trauring ?????:
> 
> >On Wed, 17 Sep 2003 12:58:29 +0400
> >Egor Cheshkov <egor at iplus.ru> wrote:
> >
> >
> >>Hello! Suppose I run task in worker thread (e.g. database transaction)
> >>
> >> and I need to do some IO (PB call) and get the result from it
> >> during transaction. Since I run not in reactor's thread it's ok to
> >> block and wait for the result. I know that there is callFromThread
> >> but it never return any result. Is it possible to implement
> >> something like callFromThread that can block, wait for result and
> >> return it?
> >>
> >
> >As documented in the threading howto, you can use
> >twisted.internet.threads.deferToThread.
> >
> If I understand right, I should use deferToThread to shedule long
> running task from main thread (that running event loop), i need
> different thing. I need to shedule a method to be run in the main
> event loop from another thread. It is the thing that callFromThread
> does, but callFromThread does not return anything. I need to get
> result from such call. Is it possible?

Can't you pass yourself and have the method that you pass to
callFromThread callback on a method on yourself with the results?

 




From andrew-twisted at puzzling.org  Thu Sep 18 04:29:04 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 18 Sep 2003 20:29:04 +1000
Subject: [Twisted-Python] callFromThread with return
In-Reply-To: <upthysa3o.fsf@inout.no>
References: <3F682235.5000106@iplus.ru> <20030917085000.2a9120e9.itamar@itamarst.org> <3F688D21.3080905@iplus.ru> <upthysa3o.fsf@inout.no>
Message-ID: <20030918102904.GA13575@frobozz>

On Thu, Sep 18, 2003 at 11:46:03AM +0200, Syver Enstad wrote:
> Egor Cheshkov <egor at iplus.ru> writes:
> 
> > If I understand right, I should use deferToThread to shedule long
> > running task from main thread (that running event loop), i need
> > different thing. I need to shedule a method to be run in the main
> > event loop from another thread. It is the thing that callFromThread
> > does, but callFromThread does not return anything. I need to get
> > result from such call. Is it possible?
> 
> Can't you pass yourself and have the method that you pass to
> callFromThread callback on a method on yourself with the results?

But that won't run the callback in the worker thread.

Here's the situation in dodgy ascii art:

           Main Thread                      
      (Twisted reactor, etc)
                |
                v
                |
                \
                |\
                | ->----------------------callInThread starts
                v                        Worker Thread running
                |                            worker_function()
                |                                  |
                |                                  v
                |                                  |
                |                                  /
                |                                 /.
          callFromThread------------------------<- .
      causes other_func() to                       . 
         run in Main Thread                        .
                |                                  .
                v                                  .
                |                          Worker Thread waits
                |                         for other_func result
                |                                  .
                |                                  .
         But how does the                          .
     Main Thread pass a result                     .
       to Worker Thread and                        .
       resume its execution?                       ?

There needs to be a wrapper function around callFromThread that blocks the
worker thread on a threading.Event or similar, and then causes the Event to
be fired when the function finishes, and returns the result.

Or, in untested code:

-----
import threading, sys
from twisted.internet import reactor

def blockingCallFromThread(func):
    e = threading.Event()
    l = []
    def wrapped_func():
        try:
            l.append(func)
        except:
            l.append(sys.exc_info())
            l.append(0)
        else:
            l.append(1)
        e.set()
    reactor.callFromThread(wrapped_func)
    e.wait()
    result, ok = l
    if ok:
        return result
    else:
        # Whee!  Cross-thread exceptions!
        raise result[0], result[1], result[2]
----

This is utterly untested.  It probably should be tested and added to
twisted.internet.util or t.i.threads, though.

-Andrew.




From snesbitt at cobaltgroup.com  Thu Sep 18 10:47:40 2003
From: snesbitt at cobaltgroup.com (Nesbitt, Steve)
Date: Thu, 18 Sep 2003 09:47:40 -0700
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
Message-ID: <25160AB2660F8B449892B0EB9C29C1650B5777@ex-sea-is2.cobaltgroup.com>

All:

Newbie alert!

I would like to implement an XML-RPC server as a plugin (using the QuoteD
how-to as an example) and can't figure out how to do so. In particular I
don't understand how to create the protocol created as part of the factory.

Can anyone provide some clues/code?

Thanks!

-steve

Steve Nesbitt
Senior Configuration Manager
The Cobalt Group
snesbitt at cobaltgroup.com





This e-mail transmission contains information intended only for the use of
the recipient(s) named above. Further, it contains information that may be
privileged and confidential. If you are not the intended recipient, you are
hereby notified that any dissemination, distribution, or copying of this
message (including any attachments) is strictly prohibited. If you have
received this e-mail in error, please notify the sender by reply e-mail and
then delete this message from your mail system. Thank you for your
compliance.



From itamar at itamarst.org  Thu Sep 18 11:10:11 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 18 Sep 2003 13:10:11 -0400
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
In-Reply-To: <25160AB2660F8B449892B0EB9C29C1650B5777@ex-sea-is2.cobaltgroup.com>
References: <25160AB2660F8B449892B0EB9C29C1650B5777@ex-sea-is2.cobaltgroup.com>
Message-ID: <20030918131011.1ab283f0.itamar@itamarst.org>

On Thu, 18 Sep 2003 09:47:40 -0700
"Nesbitt, Steve" <snesbitt at cobaltgroup.com> wrote:

> I would like to implement an XML-RPC server as a plugin (using the
> QuoteD how-to as an example) and can't figure out how to do so. In
> particular I don't understand how to create the protocol created as
> part of the factory.

Protocols are created by the factory when the port you are listening
gets an incoming connection - the factory's buildProtocol is called and
the resulting protocol is connected to the transport for the new
connection.

In any case, Twisted already has a nice XML-RPC server framework,
documented at http://twistedmatrix.com/documents/howto/xmlrpc - it
should support anything you might want to do with a XML-RPC server.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From snesbitt at cobaltgroup.com  Thu Sep 18 11:27:12 2003
From: snesbitt at cobaltgroup.com (Nesbitt, Steve)
Date: Thu, 18 Sep 2003 10:27:12 -0700
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
Message-ID: <25160AB2660F8B449892B0EB9C29C1650B5778@ex-sea-is2.cobaltgroup.com>

Thanks Itamar.

I've been reviewing the howto and have that working.

My next step, however, was to turn that example into an actual plugin
following the QuoteD plugin example which has three parts:
- quoters.py => contains business logic
- quoteproto.py => contains the protocol definition
- quotetap.py => application interface/wrapper

My problem is coming up with the xmlrpc equivalent of quoteproto.py which
looks like this:


from twisted.internet.protocol import Factory, Protocol
from twisted.internet.app import Application

class QOTD(Protocol):

    def connectionMade(self):
        self.transport.write(self.factory.quoter.getQuote()+'\r\n')
        self.transport.loseConnection()

class QOTDFactory(Factory):

    protocol = QOTD

    def __init__(self, quoter):
        self.quoter = quoter




What I can't figure out what this should look like for an xmlrpc server. It
appears (to me at least) that a fundamental function of the factory method
is to set the protocol. But I don't know what this should be for xml-rpc and
since twisted appears to do the right thing already, I don't really want to
rewrite the connectionMade, etc. methods.

I suppose the core issue is that in order to create a plugin I need to call:
app.listenTCP(port, factory) and I don't know what factory object to pass or
how to get it.

Thanks,

-steve

Steve Nesbitt
Senior Configuration Manager
The Cobalt Group
snesbitt at cobaltgroup.com

-----Original Message-----
From: Itamar Shtull-Trauring [mailto:itamar at itamarst.org]
Sent: Thursday, September 18, 2003 10:10 AM
To: twisted-python at twistedmatrix.com
Subject: Re: [Twisted-Python] Newbie:XMLRPC Server as plugin?


On Thu, 18 Sep 2003 09:47:40 -0700
"Nesbitt, Steve" <snesbitt at cobaltgroup.com> wrote:

> I would like to implement an XML-RPC server as a plugin (using the
> QuoteD how-to as an example) and can't figure out how to do so. In
> particular I don't understand how to create the protocol created as
> part of the factory.

Protocols are created by the factory when the port you are listening
gets an incoming connection - the factory's buildProtocol is called and
the resulting protocol is connected to the transport for the new
connection.

In any case, Twisted already has a nice XML-RPC server framework,
documented at http://twistedmatrix.com/documents/howto/xmlrpc - it
should support anything you might want to do with a XML-RPC server.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting

_______________________________________________
Twisted-Python mailing list
Twisted-Python at twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python





This e-mail transmission contains information intended only for the use of
the recipient(s) named above. Further, it contains information that may be
privileged and confidential. If you are not the intended recipient, you are
hereby notified that any dissemination, distribution, or copying of this
message (including any attachments) is strictly prohibited. If you have
received this e-mail in error, please notify the sender by reply e-mail and
then delete this message from your mail system. Thank you for your
compliance.



From itamar at itamarst.org  Thu Sep 18 11:56:36 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 18 Sep 2003 13:56:36 -0400
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
In-Reply-To: <25160AB2660F8B449892B0EB9C29C1650B5778@ex-sea-is2.cobaltgroup.com>
References: <25160AB2660F8B449892B0EB9C29C1650B5778@ex-sea-is2.cobaltgroup.com>
Message-ID: <20030918135636.3bd3fb4d.itamar@itamarst.org>

On Thu, 18 Sep 2003 10:27:12 -0700
"Nesbitt, Steve" <snesbitt at cobaltgroup.com> wrote:

> What I can't figure out what this should look like for an xmlrpc
> server. It appears (to me at least) that a fundamental function of the
> factory method is to set the protocol. But I don't know what this
> should be for xml-rpc and since twisted appears to do the right thing
> already, I don't really want to rewrite the connectionMade, etc.
> methods.

You don't need to implement a factory or protocol, since the framework
already implements them for you. You just need to subclass XMLRPC and
run it as shown. You could of course have a generic business logic
object that the XML-RPC interface acts as an interface to.

Writing factories and protocols is only necessary if you are
implementing a new protocol. HTTP is already implemented for you, so you
need not bother :)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From daniel at hawton.org  Thu Sep 18 16:51:53 2003
From: daniel at hawton.org (Daniel Hawton)
Date: Thu, 18 Sep 2003 15:51:53 -0700
Subject: [Twisted-Python] Easy GTK+Twisted+Networking Tutorial
Message-ID: <3F6A3709.2030008@hawton.org>

I am still learning GTK, and I want to write an application that shows 
information based on data received in a Socket.  I was told Twisted 
helps with this, and am looking for an example/simple tutorial that 
could explain how to use Twisted, instead of having to use Threads.

Thanks,
Daniel




From dnfesp at hotmail.com  Thu Sep 18 19:23:47 2003
From: dnfesp at hotmail.com (Daniel Fernndez)
Date: Fri, 19 Sep 2003 01:23:47 +0000
Subject: [Twisted-Python] Newbie:XMLRPC Server as plugin?
Message-ID: <BAY2-F558aszmeeUwMJ0000f7fe@hotmail.com>

Sorry, I'm newbie too..

I got confused also the first time, then I realized that what I wanted was 
just a server not a protocol (in my case a SOAP one). But then I found the 
way things are explained is running your server as a regular python script, 
but that prevents you from taking advantage from the facilities given by 
running your service like e.g. twistd -f myserver.tap. So I realized that 
what I really need is an Application so I can have a tap file. Everything 
seems easy but then while following the examples (the last one in Creating 
XML-RPC Servers and Clients - modified to get a tap file) I get an 
unexpected error. I'm using Twisted 1.0.7 with SOAPpy 0.10.2 and python 2.3 
on windows 2000

the code is a bit modified, I removed the quoters logic and changed the last 
line from:
application.run(save=0)    --------->   application.save("start")
in order to get a tap file

<code>
from twisted.web import soap, xmlrpc, resource, server

class XMLRPCQuoter(xmlrpc.XMLRPC):
    def xmlrpc_quote(self):
        return 'Hola'

class SOAPQuoter(soap.SOAPPublisher):
    def soap_quote(self):
        return 'Hola'

def main():
    from twisted.internet.app import Application
    app = Application("xmlrpc")
    root = resource.Resource()
    root.putChild('RPC2', XMLRPCQuoter())
    root.putChild('SOAP', SOAPQuoter())
    app.listenTCP(7080, server.Site(root))
    return app

application = main()

if __name__ == '__main__':
    application.save("start")
</code>

I can't find what is going wrong here, this is the log I'm getting when I 
try to run xmlrpc-start.tap

D:\Python23\Lib\site-packages>twistd -f xmlrpc-start.tap
2003/09/18 20:08 Hora de verano de Mxico [-] Log opened.
2003/09/18 20:08 Hora de verano de Mxico [-] twistd 1.0.7 
(D:\PYTHON23\python.e
xe 2.3.0) starting up
2003/09/18 20:08 Hora de verano de Mxico [-] reactor class: 
twisted.internet.de
fault.SelectReactor
2003/09/18 20:08 Hora de verano de Mxico [-] Loading xmlrpc-start.tap...
2003/09/18 20:08 Hora de verano de Mxico [-] Warning!  Loading from 
__main__: X
MLRPCQuoter
2003/09/18 20:08 Hora de verano de Mxico [-] Traceback (most recent call 
last):

2003/09/18 20:08 Hora de verano de Mxico [-]   File 
"D:\PYTHON23\Lib\site-packa
ges\twisted\scripts\twistd.py", line 317, in runApp
2003/09/18 20:08 Hora de verano de Mxico [-]     application = 
loadApplication(
config, passphrase)
2003/09/18 20:08 Hora de verano de Mxico [-]   File 
"D:\PYTHON23\Lib\site-packa
ges\twisted\scripts\twistd.py", line 210, in loadApplication
2003/09/18 20:08 Hora de verano de Mxico [-]     return decode(filename, 
data)
2003/09/18 20:08 Hora de verano de Mxico [-]   File 
"D:\PYTHON23\Lib\site-packa
ges\twisted\scripts\twistd.py", line 188, in decode
2003/09/18 20:08 Hora de verano de Mxico [-]     application = 
pickle.loads(dat
a)
2003/09/18 20:08 Hora de verano de Mxico [-] AttributeError: ('Ephemeral 
instan
ce has no __call__ method', <twisted.persisted.styles.Ephemeral instance at 
0x00
FEB580>, ())
2003/09/18 20:08 Hora de verano de Mxico [-] Failed to load application: 
('Ephe
meral instance has no __call__ method', <twisted.persisted.styles.Ephemeral 
inst
ance at 0x00FEB580>, ())
2003/09/18 20:08 Hora de verano de Mxico [-] Traceback (most recent call 
last):

          File "D:\PYTHON23\scripts\twistd.py", line 32, in ?
            run()
          File "D:\PYTHON23\Lib\site-packages\twisted\scripts\twistd.py", 
line 4
48, in run
            runApp(config)
        --- <exception caught here> ---
          File "D:\PYTHON23\Lib\site-packages\twisted\scripts\twistd.py", 
line 3
17, in runApp
            application = loadApplication(config, passphrase)
          File "D:\PYTHON23\Lib\site-packages\twisted\scripts\twistd.py", 
line 2
10, in loadApplication
            return decode(filename, data)
          File "D:\PYTHON23\Lib\site-packages\twisted\scripts\twistd.py", 
line 1
88, in decode
            application = pickle.loads(data)
        exceptions.AttributeError: ('Ephemeral instance has no __call__ 
method',
<twisted.persisted.styles.Ephemeral instance at 0x00FEB580>, ())


Failed to load application: ('Ephemeral instance has no __call__ method', 
<twist
ed.persisted.styles.Ephemeral instance at 0x00FEB580>, ())
2003/09/18 20:08 Hora de verano de Mxico [-]


after that it just return to the prompt.



any help would be really appreciated.

thanks

_________________________________________________________________
Protect your PC - get McAfee.com VirusScan Online 
http://clinic.mcafee.com/clinic/ibuy/campaign.asp?cid=3963




From teratorn at world-net.net  Fri Sep 19 02:34:50 2003
From: teratorn at world-net.net (Eric Mangold)
Date: Fri, 19 Sep 2003 03:34:50 -0500
Subject: [Twisted-Python] Patch to shoutcast protocol
Message-ID: <200309190334.50135.teratorn@world-net.net>

Here is a patch to shoutcast.py. This makes it not crash when the server 
doesn't provide MP3 metadata. It also allows the user to request metadata or 
not.

-Eric

P.S. The diff came out weird, but it works as it should :)



-------------- next part --------------
A non-text attachment was scrubbed...
Name: shoutcast.py.diff
Type: text/x-diff
Size: 2607 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030919/4ffaa92e/attachment-0002.diff>

From uwe at oss4u.com  Fri Sep 19 03:30:26 2003
From: uwe at oss4u.com (Uwe C. Schroeder)
Date: Fri, 19 Sep 2003 02:30:26 -0700
Subject: [Twisted-Python] Off topic question
Message-ID: <200309190230.26272.uwe@oss4u.com>

Hi,

this is off topic, but I thought it is the best place to ask.
I've written a program for the insurance business. It's based on a twisted pb 
server and wxPython clients. My customer possibly needs to extend the 
software pretty soon and I think I will be "outgunned" by that demand.
Therefor I look for someone who possibly (but not necessarily) has a 
background in insurance and is adept programming python using twisted and 
wxPython. I know this is not the place for a job offer, nonetheless this is 
the the place where the skilled people gather.
It's not determined if this expansion will happen, but I want to stay ahead. 
So if anyone has spare time for a project and could need some cash, get in 
touch with me. Payment is negotiable. To put the cards on the table, you'd 
have to surrender the copyright, so we'd need to adjust the payment 
accordingly.
Anyone interested ? Drop me a mail.

PS: I give a sh... about "computer science degree needed". All I need is 
someone who can do the job - and if you learned it at home on your C64, are a 
groceries salesperson and can do the job, that's fine with me :-) 

Thanks

	UC

--
Open Source Solutions 4U, LLC	2570 Fleetwood Drive
Phone:  +1 650 872 2425		San Bruno, CA 94066
Cell:   +1 650 302 2405		United States
Fax:    +1 650 872 2417




From justinjohnson at fastmail.fm  Fri Sep 19 05:42:08 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 19 Sep 2003 05:42:08 -0600
Subject: [Twisted-Python] UDP Factories
Message-ID: <20030919114208.3086E3C45C@www.fastmail.fm>

I have a UDP protocol that subclasses DatagramProtocol.  It is working
fine, but I decided I wanted a protocol factory so I can keep track of
the list of clients.  I added the following class, which doesn't nothing
currently...

class MyProtoFactory(Factory):
    protocol = MyProto
                                                                                
And then changed my reactor.listenUDP line to...

    reactor.listenUDP(config.SERVER_PORT, MyProtoFactory())


[justinj at chewie travis]$ ./udpserver.py
Traceback (most recent call last):
  File "./udpserver.py", line 166, in ?
    reactor.listenUDP(config.SERVER_PORT, MyProtoFactory())
  File
  "/usr/local/lib/python2.3/site-packages/twisted/internet/default.py",
  line 180, in listenUDP
    p = udp.Port(port, protocol, interface, maxPacketSize, self)
  File "/usr/local/lib/python2.3/site-packages/twisted/internet/udp.py",
  line 66, in __init__
    assert isinstance(proto, protocol.DatagramProtocol)
AssertionError


Any idea what I'm doing wrong?  The examples showed a UDP factory, but I
don't quite see how this would work.

Thanks.
-Justin



From itamar at itamarst.org  Fri Sep 19 09:03:20 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 11:03:20 -0400
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919114208.3086E3C45C@www.fastmail.fm>
References: <20030919114208.3086E3C45C@www.fastmail.fm>
Message-ID: <20030919110320.7840bec7.itamar@itamarst.org>

On Fri, 19 Sep 2003 05:42:08 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> I have a UDP protocol that subclasses DatagramProtocol.  It is working
> fine, but I decided I wanted a protocol factory so I can keep track of
> the list of clients.  I added the following class, which doesn't
> nothing currently...

You will notice the docs say nothing about factories. This is because
listenUDP does not accept factories :) If you want to keep track of
clients you will have to do it yourself by dispatching based on the
host/port of a received datagram.

Why are you using UDP, by the way?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 19 09:06:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 11:06:51 -0400
Subject: [Twisted-Python] Patch to shoutcast protocol
In-Reply-To: <200309190334.50135.teratorn@world-net.net>
References: <200309190334.50135.teratorn@world-net.net>
Message-ID: <20030919110651.65b197d2.itamar@itamarst.org>

On Fri, 19 Sep 2003 03:34:50 -0500
Eric Mangold <teratorn at world-net.net> wrote:

> Here is a patch to shoutcast.py. This makes it not crash when the
> server doesn't provide MP3 metadata. It also allows the user to
> request metadata or not.

Add the patch to the issue tracker (twistedmatrix.com/issues) and assign
it to me and I will look at it sometime soon.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 19 10:42:31 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 12:42:31 -0400
Subject: [Twisted-Python] Getting to 1.1 -- calling all CVS committers
Message-ID: <20030919124231.4be3f088.itamar@itamarst.org>

Thanks to Moshe, twisted.application has landed. In order to reach 1.1,
there's a few things we need to do:

1. Better new cred docs.
2. Update PB docs to talk about new cred.
3. Update application docs.
4. Update all examples and listings to use PB new cred and new app.
5. Update all taps to use new app.
6. Update manhole, words, distrib etc. to use new cred.

By 1.1, we should have no mention or usage of the old APIs in our docs,
examples and code. This is going to take some work, so please pitch in
and help.

If you don't have CVS, patches to any of the above are welcome!

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From exarkun at intarweb.us  Fri Sep 19 15:50:26 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 19 Sep 2003 17:50:26 -0400
Subject: [Twisted-Python] Application refactor
Message-ID: <20030919215026.GA903@intarweb.us>

  Services are severely broken with the new code.  twisted.mail is
completely non-functional.

  Jp

-- 
"Pascal is Pascal is Pascal is dog meat."
                -- M. Devine and P. Larson, Computer Science 340
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030919/42aa084d/attachment.sig>

From justinjohnson at fastmail.fm  Fri Sep 19 16:18:32 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Fri, 19 Sep 2003 16:18:32 -0600
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919110320.7840bec7.itamar@itamarst.org>
References: <20030919114208.3086E3C45C@www.fastmail.fm> <20030919110320.7840bec7.itamar@itamarst.org>
Message-ID: <20030919221832.714673C4B4@www.fastmail.fm>

Yeah I sent this email out real quick without looking at the doc.  Sorry.

I'm using UDP because the device I'm coding for uses UDP.  Twisted sure
saved me a ton of time.

Out of curiosity, why doesn't listenUDP accept Factories?

On Fri, 19 Sep 2003 11:03:20 -0400, "Itamar Shtull-Trauring"
<itamar at itamarst.org> said:
> On Fri, 19 Sep 2003 05:42:08 -0600
> "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> 
> > I have a UDP protocol that subclasses DatagramProtocol.  It is working
> > fine, but I decided I wanted a protocol factory so I can keep track of
> > the list of clients.  I added the following class, which doesn't
> > nothing currently...
> 
> You will notice the docs say nothing about factories. This is because
> listenUDP does not accept factories :) If you want to keep track of
> clients you will have to do it yourself by dispatching based on the
> host/port of a received datagram.
> 
> Why are you using UDP, by the way?
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From exarkun at intarweb.us  Fri Sep 19 16:00:11 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 19 Sep 2003 18:00:11 -0400
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919114208.3086E3C45C@www.fastmail.fm>
References: <20030919114208.3086E3C45C@www.fastmail.fm>
Message-ID: <20030919220011.GB927@intarweb.us>

On Fri, Sep 19, 2003 at 05:42:08AM -0600, Justin Johnson wrote:
> I have a UDP protocol that subclasses DatagramProtocol.  It is working
> fine, but I decided I wanted a protocol factory so I can keep track of
> the list of clients.  I added the following class, which doesn't nothing
> currently...
> 
> class MyProtoFactory(Factory):
>     protocol = MyProto

  Factories aren't to be used with DatagramProtocols, since a single
DatagramProtocol instance manages all traffic to and from the ports you
designate.

  If you want to share state between different DatagramProtocol instances,
give them a reference to a common object manually (not a factory, but
perhaps a service), or reconsider and use a single instance to talk to all
your clients.  Nothing prevents you from listening on multiple ports with
the same instance.

  Jp

-- 
"Pascal is Pascal is Pascal is dog meat."
                -- M. Devine and P. Larson, Computer Science 340
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030919/e5985302/attachment.sig>

From krosenjack at hotmail.com  Fri Sep 19 16:40:43 2003
From: krosenjack at hotmail.com (Kevin Rosenjack)
Date: Fri, 19 Sep 2003 15:40:43 -0700
Subject: [Twisted-Python] UDP Factories
Message-ID: <Sea1-F75qqKgWRjfXr600010842@hotmail.com>

Your not coding for a UPnP device by any chance, are you?


>From: "Justin Johnson" <justinjohnson at fastmail.fm>
>Reply-To: twisted-python at twistedmatrix.com
>To: "Twisted-Python" <twisted-python at twistedmatrix.com>
>Subject: Re: [Twisted-Python] UDP Factories
>Date: Fri, 19 Sep 2003 16:18:32 -0600
>
>Yeah I sent this email out real quick without looking at the doc.  Sorry.
>
>I'm using UDP because the device I'm coding for uses UDP.  Twisted sure
>saved me a ton of time.
>
>Out of curiosity, why doesn't listenUDP accept Factories?
>
>On Fri, 19 Sep 2003 11:03:20 -0400, "Itamar Shtull-Trauring"
><itamar at itamarst.org> said:
> > On Fri, 19 Sep 2003 05:42:08 -0600
> > "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> >
> > > I have a UDP protocol that subclasses DatagramProtocol.  It is working
> > > fine, but I decided I wanted a protocol factory so I can keep track of
> > > the list of clients.  I added the following class, which doesn't
> > > nothing currently...
> >
> > You will notice the docs say nothing about factories. This is because
> > listenUDP does not accept factories :) If you want to keep track of
> > clients you will have to do it yourself by dispatching based on the
> > host/port of a received datagram.
> >
> > Why are you using UDP, by the way?
> >
> > --
> > Itamar Shtull-Trauring    http://itamarst.org/
> > Available for Python & Twisted consulting
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

_________________________________________________________________
Get 10MB of e-mail storage! Sign up for Hotmail Extra Storage.  
http://join.msn.com/?PAGE=features/es




From itamar at itamarst.org  Fri Sep 19 20:21:21 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 22:21:21 -0400
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919221832.714673C4B4@www.fastmail.fm>
References: <20030919114208.3086E3C45C@www.fastmail.fm>
	<20030919110320.7840bec7.itamar@itamarst.org>
	<20030919221832.714673C4B4@www.fastmail.fm>
Message-ID: <20030919222121.2690a18c.itamar@itamarst.org>

On Fri, 19 Sep 2003 16:18:32 -0600
"Justin Johnson" <justinjohnson at fastmail.fm> wrote:

> Yeah I sent this email out real quick without looking at the doc. 
> Sorry.
> 
> I'm using UDP because the device I'm coding for uses UDP.  Twisted
> sure saved me a ton of time.
> 
> Out of curiosity, why doesn't listenUDP accept Factories?

This would, to be a general purpose thing, need to create a protocol per
datagram. This would be... inefficient. In TCP you have a protocol per
connection. In UDP there are no connections. You might build one on top
of UDP, in which case you would have a protocol-ish object you dispatch
to, but how you determine this object and its lifecycle would be
something you would have to determine.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 19 20:22:33 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 22:22:33 -0400
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <20030919220011.GB927@intarweb.us>
References: <20030919114208.3086E3C45C@www.fastmail.fm>
	<20030919220011.GB927@intarweb.us>
Message-ID: <20030919222233.03ef1635.itamar@itamarst.org>

On Fri, 19 Sep 2003 18:00:11 -0400
Jp Calderone <exarkun at intarweb.us> wrote:

>   If you want to share state between different DatagramProtocol
>   instances,
> give them a reference to a common object manually (not a factory, but
> perhaps a service), or reconsider and use a single instance to talk to
> all your clients.  Nothing prevents you from listening on multiple
> ports with the same instance.

Not really, there's a self.transport, so you can only connect a
datagramprotocol to a single port.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Fri Sep 19 20:25:12 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 22:25:12 -0400
Subject: [Twisted-Python] Application refactor
In-Reply-To: <20030919215026.GA903@intarweb.us>
References: <20030919215026.GA903@intarweb.us>
Message-ID: <20030919222512.68b831b3.itamar@itamarst.org>

On Fri, 19 Sep 2003 17:50:26 -0400
Jp Calderone <exarkun at intarweb.us> wrote:

>   Services are severely broken with the new code.  twisted.mail is
> completely non-functional.

Some lack of backwards compatability is to be expected (I had to fix
twistd --debug). It is not *acceptable*, however, to leave it that way -
we need to get it fixed. Try to debug it yourself if you can, but
beating up moshez with symptoms is also acceptable ;)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From ccom at gmx.net  Fri Sep 19 20:32:57 2003
From: ccom at gmx.net (ccom at gmx.net)
Date: Sat, 20 Sep 2003 04:32:57 +0200 (MEST)
Subject: [Twisted-Python] Re : executing .rpy in a thread
Message-ID: <23035.1064025177@www48.gmx.net>

It is tempting to use Jamse's patch because the code does get more elegant.
On the other hand the suggestion to develope pivotal to twisted makes a lot
of sense too. I Hope this patch will become part of twisted soon. 

Thanks to bob for showing me the "conventional" way of doing it. I just
tested  his code and it works on my setup too.

_stephan

-- 
+++ GMX - die erste Adresse fr Mail, Message, More! +++

Getestet von Stiftung Warentest: GMX FreeMail (GUT), GMX ProMail (GUT)
(Heft 9/03 - 23 e-mail-Tarife: 6 gut, 12 befriedigend, 5 ausreichend)

Jetzt selbst kostenlos testen: http://www.gmx.net




From itamar at itamarst.org  Fri Sep 19 21:21:30 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Fri, 19 Sep 2003 23:21:30 -0400
Subject: [Twisted-Python] Application refactor
In-Reply-To: <20030919215026.GA903@intarweb.us>
References: <20030919215026.GA903@intarweb.us>
Message-ID: <20030919232130.70ea3b23.itamar@itamarst.org>

On Fri, 19 Sep 2003 17:50:26 -0400
Jp Calderone <exarkun at intarweb.us> wrote:

>   Services are severely broken with the new code.  twisted.mail is
> completely non-functional.

Fixed in CVS. Everyone, please try existing TAPs and code with CVS
Twisted and report any problems with the new application code in the
issue tracker.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Fri Sep 19 22:48:38 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sat, 20 Sep 2003 00:48:38 -0400
Subject: [Twisted-Python] Re : executing .rpy in a thread
In-Reply-To: <23035.1064025177@www48.gmx.net>
References: <23035.1064025177@www48.gmx.net>
Message-ID: <3F6BDC26.3070104@twistedmatrix.com>

ccom at gmx.net wrote:
>  I Hope this patch will become part of twisted soon.

It seems that we should apply it.  Does it play nicely with distrib and 
not break compatibility?  If so, I'm +1




From wilk-ml at flibuste.net  Sat Sep 20 05:36:20 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Sat, 20 Sep 2003 13:36:20 +0200
Subject: [Twisted-Python] send somes mails
Message-ID: <87n0czn13f.fsf@flibuste.net>

Hi,

Is it a good way to call smtp.sendmail() for sending a lot of mails
(it's for a scrabble game, not spam !) It will connect and deconect for
each mail isn't it ?

thanks

-- 
William Dod - http://flibuste.net



From gaiacrtn at free.fr  Sat Sep 20 09:45:46 2003
From: gaiacrtn at free.fr (Baptiste Lepilleur)
Date: Sat, 20 Sep 2003 17:45:46 +0200
Subject: [Twisted-Python] Examples using PBServerFactory ?
Message-ID: <021201c37f8e$427cbae0$4dbfc2d4@gaia>

    Is there some examples of using the PBServerFactory ? When running
examples from Perspective Broker how to
(http://twistedmatrix.com/documents/howto/pb-usage#auto2) I get a deprecated
warning concerning pb.BrokerFactory usage.

    Since I'm new to twisted, I'd rather get thing right from the start

    Thanks,
    Baptiste.




From itamar at itamarst.org  Sat Sep 20 10:20:56 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 20 Sep 2003 12:20:56 -0400
Subject: [Twisted-Python] Examples using PBServerFactory ?
In-Reply-To: <021201c37f8e$427cbae0$4dbfc2d4@gaia>
References: <021201c37f8e$427cbae0$4dbfc2d4@gaia>
Message-ID: <20030920122056.1591c7fc.itamar@itamarst.org>

On Sat, 20 Sep 2003 17:45:46 +0200
"Baptiste Lepilleur" <gaiacrtn at free.fr> wrote:

>     Is there some examples of using the PBServerFactory ? When running
> examples from Perspective Broker how to
> (http://twistedmatrix.com/documents/howto/pb-usage#auto2) I get a
> deprecated warning concerning pb.BrokerFactory usage.

sandbox/jml/pb-go*.py in the tarball and doc/examples/pbecho*.py in CVS.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From gaiacrtn at free.fr  Sat Sep 20 11:52:39 2003
From: gaiacrtn at free.fr (Baptiste Lepilleur)
Date: Sat, 20 Sep 2003 19:52:39 +0200
Subject: [Twisted-Python] Examples using PBServerFactory ?
References: <021201c37f8e$427cbae0$4dbfc2d4@gaia> <20030920122056.1591c7fc.itamar@itamarst.org>
Message-ID: <022701c37f9f$fd06e140$4dbfc2d4@gaia>

Thanks, this works like a charm.

Baptiste.

----- Original Message ----- 
From: "Itamar Shtull-Trauring" <itamar at itamarst.org>
To: <twisted-python at twistedmatrix.com>
Sent: Saturday, September 20, 2003 6:20 PM
Subject: Re: [Twisted-Python] Examples using PBServerFactory ?


> On Sat, 20 Sep 2003 17:45:46 +0200
> "Baptiste Lepilleur" <gaiacrtn at free.fr> wrote:
> 
> >     Is there some examples of using the PBServerFactory ? When running
> > examples from Perspective Broker how to
> > (http://twistedmatrix.com/documents/howto/pb-usage#auto2) I get a
> > deprecated warning concerning pb.BrokerFactory usage.
> 
> sandbox/jml/pb-go*.py in the tarball and doc/examples/pbecho*.py in CVS.
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting




From busch at transporeon.com  Sat Sep 20 11:59:51 2003
From: busch at transporeon.com (Axel Busch)
Date: Sat, 20 Sep 2003 19:59:51 +0200
Subject: AW: [Twisted-Python] Examples using PBServerFactory ?
In-Reply-To: <021201c37f8e$427cbae0$4dbfc2d4@gaia>
Message-ID: <000c01c37fa0$fd80fdd0$4600a8c0@atlas>

hi Baptiste, 

I'm also new to python and twisted, but maybe I have something 
that will help you getting started. 
Attached are two examples, both use twisted and wxPython 
(because I need a GUI for the client.) 

pbVerySimple: 
basically what you will find in the sandbox, but with some 
comments from Glyph which I found in the mailing list regarding 
"Realm" and "Avatar" and the like. 

pbSimple: 
here I felt more adventurous. Several Clients will have the same 
perspective, which will give them a view, which is a wrapper for 
a collection of server-objects. 
Clients subscribe for a list of those objects (called "Transports", 
because I'm working in eLogistics) and when one client changes 
a Transport the others will get an update. 
Take care, propably I did lots of stuff wrong there, and of course 
the security model is not for productive use. ;) 
Maybe the more experienced guys on this list will help us with 
advice. 
When you start client.py you have to give it a user name ("bob" or 
"nici") as an argument. 

My setting: winXP, python2.3, wxPython2.4.1.2, Twisted-1.0.7rc1 

Regards, 

Axel 


> -----Ursprngliche Nachricht-----
> Von: twisted-python-admin at twistedmatrix.com 
> [mailto:twisted-python-admin at twistedmatrix.com] Im Auftrag 
> von Baptiste Lepilleur
> Gesendet: Samstag, 20. September 2003 17:46
> An: twisted-python at twistedmatrix.com
> Betreff: [Twisted-Python] Examples using PBServerFactory ?
> 
> 
>     Is there some examples of using the PBServerFactory ? When running
> examples from Perspective Broker how to
> (http://twistedmatrix.com/documents/howto/pb-usage#auto2) I 
> get a deprecated
> warning concerning pb.BrokerFactory usage.
> 
>     Since I'm new to twisted, I'd rather get thing right from 
> the start
> 
>     Thanks,
>     Baptiste.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pbSimple.zip
Type: application/x-zip-compressed
Size: 4632 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030920/4e5e97eb/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pbVerySimple.zip
Type: application/x-zip-compressed
Size: 5206 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030920/4e5e97eb/attachment-0005.bin>

From golux at comcast.net  Sat Sep 20 08:52:25 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Sat, 20 Sep 2003 10:52:25 -0400
Subject: AW: [Twisted-Python] Examples using PBServerFactory ?
In-Reply-To: <000c01c37fa0$fd80fdd0$4600a8c0@atlas>
References: <000c01c37fa0$fd80fdd0$4600a8c0@atlas>
Message-ID: <3F6C69A9.3030107@comcast.net>

Axel Busch wrote:

>Attached are two examples, both use twisted and wxPython 
>(because I need a GUI for the client.) 
>

Awesome, Axel!  Both examples work perfectly.
(But note that the names of the zip files are reversed.) 
These will be quite useful to us, since we are also
developing a wxPython client that interacts with
a Twisted server app.

Thanks!
- Steve.





From busch at transporeon.com  Sat Sep 20 13:56:27 2003
From: busch at transporeon.com (Axel Busch)
Date: Sat, 20 Sep 2003 21:56:27 +0200
Subject: AW: AW: [Twisted-Python] Examples using PBServerFactory ?
In-Reply-To: <3F6C69A9.3030107@comcast.net>
Message-ID: <002301c37fb1$471c45c0$4600a8c0@atlas>

Hi Steve,

> Awesome, Axel!  Both examples work perfectly.
Thanks. *blush*. But better wait for the comments of 
Itamar etc. I'm not sure if I got their Ideas of how 
to use all this perspective and view stuff right. 

> (But note that the names of the zip files are reversed.) 
Ups, hehe. *sorry* 

> These will be quite useful to us, since we are also
> developing a wxPython client that interacts with
> a Twisted server app.
> 
> Thanks!

You're welcome. I'm currently still playing around, 
but looks like we will use python/wx/twisted for our 
next projects (currently all c++/mfc/soap). 
Now I'm experimenting with a persistent storage for the 
server-objects, and when that is settled satisfactorily 
we will switch to python/twisted. Things look really great, 
I fell in love with python and twisted ;).
It's just _so_ much more fun.

so long, Axel 





From justinjohnson at fastmail.fm  Sat Sep 20 20:48:47 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Sat, 20 Sep 2003 20:48:47 -0600
Subject: [Twisted-Python] UDP Factories
In-Reply-To: <Sea1-F75qqKgWRjfXr600010842@hotmail.com>
References: <Sea1-F75qqKgWRjfXr600010842@hotmail.com>
Message-ID: <20030921024847.2E2793C06A@www.fastmail.fm>

No.  See www.slimp3.com.

On Fri, 19 Sep 2003 15:40:43 -0700, "Kevin Rosenjack"
<krosenjack at hotmail.com> said:
> Your not coding for a UPnP device by any chance, are you?
> 
> 
> >From: "Justin Johnson" <justinjohnson at fastmail.fm>
> >Reply-To: twisted-python at twistedmatrix.com
> >To: "Twisted-Python" <twisted-python at twistedmatrix.com>
> >Subject: Re: [Twisted-Python] UDP Factories
> >Date: Fri, 19 Sep 2003 16:18:32 -0600
> >
> >Yeah I sent this email out real quick without looking at the doc.  Sorry.
> >
> >I'm using UDP because the device I'm coding for uses UDP.  Twisted sure
> >saved me a ton of time.
> >
> >Out of curiosity, why doesn't listenUDP accept Factories?
> >
> >On Fri, 19 Sep 2003 11:03:20 -0400, "Itamar Shtull-Trauring"
> ><itamar at itamarst.org> said:
> > > On Fri, 19 Sep 2003 05:42:08 -0600
> > > "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> > >
> > > > I have a UDP protocol that subclasses DatagramProtocol.  It is working
> > > > fine, but I decided I wanted a protocol factory so I can keep track of
> > > > the list of clients.  I added the following class, which doesn't
> > > > nothing currently...
> > >
> > > You will notice the docs say nothing about factories. This is because
> > > listenUDP does not accept factories :) If you want to keep track of
> > > clients you will have to do it yourself by dispatching based on the
> > > host/port of a received datagram.
> > >
> > > Why are you using UDP, by the way?
> > >
> > > --
> > > Itamar Shtull-Trauring    http://itamarst.org/
> > > Available for Python & Twisted consulting
> > >
> > > _______________________________________________
> > > Twisted-Python mailing list
> > > Twisted-Python at twistedmatrix.com
> > > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
> >_______________________________________________
> >Twisted-Python mailing list
> >Twisted-Python at twistedmatrix.com
> >http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> _________________________________________________________________
> Get 10MB of e-mail storage! Sign up for Hotmail Extra Storage.  
> http://join.msn.com/?PAGE=features/es
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From justinjohnson at fastmail.fm  Sat Sep 20 21:04:01 2003
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Sat, 20 Sep 2003 21:04:01 -0600
Subject: [Twisted-Python] UDP Factories
In-Reply-To: ARRAY(0x9de7690)
References: ARRAY(0x9de77c8)
Message-ID: <20030921030401.368743BD22@www.fastmail.fm>

Thanks for the help.  This makes sense to me now.

-Justin

On Fri, 19 Sep 2003 22:21:21 -0400, "Itamar Shtull-Trauring"
<itamar at itamarst.org> said:
> On Fri, 19 Sep 2003 16:18:32 -0600
> "Justin Johnson" <justinjohnson at fastmail.fm> wrote:
> 
> > Yeah I sent this email out real quick without looking at the doc. 
> > Sorry.
> > 
> > I'm using UDP because the device I'm coding for uses UDP.  Twisted
> > sure saved me a ton of time.
> > 
> > Out of curiosity, why doesn't listenUDP accept Factories?
> 
> This would, to be a general purpose thing, need to create a protocol per
> datagram. This would be... inefficient. In TCP you have a protocol per
> connection. In UDP there are no connections. You might build one on top
> of UDP, in which case you would have a protocol-ish object you dispatch
> to, but how you determine this object and its lifecycle would be
> something you would have to determine.
> 
> -- 
> Itamar Shtull-Trauring    http://itamarst.org/
> Available for Python & Twisted consulting
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From exarkun at intarweb.us  Sat Sep 20 15:12:19 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 20 Sep 2003 17:12:19 -0400
Subject: [Twisted-Python] send somes mails
In-Reply-To: <87n0czn13f.fsf@flibuste.net>
References: <87n0czn13f.fsf@flibuste.net>
Message-ID: <20030920211219.GA11570@intarweb.us>

On Sat, Sep 20, 2003 at 01:36:20PM +0200, William Dode wrote:
> Hi,
> 
> Is it a good way to call smtp.sendmail() for sending a lot of mails
> (it's for a scrabble game, not spam !) It will connect and deconect for
> each mail isn't it ?

  twisted.protocols.smtp.sendmail() is better

  Jp

-- 
http://catandgirl.com/view.cgi?44
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030920/b61efd04/attachment.sig>

From teratorn at world-net.net  Sun Sep 21 02:03:37 2003
From: teratorn at world-net.net (Eric Mangold)
Date: Sun, 21 Sep 2003 03:03:37 -0500
Subject: [Twisted-Python] formatting a CopiedFailure for GUI display
Message-ID: <200309210303.37179.teratorn@world-net.net>

Hi folks,

When dealing with normal Failure instances, a simple str(aFailure.value) will 
produce an acceptably short error message.  However, a CopiedFailure's value 
attr is "".  str(aCopiedFailure) is the whole giant traceback, unsuitable for 
a gui message box.

Are there any alternatives?

-Eric






From wilk-ml at flibuste.net  Sun Sep 21 02:24:31 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Sun, 21 Sep 2003 10:24:31 +0200
Subject: [Twisted-Python] send somes mails
In-Reply-To: <20030920211219.GA11570@intarweb.us> (Jp Calderone's message of
 "Sat, 20 Sep 2003 17:12:19 -0400")
References: <87n0czn13f.fsf@flibuste.net> <20030920211219.GA11570@intarweb.us>
Message-ID: <877k42sg5c.fsf@flibuste.net>

Jp Calderone <exarkun at intarweb.us> writes:

> On Sat, Sep 20, 2003 at 01:36:20PM +0200, William Dode wrote:
>> Hi,
>> 
>> Is it a good way to call smtp.sendmail() for sending a lot of mails
>> (it's for a scrabble game, not spam !) It will connect and deconect for
>> each mail isn't it ?
>
>   twisted.protocols.smtp.sendmail() is better

It's what i use. But it's very slow and it call each time
reactor.connect...

-- 
William Dod - http://flibuste.net



From radix at twistedmatrix.com  Sun Sep 21 06:11:54 2003
From: radix at twistedmatrix.com (Chris Armstrong)
Date: Sun, 21 Sep 2003 08:11:54 -0400
Subject: [Twisted-Python] formatting a CopiedFailure for GUI display
In-Reply-To: <200309210303.37179.teratorn@world-net.net>
References: <200309210303.37179.teratorn@world-net.net>
Message-ID: <20030921121154.GA12159@pyramid.twistedmatrix.com>

On Sun, Sep 21, 2003 at 03:03:37AM -0500, Eric Mangold wrote:
> When dealing with normal Failure instances, a simple str(aFailure.value) will 
> produce an acceptably short error message.  However, a CopiedFailure's value 
> attr is "".  str(aCopiedFailure) is the whole giant traceback, unsuitable for 
> a gui message box.

CopiedFailure probably doesn't have that information available separately.
It's written such that in the serialization side, it just sends the string
traceback rather than all the frames, etc, but I must've missed sending the
actual exception message separately. You can report a bug on the tracker and
assign it to me, but I encourage you to try to patch it, as I've been
swamped lately :)


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From exarkun at intarweb.us  Sun Sep 21 10:34:49 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 21 Sep 2003 12:34:49 -0400
Subject: [Twisted-Python] send somes mails
In-Reply-To: <877k42sg5c.fsf@flibuste.net>
References: <87n0czn13f.fsf@flibuste.net> <20030920211219.GA11570@intarweb.us> <877k42sg5c.fsf@flibuste.net>
Message-ID: <20030921163449.GA13769@intarweb.us>

On Sun, Sep 21, 2003 at 10:24:31AM +0200, William Dode wrote:
> Jp Calderone <exarkun at intarweb.us> writes:
> 
> > On Sat, Sep 20, 2003 at 01:36:20PM +0200, William Dode wrote:
> >> Hi,
> >> 
> >> Is it a good way to call smtp.sendmail() for sending a lot of mails
> >> (it's for a scrabble game, not spam !) It will connect and deconect for
> >> each mail isn't it ?
> >
> >   twisted.protocols.smtp.sendmail() is better
> 
> It's what i use. But it's very slow and it call each time
> reactor.connect...
> 

  Unless you are sending all the mail to users on a single host or you have
a smarthost which will relay your mail, you must make multiple connections.

  Of course, if you're sending to a smart host, it just means that that
server will have to go out and make connections to multiple hosts... So
you're not saving any work, you're just pushing it onto someone else.

  Jp

-- 
Seduced, shaggy Samson snored.
She scissored short.  Sorely shorn,
Soon shackled slave, Samson sighed,
Silently scheming,
Sightlessly seeking
Some savage, spectacular suicide.
                -- Stanislaw Lem, "Cyberiad"
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030921/be932d0c/attachment.sig>

From wilk-ml at flibuste.net  Sun Sep 21 12:02:26 2003
From: wilk-ml at flibuste.net (William Dode)
Date: Sun, 21 Sep 2003 20:02:26 +0200
Subject: [Twisted-Python] send somes mails
In-Reply-To: <20030921163449.GA13769@intarweb.us> (Jp Calderone's message of
 "Sun, 21 Sep 2003 12:34:49 -0400")
References: <87n0czn13f.fsf@flibuste.net> <20030920211219.GA11570@intarweb.us>
	<877k42sg5c.fsf@flibuste.net> <20030921163449.GA13769@intarweb.us>
Message-ID: <87vfrmrpe5.fsf@flibuste.net>

Jp Calderone <exarkun at intarweb.us> writes:

> On Sun, Sep 21, 2003 at 10:24:31AM +0200, William Dode wrote:
>> Jp Calderone <exarkun at intarweb.us> writes:
>> 
>> > On Sat, Sep 20, 2003 at 01:36:20PM +0200, William Dode wrote:
>> >> Hi,
>> >> 
>> >> Is it a good way to call smtp.sendmail() for sending a lot of mails
>> >> (it's for a scrabble game, not spam !) It will connect and deconect for
>> >> each mail isn't it ?
>> >
>> >   twisted.protocols.smtp.sendmail() is better
>> 
>> It's what i use. But it's very slow and it call each time
>> reactor.connect...
>> 
>
>   Unless you are sending all the mail to users on a single host or you have
> a smarthost which will relay your mail, you must make multiple connections.
>
>   Of course, if you're sending to a smart host, it just means that that
> server will have to go out and make connections to multiple hosts... So
> you're not saving any work, you're just pushing it onto someone else.

I'm very egoist, i want only to save the work of my programme and let all
the problems to the smarthost ;-). Because i don't want to deal with
queues and others things like that...

My goal is to send the mails to the smarthost the most quickly i
can. It's why i thought i could keep one connection open with the
smarthost.

-- 
William Dod - http://flibuste.net



From gaiacrtn at free.fr  Mon Sep 22 00:59:48 2003
From: gaiacrtn at free.fr (Baptiste Lepilleur)
Date: Mon, 22 Sep 2003 08:59:48 +0200
Subject: [Twisted-Python] Examples using PBServerFactory ?
References: <000c01c37fa0$fd80fdd0$4600a8c0@atlas>
Message-ID: <00e801c380d7$1ef4a7a0$90b6c2d4@gaia>

Thanks, this will prove useful. Though, I won't be using wxPython for the
interface (I'll probably plug-in a web server). But it's interesting to see
how it's done.

Baptiste.

----- Original Message ----- 
From: "Axel Busch" <busch at transporeon.com>
To: <twisted-python at twistedmatrix.com>
Cc: <gaiacrtn at free.fr>
Sent: Saturday, September 20, 2003 7:59 PM
Subject: AW: [Twisted-Python] Examples using PBServerFactory ?


hi Baptiste,

I'm also new to python and twisted, but maybe I have something
that will help you getting started.
Attached are two examples, both use twisted and wxPython
(because I need a GUI for the client.)

pbVerySimple:
basically what you will find in the sandbox, but with some
comments from Glyph which I found in the mailing list regarding
"Realm" and "Avatar" and the like.

pbSimple:
here I felt more adventurous. Several Clients will have the same
perspective, which will give them a view, which is a wrapper for
a collection of server-objects.
Clients subscribe for a list of those objects (called "Transports",
because I'm working in eLogistics) and when one client changes
a Transport the others will get an update.
Take care, propably I did lots of stuff wrong there, and of course
the security model is not for productive use. ;)
Maybe the more experienced guys on this list will help us with
advice.
When you start client.py you have to give it a user name ("bob" or
"nici") as an argument.

My setting: winXP, python2.3, wxPython2.4.1.2, Twisted-1.0.7rc1

Regards,

Axel


> -----Ursprngliche Nachricht-----
> Von: twisted-python-admin at twistedmatrix.com
> [mailto:twisted-python-admin at twistedmatrix.com] Im Auftrag
> von Baptiste Lepilleur
> Gesendet: Samstag, 20. September 2003 17:46
> An: twisted-python at twistedmatrix.com
> Betreff: [Twisted-Python] Examples using PBServerFactory ?
>
>
>     Is there some examples of using the PBServerFactory ? When running
> examples from Perspective Broker how to
> (http://twistedmatrix.com/documents/howto/pb-usage#auto2) I
> get a deprecated
> warning concerning pb.BrokerFactory usage.
>
>     Since I'm new to twisted, I'd rather get thing right from
> the start
>
>     Thanks,
>     Baptiste.




From dkuhlman at cutter.rexx.com  Mon Sep 22 15:00:33 2003
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Mon, 22 Sep 2003 14:00:33 -0700
Subject: [Twisted-Python] Doc on Twisted examples and patterns
In-Reply-To: <20030919124231.4be3f088.itamar@itamarst.org>; from itamar@itamarst.org on Fri, Sep 19, 2003 at 12:42:31PM -0400
References: <20030919124231.4be3f088.itamar@itamarst.org>
Message-ID: <20030922140033.A39429@cutter.rexx.com>

I've updated my document containing Twisted examples and patterns. 
Thanks much to Andrew Bennetts for his suggestions and critique.

You can find the document at:

    http://www.rexx.com/~dkuhlman/twisted_patterns.html

Any suggestions will be appreciated.

Dave

-- 
Dave Kuhlman
dkuhlman at rexx.com
http://www.rexx.com/~dkuhlman



From suneetha at sonic.net  Mon Sep 22 16:49:55 2003
From: suneetha at sonic.net (suneetha at sonic.net)
Date: Mon, 22 Sep 2003 15:49:55 -0700 (PDT)
Subject: [Twisted-Python] how to generate another html page?
Message-ID: <34251.131.243.2.52.1064270995.squirrel@ssl.sonic.net>

Hi,
   When I click on an image, I would like to generate a web form on the
fly, in a desired location. I tried with both Page and DOMTemplate
classes. Could anyone please give me an idea on what attributes to be
defined for what html tags and what class a resource file should use? I
think I misunderstand something in between here. I know how to generate
the web form, only problem is how to integrate this with twisted,
woven.

Thanks
Suneetha.






From edahl at mindspring.com  Mon Sep 22 09:13:09 2003
From: edahl at mindspring.com (Erik A.Dahl)
Date: Mon, 22 Sep 2003 11:13:09 -0400
Subject: [Twisted-Python] twisted and python 2.1.3
Message-ID: <468B01D5-ED0F-11D7-84B1-000393811146@mindspring.com>

I'm using twisted and some other python libraries (zope) and would like 
to use them together.  Of course zope is still back in the 2.1.3 days 
of python.  If I were to deal with defining True and False where needed 
would there be other compatibility issues with 2.1.3 and twisted?

-EAD




From matti.jagula at proekspert.ee  Mon Sep 22 14:58:55 2003
From: matti.jagula at proekspert.ee (Matti Jagula)
Date: Mon, 22 Sep 2003 23:58:55 +0300
Subject: [Twisted-Python] Twisted scalability question
Message-ID: <200309222358.55540.matti.jagula@proekspert.ee>

Hi,

I've got a task to write a DHCP server for a local cable operator and I'm 
considering different frameworks to write it in. I've looked at Twisted a 
couple of times and thought I'd do some little experimenting to see how well 
it behaves with the current task at hand.

The DHCP server needs to do some database interaction to support the business 
logic. So to model the problem I wrote two simple QOTD servers for UDP 
protocol, using a postresql backend for quotes. 

One server is written using a Twisted DatagramProtocol and uses Deferreds for 
database query using adbapi. The other is a dead-simple single-threaded 
block-and-wait UDP socket server with a single database connection that just 
reads from the udp socket, queries the database and writes the result back.

So far so good. I wanted to see how well these servers scale with a lot of 
requests. First I tried making just a lot of sequential requests from a 
single-threaded client, but that showed that the Twisted version was slower 
by a factor of ~4. 

After a little consideration I thought that Twisted must be better for a lot 
of concurrent requests, because of the threaded database access. Twisted 
should be able to accept more than one client at a time and keep all the 
database connections (5 by default, i guess) busy. So I forked 20 clients off 
using a simple bash script with a for loop. The result was that the Twisted 
is still slower, by the same factor of 4.

The "top" shows that while the Twisted server is running, the 5 postgresql 
connections are mostly in "idle" state (they change the name of the process 
to show it). However, while the single threaded server is running, the only 
active pgsql connection is mostly in its "select" state.

So, after the rather lengthy introduction, I'd like to know what am I doing 
wrong? How can I show the better scalability of Twisted platform?

-- 
  Matti Jagula




From pje at telecommunity.com  Tue Sep 23 09:58:14 2003
From: pje at telecommunity.com (Phillip J. Eby)
Date: Tue, 23 Sep 2003 11:58:14 -0400
Subject: [Twisted-Python] Twisted scalability question
In-Reply-To: <200309222358.55540.matti.jagula@proekspert.ee>
Message-ID: <5.1.0.14.0.20030923111304.0274aec0@mail.telecommunity.com>

At 11:58 PM 9/22/03 +0300, Matti Jagula wrote:

>So, after the rather lengthy introduction, I'd like to know what am I doing
>wrong? How can I show the better scalability of Twisted platform?

This is just a guess, but you probably aren't doing anything complicated 
enough to benefit.  :)

Seriously, if all you're doing is sending a single datagram in response to 
a simple DB query, framework overhead will continue to dominate your 
processing time.  Think about the two programs: both perform the query and 
send the datagram.  But the non-Twisted program *does nothing else*.  So, 
what you're seeing is that the per-invocation framework overhead for the 
Twisted version is about 3x what's required for just the db query and 
datagram send.  For something so simple, that actually sounds pretty 
reasonable!

What Twisted (and the "reactor" pattern in general) excels at is 
multiplexing *concurrent and ongoing* I/O operations.  However, your 
application has *no* ongoing I/O!  In general, Twisted scales well because 
it lets you do other things while you're waiting for I/O.  With TCP 
streams, you may have to wait before you write data, because the receiver 
may be slow.  Likewise, if you're receiving data, the sender may be 
slow.  While it's waiting, Twisted can let you do something else, like send 
or receive data from someone else that's ready at that moment, or do some 
actual computation.

However, in your setup, the *only* I/O that you ever wait for is the 
database!  You're receiving a single UDP packet (that you don't "wait" 
for), and sending a UDP packet (that you don't need to wait to 
send!).  Even if you made it take 10 times longer for the DB query to run, 
you'd *still* be able to send that data out as soon as you receive it.

In short, the problem you're solving is so darn simple that there's no way 
using Twisted can really improve on it, except in terms of issues like 
keeping your DB connection open.  There's simply nothing here for Twisted 
to multiplex!




From itamar at itamarst.org  Tue Sep 23 10:30:06 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 23 Sep 2003 12:30:06 -0400
Subject: [Twisted-Python] twisted and python 2.1.3
In-Reply-To: <468B01D5-ED0F-11D7-84B1-000393811146@mindspring.com>
References: <468B01D5-ED0F-11D7-84B1-000393811146@mindspring.com>
Message-ID: <20030923123006.16835370.itamar@itamarst.org>

On Mon, 22 Sep 2003 11:13:09 -0400
Erik A.Dahl <edahl at mindspring.com> wrote:

> I'm using twisted and some other python libraries (zope) and would
> like to use them together.  Of course zope is still back in the 2.1.3
> days of python.  If I were to deal with defining True and False where
> needed would there be other compatibility issues with 2.1.3 and
> twisted?

Yes, we are using other 2.2 features as well. So, either :

1. switch to older version of Twisted (1.0.4 had 2.1 support).
2. upgrade Zope to use 2.2 (current versions while not officially
supported do run decently on 2.2 - ask around).
3. Wait for Zope 2.7 which runs on python 2.2 IIRC. 
4. Run Twisted and Zope in different processes and communicate via
XML-RPC or something like that.

Personally I'd try for #4 in most cases.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From maoy at cis.upenn.edu  Tue Sep 23 22:08:48 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 00:08:48 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <20030923123006.16835370.itamar@itamarst.org>
Message-ID: <Pine.LNX.4.44.0309232307470.20897-100000@forty-thieves.cis.upenn.edu>

I tried to use twisted python to write a proxy following the given 
socksv4 example. 

The problem i discovered is that: when i try to forward two connections, 
their capacities may not match. 

In a blocking implementation, 
           data = source.read(); dest.write(data);

In a non-blocking implementation, what socksv4 did is something like:

   def dataReceived(data):
	otherConn.transport.write(data)

However, if source is a much faster link than dest, would there be a 
problem? write always return even it should block so that read always 
happens, and the buffer of source tcp connection will never get full, to 
let tcp start flow control?

Thanks.

Yun




From bob at redivi.com  Tue Sep 23 22:47:39 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 24 Sep 2003 00:47:39 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309232307470.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <39B38394-EE4A-11D7-A788-000A95686CD8@redivi.com>

On Wednesday, Sep 24, 2003, at 00:08 America/New_York, Yun Mao wrote:

> I tried to use twisted python to write a proxy following the given
> socksv4 example.
>
> The problem i discovered is that: when i try to forward two 
> connections,
> their capacities may not match.
>
> In a blocking implementation,
>            data = source.read(); dest.write(data);
>
> In a non-blocking implementation, what socksv4 did is something like:
>
>    def dataReceived(data):
> 	otherConn.transport.write(data)
>
> However, if source is a much faster link than dest, would there be a
> problem? write always return even it should block so that read always
> happens, and the buffer of source tcp connection will never get full, 
> to
> let tcp start flow control?

With that code, you are right.  Twisted will buffer everything for 
dest.. so you won't lose any packets, but you might start using a lot 
of memory and source may think that dest has a faster connection than 
dest actually does.

The twisted.internet.policies module can throttle transports, however I 
don't think that any of them can actually determine how fast dest is 
actually consuming the data.  That would require introspecting the 
underlying transport's buffer and I don't believe the transport 
interface has any way of doing that.

You could break the rules and assume that there is a dataBuffer 
attribute (from twisted.internet.abstract.FileDescriptor) which would 
most likely work, until you try and use it on a transport that is not a 
FileDescriptor (wrapped by another policy, is a loopback for testing, 
using a custom reactor, etc.).

In any case, yes, it's possible to solve this problem, but you will 
have to write your own throttling policy which must bend the interface 
rules in its implementation.

I would suggest writing the throttling policy code, and then posting 
your code with a description of your use case to 
http://twistedmatrix.com/bugs/ so there can be a discussion about how 
to best change Twisted's interfaces around a bit so that this kind of 
throttling policy can be implemented in a future release of Twisted 
without digging into objects beyond their declared interfaces.

I could be mistaken, though.  I'm not an expert on twisted.internet, 
but I poked around it a bit when writing my own reactor.

-bob




From andrew-twisted at puzzling.org  Tue Sep 23 23:07:01 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 24 Sep 2003 15:07:01 +1000
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309232307470.20897-100000@forty-thieves.cis.upenn.edu>
References: <20030923123006.16835370.itamar@itamarst.org> <Pine.LNX.4.44.0309232307470.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030924050701.GA9443@frobozz>

On Wed, Sep 24, 2003 at 12:08:48AM -0400, Yun Mao wrote:
> 
> In a non-blocking implementation, what socksv4 did is something like:
> 
>    def dataReceived(data):
> 	otherConn.transport.write(data)
> 
> However, if source is a much faster link than dest, would there be a 
> problem? write always return even it should block so that read always 
> happens, and the buffer of source tcp connection will never get full, to 
> let tcp start flow control?

Twisted will merrily buffer as much data as necessary if the connection
isn't ready for writing.  Unless you are talking about very large amounts of
data, I doubt this would be a serious problem.  I'm guessing here though;
real benchmarks are welcome :)

Still, if it is a problem -- or you're just sufficiently concerned to care
about it anyway :) -- you could use producers and consumers to effectively
throttle the upstream connection (the producer) when the downstream
connection's (the consumer) buffers are full.  Probably something like
twisted.protocols.pcp.ProducerConsumerProxy would help here.

-Andrew.




From maoy at cis.upenn.edu  Tue Sep 23 23:16:06 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 01:16:06 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <39B38394-EE4A-11D7-A788-000A95686CD8@redivi.com>
Message-ID: <Pine.LNX.4.44.0309240053590.20897-100000@forty-thieves.cis.upenn.edu>

Is it true that the only way to see the success of write() is to check the 
FileDescriptor.dataBuffer? 

I'm thinking that suppose there is one way to check this, and I can
somehow add a callback function to the success of each write(), then I can
simply call source.stopReading() after write() and startReading() when I
get callback.

Yun


On Wed, 24 Sep 2003, Bob Ippolito wrote:

> On Wednesday, Sep 24, 2003, at 00:08 America/New_York, Yun Mao wrote:
> 
> > I tried to use twisted python to write a proxy following the given
> > socksv4 example.
> >
> > The problem i discovered is that: when i try to forward two 
> > connections,
> > their capacities may not match.
> >
> > In a blocking implementation,
> >            data = source.read(); dest.write(data);
> >
> > In a non-blocking implementation, what socksv4 did is something like:
> >
> >    def dataReceived(data):
> > 	otherConn.transport.write(data)
> >
> > However, if source is a much faster link than dest, would there be a
> > problem? write always return even it should block so that read always
> > happens, and the buffer of source tcp connection will never get full, 
> > to
> > let tcp start flow control?
> 
> With that code, you are right.  Twisted will buffer everything for 
> dest.. so you won't lose any packets, but you might start using a lot 
> of memory and source may think that dest has a faster connection than 
> dest actually does.
> 
> The twisted.internet.policies module can throttle transports, however I 
> don't think that any of them can actually determine how fast dest is 
> actually consuming the data.  That would require introspecting the 
> underlying transport's buffer and I don't believe the transport 
> interface has any way of doing that.
> 
> You could break the rules and assume that there is a dataBuffer 
> attribute (from twisted.internet.abstract.FileDescriptor) which would 
> most likely work, until you try and use it on a transport that is not a 
> FileDescriptor (wrapped by another policy, is a loopback for testing, 
> using a custom reactor, etc.).
> 
> In any case, yes, it's possible to solve this problem, but you will 
> have to write your own throttling policy which must bend the interface 
> rules in its implementation.
> 
> I would suggest writing the throttling policy code, and then posting 
> your code with a description of your use case to 
> http://twistedmatrix.com/bugs/ so there can be a discussion about how 
> to best change Twisted's interfaces around a bit so that this kind of 
> throttling policy can be implemented in a future release of Twisted 
> without digging into objects beyond their declared interfaces.
> 
> I could be mistaken, though.  I'm not an expert on twisted.internet, 
> but I poked around it a bit when writing my own reactor.
> 
> -bob
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 

-- 
Yun Mao
Ph.D Student, University of Pennsylvania
http://www.cis.upenn.edu/~maoy/





From andrew-twisted at puzzling.org  Tue Sep 23 23:45:40 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 24 Sep 2003 15:45:40 +1000
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309240053590.20897-100000@forty-thieves.cis.upenn.edu>
References: <39B38394-EE4A-11D7-A788-000A95686CD8@redivi.com> <Pine.LNX.4.44.0309240053590.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030924054540.GB9443@frobozz>

On Wed, Sep 24, 2003 at 01:16:06AM -0400, Yun Mao wrote:
> Is it true that the only way to see the success of write() is to check the 
> FileDescriptor.dataBuffer? 

There's another way -- if a FileDescriptor is consumer of a producer, it
will call the producer's pauseProducing when its buffer grows too large
(look at the abstract.FileDescriptor.write source).

> I'm thinking that suppose there is one way to check this, and I can
> somehow add a callback function to the success of each write(), then I can
> simply call source.stopReading() after write() and startReading() when I
> get callback.

You really don't want to do this manually -- you're just going to reinvent
Twisted's producers/consumers infrastructure.  See my other reply.

-Andrew.




From bob at redivi.com  Wed Sep 24 00:19:39 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 24 Sep 2003 02:19:39 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309240053590.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <13BD1B30-EE57-11D7-A788-000A95686CD8@redivi.com>

You won't be able to register a callback to it.. on second thought, you 
may be able to proxy writeSomeData and look at the result to see how 
much data got written, but I think that the reactor may have the actual 
FileDescriptor registered so you'd have to do some more trickery.

On Wednesday, Sep 24, 2003, at 01:16 America/New_York, Yun Mao wrote:

> Is it true that the only way to see the success of write() is to check 
> the
> FileDescriptor.dataBuffer?
>
> I'm thinking that suppose there is one way to check this, and I can
> somehow add a callback function to the success of each write(), then I 
> can
> simply call source.stopReading() after write() and startReading() when 
> I
> get callback.
>
> Yun
>
>
> On Wed, 24 Sep 2003, Bob Ippolito wrote:
>
>> On Wednesday, Sep 24, 2003, at 00:08 America/New_York, Yun Mao wrote:
>>
>>> I tried to use twisted python to write a proxy following the given
>>> socksv4 example.
>>>
>>> The problem i discovered is that: when i try to forward two
>>> connections,
>>> their capacities may not match.
>>>
>>> In a blocking implementation,
>>>            data = source.read(); dest.write(data);
>>>
>>> In a non-blocking implementation, what socksv4 did is something like:
>>>
>>>    def dataReceived(data):
>>> 	otherConn.transport.write(data)
>>>
>>> However, if source is a much faster link than dest, would there be a
>>> problem? write always return even it should block so that read always
>>> happens, and the buffer of source tcp connection will never get full,
>>> to
>>> let tcp start flow control?
>>
>> With that code, you are right.  Twisted will buffer everything for
>> dest.. so you won't lose any packets, but you might start using a lot
>> of memory and source may think that dest has a faster connection than
>> dest actually does.
>>
>> The twisted.internet.policies module can throttle transports, however 
>> I
>> don't think that any of them can actually determine how fast dest is
>> actually consuming the data.  That would require introspecting the
>> underlying transport's buffer and I don't believe the transport
>> interface has any way of doing that.
>>
>> You could break the rules and assume that there is a dataBuffer
>> attribute (from twisted.internet.abstract.FileDescriptor) which would
>> most likely work, until you try and use it on a transport that is not 
>> a
>> FileDescriptor (wrapped by another policy, is a loopback for testing,
>> using a custom reactor, etc.).
>>
>> In any case, yes, it's possible to solve this problem, but you will
>> have to write your own throttling policy which must bend the interface
>> rules in its implementation.
>>
>> I would suggest writing the throttling policy code, and then posting
>> your code with a description of your use case to
>> http://twistedmatrix.com/bugs/ so there can be a discussion about how
>> to best change Twisted's interfaces around a bit so that this kind of
>> throttling policy can be implemented in a future release of Twisted
>> without digging into objects beyond their declared interfaces.
>>
>> I could be mistaken, though.  I'm not an expert on twisted.internet,
>> but I poked around it a bit when writing my own reactor.
>>
>> -bob
>>
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>
> -- 
> Yun Mao
> Ph.D Student, University of Pennsylvania
> http://www.cis.upenn.edu/~maoy/
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From matt at sprout.org  Wed Sep 24 10:08:42 2003
From: matt at sprout.org (Matt Boersma)
Date: Wed, 24 Sep 2003 10:08:42 -0600
Subject: [Twisted-Python] 1.0.7 Windows installer bug?
Message-ID: <20030924100842.A28206@sprout.org>

Hello twisters:

I've been developing a PB application on Debian Linux, and it
has gone quite well.  But a coworker wants to test things on
Windows.  <sigh>

I've done nothing intentionally platform-specific, so I don't
think there will be any problems here.  I went to install the
1.0.7 binary release on my Win2K test box to verify this, but
after nearly completing the install, it errors out with:

Unable to execute file: ACK\pythonw.exe
CreateProcess failed; code 2.
The system cannot find the file specified
 
Where is it getting "ACK" from?  I have a standard binary
install of python2.3 from www.python.org on Win2K SP3, and
PYTHONHOME is set to "C:\Python2.3".

Any clues would be much appreciated.

Matt
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030924/e7ac6188/attachment.sig>

From corydodt at yahoo.com  Wed Sep 24 10:50:31 2003
From: corydodt at yahoo.com (Cory Dodt)
Date: Wed, 24 Sep 2003 09:50:31 -0700
Subject: [Twisted-Python] 1.0.7 Windows installer bug?
In-Reply-To: <20030924100842.A28206@sprout.org>
References: <20030924100842.A28206@sprout.org>
Message-ID: <3F71CB57.2050402@yahoo.com>

"ACK" is the emergency value I inserted in case it can't find the 
following registry key:

HKLM\Software\Python\PythonCore\2.3\InstallPath\<default>

Please open an issue in the tracker for this: 
http://twistedmatrix.com/bugs .  If you can describe there how you 
installed Python that might give me a hint for solving it.  I haven't 
been able to reproduce this bug on any of my systems but you're the 
second person who has reported it.

---

As a temporary measure, installing Twisted without the Windows installer 
isn't terrible; get the source and follow the instructions here:
http://cvs.twistedmatrix.com/cvs/win32/README.win32?rev=1.5&content-type=text/vnd.viewcvs-markup

C


Matt Boersma wrote:

>Hello twisters:
>
>I've been developing a PB application on Debian Linux, and it
>has gone quite well.  But a coworker wants to test things on
>Windows.  <sigh>
>
>I've done nothing intentionally platform-specific, so I don't
>think there will be any problems here.  I went to install the
>1.0.7 binary release on my Win2K test box to verify this, but
>after nearly completing the install, it errors out with:
>
>Unable to execute file: ACK\pythonw.exe
>CreateProcess failed; code 2.
>The system cannot find the file specified
> 
>Where is it getting "ACK" from?  I have a standard binary
>install of python2.3 from www.python.org on Win2K SP3, and
>PYTHONHOME is set to "C:\Python2.3".
>
>Any clues would be much appreciated.
>
>Matt
>  
>





From maoy at cis.upenn.edu  Wed Sep 24 11:35:32 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 13:35:32 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <20030924054540.GB9443@frobozz>
Message-ID: <Pine.LNX.4.44.0309241334420.8799-100000@forty-thieves.cis.upenn.edu>

Is there any doc/example about producer/consumer? What is that streaming 
argument for?

Thanks.

-Y

On Wed, 24 Sep 2003, Andrew Bennetts wrote:

> On Wed, Sep 24, 2003 at 01:16:06AM -0400, Yun Mao wrote:
> > Is it true that the only way to see the success of write() is to check the 
> > FileDescriptor.dataBuffer? 
> 
> There's another way -- if a FileDescriptor is consumer of a producer, it
> will call the producer's pauseProducing when its buffer grows too large
> (look at the abstract.FileDescriptor.write source).
> 
> > I'm thinking that suppose there is one way to check this, and I can
> > somehow add a callback function to the success of each write(), then I can
> > simply call source.stopReading() after write() and startReading() when I
> > get callback.
> 
> You really don't want to do this manually -- you're just going to reinvent
> Twisted's producers/consumers infrastructure.  See my other reply.
> 
> -Andrew.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 





From matt at sprout.org  Wed Sep 24 11:37:42 2003
From: matt at sprout.org (Matt Boersma)
Date: Wed, 24 Sep 2003 11:37:42 -0600
Subject: [Twisted-Python] 1.0.7 Windows installer bug? Solved.
Message-ID: <20030924113742.A11168@sprout.org>

Thanks Cory.  I believe I've found the issue, and I filed it
with the issue tracker.

In the Windows python 2.3 installer, you can choose either an
"admin" or "non-admin" install, the stated difference being 
that the core python DLLs go either in %WINDIR%\System32 or
in the %PYTHONHOME% directory.  (I don't know if this is a
new option in Python 2.3--we jumped straight from 2.1 to 2.3.)
Another difference is apparently that the Python registry keys
go into the HKEY_CURRENT_USER hive instead of the HKLM one.
Creating the (Default) REG_SZ key for InstallPath in the
HKLM hive works around the problem.

Matt
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030924/f06a0b61/attachment.sig>

From itamar at itamarst.org  Wed Sep 24 11:41:50 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 24 Sep 2003 13:41:50 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309241334420.8799-100000@forty-thieves.cis.upenn.edu>
References: <20030924054540.GB9443@frobozz>
	<Pine.LNX.4.44.0309241334420.8799-100000@forty-thieves.cis.upenn.edu>
Message-ID: <20030924134150.4320ce91.itamar@itamarst.org>

On Wed, 24 Sep 2003 13:35:32 -0400 (EDT)
Yun Mao <maoy at cis.upenn.edu> wrote:

> Is there any doc/example about producer/consumer? What is that
> streaming argument for?

Streaming means push, non-streaming means pull. The only real docs
available is 
http://itamarst.org/writings/OSCON03/twisted_internet-108.html

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From theller at python.net  Wed Sep 24 13:20:05 2003
From: theller at python.net (Thomas Heller)
Date: Wed, 24 Sep 2003 21:20:05 +0200
Subject: [Twisted-Python] Re: 1.0.7 Windows installer bug?
References: <20030924100842.A28206@sprout.org> <3F71CB57.2050402@yahoo.com>
Message-ID: <oexaf0yi.fsf@python.net>

Cory Dodt <corydodt at yahoo.com> writes:

> "ACK" is the emergency value I inserted in case it can't find the
> following registry key:
>
> HKLM\Software\Python\PythonCore\2.3\InstallPath\<default>
>
> Please open an issue in the tracker for this:
> http://twistedmatrix.com/bugs .  If you can describe there how you
> installed Python that might give me a hint for solving it.  I haven't
> been able to reproduce this bug on any of my systems but you're the
> second person who has reported it.

As Matt Boersma already discovered, a non-admin install doesn't write
*this* registry key. That's what you get for not using bdist_wininst
anymore to create the installer ;-) As the author, I'm interested why?

Thomas




From suneetha at sonic.net  Wed Sep 24 15:07:26 2003
From: suneetha at sonic.net (suneetha at sonic.net)
Date: Wed, 24 Sep 2003 14:07:26 -0700 (PDT)
Subject: [Twisted-Python] node with html content
Message-ID: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>

Hi,
   request.d.createTextNode(data) creates a text node and display the data
in the browser. I wanted to return a node in generate() method, that
display a web form instead of displaying the text. I created the node
with html content(string). Since I used createTextNode method, it is
displaying the html source instead of form. Is there any other method
that creates this kind of Node? If not how do I slove this?

Thank you,
Sunita.





From maoy at cis.upenn.edu  Wed Sep 24 15:20:16 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 17:20:16 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <20030924050701.GA9443@frobozz>
Message-ID: <Pine.LNX.4.44.0309240127270.20897-100000@forty-thieves.cis.upenn.edu>

OK. Here are some numbers:

First, I tried the bandwidth to download kernel from kernel.org: around 
150K/s reported from wget.

Then,

I wrote a little program to use twisted.protocols.socks:

application = Application("socks4 proxy")
application.listenTCP(1080, socks.SOCKSv4Factory("/tmp/socks.log"))

if '__main__' == __name__:
    application.run()

I start the program on my own machine, port 1080. 

After that I use a "sockify" program (tsocks) to use the "127.0.0.1:1080"  
proxy to download.  wget told me the speed is 4.10K/s Ideally, a proxy on 
localhost should bring almost 0 overhead, right? 

I also observe 100% cpu usage. A faster CPU may get better results. But,
still, what is going on here?

I modified socks.py and tried the producer idea, but it doesn't work.  
Maybe because the wrong usage?

Somebody can help me out? Thanks a lot!



> Twisted will merrily buffer as much data as necessary if the connection
> isn't ready for writing.  Unless you are talking about very large amounts of
> data, I doubt this would be a serious problem.  I'm guessing here though;
> real benchmarks are welcome :)
> 
> Still, if it is a problem -- or you're just sufficiently concerned to care
> about it anyway :) -- you could use producers and consumers to effectively
> throttle the upstream connection (the producer) when the downstream
> connection's (the consumer) buffers are full.  Probably something like
> twisted.protocols.pcp.ProducerConsumerProxy would help here.
> 
> -Andrew.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 

-- 
Yun Mao
Ph.D Student, University of Pennsylvania
http://www.cis.upenn.edu/~maoy/






From glyph at twistedmatrix.com  Wed Sep 24 15:34:26 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Wed, 24 Sep 2003 17:34:26 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309240127270.20897-100000@forty-thieves.cis.upenn.edu>
References: <Pine.LNX.4.44.0309240127270.20897-100000@forty-thieves.cis.upenn.edu>
Message-ID: <3F720DE2.1010104@twistedmatrix.com>

Yun Mao wrote:

> Somebody can help me out? Thanks a lot!

Wow!  These are some really bad numbers.  I don't know what to say 
except it looks like you're using things correctly.  Can you run this 
under the Python profiler and attach the output to an issue in the 
bugtracker?

The most likely answer is just that the SOCKS proxy has seen no 
optimization and is doing something silly like accidentally creating a 
huge number of string copies for no reason.




From stephen at thorne.id.au  Wed Sep 24 15:44:54 2003
From: stephen at thorne.id.au (Stephen Thorne)
Date: Thu, 25 Sep 2003 07:44:54 +1000
Subject: [Twisted-Python] node with html content
In-Reply-To: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>
References: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>
Message-ID: <3F721056.3080401@thorne.id.au>

suneetha at sonic.net wrote:

>Hi,
>   request.d.createTextNode(data) creates a text node and display the data
>in the browser. I wanted to return a node in generate() method, that
>display a web form instead of displaying the text. I created the node
>with html content(string). Since I used createTextNode method, it is
>displaying the html source instead of form. Is there any other method
>that creates this kind of Node? If not how do I slove this?
>  
>
Looking at twisted.web.woven.widgets.Text - if you want to return a node 
that contains 'Raw' text (i.e. text that doesn't need to be escaped - as 
in your case where you want to return form elements) you use

from twisted.web import domhelpers
textNode = domhelpers.RawText(data)
node.appendChild(textNode)

Does that answer your question.

I also highly recommend you have a good look at 'woven', and probably in 
your case specifically 'lmx'.

Regards,
Stephen Thorne






From stephen at thorne.id.au  Wed Sep 24 15:44:54 2003
From: stephen at thorne.id.au (Stephen Thorne)
Date: Thu, 25 Sep 2003 07:44:54 +1000
Subject: [Twisted-Python] node with html content
In-Reply-To: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>
References: <34802.131.243.2.52.1064437646.squirrel@ssl.sonic.net>
Message-ID: <3F721056.3080401@thorne.id.au>

suneetha at sonic.net wrote:

>Hi,
>   request.d.createTextNode(data) creates a text node and display the data
>in the browser. I wanted to return a node in generate() method, that
>display a web form instead of displaying the text. I created the node
>with html content(string). Since I used createTextNode method, it is
>displaying the html source instead of form. Is there any other method
>that creates this kind of Node? If not how do I slove this?
>  
>
Looking at twisted.web.woven.widgets.Text - if you want to return a node 
that contains 'Raw' text (i.e. text that doesn't need to be escaped - as 
in your case where you want to return form elements) you use

from twisted.web import domhelpers
textNode = domhelpers.RawText(data)
node.appendChild(textNode)

Does that answer your question.

I also highly recommend you have a good look at 'woven', and probably in 
your case specifically 'lmx'.

Regards,
Stephen Thorne






From maoy at cis.upenn.edu  Wed Sep 24 15:56:21 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 17:56:21 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <3F720DE2.1010104@twistedmatrix.com>
Message-ID: <Pine.LNX.4.44.0309241755170.10234-100000@forty-thieves.cis.upenn.edu>

I've put the profiling result to

http://www.twistedmatrix.com/users/roundup.twistd/twisted/file87/bugreport.txt

Forgot to mention the env: gentoo, python 2.2.3, twisted 1.0.7

Yun

On Wed, 24 Sep 2003, Glyph Lefkowitz wrote:

> 
> Wow!  These are some really bad numbers.  I don't know what to say 
> except it looks like you're using things correctly.  Can you run this 
> under the Python profiler and attach the output to an issue in the 
> bugtracker?
> 
> The most likely answer is just that the SOCKS proxy has seen no 
> optimization and is doing something silly like accidentally creating a 
> huge number of string copies for no reason.




From maoy at cis.upenn.edu  Wed Sep 24 15:59:28 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 17:59:28 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309241755170.10234-100000@forty-thieves.cis.upenn.edu>
Message-ID: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu>

It looks like the log function in line 141 is doing the silly thing. I 
disabled the log and it works fine now. :)

Yun

On Wed, 24 Sep 2003, Yun Mao wrote:

> 
> I've put the profiling result to
> 
> http://www.twistedmatrix.com/users/roundup.twistd/twisted/file87/bugreport.txt
> 
> Forgot to mention the env: gentoo, python 2.2.3, twisted 1.0.7
> 
> Yun




From bob at redivi.com  Wed Sep 24 16:30:06 2003
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 24 Sep 2003 18:30:06 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu>
Message-ID: <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>

yay for profiling :)

oh wow that's definitely going to be slow:
             f.write(string.join(map(lambda x:'%02X'%ord(x),p),' ')+' ')

It's just that one line of code killing all your performance :)  That  
little loop could (probably) be done MUCH more efficiently by using  
something like:
map('%02X'.__mod__, struct.unpack('B' * len(data), data))

instead of doing it 16 at a time with lambda and ord.

Just out of curiosity, how does your performance and CPU utilization  
look now, without logging on?  I don't hear much about Twisted and  
performance.. Maybe it's not bad enough to complain about, or perhaps  
nobody has deployed twisted apps that see excessive load, but I haven't  
heard much either way.

-bob

On Wednesday, Sep 24, 2003, at 17:59 America/New_York, Yun Mao wrote:

> It looks like the log function in line 141 is doing the silly thing. I
> disabled the log and it works fine now. :)
>
> On Wed, 24 Sep 2003, Yun Mao wrote:
>
>>
>> I've put the profiling result to
>>
>> http://www.twistedmatrix.com/users/roundup.twistd/twisted/file87/ 
>> bugreport.txt
>>
>> Forgot to mention the env: gentoo, python 2.2.3, twisted 1.0.7




From maoy at cis.upenn.edu  Wed Sep 24 18:07:19 2003
From: maoy at cis.upenn.edu (Yun Mao)
Date: Wed, 24 Sep 2003 20:07:19 -0400 (EDT)
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
Message-ID: <Pine.LNX.4.44.0309242003280.10234-100000@forty-thieves.cis.upenn.edu>

On Wed, 24 Sep 2003, Bob Ippolito wrote:

> look now, without logging on?  I don't hear much about Twisted and  
> performance.. Maybe it's not bad enough to complain about, or perhaps  
> nobody has deployed twisted apps that see excessive load, but I haven't  
> heard much either way.
> 
> -bob
> 

The two download speed have no major difference now. The CPU load varies 
from 2% to 10% from me watching top.

You may here from performance report (or complain) from me in the near 
future. :)

-y





From itamar at itamarst.org  Wed Sep 24 18:11:11 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 24 Sep 2003 20:11:11 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
References: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu>
	<A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
Message-ID: <20030924201111.56a18d39.itamar@itamarst.org>

On Wed, 24 Sep 2003 18:30:06 -0400
Bob Ippolito <bob at redivi.com> wrote:

> look now, without logging on?  I don't hear much about Twisted and  
> performance.. Maybe it's not bad enough to complain about, or perhaps 
> 
> nobody has deployed twisted apps that see excessive load, but I
> haven't  heard much either way.

Strakt were having some performance issues when sending large amounts of
data, but JP's buffer() changes (went in in version 1.0.5? 6?) solved
them.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From andrew-twisted at puzzling.org  Wed Sep 24 22:10:56 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 25 Sep 2003 14:10:56 +1000
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
References: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu> <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com>
Message-ID: <20030925041056.GG13554@frobozz>

On Wed, Sep 24, 2003 at 06:30:06PM -0400, Bob Ippolito wrote:
> yay for profiling :)
> 
> oh wow that's definitely going to be slow:
>             f.write(string.join(map(lambda x:'%02X'%ord(x),p),' ')+' ')
> 
> It's just that one line of code killing all your performance :)  That  
> little loop could (probably) be done MUCH more efficiently by using  
> something like:
> map('%02X'.__mod__, struct.unpack('B' * len(data), data))
> 
> instead of doing it 16 at a time with lambda and ord.

Probably just "data.encode('hex')" would be fine?

-Andrew.




From exarkun at intarweb.us  Wed Sep 24 22:46:16 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 25 Sep 2003 00:46:16 -0400
Subject: [Twisted-Python] twisted socksv4 proxy
In-Reply-To: <20030925041056.GG13554@frobozz>
References: <Pine.LNX.4.44.0309241758340.10234-100000@forty-thieves.cis.upenn.edu> <A5FDAEA6-EEDE-11D7-A788-000A95686CD8@redivi.com> <20030925041056.GG13554@frobozz>
Message-ID: <20030925044616.GA20253@intarweb.us>

On Thu, Sep 25, 2003 at 02:10:56PM +1000, Andrew Bennetts wrote:
> On Wed, Sep 24, 2003 at 06:30:06PM -0400, Bob Ippolito wrote:
> > yay for profiling :)
> > 
> > oh wow that's definitely going to be slow:
> >             f.write(string.join(map(lambda x:'%02X'%ord(x),p),' ')+' ')
> > 
> > It's just that one line of code killing all your performance :)  That  
> > little loop could (probably) be done MUCH more efficiently by using  
> > something like:
> > map('%02X'.__mod__, struct.unpack('B' * len(data), data))
> > 
> > instead of doing it 16 at a time with lambda and ord.
> 
> Probably just "data.encode('hex')" would be fine?
> 

  Especially since str.__mod__ is a pretty recent development (ie, not in
2.2).

  Or one could ask why exactly the data needs to be hex encoded at all...

  Jp

-- 
"Pascal is Pascal is Pascal is dog meat."
                -- M. Devine and P. Larson, Computer Science 340
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030925/885d5bcb/attachment.sig>

From miguel at yorku.ca  Thu Sep 25 10:06:07 2003
From: miguel at yorku.ca (Miguel Marques)
Date: Thu, 25 Sep 2003 12:06:07 -0400 (EDT)
Subject: [Twisted-Python] twisted.python.log usage...
Message-ID: <20030925.120607.85406867.miguel@yorku.ca>

Greetings...

I've just started using twisted and I have a question about logging.
I have a server which uses twisted.python.log.  I open a file and then
call log.startLogging with it.  I then start a number of worker threads and
then instantiate an Application and run it.   All log.msg from the
main program have the server name I passed when I instantiaed the Application.
When I call log.msg from the threads the name is just [-].
I know I can call msg with system='servername' everytime but I thought
that I could have the lass that implements the running worker threads
inherit from Logger and override logPrefix but that doesn't seem to work.
I obviously (or so I think) need to insert system='servername' in the ILogContext
for each of my threads but it isn't all that clear to me how to do that.
I'm confused (and I don't even have an opulent toilet ;-) )
TIA for any help...

							Miguel

C. Miguel Marques, Development Services, Computing and Network Services, York University
e-mail: miguel at yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830



From tim.stebbing at nunatak.com.au  Thu Sep 25 16:15:40 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri, 26 Sep 2003 08:15:40 +1000 (EST)
Subject: [Twisted-Python] a little pattern prototype ?
Message-ID: <33046.144.139.77.34.1064528140.squirrel@www.deepdesign.com.au>

This is just a very basic and incomplete prototype of a framework/pattern
based on twisted.web.resource. Id be interested in peoples comments on
the concept as a whole.

Okay, The idea is that you create many components 'facets' which return
a particular chunk of html that will be displayed inside an absolutly
positioned <div>. These facets will be able to communicate with each other
via the concept of 'broadcasters' and 'observers'. What this means is that
a facet can register its wish to be notified of a particular event, or a
facet can broadcast an event to all other facets.

Facets are combined into single html pages (prisms), which will manage
placing facet content in divs. A single facet can appear on mny prisms.

A special type of facet that Im yet to implement is called the 'request
facet'. This will have no render output, but will manage post, get values
by broadcasting them to other facets. This could also handle any events,
ie livePage.

This might be a stupid idea, thats why Im posting it now while Im
prototyping it so I can get suggestions/flames. Its just something that
I thought up at work the other day and thought might be interesting to try.

-tjs

See attached tarball.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: crystals.tgz
Type: application/x-gzip
Size: 4451 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030926/5605116c/attachment-0002.bin>

From glyph at twistedmatrix.com  Thu Sep 25 17:40:12 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 25 Sep 2003 19:40:12 -0400
Subject: [Twisted-Python] a little pattern prototype ?
In-Reply-To: <33046.144.139.77.34.1064528140.squirrel@www.deepdesign.com.au>
References: <33046.144.139.77.34.1064528140.squirrel@www.deepdesign.com.au>
Message-ID: <3F737CDC.70905@twistedmatrix.com>

Timothy Stebbing wrote:

> Facets are combined into single html pages (prisms), which will manage
> placing facet content in divs. A single facet can appear on mny prisms.

Tim,

When I suggested "prism" as a metaphor, it was seriously the first word 
that came into my mind, and I intended it as a joke.  However, the 
pattern you've described sounds both elegant and accurately described by 
this metaphor.  I was laughing the whole time I read it :).

I don't entirely understand what you've done, but I have two quick thoughts:

	- Have you considered using Woven?  Event-broadcasting and updating 
facets in real time could be achieved with LivePage.  Also, since your 
output is HTML, woven could help with encapsulating the divs separately 
while guaranteeing that generation errors on one area of the page will 
not affect another.

	- What are your use cases?  e.g. what kind of a site benefits from 
using Crystals, and what doesn't?




From tim.stebbing at nunatak.com.au  Thu Sep 25 18:05:17 2003
From: tim.stebbing at nunatak.com.au (Tim Stebbing)
Date: Fri, 26 Sep 2003 10:05:17 +1000
Subject: [Twisted-Python] a little pattern prototype ?
In-Reply-To: <3F737CDC.70905@twistedmatrix.com>
References: <33046.144.139.77.34.1064528140.squirrel@www.deepdesign.com.au> <3F737CDC.70905@twistedmatrix.com>
Message-ID: <3F7382BD.4030602@nunatak.com.au>

Glyph Lefkowitz wrote:
> Timothy Stebbing wrote:
> 
>> Facets are combined into single html pages (prisms), which will manage
>> placing facet content in divs. A single facet can appear on mny prisms.
> 
> 
> Tim,
> 
> When I suggested "prism" as a metaphor, it was seriously the first word 
> that came into my mind, and I intended it as a joke.  However, the 
> pattern you've described sounds both elegant and accurately described by 
> this metaphor.  I was laughing the whole time I read it :).
> 
> I don't entirely understand what you've done, but I have two quick 
> thoughts:
> 
>     - Have you considered using Woven?  Event-broadcasting and updating 
> facets in real time could be achieved with LivePage.  Also, since your 
> output is HTML, woven could help with encapsulating the divs separately 
> while guaranteeing that generation errors on one area of the page will 
> not affect another.
>

The initial prototype I posted only took a few hours because I used 
resources rather than woven (which is great but is more time-consuming 
when I just wanted to get html on the screen to test an idea)

If people are interested in this pattern I would definitely write it 
either on top of, or extending woven.

>     - What are your use cases?  e.g. what kind of a site benefits from 
> using Crystals, and what doesn't?

It had no use-cases when I started, I just wanted to test an idea.

However, I could see the 'crystals' pattern being of major benefit in a 
site that is highly modular, such as a groupware application/portal 
where individual modules are often written totally separately and turned 
on/off with user prefs.

The site could have an API of broadcasters/observers, its own internal 
event system or whatever (a broadcasting reactor?). A module developer 
would only need to write a few facets and perhaps a prism to access the 
sites events and to get their info on the screen, in whatever way the 
site wants modules to be displayed.

-tjs





From typo at soniq.net  Fri Sep 26 02:56:07 2003
From: typo at soniq.net (Paul Boehm)
Date: Fri, 26 Sep 2003 10:56:07 +0200
Subject: [Twisted-Python] twisted.python.log usage...
In-Reply-To: <20030925.120607.85406867.miguel@yorku.ca>
References: <20030925.120607.85406867.miguel@yorku.ca>
Message-ID: <20030926085607.GD23023@soniq.net>

On Thu, Sep 25, 2003 at 12:06:07PM -0400, Miguel Marques wrote:
> I know I can call msg with system='servername' everytime but I thought
> that I could have the lass that implements the running worker threads
> inherit from Logger and override logPrefix but that doesn't seem to work.
> I obviously (or so I think) need to insert system='servername' in the ILogContext
> for each of my threads but it isn't all that clear to me how to do that.
> I'm confused (and I don't even have an opulent toilet ;-) )
> TIA for any help...

the way i presume it is supposed to be done, is to use
log.callWithLogger(), which automagically sets up a new context, until
the called method returns.

but logging contexts are at best sparingly used within twisted itself,
and i think the concept either needs rethinking, or at least should be
_used_ in twisted mainline, where it makes sense.

imho Protocols should be their own Loggers by default, because right now
the msg's i write from a protocol appear with the factory's context,
which can be confusing and misleading.

also i think it's a problem with logging, that protocols/factories by
default are not very verbose when a new client has connected.. (has
anything changed since i last looked? do they log anything at all?)

  paul



From typo at soniq.net  Fri Sep 26 02:56:22 2003
From: typo at soniq.net (Paul Boehm)
Date: Fri, 26 Sep 2003 10:56:22 +0200
Subject: [Twisted-Python] please remove sibling,parents etc. from plugins.tml
Message-ID: <20030926085622.GE23023@soniq.net>

they're still in plugins.tml in cvs



From alienoid at is.lg.ua  Fri Sep 26 08:08:58 2003
From: alienoid at is.lg.ua (Ruslan Spivak)
Date: Fri, 26 Sep 2003 17:08:58 +0300
Subject: [Twisted-Python] adbapi question
Message-ID: <3F74487A.8030309@is.lg.ua>

Hello.


from twisted.enterprise import adbapi
from twisted.internet import reactor
from twisted.spread import pb

DB_HOST = "localhost"
DB_USER = "root"
DB_PASSWD = "xxx"
DB_NAME = "account"

class DBException(pb.Error): pass

dbpool = adbapi.ConnectionPool("MySQLdb", host=DB_HOST, user=DB_USER, 
passwd=DB_PASSWD, db=DB_NAME)

# Database checking
def getClientsDBParams(username):
     _sql = """
     SELECT username, password, ip, netmask, mac FROM bunkernet_clients
         WHERE username='%s'
     """ % username
     return dbpool.runQuery(_sql)

def dbClientSucceeded(self, l):
     if l:
         print l
     else:
         print "no records"
         raise DBException("No records")


def dbClientFailed():
     print "Failed!"
     reactor.stop()

getClientsDBParams('alienoid').addCallbacks(dbClientSucceeded, 
dbClientFailed)
reactor.run()


The problem here is that when dbClientSucceeded is executed and i get 
"no records" - i don't get exception. Only when i press Ctrl + C on 
server i get those DBException. This code will be executed when remote 
client connects to server and i want those DBException be passed to 
remote client but i can't get it, can get it only with Ctrl + C

Your help is very appreciated.
Thanks in advance.

Best regards,
Ruslan




From exarkun at intarweb.us  Fri Sep 26 08:41:28 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 26 Sep 2003 10:41:28 -0400
Subject: [Twisted-Python] adbapi question
In-Reply-To: <3F74487A.8030309@is.lg.ua>
References: <3F74487A.8030309@is.lg.ua>
Message-ID: <20030926144128.GA3751@intarweb.us>

On Fri, Sep 26, 2003 at 05:08:58PM +0300, Ruslan Spivak wrote:
> [snip]
> 
> 
> def dbClientFailed():
>     print "Failed!"
>     reactor.stop()
> 
> getClientsDBParams('alienoid').addCallbacks(dbClientSucceeded, 
> dbClientFailed)
> reactor.run()
> 
> 
> The problem here is that when dbClientSucceeded is executed and i get 
> "no records" - i don't get exception. Only when i press Ctrl + C on 
> server i get those DBException. This code will be executed when remote 
> client connects to server and i want those DBException be passed to 
> remote client but i can't get it, can get it only with Ctrl + C
> 
> Your help is very appreciated.
> Thanks in advance.

  Errbacks receive a single argument, the failure that caused them to be
caused.  Unfortunately, if you define your errback to take no arguments (as
you have), that error becomes a failure, which would pass on to the next
errback if it were registered, or, as in your code, would be silenced if
there are no more errbacks.

  Redefine dbClientFailed to take an argument and you should see the
behavior you expect.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030926/231548a7/attachment.sig>

From golux at comcast.net  Thu Sep 25 20:55:01 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Thu, 25 Sep 2003 22:55:01 -0400
Subject: [Twisted-Python] twisted.news adbapi backend
Message-ID: <3F73AA85.3090004@comcast.net>

I'm guessing this has never been used (at least with
pyPgSQL, anyway), since it has a function listRequest
defined thusly:

def listRequest(self):
         # COALESCE may not be totally portable
         # it is shorthand for
         # CASE WHEN (first parameter) IS NOT NULL then (first 
parameter) ELSE (second parameter) END
         sql = """
             SELECT groups.name,
                 COALESCE(MAX(postings.article_index), 0),
                 COALESCE(MIN(postings.article_index), 0),
                 groups.flags
             FROM groups LEFT OUTER JOIN postings
             ON postings.group_id = groups.group_id
             GROUP BY groups.name, groups.flags
             ORDER BY groups.name
         """
         return self.runQuery(sql)

... but PostgreSQL doesn't implement a COALESCE command.

And my next guess would be that it's never been tested,
either.  Correct?

If so, maybe it should be either be fixed or jettisoned,
or at least relegated to the sandbox.

- Steve.




From exarkun at intarweb.us  Fri Sep 26 17:10:09 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 26 Sep 2003 19:10:09 -0400
Subject: [Twisted-Python] twisted.news adbapi backend
In-Reply-To: <3F73AA85.3090004@comcast.net>
References: <3F73AA85.3090004@comcast.net>
Message-ID: <20030926231009.GA4416@intarweb.us>

On Thu, Sep 25, 2003 at 10:55:01PM -0400, Stephen C. Waterbury wrote:
> I'm guessing this has never been used (at least with
> pyPgSQL, anyway), since it has a function listRequest
> defined thusly:

> 
> [snip]
> 
> ... but PostgreSQL doesn't implement a COALESCE command.
> 

  Indeed.  I developed it while I was still using MySQL.

  I was surprised to read that PostgreSQL doesn't implement COALESCE, so I
checked the docs.  They claim it has been supported since 6.5.  Are you
running an expecially old version? :)

> 
> And my next guess would be that it's never been tested,
> either.  Correct?

  Probably not.  I certainly haven't, and the unit test coverage for this
backend is non-existent.  I was tempted to remove it a long time ago, but
decided to leave it in in case anyone wanted to build on top of it.

  It's probably not great database code.  Deprecating it now and removing it
in a while sounds like a good idea.

  Jp

-- 
Python/C/Linux/Smalltalk/Java
Genetic Algorithms, Genetic Programming, Neural Networks
Networking, asynchronous applications, legacy maintenance
See my complete resume at http://intarweb.us:8080/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030926/3527c810/attachment.sig>

From golux at comcast.net  Fri Sep 26 07:36:46 2003
From: golux at comcast.net (Stephen C. Waterbury)
Date: Fri, 26 Sep 2003 09:36:46 -0400
Subject: [Twisted-Python] adbapi transaction stuff (was Re: twisted.news adbapi backend)
In-Reply-To: <20030926231009.GA4416@intarweb.us>
References: <3F73AA85.3090004@comcast.net> <20030926231009.GA4416@intarweb.us>
Message-ID: <3F7440EE.3020209@comcast.net>

Hi Jp,

Jp Calderone wrote:
> On Thu, Sep 25, 2003 at 10:55:01PM -0400, Stephen C. Waterbury wrote:

>>... but PostgreSQL doesn't implement a COALESCE command.
>>
>   I was surprised to read that PostgreSQL doesn't implement COALESCE, so I
> checked the docs.  They claim it has been supported since 6.5.  Are you
> running an expecially old version? :)

Hm ... you mean I should actually check to see if it works
before assuming it's not there?  Doh!  I was going by the
fact that the psql \h didn't have anything on it, but
you're absolutely right -- it's there and works as
advertised.  (I guess \h only documents the big, top-level
commands -- not functions/expressions.)

>   It's probably not great database code.  Deprecating it now and removing it
> in a while sounds like a good idea.

I don't think it looks bad, really ... just seemed like
it had never been used.

Actually, the only reason I was looking at it was that it
was the only example I could find of code that used the adbapi
runInteraction() and transaction stuff, so it looked like
it might be useful to me at first, but I couldn't figure
out how to get a Transaction to do a "SET CONSTRAINTS
ALL DEFERRED", which I need for my transactions.
(I did it in the transaction.execute(), but it didn't
seem to have any effect, so I wasn't sure if it really
applied ... I assume they are supposed to, for a
given runInteraction scope, right?)

Anyway, I went ahead and made a "transaction builder" that
puts together a whole SQL transaction statement that I can
give to runOperation, and that seems to work just fine --
which might actually be easier and faster anyway, since it
lets PostgreSQL do its own optimization things, etc.

Still, the adbapi transaction stuff is intriguing,
so let me know if I'm missing something there -- e.g.,
if you know how to use it to do an SQL transaction with
deferred constraints.  What I was hoping it did was
incrementally execute stuff and just commit when the
runInteraction call ended.

Cheers,
Steve.




From fog at initd.org  Sat Sep 27 04:07:15 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Sat, 27 Sep 2003 12:07:15 +0200
Subject: [Twisted-Python] adbapi transaction stuff (was Re:
	twisted.news adbapi backend)
In-Reply-To: <3F7440EE.3020209@comcast.net>
References: <3F73AA85.3090004@comcast.net>
	 <20030926231009.GA4416@intarweb.us>  <3F7440EE.3020209@comcast.net>
Message-ID: <1064657235.6280.2.camel@localhost>

Il ven, 2003-09-26 alle 15:36, Stephen C. Waterbury ha scritto:
[snip]
> Anyway, I went ahead and made a "transaction builder" that
> puts together a whole SQL transaction statement that I can
> give to runOperation, and that seems to work just fine --
> which might actually be easier and faster anyway, since it
> lets PostgreSQL do its own optimization things, etc.

you may be interested in

    http://cvs.initd.org/cgi-bin/viewcvs.cgi/wabba/

glade binding of data coming from a database:

    http://cvs.initd.org/cgi-bin/viewcvs.cgi/pox/

and an example of usage:

     http://cvs.initd.org/cgi-bin/viewcvs.cgi/wilma/

(official release in the near future...)

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
  Gli avvoltoi cinesi si nutrono di arte, ma possono anche mangiare
   i `domani'.                                        -- Haruki Murakami
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio  firmata
URL: </pipermail/twisted-python/attachments/20030927/e9857f14/attachment.sig>

From foom at fuhm.net  Sat Sep 27 11:23:13 2003
From: foom at fuhm.net (James Y Knight)
Date: Sat, 27 Sep 2003 13:23:13 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] crud
In-Reply-To: <E1A3GL0-0006VH-00@wolfwood>
Message-ID: <460D361C-F10F-11D7-B097-000A95A50FB2@fuhm.net>

On Saturday, September 27, 2003, at 10:46 AM, exarkun CVS wrote:
> ViewCVS links:
> http://twistedmatrix.com/users/jh.twistd/viewcvs/cgi/viewcvs.cgi/ 
> sandbox/exarkun/ 
> crud.py.diff?r1=text&tr1=1.1&r2=text&tr2=1.2&cvsroot=Twisted

None of the links in the cvs commit mails work, probably as they don't  
point to cvs.twistedmatrix.org.

James




From paul at soniq.net  Sat Sep 27 16:17:00 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 00:17:00 +0200
Subject: [Twisted-Python] clean up app.getApplication
Message-ID: <20030927221700.GA1541@soniq.net>

i was doing something else, couldn't quite understand the code at first
(where does the listcomp begin, where does it end?), so here's a more
explicit version:

Index: app.py
===================================================================
RCS file: /cvs/Twisted/twisted/application/app.py,v
retrieving revision 1.3
diff -u -r1.3 app.py
--- app.py  21 Sep 2003 01:07:23 -0000  1.3
+++ app.py  27 Sep 2003 22:16:16 -0000
@@ -81,9 +81,14 @@
         return None
 
 def getApplication(config, passphrase):
-    s = [(config[t], t)
-           for t in ['python', 'xml', 'source', 'file'] if config[t]][0]
-    filename, style = s[0], {'file':'pickle'}.get(s[1],s[1])
+    for t in ['python', 'xml', 'source', 'file', 'tapdir', None]:
+        style = t
+        filename = config[style]
+        if filename:
+            break
+    if style == 'file':
+        style = 'pickle'
+
     try:
         log.msg("Loading %s..." % filename)
         application = service.loadApplication(filename, style, passphrase)




From exarkun at intarweb.us  Sat Sep 27 16:37:23 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 27 Sep 2003 18:37:23 -0400
Subject: [Twisted-Python] clean up app.getApplication
In-Reply-To: <20030927221700.GA1541@soniq.net>
References: <20030927221700.GA1541@soniq.net>
Message-ID: <20030927223723.GA17517@intarweb.us>

On Sun, Sep 28, 2003 at 12:17:00AM +0200, Paul Boehm wrote:
> i was doing something else, couldn't quite understand the code at first
> (where does the listcomp begin, where does it end?), so here's a more
> explicit version:

  That original version was pretty icky, yea.

  Thangs for posting this here (though someone may tell you it belongs on
the bug tracker at http://www.twistedmatrix.com/bugs/, which it probably
does), because it reminded me of something we should be able to get rid of
now.

  "python" style is indicated by the string "python".
  "xml" style is indicated by the string "xml".
  "source" style is indicated by the string "source".
  "pickle" style is indicated by the string "file".

  Now, let's play a game that everyone who's watched Seasame Street should
know -- Which of these things is not like the others?

  Is there any reason *not* to fix this now?

  Jp

> [snip]
> +    for t in ['python', 'xml', 'source', 'file', 'tapdir', None]:
> +        style = t
> +        filename = config[style]
> +        if filename:
> +            break
> +    if style == 'file':
> +        style = 'pickle'
> +
> [snip]

-- 
Examinations are formidable even to the best prepared, for
even the greatest fool may ask more than the wisest man can answer.
                -- C.C. Colton
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030927/7ff0a1f1/attachment.sig>

From paul at soniq.net  Sat Sep 27 16:58:04 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 00:58:04 +0200
Subject: modularize strport parsers Re: [Twisted-Python] clean up app.getApplication
In-Reply-To: <20030927223723.GA17517@intarweb.us>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us>
Message-ID: <20030927225804.GA1671@soniq.net>

On Sat, Sep 27, 2003 at 06:37:23PM -0400, Jp Calderone wrote:
>   Thangs for posting this here (though someone may tell you it belongs on
> the bug tracker at http://www.twistedmatrix.com/bugs/, which it probably
> does)

ugh.. using webinterfaces without a mouse is horror.. so i'll do it
again and submit another patch here:

Index: strports.py
===================================================================
RCS file: /cvs/Twisted/twisted/application/strports.py,v
retrieving revision 1.1
diff -u -r1.1 strports.py
--- strports.py 26 Sep 2003 22:44:48 -0000  1.1
+++ strports.py 27 Sep 2003 22:56:19 -0000
@@ -46,12 +46,21 @@
 """
 from __future__ import generators
 
+_types = {}
+
+def registerType(name, helper):
+    global _types
+    _types[name] = helper
+    print _types
+
 def _parseTCP(factory, port, interface="", backlog=5):
     return (int(port), factory), {'interface': interface,
                                   'backlog': int(backlog)}
+registerType("tcp", _parseTCP)
 
 def _parseUNIX(factory, address, mode='666', backlog=5):
     return (address, factory), {'mode': int(mode, 8), 'backlog': int(backlog)}
+registerType("unix", _parseUNIX)
 
 def _parseSSL(factory, port, privateKey="server.pem", certKey=None,
               sslmethod=None, interface='', backlog=5):
@@ -64,10 +73,7 @@
     cf = ssl.DefaultOpenSSLContextFactory(privateKey, certKey, **kw)
     return ((int(port), factory, cf),
             {'interface': interface, 'backlog': int(backlog)})
-
-_funcs = {"tcp": _parseTCP,
-          "unix": _parseUNIX,
-          "ssl": _parseSSL}
+registerType("ssl", _parseSSL)
 
 _OP, _STRING = range(2)
 def _tokenize(description):
@@ -149,7 +155,7 @@
     args, kw = _parse(description)
     if not args or (len(args)==1 and not kw):
         args[0:0] = [default or 'tcp']
-    return (args[0].upper(),)+_funcs[args[0]](factory, *args[1:], **kw)
+    return (args[0].upper(),)+_types[args[0]](factory, *args[1:], **kw)
 
 def service(description, factory, default=None):
     """Return the service corresponding to a description




From mertz at gnosis.cx  Fri Sep 26 19:50:08 2003
From: mertz at gnosis.cx (David Mertz)
Date: Fri, 26 Sep 2003 21:50:08 -0400
Subject: [Twisted-Python] Book on Twisted?
Message-ID: <QzOd/kKkXEzQ092yn@gnosis.cx>                       

Twisties:

I reckon most of you saw my series of articles on Twisted over at IBM
developerWorks.  Heck, a small thread on this list even criticized some
of my examples :-).

Anyway, in response to my articles, a publisher approached me; and
basically asked me to write a book on Twisted for them (the note was a
little less straightforward than this, but that's the jist).

FWIW, I do not want to write a book on Twisted--at least not by myself.
However, I -do- think that having a good book--one that was helpful and
approachable to beginners--would be really nice to have on my shelf.  So
the idea picques my interst somewhat.

There are several things readers of this missive might do with the
information.  If someone else just has the notion of writing a book
themselves, I am very happy to put you in touch with my publishing
contact.  I cannot state one way or another whether this would be the
best publisher for such a book, but at least there's an incling of
interst there.  On the other hand, if someone is kinda intersted in
writing a book but unsure about the writing process, I might be
interested or willing to have a role in such a process.  Maybe
contributing author, active editor, tech reviewer, or something else;
obviously, if I have a role, I'll have an interest, but I don't know
what the details might be.

Yours, David...

--
Keeping medicines from the bloodstreams of the sick; food from the bellies
of the hungry; books from the hands of the uneducated; technology from the
underdeveloped; and putting advocates of freedom in prisons.  Intellectual
property is to the 21st century what the slave trade was to the 16th.



From paul at soniq.net  Sat Sep 27 20:58:00 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 04:58:00 +0200
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches to strport parsers
In-Reply-To: <20030927225804.GA1671@soniq.net>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us> <20030927225804.GA1671@soniq.net>
Message-ID: <20030928025800.GA9204@soniq.net>

On Sun, Sep 28, 2003 at 12:58:04AM +0200, Paul Boehm wrote:
> ugh.. using webinterfaces without a mouse is horror.. so i'll do it
> again and submit another patch here:

i've updated the patch (see end of mail)
all trial tests pass
sample code why i need the patch included

also, i want to ask the list if everyone is okay with me getting cvs access
to create and maintain twisted.proxy, a generic proxy, currently capable of
transparent proxying using netfilter, pseudotransparent proxying using a
shared lib (seperate c code required), and web.proxy, which i'll update or
rewrite soon.

and a rfc:
in the sample code below, i find the way i handle listening in a service
instead of the application, a lot more natural. 

if i stopService() at runtime, i expect the ports of that service to go down
at the same time. 

anything speaking against implementing the neccesary code in application.Service?
my expectation is that after the app refactor, noone will want to listen
directly in application anymore, so we could even start deprecating the old
interface.

sample code / usecase:
-----------------------------------
# twisted imports
from twisted.application import strports
from twisted.application.service import Service

# sibling imports
from proxy.interfaces import *
from proxy import adapters

flavors = {
         'any': IProxyFactory, # a proxy, any proxy!
         'transparent': ITransProxyFactory, # a transparent proxy
         'http': IHTTPProxyFactory, # a proxy speaking HTTP
        }

def parsePROXY(type, service, port, subproto="any", transport="tcp"):
    adapter = flavors[subproto]
    return(transport.upper(), (int(port), adapter(service)), {})

strports.registerTransport("proxy", parsePROXY)

class ProxyService(Service):
    """I am a service that starts proxies, and stores shared policy for them."""

    __implements__ = IProxyService

    def __init__(self, name, parent, *portspecs):
        self.portstrs = []
        self.listeners = []

        self.setName(name)
        self.setServiceParent(parent)

        for pspec in portspecs:
            self.listen(pspec)

    def listen(self, description):
        self.portstrs.append(description)

    def doListen(self, description):
        transport = strports.listen(description, self)
        self.listeners.append(transport)

    def startService(self):
        Service.startService(self)
        for description in self.portstrs:
            self.doListen(description)

    def stopService(self):
        Service.stopService(self)
        for port in self.listeners:
            port.loseConnection()
            self.listeners.remove(port)
-----------------------------------
patch:

Index: strports.py
===================================================================
RCS file: /cvs/Twisted/twisted/application/strports.py,v
retrieving revision 1.1
diff -u -r1.1 strports.py
--- strports.py 26 Sep 2003 22:44:48 -0000  1.1
+++ strports.py 28 Sep 2003 02:50:51 -0000
@@ -46,14 +46,22 @@
 """
 from __future__ import generators
 
-def _parseTCP(factory, port, interface="", backlog=5):
-    return (int(port), factory), {'interface': interface,
+_transportHelpers = {}
+
+def registerTransport(name, helper):
+    global _transportHelpers
+    _transportHelpers[name] = helper
+
+def _parseTCP(type, factory, port, interface="", backlog=5):
+    return type, (int(port), factory), {'interface': interface,
                                   'backlog': int(backlog)}
+registerTransport("tcp", _parseTCP)
 
-def _parseUNIX(factory, address, mode='666', backlog=5):
-    return (address, factory), {'mode': int(mode, 8), 'backlog': int(backlog)}
+def _parseUNIX(type, factory, address, mode='666', backlog=5):
+    return type, (address, factory), {'mode': int(mode, 8), 'backlog': int(backlog)}
+registerTransport("unix", _parseUNIX)
 
-def _parseSSL(factory, port, privateKey="server.pem", certKey=None,
+def _parseSSL(type, factory, port, privateKey="server.pem", certKey=None,
               sslmethod=None, interface='', backlog=5):
     from twisted.internet import ssl
     if certKey is None:
@@ -62,12 +70,9 @@
     if sslmethod is not None:
         kw['sslmethod'] = getattr(ssl.SSL, sslmethod)
     cf = ssl.DefaultOpenSSLContextFactory(privateKey, certKey, **kw)
-    return ((int(port), factory, cf),
+    return (type, (int(port), factory, cf),
             {'interface': interface, 'backlog': int(backlog)})
-
-_funcs = {"tcp": _parseTCP,
-          "unix": _parseUNIX,
-          "ssl": _parseSSL}
+registerTransport("ssl", _parseSSL)
 
 _OP, _STRING = range(2)
 def _tokenize(description):
@@ -104,7 +109,7 @@
     add(sofar)
     return args, kw 
 
-def parse(description, factory, default=None):
+def parse(description, factory, default='tcp'):
     """Parse a description of a reliable virtual circuit server
 
     @type description: C{str}
@@ -148,8 +153,10 @@
     """
     args, kw = _parse(description)
     if not args or (len(args)==1 and not kw):
-        args[0:0] = [default or 'tcp']
-    return (args[0].upper(),)+_funcs[args[0]](factory, *args[1:], **kw)
+        type = default
+    else:
+        type = args.pop(0)
+    return _transportHelpers[type](type.upper(), factory, *args, **kw)
 
 def service(description, factory, default=None):
     """Return the service corresponding to a description
@@ -185,4 +192,4 @@
     name, args, kw = parse(description, factory, default)
     return getattr(reactor, 'listen'+name)(*args, **kw)
 
-__all__ = ['parse', 'service', 'listen']
+__all__ = ['registerTransport', 'parse', 'service', 'listen']




From shawn at zetet.com  Sat Sep 27 21:10:22 2003
From: shawn at zetet.com (Shawn O'Connor)
Date: Sat, 27 Sep 2003 20:10:22 -0700
Subject: [Twisted-Python] from Scratch: Evolution of Finger (Moshe's Haifux talk)
Message-ID: <20030928031022.16895.qmail@mail.metastructure.net>

I've put a prospective howto version of Moshe's Haifux talk,
Twisted from Scratch: Evolution of Finger online at
http://zetet.com/twisted/finger 

Most of the code has been cleaned up, though I still
haven't tested SSL or the last few configuration examples. 

After any comments, suggestions, and another pass, I'll
submit the diffs for jml's version at
http://cvs.twistedmatrix.com/cvs/sandbox/jml/haifux-howto/
There is also an earlier version at
http://twistedmatrix.com/~moshez/haifux.html 


shawn  @
zetet  .  com 




From andrew-twisted at puzzling.org  Sat Sep 27 21:19:28 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 28 Sep 2003 13:19:28 +1000
Subject: [Twisted-Python] from Scratch: Evolution of Finger (Moshe's Haifux talk)
In-Reply-To: <20030928031022.16895.qmail@mail.metastructure.net>
References: <20030928031022.16895.qmail@mail.metastructure.net>
Message-ID: <20030928031928.GC21156@frobozz>

On Sat, Sep 27, 2003 at 08:10:22PM -0700, Shawn O'Connor wrote:
> 
> I've put a prospective howto version of Moshe's Haifux talk,
> Twisted from Scratch: Evolution of Finger online at
> http://zetet.com/twisted/finger 

Where can I find the the Lore source that generated that page?

-Andrew.




From paul at soniq.net  Sat Sep 27 21:24:26 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 05:24:26 +0200
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches to strport parsers
In-Reply-To: <20030928025800.GA9204@soniq.net>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us> <20030927225804.GA1671@soniq.net> <20030928025800.GA9204@soniq.net>
Message-ID: <20030928032426.GA10143@soniq.net>

On Sun, Sep 28, 2003 at 04:58:00AM +0200, Paul Boehm wrote:
> anything speaking against implementing the neccesary code in application.Service?
> my expectation is that after the app refactor, noone will want to listen
> directly in application anymore, so we could even start deprecating the old
> interface.

itamar already pointed out to me that service() does exactly what i
want. thanks!

  paul



From itamar at itamarst.org  Sat Sep 27 21:37:51 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 27 Sep 2003 23:37:51 -0400
Subject: [Twisted-Python] from Scratch: Evolution of Finger (Moshe's
 Haifux talk)
In-Reply-To: <20030928031022.16895.qmail@mail.metastructure.net>
References: <20030928031022.16895.qmail@mail.metastructure.net>
Message-ID: <20030927233751.36a3cc43.itamar@itamarst.org>

On Sat, 27 Sep 2003 20:10:22 -0700
"Shawn O'Connor" <shawn at zetet.com> wrote:

> After any comments, suggestions, and another pass, I'll
> submit the diffs for jml's version at
> http://cvs.twistedmatrix.com/cvs/sandbox/jml/haifux-howto/
> There is also an earlier version at
> http://twistedmatrix.com/~moshez/haifux.html 

Cool! It'd be great to have this for the next release.

One (major) issue - it covers old PB and application APIs. This is also
true of docs in CVS which we are in the process of updating :( Check out
the new pb examples in CVS and the plugins howto in CVS for examples of
the new API.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Sat Sep 27 21:41:10 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 27 Sep 2003 23:41:10 -0400
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches
 to strport parsers
In-Reply-To: <20030928025800.GA9204@soniq.net>
References: <20030927221700.GA1541@soniq.net>
	<20030927223723.GA17517@intarweb.us>
	<20030927225804.GA1671@soniq.net>
	<20030928025800.GA9204@soniq.net>
Message-ID: <20030927234110.7c04a220.itamar@itamarst.org>

On Sun, 28 Sep 2003 04:58:00 +0200
Paul Boehm <paul at soniq.net> wrote:

> also, i want to ask the list if everyone is okay with me getting cvs
> access to create and maintain twisted.proxy, a generic proxy,
> currently capable of transparent proxying using netfilter,
> pseudotransparent proxying using a shared lib (seperate c code
> required), and web.proxy, which i'll update or rewrite soon.

Personally I'd prefer not having this in Twisted itself. Not sure why
though :P

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From shawn at zetet.com  Sat Sep 27 23:30:05 2003
From: shawn at zetet.com (Shawn O'Connor)
Date: Sat, 27 Sep 2003 22:30:05 -0700
Subject: [Twisted-Python] Re: from Scratch: Evolution of Finger (Moshe's Haifux talk)
In-Reply-To: <20030928031928.GC21156@frobozz> 
References: <20030928031022.16895.qmail@mail.metastructure.net>
            <20030928031928.GC21156@frobozz>
Message-ID: <20030928053005.1081.qmail@mail.metastructure.net>

>> I've put a prospective howto version of Moshe's Haifux talk,
>> Twisted from Scratch: Evolution of Finger online at
>> http://zetet.com/twisted/finger 
> 
> Where can I find the the Lore source that generated that page?

http://zetet.com/twisted/finger/tour.html 

shawn  @
zetet  .  com 




From glyph at twistedmatrix.com  Sun Sep 28 00:30:01 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 28 Sep 2003 02:30:01 -0400
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches
 to strport parsers
In-Reply-To: <20030927234110.7c04a220.itamar@itamarst.org>
References: <20030927221700.GA1541@soniq.net>	<20030927223723.GA17517@intarweb.us>	<20030927225804.GA1671@soniq.net>	<20030928025800.GA9204@soniq.net> <20030927234110.7c04a220.itamar@itamarst.org>
Message-ID: <3F767FE9.7090802@twistedmatrix.com>

Itamar Shtull-Trauring wrote:
> On Sun, 28 Sep 2003 04:58:00 +0200
> Paul Boehm <paul at soniq.net> wrote:
> 
> 
>>also, i want to ask the list if everyone is okay with me getting cvs
>>access to create and maintain twisted.proxy, a generic proxy,
>>currently capable of transparent proxying using netfilter,
>>pseudotransparent proxying using a shared lib (seperate c code
>>required), and web.proxy, which i'll update or rewrite soon.
> 
> 
> Personally I'd prefer not having this in Twisted itself. Not sure why
> though :P
> 

"separate C code required"?

That seems reason enough to exclude it for me.  What about forwarding is 
computationally intense enough to *require* C code?  Especially separate 
C code?




From paul at soniq.net  Sun Sep 28 00:59:15 2003
From: paul at soniq.net (Paul Boehm)
Date: Sun, 28 Sep 2003 08:59:15 +0200
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches to strport parsers
In-Reply-To: <3F767FE9.7090802@twistedmatrix.com>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us> <20030927225804.GA1671@soniq.net> <20030928025800.GA9204@soniq.net> <20030927234110.7c04a220.itamar@itamarst.org> <3F767FE9.7090802@twistedmatrix.com>
Message-ID: <20030928065915.GA13876@soniq.net>

On Sun, Sep 28, 2003 at 02:30:01AM -0400, Glyph Lefkowitz wrote:
> >Personally I'd prefer not having this in Twisted itself. Not sure why
> >though :P
> >
> 
> "separate C code required"?
> 
> That seems reason enough to exclude it for me.  What about forwarding is 
> computationally intense enough to *require* C code?  Especially separate 
> C code?

huh? you really didn't bother to read what i wrote in irc.

there's not a single line of c code in proxy, no mention of c code,
and no requirement for c code.

yes, i've written a shared library interface to one protocol..
and i'm not even going to publish that..

annoyed,
  paul



From glyph at twistedmatrix.com  Sun Sep 28 01:22:30 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 28 Sep 2003 03:22:30 -0400
Subject: [Twisted-Python] twisted.proxy, cvs access and further patches
 to strport parsers
In-Reply-To: <20030928065915.GA13876@soniq.net>
References: <20030927221700.GA1541@soniq.net> <20030927223723.GA17517@intarweb.us> <20030927225804.GA1671@soniq.net> <20030928025800.GA9204@soniq.net> <20030927234110.7c04a220.itamar@itamarst.org> <3F767FE9.7090802@twistedmatrix.com> <20030928065915.GA13876@soniq.net>
Message-ID: <3F768C36.7040803@twistedmatrix.com>

Paul Boehm wrote:

> huh? you really didn't bother to read what i wrote in irc.

Nope.  If you want responses on the mailing list, write to the mailing 
list :)

> there's not a single line of c code in proxy, no mention of c code,
> and no requirement for c code.

Ahem -

> ... twisted.proxy [is] a generic proxy, currently capable of
> ... pseudotransparent proxying using a shared lib (seperate c code
 > required) ...

That seems to be a mention of both c code and a requirement for c code. 
  I haven't seen anything either on IRC or here to indicate how this 
seperate, required C code is neither required nor C :)

> yes, i've written a shared library interface to one protocol..
> and i'm not even going to publish that..

I understand that this comment may not apply in this situation, but I'd 
like to be clear: the reason I responded as I did is that I don't like 
the idea of adding plugin interfaces to Twisted specifically to 
introduce a dependency on so that unpublished, proprietary, or even 
separate modules are required.  Sometimes that's unavoidable (support 
for proprietary platforms requires proprietary code) but unless there is 
an overriding concern it's undesireable.




From martin at tactilis.co.uk  Sun Sep 28 02:46:01 2003
From: martin at tactilis.co.uk (Martin Armstrong)
Date: Sun, 28 Sep 2003 09:46:01 +0100
Subject: [Twisted-Python] from Scratch: Evolution of Finger (Moshe's Haifux talk)
In-Reply-To: <20030928031022.16895.qmail@mail.metastructure.net>
References: <20030928031022.16895.qmail@mail.metastructure.net>
Message-ID: <U1CRSzbJ$pd$Ewdm@tactilis.demon.co.uk>

In article <20030928031022.16895.qmail at mail.metastructure.net>, Shawn 
O'Connor <shawn at zetet.com> writes

>I've put a prospective howto version of Moshe's Haifux talk,
>Twisted from Scratch: Evolution of Finger online at
>http://zetet.com/twisted/finger

>After any comments, suggestions

Perhaps you could remove the word 'not' from this section:

     "Refuse Connections

     ... It will not consume (almost) no CPU resources."

-- 
Martin Armstrong                        martin @ tactilis.co.uk



From ccom at gmx.net  Sun Sep 28 03:09:05 2003
From: ccom at gmx.net (ccom at gmx.net)
Date: Sun, 28 Sep 2003 11:09:05 +0200 (MEST)
Subject: [Twisted-Python] serving dynamic on root and still serve static somehow
Message-ID: <22678.1064740145@www48.gmx.net>

The general question propably is: How can I  serve my main web app on root
but still be able to serve flat files such as images and style sheets.

Say I want to run a webserver that provides a dynamic page on
"http://domain.com/" and a static file tree on "http://domain.com/static/". With the code I
have currently it always processes the dynamic page and never reaches the
"static" child:


class Dynamic(resource.Resource):
    isLeaf = True    
    return "mock dynamic page"
 
root = Container()
root.putChild('static', static.File('.'))
site = server.Site(root) 

reactor.listenTCP(8080, site)
reactor.run()


Help very much appreciated,

_stephan

-- 
NEU FR ALLE - GMX MediaCenter - fr Fotos, Musik, Dateien...
Fotoalbum, File Sharing, MMS, Multimedia-Gru, GMX FotoService

Jetzt kostenlos anmelden unter http://www.gmx.net

+++ GMX - die erste Adresse fr Mail, Message, More! +++




From screwtape at froup.com  Sun Sep 28 05:24:22 2003
From: screwtape at froup.com (screwtape at froup.com)
Date: Sun, 28 Sep 2003 21:24:22 +1000
Subject: [Twisted-Python] serving dynamic on root and still serve static somehow
In-Reply-To: <22678.1064740145@www48.gmx.net>
References: <22678.1064740145@www48.gmx.net>
Message-ID: <20030928112422.GA17713@ferd2.thristian.org>

On Sun, Sep 28, 2003 at 11:09:05AM +0200, ccom at gmx.net wrote:
> 
> The general question propably is: How can I  serve my main web app on root
> but still be able to serve flat files such as images and style sheets.

<snip>

>     isLeaf = True    

That's the line that's causing your grief.

If you set isLeaf on any resource, twisted.web won't look at its
children.

-- 
 ___________ ___________________________________
| Screwtape | http://livejournal.com/~thristian |______ _____ ___ __ _  _   _
|
| "Strange, Enya-like New Age music poured from a cactus." -- Jon Katz
|



From jml at mumak.net  Sun Sep 28 06:20:52 2003
From: jml at mumak.net (Jonathan Lange)
Date: Sun, 28 Sep 2003 22:20:52 +1000
Subject: [Twisted-Python] Re: from Scratch: Evolution of Finger (Moshe's Haifux talk)
In-Reply-To: <20030928053005.1081.qmail@mail.metastructure.net>; from shawn@zetet.com on Sun, Sep 28, 2003 at 15:30:05 +1000
References: <20030928031022.16895.qmail@mail.metastructure.net> <20030928031928.GC21156@frobozz> <20030928053005.1081.qmail@mail.metastructure.net>
Message-ID: <20030928122052.GA749@sting>

On 09/28/03 15:30:05, Shawn O'Connor wrote:
>>> I've put a prospective howto version of Moshe's Haifux talk,
>>> Twisted from Scratch: Evolution of Finger online at
>>> http://zetet.com/twisted/finger
>> 
>> Where can I find the the Lore source that generated that page?
> 
> http://zetet.com/twisted/finger/tour.html

Suggestion. Moshe's workshop and the derived howto are both huge. It  
might be worth splitting the single lore file into a multi-part howto.

cheers,
jml

PS. Thanks for doing this, btw. I have been too busy w/ uni to  
contribute to Twisted :(
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030928/2bd680df/attachment.sig>

From itamar at itamarst.org  Sun Sep 28 17:50:21 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 28 Sep 2003 19:50:21 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] InMemoryUsernamePasswordDatabaseDontUse
 didn't raise the error properly when the password was wrong
In-Reply-To: <E1A3lDb-0007B4-00@wolfwood>
References: <E1A3lDb-0007B4-00@wolfwood>
Message-ID: <20030928195021.64302e8e.itamar@itamarst.org>

On Sun, 28 Sep 2003 17:44:47 -0600
teratorn CVS <teratorn at wolfwood.twistedmatrix.com> wrote:

> -            return failure.Failure(error.UnauthorizedLogin())
> +            raise error.UnauthorizedLogin()
>  

Uh. Why does one work and not the other? That looks like a bug in
Deferred to me. Aren't returned Failures supposed to be the same as
raised exceptions in callbacks?

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From glyph at twistedmatrix.com  Sun Sep 28 18:04:45 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Sun, 28 Sep 2003 20:04:45 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] InMemoryUsernamePasswordDatabaseDontUse
 didn't raise the error properly when the password was wrong
In-Reply-To: <20030928195021.64302e8e.itamar@itamarst.org>
References: <E1A3lDb-0007B4-00@wolfwood> <20030928195021.64302e8e.itamar@itamarst.org>
Message-ID: <3F77771D.6040702@twistedmatrix.com>

Itamar Shtull-Trauring wrote:
> On Sun, 28 Sep 2003 17:44:47 -0600
> teratorn CVS <teratorn at wolfwood.twistedmatrix.com> wrote:
> 
> 
>>-            return failure.Failure(error.UnauthorizedLogin())
>>+            raise error.UnauthorizedLogin()
>> 
> 
> 
> Uh. Why does one work and not the other? That looks like a bug in
> Deferred to me. Aren't returned Failures supposed to be the same as
> raised exceptions in callbacks?
> 

Considering that the two are equivalent, the former style is preferred 
in situations like this, since it does not create Python traceback info 
(which is _noticeably_ slower than not doing it).




From exarkun at intarweb.us  Sun Sep 28 18:31:16 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 28 Sep 2003 20:31:16 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] InMemoryUsernamePasswordDatabaseDontUse didn't raise the error properly when the password was wrong
In-Reply-To: <3F77771D.6040702@twistedmatrix.com>
References: <E1A3lDb-0007B4-00@wolfwood> <20030928195021.64302e8e.itamar@itamarst.org> <3F77771D.6040702@twistedmatrix.com>
Message-ID: <20030929003116.GA28533@intarweb.us>

On Sun, Sep 28, 2003 at 08:04:45PM -0400, Glyph Lefkowitz wrote:
> Itamar Shtull-Trauring wrote:
> >On Sun, 28 Sep 2003 17:44:47 -0600
> >teratorn CVS <teratorn at wolfwood.twistedmatrix.com> wrote:
> >
> >
> >>-            return failure.Failure(error.UnauthorizedLogin())
> >>+            raise error.UnauthorizedLogin()
> >>
> >
> >
> >Uh. Why does one work and not the other? That looks like a bug in
> >Deferred to me. Aren't returned Failures supposed to be the same as
> >raised exceptions in callbacks?
> >
> 
> Considering that the two are equivalent, the former style is preferred 
> in situations like this, since it does not create Python traceback info 
> (which is _noticeably_ slower than not doing it).
> 

  ... and then gets send to the PB client, producing a full traceback on the
client side, instead of just a one-line exception string.

  In this case, that means the client is able to discern between invalid
usernames and invalid passwords, which would be a serious problem, if we
were talking about anything other than InMemoryUsernamePassword-
DatabaseDontUse.  As it is, I think InMemoryUsernamePasswordDatabaseDontUse
should intentionally reveal even more information about why the login failed
(making it more useful for debugging and less useful for production), and
the difference between returning a Failure constructed from an exception and
raising an exception in a callback be spelled out explicitly somewhere.  Who
knows when the difference will be forgotten and something unintentionally
revealed, as it was in InMemoryUsernamePasswordDatabaseDontUse?

  Jp

-- 
#!/bin/bash
( LIST=(~/.sigs/*.sig)
  cat ${LIST[$(($RANDOM % ${#LIST[*]}))]}
  echo -- $'\n' `uptime | sed -e 's/.*m//'` ) > ~/.signature
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030928/c19d56b7/attachment.sig>

From itamar at itamarst.org  Sun Sep 28 18:46:23 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 28 Sep 2003 20:46:23 -0400
Subject: [Twisted-Python] Re: [Twisted-commits]
 InMemoryUsernamePasswordDatabaseDontUse didn't raise the error properly
 when the password was wrong
In-Reply-To: <20030929003116.GA28533@intarweb.us>
References: <E1A3lDb-0007B4-00@wolfwood>
	<20030928195021.64302e8e.itamar@itamarst.org>
	<3F77771D.6040702@twistedmatrix.com>
	<20030929003116.GA28533@intarweb.us>
Message-ID: <20030928204623.0f7b71b2.itamar@itamarst.org>

On Sun, 28 Sep 2003 20:31:16 -0400
Jp Calderone <exarkun at intarweb.us> wrote:

>   In this case, that means the client is able to discern between
>   invalid
> usernames and invalid passwords, which would be a serious problem, if
> we were talking about anything other than InMemoryUsernamePassword-
> DatabaseDontUse.  As it is, I think
> InMemoryUsernamePasswordDatabaseDontUse should intentionally reveal
> even more information about why the login failed(making it more useful
> for debugging and less useful for production), and the difference
> between returning a Failure constructed from an exception and raising
> an exception in a callback be spelled out explicitly somewhere.  Who
> knows when the difference will be forgotten and something
> unintentionally revealed, as it was in
> InMemoryUsernamePasswordDatabaseDontUse?

I don't think PB failures should sent *ANY* traceback info. In fact, I
can't figure out how to prevent that from happening even on a case by
case basis.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From greg at digitalinfo.net  Sun Sep 28 19:30:33 2003
From: greg at digitalinfo.net (Greg)
Date: Sun, 28 Sep 2003 21:30:33 -0400
Subject: [Twisted-Python] using ClientFactory from within a server
Message-ID: <200309282130.33961.greg@digitalinfo.net>

I am having trouble using ClientFactory to communicate from within a server. 
Specifically, I can't figure out the proper way to exit from the client 
process. 

Included is some example code illustrating the problem I am having. It is the 
simple echo server example, but when someone sends some text to the server, I 
am trying to talk to an SMTP server to send an email. This is just an example 
(there are probably better ways to fire off an email), but you get the idea. 
The client code never "exits" and if I try to use reactor.stop() it causes a 
traceback. 

So how do I properly exit from this client code, or (being new to twisted) am 
I going about this in the entirely wrong way? Thanks.


#!/usr/bin/env python

from twisted.internet import reactor
from twisted.internet.protocol import Protocol, ClientFactory, ServerFactory
import sys

class Echo(Protocol):
	"""This is just about the simplest possible protocol"""
	
	def dataReceived(self, data):
		"As soon as any data is received, write it back."
		self.transport.write(data)
		factory2 = MySMTPClientFactory()
		host = 'localhost'
		port = 25
		reactor.connectTCP(host, port, factory2)
		reactor.run()

		print "Returned from sending email"
		# ^ Never gets to this point
		
class MySMTP(Protocol):
	def dataReceived(self, data):
			sys.stdout.write('Server said: ' + data)
			if data[:3] == "220":
				self.transport.write("helo foo.com\n")
				self.stage = 1
			if data[:3] == "250":
				if self.stage == 1:
					self.transport.write("MAIL FROM:<greg at foo.com>\n")
					self.stage = 2
				elif self.stage == 2:
					self.transport.write("RCPT TO:<greg at foo.com>\n")
					self.stage = 3
				elif self.stage == 3:
					self.transport.write("DATA\n")
					self.stage = 4
				elif self.stage == 4:
					self.transport.write("QUIT\n")
					self.transport.loseConnection()
					#reactor.stop()
					# ^ This causes a traceback
					
			if data[:3] == "354":
				# Ready to send actual email
				self.transport.write("This is a test email\n.\n")
				

class MySMTPClientFactory(ClientFactory):
	def startedConnection(self, connector):
		print 'Started to connect.'
	
	def buildProtocol(self, addr):
		print 'Connected.'
		return MySMTP()
	
	def clientConnectionLost(self, connector, reason):
		print 'Lost connection.  Reason:', reason
		#reactor.stop()
		# ^ Causes a traceback here too
		
	def clientConnectionFailed(self, connector, reason):
		print 'Connection failed. Reason:', reason

def main():
	"""This runs the protocol on port 8000"""
	factory = ServerFactory()
	factory.protocol = Echo
	reactor.listenTCP(8000,factory)
	reactor.run()

# this only runs if the module was *not* imported
if __name__ == '__main__':
	main()




From exarkun at intarweb.us  Sun Sep 28 21:23:08 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 28 Sep 2003 23:23:08 -0400
Subject: [Twisted-Python] using ClientFactory from within a server
In-Reply-To: <200309282130.33961.greg@digitalinfo.net>
References: <200309282130.33961.greg@digitalinfo.net>
Message-ID: <20030929032307.GB28533@intarweb.us>

On Sun, Sep 28, 2003 at 09:30:33PM -0400, Greg wrote:
> I am having trouble using ClientFactory to communicate from within a server. 
> Specifically, I can't figure out the proper way to exit from the client 
> process. 
> 
> Included is some example code illustrating the problem I am having. It is the 
> simple echo server example, but when someone sends some text to the server, I 
> am trying to talk to an SMTP server to send an email. This is just an example 
> (there are probably better ways to fire off an email), but you get the idea. 
> The client code never "exits" and if I try to use reactor.stop() it causes a 
> traceback. 

  reactor.run() enters the twisted mainloop.  reactor.stop() causes the
mainloop to terminate in the near future.  You cannot nest calls to the
mainloop (nor do you need to do so).

> 
> So how do I properly exit from this client code, or (being new to twisted) am 
> I going about this in the entirely wrong way? Thanks.
> 
> 
> #!/usr/bin/env python
> 
> from twisted.internet import reactor
> from twisted.internet.protocol import Protocol, ClientFactory, ServerFactory
> import sys
> 
> class Echo(Protocol):
> 	"""This is just about the simplest possible protocol"""
> 	
> 	def dataReceived(self, data):
> 		"As soon as any data is received, write it back."
> 		self.transport.write(data)
> 		factory2 = MySMTPClientFactory()
> 		host = 'localhost'
> 		port = 25
> 		reactor.connectTCP(host, port, factory2)
> 		reactor.run()

  Remove the above call to "reactor.run() and see what happens.

> 
> 		print "Returned from sending email"
> 		# ^ Never gets to this point
> 		
> class MySMTP(Protocol):
> [snip]
> 				

  I don't understand why you aren't using twisted.protocols.smtp.

> [snip]

  Jp

-- 
http://catandgirl.com/view.cgi?44
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030928/0421287f/attachment.sig>

From pradu at pradu.it  Mon Sep 29 04:03:30 2003
From: pradu at pradu.it (Alessandro Praduroux)
Date: Mon, 29 Sep 2003 12:03:30 +0200
Subject: [Twisted-Python] cut and paste is evil :)
Message-ID: <200309291203.30548.pradu@pradu.it>

in version 1.37 of formmethod.py has been added a constructor to the String 
class, to add a min/max lenght check for the string. That's a cool idea, but 
the implementation destroyed the behaviour of all derived classes :).

def __init__(self, name, default=None, shortDesc=None,
                  longDesc=None, hints=None, allowNone=1, min=0, max=None):
         Argument.__init__(self, name, default=None, shortDesc=None,
                           longDesc=None, hints=None, allowNone=1)
         self.min = min
         self.max = max

you can see that in calling the Argument.__init__ constructor, all values are 
reset to None.

issued to the bugtracker, with simple patch.
http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue296


-- 
Linux webmaster & sysadmin
pradu at pradu.it




From greg at digitalinfo.net  Mon Sep 29 06:07:57 2003
From: greg at digitalinfo.net (Greg)
Date: Mon, 29 Sep 2003 08:07:57 -0400
Subject: [Twisted-Python] using ClientFactory from within a server
In-Reply-To: <20030929032307.GB28533@intarweb.us>
References: <200309282130.33961.greg@digitalinfo.net> <20030929032307.GB28533@intarweb.us>
Message-ID: <3F78209D.50105@digitalinfo.net>

>>		reactor.connectTCP(host, port, factory2)
>>		reactor.run()
>>    
>>
>
>  Remove the above call to "reactor.run() and see what happens.
>
>  
>
>>		print "Returned from sending email"
>>		# ^ Never gets to this point
>>    
>>
Thanks. Now I am getting closer. But a strange (to me) thing happens. 
When I connect to the Echo server and send it a string, it does 
correctly run the MySMTP code. But it does not return and execute the 
'print "Returned from sending email"' statement until I connect to the 
Echo server again and send another string. Any idea why this is 
happening? Is there a way to disconnect factory2 from the reactor after 
I have sent the "QUIT" string (or when 
MySMTPClientFactory.clientConnectionLost() gets called)?

>>		
>>class MySMTP(Protocol):
>>[snip]
>>				
>>    
>>
>
>  I don't understand why you aren't using twisted.protocols.smtp.
>  
>
The use of SMTP is just an example. In reality I'm talking a different 
protocol, but I wanted to use a common protocol like SMTP in my example 
so that someone on the list could easily test my code.




From ac at strakt.com  Mon Sep 29 06:28:45 2003
From: ac at strakt.com (Anders =?ISO-8859-1?Q?Chrigstr=F6m?=)
Date: 29 Sep 2003 14:28:45 +0200
Subject: [Twisted-Python] Some threadpool patches
Message-ID: <1064838525.12001.21.camel@ashera.strakt.com>

Hi,

Here are two patches regarding the threadpool.

The first is to python/threadpool.py and firstly fixes the problem with
the threadpool not being safe to it's own threads and secondly to ensure
that enough threads get started. I'm not convinced that the way the
threads are started is the best way, but it gets the job done.

The second patch removes knowledge of the threadpool internals from
internet/base.py

/Anders

-- 
Anders Chrigstrm <ac at strakt.com>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: threadpool.patch
Type: text/x-patch
Size: 5706 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030929/3c718da4/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: base.patch
Type: text/x-patch
Size: 855 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030929/3c718da4/attachment-0005.bin>

From itamar at itamarst.org  Mon Sep 29 07:59:55 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 29 Sep 2003 09:59:55 -0400
Subject: [Twisted-Python] Some threadpool patches
In-Reply-To: <1064838525.12001.21.camel@ashera.strakt.com>
References: <1064838525.12001.21.camel@ashera.strakt.com>
Message-ID: <20030929095955.6341b50a.itamar@itamarst.org>

On 29 Sep 2003 14:28:45 +0200
Anders Chrigstrm <ac at strakt.com> wrote:

> Here are two patches regarding the threadpool.

Thanks! Could you add those to twistedmatrix.com/bugs/? Feel free to
assign them to me.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From ac at strakt.com  Mon Sep 29 08:28:39 2003
From: ac at strakt.com (Anders =?ISO-8859-1?Q?Chrigstr=F6m?=)
Date: 29 Sep 2003 16:28:39 +0200
Subject: [Twisted-Python] Some threadpool patches
In-Reply-To: <20030929095955.6341b50a.itamar@itamarst.org>
References: <1064838525.12001.21.camel@ashera.strakt.com>
	 <20030929095955.6341b50a.itamar@itamarst.org>
Message-ID: <1064845719.12000.32.camel@ashera.strakt.com>

On Mon, 2003-09-29 at 15:59, Itamar Shtull-Trauring wrote:
> On 29 Sep 2003 14:28:45 +0200
> Anders Chrigstrm <ac at strakt.com> wrote:
> 
> > Here are two patches regarding the threadpool.
> 
> Thanks! Could you add those to twistedmatrix.com/bugs/? Feel free to
> assign them to me.

Done!
You will find them as Issue297 and Issue298.

Best regards,
/Anders

-- 
Anders Chrigstrm <ac at strakt.com>




From ccom at gmx.net  Mon Sep 29 11:24:15 2003
From: ccom at gmx.net (ccom at gmx.net)
Date: Mon, 29 Sep 2003 19:24:15 +0200 (MEST)
Subject: [Twisted-Python] Re: serving dynamic on root and still serve static somehow
Message-ID: <31814.1064856255@www53.gmx.net>

Yeah, I noticed that when I set isLeaf = False in my root node my child
nodes will get processed. At the same time my root will then serve a 404-No Such
Resource, though.  Serving static files on root and dynamic ones as child
nodes was easy but how do I do it the other way round--dynamic on root and
static files on a child node?


>> The general question propably is: How can I  serve my main web app on
>> root but still be able to serve flat files such as images and style
sheets.
 
><snip>
 
>>     isLeaf = True    
 
>That's the line that's causing your grief.
 
>If you set isLeaf on any resource, twisted.web won't look at its
>children.


_stephan

-- 
NEU FR ALLE - GMX MediaCenter - fr Fotos, Musik, Dateien...
Fotoalbum, File Sharing, MMS, Multimedia-Gru, GMX FotoService

Jetzt kostenlos anmelden unter http://www.gmx.net

+++ GMX - die erste Adresse fr Mail, Message, More! +++




From radix at twistedmatrix.com  Mon Sep 29 12:46:14 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 29 Sep 2003 14:46:14 -0400
Subject: [Twisted-Python] Re: serving dynamic on root and still serve static somehow
In-Reply-To: <31814.1064856255@www53.gmx.net>
References: <31814.1064856255@www53.gmx.net>
Message-ID: <20030929184614.GA1515@radii>

On Mon, Sep 29, 2003 at 07:24:15PM +0200, ccom at gmx.net wrote:
> 
> Yeah, I noticed that when I set isLeaf = False in my root node my
> child nodes will get processed. At the same time my root will then
> serve a 404-No Such Resource, though.

With isLeaf=False, the root resource will _never_ have its render()
method called. That is because the request for the root resource is
always '/', not ''. (i.e., "GET / HTTP/1.1", not "GET  HTTP/1.1")

'/'.split('/') == [''], which means that getChild('', request) will be
called. Therefore, your root resource must respond to 
getChild('', request).


-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From warner at lothar.com  Mon Sep 29 13:10:52 2003
From: warner at lothar.com (Brian Warner)
Date: Mon, 29 Sep 2003 12:10:52 -0700 (PDT)
Subject: [Twisted-Python] qtreactor needs help
Message-ID: <20030929.121052.59474489.warner@lothar.com>

The qtreactor test has been failing for several weeks: something in the
Application testcase either hangs or goes into an infinite loop. This was
slowing down the buildbot quite a bit (it waits 20 minutes before killing off
a stuck child process, but there are cases where sub-children are not killed,
and for this case the 100% CPU usage persisted after the test suite was
terminated, slowing everything else on the system down).

I've removed the qtreactor test case from the 'reactors' build until we can
resolve the problem.

Would someone who knows QT try './bin/trial -v -r qtreactor twisted.test' and
see where it hangs? And fix the problem? :)

Let me know when it's behaving again and I'll add it back to the buildbot.

thanks,
 -Brian



From exarkun at intarweb.us  Mon Sep 29 13:12:17 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Mon, 29 Sep 2003 15:12:17 -0400
Subject: [Twisted-Python] Test coverage of Twisted
Message-ID: <20030929191217.GA6617@intarweb.us>

  Tv pointed out a code coverage tool this morning.  I thought I'd share
some results it generated.

  For twisted.internet:

Name                Stmts   Exec  Cover
---------------------------------------
gladereactor          118      0     0%
gtk2reactor           139      0     0%
gtkreactor            125      0     0%
javareactor           268      0     0%
kqreactor              90      0     0%
pollreactor           107      0     0%
pyuisupport            16      0     0%
qtreactor             131      0     0%
task                    8      0     0%
tksupport              29      0     0%
win32eventreactor     266      0     0%
wxsupport              22      0     0%
stdio                  58     18    31%
utils                 144     55    38%
app                   559    275    49%
main                   86     50    58%
threads                27     16    59%
interfaces            328    200    60%
process               415    271    65%
unix                  184    134    72%
default               336    244    72%
reactor                 9      7    77%
base                  384    304    79%
fdesc                  26     22    84%
tcp                   451    387    85%
udp                   208    178    85%
abstract              131    115    87%
protocol              275    242    88%
ssl                    89     79    88%
defer                 212    192    90%
error                 154    144    93%
---------------------------------------
TOTAL                5396   2934    54%


  For twisted.protocols:

Name          Stmts   Exec  Cover
---------------------------------
socks           116      0     0%
finger           30      0     0%
portforward      41      0     0%
shoutcast        76      0     0%
oscar           836    167    19%
dict            285     97    34%
telnet          155     66    42%
msn             994    454    45%
nntp            638    302    47%
irc            1080    528    48%
toc            1043    547    52%
htb             115     74    64%
pop3            446    294    65%
smtp            918    626    68%
policies        275    190    69%
xmlstream        91     66    72%
raw              15     11    73%
ftp             712    552    77%
imap4          2742   2132    77%
postfix          76     59    77%
sux             402    312    77%
sip             674    541    80%
wire             50     41    82%
basic           236    197    83%
http            649    554    85%
dns             688    602    87%
ethernet         31     29    93%
pcp             121    117    96%
loopback         94     92    97%
ip               34     34   100%
rawudp           25     25   100%
---------------------------------
TOTAL         13689   8710    63%


  For twisted.python:

Name            Stmts   Exec  Cover
-----------------------------------
dispatch           15      0     0%
domhelpers          4      0     0%
dxprofile          29      0     0%
mutablestring       3      0     0%
mvc                10      0     0%
plugin            174      0     0%
register           28      0     0%
shortcut           29      0     0%
syslog             27      0     0%
win32              15      0     0%
dir                26      2     7%
otp               152     34    22%
htmlizer           50     12    24%
compat             62     17    27%
runtime            36     15    41%
finalize           30     16    53%
text              137     73    53%
observable        249    151    60%
threadable        188    114    60%
reflect           371    224    60%
threadpool        120     78    65%
util              354    249    70%
urlpath            77     56    72%
roots             107     78    72%
rebuild           194    148    76%
zipstream         176    139    78%
log               239    192    80%
logfile           162    134    82%
filepath          161    135    83%
failure           191    167    87%
usage             289    254    87%
formmethod        217    198    91%
components        213    196    92%
hook               70     65    92%
context            43     42    97%
timeoutqueue       24     24   100%
-----------------------------------
TOTAL            4273   2814    65%


  More detailed information is available -- if anyone wants to take on
improving the test coverage, send me a note and I'll send you the relevant
files.  Also, the data file used to generate the output is attached to this
message (decompress before using), and the tool for manipulating it in
useful ways is at

    http://www.garethrees.org/2001/12/04/python-coverage/coverage.py

  so you can also generate the results independently.

  Jp

-- 
http://catandgirl.com/view.cgi?44
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030929/6fc235e4/attachment.sig>

From exarkun at intarweb.us  Mon Sep 29 13:58:23 2003
From: exarkun at intarweb.us (Jp Calderone)
Date: Mon, 29 Sep 2003 15:58:23 -0400
Subject: [Twisted-Python] Test coverage of Twisted
In-Reply-To: <20030929191217.GA6617@intarweb.us>
References: <20030929191217.GA6617@intarweb.us>
Message-ID: <20030929195823.GA7289@intarweb.us>

  Okay.  It's actually attached to this message.

  Jp

-- 
"The problem is, of course, that not only is economics bankrupt but it has
 always been nothing more than politics in disguise ... economics is a form
 of brain damage."  -- Hazel Henderson
-------------- next part --------------
A non-text attachment was scrubbed...
Name: coverage.bz2
Type: application/octet-stream
Size: 38337 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030929/18f4caa7/attachment-0002.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20030929/18f4caa7/attachment.sig>

From paul at soniq.net  Tue Sep 30 05:28:21 2003
From: paul at soniq.net (Paul Boehm)
Date: Tue, 30 Sep 2003 13:28:21 +0200
Subject: [Twisted-Python] [twisted.roundup@twistedmatrix.com: [issue291] app.getApplication cleanup]
Message-ID: <20030930112821.GA11791@soniq.net>

okay, and now someone explain to me what should motivate me to keep
sending in patches? strports patches will be rejected too, moshez told
me, so i'll have to fork that too.. 

and i had fixes for that loseConnection stuff months ago, i don't
remember if i submitted them, because even back then i knew from
experience that you won apply my patches, but i probably did.

you realize that you are unwilling to apply any of my patches, even when
minor, and when i'm trying really hard to get them in?

it would be really easier to maintain a patch dir, and just fix my own
cvs checkout locally.

i'll submit my proxy patches, integrating well into cvs-current, this
week, as arranged on irc, and you judge if my code is unbearable or if
it actually makes sense. i see this as an last attempt to communicate
with you guys..

bitter,
  paul

----- Forwarded message from Moshe Zadka <twisted.roundup at twistedmatrix.com> -----

Subject: [issue291] app.getApplication cleanup
To: paul at soniq.net
From: Moshe Zadka <twisted.roundup at twistedmatrix.com>
Reply-To: Twisted issue tracker <twisted.roundup at twistedmatrix.com>
Date: Tue, 30 Sep 2003 05:40:22 +0000


Moshe Zadka <moshez at twistedmatrix.com> added the comment:

I'm going to reject it -- this code works, and is clear 
enough. Do you have any good reason, other than clean-up, 
for this patch?


----------
status: unread -> chatting
__________________________________________________________________
Twisted issue tracker <twisted.roundup at twistedmatrix.com>
http://www.twistedmatrix.com/users/roundup.twistd/twisted/issue291
__________________________________________________________________

----- End forwarded message -----




From andrew-twisted at puzzling.org  Tue Sep 30 08:21:35 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 1 Oct 2003 00:21:35 +1000
Subject: [Twisted-Python] [twisted.roundup@twistedmatrix.com: [issue291] app.getApplication cleanup]
In-Reply-To: <20030930112821.GA11791@soniq.net>
References: <20030930112821.GA11791@soniq.net>
Message-ID: <20030930142135.GG21156@frobozz>

On Tue, Sep 30, 2003 at 01:28:21PM +0200, Paul Boehm wrote:
> okay, and now someone explain to me what should motivate me to keep
> sending in patches? strports patches will be rejected too, moshez told
> me, so i'll have to fork that too.. 

Moshe is the maintainer of that particular section of code; it would take a
lot to convince other developers to override his judgement on those issues.
Certainly, a cosmetic patch such as this particular one (which merely
rearranged code, even if it does seems clearer) isn't something to get
particularly bothered about either way.

Also, here's what moshez said regarding strports patches (according to my
IRC log):
    <moshez> patches to make "strports more general" will be rejected until
    I see a use case. we tried to come up with a use case and didn't have
    success

Your paraphrase above ("strports patches will be rejected too, moshez told
me") implied something quite different to what he actually said (please
correct me if he said otherwise and I didn't see it!).  He requires use
cases to justify adding more features -- presumably if you want to add a
feature, you will have a reason, so I don't see this as being particularly
onerous :)

> and i had fixes for that loseConnection stuff months ago, i don't
> remember if i submitted them, because even back then i knew from
> experience that you won apply my patches, but i probably did.

I've searched the issue tracker and the mailing list, and can't find what
you're referring to.  Please post it to the issue tracker, so that we can
ignore it properly ;)

Seriously, it looks like you haven't sent that patch to us, so please do.

> you realize that you are unwilling to apply any of my patches, even when
> minor, and when i'm trying really hard to get them in?

I know some people feel that cosmetic patches that merely change code to
look prettier are more risk than they're worth; e.g. when True and False was
added to Python, Guido discouraged people from going through and making the
obvious cosmetic changes in the standard library because of the risk of
introducing bugs.  If a maintainer feels that the cost of applying and
encouraging cosmetic patches outweighs the small (and ultimately subjective)
benefit they give, then they will reject them.

I'm not sure of Moshe's specific reasons for this rejection, beyond what he
wrote in the issue tracker:
    "I'm going to reject it -- this code works, and is clear enough."
But judging from that, his point of view is similar to what I just
described.  He didn't see that patch as offering a substantial enough
improvement over the existing code to be worthwhile.  

Extrapolating from this one minor patch to "you are unwilling to apply any
of my patches" seems a little premature.  Are there others from you that
have been rejected that I don't know about?

> i'll submit my proxy patches, integrating well into cvs-current, this
> week, as arranged on irc, and you judge if my code is unbearable or if
> it actually makes sense. i see this as an last attempt to communicate
> with you guys..

I'm listening, and I believe the other developers are too.  Some of us are
unnecessarily abrasive at times (yes Moshe I mean you), and I regret that.
I look forward to seeing your proxy patches and discussing them with you.

Thanks for your efforts so far (even though they have gone unrewarded)!

Regards,

-Andrew.




From itamar at itamarst.org  Tue Sep 30 10:13:12 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 30 Sep 2003 12:13:12 -0400
Subject: [Twisted-Python] Re: [Twisted-commits] Port to strports
In-Reply-To: <E1A4GKl-0007tB-00@wolfwood>
References: <E1A4GKl-0007tB-00@wolfwood>
Message-ID: <20030930121312.725af4dd.itamar@itamarst.org>

On Tue, 30 Sep 2003 02:58:15 -0600
moshez CVS <moshez at wolfwood.twistedmatrix.com> wrote:

> Modified files:
> Twisted/twisted/tap/conch.py 1.6 1.7
> 
> Log message:
> Port to strports

I'd be happier if docstrings noted the use of strports so mktap users
will know they can do insane stuff like run SSH over SSL ;)

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From itamar at itamarst.org  Tue Sep 30 10:17:57 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 30 Sep 2003 12:17:57 -0400
Subject: [Twisted-Python] [twisted.roundup@twistedmatrix.com: [issue291]
 app.getApplication cleanup]
In-Reply-To: <20030930112821.GA11791@soniq.net>
References: <20030930112821.GA11791@soniq.net>
Message-ID: <20030930121757.2c2de5d0.itamar@itamarst.org>

I had the same conversation with moshe about making strports more
general, and like he said, we couldn't find any uses cases. To emphasize
the point, *I* couldn't find any, and I was asking for these changes. So
we decided not to bother changing it until we do.

If you do have a use case, then I'm sure extending it won't be a
problem, and moshez was quite willing to change the code for that case.
But we're all working on this in our spare time, it's not our job, so in
order for us to do extra work there has to be a reason. YAGNI is a valid
argument.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From fog at initd.org  Tue Sep 30 10:27:43 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Tue, 30 Sep 2003 18:27:43 +0200
Subject: [Twisted-Python] deferred folies
Message-ID: <1064939263.1380.4.camel@localhost>

hi *,

lately i did some dirty Deferred tricks and i just want to know if there
is a better way to do what i did. the situation is as follows:

a server exposes through pb a "session" object. the client can call on
that object "execute" (any number of times) and then "abort" or "end" to
end the session. the session is created by calling "new_session" on the
remote perspective (after authentication, etc.)

now, for a simple get session/execute/end sequence i don't want to write
n+1 callbacks (one that waits for new_session and call execute, next one
that wait on execute and call next, etc.) so here is what I did (inside
a mixin class used in the client):

def session(self):
    return self.server.callRemote("new_session")

def execute(self, trans, *args, **kwargs)
    cb = kwargs.get('callback', None)
    if self._session:
        dfr = self.server.callRemote(trans, *args)
        if cb:
            dfr.chainDeferred(cb)
        return dfr
    else:
        dfr = self.session()
        cb = Deferred()
        dfr.addCallback(self._execute_got_session, trans, cb, *args)
        return cb

def _execute_got_session(self, session, trans, cb, *args):
    self._session = session
    return self.execute(trans, *args, callback=cb)

that is, from the client the user can just do:

d = self.execute("set-foo", 42)
d.addCallback(...)

and in the callback call .execute again (and be sure to be in the same
session) or call end or abort to terminate the session.

clear? mm..

what i want to know is if the "cb" trick and chainDeferred call are a
dirty hack or if that's the way they are supposed to be used and if
there is a better way to do what i do.

ciao,
federico

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
   Lasciate che i furetti vengano a me. -- Maria Luisa Benedetta Panzani
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio  firmata
URL: </pipermail/twisted-python/attachments/20030930/3a2d8722/attachment.sig>

From glyph at twistedmatrix.com  Tue Sep 30 11:31:54 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 30 Sep 2003 13:31:54 -0400
Subject: [Twisted-Python] [twisted.roundup@twistedmatrix.com: [issue291]
 app.getApplication cleanup]
In-Reply-To: <20030930112821.GA11791@soniq.net>
References: <20030930112821.GA11791@soniq.net>
Message-ID: <3F79BE0A.5010606@twistedmatrix.com>

Paul Boehm wrote:
> okay, and now someone explain to me what should motivate me to keep
> sending in patches? strports patches will be rejected too, moshez told
> me, so i'll have to fork that too.. 

I don't know.  What motivated you to send patches in the first place?

> and i had fixes for that loseConnection stuff months ago, i don't
> remember if i submitted them, because even back then i knew from
> experience that you won apply my patches, but i probably did.

As Andrew pointed out, there is nothing on the list or tracker. 
Certainly you'd learn from experience that if you don't submit patches, 
we won't apply them.

> i'll submit my proxy patches, integrating well into cvs-current, this
> week, as arranged on irc, and you judge if my code is unbearable or if
> it actually makes sense. i see this as an last attempt to communicate
> with you guys..

You may want to consider trying a little harder before giving up.  You
make this sound like a last resort after you've spent a long, hard time
explaining yourself and lobbying for an important patch.  However, this
is a trivial patch, "cleanup" which isn't required unless you happen to
find for loops substantially easier to read than list comprehensions (or
longer functions easier to read than shorter ones).

Looking at issue 291, the conversation goes:

Moshe:
> I'm going to reject it -- this code works, and is clear 
> enough. Do you have any good reason, other than clean-up, 
> for this patch?

Paul:
>> no
>> besides i've joined the dark circle now and understand the code anyway,
>> lets keep those pesty newbies away from the secrets of the inner circle!

This doesn't look like a lot of hard arguing to get bitter over.  Moshe
asked you for reasons and you didn't give him any.

There is good reason not to accept patches which simply shuffle things
around.  Every change has a cost.  Every change is a small bit of
functionality which will be subtly different between versions.  We are
striving to create as few of these as possible, and any long-time
Twisted user can still tell you that we create a LOT.  Any bug report
involving the code in question will automatically get longer, because
instead of dealing with the only released version, the developer will
always have to ask "Is this with 1.1.1 or 1.1.2?"

So, if you want "cleanup" changes to be accepted, you are automatically
fighting an uphill battle, and for good reason.

If you really feel that aesthetic changes like this are important, your
best bet is to include some useful modification to the current file -
preferably with a strong use-case attached in the tracker or in
docstrings, as well as tests - and it is very unlikely that we will
reject patches on the grounds that they contain additional cosmetic
changes, especially if those changes are related to the fix or
enhancement.  I'd still prefer you avoid this kind of change, but
working, useful code is always a good bargaining chip.

Also, just in terms of priorities: if readability is your goal your
energies would best be directed elsewhere.  May I humbly suggest that
you examine other parts of Twisted, such as twisted/spread/jelly.py,
twisted/protocols/imap4.py, or this lovely snippet	 from
twisted/protocols/dns.py:

>         byte3 = (( ( self.answer & 1 ) << 7 )
>                  | ((self.opCode & 0xf ) << 3 )
>                  | ((self.auth & 1 ) << 2 )
>                  | ((self.trunc & 1 ) << 1 )
>                  | ( self.recDes & 1 ) )
>         byte4 = ( ( (self.recAv & 1 ) << 7 )
>                   | (self.rCode & 0xf ) )

As far as readability goes, you can do a lot worse in Twisted than any
of the code in twisted/application.

> i see this as an last attempt to communicate with you guys..

> bitter,
>   paul

Sit back, take a deep breath, and relax.  We have no prejudice against 
you or your patches.  Each one will be evaluated in turn.  If the 
maintainer disagrees with you, or even if not, you may still be expected 
to give coherent and complete examples of why the patches are important 
enough to justify their cost as changes, but we turn down relatively few 
patches overall.

If you're having trouble communicating, keep the discussions to public, 
archived forums like this mailing list or the particular issue in 
question, so that others might help you argue your case.  Unless you 
know another person's style of communication well, IRC can be an 
exercise in frustration, and the Twisted developers' style includes many 
subtle hints about tone of voice which are not immediately obvious to 
those outside the group.




From glyph at twistedmatrix.com  Tue Sep 30 11:34:15 2003
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Tue, 30 Sep 2003 13:34:15 -0400
Subject: [Twisted-Python] more on IRC frustration
Message-ID: <3F79BE97.50105@twistedmatrix.com>

Mentioning IRC frustrations in my message to paul reminded me of something.

There is one stylistic hint in particular I'd like to point out, because 
it causes the most misunderstanding, and it seems as though it may be 
particular to our peculiar IRC subculture.  If you're in #twisted and 
somebody says something like this:

<usr> Hi there!  I am a user with a proble integrating widgets and 
frobules, and there seems to be a problem with version 2.5-X of Twisted.
<dev> i guess you are just an idiot then!  haha idiot

Though I seriously doubt such a straightforwardly hostile exchange would 
occur, watch the punctuation in the #twisted regular's phrase.  If it 
follows the pattern

<dev> sentence with no punctuation! additional sentence

it is most likely intended as sarcasm, whereas if it is phrased with 
mroe conventional grammar and punctuation,

<dev> I guess you're just an idiot, then.  Heh.  Idiot.

Then you should really be offended :-).  Other cues of sarcasm include 
use of the word "r" (for "are"), "si" (for "is"), and "teh" (for "the") 
  We rarely make those typos unintentionally.




From ccom at gmx.net  Tue Sep 30 11:40:38 2003
From: ccom at gmx.net (ccom at gmx.net)
Date: Tue, 30 Sep 2003 19:40:38 +0200 (MEST)
Subject: [Twisted-Python] Re: serving dynamic on root and still serve static somehow
Message-ID: <3213.1064943638@www30.gmx.net>

> With isLeaf=False, the root resource will _never_ have its 
> render() method called. That is because the request for 
> the root resource is always '/', not ''. 
> (i.e., "GET / HTTP/1.1", not "GET  HTTP/1.1")
 
> '/'.split('/') == [''], which means that getChild('', request) will
> be called. Therefore, your root resource must respond to 
> getChild('', request).


This is so tricky. Your suggestion does not work because I want to pass a
parameter for the dynamic page which I read out with request.postpath[0].

You know what would solve my problem really quickly: If I would know how to
call a child manually (or not even a child but the static.File('.')
resource). I have come up with the following code but it does throw me a " does not
return a string" error:

class Container(resource.Resource):
    isLeaf = True
    
    def render(self, request):        
        if request.postpath[0] == 'static':
            return self.getChild('static', request)
        else:
            return doContainer(request)

root = Container()
root.putChild('static', static.File('.'))
site = server.Site(root) 

reactor.listenTCP(8080, site)
reactor.run()



_stephan

-- 
NEU FR ALLE - GMX MediaCenter - fr Fotos, Musik, Dateien...
Fotoalbum, File Sharing, MMS, Multimedia-Gru, GMX FotoService

Jetzt kostenlos anmelden unter http://www.gmx.net

+++ GMX - die erste Adresse fr Mail, Message, More! +++




From radix at twistedmatrix.com  Tue Sep 30 12:45:06 2003
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 30 Sep 2003 14:45:06 -0400
Subject: [Twisted-Python] deferred folies
In-Reply-To: <1064939263.1380.4.camel@localhost>
References: <1064939263.1380.4.camel@localhost>
Message-ID: <20030930184506.GE1515@radii>

On Tue, Sep 30, 2003 at 06:27:43PM +0200, Federico Di Gregorio wrote:
> now, for a simple get session/execute/end sequence i don't want to write
> n+1 callbacks (one that waits for new_session and call execute, next one
> that wait on execute and call next, etc.) so here is what I did (inside
> a mixin class used in the client):

If you _really_ want to try avoiding all the callbacks, I think your
hack is the wrong way to do it. Use something like twisted.flow's
Deferred support: this way, you "yield" when you wait for a Deferred
to fire, and then you will be able to get the result synchronously
once your function is returned. There's probably an example somewhere
in the flow docstrings or examples.

-- 
 Twisted | Christopher Armstrong: International Man of Twistery
  Radix  |          Release Manager,  Twisted Project
---------+     http://twistedmatrix.com/users/radix.twistd/



From tv at tv.debian.net  Tue Sep 30 06:39:34 2003
From: tv at tv.debian.net (Tommi Virtanen)
Date: Tue, 30 Sep 2003 15:39:34 +0300
Subject: [Twisted-Python] secsh, please compare with conch
Message-ID: <3F797986.4000306@tv.debian.net>

Hi. I hate duplicated effort (that has not real reason to be 
duplicated), and noticed this:

http://www.lag.net/~robey/secsh/

secsh is a module for python 2.3 that implements the SSH2 protocol for 
secure (encrypted and authenticated) connections to remote machines. 
unlike SSL (aka TLS), SSH2 protocol does not require heirarchical 
certificates signed by a powerful central authority. you may know SSH2 
as the protocol that replaced telnet and rsh for secure access to remote 
shells, but the protocol also includes the ability to open arbitrary 
channels to remote services across the encrypted tunnel (this is how 
sftp works, for example).

the module works by taking a socket-like object that you pass in, 
negotiating with the remote server, authenticating (using a password or 
a given private key), and opening flow-controled "channels" to the 
server, which are returned as socket-like objects. you are responsible 
for verifying that the server's host key is the one you expected to see, 
and you have control over which kinds of encryption or hashing you 
prefer (if you care), but all of the heavy lifting is done by the secsh 
module.

it is written entirely in python (no C or platform-dependent code) and 
is released under the GNU LGPL (lesser GPL).



Could the conch guy please email the author of secsh and see whether 
they could unite their efforts? Please? Thank you.




From fog at initd.org  Tue Sep 30 12:52:06 2003
From: fog at initd.org (Federico Di Gregorio)
Date: Tue, 30 Sep 2003 20:52:06 +0200
Subject: [Twisted-Python] deferred folies
In-Reply-To: <20030930184506.GE1515@radii>
References: <1064939263.1380.4.camel@localhost>
	 <20030930184506.GE1515@radii>
Message-ID: <1064947925.1373.51.camel@localhost>

Il mar, 2003-09-30 alle 20:45, Christopher Armstrong ha scritto:
> On Tue, Sep 30, 2003 at 06:27:43PM +0200, Federico Di Gregorio wrote:
> > now, for a simple get session/execute/end sequence i don't want to write
> > n+1 callbacks (one that waits for new_session and call execute, next one
> > that wait on execute and call next, etc.) so here is what I did (inside
> > a mixin class used in the client):
> 
> If you _really_ want to try avoiding all the callbacks, I think your
> hack is the wrong way to do it. Use something like twisted.flow's

no, i don't want to avoid all the callbacks. i just don't want to write
three one-line callbacks for a simple call.

> Deferred support: this way, you "yield" when you wait for a Deferred
> to fire, and then you will be able to get the result synchronously
> once your function is returned. There's probably an example somewhere
> in the flow docstrings or examples.

but i'll look into flow anyway. :)

-- 
Federico Di Gregorio
Debian GNU/Linux Developer                                fog at debian.org
INIT.D Developer                                           fog at initd.org
                              Viviamo in un mondo reale, Ciccio. -- Lucy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Questa parte del messaggio  firmata
URL: </pipermail/twisted-python/attachments/20030930/197740f4/attachment.sig>

From bob at redivi.com  Tue Sep 30 13:05:23 2003
From: bob at redivi.com (Bob Ippolito)
Date: Tue, 30 Sep 2003 15:05:23 -0400
Subject: [Twisted-Python] secsh, please compare with conch
In-Reply-To: <3F797986.4000306@tv.debian.net>
Message-ID: <0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>

On Tuesday, Sep 30, 2003, at 08:39 America/New_York, Tommi Virtanen 
wrote:

> Hi. I hate duplicated effort (that has not real reason to be 
> duplicated), and noticed this:
>
> http://www.lag.net/~robey/secsh/
>
> secsh is a module for python 2.3 that implements the SSH2 protocol for 
> secure (encrypted and authenticated) connections to remote machines. 
> unlike SSL (aka TLS), SSH2 protocol does not require heirarchical 
> certificates signed by a powerful central authority. you may know SSH2 
> as the protocol that replaced telnet and rsh for secure access to 
> remote shells, but the protocol also includes the ability to open 
> arbitrary channels to remote services across the encrypted tunnel 
> (this is how sftp works, for example).
>
> the module works by taking a socket-like object that you pass in, 
> negotiating with the remote server, authenticating (using a password 
> or a given private key), and opening flow-controled "channels" to the 
> server, which are returned as socket-like objects. you are responsible 
> for verifying that the server's host key is the one you expected to 
> see, and you have control over which kinds of encryption or hashing 
> you prefer (if you care), but all of the heavy lifting is done by the 
> secsh module.
>
> it is written entirely in python (no C or platform-dependent code) and 
> is released under the GNU LGPL (lesser GPL).
>
> Could the conch guy please email the author of secsh and see whether 
> they could unite their efforts? Please? Thank you.

I emailed the secsh guy to make sure he was aware of conch, but I 
received no reply.

-bob




From greg at digitalinfo.net  Tue Sep 30 13:07:37 2003
From: greg at digitalinfo.net (Greg)
Date: Tue, 30 Sep 2003 15:07:37 -0400
Subject: [Twisted-Python] using ClientFactory from within a server
In-Reply-To: <3F78209D.50105@digitalinfo.net>
References: <200309282130.33961.greg@digitalinfo.net> <20030929032307.GB28533@intarweb.us> <3F78209D.50105@digitalinfo.net>
Message-ID: <3F79D479.7080807@digitalinfo.net>

Greg wrote:

>>>         reactor.connectTCP(host, port, factory2)
>>>         reactor.run()   
>>
>>
>>  Remove the above call to "reactor.run() and see what happens.
>>
>>>         print "Returned from sending email"
>>>         # ^ Never gets to this point
>>>   
>>
> Thanks. Now I am getting closer. But a strange (to me) thing happens. 
> When I connect to the Echo server and send it a string, it does 
> correctly run the MySMTP code. But it does not return and execute the 
> 'print "Returned from sending email"' statement until I connect to the 
> Echo server again and send another string. Any idea why this is 
> happening? Is there a way to disconnect factory2 from the reactor 
> after I have sent the "QUIT" string (or when 
> MySMTPClientFactory.clientConnectionLost() gets called)?

Never mind, I suck. I finally noticed that it was of course immediately 
returning from the reactor.connectTCP() and immediately printing 
"Returned from sending email", then getting around to actually running 
the MySMTPClientFactory stuff. I guess I have to learn about using 
deferreds. Thanks again for your previous help.




From z3p at twistedmatrix.com  Tue Sep 30 13:36:27 2003
From: z3p at twistedmatrix.com (Paul Swartz)
Date: 30 Sep 2003 15:36:27 -0400
Subject: [Twisted-Python] secsh, please compare with conch
In-Reply-To: <0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>
References: <0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>
Message-ID: <1064950588.777.5.camel@petra>

On Tue, 2003-09-30 at 15:05, Bob Ippolito wrote:
> > Could the conch guy please email the author of secsh and see whether 
> > they could unite their efforts? Please? Thank you.
> 
> I emailed the secsh guy to make sure he was aware of conch, but I 
> received no reply.

I'm gonna have a look at it in the next couple of days, but Bob, let me
know if you hear anything from him.

-p
-- 
      Paul Swartz
(o_   z3p at twistedmatrix dot com
//\   http://www.twistedmatrix.com/users/z3p.twistd/
V_/_  AIM: Z3Penguin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20030930/41013ab1/attachment.sig>

From itamar at itamarst.org  Tue Sep 30 14:17:27 2003
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Tue, 30 Sep 2003 16:17:27 -0400
Subject: [Twisted-Python] secsh, please compare with conch
In-Reply-To: <0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>
References: <3F797986.4000306@tv.debian.net>
	<0B4F9E74-F379-11D7-9758-000A95686CD8@redivi.com>
Message-ID: <20030930161727.45aa8465.itamar@itamarst.org>

On Tue, 30 Sep 2003 15:05:23 -0400
Bob Ippolito <bob at redivi.com> wrote:

> I emailed the secsh guy to make sure he was aware of conch, but I 
> received no reply.

I also emailed him, and again, no answer.

-- 
Itamar Shtull-Trauring    http://itamarst.org/
Available for Python & Twisted consulting



From 2002 at weholt.org  Tue Sep 30 15:45:43 2003
From: 2002 at weholt.org (Thomas Weholt)
Date: Tue, 30 Sep 2003 23:45:43 +0200
Subject: [Twisted-Python] Serving web content over SSL
Message-ID: <007401c3879c$33654a70$0401a8c0@razor>

Can anybody provide a working, simple example of a SSL-capable web-server
using Twisted ?
Any hints or clues regarding installation of openssl or other required
library is also interesting.

Thanks in advance,
Thomas




From andrew-twisted at puzzling.org  Tue Sep 30 18:54:38 2003
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Wed, 1 Oct 2003 10:54:38 +1000
Subject: [Twisted-Python] more on IRC frustration
In-Reply-To: <3F79BE97.50105@twistedmatrix.com>
References: <3F79BE97.50105@twistedmatrix.com>
Message-ID: <20031001005438.GA10482@frobozz>

On Tue, Sep 30, 2003 at 01:34:15PM -0400, Glyph Lefkowitz wrote:
> Mentioning IRC frustrations in my message to paul reminded me of something.
> 
> There is one stylistic hint in particular I'd like to point out, because 
> it causes the most misunderstanding, and it seems as though it may be 
> particular to our peculiar IRC subculture.  If you're in #twisted and 
> somebody says something like this:

That's all pretty obscure.  Honestly, if we're going to require people to
understand #twisted's in-jokes to be able to participate usefully, then I'd
rather we discouraged use of #twisted for giving advice and discussing code
with non-devs.  Being apparently rude to Twisted newbies is no better than
being really rude to them, in terms of damage done to Twisted's reputation,
and the reputation of its development team.

How is a #twisted newbie going to know to read this?  How are they going to
know who the regulars are?  If they get pissed off, are they really going to
feel better about being told "you just don't get our sense of humour?"

I'd like to offer a stylistic hint -- but for the development team.  If you
don't have something positive to say to a newbie, even if they seem to be
clueless, please please please consider not saying anything to them.  Let a
more sympathetic or tactful person respond instead.

We really should be trying to remove barriers to participation, not
fortifying the existing ones.  It saddens me to think that we're driving
away potential contributors because we arbitrarily require them to be
thick-skinned, regardless of their technical abilities.

-Andrew.




From jv5Hivfj6183j4 at aonehotwebdeals.com  Tue Sep 30 16:39:25 2003
From: jv5Hivfj6183j4 at aonehotwebdeals.com (jv5Hivfj6183j4 at aonehotwebdeals.com)
Date: Tue, 30 Sep 2003 20:39:25 -0200
Subject: [Twisted-Python] Individual Health Insurance Free Quotes nzpdfm exn
Message-ID: <b8i4$6329$$r743302-1$7s4f2k-blt@kbgby1bumer>

<html>
<head>
</head>
<body>
<p><font size="2" face="Arial, Helvetica, sans-serif">Over 20 Million American Families are Without Health Insurance,<br>
Are You and Your Family One of Them</font></p>
<p><font size="2" face="Arial, Helvetica, sans-serif">We Offer the Newest, Most
    Complete Quote<br>
  Service on the Internet, So Don&#8217;t Wait Any Longer</font></p>
<p><font size="2" face="Arial, Helvetica, sans-serif"><br>
  <a href="http://www152.bestspotsontheinternet.com/hinsurance/ad/text1_click">Get Your Insurance Quote Today</a>!<br>
  <font size="1">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
  If you do not wish to receive these offers in the future,<br>
  <a href="http://www152.bestspotsontheinternet.com/hinsurance/ad/text1_remove">Click Here</a> to remove yourself now<br>
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</font><br>
</font></p>
<p><br>
&nbsp;</p>
</body>
</html>tevdj  vxrh y 
c  qka i

