<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Limit on transport.write
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Limit%20on%20transport.write&In-Reply-To=%3C1EC55CBE-DD00-457C-8CEF-ED78B0F6AB28%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="057890.html">
   <LINK REL="Next"  HREF="057893.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Limit on transport.write</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Limit%20on%20transport.write&In-Reply-To=%3C1EC55CBE-DD00-457C-8CEF-ED78B0F6AB28%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Limit on transport.write">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Mar 26 00:31:37 MDT 2012</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="057890.html">[Twisted-Python] Limit on transport.write
</A></li>
        <LI>Next message (by thread): <A HREF="057893.html">[Twisted-Python] Limit on transport.write
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57892">[ date ]</a>
              <a href="thread.html#57892">[ thread ]</a>
              <a href="subject.html#57892">[ subject ]</a>
              <a href="author.html#57892">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Mar 26, 2012, at 2:21 AM, hz hanks wrote:

&gt;<i> Hi, all
</I>&gt;<i> 
</I>&gt;<i> I'm writing a program to transfer files over Internet. Sometimes the
</I>&gt;<i> files would be very big. Therefore, I'm not sure whether I could read
</I>&gt;<i> a large block of data and send them via one time
</I>&gt;<i> internet.protocol.transport.write(). On the other hand, does the
</I>&gt;<i> function internet.protocol.transport.write() have any buffer scheme?
</I>&gt;<i> If so, I could just read one line of the file each time and call that
</I>&gt;<i> function. Or if you have any advice on how to transfer large amount of
</I>&gt;<i> data, please let me know. Really appreciated.
</I>
First, you want to read this &lt;<A HREF="http://twistedmatrix.com/documents/current/core/howto/producers.html">http://twistedmatrix.com/documents/current/core/howto/producers.html</A>&gt;.

Second, you should understand that transport.write() will always buffer; it will never raise an error.  The rationale for this behavior is that if you've already got the data as a Python string (as you must, if you're calling write() with it), you have already paid the not-inconsiderable cost of pulling that data into your process, allocating memory for it, and slinging it around in Python, which probably means you've already copied it a few times by splitting it up, moving it around, etc.  The transport implementations will endeavor to not copy it around too much more (they generally keep a list of strings around as a buffer rather than a string they keep concatenating to), but they will hold on to it until they're able to write it.

If you want to know about the state of the buffer you need to subscribe to it using registerProducer() - so see the above document for how to do that.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20120326/fbbd6e37/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="057890.html">[Twisted-Python] Limit on transport.write
</A></li>
	<LI>Next message (by thread): <A HREF="057893.html">[Twisted-Python] Limit on transport.write
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57892">[ date ]</a>
              <a href="thread.html#57892">[ thread ]</a>
              <a href="subject.html#57892">[ subject ]</a>
              <a href="author.html#57892">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
