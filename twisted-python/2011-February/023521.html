<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] DeferredSemaphore - action on acquire and	release
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20DeferredSemaphore%20-%20action%20on%20acquire%20and%0A%09release&In-Reply-To=AANLkTimqHvXKPEPS7CJBa2wMUPgrf%3Dw43uh5p3pgVkzV%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023520.html">
   <LINK REL="Next"  HREF="023522.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] DeferredSemaphore - action on acquire and	release</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20DeferredSemaphore%20-%20action%20on%20acquire%20and%0A%09release&In-Reply-To=AANLkTimqHvXKPEPS7CJBa2wMUPgrf%3Dw43uh5p3pgVkzV%40mail.gmail.com"
       TITLE="[Twisted-Python] DeferredSemaphore - action on acquire and	release">exarkun at twistedmatrix.com
       </A><BR>
    <I>Tue Feb  8 08:35:03 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="023520.html">[Twisted-Python] DeferredSemaphore - action on acquire and	release
</A></li>
        <LI>Next message: <A HREF="023522.html">[Twisted-Python] PyCon 2011 Twisted Sprint
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23521">[ date ]</a>
              <a href="thread.html#23521">[ thread ]</a>
              <a href="subject.html#23521">[ subject ]</a>
              <a href="author.html#23521">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01:14 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jrennie at gmail.com</A> wrote:
&gt;<i>Sorry, I don't think I understand the example either---looks to me like
</I>&gt;<i>you're reimplementing a semaphore.  Stephen's right about run().
</I>
It sounds like (the other) Jason would be happy with run, except he also 
wants to do something extra each time the lock/semaphore is taken and 
released.  DeferredSemaphore (and the other similar classes) don't 
really offer this functionality.  You just have to work that logic into 
the function you run.  It's possible something like this would be nicer 
than reimplementing the acquire/release logic:

    def run(sem, f):
        def before():
            doAcquire()
            return f()
        d = sem.run(before)
        def after(passthrough):
            doRelease()
            return passthrough
        d.addBoth(after)
        return d

Jean-Paul

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023520.html">[Twisted-Python] DeferredSemaphore - action on acquire and	release
</A></li>
	<LI>Next message: <A HREF="023522.html">[Twisted-Python] PyCon 2011 Twisted Sprint
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23521">[ date ]</a>
              <a href="thread.html#23521">[ thread ]</a>
              <a href="subject.html#23521">[ subject ]</a>
              <a href="author.html#23521">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
