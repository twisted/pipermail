<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] sigchld
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20sigchld&In-Reply-To=20110211165545.1914.1846480533.divmod.xquotient.49%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023552.html">
   <LINK REL="Next"  HREF="023559.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] sigchld</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20sigchld&In-Reply-To=20110211165545.1914.1846480533.divmod.xquotient.49%40localhost.localdomain"
       TITLE="[Twisted-Python] sigchld">glyph at twistedmatrix.com
       </A><BR>
    <I>Fri Feb 11 13:51:00 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="023552.html">[Twisted-Python] sigchld
</A></li>
        <LI>Next message: <A HREF="023559.html">[Twisted-Python] sigchld
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23553">[ date ]</a>
              <a href="thread.html#23553">[ thread ]</a>
              <a href="subject.html#23553">[ subject ]</a>
              <a href="author.html#23553">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Feb 11, 2011, at 11:55 AM, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A> wrote:

&gt;<i> On 03:59 pm, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jrennie at gmail.com</A> wrote:
</I>&gt;&gt;<i> On Fri, Feb 11, 2011 at 10:01 AM, &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at twistedmatrix.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> On Python 2.5 and earlier you won't be able to get Twisted's SIGCHLD
</I>&gt;&gt;&gt;<i> handler using signal.getsignal.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> We're also moving to python 2.6 (the change is really Debian 5 to 
</I>&gt;&gt;<i> Debian 6).
</I>&gt;&gt;<i> Should it would work in 2.6?
</I>&gt;<i> 
</I>&gt;<i> I think so.
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> What sort of things do your signal handlers do?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> IIRC, the main thing is to shut down the web server (cherrypy) we're 
</I>&gt;&gt;<i> running
</I>&gt;&gt;<i> in parallel with twisted.  We also have some disk-caching for stateful
</I>&gt;&gt;<i> signals which needs to ensure the cache file is up-to-date.
</I>&gt;<i> 
</I>&gt;<i> For shutdown-type things, reactor.addSystemEventTrigger(phase, 
</I>&gt;<i> 'shutdown', f) might be better than getting into signal handlers (where 
</I>&gt;<i> phase is 'before', 'during', or 'after').
</I>

There's already a system event trigger already hooked up to the reactor: your main service's stopService call.  If your cherrypy webserver is wrapped up in an IService implementation in the service hierarchy constructed in your twistd plugin or tac file, you can just implement 'stopService' and not do any manual registration with event triggers.  This is really a better way to go in general, as it's easier for other API consumers to deal with such an object than using the global broadcasting mechanism in the reactor.

If you do want to manually add your own system event trigger, in most interesting cases you'll need to use the 'before' phase.  During 'before', Deferreds returned by event triggers are respected (i.e. the reactor keeps running as long as they haven't fired).  If you schedule one for 'during' or 'after', the event trigger really needs to do all of its work and complete it immediately (i.e. before returning).


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023552.html">[Twisted-Python] sigchld
</A></li>
	<LI>Next message: <A HREF="023559.html">[Twisted-Python] sigchld
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23553">[ date ]</a>
              <a href="thread.html#23553">[ thread ]</a>
              <a href="subject.html#23553">[ subject ]</a>
              <a href="author.html#23553">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
