<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: SIGBREAK on windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20SIGBREAK%20on%20windows&In-Reply-To=%3Cefdcv8%24496%241%40sea.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="046620.html">
   <LINK REL="Next"  HREF="046622.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: SIGBREAK on windows</H1>
    <B>Ralf Schmitt</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20SIGBREAK%20on%20windows&In-Reply-To=%3Cefdcv8%24496%241%40sea.gmane.org%3E"
       TITLE="[Twisted-Python] Re: SIGBREAK on windows">ralf at brainbot.com
       </A><BR>
    <I>Wed Sep 27 02:32:39 MDT 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="046620.html">[Twisted-Python] SIGBREAK on windows
</A></li>
        <LI>Next message (by thread): <A HREF="046622.html">[Twisted-Python] Re: SIGBREAK on windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46621">[ date ]</a>
              <a href="thread.html#46621">[ thread ]</a>
              <a href="subject.html#46621">[ subject ]</a>
              <a href="author.html#46621">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jacob Gabrielson wrote:
&gt;<i> Hi,
</I>&gt;<i>  
</I>&gt;<i> Has anyone run into a problem where their Twisted application gets a
</I>&gt;<i> SIGBREAK and shuts down, on Windows?  I have a simple application using
</I>&gt;<i> the ReconnectingClientFactory, running as a service (via srvany.exe),
</I>&gt;<i> that occasionally dies with a few messages:
</I>&gt;<i> 
</I>&gt;<i> 2006/09/24 16:46 Pacific Daylight Time [-] Received SIGBREAK, shutting
</I>&gt;<i> down.
</I>&gt;<i> 2006/09/24 16:46 Pacific Daylight Time [AgentProtocol,client]
</I>&gt;<i> &lt;twisted.internet.tcp.Connector instance at 0x00A1B468&gt; will retry in 2
</I>&gt;<i> seconds
</I>&gt;<i> 2006/09/24 16:46 Pacific Daylight Time [AgentProtocol,client] Stopping
</I>&gt;<i> factory &lt;twisted.internet.protocol.ReconnectingClientFactory instance at
</I>&gt;<i> 0x00A10D28&gt;
</I>&gt;<i> 2006/09/24 16:46 Pacific Daylight Time [-] Main loop terminated.  
</I>&gt;<i> 
</I>&gt;<i> There's not a lot to go on, but I'm wondering if this is something
</I>&gt;<i> anyone else has run into on Windows.  I'm not really sure how a SIGBREAK
</I>&gt;<i> could get generated there in the first place.
</I>&gt;<i>  
</I>
You may receive that signal when users log off. I'm using the following
code to ignore signals when running as service (but I'm also using the
win32serviceutil module to start as a service).

import win32api

def sighandler(sig):
    print &quot;received signal %s&quot; % (sig,)
    return True

win32api.SetConsoleCtrlHandler(sighandler, True)

However, I guess that if you're using that code unchanged you might not
be able to stop your service anymore.

More Information can be found at msdn:
<A HREF="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dllproc/base/setconsolectrlhandler.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dllproc/base/setconsolectrlhandler.asp</A>

You might also want to look into using the win32service module. IMHO,
it's a lot easier to handle than srvany. I'm attaching our nbsvc program
as example, which we use to start our programs as NT services.

Regards,
- Ralf


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: nbsvc
URL: &lt;/pipermail/twisted-python/attachments/20060927/f4b00e5e/attachment.ksh&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="046620.html">[Twisted-Python] SIGBREAK on windows
</A></li>
	<LI>Next message (by thread): <A HREF="046622.html">[Twisted-Python] Re: SIGBREAK on windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46621">[ date ]</a>
              <a href="thread.html#46621">[ thread ]</a>
              <a href="subject.html#46621">[ subject ]</a>
              <a href="author.html#46621">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
