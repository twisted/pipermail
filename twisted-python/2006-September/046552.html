<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Other wx/twisted methods (was Re: [Twisted-Python] removing	unsupported	reactors in twisted 2.6: qt, corefoundation, threadedselect, wx)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20Other%20wx/twisted%20methods%20%28was%20Re%3A%20%5BTwisted-Python%5D%20removing%0A%09unsupported%0A%09reactors%20in%20twisted%202.6%3A%20qt%2C%20corefoundation%2C%20threadedselect%2C%20wx%29&In-Reply-To=%3C20060924041616.1717.1221777311.divmod.quotient.58251%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="046550.html">
   <LINK REL="Next"  HREF="046558.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Other wx/twisted methods (was Re: [Twisted-Python] removing	unsupported	reactors in twisted 2.6: qt, corefoundation, threadedselect, wx)</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20Other%20wx/twisted%20methods%20%28was%20Re%3A%20%5BTwisted-Python%5D%20removing%0A%09unsupported%0A%09reactors%20in%20twisted%202.6%3A%20qt%2C%20corefoundation%2C%20threadedselect%2C%20wx%29&In-Reply-To=%3C20060924041616.1717.1221777311.divmod.quotient.58251%40ohm%3E"
       TITLE="Other wx/twisted methods (was Re: [Twisted-Python] removing	unsupported	reactors in twisted 2.6: qt, corefoundation, threadedselect, wx)">glyph at divmod.com
       </A><BR>
    <I>Sat Sep 23 22:16:16 MDT 2006</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="046550.html">Other wx/twisted methods (was Re: [Twisted-Python] removing	unsupported	reactors in twisted 2.6: qt, corefoundation, threadedselect, wx)
</A></li>
        <LI>Next message (by thread): <A HREF="046558.html">Other wx/twisted methods (was Re: [Twisted-Python]	removing	unsupported	reactors in twisted 2.6: qt, corefoundation, threadedselect, wx)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46552">[ date ]</a>
              <a href="thread.html#46552">[ thread ]</a>
              <a href="subject.html#46552">[ subject ]</a>
              <a href="author.html#46552">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 23 Sep 2006 23:33:11 -0400, Stephen Waterbury &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">waterbug at pangalactic.us</A>&gt; wrote:

&gt;<i>If I can get that to work (which I haven't had time to play with yet),
</I>&gt;<i>it would seem to offer several advantages:  (1) running wx and twisted
</I>&gt;<i>event loops in completely separate processes, (2) making relatively
</I>&gt;<i>minimal use of threads in the wx process (well-supported by the wx
</I>&gt;<i>libraries) to drive Pyro, and using the usual twisted paradigm in
</I>&gt;<i>the twisted process.  I would appreciate any advice, but I don't see
</I>&gt;<i>any show-stoppers.  I would do the Pyro communications on 127.0.0.1,
</I>&gt;<i>since Pyro has essentially zero security, keeping it completely within
</I>&gt;<i>the local machine.  Twisted would handle all external protocols.
</I>
Thanks for the suggestion, Stephen.  I don't think I like this approach though.

The major reason is that it introduces a process boundary between Twisted code and WX code.  In every other toolkit Twisted supports, you can handle GUI events and network events in the same process, in the same thread.   That makes it possible to have individual state machines which can emit output in the form of either GUI updates and writes to streams, and you can similarly receive GUI events or data from the network as input.

Keep in mind that each of the toolkits that WX backends to already *has* either a supported reactor or a proof of concept for Twisted integration: GTK+, the Win32 event loop, and Cococa.  It's not that we can't get network I/O notifications from the platform.  The real problem here is that WX obscures the underlying APIs for integrating sockets.  (I say &quot;obscures&quot; rather than &quot;does not wrap&quot; because the last time I tried to use gtk reactor with a gtk build of wx, the process segfaulted after emitting a pile of dynamic linker errors.  I have no idea what would happen on Windows or the Mac.)  Whatever we're going to do at this point without getting some new code from the WX developers is going to be a workaround.

That said, the mechanism that you propose may be the best way to practically integrate Twisted and WX today.  If it is, I think that it would work better as a separate project, because it is a workaround with a lot of pointy edges and not a real solution.

One major reason I'd like a WX reactor to continue to exist in some form is OSAF's usage of Twisted and WX.  They have a similarly baroque model for handing data back and forth between Twisted code and GUI code, and I'd love to have something to propose to them that was (A) supported by Twisted (B) well tested, and (C) didn't involve lots of potential race conditions, as all shared-state-threading code was likely to do.  I haven't looked at it in a while, but if I remember correctly their separation between Twisted code and GUI code was fairly clean and well-thought-out, but the separation would have been unnecessary if wx had native Twisted integration.

There are other problems with a Pyro-driven Twisted subprocess, which are relevant as the goal here is a well-supported and well-tested path for integration.

Multiprocess communication and process spawning, especially on Windows, is fraught with peril.  We've been working on reliable event-driven process spawning in Twisted for years and years, and only recently have we gotten to the point where the published API works reliably cross-platform.  Given that Twisted would be left out of this loop, I imagine the process control would be rather ad-hoc, so getting the Twisted and WX processes synchronized would be problematic, and extremely hard to unit test.  Although it would be slightly easier if the Twisted proces is 'on top', you still have to inject test code into both the parent and child processes, and have a way to verify the state of both.

The last release of pyro is almost a year old.  That suggests it is not actively maintained.

Pyro doesn't have a buildbot, or (as far as I can tell from the release) any automated tests of its own.  That would make it a wash in terms of tested, robust integration support.

You'd have to re-implement the Pyro protocol on top of Twisted to communicate with it without spawning lots of threads.  That's a bunch of new code which is going to need a home, again, possibly a whole new project.  Even after that's done, Pyro is going to be spawning threads and blocking inside the WX process because the Twisted implementation isn't running there.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="046550.html">Other wx/twisted methods (was Re: [Twisted-Python] removing	unsupported	reactors in twisted 2.6: qt, corefoundation, threadedselect, wx)
</A></li>
	<LI>Next message (by thread): <A HREF="046558.html">Other wx/twisted methods (was Re: [Twisted-Python]	removing	unsupported	reactors in twisted 2.6: qt, corefoundation, threadedselect, wx)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46552">[ date ]</a>
              <a href="thread.html#46552">[ thread ]</a>
              <a href="subject.html#46552">[ subject ]</a>
              <a href="author.html#46552">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
