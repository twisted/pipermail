<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Multiple client connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Multiple%20client%20connections&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013949.html">
   <LINK REL="Next"  HREF="013946.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Multiple client connections</H1>
    <B>Stan Benrsteen</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Multiple%20client%20connections&In-Reply-To="
       TITLE="[Twisted-Python] Multiple client connections">sbernste at mitre.org
       </A><BR>
    <I>Wed Sep  6 17:12:29 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="013949.html">[Twisted-Python] Newbie question
</A></li>
        <LI>Next message: <A HREF="013946.html">[Twisted-Python] Multiple client connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13945">[ date ]</a>
              <a href="thread.html#13945">[ thread ]</a>
              <a href="subject.html#13945">[ subject ]</a>
              <a href="author.html#13945">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>All,

I want to write a client that connects to a Twisted Server using pb.   
I want my client to make several connections. For example:

from twisted.spread import pb
from twisted.internet import defer

from twisted.internet.tcp import Connector
from twisted.internet import reactor
PORT = 8992

class ModelCalculator:
     def __init__(self, host, port):
         self.host = host
         self.port = port

     def add(self, a, b):
         self.factory = pb.PBClientFactory()
         deferred = self.factory.getRootObject()
         deferred.addCallback(self.connected, a, b)
         deferred.addErrback(self.failure)
         reactor.run()
         return self.result

     def connected(self, perspective, a, b):
         deferred = perspective.callRemote('calculate', a, b)
         deferred.addCallback(self.success, perspective)
         deferred.addErrback(self.failure)

     def success(self, result, perspective):
         self.result = result
         self.stopReactor()

     def failure(self, reason):
         self.result = None
         self.stopReactor()

     def stopReactor(self):
         reactor.stop()

if __name__ == '__main__':
     calculator = ModelCalculator(&quot;127.0.0.1&quot;, PORT)
     print calculator.add(4,5)
     print calculator.add(14,5)
     print calculator.add(24,5)
     print calculator.add(34,5)



As you see, I want to add many numbers and print out the result.   
This doesn't work because the reactor is been stopped in the  
stopReactor() method that is invoked in either success() or failure 
().  How can I change it so I can call my remote add() method many  
times without waiting for the reactor to be stopped? Is there a way  
that I can use the PB stuff without the reactor?

thanks,
/amn



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013949.html">[Twisted-Python] Newbie question
</A></li>
	<LI>Next message: <A HREF="013946.html">[Twisted-Python] Multiple client connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13945">[ date ]</a>
              <a href="thread.html#13945">[ thread ]</a>
              <a href="subject.html#13945">[ subject ]</a>
              <a href="author.html#13945">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
